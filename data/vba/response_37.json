[{"tags": ["excel", "combobox", "excel-2010", "vba"], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1443062949, "creation_date": 1443062949, "answer_id": 32752540, "question_id": 32751006, "link": "https://stackoverflow.com/questions/32751006/load-combobox-with-range-of-another-sheet/32752540#32752540", "title": "Load combobox with range of another sheet", "body": "<p>There is an important distinction between Worksheet objects and Sheet objects:</p>\n\n<ul>\n<li>Worksheet can contain only data (in cells)</li>\n<li><p>Sheet can contain data, and other objects like Charts, combo boxes, list boxes, etc</p></li>\n<li><p>To declare a Worksheet variable use Worksheet type</p></li>\n<li>To declare a Sheet variable use its CodeName, that appears before the name in brackets:</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/IIdY9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IIdY9.png\" alt=\"enter image description here\"></a></p>\n\n<p>.</p>\n\n<p>Try one of the 2 options bellow</p>\n\n<pre><code>Option Explicit\n\nSub Validar_Idades()\n\n    Dim aba1 As Worksheet           'Worksheet contain only data (no objects)\n    Set aba1 = Worksheets(\"IDADE\")\n\n    'To declare a variable of type Sheet you need to use its \"CodeName\"\n\n    Dim aba2 As Sheet2              'Sheet can contain data and other objects\n    Set aba2 = Sheets(\"EXTRA\u00c7\u00c3O\")   'like ListBoxes, Charts, ComboBoxes, etc\n\n    aba2.ComboBox1.Clear\n    aba2.ComboBox1.List = aba1.Range(\"A2:A\" &amp; _\n                                aba1.Range(\"A\" &amp; aba1.Rows.Count).End(xlUp).Row).Value\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub Validar_Idades2()\n\n    'or simply use its code name instead of a variable\n\n    Sheet2.ComboBox1.Clear\n    Sheet2.ComboBox1.List = Sheet1.Range(\"A2:A\" &amp; _\n                                Sheet1.Range(\"A\" &amp; Sheet1.Rows.Count).End(xlUp).Row).Value\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 2362927, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/92321a3a586f3480fe35e876c919a458?s=128&d=identicon&r=PG", "display_name": "Aerobane", "link": "https://stackoverflow.com/users/2362927/aerobane"}, "edited": false, "score": 0, "creation_date": 1464184606, "post_id": 32755981, "comment_id": 62381208, "body": "Random comment from over a year after your comment but using your method gives a Permission denied error.  Any idea why?  Objects are not locked or protected."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 85, "user_id": 2362927, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/92321a3a586f3480fe35e876c919a458?s=128&d=identicon&r=PG", "display_name": "Aerobane", "link": "https://stackoverflow.com/users/2362927/aerobane"}, "edited": false, "score": 1, "creation_date": 1464186054, "post_id": 32755981, "comment_id": 62382403, "body": "Most likely your control has a <code>ListFillRange</code> set."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1443080722, "creation_date": 1443080722, "answer_id": 32755981, "question_id": 32751006, "link": "https://stackoverflow.com/questions/32751006/load-combobox-with-range-of-another-sheet/32755981#32755981", "title": "Load combobox with range of another sheet", "body": "<p>The <code>Worksheet</code> class does not have a <code>combobox1</code> property - since of course not every worksheet has that control on it - which is why the compiler objects to your code. In addition to using the codename, as Paul Bica suggested, (though there is no generic Sheet object - each sheet is effectively its own class), you could simply declare your variable as <code>Object</code> rather than <code>Worksheet</code> so the code is late bound and the compiler won't object. Alternatively, you can access the control through the <code>OLEObjects</code> property of the <code>Worksheet</code> class:</p>\n\n<pre><code>aba2.OLEObjects(\"ComboBox1\").Object.List = aba1.Range(\"A2:A\" &amp; _\n                                aba1.Range(\"A\" &amp; aba1.Rows.Count).End(xlUp).Row).Value\n</code></pre>\n"}], "owner": {"reputation": 1650, "user_id": 1483520, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/b858e747a79c31d8270fb558d98e96b2?s=128&d=identicon&r=PG", "display_name": "alejandro carnero", "link": "https://stackoverflow.com/users/1483520/alejandro-carnero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 7194, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1615834970, "creation_date": 1443050285, "last_edit_date": 1531161705, "question_id": 32751006, "link": "https://stackoverflow.com/questions/32751006/load-combobox-with-range-of-another-sheet", "title": "Load combobox with range of another sheet", "body": "<p>I have one combobox in one sheet named <code>extra\u00e7ao</code> with a combobox,  </p>\n\n<p><a href=\"https://i.stack.imgur.com/e9AvE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/e9AvE.png\" alt=\"enter image description here\"></a></p>\n\n<p>and I have written this code:</p>\n\n<pre><code>  Sub Validar_Idades()\n\n  Dim aba1 As Worksheet\n  Set aba1 = Sheets(\"IDADE\")\n\n  Dim aba2 As Worksheet\n  Set aba2 = Sheets(\"EXTRA\u00c7\u00c3O\")\n\n  aba2.ComboBox1.Clear\n  aba2.ComboBox1.List = aba1.range(\"A2:A\" &amp; aba1.range(\"A\" &amp;         aba1.Rows.Count).End(xlUp).Row).Value\n\nEnd Sub\n</code></pre>\n\n<p>Why don't I see <code>combobox1</code>?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 944, "user_id": 3462736, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/728f19a61d1716a14f5e63a712e5834a?s=128&d=identicon&r=PG&f=1", "display_name": "haraprasadj", "link": "https://stackoverflow.com/users/3462736/haraprasadj"}, "edited": false, "score": 0, "creation_date": 1443050341, "post_id": 32750974, "comment_id": 53342563, "body": "Why dont you check if strNamePath has the extension you need and if it does not add an extension to it in the code?"}, {"owner": {"reputation": 103, "user_id": 4802546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Yc137KHhOUg/AAAAAAAAAAI/AAAAAAAAAMs/Lqi5eRCP_sA/photo.jpg?sz=128", "display_name": "an\u0259\u02c8nim\u0259d\u0113", "link": "https://stackoverflow.com/users/4802546/an%c9%99%cb%88nim%c9%99d%c4%93"}, "reply_to_user": {"reputation": 944, "user_id": 3462736, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/728f19a61d1716a14f5e63a712e5834a?s=128&d=identicon&r=PG&f=1", "display_name": "haraprasadj", "link": "https://stackoverflow.com/users/3462736/haraprasadj"}, "edited": false, "score": 1, "creation_date": 1443051331, "post_id": 32750974, "comment_id": 53342854, "body": "That&#39;s a thought... I work for a nonprofit that helps/employs adults with mental disabilities. I do my utmost to make the user experience as normal as possible to prevent triggering an episode. So I&#39;d <i>really</i> like to have the dialogue box and file type options they&#39;re used to. (The primary goal is protecting the template though so I will definitely consider that idea, thanks!)"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1443064815, "post_id": 32750974, "comment_id": 53345885, "body": "Hi Ane, can the new files be restricted to .xlsx (without code)?"}, {"owner": {"reputation": 103, "user_id": 4802546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Yc137KHhOUg/AAAAAAAAAAI/AAAAAAAAAMs/Lqi5eRCP_sA/photo.jpg?sz=128", "display_name": "an\u0259\u02c8nim\u0259d\u0113", "link": "https://stackoverflow.com/users/4802546/an%c9%99%cb%88nim%c9%99d%c4%93"}, "edited": false, "score": 0, "creation_date": 1443134898, "post_id": 32750974, "comment_id": 53383322, "body": "Hey PB! Long time no &quot;see!&quot; I&#39;d need it to be .xlsm if anything. Do you have any theories of why it&#39;s doing that? Does cancelling the SaveAsUI destroy the defaults perhaps and do I actually need that in the code?"}, {"owner": {"reputation": 103, "user_id": 4802546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Yc137KHhOUg/AAAAAAAAAAI/AAAAAAAAAMs/Lqi5eRCP_sA/photo.jpg?sz=128", "display_name": "an\u0259\u02c8nim\u0259d\u0113", "link": "https://stackoverflow.com/users/4802546/an%c9%99%cb%88nim%c9%99d%c4%93"}, "edited": false, "score": 0, "creation_date": 1443135479, "post_id": 32750974, "comment_id": 53383525, "body": "Hey pnuts! That rule drives me pnuts! It&#39;s so much easier to find the answers I need straight from Google with the tags in the title. I&#39;m not a rebel by nature though so I&#39;ll obey in a passive aggressive but inwardly seething sort of way and cope with my emotions through humor. <a href=\"http://www.reactiongifs.com/r/srcstc.gif\" rel=\"nofollow noreferrer\">Thanks</a> for your contribution! (Eh? Not bad right?)"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 4802546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Yc137KHhOUg/AAAAAAAAAAI/AAAAAAAAAMs/Lqi5eRCP_sA/photo.jpg?sz=128", "display_name": "an\u0259\u02c8nim\u0259d\u0113", "link": "https://stackoverflow.com/users/4802546/an%c9%99%cb%88nim%c9%99d%c4%93"}, "edited": false, "score": 1, "creation_date": 1443135786, "post_id": 32753180, "comment_id": 53383626, "body": "As always thanks for your awesomeness Paul! I&#39;m going to keep this as the front runner but still keep the question open just in case someone figures out how to get the file type option back on. I&#39;ll give it a week."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 103, "user_id": 4802546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Yc137KHhOUg/AAAAAAAAAAI/AAAAAAAAAMs/Lqi5eRCP_sA/photo.jpg?sz=128", "display_name": "an\u0259\u02c8nim\u0259d\u0113", "link": "https://stackoverflow.com/users/4802546/an%c9%99%cb%88nim%c9%99d%c4%93"}, "edited": false, "score": 0, "creation_date": 1443140655, "post_id": 32753180, "comment_id": 53384940, "body": "Good point! I updated the answer to replace GetSaveAsFilename with FileDialog(msoFileDialogSaveAs); the code will force a new name even if the user insists on using the old name but you may want to use your initial warning :)"}, {"owner": {"reputation": 103, "user_id": 4802546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Yc137KHhOUg/AAAAAAAAAAI/AAAAAAAAAMs/Lqi5eRCP_sA/photo.jpg?sz=128", "display_name": "an\u0259\u02c8nim\u0259d\u0113", "link": "https://stackoverflow.com/users/4802546/an%c9%99%cb%88nim%c9%99d%c4%93"}, "edited": false, "score": 0, "creation_date": 1443210516, "post_id": 32753180, "comment_id": 53418023, "body": "Thanks again Paul! Your msoFileDialogSaveAs magic did the trick. I&#39;ve spent pretty much my whole morning on the MSN Developer&#39;s center reading about the the objects you used and figuring out how to integrate it into my code. (So you didn&#39;t just give me a <a href=\"http://www.jackspets.com/Images/Pet-Care-Information/Fish/Goldfish.png\" rel=\"nofollow noreferrer\">fish</a>, you taught me to fish) I posted the change up top."}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 1, "last_activity_date": 1443140787, "last_edit_date": 1443140787, "creation_date": 1443067678, "answer_id": 32753180, "question_id": 32750974, "link": "https://stackoverflow.com/questions/32750974/workbook-beforesave-removed-file-types-in-save-as-dialogue/32753180#32753180", "title": "Workbook_BeforeSave removed file types in Save As dialogue", "body": "<p>Missing default file types are caused by Application.<strong>GetSaveAsFilename</strong>()</p>\n\n<p>Try using Application.<strong>FileDialog(msoFileDialogSaveAs)</strong>:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    Dim fId As String, oldName As String, iniName As String, fn As String\n\n    If SaveAsUI Then\n        Cancel = True\n        fId = \" - \" &amp; Format(Now, \"yyyy-mm-dd hh-mm-ss\")\n        oldName = ActiveWorkbook.Name\n        oldName = Left(oldName, InStrRev(oldName, \".\") - 1)\n        iniName = Replace(ActiveWorkbook.FullName, oldName, oldName &amp; fId)\n\n        With Application.FileDialog(msoFileDialogSaveAs)\n            .AllowMultiSelect = False\n            .InitialFileName = iniName\n            .Show\n            If .SelectedItems.Count = 1 Then\n                fn = .SelectedItems(1)\n                fn = Right(fn, Len(fn) - InStrRev(fn, \"\\\"))\n                fn = Left(fn, InStrRev(fn, \".\") - 1)\n                If fn = oldName Then fn = Replace(.SelectedItems(1), fn, fn &amp; fId)\n\n                Application.EnableEvents = False\n                Application.DisplayAlerts = False\n                Me.SaveAs fn\n                Application.DisplayAlerts = True\n                Application.EnableEvents = True\n            End If\n        End With\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 4802546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Yc137KHhOUg/AAAAAAAAAAI/AAAAAAAAAMs/Lqi5eRCP_sA/photo.jpg?sz=128", "display_name": "an\u0259\u02c8nim\u0259d\u0113", "link": "https://stackoverflow.com/users/4802546/an%c9%99%cb%88nim%c9%99d%c4%93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 32753180, "answer_count": 1, "score": 1, "last_activity_date": 1443210131, "creation_date": 1443050058, "last_edit_date": 1443210131, "question_id": 32750974, "link": "https://stackoverflow.com/questions/32750974/workbook-beforesave-removed-file-types-in-save-as-dialogue", "title": "Workbook_BeforeSave removed file types in Save As dialogue", "body": "<p>I have a master file accessed by multiple users that is used as a template on a monthly basis. I use the following code to to allow someone to <em>Save As</em>, but not <em>Save over</em> the Template. I also made it unable to run if \"Template\" is not found within the file name, so that the saved-as copies can be reopened and edited as needed. Here is that code:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\n    Dim strOrigFile As String\n    strOrigFile = ActiveWorkbook.FullName\n    Dim strNamePath As String\n    Dim strWorkOrNot As Integer\n\n    strWorkOrNot = InStr(1, strOrigFile, \"Template\")\n    If strWorkOrNot = 0 Then GoTo AbortProcess\n\n    If SaveAsUI Then\n        Cancel = True\n        strNamePath = Application.GetSaveAsFilename\n\n        Select Case strNamePath\n        Case \"False\"\n        Case strOrigFile\n            MsgBox \"It may be a bad idea to save over the template. You should use Save-As and create a new file.\", vbCritical, \"Avoid Corrupting the Template!\"\n        Case Else\n            Application.EnableEvents = 0\n            Me.SaveAs strNamePath\n            Application.EnableEvents = 1\n        End Select\n    Else\n        If ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Name = strOrigFile Then\n            Cancel = True\n            MsgBox \"It may be a bad idea to save over the template. You should use Save-As and create a new file.\", vbCritical, \"Avoid Corrupting the Template!\"\n        End If\n    End If\n\nAbortProcess:\n\nEnd Sub\n</code></pre>\n\n<p>When a user <em>does</em> Save As however, the dialogue box does not give any file type options and if someone doesn't specify during the save it will create a file that is missing an extension.</p>\n\n<p>How do I tweak this code to keep the Save As dialogue box from removing the file type options? And out of curiosity why is it doing that?</p>\n\n<p>[Solved]</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\n    Dim strOrigFile As String\n    strOrigFile = ActiveWorkbook.FullName\n    Dim strNamePath As String\n    Dim strWorkOrNot As Integer\n\n    strWorkOrNot = InStr(1, strOrigFile, \"Template\")\n    If strWorkOrNot = 0 Then GoTo AbortProcess\n    On Error GoTo SaveAsMacroWarning\n\n    If SaveAsUI Then\n        Cancel = True\n        With Application.FileDialog(msoFileDialogSaveAs)\n            .AllowMultiSelect = False\n            .InitialFileName = \"New\"\n            .Show\n            If \"False\" Then\n                Cancel = True\n                Exit Sub\n            Else\n                strNamePath = .SelectedItems(1)\n            End If\n        End With\n\n        Select Case strNamePath\n        Case strOrigFile\n            MsgBox \"It may be a bad idea to save over the template. You should use Save-As and create a new file.\", vbCritical, \"Avoid Corrupting the Template!\"\n        Case Else\n            Application.EnableEvents = 0\n            Me.SaveAs Filename:=strNamePath, FileFormat:=xlOpenXMLWorkbookMacroEnabled\n            Application.EnableEvents = 1\n        End Select\n    Else\n        If ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Name = strOrigFile Then\n            Cancel = True\n            MsgBox \"It may be a bad idea to save over the template. You should use Save-As and create a new file.\", vbCritical, \"Avoid Corrupting the Template!\"\n        End If\n    End If\n\nSaveAsMacroWarning:\n\n    MsgBox \"You'll need to save it as a Macro-Enabled file type.\", vbCritical, \"Save as Macro-Enabled\"\n\nAbortProcess:\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "dao"], "answers": [{"tags": [], "owner": {"reputation": 2472, "user_id": 603819, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zYtBs.png?s=128&g=1", "display_name": "Bobort", "link": "https://stackoverflow.com/users/603819/bobort"}, "is_accepted": true, "score": 0, "last_activity_date": 1443045655, "creation_date": 1443045655, "answer_id": 32750230, "question_id": 32750229, "link": "https://stackoverflow.com/questions/32750229/how-do-i-remove-the-primary-key-on-a-table-in-access/32750230#32750230", "title": "How do I remove the primary key on a table in Access?", "body": "<p>After much searching, I discovered a very clean way to do this using DAO.  You don't even have to resort to ADO or using the Index collection to find the primary keys.</p>\n\n<pre><code>Public Function RemovePrimaryKey(ByRef tdf As TableDef)\n    CurrentDb().Execute \"DROP INDEX PRIMARYKEY ON [\" &amp; tdf.Connect &amp; \"].[\" &amp; tdf.Name &amp; \"];\"\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 2472, "user_id": 603819, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zYtBs.png?s=128&g=1", "display_name": "Bobort", "link": "https://stackoverflow.com/users/603819/bobort"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1204, "favorite_count": 0, "accepted_answer_id": 32750230, "answer_count": 1, "score": 0, "last_activity_date": 1443045655, "creation_date": 1443045655, "question_id": 32750229, "link": "https://stackoverflow.com/questions/32750229/how-do-i-remove-the-primary-key-on-a-table-in-access", "title": "How do I remove the primary key on a table in Access?", "body": "<p>I have a frontend Access database with linked tables to a backend.  I'd like to be able to remove the primary key from a specific table with relative ease.  How do I do that?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1443043280, "post_id": 32749664, "comment_id": 53340048, "body": "Just a quick glance suggests you want <code>S = wsSource.Cells(x, 9)</code> for column I."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443043369, "post_id": 32749664, "comment_id": 53340082, "body": "Do you need formatting? Are you sure you want to delete rows?"}, {"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 0, "creation_date": 1443044220, "post_id": 32749664, "comment_id": 53340469, "body": "Just a thought since you&#39;re a self-proclaimed &quot;noob,&quot; but I&#39;m wondering if you&#39;re aware of Excel&#39;s auto-filter, which would let you filter these records on the same sheet without needing any VBA.  But perhaps you need them on a separate worksheet, in which case... carry on."}], "answers": [{"tags": [], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "is_accepted": false, "score": 5, "last_activity_date": 1443044923, "last_edit_date": 1443044923, "creation_date": 1443044273, "answer_id": 32749955, "question_id": 32749664, "link": "https://stackoverflow.com/questions/32749664/how-to-copy-rows-into-new-sheet-if-condition-is-met/32749955#32749955", "title": "How to copy rows into new sheet if condition is met?", "body": "<p>If you don't need formatting, this should work. Please note that this will \"copy\" any row where column I <strong>contains</strong> the letter \"T\". In other words, \"1T\", \"AT\", \"TT\", \"@T\" or any combination that <strong>includes</strong> \"T\" will get copied.</p>\n\n<pre><code>Sub CopyRow()\n\nApplication.ScreenUpdating = False\n\nDim x As Long\nDim MaxRowList As Long\nDim S As String\nDim wsSource As Worksheet\nDim wsTarget As Worksheet\n\nSet wsSource = ThisWorkbook.WorkSheets(\"Clients\")\nSet wsTarget = ThisWorkbook.WorkSheets(\"Tax - Pending\")\n\niCol = 1\nMaxRowList = wsSource.Cells(Rows.Count, iCol).End(xlUp).Row\n\nFor x = 3 To MaxRowList\n    If InStr(1, wsSource.Cells(x, 9), \"T\") Then\n    wsTarget.Rows(x).Value = wsSource.Rows(x).Value\n    End If\nNext\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>If you only want \"T\" and nothing else, then use</p>\n\n<pre><code>If wsSource.Cells(x, 9) = \"T\" Then\n</code></pre>\n\n<p>Edit: if you're appending data to the bottom of target sheet then change the <code>if</code> block to</p>\n\n<pre><code>If InStr(1, wsSource.Cells(x, 9), \"T\") Then\n    AfterLastTarget = wsTarget.Cells(Rows.Count, 1).End(xlUp).Row\n    wsTarget.Rows(AfterLastTarget + 1).Value = wsSource.Rows(x).Value\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5369546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5faf59cd155c12efc620b183cd4e142e?s=128&d=identicon&r=PG&f=1", "display_name": "Bhall", "link": "https://stackoverflow.com/users/5369546/bhall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10678, "favorite_count": 0, "protected_date": 1474813808, "answer_count": 1, "score": 2, "last_activity_date": 1474811626, "creation_date": 1443043125, "last_edit_date": 1443045251, "question_id": 32749664, "link": "https://stackoverflow.com/questions/32749664/how-to-copy-rows-into-new-sheet-if-condition-is-met", "title": "How to copy rows into new sheet if condition is met?", "body": "<p>as heads up I'm a complete noob when it comes to VBA though I've been trying (unsuccessfully?) to learn. </p>\n\n<p>I'm trying to copy a <strong>row</strong> of data from one sheet to another if column \"I\" contains a certain letter (or phrase). For instance, the data I'd like to copy is on a sheet called \"Clients\" and if column I contains the letter \"T\" then I'd like that data to auto-import into the next sheet called \"Tax - Pending\" but am having issues. I can also look at changing the text in column I to be more descriptive if necessary. My data starts on row 3 on all sheets (first two rows are headers). </p>\n\n<pre><code>Sub CopyRow()\n\nDim x As Long\nDim iCol As Integer\nDim MaxRowList As Long\nDim S As String\n\nSet wsSource = Worksheets(\"Clients\")\nSet wsTarget = Worksheets(\"Tax - Pending\")\n\niCol = 1\nMaxRowList = wsSource.Cells(Rows.Count, iCol).End(xlUp).Row\n\nFor x = MaxRowList To 1 Step -1\n    S = wsSource.Cells(x, 1)\n    If S = \"T\" Then\n        AfterLastTarget = wsTarget.Cells(Rows.Count, 1).End(xlUp).Row + 1\n        wsSource.Rows(x).Copy\n        wsTarget.Rows(AfterLastTarget).PasteSpecial Paste:=xlPasteValuesAndNumberFormats\n        wsSource.Rows(x).Delete\n    End If\nNext\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443042999, "post_id": 32749242, "comment_id": 53339908, "body": "<code>f = &quot;Budget.xls&quot;</code> You&#39;re setting and passing the file with the extension so not sure why that&#39;s a problem. Edit: I guess you could modify the function to take on a fifth argument for extension."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1443043126, "post_id": 32749242, "comment_id": 53339970, "body": "<code>ExecuteExcel4Macro</code> is loooooooooooong deprecated. Is there any reason you can&#39;t just <code>Application.Run</code> it?"}, {"owner": {"reputation": 435, "user_id": 3344443, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/101b3e8c8473364f363fbf286710da0d?s=128&d=identicon&r=PG&f=1", "display_name": "user3344443", "link": "https://stackoverflow.com/users/3344443/user3344443"}, "edited": false, "score": 0, "creation_date": 1443059965, "post_id": 32749242, "comment_id": 53344832, "body": "Sorry, I actually mean  f = &quot;Budget&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 435, "user_id": 3344443, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/101b3e8c8473364f363fbf286710da0d?s=128&d=identicon&r=PG&f=1", "display_name": "user3344443", "link": "https://stackoverflow.com/users/3344443/user3344443"}, "edited": false, "score": 0, "creation_date": 1443098785, "post_id": 32750034, "comment_id": 53362425, "body": "I agree with you. it seems that open another workbook then do the manipulation is better than get value directly from a closed workbook"}, {"owner": {"reputation": 435, "user_id": 3344443, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/101b3e8c8473364f363fbf286710da0d?s=128&d=identicon&r=PG&f=1", "display_name": "user3344443", "link": "https://stackoverflow.com/users/3344443/user3344443"}, "edited": false, "score": 0, "creation_date": 1443098876, "post_id": 32750034, "comment_id": 53362478, "body": "btw, why is normal excel behaviour shows A1=0? I know it does show 0, but I&#39;m just curious about it, as there is nothing in B1"}, {"owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "reply_to_user": {"reputation": 435, "user_id": 3344443, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/101b3e8c8473364f363fbf286710da0d?s=128&d=identicon&r=PG&f=1", "display_name": "user3344443", "link": "https://stackoverflow.com/users/3344443/user3344443"}, "edited": false, "score": 0, "creation_date": 1443102342, "post_id": 32750034, "comment_id": 53365123, "body": "Just guessing, but Excel probably prefers the use of <i>Type Long</i> if no other type is specified. So excel dims the value as <i>Type Long</i> if the cell it points to is empty. Therefore empty translates as 0."}], "tags": [], "owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "is_accepted": false, "score": 1, "last_activity_date": 1443044656, "creation_date": 1443044656, "answer_id": 32750034, "question_id": 32749242, "link": "https://stackoverflow.com/questions/32749242/get-a-value-from-a-closed-file/32750034#32750034", "title": "Get a value from a closed file", "body": "<p>This is normal Excel behaviour. If you put a formula in a cell A1</p>\n\n<p><code>=B1</code></p>\n\n<p>then A1 will also show a 0</p>\n\n<p>You can get a value with this code:</p>\n\n<pre><code>Public Function GetValue(sFileName As String, sSheetName As String, sAddress As String) As Variant\n\n    Dim oSheet As Worksheet\n\n    Application.ScreenUpdating = False\n\n    With Workbooks.Add(sFileName)\n        GetValue = .Sheets(sSheetName).Range(sAddress).Value\n        .Close\n    End With\n\n    Application.ScreenUpdating = True\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 435, "user_id": 3344443, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/101b3e8c8473364f363fbf286710da0d?s=128&d=identicon&r=PG&f=1", "display_name": "user3344443", "link": "https://stackoverflow.com/users/3344443/user3344443"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1779, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1443044656, "creation_date": 1443041479, "last_edit_date": 1443042084, "question_id": 32749242, "link": "https://stackoverflow.com/questions/32749242/get-a-value-from-a-closed-file", "title": "Get a value from a closed file", "body": "<p>I was looking a post at this link: <a href=\"http://spreadsheetpage.com/index.php/site/tip/a_vba_function_to_get_a_value_from_a_closed_file/\" rel=\"nofollow\">http://spreadsheetpage.com/index.php/site/tip/a_vba_function_to_get_a_value_from_a_closed_file/</a></p>\n\n<p>The function is</p>\n\n<pre><code>Private Function GetValue(path, file, sheet, ref)\n'   Retrieves a value from a closed workbook\n    Dim arg As String\n'   Make sure the file exists\n    If Right(path, 1) &lt;&gt; \"\\\" Then path = path &amp; \"\\\"\n    If Dir(path &amp; file) = \"\" Then\n        GetValue = \"File Not Found\"\n        Exit Function\n    End If\n'   Create the argument\n    arg = \"'\" &amp; path &amp; \"[\" &amp; file &amp; \"]\" &amp; sheet &amp; \"'!\" &amp; _\n      Range(ref).Range(\"A1\").Address(, , xlR1C1)\n'   Execute an XLM macro\n    GetValue = ExecuteExcel4Macro(arg)\nEnd Function\n</code></pre>\n\n<p>and to get a value,</p>\n\n<pre><code>Sub TestGetValue()\n    p = \"c:\\XLFiles\\Budget\"\n    f = \"Budget.xls\"\n    s = \"Sheet1\"\n    a = \"A1\"\n    MsgBox GetValue(p, f, s, a)\nEnd Sub\n</code></pre>\n\n<p>and to loop</p>\n\n<pre><code>Sub TestGetValue2()\n    p = \"c:\\XLFiles\\Budget\"\n    f = \"Budget.xls\"\n    s = \"Sheet1\"\n    Application.ScreenUpdating = False\n    For r = 1 To 100\n        For c = 1 To 12\n            a = Cells(r, c).Address\n            Cells(r, c) = GetValue(p, f, s, a)\n        Next c\n    Next r\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I think it's very well written. However I met two problems with it:\n1. If the source cell in closed file is blank (\"\" in VBA), I would got 0 in getvalue.  </p>\n\n<p>I wonder how I can pass 0 to 0 and pass \"\" to \"\"?<br>\nIs there a bug for ExecuteExcel4Macro?</p>\n\n<p>2.Suppose the source file has different extensions: xls, xlsx, xlsm, or xlsb,...\nHow can I get a dynamic path?  </p>\n\n<p>I tried to eliminate file extension in the path and use </p>\n\n<pre><code>arg = \"'\" &amp; path &amp; \"[\" &amp; file &amp; \".xl?]\" &amp; sheet &amp; \"'!\" &amp; _\n          Range(ref).Range(\"A1\").Address(, , xlR1C1)\n</code></pre>\n\n<p>however, it didn't work in ExecuteExcel4Macro.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 3207, "user_id": 1915920, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/6be77f4bfa373c33055ada8f3414ae09?s=128&d=identicon&r=PG", "display_name": "Andreas Covidiot", "link": "https://stackoverflow.com/users/1915920/andreas-covidiot"}, "edited": false, "score": 0, "creation_date": 1552291288, "post_id": 32748946, "comment_id": 96938030, "body": "I had the problem in an <code>Workbook_Open()</code> handler and the <code>...Activate</code> solution from <i>Bas Verlaat</i> below solved it nicely. Strangely the <code>Err</code> object was not available on this error so debugging was quite weird."}], "answers": [{"comments": [{"owner": {"reputation": 982, "user_id": 4163743, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6b53688d0bbc845af7c7e7907ba0013c?s=128&d=identicon&r=PG&f=1", "display_name": "PBeezy", "link": "https://stackoverflow.com/users/4163743/pbeezy"}, "edited": false, "score": 0, "creation_date": 1443042594, "post_id": 32749408, "comment_id": 53339703, "body": "I&#39;m trying to get the code module name. I just find it a little strange that code would run fine during development but then break when deployed to production, which happened to me."}, {"owner": {"reputation": 430, "user_id": 2062411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb35690c8349a6ac102b26378343981d?s=128&d=identicon&r=PG", "display_name": "Tyler StandishMan", "link": "https://stackoverflow.com/users/2062411/tyler-standishman"}, "reply_to_user": {"reputation": 982, "user_id": 4163743, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6b53688d0bbc845af7c7e7907ba0013c?s=128&d=identicon&r=PG&f=1", "display_name": "PBeezy", "link": "https://stackoverflow.com/users/4163743/pbeezy"}, "edited": false, "score": 0, "creation_date": 1443042679, "post_id": 32749408, "comment_id": 53339752, "body": "Ok. It&#39;s been a while since I&#39;ve looked at VBE stuff. I&#39;ll see what I can come up with."}, {"owner": {"reputation": 430, "user_id": 2062411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb35690c8349a6ac102b26378343981d?s=128&d=identicon&r=PG", "display_name": "Tyler StandishMan", "link": "https://stackoverflow.com/users/2062411/tyler-standishman"}, "reply_to_user": {"reputation": 982, "user_id": 4163743, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6b53688d0bbc845af7c7e7907ba0013c?s=128&d=identicon&r=PG&f=1", "display_name": "PBeezy", "link": "https://stackoverflow.com/users/4163743/pbeezy"}, "edited": false, "score": 0, "creation_date": 1443044153, "post_id": 32749408, "comment_id": 53340445, "body": "I&#39;ve updated my answer to house a short loop to get at CodePanes/CodeModules regardless if the VBE or any CodePanes are open. I noticed that <code>Application.VBE.CodePanes</code> was actually only the collection of <i>open</i> code panes, not all.  The method posted in my edit works when the VBE has not been opened previously."}, {"owner": {"reputation": 982, "user_id": 4163743, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6b53688d0bbc845af7c7e7907ba0013c?s=128&d=identicon&r=PG&f=1", "display_name": "PBeezy", "link": "https://stackoverflow.com/users/4163743/pbeezy"}, "edited": false, "score": 1, "creation_date": 1443102421, "post_id": 32749408, "comment_id": 53365176, "body": "Thank you. That&#39;s pretty slick. For future readers, just remember to add the reference to Microsoft Visual Basic for Applications Extensibility 5.3."}, {"owner": {"reputation": 430, "user_id": 2062411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb35690c8349a6ac102b26378343981d?s=128&d=identicon&r=PG", "display_name": "Tyler StandishMan", "link": "https://stackoverflow.com/users/2062411/tyler-standishman"}, "reply_to_user": {"reputation": 982, "user_id": 4163743, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6b53688d0bbc845af7c7e7907ba0013c?s=128&d=identicon&r=PG&f=1", "display_name": "PBeezy", "link": "https://stackoverflow.com/users/4163743/pbeezy"}, "edited": false, "score": 0, "creation_date": 1443201324, "post_id": 32749408, "comment_id": 53413574, "body": "Good point, thanks for mentioning the reference. If either of the answers helped you, would you mind marking one as an answer so future readers may know what helped most?"}], "tags": [], "owner": {"reputation": 430, "user_id": 2062411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb35690c8349a6ac102b26378343981d?s=128&d=identicon&r=PG", "display_name": "Tyler StandishMan", "link": "https://stackoverflow.com/users/2062411/tyler-standishman"}, "is_accepted": false, "score": 3, "last_activity_date": 1443044075, "last_edit_date": 1443044075, "creation_date": 1443042097, "answer_id": 32749408, "question_id": 32748946, "link": "https://stackoverflow.com/questions/32748946/why-doesnt-vbe-activecodepane-codemodule-work-when-the-vbe-code-window-isnt/32749408#32749408", "title": "Why doesn&#39;t VBE.ActiveCodePane.CodeModule work when the VBE (code window) isn&#39;t open?", "body": "<p>\nWell when the <code>VBE</code> is closed upon the first opening of the application, there is no <code>ActiveCodePane</code>, you can check this in a conditional upon loading your form:</p>\n\n<pre><code>If (Application.VBE.ActiveCodePane Is Nothing) Then MsgBox \"ActiveCodePane is Nothing\"\n</code></pre>\n\n<p>The <code>VBE</code> exists and properties and methods can be used, but there is no <code>ActiveCodePane</code> which is why you're receiving the null reference exception. Just opening the <code>VBE</code> will still produce your error if you closed all <code>CodePanes</code> before saving and closing previously (unless a module exists for some reason). You must the explicitly <em>open</em> a <code>CodePane</code>, to set the 'ActiveCodePane' property.</p>\n\n<p><a href=\"https://i.stack.imgur.com/cYO1D.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cYO1D.png\" alt=\"Access and VBE are open, but no &lt;code&gt;CodePane&lt;/code&gt; is open, therefore the &lt;code&gt;ActiveCodePane&lt;/code&gt; is still Nothing\"></a></p>\n\n<p>This makes sense. What is it that you're trying to access via the ActiveCodePane property? Perhaps I can help find a way around?</p>\n\n<h2>Edit</h2>\n\n<p>Presumably, as you develop this Form and associated Modules, you'll know what they're called, and would be able to use a different method than the <code>ActiveCodePane</code>, such as that which @Bas Verlaat mentioned. Alternatively, you can loop through each code pane in the active VBProject and try and match on a name or something:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate vbProj As VBIDE.VBProject\nPrivate vbComp As VBIDE.VBComponent\nPrivate vbMod As VBIDE.CodeModule\n\nPrivate Sub Command0_Click()\n\n    Set vbProj = Application.VBE.ActiveVBProject\n\n    For Each vbComp In vbProj.VBComponents\n        MsgBox vbComp.CodeModule\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "is_accepted": true, "score": 6, "last_activity_date": 1443042126, "creation_date": 1443042126, "answer_id": 32749416, "question_id": 32748946, "link": "https://stackoverflow.com/questions/32748946/why-doesnt-vbe-activecodepane-codemodule-work-when-the-vbe-code-window-isnt/32749416#32749416", "title": "Why doesn&#39;t VBE.ActiveCodePane.CodeModule work when the VBE (code window) isn&#39;t open?", "body": "<p>You reference the active pane object. The object isn't set until a pane gets activated. So before you open the VBE, the object is not set yet. Once you close the VBE, the object remains, so you can still reference it.</p>\n\n<p>To get a handle to the ActiveCodepane object, without opening the VBE, is by activating a VBComponent, like this:</p>\n\n<pre><code>VBE.ActiveVBProject.VBComponents(\"Module1\").Activate\n</code></pre>\n\n<p>You can activate any VBComponent like this.</p>\n"}, {"tags": [], "owner": {"reputation": 982, "user_id": 4163743, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6b53688d0bbc845af7c7e7907ba0013c?s=128&d=identicon&r=PG&f=1", "display_name": "PBeezy", "link": "https://stackoverflow.com/users/4163743/pbeezy"}, "is_accepted": false, "score": 2, "last_activity_date": 1443103577, "creation_date": 1443103577, "answer_id": 32763512, "question_id": 32748946, "link": "https://stackoverflow.com/questions/32748946/why-doesnt-vbe-activecodepane-codemodule-work-when-the-vbe-code-window-isnt/32763512#32763512", "title": "Why doesn&#39;t VBE.ActiveCodePane.CodeModule work when the VBE (code window) isn&#39;t open?", "body": "<p>As Bas Verlaat said, before you open the VBE, the object is not set yet.</p>\n\n<p>Obviously the VBE won't be open when a user is using the program. Referencing the Active Code Pane should only be done when developing and debugging, and never in production.</p>\n\n<p>For example the following custom made error message is great for debugging, but will fail if deployed to production.</p>\n\n<pre><code>ErrorHandler:\n    MsgBox \"Error \" &amp; Err.number &amp; \": \" &amp; Err.Description &amp; \" in \" &amp; _\n    VBE.ActiveCodePane.CodeModule, vbOKOnly, \"Error\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3207, "user_id": 1915920, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/6be77f4bfa373c33055ada8f3414ae09?s=128&d=identicon&r=PG", "display_name": "Andreas Covidiot", "link": "https://stackoverflow.com/users/1915920/andreas-covidiot"}, "is_accepted": false, "score": 0, "last_activity_date": 1573032813, "creation_date": 1573032813, "answer_id": 58726959, "question_id": 32748946, "link": "https://stackoverflow.com/questions/32748946/why-doesnt-vbe-activecodepane-codemodule-work-when-the-vbe-code-window-isnt/58726959#58726959", "title": "Why doesn&#39;t VBE.ActiveCodePane.CodeModule work when the VBE (code window) isn&#39;t open?", "body": "<h1>Approach</h1>\n\n<p>Since sometimes it can't be avoided to use VBE functionality, the general solution for me is this ...</p>\n\n<ol>\n<li>make sure to initialize/<strong>activate the relevant workbooks VB project (components)</strong></li>\n<li>make sure to initialize/<strong>activate other workbooks VB projects (components) after they are opened</strong> (<strong>if their VBE properties/code may be relevant</strong> later in the process)</li>\n</ol>\n\n<h1><code>VbeInit</code> usage</h1>\n\n<p>To do this one could call (see code below)</p>\n\n<ul>\n<li><strong><code>VbeInit</code> in the beginning of some event</strong> (e.g. the <code>Workbook_Open()</code> event) and </li>\n<li><strong><code>VbeInit someOpenedWorkbook</code></strong> whenever a relevant workbook was just opened (e.g. using <code>Workbooks.Open(...)</code>)</li>\n</ul>\n\n<h1>Example Case</h1>\n\n<p>It works for the simpler above case.\nA more complex case, where this is very obvious and necessary, is when you rely on the <code>CodeName</code> of sheets in workbooks. E.g.</p>\n\n<ul>\n<li>if the user is allowed to re<code>Name</code> some sheets, but they should still be uniquely identifiable by the VB application, via their <code>CodeName</code> and</li>\n<li>such sheets (e.g. serving as template sheets) are copied (<code>sheet.Copy ...</code>) to other workbooks.</li>\n</ul>\n\n<p>Then the sheets <code>CodeName</code> will only be copied, if the sheets <em>VBComponent</em> has been activated (e.g. via <code>myVBComponent.Activate</code> or opening the source-sheet-containing workbook in the VBE).</p>\n\n<h1>The <code>VbeInit</code> procedure</h1>\n\n<pre><code>Procedure VbeInit(Optional wb As Workbook)\n\n    With Application.VBE\n        Dim pj As VBProject:  For Each pj In .VBProjects\n            'ignore unsaved (=&gt; fully initialized) workbooks\n            If Not wb Is Nothing Then If wb.FullName &lt;&gt; VBProjFilename(pj) Then GoTo continue\n\n            Dim c As VBComponent:  For Each c In pj.VBComponents\n                c.Activate\n            Next c\n\ncontinue:\n        Next pj\n    End With\n\nEnd Procedure\n\n\nFunction VBProjFilename(pj As VBProject) As String\n    On Error Resume Next  'leave result empty if workbook (code) not saved yet\n    VBProjFilename = pj.Filename\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 982, "user_id": 4163743, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6b53688d0bbc845af7c7e7907ba0013c?s=128&d=identicon&r=PG&f=1", "display_name": "PBeezy", "link": "https://stackoverflow.com/users/4163743/pbeezy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3689, "favorite_count": 1, "accepted_answer_id": 32749416, "answer_count": 4, "score": 4, "last_activity_date": 1594237884, "creation_date": 1443040374, "last_edit_date": 1594237884, "question_id": 32748946, "link": "https://stackoverflow.com/questions/32748946/why-doesnt-vbe-activecodepane-codemodule-work-when-the-vbe-code-window-isnt", "title": "Why doesn&#39;t VBE.ActiveCodePane.CodeModule work when the VBE (code window) isn&#39;t open?", "body": "<p>Create a form that runs the following code.</p>\n\n<pre><code>MsgBox (VBE.ActiveCodePane.CodeModule)\n</code></pre>\n\n<p>And this message appears.</p>\n\n<p><a href=\"https://i.stack.imgur.com/tTIF5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tTIF5.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now save, close, and reopen the database, and see this message:</p>\n\n<p>Run-time error '91': Object variable or With block variable not set</p>\n\n<p><a href=\"https://i.stack.imgur.com/YXT8f.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YXT8f.png\" alt=\"enter image description here\"></a></p>\n\n<p>If you open the Visual Basic Editor, it runs again. Even if you close the VBE, it still runs.</p>\n\n<p>But when you close the whole application and reopen it, leaving the VBE closed, you get the error.</p>\n\n<p>Why? What's going on here?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "edited": false, "score": 0, "creation_date": 1443037801, "post_id": 32748146, "comment_id": 53337212, "body": "put all the fields on your report and set the visible property to match the checked items in the listBox"}, {"owner": {"reputation": 11, "user_id": 392723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec15fea2e23abbc902eb5aa036c611f5?s=128&d=identicon&r=PG", "display_name": "AdamR", "link": "https://stackoverflow.com/users/392723/adamr"}, "reply_to_user": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "edited": false, "score": 0, "creation_date": 1443037967, "post_id": 32748146, "comment_id": 53337323, "body": "Wouldn&#39;t that give me a bunch of blank empty space where the unused columns would be?"}, {"owner": {"reputation": 11, "user_id": 392723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec15fea2e23abbc902eb5aa036c611f5?s=128&d=identicon&r=PG", "display_name": "AdamR", "link": "https://stackoverflow.com/users/392723/adamr"}, "reply_to_user": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "edited": false, "score": 0, "creation_date": 1443038082, "post_id": 32748146, "comment_id": 53337387, "body": "Not quite what I&#39;m looking for then. Perhaps I should have been more specific."}, {"owner": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "edited": false, "score": 0, "creation_date": 1443038139, "post_id": 32748146, "comment_id": 53337419, "body": "can you post an example of what they would select and how you&#39;d like the report to look?"}, {"owner": {"reputation": 11, "user_id": 392723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec15fea2e23abbc902eb5aa036c611f5?s=128&d=identicon&r=PG", "display_name": "AdamR", "link": "https://stackoverflow.com/users/392723/adamr"}, "reply_to_user": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "edited": false, "score": 0, "creation_date": 1443038388, "post_id": 32748146, "comment_id": 53337555, "body": "It&#39;s a list of fields, if they select fields A, B, C and Z, then the report would only have 4 columns, all next to one another. If they select A, D, Q, and R it would still have 4 columns, all next to one another."}, {"owner": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "edited": false, "score": 0, "creation_date": 1443038492, "post_id": 32748146, "comment_id": 53337606, "body": "do they always select 4 columns?  You can have a list of controls with values like &#39;1st selected field,&#39; &#39;2nd selected field,&#39; but you still have to design your report to handle the worst case (&#39;n selected field&#39;)"}, {"owner": {"reputation": 11, "user_id": 392723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec15fea2e23abbc902eb5aa036c611f5?s=128&d=identicon&r=PG", "display_name": "AdamR", "link": "https://stackoverflow.com/users/392723/adamr"}, "reply_to_user": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "edited": false, "score": 0, "creation_date": 1443038616, "post_id": 32748146, "comment_id": 53337677, "body": "n selected fields is the norm. I don&#39;t plan to know how many they select. I think I&#39;m going to have to create a report using VBA...?"}, {"owner": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "edited": false, "score": 1, "creation_date": 1443038786, "post_id": 32748146, "comment_id": 53337754, "body": "no, VBA won&#39;t help.  You&#39;ll have to create a report to handle all of the columns being selected.  Maybe you want to change their x-positions and widths at runtime?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1443045612, "post_id": 32748146, "comment_id": 53341015, "body": "I have the feeling that an export to <b>Excel</b> would suit your requirement better than a report. An arbitrary number of column is much better to handle in a sheet than on fixed width paper."}, {"owner": {"reputation": 710, "user_id": 5021236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16637c5be814c194e7dde84f653d36d7?s=128&d=identicon&r=PG&f=1", "display_name": "jhTuppeny", "link": "https://stackoverflow.com/users/5021236/jhtuppeny"}, "edited": false, "score": 0, "creation_date": 1443083159, "post_id": 32748146, "comment_id": 53352755, "body": "I agree with Andre451 - creating your report in Excel will give you the flexibility and control that you need to create the desired report. I do all my reports to Excel these days."}], "owner": {"reputation": 11, "user_id": 392723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec15fea2e23abbc902eb5aa036c611f5?s=128&d=identicon&r=PG", "display_name": "AdamR", "link": "https://stackoverflow.com/users/392723/adamr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1443037224, "creation_date": 1443037224, "question_id": 32748146, "link": "https://stackoverflow.com/questions/32748146/dynamic-set-of-fields-in-access", "title": "Dynamic Set of Fields in Access", "body": "<p>I have tried several different ways of searching for this information with no luck so far...</p>\n\n<p>Firstly, I am using Access 2013, and I wouldn't exactly call myself experienced with it...</p>\n\n<p>I have a table with many fields and I want to be able to create a report dynamically that only uses a subset of those fields. The subset is to be determined by a ListBox (with multi select turned on) containing the list of all of the fields.</p>\n\n<p>So, a user will:</p>\n\n<ol>\n<li>Opens the filtering form that was created</li>\n<li>Selects the fields they wish to view</li>\n<li>Clicks \"Generate Report\"</li>\n<li>The report will only shown the fields that were asked for</li>\n</ol>\n\n<p>Is this possible? If so, how?</p>\n"}, {"tags": ["vba", "ms-word", "ini"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5369215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7715737d5fe26161de48b928b29216c?s=128&d=identicon&r=PG&f=1", "display_name": "Kem", "link": "https://stackoverflow.com/users/5369215/kem"}, "edited": false, "score": 0, "creation_date": 1443090113, "post_id": 32748972, "comment_id": 53356946, "body": "It works. Thank you so much. This is exactly what I was looking for."}], "tags": [], "owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "is_accepted": true, "score": 0, "last_activity_date": 1443040519, "creation_date": 1443040519, "answer_id": 32748972, "question_id": 32747652, "link": "https://stackoverflow.com/questions/32747652/how-to-change-section-text-in-ini-file-using-word-vba/32748972#32748972", "title": "How to change section text in INI file using Word VBA", "body": "<p>You can use this code to replace text in any text file</p>\n\n<pre><code>Public Sub Test()\n\n    ReplaceInTXT \"C:\\folder\\file.ini\", \"[OldName]\", \"[NewName]\"\n\nEnd Sub\n\nPublic Sub ReplaceInTXT(sFileName As String, sFind As String, sReplace As String)\n\n    Dim Content As String\n    Dim hFile As Long\n\n    hFile = FreeFile\n    Open sFileName For Input As #hFile\n    Content = Input$(LOF(hFile), hFile)\n    Close #hFile\n\n    Content = Replace(Content, sFind, sReplace)\n\n    Open sFileName For Output As #1\n    Print #1, Content\n    Close #1\n\nEnd Sub\n</code></pre>\n\n<p>Please make sure to have a backup first. I don't want to mess up the file</p>\n"}], "owner": {"reputation": 15, "user_id": 5369215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7715737d5fe26161de48b928b29216c?s=128&d=identicon&r=PG&f=1", "display_name": "Kem", "link": "https://stackoverflow.com/users/5369215/kem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 32748972, "answer_count": 1, "score": 0, "last_activity_date": 1443040519, "creation_date": 1443035479, "question_id": 32747652, "link": "https://stackoverflow.com/questions/32747652/how-to-change-section-text-in-ini-file-using-word-vba", "title": "How to change section text in INI file using Word VBA", "body": "<p>I have to change the section in an ini-file using Word VBA.<br>  </p>\n\n<p>I know how to change the values of the keys, but can anyone tell me how to  change the value of a section (the first section = the only section)? \nIn the example below I like to change OldName in NewName.</p>\n\n<p>[Offices]<br>\nOffice1=OldName<br></p>\n\n<p>[OldName]<br>\nKey1=value<br>\nKey2=value\netc.<br></p>\n\n<p>Thanks,<br>\nKem</p>\n"}, {"tags": ["vba", "relational-database"], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 5344631, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7mdaHiD-JoY/AAAAAAAAAAI/AAAAAAAAFe8/evNLJ2ASDRs/photo.jpg?sz=128", "display_name": "Zen Jamin", "link": "https://stackoverflow.com/users/5344631/zen-jamin"}, "is_accepted": false, "score": 0, "last_activity_date": 1443054084, "creation_date": 1443054084, "answer_id": 32751480, "question_id": 32747573, "link": "https://stackoverflow.com/questions/32747573/vba-update-related-table-without-creating-new-entry-on-commandsave/32751480#32751480", "title": "VBA Update Related Table without Creating new Entry on CommandSave", "body": "<p>So being new to access, I had created a relational table that was bound to the form.  On loading of the form it would create a new record on the parent table and save, which even after I would update the \"FruitTable\" would create a new record on top of updating a past Fruit reference.</p>\n\n<p>So after some research; I figured I had to unbind the FruitNum from the form, and do either an Update or Insert into the Fruit Table.</p>\n\n<p>After that I had to edit the form and manually do a search.  </p>\n\n<p>I dont think I explained my issue to well with the example but in case anyone looks and this pops up anywhere.  Was my first attempt at asking a question.</p>\n"}], "owner": {"reputation": 19, "user_id": 5344631, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7mdaHiD-JoY/AAAAAAAAAAI/AAAAAAAAFe8/evNLJ2ASDRs/photo.jpg?sz=128", "display_name": "Zen Jamin", "link": "https://stackoverflow.com/users/5344631/zen-jamin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1443054084, "creation_date": 1443035172, "last_edit_date": 1443035527, "question_id": 32747573, "link": "https://stackoverflow.com/questions/32747573/vba-update-related-table-without-creating-new-entry-on-commandsave", "title": "VBA Update Related Table without Creating new Entry on CommandSave", "body": "<p>Example:</p>\n\n<p>So Apples Oranges Bannana Tables insert their keys into Fruit Table</p>\n\n<p>Fruit<br>\nID AppleID OrangeID BannanaID FruitNum<br>\n1____1_________________________3<br>\n2____________4_________________3<br>\n3_____________________5________3  </p>\n\n<p>What I would like is for it to check for FruitNum 3 and update the table</p>\n\n<p>ID AppleID OrangeID BannanaID FruitNum<br>\n1____1_______4______5__________3        </p>\n\n<p>I got that to work with an update Statement but when I go and acRecordSave</p>\n\n<p>ID AppleID OrangeID BannanaID FruitNum<br>\n1____1_______4______5__________3<br>\n2___________________5__________3<br>\netc.</p>\n\n<p>Each Fruit is a Form and each entry has a Fruit Number that goes with it.  So when you fill out the Orange Form with 4 and then FruitNum 3, it should check to see if a FruitNum3 exists and update that table. And the CMD save should then not create a new record in the FruitNum table if it already exists.  Should I add a delete record after?  </p>\n\n<pre><code>  CurrentDb.Execute \"UPDATE [tableFruitNum] SET [\" &amp; NameFruit &amp; \"] = \" &amp; ID &amp; \" WHERE [FruitNum]=\" &amp; FruitNum\n</code></pre>\n\n<p>'How to Update a Table (For Future Reference)\n'Update table_name\n'SET column1=value1,column2=value2,...\n'WHERE some_column=some_value;</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1443036925, "post_id": 32747534, "comment_id": 53336744, "body": "I think you meant <code>ActiveCell.EntireRow.Range(Cells(i, 1), Cells(i, 2)).Select</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443042031, "post_id": 32747534, "comment_id": 53339427, "body": "@findwindow - that&#39;s effectively the same thing..."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1443042225, "post_id": 32747534, "comment_id": 53339524, "body": "@TimWilliams I guess I misunderstood the question."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1443042000, "creation_date": 1443042000, "answer_id": 32749375, "question_id": 32747534, "link": "https://stackoverflow.com/questions/32747534/find-values-in-a-column-and-select-the-cells-in-the-same-row/32749375#32749375", "title": "find values in a column and select the cells in the same row", "body": "<p>Tested:</p>\n\n<pre><code>Sub teste()\n\n    Dim TR As Long, i As Long, rng As Range\n    Dim sht as WorkSheet\n\n    Set sht = Worksheets(\"Format2\")\n    sht.Activate\n    TR = sht.Range(\"F\" &amp; Rows.Count).End(xlUp).Row\n\n    For i = TR To 1 Step -1\n        If sht.Range(\"F\" &amp; i).Value = \"SIM\" Then\n            If rng Is Nothing then\n                Set rng = sht.Cells(i, 1).Resize(1,2)\n            Else\n                Set rng = Application.Union(rng, sht.Cells(i, 1).Resize(1,2))\n            End If\n        End If\n    Next i\n\n    If Not rng Is Nothing Then rng.Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 4738768, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcf8048dcb33cc94c43150b813a1d15f?s=128&d=identicon&r=PG&f=1", "display_name": "user7004", "link": "https://stackoverflow.com/users/4738768/user7004"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1318, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443042000, "creation_date": 1443035047, "last_edit_date": 1531164843, "question_id": 32747534, "link": "https://stackoverflow.com/questions/32747534/find-values-in-a-column-and-select-the-cells-in-the-same-row", "title": "find values in a column and select the cells in the same row", "body": "<p>I have been working in a code to find the values \"SIM\" in the column F and select all the cells in the same row in column A and B. It is working, however, there are 2 \"SIM\", so it should select cells A and B in 2 rows, but it only did in one! can someone help me?\nthanks</p>\n\n<pre><code>Sub teste()\n\n'Alterar todo mes\n\nDim TR As Long, i As Long\n\nWorksheets(\"Format2\").Activate\n\n'Alterar todo mes\n\nTR = Range(\"F\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = TR To 1 Step -1\n    If (Range(\"F\" &amp; i)) = \"SIM\" Then\n    Rows(i).Select\nActiveCell.EntireRow.Range(\"A1:b1\").Select\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-project"], "answers": [{"tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1443042126, "creation_date": 1443042126, "answer_id": 32749415, "question_id": 32746793, "link": "https://stackoverflow.com/questions/32746793/loop-error-when-importing-from-excel-to-ms-project/32749415#32749415", "title": "Loop error when importing from Excel to MS Project", "body": "<ol>\n<li>Look carefully at the Task Unique IDs (or as you call them GUIDs) that you have stored in column L. Are the Task Unique IDs for the first two tasks in there twice? </li>\n<li>Only the task name is updated in this code and it is updated with the value from column C (start); that looks to be incorrect.</li>\n<li>Your code indentation is off which can lead to the code appearing to do something it's not--fix your indentation.</li>\n<li>The placement of the <code>End With</code> statement is wrong--move it just after the <code>Loop</code> line.</li>\n<li>If you want to update <strong>actual</strong> values be sure to use the task properties <code>t.ActualStart</code> and <code>t.ActualFinish</code>.</li>\n</ol>\n"}], "owner": {"reputation": 11, "user_id": 5369033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84ced03372b73d5dc8abd0d6f81a29df?s=128&d=identicon&r=PG&f=1", "display_name": "Fazz", "link": "https://stackoverflow.com/users/5369033/fazz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1443042126, "creation_date": 1443032563, "last_edit_date": 1443034991, "question_id": 32746793, "link": "https://stackoverflow.com/questions/32746793/loop-error-when-importing-from-excel-to-ms-project", "title": "Loop error when importing from Excel to MS Project", "body": "<p>I have a tool that reads an Excel file and converts it into an MS Project project plan. It also prints a list of tasks (uniqueIDs) back into the spreadsheet, which are used to match the Excel / project tasks. This part works fine, I'm trying to update it so the Excel file can be used to update an existing plan.</p>\n\n<p>The below code works fine for all but two project tasks and then the loop breaks. It also overwrites the first two tasks instead of updating only the matched task using the uniqueID.</p>\n\n<pre><code> dim statements\n Set prApp = New MSProject.Application\n\n    'If fileToOpen &lt;&gt; False Then\n\n    prApp.FileOpen \"c:\\users\\faizal\\desktop\\Project1.mpp\"\n\n    Set CurrProject = prApp.ActiveProject\n\n    With CurrProject\n\n        Set lshtProjStage2 = ActiveWorkbook.Worksheets(\"Project Stage - Gate 2\")\n\n        lshtProjStage2.Activate\n\n\n        ' Default place to start.\n\n        llngRowCounter = 10\n\n        llngTaskCounter = 0\n\n        lintBoldCellCount = 0\n\n\n        lsCellContent = lshtProjStage2.Range(\"B10\").Value\n\n        lblnSkipAddTask = False\n\n\n        lblnIndentNextCell = False\n\n\n        lsPreviousCellContent = \"\"\n\n        llngPerviousCellColour = -4142\n\n        llngPerviousTaskIndentLvl = 0\n\n        lblnPerviousCellBold = False\n\n\n        lshtProjStage2.Range(\"G\" &amp; Trim(CStr(llngRowCounter))).Select\n\n        lsTaskName = ActiveCell.Value\n\n\n        lshtProjStage2.Range(\"C\" &amp; Trim(CStr(llngRowCounter))).Select\n\n        start1 = ActiveCell.Value\n\n        llngTaskCounter = llngTaskCounter + 1\n\n\n        ' Going to loop through cells A10 until we reach \"Service Readiness\" in column B which is currently on row 28.\n\n            Do While lsCellContent &lt;&gt; \"\"\n\n            lsCellContent = lshtProjStage2.Range(\"B\" &amp; Trim(CStr(llngRowCounter))).Value\n\n            lshtProjStage2.Range(\"B\" &amp; Trim(CStr(llngRowCounter))).Select\n\n\n\n                If llngRowCounter &gt;= 10 Then\n\n                lsPreviousCellContent = lshtProjStage2.Range(\"B\" &amp; Trim(CStr(llngRowCounter - 1))).Value\n\n                llngPerviousCellColour = lshtProjStage2.Range(\"B\" &amp; Trim(CStr(llngRowCounter - 1))).Interior.ColorIndex\n\n                lblnPerviousCellBold = lshtProjStage2.Range(\"B\" &amp; Trim(CStr(llngRowCounter - 1))).Font.Bold\n\n                End If\n\n\n            lshtProjStage2.Range(\"C\" &amp; Trim(CStr(llngRowCounter))).Select\n\n            start1 = ActiveCell.Value\n\n\n            lshtProjStage2.Range(\"L\" &amp; Trim(CStr(llngRowCounter))).Select\n\n            guid = ActiveCell.Value\n\n\n            If start1 = \"\" Then\n\n                lblnSkipAddTask = True\n\n            Else\n\n                lblnSkipAddTask = False\n\n            End If\n\n            c1 = 11\n\n\n            For Each t In CurrProject.Tasks\n\n                If lblnSkipAddTask = False Then\n\n                ' find the excel file unique id in the Project file based on uniqueid and update\n\n                ' actual start, actual finish, perecent complete and duration\n\n                    If t.UniqueID = guid Then\n\n                    t.Name = start1\n\n                    't.Finish = fin\n\n\n           'need to exit the code once found to the next line in the excel sheet\n\n            Exit For\n\n                    End If\n\n                End If\n\n            Next t\n\n            c1 = c1 + 1\n\n            llngRowCounter = llngRowCounter + 1\n\n            lsCellContent = lshtProjStage2.Range(\"B\" &amp; Trim(CStr(llngRowCounter))).Value\n\n            ' Check if cell content is &lt;&gt; \"\" if so carry on else goto Column B.\n\n            If Trim(lsCellContent) = \"\" Then\n\n                lsCellContent = lshtProjStage2.Range(\"C\" &amp; Trim(CStr(llngRowCounter))).Value &amp; \" \"\n\n            End If\n\n            ' Check if in column B of this row we have \"Service Readiness\"\n\n            If lshtProjStage2.Range(\"C\" &amp; Trim(CStr(llngRowCounter))).Value = \"Service Readiness\" Then\n\n                lsCellContent = \"\"\n\n            End If\n\n            Loop\n\n\n    CurrProject.SaveAs\n\n    MsgBox (\"Test Text\" &amp; CStr(datecount))\n\nCleanExit:\n\n    Exit Sub\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#", "excel", "excel-interop", "excel-addins", "vba"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 1, "creation_date": 1443031844, "post_id": 32746305, "comment_id": 53333823, "body": "Can you post the code where you are closing the workbook?"}, {"owner": {"reputation": 41, "user_id": 3637892, "user_type": "registered", "profile_image": "https://graph.facebook.com/1591933394/picture?type=large", "display_name": "Diego Cruz", "link": "https://stackoverflow.com/users/3637892/diego-cruz"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1443032929, "post_id": 32746305, "comment_id": 53334494, "body": "I edited the original post to show you the code."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1443034002, "post_id": 32746305, "comment_id": 53335052, "body": "Looks good at first glance. Maybe somebody will have some insight.  Do you know for sure the macros are done running when your code is trying to quit the application?"}, {"owner": {"reputation": 41, "user_id": 3637892, "user_type": "registered", "profile_image": "https://graph.facebook.com/1591933394/picture?type=large", "display_name": "Diego Cruz", "link": "https://stackoverflow.com/users/3637892/diego-cruz"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1443036974, "post_id": 32746305, "comment_id": 53336767, "body": "Yes. I have in my original code an IMessageFilter implementation to handle the flow of operations and ensure that the application waits until the task has ended to start another one."}], "owner": {"reputation": 41, "user_id": 3637892, "user_type": "registered", "profile_image": "https://graph.facebook.com/1591933394/picture?type=large", "display_name": "Diego Cruz", "link": "https://stackoverflow.com/users/3637892/diego-cruz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 399, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1443032876, "creation_date": 1443030812, "last_edit_date": 1531161705, "question_id": 32746305, "link": "https://stackoverflow.com/questions/32746305/excel-application-running-in-background-when-using-solver-add-in", "title": "Excel application running in background when using Solver Add-in", "body": "<p>I'm developing a .NET application that opens a workbook, runs some VBA macros, refresh connections, etc. It's fine, but when I run some VBA macro that uses functions of Solver Add-in an Excel instance keep running even after I realeased all COM objects correctly (calling 'Marshal.ReleaseComObject').</p>\n\n<p>How can I solve it?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Here an example of code that reproduces this issue:</p>\n\n<pre><code>        Excel.Application xlApp = null;\n        Excel.Workbooks xlWorkbooks = null;\n\n        try\n        {               \n            xlApp = new Excel.Application();\n\n            xlApp.Visible = true;\n            xlApp.DisplayAlerts = false;\n\n            xlWorkbooks = xlApp.Workbooks;\n\n            Excel.Workbook xlWorkbook = xlWorkbooks.Open(Filename: path, ReadOnly: false);\n\n            xlApp.Run(macro);\n\n            xlWorkbook.RefreshAll();\n\n            xlWorkbook.Close(SaveChanges: true);\n\n            xlApp.Quit();\n\n            releaseObject(xlWorkbook);\n            releaseObject(xlWorkbooks);\n\n            releaseObject(xlApp);\n        }\n        catch (Exception e)\n        {\n            Console.WriteLine(\"Erro ao executar m\u00e9todos Excel\");\n            Console.WriteLine(e.Message);\n        }\n</code></pre>\n\n<p>And here the function I implemented to release the COM objects:</p>\n\n<pre><code>static void releaseObject(object o)\n    {\n        try\n        {\n            if (o != null) Marshal.ReleaseComObject(o);\n        }\n        catch\n        {\n            o = null;\n        }\n    }\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "edited": false, "score": 0, "creation_date": 1443031489, "post_id": 32746302, "comment_id": 53333631, "body": "You might need some work to find that kind of information. See <a href=\"http://smallbusiness.chron.com/see-accessed-file-last-network-66995.html\" rel=\"nofollow noreferrer\">smallbusiness.chron.com/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 3, "last_activity_date": 1443032329, "creation_date": 1443032329, "answer_id": 32746728, "question_id": 32746302, "link": "https://stackoverflow.com/questions/32746302/excel-file-accessed-user-names/32746728#32746728", "title": "Excel file accessed user names", "body": "<p>Excel 2010 and later has a <a href=\"https://support.office.com/en-us/article/track-changes-in-a-shared-workbook-22aea671-cac7-4fa3-845d-eeb23725bd15\" rel=\"nofollow\">track changes</a> feature that, if enabled, will show the author of any change in a shared workbook. I don't think that it can be used to track mere <em>access</em> but your question refers to users who have <em>accessed and edited</em> the contents. </p>\n"}, {"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 0, "last_activity_date": 1443032578, "creation_date": 1443032578, "answer_id": 32746800, "question_id": 32746302, "link": "https://stackoverflow.com/questions/32746302/excel-file-accessed-user-names/32746800#32746800", "title": "Excel file accessed user names", "body": "<p>I've been using the \"GetUserName()\" function from <a href=\"https://support.microsoft.com/en-us/kb/161394\" rel=\"nofollow\">here</a> for years. Stick that in a new module, and then in the ThisWorkbook code you can use something like:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Dim lastRow As Integer\n    lastRow = Sheet1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Sheet1.Cells(lastRow, 1).Value = GetUserName\n    Sheet1.Cells(lastRow, 2).Value = Now()\n    ThisWorkbook.Save\nEnd Sub\n</code></pre>\n\n<p>Then, when anyone opens the workbook, it will stick their username from the computer and the date/time into Sheet1 and keep a log of it.</p>\n"}], "owner": {"reputation": 1, "user_id": 5368959, "user_type": "registered", "profile_image": "https://graph.facebook.com/917164308366377/picture?type=large", "display_name": "Gowtham Muthu", "link": "https://stackoverflow.com/users/5368959/gowtham-muthu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1443032578, "creation_date": 1443030809, "last_edit_date": 1531164843, "question_id": 32746302, "link": "https://stackoverflow.com/questions/32746302/excel-file-accessed-user-names", "title": "Excel file accessed user names", "body": "<p>I've created an Excel report file and placed it in my office shared folder some of my office colleges have accessed and and edited the  contents. How I can find the recently accessed username of that file...???</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 3512530, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c40f173cb8f935778e156188466477e7?s=128&d=identicon&r=PG&f=1", "display_name": "Elixir", "link": "https://stackoverflow.com/users/3512530/elixir"}, "edited": false, "score": 0, "creation_date": 1443048446, "post_id": 32749005, "comment_id": 53342003, "body": "Thanks my vba skills isnt great but i&#39;ll try and edit the code so that users can use a file dialog to browse to a location to find the excel file"}], "tags": [], "owner": {"reputation": 1330, "user_id": 2340071, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1b7df7b14d4acb8db0ae1931c4ecce27?s=128&d=identicon&r=PG", "display_name": "Don George", "link": "https://stackoverflow.com/users/2340071/don-george"}, "is_accepted": true, "score": 1, "last_activity_date": 1443040623, "creation_date": 1443040623, "answer_id": 32749005, "question_id": 32746076, "link": "https://stackoverflow.com/questions/32746076/external-link-new-location-vba/32749005#32749005", "title": "External link new location VBA", "body": "<p>I use this function to re-link my tables from a table, based on whether I am working on my c:\\ drive or the network.  I think you could modify this to have the user enter a file location, or use a file dialog to browse to a location.</p>\n\n<p>Function relink_tables()</p>\n\n<pre><code>If Left(CurrentDb().Name, 2) = \"C:\" Then\n    source = \"local\"\n    Else: source = \"network\"\n    End If\nSet RS = CurrentDb.OpenRecordset(\"select * from [linked table source] where source='\" &amp; source &amp; \"'\")\nsource = RS.Fields(\"path\")\n\nFor Each R In References\n    If InStr(R.Name, \"Common Tables\") &gt; 0 Then Application.References.Remove R\n    Next R\nApplication.References.AddFromFile source\n\nx = 0\nSet TDefs = CurrentDb().TableDefs\nFor Each table In TDefs\n    If InStr(table.Connect, \"Common Tables\") = 0 Then GoTo NT\n    table.Connect = \";DATABASE=\" &amp; source\n    table.RefreshLink\n    x = x + 1\nNT:\n    Next table\nFinish:\nMsgBox \"remapped \" &amp; x &amp; \" tables\"\nEnd Function`enter code here`\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 273, "user_id": 3512530, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c40f173cb8f935778e156188466477e7?s=128&d=identicon&r=PG&f=1", "display_name": "Elixir", "link": "https://stackoverflow.com/users/3512530/elixir"}, "edited": false, "score": 0, "creation_date": 1443469539, "post_id": 32750792, "comment_id": 53496998, "body": "Hello I&#39;m trying to call the function but no luck my be its me not placing the code in the right location"}, {"owner": {"reputation": 1330, "user_id": 2340071, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1b7df7b14d4acb8db0ae1931c4ecce27?s=128&d=identicon&r=PG", "display_name": "Don George", "link": "https://stackoverflow.com/users/2340071/don-george"}, "reply_to_user": {"reputation": 273, "user_id": 3512530, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c40f173cb8f935778e156188466477e7?s=128&d=identicon&r=PG&f=1", "display_name": "Elixir", "link": "https://stackoverflow.com/users/3512530/elixir"}, "edited": false, "score": 1, "creation_date": 1443481753, "post_id": 32750792, "comment_id": 53502141, "body": "In the 1st answer, take out the 1st 2 blocks of code - everything above the line &quot;x=0&quot;.  Then add a line &quot;source=getfile()&quot;.  This should open a dialog box to navigate to a file.  Obviously, I have the code set up to remap anything that is mapped to a file called &quot;Common Tables&quot; and you&#39;ll want to change that part of the relink function as well."}], "tags": [], "owner": {"reputation": 1330, "user_id": 2340071, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1b7df7b14d4acb8db0ae1931c4ecce27?s=128&d=identicon&r=PG", "display_name": "Don George", "link": "https://stackoverflow.com/users/2340071/don-george"}, "is_accepted": false, "score": 1, "last_activity_date": 1443048953, "creation_date": 1443048953, "answer_id": 32750792, "question_id": 32746076, "link": "https://stackoverflow.com/questions/32746076/external-link-new-location-vba/32750792#32750792", "title": "External link new location VBA", "body": "<p>Here's a function I use to allow the user to browse to a file and select it.  You can call this function to get a file name in the prior function instead of getting it from the table.</p>\n\n<pre><code>Public Function Get_File(Optional ftype = \"xls\")\n\nDim fd As Object\nConst msoFileDialogFolderPicker = 4\nConst msoFileDialogFilePicker = 3\nConst msoFileDialogViewDetails = 2\n\n'Create a FileDialog object as a File Picker dialog box.\nSet fd = Application.FileDialog(msoFileDialogFilePicker)\nfd.AllowMultiSelect = False\nfd.ButtonName = \"Select\"\nfd.InitialView = msoFileDialogViewDetails\nfd.Title = \"Select File\"\nfd.InitialFileName = \"MyDocuments\\\"\nfd.Filters.Clear\nfd.Filters.Add \"Files\", \"*.\" &amp; ftype &amp; \"*\"\n\n'Show the dialog box and get the file name\nIf fd.Show = -1 Then\n    Get_File = fd.SelectedItems(1)\n    Else\n    Get_File = \"\"\n    End If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 273, "user_id": 3512530, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c40f173cb8f935778e156188466477e7?s=128&d=identicon&r=PG&f=1", "display_name": "Elixir", "link": "https://stackoverflow.com/users/3512530/elixir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1175, "favorite_count": 0, "accepted_answer_id": 32749005, "answer_count": 2, "score": 0, "last_activity_date": 1443048953, "creation_date": 1443030081, "question_id": 32746076, "link": "https://stackoverflow.com/questions/32746076/external-link-new-location-vba", "title": "External link new location VBA", "body": "<p>The below code works great for refreshing an external link in vba however is there a way of changing the location of the link?</p>\n\n<p>I can do this using linked table manager when ticking the 'Always prompt for new location', but I would like to do this via VBA, so that I could create a button for users to press to locate the new workbook</p>\n\n<p>Select new workbook, Relink external excel workbook.</p>\n\n<pre><code>Function Relink()\n\n    Set db = CurrentDb\n    Set tdf = db.TableDefs(\"Sales\")\n    tdf.Connect = \"Excel 5.0;HDR=YES;IMEX=2;\" &amp; _\n    \"DATABASE=C:\\Sales.xlsb\"\n    tdf.RefreshLink\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1443031572, "post_id": 32746055, "comment_id": 53333683, "body": "It would help to provide a simple example of a function which reliably causes the problem you&#39;re seeing."}, {"owner": {"reputation": 31, "user_id": 5368045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nImoo.jpg?s=128&g=1", "display_name": "ceegers", "link": "https://stackoverflow.com/users/5368045/ceegers"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1443033367, "post_id": 32746055, "comment_id": 53334745, "body": "Alright, edited with example."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1443034515, "post_id": 32746055, "comment_id": 53335349, "body": "OK I see it now - the #VALUE! error only shows up in certain cases and disappears if the edit the cell but make no changes.  New to me."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1443034709, "post_id": 32746055, "comment_id": 53335467, "body": "?  <a href=\"https://fastexcel.wordpress.com/2014/01/26/inserting-a-udf-and-launching-the-function-wizard-from-vba/\" rel=\"nofollow noreferrer\">fastexcel.wordpress.com/2014/01/26/&hellip;</a>"}, {"owner": {"reputation": 31, "user_id": 5368045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nImoo.jpg?s=128&g=1", "display_name": "ceegers", "link": "https://stackoverflow.com/users/5368045/ceegers"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1443036062, "post_id": 32746055, "comment_id": 53336249, "body": "Heh, that is an interesting potential solution... unfortunately doesn&#39;t seem to work for this situation (tried increasing to a full second for the heck of it too... it does indeed wait a second, but no dice on improved results)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1443040045, "post_id": 32746055, "comment_id": 53338418, "body": "I think the issue is within the Function Wizard itself - calling it a different way doesn&#39;t seem to make any difference..."}, {"owner": {"reputation": 31, "user_id": 5368045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nImoo.jpg?s=128&g=1", "display_name": "ceegers", "link": "https://stackoverflow.com/users/5368045/ceegers"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1443040199, "post_id": 32746055, "comment_id": 53338495, "body": "For me it does: If I type =LetNum( (or my actual functions) into a cell, then click on the fx button, all of these situations work just fine."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5368045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nImoo.jpg?s=128&g=1", "display_name": "ceegers", "link": "https://stackoverflow.com/users/5368045/ceegers"}, "edited": false, "score": 0, "creation_date": 1443043371, "post_id": 32749216, "comment_id": 53340083, "body": "I&#39;m okay with that kind of function-altering because it can be applied fairly universally. Thank you, I will try this later!"}, {"owner": {"reputation": 31, "user_id": 5368045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nImoo.jpg?s=128&g=1", "display_name": "ceegers", "link": "https://stackoverflow.com/users/5368045/ceegers"}, "edited": false, "score": 0, "creation_date": 1443045604, "post_id": 32749216, "comment_id": 53341013, "body": "This works for every one of my functions! The one thing that makes this not ideal is that now purposeful errors are being ignored, which may mean I need to look into sending errors differently. But yes, very useful, thank you!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1443041361, "creation_date": 1443041361, "answer_id": 32749216, "question_id": 32746055, "link": "https://stackoverflow.com/questions/32746055/functions-give-error-only-in-macro-called-dialog/32749216#32749216", "title": "Functions give error only in macro-called dialog", "body": "<p>The issue seems to be that any error triggered in your UDF effectively \"disables\" the Function Wizard: note that in cases where you get #VALUE! error, the <code>Show()</code> method never returns any value, and any lines following the call to <code>Show()</code> are not executed.</p>\n\n<p>The only thing which resolved this in my testing was to add a line to the function which skips any errors when the Function Wizard is open:</p>\n\n<pre><code>Dim bSettingUp As Boolean\n\nFunction LetNum(input1 As Variant, input2 As Variant) As Integer\n\n    If bSettingUp Then On Error Resume Next\n\n    If input1 = \"A\" Or input1 = \"a\" Then\n        input1 = 100\n    ElseIf input1 = 10 Then\n        input1 = -10\n    End If\n    If input2 = \"B\" Or input2 = \"b\" Then\n        input2 = 200\n    ElseIf input2 = 10 Then\n        input2 = -1000\n    End If\n    LetNum = input1 + input2\nEnd Function\n\nSub LetNum_dialog()\n    ActiveCell.Formula = \"=LetNum()\"\n    bSettingUp = True\n    Debug.Print Application.Dialogs(xlDialogFunctionWizard).Show()\n    bSettingUp = False\nEnd Sub\n</code></pre>\n\n<p>I'm aware that you'd rather not alter your functions ,but this was the only work-around I could find.</p>\n"}], "owner": {"reputation": 31, "user_id": 5368045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nImoo.jpg?s=128&g=1", "display_name": "ceegers", "link": "https://stackoverflow.com/users/5368045/ceegers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1443046041, "creation_date": 1443030010, "last_edit_date": 1495541827, "question_id": 32746055, "link": "https://stackoverflow.com/questions/32746055/functions-give-error-only-in-macro-called-dialog", "title": "Functions give error only in macro-called dialog", "body": "<p>I am writing and re-writing Excel VBA code to make some engineering analysis easier for myself and the others at my company. So the goal is to make it easy for others, not to be integrated into other code or purposes outside our own Excel work.  </p>\n\n<p>The problem: a few of the macros will add a custom function to a worksheet cell, bring up the function dialog for inputs, but then when completed, come up with a Value error, stating <em>A value used in the formula is of the wrong data type.</em> Based on this, I believe the issue arises when my function uses a Variant or Range type variable. Some of these functions only give this error via certain input types.  </p>\n\n<p>HOWEVER, in every single case, using the function dialog Not in the macro works fine, as does typing the formula in manually. Additionally, all you have to do is double-click on the error cell to edit it, change nothing, press enter, and it's fine!  </p>\n\n<p>My macros themselves are as simple as:  </p>\n\n<pre><code>Sub NewSTC_dialog()\n    ActiveCell.FormulaR1C1 = \"=sheetname.xlsm!NewSTC()\"\n    Application.Dialogs(xlDialogFunctionWizard).Show\nEnd Sub  \n</code></pre>\n\n<p>My functions have more to them, but the situation is different for different functions, and the functions themselves work fine, so it is preferable to have a solution that applies to the macros rather than within the functions. If I must, I can go through each situation individually or come up with a simplified function that has the same issue to give as an example.  </p>\n\n<p>My best workaround so far (I cannot re-find the website were I found this particular solution):  </p>\n\n<pre><code>Sub Recalculate()\n    ActiveCell.Replace What:=\"=\", Replacement:=\"=\"\nEnd Sub  \n</code></pre>\n\n<p>Set to a convenient shortcut, and it works great. However, as mentioned above, the goal is to make this easy for everyone else, which would mean not requiring anything additional to have the formula work. Unfortunately, calling this from within the initial macro will not work. In fact, nothing located after the dialog call will run. I tried using <code>On Error Resume Next</code> and it still won't run anything after the dialog call.</p>\n\n<p>Some options searched and tried:<br>\n<a href=\"https://stackoverflow.com/questions/13513942/how-to-refresh-cells-in-excel-2010-using-vba\">How to refresh cells in Excel 2010 using VBA?</a> and links within that - as mentioned, nothing located after the dialog call will run, thus won't reach these adjustments. Putting before the dialog call also doesn't help. Putting the dialog call in between the false and true statements makes the false apply, then never runs the true statement.<br>\n<a href=\"http://www.excelforum.com/excel-general/471632-formula-do-not-work-until-edited.html\" rel=\"nofollow noreferrer\">http://www.excelforum.com/excel-general/471632-formula-do-not-work-until-edited.html</a> - Excel is not set to manual<br>\n<a href=\"http://blog.contextures.com/archives/2012/02/16/excel-formulas-not-calculating/\" rel=\"nofollow noreferrer\">http://blog.contextures.com/archives/2012/02/16/excel-formulas-not-calculating/</a> - SUMIF is not involved</p>\n\n<p>This is all on Excel 2010, Windows 7 Professional.</p>\n\n<p>EDIT:\nHere is an example that creates this behavior. This is similar to the behavior of two of my functions, but not to all of them, so again, I would much prefer the solution be in the macro, not the function. This is just for anybody else's testing purposes.  </p>\n\n<pre><code>Function LetNum(input1 As Variant, input2 As Variant) As Integer\n    If input1 = \"A\" Or input1 = \"a\" Then\n        input1 = 100\n    ElseIf input1 = 10 Then\n        input1 = -10\n    End If\n    If input2 = \"B\" Or input2 = \"b\" Then\n        input2 = 200\n    ElseIf input2 = 10 Then\n        input2 = -1000\n    End If\n    LetNum = input1 + input2\nEnd Function\nSub LetNum_dialog()\n    ActiveCell.FormulaR1C1 = \"=LetNum()\"\n    Application.Dialogs(xlDialogFunctionWizard).Show\nEnd Sub\n</code></pre>\n\n<p>In this situation, typing A and 2 into the dialog box in that order works, but 2 into the second then A into the first doesn't. Additionally, typing B in the second box never works. In all situations, clicking to edit, changing nothing, and hitting enter, fixes it. Additionally, any situation in the dialog box if you bring it up without the macro works fine.</p>\n\n<p>Also, I'm aware this case works better if you input it with quotes, but excel automatically changes it correctly, and not all my functions are string issues.</p>\n\n<p>EDIT 2:<br>\nTim's answer is a great step in the right direction! However, if anybody can come up with a solution that doesn't involve ignoring all errors, that would be more ideal due to some desired error-throwing being ignored. I will look into handling errors differently in the meantime.</p>\n"}, {"tags": ["excel", "vba", "range", "autofilter"], "comments": [{"owner": {"reputation": 1, "user_id": 5326837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb8a285142a1c9a7559f262ad3bbb2f8?s=128&d=identicon&r=PG&f=1", "display_name": "msubjenkins", "link": "https://stackoverflow.com/users/5326837/msubjenkins"}, "reply_to_user": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1443041107, "post_id": 32745980, "comment_id": 53338957, "body": "So I figured it out. Going to post solution for anyone&#39;s future reference."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5326837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb8a285142a1c9a7559f262ad3bbb2f8?s=128&d=identicon&r=PG&f=1", "display_name": "msubjenkins", "link": "https://stackoverflow.com/users/5326837/msubjenkins"}, "is_accepted": false, "score": 0, "last_activity_date": 1443041497, "creation_date": 1443041497, "answer_id": 32749246, "question_id": 32745980, "link": "https://stackoverflow.com/questions/32745980/use-autofilter-to-copy-visible-cells-to-variable/32749246#32749246", "title": "Use autofilter to copy visible cells to variable", "body": "<p>So I figured it out. Here's the code below</p>\n\n<pre><code>With Sheet1\n.AutoFilterMode = False\nWith Range(\"A10\", Range(\"A\" &amp; Rows.Count).End(xlUp))\n    On Error Resume Next\n    .AUTOFILTER Field:=1, Criteria1:=\"=Device*\", Operator:=xlFilterValues\n    .Offset(1, 0).Resize(.Rows.Count - 1, 1).SpecialCells(xlCellTypeVisible).EntireRow.delete\n    .AUTOFILTER Field:=1, Criteria1:=\"=Manufacturer\", Operator:=xlFilterValues\n    .Offset(1, 0).Resize(.Rows.Count - 1, 1).SpecialCells(xlCellTypeVisible).EntireRow.delete\n    .AUTOFILTER Field:=1, Criteria1:=\"=(**\", Operator:=xlFilterValues\n    Set MyRange = Sheet1.Range(\"A10: I\" &amp; Cells(Rows.Count - 1, 1).End(xlUp).Row).Offset(1, 0).SpecialCells(xlCellTypeVisible)\n    CalVal = MyRange\n    .Offset(1, 0).Resize(.Rows.Count - 1, 1).SpecialCells(xlCellTypeVisible).EntireRow.delete\nEnd With\n.AutoFilterMode = False\nEnd With\n</code></pre>\n\n<p>This deletes the rows I needed deleted while saving the ones that start with \"(\".</p>\n\n<p>Later I paste it on sheet 2 after everything else has been copied.</p>\n\n<pre><code>'Paste Notes\nNumRows = UBound(CalVal, 1) - LBound(CalVal, 1) + 1\nNumCols = UBound(CalVal, 2) - LBound(CalVal, 2) + 1\nSet Destination = ws2.Range(\"A\" &amp; lastRow).Offset(1, 0)\nDestination.Value = \"Table Notes\"\nDestination.Font.Bold = True\nSet Destination = ws2.Range(\"A\" &amp; lastRow).Resize(NumRows, NumCols).Offset(2, 0)\nDestination = CalVal\n</code></pre>\n\n<p>Need to Dim MyRange, CalVal, LastRow, NumRows, and NumCols of course</p>\n"}], "owner": {"reputation": 1, "user_id": 5326837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb8a285142a1c9a7559f262ad3bbb2f8?s=128&d=identicon&r=PG&f=1", "display_name": "msubjenkins", "link": "https://stackoverflow.com/users/5326837/msubjenkins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594201459, "creation_date": 1443029750, "last_edit_date": 1594201459, "question_id": 32745980, "link": "https://stackoverflow.com/questions/32745980/use-autofilter-to-copy-visible-cells-to-variable", "title": "Use autofilter to copy visible cells to variable", "body": "<p>I'm using AutoFilter to delete some rows before a different macro is run. One of my filters brings up some notes that I need to save for later pasting. I assume saving it to a variable will allow me to then delete those rows and paste them when needed later. Here's what I have so far:</p>\n\n<pre><code>Sub Test()\n    With Sheet1\n        .AutoFilterMode = False\n        With Range(\"A10\", Range(\"A\" &amp; Rows.Count).End(xlUp))\n            On Error Resume Next\n            .AUTOFILTER Field:=1, Criteria1:=\"=(**\", Operator:=xlFilterValues\n            'Insert code to copy values to variable here\n            .Offset(1, 0).Resize(.Rows.Count - 1, 1).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n        End With\n        .AutoFilterMode = False\n    End With\nEnd Sub\n</code></pre>\n\n<p>I can't figure out how to copy the visible cells to a variable. Tried using xlCellTypeVisible but it didn't work. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1443029986, "post_id": 32745948, "comment_id": 53332745, "body": "<code>Cells(1 &amp; Columns.Count)</code> should be <code>Cells(1 ,Columns.Count)</code>.  Also you may want to look at how not to use <code>.Activate</code>.  It slows the process down."}, {"owner": {"reputation": 95, "user_id": 4866888, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c0356790677e86d0417a96c806059bce?s=128&d=identicon&r=PG&f=1", "display_name": "java2dev", "link": "https://stackoverflow.com/users/4866888/java2dev"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1443030334, "post_id": 32745948, "comment_id": 53332929, "body": "@ScottCraner I think it&#39;s working better but it put the last mandatory header in sheet3 in the cell A1 in sheet4, I think the macro only save the headers in the first cell"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1443030538, "post_id": 32745948, "comment_id": 53333069, "body": "Are all your headers that you want copied in the first row or in the &quot;A&quot; column?"}, {"owner": {"reputation": 95, "user_id": 4866888, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c0356790677e86d0417a96c806059bce?s=128&d=identicon&r=PG&f=1", "display_name": "java2dev", "link": "https://stackoverflow.com/users/4866888/java2dev"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1443030675, "post_id": 32745948, "comment_id": 53333160, "body": "They are from A1 to F1 with A,B,D,E are mandatory"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1443030779, "post_id": 32745948, "comment_id": 53333203, "body": "<code>Sheets(&quot;sheet3&quot;).Cells(i, &quot;A&quot;).Copy</code> is telling it that all your cells to copy are in column &quot;A&quot; at row i.  <code>Sheets(&quot;sheet3&quot;).Cells(1,i).Copy</code> goes across the first row matching your if statement."}, {"owner": {"reputation": 95, "user_id": 4866888, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c0356790677e86d0417a96c806059bce?s=128&d=identicon&r=PG&f=1", "display_name": "java2dev", "link": "https://stackoverflow.com/users/4866888/java2dev"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1443030962, "post_id": 32745948, "comment_id": 53333314, "body": "Yes I&#39;ve changed but it still is the same issue. I show that it check only mandatory but save only in A1"}, {"owner": {"reputation": 95, "user_id": 4866888, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c0356790677e86d0417a96c806059bce?s=128&d=identicon&r=PG&f=1", "display_name": "java2dev", "link": "https://stackoverflow.com/users/4866888/java2dev"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1443031452, "post_id": 32745948, "comment_id": 53333611, "body": "it could be because the sheet 4 is empty and I have this part <code>Lastcol1 = Sheets(&quot;sheet3&quot;).Cells(1, Columns.Count).End(xlToLeft).Column </code> as to calculate the field ones?"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 4866888, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c0356790677e86d0417a96c806059bce?s=128&d=identicon&r=PG&f=1", "display_name": "java2dev", "link": "https://stackoverflow.com/users/4866888/java2dev"}, "edited": false, "score": 0, "creation_date": 1443032639, "post_id": 32746481, "comment_id": 53334333, "body": "Thanks it&#39;s working, but the pasted Headers start from the B column"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 95, "user_id": 4866888, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c0356790677e86d0417a96c806059bce?s=128&d=identicon&r=PG&f=1", "display_name": "java2dev", "link": "https://stackoverflow.com/users/4866888/java2dev"}, "edited": false, "score": 0, "creation_date": 1443032968, "post_id": 32746481, "comment_id": 53334512, "body": "@java2dev Yes I forgot to shift the first one.  I have fixed the code"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 95, "user_id": 4866888, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c0356790677e86d0417a96c806059bce?s=128&d=identicon&r=PG&f=1", "display_name": "java2dev", "link": "https://stackoverflow.com/users/4866888/java2dev"}, "edited": false, "score": 0, "creation_date": 1443033126, "post_id": 32746481, "comment_id": 53334612, "body": "@java2dev if it answered your question please mark it as correct."}, {"owner": {"reputation": 95, "user_id": 4866888, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c0356790677e86d0417a96c806059bce?s=128&d=identicon&r=PG&f=1", "display_name": "java2dev", "link": "https://stackoverflow.com/users/4866888/java2dev"}, "edited": false, "score": 0, "creation_date": 1443033479, "post_id": 32746481, "comment_id": 53334797, "body": "Thank you a lot for your help"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1443032806, "last_edit_date": 1443032806, "creation_date": 1443031337, "answer_id": 32746481, "question_id": 32745948, "link": "https://stackoverflow.com/questions/32745948/vba-copy-a-specific-headers-from-a-sheet-to-another/32746481#32746481", "title": "VBA - Copy a specific headers from a sheet to another", "body": "<p>As in addition to what has been said above in the comments,  You are setting j to a column count of 0 by looking in an empty cells for the end.</p>\n\n<p>use this:</p>\n\n<pre><code>Dim i As Long, j As Long, Lastrow1 As Long, Lastcol1 As Long\n\nLastcol1 = Sheets(\"sheet3\").Cells(1 , Columns.count).End(xlToLeft).Column\nFor i = 1 To Lastcol1\n    j = Sheets(\"sheet4\").Cells(1 , Columns.count).End(xlToLeft).Offset(, 1).Column\n    if j = 2 and Sheets(\"sheet4\").Cells(1,j-1).value =\"\" then j=1\n    If ucase(Sheets(\"sheet3\").Cells(2, i).Value) = \"MANDATORY\" Then\n        Sheets(\"sheet3\").Cells(1, i).Copy Sheets(\"sheet4\").Cells(1,j)\n    End If\n    Application.CutCopyMode = False\nNext i\nSheets(\"sheet3\").Range(\"A1\").Select\n</code></pre>\n\n<p>And by the fact that you are going cell by cell instead of copying you can just make the new cell value equal to the old cell value.</p>\n\n<pre><code>Sheets(\"sheet4\").Cells(1,j).value = Sheets(\"sheet3\").Cells(1, i).value\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 4866888, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c0356790677e86d0417a96c806059bce?s=128&d=identicon&r=PG&f=1", "display_name": "java2dev", "link": "https://stackoverflow.com/users/4866888/java2dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1023, "favorite_count": 0, "accepted_answer_id": 32746481, "answer_count": 1, "score": 2, "last_activity_date": 1443032806, "creation_date": 1443029639, "last_edit_date": 1531164843, "question_id": 32745948, "link": "https://stackoverflow.com/questions/32745948/vba-copy-a-specific-headers-from-a-sheet-to-another", "title": "VBA - Copy a specific headers from a sheet to another", "body": "<p>I try to copy the headers who have the cell below with \"mandatory\" value but my Macro stop at the first cell.\nName   Phone  Houe no    Locality\nmandatory   mandatory</p>\n\n<pre><code>  Dim i As Long, j As Long, Lastrow1 As Long, Lastcol1 As Long\nDim mandatory As String\n\n'Lastrow1 = Sheets(\"sheet3\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nLastcol1 = Sheets(\"sheet3\").Cells(1 &amp; Columns.Count).End(xlToLeft).Column\nFor i = 1 To Lastcol1\n\nSheets(\"sheet4\").Activate\nLastcol2 = Sheets(\"sheet4\").Cells(1 &amp; Columns.Count).End(xlToLeft).Column\nFor j = 1 To Lastcol2\n\nIf Sheets(\"sheet3\").Cells(2, i).Value = \"mandatory\" Then\nSheets(\"sheet3\").Activate\nSheets(\"sheet3\").Cells(i, \"A\").Copy\nSheets(\"sheet4\").Activate\nSheets(\"sheet4\").Cells(j, \"A\").Select\nActiveSheet.Paste\nEnd If\n\nNext j\n\nApplication.CutCopyMode = False\nNext i\nSheets(\"sheet3\").Activate\nSheets(\"sheet3\").Range(\"A1\").Select\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "printing", "ms-word"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 1, "creation_date": 1443046688, "post_id": 32745131, "comment_id": 53341414, "body": "I see many issues in your code though not exactly where the sheets are being generated. I would start with in <code>With Sheets(&quot;Ticket&quot;)</code> you are not using a period to qualify the properties. For example on <code>Range(&quot;C1:H30&quot;).Select</code> it should be <code>.Range(&quot;C1:H30&quot;).Select</code> to relate to that range in the &quot;Ticket&quot; sheet. Fix that reference so it&#39;s clearer and your issue will be easier to identify. I suggest you set a breakpoint at the start of your loop and then pressing F8 step through and viewing each step of the way at what point those extra sheets are created. Regards,"}, {"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1443178593, "post_id": 32745131, "comment_id": 53399545, "body": "Also see <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using select in Excel VBA macros</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "is_accepted": false, "score": 0, "last_activity_date": 1443180953, "creation_date": 1443180953, "answer_id": 32781305, "question_id": 32745131, "link": "https://stackoverflow.com/questions/32745131/copy-from-excel-to-word-and-print-code-creates-copy-of-workbook-each-time-it-pr/32781305#32781305", "title": "Copy from Excel to Word and print, code creates copy of workbook each time it prints", "body": "<p>The problem is the line:</p>\n\n<pre><code>WdObj.Selection.PasteSpecial Link:=False, _\n        DataType:=wdPasteText, Placement:=wdInLine, DisplayAsIcon:=False\n</code></pre>\n\n<p>This uses the constants <code>wdPasteText</code> and <code>wdInLine</code>, which are not defined within Excel VBA.  Effectively you are executing the following:</p>\n\n<pre><code>WdObj.Selection.PasteSpecial Link:=False, _\n        DataType:=\"\", Placement:=\"\", DisplayAsIcon:=False\n</code></pre>\n\n<p>The default Paste Special mode for Excel ranges appears to be <code>wdPasteOLEObject</code> - an embedded Excel sheet.  As part of the process of creating this, Word creates a new Excel workbook with the pasted data in it.  These are the workbooks you see.  If you open Excel (with the VBA editor open) and manually copy a range and paste special/object into Word you can see the temp workbook being created, then quickly closed again.  Unfortunately if this happens while some code is running, all sorts of strange things seem to happen.  I've not had the workbooks stay open, but I have had the macro stop randomly, documents and/or workbooks closing, code execution jumping to macros in other books, etc.</p>\n\n<p>The fix for you is easy since you don't want an embedded Excel object - replace <code>wdPasteText</code> and <code>wdInLine</code> with their numeric values, which are 2 and 0:</p>\n\n<pre><code>WdObj.Selection.PasteSpecial Link:=False, _\n        DataType:=2, Placement:=0, DisplayAsIcon:=False\n</code></pre>\n\n<p>And finally, this is a great example of why you should always set <code>Option Explicit</code> at the top of your code.  If you had, you would have got a \"Variable not defined\" error for <code>wdPasteText</code> and <code>wdInLine</code>, which would have taken you straight to the problem.</p>\n"}], "owner": {"reputation": 81, "user_id": 2535579, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0b2c811deffead87b828d38b629da555?s=128&d=identicon&r=PG", "display_name": "awsmitty", "link": "https://stackoverflow.com/users/2535579/awsmitty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 737, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1443180953, "creation_date": 1443026908, "last_edit_date": 1443043735, "question_id": 32745131, "link": "https://stackoverflow.com/questions/32745131/copy-from-excel-to-word-and-print-code-creates-copy-of-workbook-each-time-it-pr", "title": "Copy from Excel to Word and print, code creates copy of workbook each time it prints", "body": "<p>The code posted below creates a copy of the workbook containing the macro each iteration of the for loop.</p>\n\n<p>The code transfers some information from one sheet to a sheet named \"Ticket\".  The code then opens a Word file which has a header and footer and a watermark of the company logo, copies the info from the Excel sheet (\"Ticket\") to the Word document with the watermark, and then prints the Word document. Once the code has finished executing there is a new Excel book (a hidden book at that) for each ticket printed, Book1, Book2, Book3, etc (all hidden).  I have no idea where these books are being saved or how to stop this from happening.  </p>\n\n<p>Can someone explain what I've done, please? </p>\n\n<pre><code>Sub A_PrintDailyTickets()\n'---------------------------------------------------------------------------------------\n' Procedure : A_PrintDailyTickets\n' Author    : AWS\n' Date      : 9/5/2015\n' Purpose   : Print a full day's worth of tickets for all three trucks, with word using the Soul's Harbor water mark\n'               Complete 9/5/2015\n'\n'---------------------------------------------------------------------------------------\n    Dim lLstRow As Long, ws As Worksheet\n    Dim WdObj As Object, fname As String ' , objDoc As Object\nApplication.ScreenUpdating = False\nSet ws = ActiveSheet\nfname = \"Word\"\n\nWith Sheets(\"Ticket\")\n    lLstRow = ActiveSheet.Range(\"A50\").End(xlUp).Row\n    For i = 2 To lLstRow\n        Sheets(\"Ticket\").Cells(2, 4).Value = ws.Cells(i, 1).Value    ' Date\n        Sheets(\"Ticket\").Cells(4, 3).Value = ws.Cells(i, 2).Value    ' Route\n        Sheets(\"Ticket\").Cells(6, 8).Value = ws.Cells(i, 4).Value    ' Phone-1\n        Sheets(\"Ticket\").Cells(7, 8).Value = ws.Cells(i, 5).Value    ' Phone-2\n        Sheets(\"Ticket\").Cells(6, 3).Value = ws.Cells(i, 6).Value    ' Name\n        Sheets(\"Ticket\").Cells(7, 3).Value = ws.Cells(i, 7).Value    ' Address\n        Sheets(\"Ticket\").Cells(8, 3).Value = ws.Cells(i, 8).Value &amp; \", TX\"    ' City\n        Sheets(\"Ticket\").Cells(9, 5).Value = ws.Cells(i, 9).Value    ' Zip\n        Sheets(\"Ticket\").Cells(14, 3).Value = ws.Cells(i, 10).Value    ' Items\n        Sheets(\"Ticket\").Cells(21, 3).Value = ws.Cells(i, 11).Value    ' Notes\n\n        Set WdObj = CreateObject(\"Word.Application\")\n        WdObj.Visible = False\n\n        Sheets(\"Ticket\").Select\n        Range(\"A1:H30\").Select\n        Selection.Copy    'Your Copy Range\n\n        WdObj.Documents.Open Filename:= _\n            \"C:\\Users\\AWS\\Documents\\Excel\\Zip Codes - Soul's Harbor\\Monthly Route Sheets\\Donor Receipt\\Soul's Harbor Donation Templet (Blank) - Usable - 2.docx\"\n        WdObj.Selection.PasteSpecial Link:=False, _\n            DataType:=wdPasteText, Placement:=wdInLine, DisplayAsIcon:=False\n        Application.CutCopyMode = False\n        If fname &lt;&gt; \"\" Then    'make sure fname is not blank\n            With WdObj\n                '.ChangeFileOpenDirectory \"c:\\temp\"    'save Dir\n                '.ActiveDocument.SaveAs Filename:=fname &amp; \".doc\"\n            End With\n        Else:\n            MsgBox (\"File not saved, naming range was botched, guess again.\")\n        End If\n        WdObj.PrintOut\n        WdObj.ActiveDocument.Close savechanges:=False\n        WdObj.Quit savechanges:=False\n\n        Range(\"C1:H30\").Select\n        Selection.ClearContents\n        Range(\"E1\").Select\n        Application.CutCopyMode = False\nSet WdObj = Nothing\n'Set objDoc = Nothing\n\n    Next\nEnd With\nws.Select\nSet ws = Nothing\nSet WdObj = Nothing\n'Set objDoc = Nothing\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443026658, "post_id": 32745041, "comment_id": 53330957, "body": "Try <code>File1.Range(&quot;A1&quot;).Value = &quot;Help!&quot;</code> Edit: oh, you need worksheet."}, {"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "edited": false, "score": 0, "creation_date": 1443026853, "post_id": 32745041, "comment_id": 53331051, "body": "<code>Workbooks(File1).Sheets(&quot;NameOfSheet&quot;).Range(&quot;A1&quot;).Value = &quot;Help!&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4874204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CDzae.png?s=128&g=1", "display_name": "rorance_", "link": "https://stackoverflow.com/users/4874204/rorance"}, "edited": false, "score": 0, "creation_date": 1443040795, "post_id": 32745862, "comment_id": 53338816, "body": "Thank you very much, how then would I go about declaring the original work book. If I use the same Set X = Workbooks.Open, then it will re-open the file, which is not necessarily what I want to do, as it closes the vba window which contains the macro."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1443055843, "post_id": 32745862, "comment_id": 53343946, "body": "The original workbook doesn&#39;t close - it&#39;s the file currently running the code; to close it you need to use <code>ThisWorkbook.Close</code>. You don&#39;t need to declare a separate variable for it, but you can: <code>Dim originalWB as Workbook: Set originalWB = ThisWorkbook</code>. I&#39;ll update the answer to show how to copy a value from the new file into the current (original) file"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 2, "last_activity_date": 1443056390, "last_edit_date": 1443056390, "creation_date": 1443029369, "answer_id": 32745862, "question_id": 32745041, "link": "https://stackoverflow.com/questions/32745041/declaring-a-variable-that-works-with-workbooks/32745862#32745862", "title": "Declaring a variable that works with Workbooks()", "body": "<p>To fix your code update the last line to:</p>\n\n<pre><code>File1.Worksheets(\"Sheet1\").Range(\"A1\").Value = \"Help!\"\n</code></pre>\n\n<hr>\n\n<p>More details:</p>\n\n<pre><code>Option Explicit\n\nPrivate Const WBM_PATH  As String = \"D:\\test\\folder1\\\"      'Module-level constant\nPrivate Const WBM_NAME  As String = \"file1.xlsx\"\n\nPrivate Const WBM_ERR   As String = \"Unable to open Master file\"\nPrivate Const BR        As String = vbCrLf &amp; vbCrLf\n\nPrivate wbM As Workbook, wsM As Worksheet, urM As Range     'Module-level variables\n\nPublic Sub MasterMacro()\n    If wbM Is Nothing Then\n        If Len(Dir(WBM_PATH, vbDirectory)) &gt; 0 Then             'If folder exists\n            If Len(Dir(WBM_PATH &amp; WBM_NAME)) &gt; 0 Then           'If file exists\n                Set wbM = Workbooks.Open(WBM_PATH &amp; WBM_NAME)   'Set all Master objects\n                Set wsM = wbM.Worksheets(\"Sheet1\")\n                Set urM = wsM.UsedRange\n                urM.Cells(1, 1).Value2 = \"Test\"                 'Set text in Cell A1\n\n                'copy value from file1.xlsx into the file executing the code\n                ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1\").Value = urM.Cells(1, 1)\n\n                'copy a new value from original file into file1.xlsx\n                ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A2\") = \"Test2\"\n                urM.Cells(2, 1) = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A2\")\n\n                wbM.Close True  'close file1.xlsx, saving changes\n            Else\n                MsgBox \"File '\" &amp; WBM_PATH &amp; WBM_NAME &amp; \"' doesn't exist\" &amp; BR &amp; WBM_ERR\n            End If\n        Else\n            MsgBox \"Folder '\" &amp; WBM_PATH &amp; \"' doesn't exist\" &amp; BR &amp; WBM_ERR, , WBM_ERR\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4874204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CDzae.png?s=128&g=1", "display_name": "rorance_", "link": "https://stackoverflow.com/users/4874204/rorance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443056390, "creation_date": 1443026588, "last_edit_date": 1443027388, "question_id": 32745041, "link": "https://stackoverflow.com/questions/32745041/declaring-a-variable-that-works-with-workbooks", "title": "Declaring a variable that works with Workbooks()", "body": "<p>I'm looking to build a macro in one workbook (the 'master' workbook), which will grab code from other workbooks on my computer and paste it into the master workbook.</p>\n\n<p>I'm new to this, but I understand that the workbooks have to be open before you can select ranges, copy data etc. </p>\n\n<p>What I'd like to be able to do, is assign the path of all my workbooks, to variables, so that I can call them/read/write to them easily. What I'm trying to do is illustrated in the code below</p>\n\n<pre><code>Sub MasterMacro()\n\n    Dim MasterFile, File1 As Workbook\n\n    Set File1 = Workbooks.Open(\"D:\\test\\folder1\\file1.xlsx\")\n\n    Workbooks(File1).Range(\"A1\").Value = \"Help!\"\n\nEnd Sub\n</code></pre>\n\n<p>However, this produces a Run Time Error '13' - Type mismatch when it tries to change the value of A1. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1443037867, "post_id": 32745025, "comment_id": 53337249, "body": "Are you searching column one or column I? Your code has column one."}], "answers": [{"tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 1, "last_activity_date": 1443134682, "creation_date": 1443134682, "answer_id": 32772141, "question_id": 32745025, "link": "https://stackoverflow.com/questions/32745025/1st-identify-column-2nd-identify-value-in-column-3-insert-data-from-that-row/32772141#32772141", "title": "1st) Identify Column 2nd) Identify value in column 3) Insert data from that row into array", "body": "<p>I find your question confusing.</p>\n\n<p>Example 1: what is <code>I:10 to Z:10</code>?  Do you mean <code>I10 to Z10</code> or <code>I10:Z10</code>?  The colon goes between two single cell addresses to define a range.</p>\n\n<p>Example 2: the text implies the list of account names are in column I (=9) but your code searches column 1 (=A).</p>\n\n<p>In this answer I give you information that I hope will point you in the correct direction.</p>\n\n<hr>\n\n<p>Consider: <code>Set ws = ThisWorkbook.Sheets(1)</code>.</p>\n\n<p>The user can have several workbooks open.  Let us call then A, B, C and D.  The user can have A active but call a macro in D.  When this situation is possible, you can use <code>ActiveWorkbook</code> to refer to the active workbook and <code>ThisWorkbook</code> to refer to the workbook containing the macro.  If you think there is a possibility that the user will call the macro from another workbook, you are correct to specifically identify that you want a worksheet from the workbook containing the macro.  Otherwise <code>Set ws = Sheets(1)</code> would have given you a worksheet within the active workbook.</p>\n\n<p>Avoid <code>Sheets(1)</code> or <code>Sheets(2)</code>.  Here the 1 and 2 refer to the sequence within the tab row which the user can change easily either deliberately or accidentally.  Create a new workbook and copy this code to a module:</p>\n\n<pre><code>Option Explicit\nSub Test1()\n\n  Dim InxWsht As Long\n\n  For InxWsht = 1 To Worksheets.Count\n    Debug.Print Worksheets(InxWsht).Name\n  Next\n\nEnd Sub\n</code></pre>\n\n<p>If you have an English version of Excel with the default number of sheets, this macro will output the following to the Immediate Window:</p>\n\n<pre><code>Sheet1\nSheet2\nSheet3\n</code></pre>\n\n<p>Now move Sheet2 so it is after Sheet3 and rerun the macro.  The output is now:</p>\n\n<pre><code>Sheet1\nSheet3\nSheet2\n</code></pre>\n\n<p>Always identify worksheets by name; for example: Worksheets(\"Ledgers\") so the user cannot accidentally break your macro.</p>\n\n<hr>\n\n<p>Consider <code>Set aCell = .Columns(1).Find . . .</code></p>\n\n<p>As I said this searches column 1 although your text says column I.  This might just be a typographical error but it is better to avoid using literals for columns in the body of your code.  Columns move as new columns are added or the users want a new sequence.  Searching through code trying to identify which numbers refer to a column so you can update them can be a nightmare which is easily avoided.</p>\n\n<pre><code>Const ColName As Long = 9\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Const ColName As String = \"I\"\n</code></pre>\n\n<p>allows you to write</p>\n\n<pre><code>Set aCell = .Columns(ColName).Find . . .\n</code></pre>\n\n<p>Now if the column containing the ledger names moves, one change at the top updates the code.  There is also the advantage that \u201cColName\u201d means something to a future maintenance programmer (which might be you).  If you had ever tried to update a macro in which the author refers to 20 different columns by number, you would understand why I like names.</p>\n\n<hr>\n\n<p>I loaded your list of names to column \u201cA\u201d of worksheet \u201cLedgers\u201d.  Below is a modified version of your macro.  Study my changes and attempt to understand why I made them.  Come back with questions as necessary but the more you can work out for yourself, the faster you will develop.</p>\n\n<pre><code>Sub Sample()\n\n    Const ColName As Long = 1\n    Const ColFirstWanted As Long = 2\n\n    Dim ws As Worksheet\n    Dim MyAr As Variant\n    Dim SearchString As String\n    Dim aCell As Range\n    Dim ColCrnt As Long   ' Avoid names like i; they can get very confusing.\n    Dim ColLast As Long\n\n    SearchString = \"Dividend Income\"\n\n    '~~&gt; Change this as applicable\n    Set ws = Worksheets(\"Ledgers\")\n\n    With ws\n        Set aCell = .Columns(ColName).Find(What:=SearchString, LookIn:=xlValues, _\n                    LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n                    MatchCase:=False, SearchFormat:=False)\n\n        If Not aCell Is Nothing Then\n            ' Find last used column in row\n            ColLast = .Cells(aCell.Row, Columns.Count).End(xlToLeft).Column\n\n            '~~&gt; Amend as applicable\n            '~~&gt; Store the values From say Col B to E in the array\n            '## Note: Transpose is slow when called from VBA.\n            MyAr = .Range(.Cells(aCell.Row, ColFirstWanted), .Cells(aCell.Row, ColLast)).Value\n\n            '~~&gt; Check what is in the array\n            ' ## Note: Although the worksheet row is not 1 and the first column is not 1,\n            ' ##       the lower bounds are both 1. This can be confusing. I suggest\n            ' ##       loading the entire row so the worksheet column numbers match the array\n            ' ##       column numbers.  A few extra columns in the array is a small price to pay\n            ' ##       reduced confusion.\n            For ColCrnt = LBound(MyAr, 2) To UBound(MyAr, 2)\n                Debug.Print ColCrnt &amp; \" \" &amp; MyAr(1, ColCrnt)\n            Next ColCrnt\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1256, "user_id": 3128069, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4cdd27382d73700ac43edb0becdc1a7b?s=128&d=identicon&r=PG&f=1", "display_name": "phillipsK", "link": "https://stackoverflow.com/users/3128069/phillipsk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443134682, "creation_date": 1443026517, "last_edit_date": 1443028216, "question_id": 32745025, "link": "https://stackoverflow.com/questions/32745025/1st-identify-column-2nd-identify-value-in-column-3-insert-data-from-that-row", "title": "1st) Identify Column 2nd) Identify value in column 3) Insert data from that row into array", "body": "<p>I am trying to gather the horizontal data (left to right) Beginning in cell I10 - I am first trying to code the macro to identify the correct ledger account in column I. Column I is below with I:10 pepresenting the column I want, <code>Dividend Income</code></p>\n\n<pre><code>Ledger Account\nPrior Shares Outstanding\nCurrent Shares Outstanding\nCurrent Share Activity\nPrevious Net Assets\nCurrent Net Assets\nNet Asset Change\nMarket Value\nTrading Gain Loss\nDividend Income\n</code></pre>\n\n<p>I have the below code, I am trying to insert the the data in the cells to the RIGHT of I10 (I:10 to Z:10) into an array.</p>\n\n<pre><code>Sub Sample()\n    Dim ws As Worksheet\n    Dim MyAr As Variant\n    Dim SearchString As String\n    Dim aCell As Range\n    Dim i As Long\n\n    SearchString = \"Ledger Account\"\n\n    '~~&gt; Change this as applicable\n    Set ws = ThisWorkbook.Sheets(1)\n\n    With ws\n        Set aCell = .Columns(1).Find(What:=SearchString, LookIn:=xlValues, _\n                    LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n                    MatchCase:=False, SearchFormat:=False)\n\n        If Not aCell Is Nothing Then\n            '~~&gt; 5 Denotes the 5th column i.e Column \"E\"\n            '~~&gt; Amend as applicable\n            '~~&gt; Store the values From say Col B to E in the array\n            MyAr = Application.Transpose( _\n                                         .Range(.Cells(aCell.Row, 2), _\n                                                .Cells(aCell.Row, 5) _\n                                                ).Value _\n                                        )\n\n            '~~&gt; Check what is in the array\n            For i = LBound(MyAr) To UBound(MyAr)\n                Debug.Print MyAr(i, 1)\n            Next i\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "bloomberg"], "answers": [{"comments": [{"owner": {"reputation": 769, "user_id": 5097101, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/9E7Rq.jpg?s=128&g=1", "display_name": "gaurav kumar", "link": "https://stackoverflow.com/users/5097101/gaurav-kumar"}, "edited": false, "score": 0, "creation_date": 1443027574, "post_id": 32745170, "comment_id": 53331474, "body": "many thanks for the help. I am doing it for a workbook.  Dim wb As Workbook Dim wsh As Worksheet Dim formulaString As String For Each wsh In wb.Worksheets                 formulaString = wb.Worksheets.Range(&quot;A1&quot;).Formula         formulaString = Replace(formulaString, &quot;CBK&quot;, &quot;ALBK&quot;)         wb.Worksheets.Range(&quot;A1&quot;).Formula = formulaString            Next wsh ..This code is giving error. Please help in correcting the code."}, {"owner": {"reputation": 620, "user_id": 3276950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc1217b6e34924fc253f881d0c496b03?s=128&d=identicon&r=PG&f=1", "display_name": "tells", "link": "https://stackoverflow.com/users/3276950/tells"}, "reply_to_user": {"reputation": 769, "user_id": 5097101, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/9E7Rq.jpg?s=128&g=1", "display_name": "gaurav kumar", "link": "https://stackoverflow.com/users/5097101/gaurav-kumar"}, "edited": false, "score": 0, "creation_date": 1443027848, "post_id": 32745170, "comment_id": 53331634, "body": "Right. So you can iterate to your worksheets in the workbook.  Use <code>for i = 1 to wb.worksheets.count</code> to go through each worksheet and use <code>wb.sheets(i).range(&#39;your range here&#39;).Formula</code> - Don&#39;t forget to accept the answer if you&#39;ve found this to be your solution"}, {"owner": {"reputation": 769, "user_id": 5097101, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/9E7Rq.jpg?s=128&g=1", "display_name": "gaurav kumar", "link": "https://stackoverflow.com/users/5097101/gaurav-kumar"}, "edited": false, "score": 0, "creation_date": 1443028301, "post_id": 32745170, "comment_id": 53331868, "body": "Dear now the code is browsing all the files and giving NO Errors but my hard luck that still the code is unable to replace CBK with ALBK."}, {"owner": {"reputation": 769, "user_id": 5097101, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/9E7Rq.jpg?s=128&g=1", "display_name": "gaurav kumar", "link": "https://stackoverflow.com/users/5097101/gaurav-kumar"}, "edited": false, "score": 0, "creation_date": 1443029004, "post_id": 32745170, "comment_id": 53332212, "body": "Many thanks for the answer as it started working Now. That range was A2 instead of A1. :)"}, {"owner": {"reputation": 620, "user_id": 3276950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc1217b6e34924fc253f881d0c496b03?s=128&d=identicon&r=PG&f=1", "display_name": "tells", "link": "https://stackoverflow.com/users/3276950/tells"}, "reply_to_user": {"reputation": 769, "user_id": 5097101, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/9E7Rq.jpg?s=128&g=1", "display_name": "gaurav kumar", "link": "https://stackoverflow.com/users/5097101/gaurav-kumar"}, "edited": false, "score": 0, "creation_date": 1443029248, "post_id": 32745170, "comment_id": 53332328, "body": "ah right.. didn&#39;t give you the A2 reference in the example."}], "tags": [], "owner": {"reputation": 620, "user_id": 3276950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc1217b6e34924fc253f881d0c496b03?s=128&d=identicon&r=PG&f=1", "display_name": "tells", "link": "https://stackoverflow.com/users/3276950/tells"}, "is_accepted": true, "score": 3, "last_activity_date": 1443028169, "last_edit_date": 1443028169, "creation_date": 1443027030, "answer_id": 32745170, "question_id": 32744968, "link": "https://stackoverflow.com/questions/32744968/find-and-replace-string-in-all-excel-files-workbook-in-a-directory/32745170#32745170", "title": "Find and replace string in all Excel files workbook in a directory", "body": "<p>Use the formula property to get the string value of formula in a cell then reassign it after replacing the text.</p>\n\n<pre><code>Dim formulaString as String\nformulaString = ThisWorkbook.Sheets(1).Range(\"A1\").Formula\nformulaString = Replace(formulaString,\"CBK\",\"ALBK\")\nThisWorkbook.Sheets(1).Range(\"A1\").Formula = formulaString\n</code></pre>\n\n<p>To go through each worksheet in your workbook</p>\n\n<pre><code>Dim wb as workbook\nDim i as integer\nset wb = thisworkbook 'or whatever you choose to open here\n\nfor i = 1 to wb.worksheets.count\n    wb.sheets(i).range(\"A1\").Formula = Replace(wb.sheets(i).range(\"A1\").Formula,\"CBK\",\"ALBK\")\nnext i\n</code></pre>\n"}], "owner": {"reputation": 769, "user_id": 5097101, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/9E7Rq.jpg?s=128&g=1", "display_name": "gaurav kumar", "link": "https://stackoverflow.com/users/5097101/gaurav-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1670, "favorite_count": 2, "accepted_answer_id": 32745170, "answer_count": 1, "score": 4, "last_activity_date": 1443028169, "creation_date": 1443026276, "last_edit_date": 1495535224, "question_id": 32744968, "link": "https://stackoverflow.com/questions/32744968/find-and-replace-string-in-all-excel-files-workbook-in-a-directory", "title": "Find and replace string in all Excel files workbook in a directory", "body": "<p>I am writing a VBA code to replace a particular string in multiple Excel files (workbooks) located in a particular directory. I tried searching on Stack Overflow and I find answer but that is related to replacing a string in a text files through a macro in Excel. The link for the same is \n<a href=\"https://stackoverflow.com/questions/4437901/find-and-replace-string-in-a-file\">find and replace string in a file</a>.  </p>\n\n<p>My all workbooks has three worksheets each with Bloomberg formula in cell A2 :</p>\n\n<pre><code>=BDH(\"CBK IN Equity\",\"BID\",\"07-04-2015 09:00:00\",\"07-04-2015 16:00:00\")\n</code></pre>\n\n<p>The study requires a macro that will replace CBK in many such workbooks in a particular directory with ALBK. This is done in order to download the data for ALBK in place of CBK.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443026101, "post_id": 32744890, "comment_id": 53330680, "body": "Hmm add <code>cells(i,1).value=&quot;*********&quot;</code> assuming column A."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1443026733, "post_id": 32744890, "comment_id": 53330992, "body": "@Raystafarian sigh. Made me test it. What about you?"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1443026882, "post_id": 32744890, "comment_id": 53331063, "body": "Nope, I hadn&#39;t. Needs an <code>end if</code> though."}, {"owner": {"reputation": 71, "user_id": 2426069, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c285c3a673991fc24571e408b4c9f591?s=128&d=identicon&r=PG", "display_name": "Tasfer", "link": "https://stackoverflow.com/users/2426069/tasfer"}, "edited": false, "score": 0, "creation_date": 1443027102, "post_id": 32744890, "comment_id": 53331179, "body": "well I added the code you both suggested but it does not work correctly. It adds asterisks to all the fields at column A. I want only to add asterisks only to the blank lines which the previous macro adds"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443027143, "post_id": 32744890, "comment_id": 53331201, "body": "lol my fault. Thought it was obvious but you need to nest it within the if statement XD Edit: you need an <code>end if</code>."}], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443027233, "post_id": 32745221, "comment_id": 53331262, "body": "Uh OP said column A XD"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443027351, "post_id": 32745221, "comment_id": 53331337, "body": "Stealing my thunder =P"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443027405, "post_id": 32745221, "comment_id": 53331371, "body": "@findwindow if you&#39;d like to post an answer, go for it. I&#39;m pretty sure I can delete a community wiki. It just didn&#39;t seem like the OP was getting the <code>end if</code>"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443030781, "post_id": 32745221, "comment_id": 53333205, "body": "nah, just pulling your chain ^_^"}], "tags": [], "owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "is_accepted": true, "score": 1, "last_activity_date": 1443027255, "last_edit_date": 1443027255, "creation_date": 1443027200, "answer_id": 32745221, "question_id": 32744890, "link": "https://stackoverflow.com/questions/32744890/add-row-with-value-when-value-changes/32745221#32745221", "title": "Add row with value when value changes", "body": "<pre><code>Sub blankRows()\nDim LR As Long, i As Long\nLR = Range(\"E\" &amp; Rows.Count).End(xlUp).Row\nFor i = LR To 2 Step -1\n    If Range(\"E\" &amp; i).Value &lt;&gt; Range(\"E\" &amp; i - 1).Value Then\n    Rows(i).Insert\n    Cells(i, 1) = \"**********\"\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1443050808, "creation_date": 1443050808, "answer_id": 32751068, "question_id": 32744890, "link": "https://stackoverflow.com/questions/32744890/add-row-with-value-when-value-changes/32751068#32751068", "title": "Add row with value when value changes", "body": "<p>VBA is not necessary as Subtotal will achieve much the same, with a little help, and offers automatic grouping, which may or may not be appreciated.  </p>\n\n<p>Assuming <code>value1</code> is in A1, select the two columns, DATA > Outline - Subtotal, At each change in: <code>value1</code>, Use function: <code>Count</code>, Add subtotal to: <code>value1</code> only checked, check Replace current subtotals and Summary below data), OK. Filter the inserted column to select for Text Filters, Contains..., <code>c</code>, OK and in B1:  </p>\n\n<pre><code>**********  \n</code></pre>\n\n<p>Copy down to suit, delete ColumnA and, if desired, last occupied row. </p>\n"}], "owner": {"reputation": 71, "user_id": 2426069, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c285c3a673991fc24571e408b4c9f591?s=128&d=identicon&r=PG", "display_name": "Tasfer", "link": "https://stackoverflow.com/users/2426069/tasfer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1177, "favorite_count": 0, "accepted_answer_id": 32745221, "answer_count": 2, "score": 2, "last_activity_date": 1443050808, "creation_date": 1443025961, "last_edit_date": 1443027439, "question_id": 32744890, "link": "https://stackoverflow.com/questions/32744890/add-row-with-value-when-value-changes", "title": "Add row with value when value changes", "body": "<p>I have the below sheet</p>\n\n<pre><code>value1 | value2\n001    | car\n001    | car1\n002    | moto\n002    | moto2\n003    | ship\n</code></pre>\n\n<p>I want to insert a blank row when the \"value1\" changes like this</p>\n\n<pre><code>value1 | value2\n001    | car\n001    | car1\n       |\n002    | moto\n002    | moto2\n       |\n003    | ship\n</code></pre>\n\n<p>And for this I use this code which works fine:</p>\n\n<pre><code>Sub blankRows()\nDim LR As Long, i As Long\nLR = Range(\"E\" &amp; Rows.Count).End(xlUp).Row\nFor i = LR To 2 Step -1\n    If Range(\"E\" &amp; i).Value &lt;&gt; Range(\"E\" &amp; i - 1).Value Then Rows(i).Insert\nNext i\nEnd Sub\n</code></pre>\n\n<p>What I want is not only to add a blank row, but to the start of the blank row to insert also 10 asterisks. Like this</p>\n\n<pre><code>    value1 | value2\n    001    | car\n    001    | car1\n********** |\n    002    | moto\n    002    | moto2\n********** |\n    003    | ship\n********** |\n</code></pre>\n\n<p>Can you please alter my code above to also add 10 asterisks at the blank row it inserts?</p>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1443023853, "post_id": 32744128, "comment_id": 53329271, "body": "It is probably because the vlookup is not returning a value or in other words the result is &quot;N/A&quot;.  If this is the case, remove the <code>.worksheetFunction</code> and run it, you will need to then have an if statement to deal with the &#39;N/A&#39;."}, {"owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "edited": false, "score": 1, "creation_date": 1443024289, "post_id": 32744128, "comment_id": 53329554, "body": "Can&#39;t you use the vlookup in the sheet itself. So as a function that references the other file and range? Your search string is Column &amp; Row, which will result in one number as string. Is this intentional?"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1443030977, "post_id": 32744475, "comment_id": 53333327, "body": "++ <code>Select</code> and <code>Activate</code> are evil!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1443024522, "last_edit_date": 1495539866, "creation_date": 1443024522, "answer_id": 32744475, "question_id": 32744128, "link": "https://stackoverflow.com/questions/32744128/using-vlookup-in-vba-to-reference-another-excel-file/32744475#32744475", "title": "Using VLookup in VBA to reference another Excel file", "body": "<p>When you open a workbook, it becomes the active workbook. It seems you were never passing control back to the target workbook.</p>\n\n<pre><code>Sub SBEPlannerAdder()\n    Dim rw As Long, x As Range\n    Dim extwbk As Workbook, twb As Workbook\n\n    Set twb = ThisWorkbook\n    Set extwbk = Workbooks.Open(\"C:\\Users\\user\\Documents\\Support File\\Planner.xlsx\")\n    Set x = extwbk.Worksheets(\"Sheet1\").Range(\"A1:C1752\")\n\n    With twb.Sheets(\"Sheet1\")\n\n        For rw = 2 To .Cells(Rows.Count, 1).End(xlUp).Row\n            .Cells(rw, 2) = Application.VLookup(.Cells(rw, 1).Value2, x, 2, False)\n        Next rw\n\n    End With\n\n    extwbk.Close savechanges:=False\nEnd Sub\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more methods on getting away from relying on select and activate to accomplish your goals.</p>\n"}, {"tags": [], "owner": {"reputation": 620, "user_id": 3276950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc1217b6e34924fc253f881d0c496b03?s=128&d=identicon&r=PG&f=1", "display_name": "tells", "link": "https://stackoverflow.com/users/3276950/tells"}, "is_accepted": false, "score": 0, "last_activity_date": 1443025502, "creation_date": 1443025502, "answer_id": 32744758, "question_id": 32744128, "link": "https://stackoverflow.com/questions/32744128/using-vlookup-in-vba-to-reference-another-excel-file/32744758#32744758", "title": "Using VLookup in VBA to reference another Excel file", "body": "<p>It depends on whether you plan to do this as a one off or repeatedly.  I'm assuming repeatedly since doing this manually is not all that difficult. </p>\n\n<p>The first thing I would look at is your arguments. The first two should be ranges.  So to be clear, perhaps you could do something like </p>\n\n<pre><code>Dim x As Range\nset x = wbk.Worksheets(\"Sheet1\").Range(\"A1:C1752\")\n...\n\nRange(ActiveCell.Offset(0, 1) &amp; ActiveCell.Row).Value = Application.WorksheetFunction.VLookup(Range(Activecell.Address), x, 2, 0)\n</code></pre>\n\n<p>The important bits are making sure your first two arguments are Ranges for the Vlookup function.</p>\n"}], "owner": {"reputation": 45, "user_id": 5100100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7fdeecafdb271b068d7bd5a28843ffbc?s=128&d=identicon&r=PG&f=1", "display_name": "zaanwar", "link": "https://stackoverflow.com/users/5100100/zaanwar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31581, "favorite_count": 4, "accepted_answer_id": 32744475, "answer_count": 2, "score": 1, "last_activity_date": 1501622087, "creation_date": 1443023489, "question_id": 32744128, "link": "https://stackoverflow.com/questions/32744128/using-vlookup-in-vba-to-reference-another-excel-file", "title": "Using VLookup in VBA to reference another Excel file", "body": "<p>I'm trying to program a VLookup Table in VBA that references another file. Here is a simple outline of my goal:</p>\n\n<ul>\n<li>Look up value in cell A2 in another Excel file</li>\n<li>Pull the information in from column 2 of the other Excel file and place in Cell B2</li>\n<li>Move on to cell A3 and repeat the process until there are no more entries left in column A</li>\n</ul>\n\n<p>Here is the code that I already have. I keep getting an error that says \"Unable to get the VLookup property of the WOrksheetFunction class.\" I checked the other posts referencing that error but they were not of any help. Do you all see an error in my code? Or does anyone have a better way of accomplishing this task?</p>\n\n<pre><code>Sub SBEPlannerAdder()\n\nDim wbk As Workbook\nSet wbk = Workbooks.Open(\"C:\\Users\\user\\Documents\\Support File\\Planner.xlsx\")\n\nWith Sheets(\"Sheet1\")\n\n    ' Selects the first cell to check\n    Range(\"A2\").Select\n    Dim x As Variant\n    x = wbk.Worksheets(\"Sheet1\").Range(\"A1:C1752\")\n\n    ' Loops through all rows until an empty row is found\n    Do Until IsEmpty(ActiveCell)\n\n        Range(ActiveCell.Offset(0, 1) &amp; ActiveCell.Row).Value = Application.WorksheetFunction.VLookup((ActiveCell.Column &amp; ActiveCell.Row), x, 2, 0)\n        ActiveCell.Offset(1, 0).Select\n    Loop\nEnd With\n\nCall wbk.Close(False)\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-project"], "answers": [{"tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1443026118, "creation_date": 1443026118, "answer_id": 32744928, "question_id": 32743096, "link": "https://stackoverflow.com/questions/32743096/keeping-an-ms-project-and-an-ms-excel-file-synchronized-via-the-ms-project-impor/32744928#32744928", "title": "Keeping an MS Project and an MS Excel File synchronized via the MS Project import function", "body": "<p>The import/merge functionality is very powerful and generally works very well. <strong>The number one rule is to use an immutable field for the merge key (fusion key).</strong> The Task Unique ID field is almost always used. Since the Task ID field changes as tasks are inserted or deleted, it is a poor choice  for the merge key. </p>\n\n<p>Change your merge to use the Unique ID field and do a simple test where you only update a single field such as a text field (e.g. Text 1). Once you have that working, expand the import file to include more fields. If the merge fails, you'll get an error message indicating the row and column of the data that failed to merge. </p>\n"}], "owner": {"reputation": 291, "user_id": 2707300, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5d45e0a12e698fbdfc68388e72ff7b36?s=128&d=identicon&r=PG&f=1", "display_name": "VikingR", "link": "https://stackoverflow.com/users/2707300/vikingr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2302, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1443026118, "creation_date": 1443020602, "last_edit_date": 1443020773, "question_id": 32743096, "link": "https://stackoverflow.com/questions/32743096/keeping-an-ms-project-and-an-ms-excel-file-synchronized-via-the-ms-project-impor", "title": "Keeping an MS Project and an MS Excel File synchronized via the MS Project import function", "body": "<p>I have an Excel file containing tasks that is exported from an Access database (master). This Excel file then serves as an import file for MS Project. Subsequently, MS Project is then used for the actual tracking and reporting and enhances the task list with typical MS Project information (due dates, progress). The workflow goes like this: </p>\n\n<p>1) Execute an initial import into MS Project.<br>\n2) Start working with the data in MS Project (and thereby enhancing it)<br>\n<strong>3) Synchronizing the Project file with a recent Excel import file at regular     intervals (since tasks may be modified or set to <em>inactive/active</em>)</strong></p>\n\n<p>Step 3 is where the problem comes in. I tried using the Project standard functionality by importing an updated Excel (Merge the data into the active project*), matching the respective columns and defining a <em>fusion-key</em> (Task ID) to make sure the changes are imported properly into MS Project.</p>\n\n<p>However, Project never imports the changes correctly. I've tried different variants of changes (modifying a simple active/inactive value in a column, adding different tasks inbetween, leaving blank lines in Project and then filling them with new tasks via a second import). </p>\n\n<p>I'm also making sure that the matched columns have the same data format. </p>\n\n<p>Does anyone have an idea on what I could be doing wrong?<br>\nMaybe I need to go a different route altogether?</p>\n"}, {"tags": ["excel", "if-statement", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443020801, "post_id": 32743063, "comment_id": 53327151, "body": "I think you meant <code>Range(&quot;B&quot; &amp; r &amp; &quot;:G&quot; &amp; r).rows.Select</code>"}, {"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443021456, "post_id": 32743063, "comment_id": 53327623, "body": "@findwindow I made that adjustment and I got the same error, however removing .rows and running macro it ran with no error but didn&#39;t copy the data from B:G and is stil lonly pasting into that one cell. Do i need to use a loop to start at AT6 and add a row for each value?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443021890, "post_id": 32743063, "comment_id": 53327943, "body": "Your loop should work. It&#39;s <code>Range(&quot;AS6&quot;).Select</code> that&#39;s the problem. You need to make that variable. Something like <code>cells(lrow,45).select</code> (45 is column AS?). Edit: why are you looping backwards?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443022432, "post_id": 32743063, "comment_id": 53328331, "body": "This is likely beyond your concern but try to avoid using select and copy/paste."}, {"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1443022839, "post_id": 32743063, "comment_id": 53328557, "body": "I try to avoid select and copy paste but I am still dusting all the cobwebs off my macro knowledge / learning as much new stuff as I can. I have never really done a loop before so I guess i didn&#39;t know i was doing it backwards"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443023399, "post_id": 32743063, "comment_id": 53328922, "body": "Your loop is <code>step -1</code> meaning backwards but should still work. You can&#39;t lock in one single range for paste. <code>Range(&quot;AT100000&quot;)</code> even with offset will also lock in the cell below that range. You need it to be dynamic. Like <code>cells(row,column)</code> ."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443023655, "post_id": 32743063, "comment_id": 53329125, "body": "Might also want to change <code>Range(&quot;B&quot; &amp; r)</code> to <code>Range(&quot;B&quot; &amp; lrow)</code>"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443023805, "post_id": 32743063, "comment_id": 53329230, "body": "Do you need formatting?"}, {"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443027728, "post_id": 32743063, "comment_id": 53331568, "body": "@findwindow I do not need formatting, I have a more code that will apply formatting after I generate this list. The list is step one of about five steps."}], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1443022640, "post_id": 32743213, "comment_id": 53328447, "body": "That also works, and I had called out the wrong cell originally but  now I cannot get the code to paste the data I need into the desired  cells. I have updated the code to the latest verison"}, {"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "reply_to_user": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1443024534, "post_id": 32743213, "comment_id": 53329729, "body": "If I understand correctly you want to copy the rows A to T and paste it somewhere?"}, {"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1443027615, "post_id": 32743213, "comment_id": 53331498, "body": "I need an if stament to check col B for a specific text, when it finds that text it needs to copy the data in b to g of that row, into col AT. Starting at AT6 and working its way down the column with each time it finds a match in the B column"}, {"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "reply_to_user": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1443028273, "post_id": 32743213, "comment_id": 53331852, "body": "I modified my answer to fit your requirements."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443031596, "post_id": 32743213, "comment_id": 53333700, "body": "@phil652 you have it backwards XD"}, {"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1443131961, "post_id": 32743213, "comment_id": 53382275, "body": "@PHIL652  @ findwondow I tried this and it kinda works. I get the value from col B in to col AU but I don&#39;t get the other values ( col c-g) and it doesn&#39;t start in AT6 and paste each new value below the last value it found. I may try to alter the macro or try an index match match formula"}, {"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "edited": false, "score": 0, "creation_date": 1443184053, "post_id": 32743213, "comment_id": 53402775, "body": "You should update your code so we cant see whats going on"}], "tags": [], "owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "is_accepted": false, "score": 1, "last_activity_date": 1443028209, "last_edit_date": 1443028209, "creation_date": 1443020904, "answer_id": 32743213, "question_id": 32743063, "link": "https://stackoverflow.com/questions/32743063/scan-col-for-matching-text-and-paste-results-in-another-column/32743213#32743213", "title": "scan col for matching text and paste results in another column", "body": "<p>You should try this.</p>\n\n<pre><code>If Left(Cells(lrow, \"B\"), dlen) = ActiveSheet.Range(\"AL2\").Text Then\n   Range(Cells(lrow, \"B\"), Cells(lrow, \"G\")).Value = Range(Cells(lrow, \"AT\"), Cells(lrow, \"AY\")).Value\nEnd if\n</code></pre>\n\n<p>If this doesn't work you, before the if you could try to check the value of lrow and dlen to make to sure they have a correct value.</p>\n\n<p>Let me know if that works for you</p>\n"}, {"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443024424, "post_id": 32744390, "comment_id": 53329655, "body": "Uh adjust columns/cells as necessary. I altered them for my own testing."}, {"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1443027472, "post_id": 32744390, "comment_id": 53331412, "body": "sorry had to step out for a meeting. I will modify code above and see if it works"}], "tags": [], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "is_accepted": false, "score": 0, "last_activity_date": 1443024870, "last_edit_date": 1443024870, "creation_date": 1443024230, "answer_id": 32744390, "question_id": 32743063, "link": "https://stackoverflow.com/questions/32743063/scan-col-for-matching-text-and-paste-results-in-another-column/32744390#32744390", "title": "scan col for matching text and paste results in another column", "body": "<p>Assuming you don't need formatting, I think you want something like this...</p>\n\n<pre><code>Dim ws As Worksheet\nSet ws = ThisWorkbook.WorkSheets(\"HR-Cal\")\ndlen = 2 'change this\nlrow = ws.Cells(Cells.Rows.Count, \"B\").End(xlUp).Row\n\nFor i = 7 To lrow\n\n'checks curent row for box name in cell AL2\n'copies values from col B to col G in that row to into Col AT, starting at AS6\nIf Left(Cells(i, \"B\"), dlen) = ws.Range(\"M2\").Text Then 'change M2\n'Range(\"B\" &amp; i).Rows.Select\n'If Left(Cells(lrow, \"B\"), dlen) = Range(\"AL2\").Value Then Range(\"B\" &amp; r &amp; \":G\" &amp; r).Select\n'Selection.Copy\nRange(Cells(i, 10), Cells(i, 15)).Value = Range(Cells(i, 2), Cells(i, 7)).Value 'change columns\n'Range(\"AT100000\").End(xlUp).Offset(1, 0).PasteSpecial (xlPasteAll)\nEnd If\n\nNext i\n</code></pre>\n"}], "owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 589, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1443028209, "creation_date": 1443020504, "last_edit_date": 1531164843, "question_id": 32743063, "link": "https://stackoverflow.com/questions/32743063/scan-col-for-matching-text-and-paste-results-in-another-column", "title": "scan col for matching text and paste results in another column", "body": "<p>I need to scan Col B for any values that have the same left characters that are found in cell AL2, the length of the string is found in AR1. If the left value in Col B matches the value  in AL2 I need to copy the values in that row from Col B to col G. copied into Col At, starting a AT6 and continuing down until there until all values in Col C have been checked. First picture is data that will be scanned, second picture is what I want the macro to spit out</p>\n\n<p>Here is the modified macro that I recorded. I am getting an runtime 13 error on the IF statement. Any ideas on how to clean this up ?</p>\n\n<p><a href=\"https://i.stack.imgur.com/bLo9s.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bLo9s.png\" alt=\"data to be scanned\"></a>\n<a href=\"https://i.stack.imgur.com/EKoGZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EKoGZ.png\" alt=\"data copied from scanned data\"></a></p>\n\n<pre><code>        Sub GenerateSummaryPage()\n'\n\n' scans B column for combiner box numbers\nApplication.ScreenUpdating = False\n    Dim dlen As String\n\n\n    Worksheets(\"HR-Cal\").Activate\n    dlen = Worksheets(\"HR-Cal\").Range(\"AR2\")\n    r = ActiveCell.Row\n    For lrow = Cells(Cells.Rows.Count, \"B\").End(xlUp).Row To 7 Step -1\n\n    'checks curent row for box name in cell AL2\n    'copies values from col B to col G in that row to into Col AT, starting at AS6\n    If Left(Cells(lrow, \"B\"), dlen) = ActiveSheet.Range(\"AL2\").Text Then Range(\"B\" &amp; r).Rows.Select\n    'If Left(Cells(lrow, \"B\"), dlen) = Range(\"AL2\").Value Then Range(\"B\" &amp; r &amp; \":G\" &amp; r).Select\n        Selection.Copy\n    Range(\"AT100000\").End(xlUp).Offset(1, 0).PasteSpecial (xlPasteAll)\n\n    Next lrow\n\nApplication.ScreenUpdating = True\n'insert rows for inverter headers\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "smtp"], "comments": [{"owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "edited": false, "score": 0, "creation_date": 1443022980, "post_id": 32742708, "comment_id": 53328641, "body": "Is any other mail client present?"}, {"owner": {"reputation": 11, "user_id": 5259951, "user_type": "registered", "profile_image": "https://graph.facebook.com/1037501049607906/picture?type=large", "display_name": "Geoff Bird", "link": "https://stackoverflow.com/users/5259951/geoff-bird"}, "reply_to_user": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "edited": false, "score": 0, "creation_date": 1443164489, "post_id": 32742708, "comment_id": 53391664, "body": "No Mail client available on that server"}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1443024002, "creation_date": 1443024002, "answer_id": 32744301, "question_id": 32742708, "link": "https://stackoverflow.com/questions/32742708/access-sending-emails-via-smtp/32744301#32744301", "title": "Access sending emails via SMTP", "body": "<p>I can recommend these tools:</p>\n\n<p><strong>Blat</strong>: <a href=\"http://www.blat.net/\" rel=\"nofollow\">http://www.blat.net/</a>  (free)<br>\nBlat is a Windows (32 &amp; 64 bit) command line utility that sends eMail using SMTP.</p>\n\n<p><strong>Chilkat</strong> ActiveX libraries: <a href=\"http://www.chilkatsoft.com/email-features.asp\" rel=\"nofollow\">http://www.chilkatsoft.com/email-features.asp</a>  (not free, but a lot more options)<br>\n<a href=\"https://www.chilkatsoft.com/refdoc/xChilkatMailManRef.html\" rel=\"nofollow\">MailMan</a>: The Chilkat MailMan class is reponsible for sending email though SMTP and receiving/managing email on POP3 servers.<br>\n<a href=\"https://www.chilkatsoft.com/refdoc/xChilkatEmailRef.html\" rel=\"nofollow\">Email</a>: Represents a complete Email object.</p>\n\n<p>In both cases you'd first save the query as xls (DoCmd.TransferSpreadsheet) and then mail that file.</p>\n"}], "owner": {"reputation": 11, "user_id": 5259951, "user_type": "registered", "profile_image": "https://graph.facebook.com/1037501049607906/picture?type=large", "display_name": "Geoff Bird", "link": "https://stackoverflow.com/users/5259951/geoff-bird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 665, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1443024002, "creation_date": 1443019507, "question_id": 32742708, "link": "https://stackoverflow.com/questions/32742708/access-sending-emails-via-smtp", "title": "Access sending emails via SMTP", "body": "<p>I have the following basic Send Object Macro. </p>\n\n<pre><code>Function McrSnapshotCallData()\nOn Error GoTo McrSnapshotCallData_Err\n\nDoCmd.SendObject acQuery, \"Qry_SnapShot\", \"Excel97-Excel2003Workbook(*.xls)\", \"xxx@xxx.com\", \"\", \"\", \"Calls\", \"Please find attached\", False, \"\"\n\n\nMcrSnapshotCallData_Exit:\nExit Function\n\nMcrSnapshotCallData_Err:\nMsgBox Error$\nResume McrSnapshotCallData_Exit\n\nEnd Function\n</code></pre>\n\n<p>I need to be able to send run this macro on a server using a scheduler enabling an email to be sent out. </p>\n\n<p>Currently this requires and outlook account on the server and it does not have one. Is it possible to include SMTP server details so this can be run automatically without me having to log on every night and send this. </p>\n\n<p>Please can you me help adjust this if possible. </p>\n\n<p>Sorry I am not very good with VBA stuff. Thanks</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "edited": false, "score": 0, "creation_date": 1443019605, "post_id": 32742583, "comment_id": 53326257, "body": "Backup the folder where all your save files are?"}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "reply_to_user": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "edited": false, "score": 0, "creation_date": 1443019874, "post_id": 32742583, "comment_id": 53326464, "body": "The question is where are the sames files? See the updates question @phil"}, {"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "edited": false, "score": 0, "creation_date": 1443019933, "post_id": 32742583, "comment_id": 53326508, "body": "Normally in My Documents"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1443022144, "post_id": 32742583, "comment_id": 53328139, "body": "Use Git source control? It&#39;s still a bit experimental, but it works: try <a href=\"http://www.rubberduck-vba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> (note: I co-own this open-source project)"}], "answers": [{"comments": [{"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1443165157, "post_id": 32744239, "comment_id": 53391985, "body": "From the <code>ThisWorkBook</code> is assume your coding is for Excel? Im using Word. and it doestn seem to accept the Code"}], "tags": [], "owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "is_accepted": false, "score": 1, "last_activity_date": 1443023785, "creation_date": 1443023785, "answer_id": 32744239, "question_id": 32742583, "link": "https://stackoverflow.com/questions/32742583/backing-up-vba-project/32744239#32744239", "title": "Backing up VBA Project", "body": "<p>You can try this:</p>\n\n<pre><code>Public Sub Test()\n\n    ExportVBA ThisWorkbook.Path &amp; \"\\Export\\\"\n\nEnd Sub\n\nPublic Sub ExportVBA(sDestinationFolder As String)\n\n    Dim oVBComponent As VBComponent\n\n    For Each oVBComponent In ThisWorkbook.VBProject.VBComponents\n        oVBComponent.Export sDestinationFolder &amp; oVBComponent.Name\n    Next oVBComponent\n\nEnd Sub\n</code></pre>\n\n<p>Just specify the destination folder and you're good to go</p>\n"}, {"comments": [{"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1443165256, "post_id": 32744572, "comment_id": 53392044, "body": "so the Rubberduck add-in will allow be to export my project?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1443178982, "post_id": 32744572, "comment_id": 53399765, "body": "By creating a repository, yes."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1443181186, "post_id": 32744572, "comment_id": 53401012, "body": "@Jean-PierreOosthuizen the only thing is that you need to rename your project if it&#39;s named <code>VBAProject1</code> - once a path is hooked up the add-in exports everything in the project to that folder. I suggest you download a Git client to help with the initial set-up - e.g. <i>GitHub for Windows</i>. Then the physical files will be updated everytime you commit changes."}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1443181599, "post_id": 32744572, "comment_id": 53401255, "body": "Thanks. Will have a look at it."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 4, "last_activity_date": 1443024807, "last_edit_date": 1592644375, "creation_date": 1443024807, "answer_id": 32744572, "question_id": 32742583, "link": "https://stackoverflow.com/questions/32742583/backing-up-vba-project/32744572#32744572", "title": "Backing up VBA Project", "body": "<h3>Source Control.</h3>\n<p>That's how devs work worldwide, in pretty much every language out there. The Office-embedded nature of VBA complicates this a little, but it's a solved problem, with several solutions.</p>\n<p>One of them is currently under active development, and adds a dockable side panel to your IDE, much like Visual Studio's <em>Team Explorer</em>:</p>\n<p><a href=\"https://i.stack.imgur.com/elTJW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/elTJW.png\" alt=\"RD Source Control panel\" /></a></p>\n<p><a href=\"http://www.rubberduck-vba.com\" rel=\"nofollow noreferrer\"><strong>Rubberduck</strong></a> is a COM add-in for the VBE, that includes this functionality - namely, Git/GitHub source control integration for your VBA projects.</p>\n<p>It's a little bit of a &quot;beta&quot; feature in the latest version (1.4.3 as of this writing), but out of all other options, an IDE-integrated source control solution is certainly the best possible way to go about not only <em>backing up</em> your code, but also to get all the advantages of proper source control.</p>\n<blockquote>\n<p><strong>Disclaimer</strong>: I haven't written the source control integration feature, but I co-own the Rubberduck project, which is free and open-source (i.e. I have no vested interest in advertising it).</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "is_accepted": true, "score": 1, "last_activity_date": 1443168164, "creation_date": 1443168164, "answer_id": 32777517, "question_id": 32742583, "link": "https://stackoverflow.com/questions/32742583/backing-up-vba-project/32777517#32777517", "title": "Backing up VBA Project", "body": "<p>The easiest solution was to export all my current Modules and Userforms and then import them into a a New Word Document, which I then saved as a Macro Enabled Template.</p>\n\n<p>Now I just need to work out of the Template Project and not my Original Project.</p>\n\n<p>Having the Template Project will also allow me to easily distribute my program to colleagues. </p>\n"}], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 634, "favorite_count": 1, "accepted_answer_id": 32777517, "answer_count": 3, "score": 3, "last_activity_date": 1443168164, "creation_date": 1443019132, "last_edit_date": 1531164843, "question_id": 32742583, "link": "https://stackoverflow.com/questions/32742583/backing-up-vba-project", "title": "Backing up VBA Project", "body": "<p>I want to backup my VBA project, but cant seem to find an easy solution.</p>\n\n<p>I can export Each Userform and Module separately and then save that remotely. But was wondering if there wasnt another way?</p>\n\n<p>I saw on another <a href=\"http://www.slipstick.com/developer/how-to-backup-and-save-your-outlook-vba-macros/\" rel=\"nofollow\">website</a> about copying the Outlook VBA .OTM file. is this the same file extension as Word VBA?</p>\n"}, {"tags": ["vba", "char", "declare"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1443017120, "post_id": 32741646, "comment_id": 53324340, "body": "VBA/VB6 does not have a Char type (VB.Net <i>does</i>). There is Byte (0..255) or String, which is appropriate depends on what you want to do .,."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1443017151, "post_id": 32741646, "comment_id": 53324366, "body": "Char is a C declaration.  In VBA you want a type of String."}, {"owner": {"reputation": 77, "user_id": 5367981, "user_type": "registered", "profile_image": "https://graph.facebook.com/1052774908066879/picture?type=large", "display_name": "Viktor Bendik", "link": "https://stackoverflow.com/users/5367981/viktor-bendik"}, "edited": false, "score": 0, "creation_date": 1443020303, "post_id": 32741646, "comment_id": 53326774, "body": "I want to get some letters from a string so i followed this site <a href=\"https://msdn.microsoft.com/en-us/library/ms233783.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ms233783.aspx</a> but the char or chars just dont work for me .  And many thanks for the ultra-fast response :)"}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 1, "creation_date": 1443020521, "post_id": 32741646, "comment_id": 53326935, "body": "The link is about vb.net therefor it&#39;s not working. VBA does not have char see here <a href=\"https://msdn.microsoft.com/en-us/library/aa263420%28v=vs.60%29.aspx\" rel=\"nofollow noreferrer\">the data types in VBA</a>."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1443022353, "post_id": 32741646, "comment_id": 53328277, "body": "Character #3 in VBA is <code>x = mid$(thestring, 3, 1)</code> (<a href=\"https://msdn.microsoft.com/en-us/library/office/gg251677.aspx\" rel=\"nofollow noreferrer\">ref</a>)"}], "answers": [{"tags": [], "owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "is_accepted": false, "score": 3, "last_activity_date": 1443024712, "creation_date": 1443024712, "answer_id": 32744549, "question_id": 32741646, "link": "https://stackoverflow.com/questions/32741646/cannot-declare-char-type-variable/32744549#32744549", "title": "Cannot declare Char type variable", "body": "<p>You can use</p>\n\n<pre><code>Dim myString As String * 1\n</code></pre>\n\n<p>This works for any length.</p>\n"}], "owner": {"reputation": 77, "user_id": 5367981, "user_type": "registered", "profile_image": "https://graph.facebook.com/1052774908066879/picture?type=large", "display_name": "Viktor Bendik", "link": "https://stackoverflow.com/users/5367981/viktor-bendik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4554, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1581828102, "creation_date": 1443016640, "last_edit_date": 1581828102, "question_id": 32741646, "link": "https://stackoverflow.com/questions/32741646/cannot-declare-char-type-variable", "title": "Cannot declare Char type variable", "body": "<p>Visual Basic does not recognize the Char type. The closest match in hints to char is characters.</p>\n\n<p>I searched some forums and guides but found nothing</p>\n\n<p>Is there any way to fix this?</p>\n"}, {"tags": ["vba", "outlook", "mailitem"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1443016510, "post_id": 32741149, "comment_id": 53323864, "body": "Which line raises the error?"}, {"owner": {"reputation": 63, "user_id": 5227878, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/6aed51a7509065cd288bd61e95f0b724?s=128&d=identicon&r=PG&f=1", "display_name": "Colin Torpey", "link": "https://stackoverflow.com/users/5227878/colin-torpey"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1443026274, "post_id": 32741149, "comment_id": 53330786, "body": "The below answer from Macro Man works perfectly. FYI the code stopped at the &quot;Next olMail&quot; line."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1443027477, "post_id": 32741149, "comment_id": 53331415, "body": "Glad it&#39;s working. Next time, include more relevant information in your Q -- it is usually expected that the asker will identify which line raises the error :)  This saves everyone else the trouble of having to guess at what the problem(s) might be. Cheers."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 5227878, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/6aed51a7509065cd288bd61e95f0b724?s=128&d=identicon&r=PG&f=1", "display_name": "Colin Torpey", "link": "https://stackoverflow.com/users/5227878/colin-torpey"}, "edited": false, "score": 0, "creation_date": 1443026186, "post_id": 32741604, "comment_id": 53330732, "body": "Thanks for your help. Works perfectly."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 2, "last_activity_date": 1443016524, "creation_date": 1443016524, "answer_id": 32741604, "question_id": 32741149, "link": "https://stackoverflow.com/questions/32741149/shared-inbox-skipping-non-mail-items-in-outlook-vba/32741604#32741604", "title": "Shared Inbox - Skipping non-mail items in Outlook VBA", "body": "<p>Change  </p>\n\n<pre><code>Dim olMail As Outlook.MailItem\n</code></pre>\n\n<p>To  </p>\n\n<pre><code>Dim olMail As Variant\n</code></pre>\n\n<hr>\n\n<p>A <code>Variant</code> type should be used to iterate collections in a <code>For Each</code> loop, in your example the <code>Next</code> item is not a <code>MailItem</code> - which is what olMail has been declared as. You already have a check in place to see if <code>olMail</code> is a mail item, so you can use a variant here instead.</p>\n"}], "owner": {"reputation": 63, "user_id": 5227878, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/6aed51a7509065cd288bd61e95f0b724?s=128&d=identicon&r=PG&f=1", "display_name": "Colin Torpey", "link": "https://stackoverflow.com/users/5227878/colin-torpey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1684, "favorite_count": 1, "accepted_answer_id": 32741604, "answer_count": 1, "score": 3, "last_activity_date": 1592984051, "creation_date": 1443015357, "last_edit_date": 1592984051, "question_id": 32741149, "link": "https://stackoverflow.com/questions/32741149/shared-inbox-skipping-non-mail-items-in-outlook-vba", "title": "Shared Inbox - Skipping non-mail items in Outlook VBA", "body": "<p>I am not an expert in Outlook VBA but I have managed to create a few macros that work quite well. I have worked on the below code for some time and am now left with a minor problem. The macro imports information on every email from a sub-folder of a shared inbox into an excel file. The problem I have is when the for next loop encounters a non-mail item (e.g. a meeting invite or delivery failure notification). The code stops on the \"Next\" line and gives a \"type mismatch\" error when it encounters these non-mail items. Pressing play again continues the code until it meets another non-mail item. I want to make the code skip these non-mail items and loop through the full inbox/folder.</p>\n\n<p>I have tried \"On Error Resume Next\" but it seems to skip the \"Next\" line and continues on with the remaining code without actually looping back to the \"For Each\" line. I have played around with If's and GoTo statements but none would work for me. Can anybody help please?</p>\n\n<p>I also have another issue with the macro in general. Sometimes it will not run as it seems to not recognise the \"ARCHIVE\" sub-folder of the inbox but other times it is fine. My guess is that when the shared inbox is syncing with the server, or something like, the \"ARCHIVE\" folder cannot be accessed that but that's only a guess. If anyone could shed more light on this issue also I would greatly appreciate it.</p>\n\n<pre><code>Sub EmailStatsV3()\n\nDim olMail As Outlook.MailItem\nDim aOutput() As Variant\nDim lCnt As Long\nDim xlApp As Excel.Application\nDim xlSh As Excel.Worksheet\nDim flInbox As Folder\n\n'Gets the mailbox and shared folder inbox\nDim myNamespace As Outlook.NameSpace\nDim myRecipient As Outlook.Recipient\nSet myNamespace = Application.GetNamespace(\"MAPI\")\nSet myRecipient = myNamespace.CreateRecipient(\"Shared Inbox\") 'Change \"Shared Inbox\" to whatever shared inbox you use\n\nSet objOutlook = CreateObject(\"Outlook.Application\")\nSet objNamespace = objOutlook.GetNamespace(\"MAPI\")\nSet objInbox = objNamespace.GetSharedDefaultFolder(myRecipient, olFolderInbox)\n\n'Uses the Parent of the Inbox to specify the mailbox\nstrFolderName = objInbox.Parent\n\n'Specifies the folder (inbox or other) to pull the info from\nSet objMailbox = objNamespace.Folders(strFolderName)\nSet objFolder = objMailbox.Folders(\"Inbox\").Folders(\"ARCHIVE\") 'Change this line to specify folder\nSet colItems = objFolder.Items\n\n'Specify which email items to extract\nReDim aOutput(1 To objFolder.Items.Count, 1 To 5)\nFor Each olMail In objFolder.Items\nIf TypeName(olMail) = \"MailItem\" Then\n\n        lCnt = lCnt + 1\n        aOutput(lCnt, 1) = olMail.SenderEmailAddress 'Sender or SenderName also gives similar output\n        aOutput(lCnt, 2) = olMail.ReceivedTime 'stats on when received\n        aOutput(lCnt, 3) = olMail.ConversationTopic 'group based on subject w/o regard to prefix\n        aOutput(lCnt, 4) = olMail.Subject 'to split out prefix\n        aOutput(lCnt, 5) = olMail.Categories 'to split out category\nEnd If\n\nNext olMail\n\n'Creates a blank workbook in excel then inputs the info from Outlook\nSet xlApp = New Excel.Application\nSet xlSh = xlApp.Workbooks.Add.Sheets(1)\n\nxlSh.Range(\"A1\").Resize(UBound(aOutput, 1), UBound(aOutput, 2)).Value = aOutput\nxlApp.Visible = True\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "edited": false, "score": 2, "creation_date": 1443016134, "post_id": 32741136, "comment_id": 53323549, "body": "have a look at <a href=\"http://stackoverflow.com/questions/18509806/vba-split-cell-value-by-font-colour\" title=\"vba split cell value by font colour\">stackoverflow.com/questions/18509806/&hellip;</a>"}, {"owner": {"reputation": 482, "user_id": 1925992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78b72aef1238e23c76d98f7cc5192f52?s=128&d=identicon&r=PG", "display_name": "ojs", "link": "https://stackoverflow.com/users/1925992/ojs"}, "edited": false, "score": 0, "creation_date": 1443016456, "post_id": 32741136, "comment_id": 53323813, "body": "Thanks katz, I will try the solution there. Surprised I didn&#39;t find that question myself, my google foo is usually better then this. Thanks also pnuts for the kind words, my question asking foo is not always this good though as can be seen from other questions on other stackexchange sites. But one tries to improve."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1443016721, "post_id": 32741136, "comment_id": 53324028, "body": "you might be interested in this as well: <a href=\"http://stackoverflow.com/questions/32713544/advanced-text-editing-for-vba-excel-textbox?noredirect=1#comment53272537_32713544\" title=\"advanced text editing for vba excel textbox\">stackoverflow.com/questions/32713544/&hellip;</a>"}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1443022052, "post_id": 32741136, "comment_id": 53328067, "body": "David Zemens has an interesting post on XML in <a href=\"http://stackoverflow.com/questions/19117667/how-to-read-xml-attributes-using-vba-to-excel/19118292#comment53326811_19118292\" title=\"how to read xml attributes using vba to excel\">stackoverflow.com/questions/19117667/&hellip;</a>  Look a promising approach (that will need further setup) but liley more workable than a huge iterative process character by character, cell by cell"}], "answers": [{"tags": [], "owner": {"reputation": 520, "user_id": 5289214, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-II2pZVRGeoI/AAAAAAAAAAI/AAAAAAAAJxs/B19uiSlUBc0/photo.jpg?sz=128", "display_name": "Justin McCartney", "link": "https://stackoverflow.com/users/5289214/justin-mccartney"}, "is_accepted": false, "score": 2, "last_activity_date": 1443017849, "creation_date": 1443017849, "answer_id": 32742080, "question_id": 32741136, "link": "https://stackoverflow.com/questions/32741136/extracting-font-color-from-cells-with-multiple-colors-in-the-cell/32742080#32742080", "title": "Extracting font color from cells with multiple colors in the cell", "body": "<p>You can use the following and then create a dictionary/collection/array to store the colors and only keep unique values or whatever solution fits your situation. This just shows how you can access all the colors. </p>\n\n<pre><code>Sub AllColors()\n\nDim r As Range\nDim x As Integer\n\nSet r = Selection\n\nFor x = 1 To Len(r.Value)\n    Debug.Print r.Characters(x, 1).Font.ColorIndex\nNext x\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 482, "user_id": 1925992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78b72aef1238e23c76d98f7cc5192f52?s=128&d=identicon&r=PG", "display_name": "ojs", "link": "https://stackoverflow.com/users/1925992/ojs"}, "edited": false, "score": 0, "creation_date": 1448229211, "post_id": 32743475, "comment_id": 55485816, "body": "Thank you, yes, that got me on the right track. I submit my own answer with my adapted solution."}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 1, "last_activity_date": 1443021580, "creation_date": 1443021580, "answer_id": 32743475, "question_id": 32741136, "link": "https://stackoverflow.com/questions/32741136/extracting-font-color-from-cells-with-multiple-colors-in-the-cell/32743475#32743475", "title": "Extracting font color from cells with multiple colors in the cell", "body": "<p>I'd use <code>.Font.Color</code> to cull the RGB values, but you can change it to ColorIndex if you like.</p>\n\n<p>You can adapt this strategy:</p>\n\n<pre><code>Sub CellColors2CSV()\n    Dim j&amp;, k&amp;, c$, r As Range\n    Set r = ActiveSheet.Cells(1, 1)\n    Do\n        j = Len(r)\n        k = InStr(k + 1, r, \",\")\n        If k Then j = k - 1\n        c = c &amp; \",\" &amp; r.Characters(j, 1).Font.Color\n    Loop Until k = 0\n    c = Mid$(c, 2)\n    MsgBox c\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 482, "user_id": 1925992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78b72aef1238e23c76d98f7cc5192f52?s=128&d=identicon&r=PG", "display_name": "ojs", "link": "https://stackoverflow.com/users/1925992/ojs"}, "is_accepted": false, "score": 0, "last_activity_date": 1448229374, "creation_date": 1448229374, "answer_id": 33860717, "question_id": 32741136, "link": "https://stackoverflow.com/questions/32741136/extracting-font-color-from-cells-with-multiple-colors-in-the-cell/33860717#33860717", "title": "Extracting font color from cells with multiple colors in the cell", "body": "<p>After the answer from Excel Hero then I managed to concoct up this code which fulfilled my needs which are a function that returns the colors in a Collection (could be an array also): </p>\n\n<pre><code>Function GetColors(i, j) As Collection\nDim l&amp;, k&amp;, r As Range\nDim c As Collection\nSet c = New Collection\nSet r = ActiveSheet.Cells(i, j)\nDo\n    l = Len(r)\n    If Not InStr(r, \",\") Then\n        k = InStr(k + 1, r, \",\")\n    ElseIf Not InStr(r, \" / \") Then\n        k = InStr(k + 1, r, \" / \")\n    End If\n    If k Then l = k - 1\n    c.Add r.Characters(l, 1).Font.ColorIndex\nLoop Until k = 0\nSet GetColors = c\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 482, "user_id": 1925992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78b72aef1238e23c76d98f7cc5192f52?s=128&d=identicon&r=PG", "display_name": "ojs", "link": "https://stackoverflow.com/users/1925992/ojs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1913, "favorite_count": 0, "accepted_answer_id": 32743475, "answer_count": 3, "score": 8, "last_activity_date": 1448229374, "creation_date": 1443015344, "last_edit_date": 1531161705, "question_id": 32741136, "link": "https://stackoverflow.com/questions/32741136/extracting-font-color-from-cells-with-multiple-colors-in-the-cell", "title": "Extracting font color from cells with multiple colors in the cell", "body": "<p>I have an Excel sheet that I am trying to get into a MySQL database.</p>\n\n<ul>\n<li>I am using VBA to write the data out as text into a file and then upload that to the database.</li>\n<li>In the cells of the worksheet there are strings which have been color coded. </li>\n<li>The colors have a certain meaning so I want to preserve them when I move the values into the database (I have a special column in the database where I enumerate the colors).</li>\n</ul>\n\n<p>The thing is that some cells have strings separated by commas and on one side of the comma the string is black, on the other side it is blue (or vice versa and there can be more commas and strings in the cell).</p>\n\n<p><em>what I have tried</em></p>\n\n<p>I can extract the strings fine by using the <code>Split</code> function in VBA but that loses the formatting of the string.</p>\n\n<p>I can get the color of a cell using <code>Range(\"mycell\").Font.ColorIndex</code> but that returns <code>NULL</code> if there is more then one color in the string.</p>\n\n<p>Is it possible to get all the colors of a string?</p>\n\n<p>Example: one cell could contain the following string</p>\n\n<blockquote>\n  <p>\"W345, PO3244, 12309\"<br>\n   1.  (W345) would be black (colorindex -4105),<br>\n   2.  (PO3244) would be blue (colorindex 47)<br>\n   3.  (12309) would be red (colorindex 3).</p>\n</blockquote>\n"}, {"tags": ["excel", "range", "vba"], "comments": [{"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "edited": false, "score": 0, "creation_date": 1443020549, "post_id": 32740904, "comment_id": 53326962, "body": "Comment the MsgBox line and see if it still works"}, {"owner": {"reputation": 783, "user_id": 929935, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4e8306d82f4ea5fe673f449aa049b9db?s=128&d=identicon&r=PG&f=1", "display_name": "Amritha", "link": "https://stackoverflow.com/users/929935/amritha"}, "reply_to_user": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "edited": false, "score": 0, "creation_date": 1443021275, "post_id": 32740904, "comment_id": 53327502, "body": "It still wont work, I am not sure if the command I am setting is right. Thanks !"}, {"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "edited": false, "score": 0, "creation_date": 1443021501, "post_id": 32740904, "comment_id": 53327659, "body": "Do not use ** to comment your code. See this <a href=\"https://msdn.microsoft.com/en-us/library/vstudio/x18wx1tx%28v=vs.100%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/vstudio/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1443023069, "post_id": 32740904, "comment_id": 53328707, "body": "Is the target a structured table? I cannot see any reference to the target being a ListObject (aka structured table). <a href=\"http://stackoverflow.com/questions/9923385/combine-2-excel-tables-into-one-appending-the-data\">This</a> might help."}, {"owner": {"reputation": 783, "user_id": 929935, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4e8306d82f4ea5fe673f449aa049b9db?s=128&d=identicon&r=PG&f=1", "display_name": "Amritha", "link": "https://stackoverflow.com/users/929935/amritha"}, "edited": false, "score": 0, "creation_date": 1443023431, "post_id": 32740904, "comment_id": 53328947, "body": "The destination is a new worksheet where I am trying to paste part of the original table. I will take a look at the structures table but to answer your question the worksheet is blank and the code tries to paste content on it by setting the range of the tables equal."}], "owner": {"reputation": 783, "user_id": 929935, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4e8306d82f4ea5fe673f449aa049b9db?s=128&d=identicon&r=PG&f=1", "display_name": "Amritha", "link": "https://stackoverflow.com/users/929935/amritha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 784, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1478294448, "creation_date": 1443014826, "last_edit_date": 1531161705, "question_id": 32740904, "link": "https://stackoverflow.com/questions/32740904/setting-the-range-of-one-table-equal-to-another", "title": "Setting the Range of one Table equal to another", "body": "<p>As part of a bigger code, I need to copy part of a table from an existing worksheet to a new one. Instead of using the heavy copy-paste functions in Excel, I want to do this by setting the range of both the tables equal.  </p>\n\n<p>The code I have is below. I am looping through the existing table headers and trying to copy only the columns I want to another sheet called \"temp\". I am trying to set the range and I want the formulas also to copy. When I run the code it seems to be working until the line of the MsgBox inside the loop where the code stops and gets stuck.</p>\n\n<pre><code> Loop\n    For i = LBound(tableHeaders) To UBound(tableHeaders)\n    ActiveSheet.Range(tableSourceCell).Select\n        Do While ActiveCell.Column &lt; ActiveSheet.Range(tableSourceEndHeaderCell).Column + 1\n            If ActiveCell.Value = tableHeaders(i) Then\n                **MsgBox (Sheets(\"temp\").Range(Sheets(\"temp\").Range(tableColumn, 1).Address, Sheets(\"temp\").Range(tableColumn, tableSourceEndRow - ActiveCell.Row).Address).Address)\n\n                Sheets(\"temp\").Range(Sheets(\"temp\").Range(tableColumn, 1).Address, Sheets(\"temp\").Range(tableColumn, tableSourceEndRow - ActiveCell.Row).Address).Formula = ActiveSheet.Range(ActiveCell.Address, ActiveSheet.Range(ActiveCell.Column, tableSourceEndRow).Address).Formula**\n\n                tableColumn = tableColumn + 1\n            End If\n            ActiveCell.Offset(0, 1).Select\n        Loop\n    Next i\n</code></pre>\n\n<p>I am not sure what the error is.</p>\n\n<p>*Update - I replaced the code inside the loop with this command and it still gives me an error.</p>\n\n<pre><code>ActiveSheet.Range(ActiveCell.Address, ActiveSheet.Range(ActiveCell.Column, tableSourceEndRow).Address).Formula = Sheets(\"temp\").Range(Cells(1, tableColumn), Cells(tableSourceEndRow - ActiveCell.Row, tableColumn)).Forumla\n</code></pre>\n"}, {"tags": ["excel", "vba", "vlookup"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5367844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4e49f9033aabf9e82b8c59b68ee9c7d?s=128&d=identicon&r=PG&f=1", "display_name": "M. Wint", "link": "https://stackoverflow.com/users/5367844/m-wint"}, "edited": false, "score": 0, "creation_date": 1443014763, "post_id": 32740688, "comment_id": 53322461, "body": "Entry displays what i entered in the userform and MAC = &quot;&quot;"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1443014836, "last_edit_date": 1443014836, "creation_date": 1443014296, "answer_id": 32740688, "question_id": 32740549, "link": "https://stackoverflow.com/questions/32740549/userform-to-vlookup-and-display-data/32740688#32740688", "title": "UserForm to VLookup and display data", "body": "<p>The code is complaining about <code>MAC_Database</code> which is neither <strong>Dim</strong>'ed nor <strong>Set.</strong></p>\n\n<p>You have similar problems with <code>MAC</code> and <code>Entry.</code>  Once these problems have been corrected, you will need at least a <code>MsgBox</code> to display the value of <code>MAC</code></p>\n"}], "owner": {"reputation": 11, "user_id": 5367844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4e49f9033aabf9e82b8c59b68ee9c7d?s=128&d=identicon&r=PG&f=1", "display_name": "M. Wint", "link": "https://stackoverflow.com/users/5367844/m-wint"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1443014836, "creation_date": 1443013932, "last_edit_date": 1443014828, "question_id": 32740549, "link": "https://stackoverflow.com/questions/32740549/userform-to-vlookup-and-display-data", "title": "UserForm to VLookup and display data", "body": "<p>'Entry = MAC address entered and MAC should display the same MAC found in my worksheet\n'Error 424: Object required</p>\n\n<pre><code>Private Sub MAC_Search_Click()\n\nMAC = Application.WorksheetFunction.VLookup(Entry, MAC_Database.Range(\"A4:M3573\"), 2, False)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1443015137, "post_id": 32740500, "comment_id": 53322772, "body": "Which code line is highlighted when you get that error?"}, {"owner": {"reputation": 45, "user_id": 4651080, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/x8fZ2.png?s=128&g=1", "display_name": "Rynoc", "link": "https://stackoverflow.com/users/4651080/rynoc"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1443017738, "post_id": 32740500, "comment_id": 53324798, "body": "Unfortunately there is no debug info that is brought up. just the error:     &quot;The expression on click you entered as the event property setting produced the following error: Invalid outside procedure.&quot;"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 2, "creation_date": 1443018301, "post_id": 32740500, "comment_id": 53325230, "body": "Make sure you have <code>Option Explicit</code> in the module&#39;s Declarations section.  Then run Debug-&gt;Compile from the VB editor&#39;s main menu.  <code>Dim usr As sting</code> should trigger a compile error, <i>&quot;User-defined type not defined&quot;</i>.  Change that to <code>As String</code> and try compile again."}, {"owner": {"reputation": 45, "user_id": 4651080, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/x8fZ2.png?s=128&g=1", "display_name": "Rynoc", "link": "https://stackoverflow.com/users/4651080/rynoc"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1443018731, "post_id": 32740500, "comment_id": 53325567, "body": "Alright fixed the declare statement (String and Option Explicit). After compiling and running the code again I get &quot;Variable not defined&quot; on <code>Main</code> of <code>DoCmd.OpenForm (Main)</code> and I do indeed have that form in my DB."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1443018969, "post_id": 32740500, "comment_id": 53325758, "body": "Good!  Now fix that.  <code>OpenForm</code> expects a string value for the form name, and don&#39;t include parentheses there: <code>DoCmd.OpenForm &quot;Main&quot;</code>"}, {"owner": {"reputation": 45, "user_id": 4651080, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/x8fZ2.png?s=128&g=1", "display_name": "Rynoc", "link": "https://stackoverflow.com/users/4651080/rynoc"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1443019818, "post_id": 32740500, "comment_id": 53326428, "body": "Got that working. Now I just need to fix the Runtime Error 3125 which is on <code>DLookup(&quot;[Password]&quot;, &quot;Login&quot;, &quot;[Me.Username.Value]= &#39;&quot; &amp; [Username] &amp; &quot;&#39;&quot;)</code> which says <i>&quot; is not a valid name</i>"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1443020122, "post_id": 32740500, "comment_id": 53326648, "body": "OK, I updated the question with the code changes I think you&#39;re using now.  Please fix anything I got wrong.  For the <code>DLookup</code>, try asdev&#39;s suggestion with the quotes: <code>DLookup(&quot;[Password]&quot;, &quot;Login&quot;, &quot;[Username]=&#39;&quot; &amp; Me.Username.Value &amp; &quot;&#39;&quot;)</code>"}, {"owner": {"reputation": 45, "user_id": 4651080, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/x8fZ2.png?s=128&g=1", "display_name": "Rynoc", "link": "https://stackoverflow.com/users/4651080/rynoc"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1443021680, "post_id": 32740500, "comment_id": 53327776, "body": "Awesome. Everything is mostly working as intended. I will update the code soon so everyone can have a simple solution to this issue."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1443021790, "post_id": 32740500, "comment_id": 53327862, "body": "That is encouraging.  :-)  If you show us your solution, please submit it as an answer instead of adding it to the question.  Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 1, "creation_date": 1443022566, "post_id": 32741110, "comment_id": 53328398, "body": "As you allude to, I&#39;m pretty sure the single quotes will be needed as well <code>&quot;[Username]=&#39;&quot; &amp; Me.Username.Value &amp; &quot;&#39;&quot;</code>"}, {"owner": {"reputation": 933, "user_id": 5345818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f648ca9f16c3a02a085cf79fa59c282?s=128&d=identicon&r=PG", "display_name": "asdev", "link": "https://stackoverflow.com/users/5345818/asdev"}, "reply_to_user": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1443022927, "post_id": 32741110, "comment_id": 53328614, "body": "Edited as from @Matt Hall suggested"}], "tags": [], "owner": {"reputation": 933, "user_id": 5345818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f648ca9f16c3a02a085cf79fa59c282?s=128&d=identicon&r=PG", "display_name": "asdev", "link": "https://stackoverflow.com/users/5345818/asdev"}, "is_accepted": false, "score": 2, "last_activity_date": 1443022846, "last_edit_date": 1443022846, "creation_date": 1443015275, "answer_id": 32741110, "question_id": 32740500, "link": "https://stackoverflow.com/questions/32740500/user-authentication-dlookup-access-07-vba/32741110#32741110", "title": "User Authentication Dlookup [Access 07 VBA]", "body": "<p>Try</p>\n\n<pre><code>usr = DLookup(\"[Password]\", \"Login\", \"[Username]='\" &amp; Me.Username.Value &amp; \"'\" )\nlvl = DLookup(\"[Level]\", \"Login\", \"[Username]='\" &amp; Me.Username.Value &amp; \"'\")\n</code></pre>\n\n<p>See <a href=\"https://support.office.com/en-us/article/DLookup-Function-8896cb03-e31f-45d1-86db-bed10dca5937?ui=en-US&amp;rs=en-US&amp;ad=US\" rel=\"nofollow\">https://support.office.com/en-us/article/DLookup-Function-8896cb03-e31f-45d1-86db-bed10dca5937?ui=en-US&amp;rs=en-US&amp;ad=US</a> for more Info.</p>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 4651080, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/x8fZ2.png?s=128&g=1", "display_name": "Rynoc", "link": "https://stackoverflow.com/users/4651080/rynoc"}, "is_accepted": false, "score": 1, "last_activity_date": 1443022961, "creation_date": 1443022961, "answer_id": 32743959, "question_id": 32740500, "link": "https://stackoverflow.com/questions/32740500/user-authentication-dlookup-access-07-vba/32743959#32743959", "title": "User Authentication Dlookup [Access 07 VBA]", "body": "<p>After much help from HansUp Sensei and the crucial addition from asdev I have completed the working code for a simple user authentication form based on a table. You can add levels and modify the <code>If</code> statement to assign appropriate access to areas of the database.</p>\n\n<pre><code> Public Sub Command4_Click()\n\nDim usr As String\nDim lvl As String\nDim lck As Integer\n\nusr = DLookup(\"[Password]\", \"Login\", \"[Username]='\" &amp; Me.Username.Value &amp; \"'\")\nlvl = DLookup(\"[Level]\", \"Login\", \"[Username]='\" &amp; Me.Username.Value &amp; \"'\")\n\nIf usr = Me.Password.Value Then\nlck = 1\nElse\nMsgBox (\"Invalid Credentials\")\nEnd If\n\nDo While lck = 1\n    If lvl = \"3\" Then\n        DoCmd.OpenForm \"Main\"\n        lck = 0\n    End If\nLoop\n</code></pre>\n\n<p><code>End Sub</code></p>\n"}], "owner": {"reputation": 45, "user_id": 4651080, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/x8fZ2.png?s=128&g=1", "display_name": "Rynoc", "link": "https://stackoverflow.com/users/4651080/rynoc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1443022961, "creation_date": 1443013801, "last_edit_date": 1443019918, "question_id": 32740500, "link": "https://stackoverflow.com/questions/32740500/user-authentication-dlookup-access-07-vba", "title": "User Authentication Dlookup [Access 07 VBA]", "body": "<p>I'm trying to make a user authentication system for my access database. currently I have a form which has two combo boxes \"Username\" and \"Password\" \nand a button used to authenticate entered data. I also have a table named \"Login\" which houses all of the usernames and passwords and also their \"Level\" which is their clearance level which will determine which version of a form opens as well as other information. I am not proficient at Dlookup and I am getting an error \"Invalid outside procedure\" Can I not pass the dlookup value as a string that can be used in an if statement?</p>\n\n<p>CODE:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub Command4_Click()\n    Dim usr As String\n    Dim lvl As String\n    Dim lck As Integer\n\n    usr = DLookup(\"Password\", \"Login\", \"Me.Username.Value= 'Username'\")\n    lvl = DLookup(\"Level\", \"Login\", \"Me.Username.Value= 'Username'\")\n\n    If usr = Me.Password.Value Then lck = 1\n\n    Do While lck = 1\n        If lvl = 3 Then\n            DoCmd.OpenForm \"Main\"\n            lck = 0\n        End If\n    Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "for-loop"], "comments": [{"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1443014668, "post_id": 32740389, "comment_id": 53322382, "body": "<code>copy the cell-value in the new row</code>... where will be this new row? in same sheet or different sheet?"}, {"owner": {"reputation": 533, "user_id": 3608870, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2948660089d94f3c46bff4c4cb2470a3?s=128&d=identicon&r=PG&f=1", "display_name": "siliconchris", "link": "https://stackoverflow.com/users/3608870/siliconchris"}, "edited": false, "score": 0, "creation_date": 1443014761, "post_id": 32740389, "comment_id": 53322458, "body": "The columns in question go from column c to column z. The entries of each column will go in a new column being AB in the same sheet."}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 1, "creation_date": 1443014946, "post_id": 32740389, "comment_id": 53322604, "body": "Post your sample data and expected result."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1443015267, "post_id": 32740389, "comment_id": 53322863, "body": "In each of the columns c to z does the data appear in a single block or are there blank cells in the middle of the data which need to be eliminated?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1443015534, "post_id": 32740389, "comment_id": 53323084, "body": "You need to replace <code>For cnt = Start To cnt &lt;= Ende</code> by <code>For cnt = Start To Ende</code> (though there are more elegant ways to iterate through the values in the columns)"}], "answers": [{"comments": [{"owner": {"reputation": 533, "user_id": 3608870, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2948660089d94f3c46bff4c4cb2470a3?s=128&d=identicon&r=PG&f=1", "display_name": "siliconchris", "link": "https://stackoverflow.com/users/3608870/siliconchris"}, "edited": false, "score": 0, "creation_date": 1443018970, "post_id": 32741366, "comment_id": 53325759, "body": "Perfect. It&#39;s exactly what I needed and lean"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 2, "last_activity_date": 1443015876, "creation_date": 1443015876, "answer_id": 32741366, "question_id": 32740389, "link": "https://stackoverflow.com/questions/32740389/iterate-over-columns-and-rows/32741366#32741366", "title": "Iterate over columns and rows", "body": "<p>Should do the job very quickly:  </p>\n\n<pre><code>Sub MacroMan()\n\nDim x, y\n    x = [C8:Z208]\n    Range(\"AB7\").Value = \"DDIC-Liste:\"\n    For Each y In x\n        If Not y = vbNullString Then Range(\"AB\" &amp; Rows.count).End(xlUp).Offset(1, 0).value = y\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1443018585, "creation_date": 1443018585, "answer_id": 32742366, "question_id": 32740389, "link": "https://stackoverflow.com/questions/32740389/iterate-over-columns-and-rows/32742366#32742366", "title": "Iterate over columns and rows", "body": "<p>This should do the job:</p>\n\n<pre><code>Dim pasteCell As Range, origin As Range\nSet pasteCell = [AB1] 'Destination\nDim firstRow as Long\nfirstRow = 1\nFor columnIndex = 3 To 26 Step 1 'Columns from C to Z\n    Set origin = Range(Cells(firstRow , columnIndex), Cells(firstRow , columnIndex).End(xlDown))\n    origin.Copy\n    pasteCell.Insert xlShiftDown, origin\nNext columnIndex\nSet origin = Nothing\n</code></pre>\n\n<p>You can adapt the Destination cell and of course the first copied row of each column.</p>\n"}], "owner": {"reputation": 533, "user_id": 3608870, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2948660089d94f3c46bff4c4cb2470a3?s=128&d=identicon&r=PG&f=1", "display_name": "siliconchris", "link": "https://stackoverflow.com/users/3608870/siliconchris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 32741366, "answer_count": 2, "score": 0, "last_activity_date": 1443018585, "creation_date": 1443013431, "last_edit_date": 1443017137, "question_id": 32740389, "link": "https://stackoverflow.com/questions/32740389/iterate-over-columns-and-rows", "title": "Iterate over columns and rows", "body": "<p>I have an Excel sheet which consists of multiple columns. In each column there are multiple rows - not always the same number of rows, but never more then from row 8 to row 208. I need all values from each column in a new column as one ordered list, beginning with column 3 (being C) till column 23 (being Z). I need this new column (being at position AB in the same sheet) with ALL values and without empty rows, as it is the source for a drop down list.</p>\n\n<p>This is, what I have so far but it does not work:</p>\n\n<pre><code>Sub createDDICListe()\n   Dim c\n   Dim counter\n   Dim cnt\n   Dim Start\n   Dim Ende\n   Start = 8\n   Ende = 208\n   counter = 8\n   cnt = Start\n\n   Set Spalten = [\"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\", \"K\", \"L\", \"M\", \"N\", \"O\", \"P\", \"Q\", \"R\", \"S\", \"T\", \"U\", \"V\", \"W\", \"X\", \"Y\"]\n\n   ActiveSheet.Range(\"AB7\") = \"DDIC-Liste:\"\n   For Each c In Spalten\n       cnt = Start\n       On Error Resume Next\n       For cnt = Start To cnt &lt;= Ende\n          Dim Cell\n          Cell = Cells(cnt, c)\n          If IsError(Cell) Or Cell.Value = False Or Cell.Value = \"\" Then\n             GoTo weiter\n        Else\n            Cells(counter, \"AB\").Value = Cell.Value\n            counter = counter + 1\n        End If\n        cnt = cnt + 1\n    Next\nweiter:\n    Next\nEnd Sub\n</code></pre>\n\n<p>How to iterate over the columns and in this \"for each loop\" iterate over the rows and copy the cell-value in the new column row by row?</p>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1443022095, "post_id": 32740354, "comment_id": 53328104, "body": "I would start by taking advantage of the <a href=\"https://support.office.com/en-us/article/IFERROR-function-F59BACDC-78BD-4924-91DF-A869D0B08CD5\" rel=\"nofollow noreferrer\">IFERROR function</a> introduced in XL2007 and shorten the formula to <code>=IFERROR(VLOOKUP(A2;MW!$A$2:$X$1000;6;FALSE);        IFERROR(VLOOKUP(A2;RZ!$A$2:$X$1000;6;FALSE);              IFERROR(VLOOKUP(A2;FK!$A$2:$X$1000;6;FALSE);                    IFERROR(VLOOKUP(A2;MK!$A$2:$X$1000;6;FALSE); &quot;&quot;))))</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5367820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/313dc5e36f5e135c26c9dcbd3f3a4101?s=128&d=identicon&r=PG&f=1", "display_name": "M. W. ", "link": "https://stackoverflow.com/users/5367820/m-w"}, "edited": false, "score": 0, "creation_date": 1443014573, "post_id": 32740748, "comment_id": 53322315, "body": "I am afraid it would work only for the first row. Some kind of iteration would be required for this function to work for anything below."}, {"owner": {"reputation": 1, "user_id": 5367820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/313dc5e36f5e135c26c9dcbd3f3a4101?s=128&d=identicon&r=PG&f=1", "display_name": "M. W. ", "link": "https://stackoverflow.com/users/5367820/m-w"}, "edited": false, "score": 0, "creation_date": 1443014693, "post_id": 32740748, "comment_id": 53322406, "body": "Alright, I&#39;ll do that as soon as possible. Could you provide the rest of the code? I am not too familiar with VBA. :s"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1443015058, "post_id": 32740748, "comment_id": 53322706, "body": "@Macro Man code is complete. You have to just put it between ` Sub Macro() and End Sub . Google to see VBA examples."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 1, "user_id": 5367820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/313dc5e36f5e135c26c9dcbd3f3a4101?s=128&d=identicon&r=PG&f=1", "display_name": "M. W. ", "link": "https://stackoverflow.com/users/5367820/m-w"}, "edited": false, "score": 1, "creation_date": 1443015478, "post_id": 32740748, "comment_id": 53323033, "body": "@M.W. see above comment, if you don&#39;t understand VBA I would suggest not to use it until you do understand - changes done in code cannot be undone."}, {"owner": {"reputation": 1, "user_id": 5367820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/313dc5e36f5e135c26c9dcbd3f3a4101?s=128&d=identicon&r=PG&f=1", "display_name": "M. W. ", "link": "https://stackoverflow.com/users/5367820/m-w"}, "edited": false, "score": 0, "creation_date": 1443079941, "post_id": 32740748, "comment_id": 53351078, "body": "I am afraid that it doesn&#39;t seem to work. I keep getting Runtime error 1004 doing it your way.                                                                         To what I said before: I usually do understand the code but I am unable to write one myself yet. In that way I am not experienced enough and it is the reason why I am seeking your advice."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 0, "last_activity_date": 1443014456, "creation_date": 1443014456, "answer_id": 32740748, "question_id": 32740354, "link": "https://stackoverflow.com/questions/32740354/insert-formulas-in-cells-until-blank-row/32740748#32740748", "title": "Insert formulas in cells until blank row", "body": "<p>Something like this?  </p>\n\n<pre><code>Range(\"F2:F\" &amp; Cells(1, 6).End(xlDown).Row).Formula = _\n   \"=IF(ISERROR(VLOOKUP(A2;MW!$A$2:$X$1000;6;FALSE));IF(ISERROR(VLOOKUP(A2;RZ!$A$2:$X$1000;6;FALSE));IF(ISERROR(VLOOKUP(A2;FK!$A$2:$X$1000;6;FALSE));IF(ISERROR(VLOOKUP(A2;MK!$A$2:$X$1000;6;FALSE));VLOOKUP(A2;AS!$A$2:$X$1000;6;FALSE);VLOOKUP(A2;MK!$A$2:$X$1000;6;FALSE));VLOOKUP(A2;FK!$A$2:$X$1000;6;FALSE));VLOOKUP(A2;RZ!$A$2:$X$1000;6;FALSE));VLOOKUP(A2;MW!$A$2:$X$1000;6;FALSE)\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5367820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/313dc5e36f5e135c26c9dcbd3f3a4101?s=128&d=identicon&r=PG&f=1", "display_name": "M. W. ", "link": "https://stackoverflow.com/users/5367820/m-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1443084375, "creation_date": 1443084375, "answer_id": 32757074, "question_id": 32740354, "link": "https://stackoverflow.com/questions/32740354/insert-formulas-in-cells-until-blank-row/32757074#32757074", "title": "Insert formulas in cells until blank row", "body": "<p>Alright, I moved a step further. \nUnfortunately your code doesn't work (runtime error) but I managed to put something else together. </p>\n\n<pre><code>Sub Macro1()\n\nRange(\"F2\").Select\nRange(\"F2:F4000\").Formula = \"=IF(ISERROR(VLOOKUP(A2;MW!$A$2:$X$1000;6;FALSE));IF(ISERROR(VLOOKUP(A2;RZ!$A$2:$X$1000;6;FALSE));IF(ISERROR(VLOOKUP(A1;FK!$A$2:$X$1000;6;FALSE));IF(ISERROR(VLOOKUP(A2;MK!$A$2:$X$1000;6;FALSE));VLOOKUP(A2;AS!$A$2:$X$1000;6;FALSE);VLOOKUP(A2;MK!$A$2:$X$1000;6;FALSE));VLOOKUP(A1;FK!$A$2:$X$1000;6;FALSE));VLOOKUP(A2;RZ!$A$2:$X$1000;6;FALSE));VLOOKUP(A2;MW!$A$2:$X$1000;6;FALSE))\"\nEnd Sub\n</code></pre>\n\n<p>It does work perfectly well if I enter =sum(B2+B3). With =if it ceases to work after I enter first \"(\". </p>\n\n<p>Any ideas?</p>\n"}], "owner": {"reputation": 1, "user_id": 5367820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/313dc5e36f5e135c26c9dcbd3f3a4101?s=128&d=identicon&r=PG&f=1", "display_name": "M. W. ", "link": "https://stackoverflow.com/users/5367820/m-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1443084375, "creation_date": 1443013318, "last_edit_date": 1443022156, "question_id": 32740354, "link": "https://stackoverflow.com/questions/32740354/insert-formulas-in-cells-until-blank-row", "title": "Insert formulas in cells until blank row", "body": "<p>I wrote this formula and it works just fine within a regular worksheet but I have no idea how to put it into VBA:</p>\n\n<pre><code>=IF(ISERROR(VLOOKUP(A2;MW!$A$2:$X$1000;6;FALSE));IF(ISERROR(VLOOKUP(A2;RZ!$A$2:$X$1000;6;FALSE));IF(ISERROR(VLOOKUP(A2;FK!$A$2:$X$1000;6;FALSE));IF(ISERROR(VLOOKUP(A2;MK!$A$2:$X$1000;6;FALSE));VLOOKUP(A2;AS!$A$2:$X$1000;6;FALSE);VLOOKUP(A2;MK!$A$2:$X$1000;6;FALSE));VLOOKUP(A2;FK!$A$2:$X$1000;6;FALSE));VLOOKUP(A2;RZ!$A$2:$X$1000;6;FALSE));VLOOKUP(A2;MW!$A$2:$X$1000;6;FALSE))\n</code></pre>\n\n<p>However, I'd like to make this process automated. It would have to put this line in every cell in column F until it encounters a blank row. I am aware that there would have to be some sort of iteration for A2 part (for cell F5 function it would be A5 and so on).</p>\n"}, {"tags": ["vba", "excel", "delete-row"], "answers": [{"tags": [], "owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "is_accepted": true, "score": 2, "last_activity_date": 1443011938, "creation_date": 1443011938, "answer_id": 32739859, "question_id": 32739765, "link": "https://stackoverflow.com/questions/32739765/delete-an-entire-row-after-the-values-have-been-mapped/32739859#32739859", "title": "Delete an entire row after the values have been mapped", "body": "<p>It should work like this:</p>\n\n<pre><code>If Not IsEmpty(Slave.Cells(i, 3)) Then Slave.Cells(i, 3).EntireRow.Delete\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 5341242, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Bh8YE.jpg?s=128&g=1", "display_name": "Wowdude", "link": "https://stackoverflow.com/users/5341242/wowdude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 32739859, "answer_count": 1, "score": 1, "last_activity_date": 1443017295, "creation_date": 1443011630, "last_edit_date": 1443017295, "question_id": 32739765, "link": "https://stackoverflow.com/questions/32739765/delete-an-entire-row-after-the-values-have-been-mapped", "title": "Delete an entire row after the values have been mapped", "body": "<p>I'm looking to delete each row after the value has been mapped from this sheet to another. Below is my current code. The line <code>If Not IsEmpty(Slave.Cells(i, 3)) Then EntireRow.Delete</code> (which doesn't work) is ideally where I want my row deletion to be, so that after the mapping the row is promptly deleted and the code moves on.</p>\n\n<p>However I can't seem get this to work. It runs on quite a large set of data, so it needs to be simple but effective.  </p>\n\n<p>Any ideas of how I could do this or maybe use a Module that contained simple code?</p>\n\n<pre><code>Private Sub CommandButton21_Click()\n\nDim Master As Worksheet 'declare both\nDim Slave As Worksheet\n\nApplication.ScreenUpdating = False\n\nSet Master = ThisWorkbook.Worksheets(\"Unallocated\")\nSet Slave = ThisWorkbook.Worksheets(\"Convertor\")\n\n\nFor j = 1 To 5000 '(the master sheet)\n\nFor i = 1 To 5000 '(the slave sheet) 'for first 1000 cells\n    If Trim(Master.Cells(j, 3).Value2) = vbNullString Then Exit For 'if ID cell is blank exit\n    If Master.Cells(j, 3).Value = Slave.Cells(i, 1).Value Then\n    If IsEmpty(Slave.Cells(i, 3)) Then Exit Sub\n        Master.Cells(j, 2).Value = Slave.Cells(i, 3).Value\n        Master.Cells(j, 8).Value = Slave.Cells(i, 4).Value\n        Master.Cells(j, 9).Value = Slave.Cells(i, 5).Value\n        Master.Cells(j, 10).Value = Slave.Cells(i, 6).Value\n        Master.Cells(j, 11).Value = Slave.Cells(i, 7).Value\n        Master.Cells(j, 12).Value = Slave.Cells(i, 8).Value\n        Master.Cells(j, 13).Value = Slave.Cells(i, 9).Value\n        Master.Cells(j, 23).Value = Slave.Cells(i, 11).Value\n        Master.Cells(j, 24).Value = Slave.Cells(i, 12).Value\n        Master.Cells(j, 25).Value = Slave.Cells(i, 13).Value\n        Master.Cells(j, 26).Value = Slave.Cells(i, 14).Value\n        Master.Cells(j, 27).Value = Slave.Cells(i, 15).Value\n        Master.Cells(j, 28).Value = Slave.Cells(i, 16).Value\n        If Not IsEmpty(Slave.Cells(i, 3)) Then EntireRow.Delete\n\n    End If\n    Next\n\n\n    Next\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1443014867, "post_id": 32739715, "comment_id": 53322544, "body": "@user1875797 What do you want the modifications to be saved in the template (so that the template changes), or in a document file <i>derived</i> from the template?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1875797"}, "edited": false, "score": 0, "creation_date": 1443016034, "post_id": 32739715, "comment_id": 53323477, "body": "Hi the template is just a blank document with a header and footer, I&#39;d like to save it as a new word document which is in the customSavePath variable, thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "is_accepted": false, "score": 2, "last_activity_date": 1443012257, "creation_date": 1443012257, "answer_id": 32739985, "question_id": 32739715, "link": "https://stackoverflow.com/questions/32739715/open-word-template-paste-excel-data-in-and-save/32739985#32739985", "title": "Open Word template, paste Excel data in and save", "body": "<p>Try documents.add instead of documents.open</p>\n\n<p>It will open an instance of the template, instead of the template itself</p>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 2, "last_activity_date": 1499291159, "last_edit_date": 1499291159, "creation_date": 1443015188, "answer_id": 32741075, "question_id": 32739715, "link": "https://stackoverflow.com/questions/32739715/open-word-template-paste-excel-data-in-and-save/32741075#32741075", "title": "Open Word template, paste Excel data in and save", "body": "<p>First, you are getting a lock error because the instance of word is still running in the background and locking the file you are trying to re-open. You can verify that with the task manager. To avoid this error, you can either:</p>\n\n<ul>\n<li>kill the WinWord.exe process in the task manager</li>\n<li>use wdApp.documents.Add instead of .open</li>\n</ul>\n\n<p>Or (best)</p>\n\n<ul>\n<li><p>Write a function that either gets the word application running in the background or if none, creates a new one. This is the best option IMO, because you will not have the risk to have many invisible Word processes running in the background.</p>\n\n<pre><code>Private Function GetWordApp() As Word.Application\n\n    On Error Resume Next\n\n    Set GetWordApp = GetObject(, \"Word.Application\")\n\n    If GetWordApp Is Nothing Then Set GetWordApp = New Word.Application\n\nEnd Function\n</code></pre></li>\n</ul>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1875797"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5473, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1499291159, "creation_date": 1443011489, "last_edit_date": 1443014173, "question_id": 32739715, "link": "https://stackoverflow.com/questions/32739715/open-word-template-paste-excel-data-in-and-save", "title": "Open Word template, paste Excel data in and save", "body": "<p>I've got an Excel data range I need to be able to paste into a Word document template and save automatically using a macro from Excel.</p>\n\n<p>Currently when it is run, it tells me the template file is already open/locked and I have to open a read only copy for it to continue.\nIt does create and save the word file but when I try open the saved word doc it says there are problems with the contents..</p>\n\n<p>I've Googled a lot and think I'm close but if anyone can give me some pointers that would be appreciated.</p>\n\n<pre><code>Option Explicit\n\nSub CopyExcelDataToWord2()\n\nDim wdApp As New Word.Application\nDim wdDoc As Word.Document\n\nDim wsSource As Excel.Worksheet\nDim docWordTarget As Object\nDim SaveAsName As String\nDim customSavePath As String\nDim nameFile, WordName2\nDim ColRange As Range\n\nSet wdDoc = wdApp.Documents.Open(\"C:\\test\\templ.dotx\")\nwdApp.Visible = True\n\n   'Cell with the filename to save final doc as\n   nameFile = Sheets(\"Form\").Cells(70, 1).Value\n\n'Gets the file path from cell and adds variable 'nameFile' value to the end\ncustomSavePath = Worksheets(\"Form\").Cells(57, 1).Value &amp; \"\\\" &amp; nameFile &amp; \".docx\"\n\n'sets the variable wsSource to the activesheet\nSet wsSource = ThisWorkbook.ActiveSheet\n\n    Set ColRange = Sheets(\"Form\").Range(\"A1:D54\")\n   'if no data is selected then exit sub\n    If ColRange Is Nothing Then\n        Exit Sub\n    'sets variable WordName2 to the selected columns address\n    Else\n       'sets variable WordName2 to column Range\n       WordName2 = ColRange.Address\n    End If\n\n\n'With word document make visible and select\nWith wdApp\n    .Visible = True\n    Set docWordTarget = .Documents.Open(\"C:\\test\\templ.dotx\")\n    .ActiveDocument.Select\nEnd With\n\n    'With excel workbook copy the column selected previously\n    With wsSource\n        .Range(WordName2).Copy\n    End With\n    'Paste data into word doc\n    With wdApp.Selection\n        .PasteExcelTable linkedtoexcel:=False, wordformatting:=False, RTF:=False\n        .TypeParagraph\n    End With\n\nWith wdApp\n  'Save word doc in the custom save path\n  .ActiveDocument.SaveAs Filename:=customSavePath\n    .ActiveWindow.Close\n    ' Kill the Object\n    .Quit\nEnd With\n\nMsgBox \"Exported To:\" &amp; vbNewLine &amp; vbNewLine &amp; (customSavePath)\n\nSet docWordTarget = Nothing\nSet wdApp = Nothing\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["javascript", "excel", "acrobat", "vba"], "answers": [{"tags": [], "owner": {"reputation": 53495, "user_id": 5090771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2EOZG.png?s=128&g=1", "display_name": "WhiteHat", "link": "https://stackoverflow.com/users/5090771/whitehat"}, "is_accepted": true, "score": 1, "last_activity_date": 1443012373, "creation_date": 1443012373, "answer_id": 32740022, "question_id": 32739117, "link": "https://stackoverflow.com/questions/32739117/how-to-rewrite-a-excel-vba-to-acrobat-javascript/32740022#32740022", "title": "How to rewrite a excel-vba to acrobat javascript?", "body": "<p>I think this is what you're looking for, I tried to keep as close as possible to the Excel code, hoping it would be easier to follow. Let me know if you have any questions...</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>alert(upsp('161628686041430'));\r\n\r\nfunction upsp(nummer) {\r\n  var qsm;\r\n  var p;\r\n  var returnValue;\r\n\r\n  qsm = 0;\r\n  for (var i = 0; i &lt; nummer.length; i++) {\r\n    p = nummer.substr(i, 1);\r\n    if (p.charCodeAt(0) &gt; 57) {\r\n      p = (p.charCodeAt(0) - 63) % 10;\r\n    }\r\n    qsm = qsm + (p * (2 - ((i + 1) % 2)));\r\n  }\r\n\r\n  returnValue = 10 - (qsm % 10);\r\n  if (returnValue === 10) {\r\n    returnValue = 0;\r\n  }\r\n\r\n  return returnValue;\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 121, "user_id": 4373813, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7fbc11f2696aa9e7a31e815e34671e2a?s=128&d=identicon&r=PG&f=1", "display_name": "renokl2014", "link": "https://stackoverflow.com/users/4373813/renokl2014"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 32740022, "answer_count": 1, "score": 1, "last_activity_date": 1443012373, "creation_date": 1443009874, "last_edit_date": 1531164843, "question_id": 32739117, "link": "https://stackoverflow.com/questions/32739117/how-to-rewrite-a-excel-vba-to-acrobat-javascript", "title": "How to rewrite a excel-vba to acrobat javascript?", "body": "<p>this is a code from a excel macro (VB), how can i rewrite it, so it works on adobe acrobat?</p>\n\n<p>for e.g. nummer is \"161628686041430\" </p>\n\n<pre><code>Function upsp(nummer)\n' \u00dcbergeben wird KdNr+Serviceart+Paketnummer (ohne 1Z)\n'\nqsm = 0\nFor i = 1 To 15\np = Mid(nummer, i, 1)\nIf Asc(p) &gt; 57 Then p = (Asc(p) - 63) Mod 10\nqsm = qsm + (p * (2 - i Mod 2))\nNext\nupsp = 10 - (qsm Mod 10)\nIf upsp = 10 Then upsp = 0\nEnd Function\n</code></pre>\n\n<p>the result of this function should be \"2\".</p>\n\n<p>Thanks for help.</p>\n"}, {"tags": ["ms-access", "vba", "tablename", "field-names"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 4660232, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2cc310b8980ba78d8b6988854662cf45?s=128&d=identicon&r=PG&f=1", "display_name": "mccdo", "link": "https://stackoverflow.com/users/4660232/mccdo"}, "edited": false, "score": 0, "creation_date": 1443012969, "post_id": 32739973, "comment_id": 53321005, "body": "That sorted it, thanks asdev. And that MSDN link will work out to be very useful too."}], "tags": [], "owner": {"reputation": 933, "user_id": 5345818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f648ca9f16c3a02a085cf79fa59c282?s=128&d=identicon&r=PG", "display_name": "asdev", "link": "https://stackoverflow.com/users/5345818/asdev"}, "is_accepted": true, "score": 2, "last_activity_date": 1443012237, "creation_date": 1443012237, "answer_id": 32739973, "question_id": 32738934, "link": "https://stackoverflow.com/questions/32738934/get-table-and-field-names-used-to-create-a-query-in-access-vba/32739973#32739973", "title": "Get Table and Field names used to create a query in Access VBA", "body": "<p>Get the original field name:</p>\n\n<pre><code>fld.SourceField\n</code></pre>\n\n<p>Get the original table name</p>\n\n<pre><code>fld.SourceTable\n</code></pre>\n\n<p>Hint: You can always find available properties in the API of MSDN, in this case: <a href=\"https://msdn.microsoft.com/en-us/library/office/dn123487.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/dn123487.aspx</a>\nor by using the intellisense in the VBA editor.</p>\n"}], "owner": {"reputation": 55, "user_id": 4660232, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2cc310b8980ba78d8b6988854662cf45?s=128&d=identicon&r=PG&f=1", "display_name": "mccdo", "link": "https://stackoverflow.com/users/4660232/mccdo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4407, "favorite_count": 0, "accepted_answer_id": 32739973, "answer_count": 1, "score": 0, "last_activity_date": 1459427178, "creation_date": 1443009299, "last_edit_date": 1459427178, "question_id": 32738934, "link": "https://stackoverflow.com/questions/32738934/get-table-and-field-names-used-to-create-a-query-in-access-vba", "title": "Get Table and Field names used to create a query in Access VBA", "body": "<p>I am trying to get a list of the tables and fields that are used to produce queries in an access database. I am able to identify the fields found in a query output but not the fields used to design the query.</p>\n\n<p>In other words, is it possible to obtain the table and field names specified in the query builder section of the design view of a query in Access?</p>\n\n<p>I have found and developed upon some VBA code that gets all of the fields that are in the output of a query (below) but this does not get the info I need. Is it possible to achieve what I am looking for?</p>\n\n<pre><code>Function listQueryFields() As String\n\n    Dim db As DAO.Database\n    Dim qry As DAO.QueryDef\n    Dim fld As Field\n    Dim rs As Recordset\n\n    Set db = CurrentDb()\n    Set rs = db.OpenRecordset(\"tbl_Query_Field_Names\")\n\n    For Each qry In db.QueryDefs\n        If InStr(1, qry.Name, \"_qry_\", vbTextCompare) &gt; 0 Then\n            Debug.Print qry.Name\n                For Each fld In qry.Fields\n                   Debug.Print fld.Name\n                   rs.AddNew\n                        rs(0) = qry.Name\n                        rs(1) = fld.Name\n                    rs.Update\n                 Next\n\n        End If\n    Next\n\n    Set db = Nothing\n    Set rs = Nothing\n    Exit Function\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "is_accepted": true, "score": 3, "last_activity_date": 1443009081, "creation_date": 1443009081, "answer_id": 32738850, "question_id": 32738849, "link": "https://stackoverflow.com/questions/32738849/copying-data-from-an-excel-file-in-word-using-word-vba/32738850#32738850", "title": "Copying Data from an Excel File in Word using Word VBA", "body": "<p>See Code below, this should be useful in most applications</p>\n\n<pre><code> Sub InsertEventData()\n\n'inserting just the used data from an excel sheet\n\n\nDim ExcelProgram As Object\nDim EventFile As Object\nDim EventData As Object\n\n\n\n'You can use someother Code to develop the Excel File Path\nSomeExcelEventFile = \"C:\\Users\\User1\\Documents\\ExcelSheet1.xls\"\n\n'Starting Excel\nSet ExcelProgram = CreateObject(\"Excel.Application\")\n'Not allowing it to be visible\nExcelProgram.Application.Visible = False\n\n'Opening the desired Test Module Specific Event\nSet EventFile = ExcelProgram.Application.Workbooks.Open(SomeExcelEventFile)\n\n\n'Selecting used range in the Event Log from the Excel file\nSet EventData = EventFile.ActiveSheet.UsedRange\n\n'If you want to copy a specific range of cells\n'Set EventData = EventFile.ActiveSheet.Range(\"C1:F50\")\n\n\n'Copying Event Log from the opened Excel File\nEventData.Copy\n\n'Pasting Event Log into Word Doc\nSelection.PasteAndFormat Type:=wdFormatOriginalFormatting\n\n\n'Clearing the Office Clipboard\n    Dim oData   As New DataObject 'object to use the clipboard\n    oData.SetText text:=Empty 'Clearing the text\n    oData.PutInClipboard 'Putting Empty text in the clipboard to empty it\n\n'Remove alert Messages from the Excel Program when closing\nExcelProgram.DisplayAlerts = False\n\n\n'Quiting the Excel Application\nExcelProgram.Quit\n\n'clean up Objects for next use\nSet ExcelProgram = Nothing\nSet EventFile = Nothing\n\n\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 876, "favorite_count": 1, "accepted_answer_id": 32738850, "answer_count": 1, "score": 1, "last_activity_date": 1443806356, "creation_date": 1443009081, "last_edit_date": 1443806356, "question_id": 32738849, "link": "https://stackoverflow.com/questions/32738849/copying-data-from-an-excel-file-in-word-using-word-vba", "title": "Copying Data from an Excel File in Word using Word VBA", "body": "<p>Can someone please help with a simple code to import data from an Excel file into a word document using Word VBA?</p>\n"}, {"tags": ["javascript", "vba", "forms", "ms-access", "pdf"], "answers": [{"comments": [{"owner": {"reputation": 48, "user_id": 4027761, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/06f0681b65594ab2469649fb26861ad6?s=128&d=identicon&r=PG&f=1", "display_name": "JCBWS", "link": "https://stackoverflow.com/users/4027761/jcbws"}, "edited": false, "score": 0, "creation_date": 1443031044, "post_id": 32742284, "comment_id": 53333361, "body": "Okay, but would I then generate a fillable pdf form using this pdf and the Adobe Acrobat object? The pdf exportation isn&#39;t what&#39;s getting me, the unknown for me is the pdf form creation from VBA."}], "tags": [], "owner": {"reputation": 1440, "user_id": 3122786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Byyve.png?s=128&g=1", "display_name": "J&#233;r&#244;me Teisseire", "link": "https://stackoverflow.com/users/3122786/j%c3%a9r%c3%b4me-teisseire"}, "is_accepted": false, "score": 0, "last_activity_date": 1443018360, "creation_date": 1443018360, "answer_id": 32742284, "question_id": 32738691, "link": "https://stackoverflow.com/questions/32738691/access-2007-export-report-to-auto-generated-pdf-form/32742284#32742284", "title": "Access 2007 Export Report to Auto-Generated PDF Form", "body": "<p>You could create a msAccess Report and export it to Pdf with:</p>\n\n<pre><code>DoCmd.OutputTo\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff192065.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff192065.aspx</a></p>\n\n<p>an example:</p>\n\n<pre><code>Dim fso, strTempPath \nSet fso = CreateObject(\"Scripting.FileSystemObject\")\n\nstrTempPath = fso.GetSpecialFolder(2)  \nDoCmd.OutputTo acOutputReport, \"YOUR_MSACCESS_BWS_REPORT_NAME\", acFormatPDF, strTempPath &amp; \"\\YOUR_FILENAME.pdf\", False\n</code></pre>\n"}], "owner": {"reputation": 48, "user_id": 4027761, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/06f0681b65594ab2469649fb26861ad6?s=128&d=identicon&r=PG&f=1", "display_name": "JCBWS", "link": "https://stackoverflow.com/users/4027761/jcbws"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 263, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594459500, "creation_date": 1443008675, "last_edit_date": 1594459500, "question_id": 32738691, "link": "https://stackoverflow.com/questions/32738691/access-2007-export-report-to-auto-generated-pdf-form", "title": "Access 2007 Export Report to Auto-Generated PDF Form", "body": "<p>Basically, I would like to know if it's possible to do the following:</p>\n\n<ul>\n<li>Export Report to PDF</li>\n<li>Create Adobe Acrobat object for creating fillable PDF Forms</li>\n<li>Go through PDF, placing fields over prices</li>\n<li>Create calculated fields in certain locations (adding/dividing other fields on PDF Form)</li>\n<li>Allow for recipient to insert logos into PDF Form</li>\n<li>Save PDF Form</li>\n<li>Notify Access end user that export to PDF Form was a failure/success</li>\n</ul>\n\n<p>Here's some snippets of the report I will be exporting to this PDF Form:</p>\n\n<p><a href=\"https://i.stack.imgur.com/RJbZI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RJbZI.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/HKb6G.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HKb6G.png\" alt=\"enter image description here\"></a></p>\n\n<p>Wherever you see a dotted line, the \"MSRP\" location (first page), discounts and other spots is where I would want plain fields. \"Total Options &amp; NPOs\", \"Gross Cost\" and such will be calculated fields, adding/dividing \"MSRP\" and dotted line plain fields.</p>\n\n<p>I'm already quite well-versed in VBA but not so much in JavaScript (which is what Acrobat uses when it comes to creating PDF Forms). Acrobat also has ODBC connectivity from what I've read thus far too on Adobe webpages.</p>\n\n<p>Is this too far-fetched of an idea, even with VBA/JavaScript and the appropriate Acrobat references?</p>\n\n<p>Like I said earlier, I'm not looking for complete code wrapped up in the nice, convenient package (since this is quite a custom feature), but if anyone can point me in the right direction... it will more than help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1, "user_id": 5334881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b8f59923481be92d7a8317b1f2a6c4?s=128&d=identicon&r=PG&f=1", "display_name": "arjun", "link": "https://stackoverflow.com/users/5334881/arjun"}, "reply_to_user": {"reputation": 1672, "user_id": 5218921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Iy0g.jpg?s=128&g=1", "display_name": "al&#39;ein", "link": "https://stackoverflow.com/users/5218921/alein"}, "edited": false, "score": 1, "creation_date": 1443011557, "post_id": 32738633, "comment_id": 53319918, "body": "HI Alan,i have tried some basic things using Excel like concatenating the 2 cells and running count if and using sumproduct function in excel but in any extra or some part of info is missing in 1 or the other  field the above things are not working so i am looking for other ways to find the duplicates."}, {"owner": {"reputation": 16968, "user_id": 1919583, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/35a12f323e0bea76c8b442df11825d57?s=128&d=identicon&r=PG", "display_name": "Reeza", "link": "https://stackoverflow.com/users/1919583/reeza"}, "edited": false, "score": 0, "creation_date": 1443026272, "post_id": 32738633, "comment_id": 53330785, "body": "You&#39;re looking for a fuzzy match solution and there isn&#39;t going to be one that&#39;s exact and 100% accurate.  There is a good solution for this on communities.sas.com via friedegg, but with the new system I&#39;m not sure how to find it, you may want to try searching on there."}, {"owner": {"reputation": 16968, "user_id": 1919583, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/35a12f323e0bea76c8b442df11825d57?s=128&d=identicon&r=PG", "display_name": "Reeza", "link": "https://stackoverflow.com/users/1919583/reeza"}, "edited": false, "score": 0, "creation_date": 1443026798, "post_id": 32738633, "comment_id": 53331031, "body": "<a href=\"https://communities.sas.com/t5/SAS-Procedures/Fuzzy-match-using-a-string-variable-between-two-large-datasets/m-p/208283/highlight/true#M51636\" rel=\"nofollow noreferrer\">communities.sas.com/t5/SAS-Procedures/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5334881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b8f59923481be92d7a8317b1f2a6c4?s=128&d=identicon&r=PG&f=1", "display_name": "arjun", "link": "https://stackoverflow.com/users/5334881/arjun"}, "edited": false, "score": 0, "creation_date": 1443012022, "post_id": 32739462, "comment_id": 53320253, "body": "thanks for the help.But in above example output s.no 11,13 are actually duplicates if we run this i think we cant able to identify those 2 and it returns as 2 unique records.i looking for a solution like if any extra or some part of info is missing also it should identify is there a way to identify these. please help me to identify a way to fix this kind of data."}], "tags": [], "owner": {"reputation": 97, "user_id": 5090223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/826d80d302df4f632731505ee525e9a4?s=128&d=identicon&r=PG&f=1", "display_name": "Pudding", "link": "https://stackoverflow.com/users/5090223/pudding"}, "is_accepted": false, "score": -1, "last_activity_date": 1443010876, "creation_date": 1443010876, "answer_id": 32739462, "question_id": 32738633, "link": "https://stackoverflow.com/questions/32738633/compare-the-data-of-a-single-field-with-all-fields-in-a-table/32739462#32739462", "title": "Compare the data of a single field with all fields in a table", "body": "<p>here is some code that might be able to do what you want. Beware that the code is case sensetive. Hope that helps :)</p>\n\n<pre><code>Sub testDuplicate()\nlastrow = WorksheetFunction.CountA(Range(\"A:A\"))\nFor j = 1 To lastrow\n    For i = 1 To lastrow\n        If j = i Then\n            'Do nothing\n        ElseIf Cells(i, 1) = Cells(j, 1) Then\n          Cells(j, 2).Value = \"Duplicate\"\n          Exit For\n        Else\n          Cells(j, 2) = \"Unique\"\n     End If\n    Next i\nNext j\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5334881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b8f59923481be92d7a8317b1f2a6c4?s=128&d=identicon&r=PG&f=1", "display_name": "arjun", "link": "https://stackoverflow.com/users/5334881/arjun"}, "edited": false, "score": 0, "creation_date": 1443018290, "post_id": 32741063, "comment_id": 53325220, "body": "Thanks Stu, i will try this."}], "tags": [], "owner": {"reputation": 5054, "user_id": 5342700, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bKoDb.png?s=128&g=1", "display_name": "Stu Sztukowski", "link": "https://stackoverflow.com/users/5342700/stu-sztukowski"}, "is_accepted": false, "score": -1, "last_activity_date": 1443016584, "last_edit_date": 1443016584, "creation_date": 1443015161, "answer_id": 32741063, "question_id": 32738633, "link": "https://stackoverflow.com/questions/32738633/compare-the-data-of-a-single-field-with-all-fields-in-a-table/32741063#32741063", "title": "Compare the data of a single field with all fields in a table", "body": "<p>You're going to want to clean the data first. For example, Canadian Corps of Commissionaires has two ways that it is spelled. You might want to try creating a new column that is the first 2 or 3 words of the account name, and use an <code>upcase</code> or <code>lowcase</code> function to make it case-insensitive. Then you can easily find duplicates from the new column.  </p>\n\n<p>Since you tagged SAS, here is a possible SAS-based solution:</p>\n\n<p><strong>Step 1: Get the first 2 words for each Account Name and make it case-insensitive</strong></p>\n\n<pre><code>data have2;\n     length Account_Name2 $20.;\n     set have;\n\n     word_length = countw(Account_Name);\n     if(word_length &gt; 2) then Account_Name2 = upcase(catx(' ', scan(Account_Name, 1), scan(Account_Name, 2) ) );\n         else Account_Name2 = upcase(Account_Name);\n\n     drop word_length;\nrun;\n</code></pre>\n\n<p><strong>Step 2: Sort the data by <code>account_name2</code> and save duplicates to a new dataset</strong></p>\n\n<pre><code>proc sort data=have2\n          out=_TMP_\n          nodupkey\n          dupout=dupes;\n     by account_name2;\nrun;\n</code></pre>\n\n<p>Note that the <code>_TMP_</code> dataset is simply there to prevent overwriting the <code>have2</code> table.</p>\n\n<p><strong>Step 3: Merge <code>dupout</code> into the cleaned table <code>have2</code> by <code>account_name2</code>, then flag duplicates</strong></p>\n\n<pre><code>proc sort data=have2;\n     by account_name2;\nrun;\n\ndata want;\n     merge have2\n           dupes(in=duprecs keep=account_name2);\n     by account_name2;\n\n     Dupe_Flag = (duprecs);\n\n     drop account_name2;\nrun;\n</code></pre>\n\n<p>I hope this helps!</p>\n"}], "owner": {"reputation": 1, "user_id": 5334881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b8f59923481be92d7a8317b1f2a6c4?s=128&d=identicon&r=PG&f=1", "display_name": "arjun", "link": "https://stackoverflow.com/users/5334881/arjun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 2, "score": -6, "last_activity_date": 1443551201, "creation_date": 1443008534, "last_edit_date": 1443551201, "question_id": 32738633, "link": "https://stackoverflow.com/questions/32738633/compare-the-data-of-a-single-field-with-all-fields-in-a-table", "title": "Compare the data of a single field with all fields in a table", "body": "<p>I have data in Excel like below shown, here I am looking for duplicates identification or batch kind.</p>\n\n<p><a href=\"https://i.stack.imgur.com/zOI6l.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zOI6l.png\" alt=\"enter image description here\"></a></p>\n\n<p>How do I identify this kind of data (in VB macro or another way)?</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1443186950, "post_id": 32737757, "comment_id": 53404741, "body": "Perhaps it is a delegate issue. <a href=\"https://support.office.com/en-us/article/Allow-someone-else-to-manage-your-mail-and-calendar-41c40c04-3bd1-4d22-963a-28eafec25926\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1443014058, "creation_date": 1443014058, "answer_id": 32740598, "question_id": 32737757, "link": "https://stackoverflow.com/questions/32737757/prompt-for-password-when-sending/32740598#32740598", "title": "Prompt for password when sending", "body": "<p>You can develop a VBA macro where you can handle the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff865076.aspx\" rel=\"nofollow\">ItemSend</a> event of the Application class which is fired whenever an Microsoft Outlook item is sent, either by the user through an Inspector (before the inspector is closed, but after the user clicks the Send button) or when the Send method for an Outlook item, such as MailItem, is used in a program. </p>\n\n<p>For example:</p>\n\n<pre><code>Public WithEvents myOlApp As Outlook.Application \n\nPublic Sub Initialize_handler() \n Set myOlApp = Outlook.Application \nEnd Sub \n\nPrivate Sub myOlApp_ItemSend(ByVal Item As Object, Cancel As Boolean) \n Dim prompt As String \n prompt = \"Are you sure you want to send \" &amp; Item.Subject &amp; \"?\" \n If MsgBox(prompt, vbYesNo + vbQuestion, \"Sample\") = vbNo Then \n  Cancel = True \n End If \nEnd Sub\n</code></pre>\n\n<p>You may find the <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736%28v=office.14%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Getting Started with VBA in Outlook 2010</a> article helpful. </p>\n"}, {"tags": [], "owner": {"reputation": 16, "user_id": 5915032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ePal5.jpg?s=128&g=1", "display_name": "Pritam Priyadarshi Sahu", "link": "https://stackoverflow.com/users/5915032/pritam-priyadarshi-sahu"}, "is_accepted": true, "score": 0, "last_activity_date": 1455214213, "last_edit_date": 1455214213, "creation_date": 1455213487, "answer_id": 35346684, "question_id": 32737757, "link": "https://stackoverflow.com/questions/32737757/prompt-for-password-when-sending/35346684#35346684", "title": "Prompt for password when sending", "body": "<p>Please use the below code:</p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n prompt$ = \"Enter Password to Send Mail\"\n\nDim pass As String\n    pass = InputBox(\"Enter Password\")\nIf pass &lt;&gt; \"yourpwd\" Then\nCancel = True\n End If\nEnd Sub\n</code></pre>\n\n<p>Its tested and its working fine.</p>\n\n<p>make sure you have enabled macro from trust centre.</p>\n"}], "owner": {"reputation": 5, "user_id": 4582559, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152718731209366/picture?type=large", "display_name": "Rhys Pickett", "link": "https://stackoverflow.com/users/4582559/rhys-pickett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1385, "favorite_count": 0, "accepted_answer_id": 35346684, "answer_count": 2, "score": 0, "last_activity_date": 1455214213, "creation_date": 1443005944, "last_edit_date": 1443139486, "question_id": 32737757, "link": "https://stackoverflow.com/questions/32737757/prompt-for-password-when-sending", "title": "Prompt for password when sending", "body": "<p>I want Outlook to prompt for a password or some sort of authentication on all outgoing mail items, because someone keeps sending on behalf on my account.</p>\n\n<p>I have written:</p>\n\n<pre><code>If Omail.SendUsingAccount = \"My Domain Email account typed here\" Then\n\n    Sub password()\n    Dim pass As String\n    pass = InputBox(\"Enter Password\")\n    If pass &lt;&gt; \"thepassword\" Then Exit Sub\n\nEnd Sub\n</code></pre>\n\n<p>This doesn't work. After I have the correct code can I then just insert that into a custom action rule?</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "is_accepted": true, "score": 12, "last_activity_date": 1443009383, "last_edit_date": 1495540484, "creation_date": 1443003546, "answer_id": 32736916, "question_id": 32736915, "link": "https://stackoverflow.com/questions/32736915/how-to-clear-office-clipboard-with-vba/32736916#32736916", "title": "How to Clear Office Clipboard with VBA", "body": "<p>Saw this on another post, and I have tested it with Word VBA.</p>\n\n<pre><code>'Clearing the Office Clipboard\n\n    Dim oData   As New DataObject 'object to use the clipboard\n\n    oData.SetText text:=Empty 'Clear\n    oData.PutInClipboard 'take in the clipboard to empty it\n</code></pre>\n\n<p>Just copy and paste into your code where ever you need to clear the Clipboard.</p>\n\n<p>Another thing I noticed is that when I <code>.Quit</code> a program, say Excel, it keeps asking me if I want to keep the data is the Clipboard. A work around is to clear the clipboard using the above stated code. See below:</p>\n\n<pre><code>'Clearing the Office Clipboard\n\n    Dim oData   As New DataObject 'object to use the clipboard\n\n    oData.SetText text:=Empty 'Clear\n    oData.PutInClipboard 'take in the clipboard to empty it\n\n\n'You can also just remove the Alert Messages from the Excel Program while    \n'the code is running\n'Remove alert Messages from the Excel Program when closing\nExcelProgram.DisplayAlerts = False   \n\n'Quiting the Excel Application\nExcelProgram.Quit\n</code></pre>\n\n<p>I used the above example in a VBA code to import data from an Excel File. See <a href=\"https://stackoverflow.com/questions/32738849/copying-data-from-an-excel-file-in-word-using-word-vba\" title=\"Link to Another Post for the Excel Data importing\">here</a></p>\n"}, {"comments": [{"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1443008251, "post_id": 32738124, "comment_id": 53317628, "body": "Thanks for that, the <code>DisplayAlerts</code> property worked great for blocking the Alert from Excel. I think for use of importing data from Excel repeatedly, it will be beneficial to clear the Clipboard at the end of each <code>Loop</code>"}, {"owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "reply_to_user": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1443008910, "post_id": 32738124, "comment_id": 53318118, "body": "Just to confirm; that property is available within Word as well.  I&#39;ve not checked how Word&#39;s enumeration values compare with Excel&#39;s for that property."}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1443009236, "post_id": 32738124, "comment_id": 53318327, "body": "I used the <code>DisplayAlerts</code> in Word and Excel and the debugger was happy, so I believe it will be fine. In Word will use <code>Application.DisplayAlerts</code> and for the Active Excel Program which was Opened it is the same as what is displayed above"}], "tags": [], "owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "is_accepted": false, "score": 1, "last_activity_date": 1443007027, "creation_date": 1443007027, "answer_id": 32738124, "question_id": 32736915, "link": "https://stackoverflow.com/questions/32736915/how-to-clear-office-clipboard-with-vba/32738124#32738124", "title": "How to Clear Office Clipboard with VBA", "body": "<p>This functionality is held within the library \"Microsoft Forms 2.0 Object Library\".  To link to that library go to the VBA editor, then Tools, References and pick it out from the list if it's not already ticked.</p>\n\n<p>You can do more funky stuff with a bunch of WinAPI calls, but I generally prefer avoiding those unless absolutely necessary.</p>\n\n<p>Also, don't forget about the DisplayAlerts property, which will suppress dialog boxes - although I'm not sure if it would always produce the desired result.</p>\n"}, {"comments": [{"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 2, "creation_date": 1443013603, "post_id": 32740184, "comment_id": 53321496, "body": "Thanks I have seen that before, but never tried it. It does works for my application as well. It basically removes the CutCopy function which will automatically remove the clipboard data."}, {"owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "edited": false, "score": 1, "creation_date": 1510021171, "post_id": 32740184, "comment_id": 81247862, "body": "I like this solution since it doesn&#39;t require adding a reference to an object library."}, {"owner": {"reputation": 134, "user_id": 10986879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ELEICvXMOBY/AAAAAAAAAAI/AAAAAAAAAZg/k3_D_aVqziU/photo.jpg?sz=128", "display_name": "Alex M", "link": "https://stackoverflow.com/users/10986879/alex-m"}, "edited": false, "score": 1, "creation_date": 1568414709, "post_id": 32740184, "comment_id": 102279463, "body": "Worth noting that this only clears the Excel clipboard. If you have anything else in your clipboard this has no effect. Fine for the question, but Google serves me this question when I&#39;m looking for a way to clear the clipboard in a macro, for which I need to truly clear the clipboard - and this top-voted answer for MY question doesn&#39;t actually help me."}], "tags": [], "owner": {"reputation": 432, "user_id": 3438477, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/P1IZ0.jpg?s=128&g=1", "display_name": "jtchase08", "link": "https://stackoverflow.com/users/3438477/jtchase08"}, "is_accepted": false, "score": 16, "last_activity_date": 1443013754, "last_edit_date": 1443013754, "creation_date": 1443012838, "answer_id": 32740184, "question_id": 32736915, "link": "https://stackoverflow.com/questions/32736915/how-to-clear-office-clipboard-with-vba/32740184#32740184", "title": "How to Clear Office Clipboard with VBA", "body": "<p>Would a simple</p>\n\n<pre><code>Application.CutCopyMode = False\n</code></pre>\n\n<p>work for your situation, or is this option not viable?</p>\n"}, {"comments": [{"owner": {"reputation": 164, "user_id": 2577529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3lCwg.jpg?s=128&g=1", "display_name": "iamstrained", "link": "https://stackoverflow.com/users/2577529/iamstrained"}, "edited": false, "score": 2, "creation_date": 1583518045, "post_id": 47276755, "comment_id": 107157068, "body": "Years later, but if anyone is hunting for how to do this in Office 365 under 64-Bit, you now need to use the modifications for backwards compatibility to make this work:  Private Declare PtrSafe  and LongPtr as your two changes to these values will resolve issues and allow it to still work."}], "tags": [], "owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "is_accepted": false, "score": 3, "last_activity_date": 1560907821, "last_edit_date": 1560907821, "creation_date": 1510626660, "answer_id": 47276755, "question_id": 32736915, "link": "https://stackoverflow.com/questions/32736915/how-to-clear-office-clipboard-with-vba/47276755#47276755", "title": "How to Clear Office Clipboard with VBA", "body": "<p>Here's a solution that worked for me.  This is based on a post by by Zack Barresse on <a href=\"http://www.vbaexpress.com/kb/getarticle.php?kb_id=205\" rel=\"nofollow noreferrer\" title=\"VBAexpress.com\">VBAexpress.com</a>:</p>\n\n<pre><code>Public Declare Function OpenClipboard Lib \"user32\" (ByVal hwnd As Long) As Long\nPublic Declare Function EmptyClipboard Lib \"user32\" () As Long\nPublic Declare Function CloseClipboard Lib \"user32\" () As Long\n\nPublic Sub ClearClipboard()\n    OpenClipboard (0&amp;)\n    EmptyClipboard\n    CloseClipboard\nEnd Sub\n</code></pre>\n\n<p>After copying this function to your VBA project, use <code>ClearClipboard</code> to clear it.</p>\n"}], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59576, "favorite_count": 5, "accepted_answer_id": 32736916, "answer_count": 4, "score": 7, "last_activity_date": 1562854619, "creation_date": 1443003546, "last_edit_date": 1443013341, "question_id": 32736915, "link": "https://stackoverflow.com/questions/32736915/how-to-clear-office-clipboard-with-vba", "title": "How to Clear Office Clipboard with VBA", "body": "<p>How would you clear the Microsoft Office Clipboard using VBA, specifically Word VBA?</p>\n\n<p>I am copying a lot of data at time into the clipboard and don't want excessive data kept in the Clipboard.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1443004741, "post_id": 32736787, "comment_id": 53315236, "body": "Find the maximum length of the strings, as well as maximum size of both sides, for example 30, and 20:10 and you can use <code>Split(Cells(i, j), &quot;:&quot;)</code>, then insert spaces before left side similar to: <code>Space(Len(Cells(i, j))-MaxLeft) &amp; Split(0) &amp; &quot; : &quot; &amp; Split(1) &amp; (Space(Len(Cells(i, j),MaxRight)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1443021998, "post_id": 32739048, "comment_id": 53328027, "body": "Very concise +1. If the initial string appears as &quot;54,585,889:2.0%&quot; I&#39;d add <code>=SUBSTITUTE(REPT(&quot; &quot;,15-FIND(&quot;:&quot;,A1))&amp;A1,&quot;:&quot;, &quot; : &quot;)</code>"}], "tags": [], "owner": {"reputation": 306, "user_id": 3322809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gsQgs.jpg?s=128&g=1", "display_name": "Alex Frolov", "link": "https://stackoverflow.com/users/3322809/alex-frolov"}, "is_accepted": true, "score": 2, "last_activity_date": 1443009682, "creation_date": 1443009682, "answer_id": 32739048, "question_id": 32736787, "link": "https://stackoverflow.com/questions/32736787/align-cells-by-separator/32739048#32739048", "title": "Align cells by separator", "body": "<p>Please create the helper column with the following formula </p>\n\n<p><code>=REPT(\" \",15-FIND(\":\",A1))&amp;A1</code></p>\n\n<p>where <code>A1</code> - your original string and 15 - the maximal number of characters before \":\" in your data</p>\n\n<p>Then apply the monotype font (e.g. \"Courier new\") to this column.</p>\n"}], "owner": {"reputation": 341, "user_id": 4482489, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a80c20ce422aee723969d5df1654b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "siwmas", "link": "https://stackoverflow.com/users/4482489/siwmas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 32739048, "answer_count": 1, "score": 0, "last_activity_date": 1443014378, "creation_date": 1443003177, "last_edit_date": 1531161705, "question_id": 32736787, "link": "https://stackoverflow.com/questions/32736787/align-cells-by-separator", "title": "Align cells by separator", "body": "<p>I need to align cells by \":\" </p>\n\n<p>For example</p>\n\n<pre><code> 54,585,889 : 2.0%\n  4,585,887 :   \n    585,889 : 32.0%\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1443003909, "post_id": 32736429, "comment_id": 53314682, "body": "What is categoryPoint, and if it&#39;s a variable what value does it have when the error is thrown? Also, you should fully qualify the <code>Columns</code> as well: <code>Worksheets(&quot;Sheet1&quot;).Range(Worksheets(&quot;Sheet1&quot;).Columns(cate&zwnj;&#8203;goryPoint)).Advanced&zwnj;&#8203;Filter</code> in case your ActiveSheet is some other sheet"}, {"owner": {"reputation": 1, "user_id": 3121994, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/623836512/picture?type=large", "display_name": "Vivek Adi", "link": "https://stackoverflow.com/users/3121994/vivek-adi"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1443004418, "post_id": 32736429, "comment_id": 53315001, "body": "The variable holds the value 28. nothing wrong with variable value. Tried fully qualifying as well same error. categoryPoint is an integer Dim"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 3121994, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/623836512/picture?type=large", "display_name": "Vivek Adi", "link": "https://stackoverflow.com/users/3121994/vivek-adi"}, "edited": false, "score": 0, "creation_date": 1443006272, "post_id": 32737567, "comment_id": 53316273, "body": ":( The extract range has a missing or invalid field name it says. Just been stuck on this for so long now"}, {"owner": {"reputation": 1, "user_id": 3121994, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/623836512/picture?type=large", "display_name": "Vivek Adi", "link": "https://stackoverflow.com/users/3121994/vivek-adi"}, "edited": false, "score": 0, "creation_date": 1443007118, "post_id": 32737567, "comment_id": 53316815, "body": "Yes i did! your code worked fine! thanks! now it&#39;s time to assign it to an array!"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 1, "user_id": 3121994, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/623836512/picture?type=large", "display_name": "Vivek Adi", "link": "https://stackoverflow.com/users/3121994/vivek-adi"}, "edited": false, "score": 0, "creation_date": 1443007346, "post_id": 32737567, "comment_id": 53316968, "body": "Glad it works. Please mark the answer as a reference for others"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1443005320, "creation_date": 1443005320, "answer_id": 32737567, "question_id": 32736429, "link": "https://stackoverflow.com/questions/32736429/filter-and-copy-using-column-index/32737567#32737567", "title": "Filter and copy using column index", "body": "<p>Use the following syntax (tested):</p>\n\n<pre><code>Dim categoryPoint As Long\n\ncategoryPoint = 28\n\nWorksheets(\"Sheet1\").UsedRange.Columns(categoryPoint).AdvancedFilter _\n    Action:=xlFilterCopy, _\n    CopyToRange:=Worksheets(\"Sheet5\").Range(\"C2\"), _\n    Unique:=True\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 3121994, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/623836512/picture?type=large", "display_name": "Vivek Adi", "link": "https://stackoverflow.com/users/3121994/vivek-adi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443015769, "creation_date": 1443002262, "last_edit_date": 1443015769, "question_id": 32736429, "link": "https://stackoverflow.com/questions/32736429/filter-and-copy-using-column-index", "title": "Filter and copy using column index", "body": "<p>I'm trying to pick a column in an Excel sheet based on the column index(categoryPoint). I'm then trying to run an advanced filter on this column to select the unique values and copy it into a new sheet using this code:</p>\n\n<pre><code>Worksheets(\"Sheet1\").Range(Columns(categoryPoint)).AdvancedFilter _\n    Action:=xlFilterCopy, _\n    CopyToRange:=Worksheets(\"Sheet5\").Range(\"C2\"), _\n    Unique:=True\n</code></pre>\n\n<p>It says object or application defined error.</p>\n"}, {"tags": ["regex", "ms-access", "vba"], "comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1443001468, "post_id": 32736101, "comment_id": 53313023, "body": "<code>textOrders</code> is declared as a string, but <code>RegEx.Execute</code> will return a match object."}, {"owner": {"reputation": 95, "user_id": 4424653, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/898745db43f87866633afe97c01dbae7?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4424653/david"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1443001678, "post_id": 32736101, "comment_id": 53313153, "body": "@stribizhev so how do I access the match object to get the blocks of text out the file? I know I may have to change the pattern It works in  <a href=\"https://regex101.com/\" rel=\"nofollow noreferrer\">https://regex101.com/</a> but cant seem to use it in VBA"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1443002419, "post_id": 32736101, "comment_id": 53313682, "body": "Please have a look at <a href=\"http://stackoverflow.com/questions/32586057/split-string-on-single-forward-slashes-with-regexp/32588080#32588080\">this answer of mine for <i>Split string on single forward slashes with RegExp</i> post</a>. You can find <code>GetMatches</code> function that should meet your needs. If not, please let me know."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1443003094, "post_id": 32736101, "comment_id": 53314173, "body": "If that solution does not solve the issue you are having, I will reopen the question."}, {"owner": {"reputation": 95, "user_id": 4424653, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/898745db43f87866633afe97c01dbae7?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4424653/david"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1443010343, "post_id": 32736101, "comment_id": 53319030, "body": "@stribizhev hi your example just confused me even more, please can you open question back up cheers"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1443010428, "post_id": 32736101, "comment_id": 53319092, "body": "Only after you try my code and post what did not work for you (what errors you get)."}, {"owner": {"reputation": 95, "user_id": 4424653, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/898745db43f87866633afe97c01dbae7?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4424653/david"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1443011518, "post_id": 32736101, "comment_id": 53319899, "body": "@stribizhev I first had to change the <code>r_item</code>  to <code>rMatch</code> as VBA doesn&#39;t recognise this. I changed your answer to try and reflect what I am trying to do and still nothing."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1443011964, "post_id": 32736101, "comment_id": 53320215, "body": "Please post a sample input string and expected output. Without it, it is impossible to help you."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1443012726, "post_id": 32736101, "comment_id": 53320801, "body": "Try <code>ORDER NUMBER\\s*:\\s*\\S+\\s*Ship Date:\\s*\\S+\\s*Style Desc : .+\\s*Linecode\\s*: .+\\s*Qty\\s*.+</code> regex."}, {"owner": {"reputation": 95, "user_id": 4424653, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/898745db43f87866633afe97c01dbae7?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4424653/david"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1443014034, "post_id": 32736101, "comment_id": 53321842, "body": "@stribizhev Hi that works but only finds 1 match when should find 9, <a href=\"https://regex101.com\" rel=\"nofollow noreferrer\">https://regex101.com</a> it says add g modifier to get the global matches how do I do that in your example?"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 4424653, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/898745db43f87866633afe97c01dbae7?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4424653/david"}, "edited": false, "score": 0, "creation_date": 1443015609, "post_id": 32740956, "comment_id": 53323141, "body": "I still get error &quot;variable not defined&quot; on <code>r_Item</code>"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 95, "user_id": 4424653, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/898745db43f87866633afe97c01dbae7?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4424653/david"}, "edited": false, "score": 0, "creation_date": 1443015757, "post_id": 32740956, "comment_id": 53323255, "body": "Declare it: <code>Dim r_item As Object</code>."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 95, "user_id": 4424653, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/898745db43f87866633afe97c01dbae7?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4424653/david"}, "edited": false, "score": 0, "creation_date": 1443017417, "post_id": 32740956, "comment_id": 53324557, "body": "I mean, if you have <code>Option Explicit</code> defined, you need to declare each variable in your VBA code."}], "tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": false, "score": 0, "last_activity_date": 1443017485, "last_edit_date": 1443017485, "creation_date": 1443014945, "answer_id": 32740956, "question_id": 32736101, "link": "https://stackoverflow.com/questions/32736101/using-regexp-in-access-vba/32740956#32740956", "title": "Using RegExp in Access VBA", "body": "<p>I think there might be an issue with the regex where the number of newlines (and their type) may not be as expected (<code>\\r\\n</code> or just <code>\\n</code>?). I think it is safer to switch to just <code>\\s*</code> that will match any optional whitespace.</p>\n\n<p>The regex will look like</p>\n\n<pre><code>ORDER NUMBER\\s*:\\s*\\S+\\s*Ship Date:\\s*\\S+\\s*Style Desc : .+\\s*Linecode\\s*: .+\\s*Qty\\s*.+\n</code></pre>\n\n<p>See the <a href=\"https://regex101.com/r/uX9tH5/1\" rel=\"nofollow noreferrer\">regex demo</a></p>\n\n<p>Here is the code that works:</p>\n\n<p>The  sub that collects all matches:</p>\n\n<pre><code>Sub GetMatches2(ByRef str As String, ByRef coll As collection)\n\nDim rExp As Object, rMatch As Object, r_item As Object\n\nSet rExp = CreateObject(\"vbscript.regexp\")\nWith rExp\n    .Global = True\n    .MultiLine = False\n    .IgnoreCase = True\n    .pattern = \"ORDER NUMBER\\s*:\\s*\\S+\\s*Ship Date:\\s*\\S+\\s*Style Desc : .+\\s*Linecode\\s*: .+\\s*Qty\\s*.+\"\nEnd With\n\nSet rMatch = rExp.Execute(str)\nIf rMatch.Count &gt; 0 Then\n    For Each r_item In rMatch\n        coll.Add r_item.Value\n    Next r_item\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>And the main sub where the string is passed to <code>GetMatches2</code>:</p>\n\n<pre><code>Sub ProcessStr()\nDim s As String\ns = \"Purchase Order Supplier Copy                                                                   Printed Date: 18/08/2015 3.32 PM              Page 1 of         15\" &amp; vbCrLf &amp; vbCrLf &amp; \"  ORDER DETAILS                                                    INVOICE ADDRESS             SHIPMENT &amp; PAYMENT TERMS   STYLE DETAILS\" &amp; vbCrLf &amp; \"\" &amp; vbCrLf &amp; \" DATE: 18-AUG-15                        ORDER NUMBERS:             Purchase Ledger             COM:CHINA                            STYLE DESCRIPTION             SUPPLIER STYLE REF    LINECODE\" &amp; vbCrLf &amp; \" ORDER TYPE: Standard                   M0773175   M0773177        Retail Ltd              COO:UK\" &amp; vbCrLf &amp; \" SEASON: S16                            M0773180   M0773183        Perimeter Road              Port:UK                              BLACKOUT CURTAINS CR 46X54    HRW14CT001            M878966\" &amp; vbCrLf &amp; _\n\" DIVISION: HOMEWARE                     M0773186   M0773189        Knowsley Industrial Park    Factory:                             BLACKOUT CURTAINS CR 66X72    HRW14CT001            M878967\" &amp; vbCrLf &amp; \" DEPT: HOME FURNISHINGS                 M0773192   M0773195        Liverpool                   Buying Terms:                        BLACKOUT CURTAINS CR 90X90    HRW14CT001            M878972\" &amp; vbCrLf &amp; \" BUYER: Harpal Rai-Hilton               M0773198                   United Kingdom              Payment Terms:ENDMONTH           BLACKOUT CURTAINS GR 46X54    HRW14CT001            M878974\" &amp; vbCrLf &amp; \" SUPPLIER:                                         L33 7SZ                     Shipping Method:LAND                 BLACKOUT CURTAINS GR 66X72    HRW14CT001            M878975\" &amp; vbCrLf &amp; \" AGENT: 9999 N/A                                                   0151                        Pack Desc:Solid Boxed                BLACKOUT CURTAINS GR 90X90    HRW14CT001            M878976\" &amp; _\n          vbCrLf &amp; \"                                                                              Currency:STERL\" &amp; vbCrLf &amp; _\n\"                                                                                                                                    BLACKOUT CURTAINS BG 46X54    HRW14CT001            M878977\" &amp; vbCrLf &amp; \"                                                                                               FOB value:5086.62\" &amp; vbCrLf &amp; \"                                                                                                                                    BLACKOUT CURTAINS BG 66X72    HRW14CT001            M878978\" &amp; vbCrLf &amp; \"                                                                                                                                    BLACKOUT CURTAINS BG 90X90    HRW14CT001            M878979\" &amp; vbCrLf &amp; vbCrLf &amp; _\n\"   PRODUCTION SUMMARY\" &amp; vbCrLf &amp; vbCrLf &amp; \"   GRAND TOTAL\" &amp; vbCrLf &amp; vbCrLf &amp; \"  ORDER NUMBER :   M0773175            Ship Date: 23-Nov-15\" &amp; vbCrLf &amp; vbCrLf &amp; \"  Style Desc : BLACKOUT CURTAINS CR 46X54\" &amp; vbCrLf &amp; \"  Linecode : M878966\" &amp; vbCrLf &amp; \"  Qty              36\" &amp; vbCrLf &amp; vbCrLf &amp; _\n\"  ORDER NUMBER :   M0773177            Ship Date: 23-Nov-15\" &amp; vbCrLf &amp; vbCrLf &amp; \"  Style Desc : BLACKOUT CURTAINS CR 66X72\" &amp; vbCrLf &amp; \"  Linecode : M878967\" &amp; vbCrLf &amp; \"  Qty              27\" &amp; vbCrLf &amp; vbCrLf &amp; \"  ORDER NUMBER :   M0773180            Ship Date: 23-Nov-15\" &amp; vbCrLf &amp; vbCrLf &amp; _\n\"  Style Desc : BLACKOUT CURTAINS CR 90X90\" &amp; vbCrLf &amp; \"  Linecode : M878972\" &amp; vbCrLf &amp; \"  Qty              38\" &amp; vbCrLf &amp; vbCrLf &amp; \"  ORDER NUMBER :   M0773183            Ship Date: 23-Nov-15\" &amp; vbCrLf &amp; vbCrLf &amp; \"  Style Desc : BLACKOUT CURTAINS GR 46X54\" &amp; vbCrLf &amp; \"  Linecode : M878974\" &amp; vbCrLf &amp; \"  Qty              30\" &amp; vbCrLf &amp; vbCrLf &amp; \"  ORDER NUMBER :   M0773186            Ship Date: 23-Nov-15\" &amp; vbCrLf &amp; vbCrLf &amp; \"  Style Desc : BLACKOUT CURTAINS GR 66X72\" &amp; vbCrLf &amp; _\n\"  Linecode : M878975\" &amp; vbCrLf &amp; \"  Qty              15\" &amp; vbCrLf &amp; vbCrLf &amp; \"  ORDER NUMBER :   M0773189            Ship Date: 23-Nov-15\" &amp; vbCrLf &amp; vbCrLf &amp; \"  Style Desc : BLACKOUT CURTAINS GR 90X90\" &amp; vbCrLf &amp; \"  Linecode : M878976\" &amp; vbCrLf &amp; \"  Qty              60\" &amp; vbCrLf &amp; vbCrLf &amp; \"  ORDER NUMBER :   M0773192            Ship Date: 23-Nov-15\" &amp; vbCrLf &amp; vbCrLf &amp; _\n\"  Style Desc : BLACKOUT CURTAINS BG 46X54\" &amp; vbCrLf &amp; \"  Linecode : M878977\" &amp; vbCrLf &amp; \"  Qty              42\" &amp; vbCrLf &amp; vbCrLf &amp; \"  ORDER NUMBER :   M0773195            Ship Date: 23-Nov-15\" &amp; vbCrLf &amp; vbCrLf &amp; \"  Style Desc : BLACKOUT CURTAINS BG 66X72\" &amp; vbCrLf &amp; _\n\"  Linecode : M878978\" &amp; vbCrLf &amp; \"  Qty              21\" &amp; vbCrLf &amp; vbCrLf &amp; \"  ORDER NUMBER :   M0773198            Ship Date: 23-Nov-15\" &amp; vbCrLf &amp; vbCrLf &amp; \"  Style Desc : BLACKOUT CURTAINS BG 90X90\" &amp; vbCrLf &amp; _\n\"  Linecode : M878979\" &amp; vbCrLf &amp; \"  Qty              40\"\nDim matches As collection\n\nSet matches = New collection\nGetMatches2 str:=s, coll:=matches\n\nEnd Sub\n</code></pre>\n\n<p>Results:</p>\n\n<p><a href=\"https://i.stack.imgur.com/R1Yb6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/R1Yb6.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 95, "user_id": 4424653, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/898745db43f87866633afe97c01dbae7?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4424653/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1431, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594643609, "creation_date": 1443001337, "last_edit_date": 1594643609, "question_id": 32736101, "link": "https://stackoverflow.com/questions/32736101/using-regexp-in-access-vba", "title": "Using RegExp in Access VBA", "body": "<p>I cant seem to get the syntax right for using the <code>RegExp</code> function in VBA this is what I have, can anyone show me where I am going wrong or some examples of usage in VBA. I don't understand how I assign the matches found by RegExp into a <code>variable</code> or <code>array()</code>. I get an Error saying wrong number of arguments when it hits the RegEx.Execute</p>\n\n<pre><code>Dim RegEx As New RegExp\nDim textOrders As String\nDim RawText as String\n\nFileNum = FreeFile()\nOpen FileName For Input As #FileNum\nDo Until EOF(FileNum)\nInput #FileNum, ShortText\n\nRawText = RawText &amp; ShortText\n\nloop\n\nWith RegEx\n    .Global = True\n    .MultiLine = False\n    .IgnoreCase = True\n    .Pattern = (\"ORDER NUMBER :\\s+[^\\s]+\\s+Ship Date:\\s+[^\\s]+\\n\\n\\s+Style Desc : .+\\n\\s+Linecode : .+\\n\\s+Qty\\s+.+\")\n\nEnd With\n\ntextOrders = RegEx.Execute(RawText)  *This is where the error occurs*\n</code></pre>\n\n<p>I then tried this but still no luck</p>\n\n<pre><code>Sub GetMatches(ByRef Str As String, ByRef coll As Collection)\n\nDim rExp As Object, rMatch As Object\n\nSet rExp = CreateObject(\"vbscript.regexp\")\nWith rExp\n    .Global = True\n    .Pattern = \"ORDER NUMBER :\\s+[^\\s]+\\s+Ship Date:\\s+[^\\s]+\\n\\n\\s+Style Desc : .+\\n\\s+Linecode : .+\\n\\s+Qty\\s+.+\"\nEnd With\n\nSet rMatch = rExp.Execute(Str)\nIf rMatch.Count &gt; 0 Then\n    For Each rMatch In rMatch\n        coll.Add rMatch.Value\n        Debug.Print rMatch.Value\n    Next rMatch\nEnd If\nDebug.Print \"\"\nEnd Sub\n</code></pre>\n\n<p>I then tried this: in <code>JavaScript</code></p>\n\n<pre><code>Public Sub x()\n     Dim o As New ScriptControl\n\n     Dim OriginalText As String\n     Dim RegExPattern As String\n\n     OriginalText = \"\"\n\n     RegExPattern = \"\"\n     Str = \"ORDER NUMBER :   M0773175            Ship Date: 23-Nov-15\" &amp; _\n            \"Style Desc : BLACKOUT CURTAINS CR 46X54\" &amp; _\n            \"Linecode:        M878966\" &amp; _\n            \"Qty 36\"\n\n     o.Language = \"JScript\"\n     With o\n         .AddCode \"Function x() {return m(0);}\" &amp; _\n                    \"var str = Str;\" &amp; _\n                    \"var re = '/ORDER NUMBER :\\s+[^\\s]+\\s+Ship Date:\\s+[^\\s]+\\n\\n\\s+Style Desc : .+\\n\\s+Linecode : .+\\n\\s+Qty\\s+.+/g';\" &amp; _\n                    \"var m;\" &amp; _\n                    \"while ((m = re.exec(str)) !== null) {\" &amp; _\n                        \"if (m.index === re.lastIndex) {\" &amp; _\n                        \"re.lastIndex++;\" &amp; _\n                        \"};\" &amp; _\n                    \"};\"\n\n         Debug.Print .run(\"x\", 1, 2)\n     End With\n End Sub\n</code></pre>\n\n<p>Sample Text of pattern trying to find:</p>\n\n<pre><code>ORDER NUMBER :   M0773175            Ship Date: 23-Nov-15\n\n      Style Desc : BLACKOUT CURTAINS CR 46X54\n      Linecode : M85466\n      Qty              36\n</code></pre>\n\n<p>Sample of input text to search: it contains 9 orders but could contain 50 or 10 dynamic amount each time that's why trying to use regex</p>\n\n<pre><code>Purchase Order Supplier Copy                                                                   Printed Date: 18/08/2015 3.32 PM              Page 1 of         15\n\n  ORDER DETAILS                                                    INVOICE ADDRESS             SHIPMENT &amp; PAYMENT TERMS   STYLE DETAILS\n\n DATE: 18-AUG-15                        ORDER NUMBERS:             Purchase Ledger             COM:CHINA                            STYLE DESCRIPTION             SUPPLIER STYLE REF    LINECODE\n ORDER TYPE: Standard                   M0773175   M0773177        Retail Ltd              COO:UK\n SEASON: S16                            M0773180   M0773183        Perimeter Road              Port:UK                              BLACKOUT CURTAINS CR 46X54    HRW14CT001            M878966\n DIVISION: HOMEWARE                     M0773186   M0773189        Knowsley Industrial Park    Factory:                             BLACKOUT CURTAINS CR 66X72    HRW14CT001            M878967\n DEPT: HOME FURNISHINGS                 M0773192   M0773195        Liverpool                   Buying Terms:                        BLACKOUT CURTAINS CR 90X90    HRW14CT001            M878972\n BUYER: Harpal Rai-Hilton               M0773198                   United Kingdom              Payment Terms:ENDMONTH           BLACKOUT CURTAINS GR 46X54    HRW14CT001            M878974\n SUPPLIER:                                         L33 7SZ                     Shipping Method:LAND                 BLACKOUT CURTAINS GR 66X72    HRW14CT001            M878975\n AGENT: 9999 N/A                                                   0151                        Pack Desc:Solid Boxed                BLACKOUT CURTAINS GR 90X90    HRW14CT001            M878976\n                                                                                               Currency:STERL\n                                                                                                                                    BLACKOUT CURTAINS BG 46X54    HRW14CT001            M878977\n                                                                                               FOB value:5086.62\n                                                                                                                                    BLACKOUT CURTAINS BG 66X72    HRW14CT001            M878978\n                                                                                                                                    BLACKOUT CURTAINS BG 90X90    HRW14CT001            M878979\n\n   PRODUCTION SUMMARY\n\n   GRAND TOTAL\n\n  ORDER NUMBER :   M0773175            Ship Date: 23-Nov-15\n\n  Style Desc : BLACKOUT CURTAINS CR 46X54\n  Linecode : M878966\n  Qty              36\n\n  ORDER NUMBER :   M0773177            Ship Date: 23-Nov-15\n\n  Style Desc : BLACKOUT CURTAINS CR 66X72\n  Linecode : M878967\n  Qty              27\n\n  ORDER NUMBER :   M0773180            Ship Date: 23-Nov-15\n\n  Style Desc : BLACKOUT CURTAINS CR 90X90\n  Linecode : M878972\n  Qty              38\n\n  ORDER NUMBER :   M0773183            Ship Date: 23-Nov-15\n\n  Style Desc : BLACKOUT CURTAINS GR 46X54\n  Linecode : M878974\n  Qty              30\n\n  ORDER NUMBER :   M0773186            Ship Date: 23-Nov-15\n\n  Style Desc : BLACKOUT CURTAINS GR 66X72\n  Linecode : M878975\n  Qty              15\n\n  ORDER NUMBER :   M0773189            Ship Date: 23-Nov-15\n\n  Style Desc : BLACKOUT CURTAINS GR 90X90\n  Linecode : M878976\n  Qty              60\n\n  ORDER NUMBER :   M0773192            Ship Date: 23-Nov-15\n\n  Style Desc : BLACKOUT CURTAINS BG 46X54\n  Linecode : M878977\n  Qty              42\n\n  ORDER NUMBER :   M0773195            Ship Date: 23-Nov-15\n\n  Style Desc : BLACKOUT CURTAINS BG 66X72\n  Linecode : M878978\n  Qty              21\n\n  ORDER NUMBER :   M0773198            Ship Date: 23-Nov-15\n\n  Style Desc : BLACKOUT CURTAINS BG 90X90\n  Linecode : M878979\n  Qty              40\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1443001537, "post_id": 32735947, "comment_id": 53313081, "body": "Basically: <code>For each cell in master.range(&quot;h2:h1000&quot;).specialcells(xlcelltypevisible)</code>"}, {"owner": {"reputation": 143, "user_id": 5023141, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/73e4102f195847ce8cdd617c722fba4c?s=128&d=identicon&r=PG&f=1", "display_name": "Calum", "link": "https://stackoverflow.com/users/5023141/calum"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1443002027, "post_id": 32735947, "comment_id": 53313385, "body": "I&#39;ve tried something similar to this but it seems to crash my code, it just inputs one value in to every cell? Where should i be inserting this, at the moment i&#39;ve tried after the <code>For i = 1 to 1000</code>"}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1443003267, "creation_date": 1443003267, "answer_id": 32736810, "question_id": 32735947, "link": "https://stackoverflow.com/questions/32735947/use-filtered-rows-only-for-loop/32736810#32736810", "title": "Use filtered rows only for loop", "body": "<p>Replace this:</p>\n\n<pre><code>For j = 1 To 1000 '(the master sheet)\n</code></pre>\n\n<p>with this:</p>\n\n<pre><code>For each cell in master.range(\"h2:h1000\").specialcells(xlcelltypevisible)\nj = cell.row\n</code></pre>\n\n<p>and add</p>\n\n<pre><code>Dim cell as Range\n</code></pre>\n\n<p>to the top of the code.</p>\n"}, {"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 1, "last_activity_date": 1443003312, "creation_date": 1443003312, "answer_id": 32736829, "question_id": 32735947, "link": "https://stackoverflow.com/questions/32735947/use-filtered-rows-only-for-loop/32736829#32736829", "title": "Use filtered rows only for loop", "body": "<p>You can exclude the filtered rows by checking RowHeight property (0 or not):</p>\n\n<pre><code>If Master.Cells(j, 3).RowHeight = 0 Then\n</code></pre>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub noName()\n    Dim lngLastRow As Long\n    Dim fpath As String\n    Dim owb As Workbook\n    Dim Master As Worksheet 'declare both\n    Dim Slave As Worksheet\n    Dim i As Long, j As Long\n\n    Worksheets(\"SHLAA\").Activate\n    Worksheets(\"SHLAA\").Select\n\n    Set Master = ThisWorkbook.Worksheets(\"Allsites\") 'sheet from workbook im in\n    Set Slave = ThisWorkbook.Worksheets(\"SHLAA\") 'sheet in workbook im copying too\n\n    lngLastRow = Slave.Cells.Find(\"*\", searchorder:=xlByRows, searchdirection:=xlPrevious).Row + 1\n    For j = 1 To 1000 '(the master sheet)\n        For i = 1 To 1000 '(the slave sheet) 'for first 1000 cells\n            If Trim(Master.Cells(j, 8).Value2) = vbNullString Then Exit For\n            With Slave\n                If Master.Cells(j, 3).RowHeight = 0 Then\n                    If Master.Cells(j, 3).Value = .Cells(i, 8).Value Then\n                        .Cells(i, 4).Value = \"31/03/2015\"\n                        .Cells(i, 5).Value = Master.Cells(j, 8).Value\n                        .Cells(i, 7).Value = \"Planning Permission\"\n                        .Cells(i, 8).Value = Master.Cells(j, 3).Value\n                        .Cells(i, 17).Value = Master.Cells(j, 9).Value\n                        .Cells(i, 24).Value = \"1\"\n                        .Cells(i, 27).Value = Master.Cells(j, 15).Value\n                        .Cells(i, 30).Value = Master.Cells(j, 16).Value\n                        .Cells(i, 31).Value = Master.Cells(j, 17).Value\n                        .Cells(i, 48).Value = \"Housing only\"\n                        .Cells(i, 52).Value = \"MBC\"\n                        .Cells(i, 61).Value = \"Manual\"\n                        .Cells(i, 62).Value = Master.Cells(j, 29).Value\n                        .Cells(i, 63).Value = \"0\"\n                        .Cells(i, 64).Value = \"Y\"\n                        .Cells(i, 65).Value = \"Yes\"\n                    End If\n                End If\n            End With\n        Next\n    Next\n    MsgBox (\"Data Transfer Successful\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 5023141, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/73e4102f195847ce8cdd617c722fba4c?s=128&d=identicon&r=PG&f=1", "display_name": "Calum", "link": "https://stackoverflow.com/users/5023141/calum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 32736810, "answer_count": 2, "score": 1, "last_activity_date": 1443003312, "creation_date": 1443000881, "question_id": 32735947, "link": "https://stackoverflow.com/questions/32735947/use-filtered-rows-only-for-loop", "title": "Use filtered rows only for loop", "body": "<p>Basically I've got some code below that works fine, it's just I'd like it to work on filtered data only- as when it runs from \"Allsites\" aka the mastersheet whilst filtered it still uses all the data. I'm just wondering if there is anyway to run the code on the filtered data only?</p>\n\n<pre><code>Dim lngLastRow As Long\nDim fpath As String\nDim owb As Workbook\n\nDim Master As Worksheet 'declare both\nDim Slave As Worksheet\n\nWorksheets(\"SHLAA\").Activate\nWorksheets(\"SHLAA\").Select\n\n\nSet Master = ThisWorkbook.Worksheets(\"Allsites\") 'sheet from workbook im in\nSet Slave = ThisWorkbook.Worksheets(\"SHLAA\") 'sheet in workbook im copying too\n\n\n\nlngLastRow = Slave.Cells.Find(\"*\", searchorder:=xlByRows, searchdirection:=xlPrevious).Row + 1\nFor j = 1 To 1000 '(the master sheet)\n\nFor i = 1 To 1000 '(the slave sheet) 'for first 1000 cells\n    If Trim(Master.Cells(j, 8).Value2) = vbNullString Then Exit For 'if ID cell is blank jump to last line\n    If Master.Cells(j, 3).Value = Slave.Cells(i, 8).Value Then\n            Slave.Cells(i, 4).Value = \"31/03/2015\"\n            Slave.Cells(i, 5).Value = Master.Cells(j, 8).Value\n            Slave.Cells(i, 7).Value = \"Planning Permission\"\n            Slave.Cells(i, 8).Value = Master.Cells(j, 3).Value\n            Slave.Cells(i, 17).Value = Master.Cells(j, 9).Value\n            Slave.Cells(i, 24).Value = \"1\"\n            Slave.Cells(i, 27).Value = Master.Cells(j, 15).Value\n            Slave.Cells(i, 30).Value = Master.Cells(j, 16).Value\n            Slave.Cells(i, 31).Value = Master.Cells(j, 17).Value\n            Slave.Cells(i, 48).Value = \"Housing only\"\n            Slave.Cells(i, 52).Value = \"MBC\"\n            Slave.Cells(i, 61).Value = \"Manual\"\n            Slave.Cells(i, 62).Value = Master.Cells(j, 29).Value\n            Slave.Cells(i, 63).Value = \"0\"\n            Slave.Cells(i, 64).Value = \"Y\"\n            Slave.Cells(i, 65).Value = \"Yes\"\n\n    End If\n\nNext\n\nNext\n\nMsgBox (\"Data Transfer Successful\")\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "edited": false, "score": 0, "creation_date": 1442999070, "post_id": 32735199, "comment_id": 53311389, "body": "What you have you tried so far? Have you got stuck or are having difficulty with a particular programming puzzle? You will find this community are very glad to help, but we won&#39;t complete your task for you."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1442999159, "post_id": 32735199, "comment_id": 53311445, "body": "How about a pivot table?"}, {"owner": {"reputation": 1, "user_id": 4666734, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OIP1ZVEFWNg/AAAAAAAAAAI/AAAAAAAAAJ8/oSuSxRCZxbk/photo.jpg?sz=128", "display_name": "Sonal Das", "link": "https://stackoverflow.com/users/4666734/sonal-das"}, "edited": false, "score": 0, "creation_date": 1443000147, "post_id": 32735199, "comment_id": 53312078, "body": "My approach is to get the range of all rows of &#39;Customer 1&quot; and for &quot;Value A&quot; go through each cell in a column and concatenate values in a csv form. Repeating this process for each column and further repeat this for each customer. I am trying to achieve this through VBA. However I was looking for some clue as to how can this be best achieved without making the Macro to run slow."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1443005450, "post_id": 32735199, "comment_id": 53315716, "body": "Are you able to ensure that entries in col A are sorted alphabetically?"}, {"owner": {"reputation": 1, "user_id": 4666734, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OIP1ZVEFWNg/AAAAAAAAAAI/AAAAAAAAAJ8/oSuSxRCZxbk/photo.jpg?sz=128", "display_name": "Sonal Das", "link": "https://stackoverflow.com/users/4666734/sonal-das"}, "edited": false, "score": 0, "creation_date": 1443011994, "post_id": 32735199, "comment_id": 53320233, "body": "Yes Col A is sorted..."}], "answers": [{"tags": [], "owner": {"reputation": 89, "user_id": 5152348, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5987ace7235baa336c01470bf48c5052?s=128&d=identicon&r=PG&f=1", "display_name": "Tfom", "link": "https://stackoverflow.com/users/5152348/tfom"}, "is_accepted": false, "score": 1, "last_activity_date": 1442999441, "creation_date": 1442999441, "answer_id": 32735410, "question_id": 32735199, "link": "https://stackoverflow.com/questions/32735199/combine-values-from-multiple-rows-into-a-single-row/32735410#32735410", "title": "Combine values from multiple rows into a single row", "body": "<p>You may find your answer in the Consolidate tool that's built in under the Data tab. I know the standard use for that would add together the values, rather than presenting them as comma separated. Have a look in the function drop-down for options. Otherwise, you may be looking at a bit of old VBA to do the job for you. I think KuTools do something: <a href=\"http://www.extendoffice.com/documents/excel/1268-excel-combine-duplicate-rows-and-sum.html\" rel=\"nofollow\">http://www.extendoffice.com/documents/excel/1268-excel-combine-duplicate-rows-and-sum.html</a> </p>\n"}], "owner": {"reputation": 1, "user_id": 4666734, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OIP1ZVEFWNg/AAAAAAAAAAI/AAAAAAAAAJ8/oSuSxRCZxbk/photo.jpg?sz=128", "display_name": "Sonal Das", "link": "https://stackoverflow.com/users/4666734/sonal-das"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4210, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1443018691, "creation_date": 1442998853, "last_edit_date": 1443018691, "question_id": 32735199, "link": "https://stackoverflow.com/questions/32735199/combine-values-from-multiple-rows-into-a-single-row", "title": "Combine values from multiple rows into a single row", "body": "<p>Sample data in Excel: ('|' represents a cell)</p>\n\n<pre><code>    Customer   | Value A | Value B | Year\n    Customer 1 | 134     |         | 2009\n    Customer 1 |         | 9       | 2009\n    Customer 1 | 175     |         |        \n    Customer 2 | 515     |         | 2009\n    Customer 2 | 1946    | 7       | 2010\n    Customer 3 |         |         |\n    Customer 3 |         | 154     |\n    Customer 3 |         |         | 2011\n</code></pre>\n\n<p>The scenario is that I have a sheet where there are duplicates in a column (say <code>Customer</code> here). I need to merge all duplicates for a given 'Customer' into a single row. Meaning, that all rows (of duplicates) will be concatenated into one row. If value for a column is same in both instance of rows, then no concatenation is required.</p>\n\n<p>Following is the expected result:</p>\n\n<pre><code>    Customer   | Value A | Value B | Year\n    Customer 1 | 134,175 | 9       | 2009\n    Customer 2 | 515,1964| 7       | 2009,2010\n    Customer 3 |         | 154     | 2011\n</code></pre>\n\n<p>I need VBA to combine duplicate customer details into one row.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 5566, "user_id": 1771479, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5m0gd.jpg?s=128&g=1", "display_name": "agold", "link": "https://stackoverflow.com/users/1771479/agold"}, "is_accepted": true, "score": 1, "last_activity_date": 1442998628, "last_edit_date": 1495540307, "creation_date": 1442998247, "answer_id": 32734981, "question_id": 32734524, "link": "https://stackoverflow.com/questions/32734524/invalid-outside-procedure-for-class/32734981#32734981", "title": "Invalid outside procedure for class", "body": "<p>You don't need the <code>Class VirtualWindow</code> and <code>End Class</code> here (since it is Visual Basic for Applications, not Visual Basic 6: <a href=\"https://stackoverflow.com/questions/993300/difference-between-visual-basic-and-vba\">VB vs. VBA</a>) you can define the name in the properties field:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZTZTI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZTZTI.png\" alt=\"enter image description here\"></a></p>\n\n<p>After this, from another function or class you can create an instance of the class:</p>\n\n<pre><code>Private w as VirtualWindow\n\nPublic Sub YourSub()\n   Set w = new VirtualWindow\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 364, "user_id": 5229863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab9106274e202c226490fa7f85b069f9?s=128&d=identicon&r=PG&f=1", "display_name": "Wouter", "link": "https://stackoverflow.com/users/5229863/wouter"}, "is_accepted": false, "score": 1, "last_activity_date": 1442998300, "creation_date": 1442998300, "answer_id": 32735007, "question_id": 32734524, "link": "https://stackoverflow.com/questions/32734524/invalid-outside-procedure-for-class/32735007#32735007", "title": "Invalid outside procedure for class", "body": "<p>You're mixing up VB6 syntax with another language I think.\nYou do not have to put \"Class VirtualWindow\" and \"End Class\" in your code.\nJust:</p>\n\n<pre><code>Public Sub Class_Initialize()\n    Debug.Print \"Class_Initialize\"\nEnd Sub\n\nPublic Sub Class_Terminate()\n    Debug.Print \"Class_Terminate\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 750, "user_id": 2690165, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/f0fab7c7aace5c1103b6cc490206c8e0?s=128&d=identicon&r=PG&f=1", "display_name": "Lucian", "link": "https://stackoverflow.com/users/2690165/lucian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 723, "favorite_count": 0, "accepted_answer_id": 32734981, "answer_count": 2, "score": 1, "last_activity_date": 1442998628, "creation_date": 1442996826, "last_edit_date": 1531164843, "question_id": 32734524, "link": "https://stackoverflow.com/questions/32734524/invalid-outside-procedure-for-class", "title": "Invalid outside procedure for class", "body": "<p>I have a strange problem defining a class in an Excel VBA macro.</p>\n\n<p>To do this I go to <em>Excel&rarr;DEVELOPER(tab)&rarr;Visual Basic</em> (the new view is opened). In this new view I do <em>Project Name&rarr;Insert&rarr;Class Module</em> and a new file is created.</p>\n\n<p>Then I try to create a simple class in this file, like:</p>\n\n<pre><code>Class VirtualWindow    \nPublic Sub Class_Initialize()\n    Debug.Print \"Class_Initialize\"\nEnd Sub\n\nPublic Sub Class_Terminate()\n    Debug.Print \"Class_Terminate\"\nEnd Sub\nEnd Class\n</code></pre>\n\n<p><code>End Class</code> is in red color, this meaning that it's not ok and when I try running it to see what error it throws it gives me the \"Invalid outside procedure\" error. I don't understand where is the problem.</p>\n"}, {"tags": ["excel", "vba", "object", "checkbox"], "answers": [{"comments": [{"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1443003355, "post_id": 32735522, "comment_id": 53314343, "body": "Thanks. That looks great! Sorry for being thick, but how do I find out what the Group Name is?"}, {"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1443003538, "post_id": 32735522, "comment_id": 53314454, "body": "Doh! Found it in the formula bar!"}, {"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1443004597, "post_id": 32735522, "comment_id": 53315139, "body": "One other thing though ... If I group my check boxes the above code works fine. However, if I then group these into a Rectangle then the group is no longer visible. I&#39;ve tried adding <code>With osheet.Shapes.Range(&quot;Rectangle 54&quot;)</code> around the <code>With osheet.shapes.range</code> but no luck so far. Any ideas? thanks!"}, {"owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "reply_to_user": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1443006182, "post_id": 32735522, "comment_id": 53316218, "body": "You probably need an extra step in the reference. something like <code>oSheet.Shapes.Range(sGroupName).GroupItems(sSubGroupName).Gr&zwnj;&#8203;oupItems</code>"}], "tags": [], "owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "is_accepted": true, "score": 1, "last_activity_date": 1442999761, "creation_date": 1442999761, "answer_id": 32735522, "question_id": 32734515, "link": "https://stackoverflow.com/questions/32734515/why-does-grouping-activex-checkboxes-alter-oleobject-visibility/32735522#32735522", "title": "Why does grouping ActiveX checkboxes alter OLEObject visibility", "body": "<p>The way to reference the OLEObjects is like this:</p>\n\n<pre><code>Public Sub ReferenceTest(oSheet As Worksheet, sGroupName As String)\n\n    Dim i               As Long\n    Dim oOle            As OLEObject\n\n    With oSheet.Shapes.Range(sGroupName).GroupItems\n        For i = 1 To .Count\n            Set oOle = .Item(i).OLEFormat.Object\n            Debug.Print oOle.Name, oOle.Object.Value\n        Next i\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Just specify the sheet and group name, e.g. </p>\n\n<pre><code>ReferenceTest ActiveSheet, \"Group 1\"\n</code></pre>\n"}], "owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "accepted_answer_id": 32735522, "answer_count": 1, "score": 1, "last_activity_date": 1442999761, "creation_date": 1442996804, "question_id": 32734515, "link": "https://stackoverflow.com/questions/32734515/why-does-grouping-activex-checkboxes-alter-oleobject-visibility", "title": "Why does grouping ActiveX checkboxes alter OLEObject visibility", "body": "<p>I have some code that loops through the ActiveX controls on an Excel worksheet. This logs which checkboxes have been selected.</p>\n\n<pre><code>Dim obj AS OLEObject\nFor Each obj In ActiveSheet.OLEObjects\n    If TypeName(obj.Object) = \"CheckBox\" Then ' loop through all checkboxes to find selections\n        BooCheck = obj.Object\n        If BooCheck = True Then\n           MyArray(j) = obj.Name 'if checkbox selected then store the associated Name\n           j = j + 1\n        End If\n    End If\nNext obj\n</code></pre>\n\n<p>This all works fine. However, as I have a number of checkboxes that I need to move around I thought I'd group them together by Shift/click in design mode, right click and select the \"Group\" option. However, if I do this the grouped checkboxes vanish from OLEObjects. Where do they go? Is there a way of altering my code to find them when they are grouped?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 791, "user_id": 3756622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OEplh.jpg?s=128&g=1", "display_name": "xum59", "link": "https://stackoverflow.com/users/3756622/xum59"}, "edited": false, "score": 1, "creation_date": 1442995928, "post_id": 32734248, "comment_id": 53309618, "body": "Have you tried to record a macro ?"}, {"owner": {"reputation": 1, "user_id": 5366756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9ca771d03f7970c1319c569abf91f00?s=128&d=identicon&r=PG&f=1", "display_name": "Fly_high", "link": "https://stackoverflow.com/users/5366756/fly-high"}, "reply_to_user": {"reputation": 791, "user_id": 3756622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OEplh.jpg?s=128&g=1", "display_name": "xum59", "link": "https://stackoverflow.com/users/3756622/xum59"}, "edited": false, "score": 0, "creation_date": 1442996113, "post_id": 32734248, "comment_id": 53309715, "body": "I was able to find some code from internet, however it is only hiding a single column. I am not able to alter it for hiding multiple columns."}, {"owner": {"reputation": 1, "user_id": 5366756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9ca771d03f7970c1319c569abf91f00?s=128&d=identicon&r=PG&f=1", "display_name": "Fly_high", "link": "https://stackoverflow.com/users/5366756/fly-high"}, "reply_to_user": {"reputation": 791, "user_id": 3756622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OEplh.jpg?s=128&g=1", "display_name": "xum59", "link": "https://stackoverflow.com/users/3756622/xum59"}, "edited": false, "score": 0, "creation_date": 1442996207, "post_id": 32734248, "comment_id": 53309753, "body": "Sub TotalHide()     Dim FirstCol As Integer, LastCol As Integer     Dim ColCount As Integer           FirstCol = ActiveCell.Column     LastCol = FindLastColumn(ActiveSheet)     If Not LastCol &gt; FirstCol Then Exit Sub     If IsOdd(LastCol) And Not IsOdd(FirstCol) Then LastCol = LastCol - 1     If Not IsOdd(LastCol) And IsOdd(FirstCol) Then LastCol = LastCol - 1     &#39;establish columns To work With     Application.ScreenUpdating = False     For ColCount = LastCol To FirstCol Step -3         ActiveSheet.Columns(ColCount).Hidden = True     Next     Application.ScreenUpdating = True      End Sub"}, {"owner": {"reputation": 1, "user_id": 5366756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9ca771d03f7970c1319c569abf91f00?s=128&d=identicon&r=PG&f=1", "display_name": "Fly_high", "link": "https://stackoverflow.com/users/5366756/fly-high"}, "reply_to_user": {"reputation": 791, "user_id": 3756622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OEplh.jpg?s=128&g=1", "display_name": "xum59", "link": "https://stackoverflow.com/users/3756622/xum59"}, "edited": false, "score": 0, "creation_date": 1442996213, "post_id": 32734248, "comment_id": 53309756, "body": "Function FindLastColumn(ByRef ws As Worksheet) As Integer     With ws         If WorksheetFunction.CountA(Cells) &gt; 0 Then             &#39;Search For any entry, by searching backwards by Columns.             FindLastColumn = Cells.Find(What:=&quot;*&quot;, After:=[A1], SearchOrder:=xlByColumns, _             SearchDirection:=xlPrevious).Column         End If     End With End Function   Function IsOdd(ByVal l As Long) As Boolean     IsOdd = l Mod 2 End Function"}, {"owner": {"reputation": 1966, "user_id": 1392312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/WTTkb.png?s=128&g=1", "display_name": "Rossiar", "link": "https://stackoverflow.com/users/1392312/rossiar"}, "edited": false, "score": 1, "creation_date": 1442997241, "post_id": 32734248, "comment_id": 53310324, "body": "Please edit your question instead of writing these large comments, it makes it much more readable for everyone trying to answer. :-)"}, {"owner": {"reputation": 1, "user_id": 5366756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9ca771d03f7970c1319c569abf91f00?s=128&d=identicon&r=PG&f=1", "display_name": "Fly_high", "link": "https://stackoverflow.com/users/5366756/fly-high"}, "edited": false, "score": 0, "creation_date": 1442997990, "post_id": 32734248, "comment_id": 53310742, "body": "Roger that :) thanks"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5366756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9ca771d03f7970c1319c569abf91f00?s=128&d=identicon&r=PG&f=1", "display_name": "Fly_high", "link": "https://stackoverflow.com/users/5366756/fly-high"}, "edited": false, "score": 0, "creation_date": 1442997564, "post_id": 32734544, "comment_id": 53310506, "body": "Thanks, that looks pretty decent. I would require the &quot;i&quot; to function until the last column available."}, {"owner": {"reputation": 1, "user_id": 5366756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9ca771d03f7970c1319c569abf91f00?s=128&d=identicon&r=PG&f=1", "display_name": "Fly_high", "link": "https://stackoverflow.com/users/5366756/fly-high"}, "edited": false, "score": 0, "creation_date": 1443006235, "post_id": 32734544, "comment_id": 53316252, "body": "Thanks a ton, it worked. :) i just amended a few according to my requirement and spot on."}], "tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1442998531, "last_edit_date": 1442998531, "creation_date": 1442996888, "answer_id": 32734544, "question_id": 32734248, "link": "https://stackoverflow.com/questions/32734248/hiding-nth-column/32734544#32734544", "title": "Hiding nth column", "body": "<p>You can try this:</p>\n\n<pre><code>Dim i As Integer\nFor i = 1 To Selection.Columns.Count Step 3\n    Selection.Columns(i + 1).Hidden = True\n    Selection.Columns(i + 2).Hidden = True\nNext i\n</code></pre>\n\n<p>Should work with any selection.</p>\n\n<pre><code>Dim st As Long, sp As Long\nst = Selection.Column\nsp = Selection.End(xlToRight).Column\nDim i As Integer\nFor i = st To sp Step 3\n    Cells.Columns(i + 1).Hidden = True\n    Cells.Columns(i + 2).Hidden = True\nNext i\n</code></pre>\n\n<p>Will hide 2 columns every 3 starting from the current cell up to the last column used in the row of the selected cell.</p>\n"}], "owner": {"reputation": 1, "user_id": 5366756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9ca771d03f7970c1319c569abf91f00?s=128&d=identicon&r=PG&f=1", "display_name": "Fly_high", "link": "https://stackoverflow.com/users/5366756/fly-high"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 710, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443014480, "creation_date": 1442995865, "last_edit_date": 1531161705, "question_id": 32734248, "link": "https://stackoverflow.com/questions/32734248/hiding-nth-column", "title": "Hiding nth column", "body": "<p>I want a code to hide every two columns with an interval of 1 column. Can anyone help with a VBA script. Eg. Col C&amp;D, F&amp;G, I&amp;J needs to be hidden.</p>\n\n<p>The range is dynamic and subject to change with increase in records.</p>\n"}, {"tags": ["arrays", "excel", "vba", "csv", "memory"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1442994412, "creation_date": 1442994412, "answer_id": 32733834, "question_id": 32733679, "link": "https://stackoverflow.com/questions/32733679/out-of-memory-second-run/32733834#32733834", "title": "Out of memory second run", "body": "<p>I'm unclear on what you are assigning <strong>i</strong> (<code>i = FreeFile</code>...?) but perhaps this alternate method of a free file handle will clear the file handle a bit better.</p>\n\n<pre><code>Open filepath For Binary Access Read As #1\nGet #1, , res\nClose #1\n</code></pre>\n\n<p>In any event, your own code should likely be using <code>Close #i</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 374, "user_id": 3029137, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4H2Ec.jpg?s=128&g=1", "display_name": "aprados", "link": "https://stackoverflow.com/users/3029137/aprados"}, "is_accepted": false, "score": 1, "last_activity_date": 1443000782, "last_edit_date": 1443000782, "creation_date": 1442998542, "answer_id": 32735092, "question_id": 32733679, "link": "https://stackoverflow.com/questions/32733679/out-of-memory-second-run/32735092#32735092", "title": "Out of memory second run", "body": "<p>Did you have setted all variables to \"nothing\" after the work is done?</p>\n\n<p>Anyway, I want to share a tip with you: if you are working with strings in \"title\", replace all \"Right\" and \"Left\" functions with \"Right$\" and \"Left$\". You'll get a 5 or 10% faster result. Also, try to not do the same two or more times, like:</p>\n\n<pre><code>Left(res, Len(res) - 1)\n</code></pre>\n\n<p>...It will be better to assign it to a variable and work with it.</p>\n"}], "owner": {"reputation": 21, "user_id": 5366456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb353ef9281aa0fb6e923fac63b50dc6?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastiaan", "link": "https://stackoverflow.com/users/5366456/sebastiaan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1445263784, "creation_date": 1442993866, "last_edit_date": 1443014512, "question_id": 32733679, "link": "https://stackoverflow.com/questions/32733679/out-of-memory-second-run", "title": "Out of memory second run", "body": "<p>Something unexpected happens when I try to load a large array from a CSV file. The file has 100000 rows and 100 columns (80mb). I have tried numerous ways to load the CSV quickly (because speed is of essence). The code below works fine the first time, but when I run it a second time either variable title (String) or redim arrRaw (Variant) gives a 'out of memory' error. After restarting Excel it works fine for one time again.\nThey are both locally declared variables. I have tried to use public declaration and then erasing the array, but this diddent work. My system shows no problem with the RAM memory. Is there a work around (or a solution) to this problem?</p>\n\n<pre><code>Open filepath For Binary Access Read As #i\nGet #i, , res\nClose i\n\ntitle = Split(Right(Left(res, Len(res) - 1), Len(Left(res, Len(res) - 1)) - 1), vbLf)\ncolumnsArr = UBound(Split(title(1), \";\"))\nrowsArr = UBound(title)\n\nReDim arrRaw(1 To rowsArr, 1 To columnsArr)\n\nCall timerClock(True)\n\nFor i = 0 To rowsArr\n    TmpAr = Split(title(i), \";\")\n    For j = 0 To UBound(TmpAr) - 1\n        If IsNumeric(TmpAr(j)) Then\n            arrRaw(i + 1, j + 1) = TmpAr(j)\n        Else\n            arrRaw(i + 1, j + 1) = 0\n        End If\n    Next j\nNext i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 983, "user_id": 4632606, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/VsoxX.jpg?s=128&g=1", "display_name": "ZwoRmi", "link": "https://stackoverflow.com/users/4632606/zwormi"}, "edited": false, "score": 1, "creation_date": 1442990033, "post_id": 32732454, "comment_id": 53306335, "body": "Try to use the debugger, and watch the real values of <code>a.Value</code> and <code>oAllocated</code>. Maybe the type does not match. Also you can try to use <code>Value2</code> instead of <code>Value</code>.   And why do you cast <code>a.Value</code> as a <code>Single</code> in the <code>MsgBox</code> and not in your condition?"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1442992116, "post_id": 32732454, "comment_id": 53307477, "body": "If ZwoRmi&#39;s suggestion doesn&#39;t fix it, type following in immediate window: <code>? TypeName(a.Value)</code> and <code>? a.Value &lt;&gt; oAllocated</code> and show us the results."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1442992602, "post_id": 32732454, "comment_id": 53307742, "body": "It&#39;s probably a floating point error. Try rounding: <code>If Round(a.Value, 5) &lt;&gt; Round(oAllocated, 5) Then</code>"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1442995708, "post_id": 32732454, "comment_id": 53309509, "body": "Insert a Debug.Print just before the <code>If</code> statement: <code>Debug.Print CSng(a.Value2) &amp; &quot;=&quot; &amp; oAllocated</code> and see what you get."}, {"owner": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "reply_to_user": {"reputation": 983, "user_id": 4632606, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/VsoxX.jpg?s=128&g=1", "display_name": "ZwoRmi", "link": "https://stackoverflow.com/users/4632606/zwormi"}, "edited": false, "score": 0, "creation_date": 1442999239, "post_id": 32732454, "comment_id": 53311488, "body": "It definitely sounds like you have a miss-match of variable types (something I have come across in the past). Try value2 as suggested by @ZwoRmi or make sure to Dim the variables to matching data types."}, {"owner": {"reputation": 37, "user_id": 3908152, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/781e2adef1a40729c4c57b288520f16d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/3908152/josh"}, "edited": false, "score": 0, "creation_date": 1443074812, "post_id": 32732454, "comment_id": 53348791, "body": "WOOHOO! I ended up going with .value2 combined with Round. Thanks, all."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 3908152, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/781e2adef1a40729c4c57b288520f16d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/3908152/josh"}, "edited": false, "score": 0, "creation_date": 1443074778, "post_id": 32738326, "comment_id": 53348780, "body": "This was part of a much larger block of code, the selection gets made in an area I didn&#39;t include here."}], "tags": [], "owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "is_accepted": false, "score": 0, "last_activity_date": 1443007622, "creation_date": 1443007622, "answer_id": 32738326, "question_id": 32732454, "link": "https://stackoverflow.com/questions/32732454/variables-fail-comparison-but-display-values-are-the-same/32738326#32738326", "title": "Variables fail comparison but display values are the same", "body": "<p><code> For Each b In wsSheet.Range(Cells(Selection.Row, 4), Cells(Selection.Row, 17))</code><br><br>\nI don't see any context for \"Selection\", so that's going to produce potentially unpredictable results.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5367975, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/4b1917afba817345d5219431c36f08cb?s=128&d=identicon&r=PG", "display_name": "William", "link": "https://stackoverflow.com/users/5367975/william"}, "is_accepted": false, "score": 0, "last_activity_date": 1443015331, "creation_date": 1443015331, "answer_id": 32741133, "question_id": 32732454, "link": "https://stackoverflow.com/questions/32732454/variables-fail-comparison-but-display-values-are-the-same/32741133#32741133", "title": "Variables fail comparison but display values are the same", "body": "<p>I just had the exact same issue today. As long as you are sure your cells do not have any additional spaces and are the same format (which often causes this problem) then use the Range() command. Apparently Excel does not handle long infinite decimals that well.</p>\n\n<p><a href=\"https://support.microsoft.com/en-us/kb/78113\" rel=\"nofollow\">https://support.microsoft.com/en-us/kb/78113</a></p>\n"}], "owner": {"reputation": 37, "user_id": 3908152, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/781e2adef1a40729c4c57b288520f16d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/3908152/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1443015331, "creation_date": 1442989666, "last_edit_date": 1443014637, "question_id": 32732454, "link": "https://stackoverflow.com/questions/32732454/variables-fail-comparison-but-display-values-are-the-same", "title": "Variables fail comparison but display values are the same", "body": "<p>I have the following code, which cycles through some cells and populates them with values. It works fine, except now I'm trying to keep track of the total value of all the populated cells in a row. After a row is populated, I want to know if the sum of the populated cells is not equal to the value stored in Column C in the current row (a.value).</p>\n\n<p>When I do the If/Then comparing a.value to oAllocated, I get a couple of results I don't expect and the MsgBox appears to be displaying the same values, even though the MsgBox is being displayed because Excel says they aren't.</p>\n\n<p>Even more confusing is that if I create a formula in a cell on the worksheet which sums the entries in the row and compares it to the a.value column, they match!!</p>\n\n<pre><code>Dim wsSheet As Worksheet\nDim oAllocated As Single\n\n\nFor Each a In wsSheet.Range(\"C3:C17\").Cells\n    If (IsEmpty(a) = False) Then\n        oAllocated = 0\n        For Each b In wsSheet.Range(Cells(Selection.Row, 4), Cells(Selection.Row, 17))\n            If IsEmpty(Application.WorksheetFunction.VLookup(Cells(b.Row, 1), Sheets(\"Allowable Activities\").Range(\"A1:Q17\"), Application.WorksheetFunction.Match(Cells(1, b.Column), Sheets(\"Allowable Activities\").Range(\"A1:Q1\"), 0), False)) = True Then\n                If b.Value + (a.Value * Application.WorksheetFunction.VLookup(oSheetName, Sheets(\"Funder Salary Allocation\").Range(\"B1:Q13\"), Application.WorksheetFunction.Match(Cells(1, b.Column), Sheets(\"Funder Salary Allocation\").Range(\"B1:Q1\"), 0), False)) &gt; 0 Then\n                    b.Offset(0, 24).Value = b.Value + (a.Value * Application.WorksheetFunction.VLookup(oSheetName, Sheets(\"Funder Salary Allocation\").Range(\"B1:Q13\"), Application.WorksheetFunction.Match(Cells(1, b.Column), Sheets(\"Funder Salary Allocation\").Range(\"B1:Q1\"), 0), False))\n                    oAllocated = oAllocated + CSng((b.Value + (a.Value * Application.WorksheetFunction.VLookup(oSheetName, Sheets(\"Funder Salary Allocation\").Range(\"B1:Q13\"), Application.WorksheetFunction.Match(Cells(1, b.Column), Sheets(\"Funder Salary Allocation\").Range(\"B1:Q1\"), 0), False))))\n                End If\n            End If\n        Next\n        If a.Value &lt;&gt; oAllocated Then\n            MsgBox (\"Allocated: \" &amp; CSng(a.Value) &amp; \" - Dispersed: \" &amp; oAllocated)\n        End If\n    End If\n    ActiveCell.Offset(1, 0).Select\nNext\n</code></pre>\n"}, {"tags": ["vba", "email", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4018035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce99874660b6d58036faf8e4f0ad5a25?s=128&d=identicon&r=PG&f=1", "display_name": "Cusx", "link": "https://stackoverflow.com/users/4018035/cusx"}, "edited": false, "score": 0, "creation_date": 1443754691, "post_id": 32732073, "comment_id": 53628501, "body": "Hi Dimitry, The reason I am asking for late binding was: I have created an excel with those codes in office 2007 adding Microsoft outlook object reference version 12. Another user with office 2013, was opening the file, do some work and save it (the excel automatically picked up office 2013 microsoft outlook object reference version 15). When another user login to the excel using office 2007, the macro does not run anymore as library version 15 is not found on the machine with excel 2007 (the user is not tech savvy enough to change it back to 2007 outlook reference)."}, {"owner": {"reputation": 1, "user_id": 4018035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce99874660b6d58036faf8e4f0ad5a25?s=128&d=identicon&r=PG&f=1", "display_name": "Cusx", "link": "https://stackoverflow.com/users/4018035/cusx"}, "edited": false, "score": 0, "creation_date": 1443754722, "post_id": 32732073, "comment_id": 53628506, "body": "Is there another way to fix this issue? I would thought late binding might be able to fix this as we do not need to choose an outlook object reference thus mitigating any issue when the user is using different office version."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1442988067, "creation_date": 1442988067, "answer_id": 32732073, "question_id": 32731434, "link": "https://stackoverflow.com/questions/32731434/saving-a-copy-of-outlook-email-msg-to-a-folder-after-send-is-pressed/32732073#32732073", "title": "Saving a copy of outlook email (.msg) to a folder after &#39;Send&#39; is pressed", "body": "<p>You cannot (easily) support events using late binding, not in VB script. Whoever is using your code, will need to add the right version of Outlook to the project references.</p>\n"}], "owner": {"reputation": 1, "user_id": 4018035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce99874660b6d58036faf8e4f0ad5a25?s=128&d=identicon&r=PG&f=1", "display_name": "Cusx", "link": "https://stackoverflow.com/users/4018035/cusx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2113, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593306731, "creation_date": 1442985187, "last_edit_date": 1593306731, "question_id": 32731434, "link": "https://stackoverflow.com/questions/32731434/saving-a-copy-of-outlook-email-msg-to-a-folder-after-send-is-pressed", "title": "Saving a copy of outlook email (.msg) to a folder after &#39;Send&#39; is pressed", "body": "<p>I have tried the codes below and it was working exactly as I wanted it to be.\n<a href=\"http://www.mrexcel.com/forum/excel-questions/361751-visual-basic-applications-saving-email-only-after-send-pushed.html\" rel=\"nofollow\">http://www.mrexcel.com/forum/excel-questions/361751-visual-basic-applications-saving-email-only-after-send-pushed.html</a></p>\n\n<p>However, as I was creating this for other colleagues who are using different Excel version, some of my colleagues are having library error. After read around, I believe I need to use late binding instead of early binding so people with different excel version can access the function.</p>\n\n<p>How to I change the code below (to late binding) so that all other version of excel users can also use the function? Copy of the working codes below.</p>\n\n<p>Class Code</p>\n\n<pre><code>Option Explicit\nPublic WithEvents obj_OL As Outlook.Application\n'\nPrivate Sub obj_OL_ItemSend(ByVal Item As Object, Cancel As Boolean)\n\n    '// For example, change pathway to suit, such as:                           //\n    '// \"\\\\Dacsrv02\\rtddata\\Advice\\TechQueries\\TRIM Emails\\\" &amp; emailname\n    OutMail.SaveAs ThisWorkbook.Path &amp; _\n                           Application.PathSeparator &amp; _\n                           emailname\n\n    '// AFTER the event has been called, explicitly release Outlook.        //\n    Set obj_OL = Nothing\n    Set OutMail = Nothing\nEnd Sub\n</code></pre>\n\n<p>Sub Codes</p>\n\n<pre><code>Option Explicit\n'// Connect the declared object w/the class module                          //\nDim cls_OL As New clsOutlook\n'// Declare the email msg (mail item) and emailname string as Public, so    //\n'// that they can be \"seen\" from any procedures in the class mod.           //\nPublic OutMail As Outlook.MailItem\nPublic emailname As String\n\nSub Email_Response()\nDim strbody As String\n\n    '// Create our new mail item                                            //\n    Set OutMail = cls_OL.obj_OL.CreateItem(0)\n\n    '// Example substitute                                                      //\n    strbody = \"This is just example text\"\n\n    On Error Resume Next\n\n    emailname = \"something.msg\"\n\n    With OutMail\n        .To = \"\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"Specific Subject\"\n        .body = strbody\n        .Display\n    End With\n\n    On Error GoTo 0\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 4, "last_activity_date": 1442982530, "creation_date": 1442982530, "answer_id": 32730984, "question_id": 32730565, "link": "https://stackoverflow.com/questions/32730565/identify-the-first-row-and-last-row-in-a-merged-cell/32730984#32730984", "title": "Identify the first row and last row in a merged cell", "body": "<p>Consider this example:</p>\n\n<pre><code>Set MyMergedRange = Range(\"d20\").MergeArea\nFirstRow = MyMergedRange.Row\nLastRow = MyMergedRange.Row + MyMergedRange.Rows.Count - 1\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 3559552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/179c203680c4f3b99729ebc0cb29ca6f?s=128&d=identicon&r=PG&f=1", "display_name": "PootyToot", "link": "https://stackoverflow.com/users/3559552/pootytoot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3261, "favorite_count": 0, "accepted_answer_id": 32730984, "answer_count": 1, "score": 0, "last_activity_date": 1442982530, "creation_date": 1442979613, "last_edit_date": 1442980272, "question_id": 32730565, "link": "https://stackoverflow.com/questions/32730565/identify-the-first-row-and-last-row-in-a-merged-cell", "title": "Identify the first row and last row in a merged cell", "body": "<p>I am applying some Conditional Formatting to an Excel sheet which involves some complex metrics, therefore have decided to pursue this method using VBA.</p>\n\n<p>Because of the way the spreadsheet is laid out, the L1's and L0's are contained in merged cells.  I need a way to identify the first and last row in a group of merged cells, the code below does not work as I is in a constant looping state.  I need a way to look at the merged cell as it finds it, and then identify the first row and last row in that merged cell area. Current code:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\nDim I As Integer, J As Integer\nDim LastRow As Long, L0FirstMergedRow As Long, L0LastMergedRow As Long, L1FirstMergedRow As Long, L1LastMergedRow As Long\nDim Baseline As Long, Forecast As Long, Balance As Long, Actual As Long\nDim Baselinerng As Range, Forecastrng As Range, ActualRng As Range\nDim MaximumBaseline As Double, MaximumForecast As Double, MaximumActual As Double\nDim r As Long, actualvalue As Long\n\nLastRow = ThisWorkbook.Worksheets(\"Status Report\").Cells(Rows.Count, \"F\").End(xlUp).Row\n\nactualvalue = 0\n\nFor I = 3 To LastRow\n\n    'Code looks for merged cells and marks the row numbers\n    If ThisWorkbook.Worksheets(\"Status Report\").Cells(I, 3).MergeCells = True Then\n\n        L1FirstMergedRow = I\n        L1LastMergedRow = I + ThisWorkbook.Worksheets(\"Status Report\").Cells(I, 3).MergeArea.Cells.Count\n\n    'Set ranges of Baseline, Forecast and Actual cells\n        Set Baselinerng = ThisWorkbook.Worksheets(\"Status Report\").Range(Cells(L1FirstMergedRow, 6), Cells(L1LastMergedRow, 6))\n        Set Forecastrng = ThisWorkbook.Worksheets(\"Status Report\").Range(Cells(L1FirstMergedRow, 7), Cells(L1LastMergedRow, 7))\n        Set ActualRng = ThisWorkbook.Worksheets(\"Status Report\").Range(Cells(L1FirstMergedRow, 8), Cells(L1LastMergedRow, 8))\n\n        MaximumBaseline = Application.WorksheetFunction.Max(Baselinerng)\n        MaximumForecast = Application.WorksheetFunction.Max(Forecastrng)\n        MaximumActual = Application.WorksheetFunction.Max(ActualRng)\n\n    'Code looks for values in Actuals Column before it executes.\n        For J = L1FirstMergedRow To L1LastMergedRow\n                If ThisWorkbook.Worksheets(\"Status Report\").Cells(J, 8).Value &lt;&gt; \"\" Then\n                    actualvalue = actualvalue + 1\n                End If\n        Next J\n\n    ' Colour Cells Blue based on calculation of Actual dates\n        If actualvalue = L1LastMergedRow - L1FirstMergedRow + 1 Then\n            ThisWorkbook.Worksheets(\"Status Report\").Cells(I, 3).Interior.Color = RGB(0, 102, 255)\n        End If\n\n        If MaximumActual = 0 Then\n\n            If MaximumBaseline &lt;&gt; 0 And MaximumForecast &lt;&gt; 0 Then\n                Balance = MaximumForecast - MaximumBaseline\n            Else\n                GoTo NextLoop2:\n            End If\n\n            If MaximumBaseline &lt;= MaximumForecast Then\n                ThisWorkbook.Worksheets(\"Status Report\").Cells(I, 3).Interior.Color = RGB(0, 176, 80)\n            End If\n\n            If MaximumBaseline &lt; MaximumForecast And Balance &lt;= 5 Then\n                ThisWorkbook.Worksheets(\"Status Report\").Cells(I, 3).Interior.Color = RGB(255, 192, 0)\n            End If\n\n            If MaximumBaseline &lt; MaximumForecast And Balance &gt; 5 Then\n                ThisWorkbook.Worksheets(\"Status Report\").Cells(I, 3).Interior.Color = RGB(255, 0, 0)\n                ThisWorkbook.Worksheets(\"Status Report\").Cells(I, 3).Interior.Color = RGB(255, 0, 0)\n            End If\n\n        Else\n        GoTo NextLoop2:\n\n        End If\n    End If\n\nNextLoop2:\nNext I\n</code></pre>\n"}, {"tags": ["excel", "macos", "vba", "powerpoint"], "comments": [{"owner": {"reputation": 29, "user_id": 5253405, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156432032050131/picture?type=large", "display_name": "Evan Sitzes", "link": "https://stackoverflow.com/users/5253405/evan-sitzes"}, "edited": false, "score": 0, "creation_date": 1443477580, "post_id": 32730358, "comment_id": 53500821, "body": "Update: I have tested that the run method works passing numbers, text, etc. But when I try to do it with a Collection that is what is causing the error."}], "answers": [{"tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": false, "score": 0, "last_activity_date": 1442994958, "creation_date": 1442994958, "answer_id": 32733999, "question_id": 32730358, "link": "https://stackoverflow.com/questions/32730358/run-method-giving-invalid-procedure-call-or-argument-error/32733999#32733999", "title": "&#39;Run&#39; method giving &quot;Invalid procedure call or argument&quot; error", "body": "<p>Have you created an instance of PowerPoint prior to using the Run method?</p>\n\n<pre><code>Set PPT = CreateObject(\"PowerPoint.Application\")\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 5253405, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156432032050131/picture?type=large", "display_name": "Evan Sitzes", "link": "https://stackoverflow.com/users/5253405/evan-sitzes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 586, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443477528, "creation_date": 1442977965, "last_edit_date": 1443477528, "question_id": 32730358, "link": "https://stackoverflow.com/questions/32730358/run-method-giving-invalid-procedure-call-or-argument-error", "title": "&#39;Run&#39; method giving &quot;Invalid procedure call or argument&quot; error", "body": "<p>Attempting to run the Sub \"populateTextbox\" in an open PowerPoint application from an Excel application (Office 2011) the following code works on my Windows machine:</p>\n\n<pre><code>Dim PPT As PowerPoint.Application \n\nPPT.Run \"MyPresentation.pptm!Module1.populateTextbox\", slideNumber, collection\n</code></pre>\n\n<p>However on my Mac I get the error: <em>\"Run-time error '5':\nInvalid procedure call or argument\"</em></p>\n\n<p>The Excel and the PowerPoint files are in the same folder and I have tried using the absolute path as well as the relative path above.</p>\n"}, {"tags": ["excel", "vba", "combobox"], "answers": [{"tags": [], "owner": {"reputation": 55, "user_id": 3060422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2ba53a3abf4b705151fd860dbbd4347?s=128&d=identicon&r=PG&f=1", "display_name": "AYoungDukie", "link": "https://stackoverflow.com/users/3060422/ayoungdukie"}, "is_accepted": false, "score": 1, "last_activity_date": 1454003575, "last_edit_date": 1495541312, "creation_date": 1454003049, "answer_id": 35068360, "question_id": 32730280, "link": "https://stackoverflow.com/questions/32730280/stop-combobox-autoselecting-upon-arrow-down/35068360#35068360", "title": "Stop combobox autoselecting upon arrow down", "body": "<p>I was dealing with the same issue, and ended up finding some info on a Microsoft Help-site thread that let me play around with it. <a href=\"https://stackoverflow.com/questions/26931436/how-use-the-combobox-keydown-event-without-selecting-the-listed-item/34621918#34621918\" title=\"Original answer and code\">I posted an answer here</a> which seems to work for me. Seems like a bunch of us have had this issue! The answer is a stripped down version of what I use in a sheet for this same concept. I take it your ComboBox is called <code>priorCmb</code>, so I'm going to reference that for the events</p>\n\n<p>The basic idea involves the <code>priorCmb_KeyDown()</code> event in the sheet where the combobox is located (though should be similar to <code>KeyPress</code> in overall behavior except using <code>KeyCode</code> instead of <code>keyAscii</code>, so adapt accordingly). This can grab the arrow key presses and set a flag. The keys' actions are bypassed by setting the <code>KeyCode</code> value to 0 and using an increment/decrement with the <code>priorCmb.ListIndex</code> value to change the selection. Then, using a flag in the <code>priorCmb_Change()</code> event, you can prevent the ComboBox from changing the linked cell value due to the up and down arrows. Once you get to the end of your <code>KeyDown</code> or <code>KeyPress</code> event, you can reset the flag for when you want changes to occur.</p>\n\n<p><em>The reason I force the change in the code, rather than let it happen at the end of the <code>Key_Down</code> event (in my case, or <code>KeyPress</code> in yours), is that I can set the flag and run the <code>_Change()</code> event for the combobox with the flag set to prevent the change code from running. Then at the end of the <code>Key</code>event I turn off the flag for any other changes from the user. Because the <code>KeyCode</code> is 0 (or <code>keyAscii</code> equivalent) there, it will not run anything at the end of the function, and thus not update the code again.</em> </p>\n\n<p>Hope that helps, there is a link in that answer to the thread I found, which has some general ideas (though focused on UserForms instead of spreadsheets, so again adapt accordingly, though I have a note in the linked post about that). Good luck!</p>\n\n<p>Note: Those parts of code were what seemed to control this behavior in my sheet, but if you have an issue with getting it to work, I can look at it again.</p>\n"}], "owner": {"reputation": 13, "user_id": 5322287, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/73dc7612976c12c734b78023cedb0d71?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Larson", "link": "https://stackoverflow.com/users/5322287/scott-larson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1873, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1454003575, "creation_date": 1442977410, "last_edit_date": 1446497572, "question_id": 32730280, "link": "https://stackoverflow.com/questions/32730280/stop-combobox-autoselecting-upon-arrow-down", "title": "Stop combobox autoselecting upon arrow down", "body": "<p>I have an ActiveX control combobox in Excel that takes as filters a list of strings by characters typed in the box, where the user then selects the item he/she is searching for. I would like the combobox to allow typing a character, and having the user be able to use the down and up arrows on the keyboard to scan through the list of items in the dropdown. However, when the user uses the down arrow key, the first item in the dropdown is selected and then is the only item remaining.</p>\n\n<p>Also, I would like to be able to use the scroll wheel if possible inside the dropdown list, and have the list sort such that when typing in <code>am,</code> items starting with <code>a</code> are displayed first.</p>\n\n<p>Please let me know if there's something I can do to avoid that behavior.</p>\n\n<p>Here is the code for the combobox:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChangePrior(ByVal Target As Range)\n    cLstPrior = Application.Transpose(Database.UsedRange.Columns(1)) 'set module-level variable\n    Tool.priorCmb.List = cLstPrior        'initialize ComboBox to range Col A (UsedRange only)\n    Tool.priorCmb.ListIndex = -1     'set ComboBox value to empty\nEnd Sub\n\nPrivate Sub priorCmb_Change()\n   filterComboListPrior Tool.priorCmb, cLstPrior\nEnd Sub\n\nPrivate Sub priorCmb_KeyPress(ByVal keyAscii As MSForms.ReturnInteger)\n    Tool.priorCmb.DropDown\nEnd Sub\n\nPrivate Sub priorCmb_GotFocus()   'or _MouseDown()\n    Tool.priorCmb.DropDown\nEnd Sub\n\nPublic Sub filterComboListPrior(ByRef cmbPrior As ComboBox, ByRef dLstPrior As Variant)\n    Dim itmPrior As Variant, lstPrior As String, selPrior As String\n\n    Application.EnableEvents = False\n    With cmbPrior\n        selPrior = .Value\n        If IsEmpty(cLstPrior) Then cLstPrior = Database.UsedRange.Columns(1)\n        For Each itmPrior In cLstPrior\n            If Len(itmPrior) &gt; 1 Then If InStr(1, itmPrior, selPrior, 1) Then lstPrior = lstPrior &amp; itmPrior &amp; \"||\"\n        Next\n        If Len(lstPrior) &gt; 1 Then .List = Split(Left(lstPrior, Len(lstPrior) - 2), \"||\") Else .List = dLstPrior\n    End With\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "combobox", "userform"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1442980001, "post_id": 32730164, "comment_id": 53303097, "body": "<code>Range(&quot;B&quot;)</code> is not a valid range"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1442981179, "post_id": 32730164, "comment_id": 53303357, "body": "@nabilah, is it guaranteed that there is always place (empty row) available to insert a project inside its category?"}, {"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1442982442, "post_id": 32730164, "comment_id": 53303630, "body": "Hi, yes there is always an empty row between each project sizes as seen in the image above unless i could find a code that would allow me to insert new rows and at the same time insert the new project details into the new inserted rows into the category @A.S.H"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1442982550, "post_id": 32730164, "comment_id": 53303663, "body": "Ok, then I will give you a solution in a few time :)"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1442989362, "post_id": 32730164, "comment_id": 53306012, "body": "I suggest you put your data in separate sheets each named with the project size. That way it will be easier to handle addition or even deletion and updating."}, {"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1442989978, "post_id": 32730164, "comment_id": 53306313, "body": "Alright I think that would be a good idea! Thank you! :) but i asked my supervisor regarding this but he still wants to do it all the project sizes in one sheet @L42"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1442992821, "post_id": 32730164, "comment_id": 53307886, "body": "<code>lastrow = Sheets(&quot;Program status summary&quot;).cells(rows.count,&quot;B&quot;).end(xlup).row</code> to find last row. you should also have <code>dim lastrow as long</code> in the beginning"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1442992956, "post_id": 32730164, "comment_id": 53307980, "body": "You may have to attach a sample workbook to your google drive account and supply the link"}], "answers": [{"comments": [{"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1442988372, "post_id": 32731220, "comment_id": 53305538, "body": "Hi, i tried your code but it gave error on the line &#39;: emptyRow = Sheets(&quot;Program status summary&quot;).FindEmptyRow(ComboBoxProjSizes.Text)&#39; which says object does not support this property or method. In addition, i also not sure of how i should set the set of range for my combo box drop down list for each of my project sizes for the &#39;Private Sub ComboBoxProjSizes_Change()&#39; is there any way i could produce the code with your help? @A.S.H"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1442989216, "post_id": 32731220, "comment_id": 53305937, "body": "Hi @nabilah, please take the current version and copy/paste it as is and tell me if it works"}, {"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1442989805, "post_id": 32731220, "comment_id": 53306228, "body": "Hi i tried the code u gave and it gave the error which i have mention above. It says &quot;object does not support this property or method&quot; on the line &quot;emptyRow = Sheets(&quot;Program status summary&quot;).FindEmptyRow(ComboBoxProjSizes.Text)&quot;"}, {"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1442990266, "post_id": 32731220, "comment_id": 53306432, "body": "Also, the Project code is also know as project ID is to be in column B not A"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1442990730, "post_id": 32731220, "comment_id": 53306722, "body": "yes I knew that, but in column A it seems there is some number NO which is very likely automatically generated. You can drop that. p.s: i am fixing the code, few minutes"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1442991181, "post_id": 32731220, "comment_id": 53306981, "body": "@nabilah please try the edited version. I think the idea is there, and it worked with me excpet that i had to &quot;simulate&quot; some of the controls you have. BTW if you dont need to add anything in column A, you can drop that line of code"}, {"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1442991291, "post_id": 32731220, "comment_id": 53307048, "body": "Ok sure thank you! Give me a  minute to try the codes you gave :)"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1442991730, "post_id": 32731220, "comment_id": 53307273, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/90396/discussion-between-a-s-h-and-nabilah\">continue this discussion in chat</a>."}, {"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1442991757, "post_id": 32731220, "comment_id": 53307288, "body": "Hi i tried the code but when i select the &quot;Big project&quot; in the combo box, the new project details actually overwrite one of the occupied rows in the big project category"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1442991720, "last_edit_date": 1442991720, "creation_date": 1442984062, "answer_id": 32731220, "question_id": 32730164, "link": "https://stackoverflow.com/questions/32730164/setting-condition-for-the-combo-box-in-a-user-form/32731220#32731220", "title": "Setting condition for the combo box in a user form", "body": "<pre><code>Private Sub CommandAddButton1_Click()\n  Dim sh As Worksheet: Set sh = ThisWorkbook.Sheets(\"Program status summary\")\n  Dim emptyRow As Integer: emptyRow = 1 + sh.UsedRange.Find(ComboBoxProjSizes.Text).End(xlDown).row\n\n  With sh\n    .Cells(emptyRow, \"A\").Value = 1 + Application.Max(.Columns(1)) ' to generate a new identifier in column 1\n\n    .Cells(emptyRow, \"B\").Value = TextBoxProjCode.Text\n    .Cells(emptyRow, \"C\").Value = TextBoxProjName.Text\n    .Cells(emptyRow, \"D\").Value = TextBoxSector.Text\n    .Cells(emptyRow, \"E\").Value = TextBoxObjective.Text\n    .Cells(emptyRow, \"H\").Value = TextBoxProjSponsor.Text\n    .Cells(emptyRow, \"G\").Value = TextBoxProjSponsorNew.Text\n    .Cells(emptyRow, \"F\").Value = TextBoxProjM.Text\n    .Cells(emptyRow, \"T\").Value = TextBoxRegulatory.Text\n    .Cells(emptyRow, \"N\").Value = TextBoxRiskLvl.Text\n    .Cells(emptyRow, \"M\").Value = TextBoxDatePar.Text\n    .Cells(emptyRow, \"J\").Value = TextBoxCostPar.Text\n    .Cells(emptyRow, \"O\").Value = TextBoxAffectCust.Text\n    .Cells(emptyRow, \"Q\").Value = TextBoxCustNonRetail.Text\n    .Cells(emptyRow, \"P\").Value = TextBoxCustRetail.Text\n    .Cells(emptyRow, \"S\").Value = TextBoxOutsourcingImp.Text\n    .Cells(emptyRow, \"R\").Value = TextBoxKeyStatus.Text\n    .Cells(emptyRow, \"K\").Value = TextBoxSchStart.Text\n    .Cells(emptyRow, \"L\").Value = TextBoxSchEnd.Text\n    .Cells(emptyRow, \"V\").Value = TextBoxRagSchedule.Text\n    .Cells(emptyRow, \"U\").Value = TextBoxRagFinancial.Text\n    .Cells(emptyRow, \"W\").Value = TextBoxRagBenefit.Text\n    .Cells(emptyRow, \"I\").Value = TextBoxCost.Text\n    .Rows(emptyRow+1).Insert\n  End With\n  Unload AddProject\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 882, "favorite_count": 0, "accepted_answer_id": 32731220, "answer_count": 1, "score": 1, "last_activity_date": 1442991720, "creation_date": 1442976367, "last_edit_date": 1531164843, "question_id": 32730164, "link": "https://stackoverflow.com/questions/32730164/setting-condition-for-the-combo-box-in-a-user-form", "title": "Setting condition for the combo box in a user form", "body": "<p>Hi currently i have a user form that look like this for adding of new projects:\n<a href=\"https://i.stack.imgur.com/5TolP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5TolP.png\" alt=\"enter image description here\"></a></p>\n\n<p>In the combo box, the user may select \"Big Project\", \"Medium Project\" and \"Small Project\" sizes. Each project sizes consist of a specific range in the sheet shown below:\n<a href=\"https://i.stack.imgur.com/Iv0W3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Iv0W3.png\" alt=\"enter image description here\"></a></p>\n\n<p>The user would add in the project details into the userform and select the combobox drop down list for the project sizes and the new project details will be added into the empty rows found under each specific project sizes. Unfortunately i am not sure how to do it do in term of ranging each project sizes in the combo box drop down list so that when the user already selected the project sizes and click on the add command button, the new project details will be added to the new row found on the selected project sizes. in Addition, i have some problem with the  command add button that says 'Application-defined or object-defined error' on the codes shown below and not sure if the codes will help to add into the lastrow found on the specific project sizes. I am pretty lost in what to do for both the combobox and command add button.</p>\n\n<pre><code>Private Sub CommandAddButton1_Click()\n\nlastrow = Sheets(\"Program status summary\").Range(\"B\").End(xlDown).Row 'shows the above mention error'\n\n    Cells(lastrow + 1, \"B\").Value = TextBoxProjCode.Text\n    Cells(lastrow + 1, \"C\").Value = TextBoxProjName.Text\n    Cells(lastrow + 1, \"D\").Value = TextBoxSector.Text\n    Cells(lastrow + 1, \"E\").Value = TextBoxObjective.Text\n    Cells(lastrow + 1, \"H\").Value = TextBoxProjSponsor.Text\n    Cells(lastrow + 1, \"G\").Value = TextBoxProjSponsorNew.Text\n    Cells(lastrow + 1, \"F\").Value = TextBoxProjM.Text\n    Cells(lastrow + 1, \"T\").Value = TextBoxRegulatory.Text\n    Cells(lastrow + 1, \"N\").Value = TextBoxRiskLvl.Text\n    Cells(lastrow + 1, \"M\").Value = TextBoxDatePar.Text\n    Cells(lastrow + 1, \"J\").Value = TextBoxCostPar.Text\n    Cells(lastrow + 1, \"O\").Value = TextBoxAffectCust.Text\n    Cells(lastrow + 1, \"Q\").Value = TextBoxCustNonRetail.Text\n    Cells(lastrow + 1, \"P\").Value = TextBoxCustRetail.Text\n    Cells(lastrow + 1, \"S\").Value = TextBoxOutsourcingImp.Text\n    Cells(lastrow + 1, \"R\").Value = TextBoxKeyStatus.Text\n    Cells(lastrow + 1, \"K\").Value = TextBoxSchStart.Text\n    Cells(lastrow + 1, \"L\").Value = TextBoxSchEnd.Text\n    Cells(lastrow + 1, \"V\").Value = TextBoxRagSchedule.Text\n    Cells(lastrow + 1, \"U\").Value = TextBoxRagFinancial.Text\n    Cells(lastrow + 1, \"W\").Value = TextBoxRagBenefit.Text\n    Cells(lastrow + 1, \"I\").Value = TextBoxCost.Text\n\nUnload AddProject\n\nEnd Sub\n</code></pre>\n\n<p>I really hope anyone could assist me with the combo box of the project sizes in inserting the range for each project sizes and the error on the add command button. Any help would be appreciated. Thank you.</p>\n"}, {"tags": ["vba", "excel", "listbox", "userform"], "comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1442972234, "post_id": 32728872, "comment_id": 53301291, "body": "To get any help you&#39;ll need to include your own attempt, and then be specific about the line of code causing you issues, otherwise the question will be down-voted and probably closed"}, {"owner": {"reputation": 21, "user_id": 5365514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QaGcj.png?s=128&g=1", "display_name": "aL a", "link": "https://stackoverflow.com/users/5365514/al-a"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1442973902, "post_id": 32728872, "comment_id": 53301640, "body": "code here, getting data work, but getting comment in texbox5 when click on listbox entries dont work"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 5365514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QaGcj.png?s=128&g=1", "display_name": "aL a", "link": "https://stackoverflow.com/users/5365514/al-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1443211454, "creation_date": 1443211454, "answer_id": 32789836, "question_id": 32728872, "link": "https://stackoverflow.com/questions/32728872/userform-populate-listbox-with-criteria/32789836#32789836", "title": "UserForm populate listbox with criteria", "body": "<p>Adding this code after ListBox1.AddItem solved the problem :</p>\n\n<pre><code>ListBox1.List(ListBox1.ListCount - 1, 1) = nwb.Sheets(\"notes\").Range(\"F\" &amp; row_number)\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5365514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QaGcj.png?s=128&g=1", "display_name": "aL a", "link": "https://stackoverflow.com/users/5365514/al-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1270, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443211454, "creation_date": 1442965812, "last_edit_date": 1442973646, "question_id": 32728872, "link": "https://stackoverflow.com/questions/32728872/userform-populate-listbox-with-criteria", "title": "UserForm populate listbox with criteria", "body": "<p>I have a database with five columns in a different workbook called db.xls : \n<strong>userid - date - name - subject - comments</strong></p>\n\n<p>I fill this with a data entry form (works fine). The problem is in a UserForm, I need to retrieve specific entries on a specific criteria in a listbox. I need to put the <strong>name</strong> AND <strong>subject</strong> in two textboxes or dropdown lists and with these two criteria populate a listbox, in a ascending order by <strong>date + the subject</strong> and when I click on any listbox entries, it lookup and give me the comment that goes with that line in textbox.</p>\n\n<p><strong>CODE :</strong> </p>\n\n<pre><code>Private Sub searchbutton_Click()\n\nDim nwb As Workbook\n\nApplication.ScreenUpdating = False\n\nSet nwb = Workbooks.Open(\"C:\\db.xls\", _\nFalse, True)\n\ntxtsubject.Text = \"\"\n\nSet xSht = nwb.Sheets(\"notes\")\n    Lastrow = xSht.Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n    strSearch = txtname.Text\n                Set aCell = xSht.Range(\"C1:C\" &amp; Lastrow).Find(What:=strSearch, LookIn:=xlFormulas, _\nLookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\nMatchCase:=False, SearchFormat:=False)\n\n  If Not aCell Is Nothing And txtsubject.Value = \"\" Then\n     GoTo refvalid\n Else\nMsgBox \"no entries for \" &amp; txtname.Value &amp; \". \", Title:=\"result of search\"\n    End If\nExit Sub\nrefvalid:\n\nrow_number = 0\nListBox1.Clear\nDo\nDoEvents\nrow_number = row_number + 1\nitem_in_review = nwb.Sheets(\"notes\").Range(\"C\" &amp; row_number)\nIf item_in_review = txtname.Text Then\ntxtsubject.Text = nwb.Sheets(\"notes\").Range(\"A\" &amp; row_number)\n'concatenated date + subject in column F\nListBox1.AddItem nwb.Sheets(\"notes\").Range(\"F\" &amp; row_number) \n\nEnd If\nLoop Until item_in_review = \"\"\n'in module, sortlistbox to order then ascending\nRun \"SortListBox\", ListBox1, 0, 1, 1\n\nnwb.Close False ' close the source workbook without saving changes\nSet nwb = Nothing\nApplication.ScreenUpdating = True\nWith ListBox1\n\n.ColumnCount = 5\n.MultiSelect = fmMultiSelectSingle\n.TextColumn = 1\n.BoundColumn = 1\nIf ListBox1.Value &lt;&gt; \"\" Then\nTextBox35.Value = \" [\" &amp; ListBox1.Text &amp; \"] : \" &amp; ListBox1.Value\nEnd If\n\nEnd With\nEnd Sub\n\n'====================================================\n\nPrivate Sub ListBox1_Click()\nIf ListBox1.Value &lt;&gt; \"\" Then\nTextBox5.Value = \" [\" &amp; ListBox1.Text &amp; \"] : \" &amp; ListBox1.Value\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba", "click", "anchor"], "comments": [{"owner": {"reputation": 9199, "user_id": 4786421, "user_type": "registered", "accept_rate": 92, "profile_image": "https://graph.facebook.com/10204307962041767/picture?type=large", "display_name": "Adam Buchanan Smith", "link": "https://stackoverflow.com/users/4786421/adam-buchanan-smith"}, "edited": false, "score": 0, "creation_date": 1442965397, "post_id": 32728748, "comment_id": 53299689, "body": "I think a more important question would be why does a page that has 2.4MB take 13 seconds to load?!?!?!?!"}], "owner": {"reputation": 11, "user_id": 5365423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b8dd1ee56d31af633057615115b7a67?s=128&d=identicon&r=PG&f=1", "display_name": "strohs7", "link": "https://stackoverflow.com/users/5365423/strohs7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1443048906, "creation_date": 1442965010, "last_edit_date": 1443048906, "question_id": 32728748, "link": "https://stackoverflow.com/questions/32728748/click-on-anchor-tag", "title": "&quot;Click&quot; on anchor tag", "body": "<p>EDIT 2: SOLVED.  I had to directly navigate to the src link in the iFrame... Thanks for all the help, you guys!</p>\n\n<p>I've been trying to figure out how to click on the \"Download Table\" button from the website <a href=\"http://war-on-ice.com/playertable.html\" rel=\"nofollow\">http://war-on-ice.com/playertable.html</a> ... relevant HTML code below:</p>\n\n<pre><code>    &lt;a class=\"btn shiny-download-link shiny-bound-output\" id=\"downloadData\" href=\"session/3d9eec9b00fc33032587b8b094e0a7b8/download/downloadData?w=\" target=\"_blank\"&gt;\n      &lt;i class=\"fa fa-download\"&gt;&lt;/i&gt;\n      Download Table\n    &lt;/a&gt;\n</code></pre>\n\n<p>When I click the button, it will download a .CSV file but the url changes every time the page is refreshed, so I can't navigate directly to the url.</p>\n\n<p>I've tried a bunch of codes and have been googling for a couple days... it seems that the button is actually an Anchor (from what I can tell.. I'm not too experienced with coding).  This is the VBA code I have so far:</p>\n\n<pre><code>    Sub ClickDownload()\n\n    Dim IE As Object\n    Set IE = CreateObject(\"InternetExplorer.application\")\n        IE.Navigate (\"http://war-on-ice.com/playertable.html\")\n        IE.Visible = True\n\n    Do While IE.ReadyState &lt;&gt; 4 'READYSTATE_COMPLETE\n        DoEvents\n    Loop\n\n    For i = 0 To IE.Document.All.Length - 1 'lists through all elements on web page'\n        If IE.Document.All(i).ID = \"downloadData\" Then 'if anchor id is \"downloadData\"\n            IE.Document.All(i).Click 'then click on it'\n        End If\n    Next i\n\n    End Sub\n</code></pre>\n\n<p>The code opens the website, but nothing happens after that (it never finds a match for the If Statement).</p>\n\n<p>Any help on this would be awesome.  Thanks! </p>\n\n<p>EDIT: I think this is inside an iframe, which might be causing a problem?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1442966209, "post_id": 32728565, "comment_id": 53299913, "body": "&quot;I am now just having an issue&quot; - always helps to explain exactly what the problem is."}], "answers": [{"tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 0, "last_activity_date": 1442968276, "creation_date": 1442968276, "answer_id": 32729190, "question_id": 32728565, "link": "https://stackoverflow.com/questions/32728565/cell-output-for-variable-sum/32729190#32729190", "title": "Cell Output for variable sum", "body": "<p>Try this:</p>\n\n<pre><code>Private Sub MC()\n    Dim c&amp;, i&amp;, j&amp;\n    Worksheets(\"SC\").Cells.Clear\n    For j = 1 To Worksheets(\"Data\").Cells(1, Columns.Count).End(xlToLeft).Column\n        For i = 1 To Worksheets(\"Data\").Cells(Rows.Count, \"A\").End(xlUp).Row\n            If Worksheets(\"Data\").Cells(i, j) &gt; 0 Then\n                c = RGB(Int(Rnd * 255) + 1, Int(Rnd * 255) + 1, Int(Rnd * 255) + 1)\n                Worksheets(\"SC\").Cells(i, j) = SumAndColorCone(Worksheets(\"Data\").Cells(i, j), c, Worksheets(\"SC\"))\n            Else\n                If Worksheets(\"Data\").Cells(i, j) &lt;= \"0\" Then Worksheets(\"SC\").Cells(i, j) = \"0\"\n            End If\n        Next\n    Next\nEnd Sub\n\nPrivate Function SumAndColorCone(r As Range, Color&amp;, wsColor As Worksheet) As Double\n    Dim i&amp;, k&amp;, c As Range\n    Set c = r\n    For i = r.Row - 1 To 1 Step -1\n        If r.Column - k &lt; 2 Then\n            Set c = Union(c, r(-k, -r.Column + 2).Resize(, r.Column + k + 1))\n        Else\n            Set c = Union(c, r(-k, -k).Resize(, (k + 1) * 2 + 1))\n        End If\n        k = k + 1\n    Next\n    SumAndColorCone = Application.Sum(c)\n    If SumAndColorCone &gt;= 1 Then\n        wsColor.Range(c.Address).Interior.Color = Color\n    Else\n        SumAndColorCone = 0\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 5327399, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153131737536616/picture?type=large", "display_name": "Pat Dillon", "link": "https://stackoverflow.com/users/5327399/pat-dillon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 32729190, "answer_count": 1, "score": 0, "last_activity_date": 1442968363, "creation_date": 1442963905, "last_edit_date": 1531161705, "question_id": 32728565, "link": "https://stackoverflow.com/questions/32728565/cell-output-for-variable-sum", "title": "Cell Output for variable sum", "body": "<p>Code appears to be running smoothly, I am now just having an issue with the output of the sum and color once it has been calculated, I am trying to print the outputs to the \"SC\" worksheet so they can be further analysed. So the Output in the new worksheet should build a matrix with the irrelevant values (sum or value &lt;1) 0 and the sum values shown in the respective cell.</p>\n\n<pre><code>Private Sub MC()\n    Dim c&amp;, i&amp;, j&amp;\n    Worksheets(\"SC\").Cells.Clear\n    For j = 1 To Worksheets(\"Data\").Cells(1, Columns.Count).End(xlToLeft).Column\n        For i = 1 To Worksheets(\"Data\").Cells(Rows.Count, \"A\").End(xlUp).Row\n            If Worksheets(\"Data\").Cells(i, j) &gt; 0 Then\n                c = RGB(Int(Rnd * 255) + 1, Int(Rnd * 255) + 1, Int(Rnd * 255) + 1)\n               'Debug.Print \"Testing value at: \" &amp; Cells(i, j).Address &amp; vbLf &amp; \"Cone sum: \" &amp; SumAndColorCone(Cells(i, j), c) &amp; vbLf\n               Worksheets(\"SC\").Cells(i, j) = \"Testing value at: \" &amp; Cells(i, j).Address &amp; vbLf &amp; \"Cone sum: \" &amp; SumAndColorCone(Cells(i, j), c) &amp; vbLf\n\n            Else: If Worksheets(\"Data\").Cells(i, j) &lt;= \"0\" Then Worksheets(\"SC\").Cells(i, j) = \"0\"\n\n            End If\n\n        Next\n    Next\nEnd Sub\n\nPrivate Function SumAndColorCone(r As Range, color&amp;) As Double\n    Dim i&amp;, k&amp;, c As Range\n    Set c = r\n    For i = r.Row - 1 To 1 Step -1\n        If r.Column - k &lt; 2 Then\n            Set c = Union(c, r(-k, -r.Column + 2).Resize(, r.Column + k + 1))\n        Else\n            Set c = Union(c, r(-k, -k).Resize(, (k + 1) * 2 + 1))\n        End If\n        k = k + 1\n    Next\n    SumAndColorCone = Application.Sum(c)\n    If SumAndColorCone &gt; 1 Then c.Interior.color = color\n    'If value of sum is less than 1 return \"0\"\n    If SumAndColorCone &lt; 1 Then SumAndColorCone = \"0\"\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 4, "creation_date": 1510538051, "post_id": 32728334, "comment_id": 81463001, "body": "Also you can&#39;t use <code>Exit While</code>."}, {"owner": {"reputation": 362, "user_id": 2752308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574f9f2cb6733e7ebcdd340d6ec14b25?s=128&d=identicon&r=PG&f=1", "display_name": "Marcelo Scofano Diniz", "link": "https://stackoverflow.com/users/2752308/marcelo-scofano-diniz"}, "reply_to_user": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1587400571, "post_id": 32728334, "comment_id": 108491492, "body": "@PortlandRunner, your link is pointing to a VB.NET resource; there, it shows that Exit While does exist, but it not applies to VBA; <a href=\"https://docs.microsoft.com/pt-br/office/vba/language/reference/user-interface-help/whilewend-statement\" rel=\"nofollow noreferrer\">correct VBA link is here</a>."}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "reply_to_user": {"reputation": 362, "user_id": 2752308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574f9f2cb6733e7ebcdd340d6ec14b25?s=128&d=identicon&r=PG&f=1", "display_name": "Marcelo Scofano Diniz", "link": "https://stackoverflow.com/users/2752308/marcelo-scofano-diniz"}, "edited": false, "score": 0, "creation_date": 1587401523, "post_id": 32728334, "comment_id": 108492013, "body": "@MarceloScofano - good catch.  Since there are so many answers given after I made the first comment I&#39;ve deleted it as it&#39;s really no longer of any value."}], "answers": [{"comments": [{"owner": {"reputation": 288, "user_id": 5356938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9046a05c37f91d4bd2b5c6b561a0bc64?s=128&d=identicon&r=PG&f=1", "display_name": "umLu", "link": "https://stackoverflow.com/users/5356938/umlu"}, "edited": false, "score": 3, "creation_date": 1442964007, "post_id": 32728425, "comment_id": 53299282, "body": "Interesting, but that seems to be the difference between &quot;do loop&quot; and &quot;do while loop&quot;. Not really what I asked for."}], "tags": [], "owner": {"reputation": 1614, "user_id": 4552326, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/f1LTL.jpg?s=128&g=1", "display_name": "David BS", "link": "https://stackoverflow.com/users/4552326/david-bs"}, "is_accepted": false, "score": 0, "last_activity_date": 1552914819, "last_edit_date": 1552914819, "creation_date": 1442963044, "answer_id": 32728425, "question_id": 32728334, "link": "https://stackoverflow.com/questions/32728334/do-while-loop-and-while-wend-loop-whats-the-difference/32728425#32728425", "title": "&quot;Do While&quot; &quot;Loop&quot; and &quot;While&quot; &quot;Wend&quot; Loop. What&#39;s the difference?", "body": "<p>In fact, you don\u00b4t need \"DO WHILE\" since you may \"DO-LOOP\" without \"While\".</p>\n\n<p>I utilize \"DO LOOP\" if I need to perform an action at least one time (or several times) with no implicit condition, as the WHILE-WEND forces.</p>\n\n<p>Just for an instance, a kind of alarm clock:</p>\n\n<pre><code>  Do\n    Display Time at screen\n    Sounds a buzz\n    if user confirm\n       exit do\n    end if\n  Loop\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 288, "user_id": 5356938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9046a05c37f91d4bd2b5c6b561a0bc64?s=128&d=identicon&r=PG&f=1", "display_name": "umLu", "link": "https://stackoverflow.com/users/5356938/umlu"}, "edited": false, "score": 0, "creation_date": 1443010108, "post_id": 32735141, "comment_id": 53318866, "body": "As for speed seems pretty much the same to me. Why would be created a loop that is exactly the same, just without some features? A user has commented (and was deleted don&#39;t know why) that &quot;While Wend&quot; would be an older version of &quot;Do While&quot; maintained for backward compatibility. Do you know if that&#39;s true? @vsoraas"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 288, "user_id": 5356938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9046a05c37f91d4bd2b5c6b561a0bc64?s=128&d=identicon&r=PG&f=1", "display_name": "umLu", "link": "https://stackoverflow.com/users/5356938/umlu"}, "edited": false, "score": 1, "creation_date": 1443011527, "post_id": 32735141, "comment_id": 53319902, "body": "@umLu I would not know for sure, but it would seem logical that <code>While Wend</code> came first, and then <code>Do While</code> is introduced later with additional and better syntax and features."}], "tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": false, "score": 7, "last_activity_date": 1442998714, "creation_date": 1442998714, "answer_id": 32735141, "question_id": 32728334, "link": "https://stackoverflow.com/questions/32728334/do-while-loop-and-while-wend-loop-whats-the-difference/32735141#32735141", "title": "&quot;Do While&quot; &quot;Loop&quot; and &quot;While&quot; &quot;Wend&quot; Loop. What&#39;s the difference?", "body": "<p>I don't think there is much of a difference in their execution other than the syntactical options that <code>While Wend</code>is not capable of:</p>\n\n<pre><code>Do\n    someCode\nWhile (someCondition)\n</code></pre>\n\n<p>As for speed, I did a simple test:</p>\n\n<pre><code>Sub whileLoopTest()\nDim i As Long, j As Long\nDim StartTime As Variant\n\ni = 1\nStartTime = Timer\n\nWhile (i &lt; 500000000)\n    j = i + 2\n    i = i + 1\nWend\n\nDebug.Print \"While execution time: \" &amp; Timer - StartTime\nEnd Sub\n\n\nSub doWhileTest()\nDim i As Long, j As Long\nDim StartTime As Variant\n\ni = 1\nStartTime = Timer\n\nDo While (i &lt; 500000000)\n    j = i + 2\n    i = i + 1\nLoop\n\nDebug.Print \"Do While execution time: \" &amp; Timer - StartTime\nEnd Sub\n</code></pre>\n\n<p>Results:</p>\n\n<pre><code>While execution time: 6,429688  \nWhile execution time: 6,429688\nWhile execution time: 6,441406\nDo While execution time: 6,429688\nDo While execution time: 6,449219\nDo While execution time: 6,4375\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 288, "user_id": 5356938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9046a05c37f91d4bd2b5c6b561a0bc64?s=128&d=identicon&r=PG&f=1", "display_name": "umLu", "link": "https://stackoverflow.com/users/5356938/umlu"}, "edited": false, "score": 0, "creation_date": 1443009529, "post_id": 32738558, "comment_id": 53318508, "body": "Isn&#39;t there an &quot;Exit While&quot; in VBA? Also a user has commented that &quot;While Wend&quot; would be an older version of &quot;Do While&quot; maintained for backward compatibility. Do you know if that&#39;s true? @NeepNeepNeep"}, {"owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "reply_to_user": {"reputation": 288, "user_id": 5356938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9046a05c37f91d4bd2b5c6b561a0bc64?s=128&d=identicon&r=PG&f=1", "display_name": "umLu", "link": "https://stackoverflow.com/users/5356938/umlu"}, "edited": false, "score": 2, "creation_date": 1443010600, "post_id": 32738558, "comment_id": 53319229, "body": "&quot;Exit While&quot; does not exist &amp; yes, I believe While/Wend is maintained for backward compatibility.  Really, it&#39;s going to be Do/Loop that you should be using."}, {"owner": {"reputation": 4133, "user_id": 279112, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/M0IaD.jpg?s=128&g=1", "display_name": "Panzercrisis", "link": "https://stackoverflow.com/users/279112/panzercrisis"}, "edited": false, "score": 0, "creation_date": 1508432781, "post_id": 32738558, "comment_id": 80618083, "body": "@vsoraas &#39;s comment doesn&#39;t seem to be showing up anymore."}, {"owner": {"reputation": 3952, "user_id": 1945782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zsM5t.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/1945782/paul"}, "edited": false, "score": 0, "creation_date": 1552577086, "post_id": 32738558, "comment_id": 97071783, "body": "Just to add to this, <code>Repeat ... Until</code> is the legacy version of <code>Do ... Loop While</code> (though I do recall seeing a version of <code>Do ... Loop Until</code>, but I can&#39;t recall if that was in VBA or another flavour of Basic)."}, {"owner": {"reputation": 544, "user_id": 9665272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t6vN0.jpg?s=128&g=1", "display_name": "Superior", "link": "https://stackoverflow.com/users/9665272/superior"}, "edited": false, "score": 0, "creation_date": 1590097202, "post_id": 32738558, "comment_id": 109559724, "body": "does wend not do things 1 &amp; 2"}], "tags": [], "owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "is_accepted": true, "score": 32, "last_activity_date": 1508685303, "last_edit_date": 1508685303, "creation_date": 1443008294, "answer_id": 32738558, "question_id": 32728334, "link": "https://stackoverflow.com/questions/32728334/do-while-loop-and-while-wend-loop-whats-the-difference/32738558#32738558", "title": "&quot;Do While&quot; &quot;Loop&quot; and &quot;While&quot; &quot;Wend&quot; Loop. What&#39;s the difference?", "body": "<p>An answer I referred to is no longer visible, but this answer still holds true.  While/Wend is a hangover from Basic and Do/Loop should be your preferred syntax because:<br></p>\n\n<ol>\n<li>It supports checking the condition <b>before</b> entering the loop<code>\nDo While [condition] ... Loop</code> (zero or more loop executions)</li>\n<li>It supports checking the condition <b>after</b> entering the loop<code>\nDo ... Loop While [condition]</code> (one or more loop executions)</li>\n<li>It supports no specific condition<code>\nDo ...(some logic) (Exit Do) ... Loop</code> (one or more loop executions, potentially infinite)</li>\n</ol>\n"}], "owner": {"reputation": 288, "user_id": 5356938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9046a05c37f91d4bd2b5c6b561a0bc64?s=128&d=identicon&r=PG&f=1", "display_name": "umLu", "link": "https://stackoverflow.com/users/5356938/umlu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39113, "favorite_count": 7, "accepted_answer_id": 32738558, "answer_count": 3, "score": 24, "last_activity_date": 1552914819, "creation_date": 1442962489, "last_edit_date": 1531164843, "question_id": 32728334, "link": "https://stackoverflow.com/questions/32728334/do-while-loop-and-while-wend-loop-whats-the-difference", "title": "&quot;Do While&quot; &quot;Loop&quot; and &quot;While&quot; &quot;Wend&quot; Loop. What&#39;s the difference?", "body": "<p>Reading some answers in stackoverflow I saw a <code>while</code> <code>wend</code> loop. I'm used to the <code>do while</code> <code>loop</code>, so I was wondering what would be the difference between this two loops.</p>\n\n<p>I did some testing (code below) and both seem to give me the same results.</p>\n\n<pre><code>Sub test_loop_1()\nDim i As Integer\ni = 1\nDo While i &lt; 10\n    Cells(i, 1) = i\n    i = i + 1\nLoop\n\nEnd Sub\n\nSub test_loop_2()\nDim i As Integer\ni = 1\nWhile i &lt; 10\n    Cells(i, 1) = i\n    i = i + 1\nWend\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 18656, "user_id": 355931, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/16121b31590e34cfbd754a162bb88120?s=128&d=identicon&r=PG", "display_name": "Barranka", "link": "https://stackoverflow.com/users/355931/barranka"}, "edited": false, "score": 1, "creation_date": 1442960955, "post_id": 32727956, "comment_id": 53298281, "body": "<a href=\"http://whathaveyoutried.com\" rel=\"nofollow noreferrer\">Any attempts</a>? Please post whatever you&#39;ve tried to solve this."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1442961205, "post_id": 32727956, "comment_id": 53298367, "body": "You want to remove every appearence of - in a given range?"}], "answers": [{"comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1442973105, "post_id": 32728122, "comment_id": 53301465, "body": "Thanks - these are my rare attempts at formulas (I always jump to code) and your answer inspired me"}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 1, "last_activity_date": 1442961362, "creation_date": 1442961362, "answer_id": 32728122, "question_id": 32727956, "link": "https://stackoverflow.com/questions/32727956/how-to-convert-dashed-word-into-camelcase/32728122#32728122", "title": "How to convert dashed word into camelcase", "body": "<p>I imagine only VBA is going to be practical for you, but with a formula, copied across:  </p>\n\n<pre><code>=SUBSTITUTE(A1,MID(A1,FIND(\"-\",A1),2),UPPER(MID(A1,FIND(\"-\",A1)+1,1)))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 4, "last_activity_date": 1442962245, "creation_date": 1442962245, "answer_id": 32728284, "question_id": 32727956, "link": "https://stackoverflow.com/questions/32727956/how-to-convert-dashed-word-into-camelcase/32728284#32728284", "title": "How to convert dashed word into camelcase", "body": "<p>Try this small <em>UDF()</em>:</p>\n\n<pre><code>Public Function DashFixer(inpt As String) As String\n   If inpt = \"\" Then\n      DashFixer = \"\"\n      Exit Function\n   End If\n\n   ary = Split(inpt, \"-\")\n   For i = LBound(ary) + 1 To UBound(ary)\n      ary(i) = Application.WorksheetFunction.Proper(ary(i))\n   Next i\n   DashFixer = Join(ary, \"\")\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/yasb6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yasb6.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 3, "last_activity_date": 1442971282, "creation_date": 1442971282, "answer_id": 32729535, "question_id": 32727956, "link": "https://stackoverflow.com/questions/32727956/how-to-convert-dashed-word-into-camelcase/32729535#32729535", "title": "How to convert dashed word into camelcase", "body": "<p>Other versions:</p>\n\n<pre><code>Public Function dCam(ByRef cel As String) As String\n\n    dCam = Replace(StrConv(Replace(cel, \"-\", \" \"), vbProperCase), \" \", \"\")  'MyDashedWord\n\n    dCam = LCase(Left(dCam, 1)) &amp; Right(dCam, Len(dCam) - 1)                'myDashedWord\n\nEnd Function\n</code></pre>\n\n<hr>\n\n<pre><code>=SUBSTITUTE(PROPER(A1),\"-\",\"\") 'MyDashedWord\n\n=LEFT(A1) &amp; RIGHT(SUBSTITUTE(PROPER(A1),\"-\",\"\"),LEN(SUBSTITUTE(A1,\"-\",\"\"))-1) 'myDashedWord\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1442972648, "creation_date": 1442972648, "answer_id": 32729699, "question_id": 32727956, "link": "https://stackoverflow.com/questions/32727956/how-to-convert-dashed-word-into-camelcase/32729699#32729699", "title": "How to convert dashed word into camelcase", "body": "<p>One more version.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/M8ue1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M8ue1.png\" alt=\"Dashed Word Extraction\"></a></p>\n\n<p>The formula in B2 is,</p>\n\n<pre><code>=LEFT(A2, FIND(\"-\", A2&amp;\"- \")-1)&amp;SUBSTITUTE(PROPER(MID(A2, FIND(\"-\", A2&amp;\"- \")+1, 255)), \"-\", \"\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 1, "last_activity_date": 1443012405, "last_edit_date": 1443012405, "creation_date": 1442990297, "answer_id": 32732655, "question_id": 32727956, "link": "https://stackoverflow.com/questions/32727956/how-to-convert-dashed-word-into-camelcase/32732655#32732655", "title": "How to convert dashed word into camelcase", "body": "<p>Nowhere near as efficient as I would have liked as there isn't a way to to a one shot replacement along the lines of </p>\n\n<pre><code>.Pattern = \"\\-([a-z)([a-z]+)\"\nSet objRegexMC = .Replace(strIn, UCase(\"$1\") &amp; \"$2\")\n</code></pre>\n\n<p>but as I did go there with a <code>RegExp</code> here it is.</p>\n\n<pre><code>Function StrCon1(strIn As String) As String\nDim objRegex As Object\nDim objRegexMC As Object\nDim objRegexM As Object\n\nSet objRegex = CreateObject(\"vbscript.regexp\")\nWith objRegex\n    .Global = True\n    .Pattern = \"\\-([a-z])([a-z]+)\"\nSet objRegexMC = .Execute(strIn)\nFor Each objRegexM In objRegexMC\n    strIn = Replace(strIn, objRegexM,UCase$(objRegexM.submatches(0)) &amp; objRegexM.submatches(1))\nNext\nEnd With\n\nStrCon1 = strIn\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 8814, "user_id": 3231690, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/06dce770d18a0e4537fcef0ef86a63e2?s=128&d=identicon&r=PG&f=1", "display_name": "Zuriar", "link": "https://stackoverflow.com/users/3231690/zuriar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3327, "favorite_count": 0, "closed_date": 1443056631, "accepted_answer_id": 32728284, "answer_count": 5, "score": 0, "last_activity_date": 1443012405, "creation_date": 1442960576, "last_edit_date": 1531161705, "question_id": 32727956, "link": "https://stackoverflow.com/questions/32727956/how-to-convert-dashed-word-into-camelcase", "closed_reason": "Needs more focus", "title": "How to convert dashed word into camelcase", "body": "<p>Is there a way to convert</p>\n\n<pre><code>my-dashed-word\n</code></pre>\n\n<p>into</p>\n\n<pre><code>myDashedWord\n</code></pre>\n\n<p>in Excel?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1442959478, "creation_date": 1442959478, "answer_id": 32727720, "question_id": 32727551, "link": "https://stackoverflow.com/questions/32727551/add-a-drill-down-and-add-a-time-stamp/32727720#32727720", "title": "Add a drill down and add a time stamp", "body": "<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n\n    Dim fn As Integer\n    Dim ts As Integer\n\n    If Target.Cells.CountLarge &gt; 1 Then Exit sub\n\n    If Not Intersect(Target, Me.Range(\"AC7:AC42\")) Is Nothing Then\n        If Target.Value = \"Final\" Then\n            ActiveSheet.Unprotect\n            With Target.EntireRow.Cells(1, \"AD\") \n                .NumberFormat = \"mm/dd/yy hh:mm AM/PM\"     \n                .Value = Now\n                .Locked = False\n            End with\n            ActiveSheet.Unprotect '&lt;&lt;&lt;Protect?\n        End If  'is Final\n    End If      'is in AC\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 1332019, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/eb79c6c769d6c3231a82dfc5721439de?s=128&d=identicon&r=PG", "display_name": "cemg", "link": "https://stackoverflow.com/users/1332019/cemg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 32727720, "answer_count": 1, "score": 0, "last_activity_date": 1442962063, "creation_date": 1442958665, "last_edit_date": 1531161705, "question_id": 32727551, "link": "https://stackoverflow.com/questions/32727551/add-a-drill-down-and-add-a-time-stamp", "title": "Add a drill down and add a time stamp", "body": "<p>I have this spreadsheet to reconcile data. So once I received final data, I reconciled it to an internal system vs external system.  </p>\n\n<p>What I am trying to add to the spreadsheet is two columns to record once\ndata is \"Final\" or \"Under Reviewed\":</p>\n\n<p>Column AC: I have a Drill Down with \"Final\" or \"Under Reviewed\"\nColumn AD: is where I want to add the Time Stamp</p>\n\n<p>I have the following Excel VBA code, but it stamps the time stamp on same cell as the drill down once Final is selected.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n\nDim fn As Integer\nDim ts As Integer\n\nActiveSheet.Unprotect\n\nIf Not Intersect(Target, Range(\"AC7:AC42\")) Is Nothing Then\n\nfn = [AC7:AC42].Find(Target.Value).Column\n\n\nIf Cells(Target.Row, fn) = \"Final\" Then\nCells(Target.Row, fn).Value = Now\nCells(Target.Row, fn).NumberFormat = \"mm/dd/yy hh:mm AM/PM\"\nCells(Target.Row, fn).Locked = False\nEnd If\nEnd If\nActiveSheet.Unprotect\nEnd Sub\n</code></pre>\n\n<p>So this code right now adds the TIMESTAMP if I select \"Final\" from the Drill Down list in the same column cell.</p>\n\n<p>I want the drill down selection in Column AC and the Time Stamp on Column AD.</p>\n\n<p>I know I am missing a step or a block of code but just can't figure it out.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1442957177, "post_id": 32727189, "comment_id": 53296769, "body": "Try putting this <code>Range(r,r.offset(,1)).copy r.offset(,15)</code> in place of <code>r.Copy r.Offset(0, 15)</code>"}, {"owner": {"reputation": 317, "user_id": 3897155, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e6fc777dbccdd3f1e8fb4380337b4729?s=128&d=identicon&r=PG&f=1", "display_name": "mb1987", "link": "https://stackoverflow.com/users/3897155/mb1987"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1442957621, "post_id": 32727189, "comment_id": 53296990, "body": "thanks yes it works but I want only for data that is numeric on first 3 characters and - on forth character something like 888-fdersfdf"}], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 0, "last_activity_date": 1442959358, "last_edit_date": 1442959358, "creation_date": 1442958511, "answer_id": 32727517, "question_id": 32727189, "link": "https://stackoverflow.com/questions/32727189/offset-data-from-one-column-to-another-based-on-specific-condition/32727517#32727517", "title": "Offset data from one column to another based on specific condition", "body": "<pre><code>Sub data_shifter()\n    Dim r As Range\n    For Each r In ActiveSheet.UsedRange.Columns(1).Cells\n      If IsNumeric(Left(r, 3)) And Mid(r, 4, 1) = \"-\" Then\n        r.Resize(1, 2).Copy r.Offset(0, 15)\n        r.Clear\n      End If\n    Next r\n    ActiveWorkbook.Save\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1442959489, "creation_date": 1442959489, "answer_id": 32727722, "question_id": 32727189, "link": "https://stackoverflow.com/questions/32727189/offset-data-from-one-column-to-another-based-on-specific-condition/32727722#32727722", "title": "Offset data from one column to another based on specific condition", "body": "<p>My two cents,</p>\n\n<pre><code>Sub Button1_Click()\n\n    Dim rng As Range, c As Range    \n    Set rng = Range(\"A:A\").SpecialCells(xlCellTypeConstants, 23)\n    For Each c In rng.Cells\n        If IsNumeric(Mid(c, 1, 3)) Then\n\n            MsgBox \" Do your thing\"    'what ever you want after that\n        End If\n    Next c\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 317, "user_id": 3897155, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e6fc777dbccdd3f1e8fb4380337b4729?s=128&d=identicon&r=PG&f=1", "display_name": "mb1987", "link": "https://stackoverflow.com/users/3897155/mb1987"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 32727517, "answer_count": 2, "score": -1, "last_activity_date": 1442959489, "creation_date": 1442956978, "last_edit_date": 1531161705, "question_id": 32727189, "link": "https://stackoverflow.com/questions/32727189/offset-data-from-one-column-to-another-based-on-specific-condition", "title": "Offset data from one column to another based on specific condition", "body": "<p>I want to offset some data to another column. The data exist in column A and B. The code I am using is:</p>\n\n<pre><code>Sub data_shifter()\nDim A As Range, r As Range\nSet A = Intersect(ActiveSheet.UsedRange, Range(\"A:A\"))\n\nFor Each r In A\n\n    If Mid(r, 4, 1) = \"-\" Then\n        r.Copy r.Offset(0, 15)\n        r.Clear\n    End If\nNext r\n\nActiveWorkbook.Save\n\nEnd Sub\n</code></pre>\n\n<p>This code is looking for all the strings in column A where <code>-</code> is the fourth character. What I want is the first three characters should be numeric and the fourth character is <code>-</code>. Also, if the above situation is true the data in column B should be offset too.</p>\n\n<p>For example, if column A2 has <code>333-m1233232</code> it should offset to p2 and data in column B2 should offset to Q2</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 10110, "user_id": 1715829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c0yet.jpg?s=128&g=1", "display_name": "Buddy", "link": "https://stackoverflow.com/users/1715829/buddy"}, "edited": false, "score": 0, "creation_date": 1442955802, "post_id": 32726831, "comment_id": 53296115, "body": "Two <code>For</code> loops (one inside of the other) should work..."}, {"owner": {"reputation": 127, "user_id": 1775965, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ysNho.jpg?s=128&g=1", "display_name": "Eyrik", "link": "https://stackoverflow.com/users/1775965/eyrik"}, "reply_to_user": {"reputation": 10110, "user_id": 1715829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c0yet.jpg?s=128&g=1", "display_name": "Buddy", "link": "https://stackoverflow.com/users/1715829/buddy"}, "edited": false, "score": 0, "creation_date": 1442956265, "post_id": 32726831, "comment_id": 53296361, "body": "Ive been messing around with two For loops inside of eachother, but cant get it to work as all"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1442956392, "post_id": 32726831, "comment_id": 53296412, "body": "Show what you have tried and we can help figure out the problem."}, {"owner": {"reputation": 127, "user_id": 1775965, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ysNho.jpg?s=128&g=1", "display_name": "Eyrik", "link": "https://stackoverflow.com/users/1775965/eyrik"}, "edited": false, "score": 0, "creation_date": 1442957249, "post_id": 32726831, "comment_id": 53296808, "body": "<code>Dim counter1 As Integer         Dim counter2 As Integer          For counter1 = 10 To 1 Step -1             For counter2 = 1 To 10                  ListBox1.Items.Add()               Next counter2         Next counter1</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1442957573, "post_id": 32726831, "comment_id": 53296964, "body": "<i>Edit your question</i> to add code - code in comments is difficult to read..."}], "answers": [{"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 3, "last_activity_date": 1442974673, "last_edit_date": 1442974673, "creation_date": 1442973437, "answer_id": 32729805, "question_id": 32726831, "link": "https://stackoverflow.com/questions/32726831/vba-listbox-and-loop/32729805#32729805", "title": "VBA Listbox and loop", "body": "<p>Your problem is not with using the Loops alone but with using the <code>ListBox</code> Methods.<br> You can achieve what you want in 2 ways:</p>\n\n<ol>\n<li>Initially concatenate (connect) the numbers into a single string and then add it on the Listbox using <code>AddItem</code> Method.</li>\n<li>Populate a multicolumn <code>ListBox</code> using a nested loop using <code>AddItem</code> and <code>List</code> method.</li>\n</ol>\n\n<p>The first one should be something like below:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim i As Integer, j As Integer, k As Integer\n    Dim s As String\n\n    k = 11 ' this determines the exit condition\n    For i = 1 To 10\n        For j = 1 To 10\n            If k = j Then Exit For\n            s = IIf(s = \"\", j, s &amp; \" \" &amp; j) ' construct the string\n        Next\n        Me.ListBox1.AddItem s ' add in listbox\n        s = \"\"\n        k = k - 1\n    Next\nEnd Sub\n</code></pre>\n\n<p>Which will result to:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yAtxQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yAtxQ.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Edit1</strong> No.2 Above</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim i As Integer, j As Integer, k As Integer\n    With Me.ListBox1\n        .ColumnCount = 10\n        .ColumnWidths = \"15;15;15;15;15;15;15;15;15;15\"\n        k = 10 ' determines exit condition\n        For i = 1 To 10\n            For j = 1 To 10\n                If j = 1 Then\n                    .AddItem j ' if it is the number 1, use AddItem method\n                Else\n                    .List(.ListCount - 1, j - 1) = j ' else use the List method\n                End If\n                If k = j Then Exit For\n            Next\n            k = k - 1\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<p>This time, we do not add concatenated numbers into the <em>ListBox</em> but we add it 1 by 1 in each row and column of a <em>multicolumn ListBox</em>. Result would be:</p>\n\n<p><a href=\"https://i.stack.imgur.com/4Hk3H.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4Hk3H.png\" alt=\"enter image description here\"></a></p>\n\n<p>I leave the ascending numbers to you. :) I hope this gets you going.</p>\n"}], "owner": {"reputation": 127, "user_id": 1775965, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ysNho.jpg?s=128&g=1", "display_name": "Eyrik", "link": "https://stackoverflow.com/users/1775965/eyrik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1471, "favorite_count": 0, "accepted_answer_id": 32729805, "answer_count": 1, "score": 1, "last_activity_date": 1442974673, "creation_date": 1442955598, "last_edit_date": 1442957680, "question_id": 32726831, "link": "https://stackoverflow.com/questions/32726831/vba-listbox-and-loop", "title": "VBA Listbox and loop", "body": "<p>Im having a trouble understanding For and Do while.</p>\n\n<p>Im trying to put items in a listbox in this order:</p>\n\n<pre><code>1 2 3 4 5 6 7 8 9 10\n1 2 3 4 5 6 7 8 9\n1 2 3 4 5 6 7 8\n</code></pre>\n\n<p>and so on. \nAnd the same way around</p>\n\n<pre><code>1\n1 2\n1 2 3\n</code></pre>\n\n<p>Up intil 10</p>\n\n<p>How should i attack this issue?</p>\n\n<p>This is what im stuck with:</p>\n\n<pre><code>Dim counter1 As Integer \nDim counter2 As Integer \n For counter1 = 10 To 1 Step -1 \n  For counter2 = 1 To 10 \n   ListBox1.Items.Add() \n  Next counter2 \n Next counter1\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 40194, "user_id": 3829407, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/DQPor.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/3829407/matt"}, "edited": false, "score": 0, "creation_date": 1443832015, "post_id": 32726169, "comment_id": 53662927, "body": "I didn&#39;t think this warranted a downvote. I put the minimal information in the question that I could."}], "answers": [{"tags": [], "owner": {"reputation": 40194, "user_id": 3829407, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/DQPor.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/3829407/matt"}, "is_accepted": true, "score": 0, "last_activity_date": 1443832284, "last_edit_date": 1443832284, "creation_date": 1443013199, "answer_id": 32740316, "question_id": 32726169, "link": "https://stackoverflow.com/questions/32726169/formatting-issues-duplicating-table/32740316#32740316", "title": "Formatting issues duplicating table", "body": "<p>The right concept was there. We needed to add a break in between the tables to disassociate them. Adding the vertical tab <code>Chr(11)</code> was obviously not the correct way to do it. </p>\n\n<p>A proper section break would be the route to go here. Looking at MSDN you can see there are <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195905.aspx\" rel=\"nofollow\">multiple types of section breaks</a>. After testing a desirable outcome was acheived from using <code>wdSectionBreakNextPage</code> which is a \"Section break on next page.\"</p>\n\n<p>Basically just needed to add one line to the above code. </p>\n\n<pre><code>With ActiveDocument\n    .Tables(1).Range.Copy\n    .Range.Select\nEnd With\n\nWith Selection\n    .Collapse wdCollapseEnd\n    .InsertBreak (wdSectionBreakNextPage)\n    .Paste\nEnd With\n</code></pre>\n\n<p>I hate the use of <code>Selection</code> and I am going to look into that but for now this does function properly. </p>\n\n<p>Since the tables are not single units we are able to query <code>.Tables</code> in order to edit each page individually. </p>\n"}], "owner": {"reputation": 40194, "user_id": 3829407, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/DQPor.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/3829407/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 32740316, "answer_count": 1, "score": -1, "last_activity_date": 1443832284, "creation_date": 1442953412, "last_edit_date": 1592644375, "question_id": 32726169, "link": "https://stackoverflow.com/questions/32726169/formatting-issues-duplicating-table", "title": "Formatting issues duplicating table", "body": "<h1>Forward</h1>\n<p>I am making a &quot;label program&quot; that will print waybill information. Consists of a table in Word on a custom 3x5 inch document with 0 margins.</p>\n<p><a href=\"https://i.stack.imgur.com/D4ucX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/D4ucX.png\" alt=\"My Label\" /></a></p>\n<p>I currently have a simple form that, if you need copies, it will edit one of the cells so that each time it prints the &quot;pieces count&quot; is incremented. 1of10, 2of10, 3of10.....</p>\n<p>While that worked the code submitted a separate print job for each &quot;label&quot;. That created a problem for the end user where they would have to wait about 5-10 seconds between print jobs. When printing a couple of hundred of these at a time those seconds can add up.</p>\n<h1>Corrective solution</h1>\n<p>To try an alleviate this problem I wanted to make copies of the table so that 100 labels would be printed as one 100 page document. Found several solutions for copying pages of text but I have tables which complicated things. The closest solution I have found was:</p>\n<pre><code>With ActiveDocument\n    .Tables(1).Range.Copy\n    .Range.Select\n    '.Range.InsertAfter (Chr(11))\n    Selection.Collapse wdCollapseEnd\n    Selection.Paste\nEnd With\n</code></pre>\n<p>And this does make a perfect copy of the table however it is merging the tables together. So if I wanted to loop this to create several more labels it would be doubling up the results every time since the code above just copies the first tabel.</p>\n<p>To try and fix that issue I added a line break (vertical tab) before the paste. You will see that as the commented out line in the above snippet. This breaks up the tables but adds too much whitespace in between.</p>\n<p>Page breaks seems like the solution here. While those did make the table break up they ended up creating a blank page in between each label which I was having enough of a time clearing from the GUI let alone in VBA.</p>\n<p><a href=\"https://i.stack.imgur.com/j4MRo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/j4MRo.png\" alt=\"Multiple labels with line breaks\" /></a></p>\n<h1>The actual question</h1>\n<p>How can I take a table that is perfectly designed to fit on one 3x5 inch page and duplicate it X times. The caveat is I need to be able to find the cell programically that contains the pieces text. Currently I can use these absolute reference for the first table</p>\n<pre><code> ActiveDocument.Tables(1).Cell(5, 1).Range.Text\n</code></pre>\n<p>So if I had 3 tables for instance I need to be able to call each table and edit the text of the <code>Cell(5, 1)</code>.</p>\n<p><strong>In case you ask</strong></p>\n<p>I know this functionality is better placed inside actual label programs like Bartender but those cost money that the company will not allocate for the only label my company uses.</p>\n"}, {"tags": ["string", "vba", "excel"], "comments": [{"owner": {"reputation": 441, "user_id": 480225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98b604c726981be80f7d9779e1e87b84?s=128&d=identicon&r=PG", "display_name": "titus", "link": "https://stackoverflow.com/users/480225/titus"}, "edited": false, "score": 1, "creation_date": 1442955554, "post_id": 32726101, "comment_id": 53295989, "body": "This question has already been asked ! <a href=\"http://stackoverflow.com/questions/15585058/check-if-a-string-contains-another-string\" title=\"check if a string contains another string\">stackoverflow.com/questions/15585058/&hellip;</a>"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1489796957, "post_id": 32726101, "comment_id": 72844208, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/15585058/check-if-a-string-contains-another-string\">Check if a string contains another string</a>"}], "answers": [{"comments": [{"owner": {"reputation": 323, "user_id": 3830268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f780613e25ae663cb28ca24f0b41ae16?s=128&d=identicon&r=PG&f=1", "display_name": "AriKari", "link": "https://stackoverflow.com/users/3830268/arikari"}, "edited": false, "score": 0, "creation_date": 1442953995, "post_id": 32726133, "comment_id": 53295117, "body": "will this work if str1 and str2 are arrays with strings and str(i) compares for a match with all str(j) ?"}, {"owner": {"reputation": 6529, "user_id": 4252320, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh3.googleusercontent.com/-_DAs7Dtci9U/AAAAAAAAAAI/AAAAAAAAIf8/96ZNJAUF2Xk/photo.jpg?sz=128", "display_name": "ergonaut", "link": "https://stackoverflow.com/users/4252320/ergonaut"}, "reply_to_user": {"reputation": 323, "user_id": 3830268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f780613e25ae663cb28ca24f0b41ae16?s=128&d=identicon&r=PG&f=1", "display_name": "AriKari", "link": "https://stackoverflow.com/users/3830268/arikari"}, "edited": false, "score": 0, "creation_date": 1442954105, "post_id": 32726133, "comment_id": 53295175, "body": "no, neither will any of the other answers.  You&#39;ll need to loop."}, {"owner": {"reputation": 323, "user_id": 3830268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f780613e25ae663cb28ca24f0b41ae16?s=128&d=identicon&r=PG&f=1", "display_name": "AriKari", "link": "https://stackoverflow.com/users/3830268/arikari"}, "edited": false, "score": 0, "creation_date": 1442954149, "post_id": 32726133, "comment_id": 53295201, "body": "Yeah sure I will have to loop but it will work for arrays too right"}, {"owner": {"reputation": 6529, "user_id": 4252320, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh3.googleusercontent.com/-_DAs7Dtci9U/AAAAAAAAAAI/AAAAAAAAIf8/96ZNJAUF2Xk/photo.jpg?sz=128", "display_name": "ergonaut", "link": "https://stackoverflow.com/users/4252320/ergonaut"}, "reply_to_user": {"reputation": 323, "user_id": 3830268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f780613e25ae663cb28ca24f0b41ae16?s=128&d=identicon&r=PG&f=1", "display_name": "AriKari", "link": "https://stackoverflow.com/users/3830268/arikari"}, "edited": false, "score": 0, "creation_date": 1442956844, "post_id": 32726133, "comment_id": 53296613, "body": "indexing an array returns the object at a particular location.  If that object is a string, it will act like one because it is one."}], "tags": [], "owner": {"reputation": 6529, "user_id": 4252320, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh3.googleusercontent.com/-_DAs7Dtci9U/AAAAAAAAAAI/AAAAAAAAIf8/96ZNJAUF2Xk/photo.jpg?sz=128", "display_name": "ergonaut", "link": "https://stackoverflow.com/users/4252320/ergonaut"}, "is_accepted": false, "score": 0, "last_activity_date": 1442953264, "creation_date": 1442953264, "answer_id": 32726133, "question_id": 32726101, "link": "https://stackoverflow.com/questions/32726101/how-to-find-string-in-another-string-by-using-vba-only/32726133#32726133", "title": "how to find string in another string by using vba only", "body": "<p>Use the indexOf method:</p>\n\n<pre><code>str2.indexOf(str1)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1442954355, "post_id": 32726194, "comment_id": 53295312, "body": "I may be wrong but this is for vb not vba, which is what the OP asked."}], "tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": false, "score": 0, "last_activity_date": 1442957256, "last_edit_date": 1442957256, "creation_date": 1442953485, "answer_id": 32726194, "question_id": 32726101, "link": "https://stackoverflow.com/questions/32726101/how-to-find-string-in-another-string-by-using-vba-only/32726194#32726194", "title": "how to find string in another string by using vba only", "body": "<p>Use instr or instrrev:</p>\n\n<pre><code>instr(str2, str1, 1)\n</code></pre>\n\n<p>See <a href=\"https://msdn.microsoft.com/en-us/library/8460tsh1(v=vs.90).aspx\" rel=\"nofollow\">msdn</a> for more info.\nThis does exactly what you need.</p>\n"}, {"comments": [{"owner": {"reputation": 323, "user_id": 3830268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f780613e25ae663cb28ca24f0b41ae16?s=128&d=identicon&r=PG&f=1", "display_name": "AriKari", "link": "https://stackoverflow.com/users/3830268/arikari"}, "edited": false, "score": 0, "creation_date": 1442954035, "post_id": 32726344, "comment_id": 53295146, "body": "will this work if str1 and str2 are arrays with strings and str1(i) compares for a match with all str2(j) ?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 323, "user_id": 3830268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f780613e25ae663cb28ca24f0b41ae16?s=128&d=identicon&r=PG&f=1", "display_name": "AriKari", "link": "https://stackoverflow.com/users/3830268/arikari"}, "edited": false, "score": 0, "creation_date": 1442954208, "post_id": 32726344, "comment_id": 53295233, "body": "No.  There are many ways to do it, loops and dictionaries, depending on what is being searched.  But that is not what you asked."}, {"owner": {"reputation": 323, "user_id": 3830268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f780613e25ae663cb28ca24f0b41ae16?s=128&d=identicon&r=PG&f=1", "display_name": "AriKari", "link": "https://stackoverflow.com/users/3830268/arikari"}, "edited": false, "score": 0, "creation_date": 1442954309, "post_id": 32726344, "comment_id": 53295291, "body": "which variable will return a positive value if match is found ?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 323, "user_id": 3830268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f780613e25ae663cb28ca24f0b41ae16?s=128&d=identicon&r=PG&f=1", "display_name": "AriKari", "link": "https://stackoverflow.com/users/3830268/arikari"}, "edited": false, "score": 0, "creation_date": 1442954517, "post_id": 32726344, "comment_id": 53295392, "body": "The result of the function that is being called will result in a positive number if found and a zero if not.  So for your example the result would be 4.  You would create a variable and set it = to the function above."}, {"owner": {"reputation": 245, "user_id": 3813538, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1da8b3ecb8dd6bed2fb98a23e88c8dac?s=128&d=identicon&r=PG&f=1", "display_name": "WltrRpo", "link": "https://stackoverflow.com/users/3813538/wltrrpo"}, "edited": false, "score": 0, "creation_date": 1442958945, "post_id": 32726344, "comment_id": 53297570, "body": "To work with an array you have to loop in and compare each position."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1442953977, "creation_date": 1442953977, "answer_id": 32726344, "question_id": 32726101, "link": "https://stackoverflow.com/questions/32726101/how-to-find-string-in-another-string-by-using-vba-only/32726344#32726344", "title": "how to find string in another string by using vba only", "body": "<p>For VBA, The instr is the way to go:</p>\n\n<pre><code>InStr(1, str2, str1, vbTextCompare)\n</code></pre>\n\n<p>The first part is where it starts looking, in this case the first character.</p>\n\n<p>The second is the string in which the search is happening.</p>\n\n<p>The third is the search parameter.</p>\n\n<p>The fourth determines whether it looks at the text of the binary value.  So for a case-insensitive we use vbtextcompare.</p>\n"}], "owner": {"reputation": 323, "user_id": 3830268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f780613e25ae663cb28ca24f0b41ae16?s=128&d=identicon&r=PG&f=1", "display_name": "AriKari", "link": "https://stackoverflow.com/users/3830268/arikari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3224, "favorite_count": 0, "accepted_answer_id": 32726344, "answer_count": 3, "score": 0, "last_activity_date": 1442957256, "creation_date": 1442953114, "last_edit_date": 1531164843, "question_id": 32726101, "link": "https://stackoverflow.com/questions/32726101/how-to-find-string-in-another-string-by-using-vba-only", "title": "how to find string in another string by using vba only", "body": "<p>So I have </p>\n\n<pre><code>  Dim str1\n  str1 = \"Cat\"\n  Dim str2\n  str2 = \"concatenate\"\n</code></pre>\n\n<p>I wanted to know is there a way I can match str1 with str2 and return positive non-zero number if there is match (case-insensitive) for str1 in str2 ?</p>\n"}, {"tags": ["vba", "excel", "worksheet-function"], "comments": [{"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 1, "creation_date": 1442951403, "post_id": 32725528, "comment_id": 53293708, "body": "If I had to guess, it&#39;s because EVALUATE treats your formula as if it&#39;s an array formula.  Whole column references (like Sheet2!B:B&amp;Sheet2!C:C&amp;&#39;Sheet2!D:D) are slowing it way down.  As a test, try setting the whole column references to be closer to the actual ranges you need to evaluate and see if you get better performance."}, {"owner": {"reputation": 4913, "user_id": 2280567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LA8CO.jpg?s=128&g=1", "display_name": "Ioannis", "link": "https://stackoverflow.com/users/2280567/ioannis"}, "edited": false, "score": 1, "creation_date": 1442951487, "post_id": 32725528, "comment_id": 53293753, "body": "Have a look at <a href=\"https://fastexcel.wordpress.com/2011/11/02/evaluate-functions-and-formulas-fun-how-to-make-excels-evaluate-method-twice-as-fast/\" rel=\"nofollow noreferrer\">this</a> post by Charles Williams. Among other interesting observations, he supports that <code>Application.Evaluate</code> is called twice, (it is a bug) compared to <code>Worksheetfunction.Evaluate</code>."}, {"owner": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "edited": false, "score": 0, "creation_date": 1442957111, "post_id": 32725528, "comment_id": 53296732, "body": "sous2817: thanks, that improved performance by a factor of about 10,000."}, {"owner": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "edited": false, "score": 0, "creation_date": 1442957127, "post_id": 32725528, "comment_id": 53296741, "body": "loannis: Thanks, that was an interesting post that you linked to."}], "answers": [{"comments": [{"owner": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "edited": false, "score": 0, "creation_date": 1442957048, "post_id": 32726100, "comment_id": 53296712, "body": "Thanks, using the worksheet&#39;s Evaluate method was nearly twice as fast as the Application&#39;s Evaluate method, and multiplying the separate boolean results of each of the columns improved performance further by a factor of about 3. Also it&#39;s an interesting way to use MATCH. I have to say, though, that sous2817&#39;s suggestion of restricting the ranges to the actual ranges needed instead of referencing whole columns, improved performance by a factor of about 10,000. So I&#39;d have to consider that the answer, or at least a necessary part of the answer."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "edited": false, "score": 0, "creation_date": 1442959757, "post_id": 32726100, "comment_id": 53297888, "body": "Well, the restriction component always applies in all formula situations (with the exception of a very few highly optimized functions like SUMIFS). My answer focused on your particular situation."}, {"owner": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "edited": false, "score": 0, "creation_date": 1442960737, "post_id": 32726100, "comment_id": 53298206, "body": "Except that the restriction component didn&#39;t matter (was a such a tiny performance hit that I didn&#39;t notice it) for the formula in the worksheet cell. I don&#39;t agree with your update in that you make it sound equally important in the worksheet cell. It&#39;s clearly not. If it were, my original question would have made no sense."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "edited": false, "score": 0, "creation_date": 1442961918, "post_id": 32726100, "comment_id": 53298621, "body": "It is equally important and you should avoid full-column references whenever possible. That said, calling between the two domains, Excel and VBA amplifies the inefficiencies. The divide is like a microscope allowing you to focus on a specific formula by blowing it up (in this case, slowing it down). The inherent inefficiency is more easily seen. Just because you did not notice it on the worksheet side does not mean it was not there. Do it a bunch of times on the worksheet and the same hit will be observed."}, {"owner": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "edited": false, "score": 0, "creation_date": 1442970580, "post_id": 32726100, "comment_id": 53300908, "body": "How do you figure it&#39;s equally important? If I do it once in VBA and once on the worksheet, the difference in performance is about 10,000 times. If I do it 10 times in VBA and 10 times in the worksheet, the performance difference is still about 10,000 times. If I did it a million times in VBA and a million times in the worksheet, I&#39;d still expect the performance difference to be about 10,000 times. (continued...)"}, {"owner": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "edited": false, "score": 0, "creation_date": 1442970585, "post_id": 32726100, "comment_id": 53300910, "body": "To your point that if I did it enough times on the worksheet I&#39;d eventually notice that it wasn&#39;t quite instantaneous, sure, but if I did it the same number of times in VBA, it would take about 10,000 times longer than that, therefore about 10,000 times more important."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "edited": false, "score": 0, "creation_date": 1442983237, "post_id": 32726100, "comment_id": 53303849, "body": "Are you familiar with PrecisionCalc?"}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": false, "score": 2, "last_activity_date": 1442960211, "last_edit_date": 1442960211, "creation_date": 1442953104, "answer_id": 32726100, "question_id": 32725528, "link": "https://stackoverflow.com/questions/32725528/evaluate-function-slow-with-match-worksheet-function-referencing-multiple-column/32726100#32726100", "title": "Evaluate function slow with Match worksheet function referencing multiple columns", "body": "<p>A couple of things.</p>\n\n<p>Scope is important when using Evaluate(). Calling the method on a worksheet is roughly twice as fast as simply using Evaluate() by itself, which is shorthand for Application.Evaluate().</p>\n\n<p>Concatenation is notoriously slow, and that inefficiency is multiplied when calling through the barrier between VBA and Excel.</p>\n\n<p>This reworking of the formula using Boolean logic as an alternative mechanism to arrive at the same formula result, executes quicker and is much closer in time to a worksheet-housed formula:</p>\n\n<pre><code> MatchingRow =  = Sheet1.[MATCH(1,(Sheet1!G6=Sheet2!B:B)*(Sheet1!H6=Sheet2!C:C)*(Sheet1!I6=Sheet2!D:D),0)]\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>For completeness, you should also strongly consider limiting the depth of your lookup ranges. This will dramatically speed up the formula evaluation either on the worksheet or from VBA. Here is the same formula as above, but with the lookup ranges restricted to just 100 rows. Adjust as appropriate:</p>\n\n<pre><code>Sheet1.[MATCH(1,(Sheet1!G6=Sheet2!B1:B100)*(Sheet1!H6=Sheet2!C1:C100)*(Sheet1!I6=Sheet2!D1:D100),0)]\n</code></pre>\n"}], "owner": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 875, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1442976628, "creation_date": 1442951088, "last_edit_date": 1442976628, "question_id": 32725528, "link": "https://stackoverflow.com/questions/32725528/evaluate-function-slow-with-match-worksheet-function-referencing-multiple-column", "title": "Evaluate function slow with Match worksheet function referencing multiple columns", "body": "<p>Normally, Excel VBA's Evaluate function is a convenient way to get the result of a worksheet formula in VBA without having to put the formula in a worksheet cell. However, I'm finding that if the formula to be evaluated is MATCH function working across multiple columns, it's surprisingly slow -- MUCH slower than calculating the same formula in a worksheet cell. For example:</p>\n\n<pre><code>MatchingRow = EVALUATE(MATCH(Sheet1!G6&amp;Sheet1!H6&amp;Sheet1!I6,Sheet2!B:B&amp;Sheet2!C:C&amp;Sheet2!D:D,0))\n</code></pre>\n\n<p>Any idea why that would be so much slower than this, in a worksheet cell?</p>\n\n<pre><code>=MATCH(Sheet1!G6&amp;Sheet1!H6&amp;Sheet1!I6,Sheet2!B:B&amp;Sheet2!C:C&amp;Sheet2!D:D,0)\n</code></pre>\n\n<p>I'm pretty sure I can hear someone already typing an answer saying that it's all because of the overhead of calling a worksheet function from the VBA environment. But if that's the case, my followup question is: <em>Why isn't EVALUATE slow for other functions too?</em></p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "is_accepted": false, "score": 3, "last_activity_date": 1559833032, "last_edit_date": 1559833032, "creation_date": 1442951175, "answer_id": 32725551, "question_id": 32725352, "link": "https://stackoverflow.com/questions/32725352/vba-compile-error-expected/32725551#32725551", "title": "VBA Compile Error: expected =", "body": "<p>You must call <code>Sub</code> procedures without parameter parentheses <code>( )</code> in VBA.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DoCmd.OutputTo acOutputReport, _\n    ReportName &amp; \" \" &amp; MyLoad, _\n    acFormatPDF, _\n    \"\\\\drive\\Reports\\\" &amp; ReportName &amp; \" \" &amp; MyLoad &amp; \" \" &amp; _\n        Year(Date) &amp; Month(Date) &amp; Day(Date) &amp; \".pdf\"\n</code></pre>\n\n<p>Also <code>Load</code> is a reserved word in VBA. It is <code>Sub Load(Object As Object)</code>. Use another identifier.</p>\n\n<hr>\n\n<p>The compile error \"Expected: =\" may seem awkward, but it makes sense, since parentheses are used for <code>Function</code> calls. I.e., VBA is expecting something like this</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>x = MyFunc(...)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5364831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5707a41db28dc9dae2ed62a78f5359d?s=128&d=identicon&r=PG&f=1", "display_name": "Garousi", "link": "https://stackoverflow.com/users/5364831/garousi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3361, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559833032, "creation_date": 1442950334, "last_edit_date": 1443025290, "question_id": 32725352, "link": "https://stackoverflow.com/questions/32725352/vba-compile-error-expected", "title": "VBA Compile Error: expected =", "body": "<p>I get an error for my code: </p>\n\n<blockquote>\n  <p>compile error: Expected: =</p>\n</blockquote>\n\n<pre><code>DoCmd.OutputTo (acOutputReport, _\n    ReportName &amp; \" \" &amp; Load, _\n    acFormatPDF, _\n    \"\\\\drive\\Reports\\\" &amp; ReportName &amp; \" \" &amp; Load &amp; \" \" &amp; Year(Date) &amp; Month(Date) &amp; Day(Date)&amp; \".pdf\")\n</code></pre>\n\n<p>I have Access front-end and SQL-Server backend.</p>\n\n<p>What do I need to do to fix this? I am still a beginner with VBA.</p>\n"}, {"tags": ["vba", "ms-access", "report", "calculated-field"], "comments": [{"owner": {"reputation": 933, "user_id": 5345818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f648ca9f16c3a02a085cf79fa59c282?s=128&d=identicon&r=PG", "display_name": "asdev", "link": "https://stackoverflow.com/users/5345818/asdev"}, "edited": false, "score": 0, "creation_date": 1443005338, "post_id": 32724611, "comment_id": 53315646, "body": "Your calculation code is okay. Is there any code where these functions are called? Saying, that you can not use the footer because of rounding: Have you considered to add the round function to the footer expression?"}, {"owner": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "reply_to_user": {"reputation": 933, "user_id": 5345818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f648ca9f16c3a02a085cf79fa59c282?s=128&d=identicon&r=PG", "display_name": "asdev", "link": "https://stackoverflow.com/users/5345818/asdev"}, "edited": false, "score": 0, "creation_date": 1443008212, "post_id": 32724611, "comment_id": 53317593, "body": "@asdev The functions are only called in the textboxes of the report.  Everything executes OK with no execution errors.  At first I was just using the following Access expressions to calculate the Daily Hours: =Int([Hours]) &amp; &quot;:&quot; &amp; Format([Hours]*60 Mod 60,&quot;00&quot;)    and Weekly and Period Hours were:   =Int(Round(Sum([Hours])*4,0)/4) &amp; &quot;:&quot; &amp; Format((Round(Sum([Hours])*4,0)/4)*60 Mod 60,&quot;00&quot;).  However; that brought up the situation where the actual weekly hours could be 40:07 &amp; 40:07 which would both be rounded to 40:00 each, but the period total would round to 80:15, which would not be correct."}], "answers": [{"comments": [{"owner": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "edited": false, "score": 0, "creation_date": 1443012245, "post_id": 32739120, "comment_id": 53320421, "body": "Lol didn&#39;t see this post until after I came up with a solution, but your 2nd solution would have also led me to where I ultimately ended up.  However; I did it without using VBA."}], "tags": [], "owner": {"reputation": 933, "user_id": 5345818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f648ca9f16c3a02a085cf79fa59c282?s=128&d=identicon&r=PG", "display_name": "asdev", "link": "https://stackoverflow.com/users/5345818/asdev"}, "is_accepted": true, "score": 1, "last_activity_date": 1443009881, "creation_date": 1443009881, "answer_id": 32739120, "question_id": 32724611, "link": "https://stackoverflow.com/questions/32724611/how-to-sum-calculated-fields-with-vba-on-ms-access-report/32739120#32739120", "title": "How to Sum Calculated Fields with VBA on MS Access Report", "body": "<p>Since you revealed that the functions are called in the textboxes of the report let it be said that you can never be sure in what order Access calles them when the report is initialized.</p>\n\n<p>I propose two other possibilities:</p>\n\n<p><strong>1. Use Expression with extra Field</strong></p>\n\n<p>Set in your report detail row a field of the real daily hour, name it e.g. DAILY_CORRECT_FIELD, an hide it by  visible set to false. Insert another text field, name it e.g. DAILY_ROUNDED_FIELD, where you insert the round-to-quarter expression. On the sum field for the week, refer sum(DAILY_CORRECT_FIELD), the invisible field with the unrounded value.</p>\n\n<p><strong>2. Code based</strong></p>\n\n<p>If you want to use VBA, do not write a module where you sum all the fields, especially when you do not have control in which order the function are called. Write a query instead where you sum up a week and set that to the field on the report. There are tons of tutorial on the web, so I will not explain this further.</p>\n\n<p>Although being a big fan of using VBA, I would highly recommend suggestion 1, because of its simple implementation.</p>\n"}, {"tags": [], "owner": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "is_accepted": false, "score": 0, "last_activity_date": 1443012001, "creation_date": 1443012001, "answer_id": 32739876, "question_id": 32724611, "link": "https://stackoverflow.com/questions/32724611/how-to-sum-calculated-fields-with-vba-on-ms-access-report/32739876#32739876", "title": "How to Sum Calculated Fields with VBA on MS Access Report", "body": "<p>I came up with a solution, @asdev, you made me think about using the access expressions again, but this time I added a sort of bypass aggregate query to group by the employee and the week, then rounded the sum in that query to give me the same totals as I would get in the week footers of my report. I then used the DSum function to filter the bypass query by Employee ID and sum the totals in my Period footer, giving me the correct totals.</p>\n"}], "owner": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3146, "favorite_count": 0, "accepted_answer_id": 32739120, "answer_count": 2, "score": 0, "last_activity_date": 1443012001, "creation_date": 1442947661, "question_id": 32724611, "link": "https://stackoverflow.com/questions/32724611/how-to-sum-calculated-fields-with-vba-on-ms-access-report", "title": "How to Sum Calculated Fields with VBA on MS Access Report", "body": "<p>I'm hoping someone can point me in the right direction here and hoping I explain this clearly enough. I'm getting undesirable results with my report because I need to sum calculated fields.  The Employee Name in the Employee ID header, the labels in the Week header and the Dates and Calculated Hours in the Details header are all showing correctly.  However, Access is filling in the information in the wrong order.</p>\n\n<p>Here is what it is doing:</p>\n\n<p>Calculating and filling in the hours for last day of the last week of the period -> </p>\n\n<p>Filling in the hours for the last week of the period -></p>\n\n<p>Filling in the hours for the period -></p>\n\n<p>Calculating and filling in the last day for the previous week of the period -></p>\n\n<p>Filling in the hours for the previous week of the period -></p>\n\n<p>repeating until the first week.</p>\n\n<p>Then filling in the rest of the calculated hours.</p>\n\n<p>So My results show up like this: (Please note rounding is intentional and the reason I can't just do a =Sum([Hours]) in the footers)</p>\n\n<pre><code>Employee Name\n    Date       Hours    Reg     OT\n    9/8/15      8:00\n    9/9/15      8:28\n    9/10/15     8:00\n    9/11/15     7:32 &lt;--Inputs this fourth\n    ------------------------------\nWeek Totals:    7:30   7:30   0:00 &lt;--Inputs this fifth then fills in other dates\n\n    Date       Hours    Reg     OT\n    9/14/15     9:43\n    9/15/15     8:00\n    9/16/15    13:14\n    9/17/15    11:39\n    9/18/15     5:25 &lt;--Starts here first\n    ------------------------------\nWeek Totals:    5:30   5:30   0:00 &lt;--Inputs this second\n    ------------------------------\nPeriod Totals:  5:30   5:30   0:00 &lt;--Inputs this third\n</code></pre>\n\n<p>Here is how I have my report setup right now:</p>\n\n<pre><code>Employee Name                                                        (Employee ID Header)\nDate       Hours                Regular            Overtime          (Week Header)\n=[Date]    =CalcHours([Hours])                                       (Details)    \n           =GetWeekTot()        =GetWeekReg()      =GetWeekOT()      (Week Footer)\n           =GetPeriodTot()      =GetPeriodReg()    =GetPeriodOT()    (Employee ID Footer)\n</code></pre>\n\n<p>Here is my Module:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate WeekTot As Double\nPrivate WeekReg As Double\nPrivate WeekOT As Double\n\nPrivate PeriodTot As Double\nPrivate PeriodReg As Double\nPrivate PeriodOT As Double\n\nPublic Function CalcHours(ByVal Hours As Double) As String\n    'Add the Daily Hours to the Total Weekly Hours\n    WeekTot = WeekTot + Hours\n\n    'Format and Return the Daily Hours\n    CalcHours = Int(Hours) &amp; \":\" &amp; Format((Hours * 60) Mod 60, \"00\")\nEnd Function\n\nPublic Function GetWeekTot() As String\n    'Round the Total Weekly Hours to the Nearest Quarter Hour\n    WeekTot = Round(WeekTot * 4, 0) / 4\n\n    'Calculate the Regular Weekly Hours and the Overtime Weekly Hours\n    If WeekTot &gt; 40 Then\n        WeekReg = 40\n        WeekOT = WeekTot - 40\n    Else\n        WeekReg = WeekTot\n        WeekOT = 0\n    End If\n\n    'Add the Total Weekly Hours to the Total Period Hours\n    PeriodTot = PeriodTot + WeekTot\n\n    'Format and Return the Total Weekly Hours\n    GetWeekTot = Int(WeekTot) &amp; \":\" &amp; Format(WeekTot * 60 Mod 60, \"00\")\n\n    'Reset the Total Weekly Hours\n    WeekTot = 0\nEnd Function\n\nPublic Function GetWeekReg() As String\n    'Add the Regular Weekly Hours to the Regular Period Hours\n    PeriodReg = PeriodReg + WeekReg\n\n    'Format and Return the Regular Weekly Hours\n    GetWeekReg = Int(WeekReg) &amp; \":\" &amp; Format(WeekReg * 60 Mod 60, \"00\")\n\n    'Reset the Regular Weekly Hours\n    WeekReg = 0\nEnd Function\n\nPublic Function GetWeekOT() As String\n    'Add the Overtime Weekly Hours to the Overtime Period Hours\n    PeriodOT = PeriodOT + WeekOT\n\n    'Format and Return the Overtime Weekly Hours\n    GetWeekOT = Int(WeekOT) &amp; \":\" &amp; Format(WeekOT * 60 Mod 60, \"00\")\n\n    'Reset the Overtime Weekly Hours\n    WeekOT = 0\nEnd Function\n\nPublic Function GetPeriodTot() As String\n    'Format and Return Total Period Hours\n    GetPeriodTot = Int(PeriodTot) &amp; \":\" &amp; Format((PeriodTot * 60) Mod 60, \"00\")\n\n    'Reset the Total Period Hours\n    PeriodTot = 0\nEnd Function\n\nPublic Function GetPeriodReg() As String\n    'Format and Return Total Period Hours\n    GetPeriodReg = Int(PeriodReg) &amp; \":\" &amp; Format((PeriodReg * 60) Mod 60, \"00\")\n\n    'Reset the Total Period Hours\n    PeriodReg = 0\nEnd Function\n\nPublic Function GetPeriodOT() As String\n    'Format and Return Total Period Hours\n    GetPeriodOT = Int(PeriodOT) &amp; \":\" &amp; Format((PeriodOT * 60) Mod 60, \"00\")\n\n    'Reset the Total Period Hours\n    PeriodOT = 0\nEnd Function\n</code></pre>\n\n<p>If anyone could figure out a way to make it show this I would be greatly appreciative:</p>\n\n<pre><code>Employee Name\n    Date       Hours    Reg     OT\n    9/8/15      8:00\n    9/9/15      8:28\n    9/10/15     8:00\n    9/11/15     7:32\n    ------------------------------\nWeek Totals:   32:00  32:00   0:00 \n\n    Date       Hours    Reg     OT\n    9/14/15     9:43\n    9/15/15     8:00\n    9/16/15    13:14\n    9/17/15    11:39\n    9/18/15     5:25 \n    ------------------------------\nWeek Totals:   48:00  40:00   8:00 \n    ------------------------------\nPeriod Totals: 80:00  72:00   8:00 \n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1442947114, "post_id": 32724251, "comment_id": 53291402, "body": "If <code>=A1+B1</code>, <code>=B1+C1</code> and <code>=C1+D1</code> are entered in three adjacent horizontal cells, it is the same formula as far as Excel is concerned (it looks the same in the R1C1 notation). Please give more details about your sheet layout."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1442947422, "post_id": 32724251, "comment_id": 53291577, "body": "make this your equation <code>&quot;=r[0]c[-1] + r[0]c[0]&quot;</code>"}, {"owner": {"reputation": 1385, "user_id": 1204988, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/3e88bbf003f07da5ec10d05860a83579?s=128&d=identicon&r=PG&f=1", "display_name": "madeye", "link": "https://stackoverflow.com/users/1204988/madeye"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1442947725, "post_id": 32724251, "comment_id": 53291745, "body": "@ScottCraner Im trying to make formulas dynamic. That is not only formula i have 10 different formulas and they are presented in base column."}, {"owner": {"reputation": 1385, "user_id": 1204988, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/3e88bbf003f07da5ec10d05860a83579?s=128&d=identicon&r=PG&f=1", "display_name": "madeye", "link": "https://stackoverflow.com/users/1204988/madeye"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1442947813, "post_id": 32724251, "comment_id": 53291787, "body": "@GSerg I have updated question and put real formula. Take a note that this is only one of 10 other and in all i just want cell reference to be shifted one place right and that is it."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1442948003, "post_id": 32724251, "comment_id": 53291900, "body": "<code>=&#39;Balance sheet&#39;!B13*360&#47;&#39;P&amp;L&#39;!B2</code> and <code>=&#39;Balance sheet&#39;!C13*360&#47;&#39;P&amp;L&#39;!C2</code> is the same formula if they are in horizontally adjacent cells @housefrommars. To copy this formula to the right you assign <code>NewCell.FormulaR1C1 = OldCell.FormulaR1C1</code>."}, {"owner": {"reputation": 1385, "user_id": 1204988, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/3e88bbf003f07da5ec10d05860a83579?s=128&d=identicon&r=PG&f=1", "display_name": "madeye", "link": "https://stackoverflow.com/users/1204988/madeye"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1442948138, "post_id": 32724251, "comment_id": 53291970, "body": "@GSerg yes thats it. Thank you. Copy this into the answer so i can accept it."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1442948515, "post_id": 32724251, "comment_id": 53292198, "body": "@housefrommars In fact I like <a href=\"http://stackoverflow.com/a/32724745/11683\">Ron&#39;s answer</a> more. You can <code>FillRight</code> all 10 rows at once."}], "answers": [{"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 4, "last_activity_date": 1442950116, "last_edit_date": 1442950116, "creation_date": 1442948162, "answer_id": 32724745, "question_id": 32724251, "link": "https://stackoverflow.com/questions/32724251/copy-relative-formula-in-excel-with-vba/32724745#32724745", "title": "Copy relative formula in excel with VBA", "body": "<p>If you want to copy a formula to right, that can be done with a <code>fill</code> operation.  So with your formula in a cell defined by your base row and base column, and with it using relative addressing as in your question, merely:</p>\n\n<pre><code>Option Explicit\nSub foo()\n    Const lBaseColumn As Long = 3\n    Const lBaseRow As Long = 6\n    Const lRpts As Long = 10\n\nCells(lBaseRow, lBaseColumn).Resize(columnsize:=lRpts).FillRight\n\nEnd Sub\n</code></pre>\n\n<p>You should note that you can <code>FillRight</code> from multiple rows at once, if that is what you need to do.  The below would fill C6:C10 through to L6:L10</p>\n\n<pre><code>Option Explicit\nSub foo()\n    Const lBaseColumn As Long = 3\n    Const lBaseRow As Long = 6\n    Const lColRpts As Long = 10\n    Const lRows As Long = 5\n\nCells(lBaseRow, lBaseColumn).Resize(rowsize:=lRows, columnsize:=lColRpts).FillRight\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2140, "user_id": 539997, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ef9924ff002c119e35cf7dd70c554e22?s=128&d=identicon&r=PG", "display_name": "Michael Hoffmann", "link": "https://stackoverflow.com/users/539997/michael-hoffmann"}, "edited": false, "score": 0, "creation_date": 1556915911, "post_id": 39165087, "comment_id": 98604191, "body": "This doesn&#39;t translate relative references. It takes them as absolute references. So if the cell I copy from has a reference to <code>D5</code> and I paste it in the row below, the reference is still <code>D5</code>."}], "tags": [], "owner": {"reputation": 1, "user_id": 6761212, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/8a3568adb9c2267deaf754399bbc4dbf?s=128&d=identicon&r=PG", "display_name": "samnbiddev", "link": "https://stackoverflow.com/users/6761212/samnbiddev"}, "is_accepted": false, "score": 0, "last_activity_date": 1472210356, "creation_date": 1472210356, "answer_id": 39165087, "question_id": 32724251, "link": "https://stackoverflow.com/questions/32724251/copy-relative-formula-in-excel-with-vba/39165087#39165087", "title": "Copy relative formula in excel with VBA", "body": "<p>these two lines will copy formula / contents from left cell and copy in the reference cell. this will also copy the formula with relative reference</p>\n\n<pre><code>Range(refCellID).Offset(0,-1).Copy\nRange(refCellID).PasteSpecial\n</code></pre>\n"}], "owner": {"reputation": 1385, "user_id": 1204988, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/3e88bbf003f07da5ec10d05860a83579?s=128&d=identicon&r=PG&f=1", "display_name": "madeye", "link": "https://stackoverflow.com/users/1204988/madeye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19778, "favorite_count": 1, "accepted_answer_id": 32724745, "answer_count": 2, "score": 3, "last_activity_date": 1478087768, "creation_date": 1442946515, "last_edit_date": 1478087768, "question_id": 32724251, "link": "https://stackoverflow.com/questions/32724251/copy-relative-formula-in-excel-with-vba", "title": "Copy relative formula in excel with VBA", "body": "<p>I'm trying to copy formulas with relative row and column names. </p>\n\n<p>I have base column with 10 formulas and I'm trying to copy formula 5 times on columns on the right.</p>\n\n<p>So for example in base column i have this formula\n=A1+B1 and i want to make next cell this =B1+C1 next =C1+D1 and so on.</p>\n\n<p>I have this code</p>\n\n<pre><code>For i = 1 To Range(\"B1\").Value\n        For j = 1 To 10\n            Sheet2.Cells(5 + j, 2 + i).FormulaR1C1 = \"=c[-1]\"\n        Next j\nNext i\n</code></pre>\n\n<p>But this just copies value from left cell</p>\n\n<p>It would be easy if the formulas were same but they are different. So im trying to find a way to dynamically reference always left cell.</p>\n\n<p>This is one of the real formulas</p>\n\n<pre><code>='Balance sheet'!B13*360/'P&amp;L'!B2\n</code></pre>\n\n<p>I want next cell to be </p>\n\n<pre><code>='Balance sheet'!C13*360/'P&amp;L'!C2\n</code></pre>\n\n<p>And with code i have now next cell is <code>=B3</code></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1442945918, "post_id": 32723997, "comment_id": 53290632, "body": "You should really explain what exactly you are doing, and why. Otherwise this isn&#39;t very helpful."}, {"owner": {"reputation": 906, "user_id": 1707308, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/881969f6035e7071917af1de75525290?s=128&d=identicon&r=PG", "display_name": "Jcmoney1010", "link": "https://stackoverflow.com/users/1707308/jcmoney1010"}, "edited": false, "score": 0, "creation_date": 1442945974, "post_id": 32723997, "comment_id": 53290663, "body": "Thanks for the reply. Unfortunately, this wont be the same sheet every time. Setting the sheets to a specific value wouldn&#39;t help me much."}, {"owner": {"reputation": 153, "user_id": 4137845, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-GOnqAEH8QoQ/AAAAAAAAAAI/AAAAAAAAAMI/q412c4RpHKk/photo.jpg?sz=128", "display_name": "Thapipo", "link": "https://stackoverflow.com/users/4137845/thapipo"}, "edited": false, "score": 0, "creation_date": 1442947172, "post_id": 32723997, "comment_id": 53291433, "body": "i edit my previous answer. Now you can do whatever you need to do once you&#39;ve find your cell."}], "tags": [], "owner": {"reputation": 153, "user_id": 4137845, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-GOnqAEH8QoQ/AAAAAAAAAAI/AAAAAAAAAMI/q412c4RpHKk/photo.jpg?sz=128", "display_name": "Thapipo", "link": "https://stackoverflow.com/users/4137845/thapipo"}, "is_accepted": false, "score": 0, "last_activity_date": 1442947040, "last_edit_date": 1442947040, "creation_date": 1442945634, "answer_id": 32723997, "question_id": 32723889, "link": "https://stackoverflow.com/questions/32723889/oject-required-error-using-cell-find-with-if-statement/32723997#32723997", "title": "&#39;Oject required&#39; error using Cell.Find with If Statement", "body": "<p>You could try something like :</p>\n\n<pre><code>Public function findWord(sheetName as string, whatimlookingfor as string)\n\n    Dim Srch As Range\n    Dim oWs as Worksheet\n    Dim oWb as Workbook\n\n    Set oWb = ThisWorkbook\n    Set oWs = oWb.Sheets(sheetName)\n\n\n     Set Srch = oWs.Cell.Find(What:=whatimlookingfor, After:=oWs.Range(\"A1\"), LookIn:= _\n            xlValues, SearchOrder:=xlByRows, SearchDirection:= _\n            xlNext, MatchCase:=False)\n\n       If Not Srch Is Nothing Then\n          oWs.Columns(Srch.column).Select\n          Selection.Copy\n       End if\n\nEnd function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 317, "user_id": 4539403, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/57e9499356c1425fbf8d5e8c0bc35e0a?s=128&d=identicon&r=PG&f=1", "display_name": "mozgov_net", "link": "https://stackoverflow.com/users/4539403/mozgov-net"}, "is_accepted": true, "score": 2, "last_activity_date": 1442945966, "creation_date": 1442945966, "answer_id": 32724090, "question_id": 32723889, "link": "https://stackoverflow.com/questions/32723889/oject-required-error-using-cell-find-with-if-statement/32724090#32724090", "title": "&#39;Oject required&#39; error using Cell.Find with If Statement", "body": "<p><code>Cell.find</code> expression has the wrong syntax - you have to define the range where it is looking. Try changing it to <code>ActiveSheet.Cells.Find(.......)</code> or </p>\n\n<pre><code>  Dim ws as worksheet\n  'delcaring the rest of the variables\n  ws.Cells.find(......)\n</code></pre>\n\n<p>In the future - try reading <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow\">msdn</a> on the methods and functions you are trying to use - that is how I learned almost everything I know today. And SO, of course :)</p>\n"}], "owner": {"reputation": 906, "user_id": 1707308, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/881969f6035e7071917af1de75525290?s=128&d=identicon&r=PG", "display_name": "Jcmoney1010", "link": "https://stackoverflow.com/users/1707308/jcmoney1010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 32724090, "answer_count": 2, "score": 1, "last_activity_date": 1442947040, "creation_date": 1442945241, "last_edit_date": 1442945793, "question_id": 32723889, "link": "https://stackoverflow.com/questions/32723889/oject-required-error-using-cell-find-with-if-statement", "title": "&#39;Oject required&#39; error using Cell.Find with If Statement", "body": "<p>I'm working on some VBA that will search the worksheet for a particular word or phrase, if it comes across that word or phrase, I would like for it to grab the whole column and copy it. Unfortunately, I keep running into an issue when I try and set the search result equal to my variable.</p>\n\n<pre><code>Dim Srch As Range\n\n Set Srch = Cell.Find(What:=\"Foundation Account\", After:=ActiveCell, LookIn:= _\n        xlValues, SearchOrder:=xlByRows, SearchDirection:= _\n        xlNext, MatchCase:=False)\n   If Not Srch Is Nothing Then\n         'Do something\n</code></pre>\n\n<p>Each time I run this I get a run-time error 424 'Object required'. Is there a reason why I am unable to Set <code>Srch</code> = <code>Cell.Find</code>?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1442949554, "post_id": 32723829, "comment_id": 53292738, "body": "what do you propose as the &#39;avoid&#39; method - replace 0 with another number? skip the calculation? ignore the result?"}], "answers": [{"tags": [], "owner": {"reputation": 441, "user_id": 480225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98b604c726981be80f7d9779e1e87b84?s=128&d=identicon&r=PG", "display_name": "titus", "link": "https://stackoverflow.com/users/480225/titus"}, "is_accepted": false, "score": 0, "last_activity_date": 1442956735, "creation_date": 1442956735, "answer_id": 32727131, "question_id": 32723829, "link": "https://stackoverflow.com/questions/32723829/avoiding-multiplying-zeros-in-matrix-solver/32727131#32727131", "title": "Avoiding multiplying zeros in matrix solver", "body": "<p>It is impossible to avoid multiplying by zeroes if you want to preserve the matrix structure.</p>\n\n<p>Furthermore, sparse matrices are not supported in VBA so you would have to code your own class for sparse matrices : the idea is that instead of storing the entire matrix, you just store index/value pairs.</p>\n\n<p>A sparse matrix class would include methods to :</p>\n\n<ul>\n<li>create a matrix with given values in index/value form.</li>\n<li>create a sparse matrix from given values in array form.</li>\n<li>multiply two sparse matrices (including the special case sparse matrix times sparse vector)</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5364558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d36ef6f8bcf54d1bb655574d686d2074?s=128&d=identicon&r=PG&f=1", "display_name": "user5364558", "link": "https://stackoverflow.com/users/5364558/user5364558"}, "is_accepted": false, "score": 0, "last_activity_date": 1443083923, "last_edit_date": 1443083923, "creation_date": 1443000972, "answer_id": 32735978, "question_id": 32723829, "link": "https://stackoverflow.com/questions/32723829/avoiding-multiplying-zeros-in-matrix-solver/32735978#32735978", "title": "Avoiding multiplying zeros in matrix solver", "body": "<p>Macroman, I mean to skip the calculation if zeros encountered to speed up solution. Thanks.</p>\n\n<p>Titus, already wrote a fully pivoted LUD solver for VBA which can (slowly) solve sparse matrices. I just wanted to see if it was feasible to convert solver to Sparse techniques. Memory is not an issue, hence preference to avoid index/value storage technique, so I just wanted see if there was a fast way to make solver skip zeros to speed it up. Thanks.</p>\n"}], "owner": {"reputation": 1, "user_id": 5364558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d36ef6f8bcf54d1bb655574d686d2074?s=128&d=identicon&r=PG&f=1", "display_name": "user5364558", "link": "https://stackoverflow.com/users/5364558/user5364558"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1443607850, "creation_date": 1442945056, "last_edit_date": 1443083900, "question_id": 32723829, "link": "https://stackoverflow.com/questions/32723829/avoiding-multiplying-zeros-in-matrix-solver", "title": "Avoiding multiplying zeros in matrix solver", "body": "<p>Is there a way to avoid multiplying zeros as part of an inner a loop? As a laughable test I tried a conditional to stop the multiplication if it encounters a zero, and of course this is slower then just doing the multiplication. My preference is to leave the LU matrix intact, rather than rearrange to make zeros disappear (sparse). In this instance language is VBA prior to conversion to VB.net.</p>\n\n<pre><code>    For k = 1 To i - 1\n        If LU(j, k) &lt;&gt; 0 and LU(k, i) &lt;&gt; 0 Then temp = temp - LU(j, k) * LU(k, i) \n    Next k\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel", "textbox", "userform"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1442949034, "post_id": 32723402, "comment_id": 53292468, "body": "The answer to your question is yes - there is a way. You didn&#39;t ask how, but a simple answer is to find the number of relevant rows and then have VBA add that amount of rows when loading the userform."}, {"owner": {"reputation": 65, "user_id": 5305387, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2230940463e3dbede18d8abbbbc8eb2f?s=128&d=identicon&r=PG&f=1", "display_name": "StarShines", "link": "https://stackoverflow.com/users/5305387/starshines"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1442950089, "post_id": 32723402, "comment_id": 53293030, "body": "How ? Of course, I posted the question from &quot;how to do it&quot; perspective. Thanks"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1442950220, "post_id": 32723402, "comment_id": 53293093, "body": "What have you tried @StarShines?  <a href=\"http://mattgemmell.com/what-have-you-tried/\" rel=\"nofollow noreferrer\">mattgemmell.com/what-have-you-tried</a>"}, {"owner": {"reputation": 65, "user_id": 5305387, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2230940463e3dbede18d8abbbbc8eb2f?s=128&d=identicon&r=PG&f=1", "display_name": "StarShines", "link": "https://stackoverflow.com/users/5305387/starshines"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1442950479, "post_id": 32723402, "comment_id": 53293225, "body": "Scott, I am not a full-fledged software developer or programmer. I am an accountant and posting a generic question here for learning purposes. I wonder why everyone here is not following your wisdom of problem-solving. Your kind comment is well noted by the way. Cheers"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 5305387, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2230940463e3dbede18d8abbbbc8eb2f?s=128&d=identicon&r=PG&f=1", "display_name": "StarShines", "link": "https://stackoverflow.com/users/5305387/starshines"}, "edited": false, "score": 0, "creation_date": 1442950033, "post_id": 32725063, "comment_id": 53293005, "body": "Thank you for taking the time, but its giving me a blank userform."}, {"owner": {"reputation": 1, "user_id": 5209033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/722cb15492ee825165af44f2f525078f?s=128&d=identicon&r=PG&f=1", "display_name": "Reg the Retriever", "link": "https://stackoverflow.com/users/5209033/reg-the-retriever"}, "reply_to_user": {"reputation": 65, "user_id": 5305387, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2230940463e3dbede18d8abbbbc8eb2f?s=128&d=identicon&r=PG&f=1", "display_name": "StarShines", "link": "https://stackoverflow.com/users/5305387/starshines"}, "edited": false, "score": 0, "creation_date": 1442950521, "post_id": 32725063, "comment_id": 53293243, "body": "Create a command button on the form and within the Private sub CommandButton1 add the new line AddTextBoxes. When you click the button in the opened form it should call the sub AddTextBoxes"}, {"owner": {"reputation": 65, "user_id": 5305387, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2230940463e3dbede18d8abbbbc8eb2f?s=128&d=identicon&r=PG&f=1", "display_name": "StarShines", "link": "https://stackoverflow.com/users/5305387/starshines"}, "edited": false, "score": 0, "creation_date": 1442950716, "post_id": 32725063, "comment_id": 53293357, "body": "Dear Reg, I have added the code. Now when I run the userform and click the command button, 3 textboxes apper and showing values such as 999, 2, 3"}, {"owner": {"reputation": 65, "user_id": 5305387, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2230940463e3dbede18d8abbbbc8eb2f?s=128&d=identicon&r=PG&f=1", "display_name": "StarShines", "link": "https://stackoverflow.com/users/5305387/starshines"}, "edited": false, "score": 0, "creation_date": 1442950856, "post_id": 32725063, "comment_id": 53293421, "body": "May be I was unable to explain properly. The userform when loads should take the data from Sheet 1 and present it into textboxes as explained in my original post. Now if there are 30 rows of data with 3 columns, the userform is to create 90 textboxes with scrollbar and those textboxes would include data from Sheet 1, A2 to C31"}, {"owner": {"reputation": 1, "user_id": 5209033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/722cb15492ee825165af44f2f525078f?s=128&d=identicon&r=PG&f=1", "display_name": "Reg the Retriever", "link": "https://stackoverflow.com/users/5209033/reg-the-retriever"}, "reply_to_user": {"reputation": 65, "user_id": 5305387, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2230940463e3dbede18d8abbbbc8eb2f?s=128&d=identicon&r=PG&f=1", "display_name": "StarShines", "link": "https://stackoverflow.com/users/5305387/starshines"}, "edited": false, "score": 0, "creation_date": 1442951062, "post_id": 32725063, "comment_id": 53293544, "body": "I should have added that I misread your original post (didn&#39;t realise until after I posted) as I based my answer on the number of columns! Sorry. That said, the key code is the &quot;Set ctlTextBox=...&quot; line. This enables you to add controls to your form. The code within the With/End With block simply formats the text box."}, {"owner": {"reputation": 1, "user_id": 5209033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/722cb15492ee825165af44f2f525078f?s=128&d=identicon&r=PG&f=1", "display_name": "Reg the Retriever", "link": "https://stackoverflow.com/users/5209033/reg-the-retriever"}, "reply_to_user": {"reputation": 65, "user_id": 5305387, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2230940463e3dbede18d8abbbbc8eb2f?s=128&d=identicon&r=PG&f=1", "display_name": "StarShines", "link": "https://stackoverflow.com/users/5305387/starshines"}, "edited": false, "score": 0, "creation_date": 1442951142, "post_id": 32725063, "comment_id": 53293583, "body": "P.S. I can answer your amended request but won&#39;t be able to do so until tomorrow evening if that&#39;s okay?"}, {"owner": {"reputation": 65, "user_id": 5305387, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2230940463e3dbede18d8abbbbc8eb2f?s=128&d=identicon&r=PG&f=1", "display_name": "StarShines", "link": "https://stackoverflow.com/users/5305387/starshines"}, "edited": false, "score": 0, "creation_date": 1442951224, "post_id": 32725063, "comment_id": 53293621, "body": "No problem, please take your time and thank you very much for everything :)"}], "tags": [], "owner": {"reputation": 1, "user_id": 5209033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/722cb15492ee825165af44f2f525078f?s=128&d=identicon&r=PG&f=1", "display_name": "Reg the Retriever", "link": "https://stackoverflow.com/users/5209033/reg-the-retriever"}, "is_accepted": false, "score": 0, "last_activity_date": 1442949280, "creation_date": 1442949280, "answer_id": 32725063, "question_id": 32723402, "link": "https://stackoverflow.com/questions/32723402/automatically-creating-textboxes-based-on-number-of-rows/32725063#32725063", "title": "Automatically creating textboxes based on number of rows", "body": "<p>Assume a form named \"frmMain\" then to add 4 text boxes the following sub routine should do it:</p>\n\n<pre><code>Private Sub AddTextBoxes()\n\nDim ctlTextBox As MSForms.TextBox\nDim intCol, intCols As Integer\nDim strCName As String\n\n' Determine number of columns\nintCols = 1\nDo While Worksheets(\"Sheet1\").Cells(1, intCols).Value &lt;&gt; \"\"\n    intCols = intCols + 1\nLoop\n\n' Add text boxes\nFor intCol = 1 To intCols - 1\n    strCName = \"txtC\" &amp; intCol\n    Set ctlTextBox = frmMain.Controls.Add(\"Forms.Textbox.1\", strCName)\n\n    With ctlTextBox\n        .Top = 10\n        .Width = 50\n        .Height = 20\n        .Left = (intCol) * 60\n        .Value = intCol\n    End With\n\nNext\n\n' Assuming there is a column 1 (i.e. \"Invoice Data\") the control name will be \"txtC1\"\n' This box can be set by:\n\nfrmMain.Controls(\"txtC1\").Value = 999\n\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7713, "user_id": 830125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VF9pN.jpg?s=128&g=1", "display_name": "Drew Gaynor", "link": "https://stackoverflow.com/users/830125/drew-gaynor"}, "edited": false, "score": 0, "creation_date": 1442953202, "post_id": 32725860, "comment_id": 53294647, "body": "This should not be a new answer, but rather an update to your existing answer."}, {"owner": {"reputation": 65, "user_id": 5305387, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2230940463e3dbede18d8abbbbc8eb2f?s=128&d=identicon&r=PG&f=1", "display_name": "StarShines", "link": "https://stackoverflow.com/users/5305387/starshines"}, "edited": false, "score": 0, "creation_date": 1442956658, "post_id": 32725860, "comment_id": 53296529, "body": "Thank you for your efforts Reg. Highly appreciate that :)"}], "tags": [], "owner": {"reputation": 1, "user_id": 5209033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/722cb15492ee825165af44f2f525078f?s=128&d=identicon&r=PG&f=1", "display_name": "Reg the Retriever", "link": "https://stackoverflow.com/users/5209033/reg-the-retriever"}, "is_accepted": false, "score": 0, "last_activity_date": 1442952297, "creation_date": 1442952297, "answer_id": 32725860, "question_id": 32723402, "link": "https://stackoverflow.com/questions/32723402/automatically-creating-textboxes-based-on-number-of-rows/32725860#32725860", "title": "Automatically creating textboxes based on number of rows", "body": "<p>In addition to the above, add a frame to frmMain called \"fmeMain\" and set the following properties for fmeMain thus:</p>\n\n<p>ScrollBars = 2 - fmScrollBarsVertical\nScrollHeight = 800</p>\n\n<p>Add a command button to frmMain called \"cmdTest\". Add the following subroutines to the frmMain's code module:</p>\n\n<pre><code>Private Sub AddTextBoxes()\n\nDim ctlTextBox As MSForms.TextBox\nDim intCol, intRow, intTop As Integer\nDim strCName As String\n\nintTop = 10\n\nFor intRow = 2 To 31        ' Assumes that row 1 contains header\n\n    For intCol = 1 To 3\n\n        strCName = \"txtC\" &amp; intCol &amp; \"R\" &amp; intRow\n        Set ctlTextBox = frmMain.Controls(\"fmeMain\").Add(\"Forms.Textbox.1\", strCName)\n\n        With ctlTextBox\n            .Top = intTop\n            .Width = 50\n            .Height = 20\n            .Left = 52 * intCol\n            .Value = Worksheets(\"Sheet1\").Cells(intRow, intCol).Value\n        End With\n\n\n    Next\n\n    intTop = intTop + 25\n\nNext\n\n\nEnd Sub\n\n\n\nPrivate Sub cmdTest_Click()\n\nAddTextBoxes\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 5305387, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2230940463e3dbede18d8abbbbc8eb2f?s=128&d=identicon&r=PG&f=1", "display_name": "StarShines", "link": "https://stackoverflow.com/users/5305387/starshines"}, "edited": false, "score": 0, "creation_date": 1442956518, "post_id": 32726328, "comment_id": 53296472, "body": "Hi Drew ...Thank you for this code. Its working fine except for 2 things: (1) A1, B1 and C1 contains headers. (2) Since we wont know exactly how many invoices there will be for any customer, the userform only shows textboxes as per its own height. In other words, if 30 invoices, then 30 textboxes of for example date, if 58 invoices, then 58 textboxes of Invoice numbers. The number of invoices is variable. Thanks"}, {"owner": {"reputation": 7713, "user_id": 830125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VF9pN.jpg?s=128&g=1", "display_name": "Drew Gaynor", "link": "https://stackoverflow.com/users/830125/drew-gaynor"}, "reply_to_user": {"reputation": 65, "user_id": 5305387, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2230940463e3dbede18d8abbbbc8eb2f?s=128&d=identicon&r=PG&f=1", "display_name": "StarShines", "link": "https://stackoverflow.com/users/5305387/starshines"}, "edited": false, "score": 0, "creation_date": 1442957299, "post_id": 32726328, "comment_id": 53296833, "body": "The code will generate as many rows of text boxes as there are invoice rows- reading your question, that seems to be what you&#39;re looking for, yes? As for the header, just add an offset, which can be done by wrapping the contents of the <code>For</code>  loop of the <code>Initialize</code> method with a check: <code>If row.row &gt; 1 Then</code>"}, {"owner": {"reputation": 65, "user_id": 5305387, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2230940463e3dbede18d8abbbbc8eb2f?s=128&d=identicon&r=PG&f=1", "display_name": "StarShines", "link": "https://stackoverflow.com/users/5305387/starshines"}, "edited": false, "score": 0, "creation_date": 1442957983, "post_id": 32726328, "comment_id": 53297143, "body": "I don&#39;t know how to add image here but I am afraid the rows of textboxes are not the same as invoice rows. You can try it yourself by adding more data (may be more rows like 15,35,...etc) and see if it works or not, or may be, they are not visible on the userform due to userform height"}, {"owner": {"reputation": 7713, "user_id": 830125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VF9pN.jpg?s=128&g=1", "display_name": "Drew Gaynor", "link": "https://stackoverflow.com/users/830125/drew-gaynor"}, "reply_to_user": {"reputation": 65, "user_id": 5305387, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2230940463e3dbede18d8abbbbc8eb2f?s=128&d=identicon&r=PG&f=1", "display_name": "StarShines", "link": "https://stackoverflow.com/users/5305387/starshines"}, "edited": false, "score": 0, "creation_date": 1443010709, "post_id": 32726328, "comment_id": 53319307, "body": "@StarShines I think you&#39;ll have to add more detail to your question, including some code, possibly screenshots, and a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, Verifiable Example</a>. Best of luck!"}, {"owner": {"reputation": 65, "user_id": 5305387, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2230940463e3dbede18d8abbbbc8eb2f?s=128&d=identicon&r=PG&f=1", "display_name": "StarShines", "link": "https://stackoverflow.com/users/5305387/starshines"}, "edited": false, "score": 0, "creation_date": 1443029339, "post_id": 32726328, "comment_id": 53332384, "body": "I just said that the userform is not showing all textboxes, it has to have a scrollbar to go down in case we have many invoices. Thanks for your help though :)"}], "tags": [], "owner": {"reputation": 7713, "user_id": 830125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VF9pN.jpg?s=128&g=1", "display_name": "Drew Gaynor", "link": "https://stackoverflow.com/users/830125/drew-gaynor"}, "is_accepted": false, "score": 1, "last_activity_date": 1442953936, "creation_date": 1442953936, "answer_id": 32726328, "question_id": 32723402, "link": "https://stackoverflow.com/questions/32723402/automatically-creating-textboxes-based-on-number-of-rows/32726328#32726328", "title": "Automatically creating textboxes based on number of rows", "body": "<p>If you have a spreadsheet like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/4orEq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4orEq.png\" alt=\"enter image description here\"></a></p>\n\n<p>You can add a click handler to the Show Form button:</p>\n\n<pre><code>Sub FormButton_Click()\n    TestForm.Show\nEnd Sub\n</code></pre>\n\n<p>And within the TestForm code:</p>\n\n<pre><code>Option Explicit\n\nConst dateCol = 1\nConst invoiceNumCol = 2\nConst amountCol = 3\nConst paymentCol = 4\n\nPrivate Sub SaveButton_Click()\n    Dim row As Range\n    Dim box As Control\n\n    For Each row In ActiveSheet.Rows\n        On Error GoTo ExitHandler\n        row.Cells(1, paymentCol).value = Me.Controls(row.row &amp; paymentCol).value\n    Next row\n\nExitHandler:\n    Exit Sub\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n    Dim row As Range\n\n    For Each row In ActiveSheet.Rows\n        If row.Cells(1, dateCol).value = \"\" Then\n            Exit For\n        End If\n\n        Call AddBox(row, dateCol)\n        Call AddBox(row, invoiceNumCol)\n        Call AddBox(row, amountCol)\n        Call AddBox(row, paymentCol)\n    Next row\nEnd Sub\n\nPrivate Sub AddBox(row, colIndex)\n    Dim box As Control\n\n    Const width = 50\n    Const padWidth = width + 4\n    Const height = 15\n    Const padHeight = height + 4\n    Const topMargin = 25\n    Const leftMargin = 5\n\n    Set box = Me.Controls.Add(\"Forms.TextBox.1\", row.row &amp; colIndex)\n    box.Left = (colIndex - 1) * padWidth + leftMargin\n    box.height = height\n    box.width = width\n    box.Top = (row.row - 1) * padHeight + topMargin\n    box.value = row.Cells(1, colIndex).value\nEnd Sub\n</code></pre>\n\n<p>The form will appear like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ayx6Z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ayx6Z.png\" alt=\"enter image description here\"></a></p>\n\n<p>Values can be entered into the Paid column, and they will be copied to the spreadsheet when the Save button is clicked.</p>\n\n<p>To explain the logic, it loops through each populated row, creates the appropriate controls, and populates the values. In the Save routine, the rows are again looped through, and the payment values are copied back to the spreadsheet.</p>\n"}], "owner": {"reputation": 65, "user_id": 5305387, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2230940463e3dbede18d8abbbbc8eb2f?s=128&d=identicon&r=PG&f=1", "display_name": "StarShines", "link": "https://stackoverflow.com/users/5305387/starshines"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3113, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1442953936, "creation_date": 1442943644, "last_edit_date": 1442948642, "question_id": 32723402, "link": "https://stackoverflow.com/questions/32723402/automatically-creating-textboxes-based-on-number-of-rows", "title": "Automatically creating textboxes based on number of rows", "body": "<p>Is there a way in VBA Excel Userform to automatically create textboxes on the userform based on the number of rows on a particular sheet?</p>\n\n<p>My data is in Sheet 1 starting from A1, being:</p>\n\n<ul>\n<li>A1: Invoice Date</li>\n<li>B1: Invoice No.</li>\n<li>C1: Invoice Amount</li>\n<li>D1: Payment Received</li>\n</ul>\n\n<p>Now there are many rows of data (invoices) and there is no way one can know how many rows relate to a particular customer. The Payment received textboxes would be empty when the userform loads while Invoice Date, Invoice No. and Invoice Amount would be taken from Sheet 1.</p>\n\n<p>Then it would be very easy to fill the the payment received textboxes payments can be applied to a particular invoice.</p>\n"}, {"tags": ["vba", "ms-access-2010"], "answers": [{"tags": [], "owner": {"reputation": 432, "user_id": 3438477, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/P1IZ0.jpg?s=128&g=1", "display_name": "jtchase08", "link": "https://stackoverflow.com/users/3438477/jtchase08"}, "is_accepted": false, "score": 1, "last_activity_date": 1442950230, "creation_date": 1442950230, "answer_id": 32725313, "question_id": 32723392, "link": "https://stackoverflow.com/questions/32723392/vba-im-trying-to-save-a-report-as-a-pdf-but-it-only-opens-the-report/32725313#32725313", "title": "VBA - I&#39;m trying to save a report as a PDF, but it only opens the report", "body": "<p>Since you're unsure of where the code is breaking, I'd recommend removing all unnecessary parameters from</p>\n\n<pre><code>DoCmd.OutputTo acOutputReport, \"\", acFormatPDF, \"C:\\Users\\name\\Desktop\\test.pdf\", True\n</code></pre>\n\n<p>so you're left with something like this</p>\n\n<pre><code>DoCmd.OutputTo acOutputReport\n</code></pre>\n\n<p>You'll be prompted to put in file name and location, as well as choose file format. See if it saves properly. Then, place the first parameter back on the line of code:</p>\n\n<p>DoCmd.OutputTo acOutputReport, \"\"</p>\n\n<p>Repeat the process until the code breaks, and then you've narrowed down where you're crashing.</p>\n\n<p>From there, help could be more easily given.</p>\n"}, {"comments": [{"owner": {"reputation": 1393, "user_id": 1339826, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9gzjc.png?s=128&g=1", "display_name": "ernest", "link": "https://stackoverflow.com/users/1339826/ernest"}, "edited": false, "score": 0, "creation_date": 1443037097, "post_id": 32737814, "comment_id": 53336832, "body": "I run into the same issue with your example"}], "tags": [], "owner": {"reputation": 933, "user_id": 5345818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f648ca9f16c3a02a085cf79fa59c282?s=128&d=identicon&r=PG", "display_name": "asdev", "link": "https://stackoverflow.com/users/5345818/asdev"}, "is_accepted": false, "score": 1, "last_activity_date": 1443006094, "creation_date": 1443006094, "answer_id": 32737814, "question_id": 32723392, "link": "https://stackoverflow.com/questions/32723392/vba-im-trying-to-save-a-report-as-a-pdf-but-it-only-opens-the-report/32737814#32737814", "title": "VBA - I&#39;m trying to save a report as a PDF, but it only opens the report", "body": "<p>It seems that you want to open the report from a form and output it.</p>\n\n<p>The form does not know you want to output the report. \nSo you either have to add the doCmd.Output... to the code in the report, or you have to set specify object to the doCmd.Output... </p>\n\n<p>You can try:</p>\n\n<pre><code>DoCmd.OutputTo acOutputReport, \"report_name\", acFormatPDF, _ \n             \"C:\\Users\\name\\Desktop\\test.pdf\", True\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1393, "user_id": 1339826, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9gzjc.png?s=128&g=1", "display_name": "ernest", "link": "https://stackoverflow.com/users/1339826/ernest"}, "is_accepted": true, "score": 0, "last_activity_date": 1443037749, "creation_date": 1443037749, "answer_id": 32748296, "question_id": 32723392, "link": "https://stackoverflow.com/questions/32723392/vba-im-trying-to-save-a-report-as-a-pdf-but-it-only-opens-the-report/32748296#32748296", "title": "VBA - I&#39;m trying to save a report as a PDF, but it only opens the report", "body": "<p>The issue was a problem on the server I'm running this on. It doesn't have the necessary components to support exporting to PDF. When I changed the export format to RTF, it worked fine.</p>\n"}], "owner": {"reputation": 1393, "user_id": 1339826, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9gzjc.png?s=128&g=1", "display_name": "ernest", "link": "https://stackoverflow.com/users/1339826/ernest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 32748296, "answer_count": 3, "score": 0, "last_activity_date": 1443037749, "creation_date": 1442943591, "question_id": 32723392, "link": "https://stackoverflow.com/questions/32723392/vba-im-trying-to-save-a-report-as-a-pdf-but-it-only-opens-the-report", "title": "VBA - I&#39;m trying to save a report as a PDF, but it only opens the report", "body": "<p>My code is below. It opens the report, but it looks like it stops there. It never reaches the message box. So I'm guessing that it's failing at the export part. But my breakpoints don't trigger when I click my button. So I can't see what's happening.</p>\n\n<p>Any ideas on what's going on?</p>\n\n<pre><code>Private Sub Command552_Click()\n    DoCmd.OpenReport \"report_name\", acViewPreview, , \"[RowID] = 16094\"\n    DoCmd.OutputTo acOutputReport, \"\", acFormatPDF, \"C:\\Users\\name\\Desktop\\test.pdf\", True\n\n    DoCmd.Close acReport, \"report_name\"\n\n    MsgBox (\"done\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1442944854, "post_id": 32723241, "comment_id": 53289987, "body": "in your formula are C,RC1,C4 R1C1 format or are they supposed to be the actual cell address?"}, {"owner": {"reputation": 55, "user_id": 3105885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0vmKF.png?s=128&g=1", "display_name": "Forbidden", "link": "https://stackoverflow.com/users/3105885/forbidden"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1442945178, "post_id": 32723241, "comment_id": 53290165, "body": "@ScottCraner R1C1 format, but when I try the following code I get the same error:                <code>Cells(Target.Row, 3).FormulaR1C1 = &quot;=(INDEX(Roster!C,MATCH(Scan!RC1,Roster!C4,0))&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1442946092, "creation_date": 1442946092, "answer_id": 32724126, "question_id": 32723241, "link": "https://stackoverflow.com/questions/32723241/inserting-formula-with-target-column-issue/32724126#32724126", "title": "Inserting formula with target.column issue", "body": "<p>With it changing only one cell and the formula using cells from other sheets.  To make it work the formula should be in A1 format.</p>\n\n<p>Also you need to denote that it is a formula with the <code>.Formula</code></p>\n\n<p>Third, there was a missing close parenthesis.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n        If Target.Column = 2 Then\n        Sheets(\"Scan\").Cells(Target.Row, 3).Formula = \"=(INDEX(Roster!D\" &amp; Target.Row &amp; \",MATCH(Scan!D\" &amp; Target.Row &amp; \",Roster!G\" &amp; Target.Row &amp; \",0)))\"\n        End If\nEnd Sub\n</code></pre>\n\n<p>The cell address is based on your R1C1.  I may have the columns wrong double check.</p>\n"}], "owner": {"reputation": 55, "user_id": 3105885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0vmKF.png?s=128&g=1", "display_name": "Forbidden", "link": "https://stackoverflow.com/users/3105885/forbidden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 0, "accepted_answer_id": 32724126, "answer_count": 1, "score": 0, "last_activity_date": 1442946092, "creation_date": 1442943105, "question_id": 32723241, "link": "https://stackoverflow.com/questions/32723241/inserting-formula-with-target-column-issue", "title": "Inserting formula with target.column issue", "body": "<p>I am running into issues getting a formula to go into the cell next to the selected cell.\nI keep running into application-defined or object-defined errors</p>\n\n<p>Here is the code I am having trouble with</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n        If Target.Column = 2 Then            \n        Sheets(\"Scan\").Cells(Target.Row, 3) = \"=(INDEX(Roster!C,MATCH(Scan!RC1,Roster!C4,0))\"\n        End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1442943932, "post_id": 32723208, "comment_id": 53289443, "body": "So the table has the translated words? Or the translations are outside of the main table and you need to fix the main table referencing those?"}, {"owner": {"reputation": 37, "user_id": 3322937, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100001501209894/picture?type=large", "display_name": "Kristaps G", "link": "https://stackoverflow.com/users/3322937/kristaps-g"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1442944235, "post_id": 32723208, "comment_id": 53289618, "body": "There are two tables, one table contains two columns, columns one - words, column two - translated words. And i need to replace all the words in sheet, &quot;Set wsfin = ThisWorkbook.Worksheets(&quot;tulkojums&quot;)&quot; with those translations. Your second sentence is the right one!"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 3322937, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100001501209894/picture?type=large", "display_name": "Kristaps G", "link": "https://stackoverflow.com/users/3322937/kristaps-g"}, "edited": false, "score": 0, "creation_date": 1442945111, "post_id": 32723733, "comment_id": 53290134, "body": "Works like a charm! Thank you!"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1442947107, "post_id": 32723733, "comment_id": 53291395, "body": "One loop approach for this case is quick with clean code and is fast also."}], "tags": [], "owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "is_accepted": true, "score": 1, "last_activity_date": 1442944748, "creation_date": 1442944748, "answer_id": 32723733, "question_id": 32723208, "link": "https://stackoverflow.com/questions/32723208/best-way-to-apply-a-replace-function/32723733#32723733", "title": "Best way to apply a replace function", "body": "<p>Here's something I whipped up real quick, I'm sure you can adapt it to yours. You only need one loop.</p>\n\n<pre><code>Sub test()\nDim wsfix As Worksheet\nSet wsfix = Sheet1\nDim wskey As Worksheet\nSet wskey = Sheet2\n\nDim fixlastrow As Integer\nfixlastrow = wsfix.Cells(Rows.Count, 1).End(xlUp).Row\nDim keylastrow As Integer\nkeylastrow = wskey.Cells(Rows.Count, 1).End(xlUp).Row\n\n\nDim fndit As String\nDim repl As String\n\nFor i = 1 To keylastrow\n    fndit = wskey.Cells(i, 1)\n    repl = wskey.Cells(i, 2)\n    wsfix.Range(\"A1:B\" &amp; fixlastrow).Replace What:=fndit, Replacement:=repl\n\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 3322937, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100001501209894/picture?type=large", "display_name": "Kristaps G", "link": "https://stackoverflow.com/users/3322937/kristaps-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 32723733, "answer_count": 1, "score": 1, "last_activity_date": 1442944748, "creation_date": 1442942982, "last_edit_date": 1442944521, "question_id": 32723208, "link": "https://stackoverflow.com/questions/32723208/best-way-to-apply-a-replace-function", "title": "Best way to apply a replace function", "body": "<p>There is a table, with two columns:  </p>\n\n<ol>\n<li>words  </li>\n<li>translated words</li>\n</ol>\n\n<p>I need to replace all of the words in main table with the second column words.  </p>\n\n<p>What is the best way to change all of the values for a huge table?</p>\n\n<pre><code>Sub aizvietot_tulk()\n    Dim ws As Worksheet, tulkojumi As Worksheet\n\n    Set ws = ThisWorkbook.Worksheets(\"final_data\")\n    Set tulkojumi = ThisWorkbook.Worksheets(\"Lapa1\")\n    Set wsfin = ThisWorkbook.Worksheets(\"tulkojums\")\n\n    RowCount = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n    rowcountt = tulkojumi.Cells(tulkojumi.Rows.Count, \"A\").End(xlUp).Row\n\n    colcount = ws.UsedRange.Columns(ws.UsedRange.Columns.Count).Column\n    For i = 3 To RowCount\n\n        For j = 1 To colcount\n\n            vertiba = ws.Cells(i, j).Value\n\n            For k = 1 To rowcountt\n                mainamais = tulkojumi.Cells(k, 1).Value\n                jaunums = tulkojumi.Cells(k, 2).Value\n\n                nomainits = replace(vertiba, mainamais, jaunums)\n\n                wsfin.Cells(i, j) = Replace(vertiba, mainamais, jaunums)\n            Next k\n        Next j\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "edited": false, "score": 0, "creation_date": 1442943449, "post_id": 32723121, "comment_id": 53289195, "body": "Im not sure what are you asking. Is <code>search terms</code> a table or the thing you want to search? How is related <code>negative keywords</code> with search terms and output?"}], "answers": [{"comments": [{"owner": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "edited": false, "score": 0, "creation_date": 1442955611, "post_id": 32726373, "comment_id": 53296021, "body": "are you sure you need the leading spaces? &quot; attach &quot; won&#39;t match &quot;attach binder&quot;"}, {"owner": {"reputation": 1330, "user_id": 2340071, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1b7df7b14d4acb8db0ae1931c4ecce27?s=128&d=identicon&r=PG", "display_name": "Don George", "link": "https://stackoverflow.com/users/2340071/don-george"}, "reply_to_user": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "edited": false, "score": 0, "creation_date": 1443008193, "post_id": 32726373, "comment_id": 53317578, "body": "yes - you need the leading blanks on both terms so that &quot; attach &quot; will match &quot; attach binder &quot;.  They&#39;re needed to pick up matches at either the beginning or end of the search term."}, {"owner": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "edited": false, "score": 0, "creation_date": 1443012324, "post_id": 32726373, "comment_id": 53320492, "body": "ok, not sure how adding leading and trailing spaces to both the <code>phrase</code> and <code>exclude</code> help, should be the same result w/only trailing space after <code>exclude</code>"}, {"owner": {"reputation": 1330, "user_id": 2340071, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1b7df7b14d4acb8db0ae1931c4ecce27?s=128&d=identicon&r=PG", "display_name": "Don George", "link": "https://stackoverflow.com/users/2340071/don-george"}, "reply_to_user": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "edited": false, "score": 0, "creation_date": 1443017112, "post_id": 32726373, "comment_id": 53324332, "body": "the leading space is required on both to avoid a match where the negative word is found at the end of a word in the search term - ie, &quot;design&quot; and &quot;sign&quot; do not match"}, {"owner": {"reputation": 139, "user_id": 3179701, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nn1JA.jpg?s=128&g=1", "display_name": "ComputerGiant", "link": "https://stackoverflow.com/users/3179701/computergiant"}, "edited": false, "score": 0, "creation_date": 1443036904, "post_id": 32726373, "comment_id": 53336732, "body": "Awesome Don George! You even solved the problem of no spaces before and after the phrase by adding them to the query. Nice job! I accepted your answer because it 100% works, but I do have another wrinkle to my problem. [working the requirements out now]"}], "tags": [], "owner": {"reputation": 1330, "user_id": 2340071, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1b7df7b14d4acb8db0ae1931c4ecce27?s=128&d=identicon&r=PG", "display_name": "Don George", "link": "https://stackoverflow.com/users/2340071/don-george"}, "is_accepted": true, "score": 0, "last_activity_date": 1442954085, "creation_date": 1442954085, "answer_id": 32726373, "question_id": 32723121, "link": "https://stackoverflow.com/questions/32723121/search-table-for-whole-word-in-another-table-if-found-exclude-from-result/32726373#32726373", "title": "Search Table For Whole Word In Another Table, If Found Exclude From Result", "body": "<p>here's the query</p>\n\n<pre><code>SELECT SearchTerms.Phrase\nFROM SearchTerms, Negatives\nGROUP BY SearchTerms.Phrase\nHAVING (((Max(InStr(\" \" &amp; [phrase] &amp; \" \",\" \" &amp; [exclude] &amp; \" \")))=0));\n</code></pre>\n\n<p>Where SearchTerms is a table of the search terms and Phrase is the search term field, Negatives is the table with negative terms to exclude and Exclude is the field name in that table.</p>\n\n<p>The trick is that I added spaces before &amp; after the phrase, then looked for matches with the words to exclude and leading/trailing blanks.  This way I can identify only the phrases that match whole words and not parts of words.</p>\n\n<p>Worked fine when I set up the tables &amp; tested it.</p>\n"}], "owner": {"reputation": 139, "user_id": 3179701, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nn1JA.jpg?s=128&g=1", "display_name": "ComputerGiant", "link": "https://stackoverflow.com/users/3179701/computergiant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 32726373, "answer_count": 1, "score": 0, "last_activity_date": 1442954085, "creation_date": 1442942649, "question_id": 32723121, "link": "https://stackoverflow.com/questions/32723121/search-table-for-whole-word-in-another-table-if-found-exclude-from-result", "title": "Search Table For Whole Word In Another Table, If Found Exclude From Result", "body": "<p>Using MS Access, how would I create a query using SQL to search a table containing search terms (1 to 10 word phrases) for keywords or keyword phrases in another table, then exclude any matches to produce a list of search terms that did not match?</p>\n\n<h2>Search Terms Table Sample Data</h2>\n\n<ul>\n<li>tree house design </li>\n<li>nelson tree house master</li>\n<li>attachment point </li>\n<li>attach blinder</li>\n<li>stainless steel nails</li>\n</ul>\n\n<h2>Negative Keywords &amp; Keyword Phrases Sample Data</h2>\n\n<ul>\n<li>sign </li>\n<li>attach</li>\n<li>use</li>\n<li>steel</li>\n</ul>\n\n<h2>Desired Query Output</h2>\n\n<ul>\n<li>tree house design</li>\n<li>nelson tree house master</li>\n<li>attachment point</li>\n</ul>\n\n<p>NOTE: The Negative keywords include 'sign' and 'attach' but this should not prevent 'tree house design' and 'attachment point' from showing up in the result set. I am using Access 2007.</p>\n"}, {"tags": ["vba", "excel", "shapes"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1442977288, "post_id": 32723024, "comment_id": 53302409, "body": "Post your attempted solution. Try browsing <i>WorksheetEvents</i> to start with. Right now, you question is lacking detail and is off topic here."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5364497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81aada2cdfe8ab3a721c196c492ddef5?s=128&d=identicon&r=PG&f=1", "display_name": "jbillin4", "link": "https://stackoverflow.com/users/5364497/jbillin4"}, "edited": false, "score": 0, "creation_date": 1442950896, "post_id": 32723109, "comment_id": 53293443, "body": "Thank you for your response.  I&#39;m having a little trouble with the condition.  How can I have Excel refer to the range of A8:A10?  I&#39;m a little shaky on the VBA syntax."}, {"owner": {"reputation": 11, "user_id": 5364497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81aada2cdfe8ab3a721c196c492ddef5?s=128&d=identicon&r=PG&f=1", "display_name": "jbillin4", "link": "https://stackoverflow.com/users/5364497/jbillin4"}, "edited": false, "score": 0, "creation_date": 1442950966, "post_id": 32723109, "comment_id": 53293480, "body": "Sorry, one more question.  I have over 30 shapes I&#39;d like to format this way, is it possible to shorten the code by looking up the name of the shape, instead of having coding for each particular shape?"}, {"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "reply_to_user": {"reputation": 11, "user_id": 5364497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81aada2cdfe8ab3a721c196c492ddef5?s=128&d=identicon&r=PG&f=1", "display_name": "jbillin4", "link": "https://stackoverflow.com/users/5364497/jbillin4"}, "edited": false, "score": 0, "creation_date": 1443010128, "post_id": 32723109, "comment_id": 53318881, "body": "What condition are you looking for with this range? In other words when do you want the shapes to be visible and when do you want them to be invisible? If one shape is visible are they all visible?"}, {"owner": {"reputation": 11, "user_id": 5364497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81aada2cdfe8ab3a721c196c492ddef5?s=128&d=identicon&r=PG&f=1", "display_name": "jbillin4", "link": "https://stackoverflow.com/users/5364497/jbillin4"}, "edited": false, "score": 0, "creation_date": 1443034967, "post_id": 32723109, "comment_id": 53335640, "body": "Sorry, let me clarify:  the worksheet has several shapes on it (a map of the United States.  Small circles on the map represent certain cities.  I would like to have straight connectors between several of the cities.  Although there are many connectors, I want to only show up to three at a time, based on my selection in the range A8:A10.  If a certain connector is not named in the range, it should be invisible."}, {"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "reply_to_user": {"reputation": 11, "user_id": 5364497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81aada2cdfe8ab3a721c196c492ddef5?s=128&d=identicon&r=PG&f=1", "display_name": "jbillin4", "link": "https://stackoverflow.com/users/5364497/jbillin4"}, "edited": false, "score": 0, "creation_date": 1443036383, "post_id": 32723109, "comment_id": 53336410, "body": "I added a new edit to show you how you could do the condition. If this answer works for you, please click the green check mark next to this answer to mark your question as answered."}], "tags": [], "owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "is_accepted": false, "score": 0, "last_activity_date": 1443036171, "last_edit_date": 1443036171, "creation_date": 1442942612, "answer_id": 32723109, "question_id": 32723024, "link": "https://stackoverflow.com/questions/32723024/make-shapes-visible-if-a-range-contains-the-shapes-name/32723109#32723109", "title": "Make shapes visible if a range contains the shape&#39;s name", "body": "<p>Your statement should be:\n.Visible = msoTrue or .Visible = msoFalse</p>\n\n<pre><code>If yourCondition Then\n   Dim oActive As Worksheet     \n   Set oActive = ActiveSheet\n   oActive.Shapes(\"CharlotteTruck\").Visible = msoTrue\nEnd if\n</code></pre>\n\n<hr>\n\n<p>EDIT:</p>\n\n<p>This is a condition you could use:</p>\n\n<pre><code> If Not Intersect(Target, Range(\"A8:A10\")) Is Nothing Then\n    'condition to run when not clicked in range\n Cancel = True 'This line can be remove if not needed \n    'condition to run if cell in range was clicked\n End If\n</code></pre>\n\n<p>Let me know if this works for you</p>\n"}, {"tags": [], "owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "is_accepted": false, "score": 0, "last_activity_date": 1442997061, "creation_date": 1442997061, "answer_id": 32734594, "question_id": 32723024, "link": "https://stackoverflow.com/questions/32723024/make-shapes-visible-if-a-range-contains-the-shapes-name/32734594#32734594", "title": "Make shapes visible if a range contains the shape&#39;s name", "body": "<p>You can use this the code below. Assumption is that the shapes and your range are on the same sheet.</p>\n\n<pre><code>Public Sub Test()\n\n    ActivateShapes ActiveSheet.Range(\"A8:A10\")\n\nEnd Sub\n\nPublic Sub ActivateShapes(rInputRange As Range)\n\n    Dim rCell As Range\n\n    On Error Resume Next\n\n    For Each rCell In rInputRange\n        rInputRange.Parent.Shapes(rCell).Visible = msoTrue\n    Next rCell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5364497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81aada2cdfe8ab3a721c196c492ddef5?s=128&d=identicon&r=PG&f=1", "display_name": "jbillin4", "link": "https://stackoverflow.com/users/5364497/jbillin4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 570, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1443036171, "creation_date": 1442942316, "last_edit_date": 1443035275, "question_id": 32723024, "link": "https://stackoverflow.com/questions/32723024/make-shapes-visible-if-a-range-contains-the-shapes-name", "title": "Make shapes visible if a range contains the shape&#39;s name", "body": "<p>I'm new to the forum and still learning about VBA.</p>\n\n<p>My worksheet has several shapes on it (a map of the United States - each state has its own shape). Small circles placed over the map represent certain cities. I would like to have straight connectors between several of the cities. Although there are many connectors, I want to only show up to three at a time, based on my selection in the range A8:A10. If a certain connector is not named in the range, it should be invisible.</p>\n"}, {"tags": ["excel", "vba", "email", "smtp"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7746577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dc9601152cd816d812a2aef563a44f4?s=128&d=identicon&r=PG&f=1", "display_name": "user7746577", "link": "https://stackoverflow.com/users/7746577/user7746577"}, "is_accepted": false, "score": 0, "last_activity_date": 1490256867, "creation_date": 1490256867, "answer_id": 42970487, "question_id": 32722500, "link": "https://stackoverflow.com/questions/32722500/the-transport-failed-to-connect-to-the-server-when-trying-to-send-spreadsheet/42970487#42970487", "title": "&quot;The Transport Failed to Connect to the Server&quot; when trying to send spreadsheet via SMTP", "body": "<p>Dunno if this Works in your case, but I recently saw this in a similar post.</p>\n\n<p>Try removing the uppercase letters in Your schema url?</p>\n\n<p>\"Microsoft.Com\" -> \"microsoft.com\"</p>\n"}], "owner": {"reputation": 59, "user_id": 5364257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5be3f3b963ac091b204c64d8c7e82f0?s=128&d=identicon&r=PG", "display_name": "Thelps", "link": "https://stackoverflow.com/users/5364257/thelps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 895, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1490256867, "creation_date": 1442940708, "last_edit_date": 1442944019, "question_id": 32722500, "link": "https://stackoverflow.com/questions/32722500/the-transport-failed-to-connect-to-the-server-when-trying-to-send-spreadsheet", "title": "&quot;The Transport Failed to Connect to the Server&quot; when trying to send spreadsheet via SMTP", "body": "<p>I'm attempting to send an Excel spreadsheet via SMTP using the code displayed below. However, whenever I run the code I receive the error <strong>\"The Transport Failed to Connect to the Server\"</strong>.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>    Sub CommandButton_Click()\nDim CDO_Mail_Object As Object\nDim CDO_Config As Object\nDim SMTP_Config As Variant\nDim Email_Subject, Email_Send_From, Email_Send_To, Email_Cc, Email_Bcc, Email_Body As String\n\nEmail_Subject = \"Trying to send email using CDO\"\nEmail_Send_From = \"xxxxx@yahoo.com\"\nEmail_Send_To = \"xxxxx@hotmail.com\"\nEmail_Cc = \"\"\nEmail_Bcc = \"\"\nEmail_Body = \"Congratulations!!!! You have successfully sent an e-mail using CDO !!!!\"\n\nSet CDO_Mail_Object = CreateObject(\"CDO.Message\")\n\nOn Error GoTo debugs\nSet CDO_Config = CreateObject(\"CDO.Configuration\")\nCDO_Config.Load -1\nSet SMTP_Config = CDO_Config.Fields\nWith SMTP_Config\n'please put your server name below\n.Item(\"http://schemas.Microsoft.Com/cdo/configuration/smtpusessl\") = True\n.Item(\"http://schemas.Microsoft.Com/cdo/configuration/smtpusetls\") = True\n.Item(\"http://schemas.Microsoft.Com/cdo/configuration/smtpauthenticate\") = 1\n.Item(\"http://schemas.microsoft.com/cdo/configuration/sendusername\") = \"xxxxx@yahoo.com\"\n.Item(\"http://schemas.microsoft.com/cdo/configuration/sendpassword\") = \"xxxxx\"\n.Item(\"http://schemas.microsoft.com/cdo/configuration/sendusing\") = 2\n.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserver\") = \"smtp.mail.yahoo.co.uk\"\n.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserverport\") = 465\n.Update\nEnd With\n\nWith CDO_Mail_Object\nSet .Configuration = CDO_Config\nEnd With\n\nCDO_Mail_Object.Subject = Email_Subject\nCDO_Mail_Object.From = Email_Send_From\nCDO_Mail_Object.To = Email_Send_To\nCDO_Mail_Object.TextBody = Email_Body\nCDO_Mail_Object.cc = Email_Cc 'Use if needed\nCDO_Mail_Object.BCC = Email_Bcc 'Use if needed\n'CDO_Mail_Object.AddAttachment FileToAttach 'Use if needed\nCDO_Mail_Object.send\n\ndebugs:\nIf Err.Description &lt;&gt; \"\" Then MsgBox Err.Description\nEnd Sub\n</code></pre>\n\n<p>Are there errors in the above code (I have enabled the Microsoft CDO Library contained in Excel > Tools > References) or are there errors in the SMTP credentials I have provided?<br>\nAm I using the wrong Yahoo SMTP server (should I use .com)?</p>\n"}, {"tags": ["vba", "excel", "date", "formatting"], "comments": [{"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 1, "creation_date": 1442941587, "post_id": 32722348, "comment_id": 53288106, "body": "With &quot;sep-16&quot; the 16 is assumed as day and the year is assumed as not given, so it is assumed as this year. So the date is September, 16th 2015."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5364337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb8d02933cf976190a123201af9c28b6?s=128&d=identicon&r=PG&f=1", "display_name": "user5364337", "link": "https://stackoverflow.com/users/5364337/user5364337"}, "edited": false, "score": 0, "creation_date": 1442955593, "post_id": 32722544, "comment_id": 53296011, "body": "This suggestion carried the code further successfully, but did not place the correct date on my sheet. Here&#39;s the portion of my code where the date is placed in the sheet: dateloc.Value = result2  (dateloc is the range where the date is placed) when I hover over result2 after running this portion of the code, it says the correct date, but when it is placed in the sheet, the year changes (from 16 to 15). Suggestions?"}, {"owner": {"reputation": 1, "user_id": 5031729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d08292adcdf5e45ee2e68de3a9bd8b22?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Detweiler", "link": "https://stackoverflow.com/users/5031729/doug-detweiler"}, "reply_to_user": {"reputation": 1, "user_id": 5364337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb8d02933cf976190a123201af9c28b6?s=128&d=identicon&r=PG&f=1", "display_name": "user5364337", "link": "https://stackoverflow.com/users/5364337/user5364337"}, "edited": false, "score": 0, "creation_date": 1442971139, "post_id": 32722544, "comment_id": 53301036, "body": "I really don&#39;t know why you keep getting 2015 when 2016 was entered. You&#39;re setting the result of the user entry for the InputBox equal to a variable of type String, right? Can you post your code so it&#39;s clearer to understand?"}, {"owner": {"reputation": 1, "user_id": 5364337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb8d02933cf976190a123201af9c28b6?s=128&d=identicon&r=PG&f=1", "display_name": "user5364337", "link": "https://stackoverflow.com/users/5364337/user5364337"}, "edited": false, "score": 0, "creation_date": 1443011285, "post_id": 32722544, "comment_id": 53319725, "body": "finally got it to work - just broke down the elements of the date and concatenated in a string at the end of the code before placing in the sheet - DateFinal = Mnth &amp; &quot;/&quot; &amp; dd &amp; &quot;/&quot; &amp; Yr"}], "tags": [], "owner": {"reputation": 1, "user_id": 5031729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d08292adcdf5e45ee2e68de3a9bd8b22?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Detweiler", "link": "https://stackoverflow.com/users/5031729/doug-detweiler"}, "is_accepted": false, "score": 0, "last_activity_date": 1442970831, "last_edit_date": 1442970831, "creation_date": 1442940853, "answer_id": 32722544, "question_id": 32722348, "link": "https://stackoverflow.com/questions/32722348/why-is-excel-vba-changing-the-year-of-my-date-when-i-format-it/32722544#32722544", "title": "Why is Excel VBA changing the year of my date when I format it?", "body": "<p>Have the user put the date in as the program understands (e.g. mm/dd/yyyy) if the value resulting from the input box is going to be set equal to the value of a variable with type date. </p>\n\n<p>If, for some reason, the user must enter the date in \"mmm-yy\" format, set the input equal to the value of a string variable and then deconstruct the variable with [Month*] = Left([result],3) and [Year] = \"20\" &amp; right([result],2). Then, you have to build the date so that it can be set to a new variable of type date to put into your Format function.</p>\n\n<p>*Of course, you'll have to have some key to translate \"Jan\", \"Feb\", \"Mar\", etc. into values 01, 02, 03, etc.</p>\n\n<p>The below tested correctly for me:</p>\n\n<p>Public Sub UserDateEntry()</p>\n\n<pre><code>Dim strUserEntry As String\nDim intMonth As Integer, intYear As Integer\n\nstrUserEntry = InputBox(\"Enter month &amp; year in \"\"mmm-yy\"\" format.\", \"Date Entry\", \"Sep-16\")\n\nintMonth = Month(DateValue(\"01 \" &amp; Left(strUserEntry, 3) &amp; \" 2012\"))\nintYear = 20 &amp; Right(strUserEntry, 2)\n\nApplication.Range(\"DateLoc\").Value = Format(intMonth &amp; \" 01 \" &amp; intYear, \"mm/dd/yyyy\")\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 1, "user_id": 5364337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb8d02933cf976190a123201af9c28b6?s=128&d=identicon&r=PG&f=1", "display_name": "user5364337", "link": "https://stackoverflow.com/users/5364337/user5364337"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 428, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1442992476, "creation_date": 1442940144, "last_edit_date": 1442992476, "question_id": 32722348, "link": "https://stackoverflow.com/questions/32722348/why-is-excel-vba-changing-the-year-of-my-date-when-i-format-it", "title": "Why is Excel VBA changing the year of my date when I format it?", "body": "<p>I'm trying to format a date variable to look like <code>\"mmm-yy,\"</code> but when the date is 2016, after the formatting takes place, the date changes to 2015. Here is my code:</p>\n\n<p>(Result is the string result of an input box, the box requests that the user enter the date in <code>mmm-yy</code> form, and there is a test before this code to ensure that there is a hypen as the fourth character. </p>\n\n<p>The other validation tests occur after this code, as I found that the string had to be formatted as a date in order for the tests to work.) </p>\n\n<pre><code>        result2 = result\n        result2 = Format(result2, \"mmm-yy\")\n</code></pre>\n\n<p>Any suggestions?                                            </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1442940123, "post_id": 32722198, "comment_id": 53287179, "body": "Do you do anything with <code>intArr</code> ? I&#39;d load the numbers into an array and find the max from there."}, {"owner": {"reputation": 606, "user_id": 1571180, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/2988897d46e23d8ec739c1f43da9e264?s=128&d=identicon&r=PG", "display_name": "Saby", "link": "https://stackoverflow.com/users/1571180/saby"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1442940175, "post_id": 32722198, "comment_id": 53287201, "body": "Actually I was trying to populate the data in some array and find max from it, so I was using the intArr"}], "answers": [{"tags": [], "owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "is_accepted": true, "score": 2, "last_activity_date": 1442940810, "creation_date": 1442940810, "answer_id": 32722527, "question_id": 32722198, "link": "https://stackoverflow.com/questions/32722198/find-the-maximum-value/32722527#32722527", "title": "Find the maximum value", "body": "<p>I'd try it this way, using a dictionary as an index and looping through. It's not as quick as an array, so depending on your data size, it might be slow. You can do anything instead of the <code>msgbox</code> -</p>\n\n<pre><code>Sub test()\nDim dict As Object\nSet dict = CreateObject(\"scripting.dictionary\")\nDim lastrow As Long\nlastrow = Range(\"H65000\").End(xlUp).Row\nDim icntr As Long\n\nFor icntr = 5 To lastrow\nDim val As Long\nval = Cells(icntr, 8)\ndict(val) = 1\nNext\n\nDim maxval As Long\nFor Each Key In dict.keys\n    maxval = 1\n    For icntr = 5 To lastrow\n\n        If Cells(icntr, 8) = Key Then\n            If Cells(icntr, 9) &gt; maxval Then\n                maxval = Cells(icntr, 9)\n            End If\n        End If\n    Next\n    MsgBox (\"maximum for \" &amp; Key &amp; \" is \" &amp; maxval)\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 1, "creation_date": 1442941922, "post_id": 32722760, "comment_id": 53288305, "body": "Yeah, that&#39;d work if it&#39;s hard-coded like that, which I didn&#39;t consider. He could also just use the formula on the sheet referencing which roll he wants. Or just use a pivot table."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 1, "creation_date": 1442943467, "post_id": 32722760, "comment_id": 53289203, "body": "@Raystafarian I think your method is much more flexible than mine."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 3, "last_activity_date": 1442941473, "creation_date": 1442941473, "answer_id": 32722760, "question_id": 32722198, "link": "https://stackoverflow.com/questions/32722198/find-the-maximum-value/32722760#32722760", "title": "Find the maximum value", "body": "<p>With data in cols <strong>A</strong> and <strong>B</strong> use:</p>\n\n<pre><code>Sub dural()\n   MsgBox Evaluate(\"MAX(IF(A2:A9=10,B2:B9))\")\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/tnEuz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tnEuz.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is because <em>VBA</em> will assume the array formula.</p>\n"}, {"tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": false, "score": 0, "last_activity_date": 1443118086, "creation_date": 1443118086, "answer_id": 32768104, "question_id": 32722198, "link": "https://stackoverflow.com/questions/32722198/find-the-maximum-value/32768104#32768104", "title": "Find the maximum value", "body": "<p>You could use an autofilter to find the duplicates, then the subtotal function to find the maximum value...</p>\n\n<pre><code>Sub FindMaxWithinDuplicates()\n\n    Dim ws As Worksheet: Set ws = ActiveSheet\n    Dim LastRow As Long: LastRow = ws.Range(\"H65000\").End(xlUp).Row\n    Dim Tbl As Range: Set Tbl = ws.Range(Cells(5, 8), Cells(LastRow, 9))\n    Dim TblCriteria As Long: TblCriteria = 10\n\n    Dim MaxValue As Long\n\n    With ws\n        Tbl.AutoFilter Field:=1, Criteria1:=TblCriteria\n        MaxValue = Application.WorksheetFunction.Subtotal(104, Tbl.Columns(2))\n        Tbl.AutoFilter\n    End With\n\n    MsgBox MaxValue\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 606, "user_id": 1571180, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/2988897d46e23d8ec739c1f43da9e264?s=128&d=identicon&r=PG", "display_name": "Saby", "link": "https://stackoverflow.com/users/1571180/saby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 32722527, "answer_count": 3, "score": 0, "last_activity_date": 1443118086, "creation_date": 1442939686, "last_edit_date": 1442943555, "question_id": 32722198, "link": "https://stackoverflow.com/questions/32722198/find-the-maximum-value", "title": "Find the maximum value", "body": "<pre><code>roll marks\n10  900\n10  700\n10  800\n20  400\n20  400\n30  1700\n40  1800\n10  800\n</code></pre>\n\n<p>Suppose I have to find the maximum value for duplicate roll, like for 10 output will be 900 (max of 900, 700, 800, 800).</p>\n\n<p>I am able to find the duplicate but not able to find the max.</p>\n\n<pre><code>Sub sbFindDuplicatesInColumn()\n    Dim lastRow As Long\n    Dim matchFoundIndex As Long\n    Dim iCntr As Long\n    lastRow = Range(\"H65000\").End(xlUp).Row\n\n    For iCntr = 5 To lastRow\n    Dim intArr(1000) As Integer\n    Dim iCounter\n    iCounter = 0\n    If Cells(iCntr, 8) &lt;&gt; \"\" Then\n        matchFoundIndex = WorksheetFunction.Match(Cells(iCntr, 8), Range(\"H1:H\" &amp; lastRow), 0)\n        If iCntr &lt;&gt; matchFoundIndex Then\n\n            Cells(iCntr, 10) = \"Duplicate\"\n       End If\n    End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1811, "user_id": 4347950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/33c2cda3907b3f3014aee555819a8d68?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Dannemann", "link": "https://stackoverflow.com/users/4347950/joshua-dannemann"}, "edited": false, "score": 0, "creation_date": 1442937050, "post_id": 32721306, "comment_id": 53285186, "body": "You really need to edit this question for clarity."}, {"owner": {"reputation": 29, "user_id": 5178175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7N8V.jpg?s=128&g=1", "display_name": "RkChourasia", "link": "https://stackoverflow.com/users/5178175/rkchourasia"}, "reply_to_user": {"reputation": 1811, "user_id": 4347950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/33c2cda3907b3f3014aee555819a8d68?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Dannemann", "link": "https://stackoverflow.com/users/4347950/joshua-dannemann"}, "edited": false, "score": 0, "creation_date": 1442937248, "post_id": 32721306, "comment_id": 53285333, "body": "thanks for quick response in simple way - i just want to copy the 1st 15000 rows from filtered data."}, {"owner": {"reputation": 29, "user_id": 5178175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7N8V.jpg?s=128&g=1", "display_name": "RkChourasia", "link": "https://stackoverflow.com/users/5178175/rkchourasia"}, "reply_to_user": {"reputation": 1811, "user_id": 4347950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/33c2cda3907b3f3014aee555819a8d68?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Dannemann", "link": "https://stackoverflow.com/users/4347950/joshua-dannemann"}, "edited": false, "score": 0, "creation_date": 1442937290, "post_id": 32721306, "comment_id": 53285362, "body": "in simple way - i just want to copy the 1st 15000 visible* rows from filtered data."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 1, "creation_date": 1442937749, "post_id": 32721306, "comment_id": 53285670, "body": "I believe something like Range.SpecialCells(xlCellTypeVisible).Copy is what you want."}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 1, "creation_date": 1442939224, "post_id": 32721306, "comment_id": 53286609, "body": "After following @MatthewD&#39;s suggestion and pasting to a new sheet, delete rows after 15000."}], "answers": [{"comments": [{"owner": {"reputation": 1811, "user_id": 4347950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/33c2cda3907b3f3014aee555819a8d68?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Dannemann", "link": "https://stackoverflow.com/users/4347950/joshua-dannemann"}, "reply_to_user": {"reputation": 29, "user_id": 5178175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7N8V.jpg?s=128&g=1", "display_name": "RkChourasia", "link": "https://stackoverflow.com/users/5178175/rkchourasia"}, "edited": false, "score": 0, "creation_date": 1443136416, "post_id": 32722308, "comment_id": 53383809, "body": "Thanks. Since this worked for you, please click the checkmark next to the answer. This indicates to the community that you found the answer acceptable and gives both you and I additional reputation points."}], "tags": [], "owner": {"reputation": 1811, "user_id": 4347950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/33c2cda3907b3f3014aee555819a8d68?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Dannemann", "link": "https://stackoverflow.com/users/4347950/joshua-dannemann"}, "is_accepted": true, "score": 0, "last_activity_date": 1443022497, "last_edit_date": 1443022497, "creation_date": 1442940031, "answer_id": 32722308, "question_id": 32721306, "link": "https://stackoverflow.com/questions/32721306/select-limited-data-row-from-filtered-data/32722308#32722308", "title": "Select limited data row from filtered data", "body": "<p>This should work for you. I would suggest setting it up to run on a keyboard shortcut.</p>\n\n<pre><code>Const limit As Integer = 15000 \n\nSub GrabFiltered()\n    Dim r As Range\n    Dim lr As Range\n    Dim tr As Range\n    Dim rr As Range\n    Dim br As Range\n    Dim table As Range\n    Dim rows As Integer\n    Dim i As Integer\n    Dim ct As Integer\n    Dim offset As Integer\n\n    Set r = Selection.Cells(1, 1)\n    If r.End(xlToLeft).Cells(1, 1).FormulaR1C1 &lt;&gt; \"\" Then\n        Set lr = r.End(xlToLeft).Cells(1, 1)\n    Else\n        Set lr = r\n    End If\n    If lr.End(xlUp).Cells(1, 1).FormulaR1C1 &lt;&gt; \"\" Then\n        Set tr = lr.End(xlUp).Cells(1, 1)\n    Else\n        Set tr = lr\n    End If\n    If r.End(xlToRight).Cells(1, 1).FormulaR1C1 &lt;&gt; \"\" Then\n        Set rr = r.End(xlToRight).Cells(1, 1)\n    Else\n        Set rr = r\n    End If\n    rr.Select\n    If rr.End(xlDown).Cells(1, 1).FormulaR1C1 &lt;&gt; \"\" Then\n        Set br = rr.End(xlDown).Cells(1, 1)\n    Else\n        Set br = r\n    End If\n\n    Set table = Range(tr, br)\n\n    'count the number of rows that are visible\n    rows = 0\n    For i = 1 To table.rows.Count\n        If table.Cells(i, 1).Height &lt;&gt; 0 Then\n            rows = rows + 1\n        End If\n    Next\n\n    'limit the number of rows to copy\n    If rows &gt; limit Then\n        offset = rows - limit\n        i = 1\n        ct = 1\n        While i &lt;&gt; offset\n            If br.offset(-ct, 0).Height &lt;&gt; 0 Then\n                i = i + 1\n            End If\n            ct = ct + 1\n        Wend\n        Set br = br.offset(-ct, 0)\n        Set table = Range(tr, br)\n    End If\n\n    table.Copy\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 5178175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7N8V.jpg?s=128&g=1", "display_name": "RkChourasia", "link": "https://stackoverflow.com/users/5178175/rkchourasia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 32722308, "answer_count": 1, "score": -2, "last_activity_date": 1443022497, "creation_date": 1442936859, "last_edit_date": 1442943436, "question_id": 32721306, "link": "https://stackoverflow.com/questions/32721306/select-limited-data-row-from-filtered-data", "title": "Select limited data row from filtered data", "body": "<p>I have 70,000 rows of data in an Excel sheet. After applying a filter, the total number of visible rows becomes 40,000. Now I would like to select and copy the first 15,000 visible rows only.</p>\n"}, {"tags": ["arrays", "vba", "outlook"], "comments": [{"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1442937675, "post_id": 32721223, "comment_id": 53285627, "body": "There are static arrays, where you know the size at compile time. There are dynamic arrays where you allocate the size before assigning values and there are collections which dynamically adjust the size. What do you want?"}, {"owner": {"reputation": 55, "user_id": 5103528, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-B0tenfPbyfU/AAAAAAAAAAI/AAAAAAAAAEM/hakHgpX_4Dg/photo.jpg?sz=128", "display_name": "Richard", "link": "https://stackoverflow.com/users/5103528/richard"}, "reply_to_user": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1442937931, "post_id": 32721223, "comment_id": 53285799, "body": "well, considering I don&#39;t know the total of messages, I think the most appropriate would be dynamic. Not sure how to work with them in this case."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1442938109, "post_id": 32721223, "comment_id": 53285914, "body": "It kind of depends on what you want to do with the arrays afterwards. Also do you want multiple arrays for each information, or one array of <code>MessageItem</code> which contains all the information you need for each email?"}, {"owner": {"reputation": 55, "user_id": 5103528, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-B0tenfPbyfU/AAAAAAAAAAI/AAAAAAAAAEM/hakHgpX_4Dg/photo.jpg?sz=128", "display_name": "Richard", "link": "https://stackoverflow.com/users/5103528/richard"}, "reply_to_user": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1442939358, "post_id": 32721223, "comment_id": 53286699, "body": "I think one array containing all the info would be the best option. Could you provide some exemples over my code? I appreciate."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1442945783, "post_id": 32721223, "comment_id": 53290539, "body": "The answer below is sufficient."}], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 1, "last_activity_date": 1442938467, "creation_date": 1442938467, "answer_id": 32721817, "question_id": 32721223, "link": "https://stackoverflow.com/questions/32721223/array-in-for-each-vba/32721817#32721817", "title": "Array in For Each - VBA", "body": "<p>Outside of your procedure (at the top of the module) use:</p>\n\n<pre><code>Private Type EmailInfo\n    Sender As String\n    DateReceived As Date\n    Subject As String\nEnd Type\n</code></pre>\n\n<p>Then in your procedure use:</p>\n\n<pre><code>Dim emails() As EmailInfo\nDim i As Long: i = 1\n\nSet colItems = Fldr.Items\n\nReDim email(1 To colItems.Count) As EmailInfo\n\nFor Each objItem In colItems\n    With objItem\n        email(i).Sender = .SenderEmailAddress\n        email(i).DateReceived = .ReceivedTime\n        email(i).Subject = .Subject\n    End With\n\n    i = i + 1\nNext\n</code></pre>\n\n<p>Finally, for testing you can use this afterward:</p>\n\n<pre><code>For i = 1 To UBound(email)\n    Debug.Print email(i).Sender\n    Debug.Print email(i).DateReceived\n    Debug.Print email(i).Subject\nNext i\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 5103528, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-B0tenfPbyfU/AAAAAAAAAAI/AAAAAAAAAEM/hakHgpX_4Dg/photo.jpg?sz=128", "display_name": "Richard", "link": "https://stackoverflow.com/users/5103528/richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 372, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593517212, "creation_date": 1442936585, "last_edit_date": 1593517212, "question_id": 32721223, "link": "https://stackoverflow.com/questions/32721223/array-in-for-each-vba", "title": "Array in For Each - VBA", "body": "<p>I have a VBA code that performs a loop in a specific Outlook Folder, message by message.</p>\n\n<p>I\u2019d like to feed an array with the sender of each message(objItem.SenderEmailAddress), the date(objItem.ReceivedTime) and the subject(objItem.Subject).</p>\n\n<p>I don\u2019t have much experience with arrays, so would you like to get some suggestions.</p>\n\n<pre><code>Dim objItem As Variant\n\nSet colItems = Fldr.Items\n\nFor Each objItem In colItems\n\n    Feed the Array here                      \n\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 1, "creation_date": 1442937159, "post_id": 32721168, "comment_id": 53285275, "body": "What line gives you the error. Is FilePath defined as a string? If not it may be getting assigned as a cell based on FilePath = Range(&quot;C2&quot;). Define it as a string and do FilePath = Range(&quot;C2&quot;).Value"}, {"owner": {"reputation": 9396, "user_id": 658838, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c3f339119900406677ee99fdf4328048?s=128&d=identicon&r=PG", "display_name": "CustomX", "link": "https://stackoverflow.com/users/658838/customx"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1442990803, "post_id": 32721168, "comment_id": 53306761, "body": "I get the error at <code>Set y = ...</code> Filepath isn&#39;t defined as a string. Inside cell C2 I have the following <code>C:\\path\\filename.xlsx</code>"}], "answers": [{"tags": [], "owner": {"reputation": 142, "user_id": 4893008, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LZ37iMxOVjI/AAAAAAAAAAI/AAAAAAAAbPY/ODCh4KBI82g/photo.jpg?sz=128", "display_name": "Sohier Dane", "link": "https://stackoverflow.com/users/4893008/sohier-dane"}, "is_accepted": false, "score": -1, "last_activity_date": 1442956100, "creation_date": 1442956100, "answer_id": 32726960, "question_id": 32721168, "link": "https://stackoverflow.com/questions/32721168/application-defined-or-object-defined-error-on-workbook-filepath/32726960#32726960", "title": "Application-defined or object-defined error on workbook filepath", "body": "<p>MatthewD's comment is correct, and you also have a similar issue with each of the lines where you're doing the copying. Look's like you're not referencing the ranges or their values correctly. Also, I strongly recommend using Value2 instead of Value. Value2 is the one that returns the same result you would get if you used an Excel formula to set x = y, while Value truncates certain data. Almost certainly not a feature you want.</p>\n\n<pre><code>y.Sheets(\"Sheet1\").Range(\"B:B\").Value2 = x.Sheets(\"articles\").Range(\"A:A\").Value2\ny.Sheets(\"Sheet1\").Range(\"AD:AD\").Value2 = x.Sheets(\"articles\").Range(\"B:B\").Value2\n</code></pre>\n\n<p>Lastly, if these fixes don't resolve your issue, it would be extremely helpful if you could indicate which exact line of code triggers the error.</p>\n"}, {"comments": [{"owner": {"reputation": 9396, "user_id": 658838, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c3f339119900406677ee99fdf4328048?s=128&d=identicon&r=PG", "display_name": "CustomX", "link": "https://stackoverflow.com/users/658838/customx"}, "edited": false, "score": 0, "creation_date": 1442990587, "post_id": 32727217, "comment_id": 53306624, "body": "I tried your code, but now get an <code>Object doesn&#39;t support this method or object error</code>. Any suggestions? (i feel like an idiot, but it&#39;s been so long ago &gt;.&lt;)"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 9396, "user_id": 658838, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c3f339119900406677ee99fdf4328048?s=128&d=identicon&r=PG", "display_name": "CustomX", "link": "https://stackoverflow.com/users/658838/customx"}, "edited": false, "score": 0, "creation_date": 1443005881, "post_id": 32727217, "comment_id": 53316005, "body": "My mistake: <code>Worksheet(...)</code> should be <code>Worksheets(...)</code>. I fixed it, ran the code, and it works - please try it again"}, {"owner": {"reputation": 9396, "user_id": 658838, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c3f339119900406677ee99fdf4328048?s=128&d=identicon&r=PG", "display_name": "CustomX", "link": "https://stackoverflow.com/users/658838/customx"}, "edited": false, "score": 0, "creation_date": 1443013332, "post_id": 32727217, "comment_id": 53321258, "body": "now it changed error to Subscript out of range on ws1"}, {"owner": {"reputation": 9396, "user_id": 658838, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c3f339119900406677ee99fdf4328048?s=128&d=identicon&r=PG", "display_name": "CustomX", "link": "https://stackoverflow.com/users/658838/customx"}, "edited": false, "score": 1, "creation_date": 1443013560, "post_id": 32727217, "comment_id": 53321469, "body": "it worked by using <code>Set wb1 = ThisWorkbook</code> as <code>Set wb1 = ActiveWorkbook</code>"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 1, "last_activity_date": 1443020030, "last_edit_date": 1443020030, "creation_date": 1442957134, "answer_id": 32727217, "question_id": 32721168, "link": "https://stackoverflow.com/questions/32721168/application-defined-or-object-defined-error-on-workbook-filepath/32727217#32727217", "title": "Application-defined or object-defined error on workbook filepath", "body": "<p><code>Range(\"A\")</code> and <code>Range(\"B\")</code> are not proper ranges:</p>\n\n<pre><code>    Range(\"A\").Select   'this generates an error\n</code></pre>\n\n<p>.</p>\n\n<p>Try this (tested)</p>\n\n<pre><code>Option Explicit\n\nPublic Sub copyWorkBookDataColumns()\n\n    Dim wb1 As Workbook, ws1 As Worksheet, ur1 As Range\n    Dim wb2 As Workbook, ws2 As Worksheet, ur2 As Range, lr2 As Long\n\n    Application.ScreenUpdating = False\n\n    Set wb1 = ActiveWorkbook 'already open (file running current VBA code)\n    Set wb2 = Workbooks.Open(\"C:\\Users\\Username\\Desktop\\FileToOpen.xlsx\")\n\n    Set ws1 = wb1.Worksheets(\"articles\")    'copy to this Worksheet\n    Set ws2 = wb2.Worksheets(\"Sheet1\")      'copy from this Worksheet\n\n    Set ur1 = ws1.UsedRange                 'copy to this Range\n    Set ur2 = ws2.UsedRange                 'copy from this Range\n\n    lr2 = ur2.Row + ur2.Rows.Count          'last row in file2\n\n    'copy from ws2 to ws1\n    ws1.Range(\"A1:A\" &amp; lr2).Value2 = ws2.Range(\"B1:B\" &amp; lr2).Value2\n    ws1.Range(\"B1:B\" &amp; lr2).Value2 = ws2.Range(\"AD1:AD\" &amp; lr2).Value2\n\n    wb2.Close\n    Application.ScreenUpdating = False\nEnd Sub\n</code></pre>\n\n<p>Note: <code>...Range(\"B:B\")=...Range(\"A:A\")</code> will waste resources by copying 1 million+ values</p>\n"}, {"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1443015264, "creation_date": 1443015264, "answer_id": 32741105, "question_id": 32721168, "link": "https://stackoverflow.com/questions/32721168/application-defined-or-object-defined-error-on-workbook-filepath/32741105#32741105", "title": "Application-defined or object-defined error on workbook filepath", "body": "<p>Assuming you have posted the actual code that you are having issues with, your issue is most likely that \\username\\ is not an actual directory.  You will need to make that either hard coded to the actual name you are logged into the workstation with(if it is only going to be run by you) or make it dynamic for whomever is logged in.</p>\n\n<p>If your login is jsmith your desktop path would be.</p>\n\n<pre><code>Set wb2 = Workbooks.Open(\"C:\\Users\\jsmith\\Desktop\\FileToOpen.xlsx\")\n</code></pre>\n\n<p>To make it dynamic you will want to get the username from the system. Assuming you are using Windows:</p>\n\n<pre><code>Dim strUserName As String\nstrUserName = Environ$(\"Username\")\nSet wb2 = Workbooks.Open(\"C:\\Users\\\" &amp; strUserName  &amp; \"\\Desktop\\FileToOpen.xlsx\")\n</code></pre>\n\n<p>That handles the username, you will also have to change \\FileToOpen.xlsx to the actual name of the Excel workbook you are wanting to open. Ex. \\Inventory.xlsx</p>\n\n<p>NOTE: Some windows domains are setup so the user directory is username.domain. So if your domain is CORP your directory could be jsmith.CORP.</p>\n\n<p>If the above is not the problem you could try this.</p>\n\n<pre><code>Set wb2 = Workbooks.Open(Filename:=\"C:\\Users\\jsmith\\Desktop\\FileToOpen.xlsx\")\n</code></pre>\n\n<p>I have seen it done that way.</p>\n"}], "owner": {"reputation": 9396, "user_id": 658838, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c3f339119900406677ee99fdf4328048?s=128&d=identicon&r=PG", "display_name": "CustomX", "link": "https://stackoverflow.com/users/658838/customx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1733, "favorite_count": 0, "accepted_answer_id": 32727217, "answer_count": 3, "score": 1, "last_activity_date": 1443020030, "creation_date": 1442936378, "last_edit_date": 1531164843, "question_id": 32721168, "link": "https://stackoverflow.com/questions/32721168/application-defined-or-object-defined-error-on-workbook-filepath", "title": "Application-defined or object-defined error on workbook filepath", "body": "<p>I am trying to copy data from one workbook to my open workbook and always receive an <code>Application-defined or object-defined error</code>. </p>\n\n<p><code>X</code> is the path for the workbook I want to copy from and <code>Y</code> is the path for the workbook I'm in. The error returns on <code>set = y ...</code>.</p>\n\n<p>I followed this topic: <a href=\"https://stackoverflow.com/questions/26411037/link-columns-from-two-different-workbooks\">Link columns from two different workbooks</a></p>\n\n<pre><code>'\n' Import data from dump and articles into workbook\n'\n\n    Dim x As Workbook\n    Dim y As Workbook\n\n    Application.ScreenUpdating = False\n\n    FilePath = Range(\"C2\")\n\n    '## Open both workbooks first:\n    Set x = Workbooks.Open(FilePath)\n    Set y = Workbooks.Open(\"C:\\Users\\Username\\Desktop\\Filename.xlsx\")\n\n    'Now, copy what you want from x:\n    y.Sheets(\"Sheet1\").Range(\"B:B\").Value = x.Sheets(\"articles\").Range(\"A\")\n    y.Sheets(\"Sheet1\").Range(\"AD:AD\").Value = x.Sheets(\"articles\").Range(\"B\")\n\n    'Close x:\n    x.Close\n\n    Application.ScreenUpdating = False\n</code></pre>\n"}, {"tags": ["vba", "macos", "ms-word", "office-2016"], "owner": {"reputation": 21, "user_id": 5364001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2456b4359be3649ee02cb6c1d74405b3?s=128&d=identicon&r=PG&f=1", "display_name": "Ashtar", "link": "https://stackoverflow.com/users/5364001/ashtar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2559, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1592990701, "creation_date": 1442936112, "last_edit_date": 1592990701, "question_id": 32721081, "link": "https://stackoverflow.com/questions/32721081/mac-word-2016-change-templates-folder-location-programatically", "title": "Mac Word 2016 - Change Templates folder location programatically", "body": "<p>In Mac Word 2011, User Templates are stored here by default:<br>\n~\\Library\\Application Support\\Microsoft\\Office\\User Templates\\My Templates</p>\n\n<p>In Mac Word 2016, they appear to be stored here:<br>\n~\\Library\\Group Containers\\UBF8T346G9.Office\\User Content\\Templates</p>\n\n<p>I know I can manually change folder locations in the Word Preferences. Is there any way to change this location programmatically, either using VBA, Applescript, or the command line?</p>\n\n<p>The path change breaks existing solutions, so I'd like to be able to distribute a shell script or macro to users to automatically change the path back to the 2011 location.</p>\n"}, {"tags": ["excel", "formatting", "percentage", "vba"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1442936667, "post_id": 32720948, "comment_id": 53284910, "body": ".05 of 1 is 5 one hundredths, or 5% is it not?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1442936711, "post_id": 32720948, "comment_id": 53284950, "body": "The cell format will not affect the value you assign it programmatically. If your code assigns a value of 5 to a cell formatted as a percentage it will display 500%, not 5%."}, {"owner": {"reputation": 731, "user_id": 1505019, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7b88fdc5f054ea6f18af95365a85826b?s=128&d=identicon&r=PG", "display_name": "bmende", "link": "https://stackoverflow.com/users/1505019/bmende"}, "edited": false, "score": 0, "creation_date": 1442937141, "post_id": 32720948, "comment_id": 53285255, "body": "Well, &#39;myPercent&#39; var is already formatted as a percentage in my code. So myPercent = .05 , to me, means .05%. But I guess that&#39;s not how the computer processes it.  I can do myPercent/100 before I change my cell&#39;s value, but the final result seems to almost always be &#39;100%&#39; for some reason."}, {"owner": {"reputation": 731, "user_id": 1505019, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7b88fdc5f054ea6f18af95365a85826b?s=128&d=identicon&r=PG", "display_name": "bmende", "link": "https://stackoverflow.com/users/1505019/bmende"}, "edited": false, "score": 0, "creation_date": 1442937414, "post_id": 32720948, "comment_id": 53285441, "body": "Thanks Rory and MatthewD, I edited my question now to be more specefic"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1442938122, "post_id": 32720948, "comment_id": 53285926, "body": "In you comment to Trum&#39;s answer you say the correct answer is there then overwritten.  The problem is most likely somewhere else in your code.  could you post more of the code?  The answers that have been provided should work."}, {"owner": {"reputation": 731, "user_id": 1505019, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7b88fdc5f054ea6f18af95365a85826b?s=128&d=identicon&r=PG", "display_name": "bmende", "link": "https://stackoverflow.com/users/1505019/bmende"}, "edited": false, "score": 0, "creation_date": 1442941518, "post_id": 32720948, "comment_id": 53288062, "body": "Well, I looked at my code and realized that somewhere down the line I changed that cells value again to 100%. I didn&#39;t catch it because it happened before I looped, and so I thought it was some weird rounding thing. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 731, "user_id": 1505019, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7b88fdc5f054ea6f18af95365a85826b?s=128&d=identicon&r=PG", "display_name": "bmende", "link": "https://stackoverflow.com/users/1505019/bmende"}, "edited": false, "score": 0, "creation_date": 1442936471, "post_id": 32721136, "comment_id": 53284774, "body": "Ahh, but if &#39;myPercent&#39; is .05, I want the value to display as .05%"}, {"owner": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "reply_to_user": {"reputation": 731, "user_id": 1505019, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7b88fdc5f054ea6f18af95365a85826b?s=128&d=identicon&r=PG", "display_name": "bmende", "link": "https://stackoverflow.com/users/1505019/bmende"}, "edited": false, "score": 0, "creation_date": 1442936747, "post_id": 32721136, "comment_id": 53284977, "body": "You&#39;ve got me a little confused. 0.05 in Excel would be expressed as 5% as Excel works on a percentage of 0-1. If you wanted 0.05 as a percentage - you would need your variable to be 0.0005 or do:  Format(myPercent / 100, &quot;0.00%&quot;)  Is that what you were after?"}, {"owner": {"reputation": 731, "user_id": 1505019, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7b88fdc5f054ea6f18af95365a85826b?s=128&d=identicon&r=PG", "display_name": "bmende", "link": "https://stackoverflow.com/users/1505019/bmende"}, "edited": false, "score": 0, "creation_date": 1442937485, "post_id": 32721136, "comment_id": 53285498, "body": "Yes, exactly. I actually tried this and for some reason the final output is 100% in my cell. It shows as the correct value for a moment until I keep stepping through my code. (I edited my question to make my answer seem more simple now)"}, {"owner": {"reputation": 731, "user_id": 1505019, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7b88fdc5f054ea6f18af95365a85826b?s=128&d=identicon&r=PG", "display_name": "bmende", "link": "https://stackoverflow.com/users/1505019/bmende"}, "edited": false, "score": 0, "creation_date": 1442941421, "post_id": 32721136, "comment_id": 53287986, "body": "Ahh, I made a mistake and overwrote it to 100% somewhere else... Thanks"}, {"owner": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "reply_to_user": {"reputation": 731, "user_id": 1505019, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7b88fdc5f054ea6f18af95365a85826b?s=128&d=identicon&r=PG", "display_name": "bmende", "link": "https://stackoverflow.com/users/1505019/bmende"}, "edited": false, "score": 1, "creation_date": 1442995080, "post_id": 32721136, "comment_id": 53309187, "body": "No problem, easily done. I&#39;m glad that&#39;s sorted for you"}], "tags": [], "owner": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "is_accepted": true, "score": 2, "last_activity_date": 1442936288, "creation_date": 1442936288, "answer_id": 32721136, "question_id": 32720948, "link": "https://stackoverflow.com/questions/32720948/more-accurate-excel-percentage-formatting-behavior/32721136#32721136", "title": "More accurate Excel percentage formatting behavior", "body": "<p>You can do this easily by setting the percentage in the VBA - so:</p>\n\n<p>if your variable 'mypercent' is 0.05.</p>\n\n<pre><code>Worksheets(\"Sheet1\").cells(1,1).value = Format(myPercent, \"0.00%\")\n</code></pre>\n\n<p>Would display as 5.00% as expected.</p>\n\n<p>I hope that helps</p>\n"}], "owner": {"reputation": 731, "user_id": 1505019, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7b88fdc5f054ea6f18af95365a85826b?s=128&d=identicon&r=PG", "display_name": "bmende", "link": "https://stackoverflow.com/users/1505019/bmende"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 32721136, "answer_count": 1, "score": 1, "last_activity_date": 1442942150, "creation_date": 1442935733, "last_edit_date": 1531164843, "question_id": 32720948, "link": "https://stackoverflow.com/questions/32720948/more-accurate-excel-percentage-formatting-behavior", "title": "More accurate Excel percentage formatting behavior", "body": "<p>Why does the following code produce '100%' in my percentage-formatted <code>cells(1,1)</code></p>\n\n<pre><code>Worksheets(\"Sheet1\").cells(1,1).value = .05\n</code></pre>\n\n<p>EDIT: I made my question much simpler as the comments cleared up some of the confusion.</p>\n\n<p>EDIT: I realized later that I accidentally changed my cells() value again to 100%. Because it happened at a particular place in my code, I thought it was some sort of rounding issue. My problem should be solved now :).</p>\n"}, {"tags": ["html", "image", "vba", "email", "ms-access"], "comments": [{"owner": {"reputation": 933, "user_id": 5345818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f648ca9f16c3a02a085cf79fa59c282?s=128&d=identicon&r=PG", "display_name": "asdev", "link": "https://stackoverflow.com/users/5345818/asdev"}, "edited": false, "score": 0, "creation_date": 1442945671, "post_id": 32720769, "comment_id": 53290463, "body": "I tested your code and it worked perfectly with Access 2013 and Outlook 2010. Okay, I commented the last part out from strAttachments = &quot;2&quot;,  and the for loop.  Try it with another image. Maybe it is &quot;broken&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8142065, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/ca7aa71560e5e566d5423b70ec9e2022?s=128&d=identicon&r=PG", "display_name": "Eljefege", "link": "https://stackoverflow.com/users/8142065/eljefege"}, "is_accepted": false, "score": 0, "last_activity_date": 1497116500, "last_edit_date": 1497116500, "creation_date": 1497113706, "answer_id": 44475824, "question_id": 32720769, "link": "https://stackoverflow.com/questions/32720769/access-vba-why-doesnt-my-image-embed-into-the-html-email/44475824#44475824", "title": "Access VBA: Why doesn&#39;t my image embed into the HTML email?", "body": "<p>I had a similar problem.  My \"fix\" was to include a <code>.Display</code> before the <code>.Send</code>.</p>\n"}], "owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2121, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1497116500, "creation_date": 1442935215, "last_edit_date": 1495539885, "question_id": 32720769, "link": "https://stackoverflow.com/questions/32720769/access-vba-why-doesnt-my-image-embed-into-the-html-email", "title": "Access VBA: Why doesn&#39;t my image embed into the HTML email?", "body": "<p>I am using Microsoft Access to send out emails and am trying to insert an image into the email so that there is a signature.</p>\n\n<p>I am aware that for a recipient to see the image they must have access to it, so because the image is on my local hard drive I am trying to embed it into the body of the email.</p>\n\n<p>I have followed the link: <a href=\"https://stackoverflow.com/questions/6224766/how-to-add-an-embedded-image-to-an-html-message-in-outlook-2010\">How to add an embedded image to an HTML message in Outlook 2010</a></p>\n\n<p>To have the following code:</p>\n\n<pre><code>Dim MyOutlook As Object\nDim MyMessage As Object\nSet MyOutlook = CreateObject(\"Outlook.Application\")\nSet MyMessage = MyOutlook.CreateItem(0)\n\nDim colAttach As Outlook.Attachments\nDim oAttach As Outlook.Attachment\n\nSet colAttach = MyMessage.Attachments\nSet oAttach = colAttach.Add(\"C:\\user1\\Documents\\signature.jpg\")\n\nWith MyMessage\n\n    Dim Greeting As String\n    If Time &gt;= #12:00:00 PM# Then\n        Greeting = \"Afternoon,\"\n    Else\n        Greeting = \"Morning,\"\n    End If\n\n    .To = strTo\n    .Subject = strSubject\n    .HTMLBody = \"&lt;font face=Arial&gt;&lt;p&gt;\" &amp; \"Good \" + Greeting + \"&lt;/p&gt;\"\n    .HTMLBody = .HTMLBody + \"&lt;p&gt;\" &amp; \"Please find attached your latest document.\" &amp; \"&lt;/p&gt;\"\n    .HTMLBody = .HTMLBody + \"&lt;p&gt;\" &amp; \"If you have any questions....\" &amp; \"&lt;/p&gt;\"\n    .HTMLBody = .HTMLBody + \"&lt;p&gt;\" &amp; \"Kind Regards\" &amp; \"&lt;/p&gt;\"\n    .HTMLBody = .HTMLBody + \"&lt;p&gt;\" &amp; \"...\" &amp; \"&lt;/p&gt;&lt;/font&gt;\"\n    .HTMLBody = .HTMLBody + \"&lt;IMG alt='' hspace=0 src='cid:signature.jpg' align=baseline border=0&gt;\"\n\n    strAttachments = \"2\"\n     If strAttachments &lt;&gt; \"\" Then\n         For i = 0 To intNrAttch - 1\n            .Attachments.Add strFiles(i), 1, intPos\n         Next i\n     End If\n    .Send\nEnd With\n</code></pre>\n\n<p>But for some reason, what happens it'll attach the image to the email but not display it:</p>\n\n<p><a href=\"https://i.stack.imgur.com/L65e2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/L65e2.png\" alt=\"StackOverFlow\"></a>\nCan someone please help?</p>\n\n<p>It might be worth noting, that I can have pretty much the same code to send out an email with an image from Excel that work's, so I think there's something with Access that is preventing the code from working.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1442935009, "post_id": 32720606, "comment_id": 53283680, "body": "look into an advanced filter.  It should do what you want without the need of vba."}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1442938914, "post_id": 32720606, "comment_id": 53286416, "body": "Show us what have you tried so far."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1442939711, "post_id": 32720606, "comment_id": 53286901, "body": "@ExcelHero Using the copy to feature on the advanced filter will allow you to copy the filtered data to another sheet.  You just have to initiate the filter from the sheet where you want the data to go.  At least that is how I understand it.  <a href=\"http://excelsemipro.com/2011/03/copy-data-to-another-worksheet-with-advanced-filter/\" rel=\"nofollow noreferrer\">excelsemipro.com/2011/03/&hellip;</a>"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1442940646, "post_id": 32720606, "comment_id": 53287499, "body": "@BarryBlade Two things. Firstly, there are THREE records in your data sheet with a cost centre of 3000, but your question is asking for the TWO rows? Secondly, you ask if this can be done with <i>formulae</i> yet you have tagged the question with <code>excel-vba</code>. Can you clarify your question please?"}, {"owner": {"reputation": 2521, "user_id": 3250992, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/625932982113d9c5a46e88f442501cf3?s=128&d=identicon&r=PG&f=1", "display_name": "noobmaster69", "link": "https://stackoverflow.com/users/3250992/noobmaster69"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1442949803, "post_id": 32720606, "comment_id": 53292892, "body": "Many thanks all. I have added more detail to the question above. Notably the use case for this and the fact the data sheet contains about 3,600 rows.  @ExcelHero I will try your solution out. Looks promising. Hopefully still viable given my added detail above."}], "answers": [{"comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1442953272, "post_id": 32724520, "comment_id": 53294687, "body": "@BarryBlade How did it go?"}, {"owner": {"reputation": 2521, "user_id": 3250992, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/625932982113d9c5a46e88f442501cf3?s=128&d=identicon&r=PG&f=1", "display_name": "noobmaster69", "link": "https://stackoverflow.com/users/3250992/noobmaster69"}, "edited": false, "score": 0, "creation_date": 1442998401, "post_id": 32724520, "comment_id": 53310968, "body": "You&#39;re not just Excel&#39;s Hero...you&#39;re mine! The VBA works like a charm. I haven&#39;t tried the formula as the VBA is cleaner in my opinion"}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 0, "last_activity_date": 1442949385, "last_edit_date": 1442949385, "creation_date": 1442947350, "answer_id": 32724520, "question_id": 32720606, "link": "https://stackoverflow.com/questions/32720606/copy-data-from-one-sheet-data-to-another-summary/32724520#32724520", "title": "Copy data from one sheet (data) to another (summary)", "body": "<p><strong>METHOD #1</strong></p>\n\n<p>This is the formula way to achieve the filter.</p>\n\n<p>On the Summary sheet, select the range <code>A4:C22</code>.</p>\n\n<p>Click the Formula Bar at the top of the worksheet and paste the following formula:</p>\n\n<pre><code>=IFERROR(INDEX(Data!A2:C22,SMALL(IF($D$1=Data!$D$2:$D$22,ROW(Data!$D$2:$D$22)-ROW(Data!$D$2)+1),ROW()-3),{1,2,3}),\"\")\n</code></pre>\n\n<blockquote>\n  <p>This is an array formula and must be confirmed with <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Enter</kbd>.</p>\n</blockquote>\n\n<p>Now, as you update the value in cell D1, the filtered results will appear.</p>\n\n<p>Note: this assumes that you will have no more than 20 filtered results. If that assumption is incorrect then you will need to select a deeper range before you confirm the array-formula.</p>\n\n<p>Note: this assumes that the data on the data sheet do not extend further down than row 22. If the data do, then change the references of <code>22</code> in the formula to a larger number.</p>\n\n<p><strong>METHOD #2</strong></p>\n\n<p>This is a VBA soltuion.</p>\n\n<p>Place the following procedure in a standard code module:</p>\n\n<pre><code>Public Sub Barry()\n\n    Const DATA = \"data!a1\"\n    Const OUTPUT = \"a3:c3\"\n    Const FILTER_VALUE_ADDRESS = \"d1\"\n    Const FILTER_COLUMN = 4\n\n    Dim rCrit As Range, rData As Range\n\n    Set rData = Range(DATA).CurrentRegion\n    Set rCrit = rData.Resize(2, 1).Offset(, rData.Columns.Count + 2)\n    rCrit(1) = rData(1, FILTER_COLUMN): rCrit(2) = Range(FILTER_VALUE_ADDRESS)\n    rData.AdvancedFilter xlFilterCopy, rCrit, Range(OUTPUT)\n    rCrit.Clear\n\nEnd Sub\n</code></pre>\n\n<p>Switch to the Summary sheet and press Alt-F8 to bring up the Macro Dialog.</p>\n\n<p>Run <code>Barry</code>.</p>\n"}], "owner": {"reputation": 2521, "user_id": 3250992, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/625932982113d9c5a46e88f442501cf3?s=128&d=identicon&r=PG&f=1", "display_name": "noobmaster69", "link": "https://stackoverflow.com/users/3250992/noobmaster69"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 32724520, "answer_count": 1, "score": 0, "last_activity_date": 1442949890, "creation_date": 1442934805, "last_edit_date": 1531161705, "question_id": 32720606, "link": "https://stackoverflow.com/questions/32720606/copy-data-from-one-sheet-data-to-another-summary", "title": "Copy data from one sheet (data) to another (summary)", "body": "<p>I am trying to populate one worksheet (summary) with data from a large data dump held in another worksheet (data).  </p>\n\n<p><strong>This is going to be sent to budget holders within my organisation who will be able to filter on their cost centre and view their staff group.</strong></p>\n\n<p><strong>Summary worksheet</strong><br>\nThis is structured as follows:</p>\n\n<pre><code>|   |    A     |      B      |     C     |      D      |\n| 1 | Please choose a cost centre:         [Textfield] |\n| 2 |          |             |           |             |\n| 3 | POSITION | STAFF GROUP | PAY GRADE |             |\n| 4 | [Data will go here]\n| 5 | [Data will go here]\n| 6 | [Data will go here]\n</code></pre>\n\n<p><strong>Data worksheet</strong><br>\nThis is structured as follows (although with 3,600 rows and not 4):</p>\n\n<pre><code>|   |    A         |      B      |     C     |      D      |\n| 1 | POSITION     | STAFF GROUP | PAY GRADE | COST CENTRE |\n| 2 | Typist       | A&amp;C         | Junior    | 3000        |\n| 3 | Manager      | A&amp;C         | Mgmt      | 3200        |\n| 4 | Typist       | A&amp;C         | Junior    | 3000        |\n| 5 | Receptionist | A&amp;C         | Junior    | 3000        |\n</code></pre>\n\n<p><strong>The Exam Question</strong><br>\nUsing the textfield to select cost centre 3000, how can I populate the <em>Summary</em> worksheet with the two rows of data from the <em>Data</em> worksheet? Almost as if you could through a <em>pivot</em> table. Could this be done with formulae or will VBA be required?</p>\n"}, {"tags": ["vba", "ms-access", "parameters", "global-variables", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4962932, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153868687138496/picture?type=large", "display_name": "Scott David", "link": "https://stackoverflow.com/users/4962932/scott-david"}, "edited": false, "score": 0, "creation_date": 1442938738, "post_id": 32721013, "comment_id": 53286306, "body": "Thank you. That is what I thought was the case."}], "tags": [], "owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "is_accepted": true, "score": 1, "last_activity_date": 1442937753, "last_edit_date": 1442937753, "creation_date": 1442935922, "answer_id": 32721013, "question_id": 32720516, "link": "https://stackoverflow.com/questions/32720516/storing-multiple-parameters-in-global-constant/32721013#32721013", "title": "Storing Multiple Parameters in Global Constant", "body": "<p>What you want to do isn't possible. Your constant will be evaluated as if it is the name of the form. Since it is constant and not dynamic, I'd suggest to create separate procedures, such as</p>\n\n<pre class=\"lang-vbs prettyprint-override\"><code>Public Sub FormOpenEdit(sFormName As String)\n\n    DoCmd.OpenForm sFormName, acNormal, , \"ID=50\", acFormEdit, acWindowNormal, \"OPENARGS\"\n\nEnd Sub\n\nPublic Sub FormOpenAdd(sFormName As String)\n\n    DoCmd.OpenForm sFormName, acNormal, , \"ID=50\", acFormAdd, acWindowNormal, \"OPENARGS\"\n\nEnd Sub\n</code></pre>\n\n<p>Alternatively you could build a Enum to select the mode, so you can use just one sub</p>\n"}, {"tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1442986986, "creation_date": 1442986986, "answer_id": 32731819, "question_id": 32720516, "link": "https://stackoverflow.com/questions/32720516/storing-multiple-parameters-in-global-constant/32731819#32731819", "title": "Storing Multiple Parameters in Global Constant", "body": "<p>You can use the code below. I use it for opening forms right from ribbon menu \u2013 xml can store strings only. String with arguments should be slightly modified, as described in comments. \nIf you use DoCmd.OpenForm with default parameters and form default view is Datasheet, it opens as single form anyway. The function also includes a piece of code, which corrects this problem.</p>\n\n<pre><code>' non-constant arguments should be able to evaluated by Eval function\n' Replace quotes (\") by \"{\" and \"}\"\n' Example of arguments:\n'   \"acNormal, , {[CODE]='DO022666'}, acFormEdit, GetEditFormWindowMode()\"\n\nPublic Sub MyOpenForm(strFrm As String, strFrmArgs As String)\n    Dim frm As Form\n    Dim iDefView As Integer\n    Dim astrArgs() As String\n    Dim avArgs(6) As Variant\n    Dim i As Integer\n    Dim arg As Variant\n    Dim bArg0Defined As Boolean\n\n\n    'default args\n    avArgs(0) = acNormal\n    avArgs(3) = acFormEdit\n    avArgs(4) = acWindowNormal\n\n    astrArgs = Split(strFrmArgs, \",\")\n    For i = 0 To UBound(astrArgs)\n        If i &gt; 5 Then Exit For\n        arg = EvalFormArgument(astrArgs(i))\n        If Not IsNull(arg) Then\n            avArgs(i) = arg\n        End If\n    Next i\n\n    'If View argument ommited, check for DefaultView=Datasheet form property and open form in Datasheet view\n    bArg0Defined = False\n    If UBound(astrArgs) &gt; 0 Then\n        If Len(Trim(astrArgs(0))) &gt; 0 Then\n            bArg0Defined = True\n        End If\n    End If\n    If Not bArg0Defined Then\n        'Determine form properties\n        DoCmd.OpenForm strFrm, acDesign, , , , acHidden\n        Set frm = Forms(strFrm)\n        iDefView = frm.DefaultView\n        DoCmd.Close acForm, strFrm\n        Set frm = Nothing\n\n        If iDefView = 2 Then 'Datasheet view\n            avArgs(0) = acFormDS\n        End If\n    End If\n\n    DoCmd.OpenForm strFrm, avArgs(0), avArgs(1), avArgs(2), avArgs(3), avArgs(4), avArgs(5)\n\nEnd Sub\n\nPublic Function EvalFormArgument(A As String) As Variant\nDim ret As Variant\n\n\nA = Trim(A)\n\nIf A = \"\" Then\n    EvalFormArgument = Null\n    Exit Function\nEnd If\nSelect Case A\n    Case \"acNormal\": ret = 0\n    Case \"acDesign\": ret = 1\n    Case \"acFormDS\": ret = 3\n    Case \"acFormPivotChart\": ret = 5\n    Case \"acFormPivotTable\": ret = 4\n    Case \"acLayout\": ret = 6\n    Case \"acPreview\": ret = 2\n    Case \"acFormAdd\": ret = 0\n    Case \"acFormEdit\": ret = 1\n    Case \"acFormPropertySettings\": ret = -1\n    Case \"acFormReadOnly\": ret = 2\n    Case \"acDialog\": ret = 3\n    Case \"acHidden\": ret = 1\n    Case \"acIcon\": ret = 2\n    Case \"acWindowNormal\": ret = 0\n    Case Else\n        A = Replace(A, \"{\", \"\"\"\")\n        A = Replace(A, \"}\", \"\"\"\")\n        ret = Eval(A)\nEnd Select\nEvalFormArgument = ret\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4962932, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153868687138496/picture?type=large", "display_name": "Scott David", "link": "https://stackoverflow.com/users/4962932/scott-david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 32721013, "answer_count": 2, "score": 1, "last_activity_date": 1594643613, "creation_date": 1442934598, "last_edit_date": 1594643613, "question_id": 32720516, "link": "https://stackoverflow.com/questions/32720516/storing-multiple-parameters-in-global-constant", "title": "Storing Multiple Parameters in Global Constant", "body": "<p>I am using an Access 2010 database and I cannot figure out how to store multiple parameters for a function call in a single constant string. </p>\n\n<p>For example, let's say I want to open a form with the following:</p>\n\n<pre><code>DoCmd.OpenForm \"someformname\",acNormal,,\"ID=50\",acFormEdit, acWindowNormal,\"OPENARGS\"\n</code></pre>\n\n<p>Can I store all that in a global constant such as </p>\n\n<pre><code>Public Const C_FORMOPENEDIT as String\n</code></pre>\n\n<p>and then open the form like this?</p>\n\n<pre><code>DoCmd.OpenForm C_FORMOPENEDIT\n</code></pre>\n\n<p>It does not seem to work in this way. How can I get VBA to recognize that this is a series of parameters separated by commas? Or is this not possible?</p>\n\n<p>Note: I have attempted already to call it by the parameter name such as <code>FormName :=</code> and I have also already verified that any quotes in the string, where needed, are passed through. (like \"\"\")</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1442938877, "post_id": 32720342, "comment_id": 53286387, "body": "How exactly are you &quot;trying to tell Outlook to select only one mail item&quot;? You are no selecting an item, just reading the existing selection."}, {"owner": {"reputation": 79, "user_id": 4150544, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh3.googleusercontent.com/-EHymhtfm3_g/AAAAAAAAAAI/AAAAAAAAHfE/eS0fN-dUi_s/photo.jpg?sz=128", "display_name": "Austin Kargl", "link": "https://stackoverflow.com/users/4150544/austin-kargl"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1442950418, "post_id": 32720342, "comment_id": 53293199, "body": "Is the &quot;existing selection&quot; not the selected item? I suppose I figured that the (1) was an array specifying to pick &quot;1&quot; item, am I wrong in thinking that&#39;s an array?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1442954786, "post_id": 32720342, "comment_id": 53295534, "body": "Almost, it is a collection. Reading anything from that collection will not change the selection."}, {"owner": {"reputation": 79, "user_id": 4150544, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh3.googleusercontent.com/-EHymhtfm3_g/AAAAAAAAAAI/AAAAAAAAHfE/eS0fN-dUi_s/photo.jpg?sz=128", "display_name": "Austin Kargl", "link": "https://stackoverflow.com/users/4150544/austin-kargl"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1443012780, "post_id": 32720342, "comment_id": 53320847, "body": "Okay, thanks, that helps me understand quite a bit. I&#39;ll see if I can pin the code down to one file rather than one grouping of files."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 4150544, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh3.googleusercontent.com/-EHymhtfm3_g/AAAAAAAAAAI/AAAAAAAAHfE/eS0fN-dUi_s/photo.jpg?sz=128", "display_name": "Austin Kargl", "link": "https://stackoverflow.com/users/4150544/austin-kargl"}, "edited": false, "score": 0, "creation_date": 1443016824, "post_id": 32740235, "comment_id": 53324110, "body": "I was actually just looking at this article, thanks for confirming that it was the correct article to be looking at."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1443012994, "creation_date": 1443012994, "answer_id": 32740235, "question_id": 32720342, "link": "https://stackoverflow.com/questions/32720342/activeexplorer-inspector-selecting-more-than-one-item/32740235#32740235", "title": "ActiveExplorer/Inspector selecting more than one item", "body": "<p>Looks like you need to iterate over all items selected in the Explorer window:</p>\n\n<pre><code> Set currentItem = objApp.ActiveExplorer.Selection.Item(i)\n</code></pre>\n\n<p>For example:</p>\n\n<pre><code> For i = 1 To oSel.Count         ' Loop through all the currently .selected items\n    Set oItem = oSel.Item(i)    ' Get a selected item.\n Next i\n</code></pre>\n\n<p>Take a look at the <a href=\"https://support.microsoft.com/en-us/kb/240935\" rel=\"nofollow\">How To Get the Currently Selected Item in an Outlook Folder from Visual Basic</a> article for the sample code. </p>\n\n<p>Also I'd suggest breaking the chain of calls and declaring each property or method call on a separate line of code.  </p>\n"}], "owner": {"reputation": 79, "user_id": 4150544, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh3.googleusercontent.com/-EHymhtfm3_g/AAAAAAAAAAI/AAAAAAAAHfE/eS0fN-dUi_s/photo.jpg?sz=128", "display_name": "Austin Kargl", "link": "https://stackoverflow.com/users/4150544/austin-kargl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 837, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593306746, "creation_date": 1442934117, "last_edit_date": 1593306746, "question_id": 32720342, "link": "https://stackoverflow.com/questions/32720342/activeexplorer-inspector-selecting-more-than-one-item", "title": "ActiveExplorer/Inspector selecting more than one item", "body": "<p>I'm trying to tell Outlook to select only one mail item, but it appears to be selecting multiple (The internal program I'm sending it to is referencing \"These documents\" rather than \"this document\"). Because of that, it's not letting me choose a file type and I believe it's because the program is interpreting the file as a container instead of a file. <br><br>tl;dr: Can anyone see anything in my code that would be allowing Outlook to select more than one mail item?</p>\n\n<pre><code>Dim objApp As Outlook.Application\n    Set objApp = Application\nSelect Case TypeName(objApp.ActiveWindow)\n    Case \"Explorer\"\n        If objApp.ActiveExplorer.Selection.Count &gt; 0 Then\n            Set currentItem = objApp.ActiveExplorer.Selection.Item(1)\n        Else\n            MsgBox (\"No Message Selected.\")\n            Exit Sub\n        End If\n    Case \"Inspector\"\n        Set currentItem = objApp.ActiveInspector.currentItem\n    Case Else\n        MsgBox (\"Please select a mail item.\")\n        Exit Sub\nEnd Select\n</code></pre>\n"}, {"tags": ["excel", "vba", "email", "for-loop", "thunderbird"], "comments": [{"owner": {"reputation": 12976, "user_id": 1758762, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Nt89f.jpg?s=128&g=1", "display_name": "Leo Chapiro", "link": "https://stackoverflow.com/users/1758762/leo-chapiro"}, "edited": false, "score": 1, "creation_date": 1442934124, "post_id": 32720280, "comment_id": 53282997, "body": "Please formate your question properly!"}, {"owner": {"reputation": 1, "user_id": 5363887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28c01ac7e77e47357c42eccf9026cd48?s=128&d=identicon&r=PG&f=1", "display_name": "aloisk", "link": "https://stackoverflow.com/users/5363887/aloisk"}, "edited": false, "score": 0, "creation_date": 1442989054, "post_id": 32720280, "comment_id": 53305854, "body": "<code>@pnuts - thank you for edit</code>"}, {"owner": {"reputation": 1, "user_id": 5363887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28c01ac7e77e47357c42eccf9026cd48?s=128&d=identicon&r=PG&f=1", "display_name": "aloisk", "link": "https://stackoverflow.com/users/5363887/aloisk"}, "edited": false, "score": 0, "creation_date": 1443508907, "post_id": 32720280, "comment_id": 53509783, "body": "Hi all, any other suggestions?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5363887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28c01ac7e77e47357c42eccf9026cd48?s=128&d=identicon&r=PG&f=1", "display_name": "aloisk", "link": "https://stackoverflow.com/users/5363887/aloisk"}, "edited": false, "score": 0, "creation_date": 1442989279, "post_id": 32720484, "comment_id": 53305971, "body": "<code>@Bas Verlaat - thank you for suggestion. I tried this but it still doesn&#180;t work</code>"}], "tags": [], "owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "is_accepted": false, "score": -1, "last_activity_date": 1443017054, "last_edit_date": 1443017054, "creation_date": 1442934519, "answer_id": 32720484, "question_id": 32720280, "link": "https://stackoverflow.com/questions/32720280/repeated-1-mail-while-sending-mail-via-thunderbird-from-excel/32720484#32720484", "title": "Repeated 1 mail while sending mail via Thunderbird from Excel", "body": "<p>The code is a bit hard to read, but have your tried this:</p>\n\n<pre><code>file://\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>file:///  \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5363887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28c01ac7e77e47357c42eccf9026cd48?s=128&d=identicon&r=PG&f=1", "display_name": "aloisk", "link": "https://stackoverflow.com/users/5363887/aloisk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 223, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1489749088, "creation_date": 1442933916, "last_edit_date": 1489749088, "question_id": 32720280, "link": "https://stackoverflow.com/questions/32720280/repeated-1-mail-while-sending-mail-via-thunderbird-from-excel", "title": "Repeated 1 mail while sending mail via Thunderbird from Excel", "body": "<p>I have created VBA code for sending mails with different attachments to different addresses, via Thunderbird. The code looks correct but while creating particular mail bodies it uses still the first values. And the strange fact is that in the debugging window all looks correct and the values are changing.</p>\n\n<p><code>$</code></p>\n\n<pre><code>Option Explicit  \nSub SendMailThunder_Click()  \nDim strEmpfaenger1 As String  \nDim strBetr As String  \nDim strBody As String  \nDim strFile2 As Variant  \nDim strTh As String  \nDim strCommand As Variant  \nDim Nazev As String\nDim vysledek As Variant\nDim Seznam As Excel.Worksheet\nDim PS As Integer\nDim y As Long\n\nSet Seznam = ThisWorkbook.Worksheets(\"Ridici\")\n' number of items in the column\nPS = Seznam.Cells(Rows.Count, 11).End(xlUp).Row\n\nWith Seznam\n    For y = 4 To PS\n    '  Name of attachment\n    Nazev = .Cells(y, 12).Value\n    '  selected email\n    strEmpfaenger1 = .Cells(y, 15).Value\n    strBetr = .Range(\"O1\")\n    strBody = .Range(\"O2\")\n\n     strTh = \"C:\\Users\\alois.konecny\\AppData\\Local\\Mozilla Thunderbird\\thunderbird.exe\"\n    '  path to attachment\n        cesta = .Range(\"N1\")\n    '   attachment including path\n    priloha = \"\\\" &amp; Nazev &amp; \".xls\"\n    vysledek = cesta &amp; priloha\n    strFile2 = vysledek\n    strCommand = strCommand &amp; \" -compose \" &amp; \"to=\" &amp; Chr(34) &amp; strEmpfaenger1 &amp; Chr(34)\n    strCommand = strCommand &amp; \",subject=\" &amp; Chr(34) &amp; strBetr &amp;  Chr(34)\n    strCommand = strCommand &amp; \",body=\" &amp; Chr(34) &amp; strBody &amp; Chr(34)\n    strCommand = strCommand &amp; \",attachment=\" &amp; \"file:///\" &amp; Replace(strFile2, \"\\\", \"/\")\n    Shell strTh &amp; strCommand, vbNormalFocus\n    Next y\n\nEnd With\nEnd Sub  \n</code></pre>\n\n<p><code>$</code></p>\n"}, {"tags": ["html", "css", "image", "vba", "visual-studio"], "comments": [{"owner": {"reputation": 94334, "user_id": 2802040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCB9I.png?s=128&g=1", "display_name": "Paulie_D", "link": "https://stackoverflow.com/users/2802040/paulie-d"}, "edited": false, "score": 1, "creation_date": 1442933975, "post_id": 32720231, "comment_id": 53282888, "body": "CSS can&#39;t do anything to file size...You should optimize before uploading."}, {"owner": {"reputation": 120, "user_id": 5342612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rkRmN.jpg?s=128&g=1", "display_name": "Fearium", "link": "https://stackoverflow.com/users/5342612/fearium"}, "reply_to_user": {"reputation": 94334, "user_id": 2802040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCB9I.png?s=128&g=1", "display_name": "Paulie_D", "link": "https://stackoverflow.com/users/2802040/paulie-d"}, "edited": false, "score": 0, "creation_date": 1442934054, "post_id": 32720231, "comment_id": 53282938, "body": "but I dont want the non techie employees to have to worry about optimizing."}, {"owner": {"reputation": 120, "user_id": 5342612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rkRmN.jpg?s=128&g=1", "display_name": "Fearium", "link": "https://stackoverflow.com/users/5342612/fearium"}, "reply_to_user": {"reputation": 94334, "user_id": 2802040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCB9I.png?s=128&g=1", "display_name": "Paulie_D", "link": "https://stackoverflow.com/users/2802040/paulie-d"}, "edited": false, "score": 0, "creation_date": 1442934073, "post_id": 32720231, "comment_id": 53282955, "body": "What about jquery or vb? any suggestions?"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 1, "creation_date": 1442934497, "post_id": 32720231, "comment_id": 53283271, "body": "Imagemagick has a convert and resize functions that can do just about anything with an image."}], "answers": [{"comments": [{"owner": {"reputation": 120, "user_id": 5342612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rkRmN.jpg?s=128&g=1", "display_name": "Fearium", "link": "https://stackoverflow.com/users/5342612/fearium"}, "edited": false, "score": 0, "creation_date": 1442934636, "post_id": 32720427, "comment_id": 53283377, "body": "so with imagemagick, does the every employee who is pasting files need to install the source? or just me? im a little confused at how it works but ill research it further. Thanks"}, {"owner": {"reputation": 882, "user_id": 3984522, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6D9an.jpg?s=128&g=1", "display_name": "hsrv", "link": "https://stackoverflow.com/users/3984522/hsrv"}, "reply_to_user": {"reputation": 120, "user_id": 5342612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rkRmN.jpg?s=128&g=1", "display_name": "Fearium", "link": "https://stackoverflow.com/users/5342612/fearium"}, "edited": false, "score": 0, "creation_date": 1442935041, "post_id": 32720427, "comment_id": 53283714, "body": "It&#39;s better to write a preprocess function which will process every image and save already optimized images to display them on a web-site. The software should be installed only on a server which hosts your site and employees shouldn&#39;t be considered about that."}, {"owner": {"reputation": 120, "user_id": 5342612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rkRmN.jpg?s=128&g=1", "display_name": "Fearium", "link": "https://stackoverflow.com/users/5342612/fearium"}, "edited": false, "score": 0, "creation_date": 1442935406, "post_id": 32720427, "comment_id": 53283999, "body": "So I dont want to install anything new to the server, if i have to sacrifice image optimization that is fine. I just want the image to squeeze into the div and not be distorted no matter the size of the image. can that be done?"}, {"owner": {"reputation": 882, "user_id": 3984522, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6D9an.jpg?s=128&g=1", "display_name": "hsrv", "link": "https://stackoverflow.com/users/3984522/hsrv"}, "reply_to_user": {"reputation": 120, "user_id": 5342612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rkRmN.jpg?s=128&g=1", "display_name": "Fearium", "link": "https://stackoverflow.com/users/5342612/fearium"}, "edited": false, "score": 0, "creation_date": 1442935483, "post_id": 32720427, "comment_id": 53284064, "body": "Than, if I understand your needs, you could do it with only CSS: you have to specify instead of <code>width</code> -- <code>max-width</code> and <code>max-height</code>."}, {"owner": {"reputation": 120, "user_id": 5342612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rkRmN.jpg?s=128&g=1", "display_name": "Fearium", "link": "https://stackoverflow.com/users/5342612/fearium"}, "edited": false, "score": 0, "creation_date": 1442935549, "post_id": 32720427, "comment_id": 53284117, "body": "I know with CSS I could just set the image width to 100% depending on if the image is wider than the div, or height to 100% if it is taller, but because I have no control of what images they input, I cant set those properties or risk distortion. Is there an ASP If Then line you could help me think up?"}, {"owner": {"reputation": 120, "user_id": 5342612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rkRmN.jpg?s=128&g=1", "display_name": "Fearium", "link": "https://stackoverflow.com/users/5342612/fearium"}, "edited": false, "score": 0, "creation_date": 1442935617, "post_id": 32720427, "comment_id": 53284170, "body": "hsrv, what happens if the image they input is smaller then the max? do i set min values too?"}, {"owner": {"reputation": 882, "user_id": 3984522, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6D9an.jpg?s=128&g=1", "display_name": "hsrv", "link": "https://stackoverflow.com/users/3984522/hsrv"}, "reply_to_user": {"reputation": 120, "user_id": 5342612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rkRmN.jpg?s=128&g=1", "display_name": "Fearium", "link": "https://stackoverflow.com/users/5342612/fearium"}, "edited": false, "score": 0, "creation_date": 1442936371, "post_id": 32720427, "comment_id": 53284708, "body": "if the image is bigger with <code>max-width</code> and <code>max-height</code> there is no any distortion, but if the image is smaller there is a need to point sizes in %, here is an example using only CSS: <a href=\"https://jsfiddle.net/qk4fn8bq/1/\" rel=\"nofollow noreferrer\">jsfiddle.net/qk4fn8bq/1</a>"}, {"owner": {"reputation": 120, "user_id": 5342612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rkRmN.jpg?s=128&g=1", "display_name": "Fearium", "link": "https://stackoverflow.com/users/5342612/fearium"}, "edited": false, "score": 0, "creation_date": 1442937206, "post_id": 32720427, "comment_id": 53285302, "body": "Cute dogs lol, So this method works great IF I know that the image is either taller OR wider than my div. But in this case It will be random depending on the employees. I was there was a way to dynamically set the properties depending on what the employees paste in."}, {"owner": {"reputation": 120, "user_id": 5342612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rkRmN.jpg?s=128&g=1", "display_name": "Fearium", "link": "https://stackoverflow.com/users/5342612/fearium"}, "edited": false, "score": 0, "creation_date": 1442937771, "post_id": 32720427, "comment_id": 53285687, "body": "also I inputted an image that  has a width of 300 and a height of 445 into the field and yet the image shrinks without stretching, however it only fills half my div?"}, {"owner": {"reputation": 882, "user_id": 3984522, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6D9an.jpg?s=128&g=1", "display_name": "hsrv", "link": "https://stackoverflow.com/users/3984522/hsrv"}, "reply_to_user": {"reputation": 120, "user_id": 5342612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rkRmN.jpg?s=128&g=1", "display_name": "Fearium", "link": "https://stackoverflow.com/users/5342612/fearium"}, "edited": false, "score": 0, "creation_date": 1442938291, "post_id": 32720427, "comment_id": 53286037, "body": "You could try <code>background-image</code> property to fill the <code>div</code> fully, but you need to specify unique CSS-class for every <code>div</code> to point to an image with CSS code <code>background-image: url(http:&#47;&#47;www.example.com&#47;bck.png);</code>"}], "tags": [], "owner": {"reputation": 882, "user_id": 3984522, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6D9an.jpg?s=128&g=1", "display_name": "hsrv", "link": "https://stackoverflow.com/users/3984522/hsrv"}, "is_accepted": true, "score": 1, "last_activity_date": 1442934362, "creation_date": 1442934362, "answer_id": 32720427, "question_id": 32720231, "link": "https://stackoverflow.com/questions/32720231/automatically-resize-image-and-shrink-their-filesize/32720427#32720427", "title": "automatically resize image and shrink their filesize", "body": "<p>You need to use image processing tools like <code>imagemagick</code> or web-servers' <em>built-in filters</em> (<a href=\"https://developers.google.com/speed/pagespeed/module/filter-image-optimize\" rel=\"nofollow\">https://developers.google.com/speed/pagespeed/module/filter-image-optimize</a>).</p>\n"}], "owner": {"reputation": 120, "user_id": 5342612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rkRmN.jpg?s=128&g=1", "display_name": "Fearium", "link": "https://stackoverflow.com/users/5342612/fearium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "closed_date": 1442945555, "accepted_answer_id": 32720427, "answer_count": 1, "score": 0, "last_activity_date": 1442947615, "creation_date": 1442933771, "last_edit_date": 1442947615, "question_id": 32720231, "link": "https://stackoverflow.com/questions/32720231/automatically-resize-image-and-shrink-their-filesize", "closed_reason": "Not suitable for this site", "title": "automatically resize image and shrink their filesize", "body": "<p>I have created a dynamic website using VB and Classic-ASP. It allows co-workers to input relative data into fields on a .csv file. The changes they make go live on the website as soon as they hit save.</p>\n\n<p>There is one field for images that relates to a 285px X 175px container on the site. I want them to be able to put any image in that field and the image will transform to fit the container proportionally. But I want the image file size to also be optimized according to its new dimensions in order to save load time.</p>\n\n<p>Using CSS to set the img to 285x X 175px (same size as div) will do funny things to the image and doesn't optimize the file size.</p>\n\n<p>Any ideas on how to go about this? JS? ASP? Any better methods? To clarify, I dont want the employees to have to resize the image before they paste it in the .csv file.</p>\n\n<pre><code>HTML/ASP\n\n&lt;img class=\"secondaryboxpic\" src=\"images/&lt;%=ins3%&gt;\"&gt; \n\nCSS\n\nimg.secondaryboxpic{\n    margin: 0px 0px 0px -2px;\n    padding: 0px 0px 0px 0px;\n    width:285px;\n    height:175px;\n    float:left;  \n}\n</code></pre>\n\n<p>Just to let everyone know, I used a complex operation with foxpro server side that grabs each image and spits out a 285px X 175px thumbnail for use of the site. Thanks for your suggestions everyone.</p>\n\n<p><code>You can mark this as SOLVED.</code></p>\n"}, {"tags": ["excel", "wildcard", "vlookup", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5363828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7836acb2e0539d89db1ce89cca9994?s=128&d=identicon&r=PG&f=1", "display_name": "Gabbana", "link": "https://stackoverflow.com/users/5363828/gabbana"}, "edited": false, "score": 0, "creation_date": 1443000589, "post_id": 32726496, "comment_id": 53312376, "body": "Wow! I can kind of follow it. Just. I am getting a runtime 91 object variable not set error at &quot;wbt = k&quot; though. I&#39;ve looked at the help file, but am not clear about it."}, {"owner": {"reputation": 317, "user_id": 4539403, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/57e9499356c1425fbf8d5e8c0bc35e0a?s=128&d=identicon&r=PG&f=1", "display_name": "mozgov_net", "link": "https://stackoverflow.com/users/4539403/mozgov-net"}, "reply_to_user": {"reputation": 1, "user_id": 5363828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7836acb2e0539d89db1ce89cca9994?s=128&d=identicon&r=PG&f=1", "display_name": "Gabbana", "link": "https://stackoverflow.com/users/5363828/gabbana"}, "edited": false, "score": 0, "creation_date": 1443017505, "post_id": 32726496, "comment_id": 53324622, "body": "@Gabbana Sorry, forgot to put <code>set</code> - may bad, original post has been edited and fixed"}, {"owner": {"reputation": 317, "user_id": 4539403, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/57e9499356c1425fbf8d5e8c0bc35e0a?s=128&d=identicon&r=PG&f=1", "display_name": "mozgov_net", "link": "https://stackoverflow.com/users/4539403/mozgov-net"}, "reply_to_user": {"reputation": 1, "user_id": 5363828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7836acb2e0539d89db1ce89cca9994?s=128&d=identicon&r=PG&f=1", "display_name": "Gabbana", "link": "https://stackoverflow.com/users/5363828/gabbana"}, "edited": false, "score": 0, "creation_date": 1443104956, "post_id": 32726496, "comment_id": 53367030, "body": "@Gabbana please accept the answer if it has worked for you. You can do it by clicking the checkmark next to the answer. Glad I could help"}], "tags": [], "owner": {"reputation": 317, "user_id": 4539403, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/57e9499356c1425fbf8d5e8c0bc35e0a?s=128&d=identicon&r=PG&f=1", "display_name": "mozgov_net", "link": "https://stackoverflow.com/users/4539403/mozgov-net"}, "is_accepted": false, "score": 0, "last_activity_date": 1443105025, "last_edit_date": 1443105025, "creation_date": 1442954473, "answer_id": 32726496, "question_id": 32719607, "link": "https://stackoverflow.com/questions/32719607/vlookup-with-wildcard-to-file-excel/32726496#32726496", "title": "vlookup with wildcard to file excel", "body": "<p>Try this:</p>\n\n<pre><code>Sub wcard()\n\nDim k As Workbook 'looper\nDim wbs As Workbook 'source of the data\nDim wbt As Workbook 'target of the data\nDim ws As Worksheet 'source of the data\nDim wt As Worksheet 'target of the data\nDim i As Long 'just a counter\nDim lrow As Long 'variable for the lastrow formula\nDim wnm As String 'helps with the formula\n\n\nFor Each k In Workbooks 'loop through the open workbooks and \n'assign the source and target variables to the correct workbooks\n\n    If k.Name Like \"NW*.*\" Then\n\n        Set wbt = k\n\n    Else\n\n        If k.Name Like \"PD*Book1*.*\" Then\n\n            Set wbs = k\n        End If\n\n    End If\n\nNext k 'end of our loop\n\nSet ws = wbs.Sheets(\"Live\") 'assign sheets\nSet wt = wbt.Sheets(\"Master\") 'assign sheets\n\nwnm = wbs.Name\n\n\nlrow = wt.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n'find the last rows in your master file that has entries \n'(substitute \"A\" for the column by which you would determine that)\n\nFor i = 1 To lrow Step 1 'loop through the rows of your master to put the\n'formula in each of them\n\n    wt.Range(\"F\" &amp; i).Formula = \"=VLOOKUP(A\" &amp; i &amp; \",[\" &amp; wnm &amp; \"]Live'!$A:$A,1,0)\" \n    ' your formula - note that your sheet name and the range for the lookup do not change\n    'depending on the workbook, so no need to put them as variables\n\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5363828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7836acb2e0539d89db1ce89cca9994?s=128&d=identicon&r=PG&f=1", "display_name": "Gabbana", "link": "https://stackoverflow.com/users/5363828/gabbana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 556, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443105025, "creation_date": 1442932107, "last_edit_date": 1531164843, "question_id": 32719607, "link": "https://stackoverflow.com/questions/32719607/vlookup-with-wildcard-to-file-excel", "title": "vlookup with wildcard to file excel", "body": "<p>I run a simple VLOOKUP using 2 workbooks. This has traditionally been done manually, but now I need to automate the process every month:</p>\n\n<p>I usually use something like,</p>\n\n<p>=VLOOKUP(D1,'[PD1_Book1_15-09-22.xls]Live'!$A:$A,1,0) ..on the current workbook called NW 01-09, worksheet name \"Master\", cell F1. I then copy the entire function down the column. The end result being a lot of #N/A's which I filter out immediately. </p>\n\n<p>The problem is both workbooks change their name regularly (eg.. \"PD*<em>Book1</em><strong>-</strong>-<strong>.xls, in which case \"Book1\" is constant and NW **-</strong>, in which case NW is constant)</p>\n\n<p>So with \"Live\" sheet active on \"PD<em>_Book1_</em>.xls\" I've tried this, but can't get it to work at all.</p>\n\n<pre><code> Sub Lookup()\n myFileName = ActiveWorkbook.Name\n mySheetName = ActiveSheet.Name\n myRangeName = Range(\"A:A\")\n\n Dim wb As Workbook\n For Each wb In Workbooks\n If wb.Name Like \"NW*.*\" Then\n wb.Activate\n Exit Sub\n End If\n Next\n\n Range(\"F1\").Formula = \"=VLOOKUP(A1,[\" &amp; myFileName &amp; \"]\" &amp; mySheetName &amp; \"!\" &amp; myRangeName &amp; \",1,0)\"\n\n End Sub\n</code></pre>\n\n<p>I am totally lost on this one, any help would be great. If I can't get it to work on 1 cell, I have no clue how to fill all of them!</p>\n\n<p>The NW workbook will always be open as it's subject to a load of data cleaning via macro before we get to this point. I am happy for the PD*<em>Book1</em>**.xls to be opened now if it's easier. The data for lookup is on worksheet \"Live\"</p>\n\n<p>I'm new to vba, and think i've bitten off more than I can chew. Thanks in advance. </p>\n"}, {"tags": ["excel", "excel-2013", "vba"], "comments": [{"owner": {"reputation": 47294, "user_id": 3885376, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/XgeJ5.png?s=128&g=1", "display_name": "ROMANIA_engineer", "link": "https://stackoverflow.com/users/3885376/romania-engineer"}, "edited": false, "score": 3, "creation_date": 1442932303, "post_id": 32719467, "comment_id": 53281671, "body": "What happens if you change &quot;Summary&quot; with &quot;Summary2&quot;?  Probably that name is already used."}, {"owner": {"reputation": 517, "user_id": 5309440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/054b875bda6ac669d3754f2b514c54ca?s=128&d=identicon&r=PG&f=1", "display_name": "gabowsky", "link": "https://stackoverflow.com/users/5309440/gabowsky"}, "edited": false, "score": 0, "creation_date": 1442938523, "post_id": 32719467, "comment_id": 53286187, "body": "Are you sure there is an active worksheet present? It can also return &quot;Nothing&quot;, and that could be the cause of this error message! <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822753.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1461648071, "creation_date": 1461648071, "answer_id": 36855848, "question_id": 32719467, "link": "https://stackoverflow.com/questions/32719467/run-time-error-1004-in-excel-vba/36855848#36855848", "title": "Run-time error 1004 in Excel VBA", "body": "<p>I would take a guess that either:</p>\n\n<p>a sheet called Summary already exists (unlikely as I am pretty sure you would have checked this) or, it's a general error for a missing reference.</p>\n\n<p>In the VBE click tools / References and untick any that list as \"missing\"</p>\n"}], "owner": {"reputation": 9, "user_id": 5363756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26e5d477d0d2528e8face75844000905?s=128&d=identicon&r=PG&f=1", "display_name": "Santhosh Bandela", "link": "https://stackoverflow.com/users/5363756/santhosh-bandela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 318, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461648071, "creation_date": 1442931737, "last_edit_date": 1531161705, "question_id": 32719467, "link": "https://stackoverflow.com/questions/32719467/run-time-error-1004-in-excel-vba", "title": "Run-time error 1004 in Excel VBA", "body": "<p>I am using this code to copy paste the data from one workbook sheets to another workbook by creating the new workbook and sheets.</p>\n\n<p>at the <code>ActiveSheet.Name = \"Summary\"</code> it is throwing 1004 error.</p>\n\n<pre><code>Sub MakeExcelFiles()\n' create an Excel file from an Excel table\nDim DefFolder As String\nDim XMLFileName As String, RTC1 As Integer\nDim Counter As Integer\nDim CounterMax As Integer\nDim Name1 As String\nDefFolder = \"C:\\HRBPEMAIL\\\"   'change this to the location where you want to save Excel files\nCalculate\nCounter = 1\nCounterMax = 10\nSheets(\"Combinations\").Cells(1, 1).Value = Now()\n    For Counter = 1 To CounterMax\n        Range(\"B1\").Select\n        ActiveCell.FormulaR1C1 = Counter\n        Calculate\n        Name1 = Range(\"G1\")\n        XMLFileName = DefFolder &amp; Name1\n        Workbooks.Add\n        ActiveSheet.Name = \"Summary\"\n        'ActiveWorkbook.Worksheet(\"Sheet1\").Activate\n        'Sheets(\"Sheet1\").Select\n        'Sheets(\"Sheet1\").Name = \"Summary\"\n        'Sheets.Add After:=ActiveSheet\n        'ActiveWorkbook.Worksheet(\"Sheet2\").Activate\n        'Sheets(\"Sheet2\").Select\n        'Sheets(\"Sheet2\").Name = \"Data\"\n        Sheets.Add.Name = \"Data\"\n        ActiveWorkbook.SaveAs Filename:=XMLFileName, _\n        FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n        Windows(\"HRBP-Email-Master-Working-21-Sep-2015-Grand-Master-File_V1.xlsm\").Activate\n        Sheets(\"FinalData\").Select\n        Sheets(\"FinalData\").Range(\"A1:BN2200\").Copy\n        Application.Workbooks(Name1).Activate\n        Sheets(\"Data\").Select\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False\n        Application.CutCopyMode = False\n        Windows(\"HRBP-Email-Master-Working-21-Sep-2015-Grand-Master-File_V1.xlsm\").Activate\n        Sheets(\"Summary\").Select\n        Sheets(\"Summary\").Range(\"A1:D24\").Copy\n        Application.Workbooks(Name1).Activate\n        Sheets(\"Sheet1\").Select\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False\n        Windows(\"HRBP-Email-Master-Working-21-Sep-2015-Grand-Master-File_V1.xlsm\").Activate\n        Sheets(\"Summary\").Select\n        Sheets(\"Summary\").Range(\"A1:D24\").Copy\n        Application.Workbooks(Name1).Activate\n        Sheets(\"Sheet1\").Select\n        Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\n        Columns(\"B:B\").EntireColumn.AutoFit\n        Columns(\"D:D\").EntireColumn.AutoFit\n        Application.CutCopyMode = False\n        Range(\"A1\").Select\n        Application.Workbooks(Name).Save\n        Application.Workbooks(Name).Close\n        Windows(\"HRBP-Email-Master-Working-21-Sep-2015-Grand-Master-File_V1.xlsm\").Activate\n        Sheets(\"Combinations\").Select\n\nNext Counter\nSheets(\"Combinations\").Cells(2, 1).Value = Now()\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "vbscript", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 1971, "user_id": 626935, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4a89dcf8f5fabf39145bee7bbb9c8991?s=128&d=identicon&r=PG", "display_name": "Hanny", "link": "https://stackoverflow.com/users/626935/hanny"}, "edited": false, "score": 0, "creation_date": 1442933422, "post_id": 32719751, "comment_id": 53282501, "body": "I made those changes - still no dice."}, {"owner": {"reputation": 1971, "user_id": 626935, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4a89dcf8f5fabf39145bee7bbb9c8991?s=128&d=identicon&r=PG", "display_name": "Hanny", "link": "https://stackoverflow.com/users/626935/hanny"}, "edited": false, "score": 0, "creation_date": 1442933760, "post_id": 32719751, "comment_id": 53282740, "body": "I&#39;m not sure when it changed - but it appears it may have been something with my macro settings - odd.  The rule is working now as intended - I&#39;m sure your bits of code helped so I am marking it as the answer.   Thank you!"}], "tags": [], "owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "is_accepted": true, "score": 1, "last_activity_date": 1442932493, "creation_date": 1442932493, "answer_id": 32719751, "question_id": 32719172, "link": "https://stackoverflow.com/questions/32719172/outlook-vb-script-to-create-task-from-email-not-creating-task/32719751#32719751", "title": "Outlook VB Script to Create Task From Email - not creating task", "body": "<p>What I can see without running the script is this:</p>\n\n<p>You will have to save the TaskItem, after setting it (use .Save as the last line within the With)</p>\n\n<p>Also, you will probably have to set the ReminderTime matching the mailitem</p>\n\n<p>.ReminderTime = olMail.SentOn</p>\n\n<p>instead of </p>\n\n<p>.ReminderTime = objTask.DueDate</p>\n\n<p>because it isn't saved yet</p>\n"}], "owner": {"reputation": 1971, "user_id": 626935, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4a89dcf8f5fabf39145bee7bbb9c8991?s=128&d=identicon&r=PG", "display_name": "Hanny", "link": "https://stackoverflow.com/users/626935/hanny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 875, "favorite_count": 0, "accepted_answer_id": 32719751, "answer_count": 1, "score": 1, "last_activity_date": 1593517191, "creation_date": 1442930948, "last_edit_date": 1593517191, "question_id": 32719172, "link": "https://stackoverflow.com/questions/32719172/outlook-vb-script-to-create-task-from-email-not-creating-task", "title": "Outlook VB Script to Create Task From Email - not creating task", "body": "<p>I've got the following script which should for all that I can see, work without issue (and in fact at one point yesterday was working - but I must have inadvertently changed something when trying to clean up the code because it's no longer working today).</p>\n\n<p>Perhaps another set of eyes can help me.  I have a rule setup to set these emails into their own folder and run the script in Outlook.  That works without issue - the issue comes from the script itself.</p>\n\n<p>The subject of the emails that come in that get filtered are generally something like this:</p>\n\n<p>\"Ticket: 328157 School: BlahBlah Issues: Problems with flux capacitor\"</p>\n\n<p>The idea is that the script will create a task with the appropriate priority level and put it in the appropriate category (and include just the stuff in the subject after 'School\"' because the ticket # is not important).</p>\n\n<p>Here is the script:</p>\n\n<pre><code>Sub MakeTaskFromMail(MyMail As Outlook.MailItem)\nDim strID As String\nDim olNS As Outlook.NameSpace\nDim olMail As Outlook.MailItem\nDim objTask As Outlook.TaskItem\n\n'Get Specific Email based on ID\nstrID = MyMail.EntryID\nSet olNS = Application.GetNamespace(\"MAPI\")\nSet olMail = olNS.GetItemFromID(strID)\nSet objTask = Application.CreateItem(olTaskItem)\n'**************************\n'*****SET TASK SUBJECT*****\n'**************************\nDim sInput As String\nDim sOutput As String\n'get the email subject\nsInput = olMail.Subject\n'get all the text after School: in the subject\nsOutput = Mid(sInput, InStr(sInput, \"School:\") + 8)\n\nDim priorityUrgentString As String\nDim priorityHighString As String\nDim priorityMediumString As String\nDim priorityLowString As String\n'Set Priority Strings to check for to determine category\npriorityUrgentString = \"Priority: Urgent\"\npriorityHighString = \"Priority: High Priority\"\npriorityMediumString = \"Priority: Medium\"\npriorityLowString = \"Priority: Project\"\n'check to see if ticket is Urgent\n'if urgent - due date is today and alert is set for 8am\nIf InStr(olMail.Body, priorityUrgentString) &lt;&gt; 0 Then\n    With objTask\n        .Subject = sOutput\n        .DueDate = olMail.SentOn\n        .Body = olMail.Body\n        .Categories = \"Urgent\"\n        .Importance = olImportanceHigh\n        .ReminderSet = True\n        .ReminderTime = objTask.DueDate\n    End With\n'check to see if ticket is High Priority\n'if High Priority - due date is today - alert is set for 8am\nElseIf InStr(olMail.Body, priorityHighString) &lt;&gt; 0 Then\n    With objTask\n        .Subject = sOutput\n        .DueDate = olMail.SentOn + 2\n        .Body = olMail.Body\n        .Categories = \"High\"\n        .Importance = olImportanceHigh\n        .ReminderSet = True\n        .ReminderTime = objTask.DueDate + 2\n    End With\n'check to see if its a medium priority\n'if medium - due date is set for 7 days, no alert\nElseIf InStr(olMail.Body, priorityMediumString) &lt;&gt; 0 Then\n    With objTask\n        .Subject = sOutput\n        .DueDate = olMail.SentOn + 7\n        .Body = olMail.Body\n        .Categories = \"Medium\"\n        .Importance = olImportanceNormal\n    End With\n'check to see if its a project priority\n'if project - due date is set for 21 days, no alert\nElseIf InStr(olMail.Body, priorityLowString) &lt;&gt; 0 Then\n    With objTask\n        .Subject = sOutput\n        .DueDate = olMail.SentOn + 21\n        .Body = olMail.Body\n        .Categories = \"Project\"\n        .Importance = olImportanceLow\n    End With\nEnd If\n'Copy Attachments\nCall CopyAttachments(olMail, objTask)\n'Save Task\nobjTask.Save\n\nSet objTask = Nothing\nSet olMail = Nothing\nSet olNS = Nothing\nEnd Sub\n\nSub CopyAttachments(objSourceItem, objTargetItem)\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet fldTemp = fso.GetSpecialFolder(2) ' TemporaryFolder\nstrPath = fldTemp.Path &amp; \"\\\"\nFor Each objAtt In objSourceItem.Attachments\nstrFile = strPath &amp; objAtt.FileName\nobjAtt.SaveAsFile strFile\nobjTargetItem.Attachments.Add strFile, , , objAtt.DisplayName\nfso.DeleteFile strFile\nNext\n\nSet fldTemp = Nothing\nSet fso = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "if-statement", "countif"], "comments": [{"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1442931101, "post_id": 32718985, "comment_id": 53280761, "body": "Looks fine, though you don&#39;t need &quot;Call&quot; anymore, and you could put <code>User</code> in the <code>Countif</code> function where <code>&quot;User 1&quot;</code> is. Are you going to be deploying the same logic against multiple users?"}, {"owner": {"reputation": 141, "user_id": 5341242, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Bh8YE.jpg?s=128&g=1", "display_name": "Wowdude", "link": "https://stackoverflow.com/users/5341242/wowdude"}, "reply_to_user": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1442931579, "post_id": 32718985, "comment_id": 53281132, "body": "Hi @puzzlepiece87 I did originally use the &quot;User&quot; in the Countif instead of &quot;User 1&quot; but in a desperate attempt to get the code to work I changed it to the direct text. I keep getting the dreaded &quot;Run-time error &#39;1004&#39; - Application-defined or object-defined error&quot; for the line of the countif logic, and never know ho to go about fixing it. I was wondering if there was anything silly i&#39;d done/missed that was causing it? Thanks"}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1442931782, "post_id": 32718985, "comment_id": 53281296, "body": "Just to clarify, do you only get the 1004 with the variable name in there, or also now with the direct text?"}, {"owner": {"reputation": 481, "user_id": 4647394, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06d6fcb008fd47cdc43d3964580baf4a?s=128&d=identicon&r=PG&f=1", "display_name": "seadoggie01", "link": "https://stackoverflow.com/users/4647394/seadoggie01"}, "edited": false, "score": 1, "creation_date": 1442931820, "post_id": 32718985, "comment_id": 53281333, "body": "Why do you have A2:A in your countif function? I think that might cause an error."}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 1, "creation_date": 1442931909, "post_id": 32718985, "comment_id": 53281402, "body": "@wowdude Did you try qualifying the worksheet with its workbook? Try <code>iVal = Application.WorksheetFunction.CountIf(ActiveWorkbook.Workshe&zwnj;&#8203;ets(&quot;Unallocated&quot;).R&zwnj;&#8203;ange(&quot;A2:A&quot;), User)</code>"}, {"owner": {"reputation": 141, "user_id": 5341242, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Bh8YE.jpg?s=128&g=1", "display_name": "Wowdude", "link": "https://stackoverflow.com/users/5341242/wowdude"}, "reply_to_user": {"reputation": 481, "user_id": 4647394, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06d6fcb008fd47cdc43d3964580baf4a?s=128&d=identicon&r=PG&f=1", "display_name": "seadoggie01", "link": "https://stackoverflow.com/users/4647394/seadoggie01"}, "edited": false, "score": 0, "creation_date": 1442932094, "post_id": 32718985, "comment_id": 53281529, "body": "Ah, quite right @seadoggie01. I have removed this and simply change it to &quot;A:A&quot; which seems to work fine. Thanks! It would seem now, however, that whether or not occurrences of &quot;User 1&quot; are found in column A, the whole of the code is run, ignoring the If statement and &quot;Then GoTo&quot; sections. Any ideas?"}, {"owner": {"reputation": 481, "user_id": 4647394, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06d6fcb008fd47cdc43d3964580baf4a?s=128&d=identicon&r=PG&f=1", "display_name": "seadoggie01", "link": "https://stackoverflow.com/users/4647394/seadoggie01"}, "edited": false, "score": 0, "creation_date": 1442932295, "post_id": 32718985, "comment_id": 53281661, "body": "@Wowdude, I think you need an exit sub before your ALabel, otherwise it will run no matter what."}, {"owner": {"reputation": 141, "user_id": 5341242, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Bh8YE.jpg?s=128&g=1", "display_name": "Wowdude", "link": "https://stackoverflow.com/users/5341242/wowdude"}, "reply_to_user": {"reputation": 481, "user_id": 4647394, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06d6fcb008fd47cdc43d3964580baf4a?s=128&d=identicon&r=PG&f=1", "display_name": "seadoggie01", "link": "https://stackoverflow.com/users/4647394/seadoggie01"}, "edited": false, "score": 0, "creation_date": 1442932615, "post_id": 32718985, "comment_id": 53281928, "body": "Hi @seadoggie01 I tried that and it asks me to define &quot;ALabel&quot;, which I didn&#39;t think was required for a &quot;Then GoTo&quot;?"}, {"owner": {"reputation": 481, "user_id": 4647394, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06d6fcb008fd47cdc43d3964580baf4a?s=128&d=identicon&r=PG&f=1", "display_name": "seadoggie01", "link": "https://stackoverflow.com/users/4647394/seadoggie01"}, "edited": false, "score": 0, "creation_date": 1442932741, "post_id": 32718985, "comment_id": 53282043, "body": "I think you may have put an &quot;End Sub&quot; in, it would need to be an &quot;Exit Sub&quot;"}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 1, "creation_date": 1442933596, "post_id": 32718985, "comment_id": 53282615, "body": "@Wowdude, did you confirm that iVal is ever not 0? Click your cursor next to <code>If ival = 0</code> (so it&#39;s blinking on that line), push Ctrl-F8, and hover over ival and tell us if it&#39;s 0 or not 0."}, {"owner": {"reputation": 141, "user_id": 5341242, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Bh8YE.jpg?s=128&g=1", "display_name": "Wowdude", "link": "https://stackoverflow.com/users/5341242/wowdude"}, "reply_to_user": {"reputation": 481, "user_id": 4647394, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06d6fcb008fd47cdc43d3964580baf4a?s=128&d=identicon&r=PG&f=1", "display_name": "seadoggie01", "link": "https://stackoverflow.com/users/4647394/seadoggie01"}, "edited": false, "score": 0, "creation_date": 1442933636, "post_id": 32718985, "comment_id": 53282644, "body": "Ah there we go. Seems to be running properly. Thanks to the both of you @seadoggie01"}, {"owner": {"reputation": 141, "user_id": 5341242, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Bh8YE.jpg?s=128&g=1", "display_name": "Wowdude", "link": "https://stackoverflow.com/users/5341242/wowdude"}, "reply_to_user": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1442933656, "post_id": 32718985, "comment_id": 53282660, "body": "And to @puzzlepiece87 (it wouldn&#39;t let m put you both in one comment)"}, {"owner": {"reputation": 141, "user_id": 5341242, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Bh8YE.jpg?s=128&g=1", "display_name": "Wowdude", "link": "https://stackoverflow.com/users/5341242/wowdude"}, "reply_to_user": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 1, "creation_date": 1442933993, "post_id": 32718985, "comment_id": 53282904, "body": "@puzzlepiece87 Yeah the iVal was giving a 1, and when I removed the &quot;User 1&quot; from column A then the iVal did = 0. Thanks for your support!"}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1442933417, "creation_date": 1442933417, "answer_id": 32720106, "question_id": 32718985, "link": "https://stackoverflow.com/questions/32718985/countif-combined-with-if/32720106#32720106", "title": "&#39;Countif&#39; combined with &#39;If&#39;", "body": "<p>I see from the comments you fixed the <code>A2:A</code> syntax. Now in order for the code to truly skip the User1Allo module, I would suggest getting rid of the <code>GoTo</code> and the <code>Call</code> and just embed everything in a full <code>If ... Then ... Else</code> block.</p>\n\n<p>See below:</p>\n\n<pre><code>User = \"User 1\"\niVal = Application.WorksheetFunction.CountIf(Worksheets(\"Unallocated\").Range(\"A:A\"), User)\n\nIf iVal = 0 Then\n    MsgBox (\"It Didn't try to run the macro\")\nElse\n    User1Allo 'macro held in a module\n    MsgBox (\"It Tried to run the macro\")\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 5341242, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Bh8YE.jpg?s=128&g=1", "display_name": "Wowdude", "link": "https://stackoverflow.com/users/5341242/wowdude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 32720106, "answer_count": 1, "score": 1, "last_activity_date": 1442943183, "creation_date": 1442930484, "last_edit_date": 1442943183, "question_id": 32718985, "link": "https://stackoverflow.com/questions/32718985/countif-combined-with-if", "title": "&#39;Countif&#39; combined with &#39;If&#39;", "body": "<p>I'm looking to use a set variable as the search criterion for a Countif statement to look for \"User 1\" in \"A:A\" in sheet \"Unallocated\". If the Countif comes back with a value of <code>0</code>, I want to skip running code and instead carry on to the next Countif (there aren't any currently but once I get this logic correct I will use it a few times over).</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>Private Sub CommandButton21_Click()\n\nDim iVal As Integer\nDim User As String\n'Dim Wkb As Workbook 'to be used later\n\nUser = \"User 1\"\niVal = Application.WorksheetFunction.CountIf(Worksheets(\"Unallocated\").Range(\"A2:A\"), \"User 1\")\nIf iVal = 0 Then GoTo ALabel\nCall User1Allo 'macro held in a module\nMsgBox (\"It Tried to run the macro\")\nALabel:\nMsgBox (\"It Didn't try to run the macro\")\n\n'For Each Wkb In Workbooks 'to be used later\n'        If Not Wkb.ReadOnly And Windows(Wkb.Name).Visible Then 'to be used later\n'            Wkb.Save 'to be used later\n'        End If 'to be used later\n'    Next 'to be used later\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "edited": false, "score": 2, "creation_date": 1442930547, "post_id": 32718884, "comment_id": 53280323, "body": "Question unclear. Show what you tried."}, {"owner": {"reputation": 277, "user_id": 4845418, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ceb266d1e9d130d899117344c25c330d?s=128&d=identicon&r=PG&f=1", "display_name": "Lererferler", "link": "https://stackoverflow.com/users/4845418/lererferler"}, "reply_to_user": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "edited": false, "score": 0, "creation_date": 1442994950, "post_id": 32718884, "comment_id": 53309102, "body": "It&#39;s not unclear, was understood and answered perfectly succinctly below"}], "answers": [{"comments": [{"owner": {"reputation": 277, "user_id": 4845418, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ceb266d1e9d130d899117344c25c330d?s=128&d=identicon&r=PG&f=1", "display_name": "Lererferler", "link": "https://stackoverflow.com/users/4845418/lererferler"}, "edited": false, "score": 0, "creation_date": 1442931676, "post_id": 32719135, "comment_id": 53281204, "body": "I&#39;m aware of the comma already being in the second one but am trying to do the same just multiplying it by 10 and get commas and cannot figure it out"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 277, "user_id": 4845418, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ceb266d1e9d130d899117344c25c330d?s=128&d=identicon&r=PG&f=1", "display_name": "Lererferler", "link": "https://stackoverflow.com/users/4845418/lererferler"}, "edited": false, "score": 0, "creation_date": 1442935016, "post_id": 32719135, "comment_id": 53283689, "body": "@Lererferler You cannot use formatting with other than multiples of 1,000.  For your graphing issue, you might try a &quot;helper column&quot; with the math the way you want it."}, {"owner": {"reputation": 277, "user_id": 4845418, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ceb266d1e9d130d899117344c25c330d?s=128&d=identicon&r=PG&f=1", "display_name": "Lererferler", "link": "https://stackoverflow.com/users/4845418/lererferler"}, "edited": false, "score": 0, "creation_date": 1442935890, "post_id": 32719135, "comment_id": 53284376, "body": "No offense but I did say in the question I didn&#39;t want any extra columns, the file is big enough already. I know its a very simple solution to create some more columns but I would rather learn as much as I can about the program rather than take the easy way out. They are in multiples of 1000, I have used the above formatting to multiply 100 to 1000. It&#39;s not possible now to put a comma in it?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1442951831, "post_id": 32719135, "comment_id": 53293915, "body": "@JustinMcCartney I misunderstood the question.  Thought he wanted to enter 1000 and display it as 1.  (DUH -- sometimes I see what I want to see, and not what is really there:  I saw the thousand<b>th</b>s when what was meant was probably thousands, and that led to my error)"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 277, "user_id": 4845418, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ceb266d1e9d130d899117344c25c330d?s=128&d=identicon&r=PG&f=1", "display_name": "Lererferler", "link": "https://stackoverflow.com/users/4845418/lererferler"}, "edited": false, "score": 0, "creation_date": 1442951998, "post_id": 32719135, "comment_id": 53294003, "body": "@Lererferler And I confused myself by not reading the other part of your question clearly, thinking where you wrote thousand<b>th</b>s that you wanted to divide, rather than multiply as you stated clearly elsewhere."}, {"owner": {"reputation": 277, "user_id": 4845418, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ceb266d1e9d130d899117344c25c330d?s=128&d=identicon&r=PG&f=1", "display_name": "Lererferler", "link": "https://stackoverflow.com/users/4845418/lererferler"}, "edited": false, "score": 0, "creation_date": 1442994916, "post_id": 32719135, "comment_id": 53309089, "body": "No worries, Ron. And thank you Justin, that worked perfectly also"}], "tags": [], "owner": {"reputation": 520, "user_id": 5289214, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-II2pZVRGeoI/AAAAAAAAAAI/AAAAAAAAJxs/B19uiSlUBc0/photo.jpg?sz=128", "display_name": "Justin McCartney", "link": "https://stackoverflow.com/users/5289214/justin-mccartney"}, "is_accepted": true, "score": 1, "last_activity_date": 1442930856, "creation_date": 1442930856, "answer_id": 32719135, "question_id": 32718884, "link": "https://stackoverflow.com/questions/32718884/number-formatting-hundredths-and-thousandths/32719135#32719135", "title": "Number Formatting hundredths and thousandths", "body": "<p><code>0\"000\"</code> or <code>0\",000\"</code> might work for you. </p>\n"}], "owner": {"reputation": 277, "user_id": 4845418, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ceb266d1e9d130d899117344c25c330d?s=128&d=identicon&r=PG&f=1", "display_name": "Lererferler", "link": "https://stackoverflow.com/users/4845418/lererferler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 656, "favorite_count": 0, "accepted_answer_id": 32719135, "answer_count": 1, "score": 0, "last_activity_date": 1442943093, "creation_date": 1442930242, "last_edit_date": 1442943093, "question_id": 32718884, "link": "https://stackoverflow.com/questions/32718884/number-formatting-hundredths-and-thousandths", "title": "Number Formatting hundredths and thousandths", "body": "<p>I have a graph and don't want to create any extra columns, so I want to format the axis of the graph to multiply by <code>10</code>.  </p>\n\n<p>Does anyone know how to create a custom number format in Excel to display the number in thousandths ie the number but 1,000 times greater?</p>\n"}]