[{"tags": ["vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 5, "user_id": 4927416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93b930c6e0927c3f486073938cdaa0a9?s=128&d=identicon&r=PG&f=1", "display_name": "Jord27", "link": "https://stackoverflow.com/users/4927416/jord27"}, "edited": false, "score": 0, "creation_date": 1434594848, "post_id": 30904317, "comment_id": 49849411, "body": "Does nobody know the answer?"}, {"owner": {"reputation": 514, "user_id": 4967653, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jLy0eO8CT3E/AAAAAAAAAAI/AAAAAAAAAeQ/r1of1sWAlcw/photo.jpg?sz=128", "display_name": "keong kenshih", "link": "https://stackoverflow.com/users/4967653/keong-kenshih"}, "edited": false, "score": 0, "creation_date": 1434598679, "post_id": 30904317, "comment_id": 49850270, "body": "Perhaps you can check on the selection/value made by the user in the combo box only decided which column you need to put the value."}], "owner": {"reputation": 5, "user_id": 4927416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93b930c6e0927c3f486073938cdaa0a9?s=128&d=identicon&r=PG&f=1", "display_name": "Jord27", "link": "https://stackoverflow.com/users/4927416/jord27"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 403, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1434601075, "creation_date": 1434585020, "last_edit_date": 1434601075, "question_id": 30904317, "link": "https://stackoverflow.com/questions/30904317/when-combo-box-selection-is-made-on-userform-to-place-data-in-specific-place", "title": "When combo box selection is made on userform to place data in specific place", "body": "<p>I have a userform it has 4 text boxes and 1 combo box, when a selection is made on the combobox i want it to decide from which selection is made to where it places the data on the sheet,</p>\n\n<p>Example1 selected, to place it into column B from text box 3\nExample2 selected, to place it into column C from text box 3</p>\n\n<p>The current code i have managed</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim emptyRow As Long\n\n'Determine emptyRow\nemptyRow = WorksheetFunction.CountA(Range(\"A:A\")) + 1\n\n'Transfer information\n Cells(emptyRow, 1).Value = TextBox1.Value\n Cells(emptyRow, 2).Value = \n Cells(emptyRow, 3).Value =\n Cells(emptyRow, 4).Value = UCase(TextBox4.Value)\n Cells(emptyRow, 3).Value = UCase(TextBox2.Value)\n\n\n End With\n Cells(emptyRow, 6).Value = Sheets(\"Front\").Range(\"V31\")\n\n Unload Me\n Application.ActiveWorkbook.Save\n ParcelDataEntry.Show\n\n End Sub\n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "vba", "radio-button"], "answers": [{"comments": [{"owner": {"reputation": 351, "user_id": 4484829, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/9e67521a149838fd6fb023c678716905?s=128&d=identicon&r=PG&f=1", "display_name": "KingKong", "link": "https://stackoverflow.com/users/4484829/kingkong"}, "edited": false, "score": 0, "creation_date": 1434651762, "post_id": 30905789, "comment_id": 49882650, "body": "Thanks for the detailed response.   I did figure out to how to reference it finally with Activesheet.Optionbuttons(&quot;myButton&quot;) like how you have it on the bottom.  I don&#39;t think I can Set the buttons  like you have it because my worksheet allows the user to copy it and I think that would create a naming conflict hence my using the Activesheet.   Do you think this would all be easier using an AcitveX OptionButton instead though?"}, {"owner": {"reputation": 10761, "user_id": 2592875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4abcf57451cf62e63e8e191421c6709e?s=128&d=identicon&r=PG", "display_name": "TnTinMn", "link": "https://stackoverflow.com/users/2592875/tntinmn"}, "reply_to_user": {"reputation": 351, "user_id": 4484829, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/9e67521a149838fd6fb023c678716905?s=128&d=identicon&r=PG&f=1", "display_name": "KingKong", "link": "https://stackoverflow.com/users/4484829/kingkong"}, "edited": false, "score": 0, "creation_date": 1434652875, "post_id": 30905789, "comment_id": 49883283, "body": "How you reference the Worksheet does not matter.  If you need ActiveSheet, then use it.  The use of the Form Controls instead of the ActiveX controls is recommended due to many strange issues arising in recent Excel versions when using ActiveX controls.   For example, see: <a href=\"http://blogs.technet.com/b/the_microsoft_excel_support_team_blog/archive/2012/11/27/activex-and-form-controls-resize-themselves-when-clicked-doing-a-print-preview-or-resolution-changed.aspx\" rel=\"nofollow noreferrer\">blogs.technet.com/b/the_microsoft_excel_support_team_blog/&hellip;</a> ."}, {"owner": {"reputation": 240, "user_id": 2824305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c4dc4b5c4981925ffebdd419a2eaddaf?s=128&d=identicon&r=PG&f=1", "display_name": "AudioDev", "link": "https://stackoverflow.com/users/2824305/audiodev"}, "edited": false, "score": 0, "creation_date": 1437771713, "post_id": 30905789, "comment_id": 51188734, "body": "I did the <code>OptionButton ob.Value</code> method and I get 1.0 for the value if it&#39;s checked and -4169 if the OptionButton is unchecked. Any idea where the -4169 comes from. Is the 1.0 also correct as the value for true?"}], "tags": [], "owner": {"reputation": 10761, "user_id": 2592875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4abcf57451cf62e63e8e191421c6709e?s=128&d=identicon&r=PG", "display_name": "TnTinMn", "link": "https://stackoverflow.com/users/2592875/tntinmn"}, "is_accepted": false, "score": 5, "last_activity_date": 1434596384, "creation_date": 1434596384, "answer_id": 30905789, "question_id": 30904178, "link": "https://stackoverflow.com/questions/30904178/how-to-check-if-an-option-button-is-selected/30905789#30905789", "title": "How to check if an Option Button is selected", "body": "<p>By default, VBA hides easy access to the types needed to work with Form Controls placed on a Worksheet.</p>\n\n<p>In the VBA editor, either press the 'F2' function key or from the View Menu->Object Browser.  This will open the Object Browser window.  If search the Excel library for 'OptionButton', you will not find anything of use for the given task. </p>\n\n<p><img src=\"https://i.stack.imgur.com/MHKRM.png\" alt=\"Object Browser - Normal\"></p>\n\n<p>However, if you right-click in the 'Library Window' and click on 'Show Hidden Members', you will be rewarded with a complete list of Classes that you can use.  Once you have enabled 'Hidden Members', VBA's Intellisense will also show these classes to you.  </p>\n\n<p><img src=\"https://i.stack.imgur.com/y3StQ.png\" alt=\"Object Browser with hidden Members Shown\"></p>\n\n<p>The Form Controls are added to the Worksheet as a Shape, but the Shape object itself does not have any property that allows you see if the Option Button is checked or not. You can access the OptionButton through the 'OLEFormat.Object' property, but at this point it is just an 'Object' type.\nHowever you can cast the Object to an Excel.OptionButton as shown in the following code.  You will notice that I preface 'OptionButton' with the 'Excel' namespace (Library) name.  By doing this, Intellisense will kick-in as soon as you type the '.' and provide you with a list of classes to choose from.  The OptionButton class exposes a 'Value' property that allows you to check if it is checked (Value = 1) or unchecked (Value = 0).</p>\n\n<pre><code>Dim ws As Excel.Worksheet\nSet ws = ActiveWorkbook.Worksheets.Item(\"Sheet2\")\n\nDim btn As Shape\nSet btn = ws.Shapes.Item(\"Option Button 1\")\nDim optBtn1 As Excel.OptionButton\nSet optBtn1 = Sheet2.Shapes.Item(\"Option Button 1\").OLEFormat.Object\n\nIf optBtn1.Value = 1 Then ' it is checked\n   Debug.Print \"Option Button 1 is checked\"\nEnd If\n</code></pre>\n\n<p>Now this is all works, but now that you have acces to Hidden Members, you also have access to the OptionButtons collection that exists on the WorkSheet object and you can skip accessing it as a Shape Object.</p>\n\n<pre><code>Dim ws As Excel.Worksheet\nSet ws = ActiveWorkbook.Worksheets.Item(\"Sheet2\")\n\nDim optBtn2 As Excel.OptionButton\nSet optBtn2 = ws.OptionButtons.Item(\"Option Button 2\")\nIf optBtn2.Value = 1 Then ' it is checked\n   Debug.Print \"Option Button 2 is checked\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 351, "user_id": 4484829, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/9e67521a149838fd6fb023c678716905?s=128&d=identicon&r=PG&f=1", "display_name": "KingKong", "link": "https://stackoverflow.com/users/4484829/kingkong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16521, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1434596384, "creation_date": 1434583918, "last_edit_date": 1434585244, "question_id": 30904178, "link": "https://stackoverflow.com/questions/30904178/how-to-check-if-an-option-button-is-selected", "title": "How to check if an Option Button is selected", "body": "<p>I want to be able to check in code whether or not a particular Option Button is selected.</p>\n\n<p>I made a couple of Form Control buttons in an Excel sheet and I tried something like:</p>\n\n<pre><code>if Activesheet.myButton = true then\n\n     (do stuff)\n\nendif\n</code></pre>\n\n<p>But I get an \"Object doesn't support this property or method\" error.</p>\n\n<p>Would it be better to use an ActiveX Option Button?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 1, "creation_date": 1434580077, "post_id": 30903422, "comment_id": 49845820, "body": "Welcome to SO. That is indeed doable in VBA. A simple loop can give you what you want. But show us what you&#39;ve tried. Also, what if there are already duplicate values in Column A? Does it matter?"}, {"owner": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "edited": false, "score": 1, "creation_date": 1434580496, "post_id": 30903422, "comment_id": 49845978, "body": "Does it need to be dynamic or is always A to B? If B has data should it clear it ? Can A have blanks?"}, {"owner": {"reputation": 3, "user_id": 5021699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8716e0493e8477f3af17fb6cadd0d6a5?s=128&d=identicon&r=PG&f=1", "display_name": "onitsuka", "link": "https://stackoverflow.com/users/5021699/onitsuka"}, "edited": false, "score": 0, "creation_date": 1434618974, "post_id": 30903422, "comment_id": 49859921, "body": "Does not need to be dynamic. The data of B should be cleared. A should not have blanks."}], "answers": [{"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 1, "last_activity_date": 1434581827, "last_edit_date": 1434581827, "creation_date": 1434580789, "answer_id": 30903682, "question_id": 30903422, "link": "https://stackoverflow.com/questions/30903422/how-to-duplicate-values-from-cell-to-cell-in-excel/30903682#30903682", "title": "How to duplicate values from Cell to Cell in Excel?", "body": "<p>You don't need VBA for this.</p>\n\n<p>Divide the row number minus 1 by 2, int it (chop off decimals as opposed to rounding), finally use that as an offset reference.</p>\n\n<pre><code>=OFFSET(A$1,INT((ROW(A1)-1)/2),0)\n</code></pre>\n\n<p>Drag down</p>\n"}, {"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1434586939, "creation_date": 1434586939, "answer_id": 30904619, "question_id": 30903422, "link": "https://stackoverflow.com/questions/30903422/how-to-duplicate-values-from-cell-to-cell-in-excel/30904619#30904619", "title": "How to duplicate values from Cell to Cell in Excel?", "body": "<p>Non-volatile option:</p>\n\n<pre><code>=INDEX(A:A,INT((ROW(A1)-1)/2)+1)\n</code></pre>\n\n<p>(Offset will cause a recalculation of all sheets whenever any cell changes)</p>\n"}], "owner": {"reputation": 3, "user_id": 5021699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8716e0493e8477f3af17fb6cadd0d6a5?s=128&d=identicon&r=PG&f=1", "display_name": "onitsuka", "link": "https://stackoverflow.com/users/5021699/onitsuka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 1, "accepted_answer_id": 30904619, "answer_count": 2, "score": 0, "last_activity_date": 1434586939, "creation_date": 1434579598, "last_edit_date": 1434579953, "question_id": 30903422, "link": "https://stackoverflow.com/questions/30903422/how-to-duplicate-values-from-cell-to-cell-in-excel", "title": "How to duplicate values from Cell to Cell in Excel?", "body": "<p>I need to duplicate the n values from the column A to Column B</p>\n\n<p>Example:</p>\n\n<p><img src=\"https://i.stack.imgur.com/eztqb.png\" alt=\"\"></p>\n"}, {"tags": ["vba", "excel", "hyperlink"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5021691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf4b838f541537316d7f39f62f06587?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Wang", "link": "https://stackoverflow.com/users/5021691/jimmy-wang"}, "edited": false, "score": 0, "creation_date": 1434631443, "post_id": 30903410, "comment_id": 49868511, "body": "Hi Teylyn, Thanks for your help. However, my issue is I have a search engine created so the hyperlink is for the results. Is there a way I can send you the file/screenshot that shows what I&#39;m trying to do? Thanks!"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 1, "user_id": 5021691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf4b838f541537316d7f39f62f06587?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Wang", "link": "https://stackoverflow.com/users/5021691/jimmy-wang"}, "edited": false, "score": 0, "creation_date": 1434661477, "post_id": 30903410, "comment_id": 49888312, "body": "Use a file sharing service and post the link. It does not matter if the hyperlink is for the results of something. What matters is that it needs to be in the correct format."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1434579532, "creation_date": 1434579532, "answer_id": 30903410, "question_id": 30903273, "link": "https://stackoverflow.com/questions/30903273/microsoft-excel-search-engine-hyperlink-results-provides-error-message/30903410#30903410", "title": "Microsoft Excel Search Engine - Hyperlink Results Provides Error Message", "body": "<p>A hyperlink cannot start with the <code>#</code> sign. If the link is to a file, then you need to start with the file path, like shown in the Excel help</p>\n\n<p><code>=HYPERLINK(\"D:\\FINANCE\\1stqtr.xlsx\", H10)</code></p>\n\n<p>If the link goes to another sheet in the same file, use</p>\n\n<p><code>=HYPERLINK(\"[Budget.xlsx]E56\", E56)</code></p>\n\n<p>The Vlookup will need to return the correct file path or a valid URL, including the \"http://\"</p>\n"}], "owner": {"reputation": 1, "user_id": 5021691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf4b838f541537316d7f39f62f06587?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Wang", "link": "https://stackoverflow.com/users/5021691/jimmy-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1434579532, "creation_date": 1434578875, "last_edit_date": 1434579259, "question_id": 30903273, "link": "https://stackoverflow.com/questions/30903273/microsoft-excel-search-engine-hyperlink-results-provides-error-message", "title": "Microsoft Excel Search Engine - Hyperlink Results Provides Error Message", "body": "<p>I've been trying for two days to figure out this problem.</p>\n\n<p>I have created an Excel search engine to search through a database of hyperlinks in the same worksheet. I want the results to display working hyperlinks, but right now it just displays the text. When the hyperlink is clicked, I get an error message - \"Cannot open the specified file.\"</p>\n\n<p>Can someone please help me. I've tried multiple codes including the following:</p>\n\n<p><code>=HYPERLINK(\"#\"&amp;VLOOKUP(D5,A2:C91,3,FALSE),\"\"\"\")))</code> to no avail.</p>\n\n<p>I can also email the spreadsheet if a email is provided. Thank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 514, "user_id": 4967653, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jLy0eO8CT3E/AAAAAAAAAAI/AAAAAAAAAeQ/r1of1sWAlcw/photo.jpg?sz=128", "display_name": "keong kenshih", "link": "https://stackoverflow.com/users/4967653/keong-kenshih"}, "edited": false, "score": 1, "creation_date": 1434608211, "post_id": 30903135, "comment_id": 49853438, "body": "Are you going to delete the duplicated record? if you did so, maybe you can refer <a href=\"http://stackoverflow.com/questions/30904786/removing-duplicate-rows-after-checking-all-columns/30905945#30905945\">here</a> . So far what i could understand was you are facing the difficulty in removing duplicate row."}, {"owner": {"reputation": 71, "user_id": 4967029, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f47b4666e7516b8b4342aaf02da5a64a?s=128&d=identicon&r=PG", "display_name": "Luis", "link": "https://stackoverflow.com/users/4967029/luis"}, "reply_to_user": {"reputation": 514, "user_id": 4967653, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jLy0eO8CT3E/AAAAAAAAAAI/AAAAAAAAAeQ/r1of1sWAlcw/photo.jpg?sz=128", "display_name": "keong kenshih", "link": "https://stackoverflow.com/users/4967653/keong-kenshih"}, "edited": false, "score": 0, "creation_date": 1434608787, "post_id": 30903135, "comment_id": 49853730, "body": "Thanks for the help, I received information from my company that the duplication isn&#39;t problem due to the fact that the rows may seem the same but there&#39;s light changes in most of them, and even if they are duplicated I can solved it with your reference. But if you downloaded the files you would see the  problem with the import. The code seems fine but it&#39;s not working."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 4967029, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f47b4666e7516b8b4342aaf02da5a64a?s=128&d=identicon&r=PG", "display_name": "Luis", "link": "https://stackoverflow.com/users/4967029/luis"}, "edited": false, "score": 0, "creation_date": 1434721306, "post_id": 30938409, "comment_id": 49914101, "body": "Still gives me no data import, it seems that everything stays the same, It opens for a second the file that needs to be imported, but nothing happens no data transfer."}, {"owner": {"reputation": 783, "user_id": 916776, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b94f84a8ae5fe3963f05745df6861d87?s=128&d=identicon&r=PG", "display_name": "Holger Leichsenring", "link": "https://stackoverflow.com/users/916776/holger-leichsenring"}, "reply_to_user": {"reputation": 71, "user_id": 4967029, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f47b4666e7516b8b4342aaf02da5a64a?s=128&d=identicon&r=PG", "display_name": "Luis", "link": "https://stackoverflow.com/users/4967029/luis"}, "edited": false, "score": 0, "creation_date": 1434722211, "post_id": 30938409, "comment_id": 49914789, "body": "Did you try out to remove the cell content in the target cells to determine if the copy worked or not? Did you try to change the data to be imported to be quite different to check if data will be copied?  I just tried it out again and it does copy the data from sheet 1 called  &quot;Status 4XX&quot; in workbook &quot;Status 496 800 semana 12 2015.xls&quot; to sheet &quot;&#196;A&quot; which is sheet 1 of &quot;Master_Atual_2015.xlsm&quot;"}, {"owner": {"reputation": 71, "user_id": 4967029, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f47b4666e7516b8b4342aaf02da5a64a?s=128&d=identicon&r=PG", "display_name": "Luis", "link": "https://stackoverflow.com/users/4967029/luis"}, "edited": false, "score": 0, "creation_date": 1434722755, "post_id": 30938409, "comment_id": 49915221, "body": "The information, can&#39;t be mixed up the other sheets except the Dev.Pag(sheet2) is the only one that can receive that information, this due to the information that the other sheets receive. And the Dev.Pag(sheet2) in the columns that are going to receive the data, they are empty and still nothing transfers."}, {"owner": {"reputation": 783, "user_id": 916776, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b94f84a8ae5fe3963f05745df6861d87?s=128&d=identicon&r=PG", "display_name": "Holger Leichsenring", "link": "https://stackoverflow.com/users/916776/holger-leichsenring"}, "reply_to_user": {"reputation": 71, "user_id": 4967029, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f47b4666e7516b8b4342aaf02da5a64a?s=128&d=identicon&r=PG", "display_name": "Luis", "link": "https://stackoverflow.com/users/4967029/luis"}, "edited": false, "score": 0, "creation_date": 1434723327, "post_id": 30938409, "comment_id": 49915655, "body": "You are mixing up the sheet names and indexes. Please double check them. It does work like described above."}, {"owner": {"reputation": 71, "user_id": 4967029, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f47b4666e7516b8b4342aaf02da5a64a?s=128&d=identicon&r=PG", "display_name": "Luis", "link": "https://stackoverflow.com/users/4967029/luis"}, "edited": false, "score": 0, "creation_date": 1434723719, "post_id": 30938409, "comment_id": 49915939, "body": "I just undestood the huge mistake I was doing. To change to sheet2 it&#39;s on &quot;Targetwb.sheets(2)&quot; and &quot;SourceWb.Sheets(2)&quot; right? the data would always go to sheet1..."}, {"owner": {"reputation": 783, "user_id": 916776, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b94f84a8ae5fe3963f05745df6861d87?s=128&d=identicon&r=PG", "display_name": "Holger Leichsenring", "link": "https://stackoverflow.com/users/916776/holger-leichsenring"}, "reply_to_user": {"reputation": 71, "user_id": 4967029, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f47b4666e7516b8b4342aaf02da5a64a?s=128&d=identicon&r=PG", "display_name": "Luis", "link": "https://stackoverflow.com/users/4967029/luis"}, "edited": false, "score": 0, "creation_date": 1434723952, "post_id": 30938409, "comment_id": 49916128, "body": "Just use it like so: SourceWb.Sheets(&quot;Status 4XX&quot;) then you cannot mix up names and order of the worksheets. Please mark as answer when it is correct."}], "tags": [], "owner": {"reputation": 783, "user_id": 916776, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b94f84a8ae5fe3963f05745df6861d87?s=128&d=identicon&r=PG", "display_name": "Holger Leichsenring", "link": "https://stackoverflow.com/users/916776/holger-leichsenring"}, "is_accepted": true, "score": 1, "last_activity_date": 1434717703, "creation_date": 1434717703, "answer_id": 30938409, "question_id": 30903135, "link": "https://stackoverflow.com/questions/30903135/vba-import-data/30938409#30938409", "title": "VBA Import Data", "body": "<p>It was pretty hard to understand your code for several reasons:</p>\n\n<ul>\n<li>You just reference the sheets by index. Thus they are hard to find. Better reference them by name</li>\n<li>you reference ranges only by addresses, it would be better to define named ranges </li>\n</ul>\n\n<p>Another point to make it more readable/ debuggable, set the union to an own range object to be able to watch the content and be sure that this is what you want to have.</p>\n\n<pre><code>With SourceWb.Sheets(1)\n    Set objTargetRange = .Application.Union(.Range(\"D2:D\" &amp; Lstrw), .Range(\"F2:F\" &amp; Lstrw), .Range(\"I2:I\" &amp; Lstrw), .Range(\"M2:M\" &amp; Lstrw))\n    objTargetRange.Copy Destination:=TargetWb.Sheets(1).Range(\"A3\")\nEnd With\n</code></pre>\n\n<p>When printing out the objTargetRange's addresses it looks like this (You can do that by simply pressing ctrl+g and writing ?objTargetRange.Address) </p>\n\n<p>$D$2:$D$9;$F$2:$F$9;$I$2:$I$9;$M$2:$M$9</p>\n\n<p>So you selected four columns, each of them has 8 cells. When adding this to A3, it will be added side by side, it doesn't have any offset. </p>\n\n<p>So cells A3-D10 will be overwritten by your data, <em>the code works</em>. It was not visible that it does that, because comparing state before and state after was pretty complicated. You can make visible, that the changes actually happen by just</p>\n\n<ul>\n<li>temporary removing your actual data from the sheet</li>\n<li>temporary adding some empty rows </li>\n</ul>\n"}], "owner": {"reputation": 71, "user_id": 4967029, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f47b4666e7516b8b4342aaf02da5a64a?s=128&d=identicon&r=PG", "display_name": "Luis", "link": "https://stackoverflow.com/users/4967029/luis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1121, "favorite_count": 0, "accepted_answer_id": 30938409, "answer_count": 1, "score": 2, "last_activity_date": 1434717703, "creation_date": 1434578342, "last_edit_date": 1434608659, "question_id": 30903135, "link": "https://stackoverflow.com/questions/30903135/vba-import-data", "title": "VBA Import Data", "body": "<p>I have a problem and I think it's complicated. It's regarding importing data/information from a another Excel file and the data/information needed is on 2 sheets.</p>\n\n<p>The code is working but not the way It should be it doesn't seem to import the data and down below it will explain what we cannot do in it, (\"me and my friend that are working in this project that was demand by our company don't know almost nothing about this category VBA and we are just researching info about this but get always stuck\").</p>\n\n<p>We need to extract from the file (the link is in the description), and the file is created every week(semana) so somehow it needs to extract the newest every week.</p>\n\n<p>Down below there's the Excel file that is responsible for the extraction of the data for security reason we deleted most of the information on it and changed names.</p>\n\n<p><a href=\"http://s000.tinyupload.com/?file_id=00945992112161453003\" rel=\"nofollow\">Workbook with the Macro - Used for importing</a> The sheet is the number 2 and also It's called Dev.Pag the macro is associated to the button \"IMPORT DATA\" in the same file. </p>\n\n<p><a href=\"http://s000.tinyupload.com/?file_id=81304389957905363999\" rel=\"nofollow\">Source Workbook - Contains the data</a> This is where it gets the values(exports) from once again the name and some data was erased because It might compromise the company.</p>\n\n<p>If there's anything I can edited or change please tell me. Thanks in advance for any reply.</p>\n\n<p>Also will post the code down below:</p>\n\n<pre><code>Option Explicit\nSub ImportData()\n\n    Application.ScreenUpdating = False\n    Dim Path As String, Lstrw As Long\n    Dim SourceWb As Workbook\n    Dim TargetWb As Workbook\n\n    'Change this to your company workbook path\n    Path = \"C:\\Users\\DZPH8SH\\Desktop\\Status 496 800 semana 12 2015.xls\"    \n    Workbooks.Open (Path)\n\n    'Change \"Source\" to the name of your company workbook\n    Set SourceWb = Workbooks(\"Status 496 800 semana 12 2015.xls\")        \n\n    'Part that needs some adjustments in down below\n    'This part is working good but probably some error in the data\n    'transferance may be intrefering with the integridty\n\n    'change the file address\n    Set TargetWb = Workbooks(\"Master_Atual_2015.xlsm\") \n    Lstrw = SourceWb.Sheets(1).Cells.Find(What:=\"*\", SearchOrder:=xlRows, _\n            SearchDirection:=xlPrevious, LookIn:=xlValues).Row\n    With SourceWb.Sheets(1)\n        .Application.Union(.Range(\"D2:D\" &amp; Lstrw), .Range(\"F2:F\" &amp; _\n            Lstrw), .Range(\"I2:I\" &amp; Lstrw), .Range(\"M2:M\" &amp; Lstrw)).Copy _\n            Destination:=TargetWb.Sheets(1).Range(\"A3\")\n    End With\n\n    SourceWb.Close savechanges:=False\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos"], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 814830, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9d6fb992b7f09dfcd8da1f0f972bdee5?s=128&d=identicon&r=PG", "display_name": "Logick", "link": "https://stackoverflow.com/users/814830/logick"}, "edited": false, "score": 0, "creation_date": 1434580601, "post_id": 30903093, "comment_id": 49846009, "body": "Thanks! Worked like a charm."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1434578150, "creation_date": 1434578150, "answer_id": 30903093, "question_id": 30903034, "link": "https://stackoverflow.com/questions/30903034/excel-doc-macro-yields-named-argument-not-found-error-448/30903093#30903093", "title": "Excel Doc macro yields &quot;Named argument not found (Error 448)&quot;", "body": "<p>The Mac does not support the SearchFormat argument. Just omit and the code will run.</p>\n"}], "owner": {"reputation": 161, "user_id": 814830, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9d6fb992b7f09dfcd8da1f0f972bdee5?s=128&d=identicon&r=PG", "display_name": "Logick", "link": "https://stackoverflow.com/users/814830/logick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1535, "favorite_count": 0, "accepted_answer_id": 30903093, "answer_count": 1, "score": 0, "last_activity_date": 1593700637, "creation_date": 1434577897, "last_edit_date": 1593700637, "question_id": 30903034, "link": "https://stackoverflow.com/questions/30903034/excel-doc-macro-yields-named-argument-not-found-error-448", "title": "Excel Doc macro yields &quot;Named argument not found (Error 448)&quot;", "body": "<p>This code snippet runs perfectly fine in Excel on Windows.<br>\nBut on OSX, it's giving an error <code>Named argument not found (Error 448).</code></p>\n\n<pre><code>With Sheets(\"Colors\")\n        Set rangeFound = .Cells.find(What:=Resource, After:=.Cells(1, 1), LookIn:=xlValues, _\n            LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n            MatchCase:=False, SearchFormat:=False)\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 6027, "user_id": 4266453, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e3384be34de79588408439b6e1626f7c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4266453/chris"}, "edited": false, "score": 0, "creation_date": 1434583012, "post_id": 30902798, "comment_id": 49846710, "body": "This <a href=\"http://www.techrepublic.com/blog/microsoft-office/how-to-automatically-execute-a-word-macro-when-you-create-open-or-close-a-document/\" rel=\"nofollow noreferrer\">techrepublic.com/blog/microsoft-office/&hellip;</a> would suggest Document_Open() instead of AutoOpen()"}, {"owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "reply_to_user": {"reputation": 6027, "user_id": 4266453, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e3384be34de79588408439b6e1626f7c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4266453/chris"}, "edited": false, "score": 0, "creation_date": 1434583203, "post_id": 30902798, "comment_id": 49846759, "body": "Thanks. I&#39;ve tried that as well and it didn&#39;t work."}], "answers": [{"tags": [], "owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "is_accepted": true, "score": 1, "last_activity_date": 1434607129, "creation_date": 1434607129, "answer_id": 30907529, "question_id": 30902798, "link": "https://stackoverflow.com/questions/30902798/why-wont-my-macro-run-automatically-in-word/30907529#30907529", "title": "Why won&#39;t my macro run automatically in Word?", "body": "<p>You should place your code in standard Module in your Template document. Next, change sub name from <code>AutoOpen()</code> into:</p>\n\n<pre><code>Sub AutoExec()\n    '..... your code here .....\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1905, "favorite_count": 0, "accepted_answer_id": 30907529, "answer_count": 1, "score": 0, "last_activity_date": 1459270856, "creation_date": 1434576919, "last_edit_date": 1459270856, "question_id": 30902798, "link": "https://stackoverflow.com/questions/30902798/why-wont-my-macro-run-automatically-in-word", "title": "Why won&#39;t my macro run automatically in Word?", "body": "<p>This is my first time attempting VBA in Word although I've used it quite a bit in Excel. What I am trying to do is automatically execute my code after opening my Word template document. Here is the code I've placed in my Word template Module:</p>\n\n<pre><code>Private Sub AutoOpen()\n\n\nDim myValue\nmyValue = InputBox(prompt:=\"What is the client name\", Title:=\"InputBox\", Default:=\"Type your client name here\")\n\n\nstringReplaced = stringReplaced + \"&lt;Replace&gt;\"\n\nFor Each myStoryRange In ActiveDocument.StoryRanges\n    With myStoryRange.Find\n        .Text = \"&lt;Replace&gt;\"\n        .Replacement.Text = myValue\n        .Wrap = wdFindContinue\n        .ClearFormatting\n        .Replacement.ClearFormatting\n        .Replacement.Highlight = False\n        .Execute Replace:=wdReplaceAll\n    End With\nNext myStoryRange\n\n\n\nEnd Sub\n</code></pre>\n\n<p>I am using Word 2010. My code runs like I want it to when I manually go in and click run. However, when I close out of my Word document and reopen nothing happens at all. I've Googled the problem trying to find out a solution (and have attempt different versions of AutoOpen), but I can't figure out what I am doing wrong. Any ideas on why the AutoOpen doesn't execute automatically? \nThanks!</p>\n"}, {"tags": ["vba", "excel", "charts"], "answers": [{"tags": [], "owner": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "is_accepted": true, "score": 1, "last_activity_date": 1434577118, "creation_date": 1434577118, "answer_id": 30902864, "question_id": 30902757, "link": "https://stackoverflow.com/questions/30902757/how-to-make-excel-chart-include-all-blank-cells-from-range-specified-in-vba/30902864#30902864", "title": "How to make excel chart include all blank cells from range specified in VBA?", "body": "<p>If you are trying to get the blanks to display as zero the code is </p>\n\n<pre><code>ActiveChart.DisplayBlanksAs = xlZero\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5021599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aad3b882b6c6c9d5dce77f3ed2dd40f?s=128&d=identicon&r=PG&f=1", "display_name": "user5021599", "link": "https://stackoverflow.com/users/5021599/user5021599"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "accepted_answer_id": 30902864, "answer_count": 1, "score": 0, "last_activity_date": 1434583004, "creation_date": 1434576763, "last_edit_date": 1434583004, "question_id": 30902757, "link": "https://stackoverflow.com/questions/30902757/how-to-make-excel-chart-include-all-blank-cells-from-range-specified-in-vba", "title": "How to make excel chart include all blank cells from range specified in VBA?", "body": "<p>In my code, I create a chart and specify a range for the input data:</p>\n\n<pre><code>.SetSourceData Source:=Sheets(\"Output\").Range(\"N6:CS6\")\n</code></pre>\n\n<p>The problem is that the first few cells are blank sometimes and when the chart is created it ignores them and starts from the first cell containing a value. This in turn results in a mismatch between the X-axis values and the data being displayed.</p>\n\n<p>How can I force the chart to include full range specified, even if it contains blank cells?</p>\n"}, {"tags": ["algorithm", "vba", "function", "find", "fuzzy-search"], "comments": [{"owner": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "edited": false, "score": 0, "creation_date": 1434577685, "post_id": 30902373, "comment_id": 49844831, "body": "Just to be correct the goal is to find the cell that contains the most of a particular values? Example Cat,Battle ...when looking for t, battle has more ts, so return Battle ? Also is everything in the same case? or do we need to worry about that"}, {"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "reply_to_user": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "edited": false, "score": 0, "creation_date": 1434577838, "post_id": 30902373, "comment_id": 49844885, "body": "Everything is upper case. And your example is correct Suppose our word to search for is &quot;apple&quot; suppose the strings in our table are  bag produce, onions, giant peaches, electronics and downloadable applications,  It would probably return electronics and downloadable applications due to &quot;app&quot; the string with the most in a row matches"}, {"owner": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "edited": false, "score": 0, "creation_date": 1434578147, "post_id": 30902373, "comment_id": 49845021, "body": "I am not understanding this line : a = a - Len(cell)"}, {"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "reply_to_user": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "edited": false, "score": 0, "creation_date": 1434578791, "post_id": 30902373, "comment_id": 49845314, "body": "I got confused with that too. I think it counts the matches between our string and the value in the cell then it trims excess."}], "answers": [{"tags": [], "owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "is_accepted": false, "score": 2, "last_activity_date": 1434578281, "last_edit_date": 1434578281, "creation_date": 1434577790, "answer_id": 30903011, "question_id": 30902373, "link": "https://stackoverflow.com/questions/30902373/can-anyone-improve-on-the-below-fuzzyfind-function-for-vba/30903011#30903011", "title": "Can anyone improve on the below Fuzzyfind function for VBA?", "body": "<p>I'm not sure exactly what \"FuzzyFind\" entails, but this is a VLOOKUP that uses the <a href=\"https://en.wikipedia.org/wiki/Levenshtein_distance\" rel=\"nofollow\">Levenshtein distance</a> to find similar data.</p>\n\n<p>The Levenshtein distance lets you select a \"percentage match\" that you can specify instead of the typical <code>TRUE</code> or <code>FALSE</code> from a normal VLOOKUP:</p>\n\n<p>Usage is: <code>DTVLookup(A1,$C$1:$C$100,1,90)</code> where 90 is the Levenshtein Distance.</p>\n\n<p><code>DTVLookup(Value To Find, Range to Search, Column to Return, [Percentage Match])</code></p>\n\n<p>I typically use this when comparing names that come from different databases like:</p>\n\n<pre><code>Correct Name    Example Lookup  Percentage Match    Other Report\nJohn S Smith    John Smith      83                  John Smith\nBarb Jones      Barbara Jones   77                  Barbara Jones\nJeffrey Bridge  Jeff Bridge     79                  Jeff Bridge\nJoseph Park     Joseph P. Park  79                  Joseph P. Park\nJefrey Jones    jefre jon       75                  jefre jon\nPeter Bridge    peter f. bridge 80                  peter f. bridge\n</code></pre>\n\n<p>Here's the code:</p>\n\n<pre><code>Function DTVLookup(TheValue As Variant, TheRange As Range, TheColumn As Long, Optional PercentageMatch As Double = 100) As Variant\nIf TheColumn &lt; 1 Then\n    DTVLookup = CVErr(xlErrValue)\n    Exit Function\nEnd If\nIf TheColumn &gt; TheRange.Columns.Count Then\n    DTVLookup = CVErr(xlErrRef)\n    Exit Function\nEnd If\nDim c As Range\nFor Each c In TheRange.Columns(1).Cells\n    If UCase(TheValue) = UCase(c) Then\n        DTVLookup = c.Offset(0, TheColumn - 1)\n        Exit Function\n    ElseIf PercentageMatch &lt;&gt; 100 Then\n        If Levenshtein3(UCase(TheValue), UCase(c)) &gt;= PercentageMatch Then\n            DTVLookup = c.Offset(0, TheColumn - 1)\n            Exit Function\n        End If\n    End If\nNext c\nDTVLookup = CVErr(xlErrNA)\nEnd Function\n\nFunction Levenshtein3(ByVal string1 As String, ByVal string2 As String) As Long\n\nDim i As Long, j As Long, string1_length As Long, string2_length As Long\nDim distance(0 To 60, 0 To 50) As Long, smStr1(1 To 60) As Long, smStr2(1 To 50) As Long\nDim min1 As Long, min2 As Long, min3 As Long, minmin As Long, MaxL As Long\n\nstring1_length = Len(string1):  string2_length = Len(string2)\n\ndistance(0, 0) = 0\nFor i = 1 To string1_length:    distance(i, 0) = i: smStr1(i) = Asc(LCase(Mid$(string1, i, 1))): Next\nFor j = 1 To string2_length:    distance(0, j) = j: smStr2(j) = Asc(LCase(Mid$(string2, j, 1))): Next\nFor i = 1 To string1_length\n    For j = 1 To string2_length\n        If smStr1(i) = smStr2(j) Then\n            distance(i, j) = distance(i - 1, j - 1)\n        Else\n            min1 = distance(i - 1, j) + 1\n            min2 = distance(i, j - 1) + 1\n            min3 = distance(i - 1, j - 1) + 1\n            If min2 &lt; min1 Then\n                If min2 &lt; min3 Then minmin = min2 Else minmin = min3\n            Else\n                If min1 &lt; min3 Then minmin = min1 Else minmin = min3\n            End If\n            distance(i, j) = minmin\n        End If\n    Next\nNext\n\n' Levenshtein3 will properly return a percent match (100%=exact) based on similarities and Lengths etc...\nMaxL = string1_length: If string2_length &gt; MaxL Then MaxL = string2_length\nLevenshtein3 = 100 - CLng((distance(string1_length, string2_length) * 100) / MaxL)\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 0, "creation_date": 1434578863, "post_id": 30903172, "comment_id": 49845334, "body": "How does it improve on the original? Can you walk be through it briefly?"}, {"owner": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "reply_to_user": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 0, "creation_date": 1434578978, "post_id": 30903172, "comment_id": 49845376, "body": "@JohnsonJason When I was using the original one it pretty much always came back with the first one it found. This one comes back with the one with the most concurrence, I think the above answer is probably better"}, {"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 0, "creation_date": 1434636968, "post_id": 30903172, "comment_id": 49873053, "body": "@ Holmes IV I switched this to best answer as it returned better results than the Levenshtein approach. Although for the example he gave above comparing names in a data base I think the Levenshtein approach would be best. However, in my situation, your fuzzyfind2 rocks. Thank you :)"}], "tags": [], "owner": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "is_accepted": true, "score": 1, "last_activity_date": 1434578536, "creation_date": 1434578536, "answer_id": 30903172, "question_id": 30902373, "link": "https://stackoverflow.com/questions/30902373/can-anyone-improve-on-the-below-fuzzyfind-function-for-vba/30903172#30903172", "title": "Can anyone improve on the below Fuzzyfind function for VBA?", "body": "<p>Try this out, I think it will find the best match</p>\n\n<pre><code>Function FuzzyFind2(lookup_value As String, tbl_array As Range) As String\nDim i As Integer, str As String, Value As String\nDim a As Integer, b As Integer, cell As Variant\nDim Found As Boolean\n\nb = 0\nFor Each cell In tbl_array\n  str = cell\n  i = 1\n  Found = True\n  Do While Found = True\n    Found = False\n    If InStr(i, str, lookup_value) &gt; 0 Then\n        a = a + 1\n        Found = True\n        i = InStr(i, str, lookup_value) + 1\n    End If\n  Loop\n\n  If a &gt; b Then\n    b = a\n    Value = str\n  End If\n  a = 0\nNext cell\nFuzzyFind2 = Value\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1035, "favorite_count": 0, "accepted_answer_id": 30903172, "answer_count": 2, "score": 0, "last_activity_date": 1434578536, "creation_date": 1434575040, "last_edit_date": 1434576316, "question_id": 30902373, "link": "https://stackoverflow.com/questions/30902373/can-anyone-improve-on-the-below-fuzzyfind-function-for-vba", "title": "Can anyone improve on the below Fuzzyfind function for VBA?", "body": "<p>This function lets you find similar strings from a range without having to do an exact search.  </p>\n\n<p>The formula looks like this: =FuzzyFind(A1,B$1:B$20)\nassuming the string you are performing a search for is in A1\nand your reference or options table is B1:B20</p>\n\n<p>The code is here:</p>\n\n<pre><code>Function FuzzyFind(lookup_value As String, tbl_array As Range) As String\nDim i As Integer, str As String, Value As String\nDim a As Integer, b As Integer, cell As Variant\nFor Each cell In tbl_array\n  str = cell\n  For i = 1 To Len(lookup_value)\n    If InStr(cell, Mid(lookup_value, i, 1)) &gt; 0 Then\n      a = a + 1\n      cell = Mid(cell, 1, InStr(cell, Mid(lookup_value, i, 1)) - 1) &amp; Mid(cell, InStr(cell, Mid(lookup_value, i, 1)) + 1, 9999)\n    End If\n  Next i\n  a = a - Len(cell)\n  If a &gt; b Then\n    b = a\n    Value = str\n  End If\n  a = 0\nNext cell\nFuzzyFind = Value\nEnd Function\n</code></pre>\n\n<p>The results from this function are hit and miss. Can anyone improve the intelligence of this algorithm? </p>\n\n<p>Thank you :)</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1434577917, "creation_date": 1434577917, "answer_id": 30903038, "question_id": 30902323, "link": "https://stackoverflow.com/questions/30902323/getting-the-cell-value-of-two-string-variables/30903038#30903038", "title": "Getting the cell value of two string variables", "body": "<p>Assuming that document and person are string variables that hold string representations of integers (e.g. document = \"1\", person = \"2\") then something like</p>\n\n<pre><code>oWB.Sheets (\"sheet1\").Cells(val(document), val(person))\n</code></pre>\n\n<p>will work. If the contents of the string variables are more complicated then you would need to do some parsing of those strings. </p>\n"}, {"tags": [], "owner": {"reputation": 10761, "user_id": 2592875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4abcf57451cf62e63e8e191421c6709e?s=128&d=identicon&r=PG", "display_name": "TnTinMn", "link": "https://stackoverflow.com/users/2592875/tntinmn"}, "is_accepted": false, "score": 0, "last_activity_date": 1434601537, "creation_date": 1434601537, "answer_id": 30906425, "question_id": 30902323, "link": "https://stackoverflow.com/questions/30902323/getting-the-cell-value-of-two-string-variables/30906425#30906425", "title": "Getting the cell value of two string variables", "body": "<p>Assuming by \"2d Chart\" you mean a table in a Worksheet, and that person would be the full text \"person1\", or \"person2\", etc. and likewise for document, then perhaps this function will do the trick.</p>\n\n<pre><code>Function FindDocPerson(person As String, document As String) As Variant\n    Const MatchExact As Integer = 0\n    Dim ws As Excel.Worksheet\n    Set ws = ActiveWorkbook.Worksheets(\"Sheet1\")\n\n    Dim table As Excel.Range\n    Set table = ws.UsedRange\n\n    Dim docRange As Excel.Range\n    Set docRange = table.Columns(1).Offset(1, 0).Resize(table.Columns(1).Rows.Count - 1)\n\n    Dim personRange As Excel.Range\n    Set personRange = table.Rows(1).Offset(0, 1).Resize(1, table.Columns.Count - 1)\n\n    Dim personIndex As Long\n    Dim docIndex As Long\n\n    On Error GoTo errHandler\n\n    personIndex = Application.WorksheetFunction.Match(person, personRange, MatchExact) + 1\n    docIndex = Application.WorksheetFunction.Match(document, docRange, MatchExact) + 1\n    FindDocPerson = table.Cells(docIndex, personIndex).Value2\n    Exit Function\n\nerrHandler:\n    FindDocPerson = VBA.CVErr(Excel.xlErrNA)\nEnd Function\n</code></pre>\n\n<p>calling syntax:</p>\n\n<pre><code>Dim result As Variant\nresult = FindDocPerson(\"person2\", \"text1\")\n\nIf Application.WorksheetFunction.IsError(result) Then\n    ' handle it\nElse\n    ' found it\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1434602472, "last_edit_date": 1434602472, "creation_date": 1434602108, "answer_id": 30906526, "question_id": 30902323, "link": "https://stackoverflow.com/questions/30902323/getting-the-cell-value-of-two-string-variables/30906526#30906526", "title": "Getting the cell value of two string variables", "body": "<p>There is a typo in your code, </p>\n\n<pre><code>oWB.Sheets (\"sheet1\").Cells(documemt, person)\n</code></pre>\n\n<p>documemt should be document</p>\n\n<p>All that aside though it is unclear what you want to do, can you give a little more description please?</p>\n\n<p>All we know is you need to get the value of a cell using two string variables and that it could be a string or a number. The code you posted doesn't give much more of a hint to your goal.</p>\n\n<p>To convert between strings and numbers you can use CLng to convert to a long number or CStr to convert to a string. eg CLng(\"3\") = 3 and CStr(3) = \"3\"</p>\n\n<p>In your code this:</p>\n\n<pre><code>Set oWB = oExcel.Workbooks.open.      (\"C:\")\n</code></pre>\n\n<p>Doesn't work because you are trying to open a workbook without specifying a name, I also note the (\"C:\") is spaced far to the right of the command call which leads me to believe this is has been typed freestyle ie not in the VBE. This makes it even harder to decode into your requirements.</p>\n\n<p>Lastly, this code:</p>\n\n<pre><code>Set oExcel = New Excel.application\n</code></pre>\n\n<p>Why are you starting another session of Excel from Excel VBA code? Is this code somewhere other than Excel ie Outlook / Access / PowerPoint / Word / Business Objects etc etc.</p>\n"}], "owner": {"reputation": 1, "user_id": 5021412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/802918cca080fdc86f86ca5ca4c6fba3?s=128&d=identicon&r=PG&f=1", "display_name": "Hdh", "link": "https://stackoverflow.com/users/5021412/hdh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1434602472, "creation_date": 1434574869, "last_edit_date": 1434602332, "question_id": 30902323, "link": "https://stackoverflow.com/questions/30902323/getting-the-cell-value-of-two-string-variables", "title": "Getting the cell value of two string variables", "body": "<p>I have a 2D chart in Excel. I need to get the value of a cell using two string variables. The chart looks like this:</p>\n\n<pre><code>Document     person1    person2\nText1        5          8\nText2        2          1\nText3        9          6\n</code></pre>\n\n<p>After looking online I am finding this difficult because:</p>\n\n<ol>\n<li>the values are strings, not integers;</li>\n<li>the strings will change depending on which person and document combination comes up.</li>\n</ol>\n\n<p>This should be the only code that is relevant:</p>\n\n<pre><code>Dim document as string\nDim person as string\n\nDim oExcel as excel.application\nDim oWB as workbook\nSet oExcel = New Excel.application\nSet oWB = oExcel.Workbooks.open.      (\"C:\")\noExcel.Visible = True\n\noWB.Sheets (\"sheet1\").Cells(documemt, person)\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-access", "import"], "comments": [{"owner": {"reputation": 3761, "user_id": 4755863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFZmD.jpg?s=128&g=1", "display_name": "APH", "link": "https://stackoverflow.com/users/4755863/aph"}, "edited": false, "score": 3, "creation_date": 1434574285, "post_id": 30902092, "comment_id": 49843231, "body": "What have you tried so far?  Excel&#39;s &quot;record macro&quot; function can be useful in finding a place to start."}, {"owner": {"reputation": 9, "user_id": 5021498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dddb2c9dc3ed32c8947358ba8ba5682d?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Listor", "link": "https://stackoverflow.com/users/5021498/erik-listor"}, "reply_to_user": {"reputation": 3761, "user_id": 4755863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFZmD.jpg?s=128&g=1", "display_name": "APH", "link": "https://stackoverflow.com/users/4755863/aph"}, "edited": false, "score": 0, "creation_date": 1434627605, "post_id": 30902092, "comment_id": 49865800, "body": "Is there a way to record lines of VBA code when you start in excel and move to doing things in access? I&#39;ve tried this, and couldn&#39;t get the code to record."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 5021498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dddb2c9dc3ed32c8947358ba8ba5682d?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Listor", "link": "https://stackoverflow.com/users/5021498/erik-listor"}, "edited": false, "score": 0, "creation_date": 1434627750, "post_id": 30902905, "comment_id": 49865895, "body": "How do I go about making sure ADO.OLEBD is being used?"}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "reply_to_user": {"reputation": 9, "user_id": 5021498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dddb2c9dc3ed32c8947358ba8ba5682d?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Listor", "link": "https://stackoverflow.com/users/5021498/erik-listor"}, "edited": false, "score": 0, "creation_date": 1434627876, "post_id": 30902905, "comment_id": 49865973, "body": "Sorry typo - meant the ACE.OLEDB provider. See the code above"}, {"owner": {"reputation": 9, "user_id": 5021498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dddb2c9dc3ed32c8947358ba8ba5682d?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Listor", "link": "https://stackoverflow.com/users/5021498/erik-listor"}, "edited": false, "score": 0, "creation_date": 1434628767, "post_id": 30902905, "comment_id": 49866606, "body": "Okay, scratch that. its returning an error that says: &quot;the Microsoft access database engine cannot find the input table or query &#39;Sheet1&#39;$&#39;. Make sure it exists and that its name is spelled correctly."}, {"owner": {"reputation": 9, "user_id": 5021498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dddb2c9dc3ed32c8947358ba8ba5682d?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Listor", "link": "https://stackoverflow.com/users/5021498/erik-listor"}, "edited": false, "score": 0, "creation_date": 1434628827, "post_id": 30902905, "comment_id": 49866645, "body": "im fairly new to Access. So far im just testing on an emtpy .accdb file that only has an empty Table1. Is this right?"}, {"owner": {"reputation": 9, "user_id": 5021498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dddb2c9dc3ed32c8947358ba8ba5682d?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Listor", "link": "https://stackoverflow.com/users/5021498/erik-listor"}, "edited": false, "score": 0, "creation_date": 1434630119, "post_id": 30902905, "comment_id": 49867523, "body": "okay.. i made a query. new error: &quot;Query must have at least one destination field&quot;...?"}], "tags": [], "owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "is_accepted": false, "score": 0, "last_activity_date": 1434627860, "last_edit_date": 1434627860, "creation_date": 1434577340, "answer_id": 30902905, "question_id": 30902092, "link": "https://stackoverflow.com/questions/30902092/copying-data-from-excel-into-access-with-vba/30902905#30902905", "title": "Copying data from excel into access with VBA?", "body": "<p>Use <code>ACE.OLEDB</code>. Create an SQL INSERT STATEMENT. Code would look something like below:</p>\n\n<pre><code>    Sub Test()\n        accessFilePath = \"C:\\someDB.accdb\"\n        Call ExecuteSQLCmd(\"INSERT INTO `\" &amp; accessFilePath &amp; \"`.`Table` (col1,col2,col3) SELECT col1,col2,col3 FROM [Sheet1$]\", accessFilePath)\n     End Sub\n\n   Sub ExecuteSQLCmd(cmd As String, accessFilePath as String )\n\n        Dim cnn As ADODB.Connection\n        Dim sql As String\n\n        Set cnn = New ADODB.Connection\n        cnn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; accessFilePath &amp; \";Persist Security Info=False;\"\n\n        If Not (cnn Is Nothing) Then\n            'Execute Sql\n            cnn.Execute (cmd)\n            'Close\n            cnn.Close\n        End If\n        Set cnn = Nothing\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 5021498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dddb2c9dc3ed32c8947358ba8ba5682d?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Listor", "link": "https://stackoverflow.com/users/5021498/erik-listor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 7432, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1552780920, "creation_date": 1434574056, "question_id": 30902092, "link": "https://stackoverflow.com/questions/30902092/copying-data-from-excel-into-access-with-vba", "title": "Copying data from excel into access with VBA?", "body": "<p>Im trying to update an Access database with new code to add to one aggregate list of scan entries. The macro needs to open the access file, copy the range from excel and paste it at the bottom of the database to add to the already existing records. Then save the access .accdb file and then close. Any tips particularly on the copying and pasting data portion?</p>\n"}, {"tags": ["vba", "date", "filter", "range", "timeline"], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 2774043, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zH1Qm.jpg?s=128&g=1", "display_name": "Nate S.", "link": "https://stackoverflow.com/users/2774043/nate-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1438364681, "last_edit_date": 1438364681, "creation_date": 1438364028, "answer_id": 31751972, "question_id": 30901850, "link": "https://stackoverflow.com/questions/30901850/timeline-slicer-select-date-range-using-a-variable/31751972#31751972", "title": "Timeline Slicer Select Date Range using a variable", "body": "<p>You need to assign values to <code>startDate</code>and <code>endDate</code>, unless you are passing in arguments to your procedure, but I don't see that from this code.</p>\n\n<p>Assuming this procedure doesn't take arguments, then if your start date and end date reside in cells, say \"A1\" and \"A100\", respectively, you could assign them in your code.</p>\n\n<pre><code>startDate = Range(\"A1\")\nendDate = Range(\"A100\")\n</code></pre>\n\n<p>Now you will be able to use those variables in your <code>SetFilterDateRange</code> method.</p>\n\n<p>Also it is good practice to assign a data type to each variable. Right now, startDate is a Variant. So in a single-line declaration of multiple variables, you should write</p>\n\n<pre><code>Dim startDate As Date, endDate As Date\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6075511, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/516968a971b8e76665f6bbf7363be412?s=128&d=identicon&r=PG", "display_name": "Mario", "link": "https://stackoverflow.com/users/6075511/mario"}, "is_accepted": false, "score": 0, "last_activity_date": 1458199620, "last_edit_date": 1458199620, "creation_date": 1458198622, "answer_id": 36053761, "question_id": 30901850, "link": "https://stackoverflow.com/questions/30901850/timeline-slicer-select-date-range-using-a-variable/36053761#36053761", "title": "Timeline Slicer Select Date Range using a variable", "body": "<p>You can use this kind of grammer:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>ActiveWorkbook.SlicerCaches(\"NativeTimeline_Timeline1\").TimelineState. _\nSetFilterDateRange year(startDate) &amp; \"/\" &amp; month(startdate) &amp; \"/\" &amp; \nday(startdate), year(endDate) &amp; \"/\" &amp; month(enddate) &amp; \"/\" &amp; day(enddate)\n</code></pre>\n\n<p>it's OK!</p>\n"}], "owner": {"reputation": 13, "user_id": 3046457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3522a5fe96ad2dad634ce2ce225310f?s=128&d=identicon&r=PG&f=1", "display_name": "user3046457", "link": "https://stackoverflow.com/users/3046457/user3046457"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3348, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1458199620, "creation_date": 1434573148, "last_edit_date": 1434580759, "question_id": 30901850, "link": "https://stackoverflow.com/questions/30901850/timeline-slicer-select-date-range-using-a-variable", "title": "Timeline Slicer Select Date Range using a variable", "body": "<p>I have a sheet that I would like to update the timeline date range using a start and end date variable. Information is periodically filled in on a daily basis, so I find the latest date of data entry and save it as the end date. Then I want to show the rolling month up to that date. </p>\n\n<p>Ex. Last day of data entry is June 17th (17/06/2015), that gets assigned to endDate. The startDate goes back a month and is May 18th (18/05/2015). </p>\n\n<p>This code is the recorded macro for an arbitrary selected time range. </p>\n\n<pre><code>ActiveSheet.Shapes.Range(Array(\"Timeline 1\")).Select\nActiveWorkbook.SlicerCaches(\"NativeTimeline_Timeline1\").TimelineState. _\n    SetFilterDateRange \"12/05/2015\", \"16/06/2015\"\n</code></pre>\n\n<p>When I put my startDate and endDate variables in it doesn't work.  </p>\n\n<pre><code>Dim startDate, endDate As Date\n\nActiveSheet.Shapes.Range(Array(\"Timeline 1\")).Select\nActiveWorkbook.SlicerCaches(\"NativeTimeline_Timeline1\").TimelineState. _\n    SetFilterDateRange startDate, endDate\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 4, "creation_date": 1434573323, "post_id": 30901576, "comment_id": 49842673, "body": "With your source and &quot;formatting&quot; workbooks open ,insert a column in your source sheet.  Your formatting formulas should adjust accordingly."}, {"owner": {"reputation": 13, "user_id": 4863747, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e112eebe2bfcaa9fa3c8ef71e252c908?s=128&d=identicon&r=PG&f=1", "display_name": "WUDA", "link": "https://stackoverflow.com/users/4863747/wuda"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1434573924, "post_id": 30901576, "comment_id": 49843011, "body": "Holy crap.  I cannot believe it was that simple.  CURSE YOU EXCEL."}], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1434573675, "creation_date": 1434573675, "answer_id": 30901988, "question_id": 30901576, "link": "https://stackoverflow.com/questions/30901576/complicated-string-replace/30901988#30901988", "title": "Complicated string replace", "body": "<p>The following function will shift AD1 to AE1:</p>\n\n<pre><code>Function ShiftAddress(CellAddress As String, Optional shift As Long = 1) As String\n    Dim R As Range\n    Set R = Range(CellAddress)\n    ShiftAddress = R.Offset(0, shift).Address(False, False)\nEnd Function\n</code></pre>\n\n<p>ShiftAddress(\"AD1\") returns \"AE1\". ShiftAddress(\"AD1\",2) returns \"AF1\", etc.</p>\n"}], "owner": {"reputation": 13, "user_id": 4863747, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e112eebe2bfcaa9fa3c8ef71e252c908?s=128&d=identicon&r=PG&f=1", "display_name": "WUDA", "link": "https://stackoverflow.com/users/4863747/wuda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1434576275, "creation_date": 1434572228, "last_edit_date": 1434576275, "question_id": 30901576, "link": "https://stackoverflow.com/questions/30901576/complicated-string-replace", "title": "Complicated string replace", "body": "<p>I have some data that gets pulled on a weekly basis and looks terrible, so I have a formatting sheet that puts the data in a more friendly format that's readable.                                                       </p>\n\n<p>Unfortunately management decided to add a column in the raw data, which throws off all of my cell references by 1 column. Here's my current code in the cells:</p>\n\n<pre><code>=IF(([SPREADSHEETREF.xlsx]Raw1!AD3)=0,\"-\",([SPREADSHEETREF.xlsx]Raw1!AD3))\n</code></pre>\n\n<p>I need to \"add\" one column to the current references.  So that in the above example, it would replaces <code>AD3</code> with <code>AE3</code>.  </p>\n\n<p>I was thinking of using <code>WorksheetFunction.Replace( old_text, start, number_of_chars, new_text )</code>, but I'm not sure it would work in this case.</p>\n\n<p>I can't seem to figure out how to make the <code>new_text</code> some type of value addition, so that it's like <code>OldValue + 1 = AE</code>.  The columns being referenced are all over the place, so I need the flexibility of using like a +1 formula to do this.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 58, "user_id": 5021328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa1de4fae4e88438788608da57d8592f?s=128&d=identicon&r=PG&f=1", "display_name": "Alex B.", "link": "https://stackoverflow.com/users/5021328/alex-b"}, "edited": false, "score": 0, "creation_date": 1434633842, "post_id": 30902353, "comment_id": 49870401, "body": "Sorry for the vague question. When I create the totals text boxes I am creating them from the designer by clicking on the sigma in the grouping and totals section while I have the field I want to total selected. So, I am getting the default code and field name that Access is assigning the totals field I create. The field I am using for testing is formatted to currency both in the query and in the properties of the control. I guess that&#39;s why my question is a bit vague, I&#39;m not doing anything that is immediately obvious that it is wrong, but I have to be doing something wrong."}, {"owner": {"reputation": 61, "user_id": 5021183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e31493b7c890f9d0cba96e566237d781?s=128&d=identicon&r=PG&f=1", "display_name": "dmoody007", "link": "https://stackoverflow.com/users/5021183/dmoody007"}, "reply_to_user": {"reputation": 58, "user_id": 5021328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa1de4fae4e88438788608da57d8592f?s=128&d=identicon&r=PG&f=1", "display_name": "Alex B.", "link": "https://stackoverflow.com/users/5021328/alex-b"}, "edited": false, "score": 0, "creation_date": 1434634628, "post_id": 30902353, "comment_id": 49871028, "body": "Ok - Just a couple of quick questions. When you look at the properties of the &quot;total&quot; text box created by the wizard, what is in the control source field?  Also, where is the text box placed?  Is it in the report footer, page footer, detail, grouping footer?"}, {"owner": {"reputation": 61, "user_id": 5021183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e31493b7c890f9d0cba96e566237d781?s=128&d=identicon&r=PG&f=1", "display_name": "dmoody007", "link": "https://stackoverflow.com/users/5021183/dmoody007"}, "reply_to_user": {"reputation": 58, "user_id": 5021328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa1de4fae4e88438788608da57d8592f?s=128&d=identicon&r=PG&f=1", "display_name": "Alex B.", "link": "https://stackoverflow.com/users/5021328/alex-b"}, "edited": false, "score": 0, "creation_date": 1434636040, "post_id": 30902353, "comment_id": 49872244, "body": "I just got my hands on 2010 and found that the Access wizard works better than I remember.  One issue I typically see is people name fields like &quot;Yearly Annual Revenue&quot;.  The spaces cause issues if not handled correctly.  Common practice is to name fields like &quot;Yearly_Annual_Revenue&quot; or &quot;YearlyAnnualRevenue&quot;.  New Wizards appear to have fixed the issues of old.  Please explain more about query. You mentioned taking a long time to load.  Also, are you seeing any error when you run the report with totals? Does report appear at all, blank, #&#39;s in fields, etc?"}, {"owner": {"reputation": 58, "user_id": 5021328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa1de4fae4e88438788608da57d8592f?s=128&d=identicon&r=PG&f=1", "display_name": "Alex B.", "link": "https://stackoverflow.com/users/5021328/alex-b"}, "edited": false, "score": 0, "creation_date": 1434649711, "post_id": 30902353, "comment_id": 49881501, "body": "the contents of the control source is =Sum([PostageTotal]). PostageTotal is the field I need to sum and the text box is automatically placed in the report footer. I don&#39;t get any error messages or codes when attempting to run the report, it acts like it is going to run but then stops. It doesn&#39;t freeze Access, its more like it cancels out of the loading."}, {"owner": {"reputation": 58, "user_id": 5021328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa1de4fae4e88438788608da57d8592f?s=128&d=identicon&r=PG&f=1", "display_name": "Alex B.", "link": "https://stackoverflow.com/users/5021328/alex-b"}, "edited": false, "score": 0, "creation_date": 1434650457, "post_id": 30902353, "comment_id": 49881941, "body": "As for the query, it isn&#39;t something I designed, but as far as I can tell it is a query that selects from other saved queries, so running this query causes 5+ other queries to run. I haven&#39;t drilled down through all the queries yet to figure out how many are running. I&#39;m working on reducing the number that need to run to feed the correct data into the report. It is someone else&#39;s queries and reports in an open source program so I don&#39;t know quite how all of it works yet."}, {"owner": {"reputation": 58, "user_id": 5021328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa1de4fae4e88438788608da57d8592f?s=128&d=identicon&r=PG&f=1", "display_name": "Alex B.", "link": "https://stackoverflow.com/users/5021328/alex-b"}, "edited": false, "score": 0, "creation_date": 1434652640, "post_id": 30902353, "comment_id": 49883164, "body": "A rough mapping of the query shows 7 other queries being ran all of them contain joins and one that might be running twice contains a union. That is probably why it is slow."}, {"owner": {"reputation": 61, "user_id": 5021183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e31493b7c890f9d0cba96e566237d781?s=128&d=identicon&r=PG&f=1", "display_name": "dmoody007", "link": "https://stackoverflow.com/users/5021183/dmoody007"}, "reply_to_user": {"reputation": 58, "user_id": 5021328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa1de4fae4e88438788608da57d8592f?s=128&d=identicon&r=PG&f=1", "display_name": "Alex B.", "link": "https://stackoverflow.com/users/5021328/alex-b"}, "edited": false, "score": 0, "creation_date": 1434656687, "post_id": 30902353, "comment_id": 49885601, "body": "Agree - 7 simultaneous queries is heavy.  As far as debugging other&#39;s work, we&#39;ve all been there.  Not fun.  The report fields and calcs appear correct so I don&#39;t think it is the issue. It could be the additional load of totaling with the 7 queries."}, {"owner": {"reputation": 61, "user_id": 5021183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e31493b7c890f9d0cba96e566237d781?s=128&d=identicon&r=PG&f=1", "display_name": "dmoody007", "link": "https://stackoverflow.com/users/5021183/dmoody007"}, "reply_to_user": {"reputation": 58, "user_id": 5021328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa1de4fae4e88438788608da57d8592f?s=128&d=identicon&r=PG&f=1", "display_name": "Alex B.", "link": "https://stackoverflow.com/users/5021328/alex-b"}, "edited": false, "score": 0, "creation_date": 1434656700, "post_id": 30902353, "comment_id": 49885608, "body": "Have suggestion: Copy the DB to desktop or something and use the copy so you don&#39;t ruin your original. Take the final query in the chain and change to a MakeTable query and have it create a temp table.  Change query back to a select query.  Go into the report properties and change the source from the select query to the temp table.  Try adding the total fields again and run.  This way you are taking out the process load of the 7 queries.  If it works, you know where the issue is.  Otherwise, back to the drawing board."}, {"owner": {"reputation": 58, "user_id": 5021328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa1de4fae4e88438788608da57d8592f?s=128&d=identicon&r=PG&f=1", "display_name": "Alex B.", "link": "https://stackoverflow.com/users/5021328/alex-b"}, "edited": false, "score": 0, "creation_date": 1434661114, "post_id": 30902353, "comment_id": 49888153, "body": "Yep, that works. It is definitely the multiple queries + the totals that causes it to bomb while loading the report. If you could repost that suggestion as an answer I&#39;ll mark it as correct so you get credit for it. I&#39;ll edit my original question to clarify for others that may come across this issue. Thank you for your help! @dmoody007"}], "tags": [], "owner": {"reputation": 61, "user_id": 5021183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e31493b7c890f9d0cba96e566237d781?s=128&d=identicon&r=PG&f=1", "display_name": "dmoody007", "link": "https://stackoverflow.com/users/5021183/dmoody007"}, "is_accepted": true, "score": 0, "last_activity_date": 1434574974, "creation_date": 1434574974, "answer_id": 30902353, "question_id": 30901495, "link": "https://stackoverflow.com/questions/30901495/adding-access-totals-cause-report-to-not-run/30902353#30902353", "title": "Adding Access totals cause report to not run", "body": "<p>The question is a little vague.  Any of these can either display errors or cause the report to not run.</p>\n\n<p>Use Control Name in detail section of report for totals field (example: Name is Overtime so total of overtime should appear like =Sum([OverTime]))</p>\n\n<p>Be careful not to name your controls the same.  Detail control can be named Overtime. Your total of overtime should NOT be named overtime as well. Name it like Tot_OverTime otherwise you could end up with a circular reference.</p>\n\n<p>If counting a text field, know that null fields are an issue. Suggest counting identity seeds or fields you know always have a value.</p>\n\n<p>Make sure each control in detail you plan to sum, is formatted for numbers.  If you look at the control property, format should be a number and you can assign decimal places.  If not, you need to check your query or source table to ensure field is properly assigned a format.</p>\n\n<p>One good tip. Add one field to total at a time.  A little tedious but ensures one works before adding the next. Always recommend this to newbies until they get real comfortable making reports.  Easier to debug.</p>\n\n<p>Good Luck.</p>\n"}], "owner": {"reputation": 58, "user_id": 5021328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa1de4fae4e88438788608da57d8592f?s=128&d=identicon&r=PG&f=1", "display_name": "Alex B.", "link": "https://stackoverflow.com/users/5021328/alex-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 30902353, "answer_count": 1, "score": 1, "last_activity_date": 1434661386, "creation_date": 1434571940, "last_edit_date": 1434661386, "question_id": 30901495, "link": "https://stackoverflow.com/questions/30901495/adding-access-totals-cause-report-to-not-run", "title": "Adding Access totals cause report to not run", "body": "<p>I am trying to add a few totals (sums and counts) using the wizard to an Access report. When I add them to the report and try to view the report, the report fails. Without the totals the report will display. The only thing I can figure that may be a factor is that the query being run to populate the report takes a bit to execute. The query runs a series of other queries which takes longer than normal to generate the report.</p>\n\n<p>ETA: Thank you dmoody007 for your help in rooting out the problem and confirming my suspicions.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1434572218, "post_id": 30901136, "comment_id": 49842074, "body": "Could you use a pivot table? These are much faster....Alternatively, you could save the file without the formulas (once a day depending on how often the users need refreshes) so that when they open the file, it&#39;s not calculating anymore, then just calculate in one main workbook to distribute each day."}, {"owner": {"reputation": 7517, "user_id": 3314095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nJlbV.png?s=128&g=1", "display_name": "XOR LX", "link": "https://stackoverflow.com/users/3314095/xor-lx"}, "edited": false, "score": 0, "creation_date": 1434572767, "post_id": 30901136, "comment_id": 49842359, "body": "Each of the formulas you posted is incredibly efficient and quick to calculate. What&#39;s more, the ranges they are referencing are not particularly large at all. Precisely how many copies of these formulas do you have at any given time in your workbook?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1434573009, "post_id": 30901136, "comment_id": 49842501, "body": "How many of these formulas do you have? One for each pair consisting of a zone name and a row in the range 2 to 500? If all of these formulas are in a single block of cells, perhaps you can have a single UDF array function for the results."}, {"owner": {"reputation": 123, "user_id": 4119382, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d4d71f63c4d026b3473c448343f853ae?s=128&d=identicon&r=PG&f=1", "display_name": "wh4tshisf4c3", "link": "https://stackoverflow.com/users/4119382/wh4tshisf4c3"}, "edited": false, "score": 0, "creation_date": 1434573782, "post_id": 30901136, "comment_id": 49842933, "body": "OpiesDad: I will look into a pivot table, thank you for the suggestion. As for tricks with saving, the workbook will be out of my hands and distributed when complete so I am unable to do such activities.  XOR LX and John Coleman: You have both hit on the reason for why I am asking stackoverflow. I have read about people not complaining until having tens of thousands of array formuals; so my issue seemed odd in comparison. I have 500 rows, aggregating into 9 distinct columns, therefore 4,500 SUM formulas. Each of these traverse two arrays of 218 cells each. Is that alot?"}, {"owner": {"reputation": 7517, "user_id": 3314095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nJlbV.png?s=128&g=1", "display_name": "XOR LX", "link": "https://stackoverflow.com/users/3314095/xor-lx"}, "edited": false, "score": 0, "creation_date": 1434574729, "post_id": 30901136, "comment_id": 49843459, "body": "I honestly cannot believe that those formulas alone would take more than a second or two to calculate. Are the formulas you posted precisely those you are using? You&#39;re not, for example, using SUMPRODUCT with a much larger range being referenced than that you posted here?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1434574766, "post_id": 30901136, "comment_id": 49843474, "body": "4500 array formulas each of which traverse 2x218 cells doesn&#39;t seem like a lot. Certainly nothing that would explain 40-90 seconds of recalculation. Sounds like they might be depending on some volatile values"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1434574873, "post_id": 30901136, "comment_id": 49843525, "body": "Agree with @JohnColeman, do you have a <code>Volatile</code> function somewhere else in the spreadsheet?  Typical offenders are <code>OFFSET</code> and <code>INDIRECT</code> or a UDF with <code>Application.Volatile = True</code>.  These volatile functions will cause a recalculation on every update and can create a cascade of updates.  <a href=\"http://www.decisionmodels.com/calcsecretsi.htm\" rel=\"nofollow noreferrer\">decisionmodels.com/calcsecretsi.htm</a>"}, {"owner": {"reputation": 7517, "user_id": 3314095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nJlbV.png?s=128&g=1", "display_name": "XOR LX", "link": "https://stackoverflow.com/users/3314095/xor-lx"}, "edited": false, "score": 0, "creation_date": 1434576211, "post_id": 30901136, "comment_id": 49844185, "body": "I just performed a quick test in a new workbook in which I took the formula =SUMIF(Sheet1!$A$2:Sheet1!$HJ$2, &quot;North America&quot;, Sheet2!$A2:Sheet2!$HJ2) and pasted it into 4500 rows beginning in Sheet1 row 3. I then placed the formula =IF(RANDBETWEEN(1,2)=1,&quot;North America&quot;,&quot;&quot;) into Sheet1 B2:HI2 and the formula =RANDBETWEEN(1,99) into the range Sheet2 A2:HJ4500. Full workbook recalculation takes less than half a second. And RANDBETWEEN is a volatile function. Are you sure there&#39;s not something else you&#39;re not telling us about your workbook?"}, {"owner": {"reputation": 123, "user_id": 4119382, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d4d71f63c4d026b3473c448343f853ae?s=128&d=identicon&r=PG&f=1", "display_name": "wh4tshisf4c3", "link": "https://stackoverflow.com/users/4119382/wh4tshisf4c3"}, "edited": false, "score": 0, "creation_date": 1434579299, "post_id": 30901136, "comment_id": 49845520, "body": "The workbook as a whole is an amalgamation of formulas and logic spread across multiple sheets. The vast majority of these are simple calculations, none of which are volatile to my knowledge. One thing I did not include about the workbook is that those 500 rows, 218 columns of Sheet 2 values are references to &quot;Total&quot; values elsewhere in the workbook. I guess Excel must be coming up with some hefty dependency trees or something, because now that I test it, if I copy/paste the Sheet 2 as values (rather than them being references), the worksheet calculates speedily."}, {"owner": {"reputation": 7517, "user_id": 3314095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nJlbV.png?s=128&g=1", "display_name": "XOR LX", "link": "https://stackoverflow.com/users/3314095/xor-lx"}, "edited": false, "score": 0, "creation_date": 1434607227, "post_id": 30901136, "comment_id": 49852959, "body": "Would you be willing to share the workbook (desensitized if necessary)?"}, {"owner": {"reputation": 123, "user_id": 4119382, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d4d71f63c4d026b3473c448343f853ae?s=128&d=identicon&r=PG&f=1", "display_name": "wh4tshisf4c3", "link": "https://stackoverflow.com/users/4119382/wh4tshisf4c3"}, "edited": false, "score": 0, "creation_date": 1434652847, "post_id": 30901136, "comment_id": 49883273, "body": "Thank you for your time spent and advice everyone (extra kudos to XOR LX). Unfortunately it would be quite the effort to try and desensitize and maintain a working workbook. This has helped though with my due diligence and I have plenty of ammo for showing the powers that be that we are in a &quot;tough noogies&quot; scenario. Thanks again!"}, {"owner": {"reputation": 3725, "user_id": 4388883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3cf69657df9c46dd460e73760894308?s=128&d=identicon&r=PG&f=1", "display_name": "ian0411", "link": "https://stackoverflow.com/users/4388883/ian0411"}, "edited": false, "score": 0, "creation_date": 1503072408, "post_id": 30901136, "comment_id": 78479676, "body": "Maybe try to save the spreadsheet as <code>.xlsb</code> format to see if that will help..."}], "owner": {"reputation": 123, "user_id": 4119382, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d4d71f63c4d026b3473c448343f853ae?s=128&d=identicon&r=PG&f=1", "display_name": "wh4tshisf4c3", "link": "https://stackoverflow.com/users/4119382/wh4tshisf4c3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2186, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1434570792, "creation_date": 1434570792, "question_id": 30901136, "link": "https://stackoverflow.com/questions/30901136/alternative-to-sumproduct-sumif-sumifs", "title": "Alternative to Sumproduct / Sumif / Sumifs", "body": "<p>I am looking for an alternative solution to using Sumproduct / Sumif / Sumifs (basically, array formulas) when it comes to the example provided below. I have scoured Stackoverflow and I am coming up woefully empty. I am open to any-and-all suggestions to achieve better performance that do not involve changing out of Excel because that is the medium I have been ordered to do this in. Thank you in advanced for your time!</p>\n\n<p>My problem is thus: I have an excel workbook that takes 40-90 seconds to calculate, depending on PC specs. I have narrowed the calculation problems to a series of array calculations. When these array calculations are removed, my workbook takes 3 seconds to fully re-calculate... so yes I am sure these are the bottleneck.</p>\n\n<p>My array calculations are like so: I have a list of zone names (eg: North America, Western Europe, etc...) on Sheet 1, row 2, extending to column HJ. I have a list of values on Sheet 2 rows 2-500, also extending to column HJ. I need to aggregate/\"sum-up\" all of the values on Sheet 2, based on the zone names on Sheet 1. The columns are in a direct 1-to-1 relationship, so the following formulae all work and create the exact same values:</p>\n\n<pre><code>=SUMPRODUCT(Sheet2!A2:Sheet2!HJ2, --(Sheet1!$A$2:Sheet1!$HJ$2 = \"North America\"))\n=SUMIF(Sheet1!$A$2:Sheet1!$HJ$2, \"North America\", Sheet2!$A2:Sheet2!$HJ2) \n=SUMIFS(Sheet2!$A2:Sheet2!$HJ2, Sheet1!$A$2:Sheet1!$HJ$2, \"North America\")\n</code></pre>\n\n<p>The performance of doing these array calculations is \"unacceptable\" to the powers that be. I am fairly certain that my response should be \"tough noogies\", but I must do my due diligence on finding an alternative.</p>\n\n<p>So am I doing anything wrong with these array calculations? Can I restructure them somehow? I am fine with helper rows, UDF's, etc...</p>\n\n<p>Thanks again!</p>\n"}, {"tags": ["vba", "internet-explorer", "excel"], "owner": {"reputation": 11, "user_id": 5021220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c02bbecb8075decfdae445fd5d7f2eb1?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/5021220/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 197, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1434572205, "creation_date": 1434569878, "last_edit_date": 1434572205, "question_id": 30900863, "link": "https://stackoverflow.com/questions/30900863/interacting-with-ie-tabs-once-opened", "title": "Interacting with IE tabs once opened", "body": "<p>What I'm trying to do here is automate the opening of several helpdesk tickets simultaneously in separate IE tabs.  I create a list of ticket numbers in Excel and then loop through the ticket numbers, opening each one.  </p>\n\n<p>My code seems to work fine when I open each one in a separate IE instance, but since I've tried to open them in separate tabs of one IE instance, I get an error on the second loop.  Here is what I have so far:</p>\n\n \n\n<pre class=\"lang-vb prettyprint-override\"><code>Set Tickets = Sheet5.Range(\"a1\", Range(\"a1\").End(xlDown))\n\nSet ie = New InternetExplorerMedium\nie.Visible = 1\napiShowWindow ie.hwnd, SW_MAXIMIZE\n\nFor Each Ticket In Tickets\n\nIf Ticket &lt;&gt; \"\" And Not Ticket Like \"IM*\" And Not Ticket Like \"ARS*\" And Not      Ticket Like \"C*\" Then\n\n    'Load Mantis Page\n    If Tabbed = False Then\n        ie.Navigate \"http://URL\"\n    Else:\n        ie.Navigate \"http://URL\", CLng(2048)\n    End If\n\n    Do\n    DoEvents\n    Loop Until ie.ReadyState = 4\n\n    'LoginCheck\n    Set LoginExists = ie.document.getElementById(\"username\")\n    If LoginExists Is Nothing Then\n        GoTo SearchForTicket\n    Else: GoTo Login\n    End If\n\nLogin:\n    Call ie.document.getElementById(\"username\").SetAttribute(\"value\", \"xx\")\n    Call ie.document.getElementById(\"password\").SetAttribute(\"value\", \"xx\")\n    ie.document.getElementById(\"login_form\").Submit\n\n    Do\n    DoEvents\n    Loop Until ie.ReadyState = 3\n    GoTo SearchForTicket\n\n    'Search for Mantis ticket\nSearchForTicket:\n\n    Application.Wait (Now + TimeValue(\"0:00:03\"))\n\n    ie.document.All(\"bug_id\").Value = Ticket\n\n    Set AllButtons = ie.document.getElementsByTagName(\"input\")\n        For Each Button In AllButtons\n            If Button.Value = \"Jump\" Then\n                Button.Click\n                Exit For\n            End If\n\n        Next\nEnd If\nTabbed = True\nNext\n</code></pre>\n\n<p>It works the first time around, and opens IE, navigates to the page and searches for the ticket.  The second time around, it opens the new tab and navigates to the page, but when it tries to search for the second ticket, I get an error saying: </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Object doesn't support this property or method\"\n</code></pre>\n\n<p>On line: </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>ie.document.All(\"bug_id\").Value = Ticket\n</code></pre>\n\n<p>I've been searching for an answer with no luck so far.  Any help would be appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 176, "user_id": 4044346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0f147f8766920927c8692df420c250f8?s=128&d=identicon&r=PG&f=1", "display_name": "hypetech", "link": "https://stackoverflow.com/users/4044346/hypetech"}, "edited": false, "score": 0, "creation_date": 1434569809, "post_id": 30900625, "comment_id": 49840529, "body": "Did the code just not work, or you&#39;re not even sure how to do what you want to?"}, {"owner": {"reputation": 176, "user_id": 4044346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0f147f8766920927c8692df420c250f8?s=128&d=identicon&r=PG&f=1", "display_name": "hypetech", "link": "https://stackoverflow.com/users/4044346/hypetech"}, "edited": false, "score": 0, "creation_date": 1434571417, "post_id": 30900625, "comment_id": 49841631, "body": "Are you getting an error message, or is the data appearing but wrong, or is no data showing up? Please give all the details you have."}, {"owner": {"reputation": 5, "user_id": 5020840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45ee3d88498f2b1148e66019d1032f46?s=128&d=identicon&r=PG&f=1", "display_name": "awilso11", "link": "https://stackoverflow.com/users/5020840/awilso11"}, "reply_to_user": {"reputation": 176, "user_id": 4044346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0f147f8766920927c8692df420c250f8?s=128&d=identicon&r=PG&f=1", "display_name": "hypetech", "link": "https://stackoverflow.com/users/4044346/hypetech"}, "edited": false, "score": 0, "creation_date": 1434571726, "post_id": 30900625, "comment_id": 49841789, "body": "@hypetech ...The code isn&#39;t working after the &quot;For k = 35 to 35&quot; statement. Before this code, I had another code developed in a similar way but it would only change the cell for that row. For an example: sheet 2 column A row 3  account number is found on sheet 1 column A row 5 but because the account number data is in row 3 column A of sheet 2, it only changed column Y of sheet 1 for row 3 and not row 5 (row 5 is the corresponding account number)"}, {"owner": {"reputation": 5, "user_id": 5020840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45ee3d88498f2b1148e66019d1032f46?s=128&d=identicon&r=PG&f=1", "display_name": "awilso11", "link": "https://stackoverflow.com/users/5020840/awilso11"}, "reply_to_user": {"reputation": 176, "user_id": 4044346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0f147f8766920927c8692df420c250f8?s=128&d=identicon&r=PG&f=1", "display_name": "hypetech", "link": "https://stackoverflow.com/users/4044346/hypetech"}, "edited": false, "score": 0, "creation_date": 1434571835, "post_id": 30900625, "comment_id": 49841850, "body": "@hypetech This is the first code I developed before posting this one as explained above: Sub UpdateTBP() Dim i Dim LastRow LastRow = Sheets(&quot;TBP&quot;).Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row  For i = 2 To LastRow  If Sheets(&quot;TBP&quot;).Cells(i, &quot;AI&quot;).value &lt;&gt; &quot;&quot; And Sheets(&quot;TBP&quot;).Cells(i, &quot;A&quot;).value = Sheets(&quot;Portfolio&quot;).Cells(i, &quot;A&quot;).value Then Sheets(&quot;Portfolio&quot;).Cells(i, &quot;Y&quot;).value = &quot;Complete&quot; End If Next ThisWorkbook.Save End Sub"}, {"owner": {"reputation": 5, "user_id": 5020840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45ee3d88498f2b1148e66019d1032f46?s=128&d=identicon&r=PG&f=1", "display_name": "awilso11", "link": "https://stackoverflow.com/users/5020840/awilso11"}, "reply_to_user": {"reputation": 176, "user_id": 4044346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0f147f8766920927c8692df420c250f8?s=128&d=identicon&r=PG&f=1", "display_name": "hypetech", "link": "https://stackoverflow.com/users/4044346/hypetech"}, "edited": false, "score": 0, "creation_date": 1434572043, "post_id": 30900625, "comment_id": 49841978, "body": "@hypetech There&#39;s no error message or anything, its just that the word &quot;Complete&quot; is not being filled in at all (neither the correct or incorrect cells; as if nothing is being done)"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 5020840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45ee3d88498f2b1148e66019d1032f46?s=128&d=identicon&r=PG&f=1", "display_name": "awilso11", "link": "https://stackoverflow.com/users/5020840/awilso11"}, "edited": false, "score": 0, "creation_date": 1434572318, "post_id": 30901381, "comment_id": 49842115, "body": "I have tried taking out the For k = 35 To 35 loop and even substituted the &quot;Y&quot; with 25 instead and was getting the same issue before I posted on here"}, {"owner": {"reputation": 219, "user_id": 4080394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RHAaZ.jpg?s=128&g=1", "display_name": "daytonrazorback", "link": "https://stackoverflow.com/users/4080394/daytonrazorback"}, "reply_to_user": {"reputation": 5, "user_id": 5020840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45ee3d88498f2b1148e66019d1032f46?s=128&d=identicon&r=PG&f=1", "display_name": "awilso11", "link": "https://stackoverflow.com/users/5020840/awilso11"}, "edited": false, "score": 0, "creation_date": 1434572472, "post_id": 30901381, "comment_id": 49842198, "body": "Are you looking in Column AI or AH on the sheet TBP?"}, {"owner": {"reputation": 5, "user_id": 5020840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45ee3d88498f2b1148e66019d1032f46?s=128&d=identicon&r=PG&f=1", "display_name": "awilso11", "link": "https://stackoverflow.com/users/5020840/awilso11"}, "edited": false, "score": 0, "creation_date": 1434572700, "post_id": 30901381, "comment_id": 49842328, "body": "Column AI is the cell Im using to validate if the word complete should be filled in. So if the account number of sheet 2 row 3 column AI is not empty then the corresponding account number row of sheet 1 column Y should say &quot;Complete&quot;"}, {"owner": {"reputation": 219, "user_id": 4080394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RHAaZ.jpg?s=128&g=1", "display_name": "daytonrazorback", "link": "https://stackoverflow.com/users/4080394/daytonrazorback"}, "reply_to_user": {"reputation": 5, "user_id": 5020840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45ee3d88498f2b1148e66019d1032f46?s=128&d=identicon&r=PG&f=1", "display_name": "awilso11", "link": "https://stackoverflow.com/users/5020840/awilso11"}, "edited": false, "score": 0, "creation_date": 1434573959, "post_id": 30901381, "comment_id": 49843033, "body": "@awilso11 I just posted a modified version of your code which worked for me."}, {"owner": {"reputation": 5, "user_id": 5020840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45ee3d88498f2b1148e66019d1032f46?s=128&d=identicon&r=PG&f=1", "display_name": "awilso11", "link": "https://stackoverflow.com/users/5020840/awilso11"}, "edited": false, "score": 0, "creation_date": 1434575665, "post_id": 30901381, "comment_id": 49843935, "body": "Thank you so much, that worked like I needed. I greatly appreciate it"}], "tags": [], "owner": {"reputation": 219, "user_id": 4080394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RHAaZ.jpg?s=128&g=1", "display_name": "daytonrazorback", "link": "https://stackoverflow.com/users/4080394/daytonrazorback"}, "is_accepted": true, "score": 0, "last_activity_date": 1434574314, "last_edit_date": 1434574314, "creation_date": 1434571610, "answer_id": 30901381, "question_id": 30900625, "link": "https://stackoverflow.com/questions/30900625/search-compare-columns-sheet-1-sheet-2-and-change-a-cell-in-sheet-1/30901381#30901381", "title": "search compare columns sheet 1 &amp; sheet 2 and change a cell in sheet 1", "body": "<p>I was able to make it work by using the following modified code:</p>\n\n<pre><code>Sub UpdateTBP()\nDim i\nDim j\nDim k\nDim LastRow\nDim LastRow2\n\n\nLastRow = Sheets(\"Portfolio\").Cells(Rows.Count, 1).End(xlUp).Row\nLastRow2 = Sheets(\"TBP\").Cells(Rows.Count, 1).End(xlUp).Row\nFor i = 2 To (LastRow - 1)\n  For j = 2 To (LastRow2 - 1)\n    If Sheets(\"Portfolio\").Cells(i, 1).Value = Sheets(\"TBP\").Cells(j, 1).Value Then\n        If Sheets(\"TBP\").Cells(j, 35) &lt;&gt; \"\" Then\n          Sheets(\"Portfolio\").Cells(i, 25).Value = \"Complete\"\n        End If\n    End If\n  Next\nNext\nThisWorkbook.Save\n\nEnd Sub\n</code></pre>\n\n<p>Please note that this will not include your last row of data as you have subtracted it out with:</p>\n\n<pre><code>For i = 2 To (LastRow - 1)\n    For j = 2 To (LastRow2 - 1)\n</code></pre>\n\n<p>If you wish to include that last row, just use the following:</p>\n\n<pre><code>For i = 2 to LastRow\n    For j = 2 to LastRow2\n</code></pre>\n\n<p>This includeds the previous comments I made.  I just gave it a quick test and it is working.</p>\n"}], "owner": {"reputation": 5, "user_id": 5020840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45ee3d88498f2b1148e66019d1032f46?s=128&d=identicon&r=PG&f=1", "display_name": "awilso11", "link": "https://stackoverflow.com/users/5020840/awilso11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 30901381, "answer_count": 1, "score": 0, "last_activity_date": 1434576270, "creation_date": 1434569092, "last_edit_date": 1434576270, "question_id": 30900625, "link": "https://stackoverflow.com/questions/30900625/search-compare-columns-sheet-1-sheet-2-and-change-a-cell-in-sheet-1", "title": "search compare columns sheet 1 &amp; sheet 2 and change a cell in sheet 1", "body": "<p>I really need some help.</p>\n\n<p>Problem: I have a workbook with 2 worksheets. Both sheets has headers. Sheet1 is a list of account numbers in column A and the same for sheet 2 column A. Now, what I need to do is this:</p>\n\n<ul>\n<li>if I place a date in column AI in sheet 2 for a specific account number, then find the corresponding account number in sheet 1 and place the word \"Complete\" in column Y for that account.  </li>\n</ul>\n\n<p>I hope I explained this enough. Below is what I came up with so far, but got stuck:</p>\n\n<pre><code>Sub UpdateTBP()\nDim i\nDim j\nDim k\nDim LastRow\nDim LastRow2\n\nLastRow = Sheets(\"Portfolio\").Cells(Rows.Count, 1).End(xlUp).Row\nLastRow2 = Sheets(\"TBP\").Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = 2 To (LastRow - 1)\n  For j = 2 To (LastRow2 - 1)\n    If Sheets(\"Portfolio\").Cells(i, 1) = Sheets(\"TBP\").Cells(j, 1).value Then\n      For k = 35 To 35\n        If Sheets(\"TBP\").Cells(j, 35) &lt;&gt; \"\" Then\n          Sheets(\"Portfolio\").Cells(i, Y).value = \"Complete\"\n        End If\n      Next\n    End If\n  Next\nNext\nThisWorkbook.Save\n End Sub                                \n</code></pre>\n"}, {"tags": ["vba", "excel", "loops", "object", "find"], "comments": [{"owner": {"reputation": 3687, "user_id": 4331334, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/aewEH.jpg?s=128&g=1", "display_name": "Coding Enthusiast", "link": "https://stackoverflow.com/users/4331334/coding-enthusiast"}, "edited": false, "score": 1, "creation_date": 1434568628, "post_id": 30900430, "comment_id": 49839807, "body": "i summon @hansup .. !"}, {"owner": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "reply_to_user": {"reputation": 3687, "user_id": 4331334, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/aewEH.jpg?s=128&g=1", "display_name": "Coding Enthusiast", "link": "https://stackoverflow.com/users/4331334/coding-enthusiast"}, "edited": false, "score": 1, "creation_date": 1434568763, "post_id": 30900430, "comment_id": 49839887, "body": "<i>Chants laboriously to aid in summoning ritual</i>"}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 1, "creation_date": 1434571326, "post_id": 30900430, "comment_id": 49841562, "body": "This will probably not help, but what happens if you add <code>Dim String1 As String</code> and <code>String1 = &quot;Run:&quot; &amp; i</code> in the appropriate places and change <code>Cells.Find(What:=&quot;Run:&quot; &amp; i</code> to <code>Cells.Find(What:=String1</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "edited": false, "score": 0, "creation_date": 1434629864, "post_id": 30901613, "comment_id": 49867321, "body": "Thank you so much for your answer. This code definitely has been a tremendous challenge, and it only continues to grow!"}], "tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": true, "score": 2, "last_activity_date": 1434572355, "creation_date": 1434572355, "answer_id": 30901613, "question_id": 30900430, "link": "https://stackoverflow.com/questions/30900430/object-variable-or-with-block-variable-not-set-in-loop-using-find-function/30901613#30901613", "title": "Object Variable or With Block Variable Not set in loop using find function", "body": "<p>If the <code>Cells.Find(What:=\"Run:\" &amp; i,...</code> fails to find a match, the <code>Select</code> part of the statement will then cause the error. You should always store the result of a <code>Find</code> in a range variable and then test that for <code>Nothing</code>.</p>\n\n<p>Add this declaration to your code:</p>\n\n<pre><code>Dim cellsFound As Range\n</code></pre>\n\n<p>And replace this:</p>\n\n<pre><code>    Cells.Find(What:=\"Run:\", After:=Cells(1, 1), _\n        LookIn:=xlValues, LookAt:=xlPart, _\n        SearchOrder:=xlByColumns, SearchDirection:=xlNext, _\n        MatchCase:=False, SearchFormat:=False).Select\n    Worksheets(\"filtered\").Cells(10, 10).Value = i\n    If ActiveCell &lt;&gt; \"Run:\" &amp; i Then\n        Exit For\n    End If\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>Set cellsFound = Worksheet(\"sheet_name\").Cells.Find(What:=\"Run:\" &amp; i, After:=Worksheet(\"sheet_name\").Cells(1, 1), _\n        LookIn:=xlValues, LookAt:=xlPart, _\n        SearchOrder:=xlByColumns, SearchDirection:=xlNext, _\n        MatchCase:=False, SearchFormat:=False)\nIf Not(cellsFound Is Nothing) Then\n    Worksheets(\"filtered\").Cells(10, 10).Value = i\nElse\n    ' not found\n    Exit For\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 980, "favorite_count": 1, "accepted_answer_id": 30901613, "answer_count": 1, "score": 2, "last_activity_date": 1434572355, "creation_date": 1434568533, "last_edit_date": 1434569687, "question_id": 30900430, "link": "https://stackoverflow.com/questions/30900430/object-variable-or-with-block-variable-not-set-in-loop-using-find-function", "title": "Object Variable or With Block Variable Not set in loop using find function", "body": "<pre><code>Sub Main()\nDim FName As Variant, R As Long, DirLoc As String, i As Integer\nR = 1\ni = 1\nDirLoc = ThisWorkbook.Path &amp; \"\\\" 'location of files\nFName = Dir(DirLoc &amp; \"*.csv\")\nDo While FName &lt;&gt; \"\"\n    ImportCsvFile DirLoc &amp; FName, ActiveSheet.Cells(R, 1)\n    R = ActiveSheet.UsedRange.Rows.Count + 1\n    FName = Dir\n    For i = 1 To 100\n        Worksheets(\"RAW\").Range(\"B1:B6\").Copy\n        Worksheets(\"filtered\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).PasteSpecial , Transpose:=True\n        Cells.Find(What:=\"Run:\", After:=Cells(1, 1), _\n            LookIn:=xlValues, LookAt:=xlPart, _\n            SearchOrder:=xlByColumns, SearchDirection:=xlNext, _\n            MatchCase:=False, SearchFormat:=False).Select\n        Worksheets(\"filtered\").Cells(10, 10).Value = i\n        If ActiveCell &lt;&gt; \"Run:\" &amp; i Then\n            Exit For\n        End If\n    Next i\n    DeleteFiltered\nLoop\nEnd Sub\n</code></pre>\n\n<p>I am having trouble as I am getting an error at this: </p>\n\n<pre><code>           `Cells.Find(What:=\"Run:\" &amp; i, After:=Cells(1, 1), _\n            LookIn:=xlValues, LookAt:=xlPart, _\n            SearchOrder:=xlByColumns, SearchDirection:=xlNext, _\n            MatchCase:=False, SearchFormat:=False).Select`\n</code></pre>\n\n<p>The error does not occur when I remove \"&amp; i\". I use this to import a data file, and then find a specific \"Run:1.\" It should then copy the data and find the next Run, and the one after that. This is why I need the &amp; i. How can I make this work?</p>\n\n<p>There are some more code sections that are definitely okay, so I left them out.</p>\n"}, {"tags": ["excel", "vba", "ms-access", "import"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 2, "creation_date": 1434568340, "post_id": 30900305, "comment_id": 49839642, "body": "<i>it did not work properly</i> is not a meaningful problem description. In what <b>specific way</b> did it <i>not work</i>?"}, {"owner": {"reputation": 176, "user_id": 4044346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0f147f8766920927c8692df420c250f8?s=128&d=identicon&r=PG&f=1", "display_name": "hypetech", "link": "https://stackoverflow.com/users/4044346/hypetech"}, "edited": false, "score": 0, "creation_date": 1434568410, "post_id": 30900305, "comment_id": 49839687, "body": "If you just want to copy the whole table &quot;memory&quot; over to Excel, there is a much simpler way to do this using DoCmd.TransferSpreadsheet. I don&#39;t see in your code why you couldn&#39;t just use that, but I might be missing something."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1434568726, "post_id": 30900305, "comment_id": 49839870, "body": "See whether you can use Excel&#39;s <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839240.aspx\" rel=\"nofollow noreferrer\">Range.CopyFromRecordset Method</a>"}, {"owner": {"reputation": 387, "user_id": 4971376, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/480da9c324ce828f711b23012b78f0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Ron T", "link": "https://stackoverflow.com/users/4971376/ron-t"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1434568809, "post_id": 30900305, "comment_id": 49839915, "body": "It was able to run but all I saw was the first field of the access table being copied onto the cell(A1) and then it just disappears @Ken White"}, {"owner": {"reputation": 387, "user_id": 4971376, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/480da9c324ce828f711b23012b78f0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Ron T", "link": "https://stackoverflow.com/users/4971376/ron-t"}, "reply_to_user": {"reputation": 176, "user_id": 4044346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0f147f8766920927c8692df420c250f8?s=128&d=identicon&r=PG&f=1", "display_name": "hypetech", "link": "https://stackoverflow.com/users/4044346/hypetech"}, "edited": false, "score": 0, "creation_date": 1434568863, "post_id": 30900305, "comment_id": 49839943, "body": "Sorry, I am new to all of this especially writing macros or coding on VBA, so I&#39;m still in the process of learning this @hypetech"}, {"owner": {"reputation": 176, "user_id": 4044346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0f147f8766920927c8692df420c250f8?s=128&d=identicon&r=PG&f=1", "display_name": "hypetech", "link": "https://stackoverflow.com/users/4044346/hypetech"}, "edited": false, "score": 0, "creation_date": 1434569485, "post_id": 30900305, "comment_id": 49840353, "body": "Is this a one time transfer or part of a routine? There&#39;s a button under the &quot;External Data&quot; Tab at the top to export to excel."}, {"owner": {"reputation": 387, "user_id": 4971376, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/480da9c324ce828f711b23012b78f0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Ron T", "link": "https://stackoverflow.com/users/4971376/ron-t"}, "reply_to_user": {"reputation": 176, "user_id": 4044346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0f147f8766920927c8692df420c250f8?s=128&d=identicon&r=PG&f=1", "display_name": "hypetech", "link": "https://stackoverflow.com/users/4044346/hypetech"}, "edited": false, "score": 0, "creation_date": 1434580122, "post_id": 30900305, "comment_id": 49845840, "body": "This would be part of a routine. For example, if I add more memory on the memory table in the access database, I would like for it to be updated in the excel file as well @hypetech"}, {"owner": {"reputation": 387, "user_id": 4971376, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/480da9c324ce828f711b23012b78f0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Ron T", "link": "https://stackoverflow.com/users/4971376/ron-t"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1434580724, "post_id": 30900305, "comment_id": 49846053, "body": "Thanks! I will check that method out when I get home @HansUp"}], "answers": [{"comments": [{"owner": {"reputation": 387, "user_id": 4971376, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/480da9c324ce828f711b23012b78f0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Ron T", "link": "https://stackoverflow.com/users/4971376/ron-t"}, "edited": false, "score": 0, "creation_date": 1434579951, "post_id": 30900808, "comment_id": 49845781, "body": "This only works if I use this code in access right? I am trying to import the access database file in excel but I want to be able to place them in certain cells. The code I copied above was just for me to see how it works. But thanks, this code will be useful for me as well. @hypetech"}, {"owner": {"reputation": 176, "user_id": 4044346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0f147f8766920927c8692df420c250f8?s=128&d=identicon&r=PG&f=1", "display_name": "hypetech", "link": "https://stackoverflow.com/users/4044346/hypetech"}, "reply_to_user": {"reputation": 387, "user_id": 4971376, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/480da9c324ce828f711b23012b78f0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Ron T", "link": "https://stackoverflow.com/users/4971376/ron-t"}, "edited": false, "score": 0, "creation_date": 1434580079, "post_id": 30900808, "comment_id": 49845822, "body": "Yes you run this code in access. But it doesn&#39;t work if you want to place the data in certain cells, it just throws everything over into excel."}, {"owner": {"reputation": 387, "user_id": 4971376, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/480da9c324ce828f711b23012b78f0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Ron T", "link": "https://stackoverflow.com/users/4971376/ron-t"}, "edited": false, "score": 0, "creation_date": 1434580314, "post_id": 30900808, "comment_id": 49845911, "body": "Gotcha, I need to be able to import the access file in excel. Thank you though, I will definitely use this code though for my other projects."}], "tags": [], "owner": {"reputation": 176, "user_id": 4044346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0f147f8766920927c8692df420c250f8?s=128&d=identicon&r=PG&f=1", "display_name": "hypetech", "link": "https://stackoverflow.com/users/4044346/hypetech"}, "is_accepted": true, "score": 0, "last_activity_date": 1434569709, "creation_date": 1434569709, "answer_id": 30900808, "question_id": 30900305, "link": "https://stackoverflow.com/questions/30900305/importing-data-from-access-to-excel-using-vba/30900808#30900808", "title": "Importing data from access to excel using vba", "body": "<p>If all you want to do is transfer the table to excel, use</p>\n\n<pre><code>DoCmd.TransferSpreadsheet(acExport,, \"memory\", \"file path of excel table\")\n</code></pre>\n\n<p>Your code looks mostly useful if you want to change the data in some way while transferring it, but it doesn't look like you are doing that and therefore this is a much simpler way to run the same routine.</p>\n"}], "owner": {"reputation": 387, "user_id": 4971376, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/480da9c324ce828f711b23012b78f0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Ron T", "link": "https://stackoverflow.com/users/4971376/ron-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8346, "favorite_count": 0, "accepted_answer_id": 30900808, "answer_count": 1, "score": 0, "last_activity_date": 1434652379, "creation_date": 1434568093, "last_edit_date": 1434652379, "question_id": 30900305, "link": "https://stackoverflow.com/questions/30900305/importing-data-from-access-to-excel-using-vba", "title": "Importing data from access to excel using vba", "body": "<p>I am trying to import data from the table \"memory\" in my access database called \"Computer.accdb\", which is located on the desktop to Excel. I was able to find a code online and it was able to run but it did not work properly. I added a reference to the ADO Object Library in Excel using Microsoft ActiveX Data Objects 6.1 Library. Below is the following code:</p>\n\n<pre><code>Sub automateAccessADO_9()\n'Using ADO to Import data from an Access Database Table to an Excel worksheet (your host application).\n'refer Image 9a to view the existing SalesManager Table in MS Access file \"SalesReport.accdb\".\n\n'To use ADO in your VBA project, you must add a reference to the ADO Object Library in Excel (your host application) by clicking Tools-References in VBE, and then choose an appropriate version of Microsoft ActiveX Data Objects x.x Library from the list.\n\n'--------------\n'DIM STATEMENTS\n\nDim strMyPath As String, strDBName As String, strDB As String, strSQL As String\nDim i As Long, n As Long, lFieldCount As Long\nDim rng As Range\n\n'instantiate an ADO object using Dim with the New keyword:\nDim adoRecSet As New ADODB.Recordset\nDim connDB As New ADODB.Connection\n\n'--------------\n'THE CONNECTION OBJECT\n\nstrDBName = \"Computer.accdb\"\nstrMyPath = ThisWorkbook.Path\nstrDB = strMyPath &amp; \"\\\" &amp; strDBName\n\n'Connect to a data source:\n'For pre - MS Access 2007, .mdb files (viz. MS Access 97 up to MS Access 2003), use the Jet provider: \"Microsoft.Jet.OLEDB.4.0\". For Access 2007 (.accdb database) use the ACE Provider: \"Microsoft.ACE.OLEDB.12.0\". The ACE Provider can be used for both the Access .mdb &amp; .accdb files.\nconnDB.Open ConnectionString:=\"Provider = Microsoft.ACE.OLEDB.12.0; data source=\" &amp; strDB\n\n'--------------\n'OPEN RECORDSET, ACCESS RECORDS AND FIELDS\n\nDim ws As Worksheet\n'set the worksheet:\nSet ws = ActiveWorkbook.Sheets(\"Sheet1\")\n\n'Set the ADO Recordset object:\nSet adoRecSet = New ADODB.Recordset\n\n'Opening the table named SalesManager:\nstrTable = \"memory\"\n\n'--------------\n'COPY RECORDS FROM ALL FIELDS OF A RECORDSET:\n'refer Image 9d to view records copied to Excel worksheet\n\nadoRecSet.Open Source:=strTable, ActiveConnection:=connDB, CursorType:=adOpenStatic, LockType:=adLockOptimistic\n\nSet rng = ws.Range(\"A1\")\nlFieldCount = adoRecSet.Fields.Count\n\nFor i = 0 To lFieldCount - 1\n'copy column names in first row of the worksheet:\nrng.Offset(0, i).Value = adoRecSet.Fields(i).Name\nadoRecSet.MoveFirst\n\n'copy record values starting from second row of the worksheet:\nn = 1\nDo While Not adoRecSet.EOF\nrng.Offset(n, i).Value = adoRecSet.Fields(i).Value\nadoRecSet.MoveNext\nn = n + 1\nLoop\n\nNext i\n\n'select column range to AutoFit column width:\nRange(ws.Columns(1), ws.Columns(lFieldCount)).AutoFit\n'worksheet columns are deleted because this code is only for demo:\nRange(ws.Columns(1), ws.Columns(lFieldCount)).Delete\nadoRecSet.Close\n\n'close the objects\nconnDB.Close\n\n'destroy the variables\nSet adoRecSet = Nothing\nSet connDB = Nothing\n\nEnd Sub \n</code></pre>\n"}, {"tags": ["vba", "excel", "object"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 2, "creation_date": 1434568851, "post_id": 30900256, "comment_id": 49839936, "body": "I can&#39;t see any reason why that wouldn&#39;t work as is. Are you getting the error specifically on that line, or is it on your <code>msgbox</code> line? Because that will bomb in the event that the ID isn&#39;t found. Are you certain that there is a sheet with an index of 1 in your workbook (I can&#39;t imagine how there wouldn&#39;t be, but who knows)?"}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 4611124, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fc03cde299ece51be0b81348e2a48553?s=128&d=identicon&r=PG&f=1", "display_name": "keyboardmouse", "link": "https://stackoverflow.com/users/4611124/keyboardmouse"}, "edited": false, "score": 0, "creation_date": 1434572205, "post_id": 30900592, "comment_id": 49842064, "body": "@JNevill  Thanks to Dick Kusleika and JNevill&#39;s thoughtful comments, I realized I didn&#39;t understand the different between Sheet Index, Sheet Name, and Sheet CodeName.  I was incorrectly specifying the index number when using Sheets(1) because I didn&#39;t realize it is not a static reference, and can change, being relative to sheet order/positioning. I thought index referred to CodeName, but it does not. Therefore, you both were correct -- findValue was Nothing because it was not searching in the right sheet. Thank you for helping me understand the nuances in sheet names and referencing sheets."}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": true, "score": 3, "last_activity_date": 1434568979, "creation_date": 1434568979, "answer_id": 30900592, "question_id": 30900256, "link": "https://stackoverflow.com/questions/30900256/excel-vba-code-using-thisworkbook-sheets1-range-not-working-but-sheet1-range/30900592#30900592", "title": "Excel vba code using ThisWorkbook.Sheets(1).Range not working, but Sheet1.Range works fine. Why?", "body": "<p>There is no difference between the properties of Sheets(1) and Sheet1 as long as both are the same object - Worksheet Object in your case.</p>\n\n<p>You're getting that error because <code>findValue Is Nothing</code>. That is, it couldn't find the ID in the column. When using the Find method, it's best to specify every argument. Find remembers the last find you did, even if you did it in the UI and your using Find in VBA.</p>\n\n<p>For instance, if you check MatchCase in the UI when you do a Find. Then you do a Find in VBA and don't specify the MatchCase property, it will use whatever you set the last time.</p>\n"}], "owner": {"reputation": 125, "user_id": 4611124, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fc03cde299ece51be0b81348e2a48553?s=128&d=identicon&r=PG&f=1", "display_name": "keyboardmouse", "link": "https://stackoverflow.com/users/4611124/keyboardmouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4745, "favorite_count": 0, "accepted_answer_id": 30900592, "answer_count": 1, "score": 1, "last_activity_date": 1434569474, "creation_date": 1434567880, "last_edit_date": 1434569474, "question_id": 30900256, "link": "https://stackoverflow.com/questions/30900256/excel-vba-code-using-thisworkbook-sheets1-range-not-working-but-sheet1-range", "title": "Excel vba code using ThisWorkbook.Sheets(1).Range not working, but Sheet1.Range works fine. Why?", "body": "<p>When I use <code>wb.Sheets(1).Range(\"A:A\").Find(What:=ID, LookIn:=xlValues)</code> I get <em>error 91 - Object Variable or With Block not set.</em>  When I use <code>Sheet1.Range(\"A:A\").Find(What:=ID, LookIn:=xlValues)</code> it returns correct value.\nWhy the difference?</p>\n\n<p><strong>Is there a flowchart I can reference or any simple information available to understand which sub-commands (I don't know the proper word) work with <code>ThisWorkbook</code> and <code>Sheets(#)</code> versus <code>Sheet#.Whatever</code>?</strong> </p>\n\n<p>I am hesitant to use <code>Sheet(\"Name\")</code> because names might change later. I am using <code>ThisWorkbook</code> rather than <code>ActiveWorkbook</code> to keep all code attached to the appropriate workbook.</p>\n\n<p>Anything you can offer for simple reference info would be great. I have researched, but still don't understand which sub-commands work with which parent commands. (Again, probably wrong terminology).</p>\n\n<pre><code>Private Sub lstExample_DblClick(ByVal Cancel As MSForms.ReturnBoolean)\n    Dim wb As Workbook\n    Dim I As Integer\n    Dim ID As String\n    Dim findValue As Range\n\n    Set wb = ThisWorkbook\n    'Get the values of the selected row in listbox on doubleclick\n    For I = 0 To lstExample.ListCount - 1\n        If lstExample.Selected(I) = True Then\n    'Set listbox column 1 as ID value to find\n            ID = lstExample.List(I, 1)\n        End If\n    Next I\n\n    'Match ID (column A) on Sheet1\n    Set findValue = wb.Sheets(1).Range(\"A:A\").Find(What:=ID, LookIn:=xlValues)\n    MsgBox findValue\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "edited": false, "score": 0, "creation_date": 1434566432, "post_id": 30899732, "comment_id": 49838437, "body": "What line are you receiving the error on?"}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1434566617, "post_id": 30899732, "comment_id": 49838574, "body": "Do you want (or have to) keep the same procedure? Can we remove the enter altogether and just have it loop through your events? Why is it necessary to press enter for the events to work?"}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1434566868, "post_id": 30899732, "comment_id": 49838719, "body": "What I read here: <a href=\"http://www.mrexcel.com/forum/excel-questions/697548-help-sendkeys-only-first-sendkey-command-works.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a> is that application.sendkeys can be helped by adding a slight delay when they are used one after the other. Maybe you could give it a try? Without context it is hard to give more help!"}, {"owner": {"reputation": 177, "user_id": 2130918, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/ed9eb8dafdca63b95e87f55099fd6b9b?s=128&d=identicon&r=PG", "display_name": "LukeJ", "link": "https://stackoverflow.com/users/2130918/lukej"}, "edited": false, "score": 0, "creation_date": 1434566972, "post_id": 30899732, "comment_id": 49838787, "body": "It will be enough if to selected cell will be send F2 and move to next cell in column Q"}], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 2130918, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/ed9eb8dafdca63b95e87f55099fd6b9b?s=128&d=identicon&r=PG", "display_name": "LukeJ", "link": "https://stackoverflow.com/users/2130918/lukej"}, "edited": false, "score": 0, "creation_date": 1434567023, "post_id": 30899820, "comment_id": 49838816, "body": "Yeah rookie error but still:  Select method of Range class failed"}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "reply_to_user": {"reputation": 177, "user_id": 2130918, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/ed9eb8dafdca63b95e87f55099fd6b9b?s=128&d=identicon&r=PG", "display_name": "LukeJ", "link": "https://stackoverflow.com/users/2130918/lukej"}, "edited": false, "score": 0, "creation_date": 1434567447, "post_id": 30899820, "comment_id": 49839076, "body": "Do you have the &quot;Extract&quot; sheet active?  If not, you&#39;d either have to activate it or use the <code>Application.GoTo</code> command."}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1434567499, "post_id": 30899820, "comment_id": 49839113, "body": "If you comment out the events after the range, does it still send a Range error? If not, what makes it send the error?"}], "tags": [], "owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "is_accepted": false, "score": 0, "last_activity_date": 1434566565, "creation_date": 1434566565, "answer_id": 30899820, "question_id": 30899732, "link": "https://stackoverflow.com/questions/30899732/vba-excel-sendkeys-macro/30899820#30899820", "title": "VBA Excel SendKeys Macro", "body": "<p>It looks like you're looping through using <code>j</code> but in your code, referencing the cell in row <code>i</code>.    </p>\n\n<pre><code>For j = 2 To lastrow\n    Sheets(\"Extract\").Range(\"Q\" &amp; i).Select\n</code></pre>\n\n<p>They need to be changed to match, ie change <code>i</code> to <code>j</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 177, "user_id": 2130918, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/ed9eb8dafdca63b95e87f55099fd6b9b?s=128&d=identicon&r=PG", "display_name": "LukeJ", "link": "https://stackoverflow.com/users/2130918/lukej"}, "edited": false, "score": 0, "creation_date": 1434568909, "post_id": 30900233, "comment_id": 49839970, "body": "Thank you :) Yeah this works fine. Only quick question. When I run macro all changes are visible to me (I see extract sheet and all actions which happen over there). How to set this macro to run more invisible ? I dont want to see what happen in Extract sheet."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 177, "user_id": 2130918, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/ed9eb8dafdca63b95e87f55099fd6b9b?s=128&d=identicon&r=PG", "display_name": "LukeJ", "link": "https://stackoverflow.com/users/2130918/lukej"}, "edited": false, "score": 0, "creation_date": 1434569493, "post_id": 30900233, "comment_id": 49840356, "body": "@LukeJ  See my <b>EDIT#1</b>"}, {"owner": {"reputation": 177, "user_id": 2130918, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/ed9eb8dafdca63b95e87f55099fd6b9b?s=128&d=identicon&r=PG", "display_name": "LukeJ", "link": "https://stackoverflow.com/users/2130918/lukej"}, "edited": false, "score": 0, "creation_date": 1438869763, "post_id": 30900233, "comment_id": 51635129, "body": "It is strange but it works only for first 40 rows. Rest in range are DELETED."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1434569462, "last_edit_date": 1434569462, "creation_date": 1434567811, "answer_id": 30900233, "question_id": 30899732, "link": "https://stackoverflow.com/questions/30899732/vba-excel-sendkeys-macro/30900233#30900233", "title": "VBA Excel SendKeys Macro", "body": "<p>Give this a try:</p>\n\n<pre><code>Sub Refresh()\n    Dim lastrow As Long\n    Worksheets(\"Extract\").Activate\n    lastrow = Range(\"Q\" &amp; Rows.Count).End(xlUp).Row\n    For j = 2 To lastrow\n        Range(\"Q\" &amp; j).Select\n        Application.SendKeys \"{F2}\"\n        Application.SendKeys \"{ENTER}\"\n        DoEvents\n    Next j\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>This version will remove the \"chatter:**</p>\n\n<pre><code>Sub Refresh()\n    Dim sOLD As Worksheet\n    Set sOLD = ActiveSheet\n    Application.ScreenUpdating = False\n        Dim lastrow As Long\n        Worksheets(\"Extract\").Activate\n        lastrow = Range(\"Q\" &amp; Rows.Count).End(xlUp).Row\n        For j = 2 To lastrow\n            Range(\"Q\" &amp; j).Select\n            Application.SendKeys \"{F2}\"\n            Application.SendKeys \"{ENTER}\"\n            DoEvents\n        Next j\n        sOLD.Activate\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 177, "user_id": 2130918, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/ed9eb8dafdca63b95e87f55099fd6b9b?s=128&d=identicon&r=PG", "display_name": "LukeJ", "link": "https://stackoverflow.com/users/2130918/lukej"}, "is_accepted": false, "score": 0, "last_activity_date": 1438871245, "creation_date": 1438871245, "answer_id": 31858396, "question_id": 30899732, "link": "https://stackoverflow.com/questions/30899732/vba-excel-sendkeys-macro/31858396#31858396", "title": "VBA Excel SendKeys Macro", "body": "<p>The day has come when I decided to use Macro provided by Gary's Student (till now I was using my method). So i run macro again and I was suprised but macro worsk only for first 39 rows. </p>\n\n<p>When I put on comment this line</p>\n\n<pre><code>'Application.ScreenUpdating = False\n</code></pre>\n\n<p>It works fine but i see how macro is running row by row (I don't want to see that)</p>\n\n<p>What can cause of problem ?</p>\n"}], "owner": {"reputation": 177, "user_id": 2130918, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/ed9eb8dafdca63b95e87f55099fd6b9b?s=128&d=identicon&r=PG", "display_name": "LukeJ", "link": "https://stackoverflow.com/users/2130918/lukej"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5388, "favorite_count": 0, "accepted_answer_id": 30900233, "answer_count": 3, "score": 0, "last_activity_date": 1438871245, "creation_date": 1434566304, "last_edit_date": 1434568529, "question_id": 30899732, "link": "https://stackoverflow.com/questions/30899732/vba-excel-sendkeys-macro", "title": "VBA Excel SendKeys Macro", "body": "<p>I have some result data in sheet Extract that I need to activate cell by cell and press enter. It's alright for 10 cells but I have over 40 000. So i wrote some macro</p>\n\n<pre><code>   Sub Refresh()\n    Dim lastrow As Long\n    lastrow = ActiveWorkbook.Worksheets(\"Extract\").Range(\"Q\" &amp; rows.Count).End(xlUp).Row\n        For j = 2 To lastrow\n            Sheets(\"Extract\").Activate\n            Sheets(\"Extract\").Range(\"Q\" &amp; j).Select\n            Application.SendKeys \"{F2}\"\n            Application.SendKeys \"{ENTER}\"\n            DoEvents\n        Next j\nEnd Sub\n</code></pre>\n\n<p>And it's not working. I'm gettin 1004 error Application-defined or Object-defined error.</p>\n\n<p>What i'm doing wrong ?</p>\n\n<p>Thanks for help</p>\n\n<p>EDIT: \nSolution was simple. I did not activate Sheet Extract. \nI have add new line into code and everything works fine.</p>\n\n<p>Thanks for all your help.</p>\n"}, {"tags": ["vba", "excel", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 5222, "user_id": 1087852, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8cjly.jpg?s=128&g=1", "display_name": "LucasSeveryn", "link": "https://stackoverflow.com/users/1087852/lucasseveryn"}, "edited": false, "score": 0, "creation_date": 1434619294, "post_id": 30900605, "comment_id": 49860131, "body": "what if I have 5 instances of excel running?"}, {"owner": {"reputation": 5222, "user_id": 1087852, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8cjly.jpg?s=128&g=1", "display_name": "LucasSeveryn", "link": "https://stackoverflow.com/users/1087852/lucasseveryn"}, "edited": false, "score": 0, "creation_date": 1434628957, "post_id": 30900605, "comment_id": 49866734, "body": "I think the issue is that I can&#39;t get System.Runtime.InteropServices.Marshal to work."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 5222, "user_id": 1087852, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8cjly.jpg?s=128&g=1", "display_name": "LucasSeveryn", "link": "https://stackoverflow.com/users/1087852/lucasseveryn"}, "edited": false, "score": 0, "creation_date": 1434632379, "post_id": 30900605, "comment_id": 49869204, "body": "Why do you need to have 5 Excel instance running?"}, {"owner": {"reputation": 5222, "user_id": 1087852, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8cjly.jpg?s=128&g=1", "display_name": "LucasSeveryn", "link": "https://stackoverflow.com/users/1087852/lucasseveryn"}, "edited": false, "score": 0, "creation_date": 1434632553, "post_id": 30900605, "comment_id": 49869345, "body": "I often have more, at the point of writing this reply I have seven, it&#39;s a necessity in my role."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1434569017, "creation_date": 1434569017, "answer_id": 30900605, "question_id": 30899534, "link": "https://stackoverflow.com/questions/30899534/get-a-handle-of-the-already-open-instance-of-excel-and-run-a-macro-inside-from/30900605#30900605", "title": "get a handle of the already open instance of Excel and run a macro inside, from Outlook", "body": "<p>Instead of creating a new Excel Application in the code:</p>\n\n<pre><code> Dim exApp As New Excel.Application\n</code></pre>\n\n<p>You need to get the running Excel instance :</p>\n\n<pre><code>exApp =  System.Runtime.InteropServices.Marshal.GetActiveObject(\"Excel.Application\");\n</code></pre>\n\n<p>See <a href=\"https://xldennis.wordpress.com/2007/11/25/access-running-instances-of-excel-in-vb/\" rel=\"nofollow\">Access running instances of Excel in VB</a> for more information and sample code in VB.NET.</p>\n\n<p>Use the <code>Run</code> method of the Application class to run the VBA macro programmatically. </p>\n"}, {"comments": [{"owner": {"reputation": 5222, "user_id": 1087852, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8cjly.jpg?s=128&g=1", "display_name": "LucasSeveryn", "link": "https://stackoverflow.com/users/1087852/lucasseveryn"}, "edited": false, "score": 0, "creation_date": 1434619344, "post_id": 30902147, "comment_id": 49860165, "body": "you are opening a sheet instead of referring to one that is already open, that&#39;s not the point of my question."}, {"owner": {"reputation": 5222, "user_id": 1087852, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8cjly.jpg?s=128&g=1", "display_name": "LucasSeveryn", "link": "https://stackoverflow.com/users/1087852/lucasseveryn"}, "edited": false, "score": 0, "creation_date": 1434620077, "post_id": 30902147, "comment_id": 49860688, "body": "this is irrelevant to the question as <code>wb</code> is equal to<code>Nothing</code>. Your <code>wb.Name</code> will fail in my question."}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "reply_to_user": {"reputation": 5222, "user_id": 1087852, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8cjly.jpg?s=128&g=1", "display_name": "LucasSeveryn", "link": "https://stackoverflow.com/users/1087852/lucasseveryn"}, "edited": false, "score": 0, "creation_date": 1434624214, "post_id": 30902147, "comment_id": 49863481, "body": "Have you tried using an <code>Auto_Open</code> macro in the workbook?  Also, your question needs the [.Net] tag and more explaining. &quot;How can i loop through the multiple open Excel sessions, looking for a workbook and setting a reference to that workbook?&quot;"}, {"owner": {"reputation": 5222, "user_id": 1087852, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8cjly.jpg?s=128&g=1", "display_name": "LucasSeveryn", "link": "https://stackoverflow.com/users/1087852/lucasseveryn"}, "edited": false, "score": 0, "creation_date": 1434624903, "post_id": 30902147, "comment_id": 49863925, "body": "I want to run a macro on a sheet that&#39;s constantly open from Outlook, what&#39;s the reasoning behind adding anything to auto open?"}], "tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": false, "score": -1, "last_activity_date": 1434619992, "last_edit_date": 1434619992, "creation_date": 1434574262, "answer_id": 30902147, "question_id": 30899534, "link": "https://stackoverflow.com/questions/30899534/get-a-handle-of-the-already-open-instance-of-excel-and-run-a-macro-inside-from/30902147#30902147", "title": "get a handle of the already open instance of Excel and run a macro inside, from Outlook", "body": "<p>You need to include the workbook name when using the <code>Application.Run</code> command.</p>\n\n<p>Try using this:</p>\n\n<pre><code>    exApp.Run wb.Name &amp; \"!\" &amp; usedSub ' must include workbook name\n</code></pre>\n"}], "owner": {"reputation": 5222, "user_id": 1087852, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8cjly.jpg?s=128&g=1", "display_name": "LucasSeveryn", "link": "https://stackoverflow.com/users/1087852/lucasseveryn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1059, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1434619992, "creation_date": 1434565719, "last_edit_date": 1531164843, "question_id": 30899534, "link": "https://stackoverflow.com/questions/30899534/get-a-handle-of-the-already-open-instance-of-excel-and-run-a-macro-inside-from", "title": "get a handle of the already open instance of Excel and run a macro inside, from Outlook", "body": "<p>This is not a duplicate of:\n<a href=\"https://stackoverflow.com/questions/12282310/can-i-set-a-excel-application-object-to-point-to-an-already-open-instance-of-exc\">Can I set a Excel Application Object to point to an already open instance of Excel?</a></p>\n\n<p>The idea is to execute a VBA sub contained in an Excel instance that is already open <strong>from Outlook</strong></p>\n\n<p>I am running the VBA sub as part of a rule in Outlook. </p>\n\n<p>This is my code:</p>\n\n<pre><code>On Error Resume Next\n        Dim tPath As String\n        tPath = \"X:\\Lucas\\LucasSheet.xlsm\"\n        Dim exApp As New Excel.Application\n        Dim wb As Excel.Workbook\n        wb = System.Runtime.InteropServices.Marshal.BindToMoniker(tPath)\n</code></pre>\n\n<p>Unfortunately at this point, when running in debug mode I can see that wb is equal to <code>Nothing</code></p>\n\n<pre><code>        Set exApp = wb.Parent\n        usedSub = \"PrintSingle\"\n        exApp.Run usedSub            \n        wb.Close False\n</code></pre>\n\n<p>Is it possible to make this code work in Outlook 2010?</p>\n"}, {"tags": ["vba", "excel", "events", "userform"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1434568511, "post_id": 30899487, "comment_id": 49839740, "body": "Where is <code>lbl</code> defined and what is the type?  Where is this code running also?  The variable declarations could be in the UserForm code module, but what about the <code>Set</code> and lines below?  Are they executing in an event or somewhere else?"}, {"owner": {"reputation": 23, "user_id": 5021003, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155789480345145/picture?type=large", "display_name": "Robert", "link": "https://stackoverflow.com/users/5021003/robert"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1434575566, "post_id": 30899487, "comment_id": 49843880, "body": "Lbl is defined in the userform module. The second code snippet is in the userform module also. I forgot to say that pTextBoxes is a collection. As I mentioned this all works perfectly with comboboxes, with code running in the same userform module, which is why I don&#39;t understand why there&#39;s a problem with textboxes. Thanks for your help."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 1, "creation_date": 1434580663, "post_id": 30899487, "comment_id": 49846032, "body": "It&#39;s somewhat difficult to say without seeing a more complete picture of the code.  <code>Type mismatch</code> should be easily debugged by adding a breakpoint and seeing what type you are dealing with.  I assume that <code>lbl</code> is declared <code>as TextBox</code> so that the type matches <code>TBox</code>?  Ultimately <code>lbl</code> is not what you think it is or you&#39;ve got a variable defined incorrectly up above.  Debugging will tell you the former.  If it&#39;s the exact same code, hopefully you changed all the <code>ComboBox</code> references to <code>TextBox</code>... that would definitely be a type mismatch."}, {"owner": {"reputation": 23, "user_id": 5021003, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155789480345145/picture?type=large", "display_name": "Robert", "link": "https://stackoverflow.com/users/5021003/robert"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1434617172, "post_id": 30899487, "comment_id": 49858695, "body": "@Byron Thanks, as requested I have edited my question to include the full userform module in question, and both of my custom class modules. I did try declaring a new variable As Textbox, and using that to generate the textbox in case 7 and on the line that throws up the type mismatch, but that still resulted in a type mismatch, which is really confusing and infuriating..."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5021003, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155789480345145/picture?type=large", "display_name": "Robert", "link": "https://stackoverflow.com/users/5021003/robert"}, "edited": false, "score": 0, "creation_date": 1434641549, "post_id": 30918979, "comment_id": 49876571, "body": "Fabulous, with that change it also works for me too. I have found that VBA is full of little idiosyncrasies (or are they just bugs :)) like this. For example I resize a listbox in my code, and I couldn&#39;t work out why the Width setting was being ignored (no error thrown, just didn&#39;t do anything, yet .Top, .Height etc all worked as expected. So I moved that line to the UserForm Initialize sub and it works, although that workaround may not always be practical. Anyway, thank you again for taking the time help me out with this and it&#39;s good learning in that it&#39;s always worth trying another method!"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 23, "user_id": 5021003, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155789480345145/picture?type=large", "display_name": "Robert", "link": "https://stackoverflow.com/users/5021003/robert"}, "edited": false, "score": 0, "creation_date": 1434644290, "post_id": 30918979, "comment_id": 49878372, "body": "If this solves the problem, marking it as an answer (check mark under the voting buttons) helps others know so."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 23, "user_id": 5021003, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155789480345145/picture?type=large", "display_name": "Robert", "link": "https://stackoverflow.com/users/5021003/robert"}, "edited": false, "score": 0, "creation_date": 1434644562, "post_id": 30918979, "comment_id": 49878526, "body": "I agree that VBA can be a bit of a mess.  It allows a lot of flexibility to declare variables, late bind objects, implicitly convert types which can be abused.  It also works on top of Excel which makes the interactions two fold: is this a VBA problem or an Excel problem or something in the intersection?  The number of one-off &quot;gotchas&quot; (like this one) seem to add up and really drag the language down.  Unfortunately, there is also a lot of stuff that appears as a &quot;gotcha&quot; but makes sense once you know about it.  Knowing which is which is the real difficulty."}], "tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": true, "score": 1, "last_activity_date": 1434639642, "creation_date": 1434639642, "answer_id": 30918979, "question_id": 30899487, "link": "https://stackoverflow.com/questions/30899487/vba-trapping-events-on-dynamically-created-textbox/30918979#30918979", "title": "VBA - Trapping events on dynamically created Textbox", "body": "<p>After some quick testing, I am able to reproduce your error if I declare <code>TBox as TextBox</code>.  I do not get an error if I declare <code>TBox as MSForms.TextBox</code>.  I would recommend declaring all your <code>TextBox</code> variables with the <code>MSForms</code> qualifier.</p>\n\n<p><strong>Test code</strong> is situated similar to yours.  I have a <code>MultiPage</code> with a <code>Frame</code> where I am adding a <code>Control</code>.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim obj As Object\n    Set obj = Me.MultiPage1.Pages(0).Controls(\"Frame1\")\n\n    Dim lbl As Control\n    Set lbl = obj.Add(\"Forms.TextBox.1\", \"txt\", True)\n\n    If TypeOf lbl Is TextBox Then\n        Debug.Print \"textbox found1\" 'does not execute\n    End If\n\n    If TypeOf lbl Is MSForms.TextBox Then\n        Debug.Print \"textbox found2\"\n\n        Dim txt1 As MSForms.TextBox\n        Set txt1 = lbl 'no error\n    End If\n\n    If TypeOf lbl Is MSForms.TextBox Then\n        Debug.Print \"textbox found3\"\n\n        Dim txt As TextBox\n        Set txt = lbl 'throws an error\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I am not sure why the qualifier is needed for <code>TextBox</code> and not <code>ComboBox</code>.  As you can see above, a good test for this is the <code>If TypeOf ... Is ... Then</code> to test which objects are which types.  I included the first block to show that <code>lbl</code> is not a \"bare\" <code>TextBox</code>, but, again, I have no idea why that is.  Maybe there is another type of <code>TextBox</code> out there that overrides the default declaration?</p>\n"}], "owner": {"reputation": 23, "user_id": 5021003, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155789480345145/picture?type=large", "display_name": "Robert", "link": "https://stackoverflow.com/users/5021003/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2235, "favorite_count": 0, "accepted_answer_id": 30918979, "answer_count": 1, "score": 2, "last_activity_date": 1434639642, "creation_date": 1434565543, "last_edit_date": 1434617117, "question_id": 30899487, "link": "https://stackoverflow.com/questions/30899487/vba-trapping-events-on-dynamically-created-textbox", "title": "VBA - Trapping events on dynamically created Textbox", "body": "<p>I am writing a VBA application in Excel. I have a Userform that dynamically builds itself based upon the data contained in one of the worksheets.\nAll of the code that creates the various comboboxes, textboxes and labels is working.\nI created a class module to trap OnChange events for the Comboboxes, and again this works as expected.\nNow I have a need to trap OnChange events for some of the textboxes, so I created a new class module modelled on that for the comboboxes to trap the events.</p>\n\n<pre><code>Public WithEvents tbx As MSForms.TextBox\n\nSub SetTextBox(ctl As MSForms.TextBox)\nSet tbx = ctl\nEnd Sub\n\nPublic Sub tbx_Change()\nDim LblName As String\n\nMsgBox \"You clicked on \" &amp; tbx.Name, vbOKOnly\n\nEnd Sub\n</code></pre>\n\n<p>The message box is just so that I can confirm it works before I go further.\nThe problem I'm getting is in the UserForm code module:</p>\n\n<pre><code>Dim TBox As TextBox\nDim tbx As c_TextBoxes\n\n'[...]\n\nSet TBox = lbl\nSet tbx = New c_TextBoxes\ntbx.SetTextBox lbl\npTextBoxes.Add tbx\n</code></pre>\n\n<p>This throws up a type mismatch error at <code>Set TBox=lbl</code>. It's the <strong>exact</strong> same code that works fine for the ComboBox, just with the variables given approriate names. I've stared at this for 2 hours.\nAnyone got any ideas? Thanks for any pointers.</p>\n\n<p>Edit - Here's the full userform module that I'm having trouble with:</p>\n\n<pre><code>Private Sub AddLines(FrameName As String, PageName As String)\nDim Counter As Integer, Column As Integer\nDim obj As Object\nDim CBox As ComboBox\nDim cbx As c_ComboBox\nDim TBox As TextBox\nDim tbx As c_TextBoxes\nDim lbl As Control\n\nSet obj = Me.MultiPage1.Pages(PageName).Controls(FrameName)\nIf pComboBoxes Is Nothing Then Set pComboBoxes = New Collection\nIf pTextBoxes Is Nothing Then Set pTextBoxes = New Collection\n\nFor Counter = LBound(Vehicles) To UBound(Vehicles)\n     For Column = 1 To 8\n     Select Case Column\n     Case 1\n         Set lbl = obj.Add(\"Forms.Label.1\", \"LblMachine\" &amp; FrameName &amp; Counter, True)\n    Case 2\n        Set lbl = obj.Add(\"Forms.Label.1\", \"LblFleetNo\" &amp; FrameName &amp; Counter, True)\n    Case 3\n        Set lbl = obj.Add(\"Forms.Label.1\", \"LblRate\" &amp; FrameName &amp; Counter, True)\n    Case 4\n        Set lbl = obj.Add(\"Forms.Label.1\", \"LblUnit\" &amp; FrameName &amp; Counter, True)\n    Case 5\n        Set lbl = obj.Add(\"Forms.ComboBox.1\", \"CBDriver\" &amp; FrameName &amp; Counter, True)\n    Case 6\n        Set lbl = obj.Add(\"Forms.Label.1\", \"LblDriverRate\" &amp; FrameName &amp; Counter, True)\n    Case 7\n        Set lbltbx = obj.Add(\"Forms.TextBox.1\", \"TBBookHours\" &amp; FrameName &amp; Counter, True)\n    Case 8\n        Set lbl = obj.Add(\"Forms.Label.1\", \"LblCost\" &amp; FrameName &amp; Counter, True)\n    End Select\n    With lbl\n        Select Case Column\n        Case 1\n            .Left = 1\n            .Width = 60\n            .Top = 10 + (Counter) * 20\n            .Caption = Vehicles(Counter).VType\n        Case 2\n            .Left = 65\n            .Width = 40\n            .Top = 10 + (Counter) * 20\n            .Caption = Vehicles(Counter).VFleetNo\n        Case 3\n            .Left = 119\n            .Width = 50\n            .Top = 10 + (Counter) * 20\n            .Caption = Vehicles(Counter).VRate\n        Case 4\n            .Left = 163\n            .Width = 30\n            .Top = 10 + (Counter) * 20\n            .Caption = Vehicles(Counter).VUnit\n        Case 5\n            .Left = 197\n            .Width = 130\n            .Top = 10 + (Counter) * 20\n            Set CBox = lbl 'WORKS OK\n            Call CBDriver_Fill(Counter, CBox)\n            Set cbx = New c_ComboBox\n            cbx.SetCombobox CBox\n            pComboBoxes.Add cbx\n        Case 6\n            .Left = 331\n            .Width = 30\n            .Top = 10 + (Counter) * 20\n        Case 7\n            .Left = 365\n            .Width = 30\n            .Top = 10 + (Counter) * 20\n            Set TBox = lbl 'Results in Type Mismatch\n            Set tbx = New c_TextBoxes\n            tbx.SetTextBox TBox\n            pTextBoxes.Add tbx\n        Case 8\n            .Left = 400\n            .Width = 30\n            .Top = 10 + (Counter) * 20\n        End Select\n    End With\n    Next\nNext\nobj.ScrollHeight = (Counter * 20) + 20\nobj.ScrollBars = 2\n\nEnd Sub\n</code></pre>\n\n<p>And here's the c_Combobox class module:</p>\n\n<pre><code>Public WithEvents cbx As MSForms.ComboBox\n\nSub SetCombobox(ctl As MSForms.ComboBox)\n    Set cbx = ctl\nEnd Sub\n\nPublic Sub cbx_Change()\nDim LblName As String\nDim LblDriverRate As Control\nDim i As Integer\n\n\n    'MsgBox \"You clicked on \" &amp; cbx.Name, vbOKOnly\n    LblName = \"LblDriverRate\" &amp; Right(cbx.Name, Len(cbx.Name) - 8)\n    'MsgBox \"This is \" &amp; LblName, vbOKOnly\n\n    'Set obj = Me.MultiPage1.Pages(PageName).Controls(FrameName)\n    Set LblDriverRate = UFBookMachines.Controls(LblName)\n    For i = LBound(Drivers) To UBound(Drivers)\n        If Drivers(i).Name = cbx.Value Then LblDriverRate.Caption = Drivers(i).Rate\n    Next\nEnd Sub\n</code></pre>\n\n<p>And finally, here's the c_TextBoxes class module:</p>\n\n<pre><code>Public WithEvents tbx As MSForms.TextBox\n\nSub SetTextBox(ctl As MSForms.TextBox)\n    Set tbx = ctl\nEnd Sub\n\nPublic Sub tbx_Change()\nDim LblName As String\n    'Does nothing useful yet, message box for testing\n    MsgBox \"You clicked on \" &amp; tbx.Name, vbOKOnly\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 283, "user_id": 4733852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GD1mn.jpg?s=128&g=1", "display_name": "USFBS", "link": "https://stackoverflow.com/users/4733852/usfbs"}, "edited": false, "score": 1, "creation_date": 1434565648, "post_id": 30899362, "comment_id": 49837947, "body": "If you&#39;re looking for information to the left of the reference, you should use Match-Index instead of VLookup. It&#39;s quicker and has the ability to look to the left or right of the information you reference. (<a href=\"http://fiveminutelessons.com/learn-microsoft-excel/how-use-index-match-instead-vlookup\" rel=\"nofollow noreferrer\">Link to more info</a>)"}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "reply_to_user": {"reputation": 283, "user_id": 4733852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GD1mn.jpg?s=128&g=1", "display_name": "USFBS", "link": "https://stackoverflow.com/users/4733852/usfbs"}, "edited": false, "score": 0, "creation_date": 1434653701, "post_id": 30899362, "comment_id": 49883750, "body": "@usfbs you should add that as an actual answer (provided you show a small example or show the OP how to do it with his VBA code)"}], "answers": [{"tags": [], "owner": {"reputation": 283, "user_id": 4733852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GD1mn.jpg?s=128&g=1", "display_name": "USFBS", "link": "https://stackoverflow.com/users/4733852/usfbs"}, "is_accepted": false, "score": 1, "last_activity_date": 1434656416, "creation_date": 1434656416, "answer_id": 30924310, "question_id": 30899362, "link": "https://stackoverflow.com/questions/30899362/vba-offset-within-vlookup/30924310#30924310", "title": "VBA Offset within Vlookup?", "body": "<p>If you were looking to find information to the left of the reference point in excel, using a <code>Match-Index</code> lookup would be they way for you to go. Not only is this method able to look to the left or right of your reference, but it is also a faster process.</p>\n\n<p>VLookup looks like this:</p>\n\n<pre><code>=VLookup([Value to find],[Where to find the value],[Column to return],[range lookup])\n</code></pre>\n\n<p>Where as using Match-Index looks like this:</p>\n\n<pre><code>=Index([Range to look in for return],Match([Value to find],[Range to look in for value],[Exact match or partial]))\n</code></pre>\n\n<p>So, while a bit more complicated to write, using the second method really increases the flexibility of what you can look up and where that information is. </p>\n\n<p>Now, if you were to apply this method to your code, it should look something like this:</p>\n\n<pre><code>wCell.FormulaR1C1 = \"=Index([Range of Value to Find],Match(RC[1],'[\" &amp; filename &amp; \"]\" &amp; ws.Name &amp; \"'!R8C4:R\" &amp; lastrow &amp; \"C5, [0 for exact match]))\"\n</code></pre>\n\n<p>(Just change out the bits I added in brackets for the information that they need, and that should address that problem your are running into)</p>\n"}], "owner": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 532, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1434704553, "creation_date": 1434565210, "last_edit_date": 1434704553, "question_id": 30899362, "link": "https://stackoverflow.com/questions/30899362/vba-offset-within-vlookup", "title": "VBA Offset within Vlookup?", "body": "<p>I'm trying to get a Vlookup for a row which is just left of the Lookup_value.  I can't do a Table_array of \"-1\" (or -2) so I'm wondering if I can do an Offset(0, -1) within that line of code.</p>\n\n<p>The line in question:</p>\n\n<pre><code>wCell.FormulaR1C1 = \"=VLOOKUP(RC[1],'[\" &amp; filename &amp; \"]\" &amp; ws.Name &amp; \"'!R8C4:R\" &amp; lastrow &amp; \"C5,-1,FALSE)\"\n</code></pre>\n\n<p>The entire code block:</p>\n\n<pre><code>Range(\"$C$8:$C$\" &amp; lastrow).Select\n    For Each wCell In Range(\"$C$8:$C$\" &amp; lastrow)\n        wCell.Select\n        If wCell.FormulaR1C1 = \"\" Then\n            wCell.FormulaR1C1 = \"=VLOOKUP(RC[1],'[\" &amp; filename &amp; \"]\" &amp; ws.Name &amp; \"'!R8C4:R\" &amp; lastrow &amp; \"C5,-1,FALSE)\"\n        End If\n    Next\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5020917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7ca25cb8ee3826fd8860aee35a1a3d4?s=128&d=identicon&r=PG&f=1", "display_name": "Crina", "link": "https://stackoverflow.com/users/5020917/crina"}, "edited": false, "score": 0, "creation_date": 1434572339, "post_id": 30900536, "comment_id": 49842123, "body": "Thank you so much for answering me so quickly but, honestly, I have no idea what I must do with the codes you give me and where between my codes to insert it. I guess that saying that I&#39;m new with macro is not quite accurate. I&#39;m more like I just found out that exists and have an idea about what can do."}, {"owner": {"reputation": 274, "user_id": 4872561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9ed7fc4936f96dd6edfcfdc1d05c24?s=128&d=identicon&r=PG&f=1", "display_name": "Abe", "link": "https://stackoverflow.com/users/4872561/abe"}, "reply_to_user": {"reputation": 1, "user_id": 5020917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7ca25cb8ee3826fd8860aee35a1a3d4?s=128&d=identicon&r=PG&f=1", "display_name": "Crina", "link": "https://stackoverflow.com/users/5020917/crina"}, "edited": false, "score": 0, "creation_date": 1434573028, "post_id": 30900536, "comment_id": 49842510, "body": "Try this: paste the two first lines of my code example before all code you have on your module, paste the two <code>Function</code> I have coded at the end of your module, and forget about the <code>Sub</code>. Change your code <code>picname = Cells(lThisRow, 2)</code> to <code>picname = Cells(lThisRow, 2) &amp; &quot;.jpg&quot;</code> and where you have <code>present = Dir(...)</code>, change to <code>present = Find(picname)</code>. Finally, change <code>ActiveSheet.Pictures.Insert(...)</code> to <code>ActiveSheet.Pictures.Insert(present)</code>. This might do the trick."}, {"owner": {"reputation": 1, "user_id": 5020917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7ca25cb8ee3826fd8860aee35a1a3d4?s=128&d=identicon&r=PG&f=1", "display_name": "Crina", "link": "https://stackoverflow.com/users/5020917/crina"}, "edited": false, "score": 0, "creation_date": 1434574871, "post_id": 30900536, "comment_id": 49843522, "body": "Yes. This whay is working just that it takes some time. Thank you so so much. You&#39;ve made my day :)"}, {"owner": {"reputation": 274, "user_id": 4872561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9ed7fc4936f96dd6edfcfdc1d05c24?s=128&d=identicon&r=PG&f=1", "display_name": "Abe", "link": "https://stackoverflow.com/users/4872561/abe"}, "reply_to_user": {"reputation": 1, "user_id": 5020917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7ca25cb8ee3826fd8860aee35a1a3d4?s=128&d=identicon&r=PG&f=1", "display_name": "Crina", "link": "https://stackoverflow.com/users/5020917/crina"}, "edited": false, "score": 0, "creation_date": 1434575417, "post_id": 30900536, "comment_id": 49843798, "body": "Np! Yea, since it is accessing some system features, you can expect it to take some time, also, the more subfolders you have, more time you will need to check them all. If this answer fits your need, please mark it as accepted ;)."}], "tags": [], "owner": {"reputation": 274, "user_id": 4872561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9ed7fc4936f96dd6edfcfdc1d05c24?s=128&d=identicon&r=PG&f=1", "display_name": "Abe", "link": "https://stackoverflow.com/users/4872561/abe"}, "is_accepted": false, "score": 0, "last_activity_date": 1434568830, "creation_date": 1434568830, "answer_id": 30900536, "question_id": 30899214, "link": "https://stackoverflow.com/questions/30899214/macro-to-search-for-pictures-in-subfolders/30900536#30900536", "title": "Macro to search for pictures in subfolders", "body": "<p>Please, check the example below, it iterates through subfolders and search for your file, you just have to fit it in your code:</p>\n\n<pre><code>Dim FileSystem As Object\nConst mainFolder As String = \"Z:\\mfs\\PictureLibrary\\Codello A14 Transfer\\\"\n\nSub YourProblem()\n\n    Dim filePath As String\n    filePath = Find(\"pictureName.jpg\")\n    MsgBox filePath\n\nEnd Sub\n\nFunction Find(picName As String) As String\n\n    Set FileSystem = CreateObject(\"Scripting.FileSystemObject\")\n    Find = FindPicture(FileSystem.GetFolder(mainFolder), picName)\n\nEnd Function\n\nFunction FindPicture(innerFolder, picName As String) As String\n\n    Dim pictureFound As String\n    pictureFound = Dir(innerFolder &amp; \"\\\" &amp; picName)\n\n    If Len(Trim(pictureFound)) &gt; 0 Then\n        FindPicture = innerFolder &amp; \"\\\" &amp; pictureFound\n        Exit Function\n    Else\n        Dim subFolder\n        For Each subFolder In innerFolder.SubFolders\n\n            pictureFound = FindPicture(subFolder, picName)\n            If Len(Trim(pictureFound)) &gt; 0 Then\n                FindPicture = pictureFound\n                Exit Function\n            End If\n        Next\n    End If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5020917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7ca25cb8ee3826fd8860aee35a1a3d4?s=128&d=identicon&r=PG&f=1", "display_name": "Crina", "link": "https://stackoverflow.com/users/5020917/crina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1662, "favorite_count": 0, "closed_date": 1434630856, "answer_count": 1, "score": 0, "last_activity_date": 1489750603, "creation_date": 1434564758, "last_edit_date": 1489750603, "question_id": 30899214, "link": "https://stackoverflow.com/questions/30899214/macro-to-search-for-pictures-in-subfolders", "closed_reason": "Duplicate", "title": "Macro to search for pictures in subfolders", "body": "<p>I will realy appreciate your help on this issue. I'm quite new with macro.</p>\n\n<p>The macro that I'm using is inserting a picture in Excel column A cells by taking the file name reference from the column B cells.</p>\n\n<p>I have the following macro that works just fine if I know the subfolder were to search for the picture that I need but I don't know how to do it to search in all subfolders of <code>Z:\\mfs\\PictureLibrary</code>.</p>\n\n<p>Here is the macro :</p>\n\n<pre><code>   Sub Picture()\n   Dim picname As String\n\n   Dim pasteAt As Integer\n   Dim lThisRow As Long\n\nlThisRow = 2\n\nDo While (Cells(lThisRow, 2) &lt;&gt; \"\")\n\n\n    pasteAt = lThisRow\n    Cells(pasteAt, 1).Select 'This is where picture will be inserted\n\n\n    picname = Cells(lThisRow, 2) 'This is the picture name\n\n    present = Dir(\"Z:\\mfs\\PictureLibrary\\Codello A14 Transfer\\\" &amp; picname &amp; \".jpg\")\n\n    If present &lt;&gt; \"\" Then\n\n        ActiveSheet.Pictures.Insert(\"Z:\\mfs\\PictureLibrary\\Codello A14 Transfer\\\" &amp; picname &amp; \".jpg\").Select 'Path to where pictures are stored\n        '''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        ' This resizes the picture\n        '''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        With Selection\n        '.Left = Range(\"A2\").Left\n        '.Top = Range(\"A2\").Top\n        .Left = Cells(pasteAt, 1).Left\n        .Top = Cells(pasteAt, 1).Top\n\n        .ShapeRange.LockAspectRatio = msoFalse\n        .ShapeRange.Height = 55#\n        .ShapeRange.Width = 40#\n        .ShapeRange.Rotation = 0#\n        End With\n\n\n\n    Else\n        Cells(pasteAt, 1) = \"\"\n    End If\n\n       lThisRow = lThisRow + 1\nLoop\n\nRange(\"A10\").Select\nApplication.ScreenUpdating = True\n\nExit Sub\n\nErrNoPhoto:\nMsgBox \"Unable to Find Photo\" 'Shows message box if picture not found\nExit Sub\nRange(\"B20\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1434563573, "post_id": 30898699, "comment_id": 49836751, "body": "How are you calling this function? Is this a button? Is the recipient in <code>A4</code> always going to be in that cell or will the cell your referring change? As you are not returning anything back to your calling procedure would it not make more sense to make this a subroutine rather than a function?"}, {"owner": {"reputation": 3, "user_id": 5020852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9c6fc96ce68e4e8acd201e0183f6660?s=128&d=identicon&r=PG&f=1", "display_name": "tgaraffa", "link": "https://stackoverflow.com/users/5020852/tgaraffa"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1434567754, "post_id": 30898699, "comment_id": 49839266, "body": "Right now I am calling it with a formula (=AddToTasks(A1,A2,A3,A4)), eventually it will likely be a button.  The cell I will be referencing will change though."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5020852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9c6fc96ce68e4e8acd201e0183f6660?s=128&d=identicon&r=PG&f=1", "display_name": "tgaraffa", "link": "https://stackoverflow.com/users/5020852/tgaraffa"}, "edited": false, "score": 0, "creation_date": 1434568195, "post_id": 30899913, "comment_id": 49839552, "body": "Unfortunately this did not solve my issue, as it is still giving me the same #VALUE! error.  Any other thoughts?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 3, "user_id": 5020852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9c6fc96ce68e4e8acd201e0183f6660?s=128&d=identicon&r=PG&f=1", "display_name": "tgaraffa", "link": "https://stackoverflow.com/users/5020852/tgaraffa"}, "edited": false, "score": 0, "creation_date": 1434569692, "post_id": 30899913, "comment_id": 49840464, "body": "@tgaraffa have changed <code>sheet name</code>?"}, {"owner": {"reputation": 3, "user_id": 5020852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9c6fc96ce68e4e8acd201e0183f6660?s=128&d=identicon&r=PG&f=1", "display_name": "tgaraffa", "link": "https://stackoverflow.com/users/5020852/tgaraffa"}, "edited": false, "score": 0, "creation_date": 1434571387, "post_id": 30899913, "comment_id": 49841608, "body": "Hi @Omar   I did indeed. I am using this all on a dummy sheet for right now, so I changed it to &quot;Sheet1&quot; and still no luck."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 3, "user_id": 5020852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9c6fc96ce68e4e8acd201e0183f6660?s=128&d=identicon&r=PG&f=1", "display_name": "tgaraffa", "link": "https://stackoverflow.com/users/5020852/tgaraffa"}, "edited": false, "score": 0, "creation_date": 1434572426, "post_id": 30899913, "comment_id": 49842168, "body": "how about change to <code>.CC = strRecipient</code>"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1434572389, "last_edit_date": 1434572389, "creation_date": 1434566855, "answer_id": 30899913, "question_id": 30898699, "link": "https://stackoverflow.com/questions/30898699/excel-vba-recipient-add-based-relevant-cell/30899913#30899913", "title": "Excel VBA Recipient Add based relevant cell", "body": "<p>add the following before <code>With objTask</code></p>\n\n<pre><code>strRecipient = Sheets(\"sheet name here\").Range(\"A4\").Value\n</code></pre>\n\n<p><br></p>\n\n<pre><code>strRecipient = Sheets(\"sheet name here\").Range(\"A4\").Value\nWith objTask\n    .startdate = dteDate\n    .CC = strRecipient\n    .Subject = strText &amp; \", due on: \" &amp; strDate\n    .ReminderSet = True\n    .Save\n    .Assign\n    .Send\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5020852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9c6fc96ce68e4e8acd201e0183f6660?s=128&d=identicon&r=PG&f=1", "display_name": "tgaraffa", "link": "https://stackoverflow.com/users/5020852/tgaraffa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 418, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1434572389, "creation_date": 1434563024, "question_id": 30898699, "link": "https://stackoverflow.com/questions/30898699/excel-vba-recipient-add-based-relevant-cell", "title": "Excel VBA Recipient Add based relevant cell", "body": "<p>I took this code (<a href=\"http://www.jpsoftwaretech.com/using-excel-vba-to-set-up-task-reminders-in-outlook/\" rel=\"nofollow\">http://www.jpsoftwaretech.com/using-excel-vba-to-set-up-task-reminders-in-outlook/</a>) and added the strRecipient field myself. I am a total VBA noob and quite obviously, it doesn't work.  Can anyone offer a suggestion as to how I can get a Recipient section added that automatically feeds off of cell A4 for example?</p>\n\n<p>Thanks</p>\n\n<pre><code>Option Explicit\n\nDim bWeStartedOutlook As Boolean\n\nFunction AddToTasks(strDate As String, strText As String, DaysOut As Integer, strRecipient As String) As Boolean\n    ' Adds a task reminder to Outlook Tasks a specific number of days before the date specified\n    ' Returns TRUE if successful\n    ' Will not trigger OMG because no protected properties are accessed\n    ' by Jimmy Pena, http://www.jpsoftwaretech.com, 10/30/2008\n    '\n    ' Usage:\n    ' =AddToTasks(\"12/31/2008\", \"Something to remember\", 30)\n    ' or:\n    ' =AddToTasks(A1, A2, A3)\n    ' where A1 contains valid date, A2 contains task information, A3 contains number of days before A1 date to trigger task reminder\n    '\n    ' can also be used in VBA :\n    'If AddToTasks(\"12/31/2008\", \"Christmas shopping\", 30) Then\n    '  MsgBox \"ok!\"\n    'End If\n\nDim intDaysBack As Integer\nDim dteDate As Date\nDim olApp As Object ' Outlook.Application\nDim objTask As Object ' Outlook.TaskItem\n\n' make sure all fields were filled in\nIf (Not IsDate(strDate)) Or (strText = \"\") Or (DaysOut &lt;= 0) Or (strRecipient = \"\") Then\n  AddToTasks = False\n  GoTo ExitProc\nEnd If\n\n' We want the task reminder a certain number of days BEFORE the due date\n' ex: if DaysOut = 120, then we want the due date to be -120 before the date specified\n' we need to pass -120 to the NextBusinessDay function, so to go from 120 to -120,\n' we subtract double the number (240) from the number provided (120).\n' 120 - (120 * 2); 120 - 240 = -120\n\nintDaysBack = DaysOut - (DaysOut * 2)\n\ndteDate = CDate(strDate) + intDaysBack\n\nOn Error Resume Next\n  Set olApp = GetOutlookApp\nOn Error GoTo 0\n\nIf Not olApp Is Nothing Then\n  Set objTask = olApp.CreateItem(3)  ' task item\n\n    With objTask\n        .StartDate = dteDate\n        .Subject = strText &amp; \", due on: \" &amp; strDate\n        .ReminderSet = True\n        .Recipients.Add = strRecipient\n        .Save\n        .Assign\n        .Send\n    End With\n\nElse\n  AddToTasks = False\n  GoTo ExitProc\nEnd If\n\n' if we got this far, it must have worked\nAddToTasks = True\n\nExitProc:\nIf bWeStartedOutlook Then\n  olApp.Quit\nEnd If\nSet olApp = Nothing\nSet objTask = Nothing\nEnd Function\n\nFunction GetOutlookApp() As Object\n\nOn Error Resume Next\n  Set GetOutlookApp = GetObject(, \"Outlook.Application\")\n  If Err.Number &lt;&gt; 0 Then\n    Set GetOutlookApp = CreateObject(\"Outlook.Application\")\n    bWeStartedOutlook = True\n  End If\nOn Error GoTo 0\n\nEnd Function\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 3416, "user_id": 1439998, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92057b15ed204d9be8fc9f26883f0370?s=128&d=identicon&r=PG", "display_name": "Martin Noreke", "link": "https://stackoverflow.com/users/1439998/martin-noreke"}, "edited": false, "score": 2, "creation_date": 1434562412, "post_id": 30898477, "comment_id": 49836013, "body": "What does the table structure look like? What rules do you need for the insert/update query?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 2, "creation_date": 1434562494, "post_id": 30898477, "comment_id": 49836072, "body": "Is there a field or combination of fields which uniquely identifies each row ... both in the table and sheet?"}, {"owner": {"reputation": 580, "user_id": 4092675, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1463524265/picture?type=large", "display_name": "Chris Chevalier", "link": "https://stackoverflow.com/users/4092675/chris-chevalier"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1434563240, "post_id": 30898477, "comment_id": 49836570, "body": "@hansUp There is an ID that serves as a unique Identifier except there are many with null values.."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1434563358, "post_id": 30898477, "comment_id": 49836646, "body": "Many Null <code>ID</code> where ... in the table; the sheet; both?  What should happen with a row which has Null <code>ID</code>?  Is it a new record?  An update of an existing record?  How can you know?"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 5021183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e31493b7c890f9d0cba96e566237d781?s=128&d=identicon&r=PG&f=1", "display_name": "dmoody007", "link": "https://stackoverflow.com/users/5021183/dmoody007"}, "is_accepted": true, "score": 2, "last_activity_date": 1434571058, "creation_date": 1434571058, "answer_id": 30901223, "question_id": 30898477, "link": "https://stackoverflow.com/questions/30898477/in-sql-how-do-i-update-a-table-with-a-similar-table/30901223#30901223", "title": "In SQL how do I update a table with a similar table?", "body": "<p>Based on what I have read so far, I think I can offer some suggestions:</p>\n\n<p>It appears you have control of the MS Access.  I would suggest adding a field to your data table called \"source\".  Modify your form in the access database to store something like \"m\" for manual entry in the source field.  When you import the excel, store an \"e\" for excel in the field.</p>\n\n<p>You would need to do a one time scrub of the data to mark existing records as manual entries or excel entries.  There are a couple of ways you can do it through automation/queries that I can explain in detail if you want.</p>\n\n<p>Once past these steps, your excel process is fairly simple.  You can delete all records with source = \"e\" and then do a full excel import.  Manual records would remain unchanged.</p>\n\n<p>This concept will allow you to add new sources and codes and allow you to handle each differently if needed.  You just need to spend some time cleaning up your old data.  I think you will find it worth it in the end.</p>\n\n<p>Good Luck.</p>\n"}], "owner": {"reputation": 580, "user_id": 4092675, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1463524265/picture?type=large", "display_name": "Chris Chevalier", "link": "https://stackoverflow.com/users/4092675/chris-chevalier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 30901223, "answer_count": 1, "score": 2, "last_activity_date": 1434571058, "creation_date": 1434562320, "question_id": 30898477, "link": "https://stackoverflow.com/questions/30898477/in-sql-how-do-i-update-a-table-with-a-similar-table", "title": "In SQL how do I update a table with a similar table?", "body": "<p>In my current Database I have a table whose data is manually entered or comes in an excel sheet every week. Before we had the \"manual entry option\", the table would be dropped and replaced by the excel version. \nNow because there is data that only exists in the original table this can not be done.\nI'm trying to find a way to update the original table with changes and additions from the (excel) table while preserving all rows not in the new sheet.</p>\n\n<p>I've been attempting to simply use an insert query and an update query /but/ I can't find a way to detect changes in a record.</p>\n\n<p>Any suggestions? I can provide the current sql if you'd find that helpful.</p>\n"}, {"tags": ["vba", "excel", "filter", "range"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1434562853, "post_id": 30898459, "comment_id": 49836309, "body": "You cannot use the syntax <code>newrange(i, 3).Value</code> to access a value in a multi-area range."}, {"owner": {"reputation": 70, "user_id": 5020794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/344c2b19b6f3faf0e5cbfd685a75ae91?s=128&d=identicon&r=PG&f=1", "display_name": "Mikey", "link": "https://stackoverflow.com/users/5020794/mikey"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1434563047, "post_id": 30898459, "comment_id": 49836456, "body": "It still runs even with that syntax. I get the same value even when I put in Cells(i, 3).Value instead of the newrange."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1434563147, "post_id": 30898459, "comment_id": 49836509, "body": "It will run (ie. it does not throw an error): it just won&#39;t give you the correct answer..."}, {"owner": {"reputation": 70, "user_id": 5020794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/344c2b19b6f3faf0e5cbfd685a75ae91?s=128&d=identicon&r=PG&f=1", "display_name": "Mikey", "link": "https://stackoverflow.com/users/5020794/mikey"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1434563443, "post_id": 30898459, "comment_id": 49836688, "body": "Oh, ok. So I revised it for to say &quot;Cells&quot; instead of &quot;newrange&quot;. Is it not possible to check the values in the column after the filter? Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 70, "user_id": 5020794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/344c2b19b6f3faf0e5cbfd685a75ae91?s=128&d=identicon&r=PG&f=1", "display_name": "Mikey", "link": "https://stackoverflow.com/users/5020794/mikey"}, "edited": false, "score": 0, "creation_date": 1434564336, "post_id": 30898915, "comment_id": 49837195, "body": "Thanks Tim! Worked like a charm!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 5, "last_activity_date": 1434563825, "creation_date": 1434563825, "answer_id": 30898915, "question_id": 30898459, "link": "https://stackoverflow.com/questions/30898459/excel-vba-range-after-filtering-xlcelltypevisible/30898915#30898915", "title": "Excel VBA range after filtering xlCellTypeVisible", "body": "<p>Something like this should work:</p>\n\n<pre><code>Dim newrange As Range, rw as range\n\nSet newrange = ActiveSheet.AutoFilter.Range.SpecialCells(xlCellTypeVisible)\n\nDim intValueToFind As Integer\nintValueToFind = 2\nFor Each rw in newrange.Rows\n    If rw.cells(3).Value = intValueToFind Then\n        MsgBox (\"Found value on row \" &amp; rw.cells(1).Row)\n        Exit Sub\n    End If\nNext rw\n</code></pre>\n"}], "owner": {"reputation": 70, "user_id": 5020794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/344c2b19b6f3faf0e5cbfd685a75ae91?s=128&d=identicon&r=PG&f=1", "display_name": "Mikey", "link": "https://stackoverflow.com/users/5020794/mikey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15874, "favorite_count": 1, "accepted_answer_id": 30898915, "answer_count": 1, "score": 3, "last_activity_date": 1434563825, "creation_date": 1434562273, "question_id": 30898459, "link": "https://stackoverflow.com/questions/30898459/excel-vba-range-after-filtering-xlcelltypevisible", "title": "Excel VBA range after filtering xlCellTypeVisible", "body": "<p>What I want to accomplish: Open a workbook from a specific address, Filter the first column for value equal to 36 or 541 (I got this first part working), then check column 3 to see if a value of 2 exists and if it exists then filter out everything except for value 2 in column 3; if value 2 does not exist in column 3 then skip.</p>\n\n<p>I tried using SpecialCells(xlCellTypeVisible) to name the new range but I must be using it incorrectly because it is giving me a value of 2 that exists only in the old range where the data has not been filtered yet.</p>\n\n<p>Thanks for your time!</p>\n\n<pre><code>Sub filters()\n\nDim wb As Workbook\nDim nwb As Workbook\n\nSet wb = ThisWorkbook\n\nSet nwb = Workbooks.Open(\"ADDRESS.FILE.xlsx\")\n\nWith ActiveSheet\n\n.AutoFilterMode = False\n.Range(\"$A$1:$AD$5000\").AutoFilter Field:=1, Criteria1:=\"=36\", Operator:=xlOr, Criteria2:=\"=541\"\n'.Range(\"$A$1:$AD$5000\").AutoFilter Field:=3, Criteria1:=\"2\"\n\nEnd With\n\nDim newrange As Range\n\nSet newrange = ActiveSheet.AutoFilter.Range.SpecialCells(xlCellTypeVisible)\n\nDim i As Integer, intValueToFind As Integer\nintValueToFind = 2\nFor i = 1 To 5000    ' Revise the 5000 to include all of your values\n    If newrange(i, 3).Value = intValueToFind Then\n        MsgBox (\"Found value on row \" &amp; i)\n        Exit Sub\n    End If\nNext i\n\n' This MsgBox will only show if the loop completes with no success\nMsgBox (\"Value not found in the range!\")\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "dictionary", "key", "vba"], "answers": [{"comments": [{"owner": {"reputation": 981, "user_id": 2227222, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d80812002213736d9576158000e84d98?s=128&d=identicon&r=PG", "display_name": "Hans", "link": "https://stackoverflow.com/users/2227222/hans"}, "edited": false, "score": 0, "creation_date": 1434563724, "post_id": 30898551, "comment_id": 49836843, "body": "I tried your sample. It works. I just added my original code in the question. Would you please take a look at the way I declare the dictionary? Is it valid?"}, {"owner": {"reputation": 981, "user_id": 2227222, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d80812002213736d9576158000e84d98?s=128&d=identicon&r=PG", "display_name": "Hans", "link": "https://stackoverflow.com/users/2227222/hans"}, "edited": false, "score": 0, "creation_date": 1434564276, "post_id": 30898551, "comment_id": 49837152, "body": "Thank you, @Tim Williams. That is strange, it did not work before... I added a related second question, concerning the data type of the value of a dictionary. Would you mind taking a look at that question?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 981, "user_id": 2227222, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d80812002213736d9576158000e84d98?s=128&d=identicon&r=PG", "display_name": "Hans", "link": "https://stackoverflow.com/users/2227222/hans"}, "edited": false, "score": 0, "creation_date": 1434564711, "post_id": 30898551, "comment_id": 49837432, "body": "Use a Class instead of a Type."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1434562580, "creation_date": 1434562580, "answer_id": 30898551, "question_id": 30897876, "link": "https://stackoverflow.com/questions/30897876/vba-dictionary-data-type/30898551#30898551", "title": "VBA dictionary data type", "body": "<p>No problem here:</p>\n\n<pre><code>Sub Tester()\n\n    Dim d, k\n    Set d = CreateObject(\"scripting.dictionary\")\n    d.Add 1, 1\n    d.Add \"a\", 2\n    d.Add #1/2/1978#, 3\n    d.Add CDbl(66), 4\n    d.Add CSng(99), 5\n    d.Add True, 6\n\n    For Each k In d.keys\n        Debug.Print TypeName(k), k, d(k)\n    Next k\n\nEnd Sub\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Integer        1             1 \nString        a              2 \nDate          1/2/1978       3 \nDouble         66            4 \nSingle         99            5 \nBoolean       True           6 \n</code></pre>\n\n<p>If there's specific code you're having a problem with, the add that to your question. </p>\n"}], "owner": {"reputation": 981, "user_id": 2227222, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d80812002213736d9576158000e84d98?s=128&d=identicon&r=PG", "display_name": "Hans", "link": "https://stackoverflow.com/users/2227222/hans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1666, "favorite_count": 0, "accepted_answer_id": 30898551, "answer_count": 1, "score": 0, "last_activity_date": 1434564113, "creation_date": 1434560386, "last_edit_date": 1531164843, "question_id": 30897876, "link": "https://stackoverflow.com/questions/30897876/vba-dictionary-data-type", "title": "VBA dictionary data type", "body": "<p>Many sources, e.g. <a href=\"https://support.microsoft.com/en-us/kb/187234\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/kb/187234</a>, claim the key of a dictionary can be of many data types beyond string. However, when I tried integers and dates as keys, it fails. Can someone explain?</p>\n\n<p>I tried the answer of @Tim Williams below, it works. What I had before was</p>\n\n<pre><code>Private Sub trial()\nDim dict As New Dictionary\n\ndt = 1\n'vols.marketDate = Date\ndict.Add dt, 4 'vols\nc = dict(dt)\nEnd Sub\n</code></pre>\n\n<p>Does my way of defining a dictionary make a difference compared to that of @Tim Williams?</p>\n\n<hr>\n\n<p>The second part of my question has to do with the value of a dictionary. I ran the following VBA code, attempting to use a user defined structure as the value of a diction, and encountered the error message:\n<img src=\"https://i.stack.imgur.com/VJTf8.png\" alt=\"enter image description here\"></p>\n\n<pre><code>Public Type volSurface\n    marketDate As Date\nEnd Type\n\n\nPrivate Sub trial()\nDim dict As New Dictionary, vols As volSurface\n\ndt = 1\nvol.marketDate = Date\ndict.Add dt, vols\nc = dict(dt)\nEnd Sub\n</code></pre>\n\n<p>Does this mean I can not use a structure as a value in a dictionary or there is something else I did wrong? If it is the latter case, how can I remedy it?</p>\n"}, {"tags": ["vba", "excel", "sorting"], "comments": [{"owner": {"reputation": 91, "user_id": 4966093, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/92RpQ.png?s=128&g=1", "display_name": "proxy156", "link": "https://stackoverflow.com/users/4966093/proxy156"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1434559611, "post_id": 30897315, "comment_id": 49834335, "body": "That is an interesting idea, I didn&#39;t know that was possible.  Could you go into greater details in an answer? Is it possible, with this method you have in mind, to specify an order of priority? This is not absolutely necessary, but would be ideal if possible."}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1434561918, "post_id": 30897315, "comment_id": 49835749, "body": "I think it might get too complicated trying to retrieve RGB - sorry. Removed my comment."}], "answers": [{"tags": [], "owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "is_accepted": false, "score": 0, "last_activity_date": 1434564108, "last_edit_date": 1434564108, "creation_date": 1434563724, "answer_id": 30898890, "question_id": 30897315, "link": "https://stackoverflow.com/questions/30897315/inconsistent-sorting-by-row-color/30898890#30898890", "title": "Inconsistent sorting by row color", "body": "<p>Essentially, I'm saying \"here's an answer to a question you didn't ask\" because I don't know <em>why</em> excel is doing that, but since I brought it up in a comment, I'll post it. I don't imagine it's a <strong>good</strong> way of doing this.</p>\n\n<p>Read the unique colors into a dictionary and convert them to an array of RGB</p>\n\n<p>Then I guess add the filter for each <code>sortfield</code> - but that would be ridiculous as I imagine you have a color scheme you want. So instead, maybe take the order of your colors and compare each to see if it's in the array, and if so, do the sort. Otherwise, skip the color?</p>\n\n<pre><code>Sub test()\nDim col As Variant\n\nDim d As Object\nSet d = CreateObject(\"Scripting.Dictionary\")\n\nFor Each c In Range(\"FU3:FU5002\")\n    col = (c.Interior.Color)\n    d(col) = 1\nNext\nDim v As Variant\nDim j As Integer\nj = d.Count\nDim colores() As String\nReDim colores(j)\ni = 1\nFor Each v In d.keys\n    colores(i) = Convert_Dec2RGB(v)\n    i = i + 1\nNext\n\n'With ActiveSheet.Sort\n    'For k = 1 To j\n    '.SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = colores(k)\n    'Next\n'End With\n\nEnd Sub\n\nPrivate Function Convert_Dec2RGB(ByVal myDECIMAL As Long) As String\n'https://socko.wordpress.com/2008/10/07/convert-decimal-to-rgb-color-value/\n  Dim myRED As Long\n  Dim myGREEN As Long\n  Dim myBLUE As Long\n\n  myRED = myDECIMAL And &amp;HFF\n  myGREEN = (myDECIMAL And &amp;HFF00&amp;) \\ 256\n  myBLUE = myDECIMAL \\ 65536\n\n  Convert_Dec2RGB = \"RGB(\" &amp; CStr(myRED) &amp; \",\" &amp; CStr(myGREEN) &amp; \",\" &amp; CStr(myBLUE) &amp; \")\"\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 5012223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ba4f3b52431720a5ab72f09e37ed6d?s=128&d=identicon&r=PG&f=1", "display_name": "Prabu krishna", "link": "https://stackoverflow.com/users/5012223/prabu-krishna"}, "is_accepted": false, "score": 0, "last_activity_date": 1434565073, "last_edit_date": 1434565073, "creation_date": 1434564683, "answer_id": 30899187, "question_id": 30897315, "link": "https://stackoverflow.com/questions/30897315/inconsistent-sorting-by-row-color/30899187#30899187", "title": "Inconsistent sorting by row color", "body": "<p>Try with the below code.\nYou have to find all the color codes you want to sort and add that color code for soting inorder which you want.</p>\n\n<p>Sub test()</p>\n\n<pre><code>Dim dis As Object\n\nSet dis = CreateObject(\"Scripting.Dictionary\")\n\nP = 1\nRcnt = Range(\"AU65000\").End(xlUp).Row\n\nFor i = 3 To Rcnt\n    On Error Resume Next\n    dis.Add Range(\"A\" &amp; i).Interior.Color, P\n    P = P + 1\nNext i\n\n'sorting\nActiveWorkbook.Worksheets(\"Sheet2\").Sort.SortFields.Clear\n'red\nIf dis.exists(255) = True Then ActiveWorkbook.Worksheets(\"Sheet2\").Sort.SortFields.Add(Range(\"A2:A10\"), _\n    xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = 255\n'yellow\nIf dis.exists(65535) = True Then ActiveWorkbook.Worksheets(\"Sheet2\").Sort.SortFields.Add(Range(\"A2:A10\"), _\n    xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = 65535\n'blue\nIf dis.exists(12874308) = True Then ActiveWorkbook.Worksheets(\"Sheet2\").Sort.SortFields.Add(Range(\"A2:A10\"), _\n    xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = 12874308\n'orange\nIf dis.exists(3243501) = True Then ActiveWorkbook.Worksheets(\"Sheet2\").Sort.SortFields.Add(Range(\"A2:A10\"), _\n    xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = 3243501\n'green\nIf dis.exists(5287936) = True Then ActiveWorkbook.Worksheets(\"Sheet2\").Sort.SortFields.Add(Range(\"A2:A10\"), _\n    xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = 5287936\nWith ActiveWorkbook.Worksheets(\"Sheet2\").Sort\n    .SetRange Range(\"A2:A10\")\n    .Header = xlGuess\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nRange(\"A1\").Select\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 91, "user_id": 4966093, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/92RpQ.png?s=128&g=1", "display_name": "proxy156", "link": "https://stackoverflow.com/users/4966093/proxy156"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1434565073, "creation_date": 1434558628, "last_edit_date": 1492087237, "question_id": 30897315, "link": "https://stackoverflow.com/questions/30897315/inconsistent-sorting-by-row-color", "title": "Inconsistent sorting by row color", "body": "<p>I have a sub that highlights each row based on the cell value found within a specific column range, then it uses the below code to sort each row by its cell color in a specific color order. The color part of the sub is done using a FindAllOccurrences function and if formulas found on this question <a href=\"https://codereview.stackexchange.com/questions/93361/sorting-and-color-coding-based-on-variables\">Sorting and color-coding based on variables</a>. The issue I am having is with the sort function. In its current form, it works, but not absolutely. What I mean is, the last color is red that is only used to highlight discontinued items on my sheet, the sort function is supposed to sort this last, which it does if its there, if it isn't there, it seems to override the color to make the last color on my sheet red regardless on if its discontinued. I have tested it by changing different variables, and I am getting different results.</p>\n\n<p>It could be something I'm not seeing, but the only thing that seems to fit as to why it is inconsistent is that the sort function doesn't contain an if command. Meaning nothing in the code allows it to skip if the color isn't found. I assumed that because it was a sort function that it couldn't sort a color that wasn't there so it would auto-skip to the next color that was found, but maybe I was incorrect? Any suggestions? </p>\n\n<pre><code> Set WS = ThisWorkbook.Sheets(1)\n Set LastRow = WS.Range(\"FU3:FU5002\")\n With WS.Sort\n    .SortFields.Clear\n\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(204, 255, 255)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(102, 0, 102)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(204, 255, 204)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(128, 128, 0)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(150, 150, 150)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(255, 255, 204)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(204, 204, 255)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(0, 128, 128)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(102, 102, 153)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(192, 192, 192)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(128, 128, 128)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(0, 255, 0)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(0, 255, 255)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(128, 0, 0)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(255, 255, 153)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(128, 0, 128)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(0, 102, 204)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(153, 204, 255)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(255, 153, 204)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(204, 153, 255)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(255, 0, 255)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(255, 153, 0)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(255, 0, 255)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(153, 51, 102)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(153, 204, 0)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(255, 204, 0)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(0, 204, 255)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(0, 0, 255)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(255, 102, 0)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(51, 153, 102)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(51, 51, 153)\n    .SortFields.Add(LastRow, xlSortOnCellColor, xlAscending, , xlSortNormal). _\n                    SortOnValue.Color = RGB(255, 0, 0)\n\n    .SetRange DataSheet\n    .Header = xlNo\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1434563292, "post_id": 30896881, "comment_id": 49836593, "body": "It is not clear (to me at least) what specific problem you are having.  Can you more clearly state your problem?  Your code appears to generate a <code>sourceRange</code> which contains columns <code>B</code> and <code>C</code> for a single row.  Are you trying to output those values to a new worksheet?  Do you have other code to do that?"}, {"owner": {"reputation": 147, "user_id": 4502871, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/caab609e3d6f324b0e47908e22506943?s=128&d=identicon&r=PG&f=1", "display_name": "vivi xu", "link": "https://stackoverflow.com/users/4502871/vivi-xu"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1434591749, "post_id": 30896881, "comment_id": 49848674, "body": "@Byron Hi I just edited the question, let me know if there&#39;s anything need to edit:) Now my problem is my script is only able to extract data from Range(&quot;A1:B2&quot;) for all worksheets. However, you could look at the if case in my code, that is set specifically for the first picture format, I don&#39;t know why the system never uses my if case."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1434648529, "post_id": 30896881, "comment_id": 49880741, "body": "Add a breakpoint at that line and see what is says the value of <code>.Range(&quot;B1&quot;)</code> is.  It is possible that it contains a space or some other character that prevents equality.  Step through and verify that it is not entering the <code>If</code> block.  I see no good reason it would not enter the <code>If</code>."}, {"owner": {"reputation": 147, "user_id": 4502871, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/caab609e3d6f324b0e47908e22506943?s=128&d=identicon&r=PG&f=1", "display_name": "vivi xu", "link": "https://stackoverflow.com/users/4502871/vivi-xu"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1434957131, "post_id": 30896881, "comment_id": 49979077, "body": "@Byron it doesn&#39;t tell me anything for <code>.Rnage(&quot;B1&quot;)</code>, I have tried <code>.Range(&quot;B1&quot;).Value</code>, it all didn&#39;t work, I think it didn&#39;t enter <code>if</code> though."}], "owner": {"reputation": 147, "user_id": 4502871, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/caab609e3d6f324b0e47908e22506943?s=128&d=identicon&r=PG&f=1", "display_name": "vivi xu", "link": "https://stackoverflow.com/users/4502871/vivi-xu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 286, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1434591992, "creation_date": 1434557320, "last_edit_date": 1434591992, "question_id": 30896881, "link": "https://stackoverflow.com/questions/30896881/copy-different-ranges-of-data-from-different-workbooks", "title": "copy different ranges of data from different workbooks", "body": "<p>I'm writing a macro which copies data from different worksheets in their respective workbooks, and then paste over another worksheet. The problem is due to different formats of data in different worksheets, so I need to extract different ranges of data for different worksheets. But my script is only able to extract from one specific range I set, it skips other <code>if</code> I set for it.</p>\n\n<p>Here is my code for selecting different ranges of data, it only manages to copy range of A1 to B2 for all files:</p>\n\n<pre><code>' Change this range to fit your own needs.\n            With mybook.Worksheets(1)\n                Set sourceRange = .Range(\"A1:B2\")\n                ' Change Range if B1 value is \"Host Name\"\n                If .Range(\"B1\") = \"Host Name\" Then\n\n                    '// Here lets Find the last row of data\n                    wSlastRow = .Rows(.Rows.Count).End(xlUp).Row\n\n                    '// Now Loop through each row\n                    For X = 4 To wSlastRow\n\n                        Set sourceRange = .Union(Range(\"B\" &amp; (X)), Range(\"C\" &amp; (X)))\n\n                    Next X\n                End If\n            End With\n</code></pre>\n\n<p>Here is the screenshots for different worksheet formats:</p>\n\n<p>The first picture reflects my if case above, when macro reads \"Host name\" at B1, it should copy column B and C starting from row 4, until it finds a blank row.</p>\n\n<p><img src=\"https://i.stack.imgur.com/KlPpl.png\" alt=\"enter image description here\"> </p>\n\n<p>The second picture is the normal case where data contained in A1 and A2 cells.</p>\n\n<p><img src=\"https://i.stack.imgur.com/VxobB.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 1, "creation_date": 1434557910, "post_id": 30896939, "comment_id": 49833155, "body": "The merged cells are not one on top of the other. Sometimes they are next to each other. Your method would ignore that."}, {"owner": {"reputation": 18637, "user_id": 220984, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UTpcd.jpg?s=128&g=1", "display_name": "Doc Brown", "link": "https://stackoverflow.com/users/220984/doc-brown"}, "edited": false, "score": 1, "creation_date": 1434557923, "post_id": 30896939, "comment_id": 49833166, "body": "You get downvotes because you assume each merged cell range is a full area from column B to K, which is most probably wrong, since nothing the OPs question indicates that."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": -1, "last_activity_date": 1434557501, "creation_date": 1434557501, "answer_id": 30896939, "question_id": 30896724, "link": "https://stackoverflow.com/questions/30896724/taking-value-of-a-range-of-merged-cells/30896939#30896939", "title": "Taking value of a range of merged cells", "body": "<p>Instead of using the range B20:K23, use B20:B23.  Using the B:K Range, it will (as you noticed) go through each 'underlying' cell in that merged cell and return the same value over and over.  If you use B:B instead, it'll act as you wanted it to - go through each merged cell ONCE and return that value. </p>\n\n<p>Does that make sense?</p>\n\n<p>edit: Please let me know why downvotes, I am also trying to learn, so if this method is not a good one, kindly let me know why so I can learn too.</p>\n"}, {"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1434558139, "post_id": 30896992, "comment_id": 49833324, "body": "I made the assumption that each merged area is fully-contained in the range you&#39;re looping over: if that&#39;s not the case then a different approach might be needed."}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1434558324, "post_id": 30896992, "comment_id": 49833449, "body": "It is the case. Although from what I understand of merged cells, it is true your method would not work if the merged area protruded from the top or the left of the cell, otherwise it would still work it if protruded from the bottom or right by taking the first cell (which would still be in the indicated range)."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1434558756, "post_id": 30896992, "comment_id": 49833749, "body": "If you wanted to handle merged area which are partly outside of your area then the most robust approach would be to keep track of the mergearea addresses and only report the cell value if you haven&#39;t already seen that address."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 4, "last_activity_date": 1434559086, "last_edit_date": 1434559086, "creation_date": 1434557635, "answer_id": 30896992, "question_id": 30896724, "link": "https://stackoverflow.com/questions/30896724/taking-value-of-a-range-of-merged-cells/30896992#30896992", "title": "Taking value of a range of merged cells", "body": "<pre><code>Sub testnoms()\n    Dim cell As Range\n    For Each cell In ActiveSheet.Range(\"B20:K23\") \n        If cell.Address() = cell.MergeArea.Cells(1).Address() Then\n            Debug.Print cell.Address(), cell.MergeArea.Cells(1, 1).Value\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>If you need to capture merged area values which may not be full-contained in your defined range:</p>\n\n<pre><code>Sub testnoms()\n    Dim c As Range, d, addr\n    Set d = CreateObject(\"scripting.dictionary\")\n    For Each c In ActiveSheet.Range(\"B20:K23\")\n        addr = c.MergeArea.Address()\n        If Not d.exists(addr) Then\n            d.Add addr, True\n            Debug.Print c.Address(), c.MergeArea.Cells(1).Value\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 635, "favorite_count": 0, "accepted_answer_id": 30896992, "answer_count": 2, "score": 1, "last_activity_date": 1434559086, "creation_date": 1434556909, "last_edit_date": 1434557766, "question_id": 30896724, "link": "https://stackoverflow.com/questions/30896724/taking-value-of-a-range-of-merged-cells", "title": "Taking value of a range of merged cells", "body": "<p>I have a range of merged cells with values in them. I would simply like to read the value contained in each merged cell. The amount of cells in the merge area varies. Right now I have this: </p>\n\n<pre><code>Sub testnoms()\n    Dim cell As Range\n    For Each cell In ActiveSheet.Range(\"B20:K23\") 'this would be the range to look at\n        Debug.Print cell.MergeArea.Cells(1, 1).Value\n    Next\nEnd Sub\n</code></pre>\n\n<p>Right now it goes to every cell in the range and returns the value in its merged area. So I get the right values, but I have a duplicate for every cell in the merged area. For example, if 5 cells are merged together, it prints 5 times the value of the merged cell. Does anyone have an idea to fix this?</p>\n"}, {"tags": ["vba", "foreach"], "answers": [{"tags": [], "owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "is_accepted": true, "score": 1, "last_activity_date": 1434557493, "creation_date": 1434557493, "answer_id": 30896933, "question_id": 30896716, "link": "https://stackoverflow.com/questions/30896716/format-excel-worksheets-using-for-each-loop-vba/30896933#30896933", "title": "Format Excel worksheets using for each loop VBA", "body": "<p><code>Cells.Select</code> selects the cells of the currently active sheet. This selection doesn't change within the <code>For Each</code> loop</p>\n\n<p>You want to work on the cells of the worksheet provided by the <code>For Each</code> construct, i.e.</p>\n\n<pre><code>Sub wsLoop()\n' Declare Current as a worksheet object variable.\nDim ws As Worksheet\n\n    ' Loop through all of the worksheets in the active workbook.\n    For Each ws In ActiveWorkbook.Worksheets\n\n        ' format font of currently looped worksheet object feferenced by WS\n        With ws.Cells.Font\n            .Name = \"Calibri\"\n            .Size = 9\n            .Strikethrough = False\n            .Superscript = False\n            .Subscript = False\n            .OutlineFont = False\n            .Shadow = False\n            .Underline = xlUnderlineStyleNone\n            .TintAndShade = 0\n            .ThemeFont = xlThemeFontNone\n        End With\n    Next ws\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "edited": false, "score": 1, "creation_date": 1434558079, "post_id": 30896991, "comment_id": 49833286, "body": "I recommend to consequently avoid <code>.Activate</code> and <code>.Select</code> and work with objects instead. Code becomes cleaner and faster and screens are not hopping in &amp; out. There are only few cases where <code>.Activate</code> and <code>.Select</code> are justified."}, {"owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "edited": false, "score": 1, "creation_date": 1434559028, "post_id": 30896991, "comment_id": 49833945, "body": "<a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\" title=\"how to avoid using select in excel vba macros\">stackoverflow.com/questions/10714251/&hellip;</a> provides indepth explanations and good hints ..."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "reply_to_user": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "edited": false, "score": 0, "creation_date": 1434560420, "post_id": 30896991, "comment_id": 49834857, "body": "I know, we all know. If you read carefully, I have mentioned this. I have been teaching VBA this for over 10 years now. For novice Excel users trying to get a hang of VBA, using objects is confusing. Using .activeate, .select is the way for them, and later, you can teach them about effective coding."}], "tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": false, "score": 0, "last_activity_date": 1434560525, "last_edit_date": 1434560525, "creation_date": 1434557633, "answer_id": 30896991, "question_id": 30896716, "link": "https://stackoverflow.com/questions/30896716/format-excel-worksheets-using-for-each-loop-vba/30896991#30896991", "title": "Format Excel worksheets using for each loop VBA", "body": "<p>You never tell it to go to another sheet.\nThe easiest and most visual (though not the best!) way would be activating each sheet, then running the code.</p>\n\n<p>Whatever you want to do with each worksheet inside your for each loop, you must do it with the ws. This way you can add any recorded macro to the loop easily.</p>\n\n<pre><code>For Each ws In ActiveWorkbook.Worksheets\n ws.activate\n cells.select\n With selection... yaddayadda\n  yaddayadda\n end with\nNext ws\n</code></pre>\n\n<p><strong>Like I said, there are better ways to do this, but since you seem to be a novice, this is the easiest to follow.</strong>\nIf you are an advanced programmer, avoid using macro recorder-like coding, as it is slow and ineffective. (Pretty obvious in my opinion, but nvm...)</p>\n"}], "owner": {"reputation": 93, "user_id": 3850154, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b93e95c91ef4e45e534d7f2219997e1?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Corson", "link": "https://stackoverflow.com/users/3850154/andrew-corson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1593, "favorite_count": 0, "accepted_answer_id": 30896933, "answer_count": 2, "score": 0, "last_activity_date": 1434560525, "creation_date": 1434556876, "question_id": 30896716, "link": "https://stackoverflow.com/questions/30896716/format-excel-worksheets-using-for-each-loop-vba", "title": "Format Excel worksheets using for each loop VBA", "body": "<p>I have a workbook with 3 sheets. I would like to format each sheet the same using VBA (set font size, auto fit columns, sort). I found a piece of code to loop through the sheets:</p>\n\n<pre><code>Sub wsLoop()\n\n   ' Declare Current as a worksheet object variable.\n   Dim ws As Worksheet\n\n   ' Loop through all of the worksheets in the active workbook.\n   For Each ws In ActiveWorkbook.Worksheets\n    'Code here\n   Next ws\n\nEnd Sub\n</code></pre>\n\n<p>The original code included a message box that pops up with the sheet name. When inserting the code for formatting that I got from recording a macro, the loop only formatted the first sheet. I have been searching around, but I can't find a simple example. Shouldn't I just be able to drop in:</p>\n\n<pre><code>Cells.Select\nWith Selection.Font\n    .Name = \"Calibri\"\n    .Size = 9\n    .Strikethrough = False\n    .Superscript = False\n    .Subscript = False\n    .OutlineFont = False\n    .Shadow = False\n    .Underline = xlUnderlineStyleNone\n    .TintAndShade = 0\n    .ThemeFont = xlThemeFontNone\nEnd With\n</code></pre>\n\n<p>Why does this only format the first sheet?</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 574, "user_id": 2874865, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ec5072b569208e2c974a25089a17d1fc?s=128&d=identicon&r=PG&f=1", "display_name": "JShell", "link": "https://stackoverflow.com/users/2874865/jshell"}, "edited": false, "score": 0, "creation_date": 1434556815, "post_id": 30896609, "comment_id": 49832378, "body": "Is protecting the worksheet an option?"}], "answers": [{"tags": [], "owner": {"reputation": 11225, "user_id": 471129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cec5a6cce700294c7c564becb11fa3c1?s=128&d=identicon&r=PG", "display_name": "Erik Eidt", "link": "https://stackoverflow.com/users/471129/erik-eidt"}, "is_accepted": false, "score": 2, "last_activity_date": 1434561221, "creation_date": 1434561221, "answer_id": 30898146, "question_id": 30896609, "link": "https://stackoverflow.com/questions/30896609/excel-conditional-formatting-rules-propigate-endlessly/30898146#30898146", "title": "Excel conditional formatting rules propigate endlessly", "body": "<p>It would be really nice if Excel had a user mode vs. developer mode, but it doesn't.  It always works in \"developer mode\", by which I mean that a simple cut &amp; paste moves everything (like formatting), even when user's aren't expecting that.</p>\n\n<p>I think you'd have to use VBA to set (and reset/clear) the background color; you'd have to hook into something like the <code>Sub Worksheet_Calculate ()</code> event to run your vb whenever Excel recacluates.</p>\n"}], "owner": {"reputation": 251, "user_id": 3654439, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/7TJw3.jpg?s=128&g=1", "display_name": "msiudut", "link": "https://stackoverflow.com/users/3654439/msiudut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1434562322, "creation_date": 1434556567, "last_edit_date": 1531161705, "question_id": 30896609, "link": "https://stackoverflow.com/questions/30896609/excel-conditional-formatting-rules-propigate-endlessly", "title": "Excel conditional formatting rules propigate endlessly", "body": "<p>I have a series of Excel workbooks edited daily by users. At their request I added conditional formatting rules to call out important data. Below is an example of the basic set I add for everyone. </p>\n\n<p><img src=\"https://i.stack.imgur.com/lyjRw.png\" alt=\"Hundreds of rows deep\"></p>\n\n<p>A consistent problem we are having is the rules seem to multiply over time. As the users manipulate the data they generate more and more rules without ever touching the Conditional Formatting tool. The user below easily has hundreds if not thousands. </p>\n\n<p><img src=\"https://i.stack.imgur.com/XAgTF.png\" alt=\"Nice and Neat\">\nIs there a way to set the rules then lock them somehow?</p>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1434561283, "post_id": 30896601, "comment_id": 49835380, "body": "Sorry, I totally misread your intent. Do you receive any errors?"}, {"owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "reply_to_user": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1434561430, "post_id": 30896601, "comment_id": 49835463, "body": "Yes, it seems that in simplifying my code for the post I created a syntax error. I&#39;ll fix and repost. Sorry about that."}, {"owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "reply_to_user": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1434561588, "post_id": 30896601, "comment_id": 49835552, "body": "I take that back. No, I do not get a compile error. I thought I did, but it compiles fine. It was something else I was working on..."}, {"owner": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1434561649, "post_id": 30896601, "comment_id": 49835582, "body": "Okay, so does it work?"}, {"owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "reply_to_user": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1434561866, "post_id": 30896601, "comment_id": 49835709, "body": "No, not in SQL View. I get a type mismatch."}, {"owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "reply_to_user": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1434563319, "post_id": 30896601, "comment_id": 49836608, "body": "@Hansup - are you there? :)"}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 2, "creation_date": 1434568008, "post_id": 30896601, "comment_id": 49839433, "body": "For anyone else looking at this the Debug.Print comes out with this: <code>SELECT tblFirst250.[GICS Sector],0.75*(SELECT Max(GM) FROM tblFirst250 WHERE tblFirst250.GM IN (SELECT TOP 25 PERCENT GM FROM tblFirst250 WHERE tblFirst250.[GICS Sector] = &quot;Energy&quot; AND GM Is Not Null ORDER BY GM)) + 0.25*(SELECT Min(GM) FROM tblFirst250 WHERE tblFirst250.GM IN (SELECT TOP 75 PERCENT GM FROM tblFirst250 WHERE tblFirst250.[GICS Sector] = &quot;Energy&quot; AND GM Is Not Null ORDER BY GM DESC)) AS 25Percentile FROM tblFirst250 WHERE tblFirst250.[GICS Sector] = &quot;Energy&quot; GROUP BY tblFirst250.[GICS Sector];</code>"}, {"owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "reply_to_user": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1434568237, "post_id": 30896601, "comment_id": 49839579, "body": "@Newd - I think that is in the comments in my question...."}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 2, "creation_date": 1434568621, "post_id": 30896601, "comment_id": 49839802, "body": "@mountainclimber I figured, but it looks edited.  I find edited strings can often be misleading when trying to find out what is wrong (fixed or caused in the edit)."}], "owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 573, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1434567484, "creation_date": 1434556544, "last_edit_date": 1495540275, "question_id": 30896601, "link": "https://stackoverflow.com/questions/30896601/how-to-create-percentile-function-for-a-sql-query-in-ms-access-that-allows-group", "title": "How to create percentile function for a SQL query in MS Access that allows GROUP BY and filtering?", "body": "<p>I'm attempting to write a domain function I can use in MS Access SQL view like what is found here: <a href=\"https://stackoverflow.com/questions/30736739/dmedian-in-access-2013-no-values-returned\">DMedian in access 2013, no values returned</a></p>\n\n<p>...but for a DPercentile function that allows you to GROUP BY and filter.</p>\n\n<p>This is what I have so far:</p>\n\n \n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function DPercentileWithGrpBy( _\n ByVal sFld As String, _\n ByVal sTable As String, _\n ByVal iPercent As Integer, _\n ByVal sGrpByFld As String, _\n ByVal sGrpByValue As String _\n ) As Variant\n\n\n    Dim db As DAO.Database\n    Dim rstDomain As DAO.Recordset\n    Dim sSQL As String\n\n    Const errAppTypeError = 3169\n\n    On Error GoTo HandleErr\n\n    Set db = CurrentDb()\n\n    ' Build SQL string for recordset.\n    sSQL = \"SELECT \" &amp; _\n                sTable &amp; \".\" &amp; sGrpByFld &amp; _\n                \",\" &amp; (1 - iPercent / 100) &amp; \"*(\" &amp; _\n                    \"SELECT Max(\" &amp; sFld &amp; \") \" &amp; _\n                    \"FROM \" &amp; sTable &amp; \" \" &amp; _\n                    \"WHERE \" &amp; sTable &amp; \".\" &amp; sFld &amp; \" IN (\" &amp; _\n                        \"SELECT TOP \" &amp; iPercent &amp; \" PERCENT \" &amp; sFld &amp; \" \" &amp; _\n                        \"FROM \" &amp; sTable &amp; \" \" &amp; _\n                        \"WHERE \" &amp; sTable &amp; \".\" &amp; sGrpByFld &amp; \" = \" &amp; Chr(34) &amp; sGrpByValue &amp; Chr(34) &amp; \" AND \" &amp; sFld &amp; \" Is Not Null ORDER BY \" &amp; sFld &amp; \")) + \" &amp; iPercent / 100 &amp; \"*(\" &amp; _\n                            \"SELECT Min(\" &amp; sFld &amp; \") \" &amp; _\n                            \"FROM \" &amp; sTable &amp; \" \" &amp; _\n                            \"WHERE \" &amp; sTable &amp; \".\" &amp; sFld &amp; \" IN (\" &amp; _\n                                \"SELECT TOP \" &amp; 100 - iPercent &amp; \" PERCENT \" &amp; sFld &amp; \" \" &amp; _\n                                \"FROM \" &amp; sTable &amp; \" \" &amp; _\n                                \"WHERE \" &amp; sTable &amp; \".\" &amp; sGrpByFld &amp; \" = \" &amp; Chr(34) &amp; sGrpByValue &amp; Chr(34) &amp; \" AND \" &amp; sFld &amp; \" Is Not Null ORDER BY \" &amp; sFld &amp; \" DESC)\" &amp; _\n                \") AS \" &amp; iPercent &amp; \"Percentile \" &amp; _\n                \"FROM \" &amp; sTable &amp; \" \" &amp; _\n                \"WHERE \" &amp; sTable &amp; \".\" &amp; sGrpByFld &amp; \" = \" &amp; Chr(34) &amp; sGrpByValue &amp; Chr(34) &amp; \" \" &amp; _\n                \"GROUP BY \" &amp; sTable &amp; \".\" &amp; sGrpByFld &amp; \";\"\n'Debug.Print sSQL\n\n'above should result in something like this:\n'SELECT\n ' tblFirst250.[GICS Sector]\n'  , 0.75*(\n  '  SELECT Max(GM)\n  '  FROM tblFirst250\n  '  WHERE tblFirst250.GM IN (\n   '   SELECT TOP 25 PERCENT GM\n   '   FROM tblFirst250\n    '  WHERE tblFirst250.[GICS Sector] = \"Energy\" AND GM Is Not Null ORDER BY GM)) + 0.25*(\n     '   SELECT Min(GM)\n     '   FROM tblFirst250\n     '   WHERE tblFirst250.GM IN (\n    '      SELECT TOP 75 PERCENT GM\n   '       FROM tblFirst250\n  '        WHERE tblFirst250.[GICS Sector] = \"Energy\" AND GM Is Not Null ORDER BY GM DESC)\n ' ) AS 25Percentile\n'FROM tblFirst250\n'WHERE tblFirst250.[GICS Sector] = \"Energy\"\n'GROUP BY tblFirst250.[GICS Sector];\n\n    Set rstDomain = db.OpenRecordset(sSQL, dbOpenDynaset)\n\n     DPercentileWithGrpBy = rstDomain\n\nExitHere:\n    On Error Resume Next\n    rstDomain.Close\n    Set rstDomain = Nothing\n    Exit Function\n\nHandleErr:\n    ' Return an error value.\n    DPercentileWithGrpBy = CVErr(Err.Number)\n    Resume ExitHere\nEnd Function\n</code></pre>\n\n<p>I'd like to have the ability to use the function in MS Access SQL View as a query or part of a query. I also need to do a percentile (quartiles) of a sub group of records. Hopefully that make sense...</p>\n\n<p>EDIT: the resulting query works when I debug.print it and using it in SQL View.</p>\n\n<p>EDIT: here is how you could use it:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DPercentileWithGrpBy( \"GM\",\"tblFirst250\", 25,\"[GICS Sector]\",\"Energy\")\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2344, "user_id": 757661, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22d55e7c13896272c09c997eeba72318?s=128&d=identicon&r=PG", "display_name": "gordon613", "link": "https://stackoverflow.com/users/757661/gordon613"}, "is_accepted": false, "score": 0, "last_activity_date": 1434561134, "last_edit_date": 1434561134, "creation_date": 1434556172, "answer_id": 30896469, "question_id": 30896228, "link": "https://stackoverflow.com/questions/30896228/issues-with-formula-in-excel-vba/30896469#30896469", "title": "Issues with Formula in Excel VBA", "body": "<p>I suggest the following:\nSet the String <code>Formula1R1C1</code> to be the formula in terms of Rows and Columns e.g.</p>\n\n<pre><code>FormulaR1C1=\"=SUM(R1C1:R4C4)\" \n</code></pre>\n\n<p>(just as an example)</p>\n\n<p>then do</p>\n\n<pre><code>Formula1:=Application.Evaluate(Application.ConvertFormula(FormulaR1C1, xlR1C1, xlA1))\n</code></pre>\n\n<p>In this way, you can write the formula in terms of <strong>relative</strong> references, then convert it into <strong>absolute</strong> references to be used in your code (which you say does work with absolute references)</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 5020378, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152972556477291/picture?type=large", "display_name": "Martin O&#39;Loughlin", "link": "https://stackoverflow.com/users/5020378/martin-oloughlin"}, "edited": false, "score": 0, "creation_date": 1434614882, "post_id": 30896487, "comment_id": 49857286, "body": "Yes, the line I haven&#39;t included looks for a word in column A when it finds that word it inserts a line underneath, that line then needs a few drop downs added. Your code almost worked, I got it to work by changing <code>....B&quot; &amp; x+ 1 &amp; &quot;,Ca....</code> to <code>....B&quot; &amp; (x + 1) &amp; &quot;,Ca....</code> Thanks."}], "tags": [], "owner": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "is_accepted": true, "score": 0, "last_activity_date": 1434652208, "last_edit_date": 1434652208, "creation_date": 1434556230, "answer_id": 30896487, "question_id": 30896228, "link": "https://stackoverflow.com/questions/30896228/issues-with-formula-in-excel-vba/30896487#30896487", "title": "Issues with Formula in Excel VBA", "body": "<p>you might have to play with this a little but I think this should work. The idea is to make the formula string dynamic so that it changes as the rows change, correct? Another possible way would be to save the intended formula after concatenation into a string and insert it that way. </p>\n\n<pre><code>With Cells(x + 1, 3).Validation\n.Delete\n.Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n    xlBetween, Formula1:= _\n    \"=OFFSET(CategoryStart,MATCH(B\" &amp; (x + 1) &amp; \",CategoryColumn,0),1,COUNTIF(CategoryColumn,B\" &amp; x+1 &amp; \"),1)\"\n    .InCellDropdown = True\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5020378, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152972556477291/picture?type=large", "display_name": "Martin O&#39;Loughlin", "link": "https://stackoverflow.com/users/5020378/martin-oloughlin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 30896487, "answer_count": 2, "score": 1, "last_activity_date": 1434652208, "creation_date": 1434555587, "question_id": 30896228, "link": "https://stackoverflow.com/questions/30896228/issues-with-formula-in-excel-vba", "title": "Issues with Formula in Excel VBA", "body": "<p>I am having a few issues with trying to populate values using relative values not specific.</p>\n\n<p>This works as is, however I need to be able to do a relative cell match. I have tried to change the word Formula1 to FormulaR1C1 and tried to use R2C3 rather than B3, but this does not work. </p>\n\n<p>My thinking is that if I use FormulaR1C1 I can then use R[1].... to specify the cell I need to match to. </p>\n\n<p>x is a row I have already located. at the moment it is row 2, which gives x=2.\ncategoryColumn and CategoryStart are named ranges defined in the worksheet.\nThis formula exists to populate a dependent dropdown list, and as said it works as is, but doesn't work how I need it to work. </p>\n\n<pre><code>With Cells(x + 1, 3).Validation\n.Delete\n.Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n    xlBetween, Formula1:= _\n    \"=OFFSET(CategoryStart,MATCH(B3,CategoryColumn,0),1,COUNTIF(CategoryColumn,B3),1)\"\n    .InCellDropdown = True\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel", "cookies"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 4941181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/71fb83aedc1b4cdac8487944952d4029?s=128&d=identicon&r=PG&f=1", "display_name": "JGoldz75", "link": "https://stackoverflow.com/users/4941181/jgoldz75"}, "edited": false, "score": 0, "creation_date": 1434563243, "post_id": 30897952, "comment_id": 49836573, "body": "Thanks! I can give this a try later; instead of opening IE minimized, would it work if I just did the &quot;objIE.Visible = False&quot; command? Also, would this need to run every single time I run the query or only once when I open the excel document? If I&#39;m running looping a query for 1000 items, I&#39;d hate to have to wait for it to log in every single time.  Additionally, you emphasized the word &quot;POST&quot;. Is this a VBA command that I am unaware of?"}, {"owner": {"reputation": 37, "user_id": 4941181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/71fb83aedc1b4cdac8487944952d4029?s=128&d=identicon&r=PG&f=1", "display_name": "JGoldz75", "link": "https://stackoverflow.com/users/4941181/jgoldz75"}, "edited": false, "score": 0, "creation_date": 1434563359, "post_id": 30897952, "comment_id": 49836647, "body": "Last question: when I use the command to call the query using &quot;ActiveSheet.QueryTables.Add(Connection:=&quot;, will I need to somehow reference the open minimized IE document? Or will the URL work fine?"}, {"owner": {"reputation": 37, "user_id": 4941181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/71fb83aedc1b4cdac8487944952d4029?s=128&d=identicon&r=PG&f=1", "display_name": "JGoldz75", "link": "https://stackoverflow.com/users/4941181/jgoldz75"}, "edited": false, "score": 0, "creation_date": 1434564746, "post_id": 30897952, "comment_id": 49837470, "body": "Update: I automated the opening of IE (not hidden), then ran the query from that URL once logged in and the query is still telling me to log in."}, {"owner": {"reputation": 679, "user_id": 4263206, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iruqP7WS-9M/AAAAAAAAAAI/AAAAAAAAAO4/uyEhvsH2NOk/photo.jpg?sz=128", "display_name": "Phil Cazella", "link": "https://stackoverflow.com/users/4263206/phil-cazella"}, "reply_to_user": {"reputation": 37, "user_id": 4941181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/71fb83aedc1b4cdac8487944952d4029?s=128&d=identicon&r=PG&f=1", "display_name": "JGoldz75", "link": "https://stackoverflow.com/users/4941181/jgoldz75"}, "edited": false, "score": 0, "creation_date": 1434657636, "post_id": 30897952, "comment_id": 49886227, "body": "Sounds like the IE and the worksheet are two different sessions.  What version of the worksheet application are you using?  Knowing this, I may be able to help you launch an instance of the browser from within the program so that it is the same session."}, {"owner": {"reputation": 37, "user_id": 4941181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/71fb83aedc1b4cdac8487944952d4029?s=128&d=identicon&r=PG&f=1", "display_name": "JGoldz75", "link": "https://stackoverflow.com/users/4941181/jgoldz75"}, "edited": false, "score": 0, "creation_date": 1434716768, "post_id": 30897952, "comment_id": 49910956, "body": "I am using Excel 2010 and IE 9 (soon to be upgraded to IE 11 next week I believe). If you could figure this out, that would be amazing! I have tried other methods but nothing has worked thus far. This issue is putting a huge damper on my code which is difficult for someone like myself who is trying to learn"}, {"owner": {"reputation": 37, "user_id": 4941181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/71fb83aedc1b4cdac8487944952d4029?s=128&d=identicon&r=PG&f=1", "display_name": "JGoldz75", "link": "https://stackoverflow.com/users/4941181/jgoldz75"}, "edited": false, "score": 0, "creation_date": 1435001619, "post_id": 30897952, "comment_id": 50006572, "body": "Any luck on this? I can&#39;t seem to figure it out"}], "tags": [], "owner": {"reputation": 679, "user_id": 4263206, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iruqP7WS-9M/AAAAAAAAAAI/AAAAAAAAAO4/uyEhvsH2NOk/photo.jpg?sz=128", "display_name": "Phil Cazella", "link": "https://stackoverflow.com/users/4263206/phil-cazella"}, "is_accepted": false, "score": 0, "last_activity_date": 1434721089, "last_edit_date": 1434721089, "creation_date": 1434560645, "answer_id": 30897952, "question_id": 30896151, "link": "https://stackoverflow.com/questions/30896151/data-import-with-login/30897952#30897952", "title": "Data Import With Login", "body": "<p>Yes, the site authentication token(cookie) and the query language credentials (DB login) are two separate things. The site level credentials are authentication and the DB level credentials are authorization.  </p>\n\n<p>A typical authentication token is stored in the browser for a given session and is passed back to the site via the header of the HTTP request.  Your worksheet macro is making the request for information using the current browser context, but if you don't have a browser open already it will create a temporary instance of the IE object in order to send the data.</p>\n\n<p>I found a forum where someone was trying to do this exact same thing, and it looks like they were able to do so.</p>\n\n<p><a href=\"http://www.mrexcel.com/forum/excel-questions/421541-web-query-password-protected-web-sites-3.html\" rel=\"nofollow\">http://www.mrexcel.com/forum/excel-questions/421541-web-query-password-protected-web-sites-3.html</a></p>\n\n<p>Here is the relevant code edited for this question:</p>\n\n<pre><code>Set ie = CreateObject(\"InternetExplorer.Application\")\nWith ie\n    .Visible = True\n    .Navigate \"http://www.somesecuresite.com/login.html\"\n        Do Until .ReadyState = 4\n            DoEvents\n        Loop\n    .document.all.Item(\"username\").Value = \"ldfsdfh\"\n    .document.all.Item(\"password\").Value = \"lkjgshdgsh\"\n    .document.forms(0).submit\nEnd With\n\nWith ActiveSheet.QueryTables.Add(Connection:= _\n    \"URL;{your connection string}\", Destination:=Range(\"$A$1\"))\n    .Name = \"WebData\"\n    .FieldNames = False\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .HasAutoFormat = True\n    .TablesOnlyFromHTML = True\n    .AdjustColumnWidth = True\n    .Refresh BackgroundQuery:=False\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "is_accepted": false, "score": 0, "last_activity_date": 1434577452, "creation_date": 1434577452, "answer_id": 30902933, "question_id": 30896151, "link": "https://stackoverflow.com/questions/30896151/data-import-with-login/30902933#30902933", "title": "Data Import With Login", "body": "<p>This is more a comment but I don't have enough reps to comment XD Your problem is beyond me but having recently used API to automate password entry in Excel, perhaps it's a direction you can look into? Basically, you can grab the handle of a particular window then interact with it such as filling fields/password or pressing buttons.\nA good example via <a href=\"http://www.siddharthrout.com/2013/04/24/unprotecting-vba-project-password-using-a-password-that-you-know/#!prettyPhoto\" rel=\"nofollow\">http://www.siddharthrout.com/2013/04/24/unprotecting-vba-project-password-using-a-password-that-you-know/#!prettyPhoto</a></p>\n"}], "owner": {"reputation": 37, "user_id": 4941181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/71fb83aedc1b4cdac8487944952d4029?s=128&d=identicon&r=PG&f=1", "display_name": "JGoldz75", "link": "https://stackoverflow.com/users/4941181/jgoldz75"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1232, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1434721089, "creation_date": 1434555373, "last_edit_date": 1434568075, "question_id": 30896151, "link": "https://stackoverflow.com/questions/30896151/data-import-with-login", "title": "Data Import With Login", "body": "<p>I'm looking to create a macro for my office. This macro imports data from websites using the  <code>With ActiveSheet.QueryTables.Add(Connection:=</code> code. </p>\n\n<p>The issue is that anyone who uses this macro will need to sign into the website I am trying to reach. Since I am using the Query command, the query requires the login, and not the IE object. </p>\n\n<p>Right now, I have people go to the data ribbon and clicking \"from web\" to load the website up and sign in that way, then exiting it and running the macro. This allows the Query to reach the login cookies and the code runs fine. I need a way to streamline this so it's not so complicated.</p>\n\n<p>Right now, I have a userbox that loads when the worksheet is opened that allows users to enter in their user login and password. Then this userbox saves that information in a different sheet. </p>\n\n<p>I'm looking for a way to use the information they entered to \"login\" to the query import because having users go to the data ribbon is just a pain in the butt for everybody; and just makes my code look sloppy. Is there a way to login to a query website automatically? </p>\n\n<p>*Even if I automate the login from an IE Application, the query still asks for a login. This makes me think that the cookies stored from IE and the query language are separate. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1434555334, "post_id": 30896052, "comment_id": 49831306, "body": "have you debugged it? Could be a negative index"}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "reply_to_user": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1434555411, "post_id": 30896052, "comment_id": 49831368, "body": "Just tested this (hardcoding in the keys) and received no errors.  As @EngJon suggested, I&#39;d step through this line by line and ensure you&#39;re seeing what you&#39;d expect."}, {"owner": {"reputation": 927, "user_id": 3382987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9aac410b6fbbf170175b8ac304167888?s=128&d=identicon&r=PG&f=1", "display_name": "EngJon", "link": "https://stackoverflow.com/users/3382987/engjon"}, "edited": false, "score": 0, "creation_date": 1434555873, "post_id": 30896052, "comment_id": 49831696, "body": "This error is only thrown if the second parameter of Left is negative. Although, when trying it by myself, I couldn&#39;t bring the function to produce that error..."}, {"owner": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "edited": false, "score": 1, "creation_date": 1434560488, "post_id": 30896052, "comment_id": 49834889, "body": "If key is not found <code>InStr</code> will return 0. If every words in your text file is bounded left and right by only one character, you could use <code>TrimString = Mid(s, 2, Len(s) - 2)</code>. This will work independantly of the bounding characters."}], "owner": {"reputation": 219, "user_id": 3657834, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/14c105ad51a1fdd8a879ba96102b71c8?s=128&d=identicon&r=PG&f=1", "display_name": "user3657834", "link": "https://stackoverflow.com/users/3657834/user3657834"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 583, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1434555137, "creation_date": 1434555137, "question_id": 30896052, "link": "https://stackoverflow.com/questions/30896052/compile-error-caused-by-vba-left-trim-function-in-string-parser", "title": "Compile error caused by vba &#39;Left&#39; trim function in string parser", "body": "<p>Im attempting to create a vba function to parse strings of text line by line into an excel table. I'd like the function to only print sub-strings that are between two characters in each line. For example, html tags. While debugging, the <code>Right()</code> function does what I'd like. But the <code>Left()</code> function will not even compile. The error message is very little help, \"Invalid procedure call or argument\". What is going on? I didn't change that line of code at all and it was just working.</p>\n\n<p>to explain what im trying to accomplish, lets say i'm parsing html text. Id like to only view text inside the \"&lt;\" and \">\" tags. but I'm also trying to code it so I could use this to parse substrings between any two desired characters.</p>\n\n<p>so text like this:</p>\n\n<pre><code>&lt;html&gt;\n  &lt;head&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>will print:</p>\n\n<pre><code>html\nhead\n/head\nbody\n/body\n/html\n</code></pre>\n\n<p>It was just working. Not sure why I'm getting this error. Only for the <code>Left()</code> trim.</p>\n\n<pre><code>Sub ParseTextFromFile()\nDim myFileName As String\nDim myLine As String\nDim FileNum As Long\nDim n As Integer\nn = 1\n\nmyFileName = \"C:\\Users\\user\\Desktop\\myfile.TXT\"\nFileNum = FreeFile\nClose FileNum\nOpen myFileName For Input As FileNum\nDo While Not EOF(FileNum)\n    Line Input #FileNum, myLine\n    'Debug.Print TrimString(CStr(myLine))\n    Cells(n, 1).Value = TrimString(CStr(myLine))\n    n = n + 1\nLoop\n\nMsgBox \"\" &amp; n - 1 &amp; \" items added.\"\nEnd Sub\n\n'parses a string between two chars/string key values\nFunction TrimString(s As String) As String\n    Dim indexOfKey As Integer\n    Dim firstTrim As String\n    Dim secondTrim As String\n    Dim textLength As Integer\n    Dim key1 As String\n    Dim key2 As String\n    firstTrim = \"\"\n    secondTrim = \"\"\n\n    key1 = CStr(Cells(5, 8)) 'H5 = \"&lt;\"\n    key2 = CStr(Cells(6, 8)) 'H6 = \"&gt;\"\n\n    'remove everything to the left of the first appearance of the key char/string\n    indexOfKey = InStr(1, s, key1)\n    firstTrim = Right(s, Len(s) - indexOfKey)\n\n    'remove everything to the right of the second appearance of the key char/string\n    indexOfKey = InStr(1, firstTrim, key2)\n    secondTrim = Left(firstTrim, indexOfKey - 1) 'this line is throwing the error\n\n    TrimString = secondTrim\nEnd Function\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba", "tsql", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 54566, "user_id": 2527905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aY8e6.jpg?s=128&g=1", "display_name": "dnoeth", "link": "https://stackoverflow.com/users/2527905/dnoeth"}, "is_accepted": false, "score": 2, "last_activity_date": 1434554895, "creation_date": 1434554895, "answer_id": 30895962, "question_id": 30895884, "link": "https://stackoverflow.com/questions/30895884/how-do-i-resolve-the-enter-parameter-value-error-in-ms-access/30895962#30895962", "title": "How do I resolve the &quot;Enter Parameter value&quot; error in MS-Access", "body": "<p>Seems you want to insert only rows which don't exist yet in the target. </p>\n\n<p>You can't reference the target table directly in the SELECT. Change it to a NOT EXISTS instead:</p>\n\n<pre><code>INSERT INTO DSRT_ERS\nSELECT *\nFROM DSRT_TEMP\nWHERE NOT EXISTS \n (\n   SELECT * FROM DSRT_ERS\n   WHERE [DSRT_ERS].[ID] =[DSRT_TEMP].[ID]\n );\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 54566, "user_id": 2527905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aY8e6.jpg?s=128&g=1", "display_name": "dnoeth", "link": "https://stackoverflow.com/users/2527905/dnoeth"}, "edited": false, "score": 0, "creation_date": 1434555005, "post_id": 30895966, "comment_id": 49831061, "body": "This will fail if there&#39;s a NULL returned in the NOT IN, at least add a <code>WHERE [DSRT_ERS].[ID] IS NOT NULL</code>"}, {"owner": {"reputation": 108986, "user_id": 511529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YNRmY.jpg?s=128&g=1", "display_name": "GolezTrol", "link": "https://stackoverflow.com/users/511529/goleztrol"}, "edited": false, "score": 0, "creation_date": 1434555135, "post_id": 30895966, "comment_id": 49831167, "body": "Eek. A nullable ID. I&#39;d think that is not very likely, but OP&#39;s table seems to allow it."}, {"owner": {"reputation": 7671, "user_id": 2686013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kqJWO.jpg?s=128&g=1", "display_name": "HaveNoDisplayName", "link": "https://stackoverflow.com/users/2686013/havenodisplayname"}, "reply_to_user": {"reputation": 108986, "user_id": 511529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YNRmY.jpg?s=128&g=1", "display_name": "GolezTrol", "link": "https://stackoverflow.com/users/511529/goleztrol"}, "edited": false, "score": 0, "creation_date": 1434555231, "post_id": 30895966, "comment_id": 49831227, "body": "@GolezTrol just for safe reason, better to take precautions"}, {"owner": {"reputation": 54566, "user_id": 2527905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aY8e6.jpg?s=128&g=1", "display_name": "dnoeth", "link": "https://stackoverflow.com/users/2527905/dnoeth"}, "reply_to_user": {"reputation": 108986, "user_id": 511529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YNRmY.jpg?s=128&g=1", "display_name": "GolezTrol", "link": "https://stackoverflow.com/users/511529/goleztrol"}, "edited": false, "score": 0, "creation_date": 1434555371, "post_id": 30895966, "comment_id": 49831330, "body": "@GolezTrol: Better check the definition: of the target columns: <b>Name ID, Type Text, AllowZeroLength: True, Required: False</b> :-)"}, {"owner": {"reputation": 108986, "user_id": 511529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YNRmY.jpg?s=128&g=1", "display_name": "GolezTrol", "link": "https://stackoverflow.com/users/511529/goleztrol"}, "reply_to_user": {"reputation": 54566, "user_id": 2527905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aY8e6.jpg?s=128&g=1", "display_name": "dnoeth", "link": "https://stackoverflow.com/users/2527905/dnoeth"}, "edited": false, "score": 0, "creation_date": 1434556713, "post_id": 30895966, "comment_id": 49832300, "body": "Yes, I saw the definition. It surprised me that ID is not required and if ID is really an ID, I would choose to fix the table structure rather than adding <code>NOT NULL</code> to the subselect. Nevertheless, it prevents issues with the current table structure, so well spotted, @dnoeth."}, {"owner": {"reputation": 580, "user_id": 4092675, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1463524265/picture?type=large", "display_name": "Chris Chevalier", "link": "https://stackoverflow.com/users/4092675/chris-chevalier"}, "reply_to_user": {"reputation": 108986, "user_id": 511529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YNRmY.jpg?s=128&g=1", "display_name": "GolezTrol", "link": "https://stackoverflow.com/users/511529/goleztrol"}, "edited": false, "score": 0, "creation_date": 1434559823, "post_id": 30895966, "comment_id": 49834472, "body": "@GolezTrol The person who built the DB before me create no identifiers into it and how it&#39;s set up I can&#39;t actually correct it.. There are null ID values so thanks for the heads up."}], "tags": [], "owner": {"reputation": 7671, "user_id": 2686013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kqJWO.jpg?s=128&g=1", "display_name": "HaveNoDisplayName", "link": "https://stackoverflow.com/users/2686013/havenodisplayname"}, "is_accepted": true, "score": 2, "last_activity_date": 1434556683, "last_edit_date": 1434556683, "creation_date": 1434554903, "answer_id": 30895966, "question_id": 30895884, "link": "https://stackoverflow.com/questions/30895884/how-do-i-resolve-the-enter-parameter-value-error-in-ms-access/30895966#30895966", "title": "How do I resolve the &quot;Enter Parameter value&quot; error in MS-Access", "body": "<p>Try this. This will exclude the [DSRT_ERS].[ID] from DSRT_TEMP table and insert only filtered records.</p>\n\n<pre><code>INSERT INTO DSRT_ERS\nSELECT *\nFROM DSRT_TEMP\nWHERE  [DSRT_TEMP].[ID] NOT IN (Select [DSRT_ERS].[ID] FROM [DSRT_ERS]\n                                 WHERE [DSRT_ERS].[ID] IS NOT NULL)\n</code></pre>\n\n<p>There are two options, you have <code>NOT IN</code> and <code>NOT EXISTS</code> suggested by @deoeth.\nKeep in mind While choose one.</p>\n\n<p>If the sub-query (inner query) returns small amount of data, <code>[NOT] IN</code> operator may give better performance. </p>\n\n<p>If the sub-query returns large volume of data <code>[NOT] EXISTS</code> operator is preferable.</p>\n\n<p>You can also use Left Outer Join, if you want to get rid of suquery</p>\n\n<pre><code>INSERT INTO DSRT_ERS\nSELECT *\nFROM DSRT_TEMP \n     LEFT Outer JOIN [DSRT_ERS] ON [DSRT_TEMP].[ID] = [DSRT_ERS].[ID]\nWHERE  [DSRT_ERS].[ID] IS NULL\n</code></pre>\n"}], "owner": {"reputation": 580, "user_id": 4092675, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1463524265/picture?type=large", "display_name": "Chris Chevalier", "link": "https://stackoverflow.com/users/4092675/chris-chevalier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 569, "favorite_count": 0, "accepted_answer_id": 30895966, "answer_count": 2, "score": 1, "last_activity_date": 1434568878, "creation_date": 1434554708, "last_edit_date": 1434568878, "question_id": 30895884, "link": "https://stackoverflow.com/questions/30895884/how-do-i-resolve-the-enter-parameter-value-error-in-ms-access", "title": "How do I resolve the &quot;Enter Parameter value&quot; error in MS-Access", "body": "<p>This code and another is producing the logical error in Ms-Access where it asks for a parameter equal to an objects name. In this case it wants [DSRT_ERS].[ID]. </p>\n\n<pre><code>INSERT INTO DSRT_ERS\nSELECT *\nFROM DSRT_TEMP\nWHERE  [DSRT_ERS].[ID] &lt;&gt;[DSRT_TEMP].[ID];\n</code></pre>\n\n<p>If you look at the DB's documentation you notice it is spelled correctly.</p>\n\n<pre><code>Table: DSRT_ERS                                                                                      \n\nProperties\n\nAlternateBackShade:       100                         AlternateBackTheme        -1\nAlternateBackTint:        100                         BackShade:                100\nBackTint:                 100                         DatasheetForeTheme        -1\n\nDatasheetGridlinesTh      -1                          DateCreated:              6/17/2015 10:15:19 AM\nDefaultView:              2                           DisplayViewsOnShar        1\nFilterOnLoad:             False                       GUID:                     {guid {BC8AFE53-\n                                                                                8AE3-42B9-AA5A-\n\nHideNewField:             False                       LastUpdated:              6/17/2015 10:21:50 AM\nNameMap:                  Long binary data            OrderByOn:                False\nOrderByOnLoad:            True                        Orientation:              Left-to-Right\n\nReadOnlyWhenDisco         False                       RecordCount:              1022\nThemeFontIndex:           -1                          TotalsRow:                False\nUpdatable:                True\n\n\n\n\nColumns\n\n         Name                                                  Type                        Size\n         ID                                                    Text                                   255\n                  AggregateType:             -1\n                  AllowZeroLength:           True\n\n                  AppendOnly:                False\n                  Attributes:                Variable Length\n                  CollatingOrder:            General\n\n                  ColumnHidden:              False\n                  ColumnOrder:               Default\n                  ColumnWidth:               Default\n                  CurrencyLCID:              0\n                  DataUpdatable:             False\n                  DisplayControl:            Text Box\n                  Format:                    @\n\n                  GUID:                      {guid {A1301DB4-C42E-4B73-A84B-\n                  IMEMode:                   0\n                  IMESentenceMode:           3\n                  OrdinalPosition:           1\n\n                  Required:                  False\n                  ResultType:                0\n                  SourceField:               ID\n\n                  SourceTable:               DSRT_ERS\n                  TextAlign:                 General\n                  UnicodeCompression:        False\n</code></pre>\n\n<p>I am unsure what to do at this point. A similar query produces this result(but with different parameters) and that all so needs to be fixed. If anyone could provide some guidance, it would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel", "loops", "variables"], "answers": [{"comments": [{"owner": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "edited": false, "score": 0, "creation_date": 1434555934, "post_id": 30895806, "comment_id": 49831749, "body": "Thank you very much! And the progress continues :) I couldnt thank the community here on stack overflow enough!"}], "tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": true, "score": 1, "last_activity_date": 1434554499, "creation_date": 1434554499, "answer_id": 30895806, "question_id": 30895661, "link": "https://stackoverflow.com/questions/30895661/how-do-i-use-the-find-function-with-a-variable-term-for-example-run1-run2-run/30895806#30895806", "title": "How do I use the Find function with a variable term, for example Run1, Run2, RunX", "body": "<p>Yes, you need a variable, and just concatenate it. Use something like this:</p>\n\n<pre><code>Dim counter as long\ncounter = 1\nCells.Find(What:=\"Run:\" &amp; counter, After:=Cells(1, 1), _ ...yaddayadda\n</code></pre>\n\n<p>Or use it in a loop:</p>\n\n<pre><code>For i=1 to 100\n Cells.Find(What:=\"Run:\" &amp; i, After:=Cells(1, 1), _ ...yaddayadda\nNext i\n</code></pre>\n"}], "owner": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19, "favorite_count": 0, "accepted_answer_id": 30895806, "answer_count": 1, "score": 0, "last_activity_date": 1434554499, "creation_date": 1434554106, "last_edit_date": 1531164843, "question_id": 30895661, "link": "https://stackoverflow.com/questions/30895661/how-do-i-use-the-find-function-with-a-variable-term-for-example-run1-run2-run", "title": "How do I use the Find function with a variable term, for example Run1, Run2, RunX", "body": "<pre><code>Cells.Find(What:=\"Run:1\", After:=Cells(1, 1), _\n LookIn:=xlValues, LookAt:=xlPart, _\n SearchOrder:=xlByColumns, SearchDirection:=xlNext, _\n MatchCase:=False, SearchFormat:=False)\n</code></pre>\n\n<p>This is the code that I want to use, but I would like to loop it to find Run:1, Run:2, Run:3... Etc..., Is there a way to add a variable in a reference to find <code>\"Run:X\"</code>?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "edited": false, "score": 3, "creation_date": 1434554114, "post_id": 30895539, "comment_id": 49830401, "body": "You&#39;re dim&#39;ing years as a double, but then setting it to a string.  Are you just trying to set it to the value of a particular cell here?"}, {"owner": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "reply_to_user": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "edited": false, "score": 0, "creation_date": 1434554642, "post_id": 30895539, "comment_id": 49830787, "body": "@TMH8885 That is exactly what I&#39;m trying to do.  Am I able to do something like   Dim years As Range   and then say   years = RC[14].value ?    Thanks for your response."}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "edited": false, "score": 0, "creation_date": 1434554820, "post_id": 30895539, "comment_id": 49830927, "body": "You can leave years as a double then set it equal to the value of that cell."}], "answers": [{"comments": [{"owner": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "edited": false, "score": 0, "creation_date": 1434555708, "post_id": 30895939, "comment_id": 49831570, "body": "Thank you very much!  That&#39;s very close!  Now I just have the issue of filling only one cell with that Offset value.  That is, I fill cell F8 with the value from T8.  So it runs like this: F8 = T8, F8 = T9, F8 = T10, etc...  How might I fix this?        I edited my original question for your bit here."}, {"owner": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "edited": false, "score": 0, "creation_date": 1434556108, "post_id": 30895939, "comment_id": 49831870, "body": "EDIT:  I got it.  I have to have a wCell.Select line in there."}, {"owner": {"reputation": 21235, "user_id": 13295, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/x6tCV.jpg?s=128&g=1", "display_name": "Lance Roberts", "link": "https://stackoverflow.com/users/13295/lance-roberts"}, "reply_to_user": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "edited": false, "score": 0, "creation_date": 1434557081, "post_id": 30895939, "comment_id": 49832552, "body": "You don&#39;t actually need to do a Select, you can just assign the value to where you want."}], "tags": [], "owner": {"reputation": 21235, "user_id": 13295, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/x6tCV.jpg?s=128&g=1", "display_name": "Lance Roberts", "link": "https://stackoverflow.com/users/13295/lance-roberts"}, "is_accepted": false, "score": 2, "last_activity_date": 1434554825, "creation_date": 1434554825, "answer_id": 30895939, "question_id": 30895539, "link": "https://stackoverflow.com/questions/30895539/vba-setting-a-dim-as-rc/30895939#30895939", "title": "VBA setting a Dim as &quot;=RC[##]&quot;", "body": "<p>You're setting a double to a string value. You need to reference your range using the Range object. To do relative referencing use the Offset function. Please don't use <code>Cell</code> as a variable name since that is a reserved word in Excel.</p>\n\n<p>Modify accordingly:</p>\n\n<pre><code>Dim years As Double\nDim wCell As Range\n\nFor Each wCell In Range(\"$F$8:$F$\" &amp; lastrow)\n    years = wCell.Offset(0,14).Value\n</code></pre>\n"}], "owner": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1434555879, "creation_date": 1434553758, "last_edit_date": 1434555879, "question_id": 30895539, "link": "https://stackoverflow.com/questions/30895539/vba-setting-a-dim-as-rc", "title": "VBA setting a Dim as &quot;=RC[##]&quot;", "body": "<p>I've got column T filled with a formula which returns a double.  For example, T8 has the formula =S8/K8 (but that's not too important).</p>\n\n<p>You can sort of understand the code by looking at it, but my issue comes from <strong><code>years = \"=RC[14]\"</code></strong> which returns a <strong>Type mismatch</strong> error.</p>\n\n<pre><code>Dim years As Double\n\nFor Each Cell In Range(\"$F$8:$F$\" &amp; lastrow)\n    years = \"=RC[14]\"\n\n    If years = 0 Then\n        ActiveCell.FormulaR1C1 = \"No inventory\"\n    End If\n    If years &lt; 1 And years &lt;&gt; 0 Then\n        ActiveCell.FormulaR1C1 = \"Less than a year's worth of inventory\"\n    End If\n    If years &gt; 1 Then\n        If Int(years) = 1 Then\n            ActiveCell.FormulaR1C1 = \"No Activity Required - OH qty exceeds EAU 1 year\"\n        Else: ActiveCell.FormulaR1C1 = \"No Activity Required - OH qty exceeds EAU \" &amp; Int(years) &amp; \"years\"\n        End If\n    End If\nNext\n</code></pre>\n\n<p>Also, I'm aware that my If-Else nests could be cleaner, but I'm not very experienced with VBA and this was a pretty simple way for me to do it.</p>\n\n<p>Thanks for the help!</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I now have to select the range of cells I want edited:</p>\n\n<pre><code>Range(\"$F$8:$F$\" &amp; lastrow).Select\nFor Each wCell In Range(\"$F$8:$F$\" &amp; lastrow)\n    years = wCell.Offset(0, 14).Value                    \n    If years = 0 Then\n        ActiveCell.FormulaR1C1 = \"No inventory\"\n    End If\n    If years &lt; 1 And years &lt;&gt; 0 Then\n        ActiveCell.FormulaR1C1 = \"Less than a year's worth of inventory\"\n    End If\n    If years &gt; 1 Then\n        If Int(years) = 1 Then\n            ActiveCell.FormulaR1C1 = \"No Activity Required - OH qty exceeds EAU 1 year\"\n        Else: ActiveCell.FormulaR1C1 = \"No Activity Required - OH qty exceeds EAU \" &amp; Int(years) &amp; \"years\"\n        End If\n    End If\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "is_accepted": false, "score": 3, "last_activity_date": 1434553892, "creation_date": 1434553892, "answer_id": 30895584, "question_id": 30895486, "link": "https://stackoverflow.com/questions/30895486/how-to-save-to-current-user-desktop-location/30895584#30895584", "title": "How to save to current User\\Desktop location", "body": "<p>You can use it like this:</p>\n\n<pre><code>Dim desktopFolderPath As String\ndesktopFolderPath = CreateObject(\"WScript.Shell\").specialfolders(\"Desktop\")\nfileName = desktopFolderPath &amp; \"\\PRN Test files\\\" &amp; Range(\"'Customer_Info'!R2\").Text &amp; \".prn\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 4949108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2837460bb3c97967fc88efd0dcfbb79?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/4949108/cameron"}, "edited": false, "score": 0, "creation_date": 1434556584, "post_id": 30896311, "comment_id": 49832197, "body": "Interesting. Is there a difference in functionality? @roryap suggestion worked just fine as you stated. Is one way better than the other? If I can avoid errors down the road, I would like to, as this is the last project I am working on with this company and I don&#39;t want them to get screwed."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 41, "user_id": 4949108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2837460bb3c97967fc88efd0dcfbb79?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/4949108/cameron"}, "edited": false, "score": 0, "creation_date": 1434558457, "post_id": 30896311, "comment_id": 49833544, "body": "If it has to be stored on the desktop then roryap&#39;s solution is slightly better because the desktop folder does not always have to be stored within the user profile. It can actully be somewhere else located and / or made available offline and the underlying linked server becomes the path. Within a Citrix environment and a server-farm it gets even a bit more complicated. Therefore, I normally prefer the designated areas to store stuff which is usually <code>Environ(&quot;TEMP&quot;)</code> for temporary files or <code>Environ(&quot;HOMESHARE&quot;)</code> or <code>Environ(&quot;HOMEPATH&quot;)</code>. But for desktop I&#39;d stick with roryap&#39;s solution."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 6, "last_activity_date": 1434555779, "creation_date": 1434555779, "answer_id": 30896311, "question_id": 30895486, "link": "https://stackoverflow.com/questions/30895486/how-to-save-to-current-user-desktop-location/30896311#30896311", "title": "How to save to current User\\Desktop location", "body": "<p>While roryap's solution is perfectly fine and working, I would like to add another working solution.</p>\n\n<pre><code>Dim strPath as String\nstrFileName = Environ(\"USERPROFILE\") &amp; \"\\Desktop\\PRN Test files\\\" &amp; Range(\"'Customer_Info'!R2\").Text &amp; \".prn\"\nActiveWorkbook.SaveAs fileName:=strFileName, FileFormat:=xlTextPrinter, Password:=\"\", WriteResPassword:=\"\", ReadOnlyRecommended:=False, CreateBackup:=False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4162, "user_id": 362712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yWcUr.jpg?s=128&g=1", "display_name": "Nigel Heffernan", "link": "https://stackoverflow.com/users/362712/nigel-heffernan"}, "is_accepted": false, "score": 0, "last_activity_date": 1434561182, "last_edit_date": 1434561182, "creation_date": 1434560822, "answer_id": 30898014, "question_id": 30895486, "link": "https://stackoverflow.com/questions/30895486/how-to-save-to-current-user-desktop-location/30898014#30898014", "title": "How to save to current User\\Desktop location", "body": "<p>The solution is to 'tokenize' these standard folders as symbols that can substituted for the standard folder path when you save the data, and expanded into the next machine's locally-defined special folders when the data is read again.</p>\n\n<p>I'm not aware of any universally-accepted set of tokens (labels, names, abbreviations or vulgar imprecations) for this: I'd be grateful if someone could enlighten me if there is, because this is a very common task and I hate reinventing the wheel.</p>\n\n<p>The beautifully-carved square wheels below will make an interesting conversation piece for your apartment and a clunky solution to your problem: all you have to do is save the path down through the 'Substitute' function below, <strong>every time you capture and save a folder path to your data store</strong>...</p>\n\n<p>...And read the path using the 'Expand' function <strong>every time you retrieve a folder path from your data store and use it to open a folder</strong>. </p>\n\n<p>Clunk, clunk, clunk: it's the distinctive sound of the newly-invented 'Wheel' in motion. I have some really interesting designs for a thermonuclear mousetrap up on the Excellerando Blogspot, too: search for the term 'Horrible Hack'.</p>\n\n<p><CODE><PRE>Public Function SubstituteStandardFolders(ByVal strPath As String) As String\n' Insert abbreviations for standard folders <BR />\nDim strUser     As String\nDim strDesk     As String\nDim strAppD     As String\nDim strDocs     As String\nDim strTemp     As String <BR />\nstrDesk = CreateObject(\"WScript.Shell\").SpecialFolders(\"Desktop\")\nstrDocs = CreateObject(\"WScript.Shell\").SpecialFolders(\"MyDocuments\")\nstrAppD = CreateObject(\"WScript.Shell\").SpecialFolders(\"AppData\")\nstrTemp = CreateObject(\"Scripting.FileSystemObject\").GetSpecialFolder(2)\nstrUser = CreateObject(\"WScript.Network\").UserName <BR />\nstrPath = Replace(strPath, strDesk, \"[Desktop]\", , , vbTextCompare)\nstrPath = Replace(strPath, strDocs, \"[My Documents]\", , , vbTextCompare)\nstrPath = Replace(strPath, strAppD, \"[Application Data]\", , , vbTextCompare)\nstrPath = Replace(strPath, strTemp, \"[Temp]\", , , vbTextCompare)\nstrPath = Replace(strPath, strUser, \"[User]\", , , vbTextCompare) <BR />\nSubstituteStandardFolders = strPath <BR />\nEnd Function <BR /><BR />\nPublic Function ExpandStandardFolders(ByVal strPath As String) As String\n' Replace abbreviations for standard folders with their full names <BR />\nDim strUser     As String\nDim strDesk     As String\nDim strAppD     As String\nDim strDocs     As String\nDim strTemp     As String <BR />\nstrDesk = CreateObject(\"WScript.Shell\").SpecialFolders(\"Desktop\")\nstrDocs = CreateObject(\"WScript.Shell\").SpecialFolders(\"MyDocuments\")\nstrAppD = CreateObject(\"WScript.Shell\").SpecialFolders(\"AppData\")\nstrTemp = CreateObject(\"Scripting.FileSystemObject\").GetSpecialFolder(2)\nstrUser = CreateObject(\"WScript.Network\").UserName <BR />\nstrPath = Replace(strPath, \"[Desktop]\", strDesk, , , vbTextCompare)\nstrPath = Replace(strPath, \"[My Documents]\", strDocs, , , vbTextCompare)\nstrPath = Replace(strPath, \"[Application Data]\", strAppD, , , vbTextCompare)\nstrPath = Replace(strPath, \"[Temp]\", strTemp, , , vbTextCompare)\nstrPath = Replace(strPath, \"[User]\", strUser, , , vbTextCompare) <BR />\nExpandStandardFolders = strPath <BR />\nEnd Function \n</PRE></CODE></p>\n\n<p>Note the 'Hail Mary' clause at the end: if all else fails, swap out the user name for [User] and hope that the path is constructed the same way on all the other machines.</p>\n\n<p>There are limitations to this code. Look at the list of tokens:</p>\n\n<p><CODE>\n&nbsp;[Desktop]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;[My Documents]&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;[Application Data]\n&nbsp;[Temp]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;[User]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n</CODE></p>\n\n<p>If you enumerate the Shell SpecialFolders collection, you'll see that there are more than that:</p>\n\n<p><CODE><PRE>\nPublic Sub EnumerateSpecialFolders() <BR />\nDim objCollection As Object\nDim varX As Variant <BR />\nSet objCollection = CreateObject(\"WScript.Shell\").SpecialFolders  <BR />\nFor Each varX In objCollection\n    Debug.Print varX\nNext varX <BR />\nEnd Sub\n</PRE></CODE></p>\n\n<p>However, I can't get the keys out of that collection - just the values - and the ordinals will vary from system to system. </p>\n\n<p>If you could get the keys, that'd be a reasonable set of tokens for universal use. Assuming, of course, that 'My Documents' isn't retrieved by the key 'MiaDocumetari' or a string of two- and three-byte unicodes on half the workstations in your company.</p>\n\n<p>Also: welcome to Deep VBA. It's the trivial tasks that require square-wheel workarounds, and I have a sneaking suspicion that our colleagues in more widely-respected languages are shielded from this by absurdly-overcomplicated bodges in their SDK developer libraries: these workarounds originate in bad design decisions at the OS level and nobody's actually 'solving' them.</p>\n"}], "owner": {"reputation": 41, "user_id": 4949108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2837460bb3c97967fc88efd0dcfbb79?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/4949108/cameron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11685, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1434561182, "creation_date": 1434553610, "last_edit_date": 1531161705, "question_id": 30895486, "link": "https://stackoverflow.com/questions/30895486/how-to-save-to-current-user-desktop-location", "title": "How to save to current User\\Desktop location", "body": "<p>So I am trying to save an excel worksheet as a .PRN file to the current users desktop. I thought maybe there was a standard \"wildcard\" operator that I could use, but I don't see that anywhere. I have looked through stack overflow and I found information that is probably what I am looking for, but due to me not being a programmer and not very good with excel, I don't know if it is what I want and if it is, where to put it in my code. </p>\n\n<p>This is what I am currently running that only works on my machine:</p>\n\n<pre><code>Sub Save_PRN()\nDim fileName As String\nfileName = \"C:\\Users\\cameron\\Desktop\\PRN Test files\\\" &amp; Range(\"'Customer_Info'!R2\").Text &amp; \".prn\"\nActiveWorkbook.SaveAs fileName:=fileName, FileFormat:=xlTextPrinter, Password:=\"\", WriteResPassword:=\"\", ReadOnlyRecommended:=False, CreateBackup:=False\nEnd Sub\n</code></pre>\n\n<p>While it does what I want, when I upload it to our share, clearly another user won't be able to use it. I saw on a question someone answered stating to use this:</p>\n\n<pre><code>MsgBox CreateObject(\"WScript.Shell\").specialfolders(\"Desktop\")\n</code></pre>\n\n<p>But I don't know or understand how to incorporate that into my macro above. Any help or advice would be great. Am I even on the right track?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13509, "user_id": 1389394, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/14a225b416674b1d9fb6cf14554d5054?s=128&d=identicon&r=PG", "display_name": "bonCodigo", "link": "https://stackoverflow.com/users/1389394/boncodigo"}, "edited": false, "score": 0, "creation_date": 1434553915, "post_id": 30895218, "comment_id": 49830255, "body": "<code>Dictionary</code> was my <i>unique</i> value holder... <code>If Not dict.exists(theValue) Then             dict.Add theValue, theValue</code> but you want duplicates?"}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "reply_to_user": {"reputation": 13509, "user_id": 1389394, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/14a225b416674b1d9fb6cf14554d5054?s=128&d=identicon&r=PG", "display_name": "bonCodigo", "link": "https://stackoverflow.com/users/1389394/boncodigo"}, "edited": false, "score": 0, "creation_date": 1434554047, "post_id": 30895218, "comment_id": 49830363, "body": "Yes, I was brand new to VBA at that point so I did not realize when I said I need a unique range that omitting duplicates would be a part of that. I simply meant not a consistent range which was very misleading. My apologies for that. Yes, I need to include duplicates now. Any tips? @bonCodigo"}, {"owner": {"reputation": 13509, "user_id": 1389394, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/14a225b416674b1d9fb6cf14554d5054?s=128&d=identicon&r=PG", "display_name": "bonCodigo", "link": "https://stackoverflow.com/users/1389394/boncodigo"}, "edited": false, "score": 0, "creation_date": 1434554651, "post_id": 30895218, "comment_id": 49830795, "body": "<code>1</code> As said, if duplicates are needed, a <code>Dictionary</code> object isn&#39;t the one to use. You may go for an <code>ArrayList</code> instead. <code>2</code> Why is your key and the value the same? e.g. <code>theValue</code>"}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "reply_to_user": {"reputation": 13509, "user_id": 1389394, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/14a225b416674b1d9fb6cf14554d5054?s=128&d=identicon&r=PG", "display_name": "bonCodigo", "link": "https://stackoverflow.com/users/1389394/boncodigo"}, "edited": false, "score": 0, "creation_date": 1434555003, "post_id": 30895218, "comment_id": 49831058, "body": "It was grabbing the column header whenever the cell was empty. @ChipsLetten helped me fix that issue in this post <a href=\"http://stackoverflow.com/questions/30868395/vba-do-not-grab-header-in-range/30874231?noredirect=1#comment49828696_30874231\" title=\"vba do not grab header in range\">stackoverflow.com/questions/30868395/&hellip;</a>"}, {"owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "reply_to_user": {"reputation": 13509, "user_id": 1389394, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/14a225b416674b1d9fb6cf14554d5054?s=128&d=identicon&r=PG", "display_name": "bonCodigo", "link": "https://stackoverflow.com/users/1389394/boncodigo"}, "edited": false, "score": 0, "creation_date": 1434555067, "post_id": 30895218, "comment_id": 49831109, "body": "Could you help me with implementing the ArrayList instead? I got it to work with the Dictionary but I am not sure what would need to be altered in order to switch it to an ArrayList or even how that works @bonCodigo"}], "answers": [{"tags": [], "owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "is_accepted": false, "score": 0, "last_activity_date": 1434721457, "creation_date": 1434721457, "answer_id": 30939747, "question_id": 30895218, "link": "https://stackoverflow.com/questions/30895218/vba-change-omit-duplicates-to-allow-for-duplicates/30939747#30939747", "title": "VBA - change omit duplicates to allow for duplicates", "body": "<p><strong>SOLUTION:</strong></p>\n\n<pre><code>'(8)\n'Get the Values from columns with specified headers\nFunction GetValues(ch As Range, Optional vSplit As Variant) As Scripting.Dictionary\n    Dim dict As Scripting.Dictionary\n    Dim dataRange As Range\n    Dim cell As Range\n    Dim theValue As String\n    Dim splitValues As Variant\n    Dim counter As Long\nSet dict = New Scripting.Dictionary\nSet dataRange = ch.Parent.Range(ch, ch.Parent.Cells(Rows.count, ch.Column).End(xlUp)).Cells\n' If there are no values in this column then return an empty dictionary\n' If there are no values in this column, the dataRange will start at the row\n' *above* ch and end at ch\nIf (dataRange.Row = (ch.Row - 1)) And (dataRange.Rows.count = 2) And (Trim(ch.Value) = \"\") Then\n    GoTo Exit_Function\nEnd If\n\nFor Each cell In dataRange.Cells\n    counter = counter + 1\n    theValue = Trim(cell.Value)\n    If Len(theValue) = 0 Then\n        theValue = \" \"\n    End If\n        'exclude any info after \";\"\n        If Not IsMissing(vSplit) Then\n            splitValues = Split(theValue, \";\")\n            theValue = splitValues(0)\n        End If\n        'exclude any info after \",\"\n        If Not IsMissing(vSplit) Then\n            splitValues = Split(theValue, \",\")\n            theValue = splitValues(0)\n        End If\n\n        If Not dict.exists(theValue) Then\n        dict.Add counter, theValue\n    End If\nNext cell\nExit_Function:\nSet GetValues = dict\n End Function\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 4950506, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9894fea9fdda4e4aa90ccb7d90549af2?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/4950506/taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1434721457, "creation_date": 1434552938, "last_edit_date": 1434554079, "question_id": 30895218, "link": "https://stackoverflow.com/questions/30895218/vba-change-omit-duplicates-to-allow-for-duplicates", "title": "VBA - change omit duplicates to allow for duplicates", "body": "<p><strong>Explanation of code:</strong></p>\n\n<p>I have code that takes information from under two specific column headers in opening files and prints them to a masterfile. It prints information to my masterfile into column 3, then column 2, then column 1 based on the number of cells is in column 3. The columns 1, 2 and 3 should always be the same length (spaces included)</p>\n\n<p>I currently use a GetValue function which finds a specific header such as HOLDER, and grabs all of the values under it from the last occupied row up to, but not including, the header HOLDER. It omits any duplicates.</p>\n\n<p><strong>The problem</strong> is that I need to have the duplicates in the sheet. The reason is that the 2nd and 3rd column values correspond to each other. So if a duplicate does not print to column 3, that doesn't mean there is a duplicate in column 2.</p>\n\n<p>Example:</p>\n\n<pre><code>    3  4   \n    2  4   \n    1  7   \n *next file*\n    1  9\n    7  6\n</code></pre>\n\n<p>would become</p>\n\n<pre><code>   3  4\n   2  7\n   1  9\n*next file*\n   1  6\n   7\n</code></pre>\n\n<p><em>(column 2 is shifted upward due to the omitting of the repeat value \"4\". The 1 in column 1 is not omitted because it only omits duplicates that are within the same opened file in the same column)</em></p>\n\n<p>Thus, I do not get the information I need for that duplicate (using my example, that 2 and 4 should correspond not 2 and 7), and my column alignment is thrown off.</p>\n\n<p>Any ideas how I can go about fixing this please?</p>\n\n<p><strong>Uses the GetValues function</strong>:</p>\n\n<pre><code>'(3)\n    'find CUTTING TOOL on the source sheet\n    If Not ws.Range(\"A1:M15\").Find(What:=\"CUTTING TOOL\", LookAt:=xlWhole, LookIn:=xlValues) Is Nothing Then\n        Set hc = ws.Range(\"A1:M15\").Find(What:=\"CUTTING TOOL\", LookAt:=xlWhole, LookIn:=xlValues)\n        Set dict = GetValues(hc.Offset(1, 0), \"SplitMe\")\n        If dict.count &gt; 0 Then\n            'add the values to the master list, column 3\n            Set d = StartSht.Cells(Rows.count, hc2.Column).End(xlUp).Offset(1, 0)\n            d.Resize(dict.count, 1).Value = Application.Transpose(dict.items)\n        Else\n            'if no items are under the CUTTING TOOL header\n            StartSht.Cells(Rows.count, hc2.Column).End(xlUp).Offset(1, 0) = \"  \"\n        End If\n    'Else find CUTTING WHEEL on the source sheet\n    ElseIf Not ws.Range(\"A1:M15\").Find(What:=\"CUTTING WHEEL\", LookAt:=xlWhole, LookIn:=xlValues) Is Nothing Then\n        Set hc = ws.Range(\"A1:M15\").Find(What:=\"CUTTING WHEEL\", LookAt:=xlWhole, LookIn:=xlValues)\n        Set dict = GetValues(hc.Offset(1, 0), \"SplitMe\")\n        If dict.count &gt; 0 Then\n            'add the values to the master list, column 3\n            Set d = StartSht.Cells(Rows.count, hc2.Column).End(xlUp).Offset(1, 0)\n            d.Resize(dict.count, 1).Value = Application.Transpose(dict.items)\n        Else\n            'if no items are under the CUTTING TOOL header\n            StartSht.Cells(Rows.count, hc2.Column).End(xlUp).Offset(1, 0) = \"  \"\n        End If\n    Else\n        'if no CUTTING TOOL header is found on the sheet\n        StartSht.Cells(Rows.count, hc2.Column).End(xlUp).Offset(1, 0) = \"NO CUTTING TOOLS PRESENT\"\n    End If\n'(4)\n    'find HOLDER on the source sheet\n     If Not ws.Range(\"A1:M15\").Find(What:=\"HOLDER\", LookAt:=xlWhole, LookIn:=xlValues) Is Nothing Then\n         Set hc3 = ws.Range(\"A1:M15\").Find(What:=\"HOLDER\", LookAt:=xlWhole, LookIn:=xlValues)\n         Set dict = GetValues(hc3.Offset(1, 0))\n         If dict.count &gt; 0 Then\n             'add the values to the master list, column 2\n             Set d = StartSht.Cells(Rows.count, hc1.Column).End(xlUp).Offset(1, 0)\n             d.Resize(dict.count, 1).Value = Application.Transpose(dict.items)\n         Else\n             'if no items are under the HOLDER header\n              StartSht.Range(StartSht.Cells(i, 2), StartSht.Cells(GetLastRowInColumn(StartSht, \"C\"), 1)) = \" \"\n         End If\n     'Else find WHEEL ARBOR on the source sheet\n      ElseIf Not ws.Range(\"A1:M15\").Find(What:=\"WHEEL ARBOR\", LookAt:=xlWhole, LookIn:=xlValues) Is Nothing Then\n          Set hc3 = ws.Range(\"A1:M15\").Find(What:=\"WHEEL ARBOR\", LookAt:=xlWhole, LookIn:=xlValues)\n          Set dict = GetValues(hc3.Offset(1, 0))\n          If dict.count &gt; 0 Then\n              'add the values to the master list, column 2\n              Set d = StartSht.Cells(Rows.count, hc1.Column).End(xlUp).Offset(1, 0)\n              d.Resize(dict.count, 1).Value = Application.Transpose(dict.items)\n          Else\n          'if no items are under the HOLDER header\n              StartSht.Range(StartSht.Cells(i, 2), StartSht.Cells(GetLastRowInColumn(StartSht, \"C\"), 1)) = \" \"\n          End If\n      Else\n          'if no HOLDER header is found on the sheet\n          StartSht.Range(StartSht.Cells(i, 2), StartSht.Cells(GetLastRowInColumn(StartSht, \"C\"), 1)) = \"NO HOLDERS PRESENT!\"\n      End If\n</code></pre>\n\n<p><strong>GetValues Function</strong>:</p>\n\n<pre><code>'(8)\n'get all unique column values starting at cell c\nFunction GetValues(ch As Range, Optional vSplit As Variant) As Scripting.Dictionary\n\n    Dim dict As Scripting.Dictionary\n    Dim dataRange As Range\n    Dim cell As Range\n    Dim theValue As String\n    Dim splitValues As Variant\n\n    Set dict = New Scripting.Dictionary\n    Set dataRange = ch.Parent.Range(ch, ch.Parent.Cells(Rows.count, ch.Column).End(xlUp)).Cells\n    ' If there are no values in this column then return an empty dictionary\n    ' If there are no values in this column, the dataRange will start at the row\n    ' *above* ch and end at ch\n    If (dataRange.Row = (ch.Row - 1)) And (dataRange.Rows.count = 2) And (Trim(ch.Value) = \"\") Then\n        GoTo Exit_Function\n    End If\n\n    For Each cell In dataRange.Cells\n        theValue = Trim(cell.Value)\n        If Len(theValue) = 0 Then\n            theValue = \"none\"\n        End If\n            'exclude any info after \";\"\n            If Not IsMissing(vSplit) Then\n                splitValues = Split(theValue, \";\")\n                theValue = splitValues(0)\n            End If\n            'exclude any info after \",\"\n            If Not IsMissing(vSplit) Then\n                splitValues = Split(theValue, \",\")\n                theValue = splitValues(0)\n            End If\n\n            If Not dict.exists(theValue) Then\n            dict.Add theValue, theValue\n        End If\n    Next cell\nExit_Function:\n    Set GetValues = dict\nEnd Function\n</code></pre>\n\n<p><strong>FULL CODE:</strong></p>\n\n<pre><code>Option Explicit\n\nSub LoopThroughDirectory()\n\n    Const ROW_HEADER As Long = 10\n\n    Dim objFSO As Object\n    Dim objFolder As Object\n    Dim objFile As Object\n    Dim dict As Object\n    Dim MyFolder As String\n    Dim f As String\n    Dim StartSht As Worksheet, ws As Worksheet\n    Dim WB As Workbook\n    Dim i As Integer\n    Dim LastRow As Integer, erow As Integer\n    Dim Height As Integer\n    Dim FinalRow As Long\n    Dim hc As Range, hc1 As Range, hc2 As Range, hc3 As Range, hc4 As Range, d As Range\n    Dim TDS As Range\n    Dim hc12 As Range, n As Range\n\n    Set StartSht = Workbooks(\"masterfile.xlsm\").Sheets(\"Sheet1\")\n\n    'turn screen updating off - makes program faster\n    Application.ScreenUpdating = False\n\n    'location of the folder in which the desired TDS files are\n    MyFolder = \"C:\\Users\\trembos\\Documents\\TDS\\progress\\\"\n\n    'find the headers on the sheet\n    Set hc1 = HeaderCell(StartSht.Range(\"B1\"), \"HOLDER\")\n    Set hc2 = HeaderCell(StartSht.Range(\"C1\"), \"CUTTING TOOL\")\n    Set hc4 = HeaderCell(StartSht.Range(\"A1\"), \"TOOLING DATA SHEET (TDS):\")\n\n    'create an instance of the FileSystemObject\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    'get the folder object\n    Set objFolder = objFSO.GetFolder(MyFolder)\n    i = 2\n\n    'loop through directory file and print names\n'(1)\n    For Each objFile In objFolder.Files\n        If LCase(Right(objFile.Name, 3)) = \"xls\" Or LCase(Left(Right(objFile.Name, 4), 3)) = \"xls\" Then\n'(2)\n            'Open folder and file name, do not update links\n            Set WB = Workbooks.Open(FileName:=MyFolder &amp; objFile.Name, UpdateLinks:=0)\n            Set ws = WB.ActiveSheet\n\n            With WB\n                For Each ws In .Worksheets\n'(3)\n                'find CUTTING TOOL on the source sheet\n                If Not ws.Range(\"A1:M15\").Find(What:=\"CUTTING TOOL\", LookAt:=xlWhole, LookIn:=xlValues) Is Nothing Then\n                Set hc = ws.Range(\"A1:M15\").Find(What:=\"CUTTING TOOL\", LookAt:=xlWhole, LookIn:=xlValues)\n                    Set dict = GetValues(hc.Offset(1, 0), \"SplitMe\")\n                    If dict.count &gt; 0 Then\n                    'add the values to the master list, column 3\n                        Set d = StartSht.Cells(Rows.count, hc2.Column).End(xlUp).Offset(1, 0)\n                        d.Resize(dict.count, 1).Value = Application.Transpose(dict.items)\n                    Else\n                        'if no items are under the CUTTING TOOL header\n                        StartSht.Cells(Rows.count, hc2.Column).End(xlUp).Offset(1, 0) = \"  \"\n                    End If\n                'Else find CUTTING WHEEL on the source sheet\n                ElseIf Not ws.Range(\"A1:M15\").Find(What:=\"CUTTING WHEEL\", LookAt:=xlWhole, LookIn:=xlValues) Is Nothing Then\n                    Set hc = ws.Range(\"A1:M15\").Find(What:=\"CUTTING WHEEL\", LookAt:=xlWhole, LookIn:=xlValues)\n                        Set dict = GetValues(hc.Offset(1, 0), \"SplitMe\")\n                        If dict.count &gt; 0 Then\n                        'add the values to the master list, column 3\n                            Set d = StartSht.Cells(Rows.count, hc2.Column).End(xlUp).Offset(1, 0)\n                            d.Resize(dict.count, 1).Value = Application.Transpose(dict.items)\n                        Else\n                        'if no items are under the CUTTING TOOL header\n                        StartSht.Cells(Rows.count, hc2.Column).End(xlUp).Offset(1, 0) = \"  \"\n                End If\n                Else\n                    'if no CUTTING TOOL header is found on the sheet\n                    StartSht.Cells(Rows.count, hc2.Column).End(xlUp).Offset(1, 0) = \"NO CUTTING TOOLS PRESENT\"\n                End If\n'(4)\n                'find HOLDER on the source sheet\n                If Not ws.Range(\"A1:M15\").Find(What:=\"HOLDER\", LookAt:=xlWhole, LookIn:=xlValues) Is Nothing Then\n                Set hc3 = ws.Range(\"A1:M15\").Find(What:=\"HOLDER\", LookAt:=xlWhole, LookIn:=xlValues)\n                    Set dict = GetValues(hc3.Offset(1, 0))\n                    If dict.count &gt; 0 Then\n                        'add the values to the master list, column 2\n                        Set d = StartSht.Cells(Rows.count, hc1.Column).End(xlUp).Offset(1, 0)\n                        d.Resize(dict.count, 1).Value = Application.Transpose(dict.items)\n                    Else\n                        'if no items are under the HOLDER header\n                        StartSht.Range(StartSht.Cells(i, 2), StartSht.Cells(GetLastRowInColumn(StartSht, \"C\"), 1)) = \" \"\n                    End If\n                'Else find WHEEL ARBOR on the source sheet\n                ElseIf Not ws.Range(\"A1:M15\").Find(What:=\"WHEEL ARBOR\", LookAt:=xlWhole, LookIn:=xlValues) Is Nothing Then\n                    Set hc3 = ws.Range(\"A1:M15\").Find(What:=\"WHEEL ARBOR\", LookAt:=xlWhole, LookIn:=xlValues)\n                        Set dict = GetValues(hc3.Offset(1, 0))\n                        If dict.count &gt; 0 Then\n                            'add the values to the master list, column 2\n                            Set d = StartSht.Cells(Rows.count, hc1.Column).End(xlUp).Offset(1, 0)\n                            d.Resize(dict.count, 1).Value = Application.Transpose(dict.items)\n                        Else\n                            'if no items are under the HOLDER header\n                            StartSht.Range(StartSht.Cells(i, 2), StartSht.Cells(GetLastRowInColumn(StartSht, \"C\"), 1)) = \" \"\n                        End If\n                Else\n                    'if no HOLDER header is found on the sheet\n                    StartSht.Range(StartSht.Cells(i, 2), StartSht.Cells(GetLastRowInColumn(StartSht, \"C\"), 1)) = \"NO HOLDERS PRESENT!\"\n                End If\n'(5)\n                'print the file name to Column 4\n                StartSht.Cells(i, 4) = objFile.Name\n\n                With ws\n                'Print TDS name by searching for header\n                    If Not ws.Range(\"A1:K1\").Find(What:=\"TOOLING DATA SHEET (TDS):\", LookAt:=xlWhole, LookIn:=xlValues) Is Nothing Then\n                        Set TDS = ws.Range(\"A1:K1\").Find(What:=\"TOOLING DATA SHEET (TDS):\", LookAt:=xlWhole, LookIn:=xlValues).Offset(, 1)\n                        StartSht.Range(StartSht.Cells(i, 1), StartSht.Cells(GetLastRowInColumn(StartSht, \"C\"), 1)) = TDS\n                    Else\n                        'print the file name wihtout the extension\n                        StartSht.Range(StartSht.Cells(i, 1), StartSht.Cells(GetLastRowInColumn(StartSht, \"C\"), 1)) = GetFilenameWithoutExtension(objFile.Name)\n                    End If\n                    i = GetLastRowInSheet(StartSht) + 1\n                End With\n\n                Next ws\n'(6)\n                'close, do not save any changes to the opened files\n                .Close SaveChanges:=False\n            End With\n        End If\n'(7)\n    'move to next file\n    Next objFile\n    'turn screen updating back on\n    Application.ScreenUpdating = True\n    ActiveWindow.ScrollRow = 1 'brings the viewer to the top of the masterfile\nEnd Sub\n'(8)\n'get all unique column values starting at cell c\nFunction GetValues(ch As Range, Optional vSplit As Variant) As Scripting.Dictionary\n\n    Dim dict As Scripting.Dictionary\n    Dim dataRange As Range\n    Dim cell As Range\n    Dim theValue As String\n    Dim splitValues As Variant\n\n    Set dict = New Scripting.Dictionary\n    Set dataRange = ch.Parent.Range(ch, ch.Parent.Cells(Rows.count, ch.Column).End(xlUp)).Cells\n    ' If there are no values in this column then return an empty dictionary\n    ' If there are no values in this column, the dataRange will start at the row\n    ' *above* ch and end at ch\n    If (dataRange.Row = (ch.Row - 1)) And (dataRange.Rows.count = 2) And (Trim(ch.Value) = \"\") Then\n        GoTo Exit_Function\n    End If\n\n    For Each cell In dataRange.Cells\n        theValue = Trim(cell.Value)\n        If Len(theValue) = 0 Then\n            theValue = \"none\"\n        End If\n            'exclude any info after \";\"\n            If Not IsMissing(vSplit) Then\n                splitValues = Split(theValue, \";\")\n                theValue = splitValues(0)\n            End If\n            'exclude any info after \",\"\n            If Not IsMissing(vSplit) Then\n                splitValues = Split(theValue, \",\")\n                theValue = splitValues(0)\n            End If\n\n            If Not dict.exists(theValue) Then\n            dict.Add theValue, theValue\n        End If\n    Next cell\nExit_Function:\n    Set GetValues = dict\nEnd Function\n'(9)\n'find a header on a row: returns Nothing if not found\nFunction HeaderCell(rng As Range, sHeader As String) As Range\n    Dim rv As Range, c As Range\n    For Each c In rng.Parent.Range(rng, rng.Parent.Cells(rng.Row, Columns.count).End(xlToLeft)).Cells\n        'copy cell value if it contains some string \"holder\" or \"cutting tool\"\n        If Trim(c.Value) = sHeader Then\n        'If InStr(c.Value, sHeader) &lt;&gt; 0 Then\n            Set rv = c\n            Exit For\n        End If\n    Next c\n    Set HeaderCell = rv\nEnd Function\n'(10)\nFunction GetLastRowInColumn(theWorksheet As Worksheet, col As String)\n    With theWorksheet\n        GetLastRowInColumn = .Range(col &amp; .Rows.count).End(xlUp).Row\n    End With\nEnd Function\n'(11)\nFunction GetLastRowInSheet(theWorksheet As Worksheet)\nDim ret\n    With theWorksheet\n        If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n            ret = .Cells.Find(What:=\"*\", _\n                          After:=.Range(\"A1\"), _\n                          LookAt:=xlPart, _\n                          LookIn:=xlFormulas, _\n                          SearchOrder:=xlByRows, _\n                          SearchDirection:=xlPrevious, _\n                          MatchCase:=False).Row\n        Else\n            ret = 1\n        End If\n    End With\n    GetLastRowInSheet = ret\nEnd Function\n'(12)\n'get the file name without the extension\nFunction GetFilenameWithoutExtension(ByVal FileName)\n  Dim Result, i\n  Result = FileName\n  i = InStrRev(FileName, \".\")\n  If (i &gt; 0) Then\n    Result = Mid(FileName, 1, i - 1)\n  End If\n  GetFilenameWithoutExtension = Result\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1434554068, "post_id": 30895029, "comment_id": 49830382, "body": "This code works for me. Are you sure <code>wks</code> is a properly assigned worksheet object, and <code>colStart</code> and <code>colEnd</code> are &gt;0 whole numbers? Are you sure the worksheet is not protected? Can you post some more of your code?"}], "answers": [{"comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 1, "creation_date": 1434554917, "post_id": 30895887, "comment_id": 49830996, "body": "Well, they are actually strings, not numbers. I&#39;ll post an answer, but you need to declare your variables."}, {"owner": {"reputation": 402, "user_id": 4338647, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/39bd6fdd4e35b42796572b63d3d9f0b5?s=128&d=identicon&r=PG&f=1", "display_name": "Nandish", "link": "https://stackoverflow.com/users/4338647/nandish"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1434555045, "post_id": 30895887, "comment_id": 49831089, "body": "Actually I have declared my variables in my code. The code is too long so not able to paste the whole code here."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 1, "creation_date": 1434555111, "post_id": 30895887, "comment_id": 49831145, "body": "Ok, so why does it say Type: &quot;string&quot; in your watches window?"}, {"owner": {"reputation": 402, "user_id": 4338647, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/39bd6fdd4e35b42796572b63d3d9f0b5?s=128&d=identicon&r=PG&f=1", "display_name": "Nandish", "link": "https://stackoverflow.com/users/4338647/nandish"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1434555298, "post_id": 30895887, "comment_id": 49831274, "body": "Thanks Vacip. I got my mistake. My variables are string. My bad. Thanks a lot"}], "tags": [], "owner": {"reputation": 402, "user_id": 4338647, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/39bd6fdd4e35b42796572b63d3d9f0b5?s=128&d=identicon&r=PG&f=1", "display_name": "Nandish", "link": "https://stackoverflow.com/users/4338647/nandish"}, "is_accepted": false, "score": 0, "last_activity_date": 1434554718, "creation_date": 1434554718, "answer_id": 30895887, "question_id": 30895029, "link": "https://stackoverflow.com/questions/30895029/delete-the-range-of-columns-in-excel-vba/30895887#30895887", "title": "Delete the Range of Columns in Excel VBA", "body": "<p><img src=\"https://i.stack.imgur.com/xnl3I.png\" alt=\"enter image description here\"></p>\n\n<p>Yes vacip the colStart and colEnd has integer values as you can see in watch screen of my image. And also wks is properly assigned worksheet object. </p>\n"}, {"tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": true, "score": 2, "last_activity_date": 1434555010, "creation_date": 1434555010, "answer_id": 30896004, "question_id": 30895029, "link": "https://stackoverflow.com/questions/30895029/delete-the-range-of-columns-in-excel-vba/30896004#30896004", "title": "Delete the Range of Columns in Excel VBA", "body": "<p>Declare your variables. <strong>Always.</strong></p>\n\n<pre><code>dim colStart as long\ndim colEnd as long\ndim wks as Worksheet\n</code></pre>\n\n<p>It should work this way.</p>\n"}], "owner": {"reputation": 402, "user_id": 4338647, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/39bd6fdd4e35b42796572b63d3d9f0b5?s=128&d=identicon&r=PG&f=1", "display_name": "Nandish", "link": "https://stackoverflow.com/users/4338647/nandish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 609, "favorite_count": 0, "accepted_answer_id": 30896004, "answer_count": 2, "score": 0, "last_activity_date": 1434555010, "creation_date": 1434552461, "question_id": 30895029, "link": "https://stackoverflow.com/questions/30895029/delete-the-range-of-columns-in-excel-vba", "title": "Delete the Range of Columns in Excel VBA", "body": "<p>I am trying to delete the range of columns but getting error \"Application Defined or object defined error\". In the below code wks is the worksheet and colStart and colEnd are variables with values.</p>\n\n<pre><code>Dim colDelete As String\n\ncolDelete = wks.Range(wks.Cells(1, colStart), wks.Cells(1, colEnd)).EntireColumn.Delete\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 4, "creation_date": 1434552476, "post_id": 30894978, "comment_id": 49829128, "body": "You need <code>Dim theChart as Chart</code> in your calling routine."}, {"owner": {"reputation": 1149, "user_id": 3642601, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/FBgk9.jpg?s=128&g=1", "display_name": "MatthewHagemann", "link": "https://stackoverflow.com/users/3642601/matthewhagemann"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1434552657, "post_id": 30894978, "comment_id": 49829280, "body": "Wow. Thank you @Rory.  That did it"}, {"owner": {"reputation": 13509, "user_id": 1389394, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/14a225b416674b1d9fb6cf14554d5054?s=128&d=identicon&r=PG", "display_name": "bonCodigo", "link": "https://stackoverflow.com/users/1389394/boncodigo"}, "edited": false, "score": 1, "creation_date": 1434552911, "post_id": 30894978, "comment_id": 49829490, "body": "You could pass it as a reference <code>ByRef theChart as Chart</code> or as a value <code>ByVal theChart as Chart</code>. Given Chart is object type, by reference is preferred."}, {"owner": {"reputation": 13509, "user_id": 1389394, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/14a225b416674b1d9fb6cf14554d5054?s=128&d=identicon&r=PG", "display_name": "bonCodigo", "link": "https://stackoverflow.com/users/1389394/boncodigo"}, "edited": false, "score": 1, "creation_date": 1434553267, "post_id": 30894978, "comment_id": 49829798, "body": "Also <b>don&#39;t forget to provide the correct data type for the other two variables</b> in your sub. <i>e.g. the Min, the Max</i>"}], "owner": {"reputation": 1149, "user_id": 3642601, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/FBgk9.jpg?s=128&g=1", "display_name": "MatthewHagemann", "link": "https://stackoverflow.com/users/3642601/matthewhagemann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 306, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1434568147, "creation_date": 1434552341, "last_edit_date": 1434568147, "question_id": 30894978, "link": "https://stackoverflow.com/questions/30894978/why-cant-i-pass-a-chart-to-my-subroutine", "title": "Why cant I pass a chart to my subroutine", "body": "<p>I have a SubRoutine with the following signature:</p>\n\n<pre><code>Sub SetChartGraphScale(theChart As Chart, theMin, theMax)\n</code></pre>\n\n<p>In another SubRoutine, I can call SetChartGraphScale and it behaves as expected:</p>\n\n<pre><code>Set theChartObject = .ChartObjects.Add( _\n        Left:=0, Top:=50, Width:=.100, Height:=50)\nSetChartGraphScale theChartObject.Chart, 0, 30\n</code></pre>\n\n<p>But when I try to call it from a different SubRoutine:</p>\n\n<pre><code>Set theChart = Charts.Add\nSetChartGraphScale theChart, 0, 30\n</code></pre>\n\n<p>I get this error:</p>\n\n<p><img src=\"https://i.stack.imgur.com/2FwLb.png\" alt=\"enter image description here\"></p>\n\n<p>But if I call using ActiveChart, everything works fine:</p>\n\n<pre><code>Set theChart = Charts.Add\nSetChartGraphScale ActiveChart, 0, 30\n</code></pre>\n\n<p>According to <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196568(v=office.14).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff196568(v=office.14).aspx</a>, Charts.Add returns a Chart, so I don't understand why I can't pass it through to SetChartGraphScale.  I can send the ActiveChart as a workaround, but I really want to understand why this isn't behaving as I think it should. </p>\n\n<p>I am trying to avoid ActiveSheet, ActiveChart, etc as much as possible to protect against screwing things up if the user is clicking around while the macro is running.</p>\n"}, {"tags": ["c#", "vba", "ms-word", "readonly"], "comments": [{"owner": {"reputation": 2177, "user_id": 1211997, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/289e883b1531a6c68ce799642e3b918e?s=128&d=identicon&r=PG", "display_name": "rheitzman", "link": "https://stackoverflow.com/users/1211997/rheitzman"}, "edited": false, "score": 0, "creation_date": 1434553369, "post_id": 30894135, "comment_id": 49829881, "body": "Seems like you start with a contradiction - open read only then remove some pages? What are you trying to accomplish in the big picture?"}, {"owner": {"reputation": 783, "user_id": 916776, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b94f84a8ae5fe3963f05745df6861d87?s=128&d=identicon&r=PG", "display_name": "Holger Leichsenring", "link": "https://stackoverflow.com/users/916776/holger-leichsenring"}, "reply_to_user": {"reputation": 2177, "user_id": 1211997, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/289e883b1531a6c68ce799642e3b918e?s=128&d=identicon&r=PG", "display_name": "rheitzman", "link": "https://stackoverflow.com/users/1211997/rheitzman"}, "edited": false, "score": 0, "creation_date": 1434554424, "post_id": 30894135, "comment_id": 49830618, "body": "good point, thanks for the hint, I updated the question."}], "answers": [{"comments": [{"owner": {"reputation": 783, "user_id": 916776, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b94f84a8ae5fe3963f05745df6861d87?s=128&d=identicon&r=PG", "display_name": "Holger Leichsenring", "link": "https://stackoverflow.com/users/916776/holger-leichsenring"}, "edited": false, "score": 0, "creation_date": 1434636079, "post_id": 30894952, "comment_id": 49872281, "body": "Actually the loop has been taken out from the source of the link above, I already fixed that behavior and did it like you suggested. Does work perfectly, thanks!"}], "tags": [], "owner": {"reputation": 376, "user_id": 4923873, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DhWgKqXsXdc/AAAAAAAAAAI/AAAAAAAAADk/U8ZMjBul1e4/photo.jpg?sz=128", "display_name": "Charlie", "link": "https://stackoverflow.com/users/4923873/charlie"}, "is_accepted": true, "score": 0, "last_activity_date": 1434618775, "last_edit_date": 1434618775, "creation_date": 1434552280, "answer_id": 30894952, "question_id": 30894135, "link": "https://stackoverflow.com/questions/30894135/how-to-manipulate-a-word-2013-document-opened-in-read-only-mode/30894952#30894952", "title": "How to manipulate a Word 2013 document opened in read only mode", "body": "<p>In order to turn off ReadingMode your need to put this at the beginning of your code <code>Globals.ThisAddIn.Application.Options.AllowReadingMode = false;</code></p>\n\n<p>You may get errors because of the direction of your loop. Your first page is page 1 once you delete this then page 2 becomes page 1 etc</p>\n\n<p>If you reverse this and remove the last page first then it will remove the correct page.</p>\n\n<pre><code>    public void TestCallBack1(Office.IRibbonControl control)\n    {\n        Globals.ThisAddIn.Application.Options.AllowReadingMode = false;\n        //\"S:\\Test doc.docx\"\n        Word.Document doc = Globals.ThisAddIn.Application.Documents.Open(\"S:\\\\Test doc.docx\",Type.Missing,true);\n        int num = doc.ComputeStatistics(Word.WdStatistic.wdStatisticPages, Type.Missing);\n        int[] a = { 5, 3, 1 };\n        for (int i = 0; i &lt; a.Length; i++)\n        {\n            object page_num = a[i];\n            Globals.ThisAddIn.Application.Selection.GoTo(Word.WdGoToItem.wdGoToPage, Word.WdGoToDirection.wdGoToAbsolute, num, page_num);\n            Globals.ThisAddIn.Application.Selection.Bookmarks[@\"\\Page\"].Select();\n            Globals.ThisAddIn.Application.Selection.Delete();\n        }\n        Globals.ThisAddIn.Application.Options.AllowReadingMode = true;\n    }\n</code></pre>\n\n<p>Hope this helps. My sample above is from a Application level addin. I've tested it on 2013 and it appears to work</p>\n"}], "owner": {"reputation": 783, "user_id": 916776, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b94f84a8ae5fe3963f05745df6861d87?s=128&d=identicon&r=PG", "display_name": "Holger Leichsenring", "link": "https://stackoverflow.com/users/916776/holger-leichsenring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2157, "favorite_count": 0, "accepted_answer_id": 30894952, "answer_count": 1, "score": -1, "last_activity_date": 1434618775, "creation_date": 1434550342, "last_edit_date": 1495540235, "question_id": 30894135, "link": "https://stackoverflow.com/questions/30894135/how-to-manipulate-a-word-2013-document-opened-in-read-only-mode", "title": "How to manipulate a Word 2013 document opened in read only mode", "body": "<p>I have to open Word documents for automation in read only mode. Then I have to remove some certain pages from that document, regarding some configuration the user did in the user interface of the program.</p>\n\n<p>Manipulation does work for footers and headers, but this particular code doesn't work. It breaks with error <em>System.Runtime.InteropServices.COMException (0x800A11FD): This method or property is not available because this command is not available for reading.</em> when executing this code:</p>\n\n<pre><code> int num = objWordDoc.ComputeStatistics(stat, ref missing);\n int[] a = { 1,3,5};\n for (int i = 0; i &lt; a.Length; i++)\n {\n    object page_num = a[i];\n    objWordDoc.Application.Selection.GoTo(Word.WdGoToItem.wdGoToPage,\n        Word.WdGoToDirection.wdGoToAbsolute, num, page_num);\n    objWordDoc.Application.Selection.Bookmarks[@\"\\Page\"].Select();\n    objWordDoc.Application.Selection.Delete();\n }\n</code></pre>\n\n<p>in the line where Selection.Goto is called. This code has been taken from <a href=\"https://stackoverflow.com/q/17917077\">How to delete pages in a word document dynamically</a>.</p>\n\n<p>Working with the document does work, when the user has followed the procedure described in <a href=\"http://myitforum.com/myitforumwp/2013/06/10/disable-reading-mode-and-protected-view-in-word-2013/\" rel=\"nofollow noreferrer\">http://myitforum.com/myitforumwp/2013/06/10/disable-reading-mode-and-protected-view-in-word-2013/</a>. Mainly a setting has to be disabled:\n<em>To disable the Reading View. Go to File \u2013 Options \u2013 General.  Uncheck \u201cOpen E-Mail attachments and other uneditable files in reading view\u201d</em></p>\n\n<p>This only seems to be necessary for Word 2013, as Word 2010 works fine. Is it possible to force edit mode programmatically without the necessity to let the user define those settings?</p>\n\n<p>--- UPDATE ---</p>\n\n<p>Reasons why using this approach: </p>\n\n<ul>\n<li>opening office documents in readonly mode is necessary if multiple programs try to access the same document. Otherwise word would raise a message box trying to clarify who is the one that is allowed to edit the document. </li>\n<li>Actually this procedure works fine in Word 2010</li>\n<li>open in read only mode doesn't mean, editing of the document is locked, it does mean, the document has to be saved under a different name/ location while editing is fully possible. This behavior seems to be changed by Word 2013.</li>\n</ul>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1434551646, "post_id": 30894045, "comment_id": 49828470, "body": "How many rows are selected by <code>WHERE columnc = 20</code>?  One row?  A million rows?"}, {"owner": {"reputation": 3687, "user_id": 4331334, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/aewEH.jpg?s=128&g=1", "display_name": "Coding Enthusiast", "link": "https://stackoverflow.com/users/4331334/coding-enthusiast"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1434551733, "post_id": 30894045, "comment_id": 49828528, "body": "let&#39;s say a 1000 plus"}], "answers": [{"comments": [{"owner": {"reputation": 1144, "user_id": 4237084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9qZjW.jpg?s=128&g=1", "display_name": "Lionel T.", "link": "https://stackoverflow.com/users/4237084/lionel-t"}, "edited": false, "score": 0, "creation_date": 1492548742, "post_id": 30895088, "comment_id": 74019906, "body": "And if it selects only 1 or a few rows, the update by Recordset would be faster, right?"}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 8, "last_activity_date": 1434553750, "last_edit_date": 1434553750, "creation_date": 1434552620, "answer_id": 30895088, "question_id": 30894045, "link": "https://stackoverflow.com/questions/30894045/recordset-edit-or-update-sql-vba-statement-fastest-way-to-update/30895088#30895088", "title": "Recordset.Edit or Update sql vba statement fastest way to update?", "body": "<p>Assuming <code>WHERE columnc = 20</code> selects 1000+ rows, as you mentioned in a comment, executing that <code>UPDATE</code> statement should be noticeably faster than looping through a recordset and updating its rows one at a time.</p>\n\n<p>The latter strategy is a RBAR (Row By Agonizing Row) approach.  The first strategy, executing a single (valid) <code>UPDATE</code>, is a \"set-based\" approach.  In general, set-based trumps RBAR with respect to performance.</p>\n\n<p>However your 2 examples raise other issues.  My first suggestion would be to use DAO instead of ADO to execute your <code>UPDATE</code>:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>CurrentDb.Execute stSQL, dbFailonError\n</code></pre>\n\n<p>Whichever of those strategies you choose, make sure <em>columnc</em> is indexed.</p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 7, "last_activity_date": 1434560590, "creation_date": 1434560590, "answer_id": 30897929, "question_id": 30894045, "link": "https://stackoverflow.com/questions/30894045/recordset-edit-or-update-sql-vba-statement-fastest-way-to-update/30897929#30897929", "title": "Recordset.Edit or Update sql vba statement fastest way to update?", "body": "<p>The SQL method is usually the fastest for bulk updates, but syntax is often clumsy.</p>\n\n<p>The VBA method, however, has the distinct advantages, that code is cleaner, and the recordset can be used before or after the update/edit without requering the data. This can make a huge difference if you have to do long-winded calculations between updates. Also, the recordset can be passed ByRef to supporting functions or further processing.</p>\n"}, {"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1500562575, "post_id": 45214369, "comment_id": 77402972, "body": "This does not answer the question. Did you want to ask a question? Then please do that and ask a new question. But read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> first."}], "tags": [], "owner": {"reputation": 1, "user_id": 8338154, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/f26e22b7810e81cd6829d23807b97865?s=128&d=identicon&r=PG", "display_name": "Boris", "link": "https://stackoverflow.com/users/8338154/boris"}, "is_accepted": false, "score": -1, "last_activity_date": 1500552815, "creation_date": 1500552815, "answer_id": 45214369, "question_id": 30894045, "link": "https://stackoverflow.com/questions/30894045/recordset-edit-or-update-sql-vba-statement-fastest-way-to-update/45214369#45214369", "title": "Recordset.Edit or Update sql vba statement fastest way to update?", "body": "<pre><code>Dim rs As DAO.Recordset\nSet rs = CurrentDb.OpenRecordset(\"select invoice_num from dbo_doc_flow_data where barcode = '\" &amp; Me.barcode_f &amp; \"'\")\nDo While Not rs.EOF\n            rs.Edit\n            rs!invoice_num = Me!invoice_num_f\n            rs.Update\n            rs.MoveNext\nLoop\n            rs.Close\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 102, "user_id": 9692252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BYLjM.jpg?s=128&g=1", "display_name": "David Beckman", "link": "https://stackoverflow.com/users/9692252/david-beckman"}, "is_accepted": false, "score": 0, "last_activity_date": 1532542554, "creation_date": 1532542554, "answer_id": 51525319, "question_id": 30894045, "link": "https://stackoverflow.com/questions/30894045/recordset-edit-or-update-sql-vba-statement-fastest-way-to-update/51525319#51525319", "title": "Recordset.Edit or Update sql vba statement fastest way to update?", "body": "<p>I have found that when I need to update every record in a table in order, such as adding a sequential ID when using Autonumber is not feasible, adding a running total, or any calculation that is incremental based on some value in the recordset, that the DAO method is much faster.</p>\n\n<p>If your data is not in the order you need it processed in, and you instead need to rely on matching values to the data source, then SQL is much more efficient.</p>\n"}], "owner": {"reputation": 3687, "user_id": 4331334, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/aewEH.jpg?s=128&g=1", "display_name": "Coding Enthusiast", "link": "https://stackoverflow.com/users/4331334/coding-enthusiast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35493, "favorite_count": 1, "accepted_answer_id": 30895088, "answer_count": 4, "score": 9, "last_activity_date": 1594540437, "creation_date": 1434550169, "last_edit_date": 1594540437, "question_id": 30894045, "link": "https://stackoverflow.com/questions/30894045/recordset-edit-or-update-sql-vba-statement-fastest-way-to-update", "title": "Recordset.Edit or Update sql vba statement fastest way to update?", "body": "<p>I recently came across vba update statements and I have been using <code>Recordset.Edit</code> and <code>Recordset.Update</code> to not only edit my existing data but to update it. </p>\n\n<p>I want to know the difference between the two: <code>recordset.update</code> and <code>Update sql Vba</code> statement. I think they all do the same but I can't figure which one is more efficient and why. </p>\n\n<p>Example code below:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>'this is with sql update statement\ndim someVar as string, anotherVar as String, cn As New ADODB.Connection\n\nsomeVar = \"someVar\"\nanotherVar = \"anotherVar\"\n\nsqlS = \"Update tableOfRec set columna = \" &amp;_\n         someVar &amp; \", colunmb = \" &amp; anotherVar &amp;_\n                                    \" where columnc = 20\"; \n\ncn.Execute stSQL\n</code></pre>\n\n<p>This is for recordset (update and Edit): </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>dim thisVar as String, someOthVar as String, rs as recordset \nthisVar = \"thisVar\"\nsomeOthVar = \"someOtherVar\"\n\n\nset rs = currentDb.openRecordset(\"select columna, columnb where columnc = 20\")\ndo While not rs.EOF\n   rs.Edit\n   rs!columna = thisVar\n   rs!columnb = someOthvar\n   rs.update\n\n   rs.MoveNext\nloop \n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2007"], "comments": [{"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1434550320, "post_id": 30893805, "comment_id": 49827419, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/23511707/what-is-the-difference-between-entering-parameters-in-these-four-different-ways\">What is the difference between entering parameters in these four different ways?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "edited": false, "score": 0, "creation_date": 1434549836, "post_id": 30893865, "comment_id": 49827038, "body": "Thanks, but that doesn&#39;t fix the MsgBox syntax problem."}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": false, "score": 1, "last_activity_date": 1434549715, "creation_date": 1434549715, "answer_id": 30893865, "question_id": 30893805, "link": "https://stackoverflow.com/questions/30893805/vba-errorhandler-msgbox-syntax/30893865#30893865", "title": "VBA ErrorHandler MsgBox Syntax", "body": "<p>You are missing a colon it should be <code>ErrorHandler:</code></p>\n"}, {"comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1434551227, "post_id": 30893920, "comment_id": 49828175, "body": "<code>, asVbMsgBoxResult</code> - that bit shouldn&#39;t be there."}, {"owner": {"reputation": 1337, "user_id": 2999781, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kYD9I.gif?s=128&g=1", "display_name": "Jiminy Cricket", "link": "https://stackoverflow.com/users/2999781/jiminy-cricket"}, "edited": false, "score": 0, "creation_date": 1434551449, "post_id": 30893920, "comment_id": 49828326, "body": "Apologies, it&#39;s the way I copied the text into VBE. Please ignore that part!"}], "tags": [], "owner": {"reputation": 1337, "user_id": 2999781, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kYD9I.gif?s=128&g=1", "display_name": "Jiminy Cricket", "link": "https://stackoverflow.com/users/2999781/jiminy-cricket"}, "is_accepted": false, "score": 1, "last_activity_date": 1434550123, "last_edit_date": 1434550123, "creation_date": 1434549845, "answer_id": 30893920, "question_id": 30893805, "link": "https://stackoverflow.com/questions/30893805/vba-errorhandler-msgbox-syntax/30893920#30893920", "title": "VBA ErrorHandler MsgBox Syntax", "body": "<p>You call shouldn't be in parenthesis (brackets) unless you're wanting to return a value. Remove the brackets after msgbox</p>\n\n<pre><code>Sub DataProcessingExperiment7\nOn Error GoTo ErrorHandler\n...\n\nErrorHandler:\nMsgBox \"Error detected\" &amp; vbNewLine &amp; \"Error\" &amp; Err.Number &amp; \": \" &amp; Err.Description, vbCritical, \"Error Handler: Error\" &amp; Err.Number, , \n</code></pre>\n\n<p>Edit: </p>\n\n<p>And you have too many arguments. Remove one</p>\n"}, {"tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": false, "score": 0, "last_activity_date": 1434551929, "creation_date": 1434551929, "answer_id": 30894796, "question_id": 30893805, "link": "https://stackoverflow.com/questions/30893805/vba-errorhandler-msgbox-syntax/30894796#30894796", "title": "VBA ErrorHandler MsgBox Syntax", "body": "<p>If you just want to show the user a message with an ok button then use:</p>\n\n<pre><code>MsgBox \"This is the message\", vbCritical, \"This is the title\"\n</code></pre>\n\n<p>The only bit you need is the message bit. You can use named parameters, like this (makes it easier to know which bit is what):</p>\n\n<pre><code>MsgBox Prompt:=\"This is the message\", Buttons:=vbCritical, Title:=\"This is the title\"\n</code></pre>\n\n<p>If you want to give the user a Yes/No, Ok/Cancel choice, then you use MsgBox as a function and store or use the result.</p>\n\n<pre><code>If vbNo = MsgBox(Prompt:=\"Do you want to continue?\",Buttons:=vbQuestion + vbYesNo, Title:=\"Are you sure?\") Then\n</code></pre>\n\n<p>For your code use:</p>\n\n<pre><code>ErrorHandler:\nMsgBox Prompt:=\"Error detected\" &amp; vbNewLine &amp; \"Error\" &amp; Err.Number &amp; \": \" &amp; Err.Description, Buttons:=vbCritical, Title:=\"Error Handler: Error\" &amp; Err.Number\n</code></pre>\n"}], "owner": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3133, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1434551929, "creation_date": 1434549520, "question_id": 30893805, "link": "https://stackoverflow.com/questions/30893805/vba-errorhandler-msgbox-syntax", "title": "VBA ErrorHandler MsgBox Syntax", "body": "<p>This is a basic question, but I haven't found any solutions after a Google search.</p>\n\n<p>Here's what I'm trying to do:</p>\n\n<p>I can't get the MsgBox to launch properly: it's highlighted in red. I think this is a syntax issue.</p>\n\n<pre><code>Sub DataProcessingExperiment7\nOn Error GoTo ErrorHandler\n...\nErrorHandler\nMsgBox(\"Error detected\" &amp; vbNewLine &amp; \"Error\" &amp; Err.Number &amp; \": \" &amp; Err.Description, vbCritical, \"Error Handler: Error\" &amp; Err.Number, , , asVbMsgBoxResult)\n</code></pre>\n"}, {"tags": ["excel", "printing", "header", "mapping", "vba"], "comments": [{"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "edited": false, "score": 0, "creation_date": 1434549889, "post_id": 30893764, "comment_id": 49827071, "body": "Is it safe to assume that each number in the header corresponds to one character?"}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1434550096, "post_id": 30893764, "comment_id": 49827237, "body": "Could you clear up the beggining of your question? I don&#39;t see characters 1-5 in what you wrote. I don&#39;t understand what you are trying to do at all."}, {"owner": {"reputation": 297, "user_id": 4950454, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-lO-8slYBlj0/AAAAAAAAAAI/AAAAAAAAAbI/Ov3uCl89kmU/photo.jpg?sz=128", "display_name": "Dasman", "link": "https://stackoverflow.com/users/4950454/dasman"}, "reply_to_user": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1434550590, "post_id": 30893764, "comment_id": 49827658, "body": "@DavidGM and TMH885 I added a screenshot and more thorough results for clarity. Thanks again for the time!"}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1434550814, "post_id": 30893764, "comment_id": 49827843, "body": "I think I understand what you are trying to do. I just don&#39;t understand what the problem IS. What do you mean by 1-5 being skipped? Also what does this sentence mean: Is there are column way to detect if I am missing a range in the header column?"}, {"owner": {"reputation": 297, "user_id": 4950454, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-lO-8slYBlj0/AAAAAAAAAAI/AAAAAAAAAbI/Ov3uCl89kmU/photo.jpg?sz=128", "display_name": "Dasman", "link": "https://stackoverflow.com/users/4950454/dasman"}, "reply_to_user": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "edited": false, "score": 0, "creation_date": 1434551541, "post_id": 30893764, "comment_id": 49828396, "body": "@TMH8885 and DavidGM I clarified the current and the desired result."}], "answers": [{"comments": [{"owner": {"reputation": 297, "user_id": 4950454, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-lO-8slYBlj0/AAAAAAAAAAI/AAAAAAAAAbI/Ov3uCl89kmU/photo.jpg?sz=128", "display_name": "Dasman", "link": "https://stackoverflow.com/users/4950454/dasman"}, "edited": false, "score": 0, "creation_date": 1434555926, "post_id": 30895504, "comment_id": 49831743, "body": "This is GREAT! Thanks a lot! One quick clarification: How to work with only 1 header number? As I understand your code works with finding intBeg (25) and int End(27), but what if the header is one number 63? I tried a Len() if loop. Check my posted code."}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "reply_to_user": {"reputation": 297, "user_id": 4950454, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-lO-8slYBlj0/AAAAAAAAAAI/AAAAAAAAAbI/Ov3uCl89kmU/photo.jpg?sz=128", "display_name": "Dasman", "link": "https://stackoverflow.com/users/4950454/dasman"}, "edited": false, "score": 1, "creation_date": 1434556026, "post_id": 30895504, "comment_id": 49831815, "body": "I&#39;d use an IF statement, I&#39;ll edit in a possibility into my answer."}, {"owner": {"reputation": 297, "user_id": 4950454, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-lO-8slYBlj0/AAAAAAAAAAI/AAAAAAAAAbI/Ov3uCl89kmU/photo.jpg?sz=128", "display_name": "Dasman", "link": "https://stackoverflow.com/users/4950454/dasman"}, "edited": false, "score": 0, "creation_date": 1434556602, "post_id": 30895504, "comment_id": 49832210, "body": "Ah I see. Where to put the end if?"}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "reply_to_user": {"reputation": 297, "user_id": 4950454, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-lO-8slYBlj0/AAAAAAAAAAI/AAAAAAAAAbI/Ov3uCl89kmU/photo.jpg?sz=128", "display_name": "Dasman", "link": "https://stackoverflow.com/users/4950454/dasman"}, "edited": false, "score": 0, "creation_date": 1434556733, "post_id": 30895504, "comment_id": 49832321, "body": "The line before <code>Next j</code>"}, {"owner": {"reputation": 297, "user_id": 4950454, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-lO-8slYBlj0/AAAAAAAAAAI/AAAAAAAAAbI/Ov3uCl89kmU/photo.jpg?sz=128", "display_name": "Dasman", "link": "https://stackoverflow.com/users/4950454/dasman"}, "edited": false, "score": 0, "creation_date": 1434556925, "post_id": 30895504, "comment_id": 49832451, "body": "So it returns this error: &quot;Runtime Error 9&quot; Subscription out of range. Debug: &quot;strArr(t) = Mid(Cells(I, j).Value, intCount, 1)&quot;    I mean you&#39;ve helped a bunch but if you could help here that&#39;d be great! :)"}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "reply_to_user": {"reputation": 297, "user_id": 4950454, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-lO-8slYBlj0/AAAAAAAAAAI/AAAAAAAAAbI/Ov3uCl89kmU/photo.jpg?sz=128", "display_name": "Dasman", "link": "https://stackoverflow.com/users/4950454/dasman"}, "edited": false, "score": 0, "creation_date": 1434557390, "post_id": 30895504, "comment_id": 49832794, "body": "Can you tell me what the input(header/field) was that threw this error?  Was it formatted as a number?  This is outside of the IF checking for a one number header, so it should still work."}, {"owner": {"reputation": 297, "user_id": 4950454, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-lO-8slYBlj0/AAAAAAAAAAI/AAAAAAAAAbI/Ov3uCl89kmU/photo.jpg?sz=128", "display_name": "Dasman", "link": "https://stackoverflow.com/users/4950454/dasman"}, "edited": false, "score": 0, "creation_date": 1434557831, "post_id": 30895504, "comment_id": 49833105, "body": "I included a snapshot of the input and if you want the error snapshot I can do that as well."}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "reply_to_user": {"reputation": 297, "user_id": 4950454, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-lO-8slYBlj0/AAAAAAAAAAI/AAAAAAAAAbI/Ov3uCl89kmU/photo.jpg?sz=128", "display_name": "Dasman", "link": "https://stackoverflow.com/users/4950454/dasman"}, "edited": false, "score": 1, "creation_date": 1434558134, "post_id": 30895504, "comment_id": 49833322, "body": "Did you change the Maximum (in the <code>Dim strArr(1 to 27)</code>)  27 to 63?"}, {"owner": {"reputation": 297, "user_id": 4950454, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-lO-8slYBlj0/AAAAAAAAAAI/AAAAAAAAAbI/Ov3uCl89kmU/photo.jpg?sz=128", "display_name": "Dasman", "link": "https://stackoverflow.com/users/4950454/dasman"}, "reply_to_user": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "edited": false, "score": 0, "creation_date": 1434561311, "post_id": 30895504, "comment_id": 49835403, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/80806/discussion-between-dasman-and-tmh8885\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "is_accepted": true, "score": 1, "last_activity_date": 1434557576, "last_edit_date": 1434557576, "creation_date": 1434553672, "answer_id": 30895504, "question_id": 30893764, "link": "https://stackoverflow.com/questions/30893764/mapping-from-one-sheet-to-another-fill-unfilled-chracter/30895504#30895504", "title": "Mapping from One Sheet to Another Fill Unfilled chracter", "body": "<p>Here's your code with the extra functionality built in.  It essentially just builds an array, adds each character to the correct location then adds it all together, replacing blanks with spaces.  You'll have to change the maximum (in this example it's hard-coded at 27) but you could use the same logic as I used to get \"intEnd\" to find your maximum by looping over the heading column.  Notes, this will compensate for out of order columns and I assumed that the Selection includes headers (hence starting at I = 2):  </p>\n\n<pre><code>Private Sub WriteFile_Click()\nDim myFile As String, rng As Range, cellValue As Variant, I As Integer, j As Integer\n\nmyFile = \"C:\\Reformatted.txt\"\nSet rng = Selection\n\nOpen myFile For Output As #1\n\nDim strArr(1 To 27) As String, intBeg As Integer, intEnd As Integer, intCount As Integer\n\nFor I = 2 To rng.Rows.Count\n    For j = 1 To rng.Columns.Count\n        If InStr(1, CStr(Cells(1, j).Value), \"-\") = 0 Then\n            strArr(Val(Cells(1, j).Value)) = Cells(I, j).Value\n        Else\n            intBeg = Val(Left(Cells(1, j).Value, InStr(1, Cells(1, j).Value, \"-\") - 1))\n            intEnd = Val(Right(Cells(1, j).Value, Len(Cells(1, j).Value) - InStr(1, Cells(1, j).Value, \"-\")))\n            intCount = 1\n            For t = intBeg To intEnd\n                strArr(t) = Mid(Cells(I, j).Value, intCount, 1)\n                intCount = intCount + 1\n            Next t\n        End If\n    Next j\n    For t = 1 To UBound(strArr)\n        If strArr(t) = \"\" Then strArr(t) = \" \"\n        cellValue = cellValue + strArr(t)\n    Next t\n    Erase strArr\n    Print #1, cellValue\n    cellValue = \"\"\nNext I\nClose #1\nShell \"C:\\Windows\\Notepad.exe C:\\Reformatted.txt\", 1\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 297, "user_id": 4950454, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-lO-8slYBlj0/AAAAAAAAAAI/AAAAAAAAAbI/Ov3uCl89kmU/photo.jpg?sz=128", "display_name": "Dasman", "link": "https://stackoverflow.com/users/4950454/dasman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 30895504, "answer_count": 1, "score": 1, "last_activity_date": 1434557769, "creation_date": 1434549400, "last_edit_date": 1531161705, "question_id": 30893764, "link": "https://stackoverflow.com/questions/30893764/mapping-from-one-sheet-to-another-fill-unfilled-chracter", "title": "Mapping from One Sheet to Another Fill Unfilled chracter", "body": "<p>So I have one excel document that has partially filled character array (\"|\" shows excel column line):</p>\n\n<p><img src=\"https://i.stack.imgur.com/1vf5E.png\" alt=\"Screenshot of Excel\"></p>\n\n<p><strong>Current Result (\"_\" is a space):</strong></p>\n\n<pre><code>1111GGH80100022190\n1112QQH80100023201\n1113GGH80100045201\n1114AAH80100025190\n</code></pre>\n\n<p>So my current code outputs this above result. The problem is that characters <strong>1-5</strong> and <strong>21-24</strong> get skipped over. In general if there is no column number accounted for I should print \" \" (Space).</p>\n\n<p><strong>Desired Result (\"_\" is a space):</strong></p>\n\n<pre><code>_____1111GGH80100022____190\n_____1112QQH80100023____201\n_____1113GGH80100045____201\n_____1114AAH80100025____190\n</code></pre>\n\n<p>Is there are column way to detect if I am missing a range in the header column? I currently use this and only select the data:</p>\n\n<pre><code>Private Sub WriteFile_Click()\nDim myFile As String, rng As Range, cellValue As Variant, I As Integer, j As Integer\n\nmyFile = \"C:\\Reformatted.txt\"\nSet rng = Selection\n\nOpen myFile For Output As #1\n\nFor I = 1 To rng.Rows.Count\n    For j = 1 To rng.Columns.Count\n\ncellValue = cellValue + CStr(rng.Cells(I, j).Value)\ncellValue = Replace(cellValue, \"NULL\", \"    \")\n\nIf j = rng.Columns.Count Then\n    Print #1, cellValue\nEnd If\n\n    Next j\n    cellValue = \"\"\nNext I\n\nClose #1\nShell \"C:\\Windows\\Notepad.exe C:\\Reformatted.txt\", 1\nEnd Sub\n</code></pre>\n\n<p>-----------------------------After TMh885 Answer--------------------------------</p>\n\n<p>So the code works perfectly EXCEPT if you have a header thats a single number '63'</p>\n\n<p>So I am trying this:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim myFile As String, rng As Range, cellValue As Variant, I As Integer, j As Integer\n\nmyFile = \"C:\\Reformatted.txt\"\nSet rng = Selection\n\nOpen myFile For Output As #1\n\nDim strArr(1 To 63) As String, intBeg As Integer, intEnd As Integer, intCount As Integer\n\nFor I = 2 To rng.Rows.Count\n    For j = 1 To rng.Columns.Count\n        If Len(Cells) = 1 Then\n            cellValue = cellValue + \" \"\n        Else\n            intBeg = Val(Left(Cells(1, j).Value, InStr(1, Cells(1, j).Value, \"-\") - 1))\n            intEnd = Val(Right(Cells(1, j).Value, Len(Cells(1, j).Value) - InStr(1, Cells(1, j).Value, \"-\")))\n            intCount = 1\n            For t = intBeg To intEnd\n                strArr(t) = Mid(Cells(I, j).Value, intCount, 1)\n                intCount = intCount + 1\n            Next t\n        End If\n\n    Next j\n    For t = 1 To UBound(strArr)\n        If strArr(t) = \"\" Then strArr(t) = \" \"\n        cellValue = cellValue + strArr(t)\n    Next t\n    Erase strArr\n    Print #1, cellValue\n    cellValue = \"\"\nNext I\nClose #1\nShell \"C:\\Windows\\Notepad.exe C:\\Reformatted.txt\", 1\n\nEnd Sub\n</code></pre>\n\n<p>--------------------------------Error Snapshot----------------------------------</p>\n\n<p>Input:</p>\n\n<p><img src=\"https://i.stack.imgur.com/Qx5f2.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 5017166, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KDGLb9PJYSE/AAAAAAAAAAI/AAAAAAAAAC0/buxinEJhZgU/photo.jpg?sz=128", "display_name": "Ted", "link": "https://stackoverflow.com/users/5017166/ted"}, "edited": false, "score": 0, "creation_date": 1434550104, "post_id": 30893759, "comment_id": 49827241, "body": "Thanks for that.  How do I repeat this code on the cells below without having to retype all of the ranges (e.g. H4:H5 in the next loop will be H:23:H24).  Also, next month I will want to run this on the next column (I4:I5 and so on)."}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "reply_to_user": {"reputation": 27, "user_id": 5017166, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KDGLb9PJYSE/AAAAAAAAAAI/AAAAAAAAAC0/buxinEJhZgU/photo.jpg?sz=128", "display_name": "Ted", "link": "https://stackoverflow.com/users/5017166/ted"}, "edited": false, "score": 0, "creation_date": 1434550336, "post_id": 30893759, "comment_id": 49827437, "body": "@Ted I don&#39;t really see what this does at all. You&#39;re copying a range on itself (same sheet, same cell?)"}, {"owner": {"reputation": 27, "user_id": 5017166, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KDGLb9PJYSE/AAAAAAAAAAI/AAAAAAAAAC0/buxinEJhZgU/photo.jpg?sz=128", "display_name": "Ted", "link": "https://stackoverflow.com/users/5017166/ted"}, "edited": false, "score": 0, "creation_date": 1434550628, "post_id": 30893759, "comment_id": 49827692, "body": "That&#39;s right. It&#39;s just a copy and paste task that takes forever because I have formulas in cells H6:H7, etc. and don&#39;t want to copy and paste over them with hard coded numbers.  And because you can&#39;t copy and paste values over multiple cell locations I have to repeat the copy and paste values like 100 times."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 27, "user_id": 5017166, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KDGLb9PJYSE/AAAAAAAAAAI/AAAAAAAAAC0/buxinEJhZgU/photo.jpg?sz=128", "display_name": "Ted", "link": "https://stackoverflow.com/users/5017166/ted"}, "edited": false, "score": 0, "creation_date": 1434554578, "post_id": 30893759, "comment_id": 49830735, "body": "@Ted I can help you do that, but I won&#39;t be able to get to it today."}, {"owner": {"reputation": 27, "user_id": 5017166, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KDGLb9PJYSE/AAAAAAAAAAI/AAAAAAAAAC0/buxinEJhZgU/photo.jpg?sz=128", "display_name": "Ted", "link": "https://stackoverflow.com/users/5017166/ted"}, "edited": false, "score": 0, "creation_date": 1434555181, "post_id": 30893759, "comment_id": 49831193, "body": "No worries and no rush.  I tried to illustrate it better above.  I know this is kind of a dumb task, but it will save me a lot of time and I can apply it to many parts of my spreadsheet.  Thanks a lot."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1434610834, "post_id": 30893759, "comment_id": 49854877, "body": "See update above... it should now run through all rows"}, {"owner": {"reputation": 27, "user_id": 5017166, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KDGLb9PJYSE/AAAAAAAAAAI/AAAAAAAAAC0/buxinEJhZgU/photo.jpg?sz=128", "display_name": "Ted", "link": "https://stackoverflow.com/users/5017166/ted"}, "edited": false, "score": 0, "creation_date": 1435156234, "post_id": 30893759, "comment_id": 50083362, "body": "Yes, perfect.  Thank you so much"}], "tags": [], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "is_accepted": true, "score": 1, "last_activity_date": 1434610762, "last_edit_date": 1434610762, "creation_date": 1434549390, "answer_id": 30893759, "question_id": 30893412, "link": "https://stackoverflow.com/questions/30893412/repeat-vba-sub-for-copy-and-paste-values-on-multiple-rows/30893759#30893759", "title": "Repeat VBA sub for copy and &quot;paste values&quot; on multiple rows", "body": "<p>Here is a shortend version of your code with a lot of the macro recorder generated stuff taken out. It can be improved further, but you would need to explain further what it is you are doing:</p>\n\n<p>UPDATED ANSWER</p>\n\n<pre><code>Sub RFC_Paste_Month_Values()\n'\n' RFC_Paste_Month_Values Macro\n'\n\nDim i As Integer\n\nWith ActiveSheet\n    For i = 0 To .UsedRange.Rows.Count Step 19 '\n        .Range(.Cells(4 + i, 8), .Cells(5 + i, 8)) = .Range(.Cells(4 + i, 8), .Cells(5 + i, 8)).Value\n        .Cells(8 + i, 8) = .Cells(8 + i, 8).Value\n        .Cells(10 + i, 8) = .Cells(10 + i, 8).Value\n        .Range(.Cells(13 + i, 8), .Cells(16 + i, 8)) = .Range(.Cells(13 + i, 8), .Cells(16 + i, 8)).Value\n    Next i\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Again... I didn't have a chance to test it, but I think it should work for you.</p>\n"}], "owner": {"reputation": 27, "user_id": 5017166, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KDGLb9PJYSE/AAAAAAAAAAI/AAAAAAAAAC0/buxinEJhZgU/photo.jpg?sz=128", "display_name": "Ted", "link": "https://stackoverflow.com/users/5017166/ted"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2799, "favorite_count": 0, "accepted_answer_id": 30893759, "answer_count": 1, "score": 1, "last_activity_date": 1434610762, "creation_date": 1434548521, "last_edit_date": 1434555115, "question_id": 30893412, "link": "https://stackoverflow.com/questions/30893412/repeat-vba-sub-for-copy-and-paste-values-on-multiple-rows", "title": "Repeat VBA sub for copy and &quot;paste values&quot; on multiple rows", "body": "<p>I am very new to VBA.  </p>\n\n<p>My financial spreadsheet has become very complex and rife with manual copy and paste tasks that probably could have been setup better initially.  </p>\n\n<p>My task is fairly simple (I think): I have 8 cells I want to copy and paste the values into (setting a dynamic budget in hard-coded values for a previous month), and then repeat this process to 6 other destinations in the same column with the same cell pattern. </p>\n\n<p>For example: </p>\n\n<p>(1) Copy--> Paste Values H4:H5, H8, H10 &amp; H13:H16  </p>\n\n<p>(2) Repeat on H23:H24 (H4:H5 + 20 rows), H27 (H8 + 20 rows), H39 (H10 + 20 rows), H32:H35 (H13:H:16 + 20 rows) </p>\n\n<p>(3) Then repeat this same copy and paste pattern many times down the column:</p>\n\n<pre><code>     H\n4  **Paste Value**\n5  **Paste Value**\n6 Leave alone\n7 Leave alone\n8  **Paste Value**\n9 Leave alone\n10  **Paste Value**\n11 Leave alone\n12 Leave alone\n13  **Paste Value**\n14  **Paste Value**\n15  **Paste Value**\n16  **Paste Value**\n\nSkip H:17:H22\n\n     H\n23 **Paste Value**\n24 **Paste Value**\n25 Leave alone\n26 Leave alone\n27  **Paste Value**\n28 Leave alone\n29  **Paste Value**\n30 Leave alone\n31 Leave alone\n32  **Paste Value**\n33  **Paste Value**\n34  **Paste Value**\n35  **Paste Value**\n</code></pre>\n\n<p>This is the macro I recorded for the first set: </p>\n\n<pre><code>Sub RFC_Paste_Month_Values()\n'\n' RFC_Paste_Month_Values Macro\n\n    Range(\"H4:H5\").Select\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Range(\"H8\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Range(\"H10\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Range(\"H13:H16\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n' Copy and \"Paste Special- Values\" of set budgets '\n\nEnd Sub\n</code></pre>\n\n<p>Any help would be much appreciated.  Thank you!</p>\n\n<p>Ted</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 1, "creation_date": 1434548070, "post_id": 30892816, "comment_id": 49825628, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/14245712/cycle-through-sub-folders-and-files-in-a-user-specified-root-directory\">Cycle through sub-folders and files in a user-specified root directory</a>"}], "answers": [{"comments": [{"owner": {"reputation": 712, "user_id": 3243922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFTEb.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3243922/tom"}, "edited": false, "score": 1, "creation_date": 1434548830, "post_id": 30893326, "comment_id": 49826230, "body": "If you want to define fso as a filesystemobject you will need to add a reference to your vba project to the Microsoft Scripting.Runtime reference. This reference also has a lot of other usefull objects like folder and file that you may be able to use. I prefer to define fso first (DIM fso as FileSystemObject) and then setting it to a new instance (SET fso = new FileSystemObject) and closing off the subroutine with destroying the fso object (SET fso = Nothing) This is a bit neater... but also no more than my preference."}, {"owner": {"reputation": 572, "user_id": 2497001, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb2b8a8f50e8038ea7f9d199b68bf750?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/2497001/evan"}, "reply_to_user": {"reputation": 712, "user_id": 3243922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFTEb.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3243922/tom"}, "edited": false, "score": 0, "creation_date": 1434549044, "post_id": 30893326, "comment_id": 49826426, "body": "Yes, forgot to add that to my answer but Tom is on point. You will need to add reference. <a href=\"http://stackoverflow.com/a/3236348/2497001\">Here is a good answer on how to do that</a>"}, {"owner": {"reputation": 15, "user_id": 5016799, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/05791f2b24ec361e8011926c51b69611?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Possi-Moses", "link": "https://stackoverflow.com/users/5016799/nick-possi-moses"}, "edited": false, "score": 0, "creation_date": 1434551957, "post_id": 30893326, "comment_id": 49828664, "body": "Thanks for the help; so here is where I am out now. 1) For the code &quot;For i = 2 To Sheets(1); I put in the name of the worksheet--would that still work? 2) Also, for code:  Range(&quot;a1&quot;) .End(x1Down).Row -- Do i need to put a letter in that box to complete an array?"}, {"owner": {"reputation": 572, "user_id": 2497001, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb2b8a8f50e8038ea7f9d199b68bf750?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/2497001/evan"}, "edited": false, "score": 0, "creation_date": 1434552840, "post_id": 30893326, "comment_id": 49829433, "body": "Sheets(&quot;SheetName&quot;) works as well as indecies. Im not sure I follow the 2nd question. Range can be one cell so Range(&quot;A1&quot;) is legal."}, {"owner": {"reputation": 15, "user_id": 5016799, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/05791f2b24ec361e8011926c51b69611?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Possi-Moses", "link": "https://stackoverflow.com/users/5016799/nick-possi-moses"}, "edited": false, "score": 0, "creation_date": 1434556097, "post_id": 30893326, "comment_id": 49831859, "body": "When i try to run the macro I get this message:  &quot;Run-time error &#39;5&#39;:  invalid procedure call or arguement--it&#39;s referring to this line of code:  &quot;new_name = Left(Sheets(1).Cells(i, 1).Value, Len(Sheets(1).Cells(i, 1).Value) - Len(Sheets(1).Cells(i, 2).Value))&quot;"}, {"owner": {"reputation": 572, "user_id": 2497001, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb2b8a8f50e8038ea7f9d199b68bf750?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/2497001/evan"}, "edited": false, "score": 0, "creation_date": 1434559843, "post_id": 30893326, "comment_id": 49834485, "body": "What does your spreadsheet data look like and what are you trying to accomplish with this line of code?"}, {"owner": {"reputation": 15, "user_id": 5016799, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/05791f2b24ec361e8011926c51b69611?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Possi-Moses", "link": "https://stackoverflow.com/users/5016799/nick-possi-moses"}, "edited": false, "score": 0, "creation_date": 1434561026, "post_id": 30893326, "comment_id": 49835224, "body": "In Column A I put the file path for the subfolders, Column B I put the Old Folder Name, and in Column C I put the New Folder Name. Essentially, all I want to do is click a command button that executes a macro that renames all the folders in one file."}], "tags": [], "owner": {"reputation": 572, "user_id": 2497001, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb2b8a8f50e8038ea7f9d199b68bf750?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/2497001/evan"}, "is_accepted": false, "score": 1, "last_activity_date": 1434548323, "creation_date": 1434548323, "answer_id": 30893326, "question_id": 30892816, "link": "https://stackoverflow.com/questions/30892816/how-do-i-write-a-vba-code-to-rename-all-folders-under-a-root-folder/30893326#30893326", "title": "How do I write a VBA code to rename all folders under a root folder?", "body": "<p>There are 2 ways to go about this. The first (and much slower one) is to open each file with the old name, save as with the new name, and then move to the next.</p>\n\n<p>I would reccomend the scripting style approach, using a file system object you can move files (rename them) within a loop. </p>\n\n<p>Presuming the old and new file names have a relative path with them from some parent folder:</p>\n\n<pre><code>Dim fso As New FileSystemObject, ParentFolder as string\nParentFolder = \"C:\\Users\\Me\\ThisProject\\\"\n\nFor i = 2 To Sheets(1).Range(\"a1\").End(xlDown).Row\n    new_name = Left(Sheets(1).Cells(i, 1).Value, Len(Sheets(1).Cells(i, 1).Value) - Len(Sheets(1).Cells(i, 2).Value))\n    new_name = new_name &amp; Sheets(1).Cells(i, 3).Value\n    old_name = Sheets(1).Cells(i, 1).Value\n\n    'This will move (rename) the old file to the new one\n    fso.MoveFile (ParentFolder &amp; old_name), (ParentFolder &amp; new_name)\nNext i\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5016799, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/05791f2b24ec361e8011926c51b69611?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Possi-Moses", "link": "https://stackoverflow.com/users/5016799/nick-possi-moses"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1462, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1434548323, "creation_date": 1434547048, "last_edit_date": 1434547132, "question_id": 30892816, "link": "https://stackoverflow.com/questions/30892816/how-do-i-write-a-vba-code-to-rename-all-folders-under-a-root-folder", "title": "How do I write a VBA code to rename all folders under a root folder?", "body": "<p>I'm very new to VBA and have been messing around with a few codes for work. Essentially, I have a folder that contains 1000+ folders with different names--and I need to rename each folder. I have an excel sheet set up with the Original File Path, Old Folder name, and Desired Folder Name. I have found that this code works for the parent folder, but not the folders within it:</p>\n\n<pre><code>Sub rename_folder()\nDim old_name, new_name As String\nFor i = 2 To Sheets(1).Range(\"a1\").End(xlDown).Row\nnew_name = Left(Sheets(1).Cells(i, 1).Value, Len(Sheets(1).Cells(i, 1).Value) - Len(Sheets(1).Cells(i, 2).Value))\nnew_name = new_name &amp; Sheets(1).Cells(i, 3).Value\nold_name = Sheets(1).Cells(i, 1).Value\nName old_name As new_name\nNext i\nEnd Sub \n</code></pre>\n\n<p>How do I get it so that this code renames all the folders within the parent folder? Any help would be much appreciated! Thanks. </p>\n"}, {"tags": ["vba", "excel", "lookup", "formulas"], "comments": [{"owner": {"reputation": 1521, "user_id": 1641564, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/724f62d6254a1a8b245ea725196c13a9?s=128&d=identicon&r=PG", "display_name": "daZza", "link": "https://stackoverflow.com/users/1641564/dazza"}, "edited": false, "score": 0, "creation_date": 1434547784, "post_id": 30892760, "comment_id": 49825372, "body": "Am I understanding this correctly?: You have a worksheet with columns A,B  and C and their respective information. And you want to select the value of C based on A and B?"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1434548509, "post_id": 30892760, "comment_id": 49825973, "body": "Why do you need VBA and not just some lookup functions in Excel?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1434550353, "post_id": 30892760, "comment_id": 49827450, "body": "You can enter an array formula with index/match to look up based on multiple criteria.  This would be the formula, which you can translate into VBA.  I&#39;m going to just make it up and say you are trying to return something in column F :  <code>=index(F:F,match(A1&amp;B1,CustomerRange&amp;RegionRange,0))</code> and enter with CTRL+SHIFT+ENTER"}, {"owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "edited": false, "score": 0, "creation_date": 1434552151, "post_id": 30892760, "comment_id": 49828820, "body": "daZza, great question, I&#39;ll clarify in an edit. Thanks!"}, {"owner": {"reputation": 1521, "user_id": 1641564, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/724f62d6254a1a8b245ea725196c13a9?s=128&d=identicon&r=PG", "display_name": "daZza", "link": "https://stackoverflow.com/users/1641564/dazza"}, "edited": false, "score": 0, "creation_date": 1434554378, "post_id": 30892760, "comment_id": 49830582, "body": "Still not entirely sure if I understand your situation correctly :P So you got 1 worksheet where you only have columns A and B and in addition to that you have another worksheet called &quot;Prices&quot; which was columns A, B and C? In that case the first worksheet would be totally useless, because you got all information stored in the &quot;Prices&quot; one. Selecting the C column from that one should work like in my answer below. Did you try that yet?"}, {"owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "reply_to_user": {"reputation": 1521, "user_id": 1641564, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/724f62d6254a1a8b245ea725196c13a9?s=128&d=identicon&r=PG", "display_name": "daZza", "link": "https://stackoverflow.com/users/1641564/dazza"}, "edited": false, "score": 0, "creation_date": 1434566517, "post_id": 30892760, "comment_id": 49838497, "body": "@daZza I&#39;m sorry for all the confusion and I really appreciate your assistance with this. That is correct. The first worksheet is what the Client gets (basically a list of all transactions they have had with the client). They need to assign a price to each transaction on this worksheet based on the standard rate on the reference worksheet. Check out the images in the edit and let me know if that helps clear things up. I&#39;ve tried your answer but I&#39;m unable to get it to work.  Thank you again!"}, {"owner": {"reputation": 1521, "user_id": 1641564, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/724f62d6254a1a8b245ea725196c13a9?s=128&d=identicon&r=PG", "display_name": "daZza", "link": "https://stackoverflow.com/users/1641564/dazza"}, "edited": false, "score": 0, "creation_date": 1434569297, "post_id": 30892760, "comment_id": 49840239, "body": "@Dr.Trey I see. I will edit my answer, just give me a few minutes."}], "answers": [{"comments": [{"owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "edited": false, "score": 0, "creation_date": 1434570926, "post_id": 30893379, "comment_id": 49841256, "body": "Thanks @daZza. I&#39;m getting the error: Compile error: For control variable already in use. If I remove the second for statement, I get the error: &quot;Run-time error &#39;9&#39;: Subscript out of range&quot; for <code>For r = 2 To ThisWorkbook.Worksheets(&quot;Client&quot;).UsedRange.Rows.Count</code>.  Any suggestions?"}, {"owner": {"reputation": 1521, "user_id": 1641564, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/724f62d6254a1a8b245ea725196c13a9?s=128&d=identicon&r=PG", "display_name": "daZza", "link": "https://stackoverflow.com/users/1641564/dazza"}, "reply_to_user": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "edited": false, "score": 0, "creation_date": 1434571484, "post_id": 30893379, "comment_id": 49841666, "body": "Guess you copied my statement too fast :P Accidentally didn&#39;t change the counter variable after copying the for-clause. This should be fixed now.  For the out of range error: I&#39;m pretty sure that there are rows with &quot;invisible content&quot; below the actual data. That&#39;s the downside to using the rather simple <code>UsedRange.Rows.Count</code>. Try manually selecting a few rows below the line where the actual data ends and then right click and remove rows. It could also be caused by invalid sheet names (did you change those to your actual ones? You can use numbers instead too)"}, {"owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "edited": false, "score": 0, "creation_date": 1434723495, "post_id": 30893379, "comment_id": 49915789, "body": "Thank you so much!  I got around the out of range error by using a different method of getting the last row: <code>Dim LastRow As Long Set sht = ActiveWorkbook.Worksheets(ActiveSheet.Name) ActiveWorkbook.Worksheets(ActiveSheet.Name).UsedRange LastRow = sht.Cells(sht.Rows.Count, &quot;A&quot;).End(xlUp).Row</code> and changing <code>ThisWorkbook</code> to <code>ActiveWorkbook</code>."}], "tags": [], "owner": {"reputation": 1521, "user_id": 1641564, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/724f62d6254a1a8b245ea725196c13a9?s=128&d=identicon&r=PG", "display_name": "daZza", "link": "https://stackoverflow.com/users/1641564/dazza"}, "is_accepted": true, "score": 2, "last_activity_date": 1434570005, "last_edit_date": 1434570005, "creation_date": 1434548441, "answer_id": 30893379, "question_id": 30892760, "link": "https://stackoverflow.com/questions/30892760/index-match-vba-return-a-value-based-on-two-criteria/30893379#30893379", "title": "INDEX MATCH VBA (return a value based on two criteria)", "body": "<p>Imho this is a classic case of \"use a database instead of Excel\", especially if you want to make these kind of queries regularly.</p>\n\n<p>However, something like this should achieve what you want in VBA:</p>\n\n<pre><code>Dim customer As String\nDim region As String\nDim price as Double\n\nFor r = 2 To ThisWorkbook.Worksheets(\"Client\").UsedRange.Rows.Count\n\n        customer = ThisWorkbook.Worksheets(\"Client\").Cells(r, 1).Value\n        region = ThisWorkbook.Worksheets(\"Client\").Cells(r, 2).Value\n        price = 0.00\n\n    For s = 2 To ThisWorkbook.Worksheets(\"Prices\").UsedRange.Rows.Count\n\n\n        If ThisWorkbook.Worksheets(\"Prices\").Cells(s, 1).Value = customer And ThisWorkbook.Worksheets(\"Prices\").Cells(s, 2).Value = region Then\n\n            price = ThisWorkbook.Worksheets(\"Prices\").Cells(s, 3).Value\n            Exit For\n\n        End If\n\n    Next\n\n        If price = 0.00 Then\n            ThisWorkbook.Worksheets(\"Client\").Cells(r, 3).Value = \"This customer/region combination is not stored in the reference sheet\"\n        Else\n            ThisWorkbook.Worksheets(\"Client\").Cells(r, 3).Value = price\n        End If\nNext\n</code></pre>\n\n<p>Change your worksheet and the starting row (r) accordingly </p>\n"}], "owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14413, "favorite_count": 1, "accepted_answer_id": 30893379, "answer_count": 1, "score": 1, "last_activity_date": 1471362588, "creation_date": 1434546943, "last_edit_date": 1434563788, "question_id": 30892760, "link": "https://stackoverflow.com/questions/30892760/index-match-vba-return-a-value-based-on-two-criteria", "title": "INDEX MATCH VBA (return a value based on two criteria)", "body": "<p>I'm doing some work for a client where they receive a weekly report of customers and regions (two columns, A for Customer &amp; B for Region, in a worksheet). * <em>I've omitted the other columns in this spreadsheet for the sake of clarity</em> </p>\n\n<p>They need to match the price on this spreadsheet with a reference spreadsheet, which we'll call Prices. Each customer and region combination yields a certain price which is stored on the aforementioned reference spreadsheet (In this reference worksheet [Prices], Column A is the customer, Column B is the region, Column C is the price for A customer in B region).  </p>\n\n<p>What I'm trying to do is:</p>\n\n<p>Based on A1(customer) and B1(region), C1 should be (lookupvalue for price on the reference worksheet).</p>\n\n<p>The traditional vlookup function would not work because multiple criteria need to be satisfied (i.e. we may have different prices for the same customer in a different region).</p>\n\n<p>I've tried the below with no success</p>\n\n<pre><code>Dim ULastRow As Long\nActiveWorkbook.Worksheets(ActiveSheet.Name).UsedRange\nULastRow = sht.UsedRange.Rows(sht.UsedRange.Rows.Count).Row\n\nRange(\"C2\").FormulaR1C1 = _\n\"=Index(Range(\"C:C\"), Match(Range(\"Prices!C1\"), Range(\"Prices!C2:B34\"), 0), 0)\"\nSelection.AutoFill Destination:=Range(\"C2:C2\" &amp; ULastRow)\n</code></pre>\n\n<p>See the below links for data examples (Unfortunately I am unable to add them in-line:</p>\n\n<p>What the customer gets: <a href=\"https://copy.com/EBABGl2EFjyFWcIH\" rel=\"nofollow\">https://copy.com/EBABGl2EFjyFWcIH</a></p>\n\n<p>The \"Prices\" or Reference data <a href=\"https://copy.com/oSSJuu7Dk4ox84tz\" rel=\"nofollow\">https://copy.com/oSSJuu7Dk4ox84tz</a></p>\n\n<p>Any advice would be greatly appreciated.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 3842, "user_id": 2216929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cfa9e99112a82bc03a57d97d09e7217?s=128&d=identicon&r=PG", "display_name": "kaybee99", "link": "https://stackoverflow.com/users/2216929/kaybee99"}, "is_accepted": true, "score": 2, "last_activity_date": 1434549549, "last_edit_date": 1434549549, "creation_date": 1434548285, "answer_id": 30893310, "question_id": 30892649, "link": "https://stackoverflow.com/questions/30892649/vba-crashes-when-instantiating-match-object/30893310#30893310", "title": "VBA crashes when instantiating &#39;Match&#39; object", "body": "<p><code>FoundItems.Item(i)</code> is zero-based. This means the first item is <code>i = 0</code>, second is <code>i = 1</code> etc.</p>\n\n<p>The problem in your code comes when <code>FoundItems.Count = 1</code>. You will have to use <code>Set FoundItem = FoundItems.Item(0)</code> to return the first item.</p>\n\n<p>More in <a href=\"http://www.herongyang.com/VBScript/RegExp-MatchCollection-and-SubMatches-Collection-Object.html\" rel=\"nofollow\">this tutorial</a>.</p>\n"}], "owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 30893310, "answer_count": 1, "score": 1, "last_activity_date": 1517971859, "creation_date": 1434546694, "last_edit_date": 1517971859, "question_id": 30892649, "link": "https://stackoverflow.com/questions/30892649/vba-crashes-when-instantiating-match-object", "title": "VBA crashes when instantiating &#39;Match&#39; object", "body": "<p>I am puzzled why does following code crashes on line with \"'&lt;-----\".<br>\nThat being said I get no error message and VBE is set to break on all errors, not just unhandled, nor did I have then time to write the error handing procedures yet.  </p>\n\n<p>There is also the fact that this is a procedure from a larger class module and when code hits a break and I try to expand in Locals window <code>Me</code> entire application(Excel) crashes.  </p>\n\n<p>All other methods in this class module work fine, and all variables that are relevant to the problematic procedure are listed bellow.\nRelevant Variables:</p>\n\n<pre><code>VectorPatterns(1) = \"\\d+\\sramp\\s\\d+\\s\"\nPatternList( 1 To 1) = ( \"\\d+\\sramp\\s\\d+\\s\" )\nText = \"5 ramp 12 \"\nAhead = 0\n</code></pre>\n\n<p>The Problematic Code</p>\n\n<pre><code>Private Function ReadNext(ByRef Text As String, Optional Ahead As Integer = 0) As FoundPattern\n    Dim FoundItems As VBScript_RegExp_55.MatchCollection\n    Dim FoundItem As VBScript_RegExp_55.Match\n    Dim APattern As Integer\n    Dim FoundPattern As FoundPattern\n    Dim PatternLookbehind As String\n    Dim DemitedPatternList As String\n\n\n    DemitedPatternList = Join(PatternList, \"|\")\n\n    If Ahead &gt; 0 Then\n        PatternLookbehind = _\n            \"^(?&lt;=\" &amp; _\n            DemitedPatternList &amp; _\n            \"){\" &amp; Ahead &amp; \"}\"\n    Else\n        PatternLookbehind = \"^\"\n    End If\n\n    For APattern = 1 To PatternCount\n        Regex.Pattern = PatternLookbehind &amp; VectorPatterns(APattern).Regex\n        Set FoundItems = Regex.Execute(Text)\n        If FoundItems.Count &gt; 0 Then\n            Set FoundItem = FoundItems.Item(1)                '&lt;-----\n            FoundPattern.Type = VectorPatterns(APattern).Type\n            FoundPattern.Value = FoundItem.Value\n        End If\n    Next APattern\n\n    ReadNext = FoundPattern\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "scripting"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1434554726, "post_id": 30892497, "comment_id": 49830862, "body": "Please clarify are you using WSH scripting engine, or <code>ScriptControl</code> ActiveX embedded in VBA? How do you launch your script?"}], "answers": [{"tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": false, "score": 1, "last_activity_date": 1434548986, "creation_date": 1434548986, "answer_id": 30893600, "question_id": 30892497, "link": "https://stackoverflow.com/questions/30892497/using-excel-as-inputfile-in-vba-scripting-non-ms-office/30893600#30893600", "title": "Using excel as inputfile in vba (scripting - non MS OFFICE)", "body": "<p>This is confusing. VBA = MS Office VBA, as far as I know. Do you mean VB.NET? VBS? Anyway, to extract data from an xlsx file without opening it in Excel, you either need to unzip it and dig through the XML files inside, or use Office Open XML SDK or any other package like that.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/bb448854.aspx\" rel=\"nofollow\">Open XML SDK</a></p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/aa338205(v=office.12).aspx\" rel=\"nofollow\">Office Open XML fileformat</a></p>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 4849894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b57336596ffb2b49e0a14239635f8bc?s=128&d=identicon&r=PG&f=1", "display_name": "Witloofdc", "link": "https://stackoverflow.com/users/4849894/witloofdc"}, "edited": false, "score": 0, "creation_date": 1434633518, "post_id": 30894454, "comment_id": 49870132, "body": "Thanks! I found the solution inside the Excel object library"}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": true, "score": 0, "last_activity_date": 1434551077, "creation_date": 1434551077, "answer_id": 30894454, "question_id": 30892497, "link": "https://stackoverflow.com/questions/30892497/using-excel-as-inputfile-in-vba-scripting-non-ms-office/30894454#30894454", "title": "Using excel as inputfile in vba (scripting - non MS OFFICE)", "body": "<p>I think this will also work for Visual Basic [for Applications]; I tried it in Excel VBA and Word VBA:</p>\n\n<p>In VBA Development Environment, select Tools, References. In the list that now appears, check the Object Model you need. In your case you will want to check the Microsoft Excel 12.0 Object Library.</p>\n\n<p>You now have access to the complete Excel Object Model in your application and can open and manipulate an Excel spreadsheet file as you need.</p>\n\n<p>The following code in VB for Word opens an Excel Spreadsheet and gets the value of the first cell:</p>\n\n<pre><code>Sub ExcelTestInWord()\n    Dim oExcel As Object\n    Dim wb As Object\n    Dim v\n\n    'Declare a variable as a FileDialog object.\n    Dim fd As FileDialog\n    Dim vrtSelectedItem As Variant\n\n    Set oExcel = CreateObject(\"Excel.Application\")\n\n    'Create a FileDialog object as a File Picker dialog box.\n    Set fd = Application.FileDialog(msoFileDialogFilePicker)\n    If (fd.Show = -1) Then\n        For Each vrtSelectedItem In fd.SelectedItems\n            Set wb = oExcel.Workbooks.Open(vrtSelectedItem)\n            v = wb.Sheets(1).Cells(1).Value\n            wb.Close\n        Next vrtSelectedItem\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": false, "score": 0, "last_activity_date": 1434567812, "creation_date": 1434567812, "answer_id": 30900234, "question_id": 30892497, "link": "https://stackoverflow.com/questions/30892497/using-excel-as-inputfile-in-vba-scripting-non-ms-office/30900234#30900234", "title": "Using excel as inputfile in vba (scripting - non MS OFFICE)", "body": "<p>Consider the VBScript code below as an example, save it as .vbs file to launch:</p>\n\n<pre><code>Option Explicit\nDim strSourceFilePath, strSourceSheetName, strSourceRange, arrData, strResult, i, j\n\n' set initial data\nstrSourceFilePath = \"C:\\Test\\data.xlsx\"\nstrSourceSheetName = \"input\"\nstrSourceRange = \"A1:B11\"\n\n' get 2-dimensional array from Excel sheet\nWith CreateObject(\"Excel.Application\")\n    .Visible = False\n    .DisplayAlerts = False\n    With .Workbooks.Open(strSourceFilePath)\n        arrData = .Sheets(strSourceSheetName).Range(strSourceRange).Value\n        .Close\n    End With\n    .Quit\nEnd With\n\n' array output for debug purposes\nstrResult = \"\"\nFor j = 1 To UBound(arrData, 1)\n    For i = 1 To UBound(arrData, 2)\n        strResult = strResult &amp; arrData(j, i) &amp; \";\" &amp; vbTab\n    Next\n    strResult = strResult &amp; vbCrLf\nNext\nWScript.Echo strResult\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 4849894, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b57336596ffb2b49e0a14239635f8bc?s=128&d=identicon&r=PG&f=1", "display_name": "Witloofdc", "link": "https://stackoverflow.com/users/4849894/witloofdc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 30894454, "answer_count": 3, "score": 0, "last_activity_date": 1434567812, "creation_date": 1434546321, "question_id": 30892497, "link": "https://stackoverflow.com/questions/30892497/using-excel-as-inputfile-in-vba-scripting-non-ms-office", "title": "Using excel as inputfile in vba (scripting - non MS OFFICE)", "body": "<p>I'm developing a script in VBA (inside a workspace, not MS office program) that needs to use a small excel file as input. I want to use the data in the excel file and load it into a 2D array so that I can make decisions within my script based on this data. \nI've tried to google this problem but generally I find problems within excel, but I haven't had any luck finding anything for vba scripting outside MS office. </p>\n\n<p>Can I just use a .Xlsx as inputfile? \nHow do I put this data into a 2d array? My file only has 11 rows &amp; 2 columns. </p>\n\n<p>Thank you for your time. </p>\n"}, {"tags": ["excel", "vba", "ms-word", "bookmarks"], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 3918121, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/531bdda1de6b1d10871b3ea8805f8c55?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan89BEG", "link": "https://stackoverflow.com/users/3918121/stefan89beg"}, "edited": false, "score": 0, "creation_date": 1434558571, "post_id": 30893925, "comment_id": 49833637, "body": "Thanks for the quick reply."}], "tags": [], "owner": {"reputation": 572, "user_id": 2497001, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb2b8a8f50e8038ea7f9d199b68bf750?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/2497001/evan"}, "is_accepted": false, "score": 0, "last_activity_date": 1434549856, "creation_date": 1434549856, "answer_id": 30893925, "question_id": 30892397, "link": "https://stackoverflow.com/questions/30892397/how-to-populate-word-template-from-lookup-function-from-excel/30893925#30893925", "title": "How to populate word template from LOOKUP function from excel", "body": "<p>You are looking for <code>WorkSheetFunction.LOOKUP</code></p>\n\n<p>Any function you can use in a worksheets' formula bar can be used in VBA following <code>WorkSheetFunction</code></p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/hh211481(v=office.14).aspx\" rel=\"nofollow\">Here is MSDN on the <code>WorkSheetFunction</code> object</a></p>\n"}, {"comments": [{"owner": {"reputation": 572, "user_id": 2497001, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb2b8a8f50e8038ea7f9d199b68bf750?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/2497001/evan"}, "edited": false, "score": 0, "creation_date": 1434559743, "post_id": 30897379, "comment_id": 49834415, "body": "I&#39;m not sure on this but you might not have to pass ranges, that might be done down stream from your function call. Have you tired passing strings without the <code>range()</code> function?"}, {"owner": {"reputation": 109, "user_id": 3918121, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/531bdda1de6b1d10871b3ea8805f8c55?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan89BEG", "link": "https://stackoverflow.com/users/3918121/stefan89beg"}, "reply_to_user": {"reputation": 572, "user_id": 2497001, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb2b8a8f50e8038ea7f9d199b68bf750?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/2497001/evan"}, "edited": false, "score": 0, "creation_date": 1434562767, "post_id": 30897379, "comment_id": 49836257, "body": "No, I have not. I will post it a part of  a code, I am close to make it work, but from some reason debugger throws me an error."}], "tags": [], "owner": {"reputation": 109, "user_id": 3918121, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/531bdda1de6b1d10871b3ea8805f8c55?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan89BEG", "link": "https://stackoverflow.com/users/3918121/stefan89beg"}, "is_accepted": false, "score": 0, "last_activity_date": 1434558814, "creation_date": 1434558814, "answer_id": 30897379, "question_id": 30892397, "link": "https://stackoverflow.com/questions/30892397/how-to-populate-word-template-from-lookup-function-from-excel/30897379#30897379", "title": "How to populate word template from LOOKUP function from excel", "body": "<p>Thanks for the quick reply. However I've decided to insert INDEX&amp;MATCH instead of LOOKUP.</p>\n\n<p>I found some code on the web, and I was testing it with small adjustments.</p>\n\n<pre><code>Sub Test()\nDim x As String\n\n\nDim ws1, ws2 As Worksheet\nDim i As Long\nDim limit As Range\nSet ws1 = ActiveWorkbook.Sheets(\"Sheet1\")\nSet ws2 = ActiveWorkbook.Sheets(\"Sheet2\")\n\nWith ws1\n\n\n\n\nOn Error Resume Next\nx = Application.WorksheetFunction.Index(Range(\"Sheet2!$B$1:$B$5\"), Application.WorksheetFunction.Match(Range(\"Sheet1!$A$1\"), Range(\"Sheet2!$A$1:$A$5\"), 0))\n\n'=INDEX(Sheet2!$B$1:$B$5;MATCH(Sheet1!A1;Sheet2!$A$1:$A$5;0))'\n\nIf Err = 0 Then\n    ws1.Range(\"B1\") = x\nElse\n    MsgBox \"Not found\"\n    Err.Clear\nEnd If\nOn Error GoTo 0\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>But with no luck.\nFormula that I put it in a comment is working perfectly, now I am trying to incorporate it in vba shape.</p>\n\n<p>Thanks.</p>\n"}, {"tags": [], "owner": {"reputation": 109, "user_id": 3918121, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/531bdda1de6b1d10871b3ea8805f8c55?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan89BEG", "link": "https://stackoverflow.com/users/3918121/stefan89beg"}, "is_accepted": false, "score": 0, "last_activity_date": 1434563057, "creation_date": 1434563057, "answer_id": 30898715, "question_id": 30892397, "link": "https://stackoverflow.com/questions/30892397/how-to-populate-word-template-from-lookup-function-from-excel/30898715#30898715", "title": "How to populate word template from LOOKUP function from excel", "body": "<p>Here is the part of the code.</p>\n\n<pre><code> For i = 2 To total      'for each person: open the template file and update details\n\n\n    Set wDoc = wApp.Documents.Open(FILE_PATH &amp; FILE_NAME &amp; FILE_EXT, ReadOnly:=True)\n    With wApp.Selection\n     datPremFormat = Cells(i, 11).Value\n     mesDanaKamFormat = Cells(i, 12).Value\n\n\n\n           x = Application.WorksheetFunction.Index(Sheets(\"Sheet3\").Range(\"$C$2:$C$1000\"), Application.WorksheetFunction.Match(Sheets(\"Sheet1\").Range(\"B\" &amp; i), Sheets(\"Sheet3\").Range(\"$A$2:$A$1000\"), 0), 1)\n\n\n\n\n        .GoTo What:=wdGoToBookmark, Name:=BOOKMARK  'go to Bookmark \"FirstName\"\n        .TypeText personList(i, 1)                  'type the value from column 2\n\n\n\n\nEnd With\n    With wDoc   'sava and close the new Word file\n        .SaveAs2 FILE_PATH &amp; \" person \" &amp; personList(i, 1) &amp; FILE_EXT\n        .Close\n    End With\nNext\nwApp.Quit\nSet wDoc = Nothing\nSet wApp = Nothing\nMsgBox \"Created \" &amp; total &amp; \" files in \" &amp; FILE_PATH\n</code></pre>\n\n<p>So, the whole point: x string is working perfect, I just checked it through MsgBox. Aparently, I can't put it right because of this for loop. </p>\n\n<p>Run-time error:1004\nUnable to get the Match property of the WorksheetFunction class</p>\n"}], "owner": {"reputation": 109, "user_id": 3918121, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/531bdda1de6b1d10871b3ea8805f8c55?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan89BEG", "link": "https://stackoverflow.com/users/3918121/stefan89beg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1434563057, "creation_date": 1434546047, "last_edit_date": 1434551629, "question_id": 30892397, "link": "https://stackoverflow.com/questions/30892397/how-to-populate-word-template-from-lookup-function-from-excel", "title": "How to populate word template from LOOKUP function from excel", "body": "<p>If there a possibility to insert LOOKUP function to .TypeText section?</p>\n\n<p>Now, I've created another cell which is basically lookup function created on A1 cell. And that is working 100%.</p>\n\n<p>I want to remove that whole column of lookups, and incorporate it directly to code.</p>\n\n<p>Idea: From cell A1, do lookup in another sheet and pull some value, and that value import in word through bookmark.</p>\n\n<p><strong>Now:</strong></p>\n\n<pre><code>.GoTo What:=wdGoToBookmark, Name:=BOOKMARK8  \n      .TypeText personList(i, 8)`\n</code></pre>\n\n<p><strong>My Idea:</strong> </p>\n\n<pre><code>.GoTo What:=wdGoToBookmark, Name:=BOOKMARK8  \n      .TypeText Text:= LOOKUP((i, 1),Sheet2!A:A,Sheet2!B:B)`\n</code></pre>\n\n<p>Thanks.</p>\n\n<p>p.s just tell me if I was clear, otherwise I will attach .xls or full code!</p>\n"}, {"tags": ["vba", "excel", "return", "carriage-return"], "comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1434546086, "post_id": 30892174, "comment_id": 49823914, "body": "Why not for each cell between firstrow+1 to lastrow = firstrow+1?"}, {"owner": {"reputation": 13, "user_id": 5019640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4413ba87a888ae5bf3d2cc61d9764ded?s=128&d=identicon&r=PG&f=1", "display_name": "Sampson", "link": "https://stackoverflow.com/users/5019640/sampson"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1434546925, "post_id": 30892174, "comment_id": 49824631, "body": "Hi, I&#39;m not sure I follow what you mean, please can you elaborate?"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1434547199, "post_id": 30892174, "comment_id": 49824857, "body": "Where are your carriage returns? The macro you have - I don&#39;t understand how it&#39;s working on 1 to get to 2"}, {"owner": {"reputation": 13, "user_id": 5019640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4413ba87a888ae5bf3d2cc61d9764ded?s=128&d=identicon&r=PG&f=1", "display_name": "Sampson", "link": "https://stackoverflow.com/users/5019640/sampson"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1434547444, "post_id": 30892174, "comment_id": 49825084, "body": "The carriage returns are displayed as commas in 1*,  e.g. 1 (carriage return) 2 (carriage return) 3 (carriage return) 4 (carriage return) as in 1,2,3,4."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5019640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4413ba87a888ae5bf3d2cc61d9764ded?s=128&d=identicon&r=PG&f=1", "display_name": "Sampson", "link": "https://stackoverflow.com/users/5019640/sampson"}, "edited": false, "score": 0, "creation_date": 1434549415, "post_id": 30893397, "comment_id": 49826708, "body": "Thanks, that&#39;s worked fine. - Just a follow up question, but if I wanted to cover additional columns to do the same thing after e, e.g. column f,g,h which part of the cells parameter would I need to adjust to cover additional columns?"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "reply_to_user": {"reputation": 13, "user_id": 5019640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4413ba87a888ae5bf3d2cc61d9764ded?s=128&d=identicon&r=PG&f=1", "display_name": "Sampson", "link": "https://stackoverflow.com/users/5019640/sampson"}, "edited": false, "score": 0, "creation_date": 1434549483, "post_id": 30893397, "comment_id": 49826754, "body": "If you wanted to say cover E,F,G,H,I then you would change the for loop to include <code>rcolnum - 1</code> and +1, -2, +2"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "reply_to_user": {"reputation": 13, "user_id": 5019640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4413ba87a888ae5bf3d2cc61d9764ded?s=128&d=identicon&r=PG&f=1", "display_name": "Sampson", "link": "https://stackoverflow.com/users/5019640/sampson"}, "edited": false, "score": 0, "creation_date": 1434549735, "post_id": 30893397, "comment_id": 49826965, "body": "@DJHenza I added an explanation on the answer in regards to that."}], "tags": [], "owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "is_accepted": true, "score": 0, "last_activity_date": 1434549718, "last_edit_date": 1434549718, "creation_date": 1434548487, "answer_id": 30893397, "question_id": 30892174, "link": "https://stackoverflow.com/questions/30892174/vba-return-carriage-and-fill-code/30893397#30893397", "title": "VBA Return Carriage and Fill Code", "body": "<p>I just added a loop at the end looking for blanks -</p>\n\n<pre><code>Sub InString()\n\nDim rColumn As Range 'Set this to the column which needs to be worked through\nDim lFirstRow As Long\nDim lLastRow As Long\nDim lRow As Long 'Difference between first and last row\nDim lLFs As Long\nDim rRow As Range 'This will be used to drag the fill down between rows\nDim strVal As String\n\nSet rColumn = Columns(\"N\")\nlFirstRow = 2 'Starting may need to be adjusted, if additional columns are added\nlLastRow = rColumn.Cells(Rows.Count).End(xlUp).row\n\nFor lRow = lLastRow To lFirstRow Step -1\nlLFs = Len(rColumn.Cells(lRow)) - Len(Replace(rColumn.Cells(lRow), vbLf, \"\"))\nIf lLFs &gt; 0 Then\n     rColumn.Cells(lRow + 1).Resize(lLFs).EntireRow.Insert shift:=xlShiftDown 'added EntireRow to before insert, to bring whole row down, instead of previous issue where only rColumn was shifted down.\n     rColumn.Cells(lRow).Resize(lLFs + 1).Value = Application.Transpose(Split(rColumn.Cells(lRow), vbLf))\n    End If\nNext lRow\n\nlLastRow = rColumn.Cells(Rows.Count).End(xlUp).row\nDim rColNum As Integer\nrColNum = rColumn.Column\nFor i = 2 To lLastRow\n    If Cells(i, rColNum - 1) = \"\" Then\n    Cells(i, rColNum - 1) = Cells(i - 1, rColNum - 1)\n    Cells(i, rColNum + 1) = Cells(i - 1, rColNum + 1)\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p>Basically this part -</p>\n\n<pre><code>For i = 2 To lLastRow\n    If Cells(i, rColNum - 1) = \"\" Then\n    Cells(i, rColNum - 1) = Cells(i - 1, rColNum - 1)\n    Cells(i, rColNum + 1) = Cells(i - 1, rColNum + 1)\n    End If\nNext\n</code></pre>\n\n<p>Says, look at each row in the column we just split and see if the cell to the left is blank. If it is, make it the same as the one above it AND make the cell to the right the same as the one above it.</p>\n\n<p>To expand, you might then say</p>\n\n<pre><code>    if Cells(i, rColNum - 1) = \"\" Then\n    Cells(i, rColNum - 1) = Cells(i - 1, rColNum - 1)\n    Cells(i, rColNum + 1) = Cells(i - 1, rColNum + 1)\n    Cells(i, rColNum - 2) = Cells(i - 1, rColNum - 2)\n    Cells(i, rColNum + 2) = Cells(i - 1, rColNum + 2)\n    End If\n</code></pre>\n\n<p>If you wanted to cover the adjacent <strong>two columns</strong> on either side of <code>rcolumn</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1434608574, "last_edit_date": 1434608574, "creation_date": 1434548910, "answer_id": 30893570, "question_id": 30892174, "link": "https://stackoverflow.com/questions/30892174/vba-return-carriage-and-fill-code/30893570#30893570", "title": "VBA Return Carriage and Fill Code", "body": "<p>Assuming your input data is in columns <code>B, D and E</code> (as your diagram suggests) then this does the job I think:</p>\n\n<pre><code>Sub OrderData()\n    Dim inputData As Range, temp() As Variant, splitData As Variant, i As Integer, j As Integer, rw As Long\n\n    Set inputData = Range(\"B1:E2\") //Update to reflect your data\n    temp = inputData.Value\n    inputData.ClearContents\n\n    rw = 1\n    For i = 1 To UBound(temp)\n        splitData = Split(temp(i, 2), \",\")\n\n        For j = 0 To UBound(splitData)\n            Cells(rw, 2) = temp(i, 1)\n            Cells(rw, 3) = splitData(j)\n            Cells(rw, 5) = temp(i, 4)\n            rw = rw + 1\n        Next j\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5019640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4413ba87a888ae5bf3d2cc61d9764ded?s=128&d=identicon&r=PG&f=1", "display_name": "Sampson", "link": "https://stackoverflow.com/users/5019640/sampson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 30893397, "answer_count": 2, "score": 0, "last_activity_date": 1434608574, "creation_date": 1434545502, "last_edit_date": 1434547814, "question_id": 30892174, "link": "https://stackoverflow.com/questions/30892174/vba-return-carriage-and-fill-code", "title": "VBA Return Carriage and Fill Code", "body": "<p>I'm really new to vba and would appreciate any assistance in the following problem I'm having.</p>\n\n<p>Problem description (in relation to diagram below): \n1*) In c, I have managed to separate the return carriages, which leads to 2*) now that each return carriage has it's own row, I need  column b and c on either side to be filled down as shown in result 3*)</p>\n\n<pre><code>1*)     b       c       e\n        y   1,2,3,4     y\n        z   5,6,7,8     z\n\n\n\n2*)     b   c   e\n        y   1   y\n            2   \n            3   \n            4   \n        z   5   z\n            6   \n            7   \n            8   \n\n3*)     b   c   e\n        y   1   y\n        y   2   y\n        y   3   y\n        y   4   y\n        z   5   z\n        z   6   z\n        z   7   z\n        z   8   z\n</code></pre>\n\n<p>I have included my original code for everyone to inspect, I am currently stuck as to how I would get to step 3.</p>\n\n<pre><code>Sub InString()\n\nDim rColumn As Range 'Set this to the column which needs to be worked through\nDim lFirstRow As Long\nDim lLastRow As Long\nDim lRow As Long 'Difference between first and last row\nDim lLFs As Long\nDim rRow As Range 'This will be used to drag the fill down between rows\n\n\nSet rColumn = Columns(\"N\")\nlFirstRow = 2 'Starting may need to be adjusted, if additional columns are added\nlLastRow = rColumn.Cells(Rows.Count).End(xlUp).Row\n\nFor lRow = lLastRow To lFirstRow Step -1\nlLFs = Len(rColumn.Cells(lRow)) - Len(Replace(rColumn.Cells(lRow), vbLf, \"\"))\nIf lLFs &gt; 0 Then\n     rColumn.Cells(lRow + 1).Resize(lLFs).EntireRow.Insert shift:=xlShiftDown 'added EntireRow to before insert, to bring whole row down, instead of previous issue where only rColumn was shifted down.\n     rColumn.Cells(lRow).Resize(lLFs + 1).Value = Application.Transpose(Split(rColumn.Cells(lRow), vbLf))\n    End If\nNext lRow\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["vba", "excel", "debugging"], "comments": [{"owner": {"reputation": 4085, "user_id": 4185106, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/er5li.png?s=128&g=1", "display_name": "moffeltje", "link": "https://stackoverflow.com/users/4185106/moffeltje"}, "edited": false, "score": 3, "creation_date": 1434544369, "post_id": 30891628, "comment_id": 49822605, "body": "remove the last else: it is unuseful for  the current code"}, {"owner": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "reply_to_user": {"reputation": 4085, "user_id": 4185106, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/er5li.png?s=128&g=1", "display_name": "moffeltje", "link": "https://stackoverflow.com/users/4185106/moffeltje"}, "edited": false, "score": 0, "creation_date": 1434544583, "post_id": 30891628, "comment_id": 49822749, "body": "@moffeltje thanks, I don&#39;t see what Next Ind5 was supposed to line up with, but I still have the error message."}], "answers": [{"comments": [{"owner": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "edited": false, "score": 0, "creation_date": 1434544900, "post_id": 30891796, "comment_id": 49822987, "body": "That does seem to compile fine, but then I get this error message: &quot;Run-time error &#39;438&#39;: Object doesn&#39;t support this property or method&quot;. Is this related to this problem?"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "reply_to_user": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "edited": false, "score": 1, "creation_date": 1434544942, "post_id": 30891796, "comment_id": 49823015, "body": "I don&#39;t know the rest of your code. Where does error 438 occur?"}, {"owner": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "edited": false, "score": 0, "creation_date": 1434545045, "post_id": 30891796, "comment_id": 49823095, "body": "on a line with &quot;Application.CalculationxlManual&quot; near the start of my macro."}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "reply_to_user": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "edited": false, "score": 0, "creation_date": 1434545146, "post_id": 30891796, "comment_id": 49823172, "body": "That&#39;s really broad and very difficult to diagnose without the rest of the code."}, {"owner": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "edited": false, "score": 0, "creation_date": 1434545272, "post_id": 30891796, "comment_id": 49823278, "body": "I got rid of that line and it seems to work now, thanks for the help!"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "reply_to_user": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "edited": false, "score": 1, "creation_date": 1434559172, "post_id": 30891796, "comment_id": 49834043, "body": "@ThomasShera if one of the answers has solved your question, please click the green checkmark next to it to mark the question as answered."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "edited": false, "score": 0, "creation_date": 1527451698, "post_id": 30891796, "comment_id": 88122922, "body": "@ThomasShera This is how we say thank you on SO <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>"}], "tags": [], "owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "is_accepted": false, "score": 2, "last_activity_date": 1434544540, "creation_date": 1434544540, "answer_id": 30891796, "question_id": 30891628, "link": "https://stackoverflow.com/questions/30891628/vba-compile-error-else-without-if/30891796#30891796", "title": "VBA &quot;Compile Error: Else without If&quot;", "body": "<p>Change the layout of your code -</p>\n\n<pre><code>For Ind4 = 1 To iPlateNo\n    Ind6 = Ind4 + 2\n    MeanComp = 0.6 * Cells(81, Ind6).Value\n    For Ind5 = 1 To iMxRNo\n        If Cells(Ind5, Ind6).Value &lt; MeanComp Then\n        Cells(Ind5, Ind6).Interior.Color = RGB(255, 0, 0)\n'           If the cell value is less than the average highlight them red as outliers. (More likely: from pipettes that didn't release)\n        ElseIf Cells(Ind5, Ind6).Value &gt; MeanComp Then\n        Cells(Ind5, Ind6).Interior.Color = RGB(7, 253, 56)\n'           If the cell value is greater than the average highlight them green as outliers. (Unlikely unless )\n\n        End If\n    Next Ind5\nNext Ind4\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "edited": false, "score": 0, "creation_date": 1434544733, "post_id": 30891808, "comment_id": 49822861, "body": "That does seem to compile fine, but then I get this error message: &quot;Run-time error &#39;438&#39;: Object doesn&#39;t support this property or method&quot;. Is this related to this problem?"}, {"owner": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "edited": false, "score": 0, "creation_date": 1434544810, "post_id": 30891808, "comment_id": 49822921, "body": "I am running this in a larger macro, so I got rid of the Private Sub line and the End Sub line and inserted it."}, {"owner": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "reply_to_user": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "edited": false, "score": 0, "creation_date": 1434545256, "post_id": 30891808, "comment_id": 49823260, "body": "Ya sorry, I put it in an editor and needed to add the sub"}], "tags": [], "owner": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "is_accepted": false, "score": 1, "last_activity_date": 1434545285, "last_edit_date": 1434545285, "creation_date": 1434544584, "answer_id": 30891808, "question_id": 30891628, "link": "https://stackoverflow.com/questions/30891628/vba-compile-error-else-without-if/30891808#30891808", "title": "VBA &quot;Compile Error: Else without If&quot;", "body": "<pre><code>For Ind4 = 1 To iPlateNo\n    Ind6 = Ind4 + 2\n    MeanComp = 0.6 * Cells(81, Ind6).Value\n    For Ind5 = 1 To iMxRNo\n        If Cells(Ind5, Ind6).Value &lt; MeanComp Then\n            Cells(Ind5, Ind6).Interior.Color = RGB(255, 0, 0)\n        ElseIf Cells(Ind5, Ind6).Value &gt; MeanComp Then\n            Cells(Ind5, Ind6).Interior.Color = RGB(7, 253, 56)\n        End If\n    Next Ind5\nNext Ind4\n</code></pre>\n\n<p>This seems to compile just fine</p>\n\n<p>edit: removed sub procedure around code</p>\n"}, {"tags": [], "owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "is_accepted": false, "score": 0, "last_activity_date": 1511425819, "creation_date": 1511425819, "answer_id": 47450789, "question_id": 30891628, "link": "https://stackoverflow.com/questions/30891628/vba-compile-error-else-without-if/47450789#47450789", "title": "VBA &quot;Compile Error: Else without If&quot;", "body": "<pre><code>You just need to make the small change in the code that put the statement \nafter then in the next line shown in the below code highlighted as bold.\nFor Ind4 = 1 To iPlateNo\nInd6 = Ind4 + 2\nMeanComp = 0.6 * Cells(81, Ind6).Value\nFor Ind5 = 1 To iMxRNo\nIf Cells(Ind5, Ind6).Value &lt; MeanComp **Then\nCells(Ind5, Ind6).Interior.Color = RGB(255, 0, 0)**\n</code></pre>\n\n<p>'   If the cell value is less than the average highlight them red as outliers.\n    ElseIf Cells(Ind5, Ind6).Value > MeanComp <strong>Then\n    Cells(Ind5, Ind6).Interior.Color = RGB(7, 253, 56)</strong>\n    Else\n    End If\n    Next Ind5\n    Next Ind4</p>\n"}], "owner": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 570, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1527439612, "creation_date": 1434544115, "last_edit_date": 1527439612, "question_id": 30891628, "link": "https://stackoverflow.com/questions/30891628/vba-compile-error-else-without-if", "title": "VBA &quot;Compile Error: Else without If&quot;", "body": "<p>So far nobody's \"solution\" fixes my bug, any tips?</p>\n\n<p>I'm debugging a macro in VBA and I get this error:</p>\n\n<p>\"Compile error:\nElse without If\"</p>\n\n<p>Any tips on how to fix this?</p>\n\n<p>Here is the important portion of the code: </p>\n\n<pre><code>For Ind4 = 1 To iPlateNo\n    Ind6 = Ind4 + 2\n    MeanComp = 0.6 * Cells(81, Ind6).Value\n    For Ind5 = 1 To iMxRNo\n        If Cells(Ind5, Ind6).Value &lt; MeanComp Then Cells(Ind5, Ind6).Interior.Color = RGB(255, 0, 0)\n'           If the cell value is less than the average highlight them red as outliers. (More likely: from pipettes that didn't release)\n        ElseIf Cells(Ind5, Ind6).Value &gt; MeanComp Then Cells(Ind5, Ind6).Interior.Color = RGB(7, 253, 56)\n'           If the cell value is greater than the average highlight them green as outliers. (Unlikely unless )\n        Else\n        End If\n    Next Ind5\nNext Ind4\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2003"], "answers": [{"comments": [{"owner": {"reputation": 5466, "user_id": 1803692, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/umD6Q.jpg?s=128&g=1", "display_name": "Vogel612", "link": "https://stackoverflow.com/users/1803692/vogel612"}, "edited": false, "score": 4, "creation_date": 1434545335, "post_id": 30891695, "comment_id": 49823329, "body": "oh dear god this is gruesome"}], "tags": [], "owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "is_accepted": true, "score": 0, "last_activity_date": 1434544253, "creation_date": 1434544253, "answer_id": 30891695, "question_id": 30891546, "link": "https://stackoverflow.com/questions/30891546/msgbox-with-if-statement/30891695#30891695", "title": "Msgbox With If statement", "body": "<p>You could declare a String, and construct the string to display the characters. Something like,</p>\n\n<pre><code>Dim tmpRes As String\n\nIf Len(res1) &gt; 0 Then _\n    tmpRes = tmpRes &amp; res1 &amp; vbCrLf \n\nIf Len(res2) &gt; 0 Then _\n    tmpRes = tmpRes &amp; res2 &amp; vbCrLf\n\nIf Len(res3) &gt; 0 Then _\n    tmpRes = tmpRes &amp; res3 &amp; vbCrLf\n\nIf Len(res4) &gt; 0 Then _\n    tmpRes = tmpRes &amp; res4 &amp; vbCrLf\n\nIf Len(res5) &gt; 0 Then _\n    tmpRes = tmpRes &amp; res5 &amp; vbCrLf\n\nIf Len(res6) &gt; 0 Then _\n    tmpRes = tmpRes &amp; res6 &amp; vbCrLf\n\nIf Len(res7) &gt; 0 Then _\n    tmpRes = tmpRes &amp; res7 &amp; vbCrLf\n\nIf Len(res8) &gt; 0 Then _\n    tmpRes = tmpRes &amp; res8 &amp; vbCrLf\n\nIf Len(res9) &gt; 0 Then _\n    tmpRes = tmpRes &amp; res9 &amp; vbCrLf\n\nIf Len(res10) &gt; 0 Then _\n    tmpRes = tmpRes &amp; res10 &amp; vbCrLf\n\nMsgBox tmpRes\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 486, "user_id": 4559741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f52ba363a895de91b6278ebafb3888?s=128&d=identicon&r=PG&f=1", "display_name": "NicolaSysnet", "link": "https://stackoverflow.com/users/4559741/nicolasysnet"}, "is_accepted": false, "score": 1, "last_activity_date": 1434544531, "creation_date": 1434544531, "answer_id": 30891793, "question_id": 30891546, "link": "https://stackoverflow.com/questions/30891546/msgbox-with-if-statement/30891793#30891793", "title": "Msgbox With If statement", "body": "<p>If you don't want to make the string outside the msgbox function call you can use an inline if:</p>\n\n<pre><code>MsgBox (res1 &amp; Iif(res1&lt;&gt;\"\", vbNewLine, \"\") &amp; _\nres2 &amp; Iif(res2&lt;&gt;\"\", vbNewLine, \"\") &amp; _\nres3 &amp; Iif(res3&lt;&gt;\"\", vbNewLine, \"\") &amp; _\nres4 &amp; Iif(res4&lt;&gt;\"\", vbNewLine, \"\") &amp; _\nres5 &amp; Iif(res5&lt;&gt;\"\", vbNewLine, \"\") &amp; _\nres6 &amp; Iif(res6&lt;&gt;\"\", vbNewLine, \"\") &amp; _\nres7 &amp; Iif(res7&lt;&gt;\"\", vbNewLine, \"\") &amp; _\nres8 &amp; Iif(res8&lt;&gt;\"\", vbNewLine, \"\") &amp; _\nres9 &amp; Iif(res9&lt;&gt;\"\", vbNewLine, \"\") &amp; _\nres10 &amp; Iif(res10&lt;&gt;\"\", vbNewLine, \"\") &amp; _\nres11 &amp; Iif(res11&lt;&gt;\"\", vbNewLine, \"\") &amp; _\nres12 &amp; Iif(res12&lt;&gt;\"\", vbNewLine, \"\") )\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "is_accepted": false, "score": 3, "last_activity_date": 1434544945, "creation_date": 1434544945, "answer_id": 30891946, "question_id": 30891546, "link": "https://stackoverflow.com/questions/30891546/msgbox-with-if-statement/30891946#30891946", "title": "Msgbox With If statement", "body": "<p>Good grief everyone is making this harder than it has to be...</p>\n\n<p>Store all of your string variables in an array, and then create a <code>BuildMessage</code> function that takes in the array, and then loops over it, returning the final message.</p>\n\n<pre><code>Public Sub Test()\n\n    Const res1 As String = vbNullString\n    Const res2 As String = \"Hello\"\n    Const res3 As String = vbNullString\n    Const res4 As String = \"GoodBye\"\n    Const res5 As String = vbNullString\n\n    Dim resArr As Variant\n    resArr = Array(res1, res2, res3, res4, res5)\n\n    Dim msg As String\n    msg = BuildMessage(resArr)\n\n    MsgBox msg\n\nEnd Sub\n\nPrivate Function BuildMessage(ByVal arr As Variant) As String\n\n    Dim msg As String\n\n    Dim i As Long\n    For i = LBound(arr) To UBound(arr)\n        Dim str As String\n        str = arr(i)\n\n        If str &lt;&gt; vbNullString Then\n            msg = msg &amp; str &amp; vbNewLine\n        End If\n    Next\n\n    BuildMessage = msg\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 4989217, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b0d08961fd579f4943eed96a7e00edbe?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/4989217/richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2686, "favorite_count": 0, "accepted_answer_id": 30891695, "answer_count": 3, "score": 1, "last_activity_date": 1434544945, "creation_date": 1434543886, "last_edit_date": 1531164843, "question_id": 30891546, "link": "https://stackoverflow.com/questions/30891546/msgbox-with-if-statement", "title": "Msgbox With If statement", "body": "<p>I'm trying to get a box to pop up listing a number of values that could be blank.</p>\n\n<pre><code>MsgBox (res1 &amp; vbNewLine &amp; _\nres2 &amp; vbNewLine &amp; _\nres3 &amp; vbNewLine &amp; _\nres4 &amp; vbNewLine &amp; _\nres5 &amp; vbNewLine &amp; _\nres6 &amp; vbNewLine &amp; _\nres7 &amp; vbNewLine &amp; _\nres8 &amp; vbNewLine &amp; _\nres9 &amp; vbNewLine &amp; _\nres10 &amp; vbNewLine &amp; _\nres11 &amp; vbNewLine &amp; _\nres12 &amp; vbNewLine)\n</code></pre>\n\n<p>what I want to do is have is something like this: </p>\n\n<pre><code>if res1 &lt;&gt; \"\" then\n    res1 &amp; vbNewLine \nelse\n    \"\"\nend if\n</code></pre>\n\n<p>Because what shows at the moment is load of blank lines:</p>\n\n<p><img src=\"https://i.stack.imgur.com/M4PZf.png\" alt=\"http://i.stack.imgur.com/M4PZf.png\"></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 189, "user_id": 4385971, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qQ2EG.png?s=128&g=1", "display_name": "JPM", "link": "https://stackoverflow.com/users/4385971/jpm"}, "edited": false, "score": 0, "creation_date": 1434543687, "post_id": 30891386, "comment_id": 49822055, "body": "Reason for downvote?"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1434544367, "post_id": 30891386, "comment_id": 49822603, "body": "This is a &#39;write me the code&#39; question, isn&#39;t it?"}, {"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 1, "creation_date": 1434544816, "post_id": 30891386, "comment_id": 49822928, "body": "@MarkFitzgerald - I read the OP&#39;s actual question as &quot;How do I make code in a sheet change things outside the sheet?&quot; The text of the question seems pretty clear to me that he&#39;s done research on what he needs to do, but found a roadblock he didn&#39;t know how to get around."}, {"owner": {"reputation": 189, "user_id": 4385971, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qQ2EG.png?s=128&g=1", "display_name": "JPM", "link": "https://stackoverflow.com/users/4385971/jpm"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1434545373, "post_id": 30891386, "comment_id": 49823358, "body": "@MarkFitzgerald I didn&#39;t mean for it to come across as that and it was certainly not my intension. Have added the code I previously used to show evidence. Might be helpful to allow the OP to rectify the mistake before downvoting. Thanks :)"}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 4385971, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qQ2EG.png?s=128&g=1", "display_name": "JPM", "link": "https://stackoverflow.com/users/4385971/jpm"}, "edited": false, "score": 0, "creation_date": 1434544103, "post_id": 30891500, "comment_id": 49822402, "body": "Hello. Thank you for your quick response. I was almost there, just needed a hand in the right direction. Thanks for the help :)"}, {"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 0, "creation_date": 1434544288, "post_id": 30891500, "comment_id": 49822557, "body": "OP mentioned that he had learned how to put code in a sheet looking for the change. He just needed a nudge that the code could affect things <i>outside</i> the sheet."}], "tags": [], "owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "is_accepted": true, "score": 1, "last_activity_date": 1434543767, "creation_date": 1434543767, "answer_id": 30891500, "question_id": 30891386, "link": "https://stackoverflow.com/questions/30891386/excel-how-to-show-the-last-date-different-worksheets-were-changed/30891500#30891500", "title": "Excel - How to show the last date different worksheets were changed", "body": "<p>You're very close. While the <em>code</em> does need to be on the sheet that is changing, it can <em>reference</em> the <code>Main Menu</code> sheet, like so:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Sheets(\"Main Menu\").Range(\"A1\").Value = Now()\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "is_accepted": false, "score": 0, "last_activity_date": 1434544206, "creation_date": 1434544206, "answer_id": 30891676, "question_id": 30891386, "link": "https://stackoverflow.com/questions/30891386/excel-how-to-show-the-last-date-different-worksheets-were-changed/30891676#30891676", "title": "Excel - How to show the last date different worksheets were changed", "body": "<p>On your button click, just add this in before changing the worksheet</p>\n\n<pre><code>Sub Button1_Click()\n ActiveSheet.Buttons(Application.Caller).TopLeftCell.Offset(, 1) = Now()\nEnd Sub\n</code></pre>\n\n<p>This will put the value of now in the cell to the right of the button. If the button takes up more than just one cell, offset accordingly.</p>\n"}], "owner": {"reputation": 189, "user_id": 4385971, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qQ2EG.png?s=128&g=1", "display_name": "JPM", "link": "https://stackoverflow.com/users/4385971/jpm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 30891500, "answer_count": 2, "score": -1, "last_activity_date": 1434545176, "creation_date": 1434543458, "last_edit_date": 1531161705, "question_id": 30891386, "link": "https://stackoverflow.com/questions/30891386/excel-how-to-show-the-last-date-different-worksheets-were-changed", "title": "Excel - How to show the last date different worksheets were changed", "body": "<p>This is my scenario:</p>\n\n<p>I have an excel Workbook with a number of different Worksheets. This Workbook is given to project managers within my organisation to complete. I have a Worksheet within this Workbook titled \"Main Menu\" which contains buttons that navigate the user to a number of different Worksheets e.g. The Registration page. The Workbook does not need to be complete in any particular order. This is so that users are able to return to a section if they do not have the information to complete it at that time.</p>\n\n<p>The problem I have is that sometimes it may take a few weeks or even months for that information to come back. This has caused users to forget which section of the Workbook they were last working on. What I would like to have is a Cell on the Main Menu that will be next to the corrensponding navigation button, that will show when that section was laste edited.</p>\n\n<p>I've done some researching and have been able to find out how to show the last date the Workbook was saved, but this is not useful to me as I need it for each individual Worksheet and this method only displays the last saved date for the whole Workbook. The code for this is as follows:</p>\n\n<pre><code>Function LastSavedTimeStamp() As Date\nLastSavedTimeStamp = ActiveWorkbook.BuiltinDocumentProperties(\"Last Save Time\")    \nEnd Function\n</code></pre>\n\n<p>I have also found other methods to show the last date the worksheet was changed but from the code I have seen, you need to put this on the same worksheet page, where as I want to display this date on a different Worksheet.</p>\n\n<p>Any help would be much appericated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2364, "user_id": 4347337, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/xu2hN.jpg?s=128&g=1", "display_name": "Brino", "link": "https://stackoverflow.com/users/4347337/brino"}, "edited": false, "score": 0, "creation_date": 1434546267, "post_id": 30891314, "comment_id": 49824074, "body": "what exactly is your question?"}, {"owner": {"reputation": 59, "user_id": 5011249, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c17b0a9ef5c5f17ace7d4917c5fdc494?s=128&d=identicon&r=PG&f=1", "display_name": "SeanBaird", "link": "https://stackoverflow.com/users/5011249/seanbaird"}, "reply_to_user": {"reputation": 2364, "user_id": 4347337, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/xu2hN.jpg?s=128&g=1", "display_name": "Brino", "link": "https://stackoverflow.com/users/4347337/brino"}, "edited": false, "score": 0, "creation_date": 1434546337, "post_id": 30891314, "comment_id": 49824130, "body": "the code above does not work as described. Im looking for suggestions on how to get the code to keep going up a row until a value other than continued is found"}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1434546610, "post_id": 30891314, "comment_id": 49824368, "body": "link to original question: <a href=\"http://stackoverflow.com/questions/30863663/have-search-function-need-help-editing/30870718#comment49823730_30870718\" title=\"have search function need help editing\">stackoverflow.com/questions/30863663/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 5011249, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c17b0a9ef5c5f17ace7d4917c5fdc494?s=128&d=identicon&r=PG&f=1", "display_name": "SeanBaird", "link": "https://stackoverflow.com/users/5011249/seanbaird"}, "edited": false, "score": 0, "creation_date": 1434547100, "post_id": 30892602, "comment_id": 49824773, "body": "sorry I don&#39;t think I explained myself very well before this was pointed out to me so ive added some more data to the question. I tried your code but I already have the for command in use so it wont let me use it again."}, {"owner": {"reputation": 1868, "user_id": 1359794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f7dfa7ac7d032d1a0d71bfffffb803?s=128&d=identicon&r=PG", "display_name": "Zaider", "link": "https://stackoverflow.com/users/1359794/zaider"}, "reply_to_user": {"reputation": 59, "user_id": 5011249, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c17b0a9ef5c5f17ace7d4917c5fdc494?s=128&d=identicon&r=PG&f=1", "display_name": "SeanBaird", "link": "https://stackoverflow.com/users/5011249/seanbaird"}, "edited": false, "score": 0, "creation_date": 1434550532, "post_id": 30892602, "comment_id": 49827605, "body": "@SeanBaird what is the error message you receive when you try and use another for loop?  You should be able to nest multiple for loops."}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1434551519, "post_id": 30892602, "comment_id": 49828376, "body": "It&#39;s because you have used the object &#39;i&#39; in the previous loop. Change it to &#39;j&#39; or &#39;k&#39; or some different identifier in nested loops"}], "tags": [], "owner": {"reputation": 1868, "user_id": 1359794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f7dfa7ac7d032d1a0d71bfffffb803?s=128&d=identicon&r=PG", "display_name": "Zaider", "link": "https://stackoverflow.com/users/1359794/zaider"}, "is_accepted": false, "score": 1, "last_activity_date": 1434546584, "creation_date": 1434546584, "answer_id": 30892602, "question_id": 30891314, "link": "https://stackoverflow.com/questions/30891314/loop-up-rows-until-value-does-not-equal-continued/30892602#30892602", "title": "Loop Up rows until Value DOES NOT equal Continued", "body": "<p>To loop backwards you can use a for loop with <code>step - 1</code>.</p>\n\n<p>You will need to know what the lowest row you are starting on is.  If it is just the last row in your column you can use this.</p>\n\n<pre><code>Dim lastRow As Long\nlastRow = ActiveSheet.Cells(ActiveSheet.Rows.Count, 1).End(xlUp).Row\n</code></pre>\n\n<p>You then loop to the highest cell that has values and if that is your first row it would be 1:</p>\n\n<pre><code>For i = lastRow To 1 Step -1\n    If .Cells(i, 1) &lt;&gt; \"continue\" Then\n        ' Do things when the value doesn't equal continue here.\n        Exit For\n    End If\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": true, "score": 1, "last_activity_date": 1434555509, "last_edit_date": 1434555509, "creation_date": 1434551850, "answer_id": 30894767, "question_id": 30891314, "link": "https://stackoverflow.com/questions/30891314/loop-up-rows-until-value-does-not-equal-continued/30894767#30894767", "title": "Loop Up rows until Value DOES NOT equal Continued", "body": "<p>This should work...</p>\n\n<pre><code>    For j = 0 To SourceCell.Row - 1\n        If .Cells(SourceCell.Row - j, 3).Value &lt;&gt; \"continued.\" Then\n            wsFHA.Cells(RowCounter, 7).Value = .Cells(SourceCell.Row - j, 3).Value\n            Exit For\n        End If\n    Next j\n</code></pre>\n\n<p>And to add in further search terms replace the main code loop with the following code...</p>\n\n<pre><code>    Dim SourceCell As Range, FirstAdr As String\n    Dim RowCounter As Long: RowCounter = 3\n\n    Dim SearchTarget() As String\n    SearchTarget = Split(\"9.1,SearchItem 2,etc...\", \",\")\n\n    For i = 0 To UBound(SearchTarget)\n        If Worksheets.Count &gt; 1 Then\n            For j = 1 To Worksheets.Count - 1\n            With Sheets(j)\n                Set SourceCell = .Columns(7).Find(SearchTarget(i), LookAt:=xlWhole)\n                If Not SourceCell Is Nothing Then\n                    FirstAdr = SourceCell.Address\n                    Do\n                        wsFHA.Cells(RowCounter, 2).Value = SearchTarget(i)\n                        wsFHA.Cells(RowCounter, 3).Value = .Cells(SourceCell.Row, 6).Value\n                        wsFHA.Cells(RowCounter, 4).Value = .Cells(3, 10).Value\n                        wsFHA.Cells(RowCounter, 5).Value = .Cells(2, 3).Value\n                        wsFHA.Cells(RowCounter, 6).Value = .Cells(SourceCell.Row, 2).Value\n                        For k = 0 To SourceCell.Row - 1\n                            If .Cells(SourceCell.Row - k, 3).Value &lt;&gt; \"continue.\" Then\n                                wsFHA.Cells(RowCounter, 7).Value = .Cells(SourceCell.Row - k, 3).Value\n                                Exit For\n                            End If\n                        Next k\n                        wsFHA.Cells(RowCounter, 8).Value = .Cells(SourceCell.Row, 14).Value\n                        Set SourceCell = .Columns(7).FindNext(SourceCell)\n                        RowCounter = RowCounter + 1\n                    Loop While Not SourceCell Is Nothing And SourceCell.Address &lt;&gt; FirstAdr\n                End If\n            End With\n            Next j\n        End If\n    Next i\n</code></pre>\n\n<p>You'll need to edit the array for your terms though, delimiting each with a comma...\nI've also tweaked the loop variables to be i,j,k in order so there's a slight difference to the first code block</p>\n\n<pre><code>    SearchTarget = Split(\"9.1,SearchItem 2,etc...\", \",\")\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 5011249, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c17b0a9ef5c5f17ace7d4917c5fdc494?s=128&d=identicon&r=PG&f=1", "display_name": "SeanBaird", "link": "https://stackoverflow.com/users/5011249/seanbaird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2730, "favorite_count": 0, "accepted_answer_id": 30894767, "answer_count": 2, "score": 1, "last_activity_date": 1434555509, "creation_date": 1434543286, "last_edit_date": 1434547326, "question_id": 30891314, "link": "https://stackoverflow.com/questions/30891314/loop-up-rows-until-value-does-not-equal-continued", "title": "Loop Up rows until Value DOES NOT equal Continued", "body": "<p>This is a small section of a larger code. basically if the cell contains the word continued I need to look in the cell above, if this cell contains the word continued then I need to continue to loop up the rows until a value which is not continued is found. This is what I have so far ?</p>\n\n<pre><code>      Do\n            If .Cells(SourceCell.Row, 3).Value = \"continued.\" Then\n              wsFHA.Cells(RowCounter, 7).Value = .Cells(SourceCell.Offset(rowoffset:=-1).Row, 3).Value\n\n            End If\n      Loop Until .Cells(SourceCell.Row, 3).Value &lt;&gt; \"continued.\"\n</code></pre>\n\n<p>The code above is a smaller part of this code the code is to search for failure mode and causes. However in the source data sometimes the same value is repeated. in this case the word continued appears in the cell and you must refer to the information in the cell above. However for the purposes of coalating the data i need the actual information not the word continued. im trying to make the code find this information but am struggling.</p>\n\n<pre><code>Sub Create_FHA_Table()\n    Dim Headers() As String: Headers = _\n    Split(\"FHA Ref,Engine Effect,Part No,Part Name,FM I.D,Failure Mode &amp; Cause,FMCM,PTR,ETR\", \",\")\n\n    If Not WorksheetExists(\"FHA\") Then Worksheets.Add().Name = \"FHA\"\n    Dim wsFHA As Worksheet: Set wsFHA = Sheets(\"FHA\")\n    wsFHA.Move after:=Worksheets(Worksheets.Count)\n    wsFHA.Cells.Clear\n\n    Application.ScreenUpdating = False\n\n    With wsFHA\n        For i = 0 To UBound(Headers)\n            .Cells(2, i + 2) = Headers(i)\n            .Columns(i + 2).EntireColumn.AutoFit\n        Next i\n        .Cells(1, 2) = \"FHA TABLE\"\n        .Range(.Cells(1, 2), .Cells(1, UBound(Headers) + 2)).MergeCells = True\n        .Range(.Cells(1, 2), .Cells(1, UBound(Headers) + 2)).HorizontalAlignment = xlCenter\n        .Range(.Cells(1, 2), .Cells(2, UBound(Headers) + 2)).Font.Bold = True\n    End With\n\n\n\n    Dim RowCounter As Long: RowCounter = 3\n    Dim SearchTarget As String 'must copy and paste between these bookmarks for each new code, \"SearchTarget#\"\n    SearchTarget = \"9.1\" 'Must update SearchTarget#\n    Dim SourceCell As Range, FirstAdr As String\n\n    If Worksheets.Count &gt; 1 Then\n        For i = 1 To Worksheets.Count - 1\n        With Sheets(i)\n            Set SourceCell = .Columns(7).Find(SearchTarget, LookAt:=xlWhole) 'Must Update SearchTarget# to correspond with above\n            If Not SourceCell Is Nothing Then\n                FirstAdr = SourceCell.Address\n                Do\n                    wsFHA.Cells(RowCounter, 2).Value = SearchTarget 'Must Update SearchTarget# to correspond with above\n                    wsFHA.Cells(RowCounter, 3).Value = .Cells(SourceCell.Row, 6).Value\n                    wsFHA.Cells(RowCounter, 4).Value = .Cells(3, 10).Value\n                    wsFHA.Cells(RowCounter, 5).Value = .Cells(2, 10).Value\n                    wsFHA.Cells(RowCounter, 6).Value = .Cells(SourceCell.Row, 2).Value\n                    wsFHA.Cells(RowCounter, 7).Value = .Cells(SourceCell.Row, 3).Value\n\n\n                    If .Cells(SourceCell.Row, 3).Value = \"continued.\" Then\n                      wsFHA.Cells(RowCounter, 7).Value = .Cells(SourceCell.Offset(rowoffset:=-1).Row, 3).Value\n                    End If\n\n\n\n\n                    wsFHA.Cells(RowCounter, 8).Value = .Cells(SourceCell.Row, 14).Value\n                    Set SourceCell = .Columns(7).FindNext(SourceCell)\n                    RowCounter = RowCounter + 1\n                Loop While Not SourceCell Is Nothing And SourceCell.Address &lt;&gt; FirstAdr\n            End If\n        End With\n        Next i\n    End If\n\n\n\n\n\n\n    Application.ScreenUpdating = True\n\n\nEnd Sub\n\nPublic Function WorksheetExists(ByVal WorksheetName As String) As Boolean\n    On Error Resume Next\n    WorksheetExists = (ThisWorkbook.Sheets(WorksheetName).Name &lt;&gt; \"\")\n    On Error GoTo 0\n</code></pre>\n"}, {"tags": ["vba", "outlook", "outlook-2010"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1434548022, "creation_date": 1434548022, "answer_id": 30893202, "question_id": 30891255, "link": "https://stackoverflow.com/questions/30891255/how-do-i-programatically-open-additional-mailboxes-in-outlook-2010/30893202#30893202", "title": "How do I programatically open additional mailboxes in Outlook 2010?", "body": "<p>The Outlook object model (Outlook VBA) doesn't provide anything for editing user profiles. You can try to use a low level API - Extended MAPI. See <a href=\"https://msdn.microsoft.com/en-us/library/office/cc842204.aspx\" rel=\"nofollow\">Administering Profiles and Message Services</a> for more information.</p>\n"}, {"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1434565863, "creation_date": 1434565863, "answer_id": 30899585, "question_id": 30891255, "link": "https://stackoverflow.com/questions/30891255/how-do-i-programatically-open-additional-mailboxes-in-outlook-2010/30899585#30899585", "title": "How do I programatically open additional mailboxes in Outlook 2010?", "body": "<p>Since you are using VBA, you cannot uses Extended MAPI (C++ or Delphi).</p>\n\n<p>If using <a href=\"http://www.dimastr.com/redemption/\" rel=\"nofollow\">Redemption</a> is an option, you can us its RDOSession.Stores.<a href=\"http://www.dimastr.com/redemption/rdostores.htm\" rel=\"nofollow\">AddDelegateExchangeMailBoxStore</a> method to add a delegate mailbox to the current profile.</p>\n\n<p>If you do not want to log to the profile fist, you can use the ProfMan library to add a mailbox. See <a href=\"http://www.dimastr.com/redemption/profman_examples.htm#example6\" rel=\"nofollow\">http://www.dimastr.com/redemption/profman_examples.htm#example6</a></p>\n"}], "owner": {"reputation": 384, "user_id": 557644, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fb1782c8a3269c695cb8d538caea84d0?s=128&d=identicon&r=PG", "display_name": "Matty Brown", "link": "https://stackoverflow.com/users/557644/matty-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 835, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593157315, "creation_date": 1434543114, "last_edit_date": 1593157315, "question_id": 30891255, "link": "https://stackoverflow.com/questions/30891255/how-do-i-programatically-open-additional-mailboxes-in-outlook-2010", "title": "How do I programatically open additional mailboxes in Outlook 2010?", "body": "<p>Our sales department monitor eachothers mailboxes.  Each user has every other users mailboxes open as an additional mailbox.</p>\n\n<p>Whenever a new employee comes along, we have to visit each users' PC to add the additional mailbox(es) to their Outlook profile.  This is a waste of resources and is something I'd like to automate.</p>\n\n<p>There must be a way of programmatically doing this via VBA Script, or some such means?  Searching on Google hasn't been particularly helpful.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 1, "last_activity_date": 1434543493, "creation_date": 1434543493, "answer_id": 30891399, "question_id": 30891245, "link": "https://stackoverflow.com/questions/30891245/getobject-outlook-application-not-working-with-outlook-open/30891399#30891399", "title": "GetObject(, &quot;Outlook.Application&quot;) not working with Outlook open", "body": "<p>In my experience, I use this to avoid this problem :</p>\n\n<pre><code>On Error Resume Next\nSet oWord = GetObject(, \"Word.Application\")\nIf Err.Number &lt;&gt; 0 Then\n    Set oWord = CreateObject(\"Word.Application\")\nEnd If\nOn Error GoTo 0\n</code></pre>\n\n<p>But actually I have no clue where the issue come from... It just pass by for me sometimes!</p>\n"}, {"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1434547292, "creation_date": 1434547292, "answer_id": 30892908, "question_id": 30891245, "link": "https://stackoverflow.com/questions/30891245/getobject-outlook-application-not-working-with-outlook-open/30892908#30892908", "title": "GetObject(, &quot;Outlook.Application&quot;) not working with Outlook open", "body": "<p>On systems with UAC both applications should be run under the same security context. For example, if one of the applications is run with admin privileges, another should be run with admin privileges as well to access a running instance. </p>\n\n<p>You may find the <a href=\"https://support.microsoft.com/en-us/kb/201096?wa=wsignin1.0\" rel=\"nofollow\">How to automate Outlook from another program</a> article helpful.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7670551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d35b84c47bba216779f8c15ae585125c?s=128&d=identicon&r=PG", "display_name": "SkyscraperFX", "link": "https://stackoverflow.com/users/7670551/skyscraperfx"}, "is_accepted": false, "score": 0, "last_activity_date": 1488868177, "creation_date": 1488868177, "answer_id": 42641655, "question_id": 30891245, "link": "https://stackoverflow.com/questions/30891245/getobject-outlook-application-not-working-with-outlook-open/42641655#42641655", "title": "GetObject(, &quot;Outlook.Application&quot;) not working with Outlook open", "body": "<p>I used to have to do this because that error came up when the first getobject failed, so I started repeating it 3 or more times, and never had an issue again:</p>\n\n<pre><code>on error resume next\nDim AutoCAD As Object\nDim Thisdrawing As Object\nDim activedocument As Object\nDim acadapplication As Object\nDim acadapp As Object\nSet acadapp = GetObject(, \"autocad.application.14\")\nSet acadapp = GetObject(, \"autocad.application.15\")\nSet acadapp = GetObject(, \"autocad.application.16\")\nSet acadapp = GetObject(, \"autocad.application.17\")\nSet acadapp = GetObject(, \"autocad.application.18\")\nSet acadapp = GetObject(, \"autocad.application.19\")\nSet acadapp = GetObject(, \"autocad.application.20\")\nSet acadapp = GetObject(, \"autocad.application.21\")\nSet acadapp = GetObject(, \"autocad.application.22\")\nSet acadapp = GetObject(, \"autocad.application.23\")\nSet acadapp = GetObject(, \"autocad.application.24\")\nSet acadapp = GetObject(, \"autocad.application.25\")\nSet acadapp = GetObject(, \"autocad.application.26\")\nSet acadapp = GetObject(, \"autocad.application.27\")\nSet acadapp = GetObject(, \"autocad.application.28\")\nSet acadapp = GetObject(, \"autocad.application.29\")\nSet acadapp = GetObject(, \"autocad.application.30\")\n\nSet acadapp = GetObject(, \"autocad.application\")\nSet acadapp = GetObject(, \"autocad.application\")\nSet acadapp = GetObject(, \"autocad.application\")\n</code></pre>\n\n<p>Just in case there were newer versions I tried them all once, then repeated the usual a number of times. Never had a fail again.</p>\n"}, {"comments": [{"owner": {"reputation": 728, "user_id": 8769365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aad49df22335ea388301a2461640e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nacorid", "link": "https://stackoverflow.com/users/8769365/nacorid"}, "edited": false, "score": 0, "creation_date": 1552899185, "post_id": 48870575, "comment_id": 97170261, "body": "Can you explain why you <code>Set Outlook = CreateObject(&quot;Outlook.Application&quot;)</code> right after waiting for the <code>Shell</code> function to finish with your <code>Do While</code> Loop? Also: Wouldn&#39;t this cause an infinite loop if Outlook is not installed on a machine?"}, {"owner": {"reputation": 611, "user_id": 7028122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1753969188187785/picture?type=large", "display_name": "Riccardo La Marca", "link": "https://stackoverflow.com/users/7028122/riccardo-la-marca"}, "reply_to_user": {"reputation": 728, "user_id": 8769365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aad49df22335ea388301a2461640e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nacorid", "link": "https://stackoverflow.com/users/8769365/nacorid"}, "edited": false, "score": 0, "creation_date": 1554304740, "post_id": 48870575, "comment_id": 97704290, "body": "Shell &quot;Outlook&quot; start the process while GetObject(, &quot;Outlook.Application&quot;) run until the process is completely started."}, {"owner": {"reputation": 728, "user_id": 8769365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aad49df22335ea388301a2461640e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nacorid", "link": "https://stackoverflow.com/users/8769365/nacorid"}, "edited": false, "score": 0, "creation_date": 1554306443, "post_id": 48870575, "comment_id": 97705372, "body": "Wouldn&#39;t <code>CreateObject(&quot;Outlook.Application&quot;)</code> creates a new instance of Outlook? Making your two <code>GetObject( , &quot;Outlook.Application&quot;)</code> and your <code>Shell</code> command obsolete?"}, {"owner": {"reputation": 611, "user_id": 7028122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1753969188187785/picture?type=large", "display_name": "Riccardo La Marca", "link": "https://stackoverflow.com/users/7028122/riccardo-la-marca"}, "reply_to_user": {"reputation": 728, "user_id": 8769365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aad49df22335ea388301a2461640e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nacorid", "link": "https://stackoverflow.com/users/8769365/nacorid"}, "edited": false, "score": 0, "creation_date": 1554396206, "post_id": 48870575, "comment_id": 97746585, "body": "I want obtain the current instance of Outlook and not create a new instance, i want also check if i can access at the object methods."}, {"owner": {"reputation": 728, "user_id": 8769365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aad49df22335ea388301a2461640e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nacorid", "link": "https://stackoverflow.com/users/8769365/nacorid"}, "edited": false, "score": 0, "creation_date": 1554409442, "post_id": 48870575, "comment_id": 97752949, "body": "You should check <code>If Outlook Is Nothing</code> before setting it again, because that call overwrites your prior calls."}, {"owner": {"reputation": 611, "user_id": 7028122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1753969188187785/picture?type=large", "display_name": "Riccardo La Marca", "link": "https://stackoverflow.com/users/7028122/riccardo-la-marca"}, "reply_to_user": {"reputation": 728, "user_id": 8769365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aad49df22335ea388301a2461640e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nacorid", "link": "https://stackoverflow.com/users/8769365/nacorid"}, "edited": false, "score": 0, "creation_date": 1554845949, "post_id": 48870575, "comment_id": 97899222, "body": "Every time that the GetObject fails, the object will always remain Nothing. Only when it succeeds, the object will get the instance of Outlook and consequently the while loop ends."}, {"owner": {"reputation": 728, "user_id": 8769365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aad49df22335ea388301a2461640e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nacorid", "link": "https://stackoverflow.com/users/8769365/nacorid"}, "edited": false, "score": 0, "creation_date": 1554931925, "post_id": 48870575, "comment_id": 97936193, "body": "Yes, but after your loop you <code>Set</code> the object again, thus making your loop and any prior <code>GetObject()</code> calls obsolete."}, {"owner": {"reputation": 611, "user_id": 7028122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1753969188187785/picture?type=large", "display_name": "Riccardo La Marca", "link": "https://stackoverflow.com/users/7028122/riccardo-la-marca"}, "reply_to_user": {"reputation": 728, "user_id": 8769365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aad49df22335ea388301a2461640e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nacorid", "link": "https://stackoverflow.com/users/8769365/nacorid"}, "edited": false, "score": 0, "creation_date": 1554993954, "post_id": 48870575, "comment_id": 97961808, "body": "Because GetObject sometimes not return correctly the object. I use GetObject for check if application is opened."}, {"owner": {"reputation": 728, "user_id": 8769365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aad49df22335ea388301a2461640e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nacorid", "link": "https://stackoverflow.com/users/8769365/nacorid"}, "edited": false, "score": 0, "creation_date": 1554994268, "post_id": 48870575, "comment_id": 97962021, "body": "In that case you should definitely add that to your answer."}], "tags": [], "owner": {"reputation": 611, "user_id": 7028122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1753969188187785/picture?type=large", "display_name": "Riccardo La Marca", "link": "https://stackoverflow.com/users/7028122/riccardo-la-marca"}, "is_accepted": false, "score": 0, "last_activity_date": 1555113058, "last_edit_date": 1555113058, "creation_date": 1519058714, "answer_id": 48870575, "question_id": 30891245, "link": "https://stackoverflow.com/questions/30891245/getobject-outlook-application-not-working-with-outlook-open/48870575#48870575", "title": "GetObject(, &quot;Outlook.Application&quot;) not working with Outlook open", "body": "<pre><code>Option Explicit\nFunction CreateOutlook() As Object\n    Dim Outlook As Object\n    On Error Resume Next\n        Set Outlook = GetObject(, \"Outlook.Application\")\n    On Error GoTo 0\n    If Outlook Is Nothing Then Shell \"Outlook\"\n    On Error Resume Next\n        Do While Outlook Is Nothing\n            Set Outlook = GetObject(, \"Outlook.Application\")\n        Loop\n    On Error GoTo 0\n    Set Outlook = CreateObject(\"Outlook.Application\")\n    Outlook.ActiveWindow.WindowState = 1\n    Set CreateOutlook = Outlook\n    Set Outlook = Nothing\nEnd Function\n\nSub Test()\n    Dim Outlook As Object\n    Set Outlook = CreateOutlook()\n    ... 'Other operations\nEnd Sub\n</code></pre>\n\n<p>All works perfectly.</p>\n\n<p>Edit:</p>\n\n<p>GetObject sometimes not return correctly the object. I use GetObject for check if application is opened. When the application is opened i create a object that works correctly.</p>\n"}], "owner": {"reputation": 51, "user_id": 5019294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25539333ab6272dac835d88338b02342?s=128&d=identicon&r=PG&f=1", "display_name": "qagofnz", "link": "https://stackoverflow.com/users/5019294/qagofnz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8067, "favorite_count": 1, "answer_count": 4, "score": 5, "last_activity_date": 1596124985, "creation_date": 1434543094, "question_id": 30891245, "link": "https://stackoverflow.com/questions/30891245/getobject-outlook-application-not-working-with-outlook-open", "title": "GetObject(, &quot;Outlook.Application&quot;) not working with Outlook open", "body": "<p>I am using the below code in an Excel file which can be accessed and used by multiple people. The extract checks to see if Outlook is open before proceeding with the rest of the code.</p>\n\n<pre><code>Dim oOutlook As Object\n\n'Checks to see if Outlook is open\nOn Error Resume Next\nSet oOutlook = GetObject(, \"Outlook.Application\")\nOn Error GoTo 0\n\nIf oOutlook Is Nothing Then\n    MsgBox \"Outlook is not open.\"\n    Exit Sub\nEnd If\nSet oOutlook = Nothing\n</code></pre>\n\n<p>The code seems to work for everyone apart from one person/computer. For this one person/computer, even with Outlook open, the line of code\n    <code>Set oOutlook = GetObject(, \"Outlook.Application\")</code>\ndoes not seem recognise that it is open. I've checked the usual things: made sure the VBA references are set up correctly, security settings seem to be the same as everyone else.</p>\n\n<p>Any suggestions would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1434543184, "post_id": 30891206, "comment_id": 49821620, "body": "So you need the mean of <code>C3:I9</code> across all worksheets? Do you need to do it based on any conditions? Or if you need the mean for week1, do you need that to be input in the function and match the ranges on the sheets? Also - your <code>for counter next</code> isn&#39;t <i>doing</i> anything."}], "answers": [{"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1434543883, "creation_date": 1434543883, "answer_id": 30891542, "question_id": 30891206, "link": "https://stackoverflow.com/questions/30891206/summing-among-cells-across-worksheets/30891542#30891542", "title": "Summing among cells across worksheets", "body": "<p>Your for loops don't actually do anything....   You could also do this all in one sub (Not sure why you're using functions). This should do what you want once you've updated the <code>TBwk1MEAN</code> to change each loop</p>\n\n<pre><code>Sub PARTcounter() 'to count the open questionaires\n    TBTOTpar = ThisWorkbook.Worksheets.Count\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub SUMwk11() 'finds mean for week 1\n    Dim ws As Worksheet\n\n    For each ws in ThisWorkbook.Worksheets\n        ' You'll need to update this each loop otherwise the mean from each sheet will overwrite the previous one.\n        TBwk1MEAN = Application.SUM(ws.Range(\"c3:i9\")) / 7\n    Next ws\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5019462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/069a9eed789c9604464aed95c0e36a27?s=128&d=identicon&r=PG&f=1", "display_name": "GiraffeCrab", "link": "https://stackoverflow.com/users/5019462/giraffecrab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1434543883, "creation_date": 1434542975, "question_id": 30891206, "link": "https://stackoverflow.com/questions/30891206/summing-among-cells-across-worksheets", "title": "Summing among cells across worksheets", "body": "<p>I am very new to programming so this may be an obvious question. I have a questionnaire asking about drinking habits. I am trying to make an application that will work out the mean etc across all worksheets (participant responses). My code so far allows me to get the total number of worksheets as a number of participant responses but it will only give me the mean for the worksheet that is currently open.What would I need to add to the below code to allow me to get the total mean across all the responses (worksheets).    </p>\n\n<p>Code:</p>\n\n<pre><code>Function PARTcounter() 'to count the open questionaires\n\nDim WS_Count As Integer\nDim I As Integer\nWS_Count = ActiveWorkbook.Worksheets.Count\nFor I = 1 To WS_Count\nTBTOTpar = WS_Count\nNext I\nEnd Function\n\nFunction SUMwk11() 'finds mean for week 1\nDim ws As Worksheet\nDim rng As Range\nDim WS_Count As Integer\nDim A As Double\nDim B As Double\nWS_Count = ActiveWorkbook.Worksheets.Count\nFor counter = 0 To WS_Count\nNext\nA = Application.SUM(Range(\"c3:i9\"))\nB = A / 7\nTBwk1MEAN = B\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1434543564, "post_id": 30890924, "comment_id": 49821947, "body": "Do you just want to do this for each cell in range (B:B) that matches some condition?"}, {"owner": {"reputation": 1, "user_id": 5019429, "user_type": "registered", "profile_image": "https://graph.facebook.com/870676983003672/picture?type=large", "display_name": "Andreas Volkmer", "link": "https://stackoverflow.com/users/5019429/andreas-volkmer"}, "edited": false, "score": 0, "creation_date": 1434544142, "post_id": 30890924, "comment_id": 49822436, "body": "Thanks Rory. Seems this was too easy :p This fix works :p"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5019429, "user_type": "registered", "profile_image": "https://graph.facebook.com/870676983003672/picture?type=large", "display_name": "Andreas Volkmer", "link": "https://stackoverflow.com/users/5019429/andreas-volkmer"}, "is_accepted": false, "score": 0, "last_activity_date": 1434551187, "creation_date": 1434551187, "answer_id": 30894501, "question_id": 30890924, "link": "https://stackoverflow.com/questions/30890924/excel-vba-conditional-formatting-with-vlookup-why-does-my-argument-change-b1/30894501#30894501", "title": "Excel-VBA conditional formatting with vlookup: why does my argument change ($B1 to $B1048573)", "body": "<h2>Comment by Rory</h2>\n\n<blockquote>\n  <p>Select B1 first</p>\n</blockquote>\n\n<p>This was pretty much the solution.\nJust wanted to add this here, so everyone with the same issue can immediatly find the answer.</p>\n\n<p>Thanks Rory.</p>\n"}], "owner": {"reputation": 1, "user_id": 5019429, "user_type": "registered", "profile_image": "https://graph.facebook.com/870676983003672/picture?type=large", "display_name": "Andreas Volkmer", "link": "https://stackoverflow.com/users/5019429/andreas-volkmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 628, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1434552641, "creation_date": 1434542279, "last_edit_date": 1434552641, "question_id": 30890924, "link": "https://stackoverflow.com/questions/30890924/excel-vba-conditional-formatting-with-vlookup-why-does-my-argument-change-b1", "title": "Excel-VBA conditional formatting with vlookup: why does my argument change ($B1 to $B1048573)", "body": "<p>I'm kinda confuded, 'coz i can't find a way to prevent excel from changing...\nBut let's start at the beginning.</p>\n\n<p>I've following code for my macro:</p>\n\n<pre><code>ActiveWorkbook.Names.Add Name:=\"DBM\", RefersToR1C1:= _\n    \"='Sheet A'!C35:C39\"\n\nWith Worksheets(\"Sheet B\").Range(\"$B:$B\").FormatConditions _\n    .Add(Type:=xlExpression, Operator:=xlExpression, Formula1:=\"IF(ISBLANK(VLOOKUP($B1;DBM;5;FALSE));TRUE;FALSE)\")\n    With .Interior\n        .ColorIndex = 3\n    End With\nEnd With\n</code></pre>\n\n<p>This works kinda, but not for my fully needs.\nIt automatically changes the <code>$B1</code> argument within my vlookup functions changes to <code>$B1048573</code> - \nThat's why the wrong lines are formatted (background color red). If i manually change it back to <code>$B1</code> it will be absolutely correct.</p>\n\n<p>So I tried to add this in my macro:</p>\n\n<pre><code>Worksheets(\"Sheet B\").Range(\"$B:$B\").FormatConditions(1) _\n    .Modify Type:=xlExpression, Operator:=xlExpression, Formula:=\"IF(ISBLANK(VLOOKUP($B1;DBM;5;FALSE));TRUE;FALSE)\")\n</code></pre>\n\n<p>Unfortunetaly it does the change ($B1048573) once again.</p>\n\n<p>Does any1 have an idea how to fix it? Or do I really have to change it back manually everytime i use the macro?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 61736, "user_id": 43846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TGOxx.png?s=128&g=1", "display_name": "stuartd", "link": "https://stackoverflow.com/users/43846/stuartd"}, "edited": false, "score": 0, "creation_date": 1434542321, "post_id": 30890775, "comment_id": 49820933, "body": "I edited the title of your question to remove the &quot;Access&quot; tag  - the answer to <a href=\"http://meta.stackexchange.com/questions/19190/should-questions-include-tags-in-their-titles\">Should questions include \u201ctags\u201d in their titles?</a> is &quot;no&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 61736, "user_id": 43846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TGOxx.png?s=128&g=1", "display_name": "stuartd", "link": "https://stackoverflow.com/users/43846/stuartd"}, "is_accepted": true, "score": 1, "last_activity_date": 1434542631, "last_edit_date": 1434542631, "creation_date": 1434542134, "answer_id": 30890861, "question_id": 30890775, "link": "https://stackoverflow.com/questions/30890775/browse-button-for-folder-not-files/30890861#30890861", "title": "Browse Button for folder not files", "body": "<p>As it says in the documentation for <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms646927%28v=vs.85%29.aspx\" rel=\"nofollow\">GetOpenFileName</a>:</p>\n\n<blockquote>\n  <p>To display a dialog box that allows the user to select a directory [folder]\n  instead of a file, call the\n  <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb762115%28v=vs.85%29.aspx\" rel=\"nofollow\">SHBrowseForFolder</a>\n  function.</p>\n</blockquote>\n"}], "owner": {"reputation": 95, "user_id": 2886299, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/2DXBW.jpg?s=128&g=1", "display_name": "autumntiger", "link": "https://stackoverflow.com/users/2886299/autumntiger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "accepted_answer_id": 30890861, "answer_count": 1, "score": 1, "last_activity_date": 1594644299, "creation_date": 1434541901, "last_edit_date": 1594644299, "question_id": 30890775, "link": "https://stackoverflow.com/questions/30890775/browse-button-for-folder-not-files", "title": "Browse Button for folder not files", "body": "<p>I am adding a browse button on an Access 2010 form; it will only allow me to attach files, not folders. Here is the code:</p>\n\n \n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Compare Database\nPrivate Declare Function GetOpenFileName Lib \"comdlg32.dll\" Alias _\n\"GetOpenFileNameA\" (pOpenfilename As OPENFILENAME) As Long\n\nPrivate Type OPENFILENAME\n    lStructSize As Long\n    hwndOwner As Long\n    hInstance As Long\n    lpstrFilter As String\n    lpstrCustomFilter As String\n    nMaxCustFilter As Long\n    nFilterIndex As Long\n    lpstrFile As String\n    nMaxFile As Long\n    lpstrFileTitle As String\n    nMaxFileTitle As Long\n    lpstrInitialDir As String\n    lpstrTitle As String\n    flags As Long\n    nFileOffset As Integer\n    nFileExtension As Integer\n    lpstrDefExt As String\n    lCustData As Long\n    lpfnHook As Long\n    lpTemplateName As String\nEnd Type\n\nFunction LaunchCD(strform As Form) As String\n    Dim OpenFile As OPENFILENAME\n    Dim lReturn As Long\n    Dim sFilter As String\n    OpenFile.lStructSize = Len(OpenFile)\n    OpenFile.hwndOwner = strform.Hwnd\n    sFilter = \"All Files (*.*)\" &amp; Chr(0) &amp; \"*.*\" &amp; Chr(0) &amp; _\n      \"JPEG Files (*.JPG)\" &amp; Chr(0) &amp; \"*.JPG\" &amp; Chr(0)\n    OpenFile.lpstrFilter = sFilter\n    OpenFile.nFilterIndex = 1\n    OpenFile.lpstrFile = String(257, 0)\n    OpenFile.nMaxFile = Len(OpenFile.lpstrFile) - 1\n    OpenFile.lpstrFileTitle = OpenFile.lpstrFile\n    OpenFile.nMaxFileTitle = OpenFile.nMaxFile\n    OpenFile.lpstrInitialDir = \"C:\\\"\n    OpenFile.lpstrTitle = \"Select a file using the Common Dialog DLL\"\n    OpenFile.flags = 0\n    lReturn = GetOpenFileName(OpenFile)\n        If lReturn = 0 Then\n            MsgBox \"A file was not selected!\", vbInformation, _\n              \"Select a file using the Common Dialog DLL\"\n         Else\n            LaunchCD = Trim(Left(OpenFile.lpstrFile, InStr(1, OpenFile.lpstrFile, vbNullChar) - 1))\n         End If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 93, "user_id": 3288916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hizK8.png?s=128&g=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/3288916/peter"}, "edited": false, "score": 1, "creation_date": 1434541431, "post_id": 30890552, "comment_id": 49820288, "body": "Try <code>ActiveCell.Offset(1,1).Select</code> instead"}, {"owner": {"reputation": 573, "user_id": 2660489, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/gXT0s.jpg?s=128&g=1", "display_name": "Mukesh Kumar Singh", "link": "https://stackoverflow.com/users/2660489/mukesh-kumar-singh"}, "reply_to_user": {"reputation": 93, "user_id": 3288916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hizK8.png?s=128&g=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/3288916/peter"}, "edited": false, "score": 0, "creation_date": 1434542819, "post_id": 30890552, "comment_id": 49821337, "body": "thanx @Peter . it works"}], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 2, "last_activity_date": 1434542950, "last_edit_date": 1434542950, "creation_date": 1434541476, "answer_id": 30890628, "question_id": 30890552, "link": "https://stackoverflow.com/questions/30890552/using-activecell-and-offset-in-vba/30890628#30890628", "title": "using activecell and offset in VBA", "body": "<p>Try: <code>ActiveCell.Offset(1,1).select</code><br> <code>ActiveCell</code> is already a range object, and you don't need to use <code>Range()</code> to turn it into range.</p>\n"}], "owner": {"reputation": 573, "user_id": 2660489, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/gXT0s.jpg?s=128&g=1", "display_name": "Mukesh Kumar Singh", "link": "https://stackoverflow.com/users/2660489/mukesh-kumar-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1461, "favorite_count": 0, "accepted_answer_id": 30890628, "answer_count": 1, "score": 0, "last_activity_date": 1434542950, "creation_date": 1434541247, "question_id": 30890552, "link": "https://stackoverflow.com/questions/30890552/using-activecell-and-offset-in-vba", "title": "using activecell and offset in VBA", "body": "<p>I am trying to test offset property in excel vba . \nI am using a simple code which selects the cell which is daigonal , i.e 1 row and 1 column away from the active cell.</p>\n\n<p>This is what I am doing</p>\n\n<pre><code>Sub Range_Offset()\n\nRange(ActiveCell).Offset(1, 1).Select\n\nEnd Sub\n</code></pre>\n\n<p>I have attached the code to a button on the sheet.</p>\n\n<p>When I am clicking the button , I am getting the following error</p>\n\n<pre><code>Run-time error '1004'\nMethod 'Range' of object '_Global' failed\n</code></pre>\n\n<p>If i replacing the ActiveCell with any cell number its working . But why is ActiveCell not working.\nThanks</p>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1434542505, "post_id": 30890361, "comment_id": 49821057, "body": "Given you want to return values in 3 rows, why are you using a function instead of a subroutine?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1434542654, "post_id": 30890361, "comment_id": 49821180, "body": "@Raystafarian : because you can have arrays as results, so it easier to have a function for it."}, {"owner": {"reputation": 325, "user_id": 5008116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4daf0c71a9d2cd598e7025bb911b90c3?s=128&d=identicon&r=PG&f=1", "display_name": "gudal", "link": "https://stackoverflow.com/users/5008116/gudal"}, "edited": false, "score": 0, "creation_date": 1434543054, "post_id": 30890361, "comment_id": 49821508, "body": "DO you know at what point in you code the error occurs?"}, {"owner": {"reputation": 325, "user_id": 5008116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4daf0c71a9d2cd598e7025bb911b90c3?s=128&d=identicon&r=PG&f=1", "display_name": "gudal", "link": "https://stackoverflow.com/users/5008116/gudal"}, "edited": false, "score": 0, "creation_date": 1434543745, "post_id": 30890361, "comment_id": 49822107, "body": "What are you trying to do with the lines Stop_Node = ActiveSheet.Range(&quot;B2:B73&quot;).Value and Conduit = ActiveSheet.Range(&quot;C2:C73&quot;).Value"}, {"owner": {"reputation": 3, "user_id": 5018646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c257958d76ec374f23acc9ad93499e96?s=128&d=identicon&r=PG", "display_name": "\u0130mtiaz", "link": "https://stackoverflow.com/users/5018646/%c4%b0mtiaz"}, "reply_to_user": {"reputation": 325, "user_id": 5008116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4daf0c71a9d2cd598e7025bb911b90c3?s=128&d=identicon&r=PG&f=1", "display_name": "gudal", "link": "https://stackoverflow.com/users/5008116/gudal"}, "edited": false, "score": 0, "creation_date": 1434548632, "post_id": 30890361, "comment_id": 49826069, "body": "@gudal In the stated code, I hit the error message once I reach the if statement. With regards to the Stop_Node and Conduit, I am copying the total list of manholes and corresponding pipes (draining to them) in the network. Objective is to find corresponding conduits of queried manhole. Thanks"}, {"owner": {"reputation": 325, "user_id": 5008116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4daf0c71a9d2cd598e7025bb911b90c3?s=128&d=identicon&r=PG&f=1", "display_name": "gudal", "link": "https://stackoverflow.com/users/5008116/gudal"}, "edited": false, "score": 0, "creation_date": 1434606813, "post_id": 30890361, "comment_id": 49852757, "body": "Ok. That can actually be done without VBA, but when you say &quot;automate&quot;, do you want it to do so for all manholes and then do something with/use it in another piece of code, or are you going to select manhole from a dropdown on simply view the corresponding ones?"}, {"owner": {"reputation": 3, "user_id": 5018646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c257958d76ec374f23acc9ad93499e96?s=128&d=identicon&r=PG", "display_name": "\u0130mtiaz", "link": "https://stackoverflow.com/users/5018646/%c4%b0mtiaz"}, "reply_to_user": {"reputation": 325, "user_id": 5008116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4daf0c71a9d2cd598e7025bb911b90c3?s=128&d=identicon&r=PG&f=1", "display_name": "gudal", "link": "https://stackoverflow.com/users/5008116/gudal"}, "edited": false, "score": 0, "creation_date": 1434624606, "post_id": 30890361, "comment_id": 49863727, "body": "@gudal, Yes, I want it to do so for all manholes and then do something with/use it in another piece of code. Basically, the task is to relabel all nodes in a network by a specific labelling convention. This code is part of a bigger code to map all the manholes in an U/stream to down/stream order."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5018646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c257958d76ec374f23acc9ad93499e96?s=128&d=identicon&r=PG", "display_name": "\u0130mtiaz", "link": "https://stackoverflow.com/users/5018646/%c4%b0mtiaz"}, "edited": false, "score": 0, "creation_date": 1434547106, "post_id": 30891144, "comment_id": 49824781, "body": "Appreciate the quick response R3uK"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 3, "user_id": 5018646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c257958d76ec374f23acc9ad93499e96?s=128&d=identicon&r=PG", "display_name": "\u0130mtiaz", "link": "https://stackoverflow.com/users/5018646/%c4%b0mtiaz"}, "edited": false, "score": 0, "creation_date": 1434547309, "post_id": 30891144, "comment_id": 49824949, "body": "@\u0130mtiaz : No problem, did it fix your issue? If yes, plz validate answer (tick below up/down vote) to mark the question as solved!"}, {"owner": {"reputation": 3, "user_id": 5018646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c257958d76ec374f23acc9ad93499e96?s=128&d=identicon&r=PG", "display_name": "\u0130mtiaz", "link": "https://stackoverflow.com/users/5018646/%c4%b0mtiaz"}, "edited": false, "score": 0, "creation_date": 1434547520, "post_id": 30891144, "comment_id": 49825144, "body": "Appreciate the quick response R3uK. I am trying to get conduit label by comparing the Stop_Node label with Manhole. Therefore, I modified your proposed code a bit and it follows: For i = LBound(Stop_Node) To UBound(Stop_Node)     If Stop_Node(i) &lt;&gt; Manhole Then     Else         Result(UBound(Result)) = Conduit(i)         ReDim Result(UBound(Result) + 1)     End If Next i ReDim Result(UBound(Result) - 1)  Conduitt = Result()  End Function.                                                                               However, I am still getting same error once I reach &#39;Else&#39;. Regards."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 3, "user_id": 5018646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c257958d76ec374f23acc9ad93499e96?s=128&d=identicon&r=PG", "display_name": "\u0130mtiaz", "link": "https://stackoverflow.com/users/5018646/%c4%b0mtiaz"}, "edited": false, "score": 0, "creation_date": 1434549076, "post_id": 30891144, "comment_id": 49826444, "body": "Maybe try <code>Dim Result()</code> instead of <code>Dim Result() As String</code>, and if not enough, is the line with <code>Else</code> highlighted once you enter debug mode? Or is it the next one?"}, {"owner": {"reputation": 3, "user_id": 5018646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c257958d76ec374f23acc9ad93499e96?s=128&d=identicon&r=PG", "display_name": "\u0130mtiaz", "link": "https://stackoverflow.com/users/5018646/%c4%b0mtiaz"}, "edited": false, "score": 0, "creation_date": 1434551911, "post_id": 30891144, "comment_id": 49828635, "body": "with Dim Result(), I get &#39;Compile error: Can&#39;t assign to array&#39; and &#39;Conduitt =&#39; is highlighted (blue) in line, Conduitt = Result() \u0131.e. line before End Function. Then, if I click OK, the debug arrow moves back to Function Conduitt......line. Maybe, its because the function output is defined as string in the Function line? I am assuming it exits before reaching the Else line. Thanks Anyways. I&#39;ll keep on looking."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 3, "user_id": 5018646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c257958d76ec374f23acc9ad93499e96?s=128&d=identicon&r=PG", "display_name": "\u0130mtiaz", "link": "https://stackoverflow.com/users/5018646/%c4%b0mtiaz"}, "edited": false, "score": 0, "creation_date": 1434552895, "post_id": 30891144, "comment_id": 49829480, "body": "Have you placed breakpoints to see how this is happening? (click in the grey area left of the code and press F5 to resume). I think that the last line should be : <code>Conduitt = Result</code>, give it a try"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1434792024, "last_edit_date": 1434792024, "creation_date": 1434542815, "answer_id": 30891144, "question_id": 30890361, "link": "https://stackoverflow.com/questions/30890361/excel-vba-code-for-multiple-vlookup/30891144#30891144", "title": "Excel VBA code for multiple vlookup", "body": "<p>In fact, you never <code>ReDim</code> your <code>Result()</code> so it is just an empty array with no actual cell (not even an empty cell), you first need to <code>ReDim</code> it.</p>\n\n<p>Here is my version, I didn't use the function <code>Match</code> but that should work anyway :</p>\n\n<pre><code>Function Conduitt(ManHole As String) As String()\n\nDim Stop_Node As Variant '/* All Manhole label */\nDim Conduit As Variant '/* All conduit label */\nDim Result() As String\n\nReDim Result(0)\n\nStop_Node = ActiveSheet.Range(\"B2:B73\").Value\nConduit = ActiveSheet.Range(\"C2:C73\").Value\n\nFor i = LBound(Stop_Node) To UBound(Stop_Node)\n    If Stop_Node(i,1) &lt;&gt; ManHole Then\n    Else\n        Result(UBound(Result)) = Stop_Node(i,1)\n        ReDim Preserve Result(UBound(Result) + 1)\n    End If\nNext i\nReDim Preserve Result(UBound(Result) - 1)\n\nConduitt = Result()\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 5018646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c257958d76ec374f23acc9ad93499e96?s=128&d=identicon&r=PG", "display_name": "\u0130mtiaz", "link": "https://stackoverflow.com/users/5018646/%c4%b0mtiaz"}, "edited": false, "score": 0, "creation_date": 1434698475, "post_id": 30917575, "comment_id": 49899839, "body": "Thanks Gudal! Appreciate the help and new approach of addressing the problem."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 3, "user_id": 5018646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c257958d76ec374f23acc9ad93499e96?s=128&d=identicon&r=PG", "display_name": "\u0130mtiaz", "link": "https://stackoverflow.com/users/5018646/%c4%b0mtiaz"}, "edited": false, "score": 0, "creation_date": 1434791910, "post_id": 30917575, "comment_id": 49938069, "body": "@imtiaz : nothing really new here, same structure, just working with range instead of arrays (which will be far less efficient, as arrays are one of the key to VBA efficiency), <code>size</code> and <code>counter</code> are useless variable and furthermore <code>counter</code> starting at 0 will generate an error on the next line..."}], "tags": [], "owner": {"reputation": 325, "user_id": 5008116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4daf0c71a9d2cd598e7025bb911b90c3?s=128&d=identicon&r=PG&f=1", "display_name": "gudal", "link": "https://stackoverflow.com/users/5008116/gudal"}, "is_accepted": false, "score": 1, "last_activity_date": 1434636184, "creation_date": 1434636184, "answer_id": 30917575, "question_id": 30890361, "link": "https://stackoverflow.com/questions/30890361/excel-vba-code-for-multiple-vlookup/30917575#30917575", "title": "Excel VBA code for multiple vlookup", "body": "<p>Well, see you solved it, but here is an alternative solution (had to post it now that I have worked on it)</p>\n\n<pre><code>Function ConduittCheck(manhole As String) As String()\nDim result() As String\n\nDim manholeRange As Range\nDim conduittRange As Range\nSet manholeRange = Range(\"manholes\")\nSet conduittRange = Range(\"conduitts\")\n\nDim counter As Integer\nDim size As Integer\nsize = 0\n\nFor counter = 0 To manholeRange.Rows.Count\n    If manholeRange.Rows.Cells(counter, 1) = manhole Then\n        ReDim Preserve result(size)\n        result(size) = conduittRange.Rows.Cells(counter, 1)\n        size = size + 1\n    End If\nNext counter\nConduittCheck = result()\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5018646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c257958d76ec374f23acc9ad93499e96?s=128&d=identicon&r=PG", "display_name": "\u0130mtiaz", "link": "https://stackoverflow.com/users/5018646/%c4%b0mtiaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 734, "favorite_count": 0, "accepted_answer_id": 30891144, "answer_count": 2, "score": 0, "last_activity_date": 1435763005, "creation_date": 1434540810, "last_edit_date": 1495541647, "question_id": 30890361, "link": "https://stackoverflow.com/questions/30890361/excel-vba-code-for-multiple-vlookup", "title": "Excel VBA code for multiple vlookup", "body": "<p>For a conduit network, I am trying to find the pipes that drain to a manhole. There can be multiple pipes that can drain to a single manhole. My data-structure is organized in the following way:</p>\n\n<pre><code>   Stop Node    Label\n  .......................\n    MH-37       CO-40\n    MH-37       CO-40\n    MH-39       CO-43\n    MH-37       CO-44\n    MH-39       CO-45\n    MH-41       CO-46\n    MH-35       CO-47\n    MH-44       CO-50\n    MH-39       CO-51\n    MH-44       CO-52\n</code></pre>\n\n<p>and so on.</p>\n\n<p>Of course, in Excel, we can workaround the multiple <code>vlookup</code> question using array equations. However, I am not sure how it is done in Excel VBA coding. I need to automate the whole process and hence Excel VBA coding. This task is part of a bigger assignment. </p>\n\n<p>Following is the function code I wrote so far:</p>\n\n<pre><code>Function Conduitt(M As String) As String()\n\nDim Stop_Node As Variant /* All Manhole label */\nDim Conduit As Variant /* All conduit label */\nDim compare As Variant /* Query Manhole label */\nDim Result() As String\nDim countc As Integer\n\nStop_Node = ActiveSheet.Range(\"B2:B73\").Value\nConduit = ActiveSheet.Range(\"C2:C73\").Value\ncompare = M\n\ncountc = 1\n\nDo While countc &lt;= 72\n\nIf Application.IsError(Application.Match(Stop_Node(countc), compare)) = 0 Then\n\nResult(countc) = Conduit(countc)\n\nEnd If\n\ncountc = countc + 1\n\nLoop\n\nConduitt = Result()\n\nEnd Function\n</code></pre>\n\n<p>If you compare the sample of data I provided before, For Manhole <code>MH-39</code>, corresponding conduit labels are, <code>CO-43</code>, <code>CO-45</code> and <code>CO-51</code>. I thought, with <code>countc</code> changing due to <code>do</code> loop, it will go through the list and find the exact matches for <code>MH-39</code> and return <code>CO-43</code>, <code>CO-45</code> and <code>CO-51</code>.</p>\n\n<p><strong>Objective is to return these conduit labels only as a string array</strong> with three rows (for <code>MH-39</code> case). </p>\n\n<p>So far, when I run the code, I get :</p>\n\n<blockquote>\n  <p>Run-time error '9': Subscript out of range. </p>\n</blockquote>\n\n<p>I searched different forums and found it happens when non-existing array elements are referenced. At this point, my limited knowledge and experience are not helping decipher the puzzle.</p>\n\n<p>After some suggestions from <a href=\"https://stackoverflow.com/questions/30890361/excel-vba-code-for-multiple-vlookup/30891144#30891144\">R3uK</a>, got the code fixed. Apparently, when a range is assigned to a variant array (as in the case of Stop_Node and Conduit), the variant will be multi-dimensional. So, updated the code accordingly and incorporated Preserve with Redim. </p>\n\n<p>\u0130n case you are interested, the updated code:</p>\n\n<pre><code>Function Conduitt(Manhole As String) As String()\n\nDim Stop_Node As Variant\nDim Conduit As Variant\nDim Result() As String\n\nReDim Result(0)\n\nStop_Node = ActiveSheet.Range(\"B2:B73\").Value\nConduit = ActiveSheet.Range(\"C2:C73\").Value\n\nFor i = LBound(Stop_Node) To UBound(Stop_Node)\nIf Stop_Node(i, 1) &lt;&gt; Manhole Then\nElse\n    Result(UBound(Result)) = Conduit(i, 1)\n    ReDim Preserve Result(UBound(Result) + 1)\nEnd If\nNext i\nReDim Preserve Result(UBound(Result) - 1)\n\nConduitt = Result\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 2709097, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/517121682/picture?type=large", "display_name": "Miles Gl", "link": "https://stackoverflow.com/users/2709097/miles-gl"}, "edited": false, "score": 0, "creation_date": 1434550835, "post_id": 30892046, "comment_id": 49827862, "body": "Hi, thanks you for the reply. I&#39;m new to VBA and still struggling with this sadly :( are you able to write an example? What format should the report name be? Thanks again"}, {"owner": {"reputation": 1262, "user_id": 1680712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f58684b74f0abaed8824df29ae8c232?s=128&d=identicon&r=PG", "display_name": "AVG", "link": "https://stackoverflow.com/users/1680712/avg"}, "reply_to_user": {"reputation": 45, "user_id": 2709097, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/517121682/picture?type=large", "display_name": "Miles Gl", "link": "https://stackoverflow.com/users/2709097/miles-gl"}, "edited": false, "score": 0, "creation_date": 1434567203, "post_id": 30892046, "comment_id": 49838934, "body": "What I gave you is an example. You need to substitute your actual object names and criteria for everything with &lt;&gt;. The report name is whatever you name it."}], "tags": [], "owner": {"reputation": 1262, "user_id": 1680712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f58684b74f0abaed8824df29ae8c232?s=128&d=identicon&r=PG", "display_name": "AVG", "link": "https://stackoverflow.com/users/1680712/avg"}, "is_accepted": false, "score": 0, "last_activity_date": 1434545839, "last_edit_date": 1434545839, "creation_date": 1434545175, "answer_id": 30892046, "question_id": 30890205, "link": "https://stackoverflow.com/questions/30890205/export-a-number-of-reports-using-different-queries-but-same-template/30892046#30892046", "title": "Export a number of reports, using different queries but same template", "body": "<p>There is no need for any of that. Simply have a single query with a single report with that query as a recordsource. The only criteria contained in the query should be what is common to all uses. Then you simply open the report with the desired filter.</p>\n\n<p><code>DoCmd.OpenReport &lt;YourReportName&gt;, acViewPreview, , &lt;YourFilterCriteria&gt;</code> </p>\n\n<p>For exporting, set a tempvar to your filter criteria </p>\n\n<p><code>&lt;YourTempVar&gt; = &lt;YourFilterCriteria&gt; \nDoCmd.outputTo acOutputReport, &lt;YourReportName&gt;, acFormatPDF, &lt;OutputFileName&gt;</code></p>\n\n<p>In the open event of the report set the report's filter to the tempvar.</p>\n\n<p><code>Me.Filter = &lt;YourTempVar&gt;</code> </p>\n"}], "owner": {"reputation": 45, "user_id": 2709097, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/517121682/picture?type=large", "display_name": "Miles Gl", "link": "https://stackoverflow.com/users/2709097/miles-gl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1434545839, "creation_date": 1434540429, "question_id": 30890205, "link": "https://stackoverflow.com/questions/30890205/export-a-number-of-reports-using-different-queries-but-same-template", "title": "Export a number of reports, using different queries but same template", "body": "<p>Good Afternoon,</p>\n\n<p>I have around 10 queries that filter the same data set, and all have the same fields.</p>\n\n<p>I have built a single report that shows this data, and can be exported to .PDF.</p>\n\n<p>By changing the record source to the desired query, I am able to produce reports for all my queries, however this is time consuming. As it needs to be done every week it is not a viable option.</p>\n\n<p>More importantly, the report design is likely to change over time. It would be possible for me to make 10 copies of the report, and then provide the correct query to each one, however this would mean any changes made to the report would have to be made 10 times over.</p>\n\n<p>Does anyone know how I can use VBA / macros to automate this? The logic would be similar to the following.</p>\n\n<ol>\n<li>Copy the template report</li>\n<li>Change the Record Source to Query A</li>\n<li>Export report as ReportA.pdf</li>\n<li>Delete Report</li>\n<li>Copy template report</li>\n<li>Change the Record Source to Query B\n...</li>\n</ol>\n\n<p>And so on. It seems like this should be possible, I just don't know how to do step 1. and 2. and 3. </p>\n\n<p>Any help appreciated.</p>\n"}, {"tags": ["vba", "email", "ms-access", "outlook"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1434540283, "post_id": 30889934, "comment_id": 49819501, "body": "Please provide more extensive details and if you have some code too. It&#39;s a site to help you progress, so we need to see that you tried before coming here to ask. Take a look : <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a> and <a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 31, "user_id": 5019295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c784bb31f5495b14fcb0a50870afdbc4?s=128&d=identicon&r=PG&f=1", "display_name": "Michael O&#39;R", "link": "https://stackoverflow.com/users/5019295/michael-or"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1434541367, "post_id": 30889934, "comment_id": 49820248, "body": "I&#39;m not going to lie, prior to getting the below comment I hadn&#39;t tried anything with regards to VBA as I had no idea where to start with it."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1434541585, "post_id": 30889934, "comment_id": 49820388, "body": "No problem, I just happend to have a good start for what you are looking for so I gave it to you. When you start and don&#39;t know where to go, just type in google something like : [Application][Language][Issue]; so here you go : <a href=\"https://www.google.fr/webhp?sourceid=chrome-instant&amp;ion=1&amp;espv=2&amp;ie=UTF-8#q=word%20vba%20merge\" rel=\"nofollow noreferrer\">google.fr/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5019295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c784bb31f5495b14fcb0a50870afdbc4?s=128&d=identicon&r=PG&f=1", "display_name": "Michael O&#39;R", "link": "https://stackoverflow.com/users/5019295/michael-or"}, "edited": false, "score": 0, "creation_date": 1434541261, "post_id": 30890115, "comment_id": 49820184, "body": "Thanks a lot, getting some movement with it now, just a quick question, what does the DisPTxT As String variable apply to?  As it doesn&#39;t seem to do anything and is only referenced at initialization."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 31, "user_id": 5019295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c784bb31f5495b14fcb0a50870afdbc4?s=128&d=identicon&r=PG&f=1", "display_name": "Michael O&#39;R", "link": "https://stackoverflow.com/users/5019295/michael-or"}, "edited": false, "score": 0, "creation_date": 1434541405, "post_id": 30890115, "comment_id": 49820275, "body": "My bad, I forgot to get rid of it. I used it because I had some trouble with the text displayed in my hyperlinks with the merge (I was changing the link on every mail)"}, {"owner": {"reputation": 31, "user_id": 5019295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c784bb31f5495b14fcb0a50870afdbc4?s=128&d=identicon&r=PG&f=1", "display_name": "Michael O&#39;R", "link": "https://stackoverflow.com/users/5019295/michael-or"}, "edited": false, "score": 0, "creation_date": 1434542407, "post_id": 30890115, "comment_id": 49820996, "body": "Ah no problem, thanks again for your help, have it running now for one email, so I&#39;m thinking if I put the 4 email fields in an array and loop through that should cover the lot for me?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 31, "user_id": 5019295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c784bb31f5495b14fcb0a50870afdbc4?s=128&d=identicon&r=PG&f=1", "display_name": "Michael O&#39;R", "link": "https://stackoverflow.com/users/5019295/michael-or"}, "edited": false, "score": 0, "creation_date": 1434543108, "post_id": 30890115, "comment_id": 49821555, "body": "I have never done a Mail Merge with Access so I&#39;m not sure, but I think that you need to check in Word more that a modification in code. For mine, I used an Excel and the header containing mails was <code>Mail</code> (ergo <code>.MailAddressFieldName = &quot;Mail&quot;</code>) so check if it is the same for you."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 1, "last_activity_date": 1434540158, "creation_date": 1434540158, "answer_id": 30890115, "question_id": 30889934, "link": "https://stackoverflow.com/questions/30889934/mail-merge-email-macro/30890115#30890115", "title": "Mail Merge Email Macro", "body": "<p>Just to get you started, this how I did mine (before, set up your Mailing in Word) :</p>\n\n<pre><code>Sub MergeToEmail()\nDim DisPTxT As String\n\n    Dim bDone As Boolean\n    bDone = False\n\n    Do While bDone = False\n\n        ActiveDocument.Fields.Update\n\n        With ActiveDocument.MailMerge\n            .MailAddressFieldName = \"Mail\"\n            .Destination = wdSendToEmail\n            .SuppressBlankLines = True\n            ' You can modify the text \"Enter Your Subject Here\" or\n            ' remove the following line if you do not want a subject\n            .MailSubject = \"Samedi 26 Avril 2014\"\n            With .DataSource\n                .FirstRecord = ActiveDocument.MailMerge.DataSource.ActiveRecord\n                .LastRecord = ActiveDocument.MailMerge.DataSource.ActiveRecord\n            End With\n            .Execute Pause:=False\n        End With\n\n        If ActiveDocument.MailMerge.DataSource.ActiveRecord = _\n            ActiveDocument.MailMerge.DataSource.RecordCount Then\n            bDone = True\n        End If\n        ActiveDocument.MailMerge.DataSource.ActiveRecord = wdNextRecord\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5019295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c784bb31f5495b14fcb0a50870afdbc4?s=128&d=identicon&r=PG&f=1", "display_name": "Michael O&#39;R", "link": "https://stackoverflow.com/users/5019295/michael-or"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1958, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593516842, "creation_date": 1434539672, "last_edit_date": 1593516842, "question_id": 30889934, "link": "https://stackoverflow.com/questions/30889934/mail-merge-email-macro", "title": "Mail Merge Email Macro", "body": "<p>I am trying to create a macro to send a word document to 4 emails per document, each coming in from it's own field </p>\n\n<p>e.g. supplier1mail, supplier2mail, etc. and is usually going to be sent in about 10 docs per batch, data is being pulled in from an access database and email is being sent through outlook.  </p>\n\n<p>Subject line will always be the same and no body text is needed.  Any help would be greatly appreciated as this is the first time I've really looked at \nVBA.\nThanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1, "user_id": 4690146, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iM0rPmHriZk/AAAAAAAAAAI/AAAAAAAAABY/L18vfwXMCj0/photo.jpg?sz=128", "display_name": "Sophie Durrant", "link": "https://stackoverflow.com/users/4690146/sophie-durrant"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1434543865, "post_id": 30889492, "comment_id": 49822205, "body": "column M is the last column of my data range, so if cells M2 is blank I want to exit the sub"}], "answers": [{"comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 1, "user_id": 4690146, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iM0rPmHriZk/AAAAAAAAAAI/AAAAAAAAABY/L18vfwXMCj0/photo.jpg?sz=128", "display_name": "Sophie Durrant", "link": "https://stackoverflow.com/users/4690146/sophie-durrant"}, "edited": false, "score": 0, "creation_date": 1434544553, "post_id": 30890544, "comment_id": 49822731, "body": "You can edit your question and include that info into it so that others will see it too!"}, {"owner": {"reputation": 1, "user_id": 4690146, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iM0rPmHriZk/AAAAAAAAAAI/AAAAAAAAABY/L18vfwXMCj0/photo.jpg?sz=128", "display_name": "Sophie Durrant", "link": "https://stackoverflow.com/users/4690146/sophie-durrant"}, "edited": false, "score": 0, "creation_date": 1434544647, "post_id": 30890544, "comment_id": 49822798, "body": "I am pasting data from another worksheet into this one columns A-M. My dynamic range is defined as =OFFSET($A$1,1,0,COUNTA($A:$A)-1,13). The first If statement should exit the sub if there is no data in column M and I had the destination calculating the last row of column M because I want to fill the formulas in N:O so that they cover the same number of rows as column M, is that not right?"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1434541235, "creation_date": 1434541235, "answer_id": 30890544, "question_id": 30889492, "link": "https://stackoverflow.com/questions/30889492/intersect-not-working-if-target-range-gets-bigger/30890544#30890544", "title": "Intersect not working if target range gets bigger", "body": "<p>In this line <code>Me.Range(\"N2:O2\").AutoFill Destination:=Me.Range(\"N2:O\" &amp; Me.Range(\"M\" &amp; Me.Rows.Count).End(xlUp).Row)</code> you calculate your last row on the column <strong>M</strong> so if it is empty it'll give you <code>1</code> and autofill your formula on row 1.</p>\n\n<p>So start by calculating it on the good column (my guess is <strong>O</strong>)</p>\n\n<p>You can also simply define an Integer variable to test it and if it is inferior to 2, change it back to 2, 3, 4 or whatever you want.</p>\n\n<p><em>For your dynamic range, we might need some precision.</em></p>\n\n<p>And for the <code>AutoFill</code>, you could just <strong>select manually the range <code>N2:02</code> and then double-click on the bottom right square</strong> (the one you drag to autofill) and it'll autofill as long as there data in adjacent cells! (give it a try ;) )</p>\n"}], "owner": {"reputation": 1, "user_id": 4690146, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iM0rPmHriZk/AAAAAAAAAAI/AAAAAAAAABY/L18vfwXMCj0/photo.jpg?sz=128", "display_name": "Sophie Durrant", "link": "https://stackoverflow.com/users/4690146/sophie-durrant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 293, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1434544890, "creation_date": 1434538443, "last_edit_date": 1434544890, "question_id": 30889492, "link": "https://stackoverflow.com/questions/30889492/intersect-not-working-if-target-range-gets-bigger", "title": "Intersect not working if target range gets bigger", "body": "<p>I am relatively new to VBA and I need help with this please.</p>\n\n<p>I have a private sub within a sheet and I want it to autofill formulas adjacent to a dynamic named range, if the size of the range changes.</p>\n\n<p><strong>(edit) I am pasting data from another worksheet into this one columns A-M. My dynamic range is defined as =OFFSET($A$1,1,0,COUNTA($A:$A)-1,13). The first If statement should exit the sub if there is no data in column M and I had the destination calculating the last row of column M because I want to fill the formulas in N:O so that they cover the same number of rows as column M.</strong></p>\n\n<p>This is my code and it works if the size of the range gets smaller (i.e. if I delete rows from the bottom), but not if it gets bigger and I can't work out why!</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Me.Range(\"M2\").Value = \"\" Then\n\n    MsgBox \"No Data!\"\n\n    Exit Sub\n\nElse\n\n    If Intersect(Target, Me.Range(\"rngOracleInvoices\")) Is Nothing Then\n    Application.EnableEvents = False\n\n        Dim Lrows As Long\n\n        Lrows = Me.Cells(Me.Rows.Count, \"N\").End(xlUp).Row\n\n        Me.Range(Me.Cells(3, 14), Me.Cells(Lrows, \"O\")).ClearContents\n        Me.Range(\"N2:O2\").AutoFill Destination:=Me.Range(\"N2:O\" &amp; Me.Range(\"M\" &amp; Me.Rows.Count).End(xlUp).Row)\n\n    End If\n\nEnd If\n\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>I put the last bit into a separate macro to test if it works on its own and for some reason, when I run it, the autofill goes all the way up to row 1 and overwrites the formulas, which is weird because I use that code a lot and it's never done that before. What have I done??!!</p>\n\n<p>Also, if there is a better way to do the autofill I'd appreciate if someone could let me know what it is because I just cobbled that together from bits I found on forums :)</p>\n\n<p>Thanks,</p>\n\n<p>Soph</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 41, "user_id": 3416253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a69851bbcbabfaada6fe15bc673c4e4?s=128&d=identicon&r=PG&f=1", "display_name": "JiB", "link": "https://stackoverflow.com/users/3416253/jib"}, "edited": false, "score": 0, "creation_date": 1434544815, "post_id": 30888993, "comment_id": 49822926, "body": "I&#39;m actually limited to <code>Space$(255918061)</code> which is less than 2^28 characters..."}, {"owner": {"reputation": 41, "user_id": 3416253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a69851bbcbabfaada6fe15bc673c4e4?s=128&d=identicon&r=PG&f=1", "display_name": "JiB", "link": "https://stackoverflow.com/users/3416253/jib"}, "edited": false, "score": 0, "creation_date": 1434559461, "post_id": 30888993, "comment_id": 49834236, "body": "I first thought it was because of the integer type of Space input argument (see MSDN), but it seems to accept Long type as well."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 3416253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a69851bbcbabfaada6fe15bc673c4e4?s=128&d=identicon&r=PG&f=1", "display_name": "JiB", "link": "https://stackoverflow.com/users/3416253/jib"}, "edited": false, "score": 0, "creation_date": 1434576995, "post_id": 30900487, "comment_id": 49844537, "body": "Thanks for your support. Ok...I feared that I was reaching some uncontrollable vb limitations. The purpose of assigning such a large string is to read a large file (321MB) in one go (using &quot;open <i>path</i> for <i>binary</i> as #FNb&quot;) and splitting it by line.  Is there other working around than buffering the access which increases a lot the computation time ?"}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 2, "last_activity_date": 1434568677, "creation_date": 1434568677, "answer_id": 30900487, "question_id": 30888993, "link": "https://stackoverflow.com/questions/30888993/vba-unexpected-reach-of-string-size-limit/30900487#30900487", "title": "VBA unexpected reach of string size limit", "body": "<p>This seems to be a somewhat opaque error -- opaque in the sense that it would require detailed understanding of the internals of the VBA interpreter to answer. MSDN says about this error:</p>\n\n<blockquote>\n  <p>Visual Basic permits you to use very large strings. However, the requirements of other programs and the way you manipulate your strings may cause this error. </p>\n</blockquote>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/aa264524(v=vs.60).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/aa264524(v=vs.60).aspx</a></p>\n\n<p>I can't find anything in the documentation which suggests a limit of around 2^27 for many built-in functions such as Space() or String(), as well as concatenation operators like + or &amp;, but these limits seem to exist. There seems to be a poorly documented discrepancy between the maximum possible size of a string in memory (say read in from a text file) and the maximum possible  size of string which can be built up from built-in VBA functions and operators. Odd. I would be interested if anyone knows of a kludge which can in pure VBA construct the string which Space$(321262258) or even Space(2^31 -1 ) is trying to construct. </p>\n"}], "owner": {"reputation": 41, "user_id": 3416253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a69851bbcbabfaada6fe15bc673c4e4?s=128&d=identicon&r=PG&f=1", "display_name": "JiB", "link": "https://stackoverflow.com/users/3416253/jib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1085, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1434568677, "creation_date": 1434537190, "last_edit_date": 1531164843, "question_id": 30888993, "link": "https://stackoverflow.com/questions/30888993/vba-unexpected-reach-of-string-size-limit", "title": "VBA unexpected reach of string size limit", "body": "<p>I am facing an \"out of string space\" error while trying to assign large strings in vba:</p>\n\n<pre><code>Dim MyData As String\nMyData = Space$(321262258)\n</code></pre>\n\n<p>The number of characters is clearly under 2^31 expected limit. What could be the reason of such an error ?</p>\n\n<p>Thanks for your help !</p>\n"}, {"tags": ["php", "vba", "ms-word"], "comments": [{"owner": {"reputation": 199102, "user_id": 324584, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/rPKTe.jpg?s=128&g=1", "display_name": "Mark Baker", "link": "https://stackoverflow.com/users/324584/mark-baker"}, "edited": false, "score": 1, "creation_date": 1434537077, "post_id": 30888902, "comment_id": 49817388, "body": "I think the only way you&#39;ll be able to do this with PHP is using <a href=\"http://nl1.php.net/manual/en/book.com.php\" rel=\"nofollow noreferrer\">COM</a>"}, {"owner": {"reputation": 7892, "user_id": 2544036, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0ac5bfd4795966e2378975bd2c34f660?s=128&d=identicon&r=PG", "display_name": "Jacobian", "link": "https://stackoverflow.com/users/2544036/jacobian"}, "reply_to_user": {"reputation": 199102, "user_id": 324584, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/rPKTe.jpg?s=128&g=1", "display_name": "Mark Baker", "link": "https://stackoverflow.com/users/324584/mark-baker"}, "edited": false, "score": 0, "creation_date": 1434537229, "post_id": 30888902, "comment_id": 49817479, "body": "Thanks, Mark! I will check it. Probably, it will help."}], "answers": [{"comments": [{"owner": {"reputation": 7892, "user_id": 2544036, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0ac5bfd4795966e2378975bd2c34f660?s=128&d=identicon&r=PG", "display_name": "Jacobian", "link": "https://stackoverflow.com/users/2544036/jacobian"}, "edited": false, "score": 0, "creation_date": 1434552040, "post_id": 30892400, "comment_id": 49828741, "body": "Thanks! That sounds very useful!"}], "tags": [], "owner": {"reputation": 2454, "user_id": 1560865, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5f7d9f360c30e477ff349a2b49841632?s=128&d=identicon&r=PG", "display_name": "Hauke P.", "link": "https://stackoverflow.com/users/1560865/hauke-p"}, "is_accepted": true, "score": 1, "last_activity_date": 1434546062, "last_edit_date": 1495539822, "creation_date": 1434546062, "answer_id": 30892400, "question_id": 30888902, "link": "https://stackoverflow.com/questions/30888902/get-access-to-ms-word-macros-from-php/30892400#30892400", "title": "Get access to MS Word macros from PHP", "body": "<p>A <code>.docm</code> document can be more or less be considered to be a normal <code>.zip</code> file.</p>\n\n<p>You can therefore open your document with some PHP unzipping function/library, thereby gaining access to the included file <code>word/vbaProject.bin</code>. You then need find or create a PHP library that can modify this <code>vbaProject.bin</code> file.</p>\n\n<p>A quick search pointed me to this answer where the documentation for the <code>vbaProject.bin</code> file format is linked to: <a href=\"https://stackoverflow.com/a/17538985/1560865\">https://stackoverflow.com/a/17538985/1560865</a></p>\n\n<p>Since the file format seems to be quite complex and there will probably be no PHP library available for it, you might want to look for an easier way though....</p>\n"}], "owner": {"reputation": 7892, "user_id": 2544036, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0ac5bfd4795966e2378975bd2c34f660?s=128&d=identicon&r=PG", "display_name": "Jacobian", "link": "https://stackoverflow.com/users/2544036/jacobian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 882, "favorite_count": 0, "accepted_answer_id": 30892400, "answer_count": 1, "score": 0, "last_activity_date": 1434546062, "creation_date": 1434536915, "last_edit_date": 1434543348, "question_id": 30888902, "link": "https://stackoverflow.com/questions/30888902/get-access-to-ms-word-macros-from-php", "title": "Get access to MS Word macros from PHP", "body": "<p>The problem is following. I have a tool that generates <code>.docm</code> files. These files contain some <code>macros</code>. The code of macros has settings information, like <code>URL</code>s, etc. I want to somehow access from <code>PHP</code> this macros in order to make changes programmatically. This is especially necessary when the whole application with this document generator moves to another server.</p>\n"}, {"tags": ["vba", "excel", "compare"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1434553491, "post_id": 30888869, "comment_id": 49829973, "body": "What is the question?  Is this code not working?  If not, this is commonly done by creating a lookup table and then adding a step to check that table in order to translate column headers between the two tables.  Please <a href=\"http://stackoverflow.com/posts/30888869/edit\">edit your question</a> to more clearly state what you need help with."}, {"owner": {"reputation": 381, "user_id": 4995716, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ac9a0782abeab1e5b93879cc24d69df5?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4995716/tony"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1434615649, "post_id": 30888869, "comment_id": 49857707, "body": "@Byron I have edited what i need help with and as above this code works on the basis of me formatting the sheets in the same way"}], "answers": [{"comments": [{"owner": {"reputation": 381, "user_id": 4995716, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ac9a0782abeab1e5b93879cc24d69df5?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4995716/tony"}, "edited": false, "score": 0, "creation_date": 1434726901, "post_id": 30921862, "comment_id": 49918205, "body": "Thanks great answer! helped me understand the code a lot more! :)"}, {"owner": {"reputation": 381, "user_id": 4995716, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ac9a0782abeab1e5b93879cc24d69df5?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4995716/tony"}, "edited": false, "score": 0, "creation_date": 1434922270, "post_id": 30921862, "comment_id": 49970567, "body": "i have tested the code and it works, however i am having issues copying the row of data with differences to a different sheet, since we are looking at each header and cell it copies and duplicates the row, is there anyway i can copy that row of data only once? with the formatting of the highlighted differences?"}], "tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": true, "score": 0, "last_activity_date": 1434648291, "creation_date": 1434648291, "answer_id": 30921862, "question_id": 30888869, "link": "https://stackoverflow.com/questions/30888869/compare-2-sheets-with-different-headers/30921862#30921862", "title": "Compare 2 sheets with different headers", "body": "<p>Matching up data between data sets requires that you give the program some help.  In this case, the help needed is which columns are related to each other.  You have identified a small table of how headers are related.  With this, you can do the various translations from data source 1 to data source 2.  It requires heavy usage of <code>Application.Match</code> and <code>Application.VLookup</code>.</p>\n\n<p>I will provide a base example which does the core of what you are trying to do.  It is much easier to see it all on one sheet which is what I have done.</p>\n\n<p><strong>Picture of data</strong> shows three tables: rng_headers, rng_source, and rng_dest.  One is the lookup for the headers, the second is the \"source\" data, and the third is the data source to compare against which I will call destination = \"dest\".</p>\n\n<p><img src=\"https://i.stack.imgur.com/Z9xld.png\" alt=\"starting data\"></p>\n\n<p><strong>Code</strong> include steps to: iterate through all the IDs in the source data, check if they exist in the dest data, and, if so, check all the individual values for equality.  This code checks the headers on every step (which is slow) but allows for the data to be out of order.</p>\n\n<pre><code>Sub ConfirmHeadersAndMatch()\n\n    Dim rng_headers As Range\n    Set rng_headers = Range(\"B3\").CurrentRegion\n\n    Dim rng_dest As Range\n    Set rng_dest = Range(\"I2\").CurrentRegion\n\n    Dim rng_source As Range\n    Set rng_source = Range(\"E2\").CurrentRegion\n\n    Dim rng_id As Range 'first column, below header row\n    For Each rng_id In Intersect(rng_source.Columns(1).Offset(1), rng_source)\n\n        Dim str_header As Variant\n        str_header = Application.VLookup( _\n            Intersect(rng_id.EntireColumn, rng_source.Rows(1)), _\n            rng_headers, 2, False)\n\n        'get col number\n        Dim int_col_id As Integer\n        int_col_id = Application.Match(str_header, rng_dest.Rows(1), 0)\n\n        'find ID in the new column\n        Dim int_row_id As Variant\n        int_row_id = Application.Match(rng_id, rng_dest.Columns(int_col_id), 0)\n\n        If IsError(int_row_id) Then\n            'ID missing... do something\n            rng_id.Interior.Color = 255\n        Else\n            Dim rng_check As Range 'all values, same row\n            For Each rng_check In Intersect(rng_source, rng_id.EntireRow)\n\n                'get col number\n                str_header = Application.VLookup( _\n                    Intersect(rng_check.EntireColumn, rng_source.Rows(1)), _\n                    rng_headers, 2, False)\n                int_col_id = Application.Match(str_header, rng_dest.Rows(1), 0)\n\n                'check value\n                If rng_check.Value &lt;&gt; rng_dest.Cells(int_row_id, int_col_id).Value Then\n                    'values did not match... do something\n                    rng_dest.Cells(int_row_id, int_col_id).Interior.Color = 255\n                End If\n\n            Next rng_check\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p><strong>Notes on the code</strong></p>\n\n<ul>\n<li>Ranges are built on <code>CurrentRegion</code> which picks out the blocks of data.  You can swap these out for different ranges on different sheets.</li>\n<li>Column header translation is done with <code>Application.VLookup</code> to check the source header and return the destination header.  This <code>String</code> is then found in the destination header row using <code>Application.Match</code>.  You could abstract this code into a <code>Function</code> to avoid repeating it twice.</li>\n<li>Once the column is found, the ID is searched for in the destination table using <code>Application.Match</code>.  This will return an error if the ID is not found.</li>\n<li>If the ID is found, it then checks all of the other values in the same row, comparing them against the correct columns in the destination table.  Non-matching results are colored red.</li>\n<li>If all of the columns do not have pairs, you can add additional checks on the <code>VLookup</code> or the column <code>Match</code> to check this.</li>\n<li>The vast majority of this code just handles getting to the correct spots in the data using <code>Intersect</code>, <code>Rows</code>, and <code>Columns</code>.</li>\n</ul>\n\n<p><strong>Results</strong> show some red values for the ID not found and the values that don't match.</p>\n\n<p><img src=\"https://i.stack.imgur.com/9xSWf.png\" alt=\"results\"></p>\n"}], "owner": {"reputation": 381, "user_id": 4995716, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ac9a0782abeab1e5b93879cc24d69df5?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4995716/tony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2357, "favorite_count": 0, "accepted_answer_id": 30921862, "answer_count": 1, "score": 1, "last_activity_date": 1434648291, "creation_date": 1434536821, "last_edit_date": 1434615599, "question_id": 30888869, "link": "https://stackoverflow.com/questions/30888869/compare-2-sheets-with-different-headers", "title": "Compare 2 sheets with different headers", "body": "<p>I have 2 different files which have different headers, for example: </p>\n\n<pre><code>OldfileHeaders | NewFileheaders\nID             | Test ID\nDate           | New date\n</code></pre>\n\n<p>and so on. I am trying to compare the data in both sheets and see if they match.  The rows of data may be in different order and the headers may also be in different order.</p>\n\n<p>So what I am trying to do is:\n1) define which headers match which headers between the 2 files\n2) find the ID from the oldfile and see if it is in the new file, if it is then see if the data under each header matches. If it doesn't then export that row of data to a new sheet add a column and label it \"Missing\".</p>\n\n<p>The Code So far:</p>\n\n<pre><code>Set testIdData = testIdData.Resize(testIdData.CurrentRegion.Rows.Count)\n\nDo Until sourceId.Value = \"\"\n    datacopy = False\n    ' Look for ID in test data\n    Set cellFound = testIdData.Find(What:=sourceId.Value, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False)\n    If cellFound Is Nothing Then\n    ' This entry not found, so copy to output\n        datacopy = True\n        outputRange.Resize(ColumnSize:=NUMCOLUMNS).Interior.Color = vbRed\n    Else\n        ' This assumes that columns are in same order\n        For columnNum = 2 To NUM_COLUMNS_DATA\n        ' No need to test the ID column\n            If sourceId.Cells(ColumnIndex:=columnNum).Value &lt;&gt; cellFound.Cells(ColumnIndex:=columnNum).Value Then\n                outputRange.Cells(ColumnIndex:=columnNum).Interior.Color = vbYellow\n                datacopy = True\n            End If\n        Next columnNum\n    End If\n    If datacopy Then\n        sourceId.Resize(ColumnSize:=NUMCOLUMNS).Copy\n        outputRange.PasteSpecial xlPasteValuesAndNumberFormats\n        Application.CutCopyMode = False\n        Set outputRange = outputRange.Offset(RowOffset:=1)\n        difference = difference + 1\n    End If\n    Set sourceId = sourceId.Offset(RowOffset:=1)\nLoop\n</code></pre>\n\n<p>This code works depending on me formatting the sheets in the correct order and changing the header names.</p>\n\n<p>I need help in defining which field names match which field names within the 2 sheets, and then searching the new sheet for each ID and seeing if the data in the corresponding cells match. If the ID is not in the sheet then output that row too a different sheet. If the id is present and there are differences in the cells then out put these to the shame sheet. I want to produce a tally of differences in each column.</p>\n"}, {"tags": ["vba", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 3376, "user_id": 283650, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/1v62X.png?s=128&g=1", "display_name": "Reinstate Monica - Goodbye SE", "link": "https://stackoverflow.com/users/283650/reinstate-monica-goodbye-se"}, "edited": false, "score": 0, "creation_date": 1434540285, "post_id": 30888946, "comment_id": 49819503, "body": "Great idea but unfortunately that did not work. It still removes the scientific notation format!"}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "reply_to_user": {"reputation": 3376, "user_id": 283650, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/1v62X.png?s=128&g=1", "display_name": "Reinstate Monica - Goodbye SE", "link": "https://stackoverflow.com/users/283650/reinstate-monica-goodbye-se"}, "edited": false, "score": 0, "creation_date": 1434540712, "post_id": 30888946, "comment_id": 49819812, "body": "It worked for me on test data. Can you add sample data to your question?"}, {"owner": {"reputation": 3376, "user_id": 283650, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/1v62X.png?s=128&g=1", "display_name": "Reinstate Monica - Goodbye SE", "link": "https://stackoverflow.com/users/283650/reinstate-monica-goodbye-se"}, "edited": false, "score": 0, "creation_date": 1434541802, "post_id": 30888946, "comment_id": 49820541, "body": "Ah, I beg your pardon. In the cell it <i>displays</i> 2.00E-01 but if I look in the formula bar it has already converted it to <i>0.2</i>! I will do more experimenting and get back to you. (It&#39;s like Excel is out to get me! ;) )"}, {"owner": {"reputation": 3376, "user_id": 283650, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/1v62X.png?s=128&g=1", "display_name": "Reinstate Monica - Goodbye SE", "link": "https://stackoverflow.com/users/283650/reinstate-monica-goodbye-se"}, "edited": false, "score": 0, "creation_date": 1434542233, "post_id": 30888946, "comment_id": 49820881, "body": "Wait a sec... you&#39;re doing Text To Columns (which I need to do before, this step, coincidentally, that&#39;s why I went along with this) but this question is about converting multiple columns. I will post example data."}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "reply_to_user": {"reputation": 3376, "user_id": 283650, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/1v62X.png?s=128&g=1", "display_name": "Reinstate Monica - Goodbye SE", "link": "https://stackoverflow.com/users/283650/reinstate-monica-goodbye-se"}, "edited": false, "score": 1, "creation_date": 1434548035, "post_id": 30888946, "comment_id": 49825605, "body": "My mistake - I misread your post. You want to <b>join</b> columns into one column as pipe-separated values. I thought you were doing the opposite."}], "tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": false, "score": 0, "last_activity_date": 1434548957, "last_edit_date": 1434548957, "creation_date": 1434537063, "answer_id": 30888946, "question_id": 30888584, "link": "https://stackoverflow.com/questions/30888584/how-can-i-convert-columns-into-a-single-pipe-separated-column-without-losing-sc/30888946#30888946", "title": "How can I convert columns into a single, pipe-separated column without losing scientific notation?", "body": "<p>EDIT: I misread the post. This answer is for separating text from one column into many columns. OP is trying the reverse.</p>\n\n<p>You use the Excel Text to Columns wizard (on the Data tab, select Text to Columns). Select your data, then run click the menu. When you get to step 3, tell Excel that you want to keep the column as Text.</p>\n\n<p><img src=\"https://i.stack.imgur.com/gkchD.png\" alt=\"Step 3 Of Text to Columns wizard\"></p>\n\n<p>If you need this done using VBA, then use the macro recorder to get the initial code which you can then tweak to fit your needs.</p>\n"}, {"comments": [{"owner": {"reputation": 3376, "user_id": 283650, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/1v62X.png?s=128&g=1", "display_name": "Reinstate Monica - Goodbye SE", "link": "https://stackoverflow.com/users/283650/reinstate-monica-goodbye-se"}, "edited": false, "score": 0, "creation_date": 1434552454, "post_id": 30893559, "comment_id": 49829104, "body": "You wrote <i>&quot;Or in VBA, you can use the Text property of the Range object&quot;</i>. However, in the question I stated that I had tried <code>rng.Text</code> - was that what you meant?"}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "reply_to_user": {"reputation": 3376, "user_id": 283650, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/1v62X.png?s=128&g=1", "display_name": "Reinstate Monica - Goodbye SE", "link": "https://stackoverflow.com/users/283650/reinstate-monica-goodbye-se"}, "edited": false, "score": 0, "creation_date": 1434563525, "post_id": 30893559, "comment_id": 49836731, "body": "The VBA function in your post does fail. Probably because it is using the <code>Transpose</code> function. If you build the string in VBA by looping through the cells and appending the <code>.Text</code> value to a string it should be fine, e.g. <code>myString = myString &amp; &quot;|&quot; &amp; cell.Text</code> . Or use the Excel function in my answer."}, {"owner": {"reputation": 3376, "user_id": 283650, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/1v62X.png?s=128&g=1", "display_name": "Reinstate Monica - Goodbye SE", "link": "https://stackoverflow.com/users/283650/reinstate-monica-goodbye-se"}, "edited": false, "score": 0, "creation_date": 1434629891, "post_id": 30893559, "comment_id": 49867338, "body": "Thanks for all your help. I&#39;m afraid it will be a few days before I can test this - will get back to you."}, {"owner": {"reputation": 3376, "user_id": 283650, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/1v62X.png?s=128&g=1", "display_name": "Reinstate Monica - Goodbye SE", "link": "https://stackoverflow.com/users/283650/reinstate-monica-goodbye-se"}, "edited": false, "score": 0, "creation_date": 1435588102, "post_id": 30893559, "comment_id": 50249738, "body": "Sorry, I&#39;ve decided to implement this in a different way; cannot work this out easily. Apologies for inconvenience and thanks for your help."}], "tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": false, "score": 0, "last_activity_date": 1434548878, "creation_date": 1434548878, "answer_id": 30893559, "question_id": 30888584, "link": "https://stackoverflow.com/questions/30888584/how-can-i-convert-columns-into-a-single-pipe-separated-column-without-losing-sc/30893559#30893559", "title": "How can I convert columns into a single, pipe-separated column without losing scientific notation?", "body": "<p>You want to concatenate text values using either the <code>CONCATENATE</code> function or the <code>&amp;</code> operator. For the scientific notation, you want to use the <code>TEXT</code> function. Excel is actually storing the numbers as 0.2 but then displaying them in scientific notation.</p>\n\n<p>The help for the <code>TEXT</code> function says:</p>\n\n<blockquote>\n  <p>Syntax: TEXT(value, format_text)<br>\n  Display scientific notations:<br>\n  To display numbers in scientific (exponential) format, use the following exponent codes in the format_text argument.E (E-, E+, e-, e+) Displays a number in scientific (exponential) format. Excel displays a number to the right of the \"E\" or \"e\" that corresponds to the number of places that the decimal point was moved. For example, if the format_text argument is \"0.00E+00\", Excel displays the number 12,200,000 as 1.22E+07. If you change the format_text argument to \"#0.0E+0\", Excel displays 12.2E+6.</p>\n</blockquote>\n\n<p>So for your example, assuming the values are in cells A1:D1, use:</p>\n\n<pre><code>=A1&amp;\"|\"&amp;B1&amp;\"|\"&amp;TEXT(C1,\"0.000000E+00\")&amp;\"|\"&amp;TEXT(D1,\"0.000000E+00\")\n</code></pre>\n\n<p>Or in VBA, you can use the <code>Text</code> property of the <code>Range</code> object to get the contents of the cell <em>as they are displayed.</em> If the column width is too narrow for a date and the column shows \"########\" then that is what the <code>Text</code> property will return.</p>\n"}], "owner": {"reputation": 3376, "user_id": 283650, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/1v62X.png?s=128&g=1", "display_name": "Reinstate Monica - Goodbye SE", "link": "https://stackoverflow.com/users/283650/reinstate-monica-goodbye-se"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1054, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1434548957, "creation_date": 1434535961, "last_edit_date": 1495542731, "question_id": 30888584, "link": "https://stackoverflow.com/questions/30888584/how-can-i-convert-columns-into-a-single-pipe-separated-column-without-losing-sc", "title": "How can I convert columns into a single, pipe-separated column without losing scientific notation?", "body": "<p>I have used <a href=\"https://stackoverflow.com/a/19192794/283650\">this VBA code</a> to convert columns into pipe separated format. However, the data contains numbers in scientific notation (eg <code>2.000000e-01</code>) which Excel automatically converts into <code>0.2</code> which I don't want.</p>\n\n<p>I have tried changing this code:</p>\n\n<pre><code>var = Application.Transpose(Application.Transpose(rng.Value))\n</code></pre>\n\n<p>into</p>\n\n<pre><code>var = Application.Transpose(Application.Transpose(rng))\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>var = Application.Transpose(Application.Transpose(rng.Text))\n</code></pre>\n\n<p>neither of which work. I've also tried formatting the cells all to Text (the macro then gives a <code>Value</code> error) or even <a href=\"https://superuser.com/questions/452832/turn-off-scientific-notation-in-excel\">switching off scientific notation</a>.</p>\n\n<p>How can I convert columns into a single, pipe-separated column without losing scientific notation?</p>\n\n<p>Sample columns:</p>\n\n<pre><code>SAMPLE  TEST    2.000000e-01    2.000000e-01\n</code></pre>\n"}, {"tags": ["regex", "vba", "excel", "user-defined-functions", "udf"], "comments": [{"owner": {"reputation": 906, "user_id": 2485248, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/IzdaY.jpg?s=128&g=1", "display_name": "Roland", "link": "https://stackoverflow.com/users/2485248/roland"}, "edited": false, "score": 0, "creation_date": 1434534280, "post_id": 30887752, "comment_id": 49815524, "body": "If it always starts with the project id followed by an underscore, you can replace this with an empty string. The code you want will be at the beginning of the remaining string. After that perform a split with space as delimiter and take the first token."}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1434536375, "post_id": 30887752, "comment_id": 49816974, "body": "You should post whatever you have tried. This is not a code writing service but is to help fix broken code."}], "answers": [{"comments": [{"owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "edited": false, "score": 0, "creation_date": 1434537717, "post_id": 30888835, "comment_id": 49817800, "body": "#prabu k, try your code with 6th row (image sample) the result is:MDC-WP-01003_SRI"}, {"owner": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "edited": false, "score": 0, "creation_date": 1434543810, "post_id": 30888835, "comment_id": 49822160, "body": "Thanks for this - It works really well and I can see the result in the immediate window.  However and apologies as this is probably a really &quot;Simple&quot; question how would I convert this code into a (UDF) public function as the usual method I use does not seem to work and is returning &quot;Value&quot;."}, {"owner": {"reputation": 51, "user_id": 5012223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ba4f3b52431720a5ab72f09e37ed6d?s=128&d=identicon&r=PG&f=1", "display_name": "Prabu krishna", "link": "https://stackoverflow.com/users/5012223/prabu-krishna"}, "edited": false, "score": 0, "creation_date": 1434544981, "post_id": 30888835, "comment_id": 49823041, "body": "I have posted the function as another answer, take a look and let me know."}], "tags": [], "owner": {"reputation": 51, "user_id": 5012223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ba4f3b52431720a5ab72f09e37ed6d?s=128&d=identicon&r=PG&f=1", "display_name": "Prabu krishna", "link": "https://stackoverflow.com/users/5012223/prabu-krishna"}, "is_accepted": false, "score": 0, "last_activity_date": 1434539855, "last_edit_date": 1434539855, "creation_date": 1434536712, "answer_id": 30888835, "question_id": 30887752, "link": "https://stackoverflow.com/questions/30887752/extract-text-which-begin-with-the-same-two-characters-and-end-in-a-numeric-chara/30888835#30888835", "title": "Extract text which begin with the same two characters and end in a numeric character", "body": "<p>If your code doesn't have space then the below code will help.</p>\n\n<p>Sub Test()</p>\n\n<pre><code>Data = \"A850085_MDC-WP-01003_SRI Phase 2 - Programme Manager - Dionysios Psachoulias\"\n\nstartpos = InStr(Data, \"WP\")\nIf startpos = 0 Then startpos = InStr(Data, \"MD\")\n\nfisrtNumPos = 0\nLastNumPos = 0\nFor i = startpos To Len(Data)\n\n    If fisrtNumPos = 0 And LastNumPos = 0 Then\n        If IsNumeric(Mid(Data, i, 1)) Then\n            fisrtNumPos = i\n        End If\n    Else\n        If Not IsNumeric(Mid(Data, i, 1)) Then\n            LastNumPos = i\n            Exit For\n        End If\n    End If\nNext i\n\nEndpos = LastNumPos - startpos\n\nDebug.Print Mid(Data, startpos, Endpos)\n</code></pre>\n\n<p>End Sub</p>\n\n<p>This should work now. But if the text contains \"MD\" followed by \"WP\" then it will take the code from WP only.</p>\n\n<p>for example:\ndata= \"A850085_WPC-MD-01003_SRI Phase 2 - Programme Manager - Dionysios Psachoulias\"</p>\n\n<p>then the result will be \nresult= \"WPC-MD-01003\"</p>\n"}, {"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1434544830, "creation_date": 1434544830, "answer_id": 30891901, "question_id": 30887752, "link": "https://stackoverflow.com/questions/30887752/extract-text-which-begin-with-the-same-two-characters-and-end-in-a-numeric-chara/30891901#30891901", "title": "Extract text which begin with the same two characters and end in a numeric character", "body": "<p>Try something along the lines of this:-</p>\n\n<pre><code>Dim cell\nDim tmp as string\n\nFor each cell in activesheet.columns(1).usedrange.cells\n    If InStr(1, cell.Value, \"_MDC_\", vbTextCompare) &gt; 0 Then\n        tmp = Right(cell.Value, Len(cell.Value) - InStr(1, cell.Value, \"_MDC_\", vbTextCompare))\n        tmp = Left(tmp, InStr(1, tmp, \" \", vbTextCompare) - 1)\n        cell.offset(0,2).value = tmp\n    End If\nnext cell\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 5012223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ba4f3b52431720a5ab72f09e37ed6d?s=128&d=identicon&r=PG&f=1", "display_name": "Prabu krishna", "link": "https://stackoverflow.com/users/5012223/prabu-krishna"}, "is_accepted": true, "score": 0, "last_activity_date": 1434544869, "creation_date": 1434544869, "answer_id": 30891914, "question_id": 30887752, "link": "https://stackoverflow.com/questions/30887752/extract-text-which-begin-with-the-same-two-characters-and-end-in-a-numeric-chara/30891914#30891914", "title": "Extract text which begin with the same two characters and end in a numeric character", "body": "<p>Public Function GetCode(data As String) As String</p>\n\n<pre><code>startpos = InStr(data, \"WP\")\nIf startpos = 0 Then startpos = InStr(data, \"MD\")\n\nfisrtNumPos = 0\nFor i = startpos To Len(data)\n\n    If fisrtNumPos = 0 And LastNumPos = 0 Then\n        If IsNumeric(Mid(data, i, 1)) Then\n            fisrtNumPos = i\n        End If\n    Else\n        If Not IsNumeric(Mid(data, i, 1)) Then\n            LastNumPos = i\n            Exit For\n        End If\n    End If\nNext i\n\nEndpos = LastNumPos - startpos\n\nGetCode = Mid(data, startpos, Endpos)\n</code></pre>\n\n<p>End Function</p>\n\n<p>Add this Code in any Module and try.</p>\n"}], "owner": {"reputation": 321, "user_id": 4915723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b8417efa4b79cbcf3463d38ccfedb7b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Bailey", "link": "https://stackoverflow.com/users/4915723/sean-bailey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 30891914, "answer_count": 3, "score": -1, "last_activity_date": 1434544869, "creation_date": 1434533764, "last_edit_date": 1434533794, "question_id": 30887752, "link": "https://stackoverflow.com/questions/30887752/extract-text-which-begin-with-the-same-two-characters-and-end-in-a-numeric-chara", "title": "Extract text which begin with the same two characters and end in a numeric character", "body": "<p>I would like to extract a code from a larger extract of text, the constants I have is the Code will either start with WP or MD and end in a Numeric value and example of the patterns the code can be in are below;</p>\n\n<pre><code>WP0053\n\nWP053\n\nWP_053\n\nWP_0053\n\nWP 053\n\nWP 0053\n\nMDC_308\n\nWP6\n\nWP6.1\n\nMDC_0308\n</code></pre>\n\n<p>Please see image of expected output below;</p>\n\n<p><img src=\"https://i.stack.imgur.com/T9gts.png\" alt=\"enter image description here\"></p>\n\n<p>Any help would be much appreciated</p>\n"}, {"tags": ["vba", "visio"], "comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1434541854, "post_id": 30887653, "comment_id": 49820586, "body": "What do you mean for option 1 - &quot;transform .. into chunks ... concatenate&quot; - how often do you need to make changes to the string you&#39;ve received from the query? Shouldn&#39;t you just run the query again if the string is going to change?"}, {"owner": {"reputation": 2330, "user_id": 410753, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8333d6caa73e0756c4be4ae5d77b5db2?s=128&d=identicon&r=PG", "display_name": "sasfrog", "link": "https://stackoverflow.com/users/410753/sasfrog"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1434578226, "post_id": 30887653, "comment_id": 49845053, "body": "@Raystafarian actually the string being stored <i>is</i> the query. It&#39;s mainly during development that I need to change it often, should be pretty static once in production. Nonetheless, the ability to make minor changes just to the query without having to re-issue the solution is a driver for my question."}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1434620496, "post_id": 30887653, "comment_id": 49860990, "body": "I don&#39;t think you&#39;ll be able to store it in a variable in visio without it being lost when the application is closed. I also don&#39;t <i>think</i> you can print the output to a module within the VBE."}, {"owner": {"reputation": 2330, "user_id": 410753, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8333d6caa73e0756c4be4ae5d77b5db2?s=128&d=identicon&r=PG", "display_name": "sasfrog", "link": "https://stackoverflow.com/users/410753/sasfrog"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1434623601, "post_id": 30887653, "comment_id": 49863066, "body": "@Raystafarian no, I can&#39;t &quot;store it in a variable&quot; and have it persist between sessions (that&#39;s not my requirement) - what I meant was I can populate a variable from a static declaration when the project starts up. But doing so means I&#39;m storing it in code, which has the limitations I&#39;ve described."}], "answers": [{"comments": [{"owner": {"reputation": 2330, "user_id": 410753, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8333d6caa73e0756c4be4ae5d77b5db2?s=128&d=identicon&r=PG", "display_name": "sasfrog", "link": "https://stackoverflow.com/users/410753/sasfrog"}, "edited": false, "score": 0, "creation_date": 1434578433, "post_id": 30891512, "comment_id": 49845144, "body": "Good suggestion. In this case, the remote database is outside of my control/no opportunity to do anything to it but read from it. If I could add objects, I&#39;d just implement my query as a view! However, what you&#39;re suggesting is aligned with my last dot-point, which is currently my preferred option."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 1, "last_activity_date": 1434543811, "creation_date": 1434543811, "answer_id": 30891512, "question_id": 30887653, "link": "https://stackoverflow.com/questions/30887653/store-large-text-resource-in-vba-project/30891512#30891512", "title": "Store large text resource in VBA project", "body": "<p>Why not store the query string in the remote database and retrieve it when you need it? You can maintain the string in that database and use the database [read-only] protection to prevent ordinary users from altering it.</p>\n\n<p>The table could look like <code>TABLE QUERYSTRINGS (QueryName, QueryString).</code></p>\n\n<p>The query could be <code>\"SELECT QueryString FROM QUERYSTRINGS WHERE QueryName='MyQuery';\"</code></p>\n"}, {"comments": [{"owner": {"reputation": 2330, "user_id": 410753, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8333d6caa73e0756c4be4ae5d77b5db2?s=128&d=identicon&r=PG", "display_name": "sasfrog", "link": "https://stackoverflow.com/users/410753/sasfrog"}, "edited": false, "score": 0, "creation_date": 1434578346, "post_id": 30892189, "comment_id": 49845102, "body": "This is a good answer, but I brought it upon myself by using the excel-vba tag and not being explicit that this is a Visio solution. So it&#39;s not applicable to my situation. Mea culpa: I used the excel-vba tag as a honeypot for smart VBA practitioners to see my question..."}], "tags": [], "owner": {"reputation": 2038, "user_id": 479518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/39cab39c00ecc78ecf0d9dab18320204?s=128&d=identicon&r=PG&f=1", "display_name": "Juliusz", "link": "https://stackoverflow.com/users/479518/juliusz"}, "is_accepted": false, "score": 1, "last_activity_date": 1434545544, "creation_date": 1434545544, "answer_id": 30892189, "question_id": 30887653, "link": "https://stackoverflow.com/questions/30887653/store-large-text-resource-in-vba-project/30892189#30892189", "title": "Store large text resource in VBA project", "body": "<p>May I suggest another solution? Keep in the \"very hidden\" sheet.</p>\n\n<p>Copy the SQL query to a sheet (one row, or many, up to you); then go to the VBA (macro editor, IDE, however you call it) and in the project menu select the sheet; finally in the properties window (press F4 if you cannot see it), select:</p>\n\n<pre><code>Visible = 2 (xlSheetVeryHidden)\n</code></pre>\n\n<p>That way a user will not see the sheet and the code, and as long as you protect the project with a password, the user will not be able to access it.</p>\n"}], "owner": {"reputation": 2330, "user_id": 410753, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8333d6caa73e0756c4be4ae5d77b5db2?s=128&d=identicon&r=PG", "display_name": "sasfrog", "link": "https://stackoverflow.com/users/410753/sasfrog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 485, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1434622015, "creation_date": 1434533552, "last_edit_date": 1434622015, "question_id": 30887653, "link": "https://stackoverflow.com/questions/30887653/store-large-text-resource-in-vba-project", "title": "Store large text resource in VBA project", "body": "<p>In a VBA project, I have a large SQL query that I retrieve into a string variable to form part of an operation to retrieve data from a remote database.</p>\n\n<p>At present, I am storing this in plain text in a file, and I retrieve it from that file when needed.</p>\n\n<p>Whilst this makes development/updates easier because I can readily edit the query in the file, it does present an exposure because a user could edit the file, possibly maliciously (limited opportunity for damage, but an unacceptable security exposure nonetheless).</p>\n\n<p>The options to mitigate this risk that I am considering/have considered are:</p>\n\n<ul>\n<li><strong>store the text inside the project, as a global variable</strong>. Good because it's not exposed to the user, but unfortunately this means every time I need to make changes to the query, I have to transform the query into chunks, escape quotes, use line continuation, add line feeds and concatenate each chunk together. Yuk.</li>\n<li><strong>store the text in a module wrapped in directives not to compile it</strong>, then use VBE methods to retrieve and parse the text in from the module lines. Better than above but requires VBE to be enabled by end-users. That counts this option out.</li>\n<li><strong>keep the text in an external file, but obfuscate it</strong> (e.g. Base64 encode it). Adds some (acceptable) overhead for edits to the file, but requires a base64 decoding method in the project (does VBA have one?).</li>\n<li><strong>as above but use encryption</strong> of some kind - again, needs a decrypting method in the project.</li>\n<li><strong>store the text in a securable file-based format</strong> (eg .mdb or .accdb) and code credentials into the Visio project to retrieve the text.</li>\n</ul>\n\n<p>Any recommendations or experiences? Have I missed some straightforward option that VBA offers?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4559292, "user_type": "registered", "profile_image": "https://graph.facebook.com/1060278540654106/picture?type=large", "display_name": "MKDev", "link": "https://stackoverflow.com/users/4559292/mkdev"}, "edited": false, "score": 0, "creation_date": 1434798457, "post_id": 30888290, "comment_id": 49939784, "body": "Thank you so much R3uK!! I had to tweak it a lot for my needs but I got the general framework! thank you so much!!"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 0, "last_activity_date": 1434812182, "last_edit_date": 1434812182, "creation_date": 1434535194, "answer_id": 30888290, "question_id": 30887384, "link": "https://stackoverflow.com/questions/30887384/how-to-use-each-value-in-a-range-to-autofilter-data-in-another-sheet/30888290#30888290", "title": "How to use each value in a range to autofilter data in another sheet?", "body": "<p>Take a look at this (there is comments in the code to help you) :</p>\n\n<pre><code>Sub MKDev1()\nDim WsSrc As Worksheet, _\n    WsFilt As Worksheet, _\n    RgSrc As Range, _\n    RgFilt As Range, _\n    rCell As Range, _\n    ColumnToFilter As Integer, _\n    OutPutWs As Worksheet\n\n'Define the name of your sheets\nSet WsSrc = Sheets(\"Sheet1\")\nSet WsFilt = Sheets(\"Sheet2\")\nSet RgSrc = WsSrc.Range(\"A1:\" &amp; _\n                ColLet(WsSrc.Columns(WsSrc.Columns.Count).End(xlToLeft).Column) &amp; _\n                WsSrc.Rows(WsSrc.Rows.Count).End(xlUp).Row)\n'Change the column to the one in which you have the unique values\nSet RgFilt = WsFilt.Range(\"A1:A\" &amp; Range(\"A\" &amp; WsFilt.Rows.Count).End(xlUp).Row)\n\n'Set your column to filter (here \"A\"// 1st column)\nColumnToFilter = 1\nIf WsSrc.AutoFilterMode = False Then WsSrc.AutoFilterMode = True\n\n\nFor Each rCell In RgFilt\n    Set OutPutWs = DeleteAndAddSheet(rCell.Value)\n    RgSrc.AutoFilter Field:=ColumnToFilter, Criteria1:=rCell.Value\n\n    '2 ways of copying\n    'Less efficient (tested)\n    RgSrc.AutoFilter.Range.Copy Destination:=OutPutWs.Range(\"A1\")\n    'More efficient (untested here)\n    'OutPutWs.Range(\"A1\").Value = RgSrc.AutoFilter.Range.Value\n\n    'Get rid of previous filters\n    RgSrc.AutoFilter.ShowAllData\nNext rCell\n\nThisWorkbook.Save\n\nSet WsSrc = Nothing\nSet WsFilt = Nothing\nSet RgSrc = Nothing\nSet RgFilt = Nothing\nSet OutPutWs = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Function to get the letter reference of a column from is index :</p>\n\n<pre><code>Public Function ColLet(x As Integer) As String\nWith ActiveSheet.Columns(x)\n    ColLet = Left(.Address(False, False), InStr(.Address(False, False), \":\") - 1)\nEnd With\nEnd Function\n</code></pre>\n\n<p>Function to delete, create and set a new sheet from its name :</p>\n\n<pre><code>Public Function DeleteAndAddSheet(ByVal SheetName As String) As Worksheet\n\nFor Each aShe In Sheets\n    If aShe.Name &lt;&gt; SheetName Then\n    Else\n        Application.DisplayAlerts = False\n        aShe.Delete\n        Application.DisplayAlerts = True\n        Exit For\n    End If\nNext aShe\n\nSheets.Add after:=Sheets(Sheets.Count)\nSheets(Sheets.Count).Name = SheetName\n\nSet DeleteAndAddSheet = ThisWorkbook.Worksheets(Worksheets.Count)\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4559292, "user_type": "registered", "profile_image": "https://graph.facebook.com/1060278540654106/picture?type=large", "display_name": "MKDev", "link": "https://stackoverflow.com/users/4559292/mkdev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 30888290, "answer_count": 1, "score": -1, "last_activity_date": 1434812182, "creation_date": 1434532922, "last_edit_date": 1434535148, "question_id": 30887384, "link": "https://stackoverflow.com/questions/30887384/how-to-use-each-value-in-a-range-to-autofilter-data-in-another-sheet", "title": "How to use each value in a range to autofilter data in another sheet?", "body": "<p>I'm a bit new to VBA, so was hoping to get some help on this page from you experts! I have the following requirement:</p>\n\n<ul>\n<li>I have a table with unique values of Column2 in Sheet2(range)</li>\n<li>I need to filter out data in Sheet1 using each value in the above range and save it in a separate sheet.</li>\n</ul>\n\n<p>Snapshot of example attached:\n<a href=\"http://tinypic.com/r/35d3z9f/8\" rel=\"nofollow\">enter link description here</a></p>\n\n<p>So, how do I go about doing this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7115, "user_id": 2347483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80792d6741e11aaa6bec5f80fcc30a9c?s=128&d=identicon&r=PG", "display_name": "Phylogenesis", "link": "https://stackoverflow.com/users/2347483/phylogenesis"}, "edited": false, "score": 0, "creation_date": 1434532663, "post_id": 30887213, "comment_id": 49814244, "body": "This sounds like the sort of thing you should use <a href=\"https://support.office.com/en-us/article/Create-a-PivotTable-to-analyze-worksheet-data-a9a84538-bfe9-40a9-a8e9-f99134456576\" rel=\"nofollow noreferrer\">pivot tables</a> for."}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1434532676, "post_id": 30887213, "comment_id": 49814252, "body": "use formula- <code>SumIfs()</code> should work"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1434532678, "post_id": 30887213, "comment_id": 49814253, "body": "I think you can do all this directly on the worksheet. Could you give a specific example please?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1434533650, "post_id": 30887213, "comment_id": 49815034, "body": "You may want to see <a href=\"http://stackoverflow.com/help/how-to-ask\">How To Ask A Good Question</a>"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 5018732, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ee207c1cecc93b807188c910495ff83a?s=128&d=identicon&r=PG&f=1", "display_name": "ianf", "link": "https://stackoverflow.com/users/5018732/ianf"}, "edited": false, "score": 0, "creation_date": 1434613745, "post_id": 30887406, "comment_id": 49856615, "body": "Thankyou, This worked a treat and I recorded a macro to automate it. I was obviuosly looking at a too complicated solution."}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "reply_to_user": {"reputation": 39, "user_id": 5018732, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ee207c1cecc93b807188c910495ff83a?s=128&d=identicon&r=PG&f=1", "display_name": "ianf", "link": "https://stackoverflow.com/users/5018732/ianf"}, "edited": false, "score": 0, "creation_date": 1434614112, "post_id": 30887406, "comment_id": 49856829, "body": "If you are happy with answer you could accept the answer"}, {"owner": {"reputation": 39, "user_id": 5018732, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ee207c1cecc93b807188c910495ff83a?s=128&d=identicon&r=PG&f=1", "display_name": "ianf", "link": "https://stackoverflow.com/users/5018732/ianf"}, "edited": false, "score": 0, "creation_date": 1434625445, "post_id": 30887406, "comment_id": 49864285, "body": "Sorry I am new to this forum. Just accepted. Thanks again."}], "tags": [], "owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "is_accepted": true, "score": 0, "last_activity_date": 1434532962, "creation_date": 1434532962, "answer_id": 30887406, "question_id": 30887213, "link": "https://stackoverflow.com/questions/30887213/vba-code-to-sum-totals-grouped-by-invoice/30887406#30887406", "title": "VBA code to sum totals grouped by invoice", "body": "<p>Assuming you have headers in row 1 write this formula to <code>D2</code> and copy it down until the last row of your list:</p>\n\n<pre><code>=IF(COUNTIF($A$2:A2,A2)=1,SUMIFS($C:$C,$A:$A,A2),\"\")\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 5018732, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ee207c1cecc93b807188c910495ff83a?s=128&d=identicon&r=PG&f=1", "display_name": "ianf", "link": "https://stackoverflow.com/users/5018732/ianf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 506, "favorite_count": 0, "accepted_answer_id": 30887406, "answer_count": 1, "score": 0, "last_activity_date": 1434570578, "creation_date": 1434532488, "last_edit_date": 1531161705, "question_id": 30887213, "link": "https://stackoverflow.com/questions/30887213/vba-code-to-sum-totals-grouped-by-invoice", "title": "VBA code to sum totals grouped by invoice", "body": "<p>I am new to vba and would like to automate a rather manual process in excel 2007.</p>\n\n<p>I have a list of invoice numbers in column A (can be up to about 500 lines long), a list of items and any associated accessories in column B and the invoice value/amounts in column C.</p>\n\n<p>What I would like to do is obtain some vba code to total the amounts by invoice number and display the total for each invoice alongside each first appearing invoice (invoice number in column A) and display the total for each invoice in column D (Total).</p>\n\n<p>Can anyone help me with the vba code to do this please.</p>\n\n<p>Thanks\nIan</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1434531224, "post_id": 30886683, "comment_id": 49813279, "body": "<code>How do I amend this.</code>? Please explain what problem are you facing and what have you tried to solve that problem."}, {"owner": {"reputation": 313, "user_id": 4252721, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8c4614b13fef92c794fe2d0833d0b2a4?s=128&d=identicon&r=PG", "display_name": "AMorton1989", "link": "https://stackoverflow.com/users/4252721/amorton1989"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1434531934, "post_id": 30886683, "comment_id": 49813737, "body": "My problem is locating what I need to amend in order to copy specific columns. I am assuming that it is within this line -                                            Set copyFrom = .Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow      The entire row function perhaps needs to be amended to a specific cells function."}], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 4252721, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8c4614b13fef92c794fe2d0833d0b2a4?s=128&d=identicon&r=PG", "display_name": "AMorton1989", "link": "https://stackoverflow.com/users/4252721/amorton1989"}, "edited": false, "score": 0, "creation_date": 1434532104, "post_id": 30886902, "comment_id": 49813860, "body": "Great didn&#39;t see this. Thanks for pointing me in the right direction."}], "tags": [], "owner": {"reputation": 20573, "user_id": 1280587, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/j4XVS.png?s=128&g=1", "display_name": "paul", "link": "https://stackoverflow.com/users/1280587/paul"}, "is_accepted": true, "score": 1, "last_activity_date": 1434531610, "creation_date": 1434531610, "answer_id": 30886902, "question_id": 30886683, "link": "https://stackoverflow.com/questions/30886683/copying-certain-columns-vba/30886902#30886902", "title": "Copying certain columns VBA", "body": "<p>This line copies the entire row:</p>\n\n<p><code>Set copyFrom = \n  .Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow</code></p>\n\n<p>You will need to change <code>EntireRow</code> to just copy the columns you want, probably something like:</p>\n\n<p><code>Set copyFrom = \n  .Offset(1, 0).SpecialCells(xlCellTypeVisible).Range(.Cells(1,2),.Cells(1,3))</code></p>\n\n<p>Hope this helps, I can't check this right now.</p>\n"}], "owner": {"reputation": 313, "user_id": 4252721, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8c4614b13fef92c794fe2d0833d0b2a4?s=128&d=identicon&r=PG", "display_name": "AMorton1989", "link": "https://stackoverflow.com/users/4252721/amorton1989"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 30886902, "answer_count": 1, "score": -1, "last_activity_date": 1434552710, "creation_date": 1434531056, "last_edit_date": 1434552710, "question_id": 30886683, "link": "https://stackoverflow.com/questions/30886683/copying-certain-columns-vba", "title": "Copying certain columns VBA", "body": "<p>I have a working VBA macro which copies from one spreadsheet 'AverageEarnings' to another 'Sheet1', under the condition that Column AO has the word 'UNGRADED' in it. The macro copies the entirety of these conditional rows to Sheet1. I am looking to copy columns B and C ('AverageEarnings') to columns A and B ('Sheet1'). How do I amend this. </p>\n\n<pre><code> Sub UngradedToSHEET1()\n\n' UngradedToSHEET1 Macro\n'\n    Dim wb1 As Workbook, wb2 As Workbook\n    Dim ws1 As Worksheet, ws2 As Worksheet\n    Dim copyFrom As Range\n    Dim lRow As Long\n    Dim stringToFind As String\n\n    Set wb1 = ThisWorkbook\n    Set ws1 = wb1.Worksheets(\"AverageEarnings\")\n\n    stringToFind = \"UNGRADED\"\n\n    With ws1\n        'Remove all filters from spreadsheet to prevent loss of information.\n        .AutoFilterMode = False\n        lRow = .Range(\"AO\" &amp; .Rows.Count).End(xlUp).Row 'Find a specific column.\n\n        With .Range(\"AO1:AO\" &amp; lRow) ' This is the row where GRADED or UNGRADED is specified.\n            .AutoFilter Field:=1, Criteria1:=\"=*\" &amp; stringToFind &amp; \"*\" 'Filter specific information.\n            Set copyFrom = .Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow\n        End With\n\n        'Remove spreadsheet filters again.\n        .AutoFilterMode = False\n    End With\n\n    Set ws2 = wb1.Worksheets(\"Sheet1\")\n\n    With ws2\n        If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then    ' Find a blank row after A1.\n            lRow = .Cells.Find(What:=\"*\", _\n                          After:=.Range(\"A1\"), _\n                          Lookat:=xlPart, _\n                          LookIn:=xlFormulas, _\n                          SearchOrder:=xlByRows, _\n                          SearchDirection:=xlPrevious, _\n                          MatchCase:=False).Row\n        Else\n            lRow = 1\n        End If\n        copyFrom.Copy .Rows(lRow)\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 751, "user_id": 1991469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e640ff106f3c00848f5dd1b441d527f?s=128&d=identicon&r=PG", "display_name": "Keith A", "link": "https://stackoverflow.com/users/1991469/keith-a"}, "edited": false, "score": 0, "creation_date": 1434531089, "post_id": 30886626, "comment_id": 49813169, "body": "what am i looking at? A B C D E F G H I 1 2 C1 C2 C3 3 1 4 7 4 2 5 8 5 3 6 9 6?  are these columns? I don&#39;t think it&#39;s formatted properly."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1434531140, "post_id": 30886626, "comment_id": 49813205, "body": "You may want to see <a href=\"http://stackoverflow.com/help/how-to-ask\">How To Ask Good Questions</a>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1434531156, "post_id": 30886626, "comment_id": 49813221, "body": "It&#39;s not at all clear what your data looks like, but you basically want INDEX and MATCH formulas."}], "answers": [{"comments": [{"owner": {"reputation": 1547, "user_id": 5018666, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3285c5f71d61866c450ea23ccce2562a?s=128&d=identicon&r=PG&f=1", "display_name": "km1234", "link": "https://stackoverflow.com/users/5018666/km1234"}, "edited": false, "score": 0, "creation_date": 1434533128, "post_id": 30887008, "comment_id": 49814600, "body": "Thanks Keith for the answer and the promptness. I have also found an alternative formula, but it requires to put an additional column of 1,2,3... next to the column I want the results: =HLOOKUP($B$2,$E$2:$G$5,A3+1). It works but it is not as elegant as yours. Thanks."}], "tags": [], "owner": {"reputation": 751, "user_id": 1991469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e640ff106f3c00848f5dd1b441d527f?s=128&d=identicon&r=PG", "display_name": "Keith A", "link": "https://stackoverflow.com/users/1991469/keith-a"}, "is_accepted": true, "score": 0, "last_activity_date": 1434532702, "last_edit_date": 1434532702, "creation_date": 1434531899, "answer_id": 30887008, "question_id": 30886626, "link": "https://stackoverflow.com/questions/30886626/pick-and-transfer-a-column-in-excel-without-vba/30887008#30887008", "title": "pick and transfer a column in excel without VBA", "body": "<ul>\n<li>Updated to match the cells in your example.</li>\n</ul>\n\n<p>Use this formula on your column B3 and drag the handle down to copy to other cells below.</p>\n\n<pre><code>=OFFSET(E3,0,MATCH($B$2,$E$2:$G$2,0)-1)\n</code></pre>\n\n<p>you should end up with the following formula in cell B3, B4, B5</p>\n\n<pre><code>=OFFSET(E3,0,MATCH($B$2,$E$2:$G$2,0)-1)\n=OFFSET(E4,0,MATCH($B$2,$E$2:$G$2,0)-1)\n=OFFSET(E5,0,MATCH($B$2,$E$2:$G$2,0)-1)\n</code></pre>\n\n<p>Now when you change the value in B2, say to \"C3\". the columns below will change to \"C3\" data accordingly.</p>\n\n<p>let me know if you ran into any problems. kindly accept if this answered your problem.</p>\n"}], "owner": {"reputation": 1547, "user_id": 5018666, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3285c5f71d61866c450ea23ccce2562a?s=128&d=identicon&r=PG&f=1", "display_name": "km1234", "link": "https://stackoverflow.com/users/5018666/km1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 30887008, "answer_count": 1, "score": -3, "last_activity_date": 1434532702, "creation_date": 1434530891, "last_edit_date": 1531161705, "question_id": 30886626, "link": "https://stackoverflow.com/questions/30886626/pick-and-transfer-a-column-in-excel-without-vba", "title": "pick and transfer a column in excel without VBA", "body": "<p>I have the following problem. I have three columns in Excel, each with its own title/header. I want to pick and transfer one of the columns based on its title/header, without using VBA. Let me give an example. My data set is the following:</p>\n\n<pre><code>  A  B  C  D  E  F  G  H  I\n1\n2              C1   C2    C3\n3              1    4     7 \n4              2    5     8\n5              3    6     9\n6\n</code></pre>\n\n<p>I want to put the title/header of the column at eg B2 and get the data of the column, as shown below:</p>\n\n<pre><code>  A  B  C  D  E  F  G  H  I\n1\n2     C1       C1   C2    C3\n3     1        1    4     7 \n4     2        2    5     8\n5     3        3    6     9\n6\n</code></pre>\n\n<p>And when I change to eg C3, I get the C3 column:</p>\n\n<pre><code>  A  B  C  D  E  F  G  H  I\n1\n2     C3       C1   C2    C3\n3     7        1    4     7 \n4     8        2    5     8\n5     9        3    6     9\n6\n</code></pre>\n\n<p>My understanding is that I need to put a formula in B2, I just don't know how to structure it. It seems like a vlookup, but vlookup finds and picks at the same direction, while I want to find my variable searching horizontally and then pick vertically.</p>\n\n<p>I know how to do it using VBA, but I would like to do it without using it. I would also welcome an elegant VBA code, but avoiding VBA would be better. I am new in Excel/VBA, so any help is welcome. Thanks in advance! </p>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1434531093, "post_id": 30886593, "comment_id": 49813172, "body": "<code>Please help...it will be good if there will be any vba code or excel formula</code> It will be good if I could get paid for these kind of questions :D You may want to see <a href=\"http://stackoverflow.com/help/how-to-ask\">How To Ask Good Questions</a>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1434538040, "post_id": 30886593, "comment_id": 49818025, "body": "Welcome to SO.  This is not a free code writing service but we will be happy to help you with yours.  Show us what you have tried and where you have run into problems.  There are plenty of examples of similar problems on SO that should give you a start. You might start by checking Excel HELP for <code>remove duplicates</code>, then search SO for how to concatenate a variable number of cells into one."}], "answers": [{"tags": [], "owner": {"reputation": 73, "user_id": 4895565, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-I2aaHoh2AA8/AAAAAAAAAAI/AAAAAAAAABQ/f2yG1s-5Mx8/photo.jpg?sz=128", "display_name": "Kalpesh Koli", "link": "https://stackoverflow.com/users/4895565/kalpesh-koli"}, "is_accepted": false, "score": 0, "last_activity_date": 1434539991, "creation_date": 1434539991, "answer_id": 30890055, "question_id": 30886593, "link": "https://stackoverflow.com/questions/30886593/store-value-in-one-cell/30890055#30890055", "title": "Store value in one cell", "body": "<p>thanks for all help...</p>\n\n<p>I done with my own.....however really thanks for the same...</p>\n\n<pre><code>Sub combine()\nDim mstr, mstr2 As String\nDim v As Range\nSet v = Sheets(\"Data\").Range(\"A1\")\nmstr = \"\"\nmstr2 = \"\"\ni = 0\nDo\ni = i + 1\nv.Cells(i, 1).Select\n\nIf IsNumeric(v.Cells(i, 1)) = True Then\nmstr = mstr + \"'\" + str(v.Cells(i, 1)) + \"'  or \"\nmstr2 = mstr2 + \"'\" + str(v.Cells(i, 1)) + \"'  , \"\nElse\nmstr = mstr + \"'\" + v.Cells(i, 1) + \"'  or \"\nmstr2 = mstr2 + \"\" + v.Cells(i, 1) + \"  , \"\nEnd If\n\nLoop While IsEmpty(v.Cells(i + 1)) = False\nmstr = Left(mstr, Len(mstr) - 4)\nmstr2 = Left(mstr2, Len(mstr2) - 4)\nSheets(\"Data\").Range(\"C3\") = mstr\nSheets(\"Data\").Range(\"C4\") = mstr2\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 325, "user_id": 5008116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4daf0c71a9d2cd598e7025bb911b90c3?s=128&d=identicon&r=PG&f=1", "display_name": "gudal", "link": "https://stackoverflow.com/users/5008116/gudal"}, "is_accepted": false, "score": 0, "last_activity_date": 1434540369, "creation_date": 1434540369, "answer_id": 30890184, "question_id": 30886593, "link": "https://stackoverflow.com/questions/30886593/store-value-in-one-cell/30890184#30890184", "title": "Store value in one cell", "body": "<p>You can create the following custom function:</p>\n\n<pre><code>Function UniqueInString(InputList As Range) As String\n\n    Dim inputListArray() As String\n\n    Dim cell As Range\n    Dim size As Integer\n    size = 0\n    ReDim Preserve inputListArray(size)\n    For Each cell In InputList.Cells\n        If Not (UBound(Filter(inputListArray, cell.Value)) &gt; -1) Then\n            ReDim Preserve inputListArray(size)\n            inputListArray(size) = cell.Value\n            size = size + 1\n        End If\n    Next cell\n\n\n    Dim counter As Integer\n    Dim result As String\n    result = \"\"\n    For counter = 0 To UBound(inputListArray)\n        result = result + inputListArray(counter) + \",\"\n    Next counter\n    result = Left(result, Len(result) - 1)\n    UniqueInString = result\nEnd Function\n</code></pre>\n\n<p>This wil give you the unique records in one cell, without having to create the unique records list. Just call this function on the list containing all records. Note that I do not thing this would perform that well if there where very many records.</p>\n"}], "owner": {"reputation": 73, "user_id": 4895565, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-I2aaHoh2AA8/AAAAAAAAAAI/AAAAAAAAABQ/f2yG1s-5Mx8/photo.jpg?sz=128", "display_name": "Kalpesh Koli", "link": "https://stackoverflow.com/users/4895565/kalpesh-koli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 747, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1434540369, "creation_date": 1434530822, "last_edit_date": 1531161705, "question_id": 30886593, "link": "https://stackoverflow.com/questions/30886593/store-value-in-one-cell", "title": "Store value in one cell", "body": "<p>i have one column in excel wherein there are list of values.</p>\n\n<p>what i want to do is i want to remove duplicate values from that column and want to store all that unique values in one cell \ne.g. after removeing the duplicates if there are list of below values\nOPF\nOIP\nOWL\nOVL\nThen i want to store above details in one cell i.e. OPF,OIP,OWL,OVL</p>\n\n<p>Please help...it will be good if there will be any vba code or excel formula </p>\n\n<p><img src=\"https://i.stack.imgur.com/8ZcOO.jpg\" alt=\"Sample\"></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 0, "last_activity_date": 1434533242, "last_edit_date": 1495542139, "creation_date": 1434533242, "answer_id": 30887506, "question_id": 30886514, "link": "https://stackoverflow.com/questions/30886514/macro-that-organises-groups-outlines-need-to-adjust-the-area-that-the-macro-a/30887506#30887506", "title": "MACRO that organises, groups, outlines (Need to adjust the area that the macro applies to)", "body": "<p>I added a new variable <code>StartFrom</code> so that you'll only have to change the value once to make it work on a different range.</p>\n\n<p>Also, I changed the definition of <code>lastRow</code>, take a look at <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">Error in finding last used cell in VBA</a></p>\n\n<p>Give this a try :</p>\n\n<pre><code>Sub formatresults()\n\nDim lastRow As Long\nDim pop As Range\nDim rpSet As Range\nDim rpSetNames As Range\nDim sBeg As Integer\nDim sEnd As Integer\nDim rpName As String\nDim x As Integer\nDim y As Integer, _\n    StartFrom As Integer\n\nStartFrom = 4\n\nlastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nSet pop = Range(Cells(StartFrom, 1), Cells(lastRow, 7))\nsBeg = StartFrom\nsEnd = StartFrom\ny = 1\nrpName = Cells(StartFrom, 1) '----\nRange(Cells(1, 7), Cells(lastRow, 7)).NumberFormat = \"0.00%\"\n\nFor x = StartFrom To lastRow '----\n\n    If Cells(sEnd + 1, 1) = rpName Then\n        sEnd = sEnd + 1\n    Else\n        Set rpSet = Range(Cells(sBeg, 1), Cells(sEnd, 7))\n        Set rpSetNames = Range(Cells(sBeg, 1), Cells(sEnd, 1))\n        rpSet.BorderAround Weight:=xlMedium\n\n        If y Mod 2 = 1 Then rpSetNames.Interior.ColorIndex = 15\n\n        sBeg = sEnd + 1\n        sEnd = sEnd + 1\n        rpName = Cells(sBeg, 1)\n        y = y + 1\n    End If\n\nNext x\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 4242750, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0f78647b3093dbf3c60a6a77dcb082ee?s=128&d=identicon&r=PG&f=1", "display_name": "user4242750", "link": "https://stackoverflow.com/users/4242750/user4242750"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 0, "accepted_answer_id": 30887506, "answer_count": 1, "score": 1, "last_activity_date": 1434552725, "creation_date": 1434530596, "last_edit_date": 1434552725, "question_id": 30886514, "link": "https://stackoverflow.com/questions/30886514/macro-that-organises-groups-outlines-need-to-adjust-the-area-that-the-macro-a", "title": "MACRO that organises, groups, outlines (Need to adjust the area that the macro applies to)", "body": "<p>How to apply this from A4 instead of A2. Everything else I am happy with. I just want to understand any changes that I need to make to this.</p>\n\n<p>Is it needing changes at \"set population\"? The 2? </p>\n\n<pre><code>Sub formatresults()\n\nDim lastRow As Long\nDim pop As Range\nDim rpSet As Range\nDim rpSetNames As Range\nDim sBeg As Integer\nDim sEnd As Integer\nDim rpName As String\nDim x As Integer\nDim y As Integer\n\n\nlastRow = Range(Cells(99999, 1), Cells(99999, 1)).End(xlUp).row\nSet pop = Range(Cells(2, 1), Cells(lastRow, 7))\nsBeg = 2\nsEnd = 2\ny = 1\nrpName = Cells(2, 1)\nRange(Cells(1, 7), Cells(lastRow, 7)).NumberFormat = \"0.00%\"\n\nFor x = 2 To lastRow\n\n    If Cells(sEnd + 1, 1) = rpName Then\n        sEnd = sEnd + 1\n    Else\n        Set rpSet = Range(Cells(sBeg, 1), Cells(sEnd, 7))\n        Set rpSetNames = Range(Cells(sBeg, 1), Cells(sEnd, 1))\n        rpSet.BorderAround Weight:=xlMedium\n\n        If y Mod 2 = 1 Then rpSetNames.Interior.ColorIndex = 15\n\n        sBeg = sEnd + 1\n        sEnd = sEnd + 1\n        rpName = Cells(sBeg, 1)\n        y = y + 1\n    End If\n\nNext x\n\nEnd Sub\n</code></pre>\n\n<p>Many thanks!</p>\n"}, {"tags": ["vba", "excel", "variables", "data-structures"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1434527264, "post_id": 30885288, "comment_id": 49810728, "body": "Your other code should check if <code>test</code> is an array before trying to loop through it."}, {"owner": {"reputation": 157295, "user_id": 76337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1aa48f7606f5b08595b0a0356a61e8b6?s=128&d=identicon&r=PG", "display_name": "John Saunders", "link": "https://stackoverflow.com/users/76337/john-saunders"}, "edited": false, "score": 0, "creation_date": 1434530237, "post_id": 30885288, "comment_id": 49812584, "body": "I have edited your title. Please see, &quot;<a href=\"http://meta.stackexchange.com/questions/19190/\">Should questions include \u201ctags\u201d in their titles?</a>&quot;, where the consensus is &quot;no, they should not&quot;."}, {"owner": {"reputation": 245, "user_id": 2991246, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000283477300/picture?type=large", "display_name": "Clemens", "link": "https://stackoverflow.com/users/2991246/clemens"}, "edited": false, "score": 0, "creation_date": 1434531722, "post_id": 30885288, "comment_id": 49813602, "body": "Thank you for your inputs! R3uK has the most structured answer I guess :)"}], "answers": [{"comments": [{"owner": {"reputation": 245, "user_id": 2991246, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000283477300/picture?type=large", "display_name": "Clemens", "link": "https://stackoverflow.com/users/2991246/clemens"}, "edited": false, "score": 1, "creation_date": 1434531652, "post_id": 30885864, "comment_id": 49813557, "body": "Thank you a lot for the input! Works perfectly fine :) so simple and yet solved my hours of problems!"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 245, "user_id": 2991246, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000283477300/picture?type=large", "display_name": "Clemens", "link": "https://stackoverflow.com/users/2991246/clemens"}, "edited": false, "score": 1, "creation_date": 1434532005, "post_id": 30885864, "comment_id": 49813793, "body": "Glad I could help! ;) And it is usual to spend hours on a simple matter as we can&#39;t know all of the tricks, that&#39;s why that site is so magical/practical!"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 2, "last_activity_date": 1434528777, "creation_date": 1434528777, "answer_id": 30885864, "question_id": 30885288, "link": "https://stackoverflow.com/questions/30885288/read-variable-excel-data-into-variant-with-the-same-format/30885864#30885864", "title": "read variable excel data into variant with the same format", "body": "<p>You could force <code>test</code> to be an array with only one cell, if the last column is B or less :</p>\n\n<pre><code>' Define Last Column with a value\nLastCol = Sheets(\"Filter\").Cells(20, Sheets(\"Filter\").Columns.Count).End(xlToLeft).Column\nCol_Letter = Split(Cells(1, LastCol).Address(True, False), \"$\")(0)\n\nIf LastCol &lt;= 2 Then\n    ReDim test(1 To 1, 1 To 1)\n    test(1, 1) = Sheets(\"Filter\").Range(\"B20\").Value\nElse\n    'Read Data into variable\n    test = Sheets(\"Filter\").Range(\"B20:\" &amp; Col_Letter &amp; \"20\").Value\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1434613950, "post_id": 30886348, "comment_id": 49856733, "body": "Here, it might be more practical to use <code>ReDim test(1 To 1, 1 To 1)</code>, because for your solution, <code>LBound(test,1)=0</code> and <code>LBound(test,2)=0</code> so there will be 3 empty cells (<code>test(0,0)</code>, <code>test(1,0)</code> and <code>test(1,1)</code>) in that array."}], "tags": [], "owner": {"reputation": 61, "user_id": 3686134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f28054fff1cd57116c53613804627e40?s=128&d=identicon&r=PG", "display_name": "Mohamed Allam", "link": "https://stackoverflow.com/users/3686134/mohamed-allam"}, "is_accepted": false, "score": 2, "last_activity_date": 1434530159, "creation_date": 1434530159, "answer_id": 30886348, "question_id": 30885288, "link": "https://stackoverflow.com/questions/30885288/read-variable-excel-data-into-variant-with-the-same-format/30886348#30886348", "title": "read variable excel data into variant with the same format", "body": "<p>You can check the length .. Try the following code:</p>\n\n<pre><code>Dim test As Variant\ntest = Sheets(\"Filter\").Range(\"B20:\" &amp; Col_Letter &amp; \"20\").Value\nIf Len(test) = 1 Then\n        ReDim test(1, 1)\n        test(1, 1) = Sheets(\"Filter\").Range(\"B20:\" &amp; Col_Letter &amp; \"20\").Value\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 245, "user_id": 2991246, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000283477300/picture?type=large", "display_name": "Clemens", "link": "https://stackoverflow.com/users/2991246/clemens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 461, "favorite_count": 0, "accepted_answer_id": 30885864, "answer_count": 2, "score": 0, "last_activity_date": 1434530227, "creation_date": 1434526999, "last_edit_date": 1434530227, "question_id": 30885288, "link": "https://stackoverflow.com/questions/30885288/read-variable-excel-data-into-variant-with-the-same-format", "title": "read variable excel data into variant with the same format", "body": "<p>I'm currently writing a Macro for Excel. First I want to read my variable settings from row 20 from my sheet \"Filter\" into my variable \"test\": </p>\n\n<pre><code>' Define Last Column with a value\nLastCol = Sheets(\"Filter\").Cells(20, Sheets(\"Filter\").Columns.Count).End(xlToLeft).Column\nCol_Letter = Split(Cells(1, LastCol).Address(True, False), \"$\")(0)\n\n' Read Data into variable\ntest = Sheets(\"Filter\").Range(\"B20:\" &amp; Col_Letter &amp; \"20\").Value\n</code></pre>\n\n<p>This works fine so far and I get a variant with a structure like that: </p>\n\n<pre><code>test\n  test(1)\n    test(1,1) = value1\n    test(1,2) = value2\n    test(1,3) = value3\n    ...\n</code></pre>\n\n<p>My problem comes now: \nWhen I have only one value to read, the structure changes automatically to following: </p>\n\n<pre><code>test = value1\n</code></pre>\n\n<p>How can I change the structure to this?</p>\n\n<pre><code>test\n  test(1)\n    test(1,1) = value1\n</code></pre>\n\n<p>My problem is that with this one variable I run into various problems in my code (ubound, lbound, ...).</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 2177, "user_id": 1211997, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/289e883b1531a6c68ce799642e3b918e?s=128&d=identicon&r=PG", "display_name": "rheitzman", "link": "https://stackoverflow.com/users/1211997/rheitzman"}, "edited": false, "score": 0, "creation_date": 1434553571, "post_id": 30884057, "comment_id": 49830026, "body": "Unless you are working with fixed space fonts just adding whitespace may not work. Have you considered using a table. In VBA, add a table, add a row, address the cells to load the data. Repeat last two for the rest of the data."}], "answers": [{"tags": [], "owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "is_accepted": true, "score": 0, "last_activity_date": 1434525215, "creation_date": 1434525215, "answer_id": 30884670, "question_id": 30884057, "link": "https://stackoverflow.com/questions/30884057/how-to-fill-the-rest-of-line-with-space-string/30884670#30884670", "title": "How to fill the rest of line with space() / string()?", "body": "<p>Your question is not very clear. This would likely help you anyway.</p>\n\n<p>If you have a <code>String</code> <code>a</code>, which you want to pad with blanks up to 255 characters, you would do</p>\n\n<pre><code>Dim apad As String\napad = a &amp; space(255 - len(a))  ' or\n'apad = a &amp; String(255 - len(a), \" \")  ' or\n'apad = a &amp; WorksheetFunction.Rept(\" \", 255 - len(a))\n</code></pre>\n\n<p>You then use <code>apad</code> for whatever you need.</p>\n"}], "owner": {"reputation": 1, "user_id": 5018234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbfda235e4caa0130d42126fd10fce79?s=128&d=identicon&r=PG&f=1", "display_name": "kls0", "link": "https://stackoverflow.com/users/5018234/kls0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "accepted_answer_id": 30884670, "answer_count": 1, "score": -3, "last_activity_date": 1434543384, "creation_date": 1434523378, "last_edit_date": 1434543384, "question_id": 30884057, "link": "https://stackoverflow.com/questions/30884057/how-to-fill-the-rest-of-line-with-space-string", "title": "How to fill the rest of line with space() / string()?", "body": "<p>I am generating a word document filled with user inputed values (userform input).</p>\n\n<p>Is there any way to fill the space after typed value with amount of whitespace required to fill the rest of the line?</p>\n\n<p>Or how to get the amount of characters left to the end of line?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 4951600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d048ec7082971a896cb3234d3df616fc?s=128&d=identicon&r=PG&f=1", "display_name": "ssneha", "link": "https://stackoverflow.com/users/4951600/ssneha"}, "edited": false, "score": 0, "creation_date": 1434538958, "post_id": 30883502, "comment_id": 49818628, "body": "The above code is working only for the first row, i need the same condition to be applicable for entire column. Eg: Column A and Column B, For each date entries in each of these columns cells, I need the comparison to be applied."}, {"owner": {"reputation": 1268, "user_id": 1475411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YP52h.png?s=128&g=1", "display_name": "MNS", "link": "https://stackoverflow.com/users/1475411/mns"}, "reply_to_user": {"reputation": 29, "user_id": 4951600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d048ec7082971a896cb3234d3df616fc?s=128&d=identicon&r=PG&f=1", "display_name": "ssneha", "link": "https://stackoverflow.com/users/4951600/ssneha"}, "edited": false, "score": 0, "creation_date": 1434539922, "post_id": 30883502, "comment_id": 49819252, "body": "@ssneha: You just need to iterate over all rows of column A and B. You can do it by adding a for loop. To get the maximum rows of a column use code such as lRowCountA = ThisWorkbook.Sheets(1).Range(&quot;A&quot; &amp; ThisWorkbook.Sheets(1).Rows.Count).End(xlUp).Row"}, {"owner": {"reputation": 29, "user_id": 4951600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d048ec7082971a896cb3234d3df616fc?s=128&d=identicon&r=PG&f=1", "display_name": "ssneha", "link": "https://stackoverflow.com/users/4951600/ssneha"}, "edited": false, "score": 0, "creation_date": 1434686281, "post_id": 30883502, "comment_id": 49895313, "body": "@MNS: I tried with the above code, i am facing an issue. Suppose if the condition is applied for 10th row, for each row iteration message box is getting displayed, until it reached 10th row. I want to get it only for the 10th row."}, {"owner": {"reputation": 1268, "user_id": 1475411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YP52h.png?s=128&g=1", "display_name": "MNS", "link": "https://stackoverflow.com/users/1475411/mns"}, "reply_to_user": {"reputation": 29, "user_id": 4951600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d048ec7082971a896cb3234d3df616fc?s=128&d=identicon&r=PG&f=1", "display_name": "ssneha", "link": "https://stackoverflow.com/users/4951600/ssneha"}, "edited": false, "score": 0, "creation_date": 1434704613, "post_id": 30883502, "comment_id": 49903269, "body": "@ssneha: You can apply whatever logic required. If you want the message to be displayed only for the 10th row then you can put the MsgBox() call and its related checking inside an if condition. That if condition should check whether the loop count variable has reached 10 or not."}], "tags": [], "owner": {"reputation": 1268, "user_id": 1475411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YP52h.png?s=128&g=1", "display_name": "MNS", "link": "https://stackoverflow.com/users/1475411/mns"}, "is_accepted": false, "score": 2, "last_activity_date": 1434521477, "creation_date": 1434521477, "answer_id": 30883502, "question_id": 30883045, "link": "https://stackoverflow.com/questions/30883045/display-message-box-in-excel/30883502#30883502", "title": "Display message box in excel", "body": "<p>Following code will do it.</p>\n\n<pre><code>Dim Date1 As String\nDim Date2 As String\nDim msgResult As VbMsgBoxResult\n\nDate1 = ThisWorkbook.Sheets(1).Cells(1)\nDate2 = ThisWorkbook.Sheets(1).Cells(2)\n\nIf IsDate(Date1) And IsDate(Date2) Then\n    If CDate(Date1) = CDate(Date2) Then\n        msgResult = MsgBox(\"TARGET ACHIEVED\", vbYesNo)\n\n        If vbYes = msgResult Then\n            ' code for Yes handling\n            ThisWorkbook.Sheets(1).Cells(1).Interior.ColorIndex = 46 'orange\n        Else\n            ' code for NO handling\n            ThisWorkbook.Sheets(1).Cells(1).Interior.ColorIndex = 5 'blue color\n        End If\n    End If\nEnd If\n</code></pre>\n\n<p>You can get more Excel colour codes <a href=\"http://dmcritchie.mvps.org/excel/colors.htm\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 29, "user_id": 4951600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d048ec7082971a896cb3234d3df616fc?s=128&d=identicon&r=PG&f=1", "display_name": "ssneha", "link": "https://stackoverflow.com/users/4951600/ssneha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 746, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1434552734, "creation_date": 1434519488, "last_edit_date": 1434552734, "question_id": 30883045, "link": "https://stackoverflow.com/questions/30883045/display-message-box-in-excel", "title": "Display message box in excel", "body": "<p>I need to compare two date columns in excel(vba). If the cell values are equal, a message box has to be displayed with \"TARGET ACHIEVED\", \"YES\" or \"NO\" option. Based on the value selected, 2nd column cell color has to be changed\n - YES - orange\n - NO  - blue</p>\n"}, {"tags": ["vba", "excel", "inventory", "inventory-management"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5018013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc4ddf9259d689374cd1ac1143938cac?s=128&d=identicon&r=PG&f=1", "display_name": "user5018013", "link": "https://stackoverflow.com/users/5018013/user5018013"}, "edited": false, "score": 0, "creation_date": 1436256028, "post_id": 30883421, "comment_id": 50521155, "body": "What if i want the first entry to be placed in cell b10 instead of a5? I would assume I&#39;d just have to change the RANGE_BC option, however it doesn&#39;t seem to work?"}], "tags": [], "owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "is_accepted": false, "score": 1, "last_activity_date": 1434521134, "creation_date": 1434521134, "answer_id": 30883421, "question_id": 30882938, "link": "https://stackoverflow.com/questions/30882938/code-for-excel-inventory-to-count-returns/30883421#30883421", "title": "Code for excel inventory to count returns", "body": "<p>Try with this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Const SCAN_CELL As String = \"A1\"\n    Const SCAN_CELL_REMOVE As String = \"B1\"\n    Dim intAddRemoveExit As Integer\n    Const RANGE_BC As String = \"A5:A500\"\n    Dim val, f As Range, rngCodes As Range\n\n    If Target.Cells.Count &gt; 1 Then Exit Sub\n    If Not Intersect(Target, Me.Range(SCAN_CELL)) Is Nothing Then intAddRemoveExit = 1\n    If Not Intersect(Target, Me.Range(SCAN_CELL_REMOVE)) Is Nothing Then intAddRemoveExit = -1\n    If intAddRemoveExit = 0 Then Exit Sub\n\n    val = Trim(Target.Value)\n    If Len(val) = 0 Then Exit Sub\n\n    Set rngCodes = Me.Range(RANGE_BC)\n\n    Set f = rngCodes.Find(val, , xlValues, xlWhole)\n    If Not f Is Nothing Then\n        With f.Offset(0, 1)\n            .Value = .Value + intAddRemoveExit\n        End With\n    Else\n        Set f = rngCodes.Cells(rngCodes.Cells.Count).End(xlUp).Offset(1, 0)\n        f.Value = val\n        f.Offset(0, 1).Value = 1\n    End If\n\n    Application.EnableEvents = False\n    Target.Value = \"\"\n    Application.EnableEvents = True\n\n    Target.Select\n\nEnd Sub\n</code></pre>\n\n<p>Please keep in mind that this solution doesn't check if product amount is higher then zero before removing. So, amount could go below zero.</p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 3, "last_activity_date": 1434521770, "creation_date": 1434521770, "answer_id": 30883581, "question_id": 30882938, "link": "https://stackoverflow.com/questions/30882938/code-for-excel-inventory-to-count-returns/30883581#30883581", "title": "Code for excel inventory to count returns", "body": "<p>@Kazimierz beat me to it, but posting this anyway...</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Const SCAN_PLUS_CELL As String = \"A1\"\n    Const SCAN_MINUS_CELL As String = \"B1\"\n\n    Const RANGE_BC As String = \"A5:A500\"\n    Dim val, f As Range, rngCodes As Range, inc, addr\n\n    If Target.Cells.Count &gt; 1 Then Exit Sub\n\n    Select Case Target.Address(False, False)\n        Case SCAN_PLUS_CELL: inc = 1\n        Case SCAN_MINUS_CELL: inc = -1\n        Case Else: Exit Sub\n    End Select\n\n    val = Trim(Target.Value)\n    If Len(val) = 0 Then Exit Sub\n\n    Set rngCodes = Me.Range(RANGE_BC)\n\n    Set f = rngCodes.Find(val, , xlValues, xlWhole)\n    If Not f Is Nothing Then\n        With f.Offset(0, 1)\n            .Value = .Value + inc 'should really check for 0 when decrementing\n        End With\n    Else\n        If inc = 1 Then\n            Set f = rngCodes.Cells(rngCodes.Cells.Count).End(xlUp).Offset(1, 0)\n            f.Value = val\n            f.Offset(0, 1).Value = 1\n        Else\n            MsgBox \"Can't decrement inventory for '\" &amp; val &amp; \"': no match found!\", _\n                    vbExclamation\n        End If\n    End If\n\n    Application.EnableEvents = False\n    Target.Value = \"\"\n    Application.EnableEvents = True\n\n    Target.Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5018013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc4ddf9259d689374cd1ac1143938cac?s=128&d=identicon&r=PG&f=1", "display_name": "user5018013", "link": "https://stackoverflow.com/users/5018013/user5018013"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1034, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1434521770, "creation_date": 1434518899, "last_edit_date": 1495540275, "question_id": 30882938, "link": "https://stackoverflow.com/questions/30882938/code-for-excel-inventory-to-count-returns", "title": "Code for excel inventory to count returns", "body": "<p>I'm not a VBA expert but I am working on a temp inventory control using excel with a barcode scanner. I am currently using the code below (which I took from here <a href=\"https://stackoverflow.com/questions/11416944/quantity-macro-excel-for-inventory\">quantity macro excel for inventory</a>) to add the qty on the worksheet, ex. barcodeA scanned 3x will automatically register as 3 pcs in my worksheet. I need a way to incorporate subtracting quantity as well. I'd like the ff conditions to apply:</p>\n\n<pre><code>Cell \"A1\" = scan cell to add qty to inventory\nCell \"B1\" = scan cell to remove qty from the inventory\n</code></pre>\n\n<p>Any advise on how to tweak the code? I've been trying to adjust for days but whatever I do just doesn't seem to work.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Const SCAN_CELL As String = \"A1\"\n    Const RANGE_BC As String = \"A5:A500\"\n    Dim val, f As Range, rngCodes As Range\n\n    If Target.Cells.Count &gt; 1 Then Exit Sub\n    If Intersect(Target, Me.Range(SCAN_CELL)) Is Nothing Then Exit Sub\n\n    val = Trim(Target.Value)\n    If Len(val) = 0 Then Exit Sub\n\n    Set rngCodes = Me.Range(RANGE_BC)\n\n    Set f = rngCodes.Find(val, , xlValues, xlWhole)\n    If Not f Is Nothing Then\n        With f.Offset(0, 1)\n            .Value = .Value + 1\n        End With\n    Else\n        Set f = rngCodes.Cells(rngCodes.Cells.Count).End(xlUp).Offset(1, 0)\n        f.Value = val\n        f.Offset(0, 1).Value = 1\n    End If\n\n    Application.EnableEvents = False\n    Target.Value = \"\"\n    Application.EnableEvents = True\n\n    Target.Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "validation", "excel"], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 2865640, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/CBEbx.jpg?s=128&g=1", "display_name": "Deepak Uniyal", "link": "https://stackoverflow.com/users/2865640/deepak-uniyal"}, "edited": false, "score": 0, "creation_date": 1434516675, "post_id": 30882487, "comment_id": 49805758, "body": "I have assigned the range already here  <code>Set RangeToCheck = ActiveSheet.Range(Cells(2, 1), Cells(3, 10))</code> and also changed the <code>rngRangeToCheck</code> to <code>RangeToCheck</code> but I am still getting the error. As you said I need to select the range first so is it not the way to select range?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 89, "user_id": 2865640, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/CBEbx.jpg?s=128&g=1", "display_name": "Deepak Uniyal", "link": "https://stackoverflow.com/users/2865640/deepak-uniyal"}, "edited": false, "score": 1, "creation_date": 1434517006, "post_id": 30882487, "comment_id": 49805851, "body": "@DeepakUniyal - Yes. You can&#39;t use the return value of .Select for a With clause."}, {"owner": {"reputation": 89, "user_id": 2865640, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/CBEbx.jpg?s=128&g=1", "display_name": "Deepak Uniyal", "link": "https://stackoverflow.com/users/2865640/deepak-uniyal"}, "edited": false, "score": 0, "creation_date": 1434517159, "post_id": 30882487, "comment_id": 49805900, "body": "Ok Thanks. Now I am doing it as you told <code>RangeToCheck.Select With Selection.Validation     &#39;Do stuff     &#39;... End With</code> But issue is not solved yet :("}, {"owner": {"reputation": 89, "user_id": 2865640, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/CBEbx.jpg?s=128&g=1", "display_name": "Deepak Uniyal", "link": "https://stackoverflow.com/users/2865640/deepak-uniyal"}, "edited": false, "score": 0, "creation_date": 1434517335, "post_id": 30882487, "comment_id": 49805948, "body": "Am I doing it correct? <code>ActiveSheet.Range(Cells(out, 2), Cells(out, x)).Name = &quot;SomeNamedRange&quot;</code>  <b>And</b> <code>Set RangeToCheck = ActiveSheet.Range(Cells(2, 1), Cells(3, 10))</code> <b>And</b> <code>Set choice = &quot;=SomeNamedRange&quot;</code>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1434527146, "post_id": 30882487, "comment_id": 49810649, "body": "As you were already told, remove the <code>Set</code> from <code>Set choice = &quot;=SomeNamedRange&quot;</code>"}, {"owner": {"reputation": 89, "user_id": 2865640, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/CBEbx.jpg?s=128&g=1", "display_name": "Deepak Uniyal", "link": "https://stackoverflow.com/users/2865640/deepak-uniyal"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1434533460, "post_id": 30882487, "comment_id": 49814882, "body": "@Rory Thanks . Now I have issue regarding use of <code>=SomeNamedRange</code> as it is permanently set and is changing all the validations to same as the last one. So how to change formula dynamically for different rows is still a problem for me."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1434534005, "post_id": 30882487, "comment_id": 49815302, "body": "Assign <code>ActiveSheet.Range(Cells(out, 2), Cells(out, x)).Address</code> to the validation instead of using named ranges"}, {"owner": {"reputation": 89, "user_id": 2865640, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/CBEbx.jpg?s=128&g=1", "display_name": "Deepak Uniyal", "link": "https://stackoverflow.com/users/2865640/deepak-uniyal"}, "edited": false, "score": 0, "creation_date": 1434535021, "post_id": 30882487, "comment_id": 49816059, "body": "@Comintern Can you please update your answer as per discussion in the comments so that I can accept it."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 1, "last_activity_date": 1434516644, "last_edit_date": 1434516644, "creation_date": 1434516280, "answer_id": 30882487, "question_id": 30882078, "link": "https://stackoverflow.com/questions/30882078/creating-dynamic-validation-list-using-vba-object-required/30882487#30882487", "title": "Creating Dynamic validation list using VBA: Object Required", "body": "<p>You get an error because you're trying to use the return value of .Select as an Object.  You also don't have a variable declared for <code>rngRangeToCheck</code>, and as such it isn't set to anything.  You need to either select the Range first and use the Selection object or just use the Range directly:</p>\n\n<pre><code>With RangeToCheck.Validation\n    'Do stuff\n    '...\nEnd With   \n'Or\nRangeToCheck.Select\nWith Selection.Validation\n    'Do stuff\n    '...\nEnd With\n</code></pre>\n\n<p>The second issue is with these lines:</p>\n\n<pre><code>Dim choice\nSet choice = \"=SomeNamedRange\"\n</code></pre>\n\n<p>You're implicitly declaring 'choice' as a Variant, but you're assigning a String to it using Object syntax.  It should be:</p>\n\n<pre><code>Dim choice As String\nchoice = \"=SomeNamedRange\"\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 2865640, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/CBEbx.jpg?s=128&g=1", "display_name": "Deepak Uniyal", "link": "https://stackoverflow.com/users/2865640/deepak-uniyal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 953, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1434552810, "creation_date": 1434513457, "last_edit_date": 1434552810, "question_id": 30882078, "link": "https://stackoverflow.com/questions/30882078/creating-dynamic-validation-list-using-vba-object-required", "title": "Creating Dynamic validation list using VBA: Object Required", "body": "<p>I want to create data validation via VBA for dynamic numbers of rows whereas each row is containing dynamic number of columns.\nI passed the variable <code>out</code> which indicates the row number on which I want to set a data validation, <code>x</code> is the last column up to which I need to check for validation i.e. I will always start with cell(out, 2) and formula will extend up to (out,x).\nI tried the following code but it's giving me object required error.\nI think I am making some mistake in <code>Formula</code> and <code>SomeNamedRange</code> sections of the code.\nWhat changes should I make in the code and where I am thinking wrong?</p>\n\n<pre><code>Sub DataValidation(out As Integer, x As Integer, y As Integer)\nSheets(\"first_sheet\").Select                          \nActiveSheet.Range(Cells(out, 2), Cells(out, x)).Name = \"SomeNamedRange\"\nDim RangeToCheck As Excel.Range\nSet RangeToCheck = ActiveSheet.Range(Cells(2, 1), Cells(3, 10))\nDim choice\nSet choice = \"=SomeNamedRange\"\nWith rngRangeToCheck.Select\n    Selection.Validation\n    .Delete\n    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n    xlBetween, Formula1:=choice\n    .IgnoreBlank = True\n    .InCellDropdown = True\n    .InputTitle = \"\"\n    .ErrorTitle = \"\"\n    .InputMessage = \"\"\n    .ErrorMessage = \"\"\n    .ShowInput = True\n    .ShowError = True\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Also see the attached picture (Data validation should need be added to the yellow portion).<img src=\"https://i.stack.imgur.com/7PcgR.png\" alt=\"enter image description here\"></p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I have made some changes to code as suggested in comments but I am still getting the same error in <code>Set choice = \"=SomeNamedRange\"</code></p>\n\n<p>Changed Code is as follows:</p>\n\n<pre><code>Sub DataValidation(out As Integer, x As Integer, y As Integer)\nSheets(\"first_sheet\").Select                            \nActiveSheet.Range(Cells(out, 2), Cells(out, x)).Name = \"SomeNamedRange\"\nDim RangeToCheck As Excel.Range\nSet RangeToCheck = ActiveSheet.Range(Cells(out, 2), Cells(out, x))\nDim choice As String\nSet choice = \"=SomeNamedRange\"\n'y is the column number where I want validation i.e. yellow column in picture\nWith RangeToCheck.Cells(out, y).Validation\n    .Delete\n    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n    xlBetween, Formula1:=choice\n    .IgnoreBlank = True\n    .InCellDropdown = True\n    .InputTitle = \"\"\n    .ErrorTitle = \"\"\n    .InputMessage = \"\"\n    .ErrorMessage = \"\"\n    .ShowInput = True\n    .ShowError = True\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["performance", "vba", "button", "click", "userform"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1434513367, "post_id": 30881945, "comment_id": 49804806, "body": "How many items are in the Dictionary? What is a <code>cQID</code>? Is there substantial code in any of the methods you call on QID?"}, {"owner": {"reputation": 25, "user_id": 3696786, "user_type": "registered", "profile_image": "https://graph.facebook.com/74300384/picture?type=large", "display_name": "Zaimor", "link": "https://stackoverflow.com/users/3696786/zaimor"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1434603863, "post_id": 30881945, "comment_id": 49851640, "body": "cQID is a custom class with a half dozen members, very simple. There are ~150 of them in the dictionary. Your comment supports what Margus said below about Excel taking time to grab the object; am I just expecting too much from Excel? I noticed the same behavior on a similar form with a similar class but only about 20 items in the dictionary."}], "answers": [{"tags": [], "owner": {"reputation": 18262, "user_id": 97754, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/49d678618a22b1ae47b4395554eea6a9?s=128&d=identicon&r=PG", "display_name": "Margus", "link": "https://stackoverflow.com/users/97754/margus"}, "is_accepted": true, "score": 0, "last_activity_date": 1434527323, "creation_date": 1434527323, "answer_id": 30885393, "question_id": 30881945, "link": "https://stackoverflow.com/questions/30881945/excel-userform-button-click-slow-response-time-when-clicked-fast/30885393#30885393", "title": "Excel UserForm button click slow response time when clicked fast", "body": "<p>Personally I would just disable to button while content is loaded.</p>\n\n<pre><code>Private Sub bNext_Click()\n  Dim b1 As Button\n  Set b1 = ActiveSheet.Buttons(\"LoadQID\")\n  REM or Me.LoadQID\n\n  b1.Font.ColorIndex = 15\n  b1.Enabled = False\n  Application.Cursor = xlWait\n\n  Call LoadQID(CLng(lIndex.Caption) + 1)\n\n  b1.Enabled = True\n  b1.Font.ColorIndex = 1\n  Application.Cursor = xlDefault\nEnd Sub\n</code></pre>\n\n<p>Reason why this happens is that accessing a single object takes quite a bit of time in Excel. This way if you can click it will be registered.</p>\n\n<p>Alternatively you can toggle UI update with:</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.ScreenUpdating = True\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 15455960, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/82b097a9e9bdf0c3d873c1ec186f9d35?s=128&d=identicon&r=PG", "display_name": "siebren beens", "link": "https://stackoverflow.com/users/15455960/siebren-beens"}, "is_accepted": false, "score": 0, "last_activity_date": 1616450218, "creation_date": 1616450218, "answer_id": 66754382, "question_id": 30881945, "link": "https://stackoverflow.com/questions/30881945/excel-userform-button-click-slow-response-time-when-clicked-fast/66754382#66754382", "title": "Excel UserForm button click slow response time when clicked fast", "body": "<p>windows is checking for a doubleclick. so if you click fast it registers a doubleclick.</p>\n<p>2 options. increase you doubleclick speed in the windows mouse settings\nor make a doubleclick event</p>\n"}], "owner": {"reputation": 25, "user_id": 3696786, "user_type": "registered", "profile_image": "https://graph.facebook.com/74300384/picture?type=large", "display_name": "Zaimor", "link": "https://stackoverflow.com/users/3696786/zaimor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1341, "favorite_count": 0, "accepted_answer_id": 30885393, "answer_count": 2, "score": 0, "last_activity_date": 1616450218, "creation_date": 1434512441, "question_id": 30881945, "link": "https://stackoverflow.com/questions/30881945/excel-userform-button-click-slow-response-time-when-clicked-fast", "title": "Excel UserForm button click slow response time when clicked fast", "body": "<p>I have a VBA UserForm in Excel, with very simple code. It displays a collection (a dictionary, actually) of objects, one at a time, with buttons for \"first, previous, next, and last\". Everything works great, but if I were to continually click the next button to go through the items, I have to click it slowly (roughly once a second). If I click any faster, the click is ignored. For example, if I click four times over two seconds, it will only 'register' the first and third click and advance twice, instead of four times.</p>\n\n<p>Below is example code for the 'next' button (and the other applicable pieces of code in the userform module):</p>\n\n<pre><code>Private dQIDs As Dictionary\n\nPublic Sub TransferQIDs(ByVal dIncomingQIDs As Dictionary)\n    Set dQIDs = dIncomingQIDs\nEnd Sub\n\nPrivate Sub bNext_Click()\n    Call LoadQID(CLng(lIndex.Caption) + 1)\nEnd Sub\n\nPrivate Sub LoadQID(lQID As Long)\n    Dim QID As cQID\n    Set QID = dQIDs(lQID)\n    lIndex.Caption = lQID\n    lItems.Caption = \"Viewing new QID \" &amp; lQID &amp; \" of \" &amp; dQIDs.Count\n    Me.tQID = QID.lQID\n    Me.tTitle = QID.sTitle\n    Me.tVID = QID.sVendorID\n    Me.bOS = QID.bOSPatch\n    Me.bApp = Not QID.bOSPatch\n    Me.bPrev.Enabled = Not (lQID = 1)\n    Me.bFirst.Enabled = Not (lQID = 1)\n    Me.bNext.Enabled = Not (lQID = dQIDs.Count)\n    Me.bLast.Enabled = Not (lQID = dQIDs.Count)\nEnd Sub\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "excel", "blank-line"], "comments": [{"owner": {"reputation": 140, "user_id": 4519177, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JlXTy.jpg?s=128&g=1", "display_name": "Monkawee Maneewalaya", "link": "https://stackoverflow.com/users/4519177/monkawee-maneewalaya"}, "edited": false, "score": 0, "creation_date": 1434514758, "post_id": 30881576, "comment_id": 49805185, "body": "I have some question. When do you want to automatic add row? Like click button, Change value in first column or other."}, {"owner": {"reputation": 11, "user_id": 4630207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53c226dc7e6b31eea17c335dc3ce3ab7?s=128&d=identicon&r=PG&f=1", "display_name": "Do Huynh Anh Quan", "link": "https://stackoverflow.com/users/4630207/do-huynh-anh-quan"}, "reply_to_user": {"reputation": 140, "user_id": 4519177, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JlXTy.jpg?s=128&g=1", "display_name": "Monkawee Maneewalaya", "link": "https://stackoverflow.com/users/4519177/monkawee-maneewalaya"}, "edited": false, "score": 0, "creation_date": 1434515745, "post_id": 30881576, "comment_id": 49805468, "body": "I have a sheet and I want to automatic inserting once time - when I click button."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4630207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53c226dc7e6b31eea17c335dc3ce3ab7?s=128&d=identicon&r=PG&f=1", "display_name": "Do Huynh Anh Quan", "link": "https://stackoverflow.com/users/4630207/do-huynh-anh-quan"}, "edited": false, "score": 0, "creation_date": 1434511574, "post_id": 30881740, "comment_id": 49804369, "body": "Can you describe more detail how to do?"}], "tags": [], "owner": {"reputation": 140, "user_id": 4519177, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JlXTy.jpg?s=128&g=1", "display_name": "Monkawee Maneewalaya", "link": "https://stackoverflow.com/users/4519177/monkawee-maneewalaya"}, "is_accepted": false, "score": 0, "last_activity_date": 1434511012, "creation_date": 1434511012, "answer_id": 30881740, "question_id": 30881576, "link": "https://stackoverflow.com/questions/30881576/how-to-automatic-insert-blank-rows-depend-on-1-column/30881740#30881740", "title": "How to automatic insert blank rows depend on 1 column?", "body": "<p>You can add 1 index column as primary key. Then insert only index column and your PK with all blank fields.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 4630207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53c226dc7e6b31eea17c335dc3ce3ab7?s=128&d=identicon&r=PG&f=1", "display_name": "Do Huynh Anh Quan", "link": "https://stackoverflow.com/users/4630207/do-huynh-anh-quan"}, "edited": false, "score": 0, "creation_date": 1434593558, "post_id": 30900072, "comment_id": 49849109, "body": "It works, but doesn&#39;t exactly what I need. It insert blank rows but not 1 row, then is 1 or 2 or 3 or 4 or ... rows :D"}, {"owner": {"reputation": 11, "user_id": 4630207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53c226dc7e6b31eea17c335dc3ce3ab7?s=128&d=identicon&r=PG&f=1", "display_name": "Do Huynh Anh Quan", "link": "https://stackoverflow.com/users/4630207/do-huynh-anh-quan"}, "edited": false, "score": 0, "creation_date": 1434594918, "post_id": 30900072, "comment_id": 49849430, "body": "Here is the result after run your macro <a href=\"http://i.imgur.com/WbUxU24.png\" rel=\"nofollow noreferrer\">link</a> @omar"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1434567677, "last_edit_date": 1434567677, "creation_date": 1434567292, "answer_id": 30900072, "question_id": 30881576, "link": "https://stackoverflow.com/questions/30881576/how-to-automatic-insert-blank-rows-depend-on-1-column/30900072#30900072", "title": "How to automatic insert blank rows depend on 1 column?", "body": "<p>Create button and assign to the following macro</p>\n\n<pre><code>Sub BRow()\n    Dim WorkRng As Range\n    Dim FirstRow As Integer\n    Dim lngRows As Integer\n    Dim lngCols As Integer\n\n    Set WorkRng = Application.Selection\n    Set WorkRng = Application.InputBox(\"Select Range\", WorkRng.Address, Type:=8)\n    FirstRow = WorkRng.Row\n    lngRows = WorkRng.Rows.Count\n    lngCols = WorkRng.Columns.Count\n    WorkRng.Cells(lngRows, 1).Resize(1, lngCols).Select\n\n    Do Until Selection.Row = FirstRow\n        Selection.Insert shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n        Selection.Offset(-1, 0).Select\n    Loop\nEnd Sub\n</code></pre>\n\n<p>See Examples <a href=\"https://support.microsoft.com/en-us/kb/291305\" rel=\"nofollow\">here</a></p>\n"}], "owner": {"reputation": 11, "user_id": 4630207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53c226dc7e6b31eea17c335dc3ce3ab7?s=128&d=identicon&r=PG&f=1", "display_name": "Do Huynh Anh Quan", "link": "https://stackoverflow.com/users/4630207/do-huynh-anh-quan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1434567677, "creation_date": 1434509951, "last_edit_date": 1531164843, "question_id": 30881576, "link": "https://stackoverflow.com/questions/30881576/how-to-automatic-insert-blank-rows-depend-on-1-column", "title": "How to automatic insert blank rows depend on 1 column?", "body": "<p>I have table same there </p>\n\n<p><img src=\"https://i.stack.imgur.com/Pzou5.png\" alt=\"enter image description here\"></p>\n\n<p>and I want automatic insert blank rows depend on the cell in first column, \n<img src=\"https://i.stack.imgur.com/QPJOn.png\" alt=\"enter image description here\"></p>\n\n<p>Anyone can help me? I tried many methods but none of it does exactly I need. \nSorry for my English.</p>\n"}, {"tags": ["vba", "excel", "conditional-formatting"], "comments": [{"owner": {"reputation": 325, "user_id": 5008116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4daf0c71a9d2cd598e7025bb911b90c3?s=128&d=identicon&r=PG&f=1", "display_name": "gudal", "link": "https://stackoverflow.com/users/5008116/gudal"}, "edited": false, "score": 0, "creation_date": 1434531159, "post_id": 30881557, "comment_id": 49813225, "body": "Have you tried regular conditional formatting (non-vba) using data validation dropdowns, or would that not achieve your desired result. As far as I can understand, it would (if yes I can post solution)"}, {"owner": {"reputation": 9, "user_id": 5017751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bc58b06a5b691c37c374d71b9e345e8?s=128&d=identicon&r=PG&f=1", "display_name": "kanda", "link": "https://stackoverflow.com/users/5017751/kanda"}, "reply_to_user": {"reputation": 325, "user_id": 5008116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4daf0c71a9d2cd598e7025bb911b90c3?s=128&d=identicon&r=PG&f=1", "display_name": "gudal", "link": "https://stackoverflow.com/users/5008116/gudal"}, "edited": false, "score": 0, "creation_date": 1434592935, "post_id": 30881557, "comment_id": 49848947, "body": "sorry I haven&#39;t tried to explore data val. I&#39;m a huge excel noob"}, {"owner": {"reputation": 325, "user_id": 5008116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4daf0c71a9d2cd598e7025bb911b90c3?s=128&d=identicon&r=PG&f=1", "display_name": "gudal", "link": "https://stackoverflow.com/users/5008116/gudal"}, "edited": false, "score": 0, "creation_date": 1434607198, "post_id": 30881557, "comment_id": 49852943, "body": "I will give a crack at a solution if you van verify my understanding of your problem:  You have &quot;major&quot; columns, daily, monthly and annual tasks. Each is 3 columns wide, with headings type, frequency and description. You want to have ONE dropdown (or one per major column/group??) with all task types (are these predefined in some list somewhere?) and when selected, it shall highlight the type, frequency and description of all tasks with that type. Correct?  And, are these groups in A:C, D:F and G:I on the same sheet?"}, {"owner": {"reputation": 9, "user_id": 5017751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bc58b06a5b691c37c374d71b9e345e8?s=128&d=identicon&r=PG&f=1", "display_name": "kanda", "link": "https://stackoverflow.com/users/5017751/kanda"}, "reply_to_user": {"reputation": 325, "user_id": 5008116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4daf0c71a9d2cd598e7025bb911b90c3?s=128&d=identicon&r=PG&f=1", "display_name": "gudal", "link": "https://stackoverflow.com/users/5008116/gudal"}, "edited": false, "score": 0, "creation_date": 1434607733, "post_id": 30881557, "comment_id": 49853216, "body": "it looks like this my friend <a href=\"http://i.imgur.com/ihmkYbC.png\" rel=\"nofollow noreferrer\">i.imgur.com/ihmkYbC.png</a>"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 5017751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bc58b06a5b691c37c374d71b9e345e8?s=128&d=identicon&r=PG&f=1", "display_name": "kanda", "link": "https://stackoverflow.com/users/5017751/kanda"}, "edited": false, "score": 0, "creation_date": 1434593652, "post_id": 30886134, "comment_id": 49849129, "body": "hey this seems good but there is a problem and that problem is that the cells are already coloured slightly-- some of them have different background colours and even so it doesnt seem like this is picking up the cells that have been highlighted programmatically as being different-- it shows their original colour code"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1434529566, "creation_date": 1434529566, "answer_id": 30886134, "question_id": 30881557, "link": "https://stackoverflow.com/questions/30881557/apply-conditional-formatting-to-adjacent-cells/30886134#30886134", "title": "Apply Conditional Formatting to Adjacent Cells?", "body": "<p>I would suggesst something like this :</p>\n\n<ol>\n<li>Apply your conditional formatting as in your code</li>\n<li>Then loop in the range to detect Highlighted and highlight the 2\nother horizontaly adjacent cells and pass them in italic to avoid\nconsidering them as highlighted by the conditional formating</li>\n<li>Repass the whole range in not italic</li>\n</ol>\n\n<p>Here is the code :</p>\n\n<pre><code>For Each rCell In rng.Cells\n    With rCell\n        If .Interior.Color &lt;&gt; RGB(255, 0, 0) Or .Font.Italic &lt;&gt; False Then\n        Else\n            Range(rCell.Offset(, -1), rCell.Offset(, 1)).Interior.Color = RGB(255, 0, 0)\n            Range(rCell.Offset(, -1), rCell.Offset(, 1)).Font.Bold = True\n            Range(rCell.Offset(, -1), rCell.Offset(, 1)).Font.Italic = True\n        End If\n    End With\nNext rCell\nrng.Font.Italic = False\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 325, "user_id": 5008116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4daf0c71a9d2cd598e7025bb911b90c3?s=128&d=identicon&r=PG&f=1", "display_name": "gudal", "link": "https://stackoverflow.com/users/5008116/gudal"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1436115516, "post_id": 30917490, "comment_id": 50464221, "body": "It IS dealth with using data validation. Just like using named ranges instead of references or writing directly in the data val field."}], "tags": [], "owner": {"reputation": 325, "user_id": 5008116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4daf0c71a9d2cd598e7025bb911b90c3?s=128&d=identicon&r=PG&f=1", "display_name": "gudal", "link": "https://stackoverflow.com/users/5008116/gudal"}, "is_accepted": false, "score": 1, "last_activity_date": 1434635951, "creation_date": 1434635951, "answer_id": 30917490, "question_id": 30881557, "link": "https://stackoverflow.com/questions/30881557/apply-conditional-formatting-to-adjacent-cells/30917490#30917490", "title": "Apply Conditional Formatting to Adjacent Cells?", "body": "<p>Ok, as I stated in the comments, by suggestion is to drop macros all together. Sorry if this text feels condescending, but taking your statement of \"huge noob\", I thought it best to assume you know nothing. Do the following</p>\n\n<p>NOTE! Whenever I put something in brackets and say \"write this\", do not include the prackets.</p>\n\n<p>Some place, for instance where you have your listbox now, enter all the task types you have or could have. Select all of them, and name that range \"taskTypes\"</p>\n\n<p>Then, find a cell where you want to have your \"button\". Give it a nice color, then go to Data tab, select Data validation, and in the \"Allow\" drop down, select \"List\". Then, a new text box labeled \"Source\" will appear. Enter \"=taskTypes\" there.</p>\n\n<p>Name this cell \"taskSelectorCell\". This cell will become a drop down list (need to hover over it for the drop down arrow to appear, hence the nice color to see where it is)</p>\n\n<p>Then select the top left cell in your \"Daily tasks\" table, and create a new conditional formatting rule (Home tab). Select \"Use a formula to determine which cells to format\". Now, my top left cell in \"Daily tasks\" was E2, so my conditional formatting formula became:</p>\n\n<pre><code>=$E2=taskSelectorCell\n</code></pre>\n\n<p>Then select a format format. I chose red background, as you did. Now, this will allow that cell (E2) to become red whenever the taskSelectorCell changes. </p>\n\n<p>To do the final piece, select E2, Press Conditional Formatting and \"Manage Rules\". The rule you created will be there. In the boc labeled \"Applies to\", select the daily tasks table and the weekly tasks table (all in one selection), and apply. Now, whenever you select something in the taskSelectorCell dropdown, all taks in those two tables will be marked red, type, frequency and description.</p>\n\n<p>Since you have your groups side by side, we cannot use one formula for all the tables (unless we play with the offset function, but let's not do that if you are a huge excel noob. Therefore, you need to repeat the process twice. Once for the monthly tasks, and once for the \"as required\" tasks.</p>\n"}], "owner": {"reputation": 9, "user_id": 5017751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bc58b06a5b691c37c374d71b9e345e8?s=128&d=identicon&r=PG&f=1", "display_name": "kanda", "link": "https://stackoverflow.com/users/5017751/kanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1434635951, "creation_date": 1434509839, "last_edit_date": 1434519141, "question_id": 30881557, "link": "https://stackoverflow.com/questions/30881557/apply-conditional-formatting-to-adjacent-cells", "title": "Apply Conditional Formatting to Adjacent Cells?", "body": "<p>I have some text data I want to search through and highlight.</p>\n\n<p>It is daily / monthly / annual tasks organized (and seperated as groups) by frequency... so I have a seperate box for the daily, weekly, etc. </p>\n\n<p>There are 3 columns for each group... \"Type\", \"Frequency\" and \"Description\".</p>\n\n<p>I have a <code>Listbox</code> that has all the Types of tasks in it, and when you select one and press on a button, it highlights all the tasks that correspond to that...</p>\n\n<p>So far the only way I have been able to do this is through VBA conditional formatting.</p>\n\n<p>But it only highlights the type of task and I haven't been able to figure out how to make it ALSO highlight the two columns next to it...</p>\n\n<p>I was exploring how to do that with a search but could not implement it correctly.</p>\n\n<p>here is my code</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim typeSelection As String\n    Dim rng As Range\n    Set rng = Sheet4.Range(\"$E$3:$O$23\")\n    typeSelection = ListBox1.Text\n    Debug.Print rng.Address\n    With rng\n        .FormatConditions.Delete\n        .FormatConditions.Add Type:=xlTextString, String:=typeSelection, _\n            TextOperator:=xlBeginsWith\n        .FormatConditions(1).Interior.Color = RGB(255, 0, 0)\n        .FormatConditions(1).Font.Bold = True\n        'Debug.Print .FormatConditions(1).AppliesTo.Address\n        '.FormatConditions(1).ModifyAppliesToRange .FormatConditions(1).AppliesTo.Offset(RowOffSet:=0, ColumnOffset:=2)\n        '.FormatConditions(1).Interior.Color = RGB(255, 0, 0)\n        '.FormatConditions(1).Font.Bold = True\n        'Debug.Print .FormatConditions(1).AppliesTo.Address\n    End With\n    Dim rCell As Range\n    Dim cRng As Range\n    For Each rCell In rng.Cells\n        Set cRng = rCell\n        Debug.Print rCell.Address\n        isConditionallyFormatted (rCell)\n    Next rCell\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 211, "user_id": 4732066, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/b47089dda96910f8853e6018b4bee81b?s=128&d=identicon&r=PG&f=1", "display_name": "crimson", "link": "https://stackoverflow.com/users/4732066/crimson"}, "edited": false, "score": 0, "creation_date": 1434513177, "post_id": 30881897, "comment_id": 49804753, "body": "I actually have an update query that is working just fine before the insert so i&#39;m sure the connection is ok. But i&#39;m not using parameters for the update query. It&#39;s a simple <code>sqlStr = &quot;Update Table set ColumnA = &#39;&quot; &amp; Cells(i,1).Value &amp; &quot;&#39;&quot;</code> <code>cnn.Execute(sqlStr)</code>"}, {"owner": {"reputation": 1205, "user_id": 4667934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hk11W.jpg?s=128&g=1", "display_name": "LinkBerest", "link": "https://stackoverflow.com/users/4667934/linkberest"}, "reply_to_user": {"reputation": 211, "user_id": 4732066, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/b47089dda96910f8853e6018b4bee81b?s=128&d=identicon&r=PG&f=1", "display_name": "crimson", "link": "https://stackoverflow.com/users/4732066/crimson"}, "edited": false, "score": 0, "creation_date": 1434516614, "post_id": 30881897, "comment_id": 49805732, "body": "@crimson First, <i>insert</i> is a different permission than <i>update</i> so I&#39;d recommend testing both. Cannot get to computer to update this right now, only suggestion would be to remove the <code>ccmd</code> call and just use a direct call to <code>ccn</code> or use <a href=\"http://stackoverflow.com/questions/4806409/creating-parameterized-sql-queries-in-excel-2010-with-vba?rq=1\">ccmd <i>with</i></a>"}], "tags": [], "owner": {"reputation": 1205, "user_id": 4667934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hk11W.jpg?s=128&g=1", "display_name": "LinkBerest", "link": "https://stackoverflow.com/users/4667934/linkberest"}, "is_accepted": false, "score": 0, "last_activity_date": 1434512125, "last_edit_date": 1495542598, "creation_date": 1434512125, "answer_id": 30881897, "question_id": 30881535, "link": "https://stackoverflow.com/questions/30881535/executing-a-parameterized-insert-query-in-vba-excel/30881897#30881897", "title": "Executing a parameterized insert query in vba excel", "body": "<p>There are a few ways to include Ranges in an insert but are you sure your getting a good connection? You can check with the following code (see the If after the Open) as <em>Automation Error</em> is a fairly general error and can include several different possible problems (a user not having correct permissions is common). </p>\n\n<p>If this works the next step would be to either update your question or comment with the new problems and you can get help on the various ways to add cell ranges to Oracle. Also, <strong>MSDAORA</strong> is depreciated, see <a href=\"https://stackoverflow.com/questions/18835640/updating-oracle-table-from-excel-vba-macro-using-odbc-connection\">the accepted answer here</a> for more information on that.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>' Works on one of my test systems\nDim SQLString As String\nstr = \"Provider=MSDAORA;Data Source=db;Persist Security Info=True;Password=pword;User ID=uname\"\n\nSet cnn = New ADODB.Connection\ncnn.ConnectionString = str\ncnn.ConnectionTimeout = 90\n' Set the connection string directly and set timeout rather than open so\n' We can check if connect worked.\n\ncnn.Open\nIf cnn.State = adStateOpen Then\n   MsgBox \"Connected\"\nElse\n   MsgBox \"Sorry. Connection Failed\"\n   Exit Sub\nEnd If\n\n' Then I'd try a simple insert command and see if that works (to target error)\n' If this works then the error is likely how the insert is created\nSqlString = \"Insert into table Values('Something Silly')\"\ncnn.Execute SqlString, ,adCmdText ' As this is a direct SQL you shouldn't need adCmdText but will later\n\ncnn.Close\n</code></pre>\n"}], "owner": {"reputation": 211, "user_id": 4732066, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/b47089dda96910f8853e6018b4bee81b?s=128&d=identicon&r=PG&f=1", "display_name": "crimson", "link": "https://stackoverflow.com/users/4732066/crimson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1682, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1434512125, "creation_date": 1434509581, "last_edit_date": 1434510887, "question_id": 30881535, "link": "https://stackoverflow.com/questions/30881535/executing-a-parameterized-insert-query-in-vba-excel", "title": "Executing a parameterized insert query in vba excel", "body": "<p>Kind of new to this, I'm trying to execute an insert query(to an oracle database) with parameterized query in vba excel</p>\n\n<pre><code>Dim cnn As ADODB.Connection\nDim rs As ADODB.Recordset\nDim ccmd As New ADODB.Command\n\nstr = \"Provider=MSDAORA;Data Source=db;Persist Security Info=True;Password=pword;User ID=uname\"\nSet cnn = CreateObject(\"ADODB.Connection\")\ncnn.Open str\nSet rs = CreateObject(\"ADODB.Recordset\")\n\nccmd.ActiveConnection = cnn\nccmd.CommandText = \"Insert into Table Values(@col1,@col5,@col8,@col6,@col7,@col2,@col3,@col4)\"\nccmd.CommandType = adCmdText\n\nccmd.Parameters.Append ccmd.CreateParameter(\"@col1\", adVarChar, adParamInput, 50, Cells(i, 1).Value)\nccmd.Parameters.Append ccmd.CreateParameter(\"@col5\", adVarChar, adParamInput, 50, Cells(i, 5).Value)\nccmd.Parameters.Append ccmd.CreateParameter(\"@col8\", adVarChar, adParamInput, 50, Cells(i, 8).Value)\nccmd.Parameters.Append ccmd.CreateParameter(\"@col6\", adVarChar, adParamInput, 50, Cells(i, 6).Value)\nccmd.Parameters.Append ccmd.CreateParameter(\"@col7\", adVarChar, adParamInput, 50, Cells(i, 7).Value)\nccmd.Parameters.Append ccmd.CreateParameter(\"@col2\", adVarChar, adParamInput, 50, Cells(i, 2).Value)\nccmd.Parameters.Append ccmd.CreateParameter(\"@col3\", adVarChar, adParamInput, 50, Cells(i, 3).Value)\nccmd.Parameters.Append ccmd.CreateParameter(\"@col4\", adVarChar, adParamInput, 50, Cells(i, 4).Value)\n\n'execute the command here,  im having an error here. I'm not sure how to execute the command. I'm also not sure whether the error i'm getting is caused by how im executing the command or something else.\n\n'I've tried:\n'ccmd.Execute\n'cnn.Execute(ccmd.CommandText)   \n'rs = ccmd.execute\n</code></pre>\n\n<blockquote>\n  <p>Automation Error</p>\n</blockquote>\n\n<p>is what i'm getting</p>\n\n<p>Edit:</p>\n\n<p>Tried changing my query to <code>Insert into Table Values(?,?,?,?,?,?,?,?)</code> and i still get automation error. Also tried removing the '@' char in my parameter names and tried using ':' or '?'.</p>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 7770, "user_id": 2252572, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/5Sv5r.png?s=128&g=1", "display_name": "Bacteria", "link": "https://stackoverflow.com/users/2252572/bacteria"}, "edited": false, "score": 1, "creation_date": 1434504476, "post_id": 30880873, "comment_id": 49802700, "body": "Unlike forum sites, we don&#39;t use &quot;Thanks&quot;, or &quot;Any help appreciated&quot;, or signatures on Stack Overflow.  For more details see <a href=\"http://meta.stackexchange.com/questions/2950/should-hi-thanks-taglines-and-salutations-be-removed-from-posts\">Should &#39;Hi&#39;, &#39;thanks,&#39; taglines, and salutations be removed from posts?</a>"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1434508285, "post_id": 30880873, "comment_id": 49803605, "body": "Why <code>Do Until IsEmpty(Sheets(&quot;40&quot;).Range(&quot;F11&quot;).Value)</code>? You cannot just add a loop to recorded macro, since recorded macro uses absolute address, and you did nothing to move on to next row/column."}, {"owner": {"reputation": 1, "user_id": 5017558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae444394477de7311f23149950c233fb?s=128&d=identicon&r=PG&f=1", "display_name": "user5017558", "link": "https://stackoverflow.com/users/5017558/user5017558"}, "edited": false, "score": 0, "creation_date": 1434508740, "post_id": 30880873, "comment_id": 49803710, "body": "Since everytime I delete the row that I copy, I don&#39;t need to indicate the macro to move to the next row. As a matter of fact, the table will &quot;move up&quot; and the if condition will always be checked in the same cell (F11). From what I understood from my different trials, I think the macro checks the if condition only for the first loop and then it copies automatically the rest of the table into the same sheet."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5017558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae444394477de7311f23149950c233fb?s=128&d=identicon&r=PG&f=1", "display_name": "user5017558", "link": "https://stackoverflow.com/users/5017558/user5017558"}, "edited": false, "score": 0, "creation_date": 1434529079, "post_id": 30882365, "comment_id": 49811840, "body": "Thank you very much for the solution as well as the explanation. It works perfectly. I will also take into consideration your advice regarding the rationalization of the code."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 0, "last_activity_date": 1434515419, "creation_date": 1434515419, "answer_id": 30882365, "question_id": 30880873, "link": "https://stackoverflow.com/questions/30880873/if-instr-not-working-with-a-loop/30882365#30882365", "title": "&quot;if instr&quot; not working with a loop", "body": "<p>The (first) problem is that you never change the value of <code>celltxt</code> inside your loop. After you read <code>Sheets(\"40\").Range(\"P11\").Value</code> into the string, you never change it.  This means that <code>InStr(celltxt, \"CAVIAR\")</code> will always be the same until the Sub ends. All you should need to do is update it inside your loop.</p>\n\n<p>One other thing to do while you're at it is to apply a little <a href=\"https://en.wikipedia.org/wiki/Don%27t_repeat_yourself\" rel=\"nofollow\">DRY</a> and extract your common code into a function.  The only difference between your <code>If</code> and <code>Else</code> is the sheet name.  Try something like this:</p>\n\n<pre><code>Sub Search_and_copy()\n    Dim celltxt As String\n\n    Do Until IsEmpty(Sheets(\"40\").Range(\"F11\").Value)\n        celltxt = Sheets(\"40\").Range(\"P11\").Value\n        If Sheets(\"40\").Range(\"F11\").Value = \"254\" Then\n            If InStr(celltxt, \"CAVIAR\") Then\n                DontRepeatYourself \"Sheet1\"\n            Else\n                DontRepeatYourself \"Sheet2\"\n            End If\n        End If\n    Loop\n\nEnd Sub\n\nPrivate Sub DontRepeatYourself(sheet As String)\n    Dim rowNo As Long\n    rowNo = 6\n    Rows(\"11:11\").Select\n    Selection.Copy\n    Sheets(sheet).Select\n    Do Until IsEmpty(Cells(rowNo, 1))\n        rowNo = rowNo + 1\n    Loop\n\n    Sheets(sheet).Cells(rowNo, 1).Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, _\n                           SkipBlanks:=False, Transpose:=False\n    Sheets(\"40\").Select\n    Application.CutCopyMode = False\n    Selection.Delete Shift:=xlUp\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5017558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae444394477de7311f23149950c233fb?s=128&d=identicon&r=PG&f=1", "display_name": "user5017558", "link": "https://stackoverflow.com/users/5017558/user5017558"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 155, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1434515419, "creation_date": 1434504431, "last_edit_date": 1531164843, "question_id": 30880873, "link": "https://stackoverflow.com/questions/30880873/if-instr-not-working-with-a-loop", "title": "&quot;if instr&quot; not working with a loop", "body": "<p>I am a VBA beginner. I am trying to build a macro that would copy and paste (value) an entire row to a new sheet based on a differentiation criteria. The differentiation criteria, in this case, would be the content of specific cell. In other words, if the cell contains the word \"Caviar\" then copy the row into sheet 1 otherwise copy into sheet 2. The following macro works when I run it manually (row one by one).</p>\n\n<pre><code>Sub Search_and_copy()\nDim rng As String\nrng = Sheets(\"40\").Range(\"F11\").Value\nDim rowNo As Integer\nrowNo = 6\nDim celltxt As String\ncelltxt = Sheets(\"40\").Range(\"P11\").Value\n\n        rowNo = 6\n        If Sheets(\"40\").Range(\"F11\").Value = \"254\" Then\n                If InStr(celltxt, \"CAVIAR\") Then\n                    Rows(\"11:11\").Select\n                    Selection.Copy\n                    Sheets(\"Sheet1\").Select\n                    If IsEmpty(Cells(rowNo, 1)) Then\n                            Sheets(\"Sheet1\").Cells(rowNo, 1).Select\n                            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n                    Else:   Do Until IsEmpty(Cells(rowNo, 1))\n                                rowNo = rowNo + 1\n                            Loop\n                            Sheets(\"Sheet1\").Cells(rowNo, 1).Select\n                            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n                    End If\n                    Sheets(\"40\").Select\n                    Application.CutCopyMode = False\n                    Selection.Delete Shift:=xlUp\n                Else\n                    Rows(\"11:11\").Select\n                    Selection.Copy\n                    Sheets(\"Sheet2\").Select\n                    If IsEmpty(Cells(rowNo, 1)) Then\n                            Sheets(\"Sheet2\").Cells(rowNo, 1).Select\n                            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n                    Else:   Do Until IsEmpty(Cells(rowNo, 1))\n                                rowNo = rowNo + 1\n                            Loop\n                            Sheets(\"Sheet2\").Cells(rowNo, 1).Select\n                            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n                    End If\n                    Sheets(\"40\").Select\n                    Application.CutCopyMode = False\n                    Selection.Delete Shift:=xlUp\n\n                End If\n        End If\n\nEnd Sub\n</code></pre>\n\n<p>However, as soon as I introduce a loop (see code below), the differentiation is no longer properly made and all rows are copied into the same worksheet. What am I doing wrong?</p>\n\n<pre><code>Sub Search_and_copy()\nDim rng As String\nrng = Sheets(\"40\").Range(\"F11\").Value\nDim rowNo As Integer\nrowNo = 6\nDim celltxt As String\ncelltxt = Sheets(\"40\").Range(\"P11\").Value\n\n\n    Do Until IsEmpty(Sheets(\"40\").Range(\"F11\").Value)\n\n        rowNo = 6\n        If Sheets(\"40\").Range(\"F11\").Value = \"254\" Then\n                If InStr(celltxt, \"CAVIAR\") Then\n                    Rows(\"11:11\").Select\n                    Selection.Copy\n                    Sheets(\"Sheet1\").Select\n                    If IsEmpty(Cells(rowNo, 1)) Then\n                            Sheets(\"Sheet1\").Cells(rowNo, 1).Select\n                            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n                    Else:   Do Until IsEmpty(Cells(rowNo, 1))\n                                rowNo = rowNo + 1\n                            Loop\n                            Sheets(\"Sheet1\").Cells(rowNo, 1).Select\n                            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n                    End If\n                    Sheets(\"40\").Select\n                    Application.CutCopyMode = False\n                    Selection.Delete Shift:=xlUp\n                Else\n                    Rows(\"11:11\").Select\n                    Selection.Copy\n                    Sheets(\"Sheet2\").Select\n                    If IsEmpty(Cells(rowNo, 1)) Then\n                            Sheets(\"Sheet2\").Cells(rowNo, 1).Select\n                            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n                    Else:   Do Until IsEmpty(Cells(rowNo, 1))\n                                rowNo = rowNo + 1\n                            Loop\n                            Sheets(\"Sheet2\").Cells(rowNo, 1).Select\n                            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n                    End If\n                    Sheets(\"40\").Select\n                    Application.CutCopyMode = False\n                    Selection.Delete Shift:=xlUp\n\n                End If\n\n        End If\n\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 2874, "user_id": 788532, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zAfvI.jpg?s=128&g=1", "display_name": "danielmhanover", "link": "https://stackoverflow.com/users/788532/danielmhanover"}, "edited": false, "score": 1, "creation_date": 1434496759, "post_id": 30879726, "comment_id": 49800686, "body": "Well, for one thing you&#39;re parsing HTML with regular expressions."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1434510522, "post_id": 30879726, "comment_id": 49804125, "body": "See <a href=\"http://stackoverflow.com/a/1732454/4088852\">this answer.</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1372, "user_id": 2092236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f31bef5ce787bafd90b708edb563cf67?s=128&d=identicon&r=PG", "display_name": "JoaMika", "link": "https://stackoverflow.com/users/2092236/joamika"}, "edited": false, "score": 0, "creation_date": 1434496291, "post_id": 30879771, "comment_id": 49800534, "body": "there are a lot of other html lines that I didn&#39;t mention in the question.. I need to target this line specifically."}, {"owner": {"reputation": 1372, "user_id": 2092236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f31bef5ce787bafd90b708edb563cf67?s=128&d=identicon&r=PG", "display_name": "JoaMika", "link": "https://stackoverflow.com/users/2092236/joamika"}, "edited": false, "score": 0, "creation_date": 1434496691, "post_id": 30879771, "comment_id": 49800666, "body": "I am actually getting compile errors in Excel VBA. Somehow I need to exit the quotemarks in my Pattern ?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1434496858, "post_id": 30879771, "comment_id": 49800710, "body": "In VBA <code>&quot;</code> is escaped with <code>&quot;&quot;</code> (doubled-up quotes)"}], "tags": [], "owner": {"reputation": 18098, "user_id": 3744681, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/XvLrx.jpg?s=128&g=1", "display_name": "Jahid", "link": "https://stackoverflow.com/users/3744681/jahid"}, "is_accepted": true, "score": 1, "last_activity_date": 1434497352, "last_edit_date": 1434497352, "creation_date": 1434496217, "answer_id": 30879771, "question_id": 30879726, "link": "https://stackoverflow.com/questions/30879726/regular-expression-for-html/30879771#30879771", "title": "Regular Expression for HTML", "body": "<p>Escape double quotes inside regex: <code>\"</code> to <code>\"\"</code></p>\n"}, {"comments": [{"owner": {"reputation": 18098, "user_id": 3744681, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/XvLrx.jpg?s=128&g=1", "display_name": "Jahid", "link": "https://stackoverflow.com/users/3744681/jahid"}, "edited": false, "score": 0, "creation_date": 1434497483, "post_id": 30879868, "comment_id": 49800867, "body": "<code>\\S</code> matches anything that is not <code>\\s</code> and both of them combined matches anything at all"}], "tags": [], "owner": {"reputation": 1372, "user_id": 2092236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f31bef5ce787bafd90b708edb563cf67?s=128&d=identicon&r=PG", "display_name": "JoaMika", "link": "https://stackoverflow.com/users/2092236/joamika"}, "is_accepted": false, "score": 0, "last_activity_date": 1435243509, "last_edit_date": 1435243509, "creation_date": 1434496929, "answer_id": 30879868, "question_id": 30879726, "link": "https://stackoverflow.com/questions/30879726/regular-expression-for-html/30879868#30879868", "title": "Regular Expression for HTML", "body": "<p>ok thanks. Actually this works for me:</p>\n\n<pre><code>.Pattern = \"&lt;strong class=\"\"big zindex-pt zindex-pt-all\"\"&gt;([\\s\\S]*?)&lt;\"\n</code></pre>\n"}], "owner": {"reputation": 1372, "user_id": 2092236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f31bef5ce787bafd90b708edb563cf67?s=128&d=identicon&r=PG", "display_name": "JoaMika", "link": "https://stackoverflow.com/users/2092236/joamika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 30879771, "answer_count": 2, "score": 0, "last_activity_date": 1450360266, "creation_date": 1434495941, "last_edit_date": 1531164843, "question_id": 30879726, "link": "https://stackoverflow.com/questions/30879726/regular-expression-for-html", "title": "Regular Expression for HTML", "body": "<p>From this string:</p>\n\n<pre><code>&lt;strong class=\"big zindex-pt zindex-pt-all\"&gt;&amp;pound;2,362,214&lt;/strong&gt;\n</code></pre>\n\n<p>I am trying to get <code>&amp;pound;2,362,214</code> using this Regex in Excel VBA:</p>\n\n<pre><code> .Pattern = \"&lt;strong class=\"big zindex-pt zindex-pt-all\"&gt;([\\s\\S]*?)&lt;\"\n</code></pre>\n\n<p>Any ideas what I am doing wrong?</p>\n"}, {"tags": ["database", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5017296, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f3ee8d8cfdb925a6696fad964ab560cd?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier93", "link": "https://stackoverflow.com/users/5017296/xavier93"}, "edited": false, "score": 0, "creation_date": 1434516579, "post_id": 30880062, "comment_id": 49805720, "body": "Thanks for your reply.  Unfortunately this won&#39;t help, the content of column F is variable each day. This means I would have to manually make a new conditional format rule"}], "tags": [], "owner": {"reputation": 30, "user_id": 2980867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/764f46940c7b6064eef935b8f3de14f7?s=128&d=identicon&r=PG", "display_name": "dmurphy", "link": "https://stackoverflow.com/users/2980867/dmurphy"}, "is_accepted": false, "score": 0, "last_activity_date": 1434498160, "creation_date": 1434498160, "answer_id": 30880062, "question_id": 30879582, "link": "https://stackoverflow.com/questions/30879582/comparing-cell-values-in-excel/30880062#30880062", "title": "Comparing cell values in Excel", "body": "<p>To answer the first question of seeing if C4 exists in column F, you can put the following formula in cell E4.</p>\n\n<p>=IFERROR(INDEX($F$2:$F$5,MATCH(C4,$F$2:$F$5)),\"\")</p>\n\n<p>It will put the name if it exists and have a blank field if it doesn't. Just drag this formula throughput column E (or whatever column you want).</p>\n\n<p>In order to match formats and don't want to get into VBA (and assuming you don't have a lot of possibilities), you could add conditional formatting to the new column of E. With the \"Classic\" Style of conditional formatting, make a new rule that sets your custom format when the cell contains the specific text of \"Henk\". Then continue on making rules for the other possible options. After you create the conditional formatting in, say, cell E4 for example, change the \"Applies to\" field to apply to Sheet1!$C$2:$C$5.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 5017296, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f3ee8d8cfdb925a6696fad964ab560cd?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier93", "link": "https://stackoverflow.com/users/5017296/xavier93"}, "edited": false, "score": 0, "creation_date": 1434552567, "post_id": 30886977, "comment_id": 49829204, "body": "Unfortunately this does not work for me. I need A4 to remain intact (so Sheet2!A4) whenever C4 is empty. With your formula, when C4 is empty or doesn&#39;t match any cell in column F, A4 will return #REF!"}, {"owner": {"reputation": 325, "user_id": 5008116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4daf0c71a9d2cd598e7025bb911b90c3?s=128&d=identicon&r=PG&f=1", "display_name": "gudal", "link": "https://stackoverflow.com/users/5008116/gudal"}, "reply_to_user": {"reputation": 13, "user_id": 5017296, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f3ee8d8cfdb925a6696fad964ab560cd?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier93", "link": "https://stackoverflow.com/users/5017296/xavier93"}, "edited": false, "score": 0, "creation_date": 1434605655, "post_id": 30886977, "comment_id": 49852311, "body": "Ok. A few questions: 1. In whitch cell do you have your formula 2. What to you mean by &quot;only change column A when there is an actual match...&quot; Change format? Change content? 3. What is the purpose of this sheet? To see all open tickets and color code them according to resolver/submitter?"}, {"owner": {"reputation": 325, "user_id": 5008116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4daf0c71a9d2cd598e7025bb911b90c3?s=128&d=identicon&r=PG&f=1", "display_name": "gudal", "link": "https://stackoverflow.com/users/5008116/gudal"}, "reply_to_user": {"reputation": 13, "user_id": 5017296, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f3ee8d8cfdb925a6696fad964ab560cd?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier93", "link": "https://stackoverflow.com/users/5017296/xavier93"}, "edited": false, "score": 0, "creation_date": 1434606274, "post_id": 30886977, "comment_id": 49852542, "body": "For me it works with the edited formula in that it shows x if the C is empty or there is no match in F, and if there is a match and C is not empty, it shows &quot;x&quot;. Is that not what you ant to achieve?"}, {"owner": {"reputation": 13, "user_id": 5017296, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f3ee8d8cfdb925a6696fad964ab560cd?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier93", "link": "https://stackoverflow.com/users/5017296/xavier93"}, "edited": false, "score": 0, "creation_date": 1434616298, "post_id": 30886977, "comment_id": 49858120, "body": "Maybe that&#39;s wasn&#39;t clear. I made it show x because the x part is, I assume, where you can make A copy the format of the matching F cell"}, {"owner": {"reputation": 13, "user_id": 5017296, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f3ee8d8cfdb925a6696fad964ab560cd?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier93", "link": "https://stackoverflow.com/users/5017296/xavier93"}, "edited": false, "score": 0, "creation_date": 1434630881, "post_id": 30886977, "comment_id": 49868105, "body": "The point of the sheet is as followed. I have a list of tickets in sheet2 (column A in sheet 1). In column C will be the name of the agent resolving the ticket in column A. In column F there will be all the agents available on the current day (this is why conditional formatting based on constant names is not an option). Now I have to manually copy the format of the cell in F, containing the name of agent in cell C, to the ticketnumber in column A. Values in column A should never change, even when there is no match. If there is a match, it should get the same background color as the agent in C/"}, {"owner": {"reputation": 325, "user_id": 5008116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4daf0c71a9d2cd598e7025bb911b90c3?s=128&d=identicon&r=PG&f=1", "display_name": "gudal", "link": "https://stackoverflow.com/users/5008116/gudal"}, "reply_to_user": {"reputation": 13, "user_id": 5017296, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f3ee8d8cfdb925a6696fad964ab560cd?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier93", "link": "https://stackoverflow.com/users/5017296/xavier93"}, "edited": false, "score": 0, "creation_date": 1434632352, "post_id": 30886977, "comment_id": 49869177, "body": "Ok, but the formula you have entered in the question, is it not used it column A? Or is it someplace else?"}, {"owner": {"reputation": 13, "user_id": 5017296, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f3ee8d8cfdb925a6696fad964ab560cd?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier93", "link": "https://stackoverflow.com/users/5017296/xavier93"}, "edited": false, "score": 0, "creation_date": 1434640255, "post_id": 30886977, "comment_id": 49875647, "body": "Wow, thanks for the detailed edit!  Will try this out ASAP. I will come back with the result, but seems very promising! :)"}], "tags": [], "owner": {"reputation": 325, "user_id": 5008116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4daf0c71a9d2cd598e7025bb911b90c3?s=128&d=identicon&r=PG&f=1", "display_name": "gudal", "link": "https://stackoverflow.com/users/5008116/gudal"}, "is_accepted": false, "score": 1, "last_activity_date": 1434634329, "last_edit_date": 1434634329, "creation_date": 1434531813, "answer_id": 30886977, "question_id": 30879582, "link": "https://stackoverflow.com/questions/30879582/comparing-cell-values-in-excel/30886977#30886977", "title": "Comparing cell values in Excel", "body": "<p>Try the following:</p>\n\n<pre><code>=IF(IFERROR(MATCH(C4,F:F,0),0)&gt;0,IF(C4&lt;&gt;\"\",\"x\",Sheet2!A4), Sheet2!A4)\n</code></pre>\n\n<p>Edited formula error (; --> ,)</p>\n\n<p>EDIT:</p>\n\n<p>Ok, so forgetting about you formula and trying to do what I think you want, which is:</p>\n\n<p>Be able to copy in the list of resolvers at work into your color code scheme, and then apply that format to all tickets where this person is responsible. There has to be a way of telling, based on color, whether a ticket is assigned to a person that is not on the job (not in the list), or is not assigned to anyone. I assume you have a very limited amount of people at work, because if not, it will be very difficult to distinguish between the colors.</p>\n\n<p>Being quite few people at work at one time, what you could do is to:</p>\n\n<ol>\n<li>Name your the range with people at work \"workers\"</li>\n<li>Name the new range \"colors\"</li>\n<li>For each row with a color coding, enter the name of the color, or some other way of referencing the color. I entered \"Yellow\" \"Red\", \"Green\", \"Blue\", and I added a black for \"x\". </li>\n<li><p>Selected the top cell in the tickets column, selected new conditional formatting rule, entered the following formula</p>\n\n<pre><code>=IFERROR(INDEX(colors;MATCH($C1;workers;0));\"x\")=\"Yellow\"\n</code></pre>\n\n<p>Selected that this should have yellow fill, and applied to the entire Tickets column.</p></li>\n<li>Did the same for red, green, black, etc.</li>\n</ol>\n\n<p>Doing this, I managed to get the following behaviour:\n 1. I can change the names in the name column, and conditional formatting will not change</p>\n\n<ol start=\"2\">\n<li><p>If a ticket is solved by someone in the list, the background color of TicketX is the same as the name in the name list</p></li>\n<li><p>If a ticket is not solved by anyone, the formula returns \"\", which is not in any of the conditional formatting rules, so it remains white</p></li>\n<li><p>If a ticket is solved by someone not at work, formula evaluates to \"x\", which is tied to color black in conditional formatting, so the cell turns black (could consider adding white text here to be able to see ticket number).</p></li>\n</ol>\n\n<p>Now this is not that pretty, because you have to create so many rules, but as I say, if you are to distinguish between the colors, there can't be too many of them anyway.</p>\n"}], "owner": {"reputation": 13, "user_id": 5017296, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f3ee8d8cfdb925a6696fad964ab560cd?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier93", "link": "https://stackoverflow.com/users/5017296/xavier93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1442277185, "creation_date": 1434495009, "last_edit_date": 1531161705, "question_id": 30879582, "link": "https://stackoverflow.com/questions/30879582/comparing-cell-values-in-excel", "title": "Comparing cell values in Excel", "body": "<p>What I am trying to achieve is to see if the value of <strong><em>Cell C4</em></strong> exists in <strong><em>Column F</em></strong>. </p>\n\n<p>If it exists in <strong><em>Column F</em></strong>, I eventually want <strong><em>Cell A4</em></strong> to copy the format of the cell in <strong><em>Column F</em></strong> that matches the value of <strong><em>Cell C4</em></strong>. </p>\n\n<p>Still following me?</p>\n\n<p>For reference, my file looks like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/endJe.jpg\" alt=\"enter image description here\"></p>\n\n<p>The values of the cells in <strong><em>Column A</em></strong> are based on Sheet2.</p>\n\n<p>So with a simple formula I managed to compare the values and only change Column A when there is an actual match as seen below.</p>\n\n<pre><code>=IF(C4=F:F, IF(C4&lt;&gt;\"\",\"x\",Sheet2!A4), Sheet2!A4)\n</code></pre>\n\n<p>The only problem here is that it only results in a TRUE statement, if <strong><em>Cell C4</em></strong> matches <strong><em>Cell F4</em></strong>. If it matches, let's say <strong><em>Cell F5</em></strong>, the statement will be FALSE and I need it to be TRUE (since value of <strong><em>C4</em></strong> is indeed found in <strong><em>Column F</em></strong>.</p>\n\n<p>I tried a variation using $F:$F instead of F:F, but this made no difference. Also setting a range (F2:F5) did not work.</p>\n\n<p>This is where I am stuck. </p>\n\n<p><em>As soon as I have this figured out, I can continue finding a way of copying the format of the matched cell. Feel free to reveal how I manage to do this if you already know. Will save me some headaches.</em></p>\n"}, {"tags": ["vba", "excel", "colors", "cells"], "comments": [{"owner": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "edited": false, "score": 0, "creation_date": 1434500316, "post_id": 30879479, "comment_id": 49801606, "body": "When you say a bunch of colors are we talking 100?1K?1MM? Also when you loop through the range, are you only looking at Used Range or some other defined range?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1434502738, "post_id": 30879479, "comment_id": 49802241, "body": "<code>For Each SomeRange In SomeSheet.UsedRange.Cells</code> would at least restrict your code only to cells which are within the &quot;used area&quot; of each sheet.  There are a <i>lot</i> of cells on the whole sheet!"}, {"owner": {"reputation": 259, "user_id": 4565161, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NLs4I.jpg?s=128&g=1", "display_name": "boxcartenant", "link": "https://stackoverflow.com/users/4565161/boxcartenant"}, "edited": false, "score": 0, "creation_date": 1434548171, "post_id": 30879479, "comment_id": 49825712, "body": "Thanks for the comments! In terms of just the number of shades in the sheet, maybe like 20. In terms of the number of cells occupied, best guess.... 300K?  If color is the only formatting difference, would PasteSpecialFormats change the color without damaging my data?"}, {"owner": {"reputation": 259, "user_id": 4565161, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NLs4I.jpg?s=128&g=1", "display_name": "boxcartenant", "link": "https://stackoverflow.com/users/4565161/boxcartenant"}, "edited": false, "score": 0, "creation_date": 1435514486, "post_id": 30879479, "comment_id": 50220968, "body": "Following up: I finally used Tim Williams&#39;s suggestion, and the program ran way more quickly. Thanks all for your help."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1434495454, "creation_date": 1434495454, "answer_id": 30879652, "question_id": 30879479, "link": "https://stackoverflow.com/questions/30879479/how-to-copy-all-cell-colors-from-one-workbook-to-another-in-excel-vba/30879652#30879652", "title": "How to copy all cell colors from one workbook to another in Excel VBA?", "body": "<p>You may be able to adapt this to sheets in different workbooks.  Say we have two sheet in the <strong>same</strong> workbook.  We want to copy the colors.  Rather than looping of all the cells individually, we copy all the cells from the first sheet and and PasteSpecialFormats into the second worksheet:</p>\n\n<p>From the Recorder:</p>\n\n<pre><code>Sub Macro2()\n    Sheets(\"Sheet1\").Select\n    Cells.Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Sheet2\").Select\n    Cells.Select\n    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 259, "user_id": 4565161, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NLs4I.jpg?s=128&g=1", "display_name": "boxcartenant", "link": "https://stackoverflow.com/users/4565161/boxcartenant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2318, "favorite_count": 0, "accepted_answer_id": 30879652, "answer_count": 1, "score": 0, "last_activity_date": 1435259888, "creation_date": 1434494449, "last_edit_date": 1495541161, "question_id": 30879479, "link": "https://stackoverflow.com/questions/30879479/how-to-copy-all-cell-colors-from-one-workbook-to-another-in-excel-vba", "title": "How to copy all cell colors from one workbook to another in Excel VBA?", "body": "<p>I have two large workbooks with identical sheet names, and similar data. The source sheet has a bunch of colors applied to the cells, and I have to copy those colors to their respective cells in the destination sheet.</p>\n\n<p>I've tried this suggestion:\n<a href=\"https://stackoverflow.com/questions/27551182/how-to-copy-an-excel-color-scheme-from-one-workbook-to-another\">How to copy an Excel color scheme from one workbook to another</a></p>\n\n<p>But it didn't seem to do anything.</p>\n\n<p>This is the code I wrote, but it locks up excel for a long time. Does it look right to you? </p>\n\n<pre><code>Sub CopyColors()\n\nDim x As Workbook\nDim y As Workbook\nDim SomeSheet As Worksheet\nDim SomeRange As Range\n\nSet x = Workbooks.Open(\" c:/PATH/Source.xlsm \")\nSet y = Workbooks.Open(\" c:/PATH/Destination.xlsm \")\n\ny.Colors = x.Colors\n\nFor Each SomeSheet In x.Worksheets\n    For Each SomeRange In SomeSheet.Cells\n        y.Sheets(SomeSheet.Name).Range(SomeRange.Address).Interior.ColorIndex = SomeRange.Interior.ColorIndex\n    Next SomeRange\nNext SomeSheet\n\nEnd Sub\n</code></pre>\n\n<p>I decided it'd be a better use of my time to explore other options than to wait for this to pan out. If I don't get a better idea, I'll let this run overnight tonight.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "edited": false, "score": 0, "creation_date": 1434500118, "post_id": 30879395, "comment_id": 49801556, "body": "FYI* Slight spacing issue in your If statement"}], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1434527923, "creation_date": 1434527923, "answer_id": 30885605, "question_id": 30879395, "link": "https://stackoverflow.com/questions/30879395/need-to-transpose-rows-while-transferring-data-from-one-excel-sheet-to-another/30885605#30885605", "title": "Need to transpose rows while transferring data from one excel sheet to another", "body": "<p>Give this a try :</p>\n\n<pre><code>Sub PullData()\n\nDim wRow As Long, _\n    RowPointer As Long, _\n    MyWorkbook As Workbook, _\n    Ws As Worksheet, _\n    OutWs As Worksheet\n\nSet MyWorkbook = Workbooks(ActiveWorkbook.Name)\nSet Ws = MyWorkbook.Sheets(\"MAIN\")\nSet OutWs = MyWorkbook.Sheets(\"CONTRACT\")\n\nWith Ws\n    For RowPointer = 6 To .Cells(.Rows.Count, \"B\").End(xlUp).Row\n        If .Range(\"A\" &amp; RowPointer).Value &gt; 0 And _\n                .Range(\"A\" &amp; RowPointer).Value &lt;&gt; \"\" And _\n                .Range(\"F\" &amp; RowPointer).Value &gt; 0 And _\n                .Range(\"F\" &amp; RowPointer).Value &lt;&gt; \"\" Then\n            'This line would get you out of the loop after the first copy because _\n            'You first paste on line 17 and then the below left part will be equal to 18\n            'If OutWs.Cells(OutWs.Rows.Count, \"B\").End(xlUp).Row &gt; 15 Then Exit Sub\n\n\n            wRow = OutWs.Rows(OutWs.Rows.Count).End(xlUp).Row + 1\n            'Always start copy after (or at) line 17\n            If wRow &lt;= 17 Then wRow = 17\n            'More efficient way to copy data between ranges\n            OutWs.Range(\"A\" &amp; wRow).Value = Ws.Range(\"A\" &amp; RowPointer)\n            OutWs.Range(\"B\" &amp; wRow).Value = Ws.Range(\"B\" &amp; RowPointer)\n            OutWs.Range(\"D\" &amp; wRow).Value = Ws.Range(\"E\" &amp; RowPointer)\n            OutWs.Range(\"E\" &amp; wRow).Value = Ws.Range(\"F\" &amp; RowPointer)\n        End If\n    Next RowPointer\nEnd With\n\nSet MyWorkbook = Nothing\nSet Ws = Nothing\nSet OutWs = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4976004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5fb94b472ffc339233e75f9b5492a80?s=128&d=identicon&r=PG&f=1", "display_name": "vickroycomputers", "link": "https://stackoverflow.com/users/4976004/vickroycomputers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1434529937, "creation_date": 1434493988, "last_edit_date": 1495542598, "question_id": 30879395, "link": "https://stackoverflow.com/questions/30879395/need-to-transpose-rows-while-transferring-data-from-one-excel-sheet-to-another", "title": "Need to transpose rows while transferring data from one excel sheet to another", "body": "<p>My original question was posted <a href=\"https://stackoverflow.com/questions/30656997/need-to-fill-a-sheet-with-consecutive-rows-data-based-on-value-in-another-worksh\">here</a>.</p>\n\n<p>Basically I needed some help transferring data from one sheet to another based on values in the first sheet.  I am using a modified bit of code provided by user <a href=\"https://stackoverflow.com/users/4967653/keong-kenshih\">keong kenshih</a>.</p>\n\n<p>I added an additional check against another row to the <code>IF</code> statement, and I have this for my code:</p>\n\n<pre><code>Option Explicit\nDim MyWorkbook As Workbook\nDim MyWorksheet As Worksheet\nDim MyOutputWorksheet As Worksheet\n</code></pre>\n\n<p>So I need to output only certain columns. Also I need them to import to certain rows and columns on the second sheet, the CONTRACT sheet. Column A on the MAIN sheet goes to column A starting at row 17 on the CONTRACT sheet. B to B , E to D, F to E, all starting at row 17 on the CONTRACT sheet.\nRows 17-42 on the CONTRACT sheet will contain data.</p>\n\n<pre><code>Sub PullData()\n    Set MyWorkbook = Workbooks(ActiveWorkbook.Name)\n    Set MyWorksheet = MyWorkbook.Sheets(\"MAIN\")\n    Set MyOutputWorksheet = MyWorkbook.Sheets(\"CONTRACT\")\n\n    Dim myValue As Long\n    Dim RowPointer As Long\n\n    For RowPointer = 6 To MyWorksheet.Cells(Rows.Count, \"B\").End(xlUp).Row\n        If MyWorksheet.Range(\"A\" &amp; RowPointer).V  alue &gt; 0 And \n        MyWorksheet.Range(\"A\" &amp; RowPointer).Value &lt;&gt; \"\" \n        MyWorksheet.Range(\"F\" &amp; RowPointer).Value &gt; 0 And \n        MyWorksheet.Range(\"F\" &amp; RowPointer).Value &lt;&gt; \"\"Then\n            If MyOutputWorksheet.Cells(Rows.Count, \"B\").End(xlUp).Row &gt; 15 \n            Then\n                Exit Sub\n            End If\n            MyWorksheet.Range((\"A\" &amp; RowPointer) &amp; \":C\" &amp; RowPointer).Copy \n            Destination:=MyOutputWorksheet.Range(\"A\" &amp; \n            MyOutputWorksheet.Cells(Rows.Count, \"B\").End(xlUp).Row + 1)\n        End If\n    Next RowPointer\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 597, "user_id": 4154327, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/GtUQU.jpg?s=128&g=1", "display_name": "CalebB", "link": "https://stackoverflow.com/users/4154327/calebb"}, "edited": false, "score": 1, "creation_date": 1434492523, "post_id": 30879062, "comment_id": 49799157, "body": "Where is your code for tallying the records? Also what kind of values are you tallying? When you say &quot;next available row&quot; do you mean the next empty row? Can you clarify your problem and intended result a little please? :)"}, {"owner": {"reputation": 157295, "user_id": 76337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1aa48f7606f5b08595b0a0356a61e8b6?s=128&d=identicon&r=PG", "display_name": "John Saunders", "link": "https://stackoverflow.com/users/76337/john-saunders"}, "edited": false, "score": 0, "creation_date": 1434507118, "post_id": 30879062, "comment_id": 49803359, "body": "Unlike forum sites, we don&#39;t use &quot;Thanks&quot;, or &quot;Any help appreciated&quot;, or signatures on <a href=\"https://stackoverflow.com\">Stack Overflow</a>. See &quot;<a href=\"http://meta.stackexchange.com/questions/2950/should-hi-thanks-taglines-and-salutations-be-removed-from-posts\">Should &#39;Hi&#39;, &#39;thanks,&#39; taglines, and salutations be removed from posts?</a>."}], "answers": [{"tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": false, "score": 0, "last_activity_date": 1434494699, "creation_date": 1434494699, "answer_id": 30879528, "question_id": 30879062, "link": "https://stackoverflow.com/questions/30879062/inserting-range-of-data-from-one-sheet-to-the-next/30879528#30879528", "title": "Inserting range of data from one sheet to the next", "body": "<p>Consider the example:</p>\n\n<pre><code>Sub Test()\n    DataTransfer Sheets(\"Master\").Range(\"A1:F10\"), Sheets(\"tempsheet\")\nEnd Sub\n\nSub DataTransfer(SrcRange As Range, DstSheet As Worksheet)\n    Dim AvailableRow As Long\n    With DstSheet\n        AvailableRow = .UsedRange.Row + .UsedRange.Rows.Count\n        .Range(.Cells(AvailableRow, 1), .Cells(AvailableRow + SrcRange.Rows.Count - 1, SrcRange.Columns.Count)).Value = SrcRange.Value\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5003378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c3d667d480ce830aa1634be09b42bad?s=128&d=identicon&r=PG&f=1", "display_name": "FlaHillbilly", "link": "https://stackoverflow.com/users/5003378/flahillbilly"}, "is_accepted": false, "score": 0, "last_activity_date": 1434504529, "creation_date": 1434504529, "answer_id": 30880883, "question_id": 30879062, "link": "https://stackoverflow.com/questions/30879062/inserting-range-of-data-from-one-sheet-to-the-next/30880883#30880883", "title": "Inserting range of data from one sheet to the next", "body": "<p>I am not an Excel expert so for a problem like yours, I usually resort to a brute-force approach: As an example, consider two workbooks with a single worksheet each.  </p>\n\n<p>In order to copy a block of cells from workbook 2 to workbook 1 I would write a VBA function like: </p>\n\n<pre><code>Sub CopySheetFromOtherWorkbook()\n\nDim exWB1 As Excel.Workbook\nDim exWB2 As Excel.Workbook\n\nDim exWS1 As Excel.Worksheet\nDim exWS2 As Excel.Worksheet\n\nDim exR1 As Excel.Range\nDim exR2 As Excel.Range\n\nDim Marker1 As String, Marker2 As String\nDim aRow As Integer, aCol As Integer\n\nSet exWB1 = Excel.Workbooks(1)\nSet exWB2 = Excel.Workbooks(2)\n\nSet exWS1 = exWB1.Sheets(1)\nSet exWS2 = exWB2.Sheets(1)\n\nSet exR1 = exWS1.Range(\"A1\")\nSet exR2 = exWS2.Range(\"A1\")\n\nMarker1 = exR1.Cells(1, 1)\nMarker2 = exR2.Cells(1, 1)\n\nMsgBox \"Workbook 1 Marker:  \" + Marker1\nMsgBox \"Workbook 2 Marker:  \" + Marker2\n\nFor aCol = 2 To 11\n  For aRow = 1 To 30\n    exR1.Cells(aRow, aCol) = exR2.Cells(aRow, aCol)\n    Next aRow\n  Next aCol\n\nEnd Sub\n</code></pre>\n\n<p>To do what you are asking to do, all you need to do is add code to test for empty cell and total those who meet your criteria</p>\n\n<p>To actually do this you would want to reference the two workbooks by name and (Possibly) setup code to determine the actual row and col limits.</p>\n"}], "owner": {"reputation": 23, "user_id": 2922055, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f3d740e0cd57758fc3c765a44bba192a?s=128&d=identicon&r=PG&f=1", "display_name": "user2922055", "link": "https://stackoverflow.com/users/2922055/user2922055"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1434507106, "creation_date": 1434492225, "last_edit_date": 1434507106, "question_id": 30879062, "link": "https://stackoverflow.com/questions/30879062/inserting-range-of-data-from-one-sheet-to-the-next", "title": "Inserting range of data from one sheet to the next", "body": "<p>Using Excel 2010</p>\n\n<p>Ok so easy enough I was able to find out how to insert data from one sheet to  another and tally the records </p>\n\n<pre><code>Sheets(\"tempsheet\").Range(\"A1:F10\").Value = Sheets(\"Master\").Range(\"A1:F10\").Value\n</code></pre>\n\n<p>but then I tackled the next step on trying to find the next available row and get tackled myself and I'm at a loss to getting it to work. I've check many sites but everything I try I get an error. Then I look at my code and see how it won't work finding the next available row and still post to same A1:F10. So now i'm resorting for online help.</p>\n\n<p>My steps are:</p>\n\n<ol>\n<li>Check sheet2 for empty row</li>\n<li>Copy information from sheet1 to sheet2</li>\n<li>Tally the number of records.</li>\n</ol>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1434493357, "post_id": 30879012, "comment_id": 49799456, "body": "If this is something that you are doing only one-off as it seems you are, then I suggest you break up your column into individual words by using the &quot;Text to Columns&quot; command. Description of the feature here: <a href=\"https://support.microsoft.com/en-us/kb/214261\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/214261</a>. Cheers,"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1434493724, "post_id": 30879012, "comment_id": 49799564, "body": "can you show what the spreadsheet looks like? add image to que"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 1, "creation_date": 1434497353, "post_id": 30879012, "comment_id": 49800833, "body": "Even if you look at each word individually then you may still run into problems. If you have St Marks Place in New York or any street in St Louis then how do you prevent your replacement algorithm from turning what should be &quot;Saint&quot; into &quot;Street&quot;"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1434509694, "post_id": 30879012, "comment_id": 49803916, "body": "Just out of curiousity, why do you want to de-normalize your address column?  At least in the United States, <a href=\"http://pe.usps.com/text/pub28/28c2_014.htm#ep526381\" rel=\"nofollow noreferrer\">the USPS prefers</a> that &quot;Street&quot;, &quot;Road&quot;, &quot;Avenue&quot;, etc. be abbreviated. See <a href=\"http://pe.usps.com/text/pub28/welcome.htm\" rel=\"nofollow noreferrer\">Publication 28 - Postal Addressing Standards</a>."}, {"owner": {"reputation": 15, "user_id": 5017248, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-o_wVL8Q2EqQ/AAAAAAAAAAI/AAAAAAAAAFY/GBTupEF7X5w/photo.jpg?sz=128", "display_name": "Colby Ackerman", "link": "https://stackoverflow.com/users/5017248/colby-ackerman"}, "edited": false, "score": 0, "creation_date": 1434551860, "post_id": 30879012, "comment_id": 49828603, "body": "It&#39;s not that I want to de-normalize the addresses; I want to be able to use vlookup and the addresses are a mixed bag of formats. I just want to turn all the formats to the same thing."}], "answers": [{"comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 1, "creation_date": 1434493038, "post_id": 30879047, "comment_id": 49799344, "body": "I don&#39;t believe that is an option in &quot;Find and Replace&quot;. At least in Excel 2013. There is the &quot;Match entire cell contents&quot; but this wouldn&#39;t achieve the requested result. Can you check again if this option is available to you and what version of Excel you are using?"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1434497032, "post_id": 30879047, "comment_id": 49800746, "body": "I think that&#39;s actually an option in Microsoft Word rather than in Excel"}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1434548749, "post_id": 30879047, "comment_id": 49826175, "body": "Oops, yes, you are both right. Are you comfortable using VBA? I can code something for you as a replacement answer."}, {"owner": {"reputation": 15, "user_id": 5017248, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-o_wVL8Q2EqQ/AAAAAAAAAAI/AAAAAAAAAFY/GBTupEF7X5w/photo.jpg?sz=128", "display_name": "Colby Ackerman", "link": "https://stackoverflow.com/users/5017248/colby-ackerman"}, "edited": false, "score": 0, "creation_date": 1434551632, "post_id": 30879047, "comment_id": 49828460, "body": "I&#39;d love that code seeing as the addin is incompatible with excel 2010 64 bit. I am comfortable with VBA, just less so with string manipulation."}, {"owner": {"reputation": 15, "user_id": 5017248, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-o_wVL8Q2EqQ/AAAAAAAAAAI/AAAAAAAAAFY/GBTupEF7X5w/photo.jpg?sz=128", "display_name": "Colby Ackerman", "link": "https://stackoverflow.com/users/5017248/colby-ackerman"}, "edited": false, "score": 0, "creation_date": 1434553653, "post_id": 30879047, "comment_id": 49830074, "body": "Never mind about the code. See below for my solution."}], "tags": [], "owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "is_accepted": false, "score": 0, "last_activity_date": 1434492141, "creation_date": 1434492141, "answer_id": 30879047, "question_id": 30879012, "link": "https://stackoverflow.com/questions/30879012/road-type-abbreviation-replacement-in-excel/30879047#30879047", "title": "Road Type Abbreviation Replacement in Excel", "body": "<p>I see that you tried Find and Replace, but I am guessing that you did not check the \"Match Whole Word\" advanced option. Do Find and Replace Again, click the Advanced button, and check the \"Match Whole Word\" checkbox. As long as your abbreviations are separated by a space from the street name, you should replace the abbreviation without touching the street name.</p>\n"}, {"tags": [], "owner": {"reputation": 15, "user_id": 5017248, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-o_wVL8Q2EqQ/AAAAAAAAAAI/AAAAAAAAAFY/GBTupEF7X5w/photo.jpg?sz=128", "display_name": "Colby Ackerman", "link": "https://stackoverflow.com/users/5017248/colby-ackerman"}, "is_accepted": true, "score": 0, "last_activity_date": 1434553548, "creation_date": 1434553548, "answer_id": 30895456, "question_id": 30879012, "link": "https://stackoverflow.com/questions/30879012/road-type-abbreviation-replacement-in-excel/30895456#30895456", "title": "Road Type Abbreviation Replacement in Excel", "body": "<p>Ok, so I think I resolved the issue. Text to Columns with a space delimiter onto a new worksheet, then checking the \"match entire cell contents\" in the find and replace. After all the abbreviations have been replaced, I will concatenate all of the columns back together and copy and paste the cells back to their original place.</p>\n\n<p>Thanks for the help everyone. And thanks nbayly for the fix.</p>\n"}], "owner": {"reputation": 15, "user_id": 5017248, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-o_wVL8Q2EqQ/AAAAAAAAAAI/AAAAAAAAAFY/GBTupEF7X5w/photo.jpg?sz=128", "display_name": "Colby Ackerman", "link": "https://stackoverflow.com/users/5017248/colby-ackerman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2938, "favorite_count": 1, "accepted_answer_id": 30895456, "answer_count": 2, "score": 0, "last_activity_date": 1434553548, "creation_date": 1434491989, "question_id": 30879012, "link": "https://stackoverflow.com/questions/30879012/road-type-abbreviation-replacement-in-excel", "title": "Road Type Abbreviation Replacement in Excel", "body": "<p>I have a large spreadsheet in excel which has a column of 6000+ addresses. I want to convert any of the road type abbreviations to the typed out types. </p>\n\n<p>examples: <strong>Rd -> Road</strong> or <strong>St. -> Street.</strong></p>\n\n<p>An issue I've encountered is that some addresses contain the sequence of letters I am trying to replace and the find and replace feature ends up replacing parts of the names of the streets in addition to replacing the abbreviations. </p>\n\n<p>for example: <strong>1123 Stupid State St</strong> would be replaced by <strong>1123 Streetupid Streetate Street</strong></p>\n\n<p>Is there any way to write some code that would only change the abbreviations while preserving the rest of the address?</p>\n\n<p><strong>Note:</strong> All of the addresses do not follow the same format. The abbreviations fall in random places within the cell--that is to say that the abbreviations do not always appear at the end of the cell value.</p>\n\n<p>This also needs to work for all road type abbreviations.</p>\n\n<p>Thanks a ton for any help.</p>\n"}, {"tags": ["vba", "popup", "ms-word"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1434520616, "post_id": 30878814, "comment_id": 49807193, "body": "how many Ole object do you have in your document? Try to run macro only for few of them to check if macro is able to complete. There could be many reason but one is memory limited resources. you could try to debug your subroutine. Try to put <code>Stop</code> at the end of inner loop- it would required manual triggering for each object but you would be able to find which object is causing a problem (which could be the other reason of errors)."}, {"owner": {"reputation": 45, "user_id": 2372575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd9118d6fd03c1ea538ada094b2f2658?s=128&d=identicon&r=PG", "display_name": "L2Code", "link": "https://stackoverflow.com/users/2372575/l2code"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1434520883, "post_id": 30878814, "comment_id": 49807325, "body": "Hundreds of OLEs in a couple of thousand page document. Stop isn&#39;t really an option since the message only starts to appear a few hundred pages down the road, unless I manually extract parts of the document and try which would be very time consuming. I am not sure as to what the error messsage is suggesting or what it is as a result of.. It seems to be random too, getting me a bit puzzled."}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1434521523, "post_id": 30878814, "comment_id": 49807640, "body": "if you want to solve the problem it seems that you need to expect some manual work and tests. at the first stage you could try to stop every 10th Ole object, next go to details knowing the section when error occurs. To stop every 10th use this function <code>Debug.Assert i &#47; 10 &lt;&gt; Int(i &#47; 10)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 2372575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd9118d6fd03c1ea538ada094b2f2658?s=128&d=identicon&r=PG", "display_name": "L2Code", "link": "https://stackoverflow.com/users/2372575/l2code"}, "edited": false, "score": 0, "creation_date": 1435004752, "post_id": 30887656, "comment_id": 50008216, "body": "Thanks for the suggestion. That actually greatly reduced the number of times the message comes up. It seems the more objects I iterate through before saving, the more times the message comes up. However, for some reason, word stops responding, stops iterating through the objects and is not updating the file, and eventually crashes. I am not sure as to what is causing this."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 45, "user_id": 2372575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd9118d6fd03c1ea538ada094b2f2658?s=128&d=identicon&r=PG", "display_name": "L2Code", "link": "https://stackoverflow.com/users/2372575/l2code"}, "edited": false, "score": 0, "creation_date": 1435023738, "post_id": 30887656, "comment_id": 50014507, "body": "Then please click on the vote to accept the partial answer :-)"}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": true, "score": 1, "last_activity_date": 1434533555, "creation_date": 1434533555, "answer_id": 30887656, "question_id": 30878814, "link": "https://stackoverflow.com/questions/30878814/vba-macro-to-convert-ole-to-text-results-in-word-has-encountered-a-prob-error/30887656#30887656", "title": "VBA Macro to convert OLE to text results in &quot;Word has encountered a prob.&quot; error", "body": "<p>I Googled for \"Word undo\" and found the following:</p>\n\n<p>\"be sure to save once in a while since the undo stack will be cleared\"</p>\n\n<p>So, for example, safe the document [to a temp name] after processing every 10 objects.</p>\n"}], "owner": {"reputation": 45, "user_id": 2372575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd9118d6fd03c1ea538ada094b2f2658?s=128&d=identicon&r=PG", "display_name": "L2Code", "link": "https://stackoverflow.com/users/2372575/l2code"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 681, "favorite_count": 1, "accepted_answer_id": 30887656, "answer_count": 1, "score": 0, "last_activity_date": 1435589996, "creation_date": 1434491138, "last_edit_date": 1435589996, "question_id": 30878814, "link": "https://stackoverflow.com/questions/30878814/vba-macro-to-convert-ole-to-text-results-in-word-has-encountered-a-prob-error", "title": "VBA Macro to convert OLE to text results in &quot;Word has encountered a prob.&quot; error", "body": "<p>I am using the following VBA script to parse through a word document and open every OLE table object, copy the table, and paste back into word so that the data in the tables can be searchable. However, after the script runs for a while, Word gives me an error message stating \"Word has encountered a problem. You will not be able to undo this action once it is completed. Do you want to continue?\" Clicking yes leads the document to stop responding and crash with no changes been made. Choosing No just keeps repopping up the same message and I'm assuming this leads to the changes not being saved. Is something wrong with the script ? I thought it was somehow filling up the memory by opening all those OLE objects, but I think activating the word document shifts focus from the OLE object and hence closes the embedded table to continue parsing through the original document. I think it's probably related to each iteration of the loop although the message doesn't show up for every OLE table. I am stuck as to how to investigate further into what is causing this issue.</p>\n\n<pre><code>    wrdActDoc.InlineShapes(lShapeCnt).OLEFormat.Activate\n    Selection.Document.Select\n    Selection.WholeStory\n    Selection.Cut\n    wrdActDoc.Activate\n    Selection.PasteAndFormat (wdPasteDefault)\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1434491290, "post_id": 30878772, "comment_id": 49798612, "body": "<code>tblCandidate</code> probably should <i>not</i> have the column <code>CandidateSkillId</code>: it should have only one row per candidate, but by including <code>CandidateSkillId</code> you&#39;re forcing it to have &gt;1 if the candidate has multiple skills."}, {"owner": {"reputation": 75, "user_id": 2891487, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b28e654235644ba84ca1d3cfc4728e1c?s=128&d=identicon&r=PG&f=1", "display_name": "user2891487", "link": "https://stackoverflow.com/users/2891487/user2891487"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1434491465, "post_id": 30878772, "comment_id": 49798696, "body": "Sorry, that was a typo.  Will fix it right now.  Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "is_accepted": false, "score": 0, "last_activity_date": 1434491852, "creation_date": 1434491852, "answer_id": 30878982, "question_id": 30878772, "link": "https://stackoverflow.com/questions/30878772/search-function-join-a-look-up-table-with-multiple-rows-and-where-clause/30878982#30878982", "title": "Search Function - Join a look up table with multiple rows and where clause", "body": "<p>As far as the SQL is involved I would thing you would want to do something like:</p>\n\n<pre><code>Select CandidateId, Count(*)\nfrom viewCandidate\nwhere CandidateSkillId in (skill1,skill2,skill3)\nhaving count(*) = skillCt\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 2891487, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b28e654235644ba84ca1d3cfc4728e1c?s=128&d=identicon&r=PG&f=1", "display_name": "user2891487", "link": "https://stackoverflow.com/users/2891487/user2891487"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594656092, "creation_date": 1434490930, "last_edit_date": 1594656092, "question_id": 30878772, "link": "https://stackoverflow.com/questions/30878772/search-function-join-a-look-up-table-with-multiple-rows-and-where-clause", "title": "Search Function - Join a look up table with multiple rows and where clause", "body": "<p>I am building a search function with Microsoft Access 2013 and VBA.  My database has three tables, <code>tblCandidate</code>, <code>tblCandidateSkill</code>, <code>lutSkill</code>, although <code>lutSkill</code> isn't really necessary for this discussion, I thought it might beneficial to share anyways.  </p>\n\n<p>Below are my table definitions:</p>\n\n<pre><code>tblCandidate              tblCandidateSkill           lutSkill\n----------------          -----------------           -------------\nCandidateId               CandidateSkillId            SkillId          \nFirstName                 CandidateId                 Name\nMiddleName                SkillId                     Description\nLastName                  YearsExp\netc...                 \n</code></pre>\n\n<p>A candidate can have multiple skills which each record in <code>tblCandidateSkill</code> relates to a single record in <code>lutSkill</code>.  I've created a query/view (<code>viewCandidate</code>)  which joins <code>tblCandidate</code> and <code>tblCandidateSkill</code>.  This works as expected.  If a Candidate has several skills, each skill is listed in a separate row along with the candidates information.</p>\n\n<p>My search function in VBA is basically just a bunch of nested <code>If Else</code> statements that generate some dynamic SQL.</p>\n\n<p>Here is my code below for the curious.  </p>\n\n<pre><code>Private Sub Search_Click()\n\n' Declare variables\nDim stateId As Integer\nDim skillId1 As Integer\nDim skillId2 As Integer\nDim skillId3 As Integer\nDim yearsExp1 As Integer\nDim yearsExp2 As Integer\nDim yearsExp3 As Integer\n\nDim count As Integer\n\nDim db As DAO.Database\nDim qdf As DAO.QueryDef\n\nDim strQuery As String\nDim strWhere As String\nDim strSQL As String\n\nOn Error GoTo errHandler\n\nstrQuery = \"qryCandidateSearchResults\"\nstrSQL = \"SELECT FirstName, MiddleName, LastName, Phone, Email FROM viewCandidate WHERE \"\n\n'===========================================================\n' Start dynamic query\n\n' Check for state id\nIf Not IsNull(Me.ddlState.Value) Then\n    strWhere = strWhere &amp; \" ([StateId] = \" &amp; Me.ddlState.Column(0) &amp; \") AND \"\nEnd If\n\n' Check for skillId1 and yearsExp1\nIf Not IsNull(Me.ddlSkill1.Value) Then\n\n    ' if yearsExp1 is not null, include it,\n    ' otherwise dont.\n    If Not IsNull(Me.ddlYearsExp1.Value) Then\n        strWhere = strWhere &amp; \" (SkillId = \" &amp; Me.ddlSkill1.Column(0) &amp; \" AND YearsExp &gt;= \" &amp; Me.ddlYearsExp1.Column(0) &amp; \") AND \"\n    Else\n        strWhere = strWhere &amp; \" (SkillId = \" &amp; Me.ddlSkill1.Column(0) &amp; \") AND \"\n    End If\nEnd If\n\n' Check for skillId2 and yearsExp2\nIf Not IsNull(Me.ddlSkill2.Value) Then\n\n    If Not IsNull(Me.ddlYearsExp2.Value) Then\n        strWhere = strWhere &amp; \" (SkillId = \" &amp; Me.ddlSkill2.Column(0) &amp; \" AND YearsExp &gt;= \" &amp; Me.ddlYearsExp2.Column(0) &amp; \") AND \"\n    Else\n        strWhere = strWhere &amp; \" (SkillId = \" &amp; Me.ddlSkill2.Column(0) &amp; \") AND \"\n    End If\nEnd If\n\n' Check for skillId3 and yearsExp4\nIf Not IsNull(Me.ddlSkill3.Value) Then\n\n    If Not IsNull(Me.ddlYearsExp3.Value) Then\n        strWhere = strWhere &amp; \" (SkillId = \" &amp; Me.ddlSkill3.Column(0) &amp; \" AND YearsExp &gt;= \" &amp; Me.ddlYearsExp3.Column(0) &amp; \") AND \"\n    Else\n        strWhere = strWhere &amp; \" (SkillId = \" &amp; Me.ddlSkill3.Column(0) &amp; \") AND \"\n    End If\nEnd If\n\n\n'============================================================\n\n' Remove the last \"AND\"\nIf Right(strWhere, 4) = \"AND \" Then\n    strWhere = Mid(strWhere, 1, Len(strWhere) - 4)\nEnd If\n\nstrSQL = strSQL &amp; strWhere\n\n' Check for criteria and exit if none exists\n' else set CurrentDb, QueryDef and SQL string\nIf Len(strWhere) = 0 Then\n    MsgBox \"You didn't enter any criteria for this report, now exiting\", vbExclamation\n    Exit Sub\nElse\n    Set db = CurrentDb\n    Set qdf = db.QueryDefs(strQuery)\n    qdf.SQL = strSQL\nEnd If\n\nDoCmd.OpenReport \"rptCandidateSearch\", acViewPreview\nDebug.Print strSQL\n\n\nExit Sub\n\nerrHandler:\nSelect Case Err.Number\n    Case 2501\n        'No data\n        Resume Next\n    Case Else\n        MsgBox Err.Number &amp; \" - \" &amp; Err.Description\nEnd Select\n\nEnd Sub\n</code></pre>\n\n<p>My problem stems for each skill being on a separate row. For example, if I want to search the database for a candidate that has three skills, how can I filter that data to show only those candidates that match the search criteria?  All my attempts have failed since each skillId is listed on a separate row..  If I use <code>And</code> in the where clause, nothing catches, and if I use <code>OR</code> the results are inaccurate.</p>\n"}]