[{"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1438213108, "post_id": 31712909, "comment_id": 51363623, "body": "have you tried <code>INDIRECT()</code> ?"}, {"owner": {"reputation": 501, "user_id": 4810090, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/10153086352247107/picture?type=large", "display_name": "Jimmyn", "link": "https://stackoverflow.com/users/4810090/jimmyn"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1438214177, "post_id": 31712909, "comment_id": 51363873, "body": "@MacroMan no I havn&#39;t yet, how would I incorporate this?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1438216188, "post_id": 31712909, "comment_id": 51364388, "body": "I was going to explain, but the answer below using concatenation is much better tbh."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1438219935, "post_id": 31712909, "comment_id": 51365297, "body": "You have a good answer below but in the interest of tweaking the formula, are the wildcards <i>really</i> necessary? Even if they are, a <code>*no*</code> or even a <code>*yes*</code> can produce a lot of false positives."}], "answers": [{"comments": [{"owner": {"reputation": 7517, "user_id": 3314095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nJlbV.png?s=128&g=1", "display_name": "XOR LX", "link": "https://stackoverflow.com/users/3314095/xor-lx"}, "edited": false, "score": 2, "creation_date": 1438238323, "post_id": 31713280, "comment_id": 51370728, "body": "Although it should be noted that using SUMPRODUCT rather than SUM would also suffice, and would not require array-entry."}, {"owner": {"reputation": 501, "user_id": 4810090, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/10153086352247107/picture?type=large", "display_name": "Jimmyn", "link": "https://stackoverflow.com/users/4810090/jimmyn"}, "reply_to_user": {"reputation": 7517, "user_id": 3314095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nJlbV.png?s=128&g=1", "display_name": "XOR LX", "link": "https://stackoverflow.com/users/3314095/xor-lx"}, "edited": false, "score": 0, "creation_date": 1438241560, "post_id": 31713280, "comment_id": 51372525, "body": "Thanks doug and @xor I decided to use sumproduct just for convenience. But used your formula doug cheers guys really appreciate it"}], "tags": [], "owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "is_accepted": true, "score": 4, "last_activity_date": 1438215470, "creation_date": 1438215470, "answer_id": 31713280, "question_id": 31712909, "link": "https://stackoverflow.com/questions/31712909/excel-array-from-cell-range/31713280#31713280", "title": "Excel Array from cell range", "body": "<p>Enter this as an array formula with <kbd>ctrl</kbd>-<kbd>shift</kbd>-<kbd>enter</kbd>:</p>\n\n<pre><code>=SUM(COUNTIFS(B1:B196,\"*\" &amp; A1:A2 &amp; \"*\",C1:C196,\"agree\"))\n</code></pre>\n"}], "owner": {"reputation": 501, "user_id": 4810090, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/10153086352247107/picture?type=large", "display_name": "Jimmyn", "link": "https://stackoverflow.com/users/4810090/jimmyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 31713280, "answer_count": 1, "score": 2, "last_activity_date": 1439185860, "creation_date": 1438212834, "last_edit_date": 1439185860, "question_id": 31712909, "link": "https://stackoverflow.com/questions/31712909/excel-array-from-cell-range", "title": "Excel Array from cell range", "body": "<p>Hi Guys I'm trying to tweak a formula. I need to change the hardcoded array to reference a cell range.</p>\n\n<pre><code>=SUM(COUNTIFS(B1:B196,{\"*yes*\",\"*no*\"},C1:C196,\"agree\"))\n</code></pre>\n\n<p>However I would like it to look like:</p>\n\n<pre><code>=SUM(COUNTIFS(B1:B196,A1;A2,C1:C196,\"agree\"))\n</code></pre>\n\n<p>The wild cards are important as I need to do a countif or within stings of text.</p>\n\n<p>Wouldn't mind a VBA soulution.</p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["vba", "email", "pdf", "gmail"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1438220219, "creation_date": 1438220219, "answer_id": 31713865, "question_id": 31712849, "link": "https://stackoverflow.com/questions/31712849/vba-code-to-send-email-through-gmail-with-pdf-attachment/31713865#31713865", "title": "VBA code to send email through gmail with pdf attachment", "body": "<p>If you are only looking for the first .PDF file found then something like this would be appropriate.</p>\n\n<pre><code>dim dr as string\ndr = \"C:\\Users\\123\\Desktop\\\"\nobjEmail.AddAttachment dr &amp; Dir(dr &amp; \"*.pdf\")\n</code></pre>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278779.aspx\" rel=\"nofollow\">Dir function</a> could loop and find all appropriate matches but it seems that you only want the first one. If Dir cannot find a matching file it will return a zero-length string.</p>\n\n<p>For additional functionality, you might want to use the <a href=\"https://msdn.microsoft.com/en-us/library/0fx287h4%28v=vs.90%29.aspx\" rel=\"nofollow\">Environ function</a> to get the current user's profile folder and get their Desktop folder from there.</p>\n"}], "owner": {"reputation": 11, "user_id": 5171332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7ee9c6f75efe54b98d8e59b76813320?s=128&d=identicon&r=PG&f=1", "display_name": "user48678", "link": "https://stackoverflow.com/users/5171332/user48678"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2774, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1438220219, "creation_date": 1438212530, "last_edit_date": 1438217397, "question_id": 31712849, "link": "https://stackoverflow.com/questions/31712849/vba-code-to-send-email-through-gmail-with-pdf-attachment", "title": "VBA code to send email through gmail with pdf attachment", "body": "<p>I have this code that is already working, but not 100%... I would like to send an email through Gmail with a pdf attached... But I don\u00b4t want a specific pdf file. </p>\n\n<p>I know I can put a specific file name on the code, but my pdf files always change the name </p>\n\n<p>Example: \n<code>Clientname_1.pdf, Clientmane_2.pdf, Suppliername_1.pdf, etc</code>  </p>\n\n<p>The code I have is this, but does not work:</p>\n\n<pre><code>Dim objEmail, objConfig\nSet objEmail = CreateObject(\"CDO.Message\")\n\nobjEmail.From = \"xpto@gmail.com\"\nobjEmail.To =     Join(Application.Transpose(Sheets(\"Clients\").Columns(7).SpecialCells(2)), \";\")\nobjEmail.Subject = \"Test\"\nobjEmail.CC = \"\"\nobjEmail.AddAttachment \"C:\\Users\\123\\Desktop\\*.pdf\"\n</code></pre>\n\n<p>I need that the code go to the folder I want and send the existing pdf file(s) on it...... </p>\n\n<p>What is missing in this code???</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 402, "user_id": 4555708, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75c3e6254a423100c074be583a775a51?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/4555708/gene"}, "edited": false, "score": 0, "creation_date": 1438260990, "post_id": 31720068, "comment_id": 51384928, "body": "You could also use the recordcount property to see if you have records:  IF rs.recordcount &gt; 0 then &lt;Do Something&gt;"}, {"owner": {"reputation": 402, "user_id": 4555708, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75c3e6254a423100c074be583a775a51?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/4555708/gene"}, "edited": false, "score": 0, "creation_date": 1438261281, "post_id": 31720068, "comment_id": 51385128, "body": "Just a note for those ADO, BOF will not work correctly to determine if you have no records. in ADO BOF and EOF are set to true if the rs is null. See documentation here: <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms675787(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a>"}], "tags": [], "owner": {"reputation": 710, "user_id": 5021236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16637c5be814c194e7dde84f653d36d7?s=128&d=identicon&r=PG&f=1", "display_name": "jhTuppeny", "link": "https://stackoverflow.com/users/5021236/jhtuppeny"}, "is_accepted": false, "score": 0, "last_activity_date": 1438248742, "creation_date": 1438248742, "answer_id": 31720068, "question_id": 31712573, "link": "https://stackoverflow.com/questions/31712573/ms-access-parameters-in-openrecordset-and-check-if-it-is-null/31720068#31720068", "title": "MS access: parameters in openrecordset and check if it is null", "body": "<p>You can see if a recordset has any records by using the BOF property. You can use the RecordCount to see how many records it has. With a DAO recordset you should use the .MoveLast method first e.g.</p>\n\n<pre><code>If rs.BOF Then &lt;Do Something&gt;\n\nrs.MoveLast\nMsgBox \"There are \" &amp; rs.RecordCount &amp; \" records.\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 402, "user_id": 4555708, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75c3e6254a423100c074be583a775a51?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/4555708/gene"}, "is_accepted": false, "score": 0, "last_activity_date": 1438262168, "last_edit_date": 1438262168, "creation_date": 1438261746, "answer_id": 31724729, "question_id": 31712573, "link": "https://stackoverflow.com/questions/31712573/ms-access-parameters-in-openrecordset-and-check-if-it-is-null/31724729#31724729", "title": "MS access: parameters in openrecordset and check if it is null", "body": "<p>Use the rs.RecordCount property.</p>\n\n<pre><code>IF rs.recordCount &gt; 0 then \n   rs.movelast\n   msg \"There are \" &amp; rs.recordCount &amp; \" record(s)\"\nend if\n</code></pre>\n\n<p>In DAO when you open recordset that contains records the value of RecordCount is 1. if there are no records or it cannot determine if there are records the value is 0. In ADO the if there are no records or it cannot determine the number of records RecordCount will return -1. Either way checking for greater than 0 will determine if you have records for ADO and DAO. </p>\n\n<p>BOF and EOF used seperately will not work for ADO, you could do it, but then you have to make two checks. if they are both true when you open the the recordset then your recordset is empty.  When an ADO recordset opens with no records both BOF and EOF are set to true. \n<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms675787(v=vs.85).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/windows/desktop/ms675787(v=vs.85).aspx</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 963, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1438262168, "creation_date": 1438210695, "question_id": 31712573, "link": "https://stackoverflow.com/questions/31712573/ms-access-parameters-in-openrecordset-and-check-if-it-is-null", "title": "MS access: parameters in openrecordset and check if it is null", "body": "<p>I am trying something like this below</p>\n\n<pre><code>formName = \"CutomerF\"\n checkboxName = \"Check110\"\n Dim rs As DAO.Recordset\n    Set rs = CurrentDb.OpenRecordset(\"SELECT * FROM CheckBoxT WHERE [Form Name] = \" &amp; formName &amp; \" AND [Checkbox Name] = \" &amp; checkboxName)\n</code></pre>\n\n<p>After the query, I want to check if rs is null or not? If it is not null then how many elements does it have? How can I do this?</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "is_accepted": false, "score": 11, "last_activity_date": 1438212240, "creation_date": 1438212240, "answer_id": 31712800, "question_id": 31711924, "link": "https://stackoverflow.com/questions/31711924/difference-between-the-on-open-event-and-the-on-load-event-for-a-data-entry/31712800#31712800", "title": "Difference between the &quot;On Open&quot; event and the &quot;On Load&quot; event for a data-entry Form", "body": "<p><strong>Open</strong></p>\n\n<p>Open happens before Load and allows you to cancel so it doesn't open. It also allows access to OpenArgs. This can be helpful if your form requires user input. If it is not supplied, you can cancel the Form.Open or prompt the user for needed values.</p>\n\n<pre><code>Private Sub Form_Open(Cancel As Integer)\n     If \"\" &amp; OpenArgs = \"\" Then\n         Cancel = True\n         Msgbox \"Open Arguments are required\"\n     End If \nEnd Sub\n</code></pre>\n\n<p><strong>Load</strong></p>\n\n<p>Load happens after Open and lacks any of the control Open provides.</p>\n\n<pre><code>Private Sub Form_Load()\n    Me.Caption = Date\nEnd Sub\n</code></pre>\n\n<p>You may want to use both Events. Use Open to get the input parameters, and use Load to set the values of controls based on those supplied parameters.</p>\n\n<p><strong>References</strong></p>\n\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/Bb214851(v=office.12).aspx\" rel=\"noreferrer\">Form.Open Event</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/Bb214828(v=office.12).aspx\" rel=\"noreferrer\">Form.Load Event</a></li>\n</ul>\n"}], "owner": {"reputation": 31, "user_id": 3568557, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N3ZNe.jpg?s=128&g=1", "display_name": "I Mosbee", "link": "https://stackoverflow.com/users/3568557/i-mosbee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14285, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1593593156, "creation_date": 1438207101, "last_edit_date": 1593593156, "question_id": 31711924, "link": "https://stackoverflow.com/questions/31711924/difference-between-the-on-open-event-and-the-on-load-event-for-a-data-entry", "title": "Difference between the &quot;On Open&quot; event and the &quot;On Load&quot; event for a data-entry Form", "body": "<p>I have designed a data-entry Form for conducting a survey.\nFor each survey question, only one answer can be selected from a list of multiple-choice answers.\nI have used an \"Option group\"(a set of radio buttons)Control for each set of multiple-choice answers such that each possible answer within the set has a radio button beside it which when clicked, would select that answer. \nWhenever the form is initially displayed(I'm not sure whether to say \"opened\" or \"loaded\") for use, I want each \"Option group\" to have none of its answers selected.\nI know the VBA code to use to achieve this. I wish to know the difference between the \"On Load\" event and the \"On Open\" event for any data-entry Form.\nAfter knowing the difference, I will know and understand which of these two events to apply the VBA code to.</p>\n"}, {"tags": ["c#", "vb.net", "vba", "visual-studio-2012"], "comments": [{"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1438207190, "post_id": 31711875, "comment_id": 51361748, "body": "did you try a google search..? if so what were you search parameters..? try this link and click on the VB example or convert the C# example into VB.NET <a href=\"https://msdn.microsoft.com/en-us/library/office/ff478190.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff478190.aspx</a>"}, {"owner": {"reputation": 4461, "user_id": 4424957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W3oNL.jpg?s=128&g=1", "display_name": "Blackwood", "link": "https://stackoverflow.com/users/4424957/blackwood"}, "edited": false, "score": 0, "creation_date": 1438208651, "post_id": 31711875, "comment_id": 51362342, "body": "Are you using Visual Studio or VBA in Word?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1438210631, "post_id": 31711875, "comment_id": 51363003, "body": "That&#39;s not VBA <i>or</i> C#"}, {"owner": {"reputation": 61, "user_id": 4921788, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/343694629151120/picture?type=large", "display_name": "Lam Lai", "link": "https://stackoverflow.com/users/4921788/lam-lai"}, "reply_to_user": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1438229146, "post_id": 31711875, "comment_id": 51367482, "body": "@MethodMan Yes. I have search the parameter and there is only two types. One asks for the file location while the other one asks for IO Stream"}, {"owner": {"reputation": 61, "user_id": 4921788, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/343694629151120/picture?type=large", "display_name": "Lam Lai", "link": "https://stackoverflow.com/users/4921788/lam-lai"}, "reply_to_user": {"reputation": 4461, "user_id": 4424957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W3oNL.jpg?s=128&g=1", "display_name": "Blackwood", "link": "https://stackoverflow.com/users/4424957/blackwood"}, "edited": false, "score": 0, "creation_date": 1438229239, "post_id": 31711875, "comment_id": 51367508, "body": "I am using VIsual Studio and I am designing an addin for MS Word, the constructor cannot use the file that is being used. @Blackwood"}], "answers": [{"tags": [], "owner": {"reputation": 960, "user_id": 5151278, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ilDIXFcHqdo/AAAAAAAAAAI/AAAAAAAADnQ/j3pEZAQLJ28/photo.jpg?sz=128", "display_name": "Maxime Port&#233;", "link": "https://stackoverflow.com/users/5151278/maxime-port%c3%a9"}, "is_accepted": false, "score": 0, "last_activity_date": 1438240555, "creation_date": 1438240555, "answer_id": 31717419, "question_id": 31711875, "link": "https://stackoverflow.com/questions/31711875/how-to-use-wordprocessingdocument-to-load-wordopenxml-in-string-form/31717419#31717419", "title": "how to use wordProcessingDocument to load wordopenxml (in string form)", "body": "<p>A word document is not just an xml file, it's an OPC (Open Packaging Convention), so you can't simply \"create the file from xml\".</p>\n\n<p>Eric White describe in his blog how to do that : <a href=\"http://blogs.msdn.com/b/ericwhite/archive/2008/09/29/transforming-flat-opc-format-to-open-xml-documents.aspx\" rel=\"nofollow\">http://blogs.msdn.com/b/ericwhite/archive/2008/09/29/transforming-flat-opc-format-to-open-xml-documents.aspx</a></p>\n\n<p>The principe is to create an empty file and then parse your xml to feed the opc file</p>\n"}], "owner": {"reputation": 61, "user_id": 4921788, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/343694629151120/picture?type=large", "display_name": "Lam Lai", "link": "https://stackoverflow.com/users/4921788/lam-lai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 743, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1438240555, "creation_date": 1438206898, "question_id": 31711875, "link": "https://stackoverflow.com/questions/31711875/how-to-use-wordprocessingdocument-to-load-wordopenxml-in-string-form", "title": "how to use wordProcessingDocument to load wordopenxml (in string form)", "body": "<p>So let's say in Microsoft Word VBA I got the openxml string using </p>\n\n<pre><code>Dim xmlstring as string = activedocument.range.wordopenxml\n</code></pre>\n\n<p>And now I want to create an wordProcessingdocument using this string.</p>\n\n<p>However, in the relevant webpage (<a href=\"https://msdn.microsoft.com/en-us/library/documentformat.openxml.packaging.wordprocessingdocument_members(v=office.14).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/documentformat.openxml.packaging.wordprocessingdocument_members(v=office.14).aspx</a>) I cannot find any info about constructing an wordprocessingdocument using a string. </p>\n\n<p>Can anyone teach me how to do this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 4, "creation_date": 1438206814, "post_id": 31711783, "comment_id": 51361593, "body": "<code>Range(&quot;N2:&quot; &amp; LastCell).Calculate</code>"}], "owner": {"reputation": 43, "user_id": 5165426, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zw7dN.jpg?s=128&g=1", "display_name": "Reed92", "link": "https://stackoverflow.com/users/5165426/reed92"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1438206494, "creation_date": 1438206494, "question_id": 31711783, "link": "https://stackoverflow.com/questions/31711783/how-to-determine-the-calculate-range-by-the-value-in-a-specific-cell", "title": "How to determine the Calculate Range by the Value in a specific cell", "body": "<p>I want to insert a button in excel and by clicking it I can recalculate a certain area ( The area is not determined, it depends on how many rows I pasted in the sheet.)</p>\n\n<p>I want to recalculate column N to V, From row 2 to the last row</p>\n\n<p>in the cell <code>X2</code> I will type in the row number.\nI hope I can pass this value to macro then determine the range</p>\n\n<p>However, <code>Range(\"N2:LastCell\").Calculate</code> is wrong.</p>\n\n<pre><code>Sub Calculate_selected()\nSheets(\"GPS Data\").Select\n\nDim rownumber As Integer\nDim LastCell As String\nrownumber = Range(\"X2\").Value\nLastCell = \"V\" &amp; rownumber\n\n\nRange(\"N2:LastCell\").Calculate\n\nEnd Sub\n</code></pre>\n\n<p>by the way, if I type 10 in cell <code>X2</code> and use <code>MsgBox LastCell</code> , it will show V10.</p>\n\n<p>Any suggestion is appreciated!!!</p>\n"}, {"tags": ["excel", "vba", "pdf"], "comments": [{"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 1, "creation_date": 1438205722, "post_id": 31711528, "comment_id": 51361118, "body": "What&#39;s your question exactly?"}, {"owner": {"reputation": 91, "user_id": 4569882, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-yAEU5a0t7ag/AAAAAAAAAAI/AAAAAAAAACA/w0RMdBXHDMo/photo.jpg?sz=128", "display_name": "Reed Rawlings", "link": "https://stackoverflow.com/users/4569882/reed-rawlings"}, "reply_to_user": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1438264016, "post_id": 31711528, "comment_id": 51387195, "body": "Bond, what a silly thing I missed ha. My code doesn&#39;t work.  I&#39;d like to be able to move down a filtered list and save what&#39;s displayed as a pdf for each filtered view. I&#39;ll only be moving down the contents of one column."}], "owner": {"reputation": 91, "user_id": 4569882, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-yAEU5a0t7ag/AAAAAAAAAAI/AAAAAAAAACA/w0RMdBXHDMo/photo.jpg?sz=128", "display_name": "Reed Rawlings", "link": "https://stackoverflow.com/users/4569882/reed-rawlings"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1119, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1438263965, "creation_date": 1438205535, "last_edit_date": 1438263965, "question_id": 31711528, "link": "https://stackoverflow.com/questions/31711528/filter-and-save-to-pdf-in-vba", "title": "Filter and Save to pdf in VBA", "body": "<p>I'd like to move through a filter and print out what appears on the filtered page to a pdf file before moving onto the next filter item. The idea driving this is that I need to report school building info for each district in my state. I currently have the data sitting in a table (could easily be a pivot with a slicer if that code works out better) with filters set up as I need. The length of columns will change as the district changes to account for varying sizes. Currently, my code does not work. I need help figuring out why. </p>\n\n<pre><code>Sub ShiftandPrint()\nDim i As Integer\ni = 1\n    For cl = 1 To Columns.Count\n        n = WorksheetFunction.CountA(Columns(cl))\n    Next\nDo While Cells(3, i).Value &lt;&gt; \"\"\n    With Sheet1\n        .AutoFilterMode = False\n        .Range(\"n\").AutoFilter\n        .Range(\"n\").AutoFilter Field:=1, Criteria1:=Cell(3, i)\n    End With\n\nDim fName As String\nWith ActiveSheet\nfName = .Range(\"A1\").Value &amp; .Range(\"A2\").Value\n.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n        \"C:\\My Documents\\\" &amp; fName, Quality:=xlQualityStandard, _\n        IncludeDocProperties:=True, IgnorePrintAreas:=False,       OpenAfterPublish:=False\nEnd With\ni = i + 1\nLoop\nEnd Sub\n</code></pre>\n\n<p>Thanks for any help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1438205620, "post_id": 31711485, "comment_id": 51361073, "body": "Which parts do you have written already? Will there only be a single asset number in each row?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1438205654, "post_id": 31711485, "comment_id": 51361083, "body": "use Regex: <a href=\"https://regex101.com/r/mF7bR2/1\" rel=\"nofollow noreferrer\">regex101.com/r/mF7bR2/1</a>"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1438205716, "post_id": 31711485, "comment_id": 51361115, "body": "Also, do you mean VBS or VBA? It sounds like you&#39;re talking about VBA..."}, {"owner": {"reputation": 23, "user_id": 5171140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ab6f498212265faab76fcfa6e7ec0cc?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Di Rienzo", "link": "https://stackoverflow.com/users/5171140/sean-di-rienzo"}, "edited": false, "score": 0, "creation_date": 1438206617, "post_id": 31711485, "comment_id": 51361492, "body": "VBA it would seem - thank you for clearing that up. There will only ever be one asset per row, sometimes there wont even be an asset in a row."}], "answers": [{"comments": [{"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1438206621, "post_id": 31711665, "comment_id": 51361494, "body": "I may be wrong, but by inspection this would crash on row C as it does not contain quotes."}, {"owner": {"reputation": 23, "user_id": 5171140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ab6f498212265faab76fcfa6e7ec0cc?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Di Rienzo", "link": "https://stackoverflow.com/users/5171140/sean-di-rienzo"}, "edited": false, "score": 0, "creation_date": 1438206676, "post_id": 31711665, "comment_id": 51361531, "body": "I understand what is being done here, but I cannot get it to work. I alt+F11, insert module and use that code. I get an error on the last line."}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "reply_to_user": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1438207196, "post_id": 31711665, "comment_id": 51361750, "body": "@DeanOC You are right of course, but the OP could add IF statements to the code. But others are happy to provide full-coded solutions ;)"}], "tags": [], "owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1438206027, "creation_date": 1438206027, "answer_id": 31711665, "question_id": 31711485, "link": "https://stackoverflow.com/questions/31711485/keep-everything-inbetween-quotations-in-an-excel-file/31711665#31711665", "title": "Keep everything inbetween quotations in an Excel file", "body": "<p>The following is written in VBA. For VBS you'll just need to change the Range references, and put it in a loop:</p>\n\n<pre><code>Sub Test()\n    Dim startQuote\n    Dim endQuote\n    startQuote = InStr(Range(\"A1\").Value, \"\"\"\")\n    endQuote = InStr(startQuote + 1, Range(\"A1\").Value, \"\"\"\")\n    Range(\"B1\").Value = Mid(Range(\"A1\").Value, startQuote + 1, endQuote - startQuote - 1)\nEnd Sub\n</code></pre>\n\n<p><code>InStr</code> is used to find the position of the first and second quote, <code>Mid</code> is used to extract the text between the quotes.</p>\n\n<p>The double quote needs to be quoted, which is why there are four quotes.</p>\n"}, {"tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": false, "score": 0, "last_activity_date": 1438206304, "creation_date": 1438206304, "answer_id": 31711742, "question_id": 31711485, "link": "https://stackoverflow.com/questions/31711485/keep-everything-inbetween-quotations-in-an-excel-file/31711742#31711742", "title": "Keep everything inbetween quotations in an Excel file", "body": "<p>(Assuming you mean VBA...)</p>\n\n<p>Add a reference to the <code>Microsoft VBScript Regular Expressions 5.5</code> library and you can use a regex to extract the asset ID. This assumes you have a single asset ID in column A, per row, and it will will put the extracted ID into column B.</p>\n\n<pre><code>Public Sub DoIt()\n\n    Dim re As New RegExp\n    re.Pattern = \"\"\"([^\"\"]+)\"\"\"\n\n    Dim intRow As Long\n    For intRow = 1 To 1000\n        If re.Test(Cells(intRow, 1)) Then\n            Cells(intRow, 2) = re.Execute(Cells(intRow, 1))(0).SubMatches(0)\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 5171140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ab6f498212265faab76fcfa6e7ec0cc?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Di Rienzo", "link": "https://stackoverflow.com/users/5171140/sean-di-rienzo"}, "edited": false, "score": 0, "creation_date": 1438206805, "post_id": 31711797, "comment_id": 51361589, "body": "thank you very much, your first solution worked beautifully. I will study it to understand what is being done. Just need to brush up on some of the syntax."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 23, "user_id": 5171140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ab6f498212265faab76fcfa6e7ec0cc?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Di Rienzo", "link": "https://stackoverflow.com/users/5171140/sean-di-rienzo"}, "edited": false, "score": 0, "creation_date": 1438207315, "post_id": 31711797, "comment_id": 51361806, "body": "@SeanDiRienzo I&#39;ve removed the VBS code and tried to explain what&#39;s happening so that you can understand some of it..."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 3, "last_activity_date": 1438207278, "last_edit_date": 1438207278, "creation_date": 1438206539, "answer_id": 31711797, "question_id": 31711485, "link": "https://stackoverflow.com/questions/31711485/keep-everything-inbetween-quotations-in-an-excel-file/31711797#31711797", "title": "Keep everything inbetween quotations in an Excel file", "body": "<p>This will do you:</p>\n\n<p><em><strong>VBA</strong></em>  </p>\n\n<pre><code>Sub SO()\n\nDim RE As Object, i As Long\nSet RE = CreateObject(\"VBScript.RegExp\")\n\nWith RE\n    .Pattern = \"\"\".*\"\"\"\n    .Global = True\n    .IgnoreCase = True\nEnd With\n\nFor i = 1 To Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    If RE.Test(Cells(i, 1).Value) Then\n        With Cells(i, 1)\n            .Value = Replace(RE.Execute(.Value)(0), \"\"\"\", \"\")\n        End With\n    Else\n        Cells(i, 1).ClearContents\n    End If\nNext\n\nRange(\"A1:A\" &amp; Cells(Rows.Count, 1).End(xlUp).Row).SpecialCells(xlCellTypeBlanks).EntireRow.Delete shift:=xlUp\n\nEnd Sub\n</code></pre>\n\n<p><code>VBScript.RegExp</code> is just a Regular Expression engine that allows you to match patterns in a string (I'd be surprised if you haven't come across this before in C++ or Java...). You can set a reference to this but for ease I've gone with the late-binding option.</p>\n\n<p>To try and explain, the code is looping through each cell in column A and performing a RegEx test against it. If the pattern matches, it replaces the value of the cell with the match - if the pattern <em>doesn't</em> match then it clears the contents of the cell.  </p>\n\n<p>Finally, we use Excel's <code>SpecialCells</code> method to identify any blank cells in column A and at the same time delete the row that they belong to.  </p>\n\n<p>If it makes it easier, the loop in Java would probably look something like this I imagine:  </p>\n\n<pre><code>for(var i = 0; i &lt;= 1000; i++){\n    if(RE.Test(Excel.Workbooks.ActiveWorkbook.Cells(i, 1).Value2)){\n        // Blah blah....\n    }\n}\n</code></pre>\n\n<p><em>(I don't write Java in case you haven't noticed...)</em></p>\n"}], "owner": {"reputation": 23, "user_id": 5171140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ab6f498212265faab76fcfa6e7ec0cc?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Di Rienzo", "link": "https://stackoverflow.com/users/5171140/sean-di-rienzo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 31711797, "answer_count": 3, "score": 2, "last_activity_date": 1438207278, "creation_date": 1438205362, "last_edit_date": 1438206847, "question_id": 31711485, "link": "https://stackoverflow.com/questions/31711485/keep-everything-inbetween-quotations-in-an-excel-file", "title": "Keep everything inbetween quotations in an Excel file", "body": "<p>I have an Excel file (xlsx) with one column and a thousand rows. </p>\n\n<p>Example:</p>\n\n\n\n<pre class=\"lang-none prettyprint-override\"><code>row A| oulzdwdwjdwojd=.\"A180202\"wodwdojwdowj\nrow B| dwodjwodjwdowj-.\"N310302\"wdwdwdwdwdw\nrow C| wdowduwoduwoduwdowudowudwoduwoduwdouw\nrow D| woduwoduwdowu-\"N330201\"\n</code></pre>\n\n<p>There is a lot of junk mixed in with asset numbers between quotations. I am needing to remove everything except for what's inside of the quotations. Leaving me with something like</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>row A| A180202\nrow B| N310302\nrow C| N330201\n</code></pre>\n\n<p>I am a complete beginner to VBS. I believe that I could write a program to do this in C++ or Java but do not know how to complete such a task with VBScript that is part of Excel. I have obtained similar results using the Excel tools in the GUI but nothing that leaves me with exactly what I need.</p>\n\n<p>How would I go about doing something like this in VBScript? I would guess I have to use a delimiter with left, right or replace.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 53, "user_id": 5041159, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f276fe49f9e05eeb4b93226e706f7ca6?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/5041159/victor"}, "edited": false, "score": 0, "creation_date": 1438206676, "post_id": 31711352, "comment_id": 51361532, "body": "Sub Leaves() Dim i As Integer Dim g As Integer Dim Quantity As Integer Dim Executed As Integer Dim Leaves As Integer i = 1 g = 1     Do While i &lt; 8000         Quantity = Worksheets(&quot;Sheet1&quot;).Cells(i, 3).value         Executed = Worksheets(&quot;Sheet1&quot;).Cells(i, 5).value         Leaves = Quantity - Executed         If Leaves &gt; 0 Then         Worksheets(&quot;Sheet2&quot;).Cells(g, 1).value = Worksheets(&quot;Sheet1&quot;).Cells(i, 9).value &amp; Worksheets(&quot;Sheet2&quot;).Cells(i, 2).value &amp; Leaves &amp; Worksheets(&quot;Sheet2&quot;).Cells(i, 3).value         g = g + 1         End If         i = i + 1     Loop End Sub"}, {"owner": {"reputation": 53, "user_id": 5041159, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f276fe49f9e05eeb4b93226e706f7ca6?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/5041159/victor"}, "edited": false, "score": 0, "creation_date": 1438206692, "post_id": 31711352, "comment_id": 51361541, "body": "I am now getting a mismatch error for some reason."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1438210763, "post_id": 31711352, "comment_id": 51363045, "body": "To include code <i>add it to your question</i>.  Code in comments typically gets ignored."}, {"owner": {"reputation": 841, "user_id": 3633799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf3c5795e0c55e5c31ed7fa75abc8da5?s=128&d=identicon&r=PG&f=1", "display_name": "Jane", "link": "https://stackoverflow.com/users/3633799/jane"}, "edited": false, "score": 0, "creation_date": 1438255900, "post_id": 31711352, "comment_id": 51381517, "body": "What is the problem that you&#39;re having? Does the code above do what you want?"}], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 0, "last_activity_date": 1438258791, "last_edit_date": 1495542119, "creation_date": 1438258791, "answer_id": 31723625, "question_id": 31711352, "link": "https://stackoverflow.com/questions/31711352/subtract-two-columns-with-each-other-as-a-condition-and-append-values/31723625#31723625", "title": "Subtract two columns, with each other as a condition, and append values", "body": "<p>It is helpful if you say what line is throwing an error. Also, one should strive to create a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, complete, and verifiable example</a>. The effort to do so often resolves the question before you need to post it.</p>\n\n<p>The code itself seems fine and it runs for me (on an empty workbook) with no type mismatch. Thus, the problem must be with your assumptions about the spreadsheet.</p>\n\n<p>Either of the lines</p>\n\n<pre><code>Quantity = Worksheets(\"Sheet1\").Cells(i, 3).value\nExecuted = Worksheets(\"Sheet1\").Cells(i, 5).value\n</code></pre>\n\n<p>will trigger a type mismatch if the corresponding value can't be converted to an integer. This could happen, for example, if one of the cells contains a string (other than something like \"1\") or an error value such as #N/A or #Value!.</p>\n\n<p>The line which begins</p>\n\n<pre><code>Worksheets(\"Sheet2\").Cells(g, 1).value = _  \n</code></pre>\n\n<p>will throw a type mismatch if one of the values being concatenated can't be converted to a string. An error value in one of the cells is the most likely culprit. If this is the case and for some reason you actually want to create a string that includes substrings which look like e.g. \"#N/A\" then you could use the <code>Text</code> property of those cells rather than <code>Value</code>.</p>\n"}], "owner": {"reputation": 53, "user_id": 5041159, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f276fe49f9e05eeb4b93226e706f7ca6?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/5041159/victor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1066, "favorite_count": 0, "accepted_answer_id": 31723625, "answer_count": 1, "score": 1, "last_activity_date": 1499756684, "creation_date": 1438204810, "last_edit_date": 1499756684, "question_id": 31711352, "link": "https://stackoverflow.com/questions/31711352/subtract-two-columns-with-each-other-as-a-condition-and-append-values", "title": "Subtract two columns, with each other as a condition, and append values", "body": "<p>I need to subtract two columns from a large array and see which ones are positive and of those positive values I need to find the positive values row and append a few things onto that value.</p>\n\n<p>Here is the general concept I'm thinking so far</p>\n\n<blockquote>\n  <p>While &lt; 8000<br>\n  if (cell(i,1).Value - cell(i,2) > 0)<br>\n  print in another sheet cell(i,3).value (cell(i,2).Value-cell(i,4)) cell.value(i,4) </p>\n</blockquote>\n\n<p>for example...<br>\nsuppose I have something like this<br>\n[2 2 hi yo]<br>\n[3 2 go mo]</p>\n\n<p>this macro would return \"go 1 mo\" in another sheet.</p>\n\n<pre><code>Sub Leaves()\nDim i As Integer\nDim g As Integer\nDim Quantity As Integer\nDim Executed As Integer\nDim Leaves As Integer\n\ni = 1\ng = 1\n\nDo While i &lt; 8000\n    Quantity = Worksheets(\"Sheet1\").Cells(i, 3).value\n    Executed = Worksheets(\"Sheet1\").Cells(i, 5).value\n    Leaves = Quantity - Executed\n    If Leaves &gt; 0 Then\n        Worksheets(\"Sheet2\").Cells(g, 1).value = _\n            Worksheets(\"Sheet1\").Cells(i, 9).value &amp; _\n            Worksheets(\"Sheet2\").Cells(i, 2).value &amp; _\n            Leaves &amp; Worksheets(\"Sheet2\").Cells(i, 3).value\n        g = g + 1\n    End If\n    i = i + 1\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>The above code gives me a <code>Type mismatch</code> error.</p>\n"}, {"tags": ["excel", "domdocument", "xmlhttprequest", "vba"], "comments": [{"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1438205816, "post_id": 31711030, "comment_id": 51361150, "body": "ehh...loading that URL up in Explorer does not give me any XML. Perhaps that&#39;s your issue?"}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "reply_to_user": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1438224090, "post_id": 31711030, "comment_id": 51366166, "body": "Ah. I was getting an xPath of two items I&#39;m looking to scrape, so I had assumed I could have retrieved them that way. Am I doomed to try to sort through the HTML unserialized?"}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "reply_to_user": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1438225695, "post_id": 31711030, "comment_id": 51366616, "body": "Nevermind on this - I can get the data through C# and HtmlAgilityPack. Just need to deploy an Add-In is all."}], "owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1438203620, "creation_date": 1438203620, "last_edit_date": 1531161705, "question_id": 31711030, "link": "https://stackoverflow.com/questions/31711030/domdocument-incorrect-syntax-was-used-in-a-comment", "title": "DOMDocument Incorrect Syntax was used in a comment", "body": "<p>I'm writing a \"quick\" scraper in excel, but I can't load the XML from Wall Street Journal. I'm getting the error message \"Incorrect Syntax was used in a comment\" from this code.</p>\n\n<pre><code>Dim xmlReq As MSXML2.XMLHTTP60: Set xmlReq = New MSXML2.XMLHTTP60\n\nDim xmlDoc As MSXML2.DOMDocument60: Set xmlDoc = New MSXML2.DOMDocument60\nxmlDoc.async = False\nxmlDoc.resolveExternals = True\nxmlDoc.setProperty \"ProhibitDTD\", False\n\nWith xmlReq\n    .Open \"GET\", \"http://online.wsj.com/mdc/public/page/2_3023-cashprices-20150101.html?mod=mdc_pastcalendar\", False\n    .send \"\"\n    Debug.Print .statusText\n    If Not xmlDoc.LoadXML(.responseText) Then\n        Err.Raise xmlDoc.parseError.ErrorCode, , xmlDoc.parseError.reason\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>I'm assuming this is because there's a \"--\" in the WSJ's xml, but is there any way I can suppress this error?</p>\n\n<p>I normally would do this through a COM Add-in, but I'm only grabbing two Cash Prices, so it's not worth the hassle. Maybe it is? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 1, "creation_date": 1438202147, "post_id": 31710361, "comment_id": 51359206, "body": "This will be tough to do in a way the scales well with formulas. The primary bottleneck is the limitations that concatenate has. Otherwise you could extract your values into an area and then concatenate with a delimiter. You have added the <code>excel-vba</code> tag but only mention a formula. Are you open to using VBA for this purpose?"}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1438207133, "post_id": 31710361, "comment_id": 51361726, "body": "You could do two separate columns (one for initial, one for followup) with =IF((meeting column) &lt;&gt; 0, date, ), then do advanced filter and get the uniques from both of those columns to have easily accessible lists, but VBA would be your friend here."}, {"owner": {"reputation": 33, "user_id": 5074684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cb0d05cc41859cbecfc09412ba6d4f3?s=128&d=identicon&r=PG&f=1", "display_name": "Reg Robinson", "link": "https://stackoverflow.com/users/5074684/reg-robinson"}, "edited": false, "score": 0, "creation_date": 1438276436, "post_id": 31710361, "comment_id": 51395765, "body": "I&#39;m definitely open to using VBA!  I just was not sure if it could be done with formulas.  I&#39;m fairly new to VBA, so any help would be appreciated."}], "answers": [{"comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 1, "creation_date": 1438203151, "post_id": 31710551, "comment_id": 51359767, "body": "The solution linked outputs as an array or a sum of values. You would need intermediary columns to then join on a final cell. Doesn&#39;t seem exactly what OP was requesting."}, {"owner": {"reputation": 33, "user_id": 5074684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cb0d05cc41859cbecfc09412ba6d4f3?s=128&d=identicon&r=PG&f=1", "display_name": "Reg Robinson", "link": "https://stackoverflow.com/users/5074684/reg-robinson"}, "edited": false, "score": 0, "creation_date": 1438276503, "post_id": 31710551, "comment_id": 51395801, "body": "I&#39;ve tried the technique described in your link, but for some reason it&#39;s not working for my data.  I&#39;m not concerned about portability as this spreadsheet is only for me.  Do you have any tips on how this could be done using VBA?"}, {"owner": {"reputation": 33, "user_id": 5074684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cb0d05cc41859cbecfc09412ba6d4f3?s=128&d=identicon&r=PG&f=1", "display_name": "Reg Robinson", "link": "https://stackoverflow.com/users/5074684/reg-robinson"}, "edited": false, "score": 0, "creation_date": 1438277352, "post_id": 31710551, "comment_id": 51396306, "body": "If you are willing, I would absolutely appreciate any help! Portability is definitely not an issue for me at all, nor is macro security, as I do not plan to share this sheet with anyone."}, {"owner": {"reputation": 1331, "user_id": 2946845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9e046d4607e289fcb6989d7a563723f?s=128&d=identicon&r=PG&f=1", "display_name": "SteJ", "link": "https://stackoverflow.com/users/2946845/stej"}, "edited": false, "score": 0, "creation_date": 1438281184, "post_id": 31710551, "comment_id": 51398458, "body": "I&#39;ve updated my answer with a more appropriate solution (I&#39;ve left the other link that wasn&#39;t quite what you wanted at the bottom of the page in case it&#39;s useful to others)"}, {"owner": {"reputation": 33, "user_id": 5074684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cb0d05cc41859cbecfc09412ba6d4f3?s=128&d=identicon&r=PG&f=1", "display_name": "Reg Robinson", "link": "https://stackoverflow.com/users/5074684/reg-robinson"}, "edited": false, "score": 0, "creation_date": 1438801396, "post_id": 31710551, "comment_id": 51603030, "body": "Thank you so much SteJ - This is perfect and exactly what I was looking for!"}, {"owner": {"reputation": 1331, "user_id": 2946845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9e046d4607e289fcb6989d7a563723f?s=128&d=identicon&r=PG&f=1", "display_name": "SteJ", "link": "https://stackoverflow.com/users/2946845/stej"}, "edited": false, "score": 0, "creation_date": 1438905808, "post_id": 31710551, "comment_id": 51654455, "body": "Glad I could help - any chance of an &quot;accepted answer&quot;?"}], "tags": [], "owner": {"reputation": 1331, "user_id": 2946845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9e046d4607e289fcb6989d7a563723f?s=128&d=identicon&r=PG&f=1", "display_name": "SteJ", "link": "https://stackoverflow.com/users/2946845/stej"}, "is_accepted": false, "score": 0, "last_activity_date": 1438905919, "last_edit_date": 1438905919, "creation_date": 1438201984, "answer_id": 31710551, "question_id": 31710361, "link": "https://stackoverflow.com/questions/31710361/returning-multiple-values-using-vlookup-in-excel/31710551#31710551", "title": "Returning multiple values using Vlookup in excel", "body": "<p>You can't do this with vLookup.</p>\n\n<p>This can be done relatively easily in a VB script, but it would affect portability as many if not most users disable macros by default and in many cases users are prevented from using Macros because their company disables them and makes it policy that users should not use them.</p>\n\n<p>If you are OK with Macros, you can put the following into a <em>new module</em> and then use <code>=MultiVlookup(lookup_value,table_array, col_index_num)</code> in the same way as you'd use vlookup and it should give you a comma separated list of multiple matches:</p>\n\n<pre><code>Public Function MultiVlookup(find_value, search_range, return_row)\n  Dim myval ' String to represent return value (comma-separated list)\n  Dim comma ' Bool to represent whether we need to prefix the next result with \", \"\n  comma = False\n  'Debug.Print find_value.value, return_row\n  For Each rw In search_range.Rows ' Iterate through each row in the range\n    If rw.Cells(1, 1).value = find_value Then ' If we have found the lookup value...\n      If comma Then  ' Add a comma if it's not the first value we're adding to the list\n        myval = myval + \", \"\n      Else\n        comma = True\n      End If\n      myval = myval + Str(rw.Cells(1, return_row).value)\n    End If\n  Next\n  MultiVlookup = myval\nEnd Function\n</code></pre>\n\n<p>This may not be the cleanest way of doing it, and it isn't a direct copy of vlookup (for instance it does not have a fourth \"range lookup\" argument as vlookup does), but it works for my test:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9uxoY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9uxoY.png\" alt=\"enter image description here\"></a></p>\n\n<p>Finally my original suggestion (in case it helps others - it's not the exact solution to the question) was:</p>\n\n<p>I've not tried it myself, but <a href=\"http://www.globaliconnect.com/excel/index.php?option=com_content&amp;view=article&amp;id=119:vlookup-multiple-values-return-multiple-corresponding-values-for-one-lookup-value&amp;catid=77&amp;Itemid=473\" rel=\"nofollow noreferrer\">this link</a> shows what I think you might be looking for.</p>\n"}], "owner": {"reputation": 33, "user_id": 5074684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cb0d05cc41859cbecfc09412ba6d4f3?s=128&d=identicon&r=PG&f=1", "display_name": "Reg Robinson", "link": "https://stackoverflow.com/users/5074684/reg-robinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4835, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463651197, "creation_date": 1438201279, "last_edit_date": 1531161705, "question_id": 31710361, "link": "https://stackoverflow.com/questions/31710361/returning-multiple-values-using-vlookup-in-excel", "title": "Returning multiple values using Vlookup in excel", "body": "<p>I have an excel sheet set up to automatically calculate meetings per day by day of the week.  I would like to write a formula to return all dates I have a meeting scheduled (comma separated preferably), but I am having some difficulty.  Using Vlookup, I can only get it to return the first date.</p>\n\n<p>For example, here is what my data looks like:</p>\n\n<pre><code>         A                                 B                            C\n Initial Meetings          Follow-up Meetings            Date\n         1                                1                       7/29/2015\n         0                                1                       7/30/2015\n         1                                1                       7/31/2015\n         0                                0                       8/1/2015\n         0                                0                       8/2/2015\n</code></pre>\n\n<p>I would like to write a formula to return \"7/29/2015, 7/31/2015\" in one cell, and \"7/29/2015, 7/30/2015, 7/31/2015\" in another, but I seem to be stuck.</p>\n"}, {"tags": ["regex", "vba", "email", "outlook", "multiple-matches"], "comments": [{"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1438200496, "post_id": 31709964, "comment_id": 51358300, "body": "My head hurts just trying to decipher that regex. Why aren&#39;t you just using something like: <code>&quot;\\[Spool File No\\. (\\d{1,4})&quot;</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5167561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9415c65ca5e2ba5b812c701ded92e3d5?s=128&d=identicon&r=PG&f=1", "display_name": "airjavier", "link": "https://stackoverflow.com/users/5167561/airjavier"}, "edited": false, "score": 0, "creation_date": 1438201639, "post_id": 31710273, "comment_id": 51358950, "body": "This worked magic.  Thanks so much for the much cleaner solution than the convoluted mess I had going."}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 21, "user_id": 5167561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9415c65ca5e2ba5b812c701ded92e3d5?s=128&d=identicon&r=PG&f=1", "display_name": "airjavier", "link": "https://stackoverflow.com/users/5167561/airjavier"}, "edited": false, "score": 0, "creation_date": 1438201773, "post_id": 31710273, "comment_id": 51359018, "body": "No problem. You can specify literal values in your pattern (like <code>Spool File No</code>). Just be aware of regex-reserved characters like <code>[</code> and <code>.</code>, which must be escaped. Also, generally, you only need to use parentheses around things you want to capture (these are known as <i>capture groups</i>) and those groups will appear in the <code>SubMatches</code> collection. Since you only care about the digits, just put parens around that portion alone."}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": true, "score": 1, "last_activity_date": 1438200951, "creation_date": 1438200951, "answer_id": 31710273, "question_id": 31709964, "link": "https://stackoverflow.com/questions/31709964/outlook-2010-vba-using-regex-to-return-multiple-matches-within-email-body/31710273#31710273", "title": "Outlook 2010 VBA - Using RegEx to return multiple matches within email body", "body": "<p>This should match the digits found in all occurrences of <code>[Spool File No. XXXX</code>:</p>\n\n<pre><code>Dim r As New RegExp\nr.Pattern = \"\\[Spool File No\\. (\\d{1,4})\"\nr.Global = True\n\nDim m As Match, c As MatchCollection\nSet c = r.Execute(olMail.Body)\n\nFor Each m In c\n    MsgBox m.SubMatches(0)\nNext\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5167561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9415c65ca5e2ba5b812c701ded92e3d5?s=128&d=identicon&r=PG&f=1", "display_name": "airjavier", "link": "https://stackoverflow.com/users/5167561/airjavier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 783, "favorite_count": 0, "accepted_answer_id": 31710273, "answer_count": 1, "score": 1, "last_activity_date": 1438200951, "creation_date": 1438199850, "last_edit_date": 1438200648, "question_id": 31709964, "link": "https://stackoverflow.com/questions/31709964/outlook-2010-vba-using-regex-to-return-multiple-matches-within-email-body", "title": "Outlook 2010 VBA - Using RegEx to return multiple matches within email body", "body": "<p>I receive multiple emails daily that have the following string within the body:</p>\n\n<pre><code>[Spool File No. ####\n</code></pre>\n\n<p>where <code>####</code> is an integer anywhere from 1 to 2000</p>\n\n<p>Sometimes, there is only one such string within the body, sometimes there are more with the only difference being the integer.</p>\n\n<p>I am new to VBA as a whole, but have come up with the following in order to find the string containing the integer and output a msgbox with the integer value, however I need to find all instances of the match for the emails that have more than one integer value.</p>\n\n<pre><code>Sub Find_Spool_Number()\n  Dim olMail As Outlook.MailItem\n  Dim re1 As String\n  re1 = \"(\\[)\"  'Any Single Character 1\n  Dim re2 As String\n  re2 = \"((?:[a-z][a-z]+))\" 'Word 1\n  Dim re3 As String\n  re3 = \"(\\s+)\" 'White Space 1\n  Dim re4 As String\n  re4 = \"((?:[a-z][a-z]+))\" 'Word 2\n  Dim re5 As String\n  re5 = \"(\\s+)\" 'White Space 2\n  Dim re6 As String\n  re6 = \"((?:[a-z][a-z]+))\" 'Word 3\n  Dim re7 As String\n  re7 = \"(\\.)\"  'Any Single Character 2\n  Dim re8 As String\n  re8 = \"(\\s+)\" 'White Space 3\n  Dim re9 As String\n  re9 = \"(\\d+)\" 'Integer Number 1\nSet olMail = Application.ActiveExplorer().Selection(1)\n  Dim r As New RegExp\n\n  With r\n  .Pattern = re1 + re2 + re3 + re4 + re5 + re6 + re7 + re8 + re9\n  .IgnoreCase = True\n  .MultiLine = False\n  .Global = True\n  End With\n\n  Dim m As MatchCollection\n  Set m = r.Execute(olMail.Body)\n  If m.Item(0).SubMatches.Count &gt; 0 Then\n      Dim c1\n      c1 = m.Item(0).SubMatches.Item(0)\n      Dim word1\n      word1 = m.Item(0).SubMatches.Item(1)\n      Dim ws1\n      ws1 = m.Item(0).SubMatches.Item(2)\n      Dim word2\n      word2 = m.Item(0).SubMatches.Item(3)\n      Dim ws2\n      ws2 = m.Item(0).SubMatches.Item(4)\n      Dim word3\n      word3 = m.Item(0).SubMatches.Item(5)\n      Dim c2\n      c2 = m.Item(0).SubMatches.Item(6)\n      Dim ws3\n      ws3 = m.Item(0).SubMatches.Item(7)\n      Dim int1\n      int1 = m.Item(0).SubMatches.Item(8)\n      MsgBox (\"\" + c1 + \"\" + \"\" + word1 + \"\" + \"\" + ws1 + \"\" + \"\" + word2 + \"\" + \"\" + ws2 + \"\" + \"\" + word3 + \"\" + \"\" + c2 + \"\" + \"\" + ws3 + \"\" + \"\" + int1 + \"\" + \"\")\n\n     Dim MyData As DataObject\n     Set MyData = New DataObject\n\n    MyData.SetText int1\n    MyData.PutInClipboard\n\n  End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1438199950, "post_id": 31709919, "comment_id": 51357983, "body": "Can you post any code or other things you have tried so far?  You can set a range, and have VBA loop through that with <code>For each cel in rng</code> (see <a href=\"https://msdn.microsoft.com/en-us/library/office/Aa221353(v=office.11).aspx\" rel=\"nofollow noreferrer\">this page</a> for some more info on looping)."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1438207372, "post_id": 31709919, "comment_id": 51361842, "body": "Which column does do not buy occur?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5170827, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-f-Dz16T8jfY/AAAAAAAAAAI/AAAAAAAAB3M/czmyXNFmUZo/photo.jpg?sz=128", "display_name": "Ian Hancock", "link": "https://stackoverflow.com/users/5170827/ian-hancock"}, "edited": false, "score": 0, "creation_date": 1438700780, "post_id": 31712062, "comment_id": 51551137, "body": "Thanks! This works perfectly in targeting the first string but I need it to before the first occurrence only. This inserts rows after every occurrence of &quot;DO NOT BUY&quot;"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 11, "user_id": 5170827, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-f-Dz16T8jfY/AAAAAAAAAAI/AAAAAAAAB3M/czmyXNFmUZo/photo.jpg?sz=128", "display_name": "Ian Hancock", "link": "https://stackoverflow.com/users/5170827/ian-hancock"}, "edited": false, "score": 0, "creation_date": 1438704156, "post_id": 31712062, "comment_id": 51553602, "body": "Wait. If you only need to insert one row, why use macro. Just manually search from top and insert it..."}, {"owner": {"reputation": 11, "user_id": 5170827, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-f-Dz16T8jfY/AAAAAAAAAAI/AAAAAAAAB3M/czmyXNFmUZo/photo.jpg?sz=128", "display_name": "Ian Hancock", "link": "https://stackoverflow.com/users/5170827/ian-hancock"}, "edited": false, "score": 0, "creation_date": 1438704174, "post_id": 31712062, "comment_id": 51553611, "body": "Perfect. Thank you for the help!"}, {"owner": {"reputation": 11, "user_id": 5170827, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-f-Dz16T8jfY/AAAAAAAAAAI/AAAAAAAAB3M/czmyXNFmUZo/photo.jpg?sz=128", "display_name": "Ian Hancock", "link": "https://stackoverflow.com/users/5170827/ian-hancock"}, "edited": false, "score": 0, "creation_date": 1438716779, "post_id": 31712062, "comment_id": 51560763, "body": "Just to answer your question, this is one step in one large series of code that formats a report varied length (but often as large as 3000 rows). There is a standard way that we format it but it has been, until now, manual and can take anywhere from 10-40 minutes. I am trying to automate as many steps as possible so other people can use it easily."}], "tags": [], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "is_accepted": true, "score": 0, "last_activity_date": 1438702756, "last_edit_date": 1438702756, "creation_date": 1438207845, "answer_id": 31712062, "question_id": 31709919, "link": "https://stackoverflow.com/questions/31709919/insert-row-after-first-occurence-of-partial-string/31712062#31712062", "title": "Insert Row after first occurence of partial String", "body": "<pre><code>Sub insert()\n\nDim lastRow As Long\nDim done As Boolean\n\n'change A to the longest column (most rows)\nlastRow = ActiveSheet.Cells(ActiveSheet.Rows.Count, \"A\").End(xlUp).Row\n\nFor i = 1 To lastRow\n    'change the 1 below to the necessary column (ie, use 4 for column D)\n    If Left(Cells(i, 1), 10) = \"DO NOT BUY\" Then\n    Rows(i).insert\n    done = True\n    i = i + 1\n    End If\n    If done = True Then Exit For\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5170827, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-f-Dz16T8jfY/AAAAAAAAAAI/AAAAAAAAB3M/czmyXNFmUZo/photo.jpg?sz=128", "display_name": "Ian Hancock", "link": "https://stackoverflow.com/users/5170827/ian-hancock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "accepted_answer_id": 31712062, "answer_count": 1, "score": -1, "last_activity_date": 1438702756, "creation_date": 1438199715, "last_edit_date": 1438203513, "question_id": 31709919, "link": "https://stackoverflow.com/questions/31709919/insert-row-after-first-occurence-of-partial-string", "title": "Insert Row after first occurence of partial String", "body": "<p>I am working with a variably lengthed weekly report. The columns are fixed but the number of rows changes. I need to format it so that different categories are separated by blank lines. On Each column that contains data to be separated I have code that finds a the first appearance of a string of text and then inserts two or three rows above it. </p>\n\n<p>This has worked until I get to a section of data that is identified by the phrase \"DO NOT BUY\". \"DO NOT BUY\" is then followed (in the same cell) by \n\"-<em>reason we're not buying</em>\".</p>\n\n<p>As I still want all do not buys grouped together, I need something that pulls just the first part of the string. I have tried to adapt my current solution to utilize the left function (Find first occurrence where Left(Columns.AB:AB,10)=\"DO NOT BUY\" and then insert row)   but I can't figure out how to make Left loop through the whole column rather than one cell...</p>\n\n<p>Below is the code I have currently for finding and inserting rows. </p>\n\n<pre><code>Sub InsertBeforeGS()\nDim FindString As String\nDim rng As Range\nFindString = \"GS\"\nIf Trim(FindString) &lt;&gt; \"\" Then\n    With ActiveSheet.Range(\"AB:AB\")\n        Set rng = .Find(What:=FindString, _\n                        After:=.Cells(.Cells.Count), _\n                        LookIn:=xlValues, _\n                        Lookat:=xlWhole, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlNext, _\n                        MatchCase:=False)\n        If Not rng Is Nothing Then\n            Application.GoTo rng, True\n            ActiveCell.EntireRow.Insert\nActiveCell.EntireRow.Insert\nActiveCell.EntireRow.Insert\n        Else\n        End If\n    End With\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba"], "comments": [{"owner": {"reputation": 25, "user_id": 5170702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90bdac14071049be50f87d6e7791ff98?s=128&d=identicon&r=PG&f=1", "display_name": "Clay", "link": "https://stackoverflow.com/users/5170702/clay"}, "edited": false, "score": 0, "creation_date": 1438262575, "post_id": 31708831, "comment_id": 51386047, "body": "Thanks! Just as ChipsLetten said, I was missing the <code>Preserve</code> keyword. Tim&#39;s works great for printing out the numbers 1 to 100; I should&#39;ve made it more clear that I was working with an array of 100 values."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1438197364, "creation_date": 1438197364, "answer_id": 31709233, "question_id": 31708831, "link": "https://stackoverflow.com/questions/31708831/a-loop-for-modifying-and-printing-an-array-in-vba/31709233#31709233", "title": "A loop for modifying and printing an array in VBA", "body": "<p>Slightly different approach:</p>\n\n<pre><code>Sub Tester()\n\n    Dim data(100), i, last_age, sht As Worksheet, q, m\n\n    'fill test array\n    For i = 1 To 100: data(i - 1) = i: Next\n\n    Set sht = Sheets(\"Sheet1\")\n    last_age = 100\n\n    q = 1\n    sht.Cells(q, 1).Resize(1, UBound(data) + 1) = data\n\n    For m = 2 To last_age\n\n        q = q + 1\n        sht.Cells(1, 1).Offset(0, m - 1).Resize( _\n             1, (UBound(data) + 1) - (m - 1)).Copy _\n             sht.Cells(q, 1)\n\n    Next m\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": true, "score": 0, "last_activity_date": 1438197668, "creation_date": 1438197668, "answer_id": 31709326, "question_id": 31708831, "link": "https://stackoverflow.com/questions/31708831/a-loop-for-modifying-and-printing-an-array-in-vba/31709326#31709326", "title": "A loop for modifying and printing an array in VBA", "body": "<p>You are re-dimensioning your array in this line:</p>\n\n<pre><code>ReDim Data(0 To UBound(Data) - 1)\n</code></pre>\n\n<p>but you are <strong>not</strong> using the <code>Preserve</code> keyword so your data is getting deleted. Try using:</p>\n\n<pre><code>ReDim Preserve Data(0 To UBound(Data) - 1)\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5170702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90bdac14071049be50f87d6e7791ff98?s=128&d=identicon&r=PG&f=1", "display_name": "Clay", "link": "https://stackoverflow.com/users/5170702/clay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 31709326, "answer_count": 2, "score": 1, "last_activity_date": 1438197668, "creation_date": 1438196005, "last_edit_date": 1438196367, "question_id": 31708831, "link": "https://stackoverflow.com/questions/31708831/a-loop-for-modifying-and-printing-an-array-in-vba", "title": "A loop for modifying and printing an array in VBA", "body": "<p>So, I'm trying to print modified iterations of an array of 100; for the first row I want 1 to 100 of the array, for the second 2 to 100, all the way to the 100th row with just array(100), and all of these rows starting with column A. I can print the first row just fine, but for the subsequent ones I'm not getting any output.</p>\n\n<pre><code>q = 1\nFor m = 1 To last_age\n    Sheets(\"Sheet1\").Range(Cells(q, 1), Cells(q, UBound(Data) + 1)) = Data 'Works the first pass, but not for q&gt;1\n    For p = 0 To UBound(Data) - 1\n        Data(p) = Data(p + 1)\n    Next p\n    If UBound(Data) &gt; 0 Then\n        ReDim Data(0 To UBound(Data) - 1)\n        q = q + 1\n    End If\nNext m\n</code></pre>\n\n<p>All my variables seem to be incrementing correctly, but after the first m loop my Data array isn't being put in the second row. Any thoughts? </p>\n"}, {"tags": ["vba", "ms-access", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 3208395, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/309925909a03ee8a586e65a1e0458890?s=128&d=identicon&r=PG&f=1", "display_name": "Vaulcul", "link": "https://stackoverflow.com/users/3208395/vaulcul"}, "edited": false, "score": 0, "creation_date": 1438197973, "post_id": 31708944, "comment_id": 51356878, "body": "Thanks for your answer Eugene.  I hadn&#39;t thought of this, and this has pointed me to here:  <a href=\"http://www.jpsoftwaretech.com/look-for-and-create-folders-programmatically-in-outlook/\" rel=\"nofollow noreferrer\">jpsoftwaretech.com/&hellip;</a>"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 37, "user_id": 3208395, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/309925909a03ee8a586e65a1e0458890?s=128&d=identicon&r=PG&f=1", "display_name": "Vaulcul", "link": "https://stackoverflow.com/users/3208395/vaulcul"}, "edited": false, "score": 0, "creation_date": 1438200747, "post_id": 31708944, "comment_id": 51358468, "body": "See <a href=\"https://msdn.microsoft.com/en-us/library/office/ff863914(v=office.15).aspx\" rel=\"nofollow noreferrer\">Delete</a>."}, {"owner": {"reputation": 37, "user_id": 3208395, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/309925909a03ee8a586e65a1e0458890?s=128&d=identicon&r=PG&f=1", "display_name": "Vaulcul", "link": "https://stackoverflow.com/users/3208395/vaulcul"}, "edited": false, "score": 0, "creation_date": 1438203271, "post_id": 31708944, "comment_id": 51359852, "body": "Dah!  So simple... I must be looking in the wrong places or for the wrong things.  Thanks so much!"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 1, "last_activity_date": 1438200733, "last_edit_date": 1438200733, "creation_date": 1438196370, "answer_id": 31708944, "question_id": 31708793, "link": "https://stackoverflow.com/questions/31708793/is-there-a-vba-way-to-create-a-new-calendar-not-an-appointment-in-outlook/31708944#31708944", "title": "Is there a VBA way to create a new calendar (not an appointment) in Outlook", "body": "<p>Calendar is just a folder in Outlook with the default Appointment items type. Try using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff863914(v=office.15).aspx\" rel=\"nofollow\">Delete</a> method of the Folder class. Here is what MSDN states for the method:</p>\n\n<p><em>In general, deleting a folder does not require first deleting the items in the folder. Deleting the folder also deletes all items in the folder. An exception would be if the folder is an Outlook folder that cannot be deleted, such as the Inbox and the Deleted Items folder. In such cases, you can delete only the items of the folder but not the folder itself. To delete all items in the Items collection of the folder, you must delete each item starting with the last item in the folder. For example, in the items collection of a folder, AllItems, if there are n number of items in the folder, start deleting the item at AllItems.Item(n), decrementing the index each time until you delete AllItems.Item(1).</em></p>\n"}], "owner": {"reputation": 37, "user_id": 3208395, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/309925909a03ee8a586e65a1e0458890?s=128&d=identicon&r=PG&f=1", "display_name": "Vaulcul", "link": "https://stackoverflow.com/users/3208395/vaulcul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 738, "favorite_count": 0, "accepted_answer_id": 31708944, "answer_count": 1, "score": 2, "last_activity_date": 1438200733, "creation_date": 1438195861, "question_id": 31708793, "link": "https://stackoverflow.com/questions/31708793/is-there-a-vba-way-to-create-a-new-calendar-not-an-appointment-in-outlook", "title": "Is there a VBA way to create a new calendar (not an appointment) in Outlook", "body": "<p>I've looked and looked and I can't find any method to create/delete Calendar's in Outlook using MS Access VBA.</p>\n\n<p>I've found lots and lots of walkthroughs on how to create an appointment (I've got that working very well now)... But nothing on the actual automated creation/deletion of a calendar.</p>\n\n<p>I want to be able to cycle through calendar names in a table and either create or delete them on the fly.</p>\n\n<p>I can understand that this might not be allowed due to security restrictions... So I'm also open to information on deleting all calendar appointment entries on a specific calendar.</p>\n\n<p>Thanks for your help in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1438196636, "post_id": 31708298, "comment_id": 51356153, "body": "Have your used OptionButtons? The &quot;little circle with a dot in it&quot;.  Those automatically unselect the others when one is selected."}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1438196864, "post_id": 31708298, "comment_id": 51356268, "body": "You want some code to loop through all the controls on your userform (at design time) and replace the CommandButtons with OptionButtons that display the same caption?"}, {"owner": {"reputation": 3, "user_id": 5070323, "user_type": "registered", "profile_image": "https://graph.facebook.com/855815424507805/picture?type=large", "display_name": "Kurt H", "link": "https://stackoverflow.com/users/5070323/kurt-h"}, "edited": false, "score": 0, "creation_date": 1438348322, "post_id": 31708298, "comment_id": 51427577, "body": "MatthewD and ChipsLetten - I already had the codes under command button so it was too late to add the optionbuttons. Codes that can change the commandbuttons to optionbuttons will be awesome! Right now I used x.font.bond = true to highligt the selected buttons and it works well so far. Thanks for the help!"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5070323, "user_type": "registered", "profile_image": "https://graph.facebook.com/855815424507805/picture?type=large", "display_name": "Kurt H", "link": "https://stackoverflow.com/users/5070323/kurt-h"}, "edited": false, "score": 0, "creation_date": 1438348170, "post_id": 31709288, "comment_id": 51427489, "body": "It has a run-time error 91 on my code but basically I used the x.font.bold = true to solve the problem. Thanks!"}], "tags": [], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1438197545, "creation_date": 1438197545, "answer_id": 31709288, "question_id": 31708298, "link": "https://stackoverflow.com/questions/31708298/change-commandbutton-to-togglebutton-excel-vba/31709288#31709288", "title": "Change CommandButton to ToggleButton Excel VBA", "body": "<p>If you add the following code to the command button it may serve your purpose.</p>\n\n<pre><code>With Application.CommandBars.ActionControl \n\n.State = Not .State \nEnd With \n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5070323, "user_type": "registered", "profile_image": "https://graph.facebook.com/855815424507805/picture?type=large", "display_name": "Kurt H", "link": "https://stackoverflow.com/users/5070323/kurt-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 938, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438197545, "creation_date": 1438194183, "question_id": 31708298, "link": "https://stackoverflow.com/questions/31708298/change-commandbutton-to-togglebutton-excel-vba", "title": "Change CommandButton to ToggleButton Excel VBA", "body": "<p>I'm trying to change all my CommandButton in the Userform to ToggleButton. I'm new to stackoverflow and thus I cannot post picture at this moment. I'll try to make it clear.</p>\n\n<p>In the ideal situation, when A is selected, the rest of the toggle buttons will be unselected. Currently I have a lot of these CommandButtons so changing them by deleting and re-coding is burdensome. My question is that are there any methods that can change the CommandButton to ToggleButton without changing the contents?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1438194462, "post_id": 31708233, "comment_id": 51354842, "body": "Where did you place the code? Don&#39;t put it in its own module. Put it in the sheet where you want it to work."}], "answers": [{"comments": [{"owner": {"reputation": 23584, "user_id": 168775, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8d6be7c07677acaa346e903a497d0acc?s=128&d=identicon&r=PG", "display_name": "eykanal", "link": "https://stackoverflow.com/users/168775/eykanal"}, "edited": false, "score": 0, "creation_date": 1438195039, "post_id": 31708466, "comment_id": 51355194, "body": "If you switch the lines <code>Selection.Interior.Color = vbYellow</code> and <code>previouscell.Interior.ColorIndex = xlNone</code>, you won&#39;t end up with empty cells when the new selection overlaps the previous one."}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 1, "last_activity_date": 1438194739, "creation_date": 1438194739, "answer_id": 31708466, "question_id": 31708233, "link": "https://stackoverflow.com/questions/31708233/highlight-current-selection-in-yellow/31708466#31708466", "title": "Highlight current Selection in Yellow", "body": "<p>You're on the right track with the first code block. Just test to see if <code>previouscell</code> has been set to anything, and if not, set it to the current selection (or whatever you want to do).</p>\n\n<pre><code>Option Explicit\nPublic previouscell As Range\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If previouscell Is Nothing Then\n        Set previouscell = Selection\n    End If\n\n    Selection.Interior.Color = vbYellow\n    previouscell.Interior.ColorIndex = xlNone\n    Set previouscell = Selection\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 1, "creation_date": 1438195075, "post_id": 31708477, "comment_id": 51355223, "body": "The only problem here is that if you have some cells that you want to have an interior color (like headers), this code will set those cells&#39; interior colors to xlNone."}], "tags": [], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "is_accepted": false, "score": 2, "last_activity_date": 1438194766, "creation_date": 1438194766, "answer_id": 31708477, "question_id": 31708233, "link": "https://stackoverflow.com/questions/31708233/highlight-current-selection-in-yellow/31708477#31708477", "title": "Highlight current Selection in Yellow", "body": "<p>This seems to work if you place it in the code module of the sheet in question.</p>\n\n<pre><code>Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Cells.Interior.ColorIndex = xlNone\n    ActiveCell.Interior.Color = vbYellow\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": false, "score": 0, "last_activity_date": 1438194996, "creation_date": 1438194996, "answer_id": 31708537, "question_id": 31708233, "link": "https://stackoverflow.com/questions/31708233/highlight-current-selection-in-yellow/31708537#31708537", "title": "Highlight current Selection in Yellow", "body": "<p>In the ThisWorkbook.Workbook_Open sub, set previouscell to A1 (or some default cell that has no interior color). Then in the Worksheet_SelectionChange sub do your thing. You have everything correct, but you needed 2 parts:1) setting the initial default value for previouscell and 2) changing the interior of cells when the selection changes. You did part 2, but missed part 1.</p>\n"}, {"comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1438197266, "post_id": 31708584, "comment_id": 51356511, "body": "Nice! This is great because it works on every sheet!"}], "tags": [], "owner": {"reputation": 635, "user_id": 909968, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e28a47d4d3f81bd4536687c08db2d129?s=128&d=identicon&r=PG", "display_name": "AgentRev", "link": "https://stackoverflow.com/users/909968/agentrev"}, "is_accepted": true, "score": 2, "last_activity_date": 1438197126, "last_edit_date": 1438197126, "creation_date": 1438195149, "answer_id": 31708584, "question_id": 31708233, "link": "https://stackoverflow.com/questions/31708233/highlight-current-selection-in-yellow/31708584#31708584", "title": "Highlight current Selection in Yellow", "body": "<p>(<strong>4th edit</strong>)</p>\n\n<p>Use this workbook code, with your sheet code removed:</p>\n\n<pre><code>Option Explicit\nPublic previousCells As Range\n\nPrivate Sub Workbook_Open()\n    SetSelectionYellow\nEnd Sub\n\nPrivate Sub Workbook_SheetActivate(ByVal Sh As Object)\n    SetSelectionYellow\nEnd Sub\n\nPrivate Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\n    SetSelectionYellow\nEnd Sub\n\nPrivate Sub SetSelectionYellow()\n    If Not previousCells Is Nothing Then previousCells.Interior.ColorIndex = xlNone\n    Set previousCells = Selection\n    previousCells.Interior.Color = vbYellow\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 31708584, "answer_count": 4, "score": 1, "last_activity_date": 1438197126, "creation_date": 1438193943, "question_id": 31708233, "link": "https://stackoverflow.com/questions/31708233/highlight-current-selection-in-yellow", "title": "Highlight current Selection in Yellow", "body": "<p>I simply want the selected range to be yellow, and to return to colorless when it is de-selected. The code is the following:</p>\n\n<pre><code>Option Explicit\nPublic previouscell As Range\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Selection.Interior.Color = vbYellow\n    previouscell.Interior.ColorIndex = xlNone\n    Set previouscell = Selection\nEnd Sub\n</code></pre>\n\n<p>The problem is setting previouscell in the first place. I tried putting it in Worksheet_Activate(), but it wouldn't work as soon as I opened the workbook (only when I changed the sheet, it would work great after that.)</p>\n\n<p>So I tried declaring it as a public in ThisWorkbook.Workbook_open as well: </p>\n\n<pre><code>Option Explicit\nPublic previouscell As Range\nPrivate Sub Workbook_Open()\n    Set previouscell = ActiveCell\n    ActiveCell.Interior.Color = vbYellow\nEnd Sub\n</code></pre>\n\n<p>But it doesn't recognize the variable previouscell then, because I believe it is not transferred from ThisWorkbook (I did close and reopen the workbook before testing). Does anyone know what I need to change for this simple task?</p>\n"}, {"tags": ["vba", "publisher", "ms-publisher"], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 1, "last_activity_date": 1438262402, "last_edit_date": 1438262402, "creation_date": 1438260013, "answer_id": 31724035, "question_id": 31707848, "link": "https://stackoverflow.com/questions/31707848/running-macros-from-toolbar-running-one-macro-from-another/31724035#31724035", "title": "Running Macros from Toolbar/Running one macro from another", "body": "<p>Why are you using <code>Application.Run(\"ShapeTest\")</code> rather than simply <code>ShapeTest</code>?</p>\n\n<p>I don't have enough information to be 100% sure, but the following should work: To make <code>ShapeTest</code> callable from the userform you do two things:</p>\n\n<p>1) Move it from <code>ThisDocument</code> to a general code module (first <code>Insert/Module</code> in the editor).</p>\n\n<p>2) Eliminate the word <code>Private</code> in front of <code>Sub ShapeTest()</code>-- you don't <em>want</em> this to be a private sub since you want code outside of the module to be able to use it. </p>\n\n<p>On edit: Alternatively -- you could keep <code>ShapeTest()</code> where it is in <code>ThisDocument</code>, get rid of the <code>Private</code> qualifier and in the userform code refer to <code>ShapeTest</code> as <code>ThisDocument.ShapeTest</code>. I prefer using the first method since I tend to like to keep as much code as possible in general code modules (reserving things like <code>ThisDocument</code> for event handlers) but OTOH my VBA experience is mostly Excel with a smattering of Word and there might be reasons to keep the code in <code>ThisDocument</code> in Publisher. I don't know Publisher, but a problem that I have run into in Word at times is I have sometimes accidentally put code in the <code>Normal</code> template that I wanted to go in the document's project. If something similar is possible in Publisher you should double check where your code is living.</p>\n"}], "owner": {"reputation": 985, "user_id": 3527087, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ce8084ca8f92e9aec1f35d8d95ac54c9?s=128&d=identicon&r=PG&f=1", "display_name": "chif-ii", "link": "https://stackoverflow.com/users/3527087/chif-ii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 31724035, "answer_count": 1, "score": 0, "last_activity_date": 1438262402, "creation_date": 1438192808, "last_edit_date": 1438258748, "question_id": 31707848, "link": "https://stackoverflow.com/questions/31707848/running-macros-from-toolbar-running-one-macro-from-another", "title": "Running Macros from Toolbar/Running one macro from another", "body": "<p>I am trying to develop a macro for a publisher document. This macro will, when run, show a pop-up allowing the user to select one of three types of clients, and add different bullet points to a text box depending on which option was selected. I'm having two different problems which I suspect are coming from the same source. Problem number one is that I can't get the button on my User Form to run a different macro when the button is clicked. Problem two is that I've added my macros to one of the toolbars, and nothing happens when I click on them. In both cases, it's simply not running the macro. What am I doing wrong?</p>\n\n<p>UserForm1</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nApplication.Run (\"ShapeTest\")\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\nWith ListBox1\n.AddItem (\"Federal\")\n.AddItem (\"State\")\n.AddItem (\"Local\")\nEnd With\nEnd Sub\n</code></pre>\n\n<p>ThisDocument</p>\n\n<pre><code>Private Sub GenerateStatement()\nUserForm1.Show\nEnd Sub\n\nPrivate Sub ShapeTest()\nMsgBox (\"Hello!\")\nApplication.ActiveDocument.Pages(1).Shapes(1).TextFrame.TextRange.InsertAfter`enter code here`(Chr(13) &amp; \"My Text\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 6, "last_activity_date": 1438192952, "creation_date": 1438192952, "answer_id": 31707899, "question_id": 31707704, "link": "https://stackoverflow.com/questions/31707704/excel-get-background-color-of-cell-using-vba/31707899#31707899", "title": "Excel: Get background color of cell using VBA", "body": "<p>Just wrap <code>indirect()</code> around your cell ref.  So, in G54, use <code>=getRGB(Indirect(G53))</code>.</p>\n\n<p>Without <code>indirect()</code>, the <code>getRGB()</code> function looks to the cell you pointed to, in this case G53.  Since you want the formula to look to see what's in G53, and use <em>that</em> reference, just add <code>indirect()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "is_accepted": false, "score": 2, "last_activity_date": 1438193511, "creation_date": 1438193511, "answer_id": 31708088, "question_id": 31707704, "link": "https://stackoverflow.com/questions/31707704/excel-get-background-color-of-cell-using-vba/31708088#31708088", "title": "Excel: Get background color of cell using VBA", "body": "<p>Making the function a little easier for myself - that might also help you:</p>\n\n<pre><code>Function getRGB(RefCell As String) As String\n\n    Dim mystr As String\n    Dim rng As Range\n    Set rng = Range(RefCell &amp; \":\" &amp; RefCell)\n    Application.Volatile\n    mystr = Right(\"000000\" &amp; Hex(rng.Interior.Color), 6)\n    getRGB = Application.Hex2Dec(Right(mystr, 2)) &amp; \", \" &amp; _\n            Application.Hex2Dec(Mid(mystr, 3, 2)) &amp; \", \" &amp; _\n            Application.Hex2Dec(Left(mystr, 2))\n\nEnd Function\n</code></pre>\n\n<p>In Excel, do this:</p>\n\n<pre><code>=getRGB(\"AU5\")\n\n' Result: 0, 0, 0\n</code></pre>\n"}], "owner": {"reputation": 196, "user_id": 3623441, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bf478a27375c1f70408e6b3a5042d2a3?s=128&d=identicon&r=PG&f=1", "display_name": "ArnoldasM", "link": "https://stackoverflow.com/users/3623441/arnoldasm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10543, "favorite_count": 0, "accepted_answer_id": 31707899, "answer_count": 2, "score": 1, "last_activity_date": 1462525435, "creation_date": 1438192416, "last_edit_date": 1462525435, "question_id": 31707704, "link": "https://stackoverflow.com/questions/31707704/excel-get-background-color-of-cell-using-vba", "title": "Excel: Get background color of cell using VBA", "body": "<p>I need to get RGB value of cell AU5 (which is filled with black color), but my function shows RGB value of G53. And I just don't know, how to pass the value of cell to function....</p>\n\n<p><a href=\"https://i.stack.imgur.com/hkHgq.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hkHgq.jpg\" alt=\"enter image description here\"></a><a href=\"https://i.stack.imgur.com/PF2kQ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PF2kQ.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>And here is a function in VBA:</p>\n\n<p><a href=\"https://i.stack.imgur.com/fBBvT.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fBBvT.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Maybe anyone could help to fix it?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "edited": false, "score": 0, "creation_date": 1438211265, "post_id": 31707694, "comment_id": 51363163, "body": "This isn&#39;t all the code. For example, where is NRec defined? Please take this chunk of code and put it in a new file with Option Explicit and compile it. Then add anything that is missing. -- Or -- remove anything that won&#39;t compile and boil your problem down to something we can compile."}, {"owner": {"reputation": 108, "user_id": 3418210, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bZEdM.jpg?s=128&g=1", "display_name": "Joshua Oglesbee", "link": "https://stackoverflow.com/users/3418210/joshua-oglesbee"}, "reply_to_user": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "edited": false, "score": 0, "creation_date": 1438223235, "post_id": 31707694, "comment_id": 51365946, "body": "Don, my apologies. I thought I had enough code shown to help resolve the issue. I have now put all the code in above. I have also made the file Option Explicit and compiled it. Sure enough there are many variables that are not defined. I am new at vba and Access. So, this is helpful. What I really need to do at this point is just to get this working. Personally I want to do a rewrite. Much of this seems cryptic. With the entire code now listed above can you give me some more direction? Do you see anything that stands out? Thanks in advance."}], "answers": [{"comments": [{"owner": {"reputation": 108, "user_id": 3418210, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bZEdM.jpg?s=128&g=1", "display_name": "Joshua Oglesbee", "link": "https://stackoverflow.com/users/3418210/joshua-oglesbee"}, "edited": false, "score": 0, "creation_date": 1438260214, "post_id": 31716973, "comment_id": 51384409, "body": "Don, this works and resolves the issue. You are welcome to edit my question and example. Thank you for the help. I have found several good resources (books) and will be do much reading. I will up your answer as soon as your edits are complete."}, {"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "reply_to_user": {"reputation": 108, "user_id": 3418210, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bZEdM.jpg?s=128&g=1", "display_name": "Joshua Oglesbee", "link": "https://stackoverflow.com/users/3418210/joshua-oglesbee"}, "edited": false, "score": 1, "creation_date": 1438272304, "post_id": 31716973, "comment_id": 51393299, "body": "That original code is pretty cryptic. Work through it line by line and write comments as you figure out what each line does. Also, step through line by line using {F8} to see what is happening with a known csv file."}, {"owner": {"reputation": 108, "user_id": 3418210, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bZEdM.jpg?s=128&g=1", "display_name": "Joshua Oglesbee", "link": "https://stackoverflow.com/users/3418210/joshua-oglesbee"}, "edited": false, "score": 0, "creation_date": 1438279999, "post_id": 31716973, "comment_id": 51397782, "body": "Got it. I started to going through it with option explicit on and it wouldn&#39;t compile. So after declaring my 8th or so variable I knew I needed to document and plan for a rewrite in the near future. Thanks again Don for all your input and help."}, {"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "reply_to_user": {"reputation": 108, "user_id": 3418210, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bZEdM.jpg?s=128&g=1", "display_name": "Joshua Oglesbee", "link": "https://stackoverflow.com/users/3418210/joshua-oglesbee"}, "edited": false, "score": 0, "creation_date": 1438280929, "post_id": 31716973, "comment_id": 51398305, "body": "You&#39;re welcome. If you check this answer as the correct one it&#39;s worth another 15 rep to me."}], "tags": [], "owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "is_accepted": true, "score": 1, "last_activity_date": 1438266870, "last_edit_date": 1438266870, "creation_date": 1438239033, "answer_id": 31716973, "question_id": 31707694, "link": "https://stackoverflow.com/questions/31707694/reading-csv-file-in-vba-not-moving-to-next-record-rather-next-column/31716973#31716973", "title": "Reading csv file in vba not moving to next record, rather next column", "body": "<p><strong>Solution</strong></p>\n\n<p>Read to the end of the line before resuming the loop. This will bypass the other fields. Here is some code doing just that using the Input Function to read one character at a time until it comes to a Carriage Return (character 13). It then reads one more character to bypass the Line Feed (character 10). Windows uses a combination of Chr(13) and Chr(10) for line endings.</p>\n\n<p>Place the following lines right before the Goto, so they look like this:</p>\n\n<pre><code>'read to the end of the line\nsX = \"\"\nWhile sX &lt;&gt; Chr(13)\n    sX = Input(1, #1)\nWend\nsX = Input(1, #1)\n\n'now safe to move to next record\nGoTo NEXT_RECORD\n</code></pre>\n\n<p>This is a repeat of several lines of code toward the beginning of the routine which do the same thing in order to skip the header row of the CSV.</p>\n\n<p>The Input # Statement is used to read one field at a time (it reads to the comma or end-of-line), so that's why you have skip to the end before resuming.</p>\n\n<p><strong>References</strong></p>\n\n<ul>\n<li><a href=\"https://support.office.com/en-za/article/Input-Function-5a666c45-6048-405f-bdfe-c5209c45756d\" rel=\"nofollow\">VBA Input Function</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/aa243386(v=vs.60).aspx\" rel=\"nofollow\">VBA Input # Statement</a></li>\n</ul>\n"}], "owner": {"reputation": 108, "user_id": 3418210, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bZEdM.jpg?s=128&g=1", "display_name": "Joshua Oglesbee", "link": "https://stackoverflow.com/users/3418210/joshua-oglesbee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 31716973, "answer_count": 1, "score": 1, "last_activity_date": 1438266870, "creation_date": 1438192365, "last_edit_date": 1438266093, "question_id": 31707694, "link": "https://stackoverflow.com/questions/31707694/reading-csv-file-in-vba-not-moving-to-next-record-rather-next-column", "title": "Reading csv file in vba not moving to next record, rather next column", "body": "<p>Below is code from an Access application. What is taking place is a csv file is being read that contains records. If correct conditions are not met then the program needs to move on to the next record in the csv file and continue to process. However, when this happens at the line \"GoTo NEXT_RECORD\" It immediately jumps to \"NEXT_RECORD: Wend\" and starts the loop over again. However, instead of reading the next record it reads the next column. I need to know how to move the pointer to the next record and not the next column. Any help is appreciated. </p>\n\n<pre><code>Public Sub ReadCSV()\n\n    Const FILE_NAME = \"C:\\files\\test.csv\"\n\n    On Error GoTo EH\n\n    Dim sX As String\n    Dim sSSN As String\n    Dim sName As String\n\n    Open FILE_NAME For Input As #1\n\n    'read to the end of the line to skip header row\n    While sX &lt;&gt; Chr(13)\n        sX = Input(1, #1)\n    Wend\n    sX = Input(1, #1)\n\n    While Not EOF(1)\n\n        Input #1, sSSN\n\n        If Len(sSSN) &lt;&gt; 11 Then\n            Debug.Print \"bad SSN: \" &amp; sSSN\n            GoTo NEXT_RECORD\n        End If\n\n        Input #1, sName\n        Debug.Print sSSN &amp; vbTab &amp; sName\n\nNEXT_RECORD:\n    Wend\n\n    GoTo FINISH\nEH:\n    With Err\n        MsgBox .Number &amp; vbCrLf &amp; .Source &amp; vbCrLf &amp; .Description\n        .Clear\n    End With\n\nFINISH:\n    Close #1\nEnd Sub\n</code></pre>\n\n<p>The CSV file has records like this:</p>\n\n<pre><code>SSN,Name\n684-92-4567,Marshall Applewhite\n55589,Shoko Ashara\n874-96-5124,Jim Jones\n</code></pre>\n"}, {"tags": ["excel", "vba", "csv", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1438195132, "creation_date": 1438195132, "answer_id": 31708578, "question_id": 31707596, "link": "https://stackoverflow.com/questions/31707596/automatically-saving-attachments-outlook-convert-to-csv/31708578#31708578", "title": "automatically saving attachments outlook convert to csv", "body": "<p>You can automate Excel to get the job done for you. But you need to save the attached file on the disk anyway. Then in Excel you can open the saved file and save it in the format you need. </p>\n\n<p>See <a href=\"https://support.microsoft.com/en-us/kb/219151?wa=wsignin1.0\" rel=\"nofollow\">How to automate Microsoft Excel from Visual Basic</a> to get started quickly.</p>\n"}], "owner": {"reputation": 21, "user_id": 5170538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/feea54fc53582e498c38e6efda2c02bf?s=128&d=identicon&r=PG&f=1", "display_name": "David Klein", "link": "https://stackoverflow.com/users/5170538/david-klein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1206, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1593073423, "creation_date": 1438192023, "last_edit_date": 1593073423, "question_id": 31707596, "link": "https://stackoverflow.com/questions/31707596/automatically-saving-attachments-outlook-convert-to-csv", "title": "automatically saving attachments outlook convert to csv", "body": "<p>I have used the following code to automatically save Excel files with certain text in the file name to a specific location as they arrive in my Outlook folder:</p>\n\n<pre><code>Public Sub saveAttachtoDisk(itm As Outlook.MailItem)\nDim objAtt As Outlook.Attachment\nDim saveFolder As String\nsaveFolder = \"c:\\temp\\\"\n For Each objAtt In itm.Attachments\n          If InStr(objAtt.DisplayName, \".xlsx\") Then\n            If InStr(objAtt.DisplayName, \"Test\") Then\n          objAtt.SaveAsFile saveFolder &amp; \"\\\" &amp; objAtt.DisplayName\n      End If\nEnd If\n Next\nEnd Sub\n</code></pre>\n\n<p>Is there a way I can also have Outlook save the file in .csv format, or at least instruct it to open Excel and perform the task automatically?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1438194349, "post_id": 31707757, "comment_id": 51354788, "body": "That&#39;s fine I think, he wants a counter to increment every time the file is opened."}, {"owner": {"reputation": 1, "user_id": 5170395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/122f27a68a0d817638b360710f0a5391?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn", "link": "https://stackoverflow.com/users/5170395/glenn"}, "edited": false, "score": 0, "creation_date": 1438195342, "post_id": 31707757, "comment_id": 51355378, "body": "well I actually need it to auto save after my counter updates. but I think I got that problem solved I made it template which only allows save as. so I did that and ran a macro to auto save as over the original, which works until I get a pop up asking if I want to save over it which I want it to. how do I stop this from popping up?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1438197545, "post_id": 31707757, "comment_id": 51356647, "body": "Without seeing your code, try adding this JUST before, and JUST after your &quot;Save&quot; line:  <code>Application.DisplayAlerts = False</code>, then after, <code>Application.DisplayAlerts = True</code>.  If that doesn&#39;t do it, can you update your OP with the code you&#39;re now using?"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1438192562, "creation_date": 1438192562, "answer_id": 31707757, "question_id": 31707568, "link": "https://stackoverflow.com/questions/31707568/excel-vba-script-to-save-then-disable-update/31707757#31707757", "title": "Excel VBA script to save then disable *Update*", "body": "<p>For the part about saving the file with a name from a cell, you can do something similar to:</p>\n\n<pre><code>Sub SaveAsCell()\n\nDim strName As String\n\n    strName = Sheet1.Range(\"A1\")\n\n    ActiveWorkbook.SaveAs strName\n\nExit Sub\n</code></pre>\n\n<p>(From <a href=\"http://www.ozgrid.com/VBA/save-as-cell.htm\" rel=\"nofollow\">OZGrid.com</a>)</p>\n\n<p>Also, looking at your code, the reason it's saving every time, is because you're telling it to save every time the workbook is opened.  Perhaps move the <code>ActiveWorkbook.Save</code> part to another macro.</p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 5168467, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205066627604598/picture?type=large", "display_name": "Carlo", "link": "https://stackoverflow.com/users/5168467/carlo"}, "is_accepted": false, "score": 0, "last_activity_date": 1438194630, "creation_date": 1438194630, "answer_id": 31708420, "question_id": 31707568, "link": "https://stackoverflow.com/questions/31707568/excel-vba-script-to-save-then-disable-update/31708420#31708420", "title": "Excel VBA script to save then disable *Update*", "body": "<p>This code helps for disabling the Save command (just does nothing):</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\nIf SaveAsUI = False Then\nCancel = True\n\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Source: <a href=\"http://www.mrexcel.com/forum/excel-questions/22345-disable-%22save%22-option-file-menu.html\" rel=\"nofollow\">http://www.mrexcel.com/forum/excel-questions/22345-disable-%22save%22-option-file-menu.html</a></p>\n\n<p>I don't know if this is what you are looking for. There seems (when I was testing this just now) to be one flaw with this solution: one can still \"Save As\" and then select the existing file :-)\nI've tested it in Excel 2010.</p>\n"}], "owner": {"reputation": 1, "user_id": 5170395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/122f27a68a0d817638b360710f0a5391?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn", "link": "https://stackoverflow.com/users/5170395/glenn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 749, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1438263831, "creation_date": 1438191956, "last_edit_date": 1438263831, "question_id": 31707568, "link": "https://stackoverflow.com/questions/31707568/excel-vba-script-to-save-then-disable-update", "title": "Excel VBA script to save then disable *Update*", "body": "<p>I have created an excel spreadsheet to use as a template for documentation. I have locked the workbook from being changed, with  the exception of the cells that need info entered. I then added a vba script that counts up every time the file is opened, with the password protection being unlocked then the vba script updates and password protection is enabled again. This is for my company's own internal document tracking. The problem I am running into is having the file auto save right after the vba script being executed and then have another vba script disable the save feature only allowing the save as feature. I don't want the file to be accidentally overwritten.</p>\n\n<p>also I'd like a vba script to place a command button beside the file that can Save As with a standard excel format and uses cell data for file name if its possible.</p>\n\n<p>This is what I have so far, I am very new to this. </p>\n\n<pre><code>Private Sub Workbook_Open()\nActiveSheet.Unprotect Password:=\"PassWord\"\n\n    Sheets(1).[I9] = Sheets(1).[I9] + 1\n\nActiveSheet.Protect Password:=\"PassWord\"\n\nActiveWorkbook.Save\n\nEnd Sub\n</code></pre>\n\n<p>Thank You in advance for your time.</p>\n\n<p><strong><em>Update</em></strong></p>\n\n<p>This is my code so far </p>\n\n<pre><code>Private Sub Workbook_Open()\n\nActiveSheet.Unprotect Password:=\"PassWord\"\n\n    Sheets(1).[I9] = Sheets(1).[I9] + 1\n\nActiveSheet.Protect Password:=\"PassWord\"\n\nApplication.DisplayAlerts = False\n\n    ChDir \"C:\\Users\\BlahBlah\\Desktop\"\n    ActiveWorkbook.SaveAs Filename:= _\n        \"C:\\Users\\BlahBlah\\Desktop\\Quote Detail Log Proto.xltm\", FileFormat:= _\n        xlOpenXMLTemplateMacroEnabled, Password:=\"\", WriteResPassword:=\"\", _\n        ReadOnlyRecommended:=False, CreateBackup:=False\n\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n\n<p>the problem is now when save button or Ctrl+S is used it just saves overtop again, even though its a template format and should pop up a save as box.</p>\n\n<p>my other road block is command button Save As using cells A1 , G9, and I9 as the file name. all the codes I have tried either don't work, or most likly I copied wrong/entered wrong info and just don't understand it at all. </p>\n"}, {"tags": ["excel", "checkbox", "vba"], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 0, "last_activity_date": 1438200069, "creation_date": 1438200069, "answer_id": 31710033, "question_id": 31707407, "link": "https://stackoverflow.com/questions/31707407/form-control-checkbox-linkedcell-reference-failing/31710033#31710033", "title": "Form control checkbox linkedcell reference failing", "body": "<p>You need the <code>.Address</code> and not <code>.Value</code>. Try this</p>\n\n<pre><code>.LinkedCell =  Worksheets(\"sheet1\").Range(\"D\" &amp; myCell.Row).Address\n</code></pre>\n\n<p>or</p>\n\n<pre><code>.LinkedCell = ActiveSheet.Range(\"D\" &amp; myCell.Row).Address\n</code></pre>\n\n<p>Also you do not need the <code>\"\"</code> after specifying the row. So <code>\"B\" &amp; myCell.Row &amp; \"\"</code> can be written as <code>\"B\" &amp; myCell.Row</code></p>\n"}], "owner": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 31710033, "answer_count": 1, "score": 1, "last_activity_date": 1438200336, "creation_date": 1438191487, "last_edit_date": 1531161705, "question_id": 31707407, "link": "https://stackoverflow.com/questions/31707407/form-control-checkbox-linkedcell-reference-failing", "title": "Form control checkbox linkedcell reference failing", "body": "<p>I've devised a linked cell reference for a form control checkbox, <code>.LinkedCell = Worksheets(\"sheet1\").Range(\"D\" &amp; myCell.Row &amp; \"\").Value</code>, that will unfortunately not link to the specified cell. Although, the caption reference does work. I've placed the entire macro below: </p>\n\n<pre><code>Sub test()\n\n    Dim myBox As CheckBox\n    Dim myCell As Range\n\n    Dim cellRange As String\n\n    With ActiveSheet\n        For Each myCell In .Range(\"B10:B12\").Cells\n            With myCell\n                Set myBox = .Parent.CheckBoxes.Add(Top:=.Top, Width:=.Width, Left:=.Left, Height:=.Height)\n\n                With myBox\n                    .LinkedCell = Worksheets(\"sheet1\").Range(\"D\" &amp; myCell.Row &amp; \"\").Value\n                    .Caption = Worksheets(\"sheet1\").Range(\"B\" &amp; myCell.Row &amp; \"\").Value\n                    .Name = \"checkbox_\" &amp; myCell.Address(0, 0)\n                End With\n\n                .NumberFormat = \";;;\"\n            End With\n\n        Next myCell\n    End With\nEnd Sub\n</code></pre>\n\n<p>I've tried to reference the cell in this way also: <code>.Range(\"sheet1!B\" &amp; myCell.Row).Value</code>. This method fails completely.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1438191230, "post_id": 31707213, "comment_id": 51352959, "body": "What have you tried so far? Also, you can try putting the code tags around what you want to show as a list, but it&#39;s not perfect."}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 1195, "user_id": 3952424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ec4fcf5a444a386bf9ab623f975c0e67?s=128&d=identicon&r=PG&f=1", "display_name": "ValientProcess", "link": "https://stackoverflow.com/users/3952424/valientprocess"}, "edited": false, "score": 0, "creation_date": 1438192664, "post_id": 31707595, "comment_id": 51353756, "body": "You&#39;re welcome!  Would you mind marking as the answer (click the check mark under the up and down arrows by the comment)?"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1438192022, "creation_date": 1438192022, "answer_id": 31707595, "question_id": 31707213, "link": "https://stackoverflow.com/questions/31707213/copy-enitire-row-to-new-sheet-in-excel-if-certain-column-is-between-values/31707595#31707595", "title": "Copy enitire row to new sheet in excel if certain column is between values", "body": "<p>How's something like this:   </p>\n\n<pre><code>Sub test()\nDim lastRow As Integer, newLastRow As Integer, lastCol As Integer\nDim ws As Worksheet, newWS As Worksheet\n\nSet ws = ActiveSheet\nSet newWS = Sheets.Add\nnewWS.Name = \"Parsed Info\"\n\nDim cel As Range, rng As Range\n\nnewLastRow = 1\n\nWith ws\n    lastRow = .Cells(1, 1).End(xlDown).Row\n    For Each cel In .Range(.Cells(1, 1), .Cells(lastRow, 1))\n        If 10 &gt;= cel.Value And cel.Value &gt;= 5 Then\n            lastCol = .Cells(cel.Row, 1).End(xlToRight).Column\n            Set rng = .Range(.Cells(cel.Row, 1), .Cells(cel.Row, lastCol))\n            rng.Copy\n            With newWS\n                .Range(.Cells(newLastRow, 1), .Cells(newLastRow, lastCol)).PasteSpecial\n            End With\n            newLastRow = newLastRow + 1\n        End If\n    Next cel\nEnd With\n\nApplication.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1195, "user_id": 3952424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ec4fcf5a444a386bf9ab623f975c0e67?s=128&d=identicon&r=PG&f=1", "display_name": "ValientProcess", "link": "https://stackoverflow.com/users/3952424/valientprocess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 31707595, "answer_count": 1, "score": -1, "last_activity_date": 1438193563, "creation_date": 1438190801, "last_edit_date": 1438193563, "question_id": 31707213, "link": "https://stackoverflow.com/questions/31707213/copy-enitire-row-to-new-sheet-in-excel-if-certain-column-is-between-values", "title": "Copy enitire row to new sheet in excel if certain column is between values", "body": "<p>I have a huge excel file with data, and i want to create a new sheet with only the rows that one of their columns (column \"Date\" in my example) is between the values 5 to 10.</p>\n\n<p>For example,</p>\n\n<p>I have data like this:</p>\n\n<pre><code>Date  m  X   Y\n\n4    30  5   7\n\n7    31  5   7\n\n7    32  5   7\n\n9    33  5   7\n\n10   34  5   7\n\n2    35  5   7\n</code></pre>\n\n<p>And I want to make new sheet like this:</p>\n\n<pre><code>Date  m  X   Y\n\n7    31  5   7\n\n7    32  5   7\n\n9    33  5   7\n</code></pre>\n\n<p>Any leads ?</p>\n"}, {"tags": ["excel", "excel-2011", "vba"], "comments": [{"owner": {"reputation": 841, "user_id": 3633799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf3c5795e0c55e5c31ed7fa75abc8da5?s=128&d=identicon&r=PG&f=1", "display_name": "Jane", "link": "https://stackoverflow.com/users/3633799/jane"}, "edited": false, "score": 1, "creation_date": 1438191666, "post_id": 31706874, "comment_id": 51353188, "body": "Could you add some more details such as where you want to paste the data, want you have tried so far, and which part of the task you&#39;re stuck with?"}, {"owner": {"reputation": 71, "user_id": 4119049, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-uh_WBuHdCFs/AAAAAAAAAAI/AAAAAAAAAAA/9DyAm4EbgaA/photo.jpg?sz=128", "display_name": "shannimcg", "link": "https://stackoverflow.com/users/4119049/shannimcg"}, "reply_to_user": {"reputation": 841, "user_id": 3633799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf3c5795e0c55e5c31ed7fa75abc8da5?s=128&d=identicon&r=PG&f=1", "display_name": "Jane", "link": "https://stackoverflow.com/users/3633799/jane"}, "edited": false, "score": 0, "creation_date": 1438191858, "post_id": 31706874, "comment_id": 51353291, "body": "@Jane - I tried a formula that involved  creating a column that calculated the end row number for the data and VLOOKUP, but it did not return anything other than one broken cell (rather than cells n number of times). The data could be pasted in a second sheet or even in the same sheet. I am fine to c&amp;p paste it into a new file in the end if need be."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 4119049, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-uh_WBuHdCFs/AAAAAAAAAAI/AAAAAAAAAAA/9DyAm4EbgaA/photo.jpg?sz=128", "display_name": "shannimcg", "link": "https://stackoverflow.com/users/4119049/shannimcg"}, "edited": false, "score": 0, "creation_date": 1438195834, "post_id": 31708406, "comment_id": 51355682, "body": "Thank you! Before I try it, I have a few questions. Will the copied data retain its column breakdown? Each column is a variable, so I need the copied data to still in columns. Also, where in the code does the number of times I want the row copied come in? I&#39;m sure it&#39;s there, I just don&#39;t see whether it&#39;s reading it off a cell in the data (which I have) or if I am manually inputting it (which I can also do). Thank you!"}, {"owner": {"reputation": 841, "user_id": 3633799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf3c5795e0c55e5c31ed7fa75abc8da5?s=128&d=identicon&r=PG&f=1", "display_name": "Jane", "link": "https://stackoverflow.com/users/3633799/jane"}, "reply_to_user": {"reputation": 71, "user_id": 4119049, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-uh_WBuHdCFs/AAAAAAAAAAI/AAAAAAAAAAA/9DyAm4EbgaA/photo.jpg?sz=128", "display_name": "shannimcg", "link": "https://stackoverflow.com/users/4119049/shannimcg"}, "edited": false, "score": 0, "creation_date": 1438196855, "post_id": 31708406, "comment_id": 51356262, "body": "This will keep each row of data that is copied in the same layout (ie in the sample if copies a block which is 1 cell high and 5 cells wide, so when it is pasted it will still be 5 cells wide)."}, {"owner": {"reputation": 841, "user_id": 3633799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf3c5795e0c55e5c31ed7fa75abc8da5?s=128&d=identicon&r=PG&f=1", "display_name": "Jane", "link": "https://stackoverflow.com/users/3633799/jane"}, "reply_to_user": {"reputation": 71, "user_id": 4119049, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-uh_WBuHdCFs/AAAAAAAAAAI/AAAAAAAAAAA/9DyAm4EbgaA/photo.jpg?sz=128", "display_name": "shannimcg", "link": "https://stackoverflow.com/users/4119049/shannimcg"}, "edited": false, "score": 0, "creation_date": 1438197054, "post_id": 31708406, "comment_id": 51356398, "body": "The number of times it will be pasted comes from count = cell.value. The code loops through the cells in the specified range (B1:B6 in this case), and gets the value from that cell. Count is then used to set the number of rows that the data is pasted in to (targetRange.Resize) and to reset the targetRange for the next block of data (targetRange.Offset)"}, {"owner": {"reputation": 841, "user_id": 3633799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf3c5795e0c55e5c31ed7fa75abc8da5?s=128&d=identicon&r=PG&f=1", "display_name": "Jane", "link": "https://stackoverflow.com/users/3633799/jane"}, "reply_to_user": {"reputation": 71, "user_id": 4119049, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-uh_WBuHdCFs/AAAAAAAAAAI/AAAAAAAAAAA/9DyAm4EbgaA/photo.jpg?sz=128", "display_name": "shannimcg", "link": "https://stackoverflow.com/users/4119049/shannimcg"}, "edited": false, "score": 0, "creation_date": 1438197230, "post_id": 31708406, "comment_id": 51356493, "body": "@shannimcg I&#39;ve updated the comments - is that a little clearer?"}, {"owner": {"reputation": 71, "user_id": 4119049, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-uh_WBuHdCFs/AAAAAAAAAAI/AAAAAAAAAAA/9DyAm4EbgaA/photo.jpg?sz=128", "display_name": "shannimcg", "link": "https://stackoverflow.com/users/4119049/shannimcg"}, "edited": false, "score": 0, "creation_date": 1438197931, "post_id": 31708406, "comment_id": 51356849, "body": "Yes, I think that makes more sense. I am going to try it now. First time doing VBA - thank you so much. Will update with results!"}], "tags": [], "owner": {"reputation": 841, "user_id": 3633799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf3c5795e0c55e5c31ed7fa75abc8da5?s=128&d=identicon&r=PG&f=1", "display_name": "Jane", "link": "https://stackoverflow.com/users/3633799/jane"}, "is_accepted": true, "score": 1, "last_activity_date": 1438197179, "last_edit_date": 1438197179, "creation_date": 1438194572, "answer_id": 31708406, "question_id": 31706874, "link": "https://stackoverflow.com/questions/31706874/copying-a-range-in-a-row-where-the-of-x-to-be-copied-is-in-cell/31708406#31708406", "title": "Copying a range in a row where the # of x to be copied is in cell", "body": "<p>In Excel, you can copy some data which is 1 row by multiple columns (eg B5:Z5), then paste that data in to a range which is 1 column wide by multiple rows (eg D10:D50) and the data will be repeated in each row. That's what the code below is doing:</p>\n\n<pre><code>Sub MultiCopy()\n    Dim sourceRange As Range\n    Dim targetBook As Workbook\n    Dim targetRange As Range\n    Dim cell As Range\n    Dim count As Integer\n    Dim copyRange As Range\n\n    'Adjust this range to reflect the list containing the numbers\n    Set sourceRange = ActiveSheet.Range(\"B2:B6\")\n\n    'We'll copy the data to a new workbook\n    Set targetBook = Workbooks.Add\n    Set targetRange = targetBook.Worksheets(1).Range(\"A1\")\n\n    'Loop through the cells which contain the number of times to repeat the row\n    For Each cell In sourceRange\n        'Get the number of times that the current row will be repeated\n        count = cell.Value\n        'The range being copied starts in the cell to the right of the value, and is 5 cells wide\n        Set copyRange = cell.Offset(0, 1).Resize(1, 5)\n        'The data will be pasted in to a vertical block of cells\n        'The copied data gets repeated in each row\n        Set targetRange = targetRange.Resize(count, 1)\n        copyRange.Copy targetRange\n        'Reset the targetrange ready for the next row\n        Set targetRange = targetRange.Offset(count, 0)\n    Next\nEnd Sub\n</code></pre>\n\n<p>I don't have a Mac, but the code below works fine on Excel 2013, and I'm not aware of any reason that it wouldn't work on a Mac. </p>\n"}], "owner": {"reputation": 71, "user_id": 4119049, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-uh_WBuHdCFs/AAAAAAAAAAI/AAAAAAAAAAA/9DyAm4EbgaA/photo.jpg?sz=128", "display_name": "shannimcg", "link": "https://stackoverflow.com/users/4119049/shannimcg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 31708406, "answer_count": 1, "score": 0, "last_activity_date": 1442616336, "creation_date": 1438189693, "last_edit_date": 1531164843, "question_id": 31706874, "link": "https://stackoverflow.com/questions/31706874/copying-a-range-in-a-row-where-the-of-x-to-be-copied-is-in-cell", "title": "Copying a range in a row where the # of x to be copied is in cell", "body": "<p>I need to copy each of 69 rows n number of times. The n number of times each range in a row that should be copied is in the row as well. I attached a screen shot so you can see the data. I tried one of the other answers on here, but it did not work for me. <a href=\"https://i.stack.imgur.com/IkhSL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IkhSL.png\" alt=\"example screen shot\"></a></p>\n\n<p>So, in the above screen shot, I'd like to have B2, D2:G2 copied 284 times. As I am typing this, I can see this will work better if I switch column C and B. </p>\n\n<p>Anyhow - I have seen some examples with VBA. I am not familiar with it, but I am not unfamiliar with coding in general. So, if the solution is VBA, then I am up for it, I just need instructions for a dummy level ;)</p>\n"}, {"tags": ["arrays", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 5170192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08c5276f98abd78fb1e5e072447d5287?s=128&d=identicon&r=PG&f=1", "display_name": "SydneyJ", "link": "https://stackoverflow.com/users/5170192/sydneyj"}, "edited": false, "score": 1, "creation_date": 1438196326, "post_id": 31706959, "comment_id": 51355962, "body": "All sets of code worked, the code that Maxime suggested had the added bonus of preserving that output for later use. Thanks."}], "tags": [], "owner": {"reputation": 960, "user_id": 5151278, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ilDIXFcHqdo/AAAAAAAAAAI/AAAAAAAADnQ/j3pEZAQLJ28/photo.jpg?sz=128", "display_name": "Maxime Port&#233;", "link": "https://stackoverflow.com/users/5151278/maxime-port%c3%a9"}, "is_accepted": true, "score": 5, "last_activity_date": 1438189952, "creation_date": 1438189952, "answer_id": 31706959, "question_id": 31706754, "link": "https://stackoverflow.com/questions/31706754/using-vba-to-assign-range-of-cell-values-to-array-of-variables/31706959#31706959", "title": "Using VBA to assign range of cell values to array of variables", "body": "<p>You should :</p>\n\n<ul>\n<li>Define the range you want to retrieve data</li>\n<li><p>For each cell of the range, retrieve your datas</p>\n\n<pre><code>dim tab() As string, cell as range, i as integer\ni = 0\nredim tab(0)\nfor each cell in ActiveWorksheet.Range(\"C1:C20\")\n    tab(i) = cell\n    i = i + 1\n    redim preserve tab(i)\nnext\n</code></pre></li>\n</ul>\n\n<p>edit : I indent the code to display it correctly</p>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 4019094, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Vd8QzlfS03s/AAAAAAAAAAI/AAAAAAAACBI/Dpq0XJ69oLQ/photo.jpg?sz=128", "display_name": "Jaco-Ben Vosloo", "link": "https://stackoverflow.com/users/4019094/jaco-ben-vosloo"}, "edited": false, "score": 0, "creation_date": 1477462607, "post_id": 31707019, "comment_id": 67771570, "body": "The second part of the answer is the easier method, which I assume is what the OP was expecting      <code>Dim Arr() As Variant &#39; declare an unallocated array.</code>     <code>Arr = Range(&quot;A1:C5&quot;)&#39; Arr is now an allocated array</code>"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 6, "last_activity_date": 1438190103, "creation_date": 1438190103, "answer_id": 31707019, "question_id": 31706754, "link": "https://stackoverflow.com/questions/31706754/using-vba-to-assign-range-of-cell-values-to-array-of-variables/31707019#31707019", "title": "Using VBA to assign range of cell values to array of variables", "body": "<p>Try something like this:</p>\n\n<pre><code>Sub test()\nDim sampleArr(1 To 20) As String\nDim i As Integer\nDim rng As Range, cel As Range\n\ni = 1\nSet rng = Range(\"C1:C20\") \n\nFor Each cel In rng\n    sampleArr(i) = cel.Value\n    i = i + 1\nNext cel\nFor i = LBound(sampleArr) To UBound(sampleArr)\n    Debug.Print sampleArr(i)\nNext i\n</code></pre>\n\n<p>Also, if you know the range you want to put into an array, you can simply set an array to that range:</p>\n\n<pre><code>Sub test()\nDim sampleArr() As Variant\nDim i As Integer\nDim rng As Range, cel As Range\n\ni = 1\nSet rng = Range(\"C1:C20\") ' Note, this creates a 2 Dimensional array\n\nsampleArr = rng ' Right here, this sets the values in the range to this array.\n\nFor i = LBound(sampleArr) To UBound(sampleArr)\n    Debug.Print sampleArr(i, 1) ' you need the \",1\" since this is 2D.\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 67, "user_id": 1935347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2e7fd28b17fefc365eac02702384f3e?s=128&d=identicon&r=PG", "display_name": "Mohammed Almudhafar", "link": "https://stackoverflow.com/users/1935347/mohammed-almudhafar"}, "is_accepted": false, "score": 1, "last_activity_date": 1534247464, "creation_date": 1534247464, "answer_id": 51840750, "question_id": 31706754, "link": "https://stackoverflow.com/questions/31706754/using-vba-to-assign-range-of-cell-values-to-array-of-variables/51840750#51840750", "title": "Using VBA to assign range of cell values to array of variables", "body": "<p>Additional way to the above you can only use:</p>\n\n<pre><code>Arr = ActiveWorksheet.Range(\"C1:C20\").Value\n</code></pre>\n\n<p>Then you can directly use:</p>\n\n<p><code>Arr(i,1)</code> where <code>i</code> is C1 to C20 range!</p>\n"}], "owner": {"reputation": 63, "user_id": 5170192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08c5276f98abd78fb1e5e072447d5287?s=128&d=identicon&r=PG&f=1", "display_name": "SydneyJ", "link": "https://stackoverflow.com/users/5170192/sydneyj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86761, "favorite_count": 2, "accepted_answer_id": 31706959, "answer_count": 3, "score": 6, "last_activity_date": 1534247464, "creation_date": 1438189295, "question_id": 31706754, "link": "https://stackoverflow.com/questions/31706754/using-vba-to-assign-range-of-cell-values-to-array-of-variables", "title": "Using VBA to assign range of cell values to array of variables", "body": "<p>I'm very new to VBA, to bear with me here.</p>\n\n<p>I want to assign a set of variables the value of a set of ranges ie. run a brief code to simplify the following</p>\n\n<pre><code>Dim Sample 1 as string\nSample1 = activeworksheet.range(\"C17\").value\n\nDim Sample 2 as string\nSample2 = activeworksheet.range(\"C18\").value}\n</code></pre>\n\n<p>and so on</p>\n\n<p>Following an excelfunctions.net tutorial, I know that I can shorten the declaration to</p>\n\n<pre><code>Dim Sample(1 to 20) as a string\n</code></pre>\n\n<p>But the tutorial drops it there(because it's a tutorial about names), suggesting I populate it as follows</p>\n\n<pre><code>sample(1)=activesheet.range(\"C7\").value\nsample(2)=activesheet.range(\"C7\").value\n</code></pre>\n\n<p>and so on</p>\n\n<p>I found the discussion below to be on the right track to answer my quest, but I am having trouble applying it to my situation. (<a href=\"https://stackoverflow.com/questions/28938768/excel-vba-array-ranges-for-a-loop\">Excel VBA Array Ranges for a loop</a>)</p>\n\n<p>As a follow up note, I am ultimately trying to assign values to these variables for use in the following procedures, rather than declaring and assigning them each time.</p>\n\n<p>Thanks! </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1438192505, "post_id": 31706678, "comment_id": 51353665, "body": "Edited my answer for you"}], "answers": [{"tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": false, "score": 3, "last_activity_date": 1438189191, "creation_date": 1438189191, "answer_id": 31706718, "question_id": 31706678, "link": "https://stackoverflow.com/questions/31706678/pass-worksheet-as-parameter-and-then-utilize-that-parameter-as-a-variable/31706718#31706718", "title": "pass worksheet as parameter and then utilize that parameter as a variable", "body": "<p>Sheets are not global objects (How would a sheet called \"Dim\" or \"500 x Beef Supreme\" be handled?); you need to fetch the Sheet from the Sheets collection:</p>\n\n<pre><code>aSheet_Recon Sheets(\"MAIN\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "reply_to_user": {"reputation": 2964, "user_id": 2246380, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/piBvo.png?s=128&g=1", "display_name": "Ram", "link": "https://stackoverflow.com/users/2246380/ram"}, "edited": false, "score": 0, "creation_date": 1438192026, "post_id": 31706741, "comment_id": 51353385, "body": "Done. I would imagine it is better?"}, {"owner": {"reputation": 2964, "user_id": 2246380, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/piBvo.png?s=128&g=1", "display_name": "Ram", "link": "https://stackoverflow.com/users/2246380/ram"}, "edited": false, "score": 2, "creation_date": 1438192122, "post_id": 31706741, "comment_id": 51353444, "body": "Good job with the explanation +1"}], "tags": [], "owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "is_accepted": true, "score": 3, "last_activity_date": 1438192494, "last_edit_date": 1438192494, "creation_date": 1438189258, "answer_id": 31706741, "question_id": 31706678, "link": "https://stackoverflow.com/questions/31706678/pass-worksheet-as-parameter-and-then-utilize-that-parameter-as-a-variable/31706741#31706741", "title": "pass worksheet as parameter and then utilize that parameter as a variable", "body": "<p>You have to do this:</p>\n\n<pre><code>Sub tester()\n    dim ws as worksheet 'Creating a worksheet variable to pass\n    set ws = Sheets(\"MAIN\") 'Assigning the sheet you want to pass to this variable\n    aSheet_Recon(ws) 'Sending the newly created WorkSheet variable containing your worksheet\nEnd sub\n</code></pre>\n\n<p><code>aSheet_Recon</code> needs a WorkSheet argument, and will not work unless that's exactly what you're sending it (not a worksheet's Name, codename, index, etc. But the worksheet itself).</p>\n\n<p>EDIT:</p>\n\n<p>In answer to your own edit, here is how to use the worksheet you receive as an argument:</p>\n\n<pre><code>Sub aSheet_Recon(sheetname As Worksheet)\n\n        cName = \"Fund ID\"\n        cA = sheetname.Rows.Find(What:=UCase(cName), LookAt:=xlWhole, SearchDirection:=xlNext).Column\n\nEnd Sub\n</code></pre>\n\n<p>You can also write it like:</p>\n\n<pre><code>sheetname.Range(\"A1\") = \"Hello!\"\n</code></pre>\n\n<p>As a matter of fact, 'sheetname' is considered like a Worksheet in itself, and NOT a sheet's name. For the sheet's name, you would write sheetname.Name:</p>\n\n<pre><code>msgbox sheetname.Name\n</code></pre>\n\n<p>Will return \"MAIN\"</p>\n\n<p>Because of this, I suggest changing \"sheetname\" to \"MySheet\" or something less confusing.</p>\n"}], "owner": {"reputation": 1256, "user_id": 3128069, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4cdd27382d73700ac43edb0becdc1a7b?s=128&d=identicon&r=PG&f=1", "display_name": "phillipsK", "link": "https://stackoverflow.com/users/3128069/phillipsk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11388, "favorite_count": 0, "accepted_answer_id": 31706741, "answer_count": 2, "score": 1, "last_activity_date": 1438192494, "creation_date": 1438189029, "last_edit_date": 1531161705, "question_id": 31706678, "link": "https://stackoverflow.com/questions/31706678/pass-worksheet-as-parameter-and-then-utilize-that-parameter-as-a-variable", "title": "pass worksheet as parameter and then utilize that parameter as a variable", "body": "<p>Why am I receiving an object required error for <code>aSheet_Recon (MAIN)</code> There is a sheet titled <code>MAIN</code>. I did not declare <code>somesheet</code> anywhere else.</p>\n\n<pre><code>Sub aSheet_Recon(somesheet As Worksheet)\n\n...\nEnd Sub\n\n\nSub tester()\n\naSheet_Recon (MAIN)\n\n\nEnd Sub\n</code></pre>\n\n<p><strong>Update from answers and new challenge</strong></p>\n\n<p>How do I then utilize the worksheet parameter as a variable through the rest of the procedure. I receive a type mismatch error when variable <code>cA</code> attempts to reference the value <code>MAIN</code> which is the passed worksheet paramter.</p>\n\n<pre><code>Sub aSheet_Recon(sheetname As Worksheet)\n\n        cName = \"Fund ID\"\n        cA = Sheets(sheetname).Rows.Find(What:=UCase(cName), LookAt:=xlWhole, SearchDirection:=xlNext).Column\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "button", "printing"], "answers": [{"comments": [{"owner": {"reputation": 635, "user_id": 909968, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e28a47d4d3f81bd4536687c08db2d129?s=128&d=identicon&r=PG", "display_name": "AgentRev", "link": "https://stackoverflow.com/users/909968/agentrev"}, "edited": false, "score": 0, "creation_date": 1438184826, "post_id": 31705157, "comment_id": 51348997, "body": "Should remove that <code>ws</code> from <code>Next ws</code>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 635, "user_id": 909968, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e28a47d4d3f81bd4536687c08db2d129?s=128&d=identicon&r=PG", "display_name": "AgentRev", "link": "https://stackoverflow.com/users/909968/agentrev"}, "edited": false, "score": 0, "creation_date": 1438184947, "post_id": 31705157, "comment_id": 51349072, "body": "@AgentRev Well spotted - sloppy hacking on my part. Corrected."}, {"owner": {"reputation": 411, "user_id": 5065804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b575e556cbcdbc280e60d115e40b8cb3?s=128&d=identicon&r=PG&f=1", "display_name": "Cam", "link": "https://stackoverflow.com/users/5065804/cam"}, "edited": false, "score": 0, "creation_date": 1438185772, "post_id": 31705157, "comment_id": 51349618, "body": "When I ran the code you gave me, after pressing the button, I got a popup  that read &quot;Cannot run the macro &#39;Solution_0729_test.xlsm!pageprintTEST1&#39;. The macro may not be available in this workbook or all macros may be disabled.&quot; However the other macros I have seem to work. Any ideas why I could be getting this?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1438186003, "post_id": 31705157, "comment_id": 51349763, "body": "Which module is the <code>pageprintTEST1</code> routine in, and did you edit it as I showed?"}, {"owner": {"reputation": 411, "user_id": 5065804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b575e556cbcdbc280e60d115e40b8cb3?s=128&d=identicon&r=PG&f=1", "display_name": "Cam", "link": "https://stackoverflow.com/users/5065804/cam"}, "edited": false, "score": 0, "creation_date": 1438186441, "post_id": 31705157, "comment_id": 51350039, "body": "Yes, I copied exactly what you wrote. Both the button macro and the pageprintTEST1 macro are simply ion vba window This Workbook (Code) so I am not sure which module."}, {"owner": {"reputation": 411, "user_id": 5065804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b575e556cbcdbc280e60d115e40b8cb3?s=128&d=identicon&r=PG&f=1", "display_name": "Cam", "link": "https://stackoverflow.com/users/5065804/cam"}, "edited": false, "score": 0, "creation_date": 1438187195, "post_id": 31705157, "comment_id": 51350540, "body": "The <code>pageprintTEST1</code> macro works when run by itself, the error only comes up when the button is pressed. Any ideas?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1438188118, "post_id": 31705157, "comment_id": 51351065, "body": "The macro needs to be in a normal module not ThisWorkbook"}, {"owner": {"reputation": 411, "user_id": 5065804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b575e556cbcdbc280e60d115e40b8cb3?s=128&d=identicon&r=PG&f=1", "display_name": "Cam", "link": "https://stackoverflow.com/users/5065804/cam"}, "edited": false, "score": 0, "creation_date": 1438191062, "post_id": 31705157, "comment_id": 51352869, "body": "Great thank you! adding the pageprintTEST1 maccro to a new module (module 1) worked with the code you provided!"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 5, "last_activity_date": 1438184924, "last_edit_date": 1438184924, "creation_date": 1438184622, "answer_id": 31705157, "question_id": 31704996, "link": "https://stackoverflow.com/questions/31704996/how-to-code-buttons-with-vba/31705157#31705157", "title": "How to code buttons with VBA?", "body": "<p>You need to use the <code>OnAction</code> property of the button to store the macro name, but you can't pass an object variable to it. Since the button can only be clicked when its sheet is active, you can use this:</p>\n\n<pre><code>Sub AddButtons()\n    Dim btn As Button\n    Dim n As Long\n\n    For n = 5 To ThisWorkbook.Worksheets.Count\n        Set btn = ThisWorkbook.Worksheets(n).Buttons.Add(625, 0, 50, 25)\n        btn.OnAction = \"pageprintTEST1\"\n    Next\nEnd Sub\n\nSub pageprintTEST1()\n Application.Dialogs(xlDialogPrinterSetup).Show\n   With ActiveSheet.PageSetup\n        .PrintArea = \"A1:O48\"\n        .Orientation = xlLandscape\n        .Zoom = False\n        .FitToPagesTall = 1\n        .FitToPagesWide = 1\n    End With\n    ActiveSheet.PrintOut\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 411, "user_id": 5065804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b575e556cbcdbc280e60d115e40b8cb3?s=128&d=identicon&r=PG&f=1", "display_name": "Cam", "link": "https://stackoverflow.com/users/5065804/cam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1943, "favorite_count": 0, "accepted_answer_id": 31705157, "answer_count": 1, "score": 0, "last_activity_date": 1438241350, "creation_date": 1438184195, "last_edit_date": 1531164843, "question_id": 31704996, "link": "https://stackoverflow.com/questions/31704996/how-to-code-buttons-with-vba", "title": "How to code buttons with VBA?", "body": "<p>I have a vba script for a button that puts a button on each sheet in my workbook. I want to program these buttons so that each time they are pressed they call a print script that will print the information on the sheets.  Here is the code I have for the buttons:</p>\n\n<pre><code>Sub AddButtons()\n    Dim ws As Excel.Worksheet\n    Dim btn As Button\n\n    For Each ws In ThisWorkbook.Worksheets\n        Set btn = ws.Buttons.Add(625, 0, 50, 25)\n        Call pageprintTEST1(ws)\n    Next ws\nEnd Sub\n</code></pre>\n\n<p>Here is the code I have for the print script:</p>\n\n<pre><code>Sub pageprintTEST1(ws As Excel.Worksheet)\n Application.Dialogs(xlDialogPrinterSetup).Show\n         Worksheets(ws).Activate\n   With ActiveWorkbook.Worksheets(ws).PageSetup\n        .PrintArea = \"A1:O48\"\n        .Orientation = xlLandscape\n        .Zoom = False\n        .FitToPagesTall = 1\n        .FitToPagesWide = 1\n    End With\n    ActiveWorkbook.Worksheets(ws).PrintOut\n</code></pre>\n\n<p>I have been having a few problems with this. First, this script adds buttons to every sheet, and I only want buttons added to the sheets from sheet 5 onward (so no buttons on the first 4 sheets). Second it doesn't wait for me to click the button before opening the printer dialogue box, and once you choose a printer it says error Mismatch. </p>\n\n<p>I looked into how to pass variables to different subs and the call method, and this seemed right, but now I am not sure where I went wrong. I would really appreciate if anyone had any advice or knew what to do!!  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1438184962, "post_id": 31704981, "comment_id": 51349086, "body": "Have you tried turning it off and on again?"}, {"owner": {"reputation": 144, "user_id": 5126595, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5f49e9ce781768595ffe9f455c6daf69?s=128&d=identicon&r=PG&f=1", "display_name": "Looker", "link": "https://stackoverflow.com/users/5126595/looker"}, "reply_to_user": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1438185928, "post_id": 31704981, "comment_id": 51349718, "body": "Well, I reboot my entire computer, it doesn&#39;t look like anything&#39;s changed :p Half-jokes aside, I&#39;m not entirely sure what you mean by that."}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1438188063, "post_id": 31704981, "comment_id": 51351029, "body": "So if you change the URL in the new sub back to what it was in the old sub does it still throw and error? That would be handy to know so you can narrow it down to a website issue or a code issue."}, {"owner": {"reputation": 1194, "user_id": 388166, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ae6c5e54ba095edef5a1595c6b214971?s=128&d=identicon&r=PG", "display_name": "variant", "link": "https://stackoverflow.com/users/388166/variant"}, "edited": false, "score": 0, "creation_date": 1438188325, "post_id": 31704981, "comment_id": 51351183, "body": "Oh, this horribleness plagues me too. My guess is that it&#39;s related to security settings in IE. Try Set ie = New InternetExplorerMedium instead. That helped me."}, {"owner": {"reputation": 144, "user_id": 5126595, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5f49e9ce781768595ffe9f455c6daf69?s=128&d=identicon&r=PG&f=1", "display_name": "Looker", "link": "https://stackoverflow.com/users/5126595/looker"}, "reply_to_user": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1438237814, "post_id": 31704981, "comment_id": 51370487, "body": "@Tim - Changing it back to the previous URL made the code work again, so it looks like the problem comes from the page itself."}, {"owner": {"reputation": 144, "user_id": 5126595, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5f49e9ce781768595ffe9f455c6daf69?s=128&d=identicon&r=PG&f=1", "display_name": "Looker", "link": "https://stackoverflow.com/users/5126595/looker"}, "reply_to_user": {"reputation": 1194, "user_id": 388166, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ae6c5e54ba095edef5a1595c6b214971?s=128&d=identicon&r=PG", "display_name": "variant", "link": "https://stackoverflow.com/users/388166/variant"}, "edited": false, "score": 0, "creation_date": 1438237927, "post_id": 31704981, "comment_id": 51370532, "body": "@variant - Your suggestion worked, so thank you! Would you mind posting it an as answer so I can accept it? That said, if you or anyone else happen to know why InternetExplorerMedium worked and just InternetExplorer didn&#39;t, I&#39;d greatly appreciate an explanation for that as well."}], "answers": [{"tags": [], "owner": {"reputation": 1194, "user_id": 388166, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ae6c5e54ba095edef5a1595c6b214971?s=128&d=identicon&r=PG", "display_name": "variant", "link": "https://stackoverflow.com/users/388166/variant"}, "is_accepted": true, "score": 6, "last_activity_date": 1438259307, "last_edit_date": 1495540956, "creation_date": 1438259307, "answer_id": 31723808, "question_id": 31704981, "link": "https://stackoverflow.com/questions/31704981/automation-error-the-object-invoked-has-disconnected-from-its-clients/31723808#31723808", "title": "Automation error: The object invoked has disconnected from its clients", "body": "<p>This is probably related to security settings in IE. As suggested by @Vigneshts88 <a href=\"https://stackoverflow.com/questions/12965032/excel-vba-controlling-ie-local-intranet\">here</a>, try changing</p>\n\n<pre><code>Set ie = New InternetExplorer \n</code></pre>\n\n<p>to:</p>\n\n<pre><code>Set ie = New InternetExplorerMedium\n</code></pre>\n\n<p>As noted by @Mike in the comment under the answer above, <code>InternetExplorerMedium</code> requires a reference to <code>Microsoft Internet Controls</code></p>\n"}, {"tags": [], "owner": {"reputation": 157, "user_id": 4900271, "user_type": "registered", "profile_image": "https://graph.facebook.com/100004225350008/picture?type=large", "display_name": "Steven Alpha", "link": "https://stackoverflow.com/users/4900271/steven-alpha"}, "is_accepted": false, "score": 0, "last_activity_date": 1493046093, "creation_date": 1493046093, "answer_id": 43591548, "question_id": 31704981, "link": "https://stackoverflow.com/questions/31704981/automation-error-the-object-invoked-has-disconnected-from-its-clients/43591548#43591548", "title": "Automation error: The object invoked has disconnected from its clients", "body": "<p>Yeah Baby!</p>\n\n<blockquote>\n  <p>Set ie = New InternetExplorerMedium</p>\n</blockquote>\n\n<p>Fixed it for me!</p>\n\n<p>Can't wait to put this stuff to work.</p>\n"}], "owner": {"reputation": 144, "user_id": 5126595, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5f49e9ce781768595ffe9f455c6daf69?s=128&d=identicon&r=PG&f=1", "display_name": "Looker", "link": "https://stackoverflow.com/users/5126595/looker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13770, "favorite_count": 0, "accepted_answer_id": 31723808, "answer_count": 2, "score": 4, "last_activity_date": 1507394587, "creation_date": 1438184149, "question_id": 31704981, "link": "https://stackoverflow.com/questions/31704981/automation-error-the-object-invoked-has-disconnected-from-its-clients", "title": "Automation error: The object invoked has disconnected from its clients", "body": "<p>All I did was copy-paste a piece of code that worked perfectly fine in a different sub into my new sub and change the URL I wanted to navigate. The first sub still works, but the second one doesn't. I'm pretty stumped.</p>\n\n<pre><code>Dim ie As InternetExplorer              \nDim html As HTMLDocument                 \nSet ie = New InternetExplorer            \nie.Visible = False                       \nie.navigate \"http://cesp.hma.eu/Contacts\" \nWith ie                                  \n    Do Until .READYSTATE = 4: DoEvents: Loop\n    Do While .Busy: DoEvents: Loop\nEnd With\nSet html = ie.document             \nSet ie = Nothing                   \nApplication.StatusBar = \"\"  \n</code></pre>\n\n<p>Using F8 to check the code step by step, it seems that the URL ignores the <code>ie.Visible = False</code> (it opens when I reach <code>With ie</code>), then makes the error pop up on <code>Do While .Busy: DoEvents: Loop</code></p>\n\n<p>I honestly don't know where to start looking to fix this, since I <em>literally</em> only changed the URL and nothing else. My best bet was to just close my workbook and re-open it, but the issue decided to persist. Any hints, explanations, or solutions you can come up with would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 343, "user_id": 5103770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a5f1c3817c808ae0036a22d25db7853?s=128&d=identicon&r=PG&f=1", "display_name": "Stadem", "link": "https://stackoverflow.com/users/5103770/stadem"}, "edited": false, "score": 0, "creation_date": 1455121271, "post_id": 31705137, "comment_id": 58349725, "body": "Also, you should &quot;set the AllDayEvent property of the AppointmentItem object to true&quot; (<a href=\"https://msdn.microsoft.com/en-us/library/office/ff862177.aspx\" rel=\"nofollow noreferrer\">same source as the answer</a>)."}], "tags": [], "owner": {"reputation": 323, "user_id": 4254336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QybXl.png?s=128&g=1", "display_name": "Mr. Smythe", "link": "https://stackoverflow.com/users/4254336/mr-smythe"}, "is_accepted": true, "score": 4, "last_activity_date": 1438184572, "creation_date": 1438184572, "answer_id": 31705137, "question_id": 31704979, "link": "https://stackoverflow.com/questions/31704979/vba-create-outlook-all-day-event-appointment/31705137#31705137", "title": "VBA: Create Outlook All Day Event Appointment", "body": "<p>From <a href=\"https://msdn.microsoft.com/en-us/library/office/ff184629.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff184629.aspx</a>:</p>\n\n<blockquote>\n  <p>To make the appointment an all-day event, you must set the Start property to 12:00 A.M. (midnight) on the day you want the event to begin, and set End property to 12:00 A.M. on the day after you want the event to end. If you set the Start or End time to a date and time value other than 12:00 A.M., the appointment will become a multiday appointment instead of an all-day event. For example, if your event duration is only one day, set the Start property to 12:00 A.M. on the day you want the event to begin, and set the End property to 12:00 A.M. on the following day. You should always set the End property to 12:00 A.M. on a date that is more than one day after the start date.</p>\n</blockquote>\n"}], "owner": {"reputation": 1715, "user_id": 974047, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/9ae436faff7890ab69cef81a7c0a10ce?s=128&d=identicon&r=PG", "display_name": "user974047", "link": "https://stackoverflow.com/users/974047/user974047"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4161, "favorite_count": 0, "accepted_answer_id": 31705137, "answer_count": 1, "score": 1, "last_activity_date": 1455124609, "creation_date": 1438184145, "last_edit_date": 1455124609, "question_id": 31704979, "link": "https://stackoverflow.com/questions/31704979/vba-create-outlook-all-day-event-appointment", "title": "VBA: Create Outlook All Day Event Appointment", "body": "<p>I'm trying to export a table in Excel to create all day event in Outlook with given subject, start date, end date. Here's what I have:</p>\n\n<pre><code>With olAppt\n    .AllDayEvent = True\n    .Start = \"7/29/2015\"\n    .End = \"7/29/2015\"\n    .Subject = \"All Day Event\"\n    .Save\nEnd With\n</code></pre>\n\n<p>What I get is an event that reads \"12:00am All Day Event\" and it is placed as a 12:00am event instead of an all day event on the UI of the calendar (the event should not have the 12:00am time attached in front of the subject name but for some reason it is). If I click into the event detail it does have the all day event checkbox checked, and start end time being both 12:00 AM.</p>\n\n<p>I don't want to have to scroll up to see a 12:00am event in the UI but rather a event at the top for where all day event supposed to be placed.</p>\n\n<p>Anyone encountered this issue before? Thank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1438184391, "post_id": 31704885, "comment_id": 51348668, "body": "Will the blank cell always be in column A? I.e. if there&#39;s a blank in A10, do you want a new row above A10? Or if there&#39;s a blank cell in ANY column, add a row above?"}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 3608384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5b9b998a05839aa44359288c37be2a9?s=128&d=identicon&r=PG&f=1", "display_name": "user3608384", "link": "https://stackoverflow.com/users/3608384/user3608384"}, "is_accepted": false, "score": 1, "last_activity_date": 1438185006, "creation_date": 1438185006, "answer_id": 31705284, "question_id": 31704885, "link": "https://stackoverflow.com/questions/31704885/insert-blank-rows-in-excel-if-row-above-is-not-empty/31705284#31705284", "title": "Insert blank rows in excel if row above is not empty", "body": "<p>Is this what you want?</p>\n\n<pre><code>  Sub helping()\n        Dim count As Long\n        For count = ActiveSheet.UsedRange.Rows.count To 1 Step -1\n            If Information.IsEmpty(Cells(count, 1)) = False Then Rows(count + 1).Insert\n        Next count\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5170080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a41347172be86c3003279307cc981bc?s=128&d=identicon&r=PG&f=1", "display_name": "Ray Nelson", "link": "https://stackoverflow.com/users/5170080/ray-nelson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2449, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503857528, "creation_date": 1438183921, "question_id": 31704885, "link": "https://stackoverflow.com/questions/31704885/insert-blank-rows-in-excel-if-row-above-is-not-empty", "title": "Insert blank rows in excel if row above is not empty", "body": "<p>If A1 is not empty (contains actual data), is there a way to if-then so that I can insert a blank row under A1.  This should apply to any cell/row as I have a spreadsheet with about 65000 rows and they want to have blanks to separate the rows that contain different identifiers.  I looked on here, right before I signed up, and I saw some things about empty cells or making cells empty depending on other cells, but that doesn't seem to be what I'm looking for.  Google wasn't too much help either.</p>\n\n<p>thanks.</p>\n"}, {"tags": ["vba", "email", "outlook"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1438184121, "post_id": 31704322, "comment_id": 51348441, "body": "What shows up in the locals window for Msg? This code works fine for me. Also, just a comment but the olApp variable is not needed here.  What do you mean there is nothing in the tab?"}, {"owner": {"reputation": 1135, "user_id": 2505594, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/J5CgE.jpg?s=128&g=1", "display_name": "Chase Ernst", "link": "https://stackoverflow.com/users/2505594/chase-ernst"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1438184538, "post_id": 31704322, "comment_id": 51348787, "body": "It comes up blank, but I actually just figured out what the problem was a second ago. I will submit my answer."}], "answers": [{"tags": [], "owner": {"reputation": 1135, "user_id": 2505594, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/J5CgE.jpg?s=128&g=1", "display_name": "Chase Ernst", "link": "https://stackoverflow.com/users/2505594/chase-ernst"}, "is_accepted": true, "score": 2, "last_activity_date": 1438184630, "creation_date": 1438184630, "answer_id": 31705161, "question_id": 31704322, "link": "https://stackoverflow.com/questions/31704322/no-body-in-outlook-email/31705161#31705161", "title": "No body in outlook email", "body": "<p>I ended up figuring this out myself.</p>\n\n<p>Because the email that I am working with is IMAP, only the subject line is downloaded from the server until the email is clicked, then downloading the body.</p>\n\n<p>I was able to access the body of the email by first accessing the subject line beforehande like so:</p>\n\n<pre><code>Set Msg = oNS.GetItemFromID(EntryIDCollection)\nMsgBox Msg\nMsgBox Msg.Body\n</code></pre>\n"}], "owner": {"reputation": 1135, "user_id": 2505594, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/J5CgE.jpg?s=128&g=1", "display_name": "Chase Ernst", "link": "https://stackoverflow.com/users/2505594/chase-ernst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 31705161, "answer_count": 1, "score": 0, "last_activity_date": 1438184630, "creation_date": 1438182443, "question_id": 31704322, "link": "https://stackoverflow.com/questions/31704322/no-body-in-outlook-email", "title": "No body in outlook email", "body": "<p>I am trying to get the body and head of an email upon receiving it in outlook. I am using the <code>NewMailEx</code> event handler to manage all emails that are coming in.</p>\n\n<pre><code>Private Sub Application_NewMailEx(ByVal EntryIDCollection As String)\n\nDim olApp As Outlook.Application\nDim oNS         As NameSpace\nDim oFolder     As MAPIFolder\nDim oNewMail    As MailItem\nSet olApp = Outlook.Application\nSet oNS = GetNamespace(\"MAPI\")\nSet oFolder = oNS.GetDefaultFolder(olFolderInbox)\nSet oNewMail = oFolder.Items.GetFirst\n\nSet Msg = oNS.GetItemFromID(EntryIDCollection)\nMsgBox Msg.Body\n\nEnd Sub\n</code></pre>\n\n<p>This function is being called successfully, and I can get the header of the email by using:</p>\n\n<pre><code>MsgBox Msg\n</code></pre>\n\n<p>But when I try to use <code>Msg.Body</code> nothing is displayed in the <code>MsgBox</code>. Additionally, when I use <code>Msg.HTMLBody</code> I can see the html in the <code>MsgBox</code>, but still there is nothing in the  tag.</p>\n\n<p>Any suggestions on what I am doing wrong here?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 2483830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56906e8ec74219208b8b7911bec684f8?s=128&d=identicon&r=PG", "display_name": "thisismario123", "link": "https://stackoverflow.com/users/2483830/thisismario123"}, "is_accepted": false, "score": 0, "last_activity_date": 1438183331, "creation_date": 1438183331, "answer_id": 31704676, "question_id": 31704208, "link": "https://stackoverflow.com/questions/31704208/copying-large-excel-files-into-500-row-smaller-files/31704676#31704676", "title": "Copying Large Excel Files into 500 row Smaller Files", "body": "<p>The Range(Cell1, Cell2) selects the cells starting from Cell1 through Cell2.  You can copy and paste the header first and then the Copyrange you want after the fact.</p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 4074840, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-byBG9xAqj5U/AAAAAAAAAAI/AAAAAAAAElo/jaltckFCNX0/photo.jpg?sz=128", "display_name": "Amanda", "link": "https://stackoverflow.com/users/4074840/amanda"}, "edited": false, "score": 0, "creation_date": 1438186125, "post_id": 31704802, "comment_id": 51349833, "body": "Ohhhh! That makes sense! Thank you!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1438183700, "creation_date": 1438183700, "answer_id": 31704802, "question_id": 31704208, "link": "https://stackoverflow.com/questions/31704208/copying-large-excel-files-into-500-row-smaller-files/31704802#31704802", "title": "Copying Large Excel Files into 500 row Smaller Files", "body": "<p>You are extending the <code>Copyrange</code> from the header row to the last row that you want to copy. As mentioned, you could run two operations or hide the rows that have already been copied.</p>\n\n<pre><code>Do While Range(Startcell) &lt;&gt; \"\"\n    Range(\"A1:BZ1\", Copyrange).Copy    'Includes A1:BZ1 to copy header row as well\n    Set NewBook = Workbooks.Add\n    NewBook.Worksheets(\"Sheet1\").Range(\"A1\").PasteSpecial Paste:=xlPasteAllUsingSourceTheme\n    NewBook.SaveAs Filename:=Range(\"AJ2\").Text &amp; \"_Sams_Apex_\" &amp; Month &amp; \" \" &amp; Year &amp; \"_File \" &amp; Filenumber &amp; \".csv\", FileFormat:=xlCSV\n    NewBook.Close Savechanges:=False\n\n    'hide the ones already copied. hidden rows will not be copied to the new location\n    copyrange.resize(copyrange.rows.count - 1, copyrange.columns.count).offset(1, 0).entirerow.hidden = true\n\n    Firstrow = Firstrow + 500\n    Lastrow = Firstrow + 499\n    Filenumber = Filenumber + 1\n    Let Startcell = \"A\" &amp; Firstrow\n    Let Copyrange = \"A\" &amp; Firstrow &amp; \":\" &amp; \"BZ\" &amp; Lastrow\nLoop\n</code></pre>\n\n<p>Don't forget to unhide all of the rows after the splitting operation has completed.</p>\n"}], "owner": {"reputation": 9, "user_id": 4074840, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-byBG9xAqj5U/AAAAAAAAAAI/AAAAAAAAElo/jaltckFCNX0/photo.jpg?sz=128", "display_name": "Amanda", "link": "https://stackoverflow.com/users/4074840/amanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1438183700, "creation_date": 1438182128, "question_id": 31704208, "link": "https://stackoverflow.com/questions/31704208/copying-large-excel-files-into-500-row-smaller-files", "title": "Copying Large Excel Files into 500 row Smaller Files", "body": "<p>I have the vba code below in Excel that <em>almost</em> works. I'm having an issue where the \"firstrow\" isn't increasing. The first file will contain rows 1-501, the second file will contain 1-1001 (I want it to contain row 1 &amp; 502-1001). I'm sure it's a small issue but I've stared at it for a while and can't seem to figure out whats wrong. Some help would be really awesome!!</p>\n\n<pre><code>Sub FiveHundredLineCopy()\n\nDim Firstrow As Integer\nDim Lastrow As Integer\nDim Copyrange As String\nDim Startcell As String\nDim Month, Year As String\n\nFirstrow = 2    'Starts on row 2 to exclude header\nLastrow = Firstrow + 499\nMonth = Nov 'Month of Clinic for filename\nYear = 2014 'Year of Clinic for filename\nFilenumber = 1  'First file in sequence\n\nLet Startcell = \"A\" &amp; Firstrow\nLet Copyrange = \"A\" &amp; Firstrow &amp; \":\" &amp; \"BZ\" &amp; Lastrow       'Only copying through column BZ\n\nDo While Range(Startcell) &lt;&gt; \"\"\n    Range(\"A1:BZ1\", Copyrange).Copy    'Includes A1:BZ1 to copy header row as well\n    Set NewBook = Workbooks.Add\n    NewBook.Worksheets(\"Sheet1\").Range(\"A1\").PasteSpecial Paste:=xlPasteAllUsingSourceTheme\n    NewBook.SaveAs Filename:=Range(\"AJ2\").Text &amp; \"_Sams_Apex_\" &amp; Month &amp; \" \" &amp; Year &amp; \"_File \" &amp; Filenumber &amp; \".csv\", FileFormat:=xlCSV\n    NewBook.Close Savechanges:=False\n\n    Firstrow = Firstrow + 500\n    Lastrow = Firstrow + 499\n    Filenumber = Filenumber + 1\n    Let Startcell = \"A\" &amp; Firstrow\n    Let Copyrange = \"A\" &amp; Firstrow &amp; \":\" &amp; \"BZ\" &amp; Lastrow\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-interop"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1438182494, "post_id": 31704111, "comment_id": 51347181, "body": "The only way I can see to identify the problem ranges would be to test the intersection of blanks and non-blanks and calculate the overlap from that. I can&#39;t belileve that would be quicker than loading all the cell values into an array and processing that."}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1438182502, "post_id": 31704111, "comment_id": 51347190, "body": "Is having merged cells unavoidable? Can you use Range(&quot;A1:A2&quot;).HorizontalAlignment = xlCenterAcrossSelection instead?"}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1438182556, "post_id": 31704111, "comment_id": 51347228, "body": "Alternatively, unmerge the cells, do your stuff, then merge again."}, {"owner": {"reputation": 5501, "user_id": 26671, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2adc341d617a3feea53cad5ef6dda2aa?s=128&d=identicon&r=PG", "display_name": "Ken Paul", "link": "https://stackoverflow.com/users/26671/ken-paul"}, "edited": false, "score": 0, "creation_date": 1438183681, "post_id": 31704111, "comment_id": 51348063, "body": "The merging is complex and based on data in large worksheets - definitely not convenient to unmerge/remerge after the fact.  I&#39;ll try &quot;doing my stuff&quot; in small pieces before any merging calculations, rather than all at once at the end, and hope it&#39;s not a big performance hit.  Thanks."}, {"owner": {"reputation": 2019, "user_id": 244549, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e39b233a11ac12c2d92d6b229fc9b88?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/244549/michael"}, "edited": false, "score": 0, "creation_date": 1438186472, "post_id": 31704111, "comment_id": 51350061, "body": "Not really happy with this approach, but depending on how big your range is, you can loop through each cell of your range and determine if it is part of a <code>.MergeArea</code>.  You can use <code>Cells(r,c).MergeArea.Cells.Count</code> to determine how many cells are in the current merged area and then store <code>Cells(r,c).MergeArea.Address</code>  in an array to make sure you are not counting the merged area more than once.  At least you wouldn&#39;t have to change any of your existing merging code and you can process everything after-the-fact"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1438187005, "post_id": 31704111, "comment_id": 51350409, "body": "I think with that merge A2 and A3 are the blanks - merged cells are defined by their top-left cell."}, {"owner": {"reputation": 5501, "user_id": 26671, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2adc341d617a3feea53cad5ef6dda2aa?s=128&d=identicon&r=PG", "display_name": "Ken Paul", "link": "https://stackoverflow.com/users/26671/ken-paul"}, "reply_to_user": {"reputation": 2019, "user_id": 244549, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e39b233a11ac12c2d92d6b229fc9b88?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/244549/michael"}, "edited": false, "score": 0, "creation_date": 1438187157, "post_id": 31704111, "comment_id": 51350513, "body": "I had considered that, too, @Michael, but it&#39;s messy.  Another thing I tried was to chain a range selection using xlCellTypeBlanks to a range selected with xlCellTypeVisible, but apparently you can&#39;t chain the ranges like that.  Also, xlCellTypeVisible includes all of the merged cells, so that wouldn&#39;t work anyway."}], "answers": [{"tags": [], "owner": {"reputation": 5501, "user_id": 26671, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2adc341d617a3feea53cad5ef6dda2aa?s=128&d=identicon&r=PG", "display_name": "Ken Paul", "link": "https://stackoverflow.com/users/26671/ken-paul"}, "is_accepted": false, "score": 0, "last_activity_date": 1438193158, "creation_date": 1438193158, "answer_id": 31707963, "question_id": 31704111, "link": "https://stackoverflow.com/questions/31704111/excel-specialcellsxlcelltypeblanks-fails-with-merged-cells/31707963#31707963", "title": "Excel SpecialCells(xlCellTypeBlanks) fails with merged cells", "body": "<p>I got this to work by selecting smaller ranges at various places in the code, usually just before doing any cell merging.  I consider this to be a workaround, not really a solution.  Thanks to those who commented - you helped inspire this workaround.</p>\n"}], "owner": {"reputation": 5501, "user_id": 26671, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2adc341d617a3feea53cad5ef6dda2aa?s=128&d=identicon&r=PG", "display_name": "Ken Paul", "link": "https://stackoverflow.com/users/26671/ken-paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 538, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1438193158, "creation_date": 1438181833, "question_id": 31704111, "link": "https://stackoverflow.com/questions/31704111/excel-specialcellsxlcelltypeblanks-fails-with-merged-cells", "title": "Excel SpecialCells(xlCellTypeBlanks) fails with merged cells", "body": "<p>Excel SpecialCells(xlCellTypeBlank) includes all cells in a merged range, regardless of whether they are blank.  I consider this to be a bug, and I desperately need a workaround.  Steps to duplicate:</p>\n\n<p>(1) Create a worksheet with some text in cells A1 and B3. Now <code>activesheet.usedrange.cells.count</code> = 6 and\n<code>activesheet.usedrange.specialcells(xlcelltypeblanks).cells.count</code> = 4\nThese values are as expected.</p>\n\n<p>(2) Now merge cells A1:A2, and\n<code>activesheet.usedrange.cells.count</code> = 6 and\n<code>activesheet.usedrange.specialcells(xlcelltypeblanks).cells.count</code> = 5\nBoth A1 and A2 are now considered blank.</p>\n\n<p>I need to find a way to select just cells A3, B1, and B2 in this case.  I'm actually doing this using .NET Excel Interop, so I do not want to have to actually retrieve the cell value as a part of the test, since this is a huge performance penalty in Excel Interop; so I'm restricted to an internal cell selection function such as SpecialCells.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1438181033, "post_id": 31703554, "comment_id": 51346053, "body": "put a break point on the save part. add a watch on the person(i,1). when you are expecting it to overwright see what is happening and see what ?FILE_PATH &amp; personList(i, 1) &amp; FILE_EXT equates to. There should be nothing wrong with your code"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 2, "creation_date": 1438183518, "post_id": 31703554, "comment_id": 51347927, "body": "<code>.SaveAs2</code> isn&#39;t available in Excel VBA - are you using this in another program? Or are you working with word documents?"}, {"owner": {"reputation": 109, "user_id": 3918121, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/531bdda1de6b1d10871b3ea8805f8c55?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan89BEG", "link": "https://stackoverflow.com/users/3918121/stefan89beg"}, "edited": false, "score": 0, "creation_date": 1438249644, "post_id": 31703554, "comment_id": 51377544, "body": "I am working with word documents, through bookmarks I am inserting some values from cells into a word docs.."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 3918121, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/531bdda1de6b1d10871b3ea8805f8c55?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan89BEG", "link": "https://stackoverflow.com/users/3918121/stefan89beg"}, "edited": false, "score": 0, "creation_date": 1438182748, "post_id": 31703664, "comment_id": 51347354, "body": "why did you pu &amp;&quot;1&quot;&amp;?"}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1438191858, "post_id": 31703664, "comment_id": 51353292, "body": "@MacroMan Thanks for the laugh!"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 2964, "user_id": 2246380, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/piBvo.png?s=128&g=1", "display_name": "Ram", "link": "https://stackoverflow.com/users/2246380/ram"}, "edited": false, "score": 0, "creation_date": 1438193685, "post_id": 31703664, "comment_id": 51354396, "body": "@Ram it&#39;s commented, which bit would you like explaining?"}, {"owner": {"reputation": 2964, "user_id": 2246380, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/piBvo.png?s=128&g=1", "display_name": "Ram", "link": "https://stackoverflow.com/users/2246380/ram"}, "edited": false, "score": 0, "creation_date": 1438196293, "post_id": 31703664, "comment_id": 51355936, "body": "@This answer came up in the low quality posts review queue so dropped a comment to expand the answer."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 2964, "user_id": 2246380, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/piBvo.png?s=128&g=1", "display_name": "Ram", "link": "https://stackoverflow.com/users/2246380/ram"}, "edited": false, "score": 0, "creation_date": 1438196605, "post_id": 31703664, "comment_id": 51356133, "body": "@Ram ah, ok. I think the comments explain so I&#39;ll leave it as it is."}, {"owner": {"reputation": 109, "user_id": 3918121, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/531bdda1de6b1d10871b3ea8805f8c55?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan89BEG", "link": "https://stackoverflow.com/users/3918121/stefan89beg"}, "edited": false, "score": 0, "creation_date": 1438249714, "post_id": 31703664, "comment_id": 51377592, "body": "Yeah, but I dont get it why &quot;1&quot;. I put &quot;1&quot; for .SaveAs2 line of code. <code>FILE_PATH &amp; &quot;1&quot; &amp; personList(i, 1) &amp; FILE_EXT</code> isnt right path, the right path is <code>FILE_PATH &amp; personList(i, 1) &amp; FILE_EXT</code>  Thanks!"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 109, "user_id": 3918121, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/531bdda1de6b1d10871b3ea8805f8c55?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan89BEG", "link": "https://stackoverflow.com/users/3918121/stefan89beg"}, "edited": false, "score": 0, "creation_date": 1438250022, "post_id": 31703664, "comment_id": 51377806, "body": "@Stefan89BEG Okay, I&#39;ve edited above - does this solve the issue?"}, {"owner": {"reputation": 109, "user_id": 3918121, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/531bdda1de6b1d10871b3ea8805f8c55?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan89BEG", "link": "https://stackoverflow.com/users/3918121/stefan89beg"}, "edited": false, "score": 0, "creation_date": 1438258552, "post_id": 31703664, "comment_id": 51383277, "body": "@Macro Man, i will try this in 20 minutes, and we will know if it works. tnx on your effort, I really appreciate it."}, {"owner": {"reputation": 109, "user_id": 3918121, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/531bdda1de6b1d10871b3ea8805f8c55?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan89BEG", "link": "https://stackoverflow.com/users/3918121/stefan89beg"}, "edited": false, "score": 0, "creation_date": 1438349396, "post_id": 31703664, "comment_id": 51428327, "body": "You meant on this: `        If FileLen(FILE_PATH &amp; personList(i, 1) &amp; FILE_EXT) &gt; 0 Then     .SaveAs2 FILE_PATH &amp; personList(i, 1) &amp; &quot;1&quot; &amp; FILE_EXT                    .Close &#39;// File Exists, change name accordingly. Else    .SaveAs2 FILE_PATH &amp; personList(i, 1) &amp; FILE_EXT                           .Close &#39;// File doesn&#39;t exist, save as is. End If`   it doesnt working.."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 0, "last_activity_date": 1438250026, "last_edit_date": 1438250026, "creation_date": 1438180732, "answer_id": 31703664, "question_id": 31703554, "link": "https://stackoverflow.com/questions/31703554/save-with-a-different-name-if-the-file-already-exists-in-directory/31703664#31703664", "title": "Save with a different name if the file already exists in directory", "body": "<pre><code>If FileLen(FILE_PATH &amp; personList(i, 1) &amp; FILE_EXT) &gt; 0 Then\n    '// File Exists, change name accordingly.\nElse\n    '// File doesn't exist, save as is.\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 109, "user_id": 3918121, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/531bdda1de6b1d10871b3ea8805f8c55?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan89BEG", "link": "https://stackoverflow.com/users/3918121/stefan89beg"}, "edited": false, "score": 0, "creation_date": 1438182606, "post_id": 31703732, "comment_id": 51347257, "body": "mielk, I&#39;ve copied function in the module, below the main sub, when I hit f5, no error, but no files either in the path..."}, {"owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "reply_to_user": {"reputation": 109, "user_id": 3918121, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/531bdda1de6b1d10871b3ea8805f8c55?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan89BEG", "link": "https://stackoverflow.com/users/3918121/stefan89beg"}, "edited": false, "score": 0, "creation_date": 1438183303, "post_id": 31703732, "comment_id": 51347777, "body": "What happens if you run it in the Immediate window and give some existing path as a parameter?"}], "tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": false, "score": 0, "last_activity_date": 1438199669, "last_edit_date": 1438199669, "creation_date": 1438180921, "answer_id": 31703732, "question_id": 31703554, "link": "https://stackoverflow.com/questions/31703554/save-with-a-different-name-if-the-file-already-exists-in-directory/31703732#31703732", "title": "Save with a different name if the file already exists in directory", "body": "<p>Here is the function for creating unique filepath <a href=\"http://mielk.pl/en/download/code/system/uniqueFilePath.php\" rel=\"nofollow\">(taken from http://mielk.pl/)</a>:</p>\n\n<pre><code>Public Function uniqueFilePath(filepath As String) As String\n    Const METHOD_NAME As String = \"uniqueFilePath\"\n    '------------------------------------------------------------------------------------------------------\n    Static objFSO As Object                 '(Late binding that allows to use the function, even if\n                                            'Microsoft Scripting Runtime library is not loaded)\n    Dim strFileExtension As String\n    Dim strFileName As String\n    Dim strParentFolder As String\n    Dim strTempFilePath As String\n    Dim intCounter As Integer\n    '------------------------------------------------------------------------------------------------------\n\n\n\n    'Create FileSystemObject instance if it hasn't been created yet. ------------------------------------|\n    If objFSO Is Nothing Then                                                                           '|\n        Set objFSO = VBA.CreateObject(\"Scripting.FileSystemObject\")                                     '|\n    End If                                                                                              '|\n    '----------------------------------------------------------------------------------------------------|\n\n\n    With objFSO\n\n        'Checks if the file already exists. -------------------------------------------------------------|\n        If .fileExists(filepath) Then                                                                   '|\n                                                                                                        '|\n            'If the given filepath already exists, function transforms its name by                      '|\n            'appending the number in brackets.                                                          '|\n            strParentFolder = .GetParentFolderName(filepath)                                            '|\n            If Not VBA.right$(strParentFolder, 1) = \"\\\" Then strParentFolder = strParentFolder &amp; \"\\\"    '|\n            strFileName = .GetBaseName(filepath)                                                        '|\n            strFileExtension = \".\" &amp; .GetExtensionName(filepath)                                        '|\n                                                                                                        '|\n            '------------------------------------------------------------------------------------|      '|\n            Do                                                                                  '|      '|\n                intCounter = intCounter + 1                                                     '|      '|\n                strTempFilePath = strParentFolder &amp; strFileName &amp; _\n                                                \" (\" &amp; intCounter &amp; \")\" &amp; strFileExtension      '|      '|\n            Loop While .fileExists(strTempFilePath)                                             '|      '|\n            '------------------------------------------------------------------------------------|      '|\n                                                                                                        '|\n            uniqueFilePath = strTempFilePath                                                            '|\n                                                                                                        '|\n        Else                                                                                            '|\n                                                                                                        '|\n            'Specified filepath is unique in the file system and is returned in its original form.      '|\n            uniqueFilePath = filepath                                                                   '|\n                                                                                                        '|\n        End If                                                                                          '|\n        '-------- [If .FileExists(filepath) Then] -------------------------------------------------------|\n\n    End With\n\n\nEnd Function\n</code></pre>\n\n<p>In order to make the code below work properly you must paste it in your code.</p>\n\n<p>If the filepath you give as a parameter already exists, <strong>function returns the same filepath with the number in bracket appended</strong>, i.e. if file \"C:\\file.xlsx\" already exists function returns \"C:\\file (1).xlsx\". </p>\n\n<p>If this file doesn't exists the <strong>function returns the original filepath</strong> without any changes.</p>\n\n<p>Replace all the code you pasted in your question with the below:</p>\n\n<pre><code>Dim filepath As String\n\nfilepath = uniqueFilePath(FILE_PATH &amp; personList(i, 1) &amp; FILE_EXT)\nCall .SaveAs(filepath)\nCall .Close\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": false, "score": 0, "last_activity_date": 1438181130, "creation_date": 1438181130, "answer_id": 31703826, "question_id": 31703554, "link": "https://stackoverflow.com/questions/31703554/save-with-a-different-name-if-the-file-already-exists-in-directory/31703826#31703826", "title": "Save with a different name if the file already exists in directory", "body": "<p>I use something very similar, for upissuing documents. Could see if you can change this to your needs</p>\n\n<pre><code>Rechecker:\nFilename = Sheets(\"Word_Front\").Range(\"N142\").Value\nIf Not (Update_Only) Then\n    If Dir(sDocPath &amp; Filename &amp; Cert &amp; \".docx\") &lt;&gt; \"\" Then\n        iret = MsgBox(\"Existing file found with this filename, Answer YES to up-issue the file. Please note there is no further warning and NO to overwrite the file.\", vbYesNo)\n        If iret = 6 Then\n            Sheets(\"Word_Front\").Range(\"Q7\").Value = Sheets(\"Word_Front\").Range(\"Q7\").Value + 1\n            GoTo Rechecker\n        Else\n            oDoc.SaveAs sDocPath &amp; Filename &amp; Cert &amp; \".docx\", 16\n        End If\n    Else\n        oDoc.SaveAs sDocPath &amp; Filename &amp; Cert &amp; \".docx\", 16\n    End If\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1438186955, "creation_date": 1438186955, "answer_id": 31706033, "question_id": 31703554, "link": "https://stackoverflow.com/questions/31703554/save-with-a-different-name-if-the-file-already-exists-in-directory/31706033#31706033", "title": "Save with a different name if the file already exists in directory", "body": "<p>I've had this function hanging around for an age - not sure where I got it from though.  It will pause if the file name hasn't got an extension, or there's more than 100 files with the same base name:</p>\n\n<pre><code>Sub test()\n\n    Debug.Print GenerateUniqueName(\"S:\\Bartrup-CookD\\New Folder\\Book1.xlsm\")\n\nEnd Sub\n\n'----------------------------------------------------------------------\n' GenerateUniqueName\n'\n'   Generates a file name that doesn't exist by appending a number\n'   in between the base name and the extension.\n'   Example: GenerateUniqueName(\"c:\\folder\\file.ext\") = \"c:\\folder\\file4.ext\"\n'----------------------------------------------------------------------\nFunction GenerateUniqueName(FullFileName As String, Optional fAlwaysAddNumber As Boolean) As String\n\n    Dim objFSO As Object: Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n\n    If Not objFSO.FileExists(FullFileName) And Not fAlwaysAddNumber Then\n        GenerateUniqueName = FullFileName\n    Else\n        Dim strExt As String\n        Dim strNonExt As String\n        Dim strNewName As String\n        Dim i As Integer\n        strExt = objFSO.GetExtensionName(FullFileName)\n        Debug.Assert strExt &lt;&gt; \"\"\n        strNonExt = objFSO.BuildPath(objFSO.GetParentFolderName(FullFileName), objFSO.GetBaseName(FullFileName))\n        Do\n            Debug.Assert i &lt; 100\n            i = i + 1\n            strNewName = strNonExt &amp; i &amp; \".\" &amp; strExt\n\n        Loop While objFSO.FileExists(strNewName)\n        GenerateUniqueName = strNewName\n    End If\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 109, "user_id": 3918121, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/531bdda1de6b1d10871b3ea8805f8c55?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan89BEG", "link": "https://stackoverflow.com/users/3918121/stefan89beg"}, "edited": false, "score": 0, "creation_date": 1438258402, "post_id": 31706252, "comment_id": 51383180, "body": "I will try this today, and will let you know the result. tnx"}, {"owner": {"reputation": 109, "user_id": 3918121, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/531bdda1de6b1d10871b3ea8805f8c55?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan89BEG", "link": "https://stackoverflow.com/users/3918121/stefan89beg"}, "edited": false, "score": 0, "creation_date": 1438349566, "post_id": 31706252, "comment_id": 51428471, "body": "<code>.SaveAs2 GetNextAvailableName (&quot;D:\\template.doc&quot;)</code>  is this ok?"}, {"owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "edited": false, "score": 0, "creation_date": 1503618690, "post_id": 31706252, "comment_id": 78703787, "body": "Works great!  I added <code>i = 2</code> before the <code>Do While</code> loop so that I don&#39;t end up with &quot;MyFile - 1.ext&quot;.  In my mind, it&#39;s confusing to have &quot;MyFile.ext&quot; and &quot;MyFile - 1.ext&quot;.  Thanks @Bond!"}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": true, "score": 5, "last_activity_date": 1438187709, "creation_date": 1438187709, "answer_id": 31706252, "question_id": 31703554, "link": "https://stackoverflow.com/questions/31703554/save-with-a-different-name-if-the-file-already-exists-in-directory/31706252#31706252", "title": "Save with a different name if the file already exists in directory", "body": "<p>Here's a function you can use to retrieve a unique file name for any given path. It will suffix the filename with a <code>\" - n\"</code>, where <code>n</code> is a sequential number.</p>\n\n<pre><code>Function GetNextAvailableName(ByVal strPath As String) As String\n\n    With CreateObject(\"Scripting.FileSystemObject\")\n\n        Dim strFolder As String, strBaseName As String, strExt As String, i As Long\n        strFolder   = .GetParentFolderName(strPath)\n        strBaseName = .GetBaseName(strPath)\n        strExt      = .GetExtensionName(strPath)\n\n        Do While .FileExists(strPath)\n            i = i + 1\n            strPath = .BuildPath(strFolder, strBaseName &amp; \" - \" &amp; i &amp; \".\" &amp; strExt)\n        Loop\n\n    End With\n\n    GetNextAvailableName = strPath\n\nEnd Function\n</code></pre>\n\n<p>Assuming the file <code>c:\\path\\to\\file.ext</code> exists, the following call:</p>\n\n<pre><code>Debug.Print GetNextAvailableName(\"c:\\path\\to\\file.ext\")\n</code></pre>\n\n<p>would print:</p>\n\n<pre><code>c:\\path\\to\\file - 1.ext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": false, "score": 0, "last_activity_date": 1438188843, "creation_date": 1438188843, "answer_id": 31706615, "question_id": 31703554, "link": "https://stackoverflow.com/questions/31703554/save-with-a-different-name-if-the-file-already-exists-in-directory/31706615#31706615", "title": "Save with a different name if the file already exists in directory", "body": "<p>A lot of these are very long answers for what seems like a pretty simple issue. Most reference a FileSystemObject; which I notice you have not referenced.</p>\n\n<p>My solution would be to use <code>WHILE</code> instead of <code>IF</code></p>\n\n<pre><code>While Dir(FILE_PATH &amp; personList(i, 1) &amp; FILE_EXT) &lt;&gt; \"\"\n    i = i + 1\nWend\n.SaveAs2 FILE_PATH &amp; i &amp; \"1\" &amp; personList(i, 1) &amp; FILE_EXT\n.Close\n</code></pre>\n\n<p>This preserves the \"1\" you have in your initial code when the file does not already exists. It also means that you can have a few thousand duplicate names in your list since the first John Doe's file would be named \"11John Doe\", the second would be \"21John Doe\", then \"31John Doe\", etc. Much lighter code that doesn't start implementing new libraries.</p>\n"}], "owner": {"reputation": 109, "user_id": 3918121, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/531bdda1de6b1d10871b3ea8805f8c55?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan89BEG", "link": "https://stackoverflow.com/users/3918121/stefan89beg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11057, "favorite_count": 0, "accepted_answer_id": 31706252, "answer_count": 6, "score": 4, "last_activity_date": 1438250026, "creation_date": 1438180447, "last_edit_date": 1438187825, "question_id": 31703554, "link": "https://stackoverflow.com/questions/31703554/save-with-a-different-name-if-the-file-already-exists-in-directory", "title": "Save with a different name if the file already exists in directory", "body": "<p>I don't know where I am wrong with this code. </p>\n\n<pre><code>If Dir(FILE_PATH &amp; personList(i, 1) &amp; FILE_EXT) &lt;&gt; \"\" Then\n    .SaveAs2 FILE_PATH &amp; \"1\" &amp; personList(i, 1) &amp; FILE_EXT\n    .Close\nElse\n    .SaveAs2 FILE_PATH &amp; personList(i, 1) &amp; FILE_EXT\n    .Close\nEnd If\n</code></pre>\n\n<p>Everything just works fine, but when I encounter the same value in a column (for example: John Doe, John Doe), the program overwrites the first John Doe file.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 524, "user_id": 2437115, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d8bd11966c6e2a7ac1d64e9f7c4fd78?s=128&d=identicon&r=PG", "display_name": "andrescpacheco", "link": "https://stackoverflow.com/users/2437115/andrescpacheco"}, "edited": false, "score": 0, "creation_date": 1438181684, "post_id": 31703383, "comment_id": 51346555, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/20716733/optimize-code-to-minimize-runtime-of-the-macro\">Optimize code to minimize runtime of the macro</a>"}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 2, "creation_date": 1438182006, "post_id": 31703383, "comment_id": 51346820, "body": "This should be on <code>codereview.stackexchange.com</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": false, "score": 2, "last_activity_date": 1438180626, "creation_date": 1438180626, "answer_id": 31703631, "question_id": 31703383, "link": "https://stackoverflow.com/questions/31703383/making-vba-excel-code-more-efficient/31703631#31703631", "title": "Making VBA-Excel code more Efficient", "body": "<p>This will make it a bit more efficient</p>\n\n<pre><code>Dim MasterList As New Dictionary\nDim iListCount As Integer\nDim x As Variant\nDim iCtr As Integer\nDim v As Variant\nDim counter As Integer, i As Integer\ncounter = 0\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\nWith Sheets(\"Sheet2\")\n    .Range(\"M:M\").ClearContents\n\n    Sheets(\"Sheet1\").Range(\"C:C\").Copy\n    .Range(\"M1\").Paste\n\n    ' Get count of records in master list\n    iListCount = .Cells(Rows.Count, \"A\").End(xlUp).Row\n    'Load Dictionary:\n    For iCtr = 1 To iListCount\n        v = .Cells(iCtr, \"A\").Value\n        If Not MasterList.Exists(v) Then MasterList.Add v, \"\"\n    Next iCtr\n\n    'Get count of records in list to be deleted\n    iListCount = .Cells(Rows.Count, \"M\").End(xlUp).Row\n\n    ' Loop through the \"delete\" list.\n    For iCtr = iListCount To 1 Step -1\n        If MasterList.Exists(.Cells(iCtr, \"M\").Value) Then\n            .Cells(iCtr, \"M\").Delete shift:=xlUp\n        End If\n    Next iCtr\n\nEnd With\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\n\nMsgBox \"Done!\"\n</code></pre>\n\n<p>If you really wanted to make it more effceint I would change below</p>\n\n<pre><code>    ' Loop through the \"delete\" list.\n    For iCtr = iListCount To 1 Step -1\n        If MasterList.Exists(.Cells(iCtr, \"M\").Value) Then\n            .Cells(iCtr, \"M\").Delete shift:=xlUp\n        End If\n    Next iCtr\n</code></pre>\n\n<p>So that you miss the sheet. e.g. delete them out of the dictionary and then clear the list and then output the dictionary in one line of code. Accessing the sheet is the costly part in terms of CPU use, limit how many times you access the sheet for much much faster code. you could also try to remove the loop for reading entries in and try and do that in one line of code too</p>\n\n<p>Slow parts to consider</p>\n\n<pre><code>.Cells(iCtr, \"A\").Value\n</code></pre>\n\n<p>and probably causing most of the time below</p>\n\n<pre><code>.Cells(iCtr, \"M\").Delete shift:=xlUp\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "is_accepted": true, "score": 2, "last_activity_date": 1438181360, "creation_date": 1438181360, "answer_id": 31703914, "question_id": 31703383, "link": "https://stackoverflow.com/questions/31703383/making-vba-excel-code-more-efficient/31703914#31703914", "title": "Making VBA-Excel code more Efficient", "body": "<p>Don't copy and paste from sheet 1 to sheet 2. Store the values from both sheets in arrays:</p>\n\n<pre><code>Dim v1 as variant, v2 as variant\n\nv1 = Sheet1.Range(\"C:C\").Value\nv2 = Sheet2.Range(\"A1\").Resize(iListCount,1).Value\n</code></pre>\n\n<p>Then read the values in v1 into a dictionary, loop through the values in v2 and check if each of them exists in the dictionary or not. If they exist, remove the item from the dictionary.</p>\n"}, {"tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": false, "score": 0, "last_activity_date": 1438183246, "creation_date": 1438183246, "answer_id": 31704641, "question_id": 31703383, "link": "https://stackoverflow.com/questions/31703383/making-vba-excel-code-more-efficient/31704641#31704641", "title": "Making VBA-Excel code more Efficient", "body": "<p>Here is my version of optimized code. </p>\n\n<p>Comments about the concepts used are put in the code.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim MasterList As New Dictionary\n    Dim data As Variant\n    Dim dataSize As Long\n    Dim lastRow As Long\n    Dim row As Long\n    Dim value As Variant\n    Dim comparisonData As Variant\n    Dim finalResult() As Variant\n    Dim itemsAdded As Long\n    '-----------------------------------------------------------------\n\n\n    'First load data from column C of [Sheet1] into array (processing\n    'data from array is much more faster than processing data\n    'directly from worksheets).\n    'Also, there is no point to paste the data to column M of Sheet2 right now\n    'and then remove some of them. We will first remove unnecessary items\n    'and then paste the final set of data into column M of [Sheet2].\n    'It will reduce time because we can skip deleting rows and this operation\n    'was the most time consuming in your original code.\n    With Sheets(\"Sheet1\")\n        lastRow = .Range(\"C\" &amp; .Rows.Count).End(xlUp).row\n        data = .Range(\"C1:C\" &amp; lastRow)\n    End With\n\n\n    'We can leave this but we don't gain much with it right now,\n    'since all the operations will be calculated in VBA memory.\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n\n\n    'We make the same operation to load data from column A of Sheet2\n    'into another array - [comparisonData].\n    'It can seem as wasting time - first load into array instead\n    'of directly iterating through data, but in fact it will allow us\n    'to save a lot of time - since iterating through array is much more\n    'faster than through Excel range.\n    With Sheets(\"Sheet2\")\n        lastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).row\n        comparisonData = .Range(\"A1:A\" &amp; lastRow)\n    End With\n\n    'Iterate through all the items in array [comparisonData] and load them\n    'into dictionary.\n    For row = LBound(comparisonData, 1) To UBound(comparisonData, 1)\n        value = comparisonData(row, 1)\n\n        If Not MasterList.Exists(value) Then\n            Call MasterList.Add(value, \"\")\n        End If\n\n    Next row\n\n\n    'Change the size of [finalResult] array to make the place for all items\n    'assuming no data will be removed. It will save some time because we\n    'won't need to redim array with each iteration.\n    'Some items of this array will remain empty, but it doesn't matter\n    'since we only want to paste it into worksheet.\n    'We create 2-dimensional array to avoid transposing later and save\n    'even some more time.\n    dataSize = UBound(data, 1) - LBound(data, 1)\n    ReDim finalResult(1 To dataSize, 1 To 1)\n\n\n    'Now iterate through all the items in array [data] and compare them\n    'to dictionary [MasterList]. All the items that are found in\n    '[MasterDict] are added to finalResult array.\n    For row = LBound(data, 1) To UBound(data, 1)\n        value = data(row, 1)\n\n        If MasterList.Exists(value) Then\n            itemsAdded = itemsAdded + 1\n            finalResult(itemsAdded, 1) = value\n        End If\n\n    Next row\n\n\n\n    'Now the finalResult array is ready and we can print it into worksheet:\n    Dim rng As Range\n    With Sheets(\"Sheet2\")\n        Call .Range(\"M:M\").ClearContents\n        .Range(\"M1\").Resize(dataSize, 1) = finalResult\n    End With\n\n\n    'Restore previous settings.\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\n\n\n    MsgBox \"Done!\"\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5144451, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8fc3f591785d3adb6db7d9e921d81143?s=128&d=identicon&r=PG&f=1", "display_name": "Colm Donnelly", "link": "https://stackoverflow.com/users/5144451/colm-donnelly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 2, "accepted_answer_id": 31703914, "answer_count": 3, "score": 0, "last_activity_date": 1438241902, "creation_date": 1438180003, "last_edit_date": 1438241902, "question_id": 31703383, "link": "https://stackoverflow.com/questions/31703383/making-vba-excel-code-more-efficient", "title": "Making VBA-Excel code more Efficient", "body": "<p>I am running this vba code in Excel, it copies a columns from sheet 1, pastes it into sheet two. It then compares it to a column in sheet two before deleting any duplicates. </p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim MasterList As New Dictionary\n    Dim iListCount As Integer\n    Dim x As Variant\n    Dim iCtr As Integer\n    Dim v As Variant\n    Dim counter As Integer, i As Integer\n\n    counter = 0\n\n    Sheets(\"Sheet2\").Select\n    Sheets(\"Sheet2\").Range(\"M:M\").Select\n    Selection.ClearContents\n\n    Sheets(\"Sheet1\").Select\n    Sheets(\"Sheet1\").Range(\"C:C\").Select\n    Selection.Copy\n\n    Sheets(\"Sheet2\").Select\n    Sheets(\"Sheet2\").Range(\"M1\").Select\n    ActiveSheet.Paste\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n    ' Get count of records in master list\n    iListCount = Sheets(\"sheet2\").Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    'Load Dictionary:\n    For iCtr = 1 To iListCount\n        v = Sheets(\"sheet2\").Cells(iCtr, \"A\").value\n        If Not MasterList.Exists(v) Then MasterList.Add v, \"\"\n    Next iCtr\n\n    'Get count of records in list to be deleted\n    iListCount = Sheets(\"sheet2\").Cells(Rows.Count, \"M\").End(xlUp).Row\n\n\n    'Loop through the \"delete\" list.\n    For iCtr = iListCount To 1 Step -1\n        If MasterList.Exists(Sheets(\"Sheet2\").Cells(iCtr, \"M\").value) Then\n            Sheets(\"Sheet2\").Cells(iCtr, \"M\").Delete shift:=xlUp\n        End If\n    Next iCtr\n\n\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\n\n    MsgBox \"Done!\"\n\nEnd Sub\n</code></pre>\n\n<p>There is just under 30,000 rows that it has to compare so I know that it is always going to take some time, but I was wondering if there was any way to speed it up or even just make my code more streamline and efficient.</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 48, "user_id": 5980424, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/70GTy.jpg?s=128&g=1", "display_name": "PodHunter", "link": "https://stackoverflow.com/users/5980424/podhunter"}, "is_accepted": false, "score": 0, "last_activity_date": 1456502183, "creation_date": 1456502183, "answer_id": 35656226, "question_id": 31703167, "link": "https://stackoverflow.com/questions/31703167/vba-for-microstation-defining-a-position-about-an-angle/35656226#35656226", "title": "VBA for MicroStation - defining a position about an angle", "body": "<p>MicroStation is 3D, and using angles is not good way to deal with rotation.  A common approach in 3D math is to use a <em>rotation matrix</em>, which is fully supported by MicroStation VBA with the <code>Matrix3D</code> class.</p>\n\n<p>You can get the rotation matrix of a MicroStation view using <code>View.Rotation</code>.  You will find many methods that operate on a <code>Matrix3D</code> in MicroStation VBA help.  Those methods include calculating a scaling matrix and multiplying matrices (e.g. <code>scaling matrix . rotation matrix</code>) to obtain a rotation for your cell.</p>\n"}], "owner": {"reputation": 39, "user_id": 2069265, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/b59fo.jpg?s=128&g=1", "display_name": "CAD-wiz", "link": "https://stackoverflow.com/users/2069265/cad-wiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 745, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456502183, "creation_date": 1438179514, "question_id": 31703167, "link": "https://stackoverflow.com/questions/31703167/vba-for-microstation-defining-a-position-about-an-angle", "title": "VBA for MicroStation - defining a position about an angle", "body": "<p>This is more a maths conundrum than specifically coding but I'm sure I'll need help there too.</p>\n\n<p>I am writing some code to place a MicroStation cell at a chosen scale and then to use MicroStation commands to stretch part of the cell to another location. The coding was complete, I thought, as it worked in my test environment but in testing with some users it broke immediately. It took some time to establish the reason and it is caused by the on screen view having a rotation applied.</p>\n\n<p>My code relies on capturing the user placed position for the start of the cell placement retrieved using a point3d, I then need to select another point at a set distance along XY from the last point, this is adjusted by factoring in the chosen scale \"CellScale as integer\" so my second position is defined as:</p>\n\n<pre><code>PosFlood.X=Pos1.X + (0.35 * CellScale)\nPosFlood.Y=Pos1.Y + (0.007 * CellScale)\n</code></pre>\n\n<p>But this calculation is wrong when the view is rotated. I have been able to retrieve the rotation angle and set it as \"ViewAngle as Double\" but I don't know what formula to use to calculate my second position, I believe I need to use sin and cos but all searching has brought me up short. </p>\n\n<p>Hopefully there is a maths wizard out in cyber space who can put me on the right path?</p>\n\n<p>Thanks - Mark</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 5157511, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/19f33d26fe7a8c8edb28fde5543c7381?s=128&d=identicon&r=PG&f=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/5157511/striker"}, "edited": false, "score": 0, "creation_date": 1438181787, "post_id": 31703640, "comment_id": 51346641, "body": "Thank u for it and for the first  query I mean there can be duplicate  files in multiple folder so I want the count of the final search of the similar files with same names."}, {"owner": {"reputation": 237, "user_id": 5157511, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/19f33d26fe7a8c8edb28fde5543c7381?s=128&d=identicon&r=PG&f=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/5157511/striker"}, "edited": false, "score": 0, "creation_date": 1438189188, "post_id": 31703640, "comment_id": 51351750, "body": "Also the above code send all the pdf files in the directory. I want to send  only the files with names mentioned in the column A of the sheet one after the other after searching the files in the directory."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 237, "user_id": 5157511, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/19f33d26fe7a8c8edb28fde5543c7381?s=128&d=identicon&r=PG&f=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/5157511/striker"}, "edited": false, "score": 0, "creation_date": 1438189914, "post_id": 31703640, "comment_id": 51352181, "body": "You need to give more information in your question then"}, {"owner": {"reputation": 237, "user_id": 5157511, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/19f33d26fe7a8c8edb28fde5543c7381?s=128&d=identicon&r=PG&f=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/5157511/striker"}, "edited": false, "score": 0, "creation_date": 1438191576, "post_id": 31703640, "comment_id": 51353152, "body": "Sorry If I missed out explaining clearly. What changes should i make now for both the queries."}, {"owner": {"reputation": 237, "user_id": 5157511, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/19f33d26fe7a8c8edb28fde5543c7381?s=128&d=identicon&r=PG&f=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/5157511/striker"}, "edited": false, "score": 0, "creation_date": 1438275671, "post_id": 31703640, "comment_id": 51395296, "body": "I have been still trying for both the issues but couldn&#39;t find a code to resolve it."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 0, "last_activity_date": 1438182222, "last_edit_date": 1438182222, "creation_date": 1438180645, "answer_id": 31703640, "question_id": 31702973, "link": "https://stackoverflow.com/questions/31702973/pdf-file-seach-and-sending-it-through-outlook/31703640#31703640", "title": "PDF file seach and sending it through outlook", "body": "<p>You could simplify your code to this, which will search the directory (and sub-directories) for all PDF files using Windows scripting and then send each file found.</p>\n\n<p>This handles your second issue, but I don't understand your first issue as: </p>\n\n<p>a) How can you have identically named files in the same folder?<br>\nb) You haven't showed what you have tried yourself so far.  </p>\n\n<pre><code>Sub SO()\n\nConst masterFolder As String = \"C:\\Users\\Macro Man\\Files\"\nDim files, file\n\nfiles = Filter(Split(CreateObject(\"WScript.Shell\").Exec(\"CMD /C DIR \"\"\" &amp; masterFolder &amp; \"\\*.pdf\"\" /S /B /A:-D\").StdOut.ReadAll, vbCrLf), \".\")\n\nFor Each file In files\n    With Outlook.CreateItem(0)\n        .To = \"xxx@domain.com\"\n        .Subject = \"123\"\n        .BodyFormat = olFormatPlain\n        .Body = \"123\"\n        .Attachments.Add CStr(file)\n        .Send\n    End With\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 237, "user_id": 5157511, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/19f33d26fe7a8c8edb28fde5543c7381?s=128&d=identicon&r=PG&f=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/5157511/striker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1438182222, "creation_date": 1438179024, "last_edit_date": 1531164843, "question_id": 31702973, "link": "https://stackoverflow.com/questions/31702973/pdf-file-seach-and-sending-it-through-outlook", "title": "PDF file seach and sending it through outlook", "body": "<p>the below code search for the file in the mentioned folder and send the searched file through outlook. But I need to add few more conditions to it. </p>\n\n<ol>\n<li>It should also mention the count of files found in the folder with the same name > duplicate files&lt; and put the count in excel sheet next to the file name.</li>\n<li>The below code only search in a respective folder and not in sub-folders. It should search in sub-folders as well inside the folder for the files.  </li>\n</ol>\n\n<hr>\n\n<pre><code>Sub CheckandSend()\n\nDim obMail As Outlook.MailItem\n\nDim irow As Integer\n\nDim dpath As String\n\nDim pfile As String\n\n`dpath = \"xxxx\"\n\n`'' loop through all files and send mail\n\nirow = 1\n\n\nDo While Cells(irow, 1) &lt;&gt; Empty\n\n '' get file name in column A\n\npfile = Dir(dpath &amp; \"\\*\" &amp; Cells(irow, 1) &amp; \"*\")\n\n '' check file exist and pdf file \n\nIf pfile &lt;&gt; \"\" And Right(pfile, 3) = \"pdf\" \n\nThen\n\nSet obMail = Outlook.CreateItem(olMailItem)\n\n  With obMail\n    .To = \"xxx@domain.com\"\n    .Subject = \"123\"\n    .BodyFormat = olFormatPlain\n    .Body = \"123\"\n    .Attachments.Add (dpath &amp; \"\\\" &amp; pfile)\n    .Send\n\n End With\n\n End If\n\n irow = irow + 1\n\nLoop\n\nEnd sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 6, "last_activity_date": 1438179531, "last_edit_date": 1495535209, "creation_date": 1438179531, "answer_id": 31703175, "question_id": 31702885, "link": "https://stackoverflow.com/questions/31702885/copy-tables-to-another-worksheet/31703175#31703175", "title": "Copy tables to another worksheet", "body": "<p>You should be able to copy directly by providing the destination.</p>\n\n<pre><code>Sub CopyTables()\n\n    Worksheets(1).ListObjects(\"Table1\").Range.Copy _\n        Destination:=Worksheets(2).Range(\"A1\")\n\n\n    Worksheets(1).ListObjects(\"Table2\").Range.Copy _\n        Destination:=Worksheets(2).Range(\"O1\")\n\nEnd Sub\n</code></pre>\n\n<p>By directly and explicitly addressing the objects and their destinations, you can avoid <code>.Activate</code> and <code>.Select</code> altogether.</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more methods on getting away from relying on select and activate to accomplish your goals.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 8504986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9f05712ada29f6f211cafae05d5a0eb?s=128&d=identicon&r=PG&f=1", "display_name": "Ankush agarwal", "link": "https://stackoverflow.com/users/8504986/ankush-agarwal"}, "is_accepted": false, "score": 2, "last_activity_date": 1503484163, "last_edit_date": 1503484163, "creation_date": 1503478696, "answer_id": 45835096, "question_id": 31702885, "link": "https://stackoverflow.com/questions/31702885/copy-tables-to-another-worksheet/45835096#45835096", "title": "Copy tables to another worksheet", "body": "<p>Another method, simpler and shorter:</p>\n\n<pre><code>Range(\"Table1[#All]\").copy Range(\"L1\")\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 5152545, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2a915e73e126408742609a3da5e5938e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex664", "link": "https://stackoverflow.com/users/5152545/alex664"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41968, "favorite_count": 1, "accepted_answer_id": 31703175, "answer_count": 2, "score": 1, "last_activity_date": 1503484187, "creation_date": 1438178843, "last_edit_date": 1503484187, "question_id": 31702885, "link": "https://stackoverflow.com/questions/31702885/copy-tables-to-another-worksheet", "title": "Copy tables to another worksheet", "body": "<p>I have 2 tables, \"Table1\" and \"Table2\" in Worksheet(1). </p>\n\n<p>I would like to copy these tables to another worksheet(2) where the top left corner of Table1 is in the new worksheet at cell \"A1\" and the Top left corner cell of Table2 is in the new worksheet at cell \"O1.\" </p>\n\n<p>Unless the ActiveCell is A1 in Sheet2, the tables won't copy and paste correctly. Am I not activating a sheet correctly?</p>\n\n<pre><code>Sub CopyTables()\nWorksheets(2).Activate          'must be on ExHouStorm or Worksheet(1)\nWorksheets(1).ListObjects(\"Table1\").Range.Copy\nWorksheets(2).Paste\n\n\nWorksheets(1).ListObjects(\"Table2\").Range.Copy\nWorksheets(2).Range(\"O1\").Select\nWorksheets(2).Paste\n\nEnd Sub\n</code></pre>\n\n<p>This seems pretty simple as it partially works but I think I have a syntax mistake.</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": true, "score": 1, "last_activity_date": 1438187251, "last_edit_date": 1438187251, "creation_date": 1438179015, "answer_id": 31702965, "question_id": 31702850, "link": "https://stackoverflow.com/questions/31702850/remove-listbox-item-if-match-not-found-in-vba/31702965#31702965", "title": "Remove Listbox item if match not found in VBA", "body": "<p>You should iterate from the last item of list to the first, because removing items changes their indexation.</p>\n\n<p>Try to change your loop like that:</p>\n\n<pre><code>    For intItem = ListBox1.ListCount - 1 To 0 Step -1\n        If IsInArray(ListBox1.List(intItem), myarray) Then\n        Else\n            ListBox1.RemoveItem intItem\n        End If\n    Next\n</code></pre>\n\n<hr>\n\n<p>I have a tip for you connected with your task, but not exactly with the error described in question.</p>\n\n<p>For this type of task you should use object of <code>Dictionary</code> type instead of iterating through array - it would be much more effective. </p>\n\n<p>I have modified your code to use dictionary. Check it and compare the time each of those solutions need to complete this task - the one with dictionary should be much faster. If you have any questions regarding this code, let me know in comments.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim myArray As Variant\n    Dim intItem As Long\n    Dim dict As Object\n    Dim i As Long\n    Dim value As Variant\n\n\n    '--- [Loading data into dictionary] ------------------------------------\n    Set dict = VBA.CreateObject(\"Scripting.Dictionary\")\n    myArray = Sheet1.Range(\"A2:A1000\")\n\n    'Iterate through all the items in array and load them into dictionary.\n    For i = LBound(myArray) To UBound(myArray)\n\n        value = myArray(i, 1)\n\n        If Not IsEmpty(value) Then\n            If Not dict.exists(value) Then\n                Call dict.Add(value, 0)\n            End If\n        End If\n    Next i\n    '-----------------------------------------------------------------------\n\n\n\n    '--- [Comparing ListBox with dictionary] -------------------------------\n    With ListBox1\n        For intItem = .ListCount - 1 To 0 Step -1\n            value = .List(intItem)\n\n            If Not dict.exists(value) Then\n                .RemoveItem intItem\n            End If\n\n        Next\n    End With\n    '-----------------------------------------------------------------------\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 2829218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/046076f4867d2b4dd689c90db6e5d854?s=128&d=identicon&r=PG&f=1", "display_name": "user2829218", "link": "https://stackoverflow.com/users/2829218/user2829218"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 882, "favorite_count": 0, "accepted_answer_id": 31702965, "answer_count": 1, "score": 1, "last_activity_date": 1438187251, "creation_date": 1438178727, "last_edit_date": 1438178956, "question_id": 31702850, "link": "https://stackoverflow.com/questions/31702850/remove-listbox-item-if-match-not-found-in-vba", "title": "Remove Listbox item if match not found in VBA", "body": "<p>I am writing vba code that will search all listbox items against a entire column in a sheet.\nIf listbox item not found in Excel sheet column, i want to delete the item from list. I tried few codes, its showing some error as \"Could not get list property, Invalid property array index\". Below is my code i am using currently.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim itemExistResults As Boolean\n    Dim myarray()\n    Dim intItem As Long\n\n    myarray = Application.Transpose(Sheet1.Range(\"a2:a1000\"))\n\n    For intItem = 0 To ListBox1.ListCount - 1\n        If IsInArray(ListBox1.List(intItem), myarray) Then\n        Else\n            ListBox1.RemoveItem intItem\n        End If\n    Next\n\nEnd Sub\n\nFunction IsInArray(stringToBeFound As String, arr As Variant) As Boolean\n    IsInArray = UBound(Filter(arr, stringToBeFound)) &gt; -1\nEnd Function\n</code></pre>\n\n<p>Any idea where i am wrong in this code.</p>\n"}, {"tags": ["excel", "vba", "numbers", "decimal", "comma"], "answers": [{"tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": false, "score": 0, "last_activity_date": 1438178811, "creation_date": 1438178811, "answer_id": 31702874, "question_id": 31702604, "link": "https://stackoverflow.com/questions/31702604/excel-vba-macro-insert-decimal-number/31702874#31702874", "title": "Excel Vba Macro Insert Decimal Number", "body": "<p>There must be some formatting on your sheet as it worked fine here, but you can force the number format using below. for more decimal places just add them to the format e.g. \"0.000\" for 3 decimals</p>\n\n<pre><code>Sub insertData()\nDim valore As String\nvalore = \"3.4\"\nWith Cells(1, 1)\n    .Value = valore\n    .NumberFormat = \"0.0\"\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Below with cdbl converts the string to a double which should preserve the decimals too.</p>\n\n<pre><code>Sub insertData()\nDim valore As String\nvalore = \"3.4\"\nWith Cells(1, 1)\n    .Value = cdbl(valore)\n    .NumberFormat = \"0.0\"\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1438179539, "creation_date": 1438179539, "answer_id": 31703180, "question_id": 31702604, "link": "https://stackoverflow.com/questions/31702604/excel-vba-macro-insert-decimal-number/31703180#31703180", "title": "Excel Vba Macro Insert Decimal Number", "body": "<p>I do not find any thing wrong in your code. Perhaps sheet is formatted in different way from the original source. In such cases what I prefer to do is that I copy and paste to Note Tab Light text editor and then re paste  the data to new excel work sheet.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4982589"}, "is_accepted": false, "score": 0, "last_activity_date": 1438196780, "creation_date": 1438196780, "answer_id": 31709086, "question_id": 31702604, "link": "https://stackoverflow.com/questions/31702604/excel-vba-macro-insert-decimal-number/31709086#31709086", "title": "Excel Vba Macro Insert Decimal Number", "body": "<p>Please, see this example.\nIt will clarify my problem.\nThis code make correct output.</p>\n\n<pre><code>Sub Macro1()\nDim row As Integer\nDim value As String\nrow = 1\nFor i = 1 To 3\nFor j = 1 To 3\nFor k = 1 To 3\nvalue = i &amp; \".\" &amp; j &amp; \".\" &amp; k\nCells(row, 1) = value\nrow = row + 1\nNext k\nNext j\nNext i\nEnd Sub\n</code></pre>\n\n<p>This code make wrong output, because point is converted to comma.</p>\n\n<pre><code>Sub Macro2()\nDim row As Integer\nDim value As String\nrow = 1\nFor i = 1 To 3\nFor j = 1 To 3\nvalue = i &amp; \".\" &amp; j\nCells(row, 1) = value\nrow = row + 1\nNext j\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4982589"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1980, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1438196780, "creation_date": 1438178228, "last_edit_date": 1438178283, "question_id": 31702604, "link": "https://stackoverflow.com/questions/31702604/excel-vba-macro-insert-decimal-number", "title": "Excel Vba Macro Insert Decimal Number", "body": "<p>In my excel worksheet, if i try to insert a decimal number like 3.4 in a cell, the number that will appear is 3.4.\nBut if i try to insert same number by vba macro, the number that appear is 3,4.\nThis is my code.</p>\n\n<pre><code>Sub insertData()\n   Dim valore as String\n   valore = \"3.4\"\n   Cells(1, 1) = valore\nEnd Sub\n</code></pre>\n\n<p>How to solve this problem?\nThanks</p>\n"}, {"tags": ["excel", "vbscript", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1387, "user_id": 4616611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90099c6ce97d206fcac50806bf8c74da?s=128&d=identicon&r=PG&f=1", "display_name": "Teodorico Levoff", "link": "https://stackoverflow.com/users/4616611/teodorico-levoff"}, "edited": false, "score": 0, "creation_date": 1438179319, "post_id": 31702908, "comment_id": 51344679, "body": "If I wanted to write it in as a VBScript also would this syntax would work as well?"}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 1387, "user_id": 4616611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90099c6ce97d206fcac50806bf8c74da?s=128&d=identicon&r=PG&f=1", "display_name": "Teodorico Levoff", "link": "https://stackoverflow.com/users/4616611/teodorico-levoff"}, "edited": false, "score": 0, "creation_date": 1438179409, "post_id": 31702908, "comment_id": 51344752, "body": "Well, in VBScript, you need to qualify your objects since you&#39;re not in the VBA environment. <code>Cells</code> and <code>PageSetup</code> aren&#39;t going to be available. You&#39;d have to use <code>objExcel.ActiveSheet.Cells</code>, or whatever your Excel object reference is called."}, {"owner": {"reputation": 1387, "user_id": 4616611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90099c6ce97d206fcac50806bf8c74da?s=128&d=identicon&r=PG&f=1", "display_name": "Teodorico Levoff", "link": "https://stackoverflow.com/users/4616611/teodorico-levoff"}, "edited": false, "score": 0, "creation_date": 1438179573, "post_id": 31702908, "comment_id": 51344896, "body": "Ah I see, if I may ask what would be the syntax for it in a VBScript?"}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 1387, "user_id": 4616611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90099c6ce97d206fcac50806bf8c74da?s=128&d=identicon&r=PG&f=1", "display_name": "Teodorico Levoff", "link": "https://stackoverflow.com/users/4616611/teodorico-levoff"}, "edited": false, "score": 0, "creation_date": 1438179617, "post_id": 31702908, "comment_id": 51344926, "body": "Why did you tag it as [vba] if you wanted [vbscript]?"}, {"owner": {"reputation": 1387, "user_id": 4616611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90099c6ce97d206fcac50806bf8c74da?s=128&d=identicon&r=PG&f=1", "display_name": "Teodorico Levoff", "link": "https://stackoverflow.com/users/4616611/teodorico-levoff"}, "edited": false, "score": 0, "creation_date": 1438179976, "post_id": 31702908, "comment_id": 51345228, "body": "I originally wanted VBA, but I am asked for a vbscript, my apologies."}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 1387, "user_id": 4616611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90099c6ce97d206fcac50806bf8c74da?s=128&d=identicon&r=PG&f=1", "display_name": "Teodorico Levoff", "link": "https://stackoverflow.com/users/4616611/teodorico-levoff"}, "edited": false, "score": 0, "creation_date": 1438180039, "post_id": 31702908, "comment_id": 51345284, "body": "What&#39;s the name of your Excel object? And should I use the <code>ActiveSheet</code> in my example or do you have a preference?"}, {"owner": {"reputation": 1387, "user_id": 4616611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90099c6ce97d206fcac50806bf8c74da?s=128&d=identicon&r=PG&f=1", "display_name": "Teodorico Levoff", "link": "https://stackoverflow.com/users/4616611/teodorico-levoff"}, "edited": false, "score": 0, "creation_date": 1438191393, "post_id": 31702908, "comment_id": 51353037, "body": "I called my Excel object objwb and my ActiveSheet objWSheet, but in the end I don&#39;t have a preference as long I know which is which. Thanks."}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 1387, "user_id": 4616611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90099c6ce97d206fcac50806bf8c74da?s=128&d=identicon&r=PG&f=1", "display_name": "Teodorico Levoff", "link": "https://stackoverflow.com/users/4616611/teodorico-levoff"}, "edited": false, "score": 0, "creation_date": 1438192027, "post_id": 31702908, "comment_id": 51353387, "body": "OK, I&#39;ve updated it to show the code in VBScript with a sheet variable called <code>objWSheet</code>."}, {"owner": {"reputation": 1387, "user_id": 4616611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90099c6ce97d206fcac50806bf8c74da?s=128&d=identicon&r=PG&f=1", "display_name": "Teodorico Levoff", "link": "https://stackoverflow.com/users/4616611/teodorico-levoff"}, "edited": false, "score": 0, "creation_date": 1438192780, "post_id": 31702908, "comment_id": 51353833, "body": "I get a run-time error on this line, intLastRow = objWSheet.Cells(objWSheet.Rows.Count, objWSheet.Columns(&quot;A&quot;).Column).End(xlUp).Row, trying to figure out why."}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 1387, "user_id": 4616611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90099c6ce97d206fcac50806bf8c74da?s=128&d=identicon&r=PG&f=1", "display_name": "Teodorico Levoff", "link": "https://stackoverflow.com/users/4616611/teodorico-levoff"}, "edited": false, "score": 0, "creation_date": 1438192916, "post_id": 31702908, "comment_id": 51353930, "body": "Probably just need to define <code>xlUp</code>. I&#39;ve edited the answer to include that constant."}, {"owner": {"reputation": 1387, "user_id": 4616611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90099c6ce97d206fcac50806bf8c74da?s=128&d=identicon&r=PG&f=1", "display_name": "Teodorico Levoff", "link": "https://stackoverflow.com/users/4616611/teodorico-levoff"}, "edited": false, "score": 0, "creation_date": 1438193266, "post_id": 31702908, "comment_id": 51354151, "body": "I just tried that, it now compiles and runs although the print area still includes many blank rows underneath the last row containing data in the print area."}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 1387, "user_id": 4616611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90099c6ce97d206fcac50806bf8c74da?s=128&d=identicon&r=PG&f=1", "display_name": "Teodorico Levoff", "link": "https://stackoverflow.com/users/4616611/teodorico-levoff"}, "edited": false, "score": 0, "creation_date": 1438208104, "post_id": 31702908, "comment_id": 51362131, "body": "You probably have some rows that once had data in them. Try the updated code. It will remove any blank rows before setting the print area."}, {"owner": {"reputation": 1387, "user_id": 4616611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90099c6ce97d206fcac50806bf8c74da?s=128&d=identicon&r=PG&f=1", "display_name": "Teodorico Levoff", "link": "https://stackoverflow.com/users/4616611/teodorico-levoff"}, "edited": false, "score": 0, "creation_date": 1438259756, "post_id": 31702908, "comment_id": 51384113, "body": "Ah I figured out my mistake, the problem was that what is seen to be an empty cell was not an empty cell rather it contained a formula. Thanks"}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": true, "score": 1, "last_activity_date": 1438208041, "last_edit_date": 1438208041, "creation_date": 1438178891, "answer_id": 31702908, "question_id": 31702356, "link": "https://stackoverflow.com/questions/31702356/set-print-area-for-excel-files/31702908#31702908", "title": "Set Print Area for Excel Files", "body": "<p>Depends on which column you want to use to check for the first blank row. Here's an example that checks for the last row with data in column A:</p>\n\n<pre><code>Const xlUp = -4162\nConst xlCellTypeBlanks = 4\n\n' Get the last row...\nDim intLastRow\nintLastRow = objWSheet.Cells(objWSheet.Rows.Count, 1).End(xlUp).Row\n\n' Delete any rows with a blank column A...\nobjWSheet.Range(\"A1:A\" &amp; intLastRow).SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n\n' Get the new last row...\nintLastRow = objWSheet.Cells(objWSheet.Rows.Count, 1).End(xlUp).Row\n\n' Set the print area...\nobjWSheet.PageSetup.PrintArea = \"$A$1:$N$\" &amp; intLastRow\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "is_accepted": false, "score": 0, "last_activity_date": 1438185291, "creation_date": 1438185291, "answer_id": 31705406, "question_id": 31702356, "link": "https://stackoverflow.com/questions/31702356/set-print-area-for-excel-files/31705406#31705406", "title": "Set Print Area for Excel Files", "body": "<p>Unless your sheet has more data rows after that blank row you could simply use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840732.aspx\" rel=\"nofollow\"><code>UsedRange</code></a> property:</p>\n\n<pre><code>Set xl = CreateObject(\"Excel.Application\")\nxl.Visible = True\n\nSet wb = xl.Workbooks.Open(\"C:\\path\\to\\your.xlsx\")\nSet ws = wb.Sheets(1)\n\nws.PageSetup.PrintArea = ws.UsedRange.Address\n</code></pre>\n"}], "owner": {"reputation": 1387, "user_id": 4616611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90099c6ce97d206fcac50806bf8c74da?s=128&d=identicon&r=PG&f=1", "display_name": "Teodorico Levoff", "link": "https://stackoverflow.com/users/4616611/teodorico-levoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 612, "favorite_count": 0, "accepted_answer_id": 31702908, "answer_count": 2, "score": 0, "last_activity_date": 1438208041, "creation_date": 1438177673, "last_edit_date": 1531161705, "question_id": 31702356, "link": "https://stackoverflow.com/questions/31702356/set-print-area-for-excel-files", "title": "Set Print Area for Excel Files", "body": "<p>I have an Excel file all of which has columns until col <code>N</code>. My question is I want to know how to set the print area using VBScript to cover each row until column <code>N</code> until a blank row.</p>\n"}, {"tags": ["ms-access", "textbox", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5169577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153637492423812/picture?type=large", "display_name": "Yakov Borukhov", "link": "https://stackoverflow.com/users/5169577/yakov-borukhov"}, "edited": false, "score": 0, "creation_date": 1438181719, "post_id": 31703747, "comment_id": 51346582, "body": "First off, thanks a lot for your reply. Just one question, I dont really understand why use a form_load event if I&#39;m using a report and not a form. Does it matter? I&#39;m guessing there is a Report_Load()"}, {"owner": {"reputation": 885, "user_id": 1676288, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00186351b531d40caafac61aeeb2946a?s=128&d=identicon&r=PG", "display_name": "Mark Butler", "link": "https://stackoverflow.com/users/1676288/mark-butler"}, "reply_to_user": {"reputation": 3, "user_id": 5169577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153637492423812/picture?type=large", "display_name": "Yakov Borukhov", "link": "https://stackoverflow.com/users/5169577/yakov-borukhov"}, "edited": false, "score": 0, "creation_date": 1438182059, "post_id": 31703747, "comment_id": 51346861, "body": "Ah, I misread that. Yes, report_load is what you need here. Let me know if the above does what you want it to!"}, {"owner": {"reputation": 3, "user_id": 5169577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153637492423812/picture?type=large", "display_name": "Yakov Borukhov", "link": "https://stackoverflow.com/users/5169577/yakov-borukhov"}, "edited": false, "score": 0, "creation_date": 1438182086, "post_id": 31703747, "comment_id": 51346886, "body": "Also, just to clarify, i have a bunch of textboxes that i have to refer too. Is there an easier method? And yes, my method for finding the date is intentional as all i need are the last 2 numbers of the year."}, {"owner": {"reputation": 885, "user_id": 1676288, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00186351b531d40caafac61aeeb2946a?s=128&d=identicon&r=PG", "display_name": "Mark Butler", "link": "https://stackoverflow.com/users/1676288/mark-butler"}, "reply_to_user": {"reputation": 3, "user_id": 5169577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153637492423812/picture?type=large", "display_name": "Yakov Borukhov", "link": "https://stackoverflow.com/users/5169577/yakov-borukhov"}, "edited": false, "score": 0, "creation_date": 1438182394, "post_id": 31703747, "comment_id": 51347111, "body": "RE the dates; yep, but a year does not have 360 days (indeed it is not even a set number!). So on the 30th Dec, 2015, you would end up with Format(Jan 4th, 2015, &quot;yy&quot;) = &quot;15&quot; and both boxes would read <b>F15</b>. My method will give you <b>F15</b> in one and <b>F14</b> in the other."}, {"owner": {"reputation": 885, "user_id": 1676288, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00186351b531d40caafac61aeeb2946a?s=128&d=identicon&r=PG", "display_name": "Mark Butler", "link": "https://stackoverflow.com/users/1676288/mark-butler"}, "reply_to_user": {"reputation": 3, "user_id": 5169577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153637492423812/picture?type=large", "display_name": "Yakov Borukhov", "link": "https://stackoverflow.com/users/5169577/yakov-borukhov"}, "edited": false, "score": 0, "creation_date": 1438182512, "post_id": 31703747, "comment_id": 51347199, "body": "When you say a bunch of textboxes, do you mean more than just two years (14 and 15)? Or multiple records for each year?"}, {"owner": {"reputation": 3, "user_id": 5169577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153637492423812/picture?type=large", "display_name": "Yakov Borukhov", "link": "https://stackoverflow.com/users/5169577/yakov-borukhov"}, "edited": false, "score": 0, "creation_date": 1438184413, "post_id": 31703747, "comment_id": 51348687, "body": "Oh wow! I completely didnt catch that! Thanks for clearing that up. I guess i&#39;ll change it to what you wrote. And by a bunch of textboxes, i mean many different references to columns. So i have textboxes F13, F14, F15, F16, C13 and so on as they each refer to a column in the same query. I have about 10 different references to columns and about 20 different reports where i would need this same method to work"}, {"owner": {"reputation": 885, "user_id": 1676288, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00186351b531d40caafac61aeeb2946a?s=128&d=identicon&r=PG", "display_name": "Mark Butler", "link": "https://stackoverflow.com/users/1676288/mark-butler"}, "reply_to_user": {"reputation": 3, "user_id": 5169577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153637492423812/picture?type=large", "display_name": "Yakov Borukhov", "link": "https://stackoverflow.com/users/5169577/yakov-borukhov"}, "edited": false, "score": 0, "creation_date": 1438250728, "post_id": 31703747, "comment_id": 51378250, "body": "If the reports must automatically update when we reach 2016, then setting their ControlSource programatically is really the only option here. Since the year is not going to change whilst the form is open, we don&#39;t really need the code in the After_Update events (it is enough just to set the control source when the report loads, and not have to monitor the <b>F15</b> box to see if it changes)."}, {"owner": {"reputation": 885, "user_id": 1676288, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00186351b531d40caafac61aeeb2946a?s=128&d=identicon&r=PG", "display_name": "Mark Butler", "link": "https://stackoverflow.com/users/1676288/mark-butler"}, "reply_to_user": {"reputation": 3, "user_id": 5169577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153637492423812/picture?type=large", "display_name": "Yakov Borukhov", "link": "https://stackoverflow.com/users/5169577/yakov-borukhov"}, "edited": false, "score": 0, "creation_date": 1438250897, "post_id": 31703747, "comment_id": 51378366, "body": "This means that you just need 10 or so lines of code in the Report_Load event of each of the 20 or so reports, so it&#39;s not too bad. If your textboxes are consistently named across each report then the code could even be identical so just copy and paste! (eg. Me.txtFieldA.ControlSource = Me.txtYearCodeA, Me.txtFieldB.ControlSource = Me.txtYearCodeB, ...) etc."}, {"owner": {"reputation": 3, "user_id": 5169577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153637492423812/picture?type=large", "display_name": "Yakov Borukhov", "link": "https://stackoverflow.com/users/5169577/yakov-borukhov"}, "edited": false, "score": 0, "creation_date": 1438349357, "post_id": 31703747, "comment_id": 51428293, "body": "I did exactly that. Thanks for all your help. Worked perfectly"}, {"owner": {"reputation": 885, "user_id": 1676288, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00186351b531d40caafac61aeeb2946a?s=128&d=identicon&r=PG", "display_name": "Mark Butler", "link": "https://stackoverflow.com/users/1676288/mark-butler"}, "reply_to_user": {"reputation": 3, "user_id": 5169577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153637492423812/picture?type=large", "display_name": "Yakov Borukhov", "link": "https://stackoverflow.com/users/5169577/yakov-borukhov"}, "edited": false, "score": 0, "creation_date": 1438349917, "post_id": 31703747, "comment_id": 51428692, "body": "No worries, glad I could help. Perhaps mark my answer as accepted if it&#39;s solved your issue?"}], "tags": [], "owner": {"reputation": 885, "user_id": 1676288, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00186351b531d40caafac61aeeb2946a?s=128&d=identicon&r=PG", "display_name": "Mark Butler", "link": "https://stackoverflow.com/users/1676288/mark-butler"}, "is_accepted": true, "score": 0, "last_activity_date": 1438180946, "creation_date": 1438180946, "answer_id": 31703747, "question_id": 31702250, "link": "https://stackoverflow.com/questions/31702250/access-using-textbox-in-report-how-to-display-reference-a-column-from-a-query/31703747#31703747", "title": "Access: Using textbox in report, how to display reference a column from a query using a different textbox", "body": "<p>Assuming that Text1 and Text2 are your two textboxes containing F14 and F15, and Text3 and Text4 are the other ones pulling from the query:</p>\n\n<p>Set the RecordSource of the form as the query MKTCAP.</p>\n\n<p>Put this in the Form_Load event:</p>\n\n<pre><code>Private Sub Form_Load()\n\n    Me.Text3.ControlSource = Me.Text1\n    Me.Text4.ControlSource = Me.Text2\n\nEnd Sub\n</code></pre>\n\n<p>and then in the After_Update event of Text1 and Text2</p>\n\n<pre><code>    Me.Text3.ControlSource = Me.Text1\n</code></pre>\n\n<p>and</p>\n\n<pre><code>    Me.Text4.ControlSource = Me.Text2\n</code></pre>\n\n<p>respectively, to keep the rowsource updated should Text1 and Text2 change whilst the form is open.</p>\n\n<p>Your method of finding last year's date is slightly unusual - is this intentional? On Dec 30th, for example, both years would be the same. Why not use</p>\n\n<pre><code>=\"F\" &amp; Format(Date()-360,\"yy\") - 1\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5169577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153637492423812/picture?type=large", "display_name": "Yakov Borukhov", "link": "https://stackoverflow.com/users/5169577/yakov-borukhov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 462, "favorite_count": 0, "accepted_answer_id": 31703747, "answer_count": 1, "score": 0, "last_activity_date": 1594644034, "creation_date": 1438177447, "last_edit_date": 1594644034, "question_id": 31702250, "link": "https://stackoverflow.com/questions/31702250/access-using-textbox-in-report-how-to-display-reference-a-column-from-a-query", "title": "Access: Using textbox in report, how to display reference a column from a query using a different textbox", "body": "<p>I'm trying to making a report in access that uses a bunch of dynamic textboxes. Lets say that one specific text box called A displays the current year using the control source \n    <code>=\"F\" &amp; Format(Date(),\"yy\")</code>\n and another called B displays the year before \n    <code>=\"F\" &amp; Format(Date()-360,\"yy\")</code></p>\n\n<p>I have a query called MKTCAP with columns called F15 and F14 which are updated automatically and every year, another column is added whith the next consecutive year. </p>\n\n<p>Under textboxes A and B, I have textboxes C and D where i refer to this query, but here i want to use textboxes A and B to access the specific column of the MKTCAP query. </p>\n\n<p>I tried <code>=[MKTCAP].[(A)]</code> and many different combinations of that, and i didnt know how to word this question on google. Am i missing something? Is there a simpler way of doing this? Thanks for the help</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1438176891, "post_id": 31701925, "comment_id": 51342717, "body": "Are you only wanting this to be don on consecutive numbers? How does the consecutive part come into play?"}, {"owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 0, "creation_date": 1438177081, "post_id": 31701925, "comment_id": 51342861, "body": "The formula and the description is totally different; you say you want to change the format of cell content, but the formula concatenates two cells, please clarify."}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1438177501, "post_id": 31701925, "comment_id": 51343183, "body": "Do you just want to add the &quot; - &quot; before the last four numbers? If not I dont really get your question."}, {"owner": {"reputation": 403, "user_id": 1227249, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/279b2cbece225ce44ce74568ba75b28d?s=128&d=identicon&r=PG", "display_name": "traveler84", "link": "https://stackoverflow.com/users/1227249/traveler84"}, "edited": false, "score": 0, "creation_date": 1438177813, "post_id": 31701925, "comment_id": 51343460, "body": "I added the example. Sorry for confusion! Ran off to a meeting before I could add the example."}, {"owner": {"reputation": 403, "user_id": 1227249, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/279b2cbece225ce44ce74568ba75b28d?s=128&d=identicon&r=PG", "display_name": "traveler84", "link": "https://stackoverflow.com/users/1227249/traveler84"}, "edited": false, "score": 0, "creation_date": 1438178072, "post_id": 31701925, "comment_id": 51343665, "body": "Also, numbers are presorted and are in order."}], "answers": [{"comments": [{"owner": {"reputation": 403, "user_id": 1227249, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/279b2cbece225ce44ce74568ba75b28d?s=128&d=identicon&r=PG", "display_name": "traveler84", "link": "https://stackoverflow.com/users/1227249/traveler84"}, "edited": false, "score": 0, "creation_date": 1438181918, "post_id": 31703721, "comment_id": 51346742, "body": "To add to this, how do you find them? I&#39;m able to do something similar to this but if you throw in an odd ball between the mix say, 5555555555, I don&#39;t want to make 5555555555 link with any of those numbers. For example, currently, I am looking at this further down on my spreadsheet:  =IF(A209=A208+1,A208 &amp; &quot;-&quot; &amp; A209,A209). Basically, it posts the TN above it with the number after. What happens is going down the list above I&#39;d get 1234567890 - 1234567891, 1234567891 - 1234567892. Is there a way to make it show only 1234567890 - 1234567892?"}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "reply_to_user": {"reputation": 403, "user_id": 1227249, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/279b2cbece225ce44ce74568ba75b28d?s=128&d=identicon&r=PG", "display_name": "traveler84", "link": "https://stackoverflow.com/users/1227249/traveler84"}, "edited": false, "score": 0, "creation_date": 1438182221, "post_id": 31703721, "comment_id": 51346992, "body": "Could you rephrase that? I dont really understand. For the excel formula, you have to put the formula - lets say - right to your original data; change the &quot;A1&quot; to the according cell and then use auto fill on your column."}, {"owner": {"reputation": 403, "user_id": 1227249, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/279b2cbece225ce44ce74568ba75b28d?s=128&d=identicon&r=PG", "display_name": "traveler84", "link": "https://stackoverflow.com/users/1227249/traveler84"}, "edited": false, "score": 0, "creation_date": 1438184904, "post_id": 31703721, "comment_id": 51349046, "body": "Imagine if you have a list of customer phone numbers for a large account. They are not 555-555-0000 thru 555-555-0099. Instead, imagine they are 0000, 0001, 0003, 0004, 0005, 0010, 0020, 0021.  If I could make some kind of formula that can find the range and put them together.  555-555-0000 - 0001  555-555-0003 - 0005  555-555-0010  555-555-0020 - 0021"}], "tags": [], "owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1438180880, "creation_date": 1438180880, "answer_id": 31703721, "question_id": 31701925, "link": "https://stackoverflow.com/questions/31701925/excel-finding-consecutive-phone-numbers/31703721#31703721", "title": "Excel Finding Consecutive Phone Numbers", "body": "<p>If all the numbers are of the same format and you always want the \"-\" inserted before the last four numbers this will do the trick</p>\n\n<p>In an excel formula:</p>\n\n<pre><code>=LEFT(A1;6) &amp; \"-\" &amp; RIGHT(A1;4)\n</code></pre>\n\n<p>In VBA</p>\n\n<pre><code>Dim text1 As String, text2 As String\n\nFor i = 1 To NumberOfRows\n\ntext1 = Cells(A,i)\ntext2 = Left(text1,6) + \"-\" + Right(text1,4)\n\nNext i\n</code></pre>\n"}], "owner": {"reputation": 403, "user_id": 1227249, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/279b2cbece225ce44ce74568ba75b28d?s=128&d=identicon&r=PG", "display_name": "traveler84", "link": "https://stackoverflow.com/users/1227249/traveler84"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 2, "answer_count": 1, "score": -1, "last_activity_date": 1438182038, "creation_date": 1438176683, "last_edit_date": 1531161705, "question_id": 31701925, "link": "https://stackoverflow.com/questions/31701925/excel-finding-consecutive-phone-numbers", "title": "Excel Finding Consecutive Phone Numbers", "body": "<p>Is there a way in excel if I have a bunch of phone numbers in 1234567890 format, that I could find ranges and paste in the format of XXXXXXXXXX-XXXX?</p>\n\n<p>I tried with some mid formulas but it's not working quite right.</p>\n\n<pre><code>=IF(A63=A62+1,A62 &amp; \"-\" &amp; A63,\"NO \")\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>1234567890</p>\n\n<p>1234567891</p>\n\n<p>1234567892</p>\n\n<p>1234567893</p>\n\n<p>1234567897</p>\n\n<p>1234567898</p>\n\n<p>1234567899</p>\n\n<p>5552221212</p>\n\n<p>5552221213</p>\n\n<p>Should look like:</p>\n\n<p>1234567890-7893</p>\n\n<p>1234567897-7899</p>\n\n<p>5552221212-1213</p>\n\n<p>EDIT 2:</p>\n\n<p>If you throw in an odd ball between the mix say, 5555555555, I don't want to make 5555555555 link with any of those numbers. </p>\n\n<p>For example, currently, I am looking at this further down on my spreadsheet: =IF(A209=A208+1,A208 &amp; \"-\" &amp; A209,A209). Basically, it posts the TN above it with the number after. What happens is going down the list above I'd get </p>\n\n<p>1234567890 - 1234567891 </p>\n\n<p>1234567891 - 1234567892</p>\n\n<p>Is there a way to make it show only 1234567890 - 1234567892? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1438176388, "post_id": 31701755, "comment_id": 51342344, "body": "Are you sure you&#39;re entering it as an array formula in <code>estring</code>?"}, {"owner": {"reputation": 299, "user_id": 4555858, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-pKHt2EC-kxU/AAAAAAAAAAI/AAAAAAAAA-I/zPlHM2EvsSE/photo.jpg?sz=128", "display_name": "Prateek Daniels", "link": "https://stackoverflow.com/users/4555858/prateek-daniels"}, "reply_to_user": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1438176465, "post_id": 31701755, "comment_id": 51342408, "body": "No. How would I do that @gareth ?"}, {"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1438176533, "post_id": 31701755, "comment_id": 51342460, "body": "Try <code>Evaluate(&quot;{Index(&quot; &amp; Shortfall_rng.Address &amp; &quot;, Match(&quot; &amp; Bucket &amp; Region &amp; DateValues &amp; &quot;, &quot; &amp; Bucket_rng.Address &amp; &quot; &amp; &quot; &amp; Region_rng.Address &amp; &quot;&amp;&quot; &amp; Datevalues_rng.Address &amp; &quot;, 0))}&quot;)</code>. Notice the curly braces."}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1438177146, "post_id": 31701755, "comment_id": 51342909, "body": "Can you include what the Excel function looks like if entered on the sheet?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1438177433, "post_id": 31701755, "comment_id": 51343129, "body": "@Gareth You can&#39;t add {} to the formula string in evaluate to coerce array-evaluation."}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1438177140, "creation_date": 1438177140, "answer_id": 31702115, "question_id": 31701755, "link": "https://stackoverflow.com/questions/31701755/using-index-match-in-excel-vba/31702115#31702115", "title": "Using Index Match In excel VBA", "body": "<p>You'd have to enclose the string arguments in quotes inside the formula. It's easier, IMO, to use the cell addresses of the criteria cells too:</p>\n\n<pre><code>Dim ws                    As Worksheet\nDim DateValues            As Range\nDim Shortfall             As Range\nDim Region                As Range\nDim Bucket                As Range\nDim Shortfall_rng         As Range\nDim Region_rng            As Range\nDim Bucket_rng            As Range\nDim Datevalues_rng        As Range\nDim estring               As Variant\nDim StartCopying          As Range\n\nSet ws = Worksheets(\"Asia_All\")\n\nSet StartCopying = ws.Range(\"O4\")\n\nSet Region = ws.Range(\"O1\")    ' Value in cell O1 is \"New York\" (without Quotes)\nSet Bucket = ws.Range(\"O2\")    ' Value in cell O2 is \"&lt;!--1--&gt;0 - 1\" (without Quotes)\nSet DateValues = ws.Range(\"O3\")    ' Value in cell O3 is \"2007-01-02\" (without Quotes)\n\n\n\nSet Shortfall_rng = ws.Range(\"$B$2:$B$142411\")\nSet Bucket_rng = ws.Range(\"$F$2:$F$142411\")\nSet Datevalues_rng = ws.Range(\"J$2:$J$142411\")\nSet Region_rng = ws.Range(\"$K$2:$K$142411\")\n\n\nestring = ws.Evaluate(\"Index(\" &amp; Shortfall_rng.Address &amp; \", Match(\" &amp; Bucket.Address &amp; \"&amp;\" &amp; Region.Address &amp; \"&amp;\" &amp; DateValues.Address &amp; \", \" &amp; Bucket_rng.Address &amp; \" &amp; \" &amp; Region_rng.Address &amp; \"&amp;\" &amp; Datevalues_rng.Address &amp; \", 0))\")\n\nStartCopying.Value = estring\n</code></pre>\n"}], "owner": {"reputation": 299, "user_id": 4555858, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-pKHt2EC-kxU/AAAAAAAAAAI/AAAAAAAAA-I/zPlHM2EvsSE/photo.jpg?sz=128", "display_name": "Prateek Daniels", "link": "https://stackoverflow.com/users/4555858/prateek-daniels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1154, "favorite_count": 0, "accepted_answer_id": 31702115, "answer_count": 1, "score": 1, "last_activity_date": 1438177140, "creation_date": 1438176275, "last_edit_date": 1531164843, "question_id": 31701755, "link": "https://stackoverflow.com/questions/31701755/using-index-match-in-excel-vba", "title": "Using Index Match In excel VBA", "body": "<pre><code>Dim DateValues As Variant\nDim Shortfall As Variant\nDim Region As Variant\nDim Bucket As Variant\n\nDim Shortfall_rng As Range\nDim Region_rng As Range\nDim Bucket_rng As Range\nDim Datevalues_rng As Range\n\nDim estring As Variant\n\nDim StartCopying As Range\n\n\nSet StartCopying = Worksheets(\"Asia_All\").Range(\"O4\")\n\nRegion = Worksheets(\"Asia_All\").Range(\"O1\").Value ' Value in cell O1 is \"New York\" (without Quotes)\nBucket = Worksheets(\"Asia_All\").Range(\"O2\").Value ' Value in cell O2 is \"&lt;!--1--&gt;0 - 1\" (without Quotes)\nDateValues = Worksheets(\"Asia_All\").Range(\"O3\").Value ' Value in cell O3 is \"2007-01-02\" (without Quotes)\n\n\n\nSet Shortfall_rng = Worksheets(\"Asia_All\").Range(\"$B$2:$B$142411\")\nSet Bucket_rng = Worksheets(\"Asia_All\").Range(\"$F$2:$F$142411\")\nSet Datevalues_rng = Worksheets(\"Asia_All\").Range(\"J$2:$J$142411\")\nSet Region_rng = Worksheets(\"Asia_All\").Range(\"$K$2:$K$142411\")\n\n\nestring = Evaluate(\"Index(\" &amp; Shortfall_rng.Address &amp; \", Match(\" &amp; Bucket &amp; Region &amp; DateValues &amp; \", \" &amp; Bucket_rng.Address &amp; \" &amp; \" &amp; Region_rng.Address &amp; \"&amp;\" &amp; Datevalues_rng.Address &amp; \", 0))\")\n\nStartCopying.Value = estring\n</code></pre>\n\n<p>I am trying to use Index Match ,but I am getting #Value! error. Please note that it works absolutely fine if i manually enter the index match formula in the cell. This error appears only when i try to replicate it in excel vba.To give a brief,</p>\n\n<p><strong>Bucket_rng column contains a coulmn of multiple values of</strong>  </p>\n\n<pre><code> &lt;!--1--&gt;0 - 1\n &lt;!--2--&gt;1 - 2.5\n &lt;!--3--&gt;2.5 - 5\n &lt;!--4--&gt;5 - 10\n &lt;!--5--&gt;10+\n</code></pre>\n\n<p><strong>Shortfall_rng column contains a coulmn of multiple values like</strong></p>\n\n<pre><code>-4.69\n-3.94\n-53.94\n150.18\n-18.78\n-9.98\n-17.04\n-41.32\n0.0001\n</code></pre>\n\n<p><strong>Datevalues_rng column contains a coulmn of multiple values in yyyy-mm-dd format</strong> </p>\n\n<p>and </p>\n\n<p><strong>Region_rng column contains a coulmn of multiple values like</strong></p>\n\n<pre><code>China\nNew York\nAustralia\nJapan Continent\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 733, "user_id": 5090061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0606664fdb307c96c1c39066af9386be?s=128&d=identicon&r=PG&f=1", "display_name": "KFichter", "link": "https://stackoverflow.com/users/5090061/kfichter"}, "edited": false, "score": 0, "creation_date": 1438176549, "post_id": 31701660, "comment_id": 51342472, "body": "Can you show us generally what you want to do? I&#39;m having difficulties understanding why you want the additional status data in those specific columns."}, {"owner": {"reputation": 885, "user_id": 1676288, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00186351b531d40caafac61aeeb2946a?s=128&d=identicon&r=PG", "display_name": "Mark Butler", "link": "https://stackoverflow.com/users/1676288/mark-butler"}, "edited": false, "score": 0, "creation_date": 1438176550, "post_id": 31701660, "comment_id": 51342474, "body": "So you want five additional sheets, each displaying a different subset of the volunteers, which update automatically when volunteers are added / removed or their status is changed? If so, whilst it is technically possible in Excel, it will be extremely involved and very sluggish to run. I&#39;d suggest an Access database if at all possible"}], "answers": [{"tags": [], "owner": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "is_accepted": false, "score": 0, "last_activity_date": 1438177386, "last_edit_date": 1438177386, "creation_date": 1438176918, "answer_id": 31702022, "question_id": 31701660, "link": "https://stackoverflow.com/questions/31701660/splitting-data-between-worksheets-depending-on-status-of-column-a/31702022#31702022", "title": "Splitting data between worksheets depending on status of Column A", "body": "<p>You can do this using array formulae. This link shows <a href=\"https://blog.udemy.com/vlookup-multiple-values/\" rel=\"nofollow\">a simple example</a> which provides the basic formula (explained in detail in the linked article)</p>\n\n<pre><code>=INDEX(range,SMALL(IF(col=value,ROW(range)),ROW(1:1)),COLUMN(A2))\n</code></pre>\n\n<p>Where <code>range</code> is the range of all your data from your main worksheet and <code>value</code> is the value you want to screen for (this changes for each of your sheets) and <code>col</code> is the column on your main sheet that you want to check the values of. Note it is an array forumla so you have to press control+shift+enter after typing in the formula as explained at the bottom of the link.</p>\n\n<p>You will notice that I have changed the formula to say <code>COLUMN(A2)</code> instead of <code>2</code>. This is so that you can drag the formula across the columns as well as down the rows. You might need to make this <code>COLUMN(A2)-x</code> where <code>x</code> is an offset because your data don't start in column A.</p>\n\n<p>Note that the same applies for the <code>ROW(1:1)</code> part, if your <code>range</code> doesn't start in row 1 then you will need to offset this by some value as well (i.e. something like <code>ROW(1:1)-y</code>)</p>\n"}], "owner": {"reputation": 1, "user_id": 5169393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d99ce50331fd9d3bf0f1edbb4c07679?s=128&d=identicon&r=PG&f=1", "display_name": "KFull", "link": "https://stackoverflow.com/users/5169393/kfull"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1438180433, "creation_date": 1438176042, "last_edit_date": 1438180433, "question_id": 31701660, "link": "https://stackoverflow.com/questions/31701660/splitting-data-between-worksheets-depending-on-status-of-column-a", "title": "Splitting data between worksheets depending on status of Column A", "body": "<p>I have been asked to create a database of volunteers in Excel. The main worksheet (called Data) holds all the information \u2013 names, addresses, numbers, reference checks, placements, supervisors, etc.  What I am trying to achieve is for the relevant information to be moved from one worksheet to another when the status of the person changes.\nThere would be 5 categories which the volunteers would fall under (column A labelled \u2018Status\u2019)</p>\n\n<p>PROCESSING</p>\n\n<p>ACTIVE</p>\n\n<p>ON HOLD</p>\n\n<p>BARRED</p>\n\n<p>STOPPED/RETIRED</p>\n\n<p>What I want to get is a live database so the information would appear on a relevant worksheet whenever the status on the main spreadsheet changes , but I only want some information to show depending on the category\u2026\nEach Worksheet would contain columns A-F from the \u2018Data\u2019 worksheet and in addition:</p>\n\n<p>Processing would contain columns X-AE</p>\n\n<p>Active: AF-AW</p>\n\n<p>On Hold: AZ-BC</p>\n\n<p>Barred: AX-AY</p>\n\n<p>Stopped/Retired:- BD-BH</p>\n\n<p>I have searched and searched again but I know nothing about Macros (and my IT department is unable to help) So my question is \u2013 is this doable and if so is anyone able to help me? \nI hope I am making sense and if not I can email across the dummy database with some made up names to show what it is I am trying to create</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 885, "user_id": 1676288, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00186351b531d40caafac61aeeb2946a?s=128&d=identicon&r=PG", "display_name": "Mark Butler", "link": "https://stackoverflow.com/users/1676288/mark-butler"}, "edited": false, "score": 1, "creation_date": 1438176112, "post_id": 31701628, "comment_id": 51342138, "body": "You have an extra <code>&quot;</code> after <code>&quot;Sheet with Chart 4&quot;&quot;</code>."}, {"owner": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "reply_to_user": {"reputation": 885, "user_id": 1676288, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00186351b531d40caafac61aeeb2946a?s=128&d=identicon&r=PG", "display_name": "Mark Butler", "link": "https://stackoverflow.com/users/1676288/mark-butler"}, "edited": false, "score": 0, "creation_date": 1438176220, "post_id": 31701628, "comment_id": 51342225, "body": "Oops, good find, but that&#39;s not how it&#39;s typed in the actual program, just a typo when I changed the names of the excel sheets."}, {"owner": {"reputation": 885, "user_id": 1676288, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00186351b531d40caafac61aeeb2946a?s=128&d=identicon&r=PG", "display_name": "Mark Butler", "link": "https://stackoverflow.com/users/1676288/mark-butler"}, "edited": false, "score": 1, "creation_date": 1438176300, "post_id": 31701628, "comment_id": 51342286, "body": "Is this sheet (with Chart 4) the last one by any chance?"}, {"owner": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "reply_to_user": {"reputation": 885, "user_id": 1676288, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00186351b531d40caafac61aeeb2946a?s=128&d=identicon&r=PG", "display_name": "Mark Butler", "link": "https://stackoverflow.com/users/1676288/mark-butler"}, "edited": false, "score": 0, "creation_date": 1438176391, "post_id": 31701628, "comment_id": 51342348, "body": "Yes, it is. I experimented with adding an extra blank sheet at the end of the excel book and it didn&#39;t seem to make a difference."}, {"owner": {"reputation": 885, "user_id": 1676288, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00186351b531d40caafac61aeeb2946a?s=128&d=identicon&r=PG", "display_name": "Mark Butler", "link": "https://stackoverflow.com/users/1676288/mark-butler"}, "edited": false, "score": 1, "creation_date": 1438176507, "post_id": 31701628, "comment_id": 51342434, "body": "Have you taken into account the possibility that the sheet numbering starts at 0? I&#39;m wondering if all of your functions are actually pulling data from the next sheet along; and then when we reach the last one, there is nothing there? EDIT: maybe not then, I&#39;ll have another think"}, {"owner": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "reply_to_user": {"reputation": 885, "user_id": 1676288, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00186351b531d40caafac61aeeb2946a?s=128&d=identicon&r=PG", "display_name": "Mark Butler", "link": "https://stackoverflow.com/users/1676288/mark-butler"}, "edited": false, "score": 0, "creation_date": 1438176640, "post_id": 31701628, "comment_id": 51342530, "body": "The indexing starts at 1. &#39;Set xlSheet = xlBook.Worksheets(0)&#39; gives an index out of bounds error, and&#39; Set xlSheet = xlBook.Worksheets(8)&#39; does not in a book with eight sheets"}, {"owner": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "reply_to_user": {"reputation": 885, "user_id": 1676288, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00186351b531d40caafac61aeeb2946a?s=128&d=identicon&r=PG", "display_name": "Mark Butler", "link": "https://stackoverflow.com/users/1676288/mark-butler"}, "edited": false, "score": 0, "creation_date": 1438176730, "post_id": 31701628, "comment_id": 51342598, "body": "Honestly I don&#39;t even think Set xlSheet = xlBook.Worksheets(8) is necessary for this chunk of code, as xlSheet is never referenced, only the variable xl. My bad."}, {"owner": {"reputation": 885, "user_id": 1676288, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00186351b531d40caafac61aeeb2946a?s=128&d=identicon&r=PG", "display_name": "Mark Butler", "link": "https://stackoverflow.com/users/1676288/mark-butler"}, "edited": false, "score": 1, "creation_date": 1438176836, "post_id": 31701628, "comment_id": 51342679, "body": "You&#39;re right about that actually. In that case there is no discernible difference between the two procedures so it&#39;s hard to suggest anything unless you can provide the files?"}], "answers": [{"tags": [], "owner": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "is_accepted": true, "score": 0, "last_activity_date": 1438177690, "creation_date": 1438177690, "answer_id": 31702370, "question_id": 31701628, "link": "https://stackoverflow.com/questions/31701628/access-error-object-variable-or-with-block-variable-not-set-error-91/31702370#31702370", "title": "Access Error: Object variable or With block variable not set (Error 91)", "body": "<p>I had been stuck on this for awhile, the problem was caused by this line:</p>\n\n<pre><code>xlSheet.Range(\"G7\").Select\n</code></pre>\n\n<p>which was the last line during the formatting on the excel book. I had recorded macros in excel to make the charts and pasted the resulting code in Access. I guess having this cell selected was preventing the chart from being set to active, so I couldn't copy it. Hopefully this helps someone having the same silly problem I was!</p>\n"}], "owner": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1099, "favorite_count": 0, "accepted_answer_id": 31702370, "answer_count": 1, "score": 0, "last_activity_date": 1472477966, "creation_date": 1438175956, "last_edit_date": 1472477966, "question_id": 31701628, "link": "https://stackoverflow.com/questions/31701628/access-error-object-variable-or-with-block-variable-not-set-error-91", "title": "Access Error: Object variable or With block variable not set (Error 91)", "body": "<p>I Know similar questions have been asked, but I still can't figure out this error.</p>\n\n<p>I am working in Access, exporting to excel and used some excel macros to format the data and create charts. I am now trying to put those charts into a Powerpoint, and I am having trouble pasting only one of the four charts I am trying to copy over.</p>\n\n<p>My code to export the third and fourth charts is as follows:</p>\n\n<pre><code>          xl.Sheets(\"Sheet with chart 3\").Select\n          Set rng = xl.ActiveChart\n          rng.CopyPicture\n          mySlide.Shapes.PasteSpecial DataType:=ppPasteEnhancedMetafile\n          Set myShapeRange = mySlide.Shapes(mySlide.Shapes.Count)\n            myShapeRange.Left = 365\n            myShapeRange.Top = 200\n            myShapeRange.Width = 345\n\n          xl.Sheets(\"Sheet with chart 4\").Select\n          Set rng = xl.ActiveChart\n          rng.CopyPicture\n          mySlide.Shapes.PasteSpecial DataType:=ppPasteEnhancedMetafile\n          Set myShapeRange = mySlide.Shapes(mySlide.Shapes.Count)\n            myShapeRange.Left = 365\n            myShapeRange.Top = 200\n            myShapeRange.Width = 345\n</code></pre>\n\n<p>I get the error \"Object variable or With block variable not set (Error 91)\" on the second occurrence of the line</p>\n\n<pre><code>rng.CopyPicture\n</code></pre>\n\n<p>So why would this code fail after running three times prior? I believe I qualified everything correctly, and this code isn't running inside a with block either. Also, The excel sheet it is pulling from is practically identical to the others.</p>\n"}, {"tags": ["vba", "type-mismatch", "ontime"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 1, "creation_date": 1438174340, "post_id": 31700887, "comment_id": 51340903, "body": "Thats a long expression. Break it into multiple lines with one operation per line and see which piece breaks. Also you might want to cast your types, i.e. use <code>CStr(60 - Second(Now))</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": true, "score": 4, "last_activity_date": 1438175582, "last_edit_date": 1438175582, "creation_date": 1438174497, "answer_id": 31701019, "question_id": 31700887, "link": "https://stackoverflow.com/questions/31700887/why-am-i-getting-a-vba-type-mismatch-error/31701019#31701019", "title": "Why am I getting a VBA Type Mismatch Error?", "body": "<p>You miss colon after 00:00:</p>\n\n<pre><code>Application.OnTime Now + TimeValue(\"00:00:\" &amp; (60 - Second(Now))), \"Record\"\n</code></pre>\n\n<p>It doesn't cause 'Type mismatch' error, but it make your function works in unexpected way.</p>\n\n<hr>\n\n<p>The error you talk about appears when <code>Second(Now) = 0</code>.</p>\n\n<p>In such case expression <code>TimeValue(\"00:00:\" &amp; (60 - Second(Now)))</code> returns \"00:00:60\" and this is not a proper time format.</p>\n\n<p>Here is work-around for this issue:</p>\n\n<pre><code>Application.OnTime Now + TimeSerial(0, 0, 60 - Second(Now)), \"Record\"\n</code></pre>\n"}], "owner": {"reputation": 4568, "user_id": 3685285, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/72b7ac073315a8da6956e2d7dce165b1?s=128&d=identicon&r=PG&f=1", "display_name": "user3685285", "link": "https://stackoverflow.com/users/3685285/user3685285"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 995, "favorite_count": 0, "accepted_answer_id": 31701019, "answer_count": 1, "score": 1, "last_activity_date": 1438175582, "creation_date": 1438174154, "last_edit_date": 1438175165, "question_id": 31700887, "link": "https://stackoverflow.com/questions/31700887/why-am-i-getting-a-vba-type-mismatch-error", "title": "Why am I getting a VBA Type Mismatch Error?", "body": "<p>I keep getting a Type Mismatch Error with the following code, and I can't figure out why. When the debugger gives me this error, and I press continue, it moves along as it should. So it seems the code works. So why throw this error in the first place?!</p>\n\n<pre><code>Sub Record()\n\n    ' ...\n    Application.OnTime Now + TimeValue(\"00:00:\" &amp; (60 - Second(Now))), \"Record\"\n    ' ...\n\nEnd Sub\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>Fixed colon, but issue still remained. The issue was That \"00:00:60\" is not a valid number as you cannot have 60 seconds. It should have been \"00:01:00\".</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 1, "creation_date": 1438175346, "post_id": 31700843, "comment_id": 51341559, "body": "Where exactly do you get your error?"}, {"owner": {"reputation": 1, "user_id": 5169391, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pJ8Kdt-BFR0/AAAAAAAAAAI/AAAAAAAAADI/mkfFpDNOknA/photo.jpg?sz=128", "display_name": "Rekboy", "link": "https://stackoverflow.com/users/5169391/rekboy"}, "reply_to_user": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1438244839, "post_id": 31700843, "comment_id": 51374396, "body": "I did not say, that I got an error......It just doesn&#39;t do what I want it to do."}], "answers": [{"tags": [], "owner": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "is_accepted": false, "score": 0, "last_activity_date": 1438175858, "creation_date": 1438175858, "answer_id": 31701587, "question_id": 31700843, "link": "https://stackoverflow.com/questions/31700843/copying-an-offset-cell-from-a-different-file/31701587#31701587", "title": "Copying an Offset-Cell from a different File", "body": "<p>Replace <code>Window</code> with <code>Workbooks</code>:</p>\n\n<pre><code> Workbooks(\"Technology Purchase Order Template V4.xlsm\").Activate\n</code></pre>\n\n<p>and maybe <code>Sheets</code> with <code>Worksheets</code></p>\n"}, {"tags": [], "owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1438176567, "last_edit_date": 1495540699, "creation_date": 1438176567, "answer_id": 31701875, "question_id": 31700843, "link": "https://stackoverflow.com/questions/31700843/copying-an-offset-cell-from-a-different-file/31701875#31701875", "title": "Copying an Offset-Cell from a different File", "body": "<p>Use</p>\n\n<pre><code>     Workbooks.open(\"Technology Purchase Order Template V4.xlsm\").Activate\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>     Windows(\"Technology Purchase Order Template V4.xlsm\").Activate\n</code></pre>\n\n<p>If you want to hide the opening/closing process, check out this answer:\n<a href=\"https://stackoverflow.com/questions/579797/open-excel-file-for-reading-with-vba-without-display\">Open Excel file for reading with VBA without display</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5169391, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pJ8Kdt-BFR0/AAAAAAAAAAI/AAAAAAAAADI/mkfFpDNOknA/photo.jpg?sz=128", "display_name": "Rekboy", "link": "https://stackoverflow.com/users/5169391/rekboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1438239516, "creation_date": 1438239516, "answer_id": 31717119, "question_id": 31700843, "link": "https://stackoverflow.com/questions/31700843/copying-an-offset-cell-from-a-different-file/31717119#31717119", "title": "Copying an Offset-Cell from a different File", "body": "<p>Sry that wasn't the Programm...Here is what I meant:</p>\n\n<pre><code>         Workbooks.Open(\"Purchase Order Details for FY 2015.xlsx\").Activate\n         Worksheets(\"2015\").Select\n\n         Selection = Worksheets(\"2015\").Cells(Worksheets(\"2015\").Rows.Count, \"C\").End(xlUp).Row\n         Selection.Offset(1, -1).Copy\n\n         Workbooks.Open(\"Technology Purchase Order Template V4.xlsm\").Activate\n         Worksheets(\"PO Authorization\").Select\n         Range(\"B5\").Select\n         ActiveSheet.Paste\n         Sheets(\"SBB\").Select\n         Range(\"A2:W2\").Select\n         Selection.Copy\n\n         Workbooks.Open(\"Purchase Order Details for FY 2015.xlsx\").Activate\n         Worksheets(\"2015\").Select\n         Selection = Cells(Worksheets(\"2015\").Rows.Count, \"C\").End(xlUp).Row + 1\n         Selection.PasteSpecial Paste:=xlPasteValues\n</code></pre>\n\n<p>Can somebody fix this please....you can see that I want to copy an offset cell into a file and from that file a range of cells into the bottom of a list with this Count(xlUp or xlDown) Function.</p>\n\n<p>I hope somebody can solve this! </p>\n\n<p>Erik</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5169391, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pJ8Kdt-BFR0/AAAAAAAAAAI/AAAAAAAAADI/mkfFpDNOknA/photo.jpg?sz=128", "display_name": "Rekboy", "link": "https://stackoverflow.com/users/5169391/rekboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1438254711, "creation_date": 1438254711, "answer_id": 31722217, "question_id": 31700843, "link": "https://stackoverflow.com/questions/31700843/copying-an-offset-cell-from-a-different-file/31722217#31722217", "title": "Copying an Offset-Cell from a different File", "body": "<p>Here is the Correct Code!</p>\n\n<p>There are also some more functions in there so don't wonder.</p>\n\n<pre><code>Sub All_to_PDF_File()\n    Dim Filename As String\n    Dim sFile As String, sPath As String\n    Dim wBook As Workbook\n    Dim x As Long\n    Dim y As Long\n\n      On Error Resume Next\n      Set wBook = Workbooks(\"Purchase Order Details for FY 2015.xlsx\")\n\n      If wBook Is Nothing Then 'Not open\n\n      MsgBox \"Please Open 'Purchase Order Details for FY 2015.xlsx' before running this macro!!\"\n\n      Set wBook = Nothing\n\n      On Error GoTo 0\n\n      Else 'It is open\n\n         Workbooks(\"Purchase Order Details for FY 2015.xlsx\").Activate\n         Worksheets(\"2015\").Select\n\n         With ActiveSheet\n            y = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n         End With\n\n         Range(\"B\" &amp; y + 1).Select\n         Selection.Copy\n\n         Workbooks(\"Technology Purchase Order Template V4.xlsm\").Activate\n         Worksheets(\"PO Authorization\").Select\n         Range(\"B5\").Select\n         ActiveSheet.Paste\n\n         Workbooks(\"Technology Purchase Order Template V4.xlsm\").Activate\n         Worksheets(\"SBB\").Select\n         Range(\"A2:W2\").Select\n         Selection.Copy\n\n         Workbooks(\"Purchase Order Details for FY 2015.xlsx\").Activate\n         Worksheets(\"2015\").Select\n\n         With ActiveSheet\n            x = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n         End With\n\n         Range(\"C\" &amp; x + 1).Select\n         Selection.PasteSpecial Paste:=xlPasteValues\n\n\n         Workbooks(\"Technology Purchase Order Template V4.xlsm\").Activate\n         Worksheets(\"PO Authorization\").Select\n\n\n\n    'Call the function with the correct arguments\n    Filename = RDB_Create_PDF(ActiveWorkbook, \"\", True, True)\n\n    'For a fixed file name and overwrite it each time you run the macro use\n    'RDB_Create_PDF(ActiveWorkbook, \"C:\\Users\\Ron\\Test\\YourPdfFile.pdf\", True, True)\n\n    If Filename &lt;&gt; \"\" Then\n        'Ok, you find the PDF where you saved it\n        'You can call the mail macro here if you want\n    Else\n        MsgBox \"Not possible to create the PDF, possible reasons:\" &amp; vbNewLine &amp; _\n               \"Microsoft Add-in is not installed\" &amp; vbNewLine &amp; _\n               \"You Canceled the GetSaveAsFilename dialog\" &amp; vbNewLine &amp; _\n               \"The path to Save the file in arg 2 is not correct\" &amp; vbNewLine &amp; _\n               \"You didn't want to overwrite the existing PDF if it exist\"\n    End If\n    End If\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5169391, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pJ8Kdt-BFR0/AAAAAAAAAAI/AAAAAAAAADI/mkfFpDNOknA/photo.jpg?sz=128", "display_name": "Rekboy", "link": "https://stackoverflow.com/users/5169391/rekboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1438254711, "creation_date": 1438174066, "last_edit_date": 1438175779, "question_id": 31700843, "link": "https://stackoverflow.com/questions/31700843/copying-an-offset-cell-from-a-different-file", "title": "Copying an Offset-Cell from a different File", "body": "<p>I want to copy an offset cell which was first counted down in a list. </p>\n\n<p>I am counting down, until the end +1, on the right side and then an offset from there to the DOWN,LEFT cell. And that number in the cell I want to copy into another file</p>\n\n<p>Here is the code that does not work.\nI know I use quite a lot of select and selection, which is probably the reason why it is not working.</p>\n\n<pre><code>Workbooks(\"Purchase Order Details for FY 2015.xlsx\").Activate\n         Worksheets(\"2015\").Select\nRange(\"B333\").Select\n        Selection.Copy\n         Windows(\"Technology Purchase Order Template V4.xlsm\").Activate\n         Sheets(\"PO Authorization\").Select\n         Range(\"B5\").Select\n         ActiveSheet.Paste\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1438173990, "post_id": 31700512, "comment_id": 51340647, "body": "google for &quot;last cell vba&quot;, subtract 1 off cloumn id, put value into cell. repeat (without googling)"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1438174148, "post_id": 31700512, "comment_id": 51340750, "body": "In your case I would propose a more generic solution. You loop once again through column C and as long as it is not version you paste in A and B. As soon as it is version you move to the next value."}], "answers": [{"comments": [{"owner": {"reputation": 881859, "user_id": 100297, "user_type": "moderator", "profile_image": "https://www.gravatar.com/avatar/24780fb6df85a943c7aea0402c843737?s=128&d=identicon&r=PG", "display_name": "Martijn Pieters", "link": "https://stackoverflow.com/users/100297/martijn-pieters"}, "edited": false, "score": 0, "creation_date": 1438260910, "post_id": 31701193, "comment_id": 51384875, "body": "Comments are not for extended discussion; this conversation has been <a href=\"http://chat.stackoverflow.com/rooms/84694/discussion-on-answer-by-luuklag-how-to-achieve-cell-copy-to-the-last-row-in-exce\">moved to chat</a>."}], "tags": [], "owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "is_accepted": false, "score": 0, "last_activity_date": 1438180381, "last_edit_date": 1438180381, "creation_date": 1438174903, "answer_id": 31701193, "question_id": 31700512, "link": "https://stackoverflow.com/questions/31700512/how-to-achieve-cell-copy-to-the-last-row-in-excel-using-vba/31701193#31701193", "title": "How to achieve cell copy to the last row in excel using vba?", "body": "<p>You should try this. It pastes the values in A and B that are in the row next to were there is Version in column C as long as column C is not equal to version, and when it equals version it jumps to the next set of data.</p>\n\n<p>It works now, it had a problem when it was in the row that had version in it and had columns a and b filled with data. Now it works:</p>\n\n<pre><code>                For row = 1 To lastRow Step 1\n                'If value of C cell is \"Version\", check column A cell and B cell\n                If Cells(row, 3) = \"Version\" Or Cells(row, 3) = \"version\" Then\n                    For row2 = row To lastRow\n                    'If both cell are empty and C is not version, store value.\n                    If row2 = row Then\n                    Else\n\n                        If Cells(row2, 3) &lt;&gt; \"Version\" And Cells(row2, 3) &lt;&gt; \"version\" And Cells(row2, 1) = \"\" And Cells(row2, 2) = \"\" Then\n                            Cells(row2, 1) = Cells(row, 1)\n                            Cells(row2, 2) = Cells(row, 2)\n                        ElseIf Cells(row2, 3) = \"Version\" Or Cells(row2, 3) = \"version\" Then\n                            row = row2 - 1\n                            Exit For\n                        End If\n\n                    End If\n                    Next row2\n                End If\n            Next row\n</code></pre>\n\n<p>Before: <a href=\"https://i.stack.imgur.com/qp5Z3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qp5Z3.png\" alt=\"enter image description here\"></a>\nAfter<a href=\"https://i.stack.imgur.com/uhiuo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uhiuo.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now inside your code:</p>\n\n<pre><code>           With wrdApp\n           .ActiveDocument.Tables(1).Select\n           .Selection.Copy\n            With ThisWorkbook.Worksheets(\"Sheet1\")\n            .Cells(Rows.Count, \"C\").End(xlUp)(1).PasteSpecial xlPasteValues\n            'getting the last row\n            lastRow = .Range(\"C:C\").End(xlDown).row\n            'loop all row in column \"C\" for checking\n                                   For row = 1 To lastRow Step 1\n                'If value of C cell is \"Version\", check column A cell and B cell\n                If Cells(row, 3) = \"Version\" Or Cells(row, 3) = \"version\" Then\n                    For row2 = row To lastRow\n                    'If both cell are empty and C is not version, store value.\n                    If row2 = row Then\n                    Else\n\n                        If Cells(row2, 3) &lt;&gt; \"Version\" And Cells(row2, 3) &lt;&gt; \"version\" And Cells(row2, 1) = \"\" And Cells(row2, 2) = \"\" Then\n                            Cells(row2, 1) = Cells(row, 1)\n                            Cells(row2, 2) = Cells(row, 2)\n                        ElseIf Cells(row2, 3) = \"Version\" Or Cells(row2, 3) = \"version\" Then\n                            row = row2 - 1\n                            Exit For\n                        End If\n\n                    End If\n                    Next row2\n                End If\n            Next row\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 3977872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb9f5f776bd1e777342763bc1a696d93?s=128&d=identicon&r=PG&f=1", "display_name": "nihal idiot", "link": "https://stackoverflow.com/users/3977872/nihal-idiot"}, "is_accepted": false, "score": 0, "last_activity_date": 1438680276, "creation_date": 1438680276, "answer_id": 31805449, "question_id": 31700512, "link": "https://stackoverflow.com/questions/31700512/how-to-achieve-cell-copy-to-the-last-row-in-excel-using-vba/31805449#31805449", "title": "How to achieve cell copy to the last row in excel using vba?", "body": "<p>Here is my answer which might help someone.\nPrior to that, I would like to say thanks to Luuklag for helping me in a brilliant way.</p>\n\n<p>Make sure that, you add the below references before proceeding.</p>\n\n<p><a href=\"https://i.stack.imgur.com/EDfhg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EDfhg.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Option Explicit\n\nDim FSO As Object\nDim strFolderName As String\nDim FileToOpenVdocx As String\nDim FileToOpenvdoc1 As String\nDim FileToOpenVdoc As String\nDim FileToOpenvdocx1 As String\nDim wrdApp As Word.Application\nDim wrdDoc As Word.Document\nDim fsoFolder As Object\n\n'To copy data from word to excel\n\n'Copy data from word to excel\nSub FindFilesInSubFolders()\nDim fsoFolder As Scripting.Folder\nSheets(\"Sheet1\").Cells.Clear\nFileToOpenVdocx = \"*V2.1.docx*\"\nFileToOpenvdoc1 = \"*v2.1.doc*\"\nFileToOpenVdoc = \"*V2.1.doc*\"\nFileToOpenvdocx1 = \"*v2.1.docx*\"\nIf FSO Is Nothing Then\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\nEnd If\n'Set the parent folder for the new subfolders\nstrFolderName = \"C:\\Test1\"\nSet fsoFolder = FSO.GetFolder(strFolderName)\nSet wrdApp = CreateObject(\"Word.Application\")\nOpenFilesInSubFolders fsoFolder\nwrdApp.Quit\nEnd Sub\n\nSub OpenFilesInSubFolders(fsoPFolder As Scripting.Folder)\nDim fsoSFolder As Scripting.Folder\nDim fileDoc As Scripting.File\nDim wrdRng As Object\nDim strText As String\nDim singleLine As Object\nDim outRow As Long ' newly added\nDim Found As String\nDim resultId As String\nDim singleLineZ As Object\nDim resultIdZ As String\nDim row As Long\nDim startRow As Long\nDim lastRow As Long\nDim LRA As Long\nDim LRB As Long\nDim row2 As Long\n\noutRow = 1 'you appear to want to start at the first row\nFor Each fsoSFolder In fsoPFolder.SubFolders\n    For Each fileDoc In fsoSFolder.Files\n        If (fileDoc.Name Like FileToOpenVdocx Or fileDoc.Name Like FileToOpenvdoc1 Or fileDoc.Name Like FileToOpenVdoc Or fileDoc.Name Like FileToOpenvdocx1) And Left(fileDoc.Name, 1) &lt;&gt; \"~\" Then\n            Set wrdDoc = wrdApp.Documents.Open(fileDoc.Path)\n            Set wrdRng = wrdDoc.Content\n            For Each singleLine In wrdApp.ActiveDocument.Paragraphs\n                Found = InStr(singleLine, \"Application\")\n                If Found &gt; 0 Then\n                    resultId = singleLine\n                    Exit For\n                End If\n            Next singleLine\n            For Each singleLineZ In wrdApp.ActiveDocument.Paragraphs\n                Found = InStr(singleLineZ, \"Z\")\n                If Found &gt; 0 Then\n                    resultIdZ = singleLineZ\n                    Exit For\n                End If\n            Next singleLineZ\n            With wrdApp\n                .ActiveDocument.Tables(1).Select\n                .Selection.Copy\n                With ThisWorkbook.Worksheets(\"Sheet1\")\n                    startRow = .Cells(.Rows.Count, \"C\").End(xlUp)(2).row\n                    .Cells(startRow, \"C\").PasteSpecial xlPasteValues\n                    lastRow = .Cells(.Rows.Count, \"C\").End(xlUp).row\n                    'Match the last pasted table with the labels\n                    .Range(.Cells(startRow, \"A\"), .Cells(lastRow, \"A\")).Value = resultId\n                    .Range(.Cells(startRow, \"B\"), .Cells(lastRow, \"B\")).Value = resultIdZ\n                End With\n            End With\n            wrdDoc.Close False\n        End If\n    Next fileDoc\n    OpenFilesInSubFolders fsoSFolder\nNext fsoSFolder\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 3977872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb9f5f776bd1e777342763bc1a696d93?s=128&d=identicon&r=PG&f=1", "display_name": "nihal idiot", "link": "https://stackoverflow.com/users/3977872/nihal-idiot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1210, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1438680276, "creation_date": 1438173190, "last_edit_date": 1531164843, "question_id": 31700512, "link": "https://stackoverflow.com/questions/31700512/how-to-achieve-cell-copy-to-the-last-row-in-excel-using-vba", "title": "How to achieve cell copy to the last row in excel using vba?", "body": "<p>I want to copy the data present in A9, up to the cell A12 &amp; similarly from B9 to B12. I can copy the data present in cell A1, up to A8 successfully. But cannot copy &amp; paste from A9 to A12 &amp; B9 to B12. My code is unable to copy &amp; paste for the last record.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Fr4uN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Fr4uN.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>           With wrdApp\n           .ActiveDocument.Tables(1).Select\n           .Selection.Copy\n            With ThisWorkbook.Worksheets(\"Sheet1\")\n            .Cells(Rows.Count, \"C\").End(xlUp)(1).PasteSpecial xlPasteValues\n            'getting the last row\n            lastRow = .Range(\"C:C\").End(xlDown).row\n            'loop all row in column \"C\" for checking\n                For row = 1 To lastRow Step 1\n                    'If value of C cell is \"Version\", check column A cell and B cell\n                    If (.Range(\"C\" &amp; row) = \"Version\" Or .Range(\"C\" &amp; row) = \"version\") Then\n                    'If both cell are empty, store value.\n                    If .Range(\"A\" &amp; row) = \"\" And .Range(\"B\" &amp; row) = \"\" Then\n                    .Range(\"A\" &amp; row).Value = resultId\n                    .Range(\"B\" &amp; row).Value = resultIdZ\n\n\n                    LR = Range(\"B\" &amp; Rows.Count).End(xlUp).row\n                        With Range(\"B2:B\" &amp; LR)\n                            With .SpecialCells(xlCellTypeBlanks)\n\n                            End With\n                            .Value = .Value\n                        End With\n\n                    LR = Range(\"A\" &amp; Rows.Count).End(xlUp).row\n                    With Range(\"A2:A\" &amp; LR)\n                        With .SpecialCells(xlCellTypeBlanks)\n                        .FormulaR1C1 = \"=R[-1]C\"\n                        End With\n                        .Value = .Value\n                    End With\n                Exit For\n            End If\n        End If\n    Next row\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1438173356, "post_id": 31700440, "comment_id": 51340178, "body": "Umm.. OK, replace that one machine."}, {"owner": {"reputation": 181, "user_id": 5120530, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4b44ef868afbfff63a2b25b5215b202a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Welsh", "link": "https://stackoverflow.com/users/5120530/ryan-welsh"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1438173529, "post_id": 31700440, "comment_id": 51340303, "body": "@MartinJames Trust me, if I had the ability to make that decision I would."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1438173560, "post_id": 31700440, "comment_id": 51340326, "body": "Open the workbook on that machine.  Go to the tools pulldown in the VBA  IDE and select references.  See if anything is listed as MISSING."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1438173580, "post_id": 31700440, "comment_id": 51340336, "body": "Might be related to Permissions or Protection........is that User allowed to activate the given sheet??"}, {"owner": {"reputation": 181, "user_id": 5120530, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4b44ef868afbfff63a2b25b5215b202a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Welsh", "link": "https://stackoverflow.com/users/5120530/ryan-welsh"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1438174198, "post_id": 31700440, "comment_id": 51340790, "body": "@Gary&#39;sStudent There aren&#39;t any permissions on the worksheet he&#39;s trying to open - good thought though."}, {"owner": {"reputation": 181, "user_id": 5120530, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4b44ef868afbfff63a2b25b5215b202a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Welsh", "link": "https://stackoverflow.com/users/5120530/ryan-welsh"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1438174278, "post_id": 31700440, "comment_id": 51340855, "body": "@MatthewD I&#39;ll look into that when he comes back around, what would I do if something comes up &#39;missing&#39;."}], "answers": [{"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1438176008, "creation_date": 1438176008, "answer_id": 31701648, "question_id": 31700440, "link": "https://stackoverflow.com/questions/31700440/run-time-error-52121-code-fails-on-only-one-machine/31701648#31701648", "title": "Run-Time Error &#39;52121&#39; - Code Fails on Only One Machine", "body": "<p>To check for a missing reference, open the workbook on that machine. Go to the tools pulldown in the VBA IDE and select references. See if anything is listed as MISSING.</p>\n\n<p>If there is a missing reference.\nLook at the same reference on a machine that doesn't get the error. Look at the path of the reference and make sure it is right on the machine with the error. If it is wrong, select browse and look for the dll (or whatever) where the working machine shows it. If it is not there you can search the workstation for it. If it is not on the workstation you will have to find out what installs that library and get that installed on the workstation.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8fh7q.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8fh7q.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 181, "user_id": 5120530, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4b44ef868afbfff63a2b25b5215b202a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Welsh", "link": "https://stackoverflow.com/users/5120530/ryan-welsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1438178093, "creation_date": 1438173010, "last_edit_date": 1438178093, "question_id": 31700440, "link": "https://stackoverflow.com/questions/31700440/run-time-error-52121-code-fails-on-only-one-machine", "title": "Run-Time Error &#39;52121&#39; - Code Fails on Only One Machine", "body": "<p>In my <code>Workbook_Open</code> event, I activate a specific worksheet to ensure the user always opens on it. One user has an error message pop up when this portion of code tries to run:</p>\n\n<p><code>Run-Time Error '52121': Object Defined or Application Defined error</code></p>\n\n<p>I know the problem isn't with <code>EventsEnabled</code> because I tried that. If I had a guess, I would suspect that he is missing some sort of reference, or has corrupted software, but I don't even know where to begin figuring out either of those issues. </p>\n\n<p>My Code:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Application.EnableEvents = True 'this was added after I noticed his error\n    Sheets(\"Control Panel\").Activate 'it errors on this line\nEnd Sub\n</code></pre>\n\n<p>This issue, again, only occurs on one machine.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "edited": false, "score": 1, "creation_date": 1438173490, "post_id": 31700357, "comment_id": 51340277, "body": "Hi there.  Can you please post what you have tried? &quot;Code this for me&quot; kind of questions are generally frowned upon around here, however,  we&#39;d love to help you learn."}], "answers": [{"tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": false, "score": 1, "last_activity_date": 1438178067, "creation_date": 1438178067, "answer_id": 31702541, "question_id": 31700357, "link": "https://stackoverflow.com/questions/31700357/vba-script-in-excel-to-find-and-highlight-text/31702541#31702541", "title": "VBA script in excel to find and highlight text", "body": "<p>You can do this with conditional formatting, instead of VBA.</p>\n\n<p>Conditional formatting works by applying a 'second formula' to a given cell. If the 'second formula' results in TRUE, then special formatting conditions can be applied.</p>\n\n<p><strong>EXAMPLE CONDITIONAL FORMATTING</strong></p>\n\n<p>For example, if you have a single column of Data, A:A, and you want to check if that column has the exact string \"hello world\", you could add a conditional format [Home ribbon, Styles section, Conditional Formatting] that turns a cell yellow with this formula:</p>\n\n<pre><code>=$A1=\"hello world\"\n</code></pre>\n\n<p>This will only result in TRUE if the cell in column A at that row equals exactly \"hello world\" [note that Column A has an absolute-reference $, and row 1 does not, so row 1 is relative to the position of the cell in the condiitonal format rule].</p>\n\n<p>To check to see if any row in column A <em>includes</em> hellow world, we need to add a SEARCH function, which checks to see if a small search string is inside of a larger string:</p>\n\n<pre><code>=SEARCH(\"hello world\",$A1)&gt;0\n</code></pre>\n\n<p>Because SEARCH by default returns the first character in a larger string that matches the search term (and if it finds nothing, it returns #N/A), we check to see if our search for \"hello world\" in column A returns a number.</p>\n\n<p><strong>SEARCHING MULTIPLE COLUMNS</strong></p>\n\n<p>Now, to see if ANY column, say from A-D, <em>includes</em> \"hello world\", we concatenate each value of each column so that it gives us a single string, which we can search through for \"hello world\", like so:</p>\n\n<pre><code>=SEARCH(\"hello world\",$A1&amp;$B1&amp;$C1&amp;$D1)&gt;0\n</code></pre>\n\n<p>This will first create a single string, equal to A1 &amp; B1 &amp; C1 &amp; D1 all in a row. Then it will search that newly created string to see if \"hello world\" is inside it, and return a number value if it is.</p>\n\n<p><strong>ARRAY FORMULA BASICS</strong></p>\n\n<p>Finally, we need to do the tricky part - searching for multiple terms instead of just \"hello world\". This is called an Array Formula. An array formula works by performing a single operation on multiple cells, and then returning multiple results in an Array. In an Excel sheet, an array formula must be confirmed with CTRL + SHIFT + ENTER (instead of just ENTER), but in conditional formatting, you actually don't need to do anything special - it will recognize an array formula without a special command.</p>\n\n<p>As an example of conditional formatting, see this example, which checks whether any value from A1:A5 = 10, and if it does, it gives us the value in B1:B5:</p>\n\n<pre><code>=IF(A1:A5=10,B1:B5,\"\")\n</code></pre>\n\n<p>Remember in Excel on a worksheet, this would be confirmed by pressing CTRL + SHIFT + ENTER. If you do test this, it will give you the following result, assuming A2 = 10 and A5 = 10:</p>\n\n<pre><code>={\"\";B2;\"\";\"\";B5}\n</code></pre>\n\n<p>This result would actually be hidden, because Excel can't \"collapse\" an array function on its own. So assume column B had values, and we actually want to sum them together. We would then wrap the Array formula in a SUM function:</p>\n\n<pre><code>=SUM(IF(A1:A5=10,B1:B5,\"\"))\n</code></pre>\n\n<p>As you can see if you test this, we have actually created our own SUMIF function, using Array formulas instead of the built-in SUMIF.</p>\n\n<p><strong>SEARCHING FOR MULTIPLE TERMS WITH ARRAY FORMULAS</strong></p>\n\n<p>So now we apply these principles to the conditional formatting, to create an array formula which will check our concatenated 'NEW STRING' for any number of provided terms, as follow [Assumes the search terms are typed into cells E1:E10]:</p>\n\n<pre><code>=SUM(SEARCH($E$1:$E$10,$A1&amp;$B1&amp;$C1&amp;$D1)&gt;0)\n</code></pre>\n\n<p>This formula can be placed as a conditional formatting rule which reaches all of A:D. Set the rule to highlight / change format in whatever way you like.</p>\n"}], "owner": {"reputation": 11, "user_id": 5169343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb22c8566cbab30413bd0bac35e60f60?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Sood", "link": "https://stackoverflow.com/users/5169343/amit-sood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1874, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1438178067, "creation_date": 1438172775, "last_edit_date": 1438175218, "question_id": 31700357, "link": "https://stackoverflow.com/questions/31700357/vba-script-in-excel-to-find-and-highlight-text", "title": "VBA script in excel to find and highlight text", "body": "<p>I am looking for a VBA script that will help me find certain keywords in a cell and if found highlight the entire row. Below are my requirements:</p>\n\n<p>I have a database of words eg hell, get out, shut up, don't you dare etc. I need a macro to search the data in column \"E\" of excel and in case any of the cell in column \"E\" contains any word listed in the database (irrespective of the case of the word upper or lower)the entire row is highlighted. The word can be in the beginning, middle or end of the cell and the macro should be able to find that word and highlight the column.</p>\n\n<p>Seeking help from all VBA masters for this.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1438172807, "post_id": 31699959, "comment_id": 51339790, "body": "Hi and welcome to Stackoverflow! As you may have skipped the intro for this site: SO is not supposed to deliver full solutions, but rather helping you with problems in existing code. I&#39;d suggest to try something on your own (in VBA) and ask a question if you run into problems. For further information you might want to have a look at this: <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1438178893, "post_id": 31699959, "comment_id": 51344333, "body": "Search for &quot;vba recurse&quot; for examples."}, {"owner": {"reputation": 646, "user_id": 4553034, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/aLeXg.jpg?s=128&g=1", "display_name": "MAC", "link": "https://stackoverflow.com/users/4553034/mac"}, "edited": false, "score": 0, "creation_date": 1438245876, "post_id": 31699959, "comment_id": 51375006, "body": "your project is literally same as the project I&#39;m currently working. See my answer below. :)"}], "answers": [{"tags": [], "owner": {"reputation": 646, "user_id": 4553034, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/aLeXg.jpg?s=128&g=1", "display_name": "MAC", "link": "https://stackoverflow.com/users/4553034/mac"}, "is_accepted": false, "score": 1, "last_activity_date": 1438245829, "creation_date": 1438245829, "answer_id": 31719060, "question_id": 31699959, "link": "https://stackoverflow.com/questions/31699959/excel-vb-for-importing-data-from-folders/31719060#31719060", "title": "Excel VB for importing data from folders", "body": "<pre><code> Function GetExcelFiles(ByVal strFilePath As String) As String()\n    Dim arrStr As String() = Nothing\n    If Directory.Exists(strFilePath) Then\n       arrStr = GetFilePath(strFilePath)\n    Else\n       'error message here\n    End If\n\n    Return arrStr\nEnd Function\n\nPrivate Function GetFilePath(ByVal strFilePath As String) As String()\n\n    Dim arrFileNames As String() = Directory.GetFiles(strFilePath, \"*.xls\", SearchOption.AllDirectories)\n    Return arrFileNames\n\nEnd Function\n</code></pre>\n\n<p>The code above is how to get all excel files. Next thing is... open the workbook and read per worksheet. To read file by file, you can loop using <code>For Each</code>.</p>\n\n<pre><code>For Each strFileName In arrStr\n 'your code here\nNext\n</code></pre>\n\n<p>where <code>strFileName = GetExcelFiles(folderPath)</code></p>\n\n<p>Don't forget to add <code>Imports Microsoft.Office.Interop.Excel</code>\nthen </p>\n\n<pre><code>Dim excel As New Application\nDim workbook As Workbook = excel.Workbooks.Open(strFileName)\n</code></pre>\n\n<p>Now you have the workbook. To read per sheet, do it this way and put it in a function that returns boolean.</p>\n\n<pre><code>Dim worksheet As Worksheet\nFor intIndex As Integer = 1 To workbook.Sheets.Count\n    worksheet = workbook.Sheets(intIndex)\n    If worksheet.Name.Equals(THE_SHEETNAME) Then\n        'returns true\n        Exit For\n    End If\nNext\n</code></pre>\n\n<p>Now you can proceed with your process.</p>\n"}], "owner": {"reputation": 1, "user_id": 5169220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0415c12198290b51881625ad3c7c42d6?s=128&d=identicon&r=PG&f=1", "display_name": "shantanu", "link": "https://stackoverflow.com/users/5169220/shantanu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 873, "favorite_count": 0, "answer_count": 1, "score": -7, "last_activity_date": 1438315258, "creation_date": 1438171596, "last_edit_date": 1438315258, "question_id": 31699959, "link": "https://stackoverflow.com/questions/31699959/excel-vb-for-importing-data-from-folders", "title": "Excel VB for importing data from folders", "body": "<p>I am working on a project in excel that requires importing data from files on network.\nThe issue I am facing is as follows:</p>\n\n<p>I have a folder (in shared drive) in which there are few sub-folders and an excel file in the end sub-folder. The excel file has many tabs out of which I have to import the data from only 1 particular tab (e.g. Summary). This process has to be repeated for all the files in all the sub-folders.\nHere is the flow diagram of the description.</p>\n\n<p>Folder A -> Sub-folder1 -> Sub-folder2 -> {Excel file1, Excel file2}</p>\n\n<p>Now, what I am looking for is, that whenever I add a new excel file in the sub-folder 2, the data from that same tab (Summary) of the excel file (all excel files have same tabs with different data) should be imported to my destination excel file and make a graph of the data. I need a VB script to run this functionality. </p>\n\n<p>Also, if I have more sub-folders, then will VB take longer time to run ?</p>\n\n<p>I tried the following but doesn't seem to work:</p>\n\n<pre><code>Sub ConFiles()\n    Dim Wbname As String\n    Dim Wb As Workbook\n    Dim ws As Worksheet\n    Dim ws1 As Worksheet\n    Dim lngCalc As Long\n    Dim lngrow As Long\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n        lngCalc = .CalculationState\n        .Calculation = xlCalculationManual\n    End With\n\n    Set ws1 = ThisWorkbook.Sheets.Add\n    'change folder path here\n    FolderName = \"C:\\temp\"\n    Wbname = Dir(FolderName &amp; \"\\\" &amp; \"*.xls*\")\n\n    'ThisWorkbook.Sheets(1).UsedRange.ClearContents\n    Do While Len(Wbname) &gt; 0\n        Set Wb = Workbooks.Open(FolderName &amp; \"\\\" &amp; Wbname)\n        Set ws = Nothing\n        On Error Resume Next\n        'change sheet name here\n        Set ws = Wb.Sheets(\"loging form\")\n        On Error GoTo 0\n        If Not ws Is Nothing Then\n            lngrow = lngrow + 1\n            ws.Rows(2).Copy ws1.Cells(lngrow, \"A\")\n        End If\n        Wb.Close False\n        Wbname = Dir\n    Loop\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = lngCalc\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5169173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/124cae614e6510d4457976219c51782b?s=128&d=identicon&r=PG&f=1", "display_name": "Slingr", "link": "https://stackoverflow.com/users/5169173/slingr"}, "edited": false, "score": 0, "creation_date": 1438238471, "post_id": 31704725, "comment_id": 51370801, "body": "Thank you, I did not know that I had to save it"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1438183473, "creation_date": 1438183473, "answer_id": 31704725, "question_id": 31699541, "link": "https://stackoverflow.com/questions/31699541/put-color-category-to-a-outlook-mail/31704725#31704725", "title": "Put color category to a outlook mail", "body": "<p>You need to save the message. You might also want to make sure you are working with the MailItem object rather than ReportItem or MeetingItem objects: </p>\n\n<pre><code>For Each obj In objOutlookfolder\n        If (obj.Class = 43) and (obj.Categories &lt;&gt; \"Cat\u00e9gorie Rouge\") Then\n            obj.Categories = \"Cat\u00e9gorie Rouge\" \n            obj.Save\n        End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5169173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/124cae614e6510d4457976219c51782b?s=128&d=identicon&r=PG&f=1", "display_name": "Slingr", "link": "https://stackoverflow.com/users/5169173/slingr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2461, "favorite_count": 0, "accepted_answer_id": 31704725, "answer_count": 1, "score": 2, "last_activity_date": 1438183473, "creation_date": 1438170305, "last_edit_date": 1531164843, "question_id": 31699541, "link": "https://stackoverflow.com/questions/31699541/put-color-category-to-a-outlook-mail", "title": "Put color category to a outlook mail", "body": "<p>I can't figure out how to put a category color to a mail using VBA. If I put a color named \"Cat\u00e9gorie Rouge\" to a mail, if I do :</p>\n\n<pre><code>For Each obj In objOutlookfolder\n        If obj.Categories &lt;&gt; \"Cat\u00e9gorie Rouge\" Then\n            obj.Categories = \"Cat\u00e9gorie Rouge\" \n        End If\nNext\n</code></pre>\n\n<p>The program works. Executed step by step the program get in the if. If I put a \"Cat\u00e9gorie Rouge\" category the if works correctly.</p>\n\n<p>The purpose of my program is to use mail body if the mail DOESN'T have any category color. So if the body is read, I want the mail to get a color but I really can't figure out how. In the internet I didn't find anything nor in SO.</p>\n\n<p>Here are my set :</p>\n\n<pre><code> Set olApp = New Outlook.Application\n Set OLNS = olApp.GetNamespace(\"MAPI\")\n Set Recipient = OLNS.CreateRecipient(\"example@test.fr\") ' You don't need it \n Set objOutlookfolder = OLNS.GetSharedDefaultFolder(Recipient, olFolderInbox).Items\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1438171257, "post_id": 31699380, "comment_id": 51338741, "body": "How are you verifying, that the function does return null?"}, {"owner": {"reputation": 1342, "user_id": 3120232, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/39657b9b56e6eaf9a29d751e2d0fe9e1?s=128&d=identicon&r=PG&f=1", "display_name": "3xGuy", "link": "https://stackoverflow.com/users/3120232/3xguy"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1438171858, "post_id": 31699380, "comment_id": 51339170, "body": "I guess I&#39;m not, I just assumed that it was, it may only be &quot;&quot;"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1438175849, "post_id": 31699380, "comment_id": 51341948, "body": "&quot;Lookup_Sym<b>bol</b>&quot; and &quot;Lookup_Sym<b>obl</b>&quot; and not the same."}, {"owner": {"reputation": 1342, "user_id": 3120232, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/39657b9b56e6eaf9a29d751e2d0fe9e1?s=128&d=identicon&r=PG&f=1", "display_name": "3xGuy", "link": "https://stackoverflow.com/users/3120232/3xguy"}, "edited": false, "score": 0, "creation_date": 1438185146, "post_id": 31699380, "comment_id": 51349204, "body": "thank you everyone. got to love typos"}], "answers": [{"tags": [], "owner": {"reputation": 885, "user_id": 1676288, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00186351b531d40caafac61aeeb2946a?s=128&d=identicon&r=PG", "display_name": "Mark Butler", "link": "https://stackoverflow.com/users/1676288/mark-butler"}, "is_accepted": true, "score": 1, "last_activity_date": 1438183379, "last_edit_date": 1438183379, "creation_date": 1438175903, "answer_id": 31701601, "question_id": 31699380, "link": "https://stackoverflow.com/questions/31699380/vba-basic-function-returning-null/31701601#31701601", "title": "VBA Basic Function returning null", "body": "<p>Because you have misspelled <code>Lookup_Symbol</code> in your function. It should be:</p>\n\n<pre><code>Function Lookup_Symbol(search_Name As String) As String\n    Lookup_Symbol = DLookup(\"[Symbol]\", \"[Search_Names]\", \"[Search_Name]= '\" &amp; search_Name &amp; \"'\")\nEnd Function\n</code></pre>\n\n<p>You would have been able to spot this much easier if you had <code>Option Explicit</code> at the top of the module; it would then have told you that the variable <code>Lookup_Symobl</code> is not defined.</p>\n"}], "owner": {"reputation": 1342, "user_id": 3120232, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/39657b9b56e6eaf9a29d751e2d0fe9e1?s=128&d=identicon&r=PG&f=1", "display_name": "3xGuy", "link": "https://stackoverflow.com/users/3120232/3xguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 31701601, "answer_count": 1, "score": 0, "last_activity_date": 1594644030, "creation_date": 1438169855, "last_edit_date": 1594644030, "question_id": 31699380, "link": "https://stackoverflow.com/questions/31699380/vba-basic-function-returning-null", "title": "VBA Basic Function returning null", "body": "<p>I have a very basic function that is to return symbols  such as \"=\", \">\",\"&lt;\",\">=\", and \"&lt;=\" and it is only returning a null value. any Ideas?</p>\n\n<pre><code>Function Lookup_Symbol(search_Name As String) As String\n    Lookup_Symobl = DLookup(\"[Symbol]\", \"[Search_Names]\", \"[Search_Name]= '\" &amp; search_Name &amp; \"'\")\nEnd Function\n</code></pre>\n\n<p>when I do a <code>Debug.print DLookup(\"[Symbol]\", \"[Search_Names]\", \"[Search_Name]= '\" &amp; search_Name &amp; \"'\")</code> it will return = </p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1438170325, "post_id": 31699318, "comment_id": 51338036, "body": "Is your month really stored in that awful format?  You should always store dates as YYYY-MM-DD (or in this case YYYY-MM), so you can do appropriate comparisons."}, {"owner": {"reputation": 11, "user_id": 5168904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b917f8e7c5462aaf0ce56be0b147064?s=128&d=identicon&r=PG&f=1", "display_name": "Marek", "link": "https://stackoverflow.com/users/5168904/marek"}, "reply_to_user": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1438267710, "post_id": 31699318, "comment_id": 51390032, "body": "I know that, however i get this data from someone else, and there is no chance to change it."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5168904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b917f8e7c5462aaf0ce56be0b147064?s=128&d=identicon&r=PG&f=1", "display_name": "Marek", "link": "https://stackoverflow.com/users/5168904/marek"}, "edited": false, "score": 0, "creation_date": 1438329887, "post_id": 31699824, "comment_id": 51416213, "body": "I cant belive how stupid I am,  i was thinking about EXCEPT, but i forget that i can use &gt; operator. Thanks for advice, it works great."}], "tags": [], "owner": {"reputation": 215643, "user_id": 50552, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/200c020bef60e4d9c4c4ba1c85442026?s=128&d=identicon&r=PG", "display_name": "Andomar", "link": "https://stackoverflow.com/users/50552/andomar"}, "is_accepted": true, "score": 0, "last_activity_date": 1438171508, "last_edit_date": 1438171508, "creation_date": 1438171163, "answer_id": 31699824, "question_id": 31699318, "link": "https://stackoverflow.com/questions/31699318/access-query-for-deleting-repeats-in-next-months/31699824#31699824", "title": "Access query for deleting repeats in next months", "body": "<p>You can use an <code>exists</code> subquery to find rows that repeat earlier rows:</p>\n\n<pre><code>DELETE  yt1\nFROM    YourTable yt1\nWHERE   EXISTS\n        (\n        SELECT  *\n        FROM    YourTable yt2\n        WHERE   yt1.ID = yt2.ID AND\n                    mid(yt2.TheMonth, 3, 2) + mid(yt2.TheMonth, 1, 2) &lt;\n                    mid(yt1.TheMonth, 3, 2) + mid(yt1.TheMonth, 1, 2)\n        )\n</code></pre>\n\n<p>The <code>where</code> condition looks for:</p>\n\n<ul>\n<li>A row with the same ID</li>\n<li>An earlier date.  The dates are converted from <code>MM-YY</code> to <code>YYMM</code> so they can be compared.</li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 5168904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b917f8e7c5462aaf0ce56be0b147064?s=128&d=identicon&r=PG&f=1", "display_name": "Marek", "link": "https://stackoverflow.com/users/5168904/marek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 31699824, "answer_count": 1, "score": 1, "last_activity_date": 1438171508, "creation_date": 1438169674, "question_id": 31699318, "link": "https://stackoverflow.com/questions/31699318/access-query-for-deleting-repeats-in-next-months", "title": "Access query for deleting repeats in next months", "body": "<p>I have problem writing Access sql query. I want to select rows with id for each months with no repeats in later months, if id appears in january and february, it should be omitted in february etc.\nOf course I have data for whole year. \nExample data</p>\n\n<pre><code>Month   id\n__________\n01-15   1\n01-15   2\n01-15   3\n01-15   5\n01-15   2\n02-15   1\n02-15   4\n02-15   4\n02-15   5\n03-15   1\n03-15   9\n</code></pre>\n\n<p>Result should be</p>\n\n<pre><code>01-15   1\n01-15   2\n01-15   3\n01-15   5\n01-15   2\n02-15   4\n02-15   4\n03-15   9\n</code></pre>\n\n<p>So far i make vba macro for it with loop</p>\n\n<pre><code>Dim db As DAO.Database\nSet db = CurrentDb\nDim list As String, sql As String, okres As String\nDim i As Integer\n\nFor i = 1 To 12 Step 1\n    If i &lt; 10 Then\n        okres = \"0\" &amp; i\n    Else\n        okres = i\n    End If\n\n   sql = \"SELECT DISTINCT [ID] INTO SRC from [TMP] where okres = '\" &amp; okres &amp; \"-15';\"\n   db.Execute sql, dbFailOnError\n   sql = \"DELETE [TMP].* FROM [TMP] WHERE [ID] in (SELECT * from SRC) and okres &lt;&gt; '\" &amp; okres &amp; \"-15';\"\n   db.Execute sql, dbFailOnError\n   sql = \"DROP TABLE SRC\"\n   db.Execute sql, dbFailOnError\nNext i\n</code></pre>\n\n<p>It runs fine, but i want write it in one sql query.</p>\n"}, {"tags": ["excel", "vba", "shell", "batch-file", "path"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 2504227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c046ec82da092cf4c0f16699c3792cc?s=128&d=identicon&r=PG", "display_name": "mYmage", "link": "https://stackoverflow.com/users/2504227/mymage"}, "edited": false, "score": 0, "creation_date": 1438172239, "post_id": 31699174, "comment_id": 51339424, "body": "Thanks Dan, I discovered the problem in previous tests: the right number of double quote!"}], "tags": [], "owner": {"reputation": 18158, "user_id": 3293914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fPAnb.jpg?s=128&g=1", "display_name": "Dan Field", "link": "https://stackoverflow.com/users/3293914/dan-field"}, "is_accepted": true, "score": 3, "last_activity_date": 1438169272, "creation_date": 1438169272, "answer_id": 31699174, "question_id": 31699123, "link": "https://stackoverflow.com/questions/31699123/shell-command-on-excel-with-long-path-name-dont-work/31699174#31699174", "title": "Shell command on Excel with long path name don&#39;t work", "body": "<p>Path names with spaces have to be wrapped in quotes.</p>\n\n<pre><code>Call Shell(Environ$(\"COMSPEC\") &amp; \" /k \"\"L:\\Common Data\\myfile\\run.bat\"\"\", vbNormalFocus)\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 2504227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c046ec82da092cf4c0f16699c3792cc?s=128&d=identicon&r=PG", "display_name": "mYmage", "link": "https://stackoverflow.com/users/2504227/mymage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 0, "accepted_answer_id": 31699174, "answer_count": 1, "score": 1, "last_activity_date": 1439899062, "creation_date": 1438169126, "last_edit_date": 1439899062, "question_id": 31699123, "link": "https://stackoverflow.com/questions/31699123/shell-command-on-excel-with-long-path-name-dont-work", "title": "Shell command on Excel with long path name don&#39;t work", "body": "<p>I have a batch file run.bat in a network folder \"L:\\Common Data\\myfile\" and i want to execute it from an Excel's macro.\nGoogling around I found these sintax:</p>\n\n<pre><code>Call Shell(Environ$(\"COMSPEC\") &amp; \" /k L:\\Common Data\\myfile\\run.bat\", vbNormalFocus)\n</code></pre>\n\n<p>but it fails because it reads only \"L:\\Common\".\nI tryed many suggestion found on Internet but no one succeeded.\nSomeone have a solution?</p>\n"}, {"tags": ["excel", "powerpivot", "powerquery", "vba"], "comments": [{"owner": {"reputation": 824, "user_id": 5023092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNreo.png?s=128&g=1", "display_name": "Gordon K", "link": "https://stackoverflow.com/users/5023092/gordon-k"}, "edited": false, "score": 0, "creation_date": 1438172070, "post_id": 31699019, "comment_id": 51339307, "body": "The data isn&#39;t currently in a format that would suit powerpivot - it would need some pre-processing either with VBA or with PowerQuery and it might be easier to get the VBA or PowerQuery to do the whole job."}, {"owner": {"reputation": 218, "user_id": 4142481, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/bc1ea7e9abc2caf2d3b50900be233db1?s=128&d=identicon&r=PG&f=1", "display_name": "Pindub_Amateur", "link": "https://stackoverflow.com/users/4142481/pindub-amateur"}, "reply_to_user": {"reputation": 824, "user_id": 5023092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNreo.png?s=128&g=1", "display_name": "Gordon K", "link": "https://stackoverflow.com/users/5023092/gordon-k"}, "edited": false, "score": 0, "creation_date": 1438181605, "post_id": 31699019, "comment_id": 51346492, "body": "Could you give me some tips on how I would go about it with VBA or PowerQuery?"}], "answers": [{"tags": [], "owner": {"reputation": 824, "user_id": 5023092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNreo.png?s=128&g=1", "display_name": "Gordon K", "link": "https://stackoverflow.com/users/5023092/gordon-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1438252747, "creation_date": 1438252747, "answer_id": 31721517, "question_id": 31699019, "link": "https://stackoverflow.com/questions/31699019/excel-powerpivot-working-with-grouped-rows/31721517#31721517", "title": "Excel PowerPivot - Working with grouped rows", "body": "<p>One approach would be to:</p>\n\n<ol>\n<li>Create a copy of your spreadsheet in a new workbook.</li>\n<li>Add another worksheet in the workbook that contains the StaffId (in column \"A\") of the people you want to filter for.</li>\n<li><p>In the VBA editor, insert a new module and add the following code:</p>\n\n<pre><code>Sub FilterForUsersOfInterest()\nDim BigSheet As Worksheet\nDim ListSheet As Worksheet\nDim lastCell As Range\n\nSet BigSheet = ActiveWorkbook.Sheets(\"ListOfApplications\") 'Change the sheet name here to match your main data tab\nSet ListSheet = ActiveWorkbook.Sheets(\"ListOfUsers\") 'Change the sheet name here to match your sheet with the users of interest this time round\n\n'Find the last used row on the worksheet\nSet lastCell = BigSheet.UsedRange.Item(BigSheet.UsedRange.Cells.Count)\n\n'Copy the values for Staff Id down all the rows\nFor iRow = 2 To lastCell.Row\n    If BigSheet.Range(\"A\" &amp; iRow) = \"\" Then\n        BigSheet.Range(\"A\" &amp; iRow) = BigSheet.Range(\"A\" &amp; iRow - 1)\n    End If\nNext iRow\n\n'Now work your way back up the rows, deleting any rows where the StaffId is not found in the current list of \"users of interest\"\nFor iRow = lastCell.Row To 2\n    If Application.WorksheetFunction.CountIf(ListSheet.Range(\"A:A\"), BigSheet.Range(\"A\" &amp; iRow)) = 0 Then\n        BigSheet.Range(\"A\" &amp; iRow).EntireRow.Delete\n    End If\nNext iRow\nEnd Sub\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 218, "user_id": 4142481, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/bc1ea7e9abc2caf2d3b50900be233db1?s=128&d=identicon&r=PG&f=1", "display_name": "Pindub_Amateur", "link": "https://stackoverflow.com/users/4142481/pindub-amateur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 31721517, "answer_count": 1, "score": 0, "last_activity_date": 1438252747, "creation_date": 1438168832, "last_edit_date": 1531161705, "question_id": 31699019, "link": "https://stackoverflow.com/questions/31699019/excel-powerpivot-working-with-grouped-rows", "title": "Excel PowerPivot - Working with grouped rows", "body": "<p>I'm working on a really large excel sheet which is basically a list of users along with the applications they use. Now the problem is that there are over 60000 users with atleast 10 applications each. So its a huge sheet. 2-3 times a week I need to extract the details of the applications used by certain specific users. Sometimes it's 2 users. Sometimes its 10 users. But due to the size of the spreadsheet, this activity takes me forever (1-2 hours). </p>\n\n<p>Now, the sheet is structured in the following way. </p>\n\n<pre><code>StaffId Name       DeviceNo      Location       ApplicationCount+    AppID   Application Name\n\n12345   John Doe   DSK-982333    Mespil Road    24+    \n                                                                     123     Adobe Acrobat\n                                                                     234     WinZip\n                                                                     345     Google Chrome\n</code></pre>\n\n<p>The + sign here is to indicate the grouped rows. </p>\n\n<p>Is there anyway for me to use PowerPivots to extract this information?</p>\n"}, {"tags": ["arrays", "vba", "excel", "date"], "comments": [{"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1438167809, "post_id": 31698571, "comment_id": 51336439, "body": "ReDim Preserve dateArray(ubound(dateArray)+1) Does this work for you? the preserve keyword will keep data in the array"}, {"owner": {"reputation": 395, "user_id": 1329974, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f0e30723bd9f2047995e3a2da94a4f5d?s=128&d=identicon&r=PG", "display_name": "GBSingh", "link": "https://stackoverflow.com/users/1329974/gbsingh"}, "reply_to_user": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1438167885, "post_id": 31698571, "comment_id": 51336497, "body": "@99moorem where in the code would I put this and what does this do?"}], "answers": [{"tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": false, "score": 1, "last_activity_date": 1438167994, "creation_date": 1438167994, "answer_id": 31698699, "question_id": 31698571, "link": "https://stackoverflow.com/questions/31698571/adding-items-to-an-array-vba-excel/31698699#31698699", "title": "adding items to an array VBA excel", "body": "<p>The reason is that you have declared array <code>dateArray</code> as having only one element, indexed with 1:</p>\n\n<pre><code>ReDim dateArray(1 To 1) As Date\n</code></pre>\n\n<p>Later in your code you try to assign a value to an element of this array with index 0 (but there is no such element and that is why this error is displayed):</p>\n\n<pre><code>For x = 0 To str2\n    If x = 0 Then\n        dateArray(x) = str1  '&lt;---- in first iteration, when x = 0, you \n                             '      try to assign to element with 0 index.\n    Else\n\n(...)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 395, "user_id": 1329974, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f0e30723bd9f2047995e3a2da94a4f5d?s=128&d=identicon&r=PG", "display_name": "GBSingh", "link": "https://stackoverflow.com/users/1329974/gbsingh"}, "edited": false, "score": 0, "creation_date": 1438169052, "post_id": 31698720, "comment_id": 51337238, "body": "thanks for the knowledge about the variables i did not know this"}], "tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": false, "score": 2, "last_activity_date": 1438168041, "creation_date": 1438168041, "answer_id": 31698720, "question_id": 31698571, "link": "https://stackoverflow.com/questions/31698571/adding-items-to-an-array-vba-excel/31698720#31698720", "title": "adding items to an array VBA excel", "body": "<p>You need to increase the size of your array. This line:</p>\n\n<pre><code>ReDim dateArray(1 To 1) As Date\n</code></pre>\n\n<p>only gives you one element in your array. You should be using:</p>\n\n<pre><code>ReDim dateArray(0 To str2) As Date\n</code></pre>\n\n<p>after you've worked out the value of str2.</p>\n\n<p>btw, you can use the <code>Abs</code> function to give you a positive number:</p>\n\n<pre><code>str2 = Abs(DateDiff(\"d\", str1, str3))\n</code></pre>\n\n<p>Also, when you declare multiple variables on one line you must include the type for every variable. In this line:</p>\n\n<pre><code>Dim wks As Excel.Worksheet, str1, str2, str3, str4 As Date, x As Integer\n</code></pre>\n\n<p>the variables <code>str1, str2, str3</code> all get declared as <code>Variant</code> not <code>Date</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 395, "user_id": 1329974, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f0e30723bd9f2047995e3a2da94a4f5d?s=128&d=identicon&r=PG", "display_name": "GBSingh", "link": "https://stackoverflow.com/users/1329974/gbsingh"}, "edited": false, "score": 1, "creation_date": 1438169013, "post_id": 31698850, "comment_id": 51337207, "body": "Thanks you so much for this it worked. I didn&#39;t realise that by not putting the as date after every one did not make it into a date, I thought that everything before the as date would be made into a date, so thank you for teaching me that. Thats why I like stack overflow you guys are a fountain of knowledge that one can truly learn from thanks"}], "tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": true, "score": 2, "last_activity_date": 1438168385, "creation_date": 1438168385, "answer_id": 31698850, "question_id": 31698571, "link": "https://stackoverflow.com/questions/31698571/adding-items-to-an-array-vba-excel/31698850#31698850", "title": "adding items to an array VBA excel", "body": "<p>Try below, the redim will resize an array. ubound() finds the top end of an array so ubound()+1 will add one extra size to the array. The preserve keyword will preserve any values that are currently in the array</p>\n\n<p>notice 1: how I have declared you variables str1 - 3 was not declared as a date. 2: how I have initialised your array dont need to do 1 to 1 can just say I want x amount</p>\n\n<p>Hope that helps</p>\n\n<pre><code>Private Sub SearchButton4_Click()\n    Dim wks As Excel.Worksheet, str1 As Date, str2 As Date, str3 As Date, str4 As Date, x As Integer\n    Dim dateArray() As Date\n\n    ReDim dateArray(1) As Date\n    Set wks = Worksheets(\"Exceptions\")\n    str1 = Format(DateFromTextBox.Value, \"dd-mm-yyyy\")\n    str3 = Format(DateToTextBox.Value, \"dd-mm-yyyy\")\n    str2 = DateDiff(\"d\", str1, str3)\n\n    If str2 &lt; 0 Then\n        str2 = str2 * -1\n    End If\n\n    For x = 0 To str2\n        If x = 0 Then\n            dateArray(x) = str1\n        Else\n            str4 = DateAdd(\"d\", 1, str1)\n            dateArray(x) = str4\n            str1 = str4\n        End If\n        ReDim Preserve dateArray(ubound(dateArray)+1) \n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1438168828, "creation_date": 1438168828, "answer_id": 31699017, "question_id": 31698571, "link": "https://stackoverflow.com/questions/31698571/adding-items-to-an-array-vba-excel/31699017#31699017", "title": "adding items to an array VBA excel", "body": "<p>You've already calculated the size so you can use that with <code>Redim</code> once rather than using <code>Preserve</code> which is a relatively expensive operation as it copies your entire array. I'd also suggest some more descriptive variable names and you should explicitly declare the type of all variables:</p>\n\n<pre><code>Private Sub SearchButton4_Click()\n    Dim wks                   As Excel.Worksheet\n    Dim dtFrom                As Date\n    Dim dtTo                  As Date\n    Dim lNumberOfDays         As Long\n    Dim x                     As Long\n    Dim dateArray()           As Date\n\n    Set wks = Worksheets(\"Exceptions\")\n\n    dtFrom = CDate(DateFromTextBox.Value)\n    dtTo = CDate(DateToTextBox.Value)\n\n    If dtTo &lt; dtFrom Then\n        dtTo = CDate(DateFromTextBox.Value)\n        dtFrom = CDate(DateToTextBox.Value)\n    End If\n\n    lNumberOfDays = dtTo - dtFrom\n\n    ReDim dateArray(1 To lNumberOfDays + 1, 1 To 1) As Date\n\n    For x = 0 To lNumberOfDays\n        dateArray(x + 1, 1) = dtFrom + x\n    Next\n\n    With wks.Range(\"A1\").Resize(UBound(dateArray))\n        .NumberFormat = \"dd-mm-yyyy\"\n        .Value = dateArray\n    End With\nEnd Sub\n</code></pre>\n\n<p>I assumed you would be outputting the results to the worksheet, so I used a 2D array.</p>\n"}], "owner": {"reputation": 395, "user_id": 1329974, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f0e30723bd9f2047995e3a2da94a4f5d?s=128&d=identicon&r=PG", "display_name": "GBSingh", "link": "https://stackoverflow.com/users/1329974/gbsingh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4126, "favorite_count": 0, "accepted_answer_id": 31698850, "answer_count": 4, "score": 3, "last_activity_date": 1438168828, "creation_date": 1438167630, "last_edit_date": 1438167824, "question_id": 31698571, "link": "https://stackoverflow.com/questions/31698571/adding-items-to-an-array-vba-excel", "title": "adding items to an array VBA excel", "body": "<p>I am trying to add date into an array but am not able to do it. Every time that I try to do it I get a Subscript out of range error. I have used arrays before in other languages so this should work but it is not and I don't seem to understand why. Below I have added the code that is currently not working. What I am trying to do is after a user enters two dates my code should store the starting value and then add one to that date and add it to the array and so on until I have a array list of all the date from the start date to the end date. Any help would be great thanks</p>\n\n<pre><code>Private Sub SearchButton4_Click()\n    Dim wks As Excel.Worksheet, str1, str2, str3, str4 As Date, x As Integer\n    Dim dateArray() As Date\n\n    ReDim dateArray(1 To 1) As Date\n    Set wks = Worksheets(\"Exceptions\")\n    str1 = Format(DateFromTextBox.Value, \"dd-mm-yyyy\")\n    str3 = Format(DateToTextBox.Value, \"dd-mm-yyyy\")\n    str2 = DateDiff(\"d\", str1, str3)\n\n    If str2 &lt; 0 Then\n        str2 = str2 * -1\n    End If\n\n    For x = 0 To str2\n        If x = 0 Then\n            dateArray(x) = str1\n        Else\n            str4 = DateAdd(\"d\", 1, str1)\n            dateArray(x) = str4\n            str1 = str4\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 5169022, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kHRZ6Wjy32k/AAAAAAAAAAI/AAAAAAAAAC8/uiYUQrkc0ig/photo.jpg?sz=128", "display_name": "MayContainVennom", "link": "https://stackoverflow.com/users/5169022/maycontainvennom"}, "reply_to_user": {"reputation": 10985, "user_id": 2664350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/267fd556e7bd18db2e3923939cd3dd6b?s=128&d=identicon&r=PG", "display_name": "piet.t", "link": "https://stackoverflow.com/users/2664350/piet-t"}, "edited": false, "score": 0, "creation_date": 1438167819, "post_id": 31698488, "comment_id": 51336451, "body": "As far as I am aware isshould be in with the excel import, what should it be delcared as?"}], "answers": [{"tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": false, "score": 1, "last_activity_date": 1438168825, "creation_date": 1438168825, "answer_id": 31699013, "question_id": 31698488, "link": "https://stackoverflow.com/questions/31698488/excel-vba-error-using-range-find-method/31699013#31699013", "title": "Excel VBA - Error using Range.Find method", "body": "<p>The error message is possibly misleading because you parameters look ok. The <code>Range.Find</code> method returns a range object, so in VBA you must use the <code>Set</code> keyword:</p>\n\n<pre><code>Set FoundCell = oSheet.Range(\"A:A\").Find(What:=currentDay, LookIn:=xlvalues)\n</code></pre>\n\n<p>You might struggle with finding dates because Excel stores them as a number and then displays them as a date. Depending on your data you might need to search for the formatted text or using a <code>Date</code> variable.</p>\n\n<p>If you are writing this in VBA, this line will not work:</p>\n\n<pre><code>Dim currentDay As String = String.Format(DateTime.Now.ToString(\"dd/MM/yyyy\"))\n</code></pre>\n\n<p>You must declare variables separately from initialising them.</p>\n\n<pre><code>Dim currentDay As String\ncurrentDay = Format(Date(),\"dd/MM/yyyy\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "is_accepted": false, "score": 0, "last_activity_date": 1438169033, "creation_date": 1438169033, "answer_id": 31699094, "question_id": 31698488, "link": "https://stackoverflow.com/questions/31698488/excel-vba-error-using-range-find-method/31699094#31699094", "title": "Excel VBA - Error using Range.Find method", "body": "<p>Similar to ChipsLetten (but a little slower!), I altered your code as below.</p>\n\n<pre><code>Sub notableopenfile()\n\n    ' Find Current Day In Excel Sheet\n    Dim currentDay As String\n    'currentDay = Format(DateTime.Now.ToString(\"dd/MM/yyyy\")) ' Todays Date In Format To Search Spreadsheet\n    currentDay = Format(Now(), \"dd/MM/yyyy\")\n    Dim FoundCell As Range\n\n    Set FoundCell = ActiveSheet.Range(\"A:A\").Find(What:=currentDay, LookIn:=xlValues) 'need 'set' here\n\n    If Not FoundCell Is Nothing Then\n        MsgBox (currentDay &amp; \" Found In Row: \" &amp; FoundCell.Row)\n    Else\n        MsgBox (currentDay &amp; \" Not Found In Sheet \" &amp; ActiveSheet.Name)\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5169022, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kHRZ6Wjy32k/AAAAAAAAAAI/AAAAAAAAAC8/uiYUQrkc0ig/photo.jpg?sz=128", "display_name": "MayContainVennom", "link": "https://stackoverflow.com/users/5169022/maycontainvennom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1438171022, "creation_date": 1438167339, "last_edit_date": 1438171022, "question_id": 31698488, "link": "https://stackoverflow.com/questions/31698488/excel-vba-error-using-range-find-method", "title": "Excel VBA - Error using Range.Find method", "body": "<p>I are building a program in VBA that will basically, paste text into a spreadsheet using the excel for VBA. The following error has stated to happen:</p>\n\n<pre><code>error on the xlvalues on this line: FoundCell = oSheet.Range(\"A:A\").Find(What:=currentDay, LookIn:=xlvalues)\n\nerror is xlValues is not declared or may not be accessible due to its protection level\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>' Find Current Day In Excel Sheet\n Dim currentDay As String = String.Format(DateTime.Now.ToString(\"dd/MM/yyyy\")) ' Todays Date In Format To Search Spreadsheet\nDim FoundCell As Excel.Range\n\nFoundCell = oSheet.Range(\"A:A\").Find(What:=currentDay, LookIn:=xlvalues)\n\nIf Not FoundCell Is Nothing Then\nMsgBox(currentDay &amp; \" Found In Row: \" &amp; FoundCell.Row)\nElse\nMsgBox(currentDay &amp; \" Not Found In Sheet \" &amp; oSheet.Name)\nEnd If\n</code></pre>\n\n<p>Any help would be much appricated,</p>\n\n<p>Thanks,\nSean</p>\n"}, {"tags": ["database", "vba", "excel", "ms-access"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1438167879, "post_id": 31698388, "comment_id": 51336495, "body": "You should be using DAO/ADO to update the data, in which case you can get the ID using a SELECT query. Not really sure why you need to get the PK though."}, {"owner": {"reputation": 17, "user_id": 2562166, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/17f2fc3f65dcb5467680aaad12e9e05d?s=128&d=identicon&r=PG", "display_name": "2562166", "link": "https://stackoverflow.com/users/2562166/2562166"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1438168255, "post_id": 31698388, "comment_id": 51336735, "body": "@Rory I am updating the data using an SQL query and it works just fine. My only problem is the DMax function. I&#39;m new to all this and I&#39;m not sure how auto-increment should work here so I get the PK of the latest record so I can increment it using the code then pass it in the query where I insert the new record into the table."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1438168894, "post_id": 31698388, "comment_id": 51337140, "body": "Isn&#39;t your PK an autonumber? If it is, you don&#39;t need to include it when you add the data."}, {"owner": {"reputation": 17, "user_id": 2562166, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/17f2fc3f65dcb5467680aaad12e9e05d?s=128&d=identicon&r=PG", "display_name": "2562166", "link": "https://stackoverflow.com/users/2562166/2562166"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1438169815, "post_id": 31698388, "comment_id": 51337717, "body": "@Rory I&#39;m not the one who created the database so I&#39;m not really sure but I&#39;m looking into it. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 2562166, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/17f2fc3f65dcb5467680aaad12e9e05d?s=128&d=identicon&r=PG", "display_name": "2562166", "link": "https://stackoverflow.com/users/2562166/2562166"}, "edited": false, "score": 0, "creation_date": 1438168538, "post_id": 31698786, "comment_id": 51336901, "body": "It worked! I&#39;m still confused as to which functions are under Access and which ones are under Excel. Thank you very much for this."}], "tags": [], "owner": {"reputation": 885, "user_id": 1676288, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00186351b531d40caafac61aeeb2946a?s=128&d=identicon&r=PG", "display_name": "Mark Butler", "link": "https://stackoverflow.com/users/1676288/mark-butler"}, "is_accepted": true, "score": 1, "last_activity_date": 1438168249, "creation_date": 1438168249, "answer_id": 31698786, "question_id": 31698388, "link": "https://stackoverflow.com/questions/31698388/dmax-function-not-working-when-ms-access-is-not-open/31698786#31698786", "title": "DMax function not working when MS Access is not open", "body": "<p>DMax for a database is an Access VBA function, not an Excel VBA function.</p>\n\n<p>You'll need to either connect via DAO/ADO, or create an Access object like this:</p>\n\n<pre><code>Public Sub AccessDmax()\n\n    Dim userID as Integer\n    Dim oAccess As Object\n    Set oAccess = CreateObject(\"Access.Application\")\n\n    oAccess.Visible = False\n    oAccess.OpenCurrentDatabase \"C:\\test_databases\\test.accdb\"\n\n    userID = oAccess.DMax(\"ID\", \"subscriber_user\")\n\n    oAccess.Quit\n    Set oAccess = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 2562166, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/17f2fc3f65dcb5467680aaad12e9e05d?s=128&d=identicon&r=PG", "display_name": "2562166", "link": "https://stackoverflow.com/users/2562166/2562166"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 567, "favorite_count": 0, "accepted_answer_id": 31698786, "answer_count": 1, "score": 1, "last_activity_date": 1438168249, "creation_date": 1438167116, "last_edit_date": 1531164843, "question_id": 31698388, "link": "https://stackoverflow.com/questions/31698388/dmax-function-not-working-when-ms-access-is-not-open", "title": "DMax function not working when MS Access is not open", "body": "<p>I am writing a code in VBA that allows for a new user to be added in the database using a user form in MS Excel. The database must be automatically updated once the form is submitted. I am using the <code>DMax</code> function to get the highest existing primary key in the table. I then increment it to get the primary key for the new user to be added. The code works perfectly when the database is open in MS Access. However, it returns the error \"Sub or Function not defined.\" whenever MS Access is not open.\nHere is the code that is highlighted when the error appears:</p>\n\n<pre><code>userID = DMax(\"[UserID]\", \"subscriber_user\") + 1\n</code></pre>\n\n<p><code>userID</code> is my variable, <code>UserID</code> is the column containing the primary keys, and <code>subscriber_user</code> is the name of the table in the database.</p>\n\n<p>Is it necessary for the database to be open using MS Access for it to work? Is there another method to make sure that the database gets updated without having it to open it via MS Access or any other IDE?</p>\n"}, {"tags": ["vba", "loops", "ms-access-2010", "recordset"], "comments": [{"owner": {"reputation": 137, "user_id": 3167003, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/07e77ab4e6712c92e29c0dc6d8e367d7?s=128&d=identicon&r=PG&f=1", "display_name": "pony2deer", "link": "https://stackoverflow.com/users/3167003/pony2deer"}, "edited": false, "score": 0, "creation_date": 1438168219, "post_id": 31698271, "comment_id": 51336713, "body": "which error code do you get? which line is highlighted? also: variable m_rst is not defined in your code. either it is global (is it?) or you didn&#39;t define it"}, {"owner": {"reputation": 29, "user_id": 3679517, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f859680c913dcdff369872fe0aa74ca8?s=128&d=identicon&r=PG&f=1", "display_name": "user24555", "link": "https://stackoverflow.com/users/3679517/user24555"}, "reply_to_user": {"reputation": 137, "user_id": 3167003, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/07e77ab4e6712c92e29c0dc6d8e367d7?s=128&d=identicon&r=PG&f=1", "display_name": "pony2deer", "link": "https://stackoverflow.com/users/3167003/pony2deer"}, "edited": false, "score": 0, "creation_date": 1438168725, "post_id": 31698271, "comment_id": 51337029, "body": "the m_rst is global and it does not jump into the loop.. I don&#39;t know why"}, {"owner": {"reputation": 29, "user_id": 3679517, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f859680c913dcdff369872fe0aa74ca8?s=128&d=identicon&r=PG&f=1", "display_name": "user24555", "link": "https://stackoverflow.com/users/3679517/user24555"}, "reply_to_user": {"reputation": 137, "user_id": 3167003, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/07e77ab4e6712c92e29c0dc6d8e367d7?s=128&d=identicon&r=PG&f=1", "display_name": "pony2deer", "link": "https://stackoverflow.com/users/3167003/pony2deer"}, "edited": false, "score": 0, "creation_date": 1438168939, "post_id": 31698271, "comment_id": 51337161, "body": "I get an Run-time error &#39;-2147352567 (80020009)&#39;: The value you entered isn&#39;t valid for this field"}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1438169822, "post_id": 31698271, "comment_id": 51337720, "body": "Which line of code causes that error?"}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1438170216, "post_id": 31698271, "comment_id": 51337964, "body": "Also add the code that opens the recordset."}, {"owner": {"reputation": 572, "user_id": 2497001, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb2b8a8f50e8038ea7f9d199b68bf750?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/2497001/evan"}, "edited": false, "score": 0, "creation_date": 1438176030, "post_id": 31698271, "comment_id": 51342071, "body": "Sounds like the Recordset isn&#39;t ever initialized or is initialized with a query that returns no rows."}, {"owner": {"reputation": 349, "user_id": 3140152, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e3f288a1fd65f635e45be0ac2cc2f7c0?s=128&d=identicon&r=PG&f=1", "display_name": "pegicity", "link": "https://stackoverflow.com/users/3140152/pegicity"}, "edited": false, "score": 0, "creation_date": 1438200602, "post_id": 31698271, "comment_id": 51358379, "body": "I think you may need to m_rst.movefirst to initialize the recordset"}, {"owner": {"reputation": 29, "user_id": 3679517, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f859680c913dcdff369872fe0aa74ca8?s=128&d=identicon&r=PG&f=1", "display_name": "user24555", "link": "https://stackoverflow.com/users/3679517/user24555"}, "edited": false, "score": 0, "creation_date": 1439201211, "post_id": 31698271, "comment_id": 51746195, "body": "I found a solution: Private Sub btnNextRecord_Click()  me.ListRecordset.Selected(me.ListRecordset.ListIndes+2)=True  ListRecordset_Click End Sub"}], "owner": {"reputation": 29, "user_id": 3679517, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f859680c913dcdff369872fe0aa74ca8?s=128&d=identicon&r=PG&f=1", "display_name": "user24555", "link": "https://stackoverflow.com/users/3679517/user24555"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1438171003, "creation_date": 1438166754, "last_edit_date": 1438171003, "question_id": 31698271, "link": "https://stackoverflow.com/questions/31698271/go-to-next-element-recordset-access-2010-with-vba", "title": "Go to next element Recordset Access 2010 with vba", "body": "<p>I need your help. I filtered a recordset with a query and looped through it to fill a list box.\nThen I like to click on next and the next item with the specific values should with the text boxes, but I get an error message and the absolute position is -1.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Private Sub btnNextRecord_Click()\n    Debug.Print \"Move Next: \" &amp; m_rst.AbsolutePosition\n    Do While Not m_rst.EOF\n        m_rst.MoveNext\n        Me.txtfield = m_rst(\"Value\")\n    Loop\nEnd Sub\n</code></pre>\n\n<p>but it's not working!</p>\n\n<p>Bets regards and thanks in advance</p>\n\n<p>Matthias</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 37744, "user_id": 578411, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qj33e.png?s=128&g=1", "display_name": "rene", "link": "https://stackoverflow.com/users/578411/rene"}, "edited": false, "score": 0, "creation_date": 1438166635, "post_id": 31698129, "comment_id": 51335719, "body": "Do you already have code that doesn&#39;t work or are you asking to write something based on your requirements?"}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1438167313, "post_id": 31698129, "comment_id": 51336129, "body": "You should try somethings and post that code if found error."}], "answers": [{"tags": [], "owner": {"reputation": 141, "user_id": 4663401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac32b68acf50cf217119913894e7f2a6?s=128&d=identicon&r=PG&f=1", "display_name": "amg", "link": "https://stackoverflow.com/users/4663401/amg"}, "is_accepted": false, "score": 0, "last_activity_date": 1438186510, "creation_date": 1438186510, "answer_id": 31705882, "question_id": 31698129, "link": "https://stackoverflow.com/questions/31698129/value-of-textbox-searched-and-jump-to-a-cell-by-clicking-a-button-in-the-userfor/31705882#31705882", "title": "Value of TextBox searched and jump to a cell by clicking a button in the UserForm", "body": "<p>Try the below piece of code</p>\n\n<pre><code>Dim i As Long\nDim rno As Integer\ni = 0\n\nDo While Sheets(2).Cells(i + 1, 1).Value &lt;&gt; \"\"\n\n        If Sheets(2).Cells(i + 1, 1).Value = TextBox1.Text Then\n\n            rno = Sheets(2).Cells(i + 1, 1).Row\n            GoTo Condition\n        Else\n        rno = 0\n\n        End If\n    i = i + 1\nLoop\n\nCondition:\nIf rno &lt;&gt; 0 Then\n    Sheets(2).Cells(rno, 2).Value = TextBox2.Text\nElse\n    MsgBox (\"No Such number is found\")\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5142822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5d66f4f8165c4fe03c07d018f921d3?s=128&d=identicon&r=PG&f=1", "display_name": "Sandeep Shivaraman", "link": "https://stackoverflow.com/users/5142822/sandeep-shivaraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438186510, "creation_date": 1438166379, "last_edit_date": 1531164843, "question_id": 31698129, "link": "https://stackoverflow.com/questions/31698129/value-of-textbox-searched-and-jump-to-a-cell-by-clicking-a-button-in-the-userfor", "title": "Value of TextBox searched and jump to a cell by clicking a button in the UserForm", "body": "<p>I have an Excel VB code in which I made a button in Excel that when clicked, goes to the next sheet and searches for the value based on employee number. I used <code>VLookup</code> in this code. My problem is solved.</p>\n\n<p>The same thing I am doing with UserForm in Excel. Now I have a <code>textbox1</code> for employee number and <code>textbox2</code> for employee name, the same is in <code>sheet2</code> with <code>ColumnA</code> and <code>ColumnB</code>. </p>\n\n<p>Now when I enter the employee number in <code>textbox1</code>, the name is appearing in <code>textbox2</code> and also a button to change the value of <code>textbox2</code>. </p>\n\n<p>I want to change the value of <code>textbox2</code> and when the button is clicked, go to that particular employees name field.  How can I do this?</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1438168682, "post_id": 31697918, "comment_id": 51336997, "body": "Do you set any manual page breaks or section breaks?"}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "reply_to_user": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1438168854, "post_id": 31697918, "comment_id": 51337110, "body": "A page in the system is defined as a range. e.g. range A1:K40 for page 1 and then a page break. for some pages it could be A1:K100 which takes up ~ two pages then a page break. so some pages do and some do not. I do not use any section breaks only page breaks"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1438168945, "post_id": 31697918, "comment_id": 51337165, "body": "Are you talking about Word pages now or Excel pages??"}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "reply_to_user": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1438169029, "post_id": 31697918, "comment_id": 51337214, "body": "in excel it does not have any page breaks etc ranges are entered into word and then after each range a page break is inserted into word"}], "answers": [{"comments": [{"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1438173649, "post_id": 31699342, "comment_id": 51340385, "body": "I get an error here oDoc.Range(startRan.End, startRan.End).Select on startRan.end says augment not optional? I commented that out and got errors on selection&#39;s but that was because I had to use oDoc.ActiveWindow.Selection.... I also had a third error whilst that line was comment out on the GOTO line which says type mismatch. There are no bookmarks in the document? does that matter?"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "reply_to_user": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1438174366, "post_id": 31699342, "comment_id": 51340924, "body": "I was just doing a quickie here. For you of course the <code>Selection</code>s should be <code>oWord.Selection</code> and <code>oWord.oDoc.Range(startRan.End, startRan.End).Select</code>"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "reply_to_user": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1438185614, "post_id": 31699342, "comment_id": 51349508, "body": "Oh, and of course <code>Dim startRan As Word.Range</code> instead of just <code>Range</code>."}], "tags": [], "owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "is_accepted": true, "score": 1, "last_activity_date": 1438169729, "creation_date": 1438169729, "answer_id": 31699342, "question_id": 31697918, "link": "https://stackoverflow.com/questions/31697918/word-vba-select-whole-document-minus-first-page/31699342#31699342", "title": "Word VBA, Select whole document minus first page", "body": "<p>The following code selects everything from the second page onward:</p>\n\n<pre><code>Dim startRan As Range\n\nSelection.HomeKey unit:=wdStory\nSet startRan = Selection.GoTo(What:=wdGoToBookmark, Name:=\"\\page\")\n\noDoc.Range(startRan.End, startRan.End).Select\nSelection.EndKey unit:=wdStory, Extend:=wdExtend\n</code></pre>\n"}], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1299, "favorite_count": 0, "accepted_answer_id": 31699342, "answer_count": 1, "score": 2, "last_activity_date": 1438169729, "creation_date": 1438165810, "question_id": 31697918, "link": "https://stackoverflow.com/questions/31697918/word-vba-select-whole-document-minus-first-page", "title": "Word VBA, Select whole document minus first page", "body": "<p>I know you can select the whole document like so</p>\n\n<pre><code>oWord.oDoc.ActiveWindow.Selection.WholeStory\n</code></pre>\n\n<p>What would be the syntax to select the whole document minus the first page?</p>\n\n<p>Context: Excel runs all the code and outputs ranges direct to word to build a report. Reports can be any number of pages and the amount of pages is not known. This code would run as the last piece so document would be built by this point.</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 251, "user_id": 2952272, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddba427864f6b4af98cf9c53367cda93?s=128&d=identicon&r=PG&f=1", "display_name": "user2952272", "link": "https://stackoverflow.com/users/2952272/user2952272"}, "edited": false, "score": 0, "creation_date": 1438165927, "post_id": 31697891, "comment_id": 51335262, "body": "It seems you are true because it happened the same in another text with an apostrophe, I will check out in a while. Thanks!"}], "tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": true, "score": 2, "last_activity_date": 1438165727, "creation_date": 1438165727, "answer_id": 31697891, "question_id": 31697860, "link": "https://stackoverflow.com/questions/31697860/access-vba-error-3075/31697891#31697891", "title": "Access VBA - Error &#39;3075&#39;", "body": "<p>Apostrophes probably cause problem.\nTry this:</p>\n\n<pre><code>strInsert = \"INSERT INTO Dbase (EB3_30) VALUES ('\" &amp; Replace(Me.EB3_30, \"'\", \"''\") &amp; \"')\"\n</code></pre>\n"}], "owner": {"reputation": 251, "user_id": 2952272, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddba427864f6b4af98cf9c53367cda93?s=128&d=identicon&r=PG&f=1", "display_name": "user2952272", "link": "https://stackoverflow.com/users/2952272/user2952272"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 814, "favorite_count": 0, "accepted_answer_id": 31697891, "answer_count": 1, "score": 1, "last_activity_date": 1438165727, "creation_date": 1438165636, "question_id": 31697860, "link": "https://stackoverflow.com/questions/31697860/access-vba-error-3075", "title": "Access VBA - Error &#39;3075&#39;", "body": "<p>I got this error everytime I try to save the text in this field to the database. The code is this:</p>\n\n<pre><code>Dim strInsert As String\nstrInsert = \"INSERT INTO Dbase (EB3_30) VALUES ('\" &amp; Me.EB3_30 &amp; \"')\"\nCurrentDb.Execute strInsert\n</code></pre>\n\n<p>The debugger stops at the last line and I get this error (I'm going to traduce it because it's in spanish):</p>\n\n<p><strong>run time error '3075':\nSyntax Error (Missing Operator) in query expression \"value of EB3_30\"</strong></p>\n\n<p>The value of <code>EB3_30</code> is a string of aproximate length 250. As it's in spanish some letters have accents. I also use dots, apostrophes and slashes. Maybe some of this characters cause problems? Any ideas?</p>\n"}, {"tags": ["vba", "types", "resources", "ms-project"], "answers": [{"tags": [], "owner": {"reputation": 167, "user_id": 5363723, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f5d2ed5edfdceded20322aba47eaf9eb?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm Farrelle", "link": "https://stackoverflow.com/users/5363723/malcolm-farrelle"}, "is_accepted": true, "score": 3, "last_activity_date": 1442930582, "last_edit_date": 1442930582, "creation_date": 1442930210, "answer_id": 32718869, "question_id": 31697778, "link": "https://stackoverflow.com/questions/31697778/ms-project-vba-changing-resource-type/32718869#32718869", "title": "MS Project - VBA - Changing resource type", "body": "<p>Is there some code you haven't included in your extract that associates NR with .Resources(k)?  It looks like you have created a new material resource and tried to set the resource type of some other existing resource to \"Material\".  Can you please include the with  . . . end with construct?</p>\n\n<p>Without seeing more of the problem I'm not completely sure what you are having trouble with but assuming you are referencing the ActiveProject all you need to do to create a new Material type resource is:</p>\n\n<pre><code>Set NR = Activeproject.Resources.Add (name := \"A New Resource\")\n\nNR.Type = pjResourceTypeMaterial\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5168902, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9cc7cced936333fbf110e51fbfbb82a?s=128&d=identicon&r=PG&f=1", "display_name": "Zanderset", "link": "https://stackoverflow.com/users/5168902/zanderset"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 493, "favorite_count": 0, "accepted_answer_id": 32718869, "answer_count": 1, "score": 0, "last_activity_date": 1593560025, "creation_date": 1438165463, "last_edit_date": 1593560025, "question_id": 31697778, "link": "https://stackoverflow.com/questions/31697778/ms-project-vba-changing-resource-type", "title": "MS Project - VBA - Changing resource type", "body": "<p>Sorry if the question has been answered but I looked a bit on the site and it has helped in many ways already !</p>\n\n<p>I was asked to do in VBA some programming to transfer data into MS Project.</p>\n\n<p>I managed to do it all except for one thing, when I create a resource, Project automatically describes it as a Work Type and some of mine are actually Material Type.</p>\n\n<p>I then thought of changing it after creating the resource and assign it to a task</p>\n\n<p>My bit of problematic code is the following</p>\n\n<pre><code>Set NR = .Resources.Add(name:=tmpTxt)\n.Resources(k).Type = pjResourceTypeMaterial\n.Resources(k).Assignments.Add TaskID:=j\n</code></pre>\n\n<p>When I run it I don't have any error message, but in the resource view on MS Project the Type hasn't changed...</p>\n\n<p>I would be very grateful if any of you can help me !</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 885, "user_id": 1676288, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00186351b531d40caafac61aeeb2946a?s=128&d=identicon&r=PG", "display_name": "Mark Butler", "link": "https://stackoverflow.com/users/1676288/mark-butler"}, "is_accepted": false, "score": 1, "last_activity_date": 1438166220, "last_edit_date": 1438166220, "creation_date": 1438165843, "answer_id": 31697930, "question_id": 31697629, "link": "https://stackoverflow.com/questions/31697629/reference-an-excel-sheet-from-another-workbook-without-copying-the-sheet/31697930#31697930", "title": "Reference an excel sheet from another workbook without copying the sheet", "body": "<pre><code>=SUM('C:\\test\\[test.xlsx]sheet_name'!A1:A25)\n</code></pre>\n\n<p>is an example of a formula which references sheet <code>sheet_name</code> in workbook <code>C:\\test\\text.xlsx</code>.</p>\n\n<p>Note that when the other workbook is opened, the formula automatically changes to </p>\n\n<pre><code>=SUM([test.xlsx]sheet_name!A1:A25)\n</code></pre>\n\n<p>and then when it is closed, the formula will change back.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 1991868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52f7e0e4afb7a78118bdb8b5826a01dc?s=128&d=identicon&r=PG", "display_name": "Harley Walsh", "link": "https://stackoverflow.com/users/1991868/harley-walsh"}, "edited": false, "score": 0, "creation_date": 1438166157, "post_id": 31698012, "comment_id": 51335410, "body": "Currently my code is declaring the worksheets at the start i.e  Data_sheet1 = worksheets(&quot;Data_sheet_2014&quot;)  Then later in the code i can say data_sheet1.range(....)  Would it be enough to just update the code here, or will i have to update every time it references one of these sheets?"}, {"owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "reply_to_user": {"reputation": 33, "user_id": 1991868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52f7e0e4afb7a78118bdb8b5826a01dc?s=128&d=identicon&r=PG", "display_name": "Harley Walsh", "link": "https://stackoverflow.com/users/1991868/harley-walsh"}, "edited": false, "score": 0, "creation_date": 1438166628, "post_id": 31698012, "comment_id": 51335711, "body": "Yes, it would be enough if you change declaration. Once you change it, variable <code>data_sheet1</code> will refer to this worksheet from other workbook."}], "tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": true, "score": 5, "last_activity_date": 1438166054, "creation_date": 1438166054, "answer_id": 31698012, "question_id": 31697629, "link": "https://stackoverflow.com/questions/31697629/reference-an-excel-sheet-from-another-workbook-without-copying-the-sheet/31698012#31698012", "title": "Reference an excel sheet from another workbook without copying the sheet", "body": "<p>Yes, it is possible.</p>\n\n<p>You need to add those lines to your code:</p>\n\n<pre><code>Dim wkb As Excel.Workbook\nDim wks As Excel.Worksheet\n\nSet wkb = Excel.Workbooks(\"name_of_workbook.xlsx\")\nSet wks = wkb.Worksheets(\"Example_1\")\n</code></pre>\n\n<p>Now, every time you want to refer to a range from this other workbook, you need to add <code>wks.</code> before, i.e.:</p>\n\n<pre><code>'Printing value in cell.\nwks.Range(\"A1\") = \"x\"\n\n'Selecting range.\ncall wks.Range(wks.Cells(1,1), wks.Cells(2,2)).Select\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 1991868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52f7e0e4afb7a78118bdb8b5826a01dc?s=128&d=identicon&r=PG", "display_name": "Harley Walsh", "link": "https://stackoverflow.com/users/1991868/harley-walsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59472, "favorite_count": 1, "accepted_answer_id": 31698012, "answer_count": 2, "score": 1, "last_activity_date": 1438166220, "creation_date": 1438165058, "question_id": 31697629, "link": "https://stackoverflow.com/questions/31697629/reference-an-excel-sheet-from-another-workbook-without-copying-the-sheet", "title": "Reference an excel sheet from another workbook without copying the sheet", "body": "<p>Im wondering if it's possible to reference an excel sheet from another work book without making a copy of that sheet?</p>\n\n<p>The situation : I have some very large worksheets filled with various data, but i don't want to keep a copy of them open in my workbooks because  while each workbook uses the same data source, they're slightly different. </p>\n\n<p>I have a vba routine that takes this data and creates input files for other codes, vba expects this data to be available on the defined sheet names.</p>\n\n<p>Is it possible to make either excel or vba to know that when i request worksheet(\"Example_1\") it instead knows that i mean example_1 from a different workbook?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "database-design"], "comments": [{"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1438173993, "post_id": 31697165, "comment_id": 51340648, "body": "I proposed a possibilty to speed up your code, but is this sufficient enough? Or do you also want to restructure your code anyway?"}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 5049860, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9d7ef4bdf9ca1bebc6fda6bdf9bcbe1e?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Garcia", "link": "https://stackoverflow.com/users/5049860/mario-garcia"}, "edited": false, "score": 0, "creation_date": 1438174436, "post_id": 31697402, "comment_id": 51340976, "body": "I already was using the &quot;ScreenUpdating=False&quot; piece of code, and with the other four it seems to go only marginally faster from a test I just finished (saved me 5 minutes). I don&#39;t particularly care if it needs a full reformat, I&#39;d just like to know if there&#39;s at least some other structure I could follow to make this more efficient/faster."}, {"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "reply_to_user": {"reputation": 151, "user_id": 5049860, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9d7ef4bdf9ca1bebc6fda6bdf9bcbe1e?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Garcia", "link": "https://stackoverflow.com/users/5049860/mario-garcia"}, "edited": false, "score": 0, "creation_date": 1438177362, "post_id": 31697402, "comment_id": 51343080, "body": "Could you also provide the <code>Indexrunner</code> and <code>Finder</code> code to the question? Currently I can only guess why it takes so long. In addition, a computers takes longer to compare string values than numbers. In this case I would replace <code>Cells(searchRow, &quot;B&quot;)</code> with <code>Cells(searchRow, 2)</code> the same with &quot;A&quot;"}], "tags": [], "owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "is_accepted": false, "score": 1, "last_activity_date": 1438164556, "creation_date": 1438164556, "answer_id": 31697402, "question_id": 31697165, "link": "https://stackoverflow.com/questions/31697165/find-a-generic-name/31697402#31697402", "title": "Find a generic Name", "body": "<p>For the beginning, if you want to speed up your code, you can use this code fragment:</p>\n\n<pre><code>Application.DisplayAlerts = False\nApplication.ScreenUpdating = False\nApplication.DisplayStatusBar = False\nApplication.EnableEvents = False\nApplication.Calculation = xlManual\n</code></pre>\n\n<p>Put it after your <code>Dim</code> section and at the end of the code put in the same fragment and change the values back to <code>true</code> respecitively <code>xlAutomatic</code></p>\n\n<pre><code>Application.DisplayAlerts = True\nApplication.ScreenUpdating = True\nApplication.DisplayStatusBar = True\nApplication.EnableEvents = True\nApplication.Calculation = xlAutomatic\n</code></pre>\n\n<p>In my case it increased the speed of the code. I don't know how the performance changes if you skip the <code>DisplayAlerts</code> line in order to show alerts in case there are some.</p>\n\n<p>If you also want to restructure your code it will take a bit more time.</p>\n"}], "owner": {"reputation": 151, "user_id": 5049860, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9d7ef4bdf9ca1bebc6fda6bdf9bcbe1e?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Garcia", "link": "https://stackoverflow.com/users/5049860/mario-garcia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438164556, "creation_date": 1438163942, "question_id": 31697165, "link": "https://stackoverflow.com/questions/31697165/find-a-generic-name", "title": "Find a generic Name", "body": "<p>I have a bit of a problem regarding a large database with many different names for the same company. Basically, what I have to do is find all the names representing Company X and change them to \"X\".</p>\n\n<p>This way, if the detailed name is \"X SL\" or \"Shipment Regarder ASL\" or \"oubiyubib(2)\" and we know that all three represent company \"X\", I'd have to look for them and change them by hand. There's also something called \"NISA\" that's meant to represent the sector the company is in, since sometimes the one that comes in the files I'm to process are wrong.</p>\n\n<p>To solve this, I created an excel that stores all known names for the various companies and then replaces the names on the list accordingly. The structure of the stored data goes like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/QDSww.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QDSww.jpg\" alt=\"Captura\"></a>\nSo in the first column there's the \"NISA\" and the second one has the generic name for the company, while on the columns following that are the known names for the company. The whole name lists are alphabetized by the column with a \"1\".</p>\n\n<p>Then, there's \"INDICE\" which details the row where the first instance with the three letter combination appears. This way, the first name starting with \"3SU\" is in row 28. \"INDICIE 2\" is to detail the first letter in \"INDICE\", so an index of an index. Meaning that the first row in \"INDICE\" starting with an \"A\" would be in row 39.</p>\n\n<p>The main reason for all this is because the database quickly grew to contain over 25K rows and over a hundred columns in some instances, and because sometimes \"3MSA\" is an entirely different company than \"3MSL\", the thing has to go word for word checking over which it'd be its appropriate generic name.</p>\n\n<p>So the bulk of the code goes like this:</p>\n\n<pre><code>Dim listRow As Long, searchRow As Long\nDim searchedName As String, genericName As String\nDim problem As Boolean\nproblem = False\nlistRow = 2\nsearchRow = 2\nsearchedName = \"\"\ngenericName = \"\"\n\nDo While Cells(listRow, colmnNames) &lt;&gt; \"\"\n    searchedName = UCase(Cells(listRow, colmnNames))\n    searchRow = 0\n    'This part compares if it's looking again for the same name. If it is, it'll just copy the previous results\n    If Cells(listRow, colmnNames) = Cells(listRow - 1, colmnNames) Then\n        Cells(listRow, colmnResults) = Cells(listRow - 1, colmnResults)\n        Cells(listRow, colmnRestNisa) = Cells(listRow - 1, colmnRestNisa)\n        Cells(listRow, errorsA) = Cells(listRow - 1, errorsA)\n        Cells(listRow, errorsB) = Cells(listRow - 1, errorsB)\n    Else\n        Cells(listRow, colmnNames).Select\n        searchRow = IndexRunner(searchedName) '\" IndexRunner \" will return the row it will have to start looking, if it's 0 then it means the starting letter combination doesn't exist\n        If searchRow &gt; 0 Then\n            searchRow = Finder(searchRow, searchedName) '\"Finder\" will traverse the database row by row, running the columns until it reaches a blank comparing name by name until it finds a match. If it gets outside the starting 3 letter combination, it stops and returns 0, otherwise, it'll return the row where it found the match\n            If searchRow &gt; 0 Then\n                Cells(listRow, colmnResults) = Cells(searchRow, \"B\")\n                Cells(listRow, colmnRestNisa) = Cells(searchRow, \"A\")\n            Else\n                GoTo NotFound\n            End If\n        Else\nNotFound: \n\n            Cells(listRow, colmnResults) = searchedName\n            Cells(listRow, colmnRestNisa) = Cells(listRow, colmnSectores)\n            Cells(listRow, errorsA) = searchedName\n            Cells(listRow, errorsB) = Cells(listRow, colmnSectores)\n            Cells(listRow, erroresC) = \"Not Found\"\n            problem = True 'This is so there'll be a popup at the end of the loop.\n        End If\n    End If\n    listRow = listRow + 1\nLoop\n</code></pre>\n\n<p>Because the code centers around the \"Only go at it while the first three letters of the name match\", I've been able to considerably cut down processing time, but it can still take nearly an hour to go through a 50K long name list, so at this point I'm wondering if there's any way to either make this go at it faster in VBA or just some other way to structure all this out.</p>\n\n<p>NOTE: I don't have access to other software and where I work at they have strict \"NOT ALLOWED\" rules to add anything to the computers, so I'm stuck with excel VBA until someone up above gets a hint.</p>\n"}, {"tags": ["vba", "excel", "union", "unpivot"], "comments": [{"owner": {"reputation": 5254, "user_id": 24447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da74b7df5db7590fc140329c62b3e498?s=128&d=identicon&r=PG", "display_name": "nekomatic", "link": "https://stackoverflow.com/users/24447/nekomatic"}, "edited": false, "score": 0, "creation_date": 1438162607, "post_id": 31696536, "comment_id": 51333095, "body": "Can you give an example of the source data and what you want the result to be?"}, {"owner": {"reputation": 41, "user_id": 5168683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf8d6f1829a8494f71086466e051303f?s=128&d=identicon&r=PG&f=1", "display_name": "Stan", "link": "https://stackoverflow.com/users/5168683/stan"}, "reply_to_user": {"reputation": 5254, "user_id": 24447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da74b7df5db7590fc140329c62b3e498?s=128&d=identicon&r=PG", "display_name": "nekomatic", "link": "https://stackoverflow.com/users/24447/nekomatic"}, "edited": false, "score": 0, "creation_date": 1438163019, "post_id": 31696536, "comment_id": 51333355, "body": "I have 12 sheets, each contains number IDs of projects in a column.   I would like to have a separate sheet which would create a column with the union of all the individual project ID columns from the separate sheets (possibly in ascending order). Thank you!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1438164365, "post_id": 31696536, "comment_id": 51334192, "body": "The <a href=\"https://msdn.microsoft.com/en-us/library/office/aa213609(v=office.11).aspx\" rel=\"nofollow noreferrer\">Union method</a> isn&#39;t going to aggregate different ranges from different worksheets. You need to loop through the worksheets and collect the column data to a centralized location then de-dupe and sort."}, {"owner": {"reputation": 5254, "user_id": 24447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da74b7df5db7590fc140329c62b3e498?s=128&d=identicon&r=PG", "display_name": "nekomatic", "link": "https://stackoverflow.com/users/24447/nekomatic"}, "edited": false, "score": 0, "creation_date": 1438167076, "post_id": 31696536, "comment_id": 51335972, "body": "I think your options are either a) to write a VBA macro that copies and pastes the appropriate number of cells from each source sheet to a single column on the destination sheet, then sorts and removes duplicates from that column, or b) to define each source range as an Excel table, then use MS Query via the Get External Data command and hand-write an SQL query using <code>SELECT DISTINCT</code>, <code>UNION</code> and <code>ORDER BY</code> to return the data you want."}], "answers": [{"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 1, "last_activity_date": 1438167511, "last_edit_date": 1495542217, "creation_date": 1438167511, "answer_id": 31698541, "question_id": 31696536, "link": "https://stackoverflow.com/questions/31696536/union-of-multiple-columns-as-one-column/31698541#31698541", "title": "Union of multiple columns as one column", "body": "<p>I think can be achieved with <a href=\"https://stackoverflow.com/questions/20541905/convert-matrix-to-3-column-table-reverse-pivot-unpivot-flatten-normal/20543651#20543651\">multiple consolidation ranges</a> for a PivotTable. Would need labels for the columns and more than one column per sheet (could clone the existing ones). Should sort and remove duplicates from the list automatically (if cloned).</p>\n"}, {"tags": [], "owner": {"reputation": 1742, "user_id": 9463489, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jblood94", "link": "https://stackoverflow.com/users/9463489/jblood94"}, "is_accepted": false, "score": 0, "last_activity_date": 1525270710, "last_edit_date": 1525270710, "creation_date": 1524848603, "answer_id": 50067166, "question_id": 31696536, "link": "https://stackoverflow.com/questions/31696536/union-of-multiple-columns-as-one-column/50067166#50067166", "title": "Union of multiple columns as one column", "body": "<p>I'll assume your IDs are all numeric (otherwise, sorting would be very tricky if not impossible without VBA). You could modify the following array formula to meet your needs (select an area with enough rows to hold the full stack of IDs, enter the formula, then commit the formula with <kbd>ctrl</kbd>+<kbd>shift</kbd>+<kbd>enter</kbd>):</p>\n\n<pre><code>{=TRANSPOSE(SMALL(IFERROR(CHOOSE(COLUMN(1:12),Sheet1!A1:A73,Sheet2!A1:A70,Sheet3!A1:A79,Sheet4!A1:A58,Sheet5!A1:A51,Sheet6!A1:A94,Sheet7!A1:A50,Sheet8!A1:A89,Sheet9!A1:A75,Sheet10!A1:A89,Sheet11!A1:A70,Sheet12!A1:A94),FALSE),(COLUMN(INDIRECT(\"1:\"&amp;COUNT(Sheet1!A1:A73,Sheet2!A1:A70,Sheet3!A1:A79,Sheet4!A1:A58,Sheet5!A1:A51,Sheet6!A1:A94,Sheet7!A1:A50,Sheet8!A1:A89,Sheet9!A1:A75,Sheet10!A1:A89,Sheet11!A1:A70,Sheet12!A1:A94))))))}\n</code></pre>\n\n<p>I'll use a smaller version (2 columns) to explain how it works:</p>\n\n<pre><code>{=TRANSPOSE(SMALL(IFERROR(CHOOSE(COLUMN(1:2),A1:A73,C1:C70),FALSE),(COLUMN(1:143))))\n</code></pre>\n\n<p>First, <code>COLUMN(OFFSET($A$1,0,0,,2))</code> returns a horizontal array of integers between 1 and 2. Passing this to the CHOOSE function with the two single-column ranges creates a single 73 x 2 array from both <code>A1:A73</code> and <code>C1:C70</code> (instead of creating a jagged array, the last three values of the second column will be filled in with <code>#NA</code>).</p>\n\n<p>Wrap the result with <code>IFERROR</code> to convert the three <code>#NA</code> values to <code>FALSE</code> (otherwise, <code>SMALL</code> will return an error).</p>\n\n<p>Next, <code>COLUMN(1:2)</code> returns a horizontal array of integers between 1 and 143. Passing the 73 x 2 array and the array of integers between 1 and 143 to small will return a single 1 x 143 array (horizontal) of the sorted values, which you then transpose to return the vertical array as the output.</p>\n"}], "owner": {"reputation": 41, "user_id": 5168683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf8d6f1829a8494f71086466e051303f?s=128&d=identicon&r=PG&f=1", "display_name": "Stan", "link": "https://stackoverflow.com/users/5168683/stan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7177, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1525270710, "creation_date": 1438162369, "last_edit_date": 1448544717, "question_id": 31696536, "link": "https://stackoverflow.com/questions/31696536/union-of-multiple-columns-as-one-column", "title": "Union of multiple columns as one column", "body": "<p>Could you please advise what would be the best way to create a union column for 12 separate columns (located in 12 different Excel sheets within a workbook) with or without VBA? </p>\n\n<p>There are good manuals how to do it for two columns without VBA (using MATCH function) however I am not sure how to approach the case with multiple columns.</p>\n"}, {"tags": ["vba", "excel", "search"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1438162851, "post_id": 31696465, "comment_id": 51333263, "body": "You could use an If statement with two times an INSTR. For info on INSTR see <a href=\"http://www.techonthenet.com/excel/formulas/instr.php\" rel=\"nofollow noreferrer\">techonthenet.com/excel/formulas/instr.php</a> Combine criteria within your ifstatement with the word And."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1438162889, "post_id": 31696465, "comment_id": 51333285, "body": "And ofcourse nest that in a For loop in which you loop over all rows."}], "answers": [{"tags": [], "owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "is_accepted": false, "score": 0, "last_activity_date": 1438162998, "creation_date": 1438162998, "answer_id": 31696783, "question_id": 31696465, "link": "https://stackoverflow.com/questions/31696465/find-row-with-multiple-search-criteria-on-substrings-in-vba/31696783#31696783", "title": "Find row with multiple search criteria on substrings in VBA", "body": "<p><a href=\"http://www.mrexcel.com/forum/excel-questions/74933-matching-multiple-criteria-visual-basic-applications.html\" rel=\"nofollow\">http://www.mrexcel.com/forum/excel-questions/74933-matching-multiple-criteria-visual-basic-applications.html</a> This is what you are looking for with your MATCH function.</p>\n"}, {"tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1438163268, "creation_date": 1438163268, "answer_id": 31696886, "question_id": 31696465, "link": "https://stackoverflow.com/questions/31696465/find-row-with-multiple-search-criteria-on-substrings-in-vba/31696886#31696886", "title": "Find row with multiple search criteria on substrings in VBA", "body": "<p>The below will assign all values within column B to an array, and then assess each element of the array to see if it contains the strings \"Cows\" and \"excrement\".</p>\n\n<p>To assess the string within the element, we use the <a href=\"https://msdn.microsoft.com/en-us/library/8460tsh1(v=vs.90).aspx\" rel=\"nofollow\"><code>InStr()</code> Function</a>.</p>\n\n<pre><code>Sub findStrings()\n    Dim wb As Workbook, ws As Worksheet\n    Dim arrValues() As Variant\n    Dim lrow As Long, i As Long\n\n    Set wb = ThisWorkbook\n    Set ws = wb.Sheets(1)\n    lrow = ws.Cells(Rows.Count, 2).End(xlUp).Row\n\n    arrValues = Range(Cells(1, 2), Cells(lrow, 2))\n\n    For i = 1 To UBound(arrValues, 1)\n        If InStr(1, arrValues(i, 1), \"Cows\") Then\n            If InStr(1, arrValues(i, 1), \"excrement\") Then\n                MsgBox (\"Cell \" &amp; Cells(i, 2).Address &amp; \" contains both strings.\")\n                Exit Sub\n            End If\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>This will only find 1 match containing the strings you specify, if you require further matches then you will need a different solution.</p>\n"}, {"tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": false, "score": 0, "last_activity_date": 1438163897, "creation_date": 1438163897, "answer_id": 31697150, "question_id": 31696465, "link": "https://stackoverflow.com/questions/31696465/find-row-with-multiple-search-criteria-on-substrings-in-vba/31697150#31697150", "title": "Find row with multiple search criteria on substrings in VBA", "body": "<p>This function returns range that contains all the cells having in its content both words given as parameters:</p>\n\n<pre><code>Public Function findCellsWithWords(firstWord As String, secondWord As String) As Excel.Range\n    Dim wks As Excel.Worksheet\n    Dim rng As Excel.Range\n    Dim rngFirst As Excel.Range\n    Dim rngSecond As Excel.Range\n    '--------------------------------------------------\n\n\n    Set wks = Excel.ActiveSheet\n    Set rng = wks.Columns(2).EntireColumn\n\n    Set rngFirst = findAll(rng, firstWord)\n    Set rngSecond = findAll(rng, secondWord)\n\n\n    Set findCellsWithWords = Excel.Intersect(rngFirst, rngSecond)\n\n\nEnd Function\n\n\nPublic Function findAll(rng As Excel.Range, what As Variant) As Excel.Range\n    Dim rngResult As Excel.Range\n    Dim found As Excel.Range\n    Dim firstFound As String\n    '----------------------------------------------------------------------------\n\n    With rng\n\n        Set found = rng.Find(what)\n\n\n        Do Until found Is Nothing\n\n            If rngResult Is Nothing Then\n                firstFound = found.Address\n                Set rngResult = found\n            Else\n                Set rngResult = Excel.Union(rngResult, found)\n            End If\n\n\n            'Find next occurrence.\n            Set found = .FindNext(found)\n            If found.Address = firstFound Then Exit Do\n\n        Loop\n\n    End With\n\n\n    Set findAll = rngResult\n\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1336, "user_id": 2171063, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/ae861ef9ae66a6159dd8d5051b35e9c0?s=128&d=identicon&r=PG", "display_name": "Mads Gadeberg", "link": "https://stackoverflow.com/users/2171063/mads-gadeberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2916, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1438163897, "creation_date": 1438162205, "last_edit_date": 1438163212, "question_id": 31696465, "link": "https://stackoverflow.com/questions/31696465/find-row-with-multiple-search-criteria-on-substrings-in-vba", "title": "Find row with multiple search criteria on substrings in VBA", "body": "<p>I need to find the row where a cell in column <code>B</code> contains two substrings.</p>\n\n<p>For example these Strings in <code>B1:B3</code></p>\n\n<pre><code>A string with Cows\nCows and stuff\nA string with Chickens\n</code></pre>\n\n<p>I need to find the row <code>B2</code>where the 2 substrings <code>Cows</code> and <code>shit</code> are present.</p>\n\n<p>What i tried so far:</p>\n\n<ol>\n<li>Find formula that doesent do multiple search criteria. :(</li>\n<li><code>=MATCH(1;INDEX((B:B=\"Cows\")*(B:B=\"shit\"););)</code> that doesent do substrings</li>\n<li>A lot other stuff i forgot,</li>\n</ol>\n\n<p>If it is possible i would like a pure VBA solution.</p>\n\n<p>Any ideas on this one?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 169, "user_id": 5092236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c9dea858559fb747eafd9f9896cd470?s=128&d=identicon&r=PG&f=1", "display_name": "Poof", "link": "https://stackoverflow.com/users/5092236/poof"}, "edited": false, "score": 1, "creation_date": 1438161665, "post_id": 31696064, "comment_id": 51332462, "body": "are they always separated by / or some other character?"}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1438162176, "post_id": 31696064, "comment_id": 51332815, "body": "Are these stored in A1,A2,A3 etc or ? I think example input/desired output is required"}], "answers": [{"tags": [], "owner": {"reputation": 337, "user_id": 2633917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70dab48765edce297426afda59e733a3?s=128&d=identicon&r=PG", "display_name": "tobifasc", "link": "https://stackoverflow.com/users/2633917/tobifasc"}, "is_accepted": false, "score": 0, "last_activity_date": 1438161858, "creation_date": 1438161858, "answer_id": 31696347, "question_id": 31696064, "link": "https://stackoverflow.com/questions/31696064/excel-vba-only-add-numbers-to-variant-string/31696347#31696347", "title": "Excel VBA Only Add Numbers to Variant/string", "body": "<p>Let's say your raw string is stored in the variable \"s\".</p>\n\n<pre><code>Dim i As Integer\nDim result As String\n\nresult = \"\"\nFor i = 1 To Len(s)\n    If Mid(s, i, 1) &gt;= \"0\" And Mid(s, i, 1) &lt;= \"9\" Then\n        result = result + Mid(s, i, 1)\n    End If\nNext\n</code></pre>\n\n<p>Now only the digits are stored in the string variable \"result\".\nYou can then check if Len of result is 4 or less.</p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 5037973, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153559829050329/picture?type=large", "display_name": "Jamie K Fletcher", "link": "https://stackoverflow.com/users/5037973/jamie-k-fletcher"}, "edited": false, "score": 0, "creation_date": 1438185084, "post_id": 31700171, "comment_id": 51349168, "body": "Run Flow Error &#39;6&#39; - Overflow on intReturn = strBuild"}, {"owner": {"reputation": 278, "user_id": 4241027, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2084e9b79806ca77546b74c067e15f33?s=128&d=identicon&r=PG", "display_name": "Shaun Vermaak", "link": "https://stackoverflow.com/users/4241027/shaun-vermaak"}, "reply_to_user": {"reputation": 9, "user_id": 5037973, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153559829050329/picture?type=large", "display_name": "Jamie K Fletcher", "link": "https://stackoverflow.com/users/5037973/jamie-k-fletcher"}, "edited": false, "score": 0, "creation_date": 1438199393, "post_id": 31700171, "comment_id": 51357666, "body": "Fixed. Number too large for integer"}, {"owner": {"reputation": 9, "user_id": 5037973, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153559829050329/picture?type=large", "display_name": "Jamie K Fletcher", "link": "https://stackoverflow.com/users/5037973/jamie-k-fletcher"}, "edited": false, "score": 0, "creation_date": 1438616404, "post_id": 31700171, "comment_id": 51510800, "body": "Lovely, that&#39;s sorted it thanks with a couple of minor tweaks."}], "tags": [], "owner": {"reputation": 278, "user_id": 4241027, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2084e9b79806ca77546b74c067e15f33?s=128&d=identicon&r=PG", "display_name": "Shaun Vermaak", "link": "https://stackoverflow.com/users/4241027/shaun-vermaak"}, "is_accepted": false, "score": 0, "last_activity_date": 1438199315, "last_edit_date": 1438199315, "creation_date": 1438172217, "answer_id": 31700171, "question_id": 31696064, "link": "https://stackoverflow.com/questions/31696064/excel-vba-only-add-numbers-to-variant-string/31700171#31700171", "title": "Excel VBA Only Add Numbers to Variant/string", "body": "<pre><code>Dim someText As String\n\nsomeText = \"WD/99999999\"\nsomeText = GetNumber(someText)\n\nIf Len(someText) &lt;= 4 Then\n    someText = \"*\" &amp; someText\nEnd If\n</code></pre>\n\n<p>And function</p>\n\n<pre><code>Function GetNumber(strText)\n    Dim strBuild As String\n\n    For i = 1 To Len(strText)\n        If IsNumeric(Mid(strText, i, 1)) Then\n            strBuild = strBuild &amp; Mid(strText, i, 1)\n        End If\n    Next\n\n    GetNumber = strBuild\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 5037973, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153559829050329/picture?type=large", "display_name": "Jamie K Fletcher", "link": "https://stackoverflow.com/users/5037973/jamie-k-fletcher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 264, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1438199315, "creation_date": 1438161105, "question_id": 31696064, "link": "https://stackoverflow.com/questions/31696064/excel-vba-only-add-numbers-to-variant-string", "title": "Excel VBA Only Add Numbers to Variant/string", "body": "<p>Can see similar questions to mine but not close enough so, here goes:</p>\n\n<p>I need to add the contents of a cell to a string or variant but to strip off any letters or characters but cannot interfere with the contents of the cell.</p>\n\n<p>A typical example of what the cell might contain is WD/99999999 but I only need the 99999999. However, the length of the number might vary and the letters and characters it might be proceeded by might vary but will always be letters or characters.</p>\n\n<p>Once this has been achieved, I need to check if the number is 4 digits or less and if so add a \"*\" to the front.</p>\n\n<p>Thanks in advance, all help received so far in this project is much appreciated!</p>\n\n<p>Jamie</p>\n"}, {"tags": ["vba", "page-break"], "comments": [{"owner": {"reputation": 514, "user_id": 2102895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OAvoQ.jpg?s=128&g=1", "display_name": "Eddy", "link": "https://stackoverflow.com/users/2102895/eddy"}, "edited": false, "score": 0, "creation_date": 1438161362, "post_id": 31696041, "comment_id": 51332224, "body": "It might be helpful if we knew what was in your columns, particularly where the things you&#39;re searching for are. Was the vertical pagebreak on column D already there before you ran the script? i.e. are the cells too wide for your print area?"}, {"owner": {"reputation": 105, "user_id": 5093451, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c274f79ce13c1a76c2654d33d5abb883?s=128&d=identicon&r=PG&f=1", "display_name": "Becky", "link": "https://stackoverflow.com/users/5093451/becky"}, "reply_to_user": {"reputation": 514, "user_id": 2102895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OAvoQ.jpg?s=128&g=1", "display_name": "Eddy", "link": "https://stackoverflow.com/users/2102895/eddy"}, "edited": false, "score": 0, "creation_date": 1438244427, "post_id": 31696041, "comment_id": 51374169, "body": "Yes I think they are so I need it to resize the print area, rather than just add in extra page breaks."}], "owner": {"reputation": 105, "user_id": 5093451, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c274f79ce13c1a76c2654d33d5abb883?s=128&d=identicon&r=PG&f=1", "display_name": "Becky", "link": "https://stackoverflow.com/users/5093451/becky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 998, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1438161035, "creation_date": 1438161035, "question_id": 31696041, "link": "https://stackoverflow.com/questions/31696041/vba-vertical-page-breaks", "title": "VBA Vertical Page Breaks", "body": "<p>I am trying to set the page breaks on my vba code.  I've got the horizontal page breaks to work on a conditional basis.  Now I need to add a vertical page break on column F (So include Column F, but nothing else to the right of that).</p>\n\n<pre><code>Statement.Activate\nActiveSheet.ResetAllPageBreaks\n\nDim c As Range\nDim FirstAddress As String\n\nSet c = Columns(\"A\").Find(What:=\"Please enter Dept. 42 and your Client Ref on the reverse\", LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=True)\n\nIf Not c Is Nothing Then\nFirstAddress = c.Address\n\nDo\nActiveWindow.SelectedSheets.HPageBreaks.Add Before:=c.Offset(1)\nSet c = Columns(\"A\").FindNext(c)\nLoop While Not c Is Nothing And c.Address &lt;&gt; FirstAddress\nActiveSheet.VPageBreaks.Add Before:=Range(\"H1\")\nEnd If\n</code></pre>\n\n<p>As I said, the horizontal ones work, but I get an extra vertical one in column D as well as Column F, which I don't need and I don't seem to be able to get rid of it.  Any idea?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 3559552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/179c203680c4f3b99729ebc0cb29ca6f?s=128&d=identicon&r=PG&f=1", "display_name": "PootyToot", "link": "https://stackoverflow.com/users/3559552/pootytoot"}, "edited": false, "score": 1, "creation_date": 1438162141, "post_id": 31696215, "comment_id": 51332788, "body": "Thank you, I now understand that part, but I would have thought the forms should have been unloaded in the Formclose() subroutine where objloop looks for active userforms and unloads them"}], "tags": [], "owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "is_accepted": false, "score": 1, "last_activity_date": 1438161487, "creation_date": 1438161487, "answer_id": 31696215, "question_id": 31695592, "link": "https://stackoverflow.com/questions/31695592/cant-use-mousewheel-scroll-on-a-worksheet-after-running-a-macro/31696215#31696215", "title": "Can&#39;t use Mousewheel scroll on a Worksheet after running a Macro", "body": "<p>If you want to scroll while the userform is active you must display it modelessly. From the Excel Help file:</p>\n\n<p>\"When a UserForm is modal, the user must respond before using any other part of the application.\"</p>\n"}], "owner": {"reputation": 319, "user_id": 3559552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/179c203680c4f3b99729ebc0cb29ca6f?s=128&d=identicon&r=PG&f=1", "display_name": "PootyToot", "link": "https://stackoverflow.com/users/3559552/pootytoot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2391, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438161487, "creation_date": 1438159762, "last_edit_date": 1438160492, "question_id": 31695592, "link": "https://stackoverflow.com/questions/31695592/cant-use-mousewheel-scroll-on-a-worksheet-after-running-a-macro", "title": "Can&#39;t use Mousewheel scroll on a Worksheet after running a Macro", "body": "<p>I created an interview questoinaire using VBA which automatically generates a list of interview questions based on criteria selected.</p>\n\n<p>The selection and list of questions are all done via userforms and a listbox, the VBA behind it eventually generates a worksheet based off a hidden template which I have stored as very hidden.</p>\n\n<p>At the end of the script when it generates the template out of a new workbook, it works out fine but I noticed I cannot scroll through the workbook properly as my mouse wheel is disabled.  The manual solution is to hit the STOP button on the VBA code, but I don't understand what is causing this hiccup to occur in the first place.  </p>\n\n<p>The code which generates the form is below, has anybody come across this problem before where workbooks stop responding, or the mouse wheel stops unless the stop button in the VBA window is clicked?</p>\n\n<p>Code</p>\n\n<pre><code>Sub PopulateForm()\nDim WB As Workbook\nDim WS As Worksheet, ws2 As Worksheet, ws3 As Worksheet, WS4 As Worksheet\nDim newbook As Workbook\n\nDoEvents\n\nSet WB = ThisWorkbook\nSet WS = WB.Worksheets(\"Interview Questions\")\nSet ws3 = WB.Worksheets(\"Config\")\nSet WS4 = WB.Worksheets(\"Questions\")\n\n\nIf WS.Visible = xlSheetHidden Or WS.Visible = xlSheetVeryHidden Then\nWS.Visible = xlSheetVisible\nEnd If\n\nIf ws3.Visible = xlSheetVisible Then\nws3.Visible = xlSheetHidden\nEnd If\n\nIf WS4.Visible = xlSheetVisible Then\nWS4.Visible = xlSheetHidden\nEnd If\n\nSet newbook = Workbooks.Add\nWS.Copy Before:=newbook.Sheets(1)\n\nnewbook.Sheets(\"Sheet1\").Delete\n\nnewbook.Sheets(1).Cells(103, 3).Copy\nnewbook.Sheets(1).Cells(103, 3).PasteSpecial (xlPasteValues)\n\nnewbook.Sheets(1).Cells(110, 3).Copy\nnewbook.Sheets(1).Cells(110, 3).PasteSpecial (xlPasteValues)\n\nnewbook.Sheets(1).Cells(117, 3).Copy\nnewbook.Sheets(1).Cells(117, 3).PasteSpecial (xlPasteValues)\n\nnewbook.Sheets(1).Cells(124, 3).Copy\nnewbook.Sheets(1).Cells(124, 3).PasteSpecial (xlPasteValues)\n\nnewbook.Sheets(1).Cells(131, 3).Copy\nnewbook.Sheets(1).Cells(131, 3).PasteSpecial (xlPasteValues)\n\nnewbook.Sheets(1).Cells(138, 3).Copy\nnewbook.Sheets(1).Cells(138, 3).PasteSpecial (xlPasteValues)\n\n\nCall CleanUp.FormClose\n\n\nnewbook.Activate - **Mouse wheel stops here**\nEnd Sub\n\n\n\nSub FormClose()\n'Declare Variables\nDim WB1 As Workbook\nDim Config As Worksheet, Questions As Worksheet, Generator As Worksheet\nDim objLoop As Object\n\n'Set Objects to Variables\nSet WB1 = ThisWorkbook\nSet Config = WB1.Worksheets(\"Config\")\nSet Questions = WB1.Worksheets(\"Questions\")\nSet Generator = WB1.Worksheets(\"Interview Question Generator\")\nSet InterviewQuestions = WB1.Worksheets(\"Interview Questions\")\n\n'Make configuration sheets very hidden\nIf Config.Visible = xlSheetVisible Then\n   Config.Visible = xlSheetVeryHidden\nEnd If\n\nIf Questions.Visible = xlSheetVisible Then\n   Questions.Visible = xlSheetVeryHidden\nEnd If\n\nIf InterviewQuestions.Visible = xlSheetVisible Then\n   InterviewQuestions.Visible = xlSheetVeryHidden\nEnd If\n\nFor Each objLoop In VBA.UserForms\n    If TypeOf objLoop Is UserForm Then\n       Unload objLoop\n    End If\nNext objLoop\n\nApplication.ScreenUpdating = True\n\nDoEvents\n\nGenerator.Activate\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "web", "login"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1438161052, "post_id": 31695446, "comment_id": 51332017, "body": "Is that Sheet1&#39;s <code>Worksheet_Change</code>? You&#39;re doing a lot of work with no <code>Application.EnableEvents = False</code>. The event macro is almost sure to try and run on top of itself."}], "answers": [{"comments": [{"owner": {"reputation": 18, "user_id": 4407218, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YSlAIZxnkQo/AAAAAAAAAAI/AAAAAAAAAFU/QXKODfGZCIU/photo.jpg?sz=128", "display_name": "Jonathan Lim", "link": "https://stackoverflow.com/users/4407218/jonathan-lim"}, "edited": false, "score": 0, "creation_date": 1438186334, "post_id": 31696915, "comment_id": 51349965, "body": "This worked perfectly! I can&#39;t stress how much this makes my life easier. Thanks!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1438163343, "creation_date": 1438163343, "answer_id": 31696915, "question_id": 31695446, "link": "https://stackoverflow.com/questions/31695446/getting-a-table-using-excel-vba-behiind-a-username-and-login/31696915#31696915", "title": "Getting a Table using Excel VBA behiind a username and login", "body": "<p>First off, I would suggest that you get out of the <code>Worksheet_Change</code> event macro as soon as possible. All kinds of things can go wrong while you are stuck there processing a length routine and launching an InternetExplorer object to scrape web data is one of the slowest.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim KeyCells As Range\n\n    Set KeyCells = Range(\"H1\")\n    If Not Application.Intersect(KeyCells, Target) Is Nothing Then\n        On Error GoTo bm_Safe_Exit\n        Application.EnableEvents = False\n\n        Worksheets(\"Sheet1\").Cells.Clear\n        'if this is Sheet1's Worksheet_Change then the following\n        'would be more succinct and acknowledges that we are in Sheet1's bailywick\n        'Me.Cells.Clear\n\n        'Range(\"A1\").Select try to work without .Select\n\n        'allow 1 second to get out of the Worksheet_Change\n        Application.OnTime Now + TimeSerial(0, 0, 1), \"process_Web_Data\"\n\n    End If\nbm_Safe_Exit:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>So all that does is trap and evaluate the event. If H1 is involved, it clears Sheet1 and launches a public sub (stored in a Module sheet) and gets out of Dodge. The sub launch is a scant second after being scheduled and that should be more than enough time to exit the event macro.</p>\n\n<p>In a module sheet:</p>\n\n<blockquote>\n  <p>I added Microsoft HTML Object library and Microsoft Internet controls to the VBE's Tools \u25ba References for the following code.</p>\n</blockquote>\n\n<pre><code>Sub process_Web_Data()\n    Dim ie As New SHDocVw.InternetExplorer\n    With ie\n        .Visible = True\n        .navigate \"https://www.gurufocus.com/forum/login.php?0\"\n\n        While .Busy Or .readyState &lt;&gt; 4: DoEvents: Wend\n\n        With .document\n            .getelementbyid(\"txt-username\").Value = \"Username\"\n            .getelementbyid(\"txt-password\").Value = \"Password\"\n            .getelementbyid(\"login_form\").submit\n        End With\n\n        While .Busy Or .readyState &lt;&gt; 4: DoEvents: Wend\n        Debug.Print .LocationURL\n\n        '-----------------\n        'do all of your other stuff here\n        '-----------------\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>That is sufficient to get the log in page's <em>'That Email/username/password was not found or is inactive. Please try again.'</em> screen so the login process is working; just not the credentials.</p>\n\n<p>As far as referencing Sheet1 from that public sub, the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837552.aspx\" rel=\"nofollow\">Worksheet.CodeName property</a>, <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196974.aspx\" rel=\"nofollow\">Worksheet.Name property</a> or <a href=\"https://msdn.microsoft.com/en-us/library/office/ff836415.aspx\" rel=\"nofollow\">Worksheet.Index property</a> could be used. I would probably opt for the codename.</p>\n"}], "owner": {"reputation": 18, "user_id": 4407218, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YSlAIZxnkQo/AAAAAAAAAAI/AAAAAAAAAFU/QXKODfGZCIU/photo.jpg?sz=128", "display_name": "Jonathan Lim", "link": "https://stackoverflow.com/users/4407218/jonathan-lim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 438, "favorite_count": 0, "accepted_answer_id": 31696915, "answer_count": 1, "score": 0, "last_activity_date": 1438163343, "creation_date": 1438159309, "last_edit_date": 1438160467, "question_id": 31695446, "link": "https://stackoverflow.com/questions/31695446/getting-a-table-using-excel-vba-behiind-a-username-and-login", "title": "Getting a Table using Excel VBA behiind a username and login", "body": "<p>I am trying to get a table from a website. The problem is that I need to login first in order to access this information.</p>\n\n<p>My code is below. I have hit a road block and most of the guides I found out there do not work with this site. Appreciate your help.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim KeyCells As Range\n\n    ' The variable KeyCells contains the cells that will cause an alert when they are changed.\n    Set KeyCells = Range(\"H1\")\n\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) Is Nothing Then\n            ' Clear contents of Sheet 1\n            '\n            Worksheets(\"Sheet1\").Cells.Clear\n            Range(\"A1\").Select\n            '\n            'Login to the website\n            '\n            Dim IE As Object\n\n            Set IE = CreateObject(\"InternetExplorer.application\")\n\n            With IE\n                .Visible = True\n                .navigate (\"https://www.gurufocus.com/forum/login.php?0\")\n\n                While .Busy Or .readyState &lt;&gt; 4: DoEvents: Wend\n\n                .document.all(\"Template_GLE_Login_LoginView1_login_UserName\").Focus\n                .document.all(\"Template_GLE_Login_LoginView1_login_UserName\").Value = \"Username\"\n                .document.all(\"Template_GLE_Login_LoginView1_login_Password\").Focus\n                .document.all(\"Template_GLE_Login_LoginView1_login_Password\").Value = \"Password\"\n                .document.all(\"Template_GLE_Login_LoginView1_login_LoginButton\").Click\n\n                While .Busy Or .readyState &lt;&gt; 4: DoEvents: Wend\n                Debug.Print .LocationURL\n            End With\n            '\n            ' take the Ticker in sheet Blank cell H1\n            Dim Ticker As String\n            Ticker = Sheets(\"Blank\").Range(\"H1\")\n            URL = \"URL;http://www.gurufocus.com/financials/\" &amp; Ticker\n        '\n        ' get the data from the website\n            Range(\"A1\").Select\n            With Sheets(\"Sheet1\").QueryTables.Add(Connection:=URL, Destination:=Sheets(\"Sheet1\").Range(\"$A$1\"))\n        '        .CommandType = 0\n                .Name = Ticker\n                .FieldNames = True\n                .RowNumbers = False\n                .FillAdjacentFormulas = False\n        '        .PreserveFormatting = True\n                .RefreshOnFileOpen = False\n                .BackgroundQuery = True\n                .RefreshStyle = xlInsertDeleteCells\n                .SavePassword = False\n                .SaveData = True\n                .AdjustColumnWidth = True\n        '        .RefreshPeriod = 0\n        '        .WebSelectionType = xlSpecifiedTables\n        '        .WebFormatting = xlWebFormattingNone\n        '        .WebTables = \"\"\"Rf\"\"\"\n        '        .WebPreFormattedTextToColumns = True\n        '        .WebConsecutiveDelimitersAsOne = True\n        '        .WebSingleBlockTextImport = False\n        '        .WebDisableDateRecognition = False\n        '        .WebDisableRedirections = False\n                .Refresh BackgroundQuery:=False\n            End With\n\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "combobox", "listbox", "userform"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 2909100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/813085e3e0acdd06084258e390430835?s=128&d=identicon&r=PG&f=1", "display_name": "user2909100", "link": "https://stackoverflow.com/users/2909100/user2909100"}, "edited": false, "score": 0, "creation_date": 1438158358, "post_id": 31694950, "comment_id": 51330407, "body": "Ah, Thanks, Typical of me to get stuck on such a simple error!.  Thanks a lot"}], "tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": true, "score": 3, "last_activity_date": 1438157889, "creation_date": 1438157889, "answer_id": 31694950, "question_id": 31694868, "link": "https://stackoverflow.com/questions/31694868/vba-error-1004-when-accessing-cell-values-within-2-loops/31694950#31694950", "title": "VBA error &#39;1004&#39; when accessing cell values within 2 loops", "body": "<p>There is no <strong>row 0</strong> or <strong>column 0</strong> in excel. If you want first row or first column, It <strong>should start from 1</strong> as follow:</p>\n\n<pre><code>.Cells(1,1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "is_accepted": false, "score": 2, "last_activity_date": 1438157911, "creation_date": 1438157911, "answer_id": 31694958, "question_id": 31694868, "link": "https://stackoverflow.com/questions/31694868/vba-error-1004-when-accessing-cell-values-within-2-loops/31694958#31694958", "title": "VBA error &#39;1004&#39; when accessing cell values within 2 loops", "body": "<p>The reason is <code>cells(k, j)</code> specifies a cell using k = row and j = column</p>\n\n<p>you must not handle it like an array where the first value is 0. </p>\n\n<p>k and j must be >= 1.</p>\n"}], "owner": {"reputation": 55, "user_id": 2909100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/813085e3e0acdd06084258e390430835?s=128&d=identicon&r=PG&f=1", "display_name": "user2909100", "link": "https://stackoverflow.com/users/2909100/user2909100"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 0, "accepted_answer_id": 31694950, "answer_count": 2, "score": 2, "last_activity_date": 1438157911, "creation_date": 1438157654, "question_id": 31694868, "link": "https://stackoverflow.com/questions/31694868/vba-error-1004-when-accessing-cell-values-within-2-loops", "title": "VBA error &#39;1004&#39; when accessing cell values within 2 loops", "body": "<p>I recently got started with VBA...I am working on an Excel UserForm.  I want certain fields in a listbox to be selected automatically when the user makes a change in a combobox.  Although I am doing nothing out of the ordinary it still returns the \"Application-defined or object-defined error\". </p>\n\n<p>I have searched other questions regarding this error and none of them seem to apply to the same kind of problem.  Here is the code:</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n\n'first get the current row rule id\nlastRow = FindLastRow(\"Rows Rules\")\n\nDim id, i, k As Integer\n\nFor i = 2 To lastRow\n    If Sheets(\"Rows Rules\").Cells(i, 2) = ComboBox1.Text Then\n        id = Sheets(\"Rows Rules\").Cells(i, 1)\n    End If\nNext\n\n\n'get ISINs for id\nWith Sheets(\"Row ISINs\")\n\n    'loop  for every isin\n    For i = 0 To ListBox1.ListCount\n        isin = ListBox1.List(i, 0)\n        'check if exists\n        lastRow = FindLastRow(\"Row ISINs\")\n        'loop to compare  with every record\n        For k = 1 To lastRow\n            If .Cells(k, 0) = id Then 'error happens here--------------\n                If .Cells(k, 1) = isin Then\n                    'mark those as selected\n                    ListBox1.Selected(i) = True\n                End If\n            End If\n        Next\n\n    Next\n\nEnd With\nEnd Sub\n</code></pre>\n\n<p>It appears that after the second loop:</p>\n\n<blockquote>\n  <p>For k = 1 To lastRow</p>\n</blockquote>\n\n<p>every access to the cells I make returns the error</p>\n\n<p>I also tried checking using MsgBox:</p>\n\n<blockquote>\n  <p>MsgBox .Cells(0, 1)</p>\n</blockquote>\n\n<p>and it still returns the same error.</p>\n\n<p>I do not know if it has to do with the loops, or something else that I'm missing.  Any help will be appreciated, thanks</p>\n"}, {"tags": ["vba", "class", "excel"], "comments": [{"owner": {"reputation": 712, "user_id": 3243922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFTEb.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3243922/tom"}, "edited": false, "score": 1, "creation_date": 1438157917, "post_id": 31694721, "comment_id": 51330128, "body": "The macro that the button should execute cannot be reached because it is inside the class module. Place this macro in the main (normal) module and see if that works for you. Otherwise you will probably have to declare the instance of the class as a global variable and use withevents like mielk shows, even though that will need some more tweaking."}, {"owner": {"reputation": 13, "user_id": 4561422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/933bd2eea6ddd6e0d2dec2a53fb437f3?s=128&d=identicon&r=PG&f=1", "display_name": "Lena", "link": "https://stackoverflow.com/users/4561422/lena"}, "reply_to_user": {"reputation": 712, "user_id": 3243922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFTEb.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3243922/tom"}, "edited": false, "score": 0, "creation_date": 1438158558, "post_id": 31694721, "comment_id": 51330533, "body": "Placing everything in the main (normal) module makes the code work. The problem is that this is a simple illustration example. In reality, I need to access variables stored in the instance of the class. If there is a way to pass that instance as a parameter of the function that is being called when the button is pressed, then it would be an acceptable solution. However, a quick googling says that there is no simple way to do that. Please correct me if I am wrong."}, {"owner": {"reputation": 712, "user_id": 3243922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFTEb.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3243922/tom"}, "edited": false, "score": 0, "creation_date": 1438158738, "post_id": 31694721, "comment_id": 51330646, "body": "You only need to put the macro that needs to be started by the button in the normal module. You can then create a new instance of the class module in this macro and do all the work in the class module itself."}, {"owner": {"reputation": 13, "user_id": 4561422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/933bd2eea6ddd6e0d2dec2a53fb437f3?s=128&d=identicon&r=PG&f=1", "display_name": "Lena", "link": "https://stackoverflow.com/users/4561422/lena"}, "reply_to_user": {"reputation": 712, "user_id": 3243922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFTEb.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3243922/tom"}, "edited": false, "score": 0, "creation_date": 1438159048, "post_id": 31694721, "comment_id": 51330824, "body": "Is there a simple way to access the old instance (the one that actually called the function) in the normal module? Because in the end, what I would like to do is to manipulate the data stored in the variables of the instance, when the button is pressed."}, {"owner": {"reputation": 712, "user_id": 3243922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFTEb.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3243922/tom"}, "edited": false, "score": 0, "creation_date": 1438159572, "post_id": 31694721, "comment_id": 51331127, "body": "The problem is that you would need to give control of the worksheet that the button is located on back to the user and this will mean that the vba code needs to be stopped. This means that all the information that was stored in memory for vba is no longer available. Having code run in the background, while control of the worksheet is given to the user, is hard to accomplish."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1438159981, "post_id": 31694721, "comment_id": 51331356, "body": "You&#39;d have to use an ActiveX commandbutton, declare the variable <code>WithEvents</code> and have the class respond to its <code>Click</code> event. The native form buttons don&#39;t expose events you can use in this way. You could also use a public variable set to the instance of the class and have the form button&#39;s macro refer to that. Ugly though."}], "answers": [{"tags": [], "owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "is_accepted": true, "score": 1, "last_activity_date": 1438177848, "last_edit_date": 1438177848, "creation_date": 1438170213, "answer_id": 31699512, "question_id": 31694721, "link": "https://stackoverflow.com/questions/31694721/vba-excel-dynamically-created-button-in-a-class-module-runs-immediately-and-onl/31699512#31699512", "title": "VBA Excel: dynamically created button in a class module runs immediately and only once", "body": "<p>To expand on Rory's comment, your class needs something like this:</p>\n\n<pre><code>Public WithEvents Button As CommandButton\n\nPrivate Sub Class_Initialize()\n    Set Me.Button = Sheet1.OLEObjects(\"Thebutton\").Object\nEnd Sub\n\nPrivate Sub Button_Click()\n    MsgBox \"Foo\"\nEnd Sub\n</code></pre>\n\n<p>Then in a normal module create a public instance of the class so it stays in memmory:</p>\n\n<pre><code>Public myButt As ButtonClass\n\nPublic Sub AddEvent()\n    Set myButt = New ButtonClass\nEnd Sub\n</code></pre>\n\n<p>Note that the click event will only be handled as long as the instance of the class remains in memory. If you close the workbook and open it again the event will no longer be handled.</p>\n\n<p>Edit: I forgot to mention, you need to set a reference to Microsoft Forms in order to declare a variable of type CommandButton.</p>\n"}], "owner": {"reputation": 13, "user_id": 4561422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/933bd2eea6ddd6e0d2dec2a53fb437f3?s=128&d=identicon&r=PG&f=1", "display_name": "Lena", "link": "https://stackoverflow.com/users/4561422/lena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2051, "favorite_count": 0, "accepted_answer_id": 31699512, "answer_count": 1, "score": 1, "last_activity_date": 1438177848, "creation_date": 1438157226, "last_edit_date": 1438159607, "question_id": 31694721, "link": "https://stackoverflow.com/questions/31694721/vba-excel-dynamically-created-button-in-a-class-module-runs-immediately-and-onl", "title": "VBA Excel: dynamically created button in a class module runs immediately and only once", "body": "<p>I am trying to make class that would create a button. The button should have a macro assigned to it. The macro is a function of the class.</p>\n\n<p>The code of the class module is the following:</p>\n\n<pre><code>'Class Module: btnClass\nOption Explicit\n\nDim btn As Button\n\nFunction addButton()\n    'Adding a button\n    Set btn = ActiveSheet.Buttons.Add( _\n        Range(\"A1\").Left, _\n        Range(\"A1\").Top, _\n        Range(\"A1\").Width, _\n        Range(\"A1\").Height)\n    With btn\n        'Assigning a function\n        .OnAction = Me.onClickAction\n        .Caption = \"Button\"\n    End With\nEnd Function\n\nFunction onClickAction()\n    MsgBox (\"Click\")\nEnd Function\n</code></pre>\n\n<p>The code of the main macro is the following:</p>\n\n<pre><code>'Module\nOption Explicit\nSub main()\n    Dim btnInstance As btnClass\n    Set btnInstance = New btnClass\n\n    'Calling a function of the instance that creates a button\n    Call btnInstance.addButton\nEnd Sub\n</code></pre>\n\n<p>The code above creates a button successfully. However, the function assigned to the button is run immediately (right after the button is created, not when I click on it), and only once (when you click on the button later, nothing happens).</p>\n\n<p>Is there a way in VBA to implement the required functionality using class modules (want to create a class that does not rely on the outside functions)?</p>\n"}, {"tags": ["vba", "excel", "pdf"], "comments": [{"owner": {"reputation": 381798, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 1, "creation_date": 1438155658, "post_id": 31694081, "comment_id": 51328749, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/7735697/how-to-convert-ms-excel-file-to-pdf-in-java\">How to convert ms-Excel file to pdf in java</a>"}, {"owner": {"reputation": 41, "user_id": 5010300, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QT5T8b-rnLQ/AAAAAAAAAAI/AAAAAAAAABI/5uHrbFLdD78/photo.jpg?sz=128", "display_name": "Syukrindang", "link": "https://stackoverflow.com/users/5010300/syukrindang"}, "reply_to_user": {"reputation": 381798, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1438156084, "post_id": 31694081, "comment_id": 51329019, "body": "Sorry... Doesn&#39;t seem to work :&#39;( - @Tim Biegeleisen"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 5010300, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QT5T8b-rnLQ/AAAAAAAAAAI/AAAAAAAAABI/5uHrbFLdD78/photo.jpg?sz=128", "display_name": "Syukrindang", "link": "https://stackoverflow.com/users/5010300/syukrindang"}, "edited": false, "score": 0, "creation_date": 1438216701, "post_id": 31694603, "comment_id": 51364512, "body": "Hello @Omar. I&#39;ve tried to run the coding that you gave me. Thank you so much for your help. However, it has an error. It says &quot;Variable to defined&quot; for xlTypePDF . Is there any way to clear this up ?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 41, "user_id": 5010300, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QT5T8b-rnLQ/AAAAAAAAAAI/AAAAAAAAABI/5uHrbFLdD78/photo.jpg?sz=128", "display_name": "Syukrindang", "link": "https://stackoverflow.com/users/5010300/syukrindang"}, "edited": false, "score": 2, "creation_date": 1438219086, "post_id": 31694603, "comment_id": 51365101, "body": "I have updated the answer please don&#39;t forget to <a href=\"http://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\">accept</a> also see <a href=\"http://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question?</a>"}, {"owner": {"reputation": 41, "user_id": 5010300, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QT5T8b-rnLQ/AAAAAAAAAAI/AAAAAAAAABI/5uHrbFLdD78/photo.jpg?sz=128", "display_name": "Syukrindang", "link": "https://stackoverflow.com/users/5010300/syukrindang"}, "edited": false, "score": 1, "creation_date": 1438245668, "post_id": 31694603, "comment_id": 51374887, "body": "How do I convert many excel sheets into one PDF file? As the coding you gave, it works. However, it does the conversion sheet by sheet."}, {"owner": {"reputation": 41, "user_id": 5010300, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QT5T8b-rnLQ/AAAAAAAAAAI/AAAAAAAAABI/5uHrbFLdD78/photo.jpg?sz=128", "display_name": "Syukrindang", "link": "https://stackoverflow.com/users/5010300/syukrindang"}, "edited": false, "score": 0, "creation_date": 1438822897, "post_id": 31694603, "comment_id": 51611701, "body": "How to save to a particular ActiveSheet ? Eg. I have a 5 module that has charts. So is there a way a to convert only this 5 charts into PDF ? @Omar"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 3, "last_activity_date": 1501013860, "last_edit_date": 1501013860, "creation_date": 1438156896, "answer_id": 31694603, "question_id": 31694081, "link": "https://stackoverflow.com/questions/31694081/how-to-convert-excel-to-adobe-pdf/31694603#31694603", "title": "How to convert Excel to Adobe PDF", "body": "<pre><code>Option Explicit\nSub SaveAsPDF()\n    Dim FSO As Object\n    Dim s(1) As String\n    Dim FilePath As String\n\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n    s(0) = ThisWorkbook.FullName\n\n    If FSO.FileExists(s(0)) Then\n        '// Change Excel Extension to PDF extension in FilePath\n        s(1) = FSO.GetExtensionName(s(0))\n        If s(1) &lt;&gt; \"\" Then\n            s(1) = \".\" &amp; s(1)\n            FilePath = Replace(s(0), s(1), \".pdf\")\n\n            '// Export to PDF with new File Path\n            ActiveSheet.ExportAsFixedFormat _\n            Type:=xlTypePDF, _\n            Filename:=FilePath, _\n            Quality:=xlQualityStandard, IncludeDocProperties:=True, _\n            IgnorePrintAreas:=False, OpenAfterPublish:=True\n        End If\n    Else\n        '// Error: file path not found\n        MsgBox \"Error: This workbook may be unsaved.  Please save and try again.\"\n    End If\n\n    Set FSO = Nothing\nEnd Sub\n</code></pre>\n\n<p><em>To Export the workbook Try changing <code>ActiveSheet</code> To <code>ActiveWorkbook</code></em></p>\n\n<p><em>To Export only multiple sheets selections try using</em> <em><a href=\"https://msdn.microsoft.com/en-us/library/office/ff193217.aspx\" rel=\"nofollow noreferrer\">Sheets(Array(\"Sheet4\", \"Sheet5\"))</a></em> </p>\n\n<p><em>Example:</em></p>\n\n<pre><code>        ThisWorkbook.Sheets(Array(\"Sheet2\", \"Sheet3\")).Select\n        Selection.ExportAsFixedFormat _\n        Type:=xlTypePDF, _\n        Filename:=FilePath, _\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5010300, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QT5T8b-rnLQ/AAAAAAAAAAI/AAAAAAAAABI/5uHrbFLdD78/photo.jpg?sz=128", "display_name": "Syukrindang", "link": "https://stackoverflow.com/users/5010300/syukrindang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1223, "favorite_count": 1, "accepted_answer_id": 31694603, "answer_count": 1, "score": 0, "last_activity_date": 1501013860, "creation_date": 1438155387, "last_edit_date": 1501013819, "question_id": 31694081, "link": "https://stackoverflow.com/questions/31694081/how-to-convert-excel-to-adobe-pdf", "title": "How to convert Excel to Adobe PDF", "body": "<p>I am trying to find a code that works to convert my excel into PDF (Adobe). So far my research to find the perfect code doesn't work. </p>\n\n<p>So here is how my company manually converts and save at their own file ===></p>\n\n<p><code>Click \"File\" -&gt; Click \"Print\" -&gt;</code> (configure the Set Up to their own preferences like portrait or landscape etc) <code>-&gt; Click \"Print\" button -&gt;</code> Select \"CutePDFWriter\" -> (configure the Properties to their own preferences) <code>-&gt; Click \"OK\" button -&gt; Click \"Save\"</code> (to whichever file they want to save in)</p>\n\n<p>Please do help me if you have any sort of knowledge in this. \nThank you very very much.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 0, "creation_date": 1438154848, "post_id": 31693848, "comment_id": 51328229, "body": "Use Mid() <a href=\"http://www.w3schools.com/vbscript/func_mid.asp\" rel=\"nofollow noreferrer\">w3schools.com/vbscript/func_mid.asp</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1120, "user_id": 3185406, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/nJdB6.jpg?s=128&g=1", "display_name": "starko", "link": "https://stackoverflow.com/users/3185406/starko"}, "is_accepted": true, "score": 2, "last_activity_date": 1438155087, "creation_date": 1438155087, "answer_id": 31693972, "question_id": 31693848, "link": "https://stackoverflow.com/questions/31693848/strip-a-string-from-both-sides/31693972#31693972", "title": "Strip a string from both sides", "body": "<p>Try Mid function</p>\n\n<pre><code>Mid(\"2015-07-22\", 6, 2)\n</code></pre>\n"}], "owner": {"reputation": 890, "user_id": 4537270, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ihOUv.jpg?s=128&g=1", "display_name": "XsiSec", "link": "https://stackoverflow.com/users/4537270/xsisec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 31693972, "answer_count": 1, "score": -1, "last_activity_date": 1438176292, "creation_date": 1438154706, "last_edit_date": 1438176292, "question_id": 31693848, "link": "https://stackoverflow.com/questions/31693848/strip-a-string-from-both-sides", "title": "Strip a string from both sides", "body": "<p>I have this string:</p>\n\n<pre><code>\"2015-07-22\"\n</code></pre>\n\n<p>and I want to extract the <code>\"07\"</code> from the string.</p>\n\n<p>Could someone help me?</p>\n"}, {"tags": ["excel", "vba", "charts"], "answers": [{"comments": [{"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1438189549, "post_id": 31695369, "comment_id": 51351960, "body": "You&#39;re setting the variable to the ChartObject, not to the chart."}, {"owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "reply_to_user": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1438218825, "post_id": 31695369, "comment_id": 51365033, "body": "Yes, but this is what @Rik wanted to achieve with this code: <code>Set cht = ActiveSheet.ChartObject(ActiveChart.Name)</code>."}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1438313354, "post_id": 31695369, "comment_id": 51409998, "body": "He said &quot;current chart&quot;, but the code was for ChartObject; you did the same. It would be interesting to see how cht was declared."}], "tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": true, "score": 1, "last_activity_date": 1438159083, "creation_date": 1438159083, "answer_id": 31695369, "question_id": 31692938, "link": "https://stackoverflow.com/questions/31692938/set-object-to-currently-selected-chart-in-excel/31695369#31695369", "title": "set object to currently selected chart in excel", "body": "<p>This <em>chart</em> appended to the name of chart is the name of worksheet where this chart is placed.</p>\n\n<p>You can retrieve the name of chart like that:</p>\n\n<pre><code>MsgBox ActiveChart.Parent.Name\n</code></pre>\n\n<hr>\n\n<p>If you want to set variable <code>cht</code> to the current chart you don't need to refer to the collection of charts. You can do it like that:</p>\n\n<pre><code>Set cht = ActiveChart.Parent\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "is_accepted": false, "score": 0, "last_activity_date": 1438189641, "creation_date": 1438189641, "answer_id": 31706860, "question_id": 31692938, "link": "https://stackoverflow.com/questions/31692938/set-object-to-currently-selected-chart-in-excel/31706860#31706860", "title": "set object to currently selected chart in excel", "body": "<p>The Chart is embedded in a shape also known as a ChartObject.</p>\n\n<p>If you want to reference the chart (as I suspect), use this:</p>\n\n<pre><code>Dim cht As Chart\nSet cht = ActiveChart\n</code></pre>\n\n<p>If you want to reference the parent chart object:</p>\n\n<pre><code>Dim chtob As ChartObject\nSet chtob = ActiveChart.Parent\n</code></pre>\n\n<p>The chart is related to the chart object like this:</p>\n\n<pre><code>Dim chtob As ChartObject, cht As Chart\nSet chtob = ActiveChart.Parent\nSet cht = chtob.Chart\n</code></pre>\n"}], "owner": {"reputation": 1566, "user_id": 682355, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/59191ba50eff53600102e0bbb74c75ba?s=128&d=identicon&r=PG", "display_name": "Rik", "link": "https://stackoverflow.com/users/682355/rik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2443, "favorite_count": 0, "accepted_answer_id": 31695369, "answer_count": 2, "score": 0, "last_activity_date": 1438189641, "creation_date": 1438151776, "last_edit_date": 1438159554, "question_id": 31692938, "link": "https://stackoverflow.com/questions/31692938/set-object-to-currently-selected-chart-in-excel", "title": "set object to currently selected chart in excel", "body": "<p>All,</p>\n\n<p>I want to set variable cht to the current chart. I've tried the below code but for some reason it puts an extra \"chart \" on the name. Is there an alternate way?</p>\n\n<pre><code>Set cht = ActiveSheet.ChartObject(ActiveChart.Name)\n</code></pre>\n\n<p>This code doesn't work because it can't find the object with that name.</p>\n\n<pre><code>msgbox ActiveChart.Name \n</code></pre>\n\n<p>yields \"chart pvtChart1\" when the actual name is \"pvtChart1\". Is there an alternate way to reference the active chart?</p>\n\n<p>I apologize for not correctly formatting the code due to my computer settings that I can't change. Thanks.</p>\n\n<p>-Rik</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1438161452, "post_id": 31692723, "comment_id": 51332288, "body": "maybe I am missing something. But it seems to me that you asked a question and answered it yourself with the link to support.office.com yourself (yes, it is possible)."}, {"owner": {"reputation": 407, "user_id": 3931046, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jsanf.png?s=128&g=1", "display_name": "cryocaustik", "link": "https://stackoverflow.com/users/3931046/cryocaustik"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1438224237, "post_id": 31692723, "comment_id": 51366212, "body": "Microsoft has built in a couple ways to drill down, but they all involve clicking on a specific menu or a specific cell to make a submenu appear. When working with non technical people I have found it easier to make an actuall button that sits above the report that allows them to interact with the report/chart. in this case, it would be to drill down/up."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1438250032, "post_id": 31692723, "comment_id": 51377813, "body": "Why don&#39;t you just put a big text box on top of your sheet stating &quot;double-click on a number to drill-down&quot;? If you want to offer drill-down functionality this is not only a matter of pressing a button but also knowing where / what to drill-down on. With a button on top of your sheet you wouldn&#39;t know what to drill-down on."}, {"owner": {"reputation": 407, "user_id": 3931046, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jsanf.png?s=128&g=1", "display_name": "cryocaustik", "link": "https://stackoverflow.com/users/3931046/cryocaustik"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1438306905, "post_id": 31692723, "comment_id": 51408513, "body": "That would be one way, it would not allow you to drill up"}], "owner": {"reputation": 407, "user_id": 3931046, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jsanf.png?s=128&g=1", "display_name": "cryocaustik", "link": "https://stackoverflow.com/users/3931046/cryocaustik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 300, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1438151101, "creation_date": 1438151101, "question_id": 31692723, "link": "https://stackoverflow.com/questions/31692723/vba-excel-drill-down-assigned-to-a-button", "title": "VBA/Excel - Drill Down assigned to a button", "body": "<p>Using Excel 2013 with PowerPivot, is it possible to create a command button to perform the \"drill down\" when clicked on? \nWorking with some non technical customers and believe having clear buttons to press would help simplify the process for them. </p>\n\n<p>Type of drill down I am referring to: <a href=\"https://support.office.com/en-ca/article/Drill-into-PivotTable-data-c1b11240-fc8f-4fdd-a697-629bf6f7ee0b\" rel=\"nofollow\">https://support.office.com/en-ca/article/Drill-into-PivotTable-data-c1b11240-fc8f-4fdd-a697-629bf6f7ee0b</a></p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1438151668, "post_id": 31692559, "comment_id": 51326424, "body": "Hi Nihal, You want to make a For loop. It will have to be like For row = BeginRow to LastRow Within that an If statement. Something like If Cells(row,3) = &quot;Version&quot; Then Outrow = row BeginRow = row + 1"}, {"owner": {"reputation": 35, "user_id": 3977872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb9f5f776bd1e777342763bc1a696d93?s=128&d=identicon&r=PG&f=1", "display_name": "nihal idiot", "link": "https://stackoverflow.com/users/3977872/nihal-idiot"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1438152853, "post_id": 31692559, "comment_id": 51327103, "body": "Hi Luuklag, shall I assign BeginRow &amp; LastRow with some default values like BeginRow =1 &amp; LastRow =n ? Suggest please."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1438153052, "post_id": 31692559, "comment_id": 51327221, "body": "BeginRow should be assigned the value 1. LastRow should be assigned something like: Thisworkbook.Worksheets(&quot;sheet_you_work_in&quot;).UsedRange.Rows.&zwnj;&#8203;Count    This counts the amount of rows that currently are in use. With that we limit the loop of going on continuously, and we don&#39;t have to manually change the value of it every time we add data to the bottom of the sheet."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 3977872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb9f5f776bd1e777342763bc1a696d93?s=128&d=identicon&r=PG&f=1", "display_name": "nihal idiot", "link": "https://stackoverflow.com/users/3977872/nihal-idiot"}, "edited": false, "score": 0, "creation_date": 1438161330, "post_id": 31695655, "comment_id": 51332206, "body": "Hi Nicolas, I shown sample of 3 documents result &amp; you have initialized considering those  3 rows data. But in real, I have many documents. How to proceed to all that documents? Can you please help me."}, {"owner": {"reputation": 35, "user_id": 3977872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb9f5f776bd1e777342763bc1a696d93?s=128&d=identicon&r=PG&f=1", "display_name": "nihal idiot", "link": "https://stackoverflow.com/users/3977872/nihal-idiot"}, "edited": false, "score": 0, "creation_date": 1438164088, "post_id": 31695655, "comment_id": 51334005, "body": "Thanks Nicolas, I got my requirement if I would have 2 documents. I placed 3 documents and checked, it it not fetching the result as for documents it got."}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "reply_to_user": {"reputation": 35, "user_id": 3977872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb9f5f776bd1e777342763bc1a696d93?s=128&d=identicon&r=PG&f=1", "display_name": "nihal idiot", "link": "https://stackoverflow.com/users/3977872/nihal-idiot"}, "edited": false, "score": 0, "creation_date": 1438164321, "post_id": 31695655, "comment_id": 51334149, "body": "For 3 document, you should have there version set in column C. Check it. If column C data is right, it will get right result because I already tested with 3 data row."}, {"owner": {"reputation": 35, "user_id": 3977872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb9f5f776bd1e777342763bc1a696d93?s=128&d=identicon&r=PG&f=1", "display_name": "nihal idiot", "link": "https://stackoverflow.com/users/3977872/nihal-idiot"}, "edited": false, "score": 0, "creation_date": 1438164600, "post_id": 31695655, "comment_id": 51334357, "body": "Yes Nicolas, I have 3 documents &amp; 3 Version set in column C. Even though I am not getting it. For 2 documents, it is working fine. Not working for 2 or more documents."}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "reply_to_user": {"reputation": 35, "user_id": 3977872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb9f5f776bd1e777342763bc1a696d93?s=128&d=identicon&r=PG&f=1", "display_name": "nihal idiot", "link": "https://stackoverflow.com/users/3977872/nihal-idiot"}, "edited": false, "score": 0, "creation_date": 1438164837, "post_id": 31695655, "comment_id": 51334525, "body": "No way, I suggested the code for debug line by line. So, you can know the specific error which is not working. <a href=\"http://www.excel-spreadsheet.com/vba/debugging.htm\" rel=\"nofollow noreferrer\">reference</a>"}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "reply_to_user": {"reputation": 35, "user_id": 3977872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb9f5f776bd1e777342763bc1a696d93?s=128&d=identicon&r=PG&f=1", "display_name": "nihal idiot", "link": "https://stackoverflow.com/users/3977872/nihal-idiot"}, "edited": false, "score": 0, "creation_date": 1438165777, "post_id": 31695655, "comment_id": 51335166, "body": "Glad to here that. Accept answer by marking left mark and vote for my helping. Have a nice day."}, {"owner": {"reputation": 35, "user_id": 3977872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb9f5f776bd1e777342763bc1a696d93?s=128&d=identicon&r=PG&f=1", "display_name": "nihal idiot", "link": "https://stackoverflow.com/users/3977872/nihal-idiot"}, "edited": false, "score": 0, "creation_date": 1438165812, "post_id": 31695655, "comment_id": 51335188, "body": "I am done I am done accepting it as an answer. Thanks again."}], "tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": false, "score": 2, "last_activity_date": 1438162006, "last_edit_date": 1438162006, "creation_date": 1438159941, "answer_id": 31695655, "question_id": 31692559, "link": "https://stackoverflow.com/questions/31692559/how-to-paste-values-in-cell-based-on-text-present-in-other-adjacent-cell-using-v/31695655#31695655", "title": "How to paste values in cell based on text present in other adjacent cell using VBA?", "body": "<p>Here, I got one for you. Place this piece of code in your piece of code at <code>With wrdApp...End With</code>. After that test the code, If sometime is wrong, let me know. Try this one:</p>\n\n<pre><code>Dim row, lastRow As Integer\n\nWith wrdApp\n\n    .ActiveDocument.Tables(1).Select\n\n    .Selection.Copy\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        .Cells(Rows.count, \"C\").End(xlUp)(1).PasteSpecial xlPasteValues\n\n        'getting the last row\n        lastRow = .Range(\"C:C\").End(xlDown).row\n\n        'loop all row in column \"C\" for checking\n        For row = 1 To lastRow Step 1\n\n            'If value of C cell is \"Version\", check column A cell and B cell\n            If .Range(\"C\" &amp; row) = \"Version\" Then\n\n                'If both cell are empty, store value.\n                If .Range(\"A\" &amp; row) = \"\" And .Range(\"B\" &amp; row) = \"\" Then\n\n                    .Range(\"A\" &amp; row).Value = resultId\n                    .Range(\"B\" &amp; row).Value = resultIdZ\n\n                    Exit For\n\n                End If\n\n            End If\n\n        Next row\n\n    End With\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 3977872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb9f5f776bd1e777342763bc1a696d93?s=128&d=identicon&r=PG&f=1", "display_name": "nihal idiot", "link": "https://stackoverflow.com/users/3977872/nihal-idiot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1263, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438242694, "creation_date": 1438150559, "last_edit_date": 1531164843, "question_id": 31692559, "link": "https://stackoverflow.com/questions/31692559/how-to-paste-values-in-cell-based-on-text-present-in-other-adjacent-cell-using-v", "title": "How to paste values in cell based on text present in other adjacent cell using VBA?", "body": "<p>Thanks for reading this small request. I need your help here.\nI am able to paste the data in a cell of particular column of excel but I wanted to paste the data depending on adjacent column cell value. I worked on it but I could not place based on adjacent cell value. Please find the below images.</p>\n\n<p><a href=\"https://i.stack.imgur.com/LrYey.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LrYey.png\" alt=\"My current result\"></a></p>\n\n<p>I wanted to get A2, B2 values in A4, B4 respectively i.e., based on C4 \"version\" text in column C. Similarly, A3, B3 values has to get in A11, B11 respectively, based on C11 version. I am pulling table data from word document &amp; here each \"Application ID:****\" &amp; \"Z planning-IT ID:****\" &amp; \"Version\" data belonging to same each document. Finally I am trying to place each document data in a proper order. But I could not make it for Columns A &amp; B. Help me please. Here is my code.</p>\n\n<pre><code>Option Explicit\nDim FSO As Object\nDim strFolderName As String\nDim FileToOpenVdocx As String\nDim FileToOpenvdoc1 As String\nDim FileToOpenVdoc As String\nDim FileToOpenvdocx1 As String\nDim wrdApp As Word.Application\nDim wrdDoc As Word.Document\nDim fsoFolder As Object\n'To copy data from word to excel\n   'Copy data from word to excel\nSub FindFilesInSubFolders()\nDim fsoFolder As Scripting.Folder\nSheets(\"Sheet1\").Cells.Clear\nFileToOpenVdocx = \"*V2.1.docx*\"\nFileToOpenvdoc1 = \"*v2.1.doc*\"\nFileToOpenVdoc = \"*V2.1.doc*\"\nFileToOpenvdocx1 = \"*v2.1.docx*\"\n\nIf FSO Is Nothing Then\n   Set FSO = CreateObject(\"Scripting.FileSystemObject\")\nEnd If\n\n'Set the parent folder for the new subfolders\nstrFolderName = \"C:\\Test1\"\nSet fsoFolder = FSO.GetFolder(strFolderName)\nSet wrdApp = CreateObject(\"Word.Application\")\nOpenFilesInSubFolders fsoFolder\nwrdApp.Quit\nEnd Sub\n\nSub OpenFilesInSubFolders(fsoPFolder As Scripting.Folder)\nDim fsoSFolder As Scripting.Folder\nDim fileDoc As Scripting.File\nDim wrdRng As Object\nDim strText As String\nDim singleLine As Object\nDim outRow As Long ' newly added\nDim Found As String\nDim resultId As String\nDim singleLineZ As Object\nDim resultIdZ As String\n\noutRow = 1 'you appear to want to start at the second row\nFor Each fsoSFolder In fsoPFolder.SubFolders\n    For Each fileDoc In fsoSFolder.Files\n\n        If (fileDoc.Name Like FileToOpenVdocx Or fileDoc.Name Like FileToOpenvdoc1 Or fileDoc.Name Like FileToOpenVdoc Or fileDoc.Name Like FileToOpenvdocx1) And Left(fileDoc.Name, 1) &lt;&gt; \"~\" Then\n            Set wrdDoc = wrdApp.Documents.Open(fileDoc.Path)\n            Set wrdRng = wrdDoc.Content\n\n            For Each singleLine In wrdApp.ActiveDocument.Paragraphs\n            'Search \"Application ID\" in line.\n            'If found, value will be greater 0.\n             Found = InStr(singleLine, \"Application\")\n            'If Application ID is found, get ID only\n\n                If Found &gt; 0 Then\n                    'Get ID by replacing the prefix with space.\n                     resultId = singleLine\n                    'After getting, stop loop because not need\n                     Exit For\n                End If\n\n            Next singleLine\n\n        For Each singleLineZ In wrdApp.ActiveDocument.Paragraphs\n            'Search \"Application ID\" in line.\n            'If found, value will be greater 0.\n             Found = InStr(singleLineZ, \"Z Planning\")\n            'If Application ID is found, get ID only\n\n                 If Found &gt; 0 Then\n                     'Get ID by replacing the prefix with space.\n                      resultIdZ = singleLineZ\n                     'After getting, stop loop because not need\n                      Exit For\n                 End If\n\n        Next singleLineZ\n\n        With wrdApp\n           .ActiveDocument.Tables(1).Select\n           .Selection.Copy\n           ThisWorkbook.Worksheets(\"Sheet1\").Cells(Rows.Count, \"C\").End(xlUp)(1).PasteSpecial xlPasteValues\n           Range(\"A\" &amp; outRow).Value = resultId\n           Range(\"B\" &amp; outRow).Value = resultIdZ\n           outRow = outRow + 1\n           End With\n\n           wrdDoc.Close False\n\n      End If\n\n   Next fileDoc\n   openFilesInSubFolders fsoSFolder\n\nNext fsoSFolder\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 3, "creation_date": 1438142967, "post_id": 31690814, "comment_id": 51323461, "body": "If you want a strictly VBA based solution, look at a Scripting.Dictionary&#39;s <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251562.aspx\" rel=\"nofollow noreferrer\">Exists method</a>."}, {"owner": {"reputation": 13704, "user_id": 426242, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CEL49.jpg?s=128&g=1", "display_name": "Jens M&#252;hlenhoff", "link": "https://stackoverflow.com/users/426242/jens-m%c3%bchlenhoff"}, "edited": false, "score": 0, "creation_date": 1581430950, "post_id": 31690814, "comment_id": 106425204, "body": "Related: <a href=\"https://stackoverflow.com/questions/36044556/quicker-way-to-get-all-unique-values-of-a-column-in-vba\" title=\"quicker way to get all unique values of a column in vba\">stackoverflow.com/questions/36044556/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "is_accepted": false, "score": 1, "last_activity_date": 1438143934, "creation_date": 1438143934, "answer_id": 31691207, "question_id": 31690814, "link": "https://stackoverflow.com/questions/31690814/how-do-i-get-a-list-of-unique-values-from-a-range-in-excel-vba/31691207#31691207", "title": "How do I get a list of unique values from a range in Excel VBA?", "body": "<p>Loop through the range, check if the value is in the array, if not add it to the array. </p>\n\n<pre><code>Sub test()\nDim Values() As Variant\nValues = GetUniqueVals(Selection)\nDim i As Integer\n    For i = LBound(Values) To UBound(Values)\n        Debug.Print (Values(i))\n    Next\n\nEnd Sub\n\nFunction GetUniqueVals(ByRef Data As Range) As Variant()\n    Dim cell As Range\n    Dim uniqueValues() As Variant\n    ReDim uniqueValues(0)\n\n    For Each cell In Data\n        If Not IsEmpty(cell) Then\n            If Not InArray(uniqueValues, cell.Value) Then\n                If IsEmpty(uniqueValues(LBound(uniqueValues))) Then\n                    uniqueValues(LBound(uniqueValues)) = cell.Value\n                Else\n                    ReDim Preserve uniqueValues(UBound(uniqueValues) + 1)\n                    uniqueValues(UBound(uniqueValues)) = cell.Value\n                End If\n            End If\n        End If\n    Next\n    GetUniqueVals = uniqueValues\nEnd Function\n\nFunction InArray(ByRef SearchWithin() As Variant, ByVal SearchFor As Variant) As Boolean\n    Dim i As Integer\n    Dim matched As Boolean 'Default value of boolean is false, we make true only if we find a match\n\n    For i = LBound(SearchWithin) To UBound(SearchWithin)\n        If SearchWithin(i) = SearchFor Then matched = True\n    Next\n\n    InArray = matched\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 190, "user_id": 6831211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4abd75a60d71329226f388410162f95?s=128&d=identicon&r=PG", "display_name": "Da Spotz", "link": "https://stackoverflow.com/users/6831211/da-spotz"}, "edited": false, "score": 0, "creation_date": 1494928028, "post_id": 31693059, "comment_id": 75024365, "body": "This works great when a range is one consistent block, however it fails when the range is &quot;torn apart&quot; like it is, when some rows are hidden and it is defined as: uniques = Range.SpecialCells(xlCellTypeVisible) Any idea what I might be able to still mak this work though?"}, {"owner": {"reputation": 190, "user_id": 6831211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4abd75a60d71329226f388410162f95?s=128&d=identicon&r=PG", "display_name": "Da Spotz", "link": "https://stackoverflow.com/users/6831211/da-spotz"}, "edited": false, "score": 0, "creation_date": 1494931432, "post_id": 31693059, "comment_id": 75026696, "body": "I found a workaround.By adding the values of the &quot;torn apart&quot; range to an array and then adding the array elements to the collection instead this method still works (with minor adjustments)"}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "reply_to_user": {"reputation": 190, "user_id": 6831211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4abd75a60d71329226f388410162f95?s=128&d=identicon&r=PG", "display_name": "Da Spotz", "link": "https://stackoverflow.com/users/6831211/da-spotz"}, "edited": false, "score": 0, "creation_date": 1494936862, "post_id": 31693059, "comment_id": 75030555, "body": "@DaSpotz see edited answer. In case of <code>SpecialCells</code> the areas must be considered. Otherwise it works the same. HTH"}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "reply_to_user": {"reputation": 190, "user_id": 6831211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4abd75a60d71329226f388410162f95?s=128&d=identicon&r=PG", "display_name": "Da Spotz", "link": "https://stackoverflow.com/users/6831211/da-spotz"}, "edited": false, "score": 0, "creation_date": 1494949217, "post_id": 31693059, "comment_id": 75040070, "body": "@DaSpotz you are welcome! Yes <code>Areas</code> are not that known, but easy to use and useful to know about."}, {"owner": {"reputation": 190, "user_id": 6831211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4abd75a60d71329226f388410162f95?s=128&d=identicon&r=PG", "display_name": "Da Spotz", "link": "https://stackoverflow.com/users/6831211/da-spotz"}, "edited": false, "score": 0, "creation_date": 1494951360, "post_id": 31693059, "comment_id": 75041528, "body": "Cool, thanks for the Info and code update. I think the &quot;area.value&quot; in the: &quot;For Each val In area.Value&quot; part should just be area though?"}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "reply_to_user": {"reputation": 190, "user_id": 6831211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4abd75a60d71329226f388410162f95?s=128&d=identicon&r=PG", "display_name": "Da Spotz", "link": "https://stackoverflow.com/users/6831211/da-spotz"}, "edited": false, "score": 0, "creation_date": 1494970484, "post_id": 31693059, "comment_id": 75052083, "body": "@DaSpotz no, area.Value is on purpose. Area is of type <code>Range</code> so <code>area.Value</code> is variant array with the values, like range.value. So here all the ares are looped through and all the values are put into the collection. So the collection has finally all the values of all the areas. This is done because of the <code>SpecialCells</code> which mostly returns range with more areas (not just one, like when all cells are visible)."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "reply_to_user": {"reputation": 190, "user_id": 6831211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4abd75a60d71329226f388410162f95?s=128&d=identicon&r=PG", "display_name": "Da Spotz", "link": "https://stackoverflow.com/users/6831211/da-spotz"}, "edited": false, "score": 0, "creation_date": 1494998939, "post_id": 31693059, "comment_id": 75059856, "body": "But it should work without <code>Value</code> as well because of default property. But I personally don&#39;t use them."}, {"owner": {"reputation": 190, "user_id": 6831211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4abd75a60d71329226f388410162f95?s=128&d=identicon&r=PG", "display_name": "Da Spotz", "link": "https://stackoverflow.com/users/6831211/da-spotz"}, "edited": false, "score": 0, "creation_date": 1495048198, "post_id": 31693059, "comment_id": 75092441, "body": "I had to delete the &quot;value&quot; part for it to work for my specific code because it produced an error with area.value. And it made sense because I figured that the structure is: Loop through every area -&gt; Loop through each value in area (not area.value)...  my code looks like this and is working now: (<code>For Each area In sourceRange.Areas         For Each val In area             If val &lt;&gt; &quot;&quot; Then _                 vals.Add val         Next val     Next area</code>)"}], "tags": [], "owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "is_accepted": false, "score": 15, "last_activity_date": 1494936755, "last_edit_date": 1494936755, "creation_date": 1438152185, "answer_id": 31693059, "question_id": 31690814, "link": "https://stackoverflow.com/questions/31690814/how-do-i-get-a-list-of-unique-values-from-a-range-in-excel-vba/31693059#31693059", "title": "How do I get a list of unique values from a range in Excel VBA?", "body": "<p>I would use a simple <code>VBA-Collection</code> and add items with key. The key would be the item itself and because there can't be duplicit keys the collection will contain unique values.</p>\n\n<p><em>Note: Because adding duplicit key to collection raises error wrap the call to collection-add into a on-error-resume-next.</em> </p>\n\n<p>The function <code>GetUniqueValues</code> has <em>source-range-values</em> as parameter and retuns <code>VBA-Collection</code> of <em>unique source-range-values</em>. In the <code>main</code> method the function is called and the result is printed into Output-Window. HTH.</p>\n\n<blockquote>\n  <p>Sample source range looked like this:\n  <a href=\"https://i.stack.imgur.com/wAY10.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/wAY10.jpg\" alt=\"enter image description here\"></a></p>\n</blockquote>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim uniques As Collection\n    Dim source As Range\n\n    Set source = ActiveSheet.Range(\"A2:F6\")\n    Set uniques = GetUniqueValues(source.Value)\n\n    Dim it\n    For Each it In uniques\n        Debug.Print it\n    Next\nEnd Sub\n\nPublic Function GetUniqueValues(ByVal values As Variant) As Collection\n    Dim result As Collection\n    Dim cellValue As Variant\n    Dim cellValueTrimmed As String\n\n    Set result = New Collection\n    Set GetUniqueValues = result\n\n    On Error Resume Next\n\n    For Each cellValue In values\n        cellValueTrimmed = Trim(cellValue)\n        If cellValueTrimmed = \"\" Then GoTo NextValue\n        result.Add cellValueTrimmed, cellValueTrimmed\nNextValue:\n    Next cellValue\n\n    On Error GoTo 0\nEnd Function\n</code></pre>\n\n<blockquote>\n  <p>Output</p>\n</blockquote>\n\n<pre><code>SGD\nPHP\nKRW\nCNY\nIDA\nBGN\nPDSS\nCBBT\nINPC\nDBS\na\n</code></pre>\n\n<hr>\n\n<p>In case when the source range consists of areas get the values of all the areas first.</p>\n\n<pre><code>Public Function GetSourceValues(ByVal sourceRange As Range) As Collection\n    Dim vals As VBA.Collection\n    Dim area As Range\n    Dim val As Variant\n    Set vals = New VBA.Collection\n    For Each area In sourceRange.Areas\n        For Each val In area.Value\n            If val &lt;&gt; \"\" Then _\n                vals.Add val\n        Next val\n    Next area\n    Set GetSourceValues = vals\nEnd Function\n</code></pre>\n\n<p>Source type is now Collection but then all works the same:</p>\n\n<pre><code>Dim uniques As Collection\nDim source As Collection\n\nSet source = GetSourceValues(ActiveSheet.Range(\"A2:F6\").SpecialCells(xlCellTypeVisible))\nSet uniques = GetUniqueValues(source)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1580498477, "creation_date": 1580498477, "answer_id": 60010036, "question_id": 31690814, "link": "https://stackoverflow.com/questions/31690814/how-do-i-get-a-list-of-unique-values-from-a-range-in-excel-vba/60010036#60010036", "title": "How do I get a list of unique values from a range in Excel VBA?", "body": "<p>As of Excel 365, they have introduced the <code>UNIQUE()</code> Worksheet Function.</p>\n\n<p>From <a href=\"https://support.office.com/en-us/article/UNIQUE-function-c5ab87fd-30a3-4ce9-9d1a-40204fb85e1e\" rel=\"nofollow noreferrer\">Microsoft</a>:</p>\n\n<blockquote>\n  <p>The UNIQUE function returns a list of unique values in a list or range. </p>\n</blockquote>\n\n<p><code>=UNIQUE(Range,[by_col],[exactly_once])</code></p>\n\n<p>This formula will output the unique values in multiple cells:</p>\n\n<p><a href=\"https://i.stack.imgur.com/UmIT8.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UmIT8.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>So entering the formula in <code>A3</code>, I wouldn't be able to use <code>B3</code>, or <code>C3</code> as they contain some of the results.</p>\n\n<p>So, for VBA you can just use <code>Evaluate()</code>:</p>\n\n<pre><code>Dim uniques as Variant\nuniques = Evalute(\"Unique(\" &amp; rng.Address &amp; \",TRUE,FALSE)\")\n</code></pre>\n\n<p>Which returns them in an array (<em>Note:</em> The index starts at <code>1</code> here, not <code>0</code>).</p>\n"}], "owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44145, "favorite_count": 2, "answer_count": 3, "score": 9, "last_activity_date": 1580498477, "creation_date": 1438141084, "question_id": 31690814, "link": "https://stackoverflow.com/questions/31690814/how-do-i-get-a-list-of-unique-values-from-a-range-in-excel-vba", "title": "How do I get a list of unique values from a range in Excel VBA?", "body": "<p>I would like to get a list of unique values in a range using VBA. Most examples in Google talk about getting a list of unique values in a column using VBA.</p>\n\n<p>I am not sure how to change it to get a list of value in a range. </p>\n\n<p>For example,</p>\n\n<pre><code>Currency    Name 1  Name 2  Name 3  Name 4  Name 5\nSGD BGN DBS         \nPHP PDSS                \nKRW BGN             \nCNY CBBT    BGN         \nIDA INPC                \n</code></pre>\n\n<p>My array should look like:</p>\n\n<pre><code>BGN, DBS, PDSS, CBBT and INPC.\n</code></pre>\n\n<p>How do I do it? Need some guidance.</p>\n"}, {"tags": ["vba", "excel", "email"], "comments": [{"owner": {"reputation": 4497, "user_id": 2856868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YYZQQ.jpg?s=128&g=1", "display_name": "Matt Rowland", "link": "https://stackoverflow.com/users/2856868/matt-rowland"}, "edited": false, "score": 2, "creation_date": 1438141115, "post_id": 31690783, "comment_id": 51322987, "body": "Excel VBA is used to create macros not applications. What you are wanting to accomplish would have to be done using an external application."}], "answers": [{"tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 0, "last_activity_date": 1438161223, "creation_date": 1438161223, "answer_id": 31696113, "question_id": 31690783, "link": "https://stackoverflow.com/questions/31690783/automating-emails/31696113#31696113", "title": "Automating Emails", "body": "<p>As previously stated in a comment by Matt Rowland, Excel is not really the proper choice to do something like that. The easiest way to accomplish that would be probably using an SQL Server (or any other DB-Server) with the ability to send out emails.</p>\n\n<p>The main problem is that you want Excel to run on a particular date / time. Yet, Excel is not running day and night on your computer. So, if Excel is not open / running on the particular date / time you want it to, then Excel cannot send out the requested emails.</p>\n\n<p>Still, if the task has to be accomplish using Excel this is possible. First, you will have to make sure that you have a computer running day and night so that the computer is really on and running on the requested dates. Second, you need to setup the Windows Task (<a href=\"https://en.wikipedia.org/wiki/Windows_Task_Scheduler\" rel=\"nofollow\">https://en.wikipedia.org/wiki/Windows_Task_Scheduler</a>) to open Excel with the file you setup for that purpose (with the above code). To be really specific, you can even use the VBA function <code>Application.OnTime</code> (<a href=\"https://msdn.microsoft.com/en-gb/en-en/library/office/ff196165.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-gb/en-en/library/office/ff196165.aspx</a>) to run your above procedure at a particular time.</p>\n"}, {"tags": [], "owner": {"reputation": 667, "user_id": 4097470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0e18a78f4c5f640539775e532d78313?s=128&d=identicon&r=PG&f=1", "display_name": "VirtualMichael", "link": "https://stackoverflow.com/users/4097470/virtualmichael"}, "is_accepted": false, "score": 1, "last_activity_date": 1438213888, "last_edit_date": 1438213888, "creation_date": 1438175421, "answer_id": 31701405, "question_id": 31690783, "link": "https://stackoverflow.com/questions/31690783/automating-emails/31701405#31701405", "title": "Automating Emails", "body": "<p>There is a solution using Excel and Outlook utilising Outlook's task reminders, but it will send emails at the precise time only if your Outlook software is actively running at the moment a reminder event occurs. If you start Outlook and have 'missed' one or more scheduled events (because Outlook was turned off at the time), then emails corresponding with those missed scheduled events will occur shortly after Outlook starts. I'm assuming you have Outlook available as you are using Excel.</p>\n\n<h2>Excel Component Solution</h2>\n\n<p>I've created a spreadsheet that is slightly different to yours, but you can adapt as necessary. The spreadsheet has two separate sheets named \"Recipients\" and \"Emails\". The \"Recipients\" sheet contains a list of each email recipient along with three dates on which they should receive emails if they have not yet responded.</p>\n\n<p><a href=\"https://i.stack.imgur.com/u1Lja.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u1Lja.png\" alt=\"List of Recipients\"></a></p>\n\n<p>The \"Emails\" sheet contains content that is to be placed in each email:</p>\n\n<p><a href=\"https://i.stack.imgur.com/7nMBC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7nMBC.png\" alt=\"Email content definition\"></a></p>\n\n<p>Within the <code>ThisWorkbook</code> code for the spreadsheet, I added the following procedures. These are responsible for creating <em>tasks</em> within Outlook for which reminders will fire at particular times in the future. Each task will contain sufficient information to generate an email to a nominated recipient.</p>\n\n<pre><code>Sub CreateOutlookTask(name As String, destination As String, emailNum As Integer, sendDate As Date)\n    With CreateObject(\"Outlook.Application\").CreateItem(3)\n        .Subject = Worksheets(\"Emails\").Cells((emailNum + 1), \"A\").Value\n        .Role = destination\n        .StartDate = sendDate\n        .DueDate = sendDate\n        .ReminderTime = sendDate\n        .ReminderSet = True\n        .Body = Trim(Worksheets(\"Emails\").Cells((emailNum + 1), \"B\").Value) + _\n            \" \" + name + \",\" + vbLf + vbLf + _\n            Worksheets(\"Emails\").Cells(emailNum + 1, \"C\").Value + _\n            vbLf + vbLf + _\n            \"This email was sent to \" + destination + _\n            \" by XYZ Corporation [add reason].\"\n        .Categories = \"AutoSend\"\n        .Save\n    End With\nEnd Sub\n\nSub ProcessRecipients()\n    Dim rowNum As Integer\n    Dim lastRowIdx As Integer\n    lastRowIdx = Worksheets(\"Recipients\").Cells(Rows.Count, \"B\").End(xlUp).Row\n    For rowNum = 2 To lastRowIdx\n        With Worksheets(\"Recipients\")\n            Call CreateOutlookTask(.Cells(rowNum, \"A\"), .Cells(rowNum, \"B\"), 1, .Cells(rowNum, \"C\"))\n            Call CreateOutlookTask(.Cells(rowNum, \"A\"), .Cells(rowNum, \"B\"), 2, .Cells(rowNum, \"D\"))\n            Call CreateOutlookTask(.Cells(rowNum, \"A\"), .Cells(rowNum, \"B\"), 3, .Cells(rowNum, \"E\"))\n        End With\n    Next\nEnd Sub\n</code></pre>\n\n<p>Running the <code>ProcessRecipients()</code> macro within the Excel workbook will create three tasks in Outlook for each recipient listed on the \"Recipients\" sheet. However, the email <em>magic</em> won't happen until the following section is complete.</p>\n\n<h2>Outlook Component Solution</h2>\n\n<p>Two separate actions need to occur within Outlook. The first is the actual sending of emails at nominated times, and the second is looking for and processing the responses.</p>\n\n<p>Automatically processing received emails is made more complicated by the fact the email address of the responder may not be the same as the email address of the originally intended recipient. By placing the intended recipient's email address within the body of the original email, it is highly likely that any response will include the original email and thus include a reference to the originally intended recipient. The automatic processing of emails looks known text within the subject heading string as well as a reference to an originally intended recipient's email address in the received email body.</p>\n\n<p>The following VBA code needs to be placed in a (new) module within Outlook's <code>VbaProject.OTM</code> file. This code will become a rule that will be run whenever an email is received by the Outlook client.</p>\n\n<pre><code>' Create a rule that calls this macro each time an email is received.\n' All tasks that are flagged with the 'AutoSend' category will be searched\n' and the email destination for that task extracted from the task's 'role'\n' field. If the received email explicitly refers to that email address, then\n' the task will be deleted.\n'\n' It cannot be assumed that the sender of a response email will be the same\n' email address as the email used to send the original email (i.e. it could\n' have been forwarded, or simply be an alias for the actual recipient. We\n' must therefore search the body of the response to look for a reference to\n' the originally intended recipient email address.\n'\nSub ProcessAutoEmailResponses(email As MailItem)\n    Dim task As Outlook.TaskItem\n    Dim items As Outlook.items\n    Dim folder As Outlook.MAPIFolder\n    Dim deletedTasks As String\n    Dim autoProcess As Boolean\n\n    autoProcess = False\n    Set folder = Application.Session.GetDefaultFolder(olFolderTasks)\n    Set items = folder.items\n    ' If the incoming email subject contains any of the strings defined\n    '  by an 'AutoReceive' task category subject\n    Set task = items.Find(\"[Categories] ='AutoReceive'\")\n    Do While (Not task Is Nothing) And (autoProcess = False)\n        If (InStr(1, email.Subject, task.Subject) &gt; 0) Then\n            autoProcess = True\n        End If\n        Set task = items.FindNext\n    Loop\n    If (autoProcess = True) Then\n        deletedTasks = \"AutoSend Processing Triggered\"\n        ' loop through all AutoEmail categorised tasks\n        Set task = items.Find(\"[Categories] ='AutoSend'\")\n        Do While (Not task Is Nothing)\n            ' if the email contains a reference to the task's destination email address\n            If (InStr(1, email.Body, task.Role) &gt; 0) Then\n                deletedTasks = deletedTasks &amp; \", Deleted Reminder \" &amp; task.DueDate &amp; \" (\" &amp; task.Subject &amp; \")\"\n                ' delete the task\n                task.Delete\n            End If\n            Set task = items.FindNext\n        Loop\n        ' Insert note to indicate tasks have been deleted\n        email.Body = deletedTasks + vbLf + email.Body\n        email.Subject = \"[AUTOSEND PROCESSED] \" + email.Subject\n        email.Save\n    End If\nEnd Sub\n</code></pre>\n\n<p>A second block of code needs to be placed in the <code>ThisOutlookSession</code> area of the <code>VbaProject.OTM</code> codebase. This code is executed whenever a reminder fires.</p>\n\n<p><em>Note there are several ways to do this, and although I ended up not 'cancelling' the reminder window via this event handler, the <code>BeforeReminderShow</code> event handler is (I believe) the only way to control whether the reminder window is actually made visible as a result of a reminder firing. It might be something you wish to play with further.</em></p>\n\n<pre><code>Private WithEvents olRemind As Outlook.Reminders\n\nPrivate Sub Application_Reminder(ByVal item As Object)\n    Set olRemind = Outlook.Reminders\nEnd Sub\n\n'\n' Auto-dismiss/cancel reminders that would otherwise\n' be displayed for \"AutoSend\" categorised items\n'\nPrivate Sub olRemind_BeforeReminderShow(Cancel As Boolean)\n    Dim reminderObj As Reminder\n    Dim item As TaskItem\n    For Each reminderObj In olRemind\n        If (reminderObj.IsVisible = True) Then\n            If (TypeName(reminderObj.item) = \"TaskItem\") Then\n                If reminderObj.item.Categories = \"AutoSend\" Then\n                    Dim email As MailItem\n                    Set email = Application.CreateItem(olMailItem)\n                    email.To = reminderObj.item.Role\n                    email.Subject = reminderObj.item.Subject\n                    email.Body = reminderObj.item.Body\n                    email.Send\n                    reminderObj.item.ReminderSet = False\n                    reminderObj.item.Save\n                    reminderObj.Dismiss\n                End If\n            End If\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p><strong>Important:</strong> Outlook macros are usually prohibited under the default Outlook configuration. It is best to sign your code and permit the execution of signed macros. Once your code is run once, you can nominate to 'always allow' that code to run, thereby eliminating permission problems.</p>\n\n<p>This blog provides instructions for 'self-signing' your VBA project: <a href=\"http://www.remkoweijnen.nl/blog/2011/01/12/self-signing-word-macros/\" rel=\"nofollow noreferrer\">http://www.remkoweijnen.nl/blog/2011/01/12/self-signing-word-macros/</a>.</p>\n\n<h2>Final Steps</h2>\n\n<p>Create one or more 'tasks' within outlook (no date necessary) that contain the email subject headings as their titles and tag them with a category called 'AutoReceive'. These will control which emails are automatically processed based on the content of their email subject.</p>\n\n<p>You'll now need to set-up a rule within Outlook to run the <code>ProcessAutoEmailResponses(MailItem)</code> method by going to <code>Tools-&gt;Manage Rules and Alerts</code> (or similar, depending on your Outlook version) and creating a rule that runs the method whenever a new email arrives.</p>\n"}], "owner": {"reputation": 1, "user_id": 5167520, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--9Y9tn5v-p4/AAAAAAAAAAI/AAAAAAAAADA/CDWrAd9mkQM/photo.jpg?sz=128", "display_name": "Bearding WithBryan", "link": "https://stackoverflow.com/users/5167520/bearding-withbryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 334, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1438213888, "creation_date": 1438140915, "question_id": 31690783, "link": "https://stackoverflow.com/questions/31690783/automating-emails", "title": "Automating Emails", "body": "<p>My excel spreadsheet has email a number of email addresses in column B that the email is to be sent to and addresses in column E that the email is to be cc to. in A1 I have today's date (which updates) and in B1 I have the date the email needs to be sent and in C1 I have another date 6 months later the email needs to be sent.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Private Sub workbook_Open()\nDim Subject, Send_From, Send_To, cc, body As String\nDim Email_Range, cl, cc_Range, cx As Range\nDim Due_Date, Today_Date, Send_Date As Date\nToday_Date = Range (\"A1\").Text\nDue_Date = Today_Date + 7\nSend_Date = Range (\"B1\").Text\nDim Mail_Object, Mail_Single As Variant\n\nSet Email_Range = Range(\"B3:B14\")\nFor Each cl In Email_Range\n    Sent_To = Send_To &amp; \";\" &amp; cl.Value\nNext\nSend_To = Mid(Send_To, 2)\n\nSet cc_Range = Range(\"E3:E14\")\n    For Each cx In cc_Range\n        cc = cc &amp; \";\" &amp; cx.Value\n    Next\n    cc = Mid(cc, 2)\n\nSubject=\"subject\"\nSend_From=\"me@example.com\"\nBody=\"Please respond by\" &amp; \"Due_Date\" &amp; \"Thank You\"\n\nOn Error GoTo debugs\n\nSet Mai_Object = Create Object (\"Outlook Application\")\nSet Mail_Single - Mail_Object, Create Item(0)\nWith Mail_Single\n    .Subject=Subject\n    .To=Send_To\n    .cc=cc\n    .Body=Body\n    .Send\nEnd With\n\ndebugs:\nIf Err.Description c&gt;\"\" Then Msg Box\nErr.Description\n\nEnd Sub\n</code></pre>\n\n<p>The program will send an email when I run it, but I need the program to send an email on the send date automatically (when due date=send date) and then when someone responds, take them off the email list. Repeat this until everyone has responded and then do it all again the next send date (different cell).</p>\n\n<p>I have no idea where to start as I am pretty knew at this. Does anyone have any ideas?</p>\n"}, {"tags": ["vba", "outlook", "outlook-2010"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1438155532, "post_id": 31690459, "comment_id": 51328672, "body": "Is the email alert that you receive the same email address ?"}, {"owner": {"reputation": 171, "user_id": 5160123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8dccee5705d7d9537cfe5b0e7fd2f3d?s=128&d=identicon&r=PG&f=1", "display_name": "efendimansur", "link": "https://stackoverflow.com/users/5160123/efendimansur"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1438162304, "post_id": 31690459, "comment_id": 51332878, "body": "yes, I receive from same email address. addtionally, I want to keep the original message. I tried using &quot;using a specific template&quot; it not include the original message."}], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 5160123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8dccee5705d7d9537cfe5b0e7fd2f3d?s=128&d=identicon&r=PG&f=1", "display_name": "efendimansur", "link": "https://stackoverflow.com/users/5160123/efendimansur"}, "edited": false, "score": 0, "creation_date": 1438162784, "post_id": 31692267, "comment_id": 51333218, "body": "thank you Eugene for your response. Can you provide the basic tutorial using VBA. I&#39;m not understand about it, so i want to know clearly."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 171, "user_id": 5160123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8dccee5705d7d9537cfe5b0e7fd2f3d?s=128&d=identicon&r=PG&f=1", "display_name": "efendimansur", "link": "https://stackoverflow.com/users/5160123/efendimansur"}, "edited": false, "score": 0, "creation_date": 1438170324, "post_id": 31692267, "comment_id": 51338035, "body": "See <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736%28v=office.14%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Getting Started with VBA in Outlook 2010</a>."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1438149527, "creation_date": 1438149527, "answer_id": 31692267, "question_id": 31690459, "link": "https://stackoverflow.com/questions/31690459/how-to-create-a-rule-for-auto-reply-from-a-specific-sender-subject/31692267#31692267", "title": "How to create a rule for auto reply from a specific sender/subject", "body": "<p>You can setup a rule in Outlook which may trigger a VBA sub. The sub should look like the following one:</p>\n\n<pre><code>Public Sub Test(mail as MailItem)\n  '\nEnd Sub\n</code></pre>\n\n<p>where the mail object represent the incoming email message.</p>\n\n<p>You can use the Outlook object to make any modifications to the item and reply to the item using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff868875.aspx\" rel=\"nofollow\">Reply</a> method. </p>\n\n<p>The Outlook object model provides three main ways for working with item bodies:</p>\n\n<ol>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff865304(v=office.15).aspx\" rel=\"nofollow\">Body</a>.</li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff868941(v=office.15).aspx\" rel=\"nofollow\">HTMLBody</a>.</li>\n<li>The Word editor. The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff868196(v=office.15).aspx\" rel=\"nofollow\">WordEditor</a> property of the Inspector class returns an instance of the Word Document which represents the message body. So, you can use the Word object model do whatever you need with the message body. </li>\n</ol>\n\n<p>See <a href=\"https://msdn.microsoft.com/en-us/library/dd492012%28v=office.12%29.aspx\" rel=\"nofollow\">Chapter 17: Working with Item Bodies</a> for more information.</p>\n"}, {"tags": [], "owner": {"reputation": 76, "user_id": 5152431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aNa0B.png?s=128&g=1", "display_name": "Nico", "link": "https://stackoverflow.com/users/5152431/nico"}, "is_accepted": false, "score": 0, "last_activity_date": 1438155279, "creation_date": 1438155279, "answer_id": 31694040, "question_id": 31690459, "link": "https://stackoverflow.com/questions/31690459/how-to-create-a-rule-for-auto-reply-from-a-specific-sender-subject/31694040#31694040", "title": "How to create a rule for auto reply from a specific sender/subject", "body": "<p>To get the \"branch code\" and the \"PIC\", you can use the following string functions:</p>\n\n<p><code>Replace</code> <a href=\"https://msdn.microsoft.com/de-de/library/bt3szac5(v=VS.90).aspx\" rel=\"nofollow\">link</a> -> write an replay and set for the \"branch code\" and the \"PIC\" a dummy like \"%branch%\" and \"%pic%\". Now you replace these dummy\u2019s with the correct information.<br>\n<code>Left</code> <a href=\"https://msdn.microsoft.com/de-de/library/y050k1wb(v=VS.90).aspx\" rel=\"nofollow\">link</a> <br>\n<code>Right</code> <a href=\"https://msdn.microsoft.com/de-de/library/dxs6hz0a(v=VS.90).aspx\" rel=\"nofollow\">link</a> <br>\n<code>Mid</code> <a href=\"https://msdn.microsoft.com/de-de/library/05e63829(v=VS.90).aspx\" rel=\"nofollow\">link</a> -> The three functions <code>Left</code>, <code>Right</code> and <code>Mid</code> can return a part of a string. use it to extract the correct \"branch code\" and \"PIC\".</p>\n\n<p>Hope it will help you. kind regards, Nico</p>\n"}, {"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 0, "last_activity_date": 1438816416, "last_edit_date": 1438816416, "creation_date": 1438654055, "answer_id": 31799560, "question_id": 31690459, "link": "https://stackoverflow.com/questions/31690459/how-to-create-a-rule-for-auto-reply-from-a-specific-sender-subject/31799560#31799560", "title": "How to create a rule for auto reply from a specific sender/subject", "body": "<p>Create Script rule and call the following vba.</p>\n\n<pre><code>Option Explicit\nPublic Sub Rply(olItem As Outlook.MailItem)\n    Dim olReply As MailItem\n\n    '// Branch A01\n    If InStr(olItem.Subject, \"Connection to Branch A01 is Down\") Then\n        Set olReply = olItem.ReplyAll\n        olReply.Display\n        olReply.Body = \"Dear PIC \" &amp; vbNewLine &amp; vbNewLine &amp; _\n                       \"Based on email alert, Connection to the Branch A01 is down \" &amp; vbNewLine &amp; vbNewLine &amp; _\n                       \"Please restart the modem, etc. \" &amp; vbNewLine &amp; vbNewLine\n        '// Send\n        olReply.Send\n    Else\n        '// Branch A02\n        If InStr(olItem.Subject, \"Connection to Branch A02 is Down\") Then\n            Set olReply = olItem.ReplyAll\n            olReply.Display\n            olReply.Body = \"Dear PIC \" &amp; vbNewLine &amp; vbNewLine &amp; _\n                           \"Based on email alert, Connection to the Branch A02 is down \" &amp; vbNewLine &amp; vbNewLine &amp; _\n                           \"Please restart the modem, etc. \" &amp; vbNewLine &amp; vbNewLine\n            '// Send\n            olReply.Send\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 5160123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8dccee5705d7d9537cfe5b0e7fd2f3d?s=128&d=identicon&r=PG&f=1", "display_name": "efendimansur", "link": "https://stackoverflow.com/users/5160123/efendimansur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2082, "favorite_count": 0, "accepted_answer_id": 31799560, "answer_count": 3, "score": 1, "last_activity_date": 1593070802, "creation_date": 1438138228, "last_edit_date": 1593070802, "question_id": 31690459, "link": "https://stackoverflow.com/questions/31690459/how-to-create-a-rule-for-auto-reply-from-a-specific-sender-subject", "title": "How to create a rule for auto reply from a specific sender/subject", "body": "<p>I receive an email alert from NMS every day when a link/connection to a branch is down. The subject email for all alerts are same, only the branch code is changed.  </p>\n\n<p>For example :</p>\n\n<p>branch code : <code>A01 and A02</code>.</p>\n\n<p>Subject email is <code>\" Connection to Branch A01 is Down \" or \"Connection to Branch A02 is Down\"</code>.</p>\n\n<p>For first handling, I must reply to it and ask the local contact to check devices.</p>\n\n<p>I want to create a rule for auto reply. The body email is the same, but contains different branch code and PIC.</p>\n\n<p>Template for body email is : </p>\n\n<p>Dear <code>\"PIC\"</code>,</p>\n\n<p>based on email alert, Connection to the branch <code>\"A02\"</code> is  down. Please restart the modem, etc.</p>\n\n<p>I want to change PIC and code branch. </p>\n"}, {"tags": ["excel", "vba", "http"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5167456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3215dcdc25641c496faf1d85651277b0?s=128&d=identicon&r=PG&f=1", "display_name": "Mahendra", "link": "https://stackoverflow.com/users/5167456/mahendra"}, "edited": false, "score": 0, "creation_date": 1438240949, "post_id": 31690909, "comment_id": 51372168, "body": "Thanks. The ReadyState property helped me."}, {"owner": {"reputation": 1, "user_id": 5167456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3215dcdc25641c496faf1d85651277b0?s=128&d=identicon&r=PG&f=1", "display_name": "Mahendra", "link": "https://stackoverflow.com/users/5167456/mahendra"}, "edited": false, "score": 0, "creation_date": 1438241378, "post_id": 31690909, "comment_id": 51372395, "body": "Regarding the 2nd question- I am already clearing all contents in excel when I want to transfer a new data to my controller every time. But for example, if I have already sent array of 100 strings to the controller &amp; now I want to send only 50 strings, then other 50 bytes in my controller don&#39;t become 0. so i want to give a button in Excel saying &quot; clear controller data&quot;. When i press that button, I want to send 0 to all the strings (total 3000 in both column A &amp; B). I tried sending data similar to the way I am sending but the excel hangs."}, {"owner": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "reply_to_user": {"reputation": 1, "user_id": 5167456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3215dcdc25641c496faf1d85651277b0?s=128&d=identicon&r=PG&f=1", "display_name": "Mahendra", "link": "https://stackoverflow.com/users/5167456/mahendra"}, "edited": false, "score": 0, "creation_date": 1438252425, "post_id": 31690909, "comment_id": 51379204, "body": "I&#39;m still not following what you mean by &quot;send 0 to all the strings&quot;.  Are you saying you want to make all the cells in columns a and b of excel &quot;0&quot;? Or are you saying you need to send an array containing 100 strings, each consisting of &quot;0&quot;, to your controller?"}, {"owner": {"reputation": 1, "user_id": 5167456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3215dcdc25641c496faf1d85651277b0?s=128&d=identicon&r=PG&f=1", "display_name": "Mahendra", "link": "https://stackoverflow.com/users/5167456/mahendra"}, "edited": false, "score": 0, "creation_date": 1438318060, "post_id": 31690909, "comment_id": 51411143, "body": "Hi. My problem is solved now. I was making some small mistakes in coding.Thanks a lot for your earlier inputs."}], "tags": [], "owner": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "is_accepted": false, "score": 0, "last_activity_date": 1438141682, "creation_date": 1438141682, "answer_id": 31690909, "question_id": 31690414, "link": "https://stackoverflow.com/questions/31690414/http-interface-to-industrial-motion-controller-using-excel-vba/31690909#31690909", "title": "HTTP interface to industrial motion controller using Excel VBA", "body": "<p>Couple of things: \nYou're code is creating a new object for <code>objHTTP</code> in every loop.  This seems like a potential waste of resources.  I would move this statement outside the loop.  Also, next line doesn't use any variables from your loop so there seems to be no point in having it inside the loop either.  </p>\n\n<p>The <code>Open</code> line does need to be in the loop, as per the documentation for <a href=\"https://msdn.microsoft.com/en-us/library/ms754586(v=vs.85).aspx\" rel=\"nofollow\">IServerXMLHTTP</a> the <code>Send</code> method requires both an <code>Open</code> and <code>Send</code> each time.  Being the case, I would move them closer together so it is more obvious what you are doing. </p>\n\n<p>As for checking if the command has completed, you can check the <a href=\"https://msdn.microsoft.com/en-us/library/ms761388(v=vs.85).aspx\" rel=\"nofollow\">ReadyState</a> property. </p>\n\n<p>I'm not <em>entirely</em> sure I grasped what you mean about deleting the previous HTTP commands, but I think you're saying you want to erase them from the excel workbook.  You can use <a href=\"https://msdn.microsoft.com/en-us/library/office/Ff835589.aspx\" rel=\"nofollow\">ClearContents</a> to do that. </p>\n\n<pre><code>  ColumnCountA = Sheets(1).Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n   a3 = 1\n   Set objHTTP = CreateObject(\"MSXML2.ServerXMLHTTP\")\n   URL = \"http://127.0.0.1/kas//plcvariables\"\n\n\n   For a1 = 0 To ColumnCountA - 1   \n\n        a2 = CStr(a1)\n        a4 = CStr(a3)\n\n        strDATA1Array = \"Sample1Array[\" + a2 + \"]=\" + LTrim((Application.ActiveSheet.Range(\"a\" + a4).Value))\n        strDATA2Array = \"Sample2Array[\" + a2 + \"]=\" + LTrim(Str(Application.ActiveSheet.Range(\"b\" + a4).Value))\n\n\n        strSendToKAS = strDATA1Array + \",\" + strDATA2Array + \",\"\n\n        objHTTP.Open \"PUT\", URL, False    \n        objHTTP.send (strSendToKAS)\n\n        'Check if the data transfer is complete\n        Do While objHTTP.ReadyState &lt;&gt; 4\n             Do Events\n        Loop    \n\n        'Do something to inform the user the data transfer has completed  \n        MsgBox(\"The HTTP data transfer has completed\")\n\n        a3 = a3 + 1\n\n   Next\n\n   ColumnCountA.ClearContents\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5167456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3215dcdc25641c496faf1d85651277b0?s=128&d=identicon&r=PG&f=1", "display_name": "Mahendra", "link": "https://stackoverflow.com/users/5167456/mahendra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438143586, "creation_date": 1438137936, "last_edit_date": 1438143586, "question_id": 31690414, "link": "https://stackoverflow.com/questions/31690414/http-interface-to-industrial-motion-controller-using-excel-vba", "title": "HTTP interface to industrial motion controller using Excel VBA", "body": "<p>I am using Excel VBA to communicate with an Industrial Motion Controller using HTTP protocol.\nHere is what I am doing &amp; it is working well.</p>\n\n<hr>\n\n<pre><code>  ColumnCountA = Sheets(1).Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n   a3 = 1\n\n   For a1 = 0 To ColumnCountA - 1\n\n\n        Set objHTTP = CreateObject(\"MSXML2.ServerXMLHTTP\")\n        URL = \"http://127.0.0.1/kas//plcvariables\"\n        objHTTP.Open \"PUT\", URL, False\n\n\n        a2 = CStr(a1)\n        a4 = CStr(a3)\n\n        strDATA1Array = \"Sample1Array[\" + a2 + \"]=\" + LTrim((Application.ActiveSheet.Range(\"a\" + a4).Value))\n        strDATA2Array = \"Sample2Array[\" + a2 + \"]=\" + LTrim(Str(Application.ActiveSheet.Range(\"b\" + a4).Value))\n\n\n        strSendToKAS = strDATA1Array + \",\" + strDATA2Array + \",\"\n\n\n        objHTTP.send (strSendToKAS)\n\n\n        a3 = a3 + 1\n\n   Next\n</code></pre>\n\n<hr>\n\n<p>With above code, I am able to send all contents of Column A &amp; B to the motion controller in form of arrays (strData1Array, strData2Array).</p>\n\n<p>I have below questions-\n1. I want the user to know that this data transfer is completed (the cell count can typically go to 5000. So it takes 8-10 seconds to complete the actual data transfer). Do we get any 'data transfer done' acknowledgement bit at excel side?\n2. I plan to use a button \"Clear data in Motion controller\". After pressing this button, I want all previously sent HTTP data to be reseted to 0. How to do that? I tried pushing 0 in A &amp; B columns but my excel program hangs. Any suggestions?</p>\n"}, {"tags": ["excel", "vba", "user-defined-functions"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1438135365, "post_id": 31689854, "comment_id": 51321637, "body": "How do you plan to handle something like <code>=SUM(A:A)</code> ?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1438136364, "post_id": 31689854, "comment_id": 51321841, "body": "Does it need to be able to span worksheets?  How about formulas with references to other workbooks?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1438148001, "post_id": 31689854, "comment_id": 51324907, "body": "In your posted simplistic case you could likely achieve what you want using the <code>DirectPrecedents</code> property of the Range object."}], "answers": [{"comments": [{"owner": {"reputation": 721, "user_id": 1190899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0b204508fe8c2186d8dbdc97a33c1ad?s=128&d=identicon&r=PG", "display_name": "Chris Stocking", "link": "https://stackoverflow.com/users/1190899/chris-stocking"}, "edited": false, "score": 0, "creation_date": 1438282777, "post_id": 31696959, "comment_id": 51399441, "body": "Good question about why I want to do this. Here&#39;s why: I&#39;m tired of waiting 30+ minutes for the data tables in my spreadsheet to calculate. The data tables that Excel uses for &quot;what if&quot; analysis are incredibly slow. My thinking was that by exploding a formula down to its most basic components, I could easily create a sensitivity table that would calculate much faster than the data tables. That&#39;s easy enough to do by hand when you have a simple formula. But, if it&#39;s a complex analysis, tracing the formula all the way back through is very laborious."}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "reply_to_user": {"reputation": 721, "user_id": 1190899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0b204508fe8c2186d8dbdc97a33c1ad?s=128&d=identicon&r=PG", "display_name": "Chris Stocking", "link": "https://stackoverflow.com/users/1190899/chris-stocking"}, "edited": false, "score": 0, "creation_date": 1438334614, "post_id": 31696959, "comment_id": 51418906, "body": "Data Tables are slow and iterate single-threaded. You can speed them up by a) speeding up the normal XL calculation process b) writing some VBA code that automates the iterative calculation process more efficiently. Contact me offline if you want to explore this further"}], "tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1438163463, "creation_date": 1438163463, "answer_id": 31696959, "question_id": 31689854, "link": "https://stackoverflow.com/questions/31689854/explode-an-excel-formula-into-a-formula-that-relies-only-on-cells-that-dont-ref/31696959#31696959", "title": "Explode an Excel formula into a formula that relies only on cells that don&#39;t refer to other cells", "body": "<p>You would have to build an Excel formula parser and apply it recursively to the formulas referred to by any references found in the original formula. And watch out for circular and repeated references!</p>\n\n<p>There are a few formula parsers around, see for starters:<br>\n<a href=\"http://ewbi.blogs.com/develops/popular/excelformulaparsing.html\" rel=\"nofollow\">http://ewbi.blogs.com/develops/popular/excelformulaparsing.html</a><br></p>\n\n<p>and as a matter of curiosity: why would you want to do this?</p>\n"}], "owner": {"reputation": 721, "user_id": 1190899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0b204508fe8c2186d8dbdc97a33c1ad?s=128&d=identicon&r=PG", "display_name": "Chris Stocking", "link": "https://stackoverflow.com/users/1190899/chris-stocking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1438163463, "creation_date": 1438133831, "last_edit_date": 1438135132, "question_id": 31689854, "link": "https://stackoverflow.com/questions/31689854/explode-an-excel-formula-into-a-formula-that-relies-only-on-cells-that-dont-ref", "title": "Explode an Excel formula into a formula that relies only on cells that don&#39;t refer to other cells", "body": "<p>I'm looking for a way to unpack an excel formula into a formula that depends only cells that don't refer to other cells.</p>\n\n<p><strong>Example:</strong> in the spreadsheet below, cell A1 contains the formula \"B1 + B2\". Meanwhile, cell B1 contains the formula \"C1 + D1\", while B2 contains the formula \"C2 + D2\". Cells C1, C2, D1 and D2 are all constants (in this case, the values 1, 2, 3 and 4).</p>\n\n<p><a href=\"https://i.stack.imgur.com/rfK0f.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rfK0f.png\" alt=\"Example Spreadhseet\"></a></p>\n\n<p><strong>What I want:</strong> I'm looking for a way (either already built into excel, or a user-defined function in VBA), that would function like this:</p>\n\n<blockquote>\n  <p><strong>Call:</strong> =ExplodeFormula(A1)</p>\n  \n  <p><strong>Returns:</strong> \"C1 + D1 + C2 + D2\"</p>\n</blockquote>\n\n<p>Any chance someone can help me out here? Thanks!</p>\n\n<p>(Edit) A few things I think will be needed for this:</p>\n\n<ol>\n<li>Some way to distinguish a cell reference in a formula from the functions used in that formula.</li>\n<li>Some way to distinguish a range reference from a single cell reference (if a cell is referring to a range, like it would in the case of a vlookup, I'd be fine stopping at that level.</li>\n<li>A way to iterate through the portions of the formula identified in parts 1 and 2 and break them down into simpler chunks that are recursively run through the same process.</li>\n</ol>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 5157511, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/19f33d26fe7a8c8edb28fde5543c7381?s=128&d=identicon&r=PG&f=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/5157511/striker"}, "edited": false, "score": 0, "creation_date": 1438137222, "post_id": 31690213, "comment_id": 51322040, "body": "Thank you! But if we want the file name to be the active cell i.e the cell which is selected instead of A1  then what changes we need to do??"}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 237, "user_id": 5157511, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/19f33d26fe7a8c8edb28fde5543c7381?s=128&d=identicon&r=PG&f=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/5157511/striker"}, "edited": false, "score": 0, "creation_date": 1438137276, "post_id": 31690213, "comment_id": 51322055, "body": "Just use <code>ActiveCell</code> in place of <code>Range(&quot;A1&quot;)</code>."}, {"owner": {"reputation": 237, "user_id": 5157511, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/19f33d26fe7a8c8edb28fde5543c7381?s=128&d=identicon&r=PG&f=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/5157511/striker"}, "edited": false, "score": 0, "creation_date": 1438144773, "post_id": 31690213, "comment_id": 51323864, "body": "I used the below syntax: <code>Shell &quot;explorer.exe &#47;select, V:\\Jul\\1st Jul\\File.pdf&quot; &amp; ActiveCell &amp; &quot;&quot;&quot;&quot;, vbNormalFocus</code>. This is opening the users folder when i select the activeCell. Kindly help me where I am going wrong."}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 237, "user_id": 5157511, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/19f33d26fe7a8c8edb28fde5543c7381?s=128&d=identicon&r=PG&f=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/5157511/striker"}, "edited": false, "score": 0, "creation_date": 1438174446, "post_id": 31690213, "comment_id": 51340983, "body": "Why are you using a file path AND <code>ActiveCell</code>? I thought your file path was IN <code>ActiveCell</code>?"}, {"owner": {"reputation": 565, "user_id": 1670466, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/50ef3e7633825fe7a99b253e9d1f04cc?s=128&d=identicon&r=PG", "display_name": "kackleyjm", "link": "https://stackoverflow.com/users/1670466/kackleyjm"}, "edited": false, "score": 0, "creation_date": 1493325248, "post_id": 31690213, "comment_id": 74381780, "body": "Just a heads up notice the coma after /select.  It took me a while to realize my error as usually a space is fine between a switch like that"}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": true, "score": 3, "last_activity_date": 1438136526, "creation_date": 1438136526, "answer_id": 31690213, "question_id": 31689802, "link": "https://stackoverflow.com/questions/31689802/launching-windows-explorer-and-highlighting-a-file/31690213#31690213", "title": "Launching Windows Explorer and highlighting a file", "body": "<p>You can execute <code>explorer.exe</code> with the <code>/select</code> argument:</p>\n\n<pre><code>Shell \"explorer.exe /select,\"\"\" &amp; Range(\"A1\") &amp; \"\"\"\", vbNormalFocus\n</code></pre>\n\n<p>Assuming <code>A1</code> had the path <code>c:\\path\\to\\file.txt</code>, this would look like:</p>\n\n<pre><code>explorer.exe /select,\"c:\\path\\to\\file.txt\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8177968, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1626c3d34ed47ac0a7f4742021eb8c35?s=128&d=identicon&r=PG", "display_name": "lei feng", "link": "https://stackoverflow.com/users/8177968/lei-feng"}, "is_accepted": false, "score": 0, "last_activity_date": 1497762988, "creation_date": 1497762988, "answer_id": 44611951, "question_id": 31689802, "link": "https://stackoverflow.com/questions/31689802/launching-windows-explorer-and-highlighting-a-file/44611951#44611951", "title": "Launching Windows Explorer and highlighting a file", "body": "<p>This works for me</p>\n\n<p>The below will bring up the explorer window with the correct results and finds all files with the word experience in it in the path SSDrive.</p>\n\n<p>Call Shell(\"explorer.exe \"\"search-ms://query=Experience&amp;crumb=folder:\" &amp; sSDrive &amp; \"\"\"\")</p>\n\n<p>@ <a href=\"https://social.msdn.microsoft.com/Forums/windowsdesktop/en-US/a8a0daef-a2e2-4559-a209-d2f263a52b05/searchms-output-results-to-file?forum=windowsdesktopsearchhelp\" rel=\"nofollow noreferrer\">https://social.msdn.microsoft.com/Forums/windowsdesktop/en-US/a8a0daef-a2e2-4559-a209-d2f263a52b05/searchms-output-results-to-file?forum=windowsdesktopsearchhelp</a></p>\n"}], "owner": {"reputation": 237, "user_id": 5157511, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/19f33d26fe7a8c8edb28fde5543c7381?s=128&d=identicon&r=PG&f=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/5157511/striker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2584, "favorite_count": 0, "accepted_answer_id": 31690213, "answer_count": 2, "score": 1, "last_activity_date": 1497762988, "creation_date": 1438133413, "last_edit_date": 1531164843, "question_id": 31689802, "link": "https://stackoverflow.com/questions/31689802/launching-windows-explorer-and-highlighting-a-file", "title": "Launching Windows Explorer and highlighting a file", "body": "<p>Is there a way to open a Windows Explorer window using VBA, navigate to a specific file mentioned in active cell of the Excel sheet, and select it. </p>\n\n<p>For example, Column <code>A</code> has file names to search for and if I select column <code>A1</code> and run the macro, it should open the path/directory and find the file mentioned in <code>A1</code> and only select the file. It should not open it.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 5167182, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-7YWOijAPkpo/AAAAAAAAAAI/AAAAAAAAAAA/PrUwafVWdv8/photo.jpg?sz=128", "display_name": "Chetan Chimate", "link": "https://stackoverflow.com/users/5167182/chetan-chimate"}, "edited": false, "score": 0, "creation_date": 1438210136, "post_id": 31690399, "comment_id": 51362851, "body": "Thank you so much! It was helpful and yes I made that correction &quot;Too many files...&quot; Thanks! I might have more questions coming in."}, {"owner": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "reply_to_user": {"reputation": 69, "user_id": 5167182, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-7YWOijAPkpo/AAAAAAAAAAI/AAAAAAAAAAA/PrUwafVWdv8/photo.jpg?sz=128", "display_name": "Chetan Chimate", "link": "https://stackoverflow.com/users/5167182/chetan-chimate"}, "edited": false, "score": 0, "creation_date": 1438210232, "post_id": 31690399, "comment_id": 51362888, "body": "@ChetanChimate - if you found the answer helpful, the appropriate thanks would be to upvote it (click the little <code>up arrow</code> next to the answer).  If the answer helped you to solve your problem, click the little empty <code>checkmark</code> next to the answer, it will be made green - and I will be thanked. :)"}, {"owner": {"reputation": 69, "user_id": 5167182, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-7YWOijAPkpo/AAAAAAAAAAI/AAAAAAAAAAA/PrUwafVWdv8/photo.jpg?sz=128", "display_name": "Chetan Chimate", "link": "https://stackoverflow.com/users/5167182/chetan-chimate"}, "edited": false, "score": 0, "creation_date": 1438227820, "post_id": 31690399, "comment_id": 51367162, "body": "I did that but it says that it wont display until I earn 15 points or something I new to this site and in fact pretty new to coding and stuff (being a mechanical engineer, never had a chance to explore this fascinating world of coding)."}, {"owner": {"reputation": 69, "user_id": 5167182, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-7YWOijAPkpo/AAAAAAAAAAI/AAAAAAAAAAA/PrUwafVWdv8/photo.jpg?sz=128", "display_name": "Chetan Chimate", "link": "https://stackoverflow.com/users/5167182/chetan-chimate"}, "edited": false, "score": 0, "creation_date": 1438230750, "post_id": 31690399, "comment_id": 51367886, "body": "My next question- after consolidating selected files IN MACRO Book ITSELF using above code, I recorded macro to do conditional formatting. Now I want to force user not to save the macro book, instead after the code is run, it should automatically save that macro file as &quot;Save As&quot; a non macro file using some unique info such as &quot;yyyymmmdd, hhmm.xlsx&quot; asking user where to save. Additionally, it should close macro file without saving it and open the last saved as .xlsx I found some codes, but they are not exactly what I am looking for. Please help."}, {"owner": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "reply_to_user": {"reputation": 69, "user_id": 5167182, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-7YWOijAPkpo/AAAAAAAAAAI/AAAAAAAAAAA/PrUwafVWdv8/photo.jpg?sz=128", "display_name": "Chetan Chimate", "link": "https://stackoverflow.com/users/5167182/chetan-chimate"}, "edited": false, "score": 0, "creation_date": 1438252216, "post_id": 31690399, "comment_id": 51379079, "body": "Start a new question for that"}], "tags": [], "owner": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "is_accepted": false, "score": 0, "last_activity_date": 1438138282, "last_edit_date": 1438138282, "creation_date": 1438137808, "answer_id": 31690399, "question_id": 31689663, "link": "https://stackoverflow.com/questions/31689663/copying-multiple-worksheets-into-vba-workbook-itself/31690399#31690399", "title": "Copying multiple worksheets into VBA workbook itself", "body": "<p>Change your <code>OutBook</code> variable to reference <a href=\"https://msdn.microsoft.com/en-us/library/office/Aa215773(v=office.11).aspx\" rel=\"nofollow\">ThisWorkbook</a>, and change <code>OutSheet</code> to a sheet within this workbook. </p>\n\n<pre><code>'set up the output workbook\nSet OutBook = ThisWorkbook `Workbooks.Add\n</code></pre>\n\n<p>You're probably going to want to add a new sheet:</p>\n\n<pre><code>Set OutSheet = OutBook.Sheets.Add\nOutSheet.Name = \"CombineDataFilesOutput\"\n</code></pre>\n\n<p>If you do this often, you may want to give the sheet a unique ID so you can add multiples without worrying about duplicate sheet names.  I usually use some format of <code>Now()</code> to create a unique identifer:</p>\n\n<pre><code>OutSheet.Name = Format(Now(),\"YYYYMMDDhhmmss\")\n</code></pre>\n\n<hr>\n\n<p>I also noticed your comment on the files selected limit appears to mis-inform the user.  You're telling them \"please pick more than 2000 files\" but should be saying \"please pick no more than 2000 files\" or even better \"please pick less than 2000 files\". </p>\n\n<pre><code>'error trap - don't allow user to pick more than 2000 files\nIf TargetFiles.SelectedItems.Count &gt; MaxNumberFiles Then\n    MsgBox (\"Too many files selected, please pick less than \" &amp;     MaxNumberFiles &amp; \". Exiting sub...\")\nExit Sub\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 5167182, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-7YWOijAPkpo/AAAAAAAAAAI/AAAAAAAAAAA/PrUwafVWdv8/photo.jpg?sz=128", "display_name": "Chetan Chimate", "link": "https://stackoverflow.com/users/5167182/chetan-chimate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 449, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1438206524, "creation_date": 1438132289, "last_edit_date": 1531161705, "question_id": 31689663, "link": "https://stackoverflow.com/questions/31689663/copying-multiple-worksheets-into-vba-workbook-itself", "title": "Copying multiple worksheets into VBA workbook itself", "body": "<p>Below code works perfectly to copy data from an active worksheet of the SPECIFIED workbooks into a NEW unnamed workbook. It copies first row from first file and combines data from the other files excluding first (heading) row with it.</p>\n\n<p>However, I am learning and I would like to know how I can combine the data in the same fashion into the macro workbook itself (and NOT in a new workbook). I intend to do some macro recording after the data is combined inside the same macro book.</p>\n\n<p>Please help me how I can do this. I tried to move/copy the combined sheet from new workbook (one that is generated after running the below code) into the macro workbook and then close new workbook without saving it, but so far no success. Please help.</p>\n\n<pre><code>Option Explicit\nSub CombineDataFiles()\n\nDim DataBook As Workbook, OutBook As Workbook\nDim DataSheet As Worksheet, OutSheet As Worksheet\nDim TargetFiles As FileDialog\nDim MaxNumberFiles As Long, FileIdx As Long, _\n    LastDataRow As Long, LastDataCol As Long, _\n    HeaderRow As Long, LastOutRow As Long\nDim DataRng As Range, OutRng As Range\n\n'initialize constants\nMaxNumberFiles = 2001\nHeaderRow = 1 'assume headers are always in row 1\nLastOutRow = 1\n\n'prompt user to select files\nSet TargetFiles = Application.FileDialog(msoFileDialogOpen)\nWith TargetFiles\n    .AllowMultiSelect = True\n    .Title = \"Multi-select target data files:\"\n    .ButtonName = \"\"\n    .Filters.Clear\n    .Filters.Add \".xlsx files\", \"*.xlsx\"\n    .Show\nEnd With\n\n'error trap - don't allow user to pick more than 2000 files\nIf TargetFiles.SelectedItems.Count &gt; MaxNumberFiles Then\n    MsgBox (\"Too many files selected, please pick more than \" &amp;     MaxNumberFiles &amp; \". Exiting sub...\")\n    Exit Sub\nEnd If\n\n'set up the output workbook\nSet OutBook = Workbooks.Add\nSet OutSheet = OutBook.Sheets(1)\n\n'loop through all files\nFor FileIdx = 1 To TargetFiles.SelectedItems.Count\n\n    'open the file and assign the workbook/worksheet\n    Set DataBook = Workbooks.Open(TargetFiles.SelectedItems(FileIdx))\n    Set DataSheet = DataBook.ActiveSheet\n\n    'identify row/column boundaries\n    LastDataRow = DataSheet.Cells.Find(\"*\", SearchOrder:=xlByRows,     SearchDirection:=xlPrevious).Row\n    LastDataCol = DataSheet.Cells.Find(\"*\", SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Column\n\n    'if this is the first go-round, include the header\n    If FileIdx = 1 Then\n        Set DataRng = Range(DataSheet.Cells(HeaderRow, 1),                     DataSheet.Cells(LastDataRow, LastDataCol))\n        Set OutRng = Range(OutSheet.Cells(HeaderRow, 1),     OutSheet.Cells(LastDataRow, LastDataCol))\n    'if this is NOT the first go-round, then skip the header\n    Else\n        Set DataRng = Range(DataSheet.Cells(HeaderRow + 1, 1), DataSheet.Cells(LastDataRow, LastDataCol))\n        Set OutRng = Range(OutSheet.Cells(LastOutRow + 1, 1), OutSheet.Cells(LastOutRow + 1 + LastDataRow, LastDataCol))\n    End If\n\n    'copy the data to the outbook\n    DataRng.Copy OutRng\n\n    'close the data book without saving\n    DataBook.Close False\n\n    'update the last outbook row\n    LastOutRow = OutSheet.Cells.Find(\"*\", SearchOrder:=xlByRows,     SearchDirection:=xlPrevious).Row\n\nNext FileIdx\n\n'let the user know we're done!\nMsgBox (\"Combined \" &amp; TargetFiles.SelectedItems.Count &amp; \" files!\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["regex", "vba", "excel", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5167175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SsYYE.jpg?s=128&g=1", "display_name": "KnightBrian", "link": "https://stackoverflow.com/users/5167175/knightbrian"}, "edited": false, "score": 0, "creation_date": 1438188959, "post_id": 31689403, "comment_id": 51351575, "body": "Thank you bond for your help. I inserted the correction into my script. It still doesn&#39;t work. I run the script and...nothing. I must have something else screwed up. I will read the reference you sent me. If you have any other suggestions I would like to hear them."}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 11, "user_id": 5167175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SsYYE.jpg?s=128&g=1", "display_name": "KnightBrian", "link": "https://stackoverflow.com/users/5167175/knightbrian"}, "edited": false, "score": 0, "creation_date": 1438189041, "post_id": 31689403, "comment_id": 51351651, "body": "Is it not branching into your <code>If Reg1.test(olMail.Body) Then</code> statement?"}, {"owner": {"reputation": 11, "user_id": 5167175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SsYYE.jpg?s=128&g=1", "display_name": "KnightBrian", "link": "https://stackoverflow.com/users/5167175/knightbrian"}, "edited": false, "score": 0, "creation_date": 1438356747, "post_id": 31689403, "comment_id": 51433607, "body": "Yes. I believe you are correct. It is not branching at all."}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 11, "user_id": 5167175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SsYYE.jpg?s=128&g=1", "display_name": "KnightBrian", "link": "https://stackoverflow.com/users/5167175/knightbrian"}, "edited": false, "score": 0, "creation_date": 1438359664, "post_id": 31689403, "comment_id": 51435240, "body": "Try the regex above. You shouldn&#39;t need to escape forward slashes but you do need to escape dots."}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": false, "score": 1, "last_activity_date": 1438359539, "last_edit_date": 1438359539, "creation_date": 1438130247, "answer_id": 31689403, "question_id": 31689385, "link": "https://stackoverflow.com/questions/31689385/extracting-a-url-using-a-regular-expression/31689403#31689403", "title": "Extracting a URL using a regular expression", "body": "<p>VBScript regex patterns don't use <code>/</code> to indicate the start and end. Nor do they use <code>i</code> or <code>g</code> after the trailing <code>/</code> to indicate case-insensitivety or globalness. Instead, use the <code>IgnoreCase</code> and <code>Global</code> properties.</p>\n\n<p>For example:</p>\n\n<pre><code>With Reg1\n    .Pattern = \"http://www\\.changedetection\\.com/log(.*)\"\n    .IgnoreCase = True\n    .Global = True\nEnd With\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/ms974570.aspx\" rel=\"nofollow\">Here's a great reference</a> if you're looking for more information about the <code>RegExp</code> object.</p>\n"}], "owner": {"reputation": 11, "user_id": 5167175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SsYYE.jpg?s=128&g=1", "display_name": "KnightBrian", "link": "https://stackoverflow.com/users/5167175/knightbrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 834, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1438620654, "creation_date": 1438130083, "last_edit_date": 1438620654, "question_id": 31689385, "link": "https://stackoverflow.com/questions/31689385/extracting-a-url-using-a-regular-expression", "title": "Extracting a URL using a regular expression", "body": "<p>I receive 10 or 12 emails from the same website and I would like to extract a particular URL using regex (if possible) and have it pasted into the correct Excel file. The e-mails are in Outlook and I already have a VBA script (that runs from Outlook VBA) that I used to extract the Subject and Sender. However, I really need that particular URL in each e-mail to be the third piece of information extracted. </p>\n\n<p>I have tried to create a series of steps to:</p>\n\n<ol>\n<li>create the RegEx</li>\n<li>apply the RegEx to the current email</li>\n<li>place the extracted URL into the excel document.</li>\n</ol>\n\n<p>However, whatever I have created fails miserably. The VBA pasted below always worked until I wrote in the additional RegEx part.</p>\n\n<p>I believe I have the correct pattern:</p>\n\n<pre><code>/http:\\/\\/www.changedetection.com\\/log(.*)/ig\n</code></pre>\n\n<p>Whenever I run the new VBA script, it doesn't do anything. The old code always worked. The code is written into This Outlook Session (just to clarify) because the mailitem needs to run from a script.</p>\n\n<pre><code>Const xlUp As Long = -4162\nSub ExportToExcel(MyMail As MailItem)\n\n    Dim strID As String, olNS As Outlook.NameSpace\n    Dim olMail As Outlook.MailItem\n    Dim strFileName As String\n    Dim strBody As String\n    Dim Reg1 As RegExp\n    Dim M1 As MatchCollection\n    Dim M As Match\n\n    Set Reg1 = New RegExp\n    With Reg1\n        .Pattern = \"http://www\\.changedetection\\.com/log(.*)\"\n        .IgnoreCase = True\n        .Global = True\n     End With\n\n    If Reg1.test(olMail.Body) Then\n\n        Set M1 = Reg1.Execute(olMail.Body)\n        For Each M In M1\n        strBody = M.SubMatches(1)\n        Next\n    End If\n\n    '~~&gt; Excel Variables\n    Dim oXLApp As Object, oXLwb As Object, oXLws As Object\n    Dim lRow As Long\n\n    strID = MyMail.EntryID\n    Set olNS = Application.GetNamespace(\"MAPI\")\n    Set olMail = olNS.GetItemFromID(strID)\n\n\n\n    '~~&gt; Establish an EXCEL application object\n    On Error Resume Next\n    Set oXLApp = GetObject(, \"Excel.Application\")\n\n    '~~&gt; If not found then create new instance\n    If Err.Number &lt;&gt; 0 Then\n        Set oXLApp = CreateObject(\"Excel.Application\")\n    End If\n    Err.Clear\n    On Error GoTo 0\n\n    '~~&gt; Show Excel\n    oXLApp.Visible = True\n\n    '~~&gt; Open the relevant file\n    Set oXLwb = oXLApp.Workbooks.Open(\"M:\\Monitor\\Monitor_Test_1.xlsx\")\n\n    '~~&gt; Set the relevant output sheet. Change as applicable\n    Set oXLws = oXLwb.Sheets(\"Test\")\n\n    lRow = oXLws.Range(\"A\" &amp; oXLApp.Rows.Count).End(xlUp).Row + 1\n\n    '~~&gt; Write to outlook\n    With oXLws\n        '\n        '~~&gt; Code here to output data from email to Excel File\n        '~~&gt; For example\n        '\n        .Range(\"A\" &amp; lRow).Value = olMail.Subject\n        .Range(\"B\" &amp; lRow).Value = olMail.SenderName\n        .Range(\"C\" &amp; lRow).Value = strBody\n\n        '\n    End With\n\n    '~~&gt; Close and Clean up Excel\n    oXLwb.Close (True)\n    oXLApp.Quit\n\n    Set Reg1 = Nothing\n    Set oXLws = Nothing\n    Set oXLwb = Nothing\n    Set oXLApp = Nothing\n\n    Set olMail = Nothing\n    Set olNS = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "sorting"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1438130121, "post_id": 31689163, "comment_id": 51320408, "body": "Where are you populating <code>vStrings</code> to begin with and where are you getting the <i>&#39;cherry&#39;</i> value to add to it?"}], "answers": [{"comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1438131688, "post_id": 31689241, "comment_id": 51320796, "body": "This is such a great answer. I&#39;ve read a bit about using .Net classes and would like to know more, such as which ones are available, generally and on any given computer. Do you have any resources to recommend."}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1438132980, "post_id": 31689241, "comment_id": 51321110, "body": "@DougGlancy There&#39;s an <a href=\"https://technet.microsoft.com/en-us/magazine/2007.01.heyscriptingguy.aspx\" rel=\"nofollow noreferrer\">article on The Scripting Guys blog</a> that can help get you started. I&#39;m not sure there&#39;s a comprehensive list of .NET classes with COM wrappers but that article should give you some tips to get started."}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": false, "score": 3, "last_activity_date": 1438129946, "last_edit_date": 1438129946, "creation_date": 1438128982, "answer_id": 31689241, "question_id": 31689163, "link": "https://stackoverflow.com/questions/31689163/adding-to-a-string-array-alphabetically/31689241#31689241", "title": "Adding to a string array alphabetically", "body": "<p>You can use the <code>System.Collections.SortedList</code> class from the <code>.NET</code> library, if you want. Then there's no need to worry about sorting.</p>\n\n<pre><code>Dim objList As Object\nSet objList = CreateObject(\"System.Collections.SortedList\")\nobjList.Add \"apple\",  \"\"\nobjList.Add \"banana\", \"\"\nobjList.Add \"orange\", \"\"\nobjList.Add \"cherry\", \"\"\n\nDim i As Long\nFor i = 0 To objList.Count - 1\n    Debug.Print objList.GetKey(i)\nNext\n</code></pre>\n\n<p>Prints:</p>\n\n<pre><code>apple\nbanana\ncherry\norange\n</code></pre>\n\n<p>If you want to combine the values into a string, just concatenate them as you loop through the values or you can transfer to an array and use <code>Join</code> to create the string:</p>\n\n<pre><code>ReDim a(objList.Count - 1) As String\nDim i As Long\n\nFor i = 0 To objList.Count - 1\n    a(i) = objList.GetKey(i)\nNext\n\n' Combine strings into the format: {\"string1\", \"string2\", \"stringN\"}\nSheet1.Range(\"A1\").Value = \"{\"\"\" &amp; Join(a, \"\"\", \"\"\") &amp; \"\"\"}\"\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1438131581, "last_edit_date": 1438131581, "creation_date": 1438131261, "answer_id": 31689532, "question_id": 31689163, "link": "https://stackoverflow.com/questions/31689163/adding-to-a-string-array-alphabetically/31689532#31689532", "title": "Adding to a string array alphabetically", "body": "<p>It isn't clear where the declaration or assignment of <code>vStrings</code> and <em>'cherry</em>' are  but here is a sub calling the function that appends the array and returns a delimited list (single text value) to Sheet1's A1.</p>\n\n<pre><code>Sub main()\n    Dim string_array As Variant, new_string As String\n\n    string_array = Array(\"apple\", \"banana\", \"orange\")\n    new_string = \"cherry\"\n\n    Sheets(1).Range(\"A1\").Value = add_and_alphabetize(string_array, new_string, sDELIM:=Chr(44))\n\nEnd Sub\n\nFunction add_and_alphabetize(vSTR As Variant, sSTR As String, _\n         Optional sDELIM As String = \";\", Optional bDESC As Boolean = False)\n    Dim i As Long, j As Long, vTMP As Variant\n\n    If CBool(Len(sSTR)) Then\n        ReDim Preserve vSTR(LBound(vSTR) To UBound(vSTR) + 1)\n        vSTR(UBound(vSTR)) = sSTR\n    End If\n\n    For i = LBound(vSTR) To UBound(vSTR) - 1\n        For j = i To UBound(vSTR)\n            If (vSTR(i) &lt; vSTR(j) And bDESC) Or (vSTR(i) &gt; vSTR(j) And Not bDESC) Then\n                vTMP = vSTR(j)\n                vSTR(j) = vSTR(i)\n                vSTR(i) = vTMP\n            End If\n        Next j\n    Next i\n\n    add_and_alphabetize = Join(vSTR, sDELIM)\nEnd Function\n</code></pre>\n\n<p>I've added options to specify the delimiter character (defaulted as a semi-colon) and change the order of the sort.</p>\n"}], "owner": {"reputation": 45, "user_id": 4107630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55900944227db8ea815bad941bfb5e8e?s=128&d=identicon&r=PG&f=1", "display_name": "Rachkay", "link": "https://stackoverflow.com/users/4107630/rachkay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1438134468, "creation_date": 1438128469, "last_edit_date": 1438134468, "question_id": 31689163, "link": "https://stackoverflow.com/questions/31689163/adding-to-a-string-array-alphabetically", "title": "Adding to a string array alphabetically", "body": "<p>I'm looking for a way to add a string (from a cell) to a string array alphabetically. </p>\n\n<p>For instance:</p>\n\n<pre><code>string array = {\"apple\", \"banana\", \"orange\"}\n</code></pre>\n\n<p>add <code>\"cherry\"</code>:</p>\n\n<pre><code>string array = {\"apple\", \"banana\", \"cherry\", \"orange\"}\n</code></pre>\n\n<p>Hence if I do <code>sheets(1).range(\"A1\").value = new string array</code>, the entire array will be in one cell.</p>\n\n<p>I found a function online that sorts selected cells alphabetically, but not sure if it helps in my instance. </p>\n\n<pre><code>Function Alphabetize(vStrings As Variant, separator As String) As String\n\n    Dim v As Variant, vSorted As Variant\n    Dim i As Long, j As Long, n As Long\n    Dim bDone As Boolean\n\n    For Each v In vStrings\n        n = n + 1\n    Next\n    ReDim vSorted(1 To n)\n    ReDim pos(1 To n)\n    For Each v In vStrings\n         i = i + 1\n         vSorted(i) = v\n    Next\n    For j = 2 To n\n         bDone = True\n         For i = 2 To n\n             If vSorted(i) &lt; vSorted(i - 1) Then\n                 v = vSorted(i - 1)\n                 vSorted(i - 1) = vSorted(i)\n                 vSorted(i) = v\n                 bDone = False\n             End If\n         Next\n         If bDone Then Exit For\n    Next\n    For i = 1 To n\n         If vSorted(i) &lt;&gt; \"\" Then\n             If i = 1 Then\n                 Alphabetize = separator &amp; vSorted(i)\n             Else\n                 If vSorted(i) &lt;&gt; vSorted(i - 1) Then Alphabetize = Alphabetize &amp; separator &amp; vSorted(i)\n             End If\n         End If\n    Next\n    Alphabetize = Mid$(Alphabetize, 2)\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "outlook", "outlook-2010"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1438136557, "post_id": 31689035, "comment_id": 51321883, "body": "You may have changed the VBA Project name. Go to Outlook Rules, Edit, re-assign the macro. Also, it should <code>FileName = xlWB.Sheets(1).Range(&quot;B2&quot;).Value</code> And get rid of <code>Application.StatusBar = ...</code>"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1438137045, "post_id": 31689035, "comment_id": 51321990, "body": "You also need to define <code>xlUp</code> in Outlook (<code>Const xlUp = -4162</code>). Since it&#39;s an Excel internal constant."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1438146620, "post_id": 31689035, "comment_id": 51324436, "body": "@PatricK Thanks for looking at the code, I have tried all you suggested and it did not work."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1438146822, "post_id": 31689035, "comment_id": 51324497, "body": "which line is at fault?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1438147285, "post_id": 31689035, "comment_id": 51324663, "body": "@PatricK it is not throwing any Errors in the code but pop up <code>rule in error</code> when I send a test email. could it  be <code>On Error GoTo 0</code> that I commented out? let me run a test again"}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1452282868, "creation_date": 1452282868, "answer_id": 34685031, "question_id": 31689035, "link": "https://stackoverflow.com/questions/31689035/how-to-fix-outlook-script-rule-error/34685031#34685031", "title": "How to fix Outlook script rule Error", "body": "<p>Per Patrick.</p>\n\n<p>You may have changed the VBA Project name. Go to Outlook Rules, Edit, re-assign the macro. </p>\n\n<p>Also, it should <code>FileName = xlWB.Sheets(1).Range(\"B2\").Value</code> And get rid of <code>Application.StatusBar = ...</code> </p>\n\n<p>Thanks...</p>\n"}], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 721, "favorite_count": 0, "accepted_answer_id": 34685031, "answer_count": 1, "score": 0, "last_activity_date": 1593042959, "creation_date": 1438127599, "last_edit_date": 1593042959, "question_id": 31689035, "link": "https://stackoverflow.com/questions/31689035/how-to-fix-outlook-script-rule-error", "title": "How to fix Outlook script rule Error", "body": "<p>I'm trying to run my code using rule script to only processes newly arrived message but it keeps throwing Error</p>\n\n<p><a href=\"https://i.stack.imgur.com/8GD1j.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8GD1j.png\" alt=\"enter image description here\"></a></p>\n\n<p>What am I doing wrong on my code?</p>\n\n<pre><code>Option Explicit\nPublic Sub Test(Item As Outlook.MailItem)\n    Dim xlApp As Excel.Application\n    Dim xlWB As Excel.Workbook\n    Dim xlSheet As Excel.Worksheet\n    Dim vText As Variant\n    Dim sText As String\n    Dim vItem As Variant\n    Dim i As Long\n    Dim rCount As Long\n    Dim XStarted As Boolean\n    Dim FileName As String\n    Dim FilePath As String '// SaveAs CSV File Path\n    Dim sPath As String '// .CSV File Path\n\n    '// the path of the workbook\n    sPath = \"C:\\temp\\temp.csv\"\n\n    On Error Resume Next\n    Set xlApp = GetObject(, \"Excel.Application\")\n\n    If Err &lt;&gt; 0 Then\n        Application.StatusBar = \"Please wait while Excel source is opened ... \"\n        Set xlApp = CreateObject(\"Excel.Application\")\n        XStarted = True\n    End If\n\n'    On Error GoTo 0\n    '// Open the workbook to input the data\n    Set xlWB = xlApp.Workbooks.Open(sPath)\n    Set xlSheet = xlWB.Sheets(\"Report\")\n\n    '// Process received Mail\n    sText = Item.Body\n    vText = Split(sText, Chr(13)) ' Chr(13)) carriage return\n\n    '// Find the next empty line of the worksheet\n    rCount = xlSheet.Range(\"B\" &amp; xlSheet.Rows.Count).End(xlUp).Row\n    rCount = rCount + 1\n\n    '// Check each line of text in the message body\n    For i = UBound(vText) To 0 Step -1\n\n        '// Customer Name\n        If InStr(1, vText(i), \"Customer\") &gt; 0 Then\n            vItem = Split(vText(i), Chr(9)) ' Chr(9) horizontal tab\n            xlSheet.Range(\"A\" &amp; rCount) = Trim(vItem(1))\n        End If\n\n        '// Ref Number\n        If InStr(1, vText(i), \"Order #\") &gt; 0 Then\n            vItem = Split(vText(i), Chr(9))\n            xlSheet.Range(\"B\" &amp; rCount) = Trim(vItem(1))\n        End If\n\n        '// Service Level\n        If InStr(1, vText(i), \"Service Level\") &gt; 0 Then\n            vItem = Split(vText(i), Chr(9))\n            xlSheet.Range(\"J\" &amp; rCount) = Trim(vItem(1))\n        End If\n    Next i\n    FilePath = Environ(\"USERPROFILE\") &amp; \"\\Documents\\Temp\\\"\n    FileName = Sheets(1).Range(\"B2\").Value\n    xlWB.SaveAs FileName:=FilePath &amp; FileName\n\n    '// Close &amp; SaveChanges\n    xlWB.Close SaveChanges:=True\n    If XStarted Then\n        xlApp.Quit\n    End If\n\n    Set xlApp = Nothing\n    Set xlWB = Nothing\n    Set xlSheet = Nothing\n    Set Item = Nothing\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1438124548, "last_edit_date": 1438124548, "creation_date": 1438123773, "answer_id": 31688451, "question_id": 31688378, "link": "https://stackoverflow.com/questions/31688378/excel-formula-to-sum-sequentially-but-only-add-like-employees/31688451#31688451", "title": "Excel - Formula to sum sequentially but only add like employees", "body": "<p>In D2 use this formula based on the <a href=\"https://support.office.com/en-us/article/SUMIFS-function-c9e748f5-7ea7-455d-9406-611cebce642b\" rel=\"nofollow\">SUMIF function</a>.</p>\n\n<pre><code>=sumif(A$2:A2, A2, B$2:B2)\n</code></pre>\n\n<p>The locked starting row for the criteria and summing ranges will grow as it is filled down.</p>\n\n<p>If you are absolutely determined to use <a href=\"https://support.office.com/en-us/article/Using-structured-references-with-Excel-tables-F5ED2452-2337-4F71-BED3-C8AE6D2B276E\" rel=\"nofollow\">structured table references</a>, introduce the <a href=\"https://support.office.com/en-us/article/OFFSET-function-b3958b36-c30b-4fc3-979e-9b9bbfdcf592\" rel=\"nofollow\">OFFSET function</a> to shape the criteria and summing ranges.</p>\n\n<pre><code>=SUMIF(OFFSET([EE No], 0,0,ROW(1:1), 1), [@[EE No]], OFFSET([Hours], 0,0,ROW(1:1), 1))\n</code></pre>\n\n<p>OFFSET is considered a <em>volatile</em> function that recalculates whenever anything in the workbook changes.</p>\n"}, {"tags": [], "owner": {"reputation": 2019, "user_id": 244549, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4e39b233a11ac12c2d92d6b229fc9b88?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/244549/michael"}, "is_accepted": false, "score": 0, "last_activity_date": 1438123952, "creation_date": 1438123952, "answer_id": 31688478, "question_id": 31688378, "link": "https://stackoverflow.com/questions/31688378/excel-formula-to-sum-sequentially-but-only-add-like-employees/31688478#31688478", "title": "Excel - Formula to sum sequentially but only add like employees", "body": "<p>I would switch the reference from a table reference to a mix of absolute and relative references.  By using an absolute reference for the start of a range and a relative reference for the current row that you are on, you can use the <code>SUMIF</code> equation in Excel</p>\n\n<p>In cell <code>E2</code>, type in the following equation and copy and paste it all the way to the bottom, making sure that you have the <code>$</code> around the first cell of the range</p>\n\n<pre><code>=SUMIF($A$2:A2,A2,$B$2:B2) \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5299392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3bd2bf8c84f5606dc382d8785b998cd?s=128&d=identicon&r=PG&f=1", "display_name": "Anudeep", "link": "https://stackoverflow.com/users/5299392/anudeep"}, "is_accepted": false, "score": 0, "last_activity_date": 1441695521, "last_edit_date": 1441695521, "creation_date": 1441686958, "answer_id": 32449338, "question_id": 31688378, "link": "https://stackoverflow.com/questions/31688378/excel-formula-to-sum-sequentially-but-only-add-like-employees/32449338#32449338", "title": "Excel - Formula to sum sequentially but only add like employees", "body": "<p>=SUMIF($A:$A, E2,$B:$B )</p>\n\n<p>In this formula $A:$A considers entire A Column and E2 will be the input cell.Provide the EE No for which you want to calculate the sum in E2.Based on the provided input sum of matched values from entire B column($B:$B) will be displayed.</p>\n\n<p>This can work even if data is added in future.</p>\n"}], "owner": {"reputation": 13, "user_id": 5129322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4fab1fa0c503dc4dc5d574420c1551e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin D. Porter", "link": "https://stackoverflow.com/users/5129322/kevin-d-porter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 245, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1441695521, "creation_date": 1438123444, "last_edit_date": 1531161705, "question_id": 31688378, "link": "https://stackoverflow.com/questions/31688378/excel-formula-to-sum-sequentially-but-only-add-like-employees", "title": "Excel - Formula to sum sequentially but only add like employees", "body": "<p>My manager needs to know when her employees (EE) are reaching overtime.  There are 80+ EEs on the job site so it is crucial for her to be able to see what day the EEs reach 40 hours.  Once I get the Sequential Sum by employee column figured out I will add on straight time and overtime columns but I need to know what day an EE reaches 40 hours first.</p>\n\n<p><strong><em>This is what I'd like the spread sheet to look like:</em></strong></p>\n\n<pre><code>EE No   Hours   Date        Sequential Sum\n5001    8       7/27/2015   8\n5002    8       7/27/2015   8\n5003    10      7/27/2015   10\n5004    10      7/27/2015   10\n5001    8       7/28/2015   16\n5002    8       7/28/2015   16\n5003    10      7/28/2015   20\n5004    10      7/28/2015   20\n5001    7       7/29/2015   23\n5002    7       7/29/2015   23\n5003    10      7/29/2015   30\n5004    10      7/29/2015   30\n5001    8       7/30/2005   31\n5002    10      7/30/2005   33\n5003    10      7/30/2005   40\n5004    11      7/30/2005   41\n5001    10      7/31/2015   41\n5002    10      7/31/2015   43\n5003    10      7/31/2015   50\n</code></pre>\n\n<p>The first 3 columns are keyed in by the manager.  I'm looking for a formula that will sum cumulatively by employee in the Sequential Sum column.  Notice EE 5001 worked 7 hours on 7/29/15, but the cumulative sum for EE 5001 is 23 because 8 hours were worked on 7/27/15 and 7/28/15 each.</p>\n\n<p>I have tried the following without success:</p>\n\n<pre><code>=SUMIF([EE No],\"=[@[EE No]]\",[Hours])\n\n{=SUM(IF([@[EE No]]=[EE No],[@Hours]))}\n</code></pre>\n\n<p>I've experimented with OFFSET, FREQUENCY, MATCH SUMIF and SUMIFS unsuccessfully.  Any help you can provide with this formula will be greatly appreciated.</p>\n\n<p>I'm not opposed to a VBA solution either so long as I can get the correct data back in the table.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1438122376, "post_id": 31687984, "comment_id": 51318061, "body": "Does your list refresh in the background? If so, you need to turn that off so that the Protect line doesn&#39;t run until the refresh has finished."}], "answers": [{"tags": [], "owner": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "is_accepted": false, "score": 0, "last_activity_date": 1438132218, "creation_date": 1438132218, "answer_id": 31689655, "question_id": 31687984, "link": "https://stackoverflow.com/questions/31687984/sheets-protect-command-error/31689655#31689655", "title": "Sheets protect command error", "body": "<p><code>RefreshAll</code> is an asynchronous command (more info here <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838648.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff838648.aspx</a>).  Basically, it will keep running and return control to the caller before it is finished.  You need to make it work in a synchronous mode.</p>\n\n<pre><code>Sub Button1_Click()\n\n  'Disable background updates\n  SetBackgroundConnections False\n\n  Sheets(\"Data\").Unprotect\n  ActiveWorkbook.RefreshAll\n  Sheets(\"Data\").Protect\n\n  'Re-enable background updates\n  SetBackgroundConnections True\n\nEnd Sub\n\nPrivate Sub SetBackgroundConnections(SetOn As Boolean)\n\n  Dim cn As WorkbookConnection\n\n  For Each cn In ActiveWorkbook.Connections\n    cn.OLEDBConnection.BackgroundQuery = SetOn\n  Next\n\n  Set cn = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 5141161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c792a8a7ce6c56165881e86b9dfb0a48?s=128&d=identicon&r=PG&f=1", "display_name": "Heather", "link": "https://stackoverflow.com/users/5141161/heather"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438132218, "creation_date": 1438121320, "last_edit_date": 1531164843, "question_id": 31687984, "link": "https://stackoverflow.com/questions/31687984/sheets-protect-command-error", "title": "Sheets protect command error", "body": "<p>I have an existing workbook with 2 visible sheets. The first sheet has a button users can click to update the data on sheet 2 (which is a sharepoint list that updates automatically).</p>\n\n<p>The ActiveWorkbook.RefreshAll method worked initially, but now that my workbook is being distributed outside of it's initial scope I need to be able to protect it (while still allowing users to refresh data)</p>\n\n<p>Since the Activeworkbook.RefreshAll will not work while the target sheet is protected  I considered using the following:</p>\n\n<pre><code>Sub RefreshDataSheet\n\nSheets(\"Data\").Unprotect\nActiveWorkbook.RefreshAll\nSheets(\"Data\").Protect\n\nEnd Sub\n</code></pre>\n\n<p>Where \"Data\" is the name of sheet with the updated list. This attempt still returns the error that \"The cell or chart that you are trying to change is protected and therefore read-only.\"</p>\n\n<p>Does anyone have experience with this? Typically the unprotect then protect strategy works for me - what am I missing?</p>\n\n<p>Thank you in advance. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1438124448, "post_id": 31687651, "comment_id": 51318807, "body": "You said it worked using a <code>Shell</code> object. Why did you abandon that way of doing it?"}, {"owner": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "edited": false, "score": 0, "creation_date": 1438138949, "post_id": 31687651, "comment_id": 51322487, "body": "Specifically, what does the error message say?  On what line does it occur?  <code>Presentations.Open</code> is a valid call.  If you look at <a href=\"https://msdn.microsoft.com/en-us/library/office/ff746171.aspx\" rel=\"nofollow noreferrer\">the documentation</a>, you&#39;ll see that <code>Filename</code> is the first parameter, and the only required parameter of the argument.  You can omit or keep the <code>Filename:=</code> as that is just a parameter identifier.   When debugging, just before getting to the line with the <code>Presentations.Open</code> method, what is the value of <code>PrgName</code>?  Have you checked this path is valid?  Is the extension correct?"}, {"owner": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "reply_to_user": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1438139060, "post_id": 31687651, "comment_id": 51322511, "body": "@Bond the OP wrote &quot;the file I have &quot;WORKED&quot; fine on mine but will not open PPT presentations on all PC. So I need a different way to open them. &quot;  I am assuming this is why he abandoned the <code>Shell</code> object, but I&#39;m not positive.  @Valhalla_33 - can you post the original code you had?"}, {"owner": {"reputation": 161, "user_id": 4338938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/he6mC.png?s=128&g=1", "display_name": "Valhalla_33", "link": "https://stackoverflow.com/users/4338938/valhalla-33"}, "reply_to_user": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "edited": false, "score": 0, "creation_date": 1438140911, "post_id": 31687651, "comment_id": 51322952, "body": "@CBRF23 Yes that is the reason I abandoned the original code. I cannot be 100% certain the <b>Shell</b> cmd will work everytime as I saw today. I will try an post the original code when back at work.  As for your first comment: it did work on MY pc at work but not on others.  As for the value of <b>PrgName</b> that value is passed (ProgFile) as a path from the calling subroutine and it DOES pass it in full. As you can see PrgName is obtained by extracting the filename from the path and removing the extension. When the program errors out  <b>PrgName</b> DOES have the correct value when I cursor over it."}, {"owner": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "edited": false, "score": 0, "creation_date": 1438141815, "post_id": 31687651, "comment_id": 51323152, "body": "At exactly what line do you get the error?  What is the exact error message?"}, {"owner": {"reputation": 161, "user_id": 4338938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/he6mC.png?s=128&g=1", "display_name": "Valhalla_33", "link": "https://stackoverflow.com/users/4338938/valhalla-33"}, "edited": false, "score": 0, "creation_date": 1438142012, "post_id": 31687651, "comment_id": 51323194, "body": "objPPT.Presentations.Open FileName:=&quot;S:\\Lab\\EHS\\SAFETY\\&quot; &amp; PrgName &amp; &quot;\\PPT\\&quot; &amp; PrgName &amp; &quot;.ppt&quot;"}, {"owner": {"reputation": 161, "user_id": 4338938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/he6mC.png?s=128&g=1", "display_name": "Valhalla_33", "link": "https://stackoverflow.com/users/4338938/valhalla-33"}, "reply_to_user": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "edited": false, "score": 0, "creation_date": 1438142085, "post_id": 31687651, "comment_id": 51323215, "body": "@CBRF23 will post original code in a minute. Found a copy of it at home."}, {"owner": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "edited": false, "score": 0, "creation_date": 1438145027, "post_id": 31687651, "comment_id": 51323933, "body": "Have you tried <code>objPPT.Presentations.Open  progFile</code>?  Your original script  was specifying the file to open as this argument, why did you change it ?"}, {"owner": {"reputation": 161, "user_id": 4338938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/he6mC.png?s=128&g=1", "display_name": "Valhalla_33", "link": "https://stackoverflow.com/users/4338938/valhalla-33"}, "reply_to_user": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "edited": false, "score": 0, "creation_date": 1438175769, "post_id": 31687651, "comment_id": 51341879, "body": "@CBRF23 That fails to.  Error now is **Method &#39;Open&#39; of Object &#39;Presentations&#39; Failed"}, {"owner": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "edited": false, "score": 0, "creation_date": 1438175883, "post_id": 31687651, "comment_id": 51341975, "body": "That&#39;s not a very helpful error message :/ can you screenshot the folder where the file exists?"}, {"owner": {"reputation": 161, "user_id": 4338938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/he6mC.png?s=128&g=1", "display_name": "Valhalla_33", "link": "https://stackoverflow.com/users/4338938/valhalla-33"}, "edited": false, "score": 0, "creation_date": 1438181616, "post_id": 31687651, "comment_id": 51346503, "body": "No idea how to post a image. Sorry. If I knew how to PM you I might b able to do it that way."}, {"owner": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "edited": false, "score": 0, "creation_date": 1438187852, "post_id": 31687651, "comment_id": 51350907, "body": "In your original post, you can edit it, there is an insert image button.  Or, just go to imgur.com, click upload image, ctrl-v to upload the screenshot from clipboard, and the comment back here with a link."}], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 4338938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/he6mC.png?s=128&g=1", "display_name": "Valhalla_33", "link": "https://stackoverflow.com/users/4338938/valhalla-33"}, "edited": false, "score": 0, "creation_date": 1438958491, "post_id": 31769034, "comment_id": 51678433, "body": "I Am not trying to <b>PASTE</b> anything from Excel to the PPT file. I am trying to Open an existing PPT file <b>FROM</b> Excel."}], "tags": [], "owner": {"reputation": 389, "user_id": 3387046, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/569dfbe91a3c66c3542c21b4952785dc?s=128&d=identicon&r=PG&f=1", "display_name": "user3387046", "link": "https://stackoverflow.com/users/3387046/user3387046"}, "is_accepted": false, "score": -1, "last_activity_date": 1438495254, "creation_date": 1438495254, "answer_id": 31769034, "question_id": 31687651, "link": "https://stackoverflow.com/questions/31687651/cant-open-powerpoint-presentation-from-excel/31769034#31769034", "title": "Can&#39;t open Powerpoint presentation from Excel", "body": "<p>You may want to check <a href=\"http://www.excel-premiumutilities.com\" rel=\"nofollow\">EzPaste</a> for automating the process of pasting from Excel to PPT</p>\n"}], "owner": {"reputation": 161, "user_id": 4338938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/he6mC.png?s=128&g=1", "display_name": "Valhalla_33", "link": "https://stackoverflow.com/users/4338938/valhalla-33"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 540, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1438495254, "creation_date": 1438119800, "last_edit_date": 1438142601, "question_id": 31687651, "link": "https://stackoverflow.com/questions/31687651/cant-open-powerpoint-presentation-from-excel", "title": "Can&#39;t open Powerpoint presentation from Excel", "body": "<p>I have a file that works fine on my pc running Win XP, Excel 2003. PowerPoint resides in Office 11. Needed to go to another PC same Files but PowerPoint is in Office 10.  The file I have \"WORKED\" fine on mine but will not open PPT presentations on all PC. So I need a different way to open them. I was using a Shell call to open and that was good. I found a snippet from Ron DeBruin which kind of works. It partially fails on the open though. Here is the code that is important. PowerPoint Does open as an application but the file itself does not open IN the Application. I get an <strong>Automation Error</strong> and in the same popup <strong>Unspecified Error</strong>. Is there a better way for Excel to find where PowerPoint resides and open it that way?</p>\n\n<pre><code>    Public Sub Start_Viewer(ProgFile)\n\n      Dim objPPT As Object\n      Dim PrgName As String\n\n      Set objPPT = CreateObject(\"PowerPoint.Application\")\n      objPPT.Visible = True\n\n      PrgName = Mid(ProgFile, InStrRev(ProgFile, \"\\\") + 1, InStrRev(ProgFile, \".\") - InStrRev(ProgFile, \"\\\") - 1)\n\n      objPPT.Presentations.Open FileName:=\"S:\\Lab\\EHS\\SAFETY\\\" &amp; PrgName &amp; \"\\PPT\\\" &amp; PrgName &amp; \".ppt\"\n      Workbooks.Open FileName:=\"S:\\Lab\\EHS\\SAFETY\\\" &amp; PrgName &amp; \"\\Quizzes\\\" &amp; PrgName &amp; \" Quiz.xls\"\n\n    End Sub\n</code></pre>\n\n<p><strong>objPPT.Presentations.Open</strong> is the part that fails. I added <strong>FileName</strong> aafter open as I saw it in another post someplace. It fails with or without that.</p>\n\n<p>Original working code for MY PC only.</p>\n\n<pre><code>      Public Sub Start_Viewer(ProgFile)\n\n      '  This works for PowerPoint in this location only and on my work PC\n      '  It fails on other pcs at work when PowerPoint resides elsewhere.\n\n      '  ProgFile is the path passed from the calling subroutine _\n         and opens the PowwerPoint Presentation for that file\n      RetVal = Shell(\"C:\\Program Files\\Microsoft Office\\Office\\PPTView.exe \" &amp; Chr(34) &amp; ProgFile &amp; Chr(34), 1)\n\n      Watched = MsgBox(\"Have you finished the presentation?\", vbYesNo, \"Verify Presentation Watched\")\n        Select Case 6\n                 ' PrgName is JUST the extracted FileName (no path no extension) to give me folder names\n                 PrgName = Mid(ProgFile, InStrRev(ProgFile, \"\\\") + 1, InStrRev(ProgFile, \".\") - InStrRev(ProgFile, \"\\\") - 1)\n                 Workbooks.Open FileName:=\"S:\\Lab\\EHS\\SAFETY\\\" &amp; PrgName &amp; \"\\Quizzes\\\" &amp; PrgName &amp; \"Quiz.xls\"\n               Case 7\n                 Exit Sub\n        End Select\n      End Sub\n</code></pre>\n"}, {"tags": ["string", "vba", "excel"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1438116885, "post_id": 31686862, "comment_id": 51315566, "body": "<code>Mid(s,1,8)</code> should work"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1438116900, "post_id": 31686862, "comment_id": 51315574, "body": "Yes - use <code>Left$(Range(&quot;A1&quot;).Value, 8)</code> in VBA or <code>=LEFT(A1,8)</code> as a formula."}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1438121784, "post_id": 31686862, "comment_id": 51317849, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/2543225/how-to-get-a-particular-part-of-a-string\">How to get a particular part of a String</a>"}], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 0, "last_activity_date": 1438117044, "creation_date": 1438117044, "answer_id": 31686936, "question_id": 31686862, "link": "https://stackoverflow.com/questions/31686862/take-only-part-of-a-string-in-vba/31686936#31686936", "title": "Take only part of a string in VBA", "body": "<p>You are looking for <code>Mid</code>:</p>\n\n<p>If <code>s = \"MS15-077[3077657]\"</code></p>\n\n<p>Then <code>Mid(s,1,8) = \"MS15-077\"</code></p>\n\n<p>Or, as Rory pointed out, <code>Left</code> works as well and is specifically tailored for extracting substrings which appear on the left of the original string.</p>\n"}], "owner": {"reputation": 435, "user_id": 2203108, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/95f0c30d8d1db970ffef597a0b5eba79?s=128&d=identicon&r=PG&f=1", "display_name": "Spance", "link": "https://stackoverflow.com/users/2203108/spance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1359, "favorite_count": 0, "accepted_answer_id": 31686936, "answer_count": 1, "score": -2, "last_activity_date": 1438117044, "creation_date": 1438116791, "question_id": 31686862, "link": "https://stackoverflow.com/questions/31686862/take-only-part-of-a-string-in-vba", "title": "Take only part of a string in VBA", "body": "<p>So I have this string in Excel: MS15-077[3077657]</p>\n\n<p>and I just want to take the first part, MS15-077 to use to compare against other strings. Is there a way to just take the first 8 characters of the cell contents and set that as a variable?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1438119362, "post_id": 31686806, "comment_id": 51316811, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/22331311/combining-data-from-multiple-workbooks-into-a-master\">Combining data from multiple workbooks into a master</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1096, "user_id": 5144555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c0f1046a519313e19ad3929479ec85?s=128&d=identicon&r=PG&f=1", "display_name": "Michael S Priz", "link": "https://stackoverflow.com/users/5144555/michael-s-priz"}, "edited": false, "score": 0, "creation_date": 1438121664, "post_id": 31687545, "comment_id": 51317786, "body": "@Jonathan this looks like what you want!"}, {"owner": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "edited": false, "score": 0, "creation_date": 1438183836, "post_id": 31687545, "comment_id": 51348195, "body": "Thanks for much for this!  So is the only thing I am changing is the directory name? I am having trouble executing this macro, sorry im a newb lol"}, {"owner": {"reputation": 641, "user_id": 1693288, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/bW9K0.png?s=128&g=1", "display_name": "Pho3nixHun", "link": "https://stackoverflow.com/users/1693288/pho3nixhun"}, "edited": false, "score": 0, "creation_date": 1438190255, "post_id": 31687545, "comment_id": 51352377, "body": "Basically you can change any string in this example above, but the only must is directory in line 5. Make sure that string ends with a  \\ and directory exists."}, {"owner": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "edited": false, "score": 0, "creation_date": 1438192307, "post_id": 31687545, "comment_id": 51353564, "body": "@Pho3nixHun ,thanks works! so do I run them individually or at once? if so how do I do them all at once?"}, {"owner": {"reputation": 641, "user_id": 1693288, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/bW9K0.png?s=128&g=1", "display_name": "Pho3nixHun", "link": "https://stackoverflow.com/users/1693288/pho3nixhun"}, "edited": false, "score": 0, "creation_date": 1438253458, "post_id": 31687545, "comment_id": 51379897, "body": "<code>Sub YourSub(master_wb As Workbook, source_wb As Workbook)</code> is something you have to modify. There you can implement your logic to harvest data out of your workbooks. <code>master_wb</code> is the wb you will put data and <code>source_wb</code> is where you get data from. All other logic is up to you."}, {"owner": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "edited": false, "score": 0, "creation_date": 1438263469, "post_id": 31687545, "comment_id": 51386751, "body": "@Pho3nixHun, thanks! I see, these are all individual macros that do different things. How can I combine this with my code to do the loop through directory and apply to master workbook?"}, {"owner": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "edited": false, "score": 0, "creation_date": 1438270081, "post_id": 31687545, "comment_id": 51391736, "body": "Only the run sub is running when I click run macro, when i highlight another sub im not getting anywhere."}, {"owner": {"reputation": 641, "user_id": 1693288, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/bW9K0.png?s=128&g=1", "display_name": "Pho3nixHun", "link": "https://stackoverflow.com/users/1693288/pho3nixhun"}, "edited": false, "score": 0, "creation_date": 1448116985, "post_id": 31687545, "comment_id": 55453659, "body": "Since any other Sub needs at least one parameter, you will not be able to run them with the &quot;\u25ba&quot; button. I suggest you to try to understand basic programming first. (Routines, Functions, variables, parameter-passing, objects, maybe OOP ...etc)."}], "tags": [], "owner": {"reputation": 641, "user_id": 1693288, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/bW9K0.png?s=128&g=1", "display_name": "Pho3nixHun", "link": "https://stackoverflow.com/users/1693288/pho3nixhun"}, "is_accepted": true, "score": 2, "last_activity_date": 1438178096, "last_edit_date": 1438178096, "creation_date": 1438119346, "answer_id": 31687545, "question_id": 31686806, "link": "https://stackoverflow.com/questions/31686806/vba-code-for-directory-and-paste-to-master-sheet/31687545#31687545", "title": "VBA code for Directory and Paste to Master Sheet", "body": "<p>Both of your requests can be done: (See my comments)</p>\n\n<pre><code>Sub Main()\n    'Turn off alerts like \"Do you really want to quit?\"\n    Application.DisplayAlerts = False\n\n    Call LoopThroughDirectory(\"D:\\Private\\Excel\\\", \"*.xls*\")\n\n    'Turn alerts on\n    Application.DisplayAlerts = True\nEnd Sub\n\nSub LoopThroughDirectory(dirPath As String, filter As String)\n    Dim filename\n    'Loop throug all of the files in the given directory\n    filename = Dir(dirPath &amp; filter)\n    Do While Len(filename) &gt; 0\n        ' Filename variable contains the name of the file in the directory\n        ' (dirPath &amp; Filename) will be the full path to the file\n\n        ' Lets call here another Sub which will open up workbooks for us.\n        OpenAnotherWorkbook (dirPath &amp; filename)\n\n        'Move on to the next file\n        filename = Dir\n    Loop\nEnd Sub\n\nSub OpenAnotherWorkbook(filePath As String)\n    'Your master workbook to copy to\n    Dim master_wb As Workbook\n    Set master_wb = ThisWorkbook\n\n    'Your source workbook to copy from\n    Dim source_wb As Workbook\n    Set source_wb = Application.Workbooks.Open(filePath)\n\n    'Call your subroutine\n    Call YourSub(master_wb, source_wb)\n\n    'Close source workbook after everything is done\n    source_wb.Close\nEnd Sub\n\nSub YourSub(master_wb As Workbook, source_wb As Workbook)\n    ' Do your stuff here\n    '   For example:\n\n    'Find your master sheet\n    Dim master_ws As Worksheet\n    Set master_ws = GetOrCreateWorksheet(master_wb, \"YourSheetName\")\n\n    Dim source_ws As Worksheet\n    Set source_ws = source_wb.Sheets(1)\n\n    'Lets save some data from the another workbook to the master one.\n    Dim lastRowNo As Integer\n    lastRowNo = master_ws.UsedRange.Rows.Count\n    'If lastRowNo is 1 that means the worksheet is empty or only the headers had been initialized\n    If lastRowNo = 1 Then\n        'Create headers for the columns\n        master_ws.Cells(lastRowNo, 1).Value = \"Workbook\"\n        master_ws.Cells(lastRowNo, 2).Value = \"Worksheet\"\n    End If\n    'Give some value to the next empty row's first and second cell\n    'Source workbook's name\n    master_ws.Cells(lastRowNo + 1, 1).Value = source_wb.Name\n    'Source worksheet's name\n    master_ws.Cells(lastRowNo + 1, 2).Value = source_ws.Name \n\nEnd Sub\n\nFunction GetOrCreateWorksheet(wb As Workbook, wsName As String) As Worksheet\n    Dim ws As Worksheet\n    'Loop through each sheet to find yours\n    For Each ws In wb.Sheets\n        If ws.Name = wsName Then\n            'If found return with it\n            Set GetOrCreateWorksheet = ws\n            Exit Function\n        End If\n    Next ws\n\n    'If not exists, create one and return with it\n    Set ws = wb.Sheets.Add\n    ws.Name = wsName\n    Set GetOrCreateWorksheet = ws\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "accepted_answer_id": 31687545, "answer_count": 1, "score": 0, "last_activity_date": 1438277814, "creation_date": 1438116614, "last_edit_date": 1438277814, "question_id": 31686806, "link": "https://stackoverflow.com/questions/31686806/vba-code-for-directory-and-paste-to-master-sheet", "title": "VBA code for Directory and Paste to Master Sheet", "body": "<p>So i have the following macro, which extracts unique values from column C of a workbook with multiple sheets and pastes it to a new page. I do realize their is another question similar, but I do not understand it. Is there a way to:</p>\n\n<p>1) do this amongst a directory of files?</p>\n\n<p>2) put new values into a master sheet instead of just making a new sheet in each file:</p>\n\n<pre><code> Sub extractuniquevalues()\nDim wks As Excel.Worksheet\nDim wksSummary As Excel.Worksheet\n'----------------------------------------------------------------------------------\n\nOn Error Resume Next\nSet wksSummary = Excel.ThisWorkbook.Worksheets(\"Unique data\")\nOn Error GoTo 0\n\nIf wksSummary Is Nothing Then\n    Set wksSummary = Excel.ThisWorkbook.Worksheets.Add\n    wksSummary.Name = \"Unique data\"\nEnd If\n\n\n'Iterate through all the worksheets, but skip [Summary] worksheet.\nFor Each wks In Excel.ActiveWorkbook.Worksheets\n\n    With wksSummary\n\n        If wks.Name &lt;&gt; .Name Then\n            If Application.WorksheetFunction.CountA(wks.Range(\"C:C\")) Then\n                Call wks.Range(\"C:C\").AdvancedFilter(xlFilterCopy, , .Cells(.Cells(.Rows.Count, 1).End(xlUp).Row + 1, 1), True)\n            End If\n        End If\n\n    End With\n\nNext wks\n\n End Sub\n</code></pre>\n\n<p>Any help would be Greatly Appreciated, Thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 175, "user_id": 5152545, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2a915e73e126408742609a3da5e5938e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex664", "link": "https://stackoverflow.com/users/5152545/alex664"}, "reply_to_user": {"reputation": 4085, "user_id": 4185106, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/er5li.png?s=128&g=1", "display_name": "moffeltje", "link": "https://stackoverflow.com/users/4185106/moffeltje"}, "edited": false, "score": 0, "creation_date": 1438116102, "post_id": 31686571, "comment_id": 51315130, "body": "It is O, the letter, as in the value in Cell &quot;O7&quot; Sorry for the confusion"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1438119738, "post_id": 31686571, "comment_id": 51316961, "body": "Sadly, there is no such thing as <a href=\"https://support.office.com/en-gb/article/EXACT-function-243e2bc1-93d6-4fd5-9608-dc3c5b8c046b\" rel=\"nofollow noreferrer\">exact</a> in Excel. See <a href=\"https://support.microsoft.com/en-us/kb/78113\" rel=\"nofollow noreferrer\">Floating-point arithmetic may give inaccurate results in Excel</a>."}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 5152545, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2a915e73e126408742609a3da5e5938e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex664", "link": "https://stackoverflow.com/users/5152545/alex664"}, "edited": false, "score": 1, "creation_date": 1438116832, "post_id": 31686671, "comment_id": 51315538, "body": "Thank you! It fixed it perfectly."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 175, "user_id": 5152545, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2a915e73e126408742609a3da5e5938e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex664", "link": "https://stackoverflow.com/users/5152545/alex664"}, "edited": false, "score": 0, "creation_date": 1438178463, "post_id": 31686671, "comment_id": 51344007, "body": "Hurray!  If you&#39;re going to be using those cell&#39;s values more than once, I recommend creating a variable and setting the values to that variable, it&#39;ll make the code a little easier to debug/read."}, {"owner": {"reputation": 175, "user_id": 5152545, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2a915e73e126408742609a3da5e5938e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex664", "link": "https://stackoverflow.com/users/5152545/alex664"}, "edited": false, "score": 1, "creation_date": 1438178935, "post_id": 31686671, "comment_id": 51344365, "body": "That is exactly what I did with those values inside the StrComp command. I am very new to excel VBA and haven&#39;t heard of that command yet, so thank you!"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1438116120, "creation_date": 1438116120, "answer_id": 31686671, "question_id": 31686571, "link": "https://stackoverflow.com/questions/31686571/check-if-one-cell-contains-the-exact-same-data-as-another-cell-vba/31686671#31686671", "title": "Check if one cell contains the EXACT same data as another cell VBA", "body": "<p>Try using <a href=\"http://www.techonthenet.com/excel/formulas/strcomp.php\" rel=\"nofollow\">Strcomp()</a></p>\n\n<p><code>If StrComp (Sheets(\"Sheet3\").Cells(x,2).Value,Sheets(\"Sheet3\").Cells(7,\"O\").Value) = 0 Then ...</code>  </p>\n\n<p>When StrComp is 0, it means an exact match.</p>\n"}], "owner": {"reputation": 175, "user_id": 5152545, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2a915e73e126408742609a3da5e5938e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex664", "link": "https://stackoverflow.com/users/5152545/alex664"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8433, "favorite_count": 0, "accepted_answer_id": 31686671, "answer_count": 1, "score": 1, "last_activity_date": 1438116120, "creation_date": 1438115758, "question_id": 31686571, "link": "https://stackoverflow.com/questions/31686571/check-if-one-cell-contains-the-exact-same-data-as-another-cell-vba", "title": "Check if one cell contains the EXACT same data as another cell VBA", "body": "<p>I have an Excel Sheet with Column A and a Column B filled with data.</p>\n\n<pre><code>B    C       (columns)\n1   1a       (row 1 is here)\n2   3\n3   4\n4   4a\n4a  5\n5   5a\n5a  6\n6   6a\n6a  6b\n6b  10\n10  11\n11  12\n12  13\n13  14\n14  15\n15  16\n16  16a\n16a 16b\n16b 16c\n16c OUT\n7   7a\n7a  8\n8   9\n9   6\n</code></pre>\n\n<p>I want to say \"If data in cell B7 equals the exact same data entered into cell O7, then execute statement. If it doesn't, go to next cell and retrieve that value, then [perform other statements]\"</p>\n\n<p>The problem with what I have tried, is that even if a cell has a \"4\" in it and I want to find the the cell starting with exactly \"4a,\" it still starts with the cell that contains just \"4\" because there is a 4 in \"4a\" </p>\n\n<p>Example:</p>\n\n<pre><code>For x = 7 \n    If Sheets(\"Sheet3\").Cells(x, 2).Value = Sheets(\"Sheet3\").Cells(7, \"O\").Value\n        [execute statement]\n</code></pre>\n\n<p>If \"O7\" is set equal to \"4a\", it looks up the first value in B with a \"4\" in it instead of exactly \"4a\"</p>\n\n<p>Is there a special function or command to make my code find the exact value and not just the first cell with part of the value in it?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "excel", "events"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1438115824, "post_id": 31686542, "comment_id": 51314970, "body": "You will need to create a class to manage the event capture.  See here <a href=\"http://www.cpearson.com/excel/Events.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/Events.aspx</a>  about half-way down the page."}, {"owner": {"reputation": 1083, "user_id": 1261440, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b7dfce3abaafe5f3e16cb31cf7df6940?s=128&d=identicon&r=PG", "display_name": "paul590", "link": "https://stackoverflow.com/users/1261440/paul590"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1438123638, "post_id": 31686542, "comment_id": 51318533, "body": "Thank you for guiding me in this direction. However I do have a question, it talks about creating a class but also mentions that I will need to add the withEvent object but it wont be possible to add this since i am adding everything on the module, or am I misunderstanding?"}], "answers": [{"comments": [{"owner": {"reputation": 1083, "user_id": 1261440, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b7dfce3abaafe5f3e16cb31cf7df6940?s=128&d=identicon&r=PG", "display_name": "paul590", "link": "https://stackoverflow.com/users/1261440/paul590"}, "edited": false, "score": 0, "creation_date": 1438180003, "post_id": 31688784, "comment_id": 51345256, "body": "Thank you for this example! It helps me a lot. I have a question regarding this new workbook class, before creating the class when NewBook was created as a workbook, I could use NewBook.Sheets(&quot;sheet2&quot;). Now after making Newbook as new clsWB, I tried NewBook.Workbook.Sheets(&quot;sheet2&quot;) and receive a invalid use of property error, why is it that I cant use .workbook.sheets?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1083, "user_id": 1261440, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b7dfce3abaafe5f3e16cb31cf7df6940?s=128&d=identicon&r=PG", "display_name": "paul590", "link": "https://stackoverflow.com/users/1261440/paul590"}, "edited": false, "score": 1, "creation_date": 1438181211, "post_id": 31688784, "comment_id": 51346183, "body": "Do you mean <code>AddNew</code> ?  That reference should work as long as you&#39;re within the Tester sub.   If you want to reference the workbook later, you can add a Getter to the class to return the Workbook property so you can work with it.  I&#39;ll update my code a little later to show how that would look."}, {"owner": {"reputation": 1083, "user_id": 1261440, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b7dfce3abaafe5f3e16cb31cf7df6940?s=128&d=identicon&r=PG", "display_name": "paul590", "link": "https://stackoverflow.com/users/1261440/paul590"}, "edited": false, "score": 0, "creation_date": 1438182362, "post_id": 31688784, "comment_id": 51347086, "body": "Sorry for the confusion, I meant to use owb.workbook.sheets(&quot;sheet2&quot;).cell(x,y).value to get the cell value or set the cell value. Ive tried using the following getter : <code>code</code> Public Property Get Workbook() As Workbook     Workbook = m_wb End Property"}, {"owner": {"reputation": 1083, "user_id": 1261440, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b7dfce3abaafe5f3e16cb31cf7df6940?s=128&d=identicon&r=PG", "display_name": "paul590", "link": "https://stackoverflow.com/users/1261440/paul590"}, "edited": false, "score": 0, "creation_date": 1438182437, "post_id": 31688784, "comment_id": 51347137, "body": "But i get an error saying the variable has not been set. Thank you for all the help"}, {"owner": {"reputation": 1083, "user_id": 1261440, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b7dfce3abaafe5f3e16cb31cf7df6940?s=128&d=identicon&r=PG", "display_name": "paul590", "link": "https://stackoverflow.com/users/1261440/paul590"}, "edited": false, "score": 0, "creation_date": 1438186274, "post_id": 31688784, "comment_id": 51349923, "body": "Awesome that did it! I was missing the set workbook part. Thank you very much for your help!"}, {"owner": {"reputation": 1083, "user_id": 1261440, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b7dfce3abaafe5f3e16cb31cf7df6940?s=128&d=identicon&r=PG", "display_name": "paul590", "link": "https://stackoverflow.com/users/1261440/paul590"}, "edited": false, "score": 0, "creation_date": 1438189318, "post_id": 31688784, "comment_id": 51351831, "body": "I had one last question regarding this, will the class keep the event listening all the time? it seems to be only doing it when the module is run and then when i try to do something manually on the worksheets nothing happens"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1083, "user_id": 1261440, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b7dfce3abaafe5f3e16cb31cf7df6940?s=128&d=identicon&r=PG", "display_name": "paul590", "link": "https://stackoverflow.com/users/1261440/paul590"}, "edited": false, "score": 1, "creation_date": 1438190180, "post_id": 31688784, "comment_id": 51352329, "body": "It should keep listening as long as the oWB object is in-scope and there&#39;s no other problem with your code such as an error which ends up resetting the VBA project state."}, {"owner": {"reputation": 1083, "user_id": 1261440, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b7dfce3abaafe5f3e16cb31cf7df6940?s=128&d=identicon&r=PG", "display_name": "paul590", "link": "https://stackoverflow.com/users/1261440/paul590"}, "edited": false, "score": 0, "creation_date": 1438191371, "post_id": 31688784, "comment_id": 51353026, "body": "Great! I ve noticed that I am only able to add worbook related events on this class is there a way to add for example a change event so that it shows me which cell was changed? instead of a wokbook_sheetChange?"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 4, "last_activity_date": 1438208546, "last_edit_date": 1438208546, "creation_date": 1438125792, "answer_id": 31688784, "question_id": 31686542, "link": "https://stackoverflow.com/questions/31686542/addign-an-event-for-another-wb-from-a-module/31688784#31688784", "title": "Addign an Event for another WB from a module", "body": "<p>Here's a simple example:</p>\n\n<p>In Class module named \"clsWB\":</p>\n\n<pre><code>Option Explicit\n\nPrivate WithEvents m_wb As Workbook\n\nPublic Property Set Workbook(wb As Workbook)\n    Set m_wb = wb\nEnd Property\n\n'EDIT: added Getter for workbook\nPublic Property Get Workbook() As Workbook\n    Set Workbook = m_wb\nEnd Property\n\nPrivate Sub m_wb_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\n    MsgBox \"You selected \" &amp; Target.Address() &amp; \" on '\" &amp; Sh.Name &amp; \"'\"\n    '... or however you want to respond to the trapped event\nEnd Sub\n\n'EDIT2: trap sheet changes\nPrivate Sub m_wb_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n    MsgBox \"You changed \" &amp; Target.Address() &amp; _\n           \" to \" &amp; Target.Value &amp; _\n           \" on '\" &amp; Sh.Name &amp; \"'\"\n    '... or however you want to respond to the trapped event\nEnd Sub\n</code></pre>\n\n<p>In a regular module:</p>\n\n<pre><code>Option Explicit\n\nDim oWb As New clsWB\n\nSub Tester()\n    Dim AddNew As Workbook, ns As Long\n\n    ns = Application.SheetsInNewWorkbook 'save default\n    Application.SheetsInNewWorkbook = 2\n    Set AddNew = Workbooks.Add()\n    Application.SheetsInNewWorkbook = ns 'restore previous default\n\n    AddNew.SaveAs Filename:=\"test.xls\"\n\n    Application.EnableEvents = True 'make sure events are enabled\n    Set oWb.Workbook = AddNew\n\n    'EDIT: set value in workbook\n    oWb.Workbook.Sheets(\"sheet2\").Cells(x,y).Value = \"Test\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1083, "user_id": 1261440, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b7dfce3abaafe5f3e16cb31cf7df6940?s=128&d=identicon&r=PG", "display_name": "paul590", "link": "https://stackoverflow.com/users/1261440/paul590"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 539, "favorite_count": 1, "accepted_answer_id": 31688784, "answer_count": 1, "score": 0, "last_activity_date": 1438208546, "creation_date": 1438115649, "question_id": 31686542, "link": "https://stackoverflow.com/questions/31686542/addign-an-event-for-another-wb-from-a-module", "title": "Addign an Event for another WB from a module", "body": "<p>This question might have been answered already but I cant seem to find the answer I am looking for. I am creating a module which when called it creates a new workbook and transfers information from this workbook to the new one. I would like to add an event to that new work book using this macro but had no luck. Currently I have the following:</p>\n\n<pre><code>Public Sub TemplateCreate()\nDim NewBook as Workbook\nset NewBook = addnew\nEnd Sub\n\nFunction Addnew() as Object\nApplication.SheetsInNewWorkbook = 2\nApplication.EnableEvents = True\nSet AddNew = Workbooks.Add\n    With AddNew\n        .SaveAs Filename:=\"test.xls\"\n    End With\nEnd function\n</code></pre>\n\n<p>The Above code works great, but when Adding dim withEvents Newbook as workbook I receive an error: Only valid on Object module. Is there a similar line of code to make it work for a module?</p>\n\n<p>I tried adding the following event function with no luck of making it work:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n'Tried changing between target and thisWB\nIf thisWB.Sheets(\"sheet1\").Cells.Count = 1 And IsEmpty(thisWB.Sheets(\"sheet1\")) Then thisWB.Sheets(\"sheet1\").Interior.Color = vbBlue\nEnd Sub\n</code></pre>\n\n<p>Thank you for your help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 801, "user_id": 2970747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16141144c3868597857e6ac4a03f2e32?s=128&d=identicon&r=PG&f=1", "display_name": "PermaNoob", "link": "https://stackoverflow.com/users/2970747/permanoob"}, "edited": false, "score": 0, "creation_date": 1438115931, "post_id": 31686305, "comment_id": 51315043, "body": "Have you tried connecting to the Access database via Microsoft Query instead? That would allow you to use parameters directly within Excel instead of having to change anything via VBA."}, {"owner": {"reputation": 21, "user_id": 5166609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d1e040b2e8a11aac6d2152a03f74f2?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/5166609/josh"}, "reply_to_user": {"reputation": 801, "user_id": 2970747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16141144c3868597857e6ac4a03f2e32?s=128&d=identicon&r=PG&f=1", "display_name": "PermaNoob", "link": "https://stackoverflow.com/users/2970747/permanoob"}, "edited": false, "score": 0, "creation_date": 1438116021, "post_id": 31686305, "comment_id": 51315090, "body": "I have never tried that.  I will look into doing this.  Do you think it will address my problem or is this a general process change that you are recommending?"}, {"owner": {"reputation": 801, "user_id": 2970747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16141144c3868597857e6ac4a03f2e32?s=128&d=identicon&r=PG&f=1", "display_name": "PermaNoob", "link": "https://stackoverflow.com/users/2970747/permanoob"}, "edited": false, "score": 0, "creation_date": 1438116874, "post_id": 31686305, "comment_id": 51315557, "body": "Mostly a general process change. It does use a different method of connecting, though, so it&#39;s possible that it may fix your issue as well."}, {"owner": {"reputation": 21, "user_id": 5166609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d1e040b2e8a11aac6d2152a03f74f2?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/5166609/josh"}, "reply_to_user": {"reputation": 801, "user_id": 2970747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16141144c3868597857e6ac4a03f2e32?s=128&d=identicon&r=PG&f=1", "display_name": "PermaNoob", "link": "https://stackoverflow.com/users/2970747/permanoob"}, "edited": false, "score": 0, "creation_date": 1438119245, "post_id": 31686305, "comment_id": 51316754, "body": "I&#39;m thinking that the connection itself may not be the issue since it works sometimes and doesn&#39;t work other times.  I could be wrong on this though."}, {"owner": {"reputation": 801, "user_id": 2970747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16141144c3868597857e6ac4a03f2e32?s=128&d=identicon&r=PG&f=1", "display_name": "PermaNoob", "link": "https://stackoverflow.com/users/2970747/permanoob"}, "edited": false, "score": 0, "creation_date": 1438120363, "post_id": 31686305, "comment_id": 51317248, "body": "I have no way of proving this, but it&#39;s possible that the file is using &quot;relative&quot; file paths to access the database. When you save it to another location, that would mess it up. Closing and opening Excel again would reset the workbook&#39;s file path, allowing it to function again. It sounds reasonable to me, but like I said before, I have no way of proving it."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1438132544, "post_id": 31686305, "comment_id": 51320994, "body": "Josh, it would be helpful to see VBA code. This line concerns me: &quot;I have some VBA which updates the SQL of the Access query.&quot; Be sure this dynamic query is effectively finished updating before running any Excel process that connects to it."}, {"owner": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "edited": false, "score": 0, "creation_date": 1438139199, "post_id": 31686305, "comment_id": 51322547, "body": "@josh -  please post your code so we can help diagnose the problem."}, {"owner": {"reputation": 21, "user_id": 5166609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d1e040b2e8a11aac6d2152a03f74f2?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/5166609/josh"}, "edited": false, "score": 0, "creation_date": 1438201072, "post_id": 31686305, "comment_id": 51358647, "body": "Hi Parfait, good thought.  I&#39;m thinking that if the problem is a result of the VBA not having sufficient time to update the MS Access query&#39;s SQL then I should be able to refresh the table after waiting a sufficient amount of time.  However, I have ruled this out because no amount of waiting allows for the table to be refreshed.  The only fix I have found thus far is to exit out of every single Excel workbook that is currently open and then re-enter the workbook in question."}, {"owner": {"reputation": 21, "user_id": 5166609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d1e040b2e8a11aac6d2152a03f74f2?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/5166609/josh"}, "edited": false, "score": 0, "creation_date": 1438201388, "post_id": 31686305, "comment_id": 51358823, "body": "PermaNoob - I had not considered the possibility of relative paths.  Could you please elaborate on this as I am not familiar with that concept.  I do explicitly direct the table to the database via a full network path and database name - as in, not a mapped drive.  Would this make a difference?"}], "owner": {"reputation": 21, "user_id": 5166609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d1e040b2e8a11aac6d2152a03f74f2?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/5166609/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1054, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1438200797, "creation_date": 1438114853, "last_edit_date": 1531161705, "question_id": 31686305, "link": "https://stackoverflow.com/questions/31686305/excel-table-connection-will-only-refresh-if-i-close-and-reopen-the-workbook", "title": "Excel table connection will only refresh if I close and reopen the workbook", "body": "<p>I am running Excel 2010 and I have a table which is connected to a MS Access 2010 query.  I have some VBA which updates the SQL of the Access query.  Then when I refresh the Excel table the data for the specified date range is returned.  </p>\n\n<p>This typically works just fine.  However, a part of the monthly process is to Save As the workbook into a new folder under a new name each month.  At that point, I can no longer refresh the Excel table.  I receive the following error:</p>\n\n<blockquote>\n  <p>Run-time error '1004':<BR><BR>\n  The query did not run, or the database table could not be opened.<BR><BR>\n  Check the database server or contact your database administrator.  Make sure the external database is available and hasn't been moved or reorganized, then try the operation again.</p>\n</blockquote>\n\n<p>If I close out of all my Excel workbooks and get back into the workbook in question the refresh works fine.  </p>\n\n<p>In order to avoid the closing and reopening I would like to identify and resolve the true cause of the error.</p>\n\n<p>Some fixes that I have read about on this site and ruled out are as follows</p>\n\n<p>Background Refresh<br>\nIt is and always has been set to false</p>\n\n<p>Database permissions <br>\nI feel pretty confident this is not the issue because the credentials are not changed by my closing and reopening the workbook yet my ability to refresh the Excel table does change.</p>\n\n<p>If anybody has any thoughts on what may be going wrong here I would greatly appreciate the assistance.  A solution involving VBA would be perfectly fine as well.</p>\n\n<p>Troublesome code:</p>\n\n<pre><code>Sub RunQueries()\n\nActiveWorkbook.RefreshAll\n\nEnd Sub\n</code></pre>\n\n<p>I will point out that I do not believe this to be a VBA issue.  Even when I try to manually refresh the table within Excel I receive the error.  Running the query from within MS Access works fine.</p>\n"}, {"tags": ["vba", "outlook", "attachment"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": -1, "last_activity_date": 1438118609, "creation_date": 1438118609, "answer_id": 31687369, "question_id": 31685767, "link": "https://stackoverflow.com/questions/31685767/save-attachments-from-specific-sender-into-a-specific-files-on-computer-based-on/31687369#31687369", "title": "Save attachments from specific sender into a specific files on computer based on certain words in the attachment", "body": "<p>Outlook allows to create a rule which can trigger a VBA macro where you are free to do whatever you need. The VBA sub should look like the following one:</p>\n\n<pre><code>Public Sub Test(mail as MailItem)\n   '\nEnd Sub\n</code></pre>\n\n<p>where the <code>mail</code> object represent the incoming message.</p>\n\n<p>I'd recommend starting from the <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736%28v=office.14%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Getting Started with VBA in Outlook 2010</a> article in MSDN. </p>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff866435.aspx\" rel=\"nofollow\">Attachments</a> property of the MailItem class returns an Attachments object that represents all the attachments for the specified item.</p>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff862398.aspx\" rel=\"nofollow\">DisplayName</a> property of the Attachment class allows to set a string representing the name, which does not need to be the actual file name, displayed below the icon representing the embedded attachment. </p>\n\n<p>For example:</p>\n\n<pre><code> Set myAttachments = myItem.Attachments \n 'Prompt the user for confirmation \n Dim strPrompt As String \n strPrompt = \"Are you sure you want to save the first attachment \" &amp; _ \n             \"in the current item to the Documents folder? If a file with the \" &amp; _ \n             \"same name already exists in the destination folder, \" &amp; _ \n             \"it will be overwritten with this copy of the file.\" \n If MsgBox(strPrompt, vbYesNo + vbQuestion) = vbYes Then \n   myAttachments.Item(1).SaveAsFile Environ(\"HOMEPATH\") &amp; \"\\My Documents\\\" &amp; _ \n   myAttachments.Item(1).DisplayName \n End If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5166549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8293fac5b561cdf6270fbe275a438cd7?s=128&d=identicon&r=PG&f=1", "display_name": "Bismark22", "link": "https://stackoverflow.com/users/5166549/bismark22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1906, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1592699596, "creation_date": 1438112948, "last_edit_date": 1592699596, "question_id": 31685767, "link": "https://stackoverflow.com/questions/31685767/save-attachments-from-specific-sender-into-a-specific-files-on-computer-based-on", "title": "Save attachments from specific sender into a specific files on computer based on certain words in the attachment", "body": "<p>I want to trigger a macro when a new email from a specific email address with an .xls (sometime other) attachment is received in an inbox.</p>\n\n<p>What I would like to do is the following is create a rule that:</p>\n\n<p>When the sender is : <code>\"xyz\"</code>, </p>\n\n<p>1.check for a certain word in the attachment for example : \"<code>trade</code>\", then save it into a certain folder.</p>\n\n<p>2.If the attachment is : \"<code>LossesOfTrades</code> \"has another word : \"<code>Losses</code>\", save into another folder.</p>\n\n<p>3.Format all saved files to have its name followed by the year-mm-dd \nex: trade20150725.xls. (note that the attached file doesn't have the date in it) </p>\n\n<ol start=\"4\">\n<li>Mark the e-mail as read.</li>\n</ol>\n\n<p>It is important to note that some files have more than 1 attachment.</p>\n"}]