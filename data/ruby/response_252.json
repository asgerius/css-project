[{"tags": ["ruby-on-rails", "ruby", "rubygems", "google-cloud-automl"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 9333993, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CDCjZrlFzN4/AAAAAAAAAAI/AAAAAAAAACM/eDUL9q4isw4/photo.jpg?sz=128", "display_name": "Lyriaaw", "link": "https://stackoverflow.com/users/9333993/lyriaaw"}, "is_accepted": false, "score": 0, "last_activity_date": 1573162806, "creation_date": 1573162806, "answer_id": 58757277, "question_id": 58739625, "link": "https://stackoverflow.com/questions/58739625/google-automl-ruby-gem-tables-invalid-string-to-assign-to-submessage-field/58757277#58757277", "title": "Google AutoML Ruby Gem Tables: Invalid String to assign to submessage field &#39;&#39;", "body": "<p>I actually found the solution...</p>\n\n<p>You need to provide the kind of data you are passing.\nInstead of </p>\n\n<pre><code>values: [\n      DATA_1,\n      DATA_2,\n      DATA_3,\n      DATA_4\n    ]\n</code></pre>\n\n<p>I should have </p>\n\n<pre><code>values: [\n      {string_value: DATA_1},\n      {string_value: DATA_2},\n      {string_value: DATA_3},\n      {string_value: DATA_4}\n    ]\n</code></pre>\n\n<p>(and you can have string_value, number_value and some other kind, i think the full list is <a href=\"https://developers.google.com/protocol-buffers/docs/reference/google.protobuf?&amp;_ga=2.83721302.-1532970742.1573064538#google.protobuf.Value\" rel=\"nofollow noreferrer\">here</a>)</p>\n"}], "owner": {"reputation": 11, "user_id": 9333993, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CDCjZrlFzN4/AAAAAAAAAAI/AAAAAAAAACM/eDUL9q4isw4/photo.jpg?sz=128", "display_name": "Lyriaaw", "link": "https://stackoverflow.com/users/9333993/lyriaaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 219, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1573162806, "creation_date": 1573080863, "question_id": 58739625, "link": "https://stackoverflow.com/questions/58739625/google-automl-ruby-gem-tables-invalid-string-to-assign-to-submessage-field", "title": "Google AutoML Ruby Gem Tables: Invalid String to assign to submessage field &#39;&#39;", "body": "<p>I'm trying to use the AutoML prediction service from the Ruby gem <code>google-cloud-automl</code> and I keep getting errors. I already have a deployed model working with the online predictions.</p>\n\n<p>Here is my current code:</p>\n\n<pre><code>payload = {\n  row: {\n    column_spec_ids: %w(COLUMN_NUMBER_1 COLUMN_NUMBER_2 COLUMN_NUMBER_3 COLUMN_NUMBER_4),\n    values: [\n      DATA_1,\n      DATA_2,\n      DATA_3,\n      DATA_4\n    ]\n  }\n}\n\nclient = Google::Cloud::AutoML::Prediction.new(version: :v1beta1)\nresponse = client.predict(formatted_model_path, payload)\n</code></pre>\n\n<p>and I receive this error: </p>\n\n<pre><code>Google::Protobuf::TypeError: Invalid type String to assign to submessage field ''.\nfrom path/to/my/vendor/bundle/ruby/2.5.0/gems/google-gax-1.8.1/lib/google/gax/util.rb:65:in `initialize'\n</code></pre>\n\n<p>(In my code, COLUMN_NUMBER_1 to _4 are actually real ID ant DATA_1 to _4 are strings)\n<code>formatted_model_path</code> is the path of my model. I was able to access an NLP model earlier with this code (I only updated the payload format)</p>\n\n<p>I've already tried to generate a Google::Cloud::AutoML::V1beta1::Row . I'm able to fill the column_spec_ids but every time I try this code</p>\n\n<pre><code>request = Google::Cloud::AutoML::V1beta1::Row.new\nrequest.values = payload[:row][:values]\n</code></pre>\n\n<p>I get this error</p>\n\n<pre><code>Google::Protobuf::TypeError: Expected repeated field array\nfrom (pry):4:in `method_missing'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "testing"], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 2394970, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1bf447cf1afc783b4b4e6ecd9ab292f7?s=128&d=identicon&r=PG", "display_name": "lost9123193", "link": "https://stackoverflow.com/users/2394970/lost9123193"}, "edited": false, "score": 0, "creation_date": 1573079820, "post_id": 58739420, "comment_id": 103768845, "body": "OH. that makes so much more sense... I&#39;l look into that. Thanks a lot!"}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 1, "last_activity_date": 1573079402, "creation_date": 1573079402, "answer_id": 58739420, "question_id": 58739279, "link": "https://stackoverflow.com/questions/58739279/testing-a-method-in-rails/58739420#58739420", "title": "Testing a method in Rails", "body": "<p><code>@is_valid_animal</code> is never initialized in your test, so it's <code>nil</code>, that's why you see the error <code>undefined method ... for nil:NilClass</code>. You should create an object under test first and then call methods on that. </p>\n\n<p>When you call <code>object.send(\"Beluga\")</code>, a message \"Beluga\" is sent to the <code>object</code> and it tries to invoke a method named <code>Beluga</code>. If it fails to find it in default case it raises an error of <code>undefined method Beluga</code></p>\n\n<p>Your test should look more like:</p>\n\n<pre><code>  test \"valid animal\" do\n    verifier = AnimalVerifier.new(last_sync_at, force_sync_ids) # you need to init those thow params that are passed to the constructor\n    valid_animal = verifier.is_valid_animal(\"Beluga\")\n    assert valid_animal, \"valid animal\"\n    puts valid_animal.errors unless valid_animal.errors.empty?\n  end\n</code></pre>\n\n<p>Note that I removed the question marks that were appended to method and variable names.</p>\n"}], "owner": {"reputation": 7358, "user_id": 2394970, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1bf447cf1afc783b4b4e6ecd9ab292f7?s=128&d=identicon&r=PG", "display_name": "lost9123193", "link": "https://stackoverflow.com/users/2394970/lost9123193"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 58739420, "answer_count": 1, "score": 0, "last_activity_date": 1573079427, "creation_date": 1573078504, "last_edit_date": 1573079427, "question_id": 58739279, "link": "https://stackoverflow.com/questions/58739279/testing-a-method-in-rails", "title": "Testing a method in Rails", "body": "<p>I'm writing my first test in rails and I have a method which checks if the name passed through the animal object is valid. (Will return the name if valid or <code>nil</code> if not) </p>\n\n<p>animal_verifier.rb</p>\n\n<pre><code># frozen_string_literal: true\n\n    class AnimalVerifier\n      def initialize(last_sync_at, force_sync_ids)\n        @last_sync_at = last_sync_at\n        @force_sync_ids = force_sync_ids\n      end\n\n      def valid_animals\n        animals.each do |animal|\n          if !is_valid_animal(animal.name)\n            Rails.logger.info(\"Invalid animal name\")\n            next\n          end\n        end\n      end\n\n      def is_valid_animal(animal_name)\n        animal = AnimalFinder.find(animal_name)\n      end\n\n    end\n</code></pre>\n\n<p>animal_verifier_test.rb</p>\n\n<pre><code>require 'test_helper'\n\nclass AnimalVerifierTest &lt; ActiveSupport::TestCase\n\n  test \"valid animal\" do\n    valid_animal = @is_valid_animal.send(\"Beluga\")\n    assert valid_animal?, \"valid animal\"\n    puts valid_animal.errors unless valid_animal.errors.empty?\n  end\n\n  test \"invalid animal\" do\n    valid_animal = @is_valid_animal.send(\"Puddle\")\n    assert valid_animal?, \"invalid animal\"\n    puts valid_animal.errors unless valid_animal.errors.empty?\n  end\nend\n</code></pre>\n\n<p>When I run this test I get the error:</p>\n\n<pre><code>NoMethodError:         NoMethodError: undefined method `Beluga' for nil:NilClass\n</code></pre>\n\n<p>Does this mean I don't have a class for <code>AnimalVerifier</code>? I just want to test the specific method.  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "vagrant"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1573082624, "post_id": 58739232, "comment_id": 103769610, "body": "Please don&#39;t summarize answers in your question. The question is for just that."}], "answers": [{"tags": [], "owner": {"reputation": 1488, "user_id": 319862, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/958741385e2fb41a350d041527ec5c90?s=128&d=identicon&r=PG", "display_name": "user319862", "link": "https://stackoverflow.com/users/319862/user319862"}, "is_accepted": false, "score": 0, "last_activity_date": 1573082183, "last_edit_date": 1573082183, "creation_date": 1573080807, "answer_id": 58739613, "question_id": 58739232, "link": "https://stackoverflow.com/questions/58739232/how-to-make-ruby-time-out-a-http-request-after-x-time-elapsed/58739613#58739613", "title": "How to make Ruby time-out a HTTP request after X time elapsed", "body": "<p><strong>Answer was provided to me by al2o3-cr on #ruby at freenode irc:</strong></p>\n\n<p><a href=\"https://gist.github.com/gr33n7007h/d041f4fbc08f0e065854bb180330c3ac\" rel=\"nofollow noreferrer\">https://gist.github.com/gr33n7007h/d041f4fbc08f0e065854bb180330c3ac</a></p>\n\n<pre><code>NETWORK_PROXY_NEEDED = \nbegin\n  Socket.tcp(TEST_HOST, 80, connect_timeout: 1)&amp;.close\n  false\nrescue Errno::ETIMEDOUT\n  true\nend\n</code></pre>\n"}], "owner": {"reputation": 1488, "user_id": 319862, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/958741385e2fb41a350d041527ec5c90?s=128&d=identicon&r=PG", "display_name": "user319862", "link": "https://stackoverflow.com/users/319862/user319862"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573082741, "creation_date": 1573078256, "last_edit_date": 1573082741, "question_id": 58739232, "link": "https://stackoverflow.com/questions/58739232/how-to-make-ruby-time-out-a-http-request-after-x-time-elapsed", "title": "How to make Ruby time-out a HTTP request after X time elapsed", "body": "<p>I am trying to detect if a Vagrant host is connected locally to the network I need to access.  If not, I want to require and configure a proxy so that I can download some internal resources required to build the project.</p>\n\n<p>How do I make a HTTP request that times out after a given number of seconds regardless of success or failure?</p>\n\n<p>I would expect the following code to return 1 or 2 seconds for the time elapsed:</p>\n\n<pre><code>HTTP_NETWORK_TEST_HOST = '172.16.0.1'\n\nstart1 = Time.now\nbegin\n    http = Net::HTTP.new(HTTP_NETWORK_TEST_HOST, '80')\n    http.read_timeout = 2\n    http.open_timeout = 2\n    response = http.start do |http|\n        http.get('/')\n    end\n    NETWORK_PROXY_NEEDED = false\nrescue Timeout::Error =&gt; e\n    NETWORK_PROXY_NEEDED = true\nend\nfinish1 = Time.now\n\nstart2 = Time.now\nbegin\n    Timeout::timeout(1) {\n        http = Net::HTTP.new(HTTP_NETWORK_TEST_HOST, '80')\n        response = http.start do |http|\n            http.get('/')\n        end\n    }\n    NETWORK_PROXY_NEEDED = false\nrescue\n    NETWORK_PROXY_NEEDED = true\nend\nfinish2 = Time.now\n\n\nstart3 = Time.now\nbegin\n    http = Net::HTTP.start(HTTP_NETWORK_TEST_HOST, '80', {read_timeout: 5, open_timeout: 5})\n    response =  http.get('/')\n    NETWORK_PROXY_NEEDED = false\nrescue Timeout::Error =&gt; e\n    NETWORK_PROXY_NEEDED = true\nend\nfinish3 = Time.now\n\n\nputs 'time 1'\nputs finish1 - start1\n\nputs 'time 2'\nputs finish2 - start2\n\nputs 'time 3'\nputs finish3 - start3\n</code></pre>\n\n<p>Results in:</p>\n\n<pre><code>time 1\n21.003133\ntime 2\n21.012332\ntime 3\n21.009758\n</code></pre>\n\n<p><strong>Answer was provided to me by al2o3-cr on #ruby at freenode irc:</strong></p>\n\n<p><a href=\"https://gist.github.com/gr33n7007h/d041f4fbc08f0e065854bb180330c3ac\" rel=\"nofollow noreferrer\">https://gist.github.com/gr33n7007h/d041f4fbc08f0e065854bb180330c3ac</a></p>\n\n<pre><code>NETWORK_PROXY_NEEDED = \nbegin\n  Socket.tcp(TEST_HOST, 80, connect_timeout: 1)&amp;.close\n  false\nrescue Errno::ETIMEDOUT\n  true\nend\n</code></pre>\n"}, {"tags": ["ruby", "testing", "capybara", "minitest"], "answers": [{"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 1, "last_activity_date": 1573092051, "creation_date": 1573092051, "answer_id": 58740920, "question_id": 58738373, "link": "https://stackoverflow.com/questions/58738373/how-to-assert-form-submission-worked-with-capybara-and-minitest/58740920#58740920", "title": "How to assert form submission worked with capybara and minitest?", "body": "<p>That would be </p>\n\n<pre><code>click_button 'Sign in'\nassert_current_path after_sign_in_path\n</code></pre>\n\n<p>but you're now asserting your URL which really isn't relevant to the user, if you pick the string in your original example to be something that only exists on the page after logging in</p>\n\n<pre><code>assert_text \"You've logged in\"\n</code></pre>\n\n<p>you're at least asserting something relevant to the user (obviously the text is dependent on what your app shows). If it's \"unreliable\" then you need to figure out why it's unreliable - If it's that your page sometimes takes longer to log in then specify an extended maximum wait for that assertion</p>\n\n<pre><code>assert_text \"You've logged in\", wait: 10\n</code></pre>\n\n<p>etc.</p>\n"}], "owner": {"reputation": 733, "user_id": 2441263, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/TOE8s.jpg?s=128&g=1", "display_name": "lucas", "link": "https://stackoverflow.com/users/2441263/lucas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 58740920, "answer_count": 1, "score": 0, "last_activity_date": 1573092051, "creation_date": 1573073911, "question_id": 58738373, "link": "https://stackoverflow.com/questions/58738373/how-to-assert-form-submission-worked-with-capybara-and-minitest", "title": "How to assert form submission worked with capybara and minitest?", "body": "<p>I need to test that a form submits successfully and the user gets redirected to the proper page.</p>\n\n<p>What is the best way to do this? The capybara readme suggests something like the following:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>click_button 'Sign in'\nassert_text 'Success'\n</code></pre>\n\n<p>But I find that unreliable and sometimes ambiguous. Is there any way to do something like the following?</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>assert_redirects_to after_sign_in_path do\n  click_button 'Sign in'\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1573072191, "post_id": 58737572, "comment_id": 103766067, "body": "Do you mean for the variable holding your hash to be <code>params</code>, consider that <code>data</code> is set equal to <code>params[&#39;eventData&#39;]</code>?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1573084235, "post_id": 58737572, "comment_id": 103769989, "body": "Your question is not clear. I don&#39;t know rails (Ruby doesn&#39;t have the method <code>present?</code>) but I understand <code>data.present?</code> will return <code>true</code> if <code>data</code> (<code>= params[&#39;eventData&#39;]</code>) is a non-empty hash, but also if it is a string with one character other than a space, a non-empty array, and so on. What exactly do wish to test? Do you want to ensure <code>params</code> has a key <code>eventData</code>? If it does do you want to ensure <code>data</code> is a hash? If so, I don&#39;t know why you would want to ensure its non-empty as your test is that two keys are present and both have truthy values. Please edit to clarify."}], "answers": [{"comments": [{"owner": {"reputation": 4782, "user_id": 3914509, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/618920827/picture?type=large", "display_name": "Jeremy Thomas", "link": "https://stackoverflow.com/users/3914509/jeremy-thomas"}, "edited": false, "score": 1, "creation_date": 1573073263, "post_id": 58737594, "comment_id": 103766512, "body": "this was the &quot;ah ha!&quot; moment I was looking for."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1573080822, "post_id": 58737594, "comment_id": 103769118, "body": "This becomes tedious if <code>data[&#39;eventData&#39;]</code> has many keys. Personally I don&#39;t think <code>dig</code> is the right tool here."}, {"owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1573083512, "post_id": 58737594, "comment_id": 103769821, "body": "@CarySwoveland Yes you are right. But it\u2019s good to use it for two keys :)"}], "tags": [], "owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "is_accepted": true, "score": 3, "last_activity_date": 1573070766, "last_edit_date": 1573070766, "creation_date": 1573070128, "answer_id": 58737594, "question_id": 58737572, "link": "https://stackoverflow.com/questions/58737572/how-to-access-nested-variables-without-error-in-rails/58737594#58737594", "title": "How to access nested variables without error in Rails", "body": "<p>You can use <a href=\"https://ruby-doc.org/core-2.6/Hash.html#method-i-dig\" rel=\"nofollow noreferrer\">dig</a> method. It returns <code>nil</code> if any intermediate step is <code>nil</code>.</p>\n\n<pre><code>appointment_id = data.dig('eventData', 'appointmentId')\n#=&gt; 48761\n\nsite_id = data.dig('eventData', 'siteId')\n#=&gt; 232\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>if site_id &amp;&amp; appointment_id\n  # do_something\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1573081254, "post_id": 58737690, "comment_id": 103769234, "body": "#1 is simple, but effective and reads well. #2 is not worth mentioning, imo, and #3 is wrong (because the OP, I think, wants to make sure that hash has a key <code>&#39;eventData&#39;</code>, but assumes its value is a hash if the key is present). Posting good answers at SO is in part knowing when to stop."}, {"owner": {"reputation": 841, "user_id": 12294425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxWNY.jpg?s=128&g=1", "display_name": "calebkm", "link": "https://stackoverflow.com/users/12294425/calebkm"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1573081600, "post_id": 58737690, "comment_id": 103769337, "body": "Good catch, I&#39;ve updated the code with a check for <code>data</code>."}, {"owner": {"reputation": 841, "user_id": 12294425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxWNY.jpg?s=128&g=1", "display_name": "calebkm", "link": "https://stackoverflow.com/users/12294425/calebkm"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1573082309, "post_id": 58737690, "comment_id": 103769531, "body": "Keep in mind that different folks have different programming styles and that different solutions are often applicable in different scenarios, even within the same application. I enjoying seeing different ways of doing the same thing - even if one way is &quot;better&quot; than another. There&#39;s always room to learn a new way of doing something, even if it&#39;s not the right solution for your current problem. And what may look &quot;wrong&quot; to you may be preferable to someone else."}], "tags": [], "owner": {"reputation": 841, "user_id": 12294425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxWNY.jpg?s=128&g=1", "display_name": "calebkm", "link": "https://stackoverflow.com/users/12294425/calebkm"}, "is_accepted": false, "score": 3, "last_activity_date": 1573081610, "last_edit_date": 1573081610, "creation_date": 1573070605, "answer_id": 58737690, "question_id": 58737572, "link": "https://stackoverflow.com/questions/58737572/how-to-access-nested-variables-without-error-in-rails/58737690#58737690", "title": "How to access nested variables without error in Rails", "body": "<p>You could explicitly check for the attributes you're hoping exist and then set the vars and process in one go:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>data = params['eventData']\n\nif data &amp;&amp; data['siteId'] &amp;&amp; data['appointmentId']\n  siteID = data['siteId']\n  appointmentID = data['appointmentId']\n  # process this\nend\n</code></pre>\n\n<p>Another option would be to save the <code>if</code> statement results into it's own var and then use that as the conditional for processing:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>data = params['eventData']\n\nprocess = if data.present?\n  siteID = data['siteId']\n  appointmentID = data['appointmentId']\nend\n\nif process\n  # process this\nend\n</code></pre>\n\n<p>Or another option would be to set the vars inline:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>data = params['eventData']\n\nif data &amp;&amp; siteID = data['siteId'] &amp;&amp; appointmentID = data['appointmentId']\n  # process here\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 370, "user_id": 1086223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fb6uF.jpg?s=128&g=1", "display_name": "curiouscode", "link": "https://stackoverflow.com/users/1086223/curiouscode"}, "edited": false, "score": 0, "creation_date": 1573141116, "post_id": 58738483, "comment_id": 103792342, "body": "Scanning this answer is really confusing, and the examples are hard to read. But I&#39;ve never used <code>:values_at</code> before, which I think is an interesting solution. Setting the vars with <code>siteID, appointmentID = data &amp;&amp; params[&quot;eventData&quot;]&amp;.values_at(&quot;siteId&quot;, &quot;appointmentId&quot;)</code> is a unique way of solving the problem."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 370, "user_id": 1086223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fb6uF.jpg?s=128&g=1", "display_name": "curiouscode", "link": "https://stackoverflow.com/users/1086223/curiouscode"}, "edited": false, "score": 0, "creation_date": 1573145021, "post_id": 58738483, "comment_id": 103794620, "body": "@curiouscode, if my answer was confusing to you I failed in my objective. The only operative line of he method was of course the first; I included the two <code>puts</code> to help the reader understand what was going on in that first line. I adopted this form of answer on a whim. I appreciate your candor and will bear your advice in mind in future."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 370, "user_id": 1086223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fb6uF.jpg?s=128&g=1", "display_name": "curiouscode", "link": "https://stackoverflow.com/users/1086223/curiouscode"}, "edited": false, "score": 0, "creation_date": 1573149522, "post_id": 58738483, "comment_id": 103796826, "body": "@curiouscode, I have modified my answer in the hopes that it is now more clear."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": -1, "last_activity_date": 1573149386, "last_edit_date": 1573149386, "creation_date": 1573074407, "answer_id": 58738483, "question_id": 58737572, "link": "https://stackoverflow.com/questions/58737572/how-to-access-nested-variables-without-error-in-rails/58738483#58738483", "title": "How to access nested variables without error in Rails", "body": "<p>We can write the following method:</p>\n\n<pre><code>def extract(schedule)\n  siteId, appointmentId = \n    schedule[\"eventData\"]&amp;.values_at(\"siteId\", \"appointmentId\")\nend\n</code></pre>\n\n<p>If <code>schedule</code> does not have a key <code>\"eventData\"</code>, <code>sideId</code> and <code>appointentId</code> are both assigned a value of <code>nil</code>. If <code>schedule</code> does have a key <code>\"eventData\"</code> I have assumed that <code>schedule[\"eventData\"]</code> is a hash and:</p>\n\n<pre><code>siteId = schedule[\"eventData\"][\"siteId\"]\nappointmentId = schedule[\"eventData\"][\"appointmentId\"]\n</code></pre>\n\n<p><code>&amp;</code> is the <a href=\"http://mitrev.net/ruby/2015/11/13/the-operator-in-ruby/\" rel=\"nofollow noreferrer\">safe navigation operator</a>, which made its debut in Ruby v2.3. See also <a href=\"https://ruby-doc.org/core-2.6.3/Hash.html#method-i-values_at\" rel=\"nofollow noreferrer\">Hash#values_at</a>.</p>\n\n<p>This method is used as follows.</p>\n\n<pre><code>def doit(schedule)\n  siteId, appointmentId = extract(schedule)\n  if siteId &amp;&amp; appointmentId\n    # do something\n  else\n    # do something else\n  end\nend\n</code></pre>\n\n<p>Here are some examples of the values returned by <code>extract</code>:</p>\n\n<pre><code>schedule = { \"eventData\"=&gt;{ \"siteId\"=&gt;232, \"appointmentId\"=&gt;48761 } }\nsiteId, appointmentId = extract(schedule)\n  #=&gt; [232, 48761] \nsiteId\n  #=&gt; 232 \nappointmentId\n  #=&gt; 48761 \n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>schedule = { \"eventData\" =&gt; { \"siteId\" =&gt; 232 } }\nsiteId, appointmentId = extract(schedule)\n  #=&gt; [232, nil] \n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>schedule = { \"eventData\" =&gt; {} }    \nsiteId, appointmentId = extract(schedule)\n  #=&gt; [nil, nil] \n</code></pre>\n"}], "owner": {"reputation": 4782, "user_id": 3914509, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/618920827/picture?type=large", "display_name": "Jeremy Thomas", "link": "https://stackoverflow.com/users/3914509/jeremy-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 58737594, "answer_count": 3, "score": 1, "last_activity_date": 1573149386, "creation_date": 1573070038, "last_edit_date": 1573070478, "question_id": 58737572, "link": "https://stackoverflow.com/questions/58737572/how-to-access-nested-variables-without-error-in-rails", "title": "How to access nested variables without error in Rails", "body": "<p>If I have params that are of the structure:</p>\n\n<pre><code>data = {\n  \"messageId\" =&gt; \"B2YAx4rSMTZ4D8FJs1hsoV\",\n  \"eventId\" =&gt; \"appointmentBooking.cancelled\",\n  \"eventSchemaVersion\" =&gt; 1.0,\n  \"eventInstanceOriginationDateTime\" =&gt; \"2019-11-06T19:24:10Z\",\n  \"eventData\" =&gt; {\n    \"siteId\" =&gt; 232,\n    \"appointmentId\" =&gt; 48761\n  },\n  \"subdomain\" =&gt; \"api\",\n  \"consultation\" =&gt; {}\n}\n</code></pre>\n\n<p>and I want to access the <code>siteId</code> and <code>appointmentId</code> for another function I find myself doing the following:</p>\n\n<pre><code>data = params['eventData']\n\nif data.present?\n  siteID = data['siteId']\n  appointmentID = data['appointmentId']\nend\n\nif siteID and appointmentID\n  # process this\nend\n</code></pre>\n\n<p>This works sometimes, but if <code>!data.present?</code>, then <code>siteID</code> and <code>appointmentID</code> are undefined and that last <code>if</code> call will throw an error: </p>\n\n<pre><code>NameError (undefined local variable or method `siteID'\n</code></pre>\n\n<p>Is there a better way to do this without pre-defining the variables directly after <code>data = params['eventData']</code>?</p>\n"}, {"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 1990, "user_id": 5775341, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/67f9c208584c05ef9918d544e0d4b95f?s=128&d=identicon&r=PG&f=1", "display_name": "quicklikerabbit", "link": "https://stackoverflow.com/users/5775341/quicklikerabbit"}, "edited": false, "score": 0, "creation_date": 1573067015, "post_id": 58736836, "comment_id": 103763914, "body": "Can you add some more detail to your question? What behavior are you getting with the above code and what behavior would you like instead?"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1573067028, "post_id": 58736836, "comment_id": 103763917, "body": "RSpec and Rubocop are two different things. What&#39;s your question? What&#39;s the problem?"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1573067649, "post_id": 58736836, "comment_id": 103764169, "body": "It&#39;s not clear what you&#39;re asking--you don&#39;t write a test for standalone code, you write a test for a method. To test you pass all combinations of parameters to exercise the function in question."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1573085598, "post_id": 58736836, "comment_id": 103770285, "body": "As @Dave advises you need to write your code as a method and then perform tests on the method. For example: <code>def m(arr1, arr2); return &#39;neither&#39; if (arr1 &amp; arr2).empty?; array2.include?(&#39;c&#39;) ? &#39;no&#39; : &#39;yes&#39;; end</code>. <code>return &#39;neither&#39; if (arr1 &amp; arr2).empty?</code> is called a <i>guard clause</i>. Its use reduces by one the number of levels of nested conditional statements. <code>array2.include?(&#39;c&#39;) ? &#39;no&#39; : &#39;yes&#39;</code> uses the <a href=\"https://www.rubyguides.com/2019/10/ruby-ternary-operator/\" rel=\"nofollow noreferrer\">ternary operator</a>."}], "answers": [{"comments": [{"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 1, "creation_date": 1573073618, "post_id": 58737146, "comment_id": 103766652, "body": "Perfectly agree: name a function and test on that function."}, {"owner": {"reputation": 23, "user_id": 12333917, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-f4cvTsla0PI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdMv02VCwBDBto5csBtx34k4yVtnw/photo.jpg?sz=128", "display_name": "Ard Enriquez", "link": "https://stackoverflow.com/users/12333917/ard-enriquez"}, "edited": false, "score": 1, "creation_date": 1573109121, "post_id": 58737146, "comment_id": 103775554, "body": "Thanks for making me understand principle of testing! That&#39;s why I don&#39;t see any reference regarding on what I want."}], "tags": [], "owner": {"reputation": 3259, "user_id": 2424975, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/jDtKZ.jpg?s=128&g=1", "display_name": "Cereal", "link": "https://stackoverflow.com/users/2424975/cereal"}, "is_accepted": true, "score": 2, "last_activity_date": 1573067957, "creation_date": 1573067957, "answer_id": 58737146, "question_id": 58736836, "link": "https://stackoverflow.com/questions/58736836/rspec-nested-if-function/58737146#58737146", "title": "RSpec nested if function", "body": "<p>You don't need to explicitly test nested if expressions. When you write a test, you're testing the code as a whole. In this case, you have 3 possible routes the code could take, in which case you would write 3 tests.</p>\n\n<p>One test would satisfy <code>(array1 &amp; array2).any? &amp;&amp; !array2.include?('c')</code>, the second test would satisfy <code>(array1 &amp; array2).any? &amp;&amp; array2.include?('c')</code>, and the third test would satisfy <code>(array1 &amp; array2).empty?</code></p>\n\n<p>So, for example...</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>\ndef my_function(array1, array2)\n  if (array1 &amp; array2).any?\n    if !array2.include? 'c'\n      'yes'\n    else\n      'no'\n    end\n  else\n    'neither'\n  end\nend\n\nRSpec.describe 'MyFunction' do\n  context 'array has c' do\n    it 'should return no' do   #\n      expect { my_function(['b'], ['b']) }.to eq(\"no\")\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 12333917, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-f4cvTsla0PI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdMv02VCwBDBto5csBtx34k4yVtnw/photo.jpg?sz=128", "display_name": "Ard Enriquez", "link": "https://stackoverflow.com/users/12333917/ard-enriquez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 58737146, "answer_count": 1, "score": 2, "last_activity_date": 1573210753, "creation_date": 1573066653, "last_edit_date": 1573210753, "question_id": 58736836, "link": "https://stackoverflow.com/questions/58736836/rspec-nested-if-function", "title": "RSpec nested if function", "body": "<p>I'm new to RSpec and I'm trying to do testing but I have no idea how to handle nested if. I hope you can help me. Thank you!</p>\n\n<pre><code>array1 = %w[a b]\narray2 = %w[aa b c]\n@a = if (array1 &amp; array2).any?\n       if !array2.include? 'c'\n         'yes'\n       else\n         'no'\n            end\n     else\n       'neither'\n     end\nputs @a\n</code></pre>\n\n<p>I would like to develop a basic test for my code using RSpec. My code runs perfectly I just don't know how to write a test.</p>\n"}, {"tags": ["ruby-on-rails", "sql-server", "ruby", "azure"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1573066089, "post_id": 58736647, "comment_id": 103763519, "body": "&quot;Stack level too deep&quot; implies that a method is somehow calling itself inadvertently. Can you narrow it down to precisely which thing you change that causes the issue? Have you explored upgrading dependencies as this may be a known bug that was solved in a later patch? It&#39;s worth trying Rails 4.2.6 and more up-to-date drivers."}, {"owner": {"reputation": 11, "user_id": 10919063, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-itPiSnHuI5Y/AAAAAAAAAAI/AAAAAAAAAAo/NIGk1W5YImo/photo.jpg?sz=128", "display_name": "Gus Mueller", "link": "https://stackoverflow.com/users/10919063/gus-mueller"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1573070479, "post_id": 58736647, "comment_id": 103765309, "body": "But the only difference in this case is that the database is being served from a different server.  why would changing the location of where the data is served from lead to runaway recursion?  The extremely brittle nature of the Azure-Rails interface makes me very happy I am a Node.js developer."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10919063, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-itPiSnHuI5Y/AAAAAAAAAAI/AAAAAAAAAAo/NIGk1W5YImo/photo.jpg?sz=128", "display_name": "Gus Mueller", "link": "https://stackoverflow.com/users/10919063/gus-mueller"}, "edited": false, "score": 0, "creation_date": 1573071587, "post_id": 58736973, "comment_id": 103765770, "body": "i&#39;ve tried every permutation of the domain and username, sometimes with @s and various numbers of subdomains"}], "tags": [], "owner": {"reputation": 60497, "user_id": 86611, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7ce9a18f294e088d18deeceb65ff3df4?s=128&d=identicon&r=PG", "display_name": "Shiraz Bhaiji", "link": "https://stackoverflow.com/users/86611/shiraz-bhaiji"}, "is_accepted": false, "score": 0, "last_activity_date": 1573067186, "creation_date": 1573067186, "answer_id": 58736973, "question_id": 58736647, "link": "https://stackoverflow.com/questions/58736647/problem-with-migrating-an-azure-database-for-a-ruby-application/58736973#58736973", "title": "Problem with migrating an Azure database for a Ruby application", "body": "<p>You could try:</p>\n\n<p>env PRODUCTION_DATABASE_HOST=\"xxx2.<strong>database</strong>.windows.net\"</p>\n"}, {"comments": [{"owner": {"reputation": 60497, "user_id": 86611, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7ce9a18f294e088d18deeceb65ff3df4?s=128&d=identicon&r=PG", "display_name": "Shiraz Bhaiji", "link": "https://stackoverflow.com/users/86611/shiraz-bhaiji"}, "edited": false, "score": 0, "creation_date": 1573241186, "post_id": 58752101, "comment_id": 103831269, "body": "Thanks for sharing your solution"}], "tags": [], "owner": {"reputation": 11, "user_id": 10919063, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-itPiSnHuI5Y/AAAAAAAAAAI/AAAAAAAAAAo/NIGk1W5YImo/photo.jpg?sz=128", "display_name": "Gus Mueller", "link": "https://stackoverflow.com/users/10919063/gus-mueller"}, "is_accepted": false, "score": 1, "last_activity_date": 1573151055, "last_edit_date": 1573151055, "creation_date": 1573140901, "answer_id": 58752101, "question_id": 58736647, "link": "https://stackoverflow.com/questions/58736647/problem-with-migrating-an-azure-database-for-a-ruby-application/58752101#58752101", "title": "Problem with migrating an Azure database for a Ruby application", "body": "<p>UPDATE: the key to getting around this problem turned out to be the creation of a new Azure login/user (see <a href=\"https://azure.microsoft.com/en-us/blog/adding-users-to-your-sql-azure-database/\" rel=\"nofollow noreferrer\">https://azure.microsoft.com/en-us/blog/adding-users-to-your-sql-azure-database/</a> ).  While the admin user you might be tempted to work with works fine for some database connections, in Ruby on Rails it is likely to fail in the unhelpful way described above. Trust me, you can avoid a lot of headaches if you set up some other app-specific SQL login first. All this could've been avoided had Ruby on Rails simply reported that the database user had insufficient permissions instead of getting caught in runaway recursion.</p>\n"}], "owner": {"reputation": 11, "user_id": 10919063, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-itPiSnHuI5Y/AAAAAAAAAAI/AAAAAAAAAAo/NIGk1W5YImo/photo.jpg?sz=128", "display_name": "Gus Mueller", "link": "https://stackoverflow.com/users/10919063/gus-mueller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1573151055, "creation_date": 1573065814, "last_edit_date": 1573071534, "question_id": 58736647, "link": "https://stackoverflow.com/questions/58736647/problem-with-migrating-an-azure-database-for-a-ruby-application", "title": "Problem with migrating an Azure database for a Ruby application", "body": "<p>I have a working Ruby on Rails app (running Ruby 2.2.10p489 and Rails 4.2.5 and activerecord-sqlserver-adapter 4.2.6) on a Linux server (Amazon AMI v 2018.03 rhel fedora). It connects to an Azure database. Everything works great. But when I migrate to a different Azure database and change the credentials to point to the new database, I get a long list of unhelpful errors that looks like so:</p>\n\n<pre><code>SystemStackError: stack level too deep\n        from /apps/acme_dynamite/path/ruby/2.2/gems/tiny_tds-1.0.5/lib/tiny_tds/client.rb:53:in `connect'\n        from /apps/acme_dynamite/path/ruby/2.2/gems/tiny_tds-1.0.5/lib/tiny_tds/client.rb:53:in `initialize'\n        from /apps/acme_dynamite/path/ruby/2.2/gems/activerecord-sqlserver-adapter-4.2.6/lib/active_record/connection_adapters/sqlserver_adapter.rb:280:in `new'\n        from /apps/acme_dynamite/path/ruby/2.2/gems/activerecord-sqlserver-adapter-4.2.6/lib/active_record/connection_adapters/sqlserver_adapter.rb:280:in `dblib_connect'\n        from /apps/acme_dynamite/path/ruby/2.2/gems/activerecord-sqlserver-adapter-4.2.6/lib/active_record/connection_adapters/sqlserver_adapter.rb:271:in `connect'\n        from /apps/acme_dynamite/path/ruby/2.2/gems/activerecord-sqlserver-adapter-4.2.6/lib/active_record/connection_adapters/sqlserver_adapter.rb:59:in `initialize'\n        from /apps/acme_dynamite/path/ruby/2.2/gems/activerecord-sqlserver-adapter-4.2.6/lib/active_record/sqlserver_base.rb:18:in `new'\n        from /apps/acme_dynamite/path/ruby/2.2/gems/activerecord-sqlserver-adapter-4.2.6/lib/active_record/sqlserver_base.rb:18:in `sqlserver_connection'\n        from /apps/acme_dynamite/path/ruby/2.2/gems/activerecord-4.2.5/lib/active_record/connection_adapters/abstract/connection_pool.rb:438:in `new_connection'\n        from /apps/acme_dynamite/path/ruby/2.2/gems/activerecord-4.2.5/lib/active_record/connection_adapters/abstract/connection_pool.rb:448:in `checkout_new_connection'\n        from /apps/acme_dynamite/path/ruby/2.2/gems/activerecord-4.2.5/lib/active_record/connection_adapters/abstract/connection_pool.rb:422:in `acquire_connection'\n        from /apps/acme_dynamite/path/ruby/2.2/gems/activerecord-4.2.5/lib/active_record/connection_adapters/abstract/connection_pool.rb:349:in `block in checkout'\n        from /usr/share/ruby/2.2/monitor.rb:211:in `mon_synchronize'\n        from /apps/acme_dynamite/path/ruby/2.2/gems/activerecord-4.2.5/lib/active_record/connection_adapters/abstract/connection_pool.rb:348:in `checkout'\n        from /apps/acme_dynamite/path/ruby/2.2/gems/activerecord-4.2.5/lib/active_record/connection_adapters/abstract/connection_pool.rb:263:in `block in connection'\n        from /usr/share/ruby/2.2/monitor.rb:211:in `mon_synchronize'\n        from /apps/acme_dynamite/path/ruby/2.2/gems/activerecord-4.2.5/lib/active_record/connection_adapters/abstract/connection_pool.rb:262:in `connection'\n        from /apps/acme_dynamite/path/ruby/2.2/gems/activerecord-4.2.5/lib/active_record/connection_adapters/abstract/connection_pool.rb:571:in `retrieve_connection'\n        from /apps/acme_dynamite/path/ruby/2.2/gems/activerecord-4.2.5/lib/active_record/connection_handling.rb:113:in `retrieve_connection'\n        from /apps/acme_dynamite/path/ruby/2.2/gems/activerecord-4.2.5/lib/active_record/connection_handling.rb:87:in `connection'\n        from (irb):1\n        from /apps/acme_dynamite/path/ruby/2.2/gems/railties-4.2.5/lib/rails/commands/console.rb:110:in `start'\n        from /apps/acme_dynamite/path/ruby/2.2/gems/railties-4.2.5/lib/rails/commands/console.rb:9:in `start'\n        from /apps/acme_dynamite/path/ruby/2.2/gems/railties-4.2.5/lib/rails/commands/commands_tasks.rb:68:in `console'\n        from /apps/acme_dynamite/path/ruby/2.2/gems/railties-4.2.5/lib/rails/commands/commands_tasks.rb:39:in `run_command!'\n        from /apps/acme_dynamite/path/ruby/2.2/gems/railties-4.2.5/lib/rails/commands.rb:17:in `&lt;top (required)&gt;'\n        from bin/rails:4:in `require'\n</code></pre>\n\n<p>the working Azure connection looks something like:</p>\n\n<pre><code>env PRODUCTION_DATABASE_HOST=\"xxx.database.windows.net\"\nenv PRODUCTION_DATABASE_PORT=1433\nenv PRODUCTION_DATABASE=\"databasename_no_dots\"\nenv PRODUCTION_DATABASE_USERNAME=\"username_no_dots_or_ands\"\nenv PRODUCTION_DATABASE_PASSWORD=\"supersecret\"\n\n</code></pre>\n\n<p>the non-working one looks like:</p>\n\n<pre><code>env PRODUCTION_DATABASE_HOST=\"xxx2.database.windows.net\"\nenv PRODUCTION_DATABASE_PORT=1433\nenv PRODUCTION_DATABASE=\"other_databasename_no_dots\"\nenv PRODUCTION_DATABASE_USERNAME=\"username_no_dots_or_ands\"\nenv PRODUCTION_DATABASE_PASSWORD=\"supersecret\"\n</code></pre>\n\n<p>The problem is not connectivity or a firewall, because I can actually connect to this new Azure server using /node_modules/sql-cli. What could possibly be wrong?  Some incompatibility between my version of Ruby and this other instance of Azure? I am out of ideas.</p>\n\n<p>That pile of errors can be triggered from within irb just by issuing a statement like:</p>\n\n<pre><code>results = ActiveRecord::Base.connection.exec_query(\"SELECT 1\")\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "macos", "rubygems", "rbenv"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1573065525, "post_id": 58736558, "comment_id": 103763254, "body": "<code>uninstall</code>? You need to be careful mucking about with OS X&#39;s Ruby and gems since it&#39;s used by the system, though."}, {"owner": {"reputation": 82, "user_id": 7512037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/271973839890463/picture?type=large", "display_name": "Jake Denison", "link": "https://stackoverflow.com/users/7512037/jake-denison"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1573066865, "post_id": 58736558, "comment_id": 103763854, "body": "I&#39;m 99% sure that rails isn&#39;t part of OS X&#39;s core files. I disabled SIP and removed the rails install at /usr/bin/rails. When I run <code>which rails</code> it returns nothing. <code>rails -v</code> returns <code>-bash: rails: command not found</code>. I already ran <code>gem install rails</code> and <code>rbenv rehash</code> and restarted the terminal. Any tips?"}], "answers": [{"comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 4, "creation_date": 1573066430, "post_id": 58736708, "comment_id": 103763668, "body": "This says what to do the <i>next</i> time (although OP specifically tags with <code>rbenv</code>, not <code>rvm</code>) but doesn&#39;t solve the actual question, which was &quot;How do I fix this or remove the rails executable to start a fresh install from scratch?&quot;"}, {"owner": {"reputation": 82, "user_id": 7512037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/271973839890463/picture?type=large", "display_name": "Jake Denison", "link": "https://stackoverflow.com/users/7512037/jake-denison"}, "edited": false, "score": 0, "creation_date": 1573066970, "post_id": 58736708, "comment_id": 103763899, "body": "I tried running <code>rvm install 2.6.5</code> but I get <code>Error running &#39;__rvm_make -j4&#39;</code>"}, {"owner": {"reputation": 82, "user_id": 7512037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/271973839890463/picture?type=large", "display_name": "Jake Denison", "link": "https://stackoverflow.com/users/7512037/jake-denison"}, "edited": false, "score": 1, "creation_date": 1573067605, "post_id": 58736708, "comment_id": 103764152, "body": "Update: running <code>rvm install 2.5.0 --with-openssl-dir=&#39;brew --prefix openssl&#39;</code> seems to have completed the installation ok."}, {"owner": {"reputation": 434, "user_id": 366458, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9dcc92654328ba9ac44f83aa5074db26?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/366458/anthony"}, "edited": false, "score": 0, "creation_date": 1616774435, "post_id": 58736708, "comment_id": 118116931, "body": "This worked for me except I did rvm install 3.0.0 - thank you!"}], "tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": true, "score": 1, "last_activity_date": 1573066806, "last_edit_date": 1573066806, "creation_date": 1573066108, "answer_id": 58736708, "question_id": 58736558, "link": "https://stackoverflow.com/questions/58736558/how-to-remove-rails-installation-from-usr-bin-rails/58736708#58736708", "title": "How To Remove Rails Installation From /usr/bin/rails", "body": "<p>Ignore the existing Rails installation in your system Ruby. Don't bother mucking about with any changes you've made to system Ruby and its gems. Just put it in the past and move on:</p>\n\n<p>Install RVM with:</p>\n\n<pre><code>\\curl -sSL https://get.rvm.io | bash -s stable\n</code></pre>\n\n<p>Restart your shell, then install Ruby with:</p>\n\n<pre><code>rvm install 2.6.5\n</code></pre>\n\n<p><a href=\"https://robots.thoughtbot.com/psa-do-not-use-system-ruby\" rel=\"nofollow noreferrer\">Don't</a> <a href=\"https://chrisherring.co/posts/why-you-shouldn-t-use-the-system-ruby\" rel=\"nofollow noreferrer\">use</a> <a href=\"http://billpatrianakos.me/blog/2014/05/15/never-use-system-ruby-ever/\" rel=\"nofollow noreferrer\">system Ruby</a>.</p>\n\n<p>Then install Rails (without <code>sudo</code>, never use <code>sudo</code> with Ruby installed by RVM):</p>\n\n<pre><code>gem install rails\n</code></pre>\n"}], "owner": {"reputation": 82, "user_id": 7512037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/271973839890463/picture?type=large", "display_name": "Jake Denison", "link": "https://stackoverflow.com/users/7512037/jake-denison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 633, "favorite_count": 0, "accepted_answer_id": 58736708, "answer_count": 1, "score": 3, "last_activity_date": 1573066806, "creation_date": 1573065400, "question_id": 58736558, "link": "https://stackoverflow.com/questions/58736558/how-to-remove-rails-installation-from-usr-bin-rails", "title": "How To Remove Rails Installation From /usr/bin/rails", "body": "<p>I'm trying to install Ruby on Rails on MacOS Mojave. Here's what I have so far:</p>\n\n<pre><code>ruby -v\nruby 2.6.5p114 (2019-10-01 revision 67812) [x86_64-darwin18]\n\nrails -v\nRails is not currently installed on this system. To get the latest version, simply type:\n\n    $ sudo gem install rails\n\nYou can then rerun your \"rails\" command.\n\nwhich rails\nusr/bin/rails\n</code></pre>\n\n<p>I've done some research on the issue and it looks like because I used <code>sudo</code> when I originally ran <code>gem install rails</code>, the rails executable got put in a location where it doesn't have access to the right libraries.</p>\n\n<p>How do I fix this or remove the rails executable to start a fresh install from scratch?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 2034, "user_id": 9897223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1Nan.png?s=128&g=1", "display_name": "Sumanth Madishetty", "link": "https://stackoverflow.com/users/9897223/sumanth-madishetty"}, "is_accepted": false, "score": 1, "last_activity_date": 1573061149, "last_edit_date": 1573061149, "creation_date": 1573060814, "answer_id": 58735452, "question_id": 58735324, "link": "https://stackoverflow.com/questions/58735324/how-to-return-404-when-resource-is-not-found-instead-of-html/58735452#58735452", "title": "How to return 404 when resource is not found, instead of HTML", "body": "<p>You can add a check and return not_found if <code>@post</code> is nil &amp; inorder to prevent your app from crashing you can handle other errors by adding <code>rescue</code> block and return your desired from there</p>\n\n<pre><code>def update\n return render json: YOUR_ERROR, status: :not_found unless @post\n if @post.update(post_params)\n   render json: @post\n else\n   render json: @post.errors, status: :unprocessable_entity\n end\nrescue StandardError =&gt; e\n  render json: e, status: :unprocessable_entity\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 841, "user_id": 12294425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxWNY.jpg?s=128&g=1", "display_name": "calebkm", "link": "https://stackoverflow.com/users/12294425/calebkm"}, "is_accepted": false, "score": 0, "last_activity_date": 1573061038, "creation_date": 1573061038, "answer_id": 58735512, "question_id": 58735324, "link": "https://stackoverflow.com/questions/58735324/how-to-return-404-when-resource-is-not-found-instead-of-html/58735512#58735512", "title": "How to return 404 when resource is not found, instead of HTML", "body": "<p>You can add a check for <code>@post</code> to your controller action and return a 404 if it's <code>nil</code>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def update\n  if @post\n    if @post.update(post_params)\n      render json: @post\n    else\n      render json: @post.errors, status: :unprocessable_entity\n    end\n  else\n    render json: YourCustomJsonError, status: 404\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 382, "user_id": 7479934, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100007344395075/picture?type=large", "display_name": "Amanda Ferrari", "link": "https://stackoverflow.com/users/7479934/amanda-ferrari"}, "edited": false, "score": 0, "creation_date": 1573074709, "post_id": 58737382, "comment_id": 103767074, "body": "Are you sure this works? Cause the following error is raising: <code>uninitialized constant ApplicationController::RecordNotFoundSerializer</code>"}, {"owner": {"reputation": 66, "user_id": 1848794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da8c8f42b95e2d0fa97ab8ea05318824?s=128&d=identicon&r=PG", "display_name": "Diego Toral", "link": "https://stackoverflow.com/users/1848794/diego-toral"}, "reply_to_user": {"reputation": 382, "user_id": 7479934, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100007344395075/picture?type=large", "display_name": "Amanda Ferrari", "link": "https://stackoverflow.com/users/7479934/amanda-ferrari"}, "edited": false, "score": 0, "creation_date": 1573076008, "post_id": 58737382, "comment_id": 103767525, "body": "Yes! <code>RecordNotFoundSerializer</code> is up to you to implement or even throw it away completely. The way you turn the error/exception into JSON is up to you."}, {"owner": {"reputation": 382, "user_id": 7479934, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100007344395075/picture?type=large", "display_name": "Amanda Ferrari", "link": "https://stackoverflow.com/users/7479934/amanda-ferrari"}, "edited": false, "score": 0, "creation_date": 1573076061, "post_id": 58737382, "comment_id": 103767542, "body": "Yeah, I got that after thinking a little more haha"}], "tags": [], "owner": {"reputation": 66, "user_id": 1848794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da8c8f42b95e2d0fa97ab8ea05318824?s=128&d=identicon&r=PG", "display_name": "Diego Toral", "link": "https://stackoverflow.com/users/1848794/diego-toral"}, "is_accepted": true, "score": 2, "last_activity_date": 1573069123, "creation_date": 1573069123, "answer_id": 58737382, "question_id": 58735324, "link": "https://stackoverflow.com/questions/58735324/how-to-return-404-when-resource-is-not-found-instead-of-html/58737382#58737382", "title": "How to return 404 when resource is not found, instead of HTML", "body": "<p>You could make use of <code>ActiveRecord::FinderMethods#find_by!</code> which raises an <code>ActiveRecord::RecordNotFound</code> instead of <code>nil</code> when the record isn't found, and then use a <code>rescue_from</code> block to handle the error.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class MetricsController &lt; ApplicationController\n  rescue_from ActiveRecord::RecordNotFound do |exception|\n    # it is up to you create RecordNotFoundSerializer\n    serializer = RecordNotFoundSerializer.new exception\n\n    render json: serializer.to_json, status: :not_found\n  end\n\n  private\n\n  def set_post\n    @post = Post.find_by(site: params[:site_id], post_id: params[:post_id])\n  end\nend\n</code></pre>\n\n<p>You can also extract the error handling to a base controller (<code>ApplicationController</code> in you example) and centralize error handling there.</p>\n"}], "owner": {"reputation": 382, "user_id": 7479934, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100007344395075/picture?type=large", "display_name": "Amanda Ferrari", "link": "https://stackoverflow.com/users/7479934/amanda-ferrari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 58737382, "answer_count": 3, "score": 0, "last_activity_date": 1573069123, "creation_date": 1573060306, "question_id": 58735324, "link": "https://stackoverflow.com/questions/58735324/how-to-return-404-when-resource-is-not-found-instead-of-html", "title": "How to return 404 when resource is not found, instead of HTML", "body": "<p>I have this controller:</p>\n\n<pre><code># frozen_string_literal: true\n\nclass MetricsController &lt; ApplicationController\n  before_action :set_post, only: [:update]\n\n  def update\n    if @post.update(post_params)\n      render json: @post\n    else\n      render json: @post.errors, status: :unprocessable_entity\n    end\n  end\n\n  private\n\n  def set_post\n    @post = Post.find_by(site: params[:site_id], post_id: params[:post_id])\n  end\n\n  def post_params\n    params.fetch(:post, {})\n  end\nend\n</code></pre>\n\n<p>And I would like to know how can I return <code>404</code> not found when <code>@post</code> is <code>nil</code>. Right now <code>@post.update</code> raises an error if <code>@post</code> is <code>nil</code>, and the response is a HTML.</p>\n"}, {"tags": ["ruby", "file", "debugging"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1573065144, "post_id": 58734966, "comment_id": 103763108, "body": "Note: Ruby is a case-sensitive language and capital letters have specific meaning in terms of syntax. Variables and method names should be lower-case letters. Capitals indicate constants of the form  <code>ClassName</code> or <code>CONSTANT_NAME</code>."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1573082825, "post_id": 58734966, "comment_id": 103769668, "body": "Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. See: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">How to create a Minimal, Reproducible Example</a>. Please reduce the code to the bare minimum necessary and show the minimal data file that reproduces the problem."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 9822693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52796a00a9fbd0ac9d05ada7f89d4e8e?s=128&d=identicon&r=PG&f=1", "display_name": "Wah.P", "link": "https://stackoverflow.com/users/9822693/wah-p"}, "edited": false, "score": 0, "creation_date": 1573060015, "post_id": 58735056, "comment_id": 103760631, "body": "I tried using def is_numeric?(obj)   return true if /[^0-9]/.match(obj).nil?    false end but got the same error. I tried the second one as well and got the same error again."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 79, "user_id": 9822693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52796a00a9fbd0ac9d05ada7f89d4e8e?s=128&d=identicon&r=PG&f=1", "display_name": "Wah.P", "link": "https://stackoverflow.com/users/9822693/wah-p"}, "edited": false, "score": 0, "creation_date": 1573060543, "post_id": 58735056, "comment_id": 103760920, "body": "@Wah.P: ah, I see. <code>obj</code> content is not what you think it is. Try debug-printing it."}, {"owner": {"reputation": 79, "user_id": 9822693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52796a00a9fbd0ac9d05ada7f89d4e8e?s=128&d=identicon&r=PG&f=1", "display_name": "Wah.P", "link": "https://stackoverflow.com/users/9822693/wah-p"}, "edited": false, "score": 0, "creation_date": 1573061498, "post_id": 58735056, "comment_id": 103761409, "body": "I used puts count/obj and got 0. I don&#39;t see what the issue is?"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 79, "user_id": 9822693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52796a00a9fbd0ac9d05ada7f89d4e8e?s=128&d=identicon&r=PG&f=1", "display_name": "Wah.P", "link": "https://stackoverflow.com/users/9822693/wah-p"}, "edited": false, "score": 2, "creation_date": 1573062582, "post_id": 58735056, "comment_id": 103761911, "body": "@Wah.P You use the regex <code>&#47;[^0-9]&#47;</code> which matches if one character of the provided string is is not a digit. <code>gets</code> returns the line including the newline char at the end (which is not a digit), making the statement always <code>false</code>. To resolve it you can use <a href=\"https://ruby-doc.org/core-2.6.5/String.html#method-i-chomp\" rel=\"nofollow noreferrer\"><code>chomp</code></a> to cut off the trailing newline character. (I would use <code>!obj.match?(&#47;\\D&#47;)</code>)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 79, "user_id": 9822693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52796a00a9fbd0ac9d05ada7f89d4e8e?s=128&d=identicon&r=PG&f=1", "display_name": "Wah.P", "link": "https://stackoverflow.com/users/9822693/wah-p"}, "edited": false, "score": 0, "creation_date": 1573063184, "post_id": 58735056, "comment_id": 103762178, "body": "@Wah.P &quot;I used puts count/obj&quot; - not debuggy enough. Use <code>puts obj.inspect</code> or <code>p obj</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1573065113, "post_id": 58735056, "comment_id": 103763097, "body": "As @3limin4t0r mentions, <code>match?</code> certainly deserves a mention. For readability, my preference would be <code>def natural_number?(obj); obj.match? &#47;\\A\\d+\\z&#47;; end</code> (a natural number being a non-negative integer) or perhaps <code>true unless obj.match?(&#47;\\D&#47;)</code>. I tend to avoid negate (<code>!</code>) at all cost (perhaps irrationally). I assume the method is called after its argument has been <code>chomp</code>ed."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1573065194, "post_id": 58735056, "comment_id": 103763128, "body": "@CarySwoveland With your solution you could also go for <code>\\Z</code> instead of <code>\\z</code>, which allows a trailing newline character (removing the need to <code>chomp</code>). <code>to_i</code> doesn&#39;t care about trailing characters anyway."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1573065628, "post_id": 58735056, "comment_id": 103763300, "body": "@3limin4t0r, yes (I hadn&#39;t thought about that), but I want the argument to have been chomped already. <code>\\Z</code> would mask that. That&#39;s not a problem for this method but it may indicate there&#39;s a problem with the calling method. On the other hand, if <code>\\z</code> is used and the newline is there, <code>false</code> will always be returned. For production code, perhaps it would be best if the method used <code>\\z</code> and raised an exception if the newline were present."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 5, "last_activity_date": 1573059677, "last_edit_date": 1573059677, "creation_date": 1573059330, "answer_id": 58735056, "question_id": 58734966, "link": "https://stackoverflow.com/questions/58734966/why-am-i-getting-not-a-number-error-in-this-code/58735056#58735056", "title": "Why am I getting &quot;not a number&quot; error in this code?", "body": "<pre><code>def is_numeric?(obj)\n  if /[^0-9]/.match(obj) == nil\n    true\n  end\n  false\nend\n</code></pre>\n\n<p>Result of a code block (such as method body) is the last expression evaluated in it. Your <code>true</code> becomes the value of the <code>if</code> and is ignored, because the next expression evaluated is <code>false</code>, which is what is always returned. There are several ways you can improve this.</p>\n\n<pre><code>def is_numeric?(obj)\n  return true if /[^0-9]/.match(obj).nil?\n\n  false\nend\n\ndef is_numeric?(obj)\n  /[^0-9]/.match(obj).nil?\nend\n\ndef is_numeric?(obj)\n  /[^0-9]/ !~ obj\nend\n\ndef is_numeric?(obj)\n  Integer(obj) rescue false\nend\n</code></pre>\n\n<p>And many more.</p>\n"}], "owner": {"reputation": 79, "user_id": 9822693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52796a00a9fbd0ac9d05ada7f89d4e8e?s=128&d=identicon&r=PG&f=1", "display_name": "Wah.P", "link": "https://stackoverflow.com/users/9822693/wah-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "closed_date": 1573120265, "answer_count": 1, "score": 0, "last_activity_date": 1573082895, "creation_date": 1573059011, "last_edit_date": 1573082895, "question_id": 58734966, "link": "https://stackoverflow.com/questions/58734966/why-am-i-getting-not-a-number-error-in-this-code", "closed_reason": "Not suitable for this site", "title": "Why am I getting &quot;not a number&quot; error in this code?", "body": "<p>I'm just hoping someone might be able to help me out with this code: </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def write(aFile, number)\n  index = 1\n  while (index &lt; number)\n   aFile.puts(index.to_s)\n   index += 1\n  end\nend\n\ndef read(aFile)\n\n  count = aFile.gets\n  if (is_numeric?(count))\n    count = count.to_i\n  else\n    count = 0\n    puts \"Error: first line of file is not a number\"\n  end\n\n  index = 0\n  while (count &lt; index)\n    line = aFile.gets\n    puts \"Line read: \" + line\n  end\nend\n\n# Write data to a file then read it in and print it out\ndef main\n  aFile = File.new(\"mydata.txt\", \"w\") \n  if aFile  \n    write(aFile, 11)\n    aFile.close\n  else\n    puts \"Unable to open file to write!\"\n  end\n\n  aFile = File.new(\"mydata.txt\", \"r\") \n  if aFile\n    read(aFile)\n    aFile.close\n  else\n    puts \"Unable to open file to read!\"\n  end\nend\n\n# returns true if a string contains only digits\ndef is_numeric?(obj)\n  if /[^0-9]/.match(obj) == nil\n    true\n  end\n  false\nend\n\nmain\n</code></pre>\n\n<p>The result I'm trying to get is this: </p>\n\n<pre><code>Line read: 0\n\nLine read: 1\n\n...\n\nLine read: 10\n</code></pre>\n\n<p>But I'm getting: </p>\n\n<pre><code>Error: first line of file is not a number\n</code></pre>\n\n<p>Why is this the case? Something must be wrong with my code.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "associations"], "comments": [{"owner": {"reputation": 862, "user_id": 1600046, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/5rxUl.jpg?s=128&g=1", "display_name": "Vibol", "link": "https://stackoverflow.com/users/1600046/vibol"}, "edited": false, "score": 0, "creation_date": 1573055046, "post_id": 58733222, "comment_id": 103757807, "body": "I suppose you try to create Event records in the seed file, you must create the association Person object first, before from Rails 5 forward <code>belongs_to</code> association is required by default."}, {"owner": {"reputation": 2832, "user_id": 451893, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0dba10774351090583ce306ef0ca805b?s=128&d=identicon&r=PG", "display_name": "Les Nightingill", "link": "https://stackoverflow.com/users/451893/les-nightingill"}, "edited": false, "score": 0, "creation_date": 1573060138, "post_id": 58733222, "comment_id": 103760695, "body": "Person needs to inherit from ApplicationRecord (or ActiveRecord::Base). Does it do that?"}, {"owner": {"reputation": 1, "user_id": 10806319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2313e1e532eae4da91067ca730afeffc?s=128&d=identicon&r=PG&f=1", "display_name": "dani", "link": "https://stackoverflow.com/users/10806319/dani"}, "edited": false, "score": 0, "creation_date": 1573062294, "post_id": 58733222, "comment_id": 103761794, "body": "Hi,When I remove all references to the contact_person field (from migrate &amp; models), there is no issue, all work fine. So, it has to do with the way I define the contact_person field. Regards, Dani"}, {"owner": {"reputation": 1, "user_id": 10806319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2313e1e532eae4da91067ca730afeffc?s=128&d=identicon&r=PG&f=1", "display_name": "dani", "link": "https://stackoverflow.com/users/10806319/dani"}, "edited": false, "score": 0, "creation_date": 1573063917, "post_id": 58733222, "comment_id": 103762514, "body": "Just added data for all entries in the events seed file for contact_person field, and all works fine. But I want to have also some entries where the contact_person field is empty (no contact_person). Need to have it optional with and without contact_person. So at the moment it expects toe have contact_person with data. How can I make it be optional ? Regards, Dani"}, {"owner": {"reputation": 1, "user_id": 10806319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2313e1e532eae4da91067ca730afeffc?s=128&d=identicon&r=PG&f=1", "display_name": "dani", "link": "https://stackoverflow.com/users/10806319/dani"}, "edited": false, "score": 0, "creation_date": 1573064777, "post_id": 58733222, "comment_id": 103762935, "body": "Hi, I have resolved it by adding - optional: true to the modles file of events:   belongs_to :contact_person, class_name: &#39;::CoreModels::PeopleAndCompanies::Person&#39;, optional: true  Thank you all.  Regards, Dani"}, {"owner": {"reputation": 1023, "user_id": 3552298, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/8540fb02a16712af1b873b8bd8b6b318?s=128&d=identicon&r=PG&f=1", "display_name": "sureshprasanna70", "link": "https://stackoverflow.com/users/3552298/sureshprasanna70"}, "edited": false, "score": 0, "creation_date": 1573065059, "post_id": 58733222, "comment_id": 103763068, "body": "@dani If you have found a solution, please post it as an answer instead of a comment. It could be beneficial to other users of the community as well"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10806319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2313e1e532eae4da91067ca730afeffc?s=128&d=identicon&r=PG&f=1", "display_name": "dani", "link": "https://stackoverflow.com/users/10806319/dani"}, "is_accepted": true, "score": 0, "last_activity_date": 1573078299, "creation_date": 1573078299, "answer_id": 58739243, "question_id": 58733222, "link": "https://stackoverflow.com/questions/58733222/rails-6-0-association-query/58739243#58739243", "title": "Rails 6.0 association query", "body": "<p>I have resolved it by adding - \"optional: true\" to the modles file of events:</p>\n\n<p>\"belongs_to :contact_person, class_name: '::CoreModels::PeopleAndCompanies::Person', \n            optional: true\"</p>\n\n<p>Thank you all.\nRegards, Dani</p>\n"}], "owner": {"reputation": 1, "user_id": 10806319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2313e1e532eae4da91067ca730afeffc?s=128&d=identicon&r=PG&f=1", "display_name": "dani", "link": "https://stackoverflow.com/users/10806319/dani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 58739243, "answer_count": 1, "score": 0, "last_activity_date": 1573078299, "creation_date": 1573053156, "last_edit_date": 1573053659, "question_id": 58733222, "link": "https://stackoverflow.com/questions/58733222/rails-6-0-association-query", "title": "Rails 6.0 association query", "body": "<p>I'm working with ruby on Rails 6.0.\nI have two entities, an event table and a gem module e.g. for people (person). One of the fields in the event table is contact_person, which should point to the gem module people (person). When I try to popultae the tables with seed data, I get:\nActiveRecord::RecordInvalid: Validation failed: Contact person must exist</p>\n\n<p>Below you can find the db definitions. I'm quite new here, any hint what I'm doing wrong ?\nThank you for any assistance.</p>\n\n<p>Regards,\nDani</p>\n\n<p>Migrate file for events table:</p>\n\n<pre><code>class CreateApplicationEvents &lt; ActiveRecord::Migration[6.0]\n  def change\n        create_table :events\n                t.references :contact_person, null: true, foreign_key: { \n                    to_table: :core_people_and_companies_people }\n                t.timestamps\n        end\n  end\nend\n</code></pre>\n\n<p>The model file for events:</p>\n\n<pre><code>class Event &lt; ApplicationRecord\n  belongs_to :contact_person,\n                  class_name: '::CoreModels::PeopleAndCompanies::Person'\nend\n</code></pre>\n\n<p>The gem module:</p>\n\n<pre><code>module CoreModels\n    module PeopleAndCompanies\n      Person.class_eval do\n         has_many :events, :class_name =&gt; 'Event', :as =&gt; :contact_person\n      end\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-s3", "shrine"], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 8518731, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fKKrS.jpg?s=128&g=1", "display_name": "jpac", "link": "https://stackoverflow.com/users/8518731/jpac"}, "edited": false, "score": 0, "creation_date": 1573063221, "post_id": 58734736, "comment_id": 103762192, "body": "what options does <code>Shrine.upload</code> receives (besides <code>io</code> and <code>store</code>)? Can I define a different path to copy the file (instead of the root or the cached file&#39;s)?"}, {"owner": {"reputation": 7938, "user_id": 988414, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/376e4eb9dc6c2e33d1330262edc4f109?s=128&d=identicon&r=PG", "display_name": "janko-m", "link": "https://stackoverflow.com/users/988414/janko-m"}, "reply_to_user": {"reputation": 69, "user_id": 8518731, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fKKrS.jpg?s=128&g=1", "display_name": "jpac", "link": "https://stackoverflow.com/users/8518731/jpac"}, "edited": false, "score": 1, "creation_date": 1573154733, "post_id": 58734736, "comment_id": 103799001, "body": "Yes, you can pass the destination path to a <code>:location</code> keyword argument."}], "tags": [], "owner": {"reputation": 7938, "user_id": 988414, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/376e4eb9dc6c2e33d1330262edc4f109?s=128&d=identicon&r=PG", "display_name": "janko-m", "link": "https://stackoverflow.com/users/988414/janko-m"}, "is_accepted": true, "score": 2, "last_activity_date": 1573058096, "creation_date": 1573058096, "answer_id": 58734736, "question_id": 58733219, "link": "https://stackoverflow.com/questions/58733219/move-file-on-aws-s3-bucket-between-folders-using-shrine/58734736#58734736", "title": "Move file on AWS S3 Bucket between folders using Shrine", "body": "<p>Shrine automatically performs a copy request when uploading a file that's uploaded to S3.</p>\n\n<pre><code>Shrine.storages = {\n  cache: Shrine::Storage::S3.new(...),\n  store: Shrine::Storage::S3.new(...),\n}\n\ncached_file = Shrine.upload(file,        :cache) # performs a `put_object` operation\nstored_file = Shrine.upload(cached_file, :store) # performs a `copy_object` operation\n</code></pre>\n\n<p>So, in the attachment flow, when Shrine \"promotes\" the cached file to permanent storage, internally the S3 storage will make a copy request.</p>\n\n<p>Since S3 doesn't support moving objects, you can simply delete the cached file after copying.</p>\n"}], "owner": {"reputation": 69, "user_id": 8518731, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fKKrS.jpg?s=128&g=1", "display_name": "jpac", "link": "https://stackoverflow.com/users/8518731/jpac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 0, "accepted_answer_id": 58734736, "answer_count": 1, "score": 3, "last_activity_date": 1573058096, "creation_date": 1573053148, "last_edit_date": 1573054729, "question_id": 58733219, "link": "https://stackoverflow.com/questions/58733219/move-file-on-aws-s3-bucket-between-folders-using-shrine", "title": "Move file on AWS S3 Bucket between folders using Shrine", "body": "<p>Does Shrine support a way to copy/move files between folders inside a S3 Bucket? </p>\n\n<p>For instance, I upload a file into a folder called <code>cache</code> and if everything is OK, I then move that file into a <code>store</code> folder and clear the cache (immediately or using a background task).</p>\n\n<p>The <code>cache</code> and <code>store</code> are different Shrine stores (although they belong to the same bucket).</p>\n"}, {"tags": ["ruby", "shell", "vagrant", "vagrantfile", "vagrant-provision"], "comments": [{"owner": {"reputation": 1, "user_id": 10248678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JpnLA.jpg?s=128&g=1", "display_name": "oguz ismail", "link": "https://stackoverflow.com/users/10248678/oguz-ismail"}, "edited": false, "score": 1, "creation_date": 1574182509, "post_id": 58733077, "comment_id": 104136862, "body": "Sounds related <a href=\"https://stackoverflow.com/questions/21117246/returning-a-value-from-a-provision-script-to-vagrant\">returning a value from a provision script to vagrant</a>"}, {"owner": {"reputation": 1610, "user_id": 6482759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093bf0a6f8df3309217c5c6824065435?s=128&d=identicon&r=PG&f=1", "display_name": "bellackn", "link": "https://stackoverflow.com/users/6482759/bellackn"}, "reply_to_user": {"reputation": 1, "user_id": 10248678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JpnLA.jpg?s=128&g=1", "display_name": "oguz ismail", "link": "https://stackoverflow.com/users/10248678/oguz-ismail"}, "edited": false, "score": 1, "creation_date": 1574188997, "post_id": 58733077, "comment_id": 104140187, "body": "Yes, putting a file into /vagrant is the way I ended up doing it. But still, I wonder if this is possible and I would like to read some references."}], "answers": [{"tags": [], "owner": {"reputation": 1610, "user_id": 6482759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093bf0a6f8df3309217c5c6824065435?s=128&d=identicon&r=PG&f=1", "display_name": "bellackn", "link": "https://stackoverflow.com/users/6482759/bellackn"}, "is_accepted": true, "score": 0, "last_activity_date": 1574699280, "creation_date": 1574699280, "answer_id": 59036180, "question_id": 58733077, "link": "https://stackoverflow.com/questions/58733077/vagrantfile-assign-result-of-inline-shell-script-to-variable/59036180#59036180", "title": "Vagrantfile: Assign result of inline shell script to variable", "body": "<p>I ended up using an approach like <a href=\"https://stackoverflow.com/a/21124557/6482759\">this</a> one.</p>\n\n<p>Something I discovered along the way is that all Ruby conditionals in the Vagrantfile are evaluated in the very beginning, although the inline Shell scripts inside these conditionals (if there are any) are <em>not</em> evaluated at the same time. This lead to some strange behavior, which I could avoid by doing like I said above.</p>\n"}, {"tags": [], "owner": {"reputation": 1904, "user_id": 4199257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a35d9af9e7b63ce83be860f2ddcfa7c?s=128&d=identicon&r=PG&f=1", "display_name": "fernandezcuesta", "link": "https://stackoverflow.com/users/4199257/fernandezcuesta"}, "is_accepted": false, "score": 0, "last_activity_date": 1602709462, "creation_date": 1602709462, "answer_id": 64361473, "question_id": 58733077, "link": "https://stackoverflow.com/questions/58733077/vagrantfile-assign-result-of-inline-shell-script-to-variable/64361473#64361473", "title": "Vagrantfile: Assign result of inline shell script to variable", "body": "<p>After landing here I realized you can actually assign the output of a command exit code as in ruby:</p>\n<pre><code>FOO = `mycommand`\nBAR = $?.exitstatus\n</code></pre>\n<p>Then use it in <code>Vagrantfile</code> as any other variable.</p>\n"}], "owner": {"reputation": 1610, "user_id": 6482759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093bf0a6f8df3309217c5c6824065435?s=128&d=identicon&r=PG&f=1", "display_name": "bellackn", "link": "https://stackoverflow.com/users/6482759/bellackn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 0, "accepted_answer_id": 59036180, "answer_count": 2, "score": 1, "last_activity_date": 1602709462, "creation_date": 1573052718, "question_id": 58733077, "link": "https://stackoverflow.com/questions/58733077/vagrantfile-assign-result-of-inline-shell-script-to-variable", "title": "Vagrantfile: Assign result of inline shell script to variable", "body": "<p>I would like to assign the exit code of an inline shell script in a Vagrantfile to a variable:</p>\n\n<pre><code>FOO = config.vm.provision \"shell\", \nenv: {\n  \"FILE\" =&gt; \"/tmp/hello\"\n},\ninline: &lt;&lt;-SHELL\n  [ -f \"$FILE\" ]; echo $?\nSHELL\n</code></pre>\n\n<p>and then use it later in my Vagrantfile, like:</p>\n\n<pre><code>if FOO != 0\n  ...\n</code></pre>\n\n<p>The way I tried it obviously doesn't work. Does anyone here know</p>\n\n<ol>\n<li>if this is possible and</li>\n<li>if yes, how?</li>\n</ol>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1573075477, "post_id": 58732632, "comment_id": 103767349, "body": "Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>. Instead of showing us the contents of <code>collection</code>, provide the code that defines <code>collection</code> then shows what you&#39;re trying to do with it. That way we&#39;re able to copy/paste the code and use it immediately. &#39;Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself.&#39;"}], "answers": [{"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": true, "score": 2, "last_activity_date": 1573075706, "last_edit_date": 1573075706, "creation_date": 1573052158, "answer_id": 58732892, "question_id": 58732632, "link": "https://stackoverflow.com/questions/58732632/finding-sum-of-specific-values-of-array-in-hash/58732892#58732892", "title": "Finding sum of specific values of array in hash", "body": "<p>You can use <a href=\"https://ruby-doc.org/core-2.6.5/Enumerable.html#method-i-group_by\" rel=\"nofollow noreferrer\"><code>Enumerable#group_by</code></a> and <a href=\"https://ruby-doc.org/core-2.6.5/Hash.html#method-i-transform_values\" rel=\"nofollow noreferrer\"><code>Hash#transform_values</code></a> then sum as you already did:</p>\n\n<pre><code>collection.group_by { |h| h[:studio] }.transform_values { |v| v.sum{ |h| h[:worldwide_gross] } }\n#=&gt; {\"Alpha Films\"=&gt;40, \"Omega Films\"=&gt;30}\n</code></pre>\n\n<p>Where <code>group_by</code> returns:</p>\n\n<pre><code>collection.group_by { |h| h[:studio] }\n#=&gt; {\"Alpha Films\"=&gt;[{:title=&gt;\"Movie A\", :studio=&gt;\"Alpha Films\", :worldwide_gross=&gt;10}, {:title=&gt;\"Movie B\", :studio=&gt;\"Alpha Films\", :worldwide_gross=&gt;30}], \"Omega Films\"=&gt;[{:title=&gt;\"Movie C\", :studio=&gt;\"Omega Films\", :worldwide_gross=&gt;30}]}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1573063452, "last_edit_date": 1573063452, "creation_date": 1573062041, "answer_id": 58735759, "question_id": 58732632, "link": "https://stackoverflow.com/questions/58732632/finding-sum-of-specific-values-of-array-in-hash/58735759#58735759", "title": "Finding sum of specific values of array in hash", "body": "<p>This solution first creates a hash whose keys are the unique values of <code>g[:studio]</code> over all hashes <code>g</code> in <code>collection</code>, and whose values are the totals of <code>g[:worldwide_gross]</code> over all <code>g</code> for the given key. That hash is then converted to the desired hash.</p>\n\n<pre><code>collection.each_with_object(Hash.new(0)) do |g,h|  \n  h[g[:studio]] += g[:worldwide_gross]\nend.map { |k,v| { studio: k, worldwide_gross: v } }\n  #=&gt; [{:studio=&gt;\"Alpha Films\", :worldwide_gross=&gt;40},\n  #    {:studio=&gt;\"Omega Films\", :worldwide_gross=&gt;30}] \n</code></pre>\n\n<p>The two steps are as follows.</p>\n\n<pre><code>h = collection.each_with_object(Hash.new(0)) do |g,h|\n  h[g[:studio]] += g[:worldwide_gross]\nend\n  #=&gt; {\"Alpha Films\"=&gt;40, \"Omega Films\"=&gt;30} \nh.map { |k,v| { studio: k, worldwide_gross: v } }\n  #=&gt; [{:studio=&gt;\"Alpha Films\", :worldwide_gross=&gt;40},\n  #    {:studio=&gt;\"Omega Films\", :worldwide_gross=&gt;30}]  \n</code></pre>\n\n<p>The calculation of <code>h</code> (sometimes called a <em>counting hash</em>) employs the form of <a href=\"https://ruby-doc.org/core-2.6.3/Hash.html#method-c-new\" rel=\"nofollow noreferrer\">Hash::new</a> that defines a <em>default value</em> (here zero) that is the value returned by <code>h[k]</code> for a hash <code>h</code> so-defined when <code>h</code> does not have a key <code>k</code>. It is equivalent to the following.</p>\n\n<pre><code>h = collection.each_with_object({}) do |g,h|\n  h[g[:studio]] = (h[g[:studio]] || 0) + g[:worldwide_gross]\nend\n</code></pre>\n\n<p>If <code>h</code> does not have a key <code>g[:studio]</code> then <code>h[g[:studio]]  #=&gt; nil</code>, so <code>h[g[:studio]] || 0 #=&gt; 0</code>. If <code>h</code> has a key <code>g[:studio]</code> (whose value is not <code>nil</code> or <code>false</code>) then <code>h[g[:studio]] || 0 #=&gt; h[g[:studio]]</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "is_accepted": false, "score": 1, "last_activity_date": 1573095340, "creation_date": 1573095340, "answer_id": 58741306, "question_id": 58732632, "link": "https://stackoverflow.com/questions/58732632/finding-sum-of-specific-values-of-array-in-hash/58741306#58741306", "title": "Finding sum of specific values of array in hash", "body": "<p>You can use reduce method</p>\n\n<pre><code>result = a.group_by { |h| h[:studio] }.values.map do |arr|\n  arr.reduce do |h1, h2|\n    h1.merge(h2) do |k, v1, v2|\n      k.eql?(:worldwide_gross) ? (v1 + v2) : v1\n    end\n  end\nend\n</code></pre>\n\n<p>p result</p>\n\n<pre><code>[{:partner_name=&gt;\"company 1\", :partner_id=&gt;787, :value=&gt;3}, {:partner_name=&gt;\"company 2\", :partner_id=&gt;768, :value=&gt;1}, {:partner_name=&gt;\"company 3\", :partner_id=&gt;769, :value=&gt;1}]\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 12274352, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDFr-befL6lzlLB-y4KYeX8Q80Puq04OE_dfW3VEQ=k-s128", "display_name": "Jennifer Gomez", "link": "https://stackoverflow.com/users/12274352/jennifer-gomez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 58732892, "answer_count": 3, "score": 1, "last_activity_date": 1573095340, "creation_date": 1573051417, "question_id": 58732632, "link": "https://stackoverflow.com/questions/58732632/finding-sum-of-specific-values-of-array-in-hash", "title": "Finding sum of specific values of array in hash", "body": "<p>Here is my array:</p>\n\n<pre><code>collection\n\n=&gt; [{:title=&gt;\"Movie A\", :studio=&gt;\"Alpha Films\", :worldwide_gross=&gt;10},\n\n{:title=&gt;\"Movie B\", :studio=&gt;\"Alpha Films\", :worldwide_gross=&gt;30},\n\n{:title=&gt;\"Movie C\", :studio=&gt;\"Omega Films\", :worldwide_gross=&gt;30}]\n</code></pre>\n\n<p>My objective is the return the sum of each respective studio:</p>\n\n<pre><code>#=&gt; :studio =&gt; \"Alpha Films\", :worldwide_gross =&gt; 40\n\n#=&gt; :studio =&gt; \"Omega Films\", :worldwide_gross =&gt; 30\n</code></pre>\n\n<p>So far I've come up with the following logic but it only returns the sum of all studios in one lump sum:</p>\n\n<pre><code>gross_result = collection.sum {|h| h[:worldwide_gross]}\nresult #=&gt; 70\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "svg", "icons"], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 9322828, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215722452876336/picture?type=large", "display_name": "Damien Comp&#232;re", "link": "https://stackoverflow.com/users/9322828/damien-comp%c3%a8re"}, "edited": false, "score": 0, "creation_date": 1573048382, "post_id": 58731656, "comment_id": 103753861, "body": "Thx for your answer, I tried the first solution and I now . have the following error undefined local variable or method `logo&#39; for #&lt;#&lt;Class:0x00007f983b6a0358&gt;:0x00007f983b6aaa88&gt;"}, {"owner": {"reputation": 157, "user_id": 9322828, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215722452876336/picture?type=large", "display_name": "Damien Comp&#232;re", "link": "https://stackoverflow.com/users/9322828/damien-comp%c3%a8re"}, "edited": false, "score": 0, "creation_date": 1573049059, "post_id": 58731656, "comment_id": 103754222, "body": "I also tried the second one it works like this : &lt;%= image_tag(&quot;logo-footer.svg&quot;, alt:&quot;Logo&quot;, class: &quot;footer__logo&quot;, loading: &quot;lazy&quot; ) %&gt; Thanks for your help !"}, {"owner": {"reputation": 157, "user_id": 9322828, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215722452876336/picture?type=large", "display_name": "Damien Comp&#232;re", "link": "https://stackoverflow.com/users/9322828/damien-comp%c3%a8re"}, "edited": false, "score": 0, "creation_date": 1573049569, "post_id": 58731656, "comment_id": 103754462, "body": "Also, do you have any idea how to write svg in css file ? I have something like : background-image: url(&quot;../../icons/hourglass.svg&quot;); but doesn&#39;t work :("}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 157, "user_id": 9322828, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215722452876336/picture?type=large", "display_name": "Damien Comp&#232;re", "link": "https://stackoverflow.com/users/9322828/damien-comp%c3%a8re"}, "edited": false, "score": 0, "creation_date": 1573049665, "post_id": 58731656, "comment_id": 103754512, "body": "Please add another question, add code examples, you&#39;ll reach a wider audience"}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 2, "last_activity_date": 1573048953, "last_edit_date": 1573048953, "creation_date": 1573048099, "answer_id": 58731656, "question_id": 58731541, "link": "https://stackoverflow.com/questions/58731541/404-not-found-on-my-icon-svg-ruby-on-rails-app/58731656#58731656", "title": "404 (Not Found) on my icon.svg - Ruby on rails app", "body": "<p>You should use <a href=\"https://api.rubyonrails.org/classes/ActionView/Helpers/AssetUrlHelper.html#method-i-asset_path\" rel=\"nofollow noreferrer\"><code>asset_path</code></a> helper to generate the path to the image instead of hardcoding it:</p>\n\n<pre><code>&lt;img loading=\"lazy\" class=\"footer__logo\" src=\"\n&lt;%=asset_path(\"logo-footer.svg\")%&gt;\" alt=\"Logo\"&gt;\n</code></pre>\n\n<p>You can also use <a href=\"https://api.rubyonrails.org/classes/ActionView/Helpers/AssetTagHelper.html#method-i-image_tag\" rel=\"nofollow noreferrer\"><code>image_tag</code></a> helper:</p>\n\n<pre><code>\n&lt;%= image_tag(logo-footer.svg, alt:\"Logo\", class: \"footer__logo\", loading: \"lazy\" %&gt;\n</code></pre>\n\n<p>Read more in the <a href=\"https://guides.rubyonrails.org/asset_pipeline.html\" rel=\"nofollow noreferrer\">Asset Path Guideline</a>.</p>\n"}], "owner": {"reputation": 157, "user_id": 9322828, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215722452876336/picture?type=large", "display_name": "Damien Comp&#232;re", "link": "https://stackoverflow.com/users/9322828/damien-comp%c3%a8re"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1141, "favorite_count": 0, "accepted_answer_id": 58731656, "answer_count": 1, "score": 0, "last_activity_date": 1573048953, "creation_date": 1573047687, "last_edit_date": 1573048200, "question_id": 58731541, "link": "https://stackoverflow.com/questions/58731541/404-not-found-on-my-icon-svg-ruby-on-rails-app", "title": "404 (Not Found) on my icon.svg - Ruby on rails app", "body": "<p>I have an icon in my folder app > assets > medias > logo-footer.svg\nIn my code it looks like this : </p>\n\n<pre><code>&lt;img loading=\"lazy\" class=\"footer__logo\" src=\"app/assets/medias/logo-footer.svg\" alt=\"Logo\"&gt;\n</code></pre>\n\n<p>In my application I have an error in my console: GET <a href=\"http://127.0.0.1:3000/assets/icons.svg\" rel=\"nofollow noreferrer\">http://127.0.0.1:3000/assets/icons.svg</a> 404 (Not Found). </p>\n\n<p>How can I set the right path to this icon.svg ?</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "hash"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1573045503, "post_id": 58730802, "comment_id": 103752132, "body": "<code>map</code> and <code>uniq</code> is enough <code>x.map { |y| y[&#39;user_ids&#39;] }.uniq</code>."}, {"owner": {"reputation": 765, "user_id": 9015957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xwHPf.jpg?s=128&g=1", "display_name": "vikas95prasad", "link": "https://stackoverflow.com/users/9015957/vikas95prasad"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1573045752, "post_id": 58730802, "comment_id": 103752274, "body": "@SebastianPalma I think you missed that it is a string that contains ids"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1573045846, "post_id": 58730802, "comment_id": 103752333, "body": "Add a <code>.split(&#39;,&#39;)</code>."}, {"owner": {"reputation": 765, "user_id": 9015957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xwHPf.jpg?s=128&g=1", "display_name": "vikas95prasad", "link": "https://stackoverflow.com/users/9015957/vikas95prasad"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1573045924, "post_id": 58730802, "comment_id": 103752369, "body": "It gives me an array of array then i will have to use flatten. Is there any other way ?"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1573045958, "post_id": 58730802, "comment_id": 103752390, "body": "<code>users.flat_map { |user| user[&#39;user_ids&#39;].split(&#39;,&#39;) }.uniq</code>"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1573047262, "post_id": 58730802, "comment_id": 103753222, "body": "This seems like an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a> to me. If this is Rails parameter related, the better option is to make sure incoming parameters are already an array format. Have a look at <a href=\"https://guides.rubyonrails.org/form_helpers.html#understanding-parameter-naming-conventions\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/&hellip;</a>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1573067796, "post_id": 58730802, "comment_id": 103764240, "body": "There is a SO rule that for hashes used in examples, values can be no longer than 0.5 kms."}], "answers": [{"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1573075877, "post_id": 58731068, "comment_id": 103767487, "body": "Don&#39;t just toss out code, explain it and why your answer is the correct one. The goal is to educate in addition to solving the problem."}], "tags": [], "owner": {"reputation": 28830, "user_id": 221213, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bbfbca5273f9d020ef4ccfbadcecccba?s=128&d=identicon&r=PG", "display_name": "KARASZI Istv&#225;n", "link": "https://stackoverflow.com/users/221213/karaszi-istv%c3%a1n"}, "is_accepted": true, "score": 2, "last_activity_date": 1573128509, "last_edit_date": 1573128509, "creation_date": 1573046149, "answer_id": 58731068, "question_id": 58730802, "link": "https://stackoverflow.com/questions/58730802/how-to-pull-ids-from-array-of-hashes-on-ruby/58731068#58731068", "title": "How to pull ids from array of hashes on ruby?", "body": "<p>To get the unique ids:</p>\n\n<pre><code>unique_ids = data.flat_map { |d| d['user_ids'].split(',') }.uniq\n</code></pre>\n\n<ol>\n<li><a href=\"https://www.rubydoc.info/stdlib/core/Enumerable:flat_map\" rel=\"nofollow noreferrer\"><code>Enumerable#flat_map</code></a> walks through the Array and concatenate\nthe results provided in the code block.</li>\n<li><a href=\"https://www.rubydoc.info/stdlib/core/String:split\" rel=\"nofollow noreferrer\"><code>String#split</code></a> divides the string by the delimiter\ninto an Array.</li>\n<li><a href=\"https://www.rubydoc.info/stdlib/core/Array:uniq\" rel=\"nofollow noreferrer\"><code>Array#uniq</code></a> removes the duplicates.</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1573075960, "post_id": 58731303, "comment_id": 103767506, "body": "Explain why this is useful. Educate, don&#39;t just toss out code."}], "tags": [], "owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "is_accepted": false, "score": 2, "last_activity_date": 1573075934, "last_edit_date": 1573075934, "creation_date": 1573046962, "answer_id": 58731303, "question_id": 58730802, "link": "https://stackoverflow.com/questions/58730802/how-to-pull-ids-from-array-of-hashes-on-ruby/58731303#58731303", "title": "How to pull ids from array of hashes on ruby?", "body": "<p>If you use Rails, try this:</p>\n\n<pre><code>data.pluck('user_ids').join(',').split(',').uniq\n</code></pre>\n\n<p>If you don't use Rails:</p>\n\n<pre><code>data.map{ |d| d.dig('user_ids') }.join(',').split(',').uniq\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>#=&gt; [\n#     \"1120\", \"1119\", \"1118\", \"1117\", \"1116\", \"1115\", \"1114\",\n#     \"1113\", \"1112\", \"1111\", \"1110\", \"1109\", \"1108\", \"1107\"\n#   ]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11701, "user_id": 8376184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U6TIU.jpg?s=128&g=1", "display_name": "FZs", "link": "https://stackoverflow.com/users/8376184/fzs"}, "edited": false, "score": 1, "creation_date": 1573072956, "post_id": 58736908, "comment_id": 103766383, "body": "Please describe in your answer, what was the problem, and how will this snippet solve it, to help others understand this answer"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1573080145, "last_edit_date": 1573080145, "creation_date": 1573066917, "answer_id": 58736908, "question_id": 58730802, "link": "https://stackoverflow.com/questions/58730802/how-to-pull-ids-from-array-of-hashes-on-ruby/58736908#58736908", "title": "How to pull ids from array of hashes on ruby?", "body": "<pre><code>data.reduce('') { |s,h| s + h['user_ids'] + ',' }.scan(/\\d+/).uniq\n  #=&gt; [\"1120\", \"1119\", \"1118\", \"1117\", \"1116\", \"1115\", \"1114\", \"1113\",\n  #    \"1112\", \"1111\", \"1110\", \"1109\", \"1108\", \"1107\"] \n</code></pre>\n\n<p>The steps are as follows.</p>\n\n<pre><code>str = data.reduce('') { |s,h| s + h['user_ids'] + ',' }\n  =&gt; \"1120,1119,...1107,1120,1119,...1107,\" \narr = str.scan(/\\d+/)\n  #=&gt; [\"1120\", \"1119\", \"1118\", \"1117\", \"1116\", \"1115\", \"1114\", \"1113\",\n  #    \"1112\", \"1111\", \"1110\", \"1109\", \"1108\", \"1107\", \"1120\", \"1119\",\n  #    \"1118\", \"1117\", \"1116\", \"1115\", \"1114\", \"1113\", \"1112\", \"1111\",\n  #    \"1110\", \"1109\", \"1108\", \"1107\"]\narr.uniq\n  #=&gt; [\"1120\", \"1119\", \"1118\", \"1117\", \"1116\", \"1115\", \"1114\", \"1113\",\n  #    \"1112\", \"1111\", \"1110\", \"1109\", \"1108\", \"1107\"]\n</code></pre>\n\n<p>A problem with this approach is that the intermediate array <code>arr</code> can be quite large if <code>data</code> contains many elements (hashes) and for each element <code>h</code>, <code>h['user_ids'].split(',')</code> contains many elements. One way around that is to build a set, which of course contains unique elements, and then convert that set to an array at the end.</p>\n\n<pre><code>require 'set'\n\ndata.each_with_object(Set.new) { |h,set|\n  h[\"user_ids\"].split(',').each { |s| set &lt;&lt; s } }.to_a\n  #=&gt; [\"1120\", \"1119\", \"1118\", \"1117\", \"1116\", \"1115\", \"1114\",\n  #    \"1113\", \"1112\", \"1111\", \"1110\", \"1109\", \"1108\", \"1107\"]\n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/core-2.6.3/String.html#method-c-new\" rel=\"nofollow noreferrer\">Set::new</a>, <a href=\"https://ruby-doc.org/core-2.6.3/String.html#method-i-3C-3C\" rel=\"nofollow noreferrer\">Set#&lt;&lt;</a> and <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/set/rdoc/Set.html#method-i-to_a\" rel=\"nofollow noreferrer\">Set#to_a</a>.</p>\n\n<p>Note that the array returned here contains the same elements as the array returned earlier, but in a different order. I assume that is no import.</p>\n"}], "owner": {"reputation": 765, "user_id": 9015957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xwHPf.jpg?s=128&g=1", "display_name": "vikas95prasad", "link": "https://stackoverflow.com/users/9015957/vikas95prasad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 58731068, "answer_count": 3, "score": 0, "last_activity_date": 1573128509, "creation_date": 1573045255, "last_edit_date": 1573067692, "question_id": 58730802, "link": "https://stackoverflow.com/questions/58730802/how-to-pull-ids-from-array-of-hashes-on-ruby", "title": "How to pull ids from array of hashes on ruby?", "body": "<p>Given:</p>\n\n<pre><code>data = [\n  {\"id\"=&gt;nil, \"votable_id\"=&gt;1150, \"user_ids\"=&gt;\"1120,1119,1118,1117,1116,1115,1114,1113,1112,1111,1110,1109,1108,1107\"},\n  {\"id\"=&gt;nil, \"votable_id\"=&gt;1151, \"user_ids\"=&gt;\"1120,1119,1118,1117,1116,1115,1114,1113,1112,1111,1110,1109,1108,1107\"}\n]\n</code></pre>\n\n<p>I wish to return an array of all unique representations of integers in the strings <code>g[\"user_ids\"]</code>, taken over all hashes <code>g</code> that are elements of <code>data</code>; namely,</p>\n\n<pre><code>[\"1120\", \"1119\", \"1118\", \"1117\", \"1116\", \"1115\", \"1114\",\n \"1113\", \"1112\", \"1111\", \"1110\", \"1109\", \"1108\", \"1107\"]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "docker", "docker-compose", "apparmor"], "owner": {"reputation": 21, "user_id": 10620965, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tLUud.jpg?s=128&g=1", "display_name": "Karim Chowdhury", "link": "https://stackoverflow.com/users/10620965/karim-chowdhury"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1013, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576964658, "creation_date": 1573042940, "question_id": 58730102, "link": "https://stackoverflow.com/questions/58730102/apparmor-enabled-on-system-but-the-docker-default-profile-could-not-be-loaded", "title": "AppArmor enabled on system but the docker-default profile could not be loaded", "body": "<p>I am using Ubuntu Linux. I was trying to deploy a Rails app using Docker. When I run $ sudo make run is shows this Error.</p>\n\n<p>ERROR: Service 'ranger' failed to build: AppArmor enabled on system but the docker-default profile could not be loaded: running <code>/sbin/apparmor_parser apparmor_parser -Kr /var/lib/docker/tmp/docker-default749298809</code> failed with output: apparmor_parser: Unable to replace \"docker-default\".  Permission denied; attempted to load a profile while confined?</p>\n\n<p>error: exit status 243\nMakefile:55: recipe for target 'dependencies' failed\nmake: *** [dependencies] Error 1</p>\n\n<p>Need help to overcome this situation.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "multithreading"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 2, "creation_date": 1573058845, "post_id": 58729866, "comment_id": 103759996, "body": "Read <a href=\"https://bibwild.wordpress.com/2016/12/29/concurrency-in-rails-5-0/\" rel=\"nofollow noreferrer\">this</a> for more info. I&#39;m 99% sure that the feature you&#39;re reading about is for Rails &gt;= 5 only, not Rails 4. What it boils down to is: using that wrapper takes care of a lot of issues you might run into when calling <code>Thread.new</code> in the <code>development</code> environment, but those issues likely won&#39;t appear at all in <code>production</code> given the default configuration for that environment."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 3, "creation_date": 1573062920, "post_id": 58729866, "comment_id": 103762059, "body": "Keep reading: <a href=\"https://guides.rubyonrails.org/threading_and_code_execution.html#executor-concurrency\" rel=\"nofollow noreferrer\">&quot;The Executor will put the current thread into running mode in the Load Interlock. This operation will block temporarily if another thread is currently either autoloading a constant or unloading/reloading the application.&quot;</a>. The implication is that some of the global behavior needs help to be thread-safe, which (as @anothermh notes) may not be an issue in production."}], "owner": {"reputation": 2366, "user_id": 1644614, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/2NKuT.jpg?s=128&g=1", "display_name": "vaibhavatul47", "link": "https://stackoverflow.com/users/1644614/vaibhavatul47"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 1, "answer_count": 0, "score": 5, "last_activity_date": 1573042172, "creation_date": 1573042172, "question_id": 58729866, "link": "https://stackoverflow.com/questions/58729866/why-do-i-need-to-wrap-threads-in-ruby-on-rails-application", "title": "Why do I need to wrap threads in Ruby on rails application?", "body": "<p>In my RoR app, I'm writing an API in which I need to call multiple upstream APIs, so I'm planning to call them in parallel to save time. I want to follow best practices when implementing multi-threaded logic in ruby-on-rails applications.</p>\n\n<p>The RoR guide states clearly that we need to wrap our code but it didn't explain why it is important.</p>\n\n<p>From <a href=\"https://guides.rubyonrails.org/threading_and_code_execution.html#wrapping-application-code\" rel=\"noreferrer\">ruby-on-rails guidelines</a>:</p>\n\n<blockquote>\n  <p>Each thread should be wrapped before it runs application code, so if\n  your application manually delegates work to other threads, such as via\n  Thread.new or Concurrent Ruby features that use thread pools, you\n  should immediately wrap the block</p>\n</blockquote>\n\n<ul>\n<li>My App runs Rails version 4.</li>\n<li>Number of upstream API calls in a single request ranges from 3 to 30</li>\n<li>I checked out this similar <a href=\"https://stackoverflow.com/questions/16050910/ruby-on-rails-multiple-http-request-at-the-same-time\">SO post</a>, but it doesn't mention anything about <code>wrapping</code> threaded code.</li>\n</ul>\n"}, {"tags": ["ruby-on-rails", "ruby", "rbenv", "middleman"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11802732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa23eb753e3ad0ac8db0e6815e6424be?s=128&d=identicon&r=PG&f=1", "display_name": "Amarantha", "link": "https://stackoverflow.com/users/11802732/amarantha"}, "edited": false, "score": 0, "creation_date": 1573116576, "post_id": 58735094, "comment_id": 103778926, "body": "Yes, you&#39;re right, it WAS correctly installed! To check for the version I needed to enter the command without hyphens (<code>middleman version</code>).  Thank you!"}], "tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": true, "score": 0, "last_activity_date": 1573059429, "creation_date": 1573059429, "answer_id": 58735094, "question_id": 58729577, "link": "https://stackoverflow.com/questions/58729577/trouble-with-middleman-installation-in-ubuntu/58735094#58735094", "title": "Trouble with Middleman installation in Ubuntu", "body": "<p>What's the problem, exactly? <code>middleman</code> is successfully installed. It just doesn't support the switches you're trying to pass. Did you try <code>middleman init project_name</code> as defined in the <a href=\"https://github.com/middleman/middleman#getting-started\" rel=\"nofollow noreferrer\">README</a>? Because the fact that you're getting the error messages you've shown indicates that middleman IS installed correctly and WILL work correctly. You just have to run it, like so:</p>\n\n<pre><code>foo:~|\u21d2  which middleman\n/Users/foo/.rvm/gems/ruby-2.6.3/bin/middleman\nfoo:~|\u21d2  middleman\n/Users/foo/.rvm/gems/ruby-2.6.3/gems/activesupport-4.2.11.1/lib/active_support/core_ext/object/duplicable.rb:111: warning: BigDecimal.new is deprecated; use BigDecimal() method instead.\n== Could not find a Middleman project config.rb\nfoo:~|\u21d2  middleman --version\n/Users/foo/.rvm/gems/ruby-2.6.3/gems/activesupport-4.2.11.1/lib/active_support/core_ext/object/duplicable.rb:111: warning: BigDecimal.new is deprecated; use BigDecimal() method instead.\nUnknown switches \"--version\"\nDid you mean?  \"--verbose\"\nfoo:~|\u21d2  middleman init foo\n/Users/foo/.rvm/gems/ruby-2.6.3/gems/activesupport-4.2.11.1/lib/active_support/core_ext/object/duplicable.rb:111: warning: BigDecimal.new is deprecated; use BigDecimal() method instead.\n         run  git clone --depth 1 https://github.com/middleman/middleman-templates-default.git /var/folders/ts/qq2cd6pn42d15jrhc36cxbtw0000gn/T/d20191106-69912-29f30z from \".\"\nCloning into '/var/folders/ts/qq2cd6pn42d15jrhc36cxbtw0000gn/T/d20191106-69912-29f30z'...\nremote: Enumerating objects: 19, done.\nremote: Counting objects: 100% (19/19), done.\nremote: Compressing objects: 100% (11/11), done.\nremote: Total 19 (delta 0), reused 12 (delta 0), pack-reused 0\nUnpacking objects: 100% (19/19), done.\n       exist\n      create  .gitignore\n      create  Gemfile\n      create  config.rb\n      create  source/images/.keep\n      create  source/index.html.erb\n      create  source/javascripts/site.js\n      create  source/layouts/layout.erb\n      create  source/stylesheets/site.css.scss\n         run  bundle install from \"./foo\"\nThe dependency tzinfo-data (&gt;= 0) will be unused by any of the platforms Bundler is installing for. Bundler is installing for ruby but the dependency is only for x86-mswin32, x86-mingw32, java, x64-mingw32. To add those platforms to the bundle, run `bundle lock --add-platform x86-mswin32 x86-mingw32 java x64-mingw32`.\nThe dependency wdm (~&gt; 0.1) will be unused by any of the platforms Bundler is installing for. Bundler is installing for ruby but the dependency is only for x86-mswin32, x86-mingw32, x64-mingw32. To add those platforms to the bundle, run `bundle lock --add-platform x86-mswin32 x86-mingw32 x64-mingw32`.\nFetching gem metadata from https://rubygems.org/...............\nFetching gem metadata from https://rubygems.org/..\nResolving dependencies...\nUsing concurrent-ruby 1.1.5\nUsing i18n 0.9.5\nFetching minitest 5.13.0\nInstalling minitest 5.13.0\nUsing thread_safe 0.3.6\nUsing tzinfo 1.2.5\nFetching activesupport 5.0.7.2\nInstalling activesupport 5.0.7.2\nFetching public_suffix 4.0.1\nInstalling public_suffix 4.0.1\nFetching addressable 2.7.0\nInstalling addressable 2.7.0\nUsing execjs 2.7.0\nFetching autoprefixer-rails 9.7.1\nInstalling autoprefixer-rails 9.7.1\nUsing backports 3.15.0\nUsing bundler 1.17.3\nUsing coffee-script-source 1.12.2\nUsing coffee-script 2.4.1\nUsing contracts 0.13.0\nUsing dotenv 2.7.5\nUsing erubis 2.7.0\nUsing fast_blank 1.0.0\nUsing fastimage 2.1.7\nUsing ffi 1.11.1\nUsing temple 0.8.2\nFetching tilt 2.0.10\nInstalling tilt 2.0.10\nUsing haml 5.1.2\nUsing hamster 3.0.0\nUsing hashie 3.6.0\nUsing kramdown 1.17.0\nUsing rb-fsevent 0.10.3\nUsing rb-inotify 0.10.0\nUsing listen 3.0.8\nUsing memoist 0.16.0\nUsing thor 0.20.3\nUsing middleman-cli 4.3.5\nUsing padrino-support 0.13.3.4\nUsing padrino-helpers 0.13.3.4\nFetching parallel 1.18.0\nInstalling parallel 1.18.0\nUsing rack 2.0.7\nUsing sassc 2.2.1\nUsing servolux 0.13.0\nUsing uglifier 3.2.0\nUsing middleman-core 4.3.5\nUsing middleman 4.3.5\nFetching middleman-autoprefixer 2.10.1\nInstalling middleman-autoprefixer 2.10.1\nBundle complete! 4 Gemfile dependencies, 42 gems now installed.\nUse `bundle info [gemname]` to see where a bundled gem is installed.\nfoo:~|\u21d2\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11802732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa23eb753e3ad0ac8db0e6815e6424be?s=128&d=identicon&r=PG&f=1", "display_name": "Amarantha", "link": "https://stackoverflow.com/users/11802732/amarantha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 58735094, "answer_count": 1, "score": 0, "last_activity_date": 1573059429, "creation_date": 1573041250, "question_id": 58729577, "link": "https://stackoverflow.com/questions/58729577/trouble-with-middleman-installation-in-ubuntu", "title": "Trouble with Middleman installation in Ubuntu", "body": "<p>I installed middleman using <code>gem install middleman</code>, and I can see the gem listed in my local gem list </p>\n\n<p><code>middleman (4.3.5)\nmiddleman-cli (4.3.5)\nmiddleman-core(4.3.5</code>  </p>\n\n<p>but when I enter <code>middleman -v</code> I get<br>\n<code>Unknown switches \"-v\"</code>  </p>\n\n<p>If I enter <code>middleman --version</code> I get<br>\n<code>Unknown switches \"--version\"\nDid you mean? \"--verbose\"</code></p>\n\n<p><code>which middleman</code> returns <code>home/.rbenv/shims/middleman</code>\n<code>which ruby</code> returns <code>home/.rbenv/shims/ruby</code>\nI'm running ruby version 2.6.3 by default\non Ubuntu 18.04</p>\n\n<p>I've been trying to install Middleman for two days and keep running into problems; it's turning into a nightmare!</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "each"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1573076467, "post_id": 58727788, "comment_id": 103767677, "body": "Welcome to SO! Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>. We need the minimal code that demonstrates the problem. <code>round_matches</code> isn&#39;t defined so please edit your question and define it, adding it to your code just as if it&#39;d been there all along. You don&#39;t need to add &quot;edited&quot; or &quot;updated&quot; as we can tell what&#39;s changed."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 12331295, "user_type": "registered", "profile_image": "https://graph.facebook.com/2446998922206670/picture?type=large", "display_name": "Davide Sovrano", "link": "https://stackoverflow.com/users/12331295/davide-sovrano"}, "edited": false, "score": 0, "creation_date": 1573039921, "post_id": 58728127, "comment_id": 103749113, "body": "Thank you so much. It&#39;s works! How can i set a var for team 1 and another for team 2? So i can put in different rows"}, {"owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "reply_to_user": {"reputation": 25, "user_id": 12331295, "user_type": "registered", "profile_image": "https://graph.facebook.com/2446998922206670/picture?type=large", "display_name": "Davide Sovrano", "link": "https://stackoverflow.com/users/12331295/davide-sovrano"}, "edited": false, "score": 0, "creation_date": 1573040351, "post_id": 58728127, "comment_id": 103749331, "body": "@DavideSovrano You can get team with <code>m.round_matches_team[0]</code> or <code>m.round_matches_team[1]</code>. I don&#39;t understand what you want."}], "tags": [], "owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "is_accepted": true, "score": 1, "last_activity_date": 1573036471, "creation_date": 1573036471, "answer_id": 58728127, "question_id": 58727788, "link": "https://stackoverflow.com/questions/58727788/how-to-store-data-from-an-each-where-rows-has-the-same-id/58728127#58728127", "title": "How to store data from an each where rows has the same id", "body": "<p>This should work</p>\n\n<pre><code>r.round_matches.each do |m|\n  team_names = m.round_matches_team.map.with_index do |team, index|\n    \"team_name[#{index + 1}]: #{team.team_name}\"\n  end.join(' ')\n  sheet.add_row [\"round_id: #{m.round_id} #{team_names}\"]\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "is_accepted": false, "score": 0, "last_activity_date": 1573043660, "creation_date": 1573043660, "answer_id": 58730303, "question_id": 58727788, "link": "https://stackoverflow.com/questions/58727788/how-to-store-data-from-an-each-where-rows-has-the-same-id/58730303#58730303", "title": "How to store data from an each where rows has the same id", "body": "<p>I would handle this a little differently: I would manipulate the data to be in a better format, and create the sheet from that data.</p>\n\n<pre><code>sheet_data = Hash.new([])\nr.round_matches.each do |m|\n  m.round_matches_team.each do |mt|\n    sheet_data[mt.round_id] &lt;&lt; mt.team_name \n  end \nend \nsheet_data.each do |round_id, teams|    \n  sheet.add_row [round_id, *teams]\nend\n</code></pre>\n\n<p>Explained: I will generate a hash with as key the <code>round_id</code> and as value an array containing the collected team-names. Then when adding the row, I use the splat-operator (*) to make sure each team-name will get a separate column. </p>\n\n<p>You could even sort the team-names if this might make more sense before using the splat, or instead of using <code>*teams</code>, use something like <code>teams.sort.join(\", \")</code> to combine all teams into one column (if wanted/preferred).</p>\n"}], "owner": {"reputation": 25, "user_id": 12331295, "user_type": "registered", "profile_image": "https://graph.facebook.com/2446998922206670/picture?type=large", "display_name": "Davide Sovrano", "link": "https://stackoverflow.com/users/12331295/davide-sovrano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 58728127, "answer_count": 2, "score": 0, "last_activity_date": 1573043660, "creation_date": 1573035364, "last_edit_date": 1573036785, "question_id": 58727788, "link": "https://stackoverflow.com/questions/58727788/how-to-store-data-from-an-each-where-rows-has-the-same-id", "title": "How to store data from an each where rows has the same id", "body": "<p>I'm a newbie in rails development, i'm sorry if i can't express myself well.</p>\n\n<p>I've a rails each cycle that do:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>r.round_matches.each do |m|\n  m.round_matches_team.each do |mt|\n      sheet.add_row [m.round_id, mt.team_name]\n  end\nend\n</code></pre>\n\n<p>Every round_match has :round_id doubled\nThe output is:</p>\n\n<blockquote>\n  <p>round_id: 2      team_name: TEST A</p>\n  \n  <p>round_id: 2      team_name: TEST B</p>\n</blockquote>\n\n<p>How i can group round by id in the each cycle and estrapolate the team_name from round_match_teams for every same round_id? I would like that my output will be:</p>\n\n<blockquote>\n  <p>round_id: 2     team_name[1]: TEST A     team_name[2]: TEST B</p>\n</blockquote>\n"}, {"tags": ["ruby", "ruby-on-rails-3"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12075756, "user_type": "registered", "profile_image": "https://graph.facebook.com/2396592607060563/picture?type=large", "display_name": "Hem Raj", "link": "https://stackoverflow.com/users/12075756/hem-raj"}, "edited": false, "score": 0, "creation_date": 1573040686, "post_id": 58729261, "comment_id": 103749527, "body": "okay then, all the call_backs behaviour are inherited in child class is that correct. @Tom  Lord"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 1, "user_id": 12075756, "user_type": "registered", "profile_image": "https://graph.facebook.com/2396592607060563/picture?type=large", "display_name": "Hem Raj", "link": "https://stackoverflow.com/users/12075756/hem-raj"}, "edited": false, "score": 0, "creation_date": 1573048207, "post_id": 58729261, "comment_id": 103753754, "body": "The callbacks are inherited, yes. Just like everything else is. But as I said, if you override a method definition then you may change what code is executed by the callback."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 1, "user_id": 12075756, "user_type": "registered", "profile_image": "https://graph.facebook.com/2396592607060563/picture?type=large", "display_name": "Hem Raj", "link": "https://stackoverflow.com/users/12075756/hem-raj"}, "edited": false, "score": 0, "creation_date": 1573048324, "post_id": 58729261, "comment_id": 103753817, "body": "If you want to &quot;cancel&quot; the callback in the <code>Child</code> class, you can use: <code>skip_before_filter :call</code>. Or if you want to trigger the original method inside <code>Child#call</code>, you can use <code>super</code>. Or if you don&#39;t want to change the behaviour, then you shouldn&#39;t define a new method with the same name. As I said though, I can&#39;t really suggest what you &quot;should&quot; do, without knowing what you&#39;re trying to achieve."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 0, "last_activity_date": 1573040117, "creation_date": 1573040117, "answer_id": 58729261, "question_id": 58727757, "link": "https://stackoverflow.com/questions/58727757/does-call-backs-with-same-name-in-parent-and-child-classes-need-not-to-be-called/58729261#58729261", "title": "Does call_backs with same name in parent and child classes need not to be called again", "body": "<p>When you define a method in a child class, this overrides any method by the same name in the parent class. (This is a basic principle in Object Oriented Programming; it is in no way specific to ruby/rails.)</p>\n\n<p><code>before_filter: :call</code> is saying: \"Execute the method <code>call</code>, before any controller action\".</p>\n\n<p>The <code>Child</code> class inherits the <code>before_filter</code> behaviour, but overrides the <code>call</code> method. Therefore its own implementation of <code>call</code> is being executed.</p>\n\n<hr>\n\n<p>I cannot really advise how to change your code, because I don't know what you're trying to achieve. But hopefully that explains why you're experiencing this (correct) behaviour.</p>\n"}], "owner": {"reputation": 1, "user_id": 12075756, "user_type": "registered", "profile_image": "https://graph.facebook.com/2396592607060563/picture?type=large", "display_name": "Hem Raj", "link": "https://stackoverflow.com/users/12075756/hem-raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573040117, "creation_date": 1573035284, "last_edit_date": 1573035714, "question_id": 58727757, "link": "https://stackoverflow.com/questions/58727757/does-call-backs-with-same-name-in-parent-and-child-classes-need-not-to-be-called", "title": "Does call_backs with same name in parent and child classes need not to be called again", "body": "<p>I had two methods with same name which is present in both parent and child class. But I the callback before_filter: method_name is called only in parent class and the before_filter: is not present in child class. But load_object is called in child class without call_back itself.</p>\n\n<pre><code>class Parent\n  before_filter: call\n\n  def call\n    #\n  end\nend\n\nclass child &lt; Parent\n  def call\n    # But the method is called here without call_back\n  end\nend\n</code></pre>\n\n<p>There is no class is inherited from child.</p>\n"}, {"tags": ["ruby", "rest", "sinatra", "datamapper", "web-frameworks"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1573076577, "post_id": 58727736, "comment_id": 103767714, "body": "&quot;<a href=\"https://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question?</a>&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "reply_to_user": {"reputation": 33, "user_id": 12331183, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2FnwfnXJbEI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcg8NukTCQpGqp52iqDWqQ2c-IG5Q/photo.jpg?sz=128", "display_name": "Mihai Tirtara", "link": "https://stackoverflow.com/users/12331183/mihai-tirtara"}, "edited": false, "score": 0, "creation_date": 1573044346, "post_id": 58729032, "comment_id": 103751485, "body": "Happy to heard that so you can check this answer as correct ;)"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1573076613, "post_id": 58729032, "comment_id": 103767724, "body": "&quot;<a href=\"https://meta.stackexchange.com/questions/109773/what-happens-if-you-answered-a-question-questioner-says-thanks-but-didnt-acce\">What happens if you answered a question, questioner says thanks, but didn&#39;t accept your answer as correct?</a>&quot;"}], "tags": [], "owner": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "is_accepted": true, "score": 0, "last_activity_date": 1573039433, "creation_date": 1573039433, "answer_id": 58729032, "question_id": 58727736, "link": "https://stackoverflow.com/questions/58727736/sinatra-and-post-datamapper-association/58729032#58729032", "title": "Sinatra and post datamapper association", "body": "<p>The problem is that it should not be id_company has to be company_id, changing...</p>\n\n<pre><code> property:id_company,Integer, :required =&gt;true\n</code></pre>\n\n<p>by</p>\n\n<pre><code>property :company_id,Integer, :required =&gt;true\n</code></pre>\n\n<p>and doing curl on this way, has to fix this error </p>\n\n<pre><code>curl -d \"owner[name]=rrr &amp; owner[company_id]=1\" http://localhost:4567/owners\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 12331183, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2FnwfnXJbEI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcg8NukTCQpGqp52iqDWqQ2c-IG5Q/photo.jpg?sz=128", "display_name": "Mihai Tirtara", "link": "https://stackoverflow.com/users/12331183/mihai-tirtara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 58729032, "answer_count": 1, "score": 0, "last_activity_date": 1573039433, "creation_date": 1573035236, "question_id": 58727736, "link": "https://stackoverflow.com/questions/58727736/sinatra-and-post-datamapper-association", "title": "Sinatra and post datamapper association", "body": "<p>I am building a rest api with sinatra and datamapper and I have my database file which looks like this:</p>\n\n<pre><code>require 'data_mapper'\n\nDataMapper.setup(:default,'sqlite::memory:')\n\n\nclass Company\n include DataMapper::Resource\n\n property :id, Serial\n property:name, String, :required =&gt; true\n property:adress,String,:required =&gt; true\n property:city,String, :required =&gt; true\n property:country,String,:required =&gt; true\n property:email,String\n property:phoneNumber,Numeric\n has n, :owners, :constraint =&gt; :destroy\n\nend\n\nclass Owner\n include DataMapper::Resource\n\n property :id,Serial\n property:name,String, :required =&gt; true\n property:id_company,Integer, :required =&gt;true\n\n belongs_to:company\nend\n\nDataMapper.finalize\nDataMapper.auto_migrate!\n</code></pre>\n\n<p>and I want to make a post method to add an owner to a company</p>\n\n<pre><code>post '/owners'do\n  content_type :json\n  owner = Owner.new params[:owner]\n  if owner.save\n    status 201\n  else\n    status 500\n    json owner.errors.full_messages\n  end\nend\n</code></pre>\n\n<p>but when I tried to run this request I get this error :</p>\n\n<pre><code>curl -d \"owner[name]=rrr &amp; owner[id_company]=1\" http://localhost:4567/owners\n[\"Company must not be blank\"]\n</code></pre>\n\n<p>Can somebody tell me how to make the association between the company and the owner in the post method?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "edited": false, "score": 1, "creation_date": 1573034485, "post_id": 58727029, "comment_id": 103746180, "body": "That&#39;s a &quot;correct&quot; way to mock them, and I think that it&#39;s important to know the difference between doubles and doubles, DO NOT write code for rubocop I guess that idea behind it&#39;s  to learn about every rule."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 4, "last_activity_date": 1573033039, "creation_date": 1573033039, "answer_id": 58727029, "question_id": 58726971, "link": "https://stackoverflow.com/questions/58726971/rspec-rubocop-error-prefer-using-verifying-doubles-over-normal-doubles/58727029#58727029", "title": "Rspec rubocop error `prefer using verifying doubles over normal doubles`", "body": "<p>You need to pass the class you're stubbing to the <code>instance_double</code>:</p>\n\n<pre><code>let(:mail_instance) { instance_double(ActionMailer::MessageDelivery, deliver_later: nil) }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "is_accepted": false, "score": 2, "last_activity_date": 1573034629, "last_edit_date": 1573034629, "creation_date": 1573033625, "answer_id": 58727202, "question_id": 58726971, "link": "https://stackoverflow.com/questions/58726971/rspec-rubocop-error-prefer-using-verifying-doubles-over-normal-doubles/58727202#58727202", "title": "Rspec rubocop error `prefer using verifying doubles over normal doubles`", "body": "<p>The idea it's that you should use <code>instance_double</code>, but I guess that it's important to understand why Rubocop says that.</p>\n\n<p>The main difference between <code>doubles</code> and <code>instance_doubles</code> is\nIf we try to declare a method which is NOT implemented by the class of the mocked instance, it will raise an exception. If we decide to use mock objects in our tests, instance_doubles provides us with a bit more confidence in our tests than if we were using spies or regular doubles.</p>\n\n<p>So if in the future someone rename or delete that method, if you use double you probably never know and your will pass, but if you use instance_doubles you will be notified.</p>\n\n<p>Obiously there is a slightly performance trade-off between both, but in 99% of the time for me it's better to use <code>instance_doubles</code> </p>\n"}], "owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1001, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1573034629, "creation_date": 1573032848, "last_edit_date": 1573033055, "question_id": 58726971, "link": "https://stackoverflow.com/questions/58726971/rspec-rubocop-error-prefer-using-verifying-doubles-over-normal-doubles", "title": "Rspec rubocop error `prefer using verifying doubles over normal doubles`", "body": "<p>I've a RSpec test </p>\n\n<pre><code>let(:mail_instance) { double(deliver_later: nil) }\n\nbefore do\n  allow(ConfirmationMailer).to receive(:send_email).and_return(mail_instance)\n  allow(mail_instance).to receive(:deliver_later)\nend\n\nit 'calls mailer, and delivers the mail' do\n  call_endpoint\n  expect(mail_instance).to have_received(:deliver_later)\nend\n</code></pre>\n\n<p>And it works well but I've got rubocop error - <code>prefer using verifying doubles over normal doubles</code>. According to docs <a href=\"https://www.rubydoc.info/gems/rubocop-rspec/1.7.0/RuboCop/Cop/RSpec/VerifiedDoubles\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/gems/rubocop-rspec/1.7.0/RuboCop/Cop/RSpec/VerifiedDoubles</a> I should use <code>instance_double</code> instead but if I change it my specs will we falls with an error:</p>\n\n<blockquote>\n  <p>ArgumentError:\n         Module or String expected, got {:deliver_later=>nil}</p>\n</blockquote>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "edited": false, "score": 2, "creation_date": 1573030752, "post_id": 58726278, "comment_id": 103744065, "body": "!&quot;string&quot;.include?(pattern) doesn&#39;t work for you?"}], "answers": [{"comments": [{"owner": {"reputation": 953, "user_id": 942135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6940a140b70676e63569f347b6642f68?s=128&d=identicon&r=PG", "display_name": "trueunlessfalse", "link": "https://stackoverflow.com/users/942135/trueunlessfalse"}, "edited": false, "score": 0, "creation_date": 1573031381, "post_id": 58726456, "comment_id": 103744379, "body": "Alternatively you can load activesupport directly into your ruby project. Depending on your needs it might be recommendable to only load the core-extensions that you really need as described on this guide: <a href=\"https://guides.rubyonrails.org/active_support_core_extensions.html\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/active_support_core_extensions.html</a>"}, {"owner": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "edited": false, "score": 0, "creation_date": 1573031745, "post_id": 58726456, "comment_id": 103744582, "body": "You need 2 patterns, a string to match and a pattern, should be something like !string.include?(pattern) or !string[/regexp/], or... you need to inject that method into String class and I would not do that..."}], "tags": [], "owner": {"reputation": 1382, "user_id": 2886945, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IgtEd.jpg?s=128&g=1", "display_name": "Ivan Denysov", "link": "https://stackoverflow.com/users/2886945/ivan-denysov"}, "is_accepted": true, "score": 5, "last_activity_date": 1573031102, "creation_date": 1573031102, "answer_id": 58726456, "question_id": 58726278, "link": "https://stackoverflow.com/questions/58726278/ruby-undefined-method-exclude/58726456#58726456", "title": "ruby: undefined method exclude?", "body": "<p><code>String#exclude?</code> is a part of activesupport gem that gets installed with every rails project. It is not included into ruby's standard library. But this method is <a href=\"https://apidock.com/rails/String/exclude%3F\" rel=\"noreferrer\">quite simple</a>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def exclude?(string)\n  !include?(string)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 65, "user_id": 9873649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/124027872e933d237200b4e30218186b?s=128&d=identicon&r=PG&f=1", "display_name": "manohar vadapalli", "link": "https://stackoverflow.com/users/9873649/manohar-vadapalli"}, "is_accepted": false, "score": 2, "last_activity_date": 1573031684, "creation_date": 1573031684, "answer_id": 58726634, "question_id": 58726278, "link": "https://stackoverflow.com/questions/58726278/ruby-undefined-method-exclude/58726634#58726634", "title": "ruby: undefined method exclude?", "body": "<p>Give a try with this</p>\n\n<pre><code>unless this.include?\n</code></pre>\n"}], "owner": {"reputation": 1133, "user_id": 11645617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nr756.jpg?s=128&g=1", "display_name": "Weilory", "link": "https://stackoverflow.com/users/11645617/weilory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 901, "favorite_count": 0, "accepted_answer_id": 58726456, "answer_count": 2, "score": 2, "last_activity_date": 1573031684, "creation_date": 1573030448, "last_edit_date": 1573031217, "question_id": 58726278, "link": "https://stackoverflow.com/questions/58726278/ruby-undefined-method-exclude", "title": "ruby: undefined method exclude?", "body": "<p>I try to use the opposite method of include? in ruby, which is \"string|array.exclude?\", here's my code on interactive ruby. </p>\n\n<pre><code>this = \"nice\"\nputs this.exclude? \"n\"\n</code></pre>\n\n<p>However, it always declares an error.</p>\n\n<blockquote>\n  <p>Traceback (most recent call last):</p>\n\n<pre><code>    4: from C:/Ruby26-x64/bin/irb.cmd:31:in `&lt;main&gt;'\n    3: from C:/Ruby26-x64/bin/irb.cmd:31:in `load'\n    2: from C:/Ruby26-x64/lib/ruby/gems/2.6.0/gems/irb-1.0.0/exe/irb:11:in `&lt;top (required)&gt;'\n    1: from (irb):14\n</code></pre>\n  \n  <p>NoMethodError (undefined method `exclude?' for \"nice\":String)</p>\n</blockquote>\n\n<p>I researched a lot but didn't find a solution. I wonder if it only happens to me, it annoys me so much.</p>\n\n<p>Could someone help me out. \nThank you very much.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "unit-testing", "rspec"], "comments": [{"owner": {"reputation": 9735, "user_id": 625184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d61e61fa593df732de1ccaad37ea4f59?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/625184/jon"}, "edited": false, "score": 0, "creation_date": 1573029376, "post_id": 58725877, "comment_id": 103743422, "body": "Sounds like you may have misunderstood how test doubles and mocking work. If you&#39;re providing a double for an object, you can&#39;t expect it to do any of its original functions. Can you show the code you&#39;re testing in full, and the test you&#39;ve written in full?"}], "answers": [{"comments": [{"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1573030989, "post_id": 58725998, "comment_id": 103744187, "body": "After adding <code>and_call_original</code> I&#39;ve got  different error -&gt; <code>expected `ActionMailer::Base.deliveries.count` to have changed by 1, but was not given a block</code>"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1573031848, "post_id": 58725998, "comment_id": 103744628, "body": "<i>Either</i> use stubbing <i>or</i> check deliveries count. Don&#39;t do both."}, {"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1573032389, "post_id": 58725998, "comment_id": 103744947, "body": "So how my test should looks like? is it <code>expect{ ActionMailer::Base.deliveries.count }.to change.by(1)</code> without stubbing?"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1573032864, "post_id": 58725998, "comment_id": 103745242, "body": "Configure AJ correctly :<a href=\"https://stackoverflow.com/a/39712145/580346\">stackoverflow.com/a/39712145/580346</a>"}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 0, "last_activity_date": 1573029428, "creation_date": 1573029428, "answer_id": 58725998, "question_id": 58725877, "link": "https://stackoverflow.com/questions/58725877/how-to-write-rspec-mock-for-method-that-calls-a-mailer-in-rails-5/58725998#58725998", "title": "How to write rspec mock for method that calls a mailer in rails 5", "body": "<p>You stubbed <code>send_email</code> in <code>ConfirmationMailer</code> without defining any value to be returned:</p>\n\n<pre><code>before do\n  allow(ConfirmationMailer).to receive(:send_email)\nend\n</code></pre>\n\n<p>You need to define a value returned by the stubbed method (with <code>#and_return</code>) or <a href=\"https://relishapp.com/rspec/rspec-mocks/docs/configuring-responses/calling-the-original-implementation\" rel=\"nofollow noreferrer\">call original</a>:\nbefore do\n  allow(ConfirmationMailer).to receive(:send_email).and_call_original\nend</p>\n\n<p>That said, I think it's not the best way to test if email is sent. Better use the advice from <a href=\"https://stackoverflow.com/a/7284748/580346\">this answer</a>:\nconfigure <code>config.action_mailer.delivery_method = :test</code> and assert on global array <code>ActionMailer::Base.deliveries</code>.</p>\n"}], "owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 546, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1573029466, "creation_date": 1573028893, "last_edit_date": 1573029466, "question_id": 58725877, "link": "https://stackoverflow.com/questions/58725877/how-to-write-rspec-mock-for-method-that-calls-a-mailer-in-rails-5", "title": "How to write rspec mock for method that calls a mailer in rails 5", "body": "<p>I'm trying to test a mailer method from my endpoint which looks like this:</p>\n\n<pre><code>ConfirmationMailer.send_email(email).deliver_later\n</code></pre>\n\n<p>And the corresponding spec looks like this:</p>\n\n<pre><code>let(:confirmation_mailer_stub) { instance_double ConfirmationMailer }\n\nbefore do\n  allow(ConfirmationMailer).to receive(:send_email)\nend\n\nit 'sends confirmation email' do\n  call_endpoint\n  expect(confirmation_mailer_stub).to change { ActionMailer::Base.deliveries.count }.by(1)\nend\n</code></pre>\n\n<p>But I've got an error:</p>\n\n<blockquote>\n  <p>NoMethodError:\n         undefined method `deliver_later' for nil:NilClass</p>\n</blockquote>\n\n<p>The <code>send_email</code> method is quite simple:</p>\n\n<pre><code>def send_email(email)\n  mail(to: email, cc: email)\nend\n</code></pre>\n\n<p>How can I test this method?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "api"], "comments": [{"owner": {"reputation": 1023, "user_id": 3552298, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/8540fb02a16712af1b873b8bd8b6b318?s=128&d=identicon&r=PG&f=1", "display_name": "sureshprasanna70", "link": "https://stackoverflow.com/users/3552298/sureshprasanna70"}, "edited": false, "score": 0, "creation_date": 1573024415, "post_id": 58724478, "comment_id": 103741300, "body": "Are you looking for some materials on how to get started with SEPA?"}, {"owner": {"reputation": 7, "user_id": 9770161, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Jt1T7IFzs8Y/AAAAAAAAAAI/AAAAAAAAASs/keDycd1U4YI/photo.jpg?sz=128", "display_name": "Sumow Gold", "link": "https://stackoverflow.com/users/9770161/sumow-gold"}, "reply_to_user": {"reputation": 1023, "user_id": 3552298, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/8540fb02a16712af1b873b8bd8b6b318?s=128&d=identicon&r=PG&f=1", "display_name": "sureshprasanna70", "link": "https://stackoverflow.com/users/3552298/sureshprasanna70"}, "edited": false, "score": 0, "creation_date": 1573027716, "post_id": 58724478, "comment_id": 103742700, "body": "Hi Suresh,  Yes with API documentation and steps if there are anything. Thanks for your reply,"}, {"owner": {"reputation": 1023, "user_id": 3552298, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/8540fb02a16712af1b873b8bd8b6b318?s=128&d=identicon&r=PG&f=1", "display_name": "sureshprasanna70", "link": "https://stackoverflow.com/users/3552298/sureshprasanna70"}, "edited": false, "score": 0, "creation_date": 1573064119, "post_id": 58724478, "comment_id": 103762603, "body": "If you looking for api documentation and similar help then this is not the right place.  Take a look at <a href=\"https://stackoverflow.com/help/on-topic\">stackoverflow.com/help/on-topic</a> to see what constitutes an <code>on-topic</code> question."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 9770161, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Jt1T7IFzs8Y/AAAAAAAAAAI/AAAAAAAAASs/keDycd1U4YI/photo.jpg?sz=128", "display_name": "Sumow Gold", "link": "https://stackoverflow.com/users/9770161/sumow-gold"}, "edited": false, "score": 0, "creation_date": 1573106893, "post_id": 58732107, "comment_id": 103774769, "body": "Thanks Ivan I will do analysis on this."}, {"owner": {"reputation": 7, "user_id": 9770161, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Jt1T7IFzs8Y/AAAAAAAAAAI/AAAAAAAAASs/keDycd1U4YI/photo.jpg?sz=128", "display_name": "Sumow Gold", "link": "https://stackoverflow.com/users/9770161/sumow-gold"}, "edited": false, "score": 0, "creation_date": 1573116395, "post_id": 58732107, "comment_id": 103778840, "body": "I have updated my description could you please check and reply for queries? Thanks"}], "tags": [], "owner": {"reputation": 1382, "user_id": 2886945, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IgtEd.jpg?s=128&g=1", "display_name": "Ivan Denysov", "link": "https://stackoverflow.com/users/2886945/ivan-denysov"}, "is_accepted": true, "score": 0, "last_activity_date": 1573049660, "creation_date": 1573049660, "answer_id": 58732107, "question_id": 58724478, "link": "https://stackoverflow.com/questions/58724478/build-an-api-using-ruby-on-rails-for-single-euro-payments-area-payment-sepa/58732107#58732107", "title": "Build an API using Ruby on Rails for Single Euro Payments Area payment (SEPA)", "body": "<p>SEPA is not an API. gem <code>sepa_king</code> is a tool to generate SEPA XML files that you can send to your bank for processing. This XML file will contain information about what amount of money to send to which accounts and from which account. It's your responsibility to collect beneficiary IBANs and safely store them.</p>\n\n<p>Your bank may accept only specific version of SEPA XML file. Those versions are called PAIN (Payment Initiation). You should ask your bank which PAIN version to use</p>\n"}], "owner": {"reputation": 7, "user_id": 9770161, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Jt1T7IFzs8Y/AAAAAAAAAAI/AAAAAAAAASs/keDycd1U4YI/photo.jpg?sz=128", "display_name": "Sumow Gold", "link": "https://stackoverflow.com/users/9770161/sumow-gold"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "closed_date": 1573065086, "accepted_answer_id": 58732107, "answer_count": 1, "score": -2, "last_activity_date": 1573116359, "creation_date": 1573022732, "last_edit_date": 1573116359, "question_id": 58724478, "link": "https://stackoverflow.com/questions/58724478/build-an-api-using-ruby-on-rails-for-single-euro-payments-area-payment-sepa", "closed_reason": "Not suitable for this site", "title": "Build an API using Ruby on Rails for Single Euro Payments Area payment (SEPA)", "body": "<p>I am new for SEPA (Single Euro Payments Area) Payment integration and I want to integrate this with ROR to transfer funds with cross border payments feature. </p>\n\n<p>I need to do integrate below functionality.</p>\n\n<p>SEPA payment request with validations and retrive the payment status.</p>\n\n<p>I am refering sepa_king gem (<a href=\"https://github.com/salesking/sepa_king\" rel=\"nofollow noreferrer\">https://github.com/salesking/sepa_king</a>), please suggest is it fine?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby", "bash", "chef-infra"], "comments": [{"owner": {"reputation": 19821, "user_id": 170230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cNDYy.png?s=128&g=1", "display_name": "Draco Ater", "link": "https://stackoverflow.com/users/170230/draco-ater"}, "edited": false, "score": 0, "creation_date": 1573120429, "post_id": 58724400, "comment_id": 103780970, "body": "Your <code>file</code> resource can&#39;t delete the /tmp/output.txt, because it does not have permisisons. Try running chef-client with sudo."}, {"owner": {"reputation": 1, "user_id": 12330170, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rmjx5vH9NAQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdS_Ox5muU37p8ly3tqjdt2Od-t6Q/photo.jpg?sz=128", "display_name": "Sourav Biswas", "link": "https://stackoverflow.com/users/12330170/sourav-biswas"}, "reply_to_user": {"reputation": 19821, "user_id": 170230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cNDYy.png?s=128&g=1", "display_name": "Draco Ater", "link": "https://stackoverflow.com/users/170230/draco-ater"}, "edited": false, "score": 0, "creation_date": 1573195006, "post_id": 58724400, "comment_id": 103809810, "body": "It solved the issue. Thanks!"}], "owner": {"reputation": 1, "user_id": 12330170, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rmjx5vH9NAQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdS_Ox5muU37p8ly3tqjdt2Od-t6Q/photo.jpg?sz=128", "display_name": "Sourav Biswas", "link": "https://stackoverflow.com/users/12330170/sourav-biswas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573059623, "creation_date": 1573022431, "last_edit_date": 1573059623, "question_id": 58724400, "link": "https://stackoverflow.com/questions/58724400/how-do-we-output-bash-resource-output-in-chef-to-a-file", "title": "How do we output bash resource output in chef to a file?", "body": "<p>I have a bash script which has to be put into a Chef recipe. I expect to see the output of the bash code when I run it using <code>chef-client-z -o</code> recipe and also print it to some file. For example if I run <code>cat hello.txt</code> it should display the contents of the <code>hello.txt</code> file when i run <code>chef-client -z -o</code> recipe as well as print it to a file.</p>\n\n<p>I have tried putting the code in a script but the output shows that the file does not have write permissions. I have no clue regarding how to print the contents of the <code>hello.txt</code> to the console.</p>\n\n<pre><code>results = \"/tmp/output.txt\"\nfile results do\n    mode '0755'\n    action :delete\nend\n\n\ncmd = \"cat hello.txt\"\nbash 'Checking system-auth settings' do\n  code &lt;&lt;-EOH\n    #{cmd} &amp;&gt; #{results}\n    EOH\nend\nruby_block \"Results\" do\n    only_if { ::File.exists?(results) }\n    block do\n        print \"\\n\"\n        File.open(results).each do |line|\n            print line\n        end\n    end\nend\n</code></pre>\n\n<p>The error output I receive is File <code>/tmp/output.txt</code> exists but is not writable so it cannot be deleted.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "recaptcha"], "comments": [{"owner": {"reputation": 1023, "user_id": 3552298, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/8540fb02a16712af1b873b8bd8b6b318?s=128&d=identicon&r=PG&f=1", "display_name": "sureshprasanna70", "link": "https://stackoverflow.com/users/3552298/sureshprasanna70"}, "edited": false, "score": 0, "creation_date": 1573019540, "post_id": 58723703, "comment_id": 103739550, "body": "can you show us your <code>verify_recaptcha</code> method?."}, {"owner": {"reputation": 603, "user_id": 8633966, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/494679358e68b624fbc62c01595566c7?s=128&d=identicon&r=PG&f=1", "display_name": "cswannabe", "link": "https://stackoverflow.com/users/8633966/cswannabe"}, "reply_to_user": {"reputation": 1023, "user_id": 3552298, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/8540fb02a16712af1b873b8bd8b6b318?s=128&d=identicon&r=PG&f=1", "display_name": "sureshprasanna70", "link": "https://stackoverflow.com/users/3552298/sureshprasanna70"}, "edited": false, "score": 0, "creation_date": 1573019843, "post_id": 58723703, "comment_id": 103739653, "body": "@sureshprasanna70 it uses the recaptcha gem from <a href=\"https://github.com/ambethia/recaptcha\" rel=\"nofollow noreferrer\">github.com/ambethia/recaptcha</a> , for the specific verify_recaptcha method, it is located here, <a href=\"https://github.com/ambethia/recaptcha/blob/master/lib/recaptcha/adapters/controller_methods.rb\" rel=\"nofollow noreferrer\">github.com/ambethia/recaptcha/blob/master/lib/recaptcha/&hellip;</a>"}, {"owner": {"reputation": 1023, "user_id": 3552298, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/8540fb02a16712af1b873b8bd8b6b318?s=128&d=identicon&r=PG&f=1", "display_name": "sureshprasanna70", "link": "https://stackoverflow.com/users/3552298/sureshprasanna70"}, "edited": false, "score": 0, "creation_date": 1573020124, "post_id": 58723703, "comment_id": 103739745, "body": "Feel free to upvote the answer."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "reply_to_user": {"reputation": 1023, "user_id": 3552298, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/8540fb02a16712af1b873b8bd8b6b318?s=128&d=identicon&r=PG&f=1", "display_name": "sureshprasanna70", "link": "https://stackoverflow.com/users/3552298/sureshprasanna70"}, "edited": false, "score": 0, "creation_date": 1573076837, "post_id": 58723703, "comment_id": 103767800, "body": "@sureshprasanna70 &quot;<a href=\"https://meta.stackexchange.com/questions/109773/what-happens-if-you-answered-a-question-questioner-says-thanks-but-didnt-acce\">What happens if you answered a question, questioner says thanks, but didn&#39;t accept your answer as correct?</a>&quot;"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1573076971, "post_id": 58723703, "comment_id": 103767847, "body": "Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>. Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. See: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">How to create a Minimal, Reproducible Example</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1023, "user_id": 3552298, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/8540fb02a16712af1b873b8bd8b6b318?s=128&d=identicon&r=PG&f=1", "display_name": "sureshprasanna70", "link": "https://stackoverflow.com/users/3552298/sureshprasanna70"}, "is_accepted": true, "score": 1, "last_activity_date": 1573019931, "creation_date": 1573019931, "answer_id": 58723910, "question_id": 58723703, "link": "https://stackoverflow.com/questions/58723703/duplicate-error-message-for-recaptcha-in-ruby-on-rails/58723910#58723910", "title": "Duplicate error message for reCaptcha in Ruby on Rails", "body": "<p>You are calling verify_recaptcha method twice and hence those two errors.You can avoid calling twice by using the result of <code>verify_recaptcha</code> stored in <code>@recaptcha_succeeded</code> variable.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def create\n        #render plain: params[:student].inspect\n        @student = Student.new(student_params)\n        @recaptcha_succeeded = verify_recaptcha(model: @student)\n        if @recaptch_succeeded &amp;&amp; @student.save\n            redirect_to @student\n        else\n            render 'new'\n        end\nend\n</code></pre>\n"}], "owner": {"reputation": 603, "user_id": 8633966, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/494679358e68b624fbc62c01595566c7?s=128&d=identicon&r=PG&f=1", "display_name": "cswannabe", "link": "https://stackoverflow.com/users/8633966/cswannabe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 58723910, "answer_count": 1, "score": -1, "last_activity_date": 1573019931, "creation_date": 1573018703, "question_id": 58723703, "link": "https://stackoverflow.com/questions/58723703/duplicate-error-message-for-recaptcha-in-ruby-on-rails", "title": "Duplicate error message for reCaptcha in Ruby on Rails", "body": "<p>For some odd reason, my reCaptcha errors for failed verification keeps duplicating, like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/oaFknm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oaFknm.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here's my controller code:</p>\n\n<pre><code>def create\n        #render plain: params[:student].inspect\n        @student = Student.new(student_params)\n        @recaptcha_succeeded = verify_recaptcha(model: @student)\n        if verify_recaptcha(model: @student) &amp;&amp; @student.save\n            redirect_to @student\n        else\n            render 'new'\n        end\n</code></pre>\n\n<p>Here's the view html code:</p>\n\n<pre><code>&lt;%if @recaptcha_succeeded==false%&gt;\n                  &lt;div class=\"col-md-12\"&gt;\n                    &lt;h5&gt;&lt;%=@student.errors.size%&gt; error prohibited this student from being saved:&lt;/h5&gt;\n                    &lt;%@student.errors.full_messages.each do |message|%&gt;\n                      &lt;li&gt;&lt;%=message%&gt;&lt;/li&gt;\n                    &lt;%end%&gt;\n                  &lt;/div&gt;\n              &lt;%end%&gt;\n</code></pre>\n\n<p>Any tips on why it is so?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "friendly-id"], "comments": [{"owner": {"reputation": 2837, "user_id": 6245337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VoQ5.jpg?s=128&g=1", "display_name": "Ana Mar&#237;a Mart&#237;nez G&#243;mez", "link": "https://stackoverflow.com/users/6245337/ana-mar%c3%ada-mart%c3%adnez-g%c3%b3mez"}, "edited": false, "score": 0, "creation_date": 1573018501, "post_id": 58723448, "comment_id": 103739216, "body": "can you post the routes file (only the part related is enough)?"}, {"owner": {"reputation": 31, "user_id": 6752341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ae13ccfefd2cde073ea3a77a3eb7163?s=128&d=identicon&r=PG&f=1", "display_name": "HighOnRails", "link": "https://stackoverflow.com/users/6752341/highonrails"}, "reply_to_user": {"reputation": 2837, "user_id": 6245337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VoQ5.jpg?s=128&g=1", "display_name": "Ana Mar&#237;a Mart&#237;nez G&#243;mez", "link": "https://stackoverflow.com/users/6245337/ana-mar%c3%ada-mart%c3%adnez-g%c3%b3mez"}, "edited": false, "score": 0, "creation_date": 1573018818, "post_id": 58723448, "comment_id": 103739316, "body": "@AnaMar&#237;aMart&#237;nezG&#243;mez updated my question."}], "answers": [{"comments": [{"owner": {"reputation": 2837, "user_id": 6245337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VoQ5.jpg?s=128&g=1", "display_name": "Ana Mar&#237;a Mart&#237;nez G&#243;mez", "link": "https://stackoverflow.com/users/6245337/ana-mar%c3%ada-mart%c3%adnez-g%c3%b3mez"}, "edited": false, "score": 0, "creation_date": 1573020008, "post_id": 58723690, "comment_id": 103739705, "body": "This is not needed when using the frendly_id gem. Check: <a href=\"https://github.com/norman/friendly_id\" rel=\"nofollow noreferrer\">github.com/norman/friendly_id</a>"}], "tags": [], "owner": {"reputation": 70, "user_id": 10510508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba98965996363c9a88414b3132797a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Ezenwa", "link": "https://stackoverflow.com/users/10510508/ezenwa"}, "is_accepted": false, "score": -1, "last_activity_date": 1573018584, "creation_date": 1573018584, "answer_id": 58723690, "question_id": 58723448, "link": "https://stackoverflow.com/questions/58723448/friendly-id-how-to-use-slug-instead-of-id-in-nested-routes/58723690#58723690", "title": "(Friendly_id) How to use slug instead of id in nested routes?", "body": "<p>Is the route a resourced route?. If it is, then you need to set the param key to slug. Like this:</p>\n\n<pre><code>resources :campaigns, param: :slug\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "is_accepted": false, "score": 0, "last_activity_date": 1573483706, "creation_date": 1573483706, "answer_id": 58803633, "question_id": 58723448, "link": "https://stackoverflow.com/questions/58723448/friendly-id-how-to-use-slug-instead-of-id-in-nested-routes/58803633#58803633", "title": "(Friendly_id) How to use slug instead of id in nested routes?", "body": "<p>Try to use it more explicit:</p>\n\n<pre><code>team_campaign_path(team_id: @campaign.team.slug, @campaign)\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6752341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ae13ccfefd2cde073ea3a77a3eb7163?s=128&d=identicon&r=PG&f=1", "display_name": "HighOnRails", "link": "https://stackoverflow.com/users/6752341/highonrails"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 300, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1573483706, "creation_date": 1573016930, "last_edit_date": 1573483429, "question_id": 58723448, "link": "https://stackoverflow.com/questions/58723448/friendly-id-how-to-use-slug-instead-of-id-in-nested-routes", "title": "(Friendly_id) How to use slug instead of id in nested routes?", "body": "<p>I have two models - Team and Campaign.</p>\n\n<p>Team <code>has_many :campaigns</code> &amp; Campaign <code>belongs_to :team</code></p>\n\n<p>Using friend_id gem, I have my team routes working as expected i.e <a href=\"https://localhost/t/myteam\" rel=\"nofollow noreferrer\">https://localhost/t/myteam</a></p>\n\n<p>However, for <code>campaign_path(@campaign.team, @campaign)</code> my url shows up as <a href=\"http://localhost/t/1/campaign/1\" rel=\"nofollow noreferrer\">http://localhost/t/1/campaign/1</a> while I am expecting it to be <a href=\"http://localhost/t/myteam/campaign/1\" rel=\"nofollow noreferrer\">http://localhost/t/myteam/campaign/1</a></p>\n\n<p>How can I achieve this? What am I doing wrong?</p>\n\n<p>Sharing snippet of my routes code.</p>\n\n<pre><code>resources :teams, :path =&gt; 't' do\n  member do\n    get :new_invite\n    resources :campaigns, :path =&gt; 'c' do\n      member do\n        get :share_callback\n        get :enter\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Campaign.rb</p>\n\n<pre><code>extend FriendlyId\nfriendly_id :campaign_heading, use: :slugged\nbelongs_to :team\n</code></pre>\n\n<p>Team.rb</p>\n\n<pre><code>extend FriendlyId\nfriendly_id :slug, use: :slugged\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "recaptcha"], "answers": [{"comments": [{"owner": {"reputation": 603, "user_id": 8633966, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/494679358e68b624fbc62c01595566c7?s=128&d=identicon&r=PG&f=1", "display_name": "cswannabe", "link": "https://stackoverflow.com/users/8633966/cswannabe"}, "edited": false, "score": 0, "creation_date": 1573017273, "post_id": 58723141, "comment_id": 103738907, "body": "It works now, I was careless and didn&#39;t realize that the object.errors is an array. However, it seems a new bug has popped up. The error message &quot;reCaptcha verification failed, please try again&quot; repeats twice."}], "tags": [], "owner": {"reputation": 66, "user_id": 5394207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9743fac2fe0000cdbfed2ddd1aba5cc?s=128&d=identicon&r=PG", "display_name": "Mike K", "link": "https://stackoverflow.com/users/5394207/mike-k"}, "is_accepted": true, "score": 0, "last_activity_date": 1573014692, "creation_date": 1573014692, "answer_id": 58723141, "question_id": 58722952, "link": "https://stackoverflow.com/questions/58722952/check-for-result-of-verify-recaptcha-in-ruby-on-rails-html-file/58723141#58723141", "title": "Check for result of verify_recaptcha in Ruby on Rails HTML file", "body": "<p>If you want to use the result of <code>verify_recaptcha</code> in the view, you could assign the result to something in the controller, maybe like this:</p>\n\n<pre><code>def create\n    @student = Student.new(student_params)\n\n    @recaptcha_succeeded = verify_recaptcha(model: @student)\n\n    if @recaptcha_succeeded &amp;&amp; @student.save\n        redirect_to @student\n    else\n        render 'new'\n    end\nend\n</code></pre>\n\n<p>Now in the view you should be able to refer to <code>@recaptcha_succeeded</code>.</p>\n\n<p>However, by passing in a model to <code>verify_recaptcha</code>, an error should be added to the model as well, in this case in <code>@student.errors</code>.  That information will also be available in the view.  The docs on the recaptcha gem (<a href=\"https://github.com/ambethia/recaptcha\" rel=\"nofollow noreferrer\">https://github.com/ambethia/recaptcha</a>) discuss this in more detail.</p>\n"}], "owner": {"reputation": 603, "user_id": 8633966, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/494679358e68b624fbc62c01595566c7?s=128&d=identicon&r=PG&f=1", "display_name": "cswannabe", "link": "https://stackoverflow.com/users/8633966/cswannabe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 58723141, "answer_count": 1, "score": 1, "last_activity_date": 1573014692, "creation_date": 1573013266, "last_edit_date": 1573014209, "question_id": 58722952, "link": "https://stackoverflow.com/questions/58722952/check-for-result-of-verify-recaptcha-in-ruby-on-rails-html-file", "title": "Check for result of verify_recaptcha in Ruby on Rails HTML file", "body": "<p>I am trying to get a Boolean result from verify_recaptcha that is implemented my app controller.</p>\n\n<p>Code from the controller:</p>\n\n<pre><code>def create\n        #render plain: params[:student].inspect\n        @student = Student.new(student_params)\n\n        if verify_recaptcha(model: @student) &amp;&amp; @student.save\n            redirect_to @student\n        else\n            render 'new'\n        end\n    end\n</code></pre>\n\n<p>HTML code: </p>\n\n<pre><code>&lt;h1 class=\"col-md-12\"&gt;New Student&lt;/h1&gt;\n              &lt;div class=\"col-md-12\"&gt;\n                  &lt;%= form_with scope: :student,url: students_path,local: true do |form|%&gt;\n\n                  &lt;p&gt;\n                        &lt;%= form.label :name %&gt;&lt;br&gt;\n                        &lt;%= form.text_field :name%&gt;\n                  &lt;/p&gt;\n                  &lt;p&gt;\n                        &lt;%= form.label :student_id,'Student ID' %&gt;&lt;br&gt;\n                        &lt;%= form.text_field :student_id%&gt;\n                  &lt;/p&gt;\n                  &lt;p&gt;\n                        &lt;%= form.label :course %&gt;&lt;br&gt;\n                        &lt;%= form.text_field :course%&gt;\n                  &lt;/p&gt;\n                  &lt;%= recaptcha_tags%&gt;\n                  &lt;p&gt;\n                        &lt;%=form.submit 'Create Student'%&gt;\n                  &lt;/p&gt;\n                  &lt;%end%&gt;\n                  &lt;%= link_to 'Back', students_path %&gt;\n              &lt;/div&gt;\n</code></pre>\n\n<p>EDIT: Here is what I want to achieve when recaptcha fails.\n<a href=\"https://i.stack.imgur.com/3O8dp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3O8dp.png\" alt=\"enter image description here\"></a>\nSo far, when the recaptcha fails, the webpage only reloads and doesn't go to the next page. What I want to do is create an alert indicating the number of errors. It turns out I am unable to use verify_recaptcha in the HTML. Any advice?</p>\n"}, {"tags": ["ruby", "selenium", "capybara"], "answers": [{"tags": [], "owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "is_accepted": false, "score": 0, "last_activity_date": 1573005043, "creation_date": 1573005043, "answer_id": 58721959, "question_id": 58721920, "link": "https://stackoverflow.com/questions/58721920/how-to-use-capybara-visit-without-session-prefix-getting-undefined-method-visi/58721959#58721959", "title": "How to use capybara visit without session prefix. getting undefined method `visit&#39; for main:Object (NoMethodError)", "body": "<p>One option is to use include <code>Capybara::DSL</code>, i.e.</p>\n\n<pre><code>include Capybara::DSL\nsession = Capybara::Session.new(:chrome)\nvisit('/forms')\n</code></pre>\n\n<p>However this does give a warning</p>\n\n<pre><code>including Capybara::DSL in the global scope is not recommended!\n</code></pre>\n\n<p>not sure how to get around that yet.</p>\n"}], "owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573005043, "creation_date": 1573004700, "question_id": 58721920, "link": "https://stackoverflow.com/questions/58721920/how-to-use-capybara-visit-without-session-prefix-getting-undefined-method-visi", "title": "How to use capybara visit without session prefix. getting undefined method `visit&#39; for main:Object (NoMethodError)", "body": "<p>Writing a standalone piece of code I can use </p>\n\n<pre><code>session.visit('/forms')\n</code></pre>\n\n<p>but how could I use </p>\n\n<pre><code>visit('/forms')\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>require 'webdrivers'\nrequire 'rspec'\nrequire 'capybara'\nrequire 'capybara/rspec'\nCapybara.configure do |config|\n  config.run_server = false\n  config.default_driver = :chrome\n  config.app_host = 'https://google.com'\nend\noptions = Selenium::WebDriver::Chrome::Options.new(args: ['window-size=1200,1200'])\nCapybara.register_driver :chrome do |app|\n  Capybara::Selenium::Driver.new(app, browser: :chrome, options: options)\nend\n\nsession = Capybara::Session.new(:chrome)\nsession.visit('/forms') # &lt;-- this works :)\nvisit('/forms')         # &lt;-- but this doesn't :(\n</code></pre>\n\n<p>I get</p>\n\n<pre><code>undefined method `visit' for main:Object (NoMethodError)\n</code></pre>\n"}, {"tags": ["ruby", "macos", "macos-mojave"], "answers": [{"comments": [{"owner": {"reputation": 29577, "user_id": 58129, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/MBBRu.jpg?s=128&g=1", "display_name": "Anthony Kong", "link": "https://stackoverflow.com/users/58129/anthony-kong"}, "edited": false, "score": 0, "creation_date": 1573106047, "post_id": 58721778, "comment_id": 103774501, "body": "The project is actually a command line utility. I suppose to run it in a shell like <code>terraforming s3 --profile hoge</code>. See <a href=\"https://github.com/cmedley/terraforming#prerequisites\" rel=\"nofollow noreferrer\">github.com/cmedley/terraforming#prerequisites</a> for details"}, {"owner": {"reputation": 124, "user_id": 6708657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffe34f136c0e2a6a18dd17783595aba1?s=128&d=identicon&r=PG&f=1", "display_name": "darkash", "link": "https://stackoverflow.com/users/6708657/darkash"}, "edited": false, "score": 0, "creation_date": 1573201855, "post_id": 58721778, "comment_id": 103812177, "body": "if u use bundler to install your gem, you can try using deployment mode provided by it <a href=\"https://bundler.io/man/bundle-install.1.html#DEPLOYMENT-MODE\" rel=\"nofollow noreferrer\">bundler.io/man/bundle-install.1.html#DEPLOYMENT-MODE</a>  in this case, the executable file would be in vendor/bundle/ruby/{version}/bin. In case you need to require it in your code, you need to add it onto the load path as well"}, {"owner": {"reputation": 841, "user_id": 12294425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxWNY.jpg?s=128&g=1", "display_name": "calebkm", "link": "https://stackoverflow.com/users/12294425/calebkm"}, "edited": false, "score": 0, "creation_date": 1573240445, "post_id": 58721778, "comment_id": 103830981, "body": "I&#39;ve updated my answer to include info about using the <code>$LOAD_PATH</code> to tell your system about the gem. I think that should get you what you need."}, {"owner": {"reputation": 29577, "user_id": 58129, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/MBBRu.jpg?s=128&g=1", "display_name": "Anthony Kong", "link": "https://stackoverflow.com/users/58129/anthony-kong"}, "edited": false, "score": 0, "creation_date": 1573431403, "post_id": 58721778, "comment_id": 103869812, "body": "I read the resources you quoted but I don&#39;t find them actionable. I export the LOAD_PATH but the cli still can&#39;t run. Same error message."}], "tags": [], "owner": {"reputation": 841, "user_id": 12294425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxWNY.jpg?s=128&g=1", "display_name": "calebkm", "link": "https://stackoverflow.com/users/12294425/calebkm"}, "is_accepted": false, "score": 2, "last_activity_date": 1573240404, "last_edit_date": 1573240404, "creation_date": 1573003294, "answer_id": 58721778, "question_id": 58721173, "link": "https://stackoverflow.com/questions/58721173/how-to-run-a-ruby-package-installed-on-an-alternative-path/58721778#58721778", "title": "How to run a ruby package installed on an alternative path?", "body": "<p>What kind of application are you using? Rails? Sinatra? Does it have a <code>gemfile</code>? If so, you should be able to explicitly set the path to the gem:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>gem 'terraforming', path: '/bin/ruby/2.3.0/bin/terraforming'\n</code></pre>\n\n<p>For a command line utility you need to include the path to the gem using the <code>$LOAD_PATH</code>. You can read the <a href=\"https://guides.rubygems.org/rubygems-basics/#requiring-code\" rel=\"nofollow noreferrer\">Ruby docs about requiring code</a> or there are other answers on StackOverflow that might be helpful like <a href=\"https://stackoverflow.com/questions/6671318/understanding-rubys-load-paths\">this one</a> and <a href=\"https://stackoverflow.com/questions/837123/adding-a-directory-to-load-path-ruby\">this one</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 29577, "user_id": 58129, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/MBBRu.jpg?s=128&g=1", "display_name": "Anthony Kong", "link": "https://stackoverflow.com/users/58129/anthony-kong"}, "edited": false, "score": 0, "creation_date": 1573507870, "post_id": 58784291, "comment_id": 103897278, "body": "From which directory?"}, {"owner": {"reputation": 841, "user_id": 12294425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxWNY.jpg?s=128&g=1", "display_name": "calebkm", "link": "https://stackoverflow.com/users/12294425/calebkm"}, "edited": false, "score": 0, "creation_date": 1573674666, "post_id": 58784291, "comment_id": 103962823, "body": "The directory where you run it shouldn&#39;t matter, <code>gem install &lt;gem name&gt;</code> will install the gem globally on your system."}], "tags": [], "owner": {"reputation": 3692, "user_id": 2102591, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/18ebe6ebe65a7aff45e6d09e96af9701?s=128&d=identicon&r=PG", "display_name": "Andrew Schwartz", "link": "https://stackoverflow.com/users/2102591/andrew-schwartz"}, "is_accepted": true, "score": 3, "last_activity_date": 1573340351, "creation_date": 1573340351, "answer_id": 58784291, "question_id": 58721173, "link": "https://stackoverflow.com/questions/58721173/how-to-run-a-ruby-package-installed-on-an-alternative-path/58784291#58784291", "title": "How to run a ruby package installed on an alternative path?", "body": "<p>You may still need to <code>gem install terraforming</code> to install the gem.</p>\n\n<p>The <code>script/setup</code> only installs dependencies -- you can see in <a href=\"https://github.com/cmedley/terraforming/blob/master/script/setup\" rel=\"nofollow noreferrer\">its code</a> that it just runs <code>bundle install</code>, which installs the gems in the included <a href=\"https://github.com/cmedley/terraforming/blob/master/Gemfile\" rel=\"nofollow noreferrer\">gemfile</a>. This gemfile does not include the <code>terraforming</code> gem itself as it expects you to do this independently.</p>\n"}], "owner": {"reputation": 29577, "user_id": 58129, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/MBBRu.jpg?s=128&g=1", "display_name": "Anthony Kong", "link": "https://stackoverflow.com/users/58129/anthony-kong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 58784291, "answer_count": 2, "score": 3, "last_activity_date": 1573340351, "creation_date": 1572998012, "question_id": 58721173, "link": "https://stackoverflow.com/questions/58721173/how-to-run-a-ruby-package-installed-on-an-alternative-path", "title": "How to run a ruby package installed on an alternative path?", "body": "<p>I want to build and try out this github project <a href=\"https://github.com/cmedley/terraforming\" rel=\"nofollow noreferrer\">https://github.com/cmedley/terraforming</a></p>\n\n<p>I have installed the package (or <code>gem</code>? Apology I am not familiar with proper Ruby terminology) to an alternative location by running the <code>setup</code> script in the github repo:</p>\n\n<pre><code>./script/setup --path ../bin\n</code></pre>\n\n<p>I can see that the main script <code>terraforming</code> has been installed under <code>bin</code>. The path is <code>bin/ruby/2.3.0/bin/terraforming</code> in this case.</p>\n\n<p>However when I ran it, I got this error:</p>\n\n<blockquote>\n  <p>/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/rubygems.rb:241:in\n  <code>bin_path': can't find gem terraforming (&gt;= 0.a)\n  (Gem::GemNotFoundException)   from\n  ../bin/ruby/2.3.0/bin/terraforming:22:in</code>'</p>\n</blockquote>\n\n<p>What is the proper way to invoke this <code>terraforming</code> script from the alternative installation location.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 128, "user_id": 7280636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-isWkcOyRDbA/AAAAAAAAAAI/AAAAAAAASHw/A_Wr0gpWuH8/photo.jpg?sz=128", "display_name": "Prasath Rajasekaran", "link": "https://stackoverflow.com/users/7280636/prasath-rajasekaran"}, "is_accepted": false, "score": 1, "last_activity_date": 1573011988, "creation_date": 1573011988, "answer_id": 58722800, "question_id": 58720911, "link": "https://stackoverflow.com/questions/58720911/create-a-method-to-aggregate-data-instead-of-update-it/58722800#58722800", "title": "Create a method to aggregate data instead of update it", "body": "<p>You can add the following private method and call it before update to check if params are present</p>\n\n<pre><code>def is_params_present?\n  [\"sentiment\",\"word_count\",\"paragraph_length\"].all? {|k| params.has?(k) &amp;&amp; params[k].present?}\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 70, "user_id": 10510508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba98965996363c9a88414b3132797a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Ezenwa", "link": "https://stackoverflow.com/users/10510508/ezenwa"}, "is_accepted": false, "score": 2, "last_activity_date": 1573020973, "creation_date": 1573020973, "answer_id": 58724115, "question_id": 58720911, "link": "https://stackoverflow.com/questions/58720911/create-a-method-to-aggregate-data-instead-of-update-it/58724115#58724115", "title": "Create a method to aggregate data instead of update it", "body": "<p>The answer by Presath should be fine. Its also good to have model-level validation too. E.g:</p>\n\n<pre><code>class Metric &lt; ApplicationRecord\n  belongs_to :post\n  validates_presence_of :sentiment, message: \"can't be blank\"\n  validates_presence_of :word_count, message: \"can't be blank\"\n  validates_presence_of :paragraph_length, message: \"can't be blank\"\nend\n</code></pre>\n"}], "owner": {"reputation": 382, "user_id": 7479934, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100007344395075/picture?type=large", "display_name": "Amanda Ferrari", "link": "https://stackoverflow.com/users/7479934/amanda-ferrari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1573020973, "creation_date": 1572996057, "question_id": 58720911, "link": "https://stackoverflow.com/questions/58720911/create-a-method-to-aggregate-data-instead-of-update-it", "title": "Create a method to aggregate data instead of update it", "body": "<p>I have the following models:</p>\n\n<pre><code>class Post &lt; ApplicationRecord\n  belongs_to :site\n\n  has_one :metric, dependent: :destroy\nend\n\nclass Metric &lt; ApplicationRecord\n  belongs_to :post\nend\n</code></pre>\n\n<p>And I would like to create an endpoint that, when called, aggregates the data sent, instead of just updating it. So, in my routes I changed the usual <code>put \"metrics\", to: \"metrics#update</code> to <code>patch \"metrics\", to: \"metrics#update</code>, and my controller looks like this:</p>\n\n<pre><code>class MetricsController &lt; ApplicationController\n  before_action :set_post, only: [:update]\n\n  def update\n    # TODO\n  end\n\n  private\n\n  def set_post\n    @post = Post.find_by(post_id: params[:post_id])\n  end\nend\n</code></pre>\n\n<p>The first thing to notice is that instead of a usual <code>METHOD /{id}</code>, all routes should be called passing a <code>post_id</code> instead. Although this might sound weird, it makes sense for my use case \u2013 wordpress blogs all over the world (hopefully haha) will send metrics to this endpoint, and the only thing they know to do it is their unique id (<code>site_id</code>) + the wordpress blog post id (the one stored in wordpress database \u2013 I'm calling it <code>post_id</code> in my database).</p>\n\n<p>For the sake of example, let's say that my model has only this columns:</p>\n\n<pre><code>sentiment\nword_count\nparagraph_length\n</code></pre>\n\n<p>Now, I would like your help with the following: how can I valid if those properties are present in the request body?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 12328952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7942c2b41e16f27485e65a4a35d6786c?s=128&d=identicon&r=PG&f=1", "display_name": "zezima", "link": "https://stackoverflow.com/users/12328952/zezima"}, "edited": false, "score": 1, "creation_date": 1572996804, "post_id": 58720891, "comment_id": 103734688, "body": "Wow that was very simple and I was overthinking this. Thanks for the help. Will see what I can do for Runescape haha"}], "tags": [], "owner": {"reputation": 541, "user_id": 12244608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rP6EG.jpg?s=128&g=1", "display_name": "TedTran2019", "link": "https://stackoverflow.com/users/12244608/tedtran2019"}, "is_accepted": true, "score": 2, "last_activity_date": 1572995906, "creation_date": 1572995906, "answer_id": 58720891, "question_id": 58720740, "link": "https://stackoverflow.com/questions/58720740/add-values-to-parameter-in-url-as-one-value-and-not-an-array-ruby/58720891#58720891", "title": "Add values to parameter in url as one value and not an array - Ruby", "body": "<p>You're basically using string interpolation on an array of arguments. You can easily change the array into a string of arguments separated by commas by doing </p>\n\n<pre><code>def method(*args)\n  url = url + \"/items?item_ids?=#{args.join(',')}\"\nend\n</code></pre>\n\n<p>Get me 99 slayer on Runescape bro ;)</p>\n"}, {"tags": [], "owner": {"reputation": 16077, "user_id": 319702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Rb5G2.jpg?s=128&g=1", "display_name": "sameera207", "link": "https://stackoverflow.com/users/319702/sameera207"}, "is_accepted": false, "score": 0, "last_activity_date": 1572996161, "creation_date": 1572996161, "answer_id": 58720923, "question_id": 58720740, "link": "https://stackoverflow.com/questions/58720740/add-values-to-parameter-in-url-as-one-value-and-not-an-array-ruby/58720923#58720923", "title": "Add values to parameter in url as one value and not an array - Ruby", "body": "<p>Going by the standard rails convention, and assuming <code>items</code> goes to ItemsController#index action, you can do</p>\n\n<pre><code>#/items?item_ids?=1,2,3,4\ndef index \n  item_id_list = params[:item_ids]\nend\n</code></pre>\n\n<p>At this point, <code>item_id_list</code> will become a comma seperated string \"1,2,3,4\" and you can perform any string interpolation fuctions. </p>\n\n<p>E.g if you want all the ids to an array, you can do </p>\n\n<pre><code>item_id_list.split(\",\") #=&gt; [1,2,3,4] etc\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 12328952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7942c2b41e16f27485e65a4a35d6786c?s=128&d=identicon&r=PG&f=1", "display_name": "zezima", "link": "https://stackoverflow.com/users/12328952/zezima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 58720891, "answer_count": 2, "score": 2, "last_activity_date": 1572996161, "creation_date": 1572994823, "question_id": 58720740, "link": "https://stackoverflow.com/questions/58720740/add-values-to-parameter-in-url-as-one-value-and-not-an-array-ruby", "title": "Add values to parameter in url as one value and not an array - Ruby", "body": "<p>I have a method I would like to use for testing that just makes a GET request to a specific url. The parameter for the url is just one parameter with multiple values that can be passed seperated by commas. </p>\n\n<p>an ideal request should have the url look like : \n<code>url + \"/items?item_ids?=1,2,3,4\"</code></p>\n\n<p>My method accepts multiple arguments:</p>\n\n<p><code>def method(*args)\n   url = url + \"/items?item_ids?=#{args}\"\nend</code></p>\n\n<p>The issue I am having is that it will input the args into the url as an array which does not work. Is there a good way to add the arguments to the url not as an array and only seperated by commas? There will be an unknown number of arguments passed into this method. </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1572973003, "post_id": 58716011, "comment_id": 103725371, "body": "&quot;which&quot; is trivial to check in an IRB session. And answer to the &quot;why&quot; is &quot;because that&#39;s how it works&quot;"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 7, "creation_date": 1572973172, "post_id": 58716011, "comment_id": 103725457, "body": "Are you in the middle of taking a test, by any chance? :)"}, {"owner": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "edited": false, "score": 0, "creation_date": 1572973207, "post_id": 58716011, "comment_id": 103725476, "body": "try them in irb :) look wich give you the same types on the keys in the hash. NOTE: use ruby &gt;= 2.0.0"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "edited": false, "score": 0, "creation_date": 1572974236, "post_id": 58716011, "comment_id": 103725925, "body": "@Horacio, why &gt;= v2.0?"}, {"owner": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1572974593, "post_id": 58716011, "comment_id": 103726083, "body": "@CarySwoveland after ruby 1.9 they introduce a &quot;new&quot; (now old) hash syntax <a href=\"http://effectif.com/ruby/update-your-project-for-ruby-19-hash-syntax\" rel=\"nofollow noreferrer\">effectif.com/ruby/update-your-project-for-ruby-19-hash-synta&zwnj;&#8203;x</a>"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1572981076, "post_id": 58716011, "comment_id": 103728930, "body": "What does the documentation say? What did your experiments tell you?"}], "answers": [{"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1572990624, "post_id": 58716170, "comment_id": 103732809, "body": "&quot;<a href=\"https://meta.stackoverflow.com/q/334822/128421\">How do I ask and answer homework questions?</a>&quot; is useful."}], "tags": [], "owner": {"reputation": 841, "user_id": 12294425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxWNY.jpg?s=128&g=1", "display_name": "calebkm", "link": "https://stackoverflow.com/users/12294425/calebkm"}, "is_accepted": true, "score": 3, "last_activity_date": 1572973460, "creation_date": 1572973460, "answer_id": 58716170, "question_id": 58716011, "link": "https://stackoverflow.com/questions/58716011/ruby-data-types/58716170#58716170", "title": "Ruby Data Types", "body": "<p>There is a great discussion on using a Ruby <code>:symbol</code> vs a <code>String</code> <a href=\"https://stackoverflow.com/questions/8189416/why-use-symbols-as-hash-keys-in-ruby\">in another question here</a>.</p>\n\n<p>And here's a <a href=\"https://stackoverflow.com/questions/8198811/whats-the-difference-between-colon-and-fat-arrow\">nice discussion about the difference</a> between the fat arrow <code>=&gt;</code> syntax vs colons <code>:</code> in Ruby.</p>\n\n<p>You can quickly check that the two hashes using <code>:symbols</code> are equivalent to each other, which are both different from the hash using strings:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>a = {\"city\" =&gt; \"Miami\", \"state\" =&gt; \"Florida\"}\nb = {:city =&gt; \"Miami\", :state =&gt; \"Florida\"}\nc = {city: \"Miami\", state: \"Florida\"}\n\na == b\n=&gt; false\n\na == c\n=&gt; false\n\nb == c\n=&gt; true\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 12327519, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158086398608949/picture?type=large", "display_name": "Rod Terrell", "link": "https://stackoverflow.com/users/12327519/rod-terrell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "closed_date": 1573021980, "accepted_answer_id": 58716170, "answer_count": 1, "score": -4, "last_activity_date": 1572973460, "creation_date": 1572972867, "question_id": 58716011, "link": "https://stackoverflow.com/questions/58716011/ruby-data-types", "closed_reason": "Needs details or clarity", "title": "Ruby Data Types", "body": "<p>Which two of these three expressions are equal? Why?</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>{ \"city\" =&gt; \"Miami\", \"state\" =&gt; \"Florida\" }\n{ :city =&gt; \"Miami\", :state =&gt; \"Florida\" }\n{ city: \"Miami\", state: \"Florida\" }\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "edited": false, "score": 1, "creation_date": 1572970519, "post_id": 58715318, "comment_id": 103723982, "body": "show us how you was trying to do it and may we can help you"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 3, "creation_date": 1572970596, "post_id": 58715318, "comment_id": 103724026, "body": "Have you looked at <code>Date</code> and <code>Range</code>? Should be fairly straight forward from there."}, {"owner": {"reputation": 67, "user_id": 12327274, "user_type": "registered", "profile_image": "https://graph.facebook.com/1193022507557203/picture?type=large", "display_name": "Ahmad Arshi", "link": "https://stackoverflow.com/users/12327274/ahmad-arshi"}, "edited": false, "score": 0, "creation_date": 1572970768, "post_id": 58715318, "comment_id": 103724114, "body": "Can you please provide with a particular link?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1572972395, "post_id": 58715318, "comment_id": 103725023, "body": "<code>Date.current.all_month.to_a</code> should work, see <a href=\"https://api.rubyonrails.org/classes/DateAndTime/Calculations.html#method-i-all_month\" rel=\"nofollow noreferrer\"><code>all_month</code></a>"}, {"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 1, "creation_date": 1572972397, "post_id": 58715318, "comment_id": 103725027, "body": "FWIW: <a href=\"https://ruby-doc.org/stdlib-2.6.5/libdoc/date/rdoc/Date.html\" rel=\"nofollow noreferrer\">ruby-doc.org/stdlib-2.6.5/libdoc/date/rdoc/Date.html</a>"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1572991173, "post_id": 58715318, "comment_id": 103733037, "body": "&quot;<a href=\"https://meta.stackoverflow.com/q/334822/128421\">How do I ask and answer homework questions?</a>&quot; is useful."}], "answers": [{"tags": [], "owner": {"reputation": 841, "user_id": 12294425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxWNY.jpg?s=128&g=1", "display_name": "calebkm", "link": "https://stackoverflow.com/users/12294425/calebkm"}, "is_accepted": false, "score": 7, "last_activity_date": 1572972852, "creation_date": 1572972852, "answer_id": 58716006, "question_id": 58715318, "link": "https://stackoverflow.com/questions/58715318/how-to-create-dates-of-a-particular-month/58716006#58716006", "title": "How to create dates of a particular month", "body": "<p>Although there are quite a few ways you could accomplish this, one way would be to use a Ruby <a href=\"https://www.rubyguides.com/2016/06/ruby-ranges-how-do-they-work\" rel=\"noreferrer\"><code>Range</code></a> combined with the <a href=\"https://apidock.com/rails/Time/beginning_of_month\" rel=\"noreferrer\"><code>Time#beginning_of_month</code></a> and <a href=\"https://apidock.com/rails/Time/end_of_month\" rel=\"noreferrer\"><code>Time#end_of_month</code></a> methods to generate an object that contains all of the days of the month and then convert it into an array:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>(Date.today.beginning_of_month..Date.today.end_of_month).to_a\n=&gt; [Fri, 01 Nov 2019, Sat, 02 Nov 2019, Sun, 03 Nov 2019, Mon, 04 Nov 2019, Tue, 05 Nov 2019, Wed, 06 Nov 2019, ...., Fri, 29 Nov 2019, Sat, 30 Nov 2019]\n</code></pre>\n\n<p>Another option would be to use the <a href=\"https://apidock.com/rails/Time/all_month\" rel=\"noreferrer\"><code>Time#all_month</code></a> helper which is as simple as:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Date.today.all_month.to_a\n=&gt; [Fri, 01 Nov 2019, Sat, 02 Nov 2019, Sun, 03 Nov 2019, Mon, 04 Nov 2019, Tue, 05 Nov 2019, Wed, 06 Nov 2019, ...., Fri, 29 Nov 2019, Sat, 30 Nov 2019]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 2, "last_activity_date": 1572979484, "creation_date": 1572979484, "answer_id": 58717624, "question_id": 58715318, "link": "https://stackoverflow.com/questions/58715318/how-to-create-dates-of-a-particular-month/58717624#58717624", "title": "How to create dates of a particular month", "body": "<p>(Plain Ruby) The Date class uses negative numbers as a way of counting from the end (like in Arrays):</p>\n\n<pre><code>require \"date\"\n\ntoday = Date.today\nm, y  = today.month, today.year\np (Date.new(y,m,1) .. Date.new(y,m,-1)).to_a\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 12327274, "user_type": "registered", "profile_image": "https://graph.facebook.com/1193022507557203/picture?type=large", "display_name": "Ahmad Arshi", "link": "https://stackoverflow.com/users/12327274/ahmad-arshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1572982883, "creation_date": 1572970301, "last_edit_date": 1572982883, "question_id": 58715318, "link": "https://stackoverflow.com/questions/58715318/how-to-create-dates-of-a-particular-month", "title": "How to create dates of a particular month", "body": "<p>I want to generate all the dates of a particular month starting from the 1st of that month to the 30 or 31st of that month with out using a trivial <code>for</code> loop:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>for i in 1..Time.days_in_month(Date.today.month, Date.today.year)\n  date = Date.new(y, m, i)\nend\n</code></pre>\n\n<p>I was getting dates like this but I'm not supposed to use this trivial for loop.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1572969556, "post_id": 58714785, "comment_id": 103723376, "body": "Yes, you will. There&#39;s no reason to make one class more complex just because you want to save some lines of code. One class (as well as others) should do only one thing, and do it well. One class that does more than one thing must be separated and their functionalities distributed."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": false, "score": 2, "last_activity_date": 1572968580, "creation_date": 1572968580, "answer_id": 58714785, "question_id": 58714643, "link": "https://stackoverflow.com/questions/58714643/confirmation-mailers-how-to-avoid-code-duplication/58714785#58714785", "title": "Confirmation mailers - how to avoid code duplication", "body": "<p>If what changes are only the <code>subject</code> and layout, you can create a class that inherits from BaseMailer, which is then used to inherit <code>ShopProcess</code> and  <code>BankProcess</code> from, then you can try something like this:</p>\n\n<pre><code>class ConfirmationMailer &lt; BaseMailer\n  protected\n\n  def send_email(email)\n    mail_headers = headers(email)\n    mail(mail_headers)\n  end\n\n  def headers(email)\n    super(email).merge(subject: SUBJECT)\n  end\nend\n\n# frozen_string_literal: true\n\nclass BankProcess &lt; ConfirmationMailer\n  SUBJECT = 'Bank process'\n  layout 'bank_process'\nend\n\n# frozen_string_literal: true\n\nclass ShopProcess &lt; ConfirmationMailer\n  SUBJECT = 'Shop process'\n  layout 'shop_process'\nend\n</code></pre>\n"}], "owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1572968580, "creation_date": 1572968049, "question_id": 58714643, "link": "https://stackoverflow.com/questions/58714643/confirmation-mailers-how-to-avoid-code-duplication", "title": "Confirmation mailers - how to avoid code duplication", "body": "<p>I've got two different process in my app after which I want to send to user a confirmation email after each process is finished. I could create two separate mailers eg. <code>BankProcessMailer</code> and <code>ShopProcessMailer</code> but they would contain the same code like below:</p>\n\n<pre><code>class BankProcess &lt; BaseMailer\n  layout 'bank_process'\n\n  def send_email(email)\n    mail_headers = headers(email)\n    mail(mail_headers)\n  end\n\n  private\n\n  def headers(email)\n    super(email).merge(subject: 'Bank process')\n  end\nend\n</code></pre>\n\n<p>Is there any chance to handle one mailer with two different views and subjects to avoid code duplication and don't create new mailer for <code>ShopProcessMailer</code> like below ?</p>\n\n<pre><code>class ShopProcess &lt; BaseMailer\n  layout 'shop_process'\n\n  def send_email(email)\n    mail_headers = headers(email)\n    mail(mail_headers)\n  end\n\n  private\n\n  def headers(email)\n    super(email).merge(subject: 'Shop process')\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1573027409, "post_id": 58714364, "comment_id": 103742579, "body": "What database do you use?"}], "answers": [{"comments": [{"owner": {"reputation": 2104, "user_id": 1216272, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/77512fe46dec389c7bc5d85c6a321638?s=128&d=identicon&r=PG", "display_name": "Kunal Vashist", "link": "https://stackoverflow.com/users/1216272/kunal-vashist"}, "edited": false, "score": 0, "creation_date": 1573129098, "post_id": 58726015, "comment_id": 103785643, "body": "Doesn&#39;t helped me ,"}], "tags": [], "owner": {"reputation": 2518, "user_id": 762606, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/91ec89bebde3176c1e64172d0ee6c1a2?s=128&d=identicon&r=PG", "display_name": "Dipil", "link": "https://stackoverflow.com/users/762606/dipil"}, "is_accepted": false, "score": 0, "last_activity_date": 1573029469, "creation_date": 1573029469, "answer_id": 58726015, "question_id": 58714364, "link": "https://stackoverflow.com/questions/58714364/transaction-block-prevents-the-commit-to-happen-in-database-how-can-we-skip-cert/58726015#58726015", "title": "Transaction block prevents the commit to happen in database how can we skip certain thing?", "body": "<p>To skip a particular db action within an existing transaction, you can execute it in a separate thread. E.g.for your case above</p>\n\n<pre><code>  ...\n  Thread.new do\n    ActiveRecord::Base.connection_pool.with_connection do\n      job.update_column(total_number: loop_index)\n    end\n  end.join\n  ... # continue method\n</code></pre>\n"}], "owner": {"reputation": 2104, "user_id": 1216272, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/77512fe46dec389c7bc5d85c6a321638?s=128&d=identicon&r=PG", "display_name": "Kunal Vashist", "link": "https://stackoverflow.com/users/1216272/kunal-vashist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573029469, "creation_date": 1572967049, "question_id": 58714364, "link": "https://stackoverflow.com/questions/58714364/transaction-block-prevents-the-commit-to-happen-in-database-how-can-we-skip-cert", "title": "Transaction block prevents the commit to happen in database how can we skip certain thing?", "body": "<p>I am using transaction block and doing some operation inside the block, there are certain things that should ignore transaction block, i can't move the update from the transaction block as it is tightly couple with code.</p>\n\n<p>How can we skip certain portion and let the rest behaviour as usual</p>\n\n<pre><code>Record.transaction do\n  check_for_errors required_columns\n  create_report\nend\n\ndef check_for_errors\n loop\n  ...\n begin\n  Methods\n  // want to skip this perticular db update from transaction block\n  job.update_column(total_number: loop index)\n  // as this is under transaction block no changes can be seen on ui\n rescue =&gt; e\n    populate_error_message(e.message)\n    raise ActiveRecord::Rollback\n  end\n end\nend\n</code></pre>\n\n<p>Any idea what can be done in this case?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "metaprogramming", "instance-variables"], "answers": [{"comments": [{"owner": {"reputation": 765, "user_id": 9015957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xwHPf.jpg?s=128&g=1", "display_name": "vikas95prasad", "link": "https://stackoverflow.com/users/9015957/vikas95prasad"}, "edited": false, "score": 0, "creation_date": 1572961292, "post_id": 58712551, "comment_id": 103718469, "body": "How can I access the hash using this ?"}, {"owner": {"reputation": 765, "user_id": 9015957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xwHPf.jpg?s=128&g=1", "display_name": "vikas95prasad", "link": "https://stackoverflow.com/users/9015957/vikas95prasad"}, "edited": false, "score": 0, "creation_date": 1572961807, "post_id": 58712551, "comment_id": 103718765, "body": "NameError (`@resource[13739]&#39; is not allowed as an instance variable name) Got this error after using  instance_variable_get"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 765, "user_id": 9015957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xwHPf.jpg?s=128&g=1", "display_name": "vikas95prasad", "link": "https://stackoverflow.com/users/9015957/vikas95prasad"}, "edited": false, "score": 0, "creation_date": 1572964550, "post_id": 58712551, "comment_id": 103720412, "body": "@vikas95prasad: of course, the square brackets and the number are not part of the instance variable name, so don&#39;t put them there."}, {"owner": {"reputation": 765, "user_id": 9015957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xwHPf.jpg?s=128&g=1", "display_name": "vikas95prasad", "link": "https://stackoverflow.com/users/9015957/vikas95prasad"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1572964917, "post_id": 58712551, "comment_id": 103720624, "body": "@mrzasa this is how i used it and it works  instance_variable_get(&quot;@#{attribute}&quot;)[comment.id]"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 1, "last_activity_date": 1572961171, "creation_date": 1572961171, "answer_id": 58712551, "question_id": 58712522, "link": "https://stackoverflow.com/questions/58712522/ruby-metaprogramming-to-achieve-dynamic-methods/58712551#58712551", "title": "Ruby metaprogramming to achieve dynamic methods?", "body": "<blockquote>\n  <p>Can you tell me what is wrong in my code ?</p>\n</blockquote>\n\n<p>It's doing the equivalent of this:  </p>\n\n<pre><code>def resource(comment)\n  @resource = comment.id\nend\n</code></pre>\n\n<p><code>instance_variable_get</code> would be a better choice.</p>\n"}, {"tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 2, "last_activity_date": 1572963769, "last_edit_date": 1572963769, "creation_date": 1572962425, "answer_id": 58712958, "question_id": 58712522, "link": "https://stackoverflow.com/questions/58712522/ruby-metaprogramming-to-achieve-dynamic-methods/58712958#58712958", "title": "Ruby metaprogramming to achieve dynamic methods?", "body": "<p>This bit seems redundant:</p>\n\n<pre><code>@resource = {}\n@voters = {}\n@is_upvoted = {}\n</code></pre>\n\n<p>Since you're already looping an array to do your metaprogramming. </p>\n\n<p>You might try something like:</p>\n\n<pre><code>class Foo \n\n  %w(\n    resource\n    voters\n    is_upvoted\n  ).each do |attr_sym|\n    define_method attr_sym do |comment|\n      instance_variable_set(\"@#{attr_sym}\", {}) unless instance_variable_get(\"@#{attr_sym}\")\n      instance_variable_get(\"@#{attr_sym}\")[comment.id]\n    end\n  end\n\nend\n</code></pre>\n\n<p>Which I believe will give you methods roughly like: </p>\n\n<pre><code>class Foo \n\n  def resource(comment)\n    @resource ||= {}\n    @resource[comment.id]\n  end\n\nend\n</code></pre>\n\n<p>Personally, it seems not great to me to have <code>comment.id</code> in your method. Because what if someday you want to use a different attribute (or something else altogether) as the <code>key</code>?</p>\n\n<p>So, I think I would do: </p>\n\n<pre><code>class Foo \n\n  %w(\n    resource\n    voters\n    is_upvoted\n  ).each do |attr_sym|\n    define_method attr_sym do |key|\n      instance_variable_set(\"@#{attr_sym}\", {}) unless instance_variable_get(\"@#{attr_sym}\")\n      instance_variable_get(\"@#{attr_sym}\")[key]\n    end\n  end\n\nend\n</code></pre>\n\n<p>Now, it seems like you're going to want an easy way to set key-value pairs on your instance variable, so I guess I would try something like: </p>\n\n<pre><code>class Foo \n\n  %w(\n    resource\n    voters\n    is_upvoted\n  ).each do |attr_sym|\n    define_method attr_sym do |key=nil|\n      instance_variable_set(\"@#{attr_sym}\", {}) unless instance_variable_get(\"@#{attr_sym}\")\n      hsh = instance_variable_get(\"@#{attr_sym}\")\n      return hsh[key] if key\n      hsh\n    end\n  end\n\nend\n</code></pre>\n\n<p>In which case you should be able to do (assuming you have a <code>@comment</code> variable that responds to <code>id</code>): </p>\n\n<pre><code>@comment.id \n =&gt; 1 \nfoo = Foo.new\n =&gt; #&lt;Foo:0x000056536d7504b0&gt;\nfoo.resource \n =&gt; {}\nfoo.resource[@comment.id] = :bar\n =&gt; :bar \nfoo.resource \n =&gt; {1=&gt;:bar}\nfoo.resource[@comment.id]\n =&gt; :bar\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 765, "user_id": 9015957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xwHPf.jpg?s=128&g=1", "display_name": "vikas95prasad", "link": "https://stackoverflow.com/users/9015957/vikas95prasad"}, "is_accepted": false, "score": 0, "last_activity_date": 1572964988, "creation_date": 1572964988, "answer_id": 58713745, "question_id": 58712522, "link": "https://stackoverflow.com/questions/58712522/ruby-metaprogramming-to-achieve-dynamic-methods/58713745#58713745", "title": "Ruby metaprogramming to achieve dynamic methods?", "body": "<p>This is how I used it and it works</p>\n\n<pre><code>['resource', 'voters', 'is_upvoted'].each do |attribute|\n  define_method(\"#{attribute}\") do |comment|\n    instance_variable_get(\"@#{attribute}\")[comment.id]\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 765, "user_id": 9015957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xwHPf.jpg?s=128&g=1", "display_name": "vikas95prasad", "link": "https://stackoverflow.com/users/9015957/vikas95prasad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 58712958, "answer_count": 3, "score": 0, "last_activity_date": 1572964988, "creation_date": 1572961075, "question_id": 58712522, "link": "https://stackoverflow.com/questions/58712522/ruby-metaprogramming-to-achieve-dynamic-methods", "title": "Ruby metaprogramming to achieve dynamic methods?", "body": "<p>Want to achieve the following code using metaprogramming.</p>\n\n<pre><code>@resource = {}\n@voters = {}\n@is_upvoted = {}\n\ndef resource(comment)\n  @resource[comment.id]\nend\n\ndef voters(comment)\n  @voters[comment.id]\nend\n\ndef is_upvoted(comment)\n  @is_upvoted[comment.id]\nend\n</code></pre>\n\n<p>How can I create these methods using ruby metaprogramming and access the hash?</p>\n\n<p>Can you tell me what is wrong in my code ? </p>\n\n<pre><code>['resource', 'voters', 'is_upvoted'].each do |attribute|\n  define_method(\"#{attribute}\") do |comment|\n    instance_variable_set(\"@#{attribute}\", comment.id)\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "nameerror"], "comments": [{"owner": {"reputation": 1534, "user_id": 4453714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fv4Fb.jpg?s=128&g=1", "display_name": "Yurii Verbytskyi", "link": "https://stackoverflow.com/users/4453714/yurii-verbytskyi"}, "edited": false, "score": 2, "creation_date": 1572960354, "post_id": 58712217, "comment_id": 103718014, "body": "Hi, <code>pos_or_neg == true</code> looks like you was trying to do <code>pos_or_neg = true</code> here in first case"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1572979865, "post_id": 58712217, "comment_id": 103728369, "body": "Try not to stack multiple Ruby statements with <code>;</code>. One of the best things about Ruby is how easy it is to read and that defeats the purpose. You also don&#39;t need to do logical comparisons like <code>x == true</code> if <code>x</code> is a boolean value, just do <code>x</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1572980017, "post_id": 58712217, "comment_id": 103728448, "body": "Although they might be a bit dizzying to pick up on, this sort of problem lends itself to using regular expressions: <code>&#47;\\A(\\d+)d(\\d+)(?:[\\-\\+]?\\d})\\z&#47;</code> will match strings of the form <code>NdN+&#47;-N</code> and breaks out the parts into three distinct values you can operate on."}, {"owner": {"reputation": 165, "user_id": 12326207, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDHsGq7X3-xykfi7nBJ3k3l1ptfcveGFc1DZ-Mj=k-s128", "display_name": "Richard", "link": "https://stackoverflow.com/users/12326207/richard"}, "edited": false, "score": 0, "creation_date": 1573057748, "post_id": 58712217, "comment_id": 103759309, "body": "Thanks Yurii and tadman. I will look into regular expressions. They seem like a better way of going about things."}], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 12326207, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDHsGq7X3-xykfi7nBJ3k3l1ptfcveGFc1DZ-Mj=k-s128", "display_name": "Richard", "link": "https://stackoverflow.com/users/12326207/richard"}, "edited": false, "score": 0, "creation_date": 1572969298, "post_id": 58713387, "comment_id": 103723229, "body": "Hey, thanks for the advice! I didn&#39;t really know how to deal with situations when there is no modifier. I still don&#39;t understand why <code>fin</code> isn&#39;t being defined when <code>pos_or_neg</code> is false."}, {"owner": {"reputation": 1202, "user_id": 147204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e593ac63e5f25649b701dc25f69d1b7?s=128&d=identicon&r=PG", "display_name": "luis.parravicini", "link": "https://stackoverflow.com/users/147204/luis-parravicini"}, "reply_to_user": {"reputation": 165, "user_id": 12326207, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDHsGq7X3-xykfi7nBJ3k3l1ptfcveGFc1DZ-Mj=k-s128", "display_name": "Richard", "link": "https://stackoverflow.com/users/12326207/richard"}, "edited": false, "score": 0, "creation_date": 1572972604, "post_id": 58713387, "comment_id": 103725157, "body": "@Richard I was not aware the last assigment was valid the way you did it, I thought it was an error. Updated my answer. Sorry!"}], "tags": [], "owner": {"reputation": 1202, "user_id": 147204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e593ac63e5f25649b701dc25f69d1b7?s=128&d=identicon&r=PG", "display_name": "luis.parravicini", "link": "https://stackoverflow.com/users/147204/luis-parravicini"}, "is_accepted": true, "score": 1, "last_activity_date": 1572972501, "last_edit_date": 1572972501, "creation_date": 1572963809, "answer_id": 58713387, "question_id": 58712217, "link": "https://stackoverflow.com/questions/58712217/making-a-dice-roller-for-dd-why-is-ruby-giving-me-a-nameerror/58713387#58713387", "title": "Making a dice roller for D&amp;D; why is Ruby giving me a NameError?", "body": "<p>What Yurii said in the comment to your question, you are comparing (<code>==</code>) instead of assigning the value (<code>=</code>).</p>\n\n<p>But also, if there's neither '+' nor '-' in <code>input</code> then <code>pos_or_neg</code> won't be defined. You could change the line:</p>\n\n<pre><code> pos_or_neg == true if input.include? \"+\"; pos_or_neg == false if input.include? \"-\"\n</code></pre>\n\n<p>with:</p>\n\n<pre><code> pos_or_neg = !input.include?('-')\n</code></pre>\n\n<p>(assuming that the case when there's neither '+' nor '-' is taken as positive)</p>\n\n<p>And (I think) it would be more readable if you change this line:</p>\n\n<pre><code>pos_or_neg == true ? fin = roll(amount, sides) + mod.to_i : roll(amount, sides) - mod.to_i\n</code></pre>\n\n<p>with</p>\n\n<pre><code>  fin = roll(amount, sides) + mod.to_i * (pos_or_neg ? 1 : -1)\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 12326207, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDHsGq7X3-xykfi7nBJ3k3l1ptfcveGFc1DZ-Mj=k-s128", "display_name": "Richard", "link": "https://stackoverflow.com/users/12326207/richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 58713387, "answer_count": 1, "score": 0, "last_activity_date": 1572972501, "creation_date": 1572960002, "question_id": 58712217, "link": "https://stackoverflow.com/questions/58712217/making-a-dice-roller-for-dd-why-is-ruby-giving-me-a-nameerror", "title": "Making a dice roller for D&amp;D; why is Ruby giving me a NameError?", "body": "<p>I'm very new to coding and have been trying to improve upon a dice roller for D&amp;D that I found <a href=\"https://codereview.stackexchange.com/questions/185121/dice-roller-in-ruby-mainly-for-dd\">here</a>. I have a variable that determines if the roll's modifier is positive or negative, but for some reason Ruby is giving me a NameError (undefined local variable or method `pos_or_neg' for main:Object). Would also appreciate general advice for making my code better.</p>\n\n<pre><code>def roll(amount = 0, sides = 0)\n  #For every die(amount), randomly generate a result limited to sides, then add all results together.\n  amount.to_i.times.sum { |t| rand(1..sides.to_i) }\nend\n\nputs \"Gimme some dice to roll! (e.g. 2d4, 1d12-1, etc.)\"\nloop do\n  input = gets.chomp.to_s\n\n  abort(\"May your rolls be ever natural.\") if input == \"exit\"\n  next puts \"Please specify the number of dice!\" if input.start_with?(\"d\")\n\n  #Check if modifier is positive or negative.\n  pos_or_neg == true if input.include? \"+\"; pos_or_neg == false if input.include? \"-\"\n\n  #Replace everything but numbers with spaces in input, then split.\n  amount, sides, mod = input.tr(\"^0-9\", \" \").split\n\n  #Calculate final result using pos_or_neg to determine modifier.\n  pos_or_neg == true ? fin = roll(amount, sides) + mod.to_i : roll(amount, sides) - mod.to_i\n  puts fin\n\nend\n</code></pre>\n\n<p>I apologize if this kind of thing is asked often.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "metaprogramming"], "comments": [{"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1572955676, "post_id": 58711010, "comment_id": 103715708, "body": "how is it not working? Throwing an error of some kind? Does it have to do with mixing up a string and a method? (<code>.each do |method|</code> and then later on <code>method(...)</code>)?"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 3, "creation_date": 1572956045, "post_id": 58711010, "comment_id": 103715893, "body": "You can simply delegate those methods to <code>comment</code>."}, {"owner": {"reputation": 765, "user_id": 9015957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xwHPf.jpg?s=128&g=1", "display_name": "vikas95prasad", "link": "https://stackoverflow.com/users/9015957/vikas95prasad"}, "reply_to_user": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1572958002, "post_id": 58711010, "comment_id": 103716784, "body": "ArgumentError (wrong number of arguments (given 0, expected 1))  @SimpleLime"}], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 3, "last_activity_date": 1572955641, "creation_date": 1572955641, "answer_id": 58711048, "question_id": 58711010, "link": "https://stackoverflow.com/questions/58711010/how-to-dynamically-create-methods-with-parameter-in-ruby/58711048#58711048", "title": "How to dynamically create methods with parameter in ruby?", "body": "<p>You should use <code>public_send</code> to call methods based on their name:</p>\n\n<pre><code>  ['id', 'message', 'votes_count'].each do |method|\n    define_method \"#{method}\" do |parameter|\n      parameter.public_send(method)\n    end\n  end\n</code></pre>\n"}], "owner": {"reputation": 765, "user_id": 9015957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xwHPf.jpg?s=128&g=1", "display_name": "vikas95prasad", "link": "https://stackoverflow.com/users/9015957/vikas95prasad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 58711048, "answer_count": 1, "score": 2, "last_activity_date": 1572955670, "creation_date": 1572955488, "last_edit_date": 1572955670, "question_id": 58711010, "link": "https://stackoverflow.com/questions/58711010/how-to-dynamically-create-methods-with-parameter-in-ruby", "title": "How to dynamically create methods with parameter in ruby?", "body": "<p>How can I dynamically create methods like this using ruby metaprogramming ?</p>\n\n<pre><code>class CommentBridge &lt; Bridge\n\n  def id(comment)\n    comment.id\n  end\n\n  def message(comment)\n    comment.message\n  end\n\n  def votes_count(comment)\n    comment.votes_count\n  end\n\nend\n</code></pre>\n\n<p>I tried this but it is not working.</p>\n\n<pre><code>  ['id', 'message', 'votes_count'].each do |method|\n    define_method \"#{method}\" do |parameter|\n      method(parameter.method)\n    end\n  end\n</code></pre>\n"}, {"tags": ["php", "ruby", "macos", "macos-catalina"], "comments": [{"owner": {"reputation": 6075, "user_id": 7611062, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jgqAm.png?s=128&g=1", "display_name": "treyBake", "link": "https://stackoverflow.com/users/7611062/treybake"}, "edited": false, "score": 0, "creation_date": 1572950322, "post_id": 58709553, "comment_id": 103713008, "body": "<code>But not when it&#39;s from PHP.</code> &lt;- define where PHP is?"}, {"owner": {"reputation": 1769, "user_id": 1753002, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/DE3in.jpg?s=128&g=1", "display_name": "Florian Mac Langlade", "link": "https://stackoverflow.com/users/1753002/florian-mac-langlade"}, "reply_to_user": {"reputation": 6075, "user_id": 7611062, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jgqAm.png?s=128&g=1", "display_name": "treyBake", "link": "https://stackoverflow.com/users/7611062/treybake"}, "edited": false, "score": 0, "creation_date": 1572950698, "post_id": 58709553, "comment_id": 103713192, "body": "PHP is executed from MAMP Apache2. PHP is in /usr/bin/php folder"}, {"owner": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "edited": false, "score": 1, "creation_date": 1572951956, "post_id": 58709553, "comment_id": 103713858, "body": "If you try with full path in your php script  &quot;/usr/bin/ruby /my/path/duplicate_ios.rb&quot; it works?"}, {"owner": {"reputation": 1769, "user_id": 1753002, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/DE3in.jpg?s=128&g=1", "display_name": "Florian Mac Langlade", "link": "https://stackoverflow.com/users/1753002/florian-mac-langlade"}, "edited": false, "score": 0, "creation_date": 1572959813, "post_id": 58709553, "comment_id": 103717728, "body": "Thanks, but do not works."}], "answers": [{"comments": [{"owner": {"reputation": 1769, "user_id": 1753002, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/DE3in.jpg?s=128&g=1", "display_name": "Florian Mac Langlade", "link": "https://stackoverflow.com/users/1753002/florian-mac-langlade"}, "edited": false, "score": 0, "creation_date": 1572960510, "post_id": 58712171, "comment_id": 103718086, "body": "I&#39;ve installed ruby : it works from the terminal, but not from the php script"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 1, "last_activity_date": 1572959877, "creation_date": 1572959877, "answer_id": 58712171, "question_id": 58709553, "link": "https://stackoverflow.com/questions/58709553/mac-os-catalina-cant-execute-ruby-from-php/58712171#58712171", "title": "Mac OS Catalina : Can&#39;t execute ruby from PHP", "body": "<p>Apple has removed Ruby and other scripting languages from their OS, <a href=\"https://developer.apple.com/documentation/macos_release_notes/macos_catalina_10_15_release_notes#3318257\" rel=\"nofollow noreferrer\">see deprecations</a> </p>\n\n<p>You probably will want to use a ruby version manager such as RVM.  For install instructions see <a href=\"https://rvm.io/rvm/install\" rel=\"nofollow noreferrer\">https://rvm.io/rvm/install</a></p>\n"}, {"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 1, "last_activity_date": 1572986512, "creation_date": 1572986512, "answer_id": 58719179, "question_id": 58709553, "link": "https://stackoverflow.com/questions/58709553/mac-os-catalina-cant-execute-ruby-from-php/58719179#58719179", "title": "Mac OS Catalina : Can&#39;t execute ruby from PHP", "body": "<p>For maintaining a current, up-to-date environment on macOS you have several options:</p>\n\n<ul>\n<li><a href=\"https://github.com/rbenv/rbenv\" rel=\"nofollow noreferrer\"><code>rbenv</code></a> which is a minimally invasive version manager you can install with <a href=\"https://brew.sh\" rel=\"nofollow noreferrer\">Homebrew</a>.</li>\n<li><a href=\"https://rvm.io\" rel=\"nofollow noreferrer\"><code>rvm</code></a> which is more cross-platform, but which embeds more deeply in your shell environment.</li>\n</ul>\n\n<p>Both of these allow you to install different versions of Ruby simultaneously and switch between them automatically with a <code>.ruby-version</code> file in your project's directory. This makes working with older code-bases quite effortless.</p>\n\n<p>They also allow you to install Ruby gems without having to <code>sudo</code> anything as the gems are installed for one user only.</p>\n\n<p><strong>WARNING</strong>: When calling <code>system()</code> in PHP it's extremely important to properly escape any and all data arguments. Use <a href=\"https://www.php.net/manual/en/function.escapeshellcmd.php\" rel=\"nofollow noreferrer\"><code>escapeshellcmd</code></a> to handle the escaping. If you fail to do this you run the risk of command errors due to conflicting quotes, or worse, as a user could potentially hijack your system by running arbitrary shell commands.</p>\n"}, {"tags": [], "owner": {"reputation": 1769, "user_id": 1753002, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/DE3in.jpg?s=128&g=1", "display_name": "Florian Mac Langlade", "link": "https://stackoverflow.com/users/1753002/florian-mac-langlade"}, "is_accepted": true, "score": 0, "last_activity_date": 1573113410, "creation_date": 1573113410, "answer_id": 58744237, "question_id": 58709553, "link": "https://stackoverflow.com/questions/58709553/mac-os-catalina-cant-execute-ruby-from-php/58744237#58744237", "title": "Mac OS Catalina : Can&#39;t execute ruby from PHP", "body": "<p><strong>SOLUTION :</strong></p>\n\n<p>PHP was run in MAMP, which using a special ruby version.</p>\n\n<p>Use \"php -S 192.168.xx.xx:8888\" instead of MAMP fixed the problem !</p>\n"}], "owner": {"reputation": 1769, "user_id": 1753002, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/DE3in.jpg?s=128&g=1", "display_name": "Florian Mac Langlade", "link": "https://stackoverflow.com/users/1753002/florian-mac-langlade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 58744237, "answer_count": 3, "score": 1, "last_activity_date": 1573113410, "creation_date": 1572950293, "last_edit_date": 1572970434, "question_id": 58709553, "link": "https://stackoverflow.com/questions/58709553/mac-os-catalina-cant-execute-ruby-from-php", "title": "Mac OS Catalina : Can&#39;t execute ruby from PHP", "body": "<p>I've updated my Mac to Catalina version.\nSince this new release of Mac OS, i'm not able to execute ruby from PHP anymore.</p>\n\n<p>I can't find anything of internet.</p>\n\n<p>This is how I call ruby from PHP</p>\n\n<pre><code>$cmd = \"ruby duplicate_ios.rb '$xcode_version' '$xcodeproj_path' '$bundle_id' '$display_name' '$target_source' '$target_destination' '$iosTeamID'\";\n$outputDuplicateTarget = system($cmd);\n</code></pre>\n\n<p>When I execute from terminal, it works.\nBut not when it's from PHP.\nAnd before Catalina release, it worked.</p>\n\n<p><strong>EDIT</strong>\nin ruby script</p>\n\n<pre><code>require \"xcodeproj\"\n</code></pre>\n\n<p>=> seem to be the origin of the crash (only from php script)</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1572972619, "post_id": 58709210, "comment_id": 103725166, "body": "You don&#39;t transform elements into an array, you simply put them into it, i.e. <code>[:en]</code> instead of <code>:en.to_a</code>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1572972920, "post_id": 58709210, "comment_id": 103725317, "body": "BTW, in Rails you can use <code>I18n.available_locales.without(I18n.locale)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 8, "last_activity_date": 1572953162, "last_edit_date": 1572953162, "creation_date": 1572949458, "answer_id": 58709293, "question_id": 58709210, "link": "https://stackoverflow.com/questions/58709210/executing-a-calculation-on-an-array-of-symbols/58709293#58709293", "title": "Executing a calculation on an array of symbols", "body": "<p>Make the second operand an array too, like this (for example): </p>\n\n<pre><code>I18n.available_locales - [I18n.locale]\n</code></pre>\n\n<blockquote>\n  <p>So what is the way to execute the calculation if the end-intent is to</p>\n</blockquote>\n\n<p>I'd probably do it inline (this way you can avoid patching I18n)</p>\n\n<pre><code>&lt;% I18n.available_locales.each do |locale| %&gt;\n   &lt;% next if locale == I18n.locale %&gt;\n   &lt;li&gt;&lt;%= link_to locale.to_s, { locale: locale } %&gt;&lt;/li&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "is_accepted": false, "score": 0, "last_activity_date": 1572950017, "creation_date": 1572950017, "answer_id": 58709467, "question_id": 58709210, "link": "https://stackoverflow.com/questions/58709210/executing-a-calculation-on-an-array-of-symbols/58709467#58709467", "title": "Executing a calculation on an array of symbols", "body": "<p>It's because <a href=\"https://ruby-doc.org/core-1.9.3/Array.html#method-i-2D\" rel=\"nofollow noreferrer\">operator</a> - needs an array</p>\n\n<p>try</p>\n\n<pre><code>2.2.10 :003 &gt; [:a,:b,:c] - [:a]\n =&gt; [:b, :c]\n</code></pre>\n\n<p>In your case would be something like</p>\n\n<pre><code>I18n.available_locales - [I18n.locale]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "is_accepted": false, "score": 0, "last_activity_date": 1572950515, "creation_date": 1572950515, "answer_id": 58709630, "question_id": 58709210, "link": "https://stackoverflow.com/questions/58709210/executing-a-calculation-on-an-array-of-symbols/58709630#58709630", "title": "Executing a calculation on an array of symbols", "body": "<p>In such cases, you can use <code>Array()</code> method</p>\n\n<pre><code>Array(I18n.locale)\n#=&gt; [:en]\n\nArray([I18n.locale])\n#=&gt; [:en]\n\nArray(nil)\n#=&gt; []\n\nI18n.available_locales - Array(I18n.locale)\n#=&gt; [:it, :fr, :de]\n</code></pre>\n\n<p><em>Reference:</em> <a href=\"https://ruby-doc.org/core-2.6/Array.html\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.6/Array.html</a></p>\n"}], "owner": {"reputation": 4075, "user_id": 2291357, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/dff442b2192921f04f324948d263e001?s=128&d=identicon&r=PG", "display_name": "Jerome", "link": "https://stackoverflow.com/users/2291357/jerome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 58709293, "answer_count": 3, "score": 2, "last_activity_date": 1572953162, "creation_date": 1572949185, "question_id": 58709210, "link": "https://stackoverflow.com/questions/58709210/executing-a-calculation-on-an-array-of-symbols", "title": "Executing a calculation on an array of symbols", "body": "<p>Working with and array of symbols</p>\n\n<pre><code>&gt; I18n.available_locales\n[:en, :it, :fr, :de]\n&gt; I18n.locale\n:en\n</code></pre>\n\n<p>running an array calculation</p>\n\n<pre><code>&gt; I18n.available_locales - I18n.locale\n</code></pre>\n\n<p>returns the error:</p>\n\n<pre><code>TypeError (no implicit conversion of Symbol into Array)\n</code></pre>\n\n<p>one cannot operate on the component to calculate with to transform it into an array</p>\n\n<pre><code>&gt; I18n.locale.to_a\nNoMethodError (undefined method `to_a' for :en:Symbol)\n</code></pre>\n\n<p>So what is the way to  execute the calculation if the end-intent is to</p>\n\n<pre><code>&lt;% I18n.inactive_locales.each do |locale| %&gt;\n   &lt;li&gt;&lt;%= link_to locale.to_s, { locale: locale } %&gt;&lt;/li&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby", "version"], "comments": [{"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1572950316, "post_id": 58708883, "comment_id": 103713005, "body": "Does &#39;extensive&#39; mean <code>git log</code>? Or are you just looking for an overview?"}, {"owner": {"reputation": 35, "user_id": 10358427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00e48322da3b1b5d2dc9028f0b1ead7?s=128&d=identicon&r=PG&f=1", "display_name": "onqi", "link": "https://stackoverflow.com/users/10358427/onqi"}, "reply_to_user": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1572956113, "post_id": 58708883, "comment_id": 103715928, "body": "I was just looking for an overview, the other answer was exactly what I was looking for! Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 1202, "user_id": 147204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e593ac63e5f25649b701dc25f69d1b7?s=128&d=identicon&r=PG", "display_name": "luis.parravicini", "link": "https://stackoverflow.com/users/147204/luis-parravicini"}, "is_accepted": true, "score": 0, "last_activity_date": 1572949071, "creation_date": 1572949071, "answer_id": 58709170, "question_id": 58708883, "link": "https://stackoverflow.com/questions/58708883/how-to-find-extensive-ruby-version-changelogs/58709170#58709170", "title": "How to find extensive Ruby version changelogs?", "body": "<p>Here <a href=\"https://www.ruby-lang.org/en/downloads/releases/\" rel=\"nofollow noreferrer\">https://www.ruby-lang.org/en/downloads/releases/</a> are the changelogs of each version.</p>\n"}], "owner": {"reputation": 35, "user_id": 10358427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00e48322da3b1b5d2dc9028f0b1ead7?s=128&d=identicon&r=PG&f=1", "display_name": "onqi", "link": "https://stackoverflow.com/users/10358427/onqi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 58709170, "answer_count": 1, "score": 0, "last_activity_date": 1572949071, "creation_date": 1572948101, "question_id": 58708883, "link": "https://stackoverflow.com/questions/58708883/how-to-find-extensive-ruby-version-changelogs", "title": "How to find extensive Ruby version changelogs?", "body": "<p>At the company where I am working, there is a huge codebase currently running on Ruby 1.6.8 (2002), which I am tasked with updating to the latest possible version.</p>\n\n<p>There already exists a documentation, which explains how to update the code to Ruby 1.9.3, but even then there is not much documentation which explains the changes which 2.x introduced.</p>\n\n<p>This documentation is also not ideal for me, since it wasn't extensive enough. Is there a website where I can find the changelogs for every Ruby version?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 659, "user_id": 2695716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/51Wgc.jpg?s=128&g=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/2695716/dennis"}, "edited": false, "score": 0, "creation_date": 1572946693, "post_id": 58707697, "comment_id": 103710964, "body": "Have you tried the solutions detailed in this stack overflow question? <a href=\"https://stackoverflow.com/questions/33996523/error-installing-nokogiri-failed-to-build-gem-native-extension-libiconv-is-mi\" title=\"error installing nokogiri failed to build gem native extension libiconv is mi\">stackoverflow.com/questions/33996523/&hellip;</a>"}, {"owner": {"reputation": 5425, "user_id": 3779419, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/EXtxc.jpg?s=128&g=1", "display_name": "Shota", "link": "https://stackoverflow.com/users/3779419/shota"}, "reply_to_user": {"reputation": 659, "user_id": 2695716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/51Wgc.jpg?s=128&g=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/2695716/dennis"}, "edited": false, "score": 0, "creation_date": 1572950871, "post_id": 58707697, "comment_id": 103713288, "body": "Yes, tried all of them."}, {"owner": {"reputation": 659, "user_id": 2695716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/51Wgc.jpg?s=128&g=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/2695716/dennis"}, "edited": false, "score": 0, "creation_date": 1572966388, "post_id": 58707697, "comment_id": 103721452, "body": "What does the /Library/Ruby/Gems/2.3.0/extensions/universal-darwin-18/2.3.&zwnj;&#8203;0/nokogiri-1.10.5/ge&zwnj;&#8203;m_make.out file say ?"}, {"owner": {"reputation": 5425, "user_id": 3779419, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/EXtxc.jpg?s=128&g=1", "display_name": "Shota", "link": "https://stackoverflow.com/users/3779419/shota"}, "reply_to_user": {"reputation": 659, "user_id": 2695716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/51Wgc.jpg?s=128&g=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/2695716/dennis"}, "edited": false, "score": 0, "creation_date": 1572966735, "post_id": 58707697, "comment_id": 103721663, "body": "@Dennis it says: <code>current directory: &#47;Library&#47;Ruby&#47;Gems&#47;2.3.0&#47;gems&#47;nokogiri-1.10.5&#47;ext&#47;nokogiri &#47;System&#47;Library&#47;Frameworks&#47;Ruby.framework&#47;Versions&#47;2.3&#47;usr&#47;b&zwnj;&#8203;in&#47;ruby -I &#47;Library&#47;Ruby&#47;Site&#47;2.3.0 -r .&#47;siteconf20191105-81359-gkmop8.rb extconf.rb mkmf.rb can&#39;t find header files for ruby at &#47;System&#47;Library&#47;Frameworks&#47;Ruby.framework&#47;Versions&#47;2.3&#47;usr&#47;l&zwnj;&#8203;ib&#47;ruby&#47;include&#47;ruby&zwnj;&#8203;.h  extconf failed, exit code 1</code>"}, {"owner": {"reputation": 659, "user_id": 2695716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/51Wgc.jpg?s=128&g=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/2695716/dennis"}, "edited": false, "score": 0, "creation_date": 1572984501, "post_id": 58707697, "comment_id": 103730373, "body": "Try the commands in my answer. If it still fails you may want to go the <code>rbenv</code> route."}], "answers": [{"tags": [], "owner": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "is_accepted": false, "score": 0, "last_activity_date": 1572963517, "last_edit_date": 1572963517, "creation_date": 1572947716, "answer_id": 58708748, "question_id": 58707697, "link": "https://stackoverflow.com/questions/58707697/error-error-installing-nokogiri-error-failed-to-build-gem-native-extension-m/58708748#58708748", "title": "ERROR: Error installing nokogiri: ERROR: Failed to build gem native extension. MacOS", "body": "<p>Did you try?</p>\n\n<pre><code>gem update --system\nxcode-select --install\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 659, "user_id": 2695716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/51Wgc.jpg?s=128&g=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/2695716/dennis"}, "is_accepted": false, "score": 0, "last_activity_date": 1572984372, "creation_date": 1572984372, "answer_id": 58718674, "question_id": 58707697, "link": "https://stackoverflow.com/questions/58707697/error-error-installing-nokogiri-error-failed-to-build-gem-native-extension-m/58718674#58718674", "title": "ERROR: Error installing nokogiri: ERROR: Failed to build gem native extension. MacOS", "body": "<p>The following should fix your issue:</p>\n\n<pre><code>sudo rm -rf /Library/Developer/CommandLineTools\nxcode-select --install\nsudo xcodebuild -license accept\nopen /Library/Developer/CommandLineTools/Packages/macOS_SDK_headers_for_macOS_10.14.pkg\n</code></pre>\n"}], "owner": {"reputation": 5425, "user_id": 3779419, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/EXtxc.jpg?s=128&g=1", "display_name": "Shota", "link": "https://stackoverflow.com/users/3779419/shota"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 521, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1572984372, "creation_date": 1572944278, "question_id": 58707697, "link": "https://stackoverflow.com/questions/58707697/error-error-installing-nokogiri-error-failed-to-build-gem-native-extension-m", "title": "ERROR: Error installing nokogiri: ERROR: Failed to build gem native extension. MacOS", "body": "<p>I have no experience with Ruby. When I try to do <code>gem install nokogiri</code> on MacOS I am getting.</p>\n\n<pre><code>Building native extensions. This could take a while...\nERROR:  Error installing nokogiri:\n    ERROR: Failed to build gem native extension.\n\n    current directory: /Library/Ruby/Gems/2.3.0/gems/nokogiri-1.10.5/ext/nokogiri\n/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/bin/ruby -I /Library/Ruby/Site/2.3.0 -r ./siteconf20191105-81089-x3wjwy.rb extconf.rb\nmkmf.rb can't find header files for ruby at /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/include/ruby.h\n\nextconf failed, exit code 1\n\nGem files will remain installed in /Library/Ruby/Gems/2.3.0/gems/nokogiri-1.10.5 for inspection.\nResults logged to /Library/Ruby/Gems/2.3.0/extensions/universal-darwin-18/2.3.0/nokogiri-1.10.5/gem_make.out\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "actioncable"], "answers": [{"tags": [], "owner": {"reputation": 1645, "user_id": 796608, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/755b808e4e6d39261651aa975a7afbbf?s=128&d=identicon&r=PG", "display_name": "erandros", "link": "https://stackoverflow.com/users/796608/erandros"}, "is_accepted": true, "score": 3, "last_activity_date": 1580307936, "creation_date": 1580307936, "answer_id": 59969224, "question_id": 58706185, "link": "https://stackoverflow.com/questions/58706185/how-to-get-request-session-inside-actioncable-channel/59969224#59969224", "title": "How to get request.session inside ActionCable Channel?", "body": "<p>In the connection, we create this method (because of <code>@request</code> being private):</p>\n\n<pre><code>def session\n  @request.session\nend\n</code></pre>\n\n<p>Then, in the channel you can access the session like so:</p>\n\n<pre><code>session = connection.session\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 4832189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-q815NGQIN20/AAAAAAAAAAI/AAAAAAAABU0/YipTLWXIisM/photo.jpg?sz=128", "display_name": "Kavachaj", "link": "https://stackoverflow.com/users/4832189/kavachaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 520, "favorite_count": 1, "accepted_answer_id": 59969224, "answer_count": 1, "score": 1, "last_activity_date": 1580307936, "creation_date": 1572937947, "last_edit_date": 1572941003, "question_id": 58706185, "link": "https://stackoverflow.com/questions/58706185/how-to-get-request-session-inside-actioncable-channel", "title": "How to get request.session inside ActionCable Channel?", "body": "<p>Is there a way to get (or pass from <code>Connection</code>) request data(actually, I need <code>session[:_csrf_token]</code>, don't ask why) in the <code>Channel</code>? For example:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class MeetingChannel &lt; ApplicationCable::Channel\n  def subscribed\n    session[:_csrf_token]\n  end\nend\n</code></pre>\n\n<p>For now, I could only get <code>csrf_token</code> in <code>Connection</code>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module ApplicationCable\n  class Connection &lt; ActionCable::Connection::Base\n    def connect\n      puts \"**********************************************************\"\n      puts \"CSRF token: #{request.session[:_csrf_token]}\"\n      puts \"**********************************************************\"\n    end\n  end\nend\n</code></pre>\n\n<p>It outputs (when connecting):</p>\n\n<pre><code>**********************************************************\nCSRF token: u33bsVI7HnF2bqWRfkriQUlLzIUpCcDVovgRTAkoGKM=\n**********************************************************\n</code></pre>\n"}, {"tags": ["arrays", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 9822693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52796a00a9fbd0ac9d05ada7f89d4e8e?s=128&d=identicon&r=PG&f=1", "display_name": "Wah.P", "link": "https://stackoverflow.com/users/9822693/wah-p"}, "edited": false, "score": 0, "creation_date": 1572936098, "post_id": 58705686, "comment_id": 103706192, "body": "I appreciate your answer but I am meant to use a while loop like that in my task, is there any way to do it with my loop?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 79, "user_id": 9822693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52796a00a9fbd0ac9d05ada7f89d4e8e?s=128&d=identicon&r=PG&f=1", "display_name": "Wah.P", "link": "https://stackoverflow.com/users/9822693/wah-p"}, "edited": false, "score": 0, "creation_date": 1572936630, "post_id": 58705686, "comment_id": 103706375, "body": "Your code is fine, just not idiomatic. However, the printing is hidden in <code>print_album</code>, which apparently only accepts the album itself. You already have the variable <code>index</code> which you can print. Either just... print it, or modify <code>print_album</code> to do so (and to accept the index parameter)"}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 6, "last_activity_date": 1572935644, "creation_date": 1572935644, "answer_id": 58705686, "question_id": 58705637, "link": "https://stackoverflow.com/questions/58705637/ruby-how-to-print-the-actual-index-number-of-an-array-not-the-value-of-that-i/58705686#58705686", "title": "Ruby - How to print the actual index number of an array, not the value of that index", "body": "<p>Rubyists would typically not use <code>while</code> for iterating over an array. What you want is idiomatically written as follows:</p>\n\n<pre><code>albums.each_with_index do |album, index|\n  puts \"#{index}: #{album}\"\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 541, "user_id": 12244608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rP6EG.jpg?s=128&g=1", "display_name": "TedTran2019", "link": "https://stackoverflow.com/users/12244608/tedtran2019"}, "is_accepted": false, "score": 0, "last_activity_date": 1572938226, "creation_date": 1572938226, "answer_id": 58706243, "question_id": 58705637, "link": "https://stackoverflow.com/questions/58705637/ruby-how-to-print-the-actual-index-number-of-an-array-not-the-value-of-that-i/58706243#58706243", "title": "Ruby - How to print the actual index number of an array, not the value of that index", "body": "<p>Hmm, Amadan's answer is absolutely right-- that's how you should do it in Ruby. Using an enumerable is far more idiomatic </p>\n\n<pre><code>index = 0\nwhile index &lt; albums.length\n    puts \"#{index} : #{albums[index]}\"\n    index += 1\nend\n</code></pre>\n\n<p>Is how you would do it using a while loop. </p>\n"}], "owner": {"reputation": 79, "user_id": 9822693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52796a00a9fbd0ac9d05ada7f89d4e8e?s=128&d=identicon&r=PG&f=1", "display_name": "Wah.P", "link": "https://stackoverflow.com/users/9822693/wah-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 383, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1572938226, "creation_date": 1572935409, "question_id": 58705637, "link": "https://stackoverflow.com/questions/58705637/ruby-how-to-print-the-actual-index-number-of-an-array-not-the-value-of-that-i", "title": "Ruby - How to print the actual index number of an array, not the value of that index", "body": "<p>got a simple question. </p>\n\n<p>I want to puts the index number of the array, not the actual value of the array index. So if array[0] = book1 I want to puts 0, not book1. How can I do this? </p>\n\n<p>More specifically if it's relevant, in my task I'm printing each album in the array in a loop, but also want to print which number each album is.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>index = 0\n    while index &lt; albums.length\n        print_album(albums[index])\n        index += 1\n    end\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 1, "creation_date": 1572947447, "post_id": 58705816, "comment_id": 103711419, "body": "It is classy like your bio :)"}], "tags": [], "owner": {"reputation": 6315, "user_id": 5411198, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/FabOI.jpg?s=128&g=1", "display_name": "sergio MAGA", "link": "https://stackoverflow.com/users/5411198/sergio-maga"}, "is_accepted": false, "score": 3, "last_activity_date": 1572979368, "last_edit_date": 1572979368, "creation_date": 1572936247, "answer_id": 58705816, "question_id": 58705594, "link": "https://stackoverflow.com/questions/58705594/ruby-taking-the-last-vowel-from-a-word-problem/58705816#58705816", "title": "Ruby taking the last vowel from a word problem", "body": "<p>You could define <code>String#lastvowel</code>:</p>\n\n<pre><code>class String\n  def lastvowel\n    sub(/(.*)[aeiou](.*)/,'\\1\\2')\n  end\nend\n</code></pre>\n\n<p>and use like this:</p>\n\n<pre><code>\"something\".lastvowel\n=&gt; \"somethng\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1572940049, "post_id": 58705817, "comment_id": 103707648, "body": "Can the lazy qualifier be dropped from <code>(?!.*?[aeiou])</code> (i.e., <code>(?!.*[aeiou])</code>)?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1572940921, "post_id": 58705817, "comment_id": 103708009, "body": "@CarySwoveland Yes, in this case it will only affect the execution strategy, but not the result. i.e. different shapes of &quot;word&quot; will be more, or less efficient. You can test on regex101 which reports &quot;number of steps&quot;. Neither variant is inherently better or worse, just better or worse for a particular input. Though... I also quite like Sergio&#39;s greedy group way."}, {"owner": {"reputation": 3, "user_id": 12324333, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBJcOfMuSE4A6guCioGQjDJccl3PSXHuULc_SSd=k-s128", "display_name": "John", "link": "https://stackoverflow.com/users/12324333/john"}, "edited": false, "score": 0, "creation_date": 1572946367, "post_id": 58705817, "comment_id": 103710793, "body": "@Amadan thank you for the help! I was trying to avoid using regex since I didn&#39;t get there yet in learning Ruby but it seems lot of these problems can be more simply solved with regex! So i&#39;ll study that more. Really appreciate it!"}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 2, "last_activity_date": 1572936255, "creation_date": 1572936255, "answer_id": 58705817, "question_id": 58705594, "link": "https://stackoverflow.com/questions/58705594/ruby-taking-the-last-vowel-from-a-word-problem/58705817#58705817", "title": "Ruby taking the last vowel from a word problem", "body": "<p><code>vowels.include? (word)</code> would test e.g. if the word is found in the string <code>\"aeiou\"</code>. First of all, you likely wanted to test the reverse, whether vowels are in the word, not if the word is in the vowels; secondly, no word in English language has <code>\"aeiou\"</code> as its substring (the closest AFAIK are <code>\"leguleious\"</code>, <code>\"epigaeous\"</code>, <code>\"glutaeous\"</code> and <code>\"paeounlae\"</code>, with one of the vowels missing).</p>\n\n<p>What you want is to know if <em>any</em> of the vowels is included in the word; the shortest way to write that is <code>vowels.any? { |vowel| word.include?(vowel) }</code>. The check is not really necessary, if there are no vowels in the word you'd just be doing some unnecessary reversals.</p>\n\n<p>Finally, you can do everything in just one <code>sub</code>, without reversals, and no tests:</p>\n\n<pre><code>word.sub(/[aeiou](?!.*?[aeiou])/, \"\")\n</code></pre>\n\n<p>(\"a vowel not followed by stuff and another vowel\")</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1572964202, "last_edit_date": 1572964202, "creation_date": 1572936692, "answer_id": 58705916, "question_id": 58705594, "link": "https://stackoverflow.com/questions/58705594/ruby-taking-the-last-vowel-from-a-word-problem/58705916#58705916", "title": "Ruby taking the last vowel from a word problem", "body": "<pre><code>\"problematic\".sub(/[aeiou](?=[^aeiou]*\\z)/i, '')\n  #=&gt; \"problematc\"\n\n\"HELLO\".sub(/[aeiou](?=[^aeiou]*\\z)/i, '')\n  #=&gt; \"HELL\"\n\n\"sly\".sub(/[aeiou](?=[^aeiou]*\\z)/i, '')\n  #=&gt; \"sly\"\n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/core-2.6.3/String.html#method-i-sub\" rel=\"nofollow noreferrer\">String#sub</a>.</p>\n\n<p>The regular expression reads, \"match any vowel (<code>[aeiou]</code>) followed by zero or more (<code>*</code>) characters other than vowels (<code>[^aeiou]</code>), followed by the end of the string (<code>\\z</code>), the matches being case indifferent (<code>/i</code>)\".</p>\n\n<p><code>[aeiou]</code> is a <em>character class</em>, meaning exactly one of its contents is to be matched.</p>\n\n<p><code>(?=[^aeiou]*\\z)</code> is a <em>positive lookahead</em> (signified by <code>?=</code>).</p>\n\n<p><code>[^aeiou]</code> is also a character class, but the carat (<code>^</code>) in the first position means that exactly one character other than the characters that follow <code>^</code> is to be matched. Here that means a consonant.</p>\n\n<p>Another way is to use the method <a href=\"https://ruby-doc.org/core-2.6.3/String.html#method-i-rindex\" rel=\"nofollow noreferrer\">String#rindex</a>:</p>\n\n<pre><code>str = \"problematic\"\nidx = str.rindex(/[aeiou]/i)\nidx ? (str[0,idx]+str[idx+1..-1]) : str\n  #=&gt; \"problematc\"\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>str = \"A\"\nidx = str.rindex(/[aeiou]/i)\nidx ? (str[0,idx]+str[idx+1..-1]) : str\n  #=&gt; \"\"\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12324333, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBJcOfMuSE4A6guCioGQjDJccl3PSXHuULc_SSd=k-s128", "display_name": "John", "link": "https://stackoverflow.com/users/12324333/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 58705817, "answer_count": 3, "score": 0, "last_activity_date": 1572979368, "creation_date": 1572935191, "question_id": 58705594, "link": "https://stackoverflow.com/questions/58705594/ruby-taking-the-last-vowel-from-a-word-problem", "title": "Ruby taking the last vowel from a word problem", "body": "<p>I've been stressing out a lot about a problem I feel like I should be getting but don't know why it's not working. </p>\n\n<p>Basically a method that takes a word and returns a word without the last vowel. </p>\n\n<p>My code was: </p>\n\n<pre><code>def lastvowel(word)\n    vowels = \"aeiou\"\n\n    if vowels.include? (word)\n        word.reverse.sub(/[aeiou]/, \"\").reverse\n    else\n        return word \n    end\n\n\nend\n</code></pre>\n\n<p>the problem was that the vowels.include? (word) was not working? but I feel like it should be working? Maybe I'm thinking something else. \nSo instead I made it like this: </p>\n\n<pre><code>def lastvowel(word)\n    vowel = \"aeiou\"\n\n    word.each_char do |x|\n        if vowel.include?(x) \n        return word.reverse.sub(/[aeiou]/, \"\").reverse\n        end\n    end\nreturn word\n\nend\n</code></pre>\n\n<p>Is my understanding of the .include? method not correct? Any help would be very appreciated, thank you in advance. </p>\n"}, {"tags": ["ruby", "nokogiri"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1572942539, "post_id": 58705441, "comment_id": 103708740, "body": "Using your snippet as a string, and doing <code>Nokogiri::HTML(str).css(&#39;mat-row&#39;)</code>, I&#39;m getting your one element (and more specifically, <code>doc.css(&#39;mat-row mat-cell a&#39;).map(&amp;:text)</code> is getting me <code>[&quot;Federer, Roger&quot;]</code>). Please construct a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that demonstrates you can&#39;t access what you are trying to access. Nevertheless, you should probably use <code>Nokogiri::XML</code> for XML data, not <code>Nokogiri::HTML</code>."}, {"owner": {"reputation": 1202, "user_id": 147204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e593ac63e5f25649b701dc25f69d1b7?s=128&d=identicon&r=PG", "display_name": "luis.parravicini", "link": "https://stackoverflow.com/users/147204/luis-parravicini"}, "edited": false, "score": 0, "creation_date": 1572957069, "post_id": 58705441, "comment_id": 103716357, "body": "Maybe the content you are trying to scrape is being loaded with a xhr request after the page loaded? Try dumping the document your script gets to a file and check if the data you need is there."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1572988142, "post_id": 58705441, "comment_id": 103731850, "body": "I can&#39;t duplicate the problem. &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot; will help us help you. Don&#39;t copy XPath from a browser. Browsers are pathologically helpful and will wet themselves trying to make you happy. OK, not that helpful. They munge the HTML being presented so it looks good on the screen but it&#39;s not necessarily what the server sent. Use <code>wget</code> or <code>curl</code> or <code>httparty</code> or <code>nokogiri</code> at the command-line and look at what they get as they&#39;re your friends."}], "owner": {"reputation": 6871, "user_id": 1316501, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3f0ddaf1d7d2aaeeb19b6ec8a99a70ee?s=128&d=identicon&r=PG", "display_name": "anon_swe", "link": "https://stackoverflow.com/users/1316501/anon-swe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572987813, "creation_date": 1572934393, "last_edit_date": 1572987813, "question_id": 58705441, "link": "https://stackoverflow.com/questions/58705441/how-to-scrape-an-angular-element", "title": "How to scrape an Angular element", "body": "<p>I'm trying to scrape a web page built in Angular.  The format of the information I'm after looks like this:</p>\n\n<pre><code>&lt;mat-row class=\"mat-row ng-star-inserted\" role=\"row\"&gt;\n    &lt;mat-cell class=\"mat-cell cdk-column-Players mat-column-Players ng-star-inserted\" role=\"gridcell\"&gt;\n        &lt;a href=\"users/205101\"&gt;Federer, Roger&lt;/a&gt;\n    &lt;/mat-cell&gt;\n&lt;/mat-row&gt;\n</code></pre>\n\n<p>I'd like to get the name in the link, \"Federer, Roger\", so I tried:</p>\n\n<pre><code>doc = Nokogiri::HTML(open(SITE))\ndoc.css('mat-row')\n</code></pre>\n\n<p>And get nothing back.</p>\n\n<p>I also tried copying the full XPath from the Chrome browser tools using:</p>\n\n<pre><code>doc.xpath(\"//html/body/usq-club-locker-app/usq-team-profile/usq-profile/section/div/div[4]/mat-card/mat-tab-group/div/mat-tab-body[4]/div/div/div/mat-table/mat-row[1]/mat-cell[1]\")\n</code></pre>\n\n<p>but also got no results back.</p>\n\n<p>How can I tell Nokogiri to find all <code>mat-row</code> elements with a specified class?</p>\n"}, {"tags": ["ruby", "mongodb"], "comments": [{"owner": {"reputation": 2837, "user_id": 6245337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VoQ5.jpg?s=128&g=1", "display_name": "Ana Mar&#237;a Mart&#237;nez G&#243;mez", "link": "https://stackoverflow.com/users/6245337/ana-mar%c3%ada-mart%c3%adnez-g%c3%b3mez"}, "edited": false, "score": 0, "creation_date": 1573263397, "post_id": 58704718, "comment_id": 103837064, "body": "can it be related to one of the tests? have you checked if running one single test works?"}, {"owner": {"reputation": 871, "user_id": 6951227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2af48b08d988dabb0f004135ef5c92b?s=128&d=identicon&r=PG", "display_name": "Plancke", "link": "https://stackoverflow.com/users/6951227/plancke"}, "edited": false, "score": 0, "creation_date": 1573281299, "post_id": 58704718, "comment_id": 103839187, "body": "try running <code>db.currentOp()</code> when it&#39;s hanging, it&#39;ll show you the query that has the write lock so you can see what&#39;s blocking the read operations."}, {"owner": {"reputation": 580, "user_id": 2311415, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7dbd33fd2379518771be6d2d1f013cc2?s=128&d=identicon&r=PG", "display_name": "Dwijen", "link": "https://stackoverflow.com/users/2311415/dwijen"}, "reply_to_user": {"reputation": 2837, "user_id": 6245337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VoQ5.jpg?s=128&g=1", "display_name": "Ana Mar&#237;a Mart&#237;nez G&#243;mez", "link": "https://stackoverflow.com/users/6245337/ana-mar%c3%ada-mart%c3%adnez-g%c3%b3mez"}, "edited": false, "score": 0, "creation_date": 1573455059, "post_id": 58704718, "comment_id": 103874336, "body": "@AnaMar&#237;aMart&#237;nezG&#243;mez yes, if I run a single test it runs just fine. There are no issues."}, {"owner": {"reputation": 580, "user_id": 2311415, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7dbd33fd2379518771be6d2d1f013cc2?s=128&d=identicon&r=PG", "display_name": "Dwijen", "link": "https://stackoverflow.com/users/2311415/dwijen"}, "reply_to_user": {"reputation": 871, "user_id": 6951227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2af48b08d988dabb0f004135ef5c92b?s=128&d=identicon&r=PG", "display_name": "Plancke", "link": "https://stackoverflow.com/users/6951227/plancke"}, "edited": false, "score": 0, "creation_date": 1573455100, "post_id": 58704718, "comment_id": 103874351, "body": "@Plancke tried that, it&#39;s almost always a different query and on different collections."}, {"owner": {"reputation": 2837, "user_id": 6245337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VoQ5.jpg?s=128&g=1", "display_name": "Ana Mar&#237;a Mart&#237;nez G&#243;mez", "link": "https://stackoverflow.com/users/6245337/ana-mar%c3%ada-mart%c3%adnez-g%c3%b3mez"}, "edited": false, "score": 0, "creation_date": 1573457463, "post_id": 58704718, "comment_id": 103875087, "body": "it may be that it is a concrete test which makes it fail. Try to figure out which test or set of test cause it. In other words, from one test to all test, when does it start failing?"}, {"owner": {"reputation": 3204, "user_id": 2228338, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-b3jn9hCpWYU/AAAAAAAAAAI/AAAAAAAAAAs/-1U-aoxnBOc/photo.jpg?sz=128", "display_name": "Yuki", "link": "https://stackoverflow.com/users/2228338/yuki"}, "edited": false, "score": 0, "creation_date": 1573773669, "post_id": 58704718, "comment_id": 104005289, "body": "There might be so many reasons why it happens - anything. you can give more information starting from: single instance/shareded, server machine setup (discs, ram, cpus, os), anything else is running on the machines, collection sizes, number of indexes, index/collection data ration, etc."}, {"owner": {"reputation": 3587, "user_id": 136908, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/251f50cb522721ff7e5bc8a9e29bb1b1?s=128&d=identicon&r=PG", "display_name": "Sohan", "link": "https://stackoverflow.com/users/136908/sohan"}, "edited": false, "score": 0, "creation_date": 1591846740, "post_id": 58704718, "comment_id": 110212886, "body": "Did you ever find a solution?"}, {"owner": {"reputation": 580, "user_id": 2311415, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7dbd33fd2379518771be6d2d1f013cc2?s=128&d=identicon&r=PG", "display_name": "Dwijen", "link": "https://stackoverflow.com/users/2311415/dwijen"}, "edited": false, "score": 0, "creation_date": 1591941040, "post_id": 58704718, "comment_id": 110250685, "body": "Nope, somehow it worked for us by updating the docker compose version. I don&#39;t think that is what solved the issue but I don&#39;t know what did."}], "owner": {"reputation": 580, "user_id": 2311415, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7dbd33fd2379518771be6d2d1f013cc2?s=128&d=identicon&r=PG", "display_name": "Dwijen", "link": "https://stackoverflow.com/users/2311415/dwijen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1151, "favorite_count": 0, "answer_count": 0, "score": 6, "last_activity_date": 1583649992, "creation_date": 1572929617, "last_edit_date": 1592644375, "question_id": 58704718, "link": "https://stackoverflow.com/questions/58704718/mongodb-hangs-randomly", "title": "MongoDB hangs randomly", "body": "<h3>Overview</h3>\n<p>I have a ruby application that uses MongoDB as a database. While running tests for this application I am creating collections and indexes for every test case using <code>Minitest</code>.</p>\n<p>The test environment is created using docker compose where one container is running the tests and the other container is running MongoDB.</p>\n<h3>Problem</h3>\n<p>When running the tests for the first time, after a while MongoDB gets stuck. Any request to query the collections doesn't respond.</p>\n<p>I was able to connect to it before the tests started running using the command line client. When I checked the state of the server using <code>db.serverStatus()</code> I see that some operations have acquired locks. Looking at the <code>globalLock</code> field I understand that 1 operation has <code>write</code> lock and there are 2 operations are waiting to acquire <code>read</code> lock.</p>\n<p>I am unable to understand why would these operations hang and not yield the locks. I have no idea how to debug this problem further.</p>\n<p>MongoDB Version: 3.6.13\nRuby Driver version: 2.8.0</p>\n<p>I've also tried other versions 3.6.x and 4.0</p>\n<p>Any help or direction is highly appreciated.</p>\n<p><strong>db.serverStatus output</strong></p>\n<pre><code>{\n    &quot;host&quot; : &quot;c658c885eb90&quot;,\n    &quot;version&quot; : &quot;3.6.14&quot;,\n    &quot;process&quot; : &quot;mongod&quot;,\n    &quot;pid&quot; : NumberLong(1),\n    &quot;uptime&quot; : 98,\n    &quot;uptimeMillis&quot; : NumberLong(97909),\n    &quot;uptimeEstimate&quot; : NumberLong(97),\n    &quot;localTime&quot; : ISODate(&quot;2019-11-03T16:09:14.289Z&quot;),\n    &quot;asserts&quot; : {\n        &quot;regular&quot; : 0,\n        &quot;warning&quot; : 0,\n        &quot;msg&quot; : 0,\n        &quot;user&quot; : 0,\n        &quot;rollovers&quot; : 0\n    },\n    &quot;connections&quot; : {\n        &quot;current&quot; : 6,\n        &quot;available&quot; : 838854,\n        &quot;totalCreated&quot; : 11\n    },\n    &quot;extra_info&quot; : {\n        &quot;note&quot; : &quot;fields vary by platform&quot;,\n        &quot;page_faults&quot; : 0\n    },\n    &quot;globalLock&quot; : {\n        &quot;totalTime&quot; : NumberLong(97908000),\n        &quot;currentQueue&quot; : {\n            &quot;total&quot; : 2,\n            &quot;readers&quot; : 2,\n            &quot;writers&quot; : 0\n        },\n        &quot;activeClients&quot; : {\n            &quot;total&quot; : 13,\n            &quot;readers&quot; : 0,\n            &quot;writers&quot; : 1\n        }\n    },\n    &quot;locks&quot; : {\n        &quot;Global&quot; : {\n            &quot;acquireCount&quot; : {\n                &quot;r&quot; : NumberLong(14528),\n                &quot;w&quot; : NumberLong(12477),\n                &quot;W&quot; : NumberLong(5)\n            }\n        },\n        &quot;Database&quot; : {\n            &quot;acquireCount&quot; : {\n                &quot;r&quot; : NumberLong(1020),\n                &quot;w&quot; : NumberLong(14459),\n                &quot;R&quot; : NumberLong(3),\n                &quot;W&quot; : NumberLong(6599)\n            },\n            &quot;acquireWaitCount&quot; : {\n                &quot;r&quot; : NumberLong(2)\n            },\n            &quot;timeAcquiringMicros&quot; : {\n                &quot;r&quot; : NumberLong(76077321)\n            }\n        },\n        &quot;Collection&quot; : {\n            &quot;acquireCount&quot; : {\n                &quot;R&quot; : NumberLong(1018),\n                &quot;W&quot; : NumberLong(8805)\n            }\n        },\n        &quot;Metadata&quot; : {\n            &quot;acquireCount&quot; : {\n                &quot;W&quot; : NumberLong(37)\n            }\n        }\n    },\n    &quot;logicalSessionRecordCache&quot; : {\n        &quot;activeSessionsCount&quot; : 3,\n        &quot;sessionsCollectionJobCount&quot; : 1,\n        &quot;lastSessionsCollectionJobDurationMillis&quot; : 0,\n        &quot;lastSessionsCollectionJobTimestamp&quot; : ISODate(&quot;2019-11-03T16:07:36.407Z&quot;),\n        &quot;lastSessionsCollectionJobEntriesRefreshed&quot; : 0,\n        &quot;lastSessionsCollectionJobEntriesEnded&quot; : 0,\n        &quot;lastSessionsCollectionJobCursorsClosed&quot; : 0,\n        &quot;transactionReaperJobCount&quot; : 0,\n        &quot;lastTransactionReaperJobDurationMillis&quot; : 0,\n        &quot;lastTransactionReaperJobTimestamp&quot; : ISODate(&quot;2019-11-03T16:07:36.407Z&quot;),\n        &quot;lastTransactionReaperJobEntriesCleanedUp&quot; : 0\n    },\n    &quot;network&quot; : {\n        &quot;bytesIn&quot; : NumberLong(1682811),\n        &quot;bytesOut&quot; : NumberLong(1019834),\n        &quot;physicalBytesIn&quot; : NumberLong(1682811),\n        &quot;physicalBytesOut&quot; : NumberLong(1019834),\n        &quot;numRequests&quot; : NumberLong(7822),\n        &quot;compression&quot; : {\n            &quot;snappy&quot; : {\n                &quot;compressor&quot; : {\n                    &quot;bytesIn&quot; : NumberLong(0),\n                    &quot;bytesOut&quot; : NumberLong(0)\n                },\n                &quot;decompressor&quot; : {\n                    &quot;bytesIn&quot; : NumberLong(0),\n                    &quot;bytesOut&quot; : NumberLong(0)\n                }\n            }\n        },\n        &quot;serviceExecutorTaskStats&quot; : {\n            &quot;executor&quot; : &quot;passthrough&quot;,\n            &quot;threadsRunning&quot; : 6\n        }\n    },\n    &quot;opLatencies&quot; : {\n        &quot;reads&quot; : {\n            &quot;latency&quot; : NumberLong(61374),\n            &quot;ops&quot; : NumberLong(963)\n        },\n        &quot;writes&quot; : {\n            &quot;latency&quot; : NumberLong(13074),\n            &quot;ops&quot; : NumberLong(286)\n        },\n        &quot;commands&quot; : {\n            &quot;latency&quot; : NumberLong(988232),\n            &quot;ops&quot; : NumberLong(6570)\n        }\n    },\n    &quot;opReadConcernCounters&quot; : {\n        &quot;available&quot; : NumberLong(0),\n        &quot;linearizable&quot; : NumberLong(0),\n        &quot;local&quot; : NumberLong(0),\n        &quot;majority&quot; : NumberLong(0),\n        &quot;none&quot; : NumberLong(944)\n    },\n    &quot;opcounters&quot; : {\n        &quot;insert&quot; : 246,\n        &quot;query&quot; : 944,\n        &quot;update&quot; : 40,\n        &quot;delete&quot; : 0,\n        &quot;getmore&quot; : 0,\n        &quot;command&quot; : 6595\n    },\n    &quot;opcountersRepl&quot; : {\n        &quot;insert&quot; : 0,\n        &quot;query&quot; : 0,\n        &quot;update&quot; : 0,\n        &quot;delete&quot; : 0,\n        &quot;getmore&quot; : 0,\n        &quot;command&quot; : 0\n    },\n    &quot;storageEngine&quot; : {\n        &quot;name&quot; : &quot;ephemeralForTest&quot;,\n        &quot;supportsCommittedReads&quot; : false,\n        &quot;readOnly&quot; : false,\n        &quot;persistent&quot; : false\n    },\n    &quot;tcmalloc&quot; : {\n        &quot;generic&quot; : {\n            &quot;current_allocated_bytes&quot; : 8203504,\n            &quot;heap_size&quot; : 12496896\n        },\n        &quot;tcmalloc&quot; : {\n            &quot;pageheap_free_bytes&quot; : 2760704,\n            &quot;pageheap_unmapped_bytes&quot; : 0,\n            &quot;max_total_thread_cache_bytes&quot; : 516947968,\n            &quot;current_total_thread_cache_bytes&quot; : 1007120,\n            &quot;total_free_bytes&quot; : 1532688,\n            &quot;central_cache_free_bytes&quot; : 231040,\n            &quot;transfer_cache_free_bytes&quot; : 294528,\n            &quot;thread_cache_free_bytes&quot; : 1007120,\n            &quot;aggressive_memory_decommit&quot; : 0,\n            &quot;pageheap_committed_bytes&quot; : 12496896,\n            &quot;pageheap_scavenge_count&quot; : 0,\n            &quot;pageheap_commit_count&quot; : 9,\n            &quot;pageheap_total_commit_bytes&quot; : 12496896,\n            &quot;pageheap_decommit_count&quot; : 0,\n            &quot;pageheap_total_decommit_bytes&quot; : 0,\n            &quot;pageheap_reserve_count&quot; : 9,\n            &quot;pageheap_total_reserve_bytes&quot; : 12496896,\n            &quot;spinlock_total_delay_ns&quot; : 0,\n            &quot;formattedString&quot; : &quot;------------------------------------------------\\nMALLOC:        8204080 (    7.8 MiB) Bytes in use by application\\nMALLOC: +      2760704 (    2.6 MiB) Bytes in page heap freelist\\nMALLOC: +       231040 (    0.2 MiB) Bytes in central cache freelist\\nMALLOC: +       294528 (    0.3 MiB) Bytes in transfer cache freelist\\nMALLOC: +      1006544 (    1.0 MiB) Bytes in thread cache freelists\\nMALLOC: +      1204480 (    1.1 MiB) Bytes in malloc metadata\\nMALLOC:   ------------\\nMALLOC: =     13701376 (   13.1 MiB) Actual memory used (physical + swap)\\nMALLOC: +            0 (    0.0 MiB) Bytes released to OS (aka unmapped)\\nMALLOC:   ------------\\nMALLOC: =     13701376 (   13.1 MiB) Virtual address space used\\nMALLOC:\\nMALLOC:            415              Spans in use\\nMALLOC:             18              Thread heaps in use\\nMALLOC:           4096              Tcmalloc page size\\n------------------------------------------------\\nCall ReleaseFreeMemory() to release freelist memory to the OS (via madvise()).\\nBytes released to the OS take up virtual address space but no physical memory.\\n&quot;\n        }\n    },\n    &quot;transactions&quot; : {\n        &quot;retriedCommandsCount&quot; : NumberLong(0),\n        &quot;retriedStatementsCount&quot; : NumberLong(0),\n        &quot;transactionsCollectionWriteCount&quot; : NumberLong(0)\n    },\n    &quot;transportSecurity&quot; : {\n        &quot;1.0&quot; : NumberLong(0),\n        &quot;1.1&quot; : NumberLong(0),\n        &quot;1.2&quot; : NumberLong(0),\n        &quot;1.3&quot; : NumberLong(0),\n        &quot;unknown&quot; : NumberLong(0)\n    },\n    &quot;mem&quot; : {\n        &quot;bits&quot; : 64,\n        &quot;resident&quot; : 41,\n        &quot;virtual&quot; : 836,\n        &quot;supported&quot; : true,\n        &quot;mapped&quot; : 0\n    },\n    &quot;metrics&quot; : {\n        &quot;commands&quot; : {\n            &quot;buildInfo&quot; : {\n                &quot;failed&quot; : NumberLong(0),\n                &quot;total&quot; : NumberLong(2)\n            },\n            &quot;count&quot; : {\n                &quot;failed&quot; : NumberLong(0),\n                &quot;total&quot; : NumberLong(21)\n            },\n            &quot;createIndexes&quot; : {\n                &quot;failed&quot; : NumberLong(0),\n                &quot;total&quot; : NumberLong(5656)\n            },\n            &quot;drop&quot; : {\n                &quot;failed&quot; : NumberLong(0),\n                &quot;total&quot; : NumberLong(784)\n            },\n            &quot;dropIndexes&quot; : {\n                &quot;failed&quot; : NumberLong(87),\n                &quot;total&quot; : NumberLong(87)\n            },\n            &quot;find&quot; : {\n                &quot;failed&quot; : NumberLong(0),\n                &quot;total&quot; : NumberLong(944)\n            },\n            &quot;getLog&quot; : {\n                &quot;failed&quot; : NumberLong(0),\n                &quot;total&quot; : NumberLong(1)\n            },\n            &quot;insert&quot; : {\n                &quot;failed&quot; : NumberLong(0),\n                &quot;total&quot; : NumberLong(246)\n            },\n            &quot;isMaster&quot; : {\n                &quot;failed&quot; : NumberLong(0),\n                &quot;total&quot; : NumberLong(38)\n            },\n            &quot;listCollections&quot; : {\n                &quot;failed&quot; : NumberLong(0),\n                &quot;total&quot; : NumberLong(1)\n            },\n            &quot;listIndexes&quot; : {\n                &quot;failed&quot; : NumberLong(1),\n                &quot;total&quot; : NumberLong(1)\n            },\n            &quot;replSetGetStatus&quot; : {\n                &quot;failed&quot; : NumberLong(1),\n                &quot;total&quot; : NumberLong(1)\n            },\n            &quot;serverStatus&quot; : {\n                &quot;failed&quot; : NumberLong(0),\n                &quot;total&quot; : NumberLong(2)\n            },\n            &quot;update&quot; : {\n                &quot;failed&quot; : NumberLong(0),\n                &quot;total&quot; : NumberLong(40)\n            },\n            &quot;whatsmyuri&quot; : {\n                &quot;failed&quot; : NumberLong(0),\n                &quot;total&quot; : NumberLong(1)\n            }\n        },\n        &quot;cursor&quot; : {\n            &quot;timedOut&quot; : NumberLong(0),\n            &quot;open&quot; : {\n                &quot;noTimeout&quot; : NumberLong(0),\n                &quot;pinned&quot; : NumberLong(0),\n                &quot;total&quot; : NumberLong(0)\n            }\n        },\n        &quot;document&quot; : {\n            &quot;deleted&quot; : NumberLong(0),\n            &quot;inserted&quot; : NumberLong(246),\n            &quot;returned&quot; : NumberLong(398),\n            &quot;updated&quot; : NumberLong(40)\n        },\n        &quot;getLastError&quot; : {\n            &quot;wtime&quot; : {\n                &quot;num&quot; : 0,\n                &quot;totalMillis&quot; : 0\n            },\n            &quot;wtimeouts&quot; : NumberLong(0)\n        },\n        &quot;operation&quot; : {\n            &quot;scanAndOrder&quot; : NumberLong(0),\n            &quot;writeConflicts&quot; : NumberLong(0)\n        },\n        &quot;query&quot; : {\n            &quot;updateOneOpStyleBroadcastWithExactIDCount&quot; : NumberLong(0),\n            &quot;upsertReplacementCannotTargetByQueryCount&quot; : NumberLong(0)\n        },\n        &quot;queryExecutor&quot; : {\n            &quot;scanned&quot; : NumberLong(435),\n            &quot;scannedObjects&quot; : NumberLong(438)\n        },\n        &quot;record&quot; : {\n            &quot;moves&quot; : NumberLong(0)\n        },\n        &quot;repl&quot; : {\n            &quot;executor&quot; : {\n                &quot;pool&quot; : {\n                    &quot;inProgressCount&quot; : 0\n                },\n                &quot;queues&quot; : {\n                    &quot;networkInProgress&quot; : 0,\n                    &quot;sleepers&quot; : 0\n                },\n                &quot;unsignaledEvents&quot; : 0,\n                &quot;shuttingDown&quot; : false,\n                &quot;networkInterface&quot; : &quot;\\nNetworkInterfaceASIO Operations' Diagnostic:\\nOperation:    Count:   \\nConnecting    0        \\nIn Progress   0        \\nSucceeded     0        \\nCanceled      0        \\nFailed        0        \\nTimed Out     0        \\n\\n&quot;\n            },\n            &quot;apply&quot; : {\n                &quot;attemptsToBecomeSecondary&quot; : NumberLong(0),\n                &quot;batchSize&quot; : NumberLong(0),\n                &quot;batches&quot; : {\n                    &quot;num&quot; : 0,\n                    &quot;totalMillis&quot; : 0\n                },\n                &quot;ops&quot; : NumberLong(0)\n            },\n            &quot;buffer&quot; : {\n                &quot;count&quot; : NumberLong(0),\n                &quot;maxSizeBytes&quot; : NumberLong(0),\n                &quot;sizeBytes&quot; : NumberLong(0)\n            },\n            &quot;initialSync&quot; : {\n                &quot;completed&quot; : NumberLong(0),\n                &quot;failedAttempts&quot; : NumberLong(0),\n                &quot;failures&quot; : NumberLong(0)\n            },\n            &quot;network&quot; : {\n                &quot;bytes&quot; : NumberLong(0),\n                &quot;getmores&quot; : {\n                    &quot;num&quot; : 0,\n                    &quot;totalMillis&quot; : 0\n                },\n                &quot;ops&quot; : NumberLong(0),\n                &quot;readersCreated&quot; : NumberLong(0)\n            },\n            &quot;preload&quot; : {\n                &quot;docs&quot; : {\n                    &quot;num&quot; : 0,\n                    &quot;totalMillis&quot; : 0\n                },\n                &quot;indexes&quot; : {\n                    &quot;num&quot; : 0,\n                    &quot;totalMillis&quot; : 0\n                }\n            }\n        },\n        &quot;storage&quot; : {\n            &quot;freelist&quot; : {\n                &quot;search&quot; : {\n                    &quot;bucketExhausted&quot; : NumberLong(0),\n                    &quot;requests&quot; : NumberLong(0),\n                    &quot;scanned&quot; : NumberLong(0)\n                }\n            }\n        },\n        &quot;ttl&quot; : {\n            &quot;deletedDocuments&quot; : NumberLong(0),\n            &quot;passes&quot; : NumberLong(1)\n        }\n    },\n    &quot;ok&quot; : 1\n}\n</code></pre>\n"}, {"tags": ["ruby", "macos-mojave"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1572924562, "post_id": 58704008, "comment_id": 103703438, "body": "Do you have <code>bundler</code> gem installed? <code>gem install bundler</code>. This is a sort of &quot;meta&quot; library, it&#39;s used to install other libraries"}, {"owner": {"reputation": 29577, "user_id": 58129, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/MBBRu.jpg?s=128&g=1", "display_name": "Anthony Kong", "link": "https://stackoverflow.com/users/58129/anthony-kong"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1572924622, "post_id": 58704008, "comment_id": 103703446, "body": "I don&#39;t think so. I ran <code>gem list</code> and I do not see it in the output"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1572924930, "post_id": 58704008, "comment_id": 103703502, "body": "So, give it a try. Having this gem installed is what gives you access to the <code>bundle</code> command (or <code>bundle install</code>, same thing) which installs the project dependencies"}], "answers": [{"tags": [], "owner": {"reputation": 29577, "user_id": 58129, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/MBBRu.jpg?s=128&g=1", "display_name": "Anthony Kong", "link": "https://stackoverflow.com/users/58129/anthony-kong"}, "is_accepted": true, "score": 1, "last_activity_date": 1572929183, "creation_date": 1572929183, "answer_id": 58704655, "question_id": 58704008, "link": "https://stackoverflow.com/questions/58704008/how-to-build-and-install-this-gem-package-from-source-https-github-com-cmedley/58704655#58704655", "title": "How to build and install this gem package from source https://github.com/cmedley/terraforming?", "body": "<p>The error as shown in the question is solved by the suggestion from <a href=\"https://stackoverflow.com/users/2981429/max-pleaner\">Max Pleaner</a>.</p>\n\n<pre><code> gem install bundler\n</code></pre>\n\n<p>However it soon encountered a second problem:</p>\n\n<blockquote>\n  <p>Gem::Ext::BuildError: ERROR: Failed to build gem native extension.</p>\n  \n  <p>current directory:\n  /Users/antkong/Documents/Personal/wd/terraforming-assume-role/bin/ruby/2.3.0/gems/json-2.2.0/ext/json/ext/generator\n  /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/bin/ruby -r\n  ./siteconf20191105-34055-mnnpg3.rb extconf.rb mkmf.rb can't find\n  header files for ruby at\n  /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/include/ruby.h</p>\n  \n  <p>extconf failed, exit code 1</p>\n\n<pre><code>Gem files will remain installed in /Users/antkong/Documents/Personal/wd/terraforming-assume-role/bin/ruby/2.3.0/gems/json-2.2.0\nfor inspection.\nResults logged to\n/Users/antkong/Documents/Personal/wd/terraforming-assume-role/bin/ruby/2.3.0/extensions/universal-darwin-18/2.3.0/json-2.2.0/gem_make.out\n\nAn error occurred while installing json (2.2.0), and Bundler cannot continue.\nMake sure that `gem install json -v '2.2.0' --source 'https://rubygems.org/'` succeeds before bundling.\n\nIn Gemfile:\n  coveralls was resolved to 0.8.21, which depends on\n    simplecov was resolved to 0.14.1, which depends on\n      json\n</code></pre>\n</blockquote>\n\n<p>The solution it to follow the instruction in this answer: <a href=\"https://stackoverflow.com/a/58084238/58129\">https://stackoverflow.com/a/58084238/58129</a> </p>\n\n<p>I reproduce the steps below:</p>\n\n<pre><code>sudo rm -rf /Library/Developer/CommandLineTools\nxcode-select --install\nsudo xcodebuild -license accept\nopen /Library/Developer/CommandLineTools/Packages/macOS_SDK_headers_for_macOS_10.14.pkg\nshareeditflag\n</code></pre>\n"}], "owner": {"reputation": 29577, "user_id": 58129, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/MBBRu.jpg?s=128&g=1", "display_name": "Anthony Kong", "link": "https://stackoverflow.com/users/58129/anthony-kong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 58704655, "answer_count": 1, "score": 1, "last_activity_date": 1572929214, "creation_date": 1572923965, "last_edit_date": 1572929214, "question_id": 58704008, "link": "https://stackoverflow.com/questions/58704008/how-to-build-and-install-this-gem-package-from-source-https-github-com-cmedley", "title": "How to build and install this gem package from source https://github.com/cmedley/terraforming?", "body": "<p>I want to build and use this github project <a href=\"https://github.com/cmedley/terraforming\" rel=\"nofollow noreferrer\">https://github.com/cmedley/terraforming</a></p>\n\n<p>I am trying to follow the instruction here <a href=\"https://github.com/cmedley/terraforming#development\" rel=\"nofollow noreferrer\">https://github.com/cmedley/terraforming#development</a> to build and run the package.</p>\n\n<p>However, when I run <code>./script/setup</code> I got</p>\n\n<pre><code>Traceback (most recent call last):\n    2: from /usr/local/bin/bundle:23:in `&lt;main&gt;'\n    1: from /usr/local/Cellar/ruby/2.6.3/lib/ruby/2.6.0/rubygems.rb:302:in `activate_bin_path'\n/usr/local/Cellar/ruby/2.6.3/lib/ruby/2.6.0/rubygems.rb:283:in `find_spec_for_exe': can't find gem bundler (&gt;= 0.a) with executable bundle (Gem::GemNotFoundException)\n</code></pre>\n\n<p>Did I miss anything obvious? I do not have much ruby experience and I am totally unfamiliar with Ruby ecosystem. </p>\n"}, {"tags": ["ruby", "generator", "enumerator"], "answers": [{"comments": [{"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1572929616, "post_id": 58704166, "comment_id": 103704333, "body": "You can simply write <code>to_a</code> instead of <code>map(&amp;:itself)</code>."}], "tags": [], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "is_accepted": false, "score": 1, "last_activity_date": 1572930153, "last_edit_date": 1572930153, "creation_date": 1572925332, "answer_id": 58704166, "question_id": 58703947, "link": "https://stackoverflow.com/questions/58703947/join-a-ruby-enumerator-into-a-string/58704166#58704166", "title": "Join a ruby enumerator into a string", "body": "<pre><code>a=[\"Raja\",\"gopalan\"].to_enum #let's assume this is your enumerator\n</code></pre>\n\n<p>Write the following code</p>\n\n<pre><code>p a.map(&amp;:itself).join\n</code></pre>\n\n<p>Or </p>\n\n<pre><code>p a.to_a.join\n</code></pre>\n\n<p>output</p>\n\n<pre><code>\"Rajagopalan\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 102855, "user_id": 5056, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/315b95cdcac83705c10ea14e239aeaf5?s=128&d=identicon&r=PG", "display_name": "George Mauer", "link": "https://stackoverflow.com/users/5056/george-mauer"}, "edited": false, "score": 0, "creation_date": 1572926976, "post_id": 58704236, "comment_id": 103703844, "body": "nice! hand&#39;t thought to <code>reduce</code>"}, {"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1572929352, "post_id": 58704236, "comment_id": 103704281, "body": "<code>String#&lt;&lt;</code> is <a href=\"https://github.com/rubocop-hq/ruby-style-guide#string-concatenation\" rel=\"nofollow noreferrer\">better</a> than <code>String#+</code>."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1572933987, "post_id": 58704236, "comment_id": 103705491, "body": "@cremno Yeah, though you better give a starting value: <code>enum.reduce(&quot;&quot;, :&lt;&lt;)</code>, or one might be surprised if the first string in <code>enum</code> is saved somewhere :) <code>arr = [&quot;foo&quot;, &quot;bar&quot;]; enum = arr.to_enum; p enum.reduce(:&lt;&lt;); p arr</code> shows the degenerate case."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1572935563, "post_id": 58704236, "comment_id": 103706011, "body": "Another reason to give <code>reduce</code> a starting value: <code>enum = [].each; enum.reduce(:&lt;&lt;) #=&gt; nil</code> whereas I would think one would generally want <code>enum.reduce(&quot;&quot;, :&lt;&lt;) #=&gt;  &quot;&quot;</code>. Even if one were confident that that array of strings were non-empty this would provide insurance."}], "tags": [], "owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "is_accepted": true, "score": 1, "last_activity_date": 1572926072, "last_edit_date": 1572926072, "creation_date": 1572925772, "answer_id": 58704236, "question_id": 58703947, "link": "https://stackoverflow.com/questions/58703947/join-a-ruby-enumerator-into-a-string/58704236#58704236", "title": "Join a ruby enumerator into a string", "body": "<p>I think in this case I' might reach for <code>inject</code>/<a href=\"https://ruby-doc.org/core/Enumerable.html#method-i-reduce\" rel=\"nofollow noreferrer\"><code>reduce</code></a> (aliases for the same method, <code>reduce</code> as a name makes more sense, to me) with the <code>+</code> operator:</p>\n\n<pre><code>enum.reduce(:+)\n# or, passing in a block\nenum.reduce(&amp;:+)\n</code></pre>\n\n<p>As a full example:</p>\n\n<pre><code># never used Enumerator::Generator directly, but you called it out specifically\n# in your question, and this seems to be doing the trick to get it working\nenum = Enumerator::Generator.new do |y|\n  y.yield \"ant\"\n  y.yield \"bear\"\n  y.yield \"cat\"\nend\n\np enum.reduce(&amp;:+) # output: \"antbearcat\"\n# crude example of modifying the strings as you join them\np enum.reduce('') { |memo, word| memo += word.upcase + ' ' }\n# output: \"ANT BEAR CAT \"\n</code></pre>\n"}], "owner": {"reputation": 102855, "user_id": 5056, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/315b95cdcac83705c10ea14e239aeaf5?s=128&d=identicon&r=PG", "display_name": "George Mauer", "link": "https://stackoverflow.com/users/5056/george-mauer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 58704236, "answer_count": 2, "score": 0, "last_activity_date": 1572930153, "creation_date": 1572923443, "question_id": 58703947, "link": "https://stackoverflow.com/questions/58703947/join-a-ruby-enumerator-into-a-string", "title": "Join a ruby enumerator into a string", "body": "<p>I have an instance of <code>Enumerator::Generator</code> that yields strings. I need to join them into a single string.</p>\n\n<p>What's a good way of doing this? I notice that <code>*</code> doesn't work. I know I can <code>.map {|x| x}</code> first but that seems rather un-idiomatic</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1572923437, "post_id": 58703656, "comment_id": 103703257, "body": "Try the suggestion from kurupt_89 below. If you do <code>cat .bundle&#47;config</code> you should see the setting that you set via the <code>--without</code> flag (among others). You can manually edit that file, or run the config delete command. The --without flag is a little goofy in that, by default, it writes it as a config setting and persists across bundle commands even when you stop passing it"}, {"owner": {"reputation": 53, "user_id": 10994348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ea3111fc3eeb0975bb332c85ea9c6b7?s=128&d=identicon&r=PG&f=1", "display_name": "altblanc", "link": "https://stackoverflow.com/users/10994348/altblanc"}, "reply_to_user": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1572928591, "post_id": 58703656, "comment_id": 103704147, "body": "sorry for my clumsy english. I add information with my question."}], "answers": [{"tags": [], "owner": {"reputation": 1365, "user_id": 541408, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/711ad7b75ad8a8a56fedb27b1e1503ef?s=128&d=identicon&r=PG", "display_name": "kurupt_89", "link": "https://stackoverflow.com/users/541408/kurupt-89"}, "is_accepted": false, "score": 0, "last_activity_date": 1572922803, "creation_date": 1572922803, "answer_id": 58703868, "question_id": 58703656, "link": "https://stackoverflow.com/questions/58703656/detecting-lack-of-gems-in-production/58703868#58703868", "title": "Detecting lack of gems in production", "body": "<p>It's not really clear what your problem is from your description. But have a look at <code>bundle list</code> to view installed gems <a href=\"https://bundler.io/man/bundle-list.1.html\" rel=\"nofollow noreferrer\">https://bundler.io/man/bundle-list.1.html</a></p>\n\n<p>Also, try <code>bundle config</code> and if you see any <code>without</code>'s that you were not expecting, you can run <code>bundle config --delete without</code> to remove them.</p>\n"}, {"tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": false, "score": 0, "last_activity_date": 1572962034, "creation_date": 1572962034, "answer_id": 58712824, "question_id": 58703656, "link": "https://stackoverflow.com/questions/58703656/detecting-lack-of-gems-in-production/58712824#58712824", "title": "Detecting lack of gems in production", "body": "<p>I'm going to try and paraphrase what I think you're asking based on your updated question: </p>\n\n<p>You want your CI pipeline to detect if you used a library in your code that wasn't made available via bundler*, but you don't want to slow your CI pipeline down with another bundle install command.</p>\n\n<p>If that's the case, we have 3 separate pipelines/processes that we use: </p>\n\n<ul>\n<li>CI/CD pipeline on Semaphore to run our automated tests. This pipeline won't catch the type of error described above</li>\n<li>Separate pipeline using Heroku's <a href=\"https://devcenter.heroku.com/articles/github-integration-review-apps\" rel=\"nofollow noreferrer\">review app</a> feature which builds a \"live\" application using dummy/seed data, but production-like settings (e.g. <code>bundle install --without development text</code>). This <em>may</em> catch the type of error described above; you may have to <em>use</em> the review app to trigger the error and sometimes we don't</li>\n<li>We also have a separate staging environment where user testing occurs, which is also production-like. This is where that type of error should definitely be identified (because we have users test features here by using the site)</li>\n</ul>\n\n<p>This has been a common strategy at a number of projects I've worked on for catching this kind of error before it deploys to production.</p>\n\n<p>* Because bundler in production is run <code>bundle --without development test</code></p>\n"}], "owner": {"reputation": 53, "user_id": 10994348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ea3111fc3eeb0975bb332c85ea9c6b7?s=128&d=identicon&r=PG&f=1", "display_name": "altblanc", "link": "https://stackoverflow.com/users/10994348/altblanc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1572962034, "creation_date": 1572921072, "last_edit_date": 1572928522, "question_id": 58703656, "link": "https://stackoverflow.com/questions/58703656/detecting-lack-of-gems-in-production", "title": "Detecting lack of gems in production", "body": "<p>I do <code>bundle install --without development test</code> before my RoR application working in production because I want to remove gems only used in development or test, but the other day, this caused the problem.<br>\nI wrote some code and it works in development, but it contained module provided by the gem, which was installed as development gem's dependence. I used unintentionally so I cannot noticed by deployment failed. So I want to detect it. I'm using CI, so maybe I can notice if I do same <code>bundle install</code> as in production and something rails kicked, but if I do so, CI will take a long time so I don't really want to. I'd love to hear what you think.</p>\n\n<p>edit: I think you haven't got my point yet, so let me explain it again. </p>\n\n<p>for example, my Gemfile is like below;</p>\n\n<pre><code>ruby '2.5.7'\n\ngem 'rails', '5.2.2.1'\n\ngem 'pg', '&gt;= 0.18', '&lt; 2.0'\n\ngem 'puma', '~&gt; 3.11'\n\n...\n\ngroup :development, :test do\n\n  gem 'overcommit'\n  gem 'rails_best_practices'\n  gem 'rubocop' # &lt;- this gem also install unicode_display_width(which has `Unicode::DisplayWidth`) as dependency\nend\n\ngroup :development do\n  gem 'brakeman'\n  gem 'debase'\n  gem 'rack-mini-profiler', require: false\n  gem 'ridgepole'\n  gem 'ruby-debug-ide', '0.6.0'\n...\nend\n\ngroup :test do\n  gem 'simplecov'\n  ...\nend\n\n</code></pre>\n\n<p>and I used <code>Unicode::DisplayWidth</code> in my application because I totally thought it was the library ruby originally has(like csv). I don't want to do something like this again, but I may do carelessly, so I want to detect it.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1572917740, "post_id": 58703223, "comment_id": 103702252, "body": "Are you also sarahmarah? I put something like this in my other answer, I think."}, {"owner": {"reputation": 1, "user_id": 12323477, "user_type": "registered", "profile_image": "https://graph.facebook.com/3196666423683014/picture?type=large", "display_name": "Sarahcah", "link": "https://stackoverflow.com/users/12323477/sarahcah"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1572918490, "post_id": 58703223, "comment_id": 103702372, "body": "Hi sorry no! But I am in a night class to learn programming where we are trying to solve the same issue and there&#39;s a girl with the same name. I&#39;m using the votable gem if that makes it different and I can upvote fine. I just want to display what the user has upvoted if that makes sense Thanks for taking the time to comment!"}], "answers": [{"tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 0, "last_activity_date": 1572926032, "creation_date": 1572926032, "answer_id": 58704260, "question_id": 58703223, "link": "https://stackoverflow.com/questions/58703223/how-would-i-show-liked-upvoted-posts-with-the-acts-as-votable-gem/58704260#58704260", "title": "How would I show liked/upvoted posts with the acts as votable gem", "body": "<p>In order to get your 'Show' link, I think you want to do something like: </p>\n\n<pre><code>&lt;% @internships.each do |internship| %&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;%= internship.title %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= internship.requirements %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= internship.location %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= internship.duraton %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= internship.deadline %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= internship.website %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to 'Show', internship_path(internship) %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to \"upvote\", like_internship_path(internship), method: :put %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to \"downvote\", dislike_internship_path(internship), method: :put %&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>It looks like you already have <code>before_action :set_internship, only: [:show, :edit, :update, :destroy]</code> in your <code>InternshipsController</code>. So, I guess you just need to make a <code>show.html.erb</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "is_accepted": false, "score": 0, "last_activity_date": 1572944322, "creation_date": 1572944322, "answer_id": 58707713, "question_id": 58703223, "link": "https://stackoverflow.com/questions/58703223/how-would-i-show-liked-upvoted-posts-with-the-acts-as-votable-gem/58707713#58707713", "title": "How would I show liked/upvoted posts with the acts as votable gem", "body": "<p>You could make an instance method on Internship that can see if the Student voted for it and display that in your index table. <code>internship.voted_for_by?(current_student)</code> and then in the Internship model</p>\n\n<pre><code>def voted_for_by?(current_student)\n  voting_student = votes_for.up.by_type(Student).voters.find_by(id: current_student.id)\n  voting_student.blank?\nend\n</code></pre>\n\n<p>The query might need work as I'm not too familiar with <code>acts_as_votable</code> but you may be able to work from this. And then based off of the boolean return, you can display a check or whatever you want to indicate the up vote  </p>\n"}], "owner": {"reputation": 1, "user_id": 12323477, "user_type": "registered", "profile_image": "https://graph.facebook.com/3196666423683014/picture?type=large", "display_name": "Sarahcah", "link": "https://stackoverflow.com/users/12323477/sarahcah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1572944322, "creation_date": 1572917193, "question_id": 58703223, "link": "https://stackoverflow.com/questions/58703223/how-would-i-show-liked-upvoted-posts-with-the-acts-as-votable-gem", "title": "How would I show liked/upvoted posts with the acts as votable gem", "body": "<p>Firstly, the gem I'm using is <a href=\"https://github.com/ryanto/acts_as_votable\" rel=\"nofollow noreferrer\">https://github.com/ryanto/acts_as_votable</a></p>\n\n<p>Hi there! I'm really new to rails and trying to build an application where a student can like an internship a company posts. So far I've got everything working but I want the student to be able to see the posts from companies they've upvoted. </p>\n\n<p>So far this is my internship controller which was created just using scaffolding/haven't included all of it.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>class InternshipsController &lt; ApplicationController\r\n  before_action :set_internship, only: [:show, :edit, :update, :destroy]\r\n  \r\n\r\n  \r\n  def upvote\r\n    @internship = Internship.find(params[:id])\r\n    @internship.liked_by current_student\r\n    redirect_to internships_path\r\n    #can change current_user to any other voter\r\n  end\r\n\r\n  def downvote\r\n    @internship = Internship.find(params[:id])\r\n    @internship.disliked_by current_student\r\n    #can change current_user to any other voter\r\n  end\r\n\r\n  # GET /internships\r\n  # GET /internships.json\r\n  def index\r\n    @internships = Internship.all\r\n  end\r\n\r\n  # GET /internships/1\r\n  # GET /internships/1.json\r\n  def show\r\n  end</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>My Internship model</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>class Internship &lt; ApplicationRecord\r\n     belongs_to :company\r\n     acts_as_votable\r\nend</code></pre>\r\n</div>\r\n</div>\r\n\nMy Student Model</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>class Student &lt; ApplicationRecord\r\n  acts_as_voter\r\n  # Include default devise modules. Others available are:\r\n  # :confirmable, :lockable, :timeoutable, :trackable and :omniauthable\r\n  devise :database_authenticatable, :registerable,\r\n         :recoverable, :rememberable, :validatable\r\nend</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>My internships/index.html.erb where I want the student to be able to 'upvote' an internship.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;% @internships.each do |internship| %&gt;\r\n      &lt;tr&gt;\r\n        &lt;td&gt;&lt;%= internship.title %&gt;&lt;/td&gt;\r\n        &lt;td&gt;&lt;%= internship.requirements %&gt;&lt;/td&gt;\r\n        &lt;td&gt;&lt;%= internship.location %&gt;&lt;/td&gt;\r\n        &lt;td&gt;&lt;%= internship.duraton %&gt;&lt;/td&gt;\r\n        &lt;td&gt;&lt;%= internship.deadline %&gt;&lt;/td&gt;\r\n        &lt;td&gt;&lt;%= internship.website %&gt;&lt;/td&gt;\r\n        &lt;td&gt;&lt;%= link_to 'Show', internship %&gt;&lt;/td&gt;\r\n        &lt;td&gt;&lt;%= link_to \"upvote\", like_internship_path(internship), method: :put %&gt;&lt;/td&gt;\r\n        &lt;td&gt;&lt;%= link_to \"downvote\", dislike_internship_path(internship), method: :put %&gt;&lt;/td&gt;</code></pre>\r\n</div>\r\n</div>\r\n\nMy routes </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Rails.application.routes.draw do\r\n  devise_for :students\r\n  resources :internships do\r\n     member do\r\n     put \"like\",    to: \"internships#upvote\"\r\n     put \"dislike\", to: \"internships#downvote\"\r\n   end\r\n end\r\n  devise_for :companies</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>So far this is working great! The last thing I want to do is make the student show the internships they've upvoted and I'm completely stuck. Do I have to put it in a new controller and views. I generated my student model with devise. Any help in the right direction would be great and thank you so much</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "answers": [{"tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 1, "last_activity_date": 1572916890, "last_edit_date": 1572916890, "creation_date": 1572915148, "answer_id": 58703002, "question_id": 58702380, "link": "https://stackoverflow.com/questions/58702380/couldnt-find-internship-without-an-id-error/58703002#58703002", "title": "Couldn&#39;t find Internship without an ID error", "body": "<p>I think if I were you, I would make my routes something like: </p>\n\n<pre><code>resources :internships do \n  member do \n    post :favorite\n    post :unfavorite\n  end\nend\n</code></pre>\n\n<p>Which will give you among other things: </p>\n\n<pre><code>  favorite_internship POST   /internships/:id/favorite(.:format)     internships#favorite\nunfavorite_internship POST   /internships/:id/unfavorite(.:format)   internships#unfavorite\n          internships GET    /internships(.:format)                  internships#index\n                      POST   /internships(.:format)                  internships#create\n       new_internship GET    /internships/new(.:format)              internships#new\n      edit_internship GET    /internships/:id/edit(.:format)         internships#edit\n           internship GET    /internships/:id(.:format)              internships#show\n                      PATCH  /internships/:id(.:format)              internships#update\n                      PUT    /internships/:id(.:format)              internships#update\n                      DELETE /internships/:id(.:format)              internships#destroy\n</code></pre>\n\n<p>Then in your view, you would do something along the lines of:</p>\n\n<pre><code>&lt;td&gt;\n  &lt;% if current_student.favorited?(internship) %&gt;\n    &lt;%= link_to 'unfavourite', unfavorite_internship_path(internship), method: :post %&gt;\n  &lt;% else %&gt;\n    &lt;%= link_to 'favourite', favorite_internship_path(internship), method: :post %&gt;\n  &lt;% end %&gt;\n&lt;/td&gt;\n</code></pre>\n\n<p>This, naturally, assumes you have access to <code>current_student</code> and <code>internship</code> in your view.</p>\n\n<p>Then, in your <code>InternshipsController</code>, you would do something like: </p>\n\n<pre><code>class InternshipsController &lt; ApplicationController\n\n  def favorite\n    @internship = Internship.find(params[:id])\n    current_student.favorite(@internship)\n    # redirect somewhere\n  end\n\n  def unfavorite\n    @internship = Internship.find(params[:id])\n    current_students.unfavorite(@internship)\n    # redirect somewhere\n  end\n\nend\n</code></pre>\n\n<p>Now, <code>favorite</code> and <code>unfavorite</code> are not very restful. So, I guess you could do:</p>\n\n<pre><code>resources :internships do \n  scope module: :internships do \n    resources :favorites, only: [:create] do \n      collection do \n        delete '/', action: :destroy\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Which would give you: </p>\n\n<pre><code>internship_favorites DELETE /internships/:internship_id/favorites(.:format)   internships/favorites#destroy\n                     POST   /internships/:internship_id/favorites(.:format)   internships/favorites#create\n         internships GET    /internships(.:format)                            internships#index\n                     POST   /internships(.:format)                            internships#create\n      new_internship GET    /internships/new(.:format)                        internships#new\n     edit_internship GET    /internships/:id/edit(.:format)                   internships#edit\n          internship GET    /internships/:id(.:format)                        internships#show\n                     PATCH  /internships/:id(.:format)                        internships#update\n                     PUT    /internships/:id(.:format)                        internships#update\n                     DELETE /internships/:id(.:format)                        internships#destroy\n</code></pre>\n\n<p>Then you would need a <code>Internships::FavoritesController</code> something like: </p>\n\n<pre><code># in app/controllers/internships/favorites_controller.rb\nclass Internships::FavoritesController &lt; ApplicationController\n\n  def create\n    @internship = Internship.find(params[:internship_id])\n    current_student.favorite(@internship)\n    # redirect somewhere\n  end\n\n  def destroy\n    @internship = Internship.find(params[:internship_id])\n    current_students.unfavorite(@internship)\n    # redirect somewhere\n  end\n\nend\n</code></pre>\n\n<p>Then in your view, it would be more like:</p>\n\n<pre><code>&lt;td&gt;\n  &lt;% if current_student.favorited?(internship) %&gt;\n    &lt;%= link_to 'unfavourite', internship_favorites_path(internship), method: :delete %&gt;\n  &lt;% else %&gt;\n    &lt;%= link_to 'favourite', internship_favorites_path(internship), method: :post %&gt;\n  &lt;% end %&gt;\n&lt;/td&gt;\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 12133713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b57ee60751311e5293211f73d90eaa2b?s=128&d=identicon&r=PG&f=1", "display_name": "saramarah", "link": "https://stackoverflow.com/users/12133713/saramarah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1588079822, "creation_date": 1572909331, "question_id": 58702380, "link": "https://stackoverflow.com/questions/58702380/couldnt-find-internship-without-an-id-error", "title": "Couldn&#39;t find Internship without an ID error", "body": "<p>Hi so I'm really new to rails and I am trying to figure out how to use this gem <a href=\"https://github.com/jonhue/acts_as_favoritor\" rel=\"nofollow noreferrer\">https://github.com/jonhue/acts_as_favoritor</a>.</p>\n\n<p>At the moment I am trying to get a student to favourite an internship.</p>\n\n<p>My favourites controller looks like this</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>    class FavouritesController &lt; ApplicationController\r\n\r\n    def new\r\n        @internship = Internship.find(params[:id])\r\n        current_student.favourite(internship)\r\n        redirect_to_show\r\n    end\r\n\r\n    def show\r\n        current_students.all_favourites\r\n    end\r\n\r\nend</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>My routes look like this</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Rails.application.routes.draw do\r\n  resources :favourites\r\n  devise_for :students\r\n  resources :internships\r\n  devise_for :companies\r\n  # For details on the DSL ava</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>And my button to add an internship shown in the index is this</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;td&gt;&lt;%= link_to 'favourite', new_favourite_path %&gt;&lt;/td&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Using the gem I have put in the models acts_as_favoritor in the student model and acts_as_favoritable in the internship model. I have been banging my head against the wall for ages trying to understand how to write methods from so if someone could please help me out, Thank you heaps!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 382, "user_id": 7479934, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100007344395075/picture?type=large", "display_name": "Amanda Ferrari", "link": "https://stackoverflow.com/users/7479934/amanda-ferrari"}, "edited": false, "score": 0, "creation_date": 1572908289, "post_id": 58702081, "comment_id": 103700279, "body": "I heard I could also use add_index. Is that correct?"}], "tags": [], "owner": {"reputation": 16077, "user_id": 319702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Rb5G2.jpg?s=128&g=1", "display_name": "sameera207", "link": "https://stackoverflow.com/users/319702/sameera207"}, "is_accepted": false, "score": 2, "last_activity_date": 1572907128, "creation_date": 1572907128, "answer_id": 58702081, "question_id": 58701736, "link": "https://stackoverflow.com/questions/58701736/use-foreign-key-as-part-of-composite-key/58702081#58702081", "title": "Use foreign key as part of composite key", "body": "<p>So, Rails ActiveRecord does not support composite primary keys by default. This the reason you'll be seeing this message (<a href=\"https://github.com/rails/rails/blob/master/activerecord/lib/active_record/attribute_methods/primary_key.rb#L122\" rel=\"nofollow noreferrer\">here is the source</a>)</p>\n\n<p>However, if you want to use this feature, you can try <a href=\"https://github.com/composite-primary-keys/composite_primary_keys\" rel=\"nofollow noreferrer\">composite_primary_keys</a> gem  </p>\n\n<p>So you can do something like </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># after installing the gem\nclass Post &lt; ActiveRecord::Base\n  self.primary_keys = :id, site_id\n  ...\nend\n</code></pre>\n"}], "owner": {"reputation": 382, "user_id": 7479934, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100007344395075/picture?type=large", "display_name": "Amanda Ferrari", "link": "https://stackoverflow.com/users/7479934/amanda-ferrari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1572907128, "creation_date": 1572905075, "last_edit_date": 1572905892, "question_id": 58701736, "link": "https://stackoverflow.com/questions/58701736/use-foreign-key-as-part-of-composite-key", "title": "Use foreign key as part of composite key", "body": "<p>So, I'm creating this app that's sort of like Google Analytics. The user installs the JS snipped on his blog and the JS sends metrics related to each post. The only extra information needed to install it's his <code>site_id</code> (sort of like the google analytics id). This app is going to only work with wordpress, and for each blog post an entry in the <code>posts</code> table will be created, so I have the following migration:</p>\n\n<pre><code>class CreatePosts &lt; ActiveRecord::Migration[6.0]\n  def change\n   create_table :posts, primary_key: %i[id site_id] do |t|\n      t.belongs_to :site, null: false\n      t.bigint :id\n      t.bigint :post_id\n      t.string :url\n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>I've created this composite key which the foreign key (<code>site_id</code>) is part of it. I would like to know if this is ok, and if it would break any aspect of ActiveRecord.</p>\n\n<p>I know it might look like a weird thing, so let me explain why I need this.</p>\n\n<p>The <code>id</code> of the posts is going to be the same id used in the wordpress blog post database, so let's say I have two users, each one with one site and each one containing 5 posts. If their blog posts contain the same <code>id</code>, this would be a problem... but if I have a composite key <code>site_id</code> + <code>post_id</code> it's ok. My only concern is if this could break how ActiveRecord handle associations.</p>\n\n<p>I'm making some tests and everything seems to be working, but I'm not sure, because although creating a post works, this warning keeps showing up:</p>\n\n<pre><code>WARNING: Active Record does not support composite primary key.\n\nposts has composite primary key. Composite primary key is ignored.\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby", "selenium-webdriver", "automation", "selenium-chromedriver", "capybara"], "comments": [{"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 1, "creation_date": 1572906382, "post_id": 58701171, "comment_id": 103699734, "body": "Welcome to SO. Please take the time to read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. It will help you craft solid questions that will hopefully get useful answers.   Check out the documentation for <a href=\"https://selenium.dev/selenium/docs/api/rb/Selenium/WebDriver/Element.html#send_keys-instance_method\" rel=\"nofollow noreferrer\"><code>send_keys</code></a>.  You should be able to do something like <code>element.send_keys :alt, :space, &quot;X&quot;</code>.  Or just use <a href=\"https://selenium.dev/selenium/docs/api/rb/Selenium/WebDriver/Window.html#maximize-instance_method\" rel=\"nofollow noreferrer\">Window::maximize</a>.  Good luck!"}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1572914665, "post_id": 58701171, "comment_id": 103701630, "body": "There is a standard code to maximize the window why do you have to go via pressing keys"}, {"owner": {"reputation": 17424, "user_id": 278842, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/df6877d3f05e542ca5975b4670600f2e?s=128&d=identicon&r=PG", "display_name": "Christopher Oezbek", "link": "https://stackoverflow.com/users/278842/christopher-oezbek"}, "edited": false, "score": 0, "creation_date": 1573075138, "post_id": 58701171, "comment_id": 103767237, "body": "Hi Marquiiz! Your question is a bit confusing because you mix up the Windows Scripting Host question with the selenium-webdriver. Which one do you want? For the WSH part, please observe that you are actually using ALT+SPACE and then press x to maximize. So just call send_keys twice."}, {"owner": {"reputation": 17424, "user_id": 278842, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/df6877d3f05e542ca5975b4670600f2e?s=128&d=identicon&r=PG", "display_name": "Christopher Oezbek", "link": "https://stackoverflow.com/users/278842/christopher-oezbek"}, "edited": false, "score": 0, "creation_date": 1573075203, "post_id": 58701171, "comment_id": 103767265, "body": "@Marquiiiz Also a hint about your code samples: It is better to translate everything into English so everyone can understand."}, {"owner": {"reputation": 11, "user_id": 12322824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/795be0b74c29de2d99dc292e642c9fd7?s=128&d=identicon&r=PG&f=1", "display_name": "Marquiiiz", "link": "https://stackoverflow.com/users/12322824/marquiiiz"}, "edited": false, "score": 0, "creation_date": 1573077172, "post_id": 58701171, "comment_id": 103767929, "body": "What I do want is to open my window maximized, thats all , anyway you want, I had pass my env.rb, because I couldnt find a way to use his answer on my code"}, {"owner": {"reputation": 11, "user_id": 12322824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/795be0b74c29de2d99dc292e642c9fd7?s=128&d=identicon&r=PG&f=1", "display_name": "Marquiiiz", "link": "https://stackoverflow.com/users/12322824/marquiiiz"}, "edited": false, "score": 0, "creation_date": 1573077308, "post_id": 58701171, "comment_id": 103767992, "body": "If anyone could share a piece of code that does opens my chrome maxmized in ruby automation that works I&#39;would appriciate that"}], "answers": [{"comments": [{"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1572925571, "post_id": 58703287, "comment_id": 103703614, "body": "hi, can you explain me how both differs? for an example, <code>driver.find_element.click</code> trigger the OS but <code>driver.action.click(driver.find_element).perform</code> performs the browser level click? what&#39;s the difference? both are calling the click module,eh?"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1572926231, "post_id": 58703287, "comment_id": 103703731, "body": "@Rajagopalan Both of those would trigger browser level events. There is no way through webdriver that guarantees OS levels responses"}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1572952048, "post_id": 58703287, "comment_id": 103713907, "body": "No,you said there is a difference for triggering the OS level, what is this? How does this differ from triggering the action from browser level?"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 1, "creation_date": 1572968082, "post_id": 58703287, "comment_id": 103722500, "body": "@Rajagopalan I don&#39;t understand what you&#39;re asking? The keystrokes sent are directly sent to the browser via the webdriver protocol.  They don&#39;t get routed and handled by the OS like keystrokes directly on a keyboard would (active window, OS keystroke shortcuts, etc)"}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": false, "score": 1, "last_activity_date": 1572917757, "creation_date": 1572917757, "answer_id": 58703287, "question_id": 58701171, "link": "https://stackoverflow.com/questions/58701171/how-do-i-send-multiple-keystroke-in-ruby/58703287#58703287", "title": "How do I send multiple keystroke in ruby?", "body": "<p>Keys you send are sent to the browser, not the OS, so aren't guaranteed to trigger system actions.  To maximize the window your best best is</p>\n\n<pre><code>page.current_window.maximize\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12322824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/795be0b74c29de2d99dc292e642c9fd7?s=128&d=identicon&r=PG&f=1", "display_name": "Marquiiiz", "link": "https://stackoverflow.com/users/12322824/marquiiiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1573073831, "creation_date": 1572902107, "last_edit_date": 1573073831, "question_id": 58701171, "link": "https://stackoverflow.com/questions/58701171/how-do-i-send-multiple-keystroke-in-ruby", "title": "How do I send multiple keystroke in ruby?", "body": "<p>I'm trying to send keystroke in a ruby automation, I don't know how to put this in my code, I want to send (Alt+Space + X) to maximize my window.</p>\n\n<p>Anyone could help me in this one?</p>\n\n<pre><code>When(\"que eu realize login no SIAF com usu\u00e1rio e senha\") do |table|\n    wsh.SendKeys(\"%{VK 32}{VK 88}\") \n    @usuario = table.rows_hash['usuario']\n    @senha = table.rows_hash['senha']\n\n\n    login.load\n    login.log(@usuario,@senha)\n  end\n</code></pre>\n\n<p>I expect window to be maximized by command Alt+Space+X, but nothing happens.</p>\n\n<p>My \"env.rb\" I\u00b4m using like this:</p>\n\n<pre><code>require 'capybara'\nrequire 'capybara/dsl'\nrequire 'capybara/rspec/matchers'\nrequire 'selenium-webdriver'\nrequire 'site_prism'\nrequire 'rspec'\nrequire_relative 'page_helper.rb'\n\n\nWorld(Capybara::DSL)\nWorld(Capybara::RSpecMatchers)\nWorld(Pages)\n\nCapybara.register_driver :selenium do |app|\n    Capybara::Selenium::Driver.new(\n    app,\n    browser: :chrome,\n    mange.window.maximize\n    desired_capabilities: Selenium::WebDriver::Remote::Capabilities.chrome(\n        'chromeOptions' =&gt; {'args' =&gt; ['--disable-infobars', \n                                        'window-size=1600,1024'] }\n\n    )\n\n\n)\n\n\nend\n</code></pre>\n\n<p>Where can I put \"Drive.mangage.window.maximize\" ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ternary"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1572900694, "post_id": 58700835, "comment_id": 103697674, "body": "Did you look at <code>find_or_create_by</code>?"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1572900738, "post_id": 58700835, "comment_id": 103697700, "body": "What Rails version are you using?"}, {"owner": {"reputation": 7358, "user_id": 2394970, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1bf447cf1afc783b4b4e6ecd9ab292f7?s=128&d=identicon&r=PG", "display_name": "lost9123193", "link": "https://stackoverflow.com/users/2394970/lost9123193"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1572900863, "post_id": 58700835, "comment_id": 103697738, "body": "@SebastianPalma i&#39;m using Rails v5.2.2"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1572921224, "post_id": 58700835, "comment_id": 103702855, "body": "There&#39;s also <code>create_with</code> and <code>find_by</code>, which can be chained in a similar fashion"}], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 2394970, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1bf447cf1afc783b4b4e6ecd9ab292f7?s=128&d=identicon&r=PG", "display_name": "lost9123193", "link": "https://stackoverflow.com/users/2394970/lost9123193"}, "edited": false, "score": 0, "creation_date": 1572901199, "post_id": 58700855, "comment_id": 103697864, "body": "awesome! i&#39;m guessing this works with multiple attributes? I&#39;ll double check if this is compatible with rails v5"}, {"owner": {"reputation": 1382, "user_id": 2886945, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IgtEd.jpg?s=128&g=1", "display_name": "Ivan Denysov", "link": "https://stackoverflow.com/users/2886945/ivan-denysov"}, "edited": false, "score": 1, "creation_date": 1572901944, "post_id": 58700855, "comment_id": 103698114, "body": "If you are using rails 6 or higher then use <code>Animal.create_or_find_by(name:name, type:type)</code> to avoid possible race conditions. It might never become an issue in your current application. But it will save you from some grey hair in the future :) You can read why this method was introduced here: <a href=\"https://blog.bigbinary.com/2019/03/25/rails-6-adds-create_or_find_by.html\" rel=\"nofollow noreferrer\">blog.bigbinary.com/2019/03/25/&hellip;</a>"}, {"owner": {"reputation": 7358, "user_id": 2394970, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1bf447cf1afc783b4b4e6ecd9ab292f7?s=128&d=identicon&r=PG", "display_name": "lost9123193", "link": "https://stackoverflow.com/users/2394970/lost9123193"}, "reply_to_user": {"reputation": 1382, "user_id": 2886945, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IgtEd.jpg?s=128&g=1", "display_name": "Ivan Denysov", "link": "https://stackoverflow.com/users/2886945/ivan-denysov"}, "edited": false, "score": 0, "creation_date": 1572902674, "post_id": 58700855, "comment_id": 103698399, "body": "@IvanDenysov if I&#39;m using rails 5 do you know what&#39;s the best way that I can avoid the race conditions?"}, {"owner": {"reputation": 1382, "user_id": 2886945, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IgtEd.jpg?s=128&g=1", "display_name": "Ivan Denysov", "link": "https://stackoverflow.com/users/2886945/ivan-denysov"}, "reply_to_user": {"reputation": 7358, "user_id": 2394970, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1bf447cf1afc783b4b4e6ecd9ab292f7?s=128&d=identicon&r=PG", "display_name": "lost9123193", "link": "https://stackoverflow.com/users/2394970/lost9123193"}, "edited": false, "score": 1, "creation_date": 1572902867, "post_id": 58700855, "comment_id": 103698472, "body": "@lost9123193 here&#39;s a great answer I found: <a href=\"https://stackoverflow.com/a/5917936/2886945\">stackoverflow.com/a/5917936/2886945</a> Looks a lot messier than built-in solution from rails 6 :)"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 1382, "user_id": 2886945, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IgtEd.jpg?s=128&g=1", "display_name": "Ivan Denysov", "link": "https://stackoverflow.com/users/2886945/ivan-denysov"}, "edited": false, "score": 2, "creation_date": 1572905568, "post_id": 58700855, "comment_id": 103699454, "body": "@IvanDenysov <code>create_or_find_by</code> (cf) has different behaviour than <code>find_or_create_by</code> (fc). cf first tries to create a record, if it fails due to a unique constraint the record is fetched instead. fc first tries to find the record, if it can&#39;t be found it is created. If there is no unique constraint over the <i>name</i>, <i>type</i> or <i>name/type</i> combo your suggestion will always create a record."}], "tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": true, "score": 7, "last_activity_date": 1572907143, "last_edit_date": 1572907143, "creation_date": 1572900714, "answer_id": 58700855, "question_id": 58700835, "link": "https://stackoverflow.com/questions/58700835/simply-if-statement-to-a-tenerary-in-ruby/58700855#58700855", "title": "Simply if statement to a Tenerary in Ruby", "body": "<p>Try <a href=\"https://apidock.com/rails/v4.0.2/ActiveRecord/Relation/find_or_create_by\" rel=\"noreferrer\">find_or_create_by</a></p>\n\n<pre><code>animal = Animal.find_or_create_by(name: name, type: type)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 1, "last_activity_date": 1572906703, "last_edit_date": 1572906703, "creation_date": 1572906345, "answer_id": 58701969, "question_id": 58700835, "link": "https://stackoverflow.com/questions/58700835/simply-if-statement-to-a-tenerary-in-ruby/58701969#58701969", "title": "Simply if statement to a Tenerary in Ruby", "body": "<p>In your specific scenario the <a href=\"https://stackoverflow.com/a/58700855/3982562\">answer of Mark</a> is the better answer. However I'd like to offer a clean solution of what you currently have.</p>\n\n<p>Ruby allows an inline modifier-if/unless statement. This would look like this:</p>\n\n<pre><code>animal = Animal.find_by(name: name, type: type)\nanimal = Animal.create(name: name, type: type) unless animal\n</code></pre>\n\n<p>You could also make use of the <code>||=</code> operator here (which has my preference). This operator only assigns the right had value to the variable if the variable currently holds a falsy value (<code>nil</code> or <code>false</code>).</p>\n\n<pre><code>animal = Animal.find_by(name: name, type: type)\nanimal ||= Animal.create(name: name, type: type)\n\n# or if you prefer the longer one-liner\nanimal = Animal.find_by(name: name, type: type) || Animal.create(name: name, type: type)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "is_accepted": false, "score": 0, "last_activity_date": 1572935112, "creation_date": 1572935112, "answer_id": 58705576, "question_id": 58700835, "link": "https://stackoverflow.com/questions/58700835/simply-if-statement-to-a-tenerary-in-ruby/58705576#58705576", "title": "Simply if statement to a Tenerary in Ruby", "body": "<p>Just one more variation:</p>\n\n<pre><code>animal = Animal.find_by(name:name, type:type) || Animal.create(name:name, type:type)\n</code></pre>\n"}], "owner": {"reputation": 7358, "user_id": 2394970, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1bf447cf1afc783b4b4e6ecd9ab292f7?s=128&d=identicon&r=PG", "display_name": "lost9123193", "link": "https://stackoverflow.com/users/2394970/lost9123193"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 58700855, "answer_count": 3, "score": 2, "last_activity_date": 1572935112, "creation_date": 1572900585, "last_edit_date": 1572901677, "question_id": 58700835, "link": "https://stackoverflow.com/questions/58700835/simply-if-statement-to-a-tenerary-in-ruby", "title": "Simply if statement to a Tenerary in Ruby", "body": "<p>I'm new to Rails and was wondering about the following:</p>\n\n<p>Is there a way to simplify this further?      </p>\n\n<pre><code>  animal = Animal.find_by(name:name, type:type)\n  if !animal\n    animal = Animal.create(name:name, type:type)\n</code></pre>\n\n<p>I was thinking of using a ternary expression but i'm wondering how I would write that without repeating code or if this is the correct way of doing it.</p>\n\n<pre><code>animal = Animal.find_by(name:name, type:type) ? Animal.find_by(name:name, type:type) :  Animal.create(name:name, type:type);\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 1382, "user_id": 2886945, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IgtEd.jpg?s=128&g=1", "display_name": "Ivan Denysov", "link": "https://stackoverflow.com/users/2886945/ivan-denysov"}, "is_accepted": false, "score": 2, "last_activity_date": 1572902735, "creation_date": 1572902735, "answer_id": 58701293, "question_id": 58700186, "link": "https://stackoverflow.com/questions/58700186/understanding-rails-s-conflict-with-puma-and-capybara-how-do-i-properly-install/58701293#58701293", "title": "Understanding rails s conflict with Puma and Capybara. How do I properly install puma in the Gemfile?", "body": "<p>Install puma only for test environment by putting it into test group:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>group :test do\n  gem \"puma\"\nend\n</code></pre>\n\n<p>Or do as Capybara proposes and put <code>Capybara.server = :webrick</code> into your <code>spec/rails_helper.rb</code></p>\n\n<p>FYI: Rails uses puma as default web server if puma is installed</p>\n"}], "owner": {"reputation": 3945, "user_id": 2325598, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/wbO59.jpg?s=128&g=1", "display_name": "Dan Rubio", "link": "https://stackoverflow.com/users/2325598/dan-rubio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 487, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572902735, "creation_date": 1572897204, "question_id": 58700186, "link": "https://stackoverflow.com/questions/58700186/understanding-rails-s-conflict-with-puma-and-capybara-how-do-i-properly-install", "title": "Understanding rails s conflict with Puma and Capybara. How do I properly install puma in the Gemfile?", "body": "<p>I am inheriting a code base where the tests have been abandoned for a little over a year. I am trying to clean up the test suite as much as possible but I am having a difficult time teasing out my integration tests with 1. Capybara 2. Puma, 3. Selenium, 4. Starting the Rails Server with rails s.</p>\n\n<p>Here is my initial setup and problem with the Rails 4.2 app. So without doing anything from the get go, when I execute rails testing, I get the following error:</p>\n\n<blockquote>\n  <p>Capybara is unable to load <code>puma</code> for its server, please add <code>puma</code> to your project or specify a different server via something like <code>Capybara.server = :webrick</code>. (LoadError).</p>\n</blockquote>\n\n<p>I want to point out that in a separate file named <code>start-dev</code>, I have the following in its contents:</p>\n\n<pre><code>rails s -b 0.0.0.0\n</code></pre>\n\n<p>When I execute this comand with ./start-dev, I am able to view my development app with this url defined in my <code>/etc/hosts</code> <code>127.0.0.1      secure.ssl.local</code></p>\n\n<p>Now here is where I start to run into trouble, Through reading some github forums regarding capybara and puma, I start by adding puma into my Gemfile and bundle install but now I am unable to see my development app through the browser at <code>secure.ssl.local</code>.</p>\n\n<p>This is the erorr I get:</p>\n\n<blockquote>\n  <p>/usr/lib/ruby/2.6.0/uri/rfc3986_parser.rb:67:in `split': bad URI(is not URI?): \"tcp://0.0.0.0\\r:3000\" (URI::InvalidURIError)</p>\n</blockquote>\n\n<p>I noticed that in the start up though, when I execute <code>./start-dev</code> which if you remeber has <code>rails s -b 0.0.0.0</code>, I see this:</p>\n\n<pre><code>Booting Puma rails 4.2.11.1 application starting in development on https://0.0.0.0:3000\n</code></pre>\n\n<p>So I am confused by this error. Is Puma blocking my port of <code>3000</code> meaning that I have to change the port of Puma? And what makes this even more confusing is that instead of running <code>./start-dev</code> in the terminal and I simply run <code>rails s -b 0.0.0.0</code> it magically works except it only works if I navigate to <code>localhost:3000</code> and not <code>secure.ssl.localhost</code>. This is important because on secure.ssl.localhost I have and need a certificate and localhost I don't.</p>\n\n<p>And finally to add one more layer of confusion, when I run the tests with the puma gem installed and run <code>rake test</code> I get this with Puma:</p>\n\n<blockquote>\n  <p>Capybara starting Puma...\n  * Version 4.2.1 , codename: Distant Airhorns\n  * Min threads: 0, max threads: 4\n  * Listening on tcp://127.0.0.1:36608</p>\n</blockquote>\n\n<p>And the test takes ages to load. There is a lot going on but I guess my question can be summarised by the following?  When I install puma into my rails application, do I need to specify it on a specific port so it does not conflict with my app? Without puma, my tests can't run and my <code>./start-dev</code> file works. With puma, my tests are kind of working but my <code>./start-dev</code> file isn't anymore. Surely there must be a standard to configure puma. Thank you.</p>\n"}, {"tags": ["ruby", "heroku", "jit"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1572897110, "post_id": 58699893, "comment_id": 103696366, "body": "&quot;<i>in subsequent runs</i>&quot; Do you mean of your one-off dyno? No. Do you mean subsequent method calls within the existing dyno? Yes. For example, if your app calls <code>1000.times { &#39;&#39;.empty? }</code> then sure, because you&#39;re repeatedly calling a method that is optimized by the jit. But if your app is dead-simple and runs very quickly you&#39;re probably not going to see any improvement. You should be using something like New Relic or another APM product to measure it directly. Just guessing at whether it&#39;s better or not isn&#39;t a good idea."}, {"owner": {"reputation": 61, "user_id": 10766286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf6d98a48ccb857df68b9a8f1a99d76?s=128&d=identicon&r=PG&f=1", "display_name": "WuMing2", "link": "https://stackoverflow.com/users/10766286/wuming2"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1572898456, "post_id": 58699893, "comment_id": 103696883, "body": "I meant in following-up runs of my one-off dyno. The ephemeral file system is self-explanatory so I guessed\u2014jit not to be effective. Still Heroku may consider to add this specialized form of compiled ruby scripts persistency to the platform."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1572898945, "post_id": 58699893, "comment_id": 103697070, "body": "@WuMing2 &quot;following-up runs&quot;, &quot;one-off dyno&quot; - these are mutually exclusive :)"}, {"owner": {"reputation": 61, "user_id": 10766286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf6d98a48ccb857df68b9a8f1a99d76?s=128&d=identicon&r=PG&f=1", "display_name": "WuMing2", "link": "https://stackoverflow.com/users/10766286/wuming2"}, "edited": false, "score": 0, "creation_date": 1572899324, "post_id": 58699893, "comment_id": 103697197, "body": "\u201cscheduled runs\u201d of \u201cone-off dyno\u201d is more precise. But you are teasing me :)"}], "owner": {"reputation": 61, "user_id": 10766286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf6d98a48ccb857df68b9a8f1a99d76?s=128&d=identicon&r=PG&f=1", "display_name": "WuMing2", "link": "https://stackoverflow.com/users/10766286/wuming2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572896272, "creation_date": 1572895778, "last_edit_date": 1572896272, "question_id": 58699893, "link": "https://stackoverflow.com/questions/58699893/are-ruby-jit-compilation-results-retained-on-heroku", "title": "Are ruby jit compilation results retained on Heroku?", "body": "<p>I am currently running a ruby script through Heroku Scheduler. </p>\n\n<p>Since any changes to the <a href=\"https://devcenter.heroku.com/articles/dynos#ephemeral-filesystem\" rel=\"nofollow noreferrer\">ephemeral file system</a> are discarded after the <a href=\"https://devcenter.heroku.com/articles/one-off-dynos\" rel=\"nofollow noreferrer\">one-off dyno</a> stops, was wondering if <code>ruby \u2014jit</code> has any (positive) effect while used in the Heroku Scheduler environment. </p>\n\n<p>Are compilation results retained and re-used as intended in subsequent runs?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 0, "creation_date": 1572895293, "post_id": 58699683, "comment_id": 103695683, "body": "For &quot;matching&quot; you need another array which will keep matched pairs"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8599704"}, "reply_to_user": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 0, "creation_date": 1572895363, "post_id": 58699683, "comment_id": 103695708, "body": "mmmm, ok. but when creating the seeds how will I do that?"}, {"owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 1, "creation_date": 1572895424, "post_id": 58699683, "comment_id": 103695727, "body": "What you mean by &quot;seeds&quot;?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8599704"}, "reply_to_user": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 0, "creation_date": 1572895701, "post_id": 58699683, "comment_id": 103695846, "body": "when I do my <b>create</b> function. Iwant that when I type my rails console, I want to see thier respective child&#39;s and parent arrays."}, {"owner": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "edited": false, "score": 2, "creation_date": 1572896436, "post_id": 58699683, "comment_id": 103696118, "body": "So, you are working in your <code>seeds.rb</code> file and are trying to figure out the logic of how to  create and associate records based off of arrays? If this is the case, i&#39;d be helpful to see your current seeds.rb file as well as your schema."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8599704"}, "reply_to_user": {"reputation": 2345, "user_id": 4988918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x1BRI.png?s=128&g=1", "display_name": "Mark Merritt", "link": "https://stackoverflow.com/users/4988918/mark-merritt"}, "edited": false, "score": 0, "creation_date": 1572897250, "post_id": 58699683, "comment_id": 103696429, "body": "@MarkMerritt I added my seed file! Thanks!"}, {"owner": {"reputation": 841, "user_id": 12294425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxWNY.jpg?s=128&g=1", "display_name": "calebkm", "link": "https://stackoverflow.com/users/12294425/calebkm"}, "edited": false, "score": 0, "creation_date": 1572899660, "post_id": 58699683, "comment_id": 103697309, "body": "Can you show us what the <code>Division</code> model looks like?"}], "answers": [{"tags": [], "owner": {"reputation": 841, "user_id": 12294425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxWNY.jpg?s=128&g=1", "display_name": "calebkm", "link": "https://stackoverflow.com/users/12294425/calebkm"}, "is_accepted": false, "score": 1, "last_activity_date": 1572906591, "last_edit_date": 1572906591, "creation_date": 1572899780, "answer_id": 58700687, "question_id": 58699683, "link": "https://stackoverflow.com/questions/58699683/match-parent-array-with-child-array-seeds-ruby-on-rails-5/58700687#58700687", "title": "Match parent array with child Array Seeds Ruby on Rails 5", "body": "<p>Depending on what the <code>Division</code> model looks like, you should be able to generate all of the objects you want by specifying the relationships with arrays of hashes. Something like:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>company = {\n  name: 'Tecnics',\n  departments: ['HR', 'Sales', 'IT', 'Marketing'],\n  assignments: ['Government', 'Telecom']\n}\n\ndepartments = [\n  {name: 'HR', parent_name: 'Tecnics', parent_type: 'Company', assignments: ['Contracts']},\n  {name: 'Sales', parent_name: 'Tecnics', parent_type: 'Company', assignments: ['Banks'], server: 'Canada'},\n  {name: 'IT', parent_name: 'Tecnics', parent_type: 'Company' assignments: ['Severs']},\n  {name: 'Marketing', parent_name: 'Tecnics', parent_type: 'Company', assignments: ['Social Media']}\n]\n\nassignments = [\n  {name: 'Government', parent_name: 'Tecnics', parent_type: 'Company'},\n  {name: 'Contracts', parent_name: 'HR', parent_type: 'department' server: 'New York'},\n  {name: 'Banks', parent_name: 'Sales', parent_type: 'department'},\n  {name: 'Servers', parent_name: 'IT', parent_type: 'department', server: 'Ohio'},\n  {name: 'Social Media', parent_name: 'Marketing', parent_type: 'department', server: 'Mexico'},\n  {name: 'Telecom' parent_name: 'Tecnics', parent_type: 'Company'}\n]\n\nservers = [\n  {name: 'Mexico', parent_name: 'Social Media', parent_type: 'assignment'},\n  {name: 'Canada', parent_name: 'Sales', parent_type: 'department'},\n  {name: 'Ohio', parent_name: 'Servers', parent_type: 'assignment'},\n  {name: 'New York', parent_name: 'Contracts', parent_type: 'assignment'}\n]\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8599704"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1572906591, "creation_date": 1572894661, "last_edit_date": 1572897223, "question_id": 58699683, "link": "https://stackoverflow.com/questions/58699683/match-parent-array-with-child-array-seeds-ruby-on-rails-5", "title": "Match parent array with child Array Seeds Ruby on Rails 5", "body": "<p>Im creating a seed test on my ruby on rails app, and I got the following arrays:</p>\n\n<p><strong>Seed.rb file</strong></p>\n\n<pre><code>        company = [\"Tecnics\"]\n\n        departments = [\"hr\"],[\"sales\"],[\"IT\"],[\"marketing\"]\n\n        assignments = [\"goverment\"],[\"contracts\"],[\"banks\"],[\"servers\"][\"social media\"], [\"telecom\"]\n\n        country_servers = [\"mexico\"], [\"canada\"], [\"ohio\"], [\"New york\"]\n\n\n      company = Division.create!({\n       name: company[0]\n      })\n\n      #departments\n      departments.each { |dept_name, idx|\n        dept_names = Division.create!({\n          name: dept,\n          parent_id: company.id\n        })\n      }  \n\n      #assignments\n      assignments.each  {|assign_name, idx|\n        @assign_tmp = Division.create!({\n          name: assign_name,\n          parent_id: dept_names.id\n        })\n      }  \n\n     #country_servers\n      country_servers.each  {|server_name, idx|\n        @server_tmp = Division.create!({\n          name: server_name,\n          parent_id: assign_tmp.id\n        })\n      }\nFile.sort_tree \n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/xPeYV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xPeYV.png\" alt=\"enter image description here\"></a></p>\n\n<p>Lets say I want to match Canada server with sales department. How can I approach this doing it with arrays when I create my seeds? Or How can I match Department with its appropiate assignment and server country in my seeds file? </p>\n\n<p>Do I need to access an array? </p>\n\n<p>I will appreatiate the help!</p>\n\n<p>NOTE: I added my fill seed file</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 3, "creation_date": 1572887454, "post_id": 58698097, "comment_id": 103692470, "body": "You can use <code>.where(action_at: req.action_at).where.not(cancelled_at: nil)</code> If this is not returning anything, then you&#39;d need to share more info, like schema and what records are in the DB"}, {"owner": {"reputation": 725, "user_id": 9774506, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Falko", "link": "https://stackoverflow.com/users/9774506/falko"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1572887906, "post_id": 58698097, "comment_id": 103692702, "body": "That works @maxpleaner"}, {"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 2, "creation_date": 1572892655, "post_id": 58698097, "comment_id": 103694689, "body": "As for why this happens: when comparing to <code>NULL</code>, you usually want to use <code>IS NULL</code> or <code>IS NOT NULL</code> in SQL. This is strictly different from <code>= NULL</code>. Since <code>NULL</code> is not equal to anything (not even <code>NULL</code> itself), you can&#39;t compare it like other values. This is the major difference between <code>NULL</code> in SQL and <code>nil</code> in Ruby (which mostly is just another object). See <a href=\"https://en.wikipedia.org/wiki/Null_(SQL)\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Null_(SQL)</a>."}, {"owner": {"reputation": 330, "user_id": 5450103, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9853fc7319dfae8d598d159f5f8ea005?s=128&d=identicon&r=PG&f=1", "display_name": "Vignan S", "link": "https://stackoverflow.com/users/5450103/vignan-s"}, "edited": false, "score": 1, "creation_date": 1572915664, "post_id": 58698097, "comment_id": 103701822, "body": "You can also merge those queries into one, something like this: <code>user.change_requests.where(&quot;action_at  = ? and cancelled_at is not null&quot;,  req.action_at)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 841, "user_id": 12294425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxWNY.jpg?s=128&g=1", "display_name": "calebkm", "link": "https://stackoverflow.com/users/12294425/calebkm"}, "is_accepted": true, "score": 4, "last_activity_date": 1572889113, "creation_date": 1572889113, "answer_id": 58698522, "question_id": 58698097, "link": "https://stackoverflow.com/questions/58698097/chained-ruby-on-rails-query-to-return-those-that-are-not-nil/58698522#58698522", "title": "Chained ruby on rails query to return those that are not nil", "body": "<p>Max had the correct answer above in the comments. You can use the ActiveRecord <code>where.not</code> syntax when writing sql <code>NOT</code>.</p>\n\n<p>From the <a href=\"https://guides.rubyonrails.org/active_record_querying.html#not-conditions\" rel=\"nofollow noreferrer\">ActiveRecord docs</a>:</p>\n\n<blockquote>\n  <p><strong>2.4 NOT Conditions</strong></p>\n  \n  <p>NOT SQL queries can be built by <code>where.not</code>:</p>\n  \n  <p><code>Client.where.not(locked: true)</code></p>\n  \n  <p>In other words, this query can be\n  generated by calling where with no argument, then immediately chain\n  with not passing where conditions. This will generate SQL like this:</p>\n  \n  <p><code>SELECT * FROM clients WHERE (clients.locked != 1)</code></p>\n</blockquote>\n\n<p>For your specific case, the code would look like:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>user.change_requests.where(action_at: req.action_at).where.not(cancelled_at: nil)\n</code></pre>\n"}], "owner": {"reputation": 725, "user_id": 9774506, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Falko", "link": "https://stackoverflow.com/users/9774506/falko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 58698522, "answer_count": 1, "score": 1, "last_activity_date": 1572922695, "creation_date": 1572887324, "last_edit_date": 1572922695, "question_id": 58698097, "link": "https://stackoverflow.com/questions/58698097/chained-ruby-on-rails-query-to-return-those-that-are-not-nil", "title": "Chained ruby on rails query to return those that are not nil", "body": "<p>I am querying Active Record and want to chain two queries together.</p>\n\n<p>My issue is that when I want to return those with an attribute that is not nil it doesn't return any records that I know exist:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>user.change_requests.where(\"action_at = ?\", req.action_at).where(\"cancelled_at != ?\", nil)\n</code></pre>\n\n<p>This basically returns an empty array but I'm expecting an array of <code>change_requests</code></p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": true, "score": 2, "last_activity_date": 1572888304, "last_edit_date": 1592644375, "creation_date": 1572887230, "answer_id": 58698076, "question_id": 58697454, "link": "https://stackoverflow.com/questions/58697454/inconsistent-wrapping-of-quotes-in-to-yaml/58698076#58698076", "title": "Inconsistent wrapping of quotes in to_yaml", "body": "<ul>\n<li>Column 1, section 2, text contains a trailing space.</li>\n<li>Column 2, section 8, text contains a <code>:</code> character followed by a space.</li>\n</ul>\n<p>The <a href=\"https://yaml.org/spec/1.2/spec.html#id2788859\" rel=\"nofollow noreferrer\">specification</a> says:</p>\n<blockquote>\n<p>The <em>plain</em> (unquoted) style has no identifying indicators and provides no form of escaping. It is therefore the most readable, most limited and most context sensitive style. <strong>In addition to a restricted character set, a plain scalar must not be empty, or contain leading or trailing white space characters.</strong> It is only possible to break a long plain line where a space character is surrounded by non-spaces.</p>\n<p>...</p>\n<p><strong>Plain scalars must never contain the \u201c: \u201d and \u201c #\u201d character combinations.</strong> Such combinations would cause ambiguity with mapping key: value pairs and comments. In addition, inside flow collections, or when used as implicit keys, plain scalars must not contain the \u201c[\u201d, \u201c]\u201d, \u201c{\u201d, \u201c}\u201d and \u201c,\u201d characters. These characters would cause ambiguity with flow collection structures.</p>\n</blockquote>\n"}], "owner": {"reputation": 385, "user_id": 8940624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14f8387f03a69862ece3b0b352f46ab3?s=128&d=identicon&r=PG&f=1", "display_name": "Chris A", "link": "https://stackoverflow.com/users/8940624/chris-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 58698076, "answer_count": 1, "score": 0, "last_activity_date": 1572888304, "creation_date": 1572884843, "last_edit_date": 1592644375, "question_id": 58697454, "link": "https://stackoverflow.com/questions/58697454/inconsistent-wrapping-of-quotes-in-to-yaml", "title": "Inconsistent wrapping of quotes in to_yaml", "body": "<h2>Introduction</h2>\n<p>In the below example, you can see that the header and sections 1 and 11 have been put in as plain values into the yaml, but sections 2 and 8 have been wrapped in single quotes. This seems to be happening at the <code>to_yaml</code> stage because in the hash everything looks ok. (I'm not simply loading a yaml and converting it back, this is just for the sake of a simplified example)</p>\n<h2>What I've tried</h2>\n<p>I've tried seeing if there are any special characters which would cause confusion, but without any luck. For example, on the word <code>vehicle\u2019s</code> there is a curled apostrophe rather than a straight one <code>'</code>, but that is found in all sections. <code>isn't</code> in section 2 has the straight apostrophe. I tried adding/removing each type of apostrophe systematically in different sections to see if that would make any difference but it hasn't</p>\n<h3>foo.yml</h3>\n<pre class=\"lang-xml prettyprint-override\"><code>en:\n  contract:\n    terms_and_conditions:\n      FF:\n        company: Foo Foo SA\n        spain_checkin_company: Foo Foo Spain SLR\n        title: Rental Agreement\n        header: &quot;This Rental Agreement regulates the rental conditions between Foo Foo, hereinafter referred to as the Rental\n                Firm, and the client, identified by a valid driving license, hereinafter referred to as the Hirer, and it is ruled by all the\n                general and special conditions described in this agreement, unless there is any written derogation or alteration.&quot;\n        column_1:\n          section_1:\n            title: 1. Vehicle conditions\n            text: &quot;1) The customer acknowledges having received the Vehicle and rented extras in a clean condition and with all the features working. 2) The customer will return the vehicle in a clean condition, with the same amount of fuel at the pick-up, and with all the vehicle\u2019s features operating in a normal way, on the return date, time and location established in the Rental Agreement. Failure to meet these criteria will result in additional charges to the Hirer according to the rental firm price table. Any loss or damage in rented extras, equipment or spare parts, will be fully charged to the Hirer according to the Rental Firm price table.&quot;\n          section_2:\n            title: 2. Documents\n            text: &quot;A valid vehicle driver\u2019s license, ID or Passport and credit card (Visa or Mastercard) are required and must be presented upon the vehicle\u2019s collection and signing of the rental agreement. If the Hirer does not bring the necessary documents, the vehicle cannot be rented and regular no show fee will apply. 2) To hold a valid license to drive in Europe is the responsibility of the Hirer 3) The Hirer should be older than 18 years old. 4) If the Hirer is under 25 years of age, purchasing the Standard Insurance plan is mandatory, and he/she isn't allowed to purchase the Basic or Full Insurance plan when renting a vehicle.\n 5) The credit card owner must be present at the vehicle\u00b4s collection.\n  &quot;\n        column_2:\n          section_8:\n            title: 8. Accident / Vehicle Damage\n            text: &quot;In the event of an accident or vehicle damage, the Hirer agrees to the following procedures: 1) Immediately notify the Rental Firm and police authorities of any accident, theft, robbery or other misfortune. 2) Take pictures and obtain names and addresses of all persons involved as well as witnesses, that can document what happened 3) Fill the accident report, together with other vehicles that may be involved. 4) Shall not leave the vehicle without taking all measures regarding its protection and . 5) Shall not take any responsibility or pled guilty, in the event of an accident that might hold the Rental Firm liable 6) Collect the accident report signed by all parties involved and the documents prepared by the police authorities, along with the vehicle keys, if retained (in case of vehicle theft) and send it immediately to the Rental firm. Otherwise, all insurances and coverage\u2019s will expire, and the Hirer is liable for all expenses.&quot;\n          section_11:\n            title: 11. Liability / Security Deposit and After Rental Payments\n            text: &quot;1) The security deposit can only be paid by credit card (Visa or Mastercard), and the credit card owner must be present at the pick-up. At the vehicle delivery, the Hirer is required to pay the security deposit according to the chosen Insurance option. This amount will be held in the Hirer\u2019s credit card to ensure the excess payment in the event of robbery or accident and any other vehicle damage during the rental period. 2) If the security deposit amount is not authorized by the bank or by the credit card owner, the contract cannot be executed and the vehicle cannot be delivered. In this case, the regular cancelation policy will apply and the full booking amount will be charged to the Hirer. The security deposit will be returned to the Hirer at the end of the rental period, after an inspection by a Rental Firm member staff, who shall state the vehicle is in similar conditions compared to when it was collected. 3) Vehicle damage and equipment/extras damage costs will be charged according to the Rental Firm price table. The Hirer will also be liable for the days not rented during the vehicle reasonable repair time, according to the damages at issue. 4) In case of an accident where the Hirer does not consider himself responsible, the Rental Firm will hold the full amount of the security deposit until the insurance company states the responsibility. 5) If the damage repair costs cannot be determined immediately, the Rental Firm will hold the full amount of the security deposit. A portion of the excess can be refunded in case the final damage repair costs are lower than the amount paid. 6) The Hirer agrees that the Rental Firm is authorized to charge the credit card on file for any further amounts that may arise such as wild camping, parking tickets, fines, traffic offence penalties, tolls, damages to the van (interior or exterior) and overdue amounts. Rental Firm is entitled to verify any of the damages to the van for 30 days after the last day of the rental agreement. In the event of a fine, the Rental Firm will always attempt to forward the fine to the Hirer. On these cases, a 25\u20ac administrative fee will be charged by the Rental Firm. In the event that it is not possible to forward the fine to the Hirer, the Rental Firm will process the fine and charge to the Hirer the total cost of the fine plus VAT and an added administrative fee of 50\u20ac. 7) Hirer must provide the Rental Firm with an alternative credit card that can be used to meet Hirer\u2019s obligations under the Rental Firm Terms and Conditions, in case of insufficient funds, declined transactions for any reason, and cancelled or suspended credit card. 8) All unpaid invoices will be added interest, which is the highest legal rate plus a flat fee, corresponding to 20% of the unpaid amount and any compensation for occurred damages / lost profits due by law. In the event of a legal dispute somehow related with this contract, the parties agree that the jurisdiction of the pick-up location will be applied.&quot;\n</code></pre>\n<h3>hash in Ruby</h3>\n<p><code>foo = YAML.load(File.read(&quot;#{@PATH}foo.yml&quot;))</code></p>\n<pre><code>=&gt; {&quot;en&quot;=&gt;\n  {&quot;contract&quot;=&gt;\n    {&quot;terms_and_conditions&quot;=&gt;\n      {&quot;FF&quot;=&gt;\n        {&quot;company&quot;=&gt;&quot;Foo Foo SA&quot;,\n         &quot;spain_checkin_company&quot;=&gt;&quot;Foo Foo Spain SLR&quot;,\n         &quot;title&quot;=&gt;&quot;Rental Agreement&quot;,\n         &quot;header&quot;=&gt;\n          &quot;This Rental Agreement regulates the rental conditions between Foo Foo, hereinafter referred to as the Rental Firm, and the client, identified by a valid driving license, hereinafter referred to as the Hirer, and it is ruled by all the general and special conditions described in this agreement, unless there is any written derogation or alteration.&quot;,\n         &quot;column_1&quot;=&gt;\n          {&quot;section_1&quot;=&gt;\n            {&quot;title&quot;=&gt;&quot;1. Vehicle conditions&quot;,\n             &quot;text&quot;=&gt;\n              &quot;1) The customer acknowledges having received the Vehicle and rented extras in a clean condition and with all the features working. 2) The customer will return the vehicle in a clean condition, with the same amount of fuel at the pick-up, and with all the vehicle\u2019s features operating in a normal way, on the return date, time and location established in the Rental Agreement. Failure to meet these criteria will result in additional charges to the Hirer according to the rental firm price table. Any loss or damage in rented extras, equipment or spare parts, will be fully charged to the Hirer according to the Rental Firm price table.&quot;},\n           &quot;section_2&quot;=&gt;\n            {&quot;title&quot;=&gt;&quot;2. Documents&quot;,\n             &quot;text&quot;=&gt;\n              &quot;A valid vehicle driver\u2019s license, ID or Passport and credit card (Visa or Mastercard) are required and must be presented upon the vehicle\u2019s collection and signing of the rental agreement. If the Hirer does not bring the necessary documents, the vehicle cannot be rented and regular no show fee will apply. 2) To hold a valid license to drive in Europe is the responsibility of the Hirer 3) The Hirer should be older than 18 years old. 4) If the Hirer is under 25 years of age, purchasing the Standard Insurance plan is mandatory, and he/she isn't allowed to purchase the Basic or Full Insurance plan when renting a vehicle. 5) The credit card owner must be present at the vehicle\u00b4s collection. &quot;}},\n         &quot;column_2&quot;=&gt;\n          {&quot;section_8&quot;=&gt;\n            {&quot;title&quot;=&gt;&quot;8. Accident / Vehicle Damage&quot;,\n             &quot;text&quot;=&gt;\n              &quot;In the event of an accident or vehicle damage, the Hirer agrees to the following procedures: 1) Immediately notify the Rental Firm and police authorities of any accident, theft, robbery or other misfortune. 2) Take pictures and obtain names and addresses of all persons involved as well as witnesses, that can document what happened 3) Fill the accident report, together with other vehicles that may be involved. 4) Shall not leave the vehicle without taking all measures regarding its protection and . 5) Shall not take any responsibility or pled guilty, in the event of an accident that might hold the Rental Firm liable 6) Collect the accident report signed by all parties involved and the documents prepared by the police authorities, along with the vehicle keys, if retained (in case of vehicle theft) and send it immediately to the Rental firm. Otherwise, all insurances and coverage\u2019s will expire, and the Hirer is liable for all expenses.&quot;},\n           &quot;section_11&quot;=&gt;\n            {&quot;title&quot;=&gt;&quot;11. Liability / Security Deposit and After Rental Payments&quot;,\n             &quot;text&quot;=&gt;\n              &quot;1) The security deposit can only be paid by credit card (Visa or Mastercard), and the credit card owner must be present at the pick-up. At the vehicle delivery, the Hirer is required to pay the security deposit according to the chosen Insurance option. This amount will be held in the Hirer\u2019s credit card to ensure the excess payment in the event of robbery or accident and any other vehicle damage during the rental period. 2) If the security deposit amount is not authorized by the bank or by the credit card owner, the contract cannot be executed and the vehicle cannot be delivered. In this case, the regular cancelation policy will apply and the full booking amount will be charged to the Hirer. The security deposit will be returned to the Hirer at the end of the rental period, after an inspection by a Rental Firm member staff, who shall state the vehicle is in similar conditions compared to when it was collected. 3) Vehicle damage and equipment/extras damage costs will be charged according to the Rental Firm price table. The Hirer will also be liable for the days not rented during the vehicle reasonable repair time, according to the damages at issue. 4) In case of an accident where the Hirer does not consider himself responsible, the Rental Firm will hold the full amount of the security deposit until the insurance company states the responsibility. 5) If the damage repair costs cannot be determined immediately, the Rental Firm will hold the full amount of the security deposit. A portion of the excess can be refunded in case the final damage repair costs are lower than the amount paid. 6) The Hirer agrees that the Rental Firm is authorized to charge the credit card on file for any further amounts that may arise such as wild camping, parking tickets, fines, traffic offence penalties, tolls, damages to the van (interior or exterior) and overdue amounts. Rental Firm is entitled to verify any of the damages to the van for 30 days after the last day of the rental agreement. In the event of a fine, the Rental Firm will always attempt to forward the fine to the Hirer. On these cases, a 25\u20ac administrative fee will be charged by the Rental Firm. In the event that it is not possible to forward the fine to the Hirer, the Rental Firm will process the fine and charge to the Hirer the total cost of the fine plus VAT and an added administrative fee of 50\u20ac. 7) Hirer must provide the Rental Firm with an alternative credit card that can be used to meet Hirer\u2019s obligations under the Rental Firm Terms and Conditions, in case of insufficient funds, declined transactions for any reason, and cancelled or suspended credit card. 8) All unpaid invoices will be added interest, which is the highest legal rate plus a flat fee, corresponding to 20% of the unpaid amount and any compensation for occurred damages / lost profits due by law. In the event of a legal dispute somehow related with this contract, the parties agree that the jurisdiction of the pick-up location will be applied.&quot;}}}}}}}\n\n</code></pre>\n<h3>Outputted yaml file</h3>\n<pre><code>File.open(&quot;#{@PATH}foo.yml&quot;, &quot;w&quot;) do |f|\n              YAML.dump(foo,f)\n            end\n</code></pre>\n<p>(also used <code>f.puts foo.to_yaml</code>) with the same result</p>\n<pre class=\"lang-xml prettyprint-override\"><code>en:\n  contract:\n    terms_and_conditions:\n      FF:\n        company: Foo Foo SA\n        spain_checkin_company: Foo Foo Spain SLR\n        title: Rental Agreement\n        header: This Rental Agreement regulates the rental conditions between Foo\n          Foo, hereinafter referred to as the Rental Firm, and the client, identified\n          by a valid driving license, hereinafter referred to as the Hirer, and it\n          is ruled by all the general and special conditions described in this agreement,\n          unless there is any written derogation or alteration.\n        column_1:\n          section_1:\n            title: 1. Vehicle conditions\n            text: 1) The customer acknowledges having received the Vehicle and rented\n              extras in a clean condition and with all the features working. 2) The\n              customer will return the vehicle in a clean condition, with the same\n              amount of fuel at the pick-up, and with all the vehicle\u2019s features operating\n              in a normal way, on the return date, time and location established in\n              the Rental Agreement. Failure to meet these criteria will result in\n              additional charges to the Hirer according to the rental firm price table.\n              Any loss or damage in rented extras, equipment or spare parts, will\n              be fully charged to the Hirer according to the Rental Firm price table.\n          section_2:\n            title: 2. Documents\n            text: 'A valid vehicle driver\u2019s license, ID or Passport and credit card\n              (Visa or Mastercard) are required and must be presented upon the vehicle\u2019s\n              collection and signing of the rental agreement. If the Hirer does not\n              bring the necessary documents, the vehicle cannot be rented and regular\n              no show fee will apply. 2) To hold a valid license to drive in Europe\n              is the responsibility of the Hirer 3) The Hirer should be older than\n              18 years old. 4) If the Hirer is under 25 years of age, purchasing the\n              Standard Insurance plan is mandatory, and he/she isn''t allowed to purchase\n              the Basic or Full Insurance plan when renting a vehicle. 5) The credit\n              card owner must be present at the vehicle\u00b4s collection. '\n        column_2:\n          section_8:\n            title: 8. Accident / Vehicle Damage\n            text: 'In the event of an accident or vehicle damage, the Hirer agrees\n              to the following procedures: 1) Immediately notify the Rental Firm and\n              police authorities of any accident, theft, robbery or other misfortune.\n              2) Take pictures and obtain names and addresses of all persons involved\n              as well as witnesses, that can document what happened 3) Fill the accident\n              report, together with other vehicles that may be involved. 4) Shall\n              not leave the vehicle without taking all measures regarding its protection\n              and . 5) Shall not take any responsibility or pled guilty, in the event\n              of an accident that might hold the Rental Firm liable 6) Collect the\n              accident report signed by all parties involved and the documents prepared\n              by the police authorities, along with the vehicle keys, if retained\n              (in case of vehicle theft) and send it immediately to the Rental firm.\n              Otherwise, all insurances and coverage\u2019s will expire, and the Hirer\n              is liable for all expenses.'\n          section_11:\n            title: 11. Liability / Security Deposit and After Rental Payments\n            text: 1) The security deposit can only be paid by credit card (Visa or\n              Mastercard), and the credit card owner must be present at the pick-up.\n              At the vehicle delivery, the Hirer is required to pay the security deposit\n              according to the chosen Insurance option. This amount will be held in\n              the Hirer\u2019s credit card to ensure the excess payment in the event of\n              robbery or accident and any other vehicle damage during the rental period.\n              2) If the security deposit amount is not authorized by the bank or by\n              the credit card owner, the contract cannot be executed and the vehicle\n              cannot be delivered. In this case, the regular cancelation policy will\n              apply and the full booking amount will be charged to the Hirer. The\n              security deposit will be returned to the Hirer at the end of the rental\n              period, after an inspection by a Rental Firm member staff, who shall\n              state the vehicle is in similar conditions compared to when it was collected.\n              3) Vehicle damage and equipment/extras damage costs will be charged\n              according to the Rental Firm price table. The Hirer will also be liable\n              for the days not rented during the vehicle reasonable repair time, according\n              to the damages at issue. 4) In case of an accident where the Hirer does\n              not consider himself responsible, the Rental Firm will hold the full\n              amount of the security deposit until the insurance company states the\n              responsibility. 5) If the damage repair costs cannot be determined immediately,\n              the Rental Firm will hold the full amount of the security deposit. A\n              portion of the excess can be refunded in case the final damage repair\n              costs are lower than the amount paid. 6) The Hirer agrees that the Rental\n              Firm is authorized to charge the credit card on file for any further\n              amounts that may arise such as wild camping, parking tickets, fines,\n              traffic offence penalties, tolls, damages to the van (interior or exterior)\n              and overdue amounts. Rental Firm is entitled to verify any of the damages\n              to the van for 30 days after the last day of the rental agreement. In\n              the event of a fine, the Rental Firm will always attempt to forward\n              the fine to the Hirer. On these cases, a 25\u20ac administrative fee will\n              be charged by the Rental Firm. In the event that it is not possible\n              to forward the fine to the Hirer, the Rental Firm will process the fine\n              and charge to the Hirer the total cost of the fine plus VAT and an added\n              administrative fee of 50\u20ac. 7) Hirer must provide the Rental Firm with\n              an alternative credit card that can be used to meet Hirer\u2019s obligations\n              under the Rental Firm Terms and Conditions, in case of insufficient\n              funds, declined transactions for any reason, and cancelled or suspended\n              credit card. 8) All unpaid invoices will be added interest, which is\n              the highest legal rate plus a flat fee, corresponding to 20% of the\n              unpaid amount and any compensation for occurred damages / lost profits\n              due by law. In the event of a legal dispute somehow related with this\n              contract, the parties agree that the jurisdiction of the pick-up location\n              will be applied.\n</code></pre>\n"}, {"tags": ["ruby", "rspec", "factory-bot"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1572879988, "post_id": 58695767, "comment_id": 103688647, "body": "Its pretty unclear here what behavior this spec is actually trying to test but if you want to test that a method is called multiple times you would   use receive counts <code>expect(described_class).to receive(:gets).exactly(n).times</code>. <a href=\"https://relishapp.com/rspec/rspec-mocks/v/2-8/docs/message-expectations/receive-counts\" rel=\"nofollow noreferrer\">relishapp.com/rspec/rspec-mocks/v/2-8/docs/message-expectati&zwnj;&#8203;ons/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 350, "user_id": 9498724, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zelZl.jpg?s=128&g=1", "display_name": "Ruslan Valeev", "link": "https://stackoverflow.com/users/9498724/ruslan-valeev"}, "edited": false, "score": 0, "creation_date": 1572919218, "post_id": 58695857, "comment_id": 103702502, "body": "\ud83e\uddd0   ` (byebug) defined?(counter) &quot;local-variable&quot; (byebug) defined?(mocked_retry_count) &quot;method&quot; (byebug) counter nil (byebug) mocked_retry_count 5  `"}, {"owner": {"reputation": 350, "user_id": 9498724, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zelZl.jpg?s=128&g=1", "display_name": "Ruslan Valeev", "link": "https://stackoverflow.com/users/9498724/ruslan-valeev"}, "edited": false, "score": 0, "creation_date": 1572919574, "post_id": 58695857, "comment_id": 103702578, "body": "Yes, you&#39;re right, <code>counter</code> here is a <code>local variable</code> (but I still don&#39;t understand, why its <code>nil</code>) and <code>mocked_retry_count</code> is a <code>method</code>, and if I will rename <code>counter</code> to <code>counter_i</code>, its working as expected (because it became a <code>method</code>). I will read the link you shared, thank you so much, anyway!"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 7, "last_activity_date": 1572879534, "last_edit_date": 1572879534, "creation_date": 1572879113, "answer_id": 58695857, "question_id": 58695767, "link": "https://stackoverflow.com/questions/58695767/why-letcounter-0-returns-nil-in-example/58695857#58695857", "title": "Why let(:counter) { 0 } returns nil in example?", "body": "<blockquote>\n  <p>Why <code>let(:counter) { 0 }</code> returns nil in example?</p>\n</blockquote>\n\n<p>No, it doesn't. <code>counter</code> is not what you think it is. Try evaluating/printing <code>defined?(counter)</code> and <code>defined?(mocked_retry_count)</code>.</p>\n\n<blockquote>\n  <p>What is the principal difference between 'counter' and 'mocked_retry_count' ?</p>\n</blockquote>\n\n<p>You do not assign to <code>mocked_retry_count</code>. Remember, <code>let</code> creates methods. So when you attempt to assign to <code>counter</code>, you're creating a local variable <code>counter</code> which shadows your method <code>counter</code> (and has default value of <code>nil</code>).</p>\n\n<p>This post explains in more detail: <a href=\"https://stackoverflow.com/questions/8908050/why-is-a-a-nil-in-ruby\">Why is `a = a` `nil` in Ruby?</a></p>\n"}], "owner": {"reputation": 350, "user_id": 9498724, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zelZl.jpg?s=128&g=1", "display_name": "Ruslan Valeev", "link": "https://stackoverflow.com/users/9498724/ruslan-valeev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 58695857, "answer_count": 1, "score": 1, "last_activity_date": 1572879534, "creation_date": 1572878790, "question_id": 58695767, "link": "https://stackoverflow.com/questions/58695767/why-letcounter-0-returns-nil-in-example", "title": "Why let(:counter) { 0 } returns nil in example?", "body": "<p>Have two variables in Rspec, both of them are integers, but in example (in 'before' block) one of them is appropriate own value, another one is nil. Why?! Never heard about such a strange rspec behavior.</p>\n\n<p>tried change 0 value to 1,\ntried change the variable name,\ntried change 'let' to 'let!',\nbut behavior didn't change.</p>\n\n<p>The code is:</p>\n\n<pre><code>context 'when input contains incorrect symbols' do\n      let(:counter) { 1 }\n      let(:mocked_retry_count) { 5 }\n      before do\n        allow(described_class).to receive(:gets) {\n          byebug\n          counter += 1\n          counter &gt; mocked_retry_count ? 'Stop the loop' : ['$', (0..9).to_a.sample, '#', '%', '&amp;'].sample\n        }\n        described_class.ask_kingdoms\n      end\n    end\n</code></pre>\n\n<p>In byebug's output I see that</p>\n\n<pre><code>   62:       let(:counter) { 1 }\n   63:       let(:mocked_retry_count) { 5 }\n   64:       before do\n   65:         allow(described_class).to receive(:gets) {\n   66:           byebug\n=&gt; 67:           counter += 1\n   68:           counter &gt; mocked_retry_count ? 'Stop the loop' : ['$', (0..9).to_a.sample, '#', '%', '&amp;'].sample\n   69:         }\n   70:         described_class.ask_kingdoms\n   71:       end\n(byebug) counter\nnil\n(byebug) mocked_retry_count\n5\n</code></pre>\n\n<p>What is the principal difference between 'counter' and 'mocked_retry_count' ? And how can I get my counter in example?</p>\n"}, {"tags": ["ruby", "loops"], "comments": [{"owner": {"reputation": 8081, "user_id": 746882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65377dfe5545065f755e7cf9d026a844?s=128&d=identicon&r=PG", "display_name": "Frost", "link": "https://stackoverflow.com/users/746882/frost"}, "edited": false, "score": 3, "creation_date": 1572876695, "post_id": 58695085, "comment_id": 103686874, "body": "Is the assignment of <code>something = foo</code> on purpose, or is that supposed to be a comparison (<code>something == foo</code>)?"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 1, "creation_date": 1572876758, "post_id": 58695085, "comment_id": 103686909, "body": "<i>This works well</i> ? how? Your working code is also missing <code>do</code> keyword."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1572900085, "post_id": 58695085, "comment_id": 103697470, "body": "Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>. Your code has to be syntactically correct before we can help you."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1572888077, "post_id": 58695165, "comment_id": 103692807, "body": "As a bonus you can omit the <code>range =</code> part and just chain off the <code>end</code> of the <code>if</code>."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 2, "last_activity_date": 1572877179, "last_edit_date": 1572877179, "creation_date": 1572876620, "answer_id": 58695165, "question_id": 58695085, "link": "https://stackoverflow.com/questions/58695085/ruby-use-variable-as-range-in-step-loop/58695165#58695165", "title": "Ruby: Use variable as range in step loop", "body": "<p>Do not wrap range definition in quotes. In quotes, you defines strings, not ranges. Instead write:</p>\n\n<pre><code>if something == foo\n  range = 10..30\nelse\n  range = 40..60\nend\nrange.step(10) do |i|\n   #do something\nend\n</code></pre>\n\n<p>(also fixed some other minor issues with this snippet).</p>\n"}], "owner": {"reputation": 377, "user_id": 7130244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf5ca9a6a57077a5a428b64a7a89447?s=128&d=identicon&r=PG&f=1", "display_name": "Nakrule", "link": "https://stackoverflow.com/users/7130244/nakrule"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 58695165, "answer_count": 1, "score": -2, "last_activity_date": 1572900040, "creation_date": 1572876322, "last_edit_date": 1572900040, "question_id": 58695085, "link": "https://stackoverflow.com/questions/58695085/ruby-use-variable-as-range-in-step-loop", "title": "Ruby: Use variable as range in step loop", "body": "<p>I have the following loop:</p>\n\n<pre><code>(10..30).step(10) do |i|\n   #do something\nEND\n</code></pre>\n\n<p>This works well, but I would like to use a variable to define the <code>10..30</code> range to have something like this:</p>\n\n<pre><code>if something == foo\n  range = '10..30'\nelse\n  range = '40..60'\nend\n(range).step(10) do |i|\n   #do something\nEND\n</code></pre>\n\n<p>However, this code does not run. What is the proper way to do it?</p>\n"}, {"tags": ["ruby", "bundle", "bundler", "middleman"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1572895190, "post_id": 58694638, "comment_id": 103695650, "body": "Include the output from <code>gem install middleman</code> and <code>which middleman</code>. Also see <a href=\"https://stackoverflow.com/q/3958092/3784008\">this question</a> and apply the fixes from the answers first."}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 11802732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa23eb753e3ad0ac8db0e6815e6424be?s=128&d=identicon&r=PG&f=1", "display_name": "Amarantha", "link": "https://stackoverflow.com/users/11802732/amarantha"}, "is_accepted": false, "score": 0, "last_activity_date": 1572991892, "creation_date": 1572991892, "answer_id": 58720256, "question_id": 58694638, "link": "https://stackoverflow.com/questions/58694638/middleman-command-not-found-bundler-not-working/58720256#58720256", "title": "Middleman command not found/ Bundler not working", "body": "<p><code>which ruby</code> gives me <code>/snap/bin/ruby</code> and my path variable is <code>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/usr/share/rvm/bin</code>. The problem is that ruby is in the snap folder.<br>\nI just uninstalled the ruby snap (and snaps in general) and installed \"normal\" Ruby, which had the correct path (<code>usr/bin/ruby</code>). The middleman installation then worked fine.</p>\n"}], "owner": {"reputation": 3, "user_id": 11802732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa23eb753e3ad0ac8db0e6815e6424be?s=128&d=identicon&r=PG&f=1", "display_name": "Amarantha", "link": "https://stackoverflow.com/users/11802732/amarantha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 212, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572991892, "creation_date": 1572874847, "question_id": 58694638, "link": "https://stackoverflow.com/questions/58694638/middleman-command-not-found-bundler-not-working", "title": "Middleman command not found/ Bundler not working", "body": "<p>I'm trying to install middleman. I installed the gem and can see it in my gem list. However, if I enter <code>middleman -v</code> I get the message <code>middleman: command not found</code>. </p>\n\n<p>I tried installing bundler to run middleman with a Gemfile in the project directory using <code>bundle exec middleman</code>. But when I try to run bundle I get the following error:\n<code>bash: /usr/bin/bundle: /usr/bin/ruby: bad interpreter: No such file or directory</code>  </p>\n\n<p>I'm running ruby v. 2.6 and installed middleman v.4.3.5 on Ubuntu 18.04.</p>\n\n<p>Any help would be very much appreciated; I've wasted half a day trying to solve this and I'm still on high waters!</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 1, "creation_date": 1572875501, "post_id": 58694609, "comment_id": 103686287, "body": "As written in my answer, please edit your question and include the full code of your <code>lib&#47;lexer&#47;lexer.rb</code> file which you are referring to in your question. Only with this knowledge, it is possible to answer your question. With just the link to your repo, your question will be not helpful for future readers in about a week."}, {"owner": {"reputation": 659, "user_id": 6845084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253b377ee6c971f363de927136d30117?s=128&d=identicon&r=PG", "display_name": "Palash Nigam", "link": "https://stackoverflow.com/users/6845084/palash-nigam"}, "reply_to_user": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1573027866, "post_id": 58694609, "comment_id": 103742758, "body": "@HolgerJust  updated the post thanks for your answer, it is skipping whitespace properly now but it still skips over semicolons instead of returning a token for it  Anyway thanks for your help."}], "answers": [{"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1572880616, "post_id": 58694799, "comment_id": 103688979, "body": "I would define a constant containing the characters <code>WHITESPACE_CARACTERS = [&quot; &quot;, &quot;\\t&quot;, &quot;\\n&quot;, &quot;\\r&quot;].freeze</code> and then use <code>WHITESPACE_CARACTERS.include?(@ch)</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1572890373, "post_id": 58694799, "comment_id": 103693887, "body": "...or <code>while @ch.match? &#47;\\s&#47;</code>, which is equivalent to <code>while @ch.match? &#47;[ \\t\\r\\n\\f\\v]&#47;</code>. This assumes <code>@ch</code> is known to be a single character; else while <code>@ch.match? &#47;\\A\\s\\z&#47;</code>. Note <code>\\v</code> is \u201cvertical tab\u201d and <code>\\f</code> is \u201cform feed\u201d. The inclusion of the latter whitespace character is important for applications that involve <a href=\"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSPPF0WWCmoCeK1fZVnjAIWDbKFsXaRuE9yzntjosLOdUB0yVdc&amp;s\" rel=\"nofollow noreferrer\">teletype machines</a>."}], "tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": true, "score": 2, "last_activity_date": 1572875391, "creation_date": 1572875391, "answer_id": 58694799, "question_id": 58694609, "link": "https://stackoverflow.com/questions/58694609/writing-an-iterpreter-in-ruby-not-able-to-consume-whitespace-properly/58694799#58694799", "title": "Writing an iterpreter in Ruby, not able to consume whitespace properly", "body": "<p>In your Lexer code (which you should include in your original question), you have the following method:</p>\n\n<pre><code>def consume_whitespace\n  while @ch == ' ' || @ch =='\\t' || @ch == '\\n' || @ch == '\\r' do\n    read_char\n  end\nend\n</code></pre>\n\n<p>Here, you attempt to specify various whitespace characters. However, since you have named them with single quotes, the escape sequences with the backslash are not applied. Instead, you consume a literal backslash followed by an <code>t</code>, <code>n</code>, or <code>r</code> character.</p>\n\n<p>If you use double quotes here, the characters in your source code are interpreted as tab, newline, or carriage return characters respectively:</p>\n\n<pre><code>def consume_whitespace\n  while @ch == ' ' || @ch == \"\\t\" || @ch == \"\\n\" || @ch == \"\\r\" do\n    read_char\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 659, "user_id": 6845084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/253b377ee6c971f363de927136d30117?s=128&d=identicon&r=PG", "display_name": "Palash Nigam", "link": "https://stackoverflow.com/users/6845084/palash-nigam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 58694799, "answer_count": 1, "score": 0, "last_activity_date": 1573027721, "creation_date": 1572874708, "last_edit_date": 1573027721, "question_id": 58694609, "link": "https://stackoverflow.com/questions/58694609/writing-an-iterpreter-in-ruby-not-able-to-consume-whitespace-properly", "title": "Writing an iterpreter in Ruby, not able to consume whitespace properly", "body": "<p>So I am following the \"Writing an interpreter book\" and implementing it in Ruby instead of Go. I am able to scan tokens like <code>;</code> <code>=</code>, <code>+</code>, etc but it seems to behave differently when I have identifiers like <code>let</code>, <code>10</code>, etc in my input string. Tried to hunt this bug this whole week but in vain so I thought a fresh pair of eyes might be able to catch it.</p>\n\n<p>Here is an overview. </p>\n\n<ul>\n<li><p>The codebase is very small and most of the logic resides in <code>lib/lexer/lexer.rb</code></p></li>\n<li><p>The class <code>Lexer</code> maintains the following state a cursor for the current character in the input string, a cursor for the next character and the current character in the input string</p></li>\n<li><p><code>Lexer</code> has the following methods</p>\n\n<ul>\n<li><p><code>read_char</code> which sets the data members to appropriate values</p></li>\n<li><p><code>read_indentifier</code> which is used to extract all the characters belonging to strings that are not reserved keywords but identifiers and call <code>read_char</code> before returning</p></li>\n<li><p><code>read_number</code> same as <code>read_identifier</code> but for numbers</p></li>\n<li><p><code>consume_whitespace</code> to skip over spaces, newlines, etc</p></li>\n<li><p><code>next_token</code> used to match the current character with the appropriate case and return its <code>Token</code> object defined in <code>lib/token/token.rb</code> and call <code>read_char</code> to increment the cursors before returning</p></li>\n</ul></li>\n</ul>\n\n<pre><code>require_relative '../token/token'\n\ndef is_letter(ch) #basically decides syntax acceptable for variable names\n  #puts ch.class\n  'a' &lt;= ch &amp;&amp; ch &lt;= 'z' || 'A' &lt;= ch &amp;&amp; ch &lt;= 'Z' || ch == '_'\nend\n\ndef is_digit(ch) #checks if digit\n  '0' &lt;= ch &amp;&amp; ch &lt;= '9'\nend\n\nclass Lexer\n\n  def initialize(input)\n    @input = input\n    @position = 0\n    @readPosition = 0\n    @ch =''\n    read_char\n  end\n\n  def read_char\n    #puts caller[0]\n    @ch = @readPosition &gt;= @input.length ? '' : @input[@readPosition]\n    @position = @readPosition\n    @readPosition += 1\n    #puts \"INSIDE READ_CHAR  #{@position} #{@readPosition} #{@ch}\"\n  end\n\n\n\n  # SUPPOSED TO BE A LOOP WAS JUST A CONDITION. NOW FIXED.\n  def consume_whitespace\n    while @ch == ' ' || @ch =='\\t' || @ch == '\\n' || @ch == '\\r' do\n      read_char\n    end\n  end\n\n  def read_identifier\n    pos = @position\n    #puts \"RI: char #{@ch}  pos #{pos} position #{@position}\"\n    while is_letter(@ch) do\n      #puts @ch\n      read_char\n    end\n    puts \"METHOD read_identifier: char #{@ch}  pos #{pos} position #{@position}\\n\"\n    @input[pos..@position-1]\n\n  end\n\n  def read_number\n    pos = @position\n    #puts \"RN: char #{@ch}  pos #{pos} position #{@position}\"\n    while is_digit(@ch) do\n      read_char\n    end\n    puts \"METHOD read_number: char #{@ch}  pos #{pos} position #{@position}\\n\"\n    @input[pos..@position-1]\n\n  end\n\n\n  def next_token\n    #puts @ch, @ch.class\n    #puts \"\\nX=X=X=X=X=X=X=X=X=:  #{@ch}, #{@ch.ord},  X=X=X=X=X=X=X=X=X=\\n\"\n    tok = nil\n    consume_whitespace\n\n    tok =\n      case @ch\n      when '=' then Token.new(ASSIGN, @ch)\n      when '+' then Token.new(PLUS, @ch)\n      when '-' then Token.new(MINUS, @ch)\n      when '/' then Token.new(DIVIDE, @ch)\n      when '*' then Token.new(MULTIPLY, @ch)\n      when '%' then Token.new(MODULO, @ch)\n      #when '==' then Token.new(EQUAL_TO, @ch)\n      when '&gt;' then Token.new(GREATER_THAN, @ch)\n      when '&lt;' then Token.new(LESS_THAN, @ch)\n      #when '!=' then Token.new(UNEQUAL_TO, @ch)\n      #when '&amp;&amp;' then Token.new(AND, @ch)\n      #when '||' then Token.new(OR, @ch)\n      when '!' then Token.new(NOT, @ch)\n      when ',' then Token.new(COMMA, @ch)\n      when ';' then Token.new(SEMICOLON, @ch)\n      when '?' then Token.new(QUESTION, @ch)\n      when '(' then Token.new(LPAREN, @ch)\n      when ')' then Token.new(RPAREN, @ch)\n      when '[' then Token.new(LSQUARE, @ch)\n      when ']' then Token.new(RSQUARE, @ch)\n      when '{' then Token.new(LCURLY, @ch)\n      when '}' then Token.new(RCURLY, @ch)\n      else\n        #puts 'hello from next_token', @ch.ord\n        # STATE WAS BEING MUTATED NOW FIXED\n        puts \"letter #{@ch}\"\n        puts \"letter ascii   #{@ch.ord}\"\n        #puts \"isletter  \"\n        if is_letter(@ch)\n          literal = read_identifier\n          Token.new(look_up_ident(literal), literal)\n        elsif is_digit(@ch)\n          Token.new(INT, read_number)\n        else\n          Token.new(ILLEGAL, \"ILLEGAL\")\n        end\n      end\n    read_char\n    return tok\n  end\n\nend\n\n</code></pre>\n\n<p>Now the rake test failures weren't helpful in debugging so I decided to do it simply by writing a <code>main.rb</code> script which would import and run my lexer and a sprinkled a lot of <code>puts</code>s throughout the codebase</p>\n\n<p>This is my <code>main.rb</code></p>\n\n<pre><code>\n    require_relative 'lib/lexer/lexer'\n\n    lex = Lexer.new('five = 5;\n                               ten = 10;')\n\n    i = 1\n    while i &lt;= 8\n        tok = lex.next_token\n        puts \"\\nIN_MAIN: #{tok.type}  ==&gt; #{tok.literal}\\n\\n\"\n        i=i+1\n    end\n</code></pre>\n\n<p>This is the output of <code>ruby main.rb</code></p>\n\n<pre><code>     letter f\n     letter ascii   102\n    METHOD read_identifier: char    pos 0 position 4\n\n    IN_MAIN: IDENTIFIER  ==&gt; five\n\n\n    IN_MAIN: =  ==&gt; =\n\n    letter 5\n    letter ascii   53\n    METHOD read_number: char ;  pos 7 position 8\n\n    IN_MAIN: INT  ==&gt; 5\n\n    letter \n    letter ascii   10\n\n    IN_MAIN: ILLEGAL  ==&gt; ILLEGAL\n\n    letter t\n    letter ascii   116\n    METHOD read_identifier: char    pos 27 position 30\n\n    IN_MAIN: IDENTIFIER  ==&gt; ten\n\n\n    IN_MAIN: =  ==&gt; =\n\n    letter 1\n    letter ascii   49\n    METHOD read_number: char ;  pos 33 position 35\n\n    IN_MAIN: INT  ==&gt; 10\n\n       letter \n        Traceback (most recent call last):\n        2: from main.rb:8:in `&lt;main&gt;'\n        1: from /home/palash25/gundoochy/lib/lexer/lexer.rb:89:in `next_token'\n            /home/palash25/gundoochy/lib/lexer/lexer.rb:89:in `ord': empty string  (ArgumentError)\n</code></pre>\n\n<p>We can ignore the last line because I am not able to handle how to return an object for <code>EOF</code> right now but here is the gist of what is happening before that</p>\n\n<p>The lexer is able to scan the tokens correctly till <code>five = 5</code> after that it skips over the next immediate character which was <code>;</code> and does return a token object for that and instead returns a token object of <code>ILLEGAL</code> type for the <code>\\n</code> that is right after <code>;</code> (I even printed out the ascii values of the character to know for sure it was the <code>\\n</code> returning and ILLEGAL)</p>\n\n<p>This should not have happened since consume_whitespace is supposed to skip over all kinds of whitespace but it still didn't for newlines anyway after that we are able to scan the next line that is <code>ten = 10</code> but the last semicolon is nowhere to be seen in the output just like the first one</p>\n\n<p>If I use an input string without any identifier or number it works perfectly fine.</p>\n\n<p>Here is the link to the full codebase <a href=\"https://gitlab.com/palash25/gundoochy\" rel=\"nofollow noreferrer\">https://gitlab.com/palash25/gundoochy</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1572869803, "post_id": 58693246, "comment_id": 103683445, "body": "Your response will be change in fast json API"}], "answers": [{"tags": [], "owner": {"reputation": 1156, "user_id": 4955546, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3ypcYA0ACXs/AAAAAAAAAAI/AAAAAAAABgY/gcCpBwKBymI/photo.jpg?sz=128", "display_name": "Sikandar Tariq", "link": "https://stackoverflow.com/users/4955546/sikandar-tariq"}, "is_accepted": false, "score": 0, "last_activity_date": 1572871019, "creation_date": 1572871019, "answer_id": 58693614, "question_id": 58693246, "link": "https://stackoverflow.com/questions/58693246/how-to-use-collectionserializer-in-fastjson-api/58693614#58693614", "title": "How to use CollectionSerializer in FastJson API?", "body": "<p>When collection will be passed in serializer it'll deal that collection perfectly no need to configure anything extra. Following are the serializers </p>\n\n<pre><code>class API::Messages::MessagesSerializer\n  include FastJsonapi::ObjectSerializer\n  attributes :id, :name, :description\n\n  attributes :chats do |message|\n    API::Messages::ChatsSerializer.new(message. user_chats)\n  end\nend\n\nclass API::Messages::ChatsSerializer\n  include FastJsonapi::ObjectSerializer\n  attributes ... # add attribute/logic as you want for single chat object\nend\n</code></pre>\n\n<p>And your controller will be something like this</p>\n\n<pre><code>def show\n  render json: API::Messages::MessagesSerializer.new(@message).serialized_json, status: :ok\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11736351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2211f805cdcba26e5ae3240b2c3fdb1?s=128&d=identicon&r=PG&f=1", "display_name": "Sara", "link": "https://stackoverflow.com/users/11736351/sara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 184, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572871019, "creation_date": 1572869561, "question_id": 58693246, "link": "https://stackoverflow.com/questions/58693246/how-to-use-collectionserializer-in-fastjson-api", "title": "How to use CollectionSerializer in FastJson API?", "body": "<p>I'm updating the API code to FastJson (<a href=\"https://github.com/Netflix/fast_jsonapi\" rel=\"nofollow noreferrer\">https://github.com/Netflix/fast_jsonapi</a>) in where I work. The \"old\" code is using ActiveModel and has \n<code>ActiveModel::Serializer::CollectionSerializer.new</code>. I have no idea how to \"translate\" this code to FastJson API.</p>\n\n<p>I already searched in FastJson documentation about Collection Serialization (<a href=\"https://github.com/Netflix/fast_jsonapi#collection-serialization\" rel=\"nofollow noreferrer\">https://github.com/Netflix/fast_jsonapi#collection-serialization</a>), but i didnt understand the example.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class API::Messages::MessagesSerializer &lt; ActiveModel::Serializer\n  attributes :id, :name, :description\n\n  attribute :chats do\n    ActiveModel::Serializer::CollectionSerializer.new(\n      object.user_chats, serializer: API:Messages::ChatUserSerializer\n    )\n  end\nend \n\n</code></pre>\n"}, {"tags": ["ruby", "floating-point", "negative-zero"], "comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1572986618, "post_id": 58691512, "comment_id": 103731250, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/201902/discussion-on-question-by-bruno-alexandre-moreira-pincho-why-do-we-have-0-0-and\">moved to chat</a>."}, {"owner": {"reputation": 5513, "user_id": 2718801, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9d4b144cdafa73e1d470362ed8d7c3a9?s=128&d=identicon&r=PG", "display_name": "jhpratt", "link": "https://stackoverflow.com/users/2718801/jhpratt"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 1, "creation_date": 1573019203, "post_id": 58691512, "comment_id": 103739441, "body": "@ShadowRanger I&#39;m fairly certain there&#39;s not an option to only move certain comments."}], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 26, "last_activity_date": 1573544788, "last_edit_date": 1573544788, "creation_date": 1572863468, "answer_id": 58691546, "question_id": 58691512, "link": "https://stackoverflow.com/questions/58691512/why-do-we-have-0-0-and-0-0-in-ruby/58691546#58691546", "title": "Why do we have 0.0 and -0.0 in Ruby?", "body": "<p>It's not a feature of Ruby, but the part of floating point number specification. See <a href=\"https://stackoverflow.com/a/5096205/580346\">this answer</a>. Negative zero is equal positive zero:</p>\n\n<pre><code>-0.0 == 0.0\n# =&gt; true\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1572889140, "post_id": 58691862, "comment_id": 103693289, "body": "See also the Wiki for <a href=\"https://en.wikipedia.org/wiki/Signed_zero#Properties_and_handling\" rel=\"nofollow noreferrer\">Signed Zero</a>.  Note surpisingly, <code>((-0.0)*(-0.0) #=&gt; 0.0</code>). This question turned out to be more interesting than I originally thought."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 9, "creation_date": 1572901326, "post_id": 58691862, "comment_id": 103697904, "body": "@CarySwoveland What&#39;s surprising about <code>(-0.0)*(-0.0) =&gt; +0.0</code>? It simply follows the sign rule exactly as it does in the <code>1&#47;-0.0 = -inf</code> etc cases.  The one thing that is weird is <code>sqrt(-0.0) = -0.0</code> since most people would expect only values <code>&gt;= 0</code> for the square root..."}, {"owner": {"reputation": 2731, "user_id": 2102585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261dfa9c0baa1cdadbd56a9aae116389?s=128&d=identicon&r=PG", "display_name": "flornquake", "link": "https://stackoverflow.com/users/2102585/flornquake"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 7, "creation_date": 1572901467, "post_id": 58691862, "comment_id": 103697954, "body": "@Bakuriu They would technically be correct since <code>-0.0 &gt;= 0.0</code> in IEEE 754"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 17, "creation_date": 1572901611, "post_id": 58691862, "comment_id": 103697998, "body": "@Bakuriu, &quot;Note&quot; is old-English for &quot;not&quot;. (Confession: I meant to write &quot;Not suprisingly,&quot;. Excuse the typo.)"}, {"owner": {"reputation": 2077, "user_id": 166723, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/82f09cc1d982f45ac86d664c954da003?s=128&d=identicon&r=PG", "display_name": "Crowley", "link": "https://stackoverflow.com/users/166723/crowley"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 4, "creation_date": 1572902039, "post_id": 58691862, "comment_id": 103698144, "body": "@Bakuriu wouldn&#39;t the <code>sqrt(-0.0)=&gt;0+0i</code> be the correct result, a complex zero?"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 2731, "user_id": 2102585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261dfa9c0baa1cdadbd56a9aae116389?s=128&d=identicon&r=PG", "display_name": "flornquake", "link": "https://stackoverflow.com/users/2102585/flornquake"}, "edited": false, "score": 0, "creation_date": 1572902090, "post_id": 58691862, "comment_id": 103698170, "body": "@flornquake Sorry, I meant a number  <code>x</code> such that <code>1&#47;(x-x) = +Infinity</code> xD"}, {"owner": {"reputation": 645, "user_id": 3225276, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wheHF.png?s=128&g=1", "display_name": "LegionMammal978", "link": "https://stackoverflow.com/users/3225276/legionmammal978"}, "reply_to_user": {"reputation": 2077, "user_id": 166723, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/82f09cc1d982f45ac86d664c954da003?s=128&d=identicon&r=PG", "display_name": "Crowley", "link": "https://stackoverflow.com/users/166723/crowley"}, "edited": false, "score": 12, "creation_date": 1572910206, "post_id": 58691862, "comment_id": 103700787, "body": "@Crowley IEEE-754 specifically says that &quot;<b>squareRoot</b> (\u22120) shall be \u22120.&quot;"}, {"owner": {"reputation": 706, "user_id": 2640937, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2bdde9ada4ed0bf5df04bad03a51642d?s=128&d=identicon&r=PG", "display_name": "Vaelus", "link": "https://stackoverflow.com/users/2640937/vaelus"}, "edited": false, "score": 0, "creation_date": 1572917996, "post_id": 58691862, "comment_id": 103702288, "body": "As supplemental material, this video starts with a pretty good explanation of floating point numbers: <a href=\"https://www.youtube.com/watch?v=5TFDG-y-EHs\" rel=\"nofollow noreferrer\">youtube.com/watch?v=5TFDG-y-EHs</a>"}, {"owner": {"reputation": 3676, "user_id": 1166898, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/0fc20bdaa2bbda327e40790844dafdd3?s=128&d=identicon&r=PG", "display_name": "CJ Dennis", "link": "https://stackoverflow.com/users/1166898/cj-dennis"}, "edited": false, "score": 1, "creation_date": 1572918381, "post_id": 58691862, "comment_id": 103702348, "body": "I recently asked a question about <code>0.0</code> and <code>-0.0</code> in PHP, because perhaps surprisingly, they are treated as identical to each other. <code>(0.0 === -0.0) === true</code> in PHP. You&#39;re lucky that they&#39;re different in Ruby!"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 3676, "user_id": 1166898, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/0fc20bdaa2bbda327e40790844dafdd3?s=128&d=identicon&r=PG", "display_name": "CJ Dennis", "link": "https://stackoverflow.com/users/1166898/cj-dennis"}, "edited": false, "score": 4, "creation_date": 1572964684, "post_id": 58691862, "comment_id": 103720499, "body": "@CJDennis: <code>0.0</code> compares equal to <code>-0.0</code> according to IEEE754, even though they&#39;re distinct values.  As this answer shows, Ruby has numeric comparison which finds them equal, but also object-representation or something comparison which can tell the difference.  In most languages (like C/C++) the standard comparison operator finds them equal.  In x86 assembly, the only way to compare and find them not equal is with a bitwise integer compare (not floating point at all, and could find NaN values equal to each other instead of unordered)."}, {"owner": {"reputation": 88, "user_id": 5904738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a3e8b8f1f15fcdd558f389dbbe00801?s=128&d=identicon&r=PG", "display_name": "bug", "link": "https://stackoverflow.com/users/5904738/bug"}, "reply_to_user": {"reputation": 2077, "user_id": 166723, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/82f09cc1d982f45ac86d664c954da003?s=128&d=identicon&r=PG", "display_name": "Crowley", "link": "https://stackoverflow.com/users/166723/crowley"}, "edited": false, "score": 4, "creation_date": 1572966866, "post_id": 58691862, "comment_id": 103721755, "body": "@Crowley even in real math (which IEEE754 isn&#39;t), &quot;complex zero&quot; is still just zero."}, {"owner": {"reputation": 5785, "user_id": 1493294, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/hyY7Y.png?s=128&g=1", "display_name": "candied_orange", "link": "https://stackoverflow.com/users/1493294/candied-orange"}, "edited": false, "score": 0, "creation_date": 1572972021, "post_id": 58691862, "comment_id": 103724829, "body": "Keep in mind that float == float is nonsensical once &quot;normal math&quot; has been used on the floats. That isn&#39;t a special feature of zero."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 5785, "user_id": 1493294, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/hyY7Y.png?s=128&g=1", "display_name": "candied_orange", "link": "https://stackoverflow.com/users/1493294/candied-orange"}, "edited": false, "score": 0, "creation_date": 1572979913, "post_id": 58691862, "comment_id": 103728394, "body": "@candied_orange Real == Real is not sensible in physical systems  as a general rule (see constructive mathematics), so floats not having a sensible == isn&#39;t all that unexpected"}, {"owner": {"reputation": 5785, "user_id": 1493294, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/hyY7Y.png?s=128&g=1", "display_name": "candied_orange", "link": "https://stackoverflow.com/users/1493294/candied-orange"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 2, "creation_date": 1572983000, "post_id": 58691862, "comment_id": 103729738, "body": "@Yakk-AdamNevraumont 0 is a real and 0 == 0 to everyone except statisticians. float == float being nonsensical is because the way floats are stored and presented is fundamentally different, in a lossy way. Floats are 1&#39;s and 0&#39;s. They can be equal right down to the last bit. But how they get that way is a fundamentally different math."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 5785, "user_id": 1493294, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/hyY7Y.png?s=128&g=1", "display_name": "candied_orange", "link": "https://stackoverflow.com/users/1493294/candied-orange"}, "edited": false, "score": 0, "creation_date": 1572983493, "post_id": 58691862, "comment_id": 103729937, "body": "@candied_orange It is true you can sometimes compare reals for equality, but you cannot compare two reals in general; there are sensible ways to construct reals (or find a real) that don&#39;t let you prove if they are equal or not to another real.  But this is not a good place to talk about it.  If you want to know more, go read <a href=\"https://www.springer.com/gp/book/9783642649059\" rel=\"nofollow noreferrer\">springer.com/gp/book/9783642649059</a> or a similar source.  TL;DR the &quot;fuzziness&quot; of mathematics over the Reals is fundamental to their nature.  While float&#39;s &quot;fuzziness&quot; partly comes from another source, no remedy can exist to fully get rid of it."}, {"owner": {"reputation": 5785, "user_id": 1493294, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/hyY7Y.png?s=128&g=1", "display_name": "candied_orange", "link": "https://stackoverflow.com/users/1493294/candied-orange"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1572983823, "post_id": 58691862, "comment_id": 103730082, "body": "@Yakk-AdamNevraumont you&#39;re dragging me into a different discussion. Remember floats are not real. They&#39;re finite representations. My point is that float == float is nonsensical for reasons that have nothing to do with reals, zero, or even &quot;rounding errors&quot;. Strings of digits with a decimal point in them do not convert 1 to 1 to the way floats are stored. So you often don&#39;t get what you expect. Use that surprise in your math and you&#39;re equality test will sometimes surprise you."}, {"owner": {"reputation": 3676, "user_id": 1166898, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/0fc20bdaa2bbda327e40790844dafdd3?s=128&d=identicon&r=PG", "display_name": "CJ Dennis", "link": "https://stackoverflow.com/users/1166898/cj-dennis"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1572989875, "post_id": 58691862, "comment_id": 103732498, "body": "@PeterCordes PHP treats them identically in both cases. <code>0.0 == -0.0</code> (good), <code>0.0 === -0.0</code> (surprising). I would expect the object representation in PHP to find a difference, but it doesn&#39;t."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1572995638, "post_id": 58691862, "comment_id": 103734396, "body": "@Yakk-AdamNevraumont:  Math isn&#39;t bound by physical laws of a physical world. It <i>absolutely</i> makes sense to compare <code>sqrt(2)</code> to <code>sqrt(2)</code> and expect them to always be equal mathematically, regardless of any constraints in real world physical systems."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 3676, "user_id": 1166898, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/0fc20bdaa2bbda327e40790844dafdd3?s=128&d=identicon&r=PG", "display_name": "CJ Dennis", "link": "https://stackoverflow.com/users/1166898/cj-dennis"}, "edited": false, "score": 0, "creation_date": 1572998678, "post_id": 58691862, "comment_id": 103735171, "body": "@CJDennis: I upvoted your comment before checking <a href=\"https://www.php.net/manual/en/language.operators.comparison.php\" rel=\"nofollow noreferrer\">what <code>===</code> is <i>supposed</i> to mean in PHP</a>.  It compares values for equality without doing type-coercion, i.e. checks that they&#39;re the same type and then compares values.  Of course it considers them true.  It&#39;s not a bitwise comparison or what C would call comparing the &quot;object representation&quot;.  It&#39;s neat that Ruby has that, but like I said it&#39;s not rare for languages to lack it."}, {"owner": {"reputation": 3676, "user_id": 1166898, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/0fc20bdaa2bbda327e40790844dafdd3?s=128&d=identicon&r=PG", "display_name": "CJ Dennis", "link": "https://stackoverflow.com/users/1166898/cj-dennis"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1572998928, "post_id": 58691862, "comment_id": 103735224, "body": "@PeterCordes True, but it&#39;s still surprising that PHP treats them differently but makes it very hard to detect the difference."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 3676, "user_id": 1166898, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/0fc20bdaa2bbda327e40790844dafdd3?s=128&d=identicon&r=PG", "display_name": "CJ Dennis", "link": "https://stackoverflow.com/users/1166898/cj-dennis"}, "edited": false, "score": 0, "creation_date": 1572999271, "post_id": 58691862, "comment_id": 103735292, "body": "@CJDennis: That&#39;s not surprising, it&#39;s how most languages are.  Including C.  They&#39;re supposed to be the same value but underflowed from a different direction so that makes some sense.  You can do stuff like <code>copysign</code> in C to extract the sign, or of course <code>memcmp</code>, but there&#39;s no simple compare operator that considers them not equal.  Hardware typically can&#39;t do it efficiently either, for FP values in registers (in assembly language).  The only normal FP compare instructions use IEEE754 semantics.  (Or sometimes with FP in SIMD regs you can use integer bitwise equality.)"}, {"owner": {"reputation": 3676, "user_id": 1166898, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/0fc20bdaa2bbda327e40790844dafdd3?s=128&d=identicon&r=PG", "display_name": "CJ Dennis", "link": "https://stackoverflow.com/users/1166898/cj-dennis"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1572999484, "post_id": 58691862, "comment_id": 103735335, "body": "@PeterCordes Either the difference is important and should be easily detectable, or it&#39;s unimportant and should not be detectable at all. The sign of <code>-0.0</code> is correctly <code>0</code> so it can&#39;t be detected that way. I asked a question and was given a very clever way of detecting it that I wouldn&#39;t have thought of."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 105, "last_activity_date": 1574593060, "last_edit_date": 1574593060, "creation_date": 1572864520, "answer_id": 58691862, "question_id": 58691512, "link": "https://stackoverflow.com/questions/58691512/why-do-we-have-0-0-and-0-0-in-ruby/58691862#58691862", "title": "Why do we have 0.0 and -0.0 in Ruby?", "body": "<p>You can assign a negative sign to a 0.0 float in Ruby because all <a href=\"https://en.wikipedia.org/wiki/IEEE_754\" rel=\"noreferrer\">IEEE 754</a> floating point numbers have a <em>sign bit</em> to indicate whether the number is positive or negative.</p>\n\n<p>Here are the binary representations of <code>2.5</code> and <code>-2.5</code>:</p>\n\n<pre><code>[2.5].pack('f').unpack1('b*')\n#=&gt; \"00000000000000000000010000000010\"\n\n[-2.5].pack('f').unpack1('b*')\n#=&gt; \"00000000000000000000010000000011\"\n</code></pre>\n\n<p>The last bit is the sign bit. Note that all the other bits are identical.</p>\n\n<p>On the other hand, there is zero with a sign bit of <code>0</code>:</p>\n\n<pre><code>['00000000000000000000000000000000'].pack('b*').unpack1('f')\n#=&gt; 0.0\n</code></pre>\n\n<p>and zero with a sign bit of <code>1</code>:</p>\n\n<pre><code>['00000000000000000000000000000001'].pack('b*').unpack1('f')\n#=&gt; -0.0\n</code></pre>\n\n<p>Although <code>0.0</code> and <code>-0.0</code> are numerically equal, they are not identical on the object level:</p>\n\n<pre><code>(0.0).eql?(-0.0)   #=&gt; true\n(0.0).equal?(-0.0) #=&gt; false\n</code></pre>\n\n<p>Negative zeros have some <a href=\"https://en.wikipedia.org/wiki/Signed_zero#Properties_and_handling\" rel=\"noreferrer\">special properties</a>.\nFor instance:</p>\n\n<pre><code>1 / 0.0    #=&gt; Infinity\n1 / -0.0   #=&gt; -Infinity\n</code></pre>\n\n<p>Assigning <code>-</code> explicitly is not the only way to get <code>-0.0</code>. You may also get <code>-0.0</code> as the result of a basic arithmetic operation:</p>\n\n<pre><code>-1.0 * 0 #=&gt; -0.0\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1572902531, "post_id": 58700192, "comment_id": 103698330, "body": "Well said, Calvin, but I have a quibble: it grates to read about &quot;small&quot; negative values close to zero, notwithstanding &quot;(magnitude)&quot;. I think it would be preferable say, &quot;...there must be a smallest positive float, and its opposite, a largest negative float. But what happens to real number results even closer to zero?&quot; and similar small adjustments in wording in the second and third paragraphs."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 15, "creation_date": 1572904593, "post_id": 58700192, "comment_id": 103699135, "body": "@CarySwoveland those will just cause an annoyance of equal magnitude (but opposite sign) to someone else :)"}, {"owner": {"reputation": 276, "user_id": 2676166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c802a569e2f9fe7f7968c3bf50bef844?s=128&d=identicon&r=PG&f=1", "display_name": "mephistolotl", "link": "https://stackoverflow.com/users/2676166/mephistolotl"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1573018851, "post_id": 58700192, "comment_id": 103739326, "body": "@CarySwoveland that would be the greatest negative float, not the largest. At least in my mathematical education."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "reply_to_user": {"reputation": 276, "user_id": 2676166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c802a569e2f9fe7f7968c3bf50bef844?s=128&d=identicon&r=PG&f=1", "display_name": "mephistolotl", "link": "https://stackoverflow.com/users/2676166/mephistolotl"}, "edited": false, "score": 1, "creation_date": 1573019372, "post_id": 58700192, "comment_id": 103739496, "body": "@mephistolotl yeah, &quot;least&quot; and &quot;greatest&quot; point towards negative and positive infinity; &quot;smallest&quot; and &quot;largest&quot; point towards and away from zero. At least in my mind, but I think I&#39;m being at least <i>somewhat</i> conventional here."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 276, "user_id": 2676166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c802a569e2f9fe7f7968c3bf50bef844?s=128&d=identicon&r=PG&f=1", "display_name": "mephistolotl", "link": "https://stackoverflow.com/users/2676166/mephistolotl"}, "edited": false, "score": 0, "creation_date": 1573021309, "post_id": 58700192, "comment_id": 103740090, "body": "@mephistolotl, my comment was motivated by mathematics. <a href=\"https://math.stackexchange.com/questions/131506/what-is-the-largest-negative-number-curiosity\">Here</a>, at <i>math.stackexchange.com</i>, mathematicians address the question, &quot;What is the largest negative number?&quot;. They conclude (what seems obvious) that one does not exist, because for every negative real number <code>a</code> there is another negative real number <code>b</code> such that <code>a &lt; b &lt; 0</code>. They  refer to the limit zero, not negative infinity."}, {"owner": {"reputation": 276, "user_id": 2676166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c802a569e2f9fe7f7968c3bf50bef844?s=128&d=identicon&r=PG&f=1", "display_name": "mephistolotl", "link": "https://stackoverflow.com/users/2676166/mephistolotl"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1573194945, "post_id": 58700192, "comment_id": 103809789, "body": "@CarySwoveland I might have misunderstood your point. I, of course, agree that there is no greatest negative number. I was making the point that negative numbers near zero are small and great, while it seemed to me you were saying they are large and great. That is, in the mathematical terminology I&#39;m familiar with, -2 is smaller than -3 and -2 is greater than -3."}], "tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": false, "score": 41, "last_activity_date": 1574609366, "last_edit_date": 1574609366, "creation_date": 1572897231, "answer_id": 58700192, "question_id": 58691512, "link": "https://stackoverflow.com/questions/58691512/why-do-we-have-0-0-and-0-0-in-ruby/58700192#58700192", "title": "Why do we have 0.0 and -0.0 in Ruby?", "body": "<p>Mathematical operations have real-number results, but we map those real results onto the nearest floating-point number, which is called \"rounding\". For every floating-point number, there is a <em>range</em> of real numbers that will round to that float, and sometimes it's useful to think of the float as being identified with that range of real numbers. </p>\n\n<p>Since there is a finite supply of floating-point numbers, there must be a smallest positive float, and its opposite, the smallest (magnitude) negative float. But what happens to real number results even smaller than <em>those</em>? Well, they must \"round to zero\". But \"a really small number greater than zero\" and \"a really small number less than zero\" are pretty different things with pretty different mathematical <em>behavior</em>, so why should we lose the distinction between them, just because we're rounding? We don't have to.</p>\n\n<p>So, the float 0 doesn't just include the real number 0, it also includes too-small-to-represent <em>positive</em> quantities. And the float -0 includes too-small-to-represent <em>negative</em> quantities. When you use them in arithmetic, they follow rules like \"negative times positive equals negative; negative times negative equals positive\". Even though we've forgotten almost everything about these numbers in the rounding process, we still haven't forgotten their sign.</p>\n"}, {"tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 2, "last_activity_date": 1572980674, "creation_date": 1572980674, "answer_id": 58717881, "question_id": 58691512, "link": "https://stackoverflow.com/questions/58691512/why-do-we-have-0-0-and-0-0-in-ruby/58717881#58717881", "title": "Why do we have 0.0 and -0.0 in Ruby?", "body": "<p>An example of when you might need -0.0 is when working with a function, such as tangent, secant or cosecant, that has vertical poles which need to go in the right direction. You might end up dividing to get negative infinity, and you would not want to graph that as a vertical line shooting up to positive infinity. Or you might need the correct sign of a function asymptotically approaching 0 from below, like if you\u2019ve got exponential decay of a negative number and check that it remains negative.</p>\n"}], "owner": {"reputation": 867, "user_id": 8696400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9c7c2fc93edc70eb35a9b0b83e48e0d?s=128&d=identicon&r=PG", "display_name": "Bruno Alexandre Moreira Pincho", "link": "https://stackoverflow.com/users/8696400/bruno-alexandre-moreira-pincho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7753, "favorite_count": 3, "closed_date": 1573050180, "accepted_answer_id": 58691862, "answer_count": 4, "score": 72, "last_activity_date": 1574609366, "creation_date": 1572863327, "last_edit_date": 1572867018, "question_id": 58691512, "link": "https://stackoverflow.com/questions/58691512/why-do-we-have-0-0-and-0-0-in-ruby", "closed_reason": "Duplicate", "title": "Why do we have 0.0 and -0.0 in Ruby?", "body": "<p>In ruby why can I assign a negative sign to 0.0 float, is this feature useful in any way? Could someone explain this one to me?</p>\n\n<pre><code>-0.0\n#=&gt; -0.0\n\n-0.0 * -1\n#=&gt; 0.0\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 28830, "user_id": 221213, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bbfbca5273f9d020ef4ccfbadcecccba?s=128&d=identicon&r=PG", "display_name": "KARASZI Istv&#225;n", "link": "https://stackoverflow.com/users/221213/karaszi-istv%c3%a1n"}, "reply_to_user": {"reputation": 628, "user_id": 5954643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9tq2jIW1zsk/AAAAAAAAAAI/AAAAAAAABcY/id8Ndc5tWuY/photo.jpg?sz=128", "display_name": "Rajkumar Ulaganadhan", "link": "https://stackoverflow.com/users/5954643/rajkumar-ulaganadhan"}, "edited": false, "score": 0, "creation_date": 1572889218, "post_id": 58690346, "comment_id": 103693322, "body": "Is it stopping with the same stack trace? Could you modify <code>save-history.rb</code> that it prints out the filename?"}, {"owner": {"reputation": 628, "user_id": 5954643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9tq2jIW1zsk/AAAAAAAAAAI/AAAAAAAABcY/id8Ndc5tWuY/photo.jpg?sz=128", "display_name": "Rajkumar Ulaganadhan", "link": "https://stackoverflow.com/users/5954643/rajkumar-ulaganadhan"}, "edited": false, "score": 1, "creation_date": 1572934460, "post_id": 58690346, "comment_id": 103705651, "body": "I have modified /home/hman01/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/irb/ext/s&zwnj;&#8203;ave-history.rb:76. Files. It is working fine."}], "tags": [], "owner": {"reputation": 28830, "user_id": 221213, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bbfbca5273f9d020ef4ccfbadcecccba?s=128&d=identicon&r=PG", "display_name": "KARASZI Istv&#225;n", "link": "https://stackoverflow.com/users/221213/karaszi-istv%c3%a1n"}, "is_accepted": true, "score": 4, "last_activity_date": 1572859344, "creation_date": 1572859344, "answer_id": 58690346, "question_id": 58689271, "link": "https://stackoverflow.com/questions/58689271/rails-console-not-working-getting-this-error/58690346#58690346", "title": "Rails console not working. Getting this error", "body": "<p>Checking the source code at <a href=\"https://github.com/ruby/ruby/blob/v2_5_0/lib/irb/ext/save-history.rb#L76\" rel=\"nofollow noreferrer\"><code>save-history.rb:76</code></a> it seems that it has issues with your history file. I would try deleting the IRB history file(s). According to <a href=\"https://github.com/ruby/ruby/blob/v2_5_0/lib/irb/init.rb#L240-L272\" rel=\"nofollow noreferrer\"><code>IRB#rc_file</code></a> it can be in multiple places</p>\n\n<p>If your <code>HOME</code> environment is set:</p>\n\n<pre><code>rm ~/.irb_history\n</code></pre>\n\n<p>If not then from the working directory:</p>\n\n<pre><code>rm .irb_history irb.history _irb_history '$irb_history`\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 628, "user_id": 5954643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9tq2jIW1zsk/AAAAAAAAAAI/AAAAAAAABcY/id8Ndc5tWuY/photo.jpg?sz=128", "display_name": "Rajkumar Ulaganadhan", "link": "https://stackoverflow.com/users/5954643/rajkumar-ulaganadhan"}, "is_accepted": false, "score": 1, "last_activity_date": 1572934916, "creation_date": 1572934916, "answer_id": 58705548, "question_id": 58689271, "link": "https://stackoverflow.com/questions/58689271/rails-console-not-working-getting-this-error/58705548#58705548", "title": "Rails console not working. Getting this error", "body": "<p>I have modified the save-history.rb file.</p>\n\n<pre><code>f.each {|l| HISTORY &lt;&lt; l.gsub(\"\\u0000\", '').chomp}.\n</code></pre>\n\n<p>Now it is working.</p>\n"}], "owner": {"reputation": 628, "user_id": 5954643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9tq2jIW1zsk/AAAAAAAAAAI/AAAAAAAABcY/id8Ndc5tWuY/photo.jpg?sz=128", "display_name": "Rajkumar Ulaganadhan", "link": "https://stackoverflow.com/users/5954643/rajkumar-ulaganadhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 58690346, "answer_count": 2, "score": -2, "last_activity_date": 1572934916, "creation_date": 1572854503, "last_edit_date": 1572856045, "question_id": 58689271, "link": "https://stackoverflow.com/questions/58689271/rails-console-not-working-getting-this-error", "title": "Rails console not working. Getting this error", "body": "<pre><code>Traceback (most recent call last):\n16: from /home/hman01/.rvm/rubies/ruby-2.5.0/bin/irb:11:in `&lt;main&gt;'\n15: from /home/hman01/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/irb.rb:381:in `start'\n14: from /home/hman01/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/irb.rb:381:in `new'\n13: from /home/hman01/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/irb.rb:410:in `initialize'\n12: from /home/hman01/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/irb.rb:410:in `new'\n11: from /home/hman01/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/irb/context.rb:91:in `initialize'\n10: from /home/hman01/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/irb/extend-command.rb:242:in `save_history='\n 9: from /home/hman01/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/irb/ext/save-history.rb:45:in `save_history='\n 8: from /home/hman01/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/irb/ext/save-history.rb:21:in `init_save_history'\n 7: from /home/hman01/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/irb/ext/save-history.rb:21:in `extend'\n 6: from /home/hman01/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/irb/ext/save-history.rb:65:in `extended'\n 5: from /home/hman01/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/irb/ext/save-history.rb:75:in `load_history'\n 4: from /home/hman01/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/irb/ext/save-history.rb:75:in `open'\n 3: from /home/hman01/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/irb/ext/save-history.rb:76:in `block in load_history'\n 2: from /home/hman01/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/irb/ext/save-history.rb:76:in `each'\n 1: from /home/hman01/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/irb/ext/save-history.rb:76:in `block (2 levels) in load_history'\n/home/hman01/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/irb/ext/save-history.rb:76:in `&lt;&lt;': string contains null byte (ArgumentError)\n</code></pre>\n"}, {"tags": ["ruby", "dependencies", "jekyll", "blogs"], "answers": [{"comments": [{"owner": {"reputation": 983, "user_id": 8424406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92e62aaf8c6e87bf43aa9c762bc0faa3?s=128&d=identicon&r=PG&f=1", "display_name": "Sambo Kim", "link": "https://stackoverflow.com/users/8424406/sambo-kim"}, "edited": false, "score": 0, "creation_date": 1572853441, "post_id": 58688930, "comment_id": 103676042, "body": "In my Gemfile, it is defiend as <code>gem &quot;jekyll&quot;, &quot;~&gt; 4.0.0&quot;</code>. So I changed it to <code>gem &quot;jekyll&quot;, &quot;~&gt; 3.3&quot;</code> but it gives me an more error. It says, <code>Bundler could not find compatible versions for gem &quot;jekyll&quot;:   In Gemfile:     github-pages was resolved to 4, which depends on       jekyll (= 1.1.2)</code>"}, {"owner": {"reputation": 983, "user_id": 8424406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92e62aaf8c6e87bf43aa9c762bc0faa3?s=128&d=identicon&r=PG&f=1", "display_name": "Sambo Kim", "link": "https://stackoverflow.com/users/8424406/sambo-kim"}, "edited": false, "score": 0, "creation_date": 1572853570, "post_id": 58688930, "comment_id": 103676080, "body": "And what do you mean by <b>fork the Gem</b>??? What is <b>PR</b> also?"}, {"owner": {"reputation": 184, "user_id": 3431720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/debd1f9144646ee5c74b4d65b74a73ae?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Pinn", "link": "https://stackoverflow.com/users/3431720/dylan-pinn"}, "reply_to_user": {"reputation": 983, "user_id": 8424406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92e62aaf8c6e87bf43aa9c762bc0faa3?s=128&d=identicon&r=PG&f=1", "display_name": "Sambo Kim", "link": "https://stackoverflow.com/users/8424406/sambo-kim"}, "edited": false, "score": 1, "creation_date": 1572853680, "post_id": 58688930, "comment_id": 103676109, "body": "Try running <code>bundle update</code> to see if that fixes it.  Forks are outlined here - <a href=\"https://help.github.com/en/github/getting-started-with-github/fork-a-repo\" rel=\"nofollow noreferrer\">help.github.com/en/github/getting-started-with-github/&hellip;</a>  Pull-requests - <a href=\"https://help.github.com/en/github/collaborating-with-issues-and-pull-requests/about-pull-requests\" rel=\"nofollow noreferrer\">help.github.com/en/github/&hellip;</a>  How to use a fork in your Gemfile <a href=\"https://bundler.io/v1.12/git.html\" rel=\"nofollow noreferrer\">bundler.io/v1.12/git.html</a>"}, {"owner": {"reputation": 763, "user_id": 280622, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f14dc43f24495e13a6923b38c892861b?s=128&d=identicon&r=PG", "display_name": "Robert Bernstein", "link": "https://stackoverflow.com/users/280622/robert-bernstein"}, "edited": false, "score": 0, "creation_date": 1603574594, "post_id": 58688930, "comment_id": 114082347, "body": "I ran into the same problem with &quot;jekyll-theme-minimal&quot;.  I tried using <code>gem &quot;jekyll&quot;, &quot;~&gt; 3.9&quot;</code> and that worked."}], "tags": [], "owner": {"reputation": 184, "user_id": 3431720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/debd1f9144646ee5c74b4d65b74a73ae?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Pinn", "link": "https://stackoverflow.com/users/3431720/dylan-pinn"}, "is_accepted": false, "score": 1, "last_activity_date": 1572852753, "creation_date": 1572852753, "answer_id": 58688930, "question_id": 58688846, "link": "https://stackoverflow.com/questions/58688846/bundler-compatiable-versions-for-gem-jekyll/58688930#58688930", "title": "Bundler compatiable versions for gem &quot;jekyll&quot;", "body": "<p>This is occurring because you are requesting conflicting versions of Jeykll. One option is to downgrade the version of Jeykll you are using by changing it in your <code>Gemfile</code></p>\n\n<pre><code>-jekyll (~&gt; 4.0.0)\n+jekyll (~&gt; 3.3)\n</code></pre>\n\n<p>and then running <code>bundle update jekyll</code></p>\n\n<p>If you wanted to run the latest version, you could fork the Gem, update the <code>jekyll</code> dependency version and test the changes. If it is working as expected you should submit a PR to the original repo and could use the fork while waiting for it to be merged.</p>\n"}, {"tags": [], "owner": {"reputation": 46692, "user_id": 1548376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCZQw.gif?s=128&g=1", "display_name": "David Jacquel", "link": "https://stackoverflow.com/users/1548376/david-jacquel"}, "is_accepted": false, "score": 0, "last_activity_date": 1572914920, "creation_date": 1572914920, "answer_id": 58702978, "question_id": 58688846, "link": "https://stackoverflow.com/questions/58688846/bundler-compatiable-versions-for-gem-jekyll/58702978#58702978", "title": "Bundler compatiable versions for gem &quot;jekyll&quot;", "body": "<p>Content of your <strong>Gemfile</strong> :</p>\n\n<pre><code>source 'https://rubygems.org'\ngem 'github-pages'\n</code></pre>\n\n<p>Remove your <strong>Gemfile.lock</strong></p>\n\n<p>Launch a <code>bundle</code> command.</p>\n\n<p>That's it ! Your ready to deploy to github pages.</p>\n"}, {"tags": [], "owner": {"reputation": 313, "user_id": 3264593, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001063184569/picture?type=large", "display_name": "Neha", "link": "https://stackoverflow.com/users/3264593/neha"}, "is_accepted": false, "score": 1, "last_activity_date": 1586063778, "creation_date": 1586063778, "answer_id": 61038369, "question_id": 58688846, "link": "https://stackoverflow.com/questions/58688846/bundler-compatiable-versions-for-gem-jekyll/61038369#61038369", "title": "Bundler compatiable versions for gem &quot;jekyll&quot;", "body": "<p>Version 3.7 worked for me, you could try and check the same.</p>\n"}], "owner": {"reputation": 983, "user_id": 8424406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92e62aaf8c6e87bf43aa9c762bc0faa3?s=128&d=identicon&r=PG&f=1", "display_name": "Sambo Kim", "link": "https://stackoverflow.com/users/8424406/sambo-kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1475, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1586063778, "creation_date": 1572852346, "question_id": 58688846, "link": "https://stackoverflow.com/questions/58688846/bundler-compatiable-versions-for-gem-jekyll", "title": "Bundler compatiable versions for gem &quot;jekyll&quot;", "body": "<p>I'm trying to setup github page using Jekyll, currently it is using <strong>minima theme</strong>, and I want to change it to <strong>jekyll-theme-hacker</strong>.</p>\n\n<p>So, I went to Gemfile, \nI added </p>\n\n<pre><code>gem \"github-pages\", group:jekyll_plugins\n</code></pre>\n\n<p>under the</p>\n\n<pre><code>gem \"minima\", \"~&gt;2.5\"\n</code></pre>\n\n<p>And after saving it, I did</p>\n\n<pre><code>bundle install\n</code></pre>\n\n<p>But this gives me the error.</p>\n\n<pre><code>Bundler could not find compatible versions for gem \"jekyll\":\n  In snapshot (Gemfile.lock):\n    jekyll (= 4.0.0)\n\n  In Gemfile:\n    jekyll (~&gt; 4.0.0)\n\n    jekyll-theme-hacker was resolved to 0.0.4, which depends on\n      jekyll (~&gt; 3.3)\n\nRunning `bundle update` will rebuild your snapshot from scratch, using\nonly\nthe gems in your Gemfile, which may resolve the conflict.\n</code></pre>\n\n<p>I am very new to the Jekyll and Programming, I wonder why this happened.</p>\n\n<p>As far as what I could figure out was, Bundler is a Gem management tool, which Gem stands for the library or module for ruby programming langauge. So what I was trying to do was trying to install all the necessary things for the my new theme.</p>\n\n<p>However bundler could not find compatible versions for gem \"jekyll\". \nWhat does this exactly mean? Do I need a different dependency of jekyll to use my new theme? \nIf it is so, How can I do it?</p>\n\n<p>Thanks a lot in advance.</p>\n\n<p>----EDIT----\nThis is how my <strong>Gemfile.lock</strong> looks like</p>\n\n<pre><code>GEM\n  remote: https://rubygems.org/\n  specs:\n    addressable (2.7.0)\n      public_suffix (&gt;= 2.0.2, &lt; 5.0)\n    colorator (1.1.0)\n    concurrent-ruby (1.1.5)\n    em-websocket (0.5.1)\n      eventmachine (&gt;= 0.12.9)\n      http_parser.rb (~&gt; 0.6.0)\n    eventmachine (1.2.7)\n    ffi (1.11.1)\n    forwardable-extended (2.6.0)\n    http_parser.rb (0.6.0)\n    i18n (1.7.0)\n      concurrent-ruby (~&gt; 1.0)\n    jekyll (4.0.0)\n      addressable (~&gt; 2.4)\n      colorator (~&gt; 1.0)\n      em-websocket (~&gt; 0.5)\n      i18n (&gt;= 0.9.5, &lt; 2)\n      jekyll-sass-converter (~&gt; 2.0)\n      jekyll-watch (~&gt; 2.0)\n      kramdown (~&gt; 2.1)\n      kramdown-parser-gfm (~&gt; 1.0)\n      liquid (~&gt; 4.0)\n      mercenary (~&gt; 0.3.3)\n      pathutil (~&gt; 0.9)\n      rouge (~&gt; 3.0)\n      safe_yaml (~&gt; 1.0)\n      terminal-table (~&gt; 1.8)\n    jekyll-feed (0.12.1)\n      jekyll (&gt;= 3.7, &lt; 5.0)\n    jekyll-sass-converter (2.0.1)\n      sassc (&gt; 2.0.1, &lt; 3.0)\n    jekyll-seo-tag (2.6.1)\n      jekyll (&gt;= 3.3, &lt; 5.0)\n    jekyll-watch (2.2.1)\n      listen (~&gt; 3.0)\n    kramdown (2.1.0)\n    kramdown-parser-gfm (1.1.0)\n      kramdown (~&gt; 2.0)\n    liquid (4.0.3)\n    listen (3.2.0)\n      rb-fsevent (~&gt; 0.10, &gt;= 0.10.3)\n      rb-inotify (~&gt; 0.9, &gt;= 0.9.10)\n    mercenary (0.3.6)\n    minima (2.5.1)\n      jekyll (&gt;= 3.5, &lt; 5.0)\n      jekyll-feed (~&gt; 0.9)\n      jekyll-seo-tag (~&gt; 2.1)\n    pathutil (0.16.2)\n      forwardable-extended (~&gt; 2.6)\n    public_suffix (4.0.1)\n    rb-fsevent (0.10.3)\n    rb-inotify (0.10.0)\n      ffi (~&gt; 1.0)\n    rouge (3.11.1)\n    safe_yaml (1.0.5)\n    sassc (2.2.1)\n      ffi (~&gt; 1.9)\n    terminal-table (1.8.0)\n      unicode-display_width (~&gt; 1.1, &gt;= 1.1.1)\n    thread_safe (0.3.6)\n    tzinfo (1.2.5)\n      thread_safe (~&gt; 0.1)\n    tzinfo-data (1.2019.3)\n      tzinfo (&gt;= 1.0.0)\n    unicode-display_width (1.6.0)\n    wdm (0.1.1)\n\nPLATFORMS\n  ruby\n\nDEPENDENCIES\n  jekyll (~&gt; 4.0.0)\n  jekyll-feed (~&gt; 0.12)\n  minima (~&gt; 2.5)\n  tzinfo (~&gt; 1.2)\n  tzinfo-data\n  wdm (~&gt; 0.1.1)\n\nBUNDLED WITH\n   2.0.2\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "parameters", "render"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1572846981, "post_id": 58687772, "comment_id": 103674035, "body": "A <code>render :new</code> just renders a view, it doesn&#39;t change the URL. Perhaps it is just me but I do not understand your question. Can you explain how it changes the URL in your application? And can you please add some code and the steps in which your user uses the views and clicks links to your question to make it clearer?"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1572856188, "post_id": 58687772, "comment_id": 103677092, "body": "Post your controller please, params should not be lost when rendering."}, {"owner": {"reputation": 51, "user_id": 12289413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dH0Ew.jpg?s=128&g=1", "display_name": "NewbieOnRails", "link": "https://stackoverflow.com/users/12289413/newbieonrails"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1572863159, "post_id": 58687772, "comment_id": 103680403, "body": "@Mark I edited the topic, sorry for not being so detailed the first time"}, {"owner": {"reputation": 51, "user_id": 12289413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dH0Ew.jpg?s=128&g=1", "display_name": "NewbieOnRails", "link": "https://stackoverflow.com/users/12289413/newbieonrails"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1572863179, "post_id": 58687772, "comment_id": 103680417, "body": "@spickermann edited the topic, sorry for not being so detailed the first time"}], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 0, "last_activity_date": 1572864135, "creation_date": 1572864135, "answer_id": 58691751, "question_id": 58687772, "link": "https://stackoverflow.com/questions/58687772/how-to-do-render-new-in-controller-and-do-not-lose-params-from-url/58691751#58691751", "title": "How to do render :new in controller and do not lose params from url?", "body": "<p>I would just change</p>\n\n<pre><code>&lt;%= f.hidden_field :serie_id, value: params[:serie_id] %&gt;\n</code></pre>\n\n<p>to </p>\n\n<pre><code>&lt;%= f.hidden_field :serie_id, value: (f.object.serie_id.presence || params[:serie_id]) %&gt;\n</code></pre>\n\n<p>to only fallback to <code>params[:serie_id]</code> when the <code>serie_id</code> attribute is not set on the chapter already.</p>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1572876900, "post_id": 58692626, "comment_id": 103686989, "body": "&quot;Not sure if rails will properly inflect this but if not you can do so by setting up an inflection.&quot; rails can and does acknowledge this. e.g. <code>&#39;series&#39;.singularize #=&gt; &quot;series&quot;</code> and <code>series.pluarlize(3) #=&gt; &quot;series&quot;</code>. Series is actually literally listed in <a href=\"https://github.com/rails/rails/blob/92f567ab30f240a1de152061a6eee76ca6c4da86/activesupport/lib/active_support/inflections.rb#L44\" rel=\"nofollow noreferrer\">inflections</a>"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1572877061, "post_id": 58692626, "comment_id": 103687058, "body": "Thanks @engineersmnky was&#39;t able to test it at the time of writing."}, {"owner": {"reputation": 51, "user_id": 12289413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dH0Ew.jpg?s=128&g=1", "display_name": "NewbieOnRails", "link": "https://stackoverflow.com/users/12289413/newbieonrails"}, "edited": false, "score": 0, "creation_date": 1572893376, "post_id": 58692626, "comment_id": 103694984, "body": "Hi! Thanks a lot! This solved my problem! My bad with that singular form, maybe is obvious, but english is not my native language."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 0, "last_activity_date": 1572868337, "last_edit_date": 1572868337, "creation_date": 1572867346, "answer_id": 58692626, "question_id": 58687772, "link": "https://stackoverflow.com/questions/58687772/how-to-do-render-new-in-controller-and-do-not-lose-params-from-url/58692626#58692626", "title": "How to do render :new in controller and do not lose params from url?", "body": "<p>The rails way to do this is by creating a <a href=\"https://guides.rubyonrails.org/routing.html#nested-resources\" rel=\"nofollow noreferrer\">nested resource</a>:</p>\n\n<pre><code># config/routes.rb\nresources :series do\n  resources :episodes, shallow: true\nend\n</code></pre>\n\n<p>Run <code>rails routes</code> to see the routes output. The key takeaway here is that it creates a <code>GET /series/:series_id/episodes/new</code> route and a <code>POST /series/:series_id/episodes</code>. This makes the linking between the two resources explicit - and not something tucked away in the body of the request.</p>\n\n<p>In general if you are using a hidden field to pass the id of a resource or a user id you are doing it wrong.</p>\n\n<pre><code>class EpisodesController\n  before_action :set_series\n\n  # GET /series/1/episodes/new\n  def new\n    @episode = @series.episodes.new\n  end\n\n  # POST /series/1/episodes\n  def create\n    @episode = @series.episodes.new(episode_params)\n    if @episode.save\n       redirect_to @episode\n    else\n       render :new\n    end\n  end\n  # ...\n  private \n  def set_series\n     @series = Series.find(params[:series_id])\n  end\n\n  def episode_params\n    params.require(:episode).permit(:foo, :bar, :baz)\n  end\nend\n</code></pre>\n\n<p>To get the form to post to <code>/series/:serie_id/episodes</code> instead of <code>/series</code> we pass an array:</p>\n\n<pre><code>&lt;%= form_for([@series, @episode]) %&gt;\n  &lt;%= f.label :name, 'Name' %&gt;\n  &lt;%= f.text_field :name%&gt;\n  &lt;%= f.submit %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<blockquote>\n  <p>If the user press the button which sumbit the form from new to create,\n  if he makes a mistake filling the form, the @episode can't been save\n  and makes the render :new and then the url change to\n  localhost3000/episodes/</p>\n</blockquote>\n\n<p>This is a really common beginner hangup thats caused by not understanding how <a href=\"https://guides.rubyonrails.org/routing.html#resource-routing-the-rails-default\" rel=\"nofollow noreferrer\">Rails style REST</a> works</p>\n\n<p>In REST you create a resource by posting to the collection route (<code>POST /episodes</code>). This means that the browsers URL is changed by posting the form and this is exactly how it should be.</p>\n\n<p><code>render :new</code> does NOT change the URL. It merely instructs rails to render the <em>app/views/episodes/new.html.erb</em> view. </p>\n\n<p>What you then are seeing is the result of performing a non-idempotent action. You should NOT redirect back as its both unnecessary and requires you to place all the params in the query string which is less than ideal.</p>\n\n<h2>PS</h2>\n\n<p>You should also note that the <a href=\"https://www.thefreedictionary.com/series\" rel=\"nofollow noreferrer\">correct singular form of series in English</a> is <em>series</em> not <em>serie</em>. Not sure if rails will properly inflect this but if not you can do so by setting up an inflection. </p>\n\n<pre><code># config/intializers/inflections.rb\nActiveSupport::Inflector.inflections(:en) do |inflect|\n  inflect.irregular 'series', 'series'\nen\n</code></pre>\n\n<p>You should then rename the model and associations.</p>\n\n<p>Why does this matter? <a href=\"https://medium.com/u2i-blogs/how-violating-the-principle-of-least-surprise-can-introduce-subtle-bugs-to-your-code-8902cc51dc29\" rel=\"nofollow noreferrer\">The principle of least suprise.</a></p>\n"}], "owner": {"reputation": 51, "user_id": 12289413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dH0Ew.jpg?s=128&g=1", "display_name": "NewbieOnRails", "link": "https://stackoverflow.com/users/12289413/newbieonrails"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 58692626, "answer_count": 2, "score": 0, "last_activity_date": 1572875787, "creation_date": 1572846124, "last_edit_date": 1572875787, "question_id": 58687772, "link": "https://stackoverflow.com/questions/58687772/how-to-do-render-new-in-controller-and-do-not-lose-params-from-url", "title": "How to do render :new in controller and do not lose params from url?", "body": "<p>I want to do a <code>render :new</code> into my create method from a controller, the problem is, it change the url, and in the url I have a parameter needed to fill the form in my html (like: localhost3000/episodes/new?serie_id=8, I do this with a hidden_field_tag). </p>\n\n<p>My controller:</p>\n\n<pre><code>  def new\n    @episode= Episode.new\n  end\n\n  def create\n    # params = { episode: { name: valor, serie_id: valor, ... more} }\n    @episode = Episode.new(episode_permits)\n    if @episode.save\n      redirect_to @episode\n    else\n      render :new #This render I want to fix\n    end\n  end\n</code></pre>\n\n<p>My partial _form.html.erb:</p>\n\n<pre class=\"lang-erb prettyprint-override\"><code>  &lt;%= form_for @chapter do |f| %&gt;\n        &lt;%= f.label :name, 'Name' %&gt;\n        &lt;%= f.text_field :name%&gt; &lt;!-- I don't want to use required: true --&gt;\n        &lt;%= f.hidden_field :serie_id, value: params[:serie_id] %&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>If the user press the button which sumbit the form from new to create, if he makes a mistake filling the form, the @episode can't been save and makes the <code>render :new</code> and then the url change to localhost3000/episodes/</p>\n\n<p>How can I do for <code>render :new</code> do not change the url?</p>\n\n<p>I tried to instead of do <code>render :new</code> use <code>redirect_to new_episode_path(:serie_id =&gt; params[:episode][:serie_id])</code>, but that lost the what user enter to the form and any validates don't show what happened, so that's not an option.</p>\n\n<p>Just little more info about project if it's ambiguous: I'm making a Netflix web to learn Rails, a serie (name) has many episodes and an episode (name, serie_id) belongs to a serie.</p>\n"}, {"tags": ["ruby", "sqlite", "sequel"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1572844484, "post_id": 58686977, "comment_id": 103673484, "body": "Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>. We need to see a minimal code example that demonstrates the problem you&#39;re seeing."}, {"owner": {"reputation": 193, "user_id": 3719034, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/eb93ec3606471888fd1deefbf5db4363?s=128&d=identicon&r=PG", "display_name": "stephen", "link": "https://stackoverflow.com/users/3719034/stephen"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1572868843, "post_id": 58686977, "comment_id": 103683003, "body": "I apologize -- but I thought that&#39;s what the code example I included does? I&#39;ve never had problems with my questions in the past, and I&#39;m not sure what I should be doing different here. Thanks."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1572896830, "post_id": 58686977, "comment_id": 103696249, "body": "Notice that in the mcve document, that code has to be the minimal runnable code that demonstrates the problem. While snippets are often jumped on and people write all sorts of code around it just to test and try to help, that doesn&#39;t help the site. Your code should create a simple DB populate it with some data, the show how it works and doesn&#39;t work."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1572897540, "post_id": 58686977, "comment_id": 103696552, "body": "You&#39;re trying to add two symbols <code>:apples + :oranges</code>, hence the error. It works in the SQLite3 SQL query because you&#39;re sending that to the DBM, which knows that <code>apples</code> and <code>oranges</code> are columns. The <code>update</code> statement needs to know what the values are, so your final example works because the values are retrieved by the previous two lines. Turn on logging and Sequel will show you exactly what it&#39;s trying to do as it talks to the DBM. <a href=\"https://sequel.jeremyevans.net/rdoc/files/doc/cheat_sheet_rdoc.html#label-Logging+SQL+statements\" rel=\"nofollow noreferrer\">sequel.jeremyevans.net/rdoc/files/doc/&hellip;</a>"}, {"owner": {"reputation": 193, "user_id": 3719034, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/eb93ec3606471888fd1deefbf5db4363?s=128&d=identicon&r=PG", "display_name": "stephen", "link": "https://stackoverflow.com/users/3719034/stephen"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1572923230, "post_id": 58686977, "comment_id": 103703214, "body": "Thank you so much for your answers and your help with this. I&#39;ve edited my original question to try to match what you suggested above. Please let me know if I&#39;m more on the mark."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1572987244, "post_id": 58686977, "comment_id": 103731499, "body": "Good changes. It&#39;s not hard to define a test suite used to demonstrate what you&#39;re running into, and the process often reveals what the problem was, or presents a work-around."}], "answers": [{"tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": true, "score": 2, "last_activity_date": 1572987043, "last_edit_date": 1572987043, "creation_date": 1572921595, "answer_id": 58703712, "question_id": 58686977, "link": "https://stackoverflow.com/questions/58686977/how-to-add-multiple-columns-in-sequel/58703712#58703712", "title": "How to add multiple columns in Sequel", "body": "<p>I highly recommend reading through the Sequel <a href=\"https://sequel.jeremyevans.net/rdoc/files/doc/cheat_sheet_rdoc.html\" rel=\"nofollow noreferrer\">cheat sheet</a>, <a href=\"https://sequel.jeremyevans.net/rdoc/files/README_rdoc.html\" rel=\"nofollow noreferrer\">README</a> and then the documentation for the different classes. It's extremely powerful and, in my opinion, a great ORM.</p>\n\n<p>Meditate on this as a starting point for how to learn it. It'll also show a simple, but not the most efficient, way to do what you're asking about:</p>\n\n<pre><code>require 'sequel'\n\nrequire 'logger'\nDB = Sequel.sqlite(loggers: [Logger.new($stdout)])\n\nDB.create_table :fruitbaskets do\n  primary_key :id\n  Integer :apple\n  Integer :orange\n  Integer :total\nend\n\nfruitbaskets = DB[:fruitbaskets]\nfruitbaskets.insert(:apple =&gt; 1, :orange =&gt; 2, :total =&gt; 0)\n\nfruit_basket = fruitbaskets.where(:id =&gt; 1)\n\nfruit_basket.update(:total =&gt; fruit_basket.get([:apple, :orange]).sum) \n\nfruitbaskets.where(:id =&gt; 1).get([:apple, :orange, :total]) # =&gt; [1, 2, 3]\n# &gt;&gt; I, [2019-11-04T19:30:20.524611 #8709]  INFO -- : (0.000188s) PRAGMA foreign_keys = 1\n# &gt;&gt; I, [2019-11-04T19:30:20.524673 #8709]  INFO -- : (0.000013s) PRAGMA case_sensitive_like = 1\n# &gt;&gt; I, [2019-11-04T19:30:20.525058 #8709]  INFO -- : (0.000228s) CREATE TABLE `fruitbaskets` (`id` integer NOT NULL PRIMARY KEY AUTOINCREMENT, `apple` integer, `orange` integer, `total` integer)\n# &gt;&gt; I, [2019-11-04T19:30:20.525212 #8709]  INFO -- : (0.000060s) SELECT sqlite_version()\n# &gt;&gt; I, [2019-11-04T19:30:20.525331 #8709]  INFO -- : (0.000036s) INSERT INTO `fruitbaskets` (`apple`, `orange`, `total`) VALUES (1, 2, 0)\n# &gt;&gt; I, [2019-11-04T19:30:20.525477 #8709]  INFO -- : (0.000040s) SELECT `apple`, `orange` FROM `fruitbaskets` WHERE (`id` = 1) LIMIT 1\n# &gt;&gt; I, [2019-11-04T19:30:20.525558 #8709]  INFO -- : (0.000023s) UPDATE `fruitbaskets` SET `total` = 3 WHERE (`id` = 1)\n# &gt;&gt; I, [2019-11-04T19:30:20.525669 #8709]  INFO -- : (0.000037s) SELECT `apple`, `orange`, `total` FROM `fruitbaskets` WHERE (`id` = 1) LIMIT 1\n</code></pre>\n\n<p>Note:</p>\n\n<pre><code>fruit_basket = fruitbaskets.where(:id =&gt; 1)\n\nfruit_basket.update(:total =&gt; fruit_basket.get([:apple, :orange]).sum) \n</code></pre>\n\n<p>Sequel lets us build statements incrementally if its useful to our code. I'm pointing to a record and can then reuse the variable in different ways. This is really powerful and covered in the documentation. </p>\n"}], "owner": {"reputation": 193, "user_id": 3719034, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/eb93ec3606471888fd1deefbf5db4363?s=128&d=identicon&r=PG", "display_name": "stephen", "link": "https://stackoverflow.com/users/3719034/stephen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 58703712, "answer_count": 1, "score": -1, "last_activity_date": 1572987043, "creation_date": 1572839460, "last_edit_date": 1572923115, "question_id": 58686977, "link": "https://stackoverflow.com/questions/58686977/how-to-add-multiple-columns-in-sequel", "title": "How to add multiple columns in Sequel", "body": "<p>In this example:</p>\n\n<pre><code>require 'rubygems'\nrequire 'sqlite3'\nrequire 'sequel'\n\ndb = SQLite3::Database.new \"fruits.db\"\ndb2 = Sequel.sqlite(\"fruits.db\")\n\ndb.execute 'CREATE TABLE \"fruit\" (\"box_id\" INTEGER, \"apples\" INTEGER, \"oranges\" INTEGER, \"total\" INTEGER)'\n\ndb.execute \"INSERT INTO fruit(box_id,apples,oranges) VALUES(1,2,2)\"\n\nthisBox = db2[:fruit][:box_id =&gt; 1] \n</code></pre>\n\n<p>This works in SQLite3:</p>\n\n<pre><code>db.execute \"UPDATE fruit SET total = apples + oranges WHERE box_id=1\"\n</code></pre>\n\n<p>But I cannot come up with the same in one line in Sequel:</p>\n\n<pre><code>thisBox.update(:total =&gt; :apples + :oranges)\n</code></pre>\n\n<p>which returns the error:</p>\n\n<pre><code>undefined method '+' for :unfollows:Symbol\n</code></pre>\n\n<p>The only way around it I've found is:</p>\n\n<pre><code>apples = thisBox[:apples]\noranges = thisBox[:oranges]\n\nthisBox.update(:total =&gt; apples + oranges)\n</code></pre>\n"}, {"tags": ["ruby", "xml", "builder"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 2887748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WvkZK.png?s=128&g=1", "display_name": "Cody White", "link": "https://stackoverflow.com/users/2887748/cody-white"}, "edited": false, "score": 0, "creation_date": 1572892378, "post_id": 58693642, "comment_id": 103694593, "body": "Awesome! Thank you very much!"}], "tags": [], "owner": {"reputation": 124, "user_id": 6708657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffe34f136c0e2a6a18dd17783595aba1?s=128&d=identicon&r=PG&f=1", "display_name": "darkash", "link": "https://stackoverflow.com/users/6708657/darkash"}, "is_accepted": true, "score": 0, "last_activity_date": 1572871133, "creation_date": 1572871133, "answer_id": 58693642, "question_id": 58686921, "link": "https://stackoverflow.com/questions/58686921/builder-xml-dynamic-elements/58693642#58693642", "title": "Builder XML dynamic elements", "body": "<pre><code>require 'builder'\nx = Builder::XmlMarkup.new(:target =&gt; $stdout, :indent =&gt; 1)\nx.instruct!\nx.character do\n  stats = \"health, mana, armor\"\n  stats.split(\",\").each do |stat|\n    key = stat.strip.downcase\n    value = rand()\n    x.__send__(key, value)\n  end\nend\n</code></pre>\n\n<p>you can used ruby object method <code>send</code> or its alias <code>__send__</code>.\nBut since, <code>send</code> word can also be used for its key, only <strong>send</strong> is exposed for use to the object.\nThe doc for the mentioned methods:\n<a href=\"https://ruby-doc.org/core-2.6.5/Object.html#method-i-send\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.6.5/Object.html#method-i-send</a></p>\n\n<blockquote>\n  <p>Invokes the method identified by symbol, passing it any arguments\n  specified. You can use <code>__send__</code> if the name send clashes with an\n  existing method in obj. When the method is identified by a string, the\n  string is converted to a symbol.</p>\n</blockquote>\n\n<p>Just make sure to try limiting the scope of its usage since it's a powerful method, it can easily break stuffs.</p>\n"}], "owner": {"reputation": 15, "user_id": 2887748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WvkZK.png?s=128&g=1", "display_name": "Cody White", "link": "https://stackoverflow.com/users/2887748/cody-white"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 58693642, "answer_count": 1, "score": 0, "last_activity_date": 1572871133, "creation_date": 1572838906, "question_id": 58686921, "link": "https://stackoverflow.com/questions/58686921/builder-xml-dynamic-elements", "title": "Builder XML dynamic elements", "body": "<p>I am trying to run though a program and dynamically assign elements using the builder methods. While stepping through my procedure I am attempting to dynamically assign elements using variables. I have attempted a few options to have this variable pass though into the element but it is not working.</p>\n\n<p>I originally started by building my data in a hash however in my full procedure I have duplicate keys, so i had to move to something more direct.</p>\n\n<p>is it possible to achive my desired effect using builder </p>\n\n<pre><code>require 'builder'\nx = Builder::XmlMarkup.new(:target =&gt; $stdout, :indent =&gt; 1)\nx.instruct!\nx.character do\n  stats = \"health, mana, armor\"\n  stats.split(\",\").each do |stat|\n    key = stat.strip.downcase\n    value = rand()\n    x.key value\n  end #end do\nend #end do\n</code></pre>\n\n<p>Output </p>\n\n<pre><code>C:\\Projects&gt;ruby test.rb\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;character&gt;\n &lt;key&gt;0.1405191069855357&lt;/key&gt;\n &lt;key&gt;0.3484226234753265&lt;/key&gt;\n &lt;key&gt;0.4658284443108096&lt;/key&gt;\n&lt;/character&gt;\n</code></pre>\n\n<p>Desired output</p>\n\n<pre><code>C:\\Projects&gt;ruby test.rb\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;character&gt;\n &lt;health&gt;0.1405191069855357&lt;/health&gt;\n &lt;mana&gt;0.3484226234753265&lt;/mana&gt;\n &lt;armor&gt;0.4658284443108096&lt;/armor&gt;\n&lt;/character&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "helper", "ruby-on-rails-5.2"], "comments": [{"owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1572837606, "post_id": 58686598, "comment_id": 103672332, "body": "updated question, value1 and value2 are strings"}], "answers": [{"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 2, "creation_date": 1572845571, "post_id": 58687646, "comment_id": 103673719, "body": "Or use <code>concat</code>: <code>concat tag.del(&#39;value1&#39;)</code> and `concat &#39;value2&#39;."}, {"owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "edited": false, "score": 0, "creation_date": 1572899060, "post_id": 58687646, "comment_id": 103697108, "body": "I get undefined method `concat&#39; when I try it"}], "tags": [], "owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "is_accepted": false, "score": 1, "last_activity_date": 1572851548, "last_edit_date": 1572851548, "creation_date": 1572845350, "answer_id": 58687646, "question_id": 58686598, "link": "https://stackoverflow.com/questions/58686598/rails-tag-helper-is-not-displaying-as-expected/58687646#58687646", "title": "Rails tag helper is not displaying as expected", "body": "<p>Tags are just strings, you need to concatenate them. Also note that tags are escaped by default, so you do not need to call <code>h</code> on them.</p>\n\n<pre><code>def amount_html\n  tag.span do\n    tag.del do\n      'value1'\n    end + \n    'value2'\n  end\nend\n</code></pre>\n\n<p>Or as @mu pointed out, you can also use <a href=\"https://apidock.com/rails/ActionView/Helpers/TextHelper/concat\" rel=\"nofollow noreferrer\"><code>concat</code></a>, which adds each string to the output buffer without having to manually <code>+</code> them together:</p>\n\n<pre><code>tag.span do\n  concat tag.del('value1')\n  concat 'value2'\nend\n</code></pre>\n"}], "owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572851548, "creation_date": 1572835741, "last_edit_date": 1572837571, "question_id": 58686598, "link": "https://stackoverflow.com/questions/58686598/rails-tag-helper-is-not-displaying-as-expected", "title": "Rails tag helper is not displaying as expected", "body": "<pre><code>def amount_html\n  h.tag.span do\n    h.tag.del do\n      'value1'\n    end\n    'value2'\n  end\nend\n</code></pre>\n\n<p>I am getting:</p>\n\n<pre><code>&lt;span&gt; value2 &lt;/span&gt;\n</code></pre>\n\n<p>Instead of:</p>\n\n<pre><code>&lt;span&gt;&lt;del&gt;value1&lt;/dev&gt; value2 &lt;/span&gt;\n</code></pre>\n\n<p>Do I need to do a join or something? if so how?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec-rails", "rspec3"], "owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1578412943, "creation_date": 1572830892, "last_edit_date": 1578412943, "question_id": 58686162, "link": "https://stackoverflow.com/questions/58686162/configure-rspec-to-raise-an-error-when-calling-db-in-unit-tests", "title": "Configure RSpec to raise an error when calling DB in unit tests", "body": "<p>Snappy tests, especially unit tests, should be written and there is no question about it. How do I configure RSpec to raise an error when a database hit is detected in a test tagged as <code>:unit</code>. This enforces the strategy of writing snappy tests and avoiding database hits when it's not necessary.</p>\n\n<p>Right now, I have this code but it always raises an error, no matter what, even if I put a simple <code>puts \"Hello\"</code> in a test example.</p>\n\n<pre><code>config.around(:each, :unit) do |example|\n  callback = lambda { |name, start, finish, message_id, payload|\n    raise \"Nope! Accessing the database in a unit test is not allowed!!\\n\\n Offending Query\\n#{ payload[:sql] }\"\n  }\n  ActiveSupport::Notifications.subscribed(callback, \"sql.active_record\") do\n    example.run\n  end\nend\n</code></pre>\n\n<pre><code>RSpec.describe CategoryTranslationCreator, :unit do\n  it 'creates a category translation' do\n    puts \"Testing...\"\n  end\nend\n</code></pre>\n\n<p>raises</p>\n\n<pre><code>Got 0 failures and 2 other errors:\n\n     1.1) Failure/Error: raise \"Cannot access the database in a unit test!\\n\\n Offending Query\\n#{\"=\"*20}\\n#{ payload[:sql] }\"\n\n          RuntimeError:\n            Cannot access the database in a unit test!\n\n             Offending Query\n            ====================\n            BEGIN\n          # ./spec/rails_helper.rb:54:in `block (3 levels) in &lt;top (required)&gt;'\n          # /home/jedrek/.rvm/gems/ruby-2.4.0/gems/database_cleaner-1.7.0/lib/database_cleaner/active_record/transaction.rb:12:in `start'\n          # /home/jedrek/.rvm/gems/ruby-2.4.0/gems/database_cleaner-1.7.0/lib/database_cleaner/base.rb:90:in `start'\n          # /home/jedrek/.rvm/gems/ruby-2.4.0/gems/database_cleaner-1.7.0/lib/database_cleaner/configuration.rb:75:in `block in start'\n          # /home/jedrek/.rvm/gems/ruby-2.4.0/gems/database_cleaner-1.7.0/lib/database_cleaner/configuration.rb:75:in `each'\n          # /home/jedrek/.rvm/gems/ruby-2.4.0/gems/database_cleaner-1.7.0/lib/database_cleaner/configuration.rb:75:in `start'\n          # ./spec/support/database_cleaner.rb:12:in `block (2 levels) in &lt;top (required)&gt;'\n          # ./spec/rails_helper.rb:57:in `block (3 levels) in &lt;top (required)&gt;'\n          # ./spec/rails_helper.rb:56:in `block (2 levels) in &lt;top (required)&gt;'\n\n     1.2) Failure/Error: raise \"Cannot access the database in a unit test!\\n\\n Offending Query\\n#{\"=\"*20}\\n#{ payload[:sql] }\"\n\n          RuntimeError:\n            Cannot access the database in a unit test!\n\n             Offending Query\n            ====================\n            SELECT c.relname FROM pg_class c LEFT JOIN pg_namespace n ON n.oid = c.relnamespace WHERE n.nspname = ANY (current_schemas(false)) AND c.relkind IN ('r')\n          # ./spec/rails_helper.rb:54:in `block (3 levels) in &lt;top (required)&gt;'\n          # ./spec/support/database_cleaner.rb:19:in `block (2 levels) in &lt;top (required)&gt;'\n          # ./spec/rails_helper.rb:57:in `block (3 levels) in &lt;top (required)&gt;'\n          # ./spec/rails_helper.rb:56:in `block (2 levels) in &lt;top (required)&gt;'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "validation", "model"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 12289413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dH0Ew.jpg?s=128&g=1", "display_name": "NewbieOnRails", "link": "https://stackoverflow.com/users/12289413/newbieonrails"}, "edited": false, "score": 0, "creation_date": 1572904832, "post_id": 58685895, "comment_id": 103699219, "body": "Thanks, that worked very well, I just added <code>!(self.serie.expire_date).nil?</code> to the conditional statment to check if the serie doesn&#39;t has an expire_date."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 0, "last_activity_date": 1572827660, "creation_date": 1572827660, "answer_id": 58685895, "question_id": 58685816, "link": "https://stackoverflow.com/questions/58685816/validate-a-date-from-has-many-belongs-to-relation/58685895#58685895", "title": "Validate a date from has_many-belongs_to relation", "body": "<p>Just write your own <a href=\"https://guides.rubyonrails.org/active_record_validations.html#custom-methods\" rel=\"nofollow noreferrer\">validation method</a>:</p>\n\n<pre><code>class Episode &lt; ApplicationRecord\n  belongs_to :serie\n\n  validate :validate_expiry_date, \n    unless: -&gt;{ serie.nil? } #  # this prevents a potential nil error\n\n  private\n\n  def validate_expiry_date\n    if self.expire_date &gt; self.serie.expiry_date\n      errors.add(:expire_date, 'some sort of descriptive error message')\n    end\n  end\nend\n</code></pre>\n\n<p>No gems needed.</p>\n\n<p>A validation is just a method that tests a predicate and adds a error to the errors object it the validation fails.</p>\n"}], "owner": {"reputation": 51, "user_id": 12289413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dH0Ew.jpg?s=128&g=1", "display_name": "NewbieOnRails", "link": "https://stackoverflow.com/users/12289413/newbieonrails"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 58685895, "answer_count": 1, "score": 0, "last_activity_date": 1572827660, "creation_date": 1572826681, "question_id": 58685816, "link": "https://stackoverflow.com/questions/58685816/validate-a-date-from-has-many-belongs-to-relation", "title": "Validate a date from has_many-belongs_to relation", "body": "<p>I having the problem a of validate a date in a relation has_many/belong_to.\nI'm making a Netflix web to learn Rails and I want to validate the expire date of an episode is not after the expire date of the serie which belongs to that episode.</p>\n\n<p>I tried to do something like this (I'm using date-validator gem):</p>\n\n<p>A serie (name) has many episodes and an episode (name, serie_id) belongs to a serie, this is my code form now:</p>\n\n<pre><code>class Episode &lt; ApplicationRecord\n    belongs_to :serie\n    #validates :expire_date, date: { before: Serie.find(:serie_id).expire_date } #This line explodes, that's what I want to fix\nend\n\nclass Serie &lt; ApplicationRecord\n    has_many :episodes, dependent: :destroy\n}\nend\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby", "topological-sort"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1572844692, "post_id": 58685656, "comment_id": 103673529, "body": "Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>. We need the minimal code example, minimal input data to test it and the expected results."}, {"owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1573003244, "post_id": 58685656, "comment_id": 103736116, "body": "@theTinMan help me understand if this is not enough, but there are code examples with expected results in my question"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1573075097, "post_id": 58685656, "comment_id": 103767214, "body": "The &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot; document specifically says &quot;Make sure all information necessary to reproduce the problem is included in the question itself&quot;. That means it&#39;s runnable, demonstrates the problem and we don&#39;t have to put together a test harness because you&#39;ve supplied the input and your expected results and what went wrong. The more code we have to write just to try to get your code to run, the further from your example code we get, reducing the accuracy and conciseness of the answer. If we ran your code what would happen?"}, {"owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1573080502, "post_id": 58685656, "comment_id": 103769040, "body": "I have made light edits to add the missing closing parenthesis in the graph definition and changed the interface of my function to take the graph as the first parameter, so that you can indeed just copy paste the code in an irb terminal (the definition of the graph + the function) and running <code>incomplete_function_to_get_tsorted_subgraphs(graph, :b) </code>will work."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1573083070, "post_id": 58685656, "comment_id": 103769710, "body": "Excellent. It&#39;s important the code run otherwise questions are off-topic due to syntax errors or not including code that demonstrates the problem."}], "answers": [{"tags": [], "owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "is_accepted": true, "score": 0, "last_activity_date": 1590619734, "creation_date": 1590619734, "answer_id": 62054111, "question_id": 58685656, "link": "https://stackoverflow.com/questions/58685656/find-and-sort-topologically-all-trees-including-a-given-group-of-nodes-from-a-de/62054111#62054111", "title": "Find and sort topologically all trees including a given group of nodes from a dependency graph", "body": "<p>What I ended up doing : </p>\n\n<p>From the stat I need to compute, always go up to the leaf nodes with the most dependencies (so if I need to compute :b, always assume you need find :c) with a function like this (the implementation can most likely be improved)</p>\n\n<pre><code>def find_leaf_nodes(node_name)\n  parents = all_nodes.select { |_,node| node.dependencies.include?(name) }\n  if parents.any?\n    parents.flat_map { |parent_name, _| find_leaf_nodes(parent_name) }\n  else\n    name\n  end\nend\n</code></pre>\n\n<p>And then just build the TSorted dependency list from here using the code I mentioned in the question</p>\n"}], "owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 62054111, "answer_count": 1, "score": 0, "last_activity_date": 1590619734, "creation_date": 1572824936, "last_edit_date": 1573080535, "question_id": 58685656, "link": "https://stackoverflow.com/questions/58685656/find-and-sort-topologically-all-trees-including-a-given-group-of-nodes-from-a-de", "title": "Find and sort topologically all trees including a given group of nodes from a dependency graph", "body": "<p>Assume I have the following graph of dependencies ( <code>A =&gt; [B]</code> means A depends/requires B to update its value before the value of A can be updated). I am using a Ruby hash and the TSort module for topological operations.</p>\n\n<pre><code>graph = {\n  a: OpenStruct.new(dependencies: []),\n  b: OpenStruct.new(dependencies: [:a]),\n  c: OpenStruct.new(dependencies: [:b]),\n  d: OpenStruct.new(dependencies: []),\n  e: OpenStruct.new(dependencies: [:d]),\n  f: OpenStruct.new(dependencies: []),\n}\n# Which gives 3 dependency trees\n:c =&gt; :b =&gt; :a, :e =&gt; :d, :f \n</code></pre>\n\n<p>Given any group of nodes, I need to find and sort topologically the nodes that need to be updated, including (recursively) the parents and children of this group of nodes. That is, all the dependency trees that include those nodes, and not just the dependencies up to those nodes in the trees.</p>\n\n<p>Here are some examples (regarding the output, I can cope with either an array of TSorted graphs, or just a flattened version, I don't care, cf example 3) <em>but the array of tsorted graphs is easier to spec as you'll see below.</em></p>\n\n<pre><code>desired_function(:a) == [:c,:b,:a] # or [[:c,:b,:a]]\ndesired_function(:b) == [:c,:b,:a] # or [[:c,:b,:a]]\ndesired_function(:c) == [:c,:b,:a] # or [[:c,:b,:a]]\ndesired_function(:c,:d) == [:c,:b,:a,:d,:e] # or [:d,:e,:c,:b,:a] or [[:d,:e], [:c,:b,:a]], or [[:c,:b,:a], [:d,:e]]\ndesired_function(:f) == [:f] # or [[:f]]\n</code></pre>\n\n<p>I have tried implementing a TSort algorithm, but I'm  not sure how I can specify that I also need to include the parents of the node I am requesting the tsort from</p>\n\n<p>My current implementation (on the <code>graph</code> given above)</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def incomplete_function_to_get_tsorted_subgraphs(graph, node_names) \n  each_node = lambda { |&amp;b| graph.slice(*node_names).each_key(&amp;b) }\n  each_child = lambda do |node_name, &amp;b|\n    graph[node_name].dependencies.each(&amp;b)\n  end\n  TSort.tsort(each_node, each_child)\nend\n</code></pre>\n\n<p>It is incomplete as currently it will only get dependencies up to the requested nodes <code>incomplete_function_to_get_tsorted_subgraphs(graph, :b) # returns [:a, :b] instead of [:a,:b,:c]</code> If I remove the <code>slice</code> then it just becomes a tsort on the full graph which isn't what I want (and I would need to prune it somehow)</p>\n\n<p>The specs for what I want to achieve (assuming we are returning arrays of tsorted dependency graphs)</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>expect(complete_function_to_get_tsorted_subgraphs(:b)).to include([:a,:b,:c])\n\nexpect(complete_function_to_get_tsorted_subgraphs(:b,:d).to \n  include([:a,:b,:c], [:d, :e])\n</code></pre>\n\n<p>Am I going the right way with using the TSort algorithm, and can you help me fix my function, or do I have to go a totally different path to get what I want ?</p>\n"}, {"tags": ["ruby", "class", "methods", "getter-setter"], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1572830281, "post_id": 58685364, "comment_id": 103671099, "body": "Note: <code>&quot;My dog has ______fleas.&quot;.split(&#39; &#39;).join(&#39; &#39;) #=&gt; &quot;My dog has fleas.&quot;</code>, where the underscores represent extra spaces (which, if they were spaces, would be removed by SO)."}, {"owner": {"reputation": 1202, "user_id": 147204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e593ac63e5f25649b701dc25f69d1b7?s=128&d=identicon&r=PG", "display_name": "luis.parravicini", "link": "https://stackoverflow.com/users/147204/luis-parravicini"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1572860638, "post_id": 58685364, "comment_id": 103679054, "body": "@CarySwoveland yes, but I don&#39;t know if that would be a problem."}], "tags": [], "owner": {"reputation": 1202, "user_id": 147204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e593ac63e5f25649b701dc25f69d1b7?s=128&d=identicon&r=PG", "display_name": "luis.parravicini", "link": "https://stackoverflow.com/users/147204/luis-parravicini"}, "is_accepted": false, "score": 0, "last_activity_date": 1572822168, "last_edit_date": 1572822168, "creation_date": 1572821700, "answer_id": 58685364, "question_id": 58685168, "link": "https://stackoverflow.com/questions/58685168/ruby-capitalize-a-title-using-map-and-capitalize-methods/58685364#58685364", "title": "Ruby - Capitalize a title using map and capitalize methods", "body": "<p>You are using <code>@title</code> before it's assigned in</p>\n\n<pre><code>new_title = @title.split(\" \")\n</code></pre>\n\n<p>It should be changed to <code>title</code>.</p>\n\n<p>You don't assign the calculated title to <code>@title</code> at the end of the <code>title=</code> method.</p>\n\n<p>You also need to add 'an' to <code>no_cap</code> in order to pass the spec using \"to eat an apple a day\" as title.</p>\n\n<p>And take care of the first word:</p>\n\n<pre><code>class Book\n  def title\n      @title\n  end \n\n  def title=(title)\n      no_cap = [\"if\", \"or\", \"in\", \"a\", \"and\", 'an', \"the\", \"of\", \"to\"]\n      new_title = title.split(' ').each_with_index.map do |x, i|\n          unless i != 0 &amp;&amp; no_cap.include?(x)\n            x.capitalize\n          else\n            x\n          end\n      end\n\n      @title = new_title.join(' ')\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 447, "user_id": 2628557, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChwLa.jpg?s=128&g=1", "display_name": "ronnie bermejo", "link": "https://stackoverflow.com/users/2628557/ronnie-bermejo"}, "edited": false, "score": 2, "creation_date": 1572836125, "post_id": 58685859, "comment_id": 103672093, "body": "those are very very <code>small_words</code> by the way !"}, {"owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 0, "creation_date": 1572924619, "post_id": 58685859, "comment_id": 103703445, "body": "According to AP style, the list of words that are not capitalized in titles is <i>a, an, and, at, but, by, for, in, nor, of, on, or, out, so, the, to, up</i> and <i>yet</i>. (<i>If</i> isn&#39;t one of them.) Also, <i>at, by, for, in, of, out, so, to, up</i> and <i>yet</i> are not capitalized when used as prepositions, but capitalized when used as adverbs, e.g. <i>Joe Pulls the Door To</i>, <i>Clemson Has Yet to Lose</i>, <i>Jill Looks Up a Friend</i>, etc. So, the solution is more complicated than this unless the OP is simplifying the rules, in which case he might need to state his rules more clearly."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 0, "creation_date": 1572934063, "post_id": 58685859, "comment_id": 103705520, "body": "@Bob, hmmm. More than a minor tweak to determine if a small word is being used as an adverb, but I doubt that&#39;s the goal of the exercise. I expect many readers would hard pressed to explain what an adverb is. I learned that in the 6th grade, by diagramming sentences."}, {"owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 0, "creation_date": 1573188938, "post_id": 58685859, "comment_id": 103808279, "body": "@CarySwoveland I doubt it too, because it&#39;s certainly non-trivial and rather an edge case of the problem of &quot;correctly&quot; capitalizing titles. But I thought it was worth mentioning, since we humans have a way of believing we have solved a broader problem than we have actually solved when solving a subset of a problem."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1572842482, "last_edit_date": 1592644375, "creation_date": 1572827171, "answer_id": 58685859, "question_id": 58685168, "link": "https://stackoverflow.com/questions/58685168/ruby-capitalize-a-title-using-map-and-capitalize-methods/58685859#58685859", "title": "Ruby - Capitalize a title using map and capitalize methods", "body": "<p><code>small_words = [</code><sub><sup><sub><sup>&quot;if&quot;, &quot;or&quot;, &quot;in&quot;, &quot;a&quot;, &quot;and&quot;, &quot;the&quot;, &quot;of&quot;, &quot;to&quot;</sup></sub></sup></sub><code>]</code></p>\n<h1><p></p></h1>\n<pre><code>str = &quot;tO be      Or Not to be.&quot;\n</code></pre>\n<h1><p></p></h1>\n<pre><code>str.gsub(/\\p{Alpha}+/) { |s| Regexp.last_match.begin(0) &gt; 0 &amp;&amp;\n  small_words.include?(s.downcase) ? s.downcase : s.capitalize }\n  #=&gt; &quot;To Be      or Not to Be.&quot;\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 12317510, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBc1CEmeqLFHYuMWRsgb7KA91_YhlOV69qCYvIMcQ=k-s128", "display_name": "Mo102", "link": "https://stackoverflow.com/users/12317510/mo102"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1572842482, "creation_date": 1572819846, "last_edit_date": 1572825341, "question_id": 58685168, "link": "https://stackoverflow.com/questions/58685168/ruby-capitalize-a-title-using-map-and-capitalize-methods", "title": "Ruby - Capitalize a title using map and capitalize methods", "body": "<p>I'm working through The Odin Projects Ruby basics and completely stuck on 05_book_titles. \nThe title needs to be capitalized, including the 1st word but not including \"small words\" (ie \"to\", \"the\", etc) UNLESS it's the 1st word.\nI can't get the code to do anything besides capitalize everything. Am I misusing map method? How can I get it to include the no_cap words in the returned title without capitalizing?</p>\n\n<p>The Ruby file:</p>\n\n<pre><code>class Book\ndef title\n    @title\nend \n\ndef title=(title)\n    no_cap = [\"if\", \"or\", \"in\", \"a\", \"and\", \"the\", \"of\", \"to\"]\n    p new_title = @title.split(\" \")\n    p new_new_title = new_title.map{|i| i.capitalize if !no_cap.include? i}\n.join(\" \") \nend\nend\n</code></pre>\n\n<p>Some of the Spec file:</p>\n\n<pre><code>require 'book'\n\ndescribe Book do\n\n  before do\n    @book = Book.new\n  end\n\n  describe 'title' do\n    it 'should capitalize the first letter' do\n      @book.title = \"inferno\"\n      expect(@book.title).to eq(\"Inferno\")\n    end\n\n    it 'should capitalize every word' do\n      @book.title = \"stuart little\"\n      expect(@book.title).to eq(\"Stuart Little\")\n    end\n\n    describe 'should capitalize every word except...' do\n      describe 'articles' do\n        specify 'the' do\n          @book.title = \"alexander the great\"\n          expect(@book.title).to eq(\"Alexander the Great\")\n        end\n\n        specify 'a' do\n          @book.title = \"to kill a mockingbird\"\n          expect(@book.title).to eq(\"To Kill a Mockingbird\")\n        end\n\n        specify 'an' do\n          @book.title = \"to eat an apple a day\"\n          expect(@book.title).to eq(\"To Eat an Apple a Day\")\n        end\n      end\n\n      specify 'conjunctions' do\n        @book.title = \"war and peace\"\n        expect(@book.title).to eq(\"War and Peace\")\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>Book\n  title\n    should capitalize the first letter (FAILED - 1)\n\nFailures:\n\n  1) Book title should capitalize the first letter\n     Failure/Error: @book.title = \"inferno\"\n\n     NoMethodError:\n       undefined method `split' for nil:NilClass\n     # ./05_book_titles/book.rb:8:in `title='\n     # ./05_book_titles/book_titles_spec.rb:25:in `block (3 levels) in &lt;top (required)&gt;'\n\nFinished in 0.0015 seconds (files took 0.28653 seconds to load)\n1 example, 1 failure\n\nFailed examples:\n\nrspec ./05_book_titles/book_titles_spec.rb:24 # Book title should capitalize the first letter\n</code></pre>\n"}, {"tags": ["ruby", "dna-sequence"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1572818747, "post_id": 58684821, "comment_id": 103669258, "body": "What does the first argument to <code>shared_kmers</code> mean? The number you&#39;re passing from 2-5."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1572844994, "post_id": 58684821, "comment_id": 103673600, "body": "&quot;The problem is to write the method shared_kmers(k, dna2)...&quot; which sounds very much like homework. &quot;<a href=\"https://meta.stackoverflow.com/q/334822/128421\">How do I ask and answer homework questions?</a>&quot; will help you understand the SO opinion of homework problems. Remember that SO is an extremely visible site, visited by teachers and students alike, so your question could very well be visible to someone who expects you to answer it on your own."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1572901264, "post_id": 58685344, "comment_id": 103697884, "body": "Good answer. I tiny suggestion, so tiny that it may not even deserve mention: by replacing <code>chars</code> with <code>each_char</code> in <code>@sequencing.chars.each_cons(k)</code> you can avoid the creation of a temporary array. The rule: use <code>each_char</code> when chained to an <code>Enumerator</code> or <code>Enumerable</code> method; use <code>chars</code> when it is not chained or is chained to an <code>Array</code> method."}, {"owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1572902249, "post_id": 58685344, "comment_id": 103698230, "body": "I got it. Thanks for suggestion @CarySwoveland"}], "tags": [], "owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "is_accepted": true, "score": 3, "last_activity_date": 1572902239, "last_edit_date": 1572902239, "creation_date": 1572821482, "answer_id": 58685344, "question_id": 58684821, "link": "https://stackoverflow.com/questions/58684821/how-to-find-indices-of-identical-sub-sequences-in-two-strings-in-ruby/58685344#58685344", "title": "How to find indices of identical sub-sequences in two strings in Ruby?", "body": "<pre><code>class DNA\n  attr_accessor :sequencing\n\n  def initialize(sequencing)\n    @sequencing = sequencing\n  end\n\n  def kmers(k)\n    @sequencing.each_char.each_cons(k).map(&amp;:join)\n  end\n\n  def shared_kmers(k, dna)\n    kmers(k).each_with_object([]).with_index do |(kmer, result), index|\n      dna.kmers(k).each_with_index do |other_kmer, other_kmer_index|\n        result &lt;&lt; [index, other_kmer_index] if kmer.eql?(other_kmer)\n      end\n    end\n  end\nend\n\ndna1 = DNA.new('GCCCAC')\ndna2 = DNA.new('CCACGC')\n\ndna1.kmers(2)\n#=&gt; [\"GC\", \"CC\", \"CC\", \"CA\", \"AC\"]\n\ndna2.kmers(2)\n#=&gt; [\"CC\", \"CA\", \"AC\", \"CG\", \"GC\"]\n\ndna1.shared_kmers(2, dna2)\n#=&gt; [[0, 4], [1, 0], [2, 0], [3, 1], [4, 2]]\n\ndna2.shared_kmers(2, dna1)\n#=&gt; [[0, 1], [0, 2], [1, 3], [2, 4], [4, 0]]\n\ndna1.shared_kmers(3, dna2)\n#=&gt; [[2, 0], [3, 1]]\n\ndna1.shared_kmers(4, dna2)\n#=&gt; [[2, 0]]\n\ndna1.shared_kmers(5, dna2)\n#=&gt; []\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1572900453, "last_edit_date": 1572900453, "creation_date": 1572854523, "answer_id": 58689277, "question_id": 58684821, "link": "https://stackoverflow.com/questions/58684821/how-to-find-indices-of-identical-sub-sequences-in-two-strings-in-ruby/58689277#58689277", "title": "How to find indices of identical sub-sequences in two strings in Ruby?", "body": "<p>I will address the crux of your problem only, without reference to a class <code>DNA</code>. It should be easy to reorganize what follows quite easily.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>def match_kmers(s1, s2, k)\n  h1 = dna_to_index(s1, k)\n  h2 = dna_to_index(s2, k)\n  h1.flat_map { |k,_| h1[k].product(h2[k] || []) }\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>def dna_to_index(dna, k)\n  dna.each_char.\n      with_index.\n      each_cons(k).\n      with_object({}) {|arr,h| (h[arr.map(&amp;:first).join] ||= []) &lt;&lt; arr.first.last}\nend\n</code></pre>\n\n<p><strong>Examples</strong></p>\n\n<pre><code>dna1 = 'GCCCAC'\ndna2 = 'CCACGC'\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>match_kmers(dna1, dna2, 2)\n  #=&gt; [[0, 4], [1, 0], [2, 0], [3, 1], [4, 2]] \nmatch_kmers(dna2, dna1, 2)\n  #=&gt; [[0, 1], [0, 2], [1, 3], [2, 4], [4, 0]] \n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>match_kmers(dna1, dna2, 3)\n  #=&gt; [[2, 0], [3, 1]] \nmatch_kmers(dna2, dna1, 3)\n  #=&gt; [[0, 2], [1, 3]] \n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>match_kmers(dna1, dna2, 4)\n  #=&gt; [[2, 0]] \nmatch_kmers(dna2, dna1, 4)\n  #=&gt; [[0, 2]] \n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>match_kmers(dna1, dna2, 5)\n  #=&gt; [] \nmatch_kmers(dna2, dna1, 5)\n  #=&gt; [] \n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>match_kmers(dna1, dna2, 6)\n  #=&gt; [] \nmatch_kmers(dna2, dna1, 6)\n  #=&gt; [] \n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>Consider <code>dna1 = 'GCCCAC'</code>. This contains 5 2-mers (<code>k = 2</code>):</p>\n\n<pre><code>dna1.each_char.each_cons(2).to_a.map(&amp;:join)\n  #=&gt; [\"GC\", \"CC\", \"CC\", \"CA\", \"AC\"] \n</code></pre>\n\n<p>Similarly, for <code>dna2 = 'CCACGC'</code>:</p>\n\n<pre><code>dna2.each_char.each_cons(2).to_a.map(&amp;:join)\n  #=&gt; [\"CC\", \"CA\", \"AC\", \"CG\", \"GC\"]\n</code></pre>\n\n<p>These are the keys of the hashes produced by <code>dna_to_index</code> for <code>dna1</code> and <code>dna2</code>, respectively. The hash values are arrays of indices of where the corresponding key begins in the DNA string. Let's compute those hashes for <code>k = 2</code>:</p>\n\n<pre><code>h1 = dna_to_index(dna1, 2)\n  #=&gt; {\"GC\"=&gt;[0], \"CC\"=&gt;[1, 2], \"CA\"=&gt;[3], \"AC\"=&gt;[4]} \nh2 = dna_to_index(dna2, 2)\n  #=&gt; {\"CC\"=&gt;[0], \"CA\"=&gt;[1], \"AC\"=&gt;[2], \"CG\"=&gt;[3], \"GC\"=&gt;[4]} \n</code></pre>\n\n<p><code>h1</code> shows that:</p>\n\n<ul>\n<li><code>\"GC\"</code> begins at index 0 of <code>dna1</code></li>\n<li><code>\"CC\"</code> begins at indices 1 and 2 of <code>dna1</code></li>\n<li><code>\"CA\"</code> begins at index 3 of <code>dna1</code></li>\n<li><code>\"CC\"</code> begins at index 4 of <code>dna1</code></li>\n</ul>\n\n<p><code>h2</code> has a similar interpretation. See <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-flat_map\" rel=\"nofollow noreferrer\">Enumerable#flat_map</a> and <a href=\"https://ruby-doc.org/core-2.6.3/Array.html#method-i-product\" rel=\"nofollow noreferrer\">Array#product</a>.</p>\n\n<p>The method <code>match_kmers</code> is then used to construct the desired array of pairs of indices <code>[i, j]</code> such that <code>h1[i] = h2[j]</code>.</p>\n\n<p>Now let's look at the hashes produced for 3-mers (<code>k = 3</code>):</p>\n\n<pre><code>h1 = dna_to_index(dna1, 3)\n  #=&gt; {\"GCC\"=&gt;[0], \"CCC\"=&gt;[1], \"CCA\"=&gt;[2], \"CAC\"=&gt;[3]} \nh2 = dna_to_index(dna2, 3)\n  #=&gt; {\"CCA\"=&gt;[0], \"CAC\"=&gt;[1], \"ACG\"=&gt;[2], \"CGC\"=&gt;[3]} \n</code></pre>\n\n<p>We see that the first 3-mer in <code>dna1</code> is <code>\"GCC\"</code>, beginning at index 0. This 3-mer does not appear in <code>dna2</code>, however, so there are no elements <code>[0, X]</code> in the array returned (<code>X</code> being just a placeholder). Nor is <code>\"CCC\"</code> a key in the second hash. <code>\"CCA\"</code> and <code>\"CAC\"</code> are present in the second hash, however, so the array returned is:</p>\n\n<pre><code>h1[\"CCA\"].product(h2[\"CCA\"]) + h1[\"CAC\"].product(h2[\"CAC\"]) \n  #=&gt; [[2, 0]] + [[3, 1]]\n  #=&gt; [[2, 0], [3, 1]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 1, "last_activity_date": 1572859281, "last_edit_date": 1572859281, "creation_date": 1572858527, "answer_id": 58690133, "question_id": 58684821, "link": "https://stackoverflow.com/questions/58684821/how-to-find-indices-of-identical-sub-sequences-in-two-strings-in-ruby/58690133#58690133", "title": "How to find indices of identical sub-sequences in two strings in Ruby?", "body": "<p>I would start by writing a method to enumerate subsequences of a given length (i.e. the k-mers):</p>\n\n<pre><code>class DNA\n  def initialize(sequence)\n    @sequence = sequence\n  end\n\n  def each_kmer(length)\n    return enum_for(:each_kmer, length) unless block_given?\n\n    0.upto(@sequence.length - length) { |i| yield @sequence[i, length] }\n  end\nend\n\nDNA.new('GCCCAC').each_kmer(2).to_a\n#=&gt; [\"GC\", \"CC\", \"CC\", \"CA\", \"AC\"]\n</code></pre>\n\n<p>On top of this you can easily collect the indices of identical k-mers using a nested loop:</p>\n\n<pre><code>class DNA\n  # ...\n\n  def shared_kmers(length, other)\n    indices = []\n    each_kmer(length).with_index do |k, i|\n      other.each_kmer(length).with_index do |l, j|\n        indices &lt;&lt; [i, j] if k == l\n      end\n    end\n    indices\n  end\nend\n\ndna1 = DNA.new('GCCCAC')\ndna2 = DNA.new('CCACGC')\n\ndna1.shared_kmers(2, dna2)\n#=&gt; [[0, 4], [1, 0], [2, 0], [3, 1], [4, 2]]\n</code></pre>\n\n<p>Unfortunately, the above code traverses <code>other.each_kmer</code> for each k-mer in the receiver. We can optimize this by building a hash containing all indices for each k-mer in <code>other</code> up-front:</p>\n\n<pre><code>class DNA\n  # ...\n\n  def shared_kmers(length, other)\n    hash = Hash.new { |h, k| h[k] = [] }\n    other.each_kmer(length).with_index { |k, i| hash[k] &lt;&lt; i }\n\n    indices = []\n    each_kmer(length).with_index do |k, i|\n      hash[k].each { |j| indices &lt;&lt; [i, j] }\n    end\n    indices\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 12166912, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-yDhckH8plxA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfQnvMzxaOjs7vsiQJRsy_Puzt2ag/photo.jpg?sz=128", "display_name": "kujak al", "link": "https://stackoverflow.com/users/12166912/kujak-al"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 58685344, "answer_count": 3, "score": 4, "last_activity_date": 1572902239, "creation_date": 1572816881, "last_edit_date": 1572858646, "question_id": 58684821, "link": "https://stackoverflow.com/questions/58684821/how-to-find-indices-of-identical-sub-sequences-in-two-strings-in-ruby", "title": "How to find indices of identical sub-sequences in two strings in Ruby?", "body": "<p>Here each instance of the class <code>DNA</code> corresponds to a string such as <code>'GCCCAC'</code>. Arrays of substrings containing <em>k-mers</em> can be constructed from these strings. For this string there are 1-mers, 2-mers, 3-mers, 4-mers, 5-mers and one 6-mer:</p>\n\n<ul>\n<li>6 1-mers: <code>[\"G\", \"C\", \"C\", \"C\", \"A\", \"C\"]</code></li>\n<li>5 2-mers: <code>[\"GC\", \"CC\", \"CC\", \"CA\", \"AC\"]</code> </li>\n<li>4 3-mers: <code>[\"GCC\", \"CCC\", \"CCA\", \"CAC\"]</code> </li>\n<li>3 4-mers: <code>[\"GCCC\", \"CCCA\", \"CCAC\"]</code></li>\n<li>2 5-mers: <code>[\"GCCCA\", \"CCCAC\"]</code></li>\n<li>1 6-mers: <code>[\"GCCCAC\"]</code></li>\n</ul>\n\n<p>The pattern should be evident. See the <a href=\"https://en.wikipedia.org/wiki/K-mer\" rel=\"nofollow noreferrer\">Wiki</a> for details.</p>\n\n<p>The problem is to write the method shared_kmers(k, dna2) of the DNA class which returns an array of all pairs [i, j] where this DNA object (that receives the message) shares with dna2 a common k-mer at position i in this dna and at position j in dna2.</p>\n\n<pre><code>dna1 = DNA.new('GCCCAC')\ndna2 = DNA.new('CCACGC')\n\ndna1.shared_kmers(2, dna2)\n#=&gt; [[0, 4], [1, 0], [2, 0], [3, 1], [4, 2]]\n\ndna2.shared_kmers(2, dna1)\n#=&gt; [[0, 1], [0, 2], [1, 3], [2, 4], [4, 0]]\n\ndna1.shared_kmers(3, dna2)\n#=&gt; [[2, 0], [3, 1]]\n\ndna1.shared_kmers(4, dna2)\n#=&gt; [[2, 0]]\n\ndna1.shared_kmers(5, dna2)\n#=&gt; []\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "ruby-on-rails-5", "factory-bot"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 8370521, "user_type": "registered", "profile_image": "https://graph.facebook.com/1700485353324773/picture?type=large", "display_name": "Fernando Karchiloff", "link": "https://stackoverflow.com/users/8370521/fernando-karchiloff"}, "edited": false, "score": 0, "creation_date": 1572818723, "post_id": 58684741, "comment_id": 103669252, "body": "Thanks! That is exactly what was missing! I had found a issue in FactoryBot repository talking about this, they said a change would be made to throw a more specific error, but it still returns the generic error. Link to the issue comment that tells about this: <a href=\"https://github.com/thoughtbot/factory_bot/issues/1264#issuecomment-462759569\" rel=\"nofollow noreferrer\">github.com/thoughtbot/factory_bot/issues/&hellip;</a> Thanks Sebastian !"}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 1, "last_activity_date": 1572816098, "creation_date": 1572816098, "answer_id": 58684741, "question_id": 58684575, "link": "https://stackoverflow.com/questions/58684575/how-to-fix-undefined-method-enum-in-rspec-test-with-factorybot/58684741#58684741", "title": "How to fix &#39;undefined method&#39; enum in rspec test with FactoryBot?", "body": "<p>It's a matter of naming clashing.</p>\n\n<p>You must wrap the value of the <code>status</code> column within curly brackets otherwise it'll call itself:</p>\n\n<pre><code>FactoryBot.define do\n  factory :college_whitelist do\n    ...\n\n    trait :pending do\n      status {\u00a0:pending }\n    end\n\n    trait :approved do\n      status { :approved }\n    end\n\n    trait :rejected do\n      status { :rejected }\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 8370521, "user_type": "registered", "profile_image": "https://graph.facebook.com/1700485353324773/picture?type=large", "display_name": "Fernando Karchiloff", "link": "https://stackoverflow.com/users/8370521/fernando-karchiloff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 361, "favorite_count": 0, "accepted_answer_id": 58684741, "answer_count": 1, "score": 1, "last_activity_date": 1572816098, "creation_date": 1572814853, "question_id": 58684575, "link": "https://stackoverflow.com/questions/58684575/how-to-fix-undefined-method-enum-in-rspec-test-with-factorybot", "title": "How to fix &#39;undefined method&#39; enum in rspec test with FactoryBot?", "body": "<p>I'm trying to test an model I had created for my application, it has association with two other models, also using Factory Bot to build the test, however it does not recognize it, the error return is: <code>Failure/Error: status :pending //// NoMethodError: undefined method 'status' in 'pending' factory.</code></p>\n\n<p>I'm running the application with Ruby 2.6.1, Rails 5.2.3, FactoryBot 5.0.2, Rspec 3.8. I've tried the different ways to define an enum. I don't know what to do more.</p>\n\n<p>Model:</p>\n\n<pre><code>class CollegeWhitelist &lt; ApplicationRecord\n    enum status: {pending: 0, approved: 1, rejected: 2}\n\n    has_many :users\n    has_many :colleges\nend\n</code></pre>\n\n<p>Factory:</p>\n\n<pre><code>FactoryBot.define do\n  factory :college_whitelist do\n    association :user\n    association :college\n\n    trait :pending do\n      status :pending\n    end\n\n    trait :approved do\n      status :approved\n    end\n\n    trait :rejected do\n      status :rejected\n    end\n  end\nend\n</code></pre>\n\n<p>Rspec:</p>\n\n<pre><code>require 'rails_helper'\n\nRSpec.describe CollegeWhitelist, type: :model do\n  describe \"#consistency \" do\n    it 'cannot insert the same user for the same college in permissions' do\n      @permission = build(:college_whitelist)\n      p @permission\n    end\n  end\nend\n\n</code></pre>\n\n<p>I was expecting it to pass the test just printing the object at first.</p>\n"}, {"tags": ["ruby", "jekyll", "liquid", "jekyll-extensions"], "answers": [{"comments": [{"owner": {"reputation": 1086, "user_id": 7274239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95a8acb728ffccfef0396e6de6d0e553?s=128&d=identicon&r=PG&f=1", "display_name": "Jan \u010cern&#253;", "link": "https://stackoverflow.com/users/7274239/jan-%c4%8cern%c3%bd"}, "edited": false, "score": 0, "creation_date": 1572857974, "post_id": 58686831, "comment_id": 103677842, "body": "Thanks, this works. But, is there another way to do that within plugin and keep markdown clean without html tags ?"}, {"owner": {"reputation": 4449, "user_id": 7681659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47bc1a3b7231505d61b7f80642bc1a14?s=128&d=identicon&r=PG&f=1", "display_name": "ashmaroli", "link": "https://stackoverflow.com/users/7681659/ashmaroli"}, "reply_to_user": {"reputation": 1086, "user_id": 7274239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95a8acb728ffccfef0396e6de6d0e553?s=128&d=identicon&r=PG&f=1", "display_name": "Jan \u010cern&#253;", "link": "https://stackoverflow.com/users/7274239/jan-%c4%8cern%c3%bd"}, "edited": false, "score": 1, "creation_date": 1572874852, "post_id": 58686831, "comment_id": 103685937, "body": "Actually, no. The reason is that Jekyll&#39;s Markdown converter (wrapper for <code>kramdown</code>) is run after all Liquid in the current document has finished rendering. When <code>kramdown</code> encounters a standalone text surrounded by whitespace, it renders that text into HTML <code>&lt;p&gt;</code> tags.. If you want to handle this entirely via plugins, you&#39;ll have to drop using Liquid Tag and instead rely on string substitution via the <code>post_render</code> hook. You may want to look at the source code for <code>jemoji</code> plugin for reference."}], "tags": [], "owner": {"reputation": 4449, "user_id": 7681659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47bc1a3b7231505d61b7f80642bc1a14?s=128&d=identicon&r=PG&f=1", "display_name": "ashmaroli", "link": "https://stackoverflow.com/users/7681659/ashmaroli"}, "is_accepted": false, "score": 1, "last_activity_date": 1572838075, "creation_date": 1572838075, "answer_id": 58686831, "question_id": 58684473, "link": "https://stackoverflow.com/questions/58684473/jekyll-plugin-change-characters/58686831#58686831", "title": "Jekyll plugin change characters", "body": "<p>Technically, every line separated by whitespace get rendered into an HTML <code>&lt;p&gt;</code> element.</p>\n\n<p>To avoid generating <code>&lt;p&gt;</code> tags automatically, explicitly wrap lines in a <code>&lt;div</code>>:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;div&gt;\n  aaaaaaaaaaa  {% spoiler secret text %} bbbbbbbbbbbb\n&lt;/div&gt;\n</code></pre>\n"}], "owner": {"reputation": 1086, "user_id": 7274239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95a8acb728ffccfef0396e6de6d0e553?s=128&d=identicon&r=PG&f=1", "display_name": "Jan \u010cern&#253;", "link": "https://stackoverflow.com/users/7274239/jan-%c4%8cern%c3%bd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1588844942, "creation_date": 1572813949, "last_edit_date": 1588844942, "question_id": 58684473, "link": "https://stackoverflow.com/questions/58684473/jekyll-plugin-change-characters", "title": "Jekyll plugin change characters", "body": "<p>I have made my onw jekyll plugin which gives some text special css (spoiler hider).</p>\n\n<p>This is my code:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Spoiler &lt; Liquid::Tag\n   def initialize(tag_name, input, tokens)\n     super\n     @input = input\n   end\n\n   def render(context)\n     output = \"&lt;div class='spoiler'&gt;\" + @input + \"&lt;div&gt;\"\n     return  output;\n   end\n\nend\nLiquid::Template.register_tag('spoiler', Spoiler)                                 \n</code></pre>\n\n<p>There is example how I want to use it in my markdown posts:</p>\n\n<pre><code>---\nlayout: post\ntitle:  \"testing file\"\ndate:   2019-09-25\ncategory: article\n---\n\naaaaaaaaaaa  {% spoiler secret text %} bbbbbbbbbbbb\n</code></pre>\n\n<p>but this is how page looks like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/o1EHm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/o1EHm.png\" alt=\"screenshot of my site\"></a> </p>\n\n<p>When I look in to generated source code, the text looks like this:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;p&gt;aaaaaaa &amp;lt;div class='spoiler'&amp;gt;secret text &amp;lt;/div&amp;gt; bbbbbbbb&lt;/p&gt;\n</code></pre>\n\n<p>What should I do make jekyll plugin generate html element instead of text ?</p>\n\n<p>PS: If I manually replace <code>&amp;lt;</code> by <code>&lt;</code> and <code>&amp;gt;</code> by <code>&gt;</code>, it works fine.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "sidekiq"], "answers": [{"comments": [{"owner": {"reputation": 856, "user_id": 2766024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2aa121cbf57549dcd73c1576ca5814c?s=128&d=identicon&r=PG", "display_name": "Travis Glover", "link": "https://stackoverflow.com/users/2766024/travis-glover"}, "edited": false, "score": 0, "creation_date": 1573149961, "post_id": 58685410, "comment_id": 103796988, "body": "I figured I shouldn&#39;t trust the console due to the .yml files not being initialized, but I thought that I could put in a controller &quot;raise Sidekiq.options[:concurrency].inspect&quot;.  I didn&#39;t realize the sidekiq.yml file was only loaded when running sidekiq itself. Thanks!"}], "tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": true, "score": 2, "last_activity_date": 1572822252, "creation_date": 1572822252, "answer_id": 58685410, "question_id": 58684168, "link": "https://stackoverflow.com/questions/58684168/rails-sidekiq-sidekiq-optionsconcurrency-returns-10-instead-of-3-which-is/58685410#58685410", "title": "Rails + Sidekiq: Sidekiq.options[:concurrency] returns 10 instead of 3, which is the value in my config/sidekiq.yml file", "body": "<ul>\n<li><p>Don't trust what you see in the Rails console. (because Rails isn't going to read <code>config/sidekiq.yml</code>, it doesn't need to know about those settings)</p></li>\n<li><p>Trust what you see in the Sidekiq console. (because when sidekiq starts it reads <code>config/sidekiq.yml</code> to apply its settings)</p></li>\n</ul>\n\n<p>Given an example worker:</p>\n\n<pre><code>class ExampleWorker\n  include Sidekiq::Worker\n\n  def perform\n    puts Sidekiq.options[:concurrency]\n  end\nend\n</code></pre>\n\n<p>Open a Rails console and run the job synchronously:</p>\n\n<pre><code>ExampleWorker.new.perform\n10\n</code></pre>\n\n<p>This is <a href=\"https://github.com/mperham/sidekiq/wiki/Advanced-Options#concurrency\" rel=\"nofollow noreferrer\">the default</a>.</p>\n\n<p>Now run it asynchronously:</p>\n\n<pre><code>ExampleWorker.perform_async\n =&gt; \"628773ecad22c4b19e4d08a4\"\n</code></pre>\n\n<p>Open Sidekiq and wait for the job to run:</p>\n\n<pre><code>2019-11-03T22:59:13.786Z pid=2663 tid=ovyfd5os3 INFO: Running in ruby 2.6.3p62 (2019-04-16 revision 67580) [x86_64-darwin19]\n2019-11-03T22:59:13.786Z pid=2663 tid=ovyfd5os3 INFO: See LICENSE and the LGPL-3.0 for licensing details.\n2019-11-03T22:59:13.786Z pid=2663 tid=ovyfd5os3 INFO: Upgrade to Sidekiq Pro for more features and support: http://sidekiq.org\n2019-11-03T22:59:13.786Z pid=2663 tid=ovyfd5os3 INFO: Booting Sidekiq 6.0.3 with redis options {:id=&gt;\"Sidekiq-server-PID-2663\", :url=&gt;nil}\n2019-11-03T22:59:13.803Z pid=2663 tid=ovyfd5os3 INFO: Starting processing, hit Ctrl-C to stop\n2019-11-03T22:59:18.176Z pid=2663 tid=ovyfdnd37 class=ExampleWorker jid=628773ecad22c4b19e4d08a4 INFO: start\n3\n2019-11-03T22:59:18.279Z pid=2663 tid=ovyfdnd37 class=ExampleWorker jid=628773ecad22c4b19e4d08a4 elapsed=0.104 INFO: done\n</code></pre>\n\n<p>Sidekiq is applying the setting properly.</p>\n"}], "owner": {"reputation": 856, "user_id": 2766024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2aa121cbf57549dcd73c1576ca5814c?s=128&d=identicon&r=PG", "display_name": "Travis Glover", "link": "https://stackoverflow.com/users/2766024/travis-glover"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "accepted_answer_id": 58685410, "answer_count": 1, "score": 3, "last_activity_date": 1572822252, "creation_date": 1572811640, "last_edit_date": 1572821585, "question_id": 58684168, "link": "https://stackoverflow.com/questions/58684168/rails-sidekiq-sidekiq-optionsconcurrency-returns-10-instead-of-3-which-is", "title": "Rails + Sidekiq: Sidekiq.options[:concurrency] returns 10 instead of 3, which is the value in my config/sidekiq.yml file", "body": "<p>I use Sidekiq with Rails and the concurrency value returned appears to be wrong. <code>Sidekiq.options[:concurrency]</code> returns 10 instead of 3, which is the value in my <code>config/sidekiq.yml</code> file:</p>\n\n<pre><code>:concurrency: 3\nstaging:\n  :concurrency: 3\nproduction:\n  :concurrency: 3\n:queues:\n  - critical\n  - default\n  - low\n</code></pre>\n\n<p>Why is the wrong value being returned?</p>\n"}, {"tags": ["ruby", "string"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1572811661, "post_id": 58683506, "comment_id": 103667572, "body": "All three of your examples ask whether <i>1</i> string starts with a given string."}], "answers": [{"comments": [{"owner": {"reputation": 396, "user_id": 1814518, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5f1ad1dbc8cfc1c40988a6b6bec9c5a2?s=128&d=identicon&r=PG", "display_name": "Glenn", "link": "https://stackoverflow.com/users/1814518/glenn"}, "edited": false, "score": 0, "creation_date": 1572809368, "post_id": 58683547, "comment_id": 103667006, "body": "That&#39;s good, thanks.But... how would you do it if you had a bunch of strings and you don&#39;t know which (if any) start with the same sub string, and you don&#39;t even know what the sub string is?"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 396, "user_id": 1814518, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5f1ad1dbc8cfc1c40988a6b6bec9c5a2?s=128&d=identicon&r=PG", "display_name": "Glenn", "link": "https://stackoverflow.com/users/1814518/glenn"}, "edited": false, "score": 0, "creation_date": 1572809608, "post_id": 58683547, "comment_id": 103667080, "body": "That&#39;s a very good question. I think you can add some example input and expected output. The more I can think right now is to take a substring from each string and group them to finally get the number of repetitions."}, {"owner": {"reputation": 396, "user_id": 1814518, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5f1ad1dbc8cfc1c40988a6b6bec9c5a2?s=128&d=identicon&r=PG", "display_name": "Glenn", "link": "https://stackoverflow.com/users/1814518/glenn"}, "edited": false, "score": 0, "creation_date": 1572811757, "post_id": 58683547, "comment_id": 103667595, "body": "Here are some examples:  str1 = &quot;The cat is black.&quot; str2 = &quot;The cat is black and white.&quot; str3 = &quot;The cat&quot; str4 = &quot;The dog is white.&quot;  str1.starts_with_substring? str2 &quot;The cat is black&quot;  str1.starts_with_substring? str3 &quot;The cat&quot;  str2.starts_with_substring? str3 &quot;The cat&quot;  str1.starts_with_substring? str4 &quot;&quot;"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1572812054, "post_id": 58683547, "comment_id": 103667686, "body": "I had forgotten about that most useful form of <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-all-3F\" rel=\"nofollow noreferrer\">Enumerable#all?</a>, where the argument is a regular expression. I believe that was new in v2.4."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1572812135, "post_id": 58683547, "comment_id": 103667712, "body": "If I&#39;m not wrong it&#39;s from Ruby 2.5 <a href=\"https://www.ruby-lang.org/en/news/2017/12/25/ruby-2-5-0-released/\" rel=\"nofollow noreferrer\">ruby-lang.org/en/news/2017/12/25/ruby-2-5-0-released</a> @CarySwoveland."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 396, "user_id": 1814518, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5f1ad1dbc8cfc1c40988a6b6bec9c5a2?s=128&d=identicon&r=PG", "display_name": "Glenn", "link": "https://stackoverflow.com/users/1814518/glenn"}, "edited": false, "score": 0, "creation_date": 1572812386, "post_id": 58683547, "comment_id": 103667795, "body": "@Glenn, take a look to the update in the answer, does that cover your case? For any other examples, you can add them to your question just updating it."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": false, "score": 4, "last_activity_date": 1572812311, "last_edit_date": 1572812311, "creation_date": 1572807137, "answer_id": 58683547, "question_id": 58683506, "link": "https://stackoverflow.com/questions/58683506/how-can-i-determine-if-two-strings-start-with-the-same-sub-string-in-ruby/58683547#58683547", "title": "How can I determine if two strings start with the same sub string in ruby", "body": "<p>You can use <code>start_with?</code> and <code>all?</code> for that:</p>\n\n<pre><code>str1 = \"The cat is black. jkhdkjhdsjhd\"\nstr2 = \"The cat is black and white.\"\n\np [str1, str2].all? { |str| str.start_with?('The cat is') } # true\np [str1, str2].all? { |str| str.start_with?('The cat is not') } # false\n</code></pre>\n\n<p>And as from Ruby 2.5 Enumerable#any?, all?, none? and one? accept a pattern as argument, you can pass a regular expression to check if each string starts with that substring:</p>\n\n<pre><code>str1 = \"The cat is black. jkhdkjhdsjhd\"\nstr2 = \"The cat is black and white.\"\nstr3 = \"renuncia Pi\u00f1era The cat is black and white.\"\n\np [str1, str2].all?(/\\AThe cat is /) # true\np [str1, str2, str3].all?(/\\AThe cat is /) # false\n</code></pre>\n\n<hr>\n\n<p>After seeing the question in comments, this might work:</p>\n\n<pre><code>str1 = \"The cat is black.\"\nstr2 = \"The cat is black and white.\"\nstr3 = \"The cat\" \n\ndef all_substring?(sentences)\n  length = sentences.min.length\n  sentences.map { |sentence| sentence[0...length] }.uniq == [sentences.sample[0...length]]\nend\n\np all_substring?([str1, str2, str3]) # true\n</code></pre>\n\n<p>If you can't know beforehand if there's a substring which what to look for, I think you can use the smallest sentence as the substring.</p>\n"}, {"comments": [{"owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "edited": false, "score": 0, "creation_date": 1572815911, "post_id": 58684145, "comment_id": 103668651, "body": "Cary, second control should be <code>str == str2[0, len]</code>?"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1572815948, "last_edit_date": 1572815948, "creation_date": 1572811475, "answer_id": 58684145, "question_id": 58683506, "link": "https://stackoverflow.com/questions/58683506/how-can-i-determine-if-two-strings-start-with-the-same-sub-string-in-ruby/58684145#58684145", "title": "How can I determine if two strings start with the same sub string in ruby", "body": "<pre><code>def well_do_they?(str1, str2, str)\n  len = str.size\n  str == str1[0,len] &amp;&amp; str == str2[0,len]\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1572883653, "post_id": 58684638, "comment_id": 103690589, "body": "I like the approach but it would make more sense to use splat arguments instead of an array."}], "tags": [], "owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "is_accepted": false, "score": 0, "last_activity_date": 1572892417, "last_edit_date": 1572892417, "creation_date": 1572815218, "answer_id": 58684638, "question_id": 58683506, "link": "https://stackoverflow.com/questions/58683506/how-can-i-determine-if-two-strings-start-with-the-same-sub-string-in-ruby/58684638#58684638", "title": "How can I determine if two strings start with the same sub string in ruby", "body": "<pre><code>string = 'The cat is black.'\nstr1 = 'The cat is black and white.'\nstr2 = 'The cat'\nstr3 = 'The dog is white'\n\ndef matched_substrings(string, *substrings)\n  string = string.gsub('.', '')\n  substrings.select do |substring|\n    substring = substring.gsub('.', '')\n    string.start_with?(substring) || substring.start_with?(string)\n  end\nend\n\nmatched_substrings(string, str1, str2, str3)\n#=&gt; [\"The cat is black and white.\", \"The cat\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1572816437, "creation_date": 1572816437, "answer_id": 58684771, "question_id": 58683506, "link": "https://stackoverflow.com/questions/58683506/how-can-i-determine-if-two-strings-start-with-the-same-sub-string-in-ruby/58684771#58684771", "title": "How can I determine if two strings start with the same sub string in ruby", "body": "<p>Any monkey patch to String Class?</p>\n\n<pre><code>module MyStringPatch\n\n  def starts_with_substring(other)\n    return nil if self[0] != other[0]\n    n = (0..self.size).each { |n| break n if self[0..n] != other[0..n] }\n    self[0..n-1]\n  end\n\nend\n\nString.include MyStringPatch\n</code></pre>\n\n<p>So you can call</p>\n\n<pre><code>str1 = \"The cat is black. jkhdkjhdsjhd\"\nstr2 = \"The cat is black and white.\"\nstr1.starts_with_substring str2 #=&gt; \"The cat is black\"\nstr1.starts_with_substring \"The cat\" #=&gt; \"The cat\"\nstr1.starts_with_substring \"Hello, World!\" #=&gt; nil\n</code></pre>\n"}], "owner": {"reputation": 396, "user_id": 1814518, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5f1ad1dbc8cfc1c40988a6b6bec9c5a2?s=128&d=identicon&r=PG", "display_name": "Glenn", "link": "https://stackoverflow.com/users/1814518/glenn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1572892417, "creation_date": 1572806907, "last_edit_date": 1572807158, "question_id": 58683506, "link": "https://stackoverflow.com/questions/58683506/how-can-i-determine-if-two-strings-start-with-the-same-sub-string-in-ruby", "title": "How can I determine if two strings start with the same sub string in ruby", "body": "<p>I have two strings, and want to determine if the two string start with the same sub string.</p>\n\n<pre><code>str1 = \"The cat is black. jkhdkjhdsjhd\"\n\nstr2 = \"The cat is black and white.\"\n\nstr1.starts_with_substring? str2\nreturns \"The cat is black\"\n\nstr1.starts_with_substring? \"The cat\"\nreturns \"The cat\"\n\nstr1.starts_with_substring? \"Hello, World!\"\"\nreturns nil\n</code></pre>\n\n<p>I think I could do this with an iterator, but I was hoping for something more built in.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1572798710, "post_id": 58682204, "comment_id": 103664023, "body": "Lowercase and replace spaces with underscores? Then doing whatever it is you want with the string."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1572801161, "post_id": 58682204, "comment_id": 103664748, "body": "Not recommended, but single pass: <code>str.gsub(&#47;.&#47;) { |s| s==&#39; &#39; ? &#39;_&#39; : s }</code>."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 2, "creation_date": 1572802858, "post_id": 58682204, "comment_id": 103665247, "body": "&quot;can you do camelize \u201cconstantize\u201d with plain ruby?&quot; \u2013 This is kind of a weird question. ActiveSupport is just a Ruby library written in plain old Ruby, so if ActiveSupport can do it, then <i>obviously</i> it can be done in plain old Ruby."}, {"owner": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "edited": false, "score": 0, "creation_date": 1572803074, "post_id": 58682204, "comment_id": 103665306, "body": "by plain old ruby I meant in my company there&#39;s no rails in use, just ruby"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1572821424, "post_id": 58682204, "comment_id": 103669760, "body": "The desired result is neither camelized nor constantized as the question title is requesting."}, {"owner": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "edited": false, "score": 0, "creation_date": 1572829709, "post_id": 58682204, "comment_id": 103671007, "body": "I just realized that"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1572845168, "post_id": 58682204, "comment_id": 103673638, "body": "Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>. We see no attempt to solve the problem, only a request for us to explain how it&#39;s done (a tutorial, which is off-topic) or for us to write code for you, which again is off topic."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1572904143, "post_id": 58682204, "comment_id": 103698951, "body": "Your &quot;UPDATE&quot; is appreciated but readers are still sent on a <a href=\"https://dictionary.cambridge.org/dictionary/english/wild-goose-chase\" rel=\"nofollow noreferrer\">wild-goose chase</a> until they read the last sentence of the question. Forget &quot;UPDATE&quot;! Just edit (i.e., re-write), starting with the title (the first word of which should begin with a capital letter). Also &quot;in to&quot; should be &quot;into&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1572802305, "post_id": 58682307, "comment_id": 103665087, "body": "&#39;plain old&#39; is an expression which loosely translates to &#39;just&#39; in this context."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 2, "creation_date": 1572802655, "post_id": 58682307, "comment_id": 103665182, "body": "@Sagar, I thought it was referring to v0.95, which was released on December 21, 1995."}, {"owner": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "edited": false, "score": 0, "creation_date": 1572803030, "post_id": 58682307, "comment_id": 103665297, "body": "plain old ruby means no rails gem in use"}, {"owner": {"reputation": 3946, "user_id": 6231376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cea33b55396be93411ade85021f41b01?s=128&d=identicon&r=PG&f=1", "display_name": "TeWu", "link": "https://stackoverflow.com/users/6231376/tewu"}, "edited": false, "score": 2, "creation_date": 1572807630, "post_id": 58682307, "comment_id": 103666527, "body": "You may consider using <a href=\"https://ruby-doc.org/core-2.6/String.html#method-i-tr_s\" rel=\"nofollow noreferrer\"><code>tr_s</code></a>, instead of <code>tr</code>, to remove duplicate spaces before replacing them with <code>_</code>."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": false, "score": 5, "last_activity_date": 1572808474, "last_edit_date": 1572808474, "creation_date": 1572799095, "answer_id": 58682307, "question_id": 58682204, "link": "https://stackoverflow.com/questions/58682204/can-you-do-parameterize-underscore-with-plain-ruby-not-camelize-constantize/58682307#58682307", "title": "can you do parameterize / underscore with plain ruby? (not camelize &quot;constantize&quot;)", "body": "<pre><code>'Problem updating customer by email on hubspot'.downcase.tr_s(' ', '_')\n</code></pre>\n\n<p><code>downcase</code> and <code>tr</code> are both Ruby <em>built-in</em> methods. It should work off the Rails.</p>\n"}], "owner": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1574390184, "creation_date": 1572798507, "last_edit_date": 1574390184, "question_id": 58682204, "link": "https://stackoverflow.com/questions/58682204/can-you-do-parameterize-underscore-with-plain-ruby-not-camelize-constantize", "title": "can you do parameterize / underscore with plain ruby? (not camelize &quot;constantize&quot;)", "body": "<p>How can I turn this string</p>\n\n<pre><code>Problem updating customer by email on hubspot\n</code></pre>\n\n<p>in to</p>\n\n<pre><code>problem_updating_customer_by_email_on_hubspot\n</code></pre>\n\n<p>using plain old ruby?</p>\n\n<p>what I tried</p>\n\n<pre><code>$ irb\nirb(main):001:0&gt; \"Problem updating customer by email on hubspot\".parameterize.underscore\nNoMethodError: undefined method `parameterize' for \"Problem updating customer by email on hubspot\":String\n        from (irb):1\n        from /Users//.rbenv/versions/2.3.0/bin/irb:11:in `&lt;main&gt;'\nirb(main):002:0&gt;\n</code></pre>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "edited": false, "score": 0, "creation_date": 1572801064, "post_id": 58682244, "comment_id": 103664721, "body": "Sorry for late reply I&#39;m using MySQL so I&#39;ve tried replacing &#39;~&#39; to &#39;like&#39; and it worked. I put it on if statement but its going on else which supposed to be true."}, {"owner": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "edited": false, "score": 0, "creation_date": 1572807080, "post_id": 58682244, "comment_id": 103666350, "body": "How wrong I am. I&#39;ve realised when you let me run <code>Product.pluck(:name)</code> there&#39;s no apple on my <code>Product</code> when I add it, it works like a charm. Thanks a lot!"}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 3, "last_activity_date": 1572803314, "last_edit_date": 1572803314, "creation_date": 1572798725, "answer_id": 58682244, "question_id": 58682104, "link": "https://stackoverflow.com/questions/58682104/can-i-find-item-on-database-with-given-array-of-string-but-using-partial-string/58682244#58682244", "title": "Can I find item on database with given array of string but using partial string?", "body": "<p>In a certain way, this can be accomplished with the Regular Expression Operator <code>~</code> for PostgreSQL and/or <code>REGEXP</code> for MySQL:</p>\n\n<pre><code>regex = array.flat_map { |_, sentence, _| sentence.split }.join('|')\nProduct.exists?(['name ~ ?', regex])\nProduct.exists?(['name REGEXP ?', regex])\n</code></pre>\n\n<p>Which produces:</p>\n\n<pre><code>SELECT 1 AS one FROM \"products\" WHERE (name ~ 'tray|of|apple|box|of|ballpen') LIMIT $1  [[\"LIMIT\", 1]]\n</code></pre>\n\n<p>As it searches for the presence of every single word within the sentences <em>tray of apple</em> and/or <em>box of ballpen</em>.</p>\n\n<p>So, in case you have a record like:</p>\n\n<pre><code>Product.new(name: 'tray of apple and box of ballpen')\n</code></pre>\n\n<p>It'll cover the query and return true.</p>\n"}], "owner": {"reputation": 117, "user_id": 10068674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8gRv54FhhWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oH6R244hnLFuogLjfnpdDcQc_9-w/mo/photo.jpg?sz=128", "display_name": "some thing", "link": "https://stackoverflow.com/users/10068674/some-thing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 58682244, "answer_count": 1, "score": 0, "last_activity_date": 1572803314, "creation_date": 1572797881, "last_edit_date": 1572801664, "question_id": 58682104, "link": "https://stackoverflow.com/questions/58682104/can-i-find-item-on-database-with-given-array-of-string-but-using-partial-string", "title": "Can I find item on database with given array of string but using partial string?", "body": "<p>I have model <code>Product</code> with <code>name</code> and <code>category</code></p>\n\n<p>On seed:</p>\n\n<pre><code>Product.create(name: \"apple\", category: \"food\")\nProduct.create(name: \"biogesic\", category: \"medicine\")\n</code></pre>\n\n<p>And a 2 dimensional array:</p>\n\n<pre><code>[[1, \"tray of apple\", 150.00], [1, \"box of ballpen\", 70.30]]\n</code></pre>\n\n<p>What I need is to get if the string inside the array contains or is on the table/database <code>Product</code></p>\n\n<p>Here's what I'm thinking but I'm lost: </p>\n\n<pre><code>isProduct = Product.where(\"name like ?\", \"%an apple%\").first\n</code></pre>\n\n<p>Where <code>\"%apple%\"</code> is supposed to be the string on <code>array</code>, but with that code it is limited for 1 word only.</p>\n\n<p>I don't need the product <code>id</code>, I just need it if it is on the <code>Product</code> table.</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 5686886, "user_type": "registered", "profile_image": "https://graph.facebook.com/1050415735021134/picture?type=large", "display_name": "Feber Castellon", "link": "https://stackoverflow.com/users/5686886/feber-castellon"}, "edited": false, "score": 1, "creation_date": 1572797616, "post_id": 58681853, "comment_id": 103663658, "body": "thank you very much, to make it easier I replaced &quot;self.my_each&quot; with &quot;self.to_a.my_each&quot; :)"}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 2, "last_activity_date": 1572796348, "creation_date": 1572796348, "answer_id": 58681853, "question_id": 58681794, "link": "https://stackoverflow.com/questions/58681794/undefined-method-length-issue/58681853#58681853", "title": "Undefined method length issue", "body": "<p>That's because you're invoking <code>my_each</code> in a Range object. And seeing your code, there's no method <code>my_each</code> defined on the Range class.</p>\n\n<p>As <code>my_map</code> doesn't implicitly call <code>to_a</code> in the receiver, then you're using the object \"as is\" within the <code>my_map</code> definition in:</p>\n\n<pre><code>def my_map(proc=nil)\n  ...\n  self.my_each do |i|\n    ...\n  end\n  ...\nend\n</code></pre>\n\n<p>You can convert the receiver to an array and get rid of the error:</p>\n\n<pre><code>puts (1..4).to_a.my_map { |i| i * i }\n# 1\n# 4\n# 9\n# 16\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 5686886, "user_type": "registered", "profile_image": "https://graph.facebook.com/1050415735021134/picture?type=large", "display_name": "Feber Castellon", "link": "https://stackoverflow.com/users/5686886/feber-castellon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 58681853, "answer_count": 1, "score": 1, "last_activity_date": 1572812626, "creation_date": 1572795902, "last_edit_date": 1572812626, "question_id": 58681794, "link": "https://stackoverflow.com/questions/58681794/undefined-method-length-issue", "title": "Undefined method length issue", "body": "<p>I am trying to create methods for <code>Enumerable#each</code> and <code>Enumerable#map</code>, called <code>my_each</code> and <code>my_map</code>.</p>\n\n<p>But there is an issue when I try to yield to a block from <code>my_each</code> in <code>my_map</code> map, can somebody help me?</p>\n\n<p>When I change <code>my_each</code> inside <code>my_map</code> for just <code>each</code>, it works</p>\n\n<pre><code>module Enumerable\n  def my_each\n   return self.to_enum :my_each unless block_given?\n       for i in 0..self.length - 1\n           yield(self[i])\n       end\n       return self\n  end\n\n   def my_map(proc=nil)\n       return_array = Array.new\n       return self.to_enum :my_map if !block_given? &amp;&amp; proc.nil?\n       self.my_each do |i|\n           return_array.push(proc.call(i)) unless proc.nil?\n           return_array.push(yield(i)) if block_given? &amp;&amp; proc.nil?\n       end\n       return_array\n   end\nend\n\n\n\narray = [1, 2, 3, 4, 5]\n\nputs '*** my_each ***'\narray.my_each do |num|\n  puts num * num\nend\n\n   puts '*** my_map ***'\nputs \"#{((1..4).my_map { |i| i * i })} \"\nputs \"#{(1..4).my_map.to_a} \"\nputs \"#{([1, 2, 3, 4].my_map { |i| i * i })} \"\nputs \"#{[1, 2, 3, 4].my_map.to_a}\\n\\n\\n\"\n</code></pre>\n\n<p>it must work as a normal <code>map</code> method, but it throws me this:</p>\n\n<pre><code>undefined method `length' for 1..4:Range\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1572794919, "post_id": 58681502, "comment_id": 103662888, "body": "I would&#39;nt really trust <code>.all?(&amp;:valid?)</code>. You probably want to wrap it in a transaction instead and check if everything is saved."}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1572795254, "post_id": 58681502, "comment_id": 103662992, "body": "@max sure, but since the objects seems to only save a score value I tought it was simple enough to just check if all were valid, but a transaction is more error-proof for sure."}, {"owner": {"reputation": 7, "user_id": 7041333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/umPyP.jpg?s=128&g=1", "display_name": "kevin Mucheru", "link": "https://stackoverflow.com/users/7041333/kevin-mucheru"}, "edited": false, "score": 0, "creation_date": 1573129660, "post_id": 58681502, "comment_id": 103785951, "body": "@arieljuod thank you; this definitely gets me closer to the intended solution. Here is what I am getting so far; <code>{&quot;sub_agricultures&quot;=&gt;   {&quot;1&quot;=&gt;{&quot;scorecard_id&quot;=&gt;{&quot;1&quot;=&gt;&quot;&quot;}, &quot;score&quot;=&gt;&quot;58&quot;},    &quot;2&quot;=&gt;{&quot;scorecard_id&quot;=&gt;{&quot;2&quot;=&gt;&quot;&quot;}, &quot;score&quot;=&gt;&quot;58&quot;},    &quot;3&quot;=&gt;{&quot;scorecard_id&quot;=&gt;{&quot;3&quot;=&gt;&quot;&quot;}, &quot;score&quot;=&gt;&quot;58&quot;},    &quot;4&quot;=&gt;{&quot;scorecard_id&quot;=&gt;{&quot;4&quot;=&gt;&quot;&quot;}, &quot;score&quot;=&gt;&quot;56&quot;},    &quot;5&quot;=&gt;{&quot;scorecard_id&quot;=&gt;{&quot;5&quot;=&gt;&quot;&quot;}, &quot;score&quot;=&gt;&quot;58&quot;},    &quot;6&quot;=&gt;{&quot;scorecard_id&quot;=&gt;{&quot;6&quot;=&gt;&quot;&quot;}, &quot;score&quot;=&gt;&quot;58&quot;}}}</code>  and a NoMethodError at  @sub_agricultures []  in <code>sub_agricultures_controller.rb</code>  still working on it though"}], "tags": [], "owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "is_accepted": false, "score": 1, "last_activity_date": 1572793919, "creation_date": 1572793919, "answer_id": 58681502, "question_id": 58681274, "link": "https://stackoverflow.com/questions/58681274/create-new-object-for-each-array-item/58681502#58681502", "title": "Create new object for each array item", "body": "<p>I don't think you should use the \"new\" action for this since you move out from the conventions and rails excepts some things to happen. I would create two new actions: <code>bulk_new</code> and <code>bulk_create</code></p>\n\n<p>Add the routes for those actions:</p>\n\n<pre><code>resources :sub_agricultures do\n  collection do\n    get :bulk_new\n    post :bulk_create\n  end\nend\n</code></pre>\n\n<p>New, when you pass a model to the form_with helper, it tries to infere the url from the array chaining the resources names and that's why you see that weird named route.</p>\n\n<p>What you are doing is out of the conventions so you may need to fight a little with the inputs since rails won't be able to generate the proper names with that array, so you'll have to generate the input name prefix yourself, something like:</p>\n\n<pre><code>= form_tag bulk_create_sub_categories_path do |form|\n  - sub_agricultures.each do |sub_ag|\n    - input_name_prefix = \"sub_agricultures[#{sub_ag.scorecard_id}]\"\n    div\n      = hidden_field \"#{input_name_prefix}[scorecard_id]\", sub_ag.scorecard_id\n      = label_tag \"#{input_name_prefix}[score]\", \"Score for #{sub_ag.scorecard_id}\"\n      = number_field_tag \"#{input_name_prefix}[score]\", sub_ag.score\n      # add some errors feedback too\n</code></pre>\n\n<p>Now, that form should submit a params hash like this:</p>\n\n<pre><code>{\n  sub_agricultures: [\n    1: {scorecard_id: 1, score: XX},\n    2: {scorecard_id: 2, score: YY},\n    etc...\n  ]\n}\n</code></pre>\n\n<p>So, in your <code>bulk_create</code> actions you'll have to do something like:</p>\n\n<pre><code>def bulk_create\n  @sub_agricultures: []\n\n  # loop through the sub_agricultures params array\n  params[:sub_agricultures].each do |_, sub_ag_data|\n    sub_ag = SubAgriculture.new(scorecard_id: sub_ag_data[:scorecard_id], score: sub_ag_data[:score])\n    @sub_agricultures &lt;&lt; sub_ag\n  end\n\n  # now I guess you want to validate all of them:\n  if @sub_agricultures.all?(&amp;:valid?)\n    @sub_agricultures.each(&amp;:save)\n    flash[:notice] = \"sub agricultures created\"\n    redirect_to somewhere_path\n  else\n    flash.now[:error] = \"sub agricultures have errors\"\n    render action: :bulk_new\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 7041333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/umPyP.jpg?s=128&g=1", "display_name": "kevin Mucheru", "link": "https://stackoverflow.com/users/7041333/kevin-mucheru"}, "edited": false, "score": 0, "creation_date": 1573130023, "post_id": 58681567, "comment_id": 103786133, "body": "I understand the concern here; the request to have multiple entries at ago came about after the user experience was thought about. Its short numerical data; so making an entry, submitting it while another entry became available was too cumbersome for the eyes."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 7, "user_id": 7041333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/umPyP.jpg?s=128&g=1", "display_name": "kevin Mucheru", "link": "https://stackoverflow.com/users/7041333/kevin-mucheru"}, "edited": false, "score": 0, "creation_date": 1573131113, "post_id": 58681567, "comment_id": 103786759, "body": "It doesn&#39;t have to be. If you&#39;re just saving in the background it can be completely transparent to the user. In fact posting a big form is not really that great either from a ux perspective."}, {"owner": {"reputation": 7, "user_id": 7041333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/umPyP.jpg?s=128&g=1", "display_name": "kevin Mucheru", "link": "https://stackoverflow.com/users/7041333/kevin-mucheru"}, "edited": false, "score": 0, "creation_date": 1573133317, "post_id": 58681567, "comment_id": 103787877, "body": "since I already have the scorecards that take in these records; can I implement a Rails way using ajax? Like for the six scorecards above, have an ajax thing that infinitely scrolls to reveal more input? In this case, probably show four, then scroll down with ajax to reveal the other two?"}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 0, "last_activity_date": 1572795513, "last_edit_date": 1572795513, "creation_date": 1572794388, "answer_id": 58681567, "question_id": 58681274, "link": "https://stackoverflow.com/questions/58681274/create-new-object-for-each-array-item/58681567#58681567", "title": "Create new object for each array item", "body": "<p><code>form_with</code> is not designed to create multiple records at once. The model keyword is passed to the polyphic url helpers so when you pass an array of models you get a nested route:</p>\n\n<pre><code>polymorphic_url([blog, post]) # =&gt; \"http://example.com/blogs/1/posts/1\"\n</code></pre>\n\n<p>Rails resolves this to <code>blog_posts_path</code> by calling <code>model_name.param_key</code> on the model instance.</p>\n\n<p>Since you have a whole ton of records you get this ridiculus route <code>sub_agriculture_sub_agriculture_sub_agriculture_sub_agriculture_sub_agriculture_sub_agricultures_path</code>.</p>\n\n<p>Even if that worked I doubt the form builder would work since its made to be used with single records instances. Not an array.</p>\n\n<p>If you want to use nested attributes you need a model that wraps the nested attributes. So you need to either rethink your domain modeling (you can probally do a lot better) or use something like <code>&lt;%= form_with(url: '/somepath') %&gt;</code> and manually handle param binding and all that.</p>\n\n<p>Handling mass-inserts in this ways is actually quite a bit more involved than just looping through an array. You have to ensure that all the records are valid and saved (think transactions) and handle passing the records back to the form if they are not. I would really try to avoid it if possible. There is a reason why its not part of the Rails conventions.</p>\n\n<p>A good alternative is to use ajax to let the user create the lines one by one without leaving the page. You can do this with anatomical requests to just your normal run of the mill crud controller.</p>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 7041333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/umPyP.jpg?s=128&g=1", "display_name": "kevin Mucheru", "link": "https://stackoverflow.com/users/7041333/kevin-mucheru"}, "edited": false, "score": 0, "creation_date": 1573130172, "post_id": 58683872, "comment_id": 103786203, "body": "One scorecard has_many subjects might load the DB with unnecessary &#39;nils&#39;. For all existing cards (picture the one above) there will be a bunch of &#39;0&#39; records. Those consume indexes and time. This solution only provides a scorecard that can only have subjects that that particular student takes. It also frees up space for statistics and school announcements."}], "tags": [], "owner": {"reputation": 7811, "user_id": 379779, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4c3bd8d869b7e1caa45485b0b3e126a4?s=128&d=identicon&r=PG", "display_name": "zawhtut", "link": "https://stackoverflow.com/users/379779/zawhtut"}, "is_accepted": false, "score": 0, "last_activity_date": 1572809405, "creation_date": 1572809405, "answer_id": 58683872, "question_id": 58681274, "link": "https://stackoverflow.com/questions/58681274/create-new-object-for-each-array-item/58683872#58683872", "title": "Create new object for each array item", "body": "<p>Your model relation can be improved. One score card(Report Card) will contain many subjects. So better redesign the relationships between those two classes.\n<a href=\"https://i.stack.imgur.com/Ptfu2.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ptfu2.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 7, "user_id": 7041333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/umPyP.jpg?s=128&g=1", "display_name": "kevin Mucheru", "link": "https://stackoverflow.com/users/7041333/kevin-mucheru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1572809405, "creation_date": 1572792382, "question_id": 58681274, "link": "https://stackoverflow.com/questions/58681274/create-new-object-for-each-array-item", "title": "Create new object for each array item", "body": "<p>The error:</p>\n\n<blockquote>\n  <p>undefined method</p>\n  \n  <p>'sub_agriculture_sub_agriculture_sub_agriculture_sub_agriculture_sub_agriculture_sub_agricultures_path'\n  for #&lt;#:0x00007f5ec01b4b50'</p>\n</blockquote>\n\n<p><strong>context</strong></p>\n\n<p>I am building a student score system and currently having a resource issue (I think)\nThe relationships are defined as follows</p>\n\n<pre><code>Scorecard.rb\n..\n has_one :sub_agriculture\n\nsub_agriculture.rb\n..\n belongs_to :scorecard\n\nroutes.rb\n..\n resources :scorecards\n resources :sub_agricultures\n</code></pre>\n\n<p>Normally in <code>sub_agricultures_controller.rb</code> one would use;</p>\n\n<pre><code>def new     \n  @sub_agriculture =  SubAgriculture.new\nend\n</code></pre>\n\n<p>...because this results in</p>\n\n<pre><code>#&lt;SubAgriculture id: nil, score: nil, created_at: nil, updated_at: nil, scorecard_id: nil&gt; \n</code></pre>\n\n<p>I need to create several of these for their respective scorecards in a single entry form.</p>\n\n<p>However only select <code>scorecards</code> have the <code>sub_agriculture</code> attached to them. (not all atudents take the subject agriculture). So I run a query on <code>Scorecard</code> where I <code>pluck(:id)</code> because I did not see it efficient using the entire active_record relations. I then end up with an array of ids like so; <code>[1, 2, 3, 4, 5, 6]</code>. This is a collection of scorecard_ids from the query.</p>\n\n<p>So for each Id; I need to create a sub_agriculture score for it. For this case; six new sub_agriculture instances. For that I did this on <code>sub_agricultures_controller.rb</code></p>\n\n<pre><code>def new    \n    sc = Scorecard.scorecard_with_agriculture\n  @sub_agriculture =  sc.map { |s|SubAgriculture.new(:scorecard_id =&gt; s) }\n\nend\n</code></pre>\n\n<p>This spits this array out;</p>\n\n<pre><code>=&gt;[#&lt;SubAgriculture id: nil, score: nil, created_at: nil, updated_at: nil, scorecard_id: 1&gt;, #&lt;SubAgriculture id: nil, score: nil, created_at: nil\n, updated_at: nil, scorecard_id: 2&gt;, #&lt;SubAgriculture id: nil, score: nil, created_at: nil, updated_at: nil, scorecard_id: 3&gt;, #&lt;SubAgriculture id:\n nil, score: nil, created_at: nil, updated_at: nil, scorecard_id: 4&gt;, #&lt;SubAgriculture id: nil, score: nil, created_at: nil, updated_at: nil, score\ncard_id: 5&gt;, #&lt;SubAgriculture id: nil, score: nil, created_at: nil, updated_at: nil, scorecard_id: 6&gt;]\n</code></pre>\n\n<p>Which is what I had in mind but; the <code>/sub_agriculture/new</code> action hits me with this error</p>\n\n<blockquote>\n  <p>NoMethodError in SubAgricultures#new</p>\n  \n  <p>undefined method\n  `sub_agriculture_sub_agriculture_sub_agriculture_sub_agriculture_sub_agriculture_sub_agricultures_path'\n  for #&lt;#:0x00007f5ec01b4b50></p>\n</blockquote>\n\n<p>With this particular line in new form being highlighted</p>\n\n<pre><code>&lt;%= form_with(model: sub_agriculture, local: true) do |form| %&gt;\n</code></pre>\n\n<p>I need to create the six sub_agricultures in one form. Where am I going wrong?</p>\n"}, {"tags": ["json", "ruby", "terminal"], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 10300774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87ef14d6017f71e09f2886cd6a4de559?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/10300774/jules"}, "edited": false, "score": 0, "creation_date": 1572786113, "post_id": 58680229, "comment_id": 103660635, "body": "I think that&#39;s done it. Was it just an issue of not parsing the result?"}, {"owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "reply_to_user": {"reputation": 151, "user_id": 10300774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87ef14d6017f71e09f2886cd6a4de559?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/10300774/jules"}, "edited": false, "score": 0, "creation_date": 1572787673, "post_id": 58680229, "comment_id": 103661033, "body": "Yes. Parsing was problem. I added information to the answer. If it helps you, you can check it."}], "tags": [], "owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "is_accepted": true, "score": 1, "last_activity_date": 1572787574, "last_edit_date": 1572787574, "creation_date": 1572784828, "answer_id": 58680229, "question_id": 58680090, "link": "https://stackoverflow.com/questions/58680090/fetching-json-from-url-with-ruby-throwing-typeerror-and-failed-to-open-tcp-con/58680229#58680229", "title": "Fetching JSON from URL with Ruby, throwing TypeError and &#39;Failed to open TCP connection&#39;", "body": "<p>To get response try this:</p>\n\n<pre><code>require 'json'\nrequire 'net/http'\n\nurl = 'https://www.googleapis.com/books/v1/volumes?q=Harry+Potter'\n\n# get JSON as String\njson = Net::HTTP.get(URI.parse(url))\n\n# get Hash from JSON\nhash = JSON.parse(json)\n</code></pre>\n\n<p>The problem was of URI parsing.</p>\n\n<p>You can also do it as:</p>\n\n<pre><code>Net::HTTP.get_response(URI.parse(url)).body\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 10300774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87ef14d6017f71e09f2886cd6a4de559?s=128&d=identicon&r=PG&f=1", "display_name": "Jules", "link": "https://stackoverflow.com/users/10300774/jules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 58680229, "answer_count": 1, "score": 0, "last_activity_date": 1572787574, "creation_date": 1572783494, "question_id": 58680090, "link": "https://stackoverflow.com/questions/58680090/fetching-json-from-url-with-ruby-throwing-typeerror-and-failed-to-open-tcp-con", "title": "Fetching JSON from URL with Ruby, throwing TypeError and &#39;Failed to open TCP connection&#39;", "body": "<p><strong>Background</strong></p>\n\n<p>I have a Ruby terminal app that generates a URL, and then fetches JSON from that URL.</p>\n\n<p>Manually following the link (<a href=\"https://www.googleapis.com/books/v1/volumes?q=Harry+Potter\" rel=\"nofollow noreferrer\">https://www.googleapis.com/books/v1/volumes?q=Harry+Potter</a>) shows a JSON object, but the program throws two errors.</p>\n\n<ol>\n<li>(no implicit conversion of Array into String) (TypeError)</li>\n<li>Failed to open TCP connection to [{\"kind\"=>\"books#volume\", \"id\"=>\"2sSMCwAAQBAJ\", \"etag\"=>\"vAZ9LJGLnng\", \"selfLink\"=>\"<a href=\"https://www.googleapis.com/books/v1/volumes/2sSMCwAAQBAJ\" rel=\"nofollow noreferrer\">https://www.googleapis.com/books/v1/volumes/2sSMCwAAQBAJ</a>\", \"volumeInfo\"=>{\"title\"=>\"Harry Potter and the Cursed Child \u2013 Parts One and Two (Special Rehearsal Edition)\", \"authors\"=>[\"J.K. Rowling\", \"John Tiffany\", \"Jack Thorne\"]...(very long)</li>\n</ol>\n\n<p>I'm confused as it says it cannot open a connection, but the data is there, although it's in a different format.</p>\n\n<p><strong>My Code</strong></p>\n\n<p>The relevant code is as follows.    </p>\n\n<pre><code>    response = Net::HTTP.get_response(link,\"\")\n    puts response.body -- error is thrown on line above, so this is commented out\n</code></pre>\n\n<p>Note: 'link' in this case is the first link I gave.</p>\n\n<p><strong>Question</strong></p>\n\n<p>How can I correct the errors given, so that my application gets a JSON object?</p>\n"}, {"tags": ["ruby", "windows", "postgresql", "rubygems", "pg"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1572780399, "post_id": 58679528, "comment_id": 103659441, "body": "This does not look like Windows, it looks like Linux."}, {"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1572781407, "post_id": 58679528, "comment_id": 103659663, "body": "@anothermh - He might be using linux bash on windows: <a href=\"https://itsfoss.com/install-bash-on-windows/\" rel=\"nofollow noreferrer\">itsfoss.com/install-bash-on-windows</a>"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1572782839, "post_id": 58679528, "comment_id": 103659980, "body": "WSL is not Windows."}, {"owner": {"reputation": 27, "user_id": 12000739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/379129ea7f9ba47c4c6d660d161e4f29?s=128&d=identicon&r=PG&f=1", "display_name": "fairyduststars", "link": "https://stackoverflow.com/users/12000739/fairyduststars"}, "edited": false, "score": 0, "creation_date": 1572782914, "post_id": 58679528, "comment_id": 103660000, "body": "I&#39;m using Windows but for this project I&#39;m using the IDE Cloud 9 rather than gitbash, or Windows command prompt."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1572807608, "post_id": 58679528, "comment_id": 103666521, "body": "Although your computer may run Windows the environment in which you are running <code>bundle install</code> is Linux. Make sure you specify that for future questions."}], "answers": [{"tags": [], "owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "is_accepted": false, "score": 2, "last_activity_date": 1572791605, "creation_date": 1572791605, "answer_id": 58681153, "question_id": 58679528, "link": "https://stackoverflow.com/questions/58679528/unable-to-install-pg-gem-on-windows/58681153#58681153", "title": "Unable to install pg gem on Windows", "body": "<p>You are missing <code>pg_config</code>, which means most likely the pg development package has not been installed.</p>\n\n<pre><code>apt install libpq-dev\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 12000739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/379129ea7f9ba47c4c6d660d161e4f29?s=128&d=identicon&r=PG&f=1", "display_name": "fairyduststars", "link": "https://stackoverflow.com/users/12000739/fairyduststars"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1572791605, "creation_date": 1572778935, "question_id": 58679528, "link": "https://stackoverflow.com/questions/58679528/unable-to-install-pg-gem-on-windows", "title": "Unable to install pg gem on Windows", "body": "<p>I'm trying to install the pg gem in my project but I get the following error when I run gem install pg, or if I run bundle install:</p>\n\n<pre><code>ERROR:  Error installing pg:\n    ERROR: Failed to build gem native extension.\n\ncurrent directory: /home/ec2-user/.rvm/gems/ruby-2.6.3/gems/pg-1.1.4/ext\n/home/ec2-user/.rvm/rubies/ruby-2.6.3/bin/ruby -I /home/ec2- \nuser/.rvm/rubies/ruby-2.6.3/lib/ruby/site_ruby/2.6.0 -r \n./siteconf20191103-5491-ro2ye0.rb extconf.rb\nchecking for pg_config... no\nNo pg_config... trying anyway. If building fails, please try again with\n--with-pg-config=/path/to/pg_config\nchecking for libpq-fe.h... no\nCan't find the 'libpq-fe.h header\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You \nmay\nneed configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/home/ec2-user/.rvm/rubies/ruby-2.6.3/bin/$(RUBY_BASE_NAME)\n    --with-pg\n    --without-pg\n    --enable-windows-cross\n    --disable-windows-cross\n    --with-pg-config\n    --without-pg-config\n    --with-pg_config\n    --without-pg_config\n    --with-pg-dir\n    --without-pg-dir\n    --with-pg-include\n    --without-pg-include=${pg-dir}/include\n    --with-pg-lib\n    --without-pg-lib=${pg-dir}/lib\n\nTo see why this extension failed to compile, please check the mkmf.log \nwhich can be found here:\n\n/home/ec2-user/.rvm/gems/ruby-2.6.3/extensions/x86_64-linux/2.6.0/pg- \n1.1.4/mkmf.log\n\nextconf failed, exit code 1\n</code></pre>\n\n<p>As you can see, I'm using Ruby version 2.6.3 and I'm on a Windows.\nI'm trying to install the pg gem so that I can connect to the database.\nI'm very new to all of this, so any help would be greatly appreciated</p>\n"}, {"tags": ["ruby", "macos", "rubygems", "macos-catalina"], "comments": [{"owner": {"reputation": 2560, "user_id": 5112122, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206053108358704/picture?type=large", "display_name": "Horacio", "link": "https://stackoverflow.com/users/5112122/horacio"}, "edited": false, "score": 0, "creation_date": 1572770996, "post_id": 58677731, "comment_id": 103657490, "body": "I would use rvm with gemset and bundler."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1572780645, "post_id": 58677731, "comment_id": 103659495, "body": "Install RVM with <code>\\curl -sSL https:&#47;&#47;get.rvm.io | bash -s stable</code>; restart your shell; install Ruby with <code>rvm install 2.6.0</code>. <a href=\"https://robots.thoughtbot.com/psa-do-not-use-system-ruby\" rel=\"nofollow noreferrer\">Don&#39;t</a> <a href=\"https://chrisherring.co/posts/why-you-shouldn-t-use-the-system-ruby\" rel=\"nofollow noreferrer\">use</a> <a href=\"http://billpatrianakos.me/blog/2014/05/15/never-use-system-ruby-ever/\" rel=\"nofollow noreferrer\">system Ruby</a>."}, {"owner": {"reputation": 3417, "user_id": 2030088, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d2b8b708df57dea3f1e2e533f4870126?s=128&d=identicon&r=PG", "display_name": "XDR", "link": "https://stackoverflow.com/users/2030088/xdr"}, "edited": false, "score": 1, "creation_date": 1572783190, "post_id": 58677731, "comment_id": 103660056, "body": "I don\u2019t code in Ruby, I\u2019m just trying to keep all components on my system up-to-date, mainly for security &amp; bug fixes. I\u2019ve never intentionally installed extra gems, I\u2019ve only updated what was pre-installed on my Mac. (Maybe a gem was installed when I installed some software to use). If I can easily get rid of all existing gems and use something like churby, that could work, but I don\u2019t want to leave old gems on my file system."}], "answers": [{"comments": [{"owner": {"reputation": 3417, "user_id": 2030088, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d2b8b708df57dea3f1e2e533f4870126?s=128&d=identicon&r=PG", "display_name": "XDR", "link": "https://stackoverflow.com/users/2030088/xdr"}, "edited": false, "score": 0, "creation_date": 1572783041, "post_id": 58678616, "comment_id": 103660027, "body": "I don\u2019t code in Ruby, I\u2019m just trying to keep all components on my system up-to-date, mainly for security &amp; bug fixes. I\u2019ve never intentionally installed extra gems, I\u2019ve only updated what was pre-installed on my Mac. (Maybe a gem was installed when I installed some software to use). If I can easily get rid of all existing gems and use something like churby, that could work, but I don\u2019t want to leave old gems on my file system."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 3417, "user_id": 2030088, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d2b8b708df57dea3f1e2e533f4870126?s=128&d=identicon&r=PG", "display_name": "XDR", "link": "https://stackoverflow.com/users/2030088/xdr"}, "edited": false, "score": 0, "creation_date": 1572784449, "post_id": 58678616, "comment_id": 103660332, "body": "@XDR If the system has installed them, there&#39;s probably a good reason and you shouldn&#39;t need to worry about managing them yourself. See updated anser."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 1, "last_activity_date": 1572784604, "last_edit_date": 1572784604, "creation_date": 1572770712, "answer_id": 58678616, "question_id": 58677731, "link": "https://stackoverflow.com/questions/58677731/cannot-uninstall-old-version-of-gem-from-macos-catalina-10-15-1/58678616#58678616", "title": "Cannot uninstall old version of gem from macOS Catalina 10.15.1", "body": "<p>Why not use a version manager and don't worry at all about system ruby / gems?  You can for example try RVM.  See <a href=\"https://rvm.io/rvm/install\" rel=\"nofollow noreferrer\">install instructions here</a></p>\n\n<p>Or Churby see <a href=\"https://github.com/postmodern/chruby\" rel=\"nofollow noreferrer\">https://github.com/postmodern/chruby</a></p>\n\n<p>UPDATED:  Don't mess with system libraries that were installed by your OS. They are likely there for a good reason.  If you don't know what you're doing, you might break something somewhere.  For system and security updates, stick to the OS system updates and patches as they release them. </p>\n"}], "owner": {"reputation": 3417, "user_id": 2030088, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d2b8b708df57dea3f1e2e533f4870126?s=128&d=identicon&r=PG", "display_name": "XDR", "link": "https://stackoverflow.com/users/2030088/xdr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1133, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1572784604, "creation_date": 1572760105, "question_id": 58677731, "link": "https://stackoverflow.com/questions/58677731/cannot-uninstall-old-version-of-gem-from-macos-catalina-10-15-1", "title": "Cannot uninstall old version of gem from macOS Catalina 10.15.1", "body": "<p>On macOS Catalina 10.15.1, I have a few Ruby gems where two versions are installed, one under each of the following two directories:</p>\n\n<p>Older:</p>\n\n<pre><code>/System/Library/Frameworks/Ruby.framework/Versions/2.6/usr/lib/ruby/gems/2.6.0\n</code></pre>\n\n<p>Newer:</p>\n\n<pre><code>/Library/Ruby/Gems/2.6.0/gems \n</code></pre>\n\n<p>I would like to uninstall the older versions from under <code>/System/\u2026</code>, but, when I run the following commands, I get the associated errors:</p>\n\n<pre><code>$ sudo gem uninstall CFPropertyList --version 2.3.6\nERROR:  While executing gem ... (Gem::InstallError)\n    CFPropertyList is not installed in GEM_HOME, try:\n    gem uninstall -i /System/Library/Frameworks/Ruby.framework/Versions/2.6/usr/lib/ruby/gems/2.6.0 CFPropertyList\n\n$ sudo gem uninstall -i /System/Library/Frameworks/Ruby.framework/Versions/2.6/usr/lib/ruby/gems/2.6.0 CFPropertyList\nERROR:  While executing gem ... (Gem::FilePermissionError)\n    You don't have write permissions for the /System/Library/Frameworks/Ruby.framework/Versions/2.6/usr/lib/ruby/gems/2.6.0 directory.\n</code></pre>\n\n<p>I also get the same error if I run the last command without <code>sudo</code>.</p>\n\n<p>How can I remove the old versions of the gems?</p>\n\n<p>On a related note, I have a few gems that are only under the <code>/System/\u2026</code> directory, not the <code>/Library/\u2026</code> directory.  How can I move them from the former to the latter?</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "postgresql"], "comments": [{"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1572831219, "post_id": 58676887, "comment_id": 103671264, "body": "Jsut a small hint, you can reduce the second line to <code>offset = params[:offset].presence || 0</code>"}, {"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1572832788, "post_id": 58676887, "comment_id": 103671547, "body": "Is <code>Clues</code> your model? Plural? It should be singular."}], "owner": {"reputation": 1, "user_id": 4732115, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XH06ZUcQufo/AAAAAAAAAAI/AAAAAAAAAKc/e1CsyBtfGwc/photo.jpg?sz=128", "display_name": "theguywhocodes", "link": "https://stackoverflow.com/users/4732115/theguywhocodes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572748027, "creation_date": 1572746975, "last_edit_date": 1572748027, "question_id": 58676887, "link": "https://stackoverflow.com/questions/58676887/filtering-nested-model-collections-in-to-json-include-in-rails", "title": "Filtering nested model collections in to_json include in Rails", "body": "<p>To start out I have already looked at <a href=\"https://stackoverflow.com/questions/12633546/filter-nested-model-collections-in-to-json-in-rails\">this thread</a> and <a href=\"https://stackoverflow.com/questions/41296609/include-nested-objects-relations-with-filter-in-rails-json-response\">this thread</a>.</p>\n\n<p>I have a piece of code that has a couple different postgres calls, and then appends on another model collection named Category within our response. I want to filter out certain pieces of response depending on a search param passed in by the json. My current code is here: </p>\n\n<pre><code>   def clues\n   ....\n    clues = clues.where(\"category_id = ?\", params[:category]) if params[:category].present?\n    offset = params[:offset].present? ? params[:offset] : 0\n    @result = clues.limit(100).offset(offset)\n\n    respond_to do |format|\n      if(!params[:category_keyword])\n        format.json { render :json =&gt; @result.to_json(:include =&gt; :category) }\n      else \n        format.json { render :json =&gt; @result.to_json(:include =&gt; Category.where(\"title LIKE ?\", '%' + params[:category_keyword] + '%')) }\n      end\n    end\n  end\n</code></pre>\n\n<p>Right now, the end if statement in the respond_to do is broken, as I don't think my :include for the else statement is in a correct format to filter out, as it just doesn't append the nested model to my json response. What is the best way to filter out these nested calls?</p>\n"}, {"tags": ["ruby", "rubygems", "yt"], "answers": [{"tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": true, "score": 0, "last_activity_date": 1572820376, "creation_date": 1572820376, "answer_id": 58685236, "question_id": 58675755, "link": "https://stackoverflow.com/questions/58675755/cant-install-yt-core-gem/58685236#58685236", "title": "Can&#39;t install `yt-core` gem", "body": "<p>From <a href=\"https://guides.rubygems.org/command-reference/#gem-which\" rel=\"nofollow noreferrer\">the documentation</a>:</p>\n\n<blockquote>\n  <p><strong>GEM WHICH</strong></p>\n  \n  <p>Find the location of a library file you can require</p>\n</blockquote>\n\n<p>So when you call <code>gem which</code> you need to provide an actual module you can require, not just the name of the gem. And if you look at <a href=\"https://github.com/Fullscreen/yt/blob/master/lib/yt.rb\" rel=\"nofollow noreferrer\">the source</a> for the yt gem you'll see the following structure:</p>\n\n<pre><code>lib/\n  yt.rb\n</code></pre>\n\n<p>And you'll notice that the content of <code>yt.rb</code> is:</p>\n\n<pre><code>module Yt\nend\n</code></pre>\n\n<p>So when you call <code>gem which yt</code> it is able to find that module and tell you where to find it. (<code>lib/yt.rb</code>)</p>\n\n<p>But if you look at <a href=\"https://github.com/Fullscreen/yt-core/tree/master/lib\" rel=\"nofollow noreferrer\">the source for yt-core</a> you'll see there is no file inside the <code>lib/</code> directory, and instead all files are inside <code>lib/yt</code>:</p>\n\n<pre><code>lib/\n  yt/\n    ...\n    core.rb\n    ...\n</code></pre>\n\n<p>And <a href=\"https://github.com/Fullscreen/yt-core/blob/master/lib/yt/core.rb\" rel=\"nofollow noreferrer\">the source for <code>core.rb</code></a> is:</p>\n\n<pre><code>module Yt\nend\n</code></pre>\n\n<p>So if you want to find the location of the module, you need to run:</p>\n\n<pre><code>gem which yt/core\n/Users/foo/.rvm/gems/ruby-2.6.3/gems/yt-core-0.1.7/lib/yt/core.rb\n</code></pre>\n\n<p>Or <code>yt/channel</code> or <code>yt/group</code>, etc.</p>\n\n<p>So to use this gem, you would need to include this in your source:</p>\n\n<pre><code>require 'yt/core'\n</code></pre>\n"}], "owner": {"reputation": 3146, "user_id": 3622415, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/873e6fd319032200fd5dc359f5d897eb?s=128&d=identicon&r=PG", "display_name": "kangkyu", "link": "https://stackoverflow.com/users/3622415/kangkyu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 58685236, "answer_count": 1, "score": 0, "last_activity_date": 1572820376, "creation_date": 1572732791, "question_id": 58675755, "link": "https://stackoverflow.com/questions/58675755/cant-install-yt-core-gem", "title": "Can&#39;t install `yt-core` gem", "body": "<p>Thank you for reading this question.</p>\n\n<pre><code>$ gem install yt\nSuccessfully installed yt-0.32.4\n1 gem installed\n$ gem which yt\n/Users/klee/.rbenv/versions/2.5.4/lib/ruby/gems/2.5.0/gems/yt-0.32.4/lib/yt.rb\n$ gem install yt-core\nSuccessfully installed yt-core-0.1.7\n1 gem installed\n$ gem which yt-core\nERROR:  Can't find Ruby library file or shared library yt-core\n</code></pre>\n\n<p>I keep trying to install this gem, but it keeps saying \"Can't find.\" Same thing happens to you? How can I install and find this gem? This is the gem I'm trying to install <a href=\"https://rubygems.org/gems/yt-core\" rel=\"nofollow noreferrer\">https://rubygems.org/gems/yt-core</a></p>\n"}, {"tags": ["javascript", "regex", "ruby", "string", "string-substitution"], "comments": [{"owner": {"reputation": 319259, "user_id": 1447675, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ziYmO.gif?s=128&g=1", "display_name": "Nina Scholz", "link": "https://stackoverflow.com/users/1447675/nina-scholz"}, "edited": false, "score": 1, "creation_date": 1572726278, "post_id": 58674865, "comment_id": 103651275, "body": "btw, <code>return base[match];</code> is enough."}, {"owner": {"reputation": 192865, "user_id": 989121, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/1Cvf7.png?s=128&g=1", "display_name": "georg", "link": "https://stackoverflow.com/users/989121/georg"}, "edited": false, "score": 2, "creation_date": 1572726549, "post_id": 58674865, "comment_id": 103651335, "body": "nothing built-in, but you can shorten your replace to <code>dna.replace(&#47;[ATGC]&#47;g, m =&gt; base[m])</code> which is only a tiny bit longer than the ruby version."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 5, "creation_date": 1572731129, "post_id": 58674865, "comment_id": 103652314, "body": "Here&#39;s the doc for Ruby&#39;s method <a href=\"https://ruby-doc.org/core-2.6.3/String.html#method-i-tr\" rel=\"nofollow noreferrer\">String#tr</a>. I expect anyone who does not know Ruby will want to read that before venturing an answer."}], "answers": [{"comments": [{"owner": {"reputation": 3024, "user_id": 496080, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/fa85d9c407a20bef042b86f764df8cfa?s=128&d=identicon&r=PG", "display_name": "Chris Edwards", "link": "https://stackoverflow.com/users/496080/chris-edwards"}, "edited": false, "score": 1, "creation_date": 1586352909, "post_id": 58689406, "comment_id": 108096946, "body": "That will only replace <code>ACTG</code> with <code>TGAC</code>. Ruby&#39;s tr method works differently, see docs here <a href=\"https://ruby-doc.org/core-2.6.3/String.html#method-i-tr\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.6.3/String.html#method-i-tr</a>. Summary: Returns a copy of str with the characters in from_str replaced by the corresponding characters in to_str. If to_str is shorter than from_str, it is padded with its last character in order to maintain the correspondence."}], "tags": [], "owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "is_accepted": false, "score": 0, "last_activity_date": 1572855179, "creation_date": 1572855179, "answer_id": 58689406, "question_id": 58674865, "link": "https://stackoverflow.com/questions/58674865/what-is-the-js-equivalent-to-the-ruby-tr-method/58689406#58689406", "title": "What is the JS equivalent to the Ruby :tr method?", "body": "<p>Yes, try it in your browser console</p>\n\n<pre><code>&gt;&gt; \"FOOACTGBARACTG\".replace(/ACTG/g, 'TGAC')\n</code></pre>\n\n<p>and you'll get </p>\n\n<pre><code>&lt;- \"FOOTGACBARTGAC\"\n</code></pre>\n"}], "owner": {"reputation": 535, "user_id": 10565289, "user_type": "registered", "profile_image": "https://graph.facebook.com/1744372365672405/picture?type=large", "display_name": "Richard Jarram", "link": "https://stackoverflow.com/users/10565289/richard-jarram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 218, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1601039123, "creation_date": 1572725155, "last_edit_date": 1601039123, "question_id": 58674865, "link": "https://stackoverflow.com/questions/58674865/what-is-the-js-equivalent-to-the-ruby-tr-method", "title": "What is the JS equivalent to the Ruby :tr method?", "body": "<p>In ruby I could do this:</p>\n<pre><code>def DNA_strand(dna)\n  base_hash = { 'A' =&gt; 'T', 'T' =&gt; 'A', 'G' =&gt; 'C', 'C' =&gt; 'G' }\n  dna.gsub(/[ATGC]/, base_hash)\nend\n</code></pre>\n<p>I could also do this which would be exactly equivalent:</p>\n<pre><code>def DNA_strand(dna)\n  Dna.tr(\u2019ACTG\u2019, \u2019TGAC\u2019)\nend\n</code></pre>\n<p>In JS is there any equivalent method to :tr in ruby?</p>\n<p>Currently I can only think of solving this problem in JS like this:</p>\n<pre><code>function DNAStrand(dna){\n  function matchBase(match, offset, string) {\n    const base = { 'A': 'T', 'T': 'A', 'G': 'C', 'C': 'G' };\n    return `${base[match]}`;\n  }\n  return dna.replace(/[ATGC]/g, matchBase);\n}\n</code></pre>\n<p>Any comments will be appreciated!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "rspec", "ruby-on-rails-5.2"], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 1, "last_activity_date": 1572724343, "creation_date": 1572724343, "answer_id": 58674771, "question_id": 58674662, "link": "https://stackoverflow.com/questions/58674662/rspec-failure-coupon-increment-counter-not-incrementing-the-record-value/58674771#58674771", "title": "Rspec failure: Coupon.increment_counter not incrementing the record value", "body": "<p>When you call <code>Coupon.increment_counter(:times_redeemed, self.id)</code> the object <code>coupon</code> is not aware about the changes made in the DB, you need to reload it to fetch those changes:</p>\n\n<pre><code>    it \"should increment redeemed count and return it\" do\n      expect(coupon.times_redeemed).to eql(0)\n      coupon.redeem!\n      coupon.reload\n      expect(coupon.times_redeemed).to eql(1)\n    end\n</code></pre>\n"}], "owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 58674771, "answer_count": 1, "score": 0, "last_activity_date": 1572724360, "creation_date": 1572723600, "last_edit_date": 1572724360, "question_id": 58674662, "link": "https://stackoverflow.com/questions/58674662/rspec-failure-coupon-increment-counter-not-incrementing-the-record-value", "title": "Rspec failure: Coupon.increment_counter not incrementing the record value", "body": "<p>Why would this be failing? How do I correct the rspec test or my code?</p>\n\n<h3>MODEL</h3>\n\n<pre><code>class Coupon &lt; ApplicationRecord\n  def redeem!\n    Coupon.increment_counter(:times_redeemed, self.id)\n  end\nend\n</code></pre>\n\n<h3>Rspec</h3>\n\n<pre><code>require \"rails_helper\"\n\nRSpec.describe Coupon, type: :model do\n  let(:coupon) { create(:coupon) }\n  describe \"#redeem!\" do\n    it \"should increment redeemed count and return it\" do\n      expect(coupon.times_redeemed).to eql(0)\n      coupon.redeem!\n      expect(coupon.times_redeemed).to eql(1)\n    end\n  end\nend\n</code></pre>\n\n<h3>Factory</h3>\n\n<pre><code>FactoryBot.define do\n  factory :coupon do\n    amount_off { 50 }\n    stripe_id { \"\" }\n    duration { \"once\" }\n    duration_in_months { 1 }\n    max_redemptions { 1 }\n    metadata { \"\" }\n    name { \"OFF50\" }\n    percent_off { \"50\" }\n    redeem_by { \"\" }\n    times_redeemed { 0 }\n    status_valid { }\n  end\nend\n</code></pre>\n\n<h3>Table</h3>\n\n<pre><code>  create_table \"coupons\", force: :cascade do |t|\n    t.string \"stripe_id\"\n    t.integer \"amount_off\"\n    t.string \"duration\"\n    t.integer \"duration_in_months\"\n    t.integer \"max_redemptions\"\n    t.json \"metadata\", default: {}, null: false\n    t.string \"name\"\n    t.decimal \"percent_off\"\n    t.datetime \"redeem_by\"\n    t.integer \"times_redeemed\"\n    t.boolean \"status_valid\", default: true\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"stripe_id\"], name: \"index_coupons_on_stripe_id\"\n  end\n</code></pre>\n\n<h3>Failures:</h3>\n\n<pre><code>  1) Coupon#redeem! should increment times_redeemed by 1\n     Failure/Error: expect(coupon.times_redeemed).to eql(1)\n\n       expected: 1\n            got: 0\n\n       (compared using eql?)\n</code></pre>\n\n<p>When I try it in the console, it does not update either:</p>\n\n<pre><code>2.6.3 :006 &gt; a\n =&gt; #&lt;Coupon id: 2, stripe_id: nil, amount_off: nil, duration: nil, duration_in_months: nil, max_redemptions: nil, metadata: {}, name: nil, percent_off: nil, redeem_by: nil, times_redeemed: 0, status_valid: true, restricted: {}, created_at: \"2019-11-02 19:44:07\", updated_at: \"2019-11-02 19:44:07\"&gt; \n2.6.3 :007 &gt; a.redeem!\n  Coupon Update All (5.5ms)  UPDATE \"coupons\" SET \"times_redeemed\" = COALESCE(\"times_redeemed\", 0) + 1 WHERE \"coupons\".\"id\" = $1  [[\"id\", 2]]\n =&gt; 1 \n2.6.3 :008 &gt; a\n =&gt; #&lt;Coupon id: 2, stripe_id: nil, amount_off: nil, duration: nil, duration_in_months: nil, max_redemptions: nil, metadata: {}, name: nil, percent_off: nil, redeem_by: nil, times_redeemed: 0, status_valid: true, restricted: {}, created_at: \"2019-11-02 19:44:07\", updated_at: \"2019-11-02 19:44:07\"&gt; \n2.6.3 :009 &gt; \n</code></pre>\n"}, {"tags": ["ruby", "reactjs", "finance", "plaid"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1573236614, "post_id": 58674564, "comment_id": 103829489, "body": "can you post the backtrace errors?"}, {"owner": {"reputation": 509, "user_id": 7254473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fkwvm.jpg?s=128&g=1", "display_name": "Jonny B", "link": "https://stackoverflow.com/users/7254473/jonny-b"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1573245995, "post_id": 58674564, "comment_id": 103833078, "body": "There isn&#39;t a stack, its an api response. I got a response from Plaid, it&#39;s actually on their end."}], "answers": [{"comments": [{"owner": {"reputation": 1168, "user_id": 381447, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54b1ca7c6dda29d4b8bfb8aadf2a208f?s=128&d=identicon&r=PG", "display_name": "Daveel", "link": "https://stackoverflow.com/users/381447/daveel"}, "edited": false, "score": 0, "creation_date": 1609463505, "post_id": 58773561, "comment_id": 115849760, "body": "It seems like the problem is still there!? Gee..."}, {"owner": {"reputation": 509, "user_id": 7254473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fkwvm.jpg?s=128&g=1", "display_name": "Jonny B", "link": "https://stackoverflow.com/users/7254473/jonny-b"}, "reply_to_user": {"reputation": 1168, "user_id": 381447, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54b1ca7c6dda29d4b8bfb8aadf2a208f?s=128&d=identicon&r=PG", "display_name": "Daveel", "link": "https://stackoverflow.com/users/381447/daveel"}, "edited": false, "score": 0, "creation_date": 1609960726, "post_id": 58773561, "comment_id": 115986792, "body": "Ya. It&#39;s really annoying. I&#39;ve given up on Plaid."}], "tags": [], "owner": {"reputation": 509, "user_id": 7254473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fkwvm.jpg?s=128&g=1", "display_name": "Jonny B", "link": "https://stackoverflow.com/users/7254473/jonny-b"}, "is_accepted": true, "score": 3, "last_activity_date": 1573656370, "last_edit_date": 1573656370, "creation_date": 1573245918, "answer_id": 58773561, "question_id": 58674564, "link": "https://stackoverflow.com/questions/58674564/plaid-only-giving-item-login-required-for-capital-one/58773561#58773561", "title": "Plaid only giving &quot;ITEM_LOGIN_REQUIRED&quot; for Capital One", "body": "<p>According to Plaid support this one is actually on their end.</p>\n\n<blockquote>\n  <p>Plaid Support Nov 8, 2019,</p>\n  \n  <p>Thanks for reaching out to Plaid Support!</p>\n  \n  <p>I've confirmed that there is an issue with our Capital integration\n  that is causing this issue. Our engineering team is aware of this\n  issue and currently working to resolve it. We will reach out here as\n  soon as this is resolved.</p>\n  \n  <p>Please let us know if you have any further questions or concerns.\n  Thanks for your patience while we work to resolve this!</p>\n  \n  <p>Best, Phillippa Plaid Suppor</p>\n</blockquote>\n\n<p>I asked if there was an ETA or Workaround and here is their reply.</p>\n\n<blockquote>\n  <p>We are dedicating ongoing resources to resolving this issue, but\n  unfortunately Capital One hasn't been cooperative and we can\u2019t\n  anticipate a timeline for a technical resolution at this point. There\n  isn't currently a workaround that I'm aware of. I sincerely apologize\n  for the inconvenience that this causes \u2013 this issue is unique to our\n  Capital One integration, and does not affect the other institutions\n  that we support.</p>\n  \n  <p>We'll be sure to reach back out here as soon as we have any updates!</p>\n  \n  <p>Best, Nicole</p>\n</blockquote>\n\n<p>Plaid Support</p>\n"}], "owner": {"reputation": 509, "user_id": 7254473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fkwvm.jpg?s=128&g=1", "display_name": "Jonny B", "link": "https://stackoverflow.com/users/7254473/jonny-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 759, "favorite_count": 0, "accepted_answer_id": 58773561, "answer_count": 1, "score": 5, "last_activity_date": 1573656502, "creation_date": 1572722970, "last_edit_date": 1573656502, "question_id": 58674564, "link": "https://stackoverflow.com/questions/58674564/plaid-only-giving-item-login-required-for-capital-one", "title": "Plaid only giving &quot;ITEM_LOGIN_REQUIRED&quot; for Capital One", "body": "<p>I'm using plaid to attempt to get transactions from a linked account. In sandbox I was not getting any errors but once I moved into development I started <code>seeing \"ITEM_LOGIN_REQUIRED\"</code> while trying to get transactions. I'm using the plaid react component and plaid ruby gem. I suspect that there isn't an error in my code as much as the flow through Plaids api which like the following</p>\n\n<p>User interacts with Link -> logs into account with creds -> account is linked and public_token is returned -> public_token exchanged for access_token which is stored in DB -> access_token used to lookup transactions -> Plaid returns error. -> take user through update mode -> lookup transactions -> error -> rinse and repeat.</p>\n\n<p>Below is where I'm looking up transaction and where I get the error.</p>\n\n<pre><code>    start_date = Date.new(date[0].to_i, date[1].to_i, 1).strftime('%Y-%m-%d')\n    end_date = Date.new(date[0].to_i, date[1].to_i, -1).strftime('%Y-%m-%d')\n\n    plaid_env = Rails.application.config.plaid_env\n    client_id = Rails.application.config.client_id\n    secret = Rails.application.config.secret\n    public_key = Rails.application.config.public_key\n\n    client = Plaid::Client.new(env: plaid_env,\n                               client_id: client_id,\n                               secret: secret,\n                               public_key: public_key)\n\n    transaction_response = client.transactions.get(access_token, start_date, end_date)\n\n    transactions = transaction_response.transactions\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "setup-project"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 14248183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cf32461e7e448e49fc8c8f6cd2c1e44?s=128&d=identicon&r=PG&f=1", "display_name": "devRuurd", "link": "https://stackoverflow.com/users/14248183/devruurd"}, "is_accepted": false, "score": 0, "last_activity_date": 1599656285, "creation_date": 1599656285, "answer_id": 63812222, "question_id": 58674369, "link": "https://stackoverflow.com/questions/58674369/sasssyntaxerror-in-pagesindex-error-message-undefined-variable-enable-gr/63812222#63812222", "title": "Sass::SyntaxError in Pages#index : Error message Undefined variable: &quot;$enable-grid-classes&quot;", "body": "<p>Have you tried changing the loading order of the Bootstrap files? E.g.</p>\n<pre><code>// required bootstrap files\n@import &quot;../../vendor/twbs/bootstrap/scss/functions&quot;;\n@import &quot;../../vendor/twbs/bootstrap/scss/variables&quot;;\n@import &quot;../../vendor/twbs/bootstrap/scss/mixins&quot;;\n\n// optional bootstrap files\n@import &quot;../../vendor/twbs/bootstrap/scss/grid&quot;;\n...\n</code></pre>\n<p>Namespaces based on my own config (using Composer).</p>\n"}], "owner": {"reputation": 157, "user_id": 9322828, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215722452876336/picture?type=large", "display_name": "Damien Comp&#232;re", "link": "https://stackoverflow.com/users/9322828/damien-comp%c3%a8re"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 309, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1599656285, "creation_date": 1572721489, "last_edit_date": 1572733198, "question_id": 58674369, "link": "https://stackoverflow.com/questions/58674369/sasssyntaxerror-in-pagesindex-error-message-undefined-variable-enable-gr", "title": "Sass::SyntaxError in Pages#index : Error message Undefined variable: &quot;$enable-grid-classes&quot;", "body": "<p>On my project, I try to get the configuration sent by my friend. Here is the following step I did for the moment : \n- open a new project rails\n- copy / paste his package.json\n- run npm install \n- copy the css and script folders in my project</p>\n\n<p>And now I have the error Sass::SyntaxError in Pages#index\n / Undefined variable: \"$enable-grid-classes\". when I try to import ../node_modules/bootstrap/scss/grid\"</p>\n\n<p>Here is my application.scss</p>\n\n<pre><code> */\n @charset \"UTF-8\";\n\n /* // 0. Configuration and helpers */\n @import \"abstracts/_variables.scss\"; \n @import \"abstracts/_mixins.scss\";\n /* // @import \"abstracts/animations\"; */\n\n /* // 1. External */\n @import \"vendors\";\n\n /* // 2. Base stuff */\n @import \"base/reboot\";\n @import \"base/base\";\n @import \"base/grid\";\n @import \"base/utilities\";\n\n /* // 3. Components */\n @import \"components/about\";\n @import \"components/accordion\";\n @import \"components/advantage\";\n @import \"components/burger\";\n @import \"components/button\";\n @import \"components/card\";\n @import \"components/computer\";\n @import \"components/creditcard\";\n @import \"components/detail\";\n @import \"components/demo\";\n @import \"components/feature\";\n @import \"components/gallery\";\n @import \"components/hero\";\n @import \"components/intro\";\n @import \"components/job\";\n @import \"components/keyfact\";\n @import \"components/leader\";\n @import \"components/link\";\n @import \"components/menu\";\n @import \"components/notice\";\n @import \"components/optin\";\n @import \"components/popover\";\n @import \"components/press\";\n @import \"components/pricing\";\n @import \"components/profile\";\n @import \"components/rotate\";\n @import \"components/sheet\";\n @import \"components/shape\";\n @import \"components/slider-advantages\";\n @import \"components/slider-customers\";\n @import \"components/slider-press\";\n @import \"components/slider-sheets\";\n /* // @import \"components/slider-team\"; */\n @import \"components/star\";\n @import \"components/sticky\";\n @import \"components/switch\";\n @import \"components/tab\";\n @import \"components/team\";\n @import \"components/testimony\";\n @import \"components/title\";\n @import \"components/trust\";\n</code></pre>\n\n<p>and the css file where I have the error : </p>\n\n<pre><code>.col-d {\n  display: flex;\n}\n\n@include mq {\n  @include col;\n}\n\n@include mq(ml) {\n  @include col(79px);\n}\n\n// @include mq(l) {\n//   @include col(104px);\n// }\n\n@include mq(xl) {\n  @include col(122px);\n}\n\n$grid-columns: 12;\n$grid-gutter-width: $gutter;\n\n$grid-breakpoints: (\n  s: 0,\n  t: $mq-t,\n  m: $mq-m,\n  ml: $mq-ml,\n  // l: $mq-l,\n  xl: $mq-xl,\n);\n\n$container-max-widths: (\n  t: $container-t,\n  m: $container-m,\n  ml: $container-ml,\n  // l: $container-l,\n  xl: $container-xl,\n);\n\n@import \"../../../../node_modules/bootstrap/scss/grid\";\n@import \"../../../../node_modules/bootstrap/scss/utilities/flex\";\n</code></pre>\n\n<p>My gemfile : </p>\n\n<pre><code>ruby '2.6.3'\n\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\ngem 'rails', '~&gt; 6.0.0'\n# Use sqlite3 as the database for Active Record\ngem 'sqlite3', '~&gt; 1.4'\n# Use Puma as the app server\ngem 'puma', '~&gt; 3.11'\n# Use SCSS for stylesheets\ngem 'sass-rails', '~&gt; 5'\n# Transpile app-like JavaScript. Read more: https://github.com/rails/webpacker\ngem 'webpacker', '~&gt; 4.0'\n# Turbolinks makes navigating your web application faster. Read more: https://github.com/turbolinks/turbolinks\ngem 'turbolinks', '~&gt; 5'\n# Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder\ngem 'jbuilder', '~&gt; 2.7'\n# Use Redis adapter to run Action Cable in production\n# gem 'redis', '~&gt; 4.0'\n# Use Active Model has_secure_password\n# gem 'bcrypt', '~&gt; 3.1.7'\n\n# Use Active Storage variant\n# gem 'image_processing', '~&gt; 1.2'\n\n#Contentful \ngem 'contentful', '~&gt; 2.14'\n#contentful rails \ngem 'contentful_rails', '~&gt; 0.5.0'\n\ngem 'bootstrap-sass', '~&gt; 3.3', '&gt;= 3.3.6'\n\n# Reduces boot times through caching; required in config/boot.rb\ngem 'bootsnap', '&gt;= 1.4.2', require: false\n\ngroup :development, :test do\n  # Call 'byebug' anywhere in the code to stop execution and get a debugger console\n  gem 'byebug', platforms: [:mri, :mingw, :x64_mingw]\nend\n\ngroup :development do\n  # Access an interactive console on exception pages or by calling 'console' anywhere in the code.\n  gem 'web-console', '&gt;= 3.3.0'\n  gem 'listen', '&gt;= 3.0.5', '&lt; 3.2'\n  # Spring speeds up development by keeping your application running in the background. Read more: https://github.com/rails/spring\n  gem 'spring'\n  gem 'spring-watcher-listen', '~&gt; 2.0.0'\nend\n\ngroup :test do\n  # Adds support for Capybara system testing and selenium driver\n  gem 'capybara', '&gt;= 2.15'\n  gem 'selenium-webdriver'\n  # Easy installation and use of web drivers to run system tests with browsers\n  gem 'webdrivers'\nend\n\n# Windows does not include zoneinfo files, so bundle the tzinfo-data gem\ngem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]\n</code></pre>\n\n<p>My node_modules project is in grey tint, is it normal ? \nHow can i fix this error ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1572727339, "post_id": 58674334, "comment_id": 103651502, "body": "How does the model and migration for that table (and columns) look like?"}, {"owner": {"reputation": 21, "user_id": 2482671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e505f99ae2f60679f81b52cbf888a02?s=128&d=identicon&r=PG", "display_name": "user2482671", "link": "https://stackoverflow.com/users/2482671/user2482671"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1572790403, "post_id": 58674334, "comment_id": 103661666, "body": "@SebastianPalma updated to show model and migration"}], "owner": {"reputation": 21, "user_id": 2482671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e505f99ae2f60679f81b52cbf888a02?s=128&d=identicon&r=PG", "display_name": "user2482671", "link": "https://stackoverflow.com/users/2482671/user2482671"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1572790356, "creation_date": 1572721287, "last_edit_date": 1572790356, "question_id": 58674334, "link": "https://stackoverflow.com/questions/58674334/how-do-i-query-for-a-boolean-value-using-activerecordtypedstore-in-rails", "title": "How do I query for a boolean value using ActiveRecord::TypedStore in rails", "body": "<p>What is the syntax for querying a boolean value using ActiveRecord::TypedStore (<a href=\"https://github.com/byroot/activerecord-typedstore\" rel=\"nofollow noreferrer\">Github Link</a>)?</p>\n\n<p>Trying the below doesn't seem to work? and throws the following error:</p>\n\n<p><strong>PG::UndefinedFunction: ERROR: operator does not exist: text = boolean</strong></p>\n\n<pre><code>current_user\n  .companies\n  .where(\"holiday_request_settings -&gt;&gt; :key = :value\",\n         key: \"enable_holiday_requests\",\n         value: true)\n</code></pre>\n\n<p>If I try the following I get no results:</p>\n\n<pre><code>current_user\n  .companies\n  .where(\"holiday_request_settings -&gt;&gt; :key = :value\",\n         key: \"enable_holiday_requests\",\n         value: \"true\")\n</code></pre>\n\n<p>The company currently has the following data:</p>\n\n<pre><code>holiday_request_settings: {\n  \"enable_holiday_requests\"=&gt;true,\n  \"holiday_allowance_days\"=&gt;20\n}\n</code></pre>\n\n<p>This is the code on the Company model:</p>\n\n<pre><code>class Company &lt; ApplicationRecord\n  has_many :holiday_requests\n\n  typed_store :holiday_request_settings, coder: JSON do |s|\n    s.boolean :enable_holiday_requests, default: false\n    s.integer :holiday_allowance_days\n  end\n\nend\n</code></pre>\n\n<p>Migration for the Company Model:</p>\n\n<pre><code>add_column :companies, :holiday_request_settings, :json\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["ruby", "pointers", "data-structures", "binary-search-tree"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1572719261, "post_id": 58673955, "comment_id": 103649708, "body": "Changing <code>node</code> has zero impact on the caller. Everything you do in <code>remove_mode</code> manipulates a <i>local variable</i> and does nothing to the <code>node</code> inside of <code>remove(value)</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1572720258, "post_id": 58673955, "comment_id": 103649965, "body": "@J&#246;rg has given a good answer, which I do not think is likely to be improved upon, but you do yourself a disservice by selecting an answer so quickly, as it may well discourage other answers. Moreover, it may be considered a bit rude by those still working on their answers. Many askers wait a minimum of a couple of hours before making a selection; some wait considerably longer to allow readers around the world who are then fast asleep a chance to offer answers. There is no rush to make a selection. Please bear that in mind in future."}, {"owner": {"reputation": 109, "user_id": 7437474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b82a416804f199d9d37b740b2b5713e1?s=128&d=identicon&r=PG&f=1", "display_name": "C. Norwood", "link": "https://stackoverflow.com/users/7437474/c-norwood"}, "edited": false, "score": 0, "creation_date": 1572733132, "post_id": 58673955, "comment_id": 103652710, "body": "Fair enough, Cary.  I&#39;ll keep that in mind for the future :)"}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 7437474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b82a416804f199d9d37b740b2b5713e1?s=128&d=identicon&r=PG&f=1", "display_name": "C. Norwood", "link": "https://stackoverflow.com/users/7437474/c-norwood"}, "edited": false, "score": 0, "creation_date": 1572719703, "post_id": 58674032, "comment_id": 103649826, "body": "Thanks J&#246;rg.  That makes sense.  I guess I will need add a little extra logic to keep track of/identify parent Nodes efficiently, so I can set the references to the Nodes-to-be-removed to nil, thus sending them to the garbage collector."}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 2, "last_activity_date": 1572719139, "creation_date": 1572719139, "answer_id": 58674032, "question_id": 58673955, "link": "https://stackoverflow.com/questions/58673955/having-trouble-setting-an-object-to-nil-in-ruby-binary-search-tree/58674032#58674032", "title": "Having trouble setting an object to nil in ruby binary search tree", "body": "<p>You cannot \"set an object to <code>nil</code>\". An object can never change its class, it either is an instance of <code>Node</code> or it is an instance of <code>NilClass</code>, it cannot at one point in time be an instance of <code>Node</code> and at another point in time be an instance of <code>NilClass</code>.</p>\n\n<p>Likewise, an object cannot change its identity, object #4711 will always be object #4711, however, <code>nil</code> is a singleton, so there is only one <code>nil</code> and it has the same identity during the entire lifetime of the system.</p>\n\n<p>What you <em>can</em> do is to bind the <em>variable</em> which references the object to <code>nil</code>. You are doing the opposite operation inside your <code>insert</code> method.</p>\n"}], "owner": {"reputation": 109, "user_id": 7437474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b82a416804f199d9d37b740b2b5713e1?s=128&d=identicon&r=PG&f=1", "display_name": "C. Norwood", "link": "https://stackoverflow.com/users/7437474/c-norwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 58674032, "answer_count": 1, "score": 0, "last_activity_date": 1572719139, "creation_date": 1572718560, "question_id": 58673955, "link": "https://stackoverflow.com/questions/58673955/having-trouble-setting-an-object-to-nil-in-ruby-binary-search-tree", "title": "Having trouble setting an object to nil in ruby binary search tree", "body": "<p>I'm implementing a binary search tree in ruby, and I'm attempting to define a function to remove an value from the tree.  The Tree has a @root value that points to a Node object.  which is defined as such:</p>\n\n<pre><code>  class Node\n    attr_reader :value\n    attr_accessor :left, :right\n\n    def initialize value=nil\n      @value = value\n      @left = nil\n      @right = nil\n    end\n\n    # Add new value as child node to self, left or ride\n    # allows for duplicates, to L side of tree\n    def insert new_value\n      if new_value &lt;= @value\n        @left.nil? ? @left = Node.new(new_value) : @left.insert(new_value)\n      elsif new_value &gt; @value\n        @right.nil? ? @right = Node.new(new_value) : @right.insert(new_value)\n      end\n    end\n  end\n</code></pre>\n\n<p>Thus, the nodes all hold references to their L &amp; R children.  Everything works on the tree, inserting, traversing, performing a breadth-first-search (level-order-traverse) to return a Node value, if found.</p>\n\n<p>The problem I'm having is when trying to remove a Node object.  I can't figure out how to set the actual OBJECT to nil, or to its child, for example, rather than reassigning a POINTER/variable to nil and the object still existing.</p>\n\n<p>Tree has two functions that are supposed to do this (you can assume that breadth_first_search correctly returns the appropriate found node, as does smallest_r_child_of)</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>  def remove value\n    node = breadth_first_search(value)\n    return false if node.nil?\n\n    remove_node(node)\n  end\n\n  def remove_node node\n    if node.left.nil? &amp;&amp; node.right.nil?\n      node = nil\n    elsif !node.left.nil? &amp;&amp; node.right.nil?\n      node = node.left\n    elsif node.left.nil? &amp;&amp; !node.right.nil?\n      node = node.right\n    else\n      node = smallest_r_child_of(node)\n    end\n\n    return true\n  end\n</code></pre>\n\n<p>I thought that by passing in the actual node object to <code>remove_node</code>, that I could call <code>node = ____</code> and the like to reassign the actual object to something else, but all it does, as far as I can tell, is reset the <code>node</code> argument variable/pointer, while not actually reassigning my data at all.</p>\n\n<p>Does anyone have any tips/suggestions on how to accomplish what I'm trying to do?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1572720452, "post_id": 58673787, "comment_id": 103650012, "body": "To set off blocks of code indent 4 or more spaces or select the unindented code and click on <code>{}</code> above the editing box. To set off code within text surround it with backticks (e.g., `[1,2,3]`). (To show those backticks I had to excape them. Had I not done so you would see <code>[1,2,3]</code>.)"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1572720743, "post_id": 58673787, "comment_id": 103650085, "body": "As this code is written it&#39;s either incomplete or non-functional. For example: <code>price = price_input.to_f</code> but <code>price_input</code> is never defined. If you want a float from input <code>gets.to_f</code> does the trick."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1572720800, "post_id": 58673787, "comment_id": 103650096, "body": "When writing code like this, consider writing methods instead of just slapping the code right in the middle. That weight-rate calculator should be inside something like <code>def rate_for_weight(total_weight)</code> and then you can simplify how that&#39;s implemented."}, {"owner": {"reputation": 21, "user_id": 12311002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f674bc811f442f41239da1caa1e437b8?s=128&d=identicon&r=PG&f=1", "display_name": "bagelsnitch", "link": "https://stackoverflow.com/users/12311002/bagelsnitch"}, "edited": false, "score": 0, "creation_date": 1572721117, "post_id": 58673787, "comment_id": 103650171, "body": "I&#39;ve edited it properly and have included the rest of what I&#39;ve written (although, I apologize if it&#39;s now too much)."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1572725002, "post_id": 58673787, "comment_id": 103651013, "body": "It&#39;d benefit you a lot to use a debugger gem such as byebug to step through your code. However at minimum you can put a bunch of <code>puts</code> statements along the way to inspect the values"}], "answers": [{"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1572744848, "last_edit_date": 1572744848, "creation_date": 1572737557, "answer_id": 58676206, "question_id": 58673787, "link": "https://stackoverflow.com/questions/58673787/how-do-i-get-this-to-use-the-correct-elsif-statement/58676206#58676206", "title": "How do I get this to use the correct elsif statement?", "body": "<p>I thought it would perhaps be most useful to suggest how you might reorganize your code, but if this answers your specific question all the better. If it does not I believe someone else will do so before long.</p>\n\n<p>Your use of case statements to determine the applicable rate and discount is fine, but here is an alternative way of doing that.</p>\n\n<pre><code>RATES     = [[2, 0.10], [10, 0.20], [40, 0.30], [70, 0.50], [100, 0.75],\n             [Float::INFINITY, 0.90]]\n\nDISCOUNTS = [[9, 1.0], [39, 0.9], [69, 0.8], [99, 0.7], [Float::INFINITY, 0.6]]\n</code></pre>\n\n<p>The <code>RATES</code> array gives the shipping cost per book depending on the maximum weight of all books. If that weight is less than <code>2</code> (pounds, say), the costs is (in dollars, say) $0.10 per book. If the total weight is greater than <code>2</code> but less than <code>10</code>, the unit shipping cost is $0.20, and so on. The unit cost is <code>$0.90</code> if the total weight is <code>99</code> pounds or more. (Why these amounts are increasing I cannot say.)</p>\n\n<p>Similarly, if fewer than <code>9</code> books are ordered the discount per book is <code>1%</code>; if at least <code>9</code> but less than <code>39</code> ordered, the discount per book is <code>0.9%</code>, and so on. (I'd expect the discount percentages to be going up, but who am I to say.)</p>\n\n<p>Now let's ask the user some questions. We might create a simple method to reduce the amount of repetitive code.</p>\n\n<pre><code>def ask(str)\n  print str\n  gets.to_f\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>price    = ask(\"Please enter the price of one book: \")  #=&gt; 43.12\nweight   = ask(\"Please enter the weight of one book: \") #=&gt; 1.45\nquantity = ask(\"Please enter the quantity of books: \")  #=&gt; 30.0\n</code></pre>\n\n<p>The quantities on the right are the three values I entered. Next compute the subtotal:</p>\n\n<pre><code>subtotal = price * quantity\n  #=&gt; 1293.6\n</code></pre>\n\n<p>Since <code>price</code> and <code>quantity</code> are floats, <code>subtotal</code> will also be a float. (In fact, if <code>price</code> were a float and <code>quantity</code> were an integer, <code>subtotal</code> would still be a float.)</p>\n\n<p>Now let's compute the shipping cost and discount. Again, to avoid repetitive code, let's create a simple method:</p>\n\n<pre><code>def rate_or_discount(arr, amt)\n  arr.find { |k,v| amt &lt; k }.last\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>total_weight = quantity * weight\n  #=&gt; 43.5 \nrate = rate_or_discount(RATES, total_weight)\n  #=&gt; 0.5\nship_cost = total_weight * rate\n  #=&gt; 21.75      \n</code></pre>\n\n<p>Do you understand why <code>0.5</code> was returned for <code>rate</code>?</p>\n\n<p>Now compute the discount and then the total cost.</p>\n\n<pre><code>discount = 0.01 * rate_or_discount(DISCOUNTS, quantity)\n  #=&gt; 0.009000000000000001 \ntotal_cost = (1 - discount) * subtotal + ship_cost\n  #=&gt; 1303.7076 \n</code></pre>\n\n<p>Note that <code>(1 - discount)</code> is a float since <code>discount</code> is a float.</p>\n\n<p>We can now display the values of interest.</p>\n\n<pre><code>puts sprintf(\"Subtotal: $%.2f\", subtotal.round(2))\nSubtotal: $1293.60\n\nputs sprintf(\"Shipping: $%.2f\", ship_cost.round(2))\nShipping: $21.75\n\nputs sprintf(\"Total cost: $%.2f\", total_cost.round(2))\nTotal cost: $1303.71\n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/core-2.6.3/Kernel.html#method-i-sprintf\" rel=\"nofollow noreferrer\">Kernel#sprinf</a> for explanations of the formatting codes I used.</p>\n\n<p>One could instead write (note the newline character):</p>\n\n<pre><code>printf(\"Subtotal: $%.2f\\n\", subtotal.round(2))\nSubtotal: $1293.60\n</code></pre>\n\n<p>Had I instead written:</p>\n\n<pre><code>puts \"Subtotal: $#{subtotal.round(2)}\"\n</code></pre>\n\n<p>the line</p>\n\n<pre><code>Subtotal: $1293.6\n</code></pre>\n\n<p>would have been displayed, which has the trailing zero lopped off.</p>\n\n<p>See also <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-find\" rel=\"nofollow noreferrer\">Enumerable#find</a> and <a href=\"https://ruby-doc.org/core-2.6.3/Float.html#method-i-round\" rel=\"nofollow noreferrer\">Float#round</a>. </p>\n"}], "owner": {"reputation": 21, "user_id": 12311002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f674bc811f442f41239da1caa1e437b8?s=128&d=identicon&r=PG&f=1", "display_name": "bagelsnitch", "link": "https://stackoverflow.com/users/12311002/bagelsnitch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572744848, "creation_date": 1572717556, "last_edit_date": 1572720900, "question_id": 58673787, "link": "https://stackoverflow.com/questions/58673787/how-do-i-get-this-to-use-the-correct-elsif-statement", "title": "How do I get this to use the correct elsif statement?", "body": "<p>The answer ends up being half of what it should be. It is using a lesser rate than it should, and I don't know why. For example, 45 books at a weight of 1.5 is being multiplied by rate = 0.20, but it be multiplied by rate = 0.50.</p>\n\n<p>I have tried adjusting .to_i and .to_f, among a variety of other things.</p>\n\n<pre><code>puts \"Please enter the price of one book.\" #Asks for book price\nprice_input = gets #Stores book price\nputs \"Please enter the weight of one book.\" #Asks for book weight\nweight_input = gets #Stores book weight\nputs \"Please enter the quantity of books.\" #Asks for number of books\nquantity_input = gets #stores number of books\nprice = price_input.to_f\nweight = weight_input.to_f\nquantity = quantity_input.to_f\n\n#Determine shipping cost per pound\ntotal_weight = quantity * weight\ntotal_weight = total_weight.to_f\n\nif (total_weight &lt; 2)\n     rate = 0.10\n   elsif ((total_weight &gt;= 2) or (total_weight &lt; 10))\n     rate = 0.20\n   elsif ((total_weight &gt;= 10) or (total_weight &lt; 40))\n     rate = 0.30\n   elsif ((total_weight &gt;= 40) or (total_weight &lt; 70))\n     rate = 0.50\n   elsif ((total_weight &gt;= 70) or (total_weight &lt; 100))\n     rate = 0.75\n   else (total_weight &gt;= 100)\n     rate = 0.90\nend\nrate = rate.to_f\nship_cost = total_weight * rate.to_f\nship_cost = ship_cost.to_f\n\n#Determine discount based on quantity\nif ((quantity &gt;= 0) or (quantity &lt;= 9))\n  discount = 1\nelsif ((quantity &gt;= 10) or (quantity &lt;= 39))\n  discount = 0.9\nelsif ((quantity &gt;= 40) or (quantity &lt;= 69))\n  discount = 0.8\nelsif ((quantity &gt;= 70) or (quantity &lt;= 99))\n  discount = 0.7\nelse (quantity &gt;= 100)\n  discount = 0.6\nend\n\ndiscount = discount.to_f\nd_cost = quantity * discount.to_f\nd_cost = d_cost.to_f\n\n#Display final costs\nputs \"Subtotal: #{price * quantity}\"\nputs \"Shipping: #{ship_cost}\"\nputs \"Discount: #{d_cost}\"\nputs \"Total cost: #{(price * quantity - d_cost) + ship_cost}\"\n</code></pre>\n\n<p>The results I'm getting should be double than what they are.</p>\n"}]