[{"tags": ["ruby", "conditional-statements"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1576715878, "post_id": 59401507, "comment_id": 104992719, "body": "What rules are there? Is <code>arr == arr.sort</code> a valid test?"}, {"owner": {"reputation": 1444, "user_id": 188870, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f1945436277d2a4ae7ba54e77cdeb853?s=128&d=identicon&r=PG", "display_name": "unflores", "link": "https://stackoverflow.com/users/188870/unflores"}, "edited": false, "score": 0, "creation_date": 1576744362, "post_id": 59401507, "comment_id": 104999669, "body": "Just for info, it is usually helpful for others to post the error message that you are getting."}, {"owner": {"reputation": 3, "user_id": 12561604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dff7103d20630c3278da80c8e3d5d4a6?s=128&d=identicon&r=PG&f=1", "display_name": "user12561604", "link": "https://stackoverflow.com/users/12561604/user12561604"}, "edited": false, "score": 0, "creation_date": 1576771805, "post_id": 59401507, "comment_id": 105013885, "body": "arr.sort is valid but I&#39;ve just started writing code so I was trying to do it without using .sort. Also, thanks for error message tip I&#39;ll be sure to include it in future questions it&#39;s just that this ran although incorrectly."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1576715774, "post_id": 59401740, "comment_id": 104992697, "body": "Even easier: <a href=\"https://ruby-doc.org/core-2.6.5/Enumerable.html#method-i-each_cons\" rel=\"nofollow noreferrer\"><code>each_cons(2)</code></a>."}], "tags": [], "owner": {"reputation": 1444, "user_id": 188870, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f1945436277d2a4ae7ba54e77cdeb853?s=128&d=identicon&r=PG", "display_name": "unflores", "link": "https://stackoverflow.com/users/188870/unflores"}, "is_accepted": false, "score": 1, "last_activity_date": 1576714700, "creation_date": 1576714700, "answer_id": 59401740, "question_id": 59401507, "link": "https://stackoverflow.com/questions/59401507/why-does-elsif-condition-get-skipped-while-iterating-over-an-array/59401740#59401740", "title": "Why does elsif condition get skipped while iterating over an array?", "body": "<p>The problem here is that <code>num</code> is actually your number and not an array. This should explode on you. A standard <code>each</code> statement like that doesn't use indexes. The iterator just passes you the value in the ruby block.</p>\n\n<p>If you wanted to check before and after you'd have to look into <code>each_with_index</code> and then dereference the next index on the array.</p>\n\n<pre><code>arr.each_with_index do |num, index|\n  next if index+1 == arr.length\n\n  puts num &gt; arr[index+1]\nend\n</code></pre>\n\n<p>This will iterate over the array <code>arr</code> and for each index, it will compare that number vs the next index and print <code>true</code> if descending.</p>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1576765769, "post_id": 59401869, "comment_id": 105010516, "body": "we can add <code>break unless asc || desc</code> to the end of the <code>each_cons</code> loop in improve efficiency as a fail fast"}], "tags": [], "owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "is_accepted": true, "score": 2, "last_activity_date": 1576715871, "creation_date": 1576715871, "answer_id": 59401869, "question_id": 59401507, "link": "https://stackoverflow.com/questions/59401507/why-does-elsif-condition-get-skipped-while-iterating-over-an-array/59401869#59401869", "title": "Why does elsif condition get skipped while iterating over an array?", "body": "<p>In fact, your <code>num[0] &lt; num[0 + 1]</code> does something that differs a lot from your expectations. Here you're comparing <em>bits of the integer values</em>, not array items as you might think. It doesn't produce any exceptions because this is a \"valid\" code, but it is broken logically.</p>\n\n<p>The <code>each</code> iterator just yields array elements one by one, so if you want to check two items at once, you have either to yield index (<code>Array#each_index</code>) or to use <code>Enumerable#each_cons</code>.</p>\n\n<p>But this is not the only problem. The bigger one is the logic itself. In fact, with your current implementation (if you fix the thing I mentioned above) only the last pair of elements will be taken into account (which is obviously wrong) - because each next check doesn't take into account the previous one(s).</p>\n\n<p>One of the possible solutions, for example (just pls note: the task definition is not complete - it is not clear what is the desired output for a \"ascending-and-descending\" array that has the only element):</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def is_sorted_and_how(arr)\n  asc = desc = true\n\n  arr.each_cons(2) do |x, y|\n    asc &amp;&amp;= x &lt;= y\n    desc &amp;&amp;= x &gt;= y\n  end\n\n  if asc\n    \"yes, ascending\"\n  elsif desc\n    \"yes, descending\"\n  else\n    \"no\"\n  end\nend\n\nis_sorted_and_how([1, 2])\n# =&gt; \"yes, ascending\"\nis_sorted_and_how([15, 7, 3, -8])\n# =&gt; \"yes, descending\"\nis_sorted_and_how([4, 2, 30])\n# =&gt; \"no\"\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12561604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dff7103d20630c3278da80c8e3d5d4a6?s=128&d=identicon&r=PG&f=1", "display_name": "user12561604", "link": "https://stackoverflow.com/users/12561604/user12561604"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 59401869, "answer_count": 2, "score": 0, "last_activity_date": 1576745354, "creation_date": 1576712660, "last_edit_date": 1576745354, "question_id": 59401507, "link": "https://stackoverflow.com/questions/59401507/why-does-elsif-condition-get-skipped-while-iterating-over-an-array", "title": "Why does elsif condition get skipped while iterating over an array?", "body": "<p>I am iterating over every number in the array to see if array is descending or ascending, but the <code>elsif</code> is skipped for some reason.  </p>\n\n<pre><code> def is_sorted_and_how(arr)\n        str = \"\"\n        arr.each do |num| \n\n          if num[0] &lt; num[0 + 1]\n            str = \"yes, ascending\"\n          elsif num[0] &gt; num[0 + 1]\n            str = \"yes, descending\"\n          else\n            str = \"no\"\n          end\n\n        end\n        str\n    end\n\n\n    Test.assert_equals(is_sorted_and_how([1, 2]), 'yes, ascending')\n    Test.assert_equals(is_sorted_and_how([15, 7, 3, -8]), 'yes, descending')\n    Test.assert_equals(is_sorted_and_how([4, 2, 30]), 'no')\n</code></pre>\n"}, {"tags": ["ruby", "unix"], "comments": [{"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1576724870, "post_id": 59401362, "comment_id": 104994348, "body": "What distro and GUI environment? Which file browser?"}, {"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1576725341, "post_id": 59401362, "comment_id": 104994421, "body": "What happens if you rename it to <code>filename.rb</code> and try again?"}, {"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1576725366, "post_id": 59401362, "comment_id": 104994425, "body": "Also if you are using Ubuntu, see here how to associate programs with file extensions: <a href=\"https://askubuntu.com/questions/289337/how-can-i-change-file-association-globally\" title=\"how can i change file association globally\">askubuntu.com/questions/289337/&hellip;</a>"}, {"owner": {"reputation": 63, "user_id": 10665476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4f7dbb56d9dcd2f72ff0a82ab21956?s=128&d=identicon&r=PG&f=1", "display_name": "Wesley Lance", "link": "https://stackoverflow.com/users/10665476/wesley-lance"}, "reply_to_user": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1576732587, "post_id": 59401362, "comment_id": 104995792, "body": "I&#39;m on Ubuntu 18.04 using default gnome-terminal. Renaming the file doesn&#39;t change anything."}], "owner": {"reputation": 63, "user_id": 10665476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4f7dbb56d9dcd2f72ff0a82ab21956?s=128&d=identicon&r=PG&f=1", "display_name": "Wesley Lance", "link": "https://stackoverflow.com/users/10665476/wesley-lance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576715943, "creation_date": 1576711552, "question_id": 59401362, "link": "https://stackoverflow.com/questions/59401362/ruby-executable-runs-from-terminal-but-not-from-file-browser", "title": "Ruby executable runs from terminal but not from file browser", "body": "<p>I have a ruby file that I've given executable permissions and set up such that typing</p>\n\n<pre><code>./filename\n</code></pre>\n\n<p>works just fine. However, attempting to run the file just by double clicking it through Files either opens it in a text editor or does nothing, depending on how I've configured it through dconf-editor. How can I get it to run properly through Files?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "error-handling", "rubygems", "bundler"], "comments": [{"owner": {"reputation": 672, "user_id": 645362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9d026a3b6dcc700b37be4a41f5776f8?s=128&d=identicon&r=PG", "display_name": "Fernando Silveira", "link": "https://stackoverflow.com/users/645362/fernando-silveira"}, "edited": false, "score": 0, "creation_date": 1577278510, "post_id": 59401272, "comment_id": 105134131, "body": "Did you find a solution? I tried installing v8 with brew and running <code>bundle config build.therubyracer --with-v8-dir=$(brew --prefix v8@3.15)</code> but I still get the same errors you did"}, {"owner": {"reputation": 121, "user_id": 12388282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7FlYN.jpg?s=128&g=1", "display_name": "Dejv", "link": "https://stackoverflow.com/users/12388282/dejv"}, "reply_to_user": {"reputation": 672, "user_id": 645362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9d026a3b6dcc700b37be4a41f5776f8?s=128&d=identicon&r=PG", "display_name": "Fernando Silveira", "link": "https://stackoverflow.com/users/645362/fernando-silveira"}, "edited": false, "score": 0, "creation_date": 1577919795, "post_id": 59401272, "comment_id": 105281950, "body": "Yes, I found. Check my answer below."}], "answers": [{"tags": [], "owner": {"reputation": 121, "user_id": 12388282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7FlYN.jpg?s=128&g=1", "display_name": "Dejv", "link": "https://stackoverflow.com/users/12388282/dejv"}, "is_accepted": true, "score": 9, "last_activity_date": 1577919745, "creation_date": 1577919745, "answer_id": 59556806, "question_id": 59401272, "link": "https://stackoverflow.com/questions/59401272/bundle-install-therubyracer-gem-cannot-be-installed-on-macos-catalina-10-15-2/59556806#59556806", "title": "Bundle Install / TheRubyRacer gem cannot be installed on MacOS Catalina 10.15.2", "body": "<p>I've found the solution for this error.\nIf you have a problem with <code>bundle install</code> check this:</p>\n\n<pre><code>gem list libv8 --remote --all\ngem install libv8 -v 3.16.14.19 -- --with-system-v8\ngem install therubyracer -- --with-v8-dir=/Users/YOUR_NAME/homebrew/opt/v8@3.15\n</code></pre>\n\n<p>It works for me, after few hours of fighting with every solution I can find.\nHope it'll help someone.</p>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 1782972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9932d585213313458aa7e1e6836f7a2?s=128&d=identicon&r=PG", "display_name": "Kevin Morwood", "link": "https://stackoverflow.com/users/1782972/kevin-morwood"}, "edited": false, "score": 0, "creation_date": 1587563123, "post_id": 60530905, "comment_id": 108559935, "body": "I&#39;m not sure the difference but my homebrew did not follow the install pattern of the other solution...but did follow yours. So, safe to say that wherever v8 was installed...that&#39;s the path you need. Thanks for the help!"}], "tags": [], "owner": {"reputation": 99, "user_id": 12417767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d36bf60990cf0c28f82d8d194d9f7b07?s=128&d=identicon&r=PG", "display_name": "Shailendra Shukla", "link": "https://stackoverflow.com/users/12417767/shailendra-shukla"}, "is_accepted": false, "score": 6, "last_activity_date": 1583340253, "creation_date": 1583340253, "answer_id": 60530905, "question_id": 59401272, "link": "https://stackoverflow.com/questions/59401272/bundle-install-therubyracer-gem-cannot-be-installed-on-macos-catalina-10-15-2/60530905#60530905", "title": "Bundle Install / TheRubyRacer gem cannot be installed on MacOS Catalina 10.15.2", "body": "<p>I was stuck on the same issue and got help from this <a href=\"https://gist.github.com/fernandoaleman/868b64cd60ab2d51ab24e7bf384da1ca\" rel=\"noreferrer\">gist</a>.</p>\n\n<pre><code>brew install v8@3.15\ngem install libv8 -v 'YOUR_VERSION' -- --with-system-v8\ngem install therubyracer -v 'YOUR_VERSION' -- --with-v8-dir=/usr/local/opt/v8@3.15\nbundle install\n</code></pre>\n\n<p>I am using macOS Catalina version 10.15.3 and ruby version 2.6.3. I hope it helps!</p>\n"}, {"tags": [], "owner": {"reputation": 356, "user_id": 4927569, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/17463e7b2c0eb564ed2742aa3637993f?s=128&d=identicon&r=PG&f=1", "display_name": "David Milanese", "link": "https://stackoverflow.com/users/4927569/david-milanese"}, "is_accepted": false, "score": 0, "last_activity_date": 1600519146, "creation_date": 1600519146, "answer_id": 63968897, "question_id": 59401272, "link": "https://stackoverflow.com/questions/59401272/bundle-install-therubyracer-gem-cannot-be-installed-on-macos-catalina-10-15-2/63968897#63968897", "title": "Bundle Install / TheRubyRacer gem cannot be installed on MacOS Catalina 10.15.2", "body": "<p>Uninstalling <code>v8</code> and install <code>v8@3.15</code> on a fresh Catalina install worked for me.</p>\n<pre class=\"lang-sh prettyprint-override\"><code>$ brew uninstall v8\n$ brew install v8@3.15\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8367354, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DBXEfLP0jac/AAAAAAAAAAI/AAAAAAAAAFA/w55zXtjWriI/photo.jpg?sz=128", "display_name": "Aakash Verma", "link": "https://stackoverflow.com/users/8367354/aakash-verma"}, "is_accepted": false, "score": 0, "last_activity_date": 1601143470, "creation_date": 1601143470, "answer_id": 64080976, "question_id": 59401272, "link": "https://stackoverflow.com/questions/59401272/bundle-install-therubyracer-gem-cannot-be-installed-on-macos-catalina-10-15-2/64080976#64080976", "title": "Bundle Install / TheRubyRacer gem cannot be installed on MacOS Catalina 10.15.2", "body": "<p>I have faced the same issue recently in Mac OS 10.15.7</p>\n<pre><code>brew install v8-315 \ngem install libv8 -v '3.16.14.19' -- --with-system-v \ngem install therubyracer -v '0.12.3' -- --with-system-v8 --with-v8-dir=/usr/local/opt/v8@3.15\n</code></pre>\n<p><strong>Note:</strong> while installing ruby race it installed only after putting both the options together --with-system-v8 and --with-v8-dir and pointing to that directory.\nPlease do verify if the folder exist in that path or not before installing.</p>\n"}], "owner": {"reputation": 121, "user_id": 12388282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7FlYN.jpg?s=128&g=1", "display_name": "Dejv", "link": "https://stackoverflow.com/users/12388282/dejv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2368, "favorite_count": 1, "accepted_answer_id": 59556806, "answer_count": 4, "score": 3, "last_activity_date": 1601143470, "creation_date": 1576710888, "question_id": 59401272, "link": "https://stackoverflow.com/questions/59401272/bundle-install-therubyracer-gem-cannot-be-installed-on-macos-catalina-10-15-2", "title": "Bundle Install / TheRubyRacer gem cannot be installed on MacOS Catalina 10.15.2", "body": "<p>I'm getting tired of error when trying to bundle install and install therubyracer.\nI've tried everything from around the net and nothing helps.\nAlready installed libv8 and x-code setup. \n<strong>Appreciate your help!</strong></p>\n\n<p>After command <code>sudo gem install therubyracer -v '0.12.3'</code>, I'm receivin error:</p>\n\n<pre><code>    ERROR: Failed to build gem native extension.\n\n    current directory: /Library/Ruby/Gems/2.6.0/gems/therubyracer-0.12.3/ext/v8\n/System/Library/Frameworks/Ruby.framework/Versions/2.6/usr/bin/ruby -I /System/Library/Frameworks/Ruby.framework/Versions/2.6/usr/lib/ruby/2.6.0 -r ./siteconf20191219-41979-115mu26.rb extconf.rb\nchecking for -lpthread... yes\nchecking for -lobjc... yes\nchecking for v8.h... no\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/System/Library/Frameworks/Ruby.framework/Versions/2.6/usr/bin/$(RUBY_BASE_NAME)\n    --with-pthreadlib\n    --without-pthreadlib\n    --with-objclib\n    --without-objclib\n    --enable-debug\n    --disable-debug\n    --with-v8-dir\n    --without-v8-dir\n    --with-v8-include\n    --without-v8-include=${v8-dir}/include\n    --with-v8-lib\n    --without-v8-lib=${v8-dir}/lib\n/Library/Ruby/Gems/2.6.0/gems/libv8-3.16.14.19/ext/libv8/location.rb:50:in `configure': By using --with-system-v8, you have chosen to use the version  (Libv8::Location::System::NotFoundError)\nof V8 found on your system and *not* the one that is bundled with\nthe libv8 rubygem.\n\nHowever, your system version of v8 could not be located.\n\nPlease make sure your system version of v8 that is compatible\nwith 3.16.14.19 installed. You may need to use the\n--with-v8-dir option if it is installed in a non-standard location\n    from /Library/Ruby/Gems/2.6.0/gems/libv8-3.16.14.19/lib/libv8.rb:7:in `configure_makefile'\n    from extconf.rb:32:in `&lt;main&gt;'\n\nTo see why this extension failed to compile, please check the mkmf.log which can be found here:\n\n  /Library/Ruby/Gems/2.6.0/extensions/universal-darwin-19/2.6.0/therubyracer-0.12.3/mkmf.log\n\nextconf failed, exit code 1 ```\n</code></pre>\n"}, {"tags": ["ruby", "integer"], "comments": [{"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1576724716, "post_id": 59400470, "comment_id": 104994321, "body": "Please paste the exact error message into your question. Do not write it by hand. Use copy and paste and include in the whole error message from start to finish."}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 1, "creation_date": 1576740823, "post_id": 59400470, "comment_id": 104998306, "body": "@Christian : Division by zero (on an Integer) would raise a <code>ZeroDivisionError</code>. Doing it as a float, would return a special value called <i>Infinity</i>.  Converting that to Integer, would raise a <code>FloatDomainError</code>. If your script returns the String you are getting, you will have to debug it to find where it comes from."}, {"owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "edited": false, "score": 0, "creation_date": 1576740908, "post_id": 59400470, "comment_id": 104998335, "body": "This is the exact error message sorry, will continue debugging today."}, {"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 1, "creation_date": 1576746801, "post_id": 59400470, "comment_id": 105000914, "body": "Do you use any native extensions? What&#39;s your Ruby version? What is happening here is some non-Ruby code tries to convert a Ruby <code>Float</code> to C&#39;s <code>long </code>which doesn&#39;t support infinite values or NaN. A backtrace would be helpful."}, {"owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "edited": false, "score": 0, "creation_date": 1576795958, "post_id": 59400470, "comment_id": 105023050, "body": "Thanks for all the hints."}], "answers": [{"tags": [], "owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "is_accepted": true, "score": 0, "last_activity_date": 1576795819, "creation_date": 1576795819, "answer_id": 59417855, "question_id": 59400470, "link": "https://stackoverflow.com/questions/59400470/ruby-why-do-i-get-float-1-inf-out-of-range-or-float-1-ind-out-of-range-of-in/59417855#59417855", "title": "Ruby: Why do I get float 1.INF# out of range or float -1.#IND out of range of integer?", "body": "<p>I have found that:</p>\n\n<p><a href=\"https://inneka.com/programming/cpp/why-are-the-return-values-of-these-doubles-1-ind-2/\" rel=\"nofollow noreferrer\">https://inneka.com/programming/cpp/why-are-the-return-values-of-these-doubles-1-ind-2/</a> where someone asked \"Why are the return values of these doubles -1.#IND?\"</p>\n\n<p>It is related to some c++ code ... and as the software uses extensions build on / for windows it might indeed be the answer here.</p>\n\n<blockquote>\n  <p>John D Cook has an excellent reference:<br>\n  Windows displays a NaN as  -1.#IND (\"IND\" for \"indeterminate\")<br>\n  while Linux displays NaN.  </p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>if you get 1.#INF or inf, look for overflow or division by zero,<br>\n    if you get 1.#IND or nan, look for illegal operations </p>\n</blockquote>\n\n<p>Whatever illegal operations mean in this context ...</p>\n"}], "owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 59417855, "answer_count": 1, "score": 0, "last_activity_date": 1576795819, "creation_date": 1576706085, "last_edit_date": 1576759675, "question_id": 59400470, "link": "https://stackoverflow.com/questions/59400470/ruby-why-do-i-get-float-1-inf-out-of-range-or-float-1-ind-out-of-range-of-in", "title": "Ruby: Why do I get float 1.INF# out of range or float -1.#IND out of range of integer?", "body": "<p>I have a script which returns <code>float 1.INF# out of range of integer</code> and I don't know why ... Unfortunately I cannot share any code which leads to this error messages as I don't know where the error is raised and this is exactly my question. </p>\n\n<p>It turned out in a debug session in the past, that a division by 0 led to this similar strange error message: <code>float -1.#IND out of range of integer</code> I tracked down the source of the error message to <a href=\"https://github.com/ruby/ruby/blob/e732e0074e53e7ddbaf863197ec3775d7e9d4516/numeric.c#L2834\" rel=\"nofollow noreferrer\">ruby core numeric.c</a>.</p>\n\n<p>My questions are: </p>\n\n<ol>\n<li>Have both messages the same cause (division by zero)?</li>\n<li>Is there is any other case in which this error message appears?</li>\n</ol>\n\n<p>Update:</p>\n\n<p>Here's the code of my script, as you can see there was a potential division by zero leading to <code>float -1.#IND out of range of integer</code>.</p>\n\n<pre><code>first_value = 1000\nsecond_value = 0\n# zero value leads to NaN\n( first_value / 100.0 ) / ( second_value / 100.0 )\n</code></pre>\n\n<p>irb shows NaN for <code>(0 / 100.0) / 0</code> and <code>(0 / 100.0) / 0.0</code>.</p>\n"}, {"tags": ["ruby", "arguments", "parameter-passing"], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 6495617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679377a86dfa655f688a3b38dbb82912?s=128&d=identicon&r=PG&f=1", "display_name": "Bart_Judge", "link": "https://stackoverflow.com/users/6495617/bart-judge"}, "edited": false, "score": 0, "creation_date": 1576706284, "post_id": 59400450, "comment_id": 104990118, "body": "ah I see. the book does use  <code>people = 10.step(25,3).map {|i| Person.new(age: i) }</code> in order to instantiate multiple Person"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 89, "user_id": 6495617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679377a86dfa655f688a3b38dbb82912?s=128&d=identicon&r=PG&f=1", "display_name": "Bart_Judge", "link": "https://stackoverflow.com/users/6495617/bart-judge"}, "edited": false, "score": 0, "creation_date": 1576706601, "post_id": 59400450, "comment_id": 104990236, "body": "There you can see that options is a hash like <code>{ age: i }</code>."}, {"owner": {"reputation": 89, "user_id": 6495617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679377a86dfa655f688a3b38dbb82912?s=128&d=identicon&r=PG&f=1", "display_name": "Bart_Judge", "link": "https://stackoverflow.com/users/6495617/bart-judge"}, "edited": false, "score": 0, "creation_date": 1576707853, "post_id": 59400450, "comment_id": 104990703, "body": "@Sebatian One thought, at what point is the options hash created?"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 89, "user_id": 6495617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679377a86dfa655f688a3b38dbb82912?s=128&d=identicon&r=PG&f=1", "display_name": "Bart_Judge", "link": "https://stackoverflow.com/users/6495617/bart-judge"}, "edited": false, "score": 1, "creation_date": 1576708344, "post_id": 59400450, "comment_id": 104990860, "body": "The hash is the parameter you&#39;re using when invoking the method. Ruby allows you to omit the <code>{}</code> when the last (or only one) argument is a hash. So <code>Person.new({age: 100})</code> is pretty much the same as <code>Person.new(age: 100)</code>."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 2, "last_activity_date": 1576707155, "last_edit_date": 1576707155, "creation_date": 1576705966, "answer_id": 59400450, "question_id": 59400411, "link": "https://stackoverflow.com/questions/59400411/the-well-grounded-rubyist-syntax-question-optional-argument-or-hash-argument/59400450#59400450", "title": "The Well Grounded Rubyist - Syntax Question - Optional Argument or Hash Argument", "body": "<p><code>options</code> isn't an optional argument, because initializing a Person object without that argument would throw an <code>ArgumentError</code> error, because it's expecting one argument but you passed no argument:</p>\n\n<pre><code>Person.new\n#\u00a0file.rb:4:in `initialize': wrong number of arguments (given 0, expected 1) (ArgumentError)\n</code></pre>\n\n<p>In that case <code>options</code> is meant to be a hash or any object that responds to the method <code>[]</code>. So, if you initialize a Person object with hash containing the symbol key <code>age</code>, then <code>self.age</code> will take that value:</p>\n\n<pre><code>p Person.new(age: 100)\n# &lt;Person:0x00007ff05b84eab0 @age=100&gt;\n</code></pre>\n\n<p>The use of hash as arguments gives you a flexibility at the moment of invoking a method, because you can wrap any needed object into the hash, you just need to take care of handling them in the method definition.</p>\n\n<p>If you do <code>self.age = options</code> (or <code>@age = options</code>), then you're assigning to <code>self.age</code> the whole options object, which can be the whole hash or anything passed as the argument:</p>\n\n<pre><code>def initialize(options)\n  self.age = options\nend\n...\n\np Person.new(age: 100, another_thing: nil)\n# #&lt;Person:0x00007ff47e09aa18 @age={:age=&gt;100, :another_thing=&gt;nil}&gt;\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 6495617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679377a86dfa655f688a3b38dbb82912?s=128&d=identicon&r=PG&f=1", "display_name": "Bart_Judge", "link": "https://stackoverflow.com/users/6495617/bart-judge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 59400450, "answer_count": 1, "score": 0, "last_activity_date": 1576707155, "creation_date": 1576705654, "question_id": 59400411, "link": "https://stackoverflow.com/questions/59400411/the-well-grounded-rubyist-syntax-question-optional-argument-or-hash-argument", "title": "The Well Grounded Rubyist - Syntax Question - Optional Argument or Hash Argument", "body": "<p>I'm currently going through \"The Well Grounded Rubyist 2nd Edition\" I'm on page 296 and have been given the following code</p>\n\n<pre><code>class Person\n  attr_accessor :age\n\n  def initialize(options)\n    self.age = options[:age]\n  end\n\n  def teenager?\n    (13..19) === age\n  end\nend\n</code></pre>\n\n<p>what does <code>options[:age]</code> refer to?\nis it an optional argument or something?\nIf I were writing that class, I would have written that line like <code>@age = options</code></p>\n\n<p>Edit - I forgot to mention, I did find this question - <a href=\"https://stackoverflow.com/questions/9710303/rails-optional-argument\">Rails optional argument</a> - that uses the line used in the book. But i couldn't work out why it was used or why <code>options</code> was used with the symbol <code>[:age]</code>. </p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 940, "user_id": 573719, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0fd8ec69a77e30cfa30a66ad8d1762fb?s=128&d=identicon&r=PG", "display_name": "dezull", "link": "https://stackoverflow.com/users/573719/dezull"}, "edited": false, "score": 0, "creation_date": 1576716784, "post_id": 59400030, "comment_id": 104992892, "body": "Do you have something like this? Callback observer outside of your Models <a href=\"https://stackoverflow.com/questions/3913811/activerecord-global-callbacks-for-all-models\" title=\"activerecord global callbacks for all models\">stackoverflow.com/questions/3913811/&hellip;</a>"}, {"owner": {"reputation": 6933, "user_id": 26604, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e94ddf54b3d31c6eda0e1c76a58c3e74?s=128&d=identicon&r=PG", "display_name": "Kyle Heironimus", "link": "https://stackoverflow.com/users/26604/kyle-heironimus"}, "edited": false, "score": 0, "creation_date": 1576773526, "post_id": 59400030, "comment_id": 105014799, "body": "Can you destroy a record from another model (<code>Customer</code> <code>EInvoiceContact</code>) ? Maybe you are having some kind of MySQL issue where deletes are disabled. Maybe this will help: <a href=\"https://stackoverflow.com/questions/7948302/is-it-possible-to-disable-deletes-on-a-table-on-mysql\" title=\"is it possible to disable deletes on a table on mysql\">stackoverflow.com/questions/7948302/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 540, "user_id": 5046468, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-_MJIiKu6U44/AAAAAAAAAAI/AAAAAAAAAB0/X1g73J1CrQ4/photo.jpg?sz=128", "display_name": "Mi Ro", "link": "https://stackoverflow.com/users/5046468/mi-ro"}, "edited": false, "score": 0, "creation_date": 1576710350, "post_id": 59401034, "comment_id": 104991467, "body": "Yes, Testmodel.find(1) returns a record and Testmodel.find(1).destroy! gets me that activerecord error I mentioned"}, {"owner": {"reputation": 397, "user_id": 5226856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uCIk4.jpg?s=128&g=1", "display_name": "Faruk Hossain", "link": "https://stackoverflow.com/users/5226856/faruk-hossain"}, "edited": false, "score": 0, "creation_date": 1576737815, "post_id": 59401034, "comment_id": 104997276, "body": "Does Testmodel has any relationship with any other Model?"}, {"owner": {"reputation": 540, "user_id": 5046468, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-_MJIiKu6U44/AAAAAAAAAAI/AAAAAAAAAB0/X1g73J1CrQ4/photo.jpg?sz=128", "display_name": "Mi Ro", "link": "https://stackoverflow.com/users/5046468/mi-ro"}, "edited": false, "score": 0, "creation_date": 1576741413, "post_id": 59401034, "comment_id": 104998547, "body": "No relation at all, it is simple model with just one string value"}], "tags": [], "owner": {"reputation": 6933, "user_id": 26604, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e94ddf54b3d31c6eda0e1c76a58c3e74?s=128&d=identicon&r=PG", "display_name": "Kyle Heironimus", "link": "https://stackoverflow.com/users/26604/kyle-heironimus"}, "is_accepted": false, "score": 0, "last_activity_date": 1576709270, "creation_date": 1576709270, "answer_id": 59401034, "question_id": 59400030, "link": "https://stackoverflow.com/questions/59400030/cannot-destroy-records-for-some-models-in-rails/59401034#59401034", "title": "Cannot destroy records for some models in rails", "body": "<p>Does <code>Testmodel.find(1)</code> return anything? </p>\n\n<p>Try <code>Testmodel.find(1).destroy!</code> (with exclamation point) to see if it tells you anything more.</p>\n"}, {"comments": [{"owner": {"reputation": 540, "user_id": 5046468, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-_MJIiKu6U44/AAAAAAAAAAI/AAAAAAAAAB0/X1g73J1CrQ4/photo.jpg?sz=128", "display_name": "Mi Ro", "link": "https://stackoverflow.com/users/5046468/mi-ro"}, "edited": false, "score": 0, "creation_date": 1576839805, "post_id": 59407344, "comment_id": 105034485, "body": "there is no association...I finally found a problem, it was deep in the code, ActiveRecord::Base class had added by default false to destroy"}], "tags": [], "owner": {"reputation": 1043, "user_id": 5659594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c90ec27dffb2d716ee0c796cd73078c?s=128&d=identicon&r=PG&f=1", "display_name": "Fernand", "link": "https://stackoverflow.com/users/5659594/fernand"}, "is_accepted": false, "score": 0, "last_activity_date": 1576749879, "creation_date": 1576749879, "answer_id": 59407344, "question_id": 59400030, "link": "https://stackoverflow.com/questions/59400030/cannot-destroy-records-for-some-models-in-rails/59407344#59407344", "title": "Cannot destroy records for some models in rails", "body": "<p>It seems that Testmodel has some associations.\n<br>Try this in the console and check the output.</p>\n\n<pre><code>Testmodel.reflect_on_all_associations\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 540, "user_id": 5046468, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-_MJIiKu6U44/AAAAAAAAAAI/AAAAAAAAAB0/X1g73J1CrQ4/photo.jpg?sz=128", "display_name": "Mi Ro", "link": "https://stackoverflow.com/users/5046468/mi-ro"}, "is_accepted": false, "score": 0, "last_activity_date": 1576839920, "creation_date": 1576839920, "answer_id": 59424214, "question_id": 59400030, "link": "https://stackoverflow.com/questions/59400030/cannot-destroy-records-for-some-models-in-rails/59424214#59424214", "title": "Cannot destroy records for some models in rails", "body": "<p>Problem solved, there was this code added in lib folder which prevents to destroy anything unless I set in model can_destroy to true</p>\n\n<p>thanks all for help</p>\n\n<pre><code>class ActiveRecord::Base\n  def can_destroy?\n    false\n  end\n\n  before_destroy do\n    can_destroy?\n  end\n</code></pre>\n"}], "owner": {"reputation": 540, "user_id": 5046468, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-_MJIiKu6U44/AAAAAAAAAAI/AAAAAAAAAB0/X1g73J1CrQ4/photo.jpg?sz=128", "display_name": "Mi Ro", "link": "https://stackoverflow.com/users/5046468/mi-ro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 202, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1576839920, "creation_date": 1576703463, "question_id": 59400030, "link": "https://stackoverflow.com/questions/59400030/cannot-destroy-records-for-some-models-in-rails", "title": "Cannot destroy records for some models in rails", "body": "<p>I have a model with 2 associations and no validations, which can be created but if I want to destroy it, I get error \" ActiveRecord::RecordNotDestroyed\"\nSo I tried directly in rails create new record for this Model and then run destroy, but it rollbacks without any error message. If I do destroy! I get the error. I enabled mysql query logging but it looks it doesnt even get to delete part so I assume rails is somehow preventing from destroying this model. </p>\n\n<p>As a test I created dummy model without any association, with just one string value. Same issue in rails console. I have to note that .delete method works, but .destroy not</p>\n\n<p>Then I started to analyze in my rails app (I took it over from somebody so I am still not 100% familiar) and in rails console tried to destroy some records for different models and realized some I am able to destroy, some not.</p>\n\n<p>Is there any way how to find out why I am not able to destroy those records? It is really strange for my Testmodel without any validation or association. Is there anywhere to look for more info? I tried this:</p>\n\n<pre><code>testrecord.destroy; testrecord.errors but in @messages I have empty {}\n</code></pre>\n\n<p>Here is my code for model where I found an issue (EinvoiceContact) and also my Testmodel</p>\n\n<pre><code>class EinvoiceContact &lt; ActiveRecord::Base\n  belongs_to :customer\n  has_many :building\nend\n\nclass Customer &lt; ActiveRecord::Base\n\n  has_many :einvoice_contacts, dependent: :destroy\n  accepts_nested_attributes_for :einvoice_contacts, allow_destroy: true, reject_if: :empty_einvoice_contact\n\nend\n\nclass Testmodel &lt; ActiveRecord::Base\nend\n</code></pre>\n\n<p>and here is output from rails and mysql log</p>\n\n<pre><code>&gt; irb(main):045:0&gt; Testmodel.find(1).destroy\\r   Testmodel Load (0.4ms) \n&gt; SELECT  `testmodels`.* FROM `testmodels` WHERE `testmodels`.`id` = 1\n&gt; LIMIT 1    (0.1ms)  BEGIN    (0.1ms)  ROLLBACK\n&gt; =&gt; false\n&gt; \n&gt; \n&gt; 2019-12-18T21:05:42.455378Z      33 Query SELECT  `testmodels`.* FROM\n&gt; `testmodels` WHERE `testmodels`.`id` = 1 LIMIT 1\n&gt; 2019-12-18T21:05:42.456559Z      33 Query BEGIN\n&gt; 2019-12-18T21:05:42.458261Z      33 Query ROLLBACK\n</code></pre>\n\n<p>Any help where to look for more details, or where this can be set is appreciated. This app uses CanCan but I have set </p>\n\n<pre><code>can :manage, :all\n</code></pre>\n\n<p>Rails is 4.2.8 with ruby 2.1.4 (I know it is old app, I just took it over and maintain), mysql \nthanks</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1576736677, "post_id": 59398255, "comment_id": 104996920, "body": "Please edit to clarify your question. Are you asking the following: given the array <code>arr</code> that is the receiver of <code>each</code>, what values of the initial array map into the receiver of <code>each</code>? What do you mean by &quot;final filter&quot;, as opposed to &quot;filter&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "is_accepted": true, "score": 1, "last_activity_date": 1576694773, "creation_date": 1576694773, "answer_id": 59398356, "question_id": 59398255, "link": "https://stackoverflow.com/questions/59398255/get-the-initial-value-after-several-map-filter-calls/59398356#59398356", "title": "Get the initial value after several map/filter calls", "body": "<p>You need to carry original value to the final step.   </p>\n\n<p>Object-oriented approach can help by introducing a \"filter\" type</p>\n\n<pre><code>class Filter\n  attr_reader :value\n\n  def initialize(value)\n    @value = value \n  end\n\n  def satisfies?\n    (value * 2 * value) % 3 == 0\n  end\nend\n</code></pre>\n\n<p>Usage</p>\n\n<pre><code>[1,2,3,4,5,6,7,8,9].map { |i| Filter.new(i) }.select(&amp;:satisfies?).map(&amp;:value)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1576736189, "post_id": 59398399, "comment_id": 104996775, "body": "Testing answers before posting is always advised."}, {"owner": {"reputation": 1141, "user_id": 3251463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hxssB.png?s=128&g=1", "display_name": "Scott Schupbach", "link": "https://stackoverflow.com/users/3251463/scott-schupbach"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1576865748, "post_id": 59398399, "comment_id": 105045279, "body": "Well <code>filter</code> isn&#39;t a Ruby method, so you can&#39;t test this code. I tested my answer with <code>select</code>. But the backslash was obviously just a typo in transferring the answer over."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1576873883, "post_id": 59398399, "comment_id": 105047991, "body": "<a href=\"https://ruby-doc.org/core-2.6.3/Array.html#method-i-filter\" rel=\"nofollow noreferrer\">Array#filter</a> was added as an alias of <code>Array#select</code> in v2.6. (I forgot it was that recent.)"}, {"owner": {"reputation": 1141, "user_id": 3251463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hxssB.png?s=128&g=1", "display_name": "Scott Schupbach", "link": "https://stackoverflow.com/users/3251463/scott-schupbach"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1576875070, "post_id": 59398399, "comment_id": 105048330, "body": "Good to know. We&#39;re still on v2.4 where I work. And I do so little Ruby outside of work, I haven&#39;t really been keeping up :/"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1576875436, "post_id": 59398399, "comment_id": 105048432, "body": "You don&#39;t mean :\\ ? :-)"}], "tags": [], "owner": {"reputation": 1141, "user_id": 3251463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hxssB.png?s=128&g=1", "display_name": "Scott Schupbach", "link": "https://stackoverflow.com/users/3251463/scott-schupbach"}, "is_accepted": false, "score": 0, "last_activity_date": 1576865396, "last_edit_date": 1576865396, "creation_date": 1576695006, "answer_id": 59398399, "question_id": 59398255, "link": "https://stackoverflow.com/questions/59398255/get-the-initial-value-after-several-map-filter-calls/59398399#59398399", "title": "Get the initial value after several map/filter calls", "body": "<p>You could just undo the things you did. So </p>\n\n<pre><code>[1,2,3,4,5,6,7,8,9]\n  .map{ |i| i * 2 }\n  .map{ |i| i * i }\n  .filter{ |i| i % 3 ==0 }\n  .map{ |i| Math.sqrt(i) / 2 }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8462, "user_id": 405865, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e29f04f339715955060858e0e65e1311?s=128&d=identicon&r=PG", "display_name": "fphilipe", "link": "https://stackoverflow.com/users/405865/fphilipe"}, "is_accepted": false, "score": 2, "last_activity_date": 1576695563, "creation_date": 1576695563, "answer_id": 59398511, "question_id": 59398255, "link": "https://stackoverflow.com/questions/59398255/get-the-initial-value-after-several-map-filter-calls/59398511#59398511", "title": "Get the initial value after several map/filter calls", "body": "<p>You could simply apply the transformations that you do in the two <code>map</code> calls directly in <code>filter</code>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>[1,2,3,4,5,6,7,8,9]\n  .filter { |i| (i * 2)**2 % 3 == 0 }\n</code></pre>\n\n<p>Alternatively, you could keep the original value in a \"tuple\" as follows:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>[1,2,3,4,5,6,7,8,9]\n  .map { |i| [i, i] }\n  .map { |a, b| [a, b * 2] }\n  .map { |a, b| [a, b * b] }\n  .filter { |a, b| b % 3 == 0 }\n  .map { |a, _| a }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1576739976, "creation_date": 1576739976, "answer_id": 59404939, "question_id": 59398255, "link": "https://stackoverflow.com/questions/59398255/get-the-initial-value-after-several-map-filter-calls/59404939#59404939", "title": "Get the initial value after several map/filter calls", "body": "<p>You are given a method:</p>\n\n<pre><code>def f(n)\n  4 * n**2\nend\n</code></pre>\n\n<p>where <code>f(n)</code> is the transformed value of an element <code>n</code> from the given array (as <code>(2 * n)*(2 * n) = 4 * n**2)</code>).</p>\n\n<p><code>f</code> is a 1-1 mapping, so it has an inverse method <code>g</code> (i.e., <code>g(f(n)) #=&gt; n</code> for all integers <code>n</code>):</p>\n\n<pre><code>def g(m)\n  Math.sqrt(m).round/2\nend\n</code></pre>\n\n<p>(We need <code>.round</code> because of round-off errors.)</p>\n\n<p>Suppose we have:       </p>\n\n<pre><code>arr\n  #=&gt; [1, 2, 3, 4, 5, 6, 7, 8, 9]\n</code></pre>\n\n<p>then</p>\n\n<pre><code>z = arr.map { |n| f(n) }.filter { |x| x % 3 == 0 }\n  #=&gt; [36, 144, 324] \n</code></pre>\n\n<p>Then the inverse of these values is given by:</p>\n\n<pre><code>z.map { |m| g(m) }\n  #=&gt; [3, 6, 9]\n</code></pre>\n\n<p>Notice that:</p>\n\n<pre><code>arr.map { |n| f(n) }.filter { |x| x % 3 == 0 }\n</code></pre>\n\n<p>is the same as:</p>\n\n<pre><code>arr.filter { |x| x % 3 == 0 }.map { |n| f(n) }\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 12560599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/243112d96649c9e0e8e00c0bd6fa17df?s=128&d=identicon&r=PG&f=1", "display_name": "user789", "link": "https://stackoverflow.com/users/12560599/user789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 59398356, "answer_count": 4, "score": 0, "last_activity_date": 1576865396, "creation_date": 1576694311, "question_id": 59398255, "link": "https://stackoverflow.com/questions/59398255/get-the-initial-value-after-several-map-filter-calls", "title": "Get the initial value after several map/filter calls", "body": "<p>I have an enumerable that goes through several transformation steps and a final filter step</p>\n\n<p>E.g</p>\n\n<pre><code>[1,2,3,4,5,6,7,8,9].map{|i| i * 2}\n                   .map{|i| i * i}\n                   .filter{|i| i % 3 ==0 }\n                   .each{|i| puts how_do_i_get_initial_value_here }\n                   .or_the_initial_value_here\n</code></pre>\n\n<p>How do I get the initial value whose transformations satisfied the filter?</p>\n\n<p>Thus in the above example, how do I end up with <code>[3,6,9]</code> instead of <code>[36, 144, 324]</code></p>\n"}, {"tags": ["ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1576694460, "post_id": 59398253, "comment_id": 104985648, "body": "You may need to <a href=\"https://stackoverflow.com/questions/22387196/warning-running-gem-pristine-all-to-regenerate-your-installed-gemspecs\">rebuild all your gems</a>. A hard-crash like this is usually an indication that some compiled gem extensions are broken."}, {"owner": {"reputation": 11, "user_id": 12560428, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDHjbgLXLMaMFAJCsZbvLvOmoD7klayhNJigehQjw=k-s128", "display_name": "Leandro Nimet", "link": "https://stackoverflow.com/users/12560428/leandro-nimet"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1576694921, "post_id": 59398253, "comment_id": 104985824, "body": "thanks @tadman, I very noob on Rails...I will try this tip."}, {"owner": {"reputation": 11, "user_id": 12560428, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDHjbgLXLMaMFAJCsZbvLvOmoD7klayhNJigehQjw=k-s128", "display_name": "Leandro Nimet", "link": "https://stackoverflow.com/users/12560428/leandro-nimet"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1576697041, "post_id": 59398253, "comment_id": 104986674, "body": "Even rebuilding all my gems (the @tadman suggestion) the problem still the same."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1576698620, "post_id": 59398253, "comment_id": 104987346, "body": "This could be a bug in Puma, so you may want to check for <a href=\"https://github.com/puma/puma/issues\" rel=\"nofollow noreferrer\">issues</a> or open a new one. It&#39;s really hard to say from this ouptut."}, {"owner": {"reputation": 11, "user_id": 12560428, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDHjbgLXLMaMFAJCsZbvLvOmoD7klayhNJigehQjw=k-s128", "display_name": "Leandro Nimet", "link": "https://stackoverflow.com/users/12560428/leandro-nimet"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1576699251, "post_id": 59398253, "comment_id": 104987574, "body": "The full output have 2528 lines. I start to think that could be a bug in Puma too. So, I will chek for issues like mine. I&#39;ll continue updating this post with de feedbacks I got."}, {"owner": {"reputation": 11, "user_id": 12560428, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDHjbgLXLMaMFAJCsZbvLvOmoD7klayhNJigehQjw=k-s128", "display_name": "Leandro Nimet", "link": "https://stackoverflow.com/users/12560428/leandro-nimet"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1576718263, "post_id": 59398253, "comment_id": 104993202, "body": "Until now, I have no ideia about this error. I&#39;ll to appreciate all efforts to help me guys."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1576718518, "post_id": 59398253, "comment_id": 104993243, "body": "You&#39;ll need to post an issue unless you can describe how to reproduce this particular problem. The Puma team and Puma users will know better than Stack Overflow&#39;s general population."}, {"owner": {"reputation": 11, "user_id": 12560428, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDHjbgLXLMaMFAJCsZbvLvOmoD7klayhNJigehQjw=k-s128", "display_name": "Leandro Nimet", "link": "https://stackoverflow.com/users/12560428/leandro-nimet"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1576719873, "post_id": 59398253, "comment_id": 104993473, "body": "Ok @tadman, I&#39;ll do that."}, {"owner": {"reputation": 55, "user_id": 1071709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05db2b0fd0bf4625b9d3e18a85f2aeae?s=128&d=identicon&r=PG", "display_name": "CelsoDeSa", "link": "https://stackoverflow.com/users/1071709/celsodesa"}, "edited": false, "score": 0, "creation_date": 1600103791, "post_id": 59398253, "comment_id": 112976438, "body": "I&#39;m getting a similar error with Rails 6.0.3.3 and Ruby 2.7.1 - however WSL2 in my Terminal works perfectly..."}, {"owner": {"reputation": 55, "user_id": 1071709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05db2b0fd0bf4625b9d3e18a85f2aeae?s=128&d=identicon&r=PG", "display_name": "CelsoDeSa", "link": "https://stackoverflow.com/users/1071709/celsodesa"}, "edited": false, "score": 0, "creation_date": 1600103832, "post_id": 59398253, "comment_id": 112976453, "body": "@LeandroNimet did you find any solution for this?"}, {"owner": {"reputation": 11, "user_id": 12560428, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDHjbgLXLMaMFAJCsZbvLvOmoD7klayhNJigehQjw=k-s128", "display_name": "Leandro Nimet", "link": "https://stackoverflow.com/users/12560428/leandro-nimet"}, "edited": false, "score": 0, "creation_date": 1600202363, "post_id": 59398253, "comment_id": 113012503, "body": "Yes, but I had to reinstall all my environment including my operational system. I never knew the real causes of the problem."}], "owner": {"reputation": 11, "user_id": 12560428, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDHjbgLXLMaMFAJCsZbvLvOmoD7klayhNJigehQjw=k-s128", "display_name": "Leandro Nimet", "link": "https://stackoverflow.com/users/12560428/leandro-nimet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 409, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576697965, "creation_date": 1576694307, "last_edit_date": 1576697965, "question_id": 59398253, "link": "https://stackoverflow.com/questions/59398253/cant-start-ruby-on-rails-server-using-ruby-2-6-5-version", "title": "Can&#39;t start Ruby on Rails server using Ruby 2.6.5 version", "body": "<p>I get this error when I run <strong>rails s</strong></p>\n\n<p>I had try update all my gems, but didn't works for me :(\nWhen I was using with ruby 2.6.1 everything worked fine.\nBut I had to update the ruby version because my environment in the Elastic Beanstalk on AWS is works with ruby 2.6.5.</p>\n\n<p>Can anyone help me?</p>\n\n<p>Updating the post...</p>\n\n<p>I tried rebuild all my gems by following the @tadman suggestion. But I still have the same error.</p>\n\n<p>After that I redid the following:</p>\n\n<blockquote>\n  <p>gem pristine --all</p>\n  \n  <p>bundle install</p>\n  \n  <p>bundle exec spring binstub --all</p>\n</blockquote>\n\n<p>The error I got:</p>\n\n<blockquote>\n  <p>nimet@nimet-PC:~/Projects/belle.api$ rails s\n  => Booting Puma\n  => Rails 5.2.4 application starting in development \n  => Run <code>rails server -h</code> for more startup options /home/nimet/.rvm/gems/ruby-2.6.5/gems/puma-3.12.2/lib/puma/puma_http11.so:\n  [BUG] Segmentation fault at 0x0000000000000000 ruby 2.6.5p114\n  (2019-10-01 revision 67812) [x86_64-linux]</p>\n  \n  <p>-- Control frame information ----------------------------------------------- c:0052 p:-11744685087948 s:0281 e:000280 TOP    [FINISH] c:0051 p:---- s:0278\n  e:000277 CFUNC  :require c:0050 p:0008 s:0273 e:000272 BLOCK \n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/activesupport-5.2.4/lib/active_support/dependencies.rb:291 c:0049 p:0068 s:0270 e:000269 METHOD\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/activesupport-5.2.4/lib/active_support/dependencies.rb:257 c:0048 p:0011 s:0263 e:000262 METHOD\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/activesupport-5.2.4/lib/active_support/dependencies.rb:291 c:0047 p:0090 s:0257 e:000256 TOP<br>\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/puma-3.12.2/lib/puma/server.rb:17\n  [FINISH] c:0046 p:---- s:0254 e:000253 CFUNC  :require c:0045 p:0008\n  s:0249 e:000248 BLOCK \n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/activesupport-5.2.4/lib/active_support/dependencies.rb:291 c:0044 p:0068 s:0246 e:000245 METHOD\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/activesupport-5.2.4/lib/active_support/dependencies.rb:257 c:0043 p:0011 s:0239 e:000238 METHOD\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/activesupport-5.2.4/lib/active_support/dependencies.rb:291 c:0042 p:0006 s:0233 e:000232 TOP<br>\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/puma-3.12.2/lib/puma/runner.rb:3\n  [FINISH] c:0041 p:---- s:0230 e:000229 CFUNC  :require c:0040 p:0008\n  s:0225 e:000224 BLOCK \n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/activesupport-5.2.4/lib/active_support/dependencies.rb:291 c:0039 p:0068 s:0222 e:000221 METHOD\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/activesupport-5.2.4/lib/active_support/dependencies.rb:257 c:0038 p:0011 s:0215 e:000214 METHOD\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/activesupport-5.2.4/lib/active_support/dependencies.rb:291 c:0037 p:0006 s:0209 e:000208 TOP<br>\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/puma-3.12.2/lib/puma/cluster.rb:3\n  [FINISH] c:0036 p:---- s:0206 e:000205 CFUNC  :require c:0035 p:0008\n  s:0201 e:000200 BLOCK \n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/activesupport-5.2.4/lib/active_support/dependencies.rb:291 c:0034 p:0068 s:0198 e:000197 METHOD\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/activesupport-5.2.4/lib/active_support/dependencies.rb:257 c:0033 p:0011 s:0191 e:000190 METHOD\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/activesupport-5.2.4/lib/active_support/dependencies.rb:291 c:0032 p:0020 s:0185 e:000184 TOP<br>\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/puma-3.12.2/lib/puma/launcher.rb:6\n  [FINISH] c:0031 p:---- s:0182 e:000181 CFUNC  :require c:0030 p:0008\n  s:0177 e:000176 BLOCK \n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/activesupport-5.2.4/lib/active_support/dependencies.rb:291 c:0029 p:0068 s:0174 e:000173 METHOD\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/activesupport-5.2.4/lib/active_support/dependencies.rb:257 c:0028 p:0011 s:0167 e:000166 METHOD\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/activesupport-5.2.4/lib/active_support/dependencies.rb:291 c:0027 p:0031 s:0161 e:000160 METHOD\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/puma-3.12.2/lib/rack/handler/puma.rb:15\n  c:0026 p:0012 s:0152 e:000151 METHOD\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/puma-3.12.2/lib/rack/handler/puma.rb:65\n  c:0025 p:0195 s:0143 E:000028 METHOD\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/rack-2.0.7/lib/rack/server.rb:297\n  c:0024 p:0045 s:0136 E:001a30 METHOD\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/railties-5.2.4/lib/rails/commands/server/server_command.rb:53 c:0023 p:0042 s:0132 e:000131 BLOCK \n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/railties-5.2.4/lib/rails/commands/server/server_command.rb:147\n  [FINISH] c:0022 p:---- s:0128 e:000127 CFUNC  :tap c:0021 p:0030\n  s:0124 e:000123 METHOD\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/railties-5.2.4/lib/rails/commands/server/server_command.rb:142\n  c:0020 p:0064 s:0120 e:000119 METHOD\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/thor-1.0.1/lib/thor/command.rb:27\n  c:0019 p:0047 s:0112 e:000111 METHOD\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/thor-1.0.1/lib/thor/invocation.rb:127\n  c:0018 p:0259 s:0105 e:000104 METHOD\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/thor-1.0.1/lib/thor.rb:392\n  c:0017 p:0043 s:0092 e:000091 METHOD\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/railties-5.2.4/lib/rails/command/base.rb:69\n  c:0016 p:0130 s:0085 e:000084 METHOD\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/railties-5.2.4/lib/rails/command.rb:46\n  c:0015 p:0059 s:0074 e:000073 TOP<br>\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/railties-5.2.4/lib/rails/commands.rb:18\n  [FINISH] c:0014 p:---- s:0069 e:000068 CFUNC  :require c:0013 p:0053\n  s:0064 e:000063 TOP    /home/nimet/Projects/belle.api/bin/rails:9\n  [FINISH] c:0012 p:---- s:0060 e:000059 CFUNC  :load c:0011 p:0135\n  s:0055 e:000054 METHOD\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/spring-2.0.2/lib/spring/client/rails.rb:28\n  c:0010 p:0009 s:0050 e:000049 METHOD\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/spring-2.0.2/lib/spring/client/command.rb:7\n  c:0009 p:0014 s:0045 e:000044 METHOD\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/spring-2.0.2/lib/spring/client.rb:30\n  c:0008 p:0295 s:0039 e:000038 TOP<br>\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/spring-2.0.2/bin/spring:49\n  [FINISH] c:0007 p:---- s:0033 e:000032 CFUNC  :load c:0006 p:0163\n  s:0028 e:000027 TOP<br>\n  /home/nimet/.rvm/gems/ruby-2.6.5/gems/spring-2.0.2/lib/spring/binstub.rb:31\n  [FINISH] c:0005 p:---- s:0022 e:000021 CFUNC  :require c:0004 p:0130\n  s:0017 e:000016 TOP    /home/nimet/Projects/belle.api/bin/spring:15\n  [FINISH] c:0003 p:---- s:0012 e:000011 CFUNC  :load c:0002 p:0018\n  s:0007 E:000098 EVAL   bin/rails:3 [FINISH] c:0001 p:0000 s:0003\n  E:001a40 (none) [FINISH]</p>\n</blockquote>\n"}, {"tags": ["json", "ruby", "mongodb"], "comments": [{"owner": {"reputation": 847, "user_id": 10690138, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qzy4Dpg0wB0/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hRPOPYeX5t-sSMnc5QTCVLQG767Q/mo/photo.jpg?sz=128", "display_name": "Mahesh Bhatnagar", "link": "https://stackoverflow.com/users/10690138/mahesh-bhatnagar"}, "edited": false, "score": 0, "creation_date": 1576689584, "post_id": 59397127, "comment_id": 104983412, "body": "are you use node with mongodb ?"}, {"owner": {"reputation": 11, "user_id": 12560213, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDxkfsYBKCAA3x_CGcVGxcywno7ae5nIvRQW920Mg=k-s128", "display_name": "Kamil Grzybek", "link": "https://stackoverflow.com/users/12560213/kamil-grzybek"}, "reply_to_user": {"reputation": 847, "user_id": 10690138, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qzy4Dpg0wB0/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hRPOPYeX5t-sSMnc5QTCVLQG767Q/mo/photo.jpg?sz=128", "display_name": "Mahesh Bhatnagar", "link": "https://stackoverflow.com/users/10690138/mahesh-bhatnagar"}, "edited": false, "score": 0, "creation_date": 1576689921, "post_id": 59397127, "comment_id": 104983589, "body": "Yes, I use a node with MongoDB."}, {"owner": {"reputation": 847, "user_id": 10690138, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qzy4Dpg0wB0/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hRPOPYeX5t-sSMnc5QTCVLQG767Q/mo/photo.jpg?sz=128", "display_name": "Mahesh Bhatnagar", "link": "https://stackoverflow.com/users/10690138/mahesh-bhatnagar"}, "edited": false, "score": 0, "creation_date": 1576689984, "post_id": 59397127, "comment_id": 104983618, "body": "Please share input data and output data at jsoneditor online"}, {"owner": {"reputation": 11, "user_id": 12560213, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDxkfsYBKCAA3x_CGcVGxcywno7ae5nIvRQW920Mg=k-s128", "display_name": "Kamil Grzybek", "link": "https://stackoverflow.com/users/12560213/kamil-grzybek"}, "reply_to_user": {"reputation": 847, "user_id": 10690138, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qzy4Dpg0wB0/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hRPOPYeX5t-sSMnc5QTCVLQG767Q/mo/photo.jpg?sz=128", "display_name": "Mahesh Bhatnagar", "link": "https://stackoverflow.com/users/10690138/mahesh-bhatnagar"}, "edited": false, "score": 0, "creation_date": 1576690501, "post_id": 59397127, "comment_id": 104983874, "body": "I have just this part of JSON file. ref_provider: &quot;...&quot;, hilt: { reference: &quot;...&quot;, clientId: &quot;...&quot;, clientType: &quot;...&quot;, clientName: &quot;...&quot; }, status: &quot;...&quot;, supplier: { name: &quot;...&quot; }, date_from_local: &quot;...&quot;"}, {"owner": {"reputation": 847, "user_id": 10690138, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qzy4Dpg0wB0/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hRPOPYeX5t-sSMnc5QTCVLQG767Q/mo/photo.jpg?sz=128", "display_name": "Mahesh Bhatnagar", "link": "https://stackoverflow.com/users/10690138/mahesh-bhatnagar"}, "edited": false, "score": 0, "creation_date": 1576690603, "post_id": 59397127, "comment_id": 104983918, "body": "this data not save in mongo database ?  data share at <a href=\"https://jsoneditoronline.org/\" rel=\"nofollow noreferrer\">jsoneditoronline.org</a>"}, {"owner": {"reputation": 11, "user_id": 12560213, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDxkfsYBKCAA3x_CGcVGxcywno7ae5nIvRQW920Mg=k-s128", "display_name": "Kamil Grzybek", "link": "https://stackoverflow.com/users/12560213/kamil-grzybek"}, "reply_to_user": {"reputation": 847, "user_id": 10690138, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qzy4Dpg0wB0/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hRPOPYeX5t-sSMnc5QTCVLQG767Q/mo/photo.jpg?sz=128", "display_name": "Mahesh Bhatnagar", "link": "https://stackoverflow.com/users/10690138/mahesh-bhatnagar"}, "edited": false, "score": 0, "creation_date": 1576709362, "post_id": 59397127, "comment_id": 104991163, "body": "I was able to make it, added  client[:bookings].find(:ref_anixe =&gt; &#39;5a4i3&#39;).flat_map do |document| document[&quot;services&quot;].map {|x| x[&quot;hilt&quot;][&quot;reference&quot;]}"}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 9660979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d199bc20b250d27b923ff9023e23e7e1?s=128&d=identicon&r=PG&f=1", "display_name": "Lixiang Zhou", "link": "https://stackoverflow.com/users/9660979/lixiang-zhou"}, "is_accepted": false, "score": 0, "last_activity_date": 1576692617, "creation_date": 1576692617, "answer_id": 59397881, "question_id": 59397127, "link": "https://stackoverflow.com/questions/59397127/how-to-get-a-specific-field-from-json-file/59397881#59397881", "title": "How to get a specific field from JSON file?", "body": "<p>JSONPath may help in this case. </p>\n\n<p><a href=\"https://github.com/joshbuddy/jsonpath\" rel=\"nofollow noreferrer\">https://github.com/joshbuddy/jsonpath</a></p>\n"}, {"tags": [], "owner": {"reputation": 9592, "user_id": 9540925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhOpI.png?s=128&g=1", "display_name": "D. SM", "link": "https://stackoverflow.com/users/9540925/d-sm"}, "is_accepted": false, "score": 0, "last_activity_date": 1583649544, "creation_date": 1583649544, "answer_id": 60585085, "question_id": 59397127, "link": "https://stackoverflow.com/questions/59397127/how-to-get-a-specific-field-from-json-file/60585085#60585085", "title": "How to get a specific field from JSON file?", "body": "<p>Use projection to retrieve parts of the documents from MongoDB.</p>\n\n<p><a href=\"https://docs.mongodb.com/ruby-driver/current/tutorials/ruby-driver-projections/\" rel=\"nofollow noreferrer\">https://docs.mongodb.com/ruby-driver/current/tutorials/ruby-driver-projections/</a></p>\n"}], "owner": {"reputation": 11, "user_id": 12560213, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDxkfsYBKCAA3x_CGcVGxcywno7ae5nIvRQW920Mg=k-s128", "display_name": "Kamil Grzybek", "link": "https://stackoverflow.com/users/12560213/kamil-grzybek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1583649544, "creation_date": 1576689411, "last_edit_date": 1576692280, "question_id": 59397127, "link": "https://stackoverflow.com/questions/59397127/how-to-get-a-specific-field-from-json-file", "title": "How to get a specific field from JSON file?", "body": "<p>I use JSON from local mongo.</p>\n\n<p>I wanted to get a specific field from the JSON file. I stuck on this point. Could somebody help me with this? Thank you in advance for your help.</p>\n\n<pre><code>!/usr/bin/ruby\n\nrequire 'mongo'\nrequire 'json'\n\nMongo::Logger.logger.level = ::Logger::FATAL\n\nclient = Mongo::Client.new([ '...' ], :database =&gt; 'bms')\n\nclient[:bookings].find(:ref_ =&gt; '...').each do |document|\n\n&lt;-----# I want to get field (reference) from JSON.\"\n\nend\n\nclient.close\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "zeitwerk"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1576688854, "post_id": 59396966, "comment_id": 104983054, "body": "How did you install Ruby, and how do you know what versions of Ruby you have, and how do you know that you&#39;re using Ruby &gt;= 2.4.4 when you try to install Rails?"}, {"owner": {"reputation": 111, "user_id": 9847711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zr9K.jpg?s=128&g=1", "display_name": "Ayogu Chibueze", "link": "https://stackoverflow.com/users/9847711/ayogu-chibueze"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1576688947, "post_id": 59396966, "comment_id": 104983118, "body": "I installed ruby using  <code>rbenv install  2.5.7 </code> and switched to 2.5.7 with <code>rbenv global 2.5.7</code>"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1576689624, "post_id": 59396966, "comment_id": 104983425, "body": "Did you <code>rbenv rehash</code>? <a href=\"https://github.com/rbenv/rbenv#rbenv-rehash\" rel=\"nofollow noreferrer\">github.com/rbenv/rbenv#rbenv-rehash</a> What does <code>ruby -v</code> return?"}, {"owner": {"reputation": 111, "user_id": 9847711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zr9K.jpg?s=128&g=1", "display_name": "Ayogu Chibueze", "link": "https://stackoverflow.com/users/9847711/ayogu-chibueze"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1576690332, "post_id": 59396966, "comment_id": 104983789, "body": "yes I did <code>rbenv rehash</code>  and <code>ruby  -v</code> returns <code>ruby 2.5.7p206 (2019-10-01 revision 67816) [x86_64-darwin18]</code>."}, {"owner": {"reputation": 77, "user_id": 2705588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mx5G4.png?s=128&g=1", "display_name": "Jesal", "link": "https://stackoverflow.com/users/2705588/jesal"}, "edited": false, "score": 0, "creation_date": 1580764445, "post_id": 59396966, "comment_id": 106197894, "body": "I had the same error, try: <code>rvm install 2.4.4</code> and then <code>rvm use 2.4.4</code>"}, {"owner": {"reputation": 548, "user_id": 12438293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bVweC.png?s=128&g=1", "display_name": "norioumata", "link": "https://stackoverflow.com/users/12438293/norioumata"}, "edited": false, "score": 0, "creation_date": 1589277072, "post_id": 59396966, "comment_id": 109222230, "body": "@AyoguChibueze, did you solve this issue?"}, {"owner": {"reputation": 111, "user_id": 9847711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zr9K.jpg?s=128&g=1", "display_name": "Ayogu Chibueze", "link": "https://stackoverflow.com/users/9847711/ayogu-chibueze"}, "reply_to_user": {"reputation": 548, "user_id": 12438293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bVweC.png?s=128&g=1", "display_name": "norioumata", "link": "https://stackoverflow.com/users/12438293/norioumata"}, "edited": false, "score": 0, "creation_date": 1589372007, "post_id": 59396966, "comment_id": 109266067, "body": "@codemick yes I uninstalled everything and started afresh. Just ensure all your gem are installed in one folder and the version manager you are using has access to it."}], "answers": [{"tags": [], "owner": {"reputation": 251, "user_id": 4263078, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3718e02c89edcdae311965a0e52d05bb?s=128&d=identicon&r=PG&f=1", "display_name": "fl0_9", "link": "https://stackoverflow.com/users/4263078/fl0-9"}, "is_accepted": false, "score": 2, "last_activity_date": 1590868754, "creation_date": 1590868754, "answer_id": 62107988, "question_id": 59396966, "link": "https://stackoverflow.com/questions/59396966/error-error-installing-rails-zeitwerk-requires-ruby-version-2-4-4/62107988#62107988", "title": "ERROR: Error installing rails zeitwerk requires Ruby version &gt;= 2.4.4", "body": "<p>In directory wanted use <code>rvm use ruby-2.5.7</code> command line to force the usage of this specific version of ruby and after <code>gem install rails</code>. Just tryed minutes ago and works fine</p>\n"}, {"tags": [], "owner": {"reputation": 608, "user_id": 5494094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f985d5edbd8b9c2e3df83318329338?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim.H", "link": "https://stackoverflow.com/users/5494094/ibrahim-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1603295827, "creation_date": 1603295827, "answer_id": 64467428, "question_id": 59396966, "link": "https://stackoverflow.com/questions/59396966/error-error-installing-rails-zeitwerk-requires-ruby-version-2-4-4/64467428#64467428", "title": "ERROR: Error installing rails zeitwerk requires Ruby version &gt;= 2.4.4", "body": "<p>Another workaround for this specific issue if you don't care about having a newer version of Ruby (and <code>rails</code>), you can just install the most recent compatible version of <code>rails</code> with your version of ruby, a similar example with <code>sprockets</code> which requires <code>ruby v2.5.0</code> solved by installing an older version of <code>rails v4.1.16</code> looking at the <a href=\"https://rubygems.org/gems/rails/versions/4.1.16/dependencies\" rel=\"nofollow noreferrer\">dependencies graph</a>:</p>\n<pre><code>sudo gem install rails -v 4.1.16\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 9847711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zr9K.jpg?s=128&g=1", "display_name": "Ayogu Chibueze", "link": "https://stackoverflow.com/users/9847711/ayogu-chibueze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5937, "favorite_count": 1, "answer_count": 2, "score": 6, "last_activity_date": 1603295827, "creation_date": 1576688810, "last_edit_date": 1576688857, "question_id": 59396966, "link": "https://stackoverflow.com/questions/59396966/error-error-installing-rails-zeitwerk-requires-ruby-version-2-4-4", "title": "ERROR: Error installing rails zeitwerk requires Ruby version &gt;= 2.4.4", "body": "<p>I recently changed my laptop and tried installing rails with</p>\n\n<pre><code>gem install rails\n</code></pre>\n\n<p>and I got this error</p>\n\n<pre><code>ERROR:  Error installing rails:\n    zeitwerk requires Ruby version &gt;= 2.4.4.\n</code></pre>\n\n<p>I have installed ruby version 2.4.4, 2.5.7, and 2.6.5 and I'm still getting the same error.\nAny pointers how to resolve this will be greatly appreciated. thanks </p>\n"}, {"tags": ["ruby", "docker", "sinatra", "google-cloud-run"], "comments": [{"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 1, "creation_date": 1576688284, "post_id": 59395627, "comment_id": 104982782, "body": "How are you running the image?  (What\u2019s your <code>docker run</code> command or <code>docker-compose.yml</code> file?)"}, {"owner": {"reputation": 551, "user_id": 3681793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a23b03da4efe057f090c33cae367f09?s=128&d=identicon&r=PG", "display_name": "bonafernando", "link": "https://stackoverflow.com/users/3681793/bonafernando"}, "reply_to_user": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1576692821, "post_id": 59395627, "comment_id": 104984908, "body": "I&#39;m running <code>docker build . -t naopira:latest</code> and then <code>docker run naopira</code> without a <code>docker-compose.yml</code>. Apparently it&#39;s not mandatory."}], "answers": [{"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1576799299, "post_id": 59413906, "comment_id": 105023814, "body": "Answering your own question is great as long as the question meets the guidelines. SO will give a timeout period, and when it expires you can select your own answer. Good job solving the problem!"}, {"owner": {"reputation": 551, "user_id": 3681793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a23b03da4efe057f090c33cae367f09?s=128&d=identicon&r=PG", "display_name": "bonafernando", "link": "https://stackoverflow.com/users/3681793/bonafernando"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1576867283, "post_id": 59413906, "comment_id": 105045778, "body": "Thanks for everything Tin! Your changes made everything much cleaner."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1576962182, "post_id": 59413906, "comment_id": 105063316, "body": "That&#39;s the point for being able to edit questions and answers once we get to a certain reputation. Stack Overflow is like a reference book, and grammar and readability are very important because we have people from around the world contributing. Sometimes I answer a question when I think the current answers don&#39;t address the issue correctly, and most of the time I now roam around cleaning and polishing. :-)"}], "tags": [], "owner": {"reputation": 551, "user_id": 3681793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a23b03da4efe057f090c33cae367f09?s=128&d=identicon&r=PG", "display_name": "bonafernando", "link": "https://stackoverflow.com/users/3681793/bonafernando"}, "is_accepted": true, "score": 1, "last_activity_date": 1576962045, "last_edit_date": 1576962045, "creation_date": 1576774262, "answer_id": 59413906, "question_id": 59395627, "link": "https://stackoverflow.com/questions/59395627/how-to-fix-docker-using-the-wrong-ruby-path-on-alpine/59413906#59413906", "title": "How to fix Docker using the wrong Ruby path on Alpine", "body": "<p>After several guesses, I fixed it with <code>bundle exec</code> on the last line of the Dockerfile:</p>\n\n<pre><code>CMD [\"bundle\", \"exec\", \"ruby\", \"main_wow.rb\"]\n</code></pre>\n"}], "owner": {"reputation": 551, "user_id": 3681793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a23b03da4efe057f090c33cae367f09?s=128&d=identicon&r=PG", "display_name": "bonafernando", "link": "https://stackoverflow.com/users/3681793/bonafernando"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 600, "favorite_count": 0, "accepted_answer_id": 59413906, "answer_count": 1, "score": 2, "last_activity_date": 1576962045, "creation_date": 1576684153, "last_edit_date": 1576799404, "question_id": 59395627, "link": "https://stackoverflow.com/questions/59395627/how-to-fix-docker-using-the-wrong-ruby-path-on-alpine", "title": "How to fix Docker using the wrong Ruby path on Alpine", "body": "<p>I have a very simple container running Sinatra in a Google Cloud Run. With no changes in the Dockerfile it recently stopped working.</p>\n\n<p>When I try to run it I get the error:</p>\n\n<pre><code>/usr/local/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require': cannot load such file -- sinatra (LoadError)\n    from /usr/local/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    from main_wow.rb:1:in `&lt;main&gt;'\n</code></pre>\n\n<p>Dockerfile:</p>\n\n<pre><code>FROM ruby:2.6.4-alpine3.9\n\nENV APP_HOME /WOW\n\nWORKDIR $APP_HOME\n\nADD Gemfile* $APP_HOME/\n\nRUN gem install bundler\nRUN bundle install\n\nADD main_wow.rb $APP_HOME\nADD views/ $APP_HOME/views\n\n# Start server\nENV PORT 3000\nEXPOSE 3000\nCMD [\"ruby\", \"main_wow.rb\"]\n</code></pre>\n\n<p>Gemfile:</p>\n\n<pre><code>source \"http://rubygems.org\"\n\ngem 'sinatra'\ngem 'i18n'\n</code></pre>\n\n<p>First 10 lines of <code>main_wow.rb</code>:</p>\n\n<pre><code>require \"sinatra\"\nrequire \"net/http\"\nrequire \"json\"\nrequire \"i18n\"\nI18n.config.available_locales = :en\n\nconfigure do\n  set :public_folder, './views'\n  set :bind, '0.0.0.0'\nend\n</code></pre>\n\n<p>From what I could understand, it's trying to fetch the ruby gems from the major version 2.6.0, instead of 2.6.4.\nI have already tried to create a link, to set ruby version on the Gemfile but none seems to work...</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "rails-activerecord", "model-associations"], "comments": [{"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 0, "creation_date": 1576684509, "post_id": 59395602, "comment_id": 104980618, "body": "Your customer_id under <code>params[:construction][:customer_id]</code> maybe ? <code>puts params.inspect</code> and check it"}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1576726245, "post_id": 59395602, "comment_id": 104994609, "body": "Show your form. Do <code>puts params.inspect</code> and show the output too."}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1576684346, "post_id": 59395657, "comment_id": 104980524, "body": "might be better to use <code>@construction = @customer.constructions.build</code>"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1576684494, "post_id": 59395657, "comment_id": 104980610, "body": "use <code>params[:construction][:customer_id]</code> (updated the code)"}, {"owner": {"reputation": 25, "user_id": 12143052, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ItEIhvE057E/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3req3CyLBGA7F3EpO096oTVxS_qgwQ/photo.jpg?sz=128", "display_name": "Brian Rid", "link": "https://stackoverflow.com/users/12143052/brian-rid"}, "edited": false, "score": 0, "creation_date": 1576684903, "post_id": 59395657, "comment_id": 104980862, "body": "i spoke too fast... It is &quot;working&quot; creating a construction associated to the correct customer, but I am not able to retrieve all the information from my simple form for..  Name, address, volume, duration are now set to nil.."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 25, "user_id": 12143052, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ItEIhvE057E/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3req3CyLBGA7F3EpO096oTVxS_qgwQ/photo.jpg?sz=128", "display_name": "Brian Rid", "link": "https://stackoverflow.com/users/12143052/brian-rid"}, "edited": false, "score": 0, "creation_date": 1576685131, "post_id": 59395657, "comment_id": 104981001, "body": "@BrianRid please post a complete question then. including the params that are being submitted and the intended result"}, {"owner": {"reputation": 25, "user_id": 12143052, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ItEIhvE057E/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3req3CyLBGA7F3EpO096oTVxS_qgwQ/photo.jpg?sz=128", "display_name": "Brian Rid", "link": "https://stackoverflow.com/users/12143052/brian-rid"}, "edited": false, "score": 0, "creation_date": 1576685432, "post_id": 59395657, "comment_id": 104981194, "body": "Ok i will try to be more specific :  Here are the params after the following :   @construction = @customer.constructions.build(customer: @customer)  Params : &quot;construction&quot;=&gt;{&quot;name&quot;=&gt;&quot;Test&quot;, &quot;address&quot;=&gt;&quot;Paris&quot;, &quot;duration&quot;=&gt;&quot;12&quot;, &quot;volume&quot;=&gt;&quot;12&quot;, &quot;customer_id&quot;=&gt;&quot;25&quot;},  &quot;commit&quot;=&gt;&quot;Cr&#233;er&quot;}  Then the save! is a success.   but i am redirected on my index where i am not able to find my newly build construction.  I checked with rails c --&gt; except the filed customer_id all the other one are set to nil"}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 0, "last_activity_date": 1576684459, "last_edit_date": 1576684459, "creation_date": 1576684233, "answer_id": 59395657, "question_id": 59395602, "link": "https://stackoverflow.com/questions/59395602/issue-on-association-in-rails/59395657#59395657", "title": "Issue on association in RAILS", "body": "<p>Try to revert the order:</p>\n\n<pre><code>@customer = Customer.find(params[:construction][:customer_id])\n@construction = Construction.new(customer: @customer)\n@construction.save!\n</code></pre>\n\n<p>you need to assign <code>@customer</code> instance variable before you use it. Otherwise it's <code>nil</code> and nothing is assigned to the new <code>Construction</code> record.</p>\n"}, {"tags": [], "owner": {"reputation": 26, "user_id": 10985051, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QE4iQsy-saw/AAAAAAAAAAI/AAAAAAAAEgg/AFWfuu8_syA/photo.jpg?sz=128", "display_name": "D Boy", "link": "https://stackoverflow.com/users/10985051/d-boy"}, "is_accepted": false, "score": 0, "last_activity_date": 1576751950, "creation_date": 1576751950, "answer_id": 59407957, "question_id": 59395602, "link": "https://stackoverflow.com/questions/59395602/issue-on-association-in-rails/59407957#59407957", "title": "Issue on association in RAILS", "body": "<p>If you have the <code>customer_id</code> available at the point of form creation I reckon that you can do something like this.</p>\n\n<p>Also given the belongs_to relations with the <code>customer</code> on the construction, you should be able to update the <code>customer_id</code> on the construction.</p>\n\n<pre><code>def create\n  @construction = Construction.new(construction_params)\n  if @construction.save\n    # whatever you want to do on success\n  else\n    # Whatever you want to do on failure\n  end\nend\n\n# Given you have construction params\n\nprivate\n\ndef construction_params\n  params.require(:construction).permit(:all, :the, :construction, :attributes, :customer_id)\nend\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 12143052, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ItEIhvE057E/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3req3CyLBGA7F3EpO096oTVxS_qgwQ/photo.jpg?sz=128", "display_name": "Brian Rid", "link": "https://stackoverflow.com/users/12143052/brian-rid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1576751950, "creation_date": 1576684060, "last_edit_date": 1576684276, "question_id": 59395602, "link": "https://stackoverflow.com/questions/59395602/issue-on-association-in-rails", "title": "Issue on association in RAILS", "body": "<p>Here is my issue. I have two models (Construction and Customer)</p>\n\n<pre><code>class Construction &lt; ApplicationRecord\n  has_many :works\n  belongs_to :customer\nend\n\nclass Customer &lt; ApplicationRecord\n  has_many :constructions\nend\n</code></pre>\n\n<p>I would like to associate a Customer to a Construction during the creation of a new construction.\nTo do so I have de following controller's method (which is obviously false)</p>\n\n<pre><code>def create\n  # @construction = Construction.new(constructions_params) (commented)\n  @construction = Construction.new(customer: @customer)\n  @customer = Customer.find(params[:customer_id])\n  @construction.save!\nend\n</code></pre>\n\n<p>from the params I am able to understand that the construction is not saved because it is not attached to a customer and so cannot be created.</p>\n\n<p>I am new to rails and I have been struggling for hours now.. </p>\n\n<p>Hope someone will be able to help me.</p>\n\n<p>thanks a lot </p>\n"}, {"tags": ["ruby", "curl"], "answers": [{"comments": [{"owner": {"reputation": 433, "user_id": 5580578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd41a2804cee573820619f340683e84?s=128&d=identicon&r=PG&f=1", "display_name": "user5580578", "link": "https://stackoverflow.com/users/5580578/user5580578"}, "edited": false, "score": 0, "creation_date": 1576687278, "post_id": 59395650, "comment_id": 104982255, "body": "At the moment I get a connection timeout error. The curl command is working as expected. Is there anything wrong in my setup using key, cert and ca_file? I tried to use the paths to the files and after that the current solution"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 433, "user_id": 5580578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd41a2804cee573820619f340683e84?s=128&d=identicon&r=PG&f=1", "display_name": "user5580578", "link": "https://stackoverflow.com/users/5580578/user5580578"}, "edited": false, "score": 0, "creation_date": 1576687658, "post_id": 59395650, "comment_id": 104982446, "body": "At first glance everything looks fine. Connection timeout means the issue is not with <i>SSL</i>, if it was <i>SSL</i>, it would fail immediately."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 0, "last_activity_date": 1576684219, "creation_date": 1576684219, "answer_id": 59395650, "question_id": 59395506, "link": "https://stackoverflow.com/questions/59395506/using-curl-in-ruby/59395650#59395650", "title": "Using curl in ruby", "body": "<pre class=\"lang-rb prettyprint-override\"><code>require 'net/http'\nrequire 'uri'\n\nuri = URI.parse(\"https://endpoint/role-aliases/role_alias/credentials\")\nrequest = Net::HTTP::Get.new(uri)\nrequest[\"X-Amzn-Iot-Thingname\"] = \"cn_name\"\n\nreq_options = {\n  use_ssl: uri.scheme == \"https\",\n}\n\nresponse = Net::HTTP.start(uri.hostname, uri.port, req_options) do |http|\n  http.request(request)\nend\n\n# response.code\n# response.body\n</code></pre>\n\n<p>Thanks to the first line in <a href=\"https://duckduckgo.com\" rel=\"nofollow noreferrer\">https://duckduckgo.com</a> response: <a href=\"https://jhawthorn.github.io/curl-to-ruby/\" rel=\"nofollow noreferrer\">https://jhawthorn.github.io/curl-to-ruby/</a></p>\n"}], "owner": {"reputation": 433, "user_id": 5580578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bd41a2804cee573820619f340683e84?s=128&d=identicon&r=PG&f=1", "display_name": "user5580578", "link": "https://stackoverflow.com/users/5580578/user5580578"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 59395650, "answer_count": 1, "score": -1, "last_activity_date": 1576687176, "creation_date": 1576683752, "last_edit_date": 1576687176, "question_id": 59395506, "link": "https://stackoverflow.com/questions/59395506/using-curl-in-ruby", "title": "Using curl in ruby", "body": "<p>Could someone tell me the equivalent code to use it in ruby?</p>\n\n<pre><code> curl --cert cert_file --key key_file -H \"x-amzn-iot-thingname: cn_name\"  --cacert AmazonRootCA1.pem https://endpoint/role-aliases/role_alias/credentials\n</code></pre>\n\n<p>[UPDATE]</p>\n\n<pre><code>  uri = URI(\"https://endpoint/role-aliases/role_alias/credentials\")\n  req = Net::HTTP::Get.new(uri)\n  req[\"x-amzn-iot-thingname\"] = \"cn_name\"\n  req_options = {\n     use_ssl: uri.scheme == \"https\",\n     ca_file: \"/path-to-file/RootCA.pem\", \n     #cert: \"/path-to-file/mycert.crt\",\n     #key: \"/path-to-file/mykey.key\",\n     cert: OpenSSL::X509::Certificate.new(File.read(\"/path-to-file/mycert.crt\")),\n     key: OpenSSL::PKey::RSA.new(File.read(\"/path-to-file/mykey.key\")),\n  }\n res = Net::HTTP.start(uri.hostname, uri.port,req_options) do |http|\n     http.request(req)\n  end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "installation", "bundler", "nokogiri"], "comments": [{"owner": {"reputation": 672, "user_id": 8748686, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gPuB7.jpg?s=128&g=1", "display_name": "John Skiles Skinner", "link": "https://stackoverflow.com/users/8748686/john-skiles-skinner"}, "edited": false, "score": 0, "creation_date": 1576684405, "post_id": 59395489, "comment_id": 104980558, "body": "You have a gem / Ruby version mismatch. What Ruby version are you using (or trying to use)? Here is a guide that may help you answer my question: <a href=\"https://blog.arkency.com/which-ruby-version-am-i-using-how-to-check/\" rel=\"nofollow noreferrer\">blog.arkency.com/which-ruby-version-am-i-using-how-to-check</a>"}, {"owner": {"reputation": 11, "user_id": 8716387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eed05967016ec83f4054439ecf2076c7?s=128&d=identicon&r=PG&f=1", "display_name": "Casey Morris", "link": "https://stackoverflow.com/users/8716387/casey-morris"}, "reply_to_user": {"reputation": 672, "user_id": 8748686, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gPuB7.jpg?s=128&g=1", "display_name": "John Skiles Skinner", "link": "https://stackoverflow.com/users/8748686/john-skiles-skinner"}, "edited": false, "score": 0, "creation_date": 1576686038, "post_id": 59395489, "comment_id": 104981542, "body": "I&#39;m using <code>2.6.5</code> which is the version listed in the gemfile."}], "answers": [{"tags": [], "owner": {"reputation": 188, "user_id": 787436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdbd1ea1cbcc38582b3f655426541ce8?s=128&d=identicon&r=PG", "display_name": "andoke", "link": "https://stackoverflow.com/users/787436/andoke"}, "is_accepted": false, "score": 0, "last_activity_date": 1576687280, "creation_date": 1576687280, "answer_id": 59396561, "question_id": 59395489, "link": "https://stackoverflow.com/questions/59395489/how-to-fix-conflicting-requirements-installing-nokogiri-for-rails-on-windows/59396561#59396561", "title": "How to fix conflicting requirements installing Nokogiri for Rails on Windows", "body": "<p>Your version of Ruby is too recent for that project. Downgrade to Ruby <code>2.4.X</code> or update the gems of the Gemfile.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8716387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eed05967016ec83f4054439ecf2076c7?s=128&d=identicon&r=PG&f=1", "display_name": "Casey Morris", "link": "https://stackoverflow.com/users/8716387/casey-morris"}, "is_accepted": false, "score": 1, "last_activity_date": 1576796175, "last_edit_date": 1576796175, "creation_date": 1576707386, "answer_id": 59400716, "question_id": 59395489, "link": "https://stackoverflow.com/questions/59395489/how-to-fix-conflicting-requirements-installing-nokogiri-for-rails-on-windows/59400716#59400716", "title": "How to fix conflicting requirements installing Nokogiri for Rails on Windows", "body": "<p>I deleted the <code>Gemfile.lock</code> file which fixed the issue. </p>\n\n<p>The Ruby versions are fine at the project level, I knew this because the server runs on my Mac, so it was a Windows or machine-exclusive issue. </p>\n"}], "owner": {"reputation": 11, "user_id": 8716387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eed05967016ec83f4054439ecf2076c7?s=128&d=identicon&r=PG&f=1", "display_name": "Casey Morris", "link": "https://stackoverflow.com/users/8716387/casey-morris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2481, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1576796175, "creation_date": 1576683689, "last_edit_date": 1576796051, "question_id": 59395489, "link": "https://stackoverflow.com/questions/59395489/how-to-fix-conflicting-requirements-installing-nokogiri-for-rails-on-windows", "title": "How to fix conflicting requirements installing Nokogiri for Rails on Windows", "body": "<p>Recently switched from a Mac to a PC and hit a wall with <code>bundle install</code>. </p>\n\n<p>I get an error but I'm have trouble figuring out what it means and how to fix it. I searched through the GitHub issues and other StackOverflow threads, but none of the fixes suggested help me because they're focused on Linux mostly. </p>\n\n<pre><code>Bundler found conflicting requirements for the Ruby  version:\n  In Gemfile:\n    Ruby  (~&gt; 2.6.5.0)\n\n    pg was resolved to 0.21.0, which depends on\n      Ruby  (&lt; 2.5) x64-mingw32\n\nRuby  (&lt; 2.5), which is required by gem 'nokogiri (&gt;= 1.4.1)', is not available\nin the local ruby installation\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "email", "gmail", "actionmailer"], "comments": [{"owner": {"reputation": 3521, "user_id": 2521680, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/6D935.jpg?s=128&g=1", "display_name": "Rockwell Rice", "link": "https://stackoverflow.com/users/2521680/rockwell-rice"}, "edited": false, "score": 0, "creation_date": 1576681667, "post_id": 59394760, "comment_id": 104978982, "body": "I think your domain could be, at least, one of your issues.  That should be the domain of the website, not <code>gmail.com</code>.  I do not think that will be taken as valid.  Also, are you seeing any errors in your log file?"}, {"owner": {"reputation": 512, "user_id": 11909633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/592a4e537402ececbe3126794f4e0fa8?s=128&d=identicon&r=PG&f=1", "display_name": "ninja_nugget", "link": "https://stackoverflow.com/users/11909633/ninja-nugget"}, "reply_to_user": {"reputation": 3521, "user_id": 2521680, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/6D935.jpg?s=128&g=1", "display_name": "Rockwell Rice", "link": "https://stackoverflow.com/users/2521680/rockwell-rice"}, "edited": false, "score": 0, "creation_date": 1576683657, "post_id": 59394760, "comment_id": 104980140, "body": "@RockwellRice thanks for your comment. I changed the domain name to localhost:3000 in dev env and mydomain name in prod env respectively however it also does not seem to be working. Also, no errors were found (log posted in main post)."}, {"owner": {"reputation": 3521, "user_id": 2521680, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/6D935.jpg?s=128&g=1", "display_name": "Rockwell Rice", "link": "https://stackoverflow.com/users/2521680/rockwell-rice"}, "edited": false, "score": 0, "creation_date": 1576688669, "post_id": 59394760, "comment_id": 104982971, "body": "Is your production site hosted on Heroku by chance?  It has been a while since I set this up, I rememeber having an issue with gmail and heroku when I did try this before and that ended up pushing me to using an email service."}, {"owner": {"reputation": 512, "user_id": 11909633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/592a4e537402ececbe3126794f4e0fa8?s=128&d=identicon&r=PG&f=1", "display_name": "ninja_nugget", "link": "https://stackoverflow.com/users/11909633/ninja-nugget"}, "reply_to_user": {"reputation": 3521, "user_id": 2521680, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/6D935.jpg?s=128&g=1", "display_name": "Rockwell Rice", "link": "https://stackoverflow.com/users/2521680/rockwell-rice"}, "edited": false, "score": 0, "creation_date": 1576706666, "post_id": 59394760, "comment_id": 104990268, "body": "@RockwellRice Yes I&#39;m hosting my site on heroku.  I see.. what alternatives would you recommend? Also by email service do you mean like mailchimp, mailgun, etc?"}, {"owner": {"reputation": 3521, "user_id": 2521680, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/6D935.jpg?s=128&g=1", "display_name": "Rockwell Rice", "link": "https://stackoverflow.com/users/2521680/rockwell-rice"}, "edited": false, "score": 0, "creation_date": 1576707597, "post_id": 59394760, "comment_id": 104990587, "body": "Not sure, I think this was the question that helped me get going, <a href=\"https://stackoverflow.com/questions/36244309/heroku-not-sending-email-with-gmail-smtp\" title=\"heroku not sending email with gmail smtp\">stackoverflow.com/questions/36244309/&hellip;</a> . Of maybe <a href=\"https://blog.heroku.com/tech_sending_email_with_gmail\" rel=\"nofollow noreferrer\">blog.heroku.com/tech_sending_email_with_gmail</a>"}], "owner": {"reputation": 512, "user_id": 11909633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/592a4e537402ececbe3126794f4e0fa8?s=128&d=identicon&r=PG&f=1", "display_name": "ninja_nugget", "link": "https://stackoverflow.com/users/11909633/ninja-nugget"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576683569, "creation_date": 1576681351, "last_edit_date": 1576683569, "question_id": 59394760, "link": "https://stackoverflow.com/questions/59394760/gmail-not-receiving-actionmailer-email", "title": "Gmail not receiving ActionMailer Email", "body": "<p>So I'm building my portfolio right now and I want to send an actual email to my gmail in development and production, using ActionMailer.</p>\n\n<p>I have configured my development.rb in a way such that if a user enters the contact form, and submit it ActionMailer would send an email to my gmail account; problem is, my gmail shows no email coming from the contact form even though logs says that the email was sent successfully.\nThings I've tried:</p>\n\n<ol>\n<li>Change gmail setting to accept less secure apps </li>\n<li>Change smtp to sendmail</li>\n<li>moved the whole smtp/sendmail configs to dev/prod.rb instead of smtp.rb</li>\n<li>change gmail addresses</li>\n</ol>\n\n<p>Funny thing is, it used to work both in prod &amp; development env but after a couple of hours of not working on it, these stopped working. Please give me advise as far as how I can fix this. </p>\n\n<p>development.rb </p>\n\n<pre><code>  # MAiler\n  # Don't care if the mailer can't send.\n  config.action_mailer.raise_delivery_errors = true\n  config.action_mailer.default_url_options = { host:'localhost', port: '3000' }\n  config.action_mailer.delivery_method = :sendmail\n  #send email in dev mode\n  config.action_mailer.perform_deliveries = true\n  config.action_mailer.perform_caching = false\n  config.action_mailer.raise_delivery_errors= true\n\n  ActionMailer::Base.sendmail_settings = {\n    address:              'smtp.gmail.com',\n    port:                 587,\n    domain:               'gmail.com',\n    user_name:            ENV[\"GMAIL_EMAIL\"],\n    password:             ENV[\"GMAIL_PASSWORD\"],\n    authentication:       'plain',\n    enable_starttls_auto: true  }\n</code></pre>\n\n<p>smtp.rb\nNone at the moment, but used to be </p>\n\n<pre><code>  ActionMailer::Base.sendmail_settings = {\n    address:              'smtp.gmail.com',\n    port:                 587,\n    domain:               'gmail.com',\n    user_name:            ENV[\"GMAIL_EMAIL\"],\n    password:             ENV[\"GMAIL_PASSWORD\"],\n    authentication:       'plain',\n    enable_starttls_auto: true  }\n</code></pre>\n\n<p>Production.rb</p>\n\n<pre><code># MAiler\n  # Don't care if the mailer can't send.\n  config.action_mailer.raise_delivery_errors = true\n  config.action_mailer.default_url_options = { host:'www.domainname.com' } #domainname hidden \n  config.action_mailer.delivery_method = :sendmail\n  #send email in dev mode\n  config.action_mailer.perform_deliveries = true\n  config.action_mailer.perform_caching = false\n  config.action_mailer.raise_delivery_errors= true\n  # config.action_mailer.perform_caching = false\n</code></pre>\n\n<p>contact_mailer.rb</p>\n\n<pre><code>class ContactMailer &lt; ApplicationMailer\n  def contact_email(contact)\n    @contact = contact\n      # default from: \"#{@contact.email}\"\n      mail(from: \"#{@contact.email}\", to: \"email@gmail.com\", subject: \"#{@contact.subject}\")\n  end\nend\n</code></pre>\n\n<p>.env</p>\n\n<pre><code>GMAIL_EMAIL=email.com\nGMAIL_PASSWORD=#hiddenbcofsecurity\n</code></pre>\n\n<p>Any insights will be appreciated. Also if additional info is needed to let me know.\nThanks.</p>\n\n<p>EDIT: I will post the logs of what the terminal is showing upon submitting the form. </p>\n\n<p>Development: </p>\n\n<pre><code>Started POST \"/contacts\" for ::1 at 2019-12-19 00:22:29 +0900\nProcessing by ContactsController#create as HTML\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"2UYC+mGR9c/S1obBYFyBxZ76vfXUQijnQsfz8C9BeqwgeUshNV/ARlHDLvaIVripK1sRTeuXjQGRg6n0+zKS4g==\", \"contact\"=&gt;{\"full_name\"=&gt;\"Bob Marley\", \"email\"=&gt;\"bobmarley@nifty.com\", \"subject\"=&gt;\"dev modde\", \"message\"=&gt;\"hi\"}, \"commit\"=&gt;\"SEND\"}\n   (0.5ms)  BEGIN\n  \u21b3 app/controllers/contacts_controller.rb:8\n  Contact Create (0.7ms)  INSERT INTO \"contacts\" (\"full_name\", \"email\", \"message\", \"created_at\", \"updated_at\", \"subject\") VALUES ($1, $2, $3, $4, $5, $6) RETURNING \"id\"  [[\"full_name\", \"Bob Marley\"], [\"email\", \"bobmarley@nifty.com\"], [\"message\", \"hi\"], [\"created_at\", \"2019-12-18 15:22:29.134945\"], [\"updated_at\", \"2019-12-18 15:22:29.134945\"], [\"subject\", \"dev modde\"]]\n  \u21b3 app/controllers/contacts_controller.rb:8\n   (0.5ms)  COMMIT\n  \u21b3 app/controllers/contacts_controller.rb:8\n  Rendering contact_mailer/contact_email.html.erb within layouts/mailer\n  Rendered contact_mailer/contact_email.html.erb within layouts/mailer (0.4ms)\nContactMailer#contact_email: processed outbound mail in 42.8ms\nSent mail to mygmail@gmail.com (34.0ms)\nDate: Thu, 19 Dec 2019 00:22:29 +0900\nFrom: bobmarley@nifty.com\nTo: mygmail@gmail.com\nMessage-ID: &lt;5dfa44353062c_2c493fc67aa1acf4626e0@taiseis-mbp.lan.mail&gt;\nSubject: dev modde\nMime-Version: 1.0\nContent-Type: text/html;\n charset=UTF-8\nContent-Transfer-Encoding: 7b\n\nit\n\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /&gt;\n    &lt;style&gt;\n      /* Email styles need to be inline */\n    &lt;/style&gt;\n  &lt;/head&gt;\n\n  &lt;body&gt;\n    hi\n  &lt;/body&gt;\n&lt;/html&gt;\n\nRedirected to http://localhost:3000/projects\nCompleted 302 Found in 99ms (ActiveRecord: 1.7ms)\n</code></pre>\n\n<p>In production (heroku logs):</p>\n\n<pre><code>2019-12-18T15:26:07.321077+00:00 app[web.1]: I, [2019-12-18T15:26:07.320977 #4]  INFO -- : [775341a7-6c37-4b93-8b4a-65afaec7426f] Started POST \"/contacts\" for 14.11.35.130 at 2019-12-18 15:26:07 +0000\n2019-12-18T15:26:07.322013+00:00 app[web.1]: I, [2019-12-18T15:26:07.321958 #4]  INFO -- : [775341a7-6c37-4b93-8b4a-65afaec7426f] Processing by ContactsController#create as HTML\n2019-12-18T15:26:07.322129+00:00 app[web.1]: I, [2019-12-18T15:26:07.322076 #4]  INFO -- : [775341a7-6c37-4b93-8b4a-65afaec7426f]   Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"QKe+3gNQhLKsvXoSisk4X40MZUg8+kCDB51wFKjTZr6FtyTHgAcN8HN6jwwLjpQyb/RR63R5GTYEIkFX5yKXww==\", \"contact\"=&gt;{\"full_name\"=&gt;\"Bob Marley\", \"email\"=&gt;\"bobmarley@nifty.com\", \"subject\"=&gt;\"prod mode\", \"message\"=&gt;\"pro mode\"}, \"commit\"=&gt;\"SEND\"}\n2019-12-18T15:26:07.325362+00:00 app[web.1]: D, [2019-12-18T15:26:07.325304 #4] DEBUG -- : [775341a7-6c37-4b93-8b4a-65afaec7426f]    (0.8ms)  BEGIN\n2019-12-18T15:26:07.327780+00:00 app[web.1]: D, [2019-12-18T15:26:07.327723 #4] DEBUG -- : [775341a7-6c37-4b93-8b4a-65afaec7426f]   Contact Create (1.2ms)  INSERT INTO \"contacts\" (\"full_name\", \"email\", \"message\", \"created_at\", \"updated_at\", \"subject\") VALUES ($1, $2, $3, $4, $5, $6) RETURNING \"id\"  [[\"full_name\", \"Bob Marley\"], [\"email\", \"bobmarley@nifty.com\"], [\"message\", \"pro mode\"], [\"created_at\", \"2019-12-18 15:26:07.325667\"], [\"updated_at\", \"2019-12-18 15:26:07.325667\"], [\"subject\", \"prod mode\"]]\n2019-12-18T15:26:07.329643+00:00 app[web.1]: D, [2019-12-18T15:26:07.329591 #4] DEBUG -- : [775341a7-6c37-4b93-8b4a-65afaec7426f]    (1.6ms)  COMMIT\n2019-12-18T15:26:07.333855+00:00 app[web.1]: I, [2019-12-18T15:26:07.333795 #4]  INFO -- : [775341a7-6c37-4b93-8b4a-65afaec7426f]   Rendering contact_mailer/contact_email.html.erb within layouts/mailer\n2019-12-18T15:26:07.334327+00:00 app[web.1]: I, [2019-12-18T15:26:07.334271 #4]  INFO -- : [775341a7-6c37-4b93-8b4a-65afaec7426f]   Rendered contact_mailer/contact_email.html.erb within layouts/mailer (0.4ms)\n2019-12-18T15:26:07.335088+00:00 app[web.1]: D, [2019-12-18T15:26:07.335025 #4] DEBUG -- : [775341a7-6c37-4b93-8b4a-65afaec7426f] ContactMailer#contact_email: processed outbound mail in 5.1ms\n2019-12-18T15:26:07.338215+00:00 app[web.1]: **sh: 1: /usr/sbin/sendmail: not found**\n2019-12-18T15:26:07.338580+00:00 app[web.1]: I, [2019-12-18T15:26:07.338497 #4]  INFO -- : [775341a7-6c37-4b93-8b4a-65afaec7426f] **Sent mail to mygmail@gmail.com** (3.3ms)\n2019-12-18T15:26:07.338659+00:00 app[web.1]: D, [2019-12-18T15:26:07.338591 #4] DEBUG -- : [775341a7-6c37-4b93-8b4a-65afaec7426f] Date: Wed, 18 Dec 2019 15:26:07 +0000\n2019-12-18T15:26:07.338661+00:00 app[web.1]: From: bobmarley@nifty.com\n2019-12-18T15:26:07.338662+00:00 app[web.1]: To: mygmail@gmail.com\n2019-12-18T15:26:07.338664+00:00 app[web.1]: Message-ID: &lt;5dfa450f5202a_42b157c94faf411871@f450c424-ae43-4fd2-8009-51ce04ea4d9f.mail&gt;\n2019-12-18T15:26:07.338665+00:00 app[web.1]: Subject: prod mode\n2019-12-18T15:26:07.338666+00:00 app[web.1]: Mime-Version: 1.0\n2019-12-18T15:26:07.338667+00:00 app[web.1]: Content-Type: text/html;\n2019-12-18T15:26:07.338669+00:00 app[web.1]: charset=UTF-8\n2019-12-18T15:26:07.338670+00:00 app[web.1]: Content-Transfer-Encoding: 7bit\n2019-12-18T15:26:07.338671+00:00 app[web.1]: \n2019-12-18T15:26:07.338672+00:00 app[web.1]: &lt;!DOCTYPE html&gt;\n2019-12-18T15:26:07.338673+00:00 app[web.1]: &lt;html&gt;\n2019-12-18T15:26:07.338674+00:00 app[web.1]: &lt;head&gt;\n2019-12-18T15:26:07.338676+00:00 app[web.1]: &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /&gt;\n2019-12-18T15:26:07.338677+00:00 app[web.1]: &lt;style&gt;\n2019-12-18T15:26:07.338678+00:00 app[web.1]: /* Email styles need to be inline */\n2019-12-18T15:26:07.338679+00:00 app[web.1]: &lt;/style&gt;\n2019-12-18T15:26:07.338680+00:00 app[web.1]: &lt;/head&gt;\n2019-12-18T15:26:07.338680+00:00 app[web.1]: \n2019-12-18T15:26:07.338681+00:00 app[web.1]: &lt;body&gt;\n2019-12-18T15:26:07.338682+00:00 app[web.1]: pro mode\n2019-12-18T15:26:07.338683+00:00 app[web.1]: &lt;/body&gt;\n2019-12-18T15:26:07.338684+00:00 app[web.1]: &lt;/html&gt;\n2019-12-18T15:26:07.338685+00:00 app[web.1]: \n2019-12-18T15:26:07.338964+00:00 app[web.1]: I, [2019-12-18T15:26:07.338914 #4]  INFO -- : [775341a7-6c37-4b93-8b4a-65afaec7426f] Redirected to mydomain\n</code></pre>\n\n<p>No errors were found aside from \n<strong>sh: 1: /usr/sbin/sendmail: not found</strong>\nwhich is weird because i added the sendmail gem and executed bundle install.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1391, "user_id": 12227905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/383WE.jpg?s=128&g=1", "display_name": "Alec Joy", "link": "https://stackoverflow.com/users/12227905/alec-joy"}, "edited": false, "score": 1, "creation_date": 1576680065, "post_id": 59394336, "comment_id": 104978013, "body": "There is a file in your project called Gemfile. In there is a line where the ruby version is defined as 2.6.4. You can either change it to 2.6.3 or install Ruby 2.6.4 on your machine"}, {"owner": {"reputation": 76, "user_id": 12380239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rEpjA.jpg?s=128&g=1", "display_name": "Saahil Hamayun", "link": "https://stackoverflow.com/users/12380239/saahil-hamayun"}, "edited": false, "score": 0, "creation_date": 1576684655, "post_id": 59394336, "comment_id": 104980704, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/19342044/how-to-fix-your-ruby-version-is-1-9-3-but-your-gemfile-specified-2-0-0\">How to fix &quot;Your Ruby version is 1.9.3, but your Gemfile specified 2.0.0&quot;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 188, "user_id": 787436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdbd1ea1cbcc38582b3f655426541ce8?s=128&d=identicon&r=PG", "display_name": "andoke", "link": "https://stackoverflow.com/users/787436/andoke"}, "is_accepted": false, "score": 0, "last_activity_date": 1576683661, "creation_date": 1576683661, "answer_id": 59395481, "question_id": 59394336, "link": "https://stackoverflow.com/questions/59394336/your-ruby-version-is-2-6-3-but-your-gemfile-specified-2-6-4/59395481#59395481", "title": "Your Ruby version is 2.6.3, but your Gemfile specified 2.6.4?", "body": "<p>You need to install Ruby 2.6.4 or change your Gemfile from: <code>ruby \"2.6.4\"</code> to <code>ruby \"2.6.3\"</code></p>\n"}], "owner": {"reputation": 11, "user_id": 12237157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4755656302ebd08f2c3dabb267e06777?s=128&d=identicon&r=PG&f=1", "display_name": "Anh Bui", "link": "https://stackoverflow.com/users/12237157/anh-bui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 301, "favorite_count": 0, "closed_date": 1576814205, "answer_count": 1, "score": 0, "last_activity_date": 1576683661, "creation_date": 1576679889, "question_id": 59394336, "link": "https://stackoverflow.com/questions/59394336/your-ruby-version-is-2-6-3-but-your-gemfile-specified-2-6-4", "closed_reason": "Duplicate", "title": "Your Ruby version is 2.6.3, but your Gemfile specified 2.6.4?", "body": "<p>I am trying to make a very simple rails program at windows 10, and ran it very ok, then I downloaded it to my computer (win 7), it said to me that <code>Your Ruby version is 2.6.3, but your Gemfile specified 2.6.4</code></p>\n\n<p>I tried to ran <code>gem install bundler</code> , <code>bundler install</code> , <code>gem update bundler</code>, but nothing changed.</p>\n\n<p>Could you please give me some ideas? I am a newbie and very confuse with this problem. Thank you very much.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1576679545, "post_id": 59394011, "comment_id": 104977707, "body": "<i>Sidenote:</i> it\u2019s more reliable to parse by a number of letters and then add all subsequent non-spaces. Words might have very different length."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1576679836, "post_id": 59394011, "comment_id": 104977878, "body": "I hope these are short stories or this will take a very long time and be extremely memory consumptive. Also as of right now your object is invalid ( the Hash under book has no key)"}, {"owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "edited": false, "score": 0, "creation_date": 1576714004, "post_id": 59394011, "comment_id": 104992354, "body": "@MackHalliday why the speed matters? Are you planning to parse the text on demand (for example, to have the page size configurable) upon each API call? If not, just preprocess them in advance and let API to do the dumb job (just sending the prepared pages) ..."}, {"owner": {"reputation": 15, "user_id": 7358797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d354124ffebdc8f3d9ca5ece9d904bc?s=128&d=identicon&r=PG&f=1", "display_name": "MackHalliday", "link": "https://stackoverflow.com/users/7358797/mackhalliday"}, "edited": false, "score": 0, "creation_date": 1576717228, "post_id": 59394011, "comment_id": 104992975, "body": "We&#39;re parsing txt files from the Gutenberg Project, which has over 30,000 books. We&#39;d like to be able to parse the books on demand."}], "owner": {"reputation": 15, "user_id": 7358797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d354124ffebdc8f3d9ca5ece9d904bc?s=128&d=identicon&r=PG&f=1", "display_name": "MackHalliday", "link": "https://stackoverflow.com/users/7358797/mackhalliday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576678745, "creation_date": 1576678745, "question_id": 59394011, "link": "https://stackoverflow.com/questions/59394011/fastest-way-to-parse-large-body-of-text-into-pages-with-rails", "title": "Fastest Way to Parse Large Body of Text into Pages with Rails", "body": "<p>What's the fastest way to parse a large body of text into page in Rails? I'm working on parsing books into pages and rendering the parsed pages in a JSON. The raw text file does not have anything indicating page number. Therefore, we'll be parsing the page by number of words (about 400 words per page). \nThe JSON response might look something like this: </p>\n\n<pre><code>{ book :  {[\n  {page 1: Some example text....}, \n  {page 2: Some example text....},\n  {page 3: Some example text....},\n  {page 4: Some example text....},\n  {page 5: Some example text....}\n  ....\n]}}\n</code></pre>\n\n<p>What's the fastest way to do this? Are there any gems or external apis we could use?</p>\n\n<p>Thank you. </p>\n"}, {"tags": ["c", "ruby", "shared-libraries", "static-linking", "dynamic-linking"], "comments": [{"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1576684484, "post_id": 59393918, "comment_id": 104980607, "body": "I think perhaps you are confusing static linking. Any mention of .so means you are looking at a dynamically linked library, not statically linked."}, {"owner": {"reputation": 11332, "user_id": 52499, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e13c0896a2408caf559934466737f716?s=128&d=identicon&r=PG", "display_name": "x-yuri", "link": "https://stackoverflow.com/users/52499/x-yuri"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1576685296, "post_id": 59393918, "comment_id": 104981110, "body": "@GemTaylor I&#39;m indeed not sure what are sure signs that it&#39;s linked statically. But everything suggests that it is. That is, that <code>nokogiri.so</code> is linked statically to <code>libxml2</code>. And I&#39;m sure that <code>rmagick.so</code> is linked dynamically to <code>libxml2</code>. Ruby loads <code>nokogiri.so</code> and <code>rmagick.so</code> when they are <code>require</code>d."}], "answers": [{"comments": [{"owner": {"reputation": 11332, "user_id": 52499, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e13c0896a2408caf559934466737f716?s=128&d=identicon&r=PG", "display_name": "x-yuri", "link": "https://stackoverflow.com/users/52499/x-yuri"}, "edited": false, "score": 0, "creation_date": 1576831140, "post_id": 59419800, "comment_id": 105030706, "body": "Awesome answer. But can you elaborate please? What are archive libraries? To build correctly one has to add <a href=\"https://stackoverflow.com/a/43626454/52499\"><code>-fvisibility=hidden</code></a>?"}, {"owner": {"reputation": 11332, "user_id": 52499, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e13c0896a2408caf559934466737f716?s=128&d=identicon&r=PG", "display_name": "x-yuri", "link": "https://stackoverflow.com/users/52499/x-yuri"}, "edited": false, "score": 0, "creation_date": 1576839168, "post_id": 59419800, "comment_id": 105034243, "body": "And by any chance do you know a reason why they decided to emulate archive libraries? Also, I&#39;ve filed a <a href=\"https://github.com/sparklemotion/nokogiri/issues/1959\" rel=\"nofollow noreferrer\">bug report</a>. In case you want to correct my phrasing or elaborate on the solution."}], "tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": true, "score": 2, "last_activity_date": 1576816078, "creation_date": 1576816078, "answer_id": 59419800, "question_id": 59393918, "link": "https://stackoverflow.com/questions/59393918/can-a-dynamically-linked-library-override-a-static-one/59419800#59419800", "title": "Can a dynamically linked library override a static one?", "body": "<blockquote>\n  <p>So how come can nokogiri access libxml2.so's variables?</p>\n</blockquote>\n\n<p>This is by design (and due to the fact that <code>nokogiri</code> was built incorrectly).</p>\n\n<p>UNIX shared libraries are <em>designed</em> to emulate archive libraries. This means that the first ELF image to export a given symbol wins (there are some complications for libraries linked with <code>-Bstatic</code> flag, but we'll ignore them for now).</p>\n\n<blockquote>\n  <p>Does that mean that loading libxml2.so overrides any statically linked versions?</p>\n</blockquote>\n\n<p>Yes, if statically linked version is also exported and calls to it go though PLT.</p>\n\n<blockquote>\n  <p>Can that happen in the middle of code execution?</p>\n</blockquote>\n\n<p>With lazy symbol resolution (which is default, except when <code>LD_BIND_NOW</code> or <code>-z now</code> are in effect) it will <em>always</em> happen in the middle of code execution.</p>\n\n<p>Now, the problem is that if <code>nokogiri</code> links in a static copy of <code>libxml.a</code>, it should <em>hide</em> that fact by localizing that copy within itself and not exporting any of its symbols. That would prevent end users from having to deal with symbol conflicts.</p>\n\n<p>Your best bet is to either build your own <code>nokogiri</code> compiling and linking it against the same version of libxml, or to contact <code>nokogiri</code> maintainers and ask them to fix their builds.</p>\n"}], "owner": {"reputation": 11332, "user_id": 52499, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e13c0896a2408caf559934466737f716?s=128&d=identicon&r=PG", "display_name": "x-yuri", "link": "https://stackoverflow.com/users/52499/x-yuri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 59419800, "answer_count": 1, "score": 1, "last_activity_date": 1576816078, "creation_date": 1576678442, "question_id": 59393918, "link": "https://stackoverflow.com/questions/59393918/can-a-dynamically-linked-library-override-a-static-one", "title": "Can a dynamically linked library override a static one?", "body": "<p><code>nokogori</code> gem comes with its own version of <code>libxml2</code>. Moreover it <a href=\"https://github.com/sparklemotion/nokogiri/blob/v1.10.7/lib/nokogiri/version.rb#L41\" rel=\"nofollow noreferrer\">warns</a> about <code>libxml2.so</code> of a different version being loaded before it was required:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>      if compiled_parser_version != loaded_parser_version\n        [\"Nokogiri was built against LibXML version #{compiled_parser_version}, but has dynamically loaded #{loaded_parser_version}\"]\n</code></pre>\n\n<p>It basically <a href=\"https://github.com/sparklemotion/nokogiri/blob/v1.10.7/ext/nokogiri/nokogiri.c#L78-L85\" rel=\"nofollow noreferrer\">compares</a> <a href=\"http://www.xmlsoft.org/html/libxml-xmlversion.html#LIBXML_DOTTED_VERSION\" rel=\"nofollow noreferrer\"><code>LIBXML_DOTTED_VERSION</code></a> macro and <a href=\"http://www.xmlsoft.org/html/libxml-globals.html#xmlGlobalState\" rel=\"nofollow noreferrer\"><code>xmlParserVersion</code></a> global variable:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>  rb_const_set( mNokogiri,\n                rb_intern(\"LIBXML_VERSION\"),\n                NOKOGIRI_STR_NEW2(LIBXML_DOTTED_VERSION)\n              );\n  rb_const_set( mNokogiri,\n                rb_intern(\"LIBXML_PARSER_VERSION\"),\n                NOKOGIRI_STR_NEW2(xmlParserVersion)\n              );\n</code></pre>\n\n<p>And I'm experiencing it firsthand. When <code>rmagick</code> (which dynamically links to <code>libxml2.so</code>, <code>ldd</code> confirms that) is required before <code>nokogiri</code>, the latter complains.</p>\n\n<p>From what I can see <code>nokogiri</code> is linked to <code>libxml2</code> statically. First that is <a href=\"https://github.com/sparklemotion/nokogiri/blob/v1.10.7/ext/nokogiri/extconf.rb#L475\" rel=\"nofollow noreferrer\">the default</a> (supposedly). Then when <code>rmagick</code> is not required I can't see <code>libxml2.so</code> in <code>/proc/PID/maps</code>. I neither can see another version of <code>libxml2.so</code>. <code>ldd</code> doesn't list <code>libxml2.so</code> as a <code>nokogiri.so</code>'s dependency. <code>objdump</code> lists <a href=\"http://www.xmlsoft.org/html/libxml-parser.html#xmlReadMemory\" rel=\"nofollow noreferrer\"><code>xmlReadMemory</code></a> (and friends) as a <code>nokogori.so</code>'s symbol (probably a sign that it was linked statically).</p>\n\n<p>So how come can <code>nokogiri</code> access <code>libxml2.so</code>'s variables? Does that mean that loading <code>libxml2.so</code> overrides any statically linked versions? Can that happen in the middle of code execution?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1576671178, "post_id": 59391714, "comment_id": 104973335, "body": "What&#39;s the case? Do you have an expected input and expected output?"}], "answers": [{"tags": [], "owner": {"reputation": 1432, "user_id": 1184912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc5f9407e5093fbd916ea4d80c7a499f?s=128&d=identicon&r=PG", "display_name": "eyevan", "link": "https://stackoverflow.com/users/1184912/eyevan"}, "is_accepted": false, "score": 1, "last_activity_date": 1576671159, "creation_date": 1576671159, "answer_id": 59391790, "question_id": 59391714, "link": "https://stackoverflow.com/questions/59391714/ruby-on-rails-as-json-remove-some-attributes/59391790#59391790", "title": "Ruby on Rails - as_json remove some attributes", "body": "<p>You can use <code>except</code> parameter of <code>as_json</code> like so:</p>\n\n<pre><code>2.5.0 :001 &gt; {foo: 1, bar: 2, baz: 3}.as_json(except: [:baz])\n =&gt; {\"foo\"=&gt;1, \"bar\"=&gt;2} \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1576673666, "post_id": 59391796, "comment_id": 104974592, "body": "<a href=\"https://api.rubyonrails.org/classes/ActiveModel/Serializers/JSON.html#method-i-as_json\" rel=\"nofollow noreferrer\">api.rubyonrails.org/classes/ActiveModel/Serializers/&hellip;</a>"}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 5, "last_activity_date": 1576674307, "last_edit_date": 1576674307, "creation_date": 1576671199, "answer_id": 59391796, "question_id": 59391714, "link": "https://stackoverflow.com/questions/59391714/ruby-on-rails-as-json-remove-some-attributes/59391796#59391796", "title": "Ruby on Rails - as_json remove some attributes", "body": "<blockquote>\n  <p>The <code>:only</code> and <code>:except</code> options can be used to limit the attributes\n  included, and work similar to the <code>attributes</code> method.</p>\n\n<pre><code>user.as_json(only: [:id, :name])\n# =&gt; { \"id\" =&gt; 1, \"name\" =&gt; \"Konata Izumi\" }\n\nuser.as_json(except: [:id, :created_at, :age])\n# =&gt; { \"name\" =&gt; \"Konata Izumi\", \"awesome\" =&gt; true }\n</code></pre>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 331, "user_id": 5381106, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gxh4rssXros/AAAAAAAAAAI/AAAAAAAAERQ/HcOZQ4ijEo4/photo.jpg?sz=128", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/5381106/abhishek"}, "is_accepted": false, "score": 0, "last_activity_date": 1576671774, "creation_date": 1576671774, "answer_id": 59391955, "question_id": 59391714, "link": "https://stackoverflow.com/questions/59391714/ruby-on-rails-as-json-remove-some-attributes/59391955#59391955", "title": "Ruby on Rails - as_json remove some attributes", "body": "<p>You can use <code>only</code> or <code>except</code> for your use case. </p>\n\n<p>Something like below should work: </p>\n\n<pre><code>#&lt;Address id: nil, \n          address1: nil, \n          address2: nil,\n          city_name: nil, \n          zipcode: nil, \n          phone: nil, \n          state_id: nil, \n          country_id: nil, \n          created_at: nil, \n          updated_at: nil, \n          address_type: nil, \n          latitude: nil, \n          longitude: nil,\n          city_id: nil, \n          locality: nil&gt;\n</code></pre>\n\n<pre><code>json = address.as_json(only: %i[id \n                                address1 \n                                address2\n                                locality \n                                city_id \n                                zipcode\n                                address_type\n                                latitude \n                                longitude],\n                           methods: [:city_slug])  # yes, you can use methods as attributes also\n\n</code></pre>\n"}], "owner": {"reputation": 505, "user_id": 6051241, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/08e5264e3f2f51468c2987fa73fa8c82?s=128&d=identicon&r=PG&f=1", "display_name": "mikasa", "link": "https://stackoverflow.com/users/6051241/mikasa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 59391796, "answer_count": 3, "score": 1, "last_activity_date": 1576674307, "creation_date": 1576670885, "question_id": 59391714, "link": "https://stackoverflow.com/questions/59391714/ruby-on-rails-as-json-remove-some-attributes", "title": "Ruby on Rails - as_json remove some attributes", "body": "<p>I have a response ready with some attributes. However, I dont want some of them to get passed on to the response. How do I do that? I think I need to use <code>except</code> somehow. </p>\n"}, {"tags": ["ruby", "windows", "bundle"], "answers": [{"comments": [{"owner": {"reputation": 942, "user_id": 2061517, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/50effaeae7b9684e1b7551a9e16ed521?s=128&d=identicon&r=PG", "display_name": "dstewart101", "link": "https://stackoverflow.com/users/2061517/dstewart101"}, "edited": false, "score": 0, "creation_date": 1576769676, "post_id": 59410918, "comment_id": 105012747, "body": "thanks for coming back. i had discovered that thread before. in the end, i just ditched my vm, spun up another and my problem had gone away. however, this was as good a suggestion as any. thanks"}], "tags": [], "owner": {"reputation": 11, "user_id": 876625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c94b67523017f831b2bda5f68a245e9?s=128&d=identicon&r=PG", "display_name": "weh", "link": "https://stackoverflow.com/users/876625/weh"}, "is_accepted": false, "score": 1, "last_activity_date": 1576763627, "last_edit_date": 1576763627, "creation_date": 1576762644, "answer_id": 59410918, "question_id": 59391549, "link": "https://stackoverflow.com/questions/59391549/bundle-install-wont-work-bundlerhttperror-could-not-fetch-specs-from-rubygem/59410918#59410918", "title": "bundle install won&#39;t work: Bundler::HTTPError Could not fetch specs from rubygems.org", "body": "<p>Your Browser may have its own Proxy Settings.</p>\n\n<p>Maybe you should set the <code>HTTP_PROXY/HTTPS_PROXY</code> environment variables.</p>\n\n<p>See <a href=\"https://stackoverflow.com/a/4496648\">https://stackoverflow.com/a/4496648</a></p>\n"}], "owner": {"reputation": 942, "user_id": 2061517, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/50effaeae7b9684e1b7551a9e16ed521?s=128&d=identicon&r=PG", "display_name": "dstewart101", "link": "https://stackoverflow.com/users/2061517/dstewart101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576763627, "creation_date": 1576670274, "question_id": 59391549, "link": "https://stackoverflow.com/questions/59391549/bundle-install-wont-work-bundlerhttperror-could-not-fetch-specs-from-rubygem", "title": "bundle install won&#39;t work: Bundler::HTTPError Could not fetch specs from rubygems.org", "body": "<p>I am trying to run <code>bundle install</code> on a VM that is behind a proxy.\nI am getting the following error:</p>\n\n<pre><code>Bundler::HTTPError Could not fetch specs from rubygems.org\n</code></pre>\n\n<p>If I try to ping this then <code>Request timed out</code></p>\n\n<p>However, I can browse to the website, which makes this strange to me.</p>\n\n<p>Any suggestions how can I resolve this issue?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "paypal"], "answers": [{"tags": [], "owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "is_accepted": false, "score": 0, "last_activity_date": 1576665321, "creation_date": 1576665321, "answer_id": 59390139, "question_id": 59389886, "link": "https://stackoverflow.com/questions/59389886/paypal-environment-variables-credentials/59390139#59390139", "title": "Paypal environment variables credentials", "body": "<p>You just have to add your keys to rails credentials:</p>\n\n<p><code>EDITOR=nano rails credentials:edit</code></p>\n\n<pre><code>production:\n  paypal:\n     client_id: 'qwertzuiop'\n     client_secret: 'poiuztrewq'\n</code></pre>\n\n<p>then use this credentials in <code>config/paypal.yml</code>:</p>\n\n<pre><code>[\u2026]\nproduction:\n  mode: live\n  client_id: &lt;%= Rails.application.credentials.dig(:production, paypal, :client_id) %&gt;\n  client_secret: &lt;%= Rails.application.credentials.dig(:production, paypal, :client_secret) %&gt;\n</code></pre>\n\n<p>Or you can add your environment variables in your environment config file. For instance, in <code>config/environments/production.rb</code></p>\n\n<pre><code>PAYPAL_CLIENT_ID = Rails.application.credentials.dig(:production, paypal, :client_id)\nPAYPAL_CLIENT_SECRET = Rails.application.credentials.dig(:production, paypal, :client_secret)\n</code></pre>\n\n<p>And in <code>config/paypal.yml</code></p>\n\n<pre><code>[\u2026]\nproduction:\n  mode: live\n  client_id: PAYPAL_CLIENT_ID\n  client_secret: PAYPAL_CLIENT_SECRET\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1240, "user_id": 10352322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bd96ce59b1dac8eae18ff8458c6b5bb?s=128&d=identicon&r=PG&f=1", "display_name": "a_k_v", "link": "https://stackoverflow.com/users/10352322/a-k-v"}, "is_accepted": true, "score": 0, "last_activity_date": 1576735770, "last_edit_date": 1576735770, "creation_date": 1576668584, "answer_id": 59391091, "question_id": 59389886, "link": "https://stackoverflow.com/questions/59389886/paypal-environment-variables-credentials/59391091#59391091", "title": "Paypal environment variables credentials", "body": "<p>You can add your credentials to credentials.yml as follows</p>\n\n<pre><code>EDITOR=nano rails credentials:edit\n</code></pre>\n\n<p>Add PayPal keys as follows in the credentials file</p>\n\n<pre><code>paypal: \n development:\n  client_id: \"sdsdsdvsdvsv\"\n  client_secret: \"sdfsdsdv\"\n production:\n  client_id: 'sdsdsdvsdvsv'\n  client_secret: 'sdsdsdvsdvsv'\n</code></pre>\n\n<p>Then create a YML file in your config file called paypal.yml</p>\n\n<pre><code>development:\n  client_id: &lt;%= Rails.application.credentials.paypal[:development][:client_id] %&gt;\n  client_secret: &lt;%= Rails.application.credentials.paypal[:development][:client_secret] %&gt;\n\nproduction:\n  client_id: &lt;%= Rails.application.credentials.paypal[:production][:client_id] %&gt;\n  client_secret: &lt;%= Rails.application.credentials.paypal[:production][:client_secret] %&gt;\n  mode: live\n</code></pre>\n\n<p>Then create a paypal.rb file in initializers folder</p>\n\n<pre><code>paypal_config_file = File.join(Rails.root,'config','paypal.yml')\nraise \"#{paypal_config_file} is missing!\" unless File.exists? paypal_config_file\npaypal_config = YAML.load(ERB.new(File.read(Rails.root.join('config','paypal.yml'))).result)[Rails.env].symbolize_keys\n\nCLIENT_ID = paypal_config[:client_id]\nCLIENT_SECRET = paypal_config[:client_secret]\n</code></pre>\n\n<p>In this way, you don't need to change any code when switching to development to production.</p>\n"}], "owner": {"reputation": 21, "user_id": 12504742, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wlk9T9Bd_Rw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfrxEYALJ9tCYAccDWfvmvgQge0Sg/photo.jpg?sz=128", "display_name": "Bilal Ahmad", "link": "https://stackoverflow.com/users/12504742/bilal-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 59391091, "answer_count": 2, "score": 0, "last_activity_date": 1576735770, "creation_date": 1576664525, "last_edit_date": 1576666560, "question_id": 59389886, "link": "https://stackoverflow.com/questions/59389886/paypal-environment-variables-credentials", "title": "Paypal environment variables credentials", "body": "<p>How can i set environment variables for PayPal credentials ?\nI searched a lot but didn't got any clue.\nThis is the code in \npaypal.rb </p>\n\n<pre><code>PayPal::SDK.load(\"config/paypal.yml\", Rails.env)\nPayPal::SDK.logger = Rails.logger\nmerchant_id = \"sts9n\"\npublic_key = \"3jnfbc24f76\"\nprivate_key = \"a0167fd52cf3857e\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1576664576, "post_id": 59389877, "comment_id": 104970028, "body": "what do you mean that it hung?"}, {"owner": {"reputation": 81, "user_id": 11624961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5da9afef018ef2ac2d30401e1017a4e?s=128&d=identicon&r=PG&f=1", "display_name": "Artsom", "link": "https://stackoverflow.com/users/11624961/artsom"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1576664937, "post_id": 59389877, "comment_id": 104970239, "body": "@mrzasa I&#39;ve updated the topic"}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 11624961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5da9afef018ef2ac2d30401e1017a4e?s=128&d=identicon&r=PG&f=1", "display_name": "Artsom", "link": "https://stackoverflow.com/users/11624961/artsom"}, "edited": false, "score": 0, "creation_date": 1577374347, "post_id": 59395709, "comment_id": 105155093, "body": "Unfortunately, this solution doesn&#39;t work, it redirect me to method with name <code>with_connection</code> and inside this method the program hungs and I have no result."}, {"owner": {"reputation": 188, "user_id": 787436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdbd1ea1cbcc38582b3f655426541ce8?s=128&d=identicon&r=PG", "display_name": "andoke", "link": "https://stackoverflow.com/users/787436/andoke"}, "reply_to_user": {"reputation": 81, "user_id": 11624961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5da9afef018ef2ac2d30401e1017a4e?s=128&d=identicon&r=PG&f=1", "display_name": "Artsom", "link": "https://stackoverflow.com/users/11624961/artsom"}, "edited": false, "score": 0, "creation_date": 1577488928, "post_id": 59395709, "comment_id": 105186516, "body": "So you need to check if everything is threadsafe in your scraper services."}, {"owner": {"reputation": 81, "user_id": 11624961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5da9afef018ef2ac2d30401e1017a4e?s=128&d=identicon&r=PG&f=1", "display_name": "Artsom", "link": "https://stackoverflow.com/users/11624961/artsom"}, "edited": false, "score": 0, "creation_date": 1577691821, "post_id": 59395709, "comment_id": 105224928, "body": "So, how can I understand that? Could you please give me advice?"}, {"owner": {"reputation": 188, "user_id": 787436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdbd1ea1cbcc38582b3f655426541ce8?s=128&d=identicon&r=PG", "display_name": "andoke", "link": "https://stackoverflow.com/users/787436/andoke"}, "reply_to_user": {"reputation": 81, "user_id": 11624961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5da9afef018ef2ac2d30401e1017a4e?s=128&d=identicon&r=PG&f=1", "display_name": "Artsom", "link": "https://stackoverflow.com/users/11624961/artsom"}, "edited": false, "score": 0, "creation_date": 1577811253, "post_id": 59395709, "comment_id": 105262278, "body": "For thread-safety: look this other answer: <a href=\"https://stackoverflow.com/a/261690/787436\">stackoverflow.com/a/261690/787436</a>"}, {"owner": {"reputation": 81, "user_id": 11624961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5da9afef018ef2ac2d30401e1017a4e?s=128&d=identicon&r=PG&f=1", "display_name": "Artsom", "link": "https://stackoverflow.com/users/11624961/artsom"}, "edited": false, "score": 0, "creation_date": 1578055738, "post_id": 59395709, "comment_id": 105323984, "body": "thank you, but I run just one thread(which has access to the shared data) and it doesn&#39;t work correctly, I didn&#39;t try to run 2 or more threads."}], "tags": [], "owner": {"reputation": 188, "user_id": 787436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdbd1ea1cbcc38582b3f655426541ce8?s=128&d=identicon&r=PG", "display_name": "andoke", "link": "https://stackoverflow.com/users/787436/andoke"}, "is_accepted": false, "score": 0, "last_activity_date": 1576684409, "creation_date": 1576684409, "answer_id": 59395709, "question_id": 59389877, "link": "https://stackoverflow.com/questions/59389877/ruby-on-rails-threading/59395709#59395709", "title": "Ruby on Rails threading", "body": "<p>You are limited by the number of connections.\nUse a different connection for every thread you open: </p>\n\n<pre><code>Thread.new do \n  ActiveRecord::Base.connection_pool.with_connection do\n    Services::Scrapers::FirstScraperService.new.parse(link, data[office][link])\n  end\nend\n</code></pre>\n\n<p>Documentation: \n<a href=\"https://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/ConnectionPool.html\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/ConnectionPool.html</a></p>\n\n<p>Default limit for Rails is 5 connections. Plus the main Thread will consume a connection. So you can open only 4 new threads. If you need more, increase the number of connection pool in your <code>database.yml</code></p>\n\n<p>Also if you are interested by some sugar syntax, I would advise you to checkout the Parallel gem: <a href=\"https://github.com/grosser/parallel\" rel=\"nofollow noreferrer\">https://github.com/grosser/parallel</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8572220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbbde2b6712d7b95351a0bb72e15c90e?s=128&d=identicon&r=PG", "display_name": "Yuri Lapitsky", "link": "https://stackoverflow.com/users/8572220/yuri-lapitsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1578339252, "creation_date": 1578339252, "answer_id": 59617915, "question_id": 59389877, "link": "https://stackoverflow.com/questions/59389877/ruby-on-rails-threading/59617915#59617915", "title": "Ruby on Rails threading", "body": "<p>I think you need to create a thread pool of a certain size otherwize your number of threads does not have an upper limit. It will not work in reality.</p>\n\n<p>There can be multiple reasons why your threads hang up. After you started getting db connections from the pool now your threads will wait until there's an available connection. There's a timeout for waiting and you should eventually see exceptions related to the timeout.</p>\n\n<p>In your case, I think, the issue is in using the same connection for all the threads. Moreover, <code>with_connection</code> will not help you as suggested by one of the answers.\nFrom the <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/ConnectionPool.html#method-i-with_connection\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n\n<blockquote>\n  <p>ConnectionPool is completely thread-safe, and will ensure that a connection cannot be used by two threads at the same time, as long as ConnectionPool's contract is correctly followed.</p>\n</blockquote>\n\n<p>So you need to obtain connections in the spawned threads. Otherwise all the calls to <code>with_connection</code> will return the same db connection.</p>\n"}], "owner": {"reputation": 81, "user_id": 11624961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5da9afef018ef2ac2d30401e1017a4e?s=128&d=identicon&r=PG&f=1", "display_name": "Artsom", "link": "https://stackoverflow.com/users/11624961/artsom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1578339252, "creation_date": 1576664504, "last_edit_date": 1592644375, "question_id": 59389877, "link": "https://stackoverflow.com/questions/59389877/ruby-on-rails-threading", "title": "Ruby on Rails threading", "body": "<p>I have a problem when starting to run my scrapers into threads.\nSo, I have 3 services which scraps data from web-pages and I want to place them into 3 threads, and look how they are working together. Also, in the future I want to create more scrapers.</p>\n<p>parser_controller.rb</p>\n<pre><code>def call_all_parsers\n    file = File.read('app/controllers/matches.json')\n    data = JSON.parse(file)\n\n    threads = []\n    data.each_key do |office|\n        data[office].each_key do |link|                \n            if office == 'first_office'\n               p threads &lt;&lt; Thread.new { Services::Scrapers::FirstScraperService.new.parse(link, data[office][link]) }\n            elsif office == 'second_office'\n               p threads &lt;&lt; Thread.new { Services::Scrapers::SecondScraperService.new.parse(link, data[office][link]) }\n            elsif office == 'third_office'\n               p threads &lt;&lt; Thread.new { Services::Scrapers::ThirdScraperService.new.parse(link, data[office][link]) } \n            end\n        end\n    end\n    p threads.map(&amp;:join)\n    render 'calculate_arbitration/index'\nend\n</code></pre>\n<p>When I started call_all_parsers method, it hung. How should I do this operation or you could give an advice to use something else instead of threads.</p>\n<h1>Update</h1>\n<p>My scrapers do some operations with database(read/write/delete operations). When I said it hungs, I meant that threads started to run but no results in database and I don't know how long should I wait for the result. Let me show the example of status of 3 threads:</p>\n<pre><code>Started GET &quot;/parser&quot; for 127.0.0.1 at 2019-12-18 13:08:35 +0300\n</code></pre>\n<p>Processing by ParserController#call_all_parsers as HTML</p>\n<p><code>[Thread:0x000000031a2158@/home/test/web-programming/parser/backend/app/controllers/parser_controller.rb:19 run, Thread:0x0000000315ec50@/home/test/web-programming/parser/backend/app/controllers/parser_controller.rb:21 run, Thread:0x0000000315c450@/home/test/web-programming/parser/backend/app/controllers/parser_controller.rb:23 run]</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5.2", "axlsx"], "answers": [{"comments": [{"owner": {"reputation": 2573, "user_id": 5787849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0885a24e8501106661f4475a59fe1a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket Shivam Tiwari", "link": "https://stackoverflow.com/users/5787849/aniket-shivam-tiwari"}, "edited": false, "score": 0, "creation_date": 1576667808, "post_id": 59389453, "comment_id": 104971699, "body": "In my case I don&#39;t have to worry about DOS Attack vector"}, {"owner": {"reputation": 68, "user_id": 2592147, "user_type": "registered", "profile_image": "https://graph.facebook.com/1435864062/picture?type=large", "display_name": "Steffen Jurrack", "link": "https://stackoverflow.com/users/2592147/steffen-jurrack"}, "reply_to_user": {"reputation": 2573, "user_id": 5787849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0885a24e8501106661f4475a59fe1a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket Shivam Tiwari", "link": "https://stackoverflow.com/users/5787849/aniket-shivam-tiwari"}, "edited": false, "score": 0, "creation_date": 1576743037, "post_id": 59389453, "comment_id": 104999148, "body": "Why voting it down? DOS is a problem here cause axlsx will consume a lot of RAM an block a process or thread depending on your implementation.  You should at least consider a ExcelCacheFile Class with a fetch_or_generate method for this."}], "tags": [], "owner": {"reputation": 68, "user_id": 2592147, "user_type": "registered", "profile_image": "https://graph.facebook.com/1435864062/picture?type=large", "display_name": "Steffen Jurrack", "link": "https://stackoverflow.com/users/2592147/steffen-jurrack"}, "is_accepted": false, "score": -3, "last_activity_date": 1576663047, "creation_date": 1576663047, "answer_id": 59389453, "question_id": 59389318, "link": "https://stackoverflow.com/questions/59389318/streaming-download-with-axlsx/59389453#59389453", "title": "Streaming download with axlsx", "body": "<p>Do you really what to generate the file triggerd by your users? This could open an DOS Attack vector. You should consider a background job preparing those files.</p>\n\n<p>An the rest should be handled in you webserver, not by rails or rack.</p>\n"}, {"tags": [], "owner": {"reputation": 68, "user_id": 2592147, "user_type": "registered", "profile_image": "https://graph.facebook.com/1435864062/picture?type=large", "display_name": "Steffen Jurrack", "link": "https://stackoverflow.com/users/2592147/steffen-jurrack"}, "is_accepted": false, "score": 0, "last_activity_date": 1576743218, "last_edit_date": 1576743218, "creation_date": 1576742916, "answer_id": 59405573, "question_id": 59389318, "link": "https://stackoverflow.com/questions/59389318/streaming-download-with-axlsx/59405573#59405573", "title": "Streaming download with axlsx", "body": "<pre><code>def download\n  @result =  FetchRecord.new(data)\n  @file = ActionView::Base.new(Rails.configuration.paths[\"app/views\"]).render(handlers: [:axlsx], template: \"model_name/download.xlsx\", locals: {result: @result})\n  respond_to do |format|\n      format.xlsx { send_file @file, disposition: \"attachment\", filename: \"file_download.xlsx\"}\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 2573, "user_id": 5787849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0885a24e8501106661f4475a59fe1a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket Shivam Tiwari", "link": "https://stackoverflow.com/users/5787849/aniket-shivam-tiwari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 290, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1576743218, "creation_date": 1576662489, "question_id": 59389318, "link": "https://stackoverflow.com/questions/59389318/streaming-download-with-axlsx", "title": "Streaming download with axlsx", "body": "<p>How to do streaming download with axlsx gem. I need a way to download huge file in chunks. The time it will take more than 5 minutes and I don't want to use any background jobs for this task. I am using <a href=\"https://github.com/caxlsx/axlsx_rails\" rel=\"nofollow noreferrer\">axlsx_rails</a> gem</p>\n\n<p>The approach which I came up with</p>\n\n<pre><code>def download\n  headers[\"Content-Type\"] = \"text/xlsx\"  \n  headers[\"Content-disposition\"] = \"attachment; filename=\\\"#{file_name}\\\"\"  \n  headers['X-Accel-Buffering'] = 'no' \n  headers[\"Cache-Control\"] ||= \"no-cache\" \n  headers.delete(\"Content-Length\")  \n  @result =  FetchRecord.new(data)\n  response.status = 200\n  render xlsx: \"file_download.xlsx.axlsx\", filename: \"#{file_name.camelize}.xlsx\",locals: {result: @result}\nend\n</code></pre>\n\n<p>The above solution is not working for me. Can someone tell me where I am going wrong</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "image", "carrierwave", "polymorphic-associations"], "comments": [{"owner": {"reputation": 1692, "user_id": 9288619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6IK38.jpg?s=128&g=1", "display_name": "code_aks", "link": "https://stackoverflow.com/users/9288619/code-aks"}, "edited": false, "score": 0, "creation_date": 1576662222, "post_id": 59388761, "comment_id": 104968853, "body": "Can you paste your parameters here which are showing in logs ?"}], "answers": [{"tags": [], "owner": {"reputation": 1692, "user_id": 9288619, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6IK38.jpg?s=128&g=1", "display_name": "code_aks", "link": "https://stackoverflow.com/users/9288619/code-aks"}, "is_accepted": true, "score": 0, "last_activity_date": 1576687020, "creation_date": 1576687020, "answer_id": 59396473, "question_id": 59388761, "link": "https://stackoverflow.com/questions/59388761/polymorphic-associations-with-images/59396473#59396473", "title": "Polymorphic associations with images", "body": "<p>Try to change your form code with below :- </p>\n\n<pre><code>.................\n................\n&lt;div class=\"form-group\"&gt;\n    &lt;%= f.label :tag_list, \"Tag (separati dalla virgola)\", class: \"col-sm-2 control-label\" %&gt;\n    &lt;div class=\"col-sm-10\"&gt;\n      &lt;%= f.text_field :tag_list, class: \"form-control\" %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= f.fields_for :pictures, f.object.pictures.build do |picture| %&gt;\n    &lt;label class=\"col-sm-2 control-label\"&gt;Image&lt;/label&gt;\n    &lt;div class=\"col-sm-10\"&gt;\n      &lt;%= picture.file_field :image, class: \"form-control\"%&gt;\n      &lt;p&gt;larghezza: 800px - altezza: 800px&lt;br /&gt;DPI 72&lt;br /&gt;peso inferiore a 50kb&lt;br /&gt;tipo file jpg o png (scarica esempio da &lt;%= link_to \"qui\", \"/res/test.jpg\", :target =&gt; \"_blank\" %&gt;)&lt;/p&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= f.label :date, class: \"col-sm-2 control-label\" %&gt;\n    &lt;div class=\"col-sm-10\"&gt;\n      &lt;%= f.date_select :date, class: \"form-control\" %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n..............\n..............\n</code></pre>\n\n<p>And change your controller permit method with below code :- </p>\n\n<pre><code>def article_params\n   params.require(:article).permit(:article_category_id, :title, :description, :date, :tag_list, :status, :pictures_attributes =&gt; [:id, :image])\nend\n</code></pre>\n\n<p>then try again to submit your form... :) </p>\n"}], "owner": {"reputation": 17, "user_id": 12250354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0cJxE.jpg?s=128&g=1", "display_name": "Gigi", "link": "https://stackoverflow.com/users/12250354/gigi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 0, "accepted_answer_id": 59396473, "answer_count": 1, "score": 1, "last_activity_date": 1576687020, "creation_date": 1576660521, "question_id": 59388761, "link": "https://stackoverflow.com/questions/59388761/polymorphic-associations-with-images", "title": "Polymorphic associations with images", "body": "<p>sorry in advance for my bad english. I have generated with rails two models, an Article model and a Picture model. In the Picture model I have used CarrierWave to upload images. Now my problem is how to save images in the database table when I complete the article form. When I upload the images and then press submit, the form saves all the data, except the images. I suppose that I have a problem with the Article controller.\nI would save images for each article and I do it with a form where I upload multiple images. The uploading comes abuot CarrierWave. But when I submit the form, I obtain the show view with all the params of the article (title, description, ..) except the images. I used polymorphic associations because I need to use the Picture model also for other models.\nThe article form is:</p>\n\n<pre><code>&lt;%= form_for([:admin, @article], html: { class: \"form-horizontal\", role: \"form\" }) do |f| %&gt;\n  &lt;% if @article.errors.any? %&gt;\n    &lt;div class=\"alert alert-danger alert-dismissable\" role=\"alert\"&gt;\n      &lt;button type=\"button\" class=\"close\" data-dismiss=\"alert\"&gt;&lt;span aria-hidden=\"true\"&gt;&amp;times;&lt;/span&gt;&lt;span class=\"sr-only\"&gt;Close&lt;/span&gt;&lt;/button&gt;\n      &lt;h4&gt;&lt;%= pluralize(@article.errors.count, \"error\") %&gt; prohibited this article from being saved:&lt;/h4&gt;\n\n      &lt;ul&gt;\n      &lt;% @article.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= f.label :article_category_id, class: \"col-sm-2 control-label\" %&gt;\n    &lt;div class=\"col-sm-10\"&gt;\n      &lt;%= f.collection_select :article_category_id, ArticleCategory.all, :id, :name, {},  {class: \"form-control\"} %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= f.label :title, class: \"col-sm-2 control-label\" %&gt;\n    &lt;div class=\"col-sm-10\"&gt;\n      &lt;%= f.text_field :title, class: \"form-control\" %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= f.label :description, class: \"col-sm-2 control-label\" %&gt;\n    &lt;div class=\"col-sm-10\"&gt;\n      &lt;%= f.text_area :description, class: \"form-control\" %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= f.label :tag_list, \"Tag (separati dalla virgola)\", class: \"col-sm-2 control-label\" %&gt;\n    &lt;div class=\"col-sm-10\"&gt;\n      &lt;%= f.text_field :tag_list, class: \"form-control\" %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= f.label :pictures, class: \"col-sm-2 control-label\" %&gt;\n    &lt;div class=\"col-sm-10\"&gt;\n      &lt;%= f.file_field :pictures, multiple: true %&gt;\n      &lt;p&gt;larghezza: 800px - altezza: 800px&lt;br /&gt;DPI 72&lt;br /&gt;peso inferiore a 50kb&lt;br /&gt;tipo file jpg o png (scarica esempio da &lt;%= link_to \"qui\", \"/res/test.jpg\", :target =&gt; \"_blank\" %&gt;)&lt;/p&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= f.label :date, class: \"col-sm-2 control-label\" %&gt;\n    &lt;div class=\"col-sm-10\"&gt;\n      &lt;%= f.date_select :date, class: \"form-control\" %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= f.label :status, class: \"col-sm-2 control-label\" %&gt;\n    &lt;div class=\"col-sm-10\"&gt;\n      &lt;%= f.select :status, options_for_select(Article.statuses.collect{|item, val| [item.humanize, item]}, selected: @article.status), class: \"form-control\" %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;div class=\"col-sm-offset-2 col-sm-10\"&gt;\n      &lt;%= f.submit class: \"btn btn-primary\" %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The article controller is:</p>\n\n<pre><code>class Admin::ArticlesController &lt; Admin::AdminController\n\n  include Sortable\n\n  before_action :set_article, only: [:show, :edit, :update, :destroy]\n\n  # GET /articles\n  # GET /articles.json\n  def index\n    if params[:tag]\n      @articles = Article.tagged_with(params[:tag])\n    else\n      @articles = Article.all\n    end\n  end\n\n  # GET /articles/1\n  # GET /articles/1.json\n  def show\n  end\n\n  # GET /articles/new\n  def new\n    @article = Article.new\n  end\n\n  # GET /articles/1/edit\n  def edit\n  end\n\n  # POST /articles\n  # POST /articles.json\n  def create\n    @article = Article.new(article_params)\n\n    respond_to do |format|\n      if @article.save\n        format.html { redirect_to [:admin, @article], notice: 'Articolo creato con successo.' }\n        format.json { render :show, status: :created, location: @article }\n      else\n        format.html { render :new }\n        format.json { render json: @article.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PATCH/PUT /articles/1\n  # PATCH/PUT /articles/1.json\n  def update\n    respond_to do |format|\n      if @article.update(article_params)\n        format.html { redirect_to [:admin, @article], notice: 'Articolo aggiornato con successo.' }\n        format.json { render :show, status: :ok, location: @article }\n      else\n        format.html { render :edit }\n        format.json { render json: @article.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /articles/1\n  # DELETE /articles/1.json\n  def destroy\n    @article.destroy\n    respond_to do |format|\n      format.html { redirect_to admin_articles_url, notice: 'Articolo eliminato con successo.' }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_article\n      @article = Article.find(params[:id])\n    end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    def article_params\n      params.require(:article).permit(:article_category_id, :title, :description, :date, :tag_list, :status, :pictures_attributes =&gt; [:id, :picturable_type, :picturable_id, :image =&gt; []])\n    end\n\nend\n</code></pre>\n\n<p>The article model is:</p>\n\n<pre><code>class Article &lt; ApplicationRecord\n\n  acts_as_list\n  acts_as_taggable_on :tags\n\n  belongs_to :article_category\n  has_many :comments\n  has_many :pictures, as: :picturable\n\n  accepts_nested_attributes_for :pictures\n\n  enum status: {bozza: 0, pubblicato: 1}\n\n  default_scope  {order(\"position ASC\")}\n\n  def final_image_url\n    if self.image.present?\n      return self.image_url\n    else\n      return \"/res/no-image.png\"\n    end\n  end\nend\n\n# == Schema Information\n#\n# Table name: articles\n#\n#  id                  :integer          not null, primary key\n#  article_category_id :integer\n#  title               :string(255)\n#  description         :text(65535)\n#  date                :date\n#  created_at          :datetime         not null\n#  updated_at          :datetime         not null\n#  position            :integer\n#  status              :integer\n#\n</code></pre>\n\n<p>and the picture model is:</p>\n\n<pre><code>class Picture &lt; ApplicationRecord\n\n  belongs_to :picturable, polymorphic: true\n\n  mount_uploader :image, ImageUploader\nend\n\n# == Schema Information\n#\n# Table name: pictures\n#\n#  id                  :integer          not null, primary key\n#  image               :string(255)\n#  picturable_type     :string(255)\n#  picturable_id       :integer\n#  created_at          :datetime         not null\n#  updated_at          :datetime         not null\n#\n</code></pre>\n\n<p>where the uploader, is set as:</p>\n\n<pre><code>class ImageUploader &lt; CarrierWave::Uploader::Base\n\n  # Include RMagick or MiniMagick support:\n  # include CarrierWave::RMagick\n  # include CarrierWave::MiniMagick\n\n  # Choose what kind of storage to use for this uploader:\n  storage :file\n  # storage :fog\n\n  # Override the directory where uploaded files will be stored.\n  # This is a sensible default for uploaders that are meant to be mounted:\n  def store_dir\n    \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\n\n  # Provide a default URL as a default if there hasn't been a file uploaded:\n  # def default_url\n  #   # For Rails 3.1+ asset pipeline compatibility:\n  #   # ActionController::Base.helpers.asset_path(\"fallback/\" + [version_name, \"default.png\"].compact.join('_'))\n  #\n  #   \"/images/fallback/\" + [version_name, \"default.png\"].compact.join('_')\n  # end\n\n  # Process files as they are uploaded:\n  # process scale: [200, 300]\n  #\n  # def scale(width, height)\n  #   # do something\n  # end\n\n  # Create different versions of your uploaded files:\n  # version :thumb do\n  #   process resize_to_fit: [50, 50]\n  # end\n\n  # Add a white list of extensions which are allowed to be uploaded.\n  # For images you might use something like this:\n  def extension_whitelist\n    %w(jpg jpeg gif png)\n  end\n\n  # Override the filename of the uploaded files:\n  # Avoid using model.id or version_name here, see uploader/store.rb for details.\n  # def filename\n  #   \"something.jpg\" if original_filename\n  # end\n\nend\n</code></pre>\n\n<p>Thank you in advance for any help.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 7, "creation_date": 1576657343, "post_id": 59387991, "comment_id": 104966565, "body": "<code>&quot;Doe,Jon&quot;.split(&#39;,&#39;).last</code>"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 6, "creation_date": 1576657468, "post_id": 59387991, "comment_id": 104966623, "body": "<code>&quot;Doe,Jon&quot;.gsub(&#47;.*,&#47;, &#39;&#39;)</code>"}, {"owner": {"reputation": 741, "user_id": 6894749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gbstY.jpg?s=128&g=1", "display_name": "Thang", "link": "https://stackoverflow.com/users/6894749/thang"}, "edited": false, "score": 5, "creation_date": 1576658243, "post_id": 59387991, "comment_id": 104966925, "body": "<code>&quot;Doe,Jon&quot;.slice((&quot;Doe,Jon&quot;.index(&#39;,&#39;)+1)..-1)</code>"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 5, "creation_date": 1576659464, "post_id": 59387991, "comment_id": 104967471, "body": "<code>&quot;Doe,Jon&quot;[&#47;(\\w+)$&#47;]</code>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 4, "creation_date": 1576660369, "post_id": 59387991, "comment_id": 104967888, "body": "<code>&quot;Doe,Jon&quot;[&#47;(\\w+),(\\w+)&#47;, 2]</code>"}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 4, "creation_date": 1576660446, "post_id": 59387991, "comment_id": 104967927, "body": "<code>require &quot;csv&quot;; CSV.parse(&quot;John,Doe&quot;)[0][1]</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 3, "creation_date": 1576660581, "post_id": 59387991, "comment_id": 104968006, "body": "<code>\u201dMy,friend,Joe\u201d[&#47;[^,]+\\z&#47;]</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 741, "user_id": 6894749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gbstY.jpg?s=128&g=1", "display_name": "Thang", "link": "https://stackoverflow.com/users/6894749/thang"}, "edited": false, "score": 1, "creation_date": 1576684235, "post_id": 59387991, "comment_id": 104980469, "body": "@Thang, perhaps use <code>rindex</code> in case there is more than one comma."}], "answers": [{"tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": false, "score": 1, "last_activity_date": 1576664754, "creation_date": 1576664754, "answer_id": 59389951, "question_id": 59387991, "link": "https://stackoverflow.com/questions/59387991/get-selected-value-from-string-from-point-to-point/59389951#59389951", "title": "Get selected value from string, from point to point", "body": "<p>So lets examine some of the solutions that are given to you in the comments</p>\n\n<h2>Split</h2>\n\n<pre><code>\"Doe,Jon\".split(',').last\n\n# or a bit more verbose\n\nparts = \"Doe,Jon\".split(',') # [\"Doe\", \"Jon\"]\nname = parts.last # \"Jon\"\n</code></pre>\n\n<p><code>String#split</code> splits a sting into an array. It uses the parameter <code>\",\"</code> as separator. <code>Array#last</code> returns the last item from an array.</p>\n\n<h2>Gsub</h2>\n\n<pre><code>\"Doe,Jon\".gsub(/.*,/, '')\n</code></pre>\n\n<p><code>String#gsub</code> substitutes the part that matches the Regular Expression (<code>/.*,/</code>) with the substitution value (<code>\"\"</code>).\nThe regexp matches everything (<code>.*</code>) up to (and including) the comma. And the replacement is an empty string, essentially deleting the part that matches the regexp.\nNote that you could/should probably have an anchor to make the regexp more strict (<code>/\\A.*,/</code>)</p>\n\n<h2>Slice</h2>\n\n<p><code>String#slice</code> creates a substring given a range. <code>-1</code> is a shortcut for the last element.\n<code>String#index</code> finds the index of a character inside a String.</p>\n\n<pre><code>\"Doe,Jon\".slice((\"Doe,Jon\".index(',')+1)..-1)\n\n# or more verbose\nfull = \"Doe,Jon\"\nindex_of_comma = full.index(',') # =&gt; 3\nindex_after_comma = index + 1\nname = full.slice(index_after_comma..full.size)\n\n</code></pre>\n\n<h2>CSV</h2>\n\n<p>CSV (Comma Separated Values) is a format where multiple values are separated by a comma (or other separation character). </p>\n\n<pre><code>require \"csv\"\nCSV.parse(\"John,Doe\")[0][1]\n</code></pre>\n\n<p>This will treat the name as CSV data and then access the first row of data (\u00b4[0]\u00b4). And from that row accesses the second element (<code>[1]</code>) which is the name.</p>\n\n<h2>Now what?</h2>\n\n<p>There are usually multiple ways to reach a goal. And it's up to you to pick a way. I'd go with the first one. To me it is easy to read and understand its purpose.</p>\n"}], "owner": {"reputation": 19, "user_id": 11138491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/230fecacd1fbe1fdb0aeb2edf052ece9?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Somo", "link": "https://stackoverflow.com/users/11138491/martin-somo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "closed_date": 1576685326, "answer_count": 1, "score": 1, "last_activity_date": 1576664754, "creation_date": 1576657266, "last_edit_date": 1576657324, "question_id": 59387991, "link": "https://stackoverflow.com/questions/59387991/get-selected-value-from-string-from-point-to-point", "closed_reason": "Needs more focus", "title": "Get selected value from string, from point to point", "body": "<p>please is in ruby possible to get information from example name <code>\"Doe,Jon\"</code> (exact format) to get only the name <code>\"Jon\"</code>? Of course the name can be always different, I was thinking if is not possible to get the value from end of string to \",\" separator. If is it possible, how?</p>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "database", "postgresql", "migration"], "answers": [{"comments": [{"owner": {"reputation": 548, "user_id": 12438293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bVweC.png?s=128&g=1", "display_name": "norioumata", "link": "https://stackoverflow.com/users/12438293/norioumata"}, "edited": false, "score": 0, "creation_date": 1576655689, "post_id": 59387626, "comment_id": 104965885, "body": "That&#39;s what I thought. Thank you!"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 5, "last_activity_date": 1576655554, "creation_date": 1576655554, "answer_id": 59387626, "question_id": 59387602, "link": "https://stackoverflow.com/questions/59387602/what-is-the-way-to-add-migration-before-specific-migration-in-ruby/59387626#59387626", "title": "What is the way to add migration before specific migration in ruby", "body": "<p>Migration files have names like <code>20190616110000_create_foo.rb</code> and are applied in the native alphabetical order.</p>\n\n<p>Simply rename files changing the timestamps according to the order you need.</p>\n"}, {"tags": [], "owner": {"reputation": 741, "user_id": 6894749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gbstY.jpg?s=128&g=1", "display_name": "Thang", "link": "https://stackoverflow.com/users/6894749/thang"}, "is_accepted": false, "score": 1, "last_activity_date": 1576656169, "creation_date": 1576656169, "answer_id": 59387745, "question_id": 59387602, "link": "https://stackoverflow.com/questions/59387602/what-is-the-way-to-add-migration-before-specific-migration-in-ruby/59387745#59387745", "title": "What is the way to add migration before specific migration in ruby", "body": "<p>Another more proper way is in your migration (the change column type) you should add a condition to check if the column is there or not.</p>\n\n<p>If it is already there (your local) then just change the column type. If it is not there (your colleagues local) then create a column with your desired type</p>\n\n<pre><code>if column_exists? :table_name, :column_name\n  change_column :table_name, :column_name, :type\nelse\n  add_column :table_name, :column_name, :type\nend\n</code></pre>\n"}], "owner": {"reputation": 548, "user_id": 12438293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bVweC.png?s=128&g=1", "display_name": "norioumata", "link": "https://stackoverflow.com/users/12438293/norioumata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1576660049, "creation_date": 1576655433, "question_id": 59387602, "link": "https://stackoverflow.com/questions/59387602/what-is-the-way-to-add-migration-before-specific-migration-in-ruby", "title": "What is the way to add migration before specific migration in ruby", "body": "<p>I have added new <strong>migration</strong> to change <strong>column type</strong>.\nIt worked well on my local.</p>\n\n<p>But my team member have had the issue in migration since that <strong>column</strong> was not in <strong>migration</strong>.</p>\n\n<p>It seems I had added that <strong>column</strong> manually in database.</p>\n\n<p>To run <strong>migration</strong> without any issues for us(me and other team members), I want to <strong>add migration to create new column before the migration to change column type</strong>.</p>\n\n<p>What is the way to do this?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 6486, "user_id": 1116230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55a894894150db28d6641f0c57e48bac?s=128&d=identicon&r=PG", "display_name": "Nico Haase", "link": "https://stackoverflow.com/users/1116230/nico-haase"}, "edited": false, "score": 0, "creation_date": 1576659521, "post_id": 59385408, "comment_id": 104967502, "body": "What have you tried so far? Where are you stuck?"}], "answers": [{"comments": [{"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1576644448, "post_id": 59385579, "comment_id": 104962497, "body": "Perfect, that&#39;s what I want. Thanks."}], "tags": [], "owner": {"reputation": 741, "user_id": 6894749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gbstY.jpg?s=128&g=1", "display_name": "Thang", "link": "https://stackoverflow.com/users/6894749/thang"}, "is_accepted": true, "score": 2, "last_activity_date": 1576644193, "creation_date": 1576644193, "answer_id": 59385579, "question_id": 59385408, "link": "https://stackoverflow.com/questions/59385408/have-to-return-the-key-while-i-have-specific-value-in-the-hash/59385579#59385579", "title": "Have to return the key while I have specific value in the hash", "body": "<p>Try the <code>key()</code> method</p>\n\n<pre><code>profile.key('locked')\n</code></pre>\n\n<p>Read more <a href=\"https://apidock.com/ruby/v2_5_5/Hash/key\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "closed_date": 1576659524, "accepted_answer_id": 59385579, "answer_count": 1, "score": -1, "last_activity_date": 1576644193, "creation_date": 1576642835, "question_id": 59385408, "link": "https://stackoverflow.com/questions/59385408/have-to-return-the-key-while-i-have-specific-value-in-the-hash", "closed_reason": "Needs more focus", "title": "Have to return the key while I have specific value in the hash", "body": "<p>I have a hash like the one shown below</p>\n\n<pre><code>profile={\"acakxqcnwbhtfcppyilk\"=&gt;\"unlocked\", \"achurktnaavqqnwtfvvt\"=&gt;\"locked\", \"chrofmjydwzcbswhpste\"=&gt;\"locked\", \"ChromeProfile\"=&gt;\"unlocked\", \"clcqozsfdblntkwlcheo\"=&gt;\"unlocked\", \"gpqhioztlmkoitjqxerm\"=&gt;\"unlocked\", \"hododpaxflyzgpwortjl\"=&gt;\"unlocked\", \"hyqnjrpttwclueqwttdw\"=&gt;\"unlocked\", \"jtdeyzcxdpgblxmpldtx\"=&gt;\"unlocked\", \"kifxvxmbifkicmapedir\"=&gt;\"unlocked\", \"lucjkeeqzynhjurnpewl\"=&gt;\"unlocked\", \"lyccchkgyscmljcvkvcj\"=&gt;\"unlocked\", \"nmqhlowcqnwmwbxijwry\"=&gt;\"unlocked\", \"nseucpicwbcyviargwjt\"=&gt;\"unlocked\", \"osecuzrbvodwgkdwovjd\"=&gt;\"unlocked\", \"pqhlxugxqppfybxdkemr\"=&gt;\"unlocked\", \"qgoaryzyriohpwzbprgg\"=&gt;\"unlocked\", \"rwtlttvtbrmziyuimgad\"=&gt;\"unlocked\", \"sxkcvnlsgqauwcbkmjcy\"=&gt;\"unlocked\", \"uyfvlzyllwimhklmmmns\"=&gt;\"unlocked\", \"vgvobxhpflhappnajizs\"=&gt;\"unlocked\", \"vlbbphwoyweyguhcmdwv\"=&gt;\"unlocked\", \"vrsjncafxunswclescvu\"=&gt;\"unlocked\", \"wxsninefjvtrxvntgkni\"=&gt;\"unlocked\", \"xdqndtyyxctkovyfsldi\"=&gt;\"unlocked\", \"ycvguesevlbopicmxfbc\"=&gt;\"unlocked\"}\n</code></pre>\n\n<p>I have to return the key which has the value 'locked', If there are more than one 'locked' is present, then the first one has to be returned.</p>\n\n<p>Is there any specific method is available to accomplish task? </p>\n"}, {"tags": ["ruby", "iterator"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1576658609, "post_id": 59384733, "comment_id": 104967066, "body": "Why do you want to do that? What are you trying to achieve?"}, {"owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1576811570, "post_id": 59384733, "comment_id": 105025898, "body": "I am trying to use a while or other loop construct with map."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1576828693, "post_id": 59384733, "comment_id": 105029789, "body": "Sure, but why? What&#39;s the problem you&#39;re trying to solve? Why do you have to deal with <code>while</code> in the first place? I&#39;m asking because there&#39;s probably a better way to solve this."}, {"owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1576900537, "post_id": 59384733, "comment_id": 105052260, "body": "Because I have run into some problems that require a while construct and create an array. Instead of initializing the array before the while and mutating it, this approach is cleaner and more Rubyish."}], "answers": [{"comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 3, "creation_date": 1576640247, "post_id": 59384812, "comment_id": 104961717, "body": "<code>[*1..10].each</code> is a waste (unless you are actually using the return value of <code>each</code>); <code>(1..10).each</code> (or <code>1.upto(10).each</code>) would be preferable."}], "tags": [], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "is_accepted": false, "score": 2, "last_activity_date": 1576641323, "last_edit_date": 1576641323, "creation_date": 1576637527, "answer_id": 59384812, "question_id": 59384733, "link": "https://stackoverflow.com/questions/59384733/is-it-possible-to-use-while-or-any-arbitrary-iterator-with-map/59384812#59384812", "title": "Is it possible to use while or any arbitrary iterator with map?", "body": "<pre><code>p [*1..10]\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\n</code></pre>\n\n<p>If you want to iterate then</p>\n\n<pre><code>(1..10).each do |num|\n  p num\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 2, "creation_date": 1576675029, "post_id": 59384937, "comment_id": 104975275, "body": "You can use <code>(1..)</code> instead of <code>(1..Float::INFINITY)</code> since Ruby 2.6.0."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 3, "last_activity_date": 1576641974, "last_edit_date": 1576641974, "creation_date": 1576638513, "answer_id": 59384937, "question_id": 59384733, "link": "https://stackoverflow.com/questions/59384733/is-it-possible-to-use-while-or-any-arbitrary-iterator-with-map/59384937#59384937", "title": "Is it possible to use while or any arbitrary iterator with map?", "body": "<p>Simple answer, no you cannot. <code>while</code> is not a typical method and so the <code>while (i &lt; 10).map do .. end</code> syntax is not even recognized.</p>\n\n<p>However if you look at the docs for <a href=\"https://ruby-doc.org/core-2.5.0/Enumerator/Lazy.html\" rel=\"nofollow noreferrer\"><code>Enumerator::Lazy</code></a> you will see something quite similar:</p>\n\n<pre><code>(1..Float::INFINITY).lazy.filter_map{|i| i*i if i.even?}.first(5)\n    # =&gt; [4, 16, 36, 64, 100]\n</code></pre>\n\n<p>In your case it could be </p>\n\n<pre><code>(1..Float::INFINITY).lazy.take_while { |x| x &lt; 10 }.map {|i| i }.to_a\n    # =&gt; [1, 2, 3, 4, 5, 6, 7, 8, 9]\n</code></pre>\n\n<p>Although this is super overcomplicated for the simple use-case you have shown. Normally I would just do <code>1.upto(10).map { |i| ... }</code></p>\n"}, {"comments": [{"owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "edited": false, "score": 0, "creation_date": 1576639569, "post_id": 59385014, "comment_id": 104961576, "body": "I want to use <code>while</code> or other construct. <code>while i &lt; 10 do</code> is just the reduced example."}, {"owner": {"reputation": 183757, "user_id": 20654, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/94066dfa49c2feb14706cb081848fda7?s=128&d=identicon&r=PG", "display_name": "OscarRyz", "link": "https://stackoverflow.com/users/20654/oscarryz"}, "reply_to_user": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "edited": false, "score": 0, "creation_date": 1576688542, "post_id": 59385014, "comment_id": 104982917, "body": "I see. In that case, no, you can&#39;t, at least not directly. See the <code>Enumerator</code> answers above for alternatives."}], "tags": [], "owner": {"reputation": 183757, "user_id": 20654, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/94066dfa49c2feb14706cb081848fda7?s=128&d=identicon&r=PG", "display_name": "OscarRyz", "link": "https://stackoverflow.com/users/20654/oscarryz"}, "is_accepted": false, "score": 0, "last_activity_date": 1576639096, "creation_date": 1576639096, "answer_id": 59385014, "question_id": 59384733, "link": "https://stackoverflow.com/questions/59384733/is-it-possible-to-use-while-or-any-arbitrary-iterator-with-map/59385014#59385014", "title": "Is it possible to use while or any arbitrary iterator with map?", "body": "<p>You can use a range: </p>\n\n<pre><code>(1..10).map { |n| n*2 }\n=&gt; [2, 4, 6, 8, 10, 12, 14, 16, 18, 20]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 6, "last_activity_date": 1576648210, "creation_date": 1576648210, "answer_id": 59386171, "question_id": 59384733, "link": "https://stackoverflow.com/questions/59384733/is-it-possible-to-use-while-or-any-arbitrary-iterator-with-map/59386171#59386171", "title": "Is it possible to use while or any arbitrary iterator with map?", "body": "<blockquote>\n  <p>Is there a way to make this emit the values?<br>\n  I want to use <code>while</code> [...]</p>\n</blockquote>\n\n<p>I doubt I follow why you want to use <code>while</code> in ruby in general, but yes, this is possible if you wrap <code>while</code> into an <code>Enumerator</code> instance.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Enumerator.new do |y|\n  i = 0\n  while i &lt; 10 do\n    i += 1\n    y &lt;&lt; i\n  end\nend.map { |i| i ** 2 }\n#\u21d2 [1, 4, 9, 16, 25, 36, 49, 64, 81, 100]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 1, "last_activity_date": 1576941018, "creation_date": 1576941018, "answer_id": 59437297, "question_id": 59384733, "link": "https://stackoverflow.com/questions/59384733/is-it-possible-to-use-while-or-any-arbitrary-iterator-with-map/59437297#59437297", "title": "Is it possible to use while or any arbitrary iterator with map?", "body": "<p>A common approach is to move the loop into its own method which <em>yields</em> each value to a block, or returns an enumerator if no block is given: (using <a href=\"https://ruby-doc.org/core-2.6.5/Object.html#method-i-enum_for\" rel=\"nofollow noreferrer\"><code>enum_for</code></a>)</p>\n\n<pre><code>def my_method\n  return enum_for(__method__) unless block_given?\n\n  i = 0\n  while i &lt; 10 do\n    i += 1\n    yield i\n  end\nend\n</code></pre>\n\n<p>This is very similar to <a href=\"https://stackoverflow.com/a/59386171/477037\">Aleksei Matiushkin's answer</a> and the usage is comparable:</p>\n\n<pre><code>my_method\n#=&gt; #&lt;Enumerator: main:my_method&gt;\n\nmy_method do |i|\n  # do something with i\nend\n\nmy_method.map { |i| i * 2 }\n#=&gt; [2, 4, 6, 8, 10, 12, 14, 16, 18, 20]\n</code></pre>\n"}], "owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 59386171, "answer_count": 5, "score": 0, "last_activity_date": 1576941018, "creation_date": 1576636851, "question_id": 59384733, "link": "https://stackoverflow.com/questions/59384733/is-it-possible-to-use-while-or-any-arbitrary-iterator-with-map", "title": "Is it possible to use while or any arbitrary iterator with map?", "body": "<pre><code>i = 0\n\nwhile i &lt; 10 do\n  i += 1\nend\n</code></pre>\n\n<p>Is there a way to make this emit the values [1..10]?</p>\n\n<p>For example:</p>\n\n<pre><code>ary = while (i &lt; 10).map do\n</code></pre>\n"}, {"tags": ["ruby", "recursion", "tail-recursion"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1576636623, "post_id": 59384214, "comment_id": 104961055, "body": "If the running total is 7990 and the next element to be added is 20, is 100% percent of 20 added to the total? Your first sentence says nothing about sorting. Why are you sorting? Why must you use recursion?"}, {"owner": {"reputation": 49, "user_id": 9220180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91608bfb773fa82da320d390aa980a1a?s=128&d=identicon&r=PG&f=1", "display_name": "thelacaning", "link": "https://stackoverflow.com/users/9220180/thelacaning"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1576639741, "post_id": 59384214, "comment_id": 104961617, "body": "Yes 100% of 20 is to be added. I sorted because I want to add the highest values first so that it will divide the lesser values first. I am using recursion to learn how to use recursion."}], "answers": [{"comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1576636034, "post_id": 59384351, "comment_id": 104960949, "body": "Welcome to stackoverflow. Please note that there are many markdown options available to you when formatting your posts: <a href=\"https://stackoverflow.com/editing-help\">stackoverflow.com/editing-help</a>"}], "tags": [], "owner": {"reputation": 1, "user_id": 5491849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d78861ec5fc5a07573cf9184e8a98f21?s=128&d=identicon&r=PG&f=1", "display_name": "jeffrey_f", "link": "https://stackoverflow.com/users/5491849/jeffrey-f"}, "is_accepted": false, "score": -2, "last_activity_date": 1576632914, "creation_date": 1576632914, "answer_id": 59384351, "question_id": 59384214, "link": "https://stackoverflow.com/questions/59384214/tail-recursion-in-ruby-producing-a-sum-of-total-before-conditional-and-after-con/59384351#59384351", "title": "Tail recursion in ruby producing a sum of total before conditional and after conditional?", "body": "<p>\\\\for Element in Arr:</p>\n\n<p>\\\\\\\\if ElementSum &lt; 8300</p>\n\n<p>\\\\\\\\\\\\ElementSum = ElementSum + Element</p>\n\n<p>\\\\\\\\else</p>\n\n<p>\\\\\\\\\\\\ElementSum = ElementSum + (Element / 2)</p>\n"}, {"tags": [], "owner": {"reputation": 49, "user_id": 9220180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91608bfb773fa82da320d390aa980a1a?s=128&d=identicon&r=PG&f=1", "display_name": "thelacaning", "link": "https://stackoverflow.com/users/9220180/thelacaning"}, "is_accepted": true, "score": 0, "last_activity_date": 1576856504, "last_edit_date": 1576856504, "creation_date": 1576633157, "answer_id": 59384371, "question_id": 59384214, "link": "https://stackoverflow.com/questions/59384214/tail-recursion-in-ruby-producing-a-sum-of-total-before-conditional-and-after-con/59384371#59384371", "title": "Tail recursion in ruby producing a sum of total before conditional and after conditional?", "body": "<p>I was adding the stuff twice.</p>\n\n<pre><code>def recur_sum(prices, total)\n  puts \"#{prices}\"\n  return total if prices.count == 0\n  if total &lt; 8000\n    recur_sum(prices[1..-1], total + prices[0])\n  else\n    recur_sum(prices[1..-1], total + prices[0] / 2)\n  end\nend\n</code></pre>\n\n<p>I found a way to do the whole thing recusrively in one function:</p>\n\n<pre><code>def recur_sum_holistic(arr, base, check, constant)\n  if check == 1\n    constant = arr.map { |x| x[:add_on] }.join(', ')\n  end\n  return \"The cost for this car is $#{((base + (((base - 24999) * 0.02) + 1200)) * 1.13).round(2)} with the following configuration: #{constant}\" if arr.count == 0\n  recur_sum_holistic(arr[1..-1], base + (arr[0][:price] / (base &lt; (24999 + 8000) ? 1 : 2)), 2, constant)\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 49, "user_id": 9220180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91608bfb773fa82da320d390aa980a1a?s=128&d=identicon&r=PG&f=1", "display_name": "thelacaning", "link": "https://stackoverflow.com/users/9220180/thelacaning"}, "edited": false, "score": 0, "creation_date": 1576727833, "post_id": 59386426, "comment_id": 104994887, "body": "can you explain why [1..-1] slices the array to me?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 49, "user_id": 9220180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91608bfb773fa82da320d390aa980a1a?s=128&d=identicon&r=PG&f=1", "display_name": "thelacaning", "link": "https://stackoverflow.com/users/9220180/thelacaning"}, "edited": false, "score": 0, "creation_date": 1576735933, "post_id": 59386426, "comment_id": 104996730, "body": "@thelacaning <a href=\"https://ruby-doc.org/core-2.6/Array.html#method-c-5B-5D\" rel=\"nofollow noreferrer\"><code>Array#[]</code></a>."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1576672223, "last_edit_date": 1576672223, "creation_date": 1576649807, "answer_id": 59386426, "question_id": 59384214, "link": "https://stackoverflow.com/questions/59384214/tail-recursion-in-ruby-producing-a-sum-of-total-before-conditional-and-after-con/59386426#59386426", "title": "Tail recursion in ruby producing a sum of total before conditional and after conditional?", "body": "<p>Ruby does not have <a href=\"https://stackoverflow.com/questions/310974/what-is-tail-call-optimization#310980\">TCO</a> enabled by default. To enable it explicitly one should do this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>RubyVM::InstructionSequence.compile_option = {\n  tailcall_optimization: true,\n  trace_instruction: false\n}\n</code></pre>\n\n<p>That said, the result might look like</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>RubyVM::InstructionSequence.compile_option = {\n  tailcall_optimization: true,\n  trace_instruction: false\n}\n\narr = [\n  { add_on: \"AWD Drivetrain\", price: 2500 },\n  { add_on: \"Sport Package\", price: 3500 },\n  { add_on: \"Winter Tire Package\", price: 2000 },\n  { add_on: \"GPS Navigation\", price: 2000 }\n]\n\ndef calculate_price_recursive(arr)\n  prices = arr.map { |x| x[:price] }.sort.reverse\n  recur_sum(prices)\nend\n\ndef recur_sum(prices, total = 0)\n  return total if prices.count == 0\n  recur_sum(\n    prices[1..-1],\n    total + prices[0] / (total &lt; 8000 ? 1 : 2)\n  )\nend\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 9220180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91608bfb773fa82da320d390aa980a1a?s=128&d=identicon&r=PG&f=1", "display_name": "thelacaning", "link": "https://stackoverflow.com/users/9220180/thelacaning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 59384371, "answer_count": 3, "score": 0, "last_activity_date": 1576856504, "creation_date": 1576631413, "question_id": 59384214, "link": "https://stackoverflow.com/questions/59384214/tail-recursion-in-ruby-producing-a-sum-of-total-before-conditional-and-after-con", "title": "Tail recursion in ruby producing a sum of total before conditional and after conditional?", "body": "<p>So I am trying to sum a total from an array, but once that total is above 8000 it should reduce the amount added by 50%. I seem to be getting the sum of the total from before and after the if condition. Can anyone explain why and how to fix it?</p>\n\n<pre><code>arr = [{ add_on: \"AWD Drivetrain\", price: 2500 }, { add_on: \"Sport Package\", price: 3500 }, { add_on: \"Winter Tire Package\", price: 2000 }, { add_on: \"GPS Navigation\", price: 2000 },]\n\ndef calculate_price_recursive(arr)\n  prices = arr.sort_by { |x| -x[:price] }.map { |x| x[:price] }\n  return recur_sum(prices, 0)\nend\n\n\ndef recur_sum(prices, total)\n  puts \"#{prices}\"\n  return total if prices.count == 0\n  if total &lt; 8000\n    prices[0] + recur_sum(prices[1..-1], total + prices[0])\n  else\n    (prices[0] / 2) + recur_sum(prices[1..-1], total + prices[0])\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "docker"], "owner": {"reputation": 2156, "user_id": 976880, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/bcade31197a5623384d853c3c5fac28a?s=128&d=identicon&r=PG", "display_name": "aBadAssCowboy", "link": "https://stackoverflow.com/users/976880/abadasscowboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1576623647, "creation_date": 1576623647, "question_id": 59383301, "link": "https://stackoverflow.com/questions/59383301/unable-to-start-new-rails-project-from-within-rubys-alpine-docker-image", "title": "Unable to start new Rails project from within Ruby&#39;s Alpine docker image", "body": "<p>I have a docker image with the following <code>Dockerfile</code> based on Ruby's Alpine docker image.</p>\n\n<pre><code>FROM ruby:2.6.5-alpine3.10\n\nRUN apk add --no-cache build-base \\\n                       bash \\\n                       postgresql-dev;\n\nRUN gem install rails\n</code></pre>\n\n<p>When I run <code>rails new .</code>, I don't see any error but many directories that should be generated as a result of the command are not generated. Here is what I see:</p>\n\n<pre><code>\u2192 docker-compose run app rails new . --database=postgresql\n       exist\n      create  README.md\n      create  Rakefile\n      create  .ruby-version\n      create  config.ru\n      create  .gitignore\n      create  Gemfile\n         run  git init from \".\"\n</code></pre>\n\n<p>However, if I build a docker image based on Ubuntu, <code>rails new .</code> generates all the directories and files as excepted. </p>\n\n<p>Could I be overlooking some configuration or setup?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1576623161, "post_id": 59382810, "comment_id": 104958335, "body": "Do try and steer away from using double-at variables (<code>@@</code>)  and instead use constants here. Even better, since this apparently can&#39;t be instantiated, use a <code>module</code> instead of a <code>class</code>, or move all this to an instance method like <code>Shell.new.start</code>."}, {"owner": {"reputation": 83, "user_id": 12551535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9061c203e8864db919b3eb3c44cb323?s=128&d=identicon&r=PG&f=1", "display_name": "selamba", "link": "https://stackoverflow.com/users/12551535/selamba"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1576623356, "post_id": 59382810, "comment_id": 104958400, "body": "I cannot make &quot;input&quot; a constant, since I made it a class variable instead of a variable local to the loop in the first place to avoid having to create it anew after every single input."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1576624144, "post_id": 59382810, "comment_id": 104958590, "body": "<code>@@input</code> shouldn&#39;t exist. <code>input</code> is already a local variable in the <code>start</code> block, and it&#39;s not related to <code>@@input</code> in any way."}, {"owner": {"reputation": 83, "user_id": 12551535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9061c203e8864db919b3eb3c44cb323?s=128&d=identicon&r=PG&f=1", "display_name": "selamba", "link": "https://stackoverflow.com/users/12551535/selamba"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1576625776, "post_id": 59382810, "comment_id": 104958974, "body": "Well this is awkward."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1576626419, "post_id": 59382810, "comment_id": 104959126, "body": "Nothing wrong with things being a bit confused so long as you clear them all up before it becomes a problem."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 12551535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9061c203e8864db919b3eb3c44cb323?s=128&d=identicon&r=PG&f=1", "display_name": "selamba", "link": "https://stackoverflow.com/users/12551535/selamba"}, "edited": false, "score": 0, "creation_date": 1576623137, "post_id": 59383182, "comment_id": 104958329, "body": "Thank you. Even at a glance, your advice was very helpful. Unfortunately, I still cannot come up with a way to define command flags and arguments."}], "tags": [], "owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "is_accepted": false, "score": 2, "last_activity_date": 1576622732, "creation_date": 1576622732, "answer_id": 59383182, "question_id": 59382810, "link": "https://stackoverflow.com/questions/59382810/ruby-custom-shell-with-custom-commands/59383182#59383182", "title": "Ruby custom shell with custom commands", "body": "<p>There's quite a bit that goes into creating a robust <a href=\"https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop\" rel=\"nofollow noreferrer\">REPL</a>, but there are a few optimizations you can take to simplify what you've got here. </p>\n\n<ol>\n<li>Create a separate <code>Runner</code> class that holds all of your commands. Use <code>methods</code> and <code>instance_methods</code> to get a list of supported commands without maintaining a separate list.</li>\n<li>Check whether a command is supported, then call the method directly rather than using a <code>case</code> statement.</li>\n<li>Capture <code>ctrl+c</code> to exit your loop cleanly.</li>\n</ol>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Shell\n  class Runner\n    def supported_method?(method)\n      # This will return an array of the instance methods that are not provided by ancestors\n      (methods - Object.instance_methods).include?(method.to_sym)\n    end\n\n    def help\n      puts \"[TODO: Help info]\"\n    end\n\n    def exit\n      system \"clear\"\n    end\n  end\n\n  def self.start\n    runner = Runner.new\n    loop do \n      print (\"&gt;&gt; \")\n      input = gets.chomp\n      if runner.supported_method?(input)\n        runner.send(input)\n      else \n        puts(\"Unknown commands: #{input}\\nType \\\"help\\\" for more info.\")\n      end\n    end\n  rescue SystemExit, Interrupt, IRB::Abort\n    puts \"\\nShutting down.\"\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 12551535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9061c203e8864db919b3eb3c44cb323?s=128&d=identicon&r=PG&f=1", "display_name": "selamba", "link": "https://stackoverflow.com/users/12551535/selamba"}, "edited": false, "score": 0, "creation_date": 1576663881, "post_id": 59385224, "comment_id": 104969655, "body": "Thank you. I will look into it."}, {"owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 0, "creation_date": 1576691022, "post_id": 59385224, "comment_id": 104984114, "body": "@Amadan \u2014 this is great, but I think you have a small bug. <code>unless command.args === args.length</code> is calling <code>Echo.args</code> but there is no such method."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 0, "creation_date": 1576721931, "post_id": 59385224, "comment_id": 104993817, "body": "@coreyward I renamed the method, but forgot to rename it in the parent class. Fixed now. (Also, this is more like a proof of concept, more work would be needed for something satisfactory, I think...)"}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 1, "last_activity_date": 1576721952, "last_edit_date": 1576721952, "creation_date": 1576640965, "answer_id": 59385224, "question_id": 59382810, "link": "https://stackoverflow.com/questions/59382810/ruby-custom-shell-with-custom-commands/59385224#59385224", "title": "Ruby custom shell with custom commands", "body": "<p>Here's one way to do this:</p>\n\n<ul>\n<li>Make a <code>Command</code> class, with an <code>inherited</code> hook that registers the subclass in the <code>Command</code></li>\n<li>Make make each command a subclass of <code>Command</code>, with a method that produces an <code>OptionParser</code> for that command, a method that produces a short description, and another method that accepts <code>args</code> and executes the command</li>\n<li>In your REPL, <code>command_name, *agrs = Shellwords.shellsplit(line)</code>, find the registered command that matches the name, get its <code>OptionParser</code> and run it on <code>args</code>, then invoke the command's executor method</li>\n<li>For <code>help</code>, just iterate on all the registered commands and get their descriptions</li>\n<li>For <code>help &lt;command&gt;</code>, just get the command's <code>OptionParser</code>, then display its help</li>\n<li>Use the <code>readline</code> module instead of <code>gets</code> so your users don't curse at you</li>\n</ul>\n\n<p>EDIT: Here's the barebones example:</p>\n\n<pre><code>require 'optparse'\nrequire 'shellwords'\nrequire 'readline'\n\nclass Command\n  @commands = {}\n\n  def self.inherited(klass)\n    klass.new.then { |instance| @commands[instance.name] = instance }\n  end\n\n  def self.commands\n    @commands\n  end\n\n  def name\n    self.class.to_s.downcase\n  end\n\n  def opts(parser)\n    parser.program_name = name\n  end\n\n  def args; (0..Float::Infinity); end\nend\n\nclass BangShell\n  def self.start\n    while line = Readline.readline(\"! \", true)\n      name, *args = Shellwords.shellsplit(line)\n      command = Command.commands[name]\n      unless command\n        STDERR.puts \"Error: Don't know about #{name}!\"\n        next\n      end\n      command.opts(opts = OptionParser.new)\n      opts.parse!(args, into: options = {})\n      unless command.args === args.length\n        STDERR.puts \"Error: Invalid number of arguments for #{name}!\"\n        next\n      end\n      if options.empty?           # this is Ruby being weird about **; but I think it's changing in 3.0\n        command.call(*args)\n      else\n        command.call(*args, **options)\n      end\n    end\n  end\nend\n\nclass Echo &lt; Command\n  def call(*args, n: false)\n    print args.join(' ')\n    puts unless n\n  end\n\n  def description\n    \"Echoes arguments to console\"\n  end\n\n  def opts(parser)\n    super\n    parser.on('-n', 'Do not emit newline')\n  end\nend\n\nclass Help &lt; Command\n  def call(name=nil)\n    if name\n      command = Command.commands[name]\n      unless command\n        STDERR.puts \"Error: Don't know about #{name}!\"\n        return\n      end\n      puts command.opts(OptionParser.new)\n    else\n      puts \"Commands:\"\n      Command.commands.each do |name, command|\n        puts command.name.ljust(20) + command.description\n      end\n    end\n  end\n\n  def description\n    \"Shows help\"\n  end\n\n  def args; (0..1); end\nend\n\nBangShell.start\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 12551535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9061c203e8864db919b3eb3c44cb323?s=128&d=identicon&r=PG&f=1", "display_name": "selamba", "link": "https://stackoverflow.com/users/12551535/selamba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1576721952, "creation_date": 1576620547, "question_id": 59382810, "link": "https://stackoverflow.com/questions/59382810/ruby-custom-shell-with-custom-commands", "title": "Ruby custom shell with custom commands", "body": "<p>I would like to write a Ruby program that is basically a shell with custom commands. This means that after calling \"<strong>ruby app.rb</strong>\" the user will enter a shell which supports special commands that I wrote.</p>\n\n<p>I used <code>loop do ... end</code> to create a basic loop that processes user input. I also used an array of strings to store all available commands, and a hash table with help messages for each available command. But this is very cumbersome.</p>\n\n<p>I would like to know how to <strong>elegantly define custom commands with flags, some of which are mandatory</strong> (e.g. create -f \"~/file.txt\" --READONLY -v). Not only that, I need the \"<strong>help</strong>\" command of my shell to output info about every single custom command, including flags, AND to have a \"<strong>menu</strong>\" command that lists every available command. As a last resort, I thought of simply creating a bunch of .rb files for every command and then using OptionParser for flags and arguments, since I know of no way to make OptionParser work with functions instead of files.</p>\n\n<p>This is what I came up with so far:</p>\n\n<pre><code>class Shell\n    @@input = \"\"\n\n    # List of all commands\n    @@commands = [\n        \"help\",\n        \"exit\"\n    ]\n\n    # Help messages associated with commands\n    @@help_strings = Hash[\n        \"help\" =&gt; \"Outputs this info.\",\n        \"exit\" =&gt; \"Closes the program.\"\n    ]\n\n\n    def self.start\n        # bash clear screen command\n        system(\"clear\")\n\n        loop do\n             print (\"&gt;&gt; \")\n             input = gets.chomp\n\n             case input\n             when \"help\"\n                 for com in @@commands\n                     puts(\"#{com}: #{@@help_strings[com]}\")\n                 end\n             when \"exit\"\n                 # bash clear screen command\n                 system(\"clear\")\n                 break\n             else\n                 puts(\"Unknown commands: #{input}\")\n                 puts(\"Type \\\"help\\\" for more info.\")\n             end\n        end\n    end\nend\n</code></pre>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "highcharts"], "comments": [{"owner": {"reputation": 2072, "user_id": 3389795, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LiAJt.jpg?s=128&g=1", "display_name": "Shiko", "link": "https://stackoverflow.com/users/3389795/shiko"}, "edited": false, "score": 0, "creation_date": 1576623985, "post_id": 59382796, "comment_id": 104958542, "body": "Can you show your controller action complete, so we can figure out the root cause ?"}, {"owner": {"reputation": 25325, "user_id": 8951377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2MYqI.jpg?s=128&g=1", "display_name": "ppotaczek", "link": "https://stackoverflow.com/users/8951377/ppotaczek"}, "edited": false, "score": 0, "creation_date": 1576752826, "post_id": 59382796, "comment_id": 105003906, "body": "Hi @hashrocket, On frontend you should do something like this: <a href=\"http://jsfiddle.net/BlackLabel/q78ef4h6/\" rel=\"nofollow noreferrer\">jsfiddle.net/BlackLabel/q78ef4h6</a>"}], "owner": {"reputation": 2060, "user_id": 3944700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4df64cd1de5941fb49263a19d80f1482?s=128&d=identicon&r=PG&f=1", "display_name": "hashrocket", "link": "https://stackoverflow.com/users/3944700/hashrocket"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576675649, "creation_date": 1576620440, "last_edit_date": 1576675649, "question_id": 59382796, "link": "https://stackoverflow.com/questions/59382796/rails-data-pull-in-highcharts", "title": "Rails Data Pull in Highcharts", "body": "<p>I have a scatter chart in my Ruby on Rails app. I'm creating a point for every supplier that a company has. The sample company has just over 4,000 suppliers. I'm pulling the name of each supplier to use as the tooltip information. The issue is the db query is taking 16+ seconds. Is there a way to have the data pulled when I click on the point? Currently, all the data gets pulled into the chart and is available when a point is clicked. In the controller, I'm creating an array with x, y and supplier_id items:</p>\n\n<pre><code>SupplierScore.where(id: supplier_ids, company_specific: false)\n  .group(:x, :y, :supplier_id)\n  .order('count_id asc')\n  .count(:id)\n</code></pre>\n\n<p>Also in the controller, I use the supplier_id to pull in all the suppliers (this happens in an <code>each</code> block):</p>\n\n<pre><code>data += \"{x: #{array[0]}, y: #{array[1]}, marker: {radius: #{radius} }, supplier_name: `#{@suppliers.find_by(id: array[2]).name}` },\"\n</code></pre>\n\n<p>Then, in the highcharts javascript, I show the supplier name when a point is clicked:</p>\n\n<pre><code>tooltip: {\n  enabled: false,\n  // show supplier name on tooltip\n  formatter: function() {\n    return this.point.supplier_name\n  }\n}\n</code></pre>\n\n<p>I also have my code setup to store only the supplier id instead of the supplier name (this is currently commented out):</p>\n\n<pre><code>data += \"{x: #{array[0]}, y: #{array[1]}, marker: {radius: #{radius} }, supplier_id: #{array[2]} },\"\n</code></pre>\n\n<p>I would like to retrieve the supplier name when the point is clicked using the supplier id that is stored in the array instead of retrieving all the supplier names when the array is created. I'm hopeful that this will cause the chart to load much faster.</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>Here is the complete controller action:</p>\n\n<pre><code>def get_color_points(scores)\n  total_count = scores.values.inject(0) { |sum, x| sum + x }\n\n  data_1    = '['\n  data_2 = '['\n\n  scores.each do |array, count|\n    radius = count / total_count.to_f * 300\n    radius = radius &lt; 5 ? 5 : radius\n    radius = 5\n    if array[1] &lt;= 49\n      # data_1 += \"{x: #{array[0]}, y: #{array[1]}, marker: {radius: #{radius} }, supplier_id: #{array[2]} },\"\n      data_1 += \"{x: #{array[0]}, y: #{array[1]}, marker: {radius: #{radius} }, supplier_name: `#{@suppliers.find_by(id: array[2]).name}` },\"\n    else\n      # data_2 += \"{x: #{array[0]}, y: #{array[1]}, marker: {radius: #{radius} }, supplier_id: #{array[2]} },\"\n      data_2 += \"{x: #{array[0]}, y: #{array[1]}, marker: {radius: #{radius} }, supplier_name: `#{@suppliers.find_by(id: array[2]).name}` },\"\n    end\n  end\n\n  data_1 = orange_data[0, orange_data.length - 1] + ']'\n  data_2 = turquoise_data[0, turquoise_data.length - 1] + ']'\n  [data_1, data_2]\nend\n</code></pre>\n\n<p>The resulting array looks like this (but with 4,000+ items):</p>\n\n<pre><code>[\n  {x: 44, y: 15, marker: {radius: 5 }, supplier_id: 1792 },\n  {x: 47, y: 14, marker: {radius: 5 }, supplier_id: 1816 },\n  {x: 91, y: 7,  marker: {radius: 5 }, supplier_id: 3864 },\n  {x: 82, y: 17, marker: {radius: 5 }, supplier_id: 1824 },\n  {x: 78, y: 1,  marker: {radius: 5 }, supplier_id: 1888 },\n  {x: 30, y: 7,  marker: {radius: 5 }, supplier_id: 3952 },\n  {x: 77, y: 10, marker: {radius: 5 }, supplier_id: 1936 }\n]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "odoo", "odoo-12"], "owner": {"reputation": 13, "user_id": 12554809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97aaa9cf534d33b028f5cdea94fd8100?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Joll", "link": "https://stackoverflow.com/users/12554809/josh-joll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1576620018, "creation_date": 1576620018, "question_id": 59382717, "link": "https://stackoverflow.com/questions/59382717/my-rails-app-is-mixing-up-api-requests-and-responses-from-different-threads-when", "title": "My rails app is mixing up api requests and responses from different threads when called at the same time", "body": "<p>I am working on a Rails app that has a form that makes 1st party API requests to Odoo v12, where I have all of my data stored. When a user submits 2 forms simultaneously, if there's any delay in the API response (as few as .2 seconds), the server begins work on the other request, which is expected.</p>\n\n<p>However, when the responses comes back in the order they were made, rails assigns the response to the request with an open connection. e.g. response 1 is being assigned to request 2, and response 2 is being assigned to request 1.</p>\n\n<p>Inspecting the request_ids confirms that this is what is happening.\n<a href=\"https://i.stack.imgur.com/dQzoj.png\" rel=\"nofollow noreferrer\">Example of created record IDs returning to the wrong request</a></p>\n\n<blockquote>\n  <p>res.partner create</p>\n  \n  <p>Starting api call for res.partner on request\n  63f02dd4-8242-4043-9926-1e34133be2e1 at 1576616788523 </p>\n  \n  <p>[{:odoo_po=>\"7643153000\",\n  :quickbooks_invoice_url=>\"\", :deal_name=>\"Delete ME PLEASE\",\n  :deal_id=>\"427759097\", :reorder=>0, :company=>333, :sale_contact=>337,\n  :submitted_by=>98, :approver=>119, :hubspot_id=>\"427759097\",\n  :shipping_deadline=>\"2020-01-07\", :delivery_deadline=>\"2020-01-13\",\n  :knitting_deadline=>\"2020-01-03\", :internal_notes=>\"\",\n  \"distributor_po\"=>\"14215\",\n  \"kit_arrays\"=>\"1,85996,15578;2,15578,85996;\"}]</p>\n  \n  <p>sale_form.sale_form create</p>\n  \n  <p>Starting api call for sale_form.sale_form on request\n  673fa655-907a-416f-8ed9-7c97d220fc0b at 1576616788650 </p>\n  \n  <p>18805   _<br>\n  673fa655-907a-416f-8ed9-7c97d220fc0b </p>\n  \n  <p>51 ms api call for\n  sale_form.sale_form on request 673fa655-907a-416f-8ed9-7c97d220fc0b</p>\n  \n  <p>9067   _   63f02dd4-8242-4043-9926-1e34133be2e1 </p>\n  \n  <p>680 ms api call for res.partner\n  on request 63f02dd4-8242-4043-9926-1e34133be2e1 </p>\n</blockquote>\n\n<p>In the code above, the '9067' should be record_id associated with the sale_form.sale_form request(request_id 673fa655-907a-416f-8ed9-7c97d220fc0b), while the '18805' should be the record_id associated with the res.partner request(request_id 63f02dd4-8242-4043-9926-1e34133be2e1)</p>\n\n<p>The code runs fine when forms are submitted more than a few seconds apart so I don't think it is any issue with the code I've written. Is this an issue with Rails/Puma/some other Gem? Or should I shift my focus towards how Odoo is handling the requests/responses?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5836, "user_id": 1153022, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/JgpPs.jpg?s=128&g=1", "display_name": "okay56k", "link": "https://stackoverflow.com/users/1153022/okay56k"}, "edited": false, "score": 2, "creation_date": 1576618740, "post_id": 59382453, "comment_id": 104956900, "body": "If it&#39;s just one line you want to <code>DRY</code>-up then a concern or an include doesn&#39;t really save any code since you have to spend the line including the concern anyway."}, {"owner": {"reputation": 199, "user_id": 11137033, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sCsSkrYNAxY/AAAAAAAAAAI/AAAAAAAAC08/WSC-0W77zzY/photo.jpg?sz=128", "display_name": "Mahmoud Mousa Hamad", "link": "https://stackoverflow.com/users/11137033/mahmoud-mousa-hamad"}, "reply_to_user": {"reputation": 5836, "user_id": 1153022, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/JgpPs.jpg?s=128&g=1", "display_name": "okay56k", "link": "https://stackoverflow.com/users/1153022/okay56k"}, "edited": false, "score": 0, "creation_date": 1576618907, "post_id": 59382453, "comment_id": 104956972, "body": "@okay56k You are absolutely right! But I might need to change that concern (if that is the answer) in the future, and I want to only make my changes in one place."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1576619863, "post_id": 59382453, "comment_id": 104957312, "body": "<i>I tried creating a concern module (?) but could not make it work</i> What did you try? And why it didn&#39;t work?"}, {"owner": {"reputation": 199, "user_id": 11137033, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sCsSkrYNAxY/AAAAAAAAAAI/AAAAAAAAC08/WSC-0W77zzY/photo.jpg?sz=128", "display_name": "Mahmoud Mousa Hamad", "link": "https://stackoverflow.com/users/11137033/mahmoud-mousa-hamad"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1576620302, "post_id": 59382453, "comment_id": 104957481, "body": "@SebastianPalma Thank you for pointing this out. I have added the code and  the error."}], "answers": [{"tags": [], "owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "is_accepted": true, "score": 2, "last_activity_date": 1576620621, "creation_date": 1576620621, "answer_id": 59382825, "question_id": 59382453, "link": "https://stackoverflow.com/questions/59382453/rails-a-dry-way-to-add-the-same-belongs-to-statement-for-a-relatively-large-n/59382825#59382825", "title": "Rails: a DRY way to add the same `belongs_to` statement for a relatively large number of models", "body": "<p>The simple version of the module is this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module BelongsToUser\n  extend ActiveSupport::Concern\n\n  included do \n    belongs_to :user\n  end\nend\n\nclass ModelName &lt; ApplicationRecord\n  include BelongsToUSer\nend\n</code></pre>\n\n<p>Of course, this only make sense if you're doing something more complex than <code>belongs_to :user</code>, otherwise you're merely moving the statement instead of DRYing up logic, for example if you need a hefty amount of boilerplate to create the association. </p>\n\n<p>Another approach is to add a class method (\u201cmacro\u201d) to <code>ApplicationRecord</code>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class ApplicationRecord &lt; ActiveRecord::Base\n  self.abstract_class = true\n\n  def self.user_owned\n    belongs_to :user\n  end\nend\n\nclass ModelName &lt; ApplicationRecord\n  user_owned\nend\n</code></pre>\n\n<p>Same caveats apply, though.</p>\n"}], "owner": {"reputation": 199, "user_id": 11137033, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sCsSkrYNAxY/AAAAAAAAAAI/AAAAAAAAC08/WSC-0W77zzY/photo.jpg?sz=128", "display_name": "Mahmoud Mousa Hamad", "link": "https://stackoverflow.com/users/11137033/mahmoud-mousa-hamad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 59382825, "answer_count": 1, "score": 0, "last_activity_date": 1576620621, "creation_date": 1576618539, "last_edit_date": 1576620234, "question_id": 59382453, "link": "https://stackoverflow.com/questions/59382453/rails-a-dry-way-to-add-the-same-belongs-to-statement-for-a-relatively-large-n", "title": "Rails: a DRY way to add the same `belongs_to` statement for a relatively large number of models", "body": "<p>I have a rails app that has a number of models, all of which have a <code>user_id</code> field and need to belong to the <code>User</code> model because I would like to see which user authored which record for authorization purposes using ActiveAdmin. </p>\n\n<p>Anyways, I am trying to find a DRY way to add this <code>belongs_to :user</code> statement to all the models. I tried creating a concern module (?) <code>BelongsToUser</code> but could not make it work. I have also looked into model inheritance (STI) but I don't think it is suitable to my situation.</p>\n\n<p>Here is my <code>BelongsToUser</code> concern:</p>\n\n<pre><code>module BelongsToUser \n    extend ActiveSupport::Concern\n\n    belongs_to :user\n\nend\n</code></pre>\n\n<p>Here is how I include it in my models:</p>\n\n<pre><code>class ModelName &lt; ApplicationRecord\n   # Other Stuff\n\n   include BelongsToUser\n\n   # Other stuff\n\nend\n</code></pre>\n\n<p>I get the following error:</p>\n\n<blockquote>\n  <p>undefined method `belongs_to' for BelongsToUser:Module</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1576634047, "post_id": 59382025, "comment_id": 104960605, "body": "Did you read this guide? <a href=\"https://guides.rubyonrails.org/caching_with_rails.html\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/caching_with_rails.html</a> I guess you can do something like that using the low level caching"}, {"owner": {"reputation": 1, "user_id": 3035422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ba854c401ff385b7d8ae33268fe9e13?s=128&d=identicon&r=PG&f=1", "display_name": "mhutton86", "link": "https://stackoverflow.com/users/3035422/mhutton86"}, "reply_to_user": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1576809620, "post_id": 59382025, "comment_id": 105025590, "body": "Hi @arieljuod, much appreciated. I did read this thanks! Unfortunately, this won&#39;t work due to caching resources already in my database, but not providing an opportunity to cache resources from a 3rd-party API."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 3035422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ba854c401ff385b7d8ae33268fe9e13?s=128&d=identicon&r=PG&f=1", "display_name": "mhutton86", "link": "https://stackoverflow.com/users/3035422/mhutton86"}, "is_accepted": false, "score": 0, "last_activity_date": 1576809922, "creation_date": 1576809922, "answer_id": 59419280, "question_id": 59382025, "link": "https://stackoverflow.com/questions/59382025/ruby-on-rails-how-do-i-cache-partial-data-from-external-source-in-an-activerecor/59419280#59419280", "title": "Ruby on Rails How do I cache partial data from external source in an ActiveRecord model", "body": "<p>I was able to use the <code>after_find</code> hook to be able to prepopulate a result and save it if the updated time was after some configurable period. Unfortunately, this didn't scale well if I was going to do an API call for each result (cough, all of them). </p>\n\n<p>I ended up creating a rake task that was run periodically that would periodically call the external API to update parts of my record's results.</p>\n\n<p>This doesn't seem to qualify as an objective answer to what I was looking for, so I won't mark this as the result. Thanks for anyone who viewed and considered answering this question.</p>\n"}], "owner": {"reputation": 1, "user_id": 3035422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ba854c401ff385b7d8ae33268fe9e13?s=128&d=identicon&r=PG&f=1", "display_name": "mhutton86", "link": "https://stackoverflow.com/users/3035422/mhutton86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576809922, "creation_date": 1576616577, "last_edit_date": 1576617052, "question_id": 59382025, "link": "https://stackoverflow.com/questions/59382025/ruby-on-rails-how-do-i-cache-partial-data-from-external-source-in-an-activerecor", "title": "Ruby on Rails How do I cache partial data from external source in an ActiveRecord model", "body": "<p>This is my first question, so please let me know if you feel I'm making any major/minor faux pas. Thanks.</p>\n\n<p><strong>Versions:</strong></p>\n\n<ul>\n<li>Ruby - 2.5.3</li>\n<li>Rails - 5.0.3</li>\n</ul>\n\n<p>I have an existing ActiveRecord data model. Fields in a data model have become redundant to manually update as the information is available in an API. I want to retrieve, populate, and cache some of these fields from the external API.</p>\n\n<p>As most entities use the data model CRUD, I was to modify the data model to always check for the cached data, and if the TTL lapses, do a fresh pull from the API.</p>\n\n<p>Is there an existing in Rails or Ruby mechanism that would allow me to do this?</p>\n\n<p>There appear to be ActiveRecord validation hooks for updating, but no hooks I can use for retrieving.</p>\n\n<p>I'm still new to Ruby on Rails and the results from my searching haven't been great.</p>\n\n<p>Much appreciation for any help you may provide!</p>\n"}, {"tags": ["ruby", "sinatra", "jruby"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1576612754, "post_id": 59380699, "comment_id": 104954503, "body": "please, show us the exact code you&#39;re trying to run"}, {"owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "edited": false, "score": 0, "creation_date": 1576624670, "post_id": 59380699, "comment_id": 104958723, "body": "This seems to be related to bundler, check this out please: <a href=\"https://stackoverflow.com/questions/59366604/undefined-method-plain-specs-for-bundlerrubygemsintegration0x00005633f09a\" title=\"undefined method plain specs for bundlerrubygemsintegration0x00005633f09a\">stackoverflow.com/questions/59366604/&hellip;</a> There is a recommendation to downgrade bundler. The error comes from <a href=\"https://github.com/rvm/rubygems-bundler/blob/d55d5969b5b036c6ee4797049e49aab40dca4774/lib/rubygems-bundler/noexec.rb#L84\" rel=\"nofollow noreferrer\">rubygems bundler source code</a>"}, {"owner": {"reputation": 21, "user_id": 12428661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb0e34e550fa67df591c27355f3e6a6?s=128&d=identicon&r=PG&f=1", "display_name": "Jahan zeb", "link": "https://stackoverflow.com/users/12428661/jahan-zeb"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1576648797, "post_id": 59380699, "comment_id": 104963522, "body": "@mrzasa I am following the exact same tutorial which is at the link <a href=\"http://www.ioncannon.net/programming/1325/getting-started-with-jruby-webapps-using-rack-and-sinatra/\" rel=\"nofollow noreferrer\">ioncannon.net/programming/1325/&hellip;</a>"}, {"owner": {"reputation": 21, "user_id": 12428661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb0e34e550fa67df591c27355f3e6a6?s=128&d=identicon&r=PG&f=1", "display_name": "Jahan zeb", "link": "https://stackoverflow.com/users/12428661/jahan-zeb"}, "reply_to_user": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "edited": false, "score": 0, "creation_date": 1576648921, "post_id": 59380699, "comment_id": 104963556, "body": "@Christian I have downgraded my bundler gem to 1.x.x and to 2.0.2 as well but no luck so far."}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1576653002, "post_id": 59380699, "comment_id": 104964865, "body": "@Jahanzeb I have no idea what step caused this issue, so I can&#39;t help you."}, {"owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "edited": false, "score": 0, "creation_date": 1576707985, "post_id": 59380699, "comment_id": 104990754, "body": "I&#39;d reinstall everything and start over with another tutorial, e.g. <a href=\"http://recipes.sinatrarb.com/p/deployment/jruby\" rel=\"nofollow noreferrer\">recipes.sinatrarb.com/p/deployment/jruby</a>? Was able to run this on my Mac."}], "owner": {"reputation": 21, "user_id": 12428661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb0e34e550fa67df591c27355f3e6a6?s=128&d=identicon&r=PG&f=1", "display_name": "Jahan zeb", "link": "https://stackoverflow.com/users/12428661/jahan-zeb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 164, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576612771, "creation_date": 1576610039, "last_edit_date": 1576612771, "question_id": 59380699, "link": "https://stackoverflow.com/questions/59380699/nomethoderror-undefined-method-plain-specs-for-bundlerrubygemsintegration", "title": "NoMethodError: undefined method `plain_specs&#39; for #&lt;Bundler::RubygemsIntegration", "body": "<p>I am new to actually very new. I am trying to run sinatra with jruby below is the tutorail I am try to follow,</p>\n\n<p><a href=\"http://www.ioncannon.net/programming/1325/getting-started-with-jruby-webapps-using-rack-and-sinatra/\" rel=\"nofollow noreferrer\">http://www.ioncannon.net/programming/1325/getting-started-with-jruby-webapps-using-rack-and-sinatra/</a></p>\n\n<p>I have installed everything accordingly but I am getting an exception below.</p>\n\n<pre><code>WARNING: An illegal reflective access operation has occurred\nWARNING: Illegal reflective access by org.jruby.util.SecurityHelper to field java.lang.reflect.Field.modifiers\nWARNING: Please consider reporting this to the maintainers of org.jruby.util.SecurityHelper\nWARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations\nWARNING: All illegal access operations will be denied in a future release\nNoMethodError: undefined method `plain_specs' for #&lt;Bundler::RubygemsIntegration:0x55b62629 @replaced_methods={}&gt;\n    setup at /home/jahanzeb/.rvm/rubies/jruby-9.2.6.0/lib/ruby/gems/shared/gems/rubygems-bundler-1.4.5/lib/rubygems-bundler/noexec.rb:84\n    check at /home/jahanzeb/.rvm/rubies/jruby-9.2.6.0/lib/ruby/gems/shared/gems/rubygems-bundler-1.4.5/lib/rubygems-bundler/noexec.rb:124\n   &lt;main&gt; at /home/jahanzeb/.rvm/rubies/jruby-9.2.6.0/lib/ruby/gems/shared/gems/rubygems-bundler-1.4.5/lib/rubygems-bundler/noexec.rb:131\n  require at org/jruby/RubyKernel.java:984\n   (root) at /home/jahanzeb/.rvm/rubies/jruby-9.2.6.0/lib/ruby/stdlib/rubygems/core_ext/kernel_require.rb:1\n  require at /home/jahanzeb/.rvm/rubies/jruby-9.2.6.0/lib/ruby/stdlib/rubygems/core_ext/kernel_require.rb:135\n   &lt;main&gt; at /home/jahanzeb/.rvm/rubies/jruby-9.2.6.0/lib/ruby/gems/shared/gems/rubygems-bundler-1.4.5/lib/rubygems_executable_plugin.rb:4\n     each at org/jruby/RubyArray.java:1792\n      run at /home/jahanzeb/.rvm/rubies/jruby-9.2.6.0/lib/ruby/gems/shared/gems/executable-hooks-1.6.0/lib/executable-hooks/hooks.rb:50\n   &lt;main&gt; at /home/jahanzeb/.rvm/gems/jruby-9.2.6.0/bin/jruby_executable_hooks:10\n</code></pre>\n\n<p>I have gone through the related question but no results.\nPlease help</p>\n"}, {"tags": ["ruby", "keras", "tensorflow-serving", "amazon-sagemaker"], "comments": [{"owner": {"reputation": 355, "user_id": 377418, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ba4ca418749e7bcd60522ed2ec32638c?s=128&d=identicon&r=PG", "display_name": "Drew Cummins", "link": "https://stackoverflow.com/users/377418/drew-cummins"}, "edited": false, "score": 0, "creation_date": 1591135285, "post_id": 59380426, "comment_id": 109940082, "body": "Did you ever find a solution to this? I can find <i>zero</i> information on this, and the response just says it won&#39;t accept that type."}], "owner": {"reputation": 213, "user_id": 914863, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/99444d0a0cbfb230fbbf680e170fda09?s=128&d=identicon&r=PG", "display_name": "hawmack13", "link": "https://stackoverflow.com/users/914863/hawmack13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 206, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576608832, "creation_date": 1576608832, "question_id": 59380426, "link": "https://stackoverflow.com/questions/59380426/how-to-use-ruby-to-send-image-to-a-deployed-sagemaker-endpoint-running-a-tensorf", "title": "How to use Ruby to send image to a deployed Sagemaker endpoint running a TensorFlow/Keras CNN?", "body": "<p>I have trained a CNN using Tensorflow/Keras and successfully deployed it to Sagemaker using the saved_model format.  It answers pings and the dashboard shows it is running.  </p>\n\n<p>I now need to be able to send it images and get back inferences.  I have already successfully deployed an ANN to Sagemaker and gotten predictions back, so most of the \"plumbing\" is already working.</p>\n\n<p>The Ruby performing the request is as follows:</p>\n\n<pre><code>def predict\nsagemaker = Aws::SageMakerRuntime::Client.new(\n  access_key_id: Settings.sagemaker_key_id,\n  secret_access_key: Settings.sagemaker_secret,\n  region: Settings.sagemaker_aws_region\n)\n\nresponse = sagemaker.invoke_endpoint(endpoint_name: Settings.sagemaker_endpoint_name,\n                                     content_type: 'application/x-image',\n                                     body: File.open('developer/ai/caox_test_128.jpg', 'rb'))\n\nreturn response[:body].string\n\nend\n</code></pre>\n\n<p>(For now, I simply hardcoded a known file for testing.)</p>\n\n<p>When I fire this, I get back this error:  <strong>Aws::SageMakerRuntime::Errors::ModelError: Received client error (400) from model with message \"{ \"error\": \"JSON Parse error: Invalid value. at offset: 0\" }\"</strong></p>\n\n<p>It's almost as if the model is expecting more in the body than just the image, but I can't tell what.  AWS's documentation has an example for Python using boto: </p>\n\n<pre><code>import boto3\nimport json\n\nendpoint = '&lt;insert name of your endpoint here&gt;'\n\nruntime = boto3.Session().client('sagemaker-runtime')\n\n# Read image into memory\nwith open(image, 'rb') as f:\n    payload = f.read()\n# Send image via InvokeEndpoint API\nresponse = runtime.invoke_endpoint(EndpointName=endpoint, ContentType='application/x-image', Body=payload)\n# Unpack response\nresult = json.loads(response['Body'].read().decode())\n</code></pre>\n\n<p>As far as I can tell, they are simply opening a file and sending it directly to sagemaker with no additional pre-processing.  And, insofar as I can tell, I'm doing exactly what they are doing in Ruby, just using 'aws-sdk'.</p>\n\n<p>I've looked through Amazon's documentation, and for examples on Google, but there is scant mention of doing anything special before sending the file, so I'm scratching my head.</p>\n\n<p>What else do I need to consider when sending a file to a Sagemaker endpoint running a TensorFlow/Keras CNN to get it to respond with a prediction?</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "forms"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1576605952, "post_id": 59379702, "comment_id": 104951627, "body": "<code>Allergene.find(params[:allergene_ids_add])</code>: <code>params[:allergene_ids_add]</code> isn&#39;t permitted; <code>meal_params[:allergene_ids_add]</code> is though."}, {"owner": {"reputation": 261, "user_id": 6252815, "user_type": "registered", "profile_image": "https://graph.facebook.com/1174293045936640/picture?type=large", "display_name": "Max Kirsch", "link": "https://stackoverflow.com/users/6252815/max-kirsch"}, "reply_to_user": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1576606329, "post_id": 59379702, "comment_id": 104951796, "body": "Yeah didn&#39;t notice fixed that aswell, I just copied it over from another method :). I guess it&#39;s something with the hidden_fields, as the other params don&#39;t show aswell."}, {"owner": {"reputation": 1141, "user_id": 3251463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hxssB.png?s=128&g=1", "display_name": "Scott Schupbach", "link": "https://stackoverflow.com/users/3251463/scott-schupbach"}, "edited": false, "score": 0, "creation_date": 1576608975, "post_id": 59379702, "comment_id": 104952906, "body": "Your <code>if params[:allergene_ids_add].present?</code> line should be using <code>meal_params</code>, not just <code>params</code>, shouldn&#39;t it?"}], "answers": [{"tags": [], "owner": {"reputation": 261, "user_id": 6252815, "user_type": "registered", "profile_image": "https://graph.facebook.com/1174293045936640/picture?type=large", "display_name": "Max Kirsch", "link": "https://stackoverflow.com/users/6252815/max-kirsch"}, "is_accepted": false, "score": 0, "last_activity_date": 1576772983, "creation_date": 1576772983, "answer_id": 59413600, "question_id": 59379702, "link": "https://stackoverflow.com/questions/59379702/ruby-on-rails-parameters-permitted-false/59413600#59413600", "title": "Ruby On Rails: Parameters - Permitted: false", "body": "<p>Okay, I am dumb.\nI just forgot the <code>=</code> for the hidden fields.</p>\n\n<p>So instead of:</p>\n\n<pre><code>&lt;% f.hidden_field :day, :value =&gt; local_assigns[:mealDay] %&gt;\n&lt;% f.hidden_field :tip, :value =&gt; \"Vollkost\" %&gt;\n</code></pre>\n\n<p>it should be:</p>\n\n<pre><code>&lt;%= f.hidden_field :day, :value =&gt; local_assigns[:mealDay] %&gt;\n&lt;%= f.hidden_field :tip, :value =&gt; \"Vollkost\" %&gt;\n</code></pre>\n\n<p>Then everything is working.</p>\n"}], "owner": {"reputation": 261, "user_id": 6252815, "user_type": "registered", "profile_image": "https://graph.facebook.com/1174293045936640/picture?type=large", "display_name": "Max Kirsch", "link": "https://stackoverflow.com/users/6252815/max-kirsch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 260, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576772983, "creation_date": 1576605425, "question_id": 59379702, "link": "https://stackoverflow.com/questions/59379702/ruby-on-rails-parameters-permitted-false", "title": "Ruby On Rails: Parameters - Permitted: false", "body": "<p>I'm having issues with a form in my Rails 6 application.</p>\n\n<p>I have a remote form which enters new data into the database via a JSON request, which works but only with one parameter. This is the form:</p>\n\n<pre><code>&lt;%= form_with(method: :post, remote: true, model: Meal.new, url: meals_path, class: \"editMealsForm\", data: { type: \"json\" }) do |f| %&gt;\n    &lt;div class=\"field\"&gt;\n        &lt;%= f.label :description, 'Beschreibung' %&gt;&lt;br&gt;\n        &lt;%= f.text_area :description, rows: \"4\", placeholder: \"Noch keine Mahlzeit f\u00fcr diesen Tag vorhanden, bitte eintragen!\", class: \"form-control\" %&gt;\n    &lt;/div&gt;\n    &lt;div class=\"field\"&gt;\n        &lt;%= f.label :allergene_ids_add, 'Allergene ausw\u00e4hlen', class: \"card-text\" %&gt;&lt;br&gt;\n        &lt;%= select_tag :allergene_ids_add, options_from_collection_for_select(@allergenes, :id, :name), multiple: true, class: \"selectpicker\", data: { style: \"btn-success\", width: \"fit\", live_search: \"true\", size: \"5\", title: \"Allergien w\u00e4hlen\" } %&gt;\n    &lt;/div&gt;\n\n    &lt;% f.hidden_field :day, :value =&gt; local_assigns[:mealDay] %&gt;\n    &lt;% f.hidden_field :tip, :value =&gt; \"Vollkost\" %&gt;\n\n    &lt;%= f.submit \"Speichern\", class: \"btn btn-primary mt-2 btn-block\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>And these are my permitted parameters:</p>\n\n<pre><code>def meal_params\n  params.require(:meal).permit(:day, :tip, :description, allergene_ids_add: [])\nend\n</code></pre>\n\n<p>And this is my controller action:</p>\n\n<pre><code>def create\n    @meal = Meal.new(meal_params)\n    byebug\n    if @meal.save\n      if params[:allergene_ids_add].present?\n        @allergenes_to_add = Allergene.find(params[:allergene_ids_add])\n        @allergenes_to_add.each do |allergene|\n          @meal.allergenes &lt;&lt; allergene\n        end\n      end\n      respond_to do |format|\n        format.html { redirect_to meals_path }\n        format.json { render json: @meal }\n      end\n    end\n  end\n</code></pre>\n\n<p>The problem is, that if I hit the create action, just the description parameter is permitted, the other ones are just \"ignored\", so if I fire the submit button I get the following output in the console if I hit my byebug breakpoint:</p>\n\n<h1></h1>\n\n<p>And if I look at the params:</p>\n\n<pre><code>&lt;ActionController::Parameters {\"authenticity_token\"=&gt;\"derBZeirq0bwr/FWoYRr97qUZ5p66vQc+uT+UMf5xjXXTSFEp+XOepJtGrckguGh+skWXTZ9ibHWfFTt3p80Cg==\", \"meal\"=&gt;&lt;ActionController::Parameters {\"description\"=&gt;\"test\"} permitted: false&gt;, \"commit\"=&gt;\"Speichern\", \"controller\"=&gt;\"meals\", \"action\"=&gt;\"create\"} permitted: false&gt;\n</code></pre>\n\n<p>Or just at the meal params:</p>\n\n<pre><code>&lt;ActionController::Parameters {\"description\"=&gt;\"test\"} permitted: true&gt;\n</code></pre>\n\n<p>If I run <code>@meal.valid?</code> it returns true, so I don't see where the issue is.</p>\n\n<p>Also if I check the values for the hidden fields in the form, they are filled and not nil.</p>\n\n<p>So why does this one parameter work, but the rest just isn't permitted even if I got them in my meal_params method?</p>\n"}, {"tags": ["ruby", "ibm-cloud-infrastructure", "fog", "object-storage", "ibm-cloud-storage"], "answers": [{"tags": [], "owner": {"reputation": 86, "user_id": 3878773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b32e85ee2633daaf939c5ff779e3613a?s=128&d=identicon&r=PG&f=1", "display_name": "lifemikey", "link": "https://stackoverflow.com/users/3878773/lifemikey"}, "is_accepted": false, "score": 1, "last_activity_date": 1576603701, "creation_date": 1576603701, "answer_id": 59379278, "question_id": 59379096, "link": "https://stackoverflow.com/questions/59379096/fog-aws-gem-for-ibm-cloud-object-storage-is-not-working/59379278#59379278", "title": "Fog/aws gem for IBM Cloud Object Storage is not working", "body": "<blockquote>\n  <p><a href=\"https://control.cloud-object-storage.cloud.ibm.com/v2/endpoints\" rel=\"nofollow noreferrer\">https://control.cloud-object-storage.cloud.ibm.com/v2/endpoints</a>\"\n  This is not an endpoint but a list of endpoints in JSON.</p>\n</blockquote>\n\n<p>Choose the endpoint for your bucket location.\nFor example if your bucket is in us-south the public endpoint is \n<a href=\"https://s3.us-south.cloud-object-storage.appdomain.cloud\" rel=\"nofollow noreferrer\">https://s3.us-south.cloud-object-storage.appdomain.cloud</a></p>\n"}, {"tags": [], "owner": {"reputation": 68, "user_id": 8875057, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-it4zn4NFnZY/AAAAAAAAAAI/AAAAAAAAACA/H5CKtapyjuE/photo.jpg?sz=128", "display_name": "Bharath M", "link": "https://stackoverflow.com/users/8875057/bharath-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1576728365, "creation_date": 1576728365, "answer_id": 59403166, "question_id": 59379096, "link": "https://stackoverflow.com/questions/59379096/fog-aws-gem-for-ibm-cloud-object-storage-is-not-working/59403166#59403166", "title": "Fog/aws gem for IBM Cloud Object Storage is not working", "body": "<p>The following code worked for IBM Cloud Objects Storage</p>\n\n<pre><code>properties = {\n          region: region,\n          endpoint: URI('https://s3.us-south.cloud-object-storage.appdomain.cloud'),\n          credentials: Aws::Credentials.new(access_key_id, secret_access_key)\n        }\n        Aws.config.update(properties)\n        @client = Aws::S3::Client.new\n</code></pre>\n\n<p>Properties for the config can also be set as ENV variables.</p>\n\n<p>Below are few basic operations performed on COS.</p>\n\n<p>List all the bucker names</p>\n\n<blockquote>\n  <p>@client.list_buckets.buckets.map(&amp;:name)</p>\n</blockquote>\n\n<p>Create Bucket</p>\n\n<blockquote>\n  <p>@client.create_bucket(bucket: )</p>\n</blockquote>\n\n<p>Upload a file</p>\n\n<blockquote>\n  <p>@client.put_object(bucket: , key: , body: )</p>\n</blockquote>\n\n<p>Download a file</p>\n\n<blockquote>\n  <p>@client.get_object(bucket: , key: )</p>\n</blockquote>\n\n<p>Delete a file</p>\n\n<blockquote>\n  <p>@client.delete_object(bucket: , key: )</p>\n</blockquote>\n\n<p>Delete a Bucket</p>\n\n<blockquote>\n  <p>@client.delete_bucket(bucket: )</p>\n</blockquote>\n"}], "owner": {"reputation": 68, "user_id": 8875057, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-it4zn4NFnZY/AAAAAAAAAAI/AAAAAAAAACA/H5CKtapyjuE/photo.jpg?sz=128", "display_name": "Bharath M", "link": "https://stackoverflow.com/users/8875057/bharath-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 59403166, "answer_count": 2, "score": 1, "last_activity_date": 1576728365, "creation_date": 1576602950, "question_id": 59379096, "link": "https://stackoverflow.com/questions/59379096/fog-aws-gem-for-ibm-cloud-object-storage-is-not-working", "title": "Fog/aws gem for IBM Cloud Object Storage is not working", "body": "<p>As Softlayer or IBM Cloud has moved from Swift based Object Storage to S3 based Cloud Object Storage. I am using fog/aws instead of fog/softlayer.</p>\n\n<p>The below is the code:</p>\n\n<pre><code>require 'fog/aws'\nfog_properties = {\n  provider: 'AWS',\n  aws_access_key_id: username,\n  aws_secret_access_key: api_key\n}\n@client = Fog::Storage.new(fog_properties)\n@client.directories\n</code></pre>\n\n<p>But it failed even with valid key and id.</p>\n\n<pre><code>\n&lt;Error&gt;&lt;Code&gt;InvalidAccessKeyId&lt;/Code&gt;&lt;Message&gt;The AWS Access Key Id you provided does not exist in our records.\\&lt;/Message&gt;&lt;AWSAccessKeyId&gt;####&lt;/AWSAccessKeyId&gt;&lt;RequestId&gt;####&lt;/RequestId&gt;&lt;HostId&gt;##&lt;/HostId&gt;&lt;/Error&gt;\n</code></pre>\n\n<p>End Point IBM COS uses is \"<a href=\"https://control.cloud-object-storage.cloud.ibm.com/v2/endpoints\" rel=\"nofollow noreferrer\">https://control.cloud-object-storage.cloud.ibm.com/v2/endpoints</a>\"</p>\n\n<p>When I tried to use fog alone(require 'fog'). It throws the below error:</p>\n\n<p><code>Unable to activate google-api-client-0.23.9, because mime-types-2.99.3 conflicts with mime-types (~&gt; 3.0) (Gem::ConflictError)</code></p>\n\n<p>Please suggest how to resolve these issues.</p>\n"}, {"tags": ["ruby", "mongodb"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 12548691, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCFI9EQb26lfrINeEQoUWnzVIuOghYnKiqj5fKo9A=k-s128", "display_name": "Roondawg", "link": "https://stackoverflow.com/users/12548691/roondawg"}, "is_accepted": true, "score": 1, "last_activity_date": 1577664852, "creation_date": 1577664852, "answer_id": 59524446, "question_id": 59378971, "link": "https://stackoverflow.com/questions/59378971/mongodb-ruby-driver-create-user-w-out-password/59524446#59524446", "title": "MongoDB Ruby Driver - Create user w/out password", "body": "<p>This is actually a bug with the MongoDB-Ruby driver.  Please refer to <a href=\"https://jira.mongodb.org/browse/RUBY-2055\" rel=\"nofollow noreferrer\">https://jira.mongodb.org/browse/RUBY-2055</a></p>\n"}], "owner": {"reputation": 11, "user_id": 12548691, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCFI9EQb26lfrINeEQoUWnzVIuOghYnKiqj5fKo9A=k-s128", "display_name": "Roondawg", "link": "https://stackoverflow.com/users/12548691/roondawg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 59524446, "answer_count": 1, "score": 0, "last_activity_date": 1577664852, "creation_date": 1576602417, "question_id": 59378971, "link": "https://stackoverflow.com/questions/59378971/mongodb-ruby-driver-create-user-w-out-password", "title": "MongoDB Ruby Driver - Create user w/out password", "body": "<p>Trying to use the following code to create a user that uses mongodb X509 authentication...</p>\n\n<pre><code>client = Mongo::Client.new([\"#{Facter.value(:hostname)}:#{config['net']['port']}\"],\n                                      auth_mech: :mongodb_x509,\n                                      ssl: true,\n                                      ssl_cert: \"#{config['net']['ssl']['PEMKeyFile']}\",\n                                      ssl_key: \"#{config['net']['ssl']['PEMKeyFile']}\",\n                                      ssl_ca_cert: \"#{config['net']['ssl']['CAFile']}\",\n                                      :database =&gt; '$external',\n                                      :connect =&gt; 'direct')\nclient.use(:$external).database.users\n          client.database.users.create(\n          \"CN=#{Facter.value(:nodetype)},OU=Mike\",\n          roles: [ Mongo::Auth::Roles::READ_WRITE_ANY_DATABASE ]\n          )\n</code></pre>\n\n<p>When I catch the exception I get this...</p>\n\n<blockquote>\n  <p>\"pwd\" had the wrong type. Expected string, found null (14)</p>\n</blockquote>\n\n<p>In the mongodb documentation it states that when using the $external database to insert a user you do not need to specify the password.<br>\n<a href=\"https://docs.mongodb.com/manual/tutorial/create-users/\" rel=\"nofollow noreferrer\">https://docs.mongodb.com/manual/tutorial/create-users/</a></p>\n\n<p>I can accomplish this (adding user w/out pwd) using the mongo shell, but it seems the Ruby driver's Mongo::Database class method does not allow empty password fields.  Is there a different way to add a user in the Ruby driver for MongoDB that allows for nil password entries?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 1, "creation_date": 1576604484, "post_id": 59378525, "comment_id": 104950932, "body": "Rubygems is the gem&#39;s manager so it makes sense it&#39;s not inside the gems folder."}], "answers": [{"tags": [], "owner": {"reputation": 220, "user_id": 1681709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gq5zF.jpg?s=128&g=1", "display_name": "Jason Brodie", "link": "https://stackoverflow.com/users/1681709/jason-brodie"}, "is_accepted": false, "score": 0, "last_activity_date": 1576611806, "creation_date": 1576611806, "answer_id": 59381080, "question_id": 59378525, "link": "https://stackoverflow.com/questions/59378525/should-rails-be-using-gems-from-different-paths/59381080#59381080", "title": "Should rails be using gems from different paths?", "body": "<p>Ruby 2.4.0 is know for seg faults.\n2.6.5 is the current released version, I would highly recommend you work from this version.  I have found this fixes many of these random seg faults.</p>\n"}], "owner": {"reputation": 725, "user_id": 9774506, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Falko", "link": "https://stackoverflow.com/users/9774506/falko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576611806, "creation_date": 1576600677, "question_id": 59378525, "link": "https://stackoverflow.com/questions/59378525/should-rails-be-using-gems-from-different-paths", "title": "Should rails be using gems from different paths?", "body": "<p>Am currently getting a seg fault error when in rails console and trying to access active record.</p>\n\n<p>Thing.first would cause a seg fault with the below at the top of the backtrace.</p>\n\n<p>I am wondering if it has something to do with the gem paths, the top 2 paths in the trace below are different. Should they be using <code>/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems</code>?</p>\n\n<p>Here is the top of the backtrace:</p>\n\n<pre><code>-e:1:in `&lt;main&gt;'\n/Users/paul/.rbenv/versions/2.4.1/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n/Users/paul/.rbenv/versions/2.4.1/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n/Users/paul/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/spring-2.0.2/lib/spring/application/boot.rb:19:in `&lt;top (required)&gt;'\n/Users/paul/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/spring-2.0.2/lib/spring/application.rb:135:in `run'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "csv", "activerecord"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1576592210, "post_id": 59376081, "comment_id": 104944598, "body": "What is your question?"}, {"owner": {"reputation": 45, "user_id": 11257437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72fc62a294ee50e63b2eb374d2bfefb8?s=128&d=identicon&r=PG&f=1", "display_name": "codevb", "link": "https://stackoverflow.com/users/11257437/codevb"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1576592764, "post_id": 59376081, "comment_id": 104944888, "body": "when i click export does not open a dialog to download from csv am i missing something?"}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1576593040, "post_id": 59376081, "comment_id": 104945042, "body": "After clicking on the link go to your web server console and copy the request and response info. Add it to your question, don&#39;t paste it in the comments."}, {"owner": {"reputation": 45, "user_id": 11257437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72fc62a294ee50e63b2eb374d2bfefb8?s=128&d=identicon&r=PG&f=1", "display_name": "codevb", "link": "https://stackoverflow.com/users/11257437/codevb"}, "reply_to_user": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1576593658, "post_id": 59376081, "comment_id": 104945376, "body": "@Beartech updated post dialog is not open to save csv file.."}, {"owner": {"reputation": 45, "user_id": 11257437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72fc62a294ee50e63b2eb374d2bfefb8?s=128&d=identicon&r=PG&f=1", "display_name": "codevb", "link": "https://stackoverflow.com/users/11257437/codevb"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1576593687, "post_id": 59376081, "comment_id": 104945397, "body": "@mrzasa updated post see"}], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 4, "last_activity_date": 1576596467, "creation_date": 1576596467, "answer_id": 59377361, "question_id": 59376081, "link": "https://stackoverflow.com/questions/59376081/export-data-to-file-csv-on-ruby-rails/59377361#59377361", "title": "Export data to file CSV on Ruby Rails", "body": "<p>You need to generate the URL for the link in a different way - using URL helper, not controller/action params:</p>\n\n<pre><code>&lt;%= link_to( 'Export CSV', companies_export_csv_path(format: \"csv\", { :class =&gt; \"btn-ex\" } ) %&gt;\n</code></pre>\n\n<p>See also: <a href=\"https://stackoverflow.com/questions/16043702/rails-link-to-format-xlsx-not-generating-link-to-xlsx-path\">Rails link_to :format =&gt; :xlsx not generating link to .xlsx path</a></p>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 11257437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72fc62a294ee50e63b2eb374d2bfefb8?s=128&d=identicon&r=PG&f=1", "display_name": "codevb", "link": "https://stackoverflow.com/users/11257437/codevb"}, "is_accepted": false, "score": 0, "last_activity_date": 1578937749, "creation_date": 1578937749, "answer_id": 59721588, "question_id": 59376081, "link": "https://stackoverflow.com/questions/59376081/export-data-to-file-csv-on-ruby-rails/59721588#59721588", "title": "Export data to file CSV on Ruby Rails", "body": "<pre><code>&lt;%= link_to( 'Export' ,{ :controller =&gt; :company, :action =&gt; :export_csv, format: 'csv', :company_id =&gt; @company.id}, { :class =&gt; \"btn-edit\" } ) %&gt;\n</code></pre>\n\n<p>Thanks Guys, workperfectly.</p>\n"}], "owner": {"reputation": 45, "user_id": 11257437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72fc62a294ee50e63b2eb374d2bfefb8?s=128&d=identicon&r=PG&f=1", "display_name": "codevb", "link": "https://stackoverflow.com/users/11257437/codevb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3187, "favorite_count": 0, "accepted_answer_id": 59377361, "answer_count": 2, "score": 2, "last_activity_date": 1578937749, "creation_date": 1576591935, "last_edit_date": 1576596484, "question_id": 59376081, "link": "https://stackoverflow.com/questions/59376081/export-data-to-file-csv-on-ruby-rails", "title": "Export data to file CSV on Ruby Rails", "body": "<p>I'm trying export data using active record and csv class, but I dont have the file generated can help see me code.</p>\n\n<p>when i click export does not open a dialog to download from csv am i missing something?</p>\n\n<p><strong>My Controller</strong></p>\n\n<pre><code>def export_csv\n    @contact = Contacts.find_by_sql(\"select * from contacts_list limit 10\")\n     respond_to do |format|\n       format.html\n       format.csv { send_data @contact.as_csv }\n     end\n  end\n</code></pre>\n\n<p><strong>My Model</strong></p>\n\n<pre><code>def self.to_csv\n    attributes = %w{id name mail}\n\n    CSV.generate(headers: true) do |csv|\n      csv &lt;&lt; attributes\n\n      all.each do |contact|\n        csv &lt;&lt; attributes.map{ |attr| contact.send(attr) }\n      end\n    end\n  end\n</code></pre>\n\n<p><strong>My View</strong></p>\n\n<pre><code>&lt;%= link_to( 'Export CSV' ,{ :controller =&gt; :company, :action =&gt; :export_csv, format: \"csv\"}, { :class =&gt; \"btn-ex\" } ) %&gt;\n</code></pre>\n\n<p><strong>Console Ouput</strong></p>\n\n<pre><code>Started GET \"/company/export_cs\" for 127.0.0.1 at 2019-12-17 11:31:26 -0200\nProcessing by CompanyController#export_cs as HTML\n</code></pre>\n\n<p>only this nothing more no errors no messages warnings.</p>\n"}, {"tags": ["ruby", "rspec", "factory-bot"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1576598339, "post_id": 59375930, "comment_id": 104947961, "body": "<i>&quot;if I could simply build up a list of updates that are needed&quot;</i> -- Have you considered using a <code>transient</code> attribute, for precisely this purpose? You could then define a single <code>after(:create)</code> block on the factory, which adds all of these associations based on the transient attribute&#39;s value. See: <a href=\"https://github.com/thoughtbot/factory_bot/blob/master/GETTING_STARTED.md#transient-attributes\" rel=\"nofollow noreferrer\">github.com/thoughtbot/factory_bot/blob/master/&hellip;</a>"}, {"owner": {"reputation": 341, "user_id": 4147091, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/71cac5adc663078d21aa1bba0f4adbc8?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Snare", "link": "https://stackoverflow.com/users/4147091/mike-snare"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1576610240, "post_id": 59375930, "comment_id": 104953393, "body": "I don&#39;t think that will work since I don&#39;t see how that gives me a single hook where all of the associations have been created such that I could do <code>main_model.update(a_id: a.id, b_id: b.id, c_id: c.id, d_id: d.id)</code>.  Traits do allow for transient attributes, but I&#39;d still need an <code>after(:create)</code> block per trait and that&#39;s what I&#39;m trying to avoid."}, {"owner": {"reputation": 341, "user_id": 4147091, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/71cac5adc663078d21aa1bba0f4adbc8?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Snare", "link": "https://stackoverflow.com/users/4147091/mike-snare"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1576610481, "post_id": 59375930, "comment_id": 104953497, "body": "Ok, I think the suggestion is actually to have all these registered as transient attributes on the <code>main_model</code> factory, and I could do that, I suppose, but then rather than be able to use this syntax <code>create(:main_model, :with_a, :with_b, ...)</code> I&#39;d have to switch to this (providing a boolean value or something): <code>create(:main_model, with_a: true, with_b: true, ...)</code>.  Not horrible... for sure.  But not ideal, either.  Just muddies the syntax of traits a bit.  However, I do think that might achieve the goal."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1576662626, "post_id": 59375930, "comment_id": 104969047, "body": "Hang on, let me just sketch out what I had in mind as a proper answer below... It&#39;s a bit of a weird kludge, admittedly - but then this would normally be done in a much simpler way with <code>associations</code>, which you&#39;ve explicitly stated cant&#39;t be used! (I&#39;m not sure why that&#39;s the case, but no matter...)"}], "answers": [{"comments": [{"owner": {"reputation": 341, "user_id": 4147091, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/71cac5adc663078d21aa1bba0f4adbc8?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Snare", "link": "https://stackoverflow.com/users/4147091/mike-snare"}, "edited": false, "score": 0, "creation_date": 1576704884, "post_id": 59390582, "comment_id": 104989653, "body": "Thanks, but I think this is the original chicken and egg issue .  At the time the trait blocks are running, if it&#39;s before the <code>after(:create)</code> of the main model, I don&#39;t have an id for the main model, so I can&#39;t set it on the associated models.  If it&#39;s after the <code>after(:create)</code> of the main model, then it&#39;s too late and the main model won&#39;t be updated with the ids of the associated models."}, {"owner": {"reputation": 341, "user_id": 4147091, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/71cac5adc663078d21aa1bba0f4adbc8?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Snare", "link": "https://stackoverflow.com/users/4147091/mike-snare"}, "edited": false, "score": 0, "creation_date": 1576759873, "post_id": 59390582, "comment_id": 105007332, "body": "The chicken and egg thing doesn&#39;t even come into play, unfortunately.  The traits can&#39;t access the associations hash of the parent."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 0, "last_activity_date": 1576666829, "creation_date": 1576666829, "answer_id": 59390582, "question_id": 59375930, "link": "https://stackoverflow.com/questions/59375930/how-to-achieve-update-batching-in-factorybot-for-traits/59390582#59390582", "title": "How to achieve update &quot;batching&quot; in factorybot for traits", "body": "<p>You could define a transient variable (I used <code>associations</code>, but call it whatever) - and use this to store all of the associated record IDs for a <strong>single</strong> record update in an <code>after(:create)</code> block.</p>\n\n<p>Something like this:</p>\n\n<pre><code>FactoryBot.define do\n  factory :main_model do\n\n    transient do\n      associations { {} }\n    end\n\n    trait :with_a do\n      associations { super.merge(a_id: create(:a, main_model_id: id).id) }\n    end\n\n    trait :with_a do\n      associations { super.merge(b_id: create(:b, main_model_id: id).id) }\n    end\n\n    after(:create) do |main_model|\n      main_model.update(associations)\n    end\n  end\nend\n</code></pre>\n\n<p>Usage of the factory remains unchanged - e.g.</p>\n\n<pre><code>create(:main_model, :with_a, :with_b)\n</code></pre>\n\n<p>...So you shouldn't need to update any of the spec code.</p>\n"}], "owner": {"reputation": 341, "user_id": 4147091, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/71cac5adc663078d21aa1bba0f4adbc8?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Snare", "link": "https://stackoverflow.com/users/4147091/mike-snare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 268, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576666829, "creation_date": 1576591416, "question_id": 59375930, "link": "https://stackoverflow.com/questions/59375930/how-to-achieve-update-batching-in-factorybot-for-traits", "title": "How to achieve update &quot;batching&quot; in factorybot for traits", "body": "<p>Say you have a Factory in FactoryBot, and say that factory has several traits for associations, and that each trait will need to update the model being created by the factory.  So, your main model is MainModel, and you have associations to A, B, C, D, etc...</p>\n\n<pre><code>FactoryBot.define do\n  factory :main_model\n\n  trait :with_a do\n    after(:create) do |main_model|\n      # Both sides refer to each other, so this must be done in after(:create).\n      main_model.update(a_id: create(:a, main_model_id: main_model.id).id)\n    end\n  end\n\n  trait :with_b do\n    after(:create) do |main_model|\n      # Both sides refer to each other, so this must be done in after(:create).\n      main_model.update(b_id: create(:b, main_model_id: main_model.id).id)\n    end\n  end\n\n  # More traits omitted...\nend\n</code></pre>\n\n<p>Side note: We're not using ActiveRecord, so we cannot use the associations features built into FactoryBot.  Associations must be explicitly registered using a call to update on both sides of the association.  Even if I could, I'm not sure it would have any effect?</p>\n\n<p>Now, if client code does the following:</p>\n\n<p><code>create(:main_model, :with_a, :with_b, :with_c, :with_d)</code></p>\n\n<p>This is going to result in the following writes to the db:</p>\n\n<ol>\n<li>Create the main record</li>\n<li>Create the A record that points to the main.</li>\n<li><strong>Update the main record to point to the new A.</strong></li>\n<li>Create the B record that points to the main.</li>\n<li><strong>Update the main record to point to the new B.</strong></li>\n<li>Create the C record that points to the main.</li>\n<li><strong>Update the main record to point to the new C.</strong></li>\n<li>Create the D record that points to the main.</li>\n<li><strong>Update the main record to point to the new D.</strong></li>\n</ol>\n\n<p>Of the above, Numbers 3, 5, 7, and 9 could all be done at the same time, at the very end, if I could simply build up a list of updates that are needed and find a \"hook\" that would allow me to do one more update after the final trait was applied, and factory bot was ready to return the final result to me.  I cannot figure out a way to do that, but the ability to do this would save thousands (probably tens of thousands) of DB writes across my spec suite.</p>\n\n<p>Anyone have any ideas?</p>\n"}, {"tags": ["javascript", "ruby", "cron", "ruby-on-rails-5", "task"], "comments": [{"owner": {"reputation": 10662, "user_id": 1959054, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fdf89c4b3b6f44a6b324e670fb9461aa?s=128&d=identicon&r=PG", "display_name": "TKoL", "link": "https://stackoverflow.com/users/1959054/tkol"}, "edited": false, "score": 0, "creation_date": 1576591301, "post_id": 59375874, "comment_id": 104944024, "body": "You want Ruby to run a Javascript file through node.js or something?"}, {"owner": {"reputation": 157, "user_id": 9322828, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215722452876336/picture?type=large", "display_name": "Damien Comp&#232;re", "link": "https://stackoverflow.com/users/9322828/damien-comp%c3%a8re"}, "reply_to_user": {"reputation": 10662, "user_id": 1959054, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fdf89c4b3b6f44a6b324e670fb9461aa?s=128&d=identicon&r=PG", "display_name": "TKoL", "link": "https://stackoverflow.com/users/1959054/tkol"}, "edited": false, "score": 0, "creation_date": 1576591462, "post_id": 59375874, "comment_id": 104944110, "body": "no specially with node.js just that the script act like a task in Ruby"}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1576593308, "post_id": 59375874, "comment_id": 104945194, "body": "You could build an AJAX &quot;task&quot; but it would only be able to do what ever you can do through a browser request. If that works then you could create the AJAX and then trigger it using curl through rake? Maybe?"}, {"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 1, "creation_date": 1576597480, "post_id": 59375874, "comment_id": 104947496, "body": "There is one question that is always above all questions: WHY?"}, {"owner": {"reputation": 157, "user_id": 9322828, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215722452876336/picture?type=large", "display_name": "Damien Comp&#232;re", "link": "https://stackoverflow.com/users/9322828/damien-comp%c3%a8re"}, "edited": false, "score": 0, "creation_date": 1576598599, "post_id": 59375874, "comment_id": 104948104, "body": "Because I need to use an API to download some informations."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1576611755, "post_id": 59375874, "comment_id": 104954072, "body": "What kind of API? Is it only available to Javascript? What is the purpose of the task? Does it update data on the server? I assume it&#39;s only to be run occasionally by you, the developer? But, no, you can&#39;t insert javascript into a Rake file. Maybe have a look at <a href=\"https://stackoverflow.com/questions/12659778/is-it-possible-to-run-javascript-files-from-the-command-line\">How to run Javascript files from the command line</a>"}, {"owner": {"reputation": 157, "user_id": 9322828, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215722452876336/picture?type=large", "display_name": "Damien Comp&#232;re", "link": "https://stackoverflow.com/users/9322828/damien-comp%c3%a8re"}, "edited": false, "score": 0, "creation_date": 1576659753, "post_id": 59375874, "comment_id": 104967599, "body": "The purpose of my task is to grab documents related to some account to send them to my user, it doesn&#39;t update any data on my server as I pass throught the API to get the documents. It&#39;s supposed to run everyday, well maybe I could use HTTParty to make some call, would it be better ?"}], "owner": {"reputation": 157, "user_id": 9322828, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215722452876336/picture?type=large", "display_name": "Damien Comp&#232;re", "link": "https://stackoverflow.com/users/9322828/damien-comp%c3%a8re"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577347769, "creation_date": 1576591234, "last_edit_date": 1577347769, "question_id": 59375874, "link": "https://stackoverflow.com/questions/59375874/how-to-create-a-task-in-javascript-in-ruby-on-rails-project", "title": "How to create a task in Javascript in Ruby on rails project", "body": "<p>I would like to create a Javascript file in my RoR project that act like a tasks. \nI know that for a Ruby file, you write your code in <code>lib/tasks/my_task.rake</code> and run your task by typing <code>rake:name_of_the_task</code> in your console. </p>\n\n<p>I would like to do the same process but in Javascript, is anyone having a tutorial or could explain me how it works ? Can I insert javascript in my rake file ? </p>\n\n<p>Thanks ! </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "routing"], "answers": [{"comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 1, "creation_date": 1576593957, "post_id": 59376094, "comment_id": 104945568, "body": "You might want to comment on eager loading to avoid an N+1 problem."}], "tags": [], "owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "is_accepted": true, "score": 1, "last_activity_date": 1576596668, "last_edit_date": 1576596668, "creation_date": 1576591978, "answer_id": 59376094, "question_id": 59375745, "link": "https://stackoverflow.com/questions/59375745/how-to-show-has-many-component-in-ruby-on-rails/59376094#59376094", "title": "How to show has_many component in Ruby on Rails", "body": "<p>The problem is you're trying to access a Reciept attribute by calling it on the collection. Your controller should look like</p>\n\n<pre><code>def show\n    @policy = Policy.find(params[:id])\nend\n</code></pre>\n\n<p>And then in your view where you want to see receipt_days on each receipt you can iterate through the collection</p>\n\n<pre><code>&lt;h1&gt;details of policyid: &lt;%= @policy.id %&gt;&lt;/h1&gt;\n&lt;% @policy.receipts.each do |receipt| %&gt;\n  &lt;p&gt;&lt;%= receipt.receipt_day %&gt;&lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>As @jvillian stated about N+1. If you're going to access any of the relationships on the receipt model you could eager load which ever ones you need to reduce hits to the db.</p>\n\n<p>It'd change the controller/view like:</p>\n\n<pre><code>def show\n    @policy = Policy.find(params[:id])\n    @receipts = @policy.receipts.includes(:outpatients,...) #include any relationship that you're going to access in the view\nend\n\n</code></pre>\n\n<pre><code>&lt;h1&gt;details of policyid: &lt;%= @policy.id %&gt;&lt;/h1&gt;\n&lt;% @receipts.each do |receipt| %&gt;\n  &lt;p&gt;&lt;%= receipt.receipt_day %&gt;&lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 2789, "user_id": 6724844, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh3.googleusercontent.com/-yH5Kk4-N2ng/AAAAAAAAAAI/AAAAAAAABM4/ri9dM8iEE94/photo.jpg?sz=128", "display_name": "Heisenberg", "link": "https://stackoverflow.com/users/6724844/heisenberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 59376094, "answer_count": 1, "score": -1, "last_activity_date": 1576596668, "creation_date": 1576590770, "question_id": 59375745, "link": "https://stackoverflow.com/questions/59375745/how-to-show-has-many-component-in-ruby-on-rails", "title": "How to show has_many component in Ruby on Rails", "body": "<p>my show.html.erb file is like below.</p>\n\n<pre><code>&lt;h1&gt;details of policyid: &lt;%= @policies.id %&gt;&lt;/h1&gt;\n\n&lt;p&gt;&lt;%= @policies.receipts.receipt_day %&gt;&lt;/p&gt;\n</code></pre>\n\n<p>my controller is like below.</p>\n\n<pre><code>def show\n    @policies=Policy.find(params[:id])\nend\n</code></pre>\n\n<p>Model is like below</p>\n\n<pre><code>class Policy &lt; ApplicationRecord\n    has_many :receipts\nend\n</code></pre>\n\n<pre><code>class Receipt &lt; ApplicationRecord\n  belongs_to :policy\n  has_many :outpatients\n  has_many :hospitalizations\n  has_many :surgeries\n  has_many :others\nend\n</code></pre>\n\n<p>Receipt Model has some record like this.</p>\n\n<pre><code>2.6.3 :005 &gt; Receipt.all\n  Receipt Load (0.3ms)  SELECT `receipts`.* FROM `receipts`\n =&gt; #&lt;ActiveRecord::Relation [#&lt;Receipt id: 1, receipt_day: \"2019-11-01\", policy_id: 1, created_at: \"2019-11-20 08:21:21\", updated_at: \"2019-11-20 08:21:21\"&gt;]&gt; \n</code></pre>\n\n<p>I would like to show receipt_day in policy show file. is this possible?<br>\nI suffered some errors like below.\nIf someone has experienced the same issue,please let me know.</p>\n\n<pre><code>NoMethodError in Policies#show\nShowing /home/ec2-user/environment/calendar_test/app/views/policies/show.html.erb where line #3 raised:\nundefined method `receipt_day' for #&lt;Receipt::ActiveRecord_Associations_CollectionProxy:0x00007f67fc0664e8&gt;\n</code></pre>\n"}, {"tags": ["ruby", "hash", "activesupport"], "answers": [{"comments": [{"owner": {"reputation": 11312, "user_id": 377920, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d5d06662b6d5701f9633e83761ab5ac3?s=128&d=identicon&r=PG", "display_name": "randomguy", "link": "https://stackoverflow.com/users/377920/randomguy"}, "edited": false, "score": 0, "creation_date": 1576601897, "post_id": 59378530, "comment_id": 104949753, "body": "I think you almost got it. This falls short with array values tho, right? For example <code>{ foo: [&#39;1&#39;] }</code> or <code>{ foo: [ { bar: &quot;1&quot;} ] }</code> doesn&#39;t get transformed."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 11312, "user_id": 377920, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d5d06662b6d5701f9633e83761ab5ac3?s=128&d=identicon&r=PG", "display_name": "randomguy", "link": "https://stackoverflow.com/users/377920/randomguy"}, "edited": false, "score": 0, "creation_date": 1576602379, "post_id": 59378530, "comment_id": 104949988, "body": "@randomguy <code>transform_values</code> is not going to handle that either nor does your transformation code. You will need to handle <code>Array</code> objects as they are not <code>Hash</code>es and thus not &quot;mergeable&quot;. The answer solves your question and transforming the Array objects should be fairly trivial"}, {"owner": {"reputation": 11312, "user_id": 377920, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d5d06662b6d5701f9633e83761ab5ac3?s=128&d=identicon&r=PG", "display_name": "randomguy", "link": "https://stackoverflow.com/users/377920/randomguy"}, "edited": false, "score": 0, "creation_date": 1576602766, "post_id": 59378530, "comment_id": 104950171, "body": "Not true. <code>deep_transform_values</code> does handle arrays <a href=\"https://github.com/rails/rails/blob/master/activesupport/lib/active_support/core_ext/hash/deep_transform_values.rb#L29-L30\" rel=\"nofollow noreferrer\">github.com/rails/rails/blob/master/activesupport/lib/&hellip;</a>. See for example <a href=\"https://gist.github.com/alexhanh/f1b9088855f983c14e315d284e8cf2b8\" rel=\"nofollow noreferrer\">gist.github.com/alexhanh/f1b9088855f983c14e315d284e8cf2b8</a>"}, {"owner": {"reputation": 11312, "user_id": 377920, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d5d06662b6d5701f9633e83761ab5ac3?s=128&d=identicon&r=PG", "display_name": "randomguy", "link": "https://stackoverflow.com/users/377920/randomguy"}, "edited": false, "score": 0, "creation_date": 1576604072, "post_id": 59378530, "comment_id": 104950756, "body": "Tried this, but didn&#39;t work <a href=\"https://gist.github.com/alexhanh/ef91923ada4c8ce53822b41232ece0ff\" rel=\"nofollow noreferrer\">gist.github.com/alexhanh/ef91923ada4c8ce53822b41232ece0ff</a>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 11312, "user_id": 377920, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d5d06662b6d5701f9633e83761ab5ac3?s=128&d=identicon&r=PG", "display_name": "randomguy", "link": "https://stackoverflow.com/users/377920/randomguy"}, "edited": false, "score": 0, "creation_date": 1576607587, "post_id": 59378530, "comment_id": 104952349, "body": "@randomguy updated to use a lambda and a Proc to handle the recursion"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 2, "last_activity_date": 1576607560, "last_edit_date": 1576607560, "creation_date": 1576600699, "answer_id": 59378530, "question_id": 59375477, "link": "https://stackoverflow.com/questions/59375477/how-to-deep-transform-values-with-keys-in-ruby/59378530#59378530", "title": "How to deep_transform_values with keys in Ruby?", "body": "<p>You could use <a href=\"https://apidock.com/rails/v5.2.3/Hash/deep_merge%21\" rel=\"nofollow noreferrer\"><code>Hash#deep_merge!</code></a> (provided by <code>ActiveSupport</code>) like so: </p>\n\n<pre><code>keys_not_to_transform = ['id', 'count']\n\ntransform_value = lambda do |value|\n    s = value.to_s\n    if s.present? &amp;&amp; /\\A[+-]?\\d+(\\.\\d+)?\\z/.match?(s)\n      BigDecimal(s)\n    else\n      value\n    end\nend\n\ntransform = Proc.new do |key,value|\n  if keys_not_to_transform.include? key.to_s\n    value\n  elsif value.is_a?(Array)\n    value.map! do |v| \n      v.is_a?(Hash) ? v.deep_merge!(v,&amp;transform) : transform_value.(v)\n    end \n  else   \n    transform_value.(value)\n  end  \nend\n\nresponse = { result: 'ok', errors: [], data: { id: '123', price: '100.0', quotes: ['1.0', '2.0'], other: [{id: '124', price: '17.0'}] }, count: 10 }\n\nresponse.deep_merge!(response, &amp;transform)\n</code></pre>\n\n<p>This outputs: </p>\n\n<pre><code>#=&gt;{:result=&gt;\"ok\", :errors=&gt;[], :data=&gt;{:id=&gt;\"123\", :price=&gt;0.1e3, :quotes=&gt;[0.1e1, 0.2e1], :other=&gt;[{:id=&gt;\"124\", :price=&gt;0.17e2}]}, :count=&gt;10}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1576634522, "post_id": 59381358, "comment_id": 104960692, "body": "Nice however the dependencies already exist based on this being rails. Also should move the ignore keys to the top if so you don&#39;t traverse Hash unnecessarily. Finally this still does not handle Array which was updated into the original question"}, {"owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1576659239, "post_id": 59381358, "comment_id": 104967366, "body": "@engineersmnky good catch about the redundant hash traversal. And yes, I&#39;ve missed the fact the initial question has changed a bit..."}], "tags": [], "owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "is_accepted": false, "score": 1, "last_activity_date": 1576613117, "creation_date": 1576613117, "answer_id": 59381358, "question_id": 59375477, "link": "https://stackoverflow.com/questions/59375477/how-to-deep-transform-values-with-keys-in-ruby/59381358#59381358", "title": "How to deep_transform_values with keys in Ruby?", "body": "<p>I'd just implement the necessary transformation logic with plain old Ruby and a bit of recursion, no external dependencies needed. For example:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def transform(hash, ignore_keys: [])\n  hash.each_with_object({}) do |(key, value), result|\n    if value.is_a?(Hash)\n      result[key] = transform(value, ignore_keys: ignore_keys)\n    elsif ignore_keys.include?(key.to_s)\n      result[key] = value\n    elsif value.to_s =~ /\\A[+-]?\\d+(\\.\\d+)?\\z/\n      result[key] = BigDecimal(value)\n    else\n      result[key] = value\n    end\n  end\nend\n\nkeys_not_to_transform = %w[id count]\nresponse = { result: 'ok', errors: [], data: { id: '123', price: '100.0' }, count: 10 }\n\ntransform(response, ignore_keys: keys_not_to_transform)\n# =&gt; {:result=&gt;\"ok\", :errors=&gt;[], :data=&gt;{:id=&gt;\"123\", :price=&gt;#&lt;BigDecimal:5566613bb128,'0.1E3',9(18)&gt;}, :count=&gt;10}\n</code></pre>\n"}], "owner": {"reputation": 11312, "user_id": 377920, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d5d06662b6d5701f9633e83761ab5ac3?s=128&d=identicon&r=PG", "display_name": "randomguy", "link": "https://stackoverflow.com/users/377920/randomguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 584, "favorite_count": 0, "accepted_answer_id": 59378530, "answer_count": 2, "score": 2, "last_activity_date": 1576613117, "creation_date": 1576589866, "last_edit_date": 1576603054, "question_id": 59375477, "link": "https://stackoverflow.com/questions/59375477/how-to-deep-transform-values-with-keys-in-ruby", "title": "How to deep_transform_values with keys in Ruby?", "body": "<p>Active Support's <code>deep_transform_values</code> recursively transforms all values of a hash. However, is there a similar method that would allow to access the keys of values while transforming?</p>\n\n<p>I'd like to be able to do the following:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>keys_not_to_transform = ['id', 'count']\n\nresponse = { result: 'ok', errors: [], data: { id: '123', price: '100.0', quotes: ['1.0', '2.0'] }, count: 10 }\nresponse.deep_transform_values! do |key, value|\n  # Use value's key to help decide what to do\n  return value if keys_not_to_transform.any? key.to_s\n\n  s = value.to_s\n  if s.present? &amp;&amp; /\\A[+-]?\\d+(\\.\\d+)?\\z/.match?(s)\n    return BigDecimal(s)\n  else\n    value\n  end\nend\n\n#Expected result \n# =&gt;{:result=&gt;\"ok\", :errors=&gt;[], :data=&gt;{:id=&gt;\"123\", :price=&gt;0.1e3, :quotes=&gt;[0.1e1, 0.2e1]}, :count=&gt;10}\n</code></pre>\n\n<p>Note that we are not interested in transforming the key itself, just having it on hand while transforming the corresponding values.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "netldap"], "owner": {"reputation": 396, "user_id": 751756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28a292b3b588b0818326d839e499cdf4?s=128&d=identicon&r=PG", "display_name": "Sukeerthi Adiga", "link": "https://stackoverflow.com/users/751756/sukeerthi-adiga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1576589448, "creation_date": 1576589448, "question_id": 59375345, "link": "https://stackoverflow.com/questions/59375345/unable-to-connect-when-ldap-channel-binding-is-enabled", "title": "Unable to connect when LDAP Channel Binding is enabled", "body": "<p>Trying to connect to AD by enforcing the LDAP Channel Binding <a href=\"https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/ADV190023\" rel=\"nofollow noreferrer\">https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/ADV190023</a></p>\n\n<p>Ending up with the below error</p>\n\n<pre><code>=&gt; #&lt;Net::LDAP::PDU:0x0000000013568ea8\n  @app_tag=1,\n  @ldap_controls=[],\n  @ldap_result=\n      {:resultCode=&gt;49,\n       :matchedDN=&gt;\"\",\n       :errorMessage=&gt;\"80090346: LdapErr: DSID-0C09056D, comment: AcceptSecurityContext error, data 80090346, v2580\\u0000\"},\n  @message_id=1&gt;\n</code></pre>\n\n<p>Does anyone know is there a way how to connect by enabling the channel binding?</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 1, "last_activity_date": 1576590579, "creation_date": 1576590579, "answer_id": 59375688, "question_id": 59375311, "link": "https://stackoverflow.com/questions/59375311/wrong-number-of-arguments-given-0-expected-1-argumenterror-with-expect-in-r/59375688#59375688", "title": "wrong number of arguments (given 0, expected 1) (ArgumentError) with Expect in Ruby", "body": "<p>Your <code>retrieve</code> method takes exactly one param - <code>id</code>. In </p>\n\n<pre><code>expect(@create_user.retrieve.code).to eq (200)\n</code></pre>\n\n<p>you use <code>retrieve</code> without any params, hence the error. Add <code>id</code> to the <code>retrieve</code> call and it should be OK.</p>\n\n<pre><code>expect(@create_user.retrieve(@id).code).to eq (200)\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 11725210, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fxH8FZjYKsw/AAAAAAAAAAI/AAAAAAAAAAc/b4Ab0FDFZPY/photo.jpg?sz=128", "display_name": "Rebeka Montana", "link": "https://stackoverflow.com/users/11725210/rebeka-montana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 59375688, "answer_count": 1, "score": 2, "last_activity_date": 1587201499, "creation_date": 1576589354, "last_edit_date": 1587201499, "question_id": 59375311, "link": "https://stackoverflow.com/questions/59375311/wrong-number-of-arguments-given-0-expected-1-argumenterror-with-expect-in-r", "title": "wrong number of arguments (given 0, expected 1) (ArgumentError) with Expect in Ruby", "body": "<p>I'm not getting expect on retrieve method. When I use <code>expect(@create_user.retrieve.code).to eq (200)</code>. The following error is displayed:</p>\n\n<blockquote>\n  <p>wrong number of arguments (given 0, expected 1) (ArgumentError)\n        ./features/pages/Empregados.rb:26:in `retrieve'</p>\n</blockquote>\n\n<pre><code> def retrieve(id)\n  self.class.get(\"/employee/#{ id }\")\nend \n\n    $response = @create_user.create\n      expect(@create_user.create.code).to eq (200)\n      puts $response.body\n      @id = JSON.parse($response)['id']\n      puts @create_user.retrieve(@id)\n      expect(@create_user.retrieve.code).to eq (200)\n][1]\n</code></pre>\n"}, {"tags": ["ruby", "authentication", "coinbase-api"], "comments": [{"owner": {"reputation": 188, "user_id": 787436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdbd1ea1cbcc38582b3f655426541ce8?s=128&d=identicon&r=PG", "display_name": "andoke", "link": "https://stackoverflow.com/users/787436/andoke"}, "edited": false, "score": 0, "creation_date": 1576587357, "post_id": 59374422, "comment_id": 104941744, "body": "Please attach your code."}, {"owner": {"reputation": 493, "user_id": 5068445, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/vRVZ7.jpg?s=128&g=1", "display_name": "Anuj Dhanju", "link": "https://stackoverflow.com/users/5068445/anuj-dhanju"}, "reply_to_user": {"reputation": 188, "user_id": 787436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdbd1ea1cbcc38582b3f655426541ce8?s=128&d=identicon&r=PG", "display_name": "andoke", "link": "https://stackoverflow.com/users/787436/andoke"}, "edited": false, "score": 0, "creation_date": 1576588695, "post_id": 59374422, "comment_id": 104942461, "body": "I have updated code. Thanks :)"}], "answers": [{"tags": [], "owner": {"reputation": 1331, "user_id": 4189633, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VG5Vp.jpg?s=128&g=1", "display_name": "Vishal G", "link": "https://stackoverflow.com/users/4189633/vishal-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1577167015, "creation_date": 1577167015, "answer_id": 59464429, "question_id": 59374422, "link": "https://stackoverflow.com/questions/59374422/coinbase-pro-api-invalid-signature-ruby/59464429#59464429", "title": "Coinbase Pro API &quot;invalid signature&quot; RUBY", "body": "<p>I have worked on your code debugging why it is not working, looks like there is header issue when we use Net::HTTP. I have used http wrapper to call API and it worked </p>\n\n<pre><code>module Coinbase\n  class ApiError &lt; RuntimeError; end\n  class Api\n\n    def initialize()\n      @end_point = 'https://api-public.sandbox.pro.coinbase.com'\n      @key = \"b34ae4ffd38acfc3f11e272654fa77c4\"\n      @secret = \"0k+YreiCq5tY3UdShw0VB0RI/kKiLv1vNGpNKpaDzDLtVPFNzlMGgoFljYRO4qsH5KCZ9M5upnq5/rxSVzENdg==\"\n      @passphrase = \"50fyu9n04nu\"\n      @timestamp = Time.now.to_i\n    end\n\n    def access_signature method, request_path, body\n      body = body.to_json if body.is_a?(Hash)\n      what = \"#{@timestamp}#{method}#{request_path}#{body}\";\n      # create a sha256 hmac with the secret\n      secret = Base64.decode64(@secret)\n      hash  = OpenSSL::HMAC.digest('sha256', secret, what)\n      Base64.strict_encode64(hash)\n    end\n\n    def hit_coinbase_api\n       call \"GET\",  \"/accounts\"\n    end\n\n    private\n\n    def call(method, request_path, params = nil)\n      @sign = access_signature(method, request_path, params)\n      @headers = {\n        \"Content-Type\" =&gt; \"application/json\",\n        \"Accept\" =&gt; \"application/json\",\n        \"CB-ACCESS-KEY\" =&gt; @key,\n        \"CB-ACCESS-SIGN\" =&gt; @sign,\n        \"CB-ACCESS-TIMESTAMP\" =&gt; @timestamp,\n        \"CB-ACCESS-PASSPHRASE\" =&gt; @passphrase,\n        \"User-Agent\"=&gt; 'request'\n      }\n      if method=='GET'\n        response = HTTParty.get(\"#{@end_point}#{request_path}\",\n                { \n                  :headers =&gt; @headers\n                })\n      else \n        response = HTTParty.post(\"#{@end_point}#{request_path}\",\n                { \n                  :body =&gt; params.to_json,\n                  :headers =&gt; @headers\n                })\n      end\n      JSON.parse(response.body)\n    end\n  end\nend\n</code></pre>\n\n<p>Let me know if anyone found why it is not working with Net::HTTP</p>\n"}], "owner": {"reputation": 493, "user_id": 5068445, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/vRVZ7.jpg?s=128&g=1", "display_name": "Anuj Dhanju", "link": "https://stackoverflow.com/users/5068445/anuj-dhanju"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1577167015, "creation_date": 1576586270, "last_edit_date": 1576588656, "question_id": 59374422, "link": "https://stackoverflow.com/questions/59374422/coinbase-pro-api-invalid-signature-ruby", "title": "Coinbase Pro API &quot;invalid signature&quot; RUBY", "body": "<p>I am following Coinbase pro API and API 'invalid signature' error.  I have attached my code. I have also try with production account but error is still same. </p>\n\n<pre><code>  class Coinbase\n    def initialize()\n      @end_point = 'https://api-public.sandbox.pro.coinbase.com'\n      @key = \"b34ae4ffd38acfc3f11e272654fa77c4\"\n      @secret = \"0k+YreiCq5tY3UdShw0VB0RI/kKiLv1vNGpNKpaDzDLtVPFNzlMGgoFljYRO4qsH5KCZ9M5upnq5/rxSVzENdg==\"\n      @passphrase = \"50fyu9n04nu\"\n      @timestamp = Time.now.to_i\n      @sign = access_signature\n    end\n\n    def access_signature\n      request_path=\"/accounts\"\n      method='GET'\n      body=''\n      body = body.to_json if body.is_a?(Hash)\n      timestamp = @timestamp\n      what = \"#{timestamp}#{method}#{request_path}#{body}\";\n      secret = Base64.decode64(@secret)\n      hash  = OpenSSL::HMAC.digest('sha256', secret, what)\n      Base64.strict_encode64(hash)\n    end\n\n    def hit_coinbase_api\n      call :get, \"/accounts\"\n    end\n\n    def call(method, path, params = {}, parse_response_as_json = true, with_auth_token = true)\n      uri = URI(@end_point + path)\n      http = Net::HTTP.new(uri.host, uri.port)\n      http.use_ssl = true\n\n      request = nil\n      if method == :get\n        request = Net::HTTP::Get.new(uri.request_uri)\n      else\n        raise 'Unsupported request method'\n      end\n\n      request.body = params.to_json\n      request.add_field('Content-Type', 'application/json')\n      request.add_field('CB-ACCESS-KEY', @key)\n      request.add_field('CB-ACCESS-SIGN', @sign)\n      request.add_field('CB-ACCESS-TIMESTAMP', @timestamp)\n      request.add_field('CB-ACCESS-PASSPHRASE', @passphrase)\n\n      response = http.request(request)\n      json_resp = JSON.parse(response.body)\n      puts json_resp\n    end\n  end\n</code></pre>\n\n<p>console> <code>Coinbase.new.hit_coinbase_api</code>\nHelp will be appreciable.  Thanks in advance :)</p>\n"}, {"tags": ["python", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1576583642, "post_id": 59373488, "comment_id": 104939913, "body": "What&#39;s the backtrace of your error?"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1576584375, "post_id": 59373488, "comment_id": 104940229, "body": "Have you already tried simple string interpolation? <code>`python script.py #{variable}`</code>"}], "answers": [{"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1576606264, "post_id": 59374186, "comment_id": 104951759, "body": "What happens when <code>@rowarraydisp</code> contains something that the shell will interpret?"}], "tags": [], "owner": {"reputation": 1156, "user_id": 4955546, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3ypcYA0ACXs/AAAAAAAAAAI/AAAAAAAABgY/gcCpBwKBymI/photo.jpg?sz=128", "display_name": "Sikandar Tariq", "link": "https://stackoverflow.com/users/4955546/sikandar-tariq"}, "is_accepted": true, "score": 0, "last_activity_date": 1576585418, "creation_date": 1576585418, "answer_id": 59374186, "question_id": 59373488, "link": "https://stackoverflow.com/questions/59373488/how-to-pass-ruby-instance-variable-in-a-python-argument/59374186#59374186", "title": "How to pass Ruby instance variable in a Python argument", "body": "<p>Try like this</p>\n\n<pre><code>%x[python lib/assets/python_scripts/python_test.py #{@rowarraydisp}]\n</code></pre>\n"}], "owner": {"reputation": 130, "user_id": 12131470, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--7tJ1PSFeIk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rct9QyWBDttPChinbbZf7d-dXSgHA/photo.jpg?sz=128", "display_name": "victorfink", "link": "https://stackoverflow.com/users/12131470/victorfink"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 59374186, "answer_count": 1, "score": 0, "last_activity_date": 1576585418, "creation_date": 1576582783, "question_id": 59373488, "link": "https://stackoverflow.com/questions/59373488/how-to-pass-ruby-instance-variable-in-a-python-argument", "title": "How to pass Ruby instance variable in a Python argument", "body": "<p>I'm building a Rails app that receives CSV files that are processed in Python. I was doing some simple tests and managed to execute a Python script within my Rails app and output the result in the browser.</p>\n\n<p>Now, I want to pass the CSV file that is uploaded on the rails app, as an argument for my Python script.</p>\n\n<p>Here is what I tried for the moment:</p>\n\n<p><strong>upload_excel_controller.rb</strong></p>\n\n<pre><code>require 'json'\n\nclass UploadExcelController &lt; ApplicationController\n    require 'csv'\n\n    def index\n    end\n\n    def import\n      rowarray = Array.new\n      myfile = params[:file]\n\n      @rowarraydisp = CSV.read(myfile.path)\n      @result = JSON.parse(`python lib/assets/python_scripts/python_test.py @rowarraydisp`)\n    end\nend\n</code></pre>\n\n<p><strong>python_test.py</strong></p>\n\n<pre><code>import json, sys\n\narg = sys.argv[1]\n\ndef main():\n    return(arg)\n\nif __name__ == \"__main__\":\n    json.dump(main(), sys.stdout)\n</code></pre>\n\n<p><strong>index.html.erb</strong></p>\n\n<pre><code>&lt;%= form_tag({:action =&gt; :import}, multipart: true) do %&gt;\n    &lt;%= file_field_tag :file %&gt;\n    &lt;%= submit_tag( \"Import\" ) %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>import.html.erb</strong></p>\n\n<pre><code>&lt;% @result.each do |substring| %&gt;\n    &lt;%= substring %&gt;\n    &lt;p&gt;End of this string, check next line for the other one!\n&lt;% end %&gt;\n\n&lt;p&gt;End of script&lt;/p&gt;\n</code></pre>\n\n<p>When I run this, I get this error: <code>undefined method 'each' for \"@rowarraydisp\":String</code>.</p>\n\n<p>It seems that <code>@rowarraydisp</code> was passed as a string.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-web-services", "aws-sdk", "amazon-qldb"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1576581568, "post_id": 59372092, "comment_id": 104938869, "body": "Decode to <i>what</i>? It\u2019s a perfectly valid binary."}, {"owner": {"reputation": 56, "user_id": 6999890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/787441355ee6375143a415caaa99b791?s=128&d=identicon&r=PG&f=1", "display_name": "Syed Samiuzzaman", "link": "https://stackoverflow.com/users/6999890/syed-samiuzzaman"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1576650680, "post_id": 59372092, "comment_id": 104964029, "body": "@AlekseiMatiushkin thanks for the msg. this binary contains string in between. it should return firstname: testing first lastname: testing last  this one is AWS ION Binary([ <a href=\"http://amzn.github.io/ion-docs/docs/binary.html]\" rel=\"nofollow noreferrer\">amzn.github.io/ion-docs/docs/binary.html]</a>) . I have used various unpack options to unpack this one. but not working properly. then we have to parse it. ion_text should also return the plain text but in this case its returning nil as well.   <code>{ firstname: &#39;testing first&#39;, last name: &#39;testing last&#39; }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 56, "user_id": 6999890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/787441355ee6375143a415caaa99b791?s=128&d=identicon&r=PG&f=1", "display_name": "Syed Samiuzzaman", "link": "https://stackoverflow.com/users/6999890/syed-samiuzzaman"}, "edited": false, "score": 0, "creation_date": 1576653254, "post_id": 59386721, "comment_id": 104964941, "body": "thanks .. I had done that before this actually raise an error <code>undefined method </code>read&#39; for #&lt;String:0x007fa9523face8&gt;`"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 56, "user_id": 6999890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/787441355ee6375143a415caaa99b791?s=128&d=identicon&r=PG&f=1", "display_name": "Syed Samiuzzaman", "link": "https://stackoverflow.com/users/6999890/syed-samiuzzaman"}, "edited": false, "score": 0, "creation_date": 1576653428, "post_id": 59386721, "comment_id": 104965023, "body": "OK, it requires <code>IO</code> \u2192 wrap your string in <a href=\"https://ruby-doc.org/stdlib-2.6/libdoc/stringio/rdoc/StringIO.html\" rel=\"nofollow noreferrer\"><code>StringIO</code></a>. I will update the answer."}, {"owner": {"reputation": 56, "user_id": 6999890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/787441355ee6375143a415caaa99b791?s=128&d=identicon&r=PG&f=1", "display_name": "Syed Samiuzzaman", "link": "https://stackoverflow.com/users/6999890/syed-samiuzzaman"}, "edited": false, "score": 0, "creation_date": 1576658404, "post_id": 59386721, "comment_id": 104966987, "body": "@alekesei thanks . Now I am getting the enumerable , but when I am traversing through the enumerable it&#39;s returning nil. But at least I am getting enumerable."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 56, "user_id": 6999890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/787441355ee6375143a415caaa99b791?s=128&d=identicon&r=PG&f=1", "display_name": "Syed Samiuzzaman", "link": "https://stackoverflow.com/users/6999890/syed-samiuzzaman"}, "edited": false, "score": 0, "creation_date": 1576658505, "post_id": 59386721, "comment_id": 104967028, "body": "In the link I posted it\u2019s stated <code>decode</code> returns <code>Enumerable&lt;Message&gt;</code>. What do you mean \u201cit\u2019s returning <code>nil</code>\u201d? What number of elements this enumerable has?"}, {"owner": {"reputation": 56, "user_id": 6999890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/787441355ee6375143a415caaa99b791?s=128&d=identicon&r=PG&f=1", "display_name": "Syed Samiuzzaman", "link": "https://stackoverflow.com/users/6999890/syed-samiuzzaman"}, "edited": false, "score": 0, "creation_date": 1577604226, "post_id": 59386721, "comment_id": 105206425, "body": "thanks for your help. mainly the problem with in the sdk gem. Enumerable&lt;message&gt; is nil. We have posted that one to GitHub page of sdk . they are looking into it."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1576653457, "last_edit_date": 1576653457, "creation_date": 1576651304, "answer_id": 59386721, "question_id": 59372092, "link": "https://stackoverflow.com/questions/59372092/how-to-decode-ion-binary-of-amazon-qldb-in-ruby/59386721#59386721", "title": "How to decode ion_binary of Amazon QLDB in ruby", "body": "<p>Decoding the stream is likely to be done with <a href=\"https://docs.aws.amazon.com/sdk-for-ruby/v3/api/Aws/EventStream/Decoder.html#decode-instance_method\" rel=\"nofollow noreferrer\"><code>Aws::EventStream::Decoder#decode</code></a>. That said, somewhat like below should work.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Aws::EventStream::Decoder.new.decode(\n  StringIO.new(result[:ion_binary])\n)\n</code></pre>\n"}], "owner": {"reputation": 56, "user_id": 6999890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/787441355ee6375143a415caaa99b791?s=128&d=identicon&r=PG&f=1", "display_name": "Syed Samiuzzaman", "link": "https://stackoverflow.com/users/6999890/syed-samiuzzaman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1591688863, "creation_date": 1576578051, "last_edit_date": 1591688863, "question_id": 59372092, "link": "https://stackoverflow.com/questions/59372092/how-to-decode-ion-binary-of-amazon-qldb-in-ruby", "title": "How to decode ion_binary of Amazon QLDB in ruby", "body": "<p>I was playing with <strong>QLDB</strong> of Amazon with ruby and used the <strong>aws-sdk-qldb</strong> and <strong>aws-sdk-qldbsession</strong> gem. I was getting result as IonBinary. But not able to decode and parse it. </p>\n\n<p>Following is the code </p>\n\n<pre><code>\n      cred = Aws::Credentials.new(ENV['AWS_ACCESS_KEY'], ENV['AWS_SECRET_ACCESS_KEY'])\n\n      qldb_session_client = Aws::QLDBSession::Client.new(region: 'ap-southeast-1', credentials: cred)\n\n      start_session_req = Aws::QLDBSession::Types::StartSessionRequest.new\n      start_session_req.ledger_name = 'ledger-test'\n\n\n      command_request = Aws::QLDBSession::Types::SendCommandRequest.new\n\n      command_request.start_session = start_session_req\n\n      resp = qldb_session_client.send_command(command_request)\n      session_token = resp.start_session.session_token\n\n      command_request = Aws::QLDBSession::Types::SendCommandRequest.new\n      command_request.session_token = session_token\n      command_request.start_transaction = Aws::QLDBSession::Types::StartTransactionRequest.new\n      resp = qldb_session_client.send_command(command_request)\n      transaction_id = resp.start_transaction.transaction_id\n\n      command_request = Aws::QLDBSession::Types::SendCommandRequest.new\n      command_request.session_token = session_token\n      command_request.execute_statement = Aws::QLDBSession::Types::ExecuteStatementRequest.new\n      command_request.execute_statement.transaction_id = transaction_id\n      command_request.execute_statement.statement = 'select * from testing'\n\n      resp = qldb_session_client.send_command(command_request)\n\n\n</code></pre>\n\n<p>now if I use the following code </p>\n\n<pre><code>resp.execute_statement.first_page.values[0]\n</code></pre>\n\n<p>I get </p>\n\n<pre><code>{:ion_binary=&gt;\"\\xE0\\x01\\x00\\xEA\\xEE\\x9A\\x81\\x83\\xDE\\x96\\x87\\xBE\\x93\\x89firstname\\x88lastname\\xDE\\x9D\\x8A\\x8Dtesting first\\x8B\\x8Ctesting last\", :ion_text=&gt;\"[FILTERED]\"}\n\n</code></pre>\n\n<p>I am not able to decode this ion_binary using binary parser.</p>\n"}, {"tags": ["ruby-on-rails", "regex", "ruby", "validation"], "comments": [{"owner": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 0, "creation_date": 1576577652, "post_id": 59371912, "comment_id": 104936665, "body": "It is matching only 1+ tabs or spaces. Can you add examples of the strings you are trying to validate to the question?"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 3, "creation_date": 1576577740, "post_id": 59371912, "comment_id": 104936711, "body": "You need <code>&#47;\\A[^\\t\\\\]+\\z&#47;</code> that will match a string that does not contain tabs and backslashes"}, {"owner": {"reputation": 384, "user_id": 7429535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6c98f8e0823f40f458d7a1c7d627103?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Lawton", "link": "https://stackoverflow.com/users/7429535/daniel-lawton"}, "reply_to_user": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 0, "creation_date": 1576577796, "post_id": 59371912, "comment_id": 104936743, "body": "@Thefourthbird testing123 - Fails (Expected to pass) backslash\\ - Fails (Expected to fail) thisshouldwork  - Fails (Expected to pass)"}, {"owner": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 2, "creation_date": 1576578000, "post_id": 59371912, "comment_id": 104936867, "body": "@DanielLawton Wiktor is right, you need to use a negated character class <code>[^</code> to match any char except a tab or backslash"}, {"owner": {"reputation": 384, "user_id": 7429535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6c98f8e0823f40f458d7a1c7d627103?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Lawton", "link": "https://stackoverflow.com/users/7429535/daniel-lawton"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1576578359, "post_id": 59371912, "comment_id": 104937083, "body": "@WiktorStribi\u017cew Thanks for the help guys! Forgot I was looking to negate the characters!"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1576611936, "post_id": 59371912, "comment_id": 104954174, "body": "I would write <code>str !~ &#47;[\\t\\\\]&#47;</code>."}], "owner": {"reputation": 384, "user_id": 7429535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6c98f8e0823f40f458d7a1c7d627103?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Lawton", "link": "https://stackoverflow.com/users/7429535/daniel-lawton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "closed_date": 1576578427, "answer_count": 0, "score": 1, "last_activity_date": 1576578026, "creation_date": 1576577474, "last_edit_date": 1576578026, "question_id": 59371912, "link": "https://stackoverflow.com/questions/59371912/validate-name-to-have-no-tabs-or-backslashes-rails", "closed_reason": "Duplicate", "title": "Validate name to have no tabs or backslashes - Rails", "body": "<p>I have the validation below for my model:</p>\n\n<pre><code>validates_format_of :name, :with =&gt; /\\A[\\t\\\\]+\\z/, :message =&gt; :'errors.backslash_or_tab'\n</code></pre>\n\n<p>The regex is checking for tabs and backslashes. \nThe issue is that even if the name does not contain a tab or backslash, it does not pass the validation and I get the error message popping up.</p>\n\n<p>Some example scenarios:</p>\n\n<ul>\n<li>testing123 - Fails (Expected to pass)</li>\n<li>backslash\\ - Fails (Expected to fail)</li>\n<li>thisshouldwork  - Fails (Expected to pass)</li>\n</ul>\n"}, {"tags": ["ruby-on-rails", "ruby", "capybara", "poltergeist"], "owner": {"reputation": 59, "user_id": 6747306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d281451f8e389d9ea59bfa1085df00?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Adeel", "link": "https://stackoverflow.com/users/6747306/muhammad-adeel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 2, "answer_count": 0, "score": 2, "last_activity_date": 1576577192, "creation_date": 1576577192, "question_id": 59371832, "link": "https://stackoverflow.com/questions/59371832/capybara-poltergeist-phantomjs-status-fail-error", "title": "Capybara poltergeist PhantomJs Status Fail Error", "body": "<p>I'm using pure ruby &amp; writing script in Ruby for some scripting work. I'm using capybara poltergeist to scrape ajax website which works quite good but for some website, it's giving <code>Capybara::Poltergeist::StatusFailError</code> error. I have tried to find a solution by doing some research but none of them is working in my case. I'm going to attach the code which I'm using so any help to fix that issue will be appriciated.</p>\n\n<pre><code>require 'capybara/poltergeist'\ncapybara = Capybara::Session.new(:poltergeist)\ncapybara.visit(\"https://www.azcentral.com/pages/interactives/news/local/arizona-data/arizona-government-salary-database/\")\n</code></pre>\n\n<p>I have used the other possible solution also by registering the capybara gem like that</p>\n\n<pre><code>    Capybara.register_driver :poltergeist do |app|\n        Capybara::Poltergeist::Driver.new(app, {js_errors: false})\n        Capybara::Poltergeist::Driver.new(app, timeout: 300, phantomjs_options: ['--load-images=no'])\n    end\n</code></pre>\n\n<p>Bur I have find out no solution which works for my case. So we need to find a solution which will work fot above mentioned website. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 3705, "user_id": 8551976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxgdN.jpg?s=128&g=1", "display_name": "asimhashmi", "link": "https://stackoverflow.com/users/8551976/asimhashmi"}, "edited": false, "score": 0, "creation_date": 1576577980, "post_id": 59371779, "comment_id": 104936856, "body": "Did you mean <code>rake spec</code> instead of <code>rails spec</code> ?"}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "reply_to_user": {"reputation": 3705, "user_id": 8551976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxgdN.jpg?s=128&g=1", "display_name": "asimhashmi", "link": "https://stackoverflow.com/users/8551976/asimhashmi"}, "edited": false, "score": 1, "creation_date": 1576584062, "post_id": 59371779, "comment_id": 104940086, "body": "<code>rake</code> would work, but I believe starting with Rails 5, <code>rails</code> is the preferred way to invoke <code>spec</code>, <code>db:migrate</code>, etc. See <a href=\"https://stackoverflow.com/questions/38403533/rails-dbmigrate-vs-rake-dbmigrate\" title=\"rails dbmigrate vs rake dbmigrate\">stackoverflow.com/questions/38403533/&hellip;</a>."}], "answers": [{"comments": [{"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "edited": false, "score": 0, "creation_date": 1576942353, "post_id": 59372000, "comment_id": 105059111, "body": "Marek, thanks. Are you pretty sure that this the exact difference, that is, there are no other differences?"}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "reply_to_user": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "edited": false, "score": 0, "creation_date": 1577081113, "post_id": 59372000, "comment_id": 105083812, "body": "I am not, to be honest. But most of the times, testing with <code>rspec</code> works as expected."}], "tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": false, "score": 2, "last_activity_date": 1576577794, "creation_date": 1576577794, "answer_id": 59372000, "question_id": 59371779, "link": "https://stackoverflow.com/questions/59371779/what-does-rails-spec-do-that-rspec-does-not/59372000#59372000", "title": "What does `rails spec` do that `rspec` does not?", "body": "<p>It seems it calls <code>rails test:prepare</code> before actually calling <code>rspec</code>:</p>\n\n<p><a href=\"https://github.com/rspec/rspec-rails/blob/master/lib/rspec/rails/tasks/rspec.rake#L11\" rel=\"nofollow noreferrer\">https://github.com/rspec/rspec-rails/blob/master/lib/rspec/rails/tasks/rspec.rake#L11</a></p>\n"}], "owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1576577794, "creation_date": 1576577033, "question_id": 59371779, "link": "https://stackoverflow.com/questions/59371779/what-does-rails-spec-do-that-rspec-does-not", "title": "What does `rails spec` do that `rspec` does not?", "body": "<p>What is it that <code>rails spec</code> does, if anything, that <code>rspec</code> alone does not?</p>\n\n<p>I was looking for a way to run only specific RSpec tests from the command line, and the only way I found requires running <code>rspec</code> directly (<code>rspec --tag focus ...</code>, not via <code>rails spec</code>. I could do that, but I'm concerned that maybe doing so bypassing some important setup or other functionality.</p>\n"}, {"tags": ["ruby-on-rails", "regex", "ruby"], "comments": [{"owner": {"reputation": 17982, "user_id": 3689450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXuSR.png?s=128&g=1", "display_name": "VLAZ", "link": "https://stackoverflow.com/users/3689450/vlaz"}, "edited": false, "score": 0, "creation_date": 1576568826, "post_id": 59369622, "comment_id": 104932179, "body": "Also note that this validation, even if it has the correct year syntax, will not make sure the date is correct. You can still receive <code>2019-02-31</code> which is not a date that exists but will be valid according to the regex. It&#39;s extremely complex to make a correct date validation using regex alone, you&#39;re better off just checking for broad conformance and then using a date library for the actual verification."}, {"owner": {"reputation": 17982, "user_id": 3689450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXuSR.png?s=128&g=1", "display_name": "VLAZ", "link": "https://stackoverflow.com/users/3689450/vlaz"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1576568873, "post_id": 59369622, "comment_id": 104932202, "body": "@Stefan yeah, I just noticed the <code>\\d</code> there. I&#39;ve removed the comment a second before you posted."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1576569194, "post_id": 59369622, "comment_id": 104932340, "body": "Can we see the full context of the <code>param!</code> call? Is it, perhaps, nested?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 4, "creation_date": 1576569749, "post_id": 59369622, "comment_id": 104932592, "body": "Why do you want to validate the string format of a date? Why not just parse it (you do it anyway) and if the parser doesn&#39;t raise an error then accept it as correct and if the parser raises an error then you return a useful error message?"}, {"owner": {"reputation": 5259, "user_id": 715286, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BqXXo.jpg?s=128&g=1", "display_name": "Qortex", "link": "https://stackoverflow.com/users/715286/qortex"}, "edited": false, "score": 0, "creation_date": 1576575274, "post_id": 59369622, "comment_id": 104935244, "body": "Rubular (<a href=\"https://rubular.com\" rel=\"nofollow noreferrer\">rubular.com</a>) is a good tool to easily battle-test your regexes"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1576603875, "post_id": 59369622, "comment_id": 104950667, "body": "The string represents a valid date if and only if <code>DateTime.strptime(input, &#39;%Y-%m-%d&#39;)</code> does not raise an exception. You therefore need to execute that (after <code>&#39;require &#39;date&#39;</code>) within a <code>begin-rescue-end</code> clause and catch an exception if thrown. For a regular expression to be used it would have to be complex, in part because it would have to implement all the rules for determining if a year is a leap year (it&#39;s not, for example, if the year is evenly divided by 100,  but not by 400). Needless to say, a regular expression is not the right tool for the job here."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1576604758, "post_id": 59369622, "comment_id": 104951041, "body": "While I suggest using <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/date/rdoc/DateTime.html#method-c-strptime\" rel=\"nofollow noreferrer\">DateTime::strptime</a>, I caution use of <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/date/rdoc/Date.html#method-c-parse\" rel=\"nofollow noreferrer\">Date#parse</a>, which is notoriously unreliable. For example, if <code>parse</code>&#39;s argument (a string) contains the word &quot;may&quot; or &quot;march&quot; (or even a word that begins with &quot;may&quot; or &quot;march&quot;, such as &quot;marching&quot; and &quot;maybe&quot;), it will dutifully turn the string into a date."}], "answers": [{"comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 4, "creation_date": 1576571044, "post_id": 59370095, "comment_id": 104933167, "body": "I doubt that this helps or even works at all. To convince me otherwise please explain how this works and why it helps."}], "tags": [], "owner": {"reputation": 1, "user_id": 7893322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c7786c8f65f4f432709adc1c0c4b533?s=128&d=identicon&r=PG&f=1", "display_name": "Qing Feng", "link": "https://stackoverflow.com/users/7893322/qing-feng"}, "is_accepted": false, "score": -1, "last_activity_date": 1576573291, "last_edit_date": 1576573291, "creation_date": 1576570845, "answer_id": 59370095, "question_id": 59369622, "link": "https://stackoverflow.com/questions/59369622/regex-validation-yyyy-mm-dd-format/59370095#59370095", "title": "Regex validation YYYY-MM-DD format", "body": "<p><a href=\"https://i.stack.imgur.com/4FaIu.png\" rel=\"nofollow noreferrer\">show result</a>suppose you are validate 1900-2019</p>\n\n<pre><code>/^(19[0-9][0-9]|20[0-1][0-9])-(0[0-9]|1[0-2])-(0[0-9]|1[0-9]|2[0-9]|3[0-1])$/\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1576580684, "creation_date": 1576580684, "answer_id": 59372896, "question_id": 59369622, "link": "https://stackoverflow.com/questions/59369622/regex-validation-yyyy-mm-dd-format/59372896#59372896", "title": "Regex validation YYYY-MM-DD format", "body": "<p>Proper validation of <code>YYYY-MM-DD</code> aka <em>ISO8601</em> format would be:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'date'\ninput = '2019-12-11'\nDate.parse(input).to_s == input\n</code></pre>\n\n<p>Regular expressions should not be used for this purpose.</p>\n"}], "owner": {"reputation": 4246, "user_id": 2541366, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f6d2bc66669eb034160002544a580c61?s=128&d=identicon&r=PG", "display_name": "Sam", "link": "https://stackoverflow.com/users/2541366/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1576580684, "creation_date": 1576568566, "question_id": 59369622, "link": "https://stackoverflow.com/questions/59369622/regex-validation-yyyy-mm-dd-format", "title": "Regex validation YYYY-MM-DD format", "body": "<p>I am using the <a href=\"https://rubular.com/r/q2zsY2iwpktloT\" rel=\"nofollow noreferrer\">Regex</a> to validate the date format(YYYY-MM-DD) using this gem(<a href=\"https://github.com/nicolasblanco/rails_param\" rel=\"nofollow noreferrer\">https://github.com/nicolasblanco/rails_param</a>)</p>\n\n<pre><code>param! :start_date, Date, format: /([12]\\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[12]\\d|3[01]))/, required: true, message: \"Query start_date is not specified and invalid\"\n</code></pre>\n\n<p>For right date format also it is saying error\nQuery start_date is not specified</p>\n\n<p>A sample query\n<a href=\"http://localhost:3005/data?start_date=2008-01-27&amp;end_date=2009-01-27\" rel=\"nofollow noreferrer\">http://localhost:3005/data?start_date=2008-01-27&amp;end_date=2009-01-27</a></p>\n\n<p>It's not working</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 49960, "user_id": 32453, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bec38d63650c8912b6ba9b557fb953b9?s=128&d=identicon&r=PG", "display_name": "rogerdpack", "link": "https://stackoverflow.com/users/32453/rogerdpack"}, "edited": false, "score": 3, "creation_date": 1576567393, "post_id": 59369226, "comment_id": 104931561, "body": "you need to <code>cd</code> (change directory) to the directory containing hello.rb first... or pass the entire path of the file to ruby..."}], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 11746373, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uO3gcoZZNEw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePhZCXRsr3lp0jmEQ-Bn0HBR4mIQ/photo.jpg?sz=128", "display_name": "Roy Xu", "link": "https://stackoverflow.com/users/11746373/roy-xu"}, "edited": false, "score": 0, "creation_date": 1576567779, "post_id": 59369328, "comment_id": 104931715, "body": "sorry I know this sounds stupid but I just wanna ask how to cd into the correct directory and what is the correct directory?"}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "reply_to_user": {"reputation": 159, "user_id": 11746373, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uO3gcoZZNEw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePhZCXRsr3lp0jmEQ-Bn0HBR4mIQ/photo.jpg?sz=128", "display_name": "Roy Xu", "link": "https://stackoverflow.com/users/11746373/roy-xu"}, "edited": false, "score": 0, "creation_date": 1576567865, "post_id": 59369328, "comment_id": 104931757, "body": "&#39;correct directory&#39; in this context it&#39;s the directory where you have your <code>hello.rb</code> file located, so it&#39;s probably your Desktop (it&#39;s a directory as well). I wrote how to do it (well, most probably) in my answer.  I strongly advice learning some command-line basics first."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1576580392, "post_id": 59369328, "comment_id": 104938213, "body": "The &quot;open command line here&quot; can be accessed through Shift + right click, which should provide the option &quot;open PowerShell here&quot; when in explorer."}], "tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": false, "score": 2, "last_activity_date": 1576575569, "last_edit_date": 1576575569, "creation_date": 1576567234, "answer_id": 59369328, "question_id": 59369226, "link": "https://stackoverflow.com/questions/59369226/why-ruby-cannot-run-the-rb-files/59369328#59369328", "title": "Why ruby cannot run the .rb files?", "body": "<p>You should provide the correct path to your file, since it's not located in <code>system32</code> directory, this relative path won't work. If it's on the desktop, it would be something like this, probably:</p>\n\n<pre><code>ruby %HOMEPATH%\\Desktop\\hello.rb\n</code></pre>\n\n<p>or you can change your current directory to desktop before you start playing with ruby:</p>\n\n<pre><code>cd %HOMEPATH%\\Desktop\n</code></pre>\n\n<p>from now on, you can easily use relative path, since <code>hello.rb</code> is located in the same directory you're in currently in your command line:</p>\n\n<pre><code>ruby hello.rb\n</code></pre>\n\n<p>I'm not quite sure of exact syntax etc, I don't use Windows cmd very often - you would have to experiment on your own. </p>\n\n<p>There may be context menu option like \"open command line here\" in Windows, but I'm not sure of it as well.</p>\n\n<p>Also, you may need to learn basics of command line even before you start to learn Ruby. </p>\n"}], "owner": {"reputation": 159, "user_id": 11746373, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uO3gcoZZNEw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePhZCXRsr3lp0jmEQ-Bn0HBR4mIQ/photo.jpg?sz=128", "display_name": "Roy Xu", "link": "https://stackoverflow.com/users/11746373/roy-xu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "closed_date": 1576682702, "answer_count": 1, "score": -1, "last_activity_date": 1576575569, "creation_date": 1576566810, "last_edit_date": 1576567008, "question_id": 59369226, "link": "https://stackoverflow.com/questions/59369226/why-ruby-cannot-run-the-rb-files", "closed_reason": "Not suitable for this site", "title": "Why ruby cannot run the .rb files?", "body": "<p>I am a beginner just starting to learn ruby. The tutorials I have been reading say that I can create a file with the extension <code>.rb</code>(eg. hello.rb) and run the file in the command prompt by typing ruby hello.rb. But when I create and save the file on the desktop and run it in the cmd it always gives me this error message:</p>\n\n<pre><code>C:\\Windows\\system32&gt;ruby hello.rb\nTraceback (most recent call last):\nruby: No such file or directory -- hello.rb (LoadError)\n</code></pre>\n\n<p>I searched the internet and read a lot of other tutorials but none of them seem to have any discussion on this issue.</p>\n\n<p>Can someone give me any hints on this please?\nAny advice or help will be greatly appreciated!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "server", "puma", "codeanywhere"], "comments": [{"owner": {"reputation": 1113, "user_id": 188574, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/3ab1d9940a0827332af4a07dc2c45838?s=128&d=identicon&r=PG", "display_name": "Tun", "link": "https://stackoverflow.com/users/188574/tun"}, "edited": false, "score": 0, "creation_date": 1576565513, "post_id": 59368215, "comment_id": 104930903, "body": "what are the rails version, puma version, puma config and output of <code>rails s</code>? please add in your question."}, {"owner": {"reputation": 33, "user_id": 10482510, "user_type": "registered", "profile_image": "https://graph.facebook.com/309938086465290/picture?type=large", "display_name": "Samreid Manez", "link": "https://stackoverflow.com/users/10482510/samreid-manez"}, "reply_to_user": {"reputation": 1113, "user_id": 188574, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/3ab1d9940a0827332af4a07dc2c45838?s=128&d=identicon&r=PG", "display_name": "Tun", "link": "https://stackoverflow.com/users/188574/tun"}, "edited": false, "score": 0, "creation_date": 1576578063, "post_id": 59368215, "comment_id": 104936905, "body": "Okay I&#39;ve done that now"}, {"owner": {"reputation": 1113, "user_id": 188574, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/3ab1d9940a0827332af4a07dc2c45838?s=128&d=identicon&r=PG", "display_name": "Tun", "link": "https://stackoverflow.com/users/188574/tun"}, "edited": false, "score": 0, "creation_date": 1576590356, "post_id": 59368215, "comment_id": 104943451, "body": "It seems the server itself is working fine. I think you have to change config in CodeAnywhere."}, {"owner": {"reputation": 1141, "user_id": 3251463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hxssB.png?s=128&g=1", "display_name": "Scott Schupbach", "link": "https://stackoverflow.com/users/3251463/scott-schupbach"}, "edited": false, "score": 0, "creation_date": 1576614657, "post_id": 59368215, "comment_id": 104955225, "body": "Sometimes changing the Rails version in your Gemfile to something other than the version used to create the app can have consequences like this. Try just changing the Puma version to see if that is the problem."}], "answers": [{"tags": [], "owner": {"reputation": 1041, "user_id": 2680086, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LqPVE.jpg?s=128&g=1", "display_name": "Bob Mazanec", "link": "https://stackoverflow.com/users/2680086/bob-mazanec"}, "is_accepted": false, "score": 1, "last_activity_date": 1578007557, "last_edit_date": 1578007557, "creation_date": 1578001364, "answer_id": 59570390, "question_id": 59368215, "link": "https://stackoverflow.com/questions/59368215/development-server-doesnt-work-after-updating-puma-in-ruby-on-rails-app/59570390#59570390", "title": "Development server doesn&#39;t work after updating Puma in Ruby on Rails app", "body": "<p>I just hit this after updating to Puma 3.12.2, too (Rails 6 in case anyone cares).</p>\n\n<p>Reviewing <a href=\"https://github.com/puma/puma/blob/fe44f8c7fc48b9bab7cf2c21d6bbbe601b0f9396/lib/puma/dsl.rb\" rel=\"nofollow noreferrer\"><code>lib/puma/dsl.rb</code></a>, I found 2 ways to change my Rails app's <code>config/puma.rb</code> to specify <code>0.0.0.0</code>.</p>\n\n<p>Both</p>\n\n<pre><code>set_default_host '0.0.0.0'\nport        ENV.fetch(\"PORT\") { 3000 }\n</code></pre>\n\n<p>and</p>\n\n<pre><code>port        ENV.fetch(\"PORT\") { 3000 }, '0.0.0.0'\n</code></pre>\n\n<p>make it print</p>\n\n<pre><code>[...]\n* Listening on tcp://0.0.0.0:3000\nUse Ctrl-C to stop\n[...]\n</code></pre>\n\n<p>on startup and work/listen accordingly for me.</p>\n"}], "owner": {"reputation": 33, "user_id": 10482510, "user_type": "registered", "profile_image": "https://graph.facebook.com/309938086465290/picture?type=large", "display_name": "Samreid Manez", "link": "https://stackoverflow.com/users/10482510/samreid-manez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 613, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1578007557, "creation_date": 1576561590, "last_edit_date": 1576593438, "question_id": 59368215, "link": "https://stackoverflow.com/questions/59368215/development-server-doesnt-work-after-updating-puma-in-ruby-on-rails-app", "title": "Development server doesn&#39;t work after updating Puma in Ruby on Rails app", "body": "<p>I'll preface this with letting you know that I'm quite a novice when it comes to programming, so I apologise if the solution is straightforward. </p>\n\n<p>I have a Ruby on Rails app on 'Codeanywhere' which is an Online cloud-based IDE, I'm using Puma to view the server in development. Usually, it's as easy as entering in 'Rails s' and then clicking the preview button to view my app in development. </p>\n\n<p>However, after doing a 'bundle update', this no longer works. I enter in 'Rails s' and it says the server has started, but when I click the preview button, it says it can't connect and there's no server running. I've narrowed it down and the 'update' that is causing this issue is either the updating of the Rails gem itself, or more likely the updating of the Puma gem, which is the gem that controls this function. </p>\n\n<p>I've tried \"rails s --binding=0.0.0.0\" but that hasn't worked either, it seems to just be the update that breaks it, but I need the update as it's a security vulnerability. If I roll back the update, it works fine, but I need the updated gems. </p>\n\n<p>Rails version before update: 5.2.1\nPuma version before update: 3.11</p>\n\n<p>Rails version after update: 5.2.4\nPuma version after update: 3.12.2</p>\n\n<p>Rails S output is:</p>\n\n<pre><code>=&gt; Booting Puma\n=&gt; Rails 5.2.4 application starting in development\n=&gt; Run `rails server -h` for more startup options\nPuma starting in single mode...\n* Version 3.12.2 (ruby 2.5.1-p57), codename: Llamas in Pajamas\n* Min threads: 5, max threads: 5\n* Environment: development\n* Listening on tcp://localhost:3000\nUse Ctrl-C to stop\n^C- Gracefully stop\n</code></pre>\n\n<p>Some insight would be greatly appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "ruby-on-rails-5", "rspec-rails"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1576568143, "post_id": 59368093, "comment_id": 104931883, "body": "Try <code>instance_exec(&amp;a)</code> rather than <code>a.call</code> to transfer the scope"}, {"owner": {"reputation": 11, "user_id": 9490443, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Zed", "link": "https://stackoverflow.com/users/9490443/zed"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1576597787, "post_id": 59368093, "comment_id": 104947655, "body": "that worked, thanks!!"}], "owner": {"reputation": 11, "user_id": 9490443, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Zed", "link": "https://stackoverflow.com/users/9490443/zed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576562705, "creation_date": 1576560622, "last_edit_date": 1576562705, "question_id": 59368093, "link": "https://stackoverflow.com/questions/59368093/use-rails-test-mixin-methods-from-inside-proc-lambda", "title": "Use rails test mixin methods from inside proc/lambda", "body": "<p>I am trying to call the rails test methods from inside a lambda.  I get an error though saying method not defined.</p>\n\n<pre><code>actions = [\n-&gt; { post(\"url\", body) },\n-&gt; { get(\"url\") }\n]\n\nactions.each do |a|\n define 'test...'\n   a.call() # undefined method 'post'\n end\nend\n\n</code></pre>\n\n<p>The only way I can get to work is by manually creating test session and call methods off that. There are other tests in file that use the test helper methods but not from lambda, it makes tests confusing to have two last_respones, etc</p>\n\n<pre><code>session = Rack::Test::Session.new(Rack::MockSession.new(Sinatra::Application))\nactions = [\n-&gt; { session.post(\"url\", body) },\n-&gt; { session.get(\"url\") }\n]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 2418, "user_id": 1115413, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2f829cdfee7bb3bc59435b431e2f3402?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/1115413/steve"}, "edited": false, "score": 0, "creation_date": 1576608472, "post_id": 59367552, "comment_id": 104952697, "body": "This answer works when the relationship between Enrollment Plan and Plan is a <code>has_many :plans</code>, but in my example the relationship is <code>belongs_to :plan</code>, which results in <code>&quot;Can&#39;t join EnrollmentPlan&#39; to association named &#39;plans&#39;; perhaps you misspelled it?&quot;</code> - I&#39;m using rails 6.0.1 not sure if this is the reason"}, {"owner": {"reputation": 2418, "user_id": 1115413, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2f829cdfee7bb3bc59435b431e2f3402?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/1115413/steve"}, "edited": false, "score": 0, "creation_date": 1576608576, "post_id": 59367552, "comment_id": 104952739, "body": "tweak the answer to: <code>EnrollmentPlan.joins(:plan).where(plans: { plan_type_id: 1 })</code>, the first plan matches the association, the plans is for the table regardless of the association, using Rails 6.0.1"}], "tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 1, "last_activity_date": 1576612116, "last_edit_date": 1576612116, "creation_date": 1576556092, "answer_id": 59367552, "question_id": 59366857, "link": "https://stackoverflow.com/questions/59366857/rails-query-based-on-associated-models/59367552#59367552", "title": "Rails Query Based on Associated Models", "body": "<p>You should check out <a href=\"https://guides.rubyonrails.org/active_record_querying.html\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/active_record_querying.html</a></p>\n\n<p>The example they give is:</p>\n\n<pre><code>Author.joins(:articles).where(articles: { author: author })\n</code></pre>\n\n<p>So in your case:</p>\n\n<pre><code>EnrollmentPlan.joins(:plan).where(plans: { plan_type_id: 1 })\n</code></pre>\n\n<p>EDIT: As @steve stated, the above was for a has_many. Tweaked for a has_one relationship</p>\n"}, {"comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1576670332, "post_id": 59369337, "comment_id": 104972897, "body": "This is more efficient than my solution"}], "tags": [], "owner": {"reputation": 183, "user_id": 7208575, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hkm2f.jpg?s=128&g=1", "display_name": "Snehal Dwivedi", "link": "https://stackoverflow.com/users/7208575/snehal-dwivedi"}, "is_accepted": false, "score": 1, "last_activity_date": 1576567271, "creation_date": 1576567271, "answer_id": 59369337, "question_id": 59366857, "link": "https://stackoverflow.com/questions/59366857/rails-query-based-on-associated-models/59369337#59369337", "title": "Rails Query Based on Associated Models", "body": "<p>I will say use includes instead of joins it will not fire n+1 queries</p>\n\n<pre><code>EnrollmentPlan.includes(:plans).where(plans: { plan_type_id: 1 }).references(:plans)\n</code></pre>\n"}], "owner": {"reputation": 2418, "user_id": 1115413, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2f829cdfee7bb3bc59435b431e2f3402?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/1115413/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1576612116, "creation_date": 1576550072, "question_id": 59366857, "link": "https://stackoverflow.com/questions/59366857/rails-query-based-on-associated-models", "title": "Rails Query Based on Associated Models", "body": "<p>I'm trying to find all EnrollmentPlans with a plan_type_id = 1 so I need to use the plan_id in the EnrollmentPlan table to get the plan_type_id from the Plan table in order to query the EnrollmentPlan table.</p>\n\n<p>I have three models:</p>\n\n<p>PlayType => <code>:id, :name</code></p>\n\n<p>Plan => <code>:id, :name, :plan_type_id</code></p>\n\n<p>EnrollmentPlan => <code>:id, :enrollment_id, :plan_id</code></p>\n\n<p>Associations:\nEnrollmentPlan</p>\n\n<pre><code>belongs_to :plan\nhas_one :plan_type, through: :plan\n</code></pre>\n\n<p>Plan:</p>\n\n<pre><code>has_many :enrollment_plans\nbelongs_to :plan_type\n</code></pre>\n\n<p>I was trying queries like <code>EnrollmentPlan.joins(:plans).where(plans.plan_type_id: 1)</code> but no luck.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 6315, "user_id": 5411198, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/FabOI.jpg?s=128&g=1", "display_name": "sergio MAGA", "link": "https://stackoverflow.com/users/5411198/sergio-maga"}, "edited": false, "score": 0, "creation_date": 1576549554, "post_id": 59366604, "comment_id": 104927290, "body": "The problem seems similar to the one described here: <a href=\"https://stackoverflow.com/questions/24833123/custom-gem-execution-fails-with-nomethoderror\" title=\"custom gem execution fails with nomethoderror\">stackoverflow.com/questions/24833123/&hellip;</a> which is solved by regenerating the binstubs."}, {"owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "edited": false, "score": 0, "creation_date": 1576559195, "post_id": 59366604, "comment_id": 104929125, "body": "Regenerating binstubs didn&#39;t help. I downgraded bundler to 2.0.2 and everything works fine now. I guess it&#39;s a bundler 2.1.0 bug?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12329695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd2a471a026b959473f76bb69f650339?s=128&d=identicon&r=PG&f=1", "display_name": "Book Chang", "link": "https://stackoverflow.com/users/12329695/book-chang"}, "is_accepted": false, "score": 0, "last_activity_date": 1576576930, "last_edit_date": 1576576930, "creation_date": 1576576068, "answer_id": 59371504, "question_id": 59366604, "link": "https://stackoverflow.com/questions/59366604/undefined-method-plain-specs-for-bundlerrubygemsintegration0x00005633f09a/59371504#59371504", "title": "undefined method `plain_specs&#39; for #&lt;Bundler::RubygemsIntegration:0x00005633f09a9000&gt; (NoMethodError)", "body": "<p>What is your ruby version? I had same problem.</p>\n\n<p>My ruby version is <code>2.6.3</code> and my bundle didn't work in this ruby version.\n(Bundle is already upgraded to <code>2.0.2</code>),</p>\n\n<p>So I downgraded my bundle to verion <code>1.17.3</code> and it worked.</p>\n\n<p>I with this solution will help you.</p>\n"}, {"tags": [], "owner": {"reputation": 156, "user_id": 4599566, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_Ds9m31PIBk/AAAAAAAAAAI/AAAAAAAAAAA/KxaaUrucSCc/photo.jpg?sz=128", "display_name": "rokugou", "link": "https://stackoverflow.com/users/4599566/rokugou"}, "is_accepted": true, "score": 14, "last_activity_date": 1576576498, "creation_date": 1576576498, "answer_id": 59371621, "question_id": 59366604, "link": "https://stackoverflow.com/questions/59366604/undefined-method-plain-specs-for-bundlerrubygemsintegration0x00005633f09a/59371621#59371621", "title": "undefined method `plain_specs&#39; for #&lt;Bundler::RubygemsIntegration:0x00005633f09a9000&gt; (NoMethodError)", "body": "<pre><code>gem uninstall rubygems-bundler\n</code></pre>\n\n<p>works for me\nI am using bundler 2.1.0</p>\n\n<p>REF: <a href=\"https://github.com/bundler/bundler/issues/7492\" rel=\"noreferrer\">https://github.com/bundler/bundler/issues/7492</a></p>\n\n<p>When showing </p>\n\n<pre><code>ERROR:  While executing gem ... (Gem::InstallError)\n    rubygems-bundler is not installed in GEM_HOME, try:\n    gem uninstall -i /Users/xxxx/.rvm/rubies/ruby-2.5.7/lib/ruby/gems/2.5.0 rubygems-bundler\n</code></pre>\n\n<p>Please run </p>\n\n<pre><code>gem uninstall -i /Users/xxxx/.rvm/rubies/ruby-2.5.7/lib/ruby/gems/2.5.0 rubygems-bundler\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13950, "user_id": 1626687, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8d4317dca5804dd7e9b30515b9bf3020?s=128&d=identicon&r=PG", "display_name": "spuder", "link": "https://stackoverflow.com/users/1626687/spuder"}, "is_accepted": false, "score": 0, "last_activity_date": 1576881618, "creation_date": 1576881618, "answer_id": 59432034, "question_id": 59366604, "link": "https://stackoverflow.com/questions/59366604/undefined-method-plain-specs-for-bundlerrubygemsintegration0x00005633f09a/59432034#59432034", "title": "undefined method `plain_specs&#39; for #&lt;Bundler::RubygemsIntegration:0x00005633f09a9000&gt; (NoMethodError)", "body": "<p>Ensure you are using a version of ruby that is supported. I ran into this when trying to use <code>jruby-9.2.9</code>. By switching from jruby to ruby the problem went away. </p>\n\n<pre><code>rvm use ruby-2.5.1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 977, "user_id": 2625958, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r9mA7.jpg?s=128&g=1", "display_name": "mahfuz", "link": "https://stackoverflow.com/users/2625958/mahfuz"}, "is_accepted": false, "score": 0, "last_activity_date": 1583257648, "creation_date": 1583257648, "answer_id": 60512915, "question_id": 59366604, "link": "https://stackoverflow.com/questions/59366604/undefined-method-plain-specs-for-bundlerrubygemsintegration0x00005633f09a/60512915#60512915", "title": "undefined method `plain_specs&#39; for #&lt;Bundler::RubygemsIntegration:0x00005633f09a9000&gt; (NoMethodError)", "body": "<p>It is a bug with bundler version <code>2.1.0.pre.2</code></p>\n\n<p>I unistalled bundler gem and install different version of bundler gem</p>\n\n<pre><code>$ gem uninstall bundler\n$ gem install bundler -v 2.0.2\n</code></pre>\n\n<p>It should work.</p>\n"}], "owner": {"reputation": 144, "user_id": 8550295, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155999727128287/picture?type=large", "display_name": "Acartes", "link": "https://stackoverflow.com/users/8550295/acartes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1632, "favorite_count": 3, "accepted_answer_id": 59371621, "answer_count": 4, "score": 13, "last_activity_date": 1583257648, "creation_date": 1576547927, "question_id": 59366604, "link": "https://stackoverflow.com/questions/59366604/undefined-method-plain-specs-for-bundlerrubygemsintegration0x00005633f09a", "title": "undefined method `plain_specs&#39; for #&lt;Bundler::RubygemsIntegration:0x00005633f09a9000&gt; (NoMethodError)", "body": "<p>I have made a pull of a project that I have in my work and when I tried to run <code>rails db:migrate</code>, the terminal request to install \"Bundler 2\" so I do it. </p>\n\n<p>Now, when I tried to do <code>rails db:migrate</code> I have the following error:</p>\n\n<pre><code>/home/acartesc/.rvm/rubies/ruby-2.4.3/lib/ruby/gems/2.4.0/gems/rubygems-bundler-1.4.5/lib/rubygems-bundler/noexec.rb:84:in `setup': undefined method `plain_specs' for #&lt;Bundler::RubygemsIntegration:0x00005633f09a9000&gt; (NoMethodError)\n    from /home/acartesc/.rvm/rubies/ruby-2.4.3/lib/ruby/gems/2.4.0/gems/rubygems-bundler-1.4.5/lib/rubygems-bundler/noexec.rb:124:in `check'\n    from /home/acartesc/.rvm/rubies/ruby-2.4.3/lib/ruby/gems/2.4.0/gems/rubygems-bundler-1.4.5/lib/rubygems-bundler/noexec.rb:131:in `&lt;top (required)&gt;'\n    from /home/acartesc/.rvm/rubies/ruby-2.4.3/lib/ruby/site_ruby/2.4.0/rubygems/core_ext/kernel_require.rb:168:in `require'\n    from /home/acartesc/.rvm/rubies/ruby-2.4.3/lib/ruby/site_ruby/2.4.0/rubygems/core_ext/kernel_require.rb:168:in `rescue in require'\n    from /home/acartesc/.rvm/rubies/ruby-2.4.3/lib/ruby/site_ruby/2.4.0/rubygems/core_ext/kernel_require.rb:178:in `require'\n    from /home/acartesc/.rvm/rubies/ruby-2.4.3/lib/ruby/gems/2.4.0/gems/rubygems-bundler-1.4.5/lib/rubygems_executable_plugin.rb:4:in `block in &lt;top (required)&gt;'\n    from /home/acartesc/.rvm/rubies/ruby-2.4.3/lib/ruby/gems/2.4.0/gems/executable-hooks-1.5.0/lib/executable-hooks/hooks.rb:50:in `block in run'\n    from /home/acartesc/.rvm/rubies/ruby-2.4.3/lib/ruby/gems/2.4.0/gems/executable-hooks-1.5.0/lib/executable-hooks/hooks.rb:49:in `each'\n    from /home/acartesc/.rvm/rubies/ruby-2.4.3/lib/ruby/gems/2.4.0/gems/executable-hooks-1.5.0/lib/executable-hooks/hooks.rb:49:in `run'\n    from /home/acartesc/.rvm/gems/ruby-2.4.3/bin/ruby_executable_hooks:10:in `&lt;main&gt;'\n</code></pre>\n\n<p>I appreciate your help!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 5286, "user_id": 455770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mMHwz.jpg?s=128&g=1", "display_name": "Rots", "link": "https://stackoverflow.com/users/455770/rots"}, "is_accepted": false, "score": 0, "last_activity_date": 1576543591, "creation_date": 1576543591, "answer_id": 59366164, "question_id": 59366028, "link": "https://stackoverflow.com/questions/59366028/invalid-byte-sequence-in-utf-8-for-single-quote-in-ruby/59366164#59366164", "title": "invalid byte sequence in UTF-8 for single quote in Ruby", "body": "<pre><code>def to_utf8(str)\n  str = str.force_encoding(\"UTF-8\")\n  return str if str.valid_encoding?\n  str = str.force_encoding(\"BINARY\")\n  str.encode(\"UTF-8\", invalid: :replace, undef: :replace)\nend\n</code></pre>\n\n<p>ref: <a href=\"https://stackoverflow.com/a/17028706/455770\">https://stackoverflow.com/a/17028706/455770</a></p>\n"}], "owner": {"reputation": 61, "user_id": 7294579, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UTC5_Mci8yw/AAAAAAAAAAI/AAAAAAAAAAs/uaJfE77tYls/photo.jpg?sz=128", "display_name": "Fei Qu", "link": "https://stackoverflow.com/users/7294579/fei-qu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1576543591, "creation_date": 1576542393, "question_id": 59366028, "link": "https://stackoverflow.com/questions/59366028/invalid-byte-sequence-in-utf-8-for-single-quote-in-ruby", "title": "invalid byte sequence in UTF-8 for single quote in Ruby", "body": "<p>I'm using the following code to show description in template:</p>\n\n<pre><code>json.description resource.description if resource.description.present?\n</code></pre>\n\n<p>It gives me invalid byte sequence in UTF-8 error. I dig this a little bit, and find out the issue is my description has single quote as \u2019 instead of '. Wondering what's the best way to fix this encoding issue? Description is input by user and I have no control over it. Another weird issue is, I have multiple test environments, they all have the same Ruby and Rails version and they are running the same code, but only one of the environment has this error.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "string", "carriage-return"], "comments": [{"owner": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "edited": false, "score": 1, "creation_date": 1576536362, "post_id": 59365280, "comment_id": 104924492, "body": "could you please show what you have done so far?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1576568654, "post_id": 59365280, "comment_id": 104932103, "body": "Are you looking for <a href=\"https://ruby-doc.org/core-2.6.5/String.html#method-i-each_line\" rel=\"nofollow noreferrer\"><code>String#each_line</code></a>?"}, {"owner": {"reputation": 597, "user_id": 10239403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fbdaea0dedd13b281fb7e70665efe4?s=128&d=identicon&r=PG", "display_name": "Demian Sims", "link": "https://stackoverflow.com/users/10239403/demian-sims"}, "edited": false, "score": 0, "creation_date": 1576721388, "post_id": 59365280, "comment_id": 104993736, "body": "I did not know about that one either."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1576537637, "post_id": 59365451, "comment_id": 104924845, "body": "I don&#39;t know Rails so have just passed the string to the method <code>action</code>. I assume creating the <code>ActiveRecord</code> instance is straightforward."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 1, "last_activity_date": 1576549612, "last_edit_date": 1576549612, "creation_date": 1576537477, "answer_id": 59365451, "question_id": 59365280, "link": "https://stackoverflow.com/questions/59365280/how-does-ruby-detect-a-carriage-return-in-a-string/59365451#59365451", "title": "How does Ruby detect a carriage return in a string?", "body": "<pre><code>def doit(str)\n  start_idx = 0\n  while i = str.index(\"\\n\", start_idx)\n    action str[0..i-1]\n    start_idx = i+1\n  end\nend\n\ndef action(str)\n  puts \"This is what I've read: #{str}\"\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>doit(\"Three blind mice,\\nsee how they run.\\nThey all ran after the farmer's wife\\n\")\n  # This is what I've read: Three blind mice,\n  # This is what I've read: Three blind mice,\n  # see how they run.\n  # This is what I've read: Three blind mice,\n  # see how they run.\n  # They all ran after the farmer's wife\n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/core-2.6.3/String.html#method-i-index\" rel=\"nofollow noreferrer\">String#index</a>.</p>\n\n<p>If you only want to pass the portion of the string since the previous newline, change the line:</p>\n\n<pre><code>action str[0..i-1]\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>action str[start_idx..i-1]\n</code></pre>\n"}], "owner": {"reputation": 597, "user_id": 10239403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fbdaea0dedd13b281fb7e70665efe4?s=128&d=identicon&r=PG", "display_name": "Demian Sims", "link": "https://stackoverflow.com/users/10239403/demian-sims"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "closed_date": 1576588949, "accepted_answer_id": 59365451, "answer_count": 1, "score": -2, "last_activity_date": 1576549612, "creation_date": 1576536234, "question_id": 59365280, "link": "https://stackoverflow.com/questions/59365280/how-does-ruby-detect-a-carriage-return-in-a-string", "closed_reason": "Needs more focus", "title": "How does Ruby detect a carriage return in a string?", "body": "<p>I'm iterating through a large string that has several carriage returns. I'd like my logic to do something every time a carriage return is discovered (create a new ActiveRecord instance with all the string content before the carriage return). </p>\n"}, {"tags": ["ruby", "macos", "terminal", "rubygems", "jekyll"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1576532155, "post_id": 59364423, "comment_id": 104922955, "body": "Install RVM with <code>\\curl -sSL https:&#47;&#47;get.rvm.io | bash -s stable</code>; restart your shell; install Ruby with <code>rvm install 2.6.0</code>. <a href=\"https://robots.thoughtbot.com/psa-do-not-use-system-ruby\" rel=\"nofollow noreferrer\">Don&#39;t</a> <a href=\"https://chrisherring.co/posts/why-you-shouldn-t-use-the-system-ruby\" rel=\"nofollow noreferrer\">use</a> <a href=\"http://billpatrianakos.me/blog/2014/05/15/never-use-system-ruby-ever/\" rel=\"nofollow noreferrer\">system Ruby</a>."}, {"owner": {"reputation": 46692, "user_id": 1548376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCZQw.gif?s=128&g=1", "display_name": "David Jacquel", "link": "https://stackoverflow.com/users/1548376/david-jacquel"}, "edited": false, "score": 1, "creation_date": 1576557273, "post_id": 59364423, "comment_id": 104928776, "body": "Alternatively to rvm you can use <a href=\"https://github.com/rbenv/rbenv\" rel=\"nofollow noreferrer\">rbenv</a>."}, {"owner": {"reputation": 2607, "user_id": 7122272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vVmXn.jpg?s=128&g=1", "display_name": "Jaroslav Bezd\u011bk", "link": "https://stackoverflow.com/users/7122272/jaroslav-bezd%c4%9bk"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1576570311, "post_id": 59364423, "comment_id": 104932828, "body": "@anothermh, thank you for your help. I tried, what you suggested. After that, I tried to build an app with <code>jekyll build</code>, but another load error showed up: <code>&#47;Users&#47;JaroslavBezdek&#47;.rvm&#47;rubies&#47;ruby-2.6.0&#47;lib&#47;ruby&#47;site_r&zwnj;&#8203;uby&#47;2.6.0&#47;rubygems&#47;c&zwnj;&#8203;ore_ext&#47;kernel_requi&zwnj;&#8203;re.rb:54:in &#39;require&#39;: cannot load such file -- pathutil (LoadError)</code>. Please, do you know, how to solve this?"}, {"owner": {"reputation": 1141, "user_id": 3251463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hxssB.png?s=128&g=1", "display_name": "Scott Schupbach", "link": "https://stackoverflow.com/users/3251463/scott-schupbach"}, "edited": false, "score": 0, "creation_date": 1576615650, "post_id": 59364423, "comment_id": 104955636, "body": "Is this your first time running it locally? And does your project have a Gemfile?"}], "owner": {"reputation": 2607, "user_id": 7122272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vVmXn.jpg?s=128&g=1", "display_name": "Jaroslav Bezd\u011bk", "link": "https://stackoverflow.com/users/7122272/jaroslav-bezd%c4%9bk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1811, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576534854, "creation_date": 1576531028, "last_edit_date": 1576534854, "question_id": 59364423, "link": "https://stackoverflow.com/questions/59364423/ruby-in-require-cannot-load-such-file-safe-yaml-load-loaderror", "title": "Ruby: in `require&#39;: cannot load such file -- safe_yaml/load (LoadError)", "body": "<p>When I want to change content of the web page, I go to my local project directory and I run two commands:</p>\n\n<pre><code>jekyll build\njekyll serve\n</code></pre>\n\n<p>After that, my web app is running locally on my machine. When I tried to run the above commands today, I got stuck on the first of them, because the following error appeared:</p>\n\n<pre><code>$ jekyll build\nTraceback (most recent call last):\n    5: from /usr/local/bin/jekyll:8:in `&lt;main&gt;'\n    4: from /Library/Ruby/Site/2.6.0/rubygems/core_ext/kernel_require.rb:92:in `require'\n    3: from /Library/Ruby/Site/2.6.0/rubygems/core_ext/kernel_require.rb:92:in `require'\n    2: from /Users/JaroslavBezdek/.gem/ruby/2.3.0/gems/jekyll-3.8.5/lib/jekyll.rb:34:in `&lt;top (required)&gt;'\n    1: from /Library/Ruby/Site/2.6.0/rubygems/core_ext/kernel_require.rb:92:in `require'\n/Library/Ruby/Site/2.6.0/rubygems/core_ext/kernel_require.rb:92:in `require': cannot load such file -- safe_yaml/load (LoadError)\n</code></pre>\n\n<p>I started to look it up on the internet and found I should try to install the missing library. However, it didn't solve the problem, because the other error showed up:</p>\n\n<pre><code>$ gem install safe_yaml\nERROR:  While executing gem ... (Gem::FilePermissionError)\n    You don't have write permissions for the /Library/Ruby/Gems/2.6.0 directory.\n$ sudo gem install safe_yaml\nPassword:\nERROR:  While executing gem ... (Gem::FilePermissionError)\n    You don't have write permissions for the /usr/bin directory.\n</code></pre>\n\n<p>My environment could be described as following:</p>\n\n<pre><code>$ ruby --version\nruby 2.6.3p62 (2019-04-16 revision 67580) [universal.x86_64-darwin19]\n$ gem --version\n3.1.1\n$ sw_vers\nProductName:    Mac OS X\nProductVersion: 10.15.1\nBuildVersion:   19B88\n</code></pre>\n\n<p>Please, could you help me, how to solve the problem?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "installation"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 1, "creation_date": 1576529879, "post_id": 59363292, "comment_id": 104922143, "body": "What does the folder structure look like under <code>my-project</code> after you ran <code>rails new my-project</code>?"}, {"owner": {"reputation": 634, "user_id": 1199793, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/339b1b14c371fc2e607967663f93e1e4?s=128&d=identicon&r=PG", "display_name": "bpromas", "link": "https://stackoverflow.com/users/1199793/bpromas"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1576585905, "post_id": 59363292, "comment_id": 104940997, "body": "Only .gitignore, .ruby-version, config.ru, Gemfile, Rakefile and README.md and nothing else."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1576588666, "post_id": 59363292, "comment_id": 104942434, "body": "That certainly seems abnormal. I don&#39;t think it&#39;s a <code>rails</code> or <code>ruby</code> tool version issue. Perhaps some kind of configuration issue somewhere. Perhaps you could give some background on how you installed the tools in your question (edit the question and provide the info from your comment as well as the tool info)."}, {"owner": {"reputation": 634, "user_id": 1199793, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/339b1b14c371fc2e607967663f93e1e4?s=128&d=identicon&r=PG", "display_name": "bpromas", "link": "https://stackoverflow.com/users/1199793/bpromas"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1576591474, "post_id": 59363292, "comment_id": 104944115, "body": "I used the ruby installer and then simply ran <code>gem install rails</code> to get Rails. I added this, as well as my previous comment, to the question. You think it can have something to do with user permissions for the OS?"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1576592756, "post_id": 59363292, "comment_id": 104944883, "body": "I don&#39;t believe it&#39;s a permissions issue. I don&#39;t recall how I installed Ruby on my Windows 10 system. I have a <code>C:\\Ruby25-x64</code> folder where all the Ruby goodies are. I just did a <code>gem install rails</code> and waited to make sure there were no errors on that install. Then did a <code>rails new foo</code> and it created all the expected application folders and files. The only thing I can think of off-hand is to ask if you&#39;re sure the <code>rails</code> gem installed without error, but that is a bit of a stab in the dark since I wouldn&#39;t expected it to &quot;partially succeed&quot; at creating a project."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 1, "creation_date": 1576592974, "post_id": 59363292, "comment_id": 104945007, "body": "Did your <code>rails new my-project</code> stop right after <code>run  git init from &quot;.&quot;</code> with no error and return to the prompt? After <code>run  git init from &quot;.&quot;</code> mine continues starting with <code>Initialized empty Git repository in C:&#47;Users&#47;MyName&#47;Documents&#47;Projects&#47;foo&#47;.git&#47;</code> (I had done <code>rails new foo</code>). You didn&#39;t mention <code>.git</code> as one of the created folders, so it apparently died quietly trying to create it. Go to <code>my-project</code> and try the <code>git init</code> by hand and see if it has issues."}, {"owner": {"reputation": 634, "user_id": 1199793, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/339b1b14c371fc2e607967663f93e1e4?s=128&d=identicon&r=PG", "display_name": "bpromas", "link": "https://stackoverflow.com/users/1199793/bpromas"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1576594555, "post_id": 59363292, "comment_id": 104945893, "body": "Yes, it stops without an error, however I do not have git installed in this machine, and so if I try to run <code>git init</code> by hand it says git is not a recognized command. I don&#39;t remember reading that git is required to have rails, but regardless, I&#39;m probably going to install git and try again in a bit. Or maybe there is a way to skip using git altogether?"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1576594974, "post_id": 59363292, "comment_id": 104946112, "body": "Yes, that&#39;s likely your issue then. I don&#39;t know off-hand how to create a project without <code>git</code>. You could try a quick google search on it and see if something useful turns up."}], "answers": [{"tags": [], "owner": {"reputation": 1141, "user_id": 3251463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hxssB.png?s=128&g=1", "display_name": "Scott Schupbach", "link": "https://stackoverflow.com/users/3251463/scott-schupbach"}, "is_accepted": true, "score": 8, "last_activity_date": 1588199836, "last_edit_date": 1588199836, "creation_date": 1576615826, "answer_id": 59381889, "question_id": 59363292, "link": "https://stackoverflow.com/questions/59363292/rails-new-is-not-generating-any-of-my-projects-folders/59381889#59381889", "title": "&quot;rails new&quot; is not generating any of my project&#39;s folders", "body": "<p>Try appending <code>--skip-git</code> to your <code>rails new</code> command. This will get you going in the short term.</p>\n\n<p>Alternatively (and probably the better option in the long run), install <code>git</code>. The official Git documentation install instructions can be found here: <a href=\"https://git-scm.com/book/en/v2/Getting-Started-Installing-Git\" rel=\"nofollow noreferrer\">https://git-scm.com/book/en/v2/Getting-Started-Installing-Git</a></p>\n"}, {"comments": [{"owner": {"reputation": 4356, "user_id": 1164954, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/67f0c44837a0f107b54f0a960943304c?s=128&d=identicon&r=PG", "display_name": "svz", "link": "https://stackoverflow.com/users/1164954/svz"}, "edited": false, "score": 0, "creation_date": 1581167337, "post_id": 59525473, "comment_id": 106344289, "body": "OMG, I wasted so much time trying to figure it out!"}], "tags": [], "owner": {"reputation": 361, "user_id": 4748796, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/8v7Es.jpg?s=128&g=1", "display_name": "Peyu", "link": "https://stackoverflow.com/users/4748796/peyu"}, "is_accepted": false, "score": 4, "last_activity_date": 1588264380, "last_edit_date": 1588264380, "creation_date": 1577677414, "answer_id": 59525473, "question_id": 59363292, "link": "https://stackoverflow.com/questions/59363292/rails-new-is-not-generating-any-of-my-projects-folders/59525473#59525473", "title": "&quot;rails new&quot; is not generating any of my project&#39;s folders", "body": "<p>I have the same issue.  Thanks to Scott Schupbach answer I realize that I didn't Install git, because I was working in a fresh ubuntu 19.10 installation. </p>\n\n<p>So for anyone with the same issue, just install git.</p>\n\n<p>In Ubuntu (or other Debian-based Linux distribution) just type:</p>\n\n<pre><code>sudo apt install git\n</code></pre>\n\n<p>On Mac (using Homebrew):</p>\n\n<pre><code>brew install git\n</code></pre>\n\n<p>For Windows, non-Debian Linux systems, and alternative Mac installer options, see the official Git installation documentation: <a href=\"https://git-scm.com/book/en/v2/Getting-Started-Installing-Git\" rel=\"nofollow noreferrer\">https://git-scm.com/book/en/v2/Getting-Started-Installing-Git</a></p>\n\n<p>And that's all.</p>\n\n<p>Best Regards!!</p>\n"}, {"comments": [{"owner": {"reputation": 1141, "user_id": 3251463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hxssB.png?s=128&g=1", "display_name": "Scott Schupbach", "link": "https://stackoverflow.com/users/3251463/scott-schupbach"}, "edited": false, "score": 0, "creation_date": 1588200039, "post_id": 60102261, "comment_id": 108812578, "body": "This is the nuclear option. I wouldn&#39;t recommend this approach unless you&#39;ve exhausted all other options. For most people, step 3 alone will be sufficient. But just blindly doing all of this is kind of like trying to open a walnut with a sledge hammer."}], "tags": [], "owner": {"reputation": 1, "user_id": 12854307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a49c17929a04112c8d282db479c003d2?s=128&d=identicon&r=PG&f=1", "display_name": "kayzredamn", "link": "https://stackoverflow.com/users/12854307/kayzredamn"}, "is_accepted": false, "score": 0, "last_activity_date": 1581017445, "creation_date": 1581017445, "answer_id": 60102261, "question_id": 59363292, "link": "https://stackoverflow.com/questions/59363292/rails-new-is-not-generating-any-of-my-projects-folders/60102261#60102261", "title": "&quot;rails new&quot; is not generating any of my project&#39;s folders", "body": "<ol>\n<li>uninstall rails </li>\n<li>delete the project folder</li>\n<li>install git with sudo - \"sudo apt install git\"</li>\n<li>reinstall rails - \"gem install rails\"</li>\n<li>create the project folder again and do the cd command to be in the new folder</li>\n<li>Run the command again- \"rails new [project name]\"</li>\n</ol>\n"}], "owner": {"reputation": 634, "user_id": 1199793, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/339b1b14c371fc2e607967663f93e1e4?s=128&d=identicon&r=PG", "display_name": "bpromas", "link": "https://stackoverflow.com/users/1199793/bpromas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1886, "favorite_count": 1, "accepted_answer_id": 59381889, "answer_count": 3, "score": 1, "last_activity_date": 1588264380, "creation_date": 1576525412, "last_edit_date": 1576593286, "question_id": 59363292, "link": "https://stackoverflow.com/questions/59363292/rails-new-is-not-generating-any-of-my-projects-folders", "title": "&quot;rails new&quot; is not generating any of my project&#39;s folders", "body": "<p>I have downloaded Ruby, and installed the rails gem, then I attempt to run <code>rails new my-project</code> and all I get is this:</p>\n\n<pre><code>c:\\Projects&gt;rails new my-project\n  create\n  create  README.md\n  create  Rakefile\n  create  .ruby-version\n  create  config.ru\n  create  .gitignore\n  create  Gemfile\n    run  git init from \".\"\n</code></pre>\n\n<p>When I open the <code>my-project</code> folder that rails created for me what I find in it is only:</p>\n\n<pre><code>.gitignore\n.ruby-version\nconfig.ru\nGemfile\nRakefile\nREADME.md\n</code></pre>\n\n<p>and nothing else.</p>\n\n<p>This is not what I got when testing this at home, and it's not what any guide says I should get. I have exactly zero folders generated by rails, it's nowhere near what I need to start development. I don't think I'm missing any installations. Here are the versions of ruby and of rails:</p>\n\n<pre><code>c:\\Projects&gt;ruby -v\nruby 2.6.5p114 (2019-10-01 revision 67812) [x64-mingw32]\n\nc:\\Projects&gt;rails -v\nRails 6.0.2\n</code></pre>\n\n<p>IIRC I installed Ruby using the Windows Ruby Installer at rubyinstaller.org, the latest version with Devkit, then I simply ran <code>gem install rails</code> to get Rails.</p>\n\n<p>The only thing I can think of is that my user does not have admin privileges in this computer, but when I try to Google if this is a requirement, all Google gives me is how to implement admin stuff in my app.</p>\n"}, {"tags": ["ruby", "each", "break"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1576524859, "post_id": 59363043, "comment_id": 104920148, "body": "What exactly are you trying? What are the input values you&#39;re using and the expected output?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1576536870, "post_id": 59363043, "comment_id": 104924629, "body": "You need to clarify the problem you are trying to solve, and improve the title. One or two examples (that included the desired return value) would be helpful, but that is no substitute for a clear statement of the problem in words."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 12168816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ro0g0.png?s=128&g=1", "display_name": "cecileRx", "link": "https://stackoverflow.com/users/12168816/cecilerx"}, "edited": false, "score": 0, "creation_date": 1576580983, "post_id": 59364160, "comment_id": 104938545, "body": "Thanks for guiding me to the most rubyish way to solve the basic problem. I love this language even more!"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "reply_to_user": {"reputation": 75, "user_id": 12168816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ro0g0.png?s=128&g=1", "display_name": "cecileRx", "link": "https://stackoverflow.com/users/12168816/cecilerx"}, "edited": false, "score": 0, "creation_date": 1576598161, "post_id": 59364160, "comment_id": 104947879, "body": "Glad to help! If my answer solved your problem feel free to mark it as accepted and/or give it an upvote. :)"}], "tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": false, "score": 1, "last_activity_date": 1576531070, "last_edit_date": 1576531070, "creation_date": 1576529689, "answer_id": 59364160, "question_id": 59363043, "link": "https://stackoverflow.com/questions/59363043/breaking-out-an-each-iteration-if-false-but-return-true-in-other-case-ruby/59364160#59364160", "title": "Breaking out an each iteration if false but return true in other case ruby", "body": "<p>The <code>each</code> method returns its receiver\u2014i.e. the object you called it on\u2014so your <code>permutation?</code> method is returning <code>false</code> when you <code>break</code> and <code>chars_a</code> otherwise.</p>\n\n<p>There are lots of ways you could solve this. You could create a variable outside the block and set it to <code>true</code> or <code>false</code>, then return the variable at the end of the method:</p>\n\n<pre><code>def permutation?(a, b)\n  chars_a = a.chars.group_by {|char| char }\n  chars_b = b.chars.group_by {|char| char }\n\n  result = true\n  chars_a.each do |k, v|\n    unless chars_b.key?(k) &amp;&amp; chars_b[k].size == v.size\n      result = false\n      break\n    end\n  end\n\n  result\nend\n</code></pre>\n\n<p>You could also use <code>return false</code> instead of <code>break false</code> inside the block, and then return <code>true</code> otherwise:</p>\n\n<pre><code>def permutation?(a, b)\n  chars_a = a.chars.group_by {|char| char }\n  chars_b = b.chars.group_by {|char| char }\n\n  chars_a.each do |k, v|\n    return false unless chars_b.key?(k) &amp;&amp; chars_b[k].size == v.size\n  end\n\n  true\nend\n</code></pre>\n\n<p>Neither of these is very Rubyish, though. A more idiomatic solution would be to replace <code>each</code> with a method that returns <code>true</code> or <code>false</code>. In this <a href=\"https://ruby-doc.org/core-2.6.5/Enumerable.html#method-i-all-3F\" rel=\"nofollow noreferrer\"><code>all?</code></a> is a perfect fit. It returns <code>true</code> if the block evaluates to a truthy value for every item, and <code>false</code> otherwise:</p>\n\n<pre><code>def permutation?(a, b)\n  chars_a = a.chars.group_by {|char| char }\n  chars_b = b.chars.group_by {|char| char }\n\n  chars_a.all? do |k, v|\n    chars_b.key?(k) &amp;&amp; chars_b[k].size == v.size\n  end\nend\n</code></pre>\n\n<p>However, there's an error in your logic. Your method checks if <code>b</code> contains all of the characters of <code>a</code>, but not the other way around.</p>\n\n<pre><code>permutation?(\"antler\", \"rentals\")\n# =&gt; true\n\npermutation?(\"rentals\", \"antler\")\n# =&gt; false\n</code></pre>\n\n<p>That's because you check if <code>b</code> contains all of the characters of <code>a</code>, but not the other around. An easy fix is to make it bail out early if the inputs aren't the same size:</p>\n\n<pre><code>def permutation?(a, b)\n  return false unless a.size == b.size\n\n  chars_a = a.chars.group_by {|char| char }\n  chars_b = b.chars.group_by {|char| char }\n\n  chars_a.all? do |k, v|\n    chars_b.key?(k) &amp;&amp; chars_b[k].size == v.size\n  end\nend\n</code></pre>\n\n<p>Although a more succinct\u2014but slower\u2014solution would be to just check if <code>chars_a</code> and <code>chars_b</code> have the same keys and values, which Ruby makes very easy:</p>\n\n<pre><code>def permutation?(a, b)\n  a.chars.group_by {|char| char } === b.chars.group_by {|char| char }\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1576536743, "last_edit_date": 1576536743, "creation_date": 1576535244, "answer_id": 59365153, "question_id": 59363043, "link": "https://stackoverflow.com/questions/59363043/breaking-out-an-each-iteration-if-false-but-return-true-in-other-case-ruby/59365153#59365153", "title": "Breaking out an each iteration if false but return true in other case ruby", "body": "<p>It appears to me that, given two strings, you wish to determine if the characters of the second are a permutation of the characters of the first, and vice-versa. If so, that can be done quite easily.</p>\n\n<pre><code>def permutation?(str1, str2)\n  str1.chars.sort == str2.chars.sort\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>permutation?('abc', 'cab')   #=&gt; true\npermutation?('aba', 'baa')   #=&gt; true\npermutation?('abc', 'caba')  #=&gt; false\npermutation?('', '')         #=&gt; true\n</code></pre>\n\n<p>This is another way that can be done:</p>\n\n<pre><code>def permutation?(str1, str2)\n  hashify(str1) == hashify(str2)\nend\n\ndef hashify(str)\n  str.each_char.with_object(Hash.new(0)) { |c,h| h[c] += 1 }\nend\n</code></pre>\n\n<p>Note that:</p>\n\n<pre><code>h1 = hashify('aba')     #=&gt; {\"a\"=&gt;2, \"b\"=&gt;1} \nh2 = hashify('baa')     #=&gt; {\"b\"=&gt;1, \"a\"=&gt;2} \nh1 == h2                #=&gt; true \n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/core-2.6.3/Hash.html#method-c-new\" rel=\"nofollow noreferrer\">Hash::new</a>, specifically the (second) form that takes an argument (here zero) equal to the <em>default value</em>. All that means is that if a hash that had been defined <code>h = Hash.new(0)</code> has no key <code>k</code>, <code>h[k]</code> will return <code>0</code>. For reasons explained below, this is sometimes called a <em>counting hash</em>.</p>\n\n<p>Ruby parses the expression <code>h[k] += 1</code> to:</p>\n\n<pre><code>h[k] = h[k] + 1\n</code></pre>\n\n<p>If <code>h</code> has no key <code>k</code>, <code>h[k]</code> on the right will return <code>0</code>, so <code>h[k]</code> will be set equal to <code>1</code>. Thereafter, for that key <code>k</code>, <code>h[k]</code> on the right will have a positive value which will be incremented by <code>1</code>.</p>\n"}], "owner": {"reputation": 75, "user_id": 12168816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ro0g0.png?s=128&g=1", "display_name": "cecileRx", "link": "https://stackoverflow.com/users/12168816/cecilerx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 463, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1576536743, "creation_date": 1576524052, "question_id": 59363043, "link": "https://stackoverflow.com/questions/59363043/breaking-out-an-each-iteration-if-false-but-return-true-in-other-case-ruby", "title": "Breaking out an each iteration if false but return true in other case ruby", "body": "<p>I have this basic issue, I want my function to return true if the input strings are a permutation, and false otherwise. I have a very ugly solution and I would prefer to do something like this:</p>\n\n<pre><code>def permutation?(a, b)\n  p chars_a = a.split('').group_by { |char| char }\n  p chars_b = b.split('').group_by { |char| char }\n  chars_a. each do |k, v|\n    break false unless (chars_b.key?(k) &amp;&amp; chars_b[k].count == v.count)\n  end\nend\n</code></pre>\n\n<p>The problem is when I run the tests the function doesn't return true when it is. It's a  basic syntax problem I guess.. Can you help?</p>\n\n<p>The ugly solution :</p>\n\n<pre><code>def permutation?(a, b)\n  p chars_a = a.split('').group_by { |char| char }\n  p chars_b = b.split('').group_by { |char| char }\n  sorry = []\n  chars_a. each do |k, v|\n    if b = chars_b.key?(k) &amp;&amp; chars_b[k].count == v.count\n      b = true\n    else\n      b = false\n    end\n    sorry &lt;&lt; b\n  end\n  if sorry.include?(false)\n     false\n  else\n    true\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-6"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1576521648, "post_id": 59362302, "comment_id": 104918891, "body": "Ah now I see whats happening here. Validations in associated models are not automatically run when you save the parent. You need to use <code>validates_associated</code> to trigger the validations of associated models. You could also just do <code>machine.product_ids=[1, 2, 3, 5, 8]</code> instead of manually creating the join models."}, {"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1576522063, "post_id": 59362302, "comment_id": 104919064, "body": "@max Thanks for your response. I can verify that the validation is indeed running. The validation also runs correctly when I attempt to execute the exact same code a second time. I believe the problem is that the <code>scope</code> attribute triggers a <code>where</code> clause that checks for <code>product_ids</code> in a query and since my products have not been created yet and are created in a single transaction, they are not validated against the unsaved records which still seems strange. I did try adding <code>validates_associated</code> but I still had the same results."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1576524745, "post_id": 59362302, "comment_id": 104920112, "body": "&quot; and since my products have not been created yet and are created in a single transaction&quot; how can you then have product ids?"}], "answers": [{"comments": [{"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "edited": false, "score": 0, "creation_date": 1576521265, "post_id": 59362419, "comment_id": 104918731, "body": "You are correct by saying that I am trying to validate that a machine can only be linked to a specific product once. How do you suggest I constrain differently?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "edited": false, "score": 0, "creation_date": 1576526343, "post_id": 59362419, "comment_id": 104920742, "body": "If you want one and only one link per machine you need to flip the uniqueness verification: Verify that <code>machine_id</code> is unique, no scope. If you want any number of links between machine and product, but only one of each distinct pair, then you should add a <code>UNIQUE</code> constraint on that table on <code>machine_id,product_id</code> to ensure only one instance of each pair exists."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 0, "last_activity_date": 1576521121, "creation_date": 1576521121, "answer_id": 59362419, "question_id": 59362302, "link": "https://stackoverflow.com/questions/59362302/rails-6-uniqueness-validation-not-working/59362419#59362419", "title": "Rails 6 Uniqueness Validation Not Working", "body": "<p>You're validating that for any given machine it can only link to the same product once. You're not validating that you can only link one machine to one product.</p>\n\n<p>Normally these sorts of join tables have a <code>UNIQUE</code> constraint as well to be sure you don't have duplicate links.</p>\n\n<p>If you're trying to enforce one link and one link only, making that table effectively a one-to-one, you need to constrain differently.</p>\n"}], "owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 360, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576521121, "creation_date": 1576520644, "question_id": 59362302, "link": "https://stackoverflow.com/questions/59362302/rails-6-uniqueness-validation-not-working", "title": "Rails 6 Uniqueness Validation Not Working", "body": "<p>I am having problems with the uniqueness validator in Rails 6 when I use the <code>scope</code> attribute. </p>\n\n<p>I have a many-to-many relationship between <code>Product</code> and <code>Machine</code>. My join table is called <code>ProductMachine</code>. </p>\n\n<p>In my join table I have the following validation:</p>\n\n<pre><code>validates :product_id, uniqueness: { scope: :machine }\n</code></pre>\n\n<p>I am building an import tool that allows me to create the associations for products and machines via a csv import. In this import, I have code that creates new records like this:</p>\n\n<pre><code>machine = Machine.first\nmachine.product_machines.new(product_id: 1234)\nmachine.product_machines.new(product_id: 1234)\nmachine.product_machines.new(product_id: 5678)\nmachine.save!\n</code></pre>\n\n<p>When I call <code>machine.save!</code> the new <code>product_machines</code> are inserted into the database and the validation does not fail. If I run this same exact code a second time, it fails as expected. I assume this is because the <code>scope</code> is making a where clause in the validation which causes the new records to be missed since the are not persisted. How can this be fixed? Here is the documentation for the scoped validation. </p>\n\n<p><a href=\"https://guides.rubyonrails.org/active_record_validations.html#uniqueness\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/active_record_validations.html#uniqueness</a></p>\n"}, {"tags": ["regex", "ruby"], "comments": [{"owner": {"reputation": 19159, "user_id": 3600709, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/731c8c4c0029d3414563333de16b8977?s=128&d=identicon&r=PG&f=1", "display_name": "ctwheels", "link": "https://stackoverflow.com/users/3600709/ctwheels"}, "edited": false, "score": 1, "creation_date": 1576519942, "post_id": 59362081, "comment_id": 104918167, "body": "Does <a href=\"https://regex101.com/r/v7WSPd/1\" rel=\"nofollow noreferrer\">this</a>: <code>&quot;[^&quot;]+?(\\([^)]+\\))?&quot;</code> work for you?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1576520797, "post_id": 59362081, "comment_id": 104918532, "body": "Do you need to handle nested brackets?"}, {"owner": {"reputation": 13, "user_id": 12544068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87aa85e2549261318993dc048844743a?s=128&d=identicon&r=PG&f=1", "display_name": "photonrbbt", "link": "https://stackoverflow.com/users/12544068/photonrbbt"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1576522681, "post_id": 59362081, "comment_id": 104919331, "body": "@tadman, no, not required."}, {"owner": {"reputation": 13, "user_id": 12544068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87aa85e2549261318993dc048844743a?s=128&d=identicon&r=PG&f=1", "display_name": "photonrbbt", "link": "https://stackoverflow.com/users/12544068/photonrbbt"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1582305252, "post_id": 59362081, "comment_id": 106744545, "body": "@tadman, and now that I&#39;ve bumped into Example 5, yes, need to handle nested brackets."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1582314073, "post_id": 59362081, "comment_id": 106748218, "body": "I figured that day would arrive eventually."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12544068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87aa85e2549261318993dc048844743a?s=128&d=identicon&r=PG&f=1", "display_name": "photonrbbt", "link": "https://stackoverflow.com/users/12544068/photonrbbt"}, "edited": false, "score": 0, "creation_date": 1582270007, "post_id": 59362764, "comment_id": 106726237, "body": "I found a complication; I&#39;ve added it to the original question."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 0, "last_activity_date": 1576736742, "last_edit_date": 1592644375, "creation_date": 1576522707, "answer_id": 59362764, "question_id": 59362081, "link": "https://stackoverflow.com/questions/59362081/how-to-match-text-leading-up-to-an-optional-trailing-element/59362764#59362764", "title": "How to match text leading up to an optional trailing element", "body": "<p>You can use the following regular expression:</p>\n<pre><code>r = /.*[^ ](?= +(\\(.*\\))\\z)|.+/\n</code></pre>\n<h1><p></p></h1>\n<pre><code>&quot;Solaris&quot;.match r\n  #=&gt; #&lt;MatchData &quot;Solaris&quot; 1:nil&gt; \n&quot;Alice Guy-Blach\u00e9 (1873 \u2013 1968) \u2013 Hommage...der Welt&quot;.match r\n  # =&gt; #&lt;MatchData &quot;Alice Guy-Blach\u00e9 (1873 \u2013 1968) \u2013 Hommage...der Welt&quot; 1:nil&gt; \n&quot;Ieri, oggi, domani (Gestern, heute und morgen)&quot;.match r\n  #=&gt; #&lt;MatchData &quot;Ieri, oggi, domani&quot; 1:&quot;(Gestern, heute und morgen)&quot;&gt; \n&quot;Your life (in code) \u2013 A tribute     (L'ultimo hacker)&quot;.match r\n  #=&gt; #&lt;MatchData &quot;Your life (in code) \u2013 A tribute&quot; 1:&quot;(L'ultimo hacker)&quot;&gt; \n</code></pre>\n<p>The regular expression can be written in <em>free-spacing mode</em> to make it self-documenting.</p>\n<pre><code>r = /\n    .*         # match &gt;= 0 chars\n    [^ ]       # match a character other than a space \n    (?=        # begin positive lookahead\n      [ ]      # match one space\n      (        # start capture group 1 \n        \\(.*\\) # match a left paren, &gt;= 0 chars, right paren\n      )        # end capture group 1\n      \\z       # match end-of-string\n    )          # end positive lookahead\n    |          # or\n    .+         # match &gt; 0 chars (entire string)\n    /x         # free-spacing regex definition mode\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 12544068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87aa85e2549261318993dc048844743a?s=128&d=identicon&r=PG&f=1", "display_name": "photonrbbt", "link": "https://stackoverflow.com/users/12544068/photonrbbt"}, "edited": false, "score": 0, "creation_date": 1582532700, "post_id": 60365402, "comment_id": 106795977, "body": "I like the approach of going for balanced brackets. Realizing now, though, that there is no algorithmic way to decide whether <code>foo (bar)</code> is an original title <code>foo</code> with an alternative title <code>bar</code> or an original title <code>foo (bar)</code> \u2013 outside of language detection."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1582482587, "last_edit_date": 1582482587, "creation_date": 1582482212, "answer_id": 60365402, "question_id": 59362081, "link": "https://stackoverflow.com/questions/59362081/how-to-match-text-leading-up-to-an-optional-trailing-element/60365402#60365402", "title": "How to match text leading up to an optional trailing element", "body": "<p>Here is a solution that does not employ a regular expression. I expect it would be faster than the use of a single regular expression, but also easier to maintain if requirements change in future.</p>\n\n<pre><code>def pick_apart(str)\n  raise ArgumentError if str.count('(') != str.count(')')\n  return [str, ''] unless str.size &gt; 0 &amp;&amp; str.end_with?(')')\n  n = 1\n  idx = (str.size-2).downto(0).find do |i|\n    case str[i]\n    when ')'\n      n += 1\n      false\n    when '('\n      n -= 1\n      n.zero?\n    else\n      false\n    end\n  end\n  [str[0,idx], str[idx..-1]]\nend\n</code></pre>\n\n<p><code>idx</code> is the index of the character '(' that corresponds to ')'\n at the end of the string.</p>\n\n<h1><p></p></h1>\n\n<pre><code>pick_apart \"Solaris\"\n  #=&gt; [\"Solaris\", \"\"] \npick_apart \"Alice Guy-Blach\u00e9 (1873 \u2013 1968) \u2013 Hommage...der Welt\"\n  #=&gt; [\"Alice Guy-Blach\u00e9 (1873 \u2013 1968) \u2013 Hommage...der Welt\", \"\"] \npick_apart \"Ieri, oggi, domani (Gestern, heute und morgen)\"\n  #=&gt; [\"Ieri, oggi, domani \", \"(Gestern, heute und morgen)\"] \npick_apart \"Your life (in code) \u2013 A tribute     (L'ultimo hacker)\"\n  #=&gt; [\"Your life (in code) \u2013 A tribute     \", \"(L'ultimo hacker)\"] \npick_apart \"Birdman (The...Ignorance) (Birdman (Die unverhoffte))\"\n  #=&gt; [\"Birdman (The...Ignorance) \", \"(Birdman (Die unverhoffte))\"] \npick_apart \"Birdman (The (other) one) (Birdman (Die (other) one))\"\n  #=&gt; [\"Birdman (The (other) one) \", \"(Birdman (Die (other) one))\"] \npick_apart \"\"\n  #=&gt; [\"\", \"\"] \npick_apart \"(((hey)))\"\n  #=&gt; [\"\", \"(((hey)))\"] \npick_apart \"(((hey))\"\n  #=&gt; ArgumentError (ArgumentError)\npick_apart \"((hey)))\"\n  #=&gt; ArgumentError (ArgumentError)\npick_apart \")\"\n  #=&gt; ArgumentError (ArgumentError)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12544068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87aa85e2549261318993dc048844743a?s=128&d=identicon&r=PG&f=1", "display_name": "photonrbbt", "link": "https://stackoverflow.com/users/12544068/photonrbbt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 59362764, "answer_count": 2, "score": 1, "last_activity_date": 1582482587, "creation_date": 1576519548, "last_edit_date": 1582270404, "question_id": 59362081, "link": "https://stackoverflow.com/questions/59362081/how-to-match-text-leading-up-to-an-optional-trailing-element", "title": "How to match text leading up to an optional trailing element", "body": "<p>I am trying (with ruby) to pick apart strings with original film titles \u2013 which can include bracketed elements themselves \u2013 and may include a trailing bracketed element with an alternative title. I need to capture the leading part and the optional trailing alternative title, if present.</p>\n\n<p>Example strings:</p>\n\n<ol>\n<li>\"Solaris\"</li>\n<li>\"Alice Guy-Blach\u00e9 (1873 \u2013 1968) \u2013 Hommage an die erste Filmemacherin der Welt\"</li>\n<li>\"Ieri, oggi, domani (Gestern, heute und morgen)\"</li>\n<li>\"Your life (in code) \u2013 A tribute (L'ultimo hacker)\"</li>\n<li>\"Birdman or (The Unexpected Virtue of Ignorance) (Birdman oder (Die unverhoffte Macht der Ahnungslosigkeit))\"</li>\n</ol>\n\n<p>For example string 1 I'd want</p>\n\n<pre><code>#&lt;MatchData \"Solaris\" 1:nil&gt;\n</code></pre>\n\n<p>For example string 2 I'd want</p>\n\n<pre><code>#&lt;MatchData \"Alice Guy-Blach\u00e9 (1873 \u2013 1968) \u2013 Hommage an die erste Filmemacherin der Welt\" 1:nil&gt;\n</code></pre>\n\n<p>For example string 3 I'd want</p>\n\n<pre><code>#&lt;MatchData \"Ieri, oggi, domani\" 1:\"(Gestern, heute und morgen)\"&gt;\n</code></pre>\n\n<p>For example string 4 I'd want</p>\n\n<pre><code>#&lt;MatchData \"Your life (in code) \u2013 A tribute\" 1:\"(L'ultimo hacker)\"&gt;\n</code></pre>\n\n<p>For example string 5 I'd want</p>\n\n<pre><code>#&lt;MatchData \"Birdman or (The Unexpected Virtue of Ignorance)\" 1:\"(Birdman oder (Die unverhoffte Macht der Ahnungslosigkeit))\"&gt;\n</code></pre>\n\n<p><code>.+(?= (\\(.+\\)))</code> works for 3 and 4. It doesn't work for 1 and it breaks apart 2.</p>\n\n<p>How to make that optional trailing bracketed element optional in the regular expression?</p>\n\n<p>Example 5 has been added to the original question.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1576518726, "post_id": 59361654, "comment_id": 104917662, "body": "Please include the full error message and the especially the line that raises the error. Have you ensured that is not a typo such as <code>admin.name</code> instead of <code>@admin.name</code>?"}, {"owner": {"reputation": 97, "user_id": 12132223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d771bc90c127ff051746fe96cb03607f?s=128&d=identicon&r=PG&f=1", "display_name": "dw4050", "link": "https://stackoverflow.com/users/12132223/dw4050"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1576521107, "post_id": 59361654, "comment_id": 104918652, "body": "I used the instance variable, not the local variable in the mailer view. It&#39;s unable to find the object for some odd reason"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1576521348, "post_id": 59361654, "comment_id": 104918766, "body": "Why not show us the actual code that proves it instead of just asking us to guess what misstake you made? Nil errors are programmer error 99% of the time and there is no way we can help you without having the complete picture."}, {"owner": {"reputation": 97, "user_id": 12132223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d771bc90c127ff051746fe96cb03607f?s=128&d=identicon&r=PG&f=1", "display_name": "dw4050", "link": "https://stackoverflow.com/users/12132223/dw4050"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1576522577, "post_id": 59361654, "comment_id": 104919290, "body": "I fixed it, there was a referencing issue with adding the instance variable to the preview method."}], "answers": [{"tags": [], "owner": {"reputation": 97, "user_id": 12132223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d771bc90c127ff051746fe96cb03607f?s=128&d=identicon&r=PG&f=1", "display_name": "dw4050", "link": "https://stackoverflow.com/users/12132223/dw4050"}, "is_accepted": false, "score": 0, "last_activity_date": 1576522479, "creation_date": 1576522479, "answer_id": 59362712, "question_id": 59361654, "link": "https://stackoverflow.com/questions/59361654/instance-variable-doesnt-load-in-actionmailer-preview-rails-6/59362712#59362712", "title": "Instance variable doesn&#39;t load in actionmailer preview Rails 6", "body": "<p>The instance variable was not being referenced correctly. It had to be referenced in the normal method, but not in the preview method</p>\n"}], "owner": {"reputation": 97, "user_id": 12132223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d771bc90c127ff051746fe96cb03607f?s=128&d=identicon&r=PG&f=1", "display_name": "dw4050", "link": "https://stackoverflow.com/users/12132223/dw4050"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576522479, "creation_date": 1576517633, "last_edit_date": 1576522283, "question_id": 59361654, "link": "https://stackoverflow.com/questions/59361654/instance-variable-doesnt-load-in-actionmailer-preview-rails-6", "title": "Instance variable doesn&#39;t load in actionmailer preview Rails 6", "body": "<p>ActionMailer Preview is ignoring the instances of the objects that are being loaded into the view. I get nilclass even when an object exist. How do you load instance variables with actionmailer preview?</p>\n\n<p>contract_mailer_preview.rb</p>\n\n<h1>Preview all emails at</h1>\n\n<pre><code>http://localhost:3000/rails/mailers/contract_mailer\nclass ContractMailerPreview &lt; ActionMailer::Preview\n\n  def modification_request_notification\n    @process_owner = User.find(1)\n    @provider_contract = Contract.find_by_hash_id(\"JEmZGSJnyyeerbya\")\n\nContractMailer.modification_request_notification(@provider_contract,@process_owner)\n  end\nend\n</code></pre>\n\n<p>contract_mailer.rb</p>\n\n<pre><code> def modification_request_notification(provider_contract, admin)\n    @admin = admin\n    @contract = provider_contract\n    mail(to: @admin, subject: \"Modification Request(s) Available for Contract\")\n  end\n</code></pre>\n\n<p>server log error</p>\n\n<pre><code>ActionView::Template::Error (undefined method `name' for nil:NilClass):\n    381:                           &lt;table align=\"left\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"flexibleContainer\"&gt;\n    382:                             &lt;tr&gt;\n    383:                               &lt;td align=\"left\" valign=\"top\" class=\"textContent\"&gt;\n</code></pre>\n\n<p>undefined method `id' for nil:NilClass</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "erb"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1576518405, "post_id": 59361486, "comment_id": 104917535, "body": "Did you try with the default trim mode <code>&lt;% whatever -%&gt;</code>? You may need to create your template handler with the appropriate param as well."}], "answers": [{"tags": [], "owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "is_accepted": false, "score": 2, "last_activity_date": 1576526692, "last_edit_date": 1576526692, "creation_date": 1576517907, "answer_id": 59361709, "question_id": 59361486, "link": "https://stackoverflow.com/questions/59361486/how-to-eliminate-newlines-in-erb/59361709#59361709", "title": "How to eliminate newlines in erb", "body": "<p>In it's default mode, ERB treats the text very literally outside of the <code>&lt;% ... %&gt;</code> expressions. So think of your text as being a stream that looks like this:</p>\n\n<pre><code>&lt;% if true %&gt;&lt;LF&gt;&lt;%= 'bar' %&gt;&lt;LF&gt;&lt;% end %&gt;&lt;LF&gt;&lt;%= 'foo' %&gt;&lt;LF&gt;&lt;%= 'bar' %&gt;&lt;LF&gt;\n</code></pre>\n\n<p>As you can see, you'll get a line feed before \"bar\" and two line feeds before \"foo\". <em>I.e.</em>, the output will be:</p>\n\n<pre><code>&lt;blank line&gt;\nbar\n&lt;blank line&gt;\nfoo\nbar\n</code></pre>\n\n<p>The way around it is to use the \"trim mode\" option for <code>erb</code>. Write your file as:</p>\n\n<pre><code>&lt;% if true -%&gt;\n&lt;%= 'bar' %&gt;\n&lt;% end -%&gt;\n&lt;%= 'foo' %&gt;\n&lt;%= 'bar' %&gt;\n</code></pre>\n\n<p>Then call <code>erb -T - your_erb_file.erb</code></p>\n\n<pre><code>bar\nfoo\nbar\n</code></pre>\n\n<p>The <code>-T -</code> tells <code>erb</code> to remove the end of line if the line ends with <code>-%&gt;</code>. Leading whitespaces are removed if the <code>erb</code> directive starts with <code>&lt;%-</code>. See, for example, this <a href=\"https://www.mankier.com/1/erb\" rel=\"nofollow noreferrer\">manual page for <code>erb</code></a> for details.</p>\n"}], "owner": {"reputation": 1394, "user_id": 4214184, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8b4c95b51ca86c3a27f1a6515b11557e?s=128&d=identicon&r=PG", "display_name": "anemaria20", "link": "https://stackoverflow.com/users/4214184/anemaria20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1576526692, "creation_date": 1576516935, "question_id": 59361486, "link": "https://stackoverflow.com/questions/59361486/how-to-eliminate-newlines-in-erb", "title": "How to eliminate newlines in erb", "body": "<p>I'm trying to use ERB with a plain text file. Here's the content of the plain text file:</p>\n\n<pre><code>&lt;% if true %&gt;\n&lt;%= 'bar' %&gt;\n&lt;% end %&gt;\n&lt;%= 'foo' %&gt;\n&lt;%= 'bar' %&gt;\n</code></pre>\n\n<p>The result I get with ERB is:</p>\n\n<pre><code>bar\n\nfoo\nbar\n</code></pre>\n\n<p>The result I want to get is:</p>\n\n<pre><code>bar\nfoo\nbar\n</code></pre>\n\n<p>without the empty newlines before \"bar\" and \"foo\".</p>\n\n<p>Now, I know this is because ERB is configured (by default) to work with HTML files. What I want it to do is work with a plain text file in my case. I'm aware this is \"somehow\" possible because in Rails, when you work with Rails mailer to configure a plain text file, this doesn't happen.</p>\n\n<p>Here's the big picture of what I'm trying to do: I'm trying to write a plain text article, but have some Ruby code in-between. I figured I'd use ERB for this, but the first stumbling block I got was this.</p>\n"}, {"tags": ["ruby", "string", "escaping", "literals"], "comments": [{"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1576518764, "post_id": 59361228, "comment_id": 104917687, "body": "A single slash in a Ruby string is represented by two slashes. Two slashes become four slashes. And so on. The extra slashes are just a visual. If your regex doesn&#39;t work as expected the issue is elsewhere. How do you convert the string into a regex?"}, {"owner": {"reputation": 192, "user_id": 1767281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffee2c5ed78c424a77ef16f81c074bca?s=128&d=identicon&r=PG", "display_name": "Ryan Wood", "link": "https://stackoverflow.com/users/1767281/ryan-wood"}, "reply_to_user": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1576524889, "post_id": 59361228, "comment_id": 104920163, "body": "@cremno, I convert the array exactly the way I show in the example, except I&#39;m trying to map! in the escape characters to the array first because I can&#39;t figure out a way to .join them that incorporates the escape character."}], "answers": [{"tags": [], "owner": {"reputation": 192, "user_id": 1767281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffee2c5ed78c424a77ef16f81c074bca?s=128&d=identicon&r=PG", "display_name": "Ryan Wood", "link": "https://stackoverflow.com/users/1767281/ryan-wood"}, "is_accepted": false, "score": 0, "last_activity_date": 1576525309, "creation_date": 1576525309, "answer_id": 59363271, "question_id": 59361228, "link": "https://stackoverflow.com/questions/59361228/escaping-characters-trying-to-assemble-literal-strings-is-putting-double-slashes/59363271#59363271", "title": "escaping characters trying to assemble literal strings is putting double slashes in my string, how do I escape using a single slash?", "body": "<p>I actually found a way around it, but no proper explanation. You need to have the mapping occur with double quotes inside the .map as you generate the regex object:</p>\n\n<pre><code>regex = %r{[^#{markers.map {|a| \"\\\\\"+ a}.join('|').to_s}]*}\n=&gt; /[^\\%|\\!]*/\n</code></pre>\n"}], "owner": {"reputation": 192, "user_id": 1767281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffee2c5ed78c424a77ef16f81c074bca?s=128&d=identicon&r=PG", "display_name": "Ryan Wood", "link": "https://stackoverflow.com/users/1767281/ryan-wood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1576525309, "creation_date": 1576515897, "last_edit_date": 1576517903, "question_id": 59361228, "link": "https://stackoverflow.com/questions/59361228/escaping-characters-trying-to-assemble-literal-strings-is-putting-double-slashes", "title": "escaping characters trying to assemble literal strings is putting double slashes in my string, how do I escape using a single slash?", "body": "<p>I'm trying to put together some dynamic regex. For my test case I'm trying to put together the string \"/[^\\%|\\!]*/\" from an array of the pseudo-escape characters markers = [\"%\", \"!\"].</p>\n\n<p>The problem is from escaping the characters when concatenating the escape characters to the characters in the array:</p>\n\n<pre><code>markers.map {|a| \"\\\\#{a}\"} \n  =&gt; [\"\\\\%\", \"\\\\!\"]\nmarkers.map {|a| '\\' + a}  \n  =&gt; expects another line because it's only escaping the single quote to literal, and not closing the first chunk\nmarkers.map {|a| '\\\\' + a} \n  =&gt; [\"\\\\%\", \"\\\\!\"]\n</code></pre>\n\n<p>The closest I've gotten is attempt 3 from above. I can get the correct strings with puts, but when I try and assemble the regex, it comes in with the double slashes and won't match what I'm looking for:</p>\n\n<pre><code>regex = \"/[^#{markers.map {|a| '\\\\' + a}.join('|')}]*/\"\n  =&gt; \"/[^\\\\%|\\\\!]*/\"\n</code></pre>\n\n<p>How do I apply the escape character for use in a regular expression to the markers in an array when concatenating strings like this? Or, if there's a better way to go about this, what is it?</p>\n"}, {"tags": ["ruby", "integer"], "comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1576515403, "post_id": 59360983, "comment_id": 104916122, "body": "It means &quot;subtract one from the left operand&quot; (the left operand being<code>variable.to_i</code> in this case)"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1576517015, "post_id": 59360983, "comment_id": 104916884, "body": "It&#39;s inside the brackets because the value of the expression <code>variable.to_i - 1</code> is the desired index into the <code>class.all</code> array"}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1576567707, "post_id": 59361961, "comment_id": 104931691, "body": "Having <code>&lt;#Item id=1&gt;</code> and <code>Item.all</code> makes it look like a Rails example. Since this isn&#39;t a Rails question, you might want to turn that into a pure Ruby example instead."}], "tags": [], "owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "is_accepted": false, "score": 3, "last_activity_date": 1576518922, "creation_date": 1576518922, "answer_id": 59361961, "question_id": 59360983, "link": "https://stackoverflow.com/questions/59360983/what-does-minus-1-mean-after-calling-to-i/59361961#59361961", "title": "What does minus 1 mean after calling to_i?", "body": "<p>In Ruby <code>variable.to_i - 1</code> subtracts 1 from the value of <code>variable.to_i</code>.  </p>\n\n<p>When used in the context of an array, this is often done to get the desired index, since indices start at 0.</p>\n\n<p>For example, I have three items: <code>&lt;#Item id=1&gt;, &lt;#Item id=2&gt;, &lt;#Item id=3&gt;</code></p>\n\n<p>I can subtract one to get the index. </p>\n\n<pre><code>id = 3 \nItem.all[id - 1]  #=&gt; &lt;#Item id=3&gt;\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 11424599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32ebc6999730d2da3c52a765aef776c2?s=128&d=identicon&r=PG", "display_name": "mel", "link": "https://stackoverflow.com/users/11424599/mel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "closed_date": 1576619708, "answer_count": 1, "score": 0, "last_activity_date": 1576535165, "creation_date": 1576515019, "last_edit_date": 1576535165, "question_id": 59360983, "link": "https://stackoverflow.com/questions/59360983/what-does-minus-1-mean-after-calling-to-i", "closed_reason": "Needs details or clarity", "title": "What does minus 1 mean after calling to_i?", "body": "<pre><code>class.all[variable.to_i - 1]\n</code></pre>\n\n<p>Just trying to understand what \"- 1\" means after <code>to_i</code> and why it's between brackets.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 4, "creation_date": 1576514231, "post_id": 59360706, "comment_id": 104915460, "body": "<code>Float::MAX # =&gt; 1.7976931348623157e+308</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1576515809, "post_id": 59360706, "comment_id": 104916301, "body": "@SergioTulentsev what if I am still on Win32?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1576517349, "post_id": 59360706, "comment_id": 104917039, "body": "@AlekseiMatiushkin: then the constant would return the appropriate value for that platform, I imagine."}, {"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1576519331, "post_id": 59360706, "comment_id": 104917929, "body": "There&#39;s also <code>Float::INFINITY</code>. <code>Float::MAX</code> is only the maximum representable finite value. However it&#39;s not 100% clear what you mean by <code>float</code>/<code>Float</code>. Do you mean the C data type (usually IEEE 754 binary32/single format) or the Ruby class?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1576535670, "post_id": 59360706, "comment_id": 104924276, "body": "Unless you really don&#39;t care about precision, like <i>at all</i>, <b>don&#39;t use float</b>. Use fixed-point types, which in the database are like <code>DECIMAL(36,18)</code> for a lot of precision."}], "owner": {"reputation": 131, "user_id": 1418671, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6c9b23015dbbec9adb1a3592b60f78bc?s=128&d=identicon&r=PG", "display_name": "vrajb55", "link": "https://stackoverflow.com/users/1418671/vrajb55"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 352, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576522677, "creation_date": 1576514061, "last_edit_date": 1576522677, "question_id": 59360706, "link": "https://stackoverflow.com/questions/59360706/highest-value-of-float-variable-in-ruby", "title": "Highest value of float variable in Ruby", "body": "<p>I have two columns with quantity (Float) and serial_no (Int). Now I need to write the model validations for these columns.</p>\n\n<p>For serial_no, I added:</p>\n\n<pre><code>  validates_numericality_of :serial_no, {less_than_or_equal_to: 4294967295} #Max Integer value : 2**32 - 1\n</code></pre>\n\n<p>I am bit confused with quantity (float) value. What can be the maximum value for Float variable in Ruby?\nI found in few links as </p>\n\n<pre><code>340282300000000000000000000000000000000 / 3.402823E+38 / 3.40282347 * 10 ^38.\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "search", "rails-admin"], "comments": [{"owner": {"reputation": 3312, "user_id": 412528, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7a781dab51284428bf9a44f3e0c85b6a?s=128&d=identicon&r=PG", "display_name": "Guillermo Siliceo Trueba", "link": "https://stackoverflow.com/users/412528/guillermo-siliceo-trueba"}, "edited": false, "score": 0, "creation_date": 1576598460, "post_id": 59360381, "comment_id": 104948025, "body": "There&#39;s no easy way to configure rails admin to search on another table. I had to patch rails admin to allow custom scopes, see <a href=\"https://github.com/gotandem-io/rails_admin/commit/a9be59034736e7c57bc2f5b50a3c7675e979dba6#diff-dc54dd6b59865bf3c06fee459e42db5c\" rel=\"nofollow noreferrer\">github.com/gotandem-io/rails_admin/commit/&hellip;</a> and <a href=\"https://github.com/gotandem-io/rails_admin/commit/a9be59034736e7c57bc2f5b50a3c7675e979dba6#diff-a03278886bd22519d14b671f73b06e30\" rel=\"nofollow noreferrer\">github.com/gotandem-io/rails_admin/commit/&hellip;</a>"}, {"owner": {"reputation": 71, "user_id": 11924554, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-L1Dh7cHAh_w/AAAAAAAAAAI/AAAAAAAABko/S4r_WMPyRcs/photo.jpg?sz=128", "display_name": "rcarette", "link": "https://stackoverflow.com/users/11924554/rcarette"}, "reply_to_user": {"reputation": 3312, "user_id": 412528, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7a781dab51284428bf9a44f3e0c85b6a?s=128&d=identicon&r=PG", "display_name": "Guillermo Siliceo Trueba", "link": "https://stackoverflow.com/users/412528/guillermo-siliceo-trueba"}, "edited": false, "score": 0, "creation_date": 1576684113, "post_id": 59360381, "comment_id": 104980388, "body": "Not sure to understand what I have to do.  I need to add a javascript + some config into rails admin to do the job ? Is it not possible try to pass some query-string parameters and filter with a scope ?"}, {"owner": {"reputation": 3312, "user_id": 412528, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7a781dab51284428bf9a44f3e0c85b6a?s=128&d=identicon&r=PG", "display_name": "Guillermo Siliceo Trueba", "link": "https://stackoverflow.com/users/412528/guillermo-siliceo-trueba"}, "edited": false, "score": 0, "creation_date": 1576707032, "post_id": 59360381, "comment_id": 104990385, "body": "Never mind i just took a look at the latest version of rails admin and on version 2.0.0 they just added support for custom search <a href=\"https://github.com/sferik/rails_admin/wiki/Custom-Search\" rel=\"nofollow noreferrer\">github.com/sferik/rails_admin/wiki/Custom-Search</a>"}], "owner": {"reputation": 71, "user_id": 11924554, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-L1Dh7cHAh_w/AAAAAAAAAAI/AAAAAAAABko/S4r_WMPyRcs/photo.jpg?sz=128", "display_name": "rcarette", "link": "https://stackoverflow.com/users/11924554/rcarette"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576512899, "creation_date": 1576512899, "question_id": 59360381, "link": "https://stackoverflow.com/questions/59360381/rails-admin-perform-multi-search-on-tags", "title": "Rails Admin - Perform multi-search on tags", "body": "<p>I am using <code>Rails Admin</code> and I would like to perform a multi-search on tags. </p>\n\n<p>Here are my models : </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Article &lt; ApplicationRecord\n  has_many :category_tags, :dependent =&gt; :destroy\n  has_many :categories, through: :category_tags\nend\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class CategoryTag &lt; ApplicationRecord\n  belongs_to :article\n  belongs_to :category\nend\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Category &lt; ApplicationRecord\n  has_many :category_tags, :dependent =&gt; :destroy\n  has_many :articles, through: :category_tags\nend\n</code></pre>\n\n<p>I am working on the <code>admin/article</code> and I would like to filter with multi-tags :\nFor example, if I have some articles with <code>summer</code> &amp; <code>job</code> tags. I would like to filter all <code>articles</code> when I write <code>summer job</code> for the filter <code>categories</code></p>\n\n<p>Here is my <code>rails_admin.rb</code></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>config.model 'Article' do\n  list do\n    field :categories do\n      searchable ['name']\n    end\n  end\nend\n\n</code></pre>\n\n<p>Thanks for your help ! :) </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "shrine"], "comments": [{"owner": {"reputation": 558, "user_id": 7820436, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PKC7Uo8Wv2Q/AAAAAAAAAAI/AAAAAAAAG1E/liX1WQbbwZU/photo.jpg?sz=128", "display_name": "Thomas Koppensteiner", "link": "https://stackoverflow.com/users/7820436/thomas-koppensteiner"}, "edited": false, "score": 1, "creation_date": 1576537792, "post_id": 59360305, "comment_id": 104924893, "body": "Where do you call <code>read</code>? Can you please also add the spec file or at least the relevant parts of it?"}], "answers": [{"comments": [{"owner": {"reputation": 558, "user_id": 7820436, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PKC7Uo8Wv2Q/AAAAAAAAAAI/AAAAAAAAG1E/liX1WQbbwZU/photo.jpg?sz=128", "display_name": "Thomas Koppensteiner", "link": "https://stackoverflow.com/users/7820436/thomas-koppensteiner"}, "edited": false, "score": 0, "creation_date": 1576611517, "post_id": 59365574, "comment_id": 104953967, "body": "@jpac did you find this answer helpful? If so, please mark it as accepted. Please let me know, if you miss something or anything is unclear."}, {"owner": {"reputation": 69, "user_id": 8518731, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fKKrS.jpg?s=128&g=1", "display_name": "jpac", "link": "https://stackoverflow.com/users/8518731/jpac"}, "edited": false, "score": 1, "creation_date": 1576675694, "post_id": 59365574, "comment_id": 104975600, "body": "your solution worked. I&#39;ve also changed the code to use the <code>#open</code> before doing a read and ensure the file is closed at the end."}], "tags": [], "owner": {"reputation": 558, "user_id": 7820436, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PKC7Uo8Wv2Q/AAAAAAAAAAI/AAAAAAAAG1E/liX1WQbbwZU/photo.jpg?sz=128", "display_name": "Thomas Koppensteiner", "link": "https://stackoverflow.com/users/7820436/thomas-koppensteiner"}, "is_accepted": true, "score": 2, "last_activity_date": 1576538449, "creation_date": 1576538449, "answer_id": 59365574, "question_id": 59360305, "link": "https://stackoverflow.com/questions/59360305/shrine-cannot-read-an-attachment-a-second-time/59365574#59365574", "title": "Shrine - cannot read an attachment a second time", "body": "<p>Before you can read the content agian, you have to reset the \"read pointer\".\nYou can do this by calling <code>.rewind</code>.</p>\n\n<blockquote>\n  <p>Shrine is able to upload any IO-like object that implement methods #read, #rewind, #eof? and #close whose behaviour matches the IO class. </p>\n</blockquote>\n\n<p>For Details see the <a href=\"https://github.com/shrinerb/shrine/blob/a5ad5ac5f29c5c434ebdf6b934ade9afabcb0449/doc/getting_started.md#io-abstraction\" rel=\"nofollow noreferrer\">getting_started</a> and <a href=\"https://github.com/shrinerb/shrine/blob/ad270b8bb133c0f65c1d890d147f3b5ffa41e568/doc/retrieving_uploads.md#io-like-interface\" rel=\"nofollow noreferrer\">this examle</a>.</p>\n"}], "owner": {"reputation": 69, "user_id": 8518731, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fKKrS.jpg?s=128&g=1", "display_name": "jpac", "link": "https://stackoverflow.com/users/8518731/jpac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 59365574, "answer_count": 1, "score": 0, "last_activity_date": 1576538449, "creation_date": 1576512626, "question_id": 59360305, "link": "https://stackoverflow.com/questions/59360305/shrine-cannot-read-an-attachment-a-second-time", "title": "Shrine - cannot read an attachment a second time", "body": "<p>After migrating from Carrierwave to Shrine, some of the tests started to failed. I've noticed that when calling <code>#read</code> from the column where the Shrine uploader is mounted, it can only by called once. By doing a second <code>#read</code> will return an empty string. Maybe I'm missing some configuration but the same code works for Carrierwave (I know it is a different uploader but for what I'm experiencing migrating to Shrine needs very few/almost none changes to the codebase)</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># shrine.rb -&gt; for testing\nrequire \"shrine\"\nrequire \"shrine/storage/s3\"\nrequire \"shrine/storage/file_system\"\n\nShrine.plugin :activerecord\nShrine.plugin :cached_attachment_data\nShrine.plugin :determine_mime_type, analyzer: :mime_types\n\nShrine.storages = {\n    cache: Shrine::Storage::FileSystem.new(\n      \"public\",\n      prefix: \"tmp/cache\",\n    ),\n    store: Shrine::Storage::FileSystem.new(\n      \"public\",\n      prefix: \"tmp\",\n    ),\n  }\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code># carrierwave.rb -&gt; for testing\n\n...\n\nconfig.storage = :file\nconfig.enable_processing = false\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "sqlite", "controller", "version"], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 8133055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b914e4c107623cc7fae1e74174a24?s=128&d=identicon&r=PG", "display_name": "Sergio Ricardo", "link": "https://stackoverflow.com/users/8133055/sergio-ricardo"}, "is_accepted": false, "score": 1, "last_activity_date": 1576519045, "creation_date": 1576519045, "answer_id": 59361989, "question_id": 59358255, "link": "https://stackoverflow.com/questions/59358255/error-undefined-method-deprecation-warning-for-thorclass/59361989#59361989", "title": "Error: undefined method `deprecation_warning&#39; for Thor:Class", "body": "<p>I went through the same problem with this gem (thor) and it occurred after updating your version. For this version of Ruby I installed thor 0.20.3 and rails should work normally again.</p>\n"}], "owner": {"reputation": 11, "user_id": 12482095, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8TFYPHiC_FA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfgzmME3UMS7b_vWh8tps1D5GaUBA/photo.jpg?sz=128", "display_name": "lamia Tilsa", "link": "https://stackoverflow.com/users/12482095/lamia-tilsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576519045, "creation_date": 1576505087, "last_edit_date": 1576513645, "question_id": 59358255, "link": "https://stackoverflow.com/questions/59358255/error-undefined-method-deprecation-warning-for-thorclass", "title": "Error: undefined method `deprecation_warning&#39; for Thor:Class", "body": "<p>When I generate controller with command \"rails generate controller page index\" and I had this error, ruby 2.3.3p222, rails:Rails 3.2.22</p>\n\n<p><a href=\"https://i.stack.imgur.com/ANGKn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ANGKn.png\" alt=\"error message\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "google-search-console", "xml-sitemap"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1576504576, "post_id": 59358065, "comment_id": 104910506, "body": "Are you saying that there&#39;s nothing wrong with your code? The rake task runs without error, and the sitemap updates? Your question is purely in relation to google search console storing an outdated, cached version of your sitemap?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1576504710, "post_id": 59358065, "comment_id": 104910574, "body": "If the problem has got nothing to do with the code (ruby), then StackOverflow is probably the wrong place for the question."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1576504733, "post_id": 59358065, "comment_id": 104910584, "body": "Incidentally, there are plenty of tutorials online about removing stale sitemaps from google search console - e.g. <a href=\"https://kb.yoast.com/kb/submit-sitemap-search-engines/#google-submit\" rel=\"nofollow noreferrer\">this</a>. Does that answer your question?"}, {"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1576506061, "post_id": 59358065, "comment_id": 104911241, "body": "@TomLord yes my code is ok, rake task runs without any error"}, {"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1576506081, "post_id": 59358065, "comment_id": 104911250, "body": "I update the cache and add max-age=0 in that also"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1576574269, "post_id": 59358065, "comment_id": 104934709, "body": "So does <a href=\"https://kb.yoast.com/kb/submit-sitemap-search-engines/#google-submit\" rel=\"nofollow noreferrer\">this</a> answer your question?"}], "owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1590412592, "creation_date": 1576504416, "last_edit_date": 1590412592, "question_id": 59358065, "link": "https://stackoverflow.com/questions/59358065/sitemaps-not-updating-in-ruby-on-rails-sitemap-generator", "title": "Sitemaps not updating in ruby on rails sitemap_generator", "body": "<p>Using <code>sitemap_generator</code> to generate and update sitemaps in my app. It was working fine but from 1 year facing issue that after updating <code>sitemap.rb</code> dozens of times and <code>rake sitemap:refresh</code> that changes not appear on google search console and it stills show sitemap of old data.</p>\n\n<p>Is there anything I missing which not ping google ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1576500760, "post_id": 59356746, "comment_id": 104908510, "body": "<code>Invoice.find_by(extern_orderno: params[&#39;id&#39;])</code>. You really got to stop abusing the safe navigation operator - this is just going to bury a bunch of bugs everywhere. If <code>@invoice</code> is nil you should not be rendering the JSON in the first place. Return <code>head :404</code> instead and do some proper error handling in your ajax handler."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12545479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34b9fad4c45f8ea8d691f81d8ed39f1?s=128&d=identicon&r=PG&f=1", "display_name": "Holger", "link": "https://stackoverflow.com/users/12545479/holger"}, "edited": false, "score": 0, "creation_date": 1576501809, "post_id": 59356927, "comment_id": 104909031, "body": "I tried this, howevery the get command doesn&#39;t accept the format argument. :(  --&gt; ArgumentError: unknown keyword: format"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 11, "user_id": 12545479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34b9fad4c45f8ea8d691f81d8ed39f1?s=128&d=identicon&r=PG&f=1", "display_name": "Holger", "link": "https://stackoverflow.com/users/12545479/holger"}, "edited": false, "score": 0, "creation_date": 1576501877, "post_id": 59356927, "comment_id": 104909062, "body": "try to add it explicitly: <code>get &quot;&#47;tax_invoice&#47;#{invoice.extern_orderno}.json&quot;</code>"}, {"owner": {"reputation": 11, "user_id": 12545479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34b9fad4c45f8ea8d691f81d8ed39f1?s=128&d=identicon&r=PG&f=1", "display_name": "Holger", "link": "https://stackoverflow.com/users/12545479/holger"}, "edited": false, "score": 0, "creation_date": 1576502497, "post_id": 59356927, "comment_id": 104909411, "body": "Didn&#39;t work either. Got the unknown format exception."}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 11, "user_id": 12545479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34b9fad4c45f8ea8d691f81d8ed39f1?s=128&d=identicon&r=PG&f=1", "display_name": "Holger", "link": "https://stackoverflow.com/users/12545479/holger"}, "edited": false, "score": 0, "creation_date": 1576502804, "post_id": 59356927, "comment_id": 104909567, "body": "OK, found it - you need to set proper headers, <a href=\"https://relishapp.com/rspec/rspec-rails/docs/request-specs/request-spec#requesting-a-json-response\" rel=\"nofollow noreferrer\">see the docs</a>. Please check if it works and I&#39;ll update my answer."}, {"owner": {"reputation": 11, "user_id": 12545479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34b9fad4c45f8ea8d691f81d8ed39f1?s=128&d=identicon&r=PG&f=1", "display_name": "Holger", "link": "https://stackoverflow.com/users/12545479/holger"}, "edited": false, "score": 0, "creation_date": 1576503734, "post_id": 59356927, "comment_id": 104910066, "body": "Yep, I set the headers, but I got the same exception. When I called the API outside tests, I doesn&#39;t send an application header with the get request. But then, it works. It works not only for the RSpec tests..."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 1, "last_activity_date": 1576500332, "creation_date": 1576500332, "answer_id": 59356927, "question_id": 59356746, "link": "https://stackoverflow.com/questions/59356746/rspec-type-request-and-jb-gem/59356927#59356927", "title": "RSpec type request and jb gem", "body": "<p>Set format explicitly in your test request - otherwise it's set to default of <code>html</code>:</p>\n\n<pre><code>\n     it 'get pending tax invoice' do\n        invoice = FactoryBot.create(:invoice)\n        get \"/tax_invoice/#{invoice.extern_orderno}\", format: :json # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n        # ...\n    end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 11178322, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Wue-90GVfac/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc0odym4eHYR0QMdk-YepXI16mqeA/mo/photo.jpg?sz=128", "display_name": "Galbeeyutd Mok", "link": "https://stackoverflow.com/users/11178322/galbeeyutd-mok"}, "is_accepted": false, "score": 0, "last_activity_date": 1576503041, "last_edit_date": 1576503041, "creation_date": 1576500618, "answer_id": 59357002, "question_id": 59356746, "link": "https://stackoverflow.com/questions/59356746/rspec-type-request-and-jb-gem/59357002#59357002", "title": "RSpec type request and jb gem", "body": "<p>This normally happens when you're requests are in JS or in some other format, i haven't taken a look but its the following for JS:</p>\n\n<pre><code>         get \"/tax_invoice/#{invoice.extern_orderno}\", xhr:true\n</code></pre>\n\n<p>for a different format, place:</p>\n\n<pre><code>         get \"/tax_invoice/#{invoice.extern_orderno}\", format:json\n</code></pre>\n\n<p>Note that  if not specified it uses a html default , which is causing your error.</p>\n\n<p>See <a href=\"https://edgeguides.rubyonrails.org/testing.html#testing-xhr-ajax-requests\" rel=\"nofollow noreferrer\">link</a> for more info.</p>\n"}], "owner": {"reputation": 11, "user_id": 12545479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34b9fad4c45f8ea8d691f81d8ed39f1?s=128&d=identicon&r=PG&f=1", "display_name": "Holger", "link": "https://stackoverflow.com/users/12545479/holger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1576503041, "creation_date": 1576499656, "last_edit_date": 1576500396, "question_id": 59356746, "link": "https://stackoverflow.com/questions/59356746/rspec-type-request-and-jb-gem", "title": "RSpec type request and jb gem", "body": "<p>I'm using rspec to test my API. For creating the response of an get request I'm using the jb gem.</p>\n\n<p>Example:</p>\n\n<pre><code>RSpec.describe 'Tax Invoice API', type: :request do\n  describe 'GET /tax_invoice' do\n\n    context('when request is valid') {\n      it 'get pending tax invoice' do\n        invoice = FactoryBot.create(:invoice)\n        get \"/tax_invoice/#{invoice.extern_orderno}\"\n        # ...\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>controller:</p>\n\n<pre><code>def show\n   @invoice = Invoice.where(extern_orderno: params['id'])&amp;.first\nend\n</code></pre>\n\n<p>view(show.json.jb):</p>\n\n<pre><code># frozen_string_literal: true\n{\n    extern_orderno: params['id'],\n    status: @invoice.nil? ? 'NOT_AVAILABLE' : @invoice.status,\n    url: @invoice&amp;.url,\n    created_at: @invoice&amp;.created_at,\n    address: @invoice&amp;.address&amp;.to_hash,\n    postal_address: @invoice&amp;.postal_address&amp;.to_hash\n}.compact\n</code></pre>\n\n<p>The construct works fine expect the test doesn't work. I getting always:</p>\n\n<pre><code>ActionController::UnknownFormat: TaxInvoiceController#show is missing a template for this request format and variant.\n\nrequest.formats: [\"text/html\"]\nrequest.variant: []\n</code></pre>\n\n<p>when I call the test. Someone an idea what I'm doing wrong?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "ruby-on-rails-4", "hash"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1576488284, "post_id": 59353109, "comment_id": 104902315, "body": "It means that <code>@token</code> is <code>nil</code>. In your controller, where does <code>@token</code> initially come from? If it is the result of <code>HTTParty.post(...)</code> you can of course not inspect it before fetching it. In that case, moveing the check below / after the <code>post</code> call should work."}, {"owner": {"reputation": 157, "user_id": 9322828, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215722452876336/picture?type=large", "display_name": "Damien Comp&#232;re", "link": "https://stackoverflow.com/users/9322828/damien-comp%c3%a8re"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1576493146, "post_id": 59353109, "comment_id": 104904764, "body": "thanks for your answer. Yes @token is the result of HTTParty.post(...). The thing is that I want to do the HTTParty.post only once the user land on my page, and not if he goes back to that page. If he goes back to this page, I have the error"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1576494287, "post_id": 59353109, "comment_id": 104905314, "body": "In order to do so, you have to store the token somewhere else. Maybe in the user&#39;s session, i.e. via a cookie?"}, {"owner": {"reputation": 157, "user_id": 9322828, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215722452876336/picture?type=large", "display_name": "Damien Comp&#232;re", "link": "https://stackoverflow.com/users/9322828/damien-comp%c3%a8re"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1576500287, "post_id": 59353109, "comment_id": 104908302, "body": "Yes, my token is stored in the LocalStorage. But can I access to the LocalStorage in Ruby ?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1576503267, "post_id": 59353109, "comment_id": 104909808, "body": "Unlike cookie data, the browser doesn&#39;t transfer local storage data to the server when requesting a page. So unless you explicitly send the data from the client side, the server isn&#39;t aware of it."}], "answers": [{"tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1576488208, "creation_date": 1576488208, "answer_id": 59353670, "question_id": 59353109, "link": "https://stackoverflow.com/questions/59353109/how-to-check-if-i-have-some-error-in-my-hash/59353670#59353670", "title": "How to check if I have some error in my hash", "body": "<p>It's OK in your view because you've assigned @token. Try:</p>\n\n<pre><code>if @token &amp;&amp; @token['error']\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 9322828, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215722452876336/picture?type=large", "display_name": "Damien Comp&#232;re", "link": "https://stackoverflow.com/users/9322828/damien-comp%c3%a8re"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576488208, "creation_date": 1576486007, "question_id": 59353109, "link": "https://stackoverflow.com/questions/59353109/how-to-check-if-i-have-some-error-in-my-hash", "title": "How to check if I have some error in my hash", "body": "<p>I try to check if I have an error in my token, \nIn my view it works like this and it seems to be Ok : </p>\n\n<pre><code>&lt;% if @token['error'].present?%&gt;\n    &lt;%= @token['error']%&gt; // display the message of the error\n    &lt;%= flash[:error]%&gt; //display ERROR\n    &lt;% else %&gt;\n    &lt;%= @token%&gt; // display the token\n    &lt;p&gt;Ok&lt;/p&gt;\n&lt;%end%&gt;\n</code></pre>\n\n<p>But in my controller, I can't do that : </p>\n\n<pre><code> if @token['error'].present?\n            flash[:error] = \"ERROR\"\n        else\n            @token = HTTParty.post('https://mooncard23-sandbox.biapi.pro/2.0/auth/token/access', \n                body: {\n                    client_id: XXXXXXXXXX,\n                    client_secret: \"YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY\",\n                    code: @decoded_code\n                }\n            ) \n end  \n</code></pre>\n\n<p>I have the error \"undefined method `[]' for nil:NilClass\". \nDo you know how to check if my token return an error ? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-admin"], "comments": [{"owner": {"reputation": 1135, "user_id": 182474, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f1b4c99243b0e9b58cd0b1558bd72aa5?s=128&d=identicon&r=PG", "display_name": "Gabor Garami", "link": "https://stackoverflow.com/users/182474/gabor-garami"}, "edited": false, "score": 1, "creation_date": 1576503716, "post_id": 59352873, "comment_id": 104910057, "body": "For your <code>unless</code> workaround, you can check it by <code>subject.is_a?(Profile)</code>. Much simpler and does not involve a costy equal check."}, {"owner": {"reputation": 71, "user_id": 11924554, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-L1Dh7cHAh_w/AAAAAAAAAAI/AAAAAAAABko/S4r_WMPyRcs/photo.jpg?sz=128", "display_name": "rcarette", "link": "https://stackoverflow.com/users/11924554/rcarette"}, "reply_to_user": {"reputation": 1135, "user_id": 182474, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f1b4c99243b0e9b58cd0b1558bd72aa5?s=128&d=identicon&r=PG", "display_name": "Gabor Garami", "link": "https://stackoverflow.com/users/182474/gabor-garami"}, "edited": false, "score": 0, "creation_date": 1576507601, "post_id": 59352873, "comment_id": 104912098, "body": "Thanks ! So I edit the visibility like this and it works : <code>ruby         register_instance_option :visible do           @subject = bindings[:object]           !@subject.is_a?(Profile)         end </code>"}, {"owner": {"reputation": 1135, "user_id": 182474, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f1b4c99243b0e9b58cd0b1558bd72aa5?s=128&d=identicon&r=PG", "display_name": "Gabor Garami", "link": "https://stackoverflow.com/users/182474/gabor-garami"}, "edited": false, "score": 1, "creation_date": 1576571353, "post_id": 59352873, "comment_id": 104933322, "body": "You missed an <code>if</code> before the expression, but otherwise, yes. Or <code>@subject = @subject.is_a?(Profile) ? bindings[:object] : nil</code> could also help if you have a falsy value for @subject."}], "owner": {"reputation": 71, "user_id": 11924554, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-L1Dh7cHAh_w/AAAAAAAAAAI/AAAAAAAABko/S4r_WMPyRcs/photo.jpg?sz=128", "display_name": "rcarette", "link": "https://stackoverflow.com/users/11924554/rcarette"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 224, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576484977, "creation_date": 1576484977, "question_id": 59352873, "link": "https://stackoverflow.com/questions/59352873/rails-admin-exclude-actions-in-model", "title": "Rails Admin - Exclude actions in model", "body": "<p>I am newest a Rails Admin and I have written a custom action to toggle a record active with an play &amp; pause icons. I would like to exclude the action in others model. </p>\n\n<p>Here is my custom action</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># lib/rails_admin/custom_actions.rb\nmodule RailsAdmin\n  module Config\n    module Actions\n     class MemberAction &lt; RailsAdmin::Config::Actions::Base\n        register_instance_option :member? do\n          true\n        end\n        register_instance_option :visible do\n          true\n        end\n     end\n     class ToggleActive &lt; MemberAction\n        RailsAdmin::Config::Actions.register(self)\n        register_instance_option :only do\n          ['FirstJob', 'Internship']\n        end\n        register_instance_option :http_methods do\n          [:get, :post]\n        end\n        register_instance_option :link_icon do\n          subject = bindings[:object]\n          icon = subject.active ? 'icon-pause' : 'icon-play'\n        end\n\n        register_instance_option :controller do\n          Proc.new do\n            @object.active = !@object.active\n            if @object.save!\n              flash[:notice] = \"#{@object.title} is now #{ @object.active ? 'actived' : 'desactivated'}\"\n              redirect_to back_or_index\n            else\n              flash[:notice] = \"Toggle activation of #{object.title} did not worked\"\n              redirect_to back_or_index\n            end\n          end\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>I have a model <code>Profile</code> and I want to exclude <code>ToggleActive</code>. \nI tried this one : </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># config/initializers/rails_admin.rb\n\nRailsAdmin.config do |config|\n config.actions do\n    dashboard                     \n\n    # breadcrumb actions\n    index                         \n    new\n    export\n\n    # selected items actions\n    bulk_delete\n    bulk_activate\n    bulk_desactivate\n\n    # inline item actions\n    show\n    edit\n    delete\n    show_in_app\n    toggle_active do\n      except 'Profile'\n    end\n end\nend\n</code></pre>\n\n<p>But it's still loading the <code>ToggleActive</code> action and try to find the method <code>active</code> for <code>Profile</code>. So it raises : </p>\n\n<pre><code>undefined method `active' for #&lt;Profile:0x00007fd9b7932c98&gt;\n</code></pre>\n\n<p>If I add <code>unless condition</code>, it is working but I am not sure it is the proper way to do this. </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># lib/rails_admin/custom_actions.rb\nicon = subject.active ? 'icon-pause' : 'icon-play' unless subject.class == Profile\n</code></pre>\n\n<p>Thanks !!!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nested"], "comments": [{"owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "edited": false, "score": 0, "creation_date": 1576482082, "post_id": 59352083, "comment_id": 104899758, "body": "Is <code>Parent</code> an <code>ActiveRecord</code> model? Is <code>Kid == Child</code>?"}, {"owner": {"reputation": 5272, "user_id": 1745902, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a629f4656cabd0433729ab0c6523cedd?s=128&d=identicon&r=PG", "display_name": "Askar", "link": "https://stackoverflow.com/users/1745902/askar"}, "reply_to_user": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "edited": false, "score": 0, "creation_date": 1576482121, "post_id": 59352083, "comment_id": 104899770, "body": "Yes. I will update my post with that information now."}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1576486041, "post_id": 59352369, "comment_id": 104901213, "body": "<i>&quot;This will raise an error if there&#39;s no parent with id = 5 in the database&quot;</i> \u2013 it will just insert a new row into the <code>kids</code> table without checking the <code>parents</code> table. You need <code>validates :parent, presence: true</code> in the <code>Kid</code> class to check for the existence of the parent record but that results in another query (of course)."}, {"owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1576486746, "post_id": 59352369, "comment_id": 104901553, "body": "Not if <code>parent_id</code> is a foreign key."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1576488024, "post_id": 59352369, "comment_id": 104902163, "body": "Yes, you&#39;re right. I haven&#39;t worked with SQL for a while and my ActiveRecord knowledge is a bit rusty. Does Rails add foreign keys by default now?"}, {"owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1576557455, "post_id": 59352369, "comment_id": 104928812, "body": "Yes. Sorry I forgot since which version, but at this time when you generate a model with <code>rails g model Foo bar:references</code>, the <code>foreign_key: true</code> is automatically added to the migration file."}], "tags": [], "owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "is_accepted": true, "score": 1, "last_activity_date": 1576482366, "creation_date": 1576482366, "answer_id": 59352369, "question_id": 59352083, "link": "https://stackoverflow.com/questions/59352083/how-to-create-a-nested-object-for-a-given-parent-id/59352369#59352369", "title": "How to create a nested object for a given parent id?", "body": "<p>You have 2 ways doing this</p>\n\n<h2>The faster but not so safe way</h2>\n\n<pre><code>Kid.create(parent_id: 5, name: \"John\")\n</code></pre>\n\n<p>This will raise an error if there's no <code>parent</code> with id = 5 in the database.</p>\n\n<h2>The slower but safer way</h2>\n\n<pre><code>Parent.find_by(id: 5)&amp;.kids&amp;.create(name: \"John\")\n</code></pre>\n\n<p>This executes 2 SQL statements, fetch the parent (id = 5), and insert a kid.</p>\n\n<p>If the parent can't be found, the kid won't be created.</p>\n"}], "owner": {"reputation": 5272, "user_id": 1745902, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a629f4656cabd0433729ab0c6523cedd?s=128&d=identicon&r=PG", "display_name": "Askar", "link": "https://stackoverflow.com/users/1745902/askar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 59352369, "answer_count": 1, "score": 1, "last_activity_date": 1576485117, "creation_date": 1576480720, "last_edit_date": 1576485117, "question_id": 59352083, "link": "https://stackoverflow.com/questions/59352083/how-to-create-a-nested-object-for-a-given-parent-id", "title": "How to create a nested object for a given parent id?", "body": "<p>Let's I have a parent object called <code>Parent</code> and nested object called <code>Kid</code>.</p>\n\n<p><strong>parent.rb:</strong></p>\n\n<pre><code>class Parent &lt; ApplicationRecord\n    has_many :kids, dependent: :delete_all\nend\n</code></pre>\n\n<p><strong>kid.rb:</strong></p>\n\n<pre><code>class Kid &lt; ApplicationRecord\n  belongs_to :parent\nend\n</code></pre>\n\n<p>I have a parent object with <strong>id 5</strong>, for which I want to create a <code>Kid</code> object.</p>\n\n<p>How would ruby expression look like when explicitly specify its parent object ID?\nThe following expression that comes to my mind at first not working:</p>\n\n<pre><code>5.kids.create(Name: \"John)\n</code></pre>\n"}, {"tags": ["ruby", "macos", "openssl", "rvm"], "comments": [{"owner": {"reputation": 1503, "user_id": 3451919, "user_type": "registered", "profile_image": "https://graph.facebook.com/1514889262/picture?type=large", "display_name": "Aedvald Tseh", "link": "https://stackoverflow.com/users/3451919/aedvald-tseh"}, "edited": false, "score": 1, "creation_date": 1576473784, "post_id": 59350892, "comment_id": 104897444, "body": "OpenSSL is proably not on your machine. Check if it is there with <code>which openssl</code>."}, {"owner": {"reputation": 123, "user_id": 12543367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccace259fb15b84cccd3ec9198d8ad5e?s=128&d=identicon&r=PG&f=1", "display_name": "praveen_coder", "link": "https://stackoverflow.com/users/12543367/praveen-coder"}, "reply_to_user": {"reputation": 1503, "user_id": 3451919, "user_type": "registered", "profile_image": "https://graph.facebook.com/1514889262/picture?type=large", "display_name": "Aedvald Tseh", "link": "https://stackoverflow.com/users/3451919/aedvald-tseh"}, "edited": false, "score": 0, "creation_date": 1576479656, "post_id": 59350892, "comment_id": 104898978, "body": "<code>which openssl</code> prints the output <code>&#47;usr&#47;local&#47;opt&#47;openssl@1.1&#47;bin&#47;openssl</code> . Hence I assume I have openssl present in my system."}, {"owner": {"reputation": 1503, "user_id": 3451919, "user_type": "registered", "profile_image": "https://graph.facebook.com/1514889262/picture?type=large", "display_name": "Aedvald Tseh", "link": "https://stackoverflow.com/users/3451919/aedvald-tseh"}, "edited": false, "score": 0, "creation_date": 1576484302, "post_id": 59350892, "comment_id": 104900508, "body": "OK, your issue seems to not be an openssl issue. What you can try next: look at file /Users/praveenk.k/.rvm/log/1576471018_ruby-2.1.2/gem.install&zwnj;&#8203;.gem-wrappers-&gt;=1.4.&zwnj;&#8203;0.log. Share the Content of this file with us."}, {"owner": {"reputation": 123, "user_id": 12543367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccace259fb15b84cccd3ec9198d8ad5e?s=128&d=identicon&r=PG&f=1", "display_name": "praveen_coder", "link": "https://stackoverflow.com/users/12543367/praveen-coder"}, "reply_to_user": {"reputation": 1503, "user_id": 3451919, "user_type": "registered", "profile_image": "https://graph.facebook.com/1514889262/picture?type=large", "display_name": "Aedvald Tseh", "link": "https://stackoverflow.com/users/3451919/aedvald-tseh"}, "edited": false, "score": 0, "creation_date": 1576485053, "post_id": 59350892, "comment_id": 104900785, "body": "contents of <code>cat &quot;&#47;Users&#47;praveenk.k&#47;.rvm&#47;log&#47;1576471018_ruby-2.1.2&#47;gem.instal&zwnj;&#8203;l.gem-wrappers-&gt;=1.4&zwnj;&#8203;.0.log&quot;</code> is like this: <code>ERROR:  Loading command: install (LoadError) \tcannot load such file -- openssl ERROR:  While executing gem ... (NoMethodError)     undefined method </code>invoke_with_build_args&#39; for nil:NilClass`"}, {"owner": {"reputation": 1503, "user_id": 3451919, "user_type": "registered", "profile_image": "https://graph.facebook.com/1514889262/picture?type=large", "display_name": "Aedvald Tseh", "link": "https://stackoverflow.com/users/3451919/aedvald-tseh"}, "edited": false, "score": 1, "creation_date": 1576498747, "post_id": 59350892, "comment_id": 104907541, "body": "Please put the text of your last comment in your original post. This way it is easier for people to help you."}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 12543367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccace259fb15b84cccd3ec9198d8ad5e?s=128&d=identicon&r=PG&f=1", "display_name": "praveen_coder", "link": "https://stackoverflow.com/users/12543367/praveen-coder"}, "edited": false, "score": 3, "creation_date": 1576585089, "post_id": 59365008, "comment_id": 104940582, "body": "that really helped! I followed this <a href=\"https://mentalized.net/journal/2019/09/13/ruby-2-3-rvm-and-openssl-1-0/\" rel=\"nofollow noreferrer\">link</a>"}], "tags": [], "owner": {"reputation": 613, "user_id": 8665413, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5MdNgW6-3h4/AAAAAAAAAAI/AAAAAAAAAH0/j8XUag7iWz4/photo.jpg?sz=128", "display_name": "David Bodow", "link": "https://stackoverflow.com/users/8665413/david-bodow"}, "is_accepted": true, "score": 16, "last_activity_date": 1581474106, "last_edit_date": 1581474106, "creation_date": 1576534366, "answer_id": 59365008, "question_id": 59350892, "link": "https://stackoverflow.com/questions/59350892/installing-ruby-2-1-2-cannot-load-such-file-openssl-loaderror/59365008#59365008", "title": "Installing ruby-2.1.2: Cannot load such file -- openssl (LoadError)", "body": "<p>Ruby &lt;2.4 is incompatible with OpenSSL 1.1 (e.g see <a href=\"https://github.com/rbenv/ruby-build/issues/1353\" rel=\"noreferrer\">https://github.com/rbenv/ruby-build/issues/1353</a>).</p>\n\n<p>Just a hunch, but if you're using Mac + Homebrew, OpenSSL 1.0 was recently deleted, so anything along the lines of <code>brew upgrade openssl</code> would trash that.</p>\n\n<p>There are several options to deal with this:</p>\n\n<ol>\n<li>I have older Rubies via <code>asdf</code> installed with LibreSSL (which may be safer anyway, see <a href=\"https://security.stackexchange.com/questions/112545/what-are-the-main-advantages-of-using-libressl-in-favor-of-openssl\">https://security.stackexchange.com/questions/112545/what-are-the-main-advantages-of-using-libressl-in-favor-of-openssl</a>):</li>\n</ol>\n\n<pre><code>$ openssl\nOpenSSL&gt; version\nLibreSSL 2.8.3\n</code></pre>\n\n<ol start=\"2\">\n<li>Compile and link your own OpenSSL 1.0 (or then set compiler flags as environment variables when building Ruby -- <a href=\"https://rvm.io/rubies/installing\" rel=\"noreferrer\">https://rvm.io/rubies/installing</a>)</li>\n<li>See if your system's package manager allows you to access openssl 1.0 and install with that (was helping a coworker with this recently and we weren't able to find a good keg for homebrew at this time, unfortunately)</li>\n</ol>\n\n<p>There might be something less convoluted than that; if someone has ideas, please feel free to comment or give an alternate answer.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I personally ran into this issue with some other software and discovered that this fixed it, since the old SSL version was sitting around still:</p>\n\n<pre><code>brew switch openssl 1.0.2s\n</code></pre>\n\n<p>Should work so long as Homebrew doesn't \"helpfully\" clean that out for me.</p>\n"}, {"tags": [], "owner": {"reputation": 1805, "user_id": 642616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a38cc8209a6c6a3877e4df957c3cff1b?s=128&d=identicon&r=PG", "display_name": "Feuda", "link": "https://stackoverflow.com/users/642616/feuda"}, "is_accepted": false, "score": 17, "last_activity_date": 1588131170, "creation_date": 1588131170, "answer_id": 61493771, "question_id": 59350892, "link": "https://stackoverflow.com/questions/59350892/installing-ruby-2-1-2-cannot-load-such-file-openssl-loaderror/61493771#61493771", "title": "Installing ruby-2.1.2: Cannot load such file -- openssl (LoadError)", "body": "<p>Worked example</p>\n\n<pre><code>brew install rbenv/tap/openssl@1.0\nrvm install 2.1.2 -C --with-openssl-dir=`brew --prefix openssl@1.0`\n</code></pre>\n\n<p>It's from <a href=\"https://github.com/rvm/rvm/issues/4819#issuecomment-595644550\" rel=\"noreferrer\">https://github.com/rvm/rvm/issues/4819#issuecomment-595644550</a></p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 12208701, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tJF7rHj0Uss/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdAd8n5orBxZI4nJ07Cg30CIUSBQw/photo.jpg?sz=128", "display_name": "cedric95fr", "link": "https://stackoverflow.com/users/12208701/cedric95fr"}, "is_accepted": false, "score": 7, "last_activity_date": 1589265281, "creation_date": 1589265281, "answer_id": 61745292, "question_id": 59350892, "link": "https://stackoverflow.com/questions/59350892/installing-ruby-2-1-2-cannot-load-such-file-openssl-loaderror/61745292#61745292", "title": "Installing ruby-2.1.2: Cannot load such file -- openssl (LoadError)", "body": "<p>For debian 10 : </p>\n\n<p>sudo apt-get install -y libssl-dev</p>\n"}, {"tags": [], "owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "is_accepted": false, "score": 0, "last_activity_date": 1606767823, "creation_date": 1606767823, "answer_id": 65080635, "question_id": 59350892, "link": "https://stackoverflow.com/questions/59350892/installing-ruby-2-1-2-cannot-load-such-file-openssl-loaderror/65080635#65080635", "title": "Installing ruby-2.1.2: Cannot load such file -- openssl (LoadError)", "body": "<p>On Amazon Linux 2, even if openssl is installed, you need the full dev kit</p>\n<pre><code>yum install openssl-devel\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 368, "user_id": 6069435, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5688uZP2XRI/AAAAAAAAAAI/AAAAAAAAAMo/bKqKG-U3uJw/photo.jpg?sz=128", "display_name": "Ruan Nawe", "link": "https://stackoverflow.com/users/6069435/ruan-nawe"}, "is_accepted": false, "score": 0, "last_activity_date": 1613062295, "creation_date": 1613062295, "answer_id": 66159086, "question_id": 59350892, "link": "https://stackoverflow.com/questions/59350892/installing-ruby-2-1-2-cannot-load-such-file-openssl-loaderror/66159086#66159086", "title": "Installing ruby-2.1.2: Cannot load such file -- openssl (LoadError)", "body": "<p>For me solve this in centos 7</p>\n<pre><code>$ openssl version -a\n\n\nOpenSSL 1.0.2k-fips  26 Jan 2017\nbuilt on: reproducible build, date unspecified\nplatform: linux-x86_64\noptions:  bn(64,64) md2(int) rc4(8x,int) des(idx,cisc,16,int) idea(int) blowfish(idx) \ncompiler: gcc -I. -I.. -I../include  -fPIC -DOPENSSL_PIC -DZLIB -DOPENSSL_THREADS -D_REENTRANT -DDSO_DLFCN -DHAVE_DLFCN_H -DKRB5_MIT -m64 -DL_ENDIAN -Wall -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches   -m64 -mtune=generic -Wa,--noexecstack -DPURIFY -DOPENSSL_IA32_SSE2 -DOPENSSL_BN_ASM_MONT -DOPENSSL_BN_ASM_MONT5 -DOPENSSL_BN_ASM_GF2m -DRC4_ASM -DSHA1_ASM -DSHA256_ASM -DSHA512_ASM -DMD5_ASM -DAES_ASM -DVPAES_ASM -DBSAES_ASM -DWHIRLPOOL_ASM -DGHASH_ASM -DECP_NISTZ256_ASM\n\n------------------------------------------------------------------------\nOPENSSLDIR: &quot;/etc/pki/tls&quot; &lt;- ************* COPY THIS PATH *************\n------------------------------------------------------------------------\n\nengines:  rdrand dynamic \n</code></pre>\n<p>paste the path in the bellow line how --with-openssl-dir param</p>\n<pre><code>$ RUBY_CONFIGURE_OPTS=&quot;--with-openssl-dir=/etc/pki/tls&quot; rbenv install 2.7.2\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 12543367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccace259fb15b84cccd3ec9198d8ad5e?s=128&d=identicon&r=PG&f=1", "display_name": "praveen_coder", "link": "https://stackoverflow.com/users/12543367/praveen-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8700, "favorite_count": 2, "accepted_answer_id": 59365008, "answer_count": 5, "score": 12, "last_activity_date": 1613062295, "creation_date": 1576473534, "last_edit_date": 1576696545, "question_id": 59350892, "link": "https://stackoverflow.com/questions/59350892/installing-ruby-2-1-2-cannot-load-such-file-openssl-loaderror", "title": "Installing ruby-2.1.2: Cannot load such file -- openssl (LoadError)", "body": "<p>Getting few errors while installing ruby-2.1.2 using rvm. I am new to ruby and hence need assistance. Please let me know </p>\n\n<p>Installation log and other relevant information here: <a href=\"https://paste.ubuntu.com/p/RTXNP2D25K/\" rel=\"noreferrer\">log</a></p>\n\n<p>From the log provided in problem description, I have ruby 2.1.2 installed in the system. However, getting error when tried listing gems with <code>gem list</code> due to installation errors.After changing to 2.1.2 i.e., <code>rvm use 2.1.2</code> and executing <code>ruby -r openssl -e 'puts OpensSSL::OPENSSL_VERSION'</code> gives this error: </p>\n\n<blockquote>\n  <p>/Users/praveenk.k/.rvm/rubies/ruby-2.1.2/lib/ruby/site_ruby/2.1.0/rubygems/core_ext/kernel_require.rb:54:in require': cannot load such file -- openssl (LoadError) from /Users/praveenk.k/.rvm/rubies/ruby-2.1.2/lib/ruby/site_ruby/2.1.0/rubygems/core_ext/kernel_require.rb:54:in require'</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 741, "user_id": 6894749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gbstY.jpg?s=128&g=1", "display_name": "Thang", "link": "https://stackoverflow.com/users/6894749/thang"}, "is_accepted": false, "score": 0, "last_activity_date": 1576477462, "creation_date": 1576477462, "answer_id": 59351457, "question_id": 59350613, "link": "https://stackoverflow.com/questions/59350613/rails-has-one-relation-grouping/59351457#59351457", "title": "rails has one relation - grouping", "body": "<p>Please try</p>\n\n<pre><code>C.select(\"c.uniq_code, sum(a.price) as total\").joins(:b =&gt; :a).group('c.uniq_code')\n</code></pre>\n"}], "owner": {"reputation": 1620, "user_id": 3119467, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/zwQvq.png?s=128&g=1", "display_name": "ramamoorthy_villi", "link": "https://stackoverflow.com/users/3119467/ramamoorthy-villi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576477462, "creation_date": 1576470974, "question_id": 59350613, "link": "https://stackoverflow.com/questions/59350613/rails-has-one-relation-grouping", "title": "rails has one relation - grouping", "body": "<pre><code>Class A\n has_many: B\nend \n\nClass B\n belongs_to: A\n has_one: C\nend \n\nClass C\n belongs_to: B\nend \n</code></pre>\n\n<p>I want to group the column from the Class C with sum of price column from Class A</p>\n\n<pre><code>C.group(\"c.uniq_code\").select(\"sum(A.price) as total\")\n</code></pre>\n\n<p>Please advice: </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 893, "user_id": 3394889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3c58b23ce03f0e71522820d13404d5a?s=128&d=identicon&r=PG&f=1", "display_name": "The Wizard", "link": "https://stackoverflow.com/users/3394889/the-wizard"}, "edited": false, "score": 0, "creation_date": 1576464782, "post_id": 59349966, "comment_id": 104895920, "body": "How have you defined holdSmallerArea and holdRotated? Can you please post more code"}, {"owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 2, "creation_date": 1576465071, "post_id": 59349966, "comment_id": 104895965, "body": "Because <code>holdSmallerArea</code> and <code>holdRotated</code> reference same object in the memory. Did you do this somewhere before <code>holdRotated = holdSmallerArea</code>?"}, {"owner": {"reputation": 149, "user_id": 6836379, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZvnDu.jpg?s=128&g=1", "display_name": "Finn Williams", "link": "https://stackoverflow.com/users/6836379/finn-williams"}, "reply_to_user": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 0, "creation_date": 1576465244, "post_id": 59349966, "comment_id": 104895993, "body": "@Fabio I have updated the question. As you can see I created 2 different arrays and populated them separately, to try to overcome the passing by reference issue"}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1576465633, "post_id": 59349966, "comment_id": 104896066, "body": "I guess the final object instances are passed by reference, you need to make a copy if you&#39;ve got mutable object instances. Or you could make them immutable of course and return a changed copy on any operation."}, {"owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 0, "creation_date": 1576465707, "post_id": 59349966, "comment_id": 104896082, "body": "Can you show full sample? What happens around where you trying to print arrays out?"}, {"owner": {"reputation": 149, "user_id": 6836379, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZvnDu.jpg?s=128&g=1", "display_name": "Finn Williams", "link": "https://stackoverflow.com/users/6836379/finn-williams"}, "reply_to_user": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 0, "creation_date": 1576466369, "post_id": 59349966, "comment_id": 104896180, "body": "@Fabio I have put the full code above. As you can see all I am doing is changing values with nested for loops. The purpose of this algorithm is to rotate the maze array on its side which I am trying to implement."}, {"owner": {"reputation": 6898, "user_id": 2012487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9631fa1981d36a3b5f71426c821a8064?s=128&d=identicon&r=PG", "display_name": "Aguardientico", "link": "https://stackoverflow.com/users/2012487/aguardientico"}, "edited": false, "score": 2, "creation_date": 1576466456, "post_id": 59349966, "comment_id": 104896195, "body": "You are setting the same array <code>rows</code> for <code>holdSmallerArea</code> and <code>holdRotated</code>"}, {"owner": {"reputation": 149, "user_id": 6836379, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZvnDu.jpg?s=128&g=1", "display_name": "Finn Williams", "link": "https://stackoverflow.com/users/6836379/finn-williams"}, "reply_to_user": {"reputation": 6898, "user_id": 2012487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9631fa1981d36a3b5f71426c821a8064?s=128&d=identicon&r=PG", "display_name": "Aguardientico", "link": "https://stackoverflow.com/users/2012487/aguardientico"}, "edited": false, "score": 0, "creation_date": 1576466652, "post_id": 59349966, "comment_id": 104896228, "body": "@Aguardientico Thank you, I used the clone method to copy data from rows instead of assigning it and it worked!"}, {"owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 0, "creation_date": 1576467311, "post_id": 59349966, "comment_id": 104896324, "body": "Right approach would be to use 2 dimensional arrays instead of string, because string is mutable in ruby."}], "owner": {"reputation": 149, "user_id": 6836379, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZvnDu.jpg?s=128&g=1", "display_name": "Finn Williams", "link": "https://stackoverflow.com/users/6836379/finn-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576466191, "creation_date": 1576464530, "last_edit_date": 1576466191, "question_id": 59349966, "link": "https://stackoverflow.com/questions/59349966/ruby-arrays-right-hand-of-statement-changing-through-assignment-even-though-i-d", "title": "Ruby arrays: right hand of statement changing through assignment even though I didn&#39;t tell it to", "body": "<p>I am doing some work with nested for loops. I want an array called holdRotated to be populated with certain elements in holdSmallerArea. However, during this assignment, for some reason, holdSmallerArea has changed, even though I didn't tell it to.</p>\n\n<pre><code>puts holdSmallerArea\nholdRotated[i][j] = holdSmallerArea[holdRotated.length - j - 1][i]\nputs holdSmallerArea\n\nOut:\n123\n456\n789\n\n723\n456\n789\n</code></pre>\n\n<p>As you can see in my code, I have not told holdSmallerArea to change, so why is it printing different things out?</p>\n\n<p>Full code:</p>\n\n<pre><code>$maze=\n  [\"123\",\n  \"456\",\n  \"789\",]\n\ndef plot x,y,distance\n  holdSmallerArea = []\n  holdRotated = []\n  rows = []\n  for i in 0..2 do\n    for j in 0..2 do\n      rows &lt;&lt; $maze[i][j]\n    end\n    rows = rows.join('')\n    holdSmallerArea &lt;&lt; rows\n    holdRotated &lt;&lt; rows\n    rows = []\n  end\n\n  for i in (0..(holdRotated.length - 1)) do\n      for j in (0..(holdRotated.length - 1)) do\n        puts holdSmallerArea\n        holdRotated[i][j] = holdSmallerArea[holdRotated.length - j - 1][i]\n        puts holdSmallerArea\n      end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1576500335, "post_id": 59349865, "comment_id": 104908326, "body": "The problem with the code above is just that you are missing an <code>end</code> tag."}], "answers": [{"comments": [{"owner": {"reputation": 741, "user_id": 6894749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gbstY.jpg?s=128&g=1", "display_name": "Thang", "link": "https://stackoverflow.com/users/6894749/thang"}, "reply_to_user": {"reputation": 27, "user_id": 11320367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55ebab7f345518168893ae36d08dac0b?s=128&d=identicon&r=PG&f=1", "display_name": "jimmy jiang", "link": "https://stackoverflow.com/users/11320367/jimmy-jiang"}, "edited": false, "score": 0, "creation_date": 1576468444, "post_id": 59350301, "comment_id": 104896509, "body": "what is the condition may I ask?"}, {"owner": {"reputation": 741, "user_id": 6894749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gbstY.jpg?s=128&g=1", "display_name": "Thang", "link": "https://stackoverflow.com/users/6894749/thang"}, "reply_to_user": {"reputation": 27, "user_id": 11320367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55ebab7f345518168893ae36d08dac0b?s=128&d=identicon&r=PG&f=1", "display_name": "jimmy jiang", "link": "https://stackoverflow.com/users/11320367/jimmy-jiang"}, "edited": false, "score": 0, "creation_date": 1576468616, "post_id": 59350301, "comment_id": 104896537, "body": "Is there any difference in in creating a <code>PageHotspotExternal</code> between <code>create</code> action and <code>createExternalHotspot</code>?"}, {"owner": {"reputation": 27, "user_id": 11320367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55ebab7f345518168893ae36d08dac0b?s=128&d=identicon&r=PG&f=1", "display_name": "jimmy jiang", "link": "https://stackoverflow.com/users/11320367/jimmy-jiang"}, "edited": false, "score": 0, "creation_date": 1576470186, "post_id": 59350301, "comment_id": 104896777, "body": "there is no difference for the create function , the only difference is that the current page is different.  For example the first page is loaclhost:3000/editor , the second page is localhost:3000/project_pages"}, {"owner": {"reputation": 27, "user_id": 11320367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55ebab7f345518168893ae36d08dac0b?s=128&d=identicon&r=PG&f=1", "display_name": "jimmy jiang", "link": "https://stackoverflow.com/users/11320367/jimmy-jiang"}, "edited": false, "score": 0, "creation_date": 1576470240, "post_id": 59350301, "comment_id": 104896790, "body": "so i want the first page remain the same page and second page redirect to page_hotspot_external/index      Thank you !"}, {"owner": {"reputation": 741, "user_id": 6894749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gbstY.jpg?s=128&g=1", "display_name": "Thang", "link": "https://stackoverflow.com/users/6894749/thang"}, "reply_to_user": {"reputation": 27, "user_id": 11320367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55ebab7f345518168893ae36d08dac0b?s=128&d=identicon&r=PG&f=1", "display_name": "jimmy jiang", "link": "https://stackoverflow.com/users/11320367/jimmy-jiang"}, "edited": false, "score": 0, "creation_date": 1576471308, "post_id": 59350301, "comment_id": 104896953, "body": "You want one action with 2 redirect options correct? what is the condition base on that you want to switch between the redirect options?"}, {"owner": {"reputation": 472, "user_id": 4377172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cPzBI.png?s=128&g=1", "display_name": "Azmat Rana", "link": "https://stackoverflow.com/users/4377172/azmat-rana"}, "reply_to_user": {"reputation": 27, "user_id": 11320367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55ebab7f345518168893ae36d08dac0b?s=128&d=identicon&r=PG&f=1", "display_name": "jimmy jiang", "link": "https://stackoverflow.com/users/11320367/jimmy-jiang"}, "edited": false, "score": 0, "creation_date": 1576498301, "post_id": 59350301, "comment_id": 104907292, "body": "@jimmyjiang can you please tell what is your condition? or you don&#39;t know what condition will be added?"}], "tags": [], "owner": {"reputation": 741, "user_id": 6894749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gbstY.jpg?s=128&g=1", "display_name": "Thang", "link": "https://stackoverflow.com/users/6894749/thang"}, "is_accepted": false, "score": 1, "last_activity_date": 1576467897, "creation_date": 1576467897, "answer_id": 59350301, "question_id": 59349865, "link": "https://stackoverflow.com/questions/59349865/how-should-i-write-if-statement-to-redirect-to-two-differnt-pagesruby-on-rails/59350301#59350301", "title": "how should i write if statement to redirect to two differnt pages(ruby on rails)", "body": "<p>Try this:</p>\n\n<pre><code>respond_to do |format|\n  if @page_hotspot_external.save\n    format.html do\n      condition ? redirect_back(fallback_location: root_path) : @page_hotspot_external\n    end\n    format.json { render :show, status: :created, location: @page_hotspot_external }\n  else\n...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 472, "user_id": 4377172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cPzBI.png?s=128&g=1", "display_name": "Azmat Rana", "link": "https://stackoverflow.com/users/4377172/azmat-rana"}, "is_accepted": true, "score": 1, "last_activity_date": 1576499091, "creation_date": 1576499091, "answer_id": 59356600, "question_id": 59349865, "link": "https://stackoverflow.com/questions/59349865/how-should-i-write-if-statement-to-redirect-to-two-differnt-pagesruby-on-rails/59356600#59356600", "title": "how should i write if statement to redirect to two differnt pages(ruby on rails)", "body": "<p>You can try this. </p>\n\n<pre><code>respond_to do |format|\n    if @page_hotspot_external.save\n        format.html {\n            if (params[:request_from] == \"simple_create\") # your custom logic, may be you can add this param in your form that you are sending to this action\n                redirect_to root_path, notice: 'Redirecting with condition 1'\n            elsif (params[:request_from] == \"createExternalHotspot\") # another custom logic\n                redirect_to root_path, notice: 'Redirecting with condition 2'\n            else\n                redirect_to root_path, notice: 'Redirecting with else default'\n            end\n        }\n        format.json { render :show, status: :created, location: @page_hotspot_external }\n    end\nend \n</code></pre>\n\n<p>You can use any condition you like, for example. </p>\n\n<blockquote>\n  <p>1- You can send the <code>params[:request_from]</code> from your form if you want\n  to differentiate between both forms. For this you have to add hidden\n  field in second form.</p>\n\n<pre><code>&lt;%= hidden_field_tag :custom_param, 'createExternalHotspot' %&gt;\n</code></pre>\n  \n  <p>2- Use your own logic in the if condition to differentiate the request</p>\n  \n  <p>3- You can also make logic based on the <code>request.referer</code> it contains\n  the url from where the request is coming.</p>\n</blockquote>\n\n<p>Hope I was able to understand your question. If not please add your comment, thanks. </p>\n"}], "owner": {"reputation": 27, "user_id": 11320367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55ebab7f345518168893ae36d08dac0b?s=128&d=identicon&r=PG&f=1", "display_name": "jimmy jiang", "link": "https://stackoverflow.com/users/11320367/jimmy-jiang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 59356600, "answer_count": 2, "score": 1, "last_activity_date": 1576499091, "creation_date": 1576463279, "last_edit_date": 1576468953, "question_id": 59349865, "link": "https://stackoverflow.com/questions/59349865/how-should-i-write-if-statement-to-redirect-to-two-differnt-pagesruby-on-rails", "title": "how should i write if statement to redirect to two differnt pages(ruby on rails)", "body": "<p>I have two different pages that both have the create page form, but I want the first redirect to the index page of this controller and the second redirect to the current page. </p>\n\n<p>Is there a way to use a conditional if-else statement instead of writing two functions which is stupid.</p>\n\n<p>I am using rails 5.1.7 and ruby 2.6.3</p>\n\n<p>the first function:</p>\n\n<pre><code>  def create\n    @page_hotspot_external = PageHotspotExternal.new(page_hotspot_external_params)\n\n    respond_to do |format|\n      if @page_hotspot_external.save\n        format.html { redirect_to @page_hotspot_external, notice: 'Page hotspot external was successfully created.' }\n        format.json { render :show, status: :created, location: @page_hotspot_external }\n      else\n        format.html { render :new }\n        format.json { render json: @page_hotspot_external.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n\n<p>the second function</p>\n\n<pre><code>  def createExternalHotspot\n    @page_hotspot_external = PageHotspotExternal.new(page_hotspot_external_params)\n    @user_project = UserProject.find_by(id: params[:id])\n    respond_to do |format|\n      if @page_hotspot_external.save\n        format.html { redirect_back(fallback_location: root_path)}\n        format.json { render :show, status: :created, location: @page_hotspot_external }\n      else\n        format.html { render :new }\n        format.json { render json: @page_hotspot_external.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n\n<p>What I'm looking for:</p>\n\n<pre><code>  def create\n    @page_hotspot_external = PageHotspotExternal.new(page_hotspot_external_params)\n    @user_project = UserProject.find_by(id: params[:id])\n    respond_to do |format|\n      if @page_hotspot_external.save\n        if xxxxxxxxxxx  //if statement \n          format.html { redirect_back(fallback_location: root_path)}\n          format.json { render :show, status: :created, location: @page_hotspot_external }\n        else\n          format.html { @page_hotspot_external}\n          format.json { render :show, status: :created, location: @page_hotspot_external }\n      else\n        format.html { render :new }\n        format.json { render json: @page_hotspot_external.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n"}, {"tags": ["html", "ruby-on-rails", "ruby", "nokogiri"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1576452646, "post_id": 59348854, "comment_id": 104893910, "body": "Please include the relevant code in the question itself as text - not as screenshots. If you know the position of the element you can use css pseudo selectors. <code>:first</code>, <code>:nth-child</code>, <code>:nth-of-type</code> etc. You also don&#39;t have to chain a million calls to <code>.css</code>. If an element has an ID it should be unique on the page. You should&#39;nt have to slog all the way up the tree to get there."}, {"owner": {"reputation": 37, "user_id": 11140764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b5432a55031ff9995eaa0e8fcf0f7ef?s=128&d=identicon&r=PG&f=1", "display_name": "DevKLiD", "link": "https://stackoverflow.com/users/11140764/devklid"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1576453373, "post_id": 59348854, "comment_id": 104894037, "body": "@max, I tried to include the code as best I could but stack overflow kept telling me it wasn&#39;t formatted correctly, even when I was including it in a code block.  Also, the div I want to access does not have an ID. And, I would use the pseudo selectors but for some reason Nokogiri is returning me something different than what is on the page"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1576453629, "post_id": 59348854, "comment_id": 104894079, "body": "Yeah I got that. What you don&#39;t understand is that doing <code>.css(&#39;#foo&#39;).css(&#39;.bar&#39;).css(&#39;#baz&#39;)</code> is pointless. You can just just start at <code>#baz</code> instead. The page might also be malformed. This kind of scaping is extremely brittle and I would not recommend it unless its for learning or shits and giggles."}, {"owner": {"reputation": 37, "user_id": 11140764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b5432a55031ff9995eaa0e8fcf0f7ef?s=128&d=identicon&r=PG&f=1", "display_name": "DevKLiD", "link": "https://stackoverflow.com/users/11140764/devklid"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1576454625, "post_id": 59348854, "comment_id": 104894233, "body": "@max, I am learning, I&#39;m finishing up my first web dev course.  And I appreciate the tip, noted on not using long chain calls. Even if the page is malformed, does it make sense for Nokogiri to return me a DIV that doesn&#39;t seem to exist when I inspect the page?"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1576454850, "post_id": 59348854, "comment_id": 104894274, "body": "Yes. If the page is malformed the browser just does its best at making sense of it. Thats what you see in the inspector. It does&#39;nt appear to be that bad though <a href=\"https://validator.w3.org/nu/?doc=https%3A%2F%2Fwww.rotoworld.com%2Fbasketball%2Fnba%2Fdepth-charts\" rel=\"nofollow noreferrer\">validator.w3.org/nu/&hellip;</a>"}, {"owner": {"reputation": 37, "user_id": 11140764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b5432a55031ff9995eaa0e8fcf0f7ef?s=128&d=identicon&r=PG&f=1", "display_name": "DevKLiD", "link": "https://stackoverflow.com/users/11140764/devklid"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1576456400, "post_id": 59348854, "comment_id": 104894543, "body": "@max, yeah I didn&#39;t think it would be that bad since it&#39;s a professional site.  So why in the world can I not see the DIV with no class or id as a child of the div with an id of &quot;depth-chart-page-wrapper&quot;? Although my chain was brittle like you said, it was working up to that point, and I was able to see the children of every other element I parsed. Sorry if I&#39;m asking any stupid questions."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1576457261, "post_id": 59348854, "comment_id": 104894664, "body": "Its there in the browser as well. Run <code>document.querySelector(&#39;#depth-chart-page-wrapper&gt;div&#39;)</code> in the browser console. You seem to have gotten hung up on the idea that you need to go down step by step though. If what you want is inside that div you can just write selectors that go straight to what you want. For example <code>&#39;#depth-chart-page-wrapper .team-listing-banner__name&#39;</code> will give you the names of all the teams. Thats kind of the point of CSS selectors."}, {"owner": {"reputation": 37, "user_id": 11140764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b5432a55031ff9995eaa0e8fcf0f7ef?s=128&d=identicon&r=PG&f=1", "display_name": "DevKLiD", "link": "https://stackoverflow.com/users/11140764/devklid"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1576458238, "post_id": 59348854, "comment_id": 104894833, "body": "@max, yeah I never had any problems getting to it when working in the browser console.  My issue is in my Rails application, I am using Nokogiri to try and scrape info off this page, and I am not able to get to that classless/id-less DIV in there, even though I was able to go down the whole chain just fine up until that point. That&#39;s my question, it all works fine in the browser, but I am not getting the same results when working in my app."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1576458567, "post_id": 59348854, "comment_id": 104894880, "body": "Ah. Now I get whats going on. Turn JS off in your browser and then open the page. Thats what Nokogiri sees. The content you&#39;re looking at in the inspector is loaded with Ajax. Nokogiri is not a browser and does not run javascript."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1576458867, "post_id": 59348854, "comment_id": 104894931, "body": "In order to scrape this page you would have to use selenium or a <a href=\"https://en.wikipedia.org/wiki/Headless_browser\" rel=\"nofollow noreferrer\">headless browser</a>. I would suggest that you find another less complicated project."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1576798328, "post_id": 59348854, "comment_id": 105023607, "body": "Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. See: &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">How to create a Minimal, Reproducible Example</a>&quot;. Also, &quot;<a href=\"https://meta.stackoverflow.com/questions/285551/why-not-upload-images-of-code-on-so-when-asking-a-question/285557#285557\">Why not upload images of code on SO when asking a question?</a>&quot;."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1577074382, "post_id": 59348854, "comment_id": 105082617, "body": "This question is in the process of being closed because it doesn&#39;t meet the guidelines. Please remove links to pictures of code or other require resources, and place the minimal code and input data into the question itself, and provide the required output or results. The links above will help guide you."}], "owner": {"reputation": 37, "user_id": 11140764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b5432a55031ff9995eaa0e8fcf0f7ef?s=128&d=identicon&r=PG&f=1", "display_name": "DevKLiD", "link": "https://stackoverflow.com/users/11140764/devklid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1581290525, "creation_date": 1576451168, "last_edit_date": 1581290525, "question_id": 59348854, "link": "https://stackoverflow.com/questions/59348854/how-can-i-grab-a-div-with-no-class-name-or-id-or-any-attributes-using-nokogiri", "title": "How can I grab a DIV with no class name or ID or any attributes using Nokogiri?", "body": "<p>I am using Nokogiri (with Rails) to try and parse <a href=\"https://www.rotoworld.com/basketball/nba/depth-charts\" rel=\"nofollow noreferrer\">this site</a> and Nokogiri is not cooperating.  I made it all the way down the HTML chain using css selectors and everything was working, and then I encountered a plain DIV with no class name or ID.  I need to access the content inside this div but cannot do it. Also, in place of this div with no class or ID, Nokogiri is returning me a div with an ID name that is not present anywhere if you inspect the live site.</p>\n\n<p><a href=\"https://i.stack.imgur.com/hQ5uA.png\" rel=\"nofollow noreferrer\">structure of the HTML document</a></p>\n\n<p>In my picture, I have made it inside the div with the id=\"depth-chart-page-wrapper\", but I need to get to the div with the class=\"depth-chart-wall\", but it is wrapped in a plain div with no class or id or any attributes, and I cannot find a way to get a hold of this element.</p>\n\n<p>So far this I've used this statement:</p>\n\n<p><a href=\"https://i.stack.imgur.com/K9g3R.png\" rel=\"nofollow noreferrer\">This is my Nokogiri scraper in Ruby on Rails</a></p>\n\n<p>and my result returns me this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6OpWQ.png\" rel=\"nofollow noreferrer\">What nokogiri is returning to me</a></p>\n\n<p>My result is saying that the div with class \"block__content\" has three children:</p>\n\n<ol>\n<li>h1 with class \"block__title\"</li>\n<li>Nokogiri::XML::Text:0x3fc184f8aa18 \"\\n\"</li>\n<li>div with id=\"rw-depth-chart-value\"</li>\n</ol>\n\n<p>But if you look at the structure of the HTML on the site you should only see two:</p>\n\n<ol>\n<li>h1 with class \"block__title\"</li>\n<li>the div with no class name or id</li>\n</ol>\n\n<p>As I said above, if you inspect the site you will see there is no element in the whole site with an ID of \"rw-depth-chart-value\".  Why is Nokogiri returning me this value and why can't I access the plain div the same way I've been able to access everything else up to that point?</p>\n"}, {"tags": ["ruby", "rubygems", "bundler", "libxml2"], "answers": [{"tags": [], "owner": {"reputation": 11596, "user_id": 465986, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/592491f3adae59ba7f0416760d5361ab?s=128&d=identicon&r=PG", "display_name": "AKWF", "link": "https://stackoverflow.com/users/465986/akwf"}, "is_accepted": false, "score": 1, "last_activity_date": 1576506146, "creation_date": 1576506146, "answer_id": 59358552, "question_id": 59348710, "link": "https://stackoverflow.com/questions/59348710/bundler-v2-0-2-refuses-to-install-libxml-ruby-3-1-0-on-mac-os-catalina/59358552#59358552", "title": "Bundler v2.0.2 refuses to install libxml-ruby 3.1.0 on Mac OS Catalina", "body": "<p>Since Bundler wouldn't honor the paths I was passing in, I looked at the paths where it was looking for <code>xmlversion.h</code>.</p>\n\n<p>I went into <code>/usr/local/include</code>. That's where all my Homebrew links are. I created a symlink to the Mac OS-provided libxml directory:</p>\n\n<pre><code>ln -s /usr/local/opt/libxml2/include/libxml2/libxml libxml\n</code></pre>\n\n<p><code>/usr/local/opt</code> seems like a strange place for a system directory, but I'm tired of messing with it.</p>\n\n<p>Once I did this, and went back into my app directory, <code>bundle install</code> worked. Well, I mean it broke again but it was on <code>therubyracer</code> this time. So it at least jumped this hurdle.</p>\n"}], "owner": {"reputation": 11596, "user_id": 465986, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/592491f3adae59ba7f0416760d5361ab?s=128&d=identicon&r=PG", "display_name": "AKWF", "link": "https://stackoverflow.com/users/465986/akwf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576506146, "creation_date": 1576449750, "last_edit_date": 1576451945, "question_id": 59348710, "link": "https://stackoverflow.com/questions/59348710/bundler-v2-0-2-refuses-to-install-libxml-ruby-3-1-0-on-mac-os-catalina", "title": "Bundler v2.0.2 refuses to install libxml-ruby 3.1.0 on Mac OS Catalina", "body": "<p>I have found all of the answers of how to install <code>libxml-ruby</code> with the <code>gem install</code> command:</p>\n\n<pre><code>gem install libxml-ruby -v '3.1.0' -- --with-xml2-config=/usr/local/opt/libxml2/bin/xml2-config --with-xml2-dir=/usr/local/opt/libxml2 --with-xml2-lib=/usr/local/opt/libxml2/lib --with-xml2-include=/usr/local/opt/libxml2/include\n</code></pre>\n\n<p>Works beautifully! But then running this right afterward:</p>\n\n<pre><code>bundle install\n</code></pre>\n\n<p>gives the unhelpful error:</p>\n\n<pre><code>Fetching libxml-ruby 3.1.0\nInstalling libxml-ruby 3.1.0 with native extensions\nGem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\n    current directory: /Users/me/myApp/code/myApp/.gems/ruby/2.6.0/gems/libxml-ruby-3.1.0/ext/libxml\n/Users/me/.rbenv/versions/2.6.3/bin/ruby -I /Users/me/.rbenv/versions/2.6.3/lib/ruby/2.6.0 -r ./siteconf20191215-25200-16wtr3.rb extconf.rb --with-xml2-config\\=/usr/local/opt/libxml2/bin/xml2-config\\\n--with-xml2-dir\\=/usr/local/opt/libxml2\\ --with-xml2-lib\\=/usr/local/opt/libxml2/lib\\ --with-xml2-include\\=/usr/local/opt/libxml2/include\n/Users/me/.rbenv/versions/2.6.3/bin/ruby: warning: shebang line ending with \\r may cause problems\nchecking for libxml/xmlversion.h in /opt/include/libxml2,/opt/local/include/libxml2,/usr/local/include/libxml2,/usr/include/libxml2... *** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/Users/me/.rbenv/versions/2.6.3/bin/$(RUBY_BASE_NAME)\n    --with-xml2-config\n</code></pre>\n\n<p>OK, it looks like the libxml2 options are not being included in the call the bundler uses to install. So let's do this:</p>\n\n<pre><code>bundle config build.libxml-ruby --with-xml2-config=/usr/local/opt/libxml2/bin/xml2-config --with-xml2-dir=/usr/local/opt/libxml2 --with-xml2-lib=/usr/local/opt/libxml2/lib --with-xml2-include=/usr/local/opt/libxml2/include\n</code></pre>\n\n<p>That should work, right? Well no it doesn't. I am dead in the water until I can get Bundler to do what it is supposed to do.</p>\n\n<p>There is no good answer for why Bundler fails here. The gem install line works. Bundler fails.</p>\n\n<p>Inside the mkmf.log file is this:</p>\n\n<pre><code>find_header: checking for libxml/xmlversion.h in /opt/include/libxml2,/opt/local/include/libxml2,/usr/local/include/libxml2,/usr/include/libxml2... -------------------- no\n</code></pre>\n\n<p>And then several failures that all relate to not being able to find that header file.</p>\n\n<p>It's looking in <code>/opt/</code>, instead of <code>/usr/local/opt</code>. I don't know how to make Bundler look in the correct place if it won't respect the bundle config commands.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 2, "creation_date": 1576440878, "post_id": 59347539, "comment_id": 104891356, "body": "Would <code>Report.select(&quot;reports.*, false as skip_cache&quot;)</code> do it?"}, {"owner": {"reputation": 2184, "user_id": 8352929, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a74f883702be71738a2e3d6f59e466ed?s=128&d=identicon&r=PG&f=1", "display_name": "adesurirey", "link": "https://stackoverflow.com/users/8352929/adesurirey"}, "reply_to_user": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1576441061, "post_id": 59347539, "comment_id": 104891404, "body": "@JoshBrody thanks but I&#39;m in a method which receives <code>reports</code> as argument, so I have no hands on it"}, {"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 4, "creation_date": 1576441181, "post_id": 59347539, "comment_id": 104891436, "body": "If <code>reports</code> hasn&#39;t been <code>#loaded?</code> yet, you can chain that select statement and it should chain that to the resulting query before it hits the database. Otherwise, I think any method you use will end up iterating through the records. Is there a specific reason why you don&#39;t want to iterate?"}, {"owner": {"reputation": 2184, "user_id": 8352929, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a74f883702be71738a2e3d6f59e466ed?s=128&d=identicon&r=PG&f=1", "display_name": "adesurirey", "link": "https://stackoverflow.com/users/8352929/adesurirey"}, "reply_to_user": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1576448806, "post_id": 59347539, "comment_id": 104893181, "body": "@JoshBrody because it&#39;s a a 14,000 records collection"}, {"owner": {"reputation": 2184, "user_id": 8352929, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a74f883702be71738a2e3d6f59e466ed?s=128&d=identicon&r=PG&f=1", "display_name": "adesurirey", "link": "https://stackoverflow.com/users/8352929/adesurirey"}, "reply_to_user": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1576449055, "post_id": 59347539, "comment_id": 104893237, "body": "@JoshBrody your solution is perfectly working, thanks. You should post an answer."}], "answers": [{"tags": [], "owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "is_accepted": true, "score": 1, "last_activity_date": 1576455301, "last_edit_date": 1576455301, "creation_date": 1576451478, "answer_id": 59348883, "question_id": 59347539, "link": "https://stackoverflow.com/questions/59347539/how-to-assign-attributes-to-all-records-in-an-activerecord-relation-without-iter/59348883#59348883", "title": "How to assign attributes to all records in an ActiveRecord_Relation without iterating?", "body": "<p><code>Report.select(\"reports.*, true as skip_cache\")</code>, granted...</p>\n\n<p><code>reports</code> hasn't been <code>#loaded?</code>: you can call that select statement and it will chain that to the resulting query before it hits the database. </p>\n"}], "owner": {"reputation": 2184, "user_id": 8352929, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a74f883702be71738a2e3d6f59e466ed?s=128&d=identicon&r=PG&f=1", "display_name": "adesurirey", "link": "https://stackoverflow.com/users/8352929/adesurirey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 59348883, "answer_count": 1, "score": 0, "last_activity_date": 1576457527, "creation_date": 1576439587, "last_edit_date": 1576457527, "question_id": 59347539, "link": "https://stackoverflow.com/questions/59347539/how-to-assign-attributes-to-all-records-in-an-activerecord-relation-without-iter", "title": "How to assign attributes to all records in an ActiveRecord_Relation without iterating?", "body": "<p>I want to assign the same attribute, the same value, to an entire <code>Report::ActiveRecord_Relation</code>.</p>\n\n<p>I know I can do this by iterating like this:</p>\n\n<pre><code>reports.each { |report| report.skip_cache = true }\n</code></pre>\n\n<p>But because the collection includes ~14,000 records I would like to do it <strong>without iterating</strong>.</p>\n\n<p>Something like: </p>\n\n<pre><code>reports.assign_attributes(skip_cache: true)\n</code></pre>\n\n<p>...which raises a <code>NoMethodError</code></p>\n"}, {"tags": ["ruby", "nested-loops"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1576439139, "post_id": 59347316, "comment_id": 104890904, "body": "This sounds like homework. If so, read &quot;<a href=\"https://meta.stackoverflow.com/q/334822/128421\">How do I ask and answer homework questions?</a>&quot;."}, {"owner": {"reputation": 43, "user_id": 12384421, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jWQPo.jpg?s=128&g=1", "display_name": "Max Feldmann", "link": "https://stackoverflow.com/users/12384421/max-feldmann"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1576441056, "post_id": 59347316, "comment_id": 104891403, "body": "hi @theTinMan yes this is homework, thank&#180;s for the article, i&#180;ll respect that in the future!!"}], "answers": [{"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1576439240, "post_id": 59347415, "comment_id": 104890936, "body": "See &quot;<a href=\"https://medium.com/@heyoka/dont-use-click-here-f32f445d1021\" rel=\"nofollow noreferrer\">Don\u2019t use \u201cclick here\u201d and other common hyperlink mistakes</a>&quot;."}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1576439430, "post_id": 59347415, "comment_id": 104890980, "body": "@theTinMan You mean &quot;See <a href=\"https://medium.com/@heyoka/dont-use-click-here-f32f445d1021\" rel=\"nofollow noreferrer\">this</a>&quot; ? Thanks for the tip, it is indeed a hard to break habit"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1576439680, "post_id": 59347415, "comment_id": 104891056, "body": "It is until you look at it from the point of view of this site. We need accurate and useful Google searches, so accurate anchor link text is useful. Also, a link that is obscure is less likely to be clicked so it&#39;s less useful."}, {"owner": {"reputation": 43, "user_id": 12384421, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jWQPo.jpg?s=128&g=1", "display_name": "Max Feldmann", "link": "https://stackoverflow.com/users/12384421/max-feldmann"}, "edited": false, "score": 0, "creation_date": 1576441133, "post_id": 59347415, "comment_id": 104891419, "body": "Hi @Viktor thank&#180;s a lot for your help! I have not yet learned about regular expressions, but your solution got me thinking and I found a way to make my approach work!"}, {"owner": {"reputation": 43, "user_id": 12384421, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jWQPo.jpg?s=128&g=1", "display_name": "Max Feldmann", "link": "https://stackoverflow.com/users/12384421/max-feldmann"}, "edited": false, "score": 0, "creation_date": 1576441382, "post_id": 59347415, "comment_id": 104891487, "body": "@Viktor instead of using your regex in the block of .select, I throw c.join(&quot;&quot;) into the helper method from my code, getting back true if the joined pair contains all vowels. Not very clean, but at least I understand it entirely :)"}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "reply_to_user": {"reputation": 43, "user_id": 12384421, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jWQPo.jpg?s=128&g=1", "display_name": "Max Feldmann", "link": "https://stackoverflow.com/users/12384421/max-feldmann"}, "edited": false, "score": 0, "creation_date": 1576442102, "post_id": 59347415, "comment_id": 104891656, "body": "@MaxFeldmann I&#39;ve added a small explanation to the answer, let me know if something&#39;s unclear in my solution. If you&#39;re looking for a place to learn more Ruby and eventually Rails, I highly recommend <a href=\"https://www.theodinproject.com/\" rel=\"nofollow noreferrer\">The Odin Project</a> . Good luck!"}], "tags": [], "owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "is_accepted": false, "score": 2, "last_activity_date": 1576441861, "last_edit_date": 1576441861, "creation_date": 1576438468, "answer_id": 59347415, "question_id": 59347316, "link": "https://stackoverflow.com/questions/59347316/how-to-find-two-elements-of-the-same-array-that-contain-all-vowels/59347415#59347415", "title": "How to find two elements of the same array that contain all vowels", "body": "<p>You said pairs so I assume it's a combination of two elements. I've made a combination of each two elements in the array using the <a href=\"https://apidock.com/ruby/Array/combination\" rel=\"nofollow noreferrer\"><code>#combination</code></a> method. Then I <a href=\"https://ruby-doc.org/core-2.6.5/Enumerable.html#method-i-select\" rel=\"nofollow noreferrer\"><code>#select</code></a>-ed only those pairs that contain all vowels once they're joined. Finally, I made sure to join those pairs :</p>\n\n<pre><code>[\"goat\", \"action\", \"tear\", \"impromptu\", \"tired\", \"europe\"]\n.combination(2)\n.select { |c| c.join('') =~ /\\b(?=\\w*?a)(?=\\w*?e)(?=\\w*?i)(?=\\w*?o)(?=\\w*?u)[a-zA-Z]+\\b/ }\n.map{ |w| w.join(' ') }\n\n#=&gt; [\"action europe\", \"tear impromptu\"]\n</code></pre>\n\n<p>The regex is from \"<a href=\"https://stackoverflow.com/questions/54267095/what-is-the-regex-to-match-the-words-containing-all-the-vowels/54267325#54267325\">What is the regex to match the words containing all the vowels?</a>\".</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 12384421, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jWQPo.jpg?s=128&g=1", "display_name": "Max Feldmann", "link": "https://stackoverflow.com/users/12384421/max-feldmann"}, "edited": false, "score": 0, "creation_date": 1576441787, "post_id": 59347686, "comment_id": 104891579, "body": "Thank you so much for the breakdown @theTinMan! It is indeed homework, but I have no school to teach me (unfortunately)."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "reply_to_user": {"reputation": 43, "user_id": 12384421, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jWQPo.jpg?s=128&g=1", "display_name": "Max Feldmann", "link": "https://stackoverflow.com/users/12384421/max-feldmann"}, "edited": false, "score": 0, "creation_date": 1576442986, "post_id": 59347686, "comment_id": 104891865, "body": "There&#39;s nothing wrong with asking homework-type questions here, as long as you show you put in the effort and ask a good question, which I think you did. I added a second piece of code to see what that&#39;d do."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1576475768, "post_id": 59347686, "comment_id": 104897890, "body": "Clever! You can tweak your code by reordering <code>str[&#39;a&#39;] &amp;&amp; str[&#39;e&#39;] &amp;&amp; str[&#39;i&#39;] &amp;&amp; str[&#39;o&#39;] &amp;&amp; str[&#39;u&#39;]</code> to <code>str[&#39;u&#39;] &amp;&amp; str[&#39;i&#39;] &amp;&amp; str[&#39;o&#39;] &amp;&amp; str[&#39;a&#39;] &amp;&amp; str[&#39;e&#39;]</code>. <a href=\"https://en.wikipedia.org/wiki/Letter_frequency\" rel=\"nofollow noreferrer\">This wiki</a> reports that the average frequency of the letters &#39;a&#39;, &#39;e&#39;, &#39;i&#39;, &#39;o&#39; and &#39;u&#39; in English text is, respectively, 8.167%, 12.702%, 6.966%, 7.507% and 2.758%. You therefore should be able to short-circuit sooner, on average, by checking letters in order of their average frequency."}], "tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 2, "last_activity_date": 1576442949, "last_edit_date": 1576442949, "creation_date": 1576440907, "answer_id": 59347686, "question_id": 59347316, "link": "https://stackoverflow.com/questions/59347316/how-to-find-two-elements-of-the-same-array-that-contain-all-vowels/59347686#59347686", "title": "How to find two elements of the same array that contain all vowels", "body": "<p>Starting similarly to Viktor's, I'd use a simple test to see what vowels exist in the words and compare to whether they match <code>\"aeiou\"</code> after stripping duplicates and sorting them:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def ttm1(ary)\n  ary.combination(2).select { |a| \n    a.join.scan(/[aeiou]/).uniq.sort.join == 'aeiou' \n  }.map { |a| a.join(' ') }\nend\nttm1(words) # =&gt; [\"action europe\", \"tear impromptu\"]\n\n</code></pre>\n\n<p>Breaking it down so you can see what's happening.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>[\"goat\", \"action\", \"tear\", \"impromptu\", \"tired\", \"europe\"]  # =&gt; [\"goat\", \"action\", \"tear\", \"impromptu\", \"tired\", \"europe\"]\n            .combination(2)                                 \n            .select { |a| a                                 # =&gt; [\"goat\", \"action\"],        [\"goat\", \"tear\"],     [\"goat\", \"impromptu\"],     [\"goat\", \"tired\"],    [\"goat\", \"europe\"],             [\"action\", \"tear\"],        [\"action\", \"impromptu\"],        [\"action\", \"tired\"],       [\"action\", \"europe\"],                [\"tear\", \"impromptu\"],     [\"tear\", \"tired\"],    [\"tear\", \"europe\"],             [\"impromptu\", \"tired\"],    [\"impromptu\", \"europe\"],             [\"tired\", \"europe\"]\n                .join                                       # =&gt; \"goataction\",              \"goattear\",           \"goatimpromptu\",           \"goattired\",          \"goateurope\",                   \"actiontear\",              \"actionimpromptu\",              \"actiontired\",             \"actioneurope\",                      \"tearimpromptu\",           \"teartired\",          \"teareurope\",                   \"impromptutired\",          \"impromptueurope\",                   \"tiredeurope\"\n                .scan(/[aeiou]/)                            # =&gt; [\"o\", \"a\", \"a\", \"i\", \"o\"], [\"o\", \"a\", \"e\", \"a\"], [\"o\", \"a\", \"i\", \"o\", \"u\"], [\"o\", \"a\", \"i\", \"e\"], [\"o\", \"a\", \"e\", \"u\", \"o\", \"e\"], [\"a\", \"i\", \"o\", \"e\", \"a\"], [\"a\", \"i\", \"o\", \"i\", \"o\", \"u\"], [\"a\", \"i\", \"o\", \"i\", \"e\"], [\"a\", \"i\", \"o\", \"e\", \"u\", \"o\", \"e\"], [\"e\", \"a\", \"i\", \"o\", \"u\"], [\"e\", \"a\", \"i\", \"e\"], [\"e\", \"a\", \"e\", \"u\", \"o\", \"e\"], [\"i\", \"o\", \"u\", \"i\", \"e\"], [\"i\", \"o\", \"u\", \"e\", \"u\", \"o\", \"e\"], [\"i\", \"e\", \"e\", \"u\", \"o\", \"e\"]\n                .uniq                                       # =&gt; [\"o\", \"a\", \"i\"],           [\"o\", \"a\", \"e\"],      [\"o\", \"a\", \"i\", \"u\"],      [\"o\", \"a\", \"i\", \"e\"], [\"o\", \"a\", \"e\", \"u\"],           [\"a\", \"i\", \"o\", \"e\"],      [\"a\", \"i\", \"o\", \"u\"],           [\"a\", \"i\", \"o\", \"e\"],      [\"a\", \"i\", \"o\", \"e\", \"u\"],           [\"e\", \"a\", \"i\", \"o\", \"u\"], [\"e\", \"a\", \"i\"],      [\"e\", \"a\", \"u\", \"o\"],           [\"i\", \"o\", \"u\", \"e\"],      [\"i\", \"o\", \"u\", \"e\"],                [\"i\", \"e\", \"u\", \"o\"]\n                .sort                                       # =&gt; [\"a\", \"i\", \"o\"],           [\"a\", \"e\", \"o\"],      [\"a\", \"i\", \"o\", \"u\"],      [\"a\", \"e\", \"i\", \"o\"], [\"a\", \"e\", \"o\", \"u\"],           [\"a\", \"e\", \"i\", \"o\"],      [\"a\", \"i\", \"o\", \"u\"],           [\"a\", \"e\", \"i\", \"o\"],      [\"a\", \"e\", \"i\", \"o\", \"u\"],           [\"a\", \"e\", \"i\", \"o\", \"u\"], [\"a\", \"e\", \"i\"],      [\"a\", \"e\", \"o\", \"u\"],           [\"e\", \"i\", \"o\", \"u\"],      [\"e\", \"i\", \"o\", \"u\"],                [\"e\", \"i\", \"o\", \"u\"]\n                .join == 'aeiou'                            # =&gt; false,                     false,                false,                     false,                false,                          false,                     false,                          false,                     true,                                true,                      false,                false,                          false,                     false,                               false\n            }                                               # =&gt; [[\"action\", \"europe\"], [\"tear\", \"impromptu\"]]\n</code></pre>\n\n<p>Looking at the code it was jumping through hoops to find whether all the vowels exist. Every time it checked it had to step through many methods before determining whether all the vowels were found; In other words it couldn't short-circuit and fail until the very end which isn't good.</p>\n\n<p>This code will:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def ttm2(ary)\n  ary.combination(2).select { |a| \n    str = a.join \n    str[/a/] &amp;&amp; str[/e/] &amp;&amp; str[/i/] &amp;&amp; str[/o/] &amp;&amp; str[/u/]\n  }.map { |a| a.join(' ') }\nend\nttm2(words) # =&gt; [\"action europe\", \"tear impromptu\"]\n</code></pre>\n\n<p>But I don't like using the regular expression engine this way as it's slower than doing a direct lookup, which lead to:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def ttm3(ary)\n  ary.combination(2).select { |a| \n    str = a.join \n    str['a'] &amp;&amp; str['e'] &amp;&amp; str['i'] &amp;&amp; str['o'] &amp;&amp; str['u']\n  }.map { |a| a.join(' ') }\nend\n</code></pre>\n\n<p>Here's the benchmark:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'fruity'\n\nwords = [\"goat\", \"action\", \"tear\", \"impromptu\", \"tired\", \"europe\"]                                  \n\ndef viktor(ary)\n  ary.combination(2)                                                                             \n  .select { |c| c.join('') =~ /\\b(?=\\w*?a)(?=\\w*?e)(?=\\w*?i)(?=\\w*?o)(?=\\w*?u)[a-zA-Z]+\\b/ }  \n  .map{ |w| w.join(' ') }                                                                     \nend\nviktor(words) # =&gt; [\"action europe\", \"tear impromptu\"]\n\ndef ttm1(ary)\n  ary.combination(2).select { |a| \n    a.join.scan(/[aeiou]/).uniq.sort.join == 'aeiou' \n  }.map { |a| a.join(' ') }\nend\nttm1(words) # =&gt; [\"action europe\", \"tear impromptu\"]\n\ndef ttm2(ary)\n  ary.combination(2).select { |a| \n    str = a.join \n    str[/a/] &amp;&amp; str[/e/] &amp;&amp; str[/i/] &amp;&amp; str[/o/] &amp;&amp; str[/u/]\n  }.map { |a| a.join(' ') }\nend\nttm2(words) # =&gt; [\"action europe\", \"tear impromptu\"]\n\ndef ttm3(ary)\n  ary.combination(2).select { |a| \n    str = a.join \n    str['a'] &amp;&amp; str['e'] &amp;&amp; str['i'] &amp;&amp; str['o'] &amp;&amp; str['u']\n  }.map { |a| a.join(' ') }\nend\nttm3(words) # =&gt; [\"action europe\", \"tear impromptu\"]\n\ncompare {\n  _viktor { viktor(words) }\n  _ttm1 { ttm1(words) }\n  _ttm2 { ttm2(words) }\n  _ttm3 { ttm3(words) }\n}\n</code></pre>\n\n<p>With the results:</p>\n\n<pre><code># &gt;&gt; Running each test 256 times. Test will take about 1 second.\n# &gt;&gt; _ttm3 is similar to _viktor\n# &gt;&gt; _viktor is similar to _ttm2\n# &gt;&gt; _ttm2 is faster than _ttm1 by 2x \u00b1 0.1\n\n</code></pre>\n\n<p>Now, because this looks so much like a homework assignment, it's important to understand that schools are aware of Stack Overflow, and they look for students asking for help, so you probably don't want to reuse this code, especially not verbatim. </p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 12384421, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jWQPo.jpg?s=128&g=1", "display_name": "Max Feldmann", "link": "https://stackoverflow.com/users/12384421/max-feldmann"}, "edited": false, "score": 0, "creation_date": 1576442969, "post_id": 59347831, "comment_id": 104891857, "body": "hey @steenslag thx for the reply! I was able to fix it with one of the solutions provided above, but its cool that with your help I was able to make my original approach work. Yeah I have to get a lot better at using those built-in methods!"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1576443160, "post_id": 59347831, "comment_id": 104891915, "body": "Use built-in methods as much as possible. For the most part they&#39;re closer to the metal so they&#39;ll run a lot faster."}], "tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": true, "score": 1, "last_activity_date": 1576452664, "last_edit_date": 1576452664, "creation_date": 1576441987, "answer_id": 59347831, "question_id": 59347316, "link": "https://stackoverflow.com/questions/59347316/how-to-find-two-elements-of-the-same-array-that-contain-all-vowels/59347831#59347831", "title": "How to find two elements of the same array that contain all vowels", "body": "<p>Your code contains two errors, one of which is causing the error message.</p>\n\n<p><code>(0..words.length)</code> loops from 0 to 6 . <code>words[6]</code> however does not exist (arrays are zero-based), so you get nil. Replacing by <code>(0..words.length-1)</code> (twice) should take care of that.</p>\n\n<p>You will get every correct result twice, once as <code>\"action europe\"</code> and once as <code>\"europe action\"</code>. This is caused by looping too much, going two times over every combination. Replace the second loop from <code>(0..words.length-1)</code> to <code>(i..words.length-1)</code>.</p>\n\n<p>This cumbersome bookkeeping of indexes is boring and leads to mistakes very often. This is why Ruby programmers often prefer more hassle-free methods (like <code>combination</code> as in other answers), avoiding indexes altogether. </p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 3, "last_activity_date": 1601580796, "last_edit_date": 1601580796, "creation_date": 1576448512, "answer_id": 59348567, "question_id": 59347316, "link": "https://stackoverflow.com/questions/59347316/how-to-find-two-elements-of-the-same-array-that-contain-all-vowels/59348567#59348567", "title": "How to find two elements of the same array that contain all vowels", "body": "<p>The following code is intended to provide an efficient way to construct the desired array when the number of words is large. Note that, unlike the other answers, it does not make use of the method <a href=\"https://ruby-doc.org/core-2.6.3/Array.html#method-i-combination\" rel=\"nofollow noreferrer\">Array#combination</a>.</p>\n<p>The first part of the section <em>Explanation</em> (below) provides an overview of the approach taken by the algorithm. The details are then filled in.</p>\n<p><strong>Code</strong></p>\n<pre><code>require 'set'\n\nVOWELS = [&quot;a&quot;, &quot;e&quot;, &quot;i&quot;, &quot;o&quot;, &quot;u&quot;]\nVOWELS_SET = VOWELS.to_set\n\ndef all_vowel_pairs(words)\n  h = words.each_with_object({}) {|w,h| (h[(w.chars &amp; VOWELS).to_set] ||= []) &lt;&lt; w}\n  h.each_with_object([]) do |(k,v),a|\n    vowels_needed = VOWELS_SET-k\n    h.each do |kk,vv|\n      next unless kk.superset?(vowels_needed)\n      v.each {|w1| vv.each {|w2| a &lt;&lt; &quot;%s %s&quot; % [w1, w2] if w1 &lt; w2}}\n    end\n  end\nend\n</code></pre>\n<p><strong>Example</strong></p>\n<pre><code>words = [&quot;goat&quot;, &quot;action&quot;, &quot;tear&quot;, &quot;impromptu&quot;, &quot;tired&quot;, &quot;europe&quot;, &quot;hear&quot;]\n\nall_vowel_pairs(words)\n  #=&gt; [&quot;action europe&quot;, &quot;hear impromptu&quot;, &quot;impromptu tear&quot;]\n</code></pre>\n<p><strong>Explanation</strong></p>\n<p>For the given example the steps are as follows.</p>\n<pre><code>VOWELS_SET = VOWELS.to_set\n  #=&gt; #&lt;Set: {&quot;a&quot;, &quot;e&quot;, &quot;i&quot;, &quot;o&quot;, &quot;u&quot;}&gt; \n\nh = words.each_with_object({}) {|w,h| (h[(w.chars &amp; VOWELS).to_set] ||= []) &lt;&lt; w}\n  #=&gt; {#&lt;Set: {&quot;o&quot;, &quot;a&quot;}&gt;=&gt;[&quot;goat&quot;],\n  #    #&lt;Set: {&quot;a&quot;, &quot;i&quot;, &quot;o&quot;}&gt;=&gt;[&quot;action&quot;],\n  #    #&lt;Set: {&quot;e&quot;, &quot;a&quot;}&gt;=&gt;[&quot;tear&quot;, &quot;hear&quot;],\n  #    #&lt;Set: {&quot;i&quot;, &quot;o&quot;, &quot;u&quot;}&gt;=&gt;[&quot;impromptu&quot;],\n  #    #&lt;Set: {&quot;i&quot;, &quot;e&quot;}&gt;=&gt;[&quot;tired&quot;],\n  #    #&lt;Set: {&quot;e&quot;, &quot;u&quot;, &quot;o&quot;}&gt;=&gt;[&quot;europe&quot;]}\n</code></pre>\n<p>It is seen that the keys of <code>h</code> are subsets of the five vowels. The values are arrays of elements of <code>words</code> (words) that contain the vowels given by the key and no others. The values therefore collectively form a partition of <code>words</code>. When the number of words is large one would expect <code>h</code> to have 31 keys (<code>2**5 - 1</code>).</p>\n<p>We now loop through the key-value pairs of <code>h</code>. For each, with key <code>k</code> and value <code>v</code>, the set of missing vowels (<code>vowels_needed</code>) is determined, then we loop through those keys-value pairs <code>[kk, vv]</code> of <code>h</code> for which <code>kk</code> is a superset of <code>vowels_needed</code>. All combinations of elements of <code>v</code> and <code>vv</code> are then added to the array being returned (after an adjustment to avoid double-counting each pair of words).</p>\n<p>Continuing,</p>\n<pre><code>enum = h.each_with_object([])\n  #=&gt; #&lt;Enumerator: {#&lt;Set: {&quot;o&quot;, &quot;a&quot;}&gt;=&gt;[&quot;goat&quot;],\n  #                  #&lt;Set: {&quot;a&quot;, &quot;i&quot;, &quot;o&quot;}&gt;=&gt;[&quot;action&quot;],\n  #                  ...\n  #                  #&lt;Set: {&quot;e&quot;, &quot;u&quot;, &quot;o&quot;}&gt;=&gt;[&quot;europe&quot;]}: \n  #     each_with_object([])&gt; \n</code></pre>\n<p>The first value is generated by <code>enum</code> and passed to the block, and the block variables are assigned values:</p>\n<pre><code>(k,v), a = enum.next\n  #=&gt; [[#&lt;Set: {&quot;o&quot;, &quot;a&quot;}&gt;, [&quot;goat&quot;]], []]\n</code></pre>\n<p>See <a href=\"https://ruby-doc.org/core-2.6.3/Enumerator.html#method-i-next\" rel=\"nofollow noreferrer\">Enumerator#next</a>.</p>\n<p>The individual variables are assigned values by <a href=\"https://docs.ruby-lang.org/en/2.7.0/doc/syntax/assignment_rdoc.html#label-Array+Decomposition\" rel=\"nofollow noreferrer\">array decomposition</a>:</p>\n<pre><code>k #=&gt; #&lt;Set: {&quot;o&quot;, &quot;a&quot;}&gt; \nv #=&gt; [&quot;goat&quot;] \na #=&gt; [] \n</code></pre>\n<p>The block calculations are now performed.</p>\n<pre><code>vowels_needed = VOWELS_SET-k\n  #=&gt; #&lt;Set: {&quot;e&quot;, &quot;i&quot;, &quot;u&quot;}&gt; \nh.each do |kk,vv|\n  next unless kk.superset?(vowels_needed)\n  v.each {|w1| vv.each {|w2| a &lt;&lt; &quot;%s %s&quot; % [w1, w2] if w1 &lt; w2}}\nend\n</code></pre>\n<p>The word &quot;goat&quot; (<code>v</code>) has vowels &quot;o&quot; and &quot;a&quot;, so it can only be matched with words that contain vowels &quot;e&quot;, &quot;i&quot; and &quot;u&quot; (and possibly &quot;o&quot; and/or &quot;a&quot;). The expression</p>\n<pre><code>next unless kk.superset?(vowels_needed)\n</code></pre>\n<p>skips those keys of <code>h</code> (<code>kk</code>) that are not supersets of <code>vowels_needed</code>. See <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/set/rdoc/Set.html#method-i-superset-3F\" rel=\"nofollow noreferrer\">Set#superset?</a>.</p>\n<p>None of the words in <code>words</code> contain &quot;e&quot;, &quot;i&quot; and &quot;u&quot; so the array <code>a</code> is unchanged.</p>\n<p>The next element is now generated by <code>enum</code>, passed to the block and the block variables are assigned values:</p>\n<pre><code>(k,v), a = enum.next\n  #=&gt; [[#&lt;Set: {&quot;a&quot;, &quot;i&quot;, &quot;o&quot;}&gt;, [&quot;action&quot;]], []] \nk #=&gt; #&lt;Set: {&quot;a&quot;, &quot;i&quot;, &quot;o&quot;}&gt; \nv #=&gt; [&quot;action&quot;] \na #=&gt; [] \n</code></pre>\n<p>The block calculation begins:</p>\n<pre><code>vowels_needed = VOWELS_SET-k\n  #=&gt; #&lt;Set: {&quot;e&quot;, &quot;u&quot;}&gt; \n</code></pre>\n<p>We see that <code>h</code> has only one key-value pair for which the key is a superset of <code>vowels_needed</code>:</p>\n<pre><code>kk = %w|e u o|.to_set\n  #=&gt; #&lt;Set: {&quot;e&quot;, &quot;u&quot;, &quot;o&quot;}&gt; \nvv = [&quot;europe&quot;]\n</code></pre>\n<p>We therefore execute:</p>\n<pre><code>v.each {|w1| vv.each {|w2| a &lt;&lt; &quot;%s %s&quot; % [w1, w2] if w1 &lt; w2}}\n</code></pre>\n<p>which adds one element to <code>a</code>:</p>\n<pre><code>a #=&gt; [&quot;action europe&quot;]\n</code></pre>\n<p>The clause <code>if w1 &lt; w2</code> is to ensure that later in the calculations <code>&quot;europe action&quot;</code> is not added to <code>a</code>.</p>\n<p>If <code>v</code> (words containing 'a', 'i' and 'u') and <code>vv</code> (words containing 'e', 'u' and 'o') had instead been:</p>\n<pre><code>v  #=&gt; [&quot;action&quot;, &quot;notification&quot;]\nvv #=&gt; [&quot;europe&quot;, &quot;route&quot;]\n</code></pre>\n<p>we would have added <code>&quot;action europe&quot;</code>, <code>&quot;action route&quot;</code> and <code>&quot;notification route&quot;</code> to <code>a</code>. (<code>\u201deurope notification\u201d</code> would be added later, when <code>k #=&gt; #&lt;Set: {&quot;e&quot;, &quot;u&quot;, &quot;o&quot;}</code>.)</p>\n<p><strong>Benchmark</strong></p>\n<p>I benchmarked my method against others suggested using @theTinMan's <em>Fruity</em> benchmark code. The only differences were in the array of words to be tested and the addition of my method to the benchmark, which I named <code>cary</code>. For the array of words to be considered I selected 600 words at random from a file of English words on my computer:</p>\n<pre><code>words = IO.readlines('/usr/share/dict/words', chomp: true).sample(600)\nwords.first 10\n  #=&gt; [&quot;posadaship&quot;, &quot;explosively&quot;, &quot;expensilation&quot;, &quot;conservatively&quot;, &quot;plaiting&quot;,\n  #    &quot;unpillared&quot;, &quot;intertwinement&quot;, &quot;nonsolidified&quot;, &quot;uraemic&quot;, &quot;underspend&quot;]\n</code></pre>\n<p>This array was found to contain 46,436 pairs of words containing all five vowels.</p>\n<p>The results were as shown below.</p>\n<pre><code>compare {\n  _viktor { viktor(words) }\n  _ttm1 { ttm1(words) }\n  _ttm2 { ttm2(words) }\n  _ttm3 { ttm3(words) }\n  _cary { cary(words) }\n}\n</code></pre>\n\n<pre><code>Running each test once. Test will take about 44 seconds.\n_cary is faster than _ttm3 by 5x \u00b1 0.1\n_ttm3 is faster than _viktor by 50.0% \u00b1 1.0%\n_viktor is faster than _ttm2 by 30.000000000000004% \u00b1 1.0%\n_ttm2 is faster than _ttm1 by 2.4x \u00b1 0.1\n</code></pre>\n<p>I then compared <code>cary</code> with <code>ttm3</code> for 1,000 randomly selected words. This array was found to contain 125,068 pairs of words containing all five vowels. That result was as follows:</p>\n<pre><code>Running each test once. Test will take about 19 seconds.\n_cary is faster than _ttm3 by 3x \u00b1 1.0\n</code></pre>\n<p>To get a feel for the variability of the benchmark I ran this last comparison twice more, each with a new random selection of 1,000 words. That gave me the following results:</p>\n<pre><code>Running each test once. Test will take about 17 seconds.\n_cary is faster than _ttm3 by 5x \u00b1 1.0\n</code></pre>\n\n<pre><code>Running each test once. Test will take about 18 seconds.\n_cary is faster than _ttm3 by 4x \u00b1 1.0\n</code></pre>\n<p>It is seen the there is considerable variation among the samples.</p>\n"}], "owner": {"reputation": 43, "user_id": 12384421, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jWQPo.jpg?s=128&g=1", "display_name": "Max Feldmann", "link": "https://stackoverflow.com/users/12384421/max-feldmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 1, "accepted_answer_id": 59347831, "answer_count": 4, "score": 4, "last_activity_date": 1601580796, "creation_date": 1576437773, "last_edit_date": 1576439527, "question_id": 59347316, "link": "https://stackoverflow.com/questions/59347316/how-to-find-two-elements-of-the-same-array-that-contain-all-vowels", "title": "How to find two elements of the same array that contain all vowels", "body": "<p>I want to iterate a given array, for example: </p>\n\n<pre><code>[\"goat\", \"action\", \"tear\", \"impromptu\", \"tired\", \"europe\"]\n</code></pre>\n\n<p>I want to look at all possible pairs.</p>\n\n<p>The desired output is a new array, which contains all pairs, that combined contain all vowels. Also those pairs should be concatenated as one element of the output array:</p>\n\n<pre><code>[\"action europe\", \"tear impromptu\"]\n</code></pre>\n\n<p>I tried the following code, but got an error message:</p>\n\n<pre><code>No implicit conversion of nil into string.\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def all_vowel_pairs(words)\n  pairs = []\n\n  (0..words.length).each do |i|                       # iterate through words\n    (0..words.length).each do |j|                   # for every word, iterate through words again\n      pot_pair = words[i].to_s + words[j]         # build string from pair\n      if check_for_vowels(pot_pair)               # throw string to helper-method.\n        pairs &lt;&lt; words[i] + \" \" + words[j]      # if gets back true, concatenade and push to output array \"pairs\"\n      end\n    end\n  end\n  pairs\nend\n\n# helper-method to check for if a string has all vowels in it\ndef check_for_vowels(string)\n  vowels = \"aeiou\"\n  founds = []\n  string.each_char do |char|\n    if vowels.include?(char) &amp;&amp; !founds.include?(char)\n      founds &lt;&lt; char\n    end\n  end\n  if founds.length == 5\n    return true\n  end\n  false\nend\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 12500088, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDraZyAS67fbTCz-lg3-KU4M1FlcBDEtFaH0hmT=k-s128", "display_name": "Vridhi Sahu", "link": "https://stackoverflow.com/users/12500088/vridhi-sahu"}, "edited": false, "score": 0, "creation_date": 1576430649, "post_id": 59346143, "comment_id": 104888795, "body": "ya my bad, i did rake db:drop db:create db:migrate, after removing the columns from migration file, worked fine. But thanks"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 2, "last_activity_date": 1576429878, "last_edit_date": 1576429878, "creation_date": 1576429400, "answer_id": 59346143, "question_id": 59346119, "link": "https://stackoverflow.com/questions/59346119/cant-rollback-a-migration-standarderror-an-error-has-occurred-all-later-migra/59346143#59346143", "title": "Cant rollback a migration. StandardError: An error has occurred, all later migrations canceled", "body": "<p>Change it to this</p>\n\n<pre><code>  def self.down\n    remove_column :hotels, :picture\n    remove_column :hotels, :lattitude\n    remove_column :hotels, :longitude\n    remove_column :hotels, :distance\n    remove_column :hotels, :picture_file_name\n    remove_column :hotels, :picture_content_type\n  end\n</code></pre>\n\n<p>On a side note <code>lattitude</code> is misspelled and should be <code>latitude</code></p>\n"}], "owner": {"reputation": 47, "user_id": 12500088, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDraZyAS67fbTCz-lg3-KU4M1FlcBDEtFaH0hmT=k-s128", "display_name": "Vridhi Sahu", "link": "https://stackoverflow.com/users/12500088/vridhi-sahu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 59346143, "answer_count": 1, "score": 1, "last_activity_date": 1576431476, "creation_date": 1576429253, "last_edit_date": 1576431476, "question_id": 59346119, "link": "https://stackoverflow.com/questions/59346119/cant-rollback-a-migration-standarderror-an-error-has-occurred-all-later-migra", "title": "Cant rollback a migration. StandardError: An error has occurred, all later migrations canceled", "body": "<p>I just migrated a file but in the def down I forgot to place the columns in reverse order. the schema was updated after migration but i cant rollback. I tried reversing the column orders in the migration file. </p>\n\n<pre><code>class AddAttachmentPictureToHotels &lt; ActiveRecord::Migration[5.2]\n  def self.up\n    change_table :hotels do |t|\n      t.attachment :picture\n      t.float :latitude\n      t.float :longitude\n      t.float :distance\n    end\n  end\n\n  def self.down\n    remove_attachment :hotels, :picture\n    remove_float :hotels, :latitude\n    remove_float :hotels, :longitude\n    remove_float :hotels, :distance\n  end\nend\n</code></pre>\n\n<p>My schema is this</p>\n\n<pre><code>  create_table \"hotels\", options: \"ENGINE=InnoDB DEFAULT CHARSET=utf8\", force: :cascade do |t|\n    t.string \"name\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.bigint \"city_id\"\n    t.string \"picture_file_name\"\n    t.string \"picture_content_type\"\n    t.integer \"picture_file_size\"\n    t.datetime \"picture_updated_at\"\n    t.float \"lattitude\"\n    t.float \"longitude\"\n    t.float \"distance\"\n    t.index [\"city_id\"], name: \"index_hotels_on_city_id\"\n  end\n</code></pre>\n\n<p>How can i rollback it?</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "webpack"], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 12132223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d771bc90c127ff051746fe96cb03607f?s=128&d=identicon&r=PG&f=1", "display_name": "dw4050", "link": "https://stackoverflow.com/users/12132223/dw4050"}, "edited": false, "score": 0, "creation_date": 1576517177, "post_id": 59361462, "comment_id": 104916952, "body": "It doesn&#39;t load all of the dependencies for active_storage_drag_and_drop. I tested it on Rails 6. You can try with a test project to see if you get any errors in the view when the component loads. It shows no animations, only the surface is clickable and you can add files without knowing if they&#39;ve been attached."}, {"owner": {"reputation": 10071, "user_id": 771838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0169a78f851962058d63337ad0147d6?s=128&d=identicon&r=PG", "display_name": "rossta", "link": "https://stackoverflow.com/users/771838/rossta"}, "reply_to_user": {"reputation": 97, "user_id": 12132223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d771bc90c127ff051746fe96cb03607f?s=128&d=identicon&r=PG&f=1", "display_name": "dw4050", "link": "https://stackoverflow.com/users/12132223/dw4050"}, "edited": false, "score": 0, "creation_date": 1576523472, "post_id": 59361462, "comment_id": 104919623, "body": "It appears to include the exact JS provided by the gem: <a href=\"https://github.com/marinosoftware/active_storage_drag_and_drop/blob/d5aade5e2619d0ab613e50c538806547f3065672/package.json#L5\" rel=\"nofollow noreferrer\">github.com/marinosoftware/active_storage_drag_and_drop/blob/&zwnj;&#8203;&hellip;</a>"}, {"owner": {"reputation": 10071, "user_id": 771838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0169a78f851962058d63337ad0147d6?s=128&d=identicon&r=PG", "display_name": "rossta", "link": "https://stackoverflow.com/users/771838/rossta"}, "reply_to_user": {"reputation": 97, "user_id": 12132223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d771bc90c127ff051746fe96cb03607f?s=128&d=identicon&r=PG&f=1", "display_name": "dw4050", "link": "https://stackoverflow.com/users/12132223/dw4050"}, "edited": false, "score": 0, "creation_date": 1576524190, "post_id": 59361462, "comment_id": 104919905, "body": "Looks like the JS references a global variable. I&#39;ll update the answer with a workaround, but I&#39;d otherwise consider this a bug in the activestorage_drag_and_drop project."}, {"owner": {"reputation": 97, "user_id": 12132223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d771bc90c127ff051746fe96cb03607f?s=128&d=identicon&r=PG&f=1", "display_name": "dw4050", "link": "https://stackoverflow.com/users/12132223/dw4050"}, "edited": false, "score": 0, "creation_date": 1576593247, "post_id": 59361462, "comment_id": 104945154, "body": "Holy sh*t, it works. I can&#39;t update vote. Someone else has to do it."}, {"owner": {"reputation": 10071, "user_id": 771838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0169a78f851962058d63337ad0147d6?s=128&d=identicon&r=PG", "display_name": "rossta", "link": "https://stackoverflow.com/users/771838/rossta"}, "reply_to_user": {"reputation": 97, "user_id": 12132223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d771bc90c127ff051746fe96cb03607f?s=128&d=identicon&r=PG&f=1", "display_name": "dw4050", "link": "https://stackoverflow.com/users/12132223/dw4050"}, "edited": false, "score": 0, "creation_date": 1576601893, "post_id": 59361462, "comment_id": 104949749, "body": "Thanks, can you mark the question as correct for others to see?"}, {"owner": {"reputation": 97, "user_id": 12132223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d771bc90c127ff051746fe96cb03607f?s=128&d=identicon&r=PG&f=1", "display_name": "dw4050", "link": "https://stackoverflow.com/users/12132223/dw4050"}, "edited": false, "score": 0, "creation_date": 1576609113, "post_id": 59361462, "comment_id": 104952966, "body": "I don&#39;t have enough reputation points....I&#39;ll try again later on today."}], "tags": [], "owner": {"reputation": 10071, "user_id": 771838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0169a78f851962058d63337ad0147d6?s=128&d=identicon&r=PG", "display_name": "rossta", "link": "https://stackoverflow.com/users/771838/rossta"}, "is_accepted": false, "score": 2, "last_activity_date": 1576524638, "last_edit_date": 1576524638, "creation_date": 1576516837, "answer_id": 59361462, "question_id": 59346100, "link": "https://stackoverflow.com/questions/59346100/import-gems-javascript-folder-with-rails-webpacker-rails-erb-loader/59361462#59361462", "title": "Import Gem&#39;s javascript folder with Rails webpacker rails-erb-loader", "body": "<p>This package is available on NPM: <a href=\"https://www.npmjs.com/package/active_storage_drag_and_drop\" rel=\"nofollow noreferrer\">https://www.npmjs.com/package/active_storage_drag_and_drop</a></p>\n\n<p>I would instead do this:</p>\n\n<pre><code>yarn add active_storage_drag_and_drop\n</code></pre>\n\n<p>Then in your Webpack js file:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>import * as ActiveStorageDragAndDrop from \"active_storage_drag_and_drop\"\nwindow.ActiveStorageDragAndDrop = ActiveStorageDragAndDrop // needed as of v1.0.3\n</code></pre>\n\n<p><a href=\"https://github.com/rossta/rails6-webpacker-demo/commit/ce1e8eb991b681574bdb7ce0ef33ae4e34b61dfd#diff-c0a98e77a42efd669302853444d5c362\" rel=\"nofollow noreferrer\">https://github.com/rossta/rails6-webpacker-demo/commit/ce1e8eb991b681574bdb7ce0ef33ae4e34b61dfd#diff-c0a98e77a42efd669302853444d5c362</a></p>\n\n<p>I've created a working demo in a branch at <a href=\"https://github.com/rossta/rails6-webpacker-demo/tree/example/active_storage_drag_and_drop\" rel=\"nofollow noreferrer\">https://github.com/rossta/rails6-webpacker-demo/tree/example/active_storage_drag_and_drop</a></p>\n\n<blockquote>\n  <p>Because the <a href=\"https://github.com/marinosoftware/active_storage_drag_and_drop/blob/d5aade5e2619d0ab613e50c538806547f3065672/app/javascript/active_storage_drag_and_drop/default_ui.js#L12\" rel=\"nofollow noreferrer\">package's JS source makes assumptions about globals</a> as of v1.0.3, assigning the imported var in your project JS appears\n   to be necessary until the package is updated.</p>\n</blockquote>\n\n<p>You may still need the gem in your Gemfile for the Ruby-based dependencies.</p>\n\n<p>Generally, I would not recommend trying to look up javascript dependencies provided by Ruby gems via the gem path in ERB. One of the advantages of moving to Webpack/Webpacker is that you should try to leverage NPM for your dependencies where possible. </p>\n"}], "owner": {"reputation": 97, "user_id": 12132223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d771bc90c127ff051746fe96cb03607f?s=128&d=identicon&r=PG&f=1", "display_name": "dw4050", "link": "https://stackoverflow.com/users/12132223/dw4050"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1576524638, "creation_date": 1576429182, "last_edit_date": 1576430104, "question_id": 59346100, "link": "https://stackoverflow.com/questions/59346100/import-gems-javascript-folder-with-rails-webpacker-rails-erb-loader", "title": "Import Gem&#39;s javascript folder with Rails webpacker rails-erb-loader", "body": "<p>I'm trying to import the javascript from a gem's folder with Rails 6 webpacker. I've seen this only done with 1 file per import. Is it possible to grab all files with *.js extensions for a gem?</p>\n\n<p>javascript/packs/application.js.erb</p>\n\n<pre><code>import \"&lt;%= File.read(File.join(Gem.loaded_specs['active_storage_drag_and_drop'].full_gem_path, 'lib', 'assets', 'javascripts', 'active_storage_drag_and_drop/*.js')) %&gt;\";\n</code></pre>\n\n<p>Error</p>\n\n<pre><code>(erb):17:in `read': No such file or directory @ rb_sysopen -/home/user.../active_storage_drag_and_drop../assets/javascript/active_storage_drag_and_drop/index.js\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1576423713, "post_id": 59345246, "comment_id": 104887015, "body": "You could use <code>person[:children].to_i</code>. <code>nil.to_i</code> is 0 and it will have no effect on integers."}, {"owner": {"reputation": 385, "user_id": 8940624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14f8387f03a69862ece3b0b352f46ab3?s=128&d=identicon&r=PG&f=1", "display_name": "Chris A", "link": "https://stackoverflow.com/users/8940624/chris-a"}, "reply_to_user": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1576423907, "post_id": 59345246, "comment_id": 104887064, "body": "That would still exclude people with this imaginary negative number of children (I know, I should have made a better example)"}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1576440285, "post_id": 59345942, "comment_id": 104891211, "body": "I see you will soon be rolling five nines."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1576479843, "post_id": 59345942, "comment_id": 104899037, "body": "@CarySwoveland I prefer to call it <i>six figures</i> :)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1576483115, "post_id": 59345942, "comment_id": 104900069, "body": "I was alluding to <a href=\"https://www.youtube.com/watch?v=AI7cJWNMorE\" rel=\"nofollow noreferrer\">this</a> at 0:32."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1576428182, "creation_date": 1576428182, "answer_id": 59345942, "question_id": 59345246, "link": "https://stackoverflow.com/questions/59345246/ignoring-nil-parameters-in-array-select/59345942#59345942", "title": "Ignoring nil parameters in array select", "body": "<p>Explicitly filter in <code>nil</code>s.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>array = [\n  {:name =&gt; \"Steve\", :age =&gt; 32, :children =&gt; 2},\n  {:name =&gt; \"Dave\", :age =&gt; 37, :children =&gt; 4},\n  {:name =&gt; \"Barry\", :age =&gt; 40, :children =&gt; 0}\n]\n\nparams = {age: 35, children: nil}\n\nmatching_params =\n  array.select do |person|\n    (params[:age].nil? || person[:age] &gt; params[:age]) &amp;&amp;\n    (params[:children].nil? || person[:children] &gt; params[:children])\n  end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1576441837, "last_edit_date": 1576441837, "creation_date": 1576438936, "answer_id": 59347468, "question_id": 59345246, "link": "https://stackoverflow.com/questions/59345246/ignoring-nil-parameters-in-array-select/59347468#59347468", "title": "Ignoring nil parameters in array select", "body": "<p><strong>Code</strong></p>\n\n<pre><code>def select_by_age_and_children(arr, params)\n  arr.select do |p|\n    p[:age]      &gt; (params[:age] || -1) &amp;&amp;\n    p[:children] &gt; (params[:children] || -1)\n  end\nend\n</code></pre>\n\n<p><strong>Examples</strong></p>\n\n<pre><code>array = [\n  {:name =&gt; \"Steve\", :age =&gt; 32, :children =&gt; 2},\n  {:name =&gt; \"Dave\", :age =&gt; 37, :children =&gt; 4},\n  {:name =&gt; \"Barry\", :age =&gt; 40, :children =&gt; 0}\n]\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>params = { age: 35, children: 1 }\nselect_by_age_and_children(array, params)\n  #=&gt; [{:name=&gt;\"Dave\", :age=&gt;37, :children=&gt;4}] \n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>params = { age: 35, children: nil }\nselect_by_age_and_children(array, params)\n  #=&gt; [{:name=&gt;\"Dave\", :age=&gt;37, :children=&gt;4},\n  #    {:name=&gt;\"Barry\", :age=&gt;40, :children=&gt;0}] \n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>params = { age: 0, children: 1 }\nselect_by_age_and_children(array, params)\n  #=&gt; [{:name=&gt;\"Steve\", :age=&gt;32, :children=&gt;2},\n  #    {:name=&gt;\"Dave\", :age=&gt;37, :children=&gt;4}] \n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>params = { age: nil, children: nil }\nselect_by_age_and_children(array, params)\n  #=&gt; [{:name=&gt;\"Steve\", :age=&gt;32, :children=&gt;2},\n  #    {:name=&gt;\"Dave\", :age=&gt;37, :children=&gt;4},\n  #    {:name=&gt;\"Barry\", :age=&gt;40, :children=&gt;0}] \n</code></pre>\n\n<p><strong>Alternative design</strong></p>\n\n<p>Consider writing the method as follows:</p>\n\n<pre><code>def select_by_age_and_children(arr, params)\n  arr.select { p[:age] &gt;= params[:age] &amp;&amp; p[:children] &gt;= params[:children] }\nend\n</code></pre>\n\n<p>and then instead of calling it with, say: </p>\n\n<pre><code>params = { age: 35, children: nil }\n</code></pre>\n\n<p>call it with:</p>\n\n<pre><code>params = { age: 36, children: 0 }\n</code></pre>\n\n<p>As well as simplifying the code this avoids the need for the reader to understand what is meant by a <code>nil</code> value in <code>params</code>.</p>\n"}], "owner": {"reputation": 385, "user_id": 8940624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14f8387f03a69862ece3b0b352f46ab3?s=128&d=identicon&r=PG&f=1", "display_name": "Chris A", "link": "https://stackoverflow.com/users/8940624/chris-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 59345942, "answer_count": 2, "score": 0, "last_activity_date": 1576441837, "creation_date": 1576423189, "last_edit_date": 1592644375, "question_id": 59345246, "link": "https://stackoverflow.com/questions/59345246/ignoring-nil-parameters-in-array-select", "title": "Ignoring nil parameters in array select", "body": "<h2>Example</h2>\n<p>The user has made a search and has specified an age but not a number of children, i.e. wants to find people with any number of children, including zero.</p>\n<pre class=\"lang-rb prettyprint-override\"><code>array = []\nobj1 = {:name =&gt; &quot;Steve&quot;, :age =&gt; 32, :children =&gt; 2}\nobj2 = {:name =&gt; &quot;Dave&quot;, :age =&gt; 37, :children =&gt; 4}\nobj3 = {:name =&gt; &quot;Barry&quot;, :age =&gt; 40, :children =&gt; 0}\narray &lt;&lt; obj1\narray &lt;&lt; obj2\narray &lt;&lt; obj3\nputs array\n\n## replicating incoming search parameters\nparams = {}\nparams[:age] = 35\nparams[:children] = nil\n\nmatching_params = array.select{|person| person[:age] &gt; params[:age] &amp;&amp; person[:children] &gt; params[:children]}\n\n</code></pre>\n<p>If I run this code, I will get an error that it can't compare a number with <code>nil</code>.</p>\n<h2>Workaround</h2>\n<p>If I change the children part to <code>&amp;&amp; person[:children] &gt; (params[:children] || -1)</code> then this will show all people over 35. For this situation, it does what's required.</p>\n<h2>Problem</h2>\n<p>Imagine, however, a world where it's possible to have a negative number of children...I would have to change -1 to minus infinity. Is there some way to just exclude any search criteria which have nil values?</p>\n"}, {"tags": ["arrays", "ruby-on-rails", "ruby", "parallel-processing", "sitemap"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1576417579, "post_id": 59344466, "comment_id": 104885640, "body": "First question to ask yourself is if this is something that should be done in the database with something like a view. Processing huge amounts of records in Ruby will not scale anyways and will be slow no matter what."}, {"owner": {"reputation": 1, "user_id": 12540578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250530c9894bd4b2c8d609160ab44c2d?s=128&d=identicon&r=PG&f=1", "display_name": "railsie", "link": "https://stackoverflow.com/users/12540578/railsie"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1576449238, "post_id": 59344466, "comment_id": 104893284, "body": "Thanks for your reply! I need to create an array of objects to create my sitemap using the existing method of creating sitemap urls. So I guess there is no other way and just accept that it will be slow."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1576482389, "post_id": 59344466, "comment_id": 104899854, "body": "You are saying you have more than 10k records in the tables and want to find all possible combinations 8 levels deep? When I get you right then there are about 10000**8 combinations. More than a Nonillion. that probably doesn&#39;t fit into memory. This sounds like a <a href=\"https://meta.stackexchange.com/a/66378/284887\">xy problem</a> to me. Can you please elaborate on why you want to do that and what you try to archive?"}, {"owner": {"reputation": 1, "user_id": 12540578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250530c9894bd4b2c8d609160ab44c2d?s=128&d=identicon&r=PG&f=1", "display_name": "railsie", "link": "https://stackoverflow.com/users/12540578/railsie"}, "edited": false, "score": 0, "creation_date": 1576543448, "post_id": 59344466, "comment_id": 104926129, "body": "Thank you for your advice, I know that there are too many combinations and using too many memories even if it is a batch processing. But I need to use an existing method that is only able to create permalinks from objects for the sitemap(I\u2019m unable to change any logic of the method).  That is why I thought that I only have a choice to create all possible combinations in an array and then pass it to the method."}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 9906402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3fa201b0a4cb7ffdafce1fd58a61f18?s=128&d=identicon&r=PG&f=1", "display_name": "asarikz", "link": "https://stackoverflow.com/users/9906402/asarikz"}, "is_accepted": false, "score": 0, "last_activity_date": 1576529650, "last_edit_date": 1576529650, "creation_date": 1576455900, "answer_id": 59349260, "question_id": 59344466, "link": "https://stackoverflow.com/questions/59344466/faster-processing-of-nested-objects-in-ruby-ror/59349260#59349260", "title": "Faster processing of nested objects in Ruby/RoR", "body": "<p>10k records..\nUse Enumerator.</p>\n\n<pre><code>(1..target_objects.size).flat_map{|size| target_objects.combination(size) }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12540578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250530c9894bd4b2c8d609160ab44c2d?s=128&d=identicon&r=PG&f=1", "display_name": "railsie", "link": "https://stackoverflow.com/users/12540578/railsie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576529650, "creation_date": 1576417377, "question_id": 59344466, "link": "https://stackoverflow.com/questions/59344466/faster-processing-of-nested-objects-in-ruby-ror", "title": "Faster processing of nested objects in Ruby/RoR", "body": "<p>I have to create an array that can contain all possible object combinations(each object can contain more than 10k records for example stations). I wrote three objects below, but the actual code contains 8 objects (not 3). </p>\n\n<p>The problem with my code is that it is very slow and takes hours to complete. I also tried to use find_each and parallel, but I couldn't make use of it in the nested each loop. I was wondering if someone knew a way to make my code work quicker. </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>target_objects = %w[prefecture city station].each_with_object([]) do |obj_name, arr|\n  arr &lt;&lt; obj_name.classify.constantize.all\nend\ntest = []\ntarget_objects.each.with_index do |objects, index|\n  objects.each do |first_obj|\n    test &lt;&lt; first_obj\n    target_objects[(index + 1)..-1]&amp;.each&amp;.with_index(index + 1) do |second_objects, second_objects_index|\n      second_objects.each do |second_obj|\n        test &lt;&lt; [first_obj, second_obj]\n        target_objects[second_objects_index + 1..-1]&amp;.each&amp;.with_index(second_objects_index + 1) do |third_objects, third_objects_index|\n          third_objects.each do |third_obj|\n            test &lt;&lt; [first_obj, second_obj, third_obj]\n          end\n        end\n      end\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 2, "creation_date": 1576422234, "post_id": 59343915, "comment_id": 104886687, "body": "&quot;it fails&quot; and &quot;without any success&quot; are not a precise enough error descriptions for us to help you. <i>What</i> doesn&#39;t work? <i>How</i> doesn&#39;t it work? What trouble do you have with your code? Do you get an error message? What is the error message? Is the result you are getting not the result you are expecting? What result do you expect and why, what is the result you are getting and how do the two differ? Is the behavior you are observing not the desired behavior? What is the desired behavior and why, what is the observed behavior, and in what way do they differ?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1576468755, "post_id": 59343915, "comment_id": 104896554, "body": "Further to @J&#246;rgWMittag&#39;s excellent comment, using bare <code>rescue</code> is a bad, bad practice (unless you absolutely <i>know</i> without any doubt that there can only ever be one kind of error involved, which is quite rare). At the bare minimum, <code>rescue StandardError =&gt; x</code>; then you can see what <code>x</code> is."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1576662834, "post_id": 59343915, "comment_id": 104969143, "body": "Note that Windows doesn&#39;t even allow filenames that end in a period, so it is really hard to figure out what your precise problem is without a <i>lot</i> more details. Really, the only thing we know at this point, is that a filename ending with a period is <i>not</i> the problem, because such a file cannot even exist."}, {"owner": {"reputation": 1, "user_id": 10874531, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vJ_-3N0QgsM/AAAAAAAAAAI/AAAAAAAATnA/7EXZT93Q-1A/photo.jpg?sz=128", "display_name": "Ni Va", "link": "https://stackoverflow.com/users/10874531/ni-va"}, "edited": false, "score": 0, "creation_date": 1576832495, "post_id": 59343915, "comment_id": 105031288, "body": "ok so simple question: how to get mtime of a directory named &quot;vim.&quot; under windows OS with ruby functions?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10874531, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vJ_-3N0QgsM/AAAAAAAAAAI/AAAAAAAATnA/7EXZT93Q-1A/photo.jpg?sz=128", "display_name": "Ni Va", "link": "https://stackoverflow.com/users/10874531/ni-va"}, "is_accepted": false, "score": 0, "last_activity_date": 1576849928, "creation_date": 1576849928, "answer_id": 59426352, "question_id": 59343915, "link": "https://stackoverflow.com/questions/59343915/ruby-2-6-file-mtime-fails-when-filename-ends-with-dot-char/59426352#59426352", "title": "ruby 2.6 : File.mtime fails when filename ends with dot char", "body": "<p>ok so simple question: how to get mtime of a directory named \"vim.\" under windows OS with ruby functions?</p>\n"}], "owner": {"reputation": 1, "user_id": 10874531, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vJ_-3N0QgsM/AAAAAAAAAAI/AAAAAAAATnA/7EXZT93Q-1A/photo.jpg?sz=128", "display_name": "Ni Va", "link": "https://stackoverflow.com/users/10874531/ni-va"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1576849928, "creation_date": 1576413068, "question_id": 59343915, "link": "https://stackoverflow.com/questions/59343915/ruby-2-6-file-mtime-fails-when-filename-ends-with-dot-char", "title": "ruby 2.6 : File.mtime fails when filename ends with dot char", "body": "<p>On windows with ruby 2.6  File.mtime fails when filename ends with dot char.</p>\n\n<p>I have tried to replace dot by backslash dot without any success.\nThank you for advise.\nNiVa</p>\n\n<pre><code>if f =~/\\.$/\n              VIM::message('This is matching a point char ' +  f.to_s())\n              f1 = f.gsub(/\\./, '\\.')\n              VIM::message('So now its this filename that is passed ' + f1.to_s())\n              begin\n                  File.mtime(f1) \n              rescue\n                VIM::message('Unable to get mtime on File \"' + f1.to_s() + '\"')\n                VIM::message('And current path is \"' + Dir.pwd.to_s() + '\"')\n              ensure\n              end\n            else\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 10596579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/117cffcb9db0cbcb3b2b15ae51b375ea?s=128&d=identicon&r=PG&f=1", "display_name": "MTS", "link": "https://stackoverflow.com/users/10596579/mts"}, "is_accepted": true, "score": 0, "last_activity_date": 1576412779, "creation_date": 1576412779, "answer_id": 59343888, "question_id": 59343646, "link": "https://stackoverflow.com/questions/59343646/how-would-i-get-all-people-that-are-following-my-in-ruby/59343888#59343888", "title": "How would I get all people, that are following my in Ruby", "body": "<p>I found I the User.all returns all of them, and I can use the all_following, and follows like this and it works.</p>\n\n<pre><code>&lt;% @users = current_user.all_following %&gt;\n</code></pre>\n\n<p>And like this</p>\n\n<pre><code>&lt;% @users = current_user.followers %&gt;\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 10596579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/117cffcb9db0cbcb3b2b15ae51b375ea?s=128&d=identicon&r=PG&f=1", "display_name": "MTS", "link": "https://stackoverflow.com/users/10596579/mts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 59343888, "answer_count": 1, "score": 0, "last_activity_date": 1576412779, "creation_date": 1576410887, "question_id": 59343646, "link": "https://stackoverflow.com/questions/59343646/how-would-i-get-all-people-that-are-following-my-in-ruby", "title": "How would I get all people, that are following my in Ruby", "body": "<p>I am using the act_as_follower gem, and I get all the users, that I follow, but now I want all the users, that are following me, how would I do that. I checked and I think something like this\ncurrent_user.followers, but I cant get it working. My code for people that I am following is this:</p>\n\n<pre><code>&lt;% @users = User.all %&gt;\n&lt;% @users.each do |user| %&gt;\n    &lt;% unless user == current_user %&gt;\n        &lt;div class=\"container people-lists list-following\"&gt;\n            &lt;%= image_tag(\"/assets/\" +  user.avatar + \".png\",  alt: \"Logo\", class: \"people-image\") %&gt;\n            &lt;%= user.username %&gt;\n            &lt;% if user_signed_in? %&gt;\n                &lt;% unless user == current_user %&gt;\n                    &lt;% if current_user.following?(user) %&gt;\n                        &lt;%= button_to(\"Un-Follow\", user_follow_path(user.to_param, current_user.get_follow(user).id), :method =&gt; :delete, :remote =&gt; true, class: 'btn btn-primary button') %&gt;\n                    &lt;% else %&gt;\n                        &lt;%= button_to(\"Follow\", user_follows_path(user.to_param), :remote =&gt; true, class: 'btn btn-primary button') %&gt;\n                    &lt;% end %&gt;\n                &lt;% end %&gt;\n            &lt;% end %&gt;\n        &lt;/div&gt;\n    &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby", "dsl", "method-missing"], "comments": [{"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "edited": false, "score": 0, "creation_date": 1576433490, "post_id": 59343055, "comment_id": 104889565, "body": "I think the approach of using a method that yields in order to assign values is overly complex in this case. I suggest simplifying the code; often that by itself eliminates the problem. Also, for printing out configuration values, I find that the simplest way is to implement a <code>to_h</code> method that creates a hash with the values, and then using JSON, YAML, or awesome_print to output it nicely."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11086399"}, "edited": false, "score": 0, "creation_date": 1576566123, "post_id": 59364603, "comment_id": 104931113, "body": "But how to not use that app or group1 parameter in block? Like that: config = Configus.config :production do env :production do key1 &quot;value1&quot; key2 &quot;value2&quot; group1 do  key3 &quot;value3&quot; key4 &quot;value4&quot; end end"}], "tags": [], "owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "is_accepted": true, "score": 0, "last_activity_date": 1576532139, "creation_date": 1576532139, "answer_id": 59364603, "question_id": 59343055, "link": "https://stackoverflow.com/questions/59343055/how-to-use-method-missing-in-ruby/59364603#59364603", "title": "How to use method_missing in Ruby", "body": "<p>There are several things in your implementation that need to be fixed to match your expectations:</p>\n\n<p>1) <code>config</code> class method returns the result of the block execution, so in your example the <code>config</code> variable contains <code>Configus::Group1</code>, not <code>Configus</code> as you probably expect.</p>\n\n<p>2) <code>method_missing</code> now behaves in the very same way regardless of the method name. But it is quite clear that you expect different behavior for setters and getters.</p>\n\n<p>So a naive (and dirty) fix could look like the following:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Configus\n  class &lt;&lt; self    \n    def config\n      yield(self) if block_given?\n      self\n    end\n\n    def method_missing(method_name, *args)\n      @config_keys ||= {}\n\n      if method_name.to_s.end_with?('=')\n        @config_keys[method_name.to_s[0..-2].to_sym] = args\n      elsif @config_keys.key?(method_name)\n        @config_keys[method_name]\n      else\n        super\n      end\n    end\n\n    # ...\n  end\n\n  # ...\nend\n</code></pre>\n\n<p>(the same applies to the <code>Group1</code>, but I believe you got the idea of how to fix it too)</p>\n\n<p>There is one more practical problem with your DSL, though: the support for nested setting is hard-coded and this makes it non-flexible. You cannot build nested hierarchies this way, for example, and to introduce new nested group you have to change the class definition (add method(s)). There are plenty of ways to fix this in Ruby, for example, we could use OpenStruct that does a lot of method_missing magic under the hood and simplifies the code a bit because of that. Dirty example:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require \"singleton\"\n\nclass Configus\n  include Singleton\n\n  class ParamSet &lt; OpenStruct\n    def method_missing(method_name, *args)\n      # Naive, non-robust support for nested groups of settings\n      if block_given?\n        subgroup = self[method_name] || ParamSet.new\n        yield(subgroup)\n        self[method_name] = subgroup\n      else\n        super\n      end\n    end\n  end\n\n  def self.config\n    yield(self.instance.config) if block_given?\n    self.instance\n  end\n\n  def method_missing(method_name, *args)\n    config.send(method_name, *args) || super\n  end\n\n  def config\n    @config ||= ParamSet.new\n  end\nend\n</code></pre>\n\n<p>Now you can nest the settings, for example</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>config = Configus.config do |app|\n  app.environment = :production\n\n  app.key1 = \"value1\"\n  app.key2 = \"value2\"\n\n  app.group1 do |group1|\n    group1.key3 = \"value3\"\n    group1.key4 = \"value4\"\n    group1.group2 do |group2|\n      group2.key5 = \"foo\"\n    end\n  end\nend\n\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>config.key1 #=&gt; \"value1\"\nconfig.group1.key3 #=&gt; \"value3\"\nconfig.group1.group2.key5 #=&gt; \"foo\"\n</code></pre>\n\n<p>P.S. One more thing to mention: the rule of thumb is to define the appropriate <code>respond_to_missing?</code> each time you play with <code>method_missing</code> (at least for production-grade code)...</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11086399"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 477, "favorite_count": 0, "accepted_answer_id": 59364603, "answer_count": 1, "score": 1, "last_activity_date": 1576532139, "creation_date": 1576406251, "last_edit_date": 1576445007, "question_id": 59343055, "link": "https://stackoverflow.com/questions/59343055/how-to-use-method-missing-in-ruby", "title": "How to use method_missing in Ruby", "body": "<p>I have a homework problem to create a simple DSL configuration for Ruby.</p>\n\n<p>The problem is in <code>method_missing</code>. I need to print out values of keys, but they're printing out automaticaly, not by command.</p>\n\n<p>init.rb:</p>\n\n<pre><code>require_relative \"/home/marie/dsl/store_application.rb\"\n\nconfig = Configus.config do |app|\n  app.environment = :production\n\n  app.key1 = \"value1\"\n  app.key2 = \"value2\"\n\n  app.group1 do |group1|\n    group1.key3 = \"value3\"\n    group1.key4 = \"value4\"\n  end\nend\n</code></pre>\n\n<p>store_application.rb:</p>\n\n<pre><code>class Configus\n  class &lt;&lt; self\n    def config\n      yield(self)\n    end\n\n    #    attr_accessor :environment,\n    #                  :key1,\n    #                  :key2,\n    #                  :key3,\n    #                  :key4\n\n    def method_missing(m, args)\n      puts args\n    end\n\n    def group1(&amp;block)\n      @group1 ||= Group1.new(&amp;block)\n    end\n  end\n\n  class Group1\n    class &lt;&lt; self\n      def new\n        unless @instance\n          yield(self)\n        end\n        @instance ||= self\n      end\n\n      # attr_accessor :key1,\n      #               :key2,\n      #               :key3,\n      #               :key4\n\n      def method_missing(m, *args)\n        p m, args\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Ruby's init.rb output:</p>\n\n<pre><code>marie@marie:~/dsl$ ruby init.rb \nproduction\nvalue1\nvalue2\n:key3=\n[\"value3\"]\n:key4=\n[\"value4\"]\n</code></pre>\n\n<p>The problem is that the values are printing automatically, I need to print them out using:</p>\n\n<pre><code>config.key1         =&gt; 'value1'\nconfig.key2         =&gt; 'value2'\nconfig::Group1.key3 =&gt; 'value3'\nconfig::Group1.key4 =&gt; 'value4'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1576406313, "post_id": 59342855, "comment_id": 104883299, "body": "did you try <code>rbenv rehash</code> ?"}, {"owner": {"reputation": 725, "user_id": 9774506, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Falko", "link": "https://stackoverflow.com/users/9774506/falko"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1576407537, "post_id": 59342855, "comment_id": 104883499, "body": "Hey, have just tried rbenv but thats doesnt seem to change anything"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 2, "creation_date": 1576418003, "post_id": 59342855, "comment_id": 104885743, "body": "please add output of <code>gem env</code> to your question.  Also what command are you running to get the error?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1576422571, "post_id": 59342855, "comment_id": 104886772, "body": "This question is a duplicate of <a href=\"https://stackoverflow.com/a/52128611/2988\">stackoverflow.com/a/52128611/2988</a>. Unfortunately, it can&#39;t be closed as a duplicate because that other question doesn&#39;t have an upvoted or accepted answer."}, {"owner": {"reputation": 600, "user_id": 8129831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/awcNg.jpg?s=128&g=1", "display_name": "H Dox", "link": "https://stackoverflow.com/users/8129831/h-dox"}, "edited": false, "score": 0, "creation_date": 1576424649, "post_id": 59342855, "comment_id": 104887245, "body": "I faced it once and could not find out a way to fix but after uninstalling the ruby and reinstall it, everything was fine."}], "owner": {"reputation": 725, "user_id": 9774506, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Falko", "link": "https://stackoverflow.com/users/9774506/falko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "closed_date": 1576425333, "answer_count": 0, "score": 0, "last_activity_date": 1576445078, "creation_date": 1576404419, "last_edit_date": 1576445078, "question_id": 59342855, "link": "https://stackoverflow.com/questions/59342855/should-ruby-gem-versions-match-main-ruby-version", "closed_reason": "Duplicate", "title": "should ruby gem versions match main ruby version?", "body": "<p>I having real problems with Rails after brew updates and permission changes.</p>\n\n<p>I am getting the following error and I'm wondering if the issue is because the difference in Ruby and gem versions in the path:</p>\n\n<pre><code>/Users/paul/.rbenv/versions/2.4.1/lib/ruby/gems/2.4.0/gems/activesupport-5.1.1/lib/active_support/inflector/methods.rb:74: [BUG] Segmentation fault at 0x00000000000110\n</code></pre>\n\n<p>Could this be this issues for the faults?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1576402852, "post_id": 59342247, "comment_id": 104882665, "body": "I&#39;m not sure that you&#39;ve clearly explained the problem you&#39;re trying to solve.  Have you tried to white board your user story?  Are there more than one type of action which will trigger notifications?  There are many ways to solve a problem.  But none can be recommended until the user story is clearly defined."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1576404029, "post_id": 59342247, "comment_id": 104882854, "body": "First thing that comes to mind is to use Redis which lets you set expiry time on data.  But if you want to keep it in SQL, you have to ask whether it is really necessary to delete all the records in the DB right as they expire, or whether your &quot;notification sender job&quot; (assuming you have one) can just ignore old records by comparing timestamps"}, {"owner": {"reputation": 331, "user_id": 5381106, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gxh4rssXros/AAAAAAAAAAI/AAAAAAAAERQ/HcOZQ4ijEo4/photo.jpg?sz=128", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/5381106/abhishek"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1576406898, "post_id": 59342247, "comment_id": 104883387, "body": "@lacostenycoder  Yes, there are supposed to be <code>n</code> kind of notifications. Like <code>comment</code>, <code>like</code>, <code>follow</code> and so on."}, {"owner": {"reputation": 331, "user_id": 5381106, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gxh4rssXros/AAAAAAAAAAI/AAAAAAAAERQ/HcOZQ4ijEo4/photo.jpg?sz=128", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/5381106/abhishek"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1576407159, "post_id": 59342247, "comment_id": 104883435, "body": "@maxpleaner I did try using <code>Redis</code> for this, however, the data is supposed to have multiple associations, and it was all making it too messy to handle. Second approach that you have suggested seems doable, however, it&#39;ll just keep increasing the table rows. However, that option is the least messy one as well."}], "answers": [{"tags": [], "owner": {"reputation": 9735, "user_id": 625184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d61e61fa593df732de1ccaad37ea4f59?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/625184/jon"}, "is_accepted": false, "score": 1, "last_activity_date": 1576416328, "creation_date": 1576416328, "answer_id": 59344317, "question_id": 59342247, "link": "https://stackoverflow.com/questions/59342247/how-to-create-short-lived-database-entries-in-ruby-on-rails/59344317#59344317", "title": "How to create short lived Database entries in ruby on rails?", "body": "<p>If you want these notifications displayed when the user visits the site, you don't need to do anything special with Sidekiq, Redis, Cron, etc. All you need to do is load notifications younger than 24 hours and display them. </p>\n\n<p>As an additional task, you could delete any notifications older than 24 hours at the same time, perhaps also deleting notifications you've displayed ... depending on your needs.</p>\n\n<p>However, if these notifications are to be sent directly to the user without them performing an action (loading a page) to trigger the notification, then you'll need to use some kind of scheduling system like Sidekiq.</p>\n"}, {"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 3, "last_activity_date": 1576453382, "last_edit_date": 1576453382, "creation_date": 1576416422, "answer_id": 59344325, "question_id": 59342247, "link": "https://stackoverflow.com/questions/59342247/how-to-create-short-lived-database-entries-in-ruby-on-rails/59344325#59344325", "title": "How to create short lived Database entries in ruby on rails?", "body": "<p>You could create a <a href=\"https://guides.rubyonrails.org/active_job_basics.html\" rel=\"nofollow noreferrer\">ActiveJob</a> or Rake task that purges the entire table instead:</p>\n\n<pre><code>class NotificationCleanupJob &lt; ApplicationJob\n  queue_as :default\n\n  def perform\n    Notification.where('created_at &lt; ?', 30.days.ago).delete_all\n  end\nend\n</code></pre>\n\n<p>There are various gems that can be used to set up recurring jobs such as<a href=\"https://github.com/javan/whenever\" rel=\"nofollow noreferrer\"><code>whenever</code></a>,<a href=\"https://github.com/plashchynski/crono\" rel=\"nofollow noreferrer\"><code>chrono</code></a>, <a href=\"https://github.com/tomykaira/clockwork\" rel=\"nofollow noreferrer\"><code>clockwork</code></a> and <a href=\"https://github.com/jmettraux/rufus-scheduler\" rel=\"nofollow noreferrer\"><code>rufus-scheduler</code></a>. Heroku also has a <a href=\"https://devcenter.heroku.com/articles/scheduler\" rel=\"nofollow noreferrer\">built in scheduler</a>. </p>\n\n<p>This is far more effective then setting up jobs that do this one row at a time and which will pretty much constantly eat up worker processes.</p>\n\n<p>This should be combined with filtering when you display / use the records in Rails. </p>\n"}, {"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1576419709, "creation_date": 1576419709, "answer_id": 59344797, "question_id": 59342247, "link": "https://stackoverflow.com/questions/59342247/how-to-create-short-lived-database-entries-in-ruby-on-rails/59344797#59344797", "title": "How to create short lived Database entries in ruby on rails?", "body": "<p>This is an elaboration on the previous answer.  You probably just want to set up a scope for displaying the notifications to the users, so something like this should work.</p>\n\n<pre><code>class Notification\n  belongs_to :user\n\n  STALE_DAYS ||= (ENV['STALE_NOTIFICATIONS_PERIOD'].to_i || 30).min\n  scope :active { where('created_at &gt; ?', (STALE_DAYS).days.ago) }\n  scope :stale { where('created_at &lt;= ?', (STALE_DAYS).days.ago) }\n\n  def to_s\n    self.text # or whatever name of notification body field is\n  end\nend\n</code></pre>\n\n<p>Run this job ever <code>stale</code> days. </p>\n\n<pre><code>class NotificationCleanupJob &lt; ApplicationJob\n  queue_as :default\n\n  def perform\n    Notification.where('created_at &lt; ?', (stale).days.ago).delete_all\n  end\nend\n</code></pre>\n\n<p>Then in your views you can do something like this:</p>\n\n<pre><code>&lt;% @user.notifications.active.each |notification| %&gt;\n  &lt;div class=\"notification\"&gt;\n    &lt;%= notification %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 5381106, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gxh4rssXros/AAAAAAAAAAI/AAAAAAAAERQ/HcOZQ4ijEo4/photo.jpg?sz=128", "display_name": "Abhishek", "link": "https://stackoverflow.com/users/5381106/abhishek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 59344325, "answer_count": 3, "score": 0, "last_activity_date": 1576453382, "creation_date": 1576397771, "question_id": 59342247, "link": "https://stackoverflow.com/questions/59342247/how-to-create-short-lived-database-entries-in-ruby-on-rails", "title": "How to create short lived Database entries in ruby on rails?", "body": "<p>I want to create some notifications that should be short-lived, 1 day or so. So that I can send out those notifications if the user is accessing all notifications today, but not tomorrow. </p>\n\n<p>Suppose someone is creating some post with, I want to send them a notification whenever post upload is successful. But that notification won't matter tomorrow and will create unnecessary confusion.</p>\n\n<p>I considered using <code>Sidekiq</code> for the process, in an <code>after_commit</code> hook, trigger a <code>sidekiq</code> job to run after <code>18 hrs</code>, something like:</p>\n\n<pre><code>after_commit :trigger_destroyer\n\nprivate \n\ndef trigger_destroyer\n  if notification_type == 'shortlived'\n    NotificationDestroyer.perform_in(3.hours.from_now, id)\n  end\nend\n</code></pre>\n\n<p>Or I can run a cron job that will read created_at, and type of notifications and delete them there.</p>\n\n<p>Is there any better approach?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rvm"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 3, "creation_date": 1576394365, "post_id": 59341667, "comment_id": 104881202, "body": "Can you please copy-paste the text into your question instead of linking images? That makes the text searchable for people who want to help you and it might help others in the future to find this question and answers too."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1576405195, "post_id": 59341667, "comment_id": 104883072, "body": "Check if this is possible duplicate of <a href=\"https://stackoverflow.com/questions/30741367/ruby-using-wrong-version-of-openssl\" title=\"ruby using wrong version of openssl\">stackoverflow.com/questions/30741367/&hellip;</a>"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1576405228, "post_id": 59341667, "comment_id": 104883080, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/30741367/ruby-using-wrong-version-of-openssl\">Ruby using wrong version of openssl</a>"}, {"owner": {"reputation": 53, "user_id": 2481001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b17d8198c666b8b49a4fad1a236de7c?s=128&d=identicon&r=PG", "display_name": "praveen", "link": "https://stackoverflow.com/users/2481001/praveen"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1576463729, "post_id": 59341667, "comment_id": 104895705, "body": "Sorry I could not check yesterday. I tried following the steps in the link provided. Have posted a concern in that thread when tried following the steps. Thanks @lacostenycoder!!"}], "owner": {"reputation": 53, "user_id": 2481001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b17d8198c666b8b49a4fad1a236de7c?s=128&d=identicon&r=PG", "display_name": "praveen", "link": "https://stackoverflow.com/users/2481001/praveen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 491, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576390935, "creation_date": 1576390935, "question_id": 59341667, "link": "https://stackoverflow.com/questions/59341667/there-was-an-error-installing-gem-gem-wrapper-rubygems-bundler", "title": "There was an error installing gem gem-wrapper, rubygems-bundler", "body": "<p>I am trying to install ruby version 2.1.2 using rvm.</p>\n\n<p>Below is the details of the same. Installation of ruby 2.1.2 through rvm is completed with following warnings.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ytt0a.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ytt0a.png\" alt=\"enter image description here\"></a></p>\n\n<p>After installation, when doing gem list getting below error.</p>\n\n<p><a href=\"https://i.stack.imgur.com/HPvyp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HPvyp.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am pretty new to ruby on rails. Any leads on how to solve this please?</p>\n"}, {"tags": ["ruby", "bitcoin", "elliptic-curve"], "owner": {"reputation": 477, "user_id": 2454958, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/600879854c516cd3b5c1df1817f008f2?s=128&d=identicon&r=PG", "display_name": "fade2black", "link": "https://stackoverflow.com/users/2454958/fade2black"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576691920, "creation_date": 1576371031, "last_edit_date": 1576691920, "question_id": 59340387, "link": "https://stackoverflow.com/questions/59340387/module-secp256k1-in-bitcoin-rb", "title": "Module Secp256k1 in bitcoin.rb", "body": "<p>I am reading the source code of <code>bitcoin.rb</code> (see <a href=\"https://github.com/lian/bitcoin-ruby/blob/f2c47a1653b480eda44c80d156f9328950ff1b84/lib/bitcoin.rb#L288\" rel=\"nofollow noreferrer\">here</a>). \nBut I don't understand why we need this line (576)</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>autoload :Secp256k1, \"bitcoin/ffi/secp256k1\"\n</code></pre>\n\n<p>I understand that <code>secp256k1.rb</code> is autoloaded only when we refer to it, but I don't see where it is used. The only place where the EC group is referred is here</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def bitcoin_elliptic_curve\n  ::OpenSSL::PKey::EC.new(\"secp256k1\") # &lt;= line 289\nend\n</code></pre>\n\n<p>So, could anyone explain where and how the code inside the module <code>Secp256k1</code> is used (except spec files)? \nFor example, I was expecting this module is used for generating keys or signing ing messages. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "wordpress", "woocommerce", "woocommerce-rest-api"], "comments": [{"owner": {"reputation": 271, "user_id": 12361233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b21166043f33be5d77784bba4abef56?s=128&d=identicon&r=PG&f=1", "display_name": "Kaperto", "link": "https://stackoverflow.com/users/12361233/kaperto"}, "edited": false, "score": 0, "creation_date": 1576364332, "post_id": 59339687, "comment_id": 104877316, "body": "you don&#39;t have the good configuration, for &quot;url&quot; you have to put <code>http:&#47;&#47;localhost:8888&#47;wordpress_rails&#47;wordpress</code> and for version : <code>wc&#47;v3</code>"}, {"owner": {"reputation": 273, "user_id": 4938382, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/597e66f531d159b9c835de11fb6c7d21?s=128&d=identicon&r=PG&f=1", "display_name": "Webbie", "link": "https://stackoverflow.com/users/4938382/webbie"}, "reply_to_user": {"reputation": 271, "user_id": 12361233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b21166043f33be5d77784bba4abef56?s=128&d=identicon&r=PG&f=1", "display_name": "Kaperto", "link": "https://stackoverflow.com/users/12361233/kaperto"}, "edited": false, "score": 0, "creation_date": 1576364554, "post_id": 59339687, "comment_id": 104877359, "body": "Thank you!! That works!"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 2, "creation_date": 1576367130, "post_id": 59339687, "comment_id": 104877790, "body": "Please read &quot;<a href=\"https://meta.stackoverflow.com/questions/303812/discourage-screenshots-of-code-and-or-errors\">Discourage screenshots of code and/or errors</a>&quot;. Also, <a href=\"https://meta.stackexchange.com/a/92075/153968\">grammar, spelling and capitalization are important</a> on SO. Help us maintain the site by taking the time to ensure your post meets the guidelines to the very best of your ability. Failing to do so can actually affect other user&#39;s willingness to help, so help us help you."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1576367586, "post_id": 59339687, "comment_id": 104877867, "body": "Also <a href=\"https://meta.stackoverflow.com/a/285557/128421\">meta.stackoverflow.com/a/285557/128421</a>"}], "owner": {"reputation": 273, "user_id": 4938382, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/597e66f531d159b9c835de11fb6c7d21?s=128&d=identicon&r=PG&f=1", "display_name": "Webbie", "link": "https://stackoverflow.com/users/4938382/webbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 331, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576367517, "creation_date": 1576362515, "last_edit_date": 1576367517, "question_id": 59339687, "link": "https://stackoverflow.com/questions/59339687/how-to-use-rails-to-post-to-woocommerce-rest-api", "title": "How to use Rails to post to Woocommerce REST API", "body": "<p>I'm trying write code using the Woocommerce REST API v. 3 with Ruby on Rails 6.</p>\n\n<p>The Woocommerce shop is install by MAMP and run on localhost:8888 and Rails runs on localhost:3000.</p>\n\n<p>I'm using the \"<a href=\"https://i.stack.imgur.com/bYTlA.png\" rel=\"nofollow noreferrer\">WooCommerce API - Ruby Client</a>\" gem.</p>\n\n<p>I just speedcoded to have something working and the refactor so this is my code right now:</p>\n\n<pre><code>class ProductsController &lt; ApplicationController\n  require 'woocommerce_api'\n  require 'json'\n\n  def new\n    @product = Product.new\n  end\n\n  def create\n    woocommerce = WooCommerce::API.new(\n      'http://localhost:8888/wordpress_rails/wordpress/wp-json/wc/v3/products',\n      'CLIENT_KEY',\n      'CLIENT_SECRET',\n      version: 'v3',\n      wp_api: true,\n      debug_mode: true\n    )\n    data = {\n      name: 'Premium Quality',\n      type: 'simple',\n      regular_price: '290',\n      description: 'Pellentesque habitant morbi tristique senectus et netus et malesuada \n      fames ac turpis egestas. Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor \n      sit amet, ante. Donec eu libero sit amet quam egestas semper. Aenean ultricies mi vitae est. Mauris \n     placerat eleifend leo.',\n  short_description: 'Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.'\n\n    }\n\nwoocommerce.post('products', data).parsed_response\n  end\nend\n</code></pre>\n\n<p>When I post <code>data</code> with Postman to the same URL as above, the product is created but when I'm doing a post with Rails I get the <code>rest_no_route</code> error.</p>\n\n<p>Here is my post with Postman:</p>\n\n<p><a href=\"https://i.stack.imgur.com/bYTlA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bYTlA.png\" alt=\"Create new product with Postman\"></a></p>\n\n<p>What is going wrong when I post to the REST API with Rails?</p>\n"}]