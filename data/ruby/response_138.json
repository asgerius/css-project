[{"tags": ["ruby-on-rails", "ruby", "post", "postman"], "comments": [{"owner": {"reputation": 2525, "user_id": 1762117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gt9Rc.jpg?s=128&g=1", "display_name": "MiltoxBeyond", "link": "https://stackoverflow.com/users/1762117/miltoxbeyond"}, "edited": false, "score": 0, "creation_date": 1504135578, "post_id": 45971075, "comment_id": 78901341, "body": "Can you post the html response.  Usually that should help you understand what is wrong."}, {"owner": {"reputation": 2525, "user_id": 1762117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gt9Rc.jpg?s=128&g=1", "display_name": "MiltoxBeyond", "link": "https://stackoverflow.com/users/1762117/miltoxbeyond"}, "edited": false, "score": 0, "creation_date": 1504135678, "post_id": 45971075, "comment_id": 78901356, "body": "I was able to reproduce it.  You are doing a POST request in Ruby and most likely a GET request in Postman"}], "answers": [{"comments": [{"owner": {"reputation": 1033, "user_id": 4759794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-zX1a_FExhuM/AAAAAAAAAAI/AAAAAAAAAPM/4ZwB931MXzE/photo.jpg?sz=128", "display_name": "Augusto Samam&#233; Barrientos", "link": "https://stackoverflow.com/users/4759794/augusto-samam%c3%a9-barrientos"}, "edited": false, "score": 0, "creation_date": 1504137576, "post_id": 45971157, "comment_id": 78901719, "body": "Thank you Miltox. But the website responds both to GET and POST requests. It responds to GET requests with no parameters by showing values for current month, and responds to POST requests with specified month and year parameters. You can test it yourself using Postman. You can also test it by navigating to the website, selecting the dropboxes with any valid day and month values and pressing Consultar button. This will generate a POST request that you can inspect using the browser console."}], "tags": [], "owner": {"reputation": 2525, "user_id": 1762117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gt9Rc.jpg?s=128&g=1", "display_name": "MiltoxBeyond", "link": "https://stackoverflow.com/users/1762117/miltoxbeyond"}, "is_accepted": false, "score": 0, "last_activity_date": 1504135965, "creation_date": 1504135965, "answer_id": 45971157, "question_id": 45971075, "link": "https://stackoverflow.com/questions/45971075/error-when-post-ing-through-ruby-postman-works-fine/45971157#45971157", "title": "Error when POST ing through Ruby. Postman works fine", "body": "<p>You need to probably use a GET request to get the table.  The server is not responding on the POST request because it has not been configured to respond to it.  </p>\n\n<p>The solution is to use:</p>\n\n<pre><code>uri = URI('http://www.sunat.gob.pe/cl-at-ittipcam/tcS01Alias')\nrequest = Net::HTTP::Get.new(uri)\n</code></pre>\n\n<p>instead of the code with <code>Post.new</code></p>\n"}], "owner": {"reputation": 1033, "user_id": 4759794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-zX1a_FExhuM/AAAAAAAAAAI/AAAAAAAAAPM/4ZwB931MXzE/photo.jpg?sz=128", "display_name": "Augusto Samam&#233; Barrientos", "link": "https://stackoverflow.com/users/4759794/augusto-samam%c3%a9-barrientos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 209, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504137833, "creation_date": 1504135336, "last_edit_date": 1504137833, "question_id": 45971075, "link": "https://stackoverflow.com/questions/45971075/error-when-post-ing-through-ruby-postman-works-fine", "title": "Error when POST ing through Ruby. Postman works fine", "body": "<p>I have a strange issue when trying to POST to a third party website.</p>\n\n<p>When testing using Postman, I get a correct response. However, when trying the same POST via Ruby code, I get a cryptic HTML response page from the website. HTTP Response code is 200. It's just that the website's internal logic throws an error, which should'nt happen if I'm sending the exact same request via code than the request I'm sending via Postman.</p>\n\n<p>Url is: <a href=\"http://www.sunat.gob.pe/cl-at-ittipcam/tcS01Alias\" rel=\"nofollow noreferrer\">http://www.sunat.gob.pe/cl-at-ittipcam/tcS01Alias</a></p>\n\n<p>The POST can be generated in the browser when choosing month (\"mes\") and day (\"dia\") in the dropboxes shown in that webpage. I have also inspected the network call in this case in the browser console and can find nothing funny.</p>\n\n<p>My code comes straight from the one generated by Postman. I have also tried HTTParty gem with the same error response</p>\n\n<pre><code>require 'uri'\nrequire 'net/http'\n\nurl = URI(\"http://www.sunat.gob.pe/cl-at-ittipcam/tcS01Alias\")\n\nhttp = Net::HTTP.new(url.host, url.port)\n\nrequest = Net::HTTP::Post.new(url)\nrequest[\"cache-control\"] = 'no-cache'\nrequest[\"content-type\"] = 'application/x-www-form-urlencoded'\nrequest[\"postman-token\"] = '3ba1963c-2874-89c2-5e4d-e5be2c13a560'\nrequest.body = \"mes=05&amp;anho=2016\"\n\nresponse = http.request(request)\nputs response.read_body\n</code></pre>\n\n<p>A correct response should show an HTML table filled with values. Instead I'm getting an HTML error page.</p>\n\n<p>Any help figuring out the issue would be appreciated.</p>\n\n<p>Edit: the HTML response is not really relevant, since it is a business logic error, not an HTTP error, but here it is:</p>\n\n<p>The thing is: this internal logic error is being triggered because something is different when sending the POST request via code than when sending it via Postman, and I can't figure out what.</p>\n\n<blockquote>\n  <p>\"\\r\\n\\r\\n.:: Pagina de Errores\n  ::.\\r\\n\\r\\n\\r\\n\\r\\nBODY\n  {font-style:normal;font-size:10pt;font-family:Verdana,Arial,Helvetica,sans-serif;}\\r\\nH1\n  {font-size:16pt;color:Navy;}\\r\\nA {color:Navy;}\\r\\n.msg\n  {font-style:bold;font-size:14pt;}\\r\\n.error\n  {font-style:bold;font-size:14pt;color:Red;}\\r\\n.datos\n  {font-size:12pt;}\\r\\n.soluc {font-size:12pt;}\\r\\n\\r\\n\\r\\nLa aplicaci&oacute;n\n  ha retornado el siguiente problema :\\r\\n</p>\\r\\n<br>\\r\\n\\r\\n<br>\\r\\n\\r\\nAcci&oacute;n a realizar :\\r\\n\\r\\n\\r\\nPor favor intentente nuevamente\n  realizar la operaci&oacute;n, si el problema persiste, avisar a\n  nuestro <strong>webmaster</strong>\n  o\\r\\ncomunicarse con Atenci\\xF3n a Usuarios.\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n(function(){var\n  f5_cspm={f5_p:'NEHEKPGFEEIGMFMPAJJJKDPGKDEIIJJIDBONLBJECPDLCCOBKCPONGDHNEIJOKPPCGMBMAGEAADECGEHHJAAAPLKAANKMODHPLFBCJKHMMCPOAKONNKGFELHONBMHBIO',setCharAt:function(str,index,chr){if(index>str.length-1)return\n  str;return\n  str.substr(0,index)+chr+str.substr(index+1);},get_byte:function(str,i){var\n  s=(i/16)|0;i=(i&amp;15);s=s*32;return((str.charCodeAt(i+16+s)-65)&lt;&lt;4)|(str.charCodeAt(i+s)-65);},set_byte:function(str,i,b){var\n  s=(i/16)|0;i=(i&amp;15);s=s*32;str=f5_cspm.setCharAt(str,(i+16+s),String.fromCharCode((b>>4)+65));str=f5_cspm.setCharAt(str,(i+s),String.fromCharCode((b&amp;15)+65));return\n  str;},set_latency:function(str,latency){latency=latency&amp;0xffff;str=f5_cspm.set_byte(str,40,(latency>>8));str=f5_cspm.set_byte(str,41,(latency&amp;0xff));str=f5_cspm.set_byte(str,35,2);return\n  str;},wait_perf_data:function(){try{var\n  wp=window.performance.timing;if(wp.loadEventEnd>0){var\n  res=wp.loadEventEnd-wp.navigationStart;if(res&lt;60001){var\n  cookie_val=f5_cspm.set_latency(f5_cspm.f5_p,res);window.document.cookie='f5avr1032272937aaaaaaaaaaaaaaaa='+encodeURIComponent(cookie_val)+';path=/';}\\nreturn;}}\\ncatch(err){return;}\\nsetTimeout(f5_cspm.wait_perf_data,100);return;},go:function(){var\n  chunk=window.document.cookie.split(/\\s*;\\s*/);for(var\n  i=0;i\"</p>\n</blockquote>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1504132208, "post_id": 45970492, "comment_id": 78900465, "body": "I think including an else-branch evaluating to <code>false</code> would make them identical. Otherwise your if-expression returns <code>nil</code>."}, {"owner": {"reputation": 145, "user_id": 7457255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b4868e49dc45e8ee530110f2c86d79c?s=128&d=identicon&r=PG&f=1", "display_name": "Medvedu", "link": "https://stackoverflow.com/users/7457255/medvedu"}, "edited": false, "score": 0, "creation_date": 1504133605, "post_id": 45970492, "comment_id": 78900836, "body": "Almost equivalent; there a difference with <a href=\"https://ruby-doc.org/core-2.4.1/doc/syntax/precedence_rdoc.html\" rel=\"nofollow noreferrer\">Precedence</a>. <code>&amp;&amp;</code> is more higher precedence operation."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1504176509, "post_id": 45970492, "comment_id": 78917976, "body": "@sagarpandya82: The else branch should return <code>condition</code>."}], "answers": [{"comments": [{"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 2, "creation_date": 1504131926, "post_id": 45970541, "comment_id": 78900391, "body": "It should ne noted that whenever you speak of &quot;false&quot; in your answer, its actually a falsey value (i.e. a literal <code>nil</code> or <code>false</code>) and when speaking of &quot;true&quot;, its any truethy value (i.e. anything other than <code>nil</code> or <code>false</code>)."}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1504133642, "post_id": 45970541, "comment_id": 78900847, "body": "I&#39;ve been bitten by truthiness more than once: <code>&quot;false&quot;</code> (as a String) is also truthy."}, {"owner": {"reputation": 1369, "user_id": 3491648, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fe0c441b90814d7041f99db7f6f13ed4?s=128&d=identicon&r=PG&f=1", "display_name": "ogogmad", "link": "https://stackoverflow.com/users/3491648/ogogmad"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1504188254, "post_id": 45970541, "comment_id": 78926418, "body": "@CarySwoveland I&#39;ve incorporated some of your suggestions."}], "tags": [], "owner": {"reputation": 1369, "user_id": 3491648, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fe0c441b90814d7041f99db7f6f13ed4?s=128&d=identicon&r=PG&f=1", "display_name": "ogogmad", "link": "https://stackoverflow.com/users/3491648/ogogmad"}, "is_accepted": false, "score": 4, "last_activity_date": 1504188085, "last_edit_date": 1504188085, "creation_date": 1504131637, "answer_id": 45970541, "question_id": 45970492, "link": "https://stackoverflow.com/questions/45970492/use-and-as-if-in-ruby/45970541#45970541", "title": "Use &amp;&amp; (&quot;and&quot;) as if in ruby?", "body": "<p>It's because <code>&amp;&amp;</code> short-circuits.</p>\n\n<p>Take <code>a &amp;&amp; b</code>. If <code>a</code> evaluates to false, then the expression is false regardless of what <code>b</code> is, so to avoid wasting time <code>b</code> is not evaluated. <code>b</code> only needs to be evaluated if <code>a</code> evaluates to true.</p>\n\n<p>There's a similar short-circuiting behavior for <code>||</code> ('or'). Can you work out what it is?</p>\n\n<p>[edit]</p>\n\n<p>As Holger Just just pointed out, <a href=\"https://gist.github.com/jfarmer/2647362\" rel=\"nofollow noreferrer\">when I say a \"true\" value in Ruby, I mean any <em>truthy</em> value, and when I mention a \"false\" value in Ruby, I mean any <em>falsey</em> value</a>. That is, <code>true</code> and <code>false</code> are <em>not</em> the only truthy and falsey values in Ruby. In fact, every value in Ruby except <code>nil</code> or <code>false</code> is truthy, with only those two exceptions being falsey. Notice that the string <code>\"false\"</code> and the number <code>0</code> are not one of those two exceptions, so they are actually truthy.</p>\n\n<p>We can now fully describe the behavior of <code>a &amp;&amp; b</code>:</p>\n\n<ul>\n<li>If <code>a</code> evaluates to a falsey value, then <code>a &amp;&amp; b</code> returns the value of <code>a</code>, with <code>b</code> left unevaluated.</li>\n<li>If <code>a</code> evaluates to a truthy value, then <code>a &amp;&amp; b</code> returns the value of <code>b</code>, resulting in both <code>a</code> and <code>b</code> being evaluated.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1504153828, "post_id": 45972848, "comment_id": 78905335, "body": "Please include a pound sign (<code>#</code>) before <code>=&gt;</code>  (<code>#=&gt;</code> or <code># =&gt;</code>), so readers can cut and paste to run your code without additional editing. This is a general comment, not specific to this question. You may wish to point out that <code>c = a and b</code> is equivalent to <code>(c = a) and b</code> and <code>c = a &amp;&amp; b</code> is the same as <code>c = (a &amp;&amp; b)</code>."}, {"owner": {"reputation": 3394, "user_id": 948169, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/109adf7a75c28e8955c31684b772ca27?s=128&d=identicon&r=PG", "display_name": "Mohanraj", "link": "https://stackoverflow.com/users/948169/mohanraj"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1504156108, "post_id": 45972848, "comment_id": 78905998, "body": "@CarySwoveland: I just have updated the answer, thanks."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1504165955, "post_id": 45972848, "comment_id": 78910731, "body": "The question wasn&#39;t about <code>&amp;&amp;</code> and <code>and</code>, but about <code>if</code> and <code>&amp;&amp;</code>."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1504166436, "post_id": 45972848, "comment_id": 78911043, "body": "Also, <code>and</code> should never be used in Ruby. It caused too many headaches."}], "tags": [], "owner": {"reputation": 3394, "user_id": 948169, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/109adf7a75c28e8955c31684b772ca27?s=128&d=identicon&r=PG", "display_name": "Mohanraj", "link": "https://stackoverflow.com/users/948169/mohanraj"}, "is_accepted": false, "score": 1, "last_activity_date": 1504155982, "last_edit_date": 1504155982, "creation_date": 1504150782, "answer_id": 45972848, "question_id": 45970492, "link": "https://stackoverflow.com/questions/45970492/use-and-as-if-in-ruby/45972848#45972848", "title": "Use &amp;&amp; (&quot;and&quot;) as if in ruby?", "body": "<p>Both <strong>and</strong> and <strong>&amp;&amp;</strong> are short-circuit evaluation, but <strong>&amp;&amp;</strong> takes higher-precedence and <strong>and</strong> takes lower-precedence. Below are couple examples,</p>\n\n<pre><code>a = 1\nb = 2\nc = a and b\n# =&gt; 2\nc\n# =&gt; 1\nc = a &amp;&amp; b\n# =&gt; 2\nc\n# =&gt; 2\n</code></pre>\n\n<p>So, we should be using <strong>and</strong> at some specific places.</p>\n"}, {"tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": true, "score": 1, "last_activity_date": 1504165897, "creation_date": 1504165897, "answer_id": 45976114, "question_id": 45970492, "link": "https://stackoverflow.com/questions/45970492/use-and-as-if-in-ruby/45976114#45976114", "title": "Use &amp;&amp; (&quot;and&quot;) as if in ruby?", "body": "<p>No, they're not exactly equivalent.</p>\n\n<p>If <code>condition</code> is <code>false</code> :</p>\n\n<pre><code>condition &amp;&amp; action\n</code></pre>\n\n<p>will return <code>false</code> but </p>\n\n<pre><code>if condition\n  action\nend\n</code></pre>\n\n<p>will return <code>nil</code>.</p>\n\n<p>It's a small and subtle difference, but small differences can lead to big bugs.</p>\n"}], "owner": {"reputation": 769, "user_id": 5784956, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e2edfb655831f5996138372784f45239?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias Michael Engh", "link": "https://stackoverflow.com/users/5784956/matthias-michael-engh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 45976114, "answer_count": 3, "score": 3, "last_activity_date": 1504188085, "creation_date": 1504131364, "question_id": 45970492, "link": "https://stackoverflow.com/questions/45970492/use-and-as-if-in-ruby", "title": "Use &amp;&amp; (&quot;and&quot;) as if in ruby?", "body": "<p>From some personal experimentation I've seen what seems to be a behavior of ruby \"and\"/\"&amp;&amp;\" that seems similar to an if statement.</p>\n\n<pre><code>  condition &amp;&amp; action\n</code></pre>\n\n<p>seems to be doing the same as </p>\n\n<pre><code>  if condition\n    action\n  end\n</code></pre>\n\n<p>Are these equivalent?</p>\n"}, {"tags": ["ruby", "net-ssh"], "comments": [{"owner": {"reputation": 95978, "user_id": 1079354, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c17dd9cf3e2322be19639e96da9f3eb3?s=128&d=identicon&r=PG", "display_name": "Makoto", "link": "https://stackoverflow.com/users/1079354/makoto"}, "edited": false, "score": 0, "creation_date": 1504130270, "post_id": 45970248, "comment_id": 78899862, "body": "Multiplication as a principle of CPUs is expensive.  If you don&#39;t have to multiply in your script, try not to.  In all seriousness though, you need to post the <i>specific</i> script that&#39;s being used to do this so that you satisfy the requirement of a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 243, "user_id": 311275, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2f79d9672e8e5d6f55001293a3657bf1?s=128&d=identicon&r=PG", "display_name": "KullDox", "link": "https://stackoverflow.com/users/311275/kulldox"}, "reply_to_user": {"reputation": 95978, "user_id": 1079354, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c17dd9cf3e2322be19639e96da9f3eb3?s=128&d=identicon&r=PG", "display_name": "Makoto", "link": "https://stackoverflow.com/users/1079354/makoto"}, "edited": false, "score": 0, "creation_date": 1504138060, "post_id": 45970248, "comment_id": 78901801, "body": "Actually I found this <a href=\"https://stackoverflow.com/questions/8787368/ruby-netssh-control-master\" title=\"ruby netssh control master\">stackoverflow.com/questions/8787368/ruby-netssh-control-mast&zwnj;&#8203;er</a> which kind of explains the delays. So, I&#39;m going to have multi-thread reuse of connections to avoid autenthication for every command."}], "owner": {"reputation": 243, "user_id": 311275, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2f79d9672e8e5d6f55001293a3657bf1?s=128&d=identicon&r=PG", "display_name": "KullDox", "link": "https://stackoverflow.com/users/311275/kulldox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 550, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1504199343, "creation_date": 1504129905, "last_edit_date": 1504199343, "question_id": 45970248, "link": "https://stackoverflow.com/questions/45970248/netssh-performance-why-is-it-so-slow", "title": "Net::SSH performance, why is it so slow?", "body": "<p>I have an automated test case in Ruby (using a framework I'm building <a href=\"https://github.com/kulldox/cooltest\" rel=\"nofollow noreferrer\">see github</a>), that is doing like around 15-20 SSH connections to servers under test collecting various data and logs.</p>\n\n<p>Problem is that it takes quite a while until it is actually doing anything, meaning getting to the execution itself. I've enabled the <code>require 'profile'</code> profiler in attempt to find out what is it exactly doing.\nHere is the top of the list:</p>\n\n<pre><code>     time   seconds   seconds    calls  ms/call  ms/call  name\n 18.84     8.37      8.37       82   102.10   102.10  OpenSSL::PKey::DH#generate_key!\n  6.20    11.13      2.75    45978     0.06     0.26  Net::SSH::Transport::PacketStream#poll_next_packet\n  3.93    12.87      1.75    83928     0.02     0.06  OpenSSL::PKey::DH#valid?\n  2.64    14.05      1.17    27319     0.04     0.22  Wasabi::Parser#process_type\n  2.57    15.19      1.14    13698     0.08     0.11  Net::SSH::Buffer#read\n  1.94    16.05      0.86    24438     0.04     0.64  Net::SSH::Transport::PacketStream#next_packet\n  1.83    16.87      0.81    47183     0.02     0.03  Net::SSH::Buffer#available\n  1.66    17.61      0.74    47183     0.02     0.05  Net::SSH::BufferedIo#available\n  1.58    18.31      0.70    46662     0.02     1.25  Net::SSH::Transport::Session#poll_message\n  1.57    19.00      0.70    21819     0.03     2.07  Net::SSH::Transport::Session#wait\n  1.48    19.66      0.66       84     7.83    34.37  Integer#times\n  1.48    20.32      0.66    64205     0.01     0.01  Net::SSH::Buffer#length\n  1.41    20.94      0.63    31212     0.02     0.77  Nokogiri::XML::NodeSet#each\n  1.34    21.54      0.60      834     0.71    25.34  Kernel#gem_original_require\n  1.15    22.05      0.51    26202     0.02     3.04  Array#each\n  1.06    22.52      0.47    15127     0.03     0.04  Net::SSH::Transport::HMAC::Abstract.mac_length\n  0.96    22.95      0.43     9520     0.04     0.14  Wasabi::Parser#input_output_for\n  0.94    23.37      0.42    12291     0.03     0.07  Nokogiri::XML::Searchable#extract_params\n  0.85    23.75      0.38    24438     0.02     2.26  Kernel#loop\n  0.81    24.10      0.36    19890     0.02     0.02  #&lt;OpenSSL::Cipher:0x58730a0&gt;.xor!\n  0.78    24.45      0.35     4346     0.08     0.35  Net::SSH::Buffer.from\n  0.78    24.80      0.34    28736     0.01     0.03  Savon::Builder#namespace_by_uri\n  0.73    25.12      0.33     4845     0.07     0.09  Net::SSH::Transport::State#update_next_iv\n  0.68    25.42      0.30    10865     0.03     0.14  Net::SSH::Transport::PacketStream#enqueue_packet\n  0.67    25.72      0.30       82     3.62     3.62  OpenSSL::PKey::DH#compute_key\n  0.63    26.00      0.28    12819     0.02     0.51  Hash#each\n  0.63    26.28      0.28    13003     0.02     4.07  Class#new\n  0.63    26.57      0.28    38403     0.01     0.01  Nokogiri::XML::Node#attribute\n  0.63    26.84      0.28    23036     0.01     0.02  Net::SSH::Compat.io_select\n  0.56    27.09      0.25    84338     0.00     0.00  OpenSSL::PKey::DH#pub_key\n  0.52    27.33      0.23     7893     0.03     0.10  Gem::BasicSpecification#have_file?\n  0.50    27.55      0.22   102844     0.00     0.00  Fixnum#-\n  0.49    27.77      0.22    22278     0.01     0.03  Net::SSH::Transport::PacketStream#available_for_read?\n  0.49    27.98      0.22     4525     0.05     0.18  Net::SSH::Buffer#read_long\n  0.49    28.20      0.22     4838     0.04     0.42  Net::SSH::KnownHosts#keys_for\n  0.49    28.42      0.22     2025     0.11     0.14  Net::SSH::Transport::State#increment\n  0.45    28.62      0.20   121786     0.00     0.00  Fixnum#+\n  0.45    28.82      0.20     1966     0.10     0.39  Net::SSH::Transport::ServerVersion#negotiate!\n  0.45    29.02      0.20    15117     0.01     0.06  \n</code></pre>\n\n<p>Did anyone experience something similar and maybe found the solution?</p>\n\n<p>Here is my code:</p>\n\n<pre><code>    ##\n    # generic SSH request\n    # \n    # ==== Attributes\n    # * +ssh_h+ - host\n    # * +ssh_u+ - user\n    # * +ssh_u+ - user\n    # * +ssh_p+ - password\n    # * +cmd+ - command\n    # * +onlyOutput+ - if true, return only the result of the command, else, return the command itself as well\n    # * +options+ - various options like custom port for ex\n    # \n    def sshcmd(ssh_h, ssh_u, ssh_p, cmd, onlyOutput = false, options = {})\n        ssh_port = options[:port] ? options[:port] : '22'\n        logger.debug \"SSH (#{ssh_u}@#{ssh_h}:#{ssh_port}): \" + cmd\n        Net::SSH.start(\n            ssh_h,\n            ssh_u,\n            {:port =&gt; ssh_port,\n            :password =&gt; ssh_p,\n            # :verbose =&gt; :debug,\n            :auth_methods =&gt; ['publickey','hostbased','password','keyboard-interactive'],\n            :forward_agent =&gt; true}\n        ) do|ssh| \n            out = ''\n            if onlyOutput == true\n                out = ssh.exec!(cmd)\n            else\n                out = cmd+\"\\n\"+ssh.exec!(cmd)\n            end\n            logger.debug out\n            return out\n        end\nend\n</code></pre>\n\n<p>Update: here is my current version, that works a little better. At least is connects only 3 times (1 connection per server) now:</p>\n\n<pre><code>##\n# generic SSH request\n# \n# ==== Attributes\n# * +ssh_h+ - host\n# * +ssh_u+ - user\n# * +ssh_u+ - user\n# * +ssh_p+ - password\n# * +cmd+ - command\n# * +onlyOutput+ - if true, return only the result of the command, else, return the command itself as well\n# * +options+ - various options like custom port for ex\n# \ndef sshcmd(ssh_h, ssh_u, ssh_p, cmd, onlyOutput = false, options = {})\n    ssh_port = options[:port] ? options[:port] : '22'\n    logger.debug \"SSH (#{ssh_u}@#{ssh_h}:#{ssh_port}): \" + cmd\n    logger.debug \"SSH number of SSH connections in $sshConnnections pool: #{$sshConnnections.size}\"\n    Thread.current[:user_connections] ||= {}\n    connectionName = ssh_h+\"-\"+ssh_port+\"-\"+ssh_u\n    unless Thread.current[:user_connections].key?(connectionName)\n        logger.debug \"SSH Create new SSH connection (#{ssh_u}@#{ssh_h}:#{ssh_port}) for command: \" + cmd + \"\"\n        Thread.current[:user_connections][connectionName] = Net::SSH.start(\n            ssh_h,\n            ssh_u,\n            {:port =&gt; ssh_port,\n            :password =&gt; ssh_p,\n            # :verbose =&gt; :debug,\n            :max_pkt_size =&gt; 0x10000,\n            :paranoid =&gt; false,\n            :keepalive =&gt; true,\n            :config =&gt; false,\n            :compression =&gt; true,\n            # :auth_methods =&gt; ['password','publickey','hostbased','keyboard-interactive'],\n            :auth_methods =&gt; ['password'],\n            :forward_agent =&gt; true}\n        )\n    else\n        logger.debug \"SSH Using existing SSH connection (#{ssh_u}@#{ssh_h}:#{ssh_port}) for command: \" + cmd + \"\"\n    end\n\n    if onlyOutput == true\n        out = Thread.current[:user_connections][connectionName].exec!(cmd)\n    else\n        out = cmd+\"\\n\"+Thread.current[:user_connections][connectionName].exec!(cmd)\n    end\n    logger.debug out\n    out\nend\n</code></pre>\n\n<p>And the profiler shows:</p>\n\n<pre><code> time   seconds   seconds    calls  ms/call  ms/call  name\n 38.21     8.20      8.20        3  2734.33  2734.33  OpenSSL::PKey::DH#generate_key!\n  5.25     9.33      1.13    27319     0.04     0.23  Wasabi::Parser#process_type\n  3.13    10.00      0.67      843     0.80    23.56  Kernel#gem_original_require\n  2.91    10.63      0.62    31212     0.02     0.78  Nokogiri::XML::NodeSet#each\n  2.76    11.22      0.59    12291     0.05     0.09  Nokogiri::XML::Searchable#extract_params\n  1.89    11.63      0.41    18391     0.02     2.42  Array#each\n  1.80    12.01      0.39    28736     0.01     0.03  Savon::Builder#namespace_by_uri\n  1.54    12.35      0.33    70350     0.00     0.00  Hash#[]\n  1.47    12.66      0.31     9520     0.03     0.13  Wasabi::Parser#input_output_for\n  1.23    12.92      0.26     4606     0.06     0.08  Net::SSH::Buffer#read\n  1.16    13.17      0.25    38403     0.01     0.01  Nokogiri::XML::Node#attribute\n  1.09    13.41      0.23    12468     0.02     0.12  Hash#each\n  1.03    13.63      0.22    47225     0.00     0.01  Hash#[]=\n  0.88    13.82      0.19     4097     0.05     0.16  Nokogiri::XML::Searchable#xpath_impl\n  0.86    14.00      0.18     4097     0.05     0.21  Nokogiri::XML::Searchable#xpath_internal\n  0.82    14.18      0.18     8361     0.02     0.09  Gem::BasicSpecification#have_file?\n  0.82    14.35      0.17     7200     0.02     0.30  Savon::Builder#convert_type_namespaces_to_hash\n  0.73    14.51      0.16     1623     0.10     0.15  Wasabi::CoreExt::String#snakecase\n  0.72    14.66      0.15     8194     0.02     0.05  Nokogiri::XML::XPathContext#register_namespaces\n  0.67    14.81      0.14     7446     0.02     0.03  Nokogiri::XML::Node#[]\n  0.65    14.95      0.14    31841     0.00     0.00  Nokogiri::XML::Node#to_s\n  0.58    15.07      0.12     1377     0.09     2.11  Wasabi::Parser#parse_operations\n  0.52    15.18      0.11     2995     0.04     0.12  Net::SSH::Transport::PacketStream#enqueue_packet\n  0.51    15.29      0.11    10303     0.01     0.01  Array#hash\n  0.51    15.40      0.11     1238     0.09     0.86  Net::SSH::Transport::PacketStream#poll_next_packet\n  0.50    15.51      0.11     5232     0.02     5.47  nil#\n  0.44    15.60      0.09      912     0.10     0.41  Net::SSH::Buffer.from\n  0.44    15.70      0.09     1699     0.06    11.36  Net::SSH::Transport::Session#poll_message\n  0.44    15.79      0.09     9486     0.01     1.26  Integer#upto\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 1562, "user_id": 6432429, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/6Horz.png?s=128&g=1", "display_name": "Matthew Hinea", "link": "https://stackoverflow.com/users/6432429/matthew-hinea"}, "edited": false, "score": 0, "creation_date": 1504197687, "post_id": 45974876, "comment_id": 78932743, "body": "I&#39;m specifically looking for more arbitrary coverage indicators. Not really interested in being convinced otherwise."}], "tags": [], "owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "is_accepted": false, "score": 0, "last_activity_date": 1504161742, "creation_date": 1504161742, "answer_id": 45974876, "question_id": 45969877, "link": "https://stackoverflow.com/questions/45969877/is-there-a-way-to-see-rails-test-coverage-as-methods-covered-methods-not-cove/45974876#45974876", "title": "Is there a way to see Rails test coverage as &#39;methods covered / methods not covered,&#39; rather than line by line?", "body": "<blockquote>\n  <p>if my tests engaged a method at all, that method would be considered\n  'covered.'</p>\n</blockquote>\n\n<p>That's a very arbitrary definition of covered methods. What if it has 100 lines but it returns on first guard clause? </p>\n\n<p>Because of this (I imagine) this is not feasible to implement - there would be a problem to even agree what is a covered method.  </p>\n\n<p>Such metric would lie (reporting bigger coverage). If you assumed that method is covered if all lines are covered - it would lie too, reporting smaller coverage. </p>\n\n<p>Note: line coverage is also lying a bit (check ternary operators for example), but it's the smallest liar...</p>\n"}], "owner": {"reputation": 1562, "user_id": 6432429, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/6Horz.png?s=128&g=1", "display_name": "Matthew Hinea", "link": "https://stackoverflow.com/users/6432429/matthew-hinea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1504161742, "creation_date": 1504128100, "question_id": 45969877, "link": "https://stackoverflow.com/questions/45969877/is-there-a-way-to-see-rails-test-coverage-as-methods-covered-methods-not-cove", "title": "Is there a way to see Rails test coverage as &#39;methods covered / methods not covered,&#39; rather than line by line?", "body": "<p>Using a gem like <a href=\"https://github.com/colszowka/simplecov\" rel=\"nofollow noreferrer\">SimpleCov</a> I can see my test coverage on a line-by-line basis for all the files I specify. Is there a way to see test coverage on a method-by-method basis? For example, if my tests engaged a method at all, that method would be considered 'covered.'</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "scope"], "comments": [{"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 5, "creation_date": 1504126348, "post_id": 45969478, "comment_id": 78898280, "body": "Your error says &quot;(given 1, expected 2)&quot;, not &quot;(given 2, expected 1)&quot;... are you using it the old way somewhere still?"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 3, "creation_date": 1504127485, "post_id": 45969478, "comment_id": 78898762, "body": "As an aside, that&#39;s not really a scope as it is currently written, it is just a plain old class method that is abusing <code>scope</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1961, "user_id": 1308979, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/899f97295621824a5f482a286f5062ca?s=128&d=identicon&r=PG", "display_name": "jeremywoertink", "link": "https://stackoverflow.com/users/1308979/jeremywoertink"}, "is_accepted": false, "score": 0, "last_activity_date": 1504129484, "creation_date": 1504129484, "answer_id": 45970165, "question_id": 45969478, "link": "https://stackoverflow.com/questions/45969478/send-two-parameters-to-the-same-scope/45970165#45970165", "title": "Send two parameters to the same scope", "body": "<p>You can also do this as a class method. It's still chainable, and used like the scope way.</p>\n\n<pre><code>def self.without_grupo(id_grupo, id_empresa)\n  Producto.includes(:relprogrupos)\n          .references(:relprogrupos)\n          .where(\"relprogrupos.id IS NULL OR productos.Clave not in (select distinct ProductoId from relprogrupos where IdGrupo = ?) AND relprogrupos.IdEmpresa != ?\", id_grupo, id_empresa)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1049, "user_id": 5832250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2SnJA.jpg?s=128&g=1", "display_name": "Gagan Gupta", "link": "https://stackoverflow.com/users/5832250/gagan-gupta"}, "is_accepted": false, "score": 1, "last_activity_date": 1504193928, "creation_date": 1504193928, "answer_id": 45985341, "question_id": 45969478, "link": "https://stackoverflow.com/questions/45969478/send-two-parameters-to-the-same-scope/45985341#45985341", "title": "Send two parameters to the same scope", "body": "<pre><code>scope :without_grupo, lambda {|id_grupo, id_empresa| where(\"relprogrupos.id IS NULL OR productos.Clave not in (select distinct ProductoId from relprogrupos where IdGrupo = ?) AND relprogrupos.IdEmpresa != ?\", id_grupo, id_empresa)}\n</code></pre>\n\n<p>call it like : </p>\n\n<pre><code>Producto.includes(:relprogrupos).references(:relprogrupos).without_grupo(id_grupo, id_empresa)\n</code></pre>\n\n<p>It should work.</p>\n"}], "owner": {"reputation": 321, "user_id": 7768323, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/4dc775ad1110dce42d259e3592704dcd?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/7768323/jeff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 703, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1504193928, "creation_date": 1504126235, "question_id": 45969478, "link": "https://stackoverflow.com/questions/45969478/send-two-parameters-to-the-same-scope", "title": "Send two parameters to the same scope", "body": "<p>I have a small doubt, a scope can receive more than 1 parameter? I'm trying something like this but it marks me error:</p>\n\n<p>I call it this way in the controller:</p>\n\n<pre><code>@search_productos_out = Producto.without_grupo(params[:id],params[:IdEmpresa])\n</code></pre>\n\n<p>this is the scope:</p>\n\n<pre><code>scope :without_grupo, -&gt; (id_grupo, id_empresa) {Producto.includes(:relprogrupos).references(:relprogrupos).where(\"relprogrupos.id IS NULL OR productos.Clave not in (select distinct ProductoId from relprogrupos where IdGrupo = ?) AND relprogrupos.IdEmpresa != ?\", id_grupo, id_empresa)}\n</code></pre>\n\n<p>the error:\nwrong number of arguments (given 1, expected 2)</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1504126240, "post_id": 45969471, "comment_id": 78898230, "body": "What rounding method do you want to use? What have you tried? Hint: <a href=\"https://ruby-doc.org/core-2.4.1/Enumerable.html#method-i-minmax\" rel=\"nofollow noreferrer\"><code>minmax</code></a> is a good place to start."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1504127122, "post_id": 45969471, "comment_id": 78898625, "body": "Adding 10 to each number and dividing it by 1.62 would give an array from 0 to 100, but the intermediate numbers would be quite different."}, {"owner": {"reputation": 13, "user_id": 6080280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f313c3a850b5df8fdd9466f5f17eb53?s=128&d=identicon&r=PG", "display_name": "Denny", "link": "https://stackoverflow.com/users/6080280/denny"}, "edited": false, "score": 0, "creation_date": 1504217058, "post_id": 45969471, "comment_id": 78941645, "body": "I&#39;ve added a note that the expected result is simply a guess of what the numbers would be."}], "answers": [{"tags": [], "owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "is_accepted": false, "score": 1, "last_activity_date": 1504127106, "creation_date": 1504127106, "answer_id": 45969682, "question_id": 45969471, "link": "https://stackoverflow.com/questions/45969471/scale-an-array-to-min-max/45969682#45969682", "title": "Scale an Array to min/max", "body": "<p>You can do the following:</p>\n\n<pre><code>ar = [-10, 5, 22, 54, 89, 152]\nmin = ar.min\nrange = ar.max - min\nres = ar.map do |e|\n  ((min - e).to_f / range).abs * 100\nend\nres\n# =&gt; [0.0, 9.25925925925926, 19.753086419753085, 39.50617283950617, 61.111111111111114, 100.0]\n</code></pre>\n\n<p>You probably want to round these results.</p>\n"}, {"tags": [], "owner": {"reputation": 1342, "user_id": 1143549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45da1bf4376d6f184e41de57e03789b9?s=128&d=identicon&r=PG", "display_name": "Derek Wright", "link": "https://stackoverflow.com/users/1143549/derek-wright"}, "is_accepted": false, "score": 0, "last_activity_date": 1504128254, "creation_date": 1504128254, "answer_id": 45969913, "question_id": 45969471, "link": "https://stackoverflow.com/questions/45969471/scale-an-array-to-min-max/45969913#45969913", "title": "Scale an Array to min/max", "body": "<p>Here's my approach, i decided to shift the array so first element is at 0 and then figure out the scale:</p>\n\n<pre><code>def scale(a)\n  shift = a.first * -1 if a.first != 0 || 0\n  a.map! { |n| n + shift }\n  return a if a.last == 100\n  scale = a.last.to_f / 100.00\n  a.map { |n| (n / scale).to_i }\nend\n\nputs scale([-10, 5, 22, 54, 89, 152]).inspect\nputs scale([-10, 5, 22, 54, 89, 90]).inspect\nputs scale([3, 5, 22, 54, 89, 90]).inspect\n</code></pre>\n\n<p>returns</p>\n\n<pre><code>[0, 9, 19, 39, 61, 100]\n[0, 15, 32, 64, 99, 100]\n[0, 2, 21, 58, 98, 100]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 4, "last_activity_date": 1504128641, "creation_date": 1504128641, "answer_id": 45969993, "question_id": 45969471, "link": "https://stackoverflow.com/questions/45969471/scale-an-array-to-min-max/45969993#45969993", "title": "Scale an Array to min/max", "body": "<p>Here's a simple approach:</p>\n\n<pre><code>def normalize(list, scale = 100)\n  return unless (list.length &gt;= 2)\n\n  min, max = list.minmax\n\n  range = max - min\n\n  list.map do |v|\n    ((v - min) * scale / range)\n  end\nend\n</code></pre>\n\n<p>This doesn't produce the same results as you expect, but I can't determine why you're expecting those results as scaling values linearly doesn't give those values. Here's some tests:</p>\n\n<pre><code>list = [-10, 5, 22, 54, 89, 152]\n\nnormalize(list)\n# =&gt; [0, 9, 19, 39, 61, 100]\n\n# Running it again changes nothing\nnormalize(normalize(list))\n# =&gt; [0, 9, 19, 39, 61, 100]\n\nlist = [-1,0,1]\n\nnormalize(list)\n# =&gt; [0, 50, 100]\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6080280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f313c3a850b5df8fdd9466f5f17eb53?s=128&d=identicon&r=PG", "display_name": "Denny", "link": "https://stackoverflow.com/users/6080280/denny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 502, "favorite_count": 0, "accepted_answer_id": 45969993, "answer_count": 3, "score": 1, "last_activity_date": 1504217031, "creation_date": 1504126189, "last_edit_date": 1504217031, "question_id": 45969471, "link": "https://stackoverflow.com/questions/45969471/scale-an-array-to-min-max", "title": "Scale an Array to min/max", "body": "<p>In Ruby, given the following array</p>\n\n<pre><code>[-10, 5, 22, 54, 89, 152]\n</code></pre>\n\n<p>How would I go about getting a result like the following where there is a min of 0, and a max of 100. (this result is a guess, and not an actual reflection of what the numbers should look like)</p>\n\n<pre><code>[0, 8, 24, 53, 85, 100]\n</code></pre>\n\n<p>note: that the numbers in the middle also scale to fit.</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "rubygems", "bundle"], "comments": [{"owner": {"reputation": 4243, "user_id": 4638378, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pGqPN.png?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4638378/brian"}, "edited": false, "score": 0, "creation_date": 1504126004, "post_id": 45969380, "comment_id": 78898112, "body": "Can you please post your <code>Gemfile</code> and <code>Gemfile.lock</code>?"}, {"owner": {"reputation": 81, "user_id": 6844054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd1a8dcea70099c44e2ce02ab3f5321?s=128&d=identicon&r=PG&f=1", "display_name": "chijoy", "link": "https://stackoverflow.com/users/6844054/chijoy"}, "reply_to_user": {"reputation": 4243, "user_id": 4638378, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pGqPN.png?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4638378/brian"}, "edited": false, "score": 0, "creation_date": 1504632192, "post_id": 45969380, "comment_id": 79080971, "body": "I was unable to add my gemfile and gemfile.lock, I kept getting error messages, but in the meantime, I was able to fix the issue. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 6844054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd1a8dcea70099c44e2ce02ab3f5321?s=128&d=identicon&r=PG&f=1", "display_name": "chijoy", "link": "https://stackoverflow.com/users/6844054/chijoy"}, "is_accepted": false, "score": 1, "last_activity_date": 1611959109, "last_edit_date": 1611959109, "creation_date": 1504632293, "answer_id": 46060366, "question_id": 45969380, "link": "https://stackoverflow.com/questions/45969380/could-not-find-json-1-8-6-in-any-of-the-sources-run-bundle-install-to-install/46060366#46060366", "title": "Could not find json-1.8.6 in any of the sources Run `bundle install` to install missing gems", "body": "<p>These commands fixed the issue:</p>\n<pre><code>brew update\nbrew install coreutils\n</code></pre>\n<p>Then I ran <code>bundle install</code> and json loaded properly.</p>\n"}], "owner": {"reputation": 81, "user_id": 6844054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd1a8dcea70099c44e2ce02ab3f5321?s=128&d=identicon&r=PG&f=1", "display_name": "chijoy", "link": "https://stackoverflow.com/users/6844054/chijoy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1639, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1611959109, "creation_date": 1504125782, "question_id": 45969380, "link": "https://stackoverflow.com/questions/45969380/could-not-find-json-1-8-6-in-any-of-the-sources-run-bundle-install-to-install", "title": "Could not find json-1.8.6 in any of the sources Run `bundle install` to install missing gems", "body": "<p>When trying to run rails s, I got the above error Could not find json-1.8.6 in any of the sources Run <code>bundle install</code> to install missing gems. This is what I've tried so far:</p>\n\n<pre><code>bundle install\nbundle update\nbundle exec bundle install\nbundle update json\ngem install json\ngem install json -v '1.8.6'\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 5, "creation_date": 1504124854, "post_id": 45969111, "comment_id": 78897561, "body": "<code>a[0].next</code> does NOT do what you think. Try it on this array <code>a = [10, 42, 23]</code>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1504124905, "post_id": 45969111, "comment_id": 78897593, "body": "Also, do not post pictures, post text from those pictures."}, {"owner": {"reputation": 1051, "user_id": 5451285, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/KnO3v.jpg?s=128&g=1", "display_name": "PrimeTimeTran", "link": "https://stackoverflow.com/users/5451285/primetimetran"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1504124959, "post_id": 45969111, "comment_id": 78897620, "body": "Oh man... lol. Thanks for clarifying on that @sergio. Ok, so there are no methods that do the two things I want to do then?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1504124992, "post_id": 45969111, "comment_id": 78897639, "body": "Nope, no such methods. An element has no concept of &quot;a collection it&#39;s in&quot;. It might not be in any. And it might be in 10 collections at once."}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 2, "creation_date": 1504125653, "post_id": 45969111, "comment_id": 78897947, "body": "Everyone else is correct that you&#39;re actually calling <a href=\"https://ruby-doc.org/core-2.4.0/Integer.html#method-i-next\" rel=\"nofollow noreferrer\"><code>Integer#next</code></a> and it&#39;s not doing what you think, but for completeness, the opposite is <a href=\"https://ruby-doc.org/core-2.4.0/Integer.html#method-i-pred\" rel=\"nofollow noreferrer\"><code>Integer#pred</code></a>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1504127878, "post_id": 45969111, "comment_id": 78898953, "body": "i don&#39;t understand your question. If you have an index like <code>a[0]</code>, you can simply call <code>a[1]</code>. Am I missing something?"}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 6, "last_activity_date": 1504125258, "creation_date": 1504125258, "answer_id": 45969267, "question_id": 45969111, "link": "https://stackoverflow.com/questions/45969111/find-previous-element-in-ruby-array-enumerable-enumerator/45969267#45969267", "title": "Find previous element in Ruby array Enumerable Enumerator", "body": "<p>If you have an array:</p>\n\n<pre><code>a = [ 1, 2, 3, 4 ]\n</code></pre>\n\n<p>Then calling <code>a[1]</code> will return the object <code>2</code>, and there's nothing special about that value, it's without context once you've retrieved it. As such, calling <code>next</code> on it will always yield <code>3</code> because that's what <a href=\"https://ruby-doc.org/core-2.4.0/Integer.html#method-i-next\" rel=\"noreferrer\"><code>Integer#next</code></a> does.</p>\n\n<p>In order to navigate through that array you need an iterator of some sort, like <a href=\"https://ruby-doc.org/core-2.4.0/Enumerator.html\" rel=\"noreferrer\">Enumerator</a>:</p>\n\n<pre><code>e = a.each\n</code></pre>\n\n<p>Now you can do what you want:</p>\n\n<pre><code>e.next\n# =&gt; 1\ne.next\n# =&gt; 2\n</code></pre>\n\n<p>Note that this interface isn't as flexible as you're expecting. You can call <code>next</code> to advance, or <code>rewind</code> to go back to the beginning, but there's no <code>previous</code>. Ruby doesn't have what other languages term as bi-directional iterators, but you might be able to extend this class to add the functions you need if you're feeling brave.</p>\n"}, {"tags": [], "owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "is_accepted": false, "score": -1, "last_activity_date": 1504131086, "creation_date": 1504131086, "answer_id": 45970443, "question_id": 45969111, "link": "https://stackoverflow.com/questions/45969111/find-previous-element-in-ruby-array-enumerable-enumerator/45970443#45970443", "title": "Find previous element in Ruby array Enumerable Enumerator", "body": "<pre><code>a = [1, 2, 3, 4, 5]\n\ni = 0\na[i]      #=&gt; 1\na[i.next] #=&gt; 2\na[i.pred] #=&gt; 5\n\ni = 1\ns = 1\na[i]      #=&gt; 2\na[i + s]  #=&gt; 3\na[i - s]  #=&gt; 1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 146, "user_id": 7132678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242a3d87151d5fb29155bc900c604c9e?s=128&d=identicon&r=PG&f=1", "display_name": "jethro", "link": "https://stackoverflow.com/users/7132678/jethro"}, "is_accepted": false, "score": 0, "last_activity_date": 1578080919, "creation_date": 1578080919, "answer_id": 59584510, "question_id": 45969111, "link": "https://stackoverflow.com/questions/45969111/find-previous-element-in-ruby-array-enumerable-enumerator/59584510#59584510", "title": "Find previous element in Ruby array Enumerable Enumerator", "body": "<p>I always end up whipping up something like this.</p>\n\n<p>This approach, of course, isn't limited to <code>Array</code>s - I didn't want to make it an <code>EnumerableScanner</code>, however, as some enumerations maintain complex state (think of a fibonacci sequence).</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class ArrayScanner\n  attr_reader :index, :array\n\n  def initialize(array)\n    @array = array\n    @index = 0\n  end\n\n  def next\n    raise StopIteration unless next?\n    @array[@index += 1]\n  end\n\n  def peek\n    raise StopIteration unless next?\n    @array[@index + 1]\n  end\n\n  def next?\n    @index + 1 != @array.size\n  end\n\n  def prev\n    raise StopIteration unless prev?\n    @array[@index -= 1]\n  end\n\n  def peek_prev\n    raise StopIteration unless prev?\n    @array[@index - 1]\n  end\n\n  def prev?\n    @index - 1 &gt;= 0\n  end\n\n  def eof?\n    !next?\n  end\n\n  def bof?\n    !prev?\n  end\n\n  def current\n    @array[@index]\n  end\n\n  def current=(new_value)\n    @array[@index] = new_value\n  end\n\n  def size\n    @array.size\n  end\n\n  def pos\n    @index\n  end\n\n  def rewind\n    @index = 0\n  end\nend\n\na = ArrayScanner.new [1, 2, 3, 4, 5]\na.current #=&gt; 1\na.next    #=&gt; 2\na.current #=&gt; 2\na.prev    #=&gt; 1\na.prev?   #=&gt; false\na.bof?    #=&gt; true\n4.times { a.next }\na.eof?    #=&gt; true\na.current #=&gt; 5\n</code></pre>\n\n<p>The <a href=\"https://crystal-lang.org/\" rel=\"nofollow noreferrer\">crystal language</a> has a similar approach, with it's <a href=\"https://crystal-lang.org/api/0.31.1/Iterator.html\" rel=\"nofollow noreferrer\">Iterator</a> module.</p>\n"}], "owner": {"reputation": 1051, "user_id": 5451285, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/KnO3v.jpg?s=128&g=1", "display_name": "PrimeTimeTran", "link": "https://stackoverflow.com/users/5451285/primetimetran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 646, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1578080919, "creation_date": 1504124654, "last_edit_date": 1504125161, "question_id": 45969111, "link": "https://stackoverflow.com/questions/45969111/find-previous-element-in-ruby-array-enumerable-enumerator", "title": "Find previous element in Ruby array Enumerable Enumerator", "body": "<p>I have an array <code>a = [1, 2, 3, 4, 5]</code></p>\n\n<p>If I have an element in the array, I can find the next element in the array via the \n<code>a[0].next</code></p>\n\n<p>Is there a method that I can use to find the previous element \n<code>a[1].previous</code> or <code>a[1].before</code> such that the result is </p>\n\n<p><code>#=&gt; 1</code></p>\n\n<p>I Googled around a bit and it seems as if most other similar questions involve a loop which I don't want to do. I also checked out the Ruby docs of <a href=\"https://ruby-doc.org/core-2.2.0/Enumerator.html\" rel=\"nofollow noreferrer\">Enumerator</a> &amp; <a href=\"https://ruby-doc.org/core-2.4.1/Enumerable.html\" rel=\"nofollow noreferrer\">Enumerable</a> and couldn't seem to find one.</p>\n\n<pre><code>&gt;&gt; a = [1, 2, 3, 4, 5] #=&gt; [1, 2, 3, 4, 5]\n&gt;&gt; a[0].next #=&gt; 2\n&gt;&gt; a[2].previous\nNoMethodError: undefined method `previous' for 3:Fixnum\n    from (irb):14\n    from /Users/Lois/.rvm/rubies/ruby-2.3.1/bin/irb:11:in `&lt;main&gt;'\n&gt;&gt; a[2].before\nNoMethodError: undefined method `before' for 3:Fixnum\n    from (irb):15\n    from /Users/Lois/.rvm/rubies/ruby-2.3.1/bin/irb:11:in `&lt;main&gt;'\n</code></pre>\n\n<p><strong>Thanks in advance!</strong></p>\n"}, {"tags": ["ruby", "nokogiri"], "answers": [{"tags": [], "owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "is_accepted": true, "score": 0, "last_activity_date": 1504156433, "creation_date": 1504156433, "answer_id": 45973638, "question_id": 45968545, "link": "https://stackoverflow.com/questions/45968545/extract-by-p-between-h3-content-nokogiri/45973638#45973638", "title": "Extract by &lt;p&gt; between h3 content nokogiri", "body": "<p>You should be able to do:</p>\n\n<pre><code>css = 'h3:contains(Vigentes) ~ p:has(~ h3:contains(Finalizados))'\n</code></pre>\n\n<p>But unfortunately, nokogiri doesn't behave properly for this one so we'll use xpath:</p>\n\n<pre><code>xpath = \"//h3[contains(text(), 'Vigentes')]/following-sibling::p[./following-sibling::h3[contains(text(), 'Finalizados')]]\"\npage.search(xpath).each do |p|\n  # do something\nend\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 4462974, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4ddabbf67d8cb6a87ff8389ce2cdd6ea?s=128&d=identicon&r=PG&f=1", "display_name": "Fabi&#225;n", "link": "https://stackoverflow.com/users/4462974/fabi%c3%a1n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 45973638, "answer_count": 1, "score": 0, "last_activity_date": 1504156433, "creation_date": 1504122242, "last_edit_date": 1504124944, "question_id": 45968545, "link": "https://stackoverflow.com/questions/45968545/extract-by-p-between-h3-content-nokogiri", "title": "Extract by &lt;p&gt; between h3 content nokogiri", "body": "<p>I am trying to extract only the <code>&lt;p&gt;</code> that exist between Vigentes and Finalizados without achieving it.</p>\n\n<pre><code>require 'nokogiri'\nrequire 'open-uri'\nrequire 'time'\n\n@url = \"http://www.caru.org.uy/web/servicios/llamados-a-concurso-publico-para-contratar-personal/\"\n\npage = Nokogiri::HTML(open(@url))\ndiv_content = page.css('.contenido')\n\ndiv_content.each do |item|\n\n   puts item.text\n\n   break if  item.css('h3').text == \"Finalizados\"\n\nend\n</code></pre>\n"}, {"tags": ["ruby", "console", "rubygems"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1504121337, "post_id": 45968342, "comment_id": 78895764, "body": "Jekyll probably requires them to work. When a library is installed, all of its dependencies are typically installed along with it if they aren&#39;t already on your system."}, {"owner": {"reputation": 3, "user_id": 6879260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0666ec2b4824388ad01f93ff18fe8126?s=128&d=identicon&r=PG", "display_name": "Anomnimel", "link": "https://stackoverflow.com/users/6879260/anomnimel"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1504121710, "post_id": 45968342, "comment_id": 78895977, "body": "So that&#39;s normal behaviour, right? Then can I find exact list of dependencies somewhere in some doc? Or I dig into it too deep? Just wonder how it works"}, {"owner": {"reputation": 3, "user_id": 6879260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0666ec2b4824388ad01f93ff18fe8126?s=128&d=identicon&r=PG", "display_name": "Anomnimel", "link": "https://stackoverflow.com/users/6879260/anomnimel"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1504121909, "post_id": 45968342, "comment_id": 78896072, "body": "And how exactly all that other stuff except jekyll are called? Gems as well or dependencies? Or both termins are correct?"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1504121914, "post_id": 45968342, "comment_id": 78896074, "body": "If those are the dependencies of Jekyll, yes, this is the expected behavior. If you wanted to make sure though, you could find the Jekyll website/Github page. It will usually list all the dependencies. Note though, you may have to dig pretty deep if you want to look into all of the libraries listed in the image. Some of those may be dependencies of dependencies. Let&#39;s say Jekyll requires library B. B will be installed when you install Jekyll. But say B requires library C. C will also be installed when you install Jekyll. There&#39;s a reason we use programs to manage dependencies nowadays."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1504121957, "post_id": 45968342, "comment_id": 78896092, "body": "And I actually don&#39;t know Ruby. I&#39;m under the assumption that &quot;Gem&quot; is just the word Ruby uses for &quot;library&quot;."}, {"owner": {"reputation": 3, "user_id": 6879260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0666ec2b4824388ad01f93ff18fe8126?s=128&d=identicon&r=PG", "display_name": "Anomnimel", "link": "https://stackoverflow.com/users/6879260/anomnimel"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1504122162, "post_id": 45968342, "comment_id": 78896176, "body": "Thanks for detailed response. I wish I could rate your answers, but I haven&#39;t this feature yet."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1504122339, "post_id": 45968342, "comment_id": 78896253, "body": "Well, I haven&#39;t posted an answer, these are just comments. I&#39;m not sure enough in my response to post an answer as, like I said, I don&#39;t know Ruby, and have never used Jekyll. In every language I&#39;ve ever used though, the behavior I described above has been pretty consistent. If Jekyll is the first library you&#39;ve ever installed, you&#39;ll probably notice that when you install more libraries later, it will install less since a lot of the libraries are probably already installed. I&#39;ve gone to install libraries before and found that I already have them because some other library already needed it."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1504123900, "post_id": 45968342, "comment_id": 78897029, "body": "@Carcigenicate: RubyGems is Ruby&#39;s package management system. I&#39;m not sure what ecosystems you are familiar with; a gem is equivalent to an egg in Python, a Maven package in Java, a crate in Rust, an npm package in Node.js, and a NuGet package in .NET."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1504124960, "post_id": 45968342, "comment_id": 78897621, "body": "@J&#246;rgWMittag Ahh, thanks. I&#39;m kind of familiar with Maven since that&#39;s what Clojure&#39;s Leiningen uses internally afaik."}], "answers": [{"tags": [], "owner": {"reputation": 1777, "user_id": 3353157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6168a2c2f5e3582addf6d9d70ce13749?s=128&d=identicon&r=PG", "display_name": "Peter Camilleri", "link": "https://stackoverflow.com/users/3353157/peter-camilleri"}, "is_accepted": true, "score": 0, "last_activity_date": 1504125008, "creation_date": 1504125008, "answer_id": 45969212, "question_id": 45968342, "link": "https://stackoverflow.com/questions/45968342/why-additional-gems-has-been-installed-when-i-wanted-just-one-called-jekyll/45969212#45969212", "title": "Why additional gems has been installed when I wanted just one called &quot;jekyll&quot;?", "body": "<p>If you go to the ruby gems web page for jkyll at \n<a href=\"https://rubygems.org/gems/jekyll\" rel=\"nofollow noreferrer\">https://rubygems.org/gems/jekyll</a> \nyou will see that it has run-time dependencies listed for 10 other gems.</p>\n\n<p>When you attempt to install jekyll, those other gems will be installed if they are not already installed.</p>\n\n<p>This automatic dependency management is seen as a major plus for Ruby's gem system.</p>\n"}], "owner": {"reputation": 3, "user_id": 6879260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0666ec2b4824388ad01f93ff18fe8126?s=128&d=identicon&r=PG", "display_name": "Anomnimel", "link": "https://stackoverflow.com/users/6879260/anomnimel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 45969212, "answer_count": 1, "score": 0, "last_activity_date": 1504125008, "creation_date": 1504121288, "question_id": 45968342, "link": "https://stackoverflow.com/questions/45968342/why-additional-gems-has-been-installed-when-i-wanted-just-one-called-jekyll", "title": "Why additional gems has been installed when I wanted just one called &quot;jekyll&quot;?", "body": "<p>I'm passing through some course at codecademy and I wonder why this command additional installed other gems (or what is it?). Win10 OS.\n<a href=\"https://i.stack.imgur.com/X690c.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "macos", "rbenv"], "answers": [{"comments": [{"owner": {"reputation": 5485, "user_id": 1201159, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/e677a583236141e5096e7d3f2d5feb01?s=128&d=identicon&r=PG", "display_name": "cilphex", "link": "https://stackoverflow.com/users/1201159/cilphex"}, "edited": false, "score": 0, "creation_date": 1504119504, "post_id": 45967764, "comment_id": 78894838, "body": "This grep returns no results for the old user anywhere in the <code>.rbenv</code> directory: <code>11:53 AM .rbenv: grep -rin OLD_USER *</code>"}, {"owner": {"reputation": 3334, "user_id": 4473327, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hP14q.jpg?s=128&g=1", "display_name": "neuhaus", "link": "https://stackoverflow.com/users/4473327/neuhaus"}, "reply_to_user": {"reputation": 5485, "user_id": 1201159, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/e677a583236141e5096e7d3f2d5feb01?s=128&d=identicon&r=PG", "display_name": "cilphex", "link": "https://stackoverflow.com/users/1201159/cilphex"}, "edited": false, "score": 0, "creation_date": 1504119691, "post_id": 45967764, "comment_id": 78894928, "body": "according to your description the new user should have the same directory location as the old user anyway, right?"}, {"owner": {"reputation": 5485, "user_id": 1201159, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/e677a583236141e5096e7d3f2d5feb01?s=128&d=identicon&r=PG", "display_name": "cilphex", "link": "https://stackoverflow.com/users/1201159/cilphex"}, "edited": false, "score": 0, "creation_date": 1504120450, "post_id": 45967764, "comment_id": 78895313, "body": "The directory was renamed from OLD_USER to NEW_USER"}], "tags": [], "owner": {"reputation": 3334, "user_id": 4473327, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hP14q.jpg?s=128&g=1", "display_name": "neuhaus", "link": "https://stackoverflow.com/users/4473327/neuhaus"}, "is_accepted": false, "score": 0, "last_activity_date": 1504118914, "creation_date": 1504118914, "answer_id": 45967764, "question_id": 45967723, "link": "https://stackoverflow.com/questions/45967723/renamed-home-directory-rails-wont-start/45967764#45967764", "title": "Renamed Home directory - Rails won&#39;t start", "body": "<p>do a <a href=\"https://stackoverflow.com/questions/6758963/find-and-replace-with-sed-in-directory-and-sub-directories\">search/replace on all files</a> in the .rbenv directory.</p>\n\n<p>Search for the old path, replace it with the new path.</p>\n"}], "owner": {"reputation": 5485, "user_id": 1201159, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/e677a583236141e5096e7d3f2d5feb01?s=128&d=identicon&r=PG", "display_name": "cilphex", "link": "https://stackoverflow.com/users/1201159/cilphex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504120280, "creation_date": 1504118734, "last_edit_date": 1504120280, "question_id": 45967723, "link": "https://stackoverflow.com/questions/45967723/renamed-home-directory-rails-wont-start", "title": "Renamed Home directory - Rails won&#39;t start", "body": "<p>My home directory had a bad name on my Mac, so I renamed it. I did this by creating a temp user, signing in as that user, deleting my original user (but preserving the home directory), creating a new real user, and having that new user take the home directory of the old one.</p>\n\n<p>Now, when I try to start Rails, I get this error (See <code>OLD_USER</code> and <code>NEW_USER</code>):</p>\n\n<pre><code>11:41:19 web.1     | started with pid 17653\n11:41:19 sidekiq.1 | started with pid 17654\n11:41:20 web.1     | bundler: failed to load command: bin/rails (bin/rails)\n11:41:20 web.1     | LoadError: cannot load such file -- /Users/OLD_USER/Code/my_project/config/boot\n11:41:20 web.1     |   /Users/NEW_USER/.rbenv/versions/2.3.4/lib/ruby/gems/2.3.0/gems/bootsnap-0.2.14/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:17:in `require'\n</code></pre>\n\n<p>What can I do?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "associations", "erb"], "comments": [{"owner": {"reputation": 2771, "user_id": 1887370, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/08bf95201cabfe02acc28041cff862ff?s=128&d=identicon&r=PG", "display_name": "sakurashinken", "link": "https://stackoverflow.com/users/1887370/sakurashinken"}, "edited": false, "score": 0, "creation_date": 1504117651, "post_id": 45967350, "comment_id": 78893817, "body": "what is the value of shipment.logs.last?"}, {"owner": {"reputation": 1342, "user_id": 1143549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45da1bf4376d6f184e41de57e03789b9?s=128&d=identicon&r=PG", "display_name": "Derek Wright", "link": "https://stackoverflow.com/users/1143549/derek-wright"}, "edited": false, "score": 0, "creation_date": 1504117788, "post_id": 45967350, "comment_id": 78893883, "body": "Going to assume we are in Rails here due to the tag. Do you have an association setup between shipment and users? Also, have you hopped into <code>rails console</code> and validated <code>shipment.logs.last.user_id</code> returns as expected? If you had associations created properly I&#39;d assume you could do something like <code>shipment.logs.last.user.name</code> instead."}, {"owner": {"reputation": 3, "user_id": 4115555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yegknApIA_s/AAAAAAAAAAI/AAAAAAAAAGk/XvxpXequTy0/photo.jpg?sz=128", "display_name": "BBORNCR", "link": "https://stackoverflow.com/users/4115555/bborncr"}, "edited": false, "score": 0, "creation_date": 1504119402, "post_id": 45967350, "comment_id": 78894782, "body": "I updated the question. The associations work when I use <code>byebug</code>. I don&#39;t understand why there is an error when the code runs naturally."}, {"owner": {"reputation": 6200, "user_id": 637094, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fd50f61387b63900335c8556f86237be?s=128&d=identicon&r=PG", "display_name": "Leonel Gal&#225;n", "link": "https://stackoverflow.com/users/637094/leonel-gal%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1504119678, "post_id": 45967350, "comment_id": 78894922, "body": "Any chance you are running this code in two different environments? Once where shipment.logs.last exist and one where it doesn&#39;t. If you have associations sets, you don&#39;t need the <code>User.find(user_id)</code> bit (also remember to use underscore to separate words: <code>user_id</code>, to follow Ruby&#39;s best practices), simply doing <code>shipment.logs.last.user.name</code> will work."}, {"owner": {"reputation": 1342, "user_id": 1143549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45da1bf4376d6f184e41de57e03789b9?s=128&d=identicon&r=PG", "display_name": "Derek Wright", "link": "https://stackoverflow.com/users/1143549/derek-wright"}, "edited": false, "score": 0, "creation_date": 1504120085, "post_id": 45967350, "comment_id": 78895125, "body": "You might have <code>shipments</code> where there are no related log records. Hop into rails console and try something like <code>Shipment.all.select { |s| s.logs.empty? }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4115555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yegknApIA_s/AAAAAAAAAAI/AAAAAAAAAGk/XvxpXequTy0/photo.jpg?sz=128", "display_name": "BBORNCR", "link": "https://stackoverflow.com/users/4115555/bborncr"}, "edited": false, "score": 0, "creation_date": 1504120335, "post_id": 45967927, "comment_id": 78895257, "body": "That was the problem! When I stepped through the byebug frame by frame there were eventually shipments that didn&#39;t have logs. I will validate that logs exist."}], "tags": [], "owner": {"reputation": 10255, "user_id": 1155142, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c680db41999d478ca34d1a77a470e30d?s=128&d=identicon&r=PG", "display_name": "gabrielhilal", "link": "https://stackoverflow.com/users/1155142/gabrielhilal"}, "is_accepted": true, "score": 1, "last_activity_date": 1504119547, "creation_date": 1504119547, "answer_id": 45967927, "question_id": 45967350, "link": "https://stackoverflow.com/questions/45967350/why-does-this-function-give-an-undefined-method-error-but-runs-using-byebug/45967927#45967927", "title": "Why does this function give an undefined method error but runs using byebug?", "body": "<p>The <code>shipment.logs.last</code> must be <code>nil</code>! Perhaps you are calling the method many times and your <code>byebug</code> is stopping in a context that <code>shipment.logs.last</code> is not <code>nil</code>...</p>\n\n<p>Try to debug giving a condition to call <code>byebug</code>:</p>\n\n<pre><code>def show_username(shipment)\n  byebug unless shipment.logs.last\n  userid = shipment.logs.last.user_id\n  User.find(userid).name\nend\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4115555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yegknApIA_s/AAAAAAAAAAI/AAAAAAAAAGk/XvxpXequTy0/photo.jpg?sz=128", "display_name": "BBORNCR", "link": "https://stackoverflow.com/users/4115555/bborncr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 45967927, "answer_count": 1, "score": 0, "last_activity_date": 1504119547, "creation_date": 1504117421, "last_edit_date": 1504119196, "question_id": 45967350, "link": "https://stackoverflow.com/questions/45967350/why-does-this-function-give-an-undefined-method-error-but-runs-using-byebug", "title": "Why does this function give an undefined method error but runs using byebug?", "body": "<p>This code gives me the following error:</p>\n\n<blockquote>\n  <p>undefined method `user_id' for nil:NilClass</p>\n</blockquote>\n\n<pre><code>  def show_username(shipment)\n    userid = shipment.logs.last.user_id\n    User.find(userid).name\n  end\n</code></pre>\n\n<p>However, if I insert a <code>byebug</code> I can run the code and access all the variables and methods without any errors.</p>\n\n<p>Using <code>byebug</code> I get the following responses:</p>\n\n<pre><code>(byebug) shipment.logs.last\nLog Load (0.3ms)  SELECT  \"logs\".* FROM \"logs\" WHERE \"logs\".\"shipment_id\" = $1 ORDER BY \"logs\".\"id\" DESC LIMIT $2  [[\"shipment_id\", 95], [\"LIMIT\", 1]]\n    #&lt;Log id: 87, activity: \"Shipment updated\", created_at: \"2017-08-28 15:19:07\", updated_at: \"2017-08-28 15:19:07\", shipment_id: 95, user_id: 3&gt;\n\n(byebug) shipment.logs.last.user_id\n  Log Load (2.6ms)  SELECT  \"logs\".* FROM \"logs\" WHERE \"logs\".\"shipment_id\" = $1 ORDER BY \"logs\".\"id\" DESC LIMIT $2  [[\"shipment_id\", 95], [\"LIMIT\", 1]]\n3\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "select", "multidimensional-array", "indexing"], "comments": [{"owner": {"reputation": 2771, "user_id": 1887370, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/08bf95201cabfe02acc28041cff862ff?s=128&d=identicon&r=PG", "display_name": "sakurashinken", "link": "https://stackoverflow.com/users/1887370/sakurashinken"}, "edited": false, "score": 1, "creation_date": 1504117433, "post_id": 45966953, "comment_id": 78893697, "body": "<a href=\"https://stackoverflow.com/questions/13659696/find-indices-of-elements-that-match-a-given-condition\" title=\"find indices of elements that match a given condition\">stackoverflow.com/questions/13659696/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3394, "user_id": 948169, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/109adf7a75c28e8955c31684b772ca27?s=128&d=identicon&r=PG", "display_name": "Mohanraj", "link": "https://stackoverflow.com/users/948169/mohanraj"}, "is_accepted": false, "score": 1, "last_activity_date": 1504117148, "creation_date": 1504117148, "answer_id": 45967272, "question_id": 45966953, "link": "https://stackoverflow.com/questions/45966953/selecting-index-from-array-based-on-value/45967272#45967272", "title": "Selecting index from array based on value", "body": "<p>You could use array inject method to get your expected output with minimal #no of lines and the code is something like below,</p>\n\n<pre><code>cols = [{'type' =&gt; 'string'}, {'type' =&gt; 'not_string'}, {'type' =&gt; 'string'}]\ncols.each_with_index.inject([]) do |idxs, (v, i)|\n  idxs &lt;&lt; i if v['type'] == 'string'\n  idxs\nend\n</code></pre>\n\n<p>And the output is like below,</p>\n\n<pre><code>=&gt; [0, 2]\n</code></pre>\n\n<p>You can change the code as per your need.</p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1504156095, "post_id": 45967298, "comment_id": 78905991, "body": "Note that there are alternatives to using <a href=\"http://ruby-doc.org/core-2.4.0/Array.html#method-i-each_index\" rel=\"nofollow noreferrer\">Array#each_index</a>, such as <code>result = cols.size.times.select { ... }</code>, <code>(0...cols.size).select { ... }</code> and <code>0.upto(cols.size-1).select { ... }</code>."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 4, "last_activity_date": 1504118066, "last_edit_date": 1504118066, "creation_date": 1504117230, "answer_id": 45967298, "question_id": 45966953, "link": "https://stackoverflow.com/questions/45966953/selecting-index-from-array-based-on-value/45967298#45967298", "title": "Selecting index from array based on value", "body": "<p>If you see <code>cols.each_with_index.to_a</code>:</p>\n\n<pre><code>[[{:element=&gt;\"processed\", :type=&gt;\"string\"}, 0], [{:element=&gt;\"processed\", :type=&gt;\"number\"}, 1], ...]\n</code></pre>\n\n<p>Would give you each hash in an array as the first value, and as the second one, the index. Difficult to get the index if select will <em>return an array that contains all elements of enum for which the given block returns true</em>.</p>\n\n<p>But you also can try with <code>each_index</code>, which <em>passes the index of the element instead of the element itself</em>, so it would give you just the indexes, like <code>[0,1,2,4]</code>.</p>\n\n<p>This way you could apply your validation accessing each element in the <code>cols</code> hash by its index and checking the value for the <code>type</code> key, like:</p>\n\n<pre><code>widgets = {\n  results:  {\n    cols: [\n      { element: 'processed', type: 'string' },\n      { element: 'processed', type: 'number' },\n      { element: 'processed', type: 'string' } \n    ]\n  }\n}\n\ncols = widgets[:results][:cols]\nresult = cols.each_index.select { |index| cols[index][:type] == 'string' }\n\np result\n#\u00a0[0, 2]\n</code></pre>\n"}], "owner": {"reputation": 14816, "user_id": 1078678, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/96cc843fb3ce5536971b7f26cf14032c?s=128&d=identicon&r=PG", "display_name": "TheLettuceMaster", "link": "https://stackoverflow.com/users/1078678/thelettucemaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 45967298, "answer_count": 2, "score": 1, "last_activity_date": 1504118066, "creation_date": 1504115991, "question_id": 45966953, "link": "https://stackoverflow.com/questions/45966953/selecting-index-from-array-based-on-value", "title": "Selecting index from array based on value", "body": "<p>I have Ruby code that looks like this:</p>\n\n<pre><code>  a = widgets[\"results\"][\"cols\"].each_with_index.select do |v, i| \n    v[\"type\"] == \"string\"\n  end  \n</code></pre>\n\n<p>I only want to get the index of any values where <code>v[\"type\"]</code> is \"string\".  The outer array of \"results\" has about 10 values (the inner array of \"cols\" has two -- one of them having an index of \"type\"); I am expecting two results returned in an array like this: <code>[7, 8]</code>.  But, I am getting results like this:</p>\n\n<pre><code>[[{\"element\"=&gt;\"processed\", \"type\"=&gt;\"string\"}, 7], [{\"element\"=&gt;\"settled\", \"type\"=&gt;\"string\"}, 8]]\n</code></pre>\n\n<p>How can I do this?</p>\n"}, {"tags": ["ruby", "composition"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 5, "creation_date": 1504113816, "post_id": 45966145, "comment_id": 78891671, "body": "<a href=\"https://stackoverflow.com/questions/151505/difference-between-a-class-and-a-module\" title=\"difference between a class and a module\">stackoverflow.com/questions/151505/&hellip;</a> or <a href=\"https://lh4.googleusercontent.com/e_Eml6aYg1udItOLjQCzUKF1L2K1JcjyZTnzYwcP7A=w1530-h800-no\" rel=\"nofollow noreferrer\">lh4.googleusercontent.com/&hellip;</a> or <a href=\"http://www.vikingcodeschool.com/professional-development-with-ruby/classes-vs-modules\" rel=\"nofollow noreferrer\">vikingcodeschool.com/professional-development-with-ruby/&hellip;</a> might help but basically a <code>Class</code> is a special kind of <code>Module</code> that can be instantiated. A <code>Class</code> is a stateful representation of an &quot;Object&quot; where as a <code>Module</code> is more of a stateless collection of methods (generally implemented for reusability and shared functionality)"}, {"owner": {"reputation": 355, "user_id": 4145123, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/442717345212a9a3023420a5c12ebe35?s=128&d=identicon&r=PG&f=1", "display_name": "Todoroki", "link": "https://stackoverflow.com/users/4145123/todoroki"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1504114285, "post_id": 45966145, "comment_id": 78891930, "body": "thanks @engineersmnky, so for in composition we use functions of others, should we use <code>module_function</code>-ed <code>Module</code>s?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1504114425, "post_id": 45966145, "comment_id": 78892021, "body": "Slight addition to my original comment. Think about if <code>GUI</code> was to store the user input e.g. <code>def get_input; @user_inputs &lt;&lt; gets.chomp;end</code> if this was a <code>Module</code> the user inputs would be shared across all implementations of <code>GUI</code> or in this case all <code>Computers</code>. (probably not what you want) but as a class each <code>Computer</code>s <code>GUI</code> would store the inputs separately in its own instance of <code>GUI</code>."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1504114599, "post_id": 45966145, "comment_id": 78892126, "body": "Generally <code>Module</code> methods are &quot;included&quot;  in a <code>Class</code> to add commonality or functionality to that class. I have honestly never used a <code>module_function</code> in any code base I have ever written."}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1504115029, "post_id": 45966558, "comment_id": 78892341, "body": "The second example is distasteful in my opinion as it creates a loose binding between the <code>GUI</code> implementation and the including class. I say loose because obviously <code>puts nil</code> has limited impact which would be the case in the event <code>@prompt</code> was not set but I don&#39;t believe that a <code>Module</code> should be this dependent on the internals of the class including it. I would actually consider defining <code>get_input</code> as <code>def get_input(prompt=nil); puts prompt if prompt; gets.chomp; end</code> as this expands functionality drastically for things like <code>def name; @name = get_input(&quot;What is your name?&quot;);end</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1504123292, "post_id": 45966558, "comment_id": 78896748, "body": "Overall this is nice, but I&#39;ve got to agree with @engineersmnky in that the second example is pretty dirty. Setting an instance variable the other thing magically picks up on is not good encapsulation."}, {"owner": {"reputation": 355, "user_id": 4145123, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/442717345212a9a3023420a5c12ebe35?s=128&d=identicon&r=PG&f=1", "display_name": "Todoroki", "link": "https://stackoverflow.com/users/4145123/todoroki"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1504171807, "post_id": 45966558, "comment_id": 78914668, "body": "Thanks for the answer and the comments. I&#39;ve totally forgotten the idea of storing states in an instance... my bad. And I too agree with @engineersmnky here, but with a slightly different view: Aren&#39;t mix-ins more similar to inheritance rather than composition? That is the reason I used <code>module_function</code> in the question."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 0, "last_activity_date": 1504114801, "last_edit_date": 1504114801, "creation_date": 1504114468, "answer_id": 45966558, "question_id": 45966145, "link": "https://stackoverflow.com/questions/45966145/ruby-composition-why-use-class-not-module/45966558#45966558", "title": "Ruby composition. Why use Class, not Module?", "body": "<p>This isn't a really good example of composition because the GUI doesn't make use of internal state. If you did something like this, that would be a more clear case of composition:</p>\n\n<pre><code>class GUI\n  def initialize(prompt)\n    @prompt = prompt\n  end\n  def get_input\n    puts @prompt\n    gets.chomp\n  end\nend\n\nclass Computer\n  def initialize\n    @ui = GUI.new(\"enter text\")\n  end\n\n  def get_input\n     @ui.get_input\n  end\nend\n</code></pre>\n\n<p>With this code, each instance of computer has its own instance of GUI, with its own bound behavior (the value of the prompt text).</p>\n\n<p>This could also be done with modules, as follows:</p>\n\n<pre><code>module GUI\n  def get_input\n    puts @prompt\n    gets.chomp\n  end\nend\n\nclass Computer\n  include GUI\n  def initialize\n    @prompt = \"enter text\"\n  end\nend\n</code></pre>\n\n<p>As to why the class implementation might be considered better than the module one - well, there are pros and cons. With the module, the Computer class can be shorter and doesn't need to define the <code>get_input</code> method itself because it's included from the mixin. However, the class approach is more explicit and probably more maintainable in the long run.</p>\n\n<p>There are at least two reasons for this. First of all, GUI defines its dependencies explicitly. Initialize will raise an error if the wrong number of arguments are passed. But instance variables will be <code>nil</code> if they are unset, so if GUI gets used somewhere else, that detail could be missed. Second, defining wrapper methods like <code>def get_input; @ui.get_input; end;</code> might seem redundant but can actually be useful sometimes. It gives you a way to make <code>Computer#get_input</code> slightly different than <code>GUI#get_input</code>, if you so desired.</p>\n\n<p>Bringing back your original example here. Like I said, it's not really a good use of composition. Since the GUI class has no dependencies or internal state, it can be self-contained and doesn't need to be instantiated either:</p>\n\n<pre><code>class GUI\n  def self.get_input\n    gets.chomp\n  end\nend\n\nclass Computer\n  def get_input\n    GUI.get_input\n  end\nend\n</code></pre>\n\n<p>Note that you can change the <code>class GUI</code> to a module and it would have the same effect. You could also use <code>module_method</code> instead of <code>def self.</code> as described here: <a href=\"https://idiosyncratic-ruby.com/8-self-improvement.html\" rel=\"nofollow noreferrer\">https://idiosyncratic-ruby.com/8-self-improvement.html</a></p>\n"}], "owner": {"reputation": 355, "user_id": 4145123, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/442717345212a9a3023420a5c12ebe35?s=128&d=identicon&r=PG&f=1", "display_name": "Todoroki", "link": "https://stackoverflow.com/users/4145123/todoroki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 233, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504114801, "creation_date": 1504112918, "question_id": 45966145, "link": "https://stackoverflow.com/questions/45966145/ruby-composition-why-use-class-not-module", "title": "Ruby composition. Why use Class, not Module?", "body": "<p>A lots of examples of Ruby composition are like this:</p>\n\n<pre><code>class GUI\n  def get_input\n    gets.chomp\n  end\nend\n\nclass Computer\n  def initialize\n    @ui = GUI.new\n  end\n\n  def get_input\n     @ui.get_input\n  end\nend\n</code></pre>\n\n<p>But, I thought this could be</p>\n\n<pre><code>module GUI\n  module_function\n\n  def get_input\n    gets.chomp\n  end\nend\n\nclass Computer\n  def initialize\n    @ui = GUI\n  end\n\n  def get_input\n    @ui.get_input\n  end\nend\n</code></pre>\n\n<p>too.\nSo then why do we use Classes not Modules here?</p>\n"}, {"tags": ["ruby", "nokogiri"], "comments": [{"owner": {"reputation": 1342, "user_id": 1143549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45da1bf4376d6f184e41de57e03789b9?s=128&d=identicon&r=PG", "display_name": "Derek Wright", "link": "https://stackoverflow.com/users/1143549/derek-wright"}, "edited": false, "score": 0, "creation_date": 1504112856, "post_id": 45965900, "comment_id": 78891122, "body": "Can you manually whip up some XML to give us a visual of what you are trying to create?"}, {"owner": {"reputation": 93455, "user_id": 187141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f9e28dc83496320c87c55b3cf988ab60?s=128&d=identicon&r=PG", "display_name": "yegor256", "link": "https://stackoverflow.com/users/187141/yegor256"}, "reply_to_user": {"reputation": 1342, "user_id": 1143549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45da1bf4376d6f184e41de57e03789b9?s=128&d=identicon&r=PG", "display_name": "Derek Wright", "link": "https://stackoverflow.com/users/1143549/derek-wright"}, "edited": false, "score": 0, "creation_date": 1504112953, "post_id": 45965900, "comment_id": 78891178, "body": "@ddubs just updated the answer, see above"}], "answers": [{"tags": [], "owner": {"reputation": 1342, "user_id": 1143549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45da1bf4376d6f184e41de57e03789b9?s=128&d=identicon&r=PG", "display_name": "Derek Wright", "link": "https://stackoverflow.com/users/1143549/derek-wright"}, "is_accepted": true, "score": 5, "last_activity_date": 1504113868, "last_edit_date": 1504113868, "creation_date": 1504113514, "answer_id": 45966287, "question_id": 45965900, "link": "https://stackoverflow.com/questions/45965900/how-to-add-an-attribute-to-nokogiri-xml-builder/45966287#45966287", "title": "How to add an attribute to Nokogiri XML builder?", "body": "<p>Add the attributes to the node like this</p>\n\n<pre><code>xml = Nokogiri::XML::Builder.new do |x|\n  x.root do\n    x.book(isbn: 1235) do\n      x.text('Don Quixot')\n    end\n  end\nend.doc\n</code></pre>\n\n<p>Or, after re-rereading your question perhaps you wanted to add it to the parent further in the do block. In that case, this works:</p>\n\n<pre><code>xml = Nokogiri::XML::Builder.new do |x|\n  x.root do\n    x.book do\n      x.parent.set_attribute('isbn', 12345)\n      x.text('Don Quixot')\n    end\n  end\nend.doc\n</code></pre>\n\n<p>Generates:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;root&gt;\n  &lt;book isbn=\"1235\"&gt;Don Quixot&lt;/book&gt;\n&lt;/root&gt;\n</code></pre>\n"}], "owner": {"reputation": 93455, "user_id": 187141, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f9e28dc83496320c87c55b3cf988ab60?s=128&d=identicon&r=PG", "display_name": "yegor256", "link": "https://stackoverflow.com/users/187141/yegor256"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1084, "favorite_count": 1, "accepted_answer_id": 45966287, "answer_count": 1, "score": 2, "last_activity_date": 1524509112, "creation_date": 1504112013, "last_edit_date": 1524509112, "question_id": 45965900, "link": "https://stackoverflow.com/questions/45965900/how-to-add-an-attribute-to-nokogiri-xml-builder", "title": "How to add an attribute to Nokogiri XML builder?", "body": "<p>This is what I'm trying to do:</p>\n\n<pre><code>xml = Nokogiri::XML::Builder.new do |x|\n  x.root do\n    x.book do\n      x.attribute('isbn', 12345) # Doesn't work!\n      x.text(\"Don Quixot\")\n    end\n  end\nend.doc\n</code></pre>\n\n<p>I know that I can do <code>x.book(isbn: 12345)</code>, but this is not what I want. I want to add an attribute within the <code>do/end</code> block. Is it at all possible?</p>\n\n<p>The XML expected:</p>\n\n<pre><code>&lt;root&gt;\n  &lt;book isbn=\"12345\"&gt;Don Quixot&lt;/book&gt;\n&lt;/root&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "chartkick"], "answers": [{"tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": false, "score": 0, "last_activity_date": 1504116009, "creation_date": 1504116009, "answer_id": 45966959, "question_id": 45965739, "link": "https://stackoverflow.com/questions/45965739/rails-chartkick-turning-tooltip-off/45966959#45966959", "title": "Rails - Chartkick - Turning tooltip off", "body": "<p>As of summer 2017 custom tooltips are not supported in chartkick.js. There are two open issues about this on the GitHub repository:</p>\n\n<ul>\n<li><a href=\"https://github.com/ankane/chartkick.js/issues/86\" rel=\"nofollow noreferrer\">Add support for custom tooltips #86</a></li>\n<li><a href=\"https://github.com/ankane/chartkick.js/issues/85\" rel=\"nofollow noreferrer\">Piechart with chart.js custom tooltips #85</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 2397, "user_id": 9038475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7f74f49de917e716f4d679473e70f4?s=128&d=identicon&r=PG&f=1", "display_name": "Geshode", "link": "https://stackoverflow.com/users/9038475/geshode"}, "is_accepted": false, "score": 0, "last_activity_date": 1545099468, "creation_date": 1545099468, "answer_id": 53825523, "question_id": 45965739, "link": "https://stackoverflow.com/questions/45965739/rails-chartkick-turning-tooltip-off/53825523#53825523", "title": "Rails - Chartkick - Turning tooltip off", "body": "<p>If you don't need any other pointer-events for the chart, then you can just set <code>pointer-events: none</code> for the <code>div</code>, which contains the chart. </p>\n"}], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 544, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545099468, "creation_date": 1504111357, "question_id": 45965739, "link": "https://stackoverflow.com/questions/45965739/rails-chartkick-turning-tooltip-off", "title": "Rails - Chartkick - Turning tooltip off", "body": "<p>I have the following barchart for which I'm trying to turn the hover tooltip off:</p>\n\n<pre><code>= bar_chart [[\"\", current_admin.company.progress_to_target_this_month]], colors: [current_admin.company.progress_bar_colour]\n</code></pre>\n\n<p>From their homepage, I can make an initializer file which I've done:</p>\n\n<p>config/initializers/chartkick.rb</p>\n\n<pre><code>Chartkick.options = {\n  height: '300px',\n  colors: ['#b00', '#666'],\n  discrete: true,\n  library: {\n    pointSize: 0,\n    vAxis: {\n      points: false,\n      legend: false,\n      discrete: true\n    },\n    hAxis: {\n      points: false,\n      legend: false,\n      discrete: true,\n      textPosition: 'none'\n    },\n    tooltips: {\n      enabled: false\n    }\n  },\n  options: {\n    tooltips: {\n      enabled: false\n    }\n  },\n  tooltips: {\n    enabled: false\n  }\n}\n</code></pre>\n\n<p>The options regarding vaxis and haxis all work, however I can't get anything to do with tooltips working. I've tried every variety of inserting tooltips: { enabled: false } that I can think of with no joy.</p>\n\n<p>If anyone has any advise it would be greatly appreciated</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "datetime"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1504110681, "post_id": 45965529, "comment_id": 78889978, "body": "\u201cI want to create a select\u201d\u2014feel free to do so."}, {"owner": {"reputation": 4312, "user_id": 166034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/311eb5cf1152752fafbed2a2c85aff5d?s=128&d=identicon&r=PG", "display_name": "Kerby82", "link": "https://stackoverflow.com/users/166034/kerby82"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1504111286, "post_id": 45965529, "comment_id": 78890319, "body": "added my sample code just looking for a smart way to implement it without writing all the possible cases"}], "answers": [{"tags": [], "owner": {"reputation": 10255, "user_id": 1155142, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c680db41999d478ca34d1a77a470e30d?s=128&d=identicon&r=PG", "display_name": "gabrielhilal", "link": "https://stackoverflow.com/users/1155142/gabrielhilal"}, "is_accepted": false, "score": 0, "last_activity_date": 1504112631, "creation_date": 1504112631, "answer_id": 45966065, "question_id": 45965529, "link": "https://stackoverflow.com/questions/45965529/check-if-an-hour-range-is-contained-in-another-hour-range/45966065#45966065", "title": "Check if an hour range is contained in another hour range", "body": "<p>You could do something like:</p>\n\n<pre><code>Model.where(\n  \"(TIME :start_time, TIME :end_time) OVERLAPS (start, end)\",\n  start_time: \"12:30\",\n  end_time: \"13:30\"\n)\n</code></pre>\n\n<p>Also, check this answer: <a href=\"https://stackoverflow.com/a/22639669/1155142\">https://stackoverflow.com/a/22639669/1155142</a></p>\n"}], "owner": {"reputation": 4312, "user_id": 166034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/311eb5cf1152752fafbed2a2c85aff5d?s=128&d=identicon&r=PG", "display_name": "Kerby82", "link": "https://stackoverflow.com/users/166034/kerby82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504119495, "creation_date": 1504110578, "last_edit_date": 1592644375, "question_id": 45965529, "link": "https://stackoverflow.com/questions/45965529/check-if-an-hour-range-is-contained-in-another-hour-range", "title": "Check if an hour range is contained in another hour range", "body": "<p>I have a start time and an end time. I want to check if this hour range is contained in the hour ranges defined in my model.</p>\n<p>For example, I have a <code>start_time=&quot;12:30&quot;</code> and an <code>end_time=&quot;13:30&quot;</code>.</p>\n<p>My model includes 2 objects with this time definition:</p>\n<blockquote>\n<p>Object1 have start=&quot;12:00&quot; and end=&quot;13:00&quot;</p>\n<p>Object2 have start=&quot;13:00&quot; and end=&quot;14:00&quot;</p>\n</blockquote>\n<p>I want to create a <code>select</code> with a comparison that should match both Object1 and Object2 given the start_time and end_time defined above.</p>\n<p>This is my sample code:</p>\n<pre><code>Model.all.select(|object| (object.start&lt;=start_time and object.end&lt;=end_time)\n</code></pre>\n<p>This sample code just select the objects that include the given time range in the object time range.</p>\n<p>I want to cover all the cases is there a ruby methods that check if a time range is partially containend in another one.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "installation"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1504114746, "post_id": 45965510, "comment_id": 78892209, "body": "It looks like you&#39;re missing the development headers. Do you have a compiler installed? Base Windows is really a second-class citizen in the Ruby world, it&#39;s missing a lot of things POSIX systems take for granted. The good news is that the <a href=\"https://msdn.microsoft.com/en-us/commandline/wsl/install_guide?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Windows Subsystem for Linux</a> can give you an environment a lot more like Ubuntu which may resolve problems like this by providing a rich suite of tools."}, {"owner": {"reputation": 11, "user_id": 7141451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e1e5ca51f983a83c779e8fdbf94742?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Moir", "link": "https://stackoverflow.com/users/7141451/tom-moir"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1504171223, "post_id": 45965510, "comment_id": 78914227, "body": "Thanks for your response. I probably don&#39;t have a compiler installed as I&#39;m very new to development tbh. If this could resolve the problem, are you able to recommend a good compiler I could install?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1504195965, "post_id": 45965510, "comment_id": 78931790, "body": "I&#39;m not sure what makes Windows happy other than the Windows Subsystem for Linux if that&#39;s an option."}, {"owner": {"reputation": 11, "user_id": 7141451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e1e5ca51f983a83c779e8fdbf94742?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Moir", "link": "https://stackoverflow.com/users/7141451/tom-moir"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1504250802, "post_id": 45965510, "comment_id": 78950235, "body": "Thanks tadman, will give that a go then!  Will let you know if it works."}, {"owner": {"reputation": 11, "user_id": 7141451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e1e5ca51f983a83c779e8fdbf94742?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Moir", "link": "https://stackoverflow.com/users/7141451/tom-moir"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1504598996, "post_id": 45965510, "comment_id": 79059395, "body": "I&#39;ve managed to now fix the issue. Basically I had downloaded and installed the MSYS2 DevKit but wasn&#39;t aware that I then needed to run &quot;ridk install&quot; in the command line to make it work.  In case anyone else is having this issue, there is a good walk through on <a href=\"https://github.com/oneclick/rubyinstaller2\" rel=\"nofollow noreferrer\">github.com/oneclick/rubyinstaller2</a>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1504625794, "post_id": 45965510, "comment_id": 79077598, "body": "It&#39;s worth adding that as a self-answer here to help others in the same jam. Adding an answer marks this question as answered."}], "owner": {"reputation": 11, "user_id": 7141451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e1e5ca51f983a83c779e8fdbf94742?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Moir", "link": "https://stackoverflow.com/users/7141451/tom-moir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1090, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1504250753, "creation_date": 1504110514, "last_edit_date": 1504250753, "question_id": 45965510, "link": "https://stackoverflow.com/questions/45965510/installing-rails-on-windows-error-failed-to-build-gem-native-extension", "title": "Installing Rails on Windows. &quot;ERROR: Failed to build gem native extension.&quot;", "body": "<p>I'm facing a problem when trying to install Rails on Windows 10.</p>\n\n<p>Initially following installrails.com instructions and then a few other ideas in order to try and work around the problem, but still no joy.</p>\n\n<p>I have the RailsInstaller installed.  I've used <code>curl http://installrails.com/update_rubygems.rb | ruby</code> to update the gems.</p>\n\n<p>I then tried using <code>gem install rails --no-ri --no-rdoc</code> to install Rails and I get</p>\n\n<blockquote>\n  <p>ERROR: Failed to build gem native extension.</p>\n</blockquote>\n\n<p>Have also tried just <code>gem install rails</code> and <code>sudo gem install rails --version 2.0</code>.  Also used <code>gem update --system 2.0.3</code> as I found this sometimes fixed the issue for others, however I'm getting the same error each time.</p>\n\n<p>The full error message is:</p>\n\n<pre><code>ERROR:  Error installing rails:\n        ERROR: Failed to build gem native extension.\n\n    C:/tools/ruby24/bin/ruby.exe extconf.rb\nchecking for unistd.h... *** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n        --with-opt-dir\n        --without-opt-dir\n        --with-opt-include\n        --without-opt-include=${opt-dir}/include\n        --with-opt-lib\n        --without-opt-lib=${opt-dir}/lib\n        --with-make-prog\n        --without-make-prog\n        --srcdir=.\n        --curdir\n        --ruby=C:/tools/ruby24/bin/$(RUBY_BASE_NAME)\nC:/tools/ruby24/lib/ruby/2.4.0/mkmf.rb:457:in `try_do': The compiler failed to generate an executable file. (RuntimeError)\nYou have to install development tools first.\n        from C:/tools/ruby24/lib/ruby/2.4.0/mkmf.rb:588:in `try_cpp'\n        from C:/tools/ruby24/lib/ruby/2.4.0/mkmf.rb:1095:in `block in have_header'\n        from C:/tools/ruby24/lib/ruby/2.4.0/mkmf.rb:945:in `block in checking_for'\n        from C:/tools/ruby24/lib/ruby/2.4.0/mkmf.rb:351:in `block (2 levels) in postpone'\n        from C:/tools/ruby24/lib/ruby/2.4.0/mkmf.rb:321:in `open'\n        from C:/tools/ruby24/lib/ruby/2.4.0/mkmf.rb:351:in `block in postpone'\n        from C:/tools/ruby24/lib/ruby/2.4.0/mkmf.rb:321:in `open'\n        from C:/tools/ruby24/lib/ruby/2.4.0/mkmf.rb:347:in `postpone'\n        from C:/tools/ruby24/lib/ruby/2.4.0/mkmf.rb:944:in `checking_for'\n        from C:/tools/ruby24/lib/ruby/2.4.0/mkmf.rb:1094:in `have_header'\n        from extconf.rb:5:in `&lt;main&gt;'\n\nGem files will remain installed in C:/tools/ruby24/lib/ruby/gems/2.4.0/gems/nio4r-2.1.0 for inspection.\nResults logged to C:/tools/ruby24/lib/ruby/gems/2.4.0/gems/nio4r-2.1.0/ext/nio4r/gem_make.out\nTemporarily enhancing PATH for MSYS/MINGW...\nBuilding native extensions.  This could take a while...\n</code></pre>\n\n<p>Can anyone help?</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "web-applications"], "comments": [{"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1504110868, "post_id": 45965301, "comment_id": 78890091, "body": "You need to perform a certain logic periodically. Since your &quot;time unit&quot; is a full day, you could run a rake task every day at 12:00 which would grab all invites about an event in less than 10 days and send an email to the end-user. You might want to store this information (invitation sent by email) so you won&#39;t spam the end-user everyday."}], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 1621127, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1ad89d3aefc5f7a24937d66d422afa54?s=128&d=identicon&r=PG", "display_name": "user1621127", "link": "https://stackoverflow.com/users/1621127/user1621127"}, "edited": false, "score": 0, "creation_date": 1504114088, "post_id": 45965605, "comment_id": 78891819, "body": "Thank you for your answer, clockwork seems like a really handy way of solving this!"}], "tags": [], "owner": {"reputation": 1961, "user_id": 1308979, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/899f97295621824a5f482a286f5062ca?s=128&d=identicon&r=PG", "display_name": "jeremywoertink", "link": "https://stackoverflow.com/users/1308979/jeremywoertink"}, "is_accepted": true, "score": 2, "last_activity_date": 1504110854, "creation_date": 1504110854, "answer_id": 45965605, "question_id": 45965301, "link": "https://stackoverflow.com/questions/45965301/check-if-user-has-received-and-invite-to-an-event-that-takes-place-in-less-than/45965605#45965605", "title": "Check if user has received and invite to an event that takes place in less than 10 days. (RoR)", "body": "<p>You'll want to setup a <a href=\"https://en.wikipedia.org/wiki/Cron\" rel=\"nofollow noreferrer\">cronjob</a>. There are a few gems that make it really easy to check these sort of things like <a href=\"https://rubygems.org/gems/clockwork\" rel=\"nofollow noreferrer\">clockwork</a>.</p>\n\n<p>With this gem, you would set up a schedule to run let's say every hour like</p>\n\n<pre><code>every(1.hour, \"Check for people to send invites to\") do\n  User.invitable.each { |u| u.send_notification! }\nend\n</code></pre>\n\n<p>This is just a small example. The main point is that a cron job runs over and over for whatever length of time you specify. In this case it would run every hour looking for users that you need to invite. If you decide to use clockwork, you'll want to read up on the docs to learn more of what you can do.</p>\n"}, {"tags": [], "owner": {"reputation": 329, "user_id": 8503822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dddf22a703812ddf80f5e7ee9f9287c?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Monceaux", "link": "https://stackoverflow.com/users/8503822/scott-monceaux"}, "is_accepted": false, "score": 0, "last_activity_date": 1504139235, "last_edit_date": 1504139235, "creation_date": 1504112259, "answer_id": 45965964, "question_id": 45965301, "link": "https://stackoverflow.com/questions/45965301/check-if-user-has-received-and-invite-to-an-event-that-takes-place-in-less-than/45965964#45965964", "title": "Check if user has received and invite to an event that takes place in less than 10 days. (RoR)", "body": "<p>Of course you can always install a gem (whenever or clockwork) but if you want to know how to do it without installing anything. First create a file called \"events.rake\" and place it in a folder called 'tasks' and place that in your lib folder. Use a similar code in the file:</p>\n\n<pre><code>namespace :events do\n  task :daily_event_check =&gt; :environment do\n    (Your code here)\n  end\nend\n</code></pre>\n\n<p>Then go to your terminal and crontab -e. Enter the following code:</p>\n\n<pre><code>0 0 * * * /bin/bash -l -c 'cd /path/to/your/app &amp;&amp; RACK_ENV=(your preferred environment) bundle exec rake events:daily_event_check --silent'\n</code></pre>\n\n<p>Then save. This will run your code every night at midnight. If you prefer a different time, lookup crontab and it will have a comprehensive breakdown of the time settings. This should get you going. </p>\n"}], "owner": {"reputation": 191, "user_id": 1621127, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1ad89d3aefc5f7a24937d66d422afa54?s=128&d=identicon&r=PG", "display_name": "user1621127", "link": "https://stackoverflow.com/users/1621127/user1621127"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 45965605, "answer_count": 2, "score": 2, "last_activity_date": 1504139235, "creation_date": 1504109782, "question_id": 45965301, "link": "https://stackoverflow.com/questions/45965301/check-if-user-has-received-and-invite-to-an-event-that-takes-place-in-less-than", "title": "Check if user has received and invite to an event that takes place in less than 10 days. (RoR)", "body": "<p>im building a ruby on rails webapp were users can invite each other to different events. I want to send a notification to a user if this user has received an invite to an event that takes place in less than 10 days. I know that i easily can perform this check by</p>\n\n<pre><code>invite.date - 10.days &lt; Date.now\n</code></pre>\n\n<p>But i can't figure out when to perform this check, or where to place it (in a controller, a helper, javascript?).... Do i want to perform this check each time a user enters the site, even if each user can have a lot of invites? Or do i want to queue the notification directly after the invite is sent, even if the notification is to be sent in several days/weeks. At least to me it is not obvious where to place these things in RoR. I hope that my question makes sense...</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["ruby", "swagger", "grape-api", "openapi"], "owner": {"reputation": 789, "user_id": 455705, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3e43e847a8411a5dddbb8bbf20022cea?s=128&d=identicon&r=PG", "display_name": "pirhac", "link": "https://stackoverflow.com/users/455705/pirhac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1504108149, "creation_date": 1504108149, "question_id": 45964783, "link": "https://stackoverflow.com/questions/45964783/unable-to-use-tags-in-swagger-documentation", "title": "Unable to use tags in swagger documentation", "body": "<p>I had my API looking great in Swagger like this:</p>\n\n<pre><code>desc 'blah', tags: ['User Management']\n</code></pre>\n\n<p>All my API calls were well grouped with the 'tags'. However, I needed to change the 'desc' line to include a necessary header paramater:</p>\n\n<pre><code>desc 'blah' do\n  headers Authorization {\n    ...\n  }\n</code></pre>\n\n<p>If I pass 'tags' to 'desc' like I was before it is ignored and I get a deprecated warning. Now my APIs are no longer logically grouped like they were before - I can't find a way to continue to group my API calls in Swagger. Anyone know a workaround?\nI'm using Ruby w/ the Grape framework (no rails).</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "resque"], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 3429750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30a2c23039a71582d2087c0f916d8b42?s=128&d=identicon&r=PG", "display_name": "Shawn M. Kiewel", "link": "https://stackoverflow.com/users/3429750/shawn-m-kiewel"}, "is_accepted": false, "score": 1, "last_activity_date": 1504201653, "creation_date": 1504201653, "answer_id": 45987379, "question_id": 45964411, "link": "https://stackoverflow.com/questions/45964411/quotes-around-filename-in-backticks-not-being-recognized-in-resque-task-but-wor/45987379#45987379", "title": "quotes around filename in backticks not being recognized in resque task, but works in console", "body": "<p>Figured out the issue though. Backticks call <code>/bin/sh</code>, so my bash style commands were failing. Updating <code>/bin/sh</code> to point to <code>/bin/bash</code> fixed it right up.</p>\n"}], "owner": {"reputation": 61, "user_id": 3429750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30a2c23039a71582d2087c0f916d8b42?s=128&d=identicon&r=PG", "display_name": "Shawn M. Kiewel", "link": "https://stackoverflow.com/users/3429750/shawn-m-kiewel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504201653, "creation_date": 1504107001, "question_id": 45964411, "link": "https://stackoverflow.com/questions/45964411/quotes-around-filename-in-backticks-not-being-recognized-in-resque-task-but-wor", "title": "quotes around filename in backticks not being recognized in resque task, but works in console", "body": "<p>I have a resque task to unzip a file. This task works perfectly when there are no spaces in the absolute filename; however, it is failing when there is a space in the name. I have added quotes around the filename in the backticks (see below), but this does not seem to make a difference in the resque task. What is even stranger is that I can run the exact command in the console, and it works perfectly. </p>\n\n<p>Here is my code. In the below f.filename = 'russell/artificial-proto-aips/Batch 1/rbrl-999-er-000001_bag.61440.tar.bz2':</p>\n\n<pre><code>f = JobFile.find(id)\noutput = `tar xjf \"#{File.join( '/', 'storage', f.filename )}\" -C /working 2&gt;&amp;1`\n</code></pre>\n\n<p>Running in console:</p>\n\n<pre><code>2.3.0 :009 &gt; output = `tar xjf \"#{File.join( '/', 'storage', f.filename )}\" -C /working 2&gt;&amp;1`\n =&gt; \"\"\n</code></pre>\n\n<p>Contents of output after running the resque task:</p>\n\n<pre><code>tar (child): /storage/russell/artificial-proto-aips/Batch: Cannot open: No such file or directory\\ntar (child): Error is not recoverable: exiting now\\ntar: Child returned status 2\\ntar: Error is not recoverable: exiting now\\n\n</code></pre>\n\n<p>I must admit, I am quite baffled by this behavior, but I don't want to tell my users not to use spaces in the directory names (as much as I would like to).</p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 1, "last_activity_date": 1504109031, "creation_date": 1504109031, "answer_id": 45965062, "question_id": 45963999, "link": "https://stackoverflow.com/questions/45963999/when-is-conditional-before-action-method-executed-in-rails-application/45965062#45965062", "title": "When is conditional before_action method executed in Rails application?", "body": "<p><code>foo_enabled?</code> is a condition of if <code>foo</code> should be called at all. \nIt is then determined that <code>foo</code> should be called but <code>EmployeeController</code> skips it instead for <code>bar</code>. </p>\n\n<p>If <code>foo_enabled?</code> returned <code>false</code> then there would be no <code>foo</code> action to execute and thus nothing to \"skip\". </p>\n\n<p>Since the <code>before_action</code> is conditional based on the <code>if</code> the <code>if</code> must be evaluated first to determine if the action should fire. </p>\n\n<p>After this determination is made then the <code>skip_before_action</code> evaluates if it should be skipped. Simplified work flow explanation:</p>\n\n<pre><code>#ApplicationController\nif foo_enabled? \n  #EmployeeController\n  if skip_action == :foo &amp;&amp; !skip_action[:only].includes?(current_action)\n    foo\n  end\nend  \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32682, "user_id": 120518, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/edf1077f9152b361937f12707e3af891?s=128&d=identicon&r=PG", "display_name": "Shadwell", "link": "https://stackoverflow.com/users/120518/shadwell"}, "is_accepted": true, "score": 2, "last_activity_date": 1504109313, "creation_date": 1504109313, "answer_id": 45965145, "question_id": 45963999, "link": "https://stackoverflow.com/questions/45963999/when-is-conditional-before-action-method-executed-in-rails-application/45965145#45965145", "title": "When is conditional before_action method executed in Rails application?", "body": "<p>I think the reason is that once you start using conditions on your callbacks then the callbacks are always checked to see if they should run. </p>\n\n<p>You'd think, quite reasonably, that the <code>skip_</code> would remove that callback from the callbacks for that action altogether. Instead, I think, it adds a condition to it. The <code>only:</code> condition adds a check something like <code>unless: Proc.new { action_name == 'bar' }</code>.</p>\n\n<p>Depending on the order which the conditions get checked it is quite possible that your <code>foo_enabled?</code> condition gets checked before the <code>only:</code> condition which is why you see your method getting called. The code is iterating over the callbacks to check whether they should be run or not and the condition from <code>ApplicationController</code> is checked before the one added in <code>EmployeeController</code>.</p>\n\n<p>The relevant code is in <code>lib/active_support/callbacks.rb</code> in the <a href=\"https://github.com/rails/rails/tree/master/activesupport\" rel=\"nofollow noreferrer\"><code>activesupport</code> gem</a> and in <code>lib/abstract_controller/callbacks.rb</code> in the <a href=\"https://github.com/rails/rails/tree/master/actionpack\" rel=\"nofollow noreferrer\"><code>actionpack</code> gem</a>. It's a bit hard (for me) to follow but I think what I've described is the essence of it. </p>\n"}], "owner": {"reputation": 2366, "user_id": 1644614, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/2NKuT.jpg?s=128&g=1", "display_name": "vaibhavatul47", "link": "https://stackoverflow.com/users/1644614/vaibhavatul47"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 690, "favorite_count": 0, "accepted_answer_id": 45965145, "answer_count": 2, "score": 1, "last_activity_date": 1504109313, "creation_date": 1504105780, "question_id": 45963999, "link": "https://stackoverflow.com/questions/45963999/when-is-conditional-before-action-method-executed-in-rails-application", "title": "When is conditional before_action method executed in Rails application?", "body": "<p>In the following code, Why is <code>foo_enabled?</code> called for <code>EmployeeController.bar</code> ?</p>\n\n<pre><code>class ApplicationController &lt; ActionControlelr::Base\n    before_action :foo, if: :foo_enabled?\n    def foo\n        puts 'foo called'\n    end\n\n    def foo_enabled?\n        puts 'sleep for 100s !'\n        true\n    end\nend\n\nclass EmployeeController &lt; ApplicationController\n     skip_before_action :foo, only: [:bar]\n\n     def bar\n         puts 'inside bar'\n     end\nend\n</code></pre>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1504106716, "post_id": 45963983, "comment_id": 78887416, "body": "What constraint issues are you running into?"}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "edited": false, "score": 0, "creation_date": 1504106937, "post_id": 45963983, "comment_id": 78887571, "body": "You said are going to change <code>vendor2</code>&#39;s name to be same as <code>vendor1</code>&#39;s name, but then you&#39;re also going to remove <code>vendor2</code> right? So you don&#39;t need to change the name anymore, as it will be removed anyway. Furthermore, I assumed this is what you were referring to &quot;constraint issues&quot;: that you have uniqueness constraint for the column &quot;name&quot;."}, {"owner": {"reputation": 763, "user_id": 3746396, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/1486200055/picture?type=large", "display_name": "FutoRicky", "link": "https://stackoverflow.com/users/3746396/futoricky"}, "reply_to_user": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "edited": false, "score": 0, "creation_date": 1504107940, "post_id": 45963983, "comment_id": 78888192, "body": "@Jay-ArPolidario the name change equal to <code>vendor1</code> is the condition to trigger the &quot;merge&quot;"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1504108164, "post_id": 45963983, "comment_id": 78888350, "body": "Do you have a uniqueness constraint on the vendor name? Could you show us all validations in your Vendor model?"}, {"owner": {"reputation": 763, "user_id": 3746396, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/1486200055/picture?type=large", "display_name": "FutoRicky", "link": "https://stackoverflow.com/users/3746396/futoricky"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1504108214, "post_id": 45963983, "comment_id": 78888379, "body": "@moveson the constraint has to do with the purchased_items that belong to a purchase. The name has no part in the issue."}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1504108544, "post_id": 45963983, "comment_id": 78888563, "body": "Does the method I proposed below work? If so, great. If not, then we&#39;ll need to know more about the constraints, so we&#39;ll need to see the validations on the <code>Purchase</code> model and/or the <code>PurchasedItem</code> model."}, {"owner": {"reputation": 763, "user_id": 3746396, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/1486200055/picture?type=large", "display_name": "FutoRicky", "link": "https://stackoverflow.com/users/3746396/futoricky"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1504109966, "post_id": 45963983, "comment_id": 78889511, "body": "@moveson What I wrote was an example of what I wanted to accomplish. I updated the question to my actual situation for better clarity."}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1504110361, "post_id": 45963983, "comment_id": 78889774, "body": "@FutoRicky I recommend you to not use <code>delete_all</code> as it won&#39;t trigger callbacks. You may not have after/before destroy callbacks yet, but if you do  add one some day, this code will skip those callbacks."}], "answers": [{"comments": [{"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1504108858, "post_id": 45964603, "comment_id": 78888773, "body": "I like this in concept better than my own solution, as it isolates responsibility for this task in a single-responsibility interactor class. But I don&#39;t understand why <code>migrate_related_records!</code> isn&#39;t just a single line: <code>@vendor_to.purchases &lt;&lt; @vendor_from.purchases</code>. Why not do it the Rails way?"}, {"owner": {"reputation": 763, "user_id": 3746396, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/1486200055/picture?type=large", "display_name": "FutoRicky", "link": "https://stackoverflow.com/users/3746396/futoricky"}, "edited": false, "score": 0, "creation_date": 1504109974, "post_id": 45964603, "comment_id": 78889517, "body": "What I wrote was an example of what I wanted to accomplish. I updated the question to my actual situation for better clarity."}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1504110214, "post_id": 45964603, "comment_id": 78889677, "body": "@moveson the exact way to shift records from a parent to another may vary depending on the preferences. The way I chose is also a &quot;rails way&quot;, it&#39;s just exhaustive in my example to show OP can do some extra logic on each <code>Purchase</code> record, like validation or deletion."}, {"owner": {"reputation": 763, "user_id": 3746396, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/1486200055/picture?type=large", "display_name": "FutoRicky", "link": "https://stackoverflow.com/users/3746396/futoricky"}, "edited": false, "score": 0, "creation_date": 1504111922, "post_id": 45964603, "comment_id": 78890642, "body": "@MrYoshiji Going to test it out, will let you know the outcome. Thanks."}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1504113355, "post_id": 45964603, "comment_id": 78891393, "body": "@MrYoshiji, I disagree. The reason Rails provides relationship helpers in its models is so we don&#39;t have to worry about what id goes with what table, and instead we can think about the relationships in human terms: This vendor&#39;s purchases should move into that other vendor&#39;s purchases. I see no reason to use four lines of code to accomplish what one line of clear and understandable code can do."}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1504113559, "post_id": 45964603, "comment_id": 78891521, "body": "Also, you are missing an <code>end</code> at the end of your class."}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1504114103, "post_id": 45964603, "comment_id": 78891823, "body": "@moveson I provide examples, snippets of code to help OP find a way to build a stable and flexible solution. I am not providing an answer that OP can just copy-paste and forget about it right after. There is a <code>end</code> missing and probably other things that could be improved. About the way I changed the foreign of records, I don&#39;t really care about how OP will actually do it. I just want to show him that he can do some extra logic for each of those <code>Purchase</code> record. I don&#39;t really understand why you are arguing about 1% of the code that depends on the dev preferences..."}, {"owner": {"reputation": 763, "user_id": 3746396, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/1486200055/picture?type=large", "display_name": "FutoRicky", "link": "https://stackoverflow.com/users/3746396/futoricky"}, "edited": false, "score": 0, "creation_date": 1504116321, "post_id": 45964603, "comment_id": 78893101, "body": "I found that the whole issue was due to a <code>before_update</code> I had for <code>purchase_order</code>."}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1504116902, "post_id": 45964603, "comment_id": 78893420, "body": "@MrYoshiji Understood, but why, when someone suggests a superior way of doing the same thing, do you not just modify the code to adopt it? I&#39;ve already agreed your solution is better in concept. I&#39;m just trying to improve the overall solution and promote using a Rails helper instead of rolling your own, particularly when the Rails helper does exactly the same thing your code does."}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1504118926, "post_id": 45964603, "comment_id": 78894534, "body": "Your way of doing will not be raising an error if something fails (validation / callbacks) while transferring the <code>purchase</code> records from one vendor to another. This is an example of &quot;silent fail&quot; that takes hours to debug. Using a simple shebang version of <code>save</code> (or <code>update_attributes</code>) avoid this kind of silent fail. If there was a &quot;shebang version of <code>&lt;&lt;</code>&quot; then yes I would 100% agree that we could use it."}, {"owner": {"reputation": 763, "user_id": 3746396, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/1486200055/picture?type=large", "display_name": "FutoRicky", "link": "https://stackoverflow.com/users/3746396/futoricky"}, "edited": false, "score": 1, "creation_date": 1504119688, "post_id": 45964603, "comment_id": 78894927, "body": "Actually, it&#39;s not working because after the vendor is deleted it still destroys the has_many relationships even though they where saved with the updated vendor_id."}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "reply_to_user": {"reputation": 763, "user_id": 3746396, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/1486200055/picture?type=large", "display_name": "FutoRicky", "link": "https://stackoverflow.com/users/3746396/futoricky"}, "edited": false, "score": 0, "creation_date": 1504120113, "post_id": 45964603, "comment_id": 78895141, "body": "@FutoRicky use the <code>reload</code> method on <code>@vendor_from</code> before calling <code>destroy</code>"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1504125677, "post_id": 45964603, "comment_id": 78897959, "body": "I have deleted my answer in deference to the superior answer of @MrYoshiji. I had advocated for use of <code>@vendor_to.purchases &lt;&lt; @vendor_from.purchases</code>, but it turns out this does not allow for solid error handling, and it also doesn&#39;t run callbacks."}], "tags": [], "owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "is_accepted": true, "score": 3, "last_activity_date": 1504123834, "last_edit_date": 1504123834, "creation_date": 1504107573, "answer_id": 45964603, "question_id": 45963983, "link": "https://stackoverflow.com/questions/45963983/move-all-record-relationships-to-another-record/45964603#45964603", "title": "Move all record relationships to another record", "body": "<p>You will need a merge logic defined in your app. This could be a PORO (plain old ruby object), like <code>VendorMerger</code>, which holds all the logic in order to merge a <code>Vendor</code> record into another (this could also be inside the <code>Vendor</code> model but it would pollute your model).</p>\n\n<p>Here is an example of that PORO:</p>\n\n<pre><code># lib/vendor_merger.rb\nclass VendorMerger\n  def initialize(vendor_from, vendor_to)\n    @vendor_from = vendor_from\n    @vendor_to = vendor_to\n  end\n\n  def perform!\n    validate_before_merge!\n    ActiveRecord::Base.connection.transaction do # will rollback if an error is raised in this block\n      migrate_related_records!\n      destroy_after_merge!\n    end\n  end\n\n  private\n\n  def validate_before_merge!\n    raise ArgumentError, 'Trying to merge the same record' if @vendor_from == @vendor_to\n    raise ArgumentError, 'A vendor is not persisted' if @vendor_from.new_record? || @vendor_to.new_record?\n    # ...\n  end\n\n  def migrate_related_records!\n    # see my thought (1) below\n    @vendor_from.purchases.each do |purchase|\n      purchase.vendor = @vendor_to\n      # ...\n      purchase.save!\n    end\n  end\n\n  def destroy_after_merge!\n    @vendor_from.reload.destroy!\n  end\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>VendorMerger.new(Vendor.first, Vendor.last).perform!\n</code></pre>\n\n<p>This PORO allows you to contain all the logic related to the merge into one file. It respects the SRP (Single responsibility principle) and makes the testing very easy, as well as maintenance (ex: include a Logger, custom Error objects, etc).</p>\n\n<p><strong>Thought (1)</strong>: You can either go by manually retrieving the data to be merged (as in my example), but this means if some day you add another relation to the <code>Vendor</code> model, let's say <code>Vendor</code> <code>has_many :customers</code> but forgot to add it to the VendorMerger, then it will \"fail silently\" since VendorMerger is not aware of the new relation <code>:customers</code>. To solve this, you can dynamically grab all models having a reference to <code>Vendor</code> (where column is <code>vendor_id</code> OR the <code>class_name</code> option is equal to <code>'Vendor'</code> OR the relation is polymorphic and the <code>XX_type</code> column holds a <code>'Vendor'</code> value) and convert all those foreign from the old to the new ID.</p>\n"}], "owner": {"reputation": 763, "user_id": 3746396, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/1486200055/picture?type=large", "display_name": "FutoRicky", "link": "https://stackoverflow.com/users/3746396/futoricky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 45964603, "answer_count": 1, "score": 2, "last_activity_date": 1504123834, "creation_date": 1504105745, "last_edit_date": 1504109916, "question_id": 45963983, "link": "https://stackoverflow.com/questions/45963983/move-all-record-relationships-to-another-record", "title": "Move all record relationships to another record", "body": "<p>I am trying to \"merge\" one record into another record with all it's relationship children.</p>\n\n<p>For example:</p>\n\n<p>I have <code>vendor1</code> and <code>vendor2</code> which both have many relations that contain other has_many. For example a vendor has many purchase_orders and a purchase order has many ordered_items and an ordered_item has many received_items.</p>\n\n<p>If I change the <code>vendor2</code>'s name to be the same as <code>vendor1</code>'s name then I want to destroy <code>vendor2</code> but move all of it's has_many to <code>vendor1</code>.</p>\n\n<p>This is what I've been trying to do:</p>\n\n<pre><code>  def vendor_merge(main_vendor, merge_vendor)\n    relationships = [\n      merge_vendor.returns, merge_vendor.receiving_and_bills,\n      merge_vendor.bills, merge_vendor.purchase_orders, merge_vendor.taxes,\n      Check.where(payee_id: merge_vendor.id, payee_type: \"Vendor\"),\n      JournalEntryAccount.where(payee_id: merge_vendor.id)\n    ]\n\n    relationships.each do |relationship|\n      class_name = relationship.class.name\n      relationship.each do |r|\n        if class_name === \"Check\"\n          r.update(payee_id: main_vendor.id)\n        else\n          r.update(vendor_id: main_vendor.id)\n        end\n        r.save\n      end\n\n      relationship.delete_all\n    end\n\n    merge_vendor.destroy\n  end\n</code></pre>\n\n<p>Doing it this way gives me constraint errors because of the has_many of the has_manys and because of the has_many through: :ect...</p>\n\n<p>Any straight forward solution to this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1504105682, "post_id": 45963815, "comment_id": 78886667, "body": "What is your file name of <code>Translation</code> model?"}, {"owner": {"reputation": 341, "user_id": 4514970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8666dc70fbfdefb75a80f89ec312909f?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Pohorsk&#253;", "link": "https://stackoverflow.com/users/4514970/martin-pohorsk%c3%bd"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1504105733, "post_id": 45963815, "comment_id": 78886710, "body": "translation.rb. It was autogenerated :-/."}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "edited": false, "score": 0, "creation_date": 1504105909, "post_id": 45963815, "comment_id": 78886861, "body": "@MartinPohorsk&#253; what are the file paths of both <b>translation.rb</b> and <b>category.rb</b>? Furthermore, can you show the full error backtrace when you execute <code>Category.first.translations</code>?"}, {"owner": {"reputation": 341, "user_id": 4514970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8666dc70fbfdefb75a80f89ec312909f?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Pohorsk&#253;", "link": "https://stackoverflow.com/users/4514970/martin-pohorsk%c3%bd"}, "edited": false, "score": 0, "creation_date": 1504106145, "post_id": 45963815, "comment_id": 78887013, "body": "They are in the same directory - app/models. The only difference is that translation model does not have controller and views but I know (think) it cannot be related with this issue."}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "edited": false, "score": 0, "creation_date": 1504107419, "post_id": 45963815, "comment_id": 78887862, "body": "@MartinPohorsk&#253; where is this executed? <code>Category.first.translations</code>? Does it also fail when you run that on <b>rails console</b>? And can you show the error backtrace? Also, what Rails version is this?"}, {"owner": {"reputation": 341, "user_id": 4514970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8666dc70fbfdefb75a80f89ec312909f?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Pohorsk&#253;", "link": "https://stackoverflow.com/users/4514970/martin-pohorsk%c3%bd"}, "edited": false, "score": 0, "creation_date": 1504109346, "post_id": 45963815, "comment_id": 78889109, "body": "Yes. It also fails in rails console. I have updated my question with more informations"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1504111138, "post_id": 45963815, "comment_id": 78890246, "body": "1. Are you using a gem? 2. Can you find back the corrupted Translation records by doing <code>Translation.all</code>? (you might want to filter those if you have tons of them)"}, {"owner": {"reputation": 341, "user_id": 4514970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8666dc70fbfdefb75a80f89ec312909f?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Pohorsk&#253;", "link": "https://stackoverflow.com/users/4514970/martin-pohorsk%c3%bd"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1504111517, "post_id": 45963815, "comment_id": 78890425, "body": "@MrYoshiji 1) gem for what task? 2) I do not have any translations yet, so Translation.all is empty array."}], "answers": [{"tags": [], "owner": {"reputation": 341, "user_id": 4514970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8666dc70fbfdefb75a80f89ec312909f?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Pohorsk&#253;", "link": "https://stackoverflow.com/users/4514970/martin-pohorsk%c3%bd"}, "is_accepted": true, "score": 0, "last_activity_date": 1504114295, "creation_date": 1504114295, "answer_id": 45966506, "question_id": 45963815, "link": "https://stackoverflow.com/questions/45963815/uninitialized-constant-when-using-polymorphic-association/45966506#45966506", "title": "uninitialized constant when using polymorphic association", "body": "<p>I solved it! This was not related to the models directly. @MrYoshiji pointed me to the right direction.</p>\n\n<p>I use I18n gem and i18n-active_record so I can store translations in database.</p>\n\n<p>In initialization Rails loaded this code:</p>\n\n<pre><code>Translation = I18n::Backend::ActiveRecord::Translation\n</code></pre>\n\n<p>The Translation model was in real I18n::Backend::ActiveRecord::Translation model. And therefore changes in my Translation model took no effect, because the name was linked to another model..</p>\n\n<p>I changed app/models/translation.rb to this:</p>\n\n<pre><code>class Translation &lt; I18n::Backend::ActiveRecord::Translation\n  belongs_to :translatable, polymorphic: true\nend\n</code></pre>\n\n<p>and deleted line mentioned above from configuration.</p>\n\n<p>Anyway, thank you so much for your comments!</p>\n"}], "owner": {"reputation": 341, "user_id": 4514970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8666dc70fbfdefb75a80f89ec312909f?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Pohorsk&#253;", "link": "https://stackoverflow.com/users/4514970/martin-pohorsk%c3%bd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "accepted_answer_id": 45966506, "answer_count": 1, "score": 0, "last_activity_date": 1504114295, "creation_date": 1504105314, "last_edit_date": 1504109305, "question_id": 45963815, "link": "https://stackoverflow.com/questions/45963815/uninitialized-constant-when-using-polymorphic-association", "title": "uninitialized constant when using polymorphic association", "body": "<p>I get NameError: uninitialized constant Category::Translation when executing:</p>\n\n<pre><code>Category.first.translations\n</code></pre>\n\n<p>Rails version: <strong>5.1.3</strong></p>\n\n<p>Ruby version:  <strong>2.3.3</strong></p>\n\n<p>Models:</p>\n\n<pre><code># app/models/translation.rb\nclass Translation &lt; ApplicationRecord\n  belongs_to :translatable, polymorphic: true\nend\n\n# app/models/category.rb\nclass Category &lt; ApplicationRecord\n  has_many :translations, :as =&gt; :translatable\nend\n</code></pre>\n\n<p>Migration:</p>\n\n<pre><code>class CreateTranslations &lt; ActiveRecord::Migration[5.1]\n  def change\n    create_table :translations do |t|\n      t.string :locale\n      t.string :key\n      t.text :value\n      t.text :interpolations\n      t.boolean :is_proc, default: false\n\n      t.references :translatable, polymorphic: true, index: true\n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>schema.rb:</p>\n\n<pre><code>create_table \"translations\", force: :cascade do |t|\n  t.string \"locale\"\n  t.string \"key\"\n  t.text \"value\"\n  t.text \"interpolations\"\n  t.boolean \"is_proc\", default: false\n  t.string \"translatable_type\"\n  t.integer \"translatable_id\"\n  t.datetime \"created_at\", null: false\n  t.datetime \"updated_at\", null: false\n  t.index [\"translatable_type\", \"translatable_id\"], name: \"index_translations_on_translatable_type_and_translatable_id\"\nend\n</code></pre>\n\n<p>Full trace:</p>\n\n<pre><code>activerecord (5.1.3) lib/active_record/inheritance.rb:166:in `compute_type'\nactiverecord (5.1.3) lib/active_record/reflection.rb:401:in `compute_class'\nactiverecord (5.1.3) lib/active_record/reflection.rb:397:in `klass'\nactiverecord (5.1.3) lib/active_record/associations/association.rb:127:in `klass'\nactiverecord (5.1.3) lib/active_record/associations/collection_association.rb:33:in `reader'\nactiverecord (5.1.3) lib/active_record/associations/builder/association.rb:111:in `translations'\napp/controllers/categories_controller.rb:27:in `new'\nactionpack (5.1.3) lib/action_controller/metal/basic_implicit_render.rb:4:in `send_action'\nactionpack (5.1.3) lib/abstract_controller/base.rb:186:in `process_action'\nactionpack (5.1.3) lib/action_controller/metal/rendering.rb:30:in `process_action'\nactionpack (5.1.3) lib/abstract_controller/callbacks.rb:20:in `block in process_action'\nactivesupport (5.1.3) lib/active_support/callbacks.rb:131:in `run_callbacks'\nactionpack (5.1.3) lib/abstract_controller/callbacks.rb:19:in `process_action'\nactionpack (5.1.3) lib/action_controller/metal/rescue.rb:20:in `process_action'\nactionpack (5.1.3) lib/action_controller/metal/instrumentation.rb:32:in `block in process_action'\nactivesupport (5.1.3) lib/active_support/notifications.rb:166:in `block in instrument'\nactivesupport (5.1.3) lib/active_support/notifications/instrumenter.rb:21:in `instrument'\nactivesupport (5.1.3) lib/active_support/notifications.rb:166:in `instrument'\nactionpack (5.1.3) lib/action_controller/metal/instrumentation.rb:30:in `process_action'\nactionpack (5.1.3) lib/action_controller/metal/params_wrapper.rb:252:in `process_action'\nactiverecord (5.1.3) lib/active_record/railties/controller_runtime.rb:22:in `process_action'\nactionpack (5.1.3) lib/abstract_controller/base.rb:124:in `process'\nactionview (5.1.3) lib/action_view/rendering.rb:30:in `process'\nactionpack (5.1.3) lib/action_controller/metal.rb:189:in `dispatch'\nactionpack (5.1.3) lib/action_controller/metal.rb:253:in `dispatch'\nactionpack (5.1.3) lib/action_dispatch/routing/route_set.rb:49:in `dispatch'\nactionpack (5.1.3) lib/action_dispatch/routing/route_set.rb:31:in `serve'\nactionpack (5.1.3) lib/action_dispatch/journey/router.rb:46:in `block in serve'\nactionpack (5.1.3) lib/action_dispatch/journey/router.rb:33:in `each'\nactionpack (5.1.3) lib/action_dispatch/journey/router.rb:33:in `serve'\nactionpack (5.1.3) lib/action_dispatch/routing/route_set.rb:834:in `call'\nomniauth (1.6.1) lib/omniauth/strategy.rb:189:in `call!'\nomniauth (1.6.1) lib/omniauth/strategy.rb:167:in `call'\nomniauth (1.6.1) lib/omniauth/strategy.rb:189:in `call!'\nomniauth (1.6.1) lib/omniauth/strategy.rb:167:in `call'\nomniauth (1.6.1) lib/omniauth/builder.rb:63:in `call'\nrack (2.0.3) lib/rack/etag.rb:25:in `call'\nrack (2.0.3) lib/rack/conditional_get.rb:25:in `call'\nrack (2.0.3) lib/rack/head.rb:12:in `call'\nrack (2.0.3) lib/rack/session/abstract/id.rb:232:in `context'\nrack (2.0.3) lib/rack/session/abstract/id.rb:226:in `call'\nactionpack (5.1.3) lib/action_dispatch/middleware/cookies.rb:613:in `call'\nactiverecord (5.1.3) lib/active_record/migration.rb:556:in `call'\nactionpack (5.1.3) lib/action_dispatch/middleware/callbacks.rb:26:in `block in call'\nactivesupport (5.1.3) lib/active_support/callbacks.rb:97:in `run_callbacks'\nactionpack (5.1.3) lib/action_dispatch/middleware/callbacks.rb:24:in `call'\nactionpack (5.1.3) lib/action_dispatch/middleware/executor.rb:12:in `call'\nactionpack (5.1.3) lib/action_dispatch/middleware/debug_exceptions.rb:59:in `call'\nweb-console (3.5.1) lib/web_console/middleware.rb:135:in `call_app'\nweb-console (3.5.1) lib/web_console/middleware.rb:28:in `block in call'\nweb-console (3.5.1) lib/web_console/middleware.rb:18:in `catch'\nweb-console (3.5.1) lib/web_console/middleware.rb:18:in `call'\nactionpack (5.1.3) lib/action_dispatch/middleware/show_exceptions.rb:31:in `call'\nrailties (5.1.3) lib/rails/rack/logger.rb:36:in `call_app'\nrailties (5.1.3) lib/rails/rack/logger.rb:24:in `block in call'\nactivesupport (5.1.3) lib/active_support/tagged_logging.rb:69:in `block in tagged'\nactivesupport (5.1.3) lib/active_support/tagged_logging.rb:26:in `tagged'\nactivesupport (5.1.3) lib/active_support/tagged_logging.rb:69:in `tagged'\nrailties (5.1.3) lib/rails/rack/logger.rb:24:in `call'\nsprockets-rails (3.2.0) lib/sprockets/rails/quiet_assets.rb:13:in `call'\nactionpack (5.1.3) lib/action_dispatch/middleware/remote_ip.rb:79:in `call'\nactionpack (5.1.3) lib/action_dispatch/middleware/request_id.rb:25:in `call'\nrack (2.0.3) lib/rack/method_override.rb:22:in `call'\nrack (2.0.3) lib/rack/runtime.rb:22:in `call'\nactivesupport (5.1.3) lib/active_support/cache/strategy/local_cache_middleware.rb:27:in `call'\nactionpack (5.1.3) lib/action_dispatch/middleware/executor.rb:12:in `call'\nactionpack (5.1.3) lib/action_dispatch/middleware/static.rb:125:in `call'\nrack (2.0.3) lib/rack/sendfile.rb:111:in `call'\nrailties (5.1.3) lib/rails/engine.rb:522:in `call'\npuma (3.9.1) lib/puma/configuration.rb:224:in `call'\npuma (3.9.1) lib/puma/server.rb:602:in `handle_request'\npuma (3.9.1) lib/puma/server.rb:435:in `process_client'\npuma (3.9.1) lib/puma/server.rb:299:in `block in run'\npuma (3.9.1) lib/puma/thread_pool.rb:120:in `block in spawn_thread'\n</code></pre>\n\n<p>I read on many sites that this error is caused by misconfiguration in assocations (mostly typos). I also tried to set :classname => 'Translation' in Category class, but that didnt helped too. I was not able to identify the problem for the whole day so I am here to beg for help.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby", "sass", "gulp", "gulp-ruby-sass"], "comments": [{"owner": {"reputation": 1508, "user_id": 1623047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/424e84c6326aba4507829062cf6d6431?s=128&d=identicon&r=PG", "display_name": "&#211;scar Andreu", "link": "https://stackoverflow.com/users/1623047/%c3%93scar-andreu"}, "edited": false, "score": 2, "creation_date": 1504105418, "post_id": 45963801, "comment_id": 78886472, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/22815542/rails4-unknown-encoding-name-cp720\">rails4 unknown encoding name - CP720</a>"}], "answers": [{"tags": [], "owner": {"reputation": 858, "user_id": 8870694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3f251f0bd3900352fc6eb4dcc6a124e?s=128&d=identicon&r=PG", "display_name": "Elta3lab", "link": "https://stackoverflow.com/users/8870694/elta3lab"}, "is_accepted": false, "score": 2, "last_activity_date": 1513717619, "creation_date": 1513717619, "answer_id": 47895194, "question_id": 45963801, "link": "https://stackoverflow.com/questions/45963801/gulp-ruby-sass-proplem/47895194#47895194", "title": "gulp ruby sass proplem", "body": "<p>write the following line in the \"command promopt with ruby\"</p>\n\n<pre><code>chcp 1252\n</code></pre>\n\n<p>and it will work :)</p>\n"}], "owner": {"reputation": 1, "user_id": 6776155, "user_type": "registered", "profile_image": "https://graph.facebook.com/1973461116213533/picture?type=large", "display_name": "Ahmed Nasser", "link": "https://stackoverflow.com/users/6776155/ahmed-nasser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1513717619, "creation_date": 1504105279, "last_edit_date": 1504105333, "question_id": 45963801, "link": "https://stackoverflow.com/questions/45963801/gulp-ruby-sass-proplem", "title": "gulp ruby sass proplem", "body": "<p>While I was working on gulp this error suddenly appeared</p>\n\n<p>and all tools work ok until I do save in sass file.</p>\n\n<pre><code>[16:54:10] Starting 'sass'...\n[16:54:10] Finished 'sass' after 44 ms\n[16:54:11] C:/Ruby24-x64/lib/ruby/2.4.0/win32/registry.rb:72:in `find': unknown encoding name - CP720 (ArgumentError)\n        from C:/Ruby24-x64/lib/ruby/2.4.0/win32/registry.rb:72:in `&lt;module:Win32&gt;'\n        from C:/Ruby24-x64/lib/ruby/2.4.0/win32/registry.rb:4:in `&lt;top (required)&gt;'\n        from C:/Ruby24-x64/lib/ruby/site_ruby/2.4.0/ruby_installer/runtime/msys2_installation.rb:46:in `require'\n        from C:/Ruby24-x64/lib/ruby/site_ruby/2.4.0/ruby_installer/runtime/msys2_installation.rb:46:in `iterate_msys_paths'\n        from C:/Ruby24-x64/lib/ruby/site_ruby/2.4.0/ruby_installer/runtime/msys2_installation.rb:69:in `msys_path'\n        from C:/Ruby24-x64/lib/ruby/site_ruby/2.4.0/ruby_installer/runtime/msys2_installation.rb:82:in `mingw_bin_path'\n        from C:/Ruby24-x64/lib/ruby/site_ruby/2.4.0/ruby_installer/runtime/msys2_installation.rb:92:in `enable_dll_search_paths'\n        from C:/Ruby24-x64/lib/ruby/site_ruby/2.4.0/ruby_installer/runtime/singleton.rb:27:in `enable_dll_search_paths'\n[16:54:11] from C:/Ruby24-x64/lib/ruby/2.4.0/rubygems/defaults/operating_system.rb:3:in `&lt;top (required)&gt;'\n        from C:/Ruby24-x64/lib/ruby/2.4.0/rubygems.rb:1345:in `require'\n        from C:/Ruby24-x64/lib/ruby/2.4.0/rubygems.rb:1345:in `&lt;top (required)&gt;'\n        from &lt;internal:gem_prelude&gt;:4:in `require'\n        from &lt;internal:gem_prelude&gt;:4:in `&lt;internal:gem_prelude&gt;'\n</code></pre>\n"}, {"tags": ["ruby", "scripting", "chef-infra", "chef-recipe", "guard"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6244963, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3eb2c00270d90b23c5dbbc7bd90bedcb?s=128&d=identicon&r=PG&f=1", "display_name": "EdTed", "link": "https://stackoverflow.com/users/6244963/edted"}, "edited": false, "score": 0, "creation_date": 1504165606, "post_id": 45967093, "comment_id": 78910513, "body": "Hello, the test command works just fine, thank you very much. However when I try the second piece of code I recieve this error:                                                                    &quot;NoMethodError: undefined method `include?&#39; for #&lt;Mixlib::ShellOut:0x00000005368008&gt;&quot;  Do I need to declare the method beforehand ?"}, {"owner": {"reputation": 1012, "user_id": 1367349, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/9f6f6e1fada96028ca71282b5e323799?s=128&d=identicon&r=PG", "display_name": "9me", "link": "https://stackoverflow.com/users/1367349/9me"}, "edited": false, "score": 0, "creation_date": 1531654094, "post_id": 45967093, "comment_id": 89668454, "body": "shell_out(&quot;systemctl is-active #{service_name} --quiet&quot;).exitstatus == 0 <a href=\"https://github.com/chef/chef/blob/master/lib/chef/provider/service/systemd.rb#L164\" rel=\"nofollow noreferrer\">source</a>"}, {"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "edited": false, "score": 0, "creation_date": 1531673429, "post_id": 45967093, "comment_id": 89673151, "body": "If you are going that route, you can use the error? method to be a little more expressive. Either works."}], "tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": false, "score": 1, "last_activity_date": 1504116549, "creation_date": 1504116549, "answer_id": 45967093, "question_id": 45963520, "link": "https://stackoverflow.com/questions/45963520/different-only-if-condition-as-guard-for-chef/45967093#45967093", "title": "Different Only-If Condition as Guard for Chef", "body": "<p>To convert it literally you would need to use the <code>test</code> command, usually aliased as <code>[</code>: <code>only_if \"[ $(ps -ef | grep -v grep | grep service_name | wc -l) &gt; 0 ]\"</code>. But you could also do it somewhat more nicely in Ruby code instead:</p>\n\n<pre><code>only_if { shell_out!('ps -ef').include?('service_name') }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3420, "user_id": 1824868, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9b06898ce25659bc5600453c3f21c991?s=128&d=identicon&r=PG", "display_name": "jayhendren", "link": "https://stackoverflow.com/users/1824868/jayhendren"}, "is_accepted": false, "score": 0, "last_activity_date": 1504136498, "creation_date": 1504136498, "answer_id": 45971217, "question_id": 45963520, "link": "https://stackoverflow.com/questions/45963520/different-only-if-condition-as-guard-for-chef/45971217#45971217", "title": "Different Only-If Condition as Guard for Chef", "body": "<p>To answer the question more generally, if you have an arbitrary script you want to use for your <code>only_if</code> or <code>not_if</code> guard, you can do something along these lines:</p>\n\n<pre><code>my_guard_script = File.join Chef::Config[:file_cache_path], 'my_guard_script.sh'\n\nfile my_guard_script do\n  content &lt;&lt;- EOF\n#!/bin/sh\n\n# contents of your script here\nEOF\nend\n\nresource 'my_awesome_resource' do\n  some_parameter 'some_value'\n  only_if my_guard_script\nend\n</code></pre>\n\n<p>Warning: I haven't tested this, so there are probably bugs.</p>\n"}], "owner": {"reputation": 21, "user_id": 6244963, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3eb2c00270d90b23c5dbbc7bd90bedcb?s=128&d=identicon&r=PG&f=1", "display_name": "EdTed", "link": "https://stackoverflow.com/users/6244963/edted"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 616, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1504136498, "creation_date": 1504104494, "question_id": 45963520, "link": "https://stackoverflow.com/questions/45963520/different-only-if-condition-as-guard-for-chef", "title": "Different Only-If Condition as Guard for Chef", "body": "<p>Is there a way to use this script (or something which looks approximately the same) as a only_if guard in chef? </p>\n\n<pre><code>#!/bin/bash\napplication = application_name\nif (( $(ps -ef | grep -v grep | grep $service | wc -l) &gt; 0 ))\nthen  *do something*\nfi\n</code></pre>\n\n<p>I tried the classic way but it either returns nothing so the only_if condition passes by default or it tells me that I can't compare a string with an integer (which is obvious). </p>\n\n<pre><code>execute \"script\" do\ncommand \"my command here\"\nonly_if \"$(ps -ef | grep -v grep | grep service_name | wc -l) &gt; 0\"\n</code></pre>\n\n<p>Any ideas or suggestions are appreciated. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 8, "creation_date": 1504103248, "post_id": 45962975, "comment_id": 78884758, "body": "You have a typo: <code>symbilize_names</code> should be <code>symbolize_names</code>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1504103295, "post_id": 45962975, "comment_id": 78884801, "body": "(and <code>JSON.parse</code> should raise an <code>ArgumentError</code> therefore, but that&#39;s a different story)"}], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 2, "last_activity_date": 1504103208, "creation_date": 1504103208, "answer_id": 45963072, "question_id": 45962975, "link": "https://stackoverflow.com/questions/45962975/string-vs-symbols-rails/45963072#45963072", "title": "string vs symbols rails", "body": "<p>Symbols and strings are simply different types of objects. Same as <code>'5'</code> and <code>5</code> are different. They superficially <em>look</em> similar, but actually they are not related.</p>\n\n<blockquote>\n  <p>What is the difference between using symbol and string in the case above?</p>\n</blockquote>\n\n<p>In your case, your data structure contained string keys and didn't contain symbol keys. Simple as that.</p>\n"}, {"tags": [], "owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "is_accepted": true, "score": 5, "last_activity_date": 1504103427, "last_edit_date": 1504103427, "creation_date": 1504103258, "answer_id": 45963097, "question_id": 45962975, "link": "https://stackoverflow.com/questions/45962975/string-vs-symbols-rails/45963097#45963097", "title": "string vs symbols rails", "body": "<p>When using a Hash in Ruby, any object such a string or a symbol can be used as the key. However, <code>:email</code> and <code>\"email\"</code> are different objects so to look up an object you must use the same object that was used to store the value.</p>\n\n<p>What might be confusing you is that Rails uses a <code>HashWithIndifferentAccess</code> in some places. This is a customised hash where keys <code>:foo</code> and <code>\"foo\"</code> are considered to be the same. This allows you to use e.g. <code>params[:user]</code> and <code>params[\"user\"]</code> interchangeably, however that is not the general case.</p>\n\n<p>As <a href=\"https://stackoverflow.com/users/477037/stefan\">Stefan</a> spotted, the reason why strings were being used for the keys in the parsed JSON object was just down to a small typo in the option: <code>symbilize_names</code> where it should be <code>symbolize_names</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 4, "last_activity_date": 1504103350, "creation_date": 1504103350, "answer_id": 45963120, "question_id": 45962975, "link": "https://stackoverflow.com/questions/45962975/string-vs-symbols-rails/45963120#45963120", "title": "string vs symbols rails", "body": "<p>This really has nothing to do with symbols or strings per se. You have a hash. That hash contains a value for the key <code>'email'</code>. It doesn't contain a value for the key <code>'foobar'</code> or <code>42</code> or <code>:hello</code> or <code>[1, 2, 3]</code> or <code>:email</code>. Ergo, if you ask it for the value of one of those, you get the default value, which is <code>nil</code> by default.</p>\n\n<p>This is not about symbols or strings. You are simply asking the hash for the value of a non-existent key. There is no key <code>:email</code> in the hash, ergo you get the default value.</p>\n"}], "owner": {"reputation": 2192, "user_id": 5942579, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/o6P12.jpg?s=128&g=1", "display_name": "Emmanuel Mtali", "link": "https://stackoverflow.com/users/5942579/emmanuel-mtali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 0, "accepted_answer_id": 45963097, "answer_count": 3, "score": 1, "last_activity_date": 1504103427, "creation_date": 1504102926, "last_edit_date": 1504103131, "question_id": 45962975, "link": "https://stackoverflow.com/questions/45962975/string-vs-symbols-rails", "title": "string vs symbols rails", "body": "<p>I got stuck with an error for days in my rspec tests. Then i found that the problem was the use of symbol instead of string</p>\n\n<pre><code>user_response = JSON.parse(response.body, symbilize_names: true)\nexpect(user_response[:email]).to eql(@user.email)\n</code></pre>\n\n<p>The above code always fails since <code>user_response[:email]</code> returns <code>nil</code> for some reasons</p>\n\n<p>But when i change it to <code>user_responce['email']</code> the test passed </p>\n\n<p>Debugging with byebug to check the value of user_response</p>\n\n<pre><code>(byebyg) user_response\n{\"id\"=&gt;1, \"email\"=&gt;\"enola@bauch.ca\", \"created_at\"=&gt;\"2017-08-30T14:22:43.597Z\", \"updated_at\"=&gt;\"2017-08-30T14:22:43.597Z\"}\n</code></pre>\n\n<p>What is the difference between using symbol and string in the case above?</p>\n"}, {"tags": ["ruby", "if-statement"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 5700079, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/466651243524003/picture?type=large", "display_name": "Zeeshan Shafqat", "link": "https://stackoverflow.com/users/5700079/zeeshan-shafqat"}, "edited": false, "score": 0, "creation_date": 1504100290, "post_id": 45961876, "comment_id": 78882353, "body": "Okay.. But why is that ? I have no Idea whats going on. I am more confused now.. Sorry its not because of your answere but by the fact that you just pointed out. can you please further explain why is this happening ?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 55, "user_id": 5700079, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/466651243524003/picture?type=large", "display_name": "Zeeshan Shafqat", "link": "https://stackoverflow.com/users/5700079/zeeshan-shafqat"}, "edited": false, "score": 0, "creation_date": 1504100346, "post_id": 45961876, "comment_id": 78882401, "body": "@ZeeshanShafqat sorry, I was still writing my answer, check again."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 4, "last_activity_date": 1504100921, "last_edit_date": 1504100921, "creation_date": 1504099934, "answer_id": 45961876, "question_id": 45961708, "link": "https://stackoverflow.com/questions/45961708/ruby-program-not-performing-as-expected-if-block-executes-despite-failing-the-c/45961876#45961876", "title": "Ruby Program not performing as expected? If block executes despite failing the condition", "body": "<blockquote>\n  <p>The <code>if</code> block executes even if the conditions fails to evaluate to <code>true</code></p>\n</blockquote>\n\n<p>Let's see:</p>\n\n<pre><code>key2 = :new_year\nkey2 == :new_year || :fourth_of_july || :memorial_day\n#=&gt; true\n</code></pre>\n\n<p>and now a key that is supposed to return <code>false</code>:</p>\n\n<pre><code>key2 = :thanksgiving\nkey2 == :new_year || :fourth_of_july || :memorial_day\n#=&gt; :fourth_of_july\n</code></pre>\n\n<p>That's not your expected result, but your assumption isn't correct either: the <code>if</code> block is executed simply because the condition is always <em>truthy</em>.</p>\n\n<p>Why? Because it's equivalent to:</p>\n\n<pre><code>false || :fourth_of_july || :memorial_day\n#=&gt; :fourth_of_july\n</code></pre>\n\n<p>You want:</p>\n\n<pre><code>key2 == :new_year || key2 == :fourth_of_july || key2 == :memorial_day\n#=&gt; false\n</code></pre>\n\n<p>Or a little shorter:</p>\n\n<pre><code>[:new_year, :fourth_of_july, :memorial_day].include? key2\n#=&gt; false\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>How can I simplify the process of capitalising symbols who have two words in them [...]</p>\n</blockquote>\n\n<p>I'd <code>split</code> them by underscore, <code>capitalize</code> each word and <code>join</code> the result:</p>\n\n<pre><code>:new_year\n  .to_s              #=&gt; \"new_year\"\n  .split('_')        #=&gt; [\"new\", \"year\"]\n  .map(&amp;:capitalize) #=&gt; [\"New\", \"Year\"]\n  .join(' ')         #=&gt; \"New Year\"\n</code></pre>\n\n<p>I've separated the method calls to show the intermediate results. You can write the above in one line:</p>\n\n<pre><code>:new_year.to_s.split('_').map(&amp;:capitalize).join(' ')\n#=&gt; \"New Year\"\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 5700079, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/466651243524003/picture?type=large", "display_name": "Zeeshan Shafqat", "link": "https://stackoverflow.com/users/5700079/zeeshan-shafqat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 45961876, "answer_count": 1, "score": 0, "last_activity_date": 1504100921, "creation_date": 1504099472, "question_id": 45961708, "link": "https://stackoverflow.com/questions/45961708/ruby-program-not-performing-as-expected-if-block-executes-despite-failing-the-c", "title": "Ruby Program not performing as expected? If block executes despite failing the condition", "body": "<p>The Following program is intended to iterate over the holiday_hash, capitalise all keys and values and puts them out: </p>\n\n<pre><code>def all_supplies_in_holidays(holiday_hash)\n  holiday_hash.each do |key, value|\n  key_string = key.to_s\n  key_string.capitalize!\n  puts \"#{key_string}:\"\n  value.each do |key2, value2|\n    if key2 == :new_year || :fourth_of_july || :memorial_day \n     key_to_string = key2.to_s\n     key_string1 = key_to_string.split\n     final_array = []\n     key_string1.each do |splitted_string|\n     final_array = splitted_string.capitalize!\n    end\n    final_string = final_array.join(\" \")\n    print \"#{final_string1}:\"\n  else\n    key_string1 = key2.to_s\n    print \"#{key_string1}\"\n  end\n  value2.each do |array_value|\n    new_array_capitalized = []\n    new_array_capitalized &lt;&lt; array_value.capitalize!\n    new_array.join(\" \")\n   end\n  end\n end\nend\n</code></pre>\n\n<p>The expected output format is:</p>\n\n<pre><code>Winter:\nChristmas: Lights, Wreath\nNew Years: Party Hats\nSummer:\nFourth of July: Fireworks, BBQ\nFall:\nThanksgiving: Turkey\nSpring:\nMemorial Day: BBQ\n</code></pre>\n\n<p>The holiday_hash is as follows:</p>\n\n<pre><code>  {\n  :winter =&gt; {\n    :christmas =&gt; [\"Lights\", \"Wreath\"],\n    :new_years =&gt; [\"Party Hats\"]\n  },\n  :summer =&gt; {\n    :fourth_of_july =&gt; [\"Fireworks\", \"BBQ\"]\n  },\n  :fall =&gt; {\n    :thanksgiving =&gt; [\"Turkey\"]\n  },\n  :spring =&gt; {\n    :memorial_day =&gt; [\"BBQ\"]\n  }\n}\n</code></pre>\n\n<p>The problem is:</p>\n\n<ol>\n<li>The if block executes even if the conditions fails to evaluate to true.</li>\n</ol>\n\n<p>Suggestions needed:</p>\n\n<ol start=\"2\">\n<li>How can I simplify the process of capitalising symbols who have two words in them like :new_york to be capitalised to New York? (As the #capitalised method will return New york)</li>\n</ol>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 5628086, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ea65592ffc52e4c457c72eef3bb9eb13?s=128&d=identicon&r=PG&f=1", "display_name": "J.leo", "link": "https://stackoverflow.com/users/5628086/j-leo"}, "edited": false, "score": 0, "creation_date": 1504105450, "post_id": 45961402, "comment_id": 78886497, "body": "Thanks for responding but now generate this error:  ActionView::Template::Error (No route matches {:action=&gt;&quot;show&quot;, :controller=&gt;&quot;admin&quot;} missing required keys: [:id]):"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "reply_to_user": {"reputation": 81, "user_id": 5628086, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ea65592ffc52e4c457c72eef3bb9eb13?s=128&d=identicon&r=PG&f=1", "display_name": "J.leo", "link": "https://stackoverflow.com/users/5628086/j-leo"}, "edited": false, "score": 0, "creation_date": 1504106605, "post_id": 45961402, "comment_id": 78887343, "body": "@J.leo Apologies it should be <code>admin_index_path</code>. Updated my answer"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "reply_to_user": {"reputation": 81, "user_id": 5628086, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ea65592ffc52e4c457c72eef3bb9eb13?s=128&d=identicon&r=PG&f=1", "display_name": "J.leo", "link": "https://stackoverflow.com/users/5628086/j-leo"}, "edited": false, "score": 0, "creation_date": 1504108567, "post_id": 45961402, "comment_id": 78888576, "body": "@J.leo Glad to help :)"}], "tags": [], "owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "is_accepted": true, "score": 0, "last_activity_date": 1504106596, "last_edit_date": 1504106596, "creation_date": 1504098666, "answer_id": 45961402, "question_id": 45961140, "link": "https://stackoverflow.com/questions/45961140/create-user-in-other-controller-and-view-rails-4-with-devise/45961402#45961402", "title": "Create user in other controller and view (Rails 4 with Devise)", "body": "<blockquote>\n  <p>undefined method users_path</p>\n</blockquote>\n\n<p>By default, <code>form_for</code> when used with <strong>model instance</strong>(i.e, <code>@user</code> here) routes to its corresponding <strong>restful route</strong>(i.e, <code>users_path</code> here).</p>\n\n<p>I can see that you are trying to map it to the <code>admin#create</code>, so you need to explicitly mention the path to the url in the <code>form_for</code> like so</p>\n\n<pre><code>&lt;%= form_for @user, as: resource_name, url: admin_index_path do |f|  %&gt;\n</code></pre>\n\n<p>By that, you also need to change your <code>params</code> in the <code>admin#create</code> as the params will be inside a <code>user</code> hash, so for example <code>params[:name]</code> should be changed to <code>params[:user][:name]</code></p>\n"}], "owner": {"reputation": 81, "user_id": 5628086, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ea65592ffc52e4c457c72eef3bb9eb13?s=128&d=identicon&r=PG&f=1", "display_name": "J.leo", "link": "https://stackoverflow.com/users/5628086/j-leo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 832, "favorite_count": 1, "accepted_answer_id": 45961402, "answer_count": 1, "score": 1, "last_activity_date": 1504106596, "creation_date": 1504097964, "last_edit_date": 1504098144, "question_id": 45961140, "link": "https://stackoverflow.com/questions/45961140/create-user-in-other-controller-and-view-rails-4-with-devise", "title": "Create user in other controller and view (Rails 4 with Devise)", "body": "<p>I try to create users in my admin controller but not to run it always leaves some error.</p>\n\n<p>I use application_helper to log in to my root # home with devise but I do not know if that is what is causing me more problems when creating user</p>\n\n<p>app/helpers/application_helper.rb:</p>\n\n<pre><code>module ApplicationHelper\n\n  def resource_name\n   :user\n  end\n  def resource_name_request\n   :request\n  end\n\n def resource\n   @resource ||= User.new\n end\n\n def devise_mapping\n   @devise_mapping ||= Devise.mappings[:user]\n end\n\nend\n</code></pre>\n\n<p>app/controllers/application_controller.rb: Aplication Controller</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  # Prevent CSRF attacks by raising an exception.\n  # For APIs, you may want to use :null_session instead.\n  protect_from_forgery with: :exception\n  before_action :configure_permitted_parameters, if: :devise_controller?\n\n\n\n   def after_sign_in_path_for(resource)\n     session[:previous_url] ||\n     if current_user.role == \"admin\"\n       admin_index_path\n     end\n\n   end\n\n  protected\n\n  def configure_permitted_parameters\n    devise_parameter_sanitizer.permit(:sign_up, keys: [:name, :role])\n    devise_parameter_sanitizer.permit(:account_update, keys: [:name, :country])\n  end   \nend\n</code></pre>\n\n<p>app/models/user.rb: User Model</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\n\n  devise :database_authenticatable, :registerable,\n  :recoverable, :rememberable, :trackable, :validatable\nend\n</code></pre>\n\n<p>app/controllers/admin_controller.rb: Admin_controller</p>\n\n<pre><code>class AdminController &lt; ApplicationController\n      before_action :authenticate_user!\n\n\n  def index\n\n    @user = User.new\n  end\n\n\n  def create\n    request_hash = {\n      :name =&gt; params[:name],\n      :email =&gt; params[:email],\n      :role =&gt; params[:role],\n      :password =&gt; params[:password],\n      :password_confirmation =&gt; params[:password_confirmation]\n    }\n    @user = User.new(request_hash)\n    @user.save\n  end\nend\n</code></pre>\n\n<p>app/views/admin/index.html.erb : The view I use to create for now  (Currently the source of my problems)</p>\n\n<pre><code>          &lt;%= form_for @user, as: resource_name do |f|  %&gt;\n              &lt;%= devise_error_messages! %&gt;\n              &lt;div class=\"field\"&gt;\n                &lt;%= f.label :name %&gt;&lt;br /&gt;\n                &lt;%= f.text_field :name %&gt;\n              &lt;/div&gt;\n\n              &lt;div class=\"field\"&gt;\n                &lt;%= f.label :email %&gt;&lt;br /&gt;\n                &lt;%= f.email_field :email, autofocus: true %&gt;\n              &lt;/div&gt;\n\n              &lt;div class=\"field\"&gt;\n                &lt;%= f.label :password %&gt;\n                &lt;% if @minimum_password_length %&gt;\n                &lt;em&gt;(&lt;%= @minimum_password_length %&gt; characters minimum)&lt;/em&gt;\n                &lt;% end %&gt;&lt;br /&gt;\n                &lt;%= f.password_field :password, autocomplete: \"off\" %&gt;\n              &lt;/div&gt;\n\n              &lt;div class=\"field\"&gt;\n                &lt;%= f.label :password_confirmation %&gt;&lt;br /&gt;\n                &lt;%= f.password_field :password_confirmation, autocomplete: \"off\" %&gt;\n              &lt;/div&gt;\n\n                &lt;div class=\"field\"&gt;\n\n                  &lt;%= f.select(:role) do %&gt;\n                    &lt;% [['Admin', \"admin\"], ['User', \"user\"]].each do |c| -%&gt;\n                      &lt;%= content_tag(:option, c.first, value: c.last) %&gt;\n                    &lt;% end %&gt;\n                  &lt;% end %&gt;\n                &lt;/div&gt;\n\n                &lt;div class=\"actions\"&gt;\n                    &lt;%= f.submit \"Sign up\" %&gt;\n                &lt;/div&gt;\n              &lt;% end %&gt;\n</code></pre>\n\n<p>config/routes.rb: Routes</p>\n\n<pre><code>Rails.application.routes.draw do\n\n  resources :admin\n  resources :accesses\n  devise_for :users, controllers: {\n        registrations: 'users/registrations'\n      }\n\n  root 'welcome#index'\n</code></pre>\n\n<p>The ERROR: This is my current error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6YFWv.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6YFWv.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>If someone has a better way to do it or a link to help me - I'm recently learning Rails so any reading would be good.</p>\n"}, {"tags": ["ruby", "oop", "polymorphism", "overriding"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1504098203, "post_id": 45961112, "comment_id": 78880564, "body": "Why do you want to do that?"}, {"owner": {"reputation": 41, "user_id": 6916056, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3s-7CM6s8Ag/AAAAAAAAAAI/AAAAAAAAAFQ/ie7jjjck0nM/photo.jpg?sz=128", "display_name": "MaxQwerty", "link": "https://stackoverflow.com/users/6916056/maxqwerty"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1504098455, "post_id": 45961112, "comment_id": 78880794, "body": "Research of language scope."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1504098712, "post_id": 45961112, "comment_id": 78881019, "body": "<code>method_1 if self.class == A</code>."}], "answers": [{"comments": [{"owner": {"reputation": 775, "user_id": 523965, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fd96f6e48dba148f87cb131974f04afd?s=128&d=identicon&r=PG", "display_name": "Kukunin", "link": "https://stackoverflow.com/users/523965/kukunin"}, "edited": false, "score": 0, "creation_date": 1504099109, "post_id": 45961440, "comment_id": 78881362, "body": "Ruby is pretty flexible. Depending on what you need, you can get the most base method with something like this <code>method = b.method(:method_1)</code> and <code>method = method.super_method while method.super_method</code>"}], "tags": [], "owner": {"reputation": 775, "user_id": 523965, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fd96f6e48dba148f87cb131974f04afd?s=128&d=identicon&r=PG", "display_name": "Kukunin", "link": "https://stackoverflow.com/users/523965/kukunin"}, "is_accepted": true, "score": 1, "last_activity_date": 1504098840, "last_edit_date": 1504098840, "creation_date": 1504098775, "answer_id": 45961440, "question_id": 45961112, "link": "https://stackoverflow.com/questions/45961112/ruby-call-method-of-current-class-without-polymorphism/45961440#45961440", "title": "Ruby: call method of current class without polymorphism", "body": "<p>While it's kind of weird question, you still can implement exactly what you want with this code:</p>\n\n<pre><code>class A\n  def method_1\n    puts \"A\"\n  end\n\n  def method_2\n    A.instance_method(:method_1).bind(self).call\n  end\nend\n\nclass B &lt; A\n  def method_1\n    puts \"B\"\n  end\nend\n\nputs B.new.method_2\n# =&gt; A\n</code></pre>\n\n<p>Since you have instance of <code>B</code>, <code>method_1</code> is overwritten. But you can point directly to <code>A#method_1</code> via <code>A.instance_method</code>. </p>\n\n<p><code>instance_method</code> returns <code>UnboundMethod</code> which means it doesn't have a reference to <code>self</code>. So, you need to bind it with <code>.bind(self)</code>. </p>\n\n<p>Then you call a method with <code>.call</code>.</p>\n"}], "owner": {"reputation": 41, "user_id": 6916056, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3s-7CM6s8Ag/AAAAAAAAAAI/AAAAAAAAAFQ/ie7jjjck0nM/photo.jpg?sz=128", "display_name": "MaxQwerty", "link": "https://stackoverflow.com/users/6916056/maxqwerty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 45961440, "answer_count": 1, "score": 0, "last_activity_date": 1504099604, "creation_date": 1504097894, "last_edit_date": 1504099604, "question_id": 45961112, "link": "https://stackoverflow.com/questions/45961112/ruby-call-method-of-current-class-without-polymorphism", "title": "Ruby: call method of current class without polymorphism", "body": "<p>How can I force method_2 to call A::method_1 ?</p>\n\n<pre><code>class A\n  def method_1\n    puts \"A\"\n  end\n\n  def method_2\n    method_1 #call A::method_1 only if this is instance of A\n  end\nend\n\nclass B &lt; A\n  def method_1\n    puts \"B\"\n  end\nend\n\nB.new.method_2\n</code></pre>\n\n<p>In usual implementation method_1 is overrided. Is there a way to call overrided methods of A?</p>\n"}, {"tags": ["ruby", "metaprogramming"], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1504090504, "post_id": 45958561, "comment_id": 78874752, "body": "Buuuuut, it&#39;s the same in the first snippet. no? (the scope)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1504090614, "post_id": 45958561, "comment_id": 78874821, "body": "which is present (and called from a class method) in both snippets"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1504090664, "post_id": 45958561, "comment_id": 78874861, "body": "Ah, I see. I&#39;ll go have more coffee"}, {"owner": {"reputation": 8232, "user_id": 1002814, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/935d2564cfa8572c12763684e072063d?s=128&d=identicon&r=PG", "display_name": "Niels Kristian", "link": "https://stackoverflow.com/users/1002814/niels-kristian"}, "edited": false, "score": 0, "creation_date": 1504093503, "post_id": 45958561, "comment_id": 78876916, "body": "Thanks for the answer, I went with the <code>instance_eval</code> one instead, since I had to change a lot of code, if I needed to explicitly call all methods on the scope."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1504093934, "post_id": 45958561, "comment_id": 78877208, "body": "\u201cI needed to explicitly call all methods on the scope\u201d\u2014I doubt I get why do you need to explicitly call <i>all</i> methods on the scope."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 4, "last_activity_date": 1504090451, "creation_date": 1504090451, "answer_id": 45958561, "question_id": 45958297, "link": "https://stackoverflow.com/questions/45958297/why-is-my-define-method-content-being-evaluated-in-the-class-scope/45958561#45958561", "title": "Why is my define_method content being evaluated in the class scope?", "body": "<p>This block:</p>\n\n<pre><code>do\n  the_method\nend\n</code></pre>\n\n<p>it defined and scoped in class-scope. There is no reason to expect it\u2019ll be somehow injected into instance-scope. To fix the issue simply pass the receiver explicitly:</p>\n\n<pre><code>yield(self)\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>def self.define_my_methods *method_names\n  method_names.each do |name|\n    define_the_method(name) do |receiver|\n      receiver.the_method\n    end\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1504090968, "post_id": 45958568, "comment_id": 78875074, "body": "\u201cyou are <code>yield</code>ing in the scope of the class method\u201d\u2014nope, it\u2019s <code>yield</code>ing in the instance scope, since <code>define_method</code> uses <code>instance_eval</code> under the hood. The block is class-scoped, that is why."}, {"owner": {"reputation": 42085, "user_id": 3444240, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/OjOru.jpg?s=128&g=1", "display_name": "potashin", "link": "https://stackoverflow.com/users/3444240/potashin"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1504091340, "post_id": 45958568, "comment_id": 78875336, "body": "@mudasobwa: I am sorry, this is what I meant in the first place, I have not been answering for a while and the articulation is kinda rusty."}, {"owner": {"reputation": 8232, "user_id": 1002814, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/935d2564cfa8572c12763684e072063d?s=128&d=identicon&r=PG", "display_name": "Niels Kristian", "link": "https://stackoverflow.com/users/1002814/niels-kristian"}, "edited": false, "score": 0, "creation_date": 1504093506, "post_id": 45958568, "comment_id": 78876919, "body": "Thanks for the answer, I went with the <code>instance_eval</code> one instead, since I had to change a lot of code, if I needed to explicitly call all methods on the scope."}], "tags": [], "owner": {"reputation": 42085, "user_id": 3444240, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/OjOru.jpg?s=128&g=1", "display_name": "potashin", "link": "https://stackoverflow.com/users/3444240/potashin"}, "is_accepted": false, "score": 4, "last_activity_date": 1504091520, "last_edit_date": 1504091520, "creation_date": 1504090482, "answer_id": 45958568, "question_id": 45958297, "link": "https://stackoverflow.com/questions/45958297/why-is-my-define-method-content-being-evaluated-in-the-class-scope/45958568#45958568", "title": "Why is my define_method content being evaluated in the class scope?", "body": "<p>It happens because you are providing the block in the scope of the class method <code>self.define_my_methods</code>, where <code>self</code> is a class, not an instance. So what you can do is <code>yield</code> the scope of the <code>define_method</code> itself:</p>\n\n<pre><code>def self.define_the_method attr\n  define_method(\"method_#{attr}\") do\n    begin\n      yield self\n    rescue\n      raise $!, \"method_#{attr} was called: #$!\", $@\n    end\n  end\nend\n\ndef self.define_my_methods *method_names\n  method_names.each do |name|\n    define_the_method(name) do |scope|\n      scope.send(:the_method)\n    end\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8232, "user_id": 1002814, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/935d2564cfa8572c12763684e072063d?s=128&d=identicon&r=PG", "display_name": "Niels Kristian", "link": "https://stackoverflow.com/users/1002814/niels-kristian"}, "edited": false, "score": 0, "creation_date": 1504093428, "post_id": 45958608, "comment_id": 78876868, "body": "I like this one! However in my real world use case, I need to be able to ALSO pass a param to the methods so I just ended up using <code>instance_exec</code> instead. Thanks for the tip!"}], "tags": [], "owner": {"reputation": 27630, "user_id": 1550807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JgCw5.png?s=128&g=1", "display_name": "Danil Speransky", "link": "https://stackoverflow.com/users/1550807/danil-speransky"}, "is_accepted": true, "score": 2, "last_activity_date": 1504091008, "last_edit_date": 1504091008, "creation_date": 1504090643, "answer_id": 45958608, "question_id": 45958297, "link": "https://stackoverflow.com/questions/45958297/why-is-my-define-method-content-being-evaluated-in-the-class-scope/45958608#45958608", "title": "Why is my define_method content being evaluated in the class scope?", "body": "<p>That's because <code>proc</code> defined with <code>define_method</code> will be called by using <code>instance_eval</code>.</p>\n\n<p>In the first sample it is:</p>\n\n<pre><code>do\n  the_method\nend\n</code></pre>\n\n<p>In second:</p>\n\n<pre><code>do\n  begin\n    yield\n  rescue\n    raise $!, \"method_#{attr} was called: #$!\", $@\n  end\nend\n</code></pre>\n\n<p>But <code>yield</code> will have parent scope from the place it was defined.</p>\n\n<p>Here is my suggestion:</p>\n\n<pre><code>def self.define_the_method attr, &amp;block\n  define_method(\"method_#{attr}\") do\n    begin\n      instance_eval(&amp;block)\n    rescue\n      raise $!, \"method_#{attr} was called: #$!\", $@\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 8232, "user_id": 1002814, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/935d2564cfa8572c12763684e072063d?s=128&d=identicon&r=PG", "display_name": "Niels Kristian", "link": "https://stackoverflow.com/users/1002814/niels-kristian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 1, "accepted_answer_id": 45958608, "answer_count": 3, "score": 3, "last_activity_date": 1504091520, "creation_date": 1504089742, "last_edit_date": 1504090140, "question_id": 45958297, "link": "https://stackoverflow.com/questions/45958297/why-is-my-define-method-content-being-evaluated-in-the-class-scope", "title": "Why is my define_method content being evaluated in the class scope?", "body": "<p>I'm doing some (too) fancy meta programming, and I have a hard time understanding why the scope is different in the following two cases:</p>\n\n<p><strong>Case 1:</strong></p>\n\n<pre><code>class TesterA\n\n  def the_method\n    puts \"I'm an instance_method!\"\n  end\n\n  def self.the_method\n    puts \"I'm a class_method!\"\n  end\n\n  def self.define_my_methods *method_names\n    method_names.each do |name|\n      define_method(\"method_#{name}\") do\n        the_method\n      end\n    end\n  end\n\n  define_my_methods :a, :b, :c\nend\n\nt = TesterA.new\nt.method_a #=&gt; I'm an instance_method!\nt.method_b #=&gt; I'm an instance_method!\nt.method_c #=&gt; I'm an instance_method!\n</code></pre>\n\n<p><strong>Case 2</strong></p>\n\n<pre><code>class TesterB\n\n  def the_method\n    puts \"I'm an instance_method!\"\n  end\n\n  def self.the_method\n    puts \"I'm a class_method!\"\n  end\n\n  def self.define_the_method attr\n    define_method(\"method_#{attr}\") do\n      begin\n        yield\n      rescue\n        raise $!, \"method_#{attr} was called: #$!\", $@\n      end\n    end\n  end\n\n  def self.define_my_methods *method_names\n    method_names.each do |name|\n      define_the_method(name) do\n        the_method\n      end\n    end\n  end\n\n  define_my_methods :a, :b, :c\nend\n\nt = TesterB.new\nt.method_a #=&gt; I'm a class_method!\nt.method_b #=&gt; I'm a class_method!\nt.method_c #=&gt; I'm a class_method!\n</code></pre>\n\n<p>I the second example I introduce a kind of \"helper-mothod\" <code>define_the_method</code> which I use for defining the methods rather than <code>define_method</code> it self. Reason for that is, That I want to append the name of the dynamic method to any exception messages that might occur inside those methods. The problem however is, that the content (when using the latter case) seems to be evaluated in the class-scope. </p>\n\n<p>Why is this, and how can I make it get evaluated in the instance-scope?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "edited": false, "score": 0, "creation_date": 1504089732, "post_id": 45958231, "comment_id": 78874160, "body": "can you post little bit more code of your action ?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5710450"}, "edited": false, "score": 0, "creation_date": 1504091090, "post_id": 45958378, "comment_id": 78875161, "body": "Thanks. That&#39;s a clear explanation. I used status 303, which is redirecting me to show page. But here one more issue am facing, am calling the above action in a AJAX call from show page, after action am returning back to show page with updated data. But page not getting refreshed. Any clue how to solve this?"}, {"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 1, "creation_date": 1504091653, "post_id": 45958378, "comment_id": 78875560, "body": "If you just &quot;submit&quot; a <code>&lt;form&gt;</code> you will get normal page reloads. AJAX is designed to not reload the page ever, it just gives you the response data to deal with in JavaScript. In JavaScript you can use <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Window/location\" rel=\"nofollow noreferrer\"><code>window.location</code></a> to reload as a <code>GET</code>, or use a hidden form to get <code>POST</code> (and under Rails <code>PUT</code>, <code>DELETE</code>, etc. via its special <code>_method</code> form parameter). HTTP redirects use the <code>Location</code> header so you can retrieve that in JavaScript (but be sure to check for 4XX or 5XX error response as well!)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5710450"}, "edited": false, "score": 0, "creation_date": 1504093016, "post_id": 45958378, "comment_id": 78876612, "body": "Thank you. am already doing window.location.reload. it reloading after a fraction of seconds when user clicking delete button(because it waiting for ajax call to finish executing :(. Okay. any how thanks"}], "tags": [], "owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "is_accepted": true, "score": 0, "last_activity_date": 1504090398, "last_edit_date": 1504090398, "creation_date": 1504089968, "answer_id": 45958378, "question_id": 45958231, "link": "https://stackoverflow.com/questions/45958231/redirect-to-show-page-instead-update-in-controller-rails/45958378#45958378", "title": "redirect_to show page instead update in controller? rails", "body": "<p>A redirect with <code>redirect_to</code> (default HTTP <code>302 Found</code>) which should persist the method, allthough does not always. You can use <code>303 See Other</code> if you want to force a <code>GET</code>.</p>\n\n<p>See <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302\" rel=\"nofollow noreferrer\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302</a></p>\n\n<blockquote>\n  <p>Even if the specification requires the method, and the body, not to be altered when the redirection is performed, not all user-agents conform here, and you can still find buggy software out there. It is therefore recommended to set the 302 code only as a response for GET or HEAD methods and to use 307 Temporary Redirect instead, as the method change is explicitly prohibited in that case.</p>\n  \n  <p>In the cases where you want the method used to be changed to GET, use 303 See Also instead. This is useful when you want to give an answer to a PUT method that is not the uploaded resource, but a confirmation message (like \"You successfully uploaded XYZ\").</p>\n</blockquote>\n\n<p>For <code>redirect_to</code> the <code>status</code> option overrides the default, e.g. <code>redirect_to product_path(@product), status: :see_other</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 156, "user_id": 5413717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bfee6606a5d28858e1d9d0882492661?s=128&d=identicon&r=PG&f=1", "display_name": "debasish117", "link": "https://stackoverflow.com/users/5413717/debasish117"}, "is_accepted": false, "score": -1, "last_activity_date": 1504091013, "creation_date": 1504091013, "answer_id": 45958726, "question_id": 45958231, "link": "https://stackoverflow.com/questions/45958231/redirect-to-show-page-instead-update-in-controller-rails/45958726#45958726", "title": "redirect_to show page instead update in controller? rails", "body": "<p>You could do <code>redirect_to @products</code> if you want to redirect to show page . Which will be processed like GET /products/123456 . </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5710450"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 535, "favorite_count": 0, "accepted_answer_id": 45958378, "answer_count": 2, "score": 0, "last_activity_date": 1504091013, "creation_date": 1504089559, "last_edit_date": 1504090115, "question_id": 45958231, "link": "https://stackoverflow.com/questions/45958231/redirect-to-show-page-instead-update-in-controller-rails", "title": "redirect_to show page instead update in controller? rails", "body": "<p>am doing redirecting in my controller action something like this </p>\n\n<pre><code>format.html { redirect_to product_path(@product) }\n</code></pre>\n\n<p>which is taking me to <code>PUT /products/123456</code></p>\n\n<p>but i would like to go <code>GET /products/123456</code>.\ncan some explain me why this is happening. what is the exact helper method should i use to go with GET request?</p>\n\n<p>According to doc <code>product_path(@product)</code> is comon for all <code>GET, PUT/PATCH</code>, and <code>DELETE.</code> </p>\n\n<p>I could not find any option to pass something like</p>\n\n<pre><code>format.html { redirect_to product_path(@product) }, method: :get\n</code></pre>\n\n<p>in <code>redirect_to</code> api doc. Please explain me how can i achieve this. thanks</p>\n\n<p><strong>Update:</strong></p>\n\n<pre><code>def delete_product_media\n  @product = Product.find(params[:id])\n  @product_media = ProductMedium.where(id: params[:product_media_ids])\n\n  respond_to do |format|\n    if @product_media.update_all(deleted_at: Time.zone.now) == params[:product_media_ids].count\n      flash[:notice] = 'Media deleted'\n      flash.keep(:notice)\n      format.html { redirect_to product_path(@product), method: :get }\n    else\n      flash[:notice] = 'Something went wrong!'\n      flash.keep(:notice)\n      format.html {redirect_to product_path(@product) }\n    end\n  end\n\nend\n</code></pre>\n"}, {"tags": ["ruby", "linux", "environment-variables"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 3, "creation_date": 1504085117, "post_id": 45956654, "comment_id": 78871053, "body": "Is it an <code>export</code>? <code>export my_var123; irb</code>"}, {"owner": {"reputation": 29, "user_id": 8459940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69531eb5e3c10b6aeb63d0be8de1e346?s=128&d=identicon&r=PG&f=1", "display_name": "Jily", "link": "https://stackoverflow.com/users/8459940/jily"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1504085944, "post_id": 45956654, "comment_id": 78871636, "body": "@Ryan if it wasn&#39;t, how would it be visible via <code>echo $my_var123</code>?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1504086258, "post_id": 45956654, "comment_id": 78871867, "body": "@Jily it&#39;s a shell variable, but not an environment variable."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1504099614, "post_id": 45956654, "comment_id": 78881797, "body": "Are you 1000% sure that it&#39;s an environment variable and not some other kind of variable, like a shell variable, or a local variable (if your shell supports such a thing)? What test did you use to determine that it is an environment variable and not some other kind of variable? What shell are you using? What kinds of variables does your shell have?"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 8459940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69531eb5e3c10b6aeb63d0be8de1e346?s=128&d=identicon&r=PG&f=1", "display_name": "Jily", "link": "https://stackoverflow.com/users/8459940/jily"}, "edited": false, "score": 0, "creation_date": 1504086109, "post_id": 45956930, "comment_id": 78871769, "body": "but in /etc/environment all the variables are without export and they&#39;re all visible."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 29, "user_id": 8459940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69531eb5e3c10b6aeb63d0be8de1e346?s=128&d=identicon&r=PG&f=1", "display_name": "Jily", "link": "https://stackoverflow.com/users/8459940/jily"}, "edited": false, "score": 0, "creation_date": 1504086296, "post_id": 45956930, "comment_id": 78871893, "body": "So what? On login, during the activation of the PAM stack, <code>pam_env.so</code> reads <code>&#47;etc&#47;environment</code> and <i>updates the environment</i>."}, {"owner": {"reputation": 29, "user_id": 8459940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69531eb5e3c10b6aeb63d0be8de1e346?s=128&d=identicon&r=PG&f=1", "display_name": "Jily", "link": "https://stackoverflow.com/users/8459940/jily"}, "edited": false, "score": 0, "creation_date": 1504137493, "post_id": 45956930, "comment_id": 78901704, "body": "then why call &quot;export&quot; in /etc/environment?"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1504085931, "creation_date": 1504085931, "answer_id": 45956930, "question_id": 45956654, "link": "https://stackoverflow.com/questions/45956654/an-env-variable-isnt-nil-but-in-ruby-its-nil/45956930#45956930", "title": "An env. variable isn&#39;t nil, but in ruby it&#39;s nil:", "body": "<p><code>echo $my_var123</code> check has nothing to do with the current environment:</p>\n\n<pre><code>$ foo=bar\n$ echo $foo\n#\u21d2 bar\n$ env|grep foo\n$\n</code></pre>\n\n<p>And <code>ENV</code> in ruby derives <em>the current shell environment</em>. To update the environment, one uses <code>export</code>:</p>\n\n<pre><code>$ export foo=bar\n$ echo $foo\n#\u21d2 bar\n$ env|grep foo\n#\u21d2\u00a0foo=bar\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 8459940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69531eb5e3c10b6aeb63d0be8de1e346?s=128&d=identicon&r=PG&f=1", "display_name": "Jily", "link": "https://stackoverflow.com/users/8459940/jily"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1504085931, "creation_date": 1504085064, "question_id": 45956654, "link": "https://stackoverflow.com/questions/45956654/an-env-variable-isnt-nil-but-in-ruby-its-nil", "title": "An env. variable isn&#39;t nil, but in ruby it&#39;s nil:", "body": "<p>An env. variable isn't nil, but in ruby it's nil:</p>\n\n<pre><code>my_comp% irb\nirb(main):001:0&gt; ENV[\"my_var123\"]\n=&gt; nil\n\nmy_comp% echo $my_var123\nsome_value:fdsfdsfdsfds\n</code></pre>\n\n<p>Why?</p>\n"}, {"tags": ["ruby", "logstash"], "owner": {"reputation": 31, "user_id": 8516842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/420888a97e5d227f84f0b303ab89779e?s=128&d=identicon&r=PG&f=1", "display_name": "youyou", "link": "https://stackoverflow.com/users/8516842/youyou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1504086212, "creation_date": 1504082798, "last_edit_date": 1504086212, "question_id": 45955889, "link": "https://stackoverflow.com/questions/45955889/why-is-logstash-not-running-after-sending-mail-alerting", "title": "Why is logstash not running after sending mail alerting", "body": "<p>After running <code>logstash</code> to send e-mails, one of the messages has been blocked. So the <code>logstash</code> shows me this error:</p>\n\n<blockquote>\n  <p>[2017-08-30T09:29:35,862][ERROR][logstash.shutdownwatcher ] The shutdown process appears to be stalled due to busy or blocked plugins. Check the logs for more information</p>\n</blockquote>\n\n<p>And I can't send emails anymore.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1504080350, "post_id": 45955048, "comment_id": 78868038, "body": "Can you show us the form code?"}, {"owner": {"reputation": 870, "user_id": 7168602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f46139600064653998569ca900bc2598?s=128&d=identicon&r=PG&f=1", "display_name": "Powderham", "link": "https://stackoverflow.com/users/7168602/powderham"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1504082769, "post_id": 45955048, "comment_id": 78869471, "body": "Done @Pavan , thanks for getting back to me"}], "answers": [{"comments": [{"owner": {"reputation": 870, "user_id": 7168602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f46139600064653998569ca900bc2598?s=128&d=identicon&r=PG&f=1", "display_name": "Powderham", "link": "https://stackoverflow.com/users/7168602/powderham"}, "edited": false, "score": 0, "creation_date": 1504096202, "post_id": 45956563, "comment_id": 78878992, "body": "Thanks for responding! Unfortunately that hasn&#39;t changed the error message. I have displayed my routes for you above."}, {"owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "reply_to_user": {"reputation": 870, "user_id": 7168602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f46139600064653998569ca900bc2598?s=128&d=identicon&r=PG&f=1", "display_name": "Powderham", "link": "https://stackoverflow.com/users/7168602/powderham"}, "edited": false, "score": 0, "creation_date": 1504097492, "post_id": 45956563, "comment_id": 78879943, "body": "@Powderham : run <code>rake routes</code> and update it in your question"}, {"owner": {"reputation": 870, "user_id": 7168602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f46139600064653998569ca900bc2598?s=128&d=identicon&r=PG&f=1", "display_name": "Powderham", "link": "https://stackoverflow.com/users/7168602/powderham"}, "edited": false, "score": 0, "creation_date": 1504101814, "post_id": 45956563, "comment_id": 78883621, "body": "Done @Gagan-Gami."}], "tags": [], "owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "is_accepted": false, "score": 0, "last_activity_date": 1504084812, "creation_date": 1504084812, "answer_id": 45956563, "question_id": 45955048, "link": "https://stackoverflow.com/questions/45955048/allowing-params-for-a-nested-attribute-with-custom-devise-registration/45956563#45956563", "title": "Allowing params for a nested attribute with custom devise registration", "body": "<p>Try by override Devise <code>Registrations#new</code> method, add below method in your registrations controller  :</p>\n\n<pre><code>  def new\n    # Override Devise default behaviour and create a profile as well\n    build_resource({})\n    resource.build_profile\n    respond_with self.resource\n  end\n</code></pre>\n\n<p>also make sure you have defined in route:</p>\n\n<pre><code>devise_for :users, controllers: {registrations: 'registrations'}\n</code></pre>\n"}], "owner": {"reputation": 870, "user_id": 7168602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f46139600064653998569ca900bc2598?s=128&d=identicon&r=PG&f=1", "display_name": "Powderham", "link": "https://stackoverflow.com/users/7168602/powderham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 577, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504101754, "creation_date": 1504080153, "last_edit_date": 1504101754, "question_id": 45955048, "link": "https://stackoverflow.com/questions/45955048/allowing-params-for-a-nested-attribute-with-custom-devise-registration", "title": "Allowing params for a nested attribute with custom devise registration", "body": "<p>In my rails application I have a User and a Profile where the profile belongs to the user.</p>\n\n<p>I have overridden the normal devise registration controller to avoid asking the user for a password in the sign up form. I am also creating the profile resource as a nested resource in the same form. When I submit the form, the profile resource gets created, although without any of the information from the form.</p>\n\n<p>The params from my form look like the below:</p>\n\n<pre><code>  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"2sFwrzojZOwB0U/TRScuT9x8lInXGyJX/G1WrYiJOBfFwsT79xlZHZnje1kGAgyzxZtVJ6F3PW4YzQTnDUsZwg==\", \"user\"=&gt;{\"role\"=&gt;\"junior\", \"profile\"=&gt;{\"first_name\"=&gt;\"Test\", \"last_name\"=&gt;\"asldm2\"}, \"email\"=&gt;\"aksdm@gmail.com\", \"language\"=&gt;\"javascript\"}}\n</code></pre>\n\n<p>I can see why this is: </p>\n\n<pre><code>Unpermitted parameters: profile\n</code></pre>\n\n<p>My problem is telling Devise to accept profile parameters during the registration.</p>\n\n<p>Following the help here: <a href=\"https://github.com/plataformatec/devise#strong-parameters\" rel=\"nofollow noreferrer\">https://github.com/plataformatec/devise#strong-parameters</a> I have tried to configure the parameters in my ApplicationController</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  protect_from_forgery with: :exception\n  before_action :configure_permitted_parameters, if: :devise_controller?\n\n  def configure_permitted_parameters\n    devise_parameter_sanitizer.permit(:sign_up) do |user_params|\n      user_params.permit([:id, :email, profile_attributes: [:id, :first_name, :last_name, :role]])\n    end\n  end\nend\n</code></pre>\n\n<p>My user User Model looks like the below. Please note my method to create with an automatically generated password</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\n  has_one :profile, dependent: :destroy\n  before_validation :generate_password, on: :create\n  accepts_nested_attributes_for :profile\n\n  def self.create_with_password(params)\n    @email = params[:email]\n    generated_password = Devise.friendly_token.first(8)\n    @user = self.create!(email: @email, password: generated_password)\n    UserNotifier.send_sign_up_email(@user, generated_password).deliver if @user.persisted?\n    return @user\n  end\n\n  def generate_password\n    generated_password = Devise.friendly_token.first(8)\n    self.password = self.password_confirmation = generated_password if !self.password.blank?\n  end\n\n\n  def password_required?\n    new_record? ? false : super\n  end\n\nend\n</code></pre>\n\n<p>My Profile Model looks like this:</p>\n\n<pre><code>class Profile &lt; ApplicationRecord\n  belongs_to :user\n\nend\n</code></pre>\n\n<p>Further, below is my RegistrationController which I am using to call the create method in my user model </p>\n\n<pre><code>class RegistrationsController &lt; Devise::RegistrationsController\n  def create\n      logger.debug \"Registrations create\"\n      @user = User.create_with_password(user_params)\n      logger.debug \"Registrations user created with password\"\n      @user.build_profile\n      @user.update(user_params)\n      logger.debug \"User: #{@user.inspect}\"\n      sign_in(@user)\n      redirect_to user_url\n  end\n\n  private\n  def user_params\n    params.require(:user).permit([:id, :email, profile_attributes: [:id, :first_name, :last_name, :role, :language]])\n  end\nend\n</code></pre>\n\n<p>My sign up form looks like this:</p>\n\n<pre><code>&lt;%= form_for :user, url: {controller: :registrations, action: :create} do |f| %&gt;\n    &lt;ul class=\"flex-outer\"&gt;\n      &lt;li&gt;\n         &lt;label&gt;I am a&lt;/label&gt;\n      &lt;/li&gt;\n    &lt;%= f.fields_for :profile do |pf| %&gt;\n      &lt;ul class=\"flex-inner role\"&gt;\n        &lt;li class=\"role-radio\"&gt;\n          &lt;%= pf.radio_button :role, 'junior' %&gt;\n          &lt;label for=\"user_role_junior\"&gt;\n            &lt;div class=\"role-div\"&gt;\n              &lt;div class=\"role-circle\"&gt;\n                &lt;img src=\"svg/student.svg\" alt=\"student icon\"&gt;\n              &lt;/div&gt;\n              &lt;div&gt;Junior&lt;/div&gt;\n            &lt;/div&gt;\n          &lt;/label&gt;\n        &lt;/li&gt;\n        &lt;li class=\"role-radio\"&gt;\n\n          &lt;%= pf.radio_button :role, 'employer' %&gt;\n          &lt;label for=\"user_role_employer\"&gt;\n            &lt;div class=\"role-div\"&gt;\n              &lt;div class=\"role-circle\"&gt;\n                &lt;img src=\"svg/employer.svg\" alt=\"employer icon\"&gt;\n              &lt;/div&gt;\n              &lt;div&gt;Employer&lt;/div&gt;\n            &lt;/div&gt;\n          &lt;/label&gt;\n        &lt;/li&gt;\n      &lt;/ul&gt;\n      &lt;li&gt;\n        &lt;%= pf.label :first_name, \"First Name\" %&gt;\n        &lt;%= pf.text_field :first_name, id: \"first-name\", placeholder: \"Jon\" %&gt;\n      &lt;/li&gt;\n      &lt;li&gt;\n        &lt;%= pf.label :last_name, \"Last Name\" %&gt;\n        &lt;%= pf.text_field :last_name, id: \"last-name\", placeholder: \"Snow\" %&gt;\n      &lt;/li&gt;\n      &lt;li&gt;\n      &lt;% end %&gt;\n        &lt;%= f.label :email, \"Email\" %&gt;\n        &lt;%= f.text_field :email, id: \"email\", placeholder: \"JSnow@winterfell.com\" %&gt;\n      &lt;/li&gt;\n      &lt;li&gt;\n        &lt;%#f.label :'company-name', \"Company name\" %&gt;\n        &lt;%# f.text_field :'company-name', id: \"company-name\", placeholder: \"Winterfell Ltd\" %&gt;\n        &lt;!-- &lt;label for=\"company-name\"&gt;Company name&lt;/label&gt;\n        &lt;input type=\"company-name\" id=\"company-name\" placeholder=\"Winterfell Ltd\"&gt; --&gt;\n      &lt;/li&gt;\n      &lt;li&gt;\n         &lt;label&gt;I want to receive my test in&lt;/label&gt;\n      &lt;/li&gt;\n      // Fields removed for brevity\n      &lt;li class=\"submit-button\"&gt;\n        &lt;button type=\"submit\"&gt;Submit&lt;/button&gt;\n      &lt;/li&gt;\n    &lt;/ul&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>Is anyone able to help me troubleshoot this?</p>\n\n<p>Edit: Updated to include form and routes.rb</p>\n\n<pre><code>Rails.application.routes.draw do\n\n  devise_for :user, skip: [:sessions], controllers: {registrations: 'registrations'}\n  as :user do\n    delete 'sign_out', to: 'devise/sessions#destroy', as: :destroy_user_session\n    get 'sign_in', to: 'devise/sessions#new', as: :new_user_session\n    post 'sign_in', to: 'devise/sessions#create', as: :user_session\n  end\n  resource :user, path: 'account' do\n     resource :profile, :test\n     resources :connections\n  end\n\n  get '/how-it-works' =&gt; 'home#how-it-works'\n  get '/sign-up' =&gt; 'home#sign-up'\n  get '/user' =&gt; 'users#index', as: :user_root\n\n  root 'home#index'\n\n  # For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html\nend\n</code></pre>\n\n<p>Rake routes are as below:</p>\n\n<pre><code>Prefix Verb   URI Pattern                             Controller#Action\n       new_user_password GET    /user/password/new(.:format)            devise/passwords#new\n      edit_user_password GET    /user/password/edit(.:format)           devise/passwords#edit\n           user_password PATCH  /user/password(.:format)                devise/passwords#update\n                         PUT    /user/password(.:format)                devise/passwords#update\n                         POST   /user/password(.:format)                devise/passwords#create\ncancel_user_registration GET    /user/cancel(.:format)                  registrations#cancel\n   new_user_registration GET    /user/sign_up(.:format)                 registrations#new\n  edit_user_registration GET    /user/edit(.:format)                    registrations#edit\n       user_registration PATCH  /user(.:format)                         registrations#update\n                         PUT    /user(.:format)                         registrations#update\n                         DELETE /user(.:format)                         registrations#destroy\n                         POST   /user(.:format)                         registrations#create\n    destroy_user_session DELETE /sign_out(.:format)                     devise/sessions#destroy\n        new_user_session GET    /sign_in(.:format)                      devise/sessions#new\n            user_session POST   /sign_in(.:format)                      devise/sessions#create\n        new_user_profile GET    /account/profile/new(.:format)          profiles#new\n       edit_user_profile GET    /account/profile/edit(.:format)         profiles#edit\n            user_profile GET    /account/profile(.:format)              profiles#show\n                         PATCH  /account/profile(.:format)              profiles#update\n                         PUT    /account/profile(.:format)              profiles#update\n                         DELETE /account/profile(.:format)              profiles#destroy\n                         POST   /account/profile(.:format)              profiles#create\n           new_user_test GET    /account/test/new(.:format)             tests#new\n          edit_user_test GET    /account/test/edit(.:format)            tests#edit\n               user_test GET    /account/test(.:format)                 tests#show\n                         PATCH  /account/test(.:format)                 tests#update\n                         PUT    /account/test(.:format)                 tests#update\n                         DELETE /account/test(.:format)                 tests#destroy\n                         POST   /account/test(.:format)                 tests#create\n        user_connections GET    /account/connections(.:format)          connections#index\n                         POST   /account/connections(.:format)          connections#create\n     new_user_connection GET    /account/connections/new(.:format)      connections#new\n    edit_user_connection GET    /account/connections/:id/edit(.:format) connections#edit\n         user_connection GET    /account/connections/:id(.:format)      connections#show\n                         PATCH  /account/connections/:id(.:format)      connections#update\n                         PUT    /account/connections/:id(.:format)      connections#update\n                         DELETE /account/connections/:id(.:format)      connections#destroy\n                new_user GET    /account/new(.:format)                  users#new\n               edit_user GET    /account/edit(.:format)                 users#edit\n                    user GET    /account(.:format)                      users#show\n                         PATCH  /account(.:format)                      users#update\n                         PUT    /account(.:format)                      users#update\n                         DELETE /account(.:format)                      users#destroy\n                         POST   /account(.:format)                      users#create\n            how_it_works GET    /how-it-works(.:format)                 home#how-it-works\n                 sign_up GET    /sign-up(.:format)                      home#sign-up\n               user_root GET    /user(.:format)                         users#index\n                    root GET    /                                       home#index\n</code></pre>\n"}, {"tags": ["ruby", "postgresql", "nginx", "passenger", "sidekiq"], "comments": [{"owner": {"reputation": 2070, "user_id": 1010826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d926cfe6638d33207f97dbd5a5103ba1?s=128&d=identicon&r=PG", "display_name": "Magnuss", "link": "https://stackoverflow.com/users/1010826/magnuss"}, "edited": false, "score": 0, "creation_date": 1504086504, "post_id": 45954830, "comment_id": 78872030, "body": "As per this answer: <a href=\"https://stackoverflow.com/a/726762/1010826\">stackoverflow.com/a/726762/1010826</a>, kernel may kill a process under <i>extreme resource starvation</i>. And this may as well be helpful: <a href=\"https://stackoverflow.com/a/726879/1010826\">stackoverflow.com/a/726879/1010826</a>"}, {"owner": {"reputation": 11, "user_id": 6803734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b32b6960e3adba2194308b18cb594ba6?s=128&d=identicon&r=PG&f=1", "display_name": "Bhupendra Singh", "link": "https://stackoverflow.com/users/6803734/bhupendra-singh"}, "reply_to_user": {"reputation": 2070, "user_id": 1010826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d926cfe6638d33207f97dbd5a5103ba1?s=128&d=identicon&r=PG", "display_name": "Magnuss", "link": "https://stackoverflow.com/users/1010826/magnuss"}, "edited": false, "score": 0, "creation_date": 1504091141, "post_id": 45954830, "comment_id": 78875199, "body": "But why sidekiq memory consumption increments according to times, whenever sidekiq worker is in ideal state. And how can we set maximum memory consumtion by sidekiq."}, {"owner": {"reputation": 2070, "user_id": 1010826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d926cfe6638d33207f97dbd5a5103ba1?s=128&d=identicon&r=PG", "display_name": "Magnuss", "link": "https://stackoverflow.com/users/1010826/magnuss"}, "edited": false, "score": 0, "creation_date": 1504091468, "post_id": 45954830, "comment_id": 78875421, "body": "Your logs show <code>sidekiq 4.1.2 Quickmilk [1 of 1 busy]</code> that means a job is running - inspect that job and see why it&#39;s taking that memory."}, {"owner": {"reputation": 11, "user_id": 6803734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b32b6960e3adba2194308b18cb594ba6?s=128&d=identicon&r=PG&f=1", "display_name": "Bhupendra Singh", "link": "https://stackoverflow.com/users/6803734/bhupendra-singh"}, "reply_to_user": {"reputation": 2070, "user_id": 1010826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d926cfe6638d33207f97dbd5a5103ba1?s=128&d=identicon&r=PG", "display_name": "Magnuss", "link": "https://stackoverflow.com/users/1010826/magnuss"}, "edited": false, "score": 0, "creation_date": 1504155938, "post_id": 45954830, "comment_id": 78905950, "body": "Hi Magnuss, i shared two logs here, you can see in first logs sidekiq worker is free there. But still this take so much memory."}, {"owner": {"reputation": 2070, "user_id": 1010826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d926cfe6638d33207f97dbd5a5103ba1?s=128&d=identicon&r=PG", "display_name": "Magnuss", "link": "https://stackoverflow.com/users/1010826/magnuss"}, "edited": false, "score": 0, "creation_date": 1504165423, "post_id": 45954830, "comment_id": 78910399, "body": "Seems that you have 1 gig or ram which is really not a lot. 200MiB of RAM for one RoR app is not unusual. How much did you expect it to be?"}, {"owner": {"reputation": 11, "user_id": 6803734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b32b6960e3adba2194308b18cb594ba6?s=128&d=identicon&r=PG&f=1", "display_name": "Bhupendra Singh", "link": "https://stackoverflow.com/users/6803734/bhupendra-singh"}, "reply_to_user": {"reputation": 2070, "user_id": 1010826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d926cfe6638d33207f97dbd5a5103ba1?s=128&d=identicon&r=PG", "display_name": "Magnuss", "link": "https://stackoverflow.com/users/1010826/magnuss"}, "edited": false, "score": 0, "creation_date": 1504182289, "post_id": 45954830, "comment_id": 78921997, "body": "I have 1 gb RAM, But i did not understand why my server take below memory on ideal state:"}, {"owner": {"reputation": 2340, "user_id": 2250791, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e72d4f734d39c777f543025d36d4de4e?s=128&d=identicon&r=PG", "display_name": "Camden Narzt", "link": "https://stackoverflow.com/users/2250791/camden-narzt"}, "edited": false, "score": 0, "creation_date": 1504196330, "post_id": 45954830, "comment_id": 78932001, "body": "Ruby doesn&#39;t reduce memory use nearly as much as native code when it&#39;s idle. It keeps all the loaded classes and constants in memory so that the next task to run doesn&#39;t have to load them from disk. As has been stated 200MB for an idle process isn&#39;t abnormal. If you want to reduce the absolute memory use you can set the <a href=\"https://www.phusionpassenger.com/library/config/nginx/reference/#passenger_min_instances\" rel=\"nofollow noreferrer\">passenger_min_instances</a> to 0, however it will then be slower to serve the first request after an idle period."}], "owner": {"reputation": 11, "user_id": 6803734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b32b6960e3adba2194308b18cb594ba6?s=128&d=identicon&r=PG&f=1", "display_name": "Bhupendra Singh", "link": "https://stackoverflow.com/users/6803734/bhupendra-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1504079392, "creation_date": 1504079392, "question_id": 45954830, "link": "https://stackoverflow.com/questions/45954830/sidekiq-killed-when-passenger-receive-multiple-requests", "title": "Sidekiq killed when passenger receive multiple requests", "body": "<p>I have a rails app which deployed on ec2 instance with nginx and passenger. For background job, i had used sidekiq with redis. I have 1 gb memory on server. I also have set max_pool_size to 1 for passenger in nginx config, and also set sidekiq concurrency to 1.</p>\n\n<p>when passenger get multiple requests it aquire maximum memory and sidekiq was killed by the reason of out of memory.</p>\n\n<p>Passenger and sidekiq take approx 54% of memory at ideal position and did not free memory after complete the process. below the log at ideal position:</p>\n\n<pre><code>ps aux --sort=-%mem | awk 'NR&lt;=10{print $0}'\nUSER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nubuntu   13975  1.5 24.8 774064 251908 ?       Sl   11:04   0:01 Passenger RubyApp: /var/www/dairylac/Quickmilk/current/public (staging)\nubuntu   14108  5.1 21.4 914332 217596 ?       Sl   11:04   0:03 sidekiq 4.1.2 Quickmilk [0 of 1 busy]\nubuntu   13858  3.8 19.9 491072 202544 ?       Sl   11:03   0:04 Passenger AppPreloader: /var/www/dairylac/Quickmilk/current\npostgres 13986  0.2  4.4 192528 45048 ?        Ss   11:04   0:00 postgres: enbake quickmilk_dev_one 127.0.0.1(32902) idle\npostgres  1489  0.0  3.5 185752 36044 ?        Ss   Aug29   0:06 postgres: writer process   \nubuntu   13952  0.0  1.9  42764 19376 ?        Ssl  11:04   0:00 /var/www/dairylac/Quickmilk/shared/bundle/ruby/2.1.0/gems/appsignal-1.2.5/ext/appsignal-agent\nroot     13811  0.1  1.6 677924 16744 ?        Sl   11:03   0:00 Passenger core\npostgres 14117  0.0  1.4 187736 14316 ?        Ss   11:04   0:00 postgres: enbake quickmilk_dev_one 127.0.0.1(32924) idle\npostgres 13959  0.0  1.4 187736 14308 ?        Ss   11:04   0:00 postgres: enbake quickmilk_dev_one 127.0.0.1(32900) idle\n</code></pre>\n\n<p>And when passenger and sidekiq get multiple requests then sidekiq killed by the reason of out of memory.</p>\n\n<pre><code> ps aux --sort=-%mem | awk 'NR&lt;=10{print $0}'\nUSER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nubuntu   27463  3.9 33.8 1045284 343428 ?      Sl   13:11   0:05 sidekiq 4.1.2 Quickmilk [1 of 1 busy]\nubuntu   27466  1.5 31.3 841340 317708 ?       Sl   13:11   0:02 Passenger RubyApp: /var/www/dairylac/Quickmilk/current/public (staging)\nubuntu   27370  2.8 18.6 492812 189012 ?       Sl   13:11   0:04 Passenger AppPreloader: /var/www/dairylac/Quickmilk/current\npostgres 27476  0.2  4.0 192540 41344 ?        Ss   13:11   0:00 postgres: enbake quickmilk_dev_one 127.0.0.1(33998) idle\npostgres 27915 21.0  3.5 189828 36296 ?        Ss   13:13   0:03 postgres: enbake quickmilk_dev_one 127.0.0.1(34040) idle in transaction\npostgres  1489  0.0  3.4 185752 34680 ?        Ss   Aug29   0:07 postgres: writer process   \nubuntu   27444  0.0  1.5  42764 15228 ?        Ssl  13:11   0:00 /var/www/dairylac/Quickmilk/shared/bundle/ruby/2.1.0/gems/appsignal-1.2.5/ext/appsignal-agent\nroot      1078  0.0  0.9 278696 10040 ?        S&lt;sl Aug29   0:01 /usr/lib/snapd/snapd\nredis     1069  0.0  0.8  39236  8976 ?        Ssl  Aug29   0:42 /usr/local/bin/redis-server 127.0.0.1:6379\n</code></pre>\n\n<p>I did not found why passenger and sidekiq was killed and how can i solve it.</p>\n\n<p>Please give me any suggesstion.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1504083665, "post_id": 45954412, "comment_id": 78870013, "body": "You are nearly there: <code>subject { super() }</code> is ok."}, {"owner": {"reputation": 1167, "user_id": 1658272, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/40806a8a10e8676108a748839c7d3ce2?s=128&d=identicon&r=PG", "display_name": "nrser", "link": "https://stackoverflow.com/users/1658272/nrser"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1504088028, "post_id": 45954412, "comment_id": 78873048, "body": "@mudasobwa really? I&#39;ll go back and try again, but I swear I had <code>super.call</code> in there (should be same as <code>super().call</code>) and it wasn&#39;t working..."}, {"owner": {"reputation": 1167, "user_id": 1658272, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/40806a8a10e8676108a748839c7d3ce2?s=128&d=identicon&r=PG", "display_name": "nrser", "link": "https://stackoverflow.com/users/1658272/nrser"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1504088160, "post_id": 45954412, "comment_id": 78873146, "body": "@mudasobwa huh, the <code>super().call</code> works (<code>super.call</code> doesn&#39;t)... weird... I guess I don&#39;t totally understand <code>super</code>, I thought it was a method call? Anyways, much thanks!"}, {"owner": {"reputation": 1167, "user_id": 1658272, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/40806a8a10e8676108a748839c7d3ce2?s=128&d=identicon&r=PG", "display_name": "nrser", "link": "https://stackoverflow.com/users/1658272/nrser"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1504088446, "post_id": 45954412, "comment_id": 78873365, "body": "OK, I see... bare <code>super</code> uses the &quot;implicit passing of arguments&quot; funky-ness, and it doesn&#39;t know what to do in that case, but <code>super()</code> explicitly tells it no args and it&#39;s cool with that."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1504088833, "post_id": 45954412, "comment_id": 78873609, "body": "Exactly. I have been there (not in <code>rspec</code>, but anyway) and since then I always pass parameters in calls to <code>super</code> explicitly. Honestly, I hate magic :)"}, {"owner": {"reputation": 1167, "user_id": 1658272, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/40806a8a10e8676108a748839c7d3ce2?s=128&d=identicon&r=PG", "display_name": "nrser", "link": "https://stackoverflow.com/users/1658272/nrser"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1504095165, "post_id": 45954412, "comment_id": 78878156, "body": "Yeah, I&#39;m not really a fan of the implicit <code>super</code> args... especially since it obviously breaks down in some cases (think this involves use of <code>def_method</code>). I probably could have figured it out if I had paid closer attention to the error message, but I guess I&#39;m pretty accustomed to not being able to figure out what the hell RSpec is actually doing without significant effort."}], "answers": [{"tags": [], "owner": {"reputation": 1167, "user_id": 1658272, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/40806a8a10e8676108a748839c7d3ce2?s=128&d=identicon&r=PG", "display_name": "nrser", "link": "https://stackoverflow.com/users/1658272/nrser"}, "is_accepted": false, "score": 1, "last_activity_date": 1504088648, "creation_date": 1504088648, "answer_id": 45957911, "question_id": 45954412, "link": "https://stackoverflow.com/questions/45954412/access-parent-scope-subject-in-rspec/45957911#45957911", "title": "Access parent scope subject in RSpec?", "body": "<p>OK, credit to @mudasobwa from the comments above, here's the solution:</p>\n\n<p>You need to call <code>super()</code> with <em>explicitly no arguments</em> - <code>super</code> alone won't work, because it tries to use Ruby's implicit passing of arguments and fails.</p>\n\n<p>Corrected example:</p>\n\n<pre><code>describe MyModule.method(:some_method) do\n\n  context \"when called with a String\" do\n    let(:string) { \"Hey there!\" }\n\n    # Note the explicit `()`:\n    subject { super().call string }\n\n    # Use subject...\n\n  end # when called with a String\n\nend # MyModule.some_method\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1167, "user_id": 1658272, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/40806a8a10e8676108a748839c7d3ce2?s=128&d=identicon&r=PG", "display_name": "nrser", "link": "https://stackoverflow.com/users/1658272/nrser"}, "edited": false, "score": 0, "creation_date": 1504108511, "post_id": 45961574, "comment_id": 78888536, "body": "<a href=\"https://relishapp.com/rspec/rspec-core/v/3-6/docs/metadata/described-class\" rel=\"nofollow noreferrer\">Docs</a> seems to imply <code>described_class</code> only applies if outer-most subject is a class (in this case it&#39;s a method). Anyways, I think I was wanting to use <code>subject</code> to make shared examples easier without passing parameters."}], "tags": [], "owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "is_accepted": false, "score": 0, "last_activity_date": 1504099099, "creation_date": 1504099099, "answer_id": 45961574, "question_id": 45954412, "link": "https://stackoverflow.com/questions/45954412/access-parent-scope-subject-in-rspec/45961574#45961574", "title": "Access parent scope subject in RSpec?", "body": "<p>you can name your subject:</p>\n\n<pre><code>context do \n  subject(:my_thing) { described_class.new }\n\n  context '#do_stuff'\n    subject { my_thing.do_stuff }\n\n    it { expect(subject).to ... } # or\n    it { is_expected.to ... }\n  end\nend   \n</code></pre>\n"}], "owner": {"reputation": 1167, "user_id": 1658272, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/40806a8a10e8676108a748839c7d3ce2?s=128&d=identicon&r=PG", "display_name": "nrser", "link": "https://stackoverflow.com/users/1658272/nrser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 703, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1504099099, "creation_date": 1504077965, "question_id": 45954412, "link": "https://stackoverflow.com/questions/45954412/access-parent-scope-subject-in-rspec", "title": "Access parent scope subject in RSpec?", "body": "<p>How can i access the parent scope's subject when defining the current scope's subject in RSpec (refining the subject)?</p>\n\n<p>Example code:</p>\n\n<pre><code>describe MyModule.method(:some_method) do\n\n  context \"when called with a String\" do\n    let(:string) { \"Hey there!\" }\n\n    # I want to refine the subject using the parent scope's subject - common case\n    # is applying a subject method. Something like:\n    subject { super.subject.call string }\n\n    # Use subject...\n\n  end # when called with a String\n\nend # MyModule.some_method\n</code></pre>\n"}, {"tags": ["ios", "iphone", "ruby", "automation", "appium"], "comments": [{"owner": {"reputation": 2461, "user_id": 3743875, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/f8d2eb45ac7e0958cb8d6f415035dc02?s=128&d=identicon&r=PG&f=1", "display_name": "Sunil Sharma", "link": "https://stackoverflow.com/users/3743875/sunil-sharma"}, "edited": false, "score": 0, "creation_date": 1514275447, "post_id": 45953191, "comment_id": 82920352, "body": "I am also facing the same situation. Did you found any solution ?"}, {"owner": {"reputation": 1772, "user_id": 5743300, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/86b739012f3bafbce2e40f59f3291c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Emjey", "link": "https://stackoverflow.com/users/5743300/emjey"}, "reply_to_user": {"reputation": 2461, "user_id": 3743875, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/f8d2eb45ac7e0958cb8d6f415035dc02?s=128&d=identicon&r=PG&f=1", "display_name": "Sunil Sharma", "link": "https://stackoverflow.com/users/3743875/sunil-sharma"}, "edited": false, "score": 1, "creation_date": 1514277924, "post_id": 45953191, "comment_id": 82921021, "body": "Not really. As a work around, for all the disabled elements, we have put a condition for accessibility label to return as false. So we are keeping two checks there, while asserting element with value, we check if its label is false or not, in case of false, we take it as disabled."}], "owner": {"reputation": 1772, "user_id": 5743300, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/86b739012f3bafbce2e40f59f3291c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Emjey", "link": "https://stackoverflow.com/users/5743300/emjey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 251, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1504073665, "creation_date": 1504073665, "question_id": 45953191, "link": "https://stackoverflow.com/questions/45953191/element-property-shows-enabled-always-even-if-the-element-is-disabled", "title": "Element Property shows Enabled always even if the element is disabled", "body": "<p>I find in the Appium inspector and even <code>isenabled?</code> code, that the element that has <code>userinteraction = false</code> shows <code>enabled = true</code> in Appium.</p>\n\n<p>This happens when I view element in iOS on both device and simulator.</p>\n\n<p>I need to pass a check, that returns me <code>enabled = false</code> if the element is disabled.</p>\n\n<p>I need to know if its an issue with Appium or which property in iOS element, should be modified so that Appium recognises that element status to be True/False based on the element being enabled/disabled respectively.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-engines", "rails-api", "ruby-on-rails-5.1"], "owner": {"reputation": 657, "user_id": 1320064, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/308b5900b3ebaa93aab1b29d6898d01c?s=128&d=identicon&r=PG", "display_name": "lsiebert", "link": "https://stackoverflow.com/users/1320064/lsiebert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1504071329, "creation_date": 1504071329, "question_id": 45952632, "link": "https://stackoverflow.com/questions/45952632/configuration-details-for-rails-api-only-app-with-one-or-two-full-routes", "title": "Configuration details for Rails API-only app with one or two full routes", "body": "<p>Let's assume I created a rails app passing the --api flag.  </p>\n\n<p>I want one or two routes that are full rails, with extra middleware, that inherit from ActionController::Base to serve the javascript single page application or whatever, etc.  </p>\n\n<p>I can presumably put them into a Rails engine and have the rest of the app use the api controllers and less middleware.</p>\n\n<p>What would I need to do to configure a Rails Engine to handle the root route like a full rails app while the main app was api only? Are there alternative configurations that may be worth considering? </p>\n"}, {"tags": ["ruby", "logging", "influxdb", "fluentd"], "answers": [{"tags": [], "owner": {"reputation": 1188, "user_id": 837489, "user_type": "registered", "accept_rate": 7, "profile_image": "https://i.stack.imgur.com/R6leD.jpg?s=128&g=1", "display_name": "sam", "link": "https://stackoverflow.com/users/837489/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1504085606, "creation_date": 1504085606, "answer_id": 45956826, "question_id": 45952355, "link": "https://stackoverflow.com/questions/45952355/fluentd-influxdb-installation-error/45956826#45956826", "title": "Fluentd influxdb installation Error?", "body": "<p>First of all I installed latest version of ruby from here<a href=\"http://ftp.ruby-lang.org/pub/ruby/\" rel=\"nofollow noreferrer\">ruby ftp</a></p>\n\n<p>Then I installed influxdb client\n  <code>apt-get install influxdb-dev influxdb-client.</code>\nAfter all downlad the latest version of fluend-plugin-influxdb from <a href=\"https://github.com/fangli/fluent-plugin-influxdb/releases\" rel=\"nofollow noreferrer\">git hub of plugin</a>\nthen I installed the plug in </p>\n\n<pre><code>/opt/td-agent/embedded/bin/gem install  fluent-plugin-influxdb\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 76, "user_id": 8564793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2626a12d4f19a1bf771fa00a900ea72c?s=128&d=identicon&r=PG&f=1", "display_name": "Anurag Gupta", "link": "https://stackoverflow.com/users/8564793/anurag-gupta"}, "is_accepted": false, "score": -1, "last_activity_date": 1504630957, "creation_date": 1504630957, "answer_id": 46060054, "question_id": 45952355, "link": "https://stackoverflow.com/questions/45952355/fluentd-influxdb-installation-error/46060054#46060054", "title": "Fluentd influxdb installation Error?", "body": "<p>td-agent (<a href=\"http://www.treasuredata.com\" rel=\"nofollow noreferrer\">Treasure Data's</a> packaged version of Fluentd) includes its own version of ruby within the /opt/td-agent/embedded/ directory and has links to ensure that it does not collide with other installations of ruby on the same box.</p>\n\n<p>You can update to the latest version of td-agent, or if you need a specific version of Ruby then you should</p>\n\n<ol>\n<li>Install Ruby version</li>\n<li>Follow <code>gem install</code> instructions here: <a href=\"https://docs.fluentd.org/v0.12/articles/install-by-gem\" rel=\"nofollow noreferrer\">https://docs.fluentd.org/v0.12/articles/install-by-gem</a></li>\n</ol>\n"}], "owner": {"reputation": 1188, "user_id": 837489, "user_type": "registered", "accept_rate": 7, "profile_image": "https://i.stack.imgur.com/R6leD.jpg?s=128&g=1", "display_name": "sam", "link": "https://stackoverflow.com/users/837489/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 271, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1504630957, "creation_date": 1504069948, "question_id": 45952355, "link": "https://stackoverflow.com/questions/45952355/fluentd-influxdb-installation-error", "title": "Fluentd influxdb installation Error?", "body": "<p>I want to install influxdb plugin but I get thid error.</p>\n\n<p>ERROR: Error installing fluent-plugin-influxdb:\n   influxdb requires Ruby version >= 2.2.0.</p>\n\n<p>I uninstalled my ruby and installed different versions from 2.0.0, 2.2.0, 2.3, 2.4\nbut the error still exist. would you please help me how to solve this.\nThank you.</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby"], "comments": [{"owner": {"reputation": 3063, "user_id": 1682038, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/90c9c92c135240a02e9bcd1c886bcae8?s=128&d=identicon&r=PG", "display_name": "rony36", "link": "https://stackoverflow.com/users/1682038/rony36"}, "edited": false, "score": 0, "creation_date": 1504068810, "post_id": 45952071, "comment_id": 78862454, "body": "are you sure? because response <code>json</code> is not a valid json you wrote"}, {"owner": {"reputation": 1155, "user_id": 4983469, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh6.googleusercontent.com/-btlwMISgi2c/AAAAAAAAAAI/AAAAAAAAAKs/L041fOZBcY0/photo.jpg?sz=128", "display_name": "leoOrion", "link": "https://stackoverflow.com/users/4983469/leoorion"}, "reply_to_user": {"reputation": 3063, "user_id": 1682038, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/90c9c92c135240a02e9bcd1c886bcae8?s=128&d=identicon&r=PG", "display_name": "rony36", "link": "https://stackoverflow.com/users/1682038/rony36"}, "edited": false, "score": 0, "creation_date": 1504069183, "post_id": 45952071, "comment_id": 78862551, "body": "If you mean the quotes around data, I have added it. It was a typo"}, {"owner": {"reputation": 3063, "user_id": 1682038, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/90c9c92c135240a02e9bcd1c886bcae8?s=128&d=identicon&r=PG", "display_name": "rony36", "link": "https://stackoverflow.com/users/1682038/rony36"}, "edited": false, "score": 0, "creation_date": 1504069567, "post_id": 45952071, "comment_id": 78862666, "body": "I believe in client-side parsed <code>json</code> is look like this: <a href=\"https://gist.github.com/mur-wtag/c2fde2f21c2fa33c424b6b68371c804c\" rel=\"nofollow noreferrer\">gist.github.com/mur-wtag/c2fde2f21c2fa33c424b6b68371c804c</a>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1504075679, "post_id": 45952071, "comment_id": 78865293, "body": "<code>put(&quot;url&quot;, json)</code> should do."}], "answers": [{"tags": [], "owner": {"reputation": 3063, "user_id": 1682038, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/90c9c92c135240a02e9bcd1c886bcae8?s=128&d=identicon&r=PG", "display_name": "rony36", "link": "https://stackoverflow.com/users/1682038/rony36"}, "is_accepted": false, "score": 0, "last_activity_date": 1504070217, "creation_date": 1504070217, "answer_id": 45952417, "question_id": 45952071, "link": "https://stackoverflow.com/questions/45952071/sending-array-of-json-objects-in-ruby-on-rails/45952417#45952417", "title": "Sending Array of Json objects in ruby on rails", "body": "<p>Try to define <code>Content-Type</code>:</p>\n\n<pre><code>json_data = '[{\"a\":1,\"b\":2},{\"a\":2,\"b\":1 }]'\nhash_body = JSON.parse json_data\nuri = URI.parse('https://www.google.com/api/something')\n\nrequest = Net::HTTP::Put.new(uri.request_uri, 'Content-Type' =&gt; 'application/json')\nrequest.body = hash_body\nresponse = http.request(request)\n</code></pre>\n\n<p>Cheers!</p>\n"}, {"tags": [], "owner": {"reputation": 1155, "user_id": 4983469, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh6.googleusercontent.com/-btlwMISgi2c/AAAAAAAAAAI/AAAAAAAAAKs/L041fOZBcY0/photo.jpg?sz=128", "display_name": "leoOrion", "link": "https://stackoverflow.com/users/4983469/leoorion"}, "is_accepted": true, "score": 0, "last_activity_date": 1504111197, "last_edit_date": 1504111197, "creation_date": 1504105272, "answer_id": 45963800, "question_id": 45952071, "link": "https://stackoverflow.com/questions/45952071/sending-array-of-json-objects-in-ruby-on-rails/45963800#45963800", "title": "Sending Array of Json objects in ruby on rails", "body": "<p>We couldn't use HTTP::Put.new because of some parameters that were set internally. We solved it by adding a method in the Her library that in turn uses Faraday to make the request. I am posting the method used here.</p>\n\n<pre><code>      response = self.use_api.connection.put do |req|\n        req.url url\n        req.headers['Content-Type'] = 'application/json'\n        req.body = json\n      end\n</code></pre>\n\n<p>I am not sure if this is the best method or not.</p>\n"}], "owner": {"reputation": 1155, "user_id": 4983469, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh6.googleusercontent.com/-btlwMISgi2c/AAAAAAAAAAI/AAAAAAAAAKs/L041fOZBcY0/photo.jpg?sz=128", "display_name": "leoOrion", "link": "https://stackoverflow.com/users/4983469/leoorion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1097, "favorite_count": 0, "accepted_answer_id": 45963800, "answer_count": 2, "score": 0, "last_activity_date": 1504111197, "creation_date": 1504068324, "last_edit_date": 1504077282, "question_id": 45952071, "link": "https://stackoverflow.com/questions/45952071/sending-array-of-json-objects-in-ruby-on-rails", "title": "Sending Array of Json objects in ruby on rails", "body": "<p>I want to send an array of JSON objects in a put request body.</p>\n\n<p>JSON body:</p>\n\n<pre><code>[\n {\n    \"a\":1,\n    \"b\":2\n },\n {\n    \"a\":2,\n    \"b\":1\n }\n]\n</code></pre>\n\n<p>I am using HTTP::put to make the request. I send data in the Json as a hash.</p>\n\n<p><code>put(\"url\", data: json)</code></p>\n\n<p>But, this causes problems as on the client side it is decoded as :</p>\n\n<pre><code>[\n \"data\":[{\n    \"a\":1,\n    \"b\":2\n },\n {\n    \"a\":2,\n    \"b\":1\n }]\n]\n</code></pre>\n\n<p>How do I send the Json without hashing or is there any way to get the values out of the hash before sending??</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1504076261, "post_id": 45951691, "comment_id": 78865608, "body": "<i>&quot;I believe this should be the case [...]&quot;</i> \u2013 to validate your assumptions, launch <a href=\"http://ruby-doc.org/stdlib-2.0.0/libdoc/irb/rdoc/IRB.html\" rel=\"nofollow noreferrer\">irb</a>, enter <code>array1 = [[0, 0], [2, 1]]</code> and then <code>array1[1][0]</code>."}, {"owner": {"reputation": 51, "user_id": 8459341, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10155256575038283/picture?type=large", "display_name": "Aaron Godhard", "link": "https://stackoverflow.com/users/8459341/aaron-godhard"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1504082937, "post_id": 45951691, "comment_id": 78869560, "body": "Who edited my god damn post without my permission?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1504084152, "post_id": 45951691, "comment_id": 78870346, "body": "Quoting Help Center &gt; Privileges &gt; <a href=\"https://stackoverflow.com/help/privileges/edit\">Edit Questions And Answers</a>: <i>&quot;We believe in the power of community editing. That means once you&#39;ve generated enough reputation, we trust you to edit <b>anything</b> in the system without it going through peer review. Not just your posts \u2013 <b>anyone&#39;s posts!</b>&quot;</i>"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 8459341, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10155256575038283/picture?type=large", "display_name": "Aaron Godhard", "link": "https://stackoverflow.com/users/8459341/aaron-godhard"}, "edited": false, "score": 0, "creation_date": 1504083044, "post_id": 45951766, "comment_id": 78869627, "body": "Wait. So you are saying that the first set of brackets represents [0, 0] and [2, 1], whereas the second set of brackets is either going to be 0, 0, 2, or 1? So if I call array1[1][1], I am looking at [0,0], and calling the second zero from that array within the array?  Therefore does it stand to reason that the format generally reads: arrayofarraysname[arraywithinarray][elementofarray]?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 51, "user_id": 8459341, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10155256575038283/picture?type=large", "display_name": "Aaron Godhard", "link": "https://stackoverflow.com/users/8459341/aaron-godhard"}, "edited": false, "score": 0, "creation_date": 1504084527, "post_id": 45951766, "comment_id": 78870640, "body": "@AaronGodhard <code>[]</code> is a method call which returns an object. If the receiver happens to be an array, then the return value is the object at the given index (zero-based), so <code>array1[1]</code> returns the 2nd element. If that element is also an array, then <code>array1[1][1]</code> will returns its 2nd element. You could also write: <code>subarray = array[1]</code> and call <code>subarray[1]</code> afterwards. Same result."}, {"owner": {"reputation": 51, "user_id": 8459341, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10155256575038283/picture?type=large", "display_name": "Aaron Godhard", "link": "https://stackoverflow.com/users/8459341/aaron-godhard"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1504121192, "post_id": 45951766, "comment_id": 78895706, "body": "@stefan Your answer perfectly paraphrases my question - thank you :). So basically I was thinking in the wrong terms here; I&#39;m not calling BOTH subarrays, I am calling ONE subarray."}], "tags": [], "owner": {"reputation": 4538, "user_id": 809830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdd9801d2717096282258b192edc7793?s=128&d=identicon&r=PG", "display_name": "Alex Kojin", "link": "https://stackoverflow.com/users/809830/alex-kojin"}, "is_accepted": false, "score": 3, "last_activity_date": 1504066124, "creation_date": 1504066124, "answer_id": 45951766, "question_id": 45951691, "link": "https://stackoverflow.com/questions/45951691/am-i-misunderstanding-min/45951766#45951766", "title": "Am I misunderstanding &#39;min&#39;?", "body": "<p>When <code>[1][0]</code> call for the first array you take the second array from it <code>[2, 1]</code> and then take the first number from taken array <code>2</code>.</p>\n\n<pre><code>array1[1][0] =&gt; 2\narray2[1][0] =&gt; 3\n[2, 3].min =&gt; 2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 1, "last_activity_date": 1504067655, "creation_date": 1504067655, "answer_id": 45951974, "question_id": 45951691, "link": "https://stackoverflow.com/questions/45951691/am-i-misunderstanding-min/45951974#45951974", "title": "Am I misunderstanding &#39;min&#39;?", "body": "<p>It goes like:</p>\n\n<pre><code>array1[1][0] == [2, 1][0] == 2\narray2[1][0] == [3, 1][0] == 3\n[array1[1][0], array2[1][0]].min == [2, 3].min # =&gt; 2\n</code></pre>\n\n<p>Under your counterfactual assumption:</p>\n\n<pre><code>array1[1][0] == [0, 2]\narray2[1][0] == [0, 3]\n</code></pre>\n\n<p>the comparison should be:</p>\n\n<pre><code>[array1[1][0], array2[1][0]].min == [[0, 2], [0, 3]].min # =&gt; [0, 2]\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 8459341, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10155256575038283/picture?type=large", "display_name": "Aaron Godhard", "link": "https://stackoverflow.com/users/8459341/aaron-godhard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1504067748, "creation_date": 1504065703, "last_edit_date": 1504067748, "question_id": 45951691, "link": "https://stackoverflow.com/questions/45951691/am-i-misunderstanding-min", "title": "Am I misunderstanding &#39;min&#39;?", "body": "<p>I have:</p>\n\n<pre><code>array1 = [[0, 0], [2, 1]]\narray2 = [[1, 0], [3, 1]]\n</code></pre>\n\n<p>I believe this should be the case:</p>\n\n<pre><code>array1[1][0] == [0, 2]\narray2[1][0] == [0, 3]\n</code></pre>\n\n<p>Following this, why is it that the following code,</p>\n\n<pre><code>[array1[1][0], array2[1][0]].min # =&gt; 2\n</code></pre>\n\n<p>returns <code>2</code>?</p>\n\n<p>How is it that <code>2</code> is the minimum out of two-dimensional arrays in which there are three instances of <code>0</code> and three instances of <code>1</code>?</p>\n\n<p>Am I misunderstanding the <code>min</code> function, or am I misunderstanding what is going on when I use the two-dimensional arrays?</p>\n"}, {"tags": ["ruby", "hash"], "comments": [{"owner": {"reputation": 2405, "user_id": 346912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50c0946fdf28e7126132cdbe315055bd?s=128&d=identicon&r=PG", "display_name": "Scott Newson", "link": "https://stackoverflow.com/users/346912/scott-newson"}, "edited": false, "score": 1, "creation_date": 1504065728, "post_id": 45951553, "comment_id": 78861679, "body": "Can you be more specific about what you are surprised by or don&#39;t understand?"}, {"owner": {"reputation": 121, "user_id": 5970657, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6c262d316a232bfbc12892f8dc8fb7fe?s=128&d=identicon&r=PG&f=1", "display_name": "Fatin Cooper", "link": "https://stackoverflow.com/users/5970657/fatin-cooper"}, "reply_to_user": {"reputation": 2405, "user_id": 346912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50c0946fdf28e7126132cdbe315055bd?s=128&d=identicon&r=PG", "display_name": "Scott Newson", "link": "https://stackoverflow.com/users/346912/scott-newson"}, "edited": false, "score": 0, "creation_date": 1504067535, "post_id": 45951553, "comment_id": 78862131, "body": "Well I expected gdu[&quot;d&quot;] to output [4,8,12] and &quot;e&quot; to be 4"}, {"owner": {"reputation": 2405, "user_id": 346912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50c0946fdf28e7126132cdbe315055bd?s=128&d=identicon&r=PG", "display_name": "Scott Newson", "link": "https://stackoverflow.com/users/346912/scott-newson"}, "edited": false, "score": 0, "creation_date": 1504067581, "post_id": 45951553, "comment_id": 78862141, "body": "Ok, see my answer below then"}], "answers": [{"tags": [], "owner": {"reputation": 2405, "user_id": 346912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50c0946fdf28e7126132cdbe315055bd?s=128&d=identicon&r=PG", "display_name": "Scott Newson", "link": "https://stackoverflow.com/users/346912/scott-newson"}, "is_accepted": false, "score": 2, "last_activity_date": 1504066308, "creation_date": 1504066308, "answer_id": 45951790, "question_id": 45951553, "link": "https://stackoverflow.com/questions/45951553/using-functions-to-populate-ruby-hashes/45951790#45951790", "title": "Using functions to populate Ruby hashes", "body": "<p>I think you are asking why the \"d\" and \"e\" values have zeros?</p>\n\n<p>Try running just:</p>\n\n<pre><code>gdu = {}\nputs gdu[\"b\"].to_i\n</code></pre>\n\n<p>you will see that you get zero here too. So you are getting zeros because \"b\" has not been set to anything yet, as all of the values are set at the same time.</p>\n"}, {"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 3, "last_activity_date": 1504068359, "creation_date": 1504068359, "answer_id": 45952076, "question_id": 45951553, "link": "https://stackoverflow.com/questions/45951553/using-functions-to-populate-ruby-hashes/45952076#45952076", "title": "Using functions to populate Ruby hashes", "body": "<ul>\n<li>As for <code>\"b\" =&gt; 4</code>, it should be trivial.</li>\n<li>As for <code>\"c\" =&gt; [1, 2, 3]</code>, it follows from <code>arr = [1,2,3]</code>.</li>\n<li><p>As for <code>\"d\" =&gt; [0, 0, 0]</code>, it goes like this:</p>\n\n<pre><code>gdu               # =&gt; {}\ngdu[\"b\"]          # =&gt; nil\ngdu[\"b\"].to_i     # =&gt; 0\nx * gdu[\"b\"].to_i # =&gt; 0\narr.map {|x| x * gdu[\"b\"].to_i } # =&gt; [1, 2, 3].map {|x| 0} # =&gt; [0, 0, 0]\n</code></pre></li>\n<li><p>As for <code>\"e\" =&gt; 0</code>, it is obvious from the step above.</p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 121, "user_id": 5970657, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6c262d316a232bfbc12892f8dc8fb7fe?s=128&d=identicon&r=PG&f=1", "display_name": "Fatin Cooper", "link": "https://stackoverflow.com/users/5970657/fatin-cooper"}, "edited": false, "score": 0, "creation_date": 1504327119, "post_id": 45953949, "comment_id": 78981506, "body": "I see that now. I thought that I could simultaneously set the value of &quot;e&quot; to &quot;b&quot; as I defined the Hash, but what happens is that the declaration accesses the empty hash that already exists in memory."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 5, "last_activity_date": 1504076362, "creation_date": 1504076362, "answer_id": 45953949, "question_id": 45951553, "link": "https://stackoverflow.com/questions/45951553/using-functions-to-populate-ruby-hashes/45953949#45953949", "title": "Using functions to populate Ruby hashes", "body": "<p>You are setting the whole hash\u2019s value at once, as one atomic operation. RHO uses the <em>current</em> version of <code>gdu</code>, which is an empty hash at the moment.</p>\n\n<p>To achieve what you wanted, assign values step by step:</p>\n\n<pre><code>gdu = {}\ngdu[\"b\"] = 4\ngdu[\"c\"] = arr\ngdu[\"d\"] = arr.map { |x| x * gdu[\"b\"] } # `to_i` is redundant\ngdu[\"e\"] =&gt; gdu[\"b\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 3, "last_activity_date": 1504077934, "creation_date": 1504077934, "answer_id": 45954406, "question_id": 45951553, "link": "https://stackoverflow.com/questions/45951553/using-functions-to-populate-ruby-hashes/45954406#45954406", "title": "Using functions to populate Ruby hashes", "body": "<blockquote>\n  <p>Why does the code here has this output?</p>\n</blockquote>\n\n<p>Because Ruby first evaluates the right-hand side of the assignment and then assigns the result (a new hash) to <code>gdu</code>.</p>\n\n<p>It becomes obvious if you separate the hash creation and the assignment:</p>\n\n<pre><code>arr = [1,2,3]\ngdu = {}\n\nhash = {\n      \"b\" =&gt; 4,\n      \"c\" =&gt; arr,\n      \"d\" =&gt; arr.map {|x| x * gdu[\"b\"].to_i },\n      \"e\" =&gt; gdu[\"b\"].to_i\n}\n#=&gt; {\"b\"=&gt;4, \"c\"=&gt;[1, 2, 3], \"d\"=&gt;[0, 0, 0], \"e\"=&gt;0}\n\ngdu = hash\n#=&gt; {\"b\"=&gt;4, \"c\"=&gt;[1, 2, 3], \"d\"=&gt;[0, 0, 0], \"e\"=&gt;0}\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 5970657, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6c262d316a232bfbc12892f8dc8fb7fe?s=128&d=identicon&r=PG&f=1", "display_name": "Fatin Cooper", "link": "https://stackoverflow.com/users/5970657/fatin-cooper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 45953949, "answer_count": 4, "score": 2, "last_activity_date": 1504079023, "creation_date": 1504064774, "last_edit_date": 1504079023, "question_id": 45951553, "link": "https://stackoverflow.com/questions/45951553/using-functions-to-populate-ruby-hashes", "title": "Using functions to populate Ruby hashes", "body": "<p>I get the following output from the code:</p>\n\n<pre><code>arr = [1,2,3]\ngdu = {}\ngdu = {\n      \"b\" =&gt; 4,\n      \"c\" =&gt; arr,\n      \"d\" =&gt; arr.map {|x| x * gdu[\"b\"].to_i },\n      \"e\" =&gt; gdu[\"b\"].to_i\n}\ngdu.default = \"value does not exit in hash gdu\"\ngdu # =&gt; {\"b\"=&gt;4, \"c\"=&gt;[1, 2, 3], \"d\"=&gt;[0, 0, 0], \"e\"=&gt;0}\n</code></pre>\n\n<p>Why does the code here have this output?</p>\n"}, {"tags": ["javascript", "ruby", "machine-learning", "pattern-matching"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1504067888, "post_id": 45951497, "comment_id": 78862230, "body": "Could you not use a regular expression such as <code>Regexp.union(&quot;154\\d{4}0000&quot;, &quot;0357\\d{3}0000&quot;)  #=&gt; &#47;154d\\{4\\}0000|0357d\\{3\\}0000&#47;</code> or (almost equivalently),  <code>Regexp.union(&#47;154\\d{4}0000&#47;, &#47;0357\\d{3}0000&#47;)  #=&gt; &#47;(?-mix:154\\d{4}0000)|(?-mix:0357\\d{3}0000)&#47;</code>, extended to include all patterns of interest? See the doc for <a href=\"http://ruby-doc.org/core-2.4.0/Regexp.html#method-c-union\" rel=\"nofollow noreferrer\">Regexp::union</a>. A &quot;machine learning&quot; approach here strikes me as pie-in-the-sky; just identify valid patterns."}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 1, "creation_date": 1504068065, "post_id": 45951497, "comment_id": 78862275, "body": "I believe they&#39;re asking for a way to identify &quot;all patterns of interest&quot; so they can do something along those lines, that&#39;s just my reading though"}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 1, "creation_date": 1504068149, "post_id": 45951497, "comment_id": 78862299, "body": "Seems like it <i>might</i> be a dup of <a href=\"https://stackoverflow.com/questions/1410822/how-can-i-detect-common-substrings-in-a-list-of-strings\" title=\"how can i detect common substrings in a list of strings\">stackoverflow.com/questions/1410822/&hellip;</a> (by way of <a href=\"https://stackoverflow.com/questions/30809687/find-common-patterns-across-strings-and-group-them-based-on-the-pattern\" title=\"find common patterns across strings and group them based on the pattern\">stackoverflow.com/questions/30809687/&hellip;</a> ) but I&#39;m a little on the fence about it"}, {"owner": {"reputation": 836, "user_id": 1243214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad1f97dfcd855c06d40ea3204f11fb47?s=128&d=identicon&r=PG", "display_name": "Mr. Tim", "link": "https://stackoverflow.com/users/1243214/mr-tim"}, "edited": false, "score": 0, "creation_date": 1504069715, "post_id": 45951497, "comment_id": 78862703, "body": "That first link has a lot of similarity to my problem, and also a lot of new words and concepts to explore in the answers section. I&#39;ll take a stroll through that in the morning. Thanks for the note!"}], "owner": {"reputation": 836, "user_id": 1243214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad1f97dfcd855c06d40ea3204f11fb47?s=128&d=identicon&r=PG", "display_name": "Mr. Tim", "link": "https://stackoverflow.com/users/1243214/mr-tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1504064540, "creation_date": 1504064298, "last_edit_date": 1504064540, "question_id": 45951497, "link": "https://stackoverflow.com/questions/45951497/how-to-detect-valid-formats-of-a-collection-of-strings", "title": "How to detect valid formats of a collection of strings?", "body": "<p>Assuming I had collection of around 5000 product codes, how can I identify valid string patterns?</p>\n\n<pre><code>prod_codes = [\n  '03578180000',\n  '03573880000',\n  '03575350000',\n  '15459990000',\n  '15479850000',\n  '15481130000',\n  '15478930000',\n  '15479790000',\n  '15481150000',\n  '15479490000'\n]\n</code></pre>\n\n<p>In this small example, there are 2 distinct styles of product codes: <code>154</code>s and <code>035(7)</code>s. I assume product codes end with <code>0000</code>. All codes are length 11. but I want technology to tell me with certainty using a larger sample.</p>\n\n<p>Ultimately I want some sort of a list of valid formats... like</p>\n\n<pre><code>154\\d{4}0000\n0357\\d{3}0000\n</code></pre>\n\n<p>The format above isn't important at all, I just want the insight so I can make documentation with confidence.</p>\n\n<p>Answering these questions strictly based on my own observations can be easy to test, but hard to identify in the first place, and relies on intuition. I can test this dataset by running a bunch of <code>group_by</code> type filters, and other \"one at a time test this theory\" type methods.</p>\n\n<p>My generic attempt might be to collect a <code>Set</code> of each character position for all of the data, and then analyze the <code>#size</code> of each character position set. When I see something like 1-2 for size, it tells me that this digit is fixed in some way. When I see something like 5+, it tells me it's likely \\d. Using this info, try to create a reasonable number of format strings.</p>\n\n<p>What machine learning strategies might I search for to learn how to analyze this data in such a way?</p>\n\n<p>Does this algorithm have a name? I feel like there is probably some machine learning strategy that not only can group my data up per character, but also find patterns like the <code>^154</code> kind of stuff and just spit out some ideas after eating my dataset.</p>\n\n<p>I'd prefer an answer that I can leverage in Ruby or JS, but whatever you can offer would be helpful.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "testing", "rspec", "acts-as-taggable-on"], "comments": [{"owner": {"reputation": 5535, "user_id": 7295772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZhWhR.jpg?s=128&g=1", "display_name": "Fabrizio Bertoglio", "link": "https://stackoverflow.com/users/7295772/fabrizio-bertoglio"}, "edited": false, "score": 0, "creation_date": 1504063092, "post_id": 45951227, "comment_id": 78861100, "body": "did you try with <code>gem update bundler</code> <a href=\"https://stackoverflow.com/questions/15060011/nameerror-uninitialized-constant-gemsourceindex#15937572\" title=\"nameerror uninitialized constant gemsourceindex%2315937572\">stackoverflow.com/questions/15060011/&hellip;</a>"}, {"owner": {"reputation": 979, "user_id": 916419, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/571208354/picture?type=large", "display_name": "Jingqiang Zhang", "link": "https://stackoverflow.com/users/916419/jingqiang-zhang"}, "reply_to_user": {"reputation": 5535, "user_id": 7295772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZhWhR.jpg?s=128&g=1", "display_name": "Fabrizio Bertoglio", "link": "https://stackoverflow.com/users/7295772/fabrizio-bertoglio"}, "edited": false, "score": 0, "creation_date": 1504063304, "post_id": 45951227, "comment_id": 78861145, "body": "@FabrizioBertoglio Thank you for your comment. I tried <code>gem update bundler</code> just now. Now bundler version became <code>1.15.4</code>, but the same  error happened when run <code>rspec</code>."}, {"owner": {"reputation": 5535, "user_id": 7295772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZhWhR.jpg?s=128&g=1", "display_name": "Fabrizio Bertoglio", "link": "https://stackoverflow.com/users/7295772/fabrizio-bertoglio"}, "edited": false, "score": 0, "creation_date": 1504064397, "post_id": 45951227, "comment_id": 78861385, "body": "ok what about upgrading to <code>gem &#39;acts-as-taggable-on&#39;, &#39;~&gt; 5.0&#39;</code> and <code>gem &#39;bundler&#39;, &#39;~&gt; 1.15&#39;, &#39;&gt;= 1.15.4&#39;</code> and <code>gem &#39;rspec&#39;, &#39;~&gt; 3.6&#39;</code>?  Sorry this is really a stupid advise, but you are using <code>rails 5</code> so why not use the latest versions of everything? maybe this problem was solved with the later versions? For the latest versions refer to  <a href=\"https://rubygems.org/\" rel=\"nofollow noreferrer\">rubygems.org</a>"}, {"owner": {"reputation": 979, "user_id": 916419, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/571208354/picture?type=large", "display_name": "Jingqiang Zhang", "link": "https://stackoverflow.com/users/916419/jingqiang-zhang"}, "reply_to_user": {"reputation": 5535, "user_id": 7295772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZhWhR.jpg?s=128&g=1", "display_name": "Fabrizio Bertoglio", "link": "https://stackoverflow.com/users/7295772/fabrizio-bertoglio"}, "edited": false, "score": 0, "creation_date": 1504065584, "post_id": 45951227, "comment_id": 78861648, "body": "@FabrizioBertoglio Your advise is a way. I used a logic includes <code>ActsAsTaggableOn::GenericParser</code> and I added the source to the question. Now I am trying to use another way to realize the same result then remove that source. And rspec works. Maybe that&#39;s the version problem between several gems. Thank you very much for your follow."}, {"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "edited": false, "score": 0, "creation_date": 1504162108, "post_id": 45951227, "comment_id": 78908441, "body": "Please provide full trace, not only exception."}, {"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "edited": false, "score": 0, "creation_date": 1504162158, "post_id": 45951227, "comment_id": 78908466, "body": "also - how do you run your rspecs? Did you try <code>bundle exec rspec</code>?"}, {"owner": {"reputation": 979, "user_id": 916419, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/571208354/picture?type=large", "display_name": "Jingqiang Zhang", "link": "https://stackoverflow.com/users/916419/jingqiang-zhang"}, "reply_to_user": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "edited": false, "score": 0, "creation_date": 1504162738, "post_id": 45951227, "comment_id": 78908809, "body": "@meta I have changed method and the error didn&#39;t happened. It must be a bug I think. I used <code>bundle exec rspec</code>, but not that problem."}], "answers": [{"tags": [], "owner": {"reputation": 8754, "user_id": 6719819, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/HmF9I.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/6719819/daniel"}, "is_accepted": true, "score": 1, "last_activity_date": 1504836751, "creation_date": 1504836751, "answer_id": 46107629, "question_id": 45951227, "link": "https://stackoverflow.com/questions/45951227/cant-run-rspec-when-using-rails-5-and-acts-as-taggable-on-4/46107629#46107629", "title": "Can&#39;t run rspec when using Rails 5 and acts-as-taggable-on 4", "body": "<p>Your file name is incorrect, you have</p>\n\n<pre><code>lib/acts_as_taggable_on/generic_parser.rb\n</code></pre>\n\n<p>If the class is MyParser Rails need to map to that class via the name of the file which should be my_parser.rb and thus it should be</p>\n\n<pre><code>lib/acts_as_taggable_on/my_parser.rb\n</code></pre>\n"}], "owner": {"reputation": 979, "user_id": 916419, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/571208354/picture?type=large", "display_name": "Jingqiang Zhang", "link": "https://stackoverflow.com/users/916419/jingqiang-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 46107629, "answer_count": 1, "score": 0, "last_activity_date": 1504836751, "creation_date": 1504062249, "last_edit_date": 1504065169, "question_id": 45951227, "link": "https://stackoverflow.com/questions/45951227/cant-run-rspec-when-using-rails-5-and-acts-as-taggable-on-4", "title": "Can&#39;t run rspec when using Rails 5 and acts-as-taggable-on 4", "body": "<h1>Versions</h1>\n\n<ul>\n<li>Ruby: 2.3.3</li>\n<li>Bundler: 1.14.6</li>\n<li>Rails: 5.0.2</li>\n<li>acts-as-taggable-on: 4.0.0</li>\n<li>Rspec: 3.5.4</li>\n</ul>\n\n<h1>Gemfile</h1>\n\n<pre><code>gem 'rails', '~&gt; 5.0.0', '&gt;= 5.0.0.1'\ngem 'acts-as-taggable-on', '~&gt; 4.0'\n\ngroup :development, :test do\n  gem 'rspec-rails', '~&gt; 3.5'\nend\n</code></pre>\n\n<h1>Logic</h1>\n\n<p>lib/acts_as_taggable_on/generic_parser.rb</p>\n\n<pre><code>class MyParser &lt; ActsAsTaggableOn::GenericParser\n  def parse\n    ActsAsTaggableOn::TagList.new.tap do |tag_list|\n      tag_list.add @tag_list.split(',').map(&amp;:strip).reject(&amp;:empty?)\n    end\n  end\nend\n</code></pre>\n\n<h1>Exception</h1>\n\n<p>When running <code>rpsec</code>, got these errors:</p>\n\n<pre><code>/Users/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/bundler-1.14.6/lib/bundler/runtime.rb:94:in `rescue in block (2 levels) in require': There was an error while trying to load the gem 'acts-as-taggable-on'. (Bundler::GemRequireError)\nGem Load Error is: uninitialized constant ActsAsTaggableOn::GenericParser\n</code></pre>\n\n<p>How to fix it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "combinations"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1504066658, "post_id": 45950993, "comment_id": 78861911, "body": "If you wish to take the first so-many combinations is there a reason you want to construct an array as opposed to simply having the enumerator pass the first <code>n</code> elements to another enumerator or a block?"}, {"owner": {"reputation": 137, "user_id": 8230428, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5ca1140f36a3f53b85638086c6cc08b1?s=128&d=identicon&r=PG&f=1", "display_name": "qanknku", "link": "https://stackoverflow.com/users/8230428/qanknku"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1504067265, "post_id": 45950993, "comment_id": 78862060, "body": "what i&#39;m doing is actually making combinations between different 4 groups, so if I use calling enumerator in enumerator, I thought it causes so many overlaps. @Cary Swoveland"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1504068665, "post_id": 45950993, "comment_id": 78862421, "body": "If you mean that you wish to generate the first so many 4-tuples obtained by drawing one element from each of 4 arrays, that would be a different problem, albeit an interesting one. If so, please consider posting another question."}], "answers": [{"comments": [{"owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "edited": false, "score": 0, "creation_date": 1504067188, "post_id": 45951045, "comment_id": 78862041, "body": "@jh-shin Please note that the location of the <code>lazy</code> call was wrong previously, I shouldn&#39;t post here before coffee..."}, {"owner": {"reputation": 137, "user_id": 8230428, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5ca1140f36a3f53b85638086c6cc08b1?s=128&d=identicon&r=PG&f=1", "display_name": "qanknku", "link": "https://stackoverflow.com/users/8230428/qanknku"}, "edited": false, "score": 0, "creation_date": 1504070623, "post_id": 45951045, "comment_id": 78862997, "body": "no prob. I&#39;ve figured it out. thanks for alarming me about <code>lazy</code>"}], "tags": [], "owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "is_accepted": true, "score": 4, "last_activity_date": 1504067134, "last_edit_date": 1504067134, "creation_date": 1504060709, "answer_id": 45951045, "question_id": 45950993, "link": "https://stackoverflow.com/questions/45950993/limiting-the-number-of-trials-in-combination-ruby/45951045#45951045", "title": "Limiting the number of trials in combination Ruby", "body": "<p>Try this:</p>\n\n<pre><code>result_array = a.combination(4).lazy.map(&amp;:join).take(2).to_a\n</code></pre>\n\n<p><code>lazy</code> will ensure that you only compute as many values as needed by <code>take</code>.</p>\n"}], "owner": {"reputation": 137, "user_id": 8230428, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5ca1140f36a3f53b85638086c6cc08b1?s=128&d=identicon&r=PG&f=1", "display_name": "qanknku", "link": "https://stackoverflow.com/users/8230428/qanknku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 45951045, "answer_count": 1, "score": 0, "last_activity_date": 1504067134, "creation_date": 1504060290, "last_edit_date": 1504062693, "question_id": 45950993, "link": "https://stackoverflow.com/questions/45950993/limiting-the-number-of-trials-in-combination-ruby", "title": "Limiting the number of trials in combination Ruby", "body": "<p>The following code calculates all the results of <code>5C4</code> (5 combination 4) as a string:</p>\n\n<pre><code>a = ['1', '2', '3', '4', '5']\nresult_array = a.combination(4).map(&amp;:join).to_a\n</code></pre>\n\n<p>Is there a method I can use to limit the number of combination trials, similarly to the <code>itertools</code> module in Python?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "activeadmin"], "answers": [{"tags": [], "owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "is_accepted": true, "score": 2, "last_activity_date": 1504061150, "creation_date": 1504061150, "answer_id": 45951088, "question_id": 45950909, "link": "https://stackoverflow.com/questions/45950909/rails-activerecord-how-can-i-give-custom-order-for-has-and-belongs-to-many-rel/45951088#45951088", "title": "Rails ActiveRecord : How can I give custom order for has_and_belongs_to_many relationship join table?", "body": "<p>A Rails <code>has_and_belongs_to_many</code> relationship is designed to create the relationship by means of a table that has two columns only: an id for each table and nothing else, not even an id of its own. See the docs <a href=\"http://guides.rubyonrails.org/association_basics.html#the-has-and-belongs-to-many-association\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>I think what you want is a <code>has_many :through</code> relationship, which will allow you to have a <code>themes_offers</code> table with additional attributes on it. Docs are <a href=\"http://guides.rubyonrails.org/association_basics.html#the-has-many-through-association\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 347, "user_id": 3969907, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e90745f8b9862f736b023e91b15abc0?s=128&d=identicon&r=PG", "display_name": "zoonoo", "link": "https://stackoverflow.com/users/3969907/zoonoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 45951088, "answer_count": 1, "score": 1, "last_activity_date": 1504061150, "creation_date": 1504059530, "question_id": 45950909, "link": "https://stackoverflow.com/questions/45950909/rails-activerecord-how-can-i-give-custom-order-for-has-and-belongs-to-many-rel", "title": "Rails ActiveRecord : How can I give custom order for has_and_belongs_to_many relationship join table?", "body": "<p>Currently, I have two classes <code>Theme</code> and <code>Offer</code> mapped by a join table <code>themes_offers</code> containing <code>theme_id</code> and <code>offer_id</code>.</p>\n\n<p>I need to implement a view with custom order of offers for each theme.</p>\n\n<p>So the current idea I have is to add a column on the table, and create new activerecord class mapped to the table:</p>\n\n<pre><code>class AddOrderToThemesOffers &lt; ActiveRecord::Migration[5.0]\n  def up\n    add_column :themes_offers, :order, :integer\n\n    # mark order for each existing orders\n\n    add_index :themes_offers, [:theme_id, :order], unique: true, name: 'index_offer_order_on_theme'\n  end\n\n  def down\n    remove_index :themes_offers, 'index_offer_order_on_theme'\n    remove_column :themes_offers, :order, :integer\n  end\nend\n</code></pre>\n\n<p>Would there be a better approach? The problem I have with this solution is that it will be difficult to implement activeadmin interface to handle the orders.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4", "ruby-on-rails-3.2"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 8448105, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/1394817423959984/picture?type=large", "display_name": "Shashi Yerra", "link": "https://stackoverflow.com/users/8448105/shashi-yerra"}, "edited": false, "score": 0, "creation_date": 1504059772, "post_id": 45950840, "comment_id": 78860435, "body": "Unknown action The action &#39;show&#39; could not be found for ArticlesController"}, {"owner": {"reputation": 5519, "user_id": 938947, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f611b152b4fa9fe2a05f4ee9b84fdcb7?s=128&d=identicon&r=PG", "display_name": "widjajayd", "link": "https://stackoverflow.com/users/938947/widjajayd"}, "reply_to_user": {"reputation": 45, "user_id": 8448105, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/1394817423959984/picture?type=large", "display_name": "Shashi Yerra", "link": "https://stackoverflow.com/users/8448105/shashi-yerra"}, "edited": false, "score": 0, "creation_date": 1504060002, "post_id": 45950840, "comment_id": 78860481, "body": "just added in my answer how add show action in article controller"}], "tags": [], "owner": {"reputation": 5519, "user_id": 938947, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f611b152b4fa9fe2a05f4ee9b84fdcb7?s=128&d=identicon&r=PG", "display_name": "widjajayd", "link": "https://stackoverflow.com/users/938947/widjajayd"}, "is_accepted": true, "score": 0, "last_activity_date": 1504059939, "last_edit_date": 1504059939, "creation_date": 1504058973, "answer_id": 45950840, "question_id": 45950764, "link": "https://stackoverflow.com/questions/45950764/nameerror-in-articlescontrollercreate-undefined-local-variable-or-method-artic/45950840#45950840", "title": "NameError in ArticlesController#create undefined local variable or method `article_params&#39; for #&lt;ArticlesController:Did you mean? article_path", "body": "<p>put article params outside of create </p>\n\n<pre><code>class ArticlesController &lt; ApplicationController\n\n   def new\n     @article = Article.new \n   end\n\n   def create\n     @article = Article.new(article_params)\n     if  @article.save\n       flash[:notice] = \"Article was submitted succsefully\"\n       redirect_to (@article)\n     else\n       render :new\n     end \n   end\n\n  # this is show method\n  def show\n    @article = Article.find(params[:id])\n  end\n\n    private \n    def article_params \n       params.require(:article).permit(:title, :description)\n    end\nend \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 149, "user_id": 3537071, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/hjb9a.jpg?s=128&g=1", "display_name": "chrisgeeq", "link": "https://stackoverflow.com/users/3537071/chrisgeeq"}, "is_accepted": false, "score": 0, "last_activity_date": 1504084143, "creation_date": 1504084143, "answer_id": 45956333, "question_id": 45950764, "link": "https://stackoverflow.com/questions/45950764/nameerror-in-articlescontrollercreate-undefined-local-variable-or-method-artic/45956333#45956333", "title": "NameError in ArticlesController#create undefined local variable or method `article_params&#39; for #&lt;ArticlesController:Did you mean? article_path", "body": "<p>I think the create action was not properly closed,therefore you have the article_params method inside the create action,delete the 'end' at the last line and add an 'end' to the create action,its a syntax error. like this</p>\n\n<pre><code>class ArticlesController &lt; ApplicationController\n  def new\n    @article = Article.new\n  end\n\n      def create\n        @article = Article.new(article_params)\n        if  @article.save\n          flash[:notice] = \"Article was submitted succsefully\"\n          redirect_to (@article)\n        else\n          render :new\n        end\n        end\n\n        private\n        def article_params\n          params.require(:article).permit(:title, :description)\n        end\n      end\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 8448105, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/1394817423959984/picture?type=large", "display_name": "Shashi Yerra", "link": "https://stackoverflow.com/users/8448105/shashi-yerra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1039, "favorite_count": 0, "accepted_answer_id": 45950840, "answer_count": 2, "score": 0, "last_activity_date": 1504084143, "creation_date": 1504058423, "last_edit_date": 1504078075, "question_id": 45950764, "link": "https://stackoverflow.com/questions/45950764/nameerror-in-articlescontrollercreate-undefined-local-variable-or-method-artic", "title": "NameError in ArticlesController#create undefined local variable or method `article_params&#39; for #&lt;ArticlesController:Did you mean? article_path", "body": "<p>I am getting this error when I create my articles:</p>\n\n<p>error: NameError in ArticlesController#create\nundefined local variable or method `article_params' for # Did you mean? article_path</p>\n\n<p>image of error : <a href=\"https://i.stack.imgur.com/EvnRV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EvnRV.png\" alt=\"enter image description here\"></a></p>\n\n<p>my code :</p>\n\n<pre><code>class ArticlesController &lt; ApplicationController\n  def new\n    @article = Article.new\n  end\n\n  def create\n    @article = Article.new(article_params)\n    if  @article.save\n      flash[:notice] = \"Article was submitted succsefully\"\n      redirect_to (@article)\n    else\n      render :new\n    end\n\n    private\n\n    def article_params\n      params.require(:article).permit(:title, :description)\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "haml"], "answers": [{"tags": [], "owner": {"reputation": 437, "user_id": 970077, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e8446e6559d00c44a63238ccc6317bd0?s=128&d=identicon&r=PG", "display_name": "refeniz", "link": "https://stackoverflow.com/users/970077/refeniz"}, "is_accepted": true, "score": 1, "last_activity_date": 1504059833, "creation_date": 1504059833, "answer_id": 45950936, "question_id": 45950682, "link": "https://stackoverflow.com/questions/45950682/ruby-partial-block-render-out-of-order/45950936#45950936", "title": "Ruby partial block render out of order", "body": "<p>This is actually due to an issue inside HAML:\n<a href=\"http://haml.info/docs/yardoc/Haml/Engine.html\" rel=\"nofollow noreferrer\">http://haml.info/docs/yardoc/Haml/Engine.html</a></p>\n\n<blockquote>\n  <p>Due to some Ruby quirks, if scope is a Binding or Proc object and a block is given, the evaluation context may not be quite what the user expects.</p>\n</blockquote>\n\n<p>However, this can be worked around with the <code>capture_haml</code> helper!</p>\n\n<pre><code>= capture_haml &amp;row_block\n</code></pre>\n\n<p>You can still pass params too, with</p>\n\n<pre><code>= capture_haml arg1, arg2, &amp;row_block\n</code></pre>\n"}], "owner": {"reputation": 437, "user_id": 970077, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e8446e6559d00c44a63238ccc6317bd0?s=128&d=identicon&r=PG", "display_name": "refeniz", "link": "https://stackoverflow.com/users/970077/refeniz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 45950936, "answer_count": 1, "score": 0, "last_activity_date": 1504059833, "creation_date": 1504057816, "last_edit_date": 1504058173, "question_id": 45950682, "link": "https://stackoverflow.com/questions/45950682/ruby-partial-block-render-out-of-order", "title": "Ruby partial block render out of order", "body": "<p>I am defining a block in a template and passing that into a partial and rendering it to a string but calling the block inside the partial appears to render into the template context?</p>\n\n<p><strong>lib/test.rb</strong></p>\n\n<pre><code>class Test\n  def render(&amp;block)\n    view = ApplicationController.new()\n\n    view.class_eval do\n      include ApplicationHelper\n    end\n\n    view.render_to_string(:partial =&gt; 'cool_partial', :locals =&gt; {\n      :block   =&gt; block\n    })\n\n  end\nend\n</code></pre>\n\n<p><strong>controller/action.haml</strong></p>\n\n<pre><code>= @test_obj.render do |variable|\n  %td='hello-world'\n</code></pre>\n\n<p><strong>app/view/_cool_partial.haml</strong></p>\n\n<pre><code>%table\n  %tr\n    (0..5).each do |i|\n       block.call\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>&lt;td&gt;hello-world&lt;/td&gt;\n&lt;td&gt;hello-world&lt;/td&gt;\n&lt;td&gt;hello-world&lt;/td&gt;\n&lt;td&gt;hello-world&lt;/td&gt;\n&lt;td&gt;hello-world&lt;/td&gt;\n&lt;table&gt;\n    &lt;tr&gt;&lt;/tr&gt;\n    &lt;tr&gt;&lt;/tr&gt;\n    &lt;tr&gt;&lt;/tr&gt;\n    &lt;tr&gt;&lt;/tr&gt;\n    &lt;tr&gt;&lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1504052325, "post_id": 45950058, "comment_id": 78858869, "body": "You have a ton of empty space here. Keep your code organized, as neat and tidy as you can afford, because sloppy code is where bugs hide."}, {"owner": {"reputation": 45, "user_id": 8448105, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/1394817423959984/picture?type=large", "display_name": "Shashi Yerra", "link": "https://stackoverflow.com/users/8448105/shashi-yerra"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1504139681, "post_id": 45950058, "comment_id": 78902090, "body": "sorry for that i will try better"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 8448105, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/1394817423959984/picture?type=large", "display_name": "Shashi Yerra", "link": "https://stackoverflow.com/users/8448105/shashi-yerra"}, "edited": false, "score": 0, "creation_date": 1504052477, "post_id": 45950074, "comment_id": 78858906, "body": "i have edited please check"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 45, "user_id": 8448105, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/1394817423959984/picture?type=large", "display_name": "Shashi Yerra", "link": "https://stackoverflow.com/users/8448105/shashi-yerra"}, "edited": false, "score": 0, "creation_date": 1504052512, "post_id": 45950074, "comment_id": 78858914, "body": "@ShashiYerra I&#39;m not sure you even looked at this answer."}, {"owner": {"reputation": 45, "user_id": 8448105, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/1394817423959984/picture?type=large", "display_name": "Shashi Yerra", "link": "https://stackoverflow.com/users/8448105/shashi-yerra"}, "edited": false, "score": 0, "creation_date": 1504052642, "post_id": 45950074, "comment_id": 78858947, "body": "I have still got the same error except with parentheses around [:notice]"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 45, "user_id": 8448105, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/1394817423959984/picture?type=large", "display_name": "Shashi Yerra", "link": "https://stackoverflow.com/users/8448105/shashi-yerra"}, "edited": false, "score": 0, "creation_date": 1504052682, "post_id": 45950074, "comment_id": 78858954, "body": "Do it <i>exactly</i> as in the first example with no space between <code>flash</code> and <code>[:notice]</code>."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 1, "last_activity_date": 1504052216, "creation_date": 1504052216, "answer_id": 45950074, "question_id": 45950058, "link": "https://stackoverflow.com/questions/45950058/syntax-error-unexpected-expecting-keyword-end-flash-notice-article-w/45950074#45950074", "title": "syntax error, unexpected &#39;=&#39;, expecting keyword_end flash [:notice] = &quot;Article was submitted succsefully&quot;", "body": "<p>You need to be careful when writing code, often every character counts:</p>\n\n<pre><code>flash[:notice] = \"Article was submitted succsefully\"\n</code></pre>\n\n<p>That space was causing the parsing to get all wonky.</p>\n\n<p>What your code was being interpreted as was:</p>\n\n<pre><code>flash([:notice]) = \"Article was submitted succsefully\"\n</code></pre>\n\n<p>That's not valid Ruby.</p>\n\n<p>Also: \"succsefully\" is not spelled right. Hope you didn't ship that yet!</p>\n"}, {"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1504052349, "post_id": 45950080, "comment_id": 78858876, "body": "This is a pretty aggressive reworking of the code, and while that&#39;s not bad, posting it without comment isn&#39;t as educational as it could be. This will likely raise more questions than it answers."}], "tags": [], "owner": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "is_accepted": true, "score": 0, "last_activity_date": 1504052250, "creation_date": 1504052250, "answer_id": 45950080, "question_id": 45950058, "link": "https://stackoverflow.com/questions/45950058/syntax-error-unexpected-expecting-keyword-end-flash-notice-article-w/45950080#45950080", "title": "syntax error, unexpected &#39;=&#39;, expecting keyword_end flash [:notice] = &quot;Article was submitted succsefully&quot;", "body": "<p>Try:</p>\n\n<pre><code>respond_to do |format|\n      if @article.save\n        format.html { redirect_to_article_path(@article), notice: \"Article was submitted succsefully\" }\n        format.json { head :no_content }\n      else\n        format.html { render :new }\n        format.json { render json: @article.errors, status: :unprocessable_entity }\n      end\n end\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 8448105, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/1394817423959984/picture?type=large", "display_name": "Shashi Yerra", "link": "https://stackoverflow.com/users/8448105/shashi-yerra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "closed_date": 1506298747, "accepted_answer_id": 45950080, "answer_count": 2, "score": -2, "last_activity_date": 1504052411, "creation_date": 1504052050, "last_edit_date": 1504052411, "question_id": 45950058, "link": "https://stackoverflow.com/questions/45950058/syntax-error-unexpected-expecting-keyword-end-flash-notice-article-w", "closed_reason": "Not suitable for this site", "title": "syntax error, unexpected &#39;=&#39;, expecting keyword_end flash [:notice] = &quot;Article was submitted succsefully&quot;", "body": "<p>I have this error which is not letting me look at articles that are created \nthis is the error \nsyntax error, unexpected '=', expecting keyword_end flash [:notice] = \"Article was submitted succsefully\"</p>\n\n<p>image <a href=\"https://i.stack.imgur.com/eyfLp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eyfLp.png\" alt=\"enter image description here\"></a></p>\n\n<p>here are my codes\narticle_controller.rb file: </p>\n\n<pre><code>class ArticlesController &lt; ApplicationController\n\n   def new\n     @article = Article.new \n   end\n   def create\n  @article = Article.new(article_params)\n\n\n if  @article.save\n  flash [:notice] = \"Article was submitted succsefully\"\n  redirect_to_article_path(@article)\nelse\n   render :new\n end \nend \n    private \n    def article_params \n       params.require(:article).permit(:title, :description)\n\n    end\n\n\n\n\n\n   end\n\n\n\n\nend \n</code></pre>\n\n<p>ask me for any other files if you need them </p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1504052559, "post_id": 45949836, "comment_id": 78858926, "body": "Careful with this as sometimes prices are expressed as <code>2,999</code> which <i>probably</i> means 2999 and <code>2,99</code> which means 2.99 if using European notation."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1504059707, "post_id": 45949836, "comment_id": 78860415, "body": "Imo, <code>reg_price.delete(&#39;,&#39;)</code> is more direct and reads better."}], "tags": [], "owner": {"reputation": 27630, "user_id": 1550807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JgCw5.png?s=128&g=1", "display_name": "Danil Speransky", "link": "https://stackoverflow.com/users/1550807/danil-speransky"}, "is_accepted": true, "score": 2, "last_activity_date": 1504050192, "creation_date": 1504050192, "answer_id": 45949836, "question_id": 45949749, "link": "https://stackoverflow.com/questions/45949749/rails-amounts-in-thousands-are-truncated/45949836#45949836", "title": "Rails Amounts in Thousands Are Truncated", "body": "<p>You are not doing anything wrong. Decimals don't work with comma separator. I'm not sure there is a nice way to fix the thing. But as an option you could define a virtual attribute:</p>\n\n<pre><code>def reg_price=(reg_price)\n  self[:reg_price] = reg_price.gsub(',', '')\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "is_accepted": false, "score": 2, "last_activity_date": 1504055593, "creation_date": 1504055593, "answer_id": 45950442, "question_id": 45949749, "link": "https://stackoverflow.com/questions/45949749/rails-amounts-in-thousands-are-truncated/45950442#45950442", "title": "Rails Amounts in Thousands Are Truncated", "body": "<p>The reason this is happening has nothing to do with Rails. </p>\n\n<ol>\n<li>JSON is a pretty simple document structure and doesn't have any support for number separators. The values in your JSON document are strings. </li>\n<li>When you receive a String as input and you want to store it as an Integer, you need to cast it to the appropriate type. </li>\n<li>Ruby has built in support for this, and Rails is using it: <code>\"1\".to_s #=&gt; 1</code></li>\n<li>The particular heuristic Ruby uses to convert a string to an integer is to take any number up to a non-numerical character and cast it as an integer. Commas are non-numeric, at least by default, in Ruby.</li>\n</ol>\n\n<p>The solution is to convert the string value in your JSON to an integer using another method. You can do this any of these ways:</p>\n\n<ol>\n<li>Cast the string to an integer before sending it to your ActiveRecord model.</li>\n<li>Alter the string in such a way that the default Ruby casting will cast the string into the expected value. </li>\n<li>Use a custom caster to handle the casting for this particular attribute (inside of ActiveRecord and ActiveModel).</li>\n</ol>\n\n<p>The solution proposed by @Danil follows #2 above, and it has some shortcomings (as @tadman pointed out). </p>\n\n<p>A more robust way of handling this without getting down in the mud is to use a library like <a href=\"https://github.com/clemens/delocalize#what-does-it-do-and-how-do-i-use-it\" rel=\"nofollow noreferrer\">Delocalize</a>, which will automatically handle numeric string parsing and casting with consideration for separators used by the active locale. See <a href=\"https://stackoverflow.com/a/8212795/203130\">this excellent answer by Benoit Garret for more information</a>.</p>\n"}], "owner": {"reputation": 3234, "user_id": 994581, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/5ff79a62688297a354a41d772f20a547?s=128&d=identicon&r=PG", "display_name": "yellowreign", "link": "https://stackoverflow.com/users/994581/yellowreign"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 45949836, "answer_count": 2, "score": 1, "last_activity_date": 1504055593, "creation_date": 1504049506, "question_id": 45949749, "link": "https://stackoverflow.com/questions/45949749/rails-amounts-in-thousands-are-truncated", "title": "Rails Amounts in Thousands Are Truncated", "body": "<p>In my Rails 5 app, I read in a feed for products.  In the JSON, when the price is over $1,000, it the JSON has a comma, like 1,000.</p>\n\n<p>My code seems to be truncating it, so it's storing as 1 instead of 1,000.  </p>\n\n<p>All other fields are storing correctly.  Can someone please tell me what I'm doing wrong?</p>\n\n<p>In this example, the reg_price saves as 2, instead of 2590.</p>\n\n<p>json sample (for reg_price field):</p>\n\n<pre><code>[\n  {\n    \"reg_price\": \"2,590\"\n  }\n]\n</code></pre>\n\n<p>schema</p>\n\n<pre><code>create_table \"products\", force: :cascade do |t|\n  t.decimal  \"reg_price\",                           precision: 10, scale: 2\nend\n</code></pre>\n\n<p>model</p>\n\n<pre><code>response = open_url(url_string).to_s\nproducts = JSON.parse(response)\n\nproducts.each do |product|\n  product = Product.new(\n    reg_price: item['reg_price']\n  )\n  product.save\nend\n</code></pre>\n"}, {"tags": ["ruby", "command-line", "command-prompt", "windows-console"], "comments": [{"owner": {"reputation": 9, "user_id": 8305032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f8e708d32dc5c0ea4b37eb01c3173bc?s=128&d=identicon&r=PG&f=1", "display_name": "coding", "link": "https://stackoverflow.com/users/8305032/coding"}, "reply_to_user": {"reputation": 12117, "user_id": 2745495, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5bbcd267235bab78ec6710ef6654ba87?s=128&d=identicon&r=PG", "display_name": "Gino Mempin", "link": "https://stackoverflow.com/users/2745495/gino-mempin"}, "edited": false, "score": 0, "creation_date": 1504049202, "post_id": 45949613, "comment_id": 78858052, "body": "Where? Please let me know where it is and whether that is causing my problem"}, {"owner": {"reputation": 9, "user_id": 8305032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f8e708d32dc5c0ea4b37eb01c3173bc?s=128&d=identicon&r=PG&f=1", "display_name": "coding", "link": "https://stackoverflow.com/users/8305032/coding"}, "reply_to_user": {"reputation": 12117, "user_id": 2745495, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5bbcd267235bab78ec6710ef6654ba87?s=128&d=identicon&r=PG", "display_name": "Gino Mempin", "link": "https://stackoverflow.com/users/2745495/gino-mempin"}, "edited": false, "score": 0, "creation_date": 1504050728, "post_id": 45949613, "comment_id": 78858437, "body": "Added this at the end and the program did not exit and I was able to see the list:     puts &quot;Press RETURN when you&#39;re done.&quot;     gets"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 3, "creation_date": 1504052478, "post_id": 45949613, "comment_id": 78858907, "body": "This indentation is pure anarchy. If you organized your code better and got things properly indented the mistakes would be far more obvious."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 1, "creation_date": 1504053180, "post_id": 45949613, "comment_id": 78859052, "body": "Are you running this script by double clicking on it in Explorer? If so, it&#39;s creating a new console. When the script exits the console has no attached processes and also exits. If you run the script from CMD, it should inherit CMD&#39;s console instead of creating a new one. Then when the script exits CMD will resume as the console foreground process."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8468401"}, "is_accepted": false, "score": 1, "last_activity_date": 1504066960, "last_edit_date": 1504066960, "creation_date": 1504065894, "answer_id": 45951721, "question_id": 45949613, "link": "https://stackoverflow.com/questions/45949613/ruby-program-exits-after-executing-code-in-command-prompt/45951721#45951721", "title": "Ruby Program Exits After Executing Code in Command Prompt", "body": "<p>I took a look at your code, i recommend when ever you face problems of this kind to run the command ruby -wc file_name.rb , this is what it printed out:</p>\n\n<p><code>list.rb:22: warning: *' after local variable or literal is interpreted as binary operator</code></p>\n\n<p><code>list.rb:22: warning: even though it seems like argument prefix</code></p>\n\n<p><code>list.rb:24: warning: mismatched indentations at 'end' with 'def' at 21</code></p>\n\n<p><code>list.rb:38: warning: mismatched indentations at 'end' with 'def' at 27</code></p>\n\n<p><code>Syntax OK</code></p>\n\n<p>So after fixing the indentations the next thing you have to fix is the method print_separator:\n</p>\n\n<pre><code>def print_separator(character=\"-\")\n     puts character *80\nend\n</code></pre>\n\n<p>Change it to:\n </p>\n\n<pre><code>def print_separator()\n    80.times do |n|\n      print \"-\"\n    end\n    puts\nend\n</code></pre>\n\n<p>Here also is a working version of the same code:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def create_list\n  print \"What is the list name? \"\n  name=gets.chomp\n\n  hash={\"name\"=&gt;name,\"items\"=&gt;Array.new}\n  return hash\nend\n\ndef add_list_item\n  print \"What is the item called? \"\n  item_name=gets.chomp\n\n  print \"How much? \"\n  quantity=gets.chomp.to_i\n\n  hash={\"name\"=&gt;item_name, \"quantity\"=&gt;quantity}\n  return hash\nend\n\n\ndef print_separator()\n    80.times do |n|\n       print \"-\"\n    end\n    puts\nend\n\n\ndef print_list(list)\n  puts \"List: #{list['name']}\"\n  print_separator()\n\n  list[\"items\"].each do |item|\n    puts \"\\tItem: \" + item['name'] + \"\\t\\t\\t\" +\n    \"Quantity: \" + item['quantity'].to_s\n  end\n  print_separator()\nend\n\nlist=create_list()\nlist['items'].push(add_list_item())\nlist['items'].push(add_list_item())\n\nputs \"Here is your list: \\n\"\nprint_list(list)\n</code></pre>\n\n<p>Output:</p>\n\n<p><code>What is the list name? My list</code><br>\n<code>What is the item called? apple</code><br>\n<code>How much? 2</code><br>\n<code>What is the item called? orange</code><br>\n<code>How much? 2</code><br>\n<code>Here is your list:</code><br>\n<code>List: My list</code>\n<code>--------------------------------------------------------------------------------</code><br>\n<code>Item: apple                Quantity: 2</code><br>\n<code>Item: orange           Quantity: 2</code><br>\n<code>--------------------------------------------------------------------------------</code></p>\n"}], "owner": {"reputation": 9, "user_id": 8305032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f8e708d32dc5c0ea4b37eb01c3173bc?s=128&d=identicon&r=PG&f=1", "display_name": "coding", "link": "https://stackoverflow.com/users/8305032/coding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504066960, "creation_date": 1504048436, "last_edit_date": 1504053210, "question_id": 45949613, "link": "https://stackoverflow.com/questions/45949613/ruby-program-exits-after-executing-code-in-command-prompt", "title": "Ruby Program Exits After Executing Code in Command Prompt", "body": "<p>Why does the program quit after being executed in the command line?  </p>\n\n<p>I saved the code below as a .rb file. When I run it, it goes through everything but it will not show me the resulting hash that I want to view. Instead, the program quits.        </p>\n\n<pre><code>    def create_list\n    print \"What is the list name? \"\n    name=gets.chomp\n\n    hash={\"name\"=&gt;name,\"items\"=&gt;Array.new}\n    return hash\n    end\n\n    def add_list_item\n    print \"What is the item called? \"\n    item_name=gets.chomp\n\n    print \"How much? \"\n    quantity=gets.chomp.to_i\n\n    hash={\"name\"=&gt;item_name, \"quantity\"=&gt;quantity}\n    return hash\n    end\n\n\n   def print_separator(character=\"-\")\n    puts character *80\n\n    end\n\n\n   def print_list(list)\n     puts \"List: #{list['name']}\"\n     print_separator()\n\n   list[\"items\"].each do |item|\n   puts \"\\tItem: \" + item['name'] + \"\\t\\t\\t\" +\n   \"Quantity: \" + item['quantity'].to_s\n\n   end\n    print_separator()\n\n    end\n\n   list=create_list()\n   list['items'].push(add_list_item())\n   list['items'].push(add_list_item())\n\n   puts \"Here is your list: \\n\"\n   print_list(list)\n</code></pre>\n"}, {"tags": ["ruby", "rubygems", "gemfile"], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 3, "last_activity_date": 1504047244, "creation_date": 1504047244, "answer_id": 45949436, "question_id": 45949335, "link": "https://stackoverflow.com/questions/45949335/bundle-install-doesnt-install-gem-from-private-git-repo/45949436#45949436", "title": "Bundle install doesn&#39;t install gem from private git repo", "body": "<p>When using Bundler you must engage Bundler in any code you use. That means either:</p>\n\n<pre><code>require 'bundler/setup'\nrequire 'my-awesome-gem'\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>pry -r bundler/setup -r my-awesome-gem\n</code></pre>\n\n<p>The gem is installed, it's just not in your <code>$LOAD_PATH</code> until you get Bundler to load in the <code>Gemfile</code> and find all the dependencies.</p>\n"}], "owner": {"reputation": 2049, "user_id": 2246700, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/63ae5300336319b5b03e0008130b27b6?s=128&d=identicon&r=PG&f=1", "display_name": "narzero", "link": "https://stackoverflow.com/users/2246700/narzero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 451, "favorite_count": 0, "accepted_answer_id": 45949436, "answer_count": 1, "score": 1, "last_activity_date": 1504047244, "creation_date": 1504046672, "question_id": 45949335, "link": "https://stackoverflow.com/questions/45949335/bundle-install-doesnt-install-gem-from-private-git-repo", "title": "Bundle install doesn&#39;t install gem from private git repo", "body": "<p>Something strange is happening, everything used to work fine a few hours ago.</p>\n\n<p>I have a private gem as dependency to a project. I've added the private gem git repo as follows:</p>\n\n<pre><code>gem 'my-awesome-gem', '&gt;=1.2.3', git: 'https://john:pass123@bitbucket.org/johndoe/my-awesome-gem'\n</code></pre>\n\n<p>When doing <code>bundle install</code> it shows:</p>\n\n<pre><code>...\nUsing my-awesome-gem 1.2.3 from https://john:pass123@bitbucket.org/johndoe/my-awesome-gem (at master@bc19e27)\nBundle complete! 5 Gemfile dependencies, 21 gems now installed.\nUse `bundle info [gemname]` to see where a bundled gem is installed.\n</code></pre>\n\n<p>But this gem doesn't show when I do <code>gem list</code>. Also, when I do <code>pry -r my-awesome-gem</code> or require it in the project it returns:</p>\n\n<pre><code>! Unable to load application: LoadError: cannot load such file -- my-awesome-gem\n/Users/johndoe/.rbenv/versions/2.4.1/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require': cannot load such file -- my-awesome-gem (LoadError)\n...\n</code></pre>\n\n<p>I've been playing around for a few hours but can't find the problem. I've tried reinstalling ruby via rbenv. I'm using Ruby 2.4.1 via rbenv.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["ruby", "excel", "column-width", "axlsx"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1504044494, "post_id": 45948367, "comment_id": 78856723, "body": "Autofit is more of an application scaling event than an attribute of a column or row. What you can do is scale the column based on the size (length) of the largest value. Might have to mess around with padding and the like. We have struggled with this in the past and resorted to having the user perform this action rather than trying to handle it in process. Please note that auto scale is also dependent on zoom level in excel eg if you zoom out what used to fit in a cell no longer does because of its dependence on rendered font size inside a cell"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8674852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DoOwA.png?s=128&g=1", "display_name": "siruku6", "link": "https://stackoverflow.com/users/8674852/siruku6"}, "is_accepted": false, "score": 0, "last_activity_date": 1582159999, "creation_date": 1582159999, "answer_id": 60311444, "question_id": 45948367, "link": "https://stackoverflow.com/questions/45948367/ruby-axlsx-true-auto-width-for-columns/60311444#60311444", "title": "Ruby Axlsx true auto-width for columns?", "body": "<p>How about the next cord ?</p>\n\n<pre><code>wb = Axlsx::Package.new.workbook\nwb.use_autowidth = true\nwb.add_worksheet(name: 'sheet_name') do |sheet|\n  ws.add_row [\"this is just a test to see how far it will go because column will not show\", \"test\", \"this is also a testtt\"]\nend\n</code></pre>\n"}], "owner": {"reputation": 509, "user_id": 5020728, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/cb39b5d02ed36476d08de72405b4bf78?s=128&d=identicon&r=PG&f=1", "display_name": "OMGitzMidgar", "link": "https://stackoverflow.com/users/5020728/omgitzmidgar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1219, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1582159999, "creation_date": 1504040958, "question_id": 45948367, "link": "https://stackoverflow.com/questions/45948367/ruby-axlsx-true-auto-width-for-columns", "title": "Ruby Axlsx true auto-width for columns?", "body": "<p>I'm using Axlsx to create an Excel file with one worksheet. I cannot figure out how to get all of the column widths to automatically resize to fit all of the data. Consider the following code where I add rows to a worksheet <code>ws</code>:</p>\n\n<pre><code>  ws.add_row [\"this is just a test to see how far it will go because column will not show\", \"test\", \"this is also a testtt\"]\n  ws.add_row [\"\"]\n</code></pre>\n\n<p>By default, columns seem to use auto-width, but even if not, I tried adding the <code>:widths=&gt;[:auto, :auto, :auto]</code> to my <code>add_row</code> code. It seems like some kind of auto fit is applied to my columns because that first long column is expanding to fit most of the cell. But it does not fit entire cell, just expands enough to fit most but leaves off the last word or two.</p>\n\n<p>Any way to achieve a <em>true</em> autofit functionality?</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1504040234, "post_id": 45948183, "comment_id": 78854955, "body": "What is the expected result? BTW, how come you get a <a href=\"http://rubular.com/r/4OYkXxLQRx\" rel=\"nofollow noreferrer\">match in Rubular</a> if it does not find a match?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1504040275, "post_id": 45948183, "comment_id": 78854979, "body": "&quot;Doesn&#39;t work&quot; means what?"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1504040360, "post_id": 45948183, "comment_id": 78855026, "body": "Ok, I think you want <a href=\"https://ideone.com/4HFF7m\" rel=\"nofollow noreferrer\"><code>longstring[&#47;#(.*)&#47;, 1]</code></a>"}, {"owner": {"reputation": 3, "user_id": 8534704, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WGPcU73YUuA/AAAAAAAAAAI/AAAAAAAAFpc/fHLWrZ69ZFE/photo.jpg?sz=128", "display_name": "Ryan Goldstein", "link": "https://stackoverflow.com/users/8534704/ryan-goldstein"}, "edited": false, "score": 0, "creation_date": 1504040394, "post_id": 45948183, "comment_id": 78855040, "body": "Doesnt work, means what the match is suppose to be &quot;btc&quot;. Is not the output"}, {"owner": {"reputation": 3, "user_id": 8534704, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WGPcU73YUuA/AAAAAAAAAAI/AAAAAAAAFpc/fHLWrZ69ZFE/photo.jpg?sz=128", "display_name": "Ryan Goldstein", "link": "https://stackoverflow.com/users/8534704/ryan-goldstein"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1504040526, "post_id": 45948183, "comment_id": 78855106, "body": "@WiktorStribi\u017cew Thats much closer, but im missing the first charecter &quot;b&quot;"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1504040556, "post_id": 45948183, "comment_id": 78855118, "body": "What else can there be? Please add the actual requirements for the pattern that should match <code>btc</code>."}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1504040573, "post_id": 45948183, "comment_id": 78855128, "body": "<a href=\"https://ideone.com/4HFF7m\" rel=\"nofollow noreferrer\">ideone.com/4HFF7m</a>. No <code>b</code> is missing."}, {"owner": {"reputation": 3, "user_id": 8534704, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WGPcU73YUuA/AAAAAAAAAAI/AAAAAAAAFpc/fHLWrZ69ZFE/photo.jpg?sz=128", "display_name": "Ryan Goldstein", "link": "https://stackoverflow.com/users/8534704/ryan-goldstein"}, "edited": false, "score": 0, "creation_date": 1504041258, "post_id": 45948183, "comment_id": 78855471, "body": "Wiktor you got my bad.  You had it all along!!!"}, {"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1504041261, "post_id": 45948183, "comment_id": 78855472, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/17614666/regex-match-including-new-line\">Regex match including new line</a>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1504052873, "post_id": 45948183, "comment_id": 78858982, "body": "Kindly state your question. As you were asked before, what is your desired result? Please provide that by editing the question."}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 0, "last_activity_date": 1504040375, "creation_date": 1504040375, "answer_id": 45948236, "question_id": 45948183, "link": "https://stackoverflow.com/questions/45948183/parsing-string-with-ruby/45948236#45948236", "title": "Parsing string with Ruby", "body": "<p>Remember things like <code>\\n</code> are not literal backslash-n, but instead a <em>newline</em> character. As such the <code>\\\\</code> in your regular expression is mistaken.</p>\n\n<p>A better matcher is:</p>\n\n<pre><code>longstring[/\\#(\\w+)/]\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8534704, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WGPcU73YUuA/AAAAAAAAAAI/AAAAAAAAFpc/fHLWrZ69ZFE/photo.jpg?sz=128", "display_name": "Ryan Goldstein", "link": "https://stackoverflow.com/users/8534704/ryan-goldstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1504043033, "creation_date": 1504040130, "last_edit_date": 1504043033, "question_id": 45948183, "link": "https://stackoverflow.com/questions/45948183/parsing-string-with-ruby", "title": "Parsing string with Ruby", "body": "<p>I am trying to parse a string with Ruby to get a shorter string.</p>\n\n<p>My string:</p>\n\n<blockquote>\n  <p>\u00f0\u0178\u2019\u017d #btc\\nUp signal on Poloniex\\n+895%, buy vol. incr. by 2.78 BTC\\n+1.66%, price: 0.00000949 BTC\\nSignals: 2/7d\\nMarket Cap: $8,632,464\"}</p>\n</blockquote>\n\n<p>I have tried:</p>\n\n<pre><code>longstring.scan(/\\#(.*?)\\\\\\/)\n\nlongstring[/\\#(.*?)\\\\/,1]\n\nlongstring.slice(/\\#(.*?)\\\\/,1)\n</code></pre>\n\n<p>... where <code>longstring</code> is the variable that holds the orginal string</p>\n\n<p>The regex works in Rubular, but my Ruby script does not seem to work. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "factory-bot"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8534712, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MLmKQQp6fJ0/AAAAAAAAAAI/AAAAAAAAAAo/QAl0fq_7Bzg/photo.jpg?sz=128", "display_name": "Marc Lapierre", "link": "https://stackoverflow.com/users/8534712/marc-lapierre"}, "is_accepted": false, "score": 1, "last_activity_date": 1504040981, "creation_date": 1504040981, "answer_id": 45948374, "question_id": 45948157, "link": "https://stackoverflow.com/questions/45948157/factorygirl-create-list-from-a-previous-create-list/45948374#45948374", "title": "FactoryGirl: create_list from a previous create_list", "body": "<p>This depends on your data model.</p>\n\n<p>Do questions require an answer?</p>\n\n<p>If yes, consider <a href=\"https://github.com/thoughtbot/factory_girl/blob/master/GETTING_STARTED.md#associations\" rel=\"nofollow noreferrer\">FactoryGirl associations</a></p>\n\n<p>If not, create them in your tests if and when you need them as you will likely need to test cases where questions do not have answers.</p>\n"}, {"tags": [], "owner": {"reputation": 6644, "user_id": 1219460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f8e98f29daa5c09c5fd1c2a09f72750?s=128&d=identicon&r=PG", "display_name": "Carlos Ramirez III", "link": "https://stackoverflow.com/users/1219460/carlos-ramirez-iii"}, "is_accepted": false, "score": 1, "last_activity_date": 1504049949, "creation_date": 1504049949, "answer_id": 45949802, "question_id": 45948157, "link": "https://stackoverflow.com/questions/45948157/factorygirl-create-list-from-a-previous-create-list/45949802#45949802", "title": "FactoryGirl: create_list from a previous create_list", "body": "<p>All of the FactoryGirl builder methods support providing a block which is yielded the newly created object. Using this, you can create your records and associations in a single call. </p>\n\n<p>For example,</p>\n\n<pre><code>FactoryGirl.create_list(:question, 5) do |question|\n   question.answers = FactoryGirl.build_list(:answer)\n   # or...\n   # question.answers.create(FactoryGirl.attributes_for(:answer))\nend\n</code></pre>\n\n<p><strong>Resources</strong></p>\n\n<ul>\n<li><a href=\"http://www.rubydoc.info/gems/factory_girl/file/GETTING_STARTED.md#Using_factories\" rel=\"nofollow noreferrer\">FactoryGirl documentation for block support</a></li>\n</ul>\n"}], "owner": {"reputation": 1589, "user_id": 1123717, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fb3d5703694d21ac6573b31d3f3014f0?s=128&d=identicon&r=PG", "display_name": "aarkerio", "link": "https://stackoverflow.com/users/1123717/aarkerio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1504049949, "creation_date": 1504040030, "question_id": 45948157, "link": "https://stackoverflow.com/questions/45948157/factorygirl-create-list-from-a-previous-create-list", "title": "FactoryGirl: create_list from a previous create_list", "body": "<p>I'm pretty new using FG and I'm trying to create several objects from a previous \"create_list\" call. Is this the correct way to do it?  </p>\n\n<pre><code> let(:questions) { FactoryGirl.create_list :question, 5 }\n let(:answers)   { questions.map do |q|\n                     FactoryGirl.create :answer, question: q\n                   end\n                 }\n</code></pre>\n\n<p>Looks smelly to me.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "twilio", "twilio-api"], "comments": [{"owner": {"reputation": 688, "user_id": 7496329, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TT4M7.jpg?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/7496329/andy"}, "edited": false, "score": 0, "creation_date": 1504040949, "post_id": 45948020, "comment_id": 78855312, "body": "I have MacOs Sierra and haven&#39;t installed the Twilio gem before. I did <code>gem list</code> and could see that I had <code>libxml-ruby (2.6.0)</code> installed. I ran <code>sudo gem install twilio-ruby</code> and it installed the Twilio 5.2.0 gem ok. I don&#39;t have a <code>.rvm</code> directory in my home folder. I wonder if you can somehow try removing that version and get back to the &quot;native&quot; one? Sorry this isn&#39;t much help!"}, {"owner": {"reputation": 502, "user_id": 5616578, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/c6f7a92723f0272d8d8311aeebbfe5dd?s=128&d=identicon&r=PG&f=1", "display_name": "James H", "link": "https://stackoverflow.com/users/5616578/james-h"}, "reply_to_user": {"reputation": 688, "user_id": 7496329, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TT4M7.jpg?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/7496329/andy"}, "edited": false, "score": 0, "creation_date": 1504043506, "post_id": 45948020, "comment_id": 78856369, "body": "I wound up installing version 4.11 and everything worked out easy. Thanks. You&#39;re the man"}, {"owner": {"reputation": 53136, "user_id": 28376, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ec1383b240b5ba15ffb9743fceb3c0e?s=128&d=identicon&r=PG", "display_name": "philnash", "link": "https://stackoverflow.com/users/28376/philnash"}, "edited": false, "score": 0, "creation_date": 1504086048, "post_id": 45948020, "comment_id": 78871720, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/38129330/libxml-ruby-failed-to-build-gem-native-extension\">libxml-ruby: Failed to build gem native extension</a>"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 6938405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c2c76e470d581da232b2676e4f59b7b?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Ga", "link": "https://stackoverflow.com/users/6938405/jorge-ga"}, "is_accepted": false, "score": 1, "last_activity_date": 1507677600, "creation_date": 1507677600, "answer_id": 46677412, "question_id": 45948020, "link": "https://stackoverflow.com/questions/45948020/cant-install-twilio-gem-libxml-issue/46677412#46677412", "title": "Can&#39;t install Twilio gem - libxml issue", "body": "<p>I found a solution! (Running on Debian 9)</p>\n\n<pre><code>sudo apt-get install -y libxml2-dev\n\ngem install libxml-ruby -v '3.0.0' \n\nbundle install\n</code></pre>\n\n<p>Seems like a problem with libxml-ruby trying to use libxml2</p>\n"}], "owner": {"reputation": 502, "user_id": 5616578, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/c6f7a92723f0272d8d8311aeebbfe5dd?s=128&d=identicon&r=PG&f=1", "display_name": "James H", "link": "https://stackoverflow.com/users/5616578/james-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 751, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1548674803, "creation_date": 1504039405, "last_edit_date": 1548674803, "question_id": 45948020, "link": "https://stackoverflow.com/questions/45948020/cant-install-twilio-gem-libxml-issue", "title": "Can&#39;t install Twilio gem - libxml issue", "body": "<p>After having hours of trouble trying to install the twill-ruby gem in both a regular script and rails app I've come to the pros.</p>\n\n<p>The error I'm getting is \"In Gemfile:\n  twilio-ruby was resolved to 5.2.0, which depends on\n    libxml-ruby\n\"</p>\n\n<p>I tried installing the libxml gem into my gem file and that fails as well with the error \"Gem::Ext::BuildError: ERROR: Failed to build gem native extension.\" and then at the bottom it says \"An error occurred while installing libxml-ruby (3.0.0), and Bundler cannot continue.\nMake sure that <code>gem install libxml-ruby -v '3.0.0'</code> succeeds before bundling.\"</p>\n\n<p>the rails version I'm using is 4.2.4 and my OS is MACOS Sierra. The entire output when i try to bundle install with the twilio gem is below. Ive read a few articles on Stack but nothing has helped so far :</p>\n\n<pre><code>Gem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\n    current directory: /Users/jameshart/.rvm/gems/ruby-2.3.0/gems/libxml-ruby-3.0.0/ext/libxml\n/Users/jameshart/.rvm/rubies/ruby-2.3.0/bin/ruby -r ./siteconf20170829-79771-thonjl.rb extconf.rb\nchecking for libxml/xmlversion.h in\n/opt/include/libxml2,/opt/local/include/libxml2,/usr/local/include/libxml2,/usr/include/libxml2... no\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/Users/jameshart/.rvm/rubies/ruby-2.3.0/bin/$(RUBY_BASE_NAME)\n    --with-xml2-config\n    --without-xml2-config\n    --with-xml2-dir\n    --without-xml2-dir\n    --with-xml2-include\n    --without-xml2-include=${xml2-dir}/include\n    --with-xml2-lib\n    --without-xml2-lib=${xml2-dir}/lib\n extconf failure: need libxml2.\n\n    Install the library or try one of the following options to extconf.rb:\n\n      --with-xml2-config=/path/to/xml2-config\n      --with-xml2-dir=/path/to/libxml2\n      --with-xml2-lib=/path/to/libxml2/lib\n      --with-xml2-include=/path/to/libxml2/include\n\n\nTo see why this extension failed to compile, please check the mkmf.log which can be found here:\n\n  /Users/jameshart/.rvm/gems/ruby-2.3.0/extensions/x86_64-darwin-16/2.3.0/libxml-ruby-3.0.0/mkmf.log\n\nextconf failed, exit code 1\n\nGem files will remain installed in /Users/jameshart/.rvm/gems/ruby-2.3.0/gems/libxml-ruby-3.0.0 for inspection.\nResults logged to /Users/jameshart/.rvm/gems/ruby-2.3.0/extensions/x86_64-darwin-16/2.3.0/libxml-ruby-3.0.0/gem_make.out\n\nAn error occurred while installing libxml-ruby (3.0.0), and Bundler cannot continue.\nMake sure that `gem install libxml-ruby -v '3.0.0'` succeeds before bundling.\n\nIn Gemfile:\n  twilio-ruby was resolved to 5.2.0, which depends on\n    libxml-ruby\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 2, "creation_date": 1504037671, "post_id": 45947285, "comment_id": 78853715, "body": "With <code>includes</code>, <code>joins</code> and <code>references</code> you need to use the relation name as defined in your model. With <code>where</code> you need to use the exact table name. So if your model <code>TestStructure</code> store data in the table <code>custom_named_table</code>, you need to do <code>Measurement.joins(:examination).where(custom_named_table: { year: 2016, month: 5 })</code> (you can find the table name using <code>TestStructure.table_name</code>) (see my previous answers on that subject: <a href=\"https://stackoverflow.com/questions/24266069/join-multiple-tables-with-active-records/24266583#24266583\" title=\"join multiple tables with active records\">stackoverflow.com/questions/24266069/&hellip;</a>)"}], "answers": [{"comments": [{"owner": {"reputation": 1186, "user_id": 1296980, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/RPwOZ.jpg?s=128&g=1", "display_name": "Sebastialonso", "link": "https://stackoverflow.com/users/1296980/sebastialonso"}, "edited": false, "score": 0, "creation_date": 1504037297, "post_id": 45947483, "comment_id": 78853518, "body": "Please correct me if I&#39;m wrong, does eager_load actually retrieves records into memory? I&#39;m aiming to not do that, thus the join."}, {"owner": {"reputation": 42085, "user_id": 3444240, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/OjOru.jpg?s=128&g=1", "display_name": "potashin", "link": "https://stackoverflow.com/users/3444240/potashin"}, "reply_to_user": {"reputation": 1186, "user_id": 1296980, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/RPwOZ.jpg?s=128&g=1", "display_name": "Sebastialonso", "link": "https://stackoverflow.com/users/1296980/sebastialonso"}, "edited": false, "score": 1, "creation_date": 1504037507, "post_id": 45947483, "comment_id": 78853620, "body": "@Sebastialonso: according to the activerecord docs I am wrong and you can use <code>joins</code>, but the table name caveat is crucial."}], "tags": [], "owner": {"reputation": 42085, "user_id": 3444240, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/OjOru.jpg?s=128&g=1", "display_name": "potashin", "link": "https://stackoverflow.com/users/3444240/potashin"}, "is_accepted": false, "score": 1, "last_activity_date": 1504037436, "last_edit_date": 1504037436, "creation_date": 1504036989, "answer_id": 45947483, "question_id": 45947285, "link": "https://stackoverflow.com/questions/45947285/rails-using-join-with-custom-named-associations/45947483#45947483", "title": "Rails - Using join with custom-named associations", "body": "<p>In this example table name <code>examinations</code> should be provided instead of an association name <code>examination</code> in the <code>where</code> method.</p>\n\n<pre><code>Measurement.jons(:examination).where(examinations: { year: 2016, month: 5 })\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27630, "user_id": 1550807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JgCw5.png?s=128&g=1", "display_name": "Danil Speransky", "link": "https://stackoverflow.com/users/1550807/danil-speransky"}, "reply_to_user": {"reputation": 1186, "user_id": 1296980, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/RPwOZ.jpg?s=128&g=1", "display_name": "Sebastialonso", "link": "https://stackoverflow.com/users/1296980/sebastialonso"}, "edited": false, "score": 0, "creation_date": 1504037531, "post_id": 45947514, "comment_id": 78853631, "body": "@Sebastialonso should be only one"}, {"owner": {"reputation": 27630, "user_id": 1550807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JgCw5.png?s=128&g=1", "display_name": "Danil Speransky", "link": "https://stackoverflow.com/users/1550807/danil-speransky"}, "reply_to_user": {"reputation": 1186, "user_id": 1296980, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/RPwOZ.jpg?s=128&g=1", "display_name": "Sebastialonso", "link": "https://stackoverflow.com/users/1296980/sebastialonso"}, "edited": false, "score": 3, "creation_date": 1504037705, "post_id": 45947514, "comment_id": 78853728, "body": "@Sebastialonso you&#39;ve picked not the best solution: then you depend on table name instead of depending on model which should abstract things"}, {"owner": {"reputation": 1186, "user_id": 1296980, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/RPwOZ.jpg?s=128&g=1", "display_name": "Sebastialonso", "link": "https://stackoverflow.com/users/1296980/sebastialonso"}, "edited": false, "score": 0, "creation_date": 1504042040, "post_id": 45947514, "comment_id": 78855820, "body": "you are correct. Let me try your method, hopefully it won&#39;t perform more than one query, and I&#39;ll get back to you."}, {"owner": {"reputation": 27630, "user_id": 1550807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JgCw5.png?s=128&g=1", "display_name": "Danil Speransky", "link": "https://stackoverflow.com/users/1550807/danil-speransky"}, "reply_to_user": {"reputation": 1186, "user_id": 1296980, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/RPwOZ.jpg?s=128&g=1", "display_name": "Sebastialonso", "link": "https://stackoverflow.com/users/1296980/sebastialonso"}, "edited": false, "score": 0, "creation_date": 1504045129, "post_id": 45947514, "comment_id": 78856933, "body": "@Sebastialonso I&#39;ve tested it, worked for me, only one query with inner join"}, {"owner": {"reputation": 9327, "user_id": 814576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/BeB1v.jpg?s=128&g=1", "display_name": "ecbrodie", "link": "https://stackoverflow.com/users/814576/ecbrodie"}, "edited": false, "score": 0, "creation_date": 1544652643, "post_id": 45947514, "comment_id": 94357064, "body": "I will call out that using <code>.merge()</code> along with <code>.joins()</code> has been a huge lifesaver for me on the Rails project I work on for a living. We have Rails Engines, so each of the DB table names for our ActiveRecord models have the engine name as a prefix. This causes complexity with using an association&#39;s name in a <code>where()</code> call, I would have to use the DB table&#39;s name as a Hash key instead.  The combination of <code>.joins()</code> and <code>merge()</code> has made ActiveRecord querying a much more pleasurable experience for this project."}], "tags": [], "owner": {"reputation": 27630, "user_id": 1550807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JgCw5.png?s=128&g=1", "display_name": "Danil Speransky", "link": "https://stackoverflow.com/users/1550807/danil-speransky"}, "is_accepted": true, "score": 9, "last_activity_date": 1603970026, "last_edit_date": 1603970026, "creation_date": 1504037110, "answer_id": 45947514, "question_id": 45947285, "link": "https://stackoverflow.com/questions/45947285/rails-using-join-with-custom-named-associations/45947514#45947514", "title": "Rails - Using join with custom-named associations", "body": "<p><code>where</code> expects the actual table name, it just inserts it in SQL:</p>\n<pre><code>Article.where(whatever: {you: 'want'}).to_sql\n=&gt; &quot;SELECT `articles`.* FROM `articles` WHERE `whatever`.`you` = 'want'&quot;\n</code></pre>\n<p>So you may use:</p>\n<pre><code>Measurement.joins(:examination).where(test_structures: { year: 2016, month: 5 })\n</code></pre>\n<p><strong>But it's not good</strong></p>\n<p>Then you depend on table name while Model should abstract such things. You could use <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/SpawnMethods.html#method-i-merge\" rel=\"nofollow noreferrer\"><code>merge</code></a>:</p>\n<pre><code>Measurement.joins(:examination).merge(TestStructure.where(year: 2016, month: 5))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "is_accepted": false, "score": 5, "last_activity_date": 1504037416, "creation_date": 1504037416, "answer_id": 45947609, "question_id": 45947285, "link": "https://stackoverflow.com/questions/45947285/rails-using-join-with-custom-named-associations/45947609#45947609", "title": "Rails - Using join with custom-named associations", "body": "<p>For joins you use the association name, but for where you need to use the table name</p>\n\n<pre><code>Measurement.joins(:examination).where(test_structures: { year: 2016, month: 5 })\n</code></pre>\n\n<p>or </p>\n\n<pre><code>Measurement.joins(:examination).where('test_structures.year': 2016, 'test_structures.month': 5 )\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13726935, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14Ghw--WuFPtV3SQZ_F_LQXnKNKTdAqbH35CnA_mC=k-s128", "display_name": "Gourav Sen", "link": "https://stackoverflow.com/users/13726935/gourav-sen"}, "is_accepted": false, "score": 0, "last_activity_date": 1591870945, "creation_date": 1591870945, "answer_id": 62322162, "question_id": 45947285, "link": "https://stackoverflow.com/questions/45947285/rails-using-join-with-custom-named-associations/62322162#62322162", "title": "Rails - Using join with custom-named associations", "body": "<p>In somecase you need to add <code>.references(associations)</code></p>\n\n<pre><code>Measurement.joins(:examination).merge(TestStructure.where(year: 2016, month: 5)).references(:examination)\n</code></pre>\n"}], "owner": {"reputation": 1186, "user_id": 1296980, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/RPwOZ.jpg?s=128&g=1", "display_name": "Sebastialonso", "link": "https://stackoverflow.com/users/1296980/sebastialonso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2982, "favorite_count": 0, "accepted_answer_id": 45947514, "answer_count": 4, "score": 5, "last_activity_date": 1603970026, "creation_date": 1504036192, "last_edit_date": 1504037568, "question_id": 45947285, "link": "https://stackoverflow.com/questions/45947285/rails-using-join-with-custom-named-associations", "title": "Rails - Using join with custom-named associations", "body": "<p>I have the following model</p>\n\n<pre><code>class Measurement &lt; ApplicationRecord\n  belongs_to :examination, class_name: \"TestStructure\", foreign_key: \"examination_id\"\n\nend\n</code></pre>\n\n<p>The association is actually made to the TestStructure model, but the association name is examination. <strong>There is no examination table.</strong></p>\n\n<p>The problem arises when I'm querying using <code>join</code>. The following query</p>\n\n<pre><code>Measurement.joins(:examination).where(examination: { year: 2016, month: 5 })\n</code></pre>\n\n<p>fails, with this error</p>\n\n<pre><code>ActiveRecord::StatementInvalid:\n   PG::UndefinedTable: ERROR:  missing FROM-clause entry for table \"examination\"\n   LINE 1: ...d\" = \"measurements\".\"examination_id\" WHERE \"examinati...\n# --- Caused by: ---\n # PG::UndefinedTable:\n #   ERROR:  missing FROM-clause entry for table \"examination\"\n #   LINE 1: ...d\" = \"measurements\".\"examination_id\" WHERE \"examinati...\n</code></pre>\n\n<p>So clearly, the <code>examinations</code> table doesn't exists, but I can't find a way to tell ActiveRecord I'm using a named association instead of the default one.</p>\n\n<p>Any insights?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 2, "creation_date": 1504036175, "post_id": 45947261, "comment_id": 78852906, "body": "This is not a good thing to do in production code."}, {"owner": {"reputation": 1400, "user_id": 5074646, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/542207446/picture?type=large", "display_name": "Sebastian Jennings Almnes", "link": "https://stackoverflow.com/users/5074646/sebastian-jennings-almnes"}, "reply_to_user": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1504036208, "post_id": 45947261, "comment_id": 78852924, "body": "Fully aware @MarkThomas! This is for learning, not for production"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1504051204, "post_id": 45947261, "comment_id": 78858569, "body": "I get that you&#39;re trying to learn, but at the same time, this is like learning how to stab knives into your eyes. It&#39;s not a very useful skill. What would be better is learning how to wrap code like this into a <code>module</code> you can load in on demand, do metaprogramming in Ruby properly."}], "answers": [{"tags": [], "owner": {"reputation": 866, "user_id": 5099203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d6c8099202af6d851ad86840a74483?s=128&d=identicon&r=PG&f=1", "display_name": "Zachary Espiritu", "link": "https://stackoverflow.com/users/5099203/zachary-espiritu"}, "is_accepted": false, "score": 0, "last_activity_date": 1504036654, "creation_date": 1504036654, "answer_id": 45947394, "question_id": 45947261, "link": "https://stackoverflow.com/questions/45947261/run-eval-isolated-when-taking-a-string-from-the-db/45947394#45947394", "title": "run eval isolated when taking a string from the DB", "body": "<p>Instead of <code>eval(snip.code_block</code>, you should try:</p>\n\n<pre><code>snip.instance_eval(code_block)\n</code></pre>\n\n<p>Hopefully that will work out of the box, but if it doesn't you may have to experiment with <a href=\"https://apidock.com/ruby/Module/define_method\" rel=\"nofollow noreferrer\"><code>define_method</code></a>.</p>\n\n<p>The reason why your code snippet doesn't work well with <code>eval</code> is that 1) Ruby doesn't support nested methods, and 2) you're trying to call an instance method from a class method. On the other hand, if your code looked like:</p>\n\n<pre><code>def self.is_ten?(number)\n...\n</code></pre>\n\n<p>You might have better luck, but you'll still probably run into the first issue.</p>\n\n<p>And as <a href=\"https://stackoverflow.com/users/182590/mark-thomas\">@Mark Thomas</a> observed, this is a very bad idea for production code (or, really, any code in general). Even if it's not intended for production use, chances are that <a href=\"https://meta.stackexchange.com/a/66378/369007\">whatever problem you're trying to looking to solve with this question isn't actually the <em>real</em> problem you're looking to solve.</a></p>\n"}], "owner": {"reputation": 1400, "user_id": 5074646, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/542207446/picture?type=large", "display_name": "Sebastian Jennings Almnes", "link": "https://stackoverflow.com/users/5074646/sebastian-jennings-almnes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504036654, "creation_date": 1504036080, "question_id": 45947261, "link": "https://stackoverflow.com/questions/45947261/run-eval-isolated-when-taking-a-string-from-the-db", "title": "run eval isolated when taking a string from the DB", "body": "<p>So I'm storing this code in my DB:</p>\n\n<pre><code>def is_ten?(number)\n  number == 10 \nend\n\nis_ten?(10)\n</code></pre>\n\n<p>now I reference this from a class method that belongs to the model that stores it.</p>\n\n<pre><code>class Snippet &lt; ApplicationRecord\n  def self.run_blocks\n    where(active: true).each do |snip|\n     eval(snip.code_block)\n    end\n  end\nend\n</code></pre>\n\n<p>this returns:</p>\n\n<pre><code>NoMethodError Exception: undefined method `is_ten?' for #&lt;Class:0x007fd11ba2bec8&gt;\n</code></pre>\n\n<p>however if I do this in console, it works perfectly. Anybody have an idea on how to deal with this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "twitter-bootstrap", "syntax", "erb"], "answers": [{"tags": [], "owner": {"reputation": 560, "user_id": 7721999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/bRWQu.jpg?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/7721999/andy"}, "is_accepted": false, "score": 0, "last_activity_date": 1504038184, "creation_date": 1504038184, "answer_id": 45947767, "question_id": 45947231, "link": "https://stackoverflow.com/questions/45947231/inputing-rails-erb-syntax-into-bootstrap-4-form/45947767#45947767", "title": "inputing rails erb syntax into bootstrap 4 form", "body": "<p>the ERB <code>&lt;%= form_tag %&gt;</code> , <code>&lt;%= label_tag %&gt;</code> , etc. are helpers to create the HTML <code>&lt;form&gt;</code> and <code>&lt;label&gt;</code> tags (hence the ERB name)</p>\n\n<p>Changing your Boostrap form into ERB is as simple as copying over the div's and classes/ids</p>\n\n<pre><code>&lt;%= form_tag users_sessions_path do %&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= label_tag :email %&gt;\n    &lt;%= text_field_tag :email,  class: 'form-control', \n                                id: 'exampleInputEmail1', \n                                aria-describedby: 'emailHelp',\n                                placeholder: 'Email' %&gt;\n  &lt;/div&gt;\n\n&lt;!-- Continue with the rest of your code --&gt;\n\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1167, "user_id": 387529, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/520bb4ce077d7e08437a7225c894e680?s=128&d=identicon&r=PG", "display_name": "ArashM", "link": "https://stackoverflow.com/users/387529/arashm"}, "is_accepted": true, "score": 1, "last_activity_date": 1504038333, "creation_date": 1504038333, "answer_id": 45947792, "question_id": 45947231, "link": "https://stackoverflow.com/questions/45947231/inputing-rails-erb-syntax-into-bootstrap-4-form/45947792#45947792", "title": "inputing rails erb syntax into bootstrap 4 form", "body": "<p>Here you go. You should really consult with <a href=\"http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html\" rel=\"nofollow noreferrer\">RoR api documents</a>.</p>\n\n<pre><code>&lt;%= form_tag users_sessions_path do %&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= label_tag :email, 'Email address' %&gt;\n    &lt;%= text_field_tag :email, nil, class: 'form-control', id: 'exampleInputEmail1', placeholder: 'Email' %&gt;\n    &lt;small id=\"emailHelp\" class=\"form-text text-muted\"&gt;We'll never share your email with anyone else.&lt;/small&gt;\n  &lt;/div&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= label_tag :password %&gt;\n    &lt;%= password_field_tag :password, nil, class: 'form-control', id: 'exampleInputPassword1', placeholder: 'Password' %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"form-check\"&gt;\n    &lt;label class=\"form-check-label\"&gt;\n      &lt;%= check_box_tag :remember_me, true, false, class: 'form-check-input' %&gt;\n      Check me out\n    &lt;/label&gt;\n  &lt;%= submit_tag 'Submit' %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 8293130, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10154952247190805/picture?type=large", "display_name": "Matthew Lombana", "link": "https://stackoverflow.com/users/8293130/matthew-lombana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1261, "favorite_count": 0, "accepted_answer_id": 45947792, "answer_count": 2, "score": 1, "last_activity_date": 1504038333, "creation_date": 1504035965, "question_id": 45947231, "link": "https://stackoverflow.com/questions/45947231/inputing-rails-erb-syntax-into-bootstrap-4-form", "title": "inputing rails erb syntax into bootstrap 4 form", "body": "<p>I am trying to implement this rails generated form into a bootstrap form I have found and can't figure out the proper syntax to get it to look/work right.</p>\n\n<p>this is the rails erb syntax</p>\n\n<pre><code>    &lt;%= form_tag users_sessions_path do %&gt;\n\n            &lt;%= label_tag :email %&gt;\n            &lt;%= text_field_tag :email %&gt;\n        &lt;p&gt;\n            &lt;%= label_tag :password %&gt;\n            &lt;%= password_field_tag :password %&gt;\n        &lt;/p&gt;\n\n        &lt;p&gt;\n            &lt;%= submit_tag 'Log In' %&gt;\n        &lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>and this is the bootstrap form</p>\n\n<pre><code> &lt;form&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;label for=\"exampleInputEmail1\"&gt;Email address&lt;/label&gt;\n    &lt;input type=\"email\" class=\"form-control\" id=\"exampleInputEmail1\" aria-describedby=\"emailHelp\" placeholder=\"Email\"&gt;\n    &lt;small id=\"emailHelp\" class=\"form-text text-muted\"&gt;We'll never share your email with anyone else.&lt;/small&gt;\n  &lt;/div&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;label for=\"exampleInputPassword1\"&gt;Password&lt;/label&gt;\n    &lt;input type=\"password\" class=\"form-control\" id=\"exampleInputPassword1\" placeholder=\"Password\"&gt;\n  &lt;/div&gt;\n  &lt;div class=\"form-check\"&gt;\n    &lt;label class=\"form-check-label\"&gt;\n      &lt;input type=\"checkbox\" class=\"form-check-input\"&gt;\n      Check me out\n    &lt;/label&gt;\n  &lt;/div&gt;\n  &lt;button type=\"submit\" class=\"btn btn-primary\"&gt;Submit&lt;/button&gt;\n&lt;/form&gt;\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1504035851, "post_id": 45947126, "comment_id": 78852738, "body": "Your &quot;first attempt&quot; doesn&#39;t seem to contain the <code>file_names.each</code> loop. Besides, where are you <code>return</code>ing from, a method? How do you call it? And do both attempts yield the same results?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1504036059, "post_id": 45947126, "comment_id": 78852843, "body": "<code>grep</code> might be faster when working on multiple files, but the overhead of <code>system</code> is considerable when used in a loop."}, {"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1504036308, "post_id": 45947126, "comment_id": 78852973, "body": "Try using backticks to capture grep output from all files (e.g. put them in one command, not in a ruby loop)"}, {"owner": {"reputation": 1635, "user_id": 3017954, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/eb24756b6ef26baee8ae161006099cc7?s=128&d=identicon&r=PG&f=1", "display_name": "CodeSmith", "link": "https://stackoverflow.com/users/3017954/codesmith"}, "edited": false, "score": 0, "creation_date": 1504037103, "post_id": 45947126, "comment_id": 78853413, "body": "Stefen, good catch.  I updated the code snippet. Both attempts do produce the same results (which is an array of file names that have DateTime inside them).  I tried to hide all the &quot;other code&quot; to keep the question simple."}], "answers": [{"comments": [{"owner": {"reputation": 1635, "user_id": 3017954, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/eb24756b6ef26baee8ae161006099cc7?s=128&d=identicon&r=PG&f=1", "display_name": "CodeSmith", "link": "https://stackoverflow.com/users/3017954/codesmith"}, "edited": false, "score": 0, "creation_date": 1504037227, "post_id": 45947308, "comment_id": 78853483, "body": "Thank you for the great explanation."}], "tags": [], "owner": {"reputation": 3894, "user_id": 1121568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13eedc2642303b1a2251a4da7f157e?s=128&d=identicon&r=PG", "display_name": "Steven Schobert", "link": "https://stackoverflow.com/users/1121568/steven-schobert"}, "is_accepted": true, "score": 6, "last_activity_date": 1504036311, "creation_date": 1504036311, "answer_id": 45947308, "question_id": 45947126, "link": "https://stackoverflow.com/questions/45947126/why-is-calling-system-grep-slower-than-matching-in-ruby/45947308#45947308", "title": "Why is calling system grep slower than matching in Ruby?", "body": "<blockquote>\n  <p>Is calling out to the system the slow partor is grep slower than the internal ruby code?</p>\n</blockquote>\n\n<p>In your case, calling out to the system is slower. Particularly because of how you are <strong>creating a new OS process for every single file</strong>.</p>\n\n<p>This means Ruby is having to ask the OS to create 1100 new sub-processes <strong>(one at a time)</strong>, and monitor those subprocesses for termination.</p>\n\n<p>Since all the file IO in ruby is written in C under the hood (in mruby at least), it's going to be faster for your ruby script (which is already running it's own OS process and has allocated system memory), to open up files and search through them itself, rather than create 1100 sub-processes.</p>\n"}], "owner": {"reputation": 1635, "user_id": 3017954, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/eb24756b6ef26baee8ae161006099cc7?s=128&d=identicon&r=PG&f=1", "display_name": "CodeSmith", "link": "https://stackoverflow.com/users/3017954/codesmith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 45947308, "answer_count": 1, "score": 0, "last_activity_date": 1504036785, "creation_date": 1504035561, "last_edit_date": 1504036785, "question_id": 45947126, "link": "https://stackoverflow.com/questions/45947126/why-is-calling-system-grep-slower-than-matching-in-ruby", "title": "Why is calling system grep slower than matching in Ruby?", "body": "<p>I'm writing some code that loops through all the .rb files in a project and looks if they reference the <code>DateTime</code> class.  My first attempt looked like this:</p>\n\n\n\n<pre class=\"lang-rb prettyprint-override\"><code>file_names.each do |file_name|\n  File.foreach(file_name) do |line|\n    return file_name if line.match(/DateTime/)\n  end\nend\n</code></pre>\n\n<p>Benchmark results for the algorithm show that it takes about <strong>0.6 seconds to run</strong> through 1100 files, 25 times each. Not bad, but I had the thought that calling out to the system's <code>grep</code> command might be faster. My second attempt looks like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>file_names.each do |file_name|\n  return file_name if system(\"grep DateTime #{file_name} &gt; /dev/null\")\nend\n</code></pre>\n\n<p>This takes <strong>35.6 seconds</strong> to run! Does anyone have any insight into why the second attempt performs so poorly? Is calling the system the slow part or is grep slower than the internal ruby code?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1504031836, "post_id": 45946038, "comment_id": 78850700, "body": "You are trying to compare the <code>@result</code> (which is an ActiveRecord::Relation object) to a string <code>&quot;Test project&quot;</code>. You either need to call <code>@result.first.name</code> and compare it to the string or find manually the Project record and compare it to <code>@result.first</code>"}], "answers": [{"comments": [{"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 1, "creation_date": 1504031877, "post_id": 45946119, "comment_id": 78850722, "body": "<code>Project.search</code> returns an <code>ActiveRecord::Relation</code>, not a <code>Project</code> instance."}, {"owner": {"reputation": 339, "user_id": 5942515, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/L0DI3.jpg?s=128&g=1", "display_name": "Dotol", "link": "https://stackoverflow.com/users/5942515/dotol"}, "edited": false, "score": 0, "creation_date": 1504033601, "post_id": 45946119, "comment_id": 78851634, "body": "Beautiful, thanks I was wondering why  it was returning ActiveRecord and also appreciate your input on searching for a part of the name to actually test its full functionality!"}], "tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": true, "score": 1, "last_activity_date": 1504031938, "last_edit_date": 1504031938, "creation_date": 1504031728, "answer_id": 45946119, "question_id": 45946038, "link": "https://stackoverflow.com/questions/45946038/rspec-testing-a-search-method/45946119#45946119", "title": "Rspec testing a search method", "body": "<p>You might need to search by <code>Test project</code> and expect <code>project</code>, but not vice-versa. But even better, to search by something LIKE <code>Test project</code>, for example <code>roject</code>:</p>\n\n<pre><code>require 'rails_helper'\n\nRSpec.describe Project, type: :model do\n  it \"finds a searched project by name\" do\n    FakeStubRequests.load\n    project = create(:project, name: \"Test project\", database_url: \"https://fake-database.firebaseio.com/\", secret_key: \"FakeSecretKey\")\n    @result = Project.search(search: \"roject\")\n    expect(@result).to eq([project])\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 339, "user_id": 5942515, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/L0DI3.jpg?s=128&g=1", "display_name": "Dotol", "link": "https://stackoverflow.com/users/5942515/dotol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1775, "favorite_count": 0, "accepted_answer_id": 45946119, "answer_count": 1, "score": 1, "last_activity_date": 1504031938, "creation_date": 1504031432, "last_edit_date": 1504031918, "question_id": 45946038, "link": "https://stackoverflow.com/questions/45946038/rspec-testing-a-search-method", "title": "Rspec testing a search method", "body": "<p>Very new to TDD an I'm trying to test a search method with Rspec but I keep getting  </p>\n\n<pre><code>expected: \"Test project\"\n            got: #&lt;ActiveRecord::Relation []&gt;\n</code></pre>\n\n<h3>projects_controller.rb</h3>\n\n<pre><code>def index                                      \n  @projects = Project.search(params) \nend \n</code></pre>\n\n<h3>project.rb</h3>\n\n<pre><code>def self.search(params = {})\n  return find_name(params[:search]) if params[:search].present?\n\n  all\nend\n\nscope :find_name, -&gt;(search) { where(\"name ILIKE :search\", search: \"%#{search}%\") }\n</code></pre>\n\n<h3>projects_spec.rb</h3>\n\n<pre><code>require 'rails_helper'\nRSpec.describe Project, type: :model do\nit \"finds a searched project by name\" do\n    FakeStubRequests.load\n    project = create(:project, name: \"Test project\", database_url: \"https://fake-database.firebaseio.com/\", secret_key: \"FakeSecretKey\")\n    @result = Project.search(search: project)\n    expect(@result).to eq(\"Test project\")\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "sinatra", "dashing"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1504031335, "post_id": 45945810, "comment_id": 78850411, "body": "Maybe it&#39;s because routes cascade, e.g. if you have a <code>get &#39;&#47;:id&#39;</code> before the <code>get &#39;&#47;sample&#39;</code> route, the second will never get hit, because it is caught in the <code>:id</code> wildcard. So you could try changing the order or the routes, or the order they are run in config.ru. Anyway, you should show your code in the question, it&#39;s not enough info to help you much now."}, {"owner": {"reputation": 45, "user_id": 8302861, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d24b0259ed085997cd8d0c7a11552a36?s=128&d=identicon&r=PG&f=1", "display_name": "testing_josh", "link": "https://stackoverflow.com/users/8302861/testing-josh"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1504034752, "post_id": 45945810, "comment_id": 78852227, "body": "I added the code to my original post. I don&#39;t think that is my issue because I&#39;m making a fixed route &#39;/callback&#39; and now something with a parameter."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1504035203, "post_id": 45945810, "comment_id": 78852458, "body": "did you try changing the order of the <code>run</code> calls in config.ru? Or changing the name of the route you&#39;re adding? Beyond that, I don&#39;t know."}, {"owner": {"reputation": 45, "user_id": 8302861, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d24b0259ed085997cd8d0c7a11552a36?s=128&d=identicon&r=PG&f=1", "display_name": "testing_josh", "link": "https://stackoverflow.com/users/8302861/testing-josh"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1504035540, "post_id": 45945810, "comment_id": 78852604, "body": "I changed the route name to something obscure (so that the mount for sure doesn&#39;t use it). It looks like whichever run command I put last is the one that takes effect. The route works if <code>run App</code> is last, the dashboard works if run <code>Sinatra::Application</code> is last. But when one works, the other doesn&#39;t."}], "answers": [{"tags": [], "owner": {"reputation": 3259, "user_id": 2424975, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/jDtKZ.jpg?s=128&g=1", "display_name": "Cereal", "link": "https://stackoverflow.com/users/2424975/cereal"}, "is_accepted": false, "score": 0, "last_activity_date": 1504637778, "creation_date": 1504637778, "answer_id": 46061619, "question_id": 45945810, "link": "https://stackoverflow.com/questions/45945810/add-route-to-dashing-sinatra-application/46061619#46061619", "title": "Add route to dashing sinatra application?", "body": "<p>You can run different apps inside your config.ru.</p>\n\n<p>Inside your config.ru, replace </p>\n\n<pre><code>map Sinatra::Application.assets_prefix do\n  run Sinatra::Application.sprockets\nend\n\nrun Sinatra::Application\nrun App\n</code></pre>\n\n<p>with</p>\n\n<pre><code>map('/') { run App }\nmap('/sample') { run Sinatra::Application }\nmap(Sinatra::Application.assets_prefix) { run Sinatra::Application.sprockets }\n</code></pre>\n\n<p>It's important to note that by doing this, rack is going to be handling the route prefixes. So if you navigated to <code>/sample</code>, The sinatra app run under that route will see that as <code>/</code>.</p>\n\n<p>config.ru is actually run in a Rack::Builder context. So the above is equivalent to</p>\n\n<pre><code>apps = Rack::Builder.new do \n     map('/') { run App }\n     map('/sample') { run Sinatra::Application }\n     map(Sinatra::Application.assets_prefix) { run Sinatra::Application.sprockets }\nend\nrun apps\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 8302861, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d24b0259ed085997cd8d0c7a11552a36?s=128&d=identicon&r=PG&f=1", "display_name": "testing_josh", "link": "https://stackoverflow.com/users/8302861/testing-josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 362, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504637778, "creation_date": 1504030482, "last_edit_date": 1504035559, "question_id": 45945810, "link": "https://stackoverflow.com/questions/45945810/add-route-to-dashing-sinatra-application", "title": "Add route to dashing sinatra application?", "body": "<p>I'm trying to add a route to my dashing application that will receive data from a webhook.</p>\n\n<p>I tried using the solution <a href=\"https://stackoverflow.com/questions/36877633/add-routes-to-dashing-dashboard\">here</a>, and while that did create the route, it broke the dashing dashboard at '/sample'.</p>\n\n<p>Any ideas?</p>\n\n<p>Here is my lib/app.rb:</p>\n\n<pre><code>require 'sinatra/base'\n\nclass App &lt; Sinatra::Base\n\n  get '/callback' do\n    \"Callback route.\"\n  end\n\nend\n</code></pre>\n\n<p>Here is my config.ru:</p>\n\n<pre><code>require 'dashing'\n\nconfigure do\n  set :auth_token, 'YOUR_AUTH_TOKEN'\n\n  helpers do\n    def protected!\n      # Put any authentication code you want in here.\n      # This method is run before accessing any resource.\n    end\n  end\nend\n\nmap Sinatra::Application.assets_prefix do\n  run Sinatra::Application.sprockets\nend\n\nrun Sinatra::Application\nrun App\n</code></pre>\n\n<p>UPDATE:<br>\nI changed the route name to something obscure (so that the mount for sure doesn't use it). It looks like whichever run command I put last is the one that takes effect. The route works if run App is last, the dashboard works if run Sinatra::Application is last. But when one works, the other doesn't</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 8387879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/721c42f4aa3265608eba49d08950c933?s=128&d=identicon&r=PG&f=1", "display_name": "Sebasti&#225;n Echeverr&#237;a", "link": "https://stackoverflow.com/users/8387879/sebasti%c3%a1n-echeverr%c3%ada"}, "edited": false, "score": 0, "creation_date": 1504031601, "post_id": 45945898, "comment_id": 78850563, "body": "This solved it, you were right. Had to delete gemfile.lock then bundle. Thanks a lot !."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 1, "last_activity_date": 1504031357, "last_edit_date": 1504031357, "creation_date": 1504030878, "answer_id": 45945898, "question_id": 45945742, "link": "https://stackoverflow.com/questions/45945742/method-missing-error-when-running-rails-server/45945898#45945898", "title": "Method_missing error when running &quot;rails server&quot;", "body": "<p>Check in which Rails version you started your application. If by any chance you changed it, upgrading or downgrading it, then, just to be sure, try removing the Gemfile.lock file, adding the \"original\" Rails version and bundling again.</p>\n\n<p>I reproduced the <code>'method_missing': undefined method 'load_defaults'</code> error firstly creating a blank Rails application using the 5.1.3 version, and then changing it to the 5.0.1, removing the Gemfile.lock and running <code>bundle</code>.</p>\n"}], "owner": {"reputation": 37, "user_id": 8387879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/721c42f4aa3265608eba49d08950c933?s=128&d=identicon&r=PG&f=1", "display_name": "Sebasti&#225;n Echeverr&#237;a", "link": "https://stackoverflow.com/users/8387879/sebasti%c3%a1n-echeverr%c3%ada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 716, "favorite_count": 0, "accepted_answer_id": 45945898, "answer_count": 1, "score": 2, "last_activity_date": 1504031357, "creation_date": 1504030160, "question_id": 45945742, "link": "https://stackoverflow.com/questions/45945742/method-missing-error-when-running-rails-server", "title": "Method_missing error when running &quot;rails server&quot;", "body": "<p>I'm just starting a new rails app but it doesn't let me start the server, after typing 'rails s' the console just pukes me out this;</p>\n\n<pre><code>/Users/user/.rvm/gems/ruby-2.4.1/gems/railties-4.2.9/lib/rails/railtie/configuration.rb:95:in `method_missing': undefined method `load_defaults' for #&lt;Rails::Application::Configuration:0x007fa393f7db20&gt; (NoMethodError)\nfrom /Users/user/Desktop/MiProyecto/Portafolio/config/application.rb:12:in `&lt;class:Application&gt;'\nfrom /Users/user/Desktop/MiProyecto/Portafolio/config/application.rb:10:in `&lt;module:Portafolio&gt;'\nfrom /Users/user/Desktop/MiProyecto/Portafolio/config/application.rb:9:in `&lt;top (required)&gt;'\nfrom /Users/user/.rvm/gems/ruby-2.4.1/gems/railties-4.2.9/lib/rails/commands/commands_tasks.rb:78:in `require'\nfrom /Users/user/.rvm/gems/ruby-2.4.1/gems/railties-4.2.9/lib/rails/commands/commands_tasks.rb:78:in `block in server'\nfrom /Users/user/.rvm/gems/ruby-2.4.1/gems/railties-4.2.9/lib/rails/commands/commands_tasks.rb:75:in `tap'\nfrom /Users/user/.rvm/gems/ruby-2.4.1/gems/railties-4.2.9/lib/rails/commands/commands_tasks.rb:75:in `server'\nfrom /Users/user/.rvm/gems/ruby-2.4.1/gems/railties-4.2.9/lib/rails/commands/commands_tasks.rb:39:in `run_command!'\nfrom /Users/user/.rvm/gems/ruby-2.4.1/gems/railties-4.2.9/lib/rails/commands.rb:17:in `&lt;top (required)&gt;'\nfrom bin/rails:9:in `require'\nfrom bin/rails:9:in `&lt;main&gt;'\n</code></pre>\n\n<p>Any thoughts?\nThanks in advance.</p>\n\n<p>ps: I already ran bundle install and it went out perfectly.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1504029347, "post_id": 45945372, "comment_id": 78849396, "body": "<code>something</code>, in this case, would be a message sent to the <i>elements</i>, not the collection. So something like this should work <code>expect(collection.first).to receive(:something)</code>. But I&#39;m sensing that you actually don&#39;t have any elements or collection. The simplification of your actual code for the question may have gone too far."}, {"owner": {"reputation": 99, "user_id": 1610127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935fe41601ffe94abb5b19c20367e508?s=128&d=identicon&r=PG", "display_name": "user1610127", "link": "https://stackoverflow.com/users/1610127/user1610127"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1504030689, "post_id": 45945372, "comment_id": 78850087, "body": "@SergioTulentsev that makes sense. I solved it with <code>expect(collection).to all(receive(:something))</code>. Thank you!"}], "owner": {"reputation": 99, "user_id": 1610127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935fe41601ffe94abb5b19c20367e508?s=128&d=identicon&r=PG", "display_name": "user1610127", "link": "https://stackoverflow.com/users/1610127/user1610127"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 241, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504030315, "creation_date": 1504028873, "last_edit_date": 1504030315, "question_id": 45945372, "link": "https://stackoverflow.com/questions/45945372/rspec-expect-to-receive-with-block-shortcut", "title": "Rspec: expect to receive with block shortcut", "body": "<p>I'm trying to write specs for code like <code>collection.map(&amp;:something)</code>.</p>\n\n<p>I know the easies way is to test the outcome of the block call, but in my case it calls 3rd party APIs and I just wanted to make sure it sends appropriate message to the collection. </p>\n\n<p>Already tried a pretty straightforward <code>expect</code>:\n<code>expect(collection).to receive(:map).with(&amp;:something)</code>\nIt fails with <code>ArgumentError: 'with' must have at least one argument</code>.</p>\n\n<p>What is the correct approach?</p>\n\n<p>Thanks for any help.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1504029857, "post_id": 45945112, "comment_id": 78849697, "body": "For performance concerns the best advice I can give is to try it out and benchmark it. What&#39;s fast on my machine might be slow on yours and vice-versa."}, {"owner": {"reputation": 6200, "user_id": 637094, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fd50f61387b63900335c8556f86237be?s=128&d=identicon&r=PG", "display_name": "Leonel Gal&#225;n", "link": "https://stackoverflow.com/users/637094/leonel-gal%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1504034064, "post_id": 45945112, "comment_id": 78851877, "body": "Why are you using jsonb and not another table? What you want to do seems strictly relational, another table will work much better."}, {"owner": {"reputation": 699, "user_id": 6873497, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7e17e7b7f298bbf51382bd565add516a?s=128&d=identicon&r=PG&f=1", "display_name": "matiss", "link": "https://stackoverflow.com/users/6873497/matiss"}, "reply_to_user": {"reputation": 6200, "user_id": 637094, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fd50f61387b63900335c8556f86237be?s=128&d=identicon&r=PG", "display_name": "Leonel Gal&#225;n", "link": "https://stackoverflow.com/users/637094/leonel-gal%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1504034613, "post_id": 45945112, "comment_id": 78852146, "body": "@Leito Well, as mentioned above I have option to do it with Join table. So far I&#39;ve been thinking maybe I can decrease amount of rows by storing that info in single row for each record. Basically we are talking about 20x less rows. Potential Join table would just store all those <code>item_id</code> and a bit more info, that&#39;s it. It&#39;s just seems to me potentially a lot of rows..."}, {"owner": {"reputation": 6200, "user_id": 637094, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fd50f61387b63900335c8556f86237be?s=128&d=identicon&r=PG", "display_name": "Leonel Gal&#225;n", "link": "https://stackoverflow.com/users/637094/leonel-gal%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1504037949, "post_id": 45945112, "comment_id": 78853847, "body": "1 million (or 20) rows is not much for PostgreSQL (for a decent installation of PostgreSQL), what you want to do is done traditionally with two tables, that&#39;s the most straightforward way of doing it. You can store the structure you want in JSONB, you can find a way to query it, but  all will be workarounds for not using the right structure."}, {"owner": {"reputation": 85043, "user_id": 1995738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fXrVi.png?s=128&g=1", "display_name": "klin", "link": "https://stackoverflow.com/users/1995738/klin"}, "edited": false, "score": 0, "creation_date": 1504039853, "post_id": 45945112, "comment_id": 78854769, "body": "Keep items in a regular table referencing <code>storage</code>. It&#39;s practically the only efficient way if you are going to search for/insert/update/delete a single item. This is all the more true the bigger your data is."}, {"owner": {"reputation": 699, "user_id": 6873497, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7e17e7b7f298bbf51382bd565add516a?s=128&d=identicon&r=PG&f=1", "display_name": "matiss", "link": "https://stackoverflow.com/users/6873497/matiss"}, "reply_to_user": {"reputation": 85043, "user_id": 1995738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fXrVi.png?s=128&g=1", "display_name": "klin", "link": "https://stackoverflow.com/users/1995738/klin"}, "edited": false, "score": 0, "creation_date": 1504072661, "post_id": 45945112, "comment_id": 78863737, "body": "@klin Ok, thank you. So far I&#39;ve done everything to implement regular table referencing <code>storage</code> and basically I have everything set there. It&#39;s just I started to look at my data and thought its more like array so then I got the idea of storing it maybe differently due to potential amount of rows. I&#39;ll stay with regular Rails way and then look for query optimization and other things if performance issues rise. Thank you!"}], "owner": {"reputation": 699, "user_id": 6873497, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7e17e7b7f298bbf51382bd565add516a?s=128&d=identicon&r=PG&f=1", "display_name": "matiss", "link": "https://stackoverflow.com/users/6873497/matiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1504028893, "creation_date": 1504027984, "last_edit_date": 1504028893, "question_id": 45945112, "link": "https://stackoverflow.com/questions/45945112/multi-dimensional-array-in-jsonb-column", "title": "Multi-dimensional array in JSONB column", "body": "<p>I have a model <code>Storage</code>, and a column named <code>data</code> in a related table is in JSONB format.</p>\n\n<p>I'm thinking of how to store this kind of data structure in a single JSONB <code>data</code> column for each record of my table:</p>\n\n<pre><code>position | item_id | fixed\n---------+---------+------\n    1    |   123   |   f\n---------+---------+------\n    2    |   555   |   t  \n---------+---------+------\n    3    |    1    |   f  \n---------+---------+------\n  .. more can follow..\n</code></pre>\n\n<p>Items are ordered, and I need to state somewhere that particular item's <code>position</code> cannot be changed; <code>true</code> would mean it's fixed. My understanding from <a href=\"https://www.postgresql.org/docs/current/static/functions-json.html\" rel=\"nofollow noreferrer\">PostgreSQL docs</a> is that it should be an array of arrays.</p>\n\n<ol>\n<li>Is this achievable, and if yes, how do I do this?</li>\n<li>Would this kind of data storing allow to create/update/delete a single item of an array? For example, I have three items in an array and I need to add a fourth item. </li>\n<li>How would this kind of data storing work from performance perspective?\nLets say I have 1 million rows in my table, and there are 20 items in each row, and I need to get all records that have a particular <code>item_id</code>.</li>\n</ol>\n\n<p>My backup plan is just to do some Join table and store all info row-by-row. However, I'm thinking to do something different by using JSONB.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 173, "user_id": 5922155, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z8Zdm.png?s=128&g=1", "display_name": "Asmita", "link": "https://stackoverflow.com/users/5922155/asmita"}, "edited": false, "score": 0, "creation_date": 1504027174, "post_id": 45944731, "comment_id": 78848135, "body": "Please have a look on a link <a href=\"https://stackoverflow.com/a/11430924/5922155\">here</a>"}, {"owner": {"reputation": 89, "user_id": 5608276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac7343bb0cffcfd09d7696fe8fdec4f2?s=128&d=identicon&r=PG&f=1", "display_name": "John Ross", "link": "https://stackoverflow.com/users/5608276/john-ross"}, "reply_to_user": {"reputation": 173, "user_id": 5922155, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z8Zdm.png?s=128&g=1", "display_name": "Asmita", "link": "https://stackoverflow.com/users/5922155/asmita"}, "edited": false, "score": 0, "creation_date": 1504027644, "post_id": 45944731, "comment_id": 78848395, "body": "@asmitakalena I have already attached a link like that though thanks for prompt reply"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 5608276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac7343bb0cffcfd09d7696fe8fdec4f2?s=128&d=identicon&r=PG&f=1", "display_name": "John Ross", "link": "https://stackoverflow.com/users/5608276/john-ross"}, "edited": false, "score": 0, "creation_date": 1504027023, "post_id": 45944798, "comment_id": 78848069, "body": "Thanks But I am newbie can you please help to write this. And +1 from side for your answer"}, {"owner": {"reputation": 1961, "user_id": 1308979, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/899f97295621824a5f482a286f5062ca?s=128&d=identicon&r=PG", "display_name": "jeremywoertink", "link": "https://stackoverflow.com/users/1308979/jeremywoertink"}, "reply_to_user": {"reputation": 89, "user_id": 5608276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac7343bb0cffcfd09d7696fe8fdec4f2?s=128&d=identicon&r=PG&f=1", "display_name": "John Ross", "link": "https://stackoverflow.com/users/5608276/john-ross"}, "edited": false, "score": 1, "creation_date": 1504027152, "post_id": 45944798, "comment_id": 78848126, "body": "Sorry, I actually can&#39;t. Writing a json parser shouldn&#39;t be done by a newbie because it&#39;s SUPER difficult. Just use the stdlib JSON. <code>require &quot;json&quot;</code> and then <code>JSON.parse(json_string)</code>."}, {"owner": {"reputation": 1961, "user_id": 1308979, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/899f97295621824a5f482a286f5062ca?s=128&d=identicon&r=PG", "display_name": "jeremywoertink", "link": "https://stackoverflow.com/users/1308979/jeremywoertink"}, "reply_to_user": {"reputation": 89, "user_id": 5608276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac7343bb0cffcfd09d7696fe8fdec4f2?s=128&d=identicon&r=PG&f=1", "display_name": "John Ross", "link": "https://stackoverflow.com/users/5608276/john-ross"}, "edited": false, "score": 0, "creation_date": 1504027299, "post_id": 45944798, "comment_id": 78848208, "body": "I updated my example on how to parse json from a file using the standard library. Like I said, using JSON.parse is pure ruby, not an external gem."}, {"owner": {"reputation": 913, "user_id": 5875610, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/3aKbQ.jpg?s=128&g=1", "display_name": "Kevin Hernandez", "link": "https://stackoverflow.com/users/5875610/kevin-hernandez"}, "edited": false, "score": 0, "creation_date": 1582126747, "post_id": 45944798, "comment_id": 106671544, "body": "He meant as in: not having to import anything."}], "tags": [], "owner": {"reputation": 1961, "user_id": 1308979, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/899f97295621824a5f482a286f5062ca?s=128&d=identicon&r=PG", "display_name": "jeremywoertink", "link": "https://stackoverflow.com/users/1308979/jeremywoertink"}, "is_accepted": false, "score": 23, "last_activity_date": 1556041236, "last_edit_date": 1556041236, "creation_date": 1504026939, "answer_id": 45944798, "question_id": 45944731, "link": "https://stackoverflow.com/questions/45944731/how-i-can-parse-json-file-by-pure-ruby-code-without-gem/45944798#45944798", "title": "How I can parse JSON file by pure Ruby code without gem", "body": "<p><code>JSON</code> is in the stdlib, so using <code>JSON.parse</code> is pure ruby. </p>\n\n<pre><code>require \"json\"\njson_from_file = File.read(\"myfile.json\")\nhash = JSON.parse(json_from_file)\n</code></pre>\n\n<p>or just <code>JSON.parse(\"{}\")</code></p>\n\n<p>If you're looking to write your own JSON parser (good luck), but just keep in mind that it's just a string when read from a file. So, start by reading it in from your file</p>\n\n<pre><code>File.open(\"myfile.json\") do |f|\n  str = f.gets\n  # start parsing\nend\n</code></pre>\n\n<p>At this point you'll need to tokenize what you read, and start picking apart each bit. Read up on the json spec.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 7407782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48f57ba92736b4076a9b6de64662379f?s=128&d=identicon&r=PG&f=1", "display_name": "Richard LaFranchi", "link": "https://stackoverflow.com/users/7407782/richard-lafranchi"}, "is_accepted": false, "score": 2, "last_activity_date": 1504027330, "creation_date": 1504027330, "answer_id": 45944921, "question_id": 45944731, "link": "https://stackoverflow.com/questions/45944731/how-i-can-parse-json-file-by-pure-ruby-code-without-gem/45944921#45944921", "title": "How I can parse JSON file by pure Ruby code without gem", "body": "<p>JSON is part of the core Ruby library (as of 1.9.3 I believe).  You just have to require it in your ruby application/file</p>\n\n<pre><code>require 'json'\n\n## Then you can use JSON\nJSON.parse(\"{}\")\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 5608276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac7343bb0cffcfd09d7696fe8fdec4f2?s=128&d=identicon&r=PG&f=1", "display_name": "John Ross", "link": "https://stackoverflow.com/users/5608276/john-ross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11406, "favorite_count": 0, "answer_count": 2, "score": 6, "last_activity_date": 1556041236, "creation_date": 1504026599, "question_id": 45944731, "link": "https://stackoverflow.com/questions/45944731/how-i-can-parse-json-file-by-pure-ruby-code-without-gem", "title": "How I can parse JSON file by pure Ruby code without gem", "body": "<p>I Have tried many ways and googled but everywhere i getting same way out, use json gem to parse a JSON file.</p>\n\n<pre><code>JSON.parse(string)\n</code></pre>\n\n<p>And couple of links are also using same\n<a href=\"https://stackoverflow.com/questions/5410682/parsing-a-json-string-in-ruby\">stackoverflow Link</a></p>\n\n<p>I wanted to achieve it by pure Ruby code without using any gem or rails help.</p>\n"}, {"tags": ["ruby", "watir"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1504026574, "post_id": 45944604, "comment_id": 78847858, "body": "Can you explain your reasoning for this? There may be other suitable options if we understood the use case."}, {"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1504030628, "post_id": 45944604, "comment_id": 78850061, "body": "<a href=\"http://www.rubydoc.info/gems/watir/Watir/Element#flash-instance_method\" rel=\"nofollow noreferrer\"><code>flash</code></a> method might be what you&#39;re looking for."}, {"owner": {"reputation": 21, "user_id": 8515604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hJu7.jpg?s=128&g=1", "display_name": "Karel Junek", "link": "https://stackoverflow.com/users/8515604/karel-junek"}, "edited": false, "score": 0, "creation_date": 1504074020, "post_id": 45944604, "comment_id": 78864339, "body": "Imagine, user is on page and he want highlightid part of the text. After highlight, he want to click on bold in ckeditor. <a href=\"https://ckeditor.com/\" rel=\"nofollow noreferrer\">ckeditor.com</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8515604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hJu7.jpg?s=128&g=1", "display_name": "Karel Junek", "link": "https://stackoverflow.com/users/8515604/karel-junek"}, "edited": false, "score": 0, "creation_date": 1504258847, "post_id": 45947594, "comment_id": 78954651, "body": "Hello, thank you for your response. My question is what i can do when i can&#39;t select text at CKEDITOR.COM and after, i want bold this text ? I try this: require &#39;watir&#39; require &#39;watir/extensions/select_text&#39;  browser = Watir::Browser.new browser.goto(&#39;<a href=\"https://ckeditor.com/&#39;\" rel=\"nofollow noreferrer\">ckeditor.com/&#39;</a>) sleep 10 puts browser.element(:xpath, &quot;//body[@class=&#39;article-editor cke_editable cke_editable_themed cke_contents_ltr cke_show_borders&#39;]/p&quot;).select_text(&#39;Bake the brownies&#39;) browser.element(:xpath, &quot;//span[@class=&#39;cke_toolgroup&#39;]//a[@class=&#39;cke_button cke_button__bold cke_button_off&#39;]&quot;).click sleep(5)"}, {"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "reply_to_user": {"reputation": 21, "user_id": 8515604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hJu7.jpg?s=128&g=1", "display_name": "Karel Junek", "link": "https://stackoverflow.com/users/8515604/karel-junek"}, "edited": false, "score": 0, "creation_date": 1504272877, "post_id": 45947594, "comment_id": 78963402, "body": "Why you cannot select the text in the CKEditor is a different problem. The CKEditor uses an <code>iframe</code>, which you need to explicitly tell Watir to look into. The answer has been updated with a working example for that page."}, {"owner": {"reputation": 21, "user_id": 8515604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hJu7.jpg?s=128&g=1", "display_name": "Karel Junek", "link": "https://stackoverflow.com/users/8515604/karel-junek"}, "edited": false, "score": 0, "creation_date": 1504508200, "post_id": 45947594, "comment_id": 79023357, "body": "Hi again, thank you for your response. browser.link(href: /Bold/).click   Is not work for me. I had to locate CKEDITOR for our country. = browser.link(:xpath, &quot;//span[@class=&#39;cke_toolgroup&#39;]/a[@title=&#39;Tu\u010dn&#233; (Ctrl+B)&#39;]&quot;).click But after that it work well.  One last question when i used browser.link(href: /Tu\u010dn&#233;/).click = Console just interupt test.  So one last question is how to choose only part of text in attribut? Example: title had text /a[@title=&#39;Tu\u010dn&#233; (Ctrl+B)&#39;]&quot;)  and i want choose only &#39;Tu\u010dn&#233;&#39;. I hope u know what i mean . Thank you again that was so helpfull!! :)"}, {"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "reply_to_user": {"reputation": 21, "user_id": 8515604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hJu7.jpg?s=128&g=1", "display_name": "Karel Junek", "link": "https://stackoverflow.com/users/8515604/karel-junek"}, "edited": false, "score": 0, "creation_date": 1504615440, "post_id": 45947594, "comment_id": 79069967, "body": "Using the Regexp like you did in <code>browser.link(href: &#47;Tu\u010dn&#233;&#47;)</code> is how you would match part of the attribute. If you&#39;re asking about in XPath, you can use the <code>contains</code> - eg <code>&#47;a[contains(@title, &#39;Tu\u010dn&#233;&#39;)]</code>"}, {"owner": {"reputation": 21, "user_id": 8515604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hJu7.jpg?s=128&g=1", "display_name": "Karel Junek", "link": "https://stackoverflow.com/users/8515604/karel-junek"}, "edited": false, "score": 0, "creation_date": 1504621493, "post_id": 45947594, "comment_id": 79074590, "body": "Nice one. Thank you it was helpful"}], "tags": [], "owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "is_accepted": true, "score": 0, "last_activity_date": 1504272756, "last_edit_date": 1504272756, "creation_date": 1504037361, "answer_id": 45947594, "question_id": 45944604, "link": "https://stackoverflow.com/questions/45944604/how-to-mark-a-certain-part-of-the-text-in-watir/45947594#45947594", "title": "How to mark a certain part of the text in watir?", "body": "<p>You can use the <code>Element#select_text</code> method. Note that prior to Watir 6.8, you will need to manually include the extension (method).</p>\n\n<p>Here is a working example using the Wikipedia page:</p>\n\n<pre><code>require 'watir'\nrequire 'watir/extensions/select_text' # only include this if using Watir 6.7 or prior\n\nbrowser = Watir::Browser.new\nbrowser.goto('https://en.wikipedia.org/wiki/XPath')\nbrowser.body.select_text('XPath may be used')\nsleep(5) # so that you can see the selection\n</code></pre>\n\n<p>Note that this will highlight the first match. You may want to restrict searching a specific element rather than the entire <code>body</code>.</p>\n\n<p>Here is another example using ckeditor.com:</p>\n\n<pre><code>require 'watir'\nrequire 'watir/extensions/select_text' # only include this if using Watir 6.7 or prior\n\nbrowser = Watir::Browser.new\nbrowser.goto('ckeditor.com/')\nframe = browser.iframe(class: 'cke_wysiwyg_frame')\nframe.p.select_text('Bake the brownies')\nbrowser.link(href: /Bold/).click\nsleep(10)\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8515604, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hJu7.jpg?s=128&g=1", "display_name": "Karel Junek", "link": "https://stackoverflow.com/users/8515604/karel-junek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 45947594, "answer_count": 1, "score": 0, "last_activity_date": 1504272756, "creation_date": 1504025989, "question_id": 45944604, "link": "https://stackoverflow.com/questions/45944604/how-to-mark-a-certain-part-of-the-text-in-watir", "title": "How to mark a certain part of the text in watir?", "body": "<p>Hello is there something that can only mark a certain part of the text?\nI can not find the right solution anywhere.</p>\n\n<p>I tried: <code>double_click</code>, <code>flash</code>, <code>select_text</code> didn't work for me.</p>\n\n<p>This works, but this mark everything :  <code>browser.send_keys [:control, 'a']</code></p>\n\n<p>I added picture of example, what i want to do.\nThank you for your answers.\n<a href=\"https://i.stack.imgur.com/EPO6h.png\" rel=\"nofollow noreferrer\">The red rectangle shows the markings</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "localization", "rails-i18n"], "answers": [{"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": false, "score": 1, "last_activity_date": 1504032103, "last_edit_date": 1504032103, "creation_date": 1504027240, "answer_id": 45944895, "question_id": 45944520, "link": "https://stackoverflow.com/questions/45944520/remove-attribute-name-from-locales-error-message/45944895#45944895", "title": "Remove attribute name from locales error message", "body": "<p>You could try accessing each message value from the errors in the object you're trying to create, and within each message, to access it's first value (as it's an array), something like:</p>\n\n<pre><code>&lt;% answer.errors.messages.values.each do |message| %&gt;\n  &lt;li&gt;&lt;%= message.first %&gt;&lt;/li&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21499, "user_id": 19839, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/971cfac6afb23c0f0fd3623284a02a81?s=128&d=identicon&r=PG", "display_name": "csexton", "link": "https://stackoverflow.com/users/19839/csexton"}, "is_accepted": true, "score": 1, "last_activity_date": 1504030370, "creation_date": 1504030370, "answer_id": 45945784, "question_id": 45944520, "link": "https://stackoverflow.com/questions/45944520/remove-attribute-name-from-locales-error-message/45945784#45945784", "title": "Remove attribute name from locales error message", "body": "<p>I would do this by localizing the attribute name, rather than prevent it from being added to the message:</p>\n\n<pre><code>en:\n  activerecord:\n    attributes:\n      answer:\n        value: \"points\"\n</code></pre>\n"}], "owner": {"reputation": 277, "user_id": 4774554, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d72ff795ced575525d4f5cf033d65520?s=128&d=identicon&r=PG&f=1", "display_name": "VegaStudios", "link": "https://stackoverflow.com/users/4774554/vegastudios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 477, "favorite_count": 0, "accepted_answer_id": 45945784, "answer_count": 2, "score": 1, "last_activity_date": 1504032103, "creation_date": 1504025704, "question_id": 45944520, "link": "https://stackoverflow.com/questions/45944520/remove-attribute-name-from-locales-error-message", "title": "Remove attribute name from locales error message", "body": "<p>I've got a set of locales, as listed below. When an error message is triggered, it will pull in the name of the attribute and prepends it before the error message.</p>\n\n<p>The error result for the points value being blank on submit is, \"value points value can't be blank\".</p>\n\n<p>How do I remove the {%attribute} name in the error message?</p>\n\n<pre><code>en:\n activerecord:\n    attributes:\n      referral:\n        email: The email address you entered\n    errors:\n      models:\n        answer:\n          attributes:\n            value:\n              blank: points value can't be blank\n</code></pre>\n\n<p>I've also tried to add the message in the model, but to no avail (it still prepends the attribute name).</p>\n\n<pre><code>validates_presence_of :value, :message =&gt; \"points value can't be blank\"\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 5160883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6449b3a9aec49b1185b6b16890586a7?s=128&d=identicon&r=PG&f=1", "display_name": "Andr&#233; de Brito", "link": "https://stackoverflow.com/users/5160883/andr%c3%a9-de-brito"}, "edited": false, "score": 0, "creation_date": 1504086757, "post_id": 45944396, "comment_id": 78872229, "body": "Thanks for the answer. You are correct: measuring the memory in use after that piece of code runs, I see it sitting steadily at 77.5MB, so all that memory allocated by net/protocol does get GC&#39;d pretty quick."}], "tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": true, "score": 1, "last_activity_date": 1504089148, "last_edit_date": 1504089148, "creation_date": 1504025232, "answer_id": 45944396, "question_id": 45944220, "link": "https://stackoverflow.com/questions/45944220/large-amount-of-memory-allocated-by-net-protocol-rb153/45944396#45944396", "title": "Large amount of memory allocated by net/protocol.rb:153", "body": "<p>Almost all of those strings allocated in <a href=\"https://github.com/ruby/ruby/blob/v2_1_0/lib/net/protocol.rb#L153\" rel=\"nofollow noreferrer\">net/protocol.rb#L153</a> are short-lived and are reclaimed by the next GC run. Those allocated objects are thus pretty harmless and will not result in a significantly larger process size.</p>\n\n<p>You get a lot of exceptions (which are used for control flow here to read form the socket) and the actual read data which is appended to the buffer. All of these operations create temporary (internally used) objects.</p>\n\n<p>As such, you are probably measuring the wrong thing. What would probably make more sense is to:</p>\n\n<ul>\n<li>measure the maximum RSS of the process (i.e. the \"used\" memory);</li>\n<li>and to measure the amount of additional memory still allocated after the read.</li>\n</ul>\n\n<p>You will notice that (depending on the memory pressure on your computer), the RSS will not grow significantly above the amount of actually read data and that the references memory after the read is about the same size as the read data with about no internal intermediate objects still referenced.</p>\n"}], "owner": {"reputation": 27, "user_id": 5160883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6449b3a9aec49b1185b6b16890586a7?s=128&d=identicon&r=PG&f=1", "display_name": "Andr&#233; de Brito", "link": "https://stackoverflow.com/users/5160883/andr%c3%a9-de-brito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 45944396, "answer_count": 1, "score": 1, "last_activity_date": 1504089148, "creation_date": 1504024526, "question_id": 45944220, "link": "https://stackoverflow.com/questions/45944220/large-amount-of-memory-allocated-by-net-protocol-rb153", "title": "Large amount of memory allocated by net/protocol.rb:153", "body": "<p>While running <code>memory_profiler</code>, I noticed a large amount of memory being allocated by Ruby's net/protocol.rb component. I call it when performing an HTTP request to a server to download a file. The file is 43.67MB large and net/protocol.rb alone allocates 262,011,476 bytes just to download it.</p>\n\n<p>Looking at the \"allocated memory by location\" section in the profiler report below, I can see <code>net/protocol.rb:172</code> and <code>http/response.rb:334</code> allocating 50-60MB of memory each, which is about the size of the file, so that looks reasonable. However, the top most entry (<code>net/protocol.rb:153</code>) worries me: that's 200MB of memory, at least 4x the size of the file.</p>\n\n<p>I have two questions:</p>\n\n<ol>\n<li>Why does net/protocol need to allocate 5x the size of the file in order to download it?</li>\n<li>Is there anything I can do to reduce the amount of memory used by net/protocol?</li>\n</ol>\n\n<p><code>memory_profiler</code> output:</p>\n\n<pre><code>Total allocated: 314461424 bytes (82260 objects)\nTotal retained:  0 bytes (0 objects)\n\nallocated memory by gem\n-----------------------------------\n 314461304  ruby-2.1.2/lib\n       120  client/lib\n\nallocated memory by file\n-----------------------------------\n 262011476  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/protocol.rb\n  52435727  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/response.rb\n      7971  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb\n      2178  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/common.rb\n      1663  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http.rb\n      1260  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/generic_request.rb\n       949  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/generic.rb\n       120  /Users/andre.debrito/git/techserv-cache/client/lib/connections/cache_server_connection.rb\n        80  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/http.rb\n\nallocated memory by location\n-----------------------------------\n 200483909  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/protocol.rb:153\n  60548199  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/protocol.rb:172\n  52428839  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/response.rb:334\n    978800  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/protocol.rb:155\n      2537  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/response.rb:61\n      2365  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:172\n      2190  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/response.rb:54\n      1280  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/response.rb:56\n       960  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:62\n       836  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:165\n       792  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:13\n       738  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/common.rb:125\n       698  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:263\n       576  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/common.rb:214\n       489  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/response.rb:40\n       480  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/common.rb:127\n       360  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:40\n       328  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http.rb:610\n       320  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/generic_request.rb:71\n       320  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:30\n       320  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:59\n       308  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/generic_request.rb:322\n       256  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http.rb:879\n       240  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/generic.rb:1615\n       239  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/protocol.rb:211\n       232  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/generic_request.rb:38\n       224  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/common.rb:181\n       200  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:17\n       192  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/response.rb:42\n       179  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http.rb:877\n       169  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http.rb:1459\n       160  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http.rb:1029\n       160  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:434\n       160  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:435\n       160  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:445\n       160  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/generic.rb:1617\n       149  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/generic.rb:1445\n       147  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http.rb:1529\n       129  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/protocol.rb:98\n       128  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http.rb:1475\n       120  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:444\n       120  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:446\n       120  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:447\n       120  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/response.rb:29\n       120  /Users/andre.debrito/git/techserv-cache/client/lib/connections/cache_server_connection.rb:45\n        96  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http.rb:899\n        80  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/generic_request.rb:39\n        80  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/generic_request.rb:45\n        80  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/generic_request.rb:46\n        80  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:145\n\nallocated memory by class\n-----------------------------------\n 309678360  String\n   3445304  Thread::Backtrace\n    981096  Array\n    352376  IO::EAGAINWaitReadable\n      1960  MatchData\n      1024  Hash\n       328  Net::HTTP\n       256  TCPSocket\n       256  URI::HTTP\n       128  Time\n       120  Net::HTTP::Get\n       120  Net::HTTPOK\n        96  Net::BufferedIO\n\nallocated objects by gem\n-----------------------------------\n     82259  ruby-2.1.2/lib\n         1  client/lib\n\nallocated objects by file\n-----------------------------------\n     81908  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/protocol.rb\n       129  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/response.rb\n       127  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb\n        28  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/common.rb\n        23  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/generic_request.rb\n        23  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/generic.rb\n        19  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http.rb\n         2  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/http.rb\n         1  /Users/andre.debrito/git/techserv-cache/client/lib/connections/cache_server_connection.rb\n\nallocated objects by location\n-----------------------------------\n     36373  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/protocol.rb:153\n     24470  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/protocol.rb:155\n     21057  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/protocol.rb:172\n        48  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/response.rb:61\n        38  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/response.rb:54\n        32  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/response.rb:56\n        31  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:172\n        24  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:62\n        12  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/common.rb:127\n         9  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:40\n         8  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/generic_request.rb:71\n         8  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:165\n         8  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:30\n         8  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:59\n         6  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/common.rb:214\n         6  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/generic.rb:1615\n         5  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:263\n         4  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http.rb:1029\n         4  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/generic_request.rb:322\n         4  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:17\n         4  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:434\n         4  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:435\n         4  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:445\n         4  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/response.rb:42\n         4  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/common.rb:125\n         4  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/generic.rb:1617\n         3  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http.rb:1529\n         3  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:444\n         3  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:446\n         3  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:447\n         3  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/response.rb:40\n         3  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/generic.rb:1445\n         2  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http.rb:877\n         2  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/generic_request.rb:39\n         2  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/generic_request.rb:45\n         2  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/generic_request.rb:46\n         2  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:13\n         2  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:145\n         2  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/header.rb:31\n         2  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/protocol.rb:111\n         2  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/protocol.rb:144\n         2  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/protocol.rb:98\n         2  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/common.rb:179\n         2  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/common.rb:181\n         2  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/common.rb:213\n         2  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/generic.rb:1640\n         2  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/generic.rb:1642\n         2  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/generic.rb:343\n         2  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/generic.rb:530\n         2  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/generic.rb:557\n\nallocated objects by class\n-----------------------------------\n     47935  String\n     24519  Array\n      4894  IO::EAGAINWaitReadable\n      4894  Thread::Backtrace\n         7  MatchData\n         3  Hash\n         2  URI::HTTP\n         1  Net::BufferedIO\n         1  Net::HTTP\n         1  Net::HTTP::Get\n         1  Net::HTTPOK\n         1  TCPSocket\n         1  Time\n\nretained memory by gem\n-----------------------------------\nNO DATA\n\nretained memory by file\n-----------------------------------\nNO DATA\n\nretained memory by location\n-----------------------------------\nNO DATA\n\nretained memory by class\n-----------------------------------\nNO DATA\n\nretained objects by gem\n-----------------------------------\nNO DATA\n\nretained objects by file\n-----------------------------------\nNO DATA\n\nretained objects by location\n-----------------------------------\nNO DATA\n\nretained objects by class\n-----------------------------------\nNO DATA\n\n\nAllocated String Report\n-----------------------------------\n     11926  \"\"\n      7019  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/protocol.rb:172\n      4894  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/protocol.rb:153\n        10  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/http/response.rb:54\n         2  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/uri/common.rb:179\n         1  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/protocol.rb:67\n\n      4894  \"Resource temporarily unavailable - read would block\"\n      4894  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/protocol.rb:153\n\n      4894  \"UTF-8\"\n      4894  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/protocol.rb:153\n\n      4894  \"read would block\"\n      4894  /Users/andre.debrito/.rvm/rubies/ruby-2.1.2/lib/ruby/2.1.0/net/protocol.rb:153\n...\n</code></pre>\n\n<p>Relevant code:</p>\n\n<pre><code>  report = MemoryProfiler.report do\n    begin\n      response = nil\n      Net::HTTP.new(uri.host, uri.port).start { |http|\n        request = Net::HTTP::Get.new uri.request_uri\n        response = http.request request\n      }\n    rescue Net::ReadTimeout =&gt; e\n      raise RequestTimeoutError.new(e.message)\n    rescue Exception =&gt; e\n      raise ServerConnectionError.new(e.message)\n    end\n  end\n  report.pretty_print\n</code></pre>\n\n<p>Network traffic data from Charles proxy:</p>\n\n<ul>\n<li>Request Header: 168 bytes</li>\n<li>Response Header: 288 bytes</li>\n<li>Request: -</li>\n<li>Response: 43.67 MB (45792735 bytes)</li>\n<li>Total: 43.67 MB (45793191 bytes)</li>\n</ul>\n"}, {"tags": ["ruby", "nomethoderror"], "comments": [{"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 2, "creation_date": 1504024320, "post_id": 45944027, "comment_id": 78846665, "body": "<code>current_balance = @account.balance</code>...did you mean <code>current_balance = account.balance</code>? I don&#39;t see where <code>@account</code> is set, but I do see an <code>account</code>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1504025000, "post_id": 45944027, "comment_id": 78847078, "body": "<code>balance = balance</code> is superfluous in this case. Additionally <code>other_balance</code> seems to be double credited since <code>@other_account</code> is instantiated with the given amount and <code>other_balance</code> is equal to its balance and then is credited again for the same amount."}], "answers": [{"tags": [], "owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "is_accepted": false, "score": 2, "last_activity_date": 1504024361, "creation_date": 1504024361, "answer_id": 45944160, "question_id": 45944027, "link": "https://stackoverflow.com/questions/45944027/ruby-nomethoderror-undefined-method-balance-for-nilnilclass/45944160#45944160", "title": "ruby NoMethodError undefined method `balance&#39; for nil:NilClass", "body": "<p>The error is within <code>transfer</code> method, in this line:</p>\n\n<pre><code>current_balance = @account.balance\n</code></pre>\n\n<p><code>@account</code> has not been set anywhere, so it is <code>nil</code> and you get a <code>NoMethodError</code> when you call <code>balance</code> on it.</p>\n\n<p>Maybe you meant <code>account</code>, since you are passing it as an argument.</p>\n"}], "owner": {"reputation": 39, "user_id": 6951095, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10157519478795125/picture?type=large", "display_name": "Lkoprivica", "link": "https://stackoverflow.com/users/6951095/lkoprivica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 316, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504024361, "creation_date": 1504023846, "last_edit_date": 1504024119, "question_id": 45944027, "link": "https://stackoverflow.com/questions/45944027/ruby-nomethoderror-undefined-method-balance-for-nilnilclass", "title": "ruby NoMethodError undefined method `balance&#39; for nil:NilClass", "body": "<p>Here is my code and this is the error I am receiving:\n<code>NoMethodError\nundefined method 'balance' for nil:NilClass</code></p>\n\n<p>I am new to programming and can't seem to figure out the problem.</p>\n\n<pre><code>class CheckingAccount &lt; BankAccount\nattr_reader :number_of_withdrawals\n\nMAX_FREE_WITHDRAWALS = 3 \n\ndef initialize(balance)\n  balance = balance\n  super(balance) \n  @number_of_withdrawals = 0 \nend\n\ndef get_free_withdrawal_limit\n  MAX_FREE_WITHDRAWALS\n\nend\n\ndef transfer(account, amount)\n  @other_account = CheckingAccount.new(amount)\n  current_balance = @account.balance\n  other_balance = @other_account.balance\n\n   if current_balance &gt; amount\n     current_balance = @balance - amount \n     other_balance = @balance + amount\n  elsif\n    current_balance &lt; amount\n      \"not enought funds available for transfer\"\n   end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "ruby-on-rails-5", "devise-confirmable"], "answers": [{"tags": [], "owner": {"reputation": 85, "user_id": 7005936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4e52cf285cc948e744bddf99988c5da9?s=128&d=identicon&r=PG&f=1", "display_name": "Ahkshaey Ravi", "link": "https://stackoverflow.com/users/7005936/ahkshaey-ravi"}, "is_accepted": true, "score": 1, "last_activity_date": 1504033055, "last_edit_date": 1504033055, "creation_date": 1504032687, "answer_id": 45946378, "question_id": 45943688, "link": "https://stackoverflow.com/questions/45943688/devise-confirmable-on-rails-5-not-working/45946378#45946378", "title": "devise confirmable on rails 5 not working", "body": "<p>After a couple of hours, figured out that i was following the wrong way of doing things.Followed the well written article over <a href=\"https://cbabhusal.wordpress.com/2015/03/27/ruby-on-rails-devise-mailer-customize-override-the-mailer/\" rel=\"nofollow noreferrer\">here</a>.Have updated my solution below:</p>\n\n<p>Refactored <strong>confirmation_instructions</strong> method present in my <strong>custom mailer class</strong> as shown below:</p>\n\n<pre><code>def confirmation_instructions(record, token, opts={})\n\n    if record.email.present?\n      opts[:subject] = \"Welcome #{record.email.split('@').first.capitalize}, Confirm your asana account\"\n    else\n      opts[:subject] = \"Confirm Your Asana Account\"\n    end\n\n    super\n\n  end\n</code></pre>\n\n<p>Changed the <strong>function invocation</strong> to this in my <strong>user model</strong>:</p>\n\n<pre><code>MyDeviseMailer.confirmation_instructions(self, self.confirmation_token).deliver\n</code></pre>\n\n<p>This is what worked for me finally.</p>\n"}], "owner": {"reputation": 85, "user_id": 7005936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4e52cf285cc948e744bddf99988c5da9?s=128&d=identicon&r=PG&f=1", "display_name": "Ahkshaey Ravi", "link": "https://stackoverflow.com/users/7005936/ahkshaey-ravi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 774, "favorite_count": 0, "accepted_answer_id": 45946378, "answer_count": 1, "score": 1, "last_activity_date": 1504033055, "creation_date": 1504022722, "question_id": 45943688, "link": "https://stackoverflow.com/questions/45943688/devise-confirmable-on-rails-5-not-working", "title": "devise confirmable on rails 5 not working", "body": "<p>I am on a rails 5 app. Using devise for user management. I have 'confirmable' enabled in my user model and the migrations are also up for the same. I have created a custom mailer class which is derived from Devise::Mailer, have setup the mailer in devise config to use the custom mailer class however my confirmations email are not being sent properly. \nHave tried many so answer threads but couldn't crack it yet. Where could I be going wrong? </p>\n\n<p>User Model</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable and :omniauthable\n  devise :database_authenticatable, :registerable, :confirmable,\n         :recoverable, :rememberable, :trackable, :validatable\n\n  after_create :send_confirmation_email\n\n  def send_confirmation_email\n    p 'inside after_create callback func.'\n    MyDeviseMailer.confirmation_instructions(self).deliver\n  end\n\nend\n</code></pre>\n\n<p>Migration for confirmable</p>\n\n<pre><code>def up\n    add_column :users, :confirmation_token, :string\n    add_column :users, :unconfirmed_email, :string\n    add_column :users, :confirmed_at, :datetime\n    add_column :users, :confirmation_sent_at, :datetime\n    add_index :users, :confirmation_token, unique: true\nend\n</code></pre>\n\n<p>My custom mailer class derived from Devise::Mailer</p>\n\n<pre><code>class MyDeviseMailer &lt; Devise::Mailer\n\n  helper :application\n  include Devise::Controllers::UrlHelpers\n  default template_path: 'devise/mailer'\n\n  def confirmation_instructions(record, token, opts={})\n    devise_mail(record, :confirmation_instructions, opts)\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-activerecord", "rspec-rails"], "answers": [{"tags": [], "owner": {"reputation": 7134, "user_id": 1078969, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1ee458f0818af1b8669af687c277c6a1?s=128&d=identicon&r=PG", "display_name": "whites11", "link": "https://stackoverflow.com/users/1078969/whites11"}, "is_accepted": false, "score": 1, "last_activity_date": 1504019773, "creation_date": 1504019773, "answer_id": 45942750, "question_id": 45942564, "link": "https://stackoverflow.com/questions/45942564/ruby-on-rails-running-custom-validation-function-only-when-other-properties-are/45942750#45942750", "title": "Ruby on Rails: Running custom validation function only when other properties are present", "body": "<p>You can add the presence of the variables in the validator itself:</p>\n\n<pre><code>def validate_all_dates\n  if self.start_time &amp;&amp; self.end_time &amp;&amp; self.start_time &gt; self.end_time\n    errors.add(:start_time, 'must be before or the same day as end     time')\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21499, "user_id": 19839, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/971cfac6afb23c0f0fd3623284a02a81?s=128&d=identicon&r=PG", "display_name": "csexton", "link": "https://stackoverflow.com/users/19839/csexton"}, "is_accepted": true, "score": 3, "last_activity_date": 1504019781, "creation_date": 1504019781, "answer_id": 45942755, "question_id": 45942564, "link": "https://stackoverflow.com/questions/45942564/ruby-on-rails-running-custom-validation-function-only-when-other-properties-are/45942755#45942755", "title": "Ruby on Rails: Running custom validation function only when other properties are present", "body": "<p>You can add an <code>if</code> parameter to the <code>validate</code> method, this can check the conditions needed. That parameter can take either be a proc:</p>\n\n<pre><code>validates :validate_all_dates, if: Proc.new { |model| model.start_time.presence }\n</code></pre>\n\n<p>Or with a method:</p>\n\n<pre><code>validate :validate_all_dates, if: :dates_present?\n\ndef dates_present?\n  start_time.presence &amp;&amp; end_time.presence\nend\n</code></pre>\n\n<p>Take a look at this guide for more details: <a href=\"http://guides.rubyonrails.org/active_record_validations.html#conditional-validation\" rel=\"nofollow noreferrer\">Conditional Validation</a></p>\n"}], "owner": {"reputation": 1373, "user_id": 3662277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/hvN2t.jpg?s=128&g=1", "display_name": "ThriceGood", "link": "https://stackoverflow.com/users/3662277/thricegood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1924, "favorite_count": 0, "accepted_answer_id": 45942755, "answer_count": 2, "score": 3, "last_activity_date": 1504019781, "creation_date": 1504019266, "question_id": 45942564, "link": "https://stackoverflow.com/questions/45942564/ruby-on-rails-running-custom-validation-function-only-when-other-properties-are", "title": "Ruby on Rails: Running custom validation function only when other properties are present", "body": "<p>I want my custom validator to only run when the properties it uses are present.</p>\n\n<pre><code># these are all dates\nvalidates :start_time, presence: true\nvalidates :end_time, presence: true\nvalidates :deadline_visitor, presence: true\nvalidates :deadline_host, presence: true\n\n# these validate the above dates\nvalidate :validate_all_dates\nvalidate :validate_dates\n</code></pre>\n\n<p>example:</p>\n\n<pre><code>def validate_all_dates\n  if self.start_time &gt; self.end_time\n    errors.add(:start_time, 'must be before or the same day as end time')\n  end\nend\n</code></pre>\n\n<p>fails because <code>self.start_time</code> and <code>self.end_time</code> are not present</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "multithreading", "sidekiq"], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 7270332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/838de408db185172e5c3607ea578e5f1?s=128&d=identicon&r=PG&f=1", "display_name": "John S", "link": "https://stackoverflow.com/users/7270332/john-s"}, "edited": false, "score": 0, "creation_date": 1504019528, "post_id": 45942177, "comment_id": 78843605, "body": "Hey! Thanks for the immediate response.  I could put the balance adjustment and pending row deletion inside a db transaction but doesn&#39;t that not necessarily protect from multi-threaded concurrency issue where two workers both try to run the transaction at the same time?"}, {"owner": {"reputation": 91, "user_id": 7270332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/838de408db185172e5c3607ea578e5f1?s=128&d=identicon&r=PG&f=1", "display_name": "John S", "link": "https://stackoverflow.com/users/7270332/john-s"}, "edited": false, "score": 0, "creation_date": 1504020473, "post_id": 45942177, "comment_id": 78844266, "body": "It also seems like overkill / a lot of overhead to have to have some kind of PendingABC record for every job similar to this.  Is that really the best pattern?"}, {"owner": {"reputation": 17782, "user_id": 1494519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af54a0871600db7fbdbb5c558a6e29a3?s=128&d=identicon&r=PG", "display_name": "Mike Perham", "link": "https://stackoverflow.com/users/1494519/mike-perham"}, "reply_to_user": {"reputation": 91, "user_id": 7270332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/838de408db185172e5c3607ea578e5f1?s=128&d=identicon&r=PG&f=1", "display_name": "John S", "link": "https://stackoverflow.com/users/7270332/john-s"}, "edited": false, "score": 0, "creation_date": 1504027803, "post_id": 45942177, "comment_id": 78848497, "body": "It&#39;s common to have a Credit/Debit table which tracks the history of every monetary adjustment.  The &quot;user.balance&quot; column just becomes a cached copy of sum(PBA.amount).  I would use SQL rather than Ruby to do these things atomically. A single UPDATE statement is much faster/reliable than multiple network calls in Ruby."}], "tags": [], "owner": {"reputation": 17782, "user_id": 1494519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af54a0871600db7fbdbb5c558a6e29a3?s=128&d=identicon&r=PG", "display_name": "Mike Perham", "link": "https://stackoverflow.com/users/1494519/mike-perham"}, "is_accepted": false, "score": 2, "last_activity_date": 1504018093, "creation_date": 1504018093, "answer_id": 45942177, "question_id": 45941980, "link": "https://stackoverflow.com/questions/45941980/idempotent-design-with-sidekiq-ruby-on-rails-background-job/45942177#45942177", "title": "Idempotent Design with Sidekiq Ruby on Rails Background Job", "body": "<p>You're on the right track; you want to use a database transaction, not a redis lock.</p>\n"}, {"comments": [{"owner": {"reputation": 91, "user_id": 7270332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/838de408db185172e5c3607ea578e5f1?s=128&d=identicon&r=PG&f=1", "display_name": "John S", "link": "https://stackoverflow.com/users/7270332/john-s"}, "edited": false, "score": 0, "creation_date": 1504022052, "post_id": 45943313, "comment_id": 78845203, "body": "Thanks for the idea.  I think the issue with this solution though is now you have to introduce an arbitrary time limit on how often a column should be allowed to be updated?  Is that the idea?  So the job would check if the balance was updated within some small time increment from now and bail if it&#39;s under that threshold?"}, {"owner": {"reputation": 91, "user_id": 7270332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/838de408db185172e5c3607ea578e5f1?s=128&d=identicon&r=PG&f=1", "display_name": "John S", "link": "https://stackoverflow.com/users/7270332/john-s"}, "edited": false, "score": 0, "creation_date": 1504022143, "post_id": 45943313, "comment_id": 78845278, "body": "Also, with this solution you would still need a lock because two threads could still read the row before the timestamp is updated and both jobs would still run"}], "tags": [], "owner": {"reputation": 8165, "user_id": 62653, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6b6d607c73fccfe066ec6adb37b17621?s=128&d=identicon&r=PG", "display_name": "andy", "link": "https://stackoverflow.com/users/62653/andy"}, "is_accepted": false, "score": 0, "last_activity_date": 1504021423, "creation_date": 1504021423, "answer_id": 45943313, "question_id": 45941980, "link": "https://stackoverflow.com/questions/45941980/idempotent-design-with-sidekiq-ruby-on-rails-background-job/45943313#45943313", "title": "Idempotent Design with Sidekiq Ruby on Rails Background Job", "body": "<p>I think you're on the right track too but you're solution <em>might</em> be overkill since I don't have full knowledge of your application.</p>\n\n<p>BUT, a simpler solution would simply be to have a flag on you <code>User</code> model like <code>balance_updated:datetime</code>. So, you could check that before updating.</p>\n\n<p>As Mike mentions using a Transaction block should ensure it's thread safe.</p>\n\n<p>In any case, to answer your question more generally... having an updated_ column is usually good enough to start with, and then if it gets complicated you can move this stuff to another model.</p>\n"}], "owner": {"reputation": 91, "user_id": 7270332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/838de408db185172e5c3607ea578e5f1?s=128&d=identicon&r=PG&f=1", "display_name": "John S", "link": "https://stackoverflow.com/users/7270332/john-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 517, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1504021423, "creation_date": 1504017552, "question_id": 45941980, "link": "https://stackoverflow.com/questions/45941980/idempotent-design-with-sidekiq-ruby-on-rails-background-job", "title": "Idempotent Design with Sidekiq Ruby on Rails Background Job", "body": "<p>Sidekiq recommends that all jobs be idempotent (able to run multiple times without being an issue) as it cannot guarantee a job will only be run one time.</p>\n\n<p>I am having trouble understanding the best way to achieve that in certain cases.  For example, say you have the following table:</p>\n\n<p>User\nid\nemail\nbalance</p>\n\n<p>The background job that is run simply adds some amount to their balance</p>\n\n<pre><code>def perform(user_id, balance_adjustment)\n user = User.find(user_id)\n user.balance += balance_adjustment\n user.save\nend\n</code></pre>\n\n<p>If this job is run more than once their balance will be incorrect.  What is best practice for something like this?</p>\n\n<p>If I think about it a potential solution I can come up with is to create a record before scheduling the job that is something like</p>\n\n<p>PendingBalanceAdjustment\nuser_id\nbalance_adjustment</p>\n\n<p>When the job runs it will need to acquire a lock for this user so that there's no chance of a race condition between two workers and then will need to both update the balance and delete the record from pending balance adjustment before releasing the lock.  </p>\n\n<p>The job then looks something like this?</p>\n\n<pre><code>def perform(user_id, balance_adjustment_id)\n  user = User.find(user_id)\n  pba = PendingBalanceAdjustment.where(:balance_adjustment_id =&gt; balance_adjustment_id).take\n  if pba.present?\n    $redis.lock(\"#{user_id}/balance_adjustment\") do\n      user.balance += pba.balance_adjustment\n      user.save\n      pba.delete    \n    end\n  end\nend\n</code></pre>\n\n<p>This seems to solve both</p>\n\n<p>a) Race condition between two workers taking the job at the same time (though you'd think Sidekiq could guarantee this already?)\nb) A job being run multiple times after running successfully</p>\n\n<p>Is this pattern a good solution?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1504018160, "post_id": 45941802, "comment_id": 78842633, "body": "It&#39;s a <i>syntax error</i>, i.e. Ruby cannot parse your code. It has nothing to do with missing includes."}, {"owner": {"reputation": 1129, "user_id": 6822886, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-PW9V0rm6uOw/AAAAAAAAAAI/AAAAAAAAAD4/Jxv9HFVgbcQ/photo.jpg?sz=128", "display_name": "Capn Jack", "link": "https://stackoverflow.com/users/6822886/capn-jack"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1504018642, "post_id": 45941802, "comment_id": 78843007, "body": "@sawa was referring more to the main idea of my code. You&#39;re right it&#39;s obvious there&#39;s a syntax error. But my usage of the phrase was referring more the approach I was taking to solve the issue. Not sure what value your comment is contributing frankly..."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1504021912, "post_id": 45941802, "comment_id": 78845105, "body": "Quick tip for range checking: <code>(5..20).include?(customer[&#39;name&#39;].length)</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1504022051, "post_id": 45941802, "comment_id": 78845201, "body": "When dealing with JSON data you may want to avoid hard type checks with <code>is_a?</code>. It&#39;s not uncommon for people to inadvertently supply numerical data as strings, and converting these strings to integers via <code>to_i</code> is trivial. If you do want to have a strict validation process then look at <a href=\"http://json-schema.org\" rel=\"nofollow noreferrer\">JSON Schema</a> as a standardized solution to this problem. It&#39;s a JSON file like an XML DTD which you can publish as a spec."}], "answers": [{"comments": [{"owner": {"reputation": 1129, "user_id": 6822886, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-PW9V0rm6uOw/AAAAAAAAAAI/AAAAAAAAAD4/Jxv9HFVgbcQ/photo.jpg?sz=128", "display_name": "Capn Jack", "link": "https://stackoverflow.com/users/6822886/capn-jack"}, "edited": false, "score": 0, "creation_date": 1504017950, "post_id": 45941929, "comment_id": 78842459, "body": "You&#39;re a genius. God bless and thanks. Why do I need the parentheses?"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 1129, "user_id": 6822886, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-PW9V0rm6uOw/AAAAAAAAAAI/AAAAAAAAAD4/Jxv9HFVgbcQ/photo.jpg?sz=128", "display_name": "Capn Jack", "link": "https://stackoverflow.com/users/6822886/capn-jack"}, "edited": false, "score": 0, "creation_date": 1504018012, "post_id": 45941929, "comment_id": 78842507, "body": "Because without the parser can&#39;t disambiguate what you&#39;re trying to do"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 1129, "user_id": 6822886, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-PW9V0rm6uOw/AAAAAAAAAAI/AAAAAAAAAD4/Jxv9HFVgbcQ/photo.jpg?sz=128", "display_name": "Capn Jack", "link": "https://stackoverflow.com/users/6822886/capn-jack"}, "edited": false, "score": 0, "creation_date": 1504018684, "post_id": 45941929, "comment_id": 78843036, "body": "@CapnJack <code>foo bar &amp;&amp; baz</code> could be <code>foo(bar &amp;&amp; baz)</code> or <code>foo(bar) &amp;&amp; baz</code>"}, {"owner": {"reputation": 1129, "user_id": 6822886, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-PW9V0rm6uOw/AAAAAAAAAAI/AAAAAAAAAD4/Jxv9HFVgbcQ/photo.jpg?sz=128", "display_name": "Capn Jack", "link": "https://stackoverflow.com/users/6822886/capn-jack"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1504018760, "post_id": 45941929, "comment_id": 78843102, "body": "wait @Stefan are you saying that I could do <code>customer[&quot;age&quot;](.to_s.empty? &amp;&amp; .is_a?(Integer)</code>?"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1504018812, "post_id": 45941929, "comment_id": 78843142, "body": "<code>if !customer[&quot;age&quot;].to_s.empty? &amp;&amp; (!customer[&quot;age&quot;].is_a? Integer)</code> should work as well"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1504018843, "post_id": 45941929, "comment_id": 78843165, "body": "But it doesn&#39;t make sense to me"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 1129, "user_id": 6822886, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-PW9V0rm6uOw/AAAAAAAAAAI/AAAAAAAAAD4/Jxv9HFVgbcQ/photo.jpg?sz=128", "display_name": "Capn Jack", "link": "https://stackoverflow.com/users/6822886/capn-jack"}, "edited": false, "score": 0, "creation_date": 1504019376, "post_id": 45941929, "comment_id": 78843502, "body": "@CapnJack no, I just wanted to provide an example for an ambiguous syntax. It was meant as an answer to <i>&quot;Why do I need the parentheses?&quot;</i> \u2013 because Ruby doesn&#39;t understand your code otherwise. Sorry for the confusion."}, {"owner": {"reputation": 1129, "user_id": 6822886, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-PW9V0rm6uOw/AAAAAAAAAAI/AAAAAAAAAD4/Jxv9HFVgbcQ/photo.jpg?sz=128", "display_name": "Capn Jack", "link": "https://stackoverflow.com/users/6822886/capn-jack"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1504019422, "post_id": 45941929, "comment_id": 78843541, "body": "@Stefan oh I see now. That clears a lot up. Thanks for the explanation, really appreciate it : )"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 3, "last_activity_date": 1504017393, "creation_date": 1504017393, "answer_id": 45941929, "question_id": 45941802, "link": "https://stackoverflow.com/questions/45941802/getting-a-syntax-error-when-checking-if-a-value-is-type-integer/45941929#45941929", "title": "Getting a syntax error when checking if a value is type Integer", "body": "<p>Try with parentheses</p>\n\n<pre><code>if !customer[\"age\"].to_s.empty? &amp;&amp; !customer[\"age\"].is_a?(Integer)\n</code></pre>\n"}], "owner": {"reputation": 1129, "user_id": 6822886, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-PW9V0rm6uOw/AAAAAAAAAAI/AAAAAAAAAD4/Jxv9HFVgbcQ/photo.jpg?sz=128", "display_name": "Capn Jack", "link": "https://stackoverflow.com/users/6822886/capn-jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 45941929, "answer_count": 1, "score": -1, "last_activity_date": 1518701513, "creation_date": 1504017103, "last_edit_date": 1518701513, "question_id": 45941802, "link": "https://stackoverflow.com/questions/45941802/getting-a-syntax-error-when-checking-if-a-value-is-type-integer", "title": "Getting a syntax error when checking if a value is type Integer", "body": "<p>I'm trying to validate that the customer's age is either empty or is a number. Here's my code:</p>\n\n<pre><code>json[\"customers\"].each do |customer|\n  faults = Array.new\n  puts customer[\"name\"]\n  if customer[\"name\"].length &lt; 5 || customer[\"name\"].length &gt; 20\n    if customer[\"email\"].to_s.empty?\n      faults.push \"email\"\n    end\n    if !customer[\"age\"].to_s.empty? &amp;&amp; !customer[\"age\"].is_a? Integer\n      fault.push \"age\"\n    end\n    if customer[\"password\"].length &lt; 8\n      fault.push \"password\"\n    end\n    puts faults faults.push \"name\"\n  end\n</code></pre>\n\n<p>Am I doing this right?</p>\n\n<p>I get this error:</p>\n\n<pre><code>syntax error, unexpected tCONSTANT, expecting keyword_then or ';' or '\\n'\n!customer[\"age\"].is_a? Integer\n                              ^\n</code></pre>\n\n<p>This should be a simple syntax error, but I can't figure it out. Am I using <code>Integer</code> correctly here?</p>\n"}, {"tags": ["ruby", "oop"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 4, "creation_date": 1504019965, "post_id": 45941669, "comment_id": 78843902, "body": "The difference is that your statement is wrong. Have you tried it?"}], "answers": [{"tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": true, "score": 1, "last_activity_date": 1504017499, "creation_date": 1504017499, "answer_id": 45941965, "question_id": 45941669, "link": "https://stackoverflow.com/questions/45941669/what-is-difference-between-class-variable-and-variable-defined-on-class-level/45941965#45941965", "title": "What is difference between class variable and variable defined on class level", "body": "<p>Well, with your second option, <code>bar</code> is a local variable which gets out of scope when reaching the <code>end</code>. As such, it won't be accessible to any methods (class methods nor instance methods) of the class.</p>\n\n<p>With that being said, in Ruby, there are class variables (<code>@@bar</code> which are shared between all child classes and their instances and instance variables (<code>@bar</code>) Since classes are also just objects in Ruby, you can also define an instance variable on class level (or more correctly: on the singleton class of your class). This can work like this:</p>\n\n<pre><code>class Foo\n  def self.bar\n    @bar\n  end\n\n  def self.bar=(value)\n    @bar = value\n  end\nend\n</code></pre>\n\n<p>Compared to class variables, these instance variables on the singleton class are not accessible on <code>Foo</code> instances nor on child classes of <code>Foo</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1504022164, "post_id": 45942982, "comment_id": 78845295, "body": "Globals are extremely bad in practice, they&#39;re far too broad in scope, but class-level variables are a close second. 99% of the time what you need is a class-level method that can intermediate this for you, like <code>self.class.latest_thing = self</code> where that&#39;s a method. The class itself is then free to interpret that however it sees fit."}], "tags": [], "owner": {"reputation": 3381, "user_id": 220679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a5c165ffc801b46ddff8851d5b49bf3e?s=128&d=identicon&r=PG", "display_name": "Ginty", "link": "https://stackoverflow.com/users/220679/ginty"}, "is_accepted": false, "score": 0, "last_activity_date": 1504020752, "last_edit_date": 1504020752, "creation_date": 1504020450, "answer_id": 45942982, "question_id": 45941669, "link": "https://stackoverflow.com/questions/45941669/what-is-difference-between-class-variable-and-variable-defined-on-class-level/45942982#45942982", "title": "What is difference between class variable and variable defined on class level", "body": "<p>The <code>@@bar</code> will return the same variable to all instances of the class, not just the same variable to all methods in the class.</p>\n\n<p>The way I think of class variables (@@variables) is as namespaced global variables. Their usage is just about as frowned upon as using global variables, but not quite since you are limiting the scope to within the code defined in your class.</p>\n\n<p>Generally they would be used to track some kind of state across your application.</p>\n\n<p>Let's say you had an object that needed to be able to identify its most recently instantiated sibling object.\nOne way to do that would be via a global variable:</p>\n\n<pre><code>class MyThing\n  def initialize\n    $latest_thing = self\n  end\n\n  def latest\n    $latest_thing\n  end\nend\n\nthing1 = MyThing.new\nthing1.latest         # =&gt; thing1\nthing2 = MyThing.new\nthing1.latest         # =&gt; thing2\nthing2.latest         # =&gt; thing2\n</code></pre>\n\n<p>Now, that uses a global variable which is generally perceived as bad practice, one of the reasons being for pollution of the global namespace and risk of naming collision and/or someone else changing it.</p>\n\n<p>If you are dealing with a situation like this where you need this shared state between instances, but no one outside needs to know about it, then you can use the class variable exactly like a global:</p>\n\n<pre><code>class MyThing\n  def initialize\n    @@latest_thing = self\n  end\n\n  def latest\n    @@latest_thing\n  end\nend\n\nthing1 = MyThing.new\nthing1.latest         # =&gt; thing1\nthing2 = MyThing.new\nthing1.latest         # =&gt; thing2\nthing2.latest         # =&gt; thing2\n</code></pre>\n\n<p>That's just generally cleaner/safer/better encapsulated, since any 3rd party code can not simply do <code>@@latest_thing = :something_else</code> the way that they could do had a global been used.</p>\n\n<p>Hope that helps. I think class variables are rarely used or encouraged in the wild, but on the rare occasion I've needed to use one it was for things like this.</p>\n"}], "owner": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 45941965, "answer_count": 2, "score": 1, "last_activity_date": 1504076553, "creation_date": 1504016759, "last_edit_date": 1504076553, "question_id": 45941669, "link": "https://stackoverflow.com/questions/45941669/what-is-difference-between-class-variable-and-variable-defined-on-class-level", "title": "What is difference between class variable and variable defined on class level", "body": "<p>What is the difference between class variable and variable defined on the class level?</p>\n\n<p>say, bar is defined with <code>@@</code> which means it's a class variable and will be accessible within all methods in class. </p>\n\n<pre><code>class Foo\n  @@bar = 'bar'\nend\n</code></pre>\n\n<p>so does <code>bar</code> without <code>@@</code>, so what is the difference..?</p>\n\n<pre><code>class Foo\n  bar = 'bar'\nend\n</code></pre>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "rails-activerecord"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1504015355, "post_id": 45941091, "comment_id": 78840465, "body": "Can the XML file(s) contain the same element multiple times?"}, {"owner": {"reputation": 7134, "user_id": 1078969, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1ee458f0818af1b8669af687c277c6a1?s=128&d=identicon&r=PG", "display_name": "whites11", "link": "https://stackoverflow.com/users/1078969/whites11"}, "edited": false, "score": 0, "creation_date": 1504015529, "post_id": 45941091, "comment_id": 78840597, "body": "Is there an index for the clause you generate through the <code>where</code> command above?"}], "answers": [{"tags": [], "owner": {"reputation": 2070, "user_id": 1010826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d926cfe6638d33207f97dbd5a5103ba1?s=128&d=identicon&r=PG", "display_name": "Magnuss", "link": "https://stackoverflow.com/users/1010826/magnuss"}, "is_accepted": false, "score": 0, "last_activity_date": 1504019838, "creation_date": 1504019838, "answer_id": 45942778, "question_id": 45941091, "link": "https://stackoverflow.com/questions/45941091/ruby-on-rails-activerecords-first-or-create-is-very-slow/45942778#45942778", "title": "Ruby on rails: ActiveRecords&#39; first_or_create is very slow", "body": "<p><code>first_or_create</code> is of course a convenience method, which doesn't much care about performance on a bigger data set.</p>\n\n<p>Ensure all your indices are in place.</p>\n\n<p>First obvious way to increase performance would be: since every create statement is wrapped in a <code>begin</code>, <code>commit</code> transaction block. Thats 3 queries for one insert.\nYou can place your whole loop inside <code>transaction</code> block - that will gain you some time as it will only execute <code>begin</code> and <code>commit</code> once.</p>\n\n<p>Remember that the roundtrip to/from database takes considerable amount of time, so an obvious performance boost is to combine multiple statements into one. Try to create one <code>SELECT</code> query finding a batch of, let's say 1000 records. DB will return that 200 don't exist and you can go ahead and build one <code>INSERT</code> statement for those 200 queries. </p>\n\n<p>Always perform measurements and always try to formulate what level of performance you are trying to achieve, to not make the code too verbose.</p>\n"}, {"tags": [], "owner": {"reputation": 1016, "user_id": 4500083, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/FfdBQ.gif?s=128&g=1", "display_name": "Mini", "link": "https://stackoverflow.com/users/4500083/mini"}, "is_accepted": false, "score": 0, "last_activity_date": 1504020490, "creation_date": 1504020490, "answer_id": 45942995, "question_id": 45941091, "link": "https://stackoverflow.com/questions/45941091/ruby-on-rails-activerecords-first-or-create-is-very-slow/45942995#45942995", "title": "Ruby on rails: ActiveRecords&#39; first_or_create is very slow", "body": "<p>It's better to eliminate records that need to create.check records if not in the db then create</p>\n"}], "owner": {"reputation": 49, "user_id": 5763726, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/405784620aa0af7abd9f5a8cb38575bb?s=128&d=identicon&r=PG&f=1", "display_name": "leflic", "link": "https://stackoverflow.com/users/5763726/leflic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1504020490, "creation_date": 1504015164, "last_edit_date": 1504020233, "question_id": 45941091, "link": "https://stackoverflow.com/questions/45941091/ruby-on-rails-activerecords-first-or-create-is-very-slow", "title": "Ruby on rails: ActiveRecords&#39; first_or_create is very slow", "body": "<p>I've got a ruby scripts which imports XML files to a MySQL database. It does it by looping through the elements in the XML file and finally</p>\n\n<pre><code>table.where(\n          value:  e['value'],\n          ...\n      ).first_or_create\n</code></pre>\n\n<p>The script has to process a lot of data, most of it is already in the database. Because of this, it runs really slow because first_or_create obviously triggers a lot ot SELECT queries.</p>\n\n<p>Is there any way to handle this more rapidly? Is it related to connection management?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby", "string", "csv", "integer"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1504014590, "post_id": 45940784, "comment_id": 78839865, "body": "What does <code>row[0].codepoints</code> return?"}, {"owner": {"reputation": 41, "user_id": 6441029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8038cd6f652e4e2ae71844434481716d?s=128&d=identicon&r=PG&f=1", "display_name": "100010", "link": "https://stackoverflow.com/users/6441029/100010"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1504014694, "post_id": 45940784, "comment_id": 78839944, "body": "thanks for quick response.  it returns  `  row[0].codepoints =&gt; [65279, 49] `"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1504014831, "post_id": 45940784, "comment_id": 78840039, "body": "Seems like your CSV file contains a <a href=\"https://en.wikipedia.org/wiki/Byte_order_mark\" rel=\"nofollow noreferrer\">BOM</a>"}], "owner": {"reputation": 41, "user_id": 6441029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8038cd6f652e4e2ae71844434481716d?s=128&d=identicon&r=PG&f=1", "display_name": "100010", "link": "https://stackoverflow.com/users/6441029/100010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "closed_date": 1504014934, "answer_count": 0, "score": 0, "last_activity_date": 1504014669, "creation_date": 1504014271, "last_edit_date": 1504014669, "question_id": 45940784, "link": "https://stackoverflow.com/questions/45940784/stringto-i-does-not-work-when-using-string-object-parsed-from-a-csv-file", "closed_reason": "Duplicate", "title": "String#to_i does not work when using string object parsed from a csv file", "body": "<p>I'm using <code>CSV</code> class to read a csv file with Ruby.</p>\n\n<p>Here is my code</p>\n\n<pre><code>CSV.foreach('../../../db/data/xxxx.csv') do |row|\n  # ...\n  row[0].to_i\n  # ...\nend\n</code></pre>\n\n<p>File <code>'../../../db/data/xxxx.csv'</code> surely exists. <code>row[0]</code> returns <code>\"1\"</code>.\nSo I expect <code>row[0].to_i</code> to return <code>1</code>, but <code>row[0].to_i</code> returns <code>0</code>. I thought it is encoding matter of <code>row[0].encoding</code>, but it returns <code>#&lt;Encoding:UTF-8&gt;</code>.</p>\n\n<pre><code>row[0]\n#=&gt; \"1\"\nrow[0].class\n#=&gt; String\nrow[0].encoding\n#=&gt; Encoding:UTF-8\nrow[0] == \"1\"\n#=&gt; false\n</code></pre>\n\n<p>Does anyone help me?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "erb", "acts-as-audited"], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 7482730, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/30bb2b310a2a36eaa1ae263a41424f31?s=128&d=identicon&r=PG&f=1", "display_name": "Nejweti", "link": "https://stackoverflow.com/users/7482730/nejweti"}, "is_accepted": true, "score": 0, "last_activity_date": 1504016871, "creation_date": 1504016871, "answer_id": 45941715, "question_id": 45940277, "link": "https://stackoverflow.com/questions/45940277/rails-how-to-access-two-models-in-a-single-loop/45941715#45941715", "title": "Rails: How to access two models in a single loop", "body": "<p>I solved it this way since both audits and revision has same number of elements.I hope it helps for the others.    </p>\n\n<pre><code>&lt;% @users.each do |user| %&gt;\n      &lt;% user.audits.each_with_index do |audit, i| %&gt;\n        &lt;% if audit.action != \"create\" %&gt;\n        &lt;% user.revisions[i] %&gt;\n        &lt;tr class=\"list-item\"&gt;\n          &lt;td&gt;\n            &lt;%= user.role %&gt;\n          &lt;/td&gt;\n\n          &lt;td&gt;\n            &lt;%= audit.action %&gt;\n          &lt;/td&gt;\n\n          &lt;td&gt;\n            &lt;%= audit.audited_changes %&gt;\n          &lt;/td&gt;\n\n          &lt;td&gt;\n            &lt;%=user.revisions[i].created_at %&gt;\n          &lt;/td&gt;\n\n          &lt;td&gt;\n            &lt;%= user.revisions[i].updated_at %&gt;\n          &lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;% end %&gt;\n      &lt;% end %&gt;\n    &lt;% end %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "is_accepted": false, "score": 0, "last_activity_date": 1504038390, "creation_date": 1504038390, "answer_id": 45947805, "question_id": 45940277, "link": "https://stackoverflow.com/questions/45940277/rails-how-to-access-two-models-in-a-single-loop/45947805#45947805", "title": "Rails: How to access two models in a single loop", "body": "<p>You could also try <a href=\"https://apidock.com/ruby/Array/zip\" rel=\"nofollow noreferrer\">zip</a>: </p>\n\n<pre><code>user.audits.zip(user.revisions) do |audit, revision|\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 7482730, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/30bb2b310a2a36eaa1ae263a41424f31?s=128&d=identicon&r=PG&f=1", "display_name": "Nejweti", "link": "https://stackoverflow.com/users/7482730/nejweti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 45941715, "answer_count": 2, "score": 1, "last_activity_date": 1504038390, "creation_date": 1504012811, "last_edit_date": 1504017070, "question_id": 45940277, "link": "https://stackoverflow.com/questions/45940277/rails-how-to-access-two-models-in-a-single-loop", "title": "Rails: How to access two models in a single loop", "body": "<p>I am using Audited gem to track the changes done on users. What I want to display exactly is the changes made which is the audits with the time they are updated at in a same row.I tried to display it this way but it makes repetitions.</p>\n\n<pre><code>&lt;% @users.each do |user| %&gt;\n  &lt;% user.audits.each do |audit| %&gt;\n    &lt;% if audit.action != \"create\" %&gt;\n    &lt;% user.revisions.each do |revision| %&gt;\n    &lt;tr class=\"list-item\"&gt;\n      &lt;td&gt;\n        &lt;%= user.role %&gt;\n      &lt;/td&gt;\n\n      &lt;td&gt;\n        &lt;%= audit.action %&gt;\n      &lt;/td&gt;\n\n      &lt;td&gt;\n        &lt;%= audit.audited_changes %&gt;\n      &lt;/td&gt;\n\n      &lt;td&gt;\n        &lt;%= revision.created_at %&gt;\n      &lt;/td&gt;\n\n      &lt;td&gt;\n        &lt;%= revision.updated_at %&gt;\n      &lt;/td&gt;\n    &lt;/tr&gt;\n      &lt;% end %&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>What I want is to be able to display them with out displaying a single change multiple times.</p>\n\n<p>I am looking for an expression like </p>\n\n<pre><code>for(i=5,j=3;j&lt;5;i++,j++){\n     ....\n}\n</code></pre>\n\n<p>in rails, to avoid the repetition. Thank you </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1504009506, "post_id": 45938666, "comment_id": 78836007, "body": "<i>Hint:</i> <code>rspec</code> is open source."}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1504010491, "post_id": 45938666, "comment_id": 78836738, "body": "@mudasobwa oh yes I meant to do that. But I was just hoping first if it&#39;d be faster to ask this first before I go diving into the code, and for future readers who might be asking the same question (as it seems that there is no stackoverflow question like this yet). But thank you! :) I&#39;m reading rspec code right now simultaneously."}], "answers": [{"tags": [], "owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "is_accepted": false, "score": 0, "last_activity_date": 1504263574, "last_edit_date": 1504263574, "creation_date": 1504180634, "answer_id": 45980923, "question_id": 45938666, "link": "https://stackoverflow.com/questions/45938666/how-to-track-objects-called-inside-a-block/45980923#45980923", "title": "How to track objects &quot;called&quot; inside a block?", "body": "<p><strong>Disclaimer</strong>: I believe this is just a mediocre solution, but hopefully helps anyone with the same problem.</p>\n\n<p>I tried reading <strong>rspec</strong> source code, but because I couldn't easily comprehend what is happening under the hood, and that it occurred to me that <strong>rspec</strong>'s (i.e.) <code>expect(Book.first).to receive(:title)</code> is different from what I really want because the methods there are already specified (i.e. <code>:title</code>), while what I want is to track ANY methods that are attributes, so because of these two reasons I skipped reading further, and attempted my own solution, which hopefully did somehow work; see below.</p>\n\n<p>Note that I am using <code>Thread</code> local-storage here, so this code should be thread-safe (untested yet).</p>\n\n<pre><code># lib/my_tracker.rb\nclass MyTracker\n  Thread.current[:my_tracker_current_tracked_records] = {}\n\n  attr_accessor :tracked_records\n\n  class &lt;&lt; self\n    def add_to_tracked_records(record, attribute_name)\n      Thread.current[:my_tracker_current_tracked_records][{model: record.class.name.to_sym, record_id: record.id}] ||=  []\n      Thread.current[:my_tracker_current_tracked_records][{model: record.class.name.to_sym, record_id: record.id}] &lt;&lt; attribute_name\n    end\n  end\n\n  def initialize(block)\n    @block = block\n  end\n\n  def call_block_while_tracking_records\n    start_tracking\n\n    @block_evaluated_value = @block.call\n    @tracked_records = Thread.current[:my_tracker_current_tracked_records]\n\n    stop_tracking\n  end\n\n  def to_s\n    @block_evaluated_value\n  end\n\n  # because I am tracking record-attributes, and you might want to track a different object / method, then you'll need to write your own `prepend` extension (look for how to use `prepend` in ruby)\n  module ActiveRecordExtensions\n    def _read_attribute(attribute_name)\n      if Thread.current[:my_tracker_current_tracked_records] &amp;&amp; !Thread.current[:my_tracker_is_tracking_locked] &amp;&amp; self.class &lt; ApplicationRecord\n        # I added this \"lock\" to prevent infinite loop inside `add_to_tracked_records` as I am calling the record.id there, which is then calling this _read_attribute, and then loops.\n        Thread.current[:my_tracker_is_tracking_locked] = true\n        ::MyTracker.add_to_tracked_records(self, attribute_name)\n        Thread.current[:my_tracker_is_tracking_locked] = false\n      end\n      super(attribute_name)\n    end\n  end\n\n  module Helpers\n    def track_records(&amp;block)\n      my_tracker = MyTracker.new(block)\n      my_tracker.call_block_while_tracking_records\n      my_tracker\n    end\n  end\n\n  private\n\n  def start_tracking\n    Thread.current[:my_tracker_current_tracked_records] = {}\n  end\n\n  def stop_tracking\n    Thread.current[:my_tracker_current_tracked_records] = nil\n  end\nend\n\nActiveSupport.on_load(:active_record) do\n  prepend MyTracker::ActiveRecordExtensions\nend\n\nActiveSupport.on_load(:action_view) do\n  include MyTracker::Helpers\nend\n\nActiveSupport.on_load(:action_controller) do\n  include MyTracker::Helpers\nend\n</code></pre>\n\n<h2>Usage Example</h2>\n\n<p><strong>some_controller.rb</strong></p>\n\n<pre><code>book = Book.find_by(id: 1)\nuser = User.find_by(id: 43)\n\nmy_tracker = track_records do\n  book.title\n  if user.created_at == book.created_at\n    puts 'same date'\n  end\n  'thisisthelastlineofthisblockandthereforewillbereturned'\nend\n\nputs my_tracker.class\n# =&gt; #&lt;MyTracker ... &gt;\n\nputs my_tracker.tracked_records\n# =&gt; {\n#      {model: :Book, record_id: 1} =&gt; ['title', 'created_at'],\n#      {model: :User, record_id: 43} =&gt; ['created_at']\n#    }\n\nputs my_tracker\n# =&gt; 'thisisthelastlineofthisblockandthereforewillbereturned'\n# notice that `puts my_tracker` above prints out the block itself\n# this is because I defined `.to_s` above.\n# I need this `.to_s` so I can immediately print the block as-is in the views.\n# see example below\n</code></pre>\n\n<p><strong>some_view.html.erb</strong></p>\n\n<pre><code>&lt;%= track_records { current_user.email } %&gt;\n</code></pre>\n\n<p><em>P.S. Maybe it's better that I wrap this up as a gem. If you're interested, let me know</em> </p>\n"}], "owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504263574, "creation_date": 1504008166, "last_edit_date": 1504008476, "question_id": 45938666, "link": "https://stackoverflow.com/questions/45938666/how-to-track-objects-called-inside-a-block", "title": "How to track objects &quot;called&quot; inside a block?", "body": "<h2>Question:</h2>\n\n<ul>\n<li><p>I need to know the records' attributes that have been called inside a block (say I need something like the following):</p>\n\n<pre><code>def my_custom_method(&amp;block)\n  some_method_that_starts_tracking\n\n  block.call\n\n  some_method_that_stops_tracking\n\n  puts some_method_that_returns_called_records_attributes\n  do_something_about(some_method_that_returns_called_records_attributes)\nend\n\nmy_custom_method { somecodethatcallsauthorofbook1andemailandfirstnameofuser43 }\n\n# this is the `puts` output above (just as an example)\n# =&gt; {\n#      #&lt;Book id:1...&gt;  =&gt; [:author],\n#      #&lt;User id:43...&gt; =&gt; [:email, :first_name]\n#    }\n</code></pre></li>\n<li><p>code inside the block can be anything</p></li>\n<li>Specifically, I meant to track any instance of a subclass of <code>ApplicationRecord</code>, so it can be instance of any models like <code>Book</code>, <code>User</code>, etc...</li>\n</ul>\n\n<h2>Attempts:</h2>\n\n<ul>\n<li><p>From my understanding, this is similar to how <code>rspec</code> works when a method is expected to be called. That it somehow tracks any calls of that method.  So, my initial attempt is to do something like the following (which does not yet fully work):</p>\n\n<pre><code>def my_custom_method(&amp;block)\n  called_records_attributes = {}\n\n  ApplicationRecord.descendants.each do |klass|\n    klass.class_eval do\n      attribute_names.each do |attribute_name|\n        define_method(attribute_name) do\n          called_records_attributes[self] ||= []\n          called_records_attributes[self] &lt;&lt; attribute_name\n          self[attribute_name]\n        end\n      end\n    end\n  end\n\n  block.call\n\n  # the above code will work but at this point, I don't know how to clean the methods that were defined above, as the above define_methods should only be temporary\n\n  puts called_records_attributes\nend\n\nmy_custom_method { Book.find_by(id: 1).title }\n# =&gt; {\n#      #&lt;Book id: 1...&gt; =&gt; ['title']\n#    }\n</code></pre>\n\n<ul>\n<li>the <code>.descendants</code> above probably is not a good idea because Rails use <code>autoload</code> if I'm not mistaken</li>\n<li>as already said above in the comment, I do not know how to remove these \"defined_methods\" that are just supposed to be only temporary for the duration of this \"block\".</li>\n<li>furthermore, my code above would probably have overriden the \"actual\" attribute getters of the models, if ever any has been already defined, which is bad.</li>\n</ul></li>\n</ul>\n\n<h2>Background:</h2>\n\n<ul>\n<li><p>I am writing a gem <a href=\"https://github.com/jrpolidario/live_record/\" rel=\"nofollow noreferrer\">live_record</a> which I am adding a new feature that will allow a developer to just simply write something like</p>\n\n<pre><code>&lt;!-- app/views/application.html.erb --&gt;\n&lt;body&gt;\n  &lt;%= live_record_sync { @book.some_custom_method_about_book } %&gt;\n&lt;/body&gt;\n</code></pre></li>\n</ul>\n\n<p>... which will render <code>@book.some_custom_method_about_book</code> as-is on the page, but at the same time the <code>live_record_sync</code> wrapper method would take note of all the attributes that have been called inside that block (i.e. inside <code>some_custom_method_about_book</code> the <code>@book.title</code> is called), and then it sets these attributes as the block's own \"dependencies\", in which later when that specific book's attribute has been updated, I can already also update directly the HTML page of which this attribute is a \"dependency\" as like specified just above. I am aware that this is not an accurate solution, but I'd like to open up my chances by experimenting on this first.</p>\n\n<p>-- <strong>Rails 5</strong></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3062, "user_id": 2336284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/947703c980ae780c6de4f32ad031ca32?s=128&d=identicon&r=PG", "display_name": "Scott C.", "link": "https://stackoverflow.com/users/2336284/scott-c"}, "edited": false, "score": 0, "creation_date": 1504008227, "post_id": 45938583, "comment_id": 78835114, "body": "What is the issue?  You need to provide more details for anyone to help you."}, {"owner": {"reputation": 35, "user_id": 5826167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3b219166671feaaddf2da1fde65d62a?s=128&d=identicon&r=PG&f=1", "display_name": "Pooja ", "link": "https://stackoverflow.com/users/5826167/pooja"}, "reply_to_user": {"reputation": 3062, "user_id": 2336284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/947703c980ae780c6de4f32ad031ca32?s=128&d=identicon&r=PG", "display_name": "Scott C.", "link": "https://stackoverflow.com/users/2336284/scott-c"}, "edited": false, "score": 0, "creation_date": 1504008929, "post_id": 45938583, "comment_id": 78835606, "body": "I&#39;m not getting exact issue. I&#39;ve added mail credential and domain setting on config/development.rb file. I&#39;m not sure for what I have to add into address and domain when I send mail using dreamhost credential."}], "answers": [{"tags": [], "owner": {"reputation": 360, "user_id": 2899168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d7c5cbd0c2f965a3712ff687c53f997?s=128&d=identicon&r=PG&f=1", "display_name": "aaaaa says reinstate Monica", "link": "https://stackoverflow.com/users/2899168/aaaaa-says-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1504460623, "creation_date": 1504460623, "answer_id": 46026190, "question_id": 45938583, "link": "https://stackoverflow.com/questions/45938583/mail-sending-issue-using-dreamhost-with-ruby-on-rails/46026190#46026190", "title": "Mail sending issue using dreamhost with ruby on rails", "body": "<p>This is my profile I use on Dreamhost</p>\n\n<pre><code>  config.action_mailer.perform_caching = false\n\n  # Ignore bad email addresses and do not raise email delivery errors.\n  # Set this to true and configure the email server for immediate delivery to raise delivery errors.\n  config.action_mailer.raise_delivery_errors = false\n\n  config.action_mailer.delivery_method = :smtp\n  config.action_mailer.default_options = {from: 'notifications@mywebsite.org'}\n  config.action_mailer.smtp_settings = {\n  address:              'sub5.mail.dreamhost.com',\n  port:                 587,\n  domain:               'mywebsite.org',\n  user_name:            'notifications@mywebsite.org',\n  password:             'mypassword',\n  authentication:       :login,\n  enable_starttls_auto: false  }\n</code></pre>\n\n<p>Note that <code>sub5.mail.dreamhost.com</code> is domain-dependent address of your <a href=\"https://help.dreamhost.com/hc/en-us/articles/214918038#Server_names\" rel=\"nofollow noreferrer\">datacenter server</a>.</p>\n\n<p>NB: Password should be hidden into <a href=\"http://rubyrobot.github.io/blog/2014/04/08/secure-rails-deployment-and-passwords-best-practices/\" rel=\"nofollow noreferrer\">ENV variables or other external file outside version control</a></p>\n"}], "owner": {"reputation": 35, "user_id": 5826167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3b219166671feaaddf2da1fde65d62a?s=128&d=identicon&r=PG&f=1", "display_name": "Pooja ", "link": "https://stackoverflow.com/users/5826167/pooja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1505801313, "creation_date": 1504007917, "last_edit_date": 1505801313, "question_id": 45938583, "link": "https://stackoverflow.com/questions/45938583/mail-sending-issue-using-dreamhost-with-ruby-on-rails", "title": "Mail sending issue using dreamhost with ruby on rails", "body": "<p>I'm trying to send mail using using dreamhost credential with ruby on rails. </p>\n\n<p>My development.rb file mail setting as following.</p>\n\n<pre><code>config.action_mailer.smtp_settings = {\n  address: \"dreamhost.com\",\n  port: 587,\n  domain: \"www.dreamhost.com\",\n  authentication: \"plain\",\n  enable_starttls_auto: true,\n  user_name: ENV['mailer'],\n  password: ENV['mailer_password']\n}\n</code></pre>\n\n<p>Mail is not able to send using above mail configuration I'm getting error like Errno::ECONNREFUSED (Connection refused for \"dreamhost.com\" port 587).</p>\n\n<p>Can any one help me for this issue?</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "postgresql"], "answers": [{"tags": [], "owner": {"reputation": 36469, "user_id": 5353753, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8658d889ba478c305810bd346e21da33?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/5353753/sagi"}, "is_accepted": true, "score": 34, "last_activity_date": 1504008392, "last_edit_date": 1504008392, "creation_date": 1504007828, "answer_id": 45938552, "question_id": 45938494, "link": "https://stackoverflow.com/questions/45938494/postgresql-conditional-where-clause/45938552#45938552", "title": "PostgreSQL conditional where clause", "body": "<p>Check if its null OR your condition like this:</p>\n\n<pre><code>WHERE {client_id} IS NULL OR sr.client_id = {client_id}\n</code></pre>\n\n<p>The <code>WHERE</code> clause evaluate as follow: If the variable is empty, then the <code>WHERE</code> clause evaluate to true, and therefore - no filter. If not, it continue to the next condition of the <code>OR</code> </p>\n"}, {"tags": [], "owner": {"reputation": 1250, "user_id": 4988996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-uJinUvIqirs/AAAAAAAAAAI/AAAAAAAAAHY/SCsS0v0eDeA/photo.jpg?sz=128", "display_name": "Furkan Yavuz", "link": "https://stackoverflow.com/users/4988996/furkan-yavuz"}, "is_accepted": false, "score": 1, "last_activity_date": 1547496170, "creation_date": 1547496170, "answer_id": 54188383, "question_id": 45938494, "link": "https://stackoverflow.com/questions/45938494/postgresql-conditional-where-clause/54188383#54188383", "title": "PostgreSQL conditional where clause", "body": "<p>If anyone faced with the <strong>psql operator does not exist: bigint = bytea</strong> issue, here is my workaround:</p>\n\n<pre><code>WHERE ({client_id} &lt; 0 AND sr.client_id &gt; {client_id}) OR sr.client_id = {client_id}\n</code></pre>\n\n<p>Please consider that, client_id generally cannot be negative so you can use that information for eleminating the operation cast issue.</p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 926655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd23a8f6f6bd52b2e14275342085fb4b?s=128&d=identicon&r=PG", "display_name": "Marcin Koziarski", "link": "https://stackoverflow.com/users/926655/marcin-koziarski"}, "is_accepted": false, "score": 1, "last_activity_date": 1558542143, "creation_date": 1558542143, "answer_id": 56261211, "question_id": 45938494, "link": "https://stackoverflow.com/questions/45938494/postgresql-conditional-where-clause/56261211#56261211", "title": "PostgreSQL conditional where clause", "body": "<p>My solution:</p>\n\n<p>I use spring data jpa, native query.</p>\n\n<p>Here is my repository interface signature.\n    <code>\n    @Query(... where (case when 0 in :itemIds then true else i.id in :itemIds end) ...)\n    List&lt;Item&gt; getItems(@Param(\"itemIds) List&lt;Long&gt; itemIds)\n</code></p>\n\n<p>Prior calling this method, I check if \"itemIds\" is null. If yes, I set value to 0L:\n    <code>\n    if(itemIds == null) {\n       itemIds = new ArrayList&lt;Long&gt;();\n       itemIds.add(0L);\n     }\n     itemRepo.getItems(itemIds);\n</code></p>\n\n<p>My IDs starts from 1 so there is no case when ID = 0.</p>\n"}], "owner": {"reputation": 5714, "user_id": 2389501, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/23f6a708c04c660111117c4613592689?s=128&d=identicon&r=PG", "display_name": "Mateusz Urba\u0144ski", "link": "https://stackoverflow.com/users/2389501/mateusz-urba%c5%84ski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10027, "favorite_count": 0, "accepted_answer_id": 45938552, "answer_count": 3, "score": 15, "last_activity_date": 1558542143, "creation_date": 1504007674, "question_id": 45938494, "link": "https://stackoverflow.com/questions/45938494/postgresql-conditional-where-clause", "title": "PostgreSQL conditional where clause", "body": "<p>In my Ruby on Rails app I'm using blazer(<a href=\"https://github.com/ankane/blazer\" rel=\"noreferrer\">https://github.com/ankane/blazer</a>) and I have the following sql query:</p>\n\n<pre><code>SELECT *\nFROM survey_results sr\nLEFT JOIN clients c ON c.id = sr.client_id\nWHERE sr.client_id = {client_id}\n</code></pre>\n\n<p>This query works really well. But I need to add conditional logic to check if client_id variable is present. If yes then I filter by this variable, if not then I not launching this <code>where</code> clause. How can I do it in PostgreSQL?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 6538, "user_id": 430418, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e92dbe16dbf6d5938bd97d561ee7dde4?s=128&d=identicon&r=PG", "display_name": "schmijos", "link": "https://stackoverflow.com/users/430418/schmijos"}, "edited": false, "score": 0, "creation_date": 1504007690, "post_id": 45938249, "comment_id": 78834691, "body": "Are you referring to <a href=\"http://api.rubyonrails.org/classes/ActiveSupport/TimeZone.html#method-i-now\" rel=\"nofollow noreferrer\"><code>now</code></a> instead of <code>new</code>?"}, {"owner": {"reputation": 6538, "user_id": 430418, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e92dbe16dbf6d5938bd97d561ee7dde4?s=128&d=identicon&r=PG", "display_name": "schmijos", "link": "https://stackoverflow.com/users/430418/schmijos"}, "reply_to_user": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1504007978, "post_id": 45938249, "comment_id": 78834919, "body": "@ndn Not on <code>ActiveSupport::TimeZone</code> but on <code>Time</code>, correct?"}, {"owner": {"reputation": 20930, "user_id": 6881240, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dc1e27d7e9a3de2ca8e257cb7c72ff4a?s=128&d=identicon&r=PG&f=1", "display_name": "kabanus", "link": "https://stackoverflow.com/users/6881240/kabanus"}, "edited": false, "score": 0, "creation_date": 1504008738, "post_id": 45938249, "comment_id": 78835488, "body": "I&#39;m voting to close this question as off-topic because it has nothing to do with programming."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1504031541, "post_id": 45938249, "comment_id": 78850533, "body": "How can you think that a non-existing method would do something? I don&#39;t get it."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1504031597, "post_id": 45938249, "comment_id": 78850561, "body": "What is &quot;the standard&quot; that you are mentioning? It is not clear at all."}, {"owner": {"reputation": 14640, "user_id": 380607, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0475394dd283efd42d1ae51379c9ed00?s=128&d=identicon&r=PG", "display_name": "Magne", "link": "https://stackoverflow.com/users/380607/magne"}, "reply_to_user": {"reputation": 6538, "user_id": 430418, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e92dbe16dbf6d5938bd97d561ee7dde4?s=128&d=identicon&r=PG", "display_name": "schmijos", "link": "https://stackoverflow.com/users/430418/schmijos"}, "edited": false, "score": 0, "creation_date": 1504255145, "post_id": 45938249, "comment_id": 78952409, "body": "@schmijos no, I&#39;m not referring to <code>now</code>."}, {"owner": {"reputation": 14640, "user_id": 380607, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0475394dd283efd42d1ae51379c9ed00?s=128&d=identicon&r=PG", "display_name": "Magne", "link": "https://stackoverflow.com/users/380607/magne"}, "reply_to_user": {"reputation": 20930, "user_id": 6881240, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dc1e27d7e9a3de2ca8e257cb7c72ff4a?s=128&d=identicon&r=PG&f=1", "display_name": "kabanus", "link": "https://stackoverflow.com/users/6881240/kabanus"}, "edited": false, "score": 0, "creation_date": 1504255262, "post_id": 45938249, "comment_id": 78952479, "body": "@kabanus Why do you think it has nothing to do with programming? It&#39;s about understanding why Rails deviates from the convention of using <code>.new</code> when instantiating a new object of some particular type."}, {"owner": {"reputation": 14640, "user_id": 380607, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0475394dd283efd42d1ae51379c9ed00?s=128&d=identicon&r=PG", "display_name": "Magne", "link": "https://stackoverflow.com/users/380607/magne"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1504255565, "post_id": 45938249, "comment_id": 78952655, "body": "@sawa The <code>Time.zone.local</code> method exists, but I think it should rather be named <code>Time.zone.new</code>, since the standard is to instantiate new objects by using <code>new</code>."}, {"owner": {"reputation": 20930, "user_id": 6881240, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dc1e27d7e9a3de2ca8e257cb7c72ff4a?s=128&d=identicon&r=PG&f=1", "display_name": "kabanus", "link": "https://stackoverflow.com/users/6881240/kabanus"}, "edited": false, "score": 0, "creation_date": 1504264405, "post_id": 45938249, "comment_id": 78958041, "body": "On second thought perhaps your right, especially seeing the edit and the answer. You did get some heat for this question though, so I guess I wasn&#39;t the only one confused. Removed my close vote."}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1504011308, "post_id": 45939273, "comment_id": 78837341, "body": "It would also imply that <code>Time.zone.new</code> would return an instance of the <code>Time.zone</code> class, i.e. a <code>TimeZone</code> instance instead of a <code>TimeWithZone</code> instance."}], "tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": true, "score": 3, "last_activity_date": 1504009942, "creation_date": 1504009942, "answer_id": 45939273, "question_id": 45938249, "link": "https://stackoverflow.com/questions/45938249/why-is-it-called-time-zone-local-instead-of-time-zone-new/45939273#45939273", "title": "Why is it called &#39;Time.zone.local&#39; instead of &#39;Time.zone.new&#39;?", "body": "<p>Not every method which returns a new value is called <code>new</code>.</p>\n\n<p>In general, it is expected that <code>new</code> is always a method on a class which returns a new instance of said class. With <code>Time.zone.local</code> however, <code>Time.zone</code> is not a class but an instance of <code>ActiveSupport::TimeZone</code>. Defining it as <code>new</code> would be quite misleading since it would imply that <code>Time.zone</code> returns a class and not an object instance.</p>\n\n<p>Thus, <code>ActiveSupport::TimeZone#local</code> is a sensible name for the method to create a new <code>ActiveSupport::TimeWithZone</code> instance in the \"local\" (i.e. chosen) timezone. In the usual Rails context where you would set <code>Time.zone</code> <a href=\"http://api.rubyonrails.org/classes/Time.html#method-c-zone-3D\" rel=\"nofollow noreferrer\">to the current user's timezone</a>, the pattern of calling <code>Time.zone.local(...)</code> thus makes it clear what is happening here: to create a new Time-like object in the user's local timezone.</p>\n"}], "owner": {"reputation": 14640, "user_id": 380607, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0475394dd283efd42d1ae51379c9ed00?s=128&d=identicon&r=PG", "display_name": "Magne", "link": "https://stackoverflow.com/users/380607/magne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 45939273, "answer_count": 1, "score": -5, "last_activity_date": 1504257301, "creation_date": 1504006947, "last_edit_date": 1504257301, "question_id": 45938249, "link": "https://stackoverflow.com/questions/45938249/why-is-it-called-time-zone-local-instead-of-time-zone-new", "title": "Why is it called &#39;Time.zone.local&#39; instead of &#39;Time.zone.new&#39;?", "body": "<p>It seems that <a href=\"http://api.rubyonrails.org/classes/ActiveSupport/TimeZone.html#method-i-local\" rel=\"nofollow noreferrer\"><code>Time.zone.local</code></a> does exactly what you would think <code>Time.zone.new</code> would do. Although, <code>Time.zone.new</code> does not exist. Why does this peculiar naming deviate from the standard?</p>\n\n<p>Update: \nThe question is about understanding why Rails presumably deviates from the convention of using <code>.new</code> when instantiating a new object of some particular type. By using for example <code>Time.zone.local(2013,10,1)</code> instead of i.e. <code>Time.zone.new(2013,10,1)</code> to get a <code>TimeWithZone</code> object.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "pdf", "minimagick"], "answers": [{"tags": [], "owner": {"reputation": 2771, "user_id": 404949, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5d457fe9d0c94a181f7631c3598b4e61?s=128&d=identicon&r=PG", "display_name": "puchu", "link": "https://stackoverflow.com/users/404949/puchu"}, "is_accepted": false, "score": 4, "last_activity_date": 1522015996, "creation_date": 1522015996, "answer_id": 49481527, "question_id": 45937501, "link": "https://stackoverflow.com/questions/45937501/convert-a-pdf-to-png-using-mini-magick-in-ruby-on-rails/49481527#49481527", "title": "Convert a pdf to png using mini_magick in Ruby on Rails", "body": "<pre><code>pdf = MiniMagick::Image.open \"doc.pdf\"\n\nMiniMagick::Tool::Convert.new do |convert|\n  convert.background \"white\"\n  convert.flatten\n  convert.density 150\n  convert.quality 100\n  convert &lt;&lt; pdf.pages.first.path\n  convert &lt;&lt; \"png8:preview.png\"\nend\n</code></pre>\n"}], "owner": {"reputation": 1726, "user_id": 4890595, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-9rPtty8_fOI/AAAAAAAAAAI/AAAAAAAAA0Y/wmx2PYqTMEQ/photo.jpg?sz=128", "display_name": "Code-MonKy", "link": "https://stackoverflow.com/users/4890595/code-monky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3327, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1522015996, "creation_date": 1504004641, "question_id": 45937501, "link": "https://stackoverflow.com/questions/45937501/convert-a-pdf-to-png-using-mini-magick-in-ruby-on-rails", "title": "Convert a pdf to png using mini_magick in Ruby on Rails", "body": "<p><strong>Background</strong></p>\n\n<p>I retrieved a pdf in binary form from an API call:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>base_64_binary_data = @response_label[:generate_label_response][:response_shipments][:response_shipment][:labels][:label][:content]\n\n@pdf_file = File.open('label.pdf', 'wb') do |file|\n  content = Base64.decode64 base_64_binary_data\n  file &lt;&lt; content\nend\n</code></pre>\n\n<p>The above code results in a file that I can look up and is the crystal clear image I need.</p>\n\n<p><strong>Issue</strong></p>\n\n<p>I need to place this image inside a view in order to function as a label on an invoice. </p>\n\n<p>The following seems to be leading to a fine solution:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>@pdf = MiniMagick::Image.new(@pdf_file.path)\n@pdf.pages.first.write(\"preview.png\")\n</code></pre>\n\n<p>It fails on the second line. </p>\n\n<p><strong>MiniMagick::Error</strong><br>\n`identify label.pdf` failed with error:<br>\n...2nd line...</p>\n\n<p>I'd like to work to something like this functioning: </p>\n\n\n"}, {"tags": ["ruby", "syntax-error"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 1, "creation_date": 1504003075, "post_id": 45936916, "comment_id": 78831630, "body": "just missing the <code>end</code>."}, {"owner": {"reputation": 43, "user_id": 8426365, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8e520edf7b6195e162036fefeb826b03?s=128&d=identicon&r=PG&f=1", "display_name": "lucky_charm", "link": "https://stackoverflow.com/users/8426365/lucky-charm"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1504003132, "post_id": 45936916, "comment_id": 78831669, "body": "I&#39;ve already inputted and end, but still it didn&#39;t worked sir"}, {"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1504003182, "post_id": 45936916, "comment_id": 78831690, "body": "<code>unless ... end</code>, please count yours."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1504003247, "post_id": 45936916, "comment_id": 78831720, "body": "The whole snippet just makes no sense. You misunderstand in general how <code>unless</code> works. <code>unless (score&lt;=11) &amp;&amp; (score&gt;=20)</code> is never evaluated to <code>false</code>, neither do others."}, {"owner": {"reputation": 43, "user_id": 8426365, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8e520edf7b6195e162036fefeb826b03?s=128&d=identicon&r=PG&f=1", "display_name": "lucky_charm", "link": "https://stackoverflow.com/users/8426365/lucky-charm"}, "edited": false, "score": 0, "creation_date": 1504003590, "post_id": 45936916, "comment_id": 78831938, "body": "I&#39;ve edited my problem now sir. sorry for being unclear sir"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 8426365, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8e520edf7b6195e162036fefeb826b03?s=128&d=identicon&r=PG&f=1", "display_name": "lucky_charm", "link": "https://stackoverflow.com/users/8426365/lucky-charm"}, "edited": false, "score": 0, "creation_date": 1504003529, "post_id": 45937032, "comment_id": 78831889, "body": "I&#39;m done with the case statement sir, now what I&#39;m trying to do now is to write an unless statement in other words, I want to convert that into unless statement."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 43, "user_id": 8426365, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8e520edf7b6195e162036fefeb826b03?s=128&d=identicon&r=PG&f=1", "display_name": "lucky_charm", "link": "https://stackoverflow.com/users/8426365/lucky-charm"}, "edited": false, "score": 0, "creation_date": 1504003863, "post_id": 45937032, "comment_id": 78832100, "body": "I have updated an answer, but please, do not do that in real projects."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 4, "last_activity_date": 1504003847, "last_edit_date": 1504003847, "creation_date": 1504003322, "answer_id": 45937032, "question_id": 45936916, "link": "https://stackoverflow.com/questions/45936916/how-to-write-unless-statement/45937032#45937032", "title": "How to write &#39;unless&#39; statement", "body": "<p>You are abusing <code>unless</code>. The whole code should be written as:</p>\n\n<pre><code>puts \"Enter number\"\nscore = gets.chomp.to_i\nputs case score\n     when 0..10 then \"you are freshmen\"\n     when 11..20 then \"You are sophomore\"\n     when 21..30 then \"You are Junior\"\n     else \"You are Senior\"\n     end\n</code></pre>\n\n<p><sup>yeah, there is no life after 30</sup></p>\n\n<hr>\n\n<p>Just in case of demonstration purposes (please never use this at home or school)\u2014<code>unless</code>-only version:</p>\n\n<pre><code>puts \"Enter number\"\nscore = gets.chomp.to_i\nputs \"you are freshmen\" unless score &gt; 10\nputs \"You are sophomore\" unless (score &gt; 20 || score &lt;= 10)\nputs \"You are Junior\" unless (score &gt; 30 || score &lt;= 20)\nputs \"You are Senior\" unless score &lt;= 30\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 8426365, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8e520edf7b6195e162036fefeb826b03?s=128&d=identicon&r=PG&f=1", "display_name": "lucky_charm", "link": "https://stackoverflow.com/users/8426365/lucky-charm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "closed_date": 1504013207, "accepted_answer_id": 45937032, "answer_count": 1, "score": 0, "last_activity_date": 1504004142, "creation_date": 1504003015, "last_edit_date": 1504004142, "question_id": 45936916, "link": "https://stackoverflow.com/questions/45936916/how-to-write-unless-statement", "closed_reason": "Needs details or clarity", "title": "How to write &#39;unless&#39; statement", "body": "<p>Here is my code:</p>\n\n<pre><code>puts \"Enter number\"\nscore = gets.chomp.to_i\nunless (score&gt;=10) \n  puts \"you are freshmen\"\nunless (score&lt;=11) &amp;&amp; (score&gt;=20)\n  puts \"You are sophomore\"\nunless (score&gt;=30) &amp;&amp; (score&lt;=21)\n  puts \"You are Junior\"\nelse \n  puts \"You are Senior\"\nend\n</code></pre>\n\n<p>I want to use only one <code>unless</code> statement. How can I do this?</p>\n"}, {"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "edited": false, "score": 0, "creation_date": 1504038746, "post_id": 45935391, "comment_id": 78854238, "body": "As a note: it looks like you need some other specs to depend on artifacts created by this spec - this is a big no no. Can you maybe explain the context why are you trying to do this? It&#39;s very interesting :)"}, {"owner": {"reputation": 127, "user_id": 4011134, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/bFTz5.png?s=128&g=1", "display_name": "mxinden", "link": "https://stackoverflow.com/users/4011134/mxinden"}, "reply_to_user": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "edited": false, "score": 0, "creation_date": 1504253155, "post_id": 45935391, "comment_id": 78951318, "body": "@meta This is a very good hint, but none of my other specs currently depend on this one.  Why do I want to do this? I have a <code>before</code> in the spec that brings up a Kubernetes cluster. Then I test the cluster with multiple <code>it</code> blocks. In case any of the <code>it</code>s fail, I want to run forensic logic to poke at the logs of the machines."}, {"owner": {"reputation": 127, "user_id": 4011134, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/bFTz5.png?s=128&g=1", "display_name": "mxinden", "link": "https://stackoverflow.com/users/4011134/mxinden"}, "reply_to_user": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "edited": false, "score": 0, "creation_date": 1504253176, "post_id": 45935391, "comment_id": 78951324, "body": "@meta would you model this use case differently?"}], "answers": [{"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 4, "last_activity_date": 1504002535, "last_edit_date": 1504002535, "creation_date": 1504001025, "answer_id": 45936219, "question_id": 45935391, "link": "https://stackoverflow.com/questions/45935391/run-cleanup-step-if-any-it-block-failed/45936219#45936219", "title": "Run cleanup step if any it block failed", "body": "<p>Not sure if RSpec provides something out of the box, but this would work:</p>\n\n<pre><code>RSpec.describe 'my describe' do\n  before(:all) do\n    @exceptions = []\n  end\n\n  after(:each) do |example|\n    @exceptions &lt;&lt; example.exception\n  end\n\n  after(:all) do |a|\n    cleanup_logic if @exceptions.any?\n  end\n\n  # ...\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 351, "user_id": 5393035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec1d700d960406976b8e5e212524e91e?s=128&d=identicon&r=PG&f=1", "display_name": "gerrit", "link": "https://stackoverflow.com/users/5393035/gerrit"}, "is_accepted": false, "score": 0, "last_activity_date": 1504004404, "creation_date": 1504004404, "answer_id": 45937417, "question_id": 45935391, "link": "https://stackoverflow.com/questions/45935391/run-cleanup-step-if-any-it-block-failed/45937417#45937417", "title": "Run cleanup step if any it block failed", "body": "<p>I digged a little into the RSpec Code and found a way to monkey patch the RSpec Reporter class. Put this into your spec_helper.rb:</p>\n\n<pre><code>class RSpecHook\n  class &lt;&lt; self\n    attr_accessor :hooked\n  end\n\n  def example_failed(example)\n    # Code goes here\n  end\nend\n\nmodule FailureDetection\n  def register_listener(listener, *notifications)\n    super\n    return if ::RSpecHook.hooked\n    @listeners[:example_failed] &lt;&lt; ::RSpecHook.new\n    ::RSpecHook.hooked = true\n  end\nend\n\nRSpec::Core::Reporter.prepend FailureDetection\n</code></pre>\n\n<p>Of course it gets a little more complex if you wish to execute different callbacks depending on the spec you're running at the moment.</p>\n\n<p>Anyway, this way you do not have to mess up your testing code with exceptions or counters to detect failures.</p>\n"}], "owner": {"reputation": 127, "user_id": 4011134, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/bFTz5.png?s=128&g=1", "display_name": "mxinden", "link": "https://stackoverflow.com/users/4011134/mxinden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 45936219, "answer_count": 2, "score": 0, "last_activity_date": 1504004404, "creation_date": 1503998823, "question_id": 45935391, "link": "https://stackoverflow.com/questions/45935391/run-cleanup-step-if-any-it-block-failed", "title": "Run cleanup step if any it block failed", "body": "<p>When one of my <code>it</code> blocks fails, I <strong>want</strong> to run a cleanup step. When all of the <code>it</code> blocks succeed I <strong>don't want</strong> to run the cleanup step.</p>\n\n<pre><code>RSpec.describe 'my describe' do\n    it 'first it' do\n        logic_that_might_fail\n    end\n\n    it 'second it' do\n        logic_that_might_fail\n    end\n\n    after(:all) do\n        cleanup_logic if ONE_OF_THE_ITS_FAILED\n    end\nend\n</code></pre>\n\n<p>How do I implement <code>ONE_OF_THE_ITS_FAILED</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 7134, "user_id": 1078969, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1ee458f0818af1b8669af687c277c6a1?s=128&d=identicon&r=PG", "display_name": "whites11", "link": "https://stackoverflow.com/users/1078969/whites11"}, "edited": false, "score": 2, "creation_date": 1503999086, "post_id": 45935384, "comment_id": 78828912, "body": "Why are you running the <code>test</code> environment? I guess this is the cause, just remove the <code>-e test</code> flag and run in development mode, code will be autoreloaded."}], "answers": [{"tags": [], "owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "is_accepted": false, "score": 2, "last_activity_date": 1503999374, "creation_date": 1503999374, "answer_id": 45935604, "question_id": 45935384, "link": "https://stackoverflow.com/questions/45935384/ruby-on-rails-launch-server-with-code-reload/45935604#45935604", "title": "Ruby on rails : launch server with code reload", "body": "<p><code>test</code> is only designed for automated testing, with Rails running for a single test run. Since code should not be changing during a test case, it doesnt have many of the development mode features and is more like production in that regard. Its also intended to reset your database when running tests, which also doesnt seem to be your intention.</p>\n\n<p>If you want (most) classes to auto-reload, always use the <code>development</code> environment.</p>\n\n<p>If for some reason you need a different environment (more than just port, but different configs), you can look at creating a new environment, copying the configs for <code>development</code> (add new entries to <code>config/environments/</code>, <code>config/database.yml</code>, <code>config/secrets.yml</code>, and use as a group in the <code>Gemfile</code>.).</p>\n"}], "owner": {"reputation": 3247, "user_id": 2304517, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Wv4Xe.png?s=128&g=1", "display_name": "Xero", "link": "https://stackoverflow.com/users/2304517/xero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1503999374, "creation_date": 1503998801, "question_id": 45935384, "link": "https://stackoverflow.com/questions/45935384/ruby-on-rails-launch-server-with-code-reload", "title": "Ruby on rails : launch server with code reload", "body": "<p>I'm using a server for testing my api. I use this command to launch the server :</p>\n\n<pre><code>rails s -p 3001 -e test -P 42342\n</code></pre>\n\n<p>I change the port to 3001, to not have a conflict with my dev server (on port 3000).\nThe thing is that when I change code, the server don't reload the code, I have to kill the server and relaunch.</p>\n\n<p>Is there a parameters that I miss to launch my rails command ?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 1, "creation_date": 1503998402, "post_id": 45935120, "comment_id": 78828462, "body": "<code>attr_accessor :count</code> defines attributes acces for instance variables."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1503999394, "post_id": 45935120, "comment_id": 78829124, "body": "If you&#39;re using a recent ruby, <code>include</code> is no longer a private method.  Which means, no need to <code>send</code> it. Just <code>base.include InstanceMethods</code>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1504000892, "post_id": 45935120, "comment_id": 78830149, "body": "<code>initialize</code> is by default private, so you can omit the explicit <code>private</code> in <code>Foo</code>."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1504003084, "post_id": 45935120, "comment_id": 78831640, "body": "@Stefan: I&#39;ll be damned, it IS private. It hasn&#39;t occurred to me until now :)"}, {"owner": {"reputation": 175, "user_id": 7930720, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zrzBz.jpg?s=128&g=1", "display_name": "D.K.S", "link": "https://stackoverflow.com/users/7930720/d-k-s"}, "edited": false, "score": 0, "creation_date": 1504151698, "post_id": 45935120, "comment_id": 78904707, "body": "Sergio thanks for the tip about base.include :-)"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1503999531, "post_id": 45935488, "comment_id": 78829212, "body": "That&#39;s a possibility, yes."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 4, "last_activity_date": 1503999032, "creation_date": 1503999032, "answer_id": 45935488, "question_id": 45935120, "link": "https://stackoverflow.com/questions/45935120/class-instance-variable-initialize-in-extended-module/45935488#45935488", "title": "Class instance variable initialize in extended module", "body": "<p>You could move the variable initialization into the <code>included</code> callback:</p>\n\n<pre><code>module MyModule\n  def self.included(base)\n    base.extend ClassMethods\n    base.include InstanceMethods\n    base.count = 0\n  end\n\n  module ClassMethods\n    attr_accessor :count\n  end\n\n  module InstanceMethods\n    def register\n      self.class.count += 1\n    end\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 175, "user_id": 7930720, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zrzBz.jpg?s=128&g=1", "display_name": "D.K.S", "link": "https://stackoverflow.com/users/7930720/d-k-s"}, "edited": false, "score": 0, "creation_date": 1504151414, "post_id": 45935550, "comment_id": 78904645, "body": "I got this: NoMethodError: undefined method `+&#39; for nil:NilClass"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 175, "user_id": 7930720, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zrzBz.jpg?s=128&g=1", "display_name": "D.K.S", "link": "https://stackoverflow.com/users/7930720/d-k-s"}, "edited": false, "score": 0, "creation_date": 1504169791, "post_id": 45935550, "comment_id": 78913203, "body": "@D.K.S Must be you didn&#39;t copy my code exactly. Or you changed something else in the other code."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 3, "last_activity_date": 1503999231, "creation_date": 1503999231, "answer_id": 45935550, "question_id": 45935120, "link": "https://stackoverflow.com/questions/45935120/class-instance-variable-initialize-in-extended-module/45935550#45935550", "title": "Class instance variable initialize in extended module", "body": "<p>One bit too many <code>self</code> in your code. You already <code>extend</code> your <code>ClassMethods</code> module. <code>extend</code> uses instance methods, not class methods. So your module should look like this (rest of the code unchanged).</p>\n\n<pre><code>module ClassMethods\n\n  def count\n    @count ||= 0\n  end\n\n  attr_writer :count\nend\n</code></pre>\n\n<p>Then it works</p>\n\n<pre><code>Foo.count # =&gt; 0\nFoo.new\nFoo.count # =&gt; 1\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 7930720, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zrzBz.jpg?s=128&g=1", "display_name": "D.K.S", "link": "https://stackoverflow.com/users/7930720/d-k-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 45935488, "answer_count": 2, "score": 0, "last_activity_date": 1503999231, "creation_date": 1503998110, "question_id": 45935120, "link": "https://stackoverflow.com/questions/45935120/class-instance-variable-initialize-in-extended-module", "title": "Class instance variable initialize in extended module", "body": "<p>I know there is should be a way to initialize class instance variable that added by a module via extend\nexample:</p>\n\n<pre><code>module MyModule\n  def self.included(base)\n    base.extend ClassMethods\n    base.send :include, InstanceMethods\n  end\n\n  module ClassMethods\n    attr_accessor :count\n\n    def self.count\n      @count = 0\n    end\n\n    count\n  end\n\n  module InstanceMethods\n    def register\n      # self.class.count = 0 if self.class.count.nil?\n      self.class.count += 1\n    end\n  end\nend\n\nclass Foo\n  include MyModule\n\n  private\n\n  def initialize\n    register\n  end\n\nend\n</code></pre>\n\n<p>In ClassMethods should be a way to initialize count, but i always catch error \"undefined method `+' for nil:NilClass\"\nWhen i perform</p>\n\n<pre><code>f = Foo.new\n</code></pre>\n\n<p>No problem in module InstanceMethods if i uncomment line </p>\n\n<pre><code># self.class.count = 0 if self.class.count.nil?\n</code></pre>\n\n<p>Work correctly!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1503992727, "post_id": 45933378, "comment_id": 78824997, "body": "Since an amount of records is relatively small, one might use <a href=\"https://ruby-doc.org/core/Array.html#method-i-shuffle\" rel=\"nofollow noreferrer\"><code>Array#shuffle</code></a>."}, {"owner": {"reputation": 776, "user_id": 3404788, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a2552fcfb7f6aa5bd565d56c74d0a7b9?s=128&d=identicon&r=PG&f=1", "display_name": "Saadia", "link": "https://stackoverflow.com/users/3404788/saadia"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1503992814, "post_id": 45933378, "comment_id": 78825057, "body": "Wont that break the order by date? each source has over 20 records and there are 4 sources involved, the data is fetched every day and it is displayed for last 6 months so the data is pretty huge"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1503992942, "post_id": 45933378, "comment_id": 78825140, "body": "There is no way to magically sort the data from different sources. If you want to preserve a date/time order, join everything into a single array and use <a href=\"https://ruby-doc.org/core/Array.html#method-i-sort\" rel=\"nofollow noreferrer\"><code>Array#sort</code></a>."}, {"owner": {"reputation": 776, "user_id": 3404788, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a2552fcfb7f6aa5bd565d56c74d0a7b9?s=128&d=identicon&r=PG&f=1", "display_name": "Saadia", "link": "https://stackoverflow.com/users/3404788/saadia"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1503993098, "post_id": 45933378, "comment_id": 78825244, "body": "I am not looking for a magical way either :) if I use the shuffle how can i retain the date? I am guessing that will be another loop in the view?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1503995746, "post_id": 45933378, "comment_id": 78826819, "body": "@Saadia <i>&quot;if I use the shuffle how can i retain the date&quot;</i> \u2013 that&#39;s easy: group the records by date and shuffle each group on its own. If you want get the same (random) result each time, you could seed the RNG with a value unique to that group."}, {"owner": {"reputation": 776, "user_id": 3404788, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a2552fcfb7f6aa5bd565d56c74d0a7b9?s=128&d=identicon&r=PG&f=1", "display_name": "Saadia", "link": "https://stackoverflow.com/users/3404788/saadia"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1503995915, "post_id": 45933378, "comment_id": 78826911, "body": "@Stefan thanks, I was thinking the same, i am now looking for an example"}, {"owner": {"reputation": 1553, "user_id": 4149820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb809f7e739416524f3c380fe8f4fe45?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/4149820/thomas"}, "edited": false, "score": 0, "creation_date": 1504007067, "post_id": 45933378, "comment_id": 78834255, "body": "You can also change the order clause to &#39;DATE(created_at) desc, RAND()&#39; but you will need to have a date aware pagination to make sure you retreive all records for a given date at once"}, {"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "edited": false, "score": 0, "creation_date": 1504038927, "post_id": 45933378, "comment_id": 78854333, "body": "There&#39;s no rails method to do such thing, which DB are you using?"}], "answers": [{"tags": [], "owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "is_accepted": false, "score": 0, "last_activity_date": 1504040385, "creation_date": 1504040385, "answer_id": 45948239, "question_id": 45933378, "link": "https://stackoverflow.com/questions/45933378/rails-randomise-record-but-retain-the-order-by-date/45948239#45948239", "title": "Rails - Randomise record but retain the order by date", "body": "<p>If you're using postgresql you could do something like </p>\n\n<pre><code>Stats.select('*, random() as random')\n  .order('date(created_at) ASC')\n  .order('random ASC')\n</code></pre>\n\n<p>If you provide more than one order statement to your SQL it'll order the data with using the first column (in this case <code>created_at</code> casted to date) and if any of those values are the same (and this is what we wanted, and caused by casting <code>created_at</code> to dates) the second order will be used.</p>\n\n<p>But! Every time your page is refreshed - you can see different results and that's confusing and really bad UX. </p>\n\n<p>So I would recommend adding one new column (called for example <code>random</code>) and assigning random number on creation. Then you can just do: </p>\n\n<pre><code>Stats.order('date(created_at) ASC').order('random ASC')\n</code></pre>\n\n<p>One last problem is that it's not DB agnostic (this <code>date</code> function may not be available in other DBMS).</p>\n\n<p>To fix that - add one more column, called <code>created_on</code> with type <code>date</code>, make sure you write the date on save and you're good to go:</p>\n\n<pre><code>Stats.order(created_on: :asc, random: :asc)\n</code></pre>\n\n<p>So, as you can see - you can trade some complexities in query for some complexity with <code>after_save</code> or <code>before_save</code> callbacks and some space in DB. You can decide if it's a good trade-off. </p>\n"}], "owner": {"reputation": 776, "user_id": 3404788, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a2552fcfb7f6aa5bd565d56c74d0a7b9?s=128&d=identicon&r=PG&f=1", "display_name": "Saadia", "link": "https://stackoverflow.com/users/3404788/saadia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504040385, "creation_date": 1503992455, "last_edit_date": 1503993007, "question_id": 45933378, "link": "https://stackoverflow.com/questions/45933378/rails-randomise-record-but-retain-the-order-by-date", "title": "Rails - Randomise record but retain the order by date", "body": "<p>I am pulling data into database from 4 different sources and when they are saved they get assigned <code>created_at</code> by rails.</p>\n\n<p>When I am displaying the data I want to display the latest records first so I am using the following code to fetch the records by <code>created_at desc</code> and with the help of gem <code>kaminari</code> records are displayed via pagination.</p>\n\n<pre><code>@stats = Stats.page(params[:page]).order('created_at desc').per(10)\n</code></pre>\n\n<p>The problem I am facing with this approach is not all sources get equal exposure for example since <code>source A</code> data got pulled first and then the <code>source B</code> data got pulled second on same day, on the website all records of source A will be displayed first and then all records of source B will appear.</p>\n\n<p>So my question is, how can I display the records by date and randomize the records for that date so all sources can get equal exposure. Is there an in build rails function that can help in this? If not then what is the best way to achieve the outcome I am looking for? Something like this</p>\n\n<pre><code>Date (August 29th)\nRecord 1 -  (Belonging to Source A)\nRecord 2 -  (Belonging to Source E)\nRecord 3 -  (Belonging to Source D)\nRecord 4 -  (Belonging to Source B)\nRecord 5 -  (Belonging to Source E)\nRecord 6 -  (Belonging to Source D)\nRecord 7 -  (Belonging to Source A)\n\n\n\nDate (August 28th)\nRecord 1 -  (Belonging to Source E)\nRecord 2 -  (Belonging to Source D)\nRecord 3 -  (Belonging to Source A)\nRecord 4 -  (Belonging to Source B)\nRecord 5 -  (Belonging to Source A)\nRecord 6 -  (Belonging to Source D)\nRecord 7 -  (Belonging to Source A)\n\n\n...\n...\n...\n</code></pre>\n\n<p>These records are displayed for last 6 months</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord", "rails-activerecord"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1503992171, "post_id": 45933237, "comment_id": 78824624, "body": "What is timestame? What is the difference between ISO and iso? What is ts? What is the difference between iso8601 and ISO8601?"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1503992332, "post_id": 45933237, "comment_id": 78824718, "body": "What is the iso format that is not ISO8601, which you want the formatting to be?"}, {"owner": {"reputation": 2343, "user_id": 4033050, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/8617552b81048f6c4b67c9ec04f413b1?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/4033050/seb"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1503992623, "post_id": 45933237, "comment_id": 78824918, "body": "@sawa ISO8601 look like : &quot;2017-08-29T05:58:44.488Z&quot; and ISO used by Postgres Db looks like : &quot;2017-08-28 20:14:45.684926+00&quot;"}, {"owner": {"reputation": 2343, "user_id": 4033050, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/8617552b81048f6c4b67c9ec04f413b1?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/4033050/seb"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1503992729, "post_id": 45933237, "comment_id": 78825000, "body": "@sawa in postgres, timestamp is used to define the date/time at which you have created an element"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1503992802, "post_id": 45933237, "comment_id": 78825050, "body": "\u201cAny idea?\u201d is not a valid question here on SO."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1503993185, "post_id": 45933237, "comment_id": 78825300, "body": "@Sep I didn&#39;t ask what timestamp is, I asked what timestame is."}, {"owner": {"reputation": 2343, "user_id": 4033050, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/8617552b81048f6c4b67c9ec04f413b1?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/4033050/seb"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1503993277, "post_id": 45933237, "comment_id": 78825354, "body": "@sawa it&#39;s a typo issue in the title"}], "answers": [{"comments": [{"owner": {"reputation": 2343, "user_id": 4033050, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/8617552b81048f6c4b67c9ec04f413b1?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/4033050/seb"}, "edited": false, "score": 0, "creation_date": 1503995616, "post_id": 45933990, "comment_id": 78826737, "body": "PG class is returning the formatting as PostGres standard which is &quot;2017-08-28 20:14:45.684926+00&quot;. ActiveRecords follow the formatting ISO8601. using the strftime means I will have to parse each item of the array to change the format and it&#39;s time consuming JSON parsing is not a fast process. Or in that case, is there a way to directly format the result ActiveRecords called such as ts.format or strftime(ts)..."}, {"owner": {"reputation": 3120, "user_id": 4768939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ce32086ddcf416c2218348c3756352b?s=128&d=identicon&r=PG&f=1", "display_name": "valentin", "link": "https://stackoverflow.com/users/4768939/valentin"}, "reply_to_user": {"reputation": 2343, "user_id": 4033050, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/8617552b81048f6c4b67c9ec04f413b1?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/4033050/seb"}, "edited": false, "score": 0, "creation_date": 1503997413, "post_id": 45933990, "comment_id": 78827827, "body": "your ts is not string it is an instance of datetime or something  equivalent. the way in which is displayed  is not how is stored. if you want it to convert to string yo can convert with strftime and give the format which you want."}, {"owner": {"reputation": 2343, "user_id": 4033050, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/8617552b81048f6c4b67c9ec04f413b1?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/4033050/seb"}, "edited": false, "score": 0, "creation_date": 1504001489, "post_id": 45933990, "comment_id": 78830534, "body": "is it possible to make it displayed as it&#39;s stored. ? I am not familiar with strftime. can you add an example to get a format like: &quot;2017-08-28 20:14:45.684926+00&quot;"}, {"owner": {"reputation": 3120, "user_id": 4768939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ce32086ddcf416c2218348c3756352b?s=128&d=identicon&r=PG&f=1", "display_name": "valentin", "link": "https://stackoverflow.com/users/4768939/valentin"}, "reply_to_user": {"reputation": 2343, "user_id": 4033050, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/8617552b81048f6c4b67c9ec04f413b1?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/4033050/seb"}, "edited": false, "score": 0, "creation_date": 1504002330, "post_id": 45933990, "comment_id": 78831134, "body": "probable you want something like <code>ts.strftime(&quot;%F %T.%L%z&quot;)</code> (doc <a href=\"https://apidock.com/ruby/DateTime/strftime\" rel=\"nofollow noreferrer\">apidock.com/ruby/DateTime/strftime</a>)"}], "tags": [], "owner": {"reputation": 3120, "user_id": 4768939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ce32086ddcf416c2218348c3756352b?s=128&d=identicon&r=PG&f=1", "display_name": "valentin", "link": "https://stackoverflow.com/users/4768939/valentin"}, "is_accepted": false, "score": 1, "last_activity_date": 1503995129, "last_edit_date": 1503995129, "creation_date": 1503994526, "answer_id": 45933990, "question_id": 45933237, "link": "https://stackoverflow.com/questions/45933237/activerecords-display-iso8601-timestamp/45933990#45933990", "title": "ActiveRecords display ISO8601 timestamp", "body": "<p>I think there are some misunderstandings here:</p>\n\n<ol>\n<li><p>Postgres uses ISO 8601 for output (the so called ISO, they are not different standards) <a href=\"https://www.postgresql.org/docs/9.6/static/datatype-datetime.html\" rel=\"nofollow noreferrer\">https://www.postgresql.org/docs/9.6/static/datatype-datetime.html</a></p></li>\n<li><p>ActiveRecord, I assume, returns an instance of <code>DateTime</code> class or something similar, and not a string in that format.</p></li>\n<li><p>What you see is only a format used for displaying; you can use <code>strftime</code> to display the data in another format.</p></li>\n</ol>\n"}], "owner": {"reputation": 2343, "user_id": 4033050, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/8617552b81048f6c4b67c9ec04f413b1?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/4033050/seb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1503995129, "creation_date": 1503991934, "last_edit_date": 1503993256, "question_id": 45933237, "link": "https://stackoverflow.com/questions/45933237/activerecords-display-iso8601-timestamp", "title": "ActiveRecords display ISO8601 timestamp", "body": "<p>I do have a postgres DB which contains a timestamp. This timestamp follow the ISO standard and looks like:</p>\n\n<pre><code>2017-08-28 20:14:45.684926+00\n</code></pre>\n\n<p>I have used ActiveRecord to access the DB from Ruby/Sinatra environment but the ts returned is ISO8601. </p>\n\n<p>Is there a way to force the formatting to ISO and not ISO8601 ?</p>\n\n<p>I would like to avoid parsing the data once received.</p>\n\n<p>Right now, I am using the command:</p>\n\n<pre><code>class ApiResponse &lt; ActiveRecord::Base\n\n  class &lt;&lt; self\n\n    def send_query(user, params)\n\n      limit = params.include?('limit') ? params['limit'] : 50\n\n      where_params = {\n          userid: user,\n          allowed_intent: true\n      }\n\n      ApiResponse.select([:id, :ts, :userid, :intent, :response])\n          .where(where_params)\n          .order(ts: :desc)\n          .limit(limit).to_a\n\n    end\nend\n</code></pre>\n\n<p>The ApiResponse class is used to access the DB through ActiveRecord and it works fine. but the format is not correct. it shows : </p>\n\n<pre><code>2017-08-29T05:58:44.488Z\n</code></pre>\n\n<p>instead of something like</p>\n\n<pre><code>2017-08-28 20:14:45.684926+00\n</code></pre>\n\n<p>This format ISO is the one in the db </p>\n\n<p>Any idea how to get the timestamp ts correctly formated as I expect inside the ActiveRecord call?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 6, "creation_date": 1503991214, "post_id": 45932937, "comment_id": 78824051, "body": "Because <code>for i in self</code> returns <code>self</code>."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 7588336, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/58dab16baa91c299f9428862fc57fc46?s=128&d=identicon&r=PG&f=1", "display_name": "roppo", "link": "https://stackoverflow.com/users/7588336/roppo"}, "edited": false, "score": 0, "creation_date": 1503991720, "post_id": 45933046, "comment_id": 78824357, "body": "Thanks (answered) :)"}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 3, "last_activity_date": 1503991304, "creation_date": 1503991304, "answer_id": 45933046, "question_id": 45932937, "link": "https://stackoverflow.com/questions/45932937/why-does-my-code-return-the-receiver/45933046#45933046", "title": "Why does my code return the receiver?", "body": "<blockquote>\n  <p>why does the code still return self even though I did not explicitly return self on the last line?</p>\n</blockquote>\n\n<p>If you don't specify a return value explicitly, a method will return the last expression evaluated. The last expression in your method is the <code>for</code> loop.</p>\n\n<p>From its <a href=\"http://ruby-doc.org/core-2.4.1/doc/syntax/control_expressions_rdoc.html#label-for+Loop\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n\n<blockquote>\n  <p>The result value of a <code>for</code> loop is the value iterated over unless <code>break</code> is used.</p>\n</blockquote>\n\n<p>Examples:</p>\n\n<pre><code>for i in 1..10\nend\n#=&gt; 1..10\n\nfor i in [1, 2, 3]\nend\n#=&gt; [1, 2, 3]\n\nfor i in [1, 2, 3]\n  break :foo\nend\n#=&gt; :foo\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 7588336, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/58dab16baa91c299f9428862fc57fc46?s=128&d=identicon&r=PG&f=1", "display_name": "roppo", "link": "https://stackoverflow.com/users/7588336/roppo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 45933046, "answer_count": 1, "score": -1, "last_activity_date": 1503991915, "creation_date": 1503990939, "last_edit_date": 1503991915, "question_id": 45932937, "link": "https://stackoverflow.com/questions/45932937/why-does-my-code-return-the-receiver", "title": "Why does my code return the receiver?", "body": "<p>I am implementing the <code>each</code> method on my own. I am supposed to explicitly return <code>self</code> before closing the method. This is my code:</p>\n\n<pre><code>module Enumerable \n  def my_each\n    for i in self\n      yield i\n    end\n    #self\n  end\nend\n\n[1,2,3,4].my_each {|x| x + 1} # =&gt; [1,2,3,4]\n</code></pre>\n\n<p>Why does the code still return the receiver even though I did not explicitly return <code>self</code> on the last line?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "plugins", "rails-upgrade"], "comments": [{"owner": {"reputation": 322, "user_id": 2067375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd805bbb6862aa2fc7166a3372119e0c?s=128&d=identicon&r=PG", "display_name": "Rada Bogdan", "link": "https://stackoverflow.com/users/2067375/rada-bogdan"}, "edited": false, "score": 0, "creation_date": 1504045622, "post_id": 45932881, "comment_id": 78857075, "body": "You don&#39;t have to put them in lib . You can just copy them to a folder &#39;engines&#39; and then in Gemfile You can load them. like this : gem &#39;autocomplete&#39;, path: &#39;engines/autocomplete&#39;. No need to modify the gems ."}, {"owner": {"reputation": 508, "user_id": 5023291, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/anlQX.jpg?s=128&g=1", "display_name": "Anoob K Bava", "link": "https://stackoverflow.com/users/5023291/anoob-k-bava"}, "reply_to_user": {"reputation": 322, "user_id": 2067375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd805bbb6862aa2fc7166a3372119e0c?s=128&d=identicon&r=PG", "display_name": "Rada Bogdan", "link": "https://stackoverflow.com/users/2067375/rada-bogdan"}, "edited": false, "score": 0, "creation_date": 1504075613, "post_id": 45932881, "comment_id": 78865251, "body": "@RadaBogdan, Could not find gem &#39;auto_complete (&gt;= 0) ruby&#39; in source at .Source does not contain any versions of &#39;auto_complete (&gt;= 0) ruby&#39;"}, {"owner": {"reputation": 322, "user_id": 2067375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd805bbb6862aa2fc7166a3372119e0c?s=128&d=identicon&r=PG", "display_name": "Rada Bogdan", "link": "https://stackoverflow.com/users/2067375/rada-bogdan"}, "edited": false, "score": 0, "creation_date": 1504218893, "post_id": 45932881, "comment_id": 78942202, "body": "What do You mean? Maybe If You could explain in words what You did i could help. instead of just copy-pasting an error without giving any details . So could You please give me more details?"}, {"owner": {"reputation": 508, "user_id": 5023291, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/anlQX.jpg?s=128&g=1", "display_name": "Anoob K Bava", "link": "https://stackoverflow.com/users/5023291/anoob-k-bava"}, "reply_to_user": {"reputation": 322, "user_id": 2067375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd805bbb6862aa2fc7166a3372119e0c?s=128&d=identicon&r=PG", "display_name": "Rada Bogdan", "link": "https://stackoverflow.com/users/2067375/rada-bogdan"}, "edited": false, "score": 0, "creation_date": 1504281219, "post_id": 45932881, "comment_id": 78968754, "body": "Sorry,  i have moved the plugin and created a folder called engines inside project root folder. Then added this line  gem &#39;autocomplete&#39;, path: &#39;engines/autocomplete. then done the bundle install. now i got the above error."}, {"owner": {"reputation": 322, "user_id": 2067375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd805bbb6862aa2fc7166a3372119e0c?s=128&d=identicon&r=PG", "display_name": "Rada Bogdan", "link": "https://stackoverflow.com/users/2067375/rada-bogdan"}, "edited": false, "score": 0, "creation_date": 1504293261, "post_id": 45932881, "comment_id": 78974329, "body": "Well it seems You have made a mistake somewhere...dont know where...because You didn&#39;t share with me the backtrace....you wrote somewhere &#39;auto_complete&#39; instead of &#39;autocomplete&#39; . Please check your code again. Probably you gave the wrong name either in gemspec or Gemfile."}], "owner": {"reputation": 508, "user_id": 5023291, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/anlQX.jpg?s=128&g=1", "display_name": "Anoob K Bava", "link": "https://stackoverflow.com/users/5023291/anoob-k-bava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 2, "answer_count": 0, "score": 1, "last_activity_date": 1503990706, "creation_date": 1503990706, "question_id": 45932881, "link": "https://stackoverflow.com/questions/45932881/migration-from-rails-3-1-to-3-2-with-plugins-and-fix-the-deprecation-warnings", "title": "migration from rails 3.1 to 3.2 with plugins and fix the deprecation warnings", "body": "<p>I am working in a project with Ruby version 1.9.3 and Rails Version 3.1.12. Planning to Migrate the rails Version  to 3.2.The issue encountered is with plugins; we have 6 plugins namely, </p>\n\n<ul>\n<li>autocomplete</li>\n<li>filter</li>\n<li>has_details</li>\n<li>in_place_editing</li>\n<li>restful-authentication</li>\n<li>role_requirement</li>\n</ul>\n\n<p>I was able to upgrade the Gemfile in Dev, But the show stopper found is the plugins, using this doc,\n <a href=\"http://matt.coneybeare.me/how-to-convert-simple-rails-23-style-plugins/\" rel=\"nofollow noreferrer\">http://matt.coneybeare.me/how-to-convert-simple-rails-23-style-plugins/</a></p>\n\n<p>I was able to convert the autocomplete to include in the lib/. The main issue is with the others. Rest of them contains some files called</p>\n\n<blockquote>\n  <p>install.rb, Rakefile, templates folders.</p>\n</blockquote>\n\n<p>is there any way to remove these deprecation warnings, So far, we do not have much test coverage only a low amount.Any Help is appreciated. TIA.</p>\n\n<blockquote>\n  <p>DEPRECATION WARNING: You have Rails 2.3-style plugins in\n  vendor/plugins! Support for these plugins will be removed in Rails\n  4.0. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See\n  the release notes for more on this:\n  <a href=\"http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released\" rel=\"nofollow noreferrer\">http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released</a>.\n  (called from  at\n  /home/rmed176lt/ror/revremit/config/environment.rb:6)</p>\n</blockquote>\n\n<p>If anybody wants to view the plugin code, Please visit\n<a href=\"https://github.com/anoobbava/plugins\" rel=\"nofollow noreferrer\">https://github.com/anoobbava/plugins</a></p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2635, "user_id": 1177575, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/147cbbdcb918ccf00a5d662d9e3077ad?s=128&d=identicon&r=PG", "display_name": "Abibullah Rahamathulah", "link": "https://stackoverflow.com/users/1177575/abibullah-rahamathulah"}, "edited": false, "score": 0, "creation_date": 1503988764, "post_id": 45932261, "comment_id": 78822616, "body": "Downvote it with an explanation pls."}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 5, "creation_date": 1503989064, "post_id": 45932261, "comment_id": 78822786, "body": "Downvotes are possibly because this exact situation is explained in the docs for <a href=\"https://ruby-doc.org/core-2.4.0/Array.html#method-i-5B-5D-3D\" rel=\"nofollow noreferrer\"><code>Array#[]=</code></a>, which shows a lack of research effort. &quot;Elements are inserted into the array at start if length is zero.&quot;"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1503989520, "post_id": 45932261, "comment_id": 78823089, "body": "\u201cI don\u2019t understand this line\u201d is a statement, not a question."}, {"owner": {"reputation": 2635, "user_id": 1177575, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/147cbbdcb918ccf00a5d662d9e3077ad?s=128&d=identicon&r=PG", "display_name": "Abibullah Rahamathulah", "link": "https://stackoverflow.com/users/1177575/abibullah-rahamathulah"}, "reply_to_user": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1503990580, "post_id": 45932261, "comment_id": 78823683, "body": "Thank you @SimpleLime, I should have checked there."}, {"owner": {"reputation": 2635, "user_id": 1177575, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/147cbbdcb918ccf00a5d662d9e3077ad?s=128&d=identicon&r=PG", "display_name": "Abibullah Rahamathulah", "link": "https://stackoverflow.com/users/1177575/abibullah-rahamathulah"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1503990671, "post_id": 45932261, "comment_id": 78823728, "body": "@mudasobwa, I was not sure how to frame it."}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1503996178, "post_id": 45932651, "comment_id": 78827060, "body": "Your quotation is a bit off. The documentation says: <i>&quot;Elements are inserted into the array at <code>start</code> if <code>length</code> is zero.&quot;</i>"}], "tags": [], "owner": {"reputation": 43225, "user_id": 297087, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/17b3a5816f0647e9b0f7c49d60f93e7b?s=128&d=identicon&r=PG", "display_name": "Salil", "link": "https://stackoverflow.com/users/297087/salil"}, "is_accepted": true, "score": 1, "last_activity_date": 1503989974, "creation_date": 1503989974, "answer_id": 45932651, "question_id": 45932261, "link": "https://stackoverflow.com/questions/45932261/ruby-index-assignment/45932651#45932651", "title": "Ruby index assignment", "body": "<p>Ref Array method of <a href=\"https://ruby-doc.org/core-2.2.5/Array.html#method-i-5B-5D-3D\" rel=\"nofollow noreferrer\"><code>ary[start, length] = obj or other_ary or nil \u2192 obj or other_ary or nil</code></a></p>\n\n<pre><code>items[1,0] = [\"bottle\", \"my\"]\nHere, 1 is Index &amp; Length is 0\n</code></pre>\n\n<p>As per the documentation 'Elements are inserted into the array at start if length &amp; index are zero.'</p>\n\n<p>For Ex:- </p>\n\n<pre><code>a = ['A']\na[0, 0] = [ 1, 2 ]          #=&gt; array a will be [1, 2, \"A\"]\n</code></pre>\n\n<p>Similarly, when Index is non zero &amp; Length is zero 'Elements are inserted into the array from given Index'</p>\n\n<pre><code>a = ['A']\na[1, 0] = [ 1, 2 ]          #=&gt; array a will be [\"A\", 1, 2]\n</code></pre>\n"}], "owner": {"reputation": 2635, "user_id": 1177575, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/147cbbdcb918ccf00a5d662d9e3077ad?s=128&d=identicon&r=PG", "display_name": "Abibullah Rahamathulah", "link": "https://stackoverflow.com/users/1177575/abibullah-rahamathulah"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "closed_date": 1504019743, "accepted_answer_id": 45932651, "answer_count": 1, "score": -6, "last_activity_date": 1503990970, "creation_date": 1503988517, "last_edit_date": 1503990970, "question_id": 45932261, "link": "https://stackoverflow.com/questions/45932261/ruby-index-assignment", "closed_reason": "Not suitable for this site", "title": "Ruby index assignment", "body": "<p>I have this code:</p>\n\n<pre><code>items = [\"place\", \"key\", \"holder\"]\nitems[1,0] = [\"bottle\", \"my\"]\nitems # =&gt; [\"place\", \"bottle\", \"my\", \"key\", \"holder\"]\n</code></pre>\n\n<p>How did <code>\"my\"</code> come in third position?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1503987711, "post_id": 45931245, "comment_id": 78822040, "body": "What happens with other combinations?"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 2618465, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/268824c0dacef28c920001ea858f76c0?s=128&d=identicon&r=PG", "display_name": "user2618465", "link": "https://stackoverflow.com/users/2618465/user2618465"}, "edited": false, "score": 1, "creation_date": 1503985330, "post_id": 45931404, "comment_id": 78820990, "body": "ternary operator will be way too long. keeping in mind only &quot;yahoo&quot; or only &quot;bing&quot; can also be true."}], "tags": [], "owner": {"reputation": 10770, "user_id": 381874, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/k7VRE.jpg?s=128&g=1", "display_name": "Sachin R", "link": "https://stackoverflow.com/users/381874/sachin-r"}, "is_accepted": false, "score": -3, "last_activity_date": 1503985161, "creation_date": 1503985161, "answer_id": 45931404, "question_id": 45931245, "link": "https://stackoverflow.com/questions/45931245/effective-way-to-implement-if-else-condition/45931404#45931404", "title": "Effective way to implement &#39;if else&#39; condition", "body": "<pre><code>(google &amp;&amp; yahoo)? ? \"google + yahoo\" : ((google &amp;&amp; yahoo &amp;&amp; bing))? ? \"google + yahoo + bing\" : (google)? ? \"google\" : \"none\"\n</code></pre>\n\n<p>use ternary operator but it is little bit complex</p>\n"}, {"comments": [{"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "edited": false, "score": 0, "creation_date": 1503992460, "post_id": 45931583, "comment_id": 78824788, "body": "But it&#39;s bad design. You don&#39;t want to have such logic in your templates. Use <a href=\"https://stackoverflow.com/a/45932189/299774\">stackoverflow.com/a/45932189/299774</a> approach, preferably put this method in helper or model&#39;s decorator."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1503992483, "post_id": 45931583, "comment_id": 78824812, "body": "While this approach may work for three attributes, it won&#39;t scale well."}, {"owner": {"reputation": 2874, "user_id": 4720244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbf3e87a6491f609f81b93e438282db?s=128&d=identicon&r=PG&f=1", "display_name": "EJAg", "link": "https://stackoverflow.com/users/4720244/ejag"}, "edited": false, "score": 0, "creation_date": 1504023960, "post_id": 45931583, "comment_id": 78846450, "body": "indeed the approach by @unkmas would be better"}], "tags": [], "owner": {"reputation": 2874, "user_id": 4720244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbf3e87a6491f609f81b93e438282db?s=128&d=identicon&r=PG&f=1", "display_name": "EJAg", "link": "https://stackoverflow.com/users/4720244/ejag"}, "is_accepted": true, "score": 0, "last_activity_date": 1503985991, "creation_date": 1503985991, "answer_id": 45931583, "question_id": 45931245, "link": "https://stackoverflow.com/questions/45931245/effective-way-to-implement-if-else-condition/45931583#45931583", "title": "Effective way to implement &#39;if else&#39; condition", "body": "<p>One possible solution (assuming your object is @m)</p>\n\n<pre><code>&lt;%= \"#{'google' if @m.google}\" + \n    \"#{' + '    if @m.google &amp;&amp; @m.yahoo}\" +\n    \"#{'yahoo'  if @m.yahoo}\" +\n    \"#{' + '    if (@m.yahoo &amp;&amp; @m.bing) || (@m.google &amp;&amp; @m.bing)}\" +\n    \"#{'bing'   if @m.bing}\"\n%&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1503987523, "post_id": 45931687, "comment_id": 78821950, "body": "I&#39;d agree that a helper is better than jamming all that logic into the view but why not leave the <code>&#39; + &#39;</code> stuff until the final <code>join</code>? And I think you have a stray <code>+</code> in the <code>if obj.yahoo +</code> part."}, {"owner": {"reputation": 2635, "user_id": 1177575, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/147cbbdcb918ccf00a5d662d9e3077ad?s=128&d=identicon&r=PG", "display_name": "Abibullah Rahamathulah", "link": "https://stackoverflow.com/users/1177575/abibullah-rahamathulah"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1503988312, "post_id": 45931687, "comment_id": 78822356, "body": "I think this can be refactored though. I did not get into logic much."}], "tags": [], "owner": {"reputation": 2635, "user_id": 1177575, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/147cbbdcb918ccf00a5d662d9e3077ad?s=128&d=identicon&r=PG", "display_name": "Abibullah Rahamathulah", "link": "https://stackoverflow.com/users/1177575/abibullah-rahamathulah"}, "is_accepted": false, "score": 1, "last_activity_date": 1503988247, "last_edit_date": 1503988247, "creation_date": 1503986478, "answer_id": 45931687, "question_id": 45931245, "link": "https://stackoverflow.com/questions/45931245/effective-way-to-implement-if-else-condition/45931687#45931687", "title": "Effective way to implement &#39;if else&#39; condition", "body": "<p>use helper method,</p>\n\n<pre><code>module ApplicationHelper\n  def get_platform(obj)\n    straray = []\n    strarray &lt;&lt; 'google' if obj.google \n    strarray &lt;&lt; ' + '    if obj.google &amp;&amp; obj.yahoo\n    strarray &lt;&lt; 'yahoo'  if obj.yahoo\n    strarray &lt;&lt; ' + '    if obj.yahoo &amp;&amp; obj.bing) || (obj.google &amp;&amp; obj.bing)\n    strarray &lt;&lt; 'bing'   if obj.bing\n\n    strarray.join\n  end\nend\n</code></pre>\n\n<p>call this <code>= get_platform(obj)</code></p>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1503992106, "post_id": 45932189, "comment_id": 78824595, "body": "If <code>obj</code> is a Rails model, you could use <code>obj[m]</code> instead of <code>public_send</code> to access the attribute."}, {"owner": {"reputation": 888, "user_id": 3355934, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd10fc1565fa16a700c6e50d478b07ff?s=128&d=identicon&r=PG", "display_name": "unkmas", "link": "https://stackoverflow.com/users/3355934/unkmas"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1503997246, "post_id": 45932189, "comment_id": 78827712, "body": "@Stefan i think it&#39;s better to use <code>public_send</code>, because model can contain some additional logic on getter."}], "tags": [], "owner": {"reputation": 888, "user_id": 3355934, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dd10fc1565fa16a700c6e50d478b07ff?s=128&d=identicon&r=PG", "display_name": "unkmas", "link": "https://stackoverflow.com/users/3355934/unkmas"}, "is_accepted": false, "score": 4, "last_activity_date": 1503988290, "creation_date": 1503988290, "answer_id": 45932189, "question_id": 45931245, "link": "https://stackoverflow.com/questions/45931245/effective-way-to-implement-if-else-condition/45932189#45932189", "title": "Effective way to implement &#39;if else&#39; condition", "body": "<p>How about this?</p>\n\n<pre><code>def result\n   %w[google yahoo bing].keep_if {|m| obj.public_send(m) }.join(' + ')\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 4, "creation_date": 1503991706, "post_id": 45932225, "comment_id": 78824351, "body": "Why <code>map</code> and <code>compact</code> when we have <a href=\"http://ruby-doc.org/core-2.4.1/Enumerable.html#method-i-select\" rel=\"nofollow noreferrer\"><code>select</code></a>?"}], "tags": [], "owner": {"reputation": 2202, "user_id": 3607039, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8Bj3I.jpg?s=128&g=1", "display_name": "Bustikiller", "link": "https://stackoverflow.com/users/3607039/bustikiller"}, "is_accepted": false, "score": 1, "last_activity_date": 1503988370, "creation_date": 1503988370, "answer_id": 45932225, "question_id": 45931245, "link": "https://stackoverflow.com/questions/45931245/effective-way-to-implement-if-else-condition/45932225#45932225", "title": "Effective way to implement &#39;if else&#39; condition", "body": "<p>Assuming you have a <code>my_object</code> object, </p>\n\n<pre><code>%i(google yahoo bing).map do |engine|\n  engine if my_object[engine]\nend.compact.join(' + ')\n</code></pre>\n\n<p>This solution is easily extensible to any number of engines.</p>\n"}, {"tags": [], "owner": {"reputation": 808, "user_id": 2508651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nqA7o.jpg?s=128&g=1", "display_name": "YasirAzgar", "link": "https://stackoverflow.com/users/2508651/yasirazgar"}, "is_accepted": false, "score": 2, "last_activity_date": 1503990653, "creation_date": 1503990653, "answer_id": 45932868, "question_id": 45931245, "link": "https://stackoverflow.com/questions/45931245/effective-way-to-implement-if-else-condition/45932868#45932868", "title": "Effective way to implement &#39;if else&#39; condition", "body": "<p>You can push the values into the array and join them, like this</p>\n\n<pre><code>search_engines = []\nsearch_engines &lt;&lt; 'google' if google\nsearch_engines &lt;&lt; 'yahoo'  if yahoo\nsearch_engines &lt;&lt; 'bing'   if bing\n\nsearch_engines.join(' + ')\n</code></pre>\n\n<p>Its not recommended to put this directly inside the view, there are two options</p>\n\n<ol>\n<li><p>Pull this code into the respective view_helper method and call that method in the view.</p></li>\n<li><p>If this piece of code is not only used in view but also has business logic you can pull this code into a model and then you can call this method using the instance.<br>\nEg: obj.search_engines.join(' + ') (assuming that the name of the method is search_engines and you are returning only an array from the method)</p></li>\n</ol>\n"}], "owner": {"reputation": 77, "user_id": 2618465, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/268824c0dacef28c920001ea858f76c0?s=128&d=identicon&r=PG", "display_name": "user2618465", "link": "https://stackoverflow.com/users/2618465/user2618465"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 45931583, "answer_count": 6, "score": -4, "last_activity_date": 1503990653, "creation_date": 1503984295, "last_edit_date": 1503987836, "question_id": 45931245, "link": "https://stackoverflow.com/questions/45931245/effective-way-to-implement-if-else-condition", "title": "Effective way to implement &#39;if else&#39; condition", "body": "<p>I have three database boolean columns <code>google</code>, <code>yahoo</code>, <code>bing</code>. I need to print them on html.erb page like this. </p>\n\n<ul>\n<li><code>\"google + yahoo + bing\"</code> if all three are <code>true</code>.</li>\n<li><code>\"google + yahoo\"</code> if only <code>google</code> and <code>yahoo</code> are <code>true</code>.</li>\n<li><code>\"google\"</code> if only <code>google</code> is <code>true</code>.</li>\n</ul>\n\n<p>Is there an effective way to implement this? If I do it in a traditional way, then <code>if .. else</code> conditions will be large.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rest-client", "gemfile"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4294210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1G2tq.png?s=128&g=1", "display_name": "FORESTAR", "link": "https://stackoverflow.com/users/4294210/forestar"}, "edited": false, "score": 0, "creation_date": 1504019234, "post_id": 45931171, "comment_id": 78843417, "body": "then I met the problem: docverter was resolved to 1.0.1, which depends on       rest-client (~&gt; 1.7)"}], "tags": [], "owner": {"reputation": 10770, "user_id": 381874, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/k7VRE.jpg?s=128&g=1", "display_name": "Sachin R", "link": "https://stackoverflow.com/users/381874/sachin-r"}, "is_accepted": false, "score": -1, "last_activity_date": 1503983872, "creation_date": 1503983872, "answer_id": 45931171, "question_id": 45930576, "link": "https://stackoverflow.com/questions/45930576/ruby-gemfile-rest-client-version-conflict/45931171#45931171", "title": "ruby gemfile rest-client version conflict", "body": "<p>run </p>\n\n<pre><code>bundle update rest-client\n</code></pre>\n\n<p>and then <code>bundle install</code> once rest-client is updated.</p>\n"}, {"tags": [], "owner": {"reputation": 7540, "user_id": 145905, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/27329e443ade13f20dc20526436244b7?s=128&d=identicon&r=PG", "display_name": "A B", "link": "https://stackoverflow.com/users/145905/a-b"}, "is_accepted": true, "score": 1, "last_activity_date": 1505871082, "last_edit_date": 1505871082, "creation_date": 1504667975, "answer_id": 46066246, "question_id": 45930576, "link": "https://stackoverflow.com/questions/45930576/ruby-gemfile-rest-client-version-conflict/46066246#46066246", "title": "ruby gemfile rest-client version conflict", "body": "<p>Unfortunately you can only have one version of a gem activated at a time. So when there are conflicting version dependencies like this, you have to pick one.</p>\n\n<p>The latest Docverter code requires rest-client 1.x:\n<a href=\"https://github.com/Docverter/docverter-ruby/blob/5775e5a8bc00610d3168141cc44a83b4af41717a/docverter.gemspec#L20\" rel=\"nofollow noreferrer\">https://github.com/Docverter/docverter-ruby/blob/5775e5a8bc00610d3168141cc44a83b4af41717a/docverter.gemspec#L20</a></p>\n\n<p>In this situation, your best bet is probably to make a fork changing the dependency to <code>~&gt; 2.0</code> and issue a pull request. In the best case, the maintainers will merge your pull request quickly.</p>\n\n<p>In the worst case, you can use your forked version by specifying a git URL in the Gemfile. <a href=\"http://bundler.io/v1.15/guides/git.html\" rel=\"nofollow noreferrer\">http://bundler.io/v1.15/guides/git.html</a></p>\n"}], "owner": {"reputation": 25, "user_id": 4294210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1G2tq.png?s=128&g=1", "display_name": "FORESTAR", "link": "https://stackoverflow.com/users/4294210/forestar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 746, "favorite_count": 0, "accepted_answer_id": 46066246, "answer_count": 2, "score": 0, "last_activity_date": 1505871082, "creation_date": 1503980053, "question_id": 45930576, "link": "https://stackoverflow.com/questions/45930576/ruby-gemfile-rest-client-version-conflict", "title": "ruby gemfile rest-client version conflict", "body": "<p>I mean, users are encouraged to upgrade to rest-client 2.0, I need to upgrade for some mail api only support 2.0 version, but now I meet this problem.<br>\nWhen I change rest-client version to 2.0.2 in my Gemfile, and I meet this problem.<br>\nBundler could not find compatible versions for gem \"rest-client\":\nit seems that rest-client 2.0 version is conflict with docverter which depends on rest-client (~> 1.6.7)<br>\nSo how should I do to solve? I need rest-client version to be above 2.0.</p>\n\n<p>here's my Gemfile:</p>\n\n<pre><code>source 'https://rubygems.org'\nruby '2.4.1'\n\ngem 'rails'\n\n# Forms\ngem 'wicked'\ngem 'localstorageshim-rails'\ngem 'simple_form'\n\n# Monitoring\ngem 'newrelic_rpm'\ngem 'slack-notifier'\ngem 'puma_worker_killer'\n\n# Assets\ngem 'sass-rails'\ngem 'haml-rails'\ngem 'uglifier'\ngem 'autoprefixer-rails'\n\n# Design\ngem 'bootstrap-sass'\ngem 'font-awesome-sass'\ngem 'nprogress-rails'\ngem 'normalize-rails'\n\n# Markdown\ngem 'marked-rails'\ngem 'rdiscount'\n\n# Javascript\ngem 'react-rails'\ngem 'coffee-rails'\ngem 'jquery-rails'\ngem 'turbolinks'\ngem 'jquery-turbolinks'\n\n# Authentication\ngem 'devise'\ngem 'pundit'\n\n# Data\ngem 'pg'\n\n# Payments\ngem 'stripe'\ngem 'braintree'\n\n# Crypto\ngem 'hashids'\n\n# Images\ngem 'lazyload-rails'\n\n# Files\ngem 'rest-client', '&gt;= 2.0'\ngem 'docverter'\n\n# Utils\ngem 'annotate'\ngem 'jbuilder'\ngem 'sdoc',          group: :doc\n\ngroup :development do\n  gem 'spring'\n  gem 'spring-commands-rspec'\n\n  gem 'better_errors'\n  gem 'binding_of_caller', :platforms=&gt;[:mri_21]\n  gem 'html2haml'\n  gem 'hub', :require=&gt;nil\n  gem 'quiet_assets'\n  gem 'rails_layout'\nend\n\ngroup :development, :test do\n  gem 'factory_girl_rails'\n  gem 'faker'\n  gem 'rspec-rails'\nend\n\ngroup :production do\n  gem 'rails_12factor'\n  gem 'puma'\n  gem 'heroku_rails_deflate'\n  gem 'rack-timeout'\nend\n\ngroup :test do\n  gem 'capybara'\n  gem 'database_cleaner'\n  gem 'launchy'\n  gem 'selenium-webdriver'\nend\n</code></pre>\n"}, {"tags": ["ruby", "regex", "string"], "answers": [{"tags": [], "owner": {"reputation": 9659, "user_id": 6136634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7487290ff90aebf6848d9c638c067bb?s=128&d=identicon&r=PG", "display_name": "Gerry", "link": "https://stackoverflow.com/users/6136634/gerry"}, "is_accepted": false, "score": 1, "last_activity_date": 1503973612, "last_edit_date": 1503973612, "creation_date": 1503973110, "answer_id": 45929743, "question_id": 45929602, "link": "https://stackoverflow.com/questions/45929602/string-does-not-match-when-a-it-contains-text-after-parenthesis/45929743#45929743", "title": "String does not match when a it contains text after parenthesis", "body": "<p>You must escape the parenthesis for <code>match</code> to work, otherwise they will be interpreted as part of the regex pattern (i.e. as a <em>capturing group</em>), and not as part of the string to be matched.</p>\n\n<p>To escape the parenthesis you can use a <code>\\</code>:</p>\n\n<pre><code>match_string = '\\(LA\\) rocks'\nstr.match(match_string)\n#=&gt; #&lt;MatchData \"(LA) rocks\"&gt;\n</code></pre>\n\n<p>Notice the use of <em>single quotes</em> (<code>'</code>) instead of <em>double quotes</em> (<code>\"</code>); if you want to use <em>double quotes</em> instead, you will need to use double <code>\\</code>:</p>\n\n<pre><code>match_string = \"\\\\(LA\\\\) rocks\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 1, "last_activity_date": 1503973873, "creation_date": 1503973873, "answer_id": 45929850, "question_id": 45929602, "link": "https://stackoverflow.com/questions/45929602/string-does-not-match-when-a-it-contains-text-after-parenthesis/45929850#45929850", "title": "String does not match when a it contains text after parenthesis", "body": "<p>Because the argument of <code>match</code> is converted into a regex. In particular, the parentheses in <code>\"(LA) rocks\"</code> are interpreted as meta characters, not as literal parentheses. In fact, the following matches:</p>\n\n<pre><code>\"California LA rocks\".match(\"(LA) rocks\")\n# =&gt; #&lt;MatchData \"LA rocks\" 1:\"LA\"&gt;\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 1588650, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8b606607a4049c29a8d108b9d36d2179?s=128&d=identicon&r=PG", "display_name": "Kevin Fernandes", "link": "https://stackoverflow.com/users/1588650/kevin-fernandes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1503973873, "creation_date": 1503971910, "last_edit_date": 1503973289, "question_id": 45929602, "link": "https://stackoverflow.com/questions/45929602/string-does-not-match-when-a-it-contains-text-after-parenthesis", "title": "String does not match when a it contains text after parenthesis", "body": "<p>This works:</p>\n\n<pre><code>str = \"California (LA) rocks\"\nmatch_string = \"rocks\"\nstr.match(match_string) # =&gt; #&lt;MatchData \"rocks\"&gt;\n</code></pre>\n\n<p>Why does this not work?</p>\n\n<pre><code>match_string = \"(LA) rocks\"\nstr.match(match_string) # =&gt; nil\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 348, "user_id": 2562771, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1040706145/picture?type=large", "display_name": "Jonathan Simon", "link": "https://stackoverflow.com/users/2562771/jonathan-simon"}, "edited": false, "score": 0, "creation_date": 1503970378, "post_id": 45929407, "comment_id": 78817461, "body": "@Mark Thomas Interesting, in what other contexts can this be used? I imagine it would confuse the parser if you were to try using it in an if statement"}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 2, "creation_date": 1503970843, "post_id": 45929407, "comment_id": 78817592, "body": "In ruby all objects except <code>nil</code> and <code>false</code> are considered <code>true</code>, so <code>||</code> still works as you&#39;d expect in <code>if</code> statements"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 348, "user_id": 2562771, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1040706145/picture?type=large", "display_name": "Jonathan Simon", "link": "https://stackoverflow.com/users/2562771/jonathan-simon"}, "edited": false, "score": 0, "creation_date": 1503975826, "post_id": 45929407, "comment_id": 78818682, "body": "@jon_simon we also use it to cache assignment, e.g. <code>foo ||= []</code> is like <code>foo = foo || []</code> (though not exactly, see <a href=\"http://www.rubyinside.com/what-rubys-double-pipe-or-equals-really-does-5488.html\" rel=\"nofollow noreferrer\">what-rubys-double-pipe-or-equals-really-does</a>)"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 348, "user_id": 2562771, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1040706145/picture?type=large", "display_name": "Jonathan Simon", "link": "https://stackoverflow.com/users/2562771/jonathan-simon"}, "edited": false, "score": 0, "creation_date": 1504019924, "post_id": 45929407, "comment_id": 78843875, "body": "@jon_simon: Why would using a conditional operator in a conditional expression &quot;confuse the parser&quot;? I would be pretty useless if you couldn&#39;t use &quot;or&quot; in an &quot;if&quot; condition, don&#39;t you think?"}], "tags": [], "owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "is_accepted": true, "score": 5, "last_activity_date": 1503970076, "creation_date": 1503970076, "answer_id": 45929407, "question_id": 45929343, "link": "https://stackoverflow.com/questions/45929343/ruby-disjunction-syntax/45929407#45929407", "title": "Ruby disjunction syntax", "body": "<p>The semantics of || are:</p>\n\n<ul>\n<li>if the first expression is not nil or false, return it</li>\n<li>if the first expression is nil or false, return the second expression</li>\n</ul>\n\n<p>This is used to provide a default value if the first is nil.</p>\n"}], "owner": {"reputation": 348, "user_id": 2562771, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1040706145/picture?type=large", "display_name": "Jonathan Simon", "link": "https://stackoverflow.com/users/2562771/jonathan-simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 45929407, "answer_count": 1, "score": 1, "last_activity_date": 1503971021, "creation_date": 1503969414, "last_edit_date": 1503971021, "question_id": 45929343, "link": "https://stackoverflow.com/questions/45929343/ruby-disjunction-syntax", "title": "Ruby disjunction syntax", "body": "<p>I encountered some code that looks like:</p>\n\n<pre><code>(input_array || []).each do |a|\n  some stuff\nend\n</code></pre>\n\n<p>What is the purpose of <code>input_array || []</code>? I would naively think that this would evaluate to a boolean value which would cause <code>each</code> to throw an error, but that's clearly not whats happening.</p>\n"}, {"tags": ["ruby", "string"], "answers": [{"tags": [], "owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "is_accepted": true, "score": 2, "last_activity_date": 1503965200, "creation_date": 1503965200, "answer_id": 45928890, "question_id": 45928783, "link": "https://stackoverflow.com/questions/45928783/ruby-replace-substring-of-string-representation-of-a-json/45928890#45928890", "title": "Ruby replace substring of string representation of a JSON", "body": "<p>It's working, but <a href=\"https://ruby-doc.org/core-2.4.0/String.html#method-i-sub\" rel=\"nofollow noreferrer\"><code>sub</code></a> returns a copy of the string with the substitution made. You can see this by doing running:</p>\n\n<pre><code>test_geometry_profile =\n  '{\n    \"geometryProfile\": {\n\n      \"SPEEDSeedModel0.osm\": {\n        \"WWR\": 0.5,\n        \"Orientation\": 0.0\n      },\n\n      \"SPEEDSeedModel1.osm\": {\n        \"WWR\": 0.6,\n        \"Orientation\": 0.0\n      }\n    }\n  }'\n\nputs test_geometry_profile\nputs test_geometry_profile.sub(\"SPEEDSeedModel1.osm\", 'TestOSM_radiantDOAS.osm')\nputs test_geometry_profile\n</code></pre>\n\n<p>The second value output will have the change made, and the third is the original string. What you want is <a href=\"https://ruby-doc.org/core-2.4.0/String.html#method-i-sub-21\" rel=\"nofollow noreferrer\"><code>sub!</code></a>, which changes the string in place:</p>\n\n<pre><code>puts test_geometry_profile\nputs test_geometry_profile.sub!(\"SPEEDSeedModel1.osm\", 'TestOSM_radiantDOAS.osm')\nputs test_geometry_profile\n</code></pre>\n\n<p>Now the second and third values have the new string.</p>\n"}], "owner": {"reputation": 191, "user_id": 3160253, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/690007789/picture?type=large", "display_name": "Anton James", "link": "https://stackoverflow.com/users/3160253/anton-james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 0, "accepted_answer_id": 45928890, "answer_count": 1, "score": -1, "last_activity_date": 1504206982, "creation_date": 1503964216, "last_edit_date": 1504206982, "question_id": 45928783, "link": "https://stackoverflow.com/questions/45928783/ruby-replace-substring-of-string-representation-of-a-json", "title": "Ruby replace substring of string representation of a JSON", "body": "<p>I have a string as follows, which is in JSON format:</p>\n\n<pre><code>  test_geometry_profile =\n  '{\n    \"geometryProfile\": {\n\n      \"SPEEDSeedModel0.osm\": {\n        \"WWR\": 0.5,\n        \"Orientation\": 0.0\n      },\n\n      \"SPEEDSeedModel1.osm\": {\n        \"WWR\": 0.6,\n        \"Orientation\": 0.0\n      }\n    }\n  }'\n</code></pre>\n\n<p>I would like to replace the substring <code>SPEEDSeedModel1.osm</code> in this string with <code>'TestOSM_radiantDOAS.osm'</code>.</p>\n\n<p>I used the code: </p>\n\n<pre><code>test_geometry_profile.sub(\"SPEEDSeedModel1.osm\", 'TestOSM_radiantDOAS.osm')\n</code></pre>\n\n<p>However, this fails to work. Is there something that I am missing here?</p>\n"}, {"tags": ["ruby", "error-handling"], "answers": [{"tags": [], "owner": {"reputation": 318, "user_id": 2959090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecab5392ceea34c60ad3d723617d127a?s=128&d=identicon&r=PG&f=1", "display_name": "siopao", "link": "https://stackoverflow.com/users/2959090/siopao"}, "is_accepted": true, "score": 4, "last_activity_date": 1503974565, "last_edit_date": 1503974565, "creation_date": 1503961970, "answer_id": 45928530, "question_id": 45928342, "link": "https://stackoverflow.com/questions/45928342/how-to-catch-different-error-types-at-the-same-time/45928530#45928530", "title": "How to catch different error types at the same time?", "body": "<p>Just need to put in another rescue. You can put in as many as you need.</p>\n\n<pre><code>begin\n  page = Nokogiri::HTML(uri.open(redirect: false))\nrescue OpenURI::HTTPRedirect =&gt; redirect\n  uri = redirect.uri\n  puts \"retry #{tries}: #{uri}\"\n  retry if (tries-=1) &gt; 0\n  raise\nrescue OtherError =&gt; e\n  # do something\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8529611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e279dd8e89d9ab16577d89391ac371?s=128&d=identicon&r=PG&f=1", "display_name": "RubyG", "link": "https://stackoverflow.com/users/8529611/rubyg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 45928530, "answer_count": 1, "score": 0, "last_activity_date": 1503974565, "creation_date": 1503960356, "last_edit_date": 1503974499, "question_id": 45928342, "link": "https://stackoverflow.com/questions/45928342/how-to-catch-different-error-types-at-the-same-time", "title": "How to catch different error types at the same time?", "body": "<p>I have the following code to help me catch redirect errors when processing URLs.</p>\n\n<pre><code>begin\n  page = Nokogiri::HTML(uri.open(redirect: false))\nrescue OpenURI::HTTPRedirect =&gt; redirect\n  uri = redirect.uri\n  puts \"retry #{tries}: #{uri}\"\n  retry if (tries-=1) &gt; 0\n  raise\n</code></pre>\n\n<p>It works well for URL redirect errors, but it doesn't catch any other types of errors. For example, a URL threw a 416 error, which couldn't be handled by the above code.</p>\n\n<p>I can use</p>\n\n<pre><code>rescue StandardError =&gt; e\n</code></pre>\n\n<p>to catch the 416 error and skip the URL I was processing, but how do I catch both errors at the same time so that when there is a redirect error, the code knows where to redirect, and when there are other types of errors, the code knows when to skip?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1503960399, "post_id": 45928327, "comment_id": 78815297, "body": "Why is <code>$config</code> a global variable? That&#39;s pretty reckless."}, {"owner": {"reputation": 67, "user_id": 7211890, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13cf30afd2dd3802bd023743647bf6b7?s=128&d=identicon&r=PG&f=1", "display_name": "Valkry", "link": "https://stackoverflow.com/users/7211890/valkry"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1503961712, "post_id": 45928327, "comment_id": 78815657, "body": "@tadman - that is for my controller-level config.  Sorry, I&#39;m very new to ruby/rails.  Do you have a suggestion on how to improve?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1503963460, "post_id": 45928327, "comment_id": 78816049, "body": "It&#39;s usually better to put that sort of stuff in your application&#39;s module, like <code>MyApp.config[&#39;global_fields&#39;]</code> where you can add a <code>config</code> method to <code>lib&#47;my_app.rb</code> or what have you."}], "answers": [{"tags": [], "owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "is_accepted": true, "score": 1, "last_activity_date": 1503965825, "creation_date": 1503965825, "answer_id": 45928968, "question_id": 45928327, "link": "https://stackoverflow.com/questions/45928327/prevent-redirect-when-calling-url-for-in-a-rails-app/45928968#45928968", "title": "Prevent redirect when calling url_for in a rails app", "body": "<p>It's probably because you are calling the <code>index_data</code> action when you attempt to get a url to it, and calling it is tricking Rails into thinking you want to render from that action.</p>\n\n<p>If you change your <code>url_for</code> to point to a symbol (or string) instead of the return value of the action, things will probably start working as you expect:</p>\n\n<pre><code>@locals = { ..., ajax: url_for(action: :index_data)}}\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 7211890, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13cf30afd2dd3802bd023743647bf6b7?s=128&d=identicon&r=PG&f=1", "display_name": "Valkry", "link": "https://stackoverflow.com/users/7211890/valkry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 1, "accepted_answer_id": 45928968, "answer_count": 1, "score": 0, "last_activity_date": 1503965825, "creation_date": 1503960284, "last_edit_date": 1503960421, "question_id": 45928327, "link": "https://stackoverflow.com/questions/45928327/prevent-redirect-when-calling-url-for-in-a-rails-app", "title": "Prevent redirect when calling url_for in a rails app", "body": "<p>I'm trying to pass a url string to a view from one of my controller methods, like so:</p>\n\n<pre><code>def index\n    @locals = {table_cols: $config['global_fields'],\n               table_title: $config['main_page']['table_title'],\n               ajax: url_for(action: index_data)}} # HERE\nend\n</code></pre>\n\n<p>index_data is a function in my controller that returns some data in JSON format.  However, when I navigate to the index page of my application, the browser simply displays the JSON output of index_data.  </p>\n\n<p>I'm assuming calling url_for within index is redirecting that page to index_data - is there a way to prevent this and just have url_for return the string, e.g. '/controller/index_data'?</p>\n\n<p>Thanks</p>\n"}]