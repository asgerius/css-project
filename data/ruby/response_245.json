[{"tags": ["ruby", "google-cloud-platform", "google-cloud-storage"], "comments": [{"owner": {"reputation": 768, "user_id": 8905352, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/xUuYD.jpg?s=128&g=1", "display_name": "Miguel", "link": "https://stackoverflow.com/users/8905352/miguel"}, "edited": false, "score": 0, "creation_date": 1568882790, "post_id": 58001683, "comment_id": 102418798, "body": "I understand that your issue is here <code>request.post(</code>https://${response.body.url.host}/<code>)</code>. You could try escaping the characters that are giving you problems ( { } ) with a backslash ( \\ )"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 768, "user_id": 8905352, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/xUuYD.jpg?s=128&g=1", "display_name": "Miguel", "link": "https://stackoverflow.com/users/8905352/miguel"}, "edited": false, "score": 0, "creation_date": 1568917490, "post_id": 58001683, "comment_id": 102437548, "body": "@Miguel no, that part is just JS string interpolation (note the string has backticks). The issue is one of the form fields: `key=&#39;${filename}&#39; (not js interpolation). I will try escaping it though"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 768, "user_id": 8905352, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/xUuYD.jpg?s=128&g=1", "display_name": "Miguel", "link": "https://stackoverflow.com/users/8905352/miguel"}, "edited": false, "score": 0, "creation_date": 1568918845, "post_id": 58001683, "comment_id": 102438151, "body": "@Miguel see update to the question"}, {"owner": {"reputation": 768, "user_id": 8905352, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/xUuYD.jpg?s=128&g=1", "display_name": "Miguel", "link": "https://stackoverflow.com/users/8905352/miguel"}, "edited": false, "score": 0, "creation_date": 1568985040, "post_id": 58001683, "comment_id": 102460412, "body": "Could you please specify where the <code>${filename]</code> var is specified? I cannot find it in the code you shared"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 768, "user_id": 8905352, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/xUuYD.jpg?s=128&g=1", "display_name": "Miguel", "link": "https://stackoverflow.com/users/8905352/miguel"}, "edited": false, "score": 0, "creation_date": 1569004671, "post_id": 58001683, "comment_id": 102469388, "body": "Hey @Miguel. You are right that it&#39;s not present in the code I shared. I&#39;m passing it as the <code>key</code> arg when calling <code>presigned_post</code>. I figured out this issue is caused by the <code>google-cloud-storage</code> ruby gem, specifically <code>google-cloud-storage-0.24.0&#47;lib&#47;google&#47;cloud&#47;storage&#47;file.rb</code> in <code>def ext_url</code>, which is called from <code>def post_object</code>. I&#39;m going to raise an issue on their Github."}], "answers": [{"comments": [{"owner": {"reputation": 768, "user_id": 8905352, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/xUuYD.jpg?s=128&g=1", "display_name": "Miguel", "link": "https://stackoverflow.com/users/8905352/miguel"}, "edited": false, "score": 0, "creation_date": 1569229410, "post_id": 58033668, "comment_id": 102514978, "body": "Could you link the GitHub issue in your answer? Doing so will help future users experiencing this same issue."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 768, "user_id": 8905352, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/xUuYD.jpg?s=128&g=1", "display_name": "Miguel", "link": "https://stackoverflow.com/users/8905352/miguel"}, "edited": false, "score": 0, "creation_date": 1569253848, "post_id": 58033668, "comment_id": 102528253, "body": "@Miguel yes linked it"}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 0, "last_activity_date": 1569257831, "last_edit_date": 1569257831, "creation_date": 1569004764, "answer_id": 58033668, "question_id": 58001683, "link": "https://stackoverflow.com/questions/58001683/posting-object-to-google-cloud-storage-doesnt-replace-filename-variable/58033668#58033668", "title": "Posting object to Google Cloud Storage doesn&#39;t replace ${filename} variable", "body": "<p>Figured out the issue is caused by:</p>\n\n<pre><code>      def ext_path\n        URI.escape \"/#{@bucket}/#{@path}\"\n      end\n</code></pre>\n\n<p>in <code>lib/google/cloud/storage/file.rb</code> of the google-cloud-ruby-gem.</p>\n\n<p>This is called by <code>def post_object</code> in that same file. </p>\n\n<p>I am going to raise an <a href=\"https://github.com/googleapis/google-cloud-ruby/issues/4047\" rel=\"nofollow noreferrer\">issue</a> on their Github page.</p>\n"}, {"comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1573615273, "post_id": 58826071, "comment_id": 103935611, "body": "Link to quartzmo&#39;s PR if anyone&#39;s interested: <a href=\"https://github.com/googleapis/google-cloud-ruby/commit/13d26a0ce6c8c5516d068e6f6b1382612670b706\" rel=\"nofollow noreferrer\">github.com/googleapis/google-cloud-ruby/commit/&hellip;</a>"}], "tags": [], "owner": {"reputation": 391, "user_id": 901096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eca4b5e7b087ef4f99191986317cbdba?s=128&d=identicon&r=PG", "display_name": "quartzmo", "link": "https://stackoverflow.com/users/901096/quartzmo"}, "is_accepted": true, "score": 1, "last_activity_date": 1573589911, "creation_date": 1573589911, "answer_id": 58826071, "question_id": 58001683, "link": "https://stackoverflow.com/questions/58001683/posting-object-to-google-cloud-storage-doesnt-replace-filename-variable/58826071#58826071", "title": "Posting object to Google Cloud Storage doesn&#39;t replace ${filename} variable", "body": "<p>A fix for this issue was released in <a href=\"https://rubygems.org/gems/google-cloud-storage/versions/1.24.0\" rel=\"nofollow noreferrer\">google-cloud-storage v1.24.0</a>.</p>\n"}], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 58826071, "answer_count": 2, "score": 0, "last_activity_date": 1573589911, "creation_date": 1568847321, "last_edit_date": 1569004695, "question_id": 58001683, "link": "https://stackoverflow.com/questions/58001683/posting-object-to-google-cloud-storage-doesnt-replace-filename-variable", "title": "Posting object to Google Cloud Storage doesn&#39;t replace ${filename} variable", "body": "<p>As described here <a href=\"https://cloud.google.com/storage/docs/xml-api/post-object\" rel=\"nofollow noreferrer\">https://cloud.google.com/storage/docs/xml-api/post-object</a></p>\n\n<p>I can use <code>${filename}</code> as part of the key when uploading a file to GCS from the browser (using a signed request). </p>\n\n<p>That's great, because it's the exact same variable S3 uses. But - a problem. It doesn't actually replace <code>${filename}</code> with the name of the file when I upload. This works perfectly on S3, but with GCS I literally get <code>$%7Bfilename%7D</code> as the key in the response - clearly it's not replacing this with the correct value.</p>\n\n<p>I'm building the request like so:</p>\n\n<pre><code>export function uploadVideo(video) {\n  return new Promise((resolve, reject) =&gt; {\n    if (!video) {\n      resolve(null);\n      return;\n    }\n    // this fetches a presigned post object from the server:\n    request.get('/presigned_post')\n      .query({format: 'json'})\n      .end((err, response)=&gt; {\n        if (!err &amp;&amp; response.ok) {\n          request\n            .post(`https://${response.body.url.host}/`)\n            .field(response.body.fields)\n            .field('Content-Type', image.type)\n            .attach('file', image, image.name)\n            .end((err, response) =&gt; {\n              if (err) {\n                console.log(\"Error uploading image: \", err);\n                reject(err);\n              } else {\n                resolve({\n                  location: response.text.match('&lt;Location&gt;' + '(.*?)' + '&lt;/Location&gt;')[1],\n                  bucket: response.text.match('&lt;Bucket&gt;' + '(.*?)' + '&lt;/Bucket&gt;')[1],\n                  key: response.text.match('&lt;Key&gt;' + '(.*?)' + '&lt;/Key&gt;')[1],\n                  checksum: response.text.match('&lt;ETag&gt;\"' + '(.*?)' + '\"&lt;/ETag&gt;')[1]\n                });\n              }\n            });\n        }\n      });\n  });\n}\n</code></pre>\n\n<p>The key is <code>some_folder/${filename}</code> and this is included in the form data to google (in <code>response.fields</code>).</p>\n\n<p>You can see I <strong>am</strong> providing the filename with <code>.attach('file', image, image.name)</code>. It <strong>is</strong> uploading correctly, just not replacing the <code>${filename}</code> var.</p>\n\n<p><em>edit</em></p>\n\n<p>I have narrowed down the issue more. We query S3 and GCS to get the fields in the presigned post. With S3, if I give a key of <code>${filename}</code> then I get exactly that returned in the fields:</p>\n\n<pre><code>  def presigned_post(bucket_name:, key:, **opts)\n    response = s3_resource.\n      bucket(bucket_name).\n      presigned_post(key: key, content_type_starts_with: '', **opts)\n\n    {\n      fields: response.fields,\n      url:    { host: URI.parse(response.url).host }\n    }\n  end\n</code></pre>\n\n<p>Fields here will contain <code>\"key\"=&gt;\"${filename}\"</code>.</p>\n\n<p>However in the GCS case, the following code returns <code>:key=&gt;\"$%7Bfilename%7D\"</code> in the fields:</p>\n\n<pre><code># https://cloud.google.com/storage/docs/xml-api/post-object#usage_and_examples\n# https://www.rubydoc.info/gems/google-cloud-storage/1.0.1/Google/Cloud/Storage/Bucket:post_object\ndef presigned_post(bucket_name:, key:, acl:, success_action_status:, expiration: nil)\n  expiration ||= (Time.now + 1.hour).iso8601\n\n  policy = {\n    expiration: expiration,\n    conditions: [\n      [\"starts-with\", \"$key\", \"\" ],\n      [\"starts-with\", \"$Content-Type\", \"\" ],\n      { acl: acl },\n      { success_action_status: success_action_status }\n    ]\n  }\n\n  post_obj = get_bucket!(bucket_name).post_object(key, policy: policy)\n\n  url_obj = { host: URI.parse(post_obj.url).host }\n\n  # Have to manually merge in these fields\n  fields = post_obj.fields.merge(\n    acl: acl,\n    success_action_status: success_action_status\n  )\n\n  return { fields: fields, url: url_obj }\nend\n</code></pre>\n\n<p>If i manually change the key in the GCS request fields, then it works. Is that really what I'm supposed to do?</p>\n"}, {"tags": ["ruby", "encoding", "extended-ascii"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1568844817, "post_id": 58001068, "comment_id": 102408380, "body": "What kind of data are you dealing with? <code>ASCII_8BIT</code> is not actually an encoding, it&#39;s more of a non-encoding and there are no &quot;extended ASCII characters&quot;, they&#39;re <a href=\"https://en.wikipedia.org/wiki/Extended_ASCII\" rel=\"nofollow noreferrer\">not defined formally</a>. DOS ANSI (<a href=\"https://en.wikipedia.org/wiki/Code_page_437\" rel=\"nofollow noreferrer\">codepage 437</a>) is one of a multitude of 8-bit encodings, as is Latin-1, Windows-1252, etc. Which format is your source data in? If you&#39;re dealing with raw binary data the answer is <code>BINARY</code> which translates to <code>ASCII_8BIT</code> by default, or in other words, it preserves the bytes and does no conversion."}, {"owner": {"reputation": 2024, "user_id": 5511315, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UBuFb.png?s=128&g=1", "display_name": "noraj", "link": "https://stackoverflow.com/users/5511315/noraj"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1568845111, "post_id": 58001068, "comment_id": 102408469, "body": "@tadman None of them. I&#39;m manipulating raw TCP socket for some network protocol and I want to send raw bytes. So I wanted a proper extended ASCII encoding to be sure that when I send 0x8f or whatever else I&#39;m really sending 0x8f and not a multiple bytes as I can be the case when using UTF-8 (which is the default when I provides extended ASCII chars in a string) or any other multi-bytes encoding."}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 0, "creation_date": 1568845312, "post_id": 58001068, "comment_id": 102408515, "body": "<code>force_encoding</code> does nothing more than force Ruby to interpret the same exact data differently, the data all remains the same, it just gets looked at differently. <code>encode</code> actually converts the data and returns different data."}, {"owner": {"reputation": 2024, "user_id": 5511315, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UBuFb.png?s=128&g=1", "display_name": "noraj", "link": "https://stackoverflow.com/users/5511315/noraj"}, "reply_to_user": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 0, "creation_date": 1568845501, "post_id": 58001068, "comment_id": 102408553, "body": "@ForeverZer0 So, so far, the best option seems to use <code>.force_encoding(Encoding::ASCII)</code> or <code>force_encoding(Encoding::ASCII_8BIT)</code> to be sure to send raw bytes and not send converted multi-bytes for example if the encoding would have otherwise be automatically set to UTF-8."}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 3, "creation_date": 1568845706, "post_id": 58001068, "comment_id": 102408585, "body": "@noraj Best way to accomplish that just be to use <code>pack</code> and <code>unpack</code> to ensure you are getting raw binary data, and it is not trying to use an encoding. Ruby using strings to represent raw data is usually convenient, but can make certain use-cases such as yours a little more nuanced."}], "answers": [{"comments": [{"owner": {"reputation": 2024, "user_id": 5511315, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UBuFb.png?s=128&g=1", "display_name": "noraj", "link": "https://stackoverflow.com/users/5511315/noraj"}, "edited": false, "score": 0, "creation_date": 1568845947, "post_id": 58001457, "comment_id": 102408646, "body": "So rather than using  <code>ruby pattern = &#39;A&#39; * 2606 + &quot;\\x8F\\x35\\x4A\\x5F&quot; + &#39;C&#39; * 390; pattern.force_encoding(Encoding::ASCII) </code>  I should use  <code>ruby pattern = [&#39;A&#39;.ord] * 2606 + [0x8F, 0x35, 0x4A, 0x5F] + [&#39;C&#39;.ord] * 390; pattern.pack(&#39;C*&#39;) </code>"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 2024, "user_id": 5511315, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UBuFb.png?s=128&g=1", "display_name": "noraj", "link": "https://stackoverflow.com/users/5511315/noraj"}, "edited": false, "score": 3, "creation_date": 1568847507, "post_id": 58001457, "comment_id": 102409030, "body": "It is mostly a matter of taste (but I&#39;d say <code>force_encoding(&#39;binary&#39;)</code> just to be explicit) but if I was working with bytes then I&#39;d use <code>pack</code>."}], "tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": true, "score": 4, "last_activity_date": 1568845460, "creation_date": 1568845460, "answer_id": 58001457, "question_id": 58001068, "link": "https://stackoverflow.com/questions/58001068/ruby-encoding-ascii-8bit-and-extended-ascii/58001457#58001457", "title": "Ruby encoding ASCII_8BIT and extended ASCII", "body": "<p>String literals are (usually) UTF-8 encoded regardless of whether or not the bytes are valid UTF-8. Hence this:</p>\n\n<pre><code>\"\\x8f\".encoding\n</code></pre>\n\n<p>saying UTF-8 even though the string isn't valid UTF-8. You should be safe using <a href=\"https://ruby-doc.org/core/String.html#method-i-force_encoding\" rel=\"nofollow noreferrer\"><code>String#force_encoding</code></a> but if you really want to work with raw bytes, you might be better of working with arrays of integers and using <a href=\"https://ruby-doc.org/core/Array.html#method-i-pack\" rel=\"nofollow noreferrer\"><code>Array#pack</code></a> to mash them into strings:</p>\n\n<pre><code>[ 0x8f, 0x11, 0x06, 0x23, 0xff, 0x00 ].pack('C*')\n# \"\\x8F\\x11\\x06#\\xFF\\x00\" \n[ 0x8f, 0x11, 0x06, 0x23, 0xff, 0x00 ].pack('C*').encoding\n# #&lt;Encoding:ASCII-8BIT&gt; \n[ 0x8f, 0x11, 0x06, 0x23, 0xff, 0x00 ].pack('C*').bytes\n# [143, 17, 6, 35, 255, 0] \n</code></pre>\n\n<p>The results should be the same but, IMO, this is explicitly working with binary data (i.e. raw bytes), makes your intent clear, and should avoid any encoding problems.</p>\n\n<p>There's also <a href=\"https://ruby-doc.org/core/String.html#method-i-unpack\" rel=\"nofollow noreferrer\"><code>String#unpack</code></a> if there is a known structure to the bytes you're reading and you want to crack it open.</p>\n"}, {"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 2, "last_activity_date": 1568870415, "creation_date": 1568870415, "answer_id": 58004152, "question_id": 58001068, "link": "https://stackoverflow.com/questions/58001068/ruby-encoding-ascii-8bit-and-extended-ascii/58004152#58004152", "title": "Ruby encoding ASCII_8BIT and extended ASCII", "body": "<p>If you're doing raw packet manipulation then everything must be in <code>BINARY</code> / <code>ASCII_8BIT</code> mode because <em>it is not text</em> and should not be treated as such. If you have any encoding other than that Ruby will try and convert it, which will in the best case severely mess up the binary data, and in the worst case crash because of conversion errors.</p>\n\n<p>In Ruby terms, <code>ASCII_8BIT</code> is effectively a raw data buffer.</p>\n\n<p>The default encoding for strings in your code is UTF-8:</p>\n\n<pre><code>p \"example\".encoding\n# =&gt; #&lt;Encoding:UTF-8&gt;\n</code></pre>\n\n<p>You can set the Ruby encoding for inline strings per-file with <code># encoding: BINARY</code>:</p>\n\n<pre><code># encoding: BINARY\n\np \"example\".encoding\n# =&gt; #&lt;Encoding:ASCII-8BIT&gt;\n</code></pre>\n\n<p>It's typically better to express binary data using tools like <code>pack</code>, as mu points out, where you can't get it wrong and you're not really using strings in the first place. This is doubly important because 8-bit values are easy to handle, but 16 and 32-bit values <em>must</em> be properly endian encoded, so you'll often see a lot of this:</p>\n\n<pre><code>header = pack('nn', qtype, qclass)\n</code></pre>\n\n<p>Where that's composing a DNS header that involves two 16-bit values.</p>\n"}], "owner": {"reputation": 2024, "user_id": 5511315, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UBuFb.png?s=128&g=1", "display_name": "noraj", "link": "https://stackoverflow.com/users/5511315/noraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2035, "favorite_count": 0, "accepted_answer_id": 58001457, "answer_count": 2, "score": 2, "last_activity_date": 1568870415, "creation_date": 1568842759, "last_edit_date": 1568847070, "question_id": 58001068, "link": "https://stackoverflow.com/questions/58001068/ruby-encoding-ascii-8bit-and-extended-ascii", "title": "Ruby encoding ASCII_8BIT and extended ASCII", "body": "<h2>About <code>ASCII_8BIT</code></h2>\n\n<blockquote>\n  <p>Encoding::ASCII_8BIT is a special encoding that is usually used for a byte string, not a character string. But as the name insists, its characters in the range of ASCII are considered as ASCII characters. This is useful when you use ASCII-8BIT characters with other ASCII compatible characters.</p>\n</blockquote>\n\n<p>Source: <a href=\"https://ruby-doc.org/core-2.6.4/Encoding.html\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.6.4</a></p>\n\n<h2>Context</h2>\n\n<p>I want to use ASCII_8BIT because I need to encode all characters between 0x00 (0d00) and 0xff (0d255), so ASCII (0-127) plus extended ASCII (128-255).\nASCII (the encoding, US-ASCII) is a 7 bits encoding that recognizes only ASCII (the charset) characters (0-127). As the name states I was expecting that ASCII_8BIT will extends it to 8 bits to add support for 128-255.</p>\n\n<h2>Issue</h2>\n\n<p>When I use chr the encoding is automatically set to ASCII_8BIT but when I put I put a char between 128-255 (0x80-0xff) directly in a string and then ask what is the encoding I got UTF-8 instead and if I try to convert it to ASCII_8BIT is get an error.</p>\n\n<pre><code>irb(main):014:0&gt; 0x8f.chr\n=&gt; \"\\x8F\"\nirb(main):015:0&gt; 0x8f.chr.encoding\n=&gt; #&lt;Encoding:ASCII-8BIT&gt;\nirb(main):016:0&gt; \"\\x8f\".encode(Encoding::ASCII_8BIT)\nTraceback (most recent call last):\n        5: from /usr/bin/irb:23:in `&lt;main&gt;'\n        4: from /usr/bin/irb:23:in `load'\n        3: from /usr/lib/ruby/gems/2.6.0/gems/irb-1.0.0/exe/irb:11:in `&lt;top (required)&gt;'\n        2: from (irb):16\n        1: from (irb):16:in `encode'\nEncoding::InvalidByteSequenceError (\"\\x8F\" on UTF-8)\nirb(main):021:0&gt; \"\\x8F\".encoding\n=&gt; #&lt;Encoding:UTF-8&gt;\n</code></pre>\n\n<p>Is there a bug in ruby core? I need to be able to encode everything between 8</p>\n\n<p>The other name of ASCII 8BIT is BINARY because as the previous quote stated it should be able to encode any byte.</p>\n\n<pre><code>irb(main):035:0&gt; Encoding::ASCII_8BIT.names\n=&gt; [\"ASCII-8BIT\", \"BINARY\"]\n</code></pre>\n\n<h2>Other encodings</h2>\n\n<p>Please telling me to use another encoding is not the answer to the question unless it is an encoding that really map all 255 extended ASCII characters.</p>\n\n<ul>\n<li>I don't want to use UTF-8 because the encoding is Multi-byte and not single-byte.</li>\n<li>ISO/IEC 8859-1 (Latin1, 8bits) contains only 191 chars (ASCII + 63 chars)\n\n<blockquote>\n  <p>One notable way in which ISO character sets differ from code pages is that the character positions 128 to 159, corresponding to ASCII control characters with the high-order bit set, are specifically unused and undefined in the ISO standards, though they had often been used for printable characters in proprietary code pages, a breaking of ISO standards that was almost universal. \n  Ref. <a href=\"https://en.wikipedia.org/wiki/Extended_ASCII#ISO_8859_and_proprietary_adaptations\" rel=\"nofollow noreferrer\">Extended ASCII- ISO 8859 and proprietary adaptations</a></p>\n</blockquote></li>\n<li>Windows-1252 (CP-1252, 8bits) doesn't contains all 255 chars and as different mappings that enxtended ASCII</li>\n</ul>\n\n<p>Available encodings in ruby:</p>\n\n<pre><code>irb(main):036:0&gt; Encoding.name_list\n=&gt; [\"ASCII-8BIT\", \"UTF-8\", \"US-ASCII\", \"UTF-16BE\", \"UTF-16LE\", \"UTF-32BE\", \"UTF-32LE\", \"UTF-16\", \"UTF-32\", \"UTF8-MAC\", \"EUC-JP\", \"Windows-31J\", \"Big5\", \"Big5-HKSCS\", \"Big5-UAO\", \"CP949\", \"Emacs-Mule\", \"EUC-KR\", \"EUC-TW\", \"GB2312\", \"GB18030\", \"GBK\", \"ISO-8859-1\", \"ISO-8859-2\", \"ISO-8859-3\", \"ISO-8859-4\", \"ISO-8859-5\", \"ISO-8859-6\", \"ISO-8859-7\", \"ISO-8859-8\", \"ISO-8859-9\", \"ISO-8859-10\", \"ISO-8859-11\", \"ISO-8859-13\", \"ISO-8859-14\", \"ISO-8859-15\", \"ISO-8859-16\", \"KOI8-R\", \"KOI8-U\", \"Shift_JIS\", \"Windows-1250\", \"Windows-1251\", \"Windows-1252\", \"Windows-1253\", \"Windows-1254\", \"Windows-1257\", \"BINARY\", \"IBM437\", \"CP437\", \"IBM737\", \"CP737\", \"IBM775\", \"CP775\", \"CP850\", \"IBM850\", \"IBM852\", \"CP852\", \"IBM855\", \"CP855\", \"IBM857\", \"CP857\", \"IBM860\", \"CP860\", \"IBM861\", \"CP861\", \"IBM862\", \"CP862\", \"IBM863\", \"CP863\", \"IBM864\", \"CP864\", \"IBM865\", \"CP865\", \"IBM866\", \"CP866\", \"IBM869\", \"CP869\", \"Windows-1258\", \"CP1258\", \"GB1988\", \"macCentEuro\", \"macCroatian\", \"macCyrillic\", \"macGreek\", \"macIceland\", \"macRoman\", \"macRomania\", \"macThai\", \"macTurkish\", \"macUkraine\", \"CP950\", \"Big5-HKSCS:2008\", \"CP951\", \"IBM037\", \"ebcdic-cp-us\", \"stateless-ISO-2022-JP\", \"eucJP\", \"eucJP-ms\", \"euc-jp-ms\", \"CP51932\", \"EUC-JIS-2004\", \"EUC-JISX0213\", \"eucKR\", \"eucTW\", \"EUC-CN\", \"eucCN\", \"GB12345\", \"CP936\", \"ISO-2022-JP\", \"ISO2022-JP\", \"ISO-2022-JP-2\", \"ISO2022-JP2\", \"CP50220\", \"CP50221\", \"ISO8859-1\", \"ISO8859-2\", \"ISO8859-3\", \"ISO8859-4\", \"ISO8859-5\", \"ISO8859-6\", \"Windows-1256\", \"CP1256\", \"ISO8859-7\", \"ISO8859-8\", \"Windows-1255\", \"CP1255\", \"ISO8859-9\", \"ISO8859-10\", \"ISO8859-11\", \"TIS-620\", \"Windows-874\", \"CP874\", \"ISO8859-13\", \"ISO8859-14\", \"ISO8859-15\", \"ISO8859-16\", \"CP878\", \"MacJapanese\", \"MacJapan\", \"ASCII\", \"ANSI_X3.4-1968\", \"646\", \"UTF-7\", \"CP65000\", \"CP65001\", \"UTF-8-MAC\", \"UTF-8-HFS\", \"UCS-2BE\", \"UCS-4BE\", \"UCS-4LE\", \"CP932\", \"csWindows31J\", \"SJIS\", \"PCK\", \"CP1250\", \"CP1251\", \"CP1252\", \"CP1253\", \"CP1254\", \"CP1257\", \"UTF8-DoCoMo\", \"SJIS-DoCoMo\", \"UTF8-KDDI\", \"SJIS-KDDI\", \"ISO-2022-JP-KDDI\", \"stateless-ISO-2022-JP-KDDI\", \"UTF8-SoftBank\", \"SJIS-SoftBank\", \"locale\", \"external\", \"filesystem\", \"internal\"]\n</code></pre>\n\n<p>For comparison python encodings <a href=\"https://docs.python.org/3/library/codecs.html#standard-encodings\" rel=\"nofollow noreferrer\">https://docs.python.org/3/library/codecs.html#standard-encodings</a></p>\n\n<h2>Considerations</h2>\n\n<p>By reading <a href=\"https://en.wikipedia.org/wiki/Extended_ASCII#Multi-byte_character_encodings\" rel=\"nofollow noreferrer\">Extended ASCII - Multi-byte character encodings</a> it seems that the only true extended ASCII encoding is UTF-8 but is Multi-byte . It seems that no true extended ASCII single byte encoding exists either.</p>\n\n<p>In a byte point of view I could use any 8bits (single byte) encoding as said here <a href=\"https://en.wikipedia.org/wiki/Extended_ASCII#Usage_in_computer-readable_languages\" rel=\"nofollow noreferrer\">Extended ASCII - Usage in computer-readable languages</a></p>\n\n<blockquote>\n  <p>all ASCII bytes (0x00 to 0x7F) have the same meaning in all variants of extended ASCII,</p>\n</blockquote>\n\n<p>But the problem is that implementations like ISO-8859-1 specifically undefined some char ranges and so will end in errors.</p>\n\n<pre><code>irb(main):009:0&gt; (0..255).map { |c| c.chr}.join.encode(Encoding::ISO_8859_1)\nTraceback (most recent call last):\n        6: from /usr/bin/irb:23:in `&lt;main&gt;'\n        5: from /usr/bin/irb:23:in `load'\n        4: from /usr/lib/ruby/gems/2.6.0/gems/irb-1.0.0/exe/irb:11:in `&lt;top (required)&gt;'\n        3: from (irb):9\n        2: from (irb):9:in `rescue in irb_binding'\n        1: from (irb):9:in `encode'\nEncoding::UndefinedConversionError (\"\\x80\" to UTF-8 in conversion from ASCII-8BIT to UTF-8 to ISO-8859-1)\n</code></pre>\n\n<hr>\n\n<h2>Update - force_encoding</h2>\n\n<p>I found the string method <a href=\"https://ruby-doc.org/core-2.6.4/String.html#method-i-force_encoding\" rel=\"nofollow noreferrer\">force_encoding</a>.</p>\n\n<pre><code>irb(main)&gt; a = \"\\x8f\"\n=&gt; \"\\x8F\"\nirb(main)&gt; a.encoding\n=&gt; #&lt;Encoding:UTF-8&gt;\nirb(main)&gt; a.encode(Encoding::ASCII_8BIT)\nTraceback (most recent call last):\n        5: from /usr/bin/irb:23:in `&lt;main&gt;'\n        4: from /usr/bin/irb:23:in `load'\n        3: from /usr/lib/ruby/gems/2.6.0/gems/irb-1.0.0/exe/irb:11:in `&lt;top (required)&gt;'\n        2: from (irb):42\n        1: from (irb):42:in `encode'\nEncoding::InvalidByteSequenceError (\"\\x8F\" on UTF-8)\nirb(main)&gt; a.force_encoding(Encoding::ASCII_8BIT)\n=&gt; \"\\x8F\"\nirb(main):040:0&gt; a.encoding\n=&gt; #&lt;Encoding:ASCII-8BIT&gt;\n</code></pre>\n\n<p>What is the danger of using <code>force_encoding</code> rather than <code>encode</code>? Is it just that if I'm passing a multi-byte char accidentally it will be converted to multiple single byte chars? So not dangerous if one is assured that all characters passed to the application are in the extended ASCII range (single byte) but unsafe and will cause silent conversion issue if some UTF-8 chars are passed to the application for example. </p>\n\n<pre><code>irb(main):044:0&gt; \"\\ud087\".force_encoding(Encoding::ASCII_8BIT)\n=&gt; \"\\xED\\x82\\x87\"\nirb(main):045:0&gt; \"\\ud087\".bytes\n=&gt; [237, 130, 135]\n</code></pre>\n\n<hr>\n\n<h2>Update - Answer</h2>\n\n<p>What @mu-is-too-short 's answer and @ForeverZer0 comment are suggesting is that I should rather use <code>pack</code> and <code>unpack</code> to deal with raw bytes.</p>\n\n<p>So rather than using an encoding and workarounding with it</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>pattern = 'A' * 2606 + \"\\x8F\\x35\\x4A\\x5F\" + 'C' * 390\npattern.force_encoding(Encoding::ASCII_8BIT)\n</code></pre>\n\n<p>I should use bytes directly</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>pattern = ['A'.ord] * 2606 + [0x8F, 0x35, 0x4A, 0x5F] + ['C'.ord] * 390\npattern = pattern.pack('C*')\n</code></pre>\n\n<p>Or this easier to read syntax</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>pattern = 'A'.bytes * 2606 + \"\\x8F\\x35\\x4A\\x5F\".bytes + 'C'.bytes * 390\npattern = pattern.pack('C*')\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "qr-code"], "comments": [{"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1568836933, "post_id": 57999823, "comment_id": 102405840, "body": "What&#39;s <code>#dark?</code> ?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1568837876, "post_id": 57999823, "comment_id": 102406173, "body": "can you please update your question to links to the gem documentation?  Since you already looked at that it would save us guess work finding it."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1568838147, "post_id": 57999823, "comment_id": 102406286, "body": "but the error is telling you exactly that there is no method defined on the object you&#39;re calling it on.  So <code>@qr</code> has no defined <code>dark?</code> method.  I couldn&#39;t find any such method at <a href=\"https://github.com/whomwah/rqrcode\" rel=\"nofollow noreferrer\">github.com/whomwah/rqrcode</a> if that&#39;s the gem you&#39;re using."}, {"owner": {"reputation": 261, "user_id": 6252815, "user_type": "registered", "profile_image": "https://graph.facebook.com/1174293045936640/picture?type=large", "display_name": "Max Kirsch", "link": "https://stackoverflow.com/users/6252815/max-kirsch"}, "edited": false, "score": 0, "creation_date": 1568838333, "post_id": 57999823, "comment_id": 102406362, "body": "Yeah I was wondering aswell. That&#39;s my source: <a href=\"https://github.com/heapsource/active_model_otp/wiki/Generate-QR-code-with-rqrcode-gem\" rel=\"nofollow noreferrer\">github.com/heapsource/active_model_otp/wiki/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1634, "user_id": 5703217, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/Oj8Lb.jpg?s=128&g=1", "display_name": "Muhammad Faisal Iqbal", "link": "https://stackoverflow.com/users/5703217/muhammad-faisal-iqbal"}, "edited": false, "score": 1, "creation_date": 1593516030, "post_id": 58005932, "comment_id": 110802882, "body": "always try to enough info o your answer that any user can get understand it."}], "tags": [], "owner": {"reputation": 261, "user_id": 6252815, "user_type": "registered", "profile_image": "https://graph.facebook.com/1174293045936640/picture?type=large", "display_name": "Max Kirsch", "link": "https://stackoverflow.com/users/6252815/max-kirsch"}, "is_accepted": true, "score": -1, "last_activity_date": 1568878355, "creation_date": 1568878355, "answer_id": 58005932, "question_id": 57999823, "link": "https://stackoverflow.com/questions/57999823/ruby-on-rails-qr-code-with-rqrcode-gem-not-working/58005932#58005932", "title": "Ruby on Rails QR-Code with RQRCode-Gem not working", "body": "<p>Okay I fixed it myself by rendering the QR-Code as PNG and show it with the chuny_png gem's to_data_url method. Just in case somebody gets the same problem! :)</p>\n"}, {"comments": [{"owner": {"reputation": 2362, "user_id": 7434857, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/t1fC8.jpg?s=128&g=1", "display_name": "Reznik", "link": "https://stackoverflow.com/users/7434857/reznik"}, "edited": false, "score": 2, "creation_date": 1576332776, "post_id": 59335799, "comment_id": 104869727, "body": "Tries to add more inforamtino about your answer, and not just the code answer, maybe docs or some text about it"}], "tags": [], "owner": {"reputation": 1, "user_id": 7029508, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Un6Lns8Ds2Q/AAAAAAAAAAI/AAAAAAAAAYY/wAT5wrdDQac/photo.jpg?sz=128", "display_name": "Anton Kovalenko", "link": "https://stackoverflow.com/users/7029508/anton-kovalenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1576331915, "creation_date": 1576331915, "answer_id": 59335799, "question_id": 57999823, "link": "https://stackoverflow.com/questions/57999823/ruby-on-rails-qr-code-with-rqrcode-gem-not-working/59335799#59335799", "title": "Ruby on Rails QR-Code with RQRCode-Gem not working", "body": "<pre><code>&lt;div class=\"qr\"&gt;\n  &lt;%= @qr.as_html.html_safe %&gt;\n&lt;/div&gt;\n</code></pre>\n"}], "owner": {"reputation": 261, "user_id": 6252815, "user_type": "registered", "profile_image": "https://graph.facebook.com/1174293045936640/picture?type=large", "display_name": "Max Kirsch", "link": "https://stackoverflow.com/users/6252815/max-kirsch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1070, "favorite_count": 0, "accepted_answer_id": 58005932, "answer_count": 2, "score": 1, "last_activity_date": 1579884886, "creation_date": 1568836002, "question_id": 57999823, "link": "https://stackoverflow.com/questions/57999823/ruby-on-rails-qr-code-with-rqrcode-gem-not-working", "title": "Ruby on Rails QR-Code with RQRCode-Gem not working", "body": "<p>I'm trying to implement a two-factor-authentication for my Rails application and the tokens work fine, but the QR-Code isn't.</p>\n\n<p>I want to create the provisioning_uri inside the code and therefore I'm using the RQRCode-Gem, which is recommended for this.</p>\n\n<p>So basically I did everything like it's mentioned in the GitHub-Repo, but I don't get it working.</p>\n\n<p>In my Gemfile I added:</p>\n\n<pre><code>gem 'active_model_otp'\ngem 'rqrcode'\n</code></pre>\n\n<p>Then in my UsersController, I'm creating a new instance of the QR-Code library and passing in the parameters (show-Action):</p>\n\n<pre><code>@qr = RQRCode::QRCode.new(@user.provisioning_uri, :size =&gt; 8, :level =&gt; :h)\n</code></pre>\n\n<p>And then, like it's written in the Readme, I added the table for my QR-Code in my view:</p>\n\n<pre><code>&lt;table class=\"qr\"&gt;\n      &lt;% @qr.modules.each_index do |x| %&gt;\n          &lt;tr&gt;\n            &lt;% @qr.modules.each_index do |y| %&gt;\n                &lt;% if @qr.dark?(x,y) %&gt;\n                    &lt;td class=\"black\"&gt;\n                &lt;% else %&gt;\n                    &lt;td class=\"white\"&gt;\n                &lt;% end %&gt;\n            &lt;% end %&gt;\n          &lt;/tr&gt;\n      &lt;% end %&gt;\n    &lt;/table&gt;\n</code></pre>\n\n<p>I also added the necessary styles to my application.scss:</p>\n\n<pre><code>.qr {\n    border-width: 0;\n    border-style: none;\n    border-color: #0000ff;\n    border-collapse: collapse;\n    width: 50%;\n  }\n  .qr td {\n    border-width: 0;\n    border-style: none;\n    border-color: #0000ff;\n    border-collapse: collapse;\n    padding: 0;\n    margin: 0;\n    width: 10px;\n    height: 10px;\n  }\n  .qr td.black { background-color: #000; }\n  .qr td.white { background-color: #fff; }\n</code></pre>\n\n<p>So I don't think there is any fault from my side, at least I can't seem to find it.</p>\n\n<p>If I run my application now and enter my show-Page I get the following error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/efMs9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/efMs9.png\" alt=\"enter image description here\"></a></p>\n\n<p>It looks like my application can't find the resource or something.</p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 1112, "user_id": 5892163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Tfz7.jpg?s=128&g=1", "display_name": "Hackman", "link": "https://stackoverflow.com/users/5892163/hackman"}, "edited": false, "score": 0, "creation_date": 1568830795, "post_id": 57998531, "comment_id": 102403364, "body": "Maybe you can tell us about what gem you&#39;re talking?"}, {"owner": {"reputation": 641, "user_id": 1170153, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a6e81eaa257adf9f47be02cd10871e0f?s=128&d=identicon&r=PG&f=1", "display_name": "foamroll", "link": "https://stackoverflow.com/users/1170153/foamroll"}, "reply_to_user": {"reputation": 1112, "user_id": 5892163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Tfz7.jpg?s=128&g=1", "display_name": "Hackman", "link": "https://stackoverflow.com/users/5892163/hackman"}, "edited": false, "score": 1, "creation_date": 1568832908, "post_id": 57998531, "comment_id": 102404218, "body": "this helped to get a resolution -   <a href=\"https://stackoverflow.com/questions/21029195/when-do-you-need-a-require-in-a-rails-gemfile?rq=1\" title=\"when do you need a require in a rails gemfile\">stackoverflow.com/questions/21029195/&hellip;</a>"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1568837600, "post_id": 57998531, "comment_id": 102406070, "body": "what do you mean by &quot;if gem could be configured to not require this in Gemfile&quot; ?"}, {"owner": {"reputation": 641, "user_id": 1170153, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a6e81eaa257adf9f47be02cd10871e0f?s=128&d=identicon&r=PG&f=1", "display_name": "foamroll", "link": "https://stackoverflow.com/users/1170153/foamroll"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1569337868, "post_id": 57998531, "comment_id": 102560738, "body": "@lacostenycoder - to not use &quot;require&quot; in files that use the gem"}], "answers": [{"tags": [], "owner": {"reputation": 299, "user_id": 3251036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b88d9e964e6d6500c8d511cde831486?s=128&d=identicon&r=PG&f=1", "display_name": "sammygadd", "link": "https://stackoverflow.com/users/3251036/sammygadd"}, "is_accepted": false, "score": -1, "last_activity_date": 1568838150, "creation_date": 1568838150, "answer_id": 58000245, "question_id": 57998531, "link": "https://stackoverflow.com/questions/57998531/attaching-a-gem-to-rails-to-prevent-require-everywhere/58000245#58000245", "title": "&quot;Attaching&quot; a gem to Rails to prevent &quot;require&quot; everywhere?", "body": "<p>You need to specify which files you want Ruby to load for you, so you either need specify the gem in your Gemfile (and run bundle exec ...) or put require in the right place(s) in your code. There's no way around that.</p>\n\n<p>If it's a gem that you work on at the same time as you use it in another project, then you can specify a path to the gem. Like</p>\n\n<pre><code># Gemfile\nsource \"https://rubygems.org\"\nruby '2.6.1'\n\ngem 'my_gem', path: '/home/user/Development/my_gem'\n</code></pre>\n\n<p>This way, you can change your gem and use it directly without having to build and install it.</p>\n"}, {"tags": [], "owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "is_accepted": false, "score": 1, "last_activity_date": 1568848756, "last_edit_date": 1568848756, "creation_date": 1568847783, "answer_id": 58001723, "question_id": 57998531, "link": "https://stackoverflow.com/questions/57998531/attaching-a-gem-to-rails-to-prevent-require-everywhere/58001723#58001723", "title": "&quot;Attaching&quot; a gem to Rails to prevent &quot;require&quot; everywhere?", "body": "<p>In the Gemfile, you can do these things:</p>\n\n<pre><code># Require a different file than the gem's name\ngem 'foo', require: 'bar'\n\n# Install but not require anything.\n# You need to manually require the gem somewhere.\ngem 'foo', require: false\n</code></pre>\n\n<p>You can still add version and platform specification if you want.</p>\n\n<p>Real-world examples are <code>ActiveSupport</code> and <code>rspec</code>:</p>\n\n<pre><code>gem 'activesupport', '~&gt; 5.2', require: 'active_support/all'\n\ngem 'rspec', '~&gt; 3.1', group: :test, require: false\n</code></pre>\n"}], "owner": {"reputation": 641, "user_id": 1170153, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a6e81eaa257adf9f47be02cd10871e0f?s=128&d=identicon&r=PG&f=1", "display_name": "foamroll", "link": "https://stackoverflow.com/users/1170153/foamroll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1568848756, "creation_date": 1568829985, "last_edit_date": 1568831857, "question_id": 57998531, "link": "https://stackoverflow.com/questions/57998531/attaching-a-gem-to-rails-to-prevent-require-everywhere", "title": "&quot;Attaching&quot; a gem to Rails to prevent &quot;require&quot; everywhere?", "body": "<p>The name of a gem is not the same as the module. Right now I need to <code>require</code> it and <code>include</code> in various types of files, such as controllers and models. This is amounting to many <code>require</code>s which I don't have to do for other gems. It's a gem I can update. Is there a way the gem needs to be configured so it is \"attached\" to Rails, and if so, where may I find instructions to do this?</p>\n\n<p>UPDATE: using required: \"name-of-module\" in Gemfile removes need for <code>require</code> everywhere. Still wondering, if gem could be configured to not require this in Gemfile? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 1112, "user_id": 5892163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Tfz7.jpg?s=128&g=1", "display_name": "Hackman", "link": "https://stackoverflow.com/users/5892163/hackman"}, "edited": false, "score": 0, "creation_date": 1568830956, "post_id": 57998171, "comment_id": 102403427, "body": "If you have only 1 admin, you must be able to update a user to admin so there can be only 2 admins am I right?"}, {"owner": {"reputation": 29, "user_id": 8027736, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9yQylECHK4g/AAAAAAAAAAI/AAAAAAAAAWM/NEV5CRivjg0/photo.jpg?sz=128", "display_name": "Valit Laiho ", "link": "https://stackoverflow.com/users/8027736/valit-laiho"}, "reply_to_user": {"reputation": 1112, "user_id": 5892163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Tfz7.jpg?s=128&g=1", "display_name": "Hackman", "link": "https://stackoverflow.com/users/5892163/hackman"}, "edited": false, "score": 0, "creation_date": 1568832403, "post_id": 57998171, "comment_id": 102404015, "body": "@Hackman Partially. I want the ability to do more than one administrator on a list. The fact is that when I have one administrator, validation prevents me from creating a second one."}, {"owner": {"reputation": 1112, "user_id": 5892163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Tfz7.jpg?s=128&g=1", "display_name": "Hackman", "link": "https://stackoverflow.com/users/5892163/hackman"}, "edited": false, "score": 0, "creation_date": 1568832525, "post_id": 57998171, "comment_id": 102404060, "body": "So what is it that you want to validate? Do you want to validate that there will always be 1 admin, so the last admin can&#39;t be updated to user? Or do you want to validate that only a admin can update users to admin? Or both.... ?"}, {"owner": {"reputation": 29, "user_id": 8027736, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9yQylECHK4g/AAAAAAAAAAI/AAAAAAAAAWM/NEV5CRivjg0/photo.jpg?sz=128", "display_name": "Valit Laiho ", "link": "https://stackoverflow.com/users/8027736/valit-laiho"}, "reply_to_user": {"reputation": 1112, "user_id": 5892163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Tfz7.jpg?s=128&g=1", "display_name": "Hackman", "link": "https://stackoverflow.com/users/5892163/hackman"}, "edited": false, "score": 0, "creation_date": 1568832827, "post_id": 57998171, "comment_id": 102404189, "body": "@Hackman both options."}, {"owner": {"reputation": 1112, "user_id": 5892163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Tfz7.jpg?s=128&g=1", "display_name": "Hackman", "link": "https://stackoverflow.com/users/5892163/hackman"}, "edited": false, "score": 0, "creation_date": 1568833967, "post_id": 57998171, "comment_id": 102404697, "body": "For the first part you need to change your validation to check if count &gt;= 1 (it needs to be bigger then or equal to 1). If there are no accounts yet, you can skip validation to create a first account. For the second validation, I have no idea how to check how is updating the user in the model. I do know how to fix that with a custom update action."}, {"owner": {"reputation": 29, "user_id": 8027736, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9yQylECHK4g/AAAAAAAAAAI/AAAAAAAAAWM/NEV5CRivjg0/photo.jpg?sz=128", "display_name": "Valit Laiho ", "link": "https://stackoverflow.com/users/8027736/valit-laiho"}, "reply_to_user": {"reputation": 1112, "user_id": 5892163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4Tfz7.jpg?s=128&g=1", "display_name": "Hackman", "link": "https://stackoverflow.com/users/5892163/hackman"}, "edited": false, "score": 0, "creation_date": 1568834868, "post_id": 57998171, "comment_id": 102405035, "body": "@Hackman The second option you can simply register yourself through the console. Do hardcore. Not all the same to please the customer. I\u2019ll definitely try the first option. Thank you very much."}], "owner": {"reputation": 29, "user_id": 8027736, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9yQylECHK4g/AAAAAAAAAAI/AAAAAAAAAWM/NEV5CRivjg0/photo.jpg?sz=128", "display_name": "Valit Laiho ", "link": "https://stackoverflow.com/users/8027736/valit-laiho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1568831505, "creation_date": 1568828448, "question_id": 57998171, "link": "https://stackoverflow.com/questions/57998171/validation-give-me-not-correct-result", "title": "Validation give me not correct result", "body": "<p>I wrote validation which check if <code>role</code> <code>admin</code> only one, <code>role</code> doesn't update on <code>user</code>. It's work, but then I have only  one <code>admin</code> I can't update another <code>users</code> to <code>admin</code>. Wrote validation exception.</p>\n\n<p>I try write math operators, like <code>&lt;=</code> and <code>&lt;=&gt;</code> but it not working. I need what I can update <code>user</code> to <code>admin</code> if I have only one <code>admin</code>.</p>\n\n<p><strong>account.rb</strong></p>\n\n<pre><code>class Account &lt; ApplicationRecord\n  enum role: %i[user admin]\n  validate :admin_role\n\n  private\n  def admin_role\n    errors.add(:role, 'Must be one admin') if Account.where(role: :admin).count == 1\n  end\nend\n</code></pre>\n\n<p><strong>accounts_controller</strong></p>\n\n<pre><code>class AccountsController &lt; ApplicationController\n    def index\n      @accounts = Account.all.order(:id)\n    end\n\n    def update\n      @account = Account.find(params[:id])\n      if @account.valid? \n        @account.update(role: params[:role])\n      else\n        flash[:danger] = @account.errors.full_messages\n      end\n      redirect_to accounts_path\n    end\n  end\n</code></pre>\n\n<p><strong>schema.rb</strong></p>\n\n<pre><code>create_table \"accounts\", force: :cascade do |t|\n  t.integer \"role\", default: 0\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 1, "creation_date": 1568824190, "post_id": 57997003, "comment_id": 102400778, "body": "<code>def send_action(action, uuid = nil, &amp;success_block)</code> Works For Me\u2122. What error are you seeing? And what version of Ruby are you using?"}], "answers": [{"comments": [{"owner": {"reputation": 1648, "user_id": 1610548, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a1572f89ae593aefced85b8494479098?s=128&d=identicon&r=PG", "display_name": "rept", "link": "https://stackoverflow.com/users/1610548/rept"}, "edited": false, "score": 0, "creation_date": 1568843154, "post_id": 57997235, "comment_id": 102407953, "body": "You are correct, I had a missing comma.  Both work fine, thanks for the example!"}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 2, "last_activity_date": 1568824397, "creation_date": 1568824397, "answer_id": 57997235, "question_id": 57997003, "link": "https://stackoverflow.com/questions/57997003/use-named-parameters-with-block-in-ruby/57997235#57997235", "title": "Use named parameters with block in Ruby", "body": "<p>Both work with Ruby 2.4.4 and 2.6.4. Here's a demonstration with positional parameters.</p>\n\n<pre><code>def send_action(action, uuid = nil, &amp;success_block)\n  p \"#{action} #{uuid}\"\n  success_block.call\nend\n\nsend_action(\"foo\") { p 99 }\n\"foo \"\n99\n\nsend_action(\"foo\", \"bar\") { p 99 }\n\"foo bar\"\n99\n</code></pre>\n\n<p>And with named parameters.</p>\n\n<pre><code>def send_action(action:, uuid: nil, &amp;success_block)\n  p \"#{action} #{uuid}\"\n  success_block.call\nend\n\nsend_action(action: \"foo\") { p 99 }\n\"foo \"\n99\n\nsend_action(action: \"foo\", uuid: \"bar\") { p 99 }\n\"foo bar\"\n99\n</code></pre>\n"}], "owner": {"reputation": 1648, "user_id": 1610548, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a1572f89ae593aefced85b8494479098?s=128&d=identicon&r=PG", "display_name": "rept", "link": "https://stackoverflow.com/users/1610548/rept"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 57997235, "answer_count": 1, "score": 0, "last_activity_date": 1568824397, "creation_date": 1568823458, "question_id": 57997003, "link": "https://stackoverflow.com/questions/57997003/use-named-parameters-with-block-in-ruby", "title": "Use named parameters with block in Ruby", "body": "<p>I used to have this method:</p>\n\n<pre><code>def send_action(action, &amp;success_block)\n\nend\n</code></pre>\n\n<p>Which I could call like this:</p>\n\n<pre><code>send_action('PAIR') do\n  pp 'test\nend\n</code></pre>\n\n<p>Now I want to add an optional parameter:</p>\n\n<pre><code>def send_action(action, uuid = nil, &amp;success_block)\n\nend\n</code></pre>\n\n<p>But that doesn't seem to work (which I though).  So I tried writing it with named parameters:</p>\n\n<pre><code>def send_action(action:, uuid: nil, &amp;success_block)\n\nend\n</code></pre>\n\n<p>But how can I combine named parameters with a block?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "sidekiq"], "answers": [{"comments": [{"owner": {"reputation": 266, "user_id": 5779471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d4fd2113141c6c85e7b9c3052b1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Miro", "link": "https://stackoverflow.com/users/5779471/miro"}, "edited": false, "score": 0, "creation_date": 1568824916, "post_id": 57996555, "comment_id": 102401088, "body": "I changed it to ENV[&#39;REDIS_URL&#39;] and ENV[&#39;REDISTOGO_URL&#39;] but still not working. Why Heroku still displays: Error connecting to Redis on localhost:6379 (Errno::ECONNREFUSED)?"}, {"owner": {"reputation": 967, "user_id": 1106710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wscQp.jpg?s=128&g=1", "display_name": "Adam McCrea", "link": "https://stackoverflow.com/users/1106710/adam-mccrea"}, "edited": false, "score": 0, "creation_date": 1568827912, "post_id": 57996555, "comment_id": 102402233, "body": "<code>localhost:6379</code> is hardcoded in two places in your <code>sidekiq.rb</code>. Did you change them both?"}, {"owner": {"reputation": 266, "user_id": 5779471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d4fd2113141c6c85e7b9c3052b1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Miro", "link": "https://stackoverflow.com/users/5779471/miro"}, "reply_to_user": {"reputation": 967, "user_id": 1106710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wscQp.jpg?s=128&g=1", "display_name": "Adam McCrea", "link": "https://stackoverflow.com/users/1106710/adam-mccrea"}, "edited": false, "score": 0, "creation_date": 1568828798, "post_id": 57996555, "comment_id": 102402559, "body": "@AdamMcCrea Yes :) in configure_server and configure_client"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1568831958, "post_id": 57996555, "comment_id": 102403842, "body": "please, attach the full stacktrace"}, {"owner": {"reputation": 266, "user_id": 5779471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d4fd2113141c6c85e7b9c3052b1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Miro", "link": "https://stackoverflow.com/users/5779471/miro"}, "edited": false, "score": 0, "creation_date": 1568836286, "post_id": 57996555, "comment_id": 102405586, "body": "@mrzasa Just added above :)"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1568837235, "post_id": 57996555, "comment_id": 102405943, "body": "I&#39;d rather need the part of the logs that contain the stacktrace of the redis error. Most probably the sidekiq logs."}, {"owner": {"reputation": 266, "user_id": 5779471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d4fd2113141c6c85e7b9c3052b1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Miro", "link": "https://stackoverflow.com/users/5779471/miro"}, "edited": false, "score": 0, "creation_date": 1568843390, "post_id": 57996555, "comment_id": 102408023, "body": "OK, I just added sidekiq logs too. From localhost, because I don&#39;t know how to look into sidekiq logs on heroku."}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1568883608, "post_id": 57996555, "comment_id": 102419256, "body": "On localhost - you can&#39;t connect to the DB, becasue you don&#39;t have connections in pool, you need to increase it (a topic for another question). In heroku without logs it&#39;s hard to say <a href=\"https://stackoverflow.com/questions/37969031/exec-sidekiq-log-on-heroku\" title=\"exec sidekiq log on heroku\">stackoverflow.com/questions/37969031/exec-sidekiq-log-on-her&zwnj;&#8203;oku</a> <a href=\"https://github.com/mperham/sidekiq/issues/3267\" rel=\"nofollow noreferrer\">github.com/mperham/sidekiq/issues/3267</a>"}, {"owner": {"reputation": 266, "user_id": 5779471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d4fd2113141c6c85e7b9c3052b1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Miro", "link": "https://stackoverflow.com/users/5779471/miro"}, "edited": false, "score": 0, "creation_date": 1568884962, "post_id": 57996555, "comment_id": 102419981, "body": "@mrzasa Thanks for the link. I just added heroku logs for worker. Hmm it looks like problem with Redis version..."}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1568886052, "post_id": 57996555, "comment_id": 102420573, "body": "Yeah, it looks like so."}, {"owner": {"reputation": 266, "user_id": 5779471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d4fd2113141c6c85e7b9c3052b1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Miro", "link": "https://stackoverflow.com/users/5779471/miro"}, "edited": false, "score": 0, "creation_date": 1568887638, "post_id": 57996555, "comment_id": 102421466, "body": "I installed redis 4.1.3 (was 4.1.2) but on Heroku still is the same log with version of Redis."}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1568887970, "post_id": 57996555, "comment_id": 102421644, "body": "Where did you installed it? It seems that your provider have outdated redis"}, {"owner": {"reputation": 266, "user_id": 5779471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d4fd2113141c6c85e7b9c3052b1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Miro", "link": "https://stackoverflow.com/users/5779471/miro"}, "edited": false, "score": 0, "creation_date": 1568888217, "post_id": 57996555, "comment_id": 102421778, "body": "Hmm, I installed it on localhost and I pushed updated Gemfile and Gemfile.lock to Heroku."}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1568888247, "post_id": 57996555, "comment_id": 102421803, "body": "Check redis DB version in  redis to go."}, {"owner": {"reputation": 266, "user_id": 5779471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d4fd2113141c6c85e7b9c3052b1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Miro", "link": "https://stackoverflow.com/users/5779471/miro"}, "edited": false, "score": 0, "creation_date": 1568891167, "post_id": 57996555, "comment_id": 102423368, "body": "When I click on Redis To Go link on Heroku I see only: Version 3.2.12."}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 1, "creation_date": 1568891323, "post_id": 57996555, "comment_id": 102423451, "body": "Yeah, it&#39;s default for them: <a href=\"https://devcenter.heroku.com/articles/redistogo#redis-3-2\" rel=\"nofollow noreferrer\">devcenter.heroku.com/articles/redistogo#redis-3-2</a>. Either contact them to get a newer version, or change the provider."}, {"owner": {"reputation": 266, "user_id": 5779471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d4fd2113141c6c85e7b9c3052b1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Miro", "link": "https://stackoverflow.com/users/5779471/miro"}, "edited": false, "score": 0, "creation_date": 1568894170, "post_id": 57996555, "comment_id": 102425050, "body": "Thanks for help, I sent an email to them :)"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1568894434, "post_id": 57996555, "comment_id": 102425205, "body": "You&#39;re welcome :). Upvote &amp; accept would be nice in exchange of that :)."}, {"owner": {"reputation": 266, "user_id": 5779471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d4fd2113141c6c85e7b9c3052b1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Miro", "link": "https://stackoverflow.com/users/5779471/miro"}, "edited": false, "score": 2, "creation_date": 1568984559, "post_id": 57996555, "comment_id": 102460200, "body": "Redis To Go answeared me that they can&#39;t upgrade Redis version to &gt;=4 at this moment, because they use v3 :)"}, {"owner": {"reputation": 2337, "user_id": 346613, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ulyAz.png?s=128&g=1", "display_name": "Bazley", "link": "https://stackoverflow.com/users/346613/bazley"}, "edited": false, "score": 0, "creation_date": 1571081095, "post_id": 57996555, "comment_id": 103113955, "body": "I have the same problem. Did you come up with a solution?"}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 2, "last_activity_date": 1568821643, "creation_date": 1568821643, "answer_id": 57996555, "question_id": 57996477, "link": "https://stackoverflow.com/questions/57996477/rails-sidekiq-redis-on-heroku-something-wrong/57996555#57996555", "title": "Rails, Sidekiq, Redis on Heroku - something wrong", "body": "<p>You have your redis URL hardcoded in <code>config/initializers/sidekiq.rb</code></p>\n\n<p>Instead of:</p>\n\n<pre><code>config.redis = { url: 'redis://localhost:6379/0' } \n</code></pre>\n\n<p>use</p>\n\n<pre><code>config.redis = { url: ENV['REDIS_URL'] }\n</code></pre>\n\n<p>and ensure <code>REDIS_URL</code> set correctly on heroku (maybe set it manually or maybe the add-on or heroku takes care of it, I don't remember).</p>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 12162076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5m9m2.jpg?s=128&g=1", "display_name": "John Coote", "link": "https://stackoverflow.com/users/12162076/john-coote"}, "is_accepted": false, "score": 9, "last_activity_date": 1572764472, "creation_date": 1572764472, "answer_id": 58678076, "question_id": 57996477, "link": "https://stackoverflow.com/questions/57996477/rails-sidekiq-redis-on-heroku-something-wrong/58678076#58678076", "title": "Rails, Sidekiq, Redis on Heroku - something wrong", "body": "<p>Seems to be a versioning issue: </p>\n\n<p>Sidekiq 6 requires Redis 4, but RedisToGo as provided by Heroku is still using Redis 3.x\nI stepped around the problem by specifying in my Gemfile:</p>\n\n<p><code>gem 'sidekiq', '5.2.7'</code></p>\n"}, {"comments": [{"owner": {"reputation": 781, "user_id": 5934704, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156492299675099/picture?type=large", "display_name": "Michael Evans", "link": "https://stackoverflow.com/users/5934704/michael-evans"}, "edited": false, "score": 3, "creation_date": 1578921908, "post_id": 58737548, "comment_id": 105585641, "body": "should probably be accepted answer, it fixed the issue for me it&#39;s also worth pointing out that the config values <code>REDISTOGO_URL</code> and <code>REDIS_PROVIDER</code> can be unset in this case"}], "tags": [], "owner": {"reputation": 2205, "user_id": 6460122, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/WTsp7.jpg?s=128&g=1", "display_name": "ricks", "link": "https://stackoverflow.com/users/6460122/ricks"}, "is_accepted": false, "score": 14, "last_activity_date": 1573069953, "creation_date": 1573069953, "answer_id": 58737548, "question_id": 57996477, "link": "https://stackoverflow.com/questions/57996477/rails-sidekiq-redis-on-heroku-something-wrong/58737548#58737548", "title": "Rails, Sidekiq, Redis on Heroku - something wrong", "body": "<p>John is correct, Sidekiq 6 requires at least Redis 4, but Redis To Go has not updated from version 3.</p>\n\n<p>Instead of downgrading to meet the requirements of Redis To Go i would recommended moving dependencies.</p>\n\n<p>Since you are using Heroku, <a href=\"https://stackshare.io/stackups/heroku-redis-vs-redis-cloud-vs-redis-to-go\" rel=\"noreferrer\">two popular alternatives</a> are <a href=\"https://elements.heroku.com/addons/heroku-redis\" rel=\"noreferrer\">Heroku Redis</a> and <a href=\"https://elements.heroku.com/addons/rediscloud\" rel=\"noreferrer\">Redis Cloud</a>.</p>\n\n<p>Since Redis 4 was released 2.5 years ago and Redis 5 is already released, its safe to say that Redis To Go is falling behind and you should strongly consider moving to a dependency that gets updated more frequently.</p>\n\n<p>Neglecting to do so will be more difficult in the long run.</p>\n"}], "owner": {"reputation": 266, "user_id": 5779471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d4fd2113141c6c85e7b9c3052b1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Miro", "link": "https://stackoverflow.com/users/5779471/miro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2138, "favorite_count": 1, "answer_count": 3, "score": 4, "last_activity_date": 1573069953, "creation_date": 1568821326, "last_edit_date": 1568884892, "question_id": 57996477, "link": "https://stackoverflow.com/questions/57996477/rails-sidekiq-redis-on-heroku-something-wrong", "title": "Rails, Sidekiq, Redis on Heroku - something wrong", "body": "<p>I have a problem with my Rails app.</p>\n\n<p>App based on Ruby on Rails with Sidekiq, Redis and deployed on Heroku.\nI don't know why my worker doesn't work on Heroku. I think something is wrong in my settings.</p>\n\n<p><b>config/initializers/sidekiq.rb</b></p>\n\n<pre><code>Sidekiq.configure_server do |config|\n  config.redis = { url: 'redis://localhost:6379/0' }\n  schedule_file = \"config/sidekiq.yml\"\n  if File.exists?(schedule_file)\n    Sidekiq::Cron::Job.load_from_hash YAML.load_file(schedule_file)\n  end\nend\n\nSidekiq.configure_client do |config|\n  config.redis = { url: 'redis://localhost:6379/0' }\nend\n</code></pre>\n\n<p><b>workers/my_worker.rb</b></p>\n\n<pre><code>class MyWorker\n\n  include Sidekiq::Worker\n\n  def perform\n    ......\n  end\nend\n</code></pre>\n\n<p><b>config/sidekiq.yml</b></p>\n\n<pre><code>my_photos:\n  cron: \"30 3 */2 * *\"\n  class: \"MyWorker\"\n  queue: default\n</code></pre>\n\n<p><b>Procfile</b></p>\n\n<pre><code>web: bundle exec rails server -p $PORT\nworker: bundle exec sidekiq -e production\n</code></pre>\n\n<p><b>application.rb</b> includes line:</p>\n\n<pre><code>config.active_job.queue_adapter = :sidekiq\n</code></pre>\n\n<p>I have installed <b>Redis To Go</b> on Heroku.</p>\n\n<p><b>Heroku config:</b></p>\n\n<pre><code>REDISTOGO_URL: redis://redistogo:2085d9ff......\nREDIS_PROVIDER: REDISTOGO_URL\n.\n.\n.\n</code></pre>\n\n<p>Everything works fine on localhost development and production mode (worker too) but on Heroku worker doesn't work well.</p>\n\n<p>Some errors:</p>\n\n<blockquote>\n  <p>Error connecting to Redis on localhost:6379 (Errno::ECONNREFUSED)</p>\n</blockquote>\n\n<p><b>heroku ps</b> in console displays:</p>\n\n<pre><code>=== web (Free): bundle exec rails server -p $PORT (1)\nweb.1: up 2019/09/18 16:57:03 +0200\n\n=== worker (Free): bundle exec sidekiq -e production (1)\nworker.1: crashed 2019/09/18 17:27:42 +0200\n</code></pre>\n\n<p>Yes, I restarted Heroku.</p>\n\n<p><b>***</b></p>\n\n<p><b>Heroku logs after change config.redis to ENV['REDISTOGO_URL'] in sidekiq.rb</b></p>\n\n<pre><code>2019-09-18T16:29:30.621771+00:00 app[web.1]: =&gt; Booting Puma\n2019-09-18T16:29:30.621789+00:00 app[web.1]: =&gt; Rails 5.2.3 application starting in production\n2019-09-18T16:29:30.62179+00:00 app[web.1]: =&gt; Run `rails server -h` for more startup options\n2019-09-18T16:29:30.621791+00:00 app[web.1]: Puma starting in single mode...\n2019-09-18T16:29:30.621792+00:00 app[web.1]: * Version 3.12.1 (ruby 2.6.1-p33), codename: Llamas in Pajamas\n2019-09-18T16:29:30.621793+00:00 app[web.1]: * Min threads: 5, max threads: 5\n2019-09-18T16:29:30.621796+00:00 app[web.1]: * Environment: production\n2019-09-18T16:29:30.621797+00:00 app[web.1]: * Listening on tcp://0.0.0.0:42164\n2019-09-18T16:29:30.621798+00:00 app[web.1]: Use Ctrl-C to stop\n2019-09-18T16:29:30.621799+00:00 app[web.1]: I, [2019-09-18T16:29:30.621672 #4]  INFO -- : [2fa14d58-5519-456e-a527-9cf4ed462e86] Started GET \"/dogs\" for 195.136.56.0 at 2019-09-18 16:29:30 +0000\n2019-09-18T16:29:30.62264+00:00 app[web.1]: I, [2019-09-18T16:29:30.622583 #4]  INFO -- : [2fa14d58-5519-456e-a527-9cf4ed462e86] Processing by DogsController#index as HTML\n2019-09-18T16:29:30.683193+00:00 app[web.1]: D, [2019-09-18T16:29:30.683061 #4] DEBUG -- : [2fa14d58-5519-456e-a527-9cf4ed462e86]   User Load (1.2ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 ORDER BY \"users\".\"id\" ASC LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\n2019-09-18T16:29:30.704369+00:00 app[web.1]: I, [2019-09-18T16:29:30.704248 #4]  INFO -- : [2fa14d58-5519-456e-a527-9cf4ed462e86]   Rendering dogs/index.html.erb within layouts/application\n2019-09-18T16:29:30.708316+00:00 app[web.1]: D, [2019-09-18T16:29:30.708230 #4] DEBUG -- : [2fa14d58-5519-456e-a527-9cf4ed462e86]   Dog Load (1.5ms)  SELECT  \"dogs\".* FROM \"dogs\" ORDER BY created_at DESC LIMIT $1 OFFSET $2  [[\"LIMIT\", 24], [\"OFFSET\", 0]]\n2019-09-18T16:29:30.715597+00:00 app[web.1]: I, [2019-09-18T16:29:30.715534 #4]  INFO -- : [2fa14d58-5519-456e-a527-9cf4ed462e86]   Rendered dogs/index.html.erb within layouts/application (11.2ms)\n2019-09-18T16:29:30.718909+00:00 app[web.1]: I, [2019-09-18T16:29:30.718852 #4]  INFO -- : [2fa14d58-5519-456e-a527-9cf4ed462e86] Completed 200 OK in 96ms (Views: 13.8ms | ActiveRecord: 28.1ms)\n2019-09-18T16:29:32.200757+00:00 heroku[router]: at=info method=GET path=\"/favicon.ico\" host=myappaddress.herokuapp.com request_id=77ecb62d-e044-4eee-be8c-a0f0749af788 fwd=\"195.136.56.0\" dyno=web.1 connect=0ms service=1ms status=200 bytes=143 protocol=https\n2019-09-18T16:29:32.047254+00:00 app[web.1]: I, [2019-09-18T16:29:32.047168 #4]  INFO -- : [2bfdeee1-c974-4a9e-97ac-659f58d14a0d] Started GET \"/dogs\" for 195.136.56.0 at 2019-09-18 16:29:32 +0000\n2019-09-18T16:29:32.047891+00:00 app[web.1]: I, [2019-09-18T16:29:32.047835 #4]  INFO -- : [2bfdeee1-c974-4a9e-97ac-659f58d14a0d] Processing by DogsController#index as HTML\n2019-09-18T16:29:32.051783+00:00 app[web.1]: D, [2019-09-18T16:29:32.051719 #4] DEBUG -- : [2bfdeee1-c974-4a9e-97ac-659f58d14a0d]   User Load (1.0ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 ORDER BY \"users\".\"id\" ASC LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\n2019-09-18T16:29:32.053487+00:00 app[web.1]: I, [2019-09-18T16:29:32.053403 #4]  INFO -- : [2bfdeee1-c974-4a9e-97ac-659f58d14a0d]   Rendering dogs/index.html.erb within layouts/application\n2019-09-18T16:29:32.054812+00:00 app[web.1]: D, [2019-09-18T16:29:32.054749 #4] DEBUG -- : [2bfdeee1-c974-4a9e-97ac-659f58d14a0d]   Dog Load (1.0ms)  SELECT  \"dogs\".* FROM \"dogs\" ORDER BY created_at DESC LIMIT $1 OFFSET $2  [[\"LIMIT\", 24], [\"OFFSET\", 0]]\n2019-09-18T16:29:32.055346+00:00 app[web.1]: I, [2019-09-18T16:29:32.055289 #4]  INFO -- : [2bfdeee1-c974-4a9e-97ac-659f58d14a0d]   Rendered dogs/index.html.erb within layouts/application (1.8ms)\n2019-09-18T16:29:32.056958+00:00 app[web.1]: I, [2019-09-18T16:29:32.056901 #4]  INFO -- : [2bfdeee1-c974-4a9e-97ac-659f58d14a0d] Completed 200 OK in 9ms (Views: 2.7ms | ActiveRecord: 1.9ms)\n2019-09-18T16:29:32.059156+00:00 heroku[router]: at=info method=GET path=\"/dogs\" host=myappaddress.herokuapp.com request_id=2bfdeee1-c974-4a9e-97ac-659f58d14a0d fwd=\"195.136.56.0\" dyno=web.1 connect=0ms service=14ms status=200 bytes=2828 protocol=https\n2019-09-18T16:29:33.373311+00:00 heroku[router]: at=info method=GET path=\"/dogs\" host=myappaddress.herokuapp.com request_id=953acff7-12c6-4876-99eb-57686a8e054b fwd=\"195.136.56.0\" dyno=web.1 connect=0ms service=15ms status=200 bytes=2850 protocol=https\n2019-09-18T16:29:33.360115+00:00 app[web.1]: I, [2019-09-18T16:29:33.360015 #4]  INFO -- : [953acff7-12c6-4876-99eb-57686a8e054b] Started GET \"/dogs\" for 195.136.56.0 at 2019-09-18 16:29:33 +0000\n2019-09-18T16:29:33.360839+00:00 app[web.1]: I, [2019-09-18T16:29:33.360763 #4]  INFO -- : [953acff7-12c6-4876-99eb-57686a8e054b] Processing by DogsController#index as HTML\n2019-09-18T16:29:33.364996+00:00 app[web.1]: D, [2019-09-18T16:29:33.364927 #4] DEBUG -- : [953acff7-12c6-4876-99eb-57686a8e054b]   User Load (0.9ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 ORDER BY \"users\".\"id\" ASC LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\n2019-09-18T16:29:33.36734+00:00 app[web.1]: I, [2019-09-18T16:29:33.367264 #4]  INFO -- : [953acff7-12c6-4876-99eb-57686a8e054b]   Rendering dogs/index.html.erb within layouts/application\n2019-09-18T16:29:33.368712+00:00 app[web.1]: D, [2019-09-18T16:29:33.368637 #4] DEBUG -- : [953acff7-12c6-4876-99eb-57686a8e054b]   Dog Load (1.0ms)  SELECT  \"dogs\".* FROM \"dogs\" ORDER BY created_at DESC LIMIT $1 OFFSET $2  [[\"LIMIT\", 24], [\"OFFSET\", 0]]\n2019-09-18T16:29:33.370049+00:00 app[web.1]: I, [2019-09-18T16:29:33.369947 #4]  INFO -- : [953acff7-12c6-4876-99eb-57686a8e054b]   Rendered dogs/index.html.erb within layouts/application (2.6ms)\n2019-09-18T16:29:33.371552+00:00 app[web.1]: I, [2019-09-18T16:29:33.371479 #4]  INFO -- : [953acff7-12c6-4876-99eb-57686a8e054b] Completed 200 OK in 10ms (Views: 2.8ms | ActiveRecord: 1.9ms)\n2019-09-18T16:29:33.506177+00:00 heroku[router]: at=info method=GET path=\"/favicon.ico\" host=myappaddress.herokuapp.com request_id=11c98ea8-5df1-4a9f-9a5a-fb609bf1f9b1 fwd=\"195.136.56.0\" dyno=web.1 connect=0ms service=1ms status=200 bytes=143 protocol=https\n2019-09-18T16:29:37.398927+00:00 heroku[web.1]: source=web.1 dyno=heroku.146423817.b27d01ed-7668-4c8c-9451-68f3c0f447c7 sample#memory_total=143.53MB sample#memory_rss=104.20MB sample#memory_cache=39.34MB sample#memory_swap=0.00MB sample#memory_pgpgin=51710pages sample#memory_pgpgout=14966pages sample#memory_quota=512.00MB\n2019-09-18T16:29:54.267638+00:00 app[api]: Starting process with command `bin/rails console` by user myemail@o2.pl\n2019-09-18T16:29:55.487272+00:00 heroku[router]: at=info method=GET path=\"/dogs\" host=myappaddress.herokuapp.com request_id=4318929d-efc2-4ad1-ad0d-c0a9ae155a8c fwd=\"195.136.56.0\" dyno=web.1 connect=0ms service=14ms status=200 bytes=2840 protocol=https\n2019-09-18T16:29:55.474089+00:00 app[web.1]: I, [2019-09-18T16:29:55.473957 #4]  INFO -- : [4318929d-efc2-4ad1-ad0d-c0a9ae155a8c] Started GET \"/dogs\" for 195.136.56.0 at 2019-09-18 16:29:55 +0000\n2019-09-18T16:29:55.475425+00:00 app[web.1]: I, [2019-09-18T16:29:55.475356 #4]  INFO -- : [4318929d-efc2-4ad1-ad0d-c0a9ae155a8c] Processing by DogsController#index as HTML\n2019-09-18T16:29:55.478716+00:00 app[web.1]: D, [2019-09-18T16:29:55.478637 #4] DEBUG -- : [4318929d-efc2-4ad1-ad0d-c0a9ae155a8c]   User Load (1.1ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 ORDER BY \"users\".\"id\" ASC LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\n2019-09-18T16:29:55.480624+00:00 app[web.1]: I, [2019-09-18T16:29:55.480549 #4]  INFO -- : [4318929d-efc2-4ad1-ad0d-c0a9ae155a8c]   Rendering dogs/index.html.erb within layouts/application\n2019-09-18T16:29:55.481962+00:00 app[web.1]: D, [2019-09-18T16:29:55.481884 #4] DEBUG -- : [4318929d-efc2-4ad1-ad0d-c0a9ae155a8c]   Dog Load (1.0ms)  SELECT  \"dogs\".* FROM \"dogs\" ORDER BY created_at DESC LIMIT $1 OFFSET $2  [[\"LIMIT\", 24], [\"OFFSET\", 0]]\n2019-09-18T16:29:55.483895+00:00 app[web.1]: I, [2019-09-18T16:29:55.483823 #4]  INFO -- : [4318929d-efc2-4ad1-ad0d-c0a9ae155a8c]   Rendered dogs/index.html.erb within layouts/application (3.2ms)\n2019-09-18T16:29:55.484818+00:00 app[web.1]: I, [2019-09-18T16:29:55.484747 #4]  INFO -- : [4318929d-efc2-4ad1-ad0d-c0a9ae155a8c] Completed 200 OK in 9ms (Views: 3.4ms | ActiveRecord: 2.0ms)\n2019-09-18T16:29:55.629132+00:00 heroku[router]: at=info method=GET path=\"/favicon.ico\" host=myappaddress.herokuapp.com request_id=d2dc2b32-bf0c-42b0-b0ee-e688014a1858 fwd=\"195.136.56.0\" dyno=web.1 connect=0ms service=2ms status=200 bytes=143 protocol=https\n2019-09-18T16:29:56.6973+00:00 heroku[router]: at=info method=GET path=\"/dogs\" host=myappaddress.herokuapp.com request_id=22b98e70-0f07-4ac8-a93e-ba2d0df3ccbf fwd=\"195.136.56.0\" dyno=web.1 connect=1ms service=14ms status=200 bytes=2850 protocol=https\n2019-09-18T16:29:56.832815+00:00 heroku[router]: at=info method=GET path=\"/favicon.ico\" host=myappaddress.herokuapp.com request_id=d76015da-381e-422d-8cfa-60d277ead4b8 fwd=\"195.136.56.0\" dyno=web.1 connect=0ms service=1ms status=200 bytes=143 protocol=https\n2019-09-18T16:29:56.683482+00:00 app[web.1]: I, [2019-09-18T16:29:56.683384 #4]  INFO -- : [22b98e70-0f07-4ac8-a93e-ba2d0df3ccbf] Started GET \"/dogs\" for 195.136.56.0 at 2019-09-18 16:29:56 +0000\n2019-09-18T16:29:56.684878+00:00 app[web.1]: I, [2019-09-18T16:29:56.684813 #4]  INFO -- : [22b98e70-0f07-4ac8-a93e-ba2d0df3ccbf] Processing by DogsController#index as HTML\n2019-09-18T16:29:56.688315+00:00 app[web.1]: D, [2019-09-18T16:29:56.688210 #4] DEBUG -- : [22b98e70-0f07-4ac8-a93e-ba2d0df3ccbf]   User Load (1.1ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 ORDER BY \"users\".\"id\" ASC LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\n2019-09-18T16:29:56.690898+00:00 app[web.1]: I, [2019-09-18T16:29:56.690833 #4]  INFO -- : [22b98e70-0f07-4ac8-a93e-ba2d0df3ccbf]   Rendering dogs/index.html.erb within layouts/application\n2019-09-18T16:29:56.692612+00:00 app[web.1]: D, [2019-09-18T16:29:56.692550 #4] DEBUG -- : [22b98e70-0f07-4ac8-a93e-ba2d0df3ccbf]   Dog Load (1.1ms)  SELECT  \"dogs\".* FROM \"dogs\" ORDER BY created_at DESC LIMIT $1 OFFSET $2  [[\"LIMIT\", 24], [\"OFFSET\", 0]]\n2019-09-18T16:29:56.693963+00:00 app[web.1]: I, [2019-09-18T16:29:56.693898 #4]  INFO -- : [22b98e70-0f07-4ac8-a93e-ba2d0df3ccbf]   Rendered dogs/index.html.erb within layouts/application (2.9ms)\n2019-09-18T16:29:56.695684+00:00 app[web.1]: I, [2019-09-18T16:29:56.695620 #4]  INFO -- : [22b98e70-0f07-4ac8-a93e-ba2d0df3ccbf] Completed 200 OK in 11ms (Views: 3.9ms | ActiveRecord: 2.2ms)\n2019-09-18T16:29:58.295567+00:00 app[web.1]: I, [2019-09-18T16:29:58.295456 #4]  INFO -- : [98a19c4a-cdda-4112-bb38-5869ede78b49] Started GET \"/dogs\" for 195.136.56.0 at 2019-09-18 16:29:58 +0000\n2019-09-18T16:29:58.297473+00:00 app[web.1]: I, [2019-09-18T16:29:58.297393 #4]  INFO -- : [98a19c4a-cdda-4112-bb38-5869ede78b49] Processing by DogsController#index as HTML\n2019-09-18T16:29:58.301213+00:00 app[web.1]: D, [2019-09-18T16:29:58.301128 #4] DEBUG -- : [98a19c4a-cdda-4112-bb38-5869ede78b49]   User Load (1.0ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 ORDER BY \"users\".\"id\" ASC LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\n2019-09-18T18:45:05.749467+00:00 heroku[web.1]: source=web.1 dyno=heroku.146423817.2c282eb9-e271-478a-a164-ab1ee7b48d15 sample#load_avg_1m=0.35\n2019-09-18T18:45:05.779083+00:00 heroku[web.1]: source=web.1 dyno=heroku.146423817.2c282eb9-e271-478a-a164-ab1ee7b48d15 sample#memory_total=141.63MB sample#memory_rss=102.39MB sample#memory_cache=39.24MB sample#memory_swap=0.00MB sample#memory_pgpgin=51236pages sample#memory_pgpgout=14978pages sample#memory_quota=512.00MB\n</code></pre>\n\n<p><b>Sidekiq logs:</b></p>\n\n<pre><code>2019-09-18T21:42:34.875Z pid=2604 tid=gmvw62cjk class=FlickrWorker jid=d4d37c3accf6190b8193758d elapsed=5.561 INFO: fail\n2019-09-18T21:42:34.875Z pid=2604 tid=gmvw62cjk WARN: {\"context\":\"Job raised exception\",\"job\":{\"queue\":\"default\",\"args\":[],\"class\":\"FlickrWorker\",\"retry\":true,\"jid\":\"d4d37c3accf6190b8193758d\",\"created_at\":1568805601.6104372,\"enqueued_at\":1568842949.307712,\"error_message\":\"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use\",\"error_class\":\"ActiveRecord::ConnectionTimeoutError\",\"failed_at\":1568805607.190152,\"retry_count\":5,\"retried_at\":1568806408.705434},\"jobstr\":\"{\\\"queue\\\":\\\"default\\\",\\\"args\\\":[],\\\"class\\\":\\\"FlickrWorker\\\",\\\"retry\\\":true,\\\"jid\\\":\\\"d4d37c3accf6190b8193758d\\\",\\\"created_at\\\":1568805601.6104372,\\\"enqueued_at\\\":1568842949.307712,\\\"error_message\\\":\\\"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use\\\",\\\"error_class\\\":\\\"ActiveRecord::ConnectionTimeoutError\\\",\\\"failed_at\\\":1568805607.190152,\\\"retry_count\\\":5,\\\"retried_at\\\":1568806408.705434}\"}\n2019-09-18T21:42:34.875Z pid=2604 tid=gmvw62cjk WARN: ActiveRecord::ConnectionTimeoutError: could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use\n2019-09-18T21:42:34.875Z pid=2604 tid=gmvw62cjk WARN: /home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:201:in `block in wait_poll'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:190:in `loop'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:190:in `wait_poll'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:151:in `internal_poll'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:277:in `internal_poll'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:145:in `block in poll'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/2.6.0/monitor.rb:230:in `mon_synchronize'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:155:in `synchronize'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:145:in `poll'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:799:in `acquire_connection'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:523:in `checkout'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:382:in `connection'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:1014:in `retrieve_connection'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/activerecord-5.2.3/lib/active_record/connection_handling.rb:118:in `retrieve_connection'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/activerecord-5.2.3/lib/active_record/connection_handling.rb:90:in `connection'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/activerecord-5.2.3/lib/active_record/relation/calculations.rb:196:in `block in pluck'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/activerecord-5.2.3/lib/active_record/relation.rb:584:in `skip_query_cache_if_necessary'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/activerecord-5.2.3/lib/active_record/relation/calculations.rb:196:in `pluck'\n/home/miro/ror/my-app/app/workers/flickr_worker.rb:11:in `block in perform'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/flickraw-0.9.10/lib/flickraw/response.rb:42:in `block in each'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/flickraw-0.9.10/lib/flickraw/response.rb:42:in `each'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/flickraw-0.9.10/lib/flickraw/response.rb:42:in `each'\n/home/miro/ror/my-app/app/workers/flickr_worker.rb:11:in `reject'\n/home/miro/ror/my-app/app/workers/flickr_worker.rb:11:in `perform'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/sidekiq-6.0.0/lib/sidekiq/processor.rb:193:in `execute_job'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/sidekiq-6.0.0/lib/sidekiq/processor.rb:161:in `block (2 levels) in process'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/sidekiq-6.0.0/lib/sidekiq/middleware/chain.rb:129:in `block in invoke'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/sidekiq-6.0.0/lib/sidekiq/middleware/chain.rb:134:in `invoke'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/sidekiq-6.0.0/lib/sidekiq/processor.rb:160:in `block in process'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/sidekiq-6.0.0/lib/sidekiq/processor.rb:133:in `block (6 levels) in dispatch'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/sidekiq-6.0.0/lib/sidekiq/job_retry.rb:107:in `local'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/sidekiq-6.0.0/lib/sidekiq/processor.rb:132:in `block (5 levels) in dispatch'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/sidekiq-6.0.0/lib/sidekiq/rails.rb:43:in `block in call'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/execution_wrapper.rb:87:in `wrap'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/reloader.rb:73:in `block in wrap'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/execution_wrapper.rb:87:in `wrap'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/reloader.rb:72:in `wrap'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/sidekiq-6.0.0/lib/sidekiq/rails.rb:42:in `call'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/sidekiq-6.0.0/lib/sidekiq/processor.rb:128:in `block (4 levels) in dispatch'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/sidekiq-6.0.0/lib/sidekiq/processor.rb:254:in `stats'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/sidekiq-6.0.0/lib/sidekiq/processor.rb:123:in `block (3 levels) in dispatch'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/sidekiq-6.0.0/lib/sidekiq/job_logger.rb:13:in `call'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/sidekiq-6.0.0/lib/sidekiq/processor.rb:122:in `block (2 levels) in dispatch'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/sidekiq-6.0.0/lib/sidekiq/job_retry.rb:75:in `global'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/sidekiq-6.0.0/lib/sidekiq/processor.rb:121:in `block in dispatch'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/sidekiq-6.0.0/lib/sidekiq/logger.rb:16:in `with_context'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/sidekiq-6.0.0/lib/sidekiq/job_logger.rb:27:in `with_job_hash_context'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/sidekiq-6.0.0/lib/sidekiq/processor.rb:120:in `dispatch'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/sidekiq-6.0.0/lib/sidekiq/processor.rb:159:in `process'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/sidekiq-6.0.0/lib/sidekiq/processor.rb:78:in `process_one'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/sidekiq-6.0.0/lib/sidekiq/processor.rb:68:in `run'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/sidekiq-6.0.0/lib/sidekiq/util.rb:17:in `watchdog'\n/home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/sidekiq-6.0.0/lib/sidekiq/util.rb:26:in `block in safe_thread'\n2019-09-18T21:42:34.876Z pid=2604 tid=ov922z8j8 class=FlickrWorker jid=73817a6886c934cc0e57d83c INFO: start\n2019-09-18T21:42:34.907Z pid=2604 tid=gmvw62ctw class=FlickrWorker jid=f7a4c1d1e5da2939db1202ae elapsed=5.591 INFO: fail\n2019-09-18T21:42:34.907Z pid=2604 tid=gmvw62ctw WARN: {\"context\":\"Job raised exception\",\"job\":{\"queue\":\"default\",\"args\":[],\"class\":\"FlickrWorker\",\"retry\":true,\"jid\":\"f7a4c1d1e5da2939db1202ae\",\"created_at\":1568806211.883125,\"enqueued_at\":1568842949.3102987,\"error_message\":\"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use\",\"error_class\":\"ActiveRecord::ConnectionTimeoutError\",\"failed_at\":1568806217.393686,\"retry_count\":5,\"retried_at\":1568806883.9672208},\"jobstr\":\"{\\\"queue\\\":\\\"default\\\",\\\"args\\\":[],\\\"class\\\":\\\"FlickrWorker\\\",\\\"retry\\\":true,\\\"jid\\\":\\\"f7a4c1d1e5da2939db1202ae\\\",\\\"created_at\\\":1568806211.883125,\\\"enqueued_at\\\":1568842949.3102987,\\\"error_message\\\":\\\"could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use\\\",\\\"error_class\\\":\\\"ActiveRecord::ConnectionTimeoutError\\\",\\\"failed_at\\\":1568806217.393686,\\\"retry_count\\\":5,\\\"retried_at\\\":1568806883.9672208}\"}\n2019-09-18T21:42:34.907Z pid=2604 tid=gmvw62ctw WARN: ActiveRecord::ConnectionTimeoutError: could not obtain a connection from the pool within 5.000 seconds (waited 5.000 seconds); all pooled connections were in use\n2019-09-18T21:42:34.908Z pid=2604 tid=gmvw62ctw WARN: /home/miro/.rbenv/versions/2.6.1/lib/ruby/gems/2.6.0/gems/activerecord-5.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:201:in `block in wait_poll'\n</code></pre>\n\n<p><b>heroku logs | grep worker</b></p>\n\n<pre><code>2019-09-18T17:31:17.211968+00:00 heroku[worker.1]: Starting process with command `bundle exec sidekiq -e production`\n2019-09-18T17:31:17.859475+00:00 heroku[worker.1]: State changed from starting to up\n2019-09-18T17:31:21.738484+00:00 app[worker.1]: pid=4 tid=gq4np076o INFO: Booting Sidekiq 6.0.0 with redis options {:url=&gt;\"redis://redistogo:REDACTED@porgy.redistogo.com:11228/\", :id=&gt;\"Sidekiq-server-PID-4\"}\n2019-09-18T17:31:21.766614+00:00 app[worker.1]: pid=4 tid=gq4np076o INFO: Cron Jobs - add job with name: flickr_photos\n2019-09-18T17:31:23.288563+00:00 app[worker.1]: pid=4 tid=gq4np076o INFO: Running in ruby 2.6.1p33 (2019-01-30 revision 66950) [x86_64-linux]\n2019-09-18T17:31:23.288599+00:00 app[worker.1]: pid=4 tid=gq4np076o INFO: See LICENSE and the LGPL-3.0 for licensing details.\n2019-09-18T17:31:23.288602+00:00 app[worker.1]: pid=4 tid=gq4np076o INFO: Upgrade to Sidekiq Pro for more features and support: http://sidekiq.org\n2019-09-18T17:31:23.289887+00:00 app[worker.1]: You are using Redis v3.2.12, Sidekiq requires Redis v4.0.0 or greater\n2019-09-18T17:31:23.289931+00:00 app[worker.1]: /app/vendor/bundle/ruby/2.6.0/gems/sidekiq-6.0.0/lib/sidekiq/cli.rb:59:in `run'\n2019-09-18T17:31:23.289932+00:00 app[worker.1]: /app/vendor/bundle/ruby/2.6.0/gems/sidekiq-6.0.0/bin/sidekiq:12:in `&lt;top (required)&gt;'\n2019-09-18T17:31:23.289933+00:00 app[worker.1]: /app/vendor/bundle/ruby/2.6.0/bin/sidekiq:23:in `load'\n2019-09-18T17:31:23.289934+00:00 app[worker.1]: /app/vendor/bundle/ruby/2.6.0/bin/sidekiq:23:in `&lt;top (required)&gt;'\n2019-09-18T17:31:23.289935+00:00 app[worker.1]: /app/vendor/bundle/ruby/2.6.0/gems/bundler-2.0.2/lib/bundler/cli/exec.rb:74:in `load'\n2019-09-18T17:31:23.289936+00:00 app[worker.1]: /app/vendor/bundle/ruby/2.6.0/gems/bundler-2.0.2/lib/bundler/cli/exec.rb:74:in `kernel_load'\n2019-09-18T17:31:23.289937+00:00 app[worker.1]: /app/vendor/bundle/ruby/2.6.0/gems/bundler-2.0.2/lib/bundler/cli/exec.rb:28:in `run'\n2019-09-18T17:31:23.289938+00:00 app[worker.1]: /app/vendor/bundle/ruby/2.6.0/gems/bundler-2.0.2/lib/bundler/cli.rb:465:in `exec'\n2019-09-18T17:31:23.289939+00:00 app[worker.1]: /app/vendor/bundle/ruby/2.6.0/gems/bundler-2.0.2/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'\n2019-09-18T17:31:23.28994+00:00 app[worker.1]: /app/vendor/bundle/ruby/2.6.0/gems/bundler-2.0.2/lib/bundler/vendor/thor/lib/thor/invocation.rb:126:in `invoke_command'\n2019-09-18T17:31:23.289941+00:00 app[worker.1]: /app/vendor/bundle/ruby/2.6.0/gems/bundler-2.0.2/lib/bundler/vendor/thor/lib/thor.rb:387:in `dispatch'\n2019-09-18T17:31:23.289943+00:00 app[worker.1]: /app/vendor/bundle/ruby/2.6.0/gems/bundler-2.0.2/lib/bundler/cli.rb:27:in `dispatch'\n2019-09-18T17:31:23.289943+00:00 app[worker.1]: /app/vendor/bundle/ruby/2.6.0/gems/bundler-2.0.2/lib/bundler/vendor/thor/lib/thor/base.rb:466:in `start'\n2019-09-18T17:31:23.289944+00:00 app[worker.1]: /app/vendor/bundle/ruby/2.6.0/gems/bundler-2.0.2/lib/bundler/cli.rb:18:in `start'\n2019-09-18T17:31:23.289945+00:00 app[worker.1]: /app/vendor/bundle/ruby/2.6.0/gems/bundler-2.0.2/exe/bundle:30:in `block in &lt;top (required)&gt;'\n2019-09-18T17:31:23.289946+00:00 app[worker.1]: /app/vendor/bundle/ruby/2.6.0/gems/bundler-2.0.2/lib/bundler/friendly_errors.rb:124:in `with_friendly_errors'\n2019-09-18T17:31:23.289947+00:00 app[worker.1]: /app/vendor/bundle/ruby/2.6.0/gems/bundler-2.0.2/exe/bundle:22:in `&lt;top (required)&gt;'\n2019-09-18T17:31:23.289948+00:00 app[worker.1]: /app/bin/bundle:3:in `load'\n2019-09-18T17:31:23.289949+00:00 app[worker.1]: /app/bin/bundle:3:in `&lt;main&gt;'\n2019-09-18T17:31:23.357667+00:00 heroku[worker.1]: Process exited with status 1\n2019-09-18T17:31:23.411452+00:00 heroku[worker.1]: State changed from up to crashed\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 759, "user_id": 4352003, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I0GKg.jpg?s=128&g=1", "display_name": "Yury Matusevich", "link": "https://stackoverflow.com/users/4352003/yury-matusevich"}, "is_accepted": false, "score": 1, "last_activity_date": 1568819878, "creation_date": 1568819878, "answer_id": 57996080, "question_id": 57995846, "link": "https://stackoverflow.com/questions/57995846/need-a-validation-for-specific-params-of-attribute/57996080#57996080", "title": "Need a validation for specific params of attribute", "body": "<p>account.rb</p>\n\n<pre><code>validate :the_last_admin\n\nprotected\n\ndef the_last_admin  \n  if Account.admin.count &lt; 2\n    errors.add(:role, 'You are the last admin!')\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 8027736, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9yQylECHK4g/AAAAAAAAAAI/AAAAAAAAAWM/NEV5CRivjg0/photo.jpg?sz=128", "display_name": "Valit Laiho ", "link": "https://stackoverflow.com/users/8027736/valit-laiho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568819878, "creation_date": 1568819100, "question_id": 57995846, "link": "https://stackoverflow.com/questions/57995846/need-a-validation-for-specific-params-of-attribute", "title": "Need a validation for specific params of attribute", "body": "<p>I need write validation for <code>role</code> parameter of <code>accounts_controller</code>. If records with <code>role</code> <code>admin</code> only one, this record cannot update attribute <code>role</code> to <code>user</code>. </p>\n\n<p>This validation must close security bug. But I don't know how it write.</p>\n\n<p><strong>accounts_controller.rb</strong></p>\n\n<pre><code>class AccountsController &lt; ApplicationController\n  def index\n    @accounts = Account.all\n  end\n  def update\n    @account = Account.find(params[:id])\n    redirect_to accounts_path if account.update(role: params[:role])\n  end\nend\n</code></pre>\n\n<p><strong>account.rb</strong></p>\n\n<pre><code>class Account &lt; ApplicationRecord\n  enum role: [:user, :admin]\nend\n</code></pre>\n\n<p><strong>schema.rb</strong></p>\n\n<pre><code>create_table \"accounts\", force: :cascade do |t|\n  t.integer \"role\", default: 0\nend\n</code></pre>\n\n<p>I trying write something like this: <code>validate :role, less_than_or_equal_to: 1</code> but it didn't works.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1568821526, "post_id": 57995768, "comment_id": 102399512, "body": "I&#39;m not sure I understand your question fully, since the reproduction steps are a little vague... (What do you mean by &quot;If I changed the <code>form_for(...) ...</code>&quot;? Which line of the auto-generated view are you changing?) but hopefully I can answer..."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1568821628, "post_id": 57995768, "comment_id": 102399568, "body": "Your database probably contains a table called <code>users</code>, and a rails model called <code>User</code>. The <code>resource</code> that Devise is using is, therefore, called <code>user</code>. So the form needs to be for a <code>user</code>."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1568821778, "post_id": 57995768, "comment_id": 102399656, "body": "However, it is also possible to have a differently-named entity, e.g. <code>student</code>, or <code>teacher</code>, or <code>parent</code>, or <code>moderator</code>, or <code>staff</code>, or <code>guest</code>, or <code>admin</code>, .... You can even have multiple types of &quot;user&quot; in the same rails application. For instance, see <a href=\"https://github.com/plataformatec/devise#configuring-routes\" rel=\"nofollow noreferrer\">here</a> in the README, where it discusses having a <code>user</code> <i>and</i> an <code>admin</code>."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1568821895, "post_id": 57995768, "comment_id": 102399728, "body": "This is why, when generating the views with <code>rails g devise:views</code>, it actually says <code>form_for(resource, ....</code>, not e.g. &quot;`form_form(:user, ...)&quot; -- Because the same view might be used for multiple entities, and regardless there is no need for the code to repeat the resource name in multiple places."}, {"owner": {"reputation": 63, "user_id": 7515690, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-p4liJcQywXU/AAAAAAAAAAI/AAAAAAAAIzM/vZY4rCUHrXs/photo.jpg?sz=128", "display_name": "Jigar Panchal", "link": "https://stackoverflow.com/users/7515690/jigar-panchal"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1568826462, "post_id": 57995768, "comment_id": 102401672, "body": "@TomLord i didnt understand this part &quot;Because the same view might be used for multiple entities, and regardless there is no need for the code to repeat the resource name in multiple places.&quot;"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1568841010, "post_id": 57995768, "comment_id": 102407291, "body": "You might have two identical &quot;login&quot; forms that are used for &quot;admins&quot;as well as &quot;normal users&quot;, depending on the context. So rather than repeat the same code twice, you have one view that says <code>resource</code> instead of saying <code>user</code> and <code>admin</code> explicitly, with every other line of code being identical."}, {"owner": {"reputation": 63, "user_id": 7515690, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-p4liJcQywXU/AAAAAAAAAAI/AAAAAAAAIzM/vZY4rCUHrXs/photo.jpg?sz=128", "display_name": "Jigar Panchal", "link": "https://stackoverflow.com/users/7515690/jigar-panchal"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1568863473, "post_id": 57995768, "comment_id": 102411772, "body": "So how can u achieve that and what u will write in controller and your form is in views for admin and normal users.How devise will know whether that whether the form is for admin or for  normal users how u will pass the params??"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1568888765, "post_id": 57995768, "comment_id": 102422081, "body": "I think this question is getting a bit too broad for discussing in the comments section; your original question is now expanding into &quot;how can I build a rails app with Devise?&quot;. I&#39;d advise reading some documentation/watching a tutorial, and asking a more concise, specific SO question if you get stuck."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1568888868, "post_id": 57995768, "comment_id": 102422144, "body": "But the short answer is: See the link to the README I posted above. You can define multiple routes, e.g. <code>devise_for :users</code> <b>and</b> <code>devise_for :admins</code>. For example, this means you could have multiple URLs such as <code>&#47;users&#47;sign_in</code> <b>and</b> <code>&#47;admins&#47;sign_in</code>. Based on the route, Devise knows which type of user we&#39;re dealing with."}], "owner": {"reputation": 63, "user_id": 7515690, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-p4liJcQywXU/AAAAAAAAAAI/AAAAAAAAIzM/vZY4rCUHrXs/photo.jpg?sz=128", "display_name": "Jigar Panchal", "link": "https://stackoverflow.com/users/7515690/jigar-panchal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1568897052, "creation_date": 1568818819, "last_edit_date": 1568897052, "question_id": 57995768, "link": "https://stackoverflow.com/questions/57995768/devise-login-parameters-invalid-email-and-password", "title": "Devise - LogIn parameters invalid email and password", "body": "<p>I am new to RoR and I used devise gem for authentication.</p>\n\n<p>I have a login form which is created by command \"rails g devise:views\"</p>\n\n<p>If I change the <code>form_for(:session,.......)</code> it shows invalid email and password and if I change to <code>form_for(:user,......)</code> it is working.</p>\n\n<p>Questions:</p>\n\n<p>1)Why only user resource not any other resource or controller because the first parameter is for only use for params i.e, params[:session][email].</p>\n\n<p>2)Where is it documented in Devise gem docs?</p>\n\n<p>Can anyone please help me with this issue ?</p>\n\n<p>Thanks in advance !!!!Sorry for silly doubt!</p>\n"}, {"tags": ["ruby", "string", "methods", "parameters"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1568826930, "post_id": 57994904, "comment_id": 102401870, "body": "As an aside, in this case you can use the method <a href=\"https://ruby-doc.org/core-2.6.3/IO.html#method-c-read\" rel=\"nofollow noreferrer\">IO::read</a> to &quot;gulp&quot; the file into an array: <code>def file_to_array(filename); IO.read(filename); end</code>. Often you will see <code>File.read(filename)</code> instead of <code>IO.read(filename)</code>. That&#39;s OK because <code>File</code> is a subclass of <code>IO</code> and therefore inherits the latter&#39;s methods. In situations where memory considerations dictate that you need to read a file line-by-line, <a href=\"https://ruby-doc.org/core-2.6.3/IO.html#method-c-foreach\" rel=\"nofollow noreferrer\">IO::foreach</a> is often the go-to method."}], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 1, "last_activity_date": 1568816638, "creation_date": 1568816638, "answer_id": 57995070, "question_id": 57994904, "link": "https://stackoverflow.com/questions/57994904/passing-a-filename-as-an-argument-in-ruby/57995070#57995070", "title": "Passing a filename as an argument in ruby", "body": "<p>The file name should be a string, and as such, passed in quotes:</p>\n\n<pre><code>file_to_array(\"text.txt\")\n# OR\nfile_to_array('text.txt')\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 11911811, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_XT9EGmw46c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfxdCQTJW54e0WoGh6y0-uUdfX0Dw/photo.jpg?sz=128", "display_name": "Ixtan", "link": "https://stackoverflow.com/users/11911811/ixtan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 57995070, "answer_count": 1, "score": 0, "last_activity_date": 1568816756, "creation_date": 1568816153, "last_edit_date": 1568816756, "question_id": 57994904, "link": "https://stackoverflow.com/questions/57994904/passing-a-filename-as-an-argument-in-ruby", "title": "Passing a filename as an argument in ruby", "body": "<pre><code>def file_to_array(filename)\n  my_text = []\n  File.open(filename, \"r\").each do |line|\n    my_text &lt;&lt; line\n  end\nmy_text\nend\n</code></pre>\n\n<p>Hello! My method is supposed to receive a filename when called, open the file and move each line to an array. However, it raises <code>undefined local variable</code> when called and I'm assuming it has something to do with the filename[DOT]ext ?!\nMy call happens in a method below</p>\n\n<pre><code>def clean_array\n  cleaned = file_to_array(text.txt).map do |element|\n    element.gsub(/\\b['s\\!\\.\\\\n]*/m, \"\")\n  end\n  cleaned.map! do |el|\n    el.split(\" \")\n    end\n  return cleaned.flatten!\n  #p cleaned\nend\n</code></pre>\n"}, {"tags": ["ruby", "activerecord", "ruby-on-rails-5", "rails-activerecord"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1568824944, "post_id": 57994599, "comment_id": 102401103, "body": "I don&#39;t fully understand what setup you are aiming for here. The <code>Parent</code> has 3 separate sets of <code>Child</code> associations, but they cannot overlap? And each <code>Child</code> must have 3 <code>Parent</code>s? (or are these associations optional)?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1568825123, "post_id": 57994599, "comment_id": 102401170, "body": "Anyway, once you&#39;ve clarified the rules regarding these associations.... A cleaner setup would be to use a JOINS table, e.g. <code>parents_childs</code>. The table can have 3 columns: <code>parent_id</code> <code>child_id</code>, and for example <code>list_name</code> which is either <code>&quot;a&quot;</code>, <code>&quot;b&quot;</code> or <code>&quot;c&quot;</code>."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1568825218, "post_id": 57994599, "comment_id": 102401210, "body": "You can then do <code>has_many :child_elements_a, class_name: &#39;Child&#39;, through: :parents_childs, -&gt; { where(list_name: &#39;A&#39;) }</code>, and you can define all the necessary database constraints and/or rails validations on the JOIN table, to ensure data integrity."}, {"owner": {"reputation": 1, "user_id": 1313444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb3378f2967825dd06235df22650a6c?s=128&d=identicon&r=PG", "display_name": "Michael_KPunkt", "link": "https://stackoverflow.com/users/1313444/michael-kpunkt"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1568891291, "post_id": 57994599, "comment_id": 102423430, "body": "Sorry if I was not clear.  Each child needs exacatly ONE Parent. The Child might be in the Parents A B or C list, but not in A and B -&gt; Only one relation to the parent - I Hope this makes it cleared. Anyway thanks, I think your proposed solution does exactly what I need. Thanks"}, {"owner": {"reputation": 1, "user_id": 1313444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb3378f2967825dd06235df22650a6c?s=128&d=identicon&r=PG", "display_name": "Michael_KPunkt", "link": "https://stackoverflow.com/users/1313444/michael-kpunkt"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1568891404, "post_id": 57994599, "comment_id": 102423495, "body": "@TomLord I can not accept you answer, as it is a comment it seems."}], "owner": {"reputation": 1, "user_id": 1313444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb3378f2967825dd06235df22650a6c?s=128&d=identicon&r=PG", "display_name": "Michael_KPunkt", "link": "https://stackoverflow.com/users/1313444/michael-kpunkt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568816361, "creation_date": 1568815342, "last_edit_date": 1568816361, "question_id": 57994599, "link": "https://stackoverflow.com/questions/57994599/mutliple-has-many-relation-to-same-model-but-different-lists", "title": "Mutliple Has_Many relation to same model but different lists", "body": "<p>I am struggeling with setting up a a ONE TO MANY relation, in the way, that the parent object has 3 different relations to the child object.\nThe child can be in only 1 of these 3 relations to the parent.</p>\n\n<p>I have the feeling, that I mixed it up a little, would be great full, if anybody can bring some light into this topic, what the best practice approach would be to setup these relations. \nI am relatively new to rails. Cheers</p>\n\n<p>My Migration</p>\n\n<pre><code>add_reference :child_elements, :child_list_a, foreign_key: { to_table: :parent_elements }\n\nadd_reference :child_elements, :child_list_b, foreign_key: { to_table: :parent_elements }\n\nadd_reference :child_elements, :child_list_c, foreign_key: { to_table: :parent_elements }\n\n</code></pre>\n\n<p>Classes:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Child:\nbelongs_to :child_list_a, class_name: \"ParentElement\"\nbelongs_to :child_list_b, class_name: \"ParentElement\"\nbelongs_to :child_list_c, class_name: \"ParentElement\"\n\n\nParent:\n\nhas_many :child_elements_a, inverse_of: \"child_list_a\"\nhas_many :child_elements_b, inverse_of: \"child_list_b\"\nhas_many :child_elements_c, inverse_of: \"child_list_c\"\n</code></pre>\n"}, {"tags": ["ruby", "amazon-web-services", "amazon-s3", "encryption", "aes"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1569037917, "post_id": 57993969, "comment_id": 102475747, "body": "<code>Base64.strict_encode64(key)</code> maybe?"}], "answers": [{"comments": [{"owner": {"reputation": 23861, "user_id": 121531, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/bcfba9a4b07837ac5c91978191b2cd61?s=128&d=identicon&r=PG", "display_name": "Jaco Pretorius", "link": "https://stackoverflow.com/users/121531/jaco-pretorius"}, "edited": false, "score": 0, "creation_date": 1569612604, "post_id": 58035689, "comment_id": 102667265, "body": "I&#39;m not 100% confident this is the answer (yet). If I do I&#39;ll update here!"}], "tags": [], "owner": {"reputation": 2709, "user_id": 10169530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7685776a164679bd28ff38255314941a?s=128&d=identicon&r=PG&f=1", "display_name": "Fabio Manzano", "link": "https://stackoverflow.com/users/10169530/fabio-manzano"}, "is_accepted": true, "score": 1, "last_activity_date": 1569065170, "last_edit_date": 1569065170, "creation_date": 1569017656, "answer_id": 58035689, "question_id": 57993969, "link": "https://stackoverflow.com/questions/57993969/how-to-use-s3-sse-c-server-side-encryption-with-client-provided-keys-with-ruby/58035689#58035689", "title": "How to use S3 SSE C (Server Side Encryption with Client Provided Keys) with Ruby", "body": "<p>Oh, did you notice that your key contains '\\n'? That's most probably why you get the CR/LF error:\n<code>QkExM0JGRTNDMUUyRDRCQzA5NjAwNEQ2MjRBNkExMDYwQzBGQjcxODJDMjM0(\\n)nMUE2MTNENDRCOTcxRjA2Qzk1Mg=</code></p>\n\n<p>As mentioned by the colleague in the comments, <a href=\"https://ruby-doc.org/stdlib-2.4.1/libdoc/base64/rdoc/Base64.html\" rel=\"nofollow noreferrer\">strict_encode64</a> is an option, as it complies to RFC 2045.</p>\n\n<p>By the way, I got this insight from here: <a href=\"https://bugs.ruby-lang.org/issues/14664\" rel=\"nofollow noreferrer\">https://bugs.ruby-lang.org/issues/14664</a></p>\n\n<p>Hope it helps! :)</p>\n"}, {"tags": [], "owner": {"reputation": 2453, "user_id": 1853243, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ka9z.jpg?s=128&g=1", "display_name": "Sreeram Nair", "link": "https://stackoverflow.com/users/1853243/sreeram-nair"}, "is_accepted": false, "score": 0, "last_activity_date": 1569465811, "creation_date": 1569465811, "answer_id": 58108878, "question_id": 57993969, "link": "https://stackoverflow.com/questions/57993969/how-to-use-s3-sse-c-server-side-encryption-with-client-provided-keys-with-ruby/58108878#58108878", "title": "How to use S3 SSE C (Server Side Encryption with Client Provided Keys) with Ruby", "body": "<p>First of all, please make sure that you are using the latest version of the SDK (2.2.2.2) from <a href=\"https://aws.amazon.com/sdk-for-net/\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>So, As I understand while we generate the presigned URL, we have to specify the SSECustomerMethod and when consuming the URL, the \"x-amz-server-side-encryption-customer-key\" header is set with the customer key, you also need to set the \"x-amz-server-side-encryption-customer-algorithm\" header.</p>\n\n<pre><code>var getPresignedUrlRequest = new GetPreSignedUrlRequest\n{\n    BucketName = bucketName,\n    Key = \"EncryptedObject\",\n    SSECustomerMethod= SSECustomerMethod.AES256,\n    Expires = DateTime.Now.AddMinutes(5)\n};\nvar url = AWSClients.S3.GetPreSignedURL(getPresignedUrlRequest);\nvar webRequest = HttpWebRequest.Create(url);\nwebRequest.Headers.Add(\"x-amz-server-side-encryption-customer-algorithm\", \"AES256\");\nwebRequest.Headers.Add(\"x-amz-server-side-encryption-customer-key\", base64Key);\n\nusing (var response = webRequest.GetResponse())\nusing (var reader = new StreamReader(response.GetResponseStream()))\n{\n    var contents = reader.ReadToEnd();\n}\n</code></pre>\n"}], "owner": {"reputation": 23861, "user_id": 121531, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/bcfba9a4b07837ac5c91978191b2cd61?s=128&d=identicon&r=PG", "display_name": "Jaco Pretorius", "link": "https://stackoverflow.com/users/121531/jaco-pretorius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1256, "favorite_count": 0, "accepted_answer_id": 58035689, "answer_count": 2, "score": 5, "last_activity_date": 1569465811, "creation_date": 1568813473, "question_id": 57993969, "link": "https://stackoverflow.com/questions/57993969/how-to-use-s3-sse-c-server-side-encryption-with-client-provided-keys-with-ruby", "title": "How to use S3 SSE C (Server Side Encryption with Client Provided Keys) with Ruby", "body": "<p>I'm trying to upload a file to S3 and have it encrypted using the <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/dev/ServerSideEncryptionCustomerKeys.html\" rel=\"noreferrer\">SSE-C encryption options</a>. I can upload without the SSE-C options, but when I supply the sse_customer_key options I'm getting the following error:</p>\n\n<blockquote>\n  <p>ArgumentError: header x-amz-server-side-encryption-customer-key has field value \"QkExM0JGRTNDMUUyRDRCQzA5NjAwNEQ2MjRBNkExMDYwQzBGQjcxODJDMjM0\\nnMUE2MTNENDRCOTcxRjA2Qzk1Mg=\", this cannot include CR/LF</p>\n</blockquote>\n\n<p>I'm not sure if the problem is with the key I'm generating or with the encoding. I've played around with different options here, but the AWS documentation is not very clear. In the general SSE-C documentation it says you need to supply a <strong>x-amz-server-side\u200b-encryption\u200b-customer-key</strong> header, which is described as this:</p>\n\n<blockquote>\n  <p>Use this header to provide the 256-bit, base64-encoded encryption key\n  for Amazon S3 to use to encrypt or decrypt your data.</p>\n</blockquote>\n\n<p>However, if I look at the Ruby SDK documentation for <a href=\"https://docs.aws.amazon.com/sdkforruby/api/Aws/S3/Object.html#upload_file-instance_method\" rel=\"noreferrer\">uploading a file</a> the 3 options have a slightly different description</p>\n\n<ul>\n<li>:sse_customer_algorithm (String) \u2014 Specifies the algorithm to use to when encrypting the object (e.g.,</li>\n<li>:sse_customer_key (String) \u2014 Specifies the customer-provided encryption key for Amazon S3 to use in</li>\n<li>:sse_customer_key_md5 (String) \u2014 Specifies the 128-bit MD5 digest of the encryption key according to RFC</li>\n</ul>\n\n<p>(I didn't copy that wrong, the AWS documentation is literally half-written like that)</p>\n\n<p>So the SDK documentation makes it seem like you supply the raw sse_customer_key and that it would base64-encode it on your behalf (which makes sense to me).</p>\n\n<p>So right now I'm building the options like this:</p>\n\n<pre><code>  sse_customer_algorithm: :AES256,\n  sse_customer_key: sse_customer_key,\n  sse_customer_key_md5: Digest::MD5.hexdigest(sse_customer_key)\n</code></pre>\n\n<p>I previously tried doing <code>Base64.encode64(sse_customer_key)</code> but that gave me a different error:</p>\n\n<blockquote>\n  <p>Aws::S3::Errors::InvalidArgument: The secret key was invalid for the\n  specified algorithm</p>\n</blockquote>\n\n<p>I'm not sure if I'm generating the key incorrectly or if I'm supplying the key incorrectly (or if it's a different problem altogether).</p>\n\n<p>This is how I'm generating the key:</p>\n\n<pre><code>require \"openssl\"\nOpenSSL::Cipher.new(\"AES-256-CBC\").random_key\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "search"], "answers": [{"comments": [{"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1568814354, "post_id": 57994106, "comment_id": 102395116, "body": "Yes, I was struggling with that. @3limin4t0r ... I didn&#39;t want to say  <code>empty?</code> and the correct expression escaped me."}, {"owner": {"reputation": 3327, "user_id": 2121499, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/402a94a6a5d06a560185f3b6d693a5db?s=128&d=identicon&r=PG", "display_name": "Uelb", "link": "https://stackoverflow.com/users/2121499/uelb"}, "edited": false, "score": 0, "creation_date": 1568817846, "post_id": 57994106, "comment_id": 102397357, "body": "I think it would be better to use the exists? method though, as the SQL query is better performing and not loading the whole record."}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 3327, "user_id": 2121499, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/402a94a6a5d06a560185f3b6d693a5db?s=128&d=identicon&r=PG", "display_name": "Uelb", "link": "https://stackoverflow.com/users/2121499/uelb"}, "edited": false, "score": 1, "creation_date": 1568821208, "post_id": 57994106, "comment_id": 102399319, "body": "@Uelb yes, you&#39;re right.  My lazy research made me think <code>none?</code> was a SQL query but it&#39;s an enumerator."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1568826152, "post_id": 57994106, "comment_id": 102401549, "body": "@SteveTurczyn <code>records.none?</code> <b>without a block</b> performs the same query as <code>!records.exists?</code> If you check the source of <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Relation.html#method-i-none-3F\" rel=\"nofollow noreferrer\"><code>none?</code></a> you find that it simply forwards to <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Relation.html#method-i-empty-3F\" rel=\"nofollow noreferrer\"><code>empty?</code></a> which in turn calls <code>!exists?</code> if the current collection is not yet loaded. If you do provide a block to <code>#none?</code> the <i>Enumerable</i> version is used (loading all record data)."}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1568890300, "post_id": 57994106, "comment_id": 102422913, "body": "@3limin4t0r ha!  I&#39;ll change it again, before I lose the will to live."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1568894793, "post_id": 57994106, "comment_id": 102425398, "body": "@SteveTurczyn Just posted that bit of info to counter misinformation. Without the intent that you update the question, but I guess you&#39;ve already done so. The reason I know the info is because I previously looked it up for a Rails Style Guide <a href=\"https://github.com/rubocop-hq/rails-style-guide/issues/232#issuecomment-425848425\" rel=\"nofollow noreferrer\">issue</a>."}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1568963326, "post_id": 57994106, "comment_id": 102449440, "body": "@3limin4t0r I&#39;m not really complaining.  I used it yesterday in some actual real world code (where previously I wouldv&#39;e done negation on <code>records.exists?</code>  Looks cleaner."}], "tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": false, "score": 4, "last_activity_date": 1568890349, "last_edit_date": 1568890349, "creation_date": 1568813893, "answer_id": 57994106, "question_id": 57993472, "link": "https://stackoverflow.com/questions/57993472/search-by-availability-dates-ruby-on-rails/57994106#57994106", "title": "Search by availability/dates Ruby On Rails", "body": "<p>Just create an instance method <code>available?</code> which tests there are no bookings that overlap the from to range.  You can use <code>none?</code> on the relationship.</p>\n\n<pre><code>class Space\n  has_many :bookings\n  def available?(from, to)\n    bookings.where('start_booking &lt;= ? AND end_booking &gt;= ?', to, from).none?\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 0, "last_activity_date": 1568995240, "last_edit_date": 1568995240, "creation_date": 1568835095, "answer_id": 57999655, "question_id": 57993472, "link": "https://stackoverflow.com/questions/57993472/search-by-availability-dates-ruby-on-rails/57999655#57999655", "title": "Search by availability/dates Ruby On Rails", "body": "<p>Taking some inspiration from the <a href=\"https://stackoverflow.com/a/57994106/3982562\">answer of SteveTurczyn</a>. The following might give you some inspiration.</p>\n\n<pre><code>class Space &lt; ApplicationRecord\n  # attributes: id\n  has_many :bookings\n\n  def self.available(period)\n    bookings = Booking.overlap(period)\n    where.not(id: bookings.select(:space_id))\n  end\n\n  def available?(period)\n    if bookings.loaded?\n      bookings.none? { |booking| booking.overlap?(period) }\n    else\n      bookings.overlap(period).none?\n    end\n  end\nend\n\nclass Booking &lt; ApplicationRecord\n  # attributes: id, space_id, start, end\n  belongs_to :space\n\n  def self.overlap(period)\n    period = FormatConverters.to_period(period)\n\n    # lteq = less than or equal to, gteq = greater than or equal to\n    # Other methods available on attributes can be found here:\n    # https://www.rubydoc.info/gems/arel/Arel/Attributes/Attribute\n    where(arel_table[:start].lteq(period.end).and(arel_table[:end].gteq(period.start)))\n  end\n\n  def overlap?(period)\n    period = FormatConverters.to_period(period)\n    self.start &lt;= period.end &amp;&amp; self.end &gt;= period.start\n  end\n\n  module FormatConverters\n\n    module_function\n\n    def to_period(obj)\n      return obj if obj.respond_to?(:start) &amp;&amp; obj.respond_to?(:end)\n      obj..obj\n    end\n  end\nend\n</code></pre>\n\n<p>With the above implemented you can query a single space if it is available during a period:</p>\n\n<pre><code>from   = Time.new(2019, 10, 1, 9, 30)\nto     = Time.new(2019, 10, 5, 17, 30)\nperiod = from..to\n</code></pre>\n\n\n\n<pre><code>space.available?(period) # true/false\n</code></pre>\n\n<p>You can get all spaces available:</p>\n\n<pre><code>spaces = Space.available(period) # all available spaces during the period\n</code></pre>\n\n<p>Note that class methods will also be available on the scope chain:</p>\n\n<pre><code>spaces = Space.scope_01.scope_02.available(period)\n</code></pre>\n\n<p>I've also added the <code>overlap</code> scope and <code>overlap?</code> helper to simplify creating the above helpers.</p>\n\n<p>Since in my version <code>Booking</code> has a <code>start</code> and <code>end</code> attribute (similar to <a href=\"https://ruby-doc.org/core-2.6.4/Range.html\" rel=\"nofollow noreferrer\"><code>Range</code></a>) you can also provide it to any methods accepting a period.</p>\n\n<pre><code>booking_01.overlap?(booking_02) # true/false\n</code></pre>\n\n<p>To retrieve all bookings that that overlap this very moment:</p>\n\n<pre><code>bookings = Booking.overlap(Time.now) # all bookings overlapping the period\n</code></pre>\n\n<p>Hope this gave you some inspiration. If you'd like to know how the overlap checking works I have to forward you to <a href=\"https://stackoverflow.com/questions/325933/determine-whether-two-date-ranges-overlap\" title=\"Determine Whether Two Date Ranges Overlap\">this</a> question.</p>\n\n<blockquote>\n  <p><strong>Note:</strong> This answer assumes that the provided period is valid. A.k.a. <code>start</code> &lt;= <code>end</code>. If you for some reason provide <code>Time.new(2019, 10, 1)..Time.new(2019, 9, 23)</code> the results are going to be skewed.</p>\n</blockquote>\n"}], "owner": {"reputation": 129, "user_id": 8605123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5d48206e3bf26f22392d1f67df5c34?s=128&d=identicon&r=PG&f=1", "display_name": "Jessicascn", "link": "https://stackoverflow.com/users/8605123/jessicascn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1568995240, "creation_date": 1568811824, "question_id": 57993472, "link": "https://stackoverflow.com/questions/57993472/search-by-availability-dates-ruby-on-rails", "title": "Search by availability/dates Ruby On Rails", "body": "<p>I've built a RoR app and implemented a simple booking system. The user is able to look for a space and can book it per day or per hour.\nEverything works well, but I would now like to make the user able to look for a space depending on its availability. \nI want to user to be able to select a start/end date and a start/end time and to show only spaces that don't have any booking included in this period.</p>\n\n<p>I am using pg search at the moment to look for a space by category and location, but I have no idea how to implement a search by date and time, as it uses a different logic.\nI've tried to do it by hand by creating an array of bookings for each space so I could compare it with the params, but it sounded very complicated and not clean (and I started being stuck anyway, as making it available for one hour or several hours or several days makes it even more complicated)</p>\n\n<p>Is there a gem that could do this for me? If I have to do it by hand, what's the best way to begin?</p>\n\n<p>Thanks a lot</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1397, "user_id": 4940278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06NHi.jpg?s=128&g=1", "display_name": "Luna Lovegood", "link": "https://stackoverflow.com/users/4940278/luna-lovegood"}, "edited": false, "score": 0, "creation_date": 1568806978, "post_id": 57990865, "comment_id": 102390915, "body": "in which class or file have you added this function? Is there a function by name <code>from_basic</code> in doorkeeper gem, if so in which file?"}, {"owner": {"reputation": 45, "user_id": 10743490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2a6036b35563d477dd9fee65048b55?s=128&d=identicon&r=PG&f=1", "display_name": "viveksrivastava", "link": "https://stackoverflow.com/users/10743490/viveksrivastava"}, "reply_to_user": {"reputation": 1397, "user_id": 4940278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06NHi.jpg?s=128&g=1", "display_name": "Luna Lovegood", "link": "https://stackoverflow.com/users/4940278/luna-lovegood"}, "edited": false, "score": 0, "creation_date": 1568809501, "post_id": 57990865, "comment_id": 102392296, "body": "lib/doorkeeper/oauth/client/credentials.rb"}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1568809874, "creation_date": 1568809874, "answer_id": 57992897, "question_id": 57990865, "link": "https://stackoverflow.com/questions/57990865/how-can-we-override-from-basic-method-of-doorkeeper/57992897#57992897", "title": "How can we override from_basic method of doorkeeper", "body": "<p>This is obviously security by obscurity, but it\u2019s still easy with <code>Module#prepend</code>. Put this code anywhere in your initializers.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Doorkeeper::OAuth::Client.Credentials.\n  singleton_class.prepend(Module.new do\n    def from_basic(request)\n      original = super(request)\n      # my code that makes it better\n    end\n  end)\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 10743490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2a6036b35563d477dd9fee65048b55?s=128&d=identicon&r=PG&f=1", "display_name": "viveksrivastava", "link": "https://stackoverflow.com/users/10743490/viveksrivastava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 57992897, "answer_count": 1, "score": 1, "last_activity_date": 1568809874, "creation_date": 1568803245, "question_id": 57990865, "link": "https://stackoverflow.com/questions/57990865/how-can-we-override-from-basic-method-of-doorkeeper", "title": "How can we override from_basic method of doorkeeper", "body": "<p>In doorkeeper gem of rails, access token get by the client by from_basic method of doorkeeper, i tried to customise this method, so that it is not easy for any outsider to get the access token.</p>\n\n<p>I just add some more unique attribute with user name and email id, so that it become tough to get access token.</p>\n\n<p>Here is the basic_method of doorkeeper:</p>\n\n<pre><code>def from_basic(request)\n  authorization = request.authorization\n  if authorization.present? &amp;&amp; authorization =~ /^Basic (.*)/m\n    Base64.decode64(Regexp.last_match(1)).split(/:/, 2)\n  end\nend \n</code></pre>\n\n<p>please provide me any suggestion how can i override this method </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "haml", "wicked-pdf"], "owner": {"reputation": 55, "user_id": 10460270, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-42mB5EGraNc/AAAAAAAAAAI/AAAAAAAAAGc/NSwqtyHZKvs/photo.jpg?sz=128", "display_name": "Masanari Makino", "link": "https://stackoverflow.com/users/10460270/masanari-makino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1568802495, "creation_date": 1568802495, "question_id": 57990647, "link": "https://stackoverflow.com/questions/57990647/how-do-i-create-a-pdf-whose-style-is-correct-and-is-created-with-haml-with-wicke", "title": "How do I create a pdf whose style is correct and is created with Haml with Wicked-pdf&#39;s pdf_from_string", "body": "<p>I am trying to make a pdf with QRcode which is made with Haml file on my application.\nMy application is on ruby on rails and uses <code>ActiveStorage</code>, and QRcode is made with <code>rqrcode</code>.</p>\n\n<p>First, I tried to make <code>controller's instance</code> and <code>view's instance</code>.\nThen I created a pdf with <code>WickedPdf.new.pdf_from_string</code> and <code>Haml file</code> is loaded with <code>view</code> which is an instance I created before.</p>\n\n<p>The pdf is created but the style in <code>Haml file</code> did not work.</p>\n\n<p>Is it lacking any helper that is required to extend with the <code>view</code> or something else problem?</p>\n\n<p>This is a <code>Haml</code> code. The pdf is supposed to be created alongside this code.</p>\n\n<pre><code>%div.content\n  %div.block.block-rounded.block-bordered.block-fx-shadow.justify-content-center\n    %div.block-header\n      %h3.block-title= I18n.t('word.qrcode')\n    %div.block-content\n      = show_qr(@remote_interview_url_with_iid)\n</code></pre>\n\n<p><code>show_qr</code> successfully returns QRCode svg.</p>\n\n<p>This is the code which creates instances, pdf; and attaches to <code>active storage</code>.</p>\n\n<pre><code>def attach_pdf\n    controller = ActionController::Base.new\n    view = ActionView::Base.new(Rails.root.join('app', 'views'), {}, controller)\n    view.extend(ApplicationHelper)\n    pdf = WickedPdf.new.pdf_from_string(view.render(template: 'layouts/pdf.html.haml', encoding: 'UTF-8'))\n    self.pdf.attach(io: StringIO.new(pdf), filename: \"pdf_#{self.iid}.pdf\", content_type: 'application/pdf')\n  end\n</code></pre>\n\n<p>This is the code which is linked to the pdf page.</p>\n\n<pre><code>= link_to interview.pdf_url do\n  %button.btn.btn-outline-primary.font-w600\n    = I18n.t('word.show_qrcode')\n</code></pre>\n\n<p><code>pdf_url</code> successfully returns an attached pdf's url.</p>\n\n<p>I wanna know how to let the <code>view instance</code> loads <code>Haml</code> code correctly.</p>\n"}, {"tags": ["ruby", "twitter"], "comments": [{"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1568808456, "post_id": 57988808, "comment_id": 102391691, "body": "A quick search shows info on paid API access <a href=\"https://developer.twitter.com/en/pricing.html\" rel=\"nofollow noreferrer\">here</a> - hope it helps :)"}, {"owner": {"reputation": 601, "user_id": 9315566, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pnkVEz0JwTw/AAAAAAAAAAI/AAAAAAAAASo/NlxvDhY5hi0/photo.jpg?sz=128", "display_name": "Shun Yamada", "link": "https://stackoverflow.com/users/9315566/shun-yamada"}, "reply_to_user": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1568832956, "post_id": 57988808, "comment_id": 102404243, "body": "Thanks for your information"}, {"owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 0, "creation_date": 1568869961, "post_id": 57988808, "comment_id": 102413051, "body": "You also might look at the posts under &quot;Related&quot; on the right, for example <a href=\"https://stackoverflow.com/questions/28151307/twitter-api-rate-limit?rq=1\">this one</a> which talks about the Streaming API and seems to do what you&#39;re looking for."}, {"owner": {"reputation": 601, "user_id": 9315566, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pnkVEz0JwTw/AAAAAAAAAAI/AAAAAAAAASo/NlxvDhY5hi0/photo.jpg?sz=128", "display_name": "Shun Yamada", "link": "https://stackoverflow.com/users/9315566/shun-yamada"}, "reply_to_user": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 0, "creation_date": 1568870216, "post_id": 57988808, "comment_id": 102413120, "body": "@BobRodes Streaming API has not been working."}, {"owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 0, "creation_date": 1568870781, "post_id": 57988808, "comment_id": 102413287, "body": "All right. In any case, there are several other posts listed there."}], "owner": {"reputation": 601, "user_id": 9315566, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pnkVEz0JwTw/AAAAAAAAAAI/AAAAAAAAASo/NlxvDhY5hi0/photo.jpg?sz=128", "display_name": "Shun Yamada", "link": "https://stackoverflow.com/users/9315566/shun-yamada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568796919, "creation_date": 1568796919, "question_id": 57988808, "link": "https://stackoverflow.com/questions/57988808/how-to-solve-rate-limit-exceed-for-twitter-api", "title": "How to solve rate limit exceed for Twitter API", "body": "<p>Really appreciate your help in advance. I'm working on an application which lets users share their own home timeline with each other realtime. So I need to use Twitter API, but it occurs error <code>Twitter::Error::TooManyRequests: Rate limit exceeded</code>.</p>\n\n<p>My purpose is to get each user's timeline in real-time. But it's limited by Twitter.</p>\n\n<p>I have 2 options.</p>\n\n<p>1) Get recent 100 tweets per 15 minutes\nI wish I may get these volumes. But be a little worried whether the case using application-only authentication includes mine or not.</p>\n\n<p>2) Pay to Twitter\nDoes Twitter allow me to use over limitation if I paid? And how?</p>\n\n<p>schedule.rb</p>\n\n<pre><code>require File.expand_path(File.dirname(__FILE__) + \"/environment\")\nset :environment, Rails.env.to_sym\nset :output, \"#{Rails.root.to_s}/log/cron.log\"\n\nevery 1.minutes do\n  begin\n    rake \"share:twitter\"\n  rescue =&gt; e\n    raise e\n  end\nend\n</code></pre>\n\n<p>lib/tasks/share.rake</p>\n\n<pre><code>namespace :share do\n  task :twitter =&gt; :environment do\n    share_twitter = ShareTwitter.new\n    share_twitter.share\n  end\nend\n</code></pre>\n\n<p>lib/share_twitter.rb</p>\n\n<pre><code>class ShareTwitter\n  def share\n    @users = User.all\n\n    @users.each do |user|\n      @client = Twitter::REST::Client.new do |config|\n        config.consumer_key        = Rails.application.credentials[Rails.env.to_sym][:twitter][:consumer_id]\n        config.consumer_secret     = Rails.application.credentials[Rails.env.to_sym][:twitter][:consumer_secret]\n        config.access_token        = user.token\n        config.access_token_secret = user.secret\n     end\n\n      @timeline = @client.home_timeline(max_id: max_id,count: 100)\n      @timeline.save\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "jruby"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1568795717, "post_id": 57988142, "comment_id": 102384470, "body": "String interning makes strings immutable, but making strings immutable does not guarantee string interning. The <code>freeze</code> contract only specifies it will make a string immutable, no more and no less. Whether or not a string is interned is not defined, and each implementation can choose the behaviour for itself."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1568798484, "post_id": 57988142, "comment_id": 102386103, "body": "@J&#246;rgWMittag: How so? At <code>unfreeze</code>, you&#39;d just have to copy it somewhere else (so that any references to the &quot;canonical&quot; icicle would remain valid). This changes <code>object_id</code>, obviously, but... I think <code>Hash</code> already does something similar... <code>a = &quot;foo&quot;; b = { a =&gt; 1 }; a.object_id == b.keys.first.object_id</code> is false"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1568798787, "post_id": 57988142, "comment_id": 102386292, "body": "Lol, you&#39;re right (barring <a href=\"https://stackoverflow.com/questions/35633367/how-to-unfreeze-an-object-in-ruby\">shenanigans</a>)."}], "answers": [{"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 3, "last_activity_date": 1568798538, "last_edit_date": 1568798538, "creation_date": 1568798076, "answer_id": 57989176, "question_id": 57988142, "link": "https://stackoverflow.com/questions/57988142/freezing-string-literals-in-early-ruby-versions/57989176#57989176", "title": "Freezing string literals in early Ruby versions", "body": "<blockquote>\n  <p>In particular I am refering to this article, which suggests to freeze strings, so that repeated evaluation of the code does not create a new String object every time</p>\n</blockquote>\n\n<p>That is not what <a href=\"https://ruby-doc.org/core/Object.html#method-i-freeze\" rel=\"nofollow noreferrer\"><code>Object#freeze</code></a> does. As the name implies, it \"freezes\" the object, i.e. it disallows any further modification to the object's internal state. There is nothing in the documentation that even remotely suggests that <code>Object#freeze</code> performs some sort of de-duplication or interning.</p>\n\n<p>You <em>may</em> be thinking of <code>String#-@</code>, but this does not exist in Ruby 2.1. It was only added in Ruby 2.3, and actually had different semantics then:</p>\n\n<ul>\n<li><p>Ruby 2.3\u20132.4: returns <code>self</code> if <code>self</code> is already frozen, otherwise returns <code>self.dup.freeze</code>, i.e. <a href=\"https://ruby-doc.org/core-2.4.7/String.html#method-i-2D-40\" rel=\"nofollow noreferrer\">a frozen <em>duplicate</em> of the string</a>:</p>\n\n<blockquote>\n  <h1><code>-str</code> \u2192 <code>str</code> (frozen)</h1>\n  \n  <p>If the string is frozen, then return the string itself.<br>\n  If the string is not frozen, then duplicate the string freeze it and return it.</p>\n</blockquote></li>\n<li><p>Ruby 2.5+: returns <code>self</code> if <code>self</code> is already frozen, otherwise returns a frozen version of the string <a href=\"https://ruby-doc.org/core/String.html#method-i-2D-40\" rel=\"nofollow noreferrer\">that is de-duplicated</a> (i.e. it may be looked up in a cache of existing frozen strings and the existing version returned):</p>\n\n<blockquote>\n  <h1><code>-str</code> \u2192 <code>str</code> (frozen)</h1>\n  \n  <p>Returns a frozen, possibly pre-existing copy of the string.<br>\n  The string will be deduplicated as long as it is not tainted, or has any instance variables set on it.</p>\n</blockquote></li>\n</ul>\n\n<p>So, the article you linked to is wrong on three counts:</p>\n\n<ol>\n<li>De-duplication is only performed for strings, not arbitrary objects.</li>\n<li>De-duplication is not performed by <code>freeze</code>.</li>\n<li>De-duplication is only performed by <code>String#-@</code> starting in Ruby 2.5.</li>\n</ol>\n\n<p>There is also a fourth claim that is wrong in that article, although we can't really blame the author for that since the article is from 2016 and the decision was only changed in 2019: <a href=\"https://bugs.ruby-lang.org/issues/11473#note-53\" rel=\"nofollow noreferrer\">Ruby 3.0 will <em>not</em> have immutable string literals by default</a>.</p>\n\n<p>The one thing that <em>is</em> correct in that article is that the <code># frozen_string_literal: true</code> pragma (or the corresponding command line option <code>--enable-frozen-string-literal</code>) will not only freeze all static string literals, it will also de-duplicate them.</p>\n"}], "owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "accepted_answer_id": 57989176, "answer_count": 1, "score": 0, "last_activity_date": 1568798538, "creation_date": 1568794771, "question_id": 57988142, "link": "https://stackoverflow.com/questions/57988142/freezing-string-literals-in-early-ruby-versions", "title": "Freezing string literals in early Ruby versions", "body": "<p>This question applies in particular to Ruby 1.9 and 2.1, where String literals can not be frozen automatically. In particular I am refering to <a href=\"http://flats.github.io/blog/2016/01/03/frozen-strings/\" rel=\"nofollow noreferrer\">this article</a>, which suggests to freeze strings, so that repeated evaluation of the code does not create a new String object every time, which among other advantages is said to make the program perform better. As a concrete example, this article proposes the expression</p>\n\n<pre><code>(\"%09d\".freeze % id).scan(/\\d{3}/).join(\"/\".freeze)\n</code></pre>\n\n<p>I want to use this concept in our project, and for testing purpose, I tried the following code:</p>\n\n<pre><code>3.times { x=\"abc\".freeze; puts x.object_id }\n</code></pre>\n\n<p>In Ruby 2.3, this prints the same object ID every time. In JRuby 1.7, which corresponds on the language level to Ruby 1.9, it prints three different object IDs, although I have explicitly frozen the string.</p>\n\n<p>Could somebody explain the reason for this, and how to use <code>freeze</code> properly in this situation?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sidekiq"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 2, "creation_date": 1568793547, "post_id": 57987745, "comment_id": 102383352, "body": "<a href=\"https://github.com/utgarda/sidekiq-status\" rel=\"nofollow noreferrer\">sidekiq-status</a> is a gem"}], "owner": {"reputation": 3425, "user_id": 1493116, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9371f372f90b7c283579b097c67b9cd2?s=128&d=identicon&r=PG", "display_name": "LewlSauce", "link": "https://stackoverflow.com/users/1493116/lewlsauce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1568793389, "creation_date": 1568793389, "question_id": 57987745, "link": "https://stackoverflow.com/questions/57987745/tracking-status-of-sidekiq-worker", "title": "Tracking status of sidekiq worker", "body": "<p>I have a sidekiq worker that launches another sidekiq worker; however, I don't have a way to know when that worker is finished. I ran across this: <a href=\"https://stackoverflow.com/questions/32940007/rails-how-to-tell-if-a-sidekiq-worker-is-done-with-perform-async?rq=1\">Rails how to tell if a sidekiq worker is done with perform_async</a> but this is apparently old and I get this error when trying to call <code>Sidekiq::Status</code></p>\n\n<pre><code>[12] pry(#&lt;ScanWorker&gt;)&gt; Sidekiq::Status::get_all\nNameError: uninitialized constant Sidekiq::Status\nfrom /usr/local/rvm/gems/ruby-2.5.1/gems/bootsnap-1.4.5/lib/bootsnap/load_path_cache/core_ext/active_support.rb:79:in `block in load_missing_constant'\nCaused by NameError: uninitialized constant Sidekiq::Status\nfrom /usr/local/rvm/gems/ruby-2.5.1/gems/bootsnap-1.4.5/lib/bootsnap/load_path_cache/core_ext/active_support.rb:60:in `block in load_missing_constant'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 303, "user_id": 9479253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cd34f4996365a59ad414df6950d6d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok Damaniya", "link": "https://stackoverflow.com/users/9479253/ashok-damaniya"}, "edited": false, "score": 0, "creation_date": 1568791890, "post_id": 57985374, "comment_id": 102382478, "body": "you can use <b>attr_accessor</b> to prevent this"}], "answers": [{"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 3, "last_activity_date": 1568787849, "creation_date": 1568787849, "answer_id": 57986271, "question_id": 57985374, "link": "https://stackoverflow.com/questions/57985374/infinite-loop-in-before-update-callback/57986271#57986271", "title": "Infinite loop in before_update callback", "body": "<p>A simple way to get around this would be to add a virtual attribute on the model, which tells it whether to run the job or not:</p>\n\n<pre><code># in your model\nattr_accessor :translated\n\n# in your update_translations method\nunless translated\n  TranslateOrderFeedbackWorker.perform_async(id, locale)\nend\n\n# in your job\norder.translated = true\norder.save\n</code></pre>\n\n<p>You could alternatively make <code>translated</code> an actual column in the database - the code would be the same but you wouldn't need the virtual attribute (the <code>attr_accessor</code>).</p>\n\n<p>If there are a lot of these sort of flags (the record must go through a pipeline of transformations), you might consider using a state machine such as <a href=\"https://github.com/aasm/aasm\" rel=\"nofollow noreferrer\">aasm</a>.</p>\n"}], "owner": {"reputation": 31, "user_id": 11795295, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2p4HdJybdmI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc3D5m51MOfEXUWOAZ-V77LsMzWDg/photo.jpg?sz=128", "display_name": "Maxim Davydov", "link": "https://stackoverflow.com/users/11795295/maxim-davydov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1568788161, "creation_date": 1568782895, "last_edit_date": 1568788161, "question_id": 57985374, "link": "https://stackoverflow.com/questions/57985374/infinite-loop-in-before-update-callback", "title": "Infinite loop in before_update callback", "body": "<p>I'm trying to update translations, but it becomes to infinite loop, because in <strong>perform</strong> method I repeat saving. How I can solve this problem? </p>\n\n<p><code>before_update :update_translations, on: :edit</code></p>\n\n<pre><code>  def update_translations\n      id = self.id\n      order = Order.find(id)\n      locale = order.translations.find(order.translation.id).locale.to_s\n      TranslateOrderFeedbackWorker.perform_async(id, locale)\n  end\n</code></pre>\n\n<pre><code>def perform(id, current_locale)\n    order = Order.find(id)\n    I18n.locale = current_locale\n    text = order.feedback\n    translator = TranslateTextService.new\n\n    I18n.available_locales.each do |locale|\n      next if locale.to_s == current_locale\n\n      I18n.locale = locale\n      order.feedback = translator.translate(text, current_locale, locale.to_s)\n    end\n    order.save # &lt;= infinity loop here\n  end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "iterator"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1568786769, "post_id": 57985329, "comment_id": 102380232, "body": "Consider the following: <code>my_collect([1,2,3]) { |n| n*n } #=&gt; [1, 4, 9]</code> and <code>my_collect([1,2,3]) { |n| (1.fdiv(n)).round(4) } #=&gt; [1.0, 0.5, 0.3333]</code>. <code>yield(array[i])</code> <i>yields</i> to the block, passing the argument <code>array[i]</code>. The result of the block calculation is then returned and appended to the array <code>collect</code>."}], "answers": [{"comments": [{"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 1, "creation_date": 1568808618, "post_id": 57987502, "comment_id": 102391786, "body": "Why not go a step further and use <code>map</code>? <code>array.map { |a| yield(a) }</code> would suffice for the method :)"}], "tags": [], "owner": {"reputation": 599, "user_id": 11544569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xEqDN.jpg?s=128&g=1", "display_name": "RomanOks", "link": "https://stackoverflow.com/users/11544569/romanoks"}, "is_accepted": false, "score": 3, "last_activity_date": 1568792495, "creation_date": 1568792495, "answer_id": 57987502, "question_id": 57985329, "link": "https://stackoverflow.com/questions/57985329/can-someone-help-me-understand-this-one-line-of-code/57987502#57987502", "title": "Can someone help me understand this one line of code?", "body": "<p>The <code>yield</code> keyword \u2014 in association with a block \u2014 allows to pass a set of additional instructions during a method invocation.</p>\n\n<p>This mechanism allows you to customise a method depending on your needs.</p>\n\n<p><strong><em>What\u2019s a block ?</em></strong></p>\n\n<p>A block is part of the Ruby method syntax.\nThis means that when a block is recognised by the Ruby parser then it\u2019ll be associated to the invoked method and literally replaces the yields in the method.</p>\n\n<p><em>I also advise you to replace your <code>while</code> loop with <code>.each</code></em></p>\n\n<pre><code>def my_collect(array)\n  collect = []\n  array.each { |a| collect &lt;&lt; yield(a) }\n  collect\nend\n\nmy_collect([1, 2, 3]) { |n| n + 1 }  produces  -&gt;  [2, 3, 4]\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11985510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1028b05b2989fa79525396146025bd5a?s=128&d=identicon&r=PG&f=1", "display_name": "Dreadhead14", "link": "https://stackoverflow.com/users/11985510/dreadhead14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1568792495, "creation_date": 1568782597, "question_id": 57985329, "link": "https://stackoverflow.com/questions/57985329/can-someone-help-me-understand-this-one-line-of-code", "title": "Can someone help me understand this one line of code?", "body": "<p>I'm doing a lab using each and yield</p>\n\n<p>I've almost finished the lab and understand it somewhat just need help full grasping this one line.</p>\n\n<p>yield(collection[i]) </p>\n\n<pre><code>def my_collect(array)\n  i = 0\n  collect = []\n  while i &lt; array.length\n    collect &lt;&lt; yield(array[i])\n    i+=1\n  end\n  collect\nend\n</code></pre>\n"}, {"tags": ["ruby", "clojure", "functional-programming"], "answers": [{"tags": [], "owner": {"reputation": 192, "user_id": 10848072, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7seSIvOTVXo/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcY_nQ-xi8vHbix2aBIN8QkHOyFzIw/mo/photo.jpg?sz=128", "display_name": "saurabh kumar", "link": "https://stackoverflow.com/users/10848072/saurabh-kumar"}, "is_accepted": true, "score": 7, "last_activity_date": 1568784934, "creation_date": 1568784934, "answer_id": 57985721, "question_id": 57985310, "link": "https://stackoverflow.com/questions/57985310/clojure-equivalent-of-rubys-methods-method/57985721#57985721", "title": "Clojure equivalent of ruby&#39;s #methods method?", "body": "<p><a href=\"https://stackoverflow.com/questions/2747294/how-to-list-the-functions-of-a-namespace\">How to list the functions of a namespace?</a> this is a similar question, please go to the link for the full explanation. </p>\n\n<p>In Clojure we don't have classes but functions are grouped into name spaces. using <code>ns-publics</code> you can get a map of all the functions in that namespace.</p>\n\n<pre class=\"lang-clj prettyprint-override\"><code>(keys (ns-publics 'user))\n; =&gt; (clojuredocs help find-name user.proxy$java.lang.Object$SignalHandler$d8c00ec7 cdoc apropos-better)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8898, "user_id": 2609980, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/FV4E4.jpg?s=128&g=1", "display_name": "Erwin Rooijakkers", "link": "https://stackoverflow.com/users/2609980/erwin-rooijakkers"}, "is_accepted": false, "score": 3, "last_activity_date": 1568813767, "creation_date": 1568813767, "answer_id": 57994068, "question_id": 57985310, "link": "https://stackoverflow.com/questions/57985310/clojure-equivalent-of-rubys-methods-method/57994068#57994068", "title": "Clojure equivalent of ruby&#39;s #methods method?", "body": "<p>To get the methods of a Java object you can use <code>clojure.reflect</code>:</p>\n\n<pre><code>(map (comp keyword :name) (:members (clojure.reflect/reflect Object))))\n;; =&gt; (:getClass :wait :finalize :java.lang.Object :equals :notifyAll :hashCode :toString :registerNatives :clone :notify :wait :wait)\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/questions/5821286/how-can-i-get-the-methods-of-a-java-class-from-clojure\">How can I get the methods of a Java class from Clojure?</a> for more suggestions.</p>\n"}], "owner": {"reputation": 778, "user_id": 4229641, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/VxtFd.jpg?s=128&g=1", "display_name": "vishnuprasanth", "link": "https://stackoverflow.com/users/4229641/vishnuprasanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 57985721, "answer_count": 2, "score": 2, "last_activity_date": 1568813767, "creation_date": 1568782434, "last_edit_date": 1568782909, "question_id": 57985310, "link": "https://stackoverflow.com/questions/57985310/clojure-equivalent-of-rubys-methods-method", "title": "Clojure equivalent of ruby&#39;s #methods method?", "body": "<p>In ruby, we can do <code>Object.methods</code> to get all the methods for a specific Object or class.</p>\n\n<p>For instance:</p>\n\n<pre><code>irb(main):001:0&gt; Object.methods\n=&gt; [:new, :allocate, :superclass, :&lt;=&gt;, :include, :&lt;=, :&gt;=, :==, :===, :included_modules, :include?, :name, :ancestors, :instance_methods, :public_instance_methods, :protected_instance_methods, :private_instance_methods, :constants, :const_get, :const_set, :const_defined?, :class_variables, :remove_class_variable, :class_variable_get, :class_variable_set, :class_variable_defined?, :public_constant, :private_constant, :deprecate_constant, :singleton_class?, :module_exec, :class_exec, :freeze, :inspect, :const_missing, :class_eval, :method_defined?, :public_method_defined?, :prepend, :&lt;, :&gt;, :private_method_defined?, :protected_method_defined?, :public_class_method, :module_eval, :to_s, :private_class_method, :autoload, :autoload?, :instance_method, :public_instance_method, :instance_of?, :kind_of?, :is_a?, :tap, :public_send, :remove_instance_variable, :instance_variable_set, :method, :public_method, :singleton_method, :extend, :define_singleton_method, :to_enum, :enum_for, :=~, :!~, :eql?, :respond_to?, :object_id, :send, :display, :nil?, :hash, :class, :singleton_class, :clone, :dup, :itself, :taint, :tainted?, :untaint, :untrust, :untrusted?, :trust, :frozen?, :methods, :singleton_methods, :protected_methods, :private_methods, :public_methods, :instance_variable_get, :instance_variables, :instance_variable_defined?, :!, :!=, :__send__, :equal?, :instance_eval, :instance_exec, :__id__]\n</code></pre>\n\n<p>Can we do something similar in the Clojure repl (eg: leiningen)?</p>\n"}, {"tags": ["ruby", "image-processing", "shrine"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 8749164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc7b381bca7eaafdbd6bcecbcc4a5d4b?s=128&d=identicon&r=PG&f=1", "display_name": "Dauncing", "link": "https://stackoverflow.com/users/8749164/dauncing"}, "edited": false, "score": 0, "creation_date": 1568791411, "post_id": 57986893, "comment_id": 102382236, "body": "Perfect, thanks! I just added it to the github wiki."}], "tags": [], "owner": {"reputation": 7938, "user_id": 988414, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/376e4eb9dc6c2e33d1330262edc4f109?s=128&d=identicon&r=PG", "display_name": "janko-m", "link": "https://stackoverflow.com/users/988414/janko-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1568790355, "creation_date": 1568790355, "answer_id": 57986893, "question_id": 57984916, "link": "https://stackoverflow.com/questions/57984916/add-density-flag-to-libvips-command-with-image-processing/57986893#57986893", "title": "Add --density flag to libvips command with image_processing?", "body": "<p>I think libvips equivalent of ImageMagick <code>-density</code> is the <code>:dpi</code> option on <a href=\"https://libvips.github.io/libvips/API/current/VipsForeignSave.html#vips-pdfload\" rel=\"nofollow noreferrer\"><code>vips_pdfload()</code></a>. With <code>image_processing</code> gem you can set it via <code>loader</code>:</p>\n\n<pre><code>require \"image_processing/vips\"\n\nImageProcessing::Vips\n  .source(image)\n  .loader(dpi: 300)\n  .saver(quality: 82)\n  # ...\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 8749164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc7b381bca7eaafdbd6bcecbcc4a5d4b?s=128&d=identicon&r=PG&f=1", "display_name": "Dauncing", "link": "https://stackoverflow.com/users/8749164/dauncing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 57986893, "answer_count": 1, "score": 0, "last_activity_date": 1568790787, "creation_date": 1568779229, "last_edit_date": 1568790787, "question_id": 57984916, "link": "https://stackoverflow.com/questions/57984916/add-density-flag-to-libvips-command-with-image-processing", "title": "Add --density flag to libvips command with image_processing?", "body": "<p>I'm trying to add the <a href=\"https://github.com/libvips/libvips/issues/379#issuecomment-181283691\" rel=\"nofollow noreferrer\">--density</a> flag to the libvips command so that PDFs (or other vector images) convert to JPG at an acceptable resolution.</p>\n\n<p>Context\u2014before I upgraded to a recent version of image_processing, I was using MiniMagick with the older version and was able to add arbitrary flags using this code:</p>\n\n<pre><code>  MiniMagick::Tool::Convert.new do |convert|\n    convert &lt;&lt; \"-verbose\" \n    convert &lt;&lt; \"-background\" &lt;&lt; \"white\"\n    convert &lt;&lt; \"-flatten\"\n    convert &lt;&lt; \"-density\" &lt;&lt; \"300\"\n    convert &lt;&lt; page.path          \n    convert &lt;&lt; \"-quality\" &lt;&lt; \"82\"\n    convert &lt;&lt; page_image.path\n  end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "intellij-idea"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1568778671, "post_id": 57984615, "comment_id": 102378105, "body": "Here&#39;s a curated list of <a href=\"https://github.com/mre/awesome-static-analysis#ruby\" rel=\"nofollow noreferrer\">Ruby static analysers</a>; for example, ruby-lint."}], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 3815144, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000906350931/picture?type=large", "display_name": "Elayan Hamamrah", "link": "https://stackoverflow.com/users/3815144/elayan-hamamrah"}, "is_accepted": false, "score": 0, "last_activity_date": 1568790324, "creation_date": 1568790324, "answer_id": 57986885, "question_id": 57984615, "link": "https://stackoverflow.com/questions/57984615/how-to-check-for-errors-in-ruby-as-intellij-does/57986885#57986885", "title": "How to check for errors in Ruby as IntelliJ does?", "body": "<p>You could add <code>debugger</code> anywhere before or after any code you would like to trace.\nOnce you do the action from the browser, your running server in shell will pause the work and give you the ability to trace your code and test it.</p>\n\n<p>I would recommend you to read more about debugging Rails applications.\n<a href=\"https://guides.rubyonrails.org/debugging_rails_applications.html\" rel=\"nofollow noreferrer\">Click here to read more about rails debugging</a></p>\n"}], "owner": {"reputation": 65, "user_id": 1664184, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f1491a992c7361e823f9bda9fc430ea5?s=128&d=identicon&r=PG", "display_name": "Vraiment", "link": "https://stackoverflow.com/users/1664184/vraiment"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568790324, "creation_date": 1568776989, "question_id": 57984615, "link": "https://stackoverflow.com/questions/57984615/how-to-check-for-errors-in-ruby-as-intellij-does", "title": "How to check for errors in Ruby as IntelliJ does?", "body": "<p>Recently I had a problem with a Rails application with the following code:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class MyBaseController &lt; ApplicationController\n  def error(a, b)\n    # ...\n  end\nend\n\nclass MyController &lt; MyBaseController\n  def my_action\n    begin\n      another_method\n    rescue e\n      # The next line had a typo, it should\n      # have been \"e\" instead of \"error\" and\n      # hence it caused and unhandled exception\n      logger.error(\"the error was #{error}\")\n\n      # ...\n    end\n\n    # ...\n  end\nend\n</code></pre>\n\n<p>As you can see the logging statement will fail as it will try to call the <code>error</code> method from <code>MyBaseController</code> instead of getting the value of <code>e</code>.</p>\n\n<p>This was an honest mistake but from what I see it could have been prevented: when I opened my application in IntelliJ with the Ruby plugin it marked the error with a red <em>squiggle</em>. Is not the first time I've seen one of these errors </p>\n\n<p>My question is: Is there any Gem or tool (besides Intellij) to detect this kind of problems so I can add to my Rakefile and run it in my toolchain before my application gets deployed?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "delegation", "ruby-on-rails-5.2"], "answers": [{"comments": [{"owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "edited": false, "score": 0, "creation_date": 1568818972, "post_id": 57990272, "comment_id": 102398041, "body": "Failure/Error: expect(user).to have_received(:first)              (Double &quot;user&quot;).first(*(any args))            expected: 1 time with any arguments            received: 0 times with any arguments"}, {"owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "edited": false, "score": 0, "creation_date": 1568819036, "post_id": 57990272, "comment_id": 102398080, "body": "Also what is an anonymous class?"}, {"owner": {"reputation": 2262, "user_id": 4101569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c4c64e58bc5cdeec8e7ce067131a54?s=128&d=identicon&r=PG", "display_name": "katafrakt", "link": "https://stackoverflow.com/users/4101569/katafrakt"}, "reply_to_user": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "edited": false, "score": 0, "creation_date": 1568882861, "post_id": 57990272, "comment_id": 102418838, "body": "Shouldn&#39;t you call something like <code>TestClass.new.first</code> before checking if it was delegated to <code>user</code>?"}, {"owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "edited": false, "score": 0, "creation_date": 1568886983, "post_id": 57990272, "comment_id": 102421100, "body": "Yes, that was corrected in actual code, it\u2019s all working now. Thank you"}], "tags": [], "owner": {"reputation": 2262, "user_id": 4101569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c4c64e58bc5cdeec8e7ce067131a54?s=128&d=identicon&r=PG", "display_name": "katafrakt", "link": "https://stackoverflow.com/users/4101569/katafrakt"}, "is_accepted": true, "score": 1, "last_activity_date": 1568801374, "creation_date": 1568801374, "answer_id": 57990272, "question_id": 57984187, "link": "https://stackoverflow.com/questions/57984187/rspec-testing-delegation-for-module-method-undefined-method/57990272#57990272", "title": "rspec testing delegation for module method undefined method", "body": "<p>As your module is designed to be included, just include it in an empty class in tests. I prepared a simplified example which I verified to work:</p>\n\n<pre><code>module ToBeIncluded\n  def self.included(base)\n    base.extend(ClassMethods)\n  end\n\n  module ClassMethods\n    def a_class_method\n      :class\n    end\n  end\nend\n\nclass TestSubject\n  include ToBeIncluded\nend\n\nrequire 'rspec/core'\n\nRSpec.describe ToBeIncluded do\n  subject { TestSubject }\n\n  it 'returns correct symbol' do\n    expect(subject.a_class_method).to eq(:class)\n  end\nend\n</code></pre>\n\n<p>In your case probably something along those lines should be fine:</p>\n\n<pre><code>require \"rails_helper\"\n\nRSpec.describe Registration::Base::ActAsDelegation, type: :model do\n  class TestClass\n    include Registration::Base::ActAsDelegation\n  end\n\n  describe \"Class Methods\" do\n    context \"#delegate_fields_to\" do\n      let(:user) {spy('user')}\n      let(:address) {spy('address')}\n      let(:delegation_fields) {          [ \n            {name: :first, model: :user},\n            {name: :address, model: :address}\n          ]}\n\n      it \"should delegate\" do\n        allow(TestClass).to receive(:form_fields_mapping) { delegation_fields }\n        TestClass.delegate_fields_to(:user,:address)\n        expect(user).to have_received(:first)\n        expect(address).to have_received(:address)\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Also, you could make anonymous class if you are afraid of name clashes.</p>\n"}], "owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 564, "favorite_count": 0, "accepted_answer_id": 57990272, "answer_count": 1, "score": 0, "last_activity_date": 1568840822, "creation_date": 1568773085, "last_edit_date": 1568840822, "question_id": 57984187, "link": "https://stackoverflow.com/questions/57984187/rspec-testing-delegation-for-module-method-undefined-method", "title": "rspec testing delegation for module method undefined method", "body": "<p>This module gets included in a form object within rails. </p>\n\n<p>What is the right way to test it using rspec?  </p>\n\n<p>1) Do I test it directly on each model that includes it?</p>\n\n<p>or</p>\n\n<p>2) Do I test the delegation method directly? (i would prefer direct if possible)</p>\n\n<p>If I test it directly, how? I tried and get the below error...</p>\n\n<h3>Form Object Module</h3>\n\n<pre><code>module Registration\n  class Base\n    module ActAsDelegation\n      def self.included(base)\n        base.extend(ClassMethods)\n      end\n\n      module ClassMethods\n        def form_fields_mapping\n          [ \n            {name: :first, model: :user},\n            {name: :address, model: :address}\n          ]\n        end\n\n        def fields_of_model(model)\n          form_fields_mapping.select {|record| record[:model] == model }.map {|record| record[:name] }\n        end\n\n        def delegate_fields_to(*models)\n          models.each do |model|\n            fields_of_model(model).each do |attr|\n              delegate attr.to_sym, \"#{attr}=\".to_sym, to: model if attr.present?\n            end\n          end\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<h3>Form Object</h3>\n\n<pre><code>module Registration\n  class Base\n    include ActiveModel::Model\n    include ActAsDelegation\n\n    def initialize(user=nil, attributes={})\n      error_msg = \"Can only initiate inherited Classes of Base, not Base Directly\"\n      raise ArgumentError, error_msg if self.class == Registration::Base\n\n      @user = user\n      setup_custom_accessors\n\n      unless attributes.nil?\n        (self.class.model_fields &amp; attributes.keys.map(&amp;:to_sym)).each do |field|\n          public_send(\"#{field}=\".to_sym, attributes[field])\n        end\n      end\n      validate!\n    end\n  end\nend\n</code></pre>\n\n<h3>RSPEC TESTING</h3>\n\n<pre><code>require \"rails_helper\"\n\nRSpec.describe Registration::Base::ActAsDelegation, type: :model do\n\n  describe \"Class Methods\" do\n    context \"#delegate_fields_to\" do\n      let(:user) {spy('user')}\n      let(:address) {spy('address')}\n      let(:delegation_fields) {          [ \n            {name: :first, model: :user},\n            {name: :address, model: :address}\n          ]}\n\n      it \"should delegate\" do\n        allow(subject).to receive(:form_fields_mapping) { delegation_fields }\n        Registration::Base::ActAsDelegation.delegate_fields_to(:user,:address)\n        expect(user).to have_received(:first)\n        expect(address).to have_received(:address)\n      end\n    end\n  end\nend\n</code></pre>\n\n<h3>ERROR</h3>\n\n<blockquote>\n  <p>Failure/Error:\n  Registration::Base::ActAsDelegation.delegate_fields_to(:user,:address)</p>\n\n<pre><code> NoMethodError:\n   undefined method `delegate_fields_to' for Registration::Base::ActAsDelegation:Module\n   Did you mean?  delegate_missing_to\n</code></pre>\n</blockquote>\n\n<p>(I have other code issues in this example, but below resoved the main issue)</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1568769613, "post_id": 57983571, "comment_id": 102376457, "body": "A tiny detail: <code>Object#yield_self</code> made its debut in v2.5; <code>Object#then</code>, an alias, came out in v2.6. I personally prefer the latter, for readability."}, {"owner": {"reputation": 20898, "user_id": 11194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6ee76d05f9b62656b9eeaa81fe4619db?s=128&d=identicon&r=PG", "display_name": "Ash", "link": "https://stackoverflow.com/users/11194/ash"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1568772113, "post_id": 57983571, "comment_id": 102376910, "body": "Ahh, true...I was going to use #then in my actual code, but thought I&#39;d use the original example for clarity."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1568772249, "post_id": 57983571, "comment_id": 102376926, "body": "What happened when you tried it?"}, {"owner": {"reputation": 20898, "user_id": 11194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6ee76d05f9b62656b9eeaa81fe4619db?s=128&d=identicon&r=PG", "display_name": "Ash", "link": "https://stackoverflow.com/users/11194/ash"}, "edited": false, "score": 0, "creation_date": 1568774629, "post_id": 57983571, "comment_id": 102377369, "body": "It doesn&#39;t work in my example, but why? Is there another way to pass the parameter into &amp;: without &amp;method?"}], "owner": {"reputation": 20898, "user_id": 11194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6ee76d05f9b62656b9eeaa81fe4619db?s=128&d=identicon&r=PG", "display_name": "Ash", "link": "https://stackoverflow.com/users/11194/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568772130, "creation_date": 1568767191, "last_edit_date": 1568772130, "question_id": 57983571, "link": "https://stackoverflow.com/questions/57983571/can-you-use-instead-of-method-in-ruby-2-5-with-a-yield-self", "title": "Can you use &amp;: instead of &amp;method in ruby 2.5 with a #yield_self?", "body": "<p>Since the release of Ruby 2.5 we have been given the new <code>#yield_self</code> method. I think this is a fantastic addition as finally I can string large active record scopes (conditionally) together.</p>\n\n<p>However, while reading <a href=\"https://medium.com/tailor-tech/whats-new-in-ruby-2-6-a4774f3631c1\" rel=\"nofollow noreferrer\">this page</a> it has the following example:</p>\n\n<pre><code>Event.upcoming\n  .yield_self { |events| params[:limit]  ? events.limit(params[:limit]) : events }\n  .yield_self { |events| params[:status] ? events.where(status: params[:status]) : events }\n# Or even\nEvent.upcoming\n  .yield_self { |_| params[:limit] ? _.limit(params[:limit]) : _ }\n  .yield_self { |_| params[:status] ? _.where(status: params[:status]) : _ }\n# Or even\ndef with_limit(events)\n  params[:limit] ? events.limit(params[:limit]) : events\nend\ndef with_status(events)\n  params[:status] ? events.where(status: params[:status]) : events\nend\nEvent.upcoming\n  .yield_self(&amp;method(:with_limit))\n  .yield_self(&amp;method(:with_status))\n</code></pre>\n\n<p>Which is exactly what I want to do, however I was wondering, regarding the bottom bit, could you write this instead?</p>\n\n<pre><code>Event.upcoming\n  .yield_self(&amp;:with_limit)\n  .yield_self(&amp;:with_status)\n</code></pre>\n\n<p>Or do you specifically need the <code>&amp;method</code> part to call the methods properly with yield_self?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "comments": [{"owner": {"reputation": 88, "user_id": 10063851, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-G5zeMgH7aAs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oQYTI4hGcoYfZpKEW3J0snppNW5A/mo/photo.jpg?sz=128", "display_name": "Steve Redka", "link": "https://stackoverflow.com/users/10063851/steve-redka"}, "edited": false, "score": 0, "creation_date": 1568766016, "post_id": 57982547, "comment_id": 102375897, "body": "What&#39;s <code>resource</code>? Could it be current user, if you are already logged in?"}, {"owner": {"reputation": 560, "user_id": 11883546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab46bcd1aad9d7d7e8629d555d263a90?s=128&d=identicon&r=PG", "display_name": "Violeta", "link": "https://stackoverflow.com/users/11883546/violeta"}, "edited": false, "score": 0, "creation_date": 1568794548, "post_id": 57982547, "comment_id": 102383872, "body": "Hey @ SwiftHub, I just re-created the same scenario, and it was working just fine. The only thing I forgot to do, is to re-start the server after running <code>rails generate simple_form:install</code>. Can you tell us if some error is raised and if so, can you show us?"}, {"owner": {"reputation": 81, "user_id": 9561042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbde692344e4067815489f888f06e1f?s=128&d=identicon&r=PG", "display_name": "SwiftHub", "link": "https://stackoverflow.com/users/9561042/swifthub"}, "edited": false, "score": 0, "creation_date": 1568808193, "post_id": 57982547, "comment_id": 102391538, "body": "Hey thanks will try this when I get home later. I\u2019m not entirely sure what resource is, but it\u2019s required"}], "owner": {"reputation": 81, "user_id": 9561042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbde692344e4067815489f888f06e1f?s=128&d=identicon&r=PG", "display_name": "SwiftHub", "link": "https://stackoverflow.com/users/9561042/swifthub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1581514639, "creation_date": 1568757315, "last_edit_date": 1581514639, "question_id": 57982547, "link": "https://stackoverflow.com/questions/57982547/devise-how-to-render-registration-new-form-onto-sessions-new", "title": "Devise: How to render registration/new form onto sessions/new", "body": "<p>Hi am trying to render my devise <code>registration/new</code> form onto my <code>sessions/new</code> page. I want the user to be able to either create or login on the same page.</p>\n\n<p>Here is what I have so far, but it's not working. It thinks it's a login form and not a creation form, as it lets me login on my registration form.</p>\n\n<p>In <code>app/views/users/sessions/new.html.erb</code>, I have this code:</p>\n\n<pre><code>&lt;br&gt;\n&lt;br&gt;\n\n&lt;body class=\"bg-dark\"&gt;\n    &lt;div class=\"\"&gt;\n        &lt;div class=\"row\"&gt;\n            &lt;div class=\"col-sm\"&gt;\n                &lt;div class=\"container text-white\"&gt;\n                    &lt;%= simple_form_for(resource, as: resource_name, url: session_path(resource_name)) do |f| %&gt;\n                    &lt;h1&gt;Sign in&lt;/h1&gt;\n                    &lt;p&gt;Welcome back.&lt;/p&gt;\n                    &lt;form role=\"form\"&gt;\n                        &lt;div class=\"row\"&gt;\n                            &lt;div class=\"form-group col-lg-8\"&gt;\n                                &lt;%= f.input :email,\n                                            required: false,\n                                            autofocus: true,\n                                            input_html: { autocomplete: \"email\"} %&gt;\n                            &lt;/div&gt;\n                        &lt;/div&gt;\n                        &lt;div class=\"row\"&gt;\n                            &lt;div class=\"form-group col-lg-8 \"&gt;\n                                &lt;%= f.input :password,\n                                            required: false,\n                                            input_html: { autocomplete: \"current-password\" } %&gt;\n                            &lt;/div&gt;\n                        &lt;/div&gt;\n                        &lt;div class=\"row\"&gt;\n                            &lt;div class=\"form-group col-lg-8 \"&gt;\n                                &lt;%= f.input :remember_me, as: :boolean if devise_mapping.rememberable? %&gt;\n                            &lt;/div&gt;\n                        &lt;/div&gt;\n                        &lt;%= f.button :submit, \"Sign in\", class: \"btn btn-info\" %&gt;\n                    &lt;/form&gt;\n                &lt;/div&gt;\n                &lt;% end %&gt;\n            &lt;/div&gt;\n            &lt;div class=\"col-sm\"&gt;\n                &lt;div class=\" text-white \"&gt;\n                    &lt;%= simple_form_for(resource, as: resource_name, url: registration_path(:user)) do |f| %&gt;\n\n                    &lt;h1&gt;Create an account&lt;/h1&gt;\n                    &lt;p&gt;Its quick and easy.&lt;/p&gt;\n                    &lt;%= f.error_notification %&gt;\n\n                    &lt;form role=\"form\"&gt;\n                        &lt;div class=\"row\"&gt;\n                            &lt;div class=\"form-group col-lg-8\"&gt;\n                                &lt;%= f.input :email,\n                                            required: true,\n                                            autofocus: true,\n                                            input_html: { autocomplete: \"email\" }%&gt;\n                            &lt;/div&gt;\n                        &lt;/div&gt;\n\n                        &lt;div class=\"row\"&gt;\n                            &lt;div class=\"form-group col-lg-8 \"&gt;\n                                &lt;%= f.input :password,\n                                            required: true,\n                                            hint: (\"#{@minimum_password_length} characters minimum\" if @minimum_password_length),\n                                            input_html: { autocomplete: \"new-password\" } %&gt;\n                            &lt;/div&gt;\n                        &lt;/div&gt;\n\n                        &lt;div class=\"row\"&gt;\n                            &lt;div class=\"form-group col-lg-8 \"&gt;\n                                &lt;%= f.input :password_confirmation,\n                                            required: true,\n                                            input_html: { autocomplete: \"new-password\" } %&gt;\n                            &lt;/div&gt;\n                        &lt;/div&gt;\n\n                        &lt;%= f.button :submit, \"Create Account\", class: \"btn btn-success\" %&gt;\n                    &lt;/form&gt;\n                &lt;/div&gt;\n                &lt;% end %&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/body&gt;\n\n&lt;div class=\"container\"&gt;\n    &lt;%= render \"devise/shared/links\" %&gt;\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ruby", "twilio", "copilot"], "answers": [{"tags": [], "owner": {"reputation": 53136, "user_id": 28376, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ec1383b240b5ba15ffb9743fceb3c0e?s=128&d=identicon&r=PG", "display_name": "philnash", "link": "https://stackoverflow.com/users/28376/philnash"}, "is_accepted": true, "score": 0, "last_activity_date": 1568790432, "creation_date": 1568790432, "answer_id": 57986916, "question_id": 57982441, "link": "https://stackoverflow.com/questions/57982441/how-do-i-retrieve-the-sender-number-when-using-twilios-messaging-services-with/57986916#57986916", "title": "How do I retrieve the sender number when using Twilio&#39;s messaging services with Copilot enabled?", "body": "<p>Twilio developer evangelist here.</p>\n\n<p>I'm not sure, but you might not have the phone number at the time you make the API request using a messaging service. This request really just queues up the message to be sent.</p>\n\n<p>I would check the message object once it has been sent. You have a status callback URL setup, so you should be able to either <a href=\"https://www.twilio.com/docs/sms/api/message-resource#statuscallback-request-parameters\" rel=\"nofollow noreferrer\">inspect the parameters sent to that URL</a> or <a href=\"https://www.twilio.com/docs/sms/api/message-resource#fetch-a-message-resource\" rel=\"nofollow noreferrer\">look up the message from the API using its SID</a> and then get the number that was used.</p>\n"}], "owner": {"reputation": 3, "user_id": 7351043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fccca82f167b0ecde2051e296001222?s=128&d=identicon&r=PG&f=1", "display_name": "jafusmaximus", "link": "https://stackoverflow.com/users/7351043/jafusmaximus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 57986916, "answer_count": 1, "score": 0, "last_activity_date": 1568790432, "creation_date": 1568756580, "question_id": 57982441, "link": "https://stackoverflow.com/questions/57982441/how-do-i-retrieve-the-sender-number-when-using-twilios-messaging-services-with", "title": "How do I retrieve the sender number when using Twilio&#39;s messaging services with Copilot enabled?", "body": "<p>I have a Twilio messaging service with Copilot and the sticky sender feature enabled.\nI would like to view the phone number that Copilot assigns to my recipients when I send them a message.\nWith the Ruby client, I get a <code>MessageContext</code> object when I send a message, but it only has the\nmessaging service SID - the <code>from</code> method returns <code>nil</code>. </p>\n\n<p>Currently, this is how I'm sending messages:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def send(from, to, message)\n  client = Twilio::REST::Client.new(ACCOUNT_SID, AUTH_TOKEN)\n\n  client.api.account.messages.create(\n    body: message,\n    messaging_service_sid: from,\n    to: to,\n    status_callback: BASE_URL + '/sms_status/status',\n  )\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "exception", "redis", "rescue"], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 12081412, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1A6S4.jpg?s=128&g=1", "display_name": "Omnivium", "link": "https://stackoverflow.com/users/12081412/omnivium"}, "edited": false, "score": 0, "creation_date": 1568778898, "post_id": 57983353, "comment_id": 102378137, "body": "I&#39;ve tried both <code>break</code> and <code>return</code> to no avail :(.  There appears to be something more than meets the eye implicitly going under the hood with <code>rescue_from</code>."}, {"owner": {"reputation": 527, "user_id": 8197386, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3PsfAC8lxvE/AAAAAAAAAAI/AAAAAAAAAJU/9gierdn8mII/photo.jpg?sz=128", "display_name": "sevensidedmarble", "link": "https://stackoverflow.com/users/8197386/sevensidedmarble"}, "reply_to_user": {"reputation": 131, "user_id": 12081412, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1A6S4.jpg?s=128&g=1", "display_name": "Omnivium", "link": "https://stackoverflow.com/users/12081412/omnivium"}, "edited": false, "score": 0, "creation_date": 1568821711, "post_id": 57983353, "comment_id": 102399620, "body": "Can you post entire source code? It&#39;s a little hard to follow the byebug trace"}], "tags": [], "owner": {"reputation": 527, "user_id": 8197386, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3PsfAC8lxvE/AAAAAAAAAAI/AAAAAAAAAJU/9gierdn8mII/photo.jpg?sz=128", "display_name": "sevensidedmarble", "link": "https://stackoverflow.com/users/8197386/sevensidedmarble"}, "is_accepted": false, "score": 0, "last_activity_date": 1568764869, "creation_date": 1568764869, "answer_id": 57983353, "question_id": 57981292, "link": "https://stackoverflow.com/questions/57981292/in-rails-is-there-a-way-to-short-circuit-out-of-a-rescue-from/57983353#57983353", "title": "In Rails, is there a way to &quot;short-circuit&quot; out of a rescue_from?", "body": "<blockquote>\n  <p>So my question is: is there any way to get the rescue_from block to just stop and not continue triggering anything else after a certain line is reached?</p>\n</blockquote>\n\n<p>Yes, just call the ruby <code>break</code> keyword.</p>\n\n<p><code>break</code> is for breaking out of a block entirely. <code>next</code> is for breaking out of a block and moving on to the next iteration (like in a while loop). They're very useful.</p>\n"}], "owner": {"reputation": 131, "user_id": 12081412, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1A6S4.jpg?s=128&g=1", "display_name": "Omnivium", "link": "https://stackoverflow.com/users/12081412/omnivium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 299, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1568764869, "creation_date": 1568750472, "last_edit_date": 1568750993, "question_id": 57981292, "link": "https://stackoverflow.com/questions/57981292/in-rails-is-there-a-way-to-short-circuit-out-of-a-rescue-from", "title": "In Rails, is there a way to &quot;short-circuit&quot; out of a rescue_from?", "body": "<p>I am trying to make a nice user-friendly failsafe recovery for Redis in Rails.  I'm using the built in <code>redis_cache_store</code> and have <code>reconnect_attempts</code> set, but I would like to send the user to a custom error page in the event that Redis remains down, rather than have them be stuck on a nonresponsive page with no idea what is going on.</p>\n\n<p>What I tried was to monkey-patch the <code>failsafe</code> method in <code>RedisCacheStore</code> by re-raising a new type of error, <code>RedisUnavailableError</code>, which I then have my <code>application_controller</code> catch and <code>redirect_to</code> a static 500 page.</p>\n\n<p>Where this breaks down is that I would like my application to just stop after the redirect.  In the <code>byebug</code> trace below, you can see that before the second-last block I've included, the <code>redirect</code> line is reached.  </p>\n\n<p>But it does not stop; I've included just the first of a long sequence of further methods invoked that eventually results in another attempt to write to Redis, which is still down, which then re-raises the same sequence of exceptions, which Rails then will not catch a second time (indeed even if it did, that would be an infinite loop).</p>\n\n<p>So my question is: is there any way to get the <code>rescue_from</code> block to just <em>stop</em> and not continue triggering anything else after a certain line is reached?  </p>\n\n<p>Alternately, is there any way to on the fly \"disable\" Redis or change the cache store/settings to some nullary value in the <code>rescue_from</code> block so that anything further triggered won't try to talk to Redis?</p>\n\n<pre><code>    [40, 49] in (DELETED)/redis_failsafe.rb\n       40:   rescue ::Redis::BaseConnectionError =&gt; e\n       41:     byebug\n       42:     handle_exception(exception: e, method: method, returning: returning)\n       43:     returning\n       44:     byebug\n    =&gt; 45:     raise RedisUnavailableError\n       46:     # Re-raise the exception when reconnect attempt fails, so our application controller can handle it.\n       47:   end\n       48: end\n       49: \n    (byebug) c\n\n    [INFO][15:50:51] [3cf7] [GET] [(DELETED):3000] [/suppliers] \n    \u2219 Redirecting to 500 page due to: RedisUnavailableError\n\n    [30, 39] in /(DELETED)/application_controller.rb\n       30:   authorize_resource class: false\n       31: \n       32:   rescue_from RedisUnavailableError do |exception|\n       33:     byebug\n       34:     Rails.logger.info \"Redirecting to 500 page due to: #{exception.message}\"\n    =&gt; 35:     redirect_to '/500.html'\n       36:     byebug\n       37:   end\n       38: \n       39:   rescue_from ActiveRecord::RecordNotFound do\n    (byebug) n\n    \u2219 Redirected to http://(DELETED)/500.html\n    Return value is: nil\n\n    [32, 41] in /(DELETED)/application_controller.rb\n       32:   rescue_from RedisUnavailableError do |exception|\n       33:     byebug\n       34:     Rails.logger.info \"Redirecting to 500 page due to: #{exception.message}\"\n       35:     redirect_to '/500.html'\n       36:     byebug\n    =&gt; 37:   end\n       38: \n       39:   rescue_from ActiveRecord::RecordNotFound do\n       40:     render status: :not_found, plain: 'Not found'\n       41:   end\n    (byebug) n\n\n    [51, 60] in /(DELETED)/rescuable.rb\n       51:   def rescue_with_handler(exception, object: self, visited_exceptions: [])\n       52:     visited_exceptions &lt;&lt; exception\n       53: \n       54:     if handler = handler_for_rescue(exception, object: object)\n       55:       handler.call exception\n    =&gt; 56:       exception\n       57:     elsif exception\n       58:       if visited_exceptions.include?(exception.cause)\n       59:         nil\n       60:       else\n    (byebug) \n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 2, "last_activity_date": 1568757395, "last_edit_date": 1568757395, "creation_date": 1568756684, "answer_id": 57982452, "question_id": 57981250, "link": "https://stackoverflow.com/questions/57981250/how-do-i-prevent-model-update-from-changing-an-attribute/57982452#57982452", "title": "How do I prevent model update from changing an attribute?", "body": "<p>I think what you want is a <a href=\"https://guides.rubyonrails.org/active_record_callbacks.html#available-callbacks\" rel=\"nofollow noreferrer\">model callback</a> <code>before_update</code> that acts like a validation.</p>\n\n<pre><code>class Account &lt; ApplicationRecord\n  enum role: [:user, :admin]\n\n  before_update :insure_admin, if: -&gt; { role == :admin &amp;&amp; role_changed? }\n\n  private\n  def insure_admin\n    errors.add(:role, \"admin cannot switch to regular user\")\n  end\nend\n</code></pre>\n\n<p>This should prevent the <code>account.update(role: params[:role])</code> from returning true but you'll probably want to handle the error in your controller, something like:</p>\n\n<pre><code>class AccountsController &lt; ApplicationController\n  def index\n    @accounts = Account.all\n  end\n  def update\n    @account = Account.find(params[:id])\n    if account.update(role: params[:role])\n      redirect_to accounts_path \n    else\n      redirect_to :back, flash: account.errors.full_messages\n    end\n  end\nend\n</code></pre>\n\n<p>You might also want to add front end form validation to not allow the form to change role if the account is already persisted. </p>\n"}], "owner": {"reputation": 29, "user_id": 8027736, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9yQylECHK4g/AAAAAAAAAAI/AAAAAAAAAWM/NEV5CRivjg0/photo.jpg?sz=128", "display_name": "Valit Laiho ", "link": "https://stackoverflow.com/users/8027736/valit-laiho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1568757395, "creation_date": 1568750232, "last_edit_date": 1568756844, "question_id": 57981250, "link": "https://stackoverflow.com/questions/57981250/how-do-i-prevent-model-update-from-changing-an-attribute", "title": "How do I prevent model update from changing an attribute?", "body": "<p>I have <code>Account</code> model with attribute <code>role</code>. Roles wrote with <code>enum role: [:user, :admin]</code>. I want that if left one account with role <code>admin</code> he can't update his role to <code>user</code>. I think need to write something like this: <code>@account = Account.where(role: params[: role])...</code> and then I don't know.</p>\n\n<p><strong>account.rb</strong></p>\n\n<pre><code>class Account &lt; ApplicationRecord\n  enum role: [:user, :admin]\nend\n</code></pre>\n\n<p><strong>accounts_controller.rb</strong></p>\n\n<pre><code>class AccountsController &lt; ApplicationController\n  def index\n    @accounts = Account.all\n  end\n  def update\n    @account = Account.find(params[:id])\n    redirect_to accounts_path if account.update(role: params[:role])\n  end\nend\n</code></pre>\n\n<p><strong>schema.rb</strong></p>\n\n<pre><code>create_table \"accounts\", force: :cascade do |t|\n  t.integer \"role\", default: 0\nend\n</code></pre>\n"}, {"tags": ["regex", "ruby", "kubernetes", "fluentd"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 9826618, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aszTNrSB2hc/AAAAAAAAAAI/AAAAAAAAABE/TXvGHkqt864/photo.jpg?sz=128", "display_name": "Stepan K.", "link": "https://stackoverflow.com/users/9826618/stepan-k"}, "edited": false, "score": 0, "creation_date": 1568789128, "post_id": 57981899, "comment_id": 102381155, "body": "Yes it is good way, but in my case I can&#39;t use several matches I have to use only one :) are there ways for drop everything except one in one match? Via ruby expression for example ?"}, {"owner": {"reputation": 4468, "user_id": 923620, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/YOmxc.jpg?s=128&g=1", "display_name": "Max Lobur", "link": "https://stackoverflow.com/users/923620/max-lobur"}, "reply_to_user": {"reputation": 75, "user_id": 9826618, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aszTNrSB2hc/AAAAAAAAAAI/AAAAAAAAABE/TXvGHkqt864/photo.jpg?sz=128", "display_name": "Stepan K.", "link": "https://stackoverflow.com/users/9826618/stepan-k"}, "edited": false, "score": 0, "creation_date": 1568819914, "post_id": 57981899, "comment_id": 102398550, "body": "<code>drop everything except one</code> is exactly what precise match is doing. Updated my example."}], "tags": [], "owner": {"reputation": 4468, "user_id": 923620, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/YOmxc.jpg?s=128&g=1", "display_name": "Max Lobur", "link": "https://stackoverflow.com/users/923620/max-lobur"}, "is_accepted": true, "score": 5, "last_activity_date": 1598868204, "last_edit_date": 1598868204, "creation_date": 1568753489, "answer_id": 57981899, "question_id": 57981063, "link": "https://stackoverflow.com/questions/57981063/how-to-exclude-pattern-in-match-for-fluentd-config/57981899#57981899", "title": "How to exclude pattern in &lt;match&gt; for fluentd config?", "body": "<p>Drop one, leave everything else:</p>\n<pre><code>&lt;match what.you.want.to.drop&gt;\n  @type null\n&lt;/match&gt;\n&lt;match **&gt;\n  # process everything else\n&lt;/match&gt;\n</code></pre>\n<p>Drop everything except one:</p>\n<pre><code>&lt;match what.you.want.to.stay&gt;\n  # process here or send to a label\n&lt;/match&gt;\n&lt;match **&gt; # Optional block. It will be dropped anyways if no other matches, but with a warning printed to a fluentd log.\n  # Drop everything else explicitly to avoid warning.\n  @type null\n&lt;/match&gt;\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 9826618, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aszTNrSB2hc/AAAAAAAAAAI/AAAAAAAAABE/TXvGHkqt864/photo.jpg?sz=128", "display_name": "Stepan K.", "link": "https://stackoverflow.com/users/9826618/stepan-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2707, "favorite_count": 0, "accepted_answer_id": 57981899, "answer_count": 1, "score": 2, "last_activity_date": 1598868204, "creation_date": 1568749334, "last_edit_date": 1568750957, "question_id": 57981063, "link": "https://stackoverflow.com/questions/57981063/how-to-exclude-pattern-in-match-for-fluentd-config", "title": "How to exclude pattern in &lt;match&gt; for fluentd config?", "body": "<p>I want to output all in null, except the one pattern in <strong>match</strong>. I know there are some ways to do that via @labels for example, but i exactly want to exclude pattern in <strong>match</strong>. </p>\n\n<p>I want to do like this:</p>\n\n<pre><code>&lt;match {all tags except **events**}&gt;\n</code></pre>\n\n<p><strong>What i did:</strong></p>\n\n<p>I know i can use Ruby expressions in <strong>match</strong> like this:</p>\n\n<pre><code>&lt;match #{tag.match(/^.*event.*$/) ? \"fake_tag\" : \"**\"}&gt;\n  @type null\n&lt;/match&gt;\n</code></pre>\n\n<p><strong>Logic:</strong> \"If current tag has pattern - set fake_tag for skip this <strong>match</strong>, else set ** for output all in null\"</p>\n\n<p>But this expression doesn't work because there is no variable $tag in ENV. As i understood Ruby expression can't use config variables like ${tag}.</p>\n\n<p>Maybe i can set ENV variable before <strong>match</strong> step? </p>\n\n<p>Like this:</p>\n\n<pre><code>&lt;filter **event**&gt;\n  #{ENV[\"FLUENTD_TAG\"] = ${tag}}\n&lt;/filter&gt;\n\n&lt;match #{FLUENTD_TAG.match(/^.*event.*$/) ? \"fake_tag\" : \"**\"}&gt;\n  @type null\n&lt;/match&gt;\n</code></pre>\n\n<p>These are my thoughts but maybe there are simpler ways.</p>\n\n<p>The question is - how to exclude pattern in <strong>match</strong> ? :-) </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 11573, "user_id": 473792, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/bwv8P.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/473792/kevin"}, "edited": false, "score": 1, "creation_date": 1568749451, "post_id": 57980979, "comment_id": 102371307, "body": "Hmmm... I can do this, but is there a way to execute the script without spawning another process?"}, {"owner": {"reputation": 88, "user_id": 10063851, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-G5zeMgH7aAs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oQYTI4hGcoYfZpKEW3J0snppNW5A/mo/photo.jpg?sz=128", "display_name": "Steve Redka", "link": "https://stackoverflow.com/users/10063851/steve-redka"}, "reply_to_user": {"reputation": 11573, "user_id": 473792, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/bwv8P.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/473792/kevin"}, "edited": false, "score": 0, "creation_date": 1568765440, "post_id": 57980979, "comment_id": 102375810, "body": "It&#39;s possible to do by putting your script code into module and requiring it. I edited the post to describe how"}], "tags": [], "owner": {"reputation": 88, "user_id": 10063851, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-G5zeMgH7aAs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oQYTI4hGcoYfZpKEW3J0snppNW5A/mo/photo.jpg?sz=128", "display_name": "Steve Redka", "link": "https://stackoverflow.com/users/10063851/steve-redka"}, "is_accepted": false, "score": 0, "last_activity_date": 1568765198, "last_edit_date": 1568765198, "creation_date": 1568749038, "answer_id": 57980979, "question_id": 57980843, "link": "https://stackoverflow.com/questions/57980843/how-do-i-test-a-script-using-rspec/57980979#57980979", "title": "How do I test a script using RSpec?", "body": "<p>I think you want to use <a href=\"https://apidock.com/ruby/Kernel/system\" rel=\"nofollow noreferrer\">system</a>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>system('rails runner my_script.rb')\n</code></pre>\n\n<hr>\n\n<p>edit #1</p>\n\n<p>If you are willing to butcher the script, you can move the active components of your script into separate module and <code>require</code> that:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># my_script.rb\nrequire './lib/my_script.rb'\nMyScript.call()\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code># lib/my_script.rb\nmodule MyScript\n  def self.call\n    # your code\n  end\nend\n</code></pre>\n\n<p>Then, in test:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require './lib/my_script.rb'\n\ndescribe \"my script\" do\n  it \"should create the correct record\" do\n    before_count = Orders.count\n\n    MyScript.call() # here\n\n    expect(Orders.count).to eq(before_count + 1)\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11573, "user_id": 473792, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/bwv8P.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/473792/kevin"}, "edited": false, "score": 0, "creation_date": 1568752297, "post_id": 57981468, "comment_id": 102372446, "body": "I&#39;ve considered doing this. The problem I have with it is, I want to be able to just hand the script to our sys ops team and let them run the script with <code>rails runner my-script.rb</code>. It seems to me that putting all the logic in a class would make it harder to hand the script to my coworkers without some convoluted instructions for running it."}, {"owner": {"reputation": 11, "user_id": 2101065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb6d4103b752af3af9eef83b8c53584?s=128&d=identicon&r=PG", "display_name": "sah", "link": "https://stackoverflow.com/users/2101065/sah"}, "reply_to_user": {"reputation": 11573, "user_id": 473792, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/bwv8P.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/473792/kevin"}, "edited": false, "score": 1, "creation_date": 1569417503, "post_id": 57981468, "comment_id": 102590518, "body": "If you are using <code>rails runner</code> you can do: <code>rails runner &quot;SomeClass.run&quot;</code>"}], "tags": [], "owner": {"reputation": 11, "user_id": 2101065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb6d4103b752af3af9eef83b8c53584?s=128&d=identicon&r=PG", "display_name": "sah", "link": "https://stackoverflow.com/users/2101065/sah"}, "is_accepted": false, "score": 1, "last_activity_date": 1569417384, "last_edit_date": 1569417384, "creation_date": 1568751280, "answer_id": 57981468, "question_id": 57980843, "link": "https://stackoverflow.com/questions/57980843/how-do-i-test-a-script-using-rspec/57981468#57981468", "title": "How do I test a script using RSpec?", "body": "<p>I would move the logic from the script into its own class.  Then you can invoke the class in your script and in your tests or even when you're in the rails console.  I've been using this pattern for a while and its pretty useful.</p>\n"}, {"tags": [], "owner": {"reputation": 11573, "user_id": 473792, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/bwv8P.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/473792/kevin"}, "is_accepted": true, "score": 0, "last_activity_date": 1568752133, "creation_date": 1568752133, "answer_id": 57981642, "question_id": 57980843, "link": "https://stackoverflow.com/questions/57980843/how-do-i-test-a-script-using-rspec/57981642#57981642", "title": "How do I test a script using RSpec?", "body": "<p>It looks like I can use <a href=\"https://ruby-doc.org/core-2.0.0/Kernel.html#method-i-load\" rel=\"nofollow noreferrer\"><code>Kernel#load</code></a> to execute the script:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>describe \"my script\" do\n  it \"should create the correct record\" do\n    before_count = Orders.count\n\n    load(Rails.root.join(\"path\", \"to\", \"my-script.rb\")\n\n    expect(Orders.count).to eq(before_count + 1)\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11573, "user_id": 473792, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/bwv8P.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/473792/kevin"}, "edited": false, "score": 0, "creation_date": 1568930303, "post_id": 57983420, "comment_id": 102442165, "body": "I don&#39;t think a migration is appropriate for this. I&#39;m making one-time changes to the records in the database, not to the database schema. And the nature of the changes makes them both irreversible and something we wouldn&#39;t want to do again if we stand up a new database."}, {"owner": {"reputation": 527, "user_id": 8197386, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3PsfAC8lxvE/AAAAAAAAAAI/AAAAAAAAAJU/9gierdn8mII/photo.jpg?sz=128", "display_name": "sevensidedmarble", "link": "https://stackoverflow.com/users/8197386/sevensidedmarble"}, "reply_to_user": {"reputation": 11573, "user_id": 473792, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/bwv8P.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/473792/kevin"}, "edited": false, "score": 0, "creation_date": 1569025878, "post_id": 57983420, "comment_id": 102474403, "body": "That is something my team does with migrations all the time. Migrations are key here because they create a log of what&#39;s happened. There&#39;s no logs for random scripts that get run."}], "tags": [], "owner": {"reputation": 527, "user_id": 8197386, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3PsfAC8lxvE/AAAAAAAAAAI/AAAAAAAAAJU/9gierdn8mII/photo.jpg?sz=128", "display_name": "sevensidedmarble", "link": "https://stackoverflow.com/users/8197386/sevensidedmarble"}, "is_accepted": false, "score": 0, "last_activity_date": 1568765571, "creation_date": 1568765571, "answer_id": 57983420, "question_id": 57980843, "link": "https://stackoverflow.com/questions/57980843/how-do-i-test-a-script-using-rspec/57983420#57983420", "title": "How do I test a script using RSpec?", "body": "<p>We can help you with this, but this:</p>\n\n<blockquote>\n  <p>I'm writing a script that will be run using rails runner on production to make some one-time changes to our database. </p>\n</blockquote>\n\n<p>Is what migrations are for. One time changes like this to the db should be done in a migration. This circumvents the need for rspec, as any changes like this should be <em>reversible</em>, as migrations should be.</p>\n"}], "owner": {"reputation": 11573, "user_id": 473792, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/bwv8P.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/473792/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 550, "favorite_count": 0, "accepted_answer_id": 57981642, "answer_count": 4, "score": 1, "last_activity_date": 1569417384, "creation_date": 1568748448, "question_id": 57980843, "link": "https://stackoverflow.com/questions/57980843/how-do-i-test-a-script-using-rspec", "title": "How do I test a script using RSpec?", "body": "<p>I'm writing a script that will be run using <code>rails runner</code> on production to make some one-time changes to our database. I want to be sure that the script works as expected before we run it, so I'm writing RSpec tests to verify its behavior while I write it.</p>\n\n<p>How can I invoke the script in my test examples? The script isn't a class or a module, so there aren't individual functions for me to test. Instead, the entire script will be loaded once, run from top to bottom, and then exited. I'm not sure how to invoke that from within an RSpec test.</p>\n\n<p>I'm looking for something like:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>describe \"my script\" do\n  it \"should create the correct record\" do\n    before_count = Orders.count\n\n    rails runner my_script.rb # What goes here?\n\n    expect(Orders.count).to eq(before_count + 1)\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "activerecord-import"], "answers": [{"comments": [{"owner": {"reputation": 1824, "user_id": 935394, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/452f4ef4bec908313c9df902632ab7bb?s=128&d=identicon&r=PG", "display_name": "Max Rose-Collins", "link": "https://stackoverflow.com/users/935394/max-rose-collins"}, "edited": false, "score": 0, "creation_date": 1568799216, "post_id": 57981750, "comment_id": 102386570, "body": "So what do I need to do to fix it?"}], "tags": [], "owner": {"reputation": 61, "user_id": 2709745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4f3bc26d43aed9902dc4a97de38c3c3?s=128&d=identicon&r=PG", "display_name": "Winescout", "link": "https://stackoverflow.com/users/2709745/winescout"}, "is_accepted": false, "score": 1, "last_activity_date": 1568752691, "creation_date": 1568752691, "answer_id": 57981750, "question_id": 57980665, "link": "https://stackoverflow.com/questions/57980665/ruby-on-rails-creating-a-many-to-many-association-after-an-activerecord-import/57981750#57981750", "title": "Ruby on Rails, creating a many to many association after an activerecord-import", "body": "<p>You are calling 'find_or_initialize_by' in your words loop, and then importing those records, which creates a new row in your Keyword table for all the new records.  </p>\n\n<p>So far, so good.</p>\n\n<p>Then your script takes the first list (persisted and new records) and attempts to associate them to the user.  At this point, it creates associations for existing Keyword records, but tries to create new Keyword records again for the ones that it just created in the import and associate those.  These probably fail a unique validation at that point, and are not associated nor persisted. </p>\n\n<p>That leaves you with just the unassociated but newly created records.</p>\n"}], "owner": {"reputation": 1824, "user_id": 935394, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/452f4ef4bec908313c9df902632ab7bb?s=128&d=identicon&r=PG", "display_name": "Max Rose-Collins", "link": "https://stackoverflow.com/users/935394/max-rose-collins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1568752691, "creation_date": 1568747565, "last_edit_date": 1568747981, "question_id": 57980665, "link": "https://stackoverflow.com/questions/57980665/ruby-on-rails-creating-a-many-to-many-association-after-an-activerecord-import", "title": "Ruby on Rails, creating a many to many association after an activerecord-import", "body": "<p>I am creating a few records programmatically based on a users input and creating an array of records to import.</p>\n\n<p>When I check the database I can see the relationship has been created if they are <strong>new records</strong>.</p>\n\n<p>If one of the records already exists in the database I can see an entry of the following in the association table but I can also see the new records have been created in their respective table so they exist but the records ID is not being updated in the association table.</p>\n\n<pre><code>user_id: 1\nkeyword_id: null\n</code></pre>\n\n<p>but if I run the code for a second time it will add the relationship correctly.</p>\n\n<p>This is my code</p>\n\n<pre><code>records_to_add = []\n\nwords.each do |word|\n  keyword = Keyword.find_or_initialize_by(\n    word:             word,\n    device:           device,\n  )\n  records_to_add.push(keyword)\nend\n\nkeywords_added = Keyword.import records_to_add, on_duplicate_key_ignore: true, validate: true\n\nuser.keywords &lt;&lt; records_to_add\n</code></pre>\n\n<p>I think there is something wrong with this part of the code</p>\n\n<pre><code>user.keywords &lt;&lt; records_to_add\n</code></pre>\n\n<p>It isn't creating the relationship correctly if one of the records already exists...</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "methods"], "answers": [{"tags": [], "owner": {"reputation": 606, "user_id": 814835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2061a279cf6cd10bf0f2c1c4c9831ec2?s=128&d=identicon&r=PG", "display_name": "mellowfish", "link": "https://stackoverflow.com/users/814835/mellowfish"}, "is_accepted": false, "score": 0, "last_activity_date": 1568747537, "creation_date": 1568747537, "answer_id": 57980658, "question_id": 57980565, "link": "https://stackoverflow.com/questions/57980565/are-ruby-methods-ending-on-allowed-to-change-stuff/57980658#57980658", "title": "Are ruby methods ending on &#39;?&#39; allowed to change stuff?", "body": "<p>? methods (aka \"predicate\" methods) are an example of a \"query\" method, which should only return a value, with no side effects.</p>\n\n<p><code>before_action</code> style methods are what are called \"command\" methods, which have side-effects and don't return a meaningful result beyond an occasional status/error flag.</p>\n\n<p>So the answer here is no, don't redirect from a ? method.</p>\n"}, {"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1568749362, "post_id": 57980664, "comment_id": 102371269, "body": "Specifically where &quot;should&quot; means &quot;please behave this way&quot; not &quot;you can&#39;t&quot;."}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 8, "last_activity_date": 1568747929, "last_edit_date": 1568747929, "creation_date": 1568747563, "answer_id": 57980664, "question_id": 57980565, "link": "https://stackoverflow.com/questions/57980565/are-ruby-methods-ending-on-allowed-to-change-stuff/57980664#57980664", "title": "Are ruby methods ending on &#39;?&#39; allowed to change stuff?", "body": "<p>A predicate method with side-effects violates the <em>Principle of Least Astonishment</em> IMO. It <em>may</em> have \"internal\" side-effects, e.g. memoize some internal value, but it should be \"externally\" pure / referentially transparent.</p>\n\n<p>If you subscribe to <a href=\"https://martinfowler.com/bliki/CommandQuerySeparation.html\" rel=\"noreferrer\">Bertrand Meyer's <em>Command-Query Separation Principle</em></a>, then predicate methods are <em>Queries</em> (which should not have side-effects). <code>redirect_to</code> is a <em>Command</em> (which has only side-effects and no return value). The two should not mix.</p>\n"}], "owner": {"reputation": 308, "user_id": 10788397, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HNfj9QFa5pU/AAAAAAAAAAI/AAAAAAAAKOA/q7PRzgV2OdM/photo.jpg?sz=128", "display_name": "dom", "link": "https://stackoverflow.com/users/10788397/dom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 57980664, "answer_count": 2, "score": 0, "last_activity_date": 1568748105, "creation_date": 1568747099, "question_id": 57980565, "link": "https://stackoverflow.com/questions/57980565/are-ruby-methods-ending-on-allowed-to-change-stuff", "title": "Are ruby methods ending on &#39;?&#39; allowed to change stuff?", "body": "<p>I was going through some code in one of our RoR apps in our company. And I noticed, that sometimes, there is used method with question mark, such like following method used in one of our controllers.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>  # readonly checker\n  # @param url to redirect or nil\n  # if url set up, goes to url with note \"not allowed because readonly\"\n  # else @returns true / false\n  def readonly?(url = nil)\n    if current_user_can_access?(:readonly)\n\n      message = I18n.t(:auth_readonly)\n      if request.xhr?\n        response.status = 403\n        render json: { error: message }\n      else\n        redirect_to url, notice: message unless url.nil?\n      end\n      true\n    else\n      false\n    end\n  end\n</code></pre>\n\n<p>My question is, whether it is acceptable (and usual), that <code>readonly?</code> also redirects somewhere.</p>\n\n<p>I am used to implementing question mark methods, that only return values convertable to boolean and do not make changes in models, DB...</p>\n"}, {"tags": ["ruby", "cucumber", "rakefile", "test-reporting"], "answers": [{"tags": [], "owner": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "is_accepted": true, "score": 0, "last_activity_date": 1568776652, "creation_date": 1568776652, "answer_id": 57984575, "question_id": 57979594, "link": "https://stackoverflow.com/questions/57979594/cucumber-test-report-from-rakefile/57984575#57984575", "title": "Cucumber test report from Rakefile", "body": "<p>You can create <code>profile</code> in the <code>cucumber.yml</code> file and pass the arguments under profile as shown below.</p>\n\n<pre><code>default:\n  --no-source --no-color\n  --format progress --format html --out=features_report.html\n</code></pre>\n\n<p>Now run your rake task as is, cucumber will pick the arguments from <code>cucumber.yml</code> file and generates the report.</p>\n"}], "owner": {"reputation": 69, "user_id": 6029849, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/qTPSR.jpg?s=128&g=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/6029849/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 57984575, "answer_count": 1, "score": 0, "last_activity_date": 1568776652, "creation_date": 1568742630, "last_edit_date": 1568776494, "question_id": 57979594, "link": "https://stackoverflow.com/questions/57979594/cucumber-test-report-from-rakefile", "title": "Cucumber test report from Rakefile", "body": "<p>I have a set of Ruby/Cucumber tests. All tests run successfully when run in an IDE.</p>\n\n<p>When I execute tests using this CLI command, the tests run and a test report is generated.</p>\n\n<p><code>$ cucumber --format progress --format html --out=features_report.html -r features --tags '@this or @that' features</code></p>\n\n<p>I need to execute the tests from a Rakefile in order to run tests in parallel. I can run them calling the Rakefile below with <code>rake local</code></p>\n\n<pre><code>\ndesc 'Run the functional test suite locally'\n  task :local do\n\ntest_args = [\"-n\", '1', \n             \"-o\" \"-t '@this or @that'\",\n             \"--type\", \n             \"cucumber\", \n             '--',\n             '-f',\n             'progress', \n             '--',\n             'features',]\n\n    ParallelTests::CLI.new.run(test_args)\n  end\n</code></pre>\n\n<p>But I can't figure out where the extra options/arguments that generate a test report go.</p>\n\n<p>If I group the report bits in the Rakefile as they are in the working CLI command</p>\n\n<pre><code>             'progress',\n              '-f',\n              'HTML', \n             '--out',\n             'first.html',\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>Error creating formatter: HTML (LoadError)\n</code></pre>\n\n<p>Or, if I do this <code>\"-o\" \"-t '@this or @that' --out first.html --format HTML\",</code></p>\n\n<p>I get this:</p>\n\n<pre><code>All but one formatter must use --out, only one can print to each stream (or STDOUT) (RuntimeError)\n</code></pre>\n\n<p>Where in the test_args do the arguments that generate a test report go and what do they look like?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 465, "user_id": 2777590, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/69266f0c355cbbcc747ecfa32fb6ca80?s=128&d=identicon&r=PG&f=1", "display_name": "Dexirian", "link": "https://stackoverflow.com/users/2777590/dexirian"}, "is_accepted": false, "score": 0, "last_activity_date": 1568742762, "creation_date": 1568742762, "answer_id": 57979625, "question_id": 57979586, "link": "https://stackoverflow.com/questions/57979586/ruby-parameter-expansion-like-in-bash/57979625#57979625", "title": "ruby parameter expansion like in bash", "body": "<p>You can do nice one-liners in ruby, variable = condition ? true : false</p>\n\n<pre><code>ssl_opts = ssl_verify.nil? ? true : ssl_verify\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1568785972, "post_id": 57980030, "comment_id": 102379931, "body": "With the first two, it&#39;s impossible to set the value to <code>false</code> in the yaml. <code>false || true</code> will always be true."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "reply_to_user": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1568795399, "post_id": 57980030, "comment_id": 102384286, "body": "@KimmoLehto Good catch. And worth noting."}], "tags": [], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "is_accepted": false, "score": 0, "last_activity_date": 1568744672, "creation_date": 1568744672, "answer_id": 57980030, "question_id": 57979586, "link": "https://stackoverflow.com/questions/57979586/ruby-parameter-expansion-like-in-bash/57980030#57980030", "title": "ruby parameter expansion like in bash", "body": "<p>Assuming the yaml is parsed and is a Ruby hash, there are a few ways:</p>\n\n<pre><code>verify = yaml[:ssl_opts][:verify] || true\n</code></pre>\n\n<p>You can access the hash keys as such. The <code>||</code> will return the value to the right if the expression to the left evaluates to <code>nil</code>. If the <code>ssl_opts</code> key was missing this would raise an error.</p>\n\n<pre><code>verify = yaml.dig(:ssl_options, :verify) || true\n</code></pre>\n\n<p><code>#dig</code> takes any number of keys and returns the value or <code>nil</code> if any of the keys are missing. If the <code>ssl_options</code> key was missing this would not raise an error.</p>\n\n<pre><code>verify = yaml.fetch(:ssl_opts).fetch(:verify, true)\n</code></pre>\n\n<p><code>#fetch</code> will raise if the key does not exist, the optional second argument is a default if the key does not exist.</p>\n"}, {"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 0, "last_activity_date": 1568744729, "creation_date": 1568744729, "answer_id": 57980044, "question_id": 57979586, "link": "https://stackoverflow.com/questions/57979586/ruby-parameter-expansion-like-in-bash/57980044#57980044", "title": "ruby parameter expansion like in bash", "body": "<p>Doing it with a single-layer structure is pretty easy:</p>\n\n<pre><code>DEFAULTS = {\n  ssl_opts_verify: true\n}\n\noptions = DEFAULTS.merge(settings)\n</code></pre>\n\n<p>Where you can just use <code>merge</code> to build on the defaults. For a multi-layer structure you need a <code>deep_merge</code> type tool.</p>\n"}], "owner": {"reputation": 41, "user_id": 8619046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8924e87204ec6740e00ace7f51f2d6c0?s=128&d=identicon&r=PG&f=1", "display_name": "Bernd Broermann", "link": "https://stackoverflow.com/users/8619046/bernd-broermann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1568744729, "creation_date": 1568742602, "question_id": 57979586, "link": "https://stackoverflow.com/questions/57979586/ruby-parameter-expansion-like-in-bash", "title": "ruby parameter expansion like in bash", "body": "<p>i am am bashist  an i to set a default value if var is not set</p>\n\n<p>ruby code , settings are read from a yaml file</p>\n\n<pre><code>:username =&gt; settings[:username],\n:password =&gt; settings[:password],\n:host =&gt; settings[:dns_server],\n:ssl_opts =&gt; {:verify =&gt; true }\n</code></pre>\n\n<p>I want to implement a yaml entry somthing like <code>ssl_verify:</code> , so that if not set , <code>true</code> is the default .</p>\n\n<p>This would look like, </p>\n\n<p>in bash that would look like</p>\n\n<pre><code>ssl_opts=${ssl_verify:-true}\n</code></pre>\n\n<p>how to do this in ruby?\nThanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nokogiri"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1568745824, "post_id": 57978561, "comment_id": 102369841, "body": "That shouldn&#39;t strip inline CSS, but you&#39;re saying it does. Can you expand on this example?"}], "answers": [{"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1571378237, "post_id": 57978666, "comment_id": 103228112, "body": "Rather than toss out a link please explain how it works. Educate, don&#39;t just hand out code."}, {"owner": {"reputation": 141, "user_id": 10043524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e81c8d061b996ff7555a797692ce7d7?s=128&d=identicon&r=PG&f=1", "display_name": "leafeve", "link": "https://stackoverflow.com/users/10043524/leafeve"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1571383467, "post_id": 57978666, "comment_id": 103230166, "body": "in rails dock explain detail how to use and config to his project. if you want some code i will show you in my update"}], "tags": [], "owner": {"reputation": 141, "user_id": 10043524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e81c8d061b996ff7555a797692ce7d7?s=128&d=identicon&r=PG&f=1", "display_name": "leafeve", "link": "https://stackoverflow.com/users/10043524/leafeve"}, "is_accepted": false, "score": 0, "last_activity_date": 1571607327, "last_edit_date": 1571607327, "creation_date": 1568738703, "answer_id": 57978666, "question_id": 57978561, "link": "https://stackoverflow.com/questions/57978561/how-to-strip-internal-css-tags-but-not-inline-css-tags-in-incoming-email/57978666#57978666", "title": "How to strip internal CSS tags but not inline css tags in incoming email", "body": "<p>Try using <a href=\"https://apidock.com/rails/ActionView/Helpers/SanitizeHelper/sanitize\" rel=\"nofollow noreferrer\">SanitizeHelper</a>. You can custom remove tags or style as your expect.</p>\n\n<p>Example tested in the Rails console:</p>\n\n<pre><code>html = \"&lt;p id=\"text_header\" style=\"display:none;\"&gt;asdasd&lt;/p&gt;\"\nActionController::Base.helpers.sanitize(html, attributes: %w(id))\n</code></pre>\n\n<p>It will return:</p>\n\n<pre><code>=&gt; \"&lt;p id=\\\"text_header\\\"&gt;asdasd&lt;/p&gt;\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1571378353, "post_id": 58001464, "comment_id": 103228150, "body": "It&#39;s difficult to understand what you&#39;re trying to explain. Please reread it and, if necessary, ask for help with the language."}], "tags": [], "owner": {"reputation": 151, "user_id": 7826153, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/TYORr.jpg?s=128&g=1", "display_name": "Hassam Ali", "link": "https://stackoverflow.com/users/7826153/hassam-ali"}, "is_accepted": false, "score": -1, "last_activity_date": 1568845499, "creation_date": 1568845499, "answer_id": 58001464, "question_id": 57978561, "link": "https://stackoverflow.com/questions/57978561/how-to-strip-internal-css-tags-but-not-inline-css-tags-in-incoming-email/58001464#58001464", "title": "How to strip internal CSS tags but not inline css tags in incoming email", "body": "<p>adding whitelist attributes will allow the style tags with attributes but will remove the tags of style from file which can be responsible for xss/xsstc. Adding src and alt because this class and style also removing the img tag which i dont want to remove so if you add src alt attributes in this white list it will allow the img attributes also.</p>\n\n<pre><code>sanitize(parsed_html.to_s, attributes: %w(src alt class style)\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 7826153, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/TYORr.jpg?s=128&g=1", "display_name": "Hassam Ali", "link": "https://stackoverflow.com/users/7826153/hassam-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1571607327, "creation_date": 1568738231, "last_edit_date": 1568745767, "question_id": 57978561, "link": "https://stackoverflow.com/questions/57978561/how-to-strip-internal-css-tags-but-not-inline-css-tags-in-incoming-email", "title": "How to strip internal CSS tags but not inline css tags in incoming email", "body": "<p>I want to parse the incoming emails but at the time of sanitize i want to remove the internal styling, but i want to keep the inline styling also. with the nokogiri it removes the style tags from all file .</p>\n\n<pre><code>parsed_html = Nokogiri::HTML(raw_html)\nparsed_html.css('style').remove\n</code></pre>\n\n<p>I expect to remove the extra internal style tags and content inside but not to remove the inline styling</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "refactoring"], "comments": [{"owner": {"reputation": 1091, "user_id": 1893290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd02a775db447cf44762ecb35687b9e1?s=128&d=identicon&r=PG", "display_name": "Jacob Evan Shreve", "link": "https://stackoverflow.com/users/1893290/jacob-evan-shreve"}, "edited": false, "score": 3, "creation_date": 1568739041, "post_id": 57977820, "comment_id": 102366969, "body": "Could you get by with calling resource.reload to re-fetch the attributes from the database?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 1091, "user_id": 1893290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd02a775db447cf44762ecb35687b9e1?s=128&d=identicon&r=PG", "display_name": "Jacob Evan Shreve", "link": "https://stackoverflow.com/users/1893290/jacob-evan-shreve"}, "edited": false, "score": 0, "creation_date": 1568742676, "post_id": 57977820, "comment_id": 102368521, "body": "@JacobEvanShreve is that actually any different, or just slightly more idiomatic?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1568744599, "post_id": 57977820, "comment_id": 102369293, "body": "If <code>call_external</code> could keep that record in sync you wouldn&#39;t need to reload."}, {"owner": {"reputation": 1100, "user_id": 1584736, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7b8c4392528b20b47726142f7a20c7cd?s=128&d=identicon&r=PG", "display_name": "ngw", "link": "https://stackoverflow.com/users/1584736/ngw"}, "edited": false, "score": 0, "creation_date": 1568744650, "post_id": 57977820, "comment_id": 102369319, "body": "It updates several records"}, {"owner": {"reputation": 1091, "user_id": 1893290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd02a775db447cf44762ecb35687b9e1?s=128&d=identicon&r=PG", "display_name": "Jacob Evan Shreve", "link": "https://stackoverflow.com/users/1893290/jacob-evan-shreve"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1568755981, "post_id": 57977820, "comment_id": 102373745, "body": "@maxpleaner It depends on how the first find works. When reload is called, it has the id so it can do a <code>where id = $id</code> lookup. If the first find does the same thing, then they are effectively the same and will run the same SQL."}, {"owner": {"reputation": 1616, "user_id": 2020801, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9981dde909678f98fb25eed05cc9f23f?s=128&d=identicon&r=PG", "display_name": "Erik Madsen", "link": "https://stackoverflow.com/users/2020801/erik-madsen"}, "edited": false, "score": 0, "creation_date": 1568802443, "post_id": 57977820, "comment_id": 102388374, "body": "As an aside, if <code>call_external</code> is slow you should consider re-architecting this action towards a more async flow where you would return an empty-ish answer from the get, while triggering an async job for the external call. After this, the frontend could poll or the backend could signal the frontend when it&#39;s time to do a refresh of the data."}], "answers": [{"tags": [], "owner": {"reputation": 476, "user_id": 2645167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEnRe.jpg?s=128&g=1", "display_name": "andriy-baran", "link": "https://stackoverflow.com/users/2645167/andriy-baran"}, "is_accepted": false, "score": 0, "last_activity_date": 1568817682, "creation_date": 1568817682, "answer_id": 57995429, "question_id": 57977820, "link": "https://stackoverflow.com/questions/57977820/idiomatic-way-to-update-a-record-before-serving-it/57995429#57995429", "title": "Idiomatic way to update a record before serving it", "body": "<p>You can use <code>reload</code> method to update AR object </p>\n\n<pre><code>def show\n  resource = find_resource\n  call_external(resource: resource)\n  resource.reload\n  render\nend\n</code></pre>\n"}], "owner": {"reputation": 1100, "user_id": 1584736, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7b8c4392528b20b47726142f7a20c7cd?s=128&d=identicon&r=PG", "display_name": "ngw", "link": "https://stackoverflow.com/users/1584736/ngw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1568817682, "creation_date": 1568735209, "question_id": 57977820, "link": "https://stackoverflow.com/questions/57977820/idiomatic-way-to-update-a-record-before-serving-it", "title": "Idiomatic way to update a record before serving it", "body": "<p>I'm working on a RoR application that, when answering on a GET /resource needs to attempt an update of all the resources, taking the data from an external service.\nTo make things more clear, the pseudocode is:</p>\n\n<pre><code>def show\n  resource = find_resource\n  call_external(resource: resource)\n  resource = find_resource\n  render\nend\n</code></pre>\n\n<p>Now, this would work, but I really really dislike the double find. It's definitely legit as the tech spec is literally to get the resource, use it's attributes to define a from to range of resources to update (which might contain the current one) and get the resource again, still, quite ugly.</p>\n\n<p>Any suggestion on how to refactor this? Thanks a lot</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "dictionary"], "comments": [{"owner": {"reputation": 465, "user_id": 2777590, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/69266f0c355cbbcc747ecfa32fb6ca80?s=128&d=identicon&r=PG&f=1", "display_name": "Dexirian", "link": "https://stackoverflow.com/users/2777590/dexirian"}, "edited": false, "score": 0, "creation_date": 1568733965, "post_id": 57977415, "comment_id": 102364585, "body": "Could you provide an example of your code? In your code, if you add a line with &quot;puts $yourvariable.class&quot; what is the output? Is it an array?"}, {"owner": {"reputation": 6165, "user_id": 2697183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65255fe741b95ba0c641d96ea6750ea9?s=128&d=identicon&r=PG&f=1", "display_name": "AbM", "link": "https://stackoverflow.com/users/2697183/abm"}, "edited": false, "score": 2, "creation_date": 1568734011, "post_id": 57977415, "comment_id": 102364609, "body": "Use <code>map!</code> instead of <code>map</code> to mutate <code>zones</code>"}, {"owner": {"reputation": 80, "user_id": 6144487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/390226db4ae5e5d006c8c5c3eeb49f84?s=128&d=identicon&r=PG", "display_name": "TeeSeal", "link": "https://stackoverflow.com/users/6144487/teeseal"}, "edited": false, "score": 0, "creation_date": 1568734062, "post_id": 57977415, "comment_id": 102364639, "body": "I doubt it&#39;s the same code you have. Can you show the full context where you use it? Please keep in mind that <code>.map</code> does not mutate the original array, it returns a copy if it and keeps the original intact. If you intend to mutate an array, take a look <a href=\"https://ruby-doc.org/core-2.5.0/Array.html#method-i-map-21\" rel=\"nofollow noreferrer\">Array#map!</a>."}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "reply_to_user": {"reputation": 6165, "user_id": 2697183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65255fe741b95ba0c641d96ea6750ea9?s=128&d=identicon&r=PG&f=1", "display_name": "AbM", "link": "https://stackoverflow.com/users/2697183/abm"}, "edited": false, "score": 0, "creation_date": 1568734294, "post_id": 57977415, "comment_id": 102364761, "body": "@AbM The problem is not that he can&#39;t mutate his array, map should returns his array with the <code>}</code> concatenated without having to mutate the original. Actually @JuanMartinez I can&#39;t see why your code is not working. Do you use it in a specific context?"}, {"owner": {"reputation": 21, "user_id": 4899775, "user_type": "registered", "profile_image": "https://graph.facebook.com/891503697574711/picture?type=large", "display_name": "JuanMartinez", "link": "https://stackoverflow.com/users/4899775/juanmartinez"}, "edited": false, "score": 0, "creation_date": 1568734463, "post_id": 57977415, "comment_id": 102364846, "body": "Okay i knew i was doing something wrong. First, i was calling in my code another variable wich had [&quot;1&quot;, &quot;2&quot;, &quot;3&quot;] in it, so even if i was changing something, i was printing other one. Second, i didnt know about map! lol  i thought map had the same behaviour. Its all fixed thank you very much. edit: i cant see the way to upvote an answer or to mark one as the correct answer."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1568737355, "post_id": 57977899, "comment_id": 102366224, "body": "<code>map</code> does not mutate the array, but one still can mutate elements. For example, with <code>z &lt;&lt; &#39;}&#39;</code>. In this case there&#39;s no point in using <code>map</code>, of course. Can do with <code>.each</code>."}], "tags": [], "owner": {"reputation": 465, "user_id": 2777590, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/69266f0c355cbbcc747ecfa32fb6ca80?s=128&d=identicon&r=PG&f=1", "display_name": "Dexirian", "link": "https://stackoverflow.com/users/2777590/dexirian"}, "is_accepted": false, "score": 0, "last_activity_date": 1568735474, "creation_date": 1568735474, "answer_id": 57977899, "question_id": 57977415, "link": "https://stackoverflow.com/questions/57977415/map-on-array-doesnt-work-ruby-on-rails/57977899#57977899", "title": ".map on array doesnt work (Ruby on rails)", "body": "<p>As explained in the comments above, .map does not change the input variable, it simply shows what the result would be.</p>\n\n<p>The correct option was .map!</p>\n"}], "owner": {"reputation": 21, "user_id": 4899775, "user_type": "registered", "profile_image": "https://graph.facebook.com/891503697574711/picture?type=large", "display_name": "JuanMartinez", "link": "https://stackoverflow.com/users/4899775/juanmartinez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1568735474, "creation_date": 1568733647, "question_id": 57977415, "link": "https://stackoverflow.com/questions/57977415/map-on-array-doesnt-work-ruby-on-rails", "title": ".map on array doesnt work (Ruby on rails)", "body": "<p>I'm sure that this is an stupid question, but i cant find the answer. So, i have an array in which i want to add \"}\" to every element, so i'm using map. </p>\n\n<pre><code>zones.map {\n      |z| z += '}'\n    }\n</code></pre>\n\n<p>But it doesnt work. When i return the zones variable, nothign has changed. So, i was testing with simple arrays, and i find that in the irb this works, but not in the program?</p>\n\n<p>So in the irb i did:</p>\n\n<pre><code>[\"1\", \"2\", \"3\"].map { |z| z += \"}\" }\n =&gt; [\"1}\", \"2}\", \"3}\"] \n</code></pre>\n\n<p>Then the same in my code, and it doesnt work, when its the same:</p>\n\n<pre><code>[\"1\", \"2\", \"3\"].map {\n      |num| num+= \"}\"\n    }\n</code></pre>\n\n<p>This returns </p>\n\n<pre><code>[\"1\", \"2\", \"3\"]\n</code></pre>\n\n<p>How can the same code work on irb but not on my code? i really dont understand anything of this, its the same code. Apart from that it seems like .map is not working with anything in my code.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "selenium", "capybara", "windows-subsystem-for-linux"], "comments": [{"owner": {"reputation": 14662, "user_id": 3092298, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/70530902b2446a5eccb717b2d21506fb?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Burghardt", "link": "https://stackoverflow.com/users/3092298/greg-burghardt"}, "edited": false, "score": 0, "creation_date": 1568741067, "post_id": 57977161, "comment_id": 102367806, "body": "How are you initializing the web driver? Does this happen every time the web driver is initialized or intermittently?"}, {"owner": {"reputation": 11, "user_id": 12080321, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD4FNvR9JW-KVGEtvIAeIxbAFCXNLJLn9rCYBMASg=k-s128", "display_name": "Caio Felipe", "link": "https://stackoverflow.com/users/12080321/caio-felipe"}, "reply_to_user": {"reputation": 14662, "user_id": 3092298, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/70530902b2446a5eccb717b2d21506fb?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Burghardt", "link": "https://stackoverflow.com/users/3092298/greg-burghardt"}, "edited": false, "score": 0, "creation_date": 1568808588, "post_id": 57977161, "comment_id": 102391771, "body": "This happen every time, i run the tests, and when it reachs the views tests with capybara, this happens!  I put my capybara.rb above, but my problem is basic make works tests in capybara using chromedriver in WSL"}, {"owner": {"reputation": 14662, "user_id": 3092298, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/70530902b2446a5eccb717b2d21506fb?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Burghardt", "link": "https://stackoverflow.com/users/3092298/greg-burghardt"}, "edited": false, "score": 0, "creation_date": 1568811071, "post_id": 57977161, "comment_id": 102393177, "body": "Can you post the code for one of the tests that is failing?"}, {"owner": {"reputation": 11, "user_id": 12080321, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD4FNvR9JW-KVGEtvIAeIxbAFCXNLJLn9rCYBMASg=k-s128", "display_name": "Caio Felipe", "link": "https://stackoverflow.com/users/12080321/caio-felipe"}, "reply_to_user": {"reputation": 14662, "user_id": 3092298, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/70530902b2446a5eccb717b2d21506fb?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Burghardt", "link": "https://stackoverflow.com/users/3092298/greg-burghardt"}, "edited": false, "score": 0, "creation_date": 1568827636, "post_id": 57977161, "comment_id": 102402119, "body": "@GregBurghardt This error just happen in view tests, I find out in other forums this happens because the WSL try to use in background chrome but wsl dont have a &quot;display&quot; and this make all view tests fail with that error:  Selenium::WebDriver::Error::WebDriverError:               chrome not reachable                 (Session info: headless chrome=77.0.3865.75)  The tests are okay using linux environment, but in WSL2 dont work, and a cant fix this problem with chromedriver within WSL2"}], "answers": [{"tags": [], "owner": {"reputation": 4471, "user_id": 1627358, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2Eifd.jpg?s=128&g=1", "display_name": "Hussam Kurd", "link": "https://stackoverflow.com/users/1627358/hussam-kurd"}, "is_accepted": false, "score": 0, "last_activity_date": 1573990563, "creation_date": 1573990563, "answer_id": 58900040, "question_id": 57977161, "link": "https://stackoverflow.com/questions/57977161/how-to-fix-seleniumwebdrivererrorwebdrivererror-chrome-not-reachable-in/58900040#58900040", "title": "How to fix &quot;Selenium::WebDriver::Error::WebDriverError: chrome not reachable&quot; in WSL2", "body": "<p>I just fix it with the following code   </p>\n\n<pre><code> Capybara.register_driver :chrome do |app|\n        options = Selenium::WebDriver::Chrome::Options.new(args: %w[\n          headless no-sandbox disable-gpu window-size=1920x1080\n        ])\n          Capybara::Selenium::Driver.new(app,\n            browser: :chrome,\n            desired_capabilities: {\n              \"chromeOptions\" =&gt; {\n                w3c: false\n              }\n            }\n          )\n      end\n</code></pre>\n\n<p>Please let me know if this is resolve your issue </p>\n"}], "owner": {"reputation": 11, "user_id": 12080321, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD4FNvR9JW-KVGEtvIAeIxbAFCXNLJLn9rCYBMASg=k-s128", "display_name": "Caio Felipe", "link": "https://stackoverflow.com/users/12080321/caio-felipe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1004, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1573990563, "creation_date": 1568732674, "last_edit_date": 1568808814, "question_id": 57977161, "link": "https://stackoverflow.com/questions/57977161/how-to-fix-seleniumwebdrivererrorwebdrivererror-chrome-not-reachable-in", "title": "How to fix &quot;Selenium::WebDriver::Error::WebDriverError: chrome not reachable&quot; in WSL2", "body": "<p>I am trying to use WSL2 to rails application and had this error when RSpec is running:</p>\n\n<pre><code>Selenium::WebDriver::Error::WebDriverError:\n              chrome not reachable\n                (Session info: headless chrome=77.0.3865.75)\n</code></pre>\n\n<p>Someone know to fix it?</p>\n\n<p>My capybara.rb:</p>\n\n<pre><code>require \"capybara/rails\"\nrequire \"selenium-webdriver\"\n\nCapybara.default_max_wait_time = 10\nCapybara.register_driver :chrome do |app|\n  options = Selenium::WebDriver::Chrome::Options.new(\n    args: %w[headless no-sandbox]\n  )\n  Capybara::Selenium::Driver.new(app, browser: :chrome, options: options)\nend\n\nCapybara.javascript_driver = :chrome\nCapybara.server = :puma, { Silent: true }\n</code></pre>\n\n<p>I put the path in env variables to reach my chromewebdriver binary, following this article \"<a href=\"https://ngauthier.com/2017/09/rails-system-tests-with-headless-chrome-on-windows-bash-wsl.html\" rel=\"nofollow noreferrer\">https://ngauthier.com/2017/09/rails-system-tests-with-headless-chrome-on-windows-bash-wsl.html</a>\" and nothing!</p>\n"}, {"tags": ["ruby", "cuprite"], "answers": [{"tags": [], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "is_accepted": false, "score": 2, "last_activity_date": 1568731860, "creation_date": 1568731860, "answer_id": 57976910, "question_id": 57976909, "link": "https://stackoverflow.com/questions/57976909/how-to-fix-chrome-process-did-not-produce-websocket-url-within-2-seconds-when/57976910#57976910", "title": "How to fix &quot;Chrome process did not produce websocket url within 2 seconds&quot; when running chrome headless in Docker", "body": "<p>The driver needs to be configured to pass the <code>--no-sandbox</code> option to Chrome:</p>\n\n<pre><code>Capybara.register_driver :cuprite do |app|\n  browser_options = {}.tap do |opts|\n    opts['no-sandbox'] = nil if ENV['CI']\n  end\n\n  Capybara::Cuprite::Driver.new(app, browser_options: browser_options)\nend\n</code></pre>\n"}], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 528, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1568731860, "creation_date": 1568731860, "question_id": 57976909, "link": "https://stackoverflow.com/questions/57976909/how-to-fix-chrome-process-did-not-produce-websocket-url-within-2-seconds-when", "title": "How to fix &quot;Chrome process did not produce websocket url within 2 seconds&quot; when running chrome headless in Docker", "body": "<p>I'm using <a href=\"https://github.com/gregoryduckworth/cuprite-base-ruby\" rel=\"nofollow noreferrer\">Cuprite</a> driver for Capybara in my Ruby feature specs. </p>\n\n<p>The specs run fine locally but fail with the error, <code>Chrome process did not produce websocket url within 2 seconds</code>, when the specs are run on our CI server. The CI server runs the specs within a Docker container.</p>\n\n<p>The Docker image installs a recent version of Chrome, 77.0, from the Google PPA.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1568732448, "post_id": 57976795, "comment_id": 102363730, "body": "I don&#39;t think you need <code>CSV.generate_line</code> as this will create a String from an Array. And CSV.open will give you <code>Array&lt;Array&gt;</code>."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1568733171, "post_id": 57976795, "comment_id": 102364152, "body": "What is <code>CsvAdminLogData::CsvAdminLogGenerator</code>? What does the context <code>&#39;with admin_user form&#39;</code> contain? What do the contents of <code>app&#47;custom&#47;file.csv</code> look like? Please, read up on how to construct a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. These might also be of use: <a href=\"http://sscce.org/\" rel=\"nofollow noreferrer\">The SSCCE \u2013 Short, Self Contained, Correct (Compilable), Example</a> and <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>. In order to debug the code, we need to be able to copy&amp;paste&amp;run it. That is not possible with yours."}], "answers": [{"comments": [{"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1568733899, "post_id": 57977212, "comment_id": 102364547, "body": "Now I&#39;ve got an error: <code>NoMethodError:undefined method generate_row&#39; for CSV:Class Did you mean?  generate</code>. I&#39;ve edited my question, maybe my implementation is not good, could you take a look?"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 1, "creation_date": 1568734153, "post_id": 57977212, "comment_id": 102364692, "body": "@mr_muscle I&#39;ve updated the answer. That last code block should use <code>generate_line</code>. Note that this answer offers two solutions to your problem though."}, {"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1568735771, "post_id": 57977212, "comment_id": 102365523, "body": "@3limin4t0r yes unfortunately both are not work, please take a look of my implementation"}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "reply_to_user": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1568743965, "post_id": 57977212, "comment_id": 102369034, "body": "@mr_muscle don&#39;t add comments regarding an answer to your question, add them here. You&#39;ll need to output <code>log_file[1]</code> and see what it actually is and maybe just set a var called <code>row</code> and compare that against you expected output to see why it is failing. Maybe it is correctly failing?"}, {"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1568750266, "post_id": 57977212, "comment_id": 102371660, "body": "I don&#39;t think it will be possible to set a var because this data comes from FactoryBot with Faker. I think the issue is in one character <code>&#47;</code> but I don&#39;t why."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1568795097, "post_id": 57977212, "comment_id": 102384134, "body": "Do <code>puts log_file[1]</code>"}], "tags": [], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "is_accepted": false, "score": 1, "last_activity_date": 1568743701, "last_edit_date": 1568743701, "creation_date": 1568732880, "answer_id": 57977212, "question_id": 57976795, "link": "https://stackoverflow.com/questions/57976795/rails-rspec-csv-generator-error-for-array-of-string-in-response/57977212#57977212", "title": "Rails rspec CSV generator error for array of string in response", "body": "<pre><code>expect(log_file.to_a[1]).to match_array([\n  admin_log1.created_at,\n  admin_log1.action_type,\n  admin_log1.admin_email,\n  admin_log1.old_data,\n  admin_log1.new_data])\n</code></pre>\n\n<p><code>log_file</code> will be something like <code>[['a', 'b', 'b'], [...], ...]</code>.</p>\n\n<p>By using <code>CSV.generate_row</code> you are converting the <code>Array</code> back to a <code>String</code>.</p>\n\n<p>I don't suggest doing this but if you where just reading the file instead of parsing it you could use <code>generate_line</code> to create a String and compare it, as such:</p>\n\n<pre><code> csv = File.read('...')\n   .each_line\n   .drop(1) # remove header row\n\n expect(csv[0]).to eq(CSV.generate_line([1,2,3])\n</code></pre>\n"}], "owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568750847, "creation_date": 1568731513, "last_edit_date": 1568750847, "question_id": 57976795, "link": "https://stackoverflow.com/questions/57976795/rails-rspec-csv-generator-error-for-array-of-string-in-response", "title": "Rails rspec CSV generator error for array of string in response", "body": "<p>I've got specs for my CSV generator</p>\n\n<pre><code>RSpec.describe CsvAdminLogData::CsvAdminLogGenerator do\n  include_context 'with admin_user form'\n  subject(:csv_file) { described_class.new(start_date, end_date).call }\n\n  it 'creates CSV file with proper value' do\n    csv_file\n    log_file = CSV.open('app/custom/file.csv')\n     expect(log_file.to_a[1]).to match_array(\n      CSV.generate_line([\n                          admin_log1.created_at,\n                          admin_log1.action_type,\n                          admin_log1.admin_email,\n                          admin_log1.old_data,\n                          admin_log1.new_data,\n                        ]),\n    )\n  end\n</code></pre>\n\n<p>With error:</p>\n\n<pre><code>   expected collection contained:  [\"2019-06-17 16:39:22 +0200,New,orlandoratke@cruickshankmclaughlin.info,\\\"{\\\"\\\"email\\\"\\\"=&gt;\\\"\\\"courtne...=&gt;\\\"\\\"2019-09-16T16:39:22.880+02:00\\\"\\\", \\\"\\\"other_activities\\\"\\\"=&gt;\\\"\\\"forbidden websites\\\"\\\"}\\\"\\n\"]\n   actual collection contained:    [\"2019-06-17 16:39:22 +0200\", \"New\", \"orlandoratke@cruickshankmclaughlin.info\", \"{\\\"email\\\"=&gt;\\\"courtn... \\\"last_update\\\"=&gt;\\\"2019-09-16T16:39:22.880+02:00\\\", \\\"other_activities\\\"=&gt;\\\"forbidden websites\\\"}\"]\n   the missing elements were:      [\"2019-06-17 16:39:22 +0200,New,orlandoratke@cruickshankmclaughlin.info,\\\"{\\\"\\\"email\\\"\\\"=&gt;\\\"\\\"courtne...=&gt;\\\"\\\"2019-09-16T16:39:22.880+02:00\\\"\\\", \\\"\\\"other_activities\\\"\\\"=&gt;\\\"\\\"forbidden websites\\\"\\\"}\\\"\\n\"]\n   the extra elements were:        [\"2019-06-17 16:39:22 +0200\", \"New\", \"orlandoratke@cruickshankmclaughlin.info\", \"{\\\"email\\\"=&gt;\\\"courtn... \\\"last_update\\\"=&gt;\\\"2019-09-16T16:39:22.880+02:00\\\", \\\"other_activities\\\"=&gt;\\\"forbidden websites\\\"}\"]\n</code></pre>\n\n<p>So as far I see I've got an array of string instead of just an array. I was trying to handle it with something like this:</p>\n\n<pre><code>log_file = CSV.open('app/custom/file.csv').to_a\n    expect([log_file[1].join(',')])\n</code></pre>\n\n<p>But without results. I also tried to add <code>([... admin_log1.new_data,]).first.split(', ')</code> at the end of expected results but I received an error <code>NoMethodError: undefined method split' for Mon, 17 Jun 2019 16:14:56 CEST +02:00:Time</code></p>\n"}, {"tags": ["arrays", "ruby", "string"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1568729481, "post_id": 57976004, "comment_id": 102361961, "body": "What have you tried? Where did you get stuck? Please, provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1568729721, "post_id": 57976004, "comment_id": 102362128, "body": "@J&#246;rgWMittag I&#39;ve tried with <code>split</code> but this is just a sample of solution. I&#39;ve to change array in to the array of string in my specs. With <code>first.split(&#39;, &#39;)</code> it shows me an error <code>NoMethodError:        undefined method split&#39; for Mon, 17 Jun 2019 16:14:56 CEST +02:00:Time</code>"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1568730102, "post_id": 57976004, "comment_id": 102362361, "body": "That error message <i>cannot possibly</i> be generated from the data in the question."}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1568730227, "post_id": 57976004, "comment_id": 102362449, "body": "You have a date/datetime or similar object, not a string."}, {"owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 0, "creation_date": 1568762539, "post_id": 57976004, "comment_id": 102375336, "body": "Yeah, it looks like you aren&#39;t understanding that you aren&#39;t working with a string value to begin with. Perhaps you can avoid providing a &quot;sample of solution&quot; (which clearly isn&#39;t such) and provide a more detailed and accurate explanation of the problem you&#39;re trying to solve."}], "answers": [{"comments": [{"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1568729830, "post_id": 57976065, "comment_id": 102362200, "body": "Is there any other way to do so? I&#39;ve tried it already and it shows me an error in my specs <code>NoMethodError:        undefined method split&#39; for Mon, 17 Jun 2019 16:14:56 CEST +02:00:Time</code>"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 5, "creation_date": 1568730049, "post_id": 57976065, "comment_id": 102362324, "body": "If that is the case, then the example in your question is not representative of your actual problem. Please, read up on how to construct a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. The answer posted here, <i>exactly</i> solves the problem you posted in the question. If this answer doesn&#39;t solve your actual problem, then there is a problem with your question, not with this answer."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 2, "last_activity_date": 1568729197, "creation_date": 1568729197, "answer_id": 57976065, "question_id": 57976004, "link": "https://stackoverflow.com/questions/57976004/ruby-how-to-change-array-to-array-of-string-and-vice-versa/57976065#57976065", "title": "Ruby how to change array to array of string and vice versa", "body": "<p>Use <a href=\"https://ruby-doc.org/core-2.6.3/String.html#method-i-split\" rel=\"nofollow noreferrer\"><code>String#split</code></a> and <a href=\"https://ruby-doc.org/core-2.6.4/Array.html#method-i-join\" rel=\"nofollow noreferrer\"><code>Array#join</code></a>:</p>\n\n<pre><code>[\"a, b, c, d\"].first.split(', ')\n# =&gt; [\"a\", \"b\", \"c\", \"d\"]\n[[\"a\", \"b\", \"c\", \"d\"].join(', ')]\n# =&gt; [\"a, b, c, d\"]\n</code></pre>\n"}], "owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1568729301, "creation_date": 1568729018, "last_edit_date": 1568729301, "question_id": 57976004, "link": "https://stackoverflow.com/questions/57976004/ruby-how-to-change-array-to-array-of-string-and-vice-versa", "title": "Ruby how to change array to array of string and vice versa", "body": "<p>How to change something like this</p>\n\n<pre><code>array = [\"a, b, c, d\"]\n</code></pre>\n\n<p>to</p>\n\n<pre><code>array = [\"a\", \"b\", \"c\", \"d\"]\n</code></pre>\n\n<p>and vice versa</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1568734004, "post_id": 57975127, "comment_id": 102364602, "body": "\u201cLoop over array <code>arr2</code>\u201d suggests that that array may contain more than one element. One can guess what the desired return value might be In the general case, but it is not made clear by your example. I suggest you add a second element to <code>arr2</code>."}], "answers": [{"comments": [{"owner": {"reputation": 7768, "user_id": 1213273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/cf372446eb8bcca32373052e4dda2164?s=128&d=identicon&r=PG", "display_name": "Severin", "link": "https://stackoverflow.com/users/1213273/severin"}, "edited": false, "score": 0, "creation_date": 1568732230, "post_id": 57976268, "comment_id": 102363607, "body": "Works as I intended. Thank you so much!"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1568751729, "post_id": 57976268, "comment_id": 102372224, "body": "This only works if <code>arr2</code> contains only one element. The OP wishes to &quot;loop over <code>arr2</code>&quot;, suggesting that it may contain more than one element, despite the example. Moreover, if it were only contain one element there would be no point in making it an array."}, {"owner": {"reputation": 6576, "user_id": 11951, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0158871402c1ecfa57952e8a379cfd10?s=128&d=identicon&r=PG", "display_name": "Daniel Lucraft", "link": "https://stackoverflow.com/users/11951/daniel-lucraft"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1568881471, "post_id": 57976268, "comment_id": 102418110, "body": "@CarySwoveland yes, I agree. I just don&#39;t think we know without more information what they want to happen if the array contains multiple elements, so I provided the code for the example given. Your answer is a good guess, but not necessarily what they want (although given that they&#39;ve accepted it, it probably was what they want)"}], "tags": [], "owner": {"reputation": 6576, "user_id": 11951, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0158871402c1ecfa57952e8a379cfd10?s=128&d=identicon&r=PG", "display_name": "Daniel Lucraft", "link": "https://stackoverflow.com/users/11951/daniel-lucraft"}, "is_accepted": false, "score": 1, "last_activity_date": 1568730644, "last_edit_date": 1568730644, "creation_date": 1568729799, "answer_id": 57976268, "question_id": 57975127, "link": "https://stackoverflow.com/questions/57975127/ruby-use-mutated-array-for-next-iteration-in-loop/57976268#57976268", "title": "Ruby - use mutated array for next iteration in loop", "body": "<p>I'm not entirely clear what your goal here is. For instance, in <code>arr2</code>, can values of the hash be arrays? In <code>arr1</code> can the hashes have more than one key value pair? Or what happens if <code>arr2</code> has multiple hashes in it? Are they merged, or is the result expanded further somehow?</p>\n\n<p>So it's hard to say exactly what the best course is.</p>\n\n<p>Nonetheless, given the data you've given us and the result you say you want, you can get it like this using <em>Array#product</em>:</p>\n\n<pre><code>m = arr1.inject(&amp;:merge)\nm.values[0].product(m.values[1]).map {|a| Hash[m.keys.zip(a)].merge(arr2[0]) }\n</code></pre>\n\n<p>The intuition here is that I think you're trying to create all possible combinations of a couple of arrays, to generate all possible test cases? Depending on what you're trying to do, a more natural way to store the data and get the result might be:</p>\n\n<pre><code>m = { \n  test1: ['a'], \n  test2: ['b'],\n  nested_test1: [1, 2],\n  nested_test2: [true, false]\n}\n\nm.values.inject(&amp;:product).map {|v| Hash[m.keys.zip(v.flatten)] }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 0, "last_activity_date": 1568754978, "creation_date": 1568754978, "answer_id": 57982169, "question_id": 57975127, "link": "https://stackoverflow.com/questions/57975127/ruby-use-mutated-array-for-next-iteration-in-loop/57982169#57982169", "title": "Ruby - use mutated array for next iteration in loop", "body": "<p><strong>Code</strong></p>\n\n<p>The following method permits its arguments to be arrays of arbitrary size.</p>\n\n<pre><code>def expand(arr1, arr2)\n    arr2.product(\n      arr1.map { |h| h.flatten.then { |k,v| v.map { |e| { k=&gt;e } } } }.\n           then { |first, *rest| first.product(*rest) }\n    ).map { |first, (*rest)| first.merge(*rest.flatten) }\nend\n</code></pre>\n\n<p><strong>Example</strong></p>\n\n<pre><code>arr1 = [{ nested_test1: [1,2] }, { nested_test2: [true, false] }]\narr2 = [{ test1: 'a', test2: 'b' }, { test3: 'c', test4: 'd' }]\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>expand(arr1, arr2)\n  #=&gt; [{:test1=&gt;\"a\", :test2=&gt;\"b\", :nested_test1=&gt;1, :nested_test2=&gt;true},\n  #    {:test1=&gt;\"a\", :test2=&gt;\"b\", :nested_test1=&gt;1, :nested_test2=&gt;false},\n  #    {:test1=&gt;\"a\", :test2=&gt;\"b\", :nested_test1=&gt;2, :nested_test2=&gt;true},\n  #    {:test1=&gt;\"a\", :test2=&gt;\"b\", :nested_test1=&gt;2, :nested_test2=&gt;false},\n  #    {:test3=&gt;\"c\", :test4=&gt;\"d\", :nested_test1=&gt;1, :nested_test2=&gt;true},\n  #    {:test3=&gt;\"c\", :test4=&gt;\"d\", :nested_test1=&gt;1, :nested_test2=&gt;false},\n  #    {:test3=&gt;\"c\", :test4=&gt;\"d\", :nested_test1=&gt;2, :nested_test2=&gt;true},\n  #    {:test3=&gt;\"c\", :test4=&gt;\"d\", :nested_test1=&gt;2, :nested_test2=&gt;false}] \n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>The following steps are performed for the example.</p>\n\n<p>Noting that:</p>\n\n<pre><code>arr1.map(&amp;:flatten)\n  #=&gt; [[:nested_test1, [1, 2]], [:nested_test2, [true, false]]] \n</code></pre>\n\n<p>the first step is the following:</p>\n\n<pre><code>a = arr1.map { |h| h.flatten.then { |k,v| v.map { |e| { k=&gt;e } } }\n  #=&gt; [[{:nested_test1=&gt;1}, {:nested_test1=&gt;2}],\n  #    [{:nested_test2=&gt;true}, {:nested_test2=&gt;false}]]\n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/core-2.6.3/Hash.html#method-i-flatten\" rel=\"nofollow noreferrer\">Hash#flatten</a> and <a href=\"https://ruby-doc.org/core-2.6.3/Object.html#method-i-then\" rel=\"nofollow noreferrer\">Object#then</a>. The latter method made its debut in Ruby v2.6. It is an alias of <code>Object#yield_self</code>, which was new in v2.5.</p>\n\n<p>Then:</p>\n\n<pre><code>b = a.then { |first, *rest| first.product(*rest) }\n  #=&gt; [[{:nested_test1=&gt;1}, {:nested_test2=&gt;true}],\n  #    [{:nested_test1=&gt;1}, {:nested_test2=&gt;false}],\n  #    [{:nested_test1=&gt;2}, {:nested_test2=&gt;true}],\n  #    [{:nested_test1=&gt;2}, {:nested_test2=&gt;false}]]\n</code></pre>\n\n<p>See Array#product. Here and especially below I made heavy use of <a href=\"https://docs.ruby-lang.org/en/2.6.0/syntax/assignment_rdoc.html#label-Array+Decomposition\" rel=\"nofollow noreferrer\">Array decomposition</a>. See also <a href=\"https://riptutorial.com/ruby/example/8798/decomposition\" rel=\"nofollow noreferrer\">this article</a>.</p>\n\n<p>Continuing,</p>\n\n<pre><code>c = arr2.product(b)\n  #=&gt; [[{:test1=&gt;\"a\", :test2=&gt;\"b\"}, [{:nested_test1=&gt;1}, {:nested_test2=&gt;true}]],\n  #    [{:test1=&gt;\"a\", :test2=&gt;\"b\"}, [{:nested_test1=&gt;1}, {:nested_test2=&gt;false}]],\n  #    [{:test1=&gt;\"a\", :test2=&gt;\"b\"}, [{:nested_test1=&gt;2}, {:nested_test2=&gt;true}]],\n  #    [{:test1=&gt;\"a\", :test2=&gt;\"b\"}, [{:nested_test1=&gt;2}, {:nested_test2=&gt;false}]],\n  #    [{:test3=&gt;\"c\", :test4=&gt;\"d\"}, [{:nested_test1=&gt;1}, {:nested_test2=&gt;true}]],\n  #    [{:test3=&gt;\"c\", :test4=&gt;\"d\"}, [{:nested_test1=&gt;1}, {:nested_test2=&gt;false}]],\n  #    [{:test3=&gt;\"c\", :test4=&gt;\"d\"}, [{:nested_test1=&gt;2}, {:nested_test2=&gt;true}]],\n  #    [{:test3=&gt;\"c\", :test4=&gt;\"d\"}, [{:nested_test1=&gt;2}, {:nested_test2=&gt;false}]]]\n</code></pre>\n\n<p>and lastly:</p>\n\n<pre><code>c.map { |first, (*rest)| first.merge(*rest.flatten) }\n  #=&gt; &lt;as shown above&gt;\n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/core-2.6.3/Hash.html#method-i-merge\" rel=\"nofollow noreferrer\">Hash#merge</a>.</p>\n"}], "owner": {"reputation": 7768, "user_id": 1213273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/cf372446eb8bcca32373052e4dda2164?s=128&d=identicon&r=PG", "display_name": "Severin", "link": "https://stackoverflow.com/users/1213273/severin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 57982169, "answer_count": 2, "score": 0, "last_activity_date": 1568754978, "creation_date": 1568726272, "question_id": 57975127, "link": "https://stackoverflow.com/questions/57975127/ruby-use-mutated-array-for-next-iteration-in-loop", "title": "Ruby - use mutated array for next iteration in loop", "body": "<p>Given the following arrays:</p>\n\n<pre><code>arr1 = [\n  { nested_test1: [1,2] },\n  { nested_test2: [true, false] }\n]\narr2 = [\n  { test1: 'a', test2: 'b' }\n]\n</code></pre>\n\n<p>I wanna loop over array <code>arr2</code> and mutate it depending on the contents of <code>arr1</code>. The final result should look like this:</p>\n\n<pre><code>res_arr = [\n  { test1: 'a', test2: 'b', nested_test1: 1, nested_test2: true },\n  { test1: 'a', test2: 'b', nested_test1: 2, nested_test2: true },\n  { test1: 'a', test2: 'b', nested_test1: 1, nested_test2: false },\n  { test1: 'a', test2: 'b', nested_test1: 2, nested_test2: false },\n]\n</code></pre>\n\n<p>So my initial setup looks like this:</p>\n\n<pre><code>res_arr = []\narr1.each do |hash1|\n  arr2.each do |hash2|\n    hash1.values.first.each do |value|\n      hash2[hash1.keys.first] = value\n      res_arr &lt;&lt; hash2.clone\n    end\n  end\nend\n</code></pre>\n\n<p>But this gives me the following:</p>\n\n<pre><code>res_arr = [\n  {:test1=&gt;\"a\", :test2=&gt;\"b\", :nested_test1=&gt;1},\n  {:test1=&gt;\"a\", :test2=&gt;\"b\", :nested_test1=&gt;2},\n  {:test1=&gt;\"a\", :test2=&gt;\"b\", :nested_test1=&gt;2, :nested_test2=&gt;true},\n  {:test1=&gt;\"a\", :test2=&gt;\"b\", :nested_test1=&gt;2, :nested_test2=&gt;false}\n]\n</code></pre>\n\n<p>So what I wanna do then, is to use the mutated version for each iteration of <code>arr2</code>. How can this be achieved?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1568722917, "post_id": 57974073, "comment_id": 102357938, "body": "please update question to include full backtrace errors"}], "answers": [{"comments": [{"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1568723957, "post_id": 57974215, "comment_id": 102358509, "body": "Ok but in that way I will not have headers in my CSV, am I right? should I add them in a different way than before?"}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "reply_to_user": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1568724036, "post_id": 57974215, "comment_id": 102358568, "body": "@mr_muscle yes, you should add them manually, before entering this iteration."}, {"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1568725192, "post_id": 57974215, "comment_id": 102359207, "body": "It will work too if I add ` write headers: true` in my <code>CSV.open(...)</code> line. Thanks a lot!"}], "tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": true, "score": 4, "last_activity_date": 1568723278, "creation_date": 1568723278, "answer_id": 57974215, "question_id": 57974073, "link": "https://stackoverflow.com/questions/57974073/rails-csv-generator-undefined-method-collect-for-mon-17-jun-2019-141610-c/57974215#57974215", "title": "Rails CSV generator - undefined method `collect&#39; for Mon, 17 Jun 2019 14:16:10 CEST +02:00:Time in", "body": "<p>You should add <code>Array</code>s to <code>csv</code> Array, like this:</p>\n\n<pre><code>csv &lt;&lt; [admin_log.created_at, admin_log.action_type, admin_log.admin_email, admin_log.old_data, admin_log.new_data]\n</code></pre>\n"}], "owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 738, "favorite_count": 1, "accepted_answer_id": 57974215, "answer_count": 1, "score": 0, "last_activity_date": 1568723628, "creation_date": 1568722753, "last_edit_date": 1568723342, "question_id": 57974073, "link": "https://stackoverflow.com/questions/57974073/rails-csv-generator-undefined-method-collect-for-mon-17-jun-2019-141610-c", "title": "Rails CSV generator - undefined method `collect&#39; for Mon, 17 Jun 2019 14:16:10 CEST +02:00:Time in", "body": "<p>I've got CSV generetor for admin logs. When I run a test I've got an error</p>\n\n<blockquote>\n  <p>1) CsvAdminLogData::CsvAdminLogGenerator creates CSV file with proper value\n      Failure/Error: csv &lt;&lt; admin_log.created_at</p>\n  \n  <p>NoMethodError:\n         undefined method `collect' for Mon, 17 Jun 2019 14:16:10 CEST +02:00:Time</p>\n</blockquote>\n\n<pre><code>def call\n  CSV.open(target_file, 'w', headers: LOG_HEADERS, encoding: 'UTF-8') do |csv|\n    AdminPanelLog.dates_between(start_date, end_date).find_each do |admin_log|\n      csv &lt;&lt; admin_log.created_at\n      csv &lt;&lt; admin_log.action_type\n      csv &lt;&lt; admin_log.admin_email\n      csv &lt;&lt; admin_log.old_data\n      csv &lt;&lt; admin_log.new_data\n    end\n  end\nend\n</code></pre>\n\n<p>I've try to something like <code>admin_log.created_at.to_s</code> but without any results. In this case I can't use <code>&lt;&lt;</code> to add this data to CSV file?</p>\n\n<p>EDIT:</p>\n\n<p>If I comment <code># csv &lt;&lt; admin_log.action_type</code> I will get the same error for another row</p>\n\n<blockquote>\n  <p>Failure/Error: csv &lt;&lt; admin_log.action_type\n      NoMethodError:\n         undefined method `collect' for \"New\":String</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "authorization", "basic-authentication"], "comments": [{"owner": {"reputation": 1156, "user_id": 4955546, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3ypcYA0ACXs/AAAAAAAAAAI/AAAAAAAABgY/gcCpBwKBymI/photo.jpg?sz=128", "display_name": "Sikandar Tariq", "link": "https://stackoverflow.com/users/4955546/sikandar-tariq"}, "edited": false, "score": 1, "creation_date": 1568723003, "post_id": 57974048, "comment_id": 102357996, "body": "please provide complete server logs for this request"}, {"owner": {"reputation": 56, "user_id": 12079462, "user_type": "registered", "profile_image": "https://graph.facebook.com/1922700964499358/picture?type=large", "display_name": "Garbus Uchiha", "link": "https://stackoverflow.com/users/12079462/garbus-uchiha"}, "reply_to_user": {"reputation": 1156, "user_id": 4955546, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3ypcYA0ACXs/AAAAAAAAAAI/AAAAAAAABgY/gcCpBwKBymI/photo.jpg?sz=128", "display_name": "Sikandar Tariq", "link": "https://stackoverflow.com/users/4955546/sikandar-tariq"}, "edited": false, "score": 0, "creation_date": 1568726250, "post_id": 57974048, "comment_id": 102359838, "body": "This is an test only, but I&#39;ve already fixed this problem :)"}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 12079462, "user_type": "registered", "profile_image": "https://graph.facebook.com/1922700964499358/picture?type=large", "display_name": "Garbus Uchiha", "link": "https://stackoverflow.com/users/12079462/garbus-uchiha"}, "is_accepted": true, "score": 0, "last_activity_date": 1568726630, "creation_date": 1568726630, "answer_id": 57975247, "question_id": 57974048, "link": "https://stackoverflow.com/questions/57974048/post-authorization-trouble-no-implicit-conversion-of-nil-into-string/57975247#57975247", "title": "POST Authorization trouble: no implicit conversion of nil into String", "body": "<h1><strong>#FIXED</strong></h1>\n\n<p><strong>The issue</strong> - Authorization parameters (name and password) has been set in the beginning of the test: </p>\n\n<pre><code>test 'failure no id' do\n  MyGem.auth_name = 'xxx'\n  MyGem.auth_pass = 'xxx'\n  params = {\n    ...\n    ....\n    (no id)\n  }\n\n  post back_request_url, params: params, headers: @auth_headers\n  assert_response 400\nend\n</code></pre>\n\n<p>And the action:</p>\n\n<pre><code>class BackRequestController &lt; ApplicationController\n    protect_from_forgery except: [:new]\n    http_basic_authenticate_with name: MyGem.auth_name, password: MyGem.auth_pass\n\n...\n</code></pre>\n\n<p>And they wasn't sometimes set and refreshed, when the test has begun.</p>\n\n<p><strong>Solution</strong></p>\n\n<p>Simply :)</p>\n\n<pre><code>class BackRequestControllerTest &lt; ActionDispatch::IntegrationTest\n  include Engine.routes.url_helpers\n\n  setup do\n    MyGemauth_name = 'xxx'\n    MyGem.auth_pass = 'xxx'\n    @auth_headers = {\n      'Authorization': \"Basic #{Base64.encode64(MyGem.auth_name. + ':' + MyGem.auth_pass)}\"\n    }\n  end\n\n...\n...\n...\n(TESTS)\n</code></pre>\n"}], "owner": {"reputation": 56, "user_id": 12079462, "user_type": "registered", "profile_image": "https://graph.facebook.com/1922700964499358/picture?type=large", "display_name": "Garbus Uchiha", "link": "https://stackoverflow.com/users/12079462/garbus-uchiha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 57975247, "answer_count": 1, "score": 0, "last_activity_date": 1568726630, "creation_date": 1568722655, "last_edit_date": 1568725044, "question_id": 57974048, "link": "https://stackoverflow.com/questions/57974048/post-authorization-trouble-no-implicit-conversion-of-nil-into-string", "title": "POST Authorization trouble: no implicit conversion of nil into String", "body": "<p>Sometimes when I run tests I am getting this error: \n<code>TypeError: no implicit conversion of nil into String</code>, which is caused by this code:</p>\n\n<pre><code>params = {\n  .....\n}\n\nauth_headers = {\n  'Authorization': \"Basic #{Base64.encode64('XXX:XXX')}\"\n}\n\npost back_request_url, params: params, headers: auth_headers\n</code></pre>\n\n<p><code>back_request_url</code> path is valid, same params. When the authorization fails, I am getting (as it should be) simply <code>401</code> - but, when the authorization passes - then this error happens.</p>\n\n<p>This is something in rails - this action doesn't enter into action provided by <code>back_request_url</code>.</p>\n\n<p>What it could be?\nMy version of rails is <code>5.1.3</code></p>\n"}, {"tags": ["html", "css", "ruby-on-rails", "ruby", "twitter-bootstrap-3"], "comments": [{"owner": {"reputation": 94334, "user_id": 2802040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCB9I.png?s=128&g=1", "display_name": "Paulie_D", "link": "https://stackoverflow.com/users/2802040/paulie-d"}, "edited": false, "score": 0, "creation_date": 1568722222, "post_id": 57973746, "comment_id": 102357579, "body": "Essentially, I <i>think</i> your question boils down to &quot;How do i make my thumbnail div be only as wide as the image within it?&quot; ...right?"}, {"owner": {"reputation": 94334, "user_id": 2802040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCB9I.png?s=128&g=1", "display_name": "Paulie_D", "link": "https://stackoverflow.com/users/2802040/paulie-d"}, "edited": false, "score": 0, "creation_date": 1568722499, "post_id": 57973746, "comment_id": 102357706, "body": "Well a workable example in a snippet would be useful as I indicated."}, {"owner": {"reputation": 13, "user_id": 12079276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d935a858941c3c76ed3cc261fa96f86?s=128&d=identicon&r=PG&f=1", "display_name": "helloiamhere", "link": "https://stackoverflow.com/users/12079276/helloiamhere"}, "reply_to_user": {"reputation": 94334, "user_id": 2802040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCB9I.png?s=128&g=1", "display_name": "Paulie_D", "link": "https://stackoverflow.com/users/2802040/paulie-d"}, "edited": false, "score": 0, "creation_date": 1568722697, "post_id": 57973746, "comment_id": 102357804, "body": "I made a gif and tried to downsize with 3 different tools. Stackoverflow only lets you upload 2MB."}, {"owner": {"reputation": 13, "user_id": 12079276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d935a858941c3c76ed3cc261fa96f86?s=128&d=identicon&r=PG&f=1", "display_name": "helloiamhere", "link": "https://stackoverflow.com/users/12079276/helloiamhere"}, "reply_to_user": {"reputation": 94334, "user_id": 2802040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCB9I.png?s=128&g=1", "display_name": "Paulie_D", "link": "https://stackoverflow.com/users/2802040/paulie-d"}, "edited": false, "score": 0, "creation_date": 1568722734, "post_id": 57973746, "comment_id": 102357827, "body": "Please recommend a tool and I&#39;ll be happy to use it if the file is less then 2MB"}], "answers": [{"tags": [], "owner": {"reputation": 94334, "user_id": 2802040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCB9I.png?s=128&g=1", "display_name": "Paulie_D", "link": "https://stackoverflow.com/users/2802040/paulie-d"}, "is_accepted": true, "score": 0, "last_activity_date": 1568722887, "creation_date": 1568722887, "answer_id": 57974118, "question_id": 57973746, "link": "https://stackoverflow.com/questions/57973746/buttons-around-image-not-responding-in-the-same-way/57974118#57974118", "title": "Buttons around image not responding in the same way", "body": "<p>Essentially, your question boils down to \"How do i make my thumbnail div be only as wide as the image within it?</p>\n\n<p>Using the same technique as in this answer: \n<strong><a href=\"https://stackoverflow.com/questions/37884416/make-wrapper-take-maximum-width-of-child-image\">Make wrapper take maximum width of child image?</a></strong></p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>.wrapper {\r\n  border: 1px solid red;\r\n  display: inline-table;\r\n  margin-top: 1em;\r\n  width: 1%;\r\n  text-align: left;\r\n}\r\n\r\n.col {\r\n  text-align: center;\r\n}</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;div class=\"col\"&gt;\r\n  &lt;div class=\"wrapper\"&gt;\r\n    &lt;div&gt;&amp;#8902; &amp;#8902; &amp;#8902; &amp;#8902; &amp;#8902;&lt;/div&gt;\r\n    &lt;img src=\"http://www.fillmurray.com/284/196\"&gt;\r\n    &lt;button&gt;My Button&lt;/button&gt; &lt;button&gt;My Other Button&lt;/button&gt;\r\n  &lt;/div&gt;\r\n&lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 13, "user_id": 12079276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d935a858941c3c76ed3cc261fa96f86?s=128&d=identicon&r=PG&f=1", "display_name": "helloiamhere", "link": "https://stackoverflow.com/users/12079276/helloiamhere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 57974118, "answer_count": 1, "score": -2, "last_activity_date": 1568722887, "creation_date": 1568721488, "question_id": 57973746, "link": "https://stackoverflow.com/questions/57973746/buttons-around-image-not-responding-in-the-same-way", "title": "Buttons around image not responding in the same way", "body": "<p>This is my first question.</p>\n\n<p>I have an application using rails and bootstrap. When the screen goes to small, the items around the picture don't respond the same as on a medium &amp; large screen. Take a look:</p>\n\n<p><a href=\"https://imgur.com/a/zcQQZWv\" rel=\"nofollow noreferrer\">https://imgur.com/a/zcQQZWv</a> - Good size, everything functions well.\n<a href=\"https://imgur.com/a/2KTIgcy\" rel=\"nofollow noreferrer\">https://imgur.com/a/2KTIgcy</a> - Bootstrap small size (functions badly)</p>\n\n<p>I want the stars and the buttons to be below and within the width of the picture. I thought naturally bootstrap would make the buttons responsive with the picture because all of it is located within the same <code>&lt;div class=\"col-sm-4 col-md-3\"&gt;</code></p>\n\n<p>I'm currently not styling this page so no CSS needs to be added to this question.</p>\n\n<p>I'm using paperclip as my image resizing gem.</p>\n\n<pre><code>&lt;div class=\"row\"&gt;\n&lt;% @movies.each do |movie| %&gt;\n    &lt;div class=\"col-sm-4 col-md-3\"&gt;                    \n        &lt;div class=\"thumbnail\"&gt;\n            &lt;% if user_signed_in? %&gt;\n                &lt;div class=\"js-rating\" movie_id=\"&lt;%= movie.id %&gt;\" data-rate-value=6&gt;&lt;/div&gt;\n            &lt;% end %&gt;\n            &lt;br&gt;\n            &lt;%= link_to (image_tag movie.image.url(:medium), class: 'image'), user_movie_path(movie.user, movie) %&gt;\n            &lt;% if movie.user == current_user %&gt;\n                &lt;br&gt;\n                &lt;div class=\"image-buttons\"&gt;\n                    &lt;%= link_to 'Edit', edit_user_movie_path(movie.user, movie), class: 'btn btn-primary' %&gt;\n                    &lt;%= link_to \"Remove\", user_movie_path(movie.user, movie), method: :delete, data: { confirm: \"You Sure?\" }, class: 'btn btn-primary btn-remove-main' %&gt;\n                &lt;/div&gt;\n            &lt;% end %&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p></p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 3, "creation_date": 1568721780, "post_id": 57973724, "comment_id": 102357348, "body": "Because this is how Ruby hash works? I don&#39;t quite understand your question."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 1, "creation_date": 1568721945, "post_id": 57973724, "comment_id": 102357442, "body": "Maybe you can consider to take a look to the docs: <a href=\"https://ruby-doc.org/core-2.6.4/Hash.html\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.6.4/Hash.html</a>"}, {"owner": {"reputation": 195, "user_id": 9190334, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/83axG.png?s=128&g=1", "display_name": "Kasem777", "link": "https://stackoverflow.com/users/9190334/kasem777"}, "edited": false, "score": 0, "creation_date": 1568722541, "post_id": 57973724, "comment_id": 102357730, "body": "I don&#39;t understand how cards[char]                       #how it evaluates to the number(value) in the hash"}, {"owner": {"reputation": 195, "user_id": 9190334, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/83axG.png?s=128&g=1", "display_name": "Kasem777", "link": "https://stackoverflow.com/users/9190334/kasem777"}, "edited": false, "score": 0, "creation_date": 1568722968, "post_id": 57973724, "comment_id": 102357974, "body": "Thanks, guys the Ruby-dec was helpfull."}], "answers": [{"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 3, "last_activity_date": 1568722329, "creation_date": 1568722329, "answer_id": 57973951, "question_id": 57973724, "link": "https://stackoverflow.com/questions/57973724/in-ruby-how-to-get-the-value-in-hash-without-the-key/57973951#57973951", "title": "In Ruby how to get the value in hash without the key?", "body": "<p>Ruby Hash is working as expected but perhaps you don't understand the code you've provided. </p>\n\n<pre><code>cards = {\"A\" =&gt; 4, \"K\" =&gt; 3, \"Q\" =&gt; 2, \"J\" =&gt; 1}\n</code></pre>\n\n<p>In this example the letters ARE the keys and the numbers are the values.  To get a value, you call the key like this:</p>\n\n<pre><code>cards['A'] # this will return 4\n\nhand.each_char # this is iterating over each character that is passed as a single string argument to your method.\n\n hand.each_char do |char| # char is just the iterator assigned inside the loop \n   score += cards[char.upcase] \n end\n</code></pre>\n\n<p>A variable can be used instead of the string which is what's happening inside the loop.</p>\n\n<pre><code>char = 'a'\ncards[char] # this will return nil because the keys were defined in upper case.\ncards[char.upcase] # this will return 4 because the key is found when it is upper case.\n</code></pre>\n\n<p>For more see <a href=\"https://ruby-doc.org/core-2.6.4/Hash.html\" rel=\"nofollow noreferrer\">documentation on Hash class</a></p>\n"}], "owner": {"reputation": 195, "user_id": 9190334, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/83axG.png?s=128&g=1", "display_name": "Kasem777", "link": "https://stackoverflow.com/users/9190334/kasem777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568722329, "creation_date": 1568721400, "last_edit_date": 1568721603, "question_id": 57973724, "link": "https://stackoverflow.com/questions/57973724/in-ruby-how-to-get-the-value-in-hash-without-the-key", "title": "In Ruby how to get the value in hash without the key?", "body": "<pre><code>def hand_score(hand)\n  cards = {\"A\" =&gt; 4, \"K\" =&gt; 3, \"Q\" =&gt; 2, \"J\" =&gt; 1}\n  score = 0\n\n  hand.each_char do |char|\n    score += cards[char.upcase]\n  end\n  return score\nend\n\nputs hand_score(\"AQAJ\") #=&gt; 11\nputs hand_score(\"jJka\") #=&gt; 9\n</code></pre>\n\n<p>How does <code>cards[char.upcase]</code> \nevaluate to the number in the hash not to the string?</p>\n\n<pre><code>cards{\"A\" =&gt; 4}\n</code></pre>\n\n<p>How does <code>cards[char]</code> evaluate to the number 4 not to the letter \"A\" ??</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "aasm"], "comments": [{"owner": {"reputation": 1600, "user_id": 970843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fooaG.png?s=128&g=1", "display_name": "marcbest", "link": "https://stackoverflow.com/users/970843/marcbest"}, "edited": false, "score": 1, "creation_date": 1568728421, "post_id": 57973622, "comment_id": 102361304, "body": "Have you restarted your rails console since you change the state machine?"}, {"owner": {"reputation": 579, "user_id": 5672673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fXPQ.jpg?s=128&g=1", "display_name": "Linh Chi Nguyen", "link": "https://stackoverflow.com/users/5672673/linh-chi-nguyen"}, "reply_to_user": {"reputation": 1600, "user_id": 970843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fooaG.png?s=128&g=1", "display_name": "marcbest", "link": "https://stackoverflow.com/users/970843/marcbest"}, "edited": false, "score": 1, "creation_date": 1568729467, "post_id": 57973622, "comment_id": 102361950, "body": "LOL @marcbest, do you like putting your comment as an answer so that I mark it solved??? :D took me so much effort to investigate LOL"}], "answers": [{"tags": [], "owner": {"reputation": 1600, "user_id": 970843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fooaG.png?s=128&g=1", "display_name": "marcbest", "link": "https://stackoverflow.com/users/970843/marcbest"}, "is_accepted": true, "score": 1, "last_activity_date": 1568729922, "creation_date": 1568729922, "answer_id": 57976310, "question_id": 57973622, "link": "https://stackoverflow.com/questions/57973622/ruby-aasm-gem-event-name-change-but-permitted-method-still-ask-for-old-event-n/57976310#57976310", "title": "ruby aasm gem: event name change, but permitted method still ask for old event name", "body": "<p>You will need to restart your rails console/server once you have made changes to the state machine events.</p>\n"}], "owner": {"reputation": 579, "user_id": 5672673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3fXPQ.jpg?s=128&g=1", "display_name": "Linh Chi Nguyen", "link": "https://stackoverflow.com/users/5672673/linh-chi-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 57976310, "answer_count": 1, "score": 0, "last_activity_date": 1568729922, "creation_date": 1568721052, "last_edit_date": 1568727444, "question_id": 57973622, "link": "https://stackoverflow.com/questions/57973622/ruby-aasm-gem-event-name-change-but-permitted-method-still-ask-for-old-event-n", "title": "ruby aasm gem: event name change, but permitted method still ask for old event name", "body": "<p>I have been using aasm gem (<a href=\"https://github.com/aasm/aasm\" rel=\"nofollow noreferrer\">https://github.com/aasm/aasm</a>) to define an object. It comes with several public method for events. For example:</p>\n\n<p>With object <code>a_machine</code>, event <code>boot_up</code> would transit the object to a new state <code>greeting</code>. I would be able to do the following query: <code>a_machine.may_boot_up?</code>. However, I change the name <code>boot_up</code> to <code>wake_up</code>. Now the following method throws an exception:</p>\n\n<pre><code>a_machine.aasm.events(permitted: true)\n\n# undefined method: may_boot_up?\n</code></pre>\n\n<p>I would like to ask how <code>permitted</code> is implemented because it still has an outdated public method (associated with an outdated event name).</p>\n\n<p>Other things work fine. Does anyone know why? Or can you please give me further instruction on how to proceed?\nThank you,</p>\n\n<p>EDIT: I have more clue:\nAfter i change the name of the event <code>:boot_up</code> to <code>:wake_up</code>, what actually happens is that the symbol <code>:boot_up</code> still stays in the event array, and a new symbol <code>:wake_up</code> is added to that array. <code>a_machine.aasm.events.map(&amp;:name)</code> returns the event array.</p>\n\n<p>UPDATE: Now the question is framed as: how to remove an event from AASM::Core::Event because the <code>:boot_up</code> was added as an event and by changing the name I accidentally only add a new event <code>:wake_up</code>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "cmder"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12079176, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Zp07ymSkKlA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcOL2OtYlW3B13818ZXGk_OYN51Lw/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/12079176/daniel"}, "edited": false, "score": 1, "creation_date": 1568725781, "post_id": 57974602, "comment_id": 102359534, "body": "I already tried that but it didn&#39;t work. Latest version already installed."}], "tags": [], "owner": {"reputation": 595, "user_id": 3632472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e431a79c8cf18fc5c29ebb94a721dda?s=128&d=identicon&r=PG&f=1", "display_name": "Rakesh", "link": "https://stackoverflow.com/users/3632472/rakesh"}, "is_accepted": false, "score": 1, "last_activity_date": 1568724623, "creation_date": 1568724623, "answer_id": 57974602, "question_id": 57973219, "link": "https://stackoverflow.com/questions/57973219/how-to-fix-make-failedno-such-file-or-directory-in-cmder/57974602#57974602", "title": "How to fix &#39;make failedNo such file or directory&#39; in cmder", "body": "<p>update using \"gem update --system\" should fix the issue</p>\n\n<p>P.S. - If it don't solve the issue than try to update with specific version. </p>\n\n<p>e.g. \"gem update --system some_verison\"</p>\n"}], "owner": {"reputation": 1, "user_id": 12079176, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Zp07ymSkKlA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcOL2OtYlW3B13818ZXGk_OYN51Lw/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/12079176/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 895, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568732709, "creation_date": 1568719436, "last_edit_date": 1568732709, "question_id": 57973219, "link": "https://stackoverflow.com/questions/57973219/how-to-fix-make-failedno-such-file-or-directory-in-cmder", "title": "How to fix &#39;make failedNo such file or directory&#39; in cmder", "body": "<p>Now I'm working on Ruby and rails on windows 10 and tried to install gems as like solargraph or rubocop on cmder but it is not working. It says 'make failedNo such file or directory'</p>\n\n<p>ccmder says that</p>\n\n<pre><code>ERROR:  Error installing solargraph:\n        ERROR: Failed to build gem native extension.\n\ncurrent directory: C:/Ruby26-x64/lib/ruby/gems/2.6.0/gems/jaro_winkler-1.5.3/ext/jaro_winkler\nC:/Ruby26-x64/bin/ruby.exe -I C:/Ruby26-x64/lib/ruby/site_ruby/2.6.0 -r ./siteconf20190917-20996-6o1pbx.rb extconf.rb\ncreating Makefile\n\ncurrent directory: C:/Ruby26-x64/lib/ruby/gems/2.6.0/gems/jaro_winkler-1.5.3/ext/jaro_winkler\nmake \"DESTDIR=\" clean\ncurrent directory: C:/Ruby26-x64/lib/ruby/gems/2.6.0/gems/jaro_winkler-1.5.3/ext/jaro_winkler\nmake \"DESTDIR=\"\nmake failedNo such file or directory - make \"DESTDIR=\"\n\nGem files will remain installed in C:/Ruby26-x64/lib/ruby/gems/2.6.0/gems/jaro_winkler-1.5.3 for inspection.\nResults logged to C:/Ruby26-x64/lib/ruby/gems/2.6.0/extensions/x64-mingw32/2.6.0/jaro_winkler-1.5.3/gem_make.out\n</code></pre>\n\n<p>I don't know why this happened...and installing other gems gives same error.</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "sorting", "multidimensional-array"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 11550116, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NUg1CDHuRUo/AAAAAAAAAAI/AAAAAAAAAEo/SEUo4HsrS2I/photo.jpg?sz=128", "display_name": "Joseph Nehme", "link": "https://stackoverflow.com/users/11550116/joseph-nehme"}, "edited": false, "score": 0, "creation_date": 1568718856, "post_id": 57972787, "comment_id": 102355958, "body": "I tried it now, but it didn&#39;t work, nothing changed in the array, still having the same. @demir"}, {"owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "reply_to_user": {"reputation": 49, "user_id": 11550116, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NUg1CDHuRUo/AAAAAAAAAAI/AAAAAAAAAEo/SEUo4HsrS2I/photo.jpg?sz=128", "display_name": "Joseph Nehme", "link": "https://stackoverflow.com/users/11550116/joseph-nehme"}, "edited": false, "score": 0, "creation_date": 1568719214, "post_id": 57972787, "comment_id": 102356128, "body": "@JosephNehme This code returns an array. You need to reassign the returned value to the <code>array</code> variable. Try this: <code>array = array.sort_by{ |a| a.first }.reverse</code>"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 49, "user_id": 11550116, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NUg1CDHuRUo/AAAAAAAAAAI/AAAAAAAAAEo/SEUo4HsrS2I/photo.jpg?sz=128", "display_name": "Joseph Nehme", "link": "https://stackoverflow.com/users/11550116/joseph-nehme"}, "edited": false, "score": 0, "creation_date": 1568721394, "post_id": 57972787, "comment_id": 102357148, "body": "@JosephNehme If you want to mutate the current array use <code>sort_by!</code> and <code>reverse!</code> instead."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1568721438, "post_id": 57972787, "comment_id": 102357181, "body": "<code>sort_by { |a| a.first }</code> could also be written as <code>sort_by(&amp;:first)</code>"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 2, "creation_date": 1568723281, "post_id": 57972787, "comment_id": 102358160, "body": "You don&#39;t even need to use <code>sort_by</code>. Arrays are sorted by their first elements anyway (and then by their second elements, ...)."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1568723757, "post_id": 57972787, "comment_id": 102358404, "body": "^ Meaning <code>array.sort.reverse</code> would be enough."}], "tags": [], "owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "is_accepted": true, "score": 5, "last_activity_date": 1568718866, "last_edit_date": 1568718866, "creation_date": 1568717817, "answer_id": 57972787, "question_id": 57972708, "link": "https://stackoverflow.com/questions/57972708/how-to-sort-a-two-dimensional-array-2d-array-by-date-in-ruby-on-rails/57972787#57972787", "title": "How to sort a two-dimensional array (2d array) by date in ruby on rails?", "body": "<p>You can sort 2d arrays with <a href=\"https://ruby-doc.org/core-2.6.4/Enumerable.html#method-i-sort_by\" rel=\"nofollow noreferrer\">sort_by</a> method: <code>sort_by</code> sorts in ascending order by default. If you want it to be in descending order, just reverse the result.</p>\n\n<pre><code>array.sort_by{ |a| a.first }.reverse\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 1, "last_activity_date": 1568722325, "last_edit_date": 1568722325, "creation_date": 1568721621, "answer_id": 57973776, "question_id": 57972708, "link": "https://stackoverflow.com/questions/57972708/how-to-sort-a-two-dimensional-array-2d-array-by-date-in-ruby-on-rails/57973776#57973776", "title": "How to sort a two-dimensional array (2d array) by date in ruby on rails?", "body": "<p>I suggest to convert the string to a <code>Date</code> object and use it for sorting:</p>\n\n<pre><code>Date.strptime(\"2019-09-15\", '%Y-%m-%d').class\n#=&gt; Sun, 15 Sep 2019\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/questions/354657/rails-activesupport-time-parsing\">Rails ActiveSupport Time Parsing?</a>\n<hr>\nSo, if you want to change the original array, use <a href=\"https://ruby-doc.org/core-2.6.4/Array.html#method-i-sort-21\" rel=\"nofollow noreferrer\">Array#sort!</a>, note the bang (<code>!</code>):</p>\n\n<pre><code>array.sort! { |(date_1, *rest_1), (date_2, *rest_2)| Date.strptime(date_2, '%Y-%m-%d') &lt;=&gt; Date.strptime(date_1, '%Y-%m-%d') }\narray\n#=&gt; [[\"2019-09-15\", \"00357382\", \"LBP\"], [\"2019-05-26\", \"00357853\", \"EUR\"], [\"2019-03-11\", \"00986587\", \"LBP\"], [\"2019-02-23\", \"00462421\", \"USD\"]]\n</code></pre>\n\n<p>Change the block for inverse order:</p>\n\n<pre><code>Date.strptime(date_1, '%Y-%m-%d') &lt;=&gt; Date.strptime(date_2, '%Y-%m-%d')\n</code></pre>\n\n<p><hr>\nNote that for the block variables I used the <code>*splat</code> operator which works like this:</p>\n\n<pre><code>ary = [1,2,3]\na, *b = ary\np a, b\n# 1\n# [2, 3]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 2, "last_activity_date": 1568723099, "creation_date": 1568723099, "answer_id": 57974170, "question_id": 57972708, "link": "https://stackoverflow.com/questions/57972708/how-to-sort-a-two-dimensional-array-2d-array-by-date-in-ruby-on-rails/57974170#57974170", "title": "How to sort a two-dimensional array (2d array) by date in ruby on rails?", "body": "<p>Two important notes:</p>\n\n<ul>\n<li>your dates are written in <code>YYYY-MM-DD</code> format, so sorting them alphabetically will also sort them chronologically.</li>\n<li>your dates are the first element in the arrays, and array are sorted by their first element first.</li>\n</ul>\n\n<p>It means that all you need is:</p>\n\n<pre><code>array.sort.reverse\n#=&gt; =&gt; [[\"2019-09-15\", \"00357382\", \"LBP\"], [\"2019-05-26\", \"00357853\", \"EUR\"], [\"2019-03-11\", \"00986587\", \"LBP\"], [\"2019-02-23\", \"00462421\", \"USD\"]]\n</code></pre>\n\n<p>If you want to save modify <code>array</code> in place, you can write:</p>\n\n<pre><code>array.sort!.reverse!\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 11550116, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NUg1CDHuRUo/AAAAAAAAAAI/AAAAAAAAAEo/SEUo4HsrS2I/photo.jpg?sz=128", "display_name": "Joseph Nehme", "link": "https://stackoverflow.com/users/11550116/joseph-nehme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 0, "accepted_answer_id": 57972787, "answer_count": 3, "score": 2, "last_activity_date": 1568723099, "creation_date": 1568717480, "question_id": 57972708, "link": "https://stackoverflow.com/questions/57972708/how-to-sort-a-two-dimensional-array-2d-array-by-date-in-ruby-on-rails", "title": "How to sort a two-dimensional array (2d array) by date in ruby on rails?", "body": "<p>I have a two dimensional array which has following structure</p>\n\n<pre><code>array = [\n          [\"2019-03-11\",\"00986587\",\"LBP\"],\n          [\"2019-02-23\",\"00462421\",\"USD\"],\n          [\"2019-05-26\",\"00357853\",\"EUR\"],\n          [\"2019-09-15\",\"00357382\",\"LBP\"]\n        ]\n</code></pre>\n\n<p>I want to sort the array based on the date (first element of each row).</p>\n\n<p>Looking for the following result:</p>\n\n<pre><code>array = [\n          [\"2019-09-15\",\"00357382\",\"LBP\"],\n          [\"2019-05-26\",\"00357853\",\"EUR\"],\n          [\"2019-03-11\",\"00986587\",\"LBP\"],\n          [\"2019-02-23\",\"00462421\",\"USD\"]\n        ]\n</code></pre>\n\n<p>After my research on <strong>sort</strong> and <strong>sort_by</strong> i didn't find any solution.\nCan anyone please help me to solve my problem ? and thank you </p>\n"}, {"tags": ["ruby", "windows", "git", "batch-file"], "comments": [{"owner": {"reputation": 55797, "user_id": 7976758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512cfbaf98d63ca4acd57b2df792aec6?s=128&d=identicon&r=PG", "display_name": "phd", "link": "https://stackoverflow.com/users/7976758/phd"}, "edited": false, "score": 0, "creation_date": 1568731291, "post_id": 57972540, "comment_id": 102363054, "body": "Try <code>EXIT</code> in the command line: <code>&quot;git-cmd.exe&quot; &quot;DIR; EXIT&quot;</code>"}, {"owner": {"reputation": 1, "user_id": 9586127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b26079560a41b66b287181491b7039c?s=128&d=identicon&r=PG&f=1", "display_name": "M. Hamdi", "link": "https://stackoverflow.com/users/9586127/m-hamdi"}, "reply_to_user": {"reputation": 55797, "user_id": 7976758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512cfbaf98d63ca4acd57b2df792aec6?s=128&d=identicon&r=PG", "display_name": "phd", "link": "https://stackoverflow.com/users/7976758/phd"}, "edited": false, "score": 0, "creation_date": 1568798114, "post_id": 57972540, "comment_id": 102385874, "body": "@phd the <code>;</code> doesn&#39;t work. I think it&#39;s parsed as a parameter to <code>dir</code> command. However, <code>&quot;git-cmd.exe&quot; &quot;DIR &amp; EXIT&quot;</code> or <code>&quot;git-cmd.exe&quot; &quot;DIR &amp;&amp; EXIT&quot;</code> works but this doesn&#39;t work with <code>rake build</code> command as it needs <code>call</code> before it to exit. Even if after adding it to be <code>&quot;git-cmd.exe&quot; &quot;CALL rake build &amp;&amp; EXIT&quot;</code>, it doesn&#39;t work (<code>EXIT</code> is not executed)."}, {"owner": {"reputation": 1, "user_id": 9586127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b26079560a41b66b287181491b7039c?s=128&d=identicon&r=PG&f=1", "display_name": "M. Hamdi", "link": "https://stackoverflow.com/users/9586127/m-hamdi"}, "edited": false, "score": 0, "creation_date": 1569154432, "post_id": 57972540, "comment_id": 102496739, "body": "Thanks all, the issue has been resolved. I&#39;ll add the resolution as an answer. There was a conversation here between me and someone else (I think mony) but all his comments has been deleted, don&#39;t know why?!"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9586127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b26079560a41b66b287181491b7039c?s=128&d=identicon&r=PG&f=1", "display_name": "M. Hamdi", "link": "https://stackoverflow.com/users/9586127/m-hamdi"}, "is_accepted": true, "score": 0, "last_activity_date": 1569520812, "last_edit_date": 1569520812, "creation_date": 1569502893, "answer_id": 58117393, "question_id": 57972540, "link": "https://stackoverflow.com/questions/57972540/how-to-exit-git-cmd-exe-after-running-a-command-via-it-in-a-batch-file/58117393#58117393", "title": "How to exit &#39;git-cmd.exe&#39; after running a command via it in a batch file?", "body": "<p>Thanks to the suggestions, the issue was resolved by passing <code>EXIT</code> command to <code>git-cmd.exe</code> as follows:</p>\n\n<pre><code>@ECHO OFF\nSET \"PATH=C:\\Ruby26-x64\\bin;C:\\Program Files\\nodejs;%PATH%\"\nSET \"CurrentDirectory=%CD%\"\nCD /D \"%UserProfile%\\AppData\\Local\\GitHub\\PortableGit_*\\\"\nSET \"GitDirectory=%CD%\"\nCD /D \"%CurrentDirectory%\"\n\"%GitDirectory%/git-cmd.exe\" \"CALL rake build &amp; EXIT\"\nPAUSE\n</code></pre>\n\n<p>There was a useful conversation between me and someone else (I think his name was mony) but it was deleted, don't know why?!\nHe sent me this link with the difference between <code>&amp;</code> and <code>&amp;&amp;</code> between commands:\n<a href=\"https://stackoverflow.com/a/25344009/9586127\">https://stackoverflow.com/a/25344009/9586127</a></p>\n\n<p>The <code>&amp;</code> before the <code>EXIT</code> command in order to execute both commands independent on result of the first one. If <code>&amp;&amp;</code> is used, the <code>EXIT</code> command will be executed only if the first command succeeded (exit code 0).</p>\n\n<p>In addition, he told me a way to replace the lines 3:6 by one line to be:</p>\n\n<pre><code>FOR /D %%I IN (\"%LocalAppData%\\GitHub\\PortableGit_*\") DO SET \"GitDirectory=%%I\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9586127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b26079560a41b66b287181491b7039c?s=128&d=identicon&r=PG&f=1", "display_name": "M. Hamdi", "link": "https://stackoverflow.com/users/9586127/m-hamdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "accepted_answer_id": 58117393, "answer_count": 1, "score": 0, "last_activity_date": 1569520812, "creation_date": 1568716893, "last_edit_date": 1568718277, "question_id": 57972540, "link": "https://stackoverflow.com/questions/57972540/how-to-exit-git-cmd-exe-after-running-a-command-via-it-in-a-batch-file", "title": "How to exit &#39;git-cmd.exe&#39; after running a command via it in a batch file?", "body": "<p>I'm writing a batch file that runs a command via <code>git-cmd.exe</code> but it doesn't run the command(s) after it.</p>\n\n<p>I've tried to use <code>CALL</code>, <code>START /WAIT</code>, and <code>START /B /WAIT</code>. All have the same behavior. Maybe there is a parameter should be sent to <code>git-cmd.exe</code> to execute the command and exit but I didn't find any guide explaining how to use <code>git-cmd.exe</code>.</p>\n\n<p>This is a sample batch file:</p>\n\n<pre><code>@ECHO OFF\nSET \"PATH=C:\\Ruby26-x64\\bin;C:\\Program Files\\nodejs;%PATH%\"\nSET \"CurrentDirectory=%CD%\"\nCD /D \"%UserProfile%\\AppData\\Local\\GitHub\\PortableGit_*\\\"\nSET \"GitDirectory=%CD%\"\nCD /D \"%CurrentDirectory%\"\n\"%GitDirectory%/git-cmd.exe\" CALL rake build\nPAUSE\n</code></pre>\n\n<p>The command passed to <code>git-cmd.exe</code> is executed but the <code>PAUSE</code> command doesn't execute until I type <code>EXIT</code> command manually in the 'Command Prompt' window.</p>\n\n<p>I've also tried a simple <code>DIR</code> command instead of <code>rake build</code> but the same issue still occurs:</p>\n\n<pre><code>\"%GitDirectory%/git-cmd.exe\" DIR\nPAUSE\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "foreman", "procfile"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1568714662, "post_id": 57971284, "comment_id": 102353858, "body": "What is the foreman command you are running?"}, {"owner": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1568714935, "post_id": 57971284, "comment_id": 102353992, "body": "@Kris <code>foreman start</code>"}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1568715032, "post_id": 57971284, "comment_id": 102354044, "body": "What happens when you point a browser at <code>localhost:3000</code> (or whatever the port is)?"}, {"owner": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1568715907, "post_id": 57971284, "comment_id": 102354439, "body": "It returns an error <code>Could not get any response from server</code> when i try to fire an api from postman."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1568716068, "post_id": 57971284, "comment_id": 102354519, "body": "Are you sure you have the right port? Try hardcoding it in the Procfile."}, {"owner": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1568716230, "post_id": 57971284, "comment_id": 102354603, "body": "I tried <code>bundle exec rails server -p 3000</code> but still the same."}, {"owner": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1568716538, "post_id": 57971284, "comment_id": 102354745, "body": "@Kris Thanks hardcoding -p 3000 worked and i would like to know when i push it to production if removing -p 3000 will work ?"}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1568730402, "post_id": 57971284, "comment_id": 102362549, "body": "Removing <code>-p 3000</code> will mean the server starts on the default port, for webrick it is 3000, but for other servers it is different. I have posted an answer."}], "answers": [{"comments": [{"owner": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "edited": false, "score": 0, "creation_date": 1568791505, "post_id": 57974768, "comment_id": 102382294, "body": "My server is running when i hardcode 3000 but the application is not working in heroku. I guess heroku uses a different port for hosting applications do you know which port is it ?"}], "tags": [], "owner": {"reputation": 189, "user_id": 3978752, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e66d75a76c4af053305b0e2021788e7?s=128&d=identicon&r=PG&f=1", "display_name": "Rares R", "link": "https://stackoverflow.com/users/3978752/rares-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1568725134, "creation_date": 1568725134, "answer_id": 57974768, "question_id": 57971284, "link": "https://stackoverflow.com/questions/57971284/how-to-use-rails-server-and-bot-with-procfile-and-foreman/57974768#57974768", "title": "How to use rails server and bot with procfile and foreman?", "body": "<p>Try the following config:</p>\n\n<pre><code>web: bundle exec rails server -p 3000\nbot: rails runner -e development slackbot/slack.rb\n</code></pre>\n\n<p>Then run <code>foreman start -f Procfile</code> (or what file name you added)</p>\n\n<p>Access: <a href=\"http://localhost:3000\" rel=\"nofollow noreferrer\">http://localhost:3000</a></p>\n\n<p>Usually, I like using screen command to open the foreman process in the background, but this is not required here... it looks like: <code>screen foreman start -f Procfile</code> then I can just click ctrl + A + D to detach and the processes run in the background. This is useful for SSH connections e.g., EC2 instances.</p>\n"}, {"comments": [{"owner": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "edited": false, "score": 0, "creation_date": 1568791404, "post_id": 57976425, "comment_id": 102382233, "body": "When i hardcode port 3000 it works like a charm in development but when i push it on to heroku it doesn&#39;t start. Does heroku use a different port to run the application ?"}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "reply_to_user": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "edited": false, "score": 0, "creation_date": 1568795473, "post_id": 57976425, "comment_id": 102384339, "body": "Sorry, no idea. That is a different question."}, {"owner": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "edited": false, "score": 0, "creation_date": 1568967826, "post_id": 57976425, "comment_id": 102451566, "body": "I just used <code>-p $PORT</code> and heroku picks up the port they want all fine now thanks."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "reply_to_user": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "edited": false, "score": 0, "creation_date": 1569141216, "post_id": 57976425, "comment_id": 102493803, "body": "I&#39;m guessing Heroku sets the PORT env var."}, {"owner": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "edited": false, "score": 0, "creation_date": 1569217859, "post_id": 57976425, "comment_id": 102509967, "body": "Yes it does i was just trying to fix an issue before it happens."}], "tags": [], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "is_accepted": true, "score": 2, "last_activity_date": 1568730295, "creation_date": 1568730295, "answer_id": 57976425, "question_id": 57971284, "link": "https://stackoverflow.com/questions/57971284/how-to-use-rails-server-and-bot-with-procfile-and-foreman/57976425#57976425", "title": "How to use rails server and bot with procfile and foreman?", "body": "<p>It sounds like you perhaps need to specify the port, either set the environment var <code>PORT</code>:</p>\n\n<pre><code>export PORT=3000\nforeman start\n</code></pre>\n\n<p>or hardcode the port in <code>Procfile</code>:</p>\n\n<pre><code>web: bundle exec rails server -p 3000\n</code></pre>\n\n<p>or remove the <code>-p</code> option, in which case the default port will be used:</p>\n\n<pre><code>web: bundle exec rails server\n</code></pre>\n"}], "owner": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2383, "favorite_count": 0, "accepted_answer_id": 57976425, "answer_count": 2, "score": 4, "last_activity_date": 1568730295, "creation_date": 1568712440, "last_edit_date": 1568714953, "question_id": 57971284, "link": "https://stackoverflow.com/questions/57971284/how-to-use-rails-server-and-bot-with-procfile-and-foreman", "title": "How to use rails server and bot with procfile and foreman?", "body": "<p>I am trying to run my <code>rails server</code> and <code>slackbot</code> in two processes using <code>Procfile</code> and <code>gem 'foreman'</code>.</p>\n\n<p>But when I use <code>foreman start</code> the bot is only running the server is not starting up. I tried removing the line bot and tried to run web only but in that case, also my server is not starting up it just shows <code>started with pid 1502</code>. But when I start it from another terminal with <code>rails s</code> it starts up with no problem. I have googled a lot and can't seem to find out a solution for this. Help is much appreciated. Thanks.</p>\n\n<p>This is my Procfile :</p>\n\n<pre><code>web: bundle exec rails server -p $PORT\nbot: rails runner -e development slackbot/slack.rb\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "string"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1568705144, "post_id": 57969260, "comment_id": 102348756, "body": "<code>array.map(&amp;:split).map(&amp;:first)</code> or <code>array.map { |x| x.split.first }</code>"}], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 5, "last_activity_date": 1568705198, "creation_date": 1568705198, "answer_id": 57969298, "question_id": 57969260, "link": "https://stackoverflow.com/questions/57969260/sum-of-first-part-of-string-in-an-array-of-strings/57969298#57969298", "title": "Sum of first part of string in an array of strings", "body": "<p>Map with <a href=\"https://ruby-doc.org/core-2.6.3/String.html#method-i-split\" rel=\"noreferrer\"><code>#split</code></a>:</p>\n\n<pre><code>[\"5 Apple\", \"5 Orange\", \"15 Grapes\"].map{|s| s.split.first.to_i }.sum\n=&gt; 25\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3004, "user_id": 5830036, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/B2b06.png?s=128&g=1", "display_name": "Mayur Shah", "link": "https://stackoverflow.com/users/5830036/mayur-shah"}, "is_accepted": false, "score": 7, "last_activity_date": 1568705329, "creation_date": 1568705329, "answer_id": 57969329, "question_id": 57969260, "link": "https://stackoverflow.com/questions/57969260/sum-of-first-part-of-string-in-an-array-of-strings/57969329#57969329", "title": "Sum of first part of string in an array of strings", "body": "<p>I found the answer from your question.</p>\n\n<pre><code>[\"5 Apple\", \"5 Orange\", \"15 Grapes\"].map(&amp;:to_i).sum\n</code></pre>\n\n<p>In array if any integer convertable value is present then it will automatically convert into integer.</p>\n"}, {"tags": [], "owner": {"reputation": 130, "user_id": 9596049, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OECYS.png?s=128&g=1", "display_name": "harpocrates", "link": "https://stackoverflow.com/users/9596049/harpocrates"}, "is_accepted": false, "score": 1, "last_activity_date": 1568705702, "last_edit_date": 1568705702, "creation_date": 1568705355, "answer_id": 57969335, "question_id": 57969260, "link": "https://stackoverflow.com/questions/57969260/sum-of-first-part-of-string-in-an-array-of-strings/57969335#57969335", "title": "Sum of first part of string in an array of strings", "body": "<pre><code>[\"5 Apple\", \"5 Orange\", \"15 Grapes\"].sum { |w| w.split(' ').first.to_i }\n</code></pre>\n\n<p>Would do the trick.</p>\n"}, {"comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1568706141, "post_id": 57969369, "comment_id": 102349215, "body": "<code>sum</code> is enough. It has just the Ruby version as a constraint."}, {"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1568706270, "post_id": 57969369, "comment_id": 102349309, "body": "@SebastianPalma OP&#39;s question included <code>sum</code> so I suppose they have a relevant version. Even if they don&#39;t it&#39;s fairly likely they use ActiveSupport."}], "tags": [], "owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "is_accepted": false, "score": 4, "last_activity_date": 1568705498, "creation_date": 1568705498, "answer_id": 57969369, "question_id": 57969260, "link": "https://stackoverflow.com/questions/57969260/sum-of-first-part-of-string-in-an-array-of-strings/57969369#57969369", "title": "Sum of first part of string in an array of strings", "body": "<p><code>String#to_i</code> looks for digits at the start of the string and converts them to integers:</p>\n\n<pre><code>'Foo'.to_i   # =&gt; 0\n'5 Bar'.to_i # =&gt; 5\n'Baz 5'.to_i # =&gt; 0 \n</code></pre>\n\n<p>Hence just sum the result of <code>to_i</code>:</p>\n\n<pre><code>[\"5 Apple\", \"5 Orange\", \"15 Grapes\"].sum(&amp;:to_i) # =&gt; 25\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1568724107, "post_id": 57969507, "comment_id": 102358608, "body": "@EricDuminil You&#39;re right, I&#39;ve edited my answer. I&#39;ll delete it if you want to post it. Seems like the optimal solution here, too. Thanks for the suggestion"}], "tags": [], "owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "is_accepted": false, "score": 0, "last_activity_date": 1568724160, "last_edit_date": 1568724160, "creation_date": 1568705992, "answer_id": 57969507, "question_id": 57969260, "link": "https://stackoverflow.com/questions/57969260/sum-of-first-part-of-string-in-an-array-of-strings/57969507#57969507", "title": "Sum of first part of string in an array of strings", "body": "<p>I see this is now the most popular question in the Ruby section, so here's another way:</p>\n\n<pre><code>[\"5 Apple\", \"5 Orange\", \"15 Grapes\"].reduce(0) {|sum,n| sum + n.to_i}\n</code></pre>\n\n<p>Or as suggested by @EricDuminil, just:</p>\n\n<pre><code>[\"5 Apple\", \"5 Orange\", \"15 Grapes\"].sum(&amp;:to_i)\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 9261239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a31cd18c6e52b1b22980dec7cd9a868a?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Thomas", "link": "https://stackoverflow.com/users/9261239/robert-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 57969298, "answer_count": 5, "score": 5, "last_activity_date": 1568837932, "creation_date": 1568705029, "last_edit_date": 1568837932, "question_id": 57969260, "link": "https://stackoverflow.com/questions/57969260/sum-of-first-part-of-string-in-an-array-of-strings", "title": "Sum of first part of string in an array of strings", "body": "<p>I have an array of strings from which I need to extract the first words, convert them to integers and get the their sum.</p>\n\n<p>Example: </p>\n\n<pre><code>[\"5 Apple\", \"5 Orange\", \"15 Grapes\"]\n</code></pre>\n\n<p>Expected output =>  <code>25</code>  </p>\n\n<p>My attempt:</p>\n\n<pre><code>[\"5\",\"5\",\"15\"].map(&amp;:to_i).sum\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "capistrano"], "comments": [{"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1568699524, "post_id": 57968022, "comment_id": 102346388, "body": "first check <code>cap deploy:check</code> and fix that errors"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1568699593, "post_id": 57968022, "comment_id": 102346407, "body": "which system do you use mac or linux ?"}, {"owner": {"reputation": 181, "user_id": 12056738, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCuL72ScOoZdP6EV3wTrUKcRpHLcsQ8NjU3QNdsXw=k-s128", "display_name": "puja garg", "link": "https://stackoverflow.com/users/12056738/puja-garg"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1568699675, "post_id": 57968022, "comment_id": 102346452, "body": "i am using mac but my server is ubuntu"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1568699946, "post_id": 57968022, "comment_id": 102346553, "body": "you are firing this command from your local mac terminal. right?"}, {"owner": {"reputation": 181, "user_id": 12056738, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCuL72ScOoZdP6EV3wTrUKcRpHLcsQ8NjU3QNdsXw=k-s128", "display_name": "puja garg", "link": "https://stackoverflow.com/users/12056738/puja-garg"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1568700085, "post_id": 57968022, "comment_id": 102346601, "body": "yes i am firing it from my local mac machine"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1568701030, "post_id": 57968022, "comment_id": 102347002, "body": "did you run <code>ssh-add [yourkey]</code> command in your system?"}, {"owner": {"reputation": 303, "user_id": 1504487, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e19309940c028ed946afb3264e974269?s=128&d=identicon&r=PG", "display_name": "bennos", "link": "https://stackoverflow.com/users/1504487/bennos"}, "edited": false, "score": 0, "creation_date": 1598882906, "post_id": 57968022, "comment_id": 112593773, "body": "The error states the missing gems, see @Aar&#243;n Castro&#39;s answer below"}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 12056738, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCuL72ScOoZdP6EV3wTrUKcRpHLcsQ8NjU3QNdsXw=k-s128", "display_name": "puja garg", "link": "https://stackoverflow.com/users/12056738/puja-garg"}, "edited": false, "score": 1, "creation_date": 1568705156, "post_id": 57969113, "comment_id": 102348764, "body": "Thanx  @Daniel , after adding I am getting error : : expected 64-byte String, got 3 (SSHKit::Runner::ExecuteError)"}, {"owner": {"reputation": 722, "user_id": 3643211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kEAbU.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3643211/daniel"}, "reply_to_user": {"reputation": 181, "user_id": 12056738, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCuL72ScOoZdP6EV3wTrUKcRpHLcsQ8NjU3QNdsXw=k-s128", "display_name": "puja garg", "link": "https://stackoverflow.com/users/12056738/puja-garg"}, "edited": false, "score": 0, "creation_date": 1568717599, "post_id": 57969113, "comment_id": 102355278, "body": "@pujagarg What&#39;s is the version of net-ssh? If version is lower than 5.1.0 then try to run <code>ssh-add</code>  in your terminal or run <code>bundle update net-ssh</code>."}, {"owner": {"reputation": 181, "user_id": 12056738, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCuL72ScOoZdP6EV3wTrUKcRpHLcsQ8NjU3QNdsXw=k-s128", "display_name": "puja garg", "link": "https://stackoverflow.com/users/12056738/puja-garg"}, "edited": false, "score": 0, "creation_date": 1568722994, "post_id": 57969113, "comment_id": 102357992, "body": "Thanx @Daniel , my net-ssh version was 5.0.2 so i did <code>ssh-add</code> and it worked even after not adding those gems."}, {"owner": {"reputation": 722, "user_id": 3643211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kEAbU.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3643211/daniel"}, "reply_to_user": {"reputation": 181, "user_id": 12056738, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCuL72ScOoZdP6EV3wTrUKcRpHLcsQ8NjU3QNdsXw=k-s128", "display_name": "puja garg", "link": "https://stackoverflow.com/users/12056738/puja-garg"}, "edited": false, "score": 0, "creation_date": 1568791615, "post_id": 57969113, "comment_id": 102382359, "body": "@pujagarg Update net-ssh to 5.1 above, please."}], "tags": [], "owner": {"reputation": 722, "user_id": 3643211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kEAbU.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3643211/daniel"}, "is_accepted": false, "score": 1, "last_activity_date": 1568704441, "creation_date": 1568704441, "answer_id": 57969113, "question_id": 57968022, "link": "https://stackoverflow.com/questions/57968022/capistrano-deployment-error-in-rails-application/57969113#57969113", "title": "Capistrano deployment error in rails application", "body": "<p>Add those gems to your Gemfile,</p>\n\n<pre><code>gem 'rbnacl', '&lt; 5.0', :require =&gt; false                                                                                                                                                                \ngem 'rbnacl-libsodium', :require =&gt; false                                                                                                                                                               \ngem 'bcrypt_pbkdf', '&lt; 2.0', :require =&gt; false\n</code></pre>\n\n<p>and then run <code>bundle install</code> and try again.</p>\n"}, {"comments": [{"owner": {"reputation": 713, "user_id": 5648840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be04e1b63b846039df362ee78fde9ada?s=128&d=identicon&r=PG&f=1", "display_name": "tkhuynh", "link": "https://stackoverflow.com/users/5648840/tkhuynh"}, "edited": false, "score": 0, "creation_date": 1589386494, "post_id": 58835804, "comment_id": 109275564, "body": "This should be accepted as the correct answer. More detail at <a href=\"https://github.com/net-ssh/net-ssh/issues/478#issuecomment-275113659\" rel=\"nofollow noreferrer\">github.com/net-ssh/net-ssh/issues/478#issuecomment-275113659</a>"}], "tags": [], "owner": {"reputation": 1494, "user_id": 2446576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S8M7F.jpg?s=128&g=1", "display_name": "giapnh", "link": "https://stackoverflow.com/users/2446576/giapnh"}, "is_accepted": false, "score": 9, "last_activity_date": 1573643333, "creation_date": 1573643333, "answer_id": 58835804, "question_id": 57968022, "link": "https://stackoverflow.com/questions/57968022/capistrano-deployment-error-in-rails-application/58835804#58835804", "title": "Capistrano deployment error in rails application", "body": "<p>On Mac OS at least, you'll get this error if you don't ssh-add [yourkey] after system startup.</p>\n"}, {"tags": [], "owner": {"reputation": 159, "user_id": 3058437, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000977153494/picture?type=large", "display_name": "Aar&#243;n Castro", "link": "https://stackoverflow.com/users/3058437/aar%c3%b3n-castro"}, "is_accepted": false, "score": 3, "last_activity_date": 1588374581, "creation_date": 1588374581, "answer_id": 61552213, "question_id": 57968022, "link": "https://stackoverflow.com/questions/57968022/capistrano-deployment-error-in-rails-application/61552213#61552213", "title": "Capistrano deployment error in rails application", "body": "<p>My working solution:</p>\n\n<p>Gemfile</p>\n\n<pre><code>  gem 'net-ssh', '&gt;= 6.0.2'\n  gem 'ed25519', '&gt;= 1.2', '&lt; 2.0'\n  gem 'bcrypt_pbkdf', '&gt;= 1.0', '&lt; 2.0'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2263, "user_id": 97602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d94e00d9133d5bd761b1192fd6986aab?s=128&d=identicon&r=PG", "display_name": "Steve Hill", "link": "https://stackoverflow.com/users/97602/steve-hill"}, "is_accepted": false, "score": 4, "last_activity_date": 1591537773, "creation_date": 1591537773, "answer_id": 62246319, "question_id": 57968022, "link": "https://stackoverflow.com/questions/57968022/capistrano-deployment-error-in-rails-application/62246319#62246319", "title": "Capistrano deployment error in rails application", "body": "<p>Although you <em>can</em> get around this error by adding the gems suggested by the other answers, you don't necessarily <em>need</em> to do it this way.</p>\n\n<p>An alternative is to follow the advice given in the Known Issues for Puppet's Bolt tool, in particular <a href=\"https://puppet.com/docs/bolt/latest/bolt_known_issues.html#ssh-keys-generated-with-ssh-keygen-from-openssh-78-fail\" rel=\"nofollow noreferrer\">this one</a>.</p>\n\n<p>Just in case that link disappears, the solution is to generate your SSH keys in the PEM format rather than OpenSSH. You can do this by adding an extra option to your <code>ssh-keygen</code> command:</p>\n\n<pre><code>ssh-keygen -t rsa -m PEM\n</code></pre>\n\n<p>I've been able to successfully use this technique to avoid adding the extra gems.</p>\n"}, {"tags": [], "owner": {"reputation": 341, "user_id": 1777247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b3be6164272fbb6007466389e6dbf7b?s=128&d=identicon&r=PG", "display_name": "Juarez Lustosa", "link": "https://stackoverflow.com/users/1777247/juarez-lustosa"}, "is_accepted": false, "score": 18, "last_activity_date": 1593029328, "creation_date": 1593029328, "answer_id": 62563274, "question_id": 57968022, "link": "https://stackoverflow.com/questions/57968022/capistrano-deployment-error-in-rails-application/62563274#62563274", "title": "Capistrano deployment error in rails application", "body": "<p>For me just execute on terminal</p>\n<pre><code>ssh-add\n</code></pre>\n<p>And this worked.</p>\n"}], "owner": {"reputation": 181, "user_id": 12056738, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCuL72ScOoZdP6EV3wTrUKcRpHLcsQ8NjU3QNdsXw=k-s128", "display_name": "puja garg", "link": "https://stackoverflow.com/users/12056738/puja-garg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3357, "favorite_count": 0, "answer_count": 5, "score": 9, "last_activity_date": 1593029328, "creation_date": 1568699382, "question_id": 57968022, "link": "https://stackoverflow.com/questions/57968022/capistrano-deployment-error-in-rails-application", "title": "Capistrano deployment error in rails application", "body": "<p>I am getting this error on doing cap production deploy in my rails application\nmy net-ssh version is 5.0.2\ncan anyone please help me how i can fix this.\nMy server is Puma</p>\n\n<pre><code>#&lt;Thread:0x00007fe400cfb5e8@/Users/synup/.rvm/gems/ruby-2.5.1/gems/sshkit-1.17.0/lib/sshkit/runners/parallel.rb:10 run&gt; terminated with exception (report_on_exception is true):\nTraceback (most recent call last):\n    26: from /Users/synup/.rvm/gems/ruby-2.5.1/gems/sshkit-1.17.0/lib/sshkit/runners/parallel.rb:12:in `block (2 levels) in execute'\n    25: from /Users/synup/.rvm/gems/ruby-2.5.1/gems/sshkit-1.17.0/lib/sshkit/backends/abstract.rb:29:in `run'\n    24: from /Users/synup/.rvm/gems/ruby-2.5.1/gems/sshkit-1.17.0/lib/sshkit/backends/abstract.rb:29:in `instance_exec'\n    23: from /Users/synup/.rvm/gems/ruby-2.5.1/gems/capistrano-rvm-0.1.2/lib/capistrano/tasks/rvm.rake:9:in `block (3 levels) in &lt;top (required)&gt;'\n    22: from /Users/synup/.rvm/gems/ruby-2.5.1/gems/sshkit-1.17.0/lib/sshkit/backends/abstract.rb:64:in `capture'\n    21: from /Users/synup/.rvm/gems/ruby-2.5.1/gems/sshkit-1.17.0/lib/sshkit/backends/abstract.rb:145:in `create_command_and_execute'\n    20: from /Users/synup/.rvm/gems/ruby-2.5.1/gems/sshkit-1.17.0/lib/sshkit/backends/abstract.rb:145:in `tap'\n    19: from /Users/synup/.rvm/gems/ruby-2.5.1/gems/sshkit-1.17.0/lib/sshkit/backends/abstract.rb:145:in `block in create_command_and_execute'\n    18: from /Users/synup/.rvm/gems/ruby-2.5.1/gems/sshkit-1.17.0/lib/sshkit/backends/netssh.rb:129:in `execute_command'\n    17: from /Users/synup/.rvm/gems/ruby-2.5.1/gems/sshkit-1.17.0/lib/sshkit/backends/netssh.rb:176:in `with_ssh'\n    16: from /Users/synup/.rvm/gems/ruby-2.5.1/gems/sshkit-1.17.0/lib/sshkit/backends/connection_pool.rb:59:in `with'\n    15: from /Users/synup/.rvm/gems/ruby-2.5.1/gems/sshkit-1.17.0/lib/sshkit/backends/connection_pool.rb:59:in `call'\n    14: from /Users/synup/.rvm/gems/ruby-2.5.1/gems/net-ssh-5.0.2/lib/net/ssh.rb:246:in `start'\n    13: from /Users/synup/.rvm/gems/ruby-2.5.1/gems/net-ssh-5.0.2/lib/net/ssh/authentication/session.rb:71:in `authenticate'\n    12: from /Users/synup/.rvm/gems/ruby-2.5.1/gems/net-ssh-5.0.2/lib/net/ssh/authentication/session.rb:71:in `each'\n    11: from /Users/synup/.rvm/gems/ruby-2.5.1/gems/net-ssh-5.0.2/lib/net/ssh/authentication/session.rb:85:in `block in authenticate'\n    10: from /Users/synup/.rvm/gems/ruby-2.5.1/gems/net-ssh-5.0.2/lib/net/ssh/authentication/methods/publickey.rb:19:in `authenticate'\n     9: from /Users/synup/.rvm/gems/ruby-2.5.1/gems/net-ssh-5.0.2/lib/net/ssh/authentication/key_manager.rb:119:in `each_identity'\n     8: from /Users/synup/.rvm/gems/ruby-2.5.1/gems/net-ssh-5.0.2/lib/net/ssh/authentication/key_manager.rb:119:in `each'\n     7: from /Users/synup/.rvm/gems/ruby-2.5.1/gems/net-ssh-5.0.2/lib/net/ssh/authentication/key_manager.rb:122:in `block in each_identity'\n     6: from /Users/synup/.rvm/gems/ruby-2.5.1/gems/net-ssh-5.0.2/lib/net/ssh/authentication/methods/publickey.rb:20:in `block in authenticate'\n     5: from /Users/synup/.rvm/gems/ruby-2.5.1/gems/net-ssh-5.0.2/lib/net/ssh/authentication/methods/publickey.rb:62:in `authenticate_with'\n     4: from /Users/synup/.rvm/gems/ruby-2.5.1/gems/net-ssh-5.0.2/lib/net/ssh/authentication/key_manager.rb:142:in `sign'\n     3: from /Users/synup/.rvm/gems/ruby-2.5.1/gems/net-ssh-5.0.2/lib/net/ssh/key_factory.rb:44:in `load_private_key'\n     2: from /Users/synup/.rvm/gems/ruby-2.5.1/gems/net-ssh-5.0.2/lib/net/ssh/key_factory.rb:53:in `load_data_private_key'\n     1: from /Users/synup/.rvm/gems/ruby-2.5.1/gems/net-ssh-5.0.2/lib/net/ssh/key_factory.rb:113:in `classify_key'\n/Users/synup/.rvm/gems/ruby-2.5.1/gems/net-ssh-5.0.2/lib/net/ssh/authentication/ed25519_loader.rb:21:in `raiseUnlessLoaded': OpenSSH keys only supported if ED25519 is available (NotImplementedError)\nnet-ssh requires the following gems for ed25519 support:\n * ed25519 (&gt;= 1.2, &lt; 2.0)\n * bcrypt_pbkdf (&gt;= 1.0, &lt; 2.0)\ncap aborted!\nNotImplementedError: OpenSSH keys only supported if ED25519 is available\nnet-ssh requires the following gems for ed25519 support:\n * ed25519 (&gt;= 1.2, &lt; 2.0)\n * bcrypt_pbkdf (&gt;= 1.0, &lt; 2.0)\nSee https://github.com/net-ssh/net-ssh/issues/565 for more information\nGem::LoadError : \"ed25519 is not part of the bundle. Add it to your Gemfile.\"\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "methods", "square"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1568701345, "post_id": 57967038, "comment_id": 102347112, "body": "It would be helpful if you could explain, what <i>precisely</i> is unclear to you about <a href=\"https://ruby-doc.org/core/Array.html#class-Array-label-Accessing+Elements\" rel=\"nofollow noreferrer\">the documentation</a>. That way, the Ruby developers can improve the documentation so that future developers don&#39;t stumble over the same problems. Help make the world a better place!"}, {"owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1568755581, "post_id": 57967038, "comment_id": 102373633, "body": "@J&#246;rgWMittag Good luck with that. :)"}], "answers": [{"tags": [], "owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "is_accepted": true, "score": 3, "last_activity_date": 1568693036, "creation_date": 1568693036, "answer_id": 57967189, "question_id": 57967038, "link": "https://stackoverflow.com/questions/57967038/how-to-square-an-array-of-numbers-in-ruby-with-while-without-each-map-or-co/57967189#57967189", "title": "How to square an array of numbers in ruby with while without `each` `map` or `collect` methods?", "body": "<p>The easy way to do it is <code>map</code>, of course:</p>\n\n<pre><code>def square_array(numbers)\n    numbers.map { |e| e ** 2 }\nend \n</code></pre>\n\n<p>But here's what you have to do to do the same with a <code>while</code> loop (which is good practice).</p>\n\n<ol>\n<li>Create an array to contain the transformed data.</li>\n<li>Create a counter (you've done that).</li>\n<li>Set up your <code>while</code> loop (as you have it, except you don't need the <code>do</code> at the end).</li>\n<li>Write a statement that squares the array element whose index is the same as your counter, and pushes that result into the array you created in step 1.</li>\n<li>Increment your counter by 1 (you forgot to do that, so you'll be getting an endless loop since <code>count</code> will always equal zero).</li>\n<li>Return the array you created in step 1.</li>\n</ol>\n\n<p>That will do it for you! See if you can put that together, rather than me just giving you the code.</p>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1568695479, "post_id": 57967406, "comment_id": 102345232, "body": "I\u2019d better go with <code>while numbers.shift</code> later. That approach would work on infinite input enumerators, unlike <code>size</code>. This mutates the argument, though.."}, {"owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1568695787, "post_id": 57967406, "comment_id": 102345300, "body": "@AlekseiMatiushkin I think keeping the argument <code>numbers</code> unchanged is the whole point of returning a new array, so I will not use <code>shift</code>. Besides, if <code>numbers</code> is an infinite enumerator, then <code>square_array</code> will never return, maybe it&#39;s better to <code>yield</code> something in this case."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1568696131, "post_id": 57967406, "comment_id": 102345406, "body": "Yeah, agreed. <code>numbers.dup</code> in the first line would help to avoid mutating, but it\u2019d break the lazy enumeration, so I honestly dunno."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1568723473, "post_id": 57967406, "comment_id": 102358268, "body": "It looks like FORTRAN but I think it&#39;s the closest to what OP wanted."}, {"owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 0, "creation_date": 1568755960, "post_id": 57967406, "comment_id": 102373736, "body": "Does the size allocation up front outperform pushing values one by one onto an initially empty array?"}, {"owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "reply_to_user": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 1, "creation_date": 1568784112, "post_id": 57967406, "comment_id": 102379381, "body": "@BobRodes According to my benchmark (square 10 million integers), it&#39;s about 18% faster with pre-allocation than without it (0.641s vs 0.781s). Besides, <code>Array#map</code> is about 9% faster (0.720s) than the naive while loop (without pre-allocation). BTW, <code>Array#map</code> also preallocates the target array under the hood."}, {"owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 0, "creation_date": 1568862299, "post_id": 57967406, "comment_id": 102411568, "body": "@Aetherus Thanks very much, that&#39;s very interesting. Especially the part about <code>Array#map</code> pre-allocating the target array under the hood. I thought that might be the reason that you did the pre-allocation, but wasn&#39;t sure."}], "tags": [], "owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "is_accepted": false, "score": 2, "last_activity_date": 1568694847, "creation_date": 1568694847, "answer_id": 57967406, "question_id": 57967038, "link": "https://stackoverflow.com/questions/57967038/how-to-square-an-array-of-numbers-in-ruby-with-while-without-each-map-or-co/57967406#57967406", "title": "How to square an array of numbers in ruby with while without `each` `map` or `collect` methods?", "body": "<pre><code>def square_array(numbers)\n  # Allocate an array with the same size as `numbers`\n  # so that the runtime does not have to resize it from time to time\n  result = Array.new(numbers.size)\n\n  # The index\n  i = 0\n\n  while i &lt; numbers.size\n    # Fill the result array\n    result[i] = numbers[i] ** 2\n\n    # and don't forget to increase the index,\n    # otherwise the loop will run forever.\n    i += 1\n  end\n\n  # Return the result array\n  result\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 2, "creation_date": 1568701443, "post_id": 57967469, "comment_id": 102347145, "body": "If it mutates the original array, how is it &quot;more functional&quot;? Side-effects are pretty much the <i>opposite</i> of functional!"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1568701626, "post_id": 57967469, "comment_id": 102347225, "body": "@J&#246;rgWMittag By wrapping this function in <code>-&gt;(arr, map) { fun.([], arr.dup, map, fun)}</code> I could have eliminated <i>both</i> the necessity to pass <code>fun</code> as a name through <i>and</i> the side effect and I clearly stated it in the post scriptum. I decided not to do this to make the code shorter. OK, I will do."}, {"owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 0, "creation_date": 1568755869, "post_id": 57967469, "comment_id": 102373706, "body": "This is very interesting stuff, although I can&#39;t imagine the OP having a clue what you&#39;re up to! I&#39;m sure it will be useful to someone else, though."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1568701760, "last_edit_date": 1568701760, "creation_date": 1568695367, "answer_id": 57967469, "question_id": 57967038, "link": "https://stackoverflow.com/questions/57967038/how-to-square-an-array-of-numbers-in-ruby-with-while-without-each-map-or-co/57967469#57967469", "title": "How to square an array of numbers in ruby with while without `each` `map` or `collect` methods?", "body": "<p>The more functional approach would be to use recursion.</p>\n\n<pre><code>fun =\n  -&gt;(acc = [], arr, map, fun) {\n    arr.empty? ? acc : fun.(acc &lt;&lt; map.(arr.shift), arr, map, fun)\n  }\n#\u21d2 #&lt;Proc:0x000055ab64333fa0@(pry):12 (lambda)&gt;\n</code></pre>\n\n<p>And for any mapper (e. g. square root,) use it like:</p>\n\n<pre><code>fun.([1,2,3,4,5], -&gt;(e) { e ** 2 }, fun)\n#\u21d2 [1, 4, 9, 16, 25]\n</code></pre>\n\n<p>Please note! This approach <em>mutates</em> the initial array, so it should be explicitly <code>array.dup</code>\u2019ed  before passing to the function. To eliminate the necessity to pass the function itself through <em>and</em> leave the initial array intact, we would need a wrapper.</p>\n\n<pre><code>fun =\n  -&gt;(acc = [], arr, map, fun) {\n    arr.empty? ? acc : fun.(acc &lt;&lt; map.(arr.shift), arr, map, fun)\n  }\n#\u21d2 #&lt;Proc:0x000055ab64333fa0@(pry):12 (lambda)&gt;\nmapper = -&gt;(arr, map) { fun.([], arr.dup, map, fun) }\n</code></pre>\n\n<p>And use it like:</p>\n\n<pre><code>arr = [1,2,3,4,5]\nmapper.(arr, -&gt;(e) { e ** 2 })\n#\u21d2 [1, 4, 9, 16, 25]\narr\n#\u21d2 [1, 2, 3, 4, 5]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "edited": false, "score": 0, "creation_date": 1568756235, "post_id": 57969004, "comment_id": 102373812, "body": "Interesting approach, using an external iterator and <code>loop</code> so as not to have to increment and keep track of a counter."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1568704533, "last_edit_date": 1568704533, "creation_date": 1568704007, "answer_id": 57969004, "question_id": 57967038, "link": "https://stackoverflow.com/questions/57967038/how-to-square-an-array-of-numbers-in-ruby-with-while-without-each-map-or-co/57969004#57969004", "title": "How to square an array of numbers in ruby with while without `each` `map` or `collect` methods?", "body": "<pre><code>def sq(arr)\n  enum = arr.each\n  a = []\n  loop do\n    n = enum.next\n    a &lt;&lt; n*n\n  end\n  a\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>sq [1, 2, 3, 4]\n  #=&gt; [1, 4, 9, 16]\n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/core-2.6.3/Array.html#method-i-each\" rel=\"nofollow noreferrer\">Array#each</a>, <a href=\"https://ruby-doc.org/core-2.6.3/Kernel.html#method-i-loop\" rel=\"nofollow noreferrer\">Kernel#loop</a> and <a href=\"https://ruby-doc.org/core-2.6.3/Enumerator.html\" rel=\"nofollow noreferrer\">Enumerator#next</a>. One could use <a href=\"https://ruby-doc.org/core-2.6.3/Object.html#method-i-to_enum\" rel=\"nofollow noreferrer\">Kernel#to_enum</a> (documented in <a href=\"https://ruby-doc.org/core-2.6.3/Object.html\" rel=\"nofollow noreferrer\">Object</a>) in place of <code>Array#each</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1568723998, "creation_date": 1568723998, "answer_id": 57974419, "question_id": 57967038, "link": "https://stackoverflow.com/questions/57967038/how-to-square-an-array-of-numbers-in-ruby-with-while-without-each-map-or-co/57974419#57974419", "title": "How to square an array of numbers in ruby with while without `each` `map` or `collect` methods?", "body": "<p>Using a for loop?</p>\n\n<pre><code>ary = [1,2,3]\n\nres = []\nfor n in ary do\n  res &lt;&lt; n ** 2\nend\n\nres\n#=&gt; [1, 4, 9]\n</code></pre>\n\n<p>But better you stick with <code>map</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11866214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqpFI.jpg?s=128&g=1", "display_name": "Ching Wang", "link": "https://stackoverflow.com/users/11866214/ching-wang"}, "is_accepted": false, "score": 0, "last_activity_date": 1568750165, "creation_date": 1568750165, "answer_id": 57981233, "question_id": 57967038, "link": "https://stackoverflow.com/questions/57967038/how-to-square-an-array-of-numbers-in-ruby-with-while-without-each-map-or-co/57981233#57981233", "title": "How to square an array of numbers in ruby with while without `each` `map` or `collect` methods?", "body": "<p>Here is my solution:</p>\n\n<pre><code>def square_array(numbers)\n  new_array = []\n  counter = 0 \n  while counter &lt; numbers.length()\n  new_array.push(numbers[counter] * numbers[counter])\n  counter += 1\n  end \n  return new_array\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14908721, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14Gg1nQKcdlgrESSk61j-JPqaexnCtduxRqLH5IUt-g=k-s128", "display_name": "Roman Turner", "link": "https://stackoverflow.com/users/14908721/roman-turner"}, "is_accepted": false, "score": 0, "last_activity_date": 1611059940, "last_edit_date": 1611059940, "creation_date": 1611035163, "answer_id": 65786098, "question_id": 57967038, "link": "https://stackoverflow.com/questions/57967038/how-to-square-an-array-of-numbers-in-ruby-with-while-without-each-map-or-co/65786098#65786098", "title": "How to square an array of numbers in ruby with while without `each` `map` or `collect` methods?", "body": "<p>Without using each, map, or collect.</p>\n<pre class=\"lang-rb prettyprint-override\"><code>def square_array(array)\n new_array = []\n  array.length.times do |index|\n  new_array.push(array[index] ** 2)\n  end\n new_array\nend\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12077241, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214550391982738/picture?type=large", "display_name": "Natali Kru", "link": "https://stackoverflow.com/users/12077241/natali-kru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1370, "favorite_count": 0, "accepted_answer_id": 57967189, "answer_count": 7, "score": 0, "last_activity_date": 1611059940, "creation_date": 1568691672, "last_edit_date": 1568691769, "question_id": 57967038, "link": "https://stackoverflow.com/questions/57967038/how-to-square-an-array-of-numbers-in-ruby-with-while-without-each-map-or-co", "title": "How to square an array of numbers in ruby with while without `each` `map` or `collect` methods?", "body": "<p>I'm new to coding in RUBY. I'm trying to write a method that squares each element in an array of numbers and returns a new array of these numbers squared. Trying to use while loop and NOT use <code>each</code>, <code>collect</code>, or <code>map</code>. Having trouble understanding how to index/loop each individual element of array and square is (**). </p>\n\n<p>This is what makes sense to me but I know its wrong. </p>\n\n<pre><code>def square_array(numbers)\n  count = 0\n  while count &lt; numbers.length do\n    numbers.index ** 2 \n  end\n  square_array(numbers)\nend \n</code></pre>\n\n<p>Will anyone please help me? Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "multithreading", "csv", "constants"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1568691699, "post_id": 57966806, "comment_id": 102344569, "body": "No idea, but why wouldn&#39;t you just use a Mutex to be sure?"}, {"owner": {"reputation": 2174, "user_id": 3448554, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/j7RcG.jpg?s=128&g=1", "display_name": "Kelsey Hannan", "link": "https://stackoverflow.com/users/3448554/kelsey-hannan"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1568694545, "post_id": 57966806, "comment_id": 102345048, "body": "What would using a Mutex here look like?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1568694623, "post_id": 57966806, "comment_id": 102345068, "body": "&quot;constants defined as lambda&#39;s (but not procs) can be trusted to reliably invoke uniquely each time&quot; \u2014 I have no idea what that would mean, nor can find any mention of it in the article.  The fact that you got two same results with proc just means you executed them too fast, so the time didn&#39;t have... err, time... to change. The article also is not at all about thread safety. All <code>Proc</code> objects (regardless of whether obtained through <code>lambda</code>, <code>proc</code> or <code>-&gt;</code>) are immutable, so they have zero impact on thread safety (though their contents certainly can be thread-safe or not)."}, {"owner": {"reputation": 2174, "user_id": 3448554, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/j7RcG.jpg?s=128&g=1", "display_name": "Kelsey Hannan", "link": "https://stackoverflow.com/users/3448554/kelsey-hannan"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1568699345, "post_id": 57966806, "comment_id": 102346302, "body": "@Amadan Thanks for pointing that out, I ran the code locally again and updated my example.  I&#39;ve confirmed only <code>Foo::BEGINBLOCK</code> and <code>Foo::METHODBLOCK</code> fail to reinvoke <code>Time.now</code>."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1568699464, "post_id": 57966806, "comment_id": 102346362, "body": "Neither of them are <code>Proc</code>; they are the result of the excecution of the expression you gave them (a <code>Date</code>, in this case)."}, {"owner": {"reputation": 2174, "user_id": 3448554, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/j7RcG.jpg?s=128&g=1", "display_name": "Kelsey Hannan", "link": "https://stackoverflow.com/users/3448554/kelsey-hannan"}, "edited": false, "score": 0, "creation_date": 1568699789, "post_id": 57966806, "comment_id": 102346490, "body": "If a proc or lambda is passed an AR object with queries like my example, will each thread evaluate the AR objects passed into them from a CONSTANT uniquely without sharing state?  I.e. is the <code>referral</code> variable inside the proc/lambda closed off to other threads?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1568705648, "post_id": 57966806, "comment_id": 102348980, "body": "@KelseyHannan I understand why it&#39;s a bit confusing .... Highly recommend reading up on mutability in Ruby, and how to use a mutex to remove race conditions in multithreaded code. There is no visible multithreading going on but I can&#39;t rule out that it could happen (if you&#39;re using a multithreaded webserver, and this service is called from a controller action, for example). For this question&#39;s sake I would recommend boiling it down to a hypothetical scenario you think you <i>would</i> have the race condition, maybe a shorter snippet of code"}, {"owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 0, "creation_date": 1568717688, "post_id": 57966806, "comment_id": 102355332, "body": "<i>I know constants defined as dynamic methods is discouraged in the ruby community</i> - sorry, can you mention a source of this statement?"}], "answers": [{"tags": [], "owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "is_accepted": false, "score": 1, "last_activity_date": 1612164029, "creation_date": 1612164029, "answer_id": 65988579, "question_id": 57966806, "link": "https://stackoverflow.com/questions/57966806/is-it-thread-safe-to-call-ruby-constants-with-a-stabby-lambda/65988579#65988579", "title": "Is it thread safe to call ruby constants with a stabby lambda?", "body": "<p>Regarding whether or not the lambda is thread safe, the answer is the same as it would be for a method; it depends on what you do inside the lambda. As long as you are not making modifications in multiple threads to shared state (e.g. the same object), you're ok.</p>\n<p>When an instance of your <code>Foo</code> class is created, the <code>LAMBDA</code> constant is created, and initialized with the lambda object on the right side of <code>=</code>. Subsequently, every reference of <code>LAMBDA</code> returns that lambda instance.</p>\n<p>It is safe to reference <code>LAMBDA</code> from multiple threads because it is simply returning on object. However, although <em>referencing</em> <code>LAMBDA</code> may be safe, that doesn't necessarily mean that <em>executing</em> it is safe. That depends on the content of the lambda. If the lambda contains code that modifies any shared state, that might be a problem. It looks like your referral object used inside the lambda is merely reading data. That should be fine.</p>\n<p>It doesn't matter whether it's a lambda, a method, or a block passed to <code>Thread.new</code>; it just matters what code is being executed inside that thread.</p>\n<p>One thing I don't understand is, if the <code>call</code> method is getting <em>all</em> the referrals, how does Sidekiq know how to divide that into multiple jobs/threads? It seems to me that this job would run in its entirety in a single thread; in which case the question is moot, no? But then I'm not familiar with Sidekiq so I may be wrong.</p>\n<p>Some other points:</p>\n<ul>\n<li>Please, please do not use the <code>[]</code> notation to call a lambda. Yes, it is legal, but it is unnecessarily confusing and misleading. Much better to use <code>.call</code> or <code>.()</code> (my favorite).</li>\n<li>when you say &quot; a constant that equals a stabby lambda&quot;, you imply that a stabby lambda object is different from a non-stabby lambda object. Either way it is a lambda object; the stabby is just an <em>abbreviated notation used to create it</em>.</li>\n<li>Similarly, &quot;constants defined as lambda and procs can be trusted to reliably invoke uniquely each time&quot; reveals a misunderstanding of what a lambda or proc is...that's like saying that a <em>method</em> &quot;can be trusted to reliably invoke uniquely each time&quot;; <em>of course</em> it can. A constant is like a variable in that it is a reference to an object. It doesn't add any functionality to the thing it refers to.</li>\n</ul>\n<p>If you'd like to research lambdas further, I've given some talks and written some articles about them. Here are some resources:</p>\n<ul>\n<li>Ruby Lambdas Presentation: <a href=\"https://www.youtube.com/watch?v=zvQ_K2Edu-Y\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=zvQ_K2Edu-Y</a></li>\n<li>Slides for above: <a href=\"https://speakerdeck.com/keithrbennett/functional-programming-in-ruby-with-lambdas-1e80e559-90bd-4e73-acef-86e84ff209f3\" rel=\"nofollow noreferrer\">https://speakerdeck.com/keithrbennett/functional-programming-in-ruby-with-lambdas-1e80e559-90bd-4e73-acef-86e84ff209f3</a></li>\n<li>Blog (multiple articles about lambdas): <a href=\"https://blog.bbs-software.com/blog\" rel=\"nofollow noreferrer\">https://blog.bbs-software.com/blog</a></li>\n</ul>\n"}], "owner": {"reputation": 2174, "user_id": 3448554, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/j7RcG.jpg?s=128&g=1", "display_name": "Kelsey Hannan", "link": "https://stackoverflow.com/users/3448554/kelsey-hannan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1612164029, "creation_date": 1568689538, "last_edit_date": 1568699142, "question_id": 57966806, "link": "https://stackoverflow.com/questions/57966806/is-it-thread-safe-to-call-ruby-constants-with-a-stabby-lambda", "title": "Is it thread safe to call ruby constants with a stabby lambda?", "body": "<p>Is it thread-safe to call ruby/rails <code>CONSTANTS</code> with a stabby lambda or proc?</p>\n\n<p>I know constants defined as dynamic methods is discouraged in the ruby community, as constant definitions, on their own, are not thread-safe and can function dangerously like global variables subject to race conditions.</p>\n\n<p>However, if you define a constant to receive a stabby lambda or proc, could that make the code thread-safe?</p>\n\n<p>E.g. this blog post <a href=\"https://6ftdan.com/allyourdev/2015/02/27/value-assignment-and-deferment-with-lambdasprocs/\" rel=\"nofollow noreferrer\">on defining constants using procs/lambda's</a> suggests that constants defined as lambda and procs can be trusted to reliably invoke uniquely each time:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Foo\n  LAMBDA = lambda {Time.now}\n  PROC = proc {Time.now}\n  STABBYLAMBDA = -&gt;{Time.now}\n  BEGINBLOCK = begin Time.now end\n\n  def Foo.the_time\n    Time.now\n  end\n  METHODBLOCK = Foo.the_time\nend\n\nFoo::LAMBDA[]\n# =&gt; 2019-09-16 22:39:51 -0700\nFoo::LAMBDA[]\n# =&gt; 2019-09-16 22:39:53 -0700\nFoo::PROC[]\n# =&gt; 2019-09-16 22:39:55 -0700 \nFoo::PROC[]\n# =&gt; 2019-09-16 22:39:57 -0700 \nFoo::STABBYLAMBDA[]\n# =&gt; 2019-09-16 22:39:59 -0700 \nFoo::STABBYLAMBDA[]\n# =&gt; 2019-09-16 22:40:01 -0700 \nFoo::BEGINBLOCK\n# =&gt; 2019-09-16 22:39:51 -0700\nFoo::BEGINBLOCK\n# =&gt; 2019-09-16 22:39:51 -0700\nFoo::METHODBLOCK\n# =&gt; 2019-09-16 22:39:51 -0700 \nFoo::METHODBLOCK\n# =&gt; 2019-09-16 22:39:51 -0700\n</code></pre>\n\n<p>But does that extend to thread safety too?</p>\n\n<hr>\n\n<p>E.g. in this code I have a Rails Service Object that runs in multi-threaded Sidekiq that extracts data for uploading CSVs:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>\nclass ExportReferralData &lt; ServiceObject\n\n\n  EXPORT_COLUMNS = [\"Referrer_phone_number\", \"Referrer_ID\", \"Referee_phone_number\", \"Referee_ID\", \"Date_Approved\"].freeze\n\n  EXPORT_ROW = -&gt;(referral){\n    [referral.customer.identifier, referral.customer.accountable.internal_identifier, referral.friend.identifier, referral.friend.accountable.internal_identifier, referral.approved_at.strftime(\"%Y%m%d%H%M\")]\n  }\n\n\n  def initialize\n  end\n\n  def call\n    data = data_for_csv( Referral.all )\n\n    UploadFile.put(file_path) do |file|\n      create_csv(file, data)\n    end\n  end\n\n  private\n\n  def data_for_csv(active_record_query_result)\n    active_record_query_result.inject([]) do |result, item|\n      result &lt;&lt; EXPORT_ROW.call(item)\n    end\n  end\n\n\n  def create_csv(file, export_data)\n    CSV(file, headers:true, force_quotes: true) do |csv|\n      csv &lt;&lt; EXPORT_COLUMNS\n      export_data.each do |export_row|\n        csv &lt;&lt; export_row\n      end\n    end\n    file.rewind\n  end\n\n  def file_path\n    \"upload/APPROVED_#{Time.current.strftime(\"%Y%m%d%H%M\")}.csv\"\n  end\nend\n</code></pre>\n\n<p>This multi-threaded code defines <code>EXPORT_ROW</code> to be a constant that equals a stabby lambda (not a proc), which then takes any <code>referral</code> ActiveRecord object it gets passed to build each CSV row dynamically.  This local variable inside the lambda then calls ActiveRecord queries.</p>\n\n<p>Stylistically I like how this code looks, but I want to be sure that my use of <code>EXPORT_ROW.call(item)</code> here is actually thread-safe, especially when invoking methods like ActiveRecord queries.</p>\n\n<p>Any help much appreciated!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "hash"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1568689362, "post_id": 57966657, "comment_id": 102344215, "body": "<a href=\"https://es.stackoverflow.com/\">es.stackoverflow.com</a>"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1568695272, "post_id": 57966657, "comment_id": 102345186, "body": "<a href=\"https://pt.stackoverflow.com/\">pt.stackoverflow.com</a>"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1568701572, "post_id": 57966657, "comment_id": 102347207, "body": "Are you maybe looking for <a href=\"https://pt.stackoverflow.com\">Stack Overflow em Portugu\u00eas</a>?"}], "answers": [{"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 0, "last_activity_date": 1568689844, "creation_date": 1568689844, "answer_id": 57966845, "question_id": 57966657, "link": "https://stackoverflow.com/questions/57966657/sum-the-rows-according-to-the-columns/57966845#57966845", "title": "Sum the rows according to the columns", "body": "<pre><code>list = [\n  {:adv=&gt;{:a=&gt;10, :b=&gt;180, :c=&gt;30, :d=&gt;15}},\n  {:adv=&gt;{:a=&gt;15, :b=&gt;120, :c=&gt;60, :d=&gt;100}},\n  {:adv=&gt;{:a=&gt;20, :b=&gt;120, :c=&gt;90, :d=&gt;25}}\n]\n\nresult = list.reduce do |memo, hsh|\n  {\n    adv: memo[:adv].merge(hsh[:adv]) do |key, val1, val2|\n      val1 + val2\n    end\n  }\nend\n\nputs result\n# =&gt; {:adv=&gt;{:a=&gt;45, :b=&gt;420, :c=&gt;180, :d=&gt;140}}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12077084, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xe0NX9R7rZ4/AAAAAAAAAAI/AAAAAAAAA2g/XVuObYyF9ak/photo.jpg?sz=128", "display_name": "Edinaldo Alves", "link": "https://stackoverflow.com/users/12077084/edinaldo-alves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1568722762, "creation_date": 1568688107, "last_edit_date": 1568722762, "question_id": 57966657, "link": "https://stackoverflow.com/questions/57966657/sum-the-rows-according-to-the-columns", "title": "Sum the rows according to the columns", "body": "<p>I need to sum the values \u200b\u200bof each hash line based on the keys.</p>\n\n<p>In the example below, I need to add A with A, B with B, C with C, D with D of all rows and at the end return a single hash with the full value.</p>\n\n<pre><code>{adv=&gt;{:a=&gt;10, :b=&gt;180, :c=&gt;30, :d=&gt;15}}\n\n{adv=&gt;{:a=&gt;15, :b=&gt;120, :c=&gt;60, :d=&gt;100}}\n\n{adv=&gt;{:a=&gt;20, :b=&gt;120, :c=&gt;90, :d=&gt;25}}\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2397, "user_id": 9038475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7f74f49de917e716f4d679473e70f4?s=128&d=identicon&r=PG&f=1", "display_name": "Geshode", "link": "https://stackoverflow.com/users/9038475/geshode"}, "edited": false, "score": 0, "creation_date": 1568687908, "post_id": 57966597, "comment_id": 102343954, "body": "You could create your own reverse function, that way you could use your current comparison and you wouldn&#39;t use the built-in function."}, {"owner": {"reputation": 4998, "user_id": 1404425, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/wsCfz.jpg?s=128&g=1", "display_name": "Arman H", "link": "https://stackoverflow.com/users/1404425/arman-h"}, "edited": false, "score": 0, "creation_date": 1568688125, "post_id": 57966597, "comment_id": 102343996, "body": "Split the string into an array of characters, iterate over the array and check if the current character is the same as the one in a corresponding position on the opposite end."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1568701972, "post_id": 57966597, "comment_id": 102347373, "body": "Can you specify what you mean by &quot;not allowed to use built-in functions&quot;? For example, <a href=\"https://stackoverflow.com/a/57966826/2988\">Cary Swoveland&#39;s answer</a> uses no less than <i>eight</i> &quot;built-in functions&quot; (<code>String#size</code>, <code>Integer#&#47;</code>, <code>Integer#times</code>, <code>Enumerable#all?</code>, <code>String#[]</code>, <code>String#==</code>, <code>Integer#-@</code>, and <code>Integer#-</code>). <a href=\"https://stackoverflow.com/a/57966810/2988\">Aetherus&#39;s answer</a> uses eight for the first solution and six for the second. <a href=\"https://stackoverflow.com/a/57966713/2988\">Emu&#39;s partial answer</a> uses three just to implement reversing the string, and you will need at least one more."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1568702265, "post_id": 57966597, "comment_id": 102347477, "body": "Here is a question on <a href=\"https://codereview.stackexchange.com\">Code Review</a> that may be of interest to you: <a href=\"https://codereview.stackexchange.com/q/121004/1581\">Find a palindrome using Ruby</a>."}], "answers": [{"tags": [], "owner": {"reputation": 5242, "user_id": 3083848, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/JMddU.jpg?s=128&g=1", "display_name": "Emu", "link": "https://stackoverflow.com/users/3083848/emu"}, "is_accepted": false, "score": -1, "last_activity_date": 1568688654, "creation_date": 1568688654, "answer_id": 57966713, "question_id": 57966597, "link": "https://stackoverflow.com/questions/57966597/how-to-check-if-a-word-is-a-palindrome-without-using-string-reverse-method-in/57966713#57966713", "title": "How to check if a word is a palindrome without using &quot;string.reverse&quot; method in Ruby?", "body": "<p>Another way to reverse the string without <code>.reverse</code> is </p>\n\n<p><code>\"11211\".chars.reduce { |x, y| y + x }  # =&gt; \"11211\"</code></p>\n\n<p>so, you can also check this way too. </p>\n"}, {"tags": [], "owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "is_accepted": false, "score": 1, "last_activity_date": 1568690422, "last_edit_date": 1568690422, "creation_date": 1568689556, "answer_id": 57966810, "question_id": 57966597, "link": "https://stackoverflow.com/questions/57966597/how-to-check-if-a-word-is-a-palindrome-without-using-string-reverse-method-in/57966810#57966810", "title": "How to check if a word is a palindrome without using &quot;string.reverse&quot; method in Ruby?", "body": "<p>The most classical solution: compare the first character with the last character, if they are the same, compare the second character with the second last character..., until you find a pair of different characters or you have exausted the whole string (except the charater in the middle if the string has a odd length).</p>\n\n<pre><code>def palindrome?(string)\n  (string.length / 2).times.reduce(true) do |palindrome, i|\n    palindrome &amp;&amp; string[i] == string[-i - 1]\n  end\nend\n</code></pre>\n\n<p>And here's a tail-recursive solution just for fun (Neither MRI nor JRuby optimizes tail recursion):</p>\n\n<pre><code>def palindrome?(string, i = 0, j = string.length - 1)\n  return true if i &gt;= j\n  string[i] == string[j] &amp;&amp; palindrome?(string, i + 1, j - 1)\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "edited": false, "score": 0, "creation_date": 1568689903, "post_id": 57966826, "comment_id": 102344304, "body": "Nice solution using <code>all?</code>"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 4, "last_activity_date": 1568689672, "creation_date": 1568689672, "answer_id": 57966826, "question_id": 57966597, "link": "https://stackoverflow.com/questions/57966597/how-to-check-if-a-word-is-a-palindrome-without-using-string-reverse-method-in/57966826#57966826", "title": "How to check if a word is a palindrome without using &quot;string.reverse&quot; method in Ruby?", "body": "<pre><code>def pal(str) \n  (str.size/2).times.all? { |i| str[i] == str[-i-1] }\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>pal \"11211\"  #=&gt; true\npal \"1\"      #=&gt; true\npal \"\"       #=&gt; true\npal \"12111\"  #=&gt; false\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12075034, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCvDldNDh871fQFCETQx6i67vDTJ5J3KczLg7mH=k-s128", "display_name": "Julie Song", "link": "https://stackoverflow.com/users/12075034/julie-song"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 603, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1568690422, "creation_date": 1568687544, "last_edit_date": 1568688223, "question_id": 57966597, "link": "https://stackoverflow.com/questions/57966597/how-to-check-if-a-word-is-a-palindrome-without-using-string-reverse-method-in", "title": "How to check if a word is a palindrome without using &quot;string.reverse&quot; method in Ruby?", "body": "<p>I'm trying to use Ruby to check if a word is a palindrome, but I'm not allowed to use built-in functions like <code>str.reverse</code>. How should I tackle this problem?</p>\n\n<p>Below is the code with the <code>.reverse</code> method, it works, but I'm not sure how to check if a word is a palindrome without the <code>.reverse</code>.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def palindrome(word)\n  i = 0\n  if word.reverse == word\n    puts \"#{word} is a palindrome!\"\n  else\n    puts \"#{word} is not a palindrome\"\n  end\nend\n\nputs palindrome(\"peep\")\n</code></pre>\n\n<p>It should print something like \"racecar is a palindrome!\".</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1568673899, "post_id": 57965137, "comment_id": 102341360, "body": "you&#39;re generating a CSV file per each AdminPanelLog record. Is this intended?"}, {"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "reply_to_user": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1568674511, "post_id": 57965137, "comment_id": 102341472, "body": "@JoshBrody I want to have a solution that will reflect this scenario - user want to have all admin logs form 01.2019 till 07.2019 and those data should be in one CSV file. AdminPanelLog is a model which store specific data like <code>action_type</code>, <code>admin_email</code> etc."}, {"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1568676905, "post_id": 57965137, "comment_id": 102341921, "body": "You&#39;re iterating over each AdminPanelLog and generating a new CSV file. You need to reverse that order."}, {"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "reply_to_user": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1568677275, "post_id": 57965137, "comment_id": 102341996, "body": "I don&#39;t understand, how to do so? I thought it was enough to create csv file in case like I wrote before."}], "owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568673011, "creation_date": 1568673011, "question_id": 57965137, "link": "https://stackoverflow.com/questions/57965137/how-to-assign-specific-csv-headers-to-a-specific-data-in-rails-csv-generator", "title": "How to assign specific CSV headers to a specific data in Rails CSV generator", "body": "<p>I'm trying to implement CSV file generator for admin logs. The thing is I want to have table with data like below:</p>\n\n<pre><code>Date &amp; time | Action     | Acting User | Old Data | New Data\n------------|------------|-------------|----------|----------\ncreated_at  | action_type| admin_email | old_data | new_data\n</code></pre>\n\n<p>I don't know how to assign those headers (data&amp;time, action, etc.) to a specific row (created_at, action_type, etc.)</p>\n\n<p>This is what I have right now</p>\n\n<pre><code>class CsvAdminLogGenerator\n  LOG_HEADERS = ['Date&amp;Time', 'Action', 'Acting User', 'Old Data', 'New Data'].freeze\n\n  def initialize(start_date:, end_date:)\n    @start_date = start_date\n    @end_date = end_date\n  end\n\n  def build_csv_file\n    AdminPanelLog.dates_between(start_date, end_date).each do |admin_log|\n      CSV.generate(headers: LOG_HEADERS, col_sep: ';', encoding: 'UTF-8') do |csv|\n        csv &lt;&lt; admin_log.created_at\n        csv &lt;&lt; admin_log.action_type\n        csv &lt;&lt; admin_log.admin_email\n        csv &lt;&lt; admin_log.old_data\n        csv &lt;&lt; admin_log.new_data\n      end\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1568664930, "post_id": 57963776, "comment_id": 102338731, "body": "Why don&#39;t you just delete the friendship? <code>friendships.where(friend: friend).delete_all</code>"}, {"owner": {"reputation": 53, "user_id": 10723638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bae4d4acdc561ff872e420dafeab7de5?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/10723638/victor"}, "reply_to_user": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1568729692, "post_id": 57963776, "comment_id": 102362105, "body": "I&#39;ve that that but then in the Friendship the &quot;destroy_inverse_relationship&quot; is called and deletes the User"}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1568737400, "post_id": 57963776, "comment_id": 102366244, "body": "what does <code>destroy_inverse_relationship</code> do?"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 10723638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bae4d4acdc561ff872e420dafeab7de5?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/10723638/victor"}, "edited": false, "score": 0, "creation_date": 1568729610, "post_id": 57963854, "comment_id": 102362045, "body": "It still does not work. The method is somehow calling the destroy function on the users controller. I&#39;ve added my routes file and also a line in the Friendship model. (Added Above)."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 53, "user_id": 10723638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bae4d4acdc561ff872e420dafeab7de5?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/10723638/victor"}, "edited": false, "score": 0, "creation_date": 1568734413, "post_id": 57963854, "comment_id": 102364812, "body": "Could you please show: (1) your link HTML as rendered in the browser, (2) the problem transaction trace from your console/server."}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 2, "last_activity_date": 1568665594, "last_edit_date": 1568665594, "creation_date": 1568664955, "answer_id": 57963854, "question_id": 57963776, "link": "https://stackoverflow.com/questions/57963776/user-removing-a-friend-is-deleting-the-user-object/57963854#57963854", "title": "User removing a &quot;Friend&quot; is deleting the user object", "body": "<p>I suspect your problem is here:</p>\n\n<pre><code>def remove_friend(friend)\n  self.friends.destroy(friend)\nend\n</code></pre>\n\n<p>I don't know what it is you think you're doing there, but it looks fishy to me.    </p>\n\n<p>Instead, try:</p>\n\n<pre><code>def remove_friend(friend)\n  friendships.where(friend: friend).destroy_all\nend\n</code></pre>\n\n<p>If you don't want to instantiate the <code>friendships</code> records and/or trigger any callbacks you can do (see the <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Relation.html#method-i-delete_all\" rel=\"nofollow noreferrer\">docs</a>):</p>\n\n<pre><code>def remove_friend(friend)\n  friendships.where(friend: friend).delete_all\nend\n</code></pre>\n\n<p>BTW, why aren't you using a <code>link_to</code> helper, here: </p>\n\n<pre><code>&lt;a href=\"+user_friend_path(current_user,user)+\" data-confirm='Do you want to remove #{user.profile.first_name} from your Friends?'&gt;&lt;/a&gt;\n</code></pre>\n\n<p>Handcrafting HTML like that seems like not the best idea. In fact, I am surprised that link even works. But, maybe it does. </p>\n"}], "owner": {"reputation": 53, "user_id": 10723638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bae4d4acdc561ff872e420dafeab7de5?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/10723638/victor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1568729514, "creation_date": 1568664573, "last_edit_date": 1568729514, "question_id": 57963776, "link": "https://stackoverflow.com/questions/57963776/user-removing-a-friend-is-deleting-the-user-object", "title": "User removing a &quot;Friend&quot; is deleting the user object", "body": "<p>I have a feature where you may add others to be your friend and then when they're your friend, an ability to delte them.</p>\n\n<p>View: </p>\n\n<pre><code>&lt;a href=\"+user_friend_path(current_user,user)+\" data-confirm='Do you want to remove #{user.profile.first_name} from your Friends?'&gt;&lt;/a&gt;\n</code></pre>\n\n<p>User Model: </p>\n\n<pre><code>has_many :friendships, dependent: :destroy\nhas_many :friends, through: :friendships\n\n def remove_friend(friend)\n    self.friends.destroy(friend)\n end\n</code></pre>\n\n<p>Friendships Model</p>\n\n<pre><code>after_destroy :destroy_inverse_relationship\n\nbelongs_to :user\nbelongs_to :friend, class_name: 'User'\n</code></pre>\n\n<p>Friends Controller</p>\n\n<pre><code>def destroy\n    item = current_user.remove_friend(@friend)\n    redirect_to user_path(@friend), notice: \"#{@friend.profile.first_name} was removed from your friends\"\n  end\n</code></pre>\n\n<p>Routes:</p>\n\n<pre><code>resources :users do\n   resources :friends, only: [:index, :destroy]\nend\n</code></pre>\n\n<p><strong>How it works:</strong></p>\n\n<p>1) You would click to remove</p>\n\n<p>2) Goes to friendship controller</p>\n\n<p>3) Grabs current user, and calls <code>remove_friend</code> on the Users model</p>\n\n<p>4) Relational should destroy friendship</p>\n\n<p><strong>What is Happening:</strong> It is destroying and deleting the actual user</p>\n\n<p><strong>What Should Happen:</strong> Delete row in <code>friendships</code> table</p>\n"}, {"tags": ["ruby", "enumerator"], "answers": [{"tags": [], "owner": {"reputation": 5580, "user_id": 490454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RqygM.jpg?s=128&g=1", "display_name": "BobRodes", "link": "https://stackoverflow.com/users/490454/bobrodes"}, "is_accepted": true, "score": 5, "last_activity_date": 1568692055, "last_edit_date": 1568692055, "creation_date": 1568690903, "answer_id": 57966958, "question_id": 57963765, "link": "https://stackoverflow.com/questions/57963765/is-there-a-built-in-way-to-check-if-next-or-peek-will-raise-stopiteration/57966958#57966958", "title": "Is there a built-in way to check if #next or #peek will raise StopIteration?", "body": "<p>You can <code>rescue</code> the <code>StopIteration</code> explicitly, but there's also the idea that the <code>loop</code> method internally rescues a <code>StopIteration</code> exception by simply exiting the loop. (Inside <code>loop</code>, <code>raise StopIteration</code> has the same effect as <code>break</code>.)</p>\n\n<p>This code simply exits the loop when you try to peek past the end:</p>\n\n<pre><code>a = %w(a b c d e).to_enum\n\nloop do\n  print a.peek\n  a.next\nend\n</code></pre>\n\n<p>The code outputs <code>abcde</code>. (It also transparently raises and rescues <code>StopIteration</code>.)</p>\n\n<p>So, if you want to simply ignore the <code>StopIteration</code> exception when you try to peek past the end, just use <code>loop</code>. </p>\n\n<p>Of course, once you peek past the end, you'll get dumped out of the loop. If you don't want that, you can use <code>while</code> and <code>rescue</code> to customize behavior. For example, if you want to avoid exiting if you peek past the end, and exit when you iterate past the end using <code>next</code>, you could do something like this:</p>\n\n<pre><code>a = %w(a b c d e).to_enum\n\nwhile true\n  begin  \n    print a.peek\n  rescue StopIteration\n    print \"\\nTried to peek past the end of the enum.\\nWe're gonna overlook that.\\n\"\n  end\n  x = a.next rescue $!\n  break if x.class == StopIteration\nend\n\np 'All done!'\n</code></pre>\n\n<p>The last two lines in the loop do the same thing as this, which you could use instead:</p>\n\n<pre><code>begin\n  a.next\nrescue StopIteration\n  break\nend\n</code></pre>\n\n<p>A point to make is that handling <code>StopIteration</code> is Ruby's intended way of dealing with getting to the end of an iterator. Quoting from Matz's book <em>The Ruby Programming Language</em>:</p>\n\n<blockquote>\n  <p>External iterators are quite simple to use: just call <code>next</code> each time you want another\n  element. When there are no more elements left, <code>next</code> will raise a <code>StopIteration</code> exception.\n  This may seem unusual\u2014an exception is raised for an expected termination\n  condition rather than an unexpected and exceptional event. (<code>StopIteration</code> is a descendant\n  of <code>StandardError</code> and <code>IndexError</code>; note that it is one of the only exception\n  classes that does not have the word \u201cerror\u201d in its name.) Ruby follows Python in this\n  external iteration technique. By treating loop termination as an exception, it makes\n  your looping logic extremely simple; there is no need to check the return value of\n  <code>next</code> for a special end-of-iteration value, and there is no need to call some kind of\n  <code>next?</code> predicate before calling <code>next</code>.</p>\n</blockquote>\n"}], "owner": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 57966958, "answer_count": 1, "score": 3, "last_activity_date": 1568692055, "creation_date": 1568664491, "question_id": 57963765, "link": "https://stackoverflow.com/questions/57963765/is-there-a-built-in-way-to-check-if-next-or-peek-will-raise-stopiteration", "title": "Is there a built-in way to check if #next or #peek will raise StopIteration?", "body": "<p>I'm working with a few iterators where I have to do something along these lines (<code>enum</code> is an enumerator)</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>enums_with_zero &lt;&lt; enum.rewind if enum.peek == 0\n</code></pre>\n\n<p>which normally works fine, but this is after there's already been <code>#next</code> called on the enum a few times. The issue with this is that the <code>enum</code> could be at the end and with a few values passed for <code>enum</code>, I have hit the issue where <code>enum.peek</code> raises <code>StopIteration</code> because the <code>enum</code> is completed. Is there a way I could put in a guard to check if <code>enum.peek</code> or <code>enum.next</code> will cause <code>StopIteration</code> before I call it. Something that would have the behavior of this for example?</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Enumerator\n  def has_next?\n    begin\n      peek &amp;&amp; true\n    rescue StopIteration\n      false\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["python", "arrays", "ruby"], "comments": [{"owner": {"reputation": 8462, "user_id": 405865, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e29f04f339715955060858e0e65e1311?s=128&d=identicon&r=PG", "display_name": "fphilipe", "link": "https://stackoverflow.com/users/405865/fphilipe"}, "edited": false, "score": 0, "creation_date": 1568664568, "post_id": 57963712, "comment_id": 102338585, "body": "If you need this in Python, you might want to tag it accordingly."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1568666335, "post_id": 57963712, "comment_id": 102339229, "body": "You need it in Python, or is that a Python example?"}, {"owner": {"reputation": 89316, "user_id": 238886, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8ca29123b5669b26f9b6ca2c62d9d215?s=128&d=identicon&r=PG", "display_name": "Wayne Conrad", "link": "https://stackoverflow.com/users/238886/wayne-conrad"}, "edited": false, "score": 0, "creation_date": 1568668256, "post_id": 57963712, "comment_id": 102339890, "body": "What result did you get when it did not work?"}, {"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1568669669, "post_id": 57963712, "comment_id": 102340314, "body": "&quot;I tried doing <b>the same way</b>&quot; - the error message indicates otherwise."}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1568672560, "post_id": 57963712, "comment_id": 102341022, "body": "I think the issue you&#39;re experiencing is because when you do <code>array * integer</code> you&#39;re calling the array version of the <code>*</code> method which knows what to do with a an integer, but when you do the opposite and do <code>integer * array</code> the integer version of <code>*</code> doesn&#39;t know what to do with an array. Also if you find an answer to your question, post it as an answer, don&#39;t edit your original question with the answer"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1568679443, "post_id": 57963712, "comment_id": 102342377, "body": "Remember that just because an operator is commutative in mathematics doesn&#39;t mean that it will be in Ruby. <code>a * b</code> is really just <code>a.*(b)</code> after all and that could be very different from <code>b.*(a)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 4, "last_activity_date": 1568664414, "creation_date": 1568664414, "answer_id": 57963752, "question_id": 57963712, "link": "https://stackoverflow.com/questions/57963712/is-there-an-easy-way-to-multiply-an-array-and-a-integer-in-ruby/57963752#57963752", "title": "Is there an easy way to multiply an array and a integer in ruby?", "body": "<p>Well, it works in my Ruby 2.5:</p>\n\n<pre><code>[\"a\",\"b\"] * 3\n# =&gt; [\"a\", \"b\", \"a\", \"b\", \"a\", \"b\"]  \n</code></pre>\n\n<blockquote>\n  <p><code>ary * int \u2192 new_ary</code></p>\n  \n  <p>Repetition \u2014 (...) returns a new array built by concatenating the int copies of self.\n  <a href=\"https://ruby-doc.org/core-2.6.4/Array.html#method-i-2A\" rel=\"nofollow noreferrer\">Docs</a></p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1568932328, "post_id": 57974453, "comment_id": 102442653, "body": "Are you sure about the Python? <code>[&quot;a&quot;,&quot;b&quot;] * 3</code> does the same thing in Ruby and Python, no?"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1568964695, "post_id": 57974453, "comment_id": 102450087, "body": "@muistooshort: Indeed, not enough coffee on that day! That&#39;s not the point I wanted to make. I really like Python list comprehensions and want to use them even when they&#39;re not needed. Thanks for the comment."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1568967255, "post_id": 57974453, "comment_id": 102451308, "body": "I only noticed because I recently gave myself a crash course in Python to get around Ruby&#39;s somewhat abysmal start up times for scripts. I hear you on the list comprehensions in any case."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1568968600, "post_id": 57974453, "comment_id": 102451918, "body": "@muistooshort It&#39;s definitely worth it. If you didn&#39;t already, you could install Anaconda and play with numpy, sympy, pandas, keras, networkx and pygame. It&#39;s great to be able to use so many powerful libraries with just a few lines of code. I&#39;ll always love Ruby but the Python ecosystem sure is impressive."}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 2, "last_activity_date": 1568964628, "last_edit_date": 1568964628, "creation_date": 1568724111, "answer_id": 57974453, "question_id": 57963712, "link": "https://stackoverflow.com/questions/57963712/is-there-an-easy-way-to-multiply-an-array-and-a-integer-in-ruby/57974453#57974453", "title": "Is there an easy way to multiply an array and a integer in ruby?", "body": "<h1>A * B is not always B * A</h1>\n\n<p><code>3 * 4</code> means:</p>\n\n<blockquote>\n  <p><code>3</code> repeated <code>4</code> times.</p>\n</blockquote>\n\n<p><code>4 * 3</code> means:</p>\n\n<blockquote>\n  <p><code>4</code> repeated <code>3</code> times.</p>\n</blockquote>\n\n<p><code>[\"a\", \"b\"] * 3</code> means:</p>\n\n<blockquote>\n  <p><code>[\"a\", \"b\"]</code> repeated <code>3</code> times.</p>\n</blockquote>\n\n<p>But what would</p>\n\n<blockquote>\n  <p><code>3</code> repeated <code>[\"a\", \"b\"]</code> times.</p>\n</blockquote>\n\n<p>mean? How can you do anything <code>[\"a\", \"b\"]</code> times?</p>\n\n<h1>In Python</h1>\n\n<p>In Python, both are allowed:</p>\n\n<pre><code>[\"a\",\"b\"] * 3\n3 * [\"a\",\"b\"]\n</code></pre>\n\n<p>and return:</p>\n\n<pre><code>['a', 'b', 'a', 'b', 'a', 'b']\n</code></pre>\n\n<p>but the second looks sloppy IMHO.</p>\n"}], "owner": {"reputation": 45, "user_id": 11509455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9064c2483c6e509e44967095c45b854b?s=128&d=identicon&r=PG&f=1", "display_name": "JesusJPG", "link": "https://stackoverflow.com/users/11509455/jesusjpg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1568964628, "creation_date": 1568664214, "last_edit_date": 1568669902, "question_id": 57963712, "link": "https://stackoverflow.com/questions/57963712/is-there-an-easy-way-to-multiply-an-array-and-a-integer-in-ruby", "title": "Is there an easy way to multiply an array and a integer in ruby?", "body": "<p>I need to repeat a certain set of items inside an array. </p>\n\n<p>I need something like this in Python:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>[\"a\",\"b\"] * 3\n# result: [\"a\",\"b\",\"a\",\"b\",\"a\",\"b\"]\n</code></pre>\n\n<p>I tried doing the same way, but I am getting:</p>\n\n<pre><code>(erb):329:in `*': Array can't be coerced into Integer (TypeError)\n</code></pre>\n\n<p>Is there an easy way to solve it?</p>\n\n<p>Edit: Already solved. It seems to happen that it works when it is done like this</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>[\"a\", \"b\"] * 2\n</code></pre>\n\n<p>But does not work backwards:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>2 * [\"a\", \"b\"]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "reactjs", "cors", "postman"], "comments": [{"owner": {"reputation": 4078, "user_id": 10549165, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Redsx.png?s=128&g=1", "display_name": "Chris B.", "link": "https://stackoverflow.com/users/10549165/chris-b"}, "edited": false, "score": 0, "creation_date": 1568665205, "post_id": 57963421, "comment_id": 102338853, "body": "What is your <code>baseURL</code>?"}, {"owner": {"reputation": 156, "user_id": 3931407, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/be5157c3bdf7394e84d95450315b1c2f?s=128&d=identicon&r=PG&f=1", "display_name": "AngeloS", "link": "https://stackoverflow.com/users/3931407/angelos"}, "reply_to_user": {"reputation": 4078, "user_id": 10549165, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Redsx.png?s=128&g=1", "display_name": "Chris B.", "link": "https://stackoverflow.com/users/10549165/chris-b"}, "edited": false, "score": 0, "creation_date": 1568681547, "post_id": 57963421, "comment_id": 102342782, "body": "This is what it is defined as:   <code>const baseURL = &quot;http:&#47;&#47;67.205.164.245:6714&#47;api&#47;v1&#47;&quot; </code>"}, {"owner": {"reputation": 61150, "user_id": 441757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/921df025d1d7c99fad4553ac83bd8bdf?s=128&d=identicon&r=PG", "display_name": "sideshowbarker", "link": "https://stackoverflow.com/users/441757/sideshowbarker"}, "edited": false, "score": 0, "creation_date": 1568682403, "post_id": 57963421, "comment_id": 102342907, "body": "Open the Network pane in browser devtools and examine the requests and responses there. You see and OPTIONS request there? What\u2019s the status code of the response to that OPTIONS request? And exactly what messages in the browser logging in the devtools console?"}], "owner": {"reputation": 156, "user_id": 3931407, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/be5157c3bdf7394e84d95450315b1c2f?s=128&d=identicon&r=PG&f=1", "display_name": "AngeloS", "link": "https://stackoverflow.com/users/3931407/angelos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 268, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568662821, "creation_date": 1568662821, "question_id": 57963421, "link": "https://stackoverflow.com/questions/57963421/post-request-works-in-postman-but-is-blocked-from-react-front-end-no-cors-error", "title": "POST request works in Postman but is blocked from React front end. No CORS error, not making it to the server", "body": "<p>I have a database setup on Dokku that is currently functioning fine with Postman. My full stack React front end and Rails back end are functioning locally, but when I attempt the same fetch calls (only difference in code is the url), the requests don't have any parameters and are blocked before ever reaching the server.</p>\n\n<p>Here's an example of a fetch call I'm trying (using Redux): </p>\n\n<pre><code>export const createPurchase = purchase =&gt; {\n  return dispatch =&gt; {\n    return fetch(baseURL + 'purchases', {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Accepts\": \"application/json\"\n      },\n      body: JSON.stringify({ amount: purchase.amount, bundle_name: purchase.bundleName, user_id: purchase.userId })\n   })\n     .then(resp =&gt; resp.json())\n     .then(userObj =&gt; {\n       console.log('purchase created!')\n     })\n     .catch(error =&gt; console.log(error))\n  }\n}\n</code></pre>\n\n<p>Reading my Rails server logs on Dokku shows that it isn't aware that requests are being made. My CORS file looks like this:</p>\n\n<pre><code>Rails.application.config.middleware.insert_before 0, Rack::Cors do\n  allow do\n    origins '*'\n\n    resource '*',\n      headers: :any,\n      methods: [:get, :post, :put, :patch, :delete, :options, :head]\n  end\nend\n</code></pre>\n\n<p>I'm not sure why the fetch requests are automatically getting blocked when I am allowing everything with CORS, do I need to add a header to the fetch requests?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rake", "capistrano", "capistrano3"], "answers": [{"tags": [], "owner": {"reputation": 2117, "user_id": 2087342, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc0ec8d8df79a0824f3e2d8255372f97?s=128&d=identicon&r=PG", "display_name": "Konstantin Rudy", "link": "https://stackoverflow.com/users/2087342/konstantin-rudy"}, "is_accepted": true, "score": 1, "last_activity_date": 1575963715, "last_edit_date": 1575963715, "creation_date": 1568798411, "answer_id": 57989293, "question_id": 57962823, "link": "https://stackoverflow.com/questions/57962823/run-rake-task-from-capistrano-if-it-exists/57989293#57989293", "title": "Run rake task from Capistrano if it exists", "body": "<p>I ended up just ignoring not 0 exit code from a rake task using <code>raise_on_non_zero_exit: false</code>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>with rails_env: 'staging' do\n  execute :rake, 'release:rollback_staging', raise_on_non_zero_exit: false\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7531, "user_id": 2359227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57758277a5b44a41d8dc112c91eeeca7?s=128&d=identicon&r=PG", "display_name": "Tomer Shetah", "link": "https://stackoverflow.com/users/2359227/tomer-shetah"}, "edited": false, "score": 2, "creation_date": 1608203557, "post_id": 65338833, "comment_id": 115513978, "body": "Welcome to SO! Please read the <a href=\"https://stackoverflow.com/tour\">tour</a>, and <a href=\"https://stackoverflow.com/help/how-to-answer\">How do I write a good answer?</a> If this is another question, please post it as such. If it is an answer please edit it."}], "tags": [], "owner": {"reputation": 1, "user_id": 11711477, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-O7ptMj-QRq0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdt7QS40Oa1bG_3i7NAKV_K3QdwgA/mo/photo.jpg?sz=128", "display_name": "Kenneth Teh", "link": "https://stackoverflow.com/users/11711477/kenneth-teh"}, "is_accepted": false, "score": -1, "last_activity_date": 1608200702, "creation_date": 1608200702, "answer_id": 65338833, "question_id": 57962823, "link": "https://stackoverflow.com/questions/57962823/run-rake-task-from-capistrano-if-it-exists/65338833#65338833", "title": "Run rake task from Capistrano if it exists", "body": "<p>Would this work? Saw this pattern in <a href=\"https://github.com/AgileConsultingLLC/capistrano3-delayed-job\" rel=\"nofollow noreferrer\">https://github.com/AgileConsultingLLC/capistrano3-delayed-job</a></p>\n<pre><code>if Rake::Task.task_defined?('release:rollback_staging')\n</code></pre>\n"}], "owner": {"reputation": 2117, "user_id": 2087342, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc0ec8d8df79a0824f3e2d8255372f97?s=128&d=identicon&r=PG", "display_name": "Konstantin Rudy", "link": "https://stackoverflow.com/users/2087342/konstantin-rudy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 57989293, "answer_count": 2, "score": 1, "last_activity_date": 1608200702, "creation_date": 1568659923, "last_edit_date": 1568660563, "question_id": 57962823, "link": "https://stackoverflow.com/questions/57962823/run-rake-task-from-capistrano-if-it-exists", "title": "Run rake task from Capistrano if it exists", "body": "<p>I need to a create a Capistrano pre-deploy step that runs a custom rake task.</p>\n\n<p>in <strong>deploy.rb</strong>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>before 'deploy:starting', 'db:rollback_staging'\n\nnamespace :db do\n  desc 'Rollback staging db only if PR already deployed requires rollback'\n  task :rollback_staging do\n    on roles(:master) do\n      within current_path.to_s do\n        with rails_env: 'staging' do\n          execute :rake, 'release:rollback_staging'\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>The problem is that when deploying this code the rake task is not yet present on the server and therefore deploy fails with:</p>\n\n<pre><code>rake stdout: rake aborted!\n\nDon't know how to build task 'release:rollback_staging' (See the list of available tasks with `rake --tasks`)\n</code></pre>\n\n<p>If there a way to check if the rake task exists from Capistrano?\nsmth like:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>with rails_env: 'staging' do\n  execute :rake, 'release:rollback_staging' if rake_exists? 'release:rollback_staging'\nend\n</code></pre>\n"}, {"tags": ["ruby", "selenium-webdriver", "capybara"], "answers": [{"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 2, "last_activity_date": 1568684271, "creation_date": 1568684271, "answer_id": 57966273, "question_id": 57962383, "link": "https://stackoverflow.com/questions/57962383/how-do-i-register-iedriver-and-edge-driver-with-capybara-while-using-the-webdriv/57966273#57966273", "title": "How do I register IEDriver and Edge Driver with Capybara while using the Webdrivers gem?", "body": "<p>No, there are no preregistered drivers for IE or Edge. To add them you need to use <code>register_driver</code> - <a href=\"https://www.rubydoc.info/github/jnicklas/capybara/Capybara.register_driver\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/github/jnicklas/capybara/Capybara.register_driver</a> - and inside the block pass the options to configure selenium to use the browser you want.  You can see how Capybara registers the provided drivers by looking in <a href=\"https://github.com/teamcapybara/capybara/blob/master/lib/capybara/registrations/drivers.rb\" rel=\"nofollow noreferrer\">https://github.com/teamcapybara/capybara/blob/master/lib/capybara/registrations/drivers.rb</a> </p>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 7513181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f664cb69e5dde70af40f90a57b07f15d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Odumosu", "link": "https://stackoverflow.com/users/7513181/michael-odumosu"}, "is_accepted": false, "score": 0, "last_activity_date": 1608177682, "creation_date": 1608177682, "answer_id": 65334549, "question_id": 57962383, "link": "https://stackoverflow.com/questions/57962383/how-do-i-register-iedriver-and-edge-driver-with-capybara-while-using-the-webdriv/65334549#65334549", "title": "How do I register IEDriver and Edge Driver with Capybara while using the Webdrivers gem?", "body": "<pre><code>Capybara.register_driver :internetExplorer do |app|\n\n    # p Capybara::Selenium::Driver::InternetExplorerDriver.options\n\n    Capybara::Selenium::Driver.new(\n        app,\n        :browser =&gt; :internet_explorer,\n        :options =&gt;   Selenium::WebDriver::IE::Options.new({\n            :ignore_zoom_levels =&gt; true,\n            :ignore_zoom_setting =&gt; true,\n            # :browser_attach_timeout =&gt; 1,\n            :javascript_enabled =&gt; true,\n            :persistent_hover =&gt; true,\n            # :require_window_focus =&gt; true,\n            :ignore_protected_mode_settings =&gt;true,\n        })\n    )\n\nend\n\nCapybara.register_driver :edgeBrowser do |app|\n\n    # p Capybara::Selenium::Driver::InternetExplorerDriver.options\n\n    Capybara::Selenium::Driver.new(\n        app,\n        :browser =&gt; :edge,\n        :desired_capabilities =&gt;Selenium::WebDriver::Remote::Capabilities::edge({\n            :javascript_enabled =&gt; true,\n            :css_selectors_enabled =&gt; true,\n        }),\n    )\n\n\n\nend\n</code></pre>\n"}], "owner": {"reputation": 727, "user_id": 4024964, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/t0rq7.png?s=128&g=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/4024964/phil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 1, "accepted_answer_id": 57966273, "answer_count": 2, "score": 0, "last_activity_date": 1608177682, "creation_date": 1568657849, "question_id": 57962383, "link": "https://stackoverflow.com/questions/57962383/how-do-i-register-iedriver-and-edge-driver-with-capybara-while-using-the-webdriv", "title": "How do I register IEDriver and Edge Driver with Capybara while using the Webdrivers gem?", "body": "<p>The ruby webdrivers gem allows automatic downloads of drivers without me having to do it manually when my browser is updated.</p>\n\n<p>And I know that latest Capybara supports drivers out of the box like <code>:selenium</code>, <code>:selenium_chrome</code>, <code>:selenium_chrome_headless</code> just to name a few. This makes it easy in that I don't have to register any drivers beforehand.</p>\n\n<p>Are there similar keywords I can use for IEDriver and Edge Driver? The Webdrivers gem supports these but I am not sure how to get it working with Capybara so that the drivers are automatically downloaded and then run. If there are no keywords/default driver names I can use, how do I register these?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1568658001, "post_id": 57962335, "comment_id": 102336145, "body": "Your comments in code says &quot;this conditions fails&quot;. Please show the stack trace with error."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1568658132, "post_id": 57962335, "comment_id": 102336192, "body": "You tagged your question with <code>ruby-on-rails-3</code>. Do you really use Rails 3.x which reached end-of-life more than three years ago?"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 3192764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/282fb04bb23dca65fe81a2b6e613478c?s=128&d=identicon&r=PG", "display_name": "bjgaynor", "link": "https://stackoverflow.com/users/3192764/bjgaynor"}, "edited": false, "score": 1, "creation_date": 1568666368, "post_id": 57964086, "comment_id": 102339240, "body": "This is roughly what I was just typing up, I think this is good advice.  In addition to this, it&#39;s also possible to assign the password without using the update_attributes method and that is something to try.  It would look kind of like this <code>@user.password = params[:user][:password]</code> and then <code>if @user.save</code> do something under that."}, {"owner": {"reputation": 1, "user_id": 12075756, "user_type": "registered", "profile_image": "https://graph.facebook.com/2396592607060563/picture?type=large", "display_name": "Hem Raj", "link": "https://stackoverflow.com/users/12075756/hem-raj"}, "edited": false, "score": 0, "creation_date": 1568743688, "post_id": 57964086, "comment_id": 102368901, "body": "@user.save fails I dont know why"}, {"owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "edited": false, "score": 0, "creation_date": 1568752088, "post_id": 57964086, "comment_id": 102372362, "body": "Have you fixed the conditional or was it just a typo in your question? Try <code>user.save!</code> to raise an error if it fails. The same works with <code>update_attributes!(attributes)</code>, this also updates an object just like Base.update_attributes but calls save! instead of save so an exception is raised if the record is invalid."}, {"owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "edited": false, "score": 0, "creation_date": 1568752398, "post_id": 57964086, "comment_id": 102372487, "body": "Updated my answer."}], "tags": [], "owner": {"reputation": 2198, "user_id": 3842598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468955b0edcf30e61a2937cb8b754a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3842598/christian"}, "is_accepted": false, "score": 1, "last_activity_date": 1568752389, "last_edit_date": 1568752389, "creation_date": 1568666194, "answer_id": 57964086, "question_id": 57962335, "link": "https://stackoverflow.com/questions/57962335/password-doesnt-get-updated-for-user-in-rails-after-reseting/57964086#57964086", "title": "Password doesn&#39;t get updated for user in rails after reseting", "body": "<p>You write conditional but I think that your second conditional is not setup correctly, respectively the elsif in your case does not contain any conditional.</p>\n\n<p>The correct syntax for the if statement is </p>\n\n<pre><code>if conditional\n   code\nelsif conditional\n   code\nelse\n   code\nend\n</code></pre>\n\n<p><strong>Conditionals are a combination of if statements and comparison operators (&lt;, >, &lt;=, >=, ==, !=, &amp;&amp;, ||).</strong></p>\n\n<p>If if you keep the conditional in mind and re-visit your code, there is a conditional missing, I'd expect something like, look at if and elsif, I have exchanged the > and &lt; operators as it makes more sense to me. </p>\n\n<pre><code>@user = User.find_by_password_reset_token!(params[:id])\nif @user.password_reset_sent_at &gt; 2.hour.ago\n  # your if action here ...\n\nelsif @user.password_reset_sent_at &lt; 2.hour.ago\n  @user.update_attributes(params[:user])\n\nelse\n  # your else action ...\nend\n</code></pre>\n\n<p>To know what's going on in case of silent errors or just a false return value when using <code>update_attributes</code> I suggest to use <code>update_attributes!(attributes)</code>, at least for testing / debugging. This method also updates an object just like Base.update_attributes but calls save! instead of save so an exception is raised if the record is invalid and you can see what's going wrong. </p>\n\n<p>You could also use a rails console by typing <code>rails c</code> in a terminal and test <code>@user.update_attributes('any_value')</code> in there.</p>\n"}], "owner": {"reputation": 1, "user_id": 12075756, "user_type": "registered", "profile_image": "https://graph.facebook.com/2396592607060563/picture?type=large", "display_name": "Hem Raj", "link": "https://stackoverflow.com/users/12075756/hem-raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568752389, "creation_date": 1568657652, "last_edit_date": 1568657929, "question_id": 57962335, "link": "https://stackoverflow.com/questions/57962335/password-doesnt-get-updated-for-user-in-rails-after-reseting", "title": "Password doesn&#39;t get updated for user in rails after reseting", "body": "<p>I previously had a page as settings to update the user details in rails. On that time the password gets updated without any issue. But now I used a password reset option for the users who forgot their password. They will receive a mail and then they reset the password. After adding this feature both the updating inside the account and via mail does not happen. </p>\n\n<p>password_reset controller:</p>\n\n<pre><code>def update\n\n  @user = User.find_by_password_reset_token!(params[:id])\n  if @user.password_reset_sent_at &lt; 2.hour.ago\n    flash[:notice] = 'Password reset has expired'\n\n    redirect_to new_password_reset_path\n\n  elsif @user.update_attributes(params[:user])// this condition fails. I don't know why it fails.\n\n    flash[:notice] = 'Password has been reset!'\n    redirect_to new_session_path\n  else\n   redirect_to new_session_path\n  end\n</code></pre>\n\n<p>user.rb</p>\n\n<pre><code>  validates :password, presence: true, length: { minimum: 6 } \n  validates :password_confirmation, presence: true \n  before_save { |user| user.email = email.downcase }\n  before_save :create_remember_token\n\n\n  private\n\n    def create_remember_token\n      self.remember_token = SecureRandom.urlsafe_base64\n    end\n\n    def generate_token(column)\n      begin\n        self[column] = SecureRandom.urlsafe_base64\n      end while User.exists?(column =&gt; self[column])\n    end\n</code></pre>\n\n<p>These filters I used in user controller</p>\n\n<pre><code> before_filter :signed_in_user, only: [:edit, :update, :requestuser]\n before_filter :correct_user,   only: [:edit, :update]\n before_filter :admin_user,     only: :destroy\n</code></pre>\n\n<p>I am new to rails and learning. Need help. The same filter I used before password reset I dont know why it fails. It first worked for few days now it fails.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nokogiri"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7955934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mRcX.jpg?s=128&g=1", "display_name": "Wallace and Gromit", "link": "https://stackoverflow.com/users/7955934/wallace-and-gromit"}, "edited": false, "score": 0, "creation_date": 1568743862, "post_id": 57962009, "comment_id": 102368978, "body": "Thanks thaleshcv!! Installing the dev files helped for having the bundler running smoothely. The crash of the puma server, however, persists. But this is another topic."}], "tags": [], "owner": {"reputation": 654, "user_id": 1319545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d925d70e121e9b8e1a7dd44155e2497?s=128&d=identicon&r=PG", "display_name": "thaleshcv", "link": "https://stackoverflow.com/users/1319545/thaleshcv"}, "is_accepted": false, "score": 0, "last_activity_date": 1568656170, "creation_date": 1568656170, "answer_id": 57962009, "question_id": 57961596, "link": "https://stackoverflow.com/questions/57961596/installing-rails-on-raspberrypi-raspbian-buster-fails/57962009#57962009", "title": "Installing Rails on RaspberryPi (Raspbian Buster) fails", "body": "<p>Try installing the headers files for ruby:</p>\n\n<p><code>sudo apt-get install ruby-dev</code></p>\n"}], "owner": {"reputation": 21, "user_id": 7955934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mRcX.jpg?s=128&g=1", "display_name": "Wallace and Gromit", "link": "https://stackoverflow.com/users/7955934/wallace-and-gromit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 241, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568656170, "creation_date": 1568654293, "question_id": 57961596, "link": "https://stackoverflow.com/questions/57961596/installing-rails-on-raspberrypi-raspbian-buster-fails", "title": "Installing Rails on RaspberryPi (Raspbian Buster) fails", "body": "<p>I am still quite new to Rails(1). <br>\nYesterday, I installed Ruby on Rails on a RaspberryPi (with a pristine SD card and fresh etched OS) the Debian way: <br>\n<code>sudo apt-get install ruby rails</code> <br>\nThis (seemingly) successfully installed me Rails (version 5.2.2.1) and Ruby (version 2.5.5p157) and I created a new application framework without trouble. However, starting the puma server just results in a long error log. <br>\n<code>bundle update</code> <br>\n aborts at <br>\n<code>installing Nokogiri 1.10.4 (was 1.10.0)</code> <br>\n(... can't find headerr files for Ruby'...). <br>\nNot surprisingly, the server still responds with just the same error messages.<br> \nAny help in getting things up and running is highly appreciated.\nThanks! <br>\nKarsten\n<br> <br>\n(1) I am absolutely sure, I am not the first and only with this question. Three weeks ago I had about the same difficulties with the installation procedure at my laptop running plain Debian. I searched for about two days without finding clear guidance (ok, not smart enough ;-). Finally I managed to get things running by manually setting GEMS versions to the pre-installed values. However, this took quite some time and because I am new, I am unaware which implications my trial-and-error settings have. Because I did not log my actions, now I would need to restart the procedure from scratch... There must be a better approach ==> sorry for redundant postings.</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 757, "user_id": 6939256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e25b477a55a8048071d22e032ecf22f0?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamints", "link": "https://stackoverflow.com/users/6939256/benjamints"}, "edited": false, "score": 1, "creation_date": 1568663779, "post_id": 57963431, "comment_id": 102338295, "body": "What an amazing answer. Thank you, I actually understand it now :)"}, {"owner": {"reputation": 757, "user_id": 6939256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e25b477a55a8048071d22e032ecf22f0?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamints", "link": "https://stackoverflow.com/users/6939256/benjamints"}, "edited": false, "score": 0, "creation_date": 1568663801, "post_id": 57963431, "comment_id": 102338305, "body": "I&#39;m running the code and we are having a slight problem where we call order. NoMethodError: undefined method `order&#39; for #&lt;Array:0x00007fefe599fed0&gt;. Maybe we should use sort_by instead?"}, {"owner": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "reply_to_user": {"reputation": 757, "user_id": 6939256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e25b477a55a8048071d22e032ecf22f0?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamints", "link": "https://stackoverflow.com/users/6939256/benjamints"}, "edited": false, "score": 0, "creation_date": 1568663928, "post_id": 57963431, "comment_id": 102338346, "body": "Try to replace <code>ratings.order(created_at: :desc).first</code> to <code>ratings.sort_by{ |rating| rating.created_at }.last</code>"}, {"owner": {"reputation": 757, "user_id": 6939256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e25b477a55a8048071d22e032ecf22f0?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamints", "link": "https://stackoverflow.com/users/6939256/benjamints"}, "edited": false, "score": 0, "creation_date": 1568664156, "post_id": 57963431, "comment_id": 102338434, "body": "Ok I need to see also if I have access to the relations in the .js.erb view, since it has turned to an array."}, {"owner": {"reputation": 757, "user_id": 6939256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e25b477a55a8048071d22e032ecf22f0?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamints", "link": "https://stackoverflow.com/users/6939256/benjamints"}, "edited": false, "score": 0, "creation_date": 1568664444, "post_id": 57963431, "comment_id": 102338544, "body": "The new sort_by has somehow turned it into a multidimensional array and doesn&#39;t filter as before. <a href=\"https://imgur.com/a/S09eY2M\" rel=\"nofollow noreferrer\">imgur.com/a/S09eY2M</a> <a href=\"https://imgur.com/a/2qOEZfL\" rel=\"nofollow noreferrer\">imgur.com/a/2qOEZfL</a>"}, {"owner": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "reply_to_user": {"reputation": 757, "user_id": 6939256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e25b477a55a8048071d22e032ecf22f0?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamints", "link": "https://stackoverflow.com/users/6939256/benjamints"}, "edited": false, "score": 0, "creation_date": 1568664613, "post_id": 57963431, "comment_id": 102338606, "body": "Don&#39;t forget the <code>.last</code> in the final of <code>sort_by</code>"}, {"owner": {"reputation": 757, "user_id": 6939256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e25b477a55a8048071d22e032ecf22f0?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamints", "link": "https://stackoverflow.com/users/6939256/benjamints"}, "edited": false, "score": 0, "creation_date": 1568664874, "post_id": 57963431, "comment_id": 102338702, "body": "Wonderful, it looks great now! Thanks for the awesome help."}, {"owner": {"reputation": 757, "user_id": 6939256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e25b477a55a8048071d22e032ecf22f0?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamints", "link": "https://stackoverflow.com/users/6939256/benjamints"}, "edited": false, "score": 0, "creation_date": 1568664883, "post_id": 57963431, "comment_id": 102338707, "body": "I hope this will help someone else."}], "tags": [], "owner": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "is_accepted": true, "score": 0, "last_activity_date": 1568664146, "last_edit_date": 1592644375, "creation_date": 1568662873, "answer_id": 57963431, "question_id": 57961340, "link": "https://stackoverflow.com/questions/57961340/ruby-on-rails-group-by-for-relation-and-created-at/57963431#57963431", "title": "Ruby on Rails - group_by for relation and created_at", "body": "<p>Let's do it in parts!</p>\n<p>You need a Rails query that will get me the last created rating for every movie made by the current user.</p>\n<p>Ok, with this information, let`s start with the current_user reference!</p>\n<p>Your relation for <code>User</code> is like this:</p>\n<blockquote>\n<p>A <code>user</code> has many <code>movies</code></p>\n<p>A <code>user</code> has many <code>ratings</code></p>\n</blockquote>\n<p>With these definitions, you can take advantage of ActiveRecord to run the following methods:</p>\n<pre class=\"lang-rb prettyprint-override\"><code>current_user.movies # All movies of a current_user\ncurrent_user.movies # All ratings of a current_user\n</code></pre>\n<p>Ok, now we can access all movies and ratings from a user instance, but how we can access the ratings grouped by movies?</p>\n<p>Let's see the <code>Rating</code> relations:</p>\n<blockquote>\n<p>A <code>rating</code> belongs to a <code>user</code> # this means the rating instance has the user_id</p>\n<p>A <code>rating</code> belongs to a <code>movie</code> # this means the rating instance has the movie_id</p>\n</blockquote>\n<p>Nice! Now we can <strong>get the user ratings grouped by <code>movie</code></strong>:</p>\n<pre class=\"lang-rb prettyprint-override\"><code>current_user.ratings.group_by { |rating| rating.movie_id }\n# or the sugar sintax\ngrouped_ratings = current_user.ratings.group_by(&amp;:movie_id)\n</code></pre>\n<p>This will group all user ratings based on the <code>movie_id</code>, and will produce to us a hash like:</p>\n<pre class=\"lang-rb prettyprint-override\"><code>{\n  1: [#&lt;Rating id: 115...#&gt;, #&lt;Rating id: 116...#&gt;], # The &quot;1&quot; means the movie_id of the group_by\n  2: [#&lt;Rating id: 117...#&gt;] # The &quot;2&quot; means the movie_id of the group_by\n}\n</code></pre>\n<p>Ok, now we have a hash of ratings from a User, grouped by the <code>movie_id</code>.</p>\n<p>But we need the last rating created by a user for each Movie correctly?</p>\n<pre class=\"lang-rb prettyprint-override\"><code>last_ratings_for_each_movie = grouped_ratings.map do |movie_id, ratings|\n  movie = Movie.find(movie_id)\n  last_rating = ratings.sort_by{ |rating| rating.created_at }.last\n  \n  puts &quot;The last Rating created by the current user for Movie #{movie.title} is the rating #{last_rating.id}&quot; # Assuming movie has a title\n  \n  last_rating\nend\n</code></pre>\n<p>In the last moment, you will have an array of the last rating created for a movie (to access the movie you can execute a <code>rating.movie</code> for example)</p>\n<p>I didn't understand if you must do it with SQL, if yes, let me know pls :)</p>\n<p>Hope it helps!</p>\n"}], "owner": {"reputation": 757, "user_id": 6939256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e25b477a55a8048071d22e032ecf22f0?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamints", "link": "https://stackoverflow.com/users/6939256/benjamints"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 57963431, "answer_count": 1, "score": 1, "last_activity_date": 1568666760, "creation_date": 1568652968, "last_edit_date": 1568666760, "question_id": 57961340, "link": "https://stackoverflow.com/questions/57961340/ruby-on-rails-group-by-for-relation-and-created-at", "title": "Ruby on Rails - group_by for relation and created_at", "body": "<p>I'm looking for a Rails query that will get me the last created rating for every movie made by the current user.</p>\n\n<p>For example, let's say I have this active record collection:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>#&lt;ActiveRecord::Relation [\n  #&lt;Rating id: 115, score: 5, movie_id: 7, user_id: 5, created_at: \"2019-09-16 16:47:55\", updated_at: \"2019-09-16 16:47:55\"&gt;,\n  #&lt;Rating id: 116, score: 3, movie_id: 7, user_id: 5, created_at: \"2019-09-16 16:47:57\", updated_at: \"2019-09-16 16:47:57\"&gt;,\n  #&lt;Rating id: 117, score: 5, movie_id: 7, user_id: 5, created_at: \"2019-09-16 16:50:37\", updated_at: \"2019-09-16 16:50:37\"&gt;,\n  #&lt;Rating id: 118, score: 3, movie_id: 8, user_id: 5, created_at: \"2019-09-16 16:50:42\", updated_at: \"2019-09-16 16:50:42\"&gt;\n]&gt;\n</code></pre>\n\n<p>We can see there are three objects with <code>movie_id</code>: <code>7</code>, one with <code>movie_id</code>: <code>6</code>. This is wrong as I need to get the latest rating for each movie from the current_user.</p>\n\n<p>For example, something alone the lines of this:</p>\n\n<pre><code>Rating.order(created_at: :desc).select('DISTINCT ON (movie_id) *')\n</code></pre>\n\n<p>My model associations:</p>\n\n<pre><code>class Movie &lt; ApplicationRecord\n  belongs_to :user\n  has_many   :ratings, dependent: :destroy\nend\n\nclass Rating &lt; ApplicationRecord\n  belongs_to :user\n  belongs_to :movie\nend\n\nclass User &lt; ApplicationRecord\n  has_many :movies\n  has_many :ratings\nend\n</code></pre>\n\n<p>Please explain the Rails query as I really want to understand this.</p>\n"}, {"tags": ["ruby", "csv", "ruby-on-rails-4", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7574951, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208457119449380/picture?type=large", "display_name": "Vladan Petrovic", "link": "https://stackoverflow.com/users/7574951/vladan-petrovic"}, "edited": false, "score": 0, "creation_date": 1568663330, "post_id": 57962626, "comment_id": 102338117, "body": "Yes, but from where to get response in this code? Because mine response.body not working, i just tried, but it&#39;s not working, neither get method."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 1, "user_id": 7574951, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208457119449380/picture?type=large", "display_name": "Vladan Petrovic", "link": "https://stackoverflow.com/users/7574951/vladan-petrovic"}, "edited": false, "score": 0, "creation_date": 1568667180, "post_id": 57962626, "comment_id": 102339557, "body": "@VladanPetrovic You should mention that you&#39;re having trouble getting the response body in your question. <code>response</code> should work so long as RSpec realizes this is a Controller test. Try setting <code>RSpec.describe ReportRuns::RunService, type: :controller</code>. See <a href=\"https://relishapp.com/rspec/rspec-rails/v/3-8/docs/controller-specs\" rel=\"nofollow noreferrer\">relishapp.com/rspec/rspec-rails/v/3-8/docs/controller-specs</a> for more."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": false, "score": 0, "last_activity_date": 1568658988, "creation_date": 1568658988, "answer_id": 57962626, "question_id": 57960961, "link": "https://stackoverflow.com/questions/57960961/how-to-inspect-csv-file-columns-inside-rspec-test/57962626#57962626", "title": "How to inspect CSV file columns inside RSpec test?", "body": "<p>Use the <a href=\"https://ruby-doc.org/stdlib-2.6.4/libdoc/csv/rdoc/CSV.html\" rel=\"nofollow noreferrer\"><code>CSV</code> library</a> to parse the body of the response. Then work with the CSV object.</p>\n\n<pre><code>csv = CSV.new(response.body)\n</code></pre>\n\n<p>You can also check the Content-type headers are correct, <code>text/csv</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 7574951, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208457119449380/picture?type=large", "display_name": "Vladan Petrovic", "link": "https://stackoverflow.com/users/7574951/vladan-petrovic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568658988, "creation_date": 1568651231, "last_edit_date": 1568656083, "question_id": 57960961, "link": "https://stackoverflow.com/questions/57960961/how-to-inspect-csv-file-columns-inside-rspec-test", "title": "How to inspect CSV file columns inside RSpec test?", "body": "<p>I really don't know how to inspect CSV file I created in my ROR App.</p>\n\n<pre><code>require \"rails_helper\"\nrequire \"shared_contexts/vcr/s3\"\nrequire \"csv\"\n\nRSpec.describe ReportRuns::RunService do\n  describe \"CSV columns\" do\n    include_context \"vcr s3 put csv\"\n\n    let(:report_run) { create :report_run, report_template: report_template, created_by: user.id, mime_type: \"csv\" }\n    #let(:report_template) { create :report_template, template_structure: { module: \"trial_members\", filters: { trial_members: [trial_members.id] } } }\n    let(:report_template) { create :report_template, trial: trial }\n    let(:trial) { create :trial }\n    let(:user) { create :user }\n    let(:user_role) { create :user_role }\n\n    subject { described_class.new(report_run) }\n\n    before do\n    end\n\n    it do\n      get :index, format: :csv\n      p \"response jee: #{response.body}\"\n      p response.headers\n      p \"report run: #{report_run.inspect}\"\n      p \"templejt: #{report_template.inspect}\"\n      p \"mime type: #{report_run[:mime_type]}\"\n      #p \"trila je: #{trial.inspect}\"\n      p \"users are: #{user.inspect}\"\n      p \"user roles su: #{user_role.inspect}\"\n      is_expected.to be_truthy\n      expect(5).to match(5)\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "sinatra", "rake"], "answers": [{"tags": [], "owner": {"reputation": 5565, "user_id": 1695507, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1f7f9576a6f6486bf26e4a8dbbf09868?s=128&d=identicon&r=PG", "display_name": "thumbtackthief", "link": "https://stackoverflow.com/users/1695507/thumbtackthief"}, "is_accepted": true, "score": 0, "last_activity_date": 1574094372, "last_edit_date": 1574094372, "creation_date": 1568650788, "answer_id": 57960877, "question_id": 57960784, "link": "https://stackoverflow.com/questions/57960784/sinatra-cannot-generate-schema-or-show-migration-status/57960877#57960877", "title": "Sinatra cannot generate schema or show migration status", "body": "<p>Apparently there are issues with ActiveRecord 6.0.  Changing my Gemfile to <code>\nactiverecord, \"5.2.3\"</code> fixed everything.  </p>\n"}], "owner": {"reputation": 5565, "user_id": 1695507, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1f7f9576a6f6486bf26e4a8dbbf09868?s=128&d=identicon&r=PG", "display_name": "thumbtackthief", "link": "https://stackoverflow.com/users/1695507/thumbtackthief"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 57960877, "answer_count": 1, "score": 0, "last_activity_date": 1574094372, "creation_date": 1568650425, "question_id": 57960784, "link": "https://stackoverflow.com/questions/57960784/sinatra-cannot-generate-schema-or-show-migration-status", "title": "Sinatra cannot generate schema or show migration status", "body": "<p>My Sinatra apps no longer seem to do anything when running <code>rake db:migrate</code> or <code>rake db:migrate:status</code>.  No error messages or any other output, and the schema is not generated.  <code>rake db:create_migration</code> works as expected.  Old apps that previously worked no longer do.  Rails apps still work fine.  </p>\n\n<p>I have had a number of Ruby/RVM/rbenv issues but I think (hope?) they are settled, and am using Ruby 2.6.0, Sinatra 2.0.7, Active Record 6.0.0 &amp; Sinatra-activerecord 2.0.14</p>\n"}, {"tags": ["ruby", "exception"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 4, "creation_date": 1568648453, "post_id": 57960066, "comment_id": 102332250, "body": "You proposed working solution (particular <code>rescue</code>, followed by sink-all <code>rescue</code>) is the idiomatic right way to go. It is not ugly by any mean."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1568648572, "post_id": 57960066, "comment_id": 102332309, "body": "If the <code>ParserException</code> is <i>yours</i> class, you might reimplement its <code>initialize</code> function and if <code>ex</code> is <i>already</i> a <code>ParserException</code> just clone it. Then single <code>rescue</code> would do."}, {"owner": {"reputation": 30188, "user_id": 3218692, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/4pA4T.jpg?s=128&g=1", "display_name": "Yeldar Kurmangaliyev", "link": "https://stackoverflow.com/users/3218692/yeldar-kurmangaliyev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1568649452, "post_id": 57960066, "comment_id": 102332748, "body": "@AlekseiMatiushkin Thank you for your answer :) Yeah, I was mostly worried about the Ruby idioms, because I am just learning the language. The second idea sounds good too, I will try this."}, {"owner": {"reputation": 550, "user_id": 4612071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda66985f822d7bfdee5d90e505379c3?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeblast77", "link": "https://stackoverflow.com/users/4612071/arcadeblast77"}, "edited": false, "score": 0, "creation_date": 1568654963, "post_id": 57960066, "comment_id": 102335005, "body": "When you say the exception is &quot;caught, wrapped, and then re-thrown with a less meaningful message,&quot; won&#39;t this happen for other types of exceptions as well? Or is that what you really want?"}, {"owner": {"reputation": 30188, "user_id": 3218692, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/4pA4T.jpg?s=128&g=1", "display_name": "Yeldar Kurmangaliyev", "link": "https://stackoverflow.com/users/3218692/yeldar-kurmangaliyev"}, "reply_to_user": {"reputation": 550, "user_id": 4612071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda66985f822d7bfdee5d90e505379c3?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeblast77", "link": "https://stackoverflow.com/users/4612071/arcadeblast77"}, "edited": false, "score": 1, "creation_date": 1568711051, "post_id": 57960066, "comment_id": 102351879, "body": "@arcadeblast77 Oh, yeah, this is what I want to happen to any unexpected exceptions of any other type :) But I want to let my <code>ParserException</code>s to pass through with original message"}], "answers": [{"tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": true, "score": 3, "last_activity_date": 1568649425, "creation_date": 1568649425, "answer_id": 57960533, "question_id": 57960066, "link": "https://stackoverflow.com/questions/57960066/handle-all-types-of-errors-except-one-in-ruby/57960533#57960533", "title": "Handle all types of errors except one in Ruby?", "body": "<p>Your current fix is probably the cleanest way to go, however I you don't want that additional rescue block you can also handle it in your catch-all solution.</p>\n\n<pre><code>begin \n  # ...\nrescue =&gt; ex\n  raise if ex.is_a? ParserException\n  raise ParserException.new(\"exception occurred when tried to parse JSON\", ex: ex)\nend\n</code></pre>\n"}], "owner": {"reputation": 30188, "user_id": 3218692, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/4pA4T.jpg?s=128&g=1", "display_name": "Yeldar Kurmangaliyev", "link": "https://stackoverflow.com/users/3218692/yeldar-kurmangaliyev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 57960533, "answer_count": 1, "score": 1, "last_activity_date": 1568649425, "creation_date": 1568647649, "question_id": 57960066, "link": "https://stackoverflow.com/questions/57960066/handle-all-types-of-errors-except-one-in-ruby", "title": "Handle all types of errors except one in Ruby?", "body": "<p>I have a method which might throw <code>ParserException</code> with some meaningful description, and throw general <code>ParserException</code> on any <code>StandardError</code>:</p>\n\n<p>Just as a minimal reproducible example:</p>\n\n<pre><code>begin\n  item = parseItem(json)\n\n  if !item.id\n    raise ParserException.new(\"id property is missing\")\n  end\n\n  item\nrescue =&gt; ex\n  raise ParserException.new(\"exception occurred when tried to parse JSON\", ex: ex)\nend\n</code></pre>\n\n<p>Now, the problem is that if the <code>id</code> property is missing, then the <code>ParserException</code> is being caught, wrapped into another <code>ParserException</code> and then re-thrown with less meaningful message. </p>\n\n<p>I can fix it by doing this:</p>\n\n<pre><code>begin \n  # ...\nrescue ParserException\n  raise\nrescue =&gt; ex\n  raise ParserException.new(\"exception occurred when tried to parse JSON\", ex: ex)\nend\n</code></pre>\n\n<p>But it may look a little ugly. Is there a more laconic way to achieve this? Something like <code>rescue !ParserException =&gt; ex</code>?</p>\n\n<p>For example, in C# I can do (this may be considered ugly too, but I am asking because of curiosity):</p>\n\n<pre><code>try\n{\n    throw new ParserException(\"Specific error\");\ncatch (Exception ex) when (!(ex is ParserException))\n{\n    throw new ParserException(\"Generic error\");\n}\n</code></pre>\n"}, {"tags": ["ruby", "jira", "rest-client"], "comments": [{"owner": {"reputation": 1692, "user_id": 5879740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8gQJ4.jpg?s=128&g=1", "display_name": "Constantin Guidon", "link": "https://stackoverflow.com/users/5879740/constantin-guidon"}, "edited": false, "score": 0, "creation_date": 1568642337, "post_id": 57958352, "comment_id": 102328723, "body": "maybe share the error response ? this coul be helpfull"}, {"owner": {"reputation": 495, "user_id": 490594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c927dfc2453b77d663e9b75a6ba0a7b0?s=128&d=identicon&r=PG", "display_name": "ry_donahue", "link": "https://stackoverflow.com/users/490594/ry-donahue"}, "edited": false, "score": 0, "creation_date": 1568642780, "post_id": 57958352, "comment_id": 102328999, "body": "Can you please provide some details regarding the error you are getting. It likely depends on the auth type that your Jira server is configured to. I would highly recommend looking at the <code>jira-ruby</code> gem for all the auth support."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6747969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d31b59452a0e9e362cc51eeef93118?s=128&d=identicon&r=PG&f=1", "display_name": "ChangeOfSeasons", "link": "https://stackoverflow.com/users/6747969/changeofseasons"}, "edited": false, "score": 0, "creation_date": 1568643829, "post_id": 57958773, "comment_id": 102329577, "body": "After changing to payload and changing the payload to - payload.to_json - I now get error 500 Internal server error, any ideas maybe?"}], "tags": [], "owner": {"reputation": 495, "user_id": 490594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c927dfc2453b77d663e9b75a6ba0a7b0?s=128&d=identicon&r=PG", "display_name": "ry_donahue", "link": "https://stackoverflow.com/users/490594/ry-donahue"}, "is_accepted": false, "score": 0, "last_activity_date": 1568643359, "creation_date": 1568643359, "answer_id": 57958773, "question_id": 57958352, "link": "https://stackoverflow.com/questions/57958352/create-issue-in-jira-api-using-ruby-rest-client/57958773#57958773", "title": "create issue in Jira API using Ruby rest client", "body": "<p>Have you tried changing <code>fields</code> to <code>payload</code>? </p>\n\n<p>Looking at the <a href=\"https://github.com/rest-client/rest-client/blob/master/lib/restclient/request.rb#L73\" rel=\"nofollow noreferrer\">code</a> and <a href=\"https://github.com/rest-client/rest-client/blob/master/spec/unit/request_spec.rb#L241\" rel=\"nofollow noreferrer\">specs</a> for the RestClient project it doesn't appear to be a valid field.</p>\n\n<p>If not I would suggest reading my comment on the post as it can be any number of things. </p>\n"}], "owner": {"reputation": 31, "user_id": 6747969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d31b59452a0e9e362cc51eeef93118?s=128&d=identicon&r=PG&f=1", "display_name": "ChangeOfSeasons", "link": "https://stackoverflow.com/users/6747969/changeofseasons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568643359, "creation_date": 1568641969, "last_edit_date": 1568642601, "question_id": 57958352, "link": "https://stackoverflow.com/questions/57958352/create-issue-in-jira-api-using-ruby-rest-client", "title": "create issue in Jira API using Ruby rest client", "body": "<p>I'm trying to create an issue in Jira using rest-client in ruby, I'm new to this method (used only postman until now) and I don't understand the \"url,payload,headers\" structure - below under \"fields\" is my \"payload\" or the fields I want to send, I was not able to succeed sending a successfull post request using rest - client and appreciate all help given :)</p>\n\n<pre><code>url = 'my_url'\n\nresponse = RestClient::Request.new(\n    :method =&gt; :post,\n    :url =&gt; url,\n    :user =&gt; 'username',\n    :password =&gt; 'pasword',\n    :fields =&gt; {\n      :project =&gt; {:id =&gt; 'some_id'},\n      :issuetype =&gt; {:id =&gt; 'some_type_id'},\n      :reporter =&gt; {:name =&gt; 'some_name'},\n      :components =&gt; [{:id =&gt; 'some_comp_id'}]\n    },\n    :headers =&gt; { :content_type =&gt; :json },\n  ).execute\n  results = JSON.parse(response.to_str, symbolize_names: true)\n</code></pre>\n\n<p>P.S - I did not share the error response due to the fact that every time I change something I seem to get a different one, my problem is in the syntax I think and the misunderstanding of the proper structure of this request.</p>\n\n<p>Current error is - 415 Unsupported Media Type</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "xml", "rss", "reader"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1568638631, "post_id": 57956901, "comment_id": 102326501, "body": "the code you have provided does not produce the same output you&#39;ve shown.  did you leave something out?"}, {"owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1568653889, "post_id": 57956901, "comment_id": 102334558, "body": "no, look this is the xml from parsed url <a href=\"https://www.youtube.com/feeds/videos.xml?channel_id=UCAUZpKBrZ-QP72Y0blet6DA\" rel=\"nofollow noreferrer\">youtube.com/feeds/&hellip;</a> this is preview of xml which is returned in parse"}], "answers": [{"comments": [{"owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "edited": false, "score": 0, "creation_date": 1568654487, "post_id": 57959967, "comment_id": 102334804, "body": "thank you very much for your solution but you will see i am still dont seeing this media:group  values <a href=\"https://ibb.co/5F5f8BZ\" rel=\"nofollow noreferrer\">ibb.co/5F5f8BZ</a> in this specific case I need media:description   content somehow your solution is clean and it shows these roots keys above &lt;media:group&gt;"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "edited": false, "score": 1, "creation_date": 1568665347, "post_id": 57959967, "comment_id": 102338907, "body": "I&#39;m not sure why but it seems that whatever your RSS is sending back doesn&#39;t match your example xml. I&#39;ve updated to provide alternate example, but the hash methods also work on your sample XML"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 1, "last_activity_date": 1568666781, "last_edit_date": 1568666781, "creation_date": 1568647324, "answer_id": 57959967, "question_id": 57956901, "link": "https://stackoverflow.com/questions/57956901/parsing-youtube-rss-feed/57959967#57959967", "title": "Parsing youtube rss feed", "body": "<h3>Updated to handle your example XML</h3>\n\n<p>Rss feeds should return xml. As such, you can use the <a href=\"https://github.com/rails/rails/search?q=def%20from_xml&amp;unscoped_q=def%20from_xml\" rel=\"nofollow noreferrer\">ActiveSupport gem</a> to parse it.</p>\n\n<pre><code>require 'rss'\nrequire 'active_support/core_ext/hash'\n\nrss = RSS::Parser.parse( \"https://www.youtube.com/feeds/videos.xml?channel_id=UCAUZpKBrZ-QP72Y0blet6DA\", false)\n\narray = rss.entries.map do |e|\n  Hash.from_xml(e.to_s)\nend\n\n# here is exactly what is contained in this array:\narray.each{|i| puts i.inspect}\n#returns\n{\"entry\"=&gt;{\"author\"=&gt;{\"name\"=&gt;\"FES TV\", \"uri\"=&gt;\"https://www.youtube.com/channel/UCAUZpKBrZ-QP72Y0blet6DA\"}, \"id\"=&gt;\"yt:video:bXrwymDw4_Q\", \"link\"=&gt;{\"href\"=&gt;\"https://www.youtube.com/watch?v=bXrwymDw4_Q\", \"rel\"=&gt;\"alternate\"}, \"published\"=&gt;\"2019-09-13T18:00:00+00:00\", \"title\"=&gt;\"ONI NE \u017dELE DA OVO ZNATE | Nemogu\u0107e slu\u010dajnosti i skrivena znanja\", \"updated\"=&gt;\"2019-09-15T23:51:10+00:00\"}}\n{\"entry\"=&gt;{\"author\"=&gt;{\"name\"=&gt;\"FES TV\", \"uri\"=&gt;\"https://www.youtube.com/channel/UCAUZpKBrZ-QP72Y0blet6DA\"}, \"id\"=&gt;\"yt:video:j4XZPSTv7Ng\", \"link\"=&gt;{\"href\"=&gt;\"https://www.youtube.com/watch?v=j4XZPSTv7Ng\", \"rel\"=&gt;\"alternate\"}, \"published\"=&gt;\"2019-09-05T18:01:10+00:00\", \"title\"=&gt;\"RTANJ | Tajna najve\u0107e prirodne Piramide krije se u dubini !\", \"updated\"=&gt;\"2019-09-10T05:37:24+00:00\"}}\n{\"entry\"=&gt;{\"author\"=&gt;{\"name\"=&gt;\"FES TV\", \"uri\"=&gt;\"https://www.youtube.com/channel/UCAUZpKBrZ-QP72Y0blet6DA\"}, \"id\"=&gt;\"yt:video:pS1ciuLX_jQ\", \"link\"=&gt;{\"href\"=&gt;\"https://www.youtube.com/watch?v=pS1ciuLX_jQ\", \"rel\"=&gt;\"alternate\"}, \"published\"=&gt;\"2019-08-28T18:00:38+00:00\", \"title\"=&gt;\"Nestaje 30% Amazona-a | Istina koju niko ne govori\", \"updated\"=&gt;\"2019-09-02T11:51:42+00:00\"}}\n{\"entry\"=&gt;{\"author\"=&gt;{\"name\"=&gt;\"FES TV\", \"uri\"=&gt;\"https://www.youtube.com/channel/UCAUZpKBrZ-QP72Y0blet6DA\"}, \"id\"=&gt;\"yt:video:mvrdXJYRN3o\", \"link\"=&gt;{\"href\"=&gt;\"https://www.youtube.com/watch?v=mvrdXJYRN3o\", \"rel\"=&gt;\"alternate\"}, \"published\"=&gt;\"2019-08-22T19:31:38+00:00\", \"title\"=&gt;\"Magnetna letelica NIKOLE TESLE | Strogo \u010duvana tajna slobodne energije\", \"updated\"=&gt;\"2019-08-25T01:24:21+00:00\"}}\n{\"entry\"=&gt;{\"author\"=&gt;{\"name\"=&gt;\"FES TV\", \"uri\"=&gt;\"https://www.youtube.com/channel/UCAUZpKBrZ-QP72Y0blet6DA\"}, \"id\"=&gt;\"yt:video:uoJgcG2pG7U\", \"link\"=&gt;{\"href\"=&gt;\"https://www.youtube.com/watch?v=uoJgcG2pG7U\", \"rel\"=&gt;\"alternate\"}, \"published\"=&gt;\"2019-08-16T18:00:07+00:00\", \"title\"=&gt;\"OTKRIVENO ! Voda stara koliko i Zemlja ! U dubini le\u017ei ogromna koli\u010dina vode..\", \"updated\"=&gt;\"2019-08-21T06:23:51+00:00\"}}\n{\"entry\"=&gt;{\"author\"=&gt;{\"name\"=&gt;\"FES TV\", \"uri\"=&gt;\"https://www.youtube.com/channel/UCAUZpKBrZ-QP72Y0blet6DA\"}, \"id\"=&gt;\"yt:video:OtB3nlfDTlg\", \"link\"=&gt;{\"href\"=&gt;\"https://www.youtube.com/watch?v=OtB3nlfDTlg\", \"rel\"=&gt;\"alternate\"}, \"published\"=&gt;\"2019-07-26T18:00:16+00:00\", \"title\"=&gt;\"IDENTI\u010cNI | Video koji otvara Pandorinu kutiju\", \"updated\"=&gt;\"2019-09-13T23:25:13+00:00\"}}\n{\"entry\"=&gt;{\"author\"=&gt;{\"name\"=&gt;\"FES TV\", \"uri\"=&gt;\"https://www.youtube.com/channel/UCAUZpKBrZ-QP72Y0blet6DA\"}, \"id\"=&gt;\"yt:video:1WW3I6gpaI0\", \"link\"=&gt;{\"href\"=&gt;\"https://www.youtube.com/watch?v=1WW3I6gpaI0\", \"rel\"=&gt;\"alternate\"}, \"published\"=&gt;\"2019-07-19T18:34:41+00:00\", \"title\"=&gt;\"Strogo \u010duvana tajna | Video koji menja SVE\", \"updated\"=&gt;\"2019-07-21T23:26:27+00:00\"}}\n{\"entry\"=&gt;{\"author\"=&gt;{\"name\"=&gt;\"FES TV\", \"uri\"=&gt;\"https://www.youtube.com/channel/UCAUZpKBrZ-QP72Y0blet6DA\"}, \"id\"=&gt;\"yt:video:A3WYfyqUtCM\", \"link\"=&gt;{\"href\"=&gt;\"https://www.youtube.com/watch?v=A3WYfyqUtCM\", \"rel\"=&gt;\"alternate\"}, \"published\"=&gt;\"2019-07-13T18:14:19+00:00\", \"title\"=&gt;\"Dron snimio 2 UFO objekta iznad Hrvatske...NOVO !!\", \"updated\"=&gt;\"2019-09-13T23:18:54+00:00\"}}\n{\"entry\"=&gt;{\"author\"=&gt;{\"name\"=&gt;\"FES TV\", \"uri\"=&gt;\"https://www.youtube.com/channel/UCAUZpKBrZ-QP72Y0blet6DA\"}, \"id\"=&gt;\"yt:video:LLSfQOeYOXw\", \"link\"=&gt;{\"href\"=&gt;\"https://www.youtube.com/watch?v=LLSfQOeYOXw\", \"rel\"=&gt;\"alternate\"}, \"published\"=&gt;\"2019-07-11T20:18:35+00:00\", \"title\"=&gt;\"Edward Snowden - Video koji \u0107e vas dobro zamisliti !\", \"updated\"=&gt;\"2019-09-16T02:04:09+00:00\"}}\n{\"entry\"=&gt;{\"author\"=&gt;{\"name\"=&gt;\"FES TV\", \"uri\"=&gt;\"https://www.youtube.com/channel/UCAUZpKBrZ-QP72Y0blet6DA\"}, \"id\"=&gt;\"yt:video:pg21KbJGGQ8\", \"link\"=&gt;{\"href\"=&gt;\"https://www.youtube.com/watch?v=pg21KbJGGQ8\", \"rel\"=&gt;\"alternate\"}, \"published\"=&gt;\"2019-07-06T18:02:18+00:00\", \"title\"=&gt;\"Rover sa MARS-a poslao zbunjuju\u0107u SLIKU ?\", \"updated\"=&gt;\"2019-09-10T05:17:19+00:00\"}}\n{\"entry\"=&gt;{\"author\"=&gt;{\"name\"=&gt;\"FES TV\", \"uri\"=&gt;\"https://www.youtube.com/channel/UCAUZpKBrZ-QP72Y0blet6DA\"}, \"id\"=&gt;\"yt:video:sWXJCoakSGg\", \"link\"=&gt;{\"href\"=&gt;\"https://www.youtube.com/watch?v=sWXJCoakSGg\", \"rel\"=&gt;\"alternate\"}, \"published\"=&gt;\"2019-07-04T18:00:40+00:00\", \"title\"=&gt;\"Od MUNJE do 5G MRE\u017dE | Video o misteriji tehnologije\", \"updated\"=&gt;\"2019-09-15T23:46:36+00:00\"}}\n{\"entry\"=&gt;{\"author\"=&gt;{\"name\"=&gt;\"FES TV\", \"uri\"=&gt;\"https://www.youtube.com/channel/UCAUZpKBrZ-QP72Y0blet6DA\"}, \"id\"=&gt;\"yt:video:CjQRz-QBN0M\", \"link\"=&gt;{\"href\"=&gt;\"https://www.youtube.com/watch?v=CjQRz-QBN0M\", \"rel\"=&gt;\"alternate\"}, \"published\"=&gt;\"2019-06-29T17:02:11+00:00\", \"title\"=&gt;\"Doktori koji su otkrili za\u010dudjuju\u0107e \u010dinjenice o mozgu !\", \"updated\"=&gt;\"2019-09-01T10:39:17+00:00\"}}\n{\"entry\"=&gt;{\"author\"=&gt;{\"name\"=&gt;\"FES TV\", \"uri\"=&gt;\"https://www.youtube.com/channel/UCAUZpKBrZ-QP72Y0blet6DA\"}, \"id\"=&gt;\"yt:video:4lRH5mlP55g\", \"link\"=&gt;{\"href\"=&gt;\"https://www.youtube.com/watch?v=4lRH5mlP55g\", \"rel\"=&gt;\"alternate\"}, \"published\"=&gt;\"2019-06-21T18:45:25+00:00\", \"title\"=&gt;\"Ukrajinski UFO slu\u010daj...Istina se pokazala neo\u010dekivano...!\", \"updated\"=&gt;\"2019-07-27T04:12:15+00:00\"}}\n{\"entry\"=&gt;{\"author\"=&gt;{\"name\"=&gt;\"FES TV\", \"uri\"=&gt;\"https://www.youtube.com/channel/UCAUZpKBrZ-QP72Y0blet6DA\"}, \"id\"=&gt;\"yt:video:9Rbm6rf71DE\", \"link\"=&gt;{\"href\"=&gt;\"https://www.youtube.com/watch?v=9Rbm6rf71DE\", \"rel\"=&gt;\"alternate\"}, \"published\"=&gt;\"2019-06-19T18:52:03+00:00\", \"title\"=&gt;\"BIONI su \u0161ta ?... Ovo \u0107e vas dobro zamisliti ( neverovatan intervju ) ! Goran Miti\u0107\", \"updated\"=&gt;\"2019-08-25T01:12:55+00:00\"}}\n{\"entry\"=&gt;{\"author\"=&gt;{\"name\"=&gt;\"FES TV\", \"uri\"=&gt;\"https://www.youtube.com/channel/UCAUZpKBrZ-QP72Y0blet6DA\"}, \"id\"=&gt;\"yt:video:X-CpIriD99M\", \"link\"=&gt;{\"href\"=&gt;\"https://www.youtube.com/watch?v=X-CpIriD99M\", \"rel\"=&gt;\"alternate\"}, \"published\"=&gt;\"2019-06-17T19:40:42+00:00\", \"title\"=&gt;\"U\u017dIVO -  Da pomogne brat bratu i sestra sestri\", \"updated\"=&gt;\"2019-07-02T22:48:42+00:00\"}}\n</code></pre>\n\n<p>The problem is that none of this contains the XML you pasted in you question so lets define it as you have it:</p>\n\n<pre><code>xml  = &lt;&lt;-XML\n    &lt;feed xmlns:yt=\"http://www.youtube.com/xml/schemas/2015\" xmlns:media=\"http://search.yahoo.com/mrss/\" xmlns=\"http://www.w3.org/2005/Atom\"&gt;\n    &lt;link rel=\"self\" href=\"http://www.youtube.com/feeds/videos.xml?channel_id=UCAUZpKBrZ-QP72Y0blet6DA\"/&gt;\n    &lt;id&gt;yt:channel:UCAUZpKBrZ-QP72Y0blet6DA&lt;/id&gt;\n    &lt;yt:channelId&gt;UCAUZpKBrZ-QP72Y0blet6DA&lt;/yt:channelId&gt;\n    &lt;title&gt;FES TV&lt;/title&gt;\n    &lt;link rel=\"alternate\" href=\"https://www.youtube.com/channel/UCAUZpKBrZ-QP72Y0blet6DA\"/&gt;\n    &lt;author&gt;\n    &lt;name&gt;FES TV&lt;/name&gt;\n    &lt;uri&gt;\n    https://www.youtube.com/channel/UCAUZpKBrZ-QP72Y0blet6DA\n    &lt;/uri&gt;\n    &lt;/author&gt;\n    &lt;published&gt;2017-07-11T18:35:49+00:00&lt;/published&gt;\n    &lt;entry&gt;\n    &lt;id&gt;yt:video:bXrwymDw4_Q&lt;/id&gt;\n    &lt;yt:videoId&gt;bXrwymDw4_Q&lt;/yt:videoId&gt;\n    &lt;yt:channelId&gt;UCAUZpKBrZ-QP72Y0blet6DA&lt;/yt:channelId&gt;\n    &lt;title&gt;...&lt;/title&gt;\n    &lt;link rel=\"alternate\" href=\"https://www.youtube.com/watch?v=bXrwymDw4_Q\"/&gt;\n    &lt;author&gt;...&lt;/author&gt;\n    &lt;published&gt;2019-09-13T18:00:00+00:00&lt;/published&gt;\n    &lt;updated&gt;2019-09-15T23:51:10+00:00&lt;/updated&gt;\n    &lt;media:group&gt;\n    &lt;media:title&gt;\n    ONI NE \u017dELE DA OVO ZNATE | Nemogu\u0107e slu\u010dajnosti i skrivena znanja\n    &lt;/media:title&gt;\n    &lt;media:content url=\"https://www.youtube.com/v/bXrwymDw4_Q?version=3\" type=\"application/x-shockwave-flash\" width=\"640\" height=\"390\"/&gt;\n    &lt;media:thumbnail url=\"https://i3.ytimg.com/vi/bXrwymDw4_Q/hqdefault.jpg\" width=\"480\" height=\"360\"/&gt;\n    &lt;media:description&gt;\n    Se\u0107am se bilo je to davno kada sam pogledao dokumentarac pod nazivom Tajna ili Secret. Na kraju bio sam zate\u010den. Doboko u sebi ose\u0107ao sam da u tome ima smisla. I ako sam tada znao mnogo manje nego \u0161to danas znam , po\u010deo da primenjujem mo\u0107 pozitivnih misli i da dajem sve od sebe da suzbijam negativne \u0161to vi\u0161e mogu. \u017deleo sam dve stvari i govorio u sebi \" Bo\u017ee neka se desi sve \u0161to mora samo ne daj da skrenem sa puta umetnosti i da budem sa \u017eenom koja me ne voli.\" Ljubav je do\u0161la ali se \u010dinilo da mi umetnost okre\u0107e ledja. Pod utiskom Tajne , verovao sam . Usledio je poziv za moj budu\u0107i bend. A sada znam da je samo taj poziv mogao da me zadr\u017ei da ponovo ne odem u Italiju i tamo ostanem da \u017eivim pogre\u0161an \u017eivot. Tada sam shvatio da moja ogromna \u017eelja izaziva budu\u0107e dogadjaje... Najve\u0107e tajne kriju se na najo\u010diglednijim mestima.Pred o\u010dima i du\u0161om. Istra\u017eivaju\u0107i shvatio sam da je \u010duveni analiti\u010dki psiholog Karl Jung posvetio skoro 30 godina istra\u017eivanju povezanosti misli i budu\u0107nosti. Zaklju\u010dak nazvao je sinhronicitet. Ko \u017eeli da pomogne radu FES TV kanala mo\u017ee to uciniti uplatom na moj - 1 - PayPal preko ovog linka - PayPal.Me/FESTVyoutubechannel 2 - Telenor Banka na racun 115-0381628762378-88 Mnogo hvala svakome ko to uradi ! Who wants to help me on the way to the truth can donate through this PayPal link - PayPal.Me/FESTVyoutubechannel Thank you very much ! Zbog mnogo poruka , mejlova i komentara koje dobijam od vas nisam u mogucnosti da svakom odgovorim. Iz tog razloga ako imte neko va\u017eno pitanje da mi postavite , pi\u0161ite mi na mail - pisitenafestv@gmail.com Because of the many messages and comments I get from you, I'm not able to answer everyone. For this reason, if you have an important question to ask me, write me a mail - pisitenafestv@gmail.com\n    &lt;/media:description&gt;\n    &lt;media:community&gt;\n    &lt;media:starRating count=\"2656\" average=\"4.90\" min=\"1\" max=\"5\"/&gt;\n    &lt;media:statistics views=\"58887\"/&gt;\n    &lt;/media:community&gt;\n    &lt;/media:group&gt;\n    &lt;/entry&gt;\n    &lt;/feed&gt;\n    XML\narray = Hash.from_xml()\n</code></pre>\n\n<p>Use <a href=\"https://github.com/savonrb/nori\" rel=\"nofollow noreferrer\">nori gem</a></p>\n\n<p>First do <code>gem install nori</code> as it seems to handle name-spaced tags. Then in your code</p>\n\n<pre><code>require 'nori'\n\n# now the easy nori magic\nparser = Nori.new\nhash = parser.parse(xml)\npp hash\n=&gt;{\"feed\"=&gt;\n  {\"link\"=&gt;\n    [{\"@rel\"=&gt;\"self\",\n      \"@href\"=&gt;\n       \"http://www.youtube.com/feeds/videos.xml?channel_id=UCAUZpKBrZ-QP72Y0blet6DA\"},\n     {\"@rel\"=&gt;\"alternate\",\n      \"@href\"=&gt;\"https://www.youtube.com/channel/UCAUZpKBrZ-QP72Y0blet6DA\"}],\n   \"id\"=&gt;\"yt:channel:UCAUZpKBrZ-QP72Y0blet6DA\",\n   \"yt:channelId\"=&gt;\"UCAUZpKBrZ-QP72Y0blet6DA\",\n   \"title\"=&gt;\"FES TV\",\n   \"author\"=&gt;\n    {\"name\"=&gt;\"FES TV\",\n     \"uri\"=&gt;\n      \"\\n\" + \"https://www.youtube.com/channel/UCAUZpKBrZ-QP72Y0blet6DA\\n\"},\n   \"published\"=&gt;Tue, 11 Jul 2017 18:35:49 +0000,\n   \"entry\"=&gt;\n    {\"id\"=&gt;\"yt:video:bXrwymDw4_Q\",\n     \"yt:videoId\"=&gt;\"bXrwymDw4_Q\",\n     \"yt:channelId\"=&gt;\"UCAUZpKBrZ-QP72Y0blet6DA\",\n     \"title\"=&gt;\"...\",\n     \"link\"=&gt;\n      {\"@rel\"=&gt;\"alternate\",\n       \"@href\"=&gt;\"https://www.youtube.com/watch?v=bXrwymDw4_Q\"},\n     \"author\"=&gt;\"...\",\n     \"published\"=&gt;Fri, 13 Sep 2019 18:00:00 +0000,\n     \"updated\"=&gt;Sun, 15 Sep 2019 23:51:10 +0000,\n     \"media:group\"=&gt;\n      {\"media:title\"=&gt;\n        \"\\n\" +\n        \"ONI NE \u017dELE DA OVO ZNATE | Nemogu\u0107e slu\u010dajnosti i skrivena znanja\\n\",\n       \"media:content\"=&gt;\n        {\"@url\"=&gt;\"https://www.youtube.com/v/bXrwymDw4_Q?version=3\",\n         \"@type\"=&gt;\"application/x-shockwave-flash\",\n         \"@width\"=&gt;\"640\",\n         \"@height\"=&gt;\"390\"},\n       \"media:thumbnail\"=&gt;\n        {\"@url\"=&gt;\"https://i3.ytimg.com/vi/bXrwymDw4_Q/hqdefault.jpg\",\n         \"@width\"=&gt;\"480\",\n         \"@height\"=&gt;\"360\"},\n       \"media:description\"=&gt;\n        \"\\n\" +\n        \"Se\u0107am se bilo je to davno kada sam pogledao dokumentarac pod nazivom Tajna ili Secret. Na kraju bio sam zate\u010den. Doboko u sebi ose\u0107ao sam da u tome ima smisla. I ako sam tada znao mnogo manje nego \u0161to danas znam , po\u010deo da primenjujem mo\u0107 pozitivnih misli i da dajem sve od sebe da suzbijam negativne \u0161to vi\u0161e mogu. \u017deleo sam dve stvari i govorio u sebi \\\" Bo\u017ee neka se desi sve \u0161to mora samo ne daj da skrenem sa puta umetnosti i da budem sa \u017eenom koja me ne voli.\\\" Ljubav je do\u0161la ali se \u010dinilo da mi umetnost okre\u0107e ledja. Pod utiskom Tajne , verovao sam . Usledio je poziv za moj budu\u0107i bend. A sada znam da je samo taj poziv mogao da me zadr\u017ei da ponovo ne odem u Italiju i tamo ostanem da \u017eivim pogre\u0161an \u017eivot. Tada sam shvatio da moja ogromna \u017eelja izaziva budu\u0107e dogadjaje... Najve\u0107e tajne kriju se na najo\u010diglednijim mestima.Pred o\u010dima i du\u0161om. Istra\u017eivaju\u0107i shvatio sam da je \u010duveni analiti\u010dki psiholog Karl Jung posvetio skoro 30 godina istra\u017eivanju povezanosti misli i budu\u0107nosti. Zaklju\u010dak nazvao je sinhronicitet. Ko \u017eeli da pomogne radu FES TV kanala mo\u017ee to uciniti uplatom na moj - 1 - PayPal preko ovog linka - PayPal.Me/FESTVyoutubechannel 2 - Telenor Banka na racun 115-0381628762378-88 Mnogo hvala svakome ko to uradi ! Who wants to help me on the way to the truth can donate through this PayPal link - PayPal.Me/FESTVyoutubechannel Thank you very much ! Zbog mnogo poruka , mejlova i komentara koje dobijam od vas nisam u mogucnosti da svakom odgovorim. Iz tog razloga ako imte neko va\u017eno pitanje da mi postavite , pi\u0161ite mi na mail - pisitenafestv@gmail.com Because of the many messages and comments I get from you, I'm not able to answer everyone. For this reason, if you have an important question to ask me, write me a mail - pisitenafestv@gmail.com\\n\",\n       \"media:community\"=&gt;\n        {\"media:starRating\"=&gt;\n          {\"@count\"=&gt;\"2656\", \"@average\"=&gt;\"4.90\", \"@min\"=&gt;\"1\", \"@max\"=&gt;\"5\"},\n         \"media:statistics\"=&gt;{\"@views\"=&gt;\"58887\"}}}},\n   \"@xmlns:yt\"=&gt;\"http://www.youtube.com/xml/schemas/2015\",\n   \"@xmlns:media\"=&gt;\"http://search.yahoo.com/mrss/\",\n   \"@xmlns\"=&gt;\"http://www.w3.org/2005/Atom\"}}\n</code></pre>\n"}], "owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1568666781, "creation_date": 1568636826, "question_id": 57956901, "link": "https://stackoverflow.com/questions/57956901/parsing-youtube-rss-feed", "title": "Parsing youtube rss feed", "body": "<p>is there any fast and clean sample of reading these media keys like   in ruby?</p>\n\n<p>Already I am using ruby rss and I am reading title,link but these media keys with semicolon I cant read. Should I use here nokogiri and xml key read? or standard ruby rss library has something for this keys?</p>\n\n<p>Code I am using for reading youtube channel feed: </p>\n\n<pre><code>require 'rss'\n\nrss = RSS::Parser.parse( \"https://www.youtube.com/feeds/videos.xml?channel_id=UCAUZpKBrZ-QP72Y0blet6DA\", false)\n\nrss.items.take(2).reverse.each do |item|\nputs item.title.content\nend\n</code></pre>\n\n<p>And here is youtube response:</p>\n\n<pre><code>&lt;feed xmlns:yt=\"http://www.youtube.com/xml/schemas/2015\" xmlns:media=\"http://search.yahoo.com/mrss/\" xmlns=\"http://www.w3.org/2005/Atom\"&gt;\n&lt;link rel=\"self\" href=\"http://www.youtube.com/feeds/videos.xml?channel_id=UCAUZpKBrZ-QP72Y0blet6DA\"/&gt;\n&lt;id&gt;yt:channel:UCAUZpKBrZ-QP72Y0blet6DA&lt;/id&gt;\n&lt;yt:channelId&gt;UCAUZpKBrZ-QP72Y0blet6DA&lt;/yt:channelId&gt;\n&lt;title&gt;FES TV&lt;/title&gt;\n&lt;link rel=\"alternate\" href=\"https://www.youtube.com/channel/UCAUZpKBrZ-QP72Y0blet6DA\"/&gt;\n&lt;author&gt;\n&lt;name&gt;FES TV&lt;/name&gt;\n&lt;uri&gt;\nhttps://www.youtube.com/channel/UCAUZpKBrZ-QP72Y0blet6DA\n&lt;/uri&gt;\n&lt;/author&gt;\n&lt;published&gt;2017-07-11T18:35:49+00:00&lt;/published&gt;\n&lt;entry&gt;\n&lt;id&gt;yt:video:bXrwymDw4_Q&lt;/id&gt;\n&lt;yt:videoId&gt;bXrwymDw4_Q&lt;/yt:videoId&gt;\n&lt;yt:channelId&gt;UCAUZpKBrZ-QP72Y0blet6DA&lt;/yt:channelId&gt;\n&lt;title&gt;...&lt;/title&gt;\n&lt;link rel=\"alternate\" href=\"https://www.youtube.com/watch?v=bXrwymDw4_Q\"/&gt;\n&lt;author&gt;...&lt;/author&gt;\n&lt;published&gt;2019-09-13T18:00:00+00:00&lt;/published&gt;\n&lt;updated&gt;2019-09-15T23:51:10+00:00&lt;/updated&gt;\n&lt;media:group&gt;\n&lt;media:title&gt;\nONI NE \u017dELE DA OVO ZNATE | Nemogu\u0107e slu\u010dajnosti i skrivena znanja\n&lt;/media:title&gt;\n&lt;media:content url=\"https://www.youtube.com/v/bXrwymDw4_Q?version=3\" type=\"application/x-shockwave-flash\" width=\"640\" height=\"390\"/&gt;\n&lt;media:thumbnail url=\"https://i3.ytimg.com/vi/bXrwymDw4_Q/hqdefault.jpg\" width=\"480\" height=\"360\"/&gt;\n&lt;media:description&gt;\nSe\u0107am se bilo je to davno kada sam pogledao dokumentarac pod nazivom Tajna ili Secret. Na kraju bio sam zate\u010den. Doboko u sebi ose\u0107ao sam da u tome ima smisla. I ako sam tada znao mnogo manje nego \u0161to danas znam , po\u010deo da primenjujem mo\u0107 pozitivnih misli i da dajem sve od sebe da suzbijam negativne \u0161to vi\u0161e mogu. \u017deleo sam dve stvari i govorio u sebi \" Bo\u017ee neka se desi sve \u0161to mora samo ne daj da skrenem sa puta umetnosti i da budem sa \u017eenom koja me ne voli.\" Ljubav je do\u0161la ali se \u010dinilo da mi umetnost okre\u0107e ledja. Pod utiskom Tajne , verovao sam . Usledio je poziv za moj budu\u0107i bend. A sada znam da je samo taj poziv mogao da me zadr\u017ei da ponovo ne odem u Italiju i tamo ostanem da \u017eivim pogre\u0161an \u017eivot. Tada sam shvatio da moja ogromna \u017eelja izaziva budu\u0107e dogadjaje... Najve\u0107e tajne kriju se na najo\u010diglednijim mestima.Pred o\u010dima i du\u0161om. Istra\u017eivaju\u0107i shvatio sam da je \u010duveni analiti\u010dki psiholog Karl Jung posvetio skoro 30 godina istra\u017eivanju povezanosti misli i budu\u0107nosti. Zaklju\u010dak nazvao je sinhronicitet. Ko \u017eeli da pomogne radu FES TV kanala mo\u017ee to uciniti uplatom na moj - 1 - PayPal preko ovog linka - PayPal.Me/FESTVyoutubechannel 2 - Telenor Banka na racun 115-0381628762378-88 Mnogo hvala svakome ko to uradi ! Who wants to help me on the way to the truth can donate through this PayPal link - PayPal.Me/FESTVyoutubechannel Thank you very much ! Zbog mnogo poruka , mejlova i komentara koje dobijam od vas nisam u mogucnosti da svakom odgovorim. Iz tog razloga ako imte neko va\u017eno pitanje da mi postavite , pi\u0161ite mi na mail - pisitenafestv@gmail.com Because of the many messages and comments I get from you, I'm not able to answer everyone. For this reason, if you have an important question to ask me, write me a mail - pisitenafestv@gmail.com\n&lt;/media:description&gt;\n&lt;media:community&gt;\n&lt;media:starRating count=\"2656\" average=\"4.90\" min=\"1\" max=\"5\"/&gt;\n&lt;media:statistics views=\"58887\"/&gt;\n&lt;/media:community&gt;\n&lt;/media:group&gt;\n&lt;/entry&gt;\n&lt;/feed&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1568635394, "post_id": 57956395, "comment_id": 102324760, "body": "Where is the <code>let!</code> you want to get rid of?"}, {"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1568635661, "post_id": 57956395, "comment_id": 102324893, "body": "@mrzasa sorry, question updated"}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1568635689, "post_id": 57956395, "comment_id": 102324904, "body": "If you want one-liner really badly, you can do <code>admin_panel_log1; admin_panel_log2</code>, but frankly, I don&#39;t see any point in doing this."}], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 4, "last_activity_date": 1568635970, "creation_date": 1568635970, "answer_id": 57956673, "question_id": 57956395, "link": "https://stackoverflow.com/questions/57956395/how-to-get-rid-of-let-using-before/57956673#57956673", "title": "How to get rid of let using before", "body": "<p>You might want to change your code to this:</p>\n\n<pre><code>describe AdminPanelLogRemoverWorker do\n  include_context 'with admin_user form'\n\n  subject(:delete_worker) { described_class.new.perform }\n\n  let(:admin_panel_log1) {\n    create :admin_panel_log, new_data: admin_user_form, created_at: 2.years.ago\n  }\n  let(:admin_panel_log2) {\n    create :admin_panel_log, new_data: admin_user_form, created_at: 2.days.ago\n  }\n\n  before do\n    admin_panel_log1\n    admin_panel_log2\n  end\n\n  context 'when admin log is outdated' do\n    it 'delete only outdated data' do\n      expect { delete_worker }.to change(AdminPanelLog, :count).by(-1)\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 57956673, "answer_count": 1, "score": 1, "last_activity_date": 1568635970, "creation_date": 1568635156, "last_edit_date": 1568635642, "question_id": 57956395, "link": "https://stackoverflow.com/questions/57956395/how-to-get-rid-of-let-using-before", "title": "How to get rid of let using before", "body": "<p>I want to get rid of <code>let!</code> - to do so I want to move it to the <code>before</code> method (it has to be created before everything else).</p>\n\n<pre><code>describe AdminPanelLogRemoverWorker do\n  include_context 'with admin_user form'\n\n  subject(:delete_worker) { described_class.new.perform }\n\n  let!(:admin_panel_log1) do\n    create :admin_panel_log,\n           new_data: admin_user_form,\n           created_at: created_at\n  end\n  let!(:admin_panel_log2) do\n    create :admin_panel_log,\n           new_data: admin_user_form,\n           created_at: 2.days.ago\n  end\n  let(:created_at) { 2.years.ago }\n\n  context 'when admin log is outdated' do\n    it 'delete only outdated data' do\n      expect { delete_worker }.to change(AdminPanelLog, :count).by(-1)\n    end\n  end\n</code></pre>\n\n<p>I want to do something like this</p>\n\n<pre><code>  before { admin_panel_log1 }\n  before { admin_panel_log2 }\n</code></pre>\n\n<p>but how to do it in one line?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1568636696, "post_id": 57956323, "comment_id": 102325431, "body": "What&#39;s <code>outcome</code>?"}, {"owner": {"reputation": 69, "user_id": 10927701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5eef80517111079e3b8b8ecf3a347972?s=128&d=identicon&r=PG&f=1", "display_name": "Marshmello", "link": "https://stackoverflow.com/users/10927701/marshmello"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1568636805, "post_id": 57956323, "comment_id": 102325504, "body": "@SebastianPalma Fixed. It&#39;s an array. Forgot to change it."}], "answers": [{"tags": [], "owner": {"reputation": 88, "user_id": 10063851, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-G5zeMgH7aAs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oQYTI4hGcoYfZpKEW3J0snppNW5A/mo/photo.jpg?sz=128", "display_name": "Steve Redka", "link": "https://stackoverflow.com/users/10063851/steve-redka"}, "is_accepted": false, "score": 1, "last_activity_date": 1568637438, "creation_date": 1568637438, "answer_id": 57957057, "question_id": 57956323, "link": "https://stackoverflow.com/questions/57956323/remove-1st-value-in-2d-array-if-they-are-same/57957057#57957057", "title": "Remove 1st value in 2D array if they are same", "body": "<blockquote>\n  <p>What is my mistake? </p>\n</blockquote>\n\n<p>Judging by input and output, you forgot what were you supposed to do, and started iterating through every element of every sub-array.</p>\n\n<p>One common method to avoid confusion is to <a href=\"https://en.wikipedia.org/wiki/Comment_(computer_programming)#Planning_and_reviewing\" rel=\"nofollow noreferrer\">use comments for planning</a>.</p>\n\n<p>Here's my solution:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def remove_firsts(arr)\n  # Make sure first elements in sub-arrays are equal\n  if arr.map { |sub_arr| sub_arr[0] }.uniq.length == 1\n    # iterate through all elements except first\n    (1...arr.length).each do |i|\n      arr[i][0] = nil\n    end\n  end\n  return arr\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 423, "user_id": 3042213, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EuND4.jpg?s=128&g=1", "display_name": "Dax", "link": "https://stackoverflow.com/users/3042213/dax"}, "is_accepted": false, "score": 1, "last_activity_date": 1568637923, "creation_date": 1568637923, "answer_id": 57957187, "question_id": 57956323, "link": "https://stackoverflow.com/questions/57956323/remove-1st-value-in-2d-array-if-they-are-same/57957187#57957187", "title": "Remove 1st value in 2D array if they are same", "body": "<p>You are mapping nil when iterating each element of the inner subarrays and keeping only the identical values.</p>\n\n<p>I suggest this simpler solution that should do what you asked:</p>\n\n<pre><code>dups = []\narray.map{|a| dups.include?(a[0]) ? a[0] = nil : dups &lt;&lt; a[0]; a }\n</code></pre>\n\n<p>Basically we don't need to loop the whole inner arrays, I just check the first element and if it has been already met, set it to nil.</p>\n\n<p>Note that this map function will act on the original array, mutating it, if you want to preserve the original data you should duplicate it before mapping as I suggested.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 0, "last_activity_date": 1568656520, "last_edit_date": 1568656520, "creation_date": 1568655769, "answer_id": 57961908, "question_id": 57956323, "link": "https://stackoverflow.com/questions/57956323/remove-1st-value-in-2d-array-if-they-are-same/57961908#57961908", "title": "Remove 1st value in 2D array if they are same", "body": "<pre><code>require 'set'\n\nf = Set.new\n\narray.map do |a|\n  f.add?(a.first) ? a : [nil, *a.drop(1)]\nend\n  #=&gt; [[\"01000290056\", 601, \"Individu\u2500\u00fclo dz\u2500\u00bdvojamo m\u2500\u00fcju apb\u253c\u00bdve\", nil, 0],\n  #    [nil, 703, \"Se\u253c\u012au l\u2500\u00bddz se\u253c\u012apadsmit...\", nil, 0],\n  #    [nil, 801, \"Komercdarb\u2500\u00bdbas objektu apb\u253c\u00bdve\", nil, 0],\n  #    [nil, 1001, \"R\u253c\u00bdpniecisk\u2500\u00fcs ra\u253c\u0160o\u253c\u012aanas uz\u253c\u00e5\u2500\u014dmumu apb\u253c\u00bdve\", nil, 0],\n  #    [nil, 1105, \"Atsevi\u253c\u012a\u2500\u0118i nodal\u2500\u00bdtas atkl\u2500\u00fctas autost\u2500\u00fcvvietas\", nil, 0]]\n</code></pre>\n\n<p>This does not modify or <em>mutate</em> <code>array</code>.</p>\n\n<p>If <code>array</code> is to be modified, you could use the following.</p>\n\n<pre><code>f = Set.new\n\narray.each { |a| a[0] = nil unless f.add?(a.first) }\narray\n</code></pre>\n\n<p>Making <code>f</code> a set, rather than array, speeds lookups, which could be important if <code>array</code> were large.</p>\n\n<p>See <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/set/rdoc/Set.html#method-c-new\" rel=\"nofollow noreferrer\">Set::new</a>, <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/set/rdoc/Set.html#method-i-add-3F\" rel=\"nofollow noreferrer\">Set#add?</a> and <a href=\"https://ruby-doc.org/core-2.6.3/Array.html#method-i-drop\" rel=\"nofollow noreferrer\">Array#drop</a>.</p>\n"}], "owner": {"reputation": 69, "user_id": 10927701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5eef80517111079e3b8b8ecf3a347972?s=128&d=identicon&r=PG&f=1", "display_name": "Marshmello", "link": "https://stackoverflow.com/users/10927701/marshmello"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 57961908, "answer_count": 3, "score": 0, "last_activity_date": 1568656520, "creation_date": 1568634940, "last_edit_date": 1568654744, "question_id": 57956323, "link": "https://stackoverflow.com/questions/57956323/remove-1st-value-in-2d-array-if-they-are-same", "title": "Remove 1st value in 2D array if they are same", "body": "<p>I'm having this type of array </p>\n\n<pre><code>array = [\n  [\"01000290056\", 601, \"Individu\u2500\u00fclo dz\u2500\u00bdvojamo m\u2500\u00fcju apb\u253c\u00bdve\", nil, 0],\n  [\"01000290056\", 703, \"Se\u253c\u012au l\u2500\u00bddz se\u253c\u012apadsmit st\u2500\u00fcvu daudzdz\u2500\u00bdvok\u2500\u255du m\u2500\u00fcju apb\u253c\u00bdve\", nil, 0],\n  [\"01000290056\", 801, \"Komercdarb\u2500\u00bdbas objektu apb\u253c\u00bdve\", nil, 0],\n  [\"01000290056\", 1001, \"R\u253c\u00bdpniecisk\u2500\u00fcs ra\u253c\u0160o\u253c\u012aanas uz\u253c\u00e5\u2500\u014dmumu apb\u253c\u00bdve\", nil, 0],\n  [\"01000290056\", 1105, \"Atsevi\u253c\u012a\u2500\u0118i nodal\u2500\u00bdtas atkl\u2500\u00fctas autost\u2500\u00fcvvietas\", nil, 0]\n]\n</code></pre>\n\n<p>In this case, <code>01000290056</code> is repeating. </p>\n\n<p>In the end, I need to get something like this</p>\n\n<pre><code>[[\"01000290056\", 601, \"Individu\u2500\u00fclo dz\u2500\u00bdvojamo m\u2500\u00fcju apb\u253c\u00bdve\", nil, 0],\n [nil, 703, \"Se\u253c\u012au l\u2500\u00bddz se\u253c\u012apadsmit st\u2500\u00fcvu daudzdz\u2500\u00bdvok\u2500\u255du m\u2500\u00fcju apb\u253c\u00bdve\", nil, 0],\n [nil, 801, \"Komercdarb\u2500\u00bdbas objektu apb\u253c\u00bdve\", nil, 0], \n [nil, 1001, \"R\u253c\u00bdpniecisk\u2500\u00fcs ra\u253c\u0160o\u253c\u012aanas uz\u253c\u00e5\u2500\u014dmumu apb\u253c\u00bdve\", nil, 0],\n [nil, 1105, \"Atsevi\u253c\u012a\u2500\u0118i nodal\u2500\u00bdtas atkl\u2500\u00fctas autost\u2500\u00fcvvietas\", nil, 0]]\n</code></pre>\n\n<p>So all duplicated values of <code>01000290056</code> should be removed. </p>\n\n<p>Im trying it do to in this way </p>\n\n<pre><code>array.each_with_index.map do |v,i|\n  v.each_with_index.map do |k,j|\n    if (i-1&gt;=0 &amp;&amp; k == array[i-1][j])\n      k\n    elsif (i+1 &lt; array.length &amp;&amp; k == array[i+1][j])\n      k\n    else\n      nil\n    end\n  end\nend\n</code></pre>\n\n<p>But it returns me this:</p>\n\n<pre><code>[[\"01000290056\", nil, nil, nil, 0],\n [\"01000290056\", nil, nil, nil, 0],\n [\"01000290056\", nil, nil, nil, 0],\n [\"01000290056\", nil, nil, nil, 0],\n [\"01000290056\", nil, nil, nil, 0]]\n</code></pre>\n\n<p>What is my mistake? </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "edited": false, "score": 0, "creation_date": 1568633206, "post_id": 57955698, "comment_id": 102323614, "body": "Doesn&#39;t it work like that? <code>require(&quot;custom&#47;startmin&quot;)</code>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user12073145"}, "edited": false, "score": 0, "creation_date": 1568637708, "post_id": 57956176, "comment_id": 102325997, "body": "is this also applies to CSS? for instance I have the stylesheet folder and i have the _metisMenu.min.css and _startmin.css files can I also include it under application.scss by adding import &quot;metisMenu.min&quot;; import &quot;startmin&quot;; ???"}, {"owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "edited": false, "score": 0, "creation_date": 1568638426, "post_id": 57956176, "comment_id": 102326373, "body": "@JoanBuan Yes you can import sytle files. I updated the answer."}, {"owner": {"reputation": 1322, "user_id": 11801415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/639b82f4bb7b8d9545d0fbc725cfcd36?s=128&d=identicon&r=PG&f=1", "display_name": "Lyzard Kyng", "link": "https://stackoverflow.com/users/11801415/lyzard-kyng"}, "edited": false, "score": 2, "creation_date": 1568721553, "post_id": 57956176, "comment_id": 102357231, "body": "@demir update your answer with (a) changing <code>stylesheet_link_tag</code> with <code>stylesheet_pack_tag</code> in <code>application.html.erb</code> and (b) setting <code>extract_css: true</code> in <code>config&#47;webpacker.yml</code>"}, {"owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "reply_to_user": {"reputation": 1322, "user_id": 11801415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/639b82f4bb7b8d9545d0fbc725cfcd36?s=128&d=identicon&r=PG&f=1", "display_name": "Lyzard Kyng", "link": "https://stackoverflow.com/users/11801415/lyzard-kyng"}, "edited": false, "score": 0, "creation_date": 1568723108, "post_id": 57956176, "comment_id": 102358049, "body": "@LyzardKyng I assumed stylesheet_pack_tag helper was added. I&#39;il update the answer."}], "tags": [], "owner": {"reputation": 3926, "user_id": 2190621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c464f439212bca87517b234f7c9bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "demir", "link": "https://stackoverflow.com/users/2190621/demir"}, "is_accepted": false, "score": 1, "last_activity_date": 1568723945, "last_edit_date": 1568723945, "creation_date": 1568634382, "answer_id": 57956176, "question_id": 57955698, "link": "https://stackoverflow.com/questions/57955698/adding-external-js-files-on-rails-6/57956176#57956176", "title": "Adding external js files on Rails 6", "body": "<p>You can add custom <strong>js</strong> files like this:</p>\n\n<ol>\n<li><p>Add your js files to <code>app/javascript</code> folder</p>\n\n<pre><code>app/javascript/custom/metisMenu.min.js\napp/javascript/custom/startmin.js\n</code></pre></li>\n<li><p>Require js files in <code>app/javascript/packs/application.js</code></p>\n\n<pre><code>require(\"@rails/ujs\").start()\nrequire(\"turbolinks\").start()\nrequire(\"@rails/activestorage\").start()\n\n#\u00a0custom js files\nrequire(\"custom/metisMenu.min\")\nrequire(\"custom/startmin\")\n</code></pre></li>\n<li>Add <code>&lt;%= javascript_pack_tag 'application' %&gt;</code> to <code>application.html.erb</code></li>\n</ol>\n\n<p><strong>UPDATE</strong></p>\n\n<p>You can add <strong>style</strong> files like this:</p>\n\n<ol>\n<li><p>Add your style files to <code>app/javascript</code> folder</p>\n\n<pre><code>app/javascript/stylesheets/metisMenu.min.scss\n</code></pre></li>\n<li><p>Import style files in <code>app/javascript/packs/application.js</code></p>\n\n<pre><code>import \"stylesheets/metisMenu.min\"\n</code></pre></li>\n<li>Add <code>&lt;%= stylesheet_pack_tag 'application' %&gt;</code> to <code>application.html.erb</code></li>\n<li>Set <code>extract_css: true</code> in <code>config/webpacker.yml</code></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 1322, "user_id": 11801415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/639b82f4bb7b8d9545d0fbc725cfcd36?s=128&d=identicon&r=PG&f=1", "display_name": "Lyzard Kyng", "link": "https://stackoverflow.com/users/11801415/lyzard-kyng"}, "edited": false, "score": 1, "creation_date": 1568635203, "post_id": 57956195, "comment_id": 102324641, "body": "You don&#39;t need <code>.js</code> extension in the second snippet"}, {"owner": {"user_type": "does_not_exist", "display_name": "user12073145"}, "edited": false, "score": 0, "creation_date": 1568637722, "post_id": 57956195, "comment_id": 102326003, "body": "is this also applies to CSS? for instance I have the stylesheet folder and i have the _metisMenu.min.css and _startmin.css files can I also include it under application.scss by adding import &quot;metisMenu.min&quot;; import &quot;startmin&quot;; ???"}], "tags": [], "owner": {"reputation": 1113, "user_id": 4701098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4QnL4.jpg?s=128&g=1", "display_name": "Samy Kacimi", "link": "https://stackoverflow.com/users/4701098/samy-kacimi"}, "is_accepted": true, "score": 3, "last_activity_date": 1568635646, "last_edit_date": 1568635646, "creation_date": 1568634463, "answer_id": 57956195, "question_id": 57955698, "link": "https://stackoverflow.com/questions/57955698/adding-external-js-files-on-rails-6/57956195#57956195", "title": "Adding external js files on Rails 6", "body": "<p>Your folder needs to be structured like that:</p>\n\n<p><strong>app/javascript/packs/application.js</strong></p>\n\n<pre><code>require(\"@rails/ujs\").start()\nrequire(\"turbolinks\").start()\nrequire(\"@rails/activestorage\").start()\nrequire(\"channels\")\n\nrequire(\"custom\")\n</code></pre>\n\n<p><strong>app/javascript/custom/index.js</strong></p>\n\n<pre><code>require(\"myScript\")\nrequire(\"mySecondScript\")\n</code></pre>\n\n<p>The <code>myScript.js</code> and <code>mySecondScript.js</code> files, for instance, will be located in the same folder ie <code>app/javascript/custom</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user12073145"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1186, "favorite_count": 0, "accepted_answer_id": 57956195, "answer_count": 2, "score": 2, "last_activity_date": 1568724292, "creation_date": 1568632675, "last_edit_date": 1568724292, "question_id": 57955698, "link": "https://stackoverflow.com/questions/57955698/adding-external-js-files-on-rails-6", "title": "Adding external js files on Rails 6", "body": "<p>I created a folder named \"custom\" under app->javascript->packs and place the following external js:</p>\n\n<ul>\n<li><code>metisMenu.min.js</code> </li>\n<li><code>startmin.js</code></li>\n</ul>\n\n<p>Then on under app->javascript->packs->application.js I required the stated js plugin above:</p>\n\n<pre><code>require(\"@rails/ujs\").start()\nrequire(\"turbolinks\").start()\nrequire(\"@rails/activestorage\").start()\nrequire(\"custom/metisMenu.min\").start()\nrequire(\"custom/startmin\").start()\nrequire(\"channels\")\n\n\nimport 'bootstrap'\nimport './stylesheets/application.scss'\n</code></pre>\n\n<p>Unfortunately, still this did not work. Any idea what am I doing wrong?</p>\n\n<p>Also is it ok to place all of the custom css under app->javascript->packs->stylesheets (folder) and not on the assets->stylesheets anymore since Rails 6 is using webpacker?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 88, "user_id": 10063851, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-G5zeMgH7aAs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oQYTI4hGcoYfZpKEW3J0snppNW5A/mo/photo.jpg?sz=128", "display_name": "Steve Redka", "link": "https://stackoverflow.com/users/10063851/steve-redka"}, "is_accepted": true, "score": 1, "last_activity_date": 1568628403, "last_edit_date": 1592644375, "creation_date": 1568628403, "answer_id": 57954568, "question_id": 57953948, "link": "https://stackoverflow.com/questions/57953948/rails-6-separate-styles-and-layout-for-dashboard-and-main-front-site/57954568#57954568", "title": "Rails 6: Separate styles and layout for dashboard and main (front) site", "body": "<blockquote>\n<p>Should I'll create another controller for the dashboard and create a different folder on the views for that?</p>\n<p>Wondering also if I can create separate layout file for my dashboard and main site.</p>\n</blockquote>\n<p>Yes, because they are literally two separate layouts.</p>\n<p>There is no hard rule for controller separation, but in this case it's a nice way to separate one group of business logic (site front) from another (dashboard). So I would make a <code>DashboardController</code> and put layout for it in <code>app/views/layouts/dashboard.html.erb</code></p>\n<p><a href=\"https://edgeguides.rubyonrails.org/layouts_and_rendering.html#finding-layouts\" rel=\"nofollow noreferrer\">This is how Rails decided which layout to use</a></p>\n<blockquote>\n<p>how I can actually link the dashboard to my created pages, controller views so far as well as controller</p>\n</blockquote>\n<p>Using <a href=\"https://api.rubyonrails.org/v5.2.3/classes/ActionView/Helpers/UrlHelper.html#method-i-link_to\" rel=\"nofollow noreferrer\">UrlHelper</a>, like usually.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8332039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2888cfc8055ef27e862a57d43c7ff8b0?s=128&d=identicon&r=PG&f=1", "display_name": "codejunker", "link": "https://stackoverflow.com/users/8332039/codejunker"}, "is_accepted": false, "score": 0, "last_activity_date": 1568629097, "creation_date": 1568629097, "answer_id": 57954769, "question_id": 57953948, "link": "https://stackoverflow.com/questions/57953948/rails-6-separate-styles-and-layout-for-dashboard-and-main-front-site/57954769#57954769", "title": "Rails 6: Separate styles and layout for dashboard and main (front) site", "body": "<p>There are many ways to solve this problem.</p>\n\n<p>But I think you are on the right way by creating seperate controller and views. A controller for the main site and one for the dashboard.</p>\n\n<p>This has the great effect that you can handle the request more specific for both sides.\nI think you want to add authorization for the dashboard. So you would implement this in the dashboard_controller.rb.</p>\n\n<p>For specific css for a rails page: <a href=\"https://stackoverflow.com/questions/35806366/adding-a-specific-stylesheet-to-a-single-rails-page\">Adding a specific stylesheet to a single Rails page</a></p>\n\n<p>I hope this was helpfully.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6398538"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419, "favorite_count": 0, "closed_date": 1601653160, "accepted_answer_id": 57954568, "answer_count": 2, "score": 0, "last_activity_date": 1568629097, "creation_date": 1568626100, "question_id": 57953948, "link": "https://stackoverflow.com/questions/57953948/rails-6-separate-styles-and-layout-for-dashboard-and-main-front-site", "closed_reason": "Opinion-based", "title": "Rails 6: Separate styles and layout for dashboard and main (front) site", "body": "<p>I will try to explain my issue as much as I can. </p>\n\n<p>I hope you guys can understand and give me an idea / help me.</p>\n\n<p>So I am working on a practice app. There are two separate bootstrap html/css design for both of my dashboard and main site.</p>\n\n<p><img src=\"https://i.imgur.com/BkGSpMi.png\" alt=\"\"></p>\n\n<p>Here's the dashboard design:\n<img src=\"https://i.imgur.com/DDlmBY6.png\" alt=\"\"></p>\n\n<p>Here's the main site design:\n<img src=\"https://i.imgur.com/BgANzle.png\" alt=\"\"></p>\n\n<p>Both of these used bootstrap but separate set of custom design css as well js files.</p>\n\n<p>So far I created a CRUD feature for both of my pages and posts (controller, migration, model, views)</p>\n\n<p><img src=\"https://i.imgur.com/arEhtQu.jpg\" alt=\"\"></p>\n\n<p>Now I am confused on whether I'll create another controller for the dashboard and create a different folder on the views for that and how I can actually link the dashboard to my created pages, controller views so far as well as controller.  Wondering also if I can create separate layout file for my dashboard and main site.</p>\n\n<p>I hope it make sense. </p>\n"}, {"tags": ["ruby", "google-ad-manager"], "answers": [{"tags": [], "owner": {"reputation": 302, "user_id": 9958176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8690434d5981ac9d5801ba6e9dfc5fdf?s=128&d=identicon&r=PG", "display_name": "ranjan_purbey", "link": "https://stackoverflow.com/users/9958176/ranjan-purbey"}, "is_accepted": false, "score": 0, "last_activity_date": 1580821272, "creation_date": 1580821272, "answer_id": 60058014, "question_id": 57953160, "link": "https://stackoverflow.com/questions/57953160/google-ad-manager-try-to-read-revenue-per-hour-fails-on-reporterror-columns-not/60058014#60058014", "title": "Google ad manager try to read revenue per hour fails on ReportError.COLUMNS_NOT_SUPPORTED_FOR_REQUESTED_DIMENSIONS", "body": "<p>Try removing <code>CUSTOM_CRITERIA</code> from the <code>:dimensions</code> list</p>\n"}], "owner": {"reputation": 1567, "user_id": 2479786, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/eiYsP.jpg?s=128&g=1", "display_name": "Ehud Lev", "link": "https://stackoverflow.com/users/2479786/ehud-lev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1580821272, "creation_date": 1568622993, "question_id": 57953160, "link": "https://stackoverflow.com/questions/57953160/google-ad-manager-try-to-read-revenue-per-hour-fails-on-reporterror-columns-not", "title": "Google ad manager try to read revenue per hour fails on ReportError.COLUMNS_NOT_SUPPORTED_FOR_REQUESTED_DIMENSIONS", "body": "<p>I have a simple script that fetch data from google ad manager. \nEverything is working pretty fine, Now I am trying to read the same data but instead of date aggregation, I am trying by day and hour. </p>\n\n<p>I get the following error:</p>\n\n<pre><code>AdManagerApi::V201905::ReportService::ApiException: [ReportError.COLUMNS_NOT_SUPPORTED_FOR_REQUESTED_DIMENSIONS @ columns; trigger:'TOTAL_LINE_ITEM_LEVEL_CPM_AND_CPC_REVENUE']\n</code></pre>\n\n<p>My report query in ruby is:</p>\n\n<pre><code># Create report query.\nreport_query = {\n  :date_range_type =&gt; 'CUSTOM_DATE',\n  :start_date =&gt; AdManagerApi::AdManagerDate.new(@ad_manager, start_date).to_h,\n  :end_date =&gt; AdManagerApi::AdManagerDate.new(@ad_manager, end_date).to_h,\n  :dimensions =&gt; ['DAY', 'HOUR', 'CUSTOM_CRITERIA'],\n  :columns =&gt; ['TOTAL_LINE_ITEM_LEVEL_CPM_AND_CPC_REVENUE']\n\n}\n</code></pre>\n\n<p>I took the full example from <a href=\"https://github.com/googleads/google-api-ads-ruby/tree/master/ad_manager_api/examples/v201905/report_service\" rel=\"nofollow noreferrer\">here</a> </p>\n\n<p>I am pretty new with the google ad manager api, I will appreciate any suggestion.</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "stripe-payments"], "comments": [{"owner": {"reputation": 666, "user_id": 1270929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6136fe60f32b1057c392250f3f17b620?s=128&d=identicon&r=PG", "display_name": "wsw", "link": "https://stackoverflow.com/users/1270929/wsw"}, "edited": false, "score": 0, "creation_date": 1568625057, "post_id": 57952453, "comment_id": 102319386, "body": "Hi Deikka, There are several possibilities that might result in this error. 1. Gon is not properly setup. can you try to <code>console.log(gon)</code> or set a break point on your chrome dev tool to make sure the Gon is setup correct with the variable?  2. You are creating subscriptions with a trial period, in this case, <code>latest_invoice.payment_intent</code> will be <code>null</code> since there will be no immediate payment needed to be done, but there will be <code>pending_setup_intent</code> available  Could you confirm which case it is for your case?"}, {"owner": {"reputation": 13, "user_id": 7629461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7056e4c252493913300e0e9b0c5b19e8?s=128&d=identicon&r=PG", "display_name": "deikka", "link": "https://stackoverflow.com/users/7629461/deikka"}, "reply_to_user": {"reputation": 666, "user_id": 1270929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6136fe60f32b1057c392250f3f17b620?s=128&d=identicon&r=PG", "display_name": "wsw", "link": "https://stackoverflow.com/users/1270929/wsw"}, "edited": false, "score": 0, "creation_date": 1568651841, "post_id": 57952453, "comment_id": 102333714, "body": "Hi @wsw, yes, It seems that Gon is not getting the subscription value... :( But it&#39;s weird, i&#39;m using gon in other controlles and seems to work fine... I don&#39;t know... Thansk anyway, I&#39;l try another options."}], "owner": {"reputation": 13, "user_id": 7629461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7056e4c252493913300e0e9b0c5b19e8?s=128&d=identicon&r=PG", "display_name": "deikka", "link": "https://stackoverflow.com/users/7629461/deikka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 502, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568620165, "creation_date": 1568620165, "question_id": 57952453, "link": "https://stackoverflow.com/questions/57952453/stripe-sca-migration-how-do-i-get-the-paymentintent-client-secret", "title": "Stripe SCA migration, how do I get the PaymentIntent &#39;client_secret&#39;?", "body": "<p>I'm in the process to migrate my stripe integration to the new SCA european regulation. I'm using Stripe Billing with the stripe gem (<a href=\"https://github.com/stripe/stripe-ruby\" rel=\"nofollow noreferrer\">https://github.com/stripe/stripe-ruby</a>), Rails 5.2 (ruby 2.6.4). I also have turbolinks 'on'.</p>\n\n<p>I'm struggling with the 3D secure authentication, the Stripe.js script should handle this smoothly, but I can't manage to feed the variable that I need in order to do it. </p>\n\n<p>The documentation says that the Billing engine creates a PaymentIntent, so I don't have to create it my self. With this object must come a client_cecret, that I have to pass to the view. I will do this with the gon gem(<a href=\"https://github.com/gazay/gon\" rel=\"nofollow noreferrer\">https://github.com/gazay/gon</a>). To get this secret, I have to 'expand' the subscription object with the 'latest_invoice.payment_intent', according to Stripe docs, and then pass the 'latest_invoice.payment_intent.client_secret' to a variable, that later, the javascript will use to handle the payment or the 2FA with 3D secure via '.handleCardPayment'. </p>\n\n<p>This is my registration_controller.rb's create_subscription action (I use devise): </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def create_subscription\n    Stripe.api_key = Rails.application.credentials[Rails.env.to_sym][:stripe][:stripe_api_key]\n\n    plan_id = params[:plan_id]\n    plan = Stripe::Plan.retrieve(plan_id)\n    token = params[:stripeToken]\n\n    customer = if @user.stripe_id?\n                 Stripe::Customer.retrieve(@user.stripe_id)\n               else\n                 Stripe::Customer.create(email: @user.email, source: token)\n               end\n    subscription = customer.subscriptions.create(\n      items: [\n        {\n          plan: plan_id\n        }\n\n      ],\n      expand: ['latest_invoice.payment_intent']\n    )\n    gon.intent = subscription.latest_invoice.payment_intent\n\n\n    options = {\n      stripe_id: customer.id,\n      stripe_subscription_id: subscription.id,\n      subscribed: true,\n      plan: plan_id\n    }\n\n    options.merge!(\n      card_last4: params[:user][:card_last4],\n      card_exp_month: params[:user][:card_exp_month],\n      card_exp_year: params[:user][:card_exp_year],\n      card_type: params[:user][:card_type]\n    ) if params[:user][:card_last4]\n\n    @user.update(options)\n\n    flash[:success] = \"\u00a1Se ha creado la suscripci\u00f3n correctamente!\"\n  end\n</code></pre>\n\n<p>Then here is my subscriptions.js script:</p>\n\n<pre><code>$(document).on(\"turbolinks:load\", function () {\n  const publishableKey = document.querySelector(\"meta[name='stripe-key']\").content;\n  const stripe = Stripe(publishableKey);\n\n  const elements = stripe.elements({\n    locale: 'es'\n  });\n\n  const style = {\n    base: {\n      color: \"#32325d\",\n      fontWeight: 500,\n      fontSize: \"16px\",\n      fontSmoothing: \"antialiased\",\n\n      \"::placeholder\": {\n        color: \"#CFD7DF\"\n      }\n    },\n    invalid: {\n      color: \"#E25950\"\n    }\n  };\n\n  // Create an instance of the card Element.\n  const card = elements.create('card', { style });\n\n  // Add an instance of the card Element into the `card-element` &lt;div&gt;.\n\n  card.mount('#card-element');\n\n\n\n  card.addEventListener('change', ({ error }) =&gt; {\n\n    const displayError = document.getElementById('card-errors');\n    if (error) {\n      displayError.textContent = error.message;\n    } else {\n      displayError.textContent = '';\n    }\n  });\n\n  // Create a token or display an error when the form is submitted.\n  const form = document.getElementById('new_user');\n\n  form.addEventListener('submit', async (event) =&gt; {\n    event.preventDefault();\n\n    const { token, error } = await stripe.createToken(card);\n\n    if (error) {\n      // Inform the customer that there was an error.\n    const errorElement = document.getElementById('card-errors');\n      errorElement.textContent = error.message;\n    } else {\n      // handle the payment (pass, pyment error or 2FA)\n      const clientSecret = gon.intent.client_secret;\n\n      const { paymentIntent, error } =\n        await stripe.handleCardPayment(\n          clientSecret, card, {\n          save_payment_method: true,\n          setup_future_usage: 'off_session'\n          }\n        );\n      if (error) {\n        const errorElement = document.getElementById('card-errors');\n        errorElement.textContent = error.message;\n      } else {\n      // Send the token to your server.\n      // stripeTokenHandler(token);\n        const stripeTokenHandler = (token) =&gt; {\n          // Insert the token ID into the form so it gets submitted to the server\n          const form = document.getElementById('new_user');\n          const hiddenInput = document.createElement('input');\n          hiddenInput.setAttribute('type', 'hidden');\n          hiddenInput.setAttribute('name', 'stripeToken');\n          hiddenInput.setAttribute('value', token.id);\n          form.appendChild(hiddenInput);\n\n          [\"type\", \"last4\", \"exp_month\", \"exp_year\"].forEach(function (field) {\n            addCardField(form, token, field);\n          });\n\n          // Submit the form\n          form.submit();\n        }\n      }\n    }\n  });\n\n  function addCardField(form, token, field) {\n    let hiddenInput = document.createElement('input');\n    hiddenInput.setAttribute('type', 'hidden');\n    hiddenInput.setAttribute('name', \"user[card_\" + field + \"]\");\n    hiddenInput.setAttribute('value', token.card[field]);\n    form.appendChild(hiddenInput);\n  }\n});\n</code></pre>\n\n<p>With this configuration, when I try to get the 3D secure's modal with a stripe testing card number, I get an error:</p>\n\n<blockquote>\n  <p>subscriptions.js:61 Uncaught (in promise) TypeError: Cannot read > property 'client_secret' of undefined at HTMLFormElement. (subscriptions.js:61)</p>\n</blockquote>\n\n<p>I've tryed to pass the variable in Stripe Doc's way (data-secret in the button tag) but I get the same error (or similar). </p>\n\n<p>Seem's clear that the variable is not there, but, <strong>how could I pass it right? What am I missing?</strong></p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "bundle", "bundler"], "answers": [{"comments": [{"owner": {"reputation": 5017, "user_id": 2047418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1d49bccfa9d2c633db6f854e67b88362?s=128&d=identicon&r=PG", "display_name": "Filip Bartuzi", "link": "https://stackoverflow.com/users/2047418/filip-bartuzi"}, "edited": false, "score": 0, "creation_date": 1568624668, "post_id": 57952631, "comment_id": 102319200, "body": "This does not work. <code>gem install fuubar</code> succeeds, but when you run <code>bundle show fuubar</code> it returns <code>Could not find gem &#39;fuubar&#39;</code>"}, {"owner": {"reputation": 5017, "user_id": 2047418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1d49bccfa9d2c633db6f854e67b88362?s=128&d=identicon&r=PG", "display_name": "Filip Bartuzi", "link": "https://stackoverflow.com/users/2047418/filip-bartuzi"}, "edited": false, "score": 0, "creation_date": 1568624735, "post_id": 57952631, "comment_id": 102319238, "body": "also: <code>bundle exec gem install fuubar</code> does not solve the issue"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 5017, "user_id": 2047418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1d49bccfa9d2c633db6f854e67b88362?s=128&d=identicon&r=PG", "display_name": "Filip Bartuzi", "link": "https://stackoverflow.com/users/2047418/filip-bartuzi"}, "edited": false, "score": 0, "creation_date": 1568625438, "post_id": 57952631, "comment_id": 102319600, "body": "It&#39;s not added to the bundle (Gemfile.lock), but it&#39;s present in your installed gems"}, {"owner": {"reputation": 5017, "user_id": 2047418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1d49bccfa9d2c633db6f854e67b88362?s=128&d=identicon&r=PG", "display_name": "Filip Bartuzi", "link": "https://stackoverflow.com/users/2047418/filip-bartuzi"}, "edited": false, "score": 0, "creation_date": 1568635050, "post_id": 57952631, "comment_id": 102324566, "body": "it still causes <code>require&#39;: cannot load such file -- fuubar (LoadError)</code> Did you try it yourself?"}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 0, "last_activity_date": 1568620871, "creation_date": 1568620871, "answer_id": 57952631, "question_id": 57952276, "link": "https://stackoverflow.com/questions/57952276/add-a-gem-to-the-bundle-without-adding-it-the-gemfile-rspec-fuubar/57952631#57952631", "title": "Add a gem to the bundle without adding it the Gemfile (rspec + fuubar)", "body": "<p>I'd install it using <code>gem</code> command:</p>\n\n<pre><code>gem install fuubar\n</code></pre>\n\n<p>Note that if you use different versions of ruby or different gemsets per project, you'll need to install that multiple times (once per version/gemset).</p>\n"}, {"comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1568796427, "post_id": 57988577, "comment_id": 102384899, "body": "Having <code>Gemfile.local</code> automatically loaded would make a nice feature for bundler."}, {"owner": {"reputation": 101, "user_id": 9738381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "AndyB", "link": "https://stackoverflow.com/users/9738381/andyb"}, "edited": false, "score": 0, "creation_date": 1571279756, "post_id": 57988577, "comment_id": 103190219, "body": "I like this solution in principle, but it produces gem incompatibility issues when I run <code>BUNDLE_GEMFILE=Gemfile.local bundle install</code>, even though <code>bundle install</code> works fine. Haven&#39;t worked out why yet."}, {"owner": {"reputation": 101, "user_id": 9738381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "AndyB", "link": "https://stackoverflow.com/users/9738381/andyb"}, "edited": false, "score": 0, "creation_date": 1571281225, "post_id": 57988577, "comment_id": 103190474, "body": "Incompatibility issues above resolved by copying <code>Gemfile.lock</code> to <code>Gemfile.local.lock</code> before running <code>BUNDLE_GEMFILE=Gemfile.local bundle install</code>. Suggests our Gemfile needs an overhaul ..."}, {"owner": {"reputation": 143, "user_id": 2046161, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/fuOmC.jpg?s=128&g=1", "display_name": "SZMER", "link": "https://stackoverflow.com/users/2046161/szmer"}, "reply_to_user": {"reputation": 101, "user_id": 9738381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "AndyB", "link": "https://stackoverflow.com/users/9738381/andyb"}, "edited": false, "score": 0, "creation_date": 1571317600, "post_id": 57988577, "comment_id": 103207236, "body": "@AndyB Even copying of lock before <code>bundle install</code> may update your project dependencies (if the additional development gem requires different versions). Proper locking in your <code>Gemfile</code> should be enough."}], "tags": [], "owner": {"reputation": 143, "user_id": 2046161, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/fuOmC.jpg?s=128&g=1", "display_name": "SZMER", "link": "https://stackoverflow.com/users/2046161/szmer"}, "is_accepted": false, "score": 2, "last_activity_date": 1568796179, "creation_date": 1568796179, "answer_id": 57988577, "question_id": 57952276, "link": "https://stackoverflow.com/questions/57952276/add-a-gem-to-the-bundle-without-adding-it-the-gemfile-rspec-fuubar/57988577#57988577", "title": "Add a gem to the bundle without adding it the Gemfile (rspec + fuubar)", "body": "<p>Using <a href=\"https://bundler.io/v1.16/bundle_config.html\" rel=\"nofollow noreferrer\">bundler config</a> you can add your custom <code>Gemfile.local</code> which will inherit all dependencies from the project <code>Gemfile</code>.\nBody of <code>Gemfile</code> should be similar to bellow one:</p>\n\n<pre><code># Gemfile.local\neval_gemfile \"./Gemfile\"\n\ngroup :development, :test do\n  gem 'fuubar'\nend\n</code></pre>\n\n<p>Then before your <code>bundle</code> command, you should pass environment variable <code>BUNDLE_GEMFILE=Gemfile.local</code>. Which would result with the following command:</p>\n\n<pre><code>BUNDLE_GEMFILE=Gemfile.local bundle exec rspec --format Fuubar spec\n</code></pre>\n\n<p><em>don't forget to run <code>BUNDLE_GEMFILE=Gemfile.local bundle install</code> before</em></p>\n"}], "owner": {"reputation": 5017, "user_id": 2047418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1d49bccfa9d2c633db6f854e67b88362?s=128&d=identicon&r=PG", "display_name": "Filip Bartuzi", "link": "https://stackoverflow.com/users/2047418/filip-bartuzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1568796179, "creation_date": 1568619389, "last_edit_date": 1568620903, "question_id": 57952276, "link": "https://stackoverflow.com/questions/57952276/add-a-gem-to-the-bundle-without-adding-it-the-gemfile-rspec-fuubar", "title": "Add a gem to the bundle without adding it the Gemfile (rspec + fuubar)", "body": "<p>I use \"fuubar\" as a formatter of my choice to the RSpec. In my <code>~/.rspec</code> I got <code>--format Fuubar</code> line, which means in any RSpec run, in any project (regardless of Gemfile content) <code>--format Fuubar</code> is used. </p>\n\n<p>I don't want to add this as a dependency to the project, as it is a very personal thing and in some projects, you as a team decided to keep your Gemfile slim without unnecessary gems.</p>\n\n<p>How to run RSpec with <code>--format Fuubar</code> without adding Fuubar gem to your Gemfile? </p>\n\n<p>The error I get after running <code>rspec</code> without fuubar installed:</p>\n\n<pre><code>/Users/filip.bartuzi/.asdf/installs/ruby/2.6.2/lib/ruby/gems/2.6.0/gems/activesupport-5.1.6.2/lib/active_support/dependencies.rb:292:in `require': cannot load such file -- fuubar (LoadError)\n</code></pre>\n"}, {"tags": ["ruby", "azure", "ubuntu-18.04"], "comments": [{"owner": {"reputation": 23089, "user_id": 9773937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gUlzf.jpg?s=128&g=1", "display_name": "Charles Xu", "link": "https://stackoverflow.com/users/9773937/charles-xu"}, "edited": false, "score": 0, "creation_date": 1568622765, "post_id": 57952260, "comment_id": 102318244, "body": "Do you check if the ruby software is in the running state and still listen to the port 4567?"}, {"owner": {"reputation": 565, "user_id": 3825106, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/fd3bf76f5859d9e3fb029a64e624c233?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Developer", "link": "https://stackoverflow.com/users/3825106/curious-developer"}, "reply_to_user": {"reputation": 23089, "user_id": 9773937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gUlzf.jpg?s=128&g=1", "display_name": "Charles Xu", "link": "https://stackoverflow.com/users/9773937/charles-xu"}, "edited": false, "score": 0, "creation_date": 1568622866, "post_id": 57952260, "comment_id": 102318298, "body": "yes, I didn&#39;t make any changes in its port. The same software is working on my localhost and I am able to view the website there. But it&#39;s not working on the azure server. I have this port enabled but still no luck. I am not really sure how to fix it."}, {"owner": {"reputation": 23089, "user_id": 9773937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gUlzf.jpg?s=128&g=1", "display_name": "Charles Xu", "link": "https://stackoverflow.com/users/9773937/charles-xu"}, "edited": false, "score": 0, "creation_date": 1568623424, "post_id": 57952260, "comment_id": 102318581, "body": "There is no difference between the azure server and the localhost if the system is the same. You just need to check if the firewall blocks the port and if the software works well. There may be two NSGs associated with the subnet and the nic. So you need to add rules to both of them to expose the port."}, {"owner": {"reputation": 565, "user_id": 3825106, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/fd3bf76f5859d9e3fb029a64e624c233?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Developer", "link": "https://stackoverflow.com/users/3825106/curious-developer"}, "reply_to_user": {"reputation": 23089, "user_id": 9773937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gUlzf.jpg?s=128&g=1", "display_name": "Charles Xu", "link": "https://stackoverflow.com/users/9773937/charles-xu"}, "edited": false, "score": 0, "creation_date": 1568624055, "post_id": 57952260, "comment_id": 102318901, "body": "I didn&#39;t get you @CharlesXu. How do I check firewall blocks, NSGs etc? I just check <code>nohut.out</code> file it says &quot;== Someone is already performing on port 4567!&quot;. Is there any way I can restart ruby and try again? I don&#39;t think azure would want to add any restriction in the panel and besides, I have already activated the above mentioned ports. Is there anything else that I am missing?"}, {"owner": {"reputation": 23089, "user_id": 9773937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gUlzf.jpg?s=128&g=1", "display_name": "Charles Xu", "link": "https://stackoverflow.com/users/9773937/charles-xu"}, "edited": false, "score": 0, "creation_date": 1568624714, "post_id": 57952260, "comment_id": 102319225, "body": "I don&#39;t work on ruby. So there is no idea for it. But the error means the port 4567 is already in use by another program. So maybe you can use another port for your software. For NSG, you need to provide more message. A screenshot about the VM -&gt; networking is more helpful."}, {"owner": {"reputation": 565, "user_id": 3825106, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/fd3bf76f5859d9e3fb029a64e624c233?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Developer", "link": "https://stackoverflow.com/users/3825106/curious-developer"}, "reply_to_user": {"reputation": 23089, "user_id": 9773937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gUlzf.jpg?s=128&g=1", "display_name": "Charles Xu", "link": "https://stackoverflow.com/users/9773937/charles-xu"}, "edited": false, "score": 0, "creation_date": 1568625227, "post_id": 57952260, "comment_id": 102319475, "body": "ok. I have uploaded the list of inbound links. Is that what you want to see?"}, {"owner": {"reputation": 23089, "user_id": 9773937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gUlzf.jpg?s=128&g=1", "display_name": "Charles Xu", "link": "https://stackoverflow.com/users/9773937/charles-xu"}, "edited": false, "score": 0, "creation_date": 1568625376, "post_id": 57952260, "comment_id": 102319567, "body": "No, not the rules, is the whole configuration. For example, if there is an NSG associated with the subnet. Additional, you need to check your software first as I said in the above comment."}, {"owner": {"reputation": 565, "user_id": 3825106, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/fd3bf76f5859d9e3fb029a64e624c233?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Developer", "link": "https://stackoverflow.com/users/3825106/curious-developer"}, "reply_to_user": {"reputation": 23089, "user_id": 9773937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gUlzf.jpg?s=128&g=1", "display_name": "Charles Xu", "link": "https://stackoverflow.com/users/9773937/charles-xu"}, "edited": false, "score": 0, "creation_date": 1568625529, "post_id": 57952260, "comment_id": 102319654, "body": "I have not installed subnet. let me check the rest"}, {"owner": {"reputation": 23089, "user_id": 9773937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gUlzf.jpg?s=128&g=1", "display_name": "Charles Xu", "link": "https://stackoverflow.com/users/9773937/charles-xu"}, "edited": false, "score": 0, "creation_date": 1568625731, "post_id": 57952260, "comment_id": 102319756, "body": "The subnet is something of the vnet that the VM in, so if the VM exists, the subnet exists."}, {"owner": {"reputation": 565, "user_id": 3825106, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/fd3bf76f5859d9e3fb029a64e624c233?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Developer", "link": "https://stackoverflow.com/users/3825106/curious-developer"}, "reply_to_user": {"reputation": 23089, "user_id": 9773937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gUlzf.jpg?s=128&g=1", "display_name": "Charles Xu", "link": "https://stackoverflow.com/users/9773937/charles-xu"}, "edited": false, "score": 0, "creation_date": 1568631713, "post_id": 57952260, "comment_id": 102322866, "body": "Okay. Here is the NSG page. I couldn&#39;t locate the other terms. But I tried to run the application on other ports, and on each port, the application is throwing the same error. Also, I found that application maybe trying to run on <code>http:&#47;&#47;localhost:&lt;port&gt;</code>. I tried to change the command to run the application on the server but on my localhost it is running and not on the azure server."}], "answers": [{"tags": [], "owner": {"reputation": 565, "user_id": 3825106, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/fd3bf76f5859d9e3fb029a64e624c233?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Developer", "link": "https://stackoverflow.com/users/3825106/curious-developer"}, "is_accepted": true, "score": 0, "last_activity_date": 1568636220, "creation_date": 1568636220, "answer_id": 57956757, "question_id": 57952260, "link": "https://stackoverflow.com/questions/57952260/cant-get-azure-ubuntu-vm-to-show-the-installed-website/57956757#57956757", "title": "Can&#39;t get azure Ubuntu VM to show the installed website", "body": "<p>I have fixed this issue while looking at the internet for random issues links. I am posting this here, maybe it helps someone else. I found this <a href=\"https://stackoverflow.com/a/20879984/3825106\">Solution</a> and it worked for me. My website was actually running for localhost whereas it should run on from the browser on Azure server so by doing this <code>set :bind, '0.0.0.0'</code> is required to make the interface available outside the localhost layer. </p>\n"}], "owner": {"reputation": 565, "user_id": 3825106, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/fd3bf76f5859d9e3fb029a64e624c233?s=128&d=identicon&r=PG&f=1", "display_name": "Curious Developer", "link": "https://stackoverflow.com/users/3825106/curious-developer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 57956757, "answer_count": 1, "score": 0, "last_activity_date": 1568636220, "creation_date": 1568619299, "last_edit_date": 1568635953, "question_id": 57952260, "link": "https://stackoverflow.com/questions/57952260/cant-get-azure-ubuntu-vm-to-show-the-installed-website", "title": "Can&#39;t get azure Ubuntu VM to show the installed website", "body": "<p>I am new to Microsoft Azure. I am trying to set up a ruby software. Once installed it opens a website page for login. I am using Linux VM with Ubuntu 18.04 LTS. I have completed the installation procedure and its ready to be seen on the browser. But when I hit the browser, it says \"This site can\u2019t be reached\". I don't get it why I am not able to access the website. My software loads the website on port \"4567\".</p>\n\n<p>I have already add \"Inbound Ports\" and added ports 80,443, 4567. But still no luck.</p>\n\n<p>Please help.</p>\n"}, {"tags": ["ruby", "erb"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1568616640, "post_id": 57951603, "comment_id": 102315566, "body": "May I ask what would be wrong with <code>YAML#dump</code>? Also are you sure you review your output as text, not as HTML via browser?"}, {"owner": {"reputation": 6272, "user_id": 127508, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/ptOi1.jpg?s=128&g=1", "display_name": "Istvan", "link": "https://stackoverflow.com/users/127508/istvan"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1568618646, "post_id": 57951603, "comment_id": 102316446, "body": "Not sure what you mean by YAML#dump. I am using vi to view the yaml."}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1568619839, "post_id": 57951603, "comment_id": 102316964, "body": "I believe he meant something like <code>&lt;%= YAML.dump(&quot;tags&quot; =&gt; @arr).lines[1..-1].join(&quot;\\n&quot;) %&gt;</code>.  I see no reason why your example would skip linefeeds on the tag line."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1568619920, "post_id": 57951603, "comment_id": 102316999, "body": "I mean ruby has yaml dumping in standard library, why would you reinvent a wheel?"}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1568620098, "post_id": 57951603, "comment_id": 102317062, "body": "Easier to than reindenting + removing the YAML header. There are scenarios where you need to build YAMLs from templates, for example in some apps users can create something like config.erb where they can interpolate ENV&#39;s into the output."}], "answers": [{"tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": true, "score": 2, "last_activity_date": 1568620258, "creation_date": 1568620258, "answer_id": 57952478, "question_id": 57951603, "link": "https://stackoverflow.com/questions/57951603/how-to-render-an-array-to-a-yaml-list-with-erb/57952478#57952478", "title": "How to render an Array to a YAML list with ERB?", "body": "<p>The only problem I see in your example is the missing leading <code>-</code> from the closing <code>&lt;% end -%&gt;</code> (should be <code>&lt;%- end -%&gt;</code>).</p>\n\n<pre><code># foo.erb:\n&lt;%- @arr = [1,2,3] -%&gt;\ntags:\n  &lt;%- @arr.each do |tag| -%&gt;\n  - &lt;%= tag %&gt;\n  &lt;%- end -%&gt;\n  - extra tag\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ erb -T - foo.erb\ntags:\n - 1\n - 2\n - 3\n - extra tag\n</code></pre>\n\n<p>Without the leading <code>-</code> the result I get is different from yours:</p>\n\n<pre><code>tags:\n  - 1\n    - 2\n    - 3\n    - extra tag\n</code></pre>\n"}], "owner": {"reputation": 6272, "user_id": 127508, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/ptOi1.jpg?s=128&g=1", "display_name": "Istvan", "link": "https://stackoverflow.com/users/127508/istvan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 740, "favorite_count": 0, "accepted_answer_id": 57952478, "answer_count": 1, "score": 0, "last_activity_date": 1568620258, "creation_date": 1568616272, "question_id": 57951603, "link": "https://stackoverflow.com/questions/57951603/how-to-render-an-array-to-a-yaml-list-with-erb", "title": "How to render an Array to a YAML list with ERB?", "body": "<p>I am trying to render an Array with ERB to a YAML file.</p>\n\n<p>Input:</p>\n\n<pre><code>arr = [1,2,3]\n</code></pre>\n\n<p>Expected output:</p>\n\n<pre><code>  ---\n  tags:\n    - 1\n    - 2\n    - 3\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>tags:\n  &lt;%- @arr.each do |tag| -%&gt;\n  - &lt;%= tag %&gt;\n  &lt;% end -%&gt;\n  - extra-tag\n</code></pre>\n\n<p>This renders the following YAML</p>\n\n<pre><code>---\ntags:\n  - 1 - 2 -3\n</code></pre>\n\n<p>Is there a way to render this properly?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "shopify", "shopify-app"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1568638155, "post_id": 57951067, "comment_id": 102326227, "body": "Is this actually everything you have in <code>routes.rb</code> file?"}, {"owner": {"reputation": 1, "user_id": 12072432, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RoPJ5XKHaAw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rft6z4Kt1r7LID9dMeCN1n8J3s9uA/photo.jpg?sz=128", "display_name": "Gaurav Agarwal", "link": "https://stackoverflow.com/users/12072432/gaurav-agarwal"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1568803700, "post_id": 57951067, "comment_id": 102389072, "body": "@MarekLipka thanks for the response, and Yes, currently I have only this in my file, and currently I have only one-page index.html.erb in views/home folder. It&#39;s working for the last 10 days but now I got stuck here. I didn&#39;t change anything in my files before the occurrence of this error."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12072432, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RoPJ5XKHaAw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rft6z4Kt1r7LID9dMeCN1n8J3s9uA/photo.jpg?sz=128", "display_name": "Gaurav Agarwal", "link": "https://stackoverflow.com/users/12072432/gaurav-agarwal"}, "edited": false, "score": 0, "creation_date": 1568803784, "post_id": 57957202, "comment_id": 102389126, "body": "Thanks for the response, but I already tried that and getting the same error."}], "tags": [], "owner": {"reputation": 99, "user_id": 5968692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab32a7385b4f8f4d52a39c035fb469ad?s=128&d=identicon&r=PG&f=1", "display_name": "Vadym", "link": "https://stackoverflow.com/users/5968692/vadym"}, "is_accepted": false, "score": 1, "last_activity_date": 1568637964, "creation_date": 1568637964, "answer_id": 57957202, "question_id": 57951067, "link": "https://stackoverflow.com/questions/57951067/how-to-solve-the-get-login-routing-error-while-building-shopify-app-using-r/57957202#57957202", "title": "How to solve the [GET] &quot;/login&quot; routing error while building shopify app using ruby on rails?", "body": "<p>There is no any route for <code>/login</code> in your <code>config/routes.rb</code> code. I guess you should define one.</p>\n"}], "owner": {"reputation": 1, "user_id": 12072432, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RoPJ5XKHaAw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rft6z4Kt1r7LID9dMeCN1n8J3s9uA/photo.jpg?sz=128", "display_name": "Gaurav Agarwal", "link": "https://stackoverflow.com/users/12072432/gaurav-agarwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1568637964, "creation_date": 1568613371, "last_edit_date": 1568620641, "question_id": 57951067, "link": "https://stackoverflow.com/questions/57951067/how-to-solve-the-get-login-routing-error-while-building-shopify-app-using-r", "title": "How to solve the [GET] &quot;/login&quot; routing error while building shopify app using ruby on rails?", "body": "<p>I am getting a Routing error says \" no routes matches [GET] \"/login\" \" and also in ruby libraries. <a href=\"https://i.stack.imgur.com/Bmd2D.jpg\" rel=\"nofollow noreferrer\">During running on a server it displays page not found</a> and the logs for that error is <a href=\"https://i.stack.imgur.com/3DXde.jpg\" rel=\"nofollow noreferrer\">Logs show [GET] route error and library error</a>.</p>\n\n<p>I have my index file at following path </p>\n\n<blockquote>\n  <p>views/home/index.html.erb</p>\n</blockquote>\n\n<p>My code in config/routes.rb is:</p>\n\n<pre><code>Rails.application.routes.draw do\nroot 'home#index' \nget 'show' =&gt; 'welcomes#show'\nresources :home\n</code></pre>\n\n<p>I am working on this app for the last 10 days with the same route and ruby version without an error but now this error came from nowhere.</p>\n\n<p>I am using heroku as my intermediate server.</p>\n\n<pre><code>\n`2019-09-13T13:34:32.403531+00:00 app[web.1]: [1b3ee105-47d4-442e-8217-148e22394df0] vendor/bundle/ruby/2.5.0/gems/rack-2.0.7/lib/rack/runtime.rb:22:in `call'\n2019-09-13T13:34:32.403536+00:00 app[web.1]: [1b3ee105-47d4-442e-8217-148e22394df0] vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.7/lib/active_support/cache/strategy/local_cache_middleware.rb:27:in `call'\n2019-09-13T13:34:32.403538+00:00 app[web.1]: [1b3ee105-47d4-442e-8217-148e22394df0] vendor/bundle/ruby/2.5.0/gems/actionpack-5.1.7/lib/action_dispatch/middleware/executor.rb:12:in `call'\n2019-09-13T13:34:32.403540+00:00 app[web.1]: [1b3ee105-47d4-442e-8217-148e22394df0] vendor/bundle/ruby/2.5.0/gems/actionpack-5.1.7/lib/action_dispatch/middleware/static.rb:125:in `call'\n2019-09-13T13:34:32.403542+00:00 app[web.1]: [1b3ee105-47d4-442e-8217-148e22394df0] vendor/bundle/ruby/2.5.0/gems/rack-2.0.7/lib/rack/sendfile.rb:111:in `call'\n2019-09-13T13:34:32.403544+00:00 app[web.1]: [1b3ee105-47d4-442e-8217-148e22394df0] vendor/bundle/ruby/2.5.0/gems/railties-5.1.7/lib/rails/engine.rb:522:in `call'\n2019-09-13T13:34:32.403547+00:00 app[web.1]: [1b3ee105-47d4-442e-8217-148e22394df0] vendor/bundle/ruby/2.5.0/gems/puma-3.12.1/lib/puma/configuration.rb:227:in `call'\n2019-09-13T13:34:32.403549+00:00 app[web.1]: [1b3ee105-47d4-442e-8217-148e22394df0] vendor/bundle/ruby/2.5.0/gems/puma-3.12.1/lib/puma/server.rb:660:in `handle_request'\n2019-09-13T13:34:32.403551+00:00 app[web.1]: [1b3ee105-47d4-442e-8217-148e22394df0] vendor/bundle/ruby/2.5.0/gems/puma-3.12.1/lib/puma/server.rb:474:in `process_client'\n2019-09-13T13:34:32.403552+00:00 app[web.1]: [1b3ee105-47d4-442e-8217-148e22394df0] vendor/bundle/ruby/2.5.0/gems/puma-3.12.1/lib/puma/server.rb:334:in `block in run'\n2019-09-13T13:34:32.403555+00:00 app[web.1]: [1b3ee105-47d4-442e-8217-148e22394df0] vendor/bundle/ruby/2.5.0/gems/puma-3.12.1/lib/puma/thread_pool.rb:135:in `block in spawn_thread'\n`\n\nErrors while loading the app:\n\n    2019-09-16T04:29:47.627757+00:00 app[web.1]: I, [2019-09-16T04:29:47.624535 #4]  INFO -- : [9729e2c4-5417-4966-8332-2e9010d33d14] Started GET \"/login?shop=dynamictask.myshopify.com\" for 103.74.223.20 at 2019-09-16 04:29:47 +0000\n2019-09-16T04:29:47.627784+00:00 app[web.1]: F, [2019-09-16T04:29:47.626650 #4] FATAL -- : [9729e2c4-5417-4966-8332-2e9010d33d14]\n2019-09-16T04:29:47.627786+00:00 app[web.1]: F, [2019-09-16T04:29:47.626708 #4] FATAL -- : [9729e2c4-5417-4966-8332-2e9010d33d14] ActionController::RoutingError (No route matches [GET] \"/login\"):\n2019-09-16T04:29:47.627788+00:00 app[web.1]: F, [2019-09-16T04:29:47.626741 #4] FATAL -- : [9729e2c4-5417-4966-8332-2e9010d33d14]\n2019-09-16T04:29:47.627790+00:00 app[web.1]: F, [2019-09-16T04:29:47.626786 #4] FATAL -- : [9729e2c4-5417-4966-8332-2e9010d33d14] vendor/bundle/ruby/2.5.0/gems/actionpack-5.1.7/lib/action_dispatch/middleware/debug_exceptions.rb:63:in `call'\n2019-09-16T04:29:47.627792+00:00 app[web.1]: [9729e2c4-5417-4966-8332-2e9010d33d14] vendor/bundle/ruby/2.5.0/gems/actionpack-5.1.7/lib/action_dispatch/middleware/show_exceptions.rb:31:in `call'\n2019-09-16T04:29:47.627794+00:00 app[web.1]: [9729e2c4-5417-4966-8332-2e9010d33d14] vendor/bundle/ruby/2.5.0/gems/railties-5.1.7/lib/rails/rack/logger.rb:36:in `call_app'\n2019-09-16T04:29:47.627796+00:00 app[web.1]: [9729e2c4-5417-4966-8332-2e9010d33d14] vendor/bundle/ruby/2.5.0/gems/railties-5.1.7/lib/rails/rack/logger.rb:24:in `block in call'\n2019-09-16T04:29:47.627797+00:00 app[web.1]: [9729e2c4-5417-4966-8332-2e9010d33d14] vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.7/lib/active_support/tagged_logging.rb:69:in `block in tagged'\n2019-09-16T04:29:47.627799+00:00 app[web.1]: [9729e2c4-5417-4966-8332-2e9010d33d14] vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.7/lib/active_support/tagged_logging.rb:26:in `tagged'\n2019-09-16T04:29:47.627800+00:00 app[web.1]: [9729e2c4-5417-4966-8332-2e9010d33d14] vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.7/lib/active_support/tagged_logging.rb:69:in `tagged'\n2019-09-16T04:29:47.627802+00:00 app[web.1]: [9729e2c4-5417-4966-8332-2e9010d33d14] vendor/bundle/ruby/2.5.0/gems/railties-5.1.7/lib/rails/rack/logger.rb:24:in `call'\n2019-09-16T04:29:47.627803+00:00 app[web.1]: [9729e2c4-5417-4966-8332-2e9010d33d14] vendor/bundle/ruby/2.5.0/gems/actionpack-5.1.7/lib/action_dispatch/middleware/remote_ip.rb:79:in `call'\n2019-09-16T04:29:47.627805+00:00 app[web.1]: [9729e2c4-5417-4966-8332-2e9010d33d14] vendor/bundle/ruby/2.5.0/gems/actionpack-5.1.7/lib/action_dispatch/middleware/request_id.rb:25:in `call'\n2019-09-16T04:29:47.627806+00:00 app[web.1]: [9729e2c4-5417-4966-8332-2e9010d33d14] vendor/bundle/ruby/2.5.0/gems/rack-2.0.7/lib/rack/method_override.rb:22:in `call'\n2019-09-16T04:29:47.627807+00:00 app[web.1]: [9729e2c4-5417-4966-8332-2e9010d33d14] vendor/bundle/ruby/2.5.0/gems/rack-2.0.7/lib/rack/runtime.rb:22:in `call'\n2019-09-16T04:29:47.627812+00:00 app[web.1]: [9729e2c4-5417-4966-8332-2e9010d33d14] vendor/bundle/ruby/2.5.0/gems/activesupport-5.1.7/lib/active_support/cache/strategy/local_cache_middleware.rb:27:in `call'\n2019-09-16T04:29:47.627813+00:00 app[web.1]: [9729e2c4-5417-4966-8332-2e9010d33d14] vendor/bundle/ruby/2.5.0/gems/actionpack-5.1.7/lib/action_dispatch/middleware/executor.rb:12:in `call'\n2019-09-16T04:29:47.627815+00:00 app[web.1]: [9729e2c4-5417-4966-8332-2e9010d33d14] vendor/bundle/ruby/2.5.0/gems/actionpack-5.1.7/lib/action_dispatch/middleware/static.rb:125:in `call'\n2019-09-16T04:29:47.627816+00:00 app[web.1]: [9729e2c4-5417-4966-8332-2e9010d33d14] vendor/bundle/ruby/2.5.0/gems/rack-2.0.7/lib/rack/sendfile.rb:111:in `call'\n2019-09-16T04:29:47.627817+00:00 app[web.1]: [9729e2c4-5417-4966-8332-2e9010d33d14] vendor/bundle/ruby/2.5.0/gems/railties-5.1.7/lib/rails/engine.rb:522:in `call'\n2019-09-16T04:29:47.627819+00:00 app[web.1]: [9729e2c4-5417-4966-8332-2e9010d33d14] vendor/bundle/ruby/2.5.0/gems/puma-3.12.1/lib/puma/configuration.rb:227:in `call'\n2019-09-16T04:29:47.627820+00:00 app[web.1]: [9729e2c4-5417-4966-8332-2e9010d33d14] vendor/bundle/ruby/2.5.0/gems/puma-3.12.1/lib/puma/server.rb:660:in `handle_request'\n2019-09-16T04:29:47.627822+00:00 app[web.1]: [9729e2c4-5417-4966-8332-2e9010d33d14] vendor/bundle/ruby/2.5.0/gems/puma-3.12.1/lib/puma/server.rb:474:in `process_client'\n2019-09-16T04:29:47.627823+00:00 app[web.1]: [9729e2c4-5417-4966-8332-2e9010d33d14] vendor/bundle/ruby/2.5.0/gems/puma-3.12.1/lib/puma/server.rb:334:in `block in run'\n2019-09-16T04:29:47.627825+00:00 app[web.1]: [9729e2c4-5417-4966-8332-2e9010d33d14] vendor/bundle/ruby/2.5.0/gems/puma-3.12.1/lib/puma/thread_pool.rb:135:in `block in spawn_thread'\n2019-09-16T04:29:48.389553+00:00 heroku[router]: at=info method=GET path=\"/favicon.ico\" host=obscure-ridge-95470.herokuapp.com request_id=e4cb3df9-ced9-4ae5-9461-75041afebd6f fwd=\"103.74.223.20\" dyno=web.1 connect=1ms service=2ms status=200 bytes=143 protocol=https\n2019-09-16T05:05:28.144787+00:00 heroku[web.1]: Idling\n2019-09-16T05:05:28.159013+00:00 heroku[web.1]: State changed from up to down\n2019-09-16T05:05:29.376624+00:00 app[web.1]: - Gracefully stopping, waiting for requests to finish\n2019-09-16T05:05:29.384875+00:00 app[web.1]: === puma shutdown: 2019-09-16 05:05:29 +0000 ===\n2019-09-16T05:05:29.384915+00:00 app[web.1]: - Goodbye!\n2019-09-16T05:05:29.385066+00:00 app[web.1]: Exiting\n2019-09-16T05:05:29.348475+00:00 heroku[web.1]: Stopping all processes with SIGTERM\n2019-09-16T05:05:29.464600+00:00 heroku[web.1]: Process exited with status 143\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 1931, "user_id": 1639657, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/f6c37c33188931ef56c5c1ccfe638dd5?s=128&d=identicon&r=PG", "display_name": "sonnyhe2002", "link": "https://stackoverflow.com/users/1639657/sonnyhe2002"}, "edited": false, "score": 0, "creation_date": 1568610612, "post_id": 57950615, "comment_id": 102313679, "body": "Maybe contacting heroku customer support will be better. If not, what is the url you are entering?"}, {"owner": {"reputation": 1156, "user_id": 4955546, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3ypcYA0ACXs/AAAAAAAAAAI/AAAAAAAABgY/gcCpBwKBymI/photo.jpg?sz=128", "display_name": "Sikandar Tariq", "link": "https://stackoverflow.com/users/4955546/sikandar-tariq"}, "edited": false, "score": 0, "creation_date": 1568613017, "post_id": 57950615, "comment_id": 102314299, "body": "please use this command and add server logs in the question too <code>heroku logs --tail</code>"}, {"owner": {"reputation": 11, "user_id": 11954643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d4e34a3d11a3c332356ec69b0724829?s=128&d=identicon&r=PG&f=1", "display_name": "Anh Bui", "link": "https://stackoverflow.com/users/11954643/anh-bui"}, "reply_to_user": {"reputation": 1931, "user_id": 1639657, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/f6c37c33188931ef56c5c1ccfe638dd5?s=128&d=identicon&r=PG", "display_name": "sonnyhe2002", "link": "https://stackoverflow.com/users/1639657/sonnyhe2002"}, "edited": false, "score": 0, "creation_date": 1568613066, "post_id": 57950615, "comment_id": 102314309, "body": "@sonnyhe2002 : the url automatically be changed to <code>https:&#47;&#47;a186.herokuapp.com&#47;</code> a186 is the app I uploaded to web. Do you have any idea for me?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1568615245, "post_id": 57950615, "comment_id": 102315044, "body": "Does your application have a <code>root</code> in the <code>routes.rb</code>? Does that root page load locally?"}, {"owner": {"reputation": 11, "user_id": 11954643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d4e34a3d11a3c332356ec69b0724829?s=128&d=identicon&r=PG&f=1", "display_name": "Anh Bui", "link": "https://stackoverflow.com/users/11954643/anh-bui"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1568616580, "post_id": 57950615, "comment_id": 102315541, "body": "@spickermann here is my <code>routes.rb</code>                    <code>Rails.application.routes.draw do   # For details on the DSL available within this file, see https:&#47;&#47;guides.rubyonrails.org&#47;routing.html end</code>"}, {"owner": {"reputation": 11, "user_id": 11954643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d4e34a3d11a3c332356ec69b0724829?s=128&d=identicon&r=PG&f=1", "display_name": "Anh Bui", "link": "https://stackoverflow.com/users/11954643/anh-bui"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1568617809, "post_id": 57950615, "comment_id": 102316063, "body": "@spickermann here is my <code>routes.rb</code>   <code>Rails.application.routes.draw do   # For details on the DSL available within this file, see https:&#47;&#47;guides.rubyonrails.org&#47;routing.html end</code>  It does not have a <code>root</code>, so must I add a <code>root</code> in it by hand ? Could you please show me how can I add it by some samples ? Thank you in advance."}, {"owner": {"reputation": 358, "user_id": 8708097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/APLHT.jpg?s=128&g=1", "display_name": "Saif chaudhry", "link": "https://stackoverflow.com/users/8708097/saif-chaudhry"}, "edited": false, "score": 0, "creation_date": 1568618089, "post_id": 57950615, "comment_id": 102316201, "body": "you can do like root &#39;users#show&#39; . Where as, users is a controller name and show is a method"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1568618559, "post_id": 57950615, "comment_id": 102316409, "body": "@AnhBui You basically have not defined any route in your application. Therefore Rails don&#39;t know what page to show. I advise reading <a href=\"https://guides.rubyonrails.org/routing.html\" rel=\"nofollow noreferrer\">the Rails guide about Routing</a>. Did you define a controller and a model?"}, {"owner": {"reputation": 11, "user_id": 11954643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d4e34a3d11a3c332356ec69b0724829?s=128&d=identicon&r=PG&f=1", "display_name": "Anh Bui", "link": "https://stackoverflow.com/users/11954643/anh-bui"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1568624232, "post_id": 57950615, "comment_id": 102318982, "body": "@spickermann As you can see, I did not define a controller and a model in my <code>routes.rb</code> , you mean I must use <code>root to: &#39;pages#main&#39;</code> method ?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1568626384, "post_id": 57950615, "comment_id": 102320123, "body": "@AnhBui: You have an empty routes table and you are saying that you did not create any controller or model. Why do you expect that such a blank Ruby on Rails application is able to render any page?"}], "owner": {"reputation": 11, "user_id": 11954643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d4e34a3d11a3c332356ec69b0724829?s=128&d=identicon&r=PG&f=1", "display_name": "Anh Bui", "link": "https://stackoverflow.com/users/11954643/anh-bui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568609958, "creation_date": 1568609958, "question_id": 57950615, "link": "https://stackoverflow.com/questions/57950615/problem-when-open-heroku-but-the-webpage-just-has-the-bug-the-page-you-were-lo", "title": "Problem when open Heroku, but the webpage just has the bug &quot;The page you were looking for doesn&#39;t exist.&quot;", "body": "<p>I am trying to open a web page by using \"Heroku open\" command, and it just only gave me the error \"The page you were looking for doesn't exist.\"</p>\n\n<p>When I ran those command, I had no problem\n<code>\ngit init\ngit add.\ngit commit -am \"some comment\"\ngit push heroku master</code></p>\n\n<p>I also tried to solve this problem by those command\n<code>\nheroku run rake db:migrate\nheroku run rake db:schema:load</code>\nbut nothing changed.</p>\n\n<p>Could you please give me some ideas? Thank you very much.</p>\n"}, {"tags": ["ruby", "git", "ruby-on-rails-5", "gitlab"], "answers": [{"comments": [{"owner": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "edited": false, "score": 0, "creation_date": 1568622593, "post_id": 57952575, "comment_id": 102318163, "body": "Is this <code>gitlab.Gitlab(&#39;https:&#47;&#47;git.xxx.xxx.xxx&#39;, private_token=&#39;xxxxxxxxxx&#39;)</code> associated with this gem? I need to get log of all the commits of the user from all projects will this work for that ?"}, {"owner": {"reputation": 1765, "user_id": 6464013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/800b098105b883e97c66cc3227a58807?s=128&d=identicon&r=PG", "display_name": "amittn", "link": "https://stackoverflow.com/users/6464013/amittn"}, "reply_to_user": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "edited": false, "score": 0, "creation_date": 1568623501, "post_id": 57952575, "comment_id": 102318620, "body": "@amal I have updated my answer its using a ruby code to connect to gitlab using  private token. JSON.parse(Curl.get(&quot;#{gitlab_url}/api/v4/projects/#{project&zwnj;&#8203;[&#39;id&#39;]}/jobs?scope=s&zwnj;&#8203;uccess&amp;private_token&zwnj;&#8203;=#{gitlab_token}&amp;per&zwnj;&#8203;_page=30&quot;).body_str)"}, {"owner": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "edited": false, "score": 0, "creation_date": 1568623662, "post_id": 57952575, "comment_id": 102318709, "body": "Sorry to ask but can you give a simpler example ?"}, {"owner": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "edited": false, "score": 0, "creation_date": 1568625103, "post_id": 57952575, "comment_id": 102319404, "body": "With your help i have managed to get the user from gitlab but i don&#39;t know how to get the user&#39;s commit history. This code that you specified  <code>cmd = &#39;git log --author=&quot;user_name&quot;&#39;     system(cmd)</code> works for the system but i can&#39;t manipulate it to get the contents of the commit."}, {"owner": {"reputation": 1765, "user_id": 6464013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/800b098105b883e97c66cc3227a58807?s=128&d=identicon&r=PG", "display_name": "amittn", "link": "https://stackoverflow.com/users/6464013/amittn"}, "reply_to_user": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "edited": false, "score": 0, "creation_date": 1568629829, "post_id": 57952575, "comment_id": 102321897, "body": "@Amal I have updated the answer, hope the last 2 points are helpful to you"}, {"owner": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "edited": false, "score": 0, "creation_date": 1568634811, "post_id": 57952575, "comment_id": 102324441, "body": "I am getting a namerror for the Curl.get command how to fix this i installed the gem <code>curl and curb</code> but still shows the same. I am somewhere close but need to get this curl working."}, {"owner": {"reputation": 1765, "user_id": 6464013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/800b098105b883e97c66cc3227a58807?s=128&d=identicon&r=PG", "display_name": "amittn", "link": "https://stackoverflow.com/users/6464013/amittn"}, "reply_to_user": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "edited": false, "score": 0, "creation_date": 1568635436, "post_id": 57952575, "comment_id": 102324784, "body": "@Amal worth checking your ruby version, gem version if you are installing it correctly <a href=\"https://github.com/taf2/curb\" rel=\"nofollow noreferrer\">github.com/taf2/curb</a>"}, {"owner": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "edited": false, "score": 0, "creation_date": 1568635896, "post_id": 57952575, "comment_id": 102324999, "body": "@ammittn Got it working but the result is only returning the first record of a result"}, {"owner": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "edited": false, "score": 0, "creation_date": 1568636025, "post_id": 57952575, "comment_id": 102325073, "body": "@ammittn For eg if try to get the contents from this link <code>https:&#47;&#47;gitlab.com&#47;api&#47;v4&#47;users&#47;root&#47;events&#47;</code> I am only getting the first index record. This has only 1 record in 0 index but i mean i need to get all the records in that link"}, {"owner": {"reputation": 1765, "user_id": 6464013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/800b098105b883e97c66cc3227a58807?s=128&d=identicon&r=PG", "display_name": "amittn", "link": "https://stackoverflow.com/users/6464013/amittn"}, "reply_to_user": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "edited": false, "score": 0, "creation_date": 1568638452, "post_id": 57952575, "comment_id": 102326387, "body": "@amal you should be using this endpoint to get all the commits GET /projects/:id/repository/commits refer this page <a href=\"https://docs.gitlab.com/ee/api/commits.html\" rel=\"nofollow noreferrer\">docs.gitlab.com/ee/api/commits.html</a> . Once you get the json you will have to iterate over and get the specific commits for a user. Note that you will have to get the project Id from the UI"}, {"owner": {"reputation": 1765, "user_id": 6464013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/800b098105b883e97c66cc3227a58807?s=128&d=identicon&r=PG", "display_name": "amittn", "link": "https://stackoverflow.com/users/6464013/amittn"}, "reply_to_user": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "edited": false, "score": 0, "creation_date": 1568639441, "post_id": 57952575, "comment_id": 102327015, "body": "@amal if all the above has been helpful, can you please accept the answer"}, {"owner": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "edited": false, "score": 0, "creation_date": 1568694727, "post_id": 57952575, "comment_id": 102345088, "body": "Thanks for the help ! I am somewhat close to achieve my goal thanks to you."}], "tags": [], "owner": {"reputation": 1765, "user_id": 6464013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/800b098105b883e97c66cc3227a58807?s=128&d=identicon&r=PG", "display_name": "amittn", "link": "https://stackoverflow.com/users/6464013/amittn"}, "is_accepted": true, "score": 0, "last_activity_date": 1568640069, "last_edit_date": 1568640069, "creation_date": 1568620654, "answer_id": 57952575, "question_id": 57950598, "link": "https://stackoverflow.com/questions/57950598/how-to-get-commit-history-of-users-in-gitlab-in-rails/57952575#57952575", "title": "How to get commit history of users in gitlab in rails", "body": "<ol>\n<li><p>Use this gitlab API <code>GET /projects/:id/repository/commits</code> to fetch all the commits on a repository <a href=\"https://docs.gitlab.com/ee/api/commits.html\" rel=\"nofollow noreferrer\">gitlab api</a>. Check the attached code for more details.</p></li>\n<li><p>Basically this <code>git log --author=\"user_name\"</code> command can give you git commit history for a specific user, you can even use email address just the first name or last name in the above command.</p></li>\n<li><p>Once you have authenticated with gitlab you can run the following command from ruby.</p></li>\n</ol>\n\n<pre><code>    cmd = 'git log --author=\"user_name\"'\n    system(cmd)\n</code></pre>\n\n<ul>\n<li>Sample code form ruby to connect to gitlab using private token which is not ideal but just an example</li>\n</ul>\n\n<pre><code>require 'json'\nrequire 'curb'\nrequire 'net/http'\n\nbegin\n\n def parseCoverageReport(report_text) \n   coverage_perc = report_text.match /All files\\s+\\|\\s+(\\d+\\.?\\d+).*\\n/\n   if not coverage_perc then\n     coverage_perc = report_text.match /^TOTAL\\s+\\d+\\s+\\d+\\s+(\\d+)%$/\n   end\n\n   if coverage_perc then \n     #if we found coverage value in job trace\n     #puts \"coverage_perc[1]: #{coverage_perc[1]}\"\n     coverage_perc[1].to_i\n   end\n end\n\n gen_config = YAML.load_file(\"config/general.yml\")\n gitlab_config = YAML.load_file(\"config/gitlab.yml\")\n\n SCHEDULER.every gen_config[:job_trigger_interval], :first_in =&gt; 0 do |job|\n\n table = {\n     title: \"Projects\",\n     hrows: Array.new.push({cols: [\n       {value: \"Project name\"}, \n       {value: \"Open Merge Requests\"},\n       {value: \"Code coverage\"}\n     ]}),\n     rows: Array.new\n }\n\n instances = gitlab_config['instances']\n\n instances.each do |instance|\n\n   gitlab_url = gitlab_config['instances'][instance.first]['url']\n   # gitlab_token = gitlab_config['instances'][instance.first]['api_key']\n   gitlab_token = ENV[gitlab_config['instances'][instance.first]['api_key']]\n   red_threshold = gitlab_config['instances'][instance.first]['red_threshold']\n   orange_threshold = gitlab_config['instances'][instance.first]['orange_threshold']\n   cov_red_threshold = gitlab_config['instances'][instance.first]['cov_red_threshold']\n   cov_orange_threshold = gitlab_config['instances'][instance.first]['cov_orange_threshold']\n   projects = gitlab_config['instances'][instance.first]['projects']\n\n   projects.each do |name, project|\n\n       merge_reqs = JSON.parse(Curl.get(\"#{gitlab_url}/api/v4/projects/#{project['id']}/merge_requests?state=opened&amp;private_token=#{gitlab_token}&amp;per_page=200\").body_str)\n       git_project =  JSON.parse(Curl.get(\"#{gitlab_url}/api/v4/projects/#{project['id']}?private_token=#{gitlab_token}\").body_str)\n       opened_mrs = merge_reqs.select { |merge_reqs| %w[opened].include? merge_reqs['state'] }\n       repo_name  = git_project['name']\n       repo_url  = git_project['web_url']\n\n\n       status = case\n       when opened_mrs.size &gt;= red_threshold then 'danger'\n       when opened_mrs.size &gt;= orange_threshold then 'warning'\n       else\n         'ok'\n       end\n\n       mrs_count = \"#{opened_mrs.size}\"\n       send_event(\"#{name}_mr\", { current: mrs_count, status: status })\n\n       color = case\n       when opened_mrs.size &gt;= red_threshold then 'red'\n       when opened_mrs.size &gt;= orange_threshold then 'orange'\n       else\n         'green'\n       end\n\n       font_color = color == 'orange' ? 'black' : 'white'\n\n       cov_color = color\n       font_cov_color = 'white'\n\n       code_coverage = \"---\"\n       code_coverage_tag = \"---\"\n       cov_job_url = ''\n\n       jobs = JSON.parse(Curl.get(\"#{gitlab_url}/api/v4/projects/#{project['id']}/jobs?scope=success&amp;private_token=#{gitlab_token}&amp;per_page=30\").body_str)\n       code_cov_job = jobs.find { |gitlab_job| !gitlab_job['coverage'].nil? }\n\n       if not code_cov_job then\n         #if no job has 'coverage' feature set up in Gitlab try to parse \n         #'coverage' from jobs trace manually\n         jobs.each do |job|\n               trace_report = Curl.get(\"#{gitlab_url}/api/v4/projects/#{project['id']}/jobs/#{job['id']}/trace?private_token=#{gitlab_token}\").body_str\n               code_cov_percentage = parseCoverageReport(trace_report)\n               if code_cov_percentage then\n                 code_cov_job = job\n                 code_cov_job['coverage'] = code_cov_percentage\n                 break \n               end\n         end\n       end\n\n       if code_cov_job then\n         #found code coverage data =&gt; process them\n         code_coverage = code_cov_job['coverage'].to_i\n         cov_job_url = code_cov_job['web_url'].to_s\n\n         #update code covergate SprintProgress widgets at the same job\n         widget_title = \"code_coverage_progress_#{project['id']}\"\n         send_event(widget_title, { \n           title: \"Code Coverage - #{git_project['name']}\", \n           sprintboard_url: cov_job_url,\n           min: 0, \n           max: 100, \n           value: code_coverage, \n           moreinfo: ''\n         })\n\n         cov_color = case\n         when code_coverage &lt;= cov_red_threshold then 'red'\n         when code_coverage &lt;= cov_orange_threshold then 'orange'\n         else\n           'green'\n         end\n\n         code_coverage = \"#{code_coverage}%\"\n         code_coverage_tag = \"&lt;a href='#{cov_job_url}' target='_blank'&gt;#{code_coverage.to_s}&lt;/a&gt;\"\n       end\n\n       repo_name_a_tag = \"&lt;a href='#{repo_url}' target='_blank'&gt;#{repo_name}&lt;/a&gt;\"\n       open_mrs_size = \"&lt;a href='#{repo_url}/merge_requests' target='_blank'&gt;#{opened_mrs.size}&lt;/a&gt;\"\n\n       table[:rows].push({ \n         cols: [\n           { value: repo_name_a_tag, style: \"color: #{font_color}; background-color: #{color}\" }, \n           { value: open_mrs_size, style: \"color: #{font_color}; background-color: #{color}\" },\n           { value: code_coverage_tag, style: \"color: #{cov_color == 'orange' ? 'black' : 'white'}; background-color: #{cov_color}\" } \n         ]\n       })\n\n     end\n   end\n\n   send_event('open_merge_requests_table', table)\n\nend\nrescue Errno::ENOENT\n puts \"No config file found for gitlab - not starting the Gitlab job\"\nend\n\n</code></pre>\n\n<ul>\n<li>In the above ruby example please have a look at the following code snippet</li>\n</ul>\n\n<pre><code>merge_reqs = JSON.parse(Curl.get(\"#{gitlab_url}/api/v4/projects/#{project['id']}/merge_requests?state=opened&amp;private_token=#{gitlab_token}&amp;per_page=200\").body_str)\n       git_project =  JSON.parse(Curl.get(\"#{gitlab_url}/api/v4/projects/#{project['id']}?private_token=#{gitlab_token}\").body_str)\n       opened_mrs = merge_reqs.select { |merge_reqs| %w[opened].include? merge_reqs['state'] }\n       repo_name  = git_project['name']\n       repo_url  = git_project['web_url']\n</code></pre>\n\n<p>In here what i am trying to do is connect to our gitlab instance using a private_token and then for a specific project id (which you can get it form the UI of gitlab) check for the open merge request. I also get the git_project from which i get the name and web_url (which was my use case).</p>\n\n<ul>\n<li>For your use case you will have to get the project_id(for gitlab UI) and then use some appropriate method to get the commits.<a href=\"https://docs.gitlab.com/ee/api/README.html#personal-access-tokens\" rel=\"nofollow noreferrer\">gitlab docs</a></li>\n</ul>\n"}], "owner": {"reputation": 180, "user_id": 11956424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7aa174ebed665ba900d9291d298f07?s=128&d=identicon&r=PG&f=1", "display_name": "Amal", "link": "https://stackoverflow.com/users/11956424/amal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 0, "accepted_answer_id": 57952575, "answer_count": 1, "score": 0, "last_activity_date": 1568640069, "creation_date": 1568609805, "last_edit_date": 1568629043, "question_id": 57950598, "link": "https://stackoverflow.com/questions/57950598/how-to-get-commit-history-of-users-in-gitlab-in-rails", "title": "How to get commit history of users in gitlab in rails", "body": "<p>I am trying to create an app which will fetch the gitlab/github commit history of the user which i can just show in a side panel and it can be checked on or off depending on my criteria. I want to know if there is a way to fetch the current logged user's gitlab/github commit history. I tried to use the gem</p>\n\n<pre><code>https://github.com/libgit2/rugged\n</code></pre>\n\n<p>But couldn't find a way to implement my need. If anyone knows how to implement this it would be so much helpful. Thanks.</p>\n\n<p><strong>Update</strong></p>\n\n<p>I have now managed to get the user by using :</p>\n\n<pre><code>Gitlab.endpoint = 'https://gitlab.com/api/v4'\nGitlab.private_token = 'token'\ng = Gitlab.client(\n  endpoint: 'https://gitlab.com/api/v4',\n  private_token: 'token',\n  httparty: {\n    headers: { 'Cookie' =&gt; 'gitlab_canary=true' }\n  }\n)\n</code></pre>\n\n<p>By using the command <code>g.user</code> i am able to get the user but i need to get the commits of the user that he has done in <code>gitlab</code>.</p>\n"}, {"tags": ["ruby", "enumerable"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1568618388, "post_id": 57950491, "comment_id": 102316334, "body": "It is a bit unclear from your example which order is more important \u2013 the one in the lines or the keywords. If the keywords were <code>%w[stop start]</code> or the lines were <code>[&#39;stop something&#39;, &#39;start something&#39;]</code> would you then still expect <code>start</code> to be returned or would you expect <code>stop</code> in such cases?"}, {"owner": {"reputation": 61, "user_id": 10766286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf6d98a48ccb857df68b9a8f1a99d76?s=128&d=identicon&r=PG&f=1", "display_name": "WuMing2", "link": "https://stackoverflow.com/users/10766286/wuming2"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1568618789, "post_id": 57950491, "comment_id": 102316517, "body": "In your example I would expect <code>stop</code>.  The first line with matching keyword defines the keyword returned."}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1568621501, "post_id": 57950491, "comment_id": 102317635, "body": "This would also work: <code>keyword = arr.find { |a| a[&#47;\\A(start|stop)\\b&#47;] } &amp;&amp; Regexp.last_match[0]</code> (Or shorter: <code>arr.find { |a| a[&#47;\\A(start|stop)\\b&#47;] } &amp;&amp; $1</code>)"}, {"owner": {"reputation": 61, "user_id": 10766286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf6d98a48ccb857df68b9a8f1a99d76?s=128&d=identicon&r=PG&f=1", "display_name": "WuMing2", "link": "https://stackoverflow.com/users/10766286/wuming2"}, "edited": false, "score": 0, "creation_date": 1568623530, "post_id": 57950491, "comment_id": 102318634, "body": "Your implementation is still 4x faster than mine.  Would have saved 2 tenths of a second by now :)"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 10766286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf6d98a48ccb857df68b9a8f1a99d76?s=128&d=identicon&r=PG&f=1", "display_name": "WuMing2", "link": "https://stackoverflow.com/users/10766286/wuming2"}, "edited": false, "score": 0, "creation_date": 1568616676, "post_id": 57951494, "comment_id": 102315575, "body": "I need to return the matching keyword, not the line."}, {"owner": {"reputation": 61, "user_id": 10766286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf6d98a48ccb857df68b9a8f1a99d76?s=128&d=identicon&r=PG&f=1", "display_name": "WuMing2", "link": "https://stackoverflow.com/users/10766286/wuming2"}, "edited": false, "score": 0, "creation_date": 1568620280, "post_id": 57951494, "comment_id": 102317134, "body": "For some reason your original solution is 11x faster than either of mine."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 61, "user_id": 10766286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf6d98a48ccb857df68b9a8f1a99d76?s=128&d=identicon&r=PG&f=1", "display_name": "WuMing2", "link": "https://stackoverflow.com/users/10766286/wuming2"}, "edited": false, "score": 0, "creation_date": 1568620639, "post_id": 57951494, "comment_id": 102317278, "body": "Because of <code>lazy</code> \u2013 which adds a bit of initial overhead \u2013 me version will <code>map</code> until a matching line is found and then return immediately. Your version will first evaluate all lines before checking the condition \u2013 even if a match was already on the second element (like in your example)."}, {"owner": {"reputation": 61, "user_id": 10766286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf6d98a48ccb857df68b9a8f1a99d76?s=128&d=identicon&r=PG&f=1", "display_name": "WuMing2", "link": "https://stackoverflow.com/users/10766286/wuming2"}, "edited": false, "score": 0, "creation_date": 1568620673, "post_id": 57951494, "comment_id": 102317295, "body": "<code>lazy</code> adds a consistent penalty and speed is basically equal to mine. Without your latest is 4x faster."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 61, "user_id": 10766286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf6d98a48ccb857df68b9a8f1a99d76?s=128&d=identicon&r=PG&f=1", "display_name": "WuMing2", "link": "https://stackoverflow.com/users/10766286/wuming2"}, "edited": false, "score": 0, "creation_date": 1568620765, "post_id": 57951494, "comment_id": 102317337, "body": "As I already wrote in my answer. Only use <code>lazy</code> if the number of lines is huge. If the number is small it is not worth it."}, {"owner": {"reputation": 61, "user_id": 10766286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf6d98a48ccb857df68b9a8f1a99d76?s=128&d=identicon&r=PG&f=1", "display_name": "WuMing2", "link": "https://stackoverflow.com/users/10766286/wuming2"}, "edited": false, "score": 0, "creation_date": 1568620895, "post_id": 57951494, "comment_id": 102317385, "body": "It&#39;s never more than 10 lines so I will skip it.  Thanks for the useful answer."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1568619902, "last_edit_date": 1568619902, "creation_date": 1568615693, "answer_id": 57951494, "question_id": 57950491, "link": "https://stackoverflow.com/questions/57950491/map-find-in-ruby/57951494#57951494", "title": "#map_find in Ruby?", "body": "<p>I would do something like this:</p>\n\n<pre><code>lines = [\"unrelated\", \"start something\", \"stop something\"]\nkeywords = /\\A(start|stop)/\n\nlines.lazy.map { |line| line[keywords] }.find(&amp;:itself)\n#=&gt; \"start\"\n</code></pre>\n\n<p>You might want to skip the <code>lazy</code> when the number of <code>lines</code> is small. The bigger it is the more you will benefit from <code>lazy</code>.</p>\n"}], "owner": {"reputation": 61, "user_id": 10766286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf6d98a48ccb857df68b9a8f1a99d76?s=128&d=identicon&r=PG&f=1", "display_name": "WuMing2", "link": "https://stackoverflow.com/users/10766286/wuming2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 57951494, "answer_count": 1, "score": 0, "last_activity_date": 1568619902, "creation_date": 1568608984, "last_edit_date": 1568618258, "question_id": 57950491, "link": "https://stackoverflow.com/questions/57950491/map-find-in-ruby", "title": "#map_find in Ruby?", "body": "<p>Return the first keyword matched in a set of text lines.</p>\n\n<p>I found <code>#map</code> and <code>#find</code> and <code>#find</code> again solve the problem. A convoluted solution that doesn't satisfy.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>[\"unrelated\", \"start something\", \"stop something\"].map do |t|\n  [\"start\",\"stop\"].find {|k| k == t.split(/[ \\t]{1,}/).first}\nend.find {|k| !k.nil?}\n</code></pre>\n\n<p>The above returns <code>\"start\"</code> as expected.  A convenience method as <code>#map_find</code> may compact it. Or maybe a clever selection algorithm for this problem exists already. Please advise.</p>\n\n<hr>\n\n<h2>Edit</h2>\n\n<p>Another solution:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>keys = [\"start\", \"stop\"]\nreg = Regexp.new(\"^\"+keys.first+\" |^\"+keys.last+\" \")\n[\"unrelated\", \"start something\", \"stop something\"].map{|m| m.slice(reg)}.find {|k| !k.nil?}\n</code></pre>\n"}, {"tags": ["node.js", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 2262, "user_id": 4101569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c4c64e58bc5cdeec8e7ce067131a54?s=128&d=identicon&r=PG", "display_name": "katafrakt", "link": "https://stackoverflow.com/users/4101569/katafrakt"}, "edited": false, "score": 0, "creation_date": 1568650275, "post_id": 57950259, "comment_id": 102333090, "body": "Gem is a library, so you need to actually write some code in Ruby using it. An example is in the repository. This should go to some file, say <code>bible.rb</code>, which is then run with <code>ruby bible.rb</code>."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7585534, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158342879855249/picture?type=large", "display_name": "Michael Jacobson", "link": "https://stackoverflow.com/users/7585534/michael-jacobson"}, "is_accepted": false, "score": 0, "last_activity_date": 1569493190, "creation_date": 1569493190, "answer_id": 58114658, "question_id": 57950259, "link": "https://stackoverflow.com/questions/57950259/run-a-ruby-gem-repo-on-mac/58114658#58114658", "title": "Run a ruby / gem repo on mac", "body": "<p>The quickest way to interact with the gem is probably by using IRB (this is the standard Ruby REPL, and is analogous to using the <code>Node</code> command in your terminal to open the Node REPL). </p>\n\n<p>In your terminal (I'm assuming you're working on a Unix-like OS), run the following command:</p>\n\n<p><code>$ irb</code> - if you've installed Ruby correctly this should open an IRB session</p>\n\n<p>Once inside IRB, you can run Ruby commands and have them immediately evaluated and executed. From here you can run the usage example from the gem's README:</p>\n\n<pre><code>require 'bible_parser'\n\nbible = BibleParser.new(File.open('web.usfx.xml'))\nverse = bible.books.first.chapters.first.verses.first\n# =&gt; &lt;Genesis 1:1&gt;\nverse.text\n# =&gt; \"In the beginning, God created the heavens and the earth.\\n\"\n</code></pre>\n\n<p>Of course, this presupposes that you have a valid XML document available.</p>\n"}], "owner": {"reputation": 99, "user_id": 11684469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d1733eb262169e193415afc902e9194?s=128&d=identicon&r=PG&f=1", "display_name": "Rachel V", "link": "https://stackoverflow.com/users/11684469/rachel-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1569493190, "creation_date": 1568606890, "question_id": 57950259, "link": "https://stackoverflow.com/questions/57950259/run-a-ruby-gem-repo-on-mac", "title": "Run a ruby / gem repo on mac", "body": "<p>I'm a node.js dev, I want to run this app <a href=\"https://github.com/seven1m/bible_parser\" rel=\"nofollow noreferrer\">https://github.com/seven1m/bible_parser</a></p>\n\n<p>Installed ruby and gem, but what's next?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "capybara", "minitest"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1568574847, "post_id": 57947208, "comment_id": 102307948, "body": "Try removing the <code>describe</code> line."}, {"owner": {"reputation": 757, "user_id": 6939256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e25b477a55a8048071d22e032ecf22f0?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamints", "link": "https://stackoverflow.com/users/6939256/benjamints"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1568575366, "post_id": 57947208, "comment_id": 102308061, "body": "I managed to get it to work but I have another problem. I have to directly specify the file when I run it &#39;ruby -Itest test/controllers/test_movies_integration.rb&#39;."}, {"owner": {"reputation": 757, "user_id": 6939256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e25b477a55a8048071d22e032ecf22f0?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamints", "link": "https://stackoverflow.com/users/6939256/benjamints"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1568575387, "post_id": 57947208, "comment_id": 102308068, "body": "If I type &#39;rails test&#39;, no tests are located and everything goes green. 0 tests, 0 assertions, 0 failures, 0 errors, 0 skips."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1568575839, "post_id": 57947208, "comment_id": 102308173, "body": "Where are your test files located?"}, {"owner": {"reputation": 757, "user_id": 6939256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e25b477a55a8048071d22e032ecf22f0?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamints", "link": "https://stackoverflow.com/users/6939256/benjamints"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1568577278, "post_id": 57947208, "comment_id": 102308478, "body": "<a href=\"https://imgur.com/a/cb6z3wj\" rel=\"nofollow noreferrer\">imgur.com/a/cb6z3wj</a>"}, {"owner": {"reputation": 757, "user_id": 6939256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e25b477a55a8048071d22e032ecf22f0?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamints", "link": "https://stackoverflow.com/users/6939256/benjamints"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1568577295, "post_id": 57947208, "comment_id": 102308482, "body": "As in the image above, where they are located by default."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1568577608, "post_id": 57947208, "comment_id": 102308542, "body": "Try renaming your file to whatever_test.rb"}, {"owner": {"reputation": 757, "user_id": 6939256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e25b477a55a8048071d22e032ecf22f0?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamints", "link": "https://stackoverflow.com/users/6939256/benjamints"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1568577884, "post_id": 57947208, "comment_id": 102308596, "body": "that seems to of fixed it!"}], "owner": {"reputation": 757, "user_id": 6939256, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e25b477a55a8048071d22e032ecf22f0?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamints", "link": "https://stackoverflow.com/users/6939256/benjamints"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 248, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568572959, "creation_date": 1568572959, "question_id": 57947208, "link": "https://stackoverflow.com/questions/57947208/undefined-method-test-get-index-for-class-minitestresult", "title": "undefined method `test_get_index&#39; for class `Minitest::Result&#39;", "body": "<p>I'm trying to run this integration test. For some reason, it isn't accepting minitest syntax and I have no clue why.</p>\n\n<p>test_helper.rb</p>\n\n<pre><code>require File.expand_path(\"../../config/environment\", __FILE__)\nrequire \"rails/test_help\"\nrequire \"minitest/rails\"\nrequire 'minitest/reporters'\nrequire \"minitest/rails/capybara\"\n\nMinitest::Reporters.use!\n\nclass ActiveSupport::TestCase\n    fixtures :all\nend\n</code></pre>\n\n<p>gemfile.rb</p>\n\n<pre><code>group :test do\n    gem \"minitest-rails\"\n    gem 'minitest-rails-capybara'\n    gem 'minitest-reporters'\n    gem 'guard'\n    gem 'guard-minitest'\n    gem \"selenium-webdriver\"\n    gem \"chromedriver-helper\"\n    gem \"shoulda-matchers\", require: false\nend\n</code></pre>\n\n<p>integration_controller_test</p>\n\n<pre><code>require 'test_helper'\n\nclass MovieControllerTest &lt; ActionDispatch::IntegrationTest\n    setup do \n        @movie = movies(:movie_1)\n    end\n\n    describe \"integration testing\" do\n        test 'get index' do \n            get movies_path\n            assert_response :success\n        end     \n    end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "jwt"], "answers": [{"comments": [{"owner": {"reputation": 1210, "user_id": 5028532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f50c017af1ddc79a80bc3f92e94521a4?s=128&d=identicon&r=PG&f=1", "display_name": "razdi", "link": "https://stackoverflow.com/users/5028532/razdi"}, "edited": false, "score": 1, "creation_date": 1568607315, "post_id": 57950223, "comment_id": 102313065, "body": "Can you please add the actual code and a description rather than a screenshot?"}, {"owner": {"reputation": 5, "user_id": 11909353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/730804ad6b74ef73e36e722e20fed5df?s=128&d=identicon&r=PG&f=1", "display_name": "zplack631", "link": "https://stackoverflow.com/users/11909353/zplack631"}, "edited": false, "score": 0, "creation_date": 1568649490, "post_id": 57950223, "comment_id": 102332761, "body": "Moufid, thank you very much, indeed is working but, just if the params is present i&#39;d like to know if possible if just the boolean is set to true"}], "tags": [], "owner": {"reputation": 16, "user_id": 10172854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7a1dbab677f796ff0f855d417007743?s=128&d=identicon&r=PG&f=1", "display_name": "Moufid A", "link": "https://stackoverflow.com/users/10172854/moufid-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1568606432, "creation_date": 1568606432, "answer_id": 57950223, "question_id": 57946775, "link": "https://stackoverflow.com/questions/57946775/rails-knock-jwt-config-more-than-one-param-to-login-on-the-entity-model/57950223#57950223", "title": "Rails Knock jwt config more than one param to login on the entity model", "body": "<p>I had to test the code by adding a second parameter for the connection and it works well on my side\n<a href=\"https://i.stack.imgur.com/yHi7N.jpg\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": [], "owner": {"reputation": 16, "user_id": 10172854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7a1dbab677f796ff0f855d417007743?s=128&d=identicon&r=PG&f=1", "display_name": "Moufid A", "link": "https://stackoverflow.com/users/10172854/moufid-a"}, "is_accepted": true, "score": 0, "last_activity_date": 1568707355, "last_edit_date": 1568707355, "creation_date": 1568706684, "answer_id": 57969681, "question_id": 57946775, "link": "https://stackoverflow.com/questions/57946775/rails-knock-jwt-config-more-than-one-param-to-login-on-the-entity-model/57969681#57969681", "title": "Rails Knock jwt config more than one param to login on the entity model", "body": "<p><code>def auth_params\n      params.permit auth: [:phone, :pin, :has_access]\n   end\n</code></p>\n\n<p>` def self.from_token_request</p>\n\n<pre><code>    phone = request.params[:auth]&amp;&amp; request.params[:auth][:phone]\n  has_access= request.params[:auth]&amp;&amp; request.params[:auth][:has_access]\n  self.find_by phone: phone, has_access: has_access\n</code></pre>\n\n<p>end\n`</p>\n\n<p>If you have submitted the offer on upwork. I am sent a proposal to help you</p>\n"}], "owner": {"reputation": 5, "user_id": 11909353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/730804ad6b74ef73e36e722e20fed5df?s=128&d=identicon&r=PG&f=1", "display_name": "zplack631", "link": "https://stackoverflow.com/users/11909353/zplack631"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 57969681, "answer_count": 2, "score": 0, "last_activity_date": 1568707355, "creation_date": 1568570215, "question_id": 57946775, "link": "https://stackoverflow.com/questions/57946775/rails-knock-jwt-config-more-than-one-param-to-login-on-the-entity-model", "title": "Rails Knock jwt config more than one param to login on the entity model", "body": "<p>after setup a simple auth with knock i'd like to add a extra param to auth_params,</p>\n\n<p>in the docs the config is via-the-entity-model</p>\n\n<pre><code>    def self.from_token_request request\n    # Returns a valid user, `nil` or raise `Knock.not_found_exception_class_name`\n    # e.g.\n    #   email = request.params[\"auth\"] &amp;&amp; request.params[\"auth\"][\"email\"]\n    #   self.find_by email: email\n  end\n</code></pre>\n\n<p>So i presumed so</p>\n\n<pre><code>def self.from_token_request(request)\n    email = request.params[\"auth\"] &amp;&amp; request.params[\"auth\"][\"email\"]\n    confirmation_email = request.params[\"auth\"] &amp;&amp; request.params[\"auth\"][\"confirmation_email\"]\n    self.find_by(email: email, confirmation_email: confirmation_email)\n  end\n</code></pre>\n\n<p>And after a post to UserTokenController \nthat is config to</p>\n\n<pre><code>def auth_params\n    params.require(:auth).permit(:email, :password, :confirmation_email)\n  end\n</code></pre>\n\n<p>Did not generated the  token nor the :confirmation_email params was used and caused 404 error!</p>\n\n<p>the logs</p>\n\n<blockquote>\n  <p>Processing by UserTokenController#create as <em>/</em>   Parameters:\n  {\"auth\"=>{\"password\"=>\"[FILTERED]\", \"email\"=>\"manolo@manolo.com\"},\n  \"user_token\"=>{\"auth\"=>{\"password\"=>\"[FILTERED]\",\n  \"email\"=>\"manolo@manolo.com\"}}}   User Load (2.8ms)  SELECT  \"users\".*\n  FROM \"users\" WHERE \"users\".\"email\" = $1 AND\n  \"users\".\"confirmation_email\" IS NULL LIMIT $2  [[\"email\",\n  \"manolo@manolo.com\"], [\"LIMIT\", 1]]   \u21b3 app/models/user.rb:51\n  Completed 404 Not Found in 96ms (ActiveRecord: 15.3ms)</p>\n</blockquote>\n\n<p>So, please someone can clarify how to config the knock gem to login with more than email params?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "linux", "ubuntu", "rvm"], "comments": [{"owner": {"reputation": 89316, "user_id": 238886, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8ca29123b5669b26f9b6ca2c62d9d215?s=128&d=identicon&r=PG", "display_name": "Wayne Conrad", "link": "https://stackoverflow.com/users/238886/wayne-conrad"}, "edited": false, "score": 1, "creation_date": 1568604955, "post_id": 57946621, "comment_id": 102312688, "body": "I do not think this should be closed as a non-programming question.  Although it looks at first glance like a Debian question, it&#39;s really a Ruby installation (via rvm) question, which is on-topic.  Details: The problem is that rvm, while compiling Ruby, sees a missing library.  It expects that library to be in the Debian package <code>libssl-dev</code>, but it does not see that library in the OP&#39;s Debian.  That said, I&#39;ll be surprised if there isn&#39;t an existing question that covers this."}, {"owner": {"reputation": 11828, "user_id": 4420967, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J6pYX.png?s=128&g=1", "display_name": "James Z", "link": "https://stackoverflow.com/users/4420967/james-z"}, "edited": false, "score": 0, "creation_date": 1568647253, "post_id": 57946621, "comment_id": 102331602, "body": "The first issue says <code>please read &#47;home&#47;tanmay&#47;.rvm&#47;log&#47;1568568674_ruby-2.6.3&#47;package_install_&zwnj;&#8203;libssl-dev.log</code>. So what&#39;s in there?"}], "answers": [{"comments": [{"owner": {"reputation": 568, "user_id": 1491929, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c804b3e0f1c1cbb4c6e6c6d633d19c46?s=128&d=identicon&r=PG&f=1", "display_name": "user1491929", "link": "https://stackoverflow.com/users/1491929/user1491929"}, "edited": false, "score": 2, "creation_date": 1597161391, "post_id": 60325120, "comment_id": 112041011, "body": "If you&#39;re on Debian you might need to add the keyserver as well   <code>sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 3B4FE6ACC0B21F32</code>"}], "tags": [], "owner": {"reputation": 5242, "user_id": 3083848, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/JMddU.jpg?s=128&g=1", "display_name": "Emu", "link": "https://stackoverflow.com/users/3083848/emu"}, "is_accepted": false, "score": 14, "last_activity_date": 1582218087, "creation_date": 1582218087, "answer_id": 60325120, "question_id": 57946621, "link": "https://stackoverflow.com/questions/57946621/error-running-requirements-debian-libs-install-libssl-dev/60325120#60325120", "title": "Error running &#39;requirements_debian_libs_install libssl-dev&#39;,", "body": "<p>Here is the solution for Ubuntu 19+</p>\n\n<pre><code>sudo nano /etc/apt/sources.list\nadd deb http://security.ubuntu.com/ubuntu bionic-security main\nsudo apt update &amp;&amp; apt-cache policy libssl1.0-dev\nsudo apt-get install libssl1.0-dev\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8176083, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iGft6v_bsow/AAAAAAAAAAI/AAAAAAAAAKw/pu0mH-Rmjf4/photo.jpg?sz=128", "display_name": "tanmay bhawsar", "link": "https://stackoverflow.com/users/8176083/tanmay-bhawsar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3560, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1616770090, "creation_date": 1568569016, "last_edit_date": 1568647213, "question_id": 57946621, "link": "https://stackoverflow.com/questions/57946621/error-running-requirements-debian-libs-install-libssl-dev", "title": "Error running &#39;requirements_debian_libs_install libssl-dev&#39;,", "body": "<p>I am facing problem while installing rvm 2.6.3</p>\n\n<pre><code>Installing required packages: libssl-dev....\nError when running 'requirements_debian_libs_install libssl-dev',\nplease read /home/tanmay/.rvm/log/1568568674_ruby-2.6.3/package_install_libssl-dev.log\nRequirements installation failed with status: 100.\n</code></pre>\n\n<p>And then I tried to install libssl-dev.It wasn't installed.. I got this error:</p>\n\n<pre><code>Package libssl-dev is not available, but is referred to by another package.\nThis may mean that the package is missing, has been obsoleted, or\nis only available from another source\n\nE: Package 'libssl-dev' has no installation candidate\n</code></pre>\n\n<p>what should I do now?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "aws-transcribe"], "comments": [{"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1568563962, "post_id": 57945806, "comment_id": 102305179, "body": "What about <code>params[:url]</code> instead of just <code>url</code>? <code>media_file_uri: params[:url]</code>"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1568564106, "post_id": 57945806, "comment_id": 102305227, "body": "Show your entire stack trace. Otherwise, we&#39;re rather in the dark."}, {"owner": {"reputation": 43, "user_id": 12070489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e448ef19b03ebb0860a9980eb3ef10d6?s=128&d=identicon&r=PG&f=1", "display_name": "brobert", "link": "https://stackoverflow.com/users/12070489/brobert"}, "reply_to_user": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1568565498, "post_id": 57945806, "comment_id": 102305592, "body": "@arieljuod does the same"}, {"owner": {"reputation": 43, "user_id": 12070489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e448ef19b03ebb0860a9980eb3ef10d6?s=128&d=identicon&r=PG&f=1", "display_name": "brobert", "link": "https://stackoverflow.com/users/12070489/brobert"}, "edited": false, "score": 0, "creation_date": 1568565777, "post_id": 57945806, "comment_id": 102305666, "body": "@jvillianI just added all the sequence from the server, which is all I got (this wouldn&#39;t work on development because local ActiveStorage attachments don&#39;t respond to .service_url method so this whole thing just doesn&#39;t work"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 12070489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e448ef19b03ebb0860a9980eb3ef10d6?s=128&d=identicon&r=PG&f=1", "display_name": "brobert", "link": "https://stackoverflow.com/users/12070489/brobert"}, "edited": false, "score": 0, "creation_date": 1568566815, "post_id": 57946208, "comment_id": 102305929, "body": "It still does the same and ends up in the same error: <code>[fe9dca60-403b-4ebb-bf87-5402e3563f44] ArgumentError (wrong number of arguments (given 0, expected 1)):</code>    My routes are OK I believe:  <code>transcripts_request_transcription POST   &#47;transcripts&#47;request_transcription(.:format)                                             transcripts#request_transcription</code>"}], "tags": [], "owner": {"reputation": 141, "user_id": 10043524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e81c8d061b996ff7555a797692ce7d7?s=128&d=identicon&r=PG&f=1", "display_name": "leafeve", "link": "https://stackoverflow.com/users/10043524/leafeve"}, "is_accepted": false, "score": 0, "last_activity_date": 1568566069, "creation_date": 1568566069, "answer_id": 57946208, "question_id": 57945806, "link": "https://stackoverflow.com/questions/57945806/controller-method-wont-accept-the-params-i-send-through-a-button-although-they/57946208#57946208", "title": "controller method won&#39;t accept the params I send through a button although they are sent", "body": "<p>try to change:</p>\n\n<pre><code>&lt;%= button_to 'Start transcribing', {:controller =&gt; \"transcripts\", :action =&gt; \"request_transcription\", :url =&gt; url } , { :method =&gt; :post }  %&gt;\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>&lt;%= button_to 'Invite a user', your_action_path(url: url), method: :post, remote: true %&gt;\n</code></pre>\n\n<p>please check your action path in <code>rails routes | grep request_transcription</code></p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 12070489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e448ef19b03ebb0860a9980eb3ef10d6?s=128&d=identicon&r=PG&f=1", "display_name": "brobert", "link": "https://stackoverflow.com/users/12070489/brobert"}, "is_accepted": false, "score": 0, "last_activity_date": 1568577092, "creation_date": 1568577092, "answer_id": 57947701, "question_id": 57945806, "link": "https://stackoverflow.com/questions/57945806/controller-method-wont-accept-the-params-i-send-through-a-button-although-they/57947701#57947701", "title": "controller method won&#39;t accept the params I send through a button although they are sent", "body": "<p>I found what happens.</p>\n\n<p>request_transcription method should not, in this case, expect any arguments.</p>\n\n<p>So instead of </p>\n\n<pre><code>def request_transcription(url)\n.\n.\nend\n</code></pre>\n\n<p>it should have been</p>\n\n<pre><code>def request_transcription\n.\n.\nend\n</code></pre>\n\n<p>That solved it. Thanks everyone for the answers and for caring!</p>\n"}], "owner": {"reputation": 43, "user_id": 12070489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e448ef19b03ebb0860a9980eb3ef10d6?s=128&d=identicon&r=PG&f=1", "display_name": "brobert", "link": "https://stackoverflow.com/users/12070489/brobert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1568593760, "creation_date": 1568563190, "last_edit_date": 1568565458, "question_id": 57945806, "link": "https://stackoverflow.com/questions/57945806/controller-method-wont-accept-the-params-i-send-through-a-button-although-they", "title": "controller method won&#39;t accept the params I send through a button although they are sent", "body": "<p>I'm a begginer and I'm having trouble figuring this one out.</p>\n\n<p>Also, I don't know of a way of testing this piece of code because I'm using ActiveStorage and the method that is giving me trouble connects to an AWS API which uses the URi inside an S3 bucket, while my local files are, well, local, so I'm really stuck.</p>\n\n<p>I've written a method in one of my controllers which accepts one argument (url) and, although I believe I'm sending it properly (from a button) and passing the correct params, it keeps telling me <code>ArgumentError (wrong number of arguments (given 0, expected 1)):</code></p>\n\n<p>It goes as follows:</p>\n\n<p>In my model:</p>\n\n<pre><code>def transcript_text\n        @transcript_text = Aws::TranscribeService::Client.new(region: 'eu-west-1')\nend\n</code></pre>\n\n<p>and</p>\n\n<pre><code>def self.new_job_name\n        SecureRandom.urlsafe_base64\nend\n</code></pre>\n\n<p>The method inside <code>transcript_controller.rb</code> (please disregard the error handling, which is probably wrong too):</p>\n\n<pre><code>def request_transcription(url)\n    resp = @transcript_text.start_transcription_job( { settings: { show_speaker_labels: false, max_speaker_labels: 1, channel_identification: false}, language_code: \"es-ES\", media: { media_file_uri: url }, transcription_job_name: @transcript_text.new_job_name } )\n    if resp\n      format.html { redirect_to @transcript, notice: 'Transcript job started.' }\n    else\n      format.html {\u00a0redirect_to @transcript, alert: 'Something didn't go as planned'}\n    end\nend\n</code></pre>\n\n<p>and finally, in my views:</p>\n\n<pre><code>&lt;% url = @transcript.audio.service_url.to_s.split(\"?\").first %&gt;\n&lt;%= button_to 'Start transcribing', {:controller =&gt; \"transcripts\", :action =&gt; \"request_transcription\", :url =&gt; url } , { :method =&gt; :post }  %&gt;\n</code></pre>\n\n<p><code>@transcript.audio.service_url.to_s.split(\"?\").first</code> gets the uri of the file I want transcribed inside my S3 bucket.</p>\n\n<hr>\n\n<p>So my reasoning is that if I press that button, it should send the <code>url</code> as a param to the <code>transcript_controller#request_transcription</code>, which accepts it and puts it to work.</p>\n\n<p>What do I want: I want <code>transcript_controller#request_transcription</code> to start a transcription job with AWS Transcribe. I'll then check via de aws CLI if actually did, and move along from that.</p>\n\n<p>What am I getting: that sad <code>ArgumentError (wrong number of arguments (given 0, expected 1)):</code> that is driving me crazy.</p>\n\n<p>What do I see in my server logs:</p>\n\n<pre><code>2019-09-15T16:33:47.927780+00:00 app[web.1]: I, [2019-09-15T16:33:47.927649 #4]  INFO -- : [b23d8f2a-fade-424b-8e21-6b532c5fd470] Started POST \"/transcripts/request_transcription?url=https%3A%2F%2F[REDACTED].s3.eu-west-1.amazonaws.com%2F0d4mjj10zgdll7roxkn06rhrhmw9\" for 185.79.22.122 at 2019-09-15 16:33:47 +0000\n    2019-09-15T16:33:47.929108+00:00 app[web.1]: I, [2019-09-15T16:33:47.929029 #4]  INFO -- : [b23d8f2a-fade-424b-8e21-6b532c5fd470] Processing by TranscriptsController#request_transcription as HTML\n    2019-09-15T16:33:47.929195+00:00 app[web.1]: I, [2019-09-15T16:33:47.929132 #4]  INFO -- : [b23d8f2a-fade-424b-8e21-6b532c5fd470]   Parameters: {\"authenticity_token\"=&gt;\"OKDuS9Lu6Y1nv0vgo50qagRNbLAysuqbkDb495zO4FryikWeexYVa+0uTht+Eevw3uUqJ+jA6mibsamcwcWX+A==\", \"url\"=&gt;\"https://[REDACTED].s3.eu-west-1.amazonaws.com/0d4mjj10zgdll7roxkn06rhrhmw9\"}\n    2019-09-15T16:33:47.950168+00:00 app[web.1]: D, [2019-09-15T16:33:47.950019 #4] DEBUG -- : [b23d8f2a-fade-424b-8e21-6b532c5fd470]   User Load (3.8ms)  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 ORDER BY \"users\".\"id\" ASC LIMIT $2  [[\"id\", 2], [\"LIMIT\", 1]]\n    2019-09-15T16:33:47.965636+00:00 app[web.1]: I, [2019-09-15T16:33:47.965509 #4]  INFO -- : [b23d8f2a-fade-424b-8e21-6b532c5fd470] Completed 500 Internal Server Error in 36ms (ActiveRecord: 3.8ms | Allocations: 1338)\n    2019-09-15T16:33:47.971644+00:00 app[web.1]: F, [2019-09-15T16:33:47.971537 #4] FATAL -- : [b23d8f2a-fade-424b-8e21-6b532c5fd470]\n    2019-09-15T16:33:47.971648+00:00 app[web.1]: [b23d8f2a-fade-424b-8e21-6b532c5fd470] ArgumentError (wrong number of arguments (given 0, expected 1)):\n    2019-09-15T16:33:47.971651+00:00 app[web.1]: [b23d8f2a-fade-424b-8e21-6b532c5fd470]\n    2019-09-15T16:33:47.971653+00:00 app[web.1]: [b23d8f2a-fade-424b-8e21-6b532c5fd470] app/controllers/transcripts_controller.rb:70:in `request_transcription'\n</code></pre>\n\n<p>Apart from all the other things that might be horribly wrong in these lines of code, can you please help me get that <code>url</code> inside the request_transcription method? Thanks in advance</p>\n"}, {"tags": ["html", "ruby-on-rails", "ruby", "asset-pipeline", "assets"], "comments": [{"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 1, "creation_date": 1568564336, "post_id": 57945675, "comment_id": 102305280, "body": "you have relative paths like this everywhere: <code>&lt;script src=&quot;..&#47;assets&#47;js&#47;app.min.js&quot;&gt;&lt;&#47;script&gt;</code>, use absolute paths instead: <code>&lt;script src=&quot;&#47;assets&#47;js&#47;app.min.js&quot;&gt;&lt;&#47;script&gt;</code>. Also, use rails helpers: <code>javascript_include_tag</code>, <code>stylesheet_link_tag</code>, <code>image_tag</code>, etc, don&#39;t hardcode the tags, you&#39;ll have less headhaches"}, {"owner": {"reputation": 157, "user_id": 4300830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-90J61yPpDps/AAAAAAAAAAI/AAAAAAAAAx8/3D6zT-UidAM/photo.jpg?sz=128", "display_name": "Ezio Auditore", "link": "https://stackoverflow.com/users/4300830/ezio-auditore"}, "reply_to_user": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1568565417, "post_id": 57945675, "comment_id": 102305577, "body": "OMG... i was looking for that answer 5 years ago. Finally i found a hero."}, {"owner": {"reputation": 157, "user_id": 4300830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-90J61yPpDps/AAAAAAAAAAI/AAAAAAAAAx8/3D6zT-UidAM/photo.jpg?sz=128", "display_name": "Ezio Auditore", "link": "https://stackoverflow.com/users/4300830/ezio-auditore"}, "reply_to_user": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1568603498, "post_id": 57945675, "comment_id": 102312488, "body": "@arieljuod do you want to post it final answer? i will accept it"}], "answers": [{"tags": [], "owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "is_accepted": true, "score": 1, "last_activity_date": 1568604971, "creation_date": 1568604971, "answer_id": 57950066, "question_id": 57945675, "link": "https://stackoverflow.com/questions/57945675/how-can-use-a-custom-folder-asset-using-namespace-routes/57950066#57950066", "title": "How can use a custom folder asset using namespace routes?", "body": "<p>You have relative paths like this everywhere: <code>&lt;script src=\"../assets/js/app.min.js\"&gt;&lt;/script&gt;</code>, use absolute paths instead: <code>&lt;script src=\"/assets/js/app.min.js\"&gt;&lt;/script&gt;</code>.</p>\n\n<p>Also, use rails helpers like <code>javascript_include_tag</code>, <code>stylesheet_link_tag</code>, <code>image_tag</code>, etc, don't hardcode the tags, you'll have less headhaches.</p>\n"}], "owner": {"reputation": 157, "user_id": 4300830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-90J61yPpDps/AAAAAAAAAAI/AAAAAAAAAx8/3D6zT-UidAM/photo.jpg?sz=128", "display_name": "Ezio Auditore", "link": "https://stackoverflow.com/users/4300830/ezio-auditore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 1, "accepted_answer_id": 57950066, "answer_count": 1, "score": -2, "last_activity_date": 1568604971, "creation_date": 1568562167, "last_edit_date": 1568564350, "question_id": 57945675, "link": "https://stackoverflow.com/questions/57945675/how-can-use-a-custom-folder-asset-using-namespace-routes", "title": "How can use a custom folder asset using namespace routes?", "body": "<p>I'm trying to use a template created and apply it into a ruby on rails project without adding assets or use ruby on rails procedures.</p>\n\n<p>Is it possible to use a custom folder on namespace routes?</p>\n\n<p>When I execute the project doesn't works without using namespaces but when i use a resources it works perfect.</p>\n\n<p>Examples:</p>\n\n<pre><code>user_management/users/index.html.erb works ok.\nuser_management/users/new.html.erb  doesn't load assets.\nuser_management/users/new.html.erb  doesn't load assets.\nusers/index.html.erb works ok.\nusers/ new.html.erb works ok.\nusers/edit.html.erb works ok.\n</code></pre>\n\n<p>Github project code:</p>\n\n<pre><code> https://github.com/sayayingod/app_sow\n</code></pre>\n\n<p>application.rb</p>\n\n<pre><code>Dir.glob(\"#{Rails.root}/color_admin_v4.5/assets/\").each do |path|\n      config.assets.paths &lt;&lt; path\nend\n</code></pre>\n\n<p>Routes.rb</p>\n\n<pre><code>namespace :user_management do\n  resources :users\nend    \n\nresources :users \n#Root Configuration\nroot 'user_management/users#new'\n</code></pre>\n\n<p>user_management/users/new.html</p>\n\n<p><a href=\"https://i.stack.imgur.com/KsiZP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KsiZP.png\" alt=\"\"></a></p>\n\n<p>users/new.html.erb</p>\n\n<p><a href=\"https://i.stack.imgur.com/VsTg1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VsTg1.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "rails-activerecord", "rails-models"], "comments": [{"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1568548781, "post_id": 57943712, "comment_id": 102301732, "body": "Can you post the above in a minimal rails app on git hub with just those things and nothing else - that would make it really easy for someone to simply download and debug."}, {"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 1, "creation_date": 1568548858, "post_id": 57943712, "comment_id": 102301746, "body": "Also update_from_api_response is missing an &#39;end&#39; keyword"}, {"owner": {"reputation": 1326, "user_id": 6092420, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/24e00c77fc8fc5f977da388a142bf9a6?s=128&d=identicon&r=PG&f=1", "display_name": "absolutelydevastated", "link": "https://stackoverflow.com/users/6092420/absolutelydevastated"}, "reply_to_user": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1568553022, "post_id": 57943712, "comment_id": 102302645, "body": "That was a copy and paste error. It&#39;s now fixed."}, {"owner": {"reputation": 1326, "user_id": 6092420, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/24e00c77fc8fc5f977da388a142bf9a6?s=128&d=identicon&r=PG&f=1", "display_name": "absolutelydevastated", "link": "https://stackoverflow.com/users/6092420/absolutelydevastated"}, "reply_to_user": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1568557846, "post_id": 57943712, "comment_id": 102303778, "body": "Also updated question with link to repo."}], "answers": [{"comments": [{"owner": {"reputation": 1326, "user_id": 6092420, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/24e00c77fc8fc5f977da388a142bf9a6?s=128&d=identicon&r=PG&f=1", "display_name": "absolutelydevastated", "link": "https://stackoverflow.com/users/6092420/absolutelydevastated"}, "edited": false, "score": 0, "creation_date": 1568557944, "post_id": 57945070, "comment_id": 102303806, "body": "I&#39;m not testing <code>update_from_api_response</code>. The function I&#39;m testing is <code>update_my_model</code> which is supposed to call <code>update_from_api_response</code>."}, {"owner": {"reputation": 1326, "user_id": 6092420, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/24e00c77fc8fc5f977da388a142bf9a6?s=128&d=identicon&r=PG&f=1", "display_name": "absolutelydevastated", "link": "https://stackoverflow.com/users/6092420/absolutelydevastated"}, "edited": false, "score": 0, "creation_date": 1568558233, "post_id": 57945070, "comment_id": 102303880, "body": "But the thing is that my actual test tests another method which calls <code>update_my_model</code> and then <code>update_from_api_response</code>. I also use <code>receive</code> to test that <code>update_from_api_response</code> is called and the logged output is the same (&quot;HELLO&quot;, &quot;WORLD&quot;). So even though <code>receive</code> supposedly &quot;replaced the method, it only did so for <code>update_from_api_response</code> instead of <code>update_from_model</code>."}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "reply_to_user": {"reputation": 1326, "user_id": 6092420, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/24e00c77fc8fc5f977da388a142bf9a6?s=128&d=identicon&r=PG&f=1", "display_name": "absolutelydevastated", "link": "https://stackoverflow.com/users/6092420/absolutelydevastated"}, "edited": false, "score": 0, "creation_date": 1568558348, "post_id": 57945070, "comment_id": 102303910, "body": "I know, that&#39;s exactly my point: if you don&#39;t want to test <code>update_from_api_response</code> on that test, then there&#39;s no point on wanting the original code to be called and checking the <code>field_1</code> value changed. <code>update_from_api_response</code> is responsible for that change, if you don&#39;t want to test that method then don&#39;t test that change since the method you are actually testing is not responsible of changing that value."}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "reply_to_user": {"reputation": 1326, "user_id": 6092420, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/24e00c77fc8fc5f977da388a142bf9a6?s=128&d=identicon&r=PG&f=1", "display_name": "absolutelydevastated", "link": "https://stackoverflow.com/users/6092420/absolutelydevastated"}, "edited": false, "score": 0, "creation_date": 1568558472, "post_id": 57945070, "comment_id": 102303940, "body": "What I&#39;m trying to say is that you are testing more things that you should on a single test. You can split the test in smaller tests easier to tests each and you&#39;ll have the same coverage with cleaner and more decoupled tests."}, {"owner": {"reputation": 1326, "user_id": 6092420, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/24e00c77fc8fc5f977da388a142bf9a6?s=128&d=identicon&r=PG&f=1", "display_name": "absolutelydevastated", "link": "https://stackoverflow.com/users/6092420/absolutelydevastated"}, "edited": false, "score": 0, "creation_date": 1568559089, "post_id": 57945070, "comment_id": 102304101, "body": "Yes, but that doesn&#39;t really explain the behaviour of the function spec. The exact same thing happens even when I&#39;m testing a function that&#39;s one level higher, and <code>update_my_model</code> prints &quot;HELLO&quot; and &quot;WORLD&quot; but doesn&#39;t print &quot;UPDATE&quot;. If that is so, it cannot be that <code>receive</code> overrides the function."}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "reply_to_user": {"reputation": 1326, "user_id": 6092420, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/24e00c77fc8fc5f977da388a142bf9a6?s=128&d=identicon&r=PG&f=1", "display_name": "absolutelydevastated", "link": "https://stackoverflow.com/users/6092420/absolutelydevastated"}, "edited": false, "score": 0, "creation_date": 1568560339, "post_id": 57945070, "comment_id": 102304413, "body": "Can you show that higher level test? <code>expect to receive</code> does override the method, that&#39;s why you have the <code>and_call_original</code> method. I guess your higher level test is not exactly the same as the one you have on the question, do you have <code>expect(...).to receive(:update_my_model!)</code> on that test?"}, {"owner": {"reputation": 1326, "user_id": 6092420, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/24e00c77fc8fc5f977da388a142bf9a6?s=128&d=identicon&r=PG&f=1", "display_name": "absolutelydevastated", "link": "https://stackoverflow.com/users/6092420/absolutelydevastated"}, "edited": false, "score": 0, "creation_date": 1568595881, "post_id": 57945070, "comment_id": 102311415, "body": "Yes I do. The higher level function calls the API and returns the JSON results, with a <code>rescue</code> that catches the possible errors that might arise. It also uses <code>receive</code> for <code>update_from_api_response</code> which is called within the function body."}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "reply_to_user": {"reputation": 1326, "user_id": 6092420, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/24e00c77fc8fc5f977da388a142bf9a6?s=128&d=identicon&r=PG&f=1", "display_name": "absolutelydevastated", "link": "https://stackoverflow.com/users/6092420/absolutelydevastated"}, "edited": false, "score": 0, "creation_date": 1568604920, "post_id": 57945070, "comment_id": 102312684, "body": "I insist, show that test you are talking about since you say it&#39;s not the same on the question and you seem to not like the answer but you are not being clear on what does your test really do (you try to explain it, but the actual code will be clear enough)."}], "tags": [], "owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "is_accepted": false, "score": 2, "last_activity_date": 1568557728, "creation_date": 1568557728, "answer_id": 57945070, "question_id": 57943712, "link": "https://stackoverflow.com/questions/57943712/puts-statement-in-function-is-not-executed-function-test-fails-but-receivefu/57945070#57945070", "title": "Puts statement in function is not executed, function test fails, but receive(:function) spec works", "body": "<p>When you call <code>expect(my_model).to receive(:update_from_api_response).with(api_response)</code> it actually overrides the original method and does not call it.</p>\n\n<p>You can call <code>expect(my_model).to receive(:update_from_api_response).with(api_response).and_call_original</code> if you want your original method to be called too.</p>\n\n<p>Anyway, using \"expect to_receive\" and \"and_call_original\" rings some bells for me, it means you are testing two different methods in one test and the tests actually depends on implementation details instead of an input and an output. I would run two different tests: test that \"update_from_api_response\" changes the fields you want, and maybe test that \"update_my_model!\" calls \"update_from_api_response\" and \"save!\" (no need to test the field change, since that would be covered on the \"update_from_api_response\" test).</p>\n"}, {"comments": [{"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 1, "creation_date": 1568604876, "post_id": 57949387, "comment_id": 102312675, "body": "<code>update_from_api_response</code> and <code>update_my_model!</code> does two different things they don&#39;t do the same thing. One calls the other and saves de record inside a transaction. It&#39;s a design decision I guess, maybe he calls <code>update_from_api_response</code> somewhere else too."}], "tags": [], "owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "is_accepted": false, "score": 1, "last_activity_date": 1568607961, "last_edit_date": 1568607961, "creation_date": 1568597056, "answer_id": 57949387, "question_id": 57943712, "link": "https://stackoverflow.com/questions/57943712/puts-statement-in-function-is-not-executed-function-test-fails-but-receivefu/57949387#57949387", "title": "Puts statement in function is not executed, function test fails, but receive(:function) spec works", "body": "<p>Thank you, the separate Github file works wonders.</p>\n\n<h1>This part works fine:</h1>\n\n<p>Put it in a separate expectation and it works fine:</p>\n\n<p><code>\n  describe(\"update_my_model\") do\n    it \"should update db record\" do\n      # This works\n      expect{ my_model.update_my_model!(api_response) }.to change{ my_model.field_one }\n    end\n  end\n</code></p>\n\n<h1>How is it triggered?</h1>\n\n<p>But here is your problem:</p>\n\n<p><code>\n      expect(my_model).to receive(:update_from_api_response).with(api_response)\n      expect(my_model).to receive(:save!)</code></p>\n\n<p>This means that you are expecting my model to have <code>update_from_api_response</code> to be called with the <code>api_response</code> parameter passed in. But what is triggering that? Of course it will fail. I am expecting my engine to start. But unless i take out my car keys, and turn on the ignition, it won't start. But if you are expecting the car engine to start without doing anything at all - then of course it will fail! Please refer to what @arieljuod has mentioned above.</p>\n\n<p>Also why do you have two methods: <code>update_from_api_response</code> and <code>update_my_model!</code> which both do the same thing  - you only need one?</p>\n"}], "owner": {"reputation": 1326, "user_id": 6092420, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/24e00c77fc8fc5f977da388a142bf9a6?s=128&d=identicon&r=PG&f=1", "display_name": "absolutelydevastated", "link": "https://stackoverflow.com/users/6092420/absolutelydevastated"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1568607961, "creation_date": 1568547226, "last_edit_date": 1568557824, "question_id": 57943712, "link": "https://stackoverflow.com/questions/57943712/puts-statement-in-function-is-not-executed-function-test-fails-but-receivefu", "title": "Puts statement in function is not executed, function test fails, but receive(:function) spec works", "body": "<p>In my model definition, I have</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># models/my_model.rb\n\n# == Schema Information\n#\n# Table name: my_models\n#\n#  id               :bigint           not null, primary key\n#  another_model_id :bigint\n#  field_1          :string\n#  field_2          :string\n#  created_at       :datetime         not null\n#  updated_at       :datetime         not null\n#\n# Indexes\n#\n#  index_my_models_on_another_model_id  (another_model_id) UNIQUE\n\nclass MyModel &lt; ApplicationRecord\n\n  belongs_to :another_model\n\n  def update_from_api_response(api_response)\n    $stderr.puts(\"UPDATE\")\n    self.field_1 = api_response[:field_1]\n    self.field_2 = api_response[:field_2]\n  end\n\n  def update_my_model!(api_response)\n    ApplicationRecord.transaction do\n      $stderr.puts(\"HELLO\")\n      update_from_api_response(api_response)\n      $stderr.puts(\"WORLD\")\n      self.save!\n    end\n  end\nend\n\n</code></pre>\n\n<p>I put in some <code>puts</code> statements to check whether my code entered the function. If everything works alright, the program should log \"HELLO\", \"UPDATE\", then \"WORLD\".</p>\n\n<p>In my model spec I have</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># spec/models/my_model_spec.rb\n\nRSpec.describe MyModel, type: :model do\n  let(:my_model) { create(:my_model) }\n  let(:api_response) {\n    {\n      :field_1 =&gt; \"field_1\",\n      :field_2 =&gt; \"field_2\",\n    }\n  }\n\n  describe(\"update_my_model\") do\n    it \"should update db record\" do\n      expect(my_model).to receive(:update_from_api_response)\n          .with(api_response)\n      expect(my_model).to receive(:save!)\n      expect{ my_model.update_my_model!(api_response) }\n        .to change{ my_model.field_1 }\n    end\n  end\nend\n</code></pre>\n\n<p>The factory object for <code>MyModel</code> is defined like this (it literally does not do anything)</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># spec/factories/my_models.rb\n\nFactoryBot.define do\n  factory :my_model do\n\n  end\nend\n</code></pre>\n\n<p>The output from the <code>puts</code> (this appears before the error message)</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>HELLO\nWORLD\n</code></pre>\n\n<p>Interestingly, \"UPDATE\" is not printed, but it passes the <code>receive</code> test.</p>\n\n<p>The <code>change</code> match test fails, and the output from the console is as follows</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>1) MyModel update_my_model should update db record\n     Failure/Error:\n       expect{ my_model.update_my_model(api_response) }\n        .to change{ my_model.field_1 }\n\n       expected `my_model.field_1` to have changed, but is still nil\n     # ./spec/models/my_model_spec.rb\n     # ./spec/rails_helper.rb\n</code></pre>\n\n<p>I suspected that it might have something to do with me wrapping the update within <code>ApplicationRecord.transaction do</code> but removing that does nothing as well. \"UPDATE\" is not printed in both cases.</p>\n\n<p>I've also changed the <code>.to receive(:update_from_api_response)</code> to <code>.to_not receive(:updated_from_api_response)</code> but it throws an error saying that the function was called (but why is \"UPDATE\" not printed then?). Is there something wrong with the way I'm updating my functions? I'm new to Ruby so this whole <code>self</code> syntax and whatnot is unfamiliar and counter-intuitive. I'm not sure if I \"updated\" my model field correctly.</p>\n\n<p>Thanks!</p>\n\n<p>Link to Git repo: <a href=\"https://github.com/jzheng13/rails-tutorial.git\" rel=\"nofollow noreferrer\">https://github.com/jzheng13/rails-tutorial.git</a></p>\n"}, {"tags": ["ruby", "heroku", "procfile"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 11584572, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WrM69zR0HLM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfeydAjLChMu5na42PeokGvBip9hw/mo/photo.jpg?sz=128", "display_name": "ahmet g&#252;l", "link": "https://stackoverflow.com/users/11584572/ahmet-g%c3%bcl"}, "edited": false, "score": 0, "creation_date": 1568729579, "post_id": 57960816, "comment_id": 102362022, "body": "i added worker: ruby -r ./ruby.rb -e &quot;TwitchBot.new.run&quot; true ?"}], "tags": [], "owner": {"reputation": 2262, "user_id": 4101569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c4c64e58bc5cdeec8e7ce067131a54?s=128&d=identicon&r=PG", "display_name": "katafrakt", "link": "https://stackoverflow.com/users/4101569/katafrakt"}, "is_accepted": true, "score": 1, "last_activity_date": 1568650555, "creation_date": 1568650555, "answer_id": 57960816, "question_id": 57943634, "link": "https://stackoverflow.com/questions/57943634/ruby-heroku-how-to-create-procfile/57960816#57960816", "title": "Ruby-Heroku how to create procfile", "body": "<p>You can do the same as you do in pry with a simple one-liner:</p>\n\n<pre><code>ruby -r ./filelocation/app.rb -e \"TwitchBot.new.run\"\n</code></pre>\n\n<p>... and this is something that could go to your <code>Procfile</code>.</p>\n\n<p>However, it might be better to use <code>worker:</code> instead of <code>web:</code>, because otherwise Heroku will assume it's a HTTP server and will accordingly perform some healthchecks, leading to frequent restarts of your app. With <code>worker:</code> it should not.</p>\n"}], "owner": {"reputation": 37, "user_id": 11584572, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WrM69zR0HLM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfeydAjLChMu5na42PeokGvBip9hw/mo/photo.jpg?sz=128", "display_name": "ahmet g&#252;l", "link": "https://stackoverflow.com/users/11584572/ahmet-g%c3%bcl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 57960816, "answer_count": 1, "score": 0, "last_activity_date": 1568650555, "creation_date": 1568546589, "question_id": 57943634, "link": "https://stackoverflow.com/questions/57943634/ruby-heroku-how-to-create-procfile", "title": "Ruby-Heroku how to create procfile", "body": "<p>i am trying heroku for my hobyst app. i deployed my app. but idk what is procfile or anything.</p>\n\n<p>i saw 'web:' like thats things but i didnt.</p>\n\n<p>Im starting my app with pry. have in my gemfile.</p>\n\n<p>my console line:</p>\n\n<pre><code>c:&gt; pry -r ./filelocation/app.rb\n\n[1] pry(main)&gt; bot = TwitchBot.new\n\n[2] pry(main)&gt; bot.run \n</code></pre>\n\n<p>can anyone help me about that. how to be procfile for this console line ? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "http", "faraday"], "answers": [{"tags": [], "owner": {"reputation": 497, "user_id": 2178680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e88b4d85c705c6d6e66f79a13cbd9c4c?s=128&d=identicon&r=PG", "display_name": "Kai Sasaki", "link": "https://stackoverflow.com/users/2178680/kai-sasaki"}, "is_accepted": false, "score": 1, "last_activity_date": 1568531755, "creation_date": 1568531755, "answer_id": 57941956, "question_id": 57941955, "link": "https://stackoverflow.com/questions/57941955/how-to-enable-logging-bodies-in-faraday/57941956#57941956", "title": "How to enable logging bodies in Faraday", "body": "<p>I found a good resource to show how to log the body in Faraday. </p>\n\n<p><a href=\"https://github.com/lostisland/faraday/issues/254\" rel=\"nofollow noreferrer\">https://github.com/lostisland/faraday/issues/254</a></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require \"logger\"\n\nFaraday.new do |faraday|\n  faraday.response :logger, ::Logger.new(STDOUT), bodies: true\nend\n</code></pre>\n"}], "owner": {"reputation": 497, "user_id": 2178680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e88b4d85c705c6d6e66f79a13cbd9c4c?s=128&d=identicon&r=PG", "display_name": "Kai Sasaki", "link": "https://stackoverflow.com/users/2178680/kai-sasaki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 553, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1568531755, "creation_date": 1568531755, "question_id": 57941955, "link": "https://stackoverflow.com/questions/57941955/how-to-enable-logging-bodies-in-faraday", "title": "How to enable logging bodies in Faraday", "body": "<p>How to enable the logging of the request body by Faraday? Especially, I want to know the quick way to dump the body, header to stdout.</p>\n"}, {"tags": ["sql", "ruby", "postgresql", "sequel"], "answers": [{"tags": [], "owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "is_accepted": false, "score": 1, "last_activity_date": 1568529156, "creation_date": 1568529156, "answer_id": 57941710, "question_id": 57941676, "link": "https://stackoverflow.com/questions/57941676/sequel-pgundefinedcolumn-error-column-distance-does-not-exist/57941710#57941710", "title": "Sequel: PG::UndefinedColumn: ERROR: column &quot;distance&quot; does not exist", "body": "<p>The query you are using was poached from MySQL, where select aliases can be used in a <code>HAVING</code> clause.  But in Postgres, you will have to either subquery or just repeat the distance formula.  Using the latter option as an example, here is one viable version of your Haversine query:</p>\n\n<pre><code>SELECT\n    id,\n    ( 3959 * acos( cos( radians(37) ) * cos( radians( lat ) ) * cos( radians( lng ) - radians(?) ) + sin( radians(?) ) * sin( radians( lat ) ) ) ) AS distance\nFROM business\nWHERE\n    ( 3959 * acos( cos( radians(37) ) * cos( radians( lat ) ) * cos( radians( lng ) - radians(?) ) + sin( radians(?) ) * sin( radians( lat ) ) ) )\n    &lt; ?\nORDER BY\n    distance;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "is_accepted": false, "score": 1, "last_activity_date": 1568549424, "creation_date": 1568549424, "answer_id": 57943976, "question_id": 57941676, "link": "https://stackoverflow.com/questions/57941676/sequel-pgundefinedcolumn-error-column-distance-does-not-exist/57943976#57943976", "title": "Sequel: PG::UndefinedColumn: ERROR: column &quot;distance&quot; does not exist", "body": "<p>Postgres supports lateral joins, so you can do this without a subquery or CTE as:</p>\n\n<pre><code>SELECT b.id, v.distance\nFROM business b CROSS JOIN LATERAL\n     (VALUES ( 3959 * acos( cos( radians(37) ) * cos( radians( b.lat ) ) * cos( radians( b.lng ) - radians(?) ) + sin( radians(?) ) * sin( radians( b.lat ) ) )\n             )\n     ) v(distance)\nWHERE v.distance &lt; ?\nORDER BY distance;\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 6236272, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hhY0nzkTnn0/AAAAAAAAAAI/AAAAAAAABbg/Aenni5PO-kM/photo.jpg?sz=128", "display_name": "Reggie Escobar", "link": "https://stackoverflow.com/users/6236272/reggie-escobar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1568549424, "creation_date": 1568528829, "last_edit_date": 1568537397, "question_id": 57941676, "link": "https://stackoverflow.com/questions/57941676/sequel-pgundefinedcolumn-error-column-distance-does-not-exist", "title": "Sequel: PG::UndefinedColumn: ERROR: column &quot;distance&quot; does not exist", "body": "<p>I'm trying to get a list of businesses nearby using this query:</p>\n\n<pre><code>query = \"SELECT id, ( 3959 * acos( cos( radians(37) ) * cos( radians( lat ) ) * cos( radians( lng ) - radians(?) ) + sin( radians(?) ) * sin( radians( lat ) ) ) ) AS distance FROM businesses HAVING distance &lt; ? ORDER BY distance\"\n</code></pre>\n\n<p>After running this:</p>\n\n<pre><code>records = Api.DB.fetch(query, lng, lat, distance)\n</code></pre>\n\n<p>I get that PG::UndefinedColumn: ERROR:  column \"distance\" does not exist.</p>\n\n<p>distance isn't a column in the table but I created it as a calculated column in the query so it suppose to work but it's not?</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 3, "creation_date": 1568526546, "post_id": 57941311, "comment_id": 102297817, "body": "You call <code>my_array</code> from the class scope, while it\u2019s defined on the instance scope."}], "answers": [{"comments": [{"owner": {"reputation": 412, "user_id": 4396154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3ae5a73901587daf99951de0a0962b?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/4396154/rahul"}, "edited": false, "score": 0, "creation_date": 1568528501, "post_id": 57941539, "comment_id": 102298023, "body": "Thanks. You are right this will work. But I need to overwrite the DYNAMIC_METHOD_NAMES when I inherit from this class and use self.inherited to dynamically define methods in child class. Any suggestion on how best to achieve that.  Please see edit 1 in the question description."}], "tags": [], "owner": {"reputation": 862, "user_id": 1600046, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/5rxUl.jpg?s=128&g=1", "display_name": "Vibol", "link": "https://stackoverflow.com/users/1600046/vibol"}, "is_accepted": false, "score": 2, "last_activity_date": 1568527180, "creation_date": 1568527180, "answer_id": 57941539, "question_id": 57941311, "link": "https://stackoverflow.com/questions/57941311/no-method-error-for-class-variable-defined-with-attr-accessor/57941539#57941539", "title": "No method error for class variable defined with attr_accessor", "body": "<p>You need to change <code>my_array</code> to class level accessible, in my case class constant.</p>\n\n<pre><code>class SomeClass\n  DYNAMIC_METHOD_NAMES = %w(method_a method_b method_C).freeze\n\n  def initialize(user, record)\n  end\n\n  DYNAMIC_METHOD_NAMES.each do |element|\n    alias_method \"#{element}?\".to_sym, :awesome_method\n  end\n\n  def awesome_method\n    puts 'awesome'\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 412, "user_id": 4396154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3ae5a73901587daf99951de0a0962b?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/4396154/rahul"}, "edited": false, "score": 0, "creation_date": 1568528597, "post_id": 57941545, "comment_id": 102298033, "body": "Please see Edit 1 of the description. Any suggestions?  Thanks a lot for help :)"}, {"owner": {"reputation": 412, "user_id": 4396154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3ae5a73901587daf99951de0a0962b?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/4396154/rahul"}, "edited": false, "score": 0, "creation_date": 1568533619, "post_id": 57941545, "comment_id": 102298861, "body": "Works beautifully! I have two doubts though for the build! method. 1. Should we do with my_array instead of @my_array since accessor is defined in singleton class? 2. should we use <code>define_method</code> instead of <code>self.define_method</code> ?  If these suggestions are correct please update your answer. I am marking it correct anyway.  Thanks a lot for help !!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6851498"}, "reply_to_user": {"reputation": 412, "user_id": 4396154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3ae5a73901587daf99951de0a0962b?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/4396154/rahul"}, "edited": false, "score": 0, "creation_date": 1568567675, "post_id": 57941545, "comment_id": 102306140, "body": "I think define_method works by invoking the method definition on the current context, which is self, so there is no difference between define_method and self.define_method. I&#39;m not 100% sure about it though."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6851498"}, "reply_to_user": {"reputation": 412, "user_id": 4396154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3ae5a73901587daf99951de0a0962b?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/4396154/rahul"}, "edited": false, "score": 0, "creation_date": 1568567866, "post_id": 57941545, "comment_id": 102306185, "body": "As to \\@my_array vs my_array, when you call &quot;my_array&quot; you are just accessing \\@my_array through the accessor you defined, so there is no difference. I&#39;ve included the accessor because I supposed you wanted to call my_array from outside the class definition (you could change my_array and call ChildClass.build! from the outside). But, if you don&#39;t need this feature, you can left out the accessor code altogether. In this case, you will need to call \\@my_array or you get a NameError exception."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6851498"}, "is_accepted": true, "score": 3, "last_activity_date": 1568564359, "last_edit_date": 1568564359, "creation_date": 1568527236, "answer_id": 57941545, "question_id": 57941311, "link": "https://stackoverflow.com/questions/57941311/no-method-error-for-class-variable-defined-with-attr-accessor/57941545#57941545", "title": "No method error for class variable defined with attr_accessor", "body": "<p>In your code, you use an instance variable (@my_array) and an attr_accessor over it, and then try to access my_array from class level (that is, from the body of the class definition, outside of any methods). But instance variables only exist at instance level, so it is not available in the class scope.</p>\n\n<p>One solution (the natural one, and the one which you would probably use in other languages) is to use a class variable: @@my_array. But class variables in ruby are a little problematic, so the best solution would be to make use of class instance variables, like that:</p>\n\n<pre><code>class SomeClass\n  class &lt;&lt; self\n    attr_accessor :my_array\n  end\n\n  @my_array=[]\n\n  def initialize(user, record)\n  end\n\n  @my_array.each do |element|\n    alias_method \"#{element}?\".to_sym, :awesome_method\n  end\n\n  def awesome_method\n    puts 'awesome'\n  end\n\nend\n</code></pre>\n\n<p>The syntax is a little tricky, so, if you look that up and it still doesn't makes sense, try just reading about scopes and using a regular class variable with @@.</p>\n\n<p>Edit:</p>\n\n<p>Ok, so, after your edit, it became more clear what you are trying to accomplish. A full working example is like follows:</p>\n\n<pre><code>class SomeClass\n  class &lt;&lt; self\n    attr_accessor :my_array\n  end\n\n  @my_array=[]\n\n  def awesome_method\n    puts 'awesome'\n  end\n\n  def self.build!\n    @my_array.each do |element|\n      self.define_method(\"#{element}?\".to_sym){ awesome_method }\n    end\n  end\n\nend\n\nclass ChildClass &lt; SomeClass\n  @my_array = %w[test little_test]\n\n  self.build!\nend\n\nchild_instance = ChildClass.new\n\nchild_instance.test?\n&gt;&gt; awesome\n\nchild_instance.little_test?\n&gt;&gt; awesome\n</code></pre>\n\n<p>So, I've made some tweaks on SomeClass:</p>\n\n<ol>\n<li>It does not need an initialize method</li>\n<li>I tried to use the inherited hook for this problem. It won't ever work, because this hook is called as soon as \"ChildClass &lt; SomeClass\" is written, and this must be before you can define something like @my_array = %w[test little_test]. So, I have added a self.build! method that must be called in the child instances so that they build their methods from my_array. This is inevitable, but I think it is also good, because it makes more explicit in the subclasses that you are doing something interesting there.</li>\n<li>I think you want \"define_method\", not \"alias_method\".</li>\n<li>awesome_method in passed in a block, which is ruby's way of doing functional programming.</li>\n</ol>\n\n<p>With that done, ChildClass inherits from SomeClass, and it's instances have the dynamically created methods 'test?' and 'little_test?'.</p>\n"}], "owner": {"reputation": 412, "user_id": 4396154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3ae5a73901587daf99951de0a0962b?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/4396154/rahul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 444, "favorite_count": 0, "accepted_answer_id": 57941545, "answer_count": 2, "score": 0, "last_activity_date": 1568564359, "creation_date": 1568523952, "last_edit_date": 1568528557, "question_id": 57941311, "link": "https://stackoverflow.com/questions/57941311/no-method-error-for-class-variable-defined-with-attr-accessor", "title": "No method error for class variable defined with attr_accessor", "body": "<p>I want to define methods dynamically using an array of strings. </p>\n\n<p>Here is a simple piece of code that should achieve that. </p>\n\n<pre><code>\nclass SomeClass\n  attr_accessor :my_array\n\n  def initialize(user, record)\n    @my_array=[]\n  end\n\n  my_array.each do |element|\n    alias_method \"#{element}?\".to_sym, :awesome_method\n  end\n\n  def awesome_method\n    puts 'awesome'\n  end\n\nend\n\n</code></pre>\n\n<p>When I instantiate this class in the console, I get the following error</p>\n\n<p><strong>NoMethodError (undefined method `each' for nil:NilClass)</strong></p>\n\n<p>What is wrong with this code and how to make it work. any help highly appreciated :)</p>\n\n<p>Edit 1: \nWhat I ultimately want to achieve is to inherit from SomeClass and override my_array in the child class to dynamically define methods with its attributes like so</p>\n\n<pre><code>class OtherClass &lt; SomeClass\n\n  my_array = %w[method1 method2 method3] \n  # Some mechanism to over write my_array. \n\nend\n</code></pre>\n\n<p>And then use <code>self.inherited</code> to dynamically define methods in child class. </p>\n\n<p>Is there a good way to achieve this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 2930, "user_id": 6733101, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6c42f9383bf6b2b5fd7f8796576ba71f?s=128&d=identicon&r=PG&f=1", "display_name": "Serenity", "link": "https://stackoverflow.com/users/6733101/serenity"}, "edited": false, "score": 0, "creation_date": 1568522601, "post_id": 57941206, "comment_id": 102297320, "body": "i get error ActiveRecord::StatementInvalid: PG::InvalidTextRepresentation: ERROR:  invalid input syntax for integer: &quot;select distinct id from company_histories where year &lt;= 2009&quot;"}, {"owner": {"reputation": 1172, "user_id": 2667601, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/7057c99ddbaf71c306a876af6bc30ad4?s=128&d=identicon&r=PG", "display_name": "empr", "link": "https://stackoverflow.com/users/2667601/empr"}, "reply_to_user": {"reputation": 2930, "user_id": 6733101, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6c42f9383bf6b2b5fd7f8796576ba71f?s=128&d=identicon&r=PG&f=1", "display_name": "Serenity", "link": "https://stackoverflow.com/users/6733101/serenity"}, "edited": false, "score": 1, "creation_date": 1568522742, "post_id": 57941206, "comment_id": 102297341, "body": "@Serenity Sorry, edited the answer. Please try it now."}, {"owner": {"reputation": 2930, "user_id": 6733101, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6c42f9383bf6b2b5fd7f8796576ba71f?s=128&d=identicon&r=PG&f=1", "display_name": "Serenity", "link": "https://stackoverflow.com/users/6733101/serenity"}, "edited": false, "score": 0, "creation_date": 1568522829, "post_id": 57941206, "comment_id": 102297353, "body": "does this count the company&#39;s revenue of same year? I mean if there is multiple revenue in same year, then will it count just 1 or 2?"}, {"owner": {"reputation": 1172, "user_id": 2667601, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/7057c99ddbaf71c306a876af6bc30ad4?s=128&d=identicon&r=PG", "display_name": "empr", "link": "https://stackoverflow.com/users/2667601/empr"}, "reply_to_user": {"reputation": 2930, "user_id": 6733101, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6c42f9383bf6b2b5fd7f8796576ba71f?s=128&d=identicon&r=PG&f=1", "display_name": "Serenity", "link": "https://stackoverflow.com/users/6733101/serenity"}, "edited": false, "score": 0, "creation_date": 1568522987, "post_id": 57941206, "comment_id": 102297375, "body": "@Serenity It will be 1. Also it will get distinct count across year."}, {"owner": {"reputation": 2930, "user_id": 6733101, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6c42f9383bf6b2b5fd7f8796576ba71f?s=128&d=identicon&r=PG&f=1", "display_name": "Serenity", "link": "https://stackoverflow.com/users/6733101/serenity"}, "edited": false, "score": 0, "creation_date": 1568523255, "post_id": 57941206, "comment_id": 102297419, "body": "Thanks a lot for your help. can you make me a bit clear on year &lt;= part, please? if i want companies with &lt;10 years revenue data then should it be year &gt;=? sorry i did not understand year part."}, {"owner": {"reputation": 2930, "user_id": 6733101, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6c42f9383bf6b2b5fd7f8796576ba71f?s=128&d=identicon&r=PG&f=1", "display_name": "Serenity", "link": "https://stackoverflow.com/users/6733101/serenity"}, "edited": false, "score": 1, "creation_date": 1568525983, "post_id": 57941206, "comment_id": 102297752, "body": "yeah i saw sql query where it is showing year &lt;= 2009. I will now search for how can i use #{10.years.ago.year} in plain sql as well. Thanks a lot for your help"}], "tags": [], "owner": {"reputation": 1172, "user_id": 2667601, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/7057c99ddbaf71c306a876af6bc30ad4?s=128&d=identicon&r=PG", "display_name": "empr", "link": "https://stackoverflow.com/users/2667601/empr"}, "is_accepted": true, "score": 4, "last_activity_date": 1568523782, "last_edit_date": 1568523782, "creation_date": 1568522497, "answer_id": 57941206, "question_id": 57940948, "link": "https://stackoverflow.com/questions/57940948/find-the-company-which-has-more-than-10-years-of-revenue/57941206#57941206", "title": "find the company which has more than 10 years of revenue", "body": "<p>You could try sub query like below.</p>\n\n<pre><code>CompanyHistory.where(\"revenue &gt; 0 AND id in (select distinct id from company_histories where year &lt;= #{10.years.ago.year})\").distinct('company_id').count\n</code></pre>\n\n<p>If you need to get &lt; 10 years, you need to use following one</p>\n\n<pre><code>CompanyHistory.where(\"revenue &gt; 0 AND id in (select distinct id from company_histories where year &gt; #{10.years.ago.year})\").distinct('company_id').count\n</code></pre>\n\n<p>You can get more idea when you just copy paste the above statements in Rails console where you can see the exact SQL query executed.</p>\n\n<p>I just used the current year for getting the data you have mentioned. Get distinct ids which have 10+ years revenue using sub query, using these ids do another query to get desired output. But these queries will be run one DB request though we used two queries.</p>\n"}], "owner": {"reputation": 2930, "user_id": 6733101, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6c42f9383bf6b2b5fd7f8796576ba71f?s=128&d=identicon&r=PG&f=1", "display_name": "Serenity", "link": "https://stackoverflow.com/users/6733101/serenity"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 57941206, "answer_count": 1, "score": 0, "last_activity_date": 1568523782, "creation_date": 1568518528, "last_edit_date": 1568519453, "question_id": 57940948, "link": "https://stackoverflow.com/questions/57940948/find-the-company-which-has-more-than-10-years-of-revenue", "title": "find the company which has more than 10 years of revenue", "body": "<p>I have a table Company and CompanyHistory. CompanyHistory shows the revenue and year. The relation between company and company history is </p>\n\n<p>A company has many company histories while company history belongs to company.</p>\n\n<p>I need to find a number of companies who has revenue of more than 10 years. I could find only companies with revenue data with following query</p>\n\n<pre><code>CompanyHistory.where.not(revenue: 0).pluck(:company_id).uniq.count\n</code></pre>\n\n<p>How can i find based on year? I mean only those Companies with 10+ years of revenues data. </p>\n\n<p>CompanyHistory has certain field</p>\n\n<pre><code>CompanyHistory(id: integer, company_id: integer, revenue: float, year: integer, month: integer, date: date, created_at: datetime, updated_at: datetime)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1568523316, "creation_date": 1568523316, "answer_id": 57941262, "question_id": 57940344, "link": "https://stackoverflow.com/questions/57940344/minimagick-error-how-to-generate-og-image-with-minimagick/57941262#57941262", "title": "MiniMagick Error: How to generate OG image with MiniMagick", "body": "<p>You should put the text into quotes, otherwise, the shell that is, in turn, executing the command, treats \u201cHello\u201d and \u201cworld!\u201d as two different arguments in call to <code>mogrify</code>:</p>\n\n<pre><code>#                                               \u21d3       \u21d3\nconfig.draw \"text #{Settings.ogb.text_position} '#{text}'\"\n</code></pre>\n"}], "owner": {"reputation": 601, "user_id": 9315566, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pnkVEz0JwTw/AAAAAAAAAAI/AAAAAAAAASo/NlxvDhY5hi0/photo.jpg?sz=128", "display_name": "Shun Yamada", "link": "https://stackoverflow.com/users/9315566/shun-yamada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 57941262, "answer_count": 1, "score": 0, "last_activity_date": 1568523316, "creation_date": 1568508842, "question_id": 57940344, "link": "https://stackoverflow.com/questions/57940344/minimagick-error-how-to-generate-og-image-with-minimagick", "title": "MiniMagick Error: How to generate OG image with MiniMagick", "body": "<p>So I'm working on a Rails application. It generates OG image drawn to text a user inputs. For example, you input \"Hello world\", save it, and then an application generates an OG image written to \"Hello world\".</p>\n\n<p>But it occurs to this error:\n<img src=\"https://i.gyazo.com/980add6632e2ffaa0623fd142d79e423.png\" alt=\"\"></p>\n\n<p><em>apps/controllers/reviews_controller.rb</em></p>\n\n<pre><code>include SetupOgbImage\n\ndef create\n  @review = current_user.active_reviews.create(create_params)\n  @review.image = build(@review.content)\n  if @review.save\n    flash[:success] = \"Successfully added a review!\"\n    redirect_to review_path(id: @review.id)\n  else\n    flash[:alert] = \"Failed to add a review.\"\n    redirect_to user_path(id: @review.reviewed_id)\n  end\nend\n</code></pre>\n\n<p><em>apps/controllers/concerns/setup_ogb_image.rb</em></p>\n\n<pre><code>module SetupOgbImage\n    def build(text)\n        text = prepare_text(text)\n        img = MiniMagick::Image.open(Settings.ogb.base_image_path)\n        img.combine_options do |config|\n        config.font Settings.ogb.font_path\n        config.fill Settings.ogb.color\n        config.gravity Settings.ogb.gravity\n        config.pointsize Settings.ogb.font_size\n        config.draw \"text #{Settings.ogb.text_position} #{text}\"\n        end\n        img\n    end\n\n    def prepare_text(text)\n        text.scan(/.{1,#{Settings.ogb.indention_count}}/)[0...Settings.ogb.row_limit].join(\"\\n\")\n    end\nend\n</code></pre>\n\n<p><em>settings.yml</em></p>\n\n<pre><code>ogb:\n  base_image_path: ./app/assets/images/ogb_bg_image.png\n  gravity: center\n  text_position: \"0,30\"\n  font_path: ./app/assets/fonts/Hind-Medium.ttf\n  font_size: 24\n  color: \"#fff\"\n  indention_count: 60\n  row_limit: 10\nformat:\n  uuid: !ruby/regexp /\\A[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}\\z/\n</code></pre>\n"}, {"tags": ["ruby", "gitlab", "rack", "unicorn"], "comments": [{"owner": {"reputation": 4688, "user_id": 6241184, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1022848011119215/picture?type=large", "display_name": "Vinicius Brasil", "link": "https://stackoverflow.com/users/6241184/vinicius-brasil"}, "edited": false, "score": 1, "creation_date": 1568507960, "post_id": 57940276, "comment_id": 102295662, "body": "Maybe this commit can explain something? It seems to be just code that should be removed, but it weren&#39;t <a href=\"https://gitlab.com/gitlab-org/gitlab-foss/commit/be150fa9913d760802dc4c673ed59930f03ffec0\" rel=\"nofollow noreferrer\">gitlab.com/gitlab-org/gitlab-foss/commit/&hellip;</a>"}, {"owner": {"reputation": 2267, "user_id": 2143275, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMJGg.png?s=128&g=1", "display_name": "Richie Thomas", "link": "https://stackoverflow.com/users/2143275/richie-thomas"}, "reply_to_user": {"reputation": 4688, "user_id": 6241184, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1022848011119215/picture?type=large", "display_name": "Vinicius Brasil", "link": "https://stackoverflow.com/users/6241184/vinicius-brasil"}, "edited": false, "score": 0, "creation_date": 1568508109, "post_id": 57940276, "comment_id": 102295680, "body": "@ViniciusBrasil thanks, I updated my question to reflect that commit.  You might be right, that <code>require</code> statement could be crufty.  I know that if a library&#39;s code has already been <code>require</code>&#39;ed previously, an identical <code>require</code> statement would return <code>false</code>, so I suppose it could easily go unnoticed."}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 1, "creation_date": 1568621710, "post_id": 57940276, "comment_id": 102317742, "body": "The project itself could have a file like <code>unicorn.rb</code> which would include unicorn specific extensions. The project&#39;s lib is first in load path, so <code>lib&#47;unicorn.rb</code> would be loaded when <code>Unicorn</code> constant is defined. Yeah it doesn&#39;t make much sense."}], "owner": {"reputation": 2267, "user_id": 2143275, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMJGg.png?s=128&g=1", "display_name": "Richie Thomas", "link": "https://stackoverflow.com/users/2143275/richie-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1568508003, "creation_date": 1568507774, "last_edit_date": 1568508003, "question_id": 57940276, "link": "https://stackoverflow.com/questions/57940276/in-gitlabs-config-ru-why-require-unicorn-if-its-already-defined", "title": "In Gitlab&#39;s &quot;config.ru&quot;, why &quot;require &#39;unicorn&#39;&quot; if it&#39;s already defined?", "body": "<p>I'm doing a deep-dive into how Gitlab's web application works, and I'm starting by looking at the webserver it uses (Unicorn).  The <code>config.ru</code> <a href=\"https://gitlab.com/gitlab-org/gitlab-foss/blob/master/config.ru\" rel=\"nofollow noreferrer\">file</a> looks like the following:</p>\n\n<pre><code>if defined?(Unicorn)\n  require 'unicorn'\n\n  if ENV['RAILS_ENV'] == 'production' || ENV['RAILS_ENV'] == 'staging'\n    # Unicorn self-process killer\n    require 'unicorn/worker_killer'\n\n    min = (ENV['GITLAB_UNICORN_MEMORY_MIN'] || 400 * 1 &lt;&lt; 20).to_i\n    max = (ENV['GITLAB_UNICORN_MEMORY_MAX'] || 650 * 1 &lt;&lt; 20).to_i\n\n    # Max memory size (RSS) per worker\n    use Unicorn::WorkerKiller::Oom, min, max\n  end\nend\n</code></pre>\n\n<p>My question is, if the Unicorn constant is already defined, doesn't that mean the subsequent <code>require</code> statement is redundant?  I could see this logic making sense if <code>if</code> was changed to <code>unless</code>, but otherwise I must be missing something.</p>\n\n<p>I checked the previous commits for this file, and prior to this change, the file looked like the following:</p>\n\n<pre><code># This file is used by Rack-based servers to start the application.\n\nunless defined?(PhusionPassenger)\n  # Unicorn self-process killer\n  require 'unicorn/worker_killer'\n\n  # Max memory size (RSS) per worker\n  use Unicorn::WorkerKiller::Oom, (200 * (1 &lt;&lt; 20)), (250 * (1 &lt;&lt; 20))\nend\n\nrequire ::File.expand_path('../config/environment',  __FILE__)\n\nmap ENV['RAILS_RELATIVE_URL_ROOT'] || \"/\" do\n  run Gitlab::Application\nend\n</code></pre>\n\n<p>From the commit which introduced the <code>if defined?(Unicorn)</code> and the <code>require</code> statement, I understand that the <code>if</code> check was introduced as a replacement to <code>unless defined?(PhusionPassenger)</code>, because there are many other Rack webservers out there besides Unicorn.  But that doesn't clarify why the subsequent <code>require</code> statement was introduced.</p>\n"}]