[{"tags": ["ruby-on-rails", "ruby", "e-commerce", "spree"], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 8588771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d550969cf4321be9d958aff98b94e6f6?s=128&d=identicon&r=PG&f=1", "display_name": "user8588771", "link": "https://stackoverflow.com/users/8588771/user8588771"}, "edited": false, "score": 0, "creation_date": 1529969858, "post_id": 50959092, "comment_id": 89058389, "body": "Thanks for the reply. I get an undefined method for products error."}, {"owner": {"reputation": 81, "user_id": 8588771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d550969cf4321be9d958aff98b94e6f6?s=128&d=identicon&r=PG&f=1", "display_name": "user8588771", "link": "https://stackoverflow.com/users/8588771/user8588771"}, "edited": false, "score": 0, "creation_date": 1529970302, "post_id": 50959092, "comment_id": 89058469, "body": "I have found this but not sure how to apply: <a href=\"https://www.rubydoc.info/gems/spree_core/1.0.3/Spree/Taxon#active_products-instance_method\" rel=\"nofollow noreferrer\">rubydoc.info/gems/spree_core/1.0.3/Spree/&hellip;</a>"}], "tags": [], "owner": {"reputation": 714, "user_id": 2721332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f613d619067de58f480eb6304f0f390?s=128&d=identicon&r=PG&f=1", "display_name": "seethrough", "link": "https://stackoverflow.com/users/2721332/seethrough"}, "is_accepted": false, "score": 0, "last_activity_date": 1529544092, "creation_date": 1529544092, "answer_id": 50959092, "question_id": 50958529, "link": "https://stackoverflow.com/questions/50958529/spree-commerce-number-of-products-in-a-taxon-ruby-on-rails/50959092#50959092", "title": "Spree Commerce Number of Products in a Taxon | Ruby on Rails", "body": "<p>The following should work for you:</p>\n\n<pre><code>Spree::Taxon.where(name: 't-shirts').products.count\n</code></pre>\n\n<p>and let me know if you have problem with it. </p>\n"}, {"tags": [], "owner": {"reputation": 3493, "user_id": 1323481, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4825c6c1cdfd05c2af6fb8db0d492f73?s=128&d=identicon&r=PG", "display_name": "StandardNerd", "link": "https://stackoverflow.com/users/1323481/standardnerd"}, "is_accepted": false, "score": 0, "last_activity_date": 1564641198, "last_edit_date": 1564641198, "creation_date": 1564566833, "answer_id": 57288010, "question_id": 50958529, "link": "https://stackoverflow.com/questions/50958529/spree-commerce-number-of-products-in-a-taxon-ruby-on-rails/57288010#57288010", "title": "Spree Commerce Number of Products in a Taxon | Ruby on Rails", "body": "<p>You can first find the <code>Taxon</code> with the name \"t-shirts\" then count the number of products associated with that taxon. This code, or something similar should do it:</p>\n\n<pre><code>Spree::Taxon.where(name: 't-shirts').first.products.count\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 8588771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d550969cf4321be9d958aff98b94e6f6?s=128&d=identicon&r=PG&f=1", "display_name": "user8588771", "link": "https://stackoverflow.com/users/8588771/user8588771"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1564641198, "creation_date": 1529538404, "question_id": 50958529, "link": "https://stackoverflow.com/questions/50958529/spree-commerce-number-of-products-in-a-taxon-ruby-on-rails", "title": "Spree Commerce Number of Products in a Taxon | Ruby on Rails", "body": "<p>I'm new to spree commerce and doing come customizations. </p>\n\n<p>I have some category Taxons displaying on the homepage (i.e. T-Shirts). I want to be able to display the count for the number of products in this category (i.e. T-Shirts, 20 products).</p>\n\n<p>From the documentation, I believe this should work:</p>\n\n<p><code>&lt;%= Spree::Product.taxons_name_eq(\"t-shirts\").all.count %&gt; PRODUCTS</code></p>\n\n<p>But I just get {} Products as an output.</p>\n\n<p>Can anyone help with this?</p>\n"}, {"tags": ["ruby", "caching", "cron", "rubygems"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1529549241, "post_id": 50958428, "comment_id": 88916377, "body": "<code>persisting data in a file would require me to hardcode the file&#39;s location </code> not necessarily, you could have that be configured by the user of the gem"}, {"owner": {"reputation": 340, "user_id": 6855759, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3UfK3V6lnPY/AAAAAAAAAAI/AAAAAAAAAlU/CG1lontACf0/photo.jpg?sz=128", "display_name": "Caleb Keene", "link": "https://stackoverflow.com/users/6855759/caleb-keene"}, "edited": false, "score": 0, "creation_date": 1529549703, "post_id": 50958428, "comment_id": 88916457, "body": "well you&#39;re going to need some kind of data-store, whether it&#39;s a <code>redis</code> key-value store, a relational database, a NOSQL db (like <code>mongoid</code>), or just putting the stuff into a file. It&#39;s <i>local storage</i> so you&#39;ve got no choice but to access the local filesystem. You could just use a <code>tmp</code> directory within the gem root <code>&quot;#{Dir.pwd}&#47;tmp&#47;data_file_for_cron_to_overwrite&quot;</code> and have have cron write or append to that"}, {"owner": {"reputation": 1, "user_id": 7692425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7458ce240886e0d19861d5ec0fb127?s=128&d=identicon&r=PG", "display_name": "Ewa Lipinska", "link": "https://stackoverflow.com/users/7692425/ewa-lipinska"}, "edited": false, "score": 0, "creation_date": 1529571060, "post_id": 50958428, "comment_id": 88925058, "body": "If I get the user to configure the file&#39;s location in their app, then using cron to run the gem&#39;s cli  command (fetch_rates) will still use the default location - unless there&#39;s a way to get it to know the user&#39;s configuration? Using Dir.pwd works fine if I use irb/run cli commands from the gem&#39;s folder, but the moment I change directory it will (understandably) want to save to a new path."}], "owner": {"reputation": 1, "user_id": 7692425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c7458ce240886e0d19861d5ec0fb127?s=128&d=identicon&r=PG", "display_name": "Ewa Lipinska", "link": "https://stackoverflow.com/users/7692425/ewa-lipinska"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529537475, "creation_date": 1529537475, "question_id": 50958428, "link": "https://stackoverflow.com/questions/50958428/caching-data-from-external-source-in-a-ruby-gem", "title": "Caching data from external source in a Ruby gem", "body": "<p>I'm building a Ruby gem which uses an external data source (XML file) to retrieve values it then does some calculations on. The spec I need to follow states that the data should be prefetched and stored locally. The gem should also allow a scheduler (e.g. cron) to update the data at specific intervals.</p>\n\n<p>I wonder if there's a straightforward way of achieving this - a database seems like an overkill, but persisting data in a file would require me to hardcode the file's location which doesn't seem like a good idea (<a href=\"https://stackoverflow.com/questions/40419913/how-to-persist-data-in-a-ruby-gem\">here</a> and <a href=\"https://www.reddit.com/r/ruby/comments/3z9aj1/best_approach_to_store_gems_temporary_files_cache/\" rel=\"nofollow noreferrer\">here</a>).</p>\n\n<p>I suppose one option would be to allow the user to use a custom store and then create a rake task fetching the data which could be executed by a scheduler, but I wonder if there's a way of including this functionality in the gem itself.</p>\n\n<p>Here's a link to my repo: <a href=\"https://github.com/elipinska/exchange-rate\" rel=\"nofollow noreferrer\">https://github.com/elipinska/exchange-rate</a></p>\n\n<p>Any suggestions welcome!</p>\n"}, {"tags": ["javascript", "html", "ruby", "sinatra", "slim-lang"], "comments": [{"owner": {"reputation": 4217, "user_id": 9029328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r3hFz.png?s=128&g=1", "display_name": "AuxTaco", "link": "https://stackoverflow.com/users/9029328/auxtaco"}, "edited": false, "score": 0, "creation_date": 1529541950, "post_id": 50958348, "comment_id": 88915006, "body": "How are you getting the Ruby string into the <code>&lt;script&gt;</code> tag? <a href=\"https://www.rubydoc.info/gems/slim#Output_without_HTML_escaping___\" rel=\"nofollow noreferrer\">Is this what you&#39;re looking for?</a>"}, {"owner": {"reputation": 340, "user_id": 6855759, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3UfK3V6lnPY/AAAAAAAAAAI/AAAAAAAAAlU/CG1lontACf0/photo.jpg?sz=128", "display_name": "Caleb Keene", "link": "https://stackoverflow.com/users/6855759/caleb-keene"}, "edited": false, "score": 0, "creation_date": 1529549409, "post_id": 50958348, "comment_id": 88916407, "body": "post more details of your code"}], "answers": [{"tags": [], "owner": {"reputation": 77, "user_id": 6268217, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IShsh.jpg?s=128&g=1", "display_name": "arnoldtm", "link": "https://stackoverflow.com/users/6268217/arnoldtm"}, "is_accepted": false, "score": 0, "last_activity_date": 1529875122, "creation_date": 1529875122, "answer_id": 51014042, "question_id": 50958348, "link": "https://stackoverflow.com/questions/50958348/encode-decode-json-object-for-javascript/51014042#51014042", "title": "Encode/Decode JSON object for Javascript", "body": "<p>Answer by @rael-gugelmin-cunha on \n<a href=\"https://stackoverflow.com/questions/17794403/ruby-inside-javascript-block-slim-template\">ruby inside javascript block [slim template]</a></p>\n\n<p>Use double curly braces i.e <code>#{{@gtaglist}}</code> instead of <code>#{@gtaglist}</code></p>\n"}], "owner": {"reputation": 77, "user_id": 6268217, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IShsh.jpg?s=128&g=1", "display_name": "arnoldtm", "link": "https://stackoverflow.com/users/6268217/arnoldtm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529875122, "creation_date": 1529536846, "question_id": 50958348, "link": "https://stackoverflow.com/questions/50958348/encode-decode-json-object-for-javascript", "title": "Encode/Decode JSON object for Javascript", "body": "<p>I have an array <strong>@gtaglist</strong> created with Ruby that has been converted to a JSON object using <strong>@gtaglist.to_json</strong> giving</p>\n\n<pre><code>{\"id\":28,\"name\":\"Rome Catacombs Tour\"},{\"id\":31,\"name\":\"Baroque Churches Tour\"},{\"id\":27,\"name\":\"Borghese Gallery Tour\"}\n</code></pre>\n\n<p>I am substituting the value of the Ruby JSON object i.e <code>#{@gtaglist}</code> into a string in a Javascript tag statement and obtaining the following</p>\n\n<pre><code>gtag('event', 'view_item_list', {\n    \"items\": {&amp;quot;id&amp;quot;:28,&amp;quot;name&amp;quot;:&amp;quot;Rome Catacombs Tour&amp;quot;},{&amp;quot;id&amp;quot;:31,&amp;quot;name&amp;quot;:&amp;quot;Baroque Churches Tour&amp;quot;},{&amp;quot;id&amp;quot;:36,&amp;quot;name&amp;quot;:&amp;quot;Sts Peter &amp;amp; Paul Tour&amp;quot;}\n    });\n</code></pre>\n\n<p>How do I replace the <strong><code>&amp;quot;</code></strong> with \"</p>\n\n<p>Using Ruby 2.4.3, Sinatra and Slim </p>\n"}, {"tags": ["ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 102358, "user_id": 15245, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9a2a53db8e9b4476038c94a64b32833f?s=128&d=identicon&r=PG", "display_name": "Ryan Bigg", "link": "https://stackoverflow.com/users/15245/ryan-bigg"}, "edited": false, "score": 0, "creation_date": 1529534894, "post_id": 50958015, "comment_id": 88913520, "body": "Hi! Could you please include the tinkering that you&#39;ve done with your gemfile and the commands that you&#39;ve been running with RVM? And any errors that you&#39;re seeing too would be helpful!"}, {"owner": {"reputation": 11, "user_id": 9970078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bcd0ba201ce1caef3f294fd30ab28ce?s=128&d=identicon&r=PG&f=1", "display_name": "briannarelucio", "link": "https://stackoverflow.com/users/9970078/briannarelucio"}, "reply_to_user": {"reputation": 102358, "user_id": 15245, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9a2a53db8e9b4476038c94a64b32833f?s=128&d=identicon&r=PG", "display_name": "Ryan Bigg", "link": "https://stackoverflow.com/users/15245/ryan-bigg"}, "edited": false, "score": 0, "creation_date": 1529537369, "post_id": 50958015, "comment_id": 88914044, "body": "@RyanBigg updated!"}], "answers": [{"comments": [{"owner": {"reputation": 311, "user_id": 5982027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bq6xm.jpg?s=128&g=1", "display_name": "Justine M.", "link": "https://stackoverflow.com/users/5982027/justine-m"}, "edited": false, "score": 0, "creation_date": 1586055265, "post_id": 50960680, "comment_id": 107983288, "body": "Bundle update worked. Did not need to downgrade. Thank you!"}], "tags": [], "owner": {"reputation": 2471, "user_id": 8063597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41fe33a379a7894b9246569a6e0396aa?s=128&d=identicon&r=PG&f=1", "display_name": "Rohan", "link": "https://stackoverflow.com/users/8063597/rohan"}, "is_accepted": false, "score": 1, "last_activity_date": 1529557260, "creation_date": 1529557260, "answer_id": 50960680, "question_id": 50958015, "link": "https://stackoverflow.com/questions/50958015/downgrading-ruby-version-for-my-rails-app/50960680#50960680", "title": "Downgrading Ruby Version for my Rails App", "body": "<p>As per the description and logs shared it seems like you have changed the ruby version but haven't build the gemset over the modified version.</p>\n\n<p>Below mentioned log trail implies that it could not find the bundler for the specific ruby version(2.4.0)</p>\n\n<pre><code>/Users/brianna/.rvm/rubies/ruby-2.4.0/lib/ruby/site_ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require': cannot load such file -- bundler (LoadError)\n</code></pre>\n\n<p>Try following steps: </p>\n\n<p>1) Install bundler corresponding to ruby 2.4.0 using</p>\n\n<pre><code>gem install bundler\n</code></pre>\n\n<p>2) Now, either delete the Gemfile.lock and run the following command:</p>\n\n<pre><code>bundle install\n</code></pre>\n\n<p>Or try running</p>\n\n<pre><code>bundle update\n</code></pre>\n\n<p>3) Note that if there are any gems specified with a specific version that are compatible with ruby >=2.5, then you may have to either remove the version number of specify the version which is compatible with ruby 2.4.0</p>\n\n<p>Hope it helps!!</p>\n"}, {"tags": [], "owner": {"reputation": 1224, "user_id": 1554616, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/mr58T.jpg?s=128&g=1", "display_name": "Sandeep Garg", "link": "https://stackoverflow.com/users/1554616/sandeep-garg"}, "is_accepted": false, "score": 0, "last_activity_date": 1529576587, "creation_date": 1529576587, "answer_id": 50966154, "question_id": 50958015, "link": "https://stackoverflow.com/questions/50958015/downgrading-ruby-version-for-my-rails-app/50966154#50966154", "title": "Downgrading Ruby Version for my Rails App", "body": "<p>You are trying to instal Nokogiri gem which required that you first install some dependent libraries and build on your local machine some time. In order to do so you may follow following guide to install nokogiri.</p>\n\n<p><a href=\"http://www.nokogiri.org/tutorials/installing_nokogiri.html\" rel=\"nofollow noreferrer\">Nokogiri Installation</a></p>\n\n<p>Sometime it become typical to install nokogiri on some Enviornment</p>\n"}], "owner": {"reputation": 11, "user_id": 9970078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bcd0ba201ce1caef3f294fd30ab28ce?s=128&d=identicon&r=PG&f=1", "display_name": "briannarelucio", "link": "https://stackoverflow.com/users/9970078/briannarelucio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1185, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1529602655, "creation_date": 1529534313, "last_edit_date": 1529602655, "question_id": 50958015, "link": "https://stackoverflow.com/questions/50958015/downgrading-ruby-version-for-my-rails-app", "title": "Downgrading Ruby Version for my Rails App", "body": "<p>I'm trying to deploy my app 'project'. It's written in Ruby using Rails and it says I need to downgrade Ruby from 2.5.1 to 2.4.0. I've tried a mix of tinkering with my Gemfile and some RVM commands in my Terminal but nothing seems to work. SOS pls send help!</p>\n\n<p>I changed the ruby v in the Gemfile to \"2.4.0\" and when I enter the directory it notifies me that:</p>\n\n<pre><code>Using: /Users/me/.rvm/gems/ruby-2.4.0@rails3\n</code></pre>\n\n<p>Then I tried to run \"rails s\" and receive: </p>\n\n<pre><code>Ignoring nokogiri-1.8.3 because its extensions are not built.  Try: gem pristine nokogiri --version 1.8.3\n/Users/me/.rvm/gems/ruby-2.4.0@rails3/gems/railties-5.2.0/lib/rails/app_loader.rb:53: warning: Insecure world writable dir /usr/local/bin in PATH, mode 040777\nIgnoring bcrypt-3.1.12 because its extensions are not built.  Try: gem pristine bcrypt --version 3.1.12\nIgnoring bindex-0.5.0 because its extensions are not built.  Try: gem pristine bindex --version 0.5.0\nIgnoring bootsnap-1.3.0 because its extensions are not built.  Try: gem pristine bootsnap --version 1.3.0\nIgnoring byebug-10.0.2 because its extensions are not built.  Try: gem pristine byebug --version 10.0.2\nIgnoring ffi-1.9.25 because its extensions are not built.  Try: gem pristine ffi --version 1.9.25\nIgnoring msgpack-1.2.4 because its extensions are not built.  Try: gem pristine msgpack --version 1.2.4\nIgnoring nio4r-2.3.1 because its extensions are not built.  Try: gem pristine nio4r --version 2.3.1\nIgnoring nokogiri-1.8.3 because its extensions are not built.  Try: gem pristine nokogiri --version 1.8.3\nIgnoring puma-3.11.4 because its extensions are not built.  Try: gem pristine puma --version 3.11.4\nIgnoring sqlite3-1.3.13 because its extensions are not built.  Try: gem pristine sqlite3 --version 1.3.13\nIgnoring websocket-driver-0.7.0 because its extensions are not built.  Try: gem pristine websocket-driver --version 0.7.0\n/Users/brianna/.rvm/rubies/ruby-2.4.0/lib/ruby/site_ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require': cannot load such file -- bundler (LoadError)\n    from /Users/me/.rvm/rubies/ruby-2.4.0/lib/ruby/site_ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from /Users/me/proj/bin/spring:8:in `&lt;top (required)&gt;'\n    from bin/rails:3:in `load'\n    from bin/rails:3:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "model", "unique"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9969996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9a6599d4f172b439581c4d3b7622722?s=128&d=identicon&r=PG&f=1", "display_name": "JJaloudi", "link": "https://stackoverflow.com/users/9969996/jjaloudi"}, "edited": false, "score": 0, "creation_date": 1529535269, "post_id": 50958050, "comment_id": 88913598, "body": "Okay, so after adjusting the migration surrounding the attributes of the roast_receiver &amp; roast_creator, your solution worked! Thank you! I had initially tried this solution, but was met with the error I just solved. If anyone encounters an attribute name error, simply add _id to the end of the attributes in your migration file related to the error!"}, {"owner": {"reputation": 102358, "user_id": 15245, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9a2a53db8e9b4476038c94a64b32833f?s=128&d=identicon&r=PG", "display_name": "Ryan Bigg", "link": "https://stackoverflow.com/users/15245/ryan-bigg"}, "reply_to_user": {"reputation": 23, "user_id": 9969996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9a6599d4f172b439581c4d3b7622722?s=128&d=identicon&r=PG&f=1", "display_name": "JJaloudi", "link": "https://stackoverflow.com/users/9969996/jjaloudi"}, "edited": false, "score": 0, "creation_date": 1529535569, "post_id": 50958050, "comment_id": 88913661, "body": "If this fixes your problem, please remember to upvote and mark this answer as the accepted one."}], "tags": [], "owner": {"reputation": 102358, "user_id": 15245, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9a2a53db8e9b4476038c94a64b32833f?s=128&d=identicon&r=PG", "display_name": "Ryan Bigg", "link": "https://stackoverflow.com/users/15245/ryan-bigg"}, "is_accepted": true, "score": 2, "last_activity_date": 1529534545, "creation_date": 1529534545, "answer_id": 50958050, "question_id": 50957953, "link": "https://stackoverflow.com/questions/50957953/rails-uniqueness-causing-stack-too-deep-error/50958050#50958050", "title": "Rails - Uniqueness causing &quot;Stack Too Deep&quot; error", "body": "<p>You've configured the loop with these two associations:</p>\n\n<pre><code> belongs_to :roast_creator, :class_name =&gt; :User, :foreign_key =&gt; :roast_creator\n belongs_to :roast_receiver, :class_name =&gt; :User, :foreign_key =&gt; :roast_receiver\n</code></pre>\n\n<p>The <code>foreign_key</code> option, specifically. This tells Rails to call the method <code>roast_receiver</code> to get the foreign key value, which will call the <em>association</em> called <code>roast_receiver</code>, which has the foreign key value of <code>roast_receiver</code> which will call the association... etc, etc, etc.</p>\n\n<p>The <code>foreign_key</code> option here should be pointing to the <code>roast_receiver_id</code>, not <code>roast_receiver</code>:</p>\n\n<pre><code>belongs_to :roast_creator, :class_name =&gt; :User, :foreign_key =&gt; :roast_creator_id\nbelongs_to :roast_receiver, :class_name =&gt; :User, :foreign_key =&gt; :roast_receiver_id\n</code></pre>\n\n<p>But Rails will do this automatically for you based off the name of the association, so really you could just have these two lines instead:</p>\n\n<pre><code>belongs_to :roast_creator, :class_name =&gt; :User\nbelongs_to :roast_receiver, :class_name =&gt; :User\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9969996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9a6599d4f172b439581c4d3b7622722?s=128&d=identicon&r=PG&f=1", "display_name": "JJaloudi", "link": "https://stackoverflow.com/users/9969996/jjaloudi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 50958050, "answer_count": 1, "score": 2, "last_activity_date": 1529534545, "creation_date": 1529533839, "question_id": 50957953, "link": "https://stackoverflow.com/questions/50957953/rails-uniqueness-causing-stack-too-deep-error", "title": "Rails - Uniqueness causing &quot;Stack Too Deep&quot; error", "body": "<p>I'm currently working on an API and in my model(called Roast) it belongs to two users. One being the creator, the other the receiver. My current problem, is that I only want ONE instance where these two users can be involved with each other. I found an [article][1] that had a problem just like mine that created the validator but my problem goes down to the stack problem. I'm not sure where this loop is occurring, so I hope you guys can help me with this issue.</p>\n\n<pre><code># roast.rb\n\nclass Roast &lt; ApplicationRecord\n  validates :roast_creator, uniqueness: { scope: :roast_receiver }\n\n  belongs_to :roast_creator, :class_name =&gt; :User, :foreign_key =&gt; :roast_creator\n  belongs_to :roast_receiver, :class_name =&gt; :User, :foreign_key =&gt; :roast_receiver\n\n  has_many :comments, :dependent =&gt; :destroy\n\n  def last_responder\n\n  end\n\n  def last_reply\n    return self.comments.order('comments.created_at DESC').limit(1).load[0] if self.comments.length &gt; 0\n  end\nend\n\n# user.rb\nclass User &lt; ActiveRecord::Base\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\n  include DeviseTokenAuth::Concerns::User\n\n  has_many :created_roasts, :class_name =&gt; :Roast, :foreign_key =&gt; :roast_creator\n  has_many :received_roasts, :class_name =&gt; :Roast, :foreign_key =&gt; :roast_receiver\n\n  has_many :comments\nend\n\n# roasts_controller\nclass RoastsController &lt; ApplicationController\n  before_action :set_roast, only: [:show, :update, :destroy, :respond]\n\n  # GET /roasts\n  # GET /roasts.json\n  def index\n    @roasts = Roast.all\n  end\n\n  # GET /roasts/1\n  # GET /roasts/1.json\n  def show\n  end\n\n  # POST /roasts\n  # POST /roasts.json\n  def create\n    @roast = Roast.new\n    puts \"NEW\"\n    @roast.roast_creator = current_user\n    puts \"CREATOR SET\"\n    @roast.roast_receiver = User.find(params[:receiver])\n    puts \"RECEIVER SET\"\n    @comment = @roast.comments.new(user: current_user, content: params[:comment])\n    puts \"INITIAL COMMENT SET\"\n\n    if @roast.save &amp;&amp; @comment.save\n        puts \"SAVE CREATED\"\n        render :show, status: :created, location: @roast\n    else\n      render json: @roast.errors, status: :unprocessable_entity\n    end\n  end\n\n  # PATCH/PUT /roasts/1\n  # PATCH/PUT /roasts/1.json\n  def update\n    if @roast.update(roast_params)\n      render :show, status: :ok, location: @roast\n    else\n      render json: @roast.errors, status: :unprocessable_entity\n    end\n  end\n\n  # DELETE /roasts/1\n  # DELETE /roasts/1.json\n  def destroy\n    if(@roast.creator == current_user)\n      @roast.destroy\n    end\n  end\n\n  def respond\n    if (current_user.id == @roast.creator.id || current_user.id == @roast.receiver.id)\n      @comment = @roast.comments.create(user: current_user, content: params[:comment])\n\n      if(@comment.save)\n        render :show, status: :created, location: @roast\n      else\n        render json: @comment.errors, status: :unprocessable_entity\n      end\n    else\n      render json: { error: \"Current user is not a creator or a receiver of this particular roast.\" }, status: :unprocessable_entity\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_roast\n      @roast = Roast.find(params[:id])\n    end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\nend\n</code></pre>\n\n<p>The exact error is:</p>\n\n<pre><code>SystemStackError (stack level too deep):\n\napp/controllers/roasts_controller.rb:27:in `create'\n</code></pre>\n\n<p>Thanks in advance for any insight you guys can provide!</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1529549390, "post_id": 50957358, "comment_id": 88916404, "body": "can you show your attempt at stubbing"}], "owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1529531234, "creation_date": 1529530422, "last_edit_date": 1529531234, "question_id": 50957358, "link": "https://stackoverflow.com/questions/50957358/what-is-the-right-way-to-test-csv-related-method-rspec", "title": "What is the right way to test CSV-related method. Rspec", "body": "<p>I have a CSV writing method that looks like this:</p>\n\n<pre><code>def self.write(output_path:, data:)\n    CSV.open(output_path, \"w\") do |csv|\n      data.each do |row|\n        csv &lt;&lt; row\n      end\n    end\n  end\n</code></pre>\n\n<p>In general, I want to stub the <code>CSV</code> class and I want to make sure the right inputs get send to the method. How do I test that we iterate through data and each row gets send to the csv object? What do I do here to test this?</p>\n\n<p>My plan is to determine what the <code>csv</code> that is yielded is, stub that with an <code>instance_double</code> and check to see if it receives <code>:&lt;&lt;</code> with each piece of data that I iterate through. However, the <code>csv</code> object is:</p>\n\n<pre><code>&lt;#CSV io_type:File io_path:\"./public/output/redemptions.csv\" encoding:UTF-8 lineno:1 col_sep:\",\" row_sep:\"\\n\" quote_char:\"\\\"\"&gt;\n</code></pre>\n\n<p>What is that? How do I stub that? I tried stubbing it with an instance_double of <code>CSV</code> but that did not work and it complained that it received an unexpected method of <code>&lt;&lt;</code>. Any advice?</p>\n"}, {"tags": ["ruby", "regex", "delimiter"], "comments": [{"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1529529437, "post_id": 50957067, "comment_id": 88911696, "body": "Try <code>s.scan(&#47;role:\\(([^()]+)\\)&#47;)</code> or if you only expect 1 match per string, <code>s[&#47;role:\\(([^()]+)\\)&#47;, 1]</code>"}, {"owner": {"reputation": 1049, "user_id": 2403445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2f84b31d5451887e968e4870254bc0c9?s=128&d=identicon&r=PG", "display_name": "TheNovice", "link": "https://stackoverflow.com/users/2403445/thenovice"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1529529787, "post_id": 50957067, "comment_id": 88911856, "body": "@WiktorStribi\u017cew - this works well for the parens case, I&#39;m trying to tweak your regex a little bit to cover the <code>&quot;languages:&#39;python&#39; role:&#39;software engineer&#39;&quot;</code> and <code>&quot;languages:&#39;python&#39;role:&#39;software engineer&#39;&quot;</code> case!"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1529530236, "post_id": 50957067, "comment_id": 88912036, "body": "Or <a href=\"https://regex101.com/r/uqEzWE/2\" rel=\"nofollow noreferrer\"><code>s.scan(&#47;role:(?:\\(\\K[^()]+(?=\\))|&#39;\\K[^&#39;]+(?=&#39;))&#47;)</code></a>? <a href=\"https://ideone.com/AxUZU0\" rel=\"nofollow noreferrer\">Demo in Ruby</a>."}, {"owner": {"reputation": 1049, "user_id": 2403445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2f84b31d5451887e968e4870254bc0c9?s=128&d=identicon&r=PG", "display_name": "TheNovice", "link": "https://stackoverflow.com/users/2403445/thenovice"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1529530363, "post_id": 50957067, "comment_id": 88912093, "body": "That did it. Thanks @WiktorStribi\u017cew. Want to add it as an answer so I can give you the credit for your answer?"}], "answers": [{"tags": [], "owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 3, "last_activity_date": 1529530513, "creation_date": 1529530513, "answer_id": 50957381, "question_id": 50957067, "link": "https://stackoverflow.com/questions/50957067/regex-matching-on-a-substring-and-returning-the-string-between-specific-delimite/50957381#50957381", "title": "Regex matching on a substring and returning the string between specific delimiters", "body": "<p>You may use</p>\n\n<pre><code>s.scan(/role:(?:\\(\\K[^()]+(?=\\))|'\\K[^']+(?='))/)\n</code></pre>\n\n<p>See the <a href=\"https://regex101.com/r/uqEzWE/2\" rel=\"nofollow noreferrer\">regex demo</a></p>\n\n<p><strong>Details</strong></p>\n\n<ul>\n<li><code>role:</code> - a literal substring</li>\n<li><code>(?:</code> - start of an alternation non-capturing group:\n\n<ul>\n<li><code>\\(</code> - a <code>(</code> char</li>\n<li><code>\\K</code> - <a href=\"https://www.regular-expressions.info/keep.html\" rel=\"nofollow noreferrer\"><em>match reset operator</em></a> discarding the text matched so far</li>\n<li><code>[^()]+</code> - 1+ chars other than <code>(</code> and <code>)</code></li>\n<li><code>(?=\\))</code> - a <code>)</code> should follow the current position</li>\n</ul></li>\n<li><code>|</code> - or</li>\n<li><code>'</code> - a <code>'</code> char</li>\n<li><code>\\K</code> -  match reset operator discarding the text matched so far</li>\n<li><code>[^']+</code> - 1+ chars other than <code>'</code></li>\n<li><code>(?=')</code> - there must be <code>'</code> char immediately to the right</li>\n<li><code>)</code> - end of the alternation group.</li>\n</ul>\n\n<p>NOTE: if you do not care if there is a <code>)</code> or trailing <code>'</code>, remove the lookaheads to simplify the regex.</p>\n\n<p><a href=\"https://ideone.com/AxUZU0\" rel=\"nofollow noreferrer\">Ruby demo</a>:</p>\n\n<pre><code>s  = \"languages:(ruby AND python) role:(software engineer or data scientist) role:(software engineer or data scientist) languages:(ruby AND python) languages:'python' role:'software engineer'  languages:(ruby AND python)role:(software engineer or data scientist) languages:'python'role:'software engineer' languages:'python'\"\nputs s.scan(/role:(?:\\(\\K[^()]+(?=\\))|'\\K[^']+(?='))/)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>software engineer or data scientist\nsoftware engineer or data scientist\nsoftware engineer\nsoftware engineer or data scientist\nsoftware engineer\n</code></pre>\n"}], "owner": {"reputation": 1049, "user_id": 2403445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2f84b31d5451887e968e4870254bc0c9?s=128&d=identicon&r=PG", "display_name": "TheNovice", "link": "https://stackoverflow.com/users/2403445/thenovice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 50957381, "answer_count": 1, "score": 2, "last_activity_date": 1529530513, "creation_date": 1529529035, "last_edit_date": 1529529375, "question_id": 50957067, "link": "https://stackoverflow.com/questions/50957067/regex-matching-on-a-substring-and-returning-the-string-between-specific-delimite", "title": "Regex matching on a substring and returning the string between specific delimiters", "body": "<p>Let's say I have a string that can be formatted a few different ways, for example:</p>\n\n<ul>\n<li>\"languages:(ruby AND python) role:(software engineer or data\nscientist)\"</li>\n<li>\"role:(software engineer or data scientist) languages:(ruby AND python)\"</li>\n<li>\"languages:'python' role:'software engineer'\"</li>\n<li>\"languages:(ruby AND python)role:(software engineer or data\nscientist)\"</li>\n<li>\"languages:'python'role:'software engineer'\"</li>\n<li>\"languages:'python'</li>\n</ul>\n\n<p>And I want to parse this string, identify if <code>role:</code> is present in the string and then capture whatever word(s) are relevant to \"role\", excluding whatever isn't wrapped in the close parans <code>)</code> OR the <code>'</code>... so in this example, <code>\"languages:'python'role:'software engineer'\"</code> would return \"software engineer\" and <code>\"role:(software engineer or data scientist) languages:(ruby AND python)\"</code> would return \"software engineer or data scientist\".</p>\n\n<p>Is there a way to do this with something LIKE a word boundary? Specifically, the region after the match on <code>role:</code> would be delimited by either quotes or <code>()</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "git", "heroku"], "comments": [{"owner": {"reputation": 2092, "user_id": 1667130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DSBaC.jpg?s=128&g=1", "display_name": "Bill Doughty", "link": "https://stackoverflow.com/users/1667130/bill-doughty"}, "edited": false, "score": 0, "creation_date": 1529527769, "post_id": 50956626, "comment_id": 88911036, "body": "Have you tried running <b>RAILS_ENV=production bundle exec rake assets:precompile</b> locally?  The issue may not necessarily be due to heroku attempting to connect to the database."}, {"owner": {"reputation": 605, "user_id": 8844309, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/cd28857ec0194e1a6e3fd1ad9ac02a03?s=128&d=identicon&r=PG&f=1", "display_name": "logos_164", "link": "https://stackoverflow.com/users/8844309/logos-164"}, "reply_to_user": {"reputation": 2092, "user_id": 1667130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DSBaC.jpg?s=128&g=1", "display_name": "Bill Doughty", "link": "https://stackoverflow.com/users/1667130/bill-doughty"}, "edited": false, "score": 0, "creation_date": 1529527877, "post_id": 50956626, "comment_id": 88911082, "body": "no, what does that do? I&#39;m pretty much brand new to ruby on rails"}, {"owner": {"reputation": 2092, "user_id": 1667130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DSBaC.jpg?s=128&g=1", "display_name": "Bill Doughty", "link": "https://stackoverflow.com/users/1667130/bill-doughty"}, "edited": false, "score": 0, "creation_date": 1529527940, "post_id": 50956626, "comment_id": 88911116, "body": "It does exactly what heroku is doing when you deploy.  You should be sure it works locally first."}, {"owner": {"reputation": 605, "user_id": 8844309, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/cd28857ec0194e1a6e3fd1ad9ac02a03?s=128&d=identicon&r=PG&f=1", "display_name": "logos_164", "link": "https://stackoverflow.com/users/8844309/logos-164"}, "reply_to_user": {"reputation": 2092, "user_id": 1667130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DSBaC.jpg?s=128&g=1", "display_name": "Bill Doughty", "link": "https://stackoverflow.com/users/1667130/bill-doughty"}, "edited": false, "score": 0, "creation_date": 1529528049, "post_id": 50956626, "comment_id": 88911159, "body": "well I did that and it worked fine, then I reran the push to heroku so it looks like it worked! thanks. would you want to type that up as an answer? just in case people run into this in the future. if not then I can but you should get credit for it."}, {"owner": {"reputation": 2092, "user_id": 1667130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DSBaC.jpg?s=128&g=1", "display_name": "Bill Doughty", "link": "https://stackoverflow.com/users/1667130/bill-doughty"}, "edited": false, "score": 0, "creation_date": 1529528148, "post_id": 50956626, "comment_id": 88911199, "body": "Did you commit any changes to git after running the precompile, before pushing to heroku?  Running that command locally shouldn&#39;t have magically fixed your deployment problem."}, {"owner": {"reputation": 2092, "user_id": 1667130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DSBaC.jpg?s=128&g=1", "display_name": "Bill Doughty", "link": "https://stackoverflow.com/users/1667130/bill-doughty"}, "edited": false, "score": 0, "creation_date": 1529528276, "post_id": 50956626, "comment_id": 88911259, "body": "You should read <a href=\"https://devcenter.heroku.com/articles/rails-asset-pipeline\" rel=\"nofollow noreferrer\">this article</a>, if you haven&#39;t already."}, {"owner": {"reputation": 605, "user_id": 8844309, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/cd28857ec0194e1a6e3fd1ad9ac02a03?s=128&d=identicon&r=PG&f=1", "display_name": "logos_164", "link": "https://stackoverflow.com/users/8844309/logos-164"}, "reply_to_user": {"reputation": 2092, "user_id": 1667130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DSBaC.jpg?s=128&g=1", "display_name": "Bill Doughty", "link": "https://stackoverflow.com/users/1667130/bill-doughty"}, "edited": false, "score": 0, "creation_date": 1529528325, "post_id": 50956626, "comment_id": 88911277, "body": "Well it now committed it to heroku, I checked and everything was there"}, {"owner": {"reputation": 2092, "user_id": 1667130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DSBaC.jpg?s=128&g=1", "display_name": "Bill Doughty", "link": "https://stackoverflow.com/users/1667130/bill-doughty"}, "reply_to_user": {"reputation": 605, "user_id": 8844309, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/cd28857ec0194e1a6e3fd1ad9ac02a03?s=128&d=identicon&r=PG&f=1", "display_name": "logos_164", "link": "https://stackoverflow.com/users/8844309/logos-164"}, "edited": false, "score": 0, "creation_date": 1529528370, "post_id": 50956626, "comment_id": 88911293, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/173511/discussion-between-bill-doughty-and-logos-164\">continue this discussion in chat</a>."}], "owner": {"reputation": 605, "user_id": 8844309, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/cd28857ec0194e1a6e3fd1ad9ac02a03?s=128&d=identicon&r=PG&f=1", "display_name": "logos_164", "link": "https://stackoverflow.com/users/8844309/logos-164"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529526883, "creation_date": 1529526883, "question_id": 50956626, "link": "https://stackoverflow.com/questions/50956626/heroku-push-rejected-to-agile-savannah-even-when-sqlite-is-removed-from-gemfile", "title": "heroku push rejected to agile-savannah even when sqlite is removed from gemfile", "body": "<p>I'm using Cloud9 IDE, running <code>Ruby -v 2.3.4p301</code> , <code>Rails -v 4.2.5</code>, and <code>Heroku -v heroku/7.4.1 linux-x64 node-v10.4.1</code></p>\n\n<p>I remove <code>sqlite3</code> from my database designation and get the gemfile designated below:</p>\n\n<pre><code># Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\ngem 'rails', '4.2.5'\n# Use sqlite3 as the database for Active Record\n\n# Use SCSS for stylesheets\ngem 'sass-rails', '~&gt; 5.0'\n# Use Uglifier as compressor for JavaScript assets\ngem 'uglifier', '&gt;= 1.3.0'\n# Use CoffeeScript for .coffee assets and views\ngem 'coffee-rails', '~&gt; 4.1.0'\n# See https://github.com/rails/execjs#readme for more supported runtimes\n# gem 'therubyracer', platforms: :ruby\n\n# Use jquery as the JavaScript library\ngem 'jquery-rails'\n# Turbolinks makes following links in your web application faster. Read more: https://github.com/rails/turbolinks\ngem 'turbolinks'\n# Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder\ngem 'jbuilder', '~&gt; 2.0'\n# bundle exec rake doc:rails generates the API under doc/api.\ngem 'sdoc', '~&gt; 0.4.0', group: :doc\n\n# Use ActiveModel has_secure_password\n# gem 'bcrypt', '~&gt; 3.1.7'\n\n# Use Unicorn as the app server\n# gem 'unicorn'\n\n# Use Capistrano for deployment\n# gem 'capistrano-rails', group: :development\n\ngroup :development, :test do\n  gem 'sqlite3'\n  # Call 'byebug' anywhere in the code to stop execution and get a debugger console\n  gem 'byebug'\nend\n\ngroup :development do\n  # Access an IRB console on exception pages or by using &lt;%= console %&gt; in views\n  gem 'web-console', '~&gt; 2.0'\n\n  # Spring speeds up development by keeping your application running in the background. Read more: https://github.com/rails/spring\n  gem 'spring'\nend\n\ngroup :production do\n  gem 'pg' #postgress\n  gem 'rails_12factor'\nend\n</code></pre>\n\n<p>I run\n<code>bundle install</code>\n<code>git status</code>\n<code>git add -A</code>\n<code>git commit -m 'initial commit'</code>\n<code>git push</code>\n<code>git push heroku master</code></p>\n\n<p>And get the error here:</p>\n\n<blockquote>\n  <p>remote:  !     Precompiling assets failed. remote:  ! remote:  !<br>\n  Push rejected, failed to compile Ruby app. remote:  remote:  !<br>\n  Push failed remote: Verifying deploy... remote:  remote: !       Push\n  rejected to agile-savannah-14413. remote:  To\n  <a href=\"https://git.heroku.com/agile-savannah-14413.git\" rel=\"nofollow noreferrer\">https://git.heroku.com/agile-savannah-14413.git</a>  ! [remote rejected]\n  master -> master (pre-receive hook declined) error: failed to push\n  some refs to '<a href=\"https://git.heroku.com/agile-savannah-14413.git\" rel=\"nofollow noreferrer\">https://git.heroku.com/agile-savannah-14413.git</a>'</p>\n</blockquote>\n\n<p>I came across the answer <a href=\"https://stackoverflow.com/questions/15737296/heroku-push-rejected-failed-to-compile-ruby-rails-app/19294832\">here</a> but his problem was that he was using <code>sqlite3</code> for his database, but I removed that to use <code>postgress</code> instead.</p>\n\n<p>I still follow the guidelines there and delete my <code>Gemfile.lock</code> file, then rerun the commands above and come across the same issue.</p>\n\n<p>Am I missing something here?</p>\n"}, {"tags": ["ruby", "jenkins-pipeline", "bundler", "gemfile", "gemfile.lock"], "comments": [{"owner": {"reputation": 4693, "user_id": 5501536, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/50b9ab14ab8699a3862c14ee48126abe?s=128&d=identicon&r=PG&f=1", "display_name": "chevybow", "link": "https://stackoverflow.com/users/5501536/chevybow"}, "edited": false, "score": 0, "creation_date": 1529528160, "post_id": 50956406, "comment_id": 88911208, "body": "<code>Make sure that &#39;gem install rake -v &#39;10.3.2&#39;  succeeds before bundling.</code> I would start here"}, {"owner": {"reputation": 1039, "user_id": 779429, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9d08172f46d2bc0fb49b10d3730b5877?s=128&d=identicon&r=PG", "display_name": "Becks", "link": "https://stackoverflow.com/users/779429/becks"}, "reply_to_user": {"reputation": 4693, "user_id": 5501536, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/50b9ab14ab8699a3862c14ee48126abe?s=128&d=identicon&r=PG&f=1", "display_name": "chevybow", "link": "https://stackoverflow.com/users/5501536/chevybow"}, "edited": false, "score": 0, "creation_date": 1529533358, "post_id": 50956406, "comment_id": 88913129, "body": "@chevybow I am afraid, that&#39;s not the issue in this case. The issue is that my jenkins user has no access to where gem is re-building the install context for the dependencies. Directory : /.gem/ruby/2.4.0/cache/rake-10.3.2.gem"}, {"owner": {"reputation": 1039, "user_id": 779429, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9d08172f46d2bc0fb49b10d3730b5877?s=128&d=identicon&r=PG", "display_name": "Becks", "link": "https://stackoverflow.com/users/779429/becks"}, "reply_to_user": {"reputation": 4693, "user_id": 5501536, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/50b9ab14ab8699a3862c14ee48126abe?s=128&d=identicon&r=PG&f=1", "display_name": "chevybow", "link": "https://stackoverflow.com/users/5501536/chevybow"}, "edited": false, "score": 0, "creation_date": 1529533406, "post_id": 50956406, "comment_id": 88913143, "body": "And the question becomes, whilst bundle is available inside the container, how do I use that bundle to install the Gemfile dependencies as the jenkins user?"}], "answers": [{"tags": [], "owner": {"reputation": 3119, "user_id": 4842949, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0agpj31wtZ8/AAAAAAAAAAI/AAAAAAAAAAA/mSolbNN-zIY/photo.jpg?sz=128", "display_name": "Joseph Cho", "link": "https://stackoverflow.com/users/4842949/joseph-cho"}, "is_accepted": false, "score": 0, "last_activity_date": 1529534305, "creation_date": 1529534305, "answer_id": 50958014, "question_id": 50956406, "link": "https://stackoverflow.com/questions/50956406/cannot-install-gems-with-bundle/50958014#50958014", "title": "Cannot install gems with bundle", "body": "<p>It looks like you don't have access to root, so bundler is using another directory instead.</p>\n\n<p>What happens next is your user doesn't have access to the right gem directory because it doesn't exist! Try running <code>bundle config path NEW_PATH_HERE</code> to set a proper directory which your user can access.</p>\n\n<p>Alternatively you can specify a new path with: <code>bundle install --path /some/path</code></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 15193783, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VKff9.jpg?s=128&g=1", "display_name": "Billy Montemayor", "link": "https://stackoverflow.com/users/15193783/billy-montemayor"}, "is_accepted": false, "score": 0, "last_activity_date": 1613078039, "creation_date": 1613078039, "answer_id": 66162955, "question_id": 50956406, "link": "https://stackoverflow.com/questions/50956406/cannot-install-gems-with-bundle/66162955#66162955", "title": "Cannot install gems with bundle", "body": "<p>You can set <code>BUNDLE_PATH</code> (env var) and this will be fixed\nyou can check the configuration on the <a href=\"https://bundler.io/man/bundle-config.1.html\" rel=\"nofollow noreferrer\">bundle documentation</a></p>\n"}], "owner": {"reputation": 1039, "user_id": 779429, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9d08172f46d2bc0fb49b10d3730b5877?s=128&d=identicon&r=PG", "display_name": "Becks", "link": "https://stackoverflow.com/users/779429/becks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1416, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1613160713, "creation_date": 1529525928, "last_edit_date": 1613160713, "question_id": 50956406, "link": "https://stackoverflow.com/questions/50956406/cannot-install-gems-with-bundle", "title": "Cannot install gems with bundle", "body": "<p>I am spinning a docker container(alpine base) from a docker file inside a Jenkins pipeline. The container installs:\n<code>ruby-rake and ruby-bundler</code> \nand I am able to do bundle with no problem</p>\n\n<p>My working directory in this jenkins pipeline has Gemfile and Gemfile.lock \nI try to run bundle install in this working directory </p>\n\n<p>when I try: </p>\n\n<pre><code>bundle install #running as a shell command in jenkins \n</code></pre>\n\n<p>I get: </p>\n\n<pre><code>`/` is not writable.\nBundler will use `/tmp/bundler/home/unknown' as your home directory temporarily.\nFetching gem metadata from https://rubygems.org/...........\nFetching gem metadata from https://rubygems.org/.\n\nResolving dependencies.............\nFetching rake 10.3.2\n\nRetrying download gem from https://rubygems.org/ due to error (2/4): Errno::ENOENT No such file or directory @ rb_sysopen - /.gem/ruby/2.4.0/cache/rake-10.3.2.gem\nRetrying download gem from https://rubygems.org/ due to error (3/4): Errno::ENOENT No such file or directory @ rb_sysopen - /.gem/ruby/2.4.0/cache/rake-10.3.2.gem\nRetrying download gem from https://rubygems.org/ due to error (4/4): Errno::ENOENT No such file or directory @ rb_sysopen - /.gem/ruby/2.4.0/cache/rake-10.3.2.gem\nErrno::ENOENT: No such file or directory @ rb_sysopen -\n/.gem/ruby/2.4.0/cache/rake-10.3.2.gem\nAn error occurred while installing rake (10.3.2), and Bundler cannot continue.\nMake sure that `gem install rake -v '10.3.2'` succeeds before bundling.\n\nIn Gemfile:\n  aws_account_utils was resolved to 0.1.4, which depends on\n  rake\n</code></pre>\n\n<p>What do I have to do to install my Ruby gems of Gemfile and Gemfile.lock?</p>\n"}, {"tags": ["ruby", "input"], "answers": [{"comments": [{"owner": {"reputation": 888, "user_id": 288395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/811d61a875dcc509c6a5e841f5305b16?s=128&d=identicon&r=PG", "display_name": "Chris W", "link": "https://stackoverflow.com/users/288395/chris-w"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1529528263, "post_id": 50956756, "comment_id": 88911256, "body": "Sorry, but that&#39;s just blatantly wrong, and a quick look at the documentation for <code>gets</code> (<a href=\"http://ruby-doc.org/core-2.3.1/Kernel.html#method-i-gets\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.3.1/Kernel.html#method-i-gets</a>) will prove it to you: &quot;Returns <code>nil</code> at end of file&quot;. In fact, there is even an example there doing just that: <code>print while gets</code>."}, {"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1529528450, "post_id": 50956756, "comment_id": 88911333, "body": "Kernel#gets will return a newline on a blank line, which will always be true, as @CarySwoveland says. However, the terminal condition here is EOF, not a blank line; Kernel#gets will return a <code>nil</code> on EOF, which will always be false. That&#39;s the desired behavior."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1529529370, "post_id": 50956756, "comment_id": 88911668, "body": "Sorry, Chris. I just looked at your code, missing the first line, thinking it was <code>Kernel#gets</code>, receiving input from a terminal. I&#39;ve deleted my comment and will delete this one later. You do need an explicit (file handle) receiver for <code>gets</code>, no?"}, {"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1529529695, "post_id": 50956756, "comment_id": 88911808, "body": "@CarySwoveland It is Kernel#gets, and you don&#39;t need an explicit receiver."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "edited": false, "score": 0, "creation_date": 1529530603, "post_id": 50956756, "comment_id": 88912172, "body": "@mwp, I&#39;m confused. For <code>gets</code> in the code above to return <code>nil</code>, doesn&#39;t <code>$stdin</code>  (or is it <code>$&lt;</code>?) have to first be reassigned (to a file instance, say)?"}, {"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1529531315, "post_id": 50956756, "comment_id": 88912455, "body": "@CarySwoveland Nope. Try this: fire up an irb, paste in @ChrisW&#39;s code, enter a few lines of data, then press Ctrl-D. Check the value of <code>script</code>. It works great."}, {"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "edited": false, "score": 0, "creation_date": 1529532290, "post_id": 50956756, "comment_id": 88912807, "body": "stdin is just a file handle. It can be (re)opened, closed, and redirected just like any other file handle. If you start your program from a terminal, it will be connected to the terminal, and if you read from stdin (or use a function that reads from stdin, like Kernel#gets), it will get input from the terminal. You can then press Ctrl-D (or Ctrl-Z on Windows) to send an EOF &quot;character&quot; to close the stdin file handle. I use it all the time. It makes it quick and easy to log out or write a few lines to a file."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "edited": false, "score": 1, "creation_date": 1529532299, "post_id": 50956756, "comment_id": 88912808, "body": "@mwp, Ctrl-D! I didn&#39;t know that! It certainly makes sense, though. Thanks."}, {"owner": {"reputation": 14, "user_id": 9969468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16751e4c2ac55ab110fa9d1ceeff4362?s=128&d=identicon&r=PG&f=1", "display_name": "Husky2490", "link": "https://stackoverflow.com/users/9969468/husky2490"}, "edited": false, "score": 0, "creation_date": 1529704625, "post_id": 50956756, "comment_id": 88986516, "body": "Output does not print (eval is not executed) and program only briefly responds to OS when new lines are typed in console"}], "tags": [], "owner": {"reputation": 888, "user_id": 288395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/811d61a875dcc509c6a5e841f5305b16?s=128&d=identicon&r=PG", "display_name": "Chris W", "link": "https://stackoverflow.com/users/288395/chris-w"}, "is_accepted": false, "score": 1, "last_activity_date": 1529527452, "creation_date": 1529527452, "answer_id": 50956756, "question_id": 50956369, "link": "https://stackoverflow.com/questions/50956369/ruby-get-input-only-if-input-exists/50956756#50956756", "title": "Ruby get input only if input exists", "body": "<p>In Ruby, <code>Kernel#gets</code> will return <code>nil</code> when there is no more line to read (i.e. EOF is reached). </p>\n\n<p>So the following script would do the equivalent to the above Java code:</p>\n\n<pre><code>script = ''\nwhile line = gets\n  script += line\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 14, "user_id": 9969468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16751e4c2ac55ab110fa9d1ceeff4362?s=128&d=identicon&r=PG&f=1", "display_name": "Husky2490", "link": "https://stackoverflow.com/users/9969468/husky2490"}, "edited": false, "score": 0, "creation_date": 1529704361, "post_id": 50956918, "comment_id": 88986459, "body": "Doesn&#39;t work. Output is not printed and program does not respond if no input is provided"}, {"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "reply_to_user": {"reputation": 14, "user_id": 9969468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16751e4c2ac55ab110fa9d1ceeff4362?s=128&d=identicon&r=PG&f=1", "display_name": "Husky2490", "link": "https://stackoverflow.com/users/9969468/husky2490"}, "edited": false, "score": 0, "creation_date": 1529705101, "post_id": 50956918, "comment_id": 88986609, "body": "Well, you have to do something with the <code>script</code> variable. I don&#39;t see a <code>System.out.println(script)</code> in your original code, is that what you want to have happen?"}, {"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "reply_to_user": {"reputation": 14, "user_id": 9969468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16751e4c2ac55ab110fa9d1ceeff4362?s=128&d=identicon&r=PG&f=1", "display_name": "Husky2490", "link": "https://stackoverflow.com/users/9969468/husky2490"}, "edited": false, "score": 0, "creation_date": 1529705230, "post_id": 50956918, "comment_id": 88986641, "body": "Also, if you open STDIN from any programming language and don&#39;t provide any input, it&#39;s going to hang. I can&#39;t get your Java snippet to compile but I suspect it does the same thing. If you want some other behavior, please edit your question to specify your requirements."}, {"owner": {"reputation": 14, "user_id": 9969468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16751e4c2ac55ab110fa9d1ceeff4362?s=128&d=identicon&r=PG&f=1", "display_name": "Husky2490", "link": "https://stackoverflow.com/users/9969468/husky2490"}, "edited": false, "score": 0, "creation_date": 1529705298, "post_id": 50956918, "comment_id": 88986661, "body": "behold my script evaluation code: ```     begin \\n       eval script \\n       $stdout.flush() \\n     rescue Exception \\n       return false \\n     end \\n ```  edit: formatting no like"}, {"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "reply_to_user": {"reputation": 14, "user_id": 9969468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16751e4c2ac55ab110fa9d1ceeff4362?s=128&d=identicon&r=PG&f=1", "display_name": "Husky2490", "link": "https://stackoverflow.com/users/9969468/husky2490"}, "edited": false, "score": 0, "creation_date": 1529705655, "post_id": 50956918, "comment_id": 88986745, "body": "Okay, updated. <code>rescue Exception</code> with <code>return false</code> is bad form; just put <code>rescue</code> with an empty block. And if the Ruby part of your process is ending after this, there&#39;s no need to flush stdout."}, {"owner": {"reputation": 14, "user_id": 9969468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16751e4c2ac55ab110fa9d1ceeff4362?s=128&d=identicon&r=PG&f=1", "display_name": "Husky2490", "link": "https://stackoverflow.com/users/9969468/husky2490"}, "edited": false, "score": 0, "creation_date": 1529707828, "post_id": 50956918, "comment_id": 88987196, "body": "this is in a main loop that should be 60 fps, rate is controlled by Graphics.update() at the top of the loop. This function is called towards the bottom of the loop. Graphics.update() pauses the loop if the application window (not my terminal) is not &quot;in focus&quot; (currently selected window)"}], "tags": [], "owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "is_accepted": false, "score": 0, "last_activity_date": 1529705598, "last_edit_date": 1529705598, "creation_date": 1529528255, "answer_id": 50956918, "question_id": 50956369, "link": "https://stackoverflow.com/questions/50956369/ruby-get-input-only-if-input-exists/50956918#50956918", "title": "Ruby get input only if input exists", "body": "<p>You can capture the input lines as an array and join the elements by newline:</p>\n\n<pre><code>script = STDIN.readlines.join(\"\\n\")\n</code></pre>\n\n<p>To evaluate it:</p>\n\n<pre><code>eval script rescue nil\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>begin\n  eval script\nrescue\nend\n</code></pre>\n\n<p>As you noted in the comments, you can <code>STDOUT.flush</code> if you need to. If the Ruby program is ending immediately, there's no need to flush stdout.</p>\n"}, {"tags": [], "owner": {"reputation": 14, "user_id": 9969468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16751e4c2ac55ab110fa9d1ceeff4362?s=128&d=identicon&r=PG&f=1", "display_name": "Husky2490", "link": "https://stackoverflow.com/users/9969468/husky2490"}, "is_accepted": true, "score": 0, "last_activity_date": 1529711218, "creation_date": 1529711218, "answer_id": 50996750, "question_id": 50956369, "link": "https://stackoverflow.com/questions/50956369/ruby-get-input-only-if-input-exists/50996750#50996750", "title": "Ruby get input only if input exists", "body": "<p>This works but only because self.reload! is not called while my console window is selected</p>\n\n<pre><code>Thread.new do\n  loop do\n    script_temp = gets\n    @script = @script + script_temp\n  end\nend\n\ndef self.reload!\n  begin\n    eval @script\n    $stdout.flush()\n  rescue Exception\n  end\n  @script = ''\nend\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/4681899/how-do-i-listen-to-stdin-input-without-pausing-my-script\">Based on this</a></p>\n"}], "owner": {"reputation": 14, "user_id": 9969468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16751e4c2ac55ab110fa9d1ceeff4362?s=128&d=identicon&r=PG&f=1", "display_name": "Husky2490", "link": "https://stackoverflow.com/users/9969468/husky2490"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 50996750, "answer_count": 3, "score": 0, "last_activity_date": 1529952586, "creation_date": 1529525768, "last_edit_date": 1529952586, "question_id": 50956369, "link": "https://stackoverflow.com/questions/50956369/ruby-get-input-only-if-input-exists", "title": "Ruby get input only if input exists", "body": "<p>I am looking for a way to take input from a terminal in a function called from the main loop of a program.</p>\n\n<p>I am not worried about it executing scripts halfway through writing them as the main loop is paused when the application window (not the terminal or console window) loses focus.</p>\n\n<p>This is dev-only so any mishaps with eval lie with me</p>\n\n<p>Edit: I forgot to say, I want the main loop to continue uninterrupted if there is no input.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rvm", "macos-high-sierra"], "comments": [{"owner": {"reputation": 4693, "user_id": 5501536, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/50b9ab14ab8699a3862c14ee48126abe?s=128&d=identicon&r=PG&f=1", "display_name": "chevybow", "link": "https://stackoverflow.com/users/5501536/chevybow"}, "edited": false, "score": 0, "creation_date": 1529525802, "post_id": 50956329, "comment_id": 88910198, "body": "Have you tried googling the error and trying the commands that come up? looks like it might be an openssl error"}, {"owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "edited": false, "score": 0, "creation_date": 1529529077, "post_id": 50956329, "comment_id": 88911561, "body": "Have you made yourself a <code>root</code> user on your machine? Also, see this question <a href=\"https://stackoverflow.com/questions/27832732/error-running-rvm-make-install\" title=\"error running rvm make install\">stackoverflow.com/questions/27832732/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 6161488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ad9ac5645f6d6d99d7f381009e7787e?s=128&d=identicon&r=PG", "display_name": "Fir3Chi3f", "link": "https://stackoverflow.com/users/6161488/fir3chi3f"}, "is_accepted": false, "score": 0, "last_activity_date": 1529527386, "creation_date": 1529527386, "answer_id": 50956740, "question_id": 50956329, "link": "https://stackoverflow.com/questions/50956329/trying-to-install-rvm-and-getting-error-running-rvm-make-j2/50956740#50956740", "title": "Trying to install RVM and getting: Error running &#39;__rvm_make -j2&#39;", "body": "<p>Double check that you have xcode installed and possibly gnupg.</p>\n\n<pre><code>brew install gnupg\n</code></pre>\n\n<p>Source:\n<a href=\"http://usabilityetc.com/articles/ruby-on-mac-os-x-with-rvm/\" rel=\"nofollow noreferrer\">http://usabilityetc.com/articles/ruby-on-mac-os-x-with-rvm/</a></p>\n"}, {"tags": [], "owner": {"reputation": 4437, "user_id": 1183098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wbe4o.png?s=128&g=1", "display_name": "user9869932", "link": "https://stackoverflow.com/users/1183098/user9869932"}, "is_accepted": false, "score": 0, "last_activity_date": 1581533519, "creation_date": 1581533519, "answer_id": 60195124, "question_id": 50956329, "link": "https://stackoverflow.com/questions/50956329/trying-to-install-rvm-and-getting-error-running-rvm-make-j2/60195124#60195124", "title": "Trying to install RVM and getting: Error running &#39;__rvm_make -j2&#39;", "body": "<p>I got this error with Mac OS Catalina.</p>\n\n<p>Are installing ruby \u200b\u200busing the command:</p>\n\n<pre><code>rvm install 2.4 --with-openssl-dir=`brew --prefix openssl`\n</code></pre>\n\n<p>?</p>\n\n<p><strong>Try using:</strong></p>\n\n<pre><code>rvm install 2.4 --with-openssl-dir=/usr/local/opt/openssl\n</code></pre>\n\n<p>It is possible that the problem is that you have several versions of openssl installed</p>\n\n<p>You can check it with: (the result will be several lines)</p>\n\n<pre><code>ls -la /usr/local/opt/ | grep openssl\n</code></pre>\n\n<p>Try these steps:</p>\n\n<pre><code>gpg2 --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3 7D2BAF1CF37B13E2069D6956105BD0E739499BDB\n\n\\curl -sSL https://get.rvm.io | bash -s stable --rails\nbrew install openssl\nrvm install 2.4 --with-openssl-dir=/usr/local/opt/openssl \n</code></pre>\n"}], "owner": {"reputation": 499, "user_id": 80939, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ubDLb.jpg?s=128&g=1", "display_name": "deluxe_247", "link": "https://stackoverflow.com/users/80939/deluxe-247"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2117, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1581533519, "creation_date": 1529525550, "question_id": 50956329, "link": "https://stackoverflow.com/questions/50956329/trying-to-install-rvm-and-getting-error-running-rvm-make-j2", "title": "Trying to install RVM and getting: Error running &#39;__rvm_make -j2&#39;", "body": "<p>I was trying to install RVM with stable ruby on a mac and got a make error:</p>\n\n<p><strong>abbreviated console output:</strong></p>\n\n<pre><code>   \\curl -sSL https://get.rvm.io | bash -s stable --ruby\\curl -sSL https://get.rvm.io\n   ...\n   ...\n   ... \n   ruby-2.4.1 - #extracting ruby-2.4.1 to /Users/bbush/.rvm/src/ruby-2.4.1....\n   ruby-2.4.1 - #applying patch /Users/bbush/.rvm/patches/ruby/2.4.1/random_c_using_NR_prefix.patch.\n   ruby-2.4.1 - #configuring...................................................................\n   ruby-2.4.1 - #post-configuration.\n   ruby-2.4.1 - #compiling...........\n   Error running '__rvm_make -j2',\n</code></pre>\n\n<p><strong>abbreviated make.log:</strong></p>\n\n<pre><code>............\ncompiling enc/us_ascii.c\ncompiling enc/unicode.c\ncompiling enc/utf_8.c\ncompiling enc/trans/newline.c\nlinking miniruby\ngenerating encdb.h\nmake: ./miniruby: Permission denied\nmake: ./miniruby: Permission denied\nmake: *** [.rbconfig.time] Error 1\nmake: *** Waiting for unfinished jobs....\nmake: *** [encdb.h] Error 1\n++ /scripts/functions/support : __rvm_make()  383 &gt; return 2\n</code></pre>\n\n<p><strong>System</strong></p>\n\n<ul>\n<li>Mac OS X \u2013 High Sierra (10.13.4) </li>\n<li>Homebrew 1.6.9</li>\n</ul>\n\n<p>I'm thinking that using sudo with the RVM install curl command is a bad idea but how do I get around this permissions issue?\nThanks.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1529525496, "post_id": 50955991, "comment_id": 88910071, "body": "Do you have any validation in your <code>Listing</code> model? How does the log for the requests look like?"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1529529202, "post_id": 50955991, "comment_id": 88911615, "body": "You really should be checking if <code>@listing.save</code> succeeds or not. Ignoring error checking is a bad idea."}], "answers": [{"tags": [], "owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "is_accepted": true, "score": 1, "last_activity_date": 1529526287, "last_edit_date": 1529526287, "creation_date": 1529525496, "answer_id": 50956317, "question_id": 50955991, "link": "https://stackoverflow.com/questions/50955991/rails-5-while-submitting-forms-i-do-not-get-any-errors-but-my-data-is-not-store/50956317#50956317", "title": "rails 5: while submitting forms I do not get any errors but my data is not stored in the database. Why?", "body": "<p>From Rails 5 onwards an association specified using <code>belongs_to</code> is <a href=\"https://github.com/rails/rails/issues/18233\" rel=\"nofollow noreferrer\">required by default</a>. This means a <code>Listing</code> is not valid and won't save if it doesn't have a subcategory.</p>\n\n<p>You can make it optional by changing your model to have:</p>\n\n<pre><code>belongs_to :subcategory, required: false\n</code></pre>\n\n<hr>\n\n<p><code>save</code> will return <code>true</code> if your model passes validation and is saved successfully and <code>false</code> if not. In general, your <code>create</code> and <code>update</code> actions should have a structure that handles this:</p>\n\n<pre><code>if @listing.save\n  redirect_to root_path\nelse\n  # redisplay the form if validation failed\n  render action: 'new'\nend\n</code></pre>\n\n<p>Another tip is that you can use <code>save!</code> which will raise an exception (and so display an error message) if your model fails validation. Changing <code>@listing.save</code> to <code>@listing.save!</code> is a quick way to get a helpful error message telling you why the model isn't being stored.</p>\n"}, {"tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": false, "score": 0, "last_activity_date": 1529525824, "creation_date": 1529525824, "answer_id": 50956378, "question_id": 50955991, "link": "https://stackoverflow.com/questions/50955991/rails-5-while-submitting-forms-i-do-not-get-any-errors-but-my-data-is-not-store/50956378#50956378", "title": "rails 5: while submitting forms I do not get any errors but my data is not stored in the database. Why?", "body": "<blockquote>\n  <p><em>I do not get any errors</em></p>\n</blockquote>\n\n<p><a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Persistence.html#method-i-save\" rel=\"nofollow noreferrer\"><code>@listing.save</code></a> will silently return false if it fails.</p>\n\n<p>You can check for failure, or you can use <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Persistence.html#method-i-save-21\" rel=\"nofollow noreferrer\"><code>@listing.save!</code></a> which will throw an <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/RecordInvalid.html\" rel=\"nofollow noreferrer\">ActiveRecord::RecordInvalid</a> exception if the save fails. In either case you can then <a href=\"http://guides.rubyonrails.org/active_record_validations.html#working-with-validation-errors\" rel=\"nofollow noreferrer\">use <code>@listing.errors</code> or <code>exception.record.errors</code></a> to find out what went wrong.</p>\n"}], "owner": {"reputation": 17, "user_id": 9877702, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4cP-DtVeQvI/AAAAAAAAAAI/AAAAAAAAL4M/sYLm9ZqlRn8/photo.jpg?sz=128", "display_name": "Kabita Bhandari", "link": "https://stackoverflow.com/users/9877702/kabita-bhandari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 50956317, "answer_count": 2, "score": 1, "last_activity_date": 1529526287, "creation_date": 1529524067, "question_id": 50955991, "link": "https://stackoverflow.com/questions/50955991/rails-5-while-submitting-forms-i-do-not-get-any-errors-but-my-data-is-not-store", "title": "rails 5: while submitting forms I do not get any errors but my data is not stored in the database. Why?", "body": "<p>Here is my routes.rb</p>\n\n<pre><code>  root 'categories#index'\n  resources :listings\nresources :categories do\n  resources :subcategories\nend\n</code></pre>\n\n<p>here is my new.html.erb for Listings/ Posts</p>\n\n<pre><code>&lt;div class=\"container\"&gt;\n  &lt;div id=\"contact-area\"&gt;\n    &lt;%= form_for @listing do |f| %&gt;\n      &lt;%= f.label :title %&gt;\n      &lt;%= f.text_field :title %&gt;\n      &lt;%= f.label :description %&gt;\n      &lt;%= f.text_area :description %&gt;\n      &lt;%= f.label :city %&gt;\n      &lt;%= f.text_field :city %&gt;\n      &lt;%= f.label :state %&gt;\n      &lt;%= f.text_field :state %&gt;\n      &lt;%= f.label :zipcode %&gt;\n      &lt;%= f.text_field :zipcode, class: \"zip-width\", maxlength: \"5\" %&gt;\n      &lt;%= f.submit class:\"create-button\" %&gt; \n    &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Here is my listing.rb file::</p>\n\n<pre><code>class Listing &lt; ApplicationRecord\n  belongs_to :subcategory\n  def listing\n        params.require(:listing).permit(:title, :description, :city, :state, :zipcode)\n    end\nend\n</code></pre>\n\n<p>Here is my Controller</p>\n\n<pre><code>class ListingsController &lt; ApplicationController\n  def new\n    @listing = Listing.new\n  end\n\n  def create\n    @listing = Listing.new(listing_params)\n    @listing.save\n    redirect_to root_path\n  end\n  def show\n    @listing = Listing.find(params[:id])\n  end\n\n  private\n  def listing_params\n    params.require(:listing).permit(:title, :description, :city, :state, :zipcode)\n  end\n</code></pre>\n\n<p>I am having the same issue using rails 5. Please let me know if you could solved this.</p>\n\n<p>I am able to create a form but while submitting the form I have an issue, my data are not saved in my database and every time I put query on irb: as  Listing.first, the answer is nil. I did searched online for the issue, they said that check your closing tags on forms, check your route.rb etc. I have verified everything and yet my issue is not resolved.  </p>\n\n<p>Please reply me, i am very beginner at Ruby on Rails.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "rails-activerecord", "singleton-methods"], "answers": [{"tags": [], "owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1529586033, "creation_date": 1529586033, "answer_id": 50969199, "question_id": 50955929, "link": "https://stackoverflow.com/questions/50955929/is-there-any-way-to-access-the-parent-object-whom-called-a-singleton-method/50969199#50969199", "title": "Is there any way to access the Parent object whom called a singleton method?", "body": "<p>Inside your <code>find_each</code> loop, you should be able to use <code>user.account</code>.</p>\n\n<p>Outside that loop, I don't believe there's a documented / supported / won't-disappear-without-warning way to find the object. Depending on your Rails version, something like <code>self.current_scope.proxy_association.owner</code> might give you the answer you need... but do prefer <code>user.account</code> if at all possible: the more you use private APIs, the harder future upgrades can be.</p>\n\n<hr>\n\n<p>Alternatively, consider using <a href=\"http://guides.rubyonrails.org/association_basics.html#association-extensions\" rel=\"nofollow noreferrer\">association extensions</a> to define your <code>do_something</code> method inside the <code>has_many</code> association only -- if it's not suited to be called as <code>User.do_something</code> or <code>User.where(name: \"Bob\").do_something</code> (because those don't have an associated <code>account</code>), maybe it shouldn't be a top-level method after all.</p>\n"}], "owner": {"reputation": 26, "user_id": 8950213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b055097fb63cdb1b2a3a646157d5ce9?s=128&d=identicon&r=PG", "display_name": "ted", "link": "https://stackoverflow.com/users/8950213/ted"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1529586033, "creation_date": 1529523798, "last_edit_date": 1529525105, "question_id": 50955929, "link": "https://stackoverflow.com/questions/50955929/is-there-any-way-to-access-the-parent-object-whom-called-a-singleton-method", "title": "Is there any way to access the Parent object whom called a singleton method?", "body": "<p>Given the following functional snippet I'm having trouble reducing the database queries:</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  belongs_to :account\n\n  def self.do_something\n    self.find_each do |user|\n      puts \"#{self.new.account.name}:#{user.name} did something\"\n    end\n  end\nend\n\nclass Account &lt; ApplicationRecord\n  has_many :users\nend\n\na = Account.first\nputs 'starting'\na.users.do_something\n</code></pre>\n\n<blockquote>\n  <p>Account Load (0.4ms)  SELECT  \"accounts\".* FROM \"accounts\" WHERE\n  \"accounts\".\"id\" = $1 LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]   </p>\n  \n  <p>starting</p>\n  \n  <p>Account Load (0.3ms)  SELECT  \"accounts\".* FROM \"accounts\" WHERE\n  \"accounts\".\"id\" = $1 LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]</p>\n  \n  <p>Test:User did something</p>\n  \n  <p>Account Load (0.3ms)  SELECT  \"accounts\".* FROM \"accounts\" WHERE\n  \"accounts\".\"id\" = $1 LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]</p>\n  \n  <p>Test:User did something</p>\n  \n  <p>Account Load (0.3ms)  SELECT  \"accounts\".* FROM \"accounts\" WHERE\n  \"accounts\".\"id\" = $1 LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]</p>\n  \n  <p>Test:User did something</p>\n  \n  <p>Account Load (0.3ms)  SELECT  \"accounts\".* FROM \"accounts\" WHERE\n  \"accounts\".\"id\" = $1 LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]</p>\n  \n  <p>Test:User did something</p>\n</blockquote>\n\n<p>You can see that the Account model is being fetched from the database per user!</p>\n\n<p>I was hoping to use something like <code>self.account</code> in the Singleton method to reference the original account, but the relationship obviously doesn't exist  by default which is why I'm currently using <code>self.new.account</code>.  </p>\n\n<p>Is there anywhere else I can fetch the original Account model saved in <code>a</code> from inside <code>self.do_something</code>?  I can obviously pass the account in a parameter, but that seems tedious especially if I may add arguments later...</p>\n"}, {"tags": ["json", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 8387455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FSysR.jpg?s=128&g=1", "display_name": "jn4248", "link": "https://stackoverflow.com/users/8387455/jn4248"}, "edited": false, "score": 0, "creation_date": 1529601028, "post_id": 50962331, "comment_id": 88944431, "body": "yilmazgunalp: Thank you for help.  However, adding the line to return the &#39;obj&#39; didn&#39;t  seem to solve my situation.  Perhaps I misunderstood your suggestion...My understanding of the from_json idea, is that we parse the json string (here: &quot;obj&quot;),  and assign each saved portion (eg: person object) to the instance variables of the newly created People object.  So, in your suggesting that I return the json string object (obj), I&#39;m not sure to where I should returning it.  As well, in both versions, it seems that I&#39;m already returning @person implicitly...so still not sure why different results."}], "tags": [], "owner": {"reputation": 21, "user_id": 7107433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a26817c4c725688fc8eef1d4008e2e5?s=128&d=identicon&r=PG", "display_name": "yilmazgunalp", "link": "https://stackoverflow.com/users/7107433/yilmazgunalp"}, "is_accepted": false, "score": 0, "last_activity_date": 1529564617, "creation_date": 1529564617, "answer_id": 50962331, "question_id": 50954784, "link": "https://stackoverflow.com/questions/50954784/converting-ruby-class-object-to-json-and-back-when-containing-other-nested-clas/50962331#50962331", "title": "Converting Ruby class object to JSON and back, when containing other nested class objects (not using Rails or Active Support)", "body": "<p>Your first solution works. You simply forgot to return from  your method. See below:</p>\n\n<pre><code>def from_json(string)\nobj = JSON.parse(string, {:symbolize_names =&gt; true})\nperson = Person.new(\"\", 0, \"\")\n@person = person.from_json(obj[:person])\nobj  #RETURN THE OBJECT HERE\nend\n</code></pre>\n\n<p>In the second solution you are still missing the return value however  Ruby  implicitly returns the last evaluated expression from the method which by chance happens to be correct. This is the same reason why  your first solution didn't work.</p>\n"}], "owner": {"reputation": 41, "user_id": 8387455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FSysR.jpg?s=128&g=1", "display_name": "jn4248", "link": "https://stackoverflow.com/users/8387455/jn4248"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 487, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1529564617, "creation_date": 1529519030, "question_id": 50954784, "link": "https://stackoverflow.com/questions/50954784/converting-ruby-class-object-to-json-and-back-when-containing-other-nested-clas", "title": "Converting Ruby class object to JSON and back, when containing other nested class objects (not using Rails or Active Support)", "body": "<p>I've become confused while writing custom <code>to_json</code> and <code>from_json</code> methods for a class.  I have actually found a solution, but don't understand why it works, nor why my initial attempt does not work.</p>\n\n<p>I have a People class that initializes by taking an instance of a Person class as a paramater.<br>\nThe to_json/from_json methods in Person have been copied in from a generic \nexternal module, and therefore a bit wordy...but worked when I tested it on an individual instance of a Person object.</p>\n\n<p>The problem comes when re-creating the People object from JSON.  For the <code>@person</code> instance variable, I'm expecting: </p>\n\n<pre><code>#&lt;Person:0x00000001a0b440 @name=\"Jon\", @age=22, @gender=\"male\"&gt;\n</code></pre>\n\n<p>Instead, I'm getting @person as an array (and thus, only the keys): </p>\n\n<pre><code>#&lt;People:0x00000001b5c038 @person=[\"@name\", \"@age\", \"@gender\"]&gt;\n</code></pre>\n\n<p>Full code is as follows:</p>\n\n<pre><code>require \"json\"\n\nclass Person\n\n  attr_accessor :name, :age, :gender\n\n  def initialize(name, age, gender)\n    @name = name\n    @age = age\n    @gender = gender\n  end\n\n  def to_json\n    obj = {}\n    instance_variables.map do |var|\n      obj[var] = instance_variable_get(var)\n    end\n    JSON.dump(obj)\n  end\n\n  def from_json(string)\n    obj = JSON.parse(string)\n    obj.keys.each do |key|\n      instance_variable_set(key, obj[key])\n    end\n  end\n\nend\n\nclass People\n\n  attr_accessor :person\n\n  def initialize(person)\n    @person = person\n  end\n\n  def to_json\n    obj = {}\n    obj[:person] = @person.to_json\n    JSON.dump(obj)\n  end\n\n  def from_json(string)\n    obj = JSON.parse(string, {:symbolize_names =&gt; true})\n    person = Person.new(\"\", 0, \"\")\n    @person = person.from_json(obj[:person])\n  end\n\n  def &lt;&lt;(person)\n    @persons &lt;&lt; person\n  end\n\nend\n</code></pre>\n\n<p>After re-writing the <code>to_json</code> and <code>from_json</code> methods as below, the problem seems to have been solved...and now correctly re-assembles @person  as expected. </p>\n\n<pre><code>def to_json\n  obj = {}\n  obj[:persons] = [@person.to_json]\n  JSON.dump(obj)\nend\n\ndef from_json(string)\n  obj = JSON.parse(string, {:symbolize_names =&gt; true})\n  persons = []\n  obj[:persons].each do |person_string|\n    person = Person.new(\"\", 0, \"\")\n    person.from_json(person_string)\n    persons &lt;&lt; person\n  end\n  @person = persons[0]\nend \n</code></pre>\n\n<p>I'm happy to have found a solution, but I can't understand why encasing the single Person object in an array would solve the situation.</p>\n\n<p>I'm sure there are many other ways to solve this particular situation (and other methods completely... eg: other gems, or using Rails Active Support...), but I'm simply trying to get a more solid understanding why my initial idea doesn't work...to help later on when things get more complicated.</p>\n\n<p>Thank you for any help you can offer...</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "edited": false, "score": 0, "creation_date": 1529518951, "post_id": 50954559, "comment_id": 88907127, "body": "NoMethodError (undefined method `toggle_admin&#39; for #&lt;Parent:0x00007fe05328b618&gt;) Did you mean?  toggle! .. there was some problem in the model. now this the error showing up"}], "tags": [], "owner": {"reputation": 3807, "user_id": 2043592, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zCbuL.jpg?s=128&g=1", "display_name": "xploshioOn", "link": "https://stackoverflow.com/users/2043592/xploshioon"}, "is_accepted": true, "score": 0, "last_activity_date": 1529519069, "last_edit_date": 1529519069, "creation_date": 1529518115, "answer_id": 50954559, "question_id": 50954430, "link": "https://stackoverflow.com/questions/50954430/assign-user-as-admin-in-rails-through-rails-console/50954559#50954559", "title": "assign user as admin in rails through rails console", "body": "<p>it seems that the transaction is beign done, remember that toggle doesn't assign true, it changes the false to true a viceversa, depending on the current value that it has. </p>\n\n<p>on the example you are sending, it's changed to true at first but then again to false. you are doing it right talking about code. but maybe there is a callback that changes again the value to false before saving it. Check on your model if there are callbacks or if you have some rules for this.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 50954559, "answer_count": 1, "score": 0, "last_activity_date": 1529522381, "creation_date": 1529517558, "last_edit_date": 1529522381, "question_id": 50954430, "link": "https://stackoverflow.com/questions/50954430/assign-user-as-admin-in-rails-through-rails-console", "title": "assign user as admin in rails through rails console", "body": "<p>I am trying to assign parent as superadmin. when i run the command parent.toggle!(superadmin) it doesnt assign the parent as superadmin.</p>\n\n<p>I am not able to locate the error</p>\n\n<pre><code>irb(main):004:0&gt; parent.toggle!(:superadmin)\n   (0.2ms)  begin transaction\n  Parent Update (0.6ms)  UPDATE \"parents\" SET \"updated_at\" = ?, \"superadmin\" = ? WHERE \"parents\".\"id\" = ?  [[\"updated_at\", \"2018-06-20 17:50:31.273816\"], [\"superadmin\", 1], [\"id\", 1]]\n  Parent Update (0.2ms)  UPDATE \"parents\" SET \"updated_at\" = ?, \"superadmin\" = ? WHERE \"parents\".\"id\" = ?  [[\"updated_at\", \"2018-06-20 17:50:31.280343\"], [\"superadmin\", 0], [\"id\", 1]]\n   (1.8ms)  commit transaction\n=&gt; true\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 3, "creation_date": 1529517598, "post_id": 50954407, "comment_id": 88906506, "body": "<code>ENV</code> is a class so you can&#39;t include it, call it like this <code>::ENV[&quot;HOME&quot;]</code>"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1529598431, "post_id": 50954407, "comment_id": 88943058, "body": "Are you sure this is even worthwhile? <code>BasicObject</code> is more about namespace pollution than performance and you&#39;re already opening files (which you could do by hand with <code>File</code>), parsing YAML, ..."}, {"owner": {"reputation": 59, "user_id": 9830334, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2f6X.jpg?s=128&g=1", "display_name": "CaptainKidd", "link": "https://stackoverflow.com/users/9830334/captainkidd"}, "edited": false, "score": 0, "creation_date": 1529601365, "post_id": 50954407, "comment_id": 88944592, "body": "I&#39;m not sure but I can post results once I figure it out."}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1529598854, "post_id": 50973466, "comment_id": 88943282, "body": "Just like <code>::ENV</code> you have to write <code>include ::Kernel</code>"}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1529598949, "post_id": 50973466, "comment_id": 88943334, "body": "Thanks. I was running in <code>irb</code> for this, and forgot about that case :D"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1529601281, "post_id": 50973466, "comment_id": 88944552, "body": "If <code>Kernel#open</code> is the only objective then <code>define_method(:open,&amp;::Kernel.instance_method(:open).bind(se&zwnj;&#8203;lf))</code> would work."}, {"owner": {"reputation": 59, "user_id": 9830334, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2f6X.jpg?s=128&g=1", "display_name": "CaptainKidd", "link": "https://stackoverflow.com/users/9830334/captainkidd"}, "edited": false, "score": 0, "creation_date": 1529601308, "post_id": 50973466, "comment_id": 88944564, "body": "@kiddorails Can you walk me through the meta programming in MyBasicObject?"}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1529601629, "post_id": 50973466, "comment_id": 88944732, "body": "@engineersmnky or just <code>define_method(:open, &amp;::Kernel.method(:open))</code>. Edit: Just saw your edit to reflect the same :)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1529601745, "post_id": 50973466, "comment_id": 88944801, "body": "@kiddorails I forgot that <code>Kernel</code> exposed its methods as <code>module_functions</code> +1"}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "reply_to_user": {"reputation": 59, "user_id": 9830334, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2f6X.jpg?s=128&g=1", "display_name": "CaptainKidd", "link": "https://stackoverflow.com/users/9830334/captainkidd"}, "edited": false, "score": 0, "creation_date": 1529601788, "post_id": 50973466, "comment_id": 88944830, "body": "@CaptainKidd <code>instance_methods</code> gives the list of instance methods(included inherited) in that class, in <code>MyBasicObject</code>, I&#39;m iterating on them, and calling <code>undef_method</code> on the ones I do not need. <code>undef_method</code> will then <i>undefine</i> those methods for that class, making it <i>lightweight</i>."}, {"owner": {"reputation": 59, "user_id": 9830334, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2f6X.jpg?s=128&g=1", "display_name": "CaptainKidd", "link": "https://stackoverflow.com/users/9830334/captainkidd"}, "edited": false, "score": 0, "creation_date": 1529604829, "post_id": 50973466, "comment_id": 88946356, "body": "I am getting error undefined method for define_method."}, {"owner": {"reputation": 59, "user_id": 9830334, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2f6X.jpg?s=128&g=1", "display_name": "CaptainKidd", "link": "https://stackoverflow.com/users/9830334/captainkidd"}, "edited": false, "score": 0, "creation_date": 1529604966, "post_id": 50973466, "comment_id": 88946423, "body": "@kiddorails Ok I tried it like that.. Now I get this error: &#39;code&#39; An error occurred while  Failure/Error:   load_page_object_file(open(&quot;#     {home_dir}/code/automate_shared/lib/shared_page_objects.yml&quot;&zwnj;&#8203;))  Errno::EINVAL:   Invalid argument @ rb_sysopen - #       {home_dir}/code/automate_shared/lib/shared_page_objects.yml # ./spec/support/page_object.rb:12:in `initialize&#39;"}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1529605065, "post_id": 50973466, "comment_id": 88946469, "body": "that&#39;s your code issue. this is the error generated by <code>open</code> with whatever you are trying to open. Please debug futher, that is out of scope of this question. :) Hope this helps"}], "tags": [], "owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "is_accepted": true, "score": 2, "last_activity_date": 1529598929, "last_edit_date": 1529598929, "creation_date": 1529598664, "answer_id": 50973466, "question_id": 50954407, "link": "https://stackoverflow.com/questions/50954407/inherit-from-basicobject-to-increase-performance/50973466#50973466", "title": "Inherit from BasicObject to Increase Performance", "body": "<p>I'm not sure what performance objectives you have, which using <code>BasicObject</code> can solve, but these are the <em>instance methods</em> available in <code>Object</code>, which are not available in <code>BasicObject</code>. </p>\n\n<pre><code>Object.instance_methods - BasicObject.instance_methods\n#=&gt;  [:instance_of?, :kind_of?, :is_a?, :tap, :public_send, :method, :public_method, :singleton_method, :remove_instance_variable, :define_singleton_method, :instance_variable_set, :extend, :to_enum, :enum_for, :&lt;=&gt;, :===, :=~, :!~, :eql?, :respond_to?, :freeze, :inspect, :object_id, :send, :display, :to_s, :nil?, :hash, :class, :singleton_class, :clone, :dup, :itself, :taint, :tainted?, :untaint, :untrust, :untrusted?, :trust, :frozen?, :methods, :singleton_methods, :protected_methods, :private_methods, :public_methods, :instance_variable_get, :instance_variables, :instance_variable_defined?]\n</code></pre>\n\n<p>Since you want few methods from <code>Object</code>, instead of using <code>BasicObject</code>, you can create a new class and undefine the methods you do not need.</p>\n\n<pre><code>class MyBasicObject\n  instance_methods.each do |m|\n    next if [:instance_of?, :is_a?].include?(m)\n    undef_method m\n  end\nend\nclass PageObject &lt; MyBasicObject\n  def initialize\n     home_dir = ::ENV[\"HOME\"]\n     load_page_object_file(open(\"# \n    {home_dir}/code/automate_shared/lib/shared_page_objects.yml\"))\n    load_page_object_file(open(\"#{home_dir}/code/automate_shared/lib/urls.yml\"))\n    load_page_object_file('spec/support/page_objects.yml')\n  end\nend\n</code></pre>\n\n<p>However, if your objective is to just make <code>open</code> work, please note that <code>open</code> is a method of <code>Kernel</code> module and is not an instance method of <code>Object</code>. You can simplify your particular case with <code>BasicObject</code> by <code>include</code>ing <code>Kernel</code> module explicitly in your class.</p>\n\n<pre><code> class PageObject &lt; BasicObject\n   include ::Kernel\n   def initialize\n     home_dir = ::ENV[\"HOME\"]\n     load_page_object_file(open(\"# \n    {home_dir}/code/automate_shared/lib/shared_page_objects.yml\"))\n    load_page_object_file(open(\"#{home_dir}/code/automate_shared/lib/urls.yml\"))\n    load_page_object_file('spec/support/page_objects.yml')\n   end\n end\n</code></pre>\n\n<p>PS: Thanks to @anthony for pointing to correct usage of <code>::ENV</code></p>\n"}], "owner": {"reputation": 59, "user_id": 9830334, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2f6X.jpg?s=128&g=1", "display_name": "CaptainKidd", "link": "https://stackoverflow.com/users/9830334/captainkidd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 1, "accepted_answer_id": 50973466, "answer_count": 1, "score": 3, "last_activity_date": 1529598929, "creation_date": 1529517466, "question_id": 50954407, "link": "https://stackoverflow.com/questions/50954407/inherit-from-basicobject-to-increase-performance", "title": "Inherit from BasicObject to Increase Performance", "body": "<p>I am investigating whether I can increase performance by having my PageObjects class inherit from BasicObject. The rationale is that BasicObjects has far fewer built in methods than a regular object. However, I am running into this error: </p>\n\n<pre><code> &lt;class:PageObject&gt;': uninitialized constant PageObject::ENV (NameError)\n Did you mean?  ENV\n</code></pre>\n\n<p>I've tried various ways to import env.rb (BasicObject doesn't have this built in) but I keep getting errors. Here's one attempt at importing it.</p>\n\n<pre><code> class PageObject &lt; BasicObject\n   include ENV\n   def initialize\n     home_dir = ENV[\"HOME\"]\n     load_page_object_file(open(\"# \n    {home_dir}/code/automate_shared/lib/shared_page_objects.yml\"))\n    load_page_object_file(open(\"#{home_dir}/code/automate_shared/lib/urls.yml\"))\n    load_page_object_file('spec/support/page_objects.yml')\n   end\n end\n</code></pre>\n\n<p>How do I import class methods from rubystubs library?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "activerecord", "form-helpers"], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 8921559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb80c4dd148cdf23e439fb3982bca855?s=128&d=identicon&r=PG&f=1", "display_name": "kdubss", "link": "https://stackoverflow.com/users/8921559/kdubss"}, "edited": false, "score": 0, "creation_date": 1529517895, "post_id": 50954269, "comment_id": 88906634, "body": "Thanks for the feedback, @xploshioOn!  I actually found out about this by reading through the docs and lots of experimenting! :)"}], "tags": [], "owner": {"reputation": 3807, "user_id": 2043592, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zCbuL.jpg?s=128&g=1", "display_name": "xploshioOn", "link": "https://stackoverflow.com/users/2043592/xploshioon"}, "is_accepted": true, "score": 1, "last_activity_date": 1529517017, "creation_date": 1529517017, "answer_id": 50954269, "question_id": 50953893, "link": "https://stackoverflow.com/questions/50953893/setting-up-grouped-options-for-the-f-select-form-helper/50954269#50954269", "title": "Setting up grouped options for the f.select form helper", "body": "<p>You can do it mapping the collection and then grouping it by a value in the array, for example</p>\n\n<pre><code>&lt;%= f.select(:location_id, grouped_options_for_select(Location.all.map{|l| [l.name, l.category_name, l.id]}.group_by { |c| c[1] }), {include_blank: \"Select one...\"}, {:class =&gt; 'grouped_select',id:\"location_grouped\"}) %&gt;\n</code></pre>\n\n<p>This will create the select, grouped by category_name.</p>\n"}], "owner": {"reputation": 313, "user_id": 8921559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb80c4dd148cdf23e439fb3982bca855?s=128&d=identicon&r=PG&f=1", "display_name": "kdubss", "link": "https://stackoverflow.com/users/8921559/kdubss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 50954269, "answer_count": 1, "score": 1, "last_activity_date": 1529517017, "creation_date": 1529515610, "question_id": 50953893, "link": "https://stackoverflow.com/questions/50953893/setting-up-grouped-options-for-the-f-select-form-helper", "title": "Setting up grouped options for the f.select form helper", "body": "<p>I'm curious on how I would go about creating a dropdown menu with locations that are grouped into categories in my Rails app.</p>\n\n<p>A previous suggestion is to try the f.select_tag with the grouped_options_for_select form helpers.\nThis did work, but when the user on the front end chose a location, the request wasn't being passed to the controller and hence, the location string is not showing up on the location confirmation page...</p>\n\n<p>Reading the docs, I'm to use the f.select form helper if I'm to do this with Models, but <strong>I'm curious to know if I can create grouped options with this form helper</strong></p>\n\n<p>Here's the code using the <strong>f.select_tag helper (in a slim template-view)</strong>:</p>\n\n<pre><code>f.select_tag :location_id, grouped_options_for_select(grouped_locations_hash), { include_blank: true }, class: 'form-control'\n</code></pre>\n\n<p>Using the above helper, the user selection for location on the front end is not being passed to the controller.</p>\n\n<p>Attempting with the <strong>f.select form helper</strong>,</p>\n\n<pre><code>f.select :location_id, options_from_collection_for_select(locations_array, :id, :name), { include_blank: true }, class: 'form-control'\n</code></pre>\n\n<p>...the user selection is being passed, <strong>but</strong>, the dropdown menu does not have the locations grouped into categories (which I would like).</p>\n\n<p>Any suggestions and or references from the community??</p>\n\n<p>Many thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "video", "refresh"], "comments": [{"owner": {"reputation": 1796, "user_id": 804055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/038f23024506f6b2e9b07419f4b4e197?s=128&d=identicon&r=PG", "display_name": "Matt McClure", "link": "https://stackoverflow.com/users/804055/matt-mcclure"}, "edited": false, "score": 0, "creation_date": 1529529756, "post_id": 50953864, "comment_id": 88911843, "body": "Are you using Turbolinks? It looks like it based on some of the markup, but just confirming."}, {"owner": {"reputation": 1, "user_id": 7371578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5ef166820f7245d7f4ee95f1a378bf1?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Parsons", "link": "https://stackoverflow.com/users/7371578/eric-parsons"}, "reply_to_user": {"reputation": 1796, "user_id": 804055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/038f23024506f6b2e9b07419f4b4e197?s=128&d=identicon&r=PG", "display_name": "Matt McClure", "link": "https://stackoverflow.com/users/804055/matt-mcclure"}, "edited": false, "score": 0, "creation_date": 1529603395, "post_id": 50953864, "comment_id": 88945662, "body": "@MattMcClure upon inspection I am using turbolinks.  I disabled them by removing the gem from my Gemfile.  This seems to have fixed the issue when running the app locally, however in production the problem still persists."}, {"owner": {"reputation": 1, "user_id": 7371578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5ef166820f7245d7f4ee95f1a378bf1?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Parsons", "link": "https://stackoverflow.com/users/7371578/eric-parsons"}, "reply_to_user": {"reputation": 1796, "user_id": 804055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/038f23024506f6b2e9b07419f4b4e197?s=128&d=identicon&r=PG", "display_name": "Matt McClure", "link": "https://stackoverflow.com/users/804055/matt-mcclure"}, "edited": false, "score": 0, "creation_date": 1529610284, "post_id": 50953864, "comment_id": 88948810, "body": "Nevermind, forgot to precompile my assets again, removing turboklinks did the fix! :)"}, {"owner": {"reputation": 1796, "user_id": 804055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/038f23024506f6b2e9b07419f4b4e197?s=128&d=identicon&r=PG", "display_name": "Matt McClure", "link": "https://stackoverflow.com/users/804055/matt-mcclure"}, "edited": false, "score": 0, "creation_date": 1529628833, "post_id": 50953864, "comment_id": 88954310, "body": "Great! Glad to hear you got it working :)"}], "owner": {"reputation": 1, "user_id": 7371578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5ef166820f7245d7f4ee95f1a378bf1?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Parsons", "link": "https://stackoverflow.com/users/7371578/eric-parsons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1529516527, "creation_date": 1529515512, "last_edit_date": 1529516527, "question_id": 50953864, "link": "https://stackoverflow.com/questions/50953864/video-image-glitch-in-rails-app-on-page-change", "title": "Video/image glitch in Rails App on page change", "body": "<p>I'm experiencing a weird glitch in my rails app located here: <a href=\"https://tcndapp.herokuapp.com/\" rel=\"nofollow noreferrer\">https://tcndapp.herokuapp.com/</a></p>\n\n<p>My home page has a video background on it that loads correctly initially, but I'm facing an issue where when I go to a separate page (like the about page for instance) and then return the homepage, the video doesn't load, and it actually loads and displays the wide background image from the previous page, and then if I do a hard refresh then the video will load like normally, and that seems to be the only way to fix it.  I have the video linked as so in my index page and have tried using a video_tag instead with no luck.  This behavior also occurs both in production and development mode.</p>\n\n<pre><code>&lt;video preload=\"true\" autoplay loop muted playsinline&gt;\n   &lt;source src=\"&lt;%= image_url('main.webm') %&gt;\" type=\"video/webm\"&gt;\n    &lt;source src=\"&lt;%= image_url('main.mp4') %&gt;\" type=\"video/mp4\"&gt;\n&lt;/video&gt;\n</code></pre>\n"}, {"tags": ["ruby", "debugging", "installation", "ide"], "comments": [{"owner": {"reputation": 734, "user_id": 284000, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c9693f95b01f67e1d5e64410dec9f9da?s=128&d=identicon&r=PG", "display_name": "brianfeucht", "link": "https://stackoverflow.com/users/284000/brianfeucht"}, "edited": false, "score": 0, "creation_date": 1529508040, "post_id": 50951562, "comment_id": 88901067, "body": "You will likely get better answers if you include the text of the error and reproduction steps rather than a screenshot.  Doing this will allow others who run into the same issue to find your question and hopefully an answer."}, {"owner": {"reputation": 1, "user_id": 9968203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33038bab81fd3c59fd211dcbecd7365f?s=128&d=identicon&r=PG&f=1", "display_name": "muratp", "link": "https://stackoverflow.com/users/9968203/muratp"}, "reply_to_user": {"reputation": 734, "user_id": 284000, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c9693f95b01f67e1d5e64410dec9f9da?s=128&d=identicon&r=PG", "display_name": "brianfeucht", "link": "https://stackoverflow.com/users/284000/brianfeucht"}, "edited": false, "score": 0, "creation_date": 1529508644, "post_id": 50951562, "comment_id": 88901458, "body": "Here is more info:  C:\\Ruby24-x64&gt;gem install ruby-debug-ide-0.7.0.beta4.gem --http-proxy <a href=\"http://proxy.xxxxx\" rel=\"nofollow noreferrer\">proxy.xxxxx</a> (Note I know proxy work because other gems install fine) Building native extensions.  This could take a while... ERROR:  Error installing ruby-debug-ide-0.7.0.beta4.gem:         ERROR: Failed to build gem native extension.     current directory: C:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/ruby-debug-ide-0.7.0.&zwnj;&#8203;beta4/ext C:/Ruby24-x64/bin/ruby.exe mkrf_conf.rb  Unable to resolve dependency: user requested &#39;debase (&gt; 0)&#39;"}], "owner": {"reputation": 1, "user_id": 9968203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33038bab81fd3c59fd211dcbecd7365f?s=128&d=identicon&r=PG&f=1", "display_name": "muratp", "link": "https://stackoverflow.com/users/9968203/muratp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529507535, "creation_date": 1529507535, "question_id": 50951562, "link": "https://stackoverflow.com/questions/50951562/ruby-debug-ide-0-6-1-or-0-7-x-x-beta-installation-issues-on-a-windows-10", "title": "ruby-debug-ide 0.6.1 or 0.7.x.x beta installation issues on a Windows 10", "body": "<p>Even though I have debase 0.2.2 installed, I am seeing the rake failed message no matter what.  I am on a Windows 10 machine.  I also have the DEVKIT properly installed with the option 3 selected.  I used rubyinstaller-devkit-2.4.4-1-x64 as ruby version on this computer.<a href=\"https://i.stack.imgur.com/Z035F.png\" rel=\"nofollow noreferrer\">enter image description here</a>\nI wish the log message gave more specific info.  I also tried the --pre flag and other posts on the net to no luck...any ideas or recommendations.\nSee the attached image. </p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ruby", "regex", "string", "replace"], "comments": [{"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 1, "creation_date": 1529510215, "post_id": 50951406, "comment_id": 88902486, "body": "This is the obligatory comment that you should probably be using a proper XML parser instead of regex e.g. Nokogiri."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 4, "creation_date": 1529511888, "post_id": 50951406, "comment_id": 88903502, "body": "Or to be more specific, obligatory: <a href=\"https://stackoverflow.com/a/1732454/1954610\"><b>TH\u0318E\u0344\u0309\u0356 \u0360P\u032f\u034d\u032dO\u031a\u200bN\u0310Y\u0321 H\u0368\u034a\u033d\u0305\u033e\u030e\u0321\u0338\u032a\u032fE\u033e\u035b\u036a\u0344\u0300\u0301\u0327\u0358\u032c\u0329 \u0367\u033e\u036c\u0327\u0336\u0328\u0331\u0339\u032d\u032fC\u036d\u030f\u0365\u036e\u035f\u0337\u0319\u0332\u031d\u0356O\u036e\u034f\u032e\u032a\u031d\u034dM\u034a\u0312\u031a\u036a\u0369\u036c\u031a\u035c\u0332\u0316E\u0311\u0369\u034c\u035d\u0334\u031f\u031f\u0359\u031eS\u036f\u033f\u0314\u0328\u0340\u0325\u0345\u032b\u034e\u032d</b></a>&zwnj;&#8203;. Regex is fine for a &quot;quick and dirty&quot; solution, but in general it is <i>not</i> the right way to do handle XML. (What if the password contains a <code>&lt;</code> character? What if that portion of xml is commented out? What if there&#39;s an attribute on the field, like <code>&lt;password validated=&#39;true&#39;&gt;</code>? What if there&#39;s a blank password attribute, like <code>&lt;password &#47;&gt;</code> or  <code>&lt;password&gt;&lt;&#47;password&gt;</code>? ... And so on.)"}], "answers": [{"tags": [], "owner": {"reputation": 31555, "user_id": 677684, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5a785c03c08d7de6a15aaea326835cd6?s=128&d=identicon&r=PG", "display_name": "Tilo", "link": "https://stackoverflow.com/users/677684/tilo"}, "is_accepted": false, "score": 2, "last_activity_date": 1529528524, "last_edit_date": 1529528524, "creation_date": 1529508343, "answer_id": 50951830, "question_id": 50951406, "link": "https://stackoverflow.com/questions/50951406/ruby-gsub-with-string-manipulation/50951830#50951830", "title": "Ruby gsub with string manipulation", "body": "<p>This will work:</p>\n\n<pre><code>require 'digest'\n\nline = \"&lt;other&gt;stuff&lt;/other&gt;&lt;password&gt;check1&lt;/password&gt;&lt;more&gt;more&lt;/more&gt;\"\n\nline.sub(/&lt;password&gt;(?&lt;pwd&gt;[^&lt;]+)&lt;\\/password&gt;/, Digest::SHA2.hexdigest(pwd))\n\n =&gt; \"&lt;other&gt;stuff&lt;/other&gt;8a859fd2a56cc37285bc3e307ef0d9fc1d2ec054ea3c7d0ec0ff547cbfacf8dd&lt;more&gt;more&lt;/more&gt;\"\n</code></pre>\n\n<p>Make sure the input is one line at a time, and you'll probably want <code>sub</code>, not <code>gsub</code></p>\n\n<p>P.S.: agree with Tom Lord's comment.. if your XML is not gargantuan in size, try to use an XML library to parse it... Ox or Nokogiri perhaps?\nDifferent libraries have different advantages.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1529556610, "last_edit_date": 1529556610, "creation_date": 1529517409, "answer_id": 50954388, "question_id": 50951406, "link": "https://stackoverflow.com/questions/50951406/ruby-gsub-with-string-manipulation/50954388#50954388", "title": "Ruby gsub with string manipulation", "body": "<p>This is a variant of <a href=\"https://stackoverflow.com/users/677684/tilo\">Tilo</a>'s answer.</p>\n\n<pre><code>require 'digest'\n\nline = \"&lt;other&gt;stuff&lt;/other&gt;&lt;password&gt;check1&lt;/password&gt;&lt;more&gt;more&lt;/more&gt;\"\n\nr = /(?&lt;=&lt;password&gt;).+?(?=&lt;\\/password&gt;)/\n\nline.sub(r) { |pwd| Digest::SHA2.hexdigest(pwd) }\n   #=&gt; \"&lt;other&gt;stuff&lt;/other&gt;&lt;password&gt;8a859fd2a56cc37285bc3e307ef0d9f\n   #    c1d2ec054ea3c7d0ec0ff547cbfacf8dd&lt;/password&gt;&lt;more&gt;more&lt;/more&gt;\"\n</code></pre>\n\n<p>(I've displayed the returned string on two lines so make it readable without the need for horizontal scrolling.)</p>\n\n<p>The regular expression reads, \"match <code>'&lt;password&gt;'</code> in a positive lookbehind (<code>(?&lt;=...)</code>), followed by any number of characters, lazily (<code>'?'</code>), followed by the string <code>'&lt;/password&gt;'</code> in a positive lookahead (<code>(?=...)</code>).</p>\n"}], "owner": {"reputation": 3420, "user_id": 1528988, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/NxiGR.jpg?s=128&g=1", "display_name": "Aravindhan", "link": "https://stackoverflow.com/users/1528988/aravindhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1529556610, "creation_date": 1529507118, "last_edit_date": 1529507435, "question_id": 50951406, "link": "https://stackoverflow.com/questions/50951406/ruby-gsub-with-string-manipulation", "title": "Ruby gsub with string manipulation", "body": "<p>I am new to ruby and writing the expression to replace the string between the xml tags by hashing the value inside that.</p>\n\n<p>I did the following to replace with the new password</p>\n\n<pre><code>puts \"&lt;password&gt;check1&lt;/password&gt;\".gsub(/(?&lt;=password\\&gt;)[^\\/]+(?=\\&lt;\\/password)/,'New \\0')\nRESULT: &lt;password&gt;New check1&lt;/password&gt; (EXPECTED)\n</code></pre>\n\n<p>My expectation is to get the result like this (Md5 checksum of the value \"New check1\")</p>\n\n<pre><code>&lt;password&gt;6aaf125b14c97b307c85fc6e681c410e&lt;/password&gt;\n</code></pre>\n\n<p>I tried it in the following ways and none of them was successful (I have included the required libraries \"require 'digest'\").</p>\n\n<pre><code>puts \"&lt;password&gt;check1&lt;/password&gt;\".gsub(/(?&lt;=password\\&gt;)[^\\/]+(?=\\&lt;\\/password)/,Digest::MD5.hexdigest('\\0'))\nputs \"&lt;password&gt;check1&lt;/password&gt;\".gsub(/(?&lt;=password\\&gt;)[^\\/]+(?=\\&lt;\\/password)/,Digest::MD5.hexdigest '\\0')\nputs \"&lt;password&gt;check1&lt;/password&gt;\".gsub(/(?&lt;=password\\&gt;)[^\\/]+(?=\\&lt;\\/password)/, \"Digest::MD5.hexdigest \\0\")\n</code></pre>\n\n<p>Any help on this to achieve the expectation is very much appreciated</p>\n"}, {"tags": ["ruby", "regex", "gsub"], "comments": [{"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 1, "creation_date": 1529505931, "post_id": 50950317, "comment_id": 88899601, "body": "use <code>\\1</code> etc in case of ruby.  <code>&quot;kiddorails&quot;.gsub(&#47;(kid)do.*&#47;, &#39;\\1oruby&#39;) #=&gt; &#39;kidoruby&#39;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1001, "user_id": 2945977, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c76f28b6eccfe32b63a559aac74a9be5?s=128&d=identicon&r=PG&f=1", "display_name": "sonic", "link": "https://stackoverflow.com/users/2945977/sonic"}, "edited": false, "score": 0, "creation_date": 1529514703, "post_id": 50952495, "comment_id": 88905026, "body": "thanks it works but my regexp isnt perfect. I would like to replace the last match and not append rest. i mean I have <code>str=asdasdasd&#47;s3&#47;aws4_request\\nSomethingMore</code>and i want to replace this with this <code>\\1&#47;s3&#47;aws4</code>+&quot;\\n&quot;` but not append <code>SomethingMore</code>."}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "reply_to_user": {"reputation": 1001, "user_id": 2945977, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c76f28b6eccfe32b63a559aac74a9be5?s=128&d=identicon&r=PG&f=1", "display_name": "sonic", "link": "https://stackoverflow.com/users/2945977/sonic"}, "edited": false, "score": 0, "creation_date": 1529514996, "post_id": 50952495, "comment_id": 88905184, "body": "<code>SomethingMore</code> isn&#39;t getting appended as you can see in example in my answer. Can you give a more definite sample string, pattern and expectation?"}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "reply_to_user": {"reputation": 1001, "user_id": 2945977, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c76f28b6eccfe32b63a559aac74a9be5?s=128&d=identicon&r=PG&f=1", "display_name": "sonic", "link": "https://stackoverflow.com/users/2945977/sonic"}, "edited": false, "score": 1, "creation_date": 1529515986, "post_id": 50952495, "comment_id": 88905716, "body": "@hodiecode updated my answer to reflect the correct regex you should be using."}, {"owner": {"reputation": 1001, "user_id": 2945977, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c76f28b6eccfe32b63a559aac74a9be5?s=128&d=identicon&r=PG&f=1", "display_name": "sonic", "link": "https://stackoverflow.com/users/2945977/sonic"}, "edited": false, "score": 0, "creation_date": 1529517075, "post_id": 50952495, "comment_id": 88906262, "body": "Thanks a lot. What i wanted to do is to translete this to ruby <code>$stringToSign = preg_replace(&quot;&#47;^(.+)\\&#47;s3\\&#47;aws4_request\\\\n.+$&#47;s&quot;, &#39;$1&#47;s3&#47;aws4_request&#39;.&quot;\\n&quot;.$hashedCanonicalRequest, $rawStringToSign)</code> the thing is it supposed to change all after aws4_request. Why then here is the operator <code>&#47;s</code> not <code>&#47;m</code>"}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "reply_to_user": {"reputation": 1001, "user_id": 2945977, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c76f28b6eccfe32b63a559aac74a9be5?s=128&d=identicon&r=PG&f=1", "display_name": "sonic", "link": "https://stackoverflow.com/users/2945977/sonic"}, "edited": false, "score": 0, "creation_date": 1529517419, "post_id": 50952495, "comment_id": 88906425, "body": "These are called as regex modifiers. <code>&#47;s</code> in PHP/Java etc is PCRE-DOTALL modifier, which matches all characters (including newlines), ruby implements it with <code>&#47;m</code>. So, in hindsight, your regex is perfect if you could replace <code>&#47;s</code> at with <code>&#47;m</code>"}, {"owner": {"reputation": 1001, "user_id": 2945977, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c76f28b6eccfe32b63a559aac74a9be5?s=128&d=identicon&r=PG&f=1", "display_name": "sonic", "link": "https://stackoverflow.com/users/2945977/sonic"}, "edited": false, "score": 1, "creation_date": 1529517499, "post_id": 50952495, "comment_id": 88906463, "body": "Thanks kiddorails for patience with explaining everything !!"}], "tags": [], "owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "is_accepted": true, "score": 1, "last_activity_date": 1529515926, "last_edit_date": 1529515926, "creation_date": 1529510372, "answer_id": 50952495, "question_id": 50950317, "link": "https://stackoverflow.com/questions/50950317/ruby-gsub-and-ordering-replacement-like-in-preg-replace/50952495#50952495", "title": "ruby gsub and ordering replacement like in preg_replace", "body": "<p>Use <code>\\1</code> etc to used captured groups in replacement:</p>\n\n<pre><code>str = 'http://s3.amazonaws.com/prod/s3/aws4_request\\nfoo'\npattern = /^(.+)\\/s3\\/aws4_request\\\\n.+$/\nstr.gsub(pattern, '\\1/s3/aws4'+\"\\n\")\n# =&gt; \"http://s3.amazonaws.com/prod/s3/aws4\\n\"\n</code></pre>\n\n<p><strong>Edit</strong>:</p>\n\n<pre><code> str = \"AWS4-HMAC-SHA256\\n20180620T172236Z\\n20180620/eu-west-2/s3/aws4_request\\nPOST\\n/65f9a73f-f7f5-4e9e-8e0e-e1c6afaa83c9.jpg\\nuploads=\"\n\n pattern =  /^(.+)\\/s3\\/aws4_request.*/m # .* to capture everythign after aws_request, m for multiline, let's regex scan across \\n\n str.gsub(pattern, '\\1/s3/aws4'+\"\\n\")\n #=&gt; \"AWS4-HMAC-SHA256\\n20180620T172236Z\\n20180620/eu-west-2/s3/aws4\\n\"\n</code></pre>\n"}], "owner": {"reputation": 1001, "user_id": 2945977, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c76f28b6eccfe32b63a559aac74a9be5?s=128&d=identicon&r=PG&f=1", "display_name": "sonic", "link": "https://stackoverflow.com/users/2945977/sonic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 50952495, "answer_count": 1, "score": 0, "last_activity_date": 1529515926, "creation_date": 1529503974, "last_edit_date": 1529515515, "question_id": 50950317, "link": "https://stackoverflow.com/questions/50950317/ruby-gsub-and-ordering-replacement-like-in-preg-replace", "title": "ruby gsub and ordering replacement like in preg_replace", "body": "<p>I have folowing function from php</p>\n\n<pre><code>pattern = \"/^(.+)\\/s3\\/aws4_request\\\\n.+$/s\"\nresult = preg_replace(pattern,'$1/s3aws4_request'.\"\\n\".$hashedCanonicalRequest, $rawStringToSign);\n</code></pre>\n\n<p>in ruby</p>\n\n<pre><code>pattern = /^(.+)\\/s3\\/aws4_request\\\\n.+$/\nresult = params[:headers].gsub(pattern, \"$1/s3/aws4\"+\"\\n\"+hashed)\n</code></pre>\n\n<p>How to make ordering work in gsub ? I mean those $1 and $ ? can u explain ?</p>\n\n<p>Update full</p>\n\n<pre><code>Parameters: {\"headers\"=&gt;\"AWS4-HMAC-SHA256\\n20180620T172236Z\\n20180620/eu-west-2/s3/aws4_request\\nPOST\\n/65f9a73f-f7f5-4e9e-8e0e-e1c6afaa83c9.jpg\\nuploads=\"}\nhashedCanonicalRequest = \"test\"\npattern_two = /^(.+)\\/s3\\/aws4_request\\n.+$/\nstringToSign =  params[:headers].gsub(pattern_two, '\\1/s3/aws4_request'+\"\\n\"+ hashedCanonicalRequest)\n# \"AWS4-HMAC-SHA256\\n20180620T172051Z\\n20180620/eu-west-2/s3/aws4_request\\ntest\\n/65f9a73f-f7f5-4e9e-8e0e-e1c6afaa83c9.jpg\\nuploads=\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "sinatra"], "comments": [{"owner": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "edited": false, "score": 0, "creation_date": 1529503962, "post_id": 50949735, "comment_id": 88898184, "body": "You can try <code>Dir.pwd</code> to get current working directory of a project. But I would solve this problem by treating differently Rails and Sinatra - <code>Rails.root</code> for rails and <code>settings.root</code> for Sinatra. Just check if <code>Rails::VERSION</code> is defined - if so, use rails way, otherwise - Sinatra."}], "answers": [{"tags": [], "owner": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "is_accepted": true, "score": 1, "last_activity_date": 1529503826, "creation_date": 1529503826, "answer_id": 50950259, "question_id": 50949735, "link": "https://stackoverflow.com/questions/50949735/gem-shared-between-rails-and-sinatra-applications/50950259#50950259", "title": "Gem shared between Rails and Sinatra applications", "body": "<p>Since both Rails and Sinatra are based on Rack, I would try to get the project root directory with <a href=\"https://stackoverflow.com/a/22861228\"><code>Rack::Directory.new('').root</code></a> and join it with logger file's relative path.</p>\n\n<pre><code>project_root = Rack::Directory.new('').root\nlogger_path = Pathname.new(project_root).join('log/production.log')\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9187545, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rNgCM4HsCeE/AAAAAAAAAAI/AAAAAAAAAVY/Cpzh723widE/photo.jpg?sz=128", "display_name": "Anna Matveev", "link": "https://stackoverflow.com/users/9187545/anna-matveev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 50950259, "answer_count": 1, "score": 1, "last_activity_date": 1529503826, "creation_date": 1529502172, "last_edit_date": 1529502936, "question_id": 50949735, "link": "https://stackoverflow.com/questions/50949735/gem-shared-between-rails-and-sinatra-applications", "title": "Gem shared between Rails and Sinatra applications", "body": "<p>I'm writing a gem of my own which is shared between a Sinatra app and a Rails app.</p>\n\n<p>The gem generates a logger which will write to a default location - \"/log/[logger_name]\" in the project root directory.\nMy problem is that I have no way of computing the project root directory which will be common between both apps. </p>\n\n<p>Is there a way to compute the path which the project is running from, regardless of if it's a Rails or Sinatra app? Is there an elegant way to solve it without using a regex? </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1529506107, "post_id": 50949111, "comment_id": 88899724, "body": "Why do you need that? What do you try to achieve? How do you plan to work with that column later on in the application? Perhaps it is just me, but I cannot think of a reason why I would allow a user to change the schema of an application at runtime..."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1529514020, "post_id": 50949111, "comment_id": 88904636, "body": "yeah, you have to be careful here not to allow SQL injection. Can a user hypothetically pass any string to your execute call? Then you are at risk."}], "answers": [{"tags": [], "owner": {"reputation": 5304, "user_id": 740394, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/796442b522b037319711277a81d775ca?s=128&d=identicon&r=PG", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/740394/rodrigo"}, "is_accepted": true, "score": 1, "last_activity_date": 1529500756, "creation_date": 1529500756, "answer_id": 50949240, "question_id": 50949111, "link": "https://stackoverflow.com/questions/50949111/how-to-add-a-column-in-the-database-using-a-form/50949240#50949240", "title": "How to add a column in the database using a form?", "body": "<p>Looks like you missed a space:</p>\n\n<pre><code>sql = ALTER TABLE users ADD #{name} #{data_type}\"\n</code></pre>\n\n<p>and be aware of SQL injection while doing this</p>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 5479407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9a6cbcca2ae4e9d0916780d8773bc4e?s=128&d=identicon&r=PG", "display_name": "Chung Ph\u01b0\u1edbc", "link": "https://stackoverflow.com/users/5479407/chung-ph%c6%b0%e1%bb%9bc"}, "is_accepted": false, "score": 0, "last_activity_date": 1529758340, "creation_date": 1529758340, "answer_id": 51001340, "question_id": 50949111, "link": "https://stackoverflow.com/questions/50949111/how-to-add-a-column-in-the-database-using-a-form/51001340#51001340", "title": "How to add a column in the database using a form?", "body": "<p>You shouldn't add a column like this way, you should always use migration to populate your DB tables and columns</p>\n"}], "owner": {"reputation": 169, "user_id": 4627150, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/930915593607785/picture?type=large", "display_name": "Mariel", "link": "https://stackoverflow.com/users/4627150/mariel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 50949240, "answer_count": 2, "score": 0, "last_activity_date": 1529758340, "creation_date": 1529500337, "question_id": 50949111, "link": "https://stackoverflow.com/questions/50949111/how-to-add-a-column-in-the-database-using-a-form", "title": "How to add a column in the database using a form?", "body": "<p>There's a form with name and data type input. On form submit, it should add another column to the table. It should execute the sql statement <code>ALTER TABLE users ADD name datatype;</code>. How can i accomplish this? I've tried this and it doesn't work.</p>\n\n<pre><code>def add_columns\n    sql = \"ALTER TABLE users ADD \" + name + data_type;\n    ActiveRecord::Base.connection.execute(sql);\nend\n</code></pre>\n"}, {"tags": ["ruby", "jruby"], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 4, "last_activity_date": 1529500387, "creation_date": 1529500387, "answer_id": 50949122, "question_id": 50949039, "link": "https://stackoverflow.com/questions/50949039/storing-an-array-of-objects/50949122#50949122", "title": "Storing an array of objects", "body": "<blockquote>\n  <p>For some reason, it overwrites the array with the last inserted item, why?</p>\n</blockquote>\n\n<p>No, it doesn't. The items are separate/distinct. But the initializer for the second item mutates the \"global\" class variables, so all items <em>look</em> the same.</p>\n\n<p>Don't use class variables (<code>@@column</code>), use instance variables (<code>@column</code>).</p>\n\n<p>Free online book: <a href=\"http://ruby-doc.com/docs/ProgrammingRuby/\" rel=\"nofollow noreferrer\">Programming Ruby</a>.</p>\n"}], "owner": {"reputation": 309, "user_id": 4871205, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/065b36cced00b0fe0d6adbb26160beac?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4871205/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 50949122, "answer_count": 1, "score": 0, "last_activity_date": 1529500387, "creation_date": 1529500116, "question_id": 50949039, "link": "https://stackoverflow.com/questions/50949039/storing-an-array-of-objects", "title": "Storing an array of objects", "body": "<p>I am trying to store an array of objects;</p>\n\n<pre><code>class ColumnMapping\n    @@column = nil\n    @@method = nil\n\n    def initialize(col, meth)\n        @@column = col\n        @@method = meth\n    end\n\n    def get_metadata_field()\n        return @@column\n    end\n\n    def get_method()\n        return @@method\n    end\nend\n\nclass Massage\n    require 'thread'\n\n    @@column_mappings = []\n    @ba = nil\n\n    def initialize()        \n        @@column_mappings &lt;&lt; ColumnMapping.new(\"ESI Folder Path\", \"get_esi_folder_path\")\n        @@column_mappings &lt;&lt; ColumnMapping.new(\"Has Embedded Files\", \"get_has_embedded_items\")\n        @ba = $utilities.getBulkAnnotatercolumn_mappings\n    end\nend\n</code></pre>\n\n<p>When I debug, the data in <code>@@column_mappings</code> are two instances of the second line;\n<code>@@column_mappings &lt;&lt; ColumnMapping.new(\"Has Embedded Files\", \"get_has_embedded_items\")</code>. </p>\n\n<p>For some reason, it overwrites the array with the last inserted item, why?</p>\n"}, {"tags": ["ruby", "rubygems"], "answers": [{"tags": [], "owner": {"reputation": 1678, "user_id": 1372624, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/6b93a06ff1651c18b595c606455ab23a?s=128&d=identicon&r=PG", "display_name": "bbbonthemoon", "link": "https://stackoverflow.com/users/1372624/bbbonthemoon"}, "is_accepted": true, "score": 4, "last_activity_date": 1543497658, "last_edit_date": 1543497658, "creation_date": 1529501004, "answer_id": 50949316, "question_id": 50948262, "link": "https://stackoverflow.com/questions/50948262/some-gems-seem-to-be-missing-from-your-vendor-cache-directory/50949316#50949316", "title": "Some gems seem to be missing from your vendor/cache directory", "body": "<p>The solution is to delete <strong>vendor/cache</strong> directory completelly.</p>\n"}], "owner": {"reputation": 1678, "user_id": 1372624, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/6b93a06ff1651c18b595c606455ab23a?s=128&d=identicon&r=PG", "display_name": "bbbonthemoon", "link": "https://stackoverflow.com/users/1372624/bbbonthemoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 953, "favorite_count": 0, "accepted_answer_id": 50949316, "answer_count": 1, "score": 3, "last_activity_date": 1543497689, "creation_date": 1529497643, "last_edit_date": 1543497689, "question_id": 50948262, "link": "https://stackoverflow.com/questions/50948262/some-gems-seem-to-be-missing-from-your-vendor-cache-directory", "title": "Some gems seem to be missing from your vendor/cache directory", "body": "<p><br>\nNeed help with running <code>bundle</code> command in a Rails project, I receive the following error:</p>\n\n<pre><code>Some gems seem to be missing from your vendor/cache directory.\nCould not find rack-protection-1.5.5 in any of the sources\n</code></pre>\n\n<p><strong><em>gem install rack-protection -v 1.5.5</em></strong> works perfectly, the gem gets installed, however when I run <em>bundle</em> or <em>bundle install</em> again I sill receive the missing gem error. I checked GEM PATHS directories and the gem is indeed in there. Please help.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "super"], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1529527499, "post_id": 50949183, "comment_id": 88910902, "body": "<code>include</code> would not work if <code>SomeLogic::DICTIONARY</code> had a key for <code>:new_method_3</code> because this logic appears to need precedence over a defined method call"}], "tags": [], "owner": {"reputation": 1854, "user_id": 669745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a4b0416684de65970e4d1b4da1bb290?s=128&d=identicon&r=PG", "display_name": "Panic", "link": "https://stackoverflow.com/users/669745/panic"}, "is_accepted": false, "score": 1, "last_activity_date": 1529500577, "creation_date": 1529500577, "answer_id": 50949183, "question_id": 50948047, "link": "https://stackoverflow.com/questions/50948047/call-super-based-callee-value/50949183#50949183", "title": "call super based __callee__ value", "body": "<p>If you change</p>\n\n<pre><code>class A\n  prepend M\n</code></pre>\n\n<p>to</p>\n\n<pre><code>class A\n  include M\n</code></pre>\n\n<p>you will get the desired output</p>\n"}, {"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 0, "last_activity_date": 1529594385, "last_edit_date": 1529594385, "creation_date": 1529518678, "answer_id": 50954707, "question_id": 50948047, "link": "https://stackoverflow.com/questions/50948047/call-super-based-callee-value/50954707#50954707", "title": "call super based __callee__ value", "body": "<p>Okay so this is extremely convoluted but it will work as requested</p>\n\n<pre><code>class SomeLogic\n  DICTIONARY = {\n    new_method_1: 'dictionary value 1',\n    new_method_2: 'dictionary value 2'\n  }\n\n  def initialize(method_name)\n    @method_name = method_name\n  end\n\n  def call\n    DICTIONARY[@method_name]\n  end\n\nend\nmodule M\n\n  def self.prepended(base)\n    base.extend(ClassMethods)\n  end\n\n  def base_method(&amp;block)\n    SomeLogic.new(__callee__).call || \n    block&amp;.call || # ruby &lt; 2.3 block &amp;&amp; block.call\n    {}\n  end\n\n  module ClassMethods\n    def method_added(method_name)\n      if M.instance_methods.include?(method_name)\n        orig = M.instance_method(method_name)\n        M.remove_method(method_name)\n        new = self.instance_method(method_name)\n        self.prepend(Module.new do \n          define_method(method_name) do\n            result = orig.bind(self).call(&amp;new.bind(self))\n          end   \n        end)\n        M.define_method(method_name, &amp;orig.bind(M))  \n      end\n    end\n  end\n\n  alias_method :new_method_1, :base_method\n  alias_method :new_method_2, :base_method\n  alias_method :new_method_3, :base_method\n  alias_method :new_method_4, :base_method\nend\n\nclass A\n  prepend M\n  def new_method_3\n    'foo'\n  end\nend\n\nclass B \n  prepend M \nend\n</code></pre>\n\n<p>So when you define a new method we check to see if that method is already defined by <code>M</code>. If so then we capture that <code>UnboundMethod</code> remove the method from <code>M</code>, then we capture the new definition as an <code>UnboundMethod</code>  then define the new method in an anonymous <code>Module</code> as <code>M</code>s implementation passing the new method implementation as a proc to <code>M</code>s implementation and prepend this module to the defining <code>Class</code>, then we place <code>M</code>s implementation back into <code>M</code> so other classes still work.</p>\n\n<p>Result:</p>\n\n<pre><code>p A.new.new_method_1 \n#=&gt; 'dictionary value 1'\np A.new.new_method_2 \n#=&gt; 'dictionary value 2'\np A.new.new_method_3 \n#=&gt; 'foo'\np A.new.new_method_4\n#=&gt; {}\np B.new.new_method_3\n#=&gt; {}\n</code></pre>\n\n<p>If you would prefer <code>include</code> over <code>prepend</code> then <code>M</code> could look like </p>\n\n<pre><code>module M \n  def self.included(base)\n    super\n    base.extend(ClassMethods)\n  end\n\n  def base_method\n    if logic = SomeLogic.new(__callee__).call\n      logic\n    elsif self.class.instance_methods(false).include?(__callee__)\n      send(__callee__,true)\n    else\n      {}\n    end\n  end\n  module ClassMethods\n    def method_added(method_name)\n      return if @_adding_method # avoid stack level issues\n      if M.instance_methods.include?(method_name)\n        new = instance_method(method_name)\n        @_adding_method = true # avoid stack level issues\n        define_method(method_name) do |bypass_parent=false|\n          return super() unless bypass_parent\n          new.bind(self).call\n        end   \n        @_adding_method = false\n      end\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4503313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f612d00020f1dbc964eff2283a6a83c2?s=128&d=identicon&r=PG", "display_name": "juffin_hally", "link": "https://stackoverflow.com/users/4503313/juffin-hally"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1529594385, "creation_date": 1529497002, "last_edit_date": 1529501003, "question_id": 50948047, "link": "https://stackoverflow.com/questions/50948047/call-super-based-callee-value", "title": "call super based __callee__ value", "body": "<p>Method <code>super</code> calls parent method based on <code>__method__</code>.\nHow to call parent method based on <code>__callee__</code>?</p>\n\n<pre><code>class SomeLogic\n  DICTIONARY = {\n    new_method_1: 'dictionary value 1',\n    new_method_2: 'dictionary value 2'\n  }\n\n  def initialize(method_name)\n    @method_name = method_name\n  end\n\n  def call\n    DICTIONARY[@method_name]\n  end\n\nend\n\nmodule M\n\n  extend ActiveSupport::Concern\n\n  def base_method\n    logic = SomeLogic.new(__callee__).call\n\n    if logic\n      logic\n    elsif defined?(__callee__)\n      super # here analogue of super needed\n    else\n      {}\n    end\n  end\n\n  alias_method :new_method_1, :base_method\n  alias_method :new_method_2, :base_method\n  alias_method :new_method_3, :base_method\nend\n\n\nclass A\n\n  prepend M\n\n  def new_method_3\n    'foo'\n  end\n\nend\n</code></pre>\n\n<p>Expected results:</p>\n\n<pre><code>A.new.new_method_1 # dictionary value 1\nA.new.new_method_2 # dictionary value 2\nA.new.new_method_3 # foo\n</code></pre>\n\n<p>Current results:</p>\n\n<pre><code>A.new.new_method_1 # dictionary value 1\nA.new.new_method_2 # dictionary value 2\nA.new.new_method_3 # no superclass method `base_method' for A\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 476, "user_id": 2645167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEnRe.jpg?s=128&g=1", "display_name": "andriy-baran", "link": "https://stackoverflow.com/users/2645167/andriy-baran"}, "edited": false, "score": 0, "creation_date": 1529496928, "post_id": 50947918, "comment_id": 88893429, "body": "What is <b>Abc</b> and <b>Xyz</b>?"}, {"owner": {"reputation": 399, "user_id": 7445709, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8c9967ea3a9aa233dd5835e1fceb7455?s=128&d=identicon&r=PG&f=1", "display_name": "jesica", "link": "https://stackoverflow.com/users/7445709/jesica"}, "reply_to_user": {"reputation": 476, "user_id": 2645167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEnRe.jpg?s=128&g=1", "display_name": "andriy-baran", "link": "https://stackoverflow.com/users/2645167/andriy-baran"}, "edited": false, "score": 0, "creation_date": 1529496972, "post_id": 50947918, "comment_id": 88893461, "body": "It&#39;s <b><i>companies</i></b> I mean parents @andriy-baran"}, {"owner": {"reputation": 476, "user_id": 2645167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEnRe.jpg?s=128&g=1", "display_name": "andriy-baran", "link": "https://stackoverflow.com/users/2645167/andriy-baran"}, "edited": false, "score": 0, "creation_date": 1529497203, "post_id": 50947918, "comment_id": 88893644, "body": "You want to have a list of companies which have post or post views greater than 100?"}, {"owner": {"reputation": 399, "user_id": 7445709, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8c9967ea3a9aa233dd5835e1fceb7455?s=128&d=identicon&r=PG&f=1", "display_name": "jesica", "link": "https://stackoverflow.com/users/7445709/jesica"}, "reply_to_user": {"reputation": 476, "user_id": 2645167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEnRe.jpg?s=128&g=1", "display_name": "andriy-baran", "link": "https://stackoverflow.com/users/2645167/andriy-baran"}, "edited": false, "score": 0, "creation_date": 1529497343, "post_id": 50947918, "comment_id": 88893749, "body": "I want to get posts order by view_count desc for all companies, at first posts ordering then get group by companies"}, {"owner": {"reputation": 714, "user_id": 2721332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f613d619067de58f480eb6304f0f390?s=128&d=identicon&r=PG&f=1", "display_name": "seethrough", "link": "https://stackoverflow.com/users/2721332/seethrough"}, "edited": false, "score": 0, "creation_date": 1529497556, "post_id": 50947918, "comment_id": 88893902, "body": "<code>Post.joins(&quot;INNER JOIN companies ON posts.company_id = companies.id ORDER BY view_count DESC LIMIT 2 &quot;)</code>"}, {"owner": {"reputation": 399, "user_id": 7445709, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8c9967ea3a9aa233dd5835e1fceb7455?s=128&d=identicon&r=PG&f=1", "display_name": "jesica", "link": "https://stackoverflow.com/users/7445709/jesica"}, "reply_to_user": {"reputation": 714, "user_id": 2721332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f613d619067de58f480eb6304f0f390?s=128&d=identicon&r=PG&f=1", "display_name": "seethrough", "link": "https://stackoverflow.com/users/2721332/seethrough"}, "edited": false, "score": 0, "creation_date": 1529498370, "post_id": 50947918, "comment_id": 88894476, "body": "It&#39;s throw the error <i>ActiveRecord::StatementInvalid: SQLite3::SQLException: near &quot;LIMIT&quot;: syntax error: SELECT  &quot;posts&quot;.</i> FROM &quot;posts&quot; INNER JOIN companies ON posts.company_id = companies.id ORDER BY view_count DESC LIMIT 2 LIMIT ?* @seethrough"}, {"owner": {"reputation": 14663, "user_id": 343679, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e65e5b1cd213c3b9c72f2680257d6eaf?s=128&d=identicon&r=PG&f=1", "display_name": "Sharj", "link": "https://stackoverflow.com/users/343679/sharj"}, "edited": false, "score": 0, "creation_date": 1529498625, "post_id": 50947918, "comment_id": 88894624, "body": "What is your desired result? Is it to show list of Companies with last X Posts from each Company?"}, {"owner": {"reputation": 399, "user_id": 7445709, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8c9967ea3a9aa233dd5835e1fceb7455?s=128&d=identicon&r=PG&f=1", "display_name": "jesica", "link": "https://stackoverflow.com/users/7445709/jesica"}, "reply_to_user": {"reputation": 14663, "user_id": 343679, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e65e5b1cd213c3b9c72f2680257d6eaf?s=128&d=identicon&r=PG&f=1", "display_name": "Sharj", "link": "https://stackoverflow.com/users/343679/sharj"}, "edited": false, "score": 0, "creation_date": 1529498762, "post_id": 50947918, "comment_id": 88894698, "body": "I want to show two posts group_by company but posts order with view_count @Sharj"}, {"owner": {"reputation": 1918, "user_id": 9224452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb0f303869bf090269cbcc46cef14991?s=128&d=identicon&r=PG&f=1", "display_name": "John Baker", "link": "https://stackoverflow.com/users/9224452/john-baker"}, "edited": false, "score": 0, "creation_date": 1529499647, "post_id": 50947918, "comment_id": 88895235, "body": "<code>Post.joins(:companies).order(view_count: :desc).group(&#39;companies.id&#39;).limit(2)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 399, "user_id": 7445709, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8c9967ea3a9aa233dd5835e1fceb7455?s=128&d=identicon&r=PG&f=1", "display_name": "jesica", "link": "https://stackoverflow.com/users/7445709/jesica"}, "edited": false, "score": 0, "creation_date": 1529499904, "post_id": 50948862, "comment_id": 88895405, "body": "Thanks! how to reverse company based on post view count, and that&#39;s the main issue."}], "tags": [], "owner": {"reputation": 14663, "user_id": 343679, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e65e5b1cd213c3b9c72f2680257d6eaf?s=128&d=identicon&r=PG&f=1", "display_name": "Sharj", "link": "https://stackoverflow.com/users/343679/sharj"}, "is_accepted": false, "score": 0, "last_activity_date": 1529499543, "creation_date": 1529499543, "answer_id": 50948862, "question_id": 50947918, "link": "https://stackoverflow.com/questions/50947918/how-to-take-limited-posts-for-every-parents-in-ruby-on-rails/50948862#50948862", "title": "How to take limited posts for every parents in ruby on rails", "body": "<p>If you want to show like this:</p>\n\n<pre><code>Company A\n- Post A \n- Post B\n\nCompany B\n- Post C\n- Post D\n</code></pre>\n\n<p>First get list of companies:</p>\n\n<pre><code>@companies = Company.all #You can add condition to take only those companies you want to show\n\n@companies.each do |company|\n  #print company name\n  company.posts.order(\"view_count DESC\").limit(2).each do |post|\n    #print post.title\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 399, "user_id": 7445709, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8c9967ea3a9aa233dd5835e1fceb7455?s=128&d=identicon&r=PG&f=1", "display_name": "jesica", "link": "https://stackoverflow.com/users/7445709/jesica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529499543, "creation_date": 1529496560, "last_edit_date": 1529496893, "question_id": 50947918, "link": "https://stackoverflow.com/questions/50947918/how-to-take-limited-posts-for-every-parents-in-ruby-on-rails", "title": "How to take limited posts for every parents in ruby on rails", "body": "<p>I have two models with <code>has_many</code> relationship like </p>\n\n<p>company.rb</p>\n\n<pre><code>class Company &lt; ApplicationRecord\n   has_many :posts, dependent: :destroy\nend\n</code></pre>\n\n<p>post.rb</p>\n\n<pre><code>class Post &lt; ApplicationRecord\n   belongs_to :company\nend\n</code></pre>\n\n<p>Now i'm trying to get results like this </p>\n\n<p><strong>Abc</strong> (Company contains > 100 posts)</p>\n\n<ul>\n<li>Infinity war</li>\n<li>The maze runner</li>\n</ul>\n\n<p><strong>Xyz</strong> (Company contains > 100 posts)</p>\n\n<ul>\n<li>Game of thrones</li>\n<li>The wire</li>\n</ul>\n\n<p>So then concept is need to made a query for take only two child records for every company, not all.</p>\n\n<p>I have tried like this </p>\n\n<pre><code>Post.order(id: :desc).group_by(&amp;:company)\n</code></pre>\n\n<p>It has loaded all posts grouped by company then page is slower.</p>\n\n<p>If I try like this </p>\n\n<pre><code>posts = Post.order(view_count: :desc).limit(20)\n@posts = posts.group_by(&amp;:company)\n</code></pre>\n\n<p>it's taking 20 posts but not for all companies.</p>\n\n<p>I don't know is that enough for you to understand.</p>\n\n<p>What can I do now.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1529496501, "post_id": 50947835, "comment_id": 88893118, "body": "I guess it&#39;s because you defined it as private?"}, {"owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "edited": false, "score": 0, "creation_date": 1529496781, "post_id": 50947835, "comment_id": 88893323, "body": "normally works so drop the private and why not use scopes ? they can also be chained"}, {"owner": {"reputation": 256, "user_id": 1472902, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jT1AT.jpg?s=128&g=1", "display_name": "Gbeschbacher", "link": "https://stackoverflow.com/users/1472902/gbeschbacher"}, "reply_to_user": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "edited": false, "score": 0, "creation_date": 1529496903, "post_id": 50947835, "comment_id": 88893411, "body": "@peter i&#39;d like to split functionality because i have some comples scopes but i do not want them to be used separately. That&#39;s why i&#39;d like to split up the functionality, name them properly and create a combined scope which is the only thing i want to be publicly available"}], "answers": [{"comments": [{"owner": {"reputation": 256, "user_id": 1472902, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jT1AT.jpg?s=128&g=1", "display_name": "Gbeschbacher", "link": "https://stackoverflow.com/users/1472902/gbeschbacher"}, "edited": false, "score": 0, "creation_date": 1529497407, "post_id": 50947983, "comment_id": 88893802, "body": "that is definitly a workaround i&#39;ll use because inheritance is not used in my specific use-case. So i&#39;ll mark your answer as correct as it fulfills my desire for a workaround. Thanks!"}, {"owner": {"reputation": 917, "user_id": 7411621, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a37fcd6d889200d8721cf58a491e4ee5?s=128&d=identicon&r=PG&f=1", "display_name": "taras", "link": "https://stackoverflow.com/users/7411621/taras"}, "edited": false, "score": 1, "creation_date": 1529497594, "post_id": 50947983, "comment_id": 88893934, "body": "This should lead to the same <code>undefined method &quot;two&quot; for #&lt;ActiveRecord::Relation&gt;</code> error."}], "tags": [], "owner": {"reputation": 110512, "user_id": 350087, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/808bec1c640143bd7091888d9edfb2f2?s=128&d=identicon&r=PG", "display_name": "apneadiving", "link": "https://stackoverflow.com/users/350087/apneadiving"}, "is_accepted": true, "score": 4, "last_activity_date": 1529496844, "creation_date": 1529496844, "answer_id": 50947983, "question_id": 50947835, "link": "https://stackoverflow.com/questions/50947835/private-class-method-chaining-in-ruby/50947983#50947983", "title": "Private class method chaining in ruby", "body": "<p>Indeed it doesnt work because of private methods.</p>\n\n<p>Unfortunately there is no <code>protected_class_method</code>.</p>\n\n<p>So I suggest you this approach:</p>\n\n<pre><code>class Foobar\n  class &lt;&lt; self\n    def three\n      one.two\n    end\n\n    protected \n    def one\n      where(one: true)\n    end\n\n    def two\n      where(two: true)\n    end\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 187, "user_id": 1477932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ae986215778ab701f6573bc4bd28ad?s=128&d=identicon&r=PG", "display_name": "GAURAV SETH", "link": "https://stackoverflow.com/users/1477932/gaurav-seth"}, "is_accepted": false, "score": 0, "last_activity_date": 1529502030, "creation_date": 1529502030, "answer_id": 50949678, "question_id": 50947835, "link": "https://stackoverflow.com/questions/50947835/private-class-method-chaining-in-ruby/50949678#50949678", "title": "Private class method chaining in ruby", "body": "<p>undefined method \"two\" for <code>#&lt;ActiveRecord::Relation&gt;</code> this message came because  <code>where(one: true)</code> will give result in array of object not 1 object, so in <code>self.three</code> we should run in loop to call.</p>\n\n<pre><code>def self.three\n    one.map{|x| x.two}\n   # or \n   #one.map(&amp;:two)\n  end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 256, "user_id": 1472902, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jT1AT.jpg?s=128&g=1", "display_name": "Gbeschbacher", "link": "https://stackoverflow.com/users/1472902/gbeschbacher"}, "is_accepted": false, "score": 1, "last_activity_date": 1529566275, "creation_date": 1529566275, "answer_id": 50962815, "question_id": 50947835, "link": "https://stackoverflow.com/questions/50947835/private-class-method-chaining-in-ruby/50962815#50962815", "title": "Private class method chaining in ruby", "body": "<p>So, i've found out why this error message actually happened: private class methods are not callable with a receiver present.</p>\n\n<p>calling <code>one</code> results in an ActiveRecord::Relation and calling a private method onto that relation is not allowed, thus resulting in the given error. </p>\n\n<p>There is a small workaround to get this working:</p>\n\n<pre><code>def self.three\n  one.merge(two)\nend\n</code></pre>\n\n<p>The present receiver disappears by calling one and two separately and merging it with the <a href=\"http://api.rubyonrails.org/v5.2.0/classes/ActiveRecord/SpawnMethods.html#method-i-merge\" rel=\"nofollow noreferrer\">ActiveRecord merge method</a> </p>\n"}], "owner": {"reputation": 256, "user_id": 1472902, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jT1AT.jpg?s=128&g=1", "display_name": "Gbeschbacher", "link": "https://stackoverflow.com/users/1472902/gbeschbacher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 1, "accepted_answer_id": 50947983, "answer_count": 3, "score": 1, "last_activity_date": 1529566275, "creation_date": 1529496332, "question_id": 50947835, "link": "https://stackoverflow.com/questions/50947835/private-class-method-chaining-in-ruby", "title": "Private class method chaining in ruby", "body": "<p>How's it possible to chain private class methods in ruby?</p>\n\n<pre><code>class Foobar\n  private_class_method def self.one\n    where(one: true)\n  end\n\n  private_class_method def self.two\n    where(two: true)\n  end\n\n  def self.three\n    one.two\n  end\nend\n</code></pre>\n\n<p><code>Foobar.three</code> results in <code>undefined method \"two\" for #&lt;ActiveRecord::Relation&gt;</code></p>\n\n<p>Why does this happen and is there a workaround to achieve my desire?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "testing", "rspec-rails"], "comments": [{"owner": {"reputation": 476, "user_id": 2645167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEnRe.jpg?s=128&g=1", "display_name": "andriy-baran", "link": "https://stackoverflow.com/users/2645167/andriy-baran"}, "edited": false, "score": 0, "creation_date": 1529495734, "post_id": 50947557, "comment_id": 88892592, "body": "Please show controller action and model validations"}, {"owner": {"reputation": 476, "user_id": 2645167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEnRe.jpg?s=128&g=1", "display_name": "andriy-baran", "link": "https://stackoverflow.com/users/2645167/andriy-baran"}, "edited": false, "score": 0, "creation_date": 1529495939, "post_id": 50947557, "comment_id": 88892748, "body": "Looks like your params are invalid and User is not saved into database"}, {"owner": {"reputation": 1086, "user_id": 5201594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AHVDD.jpg?s=128&g=1", "display_name": "rahul mishra", "link": "https://stackoverflow.com/users/5201594/rahul-mishra"}, "edited": false, "score": 1, "creation_date": 1529496166, "post_id": 50947557, "comment_id": 88892920, "body": "<code>post &quot;&#47;api&#47;v1&#47;users&quot;, params: valid_params </code> your post action doesn&#39;t create user which cause User.last  to be <code>nil</code> debug your controller action."}, {"owner": {"reputation": 315, "user_id": 6056677, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-B72_N5GQ-zo/AAAAAAAAAAI/AAAAAAAAAFw/pKrxdPKBz_U/photo.jpg?sz=128", "display_name": "Priyadarshani mini", "link": "https://stackoverflow.com/users/6056677/priyadarshani-mini"}, "edited": false, "score": 0, "creation_date": 1529497401, "post_id": 50947557, "comment_id": 88893792, "body": "it creates a user and return a user with id 1 But when i check my database i don&#39;t see that user and error is  Error: expect(User.last).to have_attributes valid_params"}, {"owner": {"reputation": 315, "user_id": 6056677, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-B72_N5GQ-zo/AAAAAAAAAAI/AAAAAAAAAFw/pKrxdPKBz_U/photo.jpg?sz=128", "display_name": "Priyadarshani mini", "link": "https://stackoverflow.com/users/6056677/priyadarshani-mini"}, "edited": false, "score": 0, "creation_date": 1529497559, "post_id": 50947557, "comment_id": 88893903, "body": "expected #&lt;User id: 1, fname: &quot;Ri&quot;, lname: &quot;Ra&quot;, contact: &quot;2144&quot;, address: &quot;Sector 63&quot;, city: &quot;Noida&quot;,...ty_code: nil, country_code: &quot;91&quot;&gt; to have attributes {:email =&gt; &quot;xxx@xxx.com&quot;, :password =&gt; &quot;123456&quot;, :fname =&gt; &quot;Riya&quot;, :lname =&gt; &quot;&quot;, :role =&gt; &quot;&quot;, :...ddress =&gt; &quot;xx&quot;, :city =&gt; &quot;xx&quot;, :state =&gt; &quot;x&quot;, :country =&gt; &quot;x&quot;, :zipcode =&gt; &quot;x&quot;, :image =&gt; &quot;&quot;} but had attributes {:email =&gt; &quot;xxx@xxx.com&quot;, :password =&gt; nil, :fname =&gt; &quot;Riya&quot;, :lname =&gt; &quot;Rajput&quot;, :role =&gt; &quot;business&quot;, :conta...dress =&gt; &quot;Sector 63&quot;, :city =&gt; &quot;Noida&quot;, :state =&gt; &quot;UP&quot;, :country =&gt; &quot;India&quot;, :zipcode =&gt; &quot;23&quot;, :image =&gt; nil}"}, {"owner": {"reputation": 476, "user_id": 2645167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEnRe.jpg?s=128&g=1", "display_name": "andriy-baran", "link": "https://stackoverflow.com/users/2645167/andriy-baran"}, "edited": false, "score": 0, "creation_date": 1529498976, "post_id": 50947557, "comment_id": 88894828, "body": "lname and role at least not match"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 5937001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9b38f13614b53f84e837a5c012c4761?s=128&d=identicon&r=PG&f=1", "display_name": "Roddo", "link": "https://stackoverflow.com/users/5937001/roddo"}, "is_accepted": false, "score": 0, "last_activity_date": 1529497635, "creation_date": 1529497635, "answer_id": 50948259, "question_id": 50947557, "link": "https://stackoverflow.com/questions/50947557/how-to-test-api-in-rails-rspec/50948259#50948259", "title": "How to Test Api In Rails Rspec", "body": "<p>To be sure that your post query create an user you can write it like this:</p>\n\n<pre><code>expect { post \"/api/v1/users\", params: valid_params}.to change(User, :count).by(1)\n</code></pre>\n\n<p>It test if a user is added to the database.</p>\n"}], "owner": {"reputation": 315, "user_id": 6056677, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-B72_N5GQ-zo/AAAAAAAAAAI/AAAAAAAAAFw/pKrxdPKBz_U/photo.jpg?sz=128", "display_name": "Priyadarshani mini", "link": "https://stackoverflow.com/users/6056677/priyadarshani-mini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1613, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529497635, "creation_date": 1529495362, "last_edit_date": 1529495548, "question_id": 50947557, "link": "https://stackoverflow.com/questions/50947557/how-to-test-api-in-rails-rspec", "title": "How to Test Api In Rails Rspec", "body": "<p>I'm new to rails testing,i want to test my rails controller api. \nI using gems <strong>rails-rspec</strong> ,<strong>capybara</strong> and <strong>database-cleaner</strong> like this in my Gemfile:</p>\n\n<pre><code>group :development, :test do\n  gem 'rspec-rails', '~&gt; 3.7'\nend\n\ngroup :test do\n  gem 'database_cleaner'\n  gem 'capybara'\nend\n</code></pre>\n\n<p>And in my spec folder i create a controller and create a <strong>user_controller_spec.rb</strong> inside my api folder and want to test create a user with valid parameters and write a code like this:</p>\n\n<pre><code>RSpec.describe \"API V1 Users\", type: 'request' do\n  describe \"POST /api/v1/users\" do\n    context \"with valid parameters\" do\n      let(:valid_params) do\n        { \n          fname: \"Riya\",\n          lname: \"******\",\n          email: \"*******.com\",\n          password: \"\",\n          contact: \"2144333\",\n          country_code:\"91\",\n          address: \"Sector 63\",\n          city: \"Noida\",\n          state: \"UP\",\n          country: \"India\",\n          zipcode: \"23001\",\n          role: \"***\",\n          image: \"\"\n        }\n      end\n\n  it \"creates a new user\" do\n    expect { post \"/api/v1/users\", params: valid_params}\n    expect(response).to have_http_status(:ok)  # it's use for code 200 \n  end\n\n  it \"creates a user with the correct attributes\" do\n    post \"/api/v1/users\", params: valid_params \n    expect(User.last).to have_attributes valid_params\n  end\nend\n\ncontext \"with invalid parameters\" do\n   # testing for validation failures is just as important!\n   # ...\nend\n  end\nend\n</code></pre>\n\n<p>But it gives me error :</p>\n\n<pre><code>Failure/Error: expect(User.last).to have_attributes valid_params expected nil to respond to :fname, :lname, :email, :password, :contact\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "api", "rubygems"], "comments": [{"owner": {"reputation": 476, "user_id": 2645167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEnRe.jpg?s=128&g=1", "display_name": "andriy-baran", "link": "https://stackoverflow.com/users/2645167/andriy-baran"}, "edited": false, "score": 0, "creation_date": 1529493210, "post_id": 50946784, "comment_id": 88890971, "body": "Aggregate results of both requests into object and render it"}], "answers": [{"comments": [{"owner": {"reputation": 476, "user_id": 2645167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEnRe.jpg?s=128&g=1", "display_name": "andriy-baran", "link": "https://stackoverflow.com/users/2645167/andriy-baran"}, "reply_to_user": {"reputation": 111, "user_id": 6433334, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10154054040866294/picture?type=large", "display_name": "Biggztyle", "link": "https://stackoverflow.com/users/6433334/biggztyle"}, "edited": false, "score": 0, "creation_date": 1529494955, "post_id": 50946969, "comment_id": 88892041, "body": "For example: tracker.flight_track.flight_id instead of tracker.flight_id."}], "tags": [], "owner": {"reputation": 476, "user_id": 2645167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEnRe.jpg?s=128&g=1", "display_name": "andriy-baran", "link": "https://stackoverflow.com/users/2645167/andriy-baran"}, "is_accepted": true, "score": 0, "last_activity_date": 1529493455, "creation_date": 1529493455, "answer_id": 50946969, "question_id": 50946784, "link": "https://stackoverflow.com/questions/50946784/display-extra-data-from-a-search-query/50946969#50946969", "title": "Display extra data from a Search Query", "body": "<p>As illustration for my comment</p>\n\n<pre><code>def self.new_from_lookup(tracker)\n  flight_track = FlightStats::FlightStatus.by_flight_id(tracker)\n  flight_position = FlightStats::FlightStatus.track_by_flight_id(tracker)\n  OpenStruct.new(flight_track: flight_track, flight_position: flight_position)\nend\n</code></pre>\n\n<p>Then you'll need to rewrite template <strong>my_tracker.html.erb</strong> to handle new data structure</p>\n"}], "owner": {"reputation": 111, "user_id": 6433334, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10154054040866294/picture?type=large", "display_name": "Biggztyle", "link": "https://stackoverflow.com/users/6433334/biggztyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 50946969, "answer_count": 1, "score": 0, "last_activity_date": 1529495716, "creation_date": 1529492910, "last_edit_date": 1529495716, "question_id": 50946784, "link": "https://stackoverflow.com/questions/50946784/display-extra-data-from-a-search-query", "title": "Display extra data from a Search Query", "body": "<p>Currently learning through a Udemy Course but changed the lecture to something I am more interested in developing.</p>\n\n<p>Project Basis:\n- using Gem Flightstats-flex to pull flight data\n- trying to display associated info from a search query</p>\n\n<p>Current setup </p>\n\n<p>app/controllers/trackers_controller.rb</p>\n\n<pre><code>class TrackersController &lt; ApplicationController\n\n  def search\n    @tracker = FlightTracker.new_from_lookup(params[:tracker])\n    render 'users/my_tracker'\n  end\n\nend\n</code></pre>\n\n<p>app/models/flight_tracker.rb</p>\n\n<pre><code>class FlightTracker &lt; ActiveRecord::Base\n\n    self.table_name='trackers'\n\n    def self.new_from_lookup(tracker)\n      flight_track = FlightStats::FlightStatus.by_flight_id(tracker)\n      # flight_position = FlightStats::FlightStatus.track_by_flight_id(tracker)\n\nend\n</code></pre>\n\n<p>This is where the problem happens, when I remove <code>#</code> from <code>flight_position = FlightStats::FlightStatus.track_by_flight_id(tracker)</code></p>\n\n<ul>\n<li>the results overwrite the top  </li>\n<li>if I use the line only it displays and vice versa for the top line</li>\n</ul>\n\n<p>app/views/users/my_tracker.html.erb the data does render</p>\n\n<pre><code>&lt;h1&gt;\n  My Tracker\n&lt;/h1&gt;\n\n&lt;h3&gt;Search for Flights&lt;/h3&gt;\n&lt;div id=\"tracker-lookup\"&gt;\n  &lt;%= form_tag search_trackers_path, method: :get, id: \"tracker-lookup-form\" do %&gt;\n    &lt;div class=\"form-group row no-padding text-center col-md-12\"&gt;\n      &lt;div class=\"col-md-10\"&gt;\n        &lt;%= text_field_tag :tracker, params[:tracker], \n                                  placeholder: \"Stock ticker symbol\", autofocus: true,\n                                  class: \"form-control search-box input-lg\" %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"col-md-2\"&gt;\n        &lt;%= button_tag(type: :submit, class: \"btn btn-lg btn-success\") do %&gt;\n          &lt;i class=\"fa fa-search\"&gt;&lt;/i&gt; Look up a tracker\n        &lt;% end %&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n\n  &lt;% end %&gt;\n&lt;/div&gt;\n\n&lt;div class=\"well results-block\"&gt;\n  &lt;%=@tracker.inspect%&gt;\n    &lt;strong&gt;ID: &lt;/strong&gt; &lt;%#= @tracker&amp;.flight_id %&gt;\n    &lt;strong&gt;Code: &lt;/strong&gt; &lt;%#= @tracker&amp;.carrier_fs_code %&gt;\n    &lt;strong&gt;Number: &lt;/strong&gt; &lt;%#= @tracker&amp;.flight_number %&gt;\n    &lt;strong&gt;Departure: &lt;/strong&gt; &lt;%#= @tracker&amp;.departure_airport_fs_code %&gt;\n    &lt;strong&gt;Arrival: &lt;/strong&gt; &lt;%#= @tracker&amp;.arrival_airport_fs_code %&gt;\n    &lt;%# &lt;strong&gt;Departure Terminal: &lt;/strong&gt; &lt;%= @tracker&amp;.departure_terminal %&gt; %&gt;\n  &lt;%=@position.inspect%&gt;  \n&lt;/div&gt;\n</code></pre>\n\n<p>So when an user searches for a <code>.by_flight_id</code> , I want it to show the related data for <code>.track_by_flight_id</code></p>\n\n<p>Hoping to move to the next stage of more data associations after a query is completed.</p>\n"}, {"tags": ["html", "ruby-on-rails", "ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1529487484, "post_id": 50944896, "comment_id": 88887298, "body": "Can you show the server logs for requests from both desktop and mobile?"}, {"owner": {"reputation": 91, "user_id": 9247411, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Iu7uOwMxffk/AAAAAAAAAAI/AAAAAAAALII/BnhI9ZFqPT8/photo.jpg?sz=128", "display_name": "Tanmay Jain", "link": "https://stackoverflow.com/users/9247411/tanmay-jain"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1529487887, "post_id": 50944896, "comment_id": 88887596, "body": "That&#39;s another problem, no logs are generated when the call is done from mobile."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1529491319, "post_id": 50944896, "comment_id": 88889815, "body": "Not sure what <code>target: :_blank</code> has got to do with this? You said you need to redirect the user, not open a new tab."}, {"owner": {"reputation": 91, "user_id": 9247411, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Iu7uOwMxffk/AAAAAAAAAAI/AAAAAAAALII/BnhI9ZFqPT8/photo.jpg?sz=128", "display_name": "Tanmay Jain", "link": "https://stackoverflow.com/users/9247411/tanmay-jain"}, "edited": false, "score": 0, "creation_date": 1529491543, "post_id": 50944896, "comment_id": 88889956, "body": "My bad, I need the search button to open a new tab. As the new tab has to be timed out after few minutes of inactivity."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1529492881, "post_id": 50944896, "comment_id": 88890789, "body": "You&#39;ve also tagged this as <code>javascript</code>, but there&#39;s no JS code in your question? I haven&#39;t encountered this issue before, but a quick google reveals that <a href=\"https://github.com/electron/electron/issues/2816\" rel=\"nofollow noreferrer\">others have</a>. Perhaps this is a bug in whichever mobile device/browser you&#39;re using? (You didn&#39;t specify.) Have you tried any alternate solutions, such as <a href=\"https://stackoverflow.com/a/35421291/1954610\">triggering a new window on submit</a> with JavaScript?"}, {"owner": {"reputation": 91, "user_id": 9247411, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Iu7uOwMxffk/AAAAAAAAAAI/AAAAAAAALII/BnhI9ZFqPT8/photo.jpg?sz=128", "display_name": "Tanmay Jain", "link": "https://stackoverflow.com/users/9247411/tanmay-jain"}, "edited": false, "score": 0, "creation_date": 1529498760, "post_id": 50944896, "comment_id": 88894697, "body": "Yes, I have tried various methods and none seem to work for me. The problem is occuring on both iOS and android (iPhone X, iPhone 6s, one plus 6), I have tested it on various browsers like Chrome, UC Browser, Safari all have same issue."}], "owner": {"reputation": 91, "user_id": 9247411, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Iu7uOwMxffk/AAAAAAAAAAI/AAAAAAAALII/BnhI9ZFqPT8/photo.jpg?sz=128", "display_name": "Tanmay Jain", "link": "https://stackoverflow.com/users/9247411/tanmay-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1529498607, "creation_date": 1529487251, "last_edit_date": 1529498607, "question_id": 50944896, "link": "https://stackoverflow.com/questions/50944896/form-submit-creates-get-call-instead-of-post-call-in-ruby-on-mobile-view", "title": "Form submit creates GET call instead of POST call in Ruby on mobile view", "body": "<p>I have searched through various answers but none have worked for me so far. So here is my form which is working fine when I do a form submission from web view, but on mobile the form automatically does a GET call instead of POST call.\nHowever when I remove, target: :_blank, it works fine on mobile. But I need to redirect user to a new page as I change URLs when search button is clicked.</p>\n\n<p>Current url: <a href=\"http://localhost:4000/hotels/470?website_template_id=3\" rel=\"nofollow noreferrer\">http://localhost:4000/hotels/470?website_template_id=3</a></p>\n\n<p>NewPage url: <a href=\"http://localhost:4000//booking_widget/availability\" rel=\"nofollow noreferrer\">http://localhost:4000//booking_widget/availability</a></p>\n\n<p>The same URLs are working fine on web though.\n<div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;div class=\"booking-widget\"&gt;\r\n  &lt;%= form_tag(\"#{Settings.host_url}/booking_widget/availability\", method: :post , target: :_blank , id: :booking_search_form,:class =&gt; \"form-inline reservation-horizontal clearfix\")%&gt;\r\n    &lt;div class=\"booking-area\"&gt;\r\n      &lt;div class=\"booking-values\"&gt;\r\n        &lt;h4&gt;CHECK IN&lt;/h4&gt;\r\n        &lt;input type=\"hidden\" id=\"check-in\" name=\"start_date\" value=\"\" /&gt;\r\n        &lt;p class=\"check-in\"&gt; &lt;span&gt;&lt;span&gt;&lt;/p&gt;\r\n        &lt;div id=\"from\"&gt;&lt;/div&gt;\r\n      &lt;/div&gt;\r\n      &lt;div class=\"booking-values\"&gt;\r\n        &lt;h4&gt;CHECK OUT&lt;/h4&gt;\r\n        &lt;input type=\"hidden\" id=\"check-out\" name=\"end_date\" value=\"\" /&gt;\r\n        &lt;p class=\"check-out\"&gt; &lt;span&gt;&lt;span&gt;&lt;/p&gt;\r\n        &lt;div id=\"to\"&gt;&lt;/div&gt;\r\n      &lt;/div&gt;\r\n      &lt;div class=\"booking-values\"&gt;\r\n        &lt;input type=\"hidden\" id=\"rooms\" name=\"rooms\" value=\"1\" /&gt;\r\n        &lt;h4&gt;ROOMS&lt;/h4&gt;\r\n        &lt;p class=\"rooms\"&gt;1&lt;/p&gt;\r\n        &lt;div class=\"dropdown\"&gt;\r\n          &lt;ul id=\"booking_room_select\"&gt;\r\n            &lt;%(1..@max_no_of_rooms).each do |num|%&gt;\r\n            &lt;li data-value=\"&lt;%=num%&gt;\"&gt;&lt;%=num%&gt;&lt;/li&gt;\r\n            &lt;%end%&gt;\r\n          &lt;/ul&gt;\r\n        &lt;/div&gt;\r\n      &lt;/div&gt;\r\n      &lt;div class=\"booking-values\"&gt;\r\n        &lt;input type=\"hidden\" id=\"adults\" name=\"adults\" value=\"1\" /&gt;\r\n        &lt;h4&gt;ADULTS&lt;/h4&gt;\r\n        &lt;p class=\"adults-click\"&gt;1&lt;/p&gt;\r\n        &lt;div class=\"adults-children\"&gt;\r\n          &lt;div class=\"room-set\"&gt;\r\n            &lt;div class=\"room-header\"&gt;\r\n              ROOM 1\r\n            &lt;/div&gt;\r\n            &lt;div class=\"room-changer\"&gt;\r\n              &lt;div class=\"changers adults\"&gt;\r\n                &lt;p&gt;ADULTS&lt;/p&gt;\r\n                &lt;input id=\"single_room_no_of_adults\" class=\"form-control numbers-count\" type=\"number\" value=\"1\" min=\"1\" max=\"&lt;%=@max_no_of_adults%&gt;\" disabled /&gt;\r\n              &lt;/div&gt;\r\n              &lt;div class=\"changers children\"&gt;\r\n                &lt;p&gt;CHILDREN&lt;/p&gt;\r\n                &lt;input id=\"single_room_no_of_children\" class=\"form-control numbers-count\" type=\"number\" value=\"0\" min=\"0\" max=\"&lt;%=@max_no_of_children%&gt;\" disabled /&gt;\r\n              &lt;/div&gt;\r\n            &lt;/div&gt;\r\n          &lt;/div&gt;\r\n        &lt;/div&gt;\r\n      &lt;/div&gt;\r\n      &lt;div class=\"booking-values\"&gt;\r\n        &lt;input type=\"hidden\" id=\"children\" name=\"children\" value=\"0\" /&gt;\r\n        &lt;h4&gt;CHILDREN&lt;/h4&gt;\r\n        &lt;p class=\"children-click\"&gt;0&lt;/p&gt;\r\n      &lt;/div&gt;\r\n      &lt;div class=\"booking-values hidden\"&gt;\r\n        &lt;input type=\"hidden\" name=\"hotel_id\" value=\"&lt;%=@hotel.id%&gt;\"/&gt;\r\n        &lt;input type=\"hidden\" name=\"currency\" value=\"INR\"/&gt;\r\n        &lt;input type=\"hidden\" name=\"party\" id=\"party\" value=\"\"/&gt;\r\n        &lt;input type=\"hidden\" id=\"website_template_id\" name=\"website_template_id\" value=\"3\" /&gt;\r\n      &lt;/div&gt;\r\n    &lt;/div&gt;\r\n    &lt;div class=\"booking-cta\"&gt;\r\n      &lt;button id=\"booking-widget-submit\" formmethod=\"post\" type=\"submit\"&gt;BOOK NOW&lt;/button&gt;\r\n    &lt;/div&gt;\r\n  &lt;/form&gt;\r\n  &lt;div class=\"clearfix\"&gt;&lt;/div&gt;\r\n&lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>My route is defined as:</p>\n\n<pre><code>post 'booking_widget/availability' =&gt; 'booking_widget#availability', :as =&gt; 'booking_availability'\n</code></pre>\n\n<p>The error message generated is:</p>\n\n<pre><code>No route matches [GET] \"/booking_widget/availability\"\n</code></pre>\n\n<p>And controller action is as such:</p>\n\n<pre><code>class Widget::BookingWidgetController &lt; ApplicationController\n  def availability\n    render(\"/website_templates/#{website_template_id}/bookings/booking_search_results\" ,:layout =&gt; false)\n  end\nend\n</code></pre>\n\n<p>Logs for Mobile request:</p>\n\n<pre><code>Rendered /Users/name/.rvm/gems/ruby-2.0.0-p648/gems/actionpack-3.2.18/lib/action_dispatch/middleware/templates/rescues/routing_error.erb within rescues/layout (1.5ms)\n</code></pre>\n\n<p>Logs for Web request:</p>\n\n<pre><code>Processing by Widget::BookingWidgetController#availability as HTML \nParameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"[FILTERED]\", \"start_date\"=&gt;\"20-6-2018\", \"end_date\"=&gt;\"21-6-2018\", \"rooms\"=&gt;\"1\", \"adults\"=&gt;\"1\", \"children\"=&gt;\"0\", \"hotel_id\"=&gt;\"470\", \"currency\"=&gt;\"INR\", \"party\"=&gt;\"[{\\\"adults\\\":\\\"1\\\",\\\"children\\\":[]}]\", \"website_template_id\"=&gt;\"3\"}\nRendered website_templates/3/hotel_website/_header.html.erb (31.2ms)\nRendered website_templates/3/hotel_website/_booking-widget-search-results.html.erb (44.2ms)\nRendered website_templates/3/hotel_website/_footer.html.erb (0.8ms)\nRendered website_templates/3/hotel_website/_scripts.html.erb (4.0ms)\nRendered website_templates/3/bookings/booking_search_results.html.erb (147.0ms)\nCompleted 200 OK in 6826.3ms (Views: 150.0ms | ActiveRecord: 882.9ms)\n</code></pre>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "postgresql"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 9966360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6566c1b6713dea9746bbcd052607564?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/9966360/j-doe"}, "edited": false, "score": 0, "creation_date": 1529486344, "post_id": 50944585, "comment_id": 88886524, "body": "This loses existing data even if it contains a valid UUID."}], "tags": [], "owner": {"reputation": 371, "user_id": 7800312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f16061080b5af47fb2dd4e5288684df8?s=128&d=identicon&r=PG&f=1", "display_name": "shreejana", "link": "https://stackoverflow.com/users/7800312/shreejana"}, "is_accepted": false, "score": 3, "last_activity_date": 1529486467, "last_edit_date": 1529486467, "creation_date": 1529486210, "answer_id": 50944585, "question_id": 50944067, "link": "https://stackoverflow.com/questions/50944067/rails-psql-how-to-convert-a-column-of-type-string-to-uuid-with-a-fallback-val/50944585#50944585", "title": "Rails &amp; PSQL: how to convert a column of type STRING to UUID with a fallback value", "body": "<p>First, create a migration with <code>uuid-ossp</code> and <code>pgcrypto</code> </p>\n\n<pre><code>class EnableUuidExtension &lt; ActiveRecord::Migration[5.2]\n      def change\n        enable_extension 'uuid-ossp'\n        enable_extension 'pgcrypto'\n      end\n    end\n</code></pre>\n\n<p>Then, create another migration to convert <code>id</code> into <code>uuid</code>. For instance, </p>\n\n<pre><code>class ChangeIdToUuidInUser &lt; ActiveRecord::Migration[5.2]\n  def change\n    add_column :users, :uuid, :uuid, default: 'uuid_generate_v4()', null: false\n    change_table :users do |t|\n      t.remove :id\n      t.rename :uuid, :id\n    end\n    execute 'ALTER TABLE users ADD PRIMARY KEY (id);'\n  end\nend\n</code></pre>\n\n<p>After then open postgres database with this command <code>psql -U username databaseName</code>\n You will enter in postgres shell, run following command</p>\n\n<pre><code>=# CREATE EXTENSION pgcrypto;\n=# \\q\n</code></pre>\n\n<p>Finally, run <code>rails db:migrate</code> </p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 9966360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6566c1b6713dea9746bbcd052607564?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/9966360/j-doe"}, "is_accepted": true, "score": 0, "last_activity_date": 1529562863, "last_edit_date": 1529562863, "creation_date": 1529490997, "answer_id": 50946194, "question_id": 50944067, "link": "https://stackoverflow.com/questions/50944067/rails-psql-how-to-convert-a-column-of-type-string-to-uuid-with-a-fallback-val/50946194#50946194", "title": "Rails &amp; PSQL: how to convert a column of type STRING to UUID with a fallback value", "body": "<p>This is what I ended up doing:</p>\n\n<pre><code>class UpdateCreatorIdInCommunities &lt; ActiveRecord::Migration[5.1]\n    def up\n        execute \"CREATE OR REPLACE FUNCTION string_to_uuid(text, uuid) RETURNS uuid AS $$\n        BEGIN\n          RETURN $1::uuid;\n        EXCEPTION\n          WHEN invalid_text_representation THEN\n            RETURN $2;\n        END;\n        $$ language plpgsql immutable;\"\n        last_user_created = User.order(:created_at).last\n        user_id = last_user_created ? quote(last_user_created.id) : \"NULL\"\n        change_column :communities, :creator_id, \"uuid USING string_to_uuid(\\\"creator_id\\\", #{user_id})\"\n    end\n\n    def down\n        change_column :communities, :creator_id, :string\n    end\nend\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 9966360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6566c1b6713dea9746bbcd052607564?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/9966360/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1465, "favorite_count": 0, "accepted_answer_id": 50946194, "answer_count": 2, "score": 4, "last_activity_date": 1529562863, "creation_date": 1529484709, "question_id": 50944067, "link": "https://stackoverflow.com/questions/50944067/rails-psql-how-to-convert-a-column-of-type-string-to-uuid-with-a-fallback-val", "title": "Rails &amp; PSQL: how to convert a column of type STRING to UUID with a fallback value", "body": "<p>I'm using an extension called 'pgcrypto' to add a support for UUIDs.</p>\n\n<p>Currently I have a column called <code>creator_id</code> of type string but I want to change its type to UUID.</p>\n\n<p>At first I tried:</p>\n\n<pre><code>change_column :communities, :creator_id, :uuid\n</code></pre>\n\n<p>And I got this:</p>\n\n<pre><code>PG::DatatypeMismatch: ERROR:  column \"creator_id\" cannot be cast automatically to type uuid\nHINT:  You might need to specify \"USING creator_id::uuid\".\n</code></pre>\n\n<p>So I tried:</p>\n\n<pre><code>change_column :communities, :creator_id, \"uuid USING creator_id::uuid\"\n</code></pre>\n\n<p>The problem is, during early stages of development it was filled with placeholder values that don't even look like a UUID, so I'm getting the following error:</p>\n\n<pre><code>PG::InvalidTextRepresentation: ERROR:  invalid input syntax for type uuid\n</code></pre>\n\n<p>So I want to fallback to some default UUID when such an exception is raised. How do I achieve that?</p>\n"}, {"tags": ["ruby", "namespaces"], "comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1529497969, "post_id": 50943140, "comment_id": 88894179, "body": "<a href=\"https://stackoverflow.com/questions/34338131/why-doesnt-ruby-find-classes-in-a-higher-scope-when-module-is-specified-using\" title=\"why doesnt ruby find classes in a higher scope when module is specified using\">stackoverflow.com/questions/34338131/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1529486746, "post_id": 50943199, "comment_id": 88886787, "body": "The former looks for <code>Lion</code> in <code>Cat::Cheetah</code>, then in <code>Cat</code> and finally at the top-level. Whereas the latter looks in <code>Cat::MountainLion</code> and then at the top-level, thus skipping <code>Cat</code>."}], "tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": true, "score": 1, "last_activity_date": 1529482091, "last_edit_date": 1529482091, "creation_date": 1529481654, "answer_id": 50943199, "question_id": 50943140, "link": "https://stackoverflow.com/questions/50943140/different-ways-of-namespacing-in-ruby/50943199#50943199", "title": "Different Ways of Namespacing in Ruby", "body": "<p>These two ways differ in the constant lookup. The former looks for <code>Lion</code> constant in <code>Cat</code> namespace, which is correct. The latter looks for <code>::Lion</code>, in global namespace, which is obviously incorrect, since you don't have such constant. </p>\n\n<p>For more information about this topic, please visit this page:\n<a href=\"https://cirw.in/blog/constant-lookup.html\" rel=\"nofollow noreferrer\">https://cirw.in/blog/constant-lookup.html</a></p>\n"}], "owner": {"reputation": 9131, "user_id": 278549, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/263c116245b8bd793960b08deadcaa6e?s=128&d=identicon&r=PG", "display_name": "Willy", "link": "https://stackoverflow.com/users/278549/willy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 50943199, "answer_count": 1, "score": 0, "last_activity_date": 1529488230, "creation_date": 1529481466, "question_id": 50943140, "link": "https://stackoverflow.com/questions/50943140/different-ways-of-namespacing-in-ruby", "title": "Different Ways of Namespacing in Ruby", "body": "<p>AFAIK I know these two ways of namespacing in ruby:</p>\n\n<pre><code>module Cat\n  class Lion\n    def hunt\n      p 'roaming for prey ...'\n    end\n  end\n\n  class Cheetah\n    def hunt\n      Lion.new.hunt\n      p 'Oops there is a lion. Hide first ...'\n    end\n  end\nend\n\nclass Cat::MountainLion\n  def hunt\n    Lion.new.hunt\n    p 'roaming for prey ... (since I dont live in the same continent as lion)'\n  end\nend\n\nCat::Cheetah.new.hunt\nCat::MountainLion.new.hunt\n</code></pre>\n\n<p>Why is it the <code>Cat::MountainLion.new.hunt</code> doesn't work? Are namespace declared as <code>module</code> differs to those declared as prefix to class <code>class Cat::</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ajax"], "comments": [{"owner": {"reputation": 476, "user_id": 2645167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEnRe.jpg?s=128&g=1", "display_name": "andriy-baran", "link": "https://stackoverflow.com/users/2645167/andriy-baran"}, "edited": false, "score": 2, "creation_date": 1529482068, "post_id": 50943098, "comment_id": 88884001, "body": "Create a model which has references to user and product, than add a correspond controller to CRUD user&#39;s favorite products"}, {"owner": {"reputation": 714, "user_id": 2721332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f613d619067de58f480eb6304f0f390?s=128&d=identicon&r=PG&f=1", "display_name": "seethrough", "link": "https://stackoverflow.com/users/2721332/seethrough"}, "edited": false, "score": 0, "creation_date": 1529482116, "post_id": 50943098, "comment_id": 88884037, "body": "just add a model <code>Favourite</code> making user <code>has_many :favourites</code>. Don&#39;t afraid to do it from scratch."}, {"owner": {"reputation": 3, "user_id": 9662812, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Ja5y.jpg?s=128&g=1", "display_name": "Gonzalo Diaz", "link": "https://stackoverflow.com/users/9662812/gonzalo-diaz"}, "edited": false, "score": 0, "creation_date": 1529482424, "post_id": 50943098, "comment_id": 88884233, "body": "I have done the model and references, would you happen to know the AJAX?"}, {"owner": {"reputation": 714, "user_id": 2721332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f613d619067de58f480eb6304f0f390?s=128&d=identicon&r=PG&f=1", "display_name": "seethrough", "link": "https://stackoverflow.com/users/2721332/seethrough"}, "edited": false, "score": 0, "creation_date": 1529482665, "post_id": 50943098, "comment_id": 88884371, "body": "post the part of html where you have each product having heart button or whatever  and controller method that accepts that request"}, {"owner": {"reputation": 3, "user_id": 9662812, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Ja5y.jpg?s=128&g=1", "display_name": "Gonzalo Diaz", "link": "https://stackoverflow.com/users/9662812/gonzalo-diaz"}, "edited": false, "score": 0, "creation_date": 1529483066, "post_id": 50943098, "comment_id": 88884603, "body": "I dont have the controller defined, the html is just cards with a disable linked_to and a &#39;plus&#39; icon which is what I hope to be the favorites"}, {"owner": {"reputation": 714, "user_id": 2721332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f613d619067de58f480eb6304f0f390?s=128&d=identicon&r=PG&f=1", "display_name": "seethrough", "link": "https://stackoverflow.com/users/2721332/seethrough"}, "edited": false, "score": 0, "creation_date": 1529483751, "post_id": 50943098, "comment_id": 88884986, "body": "please include my nickname in comments by doing <code>@seethrough</code>, thus i will be notified of your comment. Secondly, just post the html for product including <code>for</code> loop, perhaps omitting some parts not related to question."}, {"owner": {"reputation": 3, "user_id": 9662812, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Ja5y.jpg?s=128&g=1", "display_name": "Gonzalo Diaz", "link": "https://stackoverflow.com/users/9662812/gonzalo-diaz"}, "reply_to_user": {"reputation": 714, "user_id": 2721332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f613d619067de58f480eb6304f0f390?s=128&d=identicon&r=PG&f=1", "display_name": "seethrough", "link": "https://stackoverflow.com/users/2721332/seethrough"}, "edited": false, "score": 0, "creation_date": 1530724154, "post_id": 50943098, "comment_id": 89339256, "body": "@seethrough thanks, the HTML would be irrelevant. I would need the JS to make my favorites icons react with AJAX and not re-render the page....I am building this in Rails btw.. thanks"}], "owner": {"reputation": 3, "user_id": 9662812, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Ja5y.jpg?s=128&g=1", "display_name": "Gonzalo Diaz", "link": "https://stackoverflow.com/users/9662812/gonzalo-diaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1529481325, "creation_date": 1529481325, "question_id": 50943098, "link": "https://stackoverflow.com/questions/50943098/ruby-on-rails-add-to-favorites-with-ajax", "title": "Ruby on Rails &#39;add to favorites&#39; (with AJAX)", "body": "<p>I am trying to do 'add to favorites' (with AJAX) feature in my Ruby on Rails app (marketplace), anyone knows what's the best methodology? I did get suggested, 'acts as votable' gem but this looks like a vote system not like a record keeper. SOS </p>\n"}, {"tags": ["ruby", "mime"], "comments": [{"owner": {"reputation": 13, "user_id": 9635845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6be7b5da8b9a014c05810b39def515c0?s=128&d=identicon&r=PG&f=1", "display_name": "K. Alex", "link": "https://stackoverflow.com/users/9635845/k-alex"}, "edited": false, "score": 0, "creation_date": 1529486711, "post_id": 50941827, "comment_id": 88886763, "body": "Thank you, it is strange that I could not find the answer, although I was looking"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1529490495, "post_id": 50941827, "comment_id": 88889266, "body": "I&#39;ve added the &quot;RFC 2047&quot; part to the other question&#39;s title. Maybe you couldn&#39;t find it because it was missing."}], "owner": {"reputation": 13, "user_id": 9635845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6be7b5da8b9a014c05810b39def515c0?s=128&d=identicon&r=PG&f=1", "display_name": "K. Alex", "link": "https://stackoverflow.com/users/9635845/k-alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "closed_date": 1529478671, "answer_count": 0, "score": 0, "last_activity_date": 1529476962, "creation_date": 1529476962, "question_id": 50941827, "link": "https://stackoverflow.com/questions/50941827/does-it-exist-mime-headers-decoder-rfc-2047-for-ruby", "closed_reason": "Duplicate", "title": "Does it exist MIME Headers Decoder (RFC 2047) for ruby?", "body": "<p>I have encoded header (part for example: =?UTF-8?B?ZXIgQXNzZXJ0aW9uIElzc3Vlcjwvc2FtbDpJc3N1ZQ==?= =?UTF-8?B?cj48ZHNpZzpTaWduYXR1cmUgeG1sbnM6ZHNpZz0iaA==?=)</p>\n\n<p>How can i decode it to normal view with ruby? (er Assertion Issuer\n\n<p>Base64.decode64 - does not work</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1529471941, "post_id": 50940701, "comment_id": 88879133, "body": "did you do <code>bundle install</code> after upgrading the Ruby version?"}, {"owner": {"reputation": 542, "user_id": 1927604, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f35d9ed3f19ded110e123899c2a0f0ab?s=128&d=identicon&r=PG", "display_name": "darkginger", "link": "https://stackoverflow.com/users/1927604/darkginger"}, "reply_to_user": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1529472005, "post_id": 50940701, "comment_id": 88879158, "body": "I did. <code>Bundle complete! 14 Gemfile dependencies, 76 gems now installed. Use </code>bundle info [gemname]` to see where a bundled gem is installed.`. Then I restarted the terminal."}, {"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1529472040, "post_id": 50940701, "comment_id": 88879167, "body": "try <code>bundle exec rake db:create</code>"}, {"owner": {"reputation": 542, "user_id": 1927604, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f35d9ed3f19ded110e123899c2a0f0ab?s=128&d=identicon&r=PG", "display_name": "darkginger", "link": "https://stackoverflow.com/users/1927604/darkginger"}, "reply_to_user": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1529472124, "post_id": 50940701, "comment_id": 88879197, "body": "Same error as above. <code>LoadError: incompatible library version</code>. Thank you though."}, {"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1529472320, "post_id": 50940701, "comment_id": 88879279, "body": "goto <code>&#47;Users&#47;jp&#47;.rvm&#47;gems&#47;ruby-2.5.1&#47;gems&#47;</code> and see how many <code>bootsnap</code> versions do you see. Also try <code>gem list bootsnap</code> from project root and check the output"}, {"owner": {"reputation": 542, "user_id": 1927604, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f35d9ed3f19ded110e123899c2a0f0ab?s=128&d=identicon&r=PG", "display_name": "darkginger", "link": "https://stackoverflow.com/users/1927604/darkginger"}, "reply_to_user": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1529472488, "post_id": 50940701, "comment_id": 88879345, "body": "Looks good. <code>gem list</code> only shows one version <code>bootsnap (1.3.0, 1.1.7)</code> which is consistent with our gemfile."}, {"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1529472651, "post_id": 50940701, "comment_id": 88879392, "body": "<code>(1.3.0, 1.1.7)</code> are two versions, I think one of them is incompatible with your ruby version"}], "answers": [{"tags": [], "owner": {"reputation": 384, "user_id": 4823919, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a31d1f14b813262b3e237b2a522a53a2?s=128&d=identicon&r=PG", "display_name": "Gokul p", "link": "https://stackoverflow.com/users/4823919/gokul-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1529472720, "creation_date": 1529472720, "answer_id": 50940879, "question_id": 50940701, "link": "https://stackoverflow.com/questions/50940701/issues-after-upgrading-to-ruby-2-5-1-incompatible-library-version/50940879#50940879", "title": "Issues after upgrading to Ruby 2.5.1 - &quot;Incompatible library version&quot;", "body": "<p>This may be a <code>pg</code> gem version problem. Use <code>gem 'pg', '~&gt; 0.21.0'</code> in your Gemfile then do the <code>bundle install</code>. This will resolve.</p>\n"}, {"tags": [], "owner": {"reputation": 3090, "user_id": 4454732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-8OrTJkCtkn4/AAAAAAAAAAI/AAAAAAAAA4s/7jp2lrThK2k/photo.jpg?sz=128", "display_name": "David Hempy", "link": "https://stackoverflow.com/users/4454732/david-hempy"}, "is_accepted": false, "score": 0, "last_activity_date": 1591740270, "creation_date": 1591740270, "answer_id": 62292621, "question_id": 50940701, "link": "https://stackoverflow.com/questions/50940701/issues-after-upgrading-to-ruby-2-5-1-incompatible-library-version/62292621#62292621", "title": "Issues after upgrading to Ruby 2.5.1 - &quot;Incompatible library version&quot;", "body": "<p>I just spend several hours on a very similar error, after upgrading a Ruby app from ruby 2.4 to 2.6. I'm using rbenv and bundler on MacOS Mojave.</p>\n\n<p>I uninstalled about a dozen old versions of ruby and started clean. This got me past the exact error in the question.</p>\n\n<p>This may be overkill, but it worked for me:</p>\n\n<p>List all installed ruby versions:</p>\n\n<pre><code>rbenv versions\n</code></pre>\n\n<p>Uninstall all versions of Ruby.</p>\n\n<pre><code>rbenv uninstall 2.1\nrbenv uninstall 2.1.9\netc.\n</code></pre>\n\n<p>Install needed version(s) of Ruby</p>\n\n<pre><code>rbenv install\n\nbundle install\n</code></pre>\n\n<p>I tried running my app after <code>bundle install</code> and got dozens of warnings like these:</p>\n\n<pre><code>Ignoring binding_of_caller-0.8.0 because its extensions are not built.  Try: gem pristine binding_of_caller --version 0.8.0\nIgnoring binding_of_caller-0.7.2 because its extensions are not built.  Try: gem pristine binding_of_caller --version 0.7.2\nIgnoring bootsnap-1.4.6 because its extensions are not built.  Try: gem pristine bootsnap --version 1.4.6\n</code></pre>\n\n<p>At that time, I could not run <code>bundle exec rake</code></p>\n\n<pre><code>% bundle exec rake\nbundler: command not found: rake\nInstall missing gem executables with `bundle install`\n</code></pre>\n\n<p>Running <code>bundle</code> appeared successful, but did not update Gemfile.lock, and did not fix the problem.</p>\n\n<p>Finally, restoring all the gems to pristine solved the problem:</p>\n\n<pre><code>gem pristine --all\n</code></pre>\n\n<p>I could now run the app, rake, etc. </p>\n"}], "owner": {"reputation": 542, "user_id": 1927604, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f35d9ed3f19ded110e123899c2a0f0ab?s=128&d=identicon&r=PG", "display_name": "darkginger", "link": "https://stackoverflow.com/users/1927604/darkginger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1214, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1591740270, "creation_date": 1529471864, "question_id": 50940701, "link": "https://stackoverflow.com/questions/50940701/issues-after-upgrading-to-ruby-2-5-1-incompatible-library-version", "title": "Issues after upgrading to Ruby 2.5.1 - &quot;Incompatible library version&quot;", "body": "<p>After using Homebrew to upgrade to Ruby 2.5.1, I am having issues creating my database in <code>pg</code>. </p>\n\n<p>When I run <code>rake db:create</code> for the first time, the rake is aborted with an error like:</p>\n\n<pre><code>rake db:create \nrake aborted!\nLoadError: incompatible library version - /Users/jp/.rvm/gems/ruby-2.5.1/gems/bootsnap-1.3.0/lib/bootsnap/bootsnap.bundle\n/Users/jp/.rvm/gems/ruby-2.5.1/gems/bootsnap-1.3.0/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `require'\n/Users/jp/.rvm/gems/ruby-2.5.1/gems/bootsnap-1.3.0/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `block in require_with_bootsnap_lfi'\n/Users/jp/.rvm/gems/ruby-2.5.1/gems/bootsnap-1.3.0/lib/bootsnap/load_path_cache/loaded_features_index.rb:65:in `register'\n</code></pre>\n\n<p>I've confirmed that I have that version of Ruby running: </p>\n\n<pre><code>ruby -v\nruby 2.5.1p57 (2018-03-29 revision 63029) [x86_64-darwin17]\n</code></pre>\n\n<p>I've also checked my Gemfile, and I have a recent Rails version installed (<code>rails (5.2.0)</code>). </p>\n\n<p>Have not found any similar issues on Stack Overflow or elsewhere. Any idea where to begin with this one? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "simplecov"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8114264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c1db5ab62689ed9ab186188ff6883ce?s=128&d=identicon&r=PG&f=1", "display_name": "Akash Mehrotra", "link": "https://stackoverflow.com/users/8114264/akash-mehrotra"}, "edited": false, "score": 0, "creation_date": 1529846987, "post_id": 51001366, "comment_id": 89013427, "body": "Hi...I have already used it for the unit test cases. BUT as described above we have a separate test repo for BDD test. So, how to use simplecov? Can you please provide more info"}], "tags": [], "owner": {"reputation": 9, "user_id": 5479407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9a6cbcca2ae4e9d0916780d8773bc4e?s=128&d=identicon&r=PG", "display_name": "Chung Ph\u01b0\u1edbc", "link": "https://stackoverflow.com/users/5479407/chung-ph%c6%b0%e1%bb%9bc"}, "is_accepted": false, "score": 0, "last_activity_date": 1529758568, "creation_date": 1529758568, "answer_id": 51001366, "question_id": 50940514, "link": "https://stackoverflow.com/questions/50940514/finding-code-coverage-for-rails-project/51001366#51001366", "title": "Finding Code coverage for rails project", "body": "<p>This gem <a href=\"https://github.com/colszowka/simplecov\" rel=\"nofollow noreferrer\">https://github.com/colszowka/simplecov</a> should fulfill your requirements.</p>\n"}], "owner": {"reputation": 21, "user_id": 8114264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c1db5ab62689ed9ab186188ff6883ce?s=128&d=identicon&r=PG&f=1", "display_name": "Akash Mehrotra", "link": "https://stackoverflow.com/users/8114264/akash-mehrotra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1529758568, "creation_date": 1529470928, "question_id": 50940514, "link": "https://stackoverflow.com/questions/50940514/finding-code-coverage-for-rails-project", "title": "Finding Code coverage for rails project", "body": "<p>Problem Statement: To find the code coverage for a rails project. We are using a separate repository for test framework which follows RSpec-Capybara structure. Are there any tools/gems to find the coverage where tests are outside the dev repository?</p>\n\n<p>Also, We have already used 'simplecov' gem for finding coverage of unit tests, so can it be used in a case where dev and test repo are different? If yes, then how?</p>\n"}, {"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1529461868, "post_id": 50938940, "comment_id": 88876833, "body": "yeah it&#39;s a good idea to split it up into hierarchical folders. If you keep everything &#39;flat&#39; (e.g. at the same level of folder nesting) it will grow way too big."}], "answers": [{"comments": [{"owner": {"reputation": 1176, "user_id": 2750877, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/65fe7528984db6c53fa2e13e9b574708?s=128&d=identicon&r=PG&f=1", "display_name": "bork", "link": "https://stackoverflow.com/users/2750877/bork"}, "edited": false, "score": 1, "creation_date": 1529467304, "post_id": 50939876, "comment_id": 88877923, "body": "Could be worth pointing to a source, and further reading too. Like this one: <a href=\"https://relishapp.com/rspec/rspec-rails/docs/directory-structure\" rel=\"nofollow noreferrer\">relishapp.com/rspec/rspec-rails/docs/directory-structure</a>"}], "tags": [], "owner": {"reputation": 340, "user_id": 6855759, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3UfK3V6lnPY/AAAAAAAAAAI/AAAAAAAAAlU/CG1lontACf0/photo.jpg?sz=128", "display_name": "Caleb Keene", "link": "https://stackoverflow.com/users/6855759/caleb-keene"}, "is_accepted": true, "score": 0, "last_activity_date": 1529467160, "last_edit_date": 1529467160, "creation_date": 1529466267, "answer_id": 50939876, "question_id": 50938940, "link": "https://stackoverflow.com/questions/50938940/should-rspec-file-structure-match-file-structure-of-code-being-tested/50939876#50939876", "title": "Should Rspec file structure match file structure of code being tested?", "body": "<blockquote>\n  <p>In my spec directory, should I follow the same structure?</p>\n</blockquote>\n\n<p>Yes. </p>\n\n<p>Usually in RSpec the spec structure matches the directory structure of the files under test.</p>\n\n<p>Another example (when using Rails): </p>\n\n<p><code>spec/controllers/users_controller_spec.rb</code> would test <code>app/controllers/users_controller.rb</code></p>\n"}], "owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 50939876, "answer_count": 1, "score": 1, "last_activity_date": 1529467160, "creation_date": 1529457866, "question_id": 50938940, "link": "https://stackoverflow.com/questions/50938940/should-rspec-file-structure-match-file-structure-of-code-being-tested", "title": "Should Rspec file structure match file structure of code being tested?", "body": "<p>I am writing a gem. I want to test some of the classes. I have them in modules.</p>\n\n<p>The file structure:</p>\n\n<pre><code>my_gem\n  /lib\n    /my_gem\n      /practices\n        /texas\n          /medical_practice.rb\n</code></pre>\n\n<p>medical_practice.rb:          </p>\n\n<pre><code>module MyGem\n  module Practices\n    module Texas\n      class MedicalPractice &lt; Practice            \n      end\n    end\n  end\nend\n</code></pre>\n\n<p>In my spec directory, should I follow the same structure?</p>\n\n<pre><code>spec\n  /practices\n    /texas\n      /medical_practice_spec.rb\n</code></pre>\n\n<p>Or is it best practice to place medical_practice_spec.rb right under the /spec directory?</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "date"], "comments": [{"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1529455948, "post_id": 50938684, "comment_id": 88875678, "body": "Show the migration or <code>schema.rb</code> for your current model, if you think it should have a member <code>start_date</code>..."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1529475213, "post_id": 50938684, "comment_id": 88880405, "body": "Show full controller action code."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 8502602, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wk__T8zontw/AAAAAAAAAAI/AAAAAAAAANw/79eaQxtWWA0/photo.jpg?sz=128", "display_name": "Belal Kamara", "link": "https://stackoverflow.com/users/8502602/belal-kamara"}, "edited": false, "score": 0, "creation_date": 1529530651, "post_id": 50938721, "comment_id": 88912198, "body": "When I tried that it have <code>undefined local variable or method </code>start_date&#39; for #&lt;ActivitiesController:0x007fa5ae201768&gt;<code>. So I added </code>@activity_events.start_date` (which is the name of the table in the controller) and I got this <code>undefined method </code>start_date&#39; for nil:NilClass`"}], "tags": [], "owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "is_accepted": false, "score": 1, "last_activity_date": 1529455663, "creation_date": 1529455663, "answer_id": 50938721, "question_id": 50938684, "link": "https://stackoverflow.com/questions/50938684/ruby-how-to-loop-the-fetch-call/50938721#50938721", "title": "Ruby: How to loop the fetch call", "body": "<p><code>Date.parse(:start_date)</code> is passing a symbol; that caused the error. Would <code>Date.parse(start_date)</code> work?</p>\n"}, {"comments": [{"owner": {"reputation": 340, "user_id": 6855759, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3UfK3V6lnPY/AAAAAAAAAAI/AAAAAAAAAlU/CG1lontACf0/photo.jpg?sz=128", "display_name": "Caleb Keene", "link": "https://stackoverflow.com/users/6855759/caleb-keene"}, "reply_to_user": {"reputation": 7, "user_id": 8502602, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wk__T8zontw/AAAAAAAAAAI/AAAAAAAAANw/79eaQxtWWA0/photo.jpg?sz=128", "display_name": "Belal Kamara", "link": "https://stackoverflow.com/users/8502602/belal-kamara"}, "edited": false, "score": 0, "creation_date": 1529547816, "post_id": 50939816, "comment_id": 88916126, "body": "It seems to you&#39;re missing a fundamental concept here:  <code>Activity</code> is a class. What you&#39;re talking about doing requires an instance of this class (which will be an <code>ActiveRecord</code> object).  At the moment you&#39;re calling the <code>start_date</code> method on the class itself, when you should be calling it on an instance of the class, e.g. <code>activity = Activity.new(start_date: Date.today)</code> ...then you can do <code>activity.start_date</code> to access this property of the object."}], "tags": [], "owner": {"reputation": 340, "user_id": 6855759, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3UfK3V6lnPY/AAAAAAAAAAI/AAAAAAAAAlU/CG1lontACf0/photo.jpg?sz=128", "display_name": "Caleb Keene", "link": "https://stackoverflow.com/users/6855759/caleb-keene"}, "is_accepted": false, "score": 0, "last_activity_date": 1529466080, "last_edit_date": 1529466080, "creation_date": 1529465779, "answer_id": 50939816, "question_id": 50938684, "link": "https://stackoverflow.com/questions/50938684/ruby-how-to-loop-the-fetch-call/50939816#50939816", "title": "Ruby: How to loop the fetch call", "body": "<p>The error is clear - you're calling <code>start_date</code> on <code>self</code>, which in this scope is the <code>ActivitiesController</code> class. This method isn't defined in this class so it's raising an error. If you have an ActiveRecord instance object of type <code>Activity</code> that responds to this message, then call it on that instead. The only way this code would work is if you have a method <code>start_date</code> within this controller that returns a string representation of a date/time.</p>\n\n<p>If you are calling it on such an object (Activity), but it's still not working, then in all likelihood your <code>activities</code> table is missing a <code>start_date</code> datetime column. If it doesn't, add the column (can use the rails generator to create the migration)</p>\n\n<p>In your rails root directory:\n<code>bundle exec rails g migration add_start_date_to_activities start_date:datetime</code>\nthen run <code>bundle exec rake db:migrate</code> and you should be good to go</p>\n"}, {"comments": [{"owner": {"reputation": 2313, "user_id": 2906559, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dcfc0f9353431d8a74b4792d9e6cc6c5?s=128&d=identicon&r=PG", "display_name": "errakeshpd", "link": "https://stackoverflow.com/users/2906559/errakeshpd"}, "reply_to_user": {"reputation": 7, "user_id": 8502602, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wk__T8zontw/AAAAAAAAAAI/AAAAAAAAANw/79eaQxtWWA0/photo.jpg?sz=128", "display_name": "Belal Kamara", "link": "https://stackoverflow.com/users/8502602/belal-kamara"}, "edited": false, "score": 0, "creation_date": 1529568792, "post_id": 50940076, "comment_id": 88923703, "body": "Hmm, here is the problem, as you can see @activity_events  is an active record of model named &#39;Class&#39;. You should try with an active record of model &quot;Activity&quot;"}, {"owner": {"reputation": 2313, "user_id": 2906559, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dcfc0f9353431d8a74b4792d9e6cc6c5?s=128&d=identicon&r=PG", "display_name": "errakeshpd", "link": "https://stackoverflow.com/users/2906559/errakeshpd"}, "reply_to_user": {"reputation": 7, "user_id": 8502602, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wk__T8zontw/AAAAAAAAAAI/AAAAAAAAANw/79eaQxtWWA0/photo.jpg?sz=128", "display_name": "Belal Kamara", "link": "https://stackoverflow.com/users/8502602/belal-kamara"}, "edited": false, "score": 0, "creation_date": 1529568974, "post_id": 50940076, "comment_id": 88923811, "body": "Try by. &#39;Activity.first.start_date&#39;  What is the o/p"}], "tags": [], "owner": {"reputation": 2313, "user_id": 2906559, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dcfc0f9353431d8a74b4792d9e6cc6c5?s=128&d=identicon&r=PG", "display_name": "errakeshpd", "link": "https://stackoverflow.com/users/2906559/errakeshpd"}, "is_accepted": false, "score": 0, "last_activity_date": 1529467628, "creation_date": 1529467628, "answer_id": 50940076, "question_id": 50938684, "link": "https://stackoverflow.com/questions/50938684/ruby-how-to-loop-the-fetch-call/50940076#50940076", "title": "Ruby: How to loop the fetch call", "body": "<p>From your first attempt it is clear that \"self\" is not an active record. use your active record object to get 'start_date'.</p>\n\n<pre><code>@record.start_date\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 8502602, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wk__T8zontw/AAAAAAAAAAI/AAAAAAAAANw/79eaQxtWWA0/photo.jpg?sz=128", "display_name": "Belal Kamara", "link": "https://stackoverflow.com/users/8502602/belal-kamara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1530444598, "creation_date": 1529455296, "last_edit_date": 1530444598, "question_id": 50938684, "link": "https://stackoverflow.com/questions/50938684/ruby-how-to-loop-the-fetch-call", "title": "Ruby: How to loop the fetch call", "body": "<p>I am trying to compare dates but is in an array and the way I figured out to get the dates out of the way is using the <code>.fetch</code> call. \nSo, currently the code is <code>Activity.pluck(:start_date).fetch(1)</code> but I want to call the fetch function and for all.</p>\n\n<p>Does anyone know of a method that will return each values in an array to a Date?                                                          </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1529511008, "post_id": 50938417, "comment_id": 88902960, "body": "Seems more like an opinion-based code review question. Personally I find fluff like <code>FileProcessorFactory</code> and <code>ChocolateTotalsCalculator</code> to be anti-patterns in Ruby. With stuff like duck typing and blocks you can achieve similar levels of flexibility in a much more succinct and expressive way."}, {"owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "reply_to_user": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1529512862, "post_id": 50938417, "comment_id": 88904017, "body": "Great advice. Thank you man. Mind making this a full fleshed answer for me? For something like ChocolateTotalsCalculator... which is the heart of the program... how would you rename this? Eventually, wouldn&#39;t you want a full concrete class with specifics to do the actual work for you?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9966566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Ibxe.png?s=128&g=1", "display_name": "James Denness", "link": "https://stackoverflow.com/users/9966566/james-denness"}, "is_accepted": false, "score": 0, "last_activity_date": 1529519492, "creation_date": 1529519492, "answer_id": 50954904, "question_id": 50938417, "link": "https://stackoverflow.com/questions/50938417/naming-different-files-handler-io-stream-processor-controller/50954904#50954904", "title": "Naming different files. Handler? IO? Stream? Processor? Controller?", "body": "<p>This seems like quite a 'java' way of thinking - in Ruby I haven't seen patterns like this used very often. I'd say that you might only really need the DataProcessor class. CSVProcessor and ChocolateTotalsConverter have only class methods, which might be more idiomatic if they were instance methods of DataProcessor instead. I'd start there and see how you feel about it.</p>\n"}, {"tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1529521318, "creation_date": 1529521318, "answer_id": 50955317, "question_id": 50938417, "link": "https://stackoverflow.com/questions/50938417/naming-different-files-handler-io-stream-processor-controller/50955317#50955317", "title": "Naming different files. Handler? IO? Stream? Processor? Controller?", "body": "<p>Ruby isn't a <a href=\"https://steve-yegge.blogspot.com/2006/03/execution-in-kingdom-of-nouns.html\" rel=\"nofollow noreferrer\">kingdom of nouns</a>. Some programmers hear \"everything is an object\" and think \"I am processing data, therefore I need a <code>DataProcessor</code> object!\" But in Ruby, \"every<strong>thing</strong> is an object\". There's only one novel \"thing\" in your example: a chocolate order (maybe redemptions, too). So you only need one custom class: <code>ChocolateOrder</code>. The other \"things\" we already have objects for: <code>CSV</code> represents the CSV file, <code>Array</code> (or <code>Set</code> or <code>Hash</code>) can represent the collection of chocolate orders.</p>\n\n<p><em>Processing</em> a CSV row into an order, <em>converting</em> an order into workable data, and <em>totaling</em> those data into a result aren't \"things\". They're actions! In Ruby, actions are methods, blocks, procs, lambdas, or top-level functions*. In your case I see a method like <code>ChocolateOrder#payment</code> for getting just the price to add up, then maybe some blocks for the rest of the processing.</p>\n\n<p>In pseudocode I imagine something like this:</p>\n\n<pre><code># input\norders = CSV.foreach(input_file).map do |row|\n  # get important stuff out of the row\n  Order.new(x, y, z)\nend\n\n# processing\nredemptions = orders.map { |order| order.get_redemption }\n\n# output\nCSV.open(output_file, \"wb\") do |csv|\n  redemptions.each do |redemption|\n    # convert redemption to an array of strings\n    csv &lt;&lt; redemption_ary\n  end\nend\n</code></pre>\n\n<p>If your rows are really simple, I would even consider just setting <code>headers:true</code> on the CSV so it returns <code>Hash</code> and leave orders as that.</p>\n\n<p>* Procs, lambdas, and top-level functions are objects too. But that's beside the point.</p>\n"}], "owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1529521318, "creation_date": 1529452716, "question_id": 50938417, "link": "https://stackoverflow.com/questions/50938417/naming-different-files-handler-io-stream-processor-controller", "title": "Naming different files. Handler? IO? Stream? Processor? Controller?", "body": "<p>I'm having some trouble naming some files that I wrote. I don't really know the different between a stream, I/O, a handler, a processor (Is this a real concept?), and a controller. These are what my files look like in Ruby:</p>\n\n<p>Starting from the rakefile:</p>\n\n<pre><code>desc \"Calculate chocolate totals from a CSV of orders\"\ntask :redeem_orders, [:orders_csv_path, :redemptions_csv_path] do |t, args|\n  args.with_defaults(:orders_csv_path =&gt; \"./public/input/orders.csv\", :redemptions_csv_path =&gt; \"./public/output/redemptions.csv\")\n\n  DataController.transfer(\n    input_path: args[:orders_csv_path],\n    output_path: args[:redemptions_csv_path],\n    formatter: ChocolateTotalsFormatter,\n    converter: ChocolateTotalsConverter\n  )\nend\n</code></pre>\n\n<p>Then the controller (which in my mind delegates between different classes with the data obtained from the <code>rakefile</code>):</p>\n\n<pre><code>class DataController\n  def self.transfer(input_path:, output_path:, formatter:, converter:)\n    data_processor = DataProcessor.new(\n      input_path: input_path,\n      output_path: output_path,\n      formatter: formatter\n    )\n    export_data = converter.convert(data_processor.import)\n    data_processor.export(export_data)\n  end\nend\n</code></pre>\n\n<p>The processor (which performs imports and exports according to the various files that were passed into this file):</p>\n\n<pre><code>class DataProcessor\n  attr_reader :input_path,\n    :output_path,\n    :formatter,\n    :input_file_processor,\n    :output_file_processor\n\n  def initialize(input_path:, output_path:, formatter:)\n    @input_path = input_path\n    @output_path = output_path\n    @formatter = formatter\n    @input_file_processor = FileProcessorFactory.create(File.extname(input_path))\n    @output_file_processor = FileProcessorFactory.create(File.extname(output_path))\n  end\n\n  def import\n    formatter.format_input(input_file_processor.read(input_path: input_path))\n  end\n\n  def export(export_data)\n    output_file_processor.write(\n      output_path: output_path,\n      data: formatter.format_output(export_data)\n    )\n  end\nend\n</code></pre>\n\n<p>the <code>converter</code> referenced in the controller looks like this (it converts data that was passed in to a different format... I'm more confident about this naming):</p>\n\n<pre><code>class ChocolateTotalsConverter\n  def self.convert(data)\n    data.map do |row|\n      ChocolateTotalsCalculator.new(row).calculate\n    end\n  end\nend\n</code></pre>\n\n<p>And the <code>FileProcessorFactory</code> in the above code snippet creates a file like this one that actually does the reading and the writing to CSV:</p>\n\n<p>require 'csv'</p>\n\n<pre><code>class CSVProcessor\n  include FileTypeProcessor\n\n  def self.read(input_path:, with_headers: true, return_headers: false)\n    CSV.read(input_path, headers: with_headers, return_headers: return_headers, converters: :numeric)\n  end\n\n  def self.write(output_path:, data:, write_headers: false)\n    CSV.open(output_path, \"w\", write_headers: write_headers) do |csv|\n      data.each do |row|\n        csv &lt;&lt; row\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>I'm having trouble with naming. Does it looks like I named things correctly? What should be named something like <code>DataIO</code> vs <code>DataProcessor</code>? What should a file named <code>DataStream</code> be doing? What about something that's a <code>converter</code>?</p>\n"}, {"tags": ["ruby", "csv"], "comments": [{"owner": {"reputation": 680, "user_id": 4573574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e884033aa0468fd3ef37c8efc618e12?s=128&d=identicon&r=PG&f=1", "display_name": "Shiyason", "link": "https://stackoverflow.com/users/4573574/shiyason"}, "edited": false, "score": 0, "creation_date": 1529452378, "post_id": 50938324, "comment_id": 88874984, "body": "In your <code>Numbers</code> program, there should be an option like <code>No Headers</code>, I don&#39;t think it&#39;s necessary to add blank values to the first row just to imitate a header row. But the cell value format seems wrong.. if <code>milk</code>, <code>dark</code>, <code>white</code>, and <code>sugar free</code> are supposed to be headers, they shouldn&#39;t be in each cell.. if they are correct cell values, then the <code>Numbers</code> program is wrongly using the blank space as delimiter rather than the comma. You can change that inside <code>Numbers</code> itself"}, {"owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "reply_to_user": {"reputation": 680, "user_id": 4573574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e884033aa0468fd3ef37c8efc618e12?s=128&d=identicon&r=PG&f=1", "display_name": "Shiyason", "link": "https://stackoverflow.com/users/4573574/shiyason"}, "edited": false, "score": 0, "creation_date": 1529452750, "post_id": 50938324, "comment_id": 88875067, "body": "They are supposed to be in the cell actually. I know it&#39;s strange but that&#39;s what the requirement asked for."}, {"owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "reply_to_user": {"reputation": 680, "user_id": 4573574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e884033aa0468fd3ef37c8efc618e12?s=128&d=identicon&r=PG&f=1", "display_name": "Shiyason", "link": "https://stackoverflow.com/users/4573574/shiyason"}, "edited": false, "score": 0, "creation_date": 1529453420, "post_id": 50938324, "comment_id": 88875192, "body": "What is write_headers supposed to be doing in <code>CSV.open</code>?"}, {"owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 0, "creation_date": 1529453929, "post_id": 50938324, "comment_id": 88875284, "body": "what if you get rid of the <code>write_headers: write_headers</code> in <code>CSV.open</code> ?"}, {"owner": {"reputation": 680, "user_id": 4573574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e884033aa0468fd3ef37c8efc618e12?s=128&d=identicon&r=PG&f=1", "display_name": "Shiyason", "link": "https://stackoverflow.com/users/4573574/shiyason"}, "edited": false, "score": 0, "creation_date": 1529455246, "post_id": 50938324, "comment_id": 88875546, "body": "You can see the explanation on <a href=\"http://ruby-doc.org/stdlib-2.0.0/libdoc/csv/rdoc/CSV.html#method-i-write_headers-3F\" rel=\"nofollow noreferrer\">this page</a>"}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1529480217, "post_id": 50938324, "comment_id": 88882901, "body": "@Jwan622 : Looking at the raw CSV file which you posted, it is perfectly fine. If you would create it manually, you would write it exactly the same, wouldn&#39;t you? Hence, the question has nothing to do with Ruby, and I suggest to remove the <i>ruby</i> tag."}], "answers": [{"comments": [{"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1529479950, "post_id": 50939924, "comment_id": 88882758, "body": "Does it make any difference? Being a <i>header</i> is a logical concept, i.e. the way we interpret the first row. Imagine a CSV file where each field in each row contains a different English word. By just looking at it, there is no way  to tell, whether the first line is meant to be a header or raw data. Look at the raw CSV file presented by the OP: It looks perfectly fine. There is nothing in it which would suggest that the first line should be considered as a header."}], "tags": [], "owner": {"reputation": 340, "user_id": 6855759, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3UfK3V6lnPY/AAAAAAAAAAI/AAAAAAAAAlU/CG1lontACf0/photo.jpg?sz=128", "display_name": "Caleb Keene", "link": "https://stackoverflow.com/users/6855759/caleb-keene"}, "is_accepted": false, "score": 0, "last_activity_date": 1529466605, "creation_date": 1529466605, "answer_id": 50939924, "question_id": 50938324, "link": "https://stackoverflow.com/questions/50938324/how-to-write-a-csv-without-headers/50939924#50939924", "title": "How to write a CSV without headers", "body": "<p><code>write_headers</code> will add a header row to the output when it's set true. I think setting <code>headers: false</code> in your options hash will fix your issue (when it's set true, it treats the first line of the CSV as headers)</p>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 1, "last_activity_date": 1529501928, "creation_date": 1529501928, "answer_id": 50949634, "question_id": 50938324, "link": "https://stackoverflow.com/questions/50938324/how-to-write-a-csv-without-headers/50949634#50949634", "title": "How to write a CSV without headers", "body": "<blockquote>\n  <p>Is this a problem with how I wrote data to the CSV or a problem with the CSV program... it probably is because the choice of delimiter is wrong.</p>\n</blockquote>\n\n<p>Your CSV data is perfectly fine. CSV is only loosely standardized and there's no concept of marking a header row as such within the file. It cannot be distinguished from any other row, syntax-wise.</p>\n\n<blockquote>\n  <p>What does the <code>write_headers</code> part even do?</p>\n</blockquote>\n\n<p>It's used together with <code>headers</code>. From the docs for <a href=\"http://ruby-doc.org/stdlib-2.5.1/libdoc/csv/rdoc/CSV.html#method-c-new\" rel=\"nofollow noreferrer\"><code>CSV.new</code></a>:</p>\n\n<blockquote>\n  <p><strong><code>:write_headers</code></strong><br>\n  When <code>true</code> and <code>:headers</code> is set, a header row will be added to the output.</p>\n</blockquote>\n\n<p>Example:</p>\n\n<pre><code>require 'csv'\n\nCSV.generate(headers: %w[a b c], write_headers: true) do |csv|\n  csv &lt;&lt; [1, 2, 3]\n  csv &lt;&lt; [4, 5, 6]\nend\n#=&gt; \"a,b,c\\n1,2,3\\n4,5,6\\n\"\n</code></pre>\n\n<p>as opposed to:</p>\n\n<pre><code>CSV.generate(headers: %w[a b c], write_headers: false) do |csv|\n  csv &lt;&lt; [1, 2, 3]\n  csv &lt;&lt; [4, 5, 6]\nend\n#=&gt; \"1,2,3\\n4,5,6\\n\"\n</code></pre>\n"}], "owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 517, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1529501928, "creation_date": 1529451846, "question_id": 50938324, "link": "https://stackoverflow.com/questions/50938324/how-to-write-a-csv-without-headers", "title": "How to write a CSV without headers", "body": "<p>I have a file that looks like this:</p>\n\n<pre><code>milk 7,dark 0,white 0,sugar free 1\nmilk 0,dark 3,white 0,sugar free 0\nmilk 0,dark 3,white 0,sugar free 5\nmilk 0,dark 1,white 5,sugar free 3\n</code></pre>\n\n<p>There are no headers in that CSV. However, every time I open this file in a program like <code>Numbers</code>, it looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/GMQBF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GMQBF.png\" alt=\"enter image description here\"></a></p>\n\n<p>Is this a problem with how I wrote data to the CSV or a problem with the CSV program... it probably is because the choice of delimiter is wrong.</p>\n\n<p>My code when writing looks like this:</p>\n\n<pre><code>def self.write(output_path:, data:, write_headers: false)\n    CSV.open(output_path, \"w\", write_headers: write_headers) do |csv|\n      data.each do |row|\n        csv &lt;&lt; row\n      end\n    end\n  end\n</code></pre>\n\n<p>What does the <code>write_headers</code> part even do?</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 0, "last_activity_date": 1529464990, "creation_date": 1529464990, "answer_id": 50939717, "question_id": 50937456, "link": "https://stackoverflow.com/questions/50937456/necessary-to-use-dir-pwd-inside-dir-when-globing-several-directories/50939717#50939717", "title": "Necessary to use Dir.pwd inside Dir[] when globing several directories?", "body": "<p>If the dependency is only as such: file A needs file B, and file B needs file C, then file A should not take care of file C. The requirement for file C should be written on file B, not file A.</p>\n\n<p>In your case, requiring the <code>*.rb</code> files in subdirectories should be written in <code>practice.rb</code>, not in <code>lib/my_gem.rb</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1529525660, "post_id": 50940215, "comment_id": 88910135, "body": "No, your first option does not work. It gives me error &quot;cannot load such file -- lib/my_gem/practices/texas/medical_practice.rb&quot;"}, {"owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1529525748, "post_id": 50940215, "comment_id": 88910170, "body": "But when I add #{Dir.pwd}/ it works, as I mentioned in question."}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "reply_to_user": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1529533946, "post_id": 50940215, "comment_id": 88913284, "body": "Sorry. I&#39;ve drastically modified my answer. Please take a look and see if that makes sense to you."}], "tags": [], "owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "is_accepted": true, "score": 0, "last_activity_date": 1529533906, "last_edit_date": 1529533906, "creation_date": 1529468870, "answer_id": 50940215, "question_id": 50937456, "link": "https://stackoverflow.com/questions/50937456/necessary-to-use-dir-pwd-inside-dir-when-globing-several-directories/50940215#50940215", "title": "Necessary to use Dir.pwd inside Dir[] when globing several directories?", "body": "<p><code>require</code> tries to load relative filespecs in the context of each directory in the <code>$LOAD_PATH</code>. When a gem is <code>require</code>'d, its lib directory is added to this load path. This enables the use of <code>require</code> instead of <code>require_relative</code>. For example, in my rails console, I see this output included in the output of <code>puts $LOAD_PATH</code>:</p>\n\n<pre><code>/Users/kbennett/.rvm/gems/ruby-2.5.1/gems/rack-2.0.5/lib\n/Users/kbennett/.rvm/gems/ruby-2.5.1/gems/rails-html-sanitizer-1.0.4/lib\n/Users/kbennett/.rvm/gems/ruby-2.5.1/gems/loofah-2.2.2/lib\n</code></pre>\n\n<p>In your case, you're not requiring the gem when you run the code. So you need to either use <code>require_relative</code> or add your lib directory to the load path explicitly. I prefer the former approach; it feels cleaner to me.</p>\n\n<p>Using <code>File.dirname</code>, <code>File.join</code>, and <code>__FILE__</code>, you can compute the directory from which to build your filespec to pass to <code>require</code>. You can also use <code>Dir.pwd</code>, but that will break if you run your code from a different directory.</p>\n\n<p>So in your my_gem.rb you can have something like the code below (normally I would not use so many intermediate variables but they're useful here for illustrative purposes):</p>\n\n<pre><code>this_dir = File.dirname(__FILE__)\nrb_filemask = File.join(this_dir, 'practices/**/*.rb')\nrb_files = Dir[rb_filemask]\nrb_files.each { |filespec| require filespec }\n</code></pre>\n"}], "owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 50940215, "answer_count": 2, "score": 0, "last_activity_date": 1529533906, "creation_date": 1529445309, "question_id": 50937456, "link": "https://stackoverflow.com/questions/50937456/necessary-to-use-dir-pwd-inside-dir-when-globing-several-directories", "title": "Necessary to use Dir.pwd inside Dir[] when globing several directories?", "body": "<p>I am writing a Ruby gem. In the lib/my_gem.rb root file, I have this:</p>\n\n<pre><code>require_relative \"my_gem/practices/practice\"\n</code></pre>\n\n<p>But that file practice.rb requires several *.rb files in a number of subdirectories in the practices/ directory. So at the bottom of the file, I do this:</p>\n\n<pre><code>Dir[\"#{Dir.pwd}/lib/my_gem/practices/**/*.rb\"].each do |file|\n  require file\nend\n</code></pre>\n\n<p>It works, but when I look at other gems like Rails, I notice they never use <code>Dir.pwd</code>. Is there another way to achieve this? </p>\n"}, {"tags": ["ruby", "mergesort", "nomethoderror"], "comments": [{"owner": {"reputation": 9, "user_id": 6703561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6203809a930252da55dbdb889973e495?s=128&d=identicon&r=PG", "display_name": "Anana", "link": "https://stackoverflow.com/users/6703561/anana"}, "edited": false, "score": 0, "creation_date": 1529445301, "post_id": 50937265, "comment_id": 88873345, "body": "This won&#39;t answer your problem but you can try to see <a href=\"https://stackoverflow.com/questions/21121075/how-do-i-write-a-merge-sort#21121122\">here</a>"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1529465135, "post_id": 50937265, "comment_id": 88877523, "body": "You don&#39;t have an <code>unless</code> block."}], "answers": [{"comments": [{"owner": {"reputation": 431, "user_id": 2476452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xkvMH.jpg?s=128&g=1", "display_name": "Mike K", "link": "https://stackoverflow.com/users/2476452/mike-k"}, "edited": false, "score": 0, "creation_date": 1529449127, "post_id": 50937487, "comment_id": 88874317, "body": "I think your answer solves the question originally asked.  There is another unrelated bug in the original code that remains.  Once <code>first</code> is empty or <code>second</code> is empty, the <code>until</code> loop ends, and the remaining elements in the one that isn&#39;t &quot;empty&quot; never get added.  So to fix the bug that wasn&#39;t asked about, we need to add the remaining elements of first and second to the <code>sorted_array</code> before returning it."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 431, "user_id": 2476452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xkvMH.jpg?s=128&g=1", "display_name": "Mike K", "link": "https://stackoverflow.com/users/2476452/mike-k"}, "edited": false, "score": 0, "creation_date": 1529450146, "post_id": 50937487, "comment_id": 88874539, "body": "@MikeK I don&#39;t want to write their code for them or take away valuable debugging experience. This looks like student work to me so I don&#39;t want to give away too much, they need to learn how to build a proper set of tests and how to debug things when tests fail. I could be wrong of course."}], "tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": false, "score": 1, "last_activity_date": 1529445471, "creation_date": 1529445471, "answer_id": 50937487, "question_id": 50937265, "link": "https://stackoverflow.com/questions/50937265/nomethoderror-undefined-method-empty-for-nilclass/50937487#50937487", "title": "NoMethodError undefined method empty? for NilClass", "body": "<p>If <code>array.length &lt; 2</code> then your <code>merge_sort</code> will return <code>array</code>. Otherwise, <code>merge_sort</code> will return whatever <code>until some_condition do ... end</code> evaluates to. It so happens that <code>until</code> evaluates to <code>nil</code> so your method behaves like this:</p>\n\n<pre><code>def merge_sort(array)\n  if array.length &lt; 2\n    return array\n  else\n    # Do a bunch of stuff...\n    return nil\n  end\nend\n</code></pre>\n\n<p>That means that <code>first</code> and <code>second</code> will be <code>nil</code> most of the time and there's your <code>NoMethodError</code>. Perhaps you want to return <code>sorted_array</code> after your <code>until</code>:</p>\n\n<pre><code>def merge_sort(array)\n  if array.length &lt; 2\n    array\n  else\n    #...\n    sorted_array = []\n    until first.empty? || second.empty? do\n      #...\n    end\n    sorted_array # &lt;------------------- sort of important\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7691832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eba0a028a291450f64b2cc06cdb431a6?s=128&d=identicon&r=PG&f=1", "display_name": "Fmak", "link": "https://stackoverflow.com/users/7691832/fmak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 615, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1529465085, "creation_date": 1529444136, "last_edit_date": 1529465085, "question_id": 50937265, "link": "https://stackoverflow.com/questions/50937265/nomethoderror-undefined-method-empty-for-nilclass", "title": "NoMethodError undefined method empty? for NilClass", "body": "<p>I am trying to implement a merge sort algorithm. I have the following code:</p>\n\n<pre><code>def merge_sort(array)\n  if array.length &lt; 2\n    return array\n  else\n    length = array.length\n    i = array[0..array.length/2-1]\n    j = array[array.length/2 .. -1]\n    first = merge_sort(i)\n    second = merge_sort(j)\n\n    sorted_array = []\n    until first.empty? || second.empty? do\n      if first[0] &gt;= second[0]\n        sorted_array &lt;&lt; second.shift\n      else\n        sorted_array &lt;&lt; first.shift\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>I get a <code>NoMethodError for NilClass</code> with it.\nFrom my understanding, the <code>unless</code> block should check for empty array, and stop execution before a <code>Nil</code> class ever occurs.</p>\n\n<p>Why do I get this error?</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 8958964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c7570e91f5f3227b0d4ae600d5eb7fa?s=128&d=identicon&r=PG&f=1", "display_name": "TylerP3358", "link": "https://stackoverflow.com/users/8958964/tylerp3358"}, "edited": false, "score": 0, "creation_date": 1529442177, "post_id": 50936896, "comment_id": 88872250, "body": "Thanks you Andrey.  Is it safe to say that, whatever the response, there isn&#39;t a way around writing out all the attributes of the model?  It seems like it&#39;s a must."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 65, "user_id": 8958964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c7570e91f5f3227b0d4ae600d5eb7fa?s=128&d=identicon&r=PG&f=1", "display_name": "TylerP3358", "link": "https://stackoverflow.com/users/8958964/tylerp3358"}, "edited": false, "score": 0, "creation_date": 1529442282, "post_id": 50936896, "comment_id": 88872289, "body": "@TylerP3358 check out edited answer, it&#39;s even shorted and very efficient - all processing in database"}, {"owner": {"reputation": 65, "user_id": 8958964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c7570e91f5f3227b0d4ae600d5eb7fa?s=128&d=identicon&r=PG&f=1", "display_name": "TylerP3358", "link": "https://stackoverflow.com/users/8958964/tylerp3358"}, "edited": false, "score": 0, "creation_date": 1529442683, "post_id": 50936896, "comment_id": 88872441, "body": "How interesting... it returned zero? :D  I actually tried something similar back when I first wrote this.  No idea why it returned zero.  Looks beautiful, and correct!"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 65, "user_id": 8958964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c7570e91f5f3227b0d4ae600d5eb7fa?s=128&d=identicon&r=PG&f=1", "display_name": "TylerP3358", "link": "https://stackoverflow.com/users/8958964/tylerp3358"}, "edited": false, "score": 0, "creation_date": 1529442756, "post_id": 50936896, "comment_id": 88872464, "body": "@TylerP3358 it should work because it <i>is correct</i> :) . Test it by trying adding one column at a time. The sum should be increasing."}, {"owner": {"reputation": 65, "user_id": 8958964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c7570e91f5f3227b0d4ae600d5eb7fa?s=128&d=identicon&r=PG&f=1", "display_name": "TylerP3358", "link": "https://stackoverflow.com/users/8958964/tylerp3358"}, "edited": false, "score": 0, "creation_date": 1529443120, "post_id": 50936896, "comment_id": 88872596, "body": "Hm, how interesting.  Tried going one at a time and the first one worked (toilet_paper), but adding the next column did not.  I&#39;ll mess around with it!"}, {"owner": {"reputation": 667, "user_id": 6141597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d52107448cce3dc1010f66ceb534270?s=128&d=identicon&r=PG&f=1", "display_name": "abax", "link": "https://stackoverflow.com/users/6141597/abax"}, "edited": false, "score": 1, "creation_date": 1529443140, "post_id": 50936896, "comment_id": 88872600, "body": "Just for fun I&#39;ll add that you could build the string dynamically and pass it into the summing method: <code>Category.columns.map(&amp;:name).reject{ |attr|  %w(created_at updated_at).include?(attr)}.join(&#39; + &#39;)</code>"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 65, "user_id": 8958964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c7570e91f5f3227b0d4ae600d5eb7fa?s=128&d=identicon&r=PG&f=1", "display_name": "TylerP3358", "link": "https://stackoverflow.com/users/8958964/tylerp3358"}, "edited": false, "score": 0, "creation_date": 1529443227, "post_id": 50936896, "comment_id": 88872639, "body": "@TylerP3358 that&#39;s strange. What db and rails you use? with versions"}, {"owner": {"reputation": 65, "user_id": 8958964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c7570e91f5f3227b0d4ae600d5eb7fa?s=128&d=identicon&r=PG&f=1", "display_name": "TylerP3358", "link": "https://stackoverflow.com/users/8958964/tylerp3358"}, "edited": false, "score": 0, "creation_date": 1529443412, "post_id": 50936896, "comment_id": 88872700, "body": "@AndreyDeineko sqlite3 (this was for a project).  Rails 5.2"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 65, "user_id": 8958964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c7570e91f5f3227b0d4ae600d5eb7fa?s=128&d=identicon&r=PG&f=1", "display_name": "TylerP3358", "link": "https://stackoverflow.com/users/8958964/tylerp3358"}, "edited": false, "score": 0, "creation_date": 1529443481, "post_id": 50936896, "comment_id": 88872724, "body": "@TylerP3358 Okaay, supposed so. sqlite <i>might not</i> support this sum stuff. Sqlite is no fun. Check out their docs on something like this, sorry, never used it"}, {"owner": {"reputation": 65, "user_id": 8958964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c7570e91f5f3227b0d4ae600d5eb7fa?s=128&d=identicon&r=PG&f=1", "display_name": "TylerP3358", "link": "https://stackoverflow.com/users/8958964/tylerp3358"}, "edited": false, "score": 0, "creation_date": 1529443617, "post_id": 50936896, "comment_id": 88872779, "body": "@AndreyDeineko yeah, I am thinking it was Sqlite3.. it&#39;s a little goofy!  Thanks for the help though brother, the answer above still works fine.  Just not pretty :D"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 1, "last_activity_date": 1529442651, "last_edit_date": 1529442651, "creation_date": 1529442076, "answer_id": 50936896, "question_id": 50936732, "link": "https://stackoverflow.com/questions/50936732/sum-all-attributes-in-a-model/50936896#50936896", "title": "Sum all attributes in a model?", "body": "<p>Check out this one:</p>\n\n<pre><code>def self.total_donations\n  sum(\"toilet_paper + dental_hygiene + first_aid + general_hygiene + underwear_socks + blankets + school_supplies + diapers\")\nend\n</code></pre>\n\n<p>The generated SQL:</p>\n\n<pre><code>SELECT SUM(toilet_paper + dental_hygiene + first_aid + general_hygiene + underwear_socks + blankets + school_supplies + diapers)\nFROM \"categories\"\n</code></pre>\n\n<ul>\n<li>short (no shorter possible)</li>\n<li>efficient (all the processing is done on the database layer)</li>\n</ul>\n\n<p>Note, that in the class instance methods you don't have to use <code>Category</code>, because it is <code>self</code> (assuming, the method is in the <code>Category</code> model).</p>\n"}], "owner": {"reputation": 65, "user_id": 8958964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c7570e91f5f3227b0d4ae600d5eb7fa?s=128&d=identicon&r=PG&f=1", "display_name": "TylerP3358", "link": "https://stackoverflow.com/users/8958964/tylerp3358"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 50936896, "answer_count": 1, "score": 1, "last_activity_date": 1529442651, "creation_date": 1529441329, "last_edit_date": 1529442500, "question_id": 50936732, "link": "https://stackoverflow.com/questions/50936732/sum-all-attributes-in-a-model", "title": "Sum all attributes in a model?", "body": "<p>I was curious if there is an easy way to sum all attributes in a model without it looking repetitive, and not DRY.</p>\n\n<p>I have a donation app, and this is how I summed everything:</p>\n\n<pre><code>def self.total_donations\n    array = Category.pluck(\n    'SUM(toilet_paper)',\n    'SUM(dental_hygiene)',\n    'SUM(first_aid)',\n    'SUM(general_hygiene)',\n    'SUM(underwear_socks)',\n    'SUM(blankets)',\n    'SUM(school_supplies)',\n    'SUM(diapers)').flatten.compact\n    array.inject(0){|sum, x| sum + x}\nend \n</code></pre>\n\n<p>It's just ugly, but I don't know how to get around adding all of them up without doing something like this.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1529440537, "post_id": 50936299, "comment_id": 88871657, "body": "I have no idea how this is working at all given <code>PaymentMethod.update</code> would update &quot;all&quot; the payment methods"}, {"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1529467202, "post_id": 50936299, "comment_id": 88877900, "body": "do these objects not already have a PaymentMethod associated with them? <code>ActiveRecord::Base.update</code> is rarely used. It&#39;s hard to tell what you&#39;re trying to do without more context."}, {"owner": {"reputation": 108, "user_id": 5235107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/506d9664c573c641b685493eb20b9b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Swapnil", "link": "https://stackoverflow.com/users/5235107/swapnil"}, "edited": false, "score": 1, "creation_date": 1529478247, "post_id": 50936299, "comment_id": 88881814, "body": "Have no idea how <code>PaymentMethod.update</code> is working. Try adding medic_id to  update hash. But the sure way to get it done would be to call update on each payment_method object."}], "answers": [{"tags": [], "owner": {"reputation": 196, "user_id": 5204300, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh4.googleusercontent.com/-6SGS9rCE-sw/AAAAAAAAAAI/AAAAAAAAABE/LsnpNPIvZO0/photo.jpg?sz=128", "display_name": "Carlos G&#243;mez", "link": "https://stackoverflow.com/users/5204300/carlos-g%c3%b3mez"}, "is_accepted": false, "score": 0, "last_activity_date": 1529517438, "creation_date": 1529517438, "answer_id": 50954399, "question_id": 50936299, "link": "https://stackoverflow.com/questions/50936299/update-multiple-records-in-the-db-one-time-per-record-in-rails/50954399#50954399", "title": "Update multiple records in the DB, one time per record in Rails", "body": "<p>Thanks for your answers, they finally helped me to realize that I have to update each object, so I did it by going through <code>PaymentMethod.where(id: @subscription_id, medic_id: @medic_id).update()</code></p>\n\n<pre><code>namespace :premium_users do\n  desc 'Get the user id &amp; data in a hash'\n  task get_users: :environment do \n    # Get the user and association payment_method where period_end_date not nil, means that this user has a payment_method\n    users = Medic.includes(:payment_methods).where.not payment_methods: { period_end_date: nil }\n    request_hash = {}\n\n    users.each do |user|\n      # Set to compare period end date with date today \n      period_end_date = user.payment_methods.last.period_end_date\n\n      # Create a user hash if period_end_date is 2 days from date today\n      if Date.today - period_end_date &lt;= 172_800\n        medic_id, subscription_id, openpay_customer_id, openpay_subscription_id = user.payment_methods.last.medic_id, user.payment_methods.last.id, user.payment_methods.last.openpay_customer_id, user.payment_methods.last.openpay_subscription_id\n        user_hash = {}\n        user_hash[medic_id] = [subscription_id, openpay_customer_id, openpay_subscription_id]\n      else\n        user_hash = {} \n      end\n\n      request_hash.merge!(user_hash) # If no users is empty =&gt; {}\n\n      if request_hash.empty?\n        puts 'No User to check!'\n      else\n        request_hash.each do |key, value|\n          @medic_id, @subscription_id, openpay_customer_id, openpay_subscription_id = key, value[0], value[1], value[2]\n\n          # Openpay API connection and request\n          @openpay = OpenpayApi.new(ENV['MERCHANT_ID_OPENPAY'], ENV['SECRET_KEY_OPENPAY'])\n          @subscriptions = @openpay.create(:subscriptions)\n          # @subscriptions.get(subscription_id,customer_id)\n          response_hash = @subscriptions.get(openpay_subscription_id, openpay_customer_id)\n\n          # Split values\n          @charge_date, @creation_date, @current_period_number, @period_end_date, @status, @trial_end_date = response_hash.values_at('charge_date', 'creation_date', 'current_period_number', 'period_end_date', 'status', 'trial_end_date')\n\n          # Status conditions\n          case @status\n          when 'past_due'\n            @premium = false\n            @cancelled = Time.now\n          when 'unpaid'\n            @premium = false\n            @cancelled = Time.now\n          when 'cancelled'\n            @premium = false\n            @cancelled = Time.now\n          else\n            @premium = true\n            @cancelled = nil\n          end\n        end\n\n        # Update each subscription with data from API response\n        @payment_method = PaymentMethod.where(id: @subscription_id, medic_id: @medic_id).update(\n          premium: @premium,\n          charge_date: @charge_date,\n          creation_date: @creation_date,\n          current_period_number: @current_period_number,\n          period_end_date: @period_end_date,\n          status: @status,\n          trial_end_date: @trial_end_date,\n          cancelled_on: @cancelled\n        )\n\n        puts \"User #{@medic_id} update, Complete!\"\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>PaymentMethod Load (0.5ms)  SELECT `payment_methods`.* FROM `payment_methods` WHERE `payment_methods`.`id` = 1 AND `payment_methods`.`medic_id` = 1\n   (0.2ms)  BEGIN\n  SQL (0.4ms)  UPDATE `payment_methods` SET `premium` = 1, `current_period_number` = 0, `status` = 'trial', `updated_at` = '2018-06-20 17:40:20' WHERE `payment_methods`.`id` = 1\n   (12.1ms)  COMMIT\nUser 1 update, Complete!\n  PaymentMethod Load (0.5ms)  SELECT `payment_methods`.* FROM `payment_methods` WHERE `payment_methods`.`id` = 2 AND `payment_methods`.`medic_id` = 3\n   (0.2ms)  BEGIN\n  SQL (0.4ms)  UPDATE `payment_methods` SET `premium` = 1, `status` = 'trial', `cancelled_on` = NULL, `updated_at` = '2018-06-20 17:40:22' WHERE `payment_methods`.`id` = 2\n   (11.8ms)  COMMIT\nUser 3 update, Complete!\n  0.040000   0.010000   0.050000 (  1.741126)\n</code></pre>\n"}], "owner": {"reputation": 196, "user_id": 5204300, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh4.googleusercontent.com/-6SGS9rCE-sw/AAAAAAAAAAI/AAAAAAAAABE/LsnpNPIvZO0/photo.jpg?sz=128", "display_name": "Carlos G&#243;mez", "link": "https://stackoverflow.com/users/5204300/carlos-g%c3%b3mez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 215, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529517438, "creation_date": 1529439406, "question_id": 50936299, "link": "https://stackoverflow.com/questions/50936299/update-multiple-records-in-the-db-one-time-per-record-in-rails", "title": "Update multiple records in the DB, one time per record in Rails", "body": "<p>I have a code that is updating user records in a DB, but is updating the record of each user, the number of times there are users in the database, example, I have 3 users => medic1, medic2, medic4 in the SQL you can see that it is updating them 3 times when it should be 1 time per user.</p>\n\n<p>What my code should do is extract the users with the nested attribute period_end_date from the DB and save them in a hash, which will query the Openpay API about the status of the subscription; in the response hash I receive the data of each user and depending on the 'status' I update the values in the database with the results of the response_hash, this should be per user. I can not see what I'm doing wrong, can you help me achieve it?</p>\n\n<p>Here is the code, rake premium_users:get_users (lib/tasks/premium_users.rake): </p>\n\n<pre><code>namespace :premium_users do\n  desc 'Get the user id &amp; data in a hash'\n  task get_users: :environment do \n    users = Medic.includes(:payment_methods).where.not payment_methods: { period_end_date: nil }\n    request_hash = {}\n\n    # Get users in a hash \n    users.each do |user|\n      period_end_date = user.payment_methods.last.period_end_date\n\n      if Date.today - period_end_date &lt;= 172_800\n        openpay_customer_id = user.payment_methods.last.openpay_customer_id\n        openpay_subscription_id = user.payment_methods.last.openpay_subscription_id\n        medic_id = user.payment_methods.last.medic_id\n        user_hash = {}\n        user_hash[medic_id] = [openpay_customer_id, openpay_subscription_id]\n      else\n        user_hash = {}\n      end\n\n      request_hash.merge!(user_hash) # If no users is empty =&gt; {}\n\n      if request_hash.empty?\n        puts 'No User to check!'\n      else\n        # Request for subscription status to Openpay\n        request_hash.each_value do |value|\n          openpay_customer_id = value[0]\n          openpay_subscription_id = value[1]\n\n          # Openpay API connection\n          @openpay = OpenpayApi.new(ENV['MERCHANT_ID_OPENPAY'], ENV['SECRET_KEY_OPENPAY'])\n          @subscriptions = @openpay.create(:subscriptions)\n          response_hash = @subscriptions.get(openpay_subscription_id, openpay_customer_id)\n\n          # Extract values from response\n          @charge_date, @creation_date, @current_period_number, @period_end_date, @status, @trial_end_date = response_hash.values_at('charge_date', 'creation_date', 'current_period_number', 'period_end_date', 'status', 'trial_end_date')\n\n          case @status\n          when 'past_due'\n            @premium = false\n            @cancelled = Time.now\n          when 'unpaid'\n            @premium = false\n            @cancelled = Time.now\n          when 'cancelled'\n            @premium = false\n            @cancelled = Time.now\n          else\n            @premium = true\n            @cancelled = nil\n          end\n\n        end\n\n        # Update user payment record with response from Openpay\n        @payment_method = PaymentMethod.update(\n          premium: @premium,\n          charge_date: @charge_date,\n          creation_date: @creation_date,\n          current_period_number: @current_period_number,\n          period_end_date: @period_end_date,\n          status: @status,\n          trial_end_date: @trial_end_date,\n          cancelled_on: @cancelled\n        )\n\n        puts \"User #{user.email} update, Complete!\"\n\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>The SQL:</p>\n\n<pre><code>PaymentMethod Load (0.4ms)  SELECT `payment_methods`.* FROM `payment_methods`\n   (0.1ms)  BEGIN\n   SQL (0.3ms)  UPDATE `payment_methods` SET `creation_date` = '2018-06-15 19:15:13', `updated_at` = '2018-06-15 21:01:19' WHERE `payment_methods`.`id` = 1\n   (11.9ms)  COMMIT\n   (0.1ms)  BEGIN\n  SQL (0.3ms)  UPDATE `payment_methods` SET `creation_date` = '2018-06-15 19:15:13', `updated_at` = '2018-06-15 21:01:19' WHERE `payment_methods`.`id` = 2\n   (2.7ms)  COMMIT\n   (0.1ms)  BEGIN\n  SQL (0.2ms)  UPDATE `payment_methods` SET `creation_date` = '2018-06-15 19:15:13', `updated_at` = '2018-06-15 21:01:19' WHERE `payment_methods`.`id` = 3\n   (2.6ms)  COMMIT\nUser medic1@mail.com update, Complete!\n\n  PaymentMethod Load (0.3ms)  SELECT `payment_methods`.* FROM `payment_methods`\n   (0.1ms)  BEGIN\n   SQL (0.3ms)  UPDATE `payment_methods` SET `creation_date` = '2018-06-15 19:16:24', `updated_at` = '2018-06-15 21:01:20' WHERE `payment_methods`.`id` = 1\n   (11.9ms)  COMMIT\n   (0.1ms)  BEGIN\n  SQL (0.3ms)  UPDATE `payment_methods` SET `creation_date` = '2018-06-15 19:16:24', `updated_at` = '2018-06-15 21:01:20' WHERE `payment_methods`.`id` = 2\n   (2.7ms)  COMMIT\n   (0.1ms)  BEGIN\n  SQL (0.3ms)  UPDATE `payment_methods` SET `creation_date` = '2018-06-15 19:16:24', `updated_at` = '2018-06-15 21:01:20' WHERE `payment_methods`.`id` = 3\n   (2.5ms)  COMMIT\nUser medic2@mail.com update, Complete!\n\n  PaymentMethod Load (0.3ms)  SELECT `payment_methods`.* FROM `payment_methods`\n   (0.1ms)  BEGIN\n  SQL (0.2ms)  UPDATE `payment_methods` SET `creation_date` = '2018-06-15 19:18:30', `updated_at` = '2018-06-15 21:01:22' WHERE `payment_methods`.`id` = 1\n   (2.6ms)  COMMIT\n   (0.1ms)  BEGIN\n  SQL (0.2ms)  UPDATE `payment_methods` SET `creation_date` = '2018-06-15 19:18:30', `updated_at` = '2018-06-15 21:01:22' WHERE `payment_methods`.`id` = 2\n   (2.6ms)  COMMIT\n   (0.1ms)  BEGIN\n  SQL (0.3ms)  UPDATE `payment_methods` SET `creation_date` = '2018-06-15 19:18:30', `updated_at` = '2018-06-15 21:01:22' WHERE `payment_methods`.`id` = 3\n   (2.6ms)  COMMIT\nUser medic4@mail.com update, Complete!\n</code></pre>\n\n<p>Models:</p>\n\n<pre><code>class Medic &lt; ApplicationRecord\n  has_many :payment_methods, dependent: :destroy\nend\n\nclass PaymentMethod &lt; ApplicationRecord\n  belongs_to :medic, optional: true \nend\n</code></pre>\n"}, {"tags": ["ruby", "selenium-webdriver", "capybara"], "answers": [{"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 1, "last_activity_date": 1529439667, "creation_date": 1529439667, "answer_id": 50936342, "question_id": 50935989, "link": "https://stackoverflow.com/questions/50935989/configure-the-spec-helper-file-to-have-the-default-driver-open-an-incognito-wind/50936342#50936342", "title": "Configure the spec_helper file to have the default driver open an incognito window in Chrome", "body": "<p>You need to register your own driver which configures Chrome the way you want</p>\n\n<pre><code>Capybara.register_driver :incognito_chrome do |app|\n  browser_options = ::Selenium::WebDriver::Chrome::Options.new\n  browser_options.args &lt;&lt; '--incognito'\n  Capybara::Selenium::Driver.new(app, browser: :chrome, options: browser_options)\nend\n</code></pre>\n\n<p>and then set that as your default driver</p>\n\n<pre><code>Capybara.default_driver = :incognito_chrome\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 9598367, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "throwthedays", "link": "https://stackoverflow.com/users/9598367/throwthedays"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 50936342, "answer_count": 1, "score": 0, "last_activity_date": 1529447134, "creation_date": 1529438050, "last_edit_date": 1529447134, "question_id": 50935989, "link": "https://stackoverflow.com/questions/50935989/configure-the-spec-helper-file-to-have-the-default-driver-open-an-incognito-wind", "title": "Configure the spec_helper file to have the default driver open an incognito window in Chrome", "body": "<p>I am stuck trying to figure out how to get my default driver to open Chrome with an incognito window. </p>\n\n<p><code>Capybara.default_driver = :selenium_chrome</code> is what I currently have for my default driver.</p>\n\n<p>How can I add the option that tells the driver to always open an incognito window?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2267, "user_id": 8242447, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M6884.gif?s=128&g=1", "display_name": "\u1e42\u0173\u1efb\u1ecbg\u01fb\u0148\u1ea1c\u1ec3\u01a1\u1eed\u1e69", "link": "https://stackoverflow.com/users/8242447/%e1%b9%82%c5%b3%e1%bb%bb%e1%bb%8bg%c7%bb%c5%88%e1%ba%a1c%e1%bb%83%c6%a1%e1%bb%ad%e1%b9%a9"}, "edited": false, "score": 1, "creation_date": 1529437331, "post_id": 50935802, "comment_id": 88870244, "body": "Posting an image of your table is not recommended. Can you please copy the text and paste it as code?"}, {"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1529437512, "post_id": 50935802, "comment_id": 88870333, "body": "can you do <code>@product.valid? ? @product.save! : Rails.logger.warn @producer.errors.inspect</code> and give us the log output?"}, {"owner": {"reputation": 177, "user_id": 6776511, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4567d009cb633351538c947fbe71a6d9?s=128&d=identicon&r=PG&f=1", "display_name": "&#201;owyn", "link": "https://stackoverflow.com/users/6776511/%c3%89owyn"}, "edited": false, "score": 0, "creation_date": 1529438393, "post_id": 50935802, "comment_id": 88870709, "body": "Sorry, I edited the question"}, {"owner": {"reputation": 9737, "user_id": 2422778, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aUihh.jpg?s=128&g=1", "display_name": "Mike Szyndel", "link": "https://stackoverflow.com/users/2422778/mike-szyndel"}, "edited": false, "score": 0, "creation_date": 1529440561, "post_id": 50935802, "comment_id": 88871667, "body": "Could you please provide a full log from log/development.log? There&#39;s clearly some info missing here"}, {"owner": {"reputation": 177, "user_id": 6776511, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4567d009cb633351538c947fbe71a6d9?s=128&d=identicon&r=PG&f=1", "display_name": "&#201;owyn", "link": "https://stackoverflow.com/users/6776511/%c3%89owyn"}, "reply_to_user": {"reputation": 9737, "user_id": 2422778, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aUihh.jpg?s=128&g=1", "display_name": "Mike Szyndel", "link": "https://stackoverflow.com/users/2422778/mike-szyndel"}, "edited": false, "score": 0, "creation_date": 1529442033, "post_id": 50935802, "comment_id": 88872198, "body": "@MikeSzyndel i did that, added all my request log"}, {"owner": {"reputation": 1165, "user_id": 143238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/faa7d5a8a0a4333e1e741aa41e802fc1?s=128&d=identicon&r=PG", "display_name": "BM5k", "link": "https://stackoverflow.com/users/143238/bm5k"}, "edited": false, "score": 1, "creation_date": 1529442371, "post_id": 50935802, "comment_id": 88872319, "body": "<code>@product.steps &lt;&lt; Step.where(:id =&gt; steps)</code> will try to push an array of steps into your association <code>Step.where</code> returns an array, so you&#39;re essentially saying <code>[] &lt;&lt; []</code> which will result in <code>[[]]</code>. See <a href=\"https://stackoverflow.com/a/8304145/143238\">stackoverflow.com/a/8304145/143238</a>"}, {"owner": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "reply_to_user": {"reputation": 1165, "user_id": 143238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/faa7d5a8a0a4333e1e741aa41e802fc1?s=128&d=identicon&r=PG", "display_name": "BM5k", "link": "https://stackoverflow.com/users/143238/bm5k"}, "edited": false, "score": 1, "creation_date": 1529442720, "post_id": 50935802, "comment_id": 88872456, "body": "On top of what @BM5k I would also save <code>@product</code> before adding the steps to it."}], "answers": [{"tags": [], "owner": {"reputation": 2471, "user_id": 8063597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41fe33a379a7894b9246569a6e0396aa?s=128&d=identicon&r=PG&f=1", "display_name": "Rohan", "link": "https://stackoverflow.com/users/8063597/rohan"}, "is_accepted": false, "score": 1, "last_activity_date": 1529473070, "creation_date": 1529473070, "answer_id": 50940947, "question_id": 50935802, "link": "https://stackoverflow.com/questions/50935802/getting-activerecordrecordinvalid-on-save-many-to-many-relationship/50940947#50940947", "title": "Getting ActiveRecord::RecordInvalid on save many to many relationship", "body": "<p>As per the description shared it seems like there could one of the below mentioned issues which could be raising the exception.</p>\n\n<p>Firstly, the below mentioned log trail shows that only steps is not permitted apart from that all other parameter is being permitted to the database.</p>\n\n<pre><code>Parameters: {\"product\"=&gt;{\"name\"=&gt;\"test 1\", \"brand\"=&gt;\"test\", \"released_for\"=&gt;\"Low Poo\", \"weight\"=&gt;\"50.0\", \"measurement\"=&gt;\"g\", \"steps\"=&gt;\"1,2,3\", \"user_id\"=&gt;\"test@gmail.com\"}}\nUnpermitted parameter: :steps\n</code></pre>\n\n<p>So, does the user_id column has a datatype string, also could not find the user_id column in the table structure shared.</p>\n\n<p>Secondly, for the ActiveRecord::RecordInvalid, this is raised when a validation is failed for the corresponding model.</p>\n\n<p>Please check if there are any validation failure happening for the above case.</p>\n"}, {"comments": [{"owner": {"reputation": 9737, "user_id": 2422778, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aUihh.jpg?s=128&g=1", "display_name": "Mike Szyndel", "link": "https://stackoverflow.com/users/2422778/mike-szyndel"}, "edited": false, "score": 0, "creation_date": 1529529923, "post_id": 50941833, "comment_id": 88911910, "body": "This is a wrong answer. Please see what Rohan wrote"}, {"owner": {"reputation": 187, "user_id": 1477932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ae986215778ab701f6573bc4bd28ad?s=128&d=identicon&r=PG", "display_name": "GAURAV SETH", "link": "https://stackoverflow.com/users/1477932/gaurav-seth"}, "reply_to_user": {"reputation": 9737, "user_id": 2422778, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aUihh.jpg?s=128&g=1", "display_name": "Mike Szyndel", "link": "https://stackoverflow.com/users/2422778/mike-szyndel"}, "edited": false, "score": 0, "creation_date": 1529562178, "post_id": 50941833, "comment_id": 88920059, "body": "The validation failed: Steps isn&#39;t valid, this indicate step id not able to create because step has not passed validation. Why it is not getting crated that will be clear once Rohan will puts product object and step. i am thinking  it is becasue @product.steps &lt;&lt; Step.where(:id =&gt; steps),  this line will insert array inside array so step will be [[1,2,3]] but it should be [1,2,3]"}, {"owner": {"reputation": 9737, "user_id": 2422778, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aUihh.jpg?s=128&g=1", "display_name": "Mike Szyndel", "link": "https://stackoverflow.com/users/2422778/mike-szyndel"}, "edited": false, "score": 0, "creation_date": 1529582804, "post_id": 50941833, "comment_id": 88932577, "body": "No. Steps are not valid because they are not permitted in params. Validation may not be specified explicitly in the model but come from Rails association. Your advice is wrong and dangerous, bypassing Rails security features."}], "tags": [], "owner": {"reputation": 187, "user_id": 1477932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ae986215778ab701f6573bc4bd28ad?s=128&d=identicon&r=PG", "display_name": "GAURAV SETH", "link": "https://stackoverflow.com/users/1477932/gaurav-seth"}, "is_accepted": true, "score": 0, "last_activity_date": 1529476988, "creation_date": 1529476988, "answer_id": 50941833, "question_id": 50935802, "link": "https://stackoverflow.com/questions/50935802/getting-activerecordrecordinvalid-on-save-many-to-many-relationship/50941833#50941833", "title": "Getting ActiveRecord::RecordInvalid on save many to many relationship", "body": "<p>The validation failed: Steps isn't valid. This means that step id which you are passing is not valid. you can print @product and @product.steps to check what is printing. When i check code  <code>@product.steps &lt;&lt; Step.where(:id =&gt; steps)</code> this code will make array of array so it must be  <code>@product.steps = Step.where(:id =&gt; steps)</code> or  <code>@product.steps += Step.where(:id =&gt; steps)</code>. Print @product and @product.steps this will give clear detail what data is trying to save in table.</p>\n"}], "owner": {"reputation": 177, "user_id": 6776511, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4567d009cb633351538c947fbe71a6d9?s=128&d=identicon&r=PG&f=1", "display_name": "&#201;owyn", "link": "https://stackoverflow.com/users/6776511/%c3%89owyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 50941833, "answer_count": 2, "score": 0, "last_activity_date": 1531446487, "creation_date": 1529437231, "last_edit_date": 1531446487, "question_id": 50935802, "link": "https://stackoverflow.com/questions/50935802/getting-activerecordrecordinvalid-on-save-many-to-many-relationship", "title": "Getting ActiveRecord::RecordInvalid on save many to many relationship", "body": "<p>I have the following models to describe a many-to-many relationship between steps and product:</p>\n\n<pre><code>class Step &lt; ApplicationRecord\n  has_and_belongs_to_many :products\nend\n\nclass Product &lt; ApplicationRecord\n  has_and_belongs_to_many :steps\nend\n\nclass ProductsStep &lt; ApplicationRecord\n  belongs_to :product\n  belongs_to :step\nend\n</code></pre>\n\n<p>And these are my tables:</p>\n\n<p><strong>steps:</strong></p>\n\n<pre><code>   Column    |            Type             |                     Modifiers                      | Storage  | Stats target | Description \n-------------+-----------------------------+----------------------------------------------------+----------+--------------+-------------\n id          | bigint                      | not null default nextval('steps_id_seq'::regclass) | plain    |              | \n name        | character varying           | not null                                           | extended |              | \n created_at  | timestamp without time zone |                                                    | plain    |              | \n updated_at  | timestamp without time zone |                                                    | plain    |              | \nIndexes:\n    \"steps_pkey\" PRIMARY KEY, btree (id)\n    \"index_steps_on_weeks_id\" btree (weeks_id)\n</code></pre>\n\n<p><strong>products:</strong></p>\n\n<pre><code>      Column       |            Type             |                       Modifiers                       | Storage  | Stats target | Description \n--------------------+-----------------------------+-------------------------------------------------------+----------+--------------+-------------\n id                 | bigint                      | not null default nextval('products_id_seq'::regclass) | plain    |              | \n name               | character varying           | not null                                              | extended |              | \n photo_file_name    | character varying           |                                                       | extended |              | \n photo_content_type | character varying           |                                                       | extended |              | \n photo_file_size    | integer                     |                                                       | plain    |              | \n photo_updated_at   | timestamp without time zone |                                                       | plain    |              | \n created_at         | timestamp without time zone | not null                                              | plain    |              | \n updated_at         | timestamp without time zone | not null                                              | plain    |              | \nIndexes:\n    \"products_pkey\" PRIMARY KEY, btree (id)\n</code></pre>\n\n<p><strong>products_steps:</strong></p>\n\n<pre><code>   Column   |            Type             | Modifiers | Storage | Stats target | Description \n------------+-----------------------------+-----------+---------+--------------+-------------\n step_id    | integer                     | not null  | plain   |              | \n product_id | integer                     | not null  | plain   |              | \n created_at | timestamp without time zone | not null  | plain   |              | \n updated_at | timestamp without time zone | not null  | plain   |              | \nIndexes:\n    \"products_steps_pkey\" PRIMARY KEY, btree (product_id, step_id)\n</code></pre>\n\n<p>I would like to save the products with the associated steps, but I'm receiving the following message:</p>\n\n<blockquote>\n  <p>Completed 422 Unprocessable Entity in 81ms (ActiveRecord: 10.6ms)</p>\n  \n  <p>ActiveRecord::RecordInvalid (The validation failed: Steps isn't valid)</p>\n</blockquote>\n\n<p>I did the following:</p>\n\n<pre><code>def create\n    steps = Array.new()\n    params[:product][:steps].split(/,/).each do |s|\n      steps &lt;&lt; s.to_i\n    end\n    @product = Product.new(product_params)\n    @product.steps &lt;&lt; Step.where(:id =&gt; steps)\n\n    puts \"#{@product.steps.first.name}\" #the name is printed\n    product = Product.find_by(name: @product.name, brand: @product.brand)\n    if product.nil?\n      if @product.save!\n        render :json =&gt; {:status =&gt; :success}\n      end\n    end\n  end\n</code></pre>\n\n<p>The steps params is a string like \"1,2,3\" that represents the step id.</p>\n\n<p>I have no idea what I did wrong, I did exactly the same thing in other situations and it worked.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Here is all my request and the errors message, including the sugested validation: </p>\n\n<pre><code>Bad request content body\nStarted POST \"/products/?product[name]=test+1&amp;product[brand]=test&amp;product[released_for]=Low+Poo&amp;product[weight]=50.0&amp;product[measurement]=g&amp;product[steps]=1%2C2%2C3&amp;product[user_id]=test%40gmail.com&amp;\" for 192.168.2.5 at 2018-06-19 17:56:23 -0300\nProcessing by ProductsController#create as HTML\n  Parameters: {\"product\"=&gt;{\"name\"=&gt;\"test 1\", \"brand\"=&gt;\"test\", \"released_for\"=&gt;\"Low Poo\", \"weight\"=&gt;\"50.0\", \"measurement\"=&gt;\"g\", \"steps\"=&gt;\"1,2,3\", \"user_id\"=&gt;\"test@gmail.com\"}}\nUnpermitted parameter: :steps\n  Step Load (0.4ms)  SELECT \"steps\".* FROM \"steps\" WHERE \"steps\".\"id\" IN ($1, $2, $3)  [[\"id\", 1], [\"id\", 2], [\"id\", 3]]\n  \u21b3 app/controllers/products_controller.rb:73\n------LOGS-------\n#&lt;ActiveModel::Errors:0x007f2840acb628 @base=#&lt;Product id: nil, name: \"Test 1\", brand: \"Test\", measurement: \"g\", weight: #&lt;BigDecimal:7f28409f2ee0,'0.5E2',9(18)&gt;, photo_file_name: nil, photo_content_type: nil, photo_file_size: nil, photo_updated_at: nil, released_for: \"Low Poo\", created_at: nil, updated_at: nil, user_id: \"test@gmail.com\"&gt;, @messages={:steps=&gt;[\"n\u00e3o \u00e9 v\u00e1lido\"]}, @details={:steps=&gt;[{:error=&gt;:invalid}, {:error=&gt;:invalid}, {:error=&gt;:invalid}]}&gt;\n-------------\nHidrata\u00e7\u00e3o\n  Product Load (0.3ms)  SELECT  \"products\".* FROM \"products\" WHERE \"products\".\"name\" = $1 AND \"products\".\"brand\" = $2 LIMIT $3  [[\"name\", \"Test 1\"], [\"brand\", \"Test\"], [\"LIMIT\", 1]]\n  \u21b3 app/controllers/products_controller.rb:78\n#&lt;ActiveModel::Errors:0x007f2840acb628 @base=#&lt;Product id: nil, name: \"Test 1\", brand: \"Test\", measurement: \"g\", weight: #&lt;BigDecimal:7f28409f2ee0,'0.5E2',9(18)&gt;, photo_file_name: nil, photo_content_type: nil, photo_file_size: nil, photo_updated_at: nil, released_for: \"Low Poo\", created_at: nil, updated_at: nil, user_id: \"test@gmail.com\"&gt;, @messages={:steps=&gt;[\"n\u00e3o \u00e9 v\u00e1lido\"]}, @details={:steps=&gt;[{:error=&gt;:invalid}, {:error=&gt;:invalid}, {:error=&gt;:invalid}]}&gt;\n   (0.2ms)  BEGIN\n  \u21b3 app/controllers/products_controller.rb:82\n   (0.2ms)  ROLLBACK\n  \u21b3 app/controllers/products_controller.rb:82\nCompleted 422 Unprocessable Entity in 75ms (ActiveRecord: 9.4ms)\n\n\n\nActiveRecord::RecordInvalid (A valida\u00e7\u00e3o falhou: Steps n\u00e3o \u00e9 v\u00e1lido):\n\napp/controllers/products_controller.rb:82:in `create'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 537, "user_id": 6665356, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4c86625b9dd9d7d9505758a743d871ea?s=128&d=identicon&r=PG&f=1", "display_name": "matQ", "link": "https://stackoverflow.com/users/6665356/matq"}, "edited": false, "score": 0, "creation_date": 1529438859, "post_id": 50935875, "comment_id": 88870935, "body": "i test your code the result is close but not want i need. the shop appear 2 -3 times so its good, but each one has an array of the addresses, Example. shopOne with 2 address, and the next object is the same, the shopOne with an array of the 2 addresses, but i need as i show in the example, any other idea?"}, {"owner": {"reputation": 537, "user_id": 6665356, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4c86625b9dd9d7d9505758a743d871ea?s=128&d=identicon&r=PG&f=1", "display_name": "matQ", "link": "https://stackoverflow.com/users/6665356/matq"}, "edited": false, "score": 0, "creation_date": 1529438975, "post_id": 50935875, "comment_id": 88870992, "body": "each shop with one address and shown in result as many addresses it has"}], "tags": [], "owner": {"reputation": 917, "user_id": 7411621, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a37fcd6d889200d8721cf58a491e4ee5?s=128&d=identicon&r=PG&f=1", "display_name": "taras", "link": "https://stackoverflow.com/users/7411621/taras"}, "is_accepted": false, "score": 1, "last_activity_date": 1529442630, "last_edit_date": 1529442630, "creation_date": 1529437553, "answer_id": 50935875, "question_id": 50935578, "link": "https://stackoverflow.com/questions/50935578/ruby-on-rails-5-show-all-results-depending-on-related-table-quantity/50935875#50935875", "title": "Ruby on rails 5 show all results depending on related table quantity", "body": "<p>You need to <a href=\"http://guides.rubyonrails.org/active_record_querying.html#joins\" rel=\"nofollow noreferrer\">JOIN</a> tables:</p>\n\n<pre><code>Shop.joins(:adresses).where(\"shops.name ILIKE CONCAT('%',?,'%')\", params[:name])\n</code></pre>\n\n<hr>\n\n<p><strong>UPDATE</strong></p>\n\n<p>If you need to create an array from example, you can do it like this (using multiple methods for convenience):</p>\n\n<pre><code>def create_array\n  addresses.map do |address|\n    {\n      name: address.shop.name,\n      address: {\n        id:        address.id,\n        direction: address.direction\n      }\n    }\n  end\nend\n\ndef addresses\n  Address.eager_load(:shop)\n         .where(\"shops.name ILIKE CONCAT('%',?,'%')\", params[:name])\n         .order(:shop_id)\nend\n</code></pre>\n"}], "owner": {"reputation": 537, "user_id": 6665356, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4c86625b9dd9d7d9505758a743d871ea?s=128&d=identicon&r=PG&f=1", "display_name": "matQ", "link": "https://stackoverflow.com/users/6665356/matq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1611566842, "creation_date": 1529436184, "last_edit_date": 1611566842, "question_id": 50935578, "link": "https://stackoverflow.com/questions/50935578/ruby-on-rails-5-show-all-results-depending-on-related-table-quantity", "title": "Ruby on rails 5 show all results depending on related table quantity", "body": "<p>I have 2 models, one is shop and the other is address. A shop has many addresses and an address belongs to a shop.</p>\n<p>I want to select (search) by name and filter all the shops that match with the search word and separated for each address, e.g. <code>search param[:name]</code>.</p>\n<pre><code>def filter_shops\n     @shops = Shop.where(&quot;name ILIKE CONCAT('%',?,'%')&quot;,params[:name])\nend\n</code></pre>\n<p>This action searches all the shops by the param name, but I want that if a shop has 2 or 3 addresses it has to be shown in the result 2-3 times.</p>\n<p>Example (expected results):</p>\n<pre><code>params[:name] value is &quot;sho&quot;\n\n[{name: &quot;shopOne&quot;,\n address: {\n     id: 1,\n     direction: &quot;av. jojojo 321&quot;}\n\n},{name: &quot;shopOne&quot;,\n     address: {\n           id: 2,\n        direction: &quot;onother avenue &quot;}},\n {name: &quot;shopTwo&quot;,\n     address: {\n           id: 7,\n           direction: &quot;av. of other shop 333&quot;}\n}]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 8541, "user_id": 8366499, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z9t89.jpg?s=128&g=1", "display_name": "divibisan", "link": "https://stackoverflow.com/users/8366499/divibisan"}, "edited": false, "score": 1, "creation_date": 1529434579, "post_id": 50935035, "comment_id": 88869034, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3677753/how-to-display-the-current-date-in-mm-dd-yyyy-format-in-rails\">How to display the current date in &quot;mm/dd/yyyy&quot; format in Rails</a>"}], "answers": [{"tags": [], "owner": {"reputation": 600, "user_id": 2796616, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sPrN.png?s=128&g=1", "display_name": "andrew21", "link": "https://stackoverflow.com/users/2796616/andrew21"}, "is_accepted": false, "score": 0, "last_activity_date": 1529435167, "creation_date": 1529435167, "answer_id": 50935374, "question_id": 50935035, "link": "https://stackoverflow.com/questions/50935035/add-current-date-in-rails-form/50935374#50935374", "title": "Add current date in rails form", "body": "<p>I'm not sure this is ideal, but if you have to have it in the form, maybe it makes more sense to set it in the controller></p>\n\n<pre><code>class SomeController &lt; ApplicationController\n  def edit\n    @modelname = Modelname.find(params[:id])\n    @modelname.date_submitted = Time.now\n  end\nend\n</code></pre>\n\n<p>Given forms could be submitted at some future time/date, I don't think you want to set it in the form as the date/time could become stale/out of date.  instead, I would capture this on the create/update as such:</p>\n\n<pre><code>class SomeController &lt; ApplicationController\n  def update\n    @modelname = Modelname.find(params[:id])\n    @modelname.update(modelname_params.merge({ date_submitted: Time.now }))\n  end\n\n  private\n\n  def modelname_params\n    params.required(:modelname).permit(:fieldname)\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "edited": false, "score": 0, "creation_date": 1529438450, "post_id": 50935394, "comment_id": 88870734, "body": "undefined method `new_record?&#39; for nil:NilClass"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "edited": false, "score": 0, "creation_date": 1529438587, "post_id": 50935394, "comment_id": 88870800, "body": "i dont want the date to change if i edit the form some other day"}, {"owner": {"reputation": 4769, "user_id": 9541423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f816e0659e0cf40bbe0ef7224a3a56a0?s=128&d=identicon&r=PG", "display_name": "Sovalina", "link": "https://stackoverflow.com/users/9541423/sovalina"}, "edited": false, "score": 0, "creation_date": 1529438689, "post_id": 50935394, "comment_id": 88870861, "body": "<code>@my_object</code> is an example for the answer, you need to replace it with the record object you pass to the form. Anyway, if you always need the default value, just do <code>value: Date.today</code> without any condition"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "edited": false, "score": 0, "creation_date": 1529504892, "post_id": 50935394, "comment_id": 88898886, "body": "**&lt;%= form.date_field :date_submitted, value: (Date.today if @funding.new_record?), required: true %&gt; **I am able to select any date. I just want the date when the application is submitted. and it should not change when i edit my application"}], "tags": [], "owner": {"reputation": 4769, "user_id": 9541423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f816e0659e0cf40bbe0ef7224a3a56a0?s=128&d=identicon&r=PG", "display_name": "Sovalina", "link": "https://stackoverflow.com/users/9541423/sovalina"}, "is_accepted": false, "score": 0, "last_activity_date": 1529435240, "creation_date": 1529435240, "answer_id": 50935394, "question_id": 50935035, "link": "https://stackoverflow.com/questions/50935035/add-current-date-in-rails-form/50935394#50935394", "title": "Add current date in rails form", "body": "<p>You can add a value to the <code>date_field</code>:</p>\n\n<pre><code>&lt;%= form.date_field :date_submitted, value: Date.today %&gt;\n</code></pre>\n\n<p>If you share the form between \"new\" and \"edit\" you can add a condition to display the default value (Date.today) or the recorded date:</p>\n\n<pre><code>&lt;%= form.date_field :date_submitted, value: (Date.today if @my_object.new_record?)  %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 0, "last_activity_date": 1529436514, "last_edit_date": 1529436514, "creation_date": 1529436203, "answer_id": 50935581, "question_id": 50935035, "link": "https://stackoverflow.com/questions/50935035/add-current-date-in-rails-form/50935581#50935581", "title": "Add current date in rails form", "body": "<p>Rails 5 has implemented a nice attributes API (<a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Attributes/ClassMethods.html#method-i-attribute\" rel=\"nofollow noreferrer\"><code>ActiveRecord::Attributes::ClassMethods#attribute</code></a> so if you wanted a default value for <code>date_submitted</code> it would be as simple as </p>\n\n<pre><code>class SomeModel &lt; ApplicationRecord\n  attribute :date_submitted, :datetime, default: -&gt; {Time.now}\nend\n</code></pre>\n\n<p>Now when the <code>date_submitted</code> method is called on the object (e.g. via a form builder) it will show the current date/time of when the method was called. </p>\n\n<p>Since this is just a default value if a different value is provided during instantiation e.g <code>SomeModel.new(date_submitted: \"2018-06-19\")</code> that value would take precedence over the default value provided.</p>\n\n<p>That being said since you have decided that <code>date_submitted</code> is required and read only and you are setting this value, if you are using time_stamps on your model it might make more sense to just do something like </p>\n\n<pre><code>class SomeModel &lt; ApplicationRecord\n  def date_submitted\n    self.created_at.to_date #for just a Date\n  end\nend\n</code></pre>\n\n<p>Since the <code>created_at</code> timestamp will always represent when the object was created which seems to be identical to <code>date_submitted</code> in this case. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1529436514, "creation_date": 1529433710, "question_id": 50935035, "link": "https://stackoverflow.com/questions/50935035/add-current-date-in-rails-form", "title": "Add current date in rails form", "body": "<p>I want to add current date in rails form as below. I am not able to figure out how. kindly help</p>\n\n<pre><code>&lt;div class = \"form-group\"&gt;\n        &lt;div class=\"control-label col-sm-2\"&gt;\n          &lt;%= form.label :date_submitted, class: \"required\" %&gt;\n        &lt;/div&gt;\n        &lt;div class=\"col-sm-8\"&gt;\n          &lt;%= form.date_field :date_submitted, Date.today, required: true, readonly: true %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 9783543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214091178226239/picture?type=large", "display_name": "Benjamin Richard", "link": "https://stackoverflow.com/users/9783543/benjamin-richard"}, "edited": false, "score": 0, "creation_date": 1529487063, "post_id": 50936585, "comment_id": 88887020, "body": "I already CreateJoinTableUsersAvailabilities, I put User has_many availabilities and I put your scope and it&#39;s working ! Thank you for your help !"}], "tags": [], "owner": {"reputation": 4769, "user_id": 9541423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f816e0659e0cf40bbe0ef7224a3a56a0?s=128&d=identicon&r=PG", "display_name": "Sovalina", "link": "https://stackoverflow.com/users/9541423/sovalina"}, "is_accepted": false, "score": 0, "last_activity_date": 1529440693, "creation_date": 1529440693, "answer_id": 50936585, "question_id": 50934794, "link": "https://stackoverflow.com/questions/50934794/rails-select-date-from-an-availability/50936585#50936585", "title": "Rails select date from an availability", "body": "<p>First, your relationship between <code>User</code> and <code>Availability</code> is wrong. An HABTM relation should be shared between the two models with a join table (<a href=\"https://apidock.com/rails/ActiveRecord/Associations/ClassMethods/has_and_belongs_to_many\" rel=\"nofollow noreferrer\">source</a>)<br>\nChange to a <code>has_many/belongs_to</code> relationship if Availability just belongs to one User.</p>\n\n<p>For your scope you have to join the relationship in the query:</p>\n\n<pre><code>scope :with_start_time_gte, -&gt; (ref_date) { joins(:availabilities).where('availabilities.start_time &gt;= ?', ref_date) }\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 9783543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214091178226239/picture?type=large", "display_name": "Benjamin Richard", "link": "https://stackoverflow.com/users/9783543/benjamin-richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 215, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529440693, "creation_date": 1529432854, "question_id": 50934794, "link": "https://stackoverflow.com/questions/50934794/rails-select-date-from-an-availability", "title": "Rails select date from an availability", "body": "<p>I'm working on an application, I actually implement a filter on my user index to search some users by : Language, city and availability(date). The filter by language and city work perfectly but not for the date.</p>\n\n<p>index.html.erb :</p>\n\n<pre><code>&lt;div&gt;\n  Date de d\u00e9part :\n  &lt;%= f.text_field :with_start_time_gte, 'data-provide' =&gt; 'datepicker' %&gt;\n&lt;/div&gt;\n&lt;%= f.submit 'Rechercher' %&gt;\n</code></pre>\n\n<p>I create a model Availability with params (:name, :start_time, :end_time, :user_id)\nUser has_and_belongs_to_many :availability and availability belongs_to :user. I need that the filter search between the date between start_time and end_time of the availabilities and return the users available.</p>\n\n<p>users_controller.rb :</p>\n\n<pre><code>  def index\n@filterrific = initialize_filterrific(\n  User,\n  params[:filterrific]\n  #persistence_id: 'shared_key',\n  #default_filter_params: {},\n  #available_filters: [],\n) or return\n@users = @filterrific.find.page(params[:page])\n\n# Respond to html for initial page load and to js for AJAX filter updates.\nrespond_to do |format|\n  format.html\n  format.js\nend\n\nrescue ActiveRecord::RecordNotFound =&gt; e\n  # There is an issue with the persisted param_set. Reset it.\n  puts \"Had to reset filterrific params: #{ e.message }\"\n  redirect_to(reset_filterrific_url(format: :html)) and return\nend\n</code></pre>\n\n<p>user.rb :</p>\n\n<pre><code>  filterrific(\ndefault_filter_params: {},\navailable_filters: [\n  :with_mother_tongue,\n  :with_locality,\n  :with_start_time_gte])\n\nscope :with_mother_tongue, -&gt; (search_string) {\nwhere(\"users.mother_tongue LIKE ?\", (search_string.to_s.gsub('*', '%') + '%').gsub(/%+/, '%'))\n}\n\nscope :with_locality, -&gt; (search_string) {\nwhere(\"users.locality LIKE ?\", (search_string.to_s.gsub('*', '%') + '%').gsub(/%+/, '%'))\n}\n\nscope :with_start_time_gte, lambda { |ref_date|\nwhere('users.availabilities.start_time &gt;= ?', ref_date)\n}\n</code></pre>\n\n<p>I think the problem is in the scope to take start_time from availabilities of user... But don't know how to do...\nThanks in advance for your help !</p>\n"}, {"tags": ["ruby", "docker"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 9859242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/044057ff5314baf489a3428054015847?s=128&d=identicon&r=PG&f=1", "display_name": "Kaue", "link": "https://stackoverflow.com/users/9859242/kaue"}, "edited": false, "score": 0, "creation_date": 1529493705, "post_id": 50940172, "comment_id": 88891300, "body": "Sorry, maybe I did not express myself correctly. My idea was to just run the container, and it execute the command I need, not that I have to pass this command every time."}, {"owner": {"reputation": 340, "user_id": 6855759, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3UfK3V6lnPY/AAAAAAAAAAI/AAAAAAAAAlU/CG1lontACf0/photo.jpg?sz=128", "display_name": "Caleb Keene", "link": "https://stackoverflow.com/users/6855759/caleb-keene"}, "reply_to_user": {"reputation": 17, "user_id": 9859242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/044057ff5314baf489a3428054015847?s=128&d=identicon&r=PG&f=1", "display_name": "Kaue", "link": "https://stackoverflow.com/users/9859242/kaue"}, "edited": false, "score": 0, "creation_date": 1529547736, "post_id": 50940172, "comment_id": 88916103, "body": "Yup, so you can go with my second suggestion, have a script that you build into the image, with the <code>ADD</code> directive in your <code>Dockerfile</code> (make sure you have made it executable with <code>chmod +x script_name</code>) , then tell the image to always start a container by with the entry command being this script (you can also specify this in your <code>Dockerfile</code> with the <code>ENTRYPOINT</code> directive)."}], "tags": [], "owner": {"reputation": 340, "user_id": 6855759, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3UfK3V6lnPY/AAAAAAAAAAI/AAAAAAAAAlU/CG1lontACf0/photo.jpg?sz=128", "display_name": "Caleb Keene", "link": "https://stackoverflow.com/users/6855759/caleb-keene"}, "is_accepted": true, "score": 0, "last_activity_date": 1529468503, "creation_date": 1529468503, "answer_id": 50940172, "question_id": 50934290, "link": "https://stackoverflow.com/questions/50934290/docker-run-fail-with-ruby/50940172#50940172", "title": "Docker run fail with ruby", "body": "<p>what's your question exactly? you can just run it manually by firing up a container with an interactive terminal from your image, and then run the commands you want, or have a script in the image (or mounted as a volume) and then pass the script as the entry command instead.</p>\n\n<p><code>docker run -it IMAGE_ID bash</code> (for running manual commands)</p>\n\n<p>if you want to use a script instead, put an <code>ENTRYPOINT</code> script in your <code>Dockerfile</code> instead</p>\n"}], "owner": {"reputation": 17, "user_id": 9859242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/044057ff5314baf489a3428054015847?s=128&d=identicon&r=PG&f=1", "display_name": "Kaue", "link": "https://stackoverflow.com/users/9859242/kaue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 50940172, "answer_count": 1, "score": 0, "last_activity_date": 1529468503, "creation_date": 1529430671, "question_id": 50934290, "link": "https://stackoverflow.com/questions/50934290/docker-run-fail-with-ruby", "title": "Docker run fail with ruby", "body": "<p>I have a little problem, when i run my container this: </p>\n\n<pre><code>docker run -it emails_request cucumber -t @teste_inserindo_email\n</code></pre>\n\n<p>It's ok.</p>\n\n<p>But, when i run this:</p>\n\n<pre><code>docker run it emails_request\n</code></pre>\n\n<p>Where my @teste_inserindo_emails, is on my dockerfile</p>\n\n<pre><code>WORKDIR /app\nCOPY Gemfile .\nRUN bundle install &amp;&amp; bundle clean\nCOPY . /app\nEXPOSE 80\nRUN cucumber -t @teste_inserindo_email\n#CMD [\"cucumber\", \"-t\", \" @teste_inserindo_email\"]  \n</code></pre>\n\n<p>Not found, return:</p>\n\n<pre><code>$ docker run -t emails_request\nirb(main):001:0&gt;\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>$ docker run emails_request\nSwitch to inspect mode.\n</code></pre>\n"}, {"tags": ["ruby", "xss", "sanitize", "javascript-injection", "html-safe"], "comments": [{"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 3, "creation_date": 1529430605, "post_id": 50934229, "comment_id": 88867035, "body": "Please add some more code to your post. What is your &quot;first name input&quot;? And if your &quot;display&quot; code is just <code>&lt;%= first_name %&gt;</code>, ERB or the equivalent is supposed to escape the <code>&lt;</code> and <code>&gt;</code> into <code>&amp;lt;</code> and <code>&amp;gt;</code>, neutralizing the script."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 2, "creation_date": 1529433658, "post_id": 50934229, "comment_id": 88868538, "body": "<a href=\"http://api.rubyonrails.org/classes/String.html#method-i-html_safe\" rel=\"nofollow noreferrer\"><code>html_safe</code></a> is the exact wrong thing to do <code>html_safe</code> marks the string as being safe (which appears to be what you are doing since the alert shows) remove this call and the string will be displayed appropriately as @Phlip mentioned. Alternatively you could use <code>&lt;%= sanitize(first_name) %&gt;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3952, "user_id": 5326191, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/01c8ba01185eaf446076672cc7339035?s=128&d=identicon&r=PG&f=1", "display_name": "Digvijay", "link": "https://stackoverflow.com/users/5326191/digvijay"}, "is_accepted": false, "score": 0, "last_activity_date": 1529505684, "creation_date": 1529505684, "answer_id": 50950883, "question_id": 50934229, "link": "https://stackoverflow.com/questions/50934229/resolve-xss-issue-on-ruby-on-rails/50950883#50950883", "title": "resolve XSS issue on ruby on rails", "body": "<p>I used this function and it worked as expected.</p>\n\n<pre><code>CGI::escapeHTML(user.firstname)\n</code></pre>\n\n<p>On display page, it showed <code>&lt;script&gt;alert(\"123\");&lt;/script&gt;</code> but the script didn't run because it escaped the tags.</p>\n"}], "owner": {"reputation": 3952, "user_id": 5326191, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/01c8ba01185eaf446076672cc7339035?s=128&d=identicon&r=PG&f=1", "display_name": "Digvijay", "link": "https://stackoverflow.com/users/5326191/digvijay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529505684, "creation_date": 1529430421, "question_id": 50934229, "link": "https://stackoverflow.com/questions/50934229/resolve-xss-issue-on-ruby-on-rails", "title": "resolve XSS issue on ruby on rails", "body": "<p>Example: If we store <code>&lt;script&gt;alert(299792458)&lt;/script&gt;</code> as a first name input, the value is getting accepted and stored.</p>\n\n<p>When we display the data, an alert pops up. I understand that it's a Cross-Site Scripting (XSS). I have gone through <a href=\"http://guides.rubyonrails.org/security.html#cross-site-scripting-xss\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/security.html#cross-site-scripting-xss</a> but I wan't able to understand.</p>\n\n<p>All I need to do is make sure that alert doesn't happen. So, what's a best option. Sanitize first name while saving it (or) use html_safe when displaying it.</p>\n"}, {"tags": ["javascript", "ruby", "internet-explorer", "bho"], "comments": [{"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1529430876, "post_id": 50933928, "comment_id": 88867164, "body": "Usually internet explorer doesn&#39;t respond to Java script. If you execute in Firefox that perfectly responds to your JavaScript. And I want to tell you WATIR-CLASSIC is the automation tool which uses Win32ole to do the Job in ie."}, {"owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "reply_to_user": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1529433424, "post_id": 50933928, "comment_id": 88868425, "body": "@Rajagopalan Watir is a web driver, as far as I am aware, Watir does not allow JavaScript to drive Ruby. This question is about how to drive Ruby from JavaScript using IE&#39;s OLE automation framework."}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1529454476, "post_id": 50933928, "comment_id": 88875397, "body": "Watir is obviously using selenium webdriver but I am talking about watir-classic which uses win32ole to drive ie, that&#39;s specifically for ie."}, {"owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "reply_to_user": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1529484363, "post_id": 50933928, "comment_id": 88885294, "body": "@Rajagopalan That is cool and stuff, but it is still a web driver. Watir or Watir-Classic drives the browser, not the other way around, and as far as I can tell, it doesn&#39;t solve the problem specified in this post."}], "answers": [{"tags": [], "owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "is_accepted": true, "score": 0, "last_activity_date": 1530092247, "last_edit_date": 1530092247, "creation_date": 1529791079, "answer_id": 51005382, "question_id": 50933928, "link": "https://stackoverflow.com/questions/50933928/win32ole-inject-ruby-function-into-internet-explorers-javascript/51005382#51005382", "title": "WIN32OLE - Inject Ruby function into Internet Explorer&#39;s JavaScript", "body": "<p>After a week of scouring the internet and finding nothing I thought \"What if we are naive and pass an object with <code>method_missing</code> defined?\"</p>\n\n<p>30 minutes later, and I can call Ruby from JavaScript.</p>\n\n<pre><code>class MyFunc\n  # Called when no arguments are passed to JavaScript function\n  def call\n    #Execute any ruby code here!!\n\n    #You can also return values back to JavaScript!!\n    return 1\n  end\n\n  # Called when arguments are passed to JavaScript function\n  def value(*args)\n    if args.length == 0\n      # This will be called if the function is called without parenthesis in JS\n      # e.g. console.log(document.someFunc)\n      return nil\n    else\n      #This is called with the parsed arguments. Note: Functions passed in from JS are of type WIN32OLE. Theoretically this should be callable, but better would be to make a JS function which can call other JS functions\n      #Execute any ruby code here!!\n      puts \"#{args.inspect}\"\n\n      #Can also return values here as well\n      return 1\n    end\n  end\nend\nie.document.setVar(\"myFunc\",MyFunc.new})\n</code></pre>\n\n<p>You can also initialise and access instance variables:</p>\n\n<pre><code>class MyClass\n  def initialize\n    @hello = \"world\"\n  end\nend\nie.document.setVar(\"myClass\",MyClass.new})\n\n#IN IE: document.myClass[\"hello\"] //=&gt; \"world\"\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p>Some things can go drastically wrong and even cause ruby crashes. Some examples of things that don't work:</p>\n\n<ul>\n<li>Evaluating the object directly: <code>document.myObj</code>. JavaScript will interpret the function as an Object , perhaps as one would expect.</li>\n<li>Getting values which don't exist doesn't do anything: <code>document.myObj[\"hello\"]</code>.</li>\n<li>Setting values which don't exist causes ruby to crash: <code>document.myObj[\"hello\"]=1</code>.</li>\n</ul>\n\n<p>Some things also make little sense at all, for example I made the following loop:</p>\n\n<p>Given a class:</p>\n\n<pre><code>class MyClass\n  def call\n    puts \"Call\"\n  end\n  def method_missing(m,*args,&amp;block)\n    puts \"#{m}(#{args.inspect})\"\n  end\nend\nie.document.setVar(\"obj\",MyClass.new)\n</code></pre>\n\n<p>and JavaScript:</p>\n\n<pre><code>for(var i=0;i&lt;24;i++){\n  document.obj[chars[i]]()\n}\n</code></pre>\n\n<p>This will execute every function of obj named with an alphabetical character. And indeed, it does do this for the most part, however sometimes it does not. Sometimes it will call the main <code>call</code> method, and in the case of <code>document.obj.j()</code> it will do nothing at all...</p>\n\n<p>Full log:</p>\n\n<pre><code>a([])\nb([])\nc([])\nd([])\ne([])\nf([])\nHello world\nh([])\ni([])\nk([])\nHello world\nm([])\nn([])\no([])\nq([])\ns([])\nt([])\nHello world\nv([])\nw([])\nx([])\ny([])\nHello world\n</code></pre>\n\n<hr>\n\n<p><strong>EDIT</strong></p>\n\n<p><a href=\"https://gist.github.com/sancarn/a6bbfddffe8b86439dbe15a5d471f0b4\" rel=\"nofollow noreferrer\">I've written a GIST</a> which makes this generally much easier to achieve. E.G. To pass the <code>File</code> object to IE you can do the following:</p>\n\n<pre><code>ie.document.setVar(\"RubyFile\",WIN32OLE::getDispatch(File))\n</code></pre>\n"}], "owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 51005382, "answer_count": 1, "score": 1, "last_activity_date": 1530092247, "creation_date": 1529429336, "last_edit_date": 1529485101, "question_id": 50933928, "link": "https://stackoverflow.com/questions/50933928/win32ole-inject-ruby-function-into-internet-explorers-javascript", "title": "WIN32OLE - Inject Ruby function into Internet Explorer&#39;s JavaScript", "body": "<p>In AHK, the following code can be used to inject a AHK function into Internet Explorer's JavaScript engine:</p>\n\n<pre><code>#Persistent\n\nhtml =\n(\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;script&gt;\n      document.setVar = function`(name,val`){\n        document[name]=val;\n      }\n    &lt;/script&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;h1&gt;Hello!&lt;/h1&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n)\n\nie := ComObjCreate(\"InternetExplorer.Application\")\nie.navigate(\"about:blank\")\nsleep, 2000\n\n\nmsgbox, %html%\nie.document.writeln(html)\nie.visible := true\nie.document.setVar(\"someFunc\",Func(\"someFunc\"))\n\n\nsomeFunc(){\n  msgbox, \"hello\"\n}\n</code></pre>\n\n<p>After injecting the function, JavaScript can call <code>document.someFunc()</code>, which will result in JavaScript calling the AHK function, and ultimately running a message box.</p>\n\n<p>I want to port this code to Ruby. So far I have this:</p>\n\n<pre><code>require 'win32ole'\nie = WIN32OLE.new('InternetExplorer.Application')\nie.navigate(\"about:blank\")\nsleep(0.1) until !ie.busy\nhtml = &lt;&lt;Heredoc\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;script&gt;\n      document.setVar = function(name,val){\n        document[name]=val;\n      }\n    &lt;/script&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;h1&gt;Hello!&lt;/h1&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\nHeredoc\n\nie.document.writeln(html)\nie.visible = true\n</code></pre>\n\n<p>Now that we are here we should be able to inject the Ruby method, however currently I have no idea how to implement this. Every time I try something, the JavaScript engine freezes. Some of the things I have tried:</p>\n\n<pre><code>ie.document.setVar(\"someFunc\",method(:someFunc))\n#----------------------------------\nie.document.setVar(\"someFunc\",-&gt;{puts \"hello\"})\n#----------------------------------\nclass someClass\n  def someFunc\n    puts \"hello\"\n  end\nend\nie.document.setVar(\"someClass\",someClass})\n#----------------------------------\nclosure = Class.new(Fiddle::Closure) {\n  def call\n    puts \"hello world\"\n  end\n}.new(Fiddle::TYPE_INT,[])\nsomeFunc = Fiddle::Function.new(closure, [], Fiddle::TYPE_INT)\n#Both:\ndoc.setVar(\"someFunc\",closure)\n#and\ndoc.setVar(\"someFunc\",someFunc)\n#----------------------------------\n</code></pre>\n\n<p>None of the above methods work. In the end they all end up freezing the JavaScript engine... Does anyone have any idea how I can pass an actual reference to the Ruby function to JavaScript?</p>\n"}, {"tags": ["html", "css", "ruby", "nokogiri"], "answers": [{"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 1, "last_activity_date": 1529429586, "creation_date": 1529429586, "answer_id": 50934001, "question_id": 50933890, "link": "https://stackoverflow.com/questions/50933890/how-to-scrape-only-active-div/50934001#50934001", "title": "How to scrape only active div", "body": "<p>Try <code>.css('.period .full_time:not(.hidden)')</code></p>\n\n<p>see the <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/:not\" rel=\"nofollow noreferrer\">:not operator</a></p>\n"}], "owner": {"reputation": 646, "user_id": 8919469, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f51a8277c113b7415c6b2bbd82be9615?s=128&d=identicon&r=PG&f=1", "display_name": "johan", "link": "https://stackoverflow.com/users/8919469/johan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 50934001, "answer_count": 1, "score": 0, "last_activity_date": 1529429599, "creation_date": 1529429177, "last_edit_date": 1529429599, "question_id": 50933890, "link": "https://stackoverflow.com/questions/50933890/how-to-scrape-only-active-div", "title": "How to scrape only active div", "body": "<p>I am trying to scrape a page and I want to get the divs that are not hidden... I am using nokogiri for scraping. </p>\n\n<pre><code>status = doc.css('.fi-mu__m').map {|status| status.css('.fi-mu__score-info').css('.fi-s__status--abbr').css('.period .full_time').map(&amp;:text)}\n</code></pre>\n\n<p>I need something else instead of <code>.period</code> and <code>.full_time</code></p>\n\n<p>Here is copy of the part of the DOM:</p>\n\n<pre><code>&lt;div class=\"fi-s__status--abbr\"&gt;\n\n      &lt;span class=\"period cancelled hidden\"&gt;\n\n    Annul\u00e9\n      &lt;/span&gt;\n      &lt;span class=\"period lineups hidden\"&gt;\n\n    Comp.\n      &lt;/span&gt;\n      &lt;span class=\"period half_time hidden\"&gt;\n\n    MT\n      &lt;/span&gt;\n      &lt;span class=\"period extra_time hidden\"&gt;\n\n    Fin 2\u00e8me MT\n      &lt;/span&gt;\n      &lt;span class=\"period extra_half_time hidden\"&gt;\n\n    End 1H ET\n      &lt;/span&gt;\n      &lt;span class=\"period penalty_shootout hidden\"&gt;\n\n    TAB\n      &lt;/span&gt;\n      &lt;span class=\"period full_time\"&gt;\n\n    Fin\n      &lt;/span&gt;\n      &lt;span class=\"period post_match  hidden\"&gt;\n\n    Fin\n      &lt;/span&gt;\n      &lt;span class=\"period minute hidden\"&gt;0'&lt;/span&gt;\n\n            &lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ruby", "linux", "file", "unix"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1529430783, "post_id": 50933451, "comment_id": 88867119, "body": "In the future, please try not to use screenshots. For the directory printout you can use the <a href=\"https://en.wikipedia.org/wiki/Tree_(Unix)\" rel=\"nofollow noreferrer\">tree</a> program to get something you can copy-and-paste, and for the error you can just copy and paste."}], "answers": [{"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 2, "last_activity_date": 1529430527, "last_edit_date": 1529430527, "creation_date": 1529430127, "answer_id": 50934141, "question_id": 50933451, "link": "https://stackoverflow.com/questions/50933451/how-to-get-filepath-to-file-in-another-folder-unix/50934141#50934141", "title": "How to get filepath to file in another folder unix?", "body": "<p>Give the path relative to the working directory, not the file that you call <code>File.write</code> from. The working directory is the place you've navigated to through <code>cd</code> before calling the ruby code. If you ran <code>rspec</code> from the root of your project, then the working directory will also be the root. So, in this case, it looks like it would be <code>./spec/csv_fixtures/loans.csv</code>. You can run <code>puts Dir.pwd</code> to see the working directory that all paths should be relative to.</p>\n\n<p>If you wanted to something more like <code>require_relative</code>, you have to use some sort of workaround to turn it into an absolute path, such as <code>File.dirname(__FILE__)</code> which gives the absolute path of the folder containing the current file:</p>\n\n<pre><code>path = File.join(File.dirname(__FILE__, \"../csv_fixtures/loans.csv\"))\n</code></pre>\n"}], "owner": {"reputation": 705, "user_id": 5327403, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c293099c7e61e9c0396c0ca2d2e983f6?s=128&d=identicon&r=PG&f=1", "display_name": "FrankTheTank", "link": "https://stackoverflow.com/users/5327403/frankthetank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 1, "accepted_answer_id": 50934141, "answer_count": 1, "score": -1, "last_activity_date": 1529430527, "creation_date": 1529427422, "question_id": 50933451, "link": "https://stackoverflow.com/questions/50933451/how-to-get-filepath-to-file-in-another-folder-unix", "title": "How to get filepath to file in another folder unix?", "body": "<p>I am trying to write some data in one Ruby file to a file in another folder but I am having trouble identifying the path to get to the file I want to write to. </p>\n\n<p>My current code is: </p>\n\n<pre><code>File.write('../csv_fixtures/loans.csv', 'test worked!')\n</code></pre>\n\n<p>And my folder structure is as follows: \n<a href=\"https://i.stack.imgur.com/jXijh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jXijh.png\" alt=\"enter image description here\"></a></p>\n\n<p>Where I am trying to run my code in 'run_spec.rb' and write to 'loans.csv'. </p>\n\n<p>Additionally, this is the error I am getting: \n<a href=\"https://i.stack.imgur.com/Gxufe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Gxufe.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby", "file"], "comments": [{"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1529436247, "post_id": 50933356, "comment_id": 88869740, "body": "Is that the literal error you get? ENOENT usually means a file or directory doesn&#39;t exist, for example if you try to create <code>foo&#47;bar</code> when <code>foo</code> doesn&#39;t exist."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 2, "creation_date": 1529436251, "post_id": 50933356, "comment_id": 88869742, "body": "I suggest you maybe can post a piece of code that people can run, it&#39;s easier to get help. Even if somebody can find any bug just by reading."}, {"owner": {"reputation": 1, "user_id": 9963157, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1sKMtdtojmw/AAAAAAAAAAI/AAAAAAAAAHs/JUZPZf8NntQ/photo.jpg?sz=128", "display_name": "Leo", "link": "https://stackoverflow.com/users/9963157/leo"}, "edited": false, "score": 0, "creation_date": 1529546763, "post_id": 50933356, "comment_id": 88915916, "body": "iGian -  The section of code is the actual piece of code.  I&#39;ve added the values for the &quot;record&quot; array to make it easier for people to run the code, simply because this section of code is part of 100+ lines of code. It was already narrowed down the datatype for the &quot;log&quot; variable.  Somehow when we are using matchData it&#39;s no longer a string.  I&#39;ve attempted to convert the datatype back to a string using .to_s , but it still did not do the trick."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9963157, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1sKMtdtojmw/AAAAAAAAAAI/AAAAAAAAAHs/JUZPZf8NntQ/photo.jpg?sz=128", "display_name": "Leo", "link": "https://stackoverflow.com/users/9963157/leo"}, "edited": false, "score": 0, "creation_date": 1529547069, "post_id": 50937095, "comment_id": 88915968, "body": "Keith, Thanks for the suggestion.  Unfortunately the air-gapped system doesn&#39;t support File.write.   undefined method &#39;write&#39; for File:Class"}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "reply_to_user": {"reputation": 1, "user_id": 9963157, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1sKMtdtojmw/AAAAAAAAAAI/AAAAAAAAAHs/JUZPZf8NntQ/photo.jpg?sz=128", "display_name": "Leo", "link": "https://stackoverflow.com/users/9963157/leo"}, "edited": false, "score": 0, "creation_date": 1529552714, "post_id": 50937095, "comment_id": 88917048, "body": "File.write has been part of the standard distribution of Ruby for many, many years. Is your Ruby system modified, and, if so, by whom, and it what way? I don&#39;t think it even makes sense to remove <code>File.write</code> for security reasons because the same thing can be accomplished in other ways. Are you modifying the File class yourself?"}, {"owner": {"reputation": 1, "user_id": 9963157, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1sKMtdtojmw/AAAAAAAAAAI/AAAAAAAAAHs/JUZPZf8NntQ/photo.jpg?sz=128", "display_name": "Leo", "link": "https://stackoverflow.com/users/9963157/leo"}, "edited": false, "score": 0, "creation_date": 1529595352, "post_id": 50937095, "comment_id": 88941240, "body": "great questions.  I&#39;m not sure if the system was modified nor whom built the system.  I just inherited all ruby tasks because of my perl background. I can tell you that the &quot;log&quot; is not a string datatype.  The matchdata is doing some sort of voodoo that I can&#39;t even convert back to a string using the .to_s method."}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "reply_to_user": {"reputation": 1, "user_id": 9963157, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1sKMtdtojmw/AAAAAAAAAAI/AAAAAAAAAHs/JUZPZf8NntQ/photo.jpg?sz=128", "display_name": "Leo", "link": "https://stackoverflow.com/users/9963157/leo"}, "edited": false, "score": 0, "creation_date": 1529597736, "post_id": 50937095, "comment_id": 88942688, "body": "I suggest reinstalling Ruby. I like <code>rvm</code>, it makes doing so very easy, and you can do it in your user space so that superuser access is not required. Google <code>install rvm</code> for easy instructions."}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "reply_to_user": {"reputation": 1, "user_id": 9963157, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1sKMtdtojmw/AAAAAAAAAAI/AAAAAAAAAHs/JUZPZf8NntQ/photo.jpg?sz=128", "display_name": "Leo", "link": "https://stackoverflow.com/users/9963157/leo"}, "edited": false, "score": 0, "creation_date": 1529598192, "post_id": 50937095, "comment_id": 88942943, "body": "Regarding the data types of <code>log</code> and <code>matchdata</code>, I think your confusion is due to the fact that you may not be aware that when you use string interpolation (<code>#{}</code>) in a double quoted string, Ruby calls <code>to_s</code> on the value of the expression. So matchdata never <i>was</i> a string; Ruby was calling <code>to_s</code> on it. In fact, there are cases where there is more than one match, so <code>to_s</code> will not work for that; instead there&#39;s the <code>[]</code> operator (method really) (see <a href=\"https://ruby-doc.org/core-2.2.0/MatchData.html#method-i-5B-5D\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.2.0/MatchData.html#method-i-5B-5D</a>)."}], "tags": [], "owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "is_accepted": false, "score": 1, "last_activity_date": 1529532275, "last_edit_date": 1529532275, "creation_date": 1529443170, "answer_id": 50937095, "question_id": 50933356, "link": "https://stackoverflow.com/questions/50933356/ruby-file-open-odd-behavior-with-variable-as-name-of-file/50937095#50937095", "title": "Ruby: File.open odd behavior with variable as name of file", "body": "<p>I'm pretty sure you're not giving sufficient information to solve the problem, but in these cases I find that it's often helpful to simplify the code; doing so often reveals other issues.</p>\n\n<p>Is there a reason you're using the File <code>open</code>, <code>puts</code>, and <code>close</code>? This adds a lot of complexity which I think is unnecessary, and that complexity may be masking some other problem. I recommend changing this:</p>\n\n<pre><code>rawdata = ssh.exec!(@cmd) \nlogfile = File.new(\"#{system}_#{log}\", 'w+')\nlogfile.puts rawdata\nlogfile.close\n</code></pre>\n\n<p>to something like this:</p>\n\n<pre><code>File.write(\"#{system}_#{log}\", ssh.exec!(@cmd))\n</code></pre>\n\n<p>and see if the result changes or if it reveals a different problem.</p>\n"}], "owner": {"reputation": 1, "user_id": 9963157, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1sKMtdtojmw/AAAAAAAAAAI/AAAAAAAAAHs/JUZPZf8NntQ/photo.jpg?sz=128", "display_name": "Leo", "link": "https://stackoverflow.com/users/9963157/leo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529546452, "creation_date": 1529427021, "last_edit_date": 1529546452, "question_id": 50933356, "link": "https://stackoverflow.com/questions/50933356/ruby-file-open-odd-behavior-with-variable-as-name-of-file", "title": "Ruby: File.open odd behavior with variable as name of file", "body": "<p>Ruby Noob Here!\nI'm trying to create and write to files in ruby using variables as the name of the files to be created.  If I use a type the file name it work same with another variable #{system}, but the issue appears to be with a specific variable that is parsed early on.\nError received- Errno::ENOENT: No such file or directory</p>\n\n<pre><code>array#record contains: \nSun /log/schedule.log.20180617\nMon /log/schedule.log.20180618  \nTue /log/schedule.log.20180619\nWed /log/schedule.log.20180620\nWed /log/schedule.log\n</code></pre>\n\n<p>Section of code.</p>\n\n<pre><code>lines = record.split(\"\\n\")\nlines.each do |line|\n    log = /(\\/.*schedule.log(?:\\.20[0-9]{6})?)/.match(line)\n    @cmd = \"grep DEBUG #{log} | grep \\\"start\\\\|running\\\"\"\n    rawdata = ssh.exec!(@cmd) \n    logfile = File.new(\"#{system}_#{log}\", 'w+')\n       logfile.puts rawdata\n    logfile.close\nend\nssh.close  \n</code></pre>\n\n<p>OUTPUT\nError received- Errno::ENOENT: No such file or directory - server1_schedule.log</p>\n\n<p>Desired output should create a handful of log files with the naming convention <code>&lt;persystem_schedule.log&lt;date&gt;&gt;</code>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4", "rubygems"], "comments": [{"owner": {"reputation": 714, "user_id": 2721332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f613d619067de58f480eb6304f0f390?s=128&d=identicon&r=PG&f=1", "display_name": "seethrough", "link": "https://stackoverflow.com/users/2721332/seethrough"}, "edited": false, "score": 1, "creation_date": 1529425225, "post_id": 50932829, "comment_id": 88864452, "body": "I would advise you to change your gmail password immediately because you have just exposed it to internet,if that is a real gmail box"}, {"owner": {"reputation": 938, "user_id": 5718794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ll2bM.jpg?s=128&g=1", "display_name": "Alex Dovzhanyn", "link": "https://stackoverflow.com/users/5718794/alex-dovzhanyn"}, "edited": false, "score": 2, "creation_date": 1529425295, "post_id": 50932829, "comment_id": 88864480, "body": "You&#39;re not going to get what you want this way. As a matter of fact, you wont get this at all from facebook. They don&#39;t respond at all with whether or not the email exists. If the email OR the password is invalid, they&#39;ll always respond with &quot;Email or password is invalid&quot;. Otherwise they would have a security risk on their hands"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1529426612, "post_id": 50932829, "comment_id": 88865075, "body": "You have not actually asked a question"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1529428700, "post_id": 50932829, "comment_id": 88866043, "body": "<a href=\"https://stackoverflow.com/posts/50932829/revisions\">Change your password immediately. It is still visible in the question revisions.</a>"}, {"owner": {"reputation": 1, "user_id": 9962999, "user_type": "registered", "profile_image": "https://graph.facebook.com/1994750584172045/picture?type=large", "display_name": "Chahine Mansouri", "link": "https://stackoverflow.com/users/9962999/chahine-mansouri"}, "edited": false, "score": 0, "creation_date": 1529430806, "post_id": 50932829, "comment_id": 88867129, "body": "guys they are random password and email they does not exist"}, {"owner": {"reputation": 1, "user_id": 9962999, "user_type": "registered", "profile_image": "https://graph.facebook.com/1994750584172045/picture?type=large", "display_name": "Chahine Mansouri", "link": "https://stackoverflow.com/users/9962999/chahine-mansouri"}, "edited": false, "score": 0, "creation_date": 1529431218, "post_id": 50932829, "comment_id": 88867333, "body": "well any suggestion to do it ?? not for facebook because i put it as an example  but on other websites just to verify if the email exist in the database or no"}, {"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 1, "creation_date": 1529435638, "post_id": 50932829, "comment_id": 88869495, "body": "What&#39;s wrong with getting a subpoena from a judge and sending that to the website operator? Seems a lot easier IMHO."}], "answers": [{"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 1, "last_activity_date": 1529486021, "last_edit_date": 1529486021, "creation_date": 1529485468, "answer_id": 50944322, "question_id": 50932829, "link": "https://stackoverflow.com/questions/50932829/verify-if-an-email-exists-in-database-of-the-website/50944322#50944322", "title": "Verify if an email exists in database of the website", "body": "<blockquote>\n  <p>Not for facebook because I put it as an example but on other websites just to verify if the email exist in the database</p>\n</blockquote>\n\n<p>This is not always possible. You can only achieve this on a case-by-case basis for a given website. There are several different approaches you could try (as discussed below). You may also find that the website tries to rate limit/block your requests, depending on what you're doing -- for example, by adding a <strong>captcha</strong>, which (in theory) must require human intervention to pass.</p>\n\n<p>Some possible ways to determine whether an email exists in a website's database are:</p>\n\n<ul>\n<li>Try to log in (with a bad password), and see if the response (e.g. error message) indicates whether the email exists.</li>\n<li>Try to reset the password, and see if the response (e.g. information/error message) indicates whether the email exists.</li>\n<li>Try to log in several times (with a bad password), and see if anything indicates that the account has been/will soon be <em>locked</em>.</li>\n<li>Try to sign up a new account, and see if anything indicates \"this account already exists\"</li>\n<li>Try to \"add/contact/refer a friend\" from inside the website; see if this indicates whether that user has an account.</li>\n<li>... And so on.</li>\n</ul>\n\n<p>In general, there will always be a trade-off here between the website being user-friendly vs secure: On the one hand, giving helpful error messages like \"wrong password\" vs \"unknown email\" is helpful; whereas on the other hand it's insecure for the website to leak information.</p>\n\n<p>Hence why I began this answer by saying \"it's not always possible\". It depends how each website has been designed.</p>\n\n<p>For example, rails applications using <a href=\"https://github.com/plataformatec/devise\" rel=\"nofollow noreferrer\">Devise</a> for authentication will, by default, expose information in ways such as the above. But if you choose to set Devise's <code>config.paranoid = true</code>, then error messages become generic and won't leak this data.</p>\n\n<p>You could also try to figure this out by the response time: Sometimes, a (badly designed) website will <em>take longer to respond</em> with e.g. a failed login attempt or password reset request, if the email exists.</p>\n\n<p>For more information, see: <a href=\"https://www.owasp.org/index.php/Testing_for_User_Enumeration_and_Guessable_User_Account_(OWASP-AT-002)\" rel=\"nofollow noreferrer\">https://www.owasp.org/index.php/Testing_for_User_Enumeration_and_Guessable_User_Account_(OWASP-AT-002)</a></p>\n\n<hr>\n\n<p>I have provided the above information for educational purposes such as how to build a secure website; in general I would <em>not</em> advocate trying to \"expose\" data by any of the above methods, against a website you do not own.</p>\n\n<p>If you have a legal need to reveal all emails held by another company's website, I would strongly advise requesting access (through the legal system if necessary) rather than trying to leak it via security flaws!</p>\n"}], "owner": {"reputation": 1, "user_id": 9962999, "user_type": "registered", "profile_image": "https://graph.facebook.com/1994750584172045/picture?type=large", "display_name": "Chahine Mansouri", "link": "https://stackoverflow.com/users/9962999/chahine-mansouri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529491626, "creation_date": 1529424962, "last_edit_date": 1529491626, "question_id": 50932829, "link": "https://stackoverflow.com/questions/50932829/verify-if-an-email-exists-in-database-of-the-website", "title": "Verify if an email exists in database of the website", "body": "<p>I want to verify if the email I am using exists in a website.</p>\n\n<p>I tried posting the email with random password and then from the response, using a search method, I want to see if a string like \"email invalid\" is present.</p>\n\n<p>If it exists then it's invalid; if not then it's a valid email and so it exists in the database of the website.</p>\n\n<p>I tried this, for example, for <code>facebook.com</code> - but I'm looking for a generic method for other websites:</p>\n\n<pre><code>require 'net/http'\nrequire 'uri'\nrequire 'json'\n\nuri = URI.parse(\"https://www.facebook.com\")\nheader = {'Content-Type': 'text/json'}\nuser = {user: {\n               email: 'example@gmail.com',\n               password: \"some_password\"\n                  }\n        }\nhttp = Net::HTTP.new(uri.host, uri.port)\nhttp.use_ssl = true\nrequest = Net::HTTP::Post.new(uri.request_uri, header)\nrequest.body = user.to_json\nresponse = http.request(request)\nputs response\nputs request.body\nsource = Net::HTTP.get(uri)\nputs source\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1529424524, "post_id": 50932616, "comment_id": 88864087, "body": "What&#39;s the error you&#39;re getting?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1529424696, "post_id": 50932616, "comment_id": 88864177, "body": "So the problem is with <code>user_post_path</code>? What routes have you defined? (What&#39;s in the relevant portion of <code>config&#47;routes.rb</code>?) What routes does rails know about? (Run: <code>rake routes</code>, and look at the relevant parts.) Most likely, what you need to do is: <code>user_posts_path(user)</code> - but without knowing how you&#39;ve set up the application, I cannot say anything for certain."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1529424793, "post_id": 50932616, "comment_id": 88864222, "body": "Why is this tagged as <code>ruby-on-rails-3</code>, <code>ruby-on-rails-4</code> <i>and</i> <code>ruby-on-rails-5</code>? Which version are you actually using? Pick one."}, {"owner": {"reputation": 9, "user_id": 9783543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214091178226239/picture?type=large", "display_name": "Benjamin Richard", "link": "https://stackoverflow.com/users/9783543/benjamin-richard"}, "edited": false, "score": 0, "creation_date": 1529428736, "post_id": 50932616, "comment_id": 88866059, "body": "I have the error with user_post_path(user) : <i>No route matches {:action=&gt;&quot;show&quot;, :controller=&gt;&quot;post&quot;, :user_id=&gt;#}, missing required keys: [:id]</i>                                          I use Rails 5"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 9783543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214091178226239/picture?type=large", "display_name": "Benjamin Richard", "link": "https://stackoverflow.com/users/9783543/benjamin-richard"}, "edited": false, "score": 0, "creation_date": 1529428935, "post_id": 50932758, "comment_id": 88866187, "body": "Yes the users just have one post (I edit the post with the route)"}, {"owner": {"reputation": 56, "user_id": 2126059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b4515b940891245126f1192d29fa0a?s=128&d=identicon&r=PG", "display_name": "Kiran Kumawat", "link": "https://stackoverflow.com/users/2126059/kiran-kumawat"}, "reply_to_user": {"reputation": 9, "user_id": 9783543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214091178226239/picture?type=large", "display_name": "Benjamin Richard", "link": "https://stackoverflow.com/users/9783543/benjamin-richard"}, "edited": false, "score": 0, "creation_date": 1529929045, "post_id": 50932758, "comment_id": 89039005, "body": "@BenjaminRichard Can you please upvote. So I am able to post answer further."}], "tags": [], "owner": {"reputation": 56, "user_id": 2126059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b4515b940891245126f1192d29fa0a?s=128&d=identicon&r=PG", "display_name": "Kiran Kumawat", "link": "https://stackoverflow.com/users/2126059/kiran-kumawat"}, "is_accepted": false, "score": 0, "last_activity_date": 1529475483, "last_edit_date": 1529475483, "creation_date": 1529424695, "answer_id": 50932758, "question_id": 50932616, "link": "https://stackoverflow.com/questions/50932616/dont-find-how-to-link-to-user-post/50932758#50932758", "title": "Don&#39;t find how to link to user_post", "body": "<p>Is it a has_one relation between user and post.\nYou can make a nested route for the post like</p>\n\n<pre><code>resource :user do\n  resource :post, only: [:create]\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 9783543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214091178226239/picture?type=large", "display_name": "Benjamin Richard", "link": "https://stackoverflow.com/users/9783543/benjamin-richard"}, "edited": false, "score": 0, "creation_date": 1529429598, "post_id": 50933950, "comment_id": 88866529, "body": "A user have just one post, sorry my bad"}, {"owner": {"reputation": 9, "user_id": 9783543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214091178226239/picture?type=large", "display_name": "Benjamin Richard", "link": "https://stackoverflow.com/users/9783543/benjamin-richard"}, "edited": false, "score": 0, "creation_date": 1529430090, "post_id": 50933950, "comment_id": 88866766, "body": "It&#39;s working with belong_to instead of belongs_to in the post.rb and with user.post for the link_to. Thanks to all for your help"}, {"owner": {"reputation": 4769, "user_id": 9541423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f816e0659e0cf40bbe0ef7224a3a56a0?s=128&d=identicon&r=PG", "display_name": "Sovalina", "link": "https://stackoverflow.com/users/9541423/sovalina"}, "reply_to_user": {"reputation": 9, "user_id": 9783543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214091178226239/picture?type=large", "display_name": "Benjamin Richard", "link": "https://stackoverflow.com/users/9783543/benjamin-richard"}, "edited": false, "score": 0, "creation_date": 1529433290, "post_id": 50933950, "comment_id": 88868368, "body": "@BenjaminRichard <i>&quot;It&#39;s working with belong_to instead of belongs_to&quot;</i> are you sure about that ? <code>belong_to</code> without &quot;s&quot; doesn&#39;t exist in rails..."}, {"owner": {"reputation": 175, "user_id": 8455792, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10154620878171277/picture?type=large", "display_name": "Martin", "link": "https://stackoverflow.com/users/8455792/martin"}, "reply_to_user": {"reputation": 4769, "user_id": 9541423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f816e0659e0cf40bbe0ef7224a3a56a0?s=128&d=identicon&r=PG", "display_name": "Sovalina", "link": "https://stackoverflow.com/users/9541423/sovalina"}, "edited": false, "score": 0, "creation_date": 1529433569, "post_id": 50933950, "comment_id": 88868487, "body": "@sovalina when he posted that comment originally it said <code>belongs_in</code> so I think he&#39;s a touch confused."}], "tags": [], "owner": {"reputation": 175, "user_id": 8455792, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10154620878171277/picture?type=large", "display_name": "Martin", "link": "https://stackoverflow.com/users/8455792/martin"}, "is_accepted": false, "score": 0, "last_activity_date": 1529429419, "creation_date": 1529429419, "answer_id": 50933950, "question_id": 50932616, "link": "https://stackoverflow.com/questions/50932616/dont-find-how-to-link-to-user-post/50933950#50933950", "title": "Don&#39;t find how to link to user_post", "body": "<p>You said \"posts\" belong to \"user\", I assume that means you're using a <code>has_many</code> and <code>belongs_to</code>. If that is not the case, please note that plural vs singular matters. Given that, you'll need to pull the specific post from the <code>ActiveRecordRelation</code>. See the following:</p>\n\n<pre><code>&lt;% @users.each do |user| %&gt;\n  &lt;%= user.fname %&gt; \n  #etc\n  &lt;% user.posts.each do |post| %&gt;\n    &lt;%= link_to post.title, post %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This assumes you have set up in your routes <code>resources :users, :posts</code></p>\n"}], "owner": {"reputation": 9, "user_id": 9783543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214091178226239/picture?type=large", "display_name": "Benjamin Richard", "link": "https://stackoverflow.com/users/9783543/benjamin-richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1529475483, "creation_date": 1529424229, "last_edit_date": 1529429637, "question_id": 50932616, "link": "https://stackoverflow.com/questions/50932616/dont-find-how-to-link-to-user-post", "title": "Don&#39;t find how to link to user_post", "body": "<p>I'm new on rails, I work on a application. My user can create a post, post belong to user. On my index user I want to link_to the user_post for each user, I try a lot of solution, but nothing work...</p>\n\n<p>_list.html.erb :</p>\n\n<pre><code>&lt;div id=\"filterrific_results\"&gt;\n\n&lt;div&gt;\n  &lt;%= page_entries_info users %&gt;\n&lt;/div&gt;\n\n&lt;% @users.each do |user| %&gt;\n  &lt;% if user.coach? %&gt;\n    &lt;h1&gt;&lt;%= user.fname %&gt; &lt;%= user.lname %&gt;&lt;/h1&gt;\n    &lt;h2&gt;&lt;%= user.mother_tongue %&gt;&lt;/h2&gt;\n      &lt;center&gt;\n        &lt;p&gt;&lt;%= user.postal_code %&gt; &lt;%= user.locality %&gt;&lt;/p&gt;\n\n        &lt;p&gt;&lt;%= link_to \"En savoir plus\", **user_post_path** %&gt;&lt;/p&gt;\n      &lt;/center&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n&lt;/div&gt;\n\n\n&lt;%= will_paginate users %&gt;\n</code></pre>\n\n<blockquote>\n  <p>Edit : The routes :</p>\n</blockquote>\n\n<pre><code>  resources :users do\n    resources :post\n  end\n</code></pre>\n"}, {"tags": ["ruby", "rubocop"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1529422529, "post_id": 50931840, "comment_id": 88863037, "body": "You would be fine with that method if Rubocop wouldn&#39;t complain?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1529423560, "post_id": 50931840, "comment_id": 88863590, "body": "Depending on what <code>abc</code>, <code>a1</code>, <code>a2</code>, <code>some_method_call_1</code>, etc actually are, I bet you can probably write this cleaner and fix rubocop violations at the same time! You should view warnings like that as a canary, i.e. as an indicator that there&#39;s probably a slightly deeper design issue you could fix."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1529423659, "post_id": 50931840, "comment_id": 88863632, "body": "For example I would hazard a guess that <code>some_method_call_1</code> actually takes a parameter: <code>a2</code>, and that you could implement the method as: <code>def some_method_call_1(a2); return if a2 == &#39;name&#39;; rest_of_method; end</code>"}, {"owner": {"reputation": 25560, "user_id": 14253, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/235c58ad566abb4c7979bc7033e9882c?s=128&d=identicon&r=PG", "display_name": "DGM", "link": "https://stackoverflow.com/users/14253/dgm"}, "edited": false, "score": 0, "creation_date": 1529423730, "post_id": 50931840, "comment_id": 88863672, "body": "I personally do not like <code>unless</code> .. it causes too many headaches.   I&#39;m toying with something like:   <code>a2.eql?(&#39;name&#39;) || some_method_call</code>  ... it lazy evaluates the method only if needed."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 25560, "user_id": 14253, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/235c58ad566abb4c7979bc7033e9882c?s=128&d=identicon&r=PG", "display_name": "DGM", "link": "https://stackoverflow.com/users/14253/dgm"}, "edited": false, "score": 0, "creation_date": 1529424270, "post_id": 50931840, "comment_id": 88863951, "body": "@DGM that reeks of control flow not sure logical conditional <code>||</code> makes sense here maybe lower level <code>or</code> but I figure rubocop would complain about that too"}, {"owner": {"reputation": 25560, "user_id": 14253, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/235c58ad566abb4c7979bc7033e9882c?s=128&d=identicon&r=PG", "display_name": "DGM", "link": "https://stackoverflow.com/users/14253/dgm"}, "edited": false, "score": 0, "creation_date": 1529513681, "post_id": 50931840, "comment_id": 88904477, "body": "yeah, it&#39;s a bandaid on something that looks like a higher level problem.  &quot;or&quot;  would probably be more correct"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1529421931, "post_id": 50931920, "comment_id": 88862711, "body": "In other words, exactly as the offense message suggests :)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1529423347, "post_id": 50931920, "comment_id": 88863490, "body": "I think you meant <code>String#casecmp?</code> (with a question mark). <code>String#casecmp</code> is not the same thing as <code>downcase.eql?</code>. e.g. <code>&quot;AGE&quot;.casecmp(&#39;nope&#39;) #=&gt; -1</code>"}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": false, "score": 3, "last_activity_date": 1529423894, "last_edit_date": 1529423894, "creation_date": 1529421781, "answer_id": 50931920, "question_id": 50931840, "link": "https://stackoverflow.com/questions/50931840/use-a-guard-clause-instead-of-wrapping-the-code-inside-a-conditional-expression/50931920#50931920", "title": "Use a guard clause instead of wrapping the code inside a conditional expression", "body": "<pre><code>def foo\n  return some_method_call unless a1.is_a? Numeric\n  some_method_call_1 unless a2.eql? 'name'\n  some_method_call_2 unless a3.casecmp?('age')\n  some_method_call_3 unless a4 &lt; 200\nend\n</code></pre>\n\n<p>You could also replace the use of <code>downcase.eql?</code> for <a href=\"https://ruby-doc.org/core-2.4.0/String.html#method-i-casecmp-3F\" rel=\"nofollow noreferrer\"><code>String#casecmp?</code></a>.</p>\n\n<p>Note <code>String#casecmp?</code> is also available since Ruby 2.4.</p>\n"}, {"tags": [], "owner": {"reputation": 7051, "user_id": 848668, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/JQcC4.jpg?s=128&g=1", "display_name": "br3nt", "link": "https://stackoverflow.com/users/848668/br3nt"}, "is_accepted": false, "score": 0, "last_activity_date": 1529456558, "last_edit_date": 1529456558, "creation_date": 1529456162, "answer_id": 50938764, "question_id": 50931840, "link": "https://stackoverflow.com/questions/50931840/use-a-guard-clause-instead-of-wrapping-the-code-inside-a-conditional-expression/50938764#50938764", "title": "Use a guard clause instead of wrapping the code inside a conditional expression", "body": "<p>I'm making an assumption that the guard conditions will always apply to particular methods being called.</p>\n\n<p>If that is the case, you can extract the guard conditions out into the specific methods being called and explicitly pass in the variable being checked.</p>\n\n<p>Granted, this is more verbose, but I would argue that it makes all the methods more usable, subclassable, overridable, etc.  You get more control over the functionality of your method. And it's easier to read.</p>\n\n<pre><code>def abc(a1, a2, a3, a4)\n  if a1.is_a?(Numeric)\n    do_something_with_values(a2, a3, a4)\n  else\n    some_method_call\n  end\nend\n\ndef do_something_with_values(a1, a2, a3)\n  some_method_call_1(a1)\n  some_method_call_2(a2)\n  some_method_call_3(a3)\nend\n\ndef some_method_call_1(a)\n  return if a.eql?('name')\n  # some functionality\nend\n\ndef some_method_call_2(a)\n  return if a.downcase.eql?('age')\n  # some functionality\nend\n\ndef some_method_call_3(a)\n  return if a &lt; 200\n  # some functionality\nend\n</code></pre>\n\n<p><strong>Edit:</strong></p>\n\n<p>Comparing my code to the <em>good</em> examples in the <a href=\"https://www.rubydoc.info/gems/rubocop/RuboCop/Cop/Style/GuardClause\" rel=\"nofollow noreferrer\">RuboCop GuardClause docs</a>, they seem to match in style.\nI'm not entirely clear if my rewrite of <code>abc</code> matches the RuboCop style, but I can't think of any reason why it would be considered bad.</p>\n"}, {"tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": false, "score": 0, "last_activity_date": 1529475557, "creation_date": 1529475557, "answer_id": 50941473, "question_id": 50931840, "link": "https://stackoverflow.com/questions/50931840/use-a-guard-clause-instead-of-wrapping-the-code-inside-a-conditional-expression/50941473#50941473", "title": "Use a guard clause instead of wrapping the code inside a conditional expression", "body": "<p>I think what Rubocop wants here is something like:</p>\n\n<pre><code>def abc(a1, a2, a3, a4)\n  return some_method_call unless a1.is_a? Numeric\n  unless a2.eql? 'name'\n    some_method_call_1\n  end\n  unless a3.downcase.eql? 'age'\n    some_method_call_2\n  end\n  return unless a4 &lt; 200\n  some_method_call_3\nend\n</code></pre>\n\n<p>This is because the last method is only called when the <code>a4 &lt; 200</code> condition is met. So it thinks you could just as well exit early.</p>\n\n<p>Rubocop does not complain about this:</p>\n\n<pre><code>def abc(a1, a2, a3, a4)\n  return some_method_call unless a1.is_a? Numeric\n  some_method_call_1 unless a2.eql? 'name'\n  some_method_call_2 unless a3.casecmp('age').zero?\n  some_method_call_3 unless a4 &lt; 200\nend\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9962703, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YxdSvZBBqfQ/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1eKLuAfkANuWsI2r_Rg1MT7zwYBA/mo/photo.jpg?sz=128", "display_name": "rav pdp", "link": "https://stackoverflow.com/users/9962703/rav-pdp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1611, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1529475557, "creation_date": 1529421520, "last_edit_date": 1529421608, "question_id": 50931840, "link": "https://stackoverflow.com/questions/50931840/use-a-guard-clause-instead-of-wrapping-the-code-inside-a-conditional-expression", "title": "Use a guard clause instead of wrapping the code inside a conditional expression", "body": "<p>What is the best way to re-write the below code, in a way where rubocop doesn't treat it as a Style/GuardClause offense</p>\n\n<pre><code>    def abc(a1, a2, a3, a4)\n      return some_method_call unless a1.is_a? Numeric\n      unless a2.eql? 'name'\n        some_method_call_1\n      end\n      unless a3.downcase.eql? 'age'\n        some_method_call_2\n      end\n      unless a4 &lt; 200\n        some_method_call_3\n      end\n    end\n</code></pre>\n"}, {"tags": ["ruby", "cucumber", "capybara"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4606308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d01c458130e5560464b42f6a2bfc5dc?s=128&d=identicon&r=PG&f=1", "display_name": "Suley Mahmoud", "link": "https://stackoverflow.com/users/4606308/suley-mahmoud"}, "edited": false, "score": 0, "creation_date": 1529422378, "post_id": 50931268, "comment_id": 88862955, "body": "Thanks Thomas, behaves exactly as I wanted"}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 1, "last_activity_date": 1529419718, "creation_date": 1529419718, "answer_id": 50931268, "question_id": 50930701, "link": "https://stackoverflow.com/questions/50930701/dont-run-a-cucumber-feature-if-a-element-on-the-page-is-not-available-but-exit/50931268#50931268", "title": "Don&#39;t run a cucumber feature if a element on the page is not available but exit without failing", "body": "<p>You shouldn't be using <code>find</code> if you want to make a decision based on existence. Instead you should be using the predicate methods provided by Capybara (has_selector?, has_css?, has_xpath?, etc) so you don't have to rescue exceptions. </p>\n\n<p>The other thing to know is the Cucumber <code>skip_this_sceanrio</code> method, which means you should end up with something like</p>\n\n<pre><code>Before('@event') do\n  # visit '/some_page'   # May not be needed if you have another `Before` already visiting the needed page\n  skip_this_scenario('Skipping due to missing event') unless page.has_css?('.event')\nend\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4606308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d01c458130e5560464b42f6a2bfc5dc?s=128&d=identicon&r=PG&f=1", "display_name": "Suley Mahmoud", "link": "https://stackoverflow.com/users/4606308/suley-mahmoud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 50931268, "answer_count": 1, "score": 0, "last_activity_date": 1529419718, "creation_date": 1529417987, "question_id": 50930701, "link": "https://stackoverflow.com/questions/50930701/dont-run-a-cucumber-feature-if-a-element-on-the-page-is-not-available-but-exit", "title": "Don&#39;t run a cucumber feature if a element on the page is not available but exit without failing", "body": "<p>I want to check a page for an element before I start running the feature file for it (It's an element that periodically appears with an event so I only want to run the feature if its present). </p>\n\n<p>The approach I wanted to use was a tagged before hook to see if the element was present and if it wasn't just don't run the feature but exit without 'failing' the step just exit with a message. I tried variants on the below but \n1. If I don't have a rescue clause it obviously fails the scenario when the element isn't present\n2. If I do have the rescue clause it handles it and passes moving onto the features which will then fail as the event isn't available.</p>\n\n<p>Is there a way to halt running the feature file if the rescue clause is invoked without the 'fail'?</p>\n\n<p><code>Before('@event') do\n  begin\n    find('.event').visible?\n rescue Capybara::ElementNotFound\n    puts 'THE EVENT IS NOT ON'\n  end\nend</code></p>\n"}, {"tags": ["ruby", "windows", "environment-variables", "chef-infra", "chef-recipe"], "comments": [{"owner": {"reputation": 3665, "user_id": 9797143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/173377baee1db5827d6a9be47a5c082c?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon Miller", "link": "https://stackoverflow.com/users/9797143/brandon-miller"}, "edited": false, "score": 1, "creation_date": 1529417925, "post_id": 50930296, "comment_id": 88860230, "body": "Try this answer <a href=\"https://stackoverflow.com/questions/22945786/access-the-registry-of-another-user-with-chef/28224034#28224034\" title=\"access the registry of another user with chef\">stackoverflow.com/questions/22945786/&hellip;</a>"}, {"owner": {"reputation": 103, "user_id": 6328131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0823533c1f487062bdfbec5f58785863?s=128&d=identicon&r=PG&f=1", "display_name": "DanOpi", "link": "https://stackoverflow.com/users/6328131/danopi"}, "reply_to_user": {"reputation": 3665, "user_id": 9797143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/173377baee1db5827d6a9be47a5c082c?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon Miller", "link": "https://stackoverflow.com/users/9797143/brandon-miller"}, "edited": false, "score": 0, "creation_date": 1529418613, "post_id": 50930296, "comment_id": 88860663, "body": "I found that right after posting this.  He still has a hard coded/plain text password in his first <code>windows_task</code>.  I know the users will exist on the machine however they may not be loaded into the hive (Not listed under HKEY_Users).  I could load the corresponding hive for each of them and then unload it but not sure how to do this with Ruby."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 6328131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0823533c1f487062bdfbec5f58785863?s=128&d=identicon&r=PG&f=1", "display_name": "DanOpi", "link": "https://stackoverflow.com/users/6328131/danopi"}, "edited": false, "score": 0, "creation_date": 1529500465, "post_id": 50933625, "comment_id": 88895791, "body": "These env vars will be used by a service that is running under that same User Account.  So that service should just need to be restarted, correct?  Thank you for the information.  Will be back after testing it out."}], "tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": false, "score": 1, "last_activity_date": 1529428133, "creation_date": 1529428133, "answer_id": 50933625, "question_id": 50930296, "link": "https://stackoverflow.com/questions/50930296/use-chef-to-set-environment-variables-for-different-windows-users/50933625#50933625", "title": "Use Chef to Set Environment Variables for different Windows Users", "body": "<p>You can indeed do this with <code>windows_env</code>, though it isn't reflected in the documentation yet: <a href=\"https://github.com/chef/chef/blob/master/lib/chef/resource/windows_env.rb#L39\" rel=\"nofollow noreferrer\">https://github.com/chef/chef/blob/master/lib/chef/resource/windows_env.rb#L39</a></p>\n\n<pre><code>windows_env 'DUMMYENV' do\n  value 'THISISDUMMY'\n  user 'UserA'\nend\n</code></pre>\n\n<p>Remember that if you're talking about scheduled tasks using env vars, you have to reboot before it will be visible.</p>\n"}], "owner": {"reputation": 103, "user_id": 6328131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0823533c1f487062bdfbec5f58785863?s=128&d=identicon&r=PG&f=1", "display_name": "DanOpi", "link": "https://stackoverflow.com/users/6328131/danopi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1529428133, "creation_date": 1529416698, "question_id": 50930296, "link": "https://stackoverflow.com/questions/50930296/use-chef-to-set-environment-variables-for-different-windows-users", "title": "Use Chef to Set Environment Variables for different Windows Users", "body": "<p>How can I use Use Chef to set Environment Variables for different Windows Users?</p>\n\n<p>I've tried using the <code>Execute</code> block like so:</p>\n\n<pre><code>execute 'setx DUMMYENV' do\n    command 'setx DUMMYENV \"THISISDUMMY\"'\n    user \"UserA\"\nend\n</code></pre>\n\n<p>However this requires a password and I don't want the password in plaintext in any of the recipes so this solution doesn't seem viable.</p>\n\n<p>I've also thought about doing something with <code>registry_key</code> like so:</p>\n\n<pre><code>registry_key 'HKEY_USERS\\S-1-5-21-0123456789-012345678-...\\Environment' do\n   values [{name: 'DUMMYENV', type: :string, data: '1'},\n           {name: 'ENVTEST', type: :string, data: 'TESTING'}\n          ]\n    action :create\nend\n</code></pre>\n\n<p>The only problem I have with this is I'm not sure if the SID for each of the User accounts I'm trying to modify will change between machines.  I can probably find a solution to loop through the available HKEY_Users and parse out the ones I'm looking for however this seems tedious.</p>\n\n<p>Another option that I've started to look into is <code>windows_env</code> however I haven't gotten to test it much and I don't see a robust option to specify the user.</p>\n\n<p>End goal is to set different environment variables for different users with Chef running as admin.  Is there any easy way to do this with Chef?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1529415852, "post_id": 50929966, "comment_id": 88858807, "body": "I don&#39;t see where you close the block."}, {"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1529415894, "post_id": 50929966, "comment_id": 88858836, "body": "@SergioTulentsev Ah I accidentally left out that line in the question. Adding it in now."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1529416211, "post_id": 50929966, "comment_id": 88859059, "body": "This looks like something <code>link_to</code> does (and other helpers as well). You can get some ideas from its implementation: <a href=\"https://github.com/rails/rails/blob/ee21e058424b2cb55bf74981c28b1ac0fb98b576/actionview/lib/action_view/helpers/url_helper.rb#L196-L206\" rel=\"nofollow noreferrer\">github.com/rails/rails/blob/&hellip;</a>"}, {"owner": {"reputation": 1918, "user_id": 9224452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb0f303869bf090269cbcc46cef14991?s=128&d=identicon&r=PG&f=1", "display_name": "John Baker", "link": "https://stackoverflow.com/users/9224452/john-baker"}, "edited": false, "score": 0, "creation_date": 1529416783, "post_id": 50929966, "comment_id": 88859464, "body": "I would suggest you to use relative path <code>&#39;items&#47;form&#39;</code> instead of <code>&#39;&#47;items&#47;form&#39;</code> as the path that points to the partial."}], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 8545579, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cUMJBXDfYho/AAAAAAAAAAI/AAAAAAAAAB8/3FuvGX7JIGs/photo.jpg?sz=128", "display_name": "Mateo Ochoa", "link": "https://stackoverflow.com/users/8545579/mateo-ochoa"}, "is_accepted": true, "score": 0, "last_activity_date": 1529449160, "creation_date": 1529449160, "answer_id": 50938020, "question_id": 50929966, "link": "https://stackoverflow.com/questions/50929966/render-html-inside-block-ruby-on-rails/50938020#50938020", "title": "Render HTML inside block - Ruby on Rails", "body": "<p>Your first line should read <code>&lt;%= new_item_modal do |item, categories| %&gt;</code> and your <code>new_modal_item</code> method should have <code>block.call(@item, @categories)</code>. Make sure you rename the variables passed to the partial (for example, from <code>@item</code> to <code>item</code>).</p>\n"}], "owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 50938020, "answer_count": 1, "score": 0, "last_activity_date": 1529449160, "creation_date": 1529415710, "last_edit_date": 1529415911, "question_id": 50929966, "link": "https://stackoverflow.com/questions/50929966/render-html-inside-block-ruby-on-rails", "title": "Render HTML inside block - Ruby on Rails", "body": "<p>I'm trying to render a HTML with a partial inside of a block but the only thing that renders are the last 4 closing <code>&lt;/div&gt;</code> elements. </p>\n\n<p>Here is my code:</p>\n\n<pre><code>&lt;%= new_item_modal do |i| %&gt;\n&lt;div class=\"modal fade\" id=\"newItemModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"newItemModal\" aria-hidden=\"true\"&gt;\n  &lt;div class=\"modal-dialog\" role=\"document\"&gt;\n    &lt;div class=\"modal-content\"&gt;\n      &lt;div class=\"modal-header\"&gt;\n        &lt;h5 class=\"modal-title\"&gt;New Item&lt;/h5&gt;\n        &lt;button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"&gt;\n          &lt;span aria-hidden=\"true\"&gt;&amp;times;&lt;/span&gt;\n        &lt;/button&gt;\n      &lt;/div&gt;\n      &lt;div class=\"modal-body\" id=\"new-item\" style=\"overflow:scroll;height:500px;\"&gt;\n        &lt;%= render partial: \"/items/form\", locals: { remote: true, item: @item, categories: @categories }%&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>And my <code>new_item_modal</code> function:</p>\n\n<pre><code>def new_item_modal(&amp;block)\n   if current_location.present? &amp;&amp; can_access(\"create\", \"items\")\n      @item = Item.new\n      @categories = current_location.categories\n      block.call\n   end  \nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "search", "ransack"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1529427867, "post_id": 50929629, "comment_id": 88865644, "body": "I think you are looking for <code>matches_any</code> instead of  <code>cont</code> and then split the string on spaces. <a href=\"https://github.com/activerecord-hackery/ransack#search-matchers\" rel=\"nofollow noreferrer\">Ransack Matchers</a> however if you are looking for some form of scoring mechanism to determine best match then you are going to have to move on to something like <code>elasticsearch</code> or <code>thinking-sphinx</code>"}, {"owner": {"reputation": 391, "user_id": 9118625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/24c0b4ff94e144c7c384b51e1e632cce?s=128&d=identicon&r=PG&f=1", "display_name": "Hakeem Baba", "link": "https://stackoverflow.com/users/9118625/hakeem-baba"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1529481485, "post_id": 50929629, "comment_id": 88883673, "body": "the split method works, thanks"}], "owner": {"reputation": 391, "user_id": 9118625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/24c0b4ff94e144c7c384b51e1e632cce?s=128&d=identicon&r=PG&f=1", "display_name": "Hakeem Baba", "link": "https://stackoverflow.com/users/9118625/hakeem-baba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 256, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529414655, "creation_date": 1529414655, "question_id": 50929629, "link": "https://stackoverflow.com/questions/50929629/how-to-get-closest-match-of-keyword-search-ransack-rails", "title": "How to get closest match of keyword search ransack rails", "body": "<p>I am trying to get a closest match of a ransack keyword search in my rails app. In my search controller, i have </p>\n\n<pre><code>class SearchController &lt; ApplicationController\n  def index\n    q = params[:q]\n    @courses = current_academy.courses.search(title_cont: q).result\n    @teachers = current_academy.teachers.search(firstname_cont: q).result\n    @articles = current_academy.articles.current_locale.search(title_cont: q).result\n  end\nend\n</code></pre>\n\n<p>In my view, i have </p>\n\n<pre><code>&lt;form accept-charset=\"UTF-8\" method=\"post\" action=\"{{ request.url_helpers.search_path }}\"&gt;\n  &lt;label for=\"q\"&gt;Search for:&lt;/label&gt;\n  &lt;input id=\"mySearch\" name=\"q\" type=\"text\" value=\"\" /&gt;\n  &lt;input name=\"authenticity_token\" type=\"hidden\" value=\"\" /&gt;\n  &lt;input type=\"submit\" value=\"Search\" /&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>At the moment, assuming the title of a course is \"Digital Course\", a search query for \"digital\" finds the course. The problem is a search query like \"digital zzz\" would return nothing and hence not find the course.</p>\n\n<p>How do I make sure that search queries would return records with closest possible match using ransack. I have tried out other ransack predicates but cant get it to work. I would like to know the best way to do it.  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nginx", "faye"], "answers": [{"tags": [], "owner": {"reputation": 646, "user_id": 714985, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/IPkWk.gif?s=128&g=1", "display_name": "rfellons", "link": "https://stackoverflow.com/users/714985/rfellons"}, "is_accepted": false, "score": 2, "last_activity_date": 1531322519, "last_edit_date": 1592644375, "creation_date": 1531322519, "answer_id": 51289129, "question_id": 50929441, "link": "https://stackoverflow.com/questions/50929441/what-should-be-my-faye-url-value-for-rails-chat-application/51289129#51289129", "title": "What should be my FAYE_URL value for Rails chat application?", "body": "<p>I don't know Digital Ocean's servers.<br />\nI have worked with a Google Cloud Engine virtual machine with OS Ubuntu 14.04.</p>\n<p>Here's how I configured my pub/sub app that uses Faye with a dns resolver in HTTPS on Nginx web server with Passenger.</p>\n<h1>Faye Server</h1>\n<p>I set up the Faye server, as a Rack application, to start automatically at boot through the 'Thin' web server.</p>\n<p>Script to start/stop Thin with params: thin-configuration-file, faye-rackup-server-script.</p>\n<p><strong>/home/user/apps/myapp/config/thin.sh</strong></p>\n<pre><code>#!/bin/sh\nset -e\nTIMEOUT=${TIMEOUT-60}\nAPP_ROOT=/home/user/apps/myapp\nPID=$APP_ROOT/tmp/pids/thin.pid\nCMD=&quot;cd $APP_ROOT; thin -C $APP_ROOT/config/thin.yml -R $APP_ROOT/faye.ru&quot;\nAS_USER=user\nset -u\nstartme() {\n  run &quot;$CMD start&quot;\n}\nstopme() {\n  run &quot;thin stop&quot;\n}\nrun () {\n  if [ &quot;$(id -un)&quot; = &quot;$AS_USER&quot; ]; then\n    eval $1\n  else\n    su -c &quot;$1&quot; - $AS_USER\n  fi\n}\ncase &quot;$1&quot; in\n  start)   startme ;;\n  stop)    stopme ;;    \n  restart) stopme; startme ;;\n  *) echo &quot;usage: $0 start|stop|restart&quot; &gt;&amp;2\n  exit 1\n  ;\nesac\n</code></pre>\n<p>so I set the execution permissions for the script thin.sh</p>\n<pre><code>chmod ugo+x /home/user/apps/myappconfig/thin.sh\n</code></pre>\n<p><em>-rwxr-xr-x  1 user user  ... thin.sh*</em></p>\n<p>then I defined the script thin.sh as a service</p>\n<pre><code>cd /etc/init.d\nsudo ln -s /home/user/apps/myapp/config/thin.sh thin\n</code></pre>\n<p><em>lrwxrwxrwx   1 root root   ... thin -&gt; /home/user/apps/myapp/config/thin.sh*</em></p>\n<p>and finally I configured the boot on startup</p>\n<pre><code>sudo update-rc.d thin defaults\n</code></pre>\n<p>I have defined the parameters necessary for the script thin.sh (as params in $CMD in config/thin.sh)</p>\n<p>First the thin web server configuration file</p>\n<p><strong>/home/user/apps/myapp/config/thin.yml</strong></p>\n<pre><code>chdir: &quot;/home/user/apps/myapp&quot;\nenvironment: production\naddress: 127.0.0.1\nport: 9292\ntimeout: 30\nwait: 30\nmax_conns: 1024\nlog: /home/user/apps/myapp/log/thin.log\npid: /home/user/apps/myapp/tmp/pids/thin.pid\nmax_persistent_conns: 100\nrequire: []\nthreadpool_size: 20\ndaemonize: true\nssl: true\nssl-key-file: &quot;/etc/ssl/private/example_com.key&quot;\nssl-cert-file: &quot;/etc/ssl/certs/example_com.crt&quot;\n#ssl-disable-verify: true\n</code></pre>\n<p>and then the Faye server startup script (via rackup)</p>\n<p><strong>/home/user/apps/myapp/faye.ru</strong></p>\n<pre><code>require 'eventmachine'\nrequire 'rack'\nrequire 'thin'\nrequire 'faye'\n# set FAYE_TOKEN you prefer for faye authentication\nrequire File.expand_path('../config/initializers/faye_token.rb', __FILE__)\nFaye::WebSocket.load_adapter('thin')\n#define authentication extension \nclass ServerAuth\n  def incoming(message, callback)\n    if message['channel'] !~ %r{^/meta/}\n      if !message['ext'].nil?\n        if message['ext']['auth_token'] != FAYE_TOKEN\n          message['error'] = 'Invalid authentication token'\n        end\n      end\n    end\n    if message['channel'] =~ %r{/meta/subscribe}\n      ...\n    end\n    callback.call(message)\n  end\nend\nfaye_server = Faye::RackAdapter.new(:mount =&gt; '/faye', :timeout =&gt; 30)\nfaye_server.add_extension(ServerAuth.new)\nrun faye_server\n</code></pre>\n<p>at this point the automatic start of faye server is set.<br />\nAt boot '/etc/init.d/thin' service start 'thin server' with config/thin.yml executnig rackup script 'faye.ru'.</p>\n<h1>Faye client</h1>\n<p>I parametrized the urls for faye client</p>\n<p><strong>/home/user/apps/myapp/config/initializers/urls.rb</strong></p>\n<pre><code>FAYE_MOUNTPOINT_URL='https://example.com/faye'\nFAYE_JSCLIENT_URL='https://example.com/faye/client.js'\n</code></pre>\n<p>I included faye client javascripts in</p>\n<p><strong>/home/user/apps/myapp/app/views/layouts/application.html.erb</strong></p>\n<p>so then they are charged when you access the app</p>\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=&quot;it&quot;&gt;\n&lt;head&gt;\n  &lt;%= javascript_include_tag FAYE_JSCLIENT_URL %&gt;\n&lt;/head&gt;\n...\n</code></pre>\n<p>The Faye client is created when you access the page where there are your chat rooms (as channel).<br />\nThe right place is</p>\n<p><strong>/home/user/apps/myapp/app/assets/javascript/application.js</strong></p>\n<pre><code>...\nvar faye = null;\n$(document).ready(function(){\n  // https\n  faye = new Faye.Client('&lt;%= FAYE_MOUNTPOINT_URL %&gt;');\n  faye.disable('autodisconnect');\n  // divs with '.subscribe' class contain channels name\n  $('.subscribe').each(function() {\n    // subscribe each channel\n    faye.subscribe('/'+$(this).text(), function (data) {\n      // here I process 'data' to refresh page with new content using jquery\n      // I'm using hidden div\n      // when I receive notification I clone hidden div, then I fill some fields and I exhibit the new cloned div\n      ...\n      msg = $('#message_template').clone();\n      msg.html(data.message.content);\n      msg.css('visibility','visible');\n    });\n  });\n});\n</code></pre>\n<p>Sending a new message from client to server Faye:<br />\n(creating a new Message model with a call remote: true (ajax))</p>\n<p>called by create.js rensponse triggerd by controller_message#create as ajax response renderer</p>\n<p><strong>/home/user/apps/myapp/app/helpers/application_helper.rb</strong></p>\n<pre><code>def broadcast(channel, &lt;your_params&gt;)\n  # prepare 'data' as json format\n  data = { your_key: your_params.as_json }\n  message = { channel: '/' + channel.name, data: data, ext: { auth_token: FAYE_TOKEN } }\n  # https\n  uri = URI.parse(FAYE_MOUNTPOINT_URL)\n  Net::HTTP.post_form(uri, message: message.to_json, use_ssl: true)\nend\n</code></pre>\n<p>That's all</p>\n<p>For a better comprehension, I enclose Nginx configuration file</p>\n<pre><code>worker_processes  1;\nerror_log   logs/err.log debug;\nevents {\n  worker_connections  1024;\n}\nhttp {\n  upstream faye {\n    server unix:/tmp/faye.0.sock;\n    server unix:/tmp/faye.1.sock;\n  }\npassenger_root /home/user/.rvm/gems/ruby-2.3.0/gems/passenger-5.1.11;\nserver {\n  listen 80;\n  server_name example.com;\n  return 301 https://example.com/$request_uri;\n}\nserver {\n  listen 443 ssl default_server;\n  server_name example.com;\n  ssl_certificate   /etc/ssl/certs/example_com.crt;\n  ssl_certificate_key /etc/ssl/private/example_com.key;\n  ssl on;\n  passenger_enabled on;\n  passenger_app_root /home/user/apps/myapp;\n  passenger_ruby /home/user/.rvm/gems/ruby-2.3.0/wrappers/ruby;\n  location / {\n    root /home/user/apps/myapp/public;\n  }\n  error_page   500 502 503 504  /50x.html;\n  location = /50x.html {\n    root   html;\n  }\n  location /faye {\n    proxy_pass https://127.0.0.1:9292/faye;\n    proxy_http_version 1.1;\n    proxy_set_header Host $host;\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection &quot;upgrade&quot;;\n    proxy_redirect off;\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 3085740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d88f8f3504d43e10cd246de03085fb2?s=128&d=identicon&r=PG", "display_name": "malav", "link": "https://stackoverflow.com/users/3085740/malav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531322519, "creation_date": 1529414077, "question_id": 50929441, "link": "https://stackoverflow.com/questions/50929441/what-should-be-my-faye-url-value-for-rails-chat-application", "title": "What should be my FAYE_URL value for Rails chat application?", "body": "<p>I am trying to make a Chat web application based on Rails using \"private_pub\" gem which works perfectly on my localhost server. Now my site is hosted on DigitalOcean and i want to push chat code on the server to see how real-time chat app will work.</p>\n\n<p>This is my private_pub.yml file</p>\n\n<pre><code>development:\n server: \"http://localhost:9292/faye\"\n secret_token: \"secret\"\ntest:\n server: \"http://localhost:9292/faye\"\n secret_token: \"secret\"\nstaging:\n server: &lt;%= ENV[\"FAYE_URL\"] %&gt;\n secret_token:\"secret_key\"\n signature_expiration: 3600 # one hour\nproduction:\n server: &lt;%= ENV[\"FAYE_URL\"] %&gt;\n secret_token: \"secret_key\"\n signature_expiration: 3600 # one hour\n</code></pre>\n\n<p>My question is What should i have to do to make it work on any Linux server ( Here Digital Ocean for me). I am using Nginx server on DigitalOcean.</p>\n\n<p>What should be the value for FAYE_URL in private_pub.yml file?</p>\n\n<pre><code>rackup private_pub.ru -s thin -E production\n</code></pre>\n\n<p>Do i have to run rack command on my server terminal? Or is there any other way to host Faye on a different server then?</p>\n"}, {"tags": ["ruby", "io"], "answers": [{"tags": [], "owner": {"reputation": 222, "user_id": 639646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f04db9163f428c4fd70da0a1fceef250?s=128&d=identicon&r=PG", "display_name": "NOLFXceptMe", "link": "https://stackoverflow.com/users/639646/nolfxceptme"}, "is_accepted": true, "score": 1, "last_activity_date": 1529435487, "creation_date": 1529435487, "answer_id": 50935440, "question_id": 50928538, "link": "https://stackoverflow.com/questions/50928538/the-size-of-data-written-to-stream-obtained-from-iopipe/50935440#50935440", "title": "The size of data written to stream obtained from IO#pipe", "body": "<pre><code>irb(main):007:0&gt; read_io, write_io = IO.pipe\n=&gt; [#&lt;IO:fd 9&gt;, #&lt;IO:fd 10&gt;]\nirb(main):008:0&gt; read_io.tell\nErrno::ESPIPE: Illegal seek\n    from (irb):8:in `tell'\n    from (irb):8\n    from /usr/bin/irb:11:in `&lt;main&gt;'\nirb(main):009:0&gt; write_io.tell\nErrno::ESPIPE: Illegal seek\n    from (irb):9:in `tell'\n    from (irb):9\n    from /usr/bin/irb:11:in `&lt;main&gt;'\n</code></pre>\n\n<p>On my Ruby console, it returns <code>ESPIPE</code> and not <code>EINVAL</code>, which is expected because <code>tell</code> is implemented using <code>lseek</code> in Unix environments, which returns <code>ESPIPE</code> if the file is a <a href=\"http://pubs.opengroup.org/onlinepubs/000095399/functions/lseek.html\" rel=\"nofollow noreferrer\">pipe</a>.</p>\n\n<p>We can measure the amount of data written/read to the pipe by keeping an counter that accumulates results of <code>read()</code> and <code>write()</code> calls on the pipe.</p>\n"}], "owner": {"reputation": 211, "user_id": 4207625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b672c1aaa6bf9e222e114ec0d1384da?s=128&d=identicon&r=PG&f=1", "display_name": "V&#225;clav Pruner", "link": "https://stackoverflow.com/users/4207625/v%c3%a1clav-pruner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 50935440, "answer_count": 1, "score": 1, "last_activity_date": 1529435487, "creation_date": 1529411513, "question_id": 50928538, "link": "https://stackoverflow.com/questions/50928538/the-size-of-data-written-to-stream-obtained-from-iopipe", "title": "The size of data written to stream obtained from IO#pipe", "body": "<p>I'm using <a href=\"https://ruby-doc.org/core-2.0.0/IO.html#method-c-pipe\" rel=\"nofollow noreferrer\">IO#pipe</a> method and at some point I want to know how many bytes have already been written into the output stream. Using <a href=\"https://ruby-doc.org/core-2.0.0/IO.html#method-i-tell\" rel=\"nofollow noreferrer\">IO#tell</a> causes error which isn't much helpful - <code>Errno::EINVAL: Invalid argument</code> - it doesn't say what is invalid where.<br>\nThere is a trivial code snippet to demonstrate the issue:</p>\n\n<pre><code>read_io, write_io = IO.pipe\nwrite_io.tell #=&gt; #&lt;Errno::EINVAL: Invalid argument&gt;\n</code></pre>\n\n<p>Is there a way to write my own <code>tell</code> method? Or what am I doing wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "api-platform.com"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1529413150, "post_id": 50928269, "comment_id": 88856953, "body": "You need to require the file which contains the <code>Pipl::Person</code> class. Do you have a link to the source code for the Pipl library/gem?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1529413545, "post_id": 50928269, "comment_id": 88857239, "body": "Please ensure you have added <code>piplapis-ruby</code> to your Gemfile and not <code>pipl</code> (which seems to be a completely undeveloped gem)"}, {"owner": {"reputation": 718, "user_id": 6849449, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d3db99b93979027ce2de65663ac5ff7a?s=128&d=identicon&r=PG&f=1", "display_name": "jim", "link": "https://stackoverflow.com/users/6849449/jim"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1529413701, "post_id": 50928269, "comment_id": 88857342, "body": "@engineersmnky I&#39;m pretty new to ruby on rails...can you tell me how to do that? I tried doing what this site suggested: <a href=\"https://docs.pipl.com/docs/code-libraries\" rel=\"nofollow noreferrer\">docs.pipl.com/docs/code-libraries</a> which was to run &quot;bundle install piplapis-ruby&quot; but I get an error stating &quot;ERROR: &quot;bundle install&quot; was called with arguments [&quot;piplapis-ruby&quot;]&quot;"}, {"owner": {"reputation": 718, "user_id": 6849449, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d3db99b93979027ce2de65663ac5ff7a?s=128&d=identicon&r=PG&f=1", "display_name": "jim", "link": "https://stackoverflow.com/users/6849449/jim"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1529413928, "post_id": 50928269, "comment_id": 88857488, "body": "@Kris I&#39;m not sure I just did &quot;gem install pipl&quot; assuming that was fine"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1529414538, "post_id": 50928269, "comment_id": 88857879, "body": "@jim in the project there is a file called <code>Gemfile</code>. Open this file and add <code>gem &#39;piplapis-ruby</code>. Then open a terminal navigate to the root of the project and run <code>bundle install</code> then in your project you can try and use the above code (however the require statement is not necessary). All that being said a quick tutorial on rails would probably benefit you drastically. <a href=\"https://www.railstutorial.org/book\" rel=\"nofollow noreferrer\">Michael Hartl&#39;s</a> tutorial is still my recommended go to"}, {"owner": {"reputation": 718, "user_id": 6849449, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d3db99b93979027ce2de65663ac5ff7a?s=128&d=identicon&r=PG&f=1", "display_name": "jim", "link": "https://stackoverflow.com/users/6849449/jim"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1529415411, "post_id": 50928269, "comment_id": 88858483, "body": "@engineersmnky thank you I did what you said and it installed piplapis-ruby. However, when I run the code I get the same error"}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 2, "creation_date": 1529418863, "post_id": 50928269, "comment_id": 88860839, "body": "There is no <code>Person</code> class that I can see in the <code>piplapis</code> library: <a href=\"https://github.com/piplcom/piplapis-ruby/tree/master/lib/pipl\" rel=\"nofollow noreferrer\">github.com/piplcom/piplapis-ruby/tree/master/lib/pipl</a>"}, {"owner": {"reputation": 718, "user_id": 6849449, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d3db99b93979027ce2de65663ac5ff7a?s=128&d=identicon&r=PG&f=1", "display_name": "jim", "link": "https://stackoverflow.com/users/6849449/jim"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1529419169, "post_id": 50928269, "comment_id": 88861038, "body": "@Kris I can&#39;t find it either but i assumed if they had this example on their site than it should work."}, {"owner": {"reputation": 718, "user_id": 6849449, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d3db99b93979027ce2de65663ac5ff7a?s=128&d=identicon&r=PG&f=1", "display_name": "jim", "link": "https://stackoverflow.com/users/6849449/jim"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1529419673, "post_id": 50928269, "comment_id": 88861365, "body": "@Kris I guess I just need to add my own Person class. Thanks!"}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1529486341, "post_id": 50928269, "comment_id": 88886522, "body": "Their documentation is somewhat confusing."}], "answers": [{"tags": [], "owner": {"reputation": 718, "user_id": 6849449, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d3db99b93979027ce2de65663ac5ff7a?s=128&d=identicon&r=PG&f=1", "display_name": "jim", "link": "https://stackoverflow.com/users/6849449/jim"}, "is_accepted": false, "score": 0, "last_activity_date": 1529497042, "last_edit_date": 1529497042, "creation_date": 1529431272, "answer_id": 50934461, "question_id": 50928269, "link": "https://stackoverflow.com/questions/50928269/ruby-uninitialized-constant-piplperson-nameerror/50934461#50934461", "title": "Ruby uninitialized constant Pipl::Person (NameError)", "body": "<p>In order to use the Pipl API without the error, I got my API key through their site and I added <code>piplapis-ruby</code> gem just like what was told in the comments above. I imported all of the ruby classes found here: <a href=\"https://github.com/piplcom/piplapis-ruby\" rel=\"nofollow noreferrer\">https://github.com/piplcom/piplapis-ruby</a> into my project and pasted the codesnippet.rb file found here: <a href=\"https://github.com/piplcom/piplapis-ruby\" rel=\"nofollow noreferrer\">https://github.com/piplcom/piplapis-ruby</a> which was the ruby file you're supposed to execute. There was no need for me to create the Person class.</p>\n"}], "owner": {"reputation": 718, "user_id": 6849449, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d3db99b93979027ce2de65663ac5ff7a?s=128&d=identicon&r=PG&f=1", "display_name": "jim", "link": "https://stackoverflow.com/users/6849449/jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529497042, "creation_date": 1529410738, "last_edit_date": 1529411942, "question_id": 50928269, "link": "https://stackoverflow.com/questions/50928269/ruby-uninitialized-constant-piplperson-nameerror", "title": "Ruby uninitialized constant Pipl::Person (NameError)", "body": "<p>I am trying to integrate the Pipl API into my ruby on rails application. I am using ruby version 2.3.4 and rails 4.2.5. As a reference i looked at \n<a href=\"https://docs.pipl.com/reference/#using-search-parameters\" rel=\"nofollow noreferrer\">this site</a>\nand copied the ruby version of the code directly from it into a ruby file. When I run the ruby file in the terminal i get the error:        </p>\n\n<pre><code>`&lt;main&gt;': uninitialized constant Pipl::Person (NameError)\n</code></pre>\n\n<p>Any ideas why I'm getting this error? Any help is greatly appreciated.</p>\n\n<p>This is the code snippet that I used:</p>\n\n<pre><code>require 'pipl'\n\nperson = Pipl::Person.new\nperson.add_field Pipl::Name.new(first: 'Clark', last: 'Kent')\nperson.add_field Pipl::Address.new(country: 'US', state: 'KS', city: \n'Smallville')\nperson.add_field Pipl::Address.new(country: 'US', state: 'KS', city:  \n'Metropolis')\n\nresponse = Pipl::client.search person: person, api_key: 'myKEY' #I used my actual key here\n\nputs \"#{response}\"\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1529410170, "post_id": 50927744, "comment_id": 88854963, "body": "How did you change the routes?"}, {"owner": {"reputation": 3004, "user_id": 5830036, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/B2b06.png?s=128&g=1", "display_name": "Mayur Shah", "link": "https://stackoverflow.com/users/5830036/mayur-shah"}, "edited": false, "score": 0, "creation_date": 1529410979, "post_id": 50927744, "comment_id": 88855472, "body": "its taking <code>path=&quot;&#47;sign_out&quot;</code> as get method, it should be delete. Also check that this is in your application.js:  //= require jquery //= require jquery_ujs"}, {"owner": {"reputation": 27, "user_id": 8447599, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212785433966444/picture?type=large", "display_name": "Mathieu Ablle", "link": "https://stackoverflow.com/users/8447599/mathieu-ablle"}, "edited": false, "score": 0, "creation_date": 1529413595, "post_id": 50927744, "comment_id": 88857267, "body": "I did the route like this:"}], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 8447599, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212785433966444/picture?type=large", "display_name": "Mathieu Ablle", "link": "https://stackoverflow.com/users/8447599/mathieu-ablle"}, "is_accepted": false, "score": 0, "last_activity_date": 1529413656, "creation_date": 1529413656, "answer_id": 50929292, "question_id": 50927744, "link": "https://stackoverflow.com/questions/50927744/error-500-for-sign-in-and-sign-up-devise-routes-with-rails-on-heroku/50929292#50929292", "title": "Error 500 for /Sign_in and /Sign_up Devise routes with rails on heroku", "body": "<p>Thanks for your interest ! </p>\n\n<pre><code>I did the route like this: devise_scope :user do\n    get \"/sign_in\" =&gt; \"devise/sessions#new\", as: \"new_user_session\" # custom path to login/sign_in\n    post \"/sign_in\" =&gt; \"devise/sessions#create\", as: \"user_session\" # custom path to login/sign_in\n    get \"/sign_out\" =&gt; \"devise/sessions#destroy\", as: \"destroy_user_session\"\n    get \"/B21zukt938lama272kutoni\" =&gt; \"devise/registrations#new\", as: \"new_user_registration\" # custom path to sign_up/registration\n    post \"/B21zukt938lama272kutoni\" =&gt; \"devise/registrations#create\", as: \"user_registration\" # custom path to login/sign_in\n  end\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 8447599, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212785433966444/picture?type=large", "display_name": "Mathieu Ablle", "link": "https://stackoverflow.com/users/8447599/mathieu-ablle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1529413656, "creation_date": 1529409074, "question_id": 50927744, "link": "https://stackoverflow.com/questions/50927744/error-500-for-sign-in-and-sign-up-devise-routes-with-rails-on-heroku", "title": "Error 500 for /Sign_in and /Sign_up Devise routes with rails on heroku", "body": "<p>I have got a problem, I have changed the routes to sign_in, sign_up and sign_out on devise. Every thing works smoothly on local. But in production, I got an error 500.</p>\n\n<p>I have restarted the app, updated the database... Do someone has an Idea?</p>\n\n<p>Here is the logs:</p>\n\n<pre><code>at=info method=GET path=\"/sign_out\" host=www.domain.com request_id=84424ae1-e917-48d5-b54f-dd18c1862481 fwd=\"82.251.30.15\" dyno=web.1 connect=1ms service=6ms status=500 bytes=1093 protocol=http\n2018-06-19T11:41:14.232886+00:00 app[web.1]: I, [2018-06-19T11:41:14.232785 #4]  INFO -- : [84424ae1-e917-48d5-b54f-dd18c1862481] Started GET \"/sign_out\" for 82.251.30.15 at 2018-06-19 11:41:14 +0000\n2018-06-19T11:41:14.234261+00:00 app[web.1]: I, [2018-06-19T11:41:14.234163 #4]  INFO -- : [84424ae1-e917-48d5-b54f-dd18c1862481] Processing by Devise::SessionsController#destroy as HTML\n2018-06-19T11:41:14.235848+00:00 app[web.1]: I, [2018-06-19T11:41:14.235786 #4]  INFO -- : [84424ae1-e917-48d5-b54f-dd18c1862481] Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.0ms)\n2018-06-19T11:41:14.236922+00:00 app[web.1]: F, [2018-06-19T11:41:14.236858 #4] FATAL -- : [84424ae1-e917-48d5-b54f-dd18c1862481]\n2018-06-19T11:41:14.236995+00:00 app[web.1]: F, [2018-06-19T11:41:14.236944 #4] FATAL -- : [84424ae1-e917-48d5-b54f-dd18c1862481] NoMethodError (undefined method `name' for nil:NilClass):\n2018-06-19T11:41:14.237037+00:00 app[web.1]: F, [2018-06-19T11:41:14.236992 #4] FATAL -- : [84424ae1-e917-48d5-b54f-dd18c1862481]\n2018-06-19T11:41:14.237130+00:00 app[web.1]: F, [2018-06-19T11:41:14.237060 #4] FATAL -- : [84424ae1-e917-48d5-b54f-dd18c1862481] vendor/bundle/ruby/2.3.0/gems/devise-4.4.3/app/controllers/devise_controller.rb:44:in `resource_name'\n2018-06-19T11:41:14.237132+00:00 app[web.1]: [84424ae1-e917-48d5-b54f-dd18c1862481] vendor/bundle/ruby/2.3.0/gems/devise-4.4.3/app/controllers/dev\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1529409342, "post_id": 50927742, "comment_id": 88854483, "body": "<i>&quot;is this even a good idea?&quot;</i> -- The fact that you have one module so big that this question has even occurred to you is the real problem IMO! At least you&#39;re changing how it works, now..."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1529409375, "post_id": 50927742, "comment_id": 88854510, "body": "You could probably do it with some <code>method_added</code> magic."}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 1, "creation_date": 1529410801, "post_id": 50927742, "comment_id": 88855371, "body": "You can (heavily) adapt my answer for another question <a href=\"https://stackoverflow.com/a/50908899/681520\">stackoverflow.com/a/50908899/681520</a> to do this, at least I think it should give you some tips."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1529412047, "post_id": 50927742, "comment_id": 88856181, "body": "&quot;is this even a good idea?&quot; - it&#39;s not a bad idea. The concrete implementation might be bad, but the idea is fine."}, {"owner": {"reputation": 7856, "user_id": 79068, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/FNeR0.png?s=128&g=1", "display_name": "Ben Hull", "link": "https://stackoverflow.com/users/79068/ben-hull"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1529414391, "post_id": 50927742, "comment_id": 88857795, "body": "It&#39;s a fair point, @TomLord, though it was mostly just me trying to avoid repeating <code>warn</code> throughout the module if I didn&#39;t have to. In this case, there&#39;re only a dozen methods or so in this legacy module. Also, can you believe I&#39;ve been writing ruby for 10 years and never used <code>method_added</code>!? Very useful - thanks!"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1529415622, "post_id": 50927742, "comment_id": 88858633, "body": "@Beejamin &quot;I&#39;ve been writing ruby for 10 years and never used method_added&quot; - me too. Unless you&#39;re into heavy MP, you don&#39;t need it at all. :)"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1529420481, "post_id": 50927742, "comment_id": 88861887, "body": "Yeah, you can do some <a href=\"https://github.com/tom-lord/search_warrant/blob/6e144eb4c15a1aa2530f04bcb172b0cbdb4bb4ed/lib/search_warrant.rb#L38-L67\" rel=\"nofollow noreferrer\">pretty crazy stuff with <code>method_added</code></a> :)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1529421863, "post_id": 50927742, "comment_id": 88862669, "body": "@TomLord yeah as long as you make sure to have an appropriate guard clause <code>return if @_adding_a_method</code> when using <code>define_method</code> inside <code>method_added</code> otherwise you end up with a horrible recursive call :)"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1529422763, "post_id": 50927742, "comment_id": 88863194, "body": "@engineersmnky Using <code>Module#prepend</code> makes it much easier to do that sort of thing. I intentionally wrote that code <i>without</i> <code>Module#prepend</code> as a key part of the challenge :)"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1529412224, "post_id": 50928674, "comment_id": 88856296, "body": "Also, it is trivial to combine this with <code>method_added</code> and get a blanket deprecation thingie."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 4, "last_activity_date": 1529411899, "creation_date": 1529411899, "answer_id": 50928674, "question_id": 50927742, "link": "https://stackoverflow.com/questions/50927742/is-there-a-neat-way-to-mark-an-entire-module-full-of-methods-as-deprecated/50928674#50928674", "title": "Is there a neat way to mark an entire module full of methods as deprecated?", "body": "<p>While this is not exactly what you asked (\"mark all methods at once\") and there probably exists something like this in ruby itself or big frameworks like rails, it might still be useful to somebody.</p>\n\n<pre><code>module DeprecatedMethods\n  def deprecated(method_name)\n    prepend(Module.new do\n      define_method method_name do |*args|\n        puts \"calling deprecated method #{method_name}\"\n        super(*args)\n      end\n    end)\n  end\n\nend\n\nmodule AncientCode\n  extend DeprecatedMethods\n\n  deprecated def foo # selectively mark methods as deprecated\n    puts \"doing foo\"\n  end\n\n  def bar\n    puts \"doing bar\"\n  end\nend\n\nclass Host\n  include AncientCode\nend\n\nhost = Host.new\nhost.foo\nhost.bar\n# &gt;&gt; calling deprecated method foo\n# &gt;&gt; doing foo\n# &gt;&gt; doing bar\n</code></pre>\n\n<p>Currently this injects a module per deprecated method, which is kinda wasteful. You can put all deprecated methods in one module, by doing something like this:</p>\n\n<pre><code>deprecated_methods :foo, :bar\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7856, "user_id": 79068, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/FNeR0.png?s=128&g=1", "display_name": "Ben Hull", "link": "https://stackoverflow.com/users/79068/ben-hull"}, "edited": false, "score": 0, "creation_date": 1529450976, "post_id": 50933107, "comment_id": 88874715, "body": "Interesting approach. I would ideally like something that is contained to the <code>LegacyStuff</code> module if possible, though."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 7856, "user_id": 79068, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/FNeR0.png?s=128&g=1", "display_name": "Ben Hull", "link": "https://stackoverflow.com/users/79068/ben-hull"}, "edited": false, "score": 0, "creation_date": 1529473776, "post_id": 50933107, "comment_id": 88879831, "body": "I hope this Take #24 is a wrap."}, {"owner": {"reputation": 7856, "user_id": 79068, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/FNeR0.png?s=128&g=1", "display_name": "Ben Hull", "link": "https://stackoverflow.com/users/79068/ben-hull"}, "edited": false, "score": 0, "creation_date": 1529502781, "post_id": 50933107, "comment_id": 88897414, "body": "That is beautiful. Thanks for all the effort - exceptional answer and explanation."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 2, "last_activity_date": 1529643783, "last_edit_date": 1529643783, "creation_date": 1529426049, "answer_id": 50933107, "question_id": 50927742, "link": "https://stackoverflow.com/questions/50927742/is-there-a-neat-way-to-mark-an-entire-module-full-of-methods-as-deprecated/50933107#50933107", "title": "Is there a neat way to mark an entire module full of methods as deprecated?", "body": "<p><strong>Code</strong></p>\n\n<p>First create a module containing a single module method, <code>setup</code>. This module could be put in a file that is required as needed. This module method will be invoked from a module containing instance methods to be included in a given class. Using aliases, it modifies those instance methods to print a message (containing the method name) before executing the remainder of its code.</p>\n\n<p><em>Module AddMessage</em></p>\n\n<pre><code>module AddMessage\n  def self.setup(mod, msg_pre, msg_post)\n    mod.instance_methods(false).\n        each do |m|\n          am = \"_#{m}\".to_sym\n          mod.send(:alias_method, am, m)\n          mod.send(:private, am)\n          mod.send(:define_method, m) do |*args, &amp;block|\n            puts \"%s %s %s\" % [msg_pre, m, msg_post] \n            send(am, *args, &amp;block)\n          end\n        end\n  end\nend\n</code></pre>\n\n<p><em>Module to be included in class</em></p>\n\n<pre><code>module LegacyStuff\n  def old1\n    \"hi\"\n  end\n  def old2(a, b)\n    yield(a, b)\n  end\n  AddMessage.setup(self, \"Warning:\", \"is deprecated\")\nend\n</code></pre>\n\n<p><code>AddMessage::setup</code> is passed three arguments, the name of the calling module and a message <em>prefix</em> and message <em>suffix</em> that are used to form the warning message. When an instance method <code>m</code> in this module is executed by a class instance the message <code>\"Warning: #{m} is deprecated\"</code> is printed (e.g., <code>\"Warning: old1 is deprecated\"</code>) before the remaining calculations are performed.</p>\n\n<p><strong>Use</strong></p>\n\n<p><code>LegacyStuff</code> is simply included by a class.</p>\n\n<pre><code>class C\n  include LegacyStuff\n  # &lt;constants, methods and so forth go here&gt;\nend\n\nc = C.new\nc.old1\n  # Warning: old1 is deprecated\n  #=&gt; \"hi\"\nc.old2(1,2) { |a,b| a+b }\n  # Warning: old2 is deprecated\n  #=&gt; 3\nc.cat\n  #=&gt; NoMethodError: undefined method `cat' for #&lt;C:0x000000008ef0a8&gt;\n</code></pre>\n\n<p><strong>Explanation of the module method <code>AddMessage:setup</code></strong></p>\n\n<p>The following (of the generally less-familiar) methods are used by this method: <a href=\"http://ruby-doc.org/core-2.4.0/Module.html#method-i-instance_methods\" rel=\"nofollow noreferrer\">Module#instance_methods</a>, <a href=\"http://ruby-doc.org/core-2.4.0/Module.html#method-i-alias_method\" rel=\"nofollow noreferrer\">Module#alias_method</a>, <a href=\"https://ruby-doc.org/core-2.5.1/Module.html#method-i-private\" rel=\"nofollow noreferrer\">Module#private</a> and <a href=\"http://ruby-doc.org/core-2.4.0/Module.html#method-i-define_method\" rel=\"nofollow noreferrer\">Module#define_method</a>.</p>\n\n<p>The following three steps are performed for each instance method <code>m</code> defined in module <code>mod</code> (e.g., elements of the array <code>LegacyStuff.instance_methods(false)</code>).</p>\n\n<p><strong><code>mod.send(:alias_method, am, m)</code></strong></p>\n\n<p>Create an alias <code>am</code> of the method (e.g., <code>_:old1</code> for <code>old1</code>).</p>\n\n<p><strong><code>mod.send(:private, am)</code></strong></p>\n\n<p>Make the alias <code>am</code> a private method (e.g., <code>_old1</code>).</p>\n\n<p><strong><code>mod.send(:define_method, m) do |*args, &amp;block| ... end</code></strong></p>\n\n<p>Redefine the method <code>m</code> (e.g., <code>old1</code>) to print the indicate string and then execute the alias <code>am</code> (e.g., <code>_old1</code>).</p>\n"}], "owner": {"reputation": 7856, "user_id": 79068, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/FNeR0.png?s=128&g=1", "display_name": "Ben Hull", "link": "https://stackoverflow.com/users/79068/ben-hull"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 50933107, "answer_count": 2, "score": 1, "last_activity_date": 1529643783, "creation_date": 1529409065, "question_id": 50927742, "link": "https://stackoverflow.com/questions/50927742/is-there-a-neat-way-to-mark-an-entire-module-full-of-methods-as-deprecated", "title": "Is there a neat way to mark an entire module full of methods as deprecated?", "body": "<p>I have a ruby class which contains a lot of logic which will no longer be used but I need to keep around (for a while at least) for backwards-compatibility.</p>\n\n<p>My plan is to move these methods to a module like <code>LegacyStuff</code> and include it in the class. I'm wondering if there's a neat way to add something such that when any method in the module is called, a warning is generated, without having to actually add <code>warn</code> statements to every individual method body.</p>\n\n<p>I guess what I'm looking for is behaviour like a 'before call' or 'after call' hook on a whole module. I guess the sub-question here is \"is this even a good idea?\"</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rolify", "acts-as-audited"], "answers": [{"comments": [{"owner": {"reputation": 475, "user_id": 5950598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Ihgv3.jpg?s=128&g=1", "display_name": "Jan Krupa", "link": "https://stackoverflow.com/users/5950598/jan-krupa"}, "edited": false, "score": 0, "creation_date": 1529479907, "post_id": 50931429, "comment_id": 88882726, "body": "Problem is still the same with following definition. <code>user</code> has <code>has_and_belongs_to_many :roles, join_table: :users_roles</code> <code>role</code> has <code>has_and_belongs_to_many :users, join_table: :users_roles</code>"}, {"owner": {"reputation": 187, "user_id": 1477932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ae986215778ab701f6573bc4bd28ad?s=128&d=identicon&r=PG", "display_name": "GAURAV SETH", "link": "https://stackoverflow.com/users/1477932/gaurav-seth"}, "reply_to_user": {"reputation": 475, "user_id": 5950598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Ihgv3.jpg?s=128&g=1", "display_name": "Jan Krupa", "link": "https://stackoverflow.com/users/5950598/jan-krupa"}, "edited": false, "score": 0, "creation_date": 1529499532, "post_id": 50931429, "comment_id": 88895154, "body": "I hope in RoleUser model having belongs_to :role and belongs_to :user."}, {"owner": {"reputation": 475, "user_id": 5950598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Ihgv3.jpg?s=128&g=1", "display_name": "Jan Krupa", "link": "https://stackoverflow.com/users/5950598/jan-krupa"}, "edited": false, "score": 0, "creation_date": 1529499648, "post_id": 50931429, "comment_id": 88895237, "body": "Well with <code>has_and_belongs_to_many</code> HABTM the <code>RoleUser</code> model does not exists. But when I create it, it works. I fixed it with removing HABTM by <a href=\"http://blog.flatironschool.com/why-you-dont-need-has-and-belongs-to-many/\" rel=\"nofollow noreferrer\">blog.flatironschool.com/&hellip;</a>"}], "tags": [], "owner": {"reputation": 187, "user_id": 1477932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ae986215778ab701f6573bc4bd28ad?s=128&d=identicon&r=PG", "display_name": "GAURAV SETH", "link": "https://stackoverflow.com/users/1477932/gaurav-seth"}, "is_accepted": false, "score": 1, "last_activity_date": 1529420201, "creation_date": 1529420201, "answer_id": 50931429, "question_id": 50927649, "link": "https://stackoverflow.com/questions/50927649/audited-associated-audits-with-habtm-relation/50931429#50931429", "title": "Audited: Associated audits with HABTM relation", "body": "<p>Look like there is issue with association if it is has_and_belongs_to_many :users and join_table is users_roles on that case in roles table also it should be has_and_belongs_to_many :roles, join_table: :users_roles, and this will make HABM relationship.</p>\n"}, {"tags": [], "owner": {"reputation": 475, "user_id": 5950598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Ihgv3.jpg?s=128&g=1", "display_name": "Jan Krupa", "link": "https://stackoverflow.com/users/5950598/jan-krupa"}, "is_accepted": true, "score": 1, "last_activity_date": 1529562770, "creation_date": 1529562770, "answer_id": 50961818, "question_id": 50927649, "link": "https://stackoverflow.com/questions/50927649/audited-associated-audits-with-habtm-relation/50961818#50961818", "title": "Audited: Associated audits with HABTM relation", "body": "<p>I've resolved the problem by this tutorial: \n<a href=\"http://blog.flatironschool.com/why-you-dont-need-has-and-belongs-to-many/\" rel=\"nofollow noreferrer\">http://blog.flatironschool.com/why-you-dont-need-has-and-belongs-to-many/</a></p>\n\n<p>What I did was that I removed the HABTM relation and created model for the joining table.</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  rolify strict: true\n  has_many :users_roles\n  has_many :roles, through: :users_roles, dependent: :destroy\n  has_associated_audits\n\n\nclass Role &lt; ApplicationRecord\n  has_many :users_roles\n  has_many :users, through: :users_roles, dependent: :destroy\n  audited associated_with: :users\n\nclass UsersRole &lt; ApplicationRecord\n  # audited associated_with: :role\n  audited associated_with: :user\n\n  belongs_to :user\n  belongs_to :role\nend\n</code></pre>\n\n<p>Now when the audits are created with change at the <code>UsersRole</code> instance. \nThe problem is that, the change's contains only the <code>ids</code> of destroyed columns, so you cannot figure, what it was. \nThis problem is partially solved there: <a href=\"https://github.com/collectiveidea/audited/issues/72#issuecomment-398756380\" rel=\"nofollow noreferrer\">https://github.com/collectiveidea/audited/issues/72#issuecomment-398756380</a></p>\n"}], "owner": {"reputation": 475, "user_id": 5950598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Ihgv3.jpg?s=128&g=1", "display_name": "Jan Krupa", "link": "https://stackoverflow.com/users/5950598/jan-krupa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 580, "favorite_count": 0, "accepted_answer_id": 50961818, "answer_count": 2, "score": 1, "last_activity_date": 1568803869, "creation_date": 1529408744, "last_edit_date": 1568803869, "question_id": 50927649, "link": "https://stackoverflow.com/questions/50927649/audited-associated-audits-with-habtm-relation", "title": "Audited: Associated audits with HABTM relation", "body": "<p>I've got model <code>user</code> and <code>role</code></p>\n\n<pre><code>class User &lt; ApplicationRecord\n  rolify strict: true\n\n  has_many :roles, through: :users_roles\n  has_associated_audits\n\n\nclass Role &lt; ApplicationRecord\n  has_and_belongs_to_many :users, join_table: :users_roles\n  audited associated_with: :users, join_table: :users_roles\n</code></pre>\n\n<p>When I create a new role, I've got the error:</p>\n\n<pre><code>2.4.4 :373 &gt;   User.first.add_role Role.pi, ProjectRequest.find(319)\n  User Load (0.7ms)  SELECT  `users`.* FROM `users` ORDER BY `users`.`id` ASC LIMIT 1\n  ProjectRequest Load (0.6ms)  SELECT  `project_requests`.* FROM `project_requests` WHERE `project_requests`.`id` = 319 LIMIT 1\n  Role Load (0.6ms)  SELECT  `roles`.* FROM `roles` WHERE `roles`.`name` = 'pi' AND `roles`.`resource_type` = 'ProjectRequest' AND `roles`.`resource_id` = 319 ORDER BY `roles`.`id` ASC LIMIT 1\n   (0.2ms)  BEGIN\n  SQL (0.6ms)  INSERT INTO `roles` (`name`, `resource_type`, `resource_id`, `created_at`, `updated_at`) VALUES ('pi', 'ProjectRequest', 319, '2018-06-19 11:40:13', '2018-06-19 11:40:13')\n   (54.3ms)  ROLLBACK\nNoMethodError: undefined method `primary_key' for User::ActiveRecord_Associations_CollectknowProxy:Class\n</code></pre>\n\n<p>I don't really now whats the problem, did I wrongly specified something?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 573, "user_id": 6761781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c46a125fbbb6589becc8816a3cf4f3?s=128&d=identicon&r=PG&f=1", "display_name": "M. Habib", "link": "https://stackoverflow.com/users/6761781/m-habib"}, "edited": false, "score": 0, "creation_date": 1529408737, "post_id": 50926882, "comment_id": 88854103, "body": "yeah! I also found this method while checking base.rb in the source code. I can do <code>Prescription.last.to_settings_hash[:print_options]</code> to get my required hash."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1529406289, "creation_date": 1529406289, "answer_id": 50926882, "question_id": 50926115, "link": "https://stackoverflow.com/questions/50926115/rails-settings-get-all-settings-for-a-key/50926882#50926882", "title": "rails-settings get all settings for a key", "body": "<p><a href=\"https://github.com/ledermann/rails-settings/blob/master/lib/rails-settings/base.rb#L38\" rel=\"nofollow noreferrer\"><code>Prescription#to_settings_hash</code></a> is probably what you are looking for:</p>\n\n<pre><code>Prescription.last.to_settings_hash\n</code></pre>\n"}], "owner": {"reputation": 573, "user_id": 6761781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c46a125fbbb6589becc8816a3cf4f3?s=128&d=identicon&r=PG&f=1", "display_name": "M. Habib", "link": "https://stackoverflow.com/users/6761781/m-habib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "accepted_answer_id": 50926882, "answer_count": 1, "score": 0, "last_activity_date": 1533468523, "creation_date": 1529403942, "last_edit_date": 1533468523, "question_id": 50926115, "link": "https://stackoverflow.com/questions/50926115/rails-settings-get-all-settings-for-a-key", "title": "rails-settings get all settings for a key", "body": "<p>I have <a href=\"https://github.com/ledermann/rails-settings\" rel=\"nofollow noreferrer\">ledermann-rails-settings</a> in my project which is used to store settings. I want to get all settings values for a key. My model is like </p>\n\n<pre><code>class Prescription &lt; ActiveRecord:Base \n  has_settings do |s|\n    s.key :print_options ,:defaults=&gt; {:medication=&gt;true,:medical_history=&gt;false}   \n  end\nend\n</code></pre>\n\n<p>I have gone through the <a href=\"https://www.rubydoc.info/gems/ledermann-rails-settings/1.2.0/frames\" rel=\"nofollow noreferrer\">documention</a> on rubydoc and also on <a href=\"https://github.com/ledermann/rails-settings\" rel=\"nofollow noreferrer\">git</a> but couldn't find a method to fetch all values in one go. There is <code>all</code> method available for setting object but it did not work in my case. If I do <code>Prescription.last.settings(:print_options).all</code> It returns <code>nil</code> which is because it thinks <code>all</code> as a key and tries to fetch value for it.</p>\n\n<p>I have seen the object structure and saw the values stored in <code>value</code> attribute of setting object, which can be fetched like </p>\n\n<pre><code>Prescription.last.settings(:print_options).value\n</code></pre>\n\n<p>but the problem with this is that it do not return default values whereas I need to get all values(including defaults). If someone know any method for this purpose or can correct me on using <code>all</code> method then please let me know.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "daemon", "production-environment"], "comments": [{"owner": {"reputation": 1114, "user_id": 5934752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7tGT8.jpg?s=128&g=1", "display_name": "Ravi Mariya", "link": "https://stackoverflow.com/users/5934752/ravi-mariya"}, "edited": false, "score": 0, "creation_date": 1529402665, "post_id": 50925561, "comment_id": 88850399, "body": "<code>tail -f log&#47;production.log</code> this what i do from rails app directory"}, {"owner": {"reputation": 11, "user_id": 9212950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9819f63633fe0135168bac644018a07?s=128&d=identicon&r=PG&f=1", "display_name": "coding-jewelry", "link": "https://stackoverflow.com/users/9212950/coding-jewelry"}, "reply_to_user": {"reputation": 1114, "user_id": 5934752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7tGT8.jpg?s=128&g=1", "display_name": "Ravi Mariya", "link": "https://stackoverflow.com/users/5934752/ravi-mariya"}, "edited": false, "score": 0, "creation_date": 1529402925, "post_id": 50925561, "comment_id": 88850578, "body": "Actually, it is empty in log/ directory.  There isn&#39;t any log file (production.log, development.log).   I am not sure why that is."}, {"owner": {"reputation": 1114, "user_id": 5934752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7tGT8.jpg?s=128&g=1", "display_name": "Ravi Mariya", "link": "https://stackoverflow.com/users/5934752/ravi-mariya"}, "edited": false, "score": 0, "creation_date": 1529403207, "post_id": 50925561, "comment_id": 88850753, "body": "I know, your question is <code>How can I see server logs in Ruby on Rails daemon way?</code>, for  <code>I am not sure why that is.</code> you need to debug and add some more details, so someone will surely help you to fix it :)"}, {"owner": {"reputation": 11, "user_id": 9212950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9819f63633fe0135168bac644018a07?s=128&d=identicon&r=PG&f=1", "display_name": "coding-jewelry", "link": "https://stackoverflow.com/users/9212950/coding-jewelry"}, "reply_to_user": {"reputation": 1114, "user_id": 5934752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7tGT8.jpg?s=128&g=1", "display_name": "Ravi Mariya", "link": "https://stackoverflow.com/users/5934752/ravi-mariya"}, "edited": false, "score": 0, "creation_date": 1529403262, "post_id": 50925561, "comment_id": 88850795, "body": "So what should I do exactly?  Just in order to see the logs.."}, {"owner": {"reputation": 7359, "user_id": 599989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d752d2574aeb36bc66471f4d0f8811aa?s=128&d=identicon&r=PG", "display_name": "Bijendra", "link": "https://stackoverflow.com/users/599989/bijendra"}, "edited": false, "score": 0, "creation_date": 1529403387, "post_id": 50925561, "comment_id": 88850866, "body": "what is the webserver you are using"}, {"owner": {"reputation": 11, "user_id": 9212950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9819f63633fe0135168bac644018a07?s=128&d=identicon&r=PG&f=1", "display_name": "coding-jewelry", "link": "https://stackoverflow.com/users/9212950/coding-jewelry"}, "edited": false, "score": 0, "creation_date": 1529403616, "post_id": 50925561, "comment_id": 88851021, "body": "Currently I am using Nginx."}, {"owner": {"reputation": 367, "user_id": 4523968, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d72ee11aa1084aa094cdedb9b60b1774?s=128&d=identicon&r=PG&f=1", "display_name": "Mattia M.", "link": "https://stackoverflow.com/users/4523968/mattia-m"}, "edited": false, "score": 0, "creation_date": 1529404340, "post_id": 50925561, "comment_id": 88851514, "body": "Are you using webkit? puma? unicorn? What is the webserver of your application?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1529404535, "post_id": 50925561, "comment_id": 88851640, "body": "How is the logger configured in your <code>config&#47;environment.rb</code> or your <code>config&#47;environments&#47;production.rb</code>?"}, {"owner": {"reputation": 11, "user_id": 9212950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9819f63633fe0135168bac644018a07?s=128&d=identicon&r=PG&f=1", "display_name": "coding-jewelry", "link": "https://stackoverflow.com/users/9212950/coding-jewelry"}, "edited": false, "score": 0, "creation_date": 1529405399, "post_id": 50925561, "comment_id": 88852164, "body": "I am using Puma."}, {"owner": {"reputation": 11, "user_id": 9212950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9819f63633fe0135168bac644018a07?s=128&d=identicon&r=PG&f=1", "display_name": "coding-jewelry", "link": "https://stackoverflow.com/users/9212950/coding-jewelry"}, "edited": false, "score": 0, "creation_date": 1529405755, "post_id": 50925561, "comment_id": 88852376, "body": "What should I add or change in config/environments/production.rb file?"}], "answers": [{"tags": [], "owner": {"reputation": 7359, "user_id": 599989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d752d2574aeb36bc66471f4d0f8811aa?s=128&d=identicon&r=PG", "display_name": "Bijendra", "link": "https://stackoverflow.com/users/599989/bijendra"}, "is_accepted": false, "score": 0, "last_activity_date": 1529403444, "creation_date": 1529403444, "answer_id": 50925946, "question_id": 50925561, "link": "https://stackoverflow.com/questions/50925561/how-can-i-see-server-logs-in-ruby-on-rails-daemon-way/50925946#50925946", "title": "How can I see server logs in Ruby on Rails daemon way?", "body": "<pre><code>tail -f log-path/*\n</code></pre>\n\n<p>find the log folder in the ec2 instance under /var/log folder</p>\n\n<p>find the exact path and replace the log-path</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9212950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9819f63633fe0135168bac644018a07?s=128&d=identicon&r=PG&f=1", "display_name": "coding-jewelry", "link": "https://stackoverflow.com/users/9212950/coding-jewelry"}, "edited": false, "score": 0, "creation_date": 1529407774, "post_id": 50926858, "comment_id": 88853574, "body": "So where can I find config.rb in Puma?   I am asking about the absolute path of the file on my Ubuntu."}], "tags": [], "owner": {"reputation": 367, "user_id": 4523968, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d72ee11aa1084aa094cdedb9b60b1774?s=128&d=identicon&r=PG&f=1", "display_name": "Mattia M.", "link": "https://stackoverflow.com/users/4523968/mattia-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1529406219, "creation_date": 1529406219, "answer_id": 50926858, "question_id": 50925561, "link": "https://stackoverflow.com/questions/50925561/how-can-i-see-server-logs-in-ruby-on-rails-daemon-way/50926858#50926858", "title": "How can I see server logs in Ruby on Rails daemon way?", "body": "<p>Since you are using Puma, you need to redirect STDOUT and STDERR to specific files as shown <a href=\"https://github.com/puma/puma/blob/master/examples/config.rb#L49\" rel=\"nofollow noreferrer\">here</a></p>\n\n<pre><code># Redirect STDOUT and STDERR to files specified. The 3rd parameter\n# (\"append\") specifies whether the output is appended, the default is\n# \"false\".\n#\nstdout_redirect '/u/apps/lolcat/log/stdout', '/u/apps/lolcat/log/stderr'\nstdout_redirect '/u/apps/lolcat/log/stdout', '/u/apps/lolcat/log/stderr', true\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 712, "user_id": 929251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69ef9fdd5a6cd663670253f5a73527a4?s=128&d=identicon&r=PG", "display_name": "Igor Kasyanchuk", "link": "https://stackoverflow.com/users/929251/igor-kasyanchuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1610447954, "creation_date": 1610447954, "answer_id": 65682269, "question_id": 50925561, "link": "https://stackoverflow.com/questions/50925561/how-can-i-see-server-logs-in-ruby-on-rails-daemon-way/65682269#65682269", "title": "How can I see server logs in Ruby on Rails daemon way?", "body": "<p>With this gem, you can read logs in browser: <a href=\"https://github.com/igorkasyanchuk/sweet_staging\" rel=\"nofollow noreferrer\">https://github.com/igorkasyanchuk/sweet_staging</a></p>\n<p>in addition, execute ruby code in a simple console and call unix commands</p>\n"}], "owner": {"reputation": 11, "user_id": 9212950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9819f63633fe0135168bac644018a07?s=128&d=identicon&r=PG&f=1", "display_name": "coding-jewelry", "link": "https://stackoverflow.com/users/9212950/coding-jewelry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1070, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1610447954, "creation_date": 1529402342, "last_edit_date": 1529409182, "question_id": 50925561, "link": "https://stackoverflow.com/questions/50925561/how-can-i-see-server-logs-in-ruby-on-rails-daemon-way", "title": "How can I see server logs in Ruby on Rails daemon way?", "body": "<p>Now I am running a Ruby on Rails app in Daemon way on my EC2 instance(AWS)...</p>\n\n<pre><code>\"bundle exec rails server -e production -d\"\n</code></pre>\n\n<p>In this case, I am not sure how I can see the server logs.\nActually, there is not any log file in <code>logs/</code> directory.\nPlease let me know if you have any idea or hint.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "url"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 3, "creation_date": 1529400689, "post_id": 50924847, "comment_id": 88849121, "body": "<code>url.start_with?(&quot;https:&#47;&#47;url.com&#47;&quot;)</code>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1529401343, "post_id": 50924847, "comment_id": 88849537, "body": "For two arbitrary strings, you can use a regular expression or some method like <code>start_with?</code> - as above. But these are no ordinary strings; these are URIs. Presumably, you want things like <code>http:&#47;&#47;url.com</code>, <code>www.url.com</code>, <code>https:&#47;&#47;www.url.com</code>, <code>url.com&#47;</code>, .... to be considered equivalent. And doing this reliably with regex would be very hard (not to mention you&#39;re re-inventing the wheel!) Therefore, as answered below, I would suggest using the standard library&#39;s <code>URI</code> module."}, {"owner": {"reputation": 7217, "user_id": 475766, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/Pm674.jpg?s=128&g=1", "display_name": "Ortund", "link": "https://stackoverflow.com/users/475766/ortund"}, "edited": false, "score": 0, "creation_date": 1529418101, "post_id": 50924847, "comment_id": 88860365, "body": "Your question has no code which makes it difficult for others to understand what you&#39;re doing and how you&#39;re going about it. Please update your post with a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> and a <b>clear problem statement</b>."}], "answers": [{"tags": [], "owner": {"reputation": 476, "user_id": 2645167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEnRe.jpg?s=128&g=1", "display_name": "andriy-baran", "link": "https://stackoverflow.com/users/2645167/andriy-baran"}, "is_accepted": true, "score": 7, "last_activity_date": 1529400714, "creation_date": 1529400714, "answer_id": 50925000, "question_id": 50924847, "link": "https://stackoverflow.com/questions/50924847/compare-two-different-string-with-the-same-part-in-ruby-on-rails/50925000#50925000", "title": "Compare two different string with the same part in Ruby on Rails", "body": "<p>You can use URI module <a href=\"https://docs.ruby-lang.org/en/2.1.0/URI.html\" rel=\"noreferrer\">https://docs.ruby-lang.org/en/2.1.0/URI.html</a></p>\n\n<pre><code>uri = URI(\"http://foo.com/posts?id=30&amp;limit=5#time=1305298413\")\nuri.host\n#=&gt; \"foo.com\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 820, "user_id": 5714083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OwqvJ.jpg?s=128&g=1", "display_name": "Lavish Tyagi", "link": "https://stackoverflow.com/users/5714083/lavish-tyagi"}, "is_accepted": false, "score": 5, "last_activity_date": 1529409901, "creation_date": 1529409901, "answer_id": 50928014, "question_id": 50924847, "link": "https://stackoverflow.com/questions/50924847/compare-two-different-string-with-the-same-part-in-ruby-on-rails/50928014#50928014", "title": "Compare two different string with the same part in Ruby on Rails", "body": "<p>Please try the URI Module as given below:-</p>\n\n<pre><code>require 'uri'\n\nuri = URI(\"http://foo.com/posts?id=30&amp;limit=5#time=1305298413\")\n#=&gt; #&lt;URI::HTTP:0x00000000b14880\n      URL:http://foo.com/posts?id=30&amp;limit=5#time=1305298413&gt;\nuri.scheme\n#=&gt; \"http\"\nuri.host\n#=&gt; \"foo.com\"\nuri.path\n#=&gt; \"/posts\"\nuri.query\n#=&gt; \"id=30&amp;limit=5\"\nuri.fragment\n#=&gt; \"time=1305298413\"\n\nuri.to_s\n#=&gt; \"http://foo.com/posts?id=30&amp;limit=5#time=1305298413\"\n</code></pre>\n\n<p>Thanks :)</p>\n"}], "owner": {"reputation": 51, "user_id": 7043890, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f8663N1uKUg/AAAAAAAAAAI/AAAAAAAAAEo/AXwHXjXit94/photo.jpg?sz=128", "display_name": "\u0410\u043b\u0435\u043a\u0441\u0430\u043d\u0434\u0440 \u0413\u043e\u043d\u043e\u0440", "link": "https://stackoverflow.com/users/7043890/%d0%90%d0%bb%d0%b5%d0%ba%d1%81%d0%b0%d0%bd%d0%b4%d1%80-%d0%93%d0%be%d0%bd%d0%be%d1%80"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 50925000, "answer_count": 2, "score": 1, "last_activity_date": 1529409901, "creation_date": 1529400227, "last_edit_date": 1529402865, "question_id": 50924847, "link": "https://stackoverflow.com/questions/50924847/compare-two-different-string-with-the-same-part-in-ruby-on-rails", "title": "Compare two different string with the same part in Ruby on Rails", "body": "<p>I need to accept URL and compare it with another. Both URL's have the same start but different end which dynamically changes. I accept something like this <code>https://url.com/something_else</code> and need to compare with <code>https://url.com/</code> check if this part is in received URL without <code>something_else</code>. How can I do this in Rails?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 1, "creation_date": 1529395143, "post_id": 50923294, "comment_id": 88845918, "body": "Not the most effective approach, but you can do: <code>((Date.today - 90)..Date.today).all? { |d| (Date.parse(&#39;25-12-2000&#39;)..Date.parse(&#39;25-12-2020&#39;)).include&zwnj;&#8203;? d }</code>"}], "answers": [{"tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": false, "score": 1, "last_activity_date": 1529397141, "last_edit_date": 1529397141, "creation_date": 1529396076, "answer_id": 50923630, "question_id": 50923294, "link": "https://stackoverflow.com/questions/50923294/how-to-check-if-a-date-range-is-in-between-another-date-range-in-ruby/50923630#50923630", "title": "How to check if a date range is in between another date range in Ruby", "body": "<p>I'd just check the first and last date against the range:</p>\n\n<pre><code>range = (Date.today - 90)..Date.today)\nvalidation_range = ((Date.parse('25-12-2000')..(Date.parse('25-12-2020'))\nrange.first &gt; validation_range &amp;&amp; range.last &lt; validation_range.last\n</code></pre>\n\n<p>You could break this down even further, rather just the first and last dates of each:</p>\n\n<pre><code>start_date = (Date.today - 90)\nend_date = Date.today\nstart_validation = Date.parse('25-12-2000')\nend_validation = Date.parse('25-12-2020')\nstart_date &gt; start_validation &amp;&amp; end_date &lt; end_validation\n</code></pre>\n\n<p>I'm not sure the naming's ideal and you could trim this down to one line if you wanted, but hopefully this serves for illustrative purposes. Also, you might want to use <code>&gt;=</code> and <code>&lt;=</code> though I'm not sure of whether the dates are inclusive.</p>\n\n<p>This would avoid any potentially expensive loops.</p>\n\n<p>Hope that helps - let me know how you get on or if you have any questions!</p>\n"}, {"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1529397056, "last_edit_date": 1529397056, "creation_date": 1529396723, "answer_id": 50923803, "question_id": 50923294, "link": "https://stackoverflow.com/questions/50923294/how-to-check-if-a-date-range-is-in-between-another-date-range-in-ruby/50923803#50923803", "title": "How to check if a date range is in between another date range in Ruby", "body": "<p>When you have two ranges <code>A = (a..b)</code> and <code>B = (y..z)</code> and want to know if <code>B</code> is fully covered by <code>A</code> then you can just ask if:</p>\n\n<pre><code>a &lt;= y &amp;&amp; z &lt;= b\n</code></pre>\n\n<p>No need to build the ranges upfront.</p>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 5, "last_activity_date": 1529397094, "last_edit_date": 1529397094, "creation_date": 1529396736, "answer_id": 50923811, "question_id": 50923294, "link": "https://stackoverflow.com/questions/50923294/how-to-check-if-a-date-range-is-in-between-another-date-range-in-ruby/50923811#50923811", "title": "How to check if a date range is in between another date range in Ruby", "body": "<p>You could use <a href=\"http://ruby-doc.org/core-2.5.1/Range.html#method-i-cover-3F\" rel=\"noreferrer\"><code>cover?</code></a> to check if the date range covers both values:</p>\n\n<pre><code>range = Date.new(2000, 12, 25)..Date.new(2020, 12, 25)\n\nrange.cover?(Date.today - 90) &amp;&amp; range.cover?(Date.today)\n#=&gt; true\n</code></pre>\n\n<p>or use <a href=\"http://ruby-doc.org/core-2.5.1/Range.html#method-i-begin\" rel=\"noreferrer\"><code>begin</code></a> and <a href=\"http://ruby-doc.org/core-2.5.1/Range.html#method-i-end\" rel=\"noreferrer\"><code>end</code></a> if you have two ranges:</p>\n\n<pre><code>range = Date.new(2000, 12, 25)..Date.new(2020, 12, 25)\nother = (Date.today - 90)..Date.today\n\nrange.cover?(other.begin) &amp;&amp; range.cover?(other.end)\n#=&gt; true\n</code></pre>\n"}], "owner": {"reputation": 758, "user_id": 5492840, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/bfe55a8ddf408a0543478a9c42a0fae0?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Goodall", "link": "https://stackoverflow.com/users/5492840/danny-goodall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1577, "favorite_count": 1, "accepted_answer_id": 50923811, "answer_count": 3, "score": 2, "last_activity_date": 1529397141, "creation_date": 1529394920, "last_edit_date": 1529395915, "question_id": 50923294, "link": "https://stackoverflow.com/questions/50923294/how-to-check-if-a-date-range-is-in-between-another-date-range-in-ruby", "title": "How to check if a date range is in between another date range in Ruby", "body": "<p>So I have a date range which may be something like <code>((Date.today - 90)..Date.today)</code> and I want to check to see whether <code>(Date.today - 90)</code> is after the first value in another date range, and <code>Date.today</code> is before the final value in a date range. I've tried the following below</p>\n\n<pre><code>((Date.parse('25-12-2000')..(Date.parse('25-12-2020')).include?((Date.today - 90)..Date.today)\n</code></pre>\n\n<p>This returns false. I also get false if I replace <code>include?</code> with <code>member?</code> or <code>cover?</code></p>\n\n<p>How do I get this to return true? Syntax change or do I need to use a different method in Ruby?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 3, "creation_date": 1529394683, "post_id": 50923118, "comment_id": 88845665, "body": "Please show what you want to do (typically, input and output) rather than showing a code that you are not sure."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1529398855, "post_id": 50923118, "comment_id": 88848064, "body": "Instead of asking how to implement an attempted solution (dynamic code generation) you should ask about your actual problem. What is your code supposed to do? Maybe a <code>case</code> expression isn&#39;t the right tool in the first place. What do you mean by <i>&quot;actual code is more complex&quot;</i>? Describe your problem, please."}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1529407653, "post_id": 50923118, "comment_id": 88853513, "body": "as @Stefan said, you could just do <code>ranges.find { |r| r.cover?(n) }&amp;.first</code>"}], "answers": [{"tags": [], "owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "is_accepted": false, "score": 4, "last_activity_date": 1529394943, "creation_date": 1529394943, "answer_id": 50923303, "question_id": 50923118, "link": "https://stackoverflow.com/questions/50923118/each-loop-inside-case-for-ruby/50923303#50923303", "title": "Each loop inside Case for Ruby", "body": "<p>If i get your question right, then you can forget <code>case</code> statement and do it using <a href=\"https://ruby-doc.org/core-2.5.1/Enumerable.html\" rel=\"nofollow noreferrer\">detect</a>:</p>\n\n<pre><code>ary = [1..3, 4..6, 7..20, 21..38]\n\nnum = 15    # say\n\nary.detect { |sub_ary| sub_ary.include?(num) }\n =&gt; 7..20\n\nary.detect { |sub_ary| sub_ary.include?(num) }.first     # call `first` on result of above, which is a range, to get the first element.\n =&gt; 7\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1529395926, "post_id": 50923377, "comment_id": 88846344, "body": "SO needs to support adding reactions. This one would get a :heart: :)."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 1, "creation_date": 1529396474, "post_id": 50923377, "comment_id": 88846663, "body": "@JagdeepSingh like this: \u2764?"}, {"owner": {"reputation": 1321, "user_id": 2422068, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/608060c57e57d2a4989c6b82a8a1f289?s=128&d=identicon&r=PG", "display_name": "Kartikey Tanna", "link": "https://stackoverflow.com/users/2422068/kartikey-tanna"}, "edited": false, "score": 0, "creation_date": 1529408210, "post_id": 50923377, "comment_id": 88853807, "body": "@mudasobwa Why <code>*ranges</code> and not just <code>ranges</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 1321, "user_id": 2422068, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/608060c57e57d2a4989c6b82a8a1f289?s=128&d=identicon&r=PG", "display_name": "Kartikey Tanna", "link": "https://stackoverflow.com/users/2422068/kartikey-tanna"}, "edited": false, "score": 1, "creation_date": 1529412428, "post_id": 50923377, "comment_id": 88856443, "body": "@KartikeyTanna for explicity. Join hides the difference, but the proper array should not be nested."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 3, "last_activity_date": 1529395149, "creation_date": 1529395149, "answer_id": 50923377, "question_id": 50923118, "link": "https://stackoverflow.com/questions/50923118/each-loop-inside-case-for-ruby/50923377#50923377", "title": "Each loop inside Case for Ruby", "body": "<p>Just out of curiosity:</p>\n\n<pre><code>number = 5\ninstance_eval [\n  \"case number\",\n  *ranges.map { |r| \"when #{r} then (#{r}).first\" },\n  \"end\"\n].join($/)\n#\u21d2\u00a04\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 1, "last_activity_date": 1529415143, "last_edit_date": 1529415143, "creation_date": 1529396896, "answer_id": 50923858, "question_id": 50923118, "link": "https://stackoverflow.com/questions/50923118/each-loop-inside-case-for-ruby/50923858#50923858", "title": "Each loop inside Case for Ruby", "body": "<p>In addition to <em>#detect</em> (or <em>#find</em>) with <em>#include?</em> from <a href=\"https://stackoverflow.com/a/50923303/3982562\">Jagdeep Singhs answer</a> you can also use the case equality operator (<a href=\"https://ruby-doc.org/core/Range.html#method-i-3D-3D-3D\" rel=\"nofollow noreferrer\"><code>Range#===</code></a>). This operator is used by the case statement to compare the input value with the scenario's you're providing.</p>\n\n<pre><code>ranges.find { |range| range === n }.first\n</code></pre>\n\n<p>Keep in mind both <em>#detect</em> and <em>#find</em> return <code>nil</code> if no value can be found. This means you might want to use the safe navigation operator (<code>}&amp;.first</code>) to prevent a no method exception of <em>#first</em> on <code>nil</code> if the value can't be found.</p>\n"}, {"tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": false, "score": 0, "last_activity_date": 1529408341, "creation_date": 1529408341, "answer_id": 50927513, "question_id": 50923118, "link": "https://stackoverflow.com/questions/50923118/each-loop-inside-case-for-ruby/50927513#50927513", "title": "Each loop inside Case for Ruby", "body": "<p>Well, this works, but is kind of pointless and thread unsafe:</p>\n\n<pre><code>def get_range(n)\n  ranges = [1..3,4..6,7..20,21..38]\n\n  case n\n  when 3\n    # special case\n    199\n  when -&gt;(x) { @_get_range = ranges.find { |r| r.cover?(x) } }\n    @_get_range.first\n  else\n    0\n  end\nensure\n  remove_instance_variable(:@_get_range) if instance_variable_defined?(:@_get_range)\nend\n\nget_range(3) # =&gt; 199\nget_range(5) # =&gt; 4\nget_range(50) # =&gt; 0\n</code></pre>\n\n<p>You could just do:</p>\n\n<pre><code>ranges.find { |r| r.cover?(n) }&amp;.first || 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1529412782, "creation_date": 1529412782, "answer_id": 50928973, "question_id": 50923118, "link": "https://stackoverflow.com/questions/50923118/each-loop-inside-case-for-ruby/50928973#50928973", "title": "Each loop inside Case for Ruby", "body": "<p>My two cents..</p>\n\n<pre><code>ranges = [1..3,4..6,7..20,21..38]\n\nnum = 15\n\nranges.bsearch { |range| range.member? num }.begin\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 6191938, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/24b8dc9249ff5f196453f4730fcf80de?s=128&d=identicon&r=PG&f=1", "display_name": "Mason", "link": "https://stackoverflow.com/users/6191938/mason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 300, "favorite_count": 0, "answer_count": 5, "score": 1, "last_activity_date": 1529415143, "creation_date": 1529394281, "last_edit_date": 1529408698, "question_id": 50923118, "link": "https://stackoverflow.com/questions/50923118/each-loop-inside-case-for-ruby", "title": "Each loop inside Case for Ruby", "body": "<p>I'm trying to dynamically generate a case statement based on an array of values. For example let's say I have an array of ranges</p>\n\n<p><code>[1..3,4..6,7..20,21..38]</code></p>\n\n<p>and I want to write a dynamic case statement that returns the first number of whatever range </p>\n\n<pre><code>case n\n  ranges.each do |r|\n  when r\n    r.first\n  end\nend\n</code></pre>\n\n<p>Is this possible, or will I have to find another way to do it (my actual code is more complex)?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "class", "autoload"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1529393350, "post_id": 50922777, "comment_id": 88844913, "body": "The constant is resolved upon assignment. It&#39;s like <code>A = 1; hash[&#39;a&#39;] = A; A = 2</code> \u2013 constant and hash are referring to different objects afterwards. Adding <code>::</code> doesn&#39;t change anything."}, {"owner": {"reputation": 14224, "user_id": 433940, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6b9f0021f63ca2fb96c0e50f422e0489?s=128&d=identicon&r=PG", "display_name": "linkyndy", "link": "https://stackoverflow.com/users/433940/linkyndy"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1529393608, "post_id": 50922777, "comment_id": 88845049, "body": "I understand. Then how can I overcome to error mentioned in my question?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1529393742, "post_id": 50922777, "comment_id": 88845121, "body": "Either by storing the constant&#39;s name and using <code>const_get</code> / <code>constantize</code> (which is what you try to avoid) or by using a proc, e.g. <code>@hash[&#39;foo&#39;] = -&gt; { Baz }</code> which can be dynamically resolved via <code>@hash[&#39;foo&#39;].call</code>"}, {"owner": {"reputation": 14224, "user_id": 433940, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6b9f0021f63ca2fb96c0e50f422e0489?s=128&d=identicon&r=PG", "display_name": "linkyndy", "link": "https://stackoverflow.com/users/433940/linkyndy"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1529394661, "post_id": 50922777, "comment_id": 88845653, "body": "Looks pretty fair. Can you submit it as the answer? I would love to accept it!"}], "answers": [{"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 5, "last_activity_date": 1529399505, "last_edit_date": 1529399505, "creation_date": 1529395118, "answer_id": 50923368, "question_id": 50922777, "link": "https://stackoverflow.com/questions/50922777/dynamically-resolve-class-to-global-scope/50923368#50923368", "title": "Dynamically resolve class to global scope", "body": "<p>When assigning a constant to a hash, the constant is resolved upon assignment: (not hash specific, this is just how constants work)</p>\n\n<pre><code>hash = {}\nA = 1\nhash[:a] = A\n#=&gt; 1          # &lt;- 1 is being assigned, not A\n\nA = 2\nhash[:a]\n#=&gt; 1\n</code></pre>\n\n<p>One way to solve it is to store the constant's name:</p>\n\n<pre><code>hash = {}\nA = 1\nhash[:a] = 'A'\n#=&gt; 'A'\n</code></pre>\n\n<p>and to resolve it via <a href=\"http://ruby-doc.org/core-2.5.1/Module.html#method-i-const_get\" rel=\"nofollow noreferrer\"><code>const_get</code></a> / <a href=\"http://api.rubyonrails.org/classes/String.html#method-i-constantize\" rel=\"nofollow noreferrer\"><code>constantize</code></a>:</p>\n\n<pre><code>A = 2\nObject.const_get(hash[:a])\n#=&gt; 2\n</code></pre>\n\n<p>This also works for nested constants:</p>\n\n<pre><code>hash[:pi] = 'Math::PI'\nObject.const_get(hash[:pi])\n#=&gt; 3.141592653589793\n</code></pre>\n\n<p>If your object happens to be a named class (or module), you can retrieve its name via <a href=\"http://ruby-doc.org/core-2.5.1/Module.html#method-i-name\" rel=\"nofollow noreferrer\"><code>Module#name</code></a>:</p>\n\n<pre><code>hash[:lazy_enum] = Enumerator::Lazy.name\n#=&gt; \"Enumerator::Lazy\"\n\nObject.const_get(hash[:lazy_enum])\n#=&gt; Enumerator::Lazy\n</code></pre>\n\n<p>A different approach is to use a <a href=\"http://ruby-doc.org/core-2.5.1/Proc.html\" rel=\"nofollow noreferrer\">proc</a> which references the constant in its block:</p>\n\n<pre><code>hash = {}\nA = 1\nhash[:a] = -&gt; { A }\n#=&gt; #&lt;Proc:0x00007fc4ba05f510@(irb):10 (lambda)&gt;\n</code></pre>\n\n<p>the constant will be resolved when invoking the block:</p>\n\n<pre><code>A = 2\nhash[:a].call\n#=&gt; 2\n</code></pre>\n"}], "owner": {"reputation": 14224, "user_id": 433940, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6b9f0021f63ca2fb96c0e50f422e0489?s=128&d=identicon&r=PG", "display_name": "linkyndy", "link": "https://stackoverflow.com/users/433940/linkyndy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 50923368, "answer_count": 1, "score": 2, "last_activity_date": 1529399505, "creation_date": 1529393153, "last_edit_date": 1529394787, "question_id": 50922777, "link": "https://stackoverflow.com/questions/50922777/dynamically-resolve-class-to-global-scope", "title": "Dynamically resolve class to global scope", "body": "<p>I need to save a reference of a class to a hash:</p>\n\n<pre><code>@hash['foo'] = bar if bar.is_a?(Class)\n</code></pre>\n\n<p>The above piece of code lives in my <code>/lib</code> directory, it is not autoloaded every time, and <code>bar</code> is usually an autoloaded class. In order to avoid getting the \"A copy of xxx has been removed from the module tree but is still active\" error when I <code>reload!</code> my code, I am trying to resolve <code>bar</code> to the global scope, i.e.: add <code>::</code> before the class name (<code>Baz</code> is becoming <code>::Baz</code>).</p>\n\n<p>I am not sure how I can dynamically perform this <strong>without</strong> converting the class to a string, prepending <code>::</code>, and then converting it back to a class.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 24729, "user_id": 2564200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a92dfcc9fcac72dabd4b1eefa0b5106e?s=128&d=identicon&r=PG&f=1", "display_name": "Santhosh", "link": "https://stackoverflow.com/users/2564200/santhosh"}, "edited": false, "score": 0, "creation_date": 1529393166, "post_id": 50922713, "comment_id": 88844807, "body": "While defining model relationship, you can specify the foreign_key. Refer <a href=\"http://guides.rubyonrails.org/association_basics.html#options-for-belongs-to-foreign-key\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/&hellip;</a>"}, {"owner": {"reputation": 81, "user_id": 6929917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf56bd426d4ad31869d26e913ab0b5c?s=128&d=identicon&r=PG&f=1", "display_name": "Sdadad", "link": "https://stackoverflow.com/users/6929917/sdadad"}, "reply_to_user": {"reputation": 24729, "user_id": 2564200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a92dfcc9fcac72dabd4b1eefa0b5106e?s=128&d=identicon&r=PG&f=1", "display_name": "Santhosh", "link": "https://stackoverflow.com/users/2564200/santhosh"}, "edited": false, "score": 0, "creation_date": 1529393257, "post_id": 50922713, "comment_id": 88844857, "body": "can explain more ? Thanks @Santhosh"}, {"owner": {"reputation": 24729, "user_id": 2564200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a92dfcc9fcac72dabd4b1eefa0b5106e?s=128&d=identicon&r=PG&f=1", "display_name": "Santhosh", "link": "https://stackoverflow.com/users/2564200/santhosh"}, "edited": false, "score": 0, "creation_date": 1529393463, "post_id": 50922713, "comment_id": 88844973, "body": "You should define the relationship like <code>belongs_to :user, foreign_key: &quot;nameofwatch&quot;</code>. For more details, refer the link"}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "reply_to_user": {"reputation": 24729, "user_id": 2564200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a92dfcc9fcac72dabd4b1eefa0b5106e?s=128&d=identicon&r=PG&f=1", "display_name": "Santhosh", "link": "https://stackoverflow.com/users/2564200/santhosh"}, "edited": false, "score": 1, "creation_date": 1529393649, "post_id": 50922713, "comment_id": 88845071, "body": "@Santhosh foreign_key alone won&#39;t cut it in this case, he will need to add primary_key as well, otherwise it will use it&#39;s id in <code>nameofwatch</code>."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 6929917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf56bd426d4ad31869d26e913ab0b5c?s=128&d=identicon&r=PG&f=1", "display_name": "Sdadad", "link": "https://stackoverflow.com/users/6929917/sdadad"}, "edited": false, "score": 0, "creation_date": 1529393992, "post_id": 50922903, "comment_id": 88845283, "body": "this enough or add migration ?"}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "reply_to_user": {"reputation": 81, "user_id": 6929917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf56bd426d4ad31869d26e913ab0b5c?s=128&d=identicon&r=PG&f=1", "display_name": "Sdadad", "link": "https://stackoverflow.com/users/6929917/sdadad"}, "edited": false, "score": 0, "creation_date": 1529394082, "post_id": 50922903, "comment_id": 88845338, "body": "your problem statement doesn&#39;t give much details about what you already have or what you want to achieve. This answer just targets about how to setup the associations in that way."}, {"owner": {"reputation": 81, "user_id": 6929917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf56bd426d4ad31869d26e913ab0b5c?s=128&d=identicon&r=PG&f=1", "display_name": "Sdadad", "link": "https://stackoverflow.com/users/6929917/sdadad"}, "edited": false, "score": 0, "creation_date": 1529394239, "post_id": 50922903, "comment_id": 88845429, "body": "yes Know this solution is well but necessary add add details like migration"}, {"owner": {"reputation": 81, "user_id": 6929917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf56bd426d4ad31869d26e913ab0b5c?s=128&d=identicon&r=PG&f=1", "display_name": "Sdadad", "link": "https://stackoverflow.com/users/6929917/sdadad"}, "edited": false, "score": 0, "creation_date": 1529394556, "post_id": 50922903, "comment_id": 88845593, "body": "want to join with that column in both the tables. you write this down this in model?"}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "reply_to_user": {"reputation": 81, "user_id": 6929917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf56bd426d4ad31869d26e913ab0b5c?s=128&d=identicon&r=PG&f=1", "display_name": "Sdadad", "link": "https://stackoverflow.com/users/6929917/sdadad"}, "edited": false, "score": 0, "creation_date": 1529394631, "post_id": 50922903, "comment_id": 88845633, "body": "Not able to comprehend well, but yes, the associations go in models"}], "tags": [], "owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "is_accepted": true, "score": 0, "last_activity_date": 1529393844, "last_edit_date": 1529393844, "creation_date": 1529393535, "answer_id": 50922903, "question_id": 50922713, "link": "https://stackoverflow.com/questions/50922713/specific-association-of-two-model-contains-same-name/50922903#50922903", "title": "Specific association of two model contains same name", "body": "<p>Set adequate <a href=\"http://guides.rubyonrails.org/association_basics.html#options-for-belongs-to-primary-key\" rel=\"nofollow noreferrer\"><code>primary_key</code></a> and <a href=\"http://guides.rubyonrails.org/association_basics.html#options-for-belongs-to-foreign-key\" rel=\"nofollow noreferrer\"><code>foreign-key</code></a>. In your case, both will be <code>nameofwatch</code>, since you want to join with that column in both the tables.</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  # use primary key of user as nameofwatch, and foreign key as nameofwatch in speed\n  has_many :speeds, foreign_key: 'nameofwatch', primary_key: 'nameofwatch'\nend\n\nclass Speed &lt; ApplicationRecord\n  belongs_to :user, foreign_key: 'nameofwatch', primary_key: 'nameofwatch'\nend\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 6929917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf56bd426d4ad31869d26e913ab0b5c?s=128&d=identicon&r=PG&f=1", "display_name": "Sdadad", "link": "https://stackoverflow.com/users/6929917/sdadad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 50922903, "answer_count": 1, "score": 0, "last_activity_date": 1529393844, "creation_date": 1529392947, "last_edit_date": 1529393531, "question_id": 50922713, "link": "https://stackoverflow.com/questions/50922713/specific-association-of-two-model-contains-same-name", "title": "Specific association of two model contains same name", "body": "<p>I have two  model <code>User</code> &amp; <code>Speed</code>  . User has many speed </p>\n\n<p>User contain <code>username, email, password, nameofwatch</code> </p>\n\n<p>Speed contain <code>nameofwatch, speed, userid</code> </p>\n\n<p>can associate between two model by  <code>nameofwatch</code>.</p>\n\n<p>If nameofwatch in user = nameofwatch in speed </p>\n\n<p><strong>appear current_user value of speed</strong></p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "vue.js", "webpacker"], "comments": [{"owner": {"reputation": 105, "user_id": 9852976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50e25a8501d8ffcac2d597a97d9e5149?s=128&d=identicon&r=PG&f=1", "display_name": "NathanB", "link": "https://stackoverflow.com/users/9852976/nathanb"}, "edited": false, "score": 0, "creation_date": 1529386926, "post_id": 50921269, "comment_id": 88842004, "body": "To be clear, I&#39;m not trying to build a public api. I&#39;m just trying to use Vue to build a search feature on my app."}, {"owner": {"reputation": 581, "user_id": 978055, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7fc18f8c1a8d3834a271737f76bfa855?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/978055/alex"}, "edited": false, "score": 0, "creation_date": 1529393740, "post_id": 50921269, "comment_id": 88845118, "body": "Maybe you could retrieve the existing cookies with js-cookie and pass it along with the fetch?"}, {"owner": {"reputation": 105, "user_id": 9852976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50e25a8501d8ffcac2d597a97d9e5149?s=128&d=identicon&r=PG&f=1", "display_name": "NathanB", "link": "https://stackoverflow.com/users/9852976/nathanb"}, "reply_to_user": {"reputation": 674, "user_id": 2102906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vo97X.jpg?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/2102906/ruslan"}, "edited": false, "score": 1, "creation_date": 1529423903, "post_id": 50921269, "comment_id": 88863754, "body": "@Ruslan,Oh yeah that was the issue. WHy does fetch do that? If you make your comment an answer, I&#39;ll accept it."}], "answers": [{"tags": [], "owner": {"reputation": 674, "user_id": 2102906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vo97X.jpg?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/2102906/ruslan"}, "is_accepted": true, "score": 0, "last_activity_date": 1529426433, "creation_date": 1529426433, "answer_id": 50933206, "question_id": 50921269, "link": "https://stackoverflow.com/questions/50921269/vue-and-rails-share-cookie/50933206#50933206", "title": "Vue and rails: Share cookie", "body": "<p><code>fetch</code> does not send cookies by default.</p>\n\n<p>You need to include credentials:</p>\n\n<pre><code>fetch(\"/search?q=\" + this.q, {\n  credentials: 'same-origin'\n})\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 9852976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50e25a8501d8ffcac2d597a97d9e5149?s=128&d=identicon&r=PG&f=1", "display_name": "NathanB", "link": "https://stackoverflow.com/users/9852976/nathanb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 50933206, "answer_count": 1, "score": 0, "last_activity_date": 1529426433, "creation_date": 1529386736, "question_id": 50921269, "link": "https://stackoverflow.com/questions/50921269/vue-and-rails-share-cookie", "title": "Vue and rails: Share cookie", "body": "<p>I have a Rails 5.2 app with webpacker and Vue. My Rails app is using devise for authentication. I'm doing the following:</p>\n\n<pre><code>fetch(\"/search?q=\" + this.q)\n  .then(function(result) {\n    console.log(result)\n  })\n  .catch(function() {\n\n  });\n</code></pre>\n\n<p>which hits the right controller. However, the request gets redirected due to <code>before_action :authenticate_user!</code> in my Search controller.</p>\n\n<p>I could implement JWT or some kind of authentication between the frontend and backend, but is there not a way to share a cookie in development? Unless I'm mistaken, when webpacker is in production, the code will get bundled inside my rails app, and then there wouldn't be a need for JWT.</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 850, "user_id": 3894119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fbc11920a94562910843e3c6c39ddf31?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Aldo", "link": "https://stackoverflow.com/users/3894119/andy-aldo"}, "edited": false, "score": 0, "creation_date": 1529382945, "post_id": 50920703, "comment_id": 88840876, "body": "is it safe to assume that the 2 arrays have the same length? @Op"}, {"owner": {"reputation": 850, "user_id": 3894119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fbc11920a94562910843e3c6c39ddf31?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Aldo", "link": "https://stackoverflow.com/users/3894119/andy-aldo"}, "edited": false, "score": 0, "creation_date": 1529383705, "post_id": 50920703, "comment_id": 88841067, "body": "did you try printing the output on each for loop, my guess is that at the last iteration, one of the array is already looped and resulting you comparing a number with a nil value"}], "answers": [{"tags": [], "owner": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "is_accepted": false, "score": 1, "last_activity_date": 1529383816, "creation_date": 1529383816, "answer_id": 50920829, "question_id": 50920703, "link": "https://stackoverflow.com/questions/50920703/merge-two-ordered-arrays-into-one-ordered-array/50920829#50920829", "title": "Merge two ordered arrays into one ordered array", "body": "<p>Here's one way you can write <code>merge</code> using recursion. Note, as you specified, both inputs must already be sorted otherwise the output will be invalid. The inputs can vary in size.</p>\n\n<pre><code>def merge (xs, ys)\n  if xs.empty?\n    ys\n  elsif ys.empty?\n    xs\n  else\n    x, *_xs = xs\n    y, *_ys = ys\n    if x &lt; y\n      [x] + (merge _xs, ys)\n    else\n      [y] + (merge xs, _ys)\n    end\n  end\nend\n\nmerge [ 1, 3, 4, 6, 8, 9 ], [ 0, 2, 5, 7 ]\n# =&gt; [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 ]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 3, "creation_date": 1529386403, "post_id": 50921117, "comment_id": 88841835, "body": "I guess the OP is looking for an O(n) algorithm. If the arrays are really short, as in the example, I wouldn&#39;t waste energy to write a merge-algorithm, but if they are longer, it might be worth the effort."}], "tags": [], "owner": {"reputation": 41, "user_id": 3568549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecc73e75741a8888207b1a72cb7a01ab?s=128&d=identicon&r=PG", "display_name": "Robin", "link": "https://stackoverflow.com/users/3568549/robin"}, "is_accepted": false, "score": 4, "last_activity_date": 1529385777, "creation_date": 1529385777, "answer_id": 50921117, "question_id": 50920703, "link": "https://stackoverflow.com/questions/50920703/merge-two-ordered-arrays-into-one-ordered-array/50921117#50921117", "title": "Merge two ordered arrays into one ordered array", "body": "<p>Maybe I am missing the point but you can do:</p>\n\n<pre><code>(array_one + array_two).sort\n=&gt; [1, 3, 4, 5, 7, 8]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "is_accepted": false, "score": 0, "last_activity_date": 1529388767, "creation_date": 1529388767, "answer_id": 50921680, "question_id": 50920703, "link": "https://stackoverflow.com/questions/50920703/merge-two-ordered-arrays-into-one-ordered-array/50921680#50921680", "title": "Merge two ordered arrays into one ordered array", "body": "<p>Assuming you have two sorted arrays. You need to create pipeline using recursion going to crunch through each array. checking at each iteration to see\nwhich value at <strong>index</strong> <code>0</code> of either array is lower, removing that from the array and appending that value to the <code>result</code> array.</p>\n\n<pre><code>def merge_arrays(a, b)\n  # build a holder array that is the size of both input arrays O(n) space\n  result = []\n\n  # get lower head value\n  if a[0] &lt; b[0]\n    result &lt;&lt; a.shift\n  else\n    result &lt;&lt; b.shift\n  end\n\n  # check to see if either array is empty\n  if a.length == 0\n    return result + b\n  elsif b.length == 0\n    return result + a\n  else\n    return result + merge_arrays(a, b)\n  end\nend \n\n&gt; a = [3, 4, 6, 10, 11, 15]\n&gt; b = [1, 5, 8, 12, 14, 19]\n&gt; merge_arrays(a, b)\n#=&gt; [1, 3, 4, 5, 6, 8, 10, 11, 12, 14, 15, 19]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1529394877, "post_id": 50922396, "comment_id": 88845771, "body": "I had thought of the same thing, but the expected error (argument error) does not match what the OP reports (no method error). It might have been the OP&#39;s mistake to report the wrong error."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1529395231, "post_id": 50922396, "comment_id": 88845957, "body": "@sawa it&#39;s either <code>NoMethodError</code> or <code>ArgumentError</code>, depending on the actual values."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 2, "last_activity_date": 1529391727, "creation_date": 1529391727, "answer_id": 50922396, "question_id": 50920703, "link": "https://stackoverflow.com/questions/50920703/merge-two-ordered-arrays-into-one-ordered-array/50922396#50922396", "title": "Merge two ordered arrays into one ordered array", "body": "<blockquote>\n  <p>I am getting an error 'undefined method `&lt;' for nil:NilClass'. I don't understand how the conditional is receiving this.</p>\n</blockquote>\n\n<p>You start by comparing index 0 to index 0:</p>\n\n<pre><code>[3, 4, 8]   [1, 5, 7]\n 0-----------0          #=&gt; 3 &lt; 1\n</code></pre>\n\n<p>Then you increment the lower value's index by 1:</p>\n\n<pre><code>[3, 4, 8]   [1, 5, 7]\n 0--------------1       #=&gt; 3 &lt; 5\n</code></pre>\n\n<p>And so on:</p>\n\n<pre><code>[3, 4, 8]   [1, 5, 7]\n    1-----------1       #=&gt; 4 &lt; 5\n\n[3, 4, 8]   [1, 5, 7]\n       2--------1       #=&gt; 8 &lt; 5\n\n[3, 4, 8]   [1, 5, 7]\n       2-----------2    #=&gt; 8 &lt; 7\n</code></pre>\n\n<p>At that point you get:</p>\n\n<pre><code>[3, 4, 8]   [1, 5, 7]\n       2--------------3 #=&gt; 8 &lt; nil\n</code></pre>\n\n<p>Index 3 is outside the array's bounds, so <code>array_two[current_index_on_two]</code> returns <code>nil</code> and:</p>\n\n<pre><code>if array_one[current_index_on_one] &lt; array_two[current_index_on_two]\n  # ...\nend\n</code></pre>\n\n<p>becomes</p>\n\n<pre><code>if 8 &lt; nil\n  # ...\nend\n</code></pre>\n\n<p>resulting in <code>ArgumentError(comparison of Integer with nil failed)</code>. If <code>nil</code> is on the left hand side, you'd get <code>NoMethodError (undefined method `&lt;' for nil:NilClass)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1529402163, "last_edit_date": 1529402163, "creation_date": 1529395138, "answer_id": 50923372, "question_id": 50920703, "link": "https://stackoverflow.com/questions/50920703/merge-two-ordered-arrays-into-one-ordered-array/50923372#50923372", "title": "Merge two ordered arrays into one ordered array", "body": "<p>I made slight changes to your code in order to make it work. See the comments inside.</p>\n\n<pre><code>array_one = [2, 3, 4, 8, 10, 11, 12, 13, 15]\narray_two = [1, 5, 6, 7, 9, 14]\n\ndef merge_arrays(array_one, array_two) \n  array_one, array_two = array_two, array_one if array_one.length &gt; array_two.length # (1) swap arrays to make satement (3) work, need array_two always be the longest\n  merged_array_size = array_one.length + array_two.length\n  merged_array = []\n\n  current_index_on_one = 0\n  current_index_on_two = 0\n  current_merged_index = 0\n\n  for i in (0...merged_array_size-1) # (2) three points to avoid the error\n    if (!array_one[current_index_on_one].nil? &amp;&amp; array_one[current_index_on_one] &lt; array_two[current_index_on_two]) # (3) check also if array_one is nil\n      merged_array[current_merged_index] = array_one[current_index_on_one]\n      current_index_on_one += 1\n      current_merged_index += 1\n    else\n      merged_array[current_merged_index] = array_two[current_index_on_two]\n      current_index_on_two += 1\n      current_merged_index += 1\n    end\n  end\n  merged_array[current_merged_index] = array_one[current_index_on_one] || array_two[current_index_on_two] # (4) add the missing element at the end of the loop, looks what happen if you comment out this line\n  return merged_array\nend\n\np merge_arrays(array_one, array_two)\n# =&gt; [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]\n</code></pre>\n\n<p>The error was coming because the loop was making one step over. The solution is to stop before and insert the missing element at the end of the loop.</p>\n\n<p>It works also with:</p>\n\n<pre><code># for i in (1...merged_array_size)\n# and\n# for i in (1..merged_array_size-1)\n# and\n# (merged_array_size-1).times do\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1540597477, "creation_date": 1540597477, "answer_id": 53017513, "question_id": 50920703, "link": "https://stackoverflow.com/questions/50920703/merge-two-ordered-arrays-into-one-ordered-array/53017513#53017513", "title": "Merge two ordered arrays into one ordered array", "body": "<pre><code>arr1 = [3, 4, 8,  9, 12]\narr2 = [1, 5, 7,  8, 13]\n\narr = [arr1, arr2]\nidx = [0, 0]\n\n(arr1.size + arr2.size).times.with_object([]) do |_,a|\n  imin = [0, 1].min_by { |i| arr[i][idx[i]] || Float::INFINITY }\n  a &lt;&lt; arr[imin][idx[imin]]\n  idx[imin] += 1\nend\n  #=&gt; [1, 3, 4, 5, 7, 8, 8, 9, 12, 13]\n</code></pre>\n"}], "owner": {"reputation": 503, "user_id": 5057085, "user_type": "registered", "accept_rate": 26, "profile_image": "https://i.stack.imgur.com/hDmH7.jpg?s=128&g=1", "display_name": "Coder_Nick", "link": "https://stackoverflow.com/users/5057085/coder-nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "answer_count": 6, "score": 1, "last_activity_date": 1540597477, "creation_date": 1529382841, "question_id": 50920703, "link": "https://stackoverflow.com/questions/50920703/merge-two-ordered-arrays-into-one-ordered-array", "title": "Merge two ordered arrays into one ordered array", "body": "<p>I am writing a method that takes two sorted arrays and I want it to return a merged array with all the values sorted. Given the two arrays below:</p>\n\n<pre><code>array_one = [3, 4, 8]\narray_two = [1, 5, 7]\n</code></pre>\n\n<p>I want my merge_arrays method to return:</p>\n\n<pre><code>[1, 3, 4, 5, 7, 8]\n</code></pre>\n\n<p>My current algorithm is below:</p>\n\n<pre><code>def merge_arrays(array_one, array_two)\n  merged_array_size = array_one.length + array_two.length\n  merged_array = []\n\n  current_index_on_one = 0\n  current_index_on_two = 0\n  current_merged_index = 0\n\n  for i in (0..merged_array_size - 1)\n    if array_one[current_index_on_one] &lt; array_two[current_index_on_two]\n      merged_array[current_merged_index] = array_one[current_index_on_one]\n      current_index_on_one += 1\n      current_merged_index += 1\n    else\n      merged_array[current_merged_index] = array_two[current_index_on_two]\n      current_index_on_two += 1\n      current_merged_index += 1\n    end\n  end\n\n  return merged_array\nend\n</code></pre>\n\n<p>I am getting an error 'undefined method `&lt;' for nil:NilClass'. I don't understand how the conditional is receiving this. I debugged the variables in the conditionals and they are giving true or false values. I'm not sure what is causing this error.</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "performance"], "answers": [{"comments": [{"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 2, "creation_date": 1529379221, "post_id": 50919648, "comment_id": 88840103, "body": "Look up &quot;SQL EXPLAIN&quot;. The OP didn&#39;t state whether they use MySQL or PostgreSQL or Brand X, but there are EXPLAIN systems for all databases. And ActiveRecord supports them with the .explain method. EXPLAIN interrogates your database for the plan it will execute to solve a query, and it will specify which indices it will use, if any. The dreaded &quot;Table Scan&quot; will appear if the database won&#39;t use an index for some phase of the plan."}, {"owner": {"reputation": 45, "user_id": 3867065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c98bb09c2d9232edecf197fa9a35189b?s=128&d=identicon&r=PG&f=1", "display_name": "hlove", "link": "https://stackoverflow.com/users/3867065/hlove"}, "edited": false, "score": 0, "creation_date": 1529812214, "post_id": 50919648, "comment_id": 89006841, "body": "@Philip, I am using PostgreSQL.  Thank you for bringing &quot;SQL EXPLAIN&quot; to my attention as I was not aware of it before."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 6, "last_activity_date": 1529373459, "creation_date": 1529373459, "answer_id": 50919648, "question_id": 50919320, "link": "https://stackoverflow.com/questions/50919320/ruby-on-rails-website-is-slow-could-it-be-the-sql-queries/50919648#50919648", "title": "Ruby on Rails website is slow; could it be the SQL queries?", "body": "<p>I see two problems: a lack of SQL indexes, and too many calls to <code>Post.all</code>.</p>\n\n<p>Your slow queries involve <code>WHERE published = ?</code>. If <code>posts.published</code> is not indexed, this will have to scan the entire table, not just the published posts. You also tend to sort by <code>posts.published_at</code> and without an index this will also be slow.</p>\n\n<p>To fix this, add an index on <code>posts.published</code> and <code>posts.published_at</code> in a migration.</p>\n\n<pre><code>add_index(:posts, :published)\nadd_index(:posts, :published_at)\n</code></pre>\n\n<p>You can read more about indexes in the answers to <a href=\"https://stackoverflow.com/questions/2955459/what-is-an-index-in-sql\">What is an index in SQL?</a></p>\n\n<hr>\n\n<p>Using <code>Post.all</code> or <code>Post.published</code> means loading every post from the database into memory. If you're not using them all, it's a huge waste of time.</p>\n\n<p>For example, it's unwieldy to display every post on your index and home pages. Instead you should use pagination to fetch and display only a page of posts at a time. There are gems for this such as <a href=\"https://github.com/kaminari/kaminari\" rel=\"noreferrer\">kaminari</a> and <a href=\"https://github.com/mislav/will_paginate\" rel=\"noreferrer\">will_paginate</a> as well as larger administrative solutions such as <a href=\"https://activeadmin.info/\" rel=\"noreferrer\">ActiveAdmin</a>. And if you don't like page links, if you look around you can find examples of using them for \"infinite scroll\".</p>\n\n<hr>\n\n<p>Finally, you can add caching. Since your site isn't going to update very frequently, you can cache at various levels. Have a read through <a href=\"http://guides.rubyonrails.org/caching_with_rails.html\" rel=\"noreferrer\">Caching with Rails: An Overview</a>.</p>\n\n<p>But caching brings its own problems. Consider if you need it <em>after</em> you do basic performance optimizations.</p>\n"}, {"comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1529812794, "post_id": 51006801, "comment_id": 89006907, "body": "Specifying every column but the one you want to avoid is difficult to maintain and does not work for other queries on <code>Post</code> such as <code>Post.find</code>. A better solution would be to split <code>body</code> into its own <code>PostBody</code> model and table with a <code>belongs_to</code> relationship to <code>Post</code>. Relationships are lazy loaded by default. Then <code>delegate :body, to: :post_body</code> to make it transparent. Yours is exactly the problem I had in one of my first jobs almost 20 years ago. :)"}], "tags": [], "owner": {"reputation": 45, "user_id": 3867065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c98bb09c2d9232edecf197fa9a35189b?s=128&d=identicon&r=PG&f=1", "display_name": "hlove", "link": "https://stackoverflow.com/users/3867065/hlove"}, "is_accepted": false, "score": 0, "last_activity_date": 1529812125, "creation_date": 1529812125, "answer_id": 51006801, "question_id": 50919320, "link": "https://stackoverflow.com/questions/50919320/ruby-on-rails-website-is-slow-could-it-be-the-sql-queries/51006801#51006801", "title": "Ruby on Rails website is slow; could it be the SQL queries?", "body": "<p>Schwern,</p>\n\n<p>Thank you for the pointers! With the help of your post, I was able to minimize the number of calls to <code>Post.all</code>.  These were killing my response time big time. I did not realize that calling <code>Post.all</code> loaded the all of the posts and their attributes to memory (it's a learning process haha).</p>\n\n<p>For places where I did not need to load every attribute of a post, I ended up doing <code>Post.select(\"attribute\")</code>.  For example, originally in the <code>home</code> method of the <code>PostsController</code>, I had:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>def home\n    @posts = Post.all.published.order('published_at DESC')\nend\n</code></pre>\n\n<p>Running <code>Post.all.published.order('published_at DESC')</code> in the rails console shows that this query takes approximately 4 seconds:</p>\n\n<p><a href=\"https://i.stack.imgur.com/iOrCh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iOrCh.png\" alt=\"Original &lt;code&gt;home&lt;/code&gt; method consumes a lot of time.\"></a></p>\n\n<p>Updating the home method to use <code>Post.select</code>, as opposed to <code>Post.all</code> (as shown below) significantly improved the response time of the query.</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>  def home\n    #SLOW: loads everything from a post\n    #@posts = Post.all.published.order('published_at DESC')\n    #FAST: only loads the necessary elements from a post, and does not waste time loading body (body = lots of data)\n    @posts = Post.select(\"id\", \"title\", \"description\", \"slug\", \"created_at\", \"updated_at\", \"image_file_name\", \"thumbnail_file_name\", \"published\", \"published_at\", \"date\").published.order('published_at DESC')\n  end\n</code></pre>\n\n<p>Running <code>@posts = Post.select(\"id\", \"title\", \"description\", \"slug\", \"created_at\", \"updated_at\", \"image_file_name\", \"thumbnail_file_name\", \"published\", \"published_at\", \"date\").published.order('published_at DESC')</code> in the rails console shows that this query takes approximately 2ms! Huge improvement! This is because I am not loading the <code>body</code> attribute, among other things of the post, which contain a lot of data, and thus consume a lot of time to load into memory.  No point of loading it into memory if you're not going to use it!</p>\n\n<p><a href=\"https://i.stack.imgur.com/n553V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n553V.png\" alt=\"Updated &lt;code&gt;home&lt;/code&gt; method shows much faster response time\"></a></p>\n\n<p>In a similar spirit, I was able to improve the performance of the other sections of code (see below for fixes) and ultimately make the website have significantly faster response times!</p>\n\n<p><strong>Controller fix:</strong>\n</p>\n\n<pre><code>class PostsController &lt; ApplicationController\n  #before_action :authenticate_user!\n  before_action :set_post, only: [:show, :edit, :update, :destroy, :publish, :unpublish]\n\n  def home\n    #SLOW: loads everything from a post\n    #@posts = Post.all.published.order('published_at DESC')\n    #FAST: only loads the necessary elements from a post, and does not waste time loading body (body = lots of data)\n    @posts = Post.select(\"id\", \"title\", \"description\", \"slug\", \"created_at\", \"updated_at\", \"image_file_name\", \"thumbnail_file_name\", \"published\", \"published_at\", \"date\").published.order('published_at DESC')\n  end\n\n  # GET /posts\n  # GET /posts.json\n  def index\n    if user_signed_in? and current_user.admin\n      #SLOW loads everything from a post\n      #@posts = Post.all.order(\"id\")\n      #FAST: only loads the necessary elements from a post, and does not waste time loading body (body = lots of data)\n      @posts = Post.select(\"id\", \"title\", \"description\", \"slug\", \"created_at\", \"updated_at\", \"image_file_name\", \"thumbnail_file_name\", \"published\", \"published_at\", \"date\").order('id')\n    else\n      #SLOW loads everything from a post\n      #@posts = Post.all.published\n      #FAST: only loads the necessary elements from a post, and does not waste time loading body (body = lots of data)\n      @posts = Post.select(\"id\", \"title\", \"description\", \"slug\", \"created_at\", \"updated_at\", \"image_file_name\", \"thumbnail_file_name\", \"published\", \"published_at\", \"date\").published\n    end\n  end\n</code></pre>\n\n<p><strong>Embedded Ruby Code in HTML fix:</strong></p>\n\n<p><em>\"Recent\" section fix:</em>\n</p>\n\n<pre><code>&lt;h4 style=\"border-bottom: 1px solid #bbb\"&gt;Recent&lt;/h4&gt;\n        &lt;!-- LINE BELOW IS SLOW!!! (to test, uncomment line, and embrace in \"&lt;% %&gt;\") --&gt;\n        &lt;!-- @post = Post.all.published.order(:published_at).last --&gt;\n        &lt;!-- FAST! Line below replaces line above and is much faster! --&gt;\n        &lt;% @post = Post.select(\"id\", \"title\", \"description\", \"slug\", \"created_at\", \"updated_at\", \"image_file_name\", \"thumbnail_file_name\", \"published\", \"published_at\", \"date\").published.order('published_at DESC').first %&gt;\n        &lt;% if @post == nil or @post.published_at == nil %&gt;\n            &lt;div class=\"temp_sidebar\"&gt;Coming Soon!&lt;/div&gt;\n        &lt;% else %&gt;\n            &lt;%= render partial: \"layouts/media\", locals: {post: @post} %&gt;\n        &lt;% end %&gt;\n</code></pre>\n\n<p><em>\"Archives\" section fix:</em>\n</p>\n\n<pre><code>&lt;!-- LINE BELOW IS SLOW!!! (to test, uncomment line, and embrace in \"&lt;% %&gt;\") --&gt;\n    &lt;!-- if Post.published.length != 0 --&gt;\n    &lt;!-- FAST! Line below replaces line above and is much faster! --&gt;\n    &lt;% if Post.select(\"id\").published.count(\"id\") != 0 %&gt;\n        &lt;h4&gt;Archives&lt;/h4&gt;\n        &lt;div id=\"sidebar\" class=\"list-group\"&gt;\n            &lt;!-- LINE BELOW IS SLOW!!! (to test, uncomment line, and embrace in \"&lt;% %&gt;\") --&gt;\n            &lt;!-- @published_posts = Post.published --&gt;\n            &lt;!-- FAST! Line below replaces line above and is much faster! --&gt;\n            &lt;% @published_posts =  Post.select(\"id\", \"title\", \"date\").published %&gt;\n            &lt;% archives = Hash.new(0) %&gt;\n            &lt;% @published_posts.each do |post| %&gt;\n                &lt;% if archives[post.date] == 0 %&gt;\n                    &lt;% archives[post.date] = 1%&gt;\n                &lt;% else %&gt;\n                    &lt;% archives[post.date] += 1 %&gt;\n                &lt;% end %&gt;\n            &lt;% end %&gt;\n\n            &lt;% archives.each do |key, value| %&gt;\n                &lt;button class=\"accordion\"&gt;&lt;%= key %&gt; &lt;span class=\"badge\"&gt; &lt;%= value %&gt;&lt;/span&gt;&lt;/button&gt;\n                    &lt;div class=\"panel\"&gt;\n                        &lt;% @published_posts.each do |post| %&gt;\n                            &lt;% if post.date == key %&gt;\n                                &lt;p&gt;&lt;%= link_to post.title, post_path(post.id) %&gt;&lt;/p&gt;\n                            &lt;% end %&gt;\n                        &lt;% end %&gt;\n                    &lt;/div&gt;\n            &lt;% end %&gt;\n\n    &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 3867065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c98bb09c2d9232edecf197fa9a35189b?s=128&d=identicon&r=PG&f=1", "display_name": "hlove", "link": "https://stackoverflow.com/users/3867065/hlove"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1429, "favorite_count": 0, "accepted_answer_id": 50919648, "answer_count": 2, "score": 2, "last_activity_date": 1534887177, "creation_date": 1529370284, "question_id": 50919320, "link": "https://stackoverflow.com/questions/50919320/ruby-on-rails-website-is-slow-could-it-be-the-sql-queries", "title": "Ruby on Rails website is slow; could it be the SQL queries?", "body": "<p>I have been working on a web application made with Ruby on Rails.  I've \"completed\" the site, but it runs <em>very</em> slow and pages sometimes take on the order of ten seconds to load.  I've broken this post up into three sections:</p>\n\n<ol>\n<li>Overview</li>\n<li>Diagnosis</li>\n<li>Possible Ideas</li>\n</ol>\n\n<p><strong>Overview</strong></p>\n\n<p>As a very rough overview, this website displays personal projects, each of which have their own page.  Each project (which I call a \u201cpost\u201d in the code) is stored in a table.  I\u2019m not sure if it\u2019s a bad idea to store a whole post in a database as some posts have a decent amount of text and images in their body.  Each entry in the <code>posts</code> table has the following attributes:</p>\n\n<pre><code># == Schema Information\n#\n# Table name: posts\n#\n#  id                       :integer          not null, primary key\n#  title                    :string\n#  body                     :text\n#  description              :text\n#  slug                     :string\n#  created_at               :datetime         not null\n#  updated_at               :datetime         not null\n#  image_file_name          :string\n#  image_content_type       :string\n#  image_file_size          :integer\n#  image_updated_at         :datetime\n#  thumbnail_file_name      :string\n#  thumbnail_content_type   :string\n#  thumbnail_file_size      :integer\n#  thumbnail_updated_at     :datetime\n#  published                :boolean          default(\"f\")\n#  published_at             :datetime\n#\n</code></pre>\n\n<p><strong>Diagnosis</strong></p>\n\n<p>I\u2019m using Heroku to host the application. I\u2019ve upgraded to Hobby level dynos, so I could have access to some of the metrics they provide, like throughput, memory usage, etc.  I don\u2019t think Heroku is what is making the website slow, but rather my code.  In an effort to debug, I've added a third party addon, <a href=\"https://scoutapp.com/\" rel=\"nofollow noreferrer\">Scout</a>, that tracks the bottlenecks in the application.</p>\n\n<p>Scout offers a trace feature that quantizes which code paths are taking the most time in the application.  You can see below (in the bottom half of the picture) that there are a significant amount of traces that take upwards of ten seconds.  Not very good\u2026</p>\n\n<p><a href=\"https://i.stack.imgur.com/rb2S4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rb2S4.png\" alt=\"Trace feature in Scout\"></a></p>\n\n<p>When I click on the second line (6/17 2:04 PM), it gives a breakdown of the response time:</p>\n\n<p><a href=\"https://i.stack.imgur.com/glGdk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/glGdk.png\" alt=\"Breakdown of the response time for &quot;/&quot; trace\"></a></p>\n\n<p>Expanding the SQL statements shows that most of the time intensive queries are from acting on the posts database, and sometimes sorting/ordering the posts (see below).</p>\n\n<p><a href=\"https://i.stack.imgur.com/UHpwE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UHpwE.png\" alt=\"Time intensive SQL statements\"></a></p>\n\n<p><strong>Possible Ideas</strong></p>\n\n<p>Is there anything obvious I am doing wrong here?  I am pretty stuck, and not sure how to speed things up.  Given what Scout is saying, I have two ideas:</p>\n\n<ul>\n<li>Controller/SQL queries the controller invokes are slow</li>\n<li>Embedded Ruby code in HTML is slow.</li>\n</ul>\n\n<p><em>Controller/SQL queries the controller invokes are slow:</em></p>\n\n\n\n<p>The code below shows the code where I am assigning <code>@posts</code> in the <code>PostsController</code>.  The <code>home</code> method is run when the user visits the <a href=\"http://www.hlove-engineering.com/\" rel=\"nofollow noreferrer\">home page</a>, and the <code>index</code> method is run when the user goes to the <a href=\"http://www.hlove-engineering.com/posts\" rel=\"nofollow noreferrer\">posts page</a>.  Could these queries be slow because there is a fair amount of data in the database (5 posts worth of text and images)?</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class PostsController &lt; ApplicationController\n  #before_action :authenticate_user!\n  before_action :set_post, only: [:show, :edit, :update, :destroy, :publish, :unpublish]\n\n  def home\n    @posts = Post.all.published.order('published_at DESC')\n  end\n\n  # GET /posts\n  # GET /posts.json\n  def index\n    if user_signed_in? and current_user.admin\n      @posts = Post.all.order(\"id\")\n    else\n      @posts = Post.all.published\n    end\n  end\n</code></pre>\n\n<p><em>Embedded Ruby Code in HTML is slow:</em></p>\n\n<p>I am using Ruby in some of my HTML code to sort the posts by date and to determine the most recent post.  For example, in the sidebar of the website (to the left of the <a href=\"http://www.hlove-engineering.com/\" rel=\"nofollow noreferrer\">home</a> page), there is section that displays \u201cRecent\u201d, and the logic behind that is:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;h4 style=\"border-bottom: 1px solid #bbb\"&gt;Recent&lt;/h4&gt;\n    &lt;% @post=Post.all.published.order(\"published_at\").last %&gt;\n    &lt;% if @post == nil or @post.published_at == nil %&gt;\n        &lt;div class=\"temp_sidebar\"&gt;Coming Soon!&lt;/div&gt;\n    &lt;% else %&gt;\n        &lt;%= render partial: \"layouts/media\", locals: {post: @post} %&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<p>Similarly, in the \u201cArchives\u201d section of the sidebar, I\u2019m sorting the posts by date, and am doing this logic:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;% if Post.published.length != 0 %&gt; \n    &lt;h4&gt;Archives&lt;/h4&gt;\n    &lt;div id=\"sidebar\" class=\"list-group\"&gt;\n\n        &lt;% @published_posts = Post.published %&gt;\n        &lt;% archives = Hash.new(0) %&gt;\n        &lt;% @published_posts.each do |post| %&gt;\n            &lt;% if archives[post.date] == 0 %&gt;\n                &lt;% archives[post.date] = 1%&gt;\n            &lt;% else %&gt;\n                &lt;% archives[post.date] += 1 %&gt;\n            &lt;% end %&gt;\n        &lt;% end %&gt;\n\n        &lt;% archives.each do |key, value| %&gt;\n            &lt;button class=\"accordion\"&gt;&lt;%= key %&gt; &lt;span class=\"badge\"&gt; &lt;%= value %&gt;&lt;/span&gt;&lt;/button&gt;\n                &lt;div class=\"panel\"&gt;\n                    &lt;% @published_posts.each do |post| %&gt;\n                        &lt;% if post.date == key %&gt;\n                            &lt;p&gt;&lt;%= link_to post.title, post_path(@post) %&gt;&lt;/p&gt;\n                        &lt;% end %&gt;\n                    &lt;% end %&gt;\n                &lt;/div&gt;\n        &lt;% end %&gt;\n\n    &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>My idea is that maybe iterating over posts is taking a very long time, but I\u2019m not entirely sure.  I feel like this is valid code that is ok to be used, but maybe something about it is very slow.  Would you guys have any ideas here?  It may also be good to note here that the app's memory usage is pretty high: around 500MB.  Maybe these queries are slow because of all the data that is getting fetched, but that said, I'm am not quite sure what \"a lot\" of data is for a web app like this.  And of course, my hypothesis as to why this site is slow could be totally wrong, so I'm very open to your thoughts.  Lastly, if the SQL queries/code I am using is slow, are there ways I could speed it up/improve its performance?  Thank you for any help in advance! </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "regex"], "comments": [{"owner": {"reputation": 40086, "user_id": 499581, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1ba2cebc4582467916f2ddd6128447f4?s=128&d=identicon&r=PG", "display_name": "l&#39;L&#39;l", "link": "https://stackoverflow.com/users/499581/lll"}, "edited": false, "score": 0, "creation_date": 1529372380, "post_id": 50919190, "comment_id": 88838889, "body": "Maybe try <a href=\"https://regex101.com/r/pm4weq/6\" rel=\"nofollow noreferrer\">regex101.com/r/pm4weq/6</a>. Basically you&#39;re matching but not capturing groups with <code>(?: ...)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 182, "user_id": 7519771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rDntF.png?s=128&g=1", "display_name": "Cyril Lemaire", "link": "https://stackoverflow.com/users/7519771/cyril-lemaire"}, "edited": false, "score": 0, "creation_date": 1529374243, "post_id": 50919700, "comment_id": 88839192, "body": "Note: I made &quot;header&quot; and &quot;content&quot; groups for clarity, but you may want to remove the names (and make &quot;header&quot; non-capturing) to get your original behaviour back."}, {"owner": {"reputation": 269, "user_id": 5677587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S2Q4c.png?s=128&g=1", "display_name": "ragurney", "link": "https://stackoverflow.com/users/5677587/ragurney"}, "edited": false, "score": 0, "creation_date": 1529376071, "post_id": 50919700, "comment_id": 88839508, "body": "Fantastic answer! Thanks a lot for showing me where I went wrong, the tip about using Rubular, and your great solution. Learned some new things about regex from your post that will come in handy in the future."}], "tags": [], "owner": {"reputation": 182, "user_id": 7519771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rDntF.png?s=128&g=1", "display_name": "Cyril Lemaire", "link": "https://stackoverflow.com/users/7519771/cyril-lemaire"}, "is_accepted": true, "score": 1, "last_activity_date": 1529373940, "creation_date": 1529373940, "answer_id": 50919700, "question_id": 50919190, "link": "https://stackoverflow.com/questions/50919190/regexp-to-get-content-between-two-markdown-headers-sections/50919700#50919700", "title": "Regexp to Get Content Between Two Markdown Headers / Sections", "body": "<p>The first issue in your regex is that the \"next title detector\" (<code>(?:^\\s*#*\\s*\\w+.*\\n(?:\\s*[-=]*\\s*\\n)?|\\z)</code>) will match ``! So it matches the first empty string right after your title (since the group capture is non-greedy) and leaves your capture empty. The second issue is that you only match titles starting by \"Stuff\" of the form \n<code># Stuff</code>, not the pattern</p>\n\n<pre><code>Stuff\n=====\n</code></pre>\n\n<p>And lastly, since you capture the next header, you can't correctly handly successive \"Stuff\" headers.</p>\n\n<p>Here's a proposal to fix your regex:<br>\n<code>^(?&lt;header&gt;\\s*#+\\s*Stuff.*|\\s*Stuff.*\\n\\s*(?:-{2,}|={2,}))\\n(?&lt;content&gt;[\\W\\w]*?)(?=^(?:\\s*#+|.*\\n\\s*(?:-{2,}|={2,}\\s*\\n))|\\z)</code><br>\nBe careful that Ruby is not exactly PCRE, so it's more accurate to make <a href=\"http://rubular.com/r/Tmki51FgtM\" rel=\"nofollow noreferrer\">tests on Rubular</a>, though it's less user-friendly than <a href=\"https://regex101.com/r/pm4weq/7\" rel=\"nofollow noreferrer\">tests on Regex101</a></p>\n"}], "owner": {"reputation": 269, "user_id": 5677587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S2Q4c.png?s=128&g=1", "display_name": "ragurney", "link": "https://stackoverflow.com/users/5677587/ragurney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 50919700, "answer_count": 1, "score": 0, "last_activity_date": 1529373940, "creation_date": 1529369160, "question_id": 50919190, "link": "https://stackoverflow.com/questions/50919190/regexp-to-get-content-between-two-markdown-headers-sections", "title": "Regexp to Get Content Between Two Markdown Headers / Sections", "body": "<p>I am trying to get the content between two markdown headers, with the second delimiting header being optional. I would like the regexp to be able to support all types of headers e.g.</p>\n\n<pre><code>### Thing\n\n# Thing #\n\nThing\n=====\n</code></pre>\n\n<p>Based off of <a href=\"https://stackoverflow.com/questions/9661478/how-to-return-the-substring-of-a-string-between-two-strings-in-ruby\">this answer</a> this is what I have so far (assuming I want to get all content for header titled 'Stuff'):</p>\n\n<pre><code>^\\s*#*\\s*Stuff.*\\n([\\W\\w]*?)(?:^\\s*#*\\s*\\w+.*\\n(?:\\s*[-=]*\\s*\\n)?|\\z)\n</code></pre>\n\n<p>but the capture group is returning an empty string (<a href=\"https://regex101.com/r/pm4weq/5\" rel=\"nofollow noreferrer\">link</a>). The solution should be able to return 'my content' for the following cases: </p>\n\n<pre><code>## Stuff\nmy content\n</code></pre>\n\n<p>2</p>\n\n<pre><code># Stuff #\nmy content\n</code></pre>\n\n<p>3</p>\n\n<pre><code># Thing\ntexty text\n\n#Stuff\nmy content\n\n# Other thing\n</code></pre>\n\n<p>4</p>\n\n<pre><code>Stuff\n====\nmy content\n</code></pre>\n\n<p>If there are extra new lines or spaces in the result that's fine. This is assuming that there are no sub-headers in the content I want to get.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "rspec-rails", "rspec3"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 1, "creation_date": 1529384484, "post_id": 50918489, "comment_id": 88841282, "body": "Do you mind sharing the stack trace of error?"}, {"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1529390335, "post_id": 50918489, "comment_id": 88843296, "body": "@JagdeepSingh i update question"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1529391902, "post_id": 50918489, "comment_id": 88844139, "body": "@HaseebAhmad where in the application do you define <code>APIKEY</code>? Please show that."}, {"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1529392397, "post_id": 50918489, "comment_id": 88844393, "body": "@maxpleaner in config/initializers/app_config.rb"}, {"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1529401014, "post_id": 50918489, "comment_id": 88849323, "body": "@JagdeepSingh any solution?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1529429012, "post_id": 50918489, "comment_id": 88866227, "body": "@HaseebAhmad please show the content of the file not just the name of the file ..."}], "answers": [{"comments": [{"owner": {"reputation": 384, "user_id": 4823919, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a31d1f14b813262b3e237b2a522a53a2?s=128&d=identicon&r=PG", "display_name": "Gokul p", "link": "https://stackoverflow.com/users/4823919/gokul-p"}, "reply_to_user": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "edited": false, "score": 0, "creation_date": 1529409241, "post_id": 50927604, "comment_id": 88854420, "body": "require &#39;rails_helper&#39;"}], "tags": [], "owner": {"reputation": 384, "user_id": 4823919, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a31d1f14b813262b3e237b2a522a53a2?s=128&d=identicon&r=PG", "display_name": "Gokul p", "link": "https://stackoverflow.com/users/4823919/gokul-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1529409230, "last_edit_date": 1529409230, "creation_date": 1529408627, "answer_id": 50927604, "question_id": 50918489, "link": "https://stackoverflow.com/questions/50918489/nameerror-uninitialized-constant-in-controller-while-rspec-controller-testing/50927604#50927604", "title": "NameError: uninitialized constant in controller while rspec controller testing", "body": "<p>Did you included <code>require 'rails_helper'</code> into your <code>CONTROLLER-NAME_controller_spec.rb</code></p>\n"}], "owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 650, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529409230, "creation_date": 1529362532, "last_edit_date": 1529390316, "question_id": 50918489, "link": "https://stackoverflow.com/questions/50918489/nameerror-uninitialized-constant-in-controller-while-rspec-controller-testing", "title": "NameError: uninitialized constant in controller while rspec controller testing", "body": "<p>Controller code</p>\n\n<pre><code>before_action :verify_request\n\ndef verify_request\n  unless request.headers['Authorization'].present? &amp;&amp; request.headers['Authorization'] == APIKEY[\"authorization_key\"]\n    render json: { message: \"UnAuthorize Request\" }, status: 401\n  end\nend\n</code></pre>\n\n<p>Rspec code: </p>\n\n<pre><code>describe \"GET #index\" do\n  it \"returns 400 (empty query parameter)\" do\n    request.env[\"HTTP_AUTHORIZATION\"] = \"testing123\"\n    get :index\n    expect(response).to have_http_status(400)\n  end\nend\n</code></pre>\n\n<p>Issue i face is that while rspec testing, environment variables are not accessible in controller and tests are failing. How do i fix that?</p>\n\n<p>Note: I defined <code>authorization_key</code> in config/authorization.yml for all environments and its working in dev mode but not in testing.</p>\n\n<p>Error I get is:</p>\n\n<pre><code>Failure/Error: unless request.headers['Authorization'].present? &amp;&amp; request.headers['Authorization'] == APIKEY[\"authorization_key\"]\n\n NameError:\n   uninitialized constant V1::LocationController::APIKEY\n</code></pre>\n"}, {"tags": ["ruby", "sinatra"], "comments": [{"owner": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "edited": false, "score": 0, "creation_date": 1529360347, "post_id": 50917649, "comment_id": 88836494, "body": "Unless there are things missing from your code that aren&#39;t shown above, ruby is NOT going to interpret @nav as an instance variable the way you think it does."}], "answers": [{"tags": [], "owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "is_accepted": false, "score": 1, "last_activity_date": 1529360336, "creation_date": 1529360336, "answer_id": 50918192, "question_id": 50917649, "link": "https://stackoverflow.com/questions/50917649/use-a-here-string-and-lambda-in-a-sinatra-helper-method/50918192#50918192", "title": "Use a here string and lambda in a Sinatra helper method", "body": "<p>There are just too many mistakes in your code.</p>\n\n<ol>\n<li><code>@nav</code> is defined at module level, but accessed at instance level, so you got <code>nil</code> when you need it.</li>\n<li>When you call a lambda, you need a dot between the variable name and the opening parenthesis, like <code>foo.(123)</code></li>\n<li><code>@nav.foo(binding)</code>, really? What's the (supposed) type of <code>@nav</code>? Does that type have the instance method <code>foo</code>?</li>\n<li><code>&lt;%= foo %&gt;</code> won't execute <code>foo</code>, because it's a local variable, not a method.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 490, "user_id": 8463613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5da8253029fd740a3346ded3124a7729?s=128&d=identicon&r=PG", "display_name": "Jyrki", "link": "https://stackoverflow.com/users/8463613/jyrki"}, "is_accepted": false, "score": 0, "last_activity_date": 1529438100, "creation_date": 1529438100, "answer_id": 50935999, "question_id": 50917649, "link": "https://stackoverflow.com/questions/50917649/use-a-here-string-and-lambda-in-a-sinatra-helper-method/50935999#50935999", "title": "Use a here string and lambda in a Sinatra helper method", "body": "<p>The reason why it renders <code>a..z</code> is because the <a href=\"https://ruby-doc.org/core-2.5.1/Range.html#method-i-each\" rel=\"nofollow noreferrer\"><code>Range#each</code></a> method (called from within the lambda) executes a given block for each element and then returns the range itself again.</p>\n\n<p>What you would want to use here instead is the <a href=\"https://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-map\" rel=\"nofollow noreferrer\"><code>Enumerable#map</code></a> method.  Similar to <code>#each</code> it also executes a block for each element, but the return values of said block are returned in a new array.</p>\n\n<p>For comparison:</p>\n\n<pre><code>p (\"a\"..\"c\").each { |x| x.upcase }\n#=&gt; \"a\"..\"c\"\n\np (\"a\"..\"c\").map  { |x| x.upcase }\n#=&gt; [\"A\", \"B\", \"C\"]\n</code></pre>\n"}], "owner": {"reputation": 23753, "user_id": 134367, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PgGXL.png?s=128&g=1", "display_name": "craig", "link": "https://stackoverflow.com/users/134367/craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1529438100, "creation_date": 1529356919, "last_edit_date": 1529418474, "question_id": 50917649, "link": "https://stackoverflow.com/questions/50917649/use-a-here-string-and-lambda-in-a-sinatra-helper-method", "title": "Use a here string and lambda in a Sinatra helper method", "body": "<p>I'm trying to create a Sinatra helper that returns a dynamically-generated HTML.  I thought I would use a here string for the static bit and a lambda to calculate the dynamic part.</p>\n\n<p><code>foo_helper.rb</code>:</p>\n\n<pre><code>require 'erb'\nmodule FooHelper\n\n  def tabs(selected)\n\n    template = ERB.new &lt;&lt;~HERE\n      &lt;ul class=\"nav nav-tabs\"&gt;\n        &lt;li class=\"nav-item\"&gt;&lt;a class=\"nav-link &lt;%= 'active' if selected == 'favorites' %&gt;\" href=\"/foo/favorites\"&gt;Favorites&lt;/a&gt;&lt;/li&gt;\n        &lt;li class=\"nav-item\"&gt;&lt;a class=\"nav-link &lt;%= 'active' if selected == 'all' %&gt;\" href=\"/foo\"&gt;All&lt;/a&gt;&lt;/li&gt;\n        &lt;%= alpha.call %&gt;\n      &lt;/ul&gt;\n      HERE\n\n    # binding to a string works as expected    \n    # alpha = \"&lt;li class='nav-item'&gt;&lt;a class='nav-link' href='/foo/a'&gt;A&lt;/a&gt;&lt;/li&gt;\"\n\n    # binding to a lambda, doesn't\n    alpha = lambda {\n      ('a'..'z').each do |letter|\n        \"&lt;li class='nav-item'&gt;&lt;a class='nav-link #{ 'active' if selected == letter }' href='/foo/#{letter}'&gt;#{letter}&lt;/a&gt;&lt;/li&gt;\"\n      end\n    }\n\n    template.result(binding)\n\n  end\n\nend\n</code></pre>\n\n<p><code>foo_controller.rb</code>:</p>\n\n<pre><code>class FooController &lt; ApplicationController\n  helpers FooHelper if defined?(FooHelper)\n  ...\nend\n</code></pre>\n\n<p><code>index.erb</code>:</p>\n\n<pre><code>...\n&lt;%= tabs('favorites') %&gt;\n...\n</code></pre>\n\n<p>Results:</p>\n\n<p><a href=\"https://i.stack.imgur.com/IhDKR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IhDKR.png\" alt=\"enter image description here\"></a></p>\n\n<p>Displays the range, rather than the individual <code>li</code>s.</p>\n\n<p>Am I missing something in the lambda?</p>\n\n<p>** edit **</p>\n\n<p>Corrected the numerous errors.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 9095905, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2QhKZIfUOII/AAAAAAAAAAI/AAAAAAAAJ4g/pyTO3gLkbSA/photo.jpg?sz=128", "display_name": "mat&#39;s", "link": "https://stackoverflow.com/users/9095905/mats"}, "edited": false, "score": 0, "creation_date": 1529356510, "post_id": 50917443, "comment_id": 88835176, "body": "You write. it works. you have no idea how long I was looking for the solution."}], "tags": [], "owner": {"reputation": 1165, "user_id": 143238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/faa7d5a8a0a4333e1e741aa41e802fc1?s=128&d=identicon&r=PG", "display_name": "BM5k", "link": "https://stackoverflow.com/users/143238/bm5k"}, "is_accepted": true, "score": 2, "last_activity_date": 1529355865, "creation_date": 1529355865, "answer_id": 50917443, "question_id": 50917369, "link": "https://stackoverflow.com/questions/50917369/with-rspec-destroy-is-missing-a-template-for-this-request-format-and-variant/50917443#50917443", "title": "with Rspec destroy is missing a template for this request format and variant", "body": "<p>If you're using the <code>resources :chat</code> route helper, then the <code>destroy</code> route by default doesn't respond to <code>GET</code> requests. If you run <code>rails routes</code> you'll see something like this</p>\n\n<pre><code>    chats GET    /chats(.:format)          chats#index\n          POST   /chats(.:format)          chats#create\n new_chat GET    /chats/new(.:format)      chats#new\nedit_chat GET    /chats/:id/edit(.:format) chats#edit\n     chat GET    /chats/:id(.:format)      chats#show\n          PATCH  /chats/:id(.:format)      chats#update\n          PUT    /chats/:id(.:format)      chats#update\n          DELETE /chats/:id(.:format)      chats#destroy\n</code></pre>\n\n<p>So, what you're actually requesting with <code>get :destroy, params: {id: Chat.last.id}</code> is the show action</p>\n\n<p>try <code>delete :destroy, params: {id: Chat.last.id}</code> instead</p>\n"}], "owner": {"reputation": 37, "user_id": 9095905, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2QhKZIfUOII/AAAAAAAAAAI/AAAAAAAAJ4g/pyTO3gLkbSA/photo.jpg?sz=128", "display_name": "mat&#39;s", "link": "https://stackoverflow.com/users/9095905/mats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1666, "favorite_count": 0, "accepted_answer_id": 50917443, "answer_count": 1, "score": 0, "last_activity_date": 1529390850, "creation_date": 1529355488, "last_edit_date": 1529390850, "question_id": 50917369, "link": "https://stackoverflow.com/questions/50917369/with-rspec-destroy-is-missing-a-template-for-this-request-format-and-variant", "title": "with Rspec destroy is missing a template for this request format and variant", "body": "<p>I have a Ruby on Rails application with a chat. the user creates a Chat and ActionCable updates the page on the user side. If the user wants to delete the Chat, ActionCable deletes the Chat on the user side. everything works perfectly. but if I write the test for that the test fails.\nthis is my controller.</p>\n\n<pre><code>  def destroy\n    chat = Chat.find(params[:id])\n    chat.comments.delete_all\n    chat.likes.delete_all\n    id = '#chat-to-delete-id'+chat.id.to_s\n    chat.delete\n    ActionCable.server.broadcast 'room_channel',\n                                delete: id\n  end\n</code></pre>\n\n<p>This is my spec</p>\n\n<pre><code>  it 'delete a chat' do \n    sign_in(user)\n    post :create, params: {chat:{body: 'hello'}}\n    get :destroy, params: {id: Chat.last.id}\n    expect(response.status).to eq (200)\n  end\n</code></pre>\n\n<p>and this is the error I get when I run the test.</p>\n\n<blockquote>\n  <p>ActionController::UnknownFormat: PublicationsController#destroy is\n  missing a template for this request format and variant</p>\n  \n  <p>request.formats: [\"text/html\"]\n        request.variant: []</p>\n</blockquote>\n\n<p>NOTE! For XHR/Ajax or API requests, this action would normally respond with 204 No Content: an empty white screen. Since you're loading it in a web browser, we assume that you expected to actually render a template, not nothing, so we're showing an error to be extra-clear. If you expect 204 No Content, carry on. That's what you'll get from an XHR or API request. Give it a shot.</p>\n\n<p>I don't need to render or redirect something because I update the page with ActionCable.\nif I do redirect_to something, the test is ok but it reloads the page.</p>\n\n<p>Any help or suggestion to pass that test</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 7878, "user_id": 630780, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fskbD.png?s=128&g=1", "display_name": "Carl Markham", "link": "https://stackoverflow.com/users/630780/carl-markham"}, "edited": false, "score": 2, "creation_date": 1529355616, "post_id": 50917362, "comment_id": 88834805, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/49744200/nomethoderror-undefined-method-halt-callback-chains-on-return-false-for-acti\">NoMethodError: undefined method `halt_callback_chains_on_return_false=&#39; for ActiveSupport:Module</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1612, "user_id": 1146473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798f66c6c7e53703e2a30ff911b0e884?s=128&d=identicon&r=PG", "display_name": "ekampp", "link": "https://stackoverflow.com/users/1146473/ekampp"}, "is_accepted": false, "score": 2, "last_activity_date": 1529406943, "creation_date": 1529406943, "answer_id": 50927078, "question_id": 50917362, "link": "https://stackoverflow.com/questions/50917362/undefined-method-halt-callback-chains-on-return-false/50927078#50927078", "title": "undefined method `halt_callback_chains_on_return_false=", "body": "<p>This is the previous behavior:</p>\n\n<pre><code>WelcomeController &lt; ApplicationController\n  before_action: -&gt; { return false }\n\n  def index\n    # would not be called\n  end\nend\n</code></pre>\n\n<p>What the <code>halt_callback_chains_on_return_false = false</code> does:</p>\n\n<pre><code>WelcomeController &lt; ApplicationController\n  before_action: -&gt; { return false }\n\n  def index\n    # would now be rendered regardless of the before_action filter chain's return value\n  end\nend\n</code></pre>\n\n<p>What Rails thinks you should do in filter chains to prevent rendering: </p>\n\n<pre><code>WelcomeController &lt; ApplicationController\n  before_action: -&gt; { raise 'Error' }\n\n  def index\n    # would not be rendered\n  end\nend\n</code></pre>\n\n<p>Hope this helps.</p>\n\n<p>Best,\nEmil</p>\n"}, {"tags": [], "owner": {"reputation": 638, "user_id": 3364236, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/562b7896af8feb268afb98443e7f5459?s=128&d=identicon&r=PG&f=1", "display_name": "worrawut", "link": "https://stackoverflow.com/users/3364236/worrawut"}, "is_accepted": true, "score": 13, "last_activity_date": 1529919672, "creation_date": 1529919672, "answer_id": 51020436, "question_id": 50917362, "link": "https://stackoverflow.com/questions/50917362/undefined-method-halt-callback-chains-on-return-false/51020436#51020436", "title": "undefined method `halt_callback_chains_on_return_false=", "body": "<p>I encountered the same issue during my last upgrade from 5.1 to 5.2.\nWhat I did is just comment out this line in <code>config/initializers/new_framework_defaults.rb</code></p>\n\n<pre><code># Do not halt callback chains when a callback returns false. Previous versions had true.\n# ActiveSupport.halt_callback_chains_on_return_false = false\n</code></pre>\n\n<p>I guess the reason it raise this error because <code>halt_callback_chains_on_return_false</code> option is actually remove from ActiveSupport according to <a href=\"http://guides.rubyonrails.org/5_2_release_notes.html#active-support\" rel=\"noreferrer\">this release note</a>. </p>\n"}, {"tags": [], "owner": {"reputation": 2301, "user_id": 4229573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e7951be77e4a473ae68428a91296b6?s=128&d=identicon&r=PG", "display_name": "Sawo Cliff", "link": "https://stackoverflow.com/users/4229573/sawo-cliff"}, "is_accepted": false, "score": 1, "last_activity_date": 1535822180, "creation_date": 1535822180, "answer_id": 52130508, "question_id": 50917362, "link": "https://stackoverflow.com/questions/50917362/undefined-method-halt-callback-chains-on-return-false/52130508#52130508", "title": "undefined method `halt_callback_chains_on_return_false=", "body": "<pre><code>  halt_callback_chains_on_return_false setting in the initializer \n</code></pre>\n\n<p>This was a solution for temporary keeping old callback behaviour after upgrade to Rails 5.0. Assumed that you need time to check all callbacks in the app and after it you can remove this setting. And assumed that on the upgrade to 5.2 all is already checked, so this setting is removed.</p>\n\n<p>Just comment out the line as @worrawut recommends in the\n        config/initializers/new_framework_defaults.rb file.</p>\n"}], "owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2132, "favorite_count": 1, "accepted_answer_id": 51020436, "answer_count": 3, "score": 7, "last_activity_date": 1535822180, "creation_date": 1529355457, "question_id": 50917362, "link": "https://stackoverflow.com/questions/50917362/undefined-method-halt-callback-chains-on-return-false", "title": "undefined method `halt_callback_chains_on_return_false=", "body": "<p>I'm upgrading a Rails 5.1 application to 5.2. I've updated all of my gems including Rails and finally ran <code>rails app:update</code> which created new files for my rails app. </p>\n\n<p>Specifically there are two files that were created that concern me. First in <code>config/initializers</code> there is a <code>new_framework_defaults_5_2.rb</code> file and second (in the same directory) a <code>new_framework_defaults.rb</code>. The first file only contains comments, but the second file contains some new configuration options. One of those options is this:</p>\n\n<pre><code>ActiveSupport.halt_callback_chains_on_return_false = false\n</code></pre>\n\n<p>This method call throws a undefined_method error. What do I need to do with this line of code?</p>\n\n<p>Here is the stacktrace:</p>\n\n<pre><code>Traceback (most recent call last):\n    73: from bin/rails:4:in `&lt;main&gt;'\n    72: from /usr/local/rvm/gems/ruby-2.5.1/gems/activesupport-5.2.0/lib/active_support/dependencies.rb:283:in `require'\n    71: from /usr/local/rvm/gems/ruby-2.5.1/gems/activesupport-5.2.0/lib/active_support/dependencies.rb:249:in `load_dependency'\n    70: from /usr/local/rvm/gems/ruby-2.5.1/gems/activesupport-5.2.0/lib/active_support/dependencies.rb:283:in `block in require'\n    69: from /usr/local/rvm/gems/ruby-2.5.1/gems/bootsnap-1.3.0/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:29:in `require'\n    68: from /usr/local/rvm/gems/ruby-2.5.1/gems/bootsnap-1.3.0/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:20:in `require_with_bootsnap_lfi'\n    67: from /usr/local/rvm/gems/ruby-2.5.1/gems/bootsnap-1.3.0/lib/bootsnap/load_path_cache/loaded_features_index.rb:65:in `register'\n    66: from /usr/local/rvm/gems/ruby-2.5.1/gems/bootsnap-1.3.0/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `block in require_with_bootsnap_lfi'\n    65: from /usr/local/rvm/gems/ruby-2.5.1/gems/bootsnap-1.3.0/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `require'\n    64: from /usr/local/rvm/gems/ruby-2.5.1/gems/railties-5.2.0/lib/rails/commands.rb:18:in `&lt;main&gt;'\n    63: from /usr/local/rvm/gems/ruby-2.5.1/gems/railties-5.2.0/lib/rails/command.rb:46:in `invoke'\n    62: from /usr/local/rvm/gems/ruby-2.5.1/gems/railties-5.2.0/lib/rails/command/base.rb:65:in `perform'\n    61: from /usr/local/rvm/gems/ruby-2.5.1/gems/thor-0.20.0/lib/thor.rb:387:in `dispatch'\n    60: from /usr/local/rvm/gems/ruby-2.5.1/gems/thor-0.20.0/lib/thor/invocation.rb:126:in `invoke_command'\n    59: from /usr/local/rvm/gems/ruby-2.5.1/gems/thor-0.20.0/lib/thor/command.rb:27:in `run'\n    58: from /usr/local/rvm/gems/ruby-2.5.1/gems/railties-5.2.0/lib/rails/commands/server/server_command.rb:142:in `perform'\n    57: from /usr/local/rvm/gems/ruby-2.5.1/gems/railties-5.2.0/lib/rails/commands/server/server_command.rb:142:in `tap'\n    56: from /usr/local/rvm/gems/ruby-2.5.1/gems/railties-5.2.0/lib/rails/commands/server/server_command.rb:147:in `block in perform'\n    55: from /usr/local/rvm/gems/ruby-2.5.1/gems/railties-5.2.0/lib/rails/commands/server/server_command.rb:51:in `start'\n    54: from /usr/local/rvm/gems/ruby-2.5.1/gems/railties-5.2.0/lib/rails/commands/server/server_command.rb:89:in `log_to_stdout'\n    53: from /usr/local/rvm/gems/ruby-2.5.1/gems/rack-2.0.5/lib/rack/server.rb:354:in `wrapped_app'\n    52: from /usr/local/rvm/gems/ruby-2.5.1/gems/railties-5.2.0/lib/rails/commands/server/server_command.rb:27:in `app'\n    51: from /usr/local/rvm/gems/ruby-2.5.1/gems/rack-2.0.5/lib/rack/server.rb:219:in `app'\n    50: from /usr/local/rvm/gems/ruby-2.5.1/gems/rack-2.0.5/lib/rack/server.rb:319:in `build_app_and_options_from_config'\n    49: from /usr/local/rvm/gems/ruby-2.5.1/gems/rack-2.0.5/lib/rack/builder.rb:40:in `parse_file'\n    48: from /usr/local/rvm/gems/ruby-2.5.1/gems/rack-2.0.5/lib/rack/builder.rb:49:in `new_from_string'\n    47: from /usr/local/rvm/gems/ruby-2.5.1/gems/rack-2.0.5/lib/rack/builder.rb:49:in `eval'\n    46: from config.ru:in `&lt;main&gt;'\n    45: from config.ru:in `new'\n    44: from /usr/local/rvm/gems/ruby-2.5.1/gems/rack-2.0.5/lib/rack/builder.rb:55:in `initialize'\n    43: from /usr/local/rvm/gems/ruby-2.5.1/gems/rack-2.0.5/lib/rack/builder.rb:55:in `instance_eval'\n    42: from config.ru:3:in `block in &lt;main&gt;'\n    41: from /usr/local/rvm/gems/ruby-2.5.1/gems/bootsnap-1.3.0/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:44:in `require_relative'\n    40: from /usr/local/rvm/gems/ruby-2.5.1/gems/activesupport-5.2.0/lib/active_support/dependencies.rb:283:in `require'\n    39: from /usr/local/rvm/gems/ruby-2.5.1/gems/activesupport-5.2.0/lib/active_support/dependencies.rb:249:in `load_dependency'\n    38: from /usr/local/rvm/gems/ruby-2.5.1/gems/activesupport-5.2.0/lib/active_support/dependencies.rb:283:in `block in require'\n    37: from /usr/local/rvm/gems/ruby-2.5.1/gems/bootsnap-1.3.0/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:29:in `require'\n    36: from /usr/local/rvm/gems/ruby-2.5.1/gems/bootsnap-1.3.0/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:20:in `require_with_bootsnap_lfi'\n    35: from /usr/local/rvm/gems/ruby-2.5.1/gems/bootsnap-1.3.0/lib/bootsnap/load_path_cache/loaded_features_index.rb:65:in `register'\n    34: from /usr/local/rvm/gems/ruby-2.5.1/gems/bootsnap-1.3.0/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `block in require_with_bootsnap_lfi'\n    33: from /usr/local/rvm/gems/ruby-2.5.1/gems/bootsnap-1.3.0/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `require'\n    32: from /home/www-upload/treadmilldoctorcurrent/config/environment.rb:5:in `&lt;main&gt;'\n    31: from /usr/local/rvm/gems/ruby-2.5.1/gems/railties-5.2.0/lib/rails/application.rb:361:in `initialize!'\n    30: from /usr/local/rvm/gems/ruby-2.5.1/gems/railties-5.2.0/lib/rails/initializable.rb:60:in `run_initializers'\n    29: from /usr/local/rvm/rubies/ruby-2.5.1/lib/ruby/2.5.0/tsort.rb:205:in `tsort_each'\n    28: from /usr/local/rvm/rubies/ruby-2.5.1/lib/ruby/2.5.0/tsort.rb:226:in `tsort_each'\n    27: from /usr/local/rvm/rubies/ruby-2.5.1/lib/ruby/2.5.0/tsort.rb:347:in `each_strongly_connected_component'\n    26: from /usr/local/rvm/rubies/ruby-2.5.1/lib/ruby/2.5.0/tsort.rb:347:in `call'\n    25: from /usr/local/rvm/rubies/ruby-2.5.1/lib/ruby/2.5.0/tsort.rb:347:in `each'\n    24: from /usr/local/rvm/rubies/ruby-2.5.1/lib/ruby/2.5.0/tsort.rb:349:in `block in each_strongly_connected_component'\n    23: from /usr/local/rvm/rubies/ruby-2.5.1/lib/ruby/2.5.0/tsort.rb:415:in `each_strongly_connected_component_from'\n    22: from /usr/local/rvm/rubies/ruby-2.5.1/lib/ruby/2.5.0/tsort.rb:415:in `call'\n    21: from /usr/local/rvm/gems/ruby-2.5.1/gems/railties-5.2.0/lib/rails/initializable.rb:50:in `tsort_each_child'\n    20: from /usr/local/rvm/gems/ruby-2.5.1/gems/railties-5.2.0/lib/rails/initializable.rb:50:in `each'\n    19: from /usr/local/rvm/rubies/ruby-2.5.1/lib/ruby/2.5.0/tsort.rb:421:in `block in each_strongly_connected_component_from'\n    18: from /usr/local/rvm/rubies/ruby-2.5.1/lib/ruby/2.5.0/tsort.rb:431:in `each_strongly_connected_component_from'\n    17: from /usr/local/rvm/rubies/ruby-2.5.1/lib/ruby/2.5.0/tsort.rb:422:in `block (2 levels) in each_strongly_connected_component_from'\n    16: from /usr/local/rvm/rubies/ruby-2.5.1/lib/ruby/2.5.0/tsort.rb:350:in `block (2 levels) in each_strongly_connected_component'\n    15: from /usr/local/rvm/rubies/ruby-2.5.1/lib/ruby/2.5.0/tsort.rb:228:in `block in tsort_each'\n    14: from /usr/local/rvm/gems/ruby-2.5.1/gems/railties-5.2.0/lib/rails/initializable.rb:61:in `block in run_initializers'\n    13: from /usr/local/rvm/gems/ruby-2.5.1/gems/railties-5.2.0/lib/rails/initializable.rb:32:in `run'\n    12: from /usr/local/rvm/gems/ruby-2.5.1/gems/railties-5.2.0/lib/rails/initializable.rb:32:in `instance_exec'\n    11: from /usr/local/rvm/gems/ruby-2.5.1/gems/railties-5.2.0/lib/rails/engine.rb:613:in `block in &lt;class:Engine&gt;'\n    10: from /usr/local/rvm/gems/ruby-2.5.1/gems/railties-5.2.0/lib/rails/engine.rb:613:in `each'\n     9: from /usr/local/rvm/gems/ruby-2.5.1/gems/railties-5.2.0/lib/rails/engine.rb:614:in `block (2 levels) in &lt;class:Engine&gt;'\n     8: from /usr/local/rvm/gems/ruby-2.5.1/gems/railties-5.2.0/lib/rails/engine.rb:656:in `load_config_initializer'\n     7: from /usr/local/rvm/gems/ruby-2.5.1/gems/activesupport-5.2.0/lib/active_support/notifications.rb:170:in `instrument'\n     6: from /usr/local/rvm/gems/ruby-2.5.1/gems/railties-5.2.0/lib/rails/engine.rb:657:in `block in load_config_initializer'\n     5: from /usr/local/rvm/gems/ruby-2.5.1/gems/activesupport-5.2.0/lib/active_support/dependencies.rb:277:in `load'\n     4: from /usr/local/rvm/gems/ruby-2.5.1/gems/activesupport-5.2.0/lib/active_support/dependencies.rb:249:in `load_dependency'\n     3: from /usr/local/rvm/gems/ruby-2.5.1/gems/activesupport-5.2.0/lib/active_support/dependencies.rb:277:in `block in load'\n     2: from /usr/local/rvm/gems/ruby-2.5.1/gems/bootsnap-1.3.0/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:50:in `load'\n     1: from /usr/local/rvm/gems/ruby-2.5.1/gems/bootsnap-1.3.0/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:50:in `load'\n/home/www-upload/treadmilldoctorcurrent/config/initializers/new_framework_defaults.rb:21:in `&lt;main&gt;': undefined method `halt_callback_chains_on_return_false=' for \nActiveSupport:Module (NoMethodError)\n</code></pre>\n\n<p>Thanks in advance. </p>\n"}, {"tags": ["c", "ruby", "ffi", "ruby-ffi"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9958728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6fb0d54c17bc9dbd0805427727b6132?s=128&d=identicon&r=PG&f=1", "display_name": "Etienne", "link": "https://stackoverflow.com/users/9958728/etienne"}, "edited": false, "score": 2, "creation_date": 1529395957, "post_id": 50918769, "comment_id": 88846358, "body": "Your answer seems to apply for a pure C Ruby extension, I&#39;m just trying to make a library wrapper with FFI though... Thanks anyway!"}, {"owner": {"reputation": 991, "user_id": 3510424, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a62a33ee186ed8c655492271bca43649?s=128&d=identicon&r=PG&f=1", "display_name": "Ankush", "link": "https://stackoverflow.com/users/3510424/ankush"}, "reply_to_user": {"reputation": 1, "user_id": 9958728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6fb0d54c17bc9dbd0805427727b6132?s=128&d=identicon&r=PG&f=1", "display_name": "Etienne", "link": "https://stackoverflow.com/users/9958728/etienne"}, "edited": false, "score": 0, "creation_date": 1529396862, "post_id": 50918769, "comment_id": 88846906, "body": "@Etienne Ah, I should have pciked that up from your question. Just to make sure, have you had a look <a href=\"https://github.com/ffi/ffi/wiki/Examples\" rel=\"nofollow noreferrer\">the FFI examples</a>?"}], "tags": [], "owner": {"reputation": 991, "user_id": 3510424, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a62a33ee186ed8c655492271bca43649?s=128&d=identicon&r=PG&f=1", "display_name": "Ankush", "link": "https://stackoverflow.com/users/3510424/ankush"}, "is_accepted": false, "score": 0, "last_activity_date": 1529396181, "last_edit_date": 1529396181, "creation_date": 1529364817, "answer_id": 50918769, "question_id": 50917280, "link": "https://stackoverflow.com/questions/50917280/ruby-ffi-string-not-getting-to-char-function-argument/50918769#50918769", "title": "Ruby/FFI: String not getting to *char function argument", "body": "<p>A Ruby string is not the same as a C <code>char *</code> (or <code>char []</code>), which is a null-terminated (the last character is ASCII 0 - <code>'\\0'</code>) contiguous array of characters, often considered a \"string\" in c.</p>\n\n<p>Therefore, you will need to convert the ruby string to a pointer, via the macro <code>StringValueCStr(str)</code> (where <code>str</code> is the String variable <code>\"./test.jpg\"</code>). There is also the option of <code>StringValuePtr(str)</code>, which is better in terms of performance, however it is <em>not completely safe</em>, as it does not take into account the fact that c strings are null-terminated, and therefore cannot have null-terminators within the string (which Ruby strings allow). <code>StringValueCStr()</code> on the other hand does take this into account, and therefore ensures you have a valid c string.</p>\n"}], "owner": {"reputation": 1, "user_id": 9958728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6fb0d54c17bc9dbd0805427727b6132?s=128&d=identicon&r=PG&f=1", "display_name": "Etienne", "link": "https://stackoverflow.com/users/9958728/etienne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 263, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529396181, "creation_date": 1529355026, "question_id": 50917280, "link": "https://stackoverflow.com/questions/50917280/ruby-ffi-string-not-getting-to-char-function-argument", "title": "Ruby/FFI: String not getting to *char function argument", "body": "<p>I'm trying to implement with FFI a few functions from the <a href=\"https://github.com/pjreddie/darknet\" rel=\"nofollow noreferrer\">Darknet library</a>:</p>\n\n<pre><code>require 'ffi'\n\nclass Image &lt; FFI::Struct\n  layout :w, :int\n  layout :h, :int\n  layout :c, :int\n  layout :data, :pointer\nend\n\nclass Darknet\n  extend FFI::Library\n\n  ffi_lib \"./libdarknet.so\"\n\n  attach_function :load_image_color, [:string, :int, :int], Image\n\nend\n\nimage = Darknet.load_image_color(\"./test.jpg\", 0, 0)\n</code></pre>\n\n<p>It seems that the filename string doesn't get through:</p>\n\n<pre><code>Cannot load image \"(null)\"\nSTB Reason: can't fopen\n</code></pre>\n\n<p>Here are <a href=\"https://github.com/pjreddie/darknet/blob/master/src/image.c#L1482\" rel=\"nofollow noreferrer\">the function</a> and <a href=\"https://github.com/pjreddie/darknet/blob/master/include/darknet.h#L693\" rel=\"nofollow noreferrer\">the declaration</a>.</p>\n\n<p>I'm quite new to FFI, but I've managed to implement other functions without any issue. I must be missing something obvious, if someone can give me pointers (no pun intended)...</p>\n"}, {"tags": ["ruby", "sass", "phpstorm", "webstorm"], "comments": [{"owner": {"reputation": 136418, "user_id": 783119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bbfd3e5e9f8b698abf7cd1c7aae7a10?s=128&d=identicon&r=PG", "display_name": "LazyOne", "link": "https://stackoverflow.com/users/783119/lazyone"}, "edited": false, "score": 0, "creation_date": 1529352771, "post_id": 50916745, "comment_id": 88833610, "body": "Must be issue with rvm (not the rvm itself but the way how it all works) -- somehow the environment does not match when running in terminal and when executing file watcher command. <b>P.S.</b> Can you use node-sass instead?"}, {"owner": {"reputation": 1231, "user_id": 2230115, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sGX51.png?s=128&g=1", "display_name": "iCodeSometime", "link": "https://stackoverflow.com/users/2230115/icodesometime"}, "edited": false, "score": 1, "creation_date": 1529352981, "post_id": 50916745, "comment_id": 88833687, "body": "The error looks like you&#39;re running it under Ruby 1.9.3, but below you&#39;re referencing Ruby 2.4.2. Are you sure you haven&#39;t switched ruby versions between the two?"}, {"owner": {"reputation": 1078, "user_id": 1436103, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0be7682395dbce6b9f853a3653a1cde9?s=128&d=identicon&r=PG", "display_name": "Nikki Mather", "link": "https://stackoverflow.com/users/1436103/nikki-mather"}, "edited": false, "score": 0, "creation_date": 1529353502, "post_id": 50916745, "comment_id": 88833885, "body": "I set the default version to 2.4.2"}], "answers": [{"tags": [], "owner": {"reputation": 1078, "user_id": 1436103, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0be7682395dbce6b9f853a3653a1cde9?s=128&d=identicon&r=PG", "display_name": "Nikki Mather", "link": "https://stackoverflow.com/users/1436103/nikki-mather"}, "is_accepted": true, "score": 0, "last_activity_date": 1529356549, "creation_date": 1529356549, "answer_id": 50917578, "question_id": 50916745, "link": "https://stackoverflow.com/questions/50916745/issue-with-sass-could-not-find-sass/50917578#50917578", "title": "Issue with Sass: &quot;Could not find &#39;sass&#39;&quot;", "body": "<p>It turns out the issue was related specifically to <code>High Sierra 10.13</code> that is a known bug. I updated to 10.13.6 and updated XCode Tools and everything is working as it should.</p>\n"}], "owner": {"reputation": 1078, "user_id": 1436103, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0be7682395dbce6b9f853a3653a1cde9?s=128&d=identicon&r=PG", "display_name": "Nikki Mather", "link": "https://stackoverflow.com/users/1436103/nikki-mather"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 50917578, "answer_count": 1, "score": 0, "last_activity_date": 1529356549, "creation_date": 1529352425, "last_edit_date": 1529352587, "question_id": 50916745, "link": "https://stackoverflow.com/questions/50916745/issue-with-sass-could-not-find-sass", "title": "Issue with Sass: &quot;Could not find &#39;sass&#39;&quot;", "body": "<p>I'm trying to get my build flow working, however I cannot seem to get it working. When Sass goes to run after I save a .scss file, I get the following error:</p>\n\n<blockquote>\n  <p><code>/.rvm/rubies/ruby-1.9.3-p545/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb:298:in 'to_specs': Could not find 'sass' (&gt;= 0.a) among 20 total gem(s) (Gem::LoadError)</code></p>\n</blockquote>\n\n<p>I'm not entirely sure what else I would need to provide, but hopefully this helps;</p>\n\n<p>The FileWatcher is pointing to <code>/Users/Nick/.rvm/gems/ruby-2.4.2/bin/sass</code></p>\n\n<pre><code>$ sass -v\nRuby Sass 3.5.6\n\n$ ruby -v\nruby 2.4.2p198 (2017-09-14 revision 59899) [x86_64-darwin17]\n\n$ which sass\n/Users/Nick/.rvm/gems/ruby-2.4.2/bin/sass\n\n$ which ruby\n/Users/Nick/.rvm/rubies/ruby-2.4.2/bin/ruby\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "rails-activerecord"], "answers": [{"comments": [{"owner": {"reputation": 1114, "user_id": 5934752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7tGT8.jpg?s=128&g=1", "display_name": "Ravi Mariya", "link": "https://stackoverflow.com/users/5934752/ravi-mariya"}, "edited": false, "score": 0, "creation_date": 1529386587, "post_id": 50916312, "comment_id": 88841901, "body": "I would prefer to create a constant in the model and use it in the view file to avoid creating a new string every time"}, {"owner": {"reputation": 313, "user_id": 8921559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb80c4dd148cdf23e439fb3982bca855?s=128&d=identicon&r=PG&f=1", "display_name": "kdubss", "link": "https://stackoverflow.com/users/8921559/kdubss"}, "reply_to_user": {"reputation": 1114, "user_id": 5934752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7tGT8.jpg?s=128&g=1", "display_name": "Ravi Mariya", "link": "https://stackoverflow.com/users/5934752/ravi-mariya"}, "edited": false, "score": 0, "creation_date": 1529387553, "post_id": 50916312, "comment_id": 88842194, "body": "Thanks for the replies @RaviMariya @AnithaNarayanasamy!"}, {"owner": {"reputation": 313, "user_id": 8921559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb80c4dd148cdf23e439fb3982bca855?s=128&d=identicon&r=PG&f=1", "display_name": "kdubss", "link": "https://stackoverflow.com/users/8921559/kdubss"}, "edited": false, "score": 0, "creation_date": 1529448260, "post_id": 50916312, "comment_id": 88874107, "body": "Actually, now I&#39;m encountering a different error... When I use select_tag,  I can no longer access the current_city.city_id attribute. The output is nil...  Am I doing something wrong??"}], "tags": [], "owner": {"reputation": 11, "user_id": 9269047, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3NdkNHfPDHo/AAAAAAAAAAI/AAAAAAAAA_k/-4s8-ND8rvY/photo.jpg?sz=128", "display_name": "Anitha Narayanasamy", "link": "https://stackoverflow.com/users/9269047/anitha-narayanasamy"}, "is_accepted": false, "score": 0, "last_activity_date": 1529350843, "last_edit_date": 1529350843, "creation_date": 1529350270, "answer_id": 50916312, "question_id": 50916055, "link": "https://stackoverflow.com/questions/50916055/drop-down-menu-with-collection-select-dividing-the-dropdown-into-sections/50916312#50916312", "title": "Drop down menu with collection_select: Dividing the dropdown into sections", "body": "<p>You can use grouped_options_for_select and achieve this.</p>\n\n<pre><code>&lt;% locations = {'Numbered Locations' =&gt; ['loc1', 'loc2'],'Lettered Locations' =&gt; ['locX', 'locY'] } %&gt;\n\n&lt;%= select_tag :city, grouped_options_for_select(locations) %&gt;\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 8921559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb80c4dd148cdf23e439fb3982bca855?s=128&d=identicon&r=PG&f=1", "display_name": "kdubss", "link": "https://stackoverflow.com/users/8921559/kdubss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529350843, "creation_date": 1529349095, "question_id": 50916055, "link": "https://stackoverflow.com/questions/50916055/drop-down-menu-with-collection-select-dividing-the-dropdown-into-sections", "title": "Drop down menu with collection_select: Dividing the dropdown into sections", "body": "<p>I have a dropdown menu for locations, which pulls location data from the DB.</p>\n\n<pre><code>@locations\n</code></pre>\n\n<p>...is an ActiveRecord::Associations::CollectionProxy object, containing various locations (i.e. loc1, loc2, locY)</p>\n\n<p>What I would really like to do is to have the dropdown divide the locations based on categories (e.g. Numbered Locations: loc1, loc2; Lettered Locations: locY, etc.).</p>\n\n<p>The code thus far is (in a slim file),</p>\n\n<pre><code>f.collection_select :location_id, current_provider.locations.except_unassigned, :to_s, { include_blank: true }, class: 'form-control'\n</code></pre>\n\n<p>Does anyone have suggestions on how to start?</p>\n\n<p>Many thanks!</p>\n"}, {"tags": ["ruby", "selenium", "selenium-webdriver", "capybara"], "comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 1, "creation_date": 1529353152, "post_id": 50915955, "comment_id": 88833745, "body": "Do you have the <code>timeout</code> environment variable set when running on CI? If so, to what value?"}, {"owner": {"reputation": 2096, "user_id": 2108990, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/886481640b3ab8f05cdf3be8c0efdad6?s=128&d=identicon&r=PG", "display_name": "Zack", "link": "https://stackoverflow.com/users/2108990/zack"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1529353513, "post_id": 50915955, "comment_id": 88833892, "body": "@ThomasWalpole it is set at 60"}], "answers": [{"comments": [{"owner": {"reputation": 2096, "user_id": 2108990, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/886481640b3ab8f05cdf3be8c0efdad6?s=128&d=identicon&r=PG", "display_name": "Zack", "link": "https://stackoverflow.com/users/2108990/zack"}, "edited": false, "score": 0, "creation_date": 1529355277, "post_id": 50917020, "comment_id": 88834657, "body": "the issue is definitely not alert messages. Hm... Any way to exntend the wait time to more than 10 seconds?"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 2096, "user_id": 2108990, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/886481640b3ab8f05cdf3be8c0efdad6?s=128&d=identicon&r=PG", "display_name": "Zack", "link": "https://stackoverflow.com/users/2108990/zack"}, "edited": false, "score": 1, "creation_date": 1529355331, "post_id": 50917020, "comment_id": 88834680, "body": "@Zack fork capybara and modify, if that fixes it then you&#39;d need to look at what your page is doing in onunload and why it&#39;s taking so long.  If you do fork and modify you could also add saving of a screenshot in there to see what the page actually looks like when it goes over 10 seconds."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 3, "last_activity_date": 1529353722, "creation_date": 1529353722, "answer_id": 50917020, "question_id": 50915955, "link": "https://stackoverflow.com/questions/50915955/ruby-capybaraexpectationnotmet-timed-out-waiting-for-selenium-session-reset-f/50917020#50917020", "title": "Ruby Capybara::ExpectationNotMet: Timed out waiting for Selenium session reset Failure/Error", "body": "<p>When Capybara resets the driver, it tells the browser to go to <code>about:blank</code> and then waits up to 10 seconds for there to be no elements on the page matching CSS '/html/body/*'.  In your case that isn't happening within 10 seconds. </p>\n\n<p>One reason for this could be you having <code>onunload</code> handlers that are doing something that could take longer than 10 seconds on your CI hardware (or opening alert messages, etc)??  If that's the case a workaround is to have the test visit a page that doesn't have an <code>onunload</code> handler and check for something visible on that page at the end of the test (potentially in an after block to keep the test clean). Another thing to verify is that the versions of Chrome and chromedriver are the same between local and CI.</p>\n"}], "owner": {"reputation": 2096, "user_id": 2108990, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/886481640b3ab8f05cdf3be8c0efdad6?s=128&d=identicon&r=PG", "display_name": "Zack", "link": "https://stackoverflow.com/users/2108990/zack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 868, "favorite_count": 0, "accepted_answer_id": 50917020, "answer_count": 1, "score": 0, "last_activity_date": 1529353722, "creation_date": 1529348644, "question_id": 50915955, "link": "https://stackoverflow.com/questions/50915955/ruby-capybaraexpectationnotmet-timed-out-waiting-for-selenium-session-reset-f", "title": "Ruby Capybara::ExpectationNotMet: Timed out waiting for Selenium session reset Failure/Error", "body": "<p>I am continually getting flakey errors on CI where my Selenium session is not restarting. I'm not having this issue when I run tests locally. It only ever happens on my CI server. </p>\n\n<p>I'm using Capybara 2.18.0, rspec 3.7.0, slenium-webdriver 3.9.0 and site_prism 2.13. Is there </p>\n\n<pre><code>Capybara::ExpectationNotMet: Timed out waiting for Selenium session reset\nFailure/Error: raise Capybara::ExpectationNotMet.new('Timed out waiting for Selenium session reset') if (Capybara::Helpers.monotonic_time - start_time) &gt;= 10\n\nCapybara::ExpectationNotMet:\n  Timed out waiting for Selenium session reset\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/capybara-2.18.0/lib/capybara/selenium/driver.rb:145:in `reset!'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/capybara-2.18.0/lib/capybara/session.rb:127:in `reset!'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/capybara-2.18.0/lib/capybara.rb:314:in `block in reset_sessions!'\n</code></pre>\n\n<p>my <code>spec_helper.rb</code> looks like this:</p>\n\n<pre><code>require 'rspec'\nrequire 'capybara/rspec'\nrequire 'capybara-screenshot/rspec'\nrequire 'capybara/dsl'\nrequire 'selenium-webdriver'\nrequire 'site_prism'\n\nCapybara.register_driver :selenium do |app|\n  Capybara::Selenium::Driver.new(app, browser: :chrome)\nend\n\nCapybara.save_path = \"#{Dir.pwd}/screenshots\"\n\nCapybara.default_driver = :selenium\n\nCapybara.app_host = ENV['url']\n\nif ENV['timeout']\n  Capybara.default_max_wait_time = ENV['timeout'].to_i\nelse\n  Capybara.default_max_wait_time = 15\nend\n\nRSpec.configure do |config|\n  config.full_backtrace = true\n\n  config.before(:each) do\n    config.include Capybara::DSL\n  end\n\n  config.after(:each) do |example|\n    if example.exception\n      name = example.example_group.to_s\n      name.slice!('RSpec::ExampleGroups::')\n      name.gsub!('::', '#')\n      whole_page.save_screenshot(\"#{name}##{example.description.tr(' ', '_')}-#{Time.now.strftime('%H_%M_%S')}.png\")\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "thinking-sphinx"], "answers": [{"tags": [], "owner": {"reputation": 187, "user_id": 1477932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ae986215778ab701f6573bc4bd28ad?s=128&d=identicon&r=PG", "display_name": "GAURAV SETH", "link": "https://stackoverflow.com/users/1477932/gaurav-seth"}, "is_accepted": false, "score": 0, "last_activity_date": 1529398055, "creation_date": 1529398055, "answer_id": 50924200, "question_id": 50915004, "link": "https://stackoverflow.com/questions/50915004/thinkingsphinxsphinxerror-lost-connection-to-mysql-server-at-reading-initial/50924200#50924200", "title": "ThinkingSphinx::SphinxError Lost connection to MySQL server at &#39;reading initial communication packet&#39;", "body": "<p>I got this kind of issue and resolved with 'reconnect: true' in database.yml not sure if this will solve this issue, but once you will set this option it is not transection safe so if working please do few research with this.</p>\n\n<pre><code> in database.yml\n\n reconnect: true\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5664083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m9nWB.jpg?s=128&g=1", "display_name": "Utkarsh Dwivedi", "link": "https://stackoverflow.com/users/5664083/utkarsh-dwivedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529398055, "creation_date": 1529344368, "last_edit_date": 1529347606, "question_id": 50915004, "link": "https://stackoverflow.com/questions/50915004/thinkingsphinxsphinxerror-lost-connection-to-mysql-server-at-reading-initial", "title": "ThinkingSphinx::SphinxError Lost connection to MySQL server at &#39;reading initial communication packet&#39;", "body": "<p>I faced this problem from several days and it happens every week I am unable to understand the problem. </p>\n\n<p>Sphinx automatically lost connection on production server.</p>\n\n<blockquote>\n  <p>ThinkingSphinx::SphinxError Lost connection to MySQL server at 'reading initial communication packet'</p>\n</blockquote>\n\n<p>I am using </p>\n\n<ul>\n<li>thinking-sphinx (3.1.4)</li>\n<li>Rails 4.2.1</li>\n<li>ruby 2.0.0</li>\n</ul>\n\n<p>My configuration file thinking_sphinx is - </p>\n\n<pre><code>   development:\n     min_infix_len: 1\n     bin_path: '/usr/bin'\n     searchd_binary_name: 'searchd'\n     indexer_binary_name: 'indexer'\n     utf8: true\n     max_matches: 10000\n   staging:\n     min_infix_len: 1\n     bin_path: ''\n     searchd_binary_name: ''\n     indexer_binary_name: ''\n     max_matches: 10000\n   production:\n     min_infix_len: 1\n     bin_path: ''\n     searchd_binary_name: ''\n     indexer_binary_name: ''\n     max_matches: 10000\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1529367136, "post_id": 50914988, "comment_id": 88837930, "body": "I believe @steenslag&#39;s answer gives the correct result whereas the answer you selected does not (e.g., <code>[12, 1, 4, &quot;beer&quot;]</code>, not <code>[&quot;12&quot;, &quot;1&quot;, &quot;4&quot;, &quot;beer&quot;]</code>). No?"}], "answers": [{"comments": [{"owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "edited": false, "score": 0, "creation_date": 1529344844, "post_id": 50915046, "comment_id": 88830182, "body": "I don&#39;t want the headers though."}, {"owner": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "reply_to_user": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "edited": false, "score": 0, "creation_date": 1529345086, "post_id": 50915046, "comment_id": 88830272, "body": "Corrected, headers gone."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1529345833, "post_id": 50915046, "comment_id": 88830587, "body": "You need to update your return value as it still shows the headers as the first element of the array that is returned. I suggest <code>drop(1)</code> rather than <code>shift</code> as it avoid the need for the line <code>rows</code>."}, {"owner": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1529346262, "post_id": 50915046, "comment_id": 88830761, "body": "@CarySwoveland thanks for pointing out the return value, corrected."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1529346441, "post_id": 50915046, "comment_id": 88830853, "body": "<code>each.to_a.map</code> is <code>duplicitous</code> where <code>map</code> would be sufficient. Right now it is <code>Enumerator</code> -&gt; <code>Array</code> -&gt; <code>Array</code> but since <code>CSV</code> includes <code>Enumerable</code> just <code>map(&amp;:fields)</code> will return the <code>Array</code>"}, {"owner": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1529347142, "post_id": 50915046, "comment_id": 88831156, "body": "@engineersmnky good point, that&#39;s 2 method calls less. Thank you, edited."}], "tags": [], "owner": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "is_accepted": false, "score": 4, "last_activity_date": 1529399083, "last_edit_date": 1529399083, "creation_date": 1529344620, "answer_id": 50915046, "question_id": 50914988, "link": "https://stackoverflow.com/questions/50914988/ruby-convert-csv-to-array-of-arrays/50915046#50915046", "title": "Ruby convert csv to array of arrays", "body": "<p>Simply convert the enumerator returned by CSV#each to an array, and shift it to get rid of the headers.</p>\n\n<pre><code>rows = CSV.open(input_path).each.to_a\nrows.shift\nrows\n=&gt; [[\"12\", \"1\", \"4\", \"beer\"], [\"12\", \"5\", \"4\", \"wine\"], [\"6\", \"3\", \"2\", \"sugar\"], [\"6\", \"5\", \"2\", \"oats\"]]\n</code></pre>\n\n<p>If you prefer a more elegant solution and actually want to treat headers as such:</p>\n\n<pre><code>CSV.open(input_path, headers: true, return_headers: false).map(&amp;:fields)\n</code></pre>\n\n<p>Please mind that in this case <code>.each</code> would yield <code>CSV::Row</code> objects, not arrays.</p>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1529347572, "post_id": 50915635, "comment_id": 88831319, "body": "<code>:col_sep</code> defaults to <code>&quot;,&quot;</code> which makes reasonable sense given &quot;CSV&quot; is traditionally an acronym for &quot;Comma Separated Values&quot;"}, {"owner": {"reputation": 4693, "user_id": 5501536, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/50b9ab14ab8699a3862c14ee48126abe?s=128&d=identicon&r=PG&f=1", "display_name": "chevybow", "link": "https://stackoverflow.com/users/5501536/chevybow"}, "edited": false, "score": 1, "creation_date": 1529348224, "post_id": 50915635, "comment_id": 88831629, "body": "If you&#39;re not sure about something its better suited as a comment than an answer."}], "tags": [], "owner": {"reputation": 1, "user_id": 8303763, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eroK1PSeT2s/AAAAAAAAAAI/AAAAAAAAACc/uF53hbPz2N0/photo.jpg?sz=128", "display_name": "Jharol Salvador Rivera", "link": "https://stackoverflow.com/users/8303763/jharol-salvador-rivera"}, "is_accepted": false, "score": -1, "last_activity_date": 1529348055, "last_edit_date": 1529348055, "creation_date": 1529347263, "answer_id": 50915635, "question_id": 50914988, "link": "https://stackoverflow.com/questions/50914988/ruby-convert-csv-to-array-of-arrays/50915635#50915635", "title": "Ruby convert csv to array of arrays", "body": "<p>I am not sure about this, but I would solve it in this way</p>\n\n<pre><code>CSV.read(path, {:row_sep =&gt; :auto, :col_sep =&gt; ','}).drop(1)\n</code></pre>\n\n<p>In your case I believe you have to indicate ',' in the attribute <code>:col_sep</code></p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1529368104, "post_id": 50918954, "comment_id": 88838073, "body": "Readers: see the doc for <a href=\"http://ruby-doc.org/stdlib-2.4.0/libdoc/csv/rdoc/CSV.html#method-c-table\" rel=\"nofollow noreferrer\">CSV::table</a> It&#39;s the same as <a href=\"http://ruby-doc.org/stdlib-2.4.0/libdoc/csv/rdoc/CSV.html#method-c-new\" rel=\"nofollow noreferrer\">CSV::new</a>, except (as shown), three of the <code>options</code> keys are assigned default values, one being <code>converters: :numeric</code>, which converts <code>&quot;1&quot; #=&gt; 1</code>, <code>&quot;1.4 #=&gt; 1.4</code>, <code>&quot;cat&quot; =&gt; .&quot;cat&quot;</code> and so on. The various options are documented for <code>CSV::new</code>."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1529435041, "post_id": 50918954, "comment_id": 88869231, "body": "Side note <code>CSV</code> includes <code>Enumerable</code> so <code>CSV.table(&quot;test.csv&quot;).drop(1)</code> is sufficient over <code>to_a.drop(1)</code>  which causes <code>Array</code> -&gt; <code>Array</code>"}], "tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 3, "last_activity_date": 1529443753, "last_edit_date": 1529443753, "creation_date": 1529366569, "answer_id": 50918954, "question_id": 50914988, "link": "https://stackoverflow.com/questions/50914988/ruby-convert-csv-to-array-of-arrays/50918954#50918954", "title": "Ruby convert csv to array of arrays", "body": "<pre><code>require \"csv\"\n\n p csv = CSV.table(\"test.csv\").drop(1)\n</code></pre>\n\n<p>Output starts with <code>[[12, 1, 4, \"beer\"],</code>. that is: numbers where possible, not strings everywhere.</p>\n"}], "owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1937, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1529443753, "creation_date": 1529344290, "last_edit_date": 1529344861, "question_id": 50914988, "link": "https://stackoverflow.com/questions/50914988/ruby-convert-csv-to-array-of-arrays", "title": "Ruby convert csv to array of arrays", "body": "<p>I'm trying to convert this csv file:</p>\n\n<pre><code>cash,units,boxes,type\n12,1,4,\"beer\"\n12,5,4,\"wine\"\n6,3,2,\"sugar\"\n6,5,2,\"oats\"\n</code></pre>\n\n<p>to an array of just the rows and <strong>not</strong> the header. How does one do this?</p>\n\n<p>I have this:</p>\n\n<pre><code>csv = CSV.read(input_path, headers: with_headers)\n</code></pre>\n\n<p>which gives me a csv object with 5 rows. How do I just convert the content to an array of 4 arrays, where each subarray represents a row?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "validation", "activerecord"], "comments": [{"owner": {"reputation": 110512, "user_id": 350087, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/808bec1c640143bd7091888d9edfb2f2?s=128&d=identicon&r=PG", "display_name": "apneadiving", "link": "https://stackoverflow.com/users/350087/apneadiving"}, "edited": false, "score": 0, "creation_date": 1529348251, "post_id": 50914844, "comment_id": 88831644, "body": "you should decouple validation from model"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 7748052, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b9d41f5566a41e87d5920d707ee431f5?s=128&d=identicon&r=PG&f=1", "display_name": "user211309", "link": "https://stackoverflow.com/users/7748052/user211309"}, "edited": false, "score": 0, "creation_date": 1529344833, "post_id": 50914953, "comment_id": 88830178, "body": "weird, that doesn&#39;t stop me from creating blank records in my app."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 2, "creation_date": 1529346874, "post_id": 50914953, "comment_id": 88831050, "body": "I would expect that <code>created_at</code> and <code>updated_at</code> are already set and therefore present when you run the validation."}, {"owner": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1529347936, "post_id": 50914953, "comment_id": 88831494, "body": "@spickermann thanks for pointing that out, of course timestamps and id should be omitted here."}], "tags": [], "owner": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "is_accepted": false, "score": 1, "last_activity_date": 1529355698, "last_edit_date": 1529355698, "creation_date": 1529344178, "answer_id": 50914953, "question_id": 50914844, "link": "https://stackoverflow.com/questions/50914844/how-do-i-write-a-custom-validation-that-prevents-a-record-from-having-all-empty/50914953#50914953", "title": "How do I write a custom validation that prevents a record from having all empty attributes?", "body": "<p>Use the hash returned by <a href=\"https://apidock.com/rails/ActiveRecord/AttributeMethods/attributes\" rel=\"nofollow noreferrer\"><code>.attributes</code></a> and check its values, skipping the fields populated by ActiveRecord - timestamps and id.</p>\n\n<pre><code>def not_all_empty\n  if attributes.except('id', 'created_at', 'updated_at').values.all?(&amp;:blank?)\n    errors.add ('XXXX')\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 89, "user_id": 7748052, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b9d41f5566a41e87d5920d707ee431f5?s=128&d=identicon&r=PG&f=1", "display_name": "user211309", "link": "https://stackoverflow.com/users/7748052/user211309"}, "edited": false, "score": 0, "creation_date": 1529346713, "post_id": 50915440, "comment_id": 88830974, "body": "Thanks, I know about &#39;validates&#39;, but in my case the attributes are each optional, as long as there is at least one attribute filled in, whichever that might be."}, {"owner": {"reputation": 29, "user_id": 9850345, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "LoganX", "link": "https://stackoverflow.com/users/9850345/loganx"}, "reply_to_user": {"reputation": 89, "user_id": 7748052, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b9d41f5566a41e87d5920d707ee431f5?s=128&d=identicon&r=PG&f=1", "display_name": "user211309", "link": "https://stackoverflow.com/users/7748052/user211309"}, "edited": false, "score": 0, "creation_date": 1529347668, "post_id": 50915440, "comment_id": 88831370, "body": "Please, read &quot;2.10 absence, 3.1 :allow_nil, 3.2 :allow_blank&quot; on the Documentation. I hope these &quot;helper&quot; and &quot;option&quot;s will help you to solve the your problem."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1529348391, "post_id": 50915440, "comment_id": 88831701, "body": "@LoganX you have now allowed both of them to be blank which unfortunately is the current issue"}, {"owner": {"reputation": 29, "user_id": 9850345, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "LoganX", "link": "https://stackoverflow.com/users/9850345/loganx"}, "edited": false, "score": 0, "creation_date": 1529348631, "post_id": 50915440, "comment_id": 88831828, "body": "[<a href=\"https://stackoverflow.com/questions/2823628/rails-how-to-require-at-least-one-field-not-to-be-blank?noredirect=1&amp;lq=1]\" title=\"rails how to require at least one field not to be blank\">stackoverflow.com/questions/2823628/&hellip;</a> This post may help you!"}], "tags": [], "owner": {"reputation": 29, "user_id": 9850345, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "LoganX", "link": "https://stackoverflow.com/users/9850345/loganx"}, "is_accepted": false, "score": 0, "last_activity_date": 1529348305, "last_edit_date": 1529348305, "creation_date": 1529346476, "answer_id": 50915440, "question_id": 50914844, "link": "https://stackoverflow.com/questions/50914844/how-do-i-write-a-custom-validation-that-prevents-a-record-from-having-all-empty/50915440#50915440", "title": "How do I write a custom validation that prevents a record from having all empty attributes?", "body": "<p>The :allow_blank option is similar to the :allow_nil option. This option will let validation pass if the attribute's value is blank?, like nil or an empty string for example.</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  validates :name, :age, allow_blank: true\nend\n</code></pre>\n\n<p>The <a href=\"http://guides.rubyonrails.org/active_record_validations.html\" rel=\"nofollow noreferrer\">Documentation</a> here!</p>\n"}], "owner": {"reputation": 89, "user_id": 7748052, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b9d41f5566a41e87d5920d707ee431f5?s=128&d=identicon&r=PG&f=1", "display_name": "user211309", "link": "https://stackoverflow.com/users/7748052/user211309"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 1, "closed_date": 1529371828, "answer_count": 2, "score": 0, "last_activity_date": 1529355698, "creation_date": 1529343736, "question_id": 50914844, "link": "https://stackoverflow.com/questions/50914844/how-do-i-write-a-custom-validation-that-prevents-a-record-from-having-all-empty", "closed_reason": "Duplicate", "title": "How do I write a custom validation that prevents a record from having all empty attributes?", "body": "<p>I want to write an Active Record validation that throws an error when a user enters nothing at all in their form. Let's say the user has age and name properties, then it's fine if they don't enter age or don't enter name, but not entering both shouldn't happen. So I want something like this:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  validate :not_all_empty\n\n   def not_all_empty\n     if name.blank? &amp;&amp; age.blank?\n       errors.add (XXXX)\n     end\n   end\n end\n</code></pre>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 5696, "user_id": 7588447, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/8FNQo.jpg?s=128&g=1", "display_name": "Ahmed Elkoussy", "link": "https://stackoverflow.com/users/7588447/ahmed-elkoussy"}, "edited": false, "score": 0, "creation_date": 1529344561, "post_id": 50914938, "comment_id": 88830067, "body": "I wanna thank you very much, I have been trying to solve this for hours! Also thanks for the great explanation :)"}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 3, "last_activity_date": 1529344105, "creation_date": 1529344105, "answer_id": 50914938, "question_id": 50914728, "link": "https://stackoverflow.com/questions/50914728/rspec-cant-call-a-method-in-my-class-for-a-ruby-gem-error-ruby-nomethoderror/50914938#50914938", "title": "Rspec, can&#39;t call a method in my class for a ruby gem, error: ruby NoMethodError: undefined method `pull&#39; for Status::Page:Module", "body": "<p>Try <code>Status::Page::CLI.new.pull</code></p>\n\n<p><code>pull</code> is an instance method on the class <code>Status::Page::CLI</code>, and since it's an instance method you need to instantiate the class with <code>.new</code>. </p>\n\n<p>Since the class inherits from Thor, the call to <code>.new</code> does go through <a href=\"https://www.rubydoc.info/github/wycats/thor/Thor%2FBase:initialize\" rel=\"nofollow noreferrer\">Thor::Base.initialize</a>. But from the docs, it looks like default values are set for all the arguments, so just calling <code>.new</code> without args should suffice.</p>\n"}], "owner": {"reputation": 5696, "user_id": 7588447, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/8FNQo.jpg?s=128&g=1", "display_name": "Ahmed Elkoussy", "link": "https://stackoverflow.com/users/7588447/ahmed-elkoussy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 50914938, "answer_count": 1, "score": 0, "last_activity_date": 1529344105, "creation_date": 1529343146, "question_id": 50914728, "link": "https://stackoverflow.com/questions/50914728/rspec-cant-call-a-method-in-my-class-for-a-ruby-gem-error-ruby-nomethoderror", "title": "Rspec, can&#39;t call a method in my class for a ruby gem, error: ruby NoMethodError: undefined method `pull&#39; for Status::Page:Module", "body": "<p>How to call methods in my main class in rspec tests for a gem?</p>\n\n<p>I have seen other questions like this one but none had an answer that worked with me, so I am asking this question.</p>\n\n<p>I tried writing rspec tests for a gem that I am making (I am not using Rails), but I can't call the methods that are in my main file:</p>\n\n<pre><code>require \"status/page/version\"\nrequire 'thor'\nrequire \"nokogiri\"\nrequire 'open-uri'\nrequire 'date'\n\nmodule Status\n  module Page\n    class CLI &lt; Thor\n      desc \"pull\", \"query website status\"\n      def pull\n      .....\n</code></pre>\n\n<p>That is how I am calling in the page_specs.rb file:</p>\n\n<pre><code>RSpec.describe Status::Page do\n  it \"has a version number\" do\n    expect(Status::Page::VERSION).not_to be nil\n  end\n\n  it \"does something useful\" do\n    expect(true).to eq(true)\n  end\n\n  it \"it should output to a file on pull\" do\n    msg = Status::Page.pull\n    expect(msg).not_to be nil\n  end\n\nend\n</code></pre>\n\n<p>Can someone please advise how I should call the methods in Rspec in my case?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"tags": [], "owner": {"reputation": 720, "user_id": 6481059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1f2a047f31429bc114026c7493ddc6?s=128&d=identicon&r=PG&f=1", "display_name": "Sava", "link": "https://stackoverflow.com/users/6481059/sava"}, "is_accepted": true, "score": 3, "last_activity_date": 1533843054, "last_edit_date": 1533843054, "creation_date": 1529344188, "answer_id": 50914956, "question_id": 50914676, "link": "https://stackoverflow.com/questions/50914676/removing-an-activerecordassociationrelation-instance-from-an-array-based-on-an/50914956#50914956", "title": "Removing an ActiveRecord::AssociationRelation instance from an array based on an attribute name", "body": "<p>It sounds like you could accomplish what you want by using a <code>.where.not</code> query.\n<code>.select</code> transforms the <code>ActiveRecord::AssociationRelation</code> into an <code>Array</code>. <code>where.not</code> will keep it as an <code>AssociationRelation</code>. So your code might look like:</p>\n\n<pre><code>@locations.where.not(name: bad_names).arrange_serializable\n</code></pre>\n\n<p>Where <code>bad_names</code> is either a single name you don't want included, or an array of names you don't want included.</p>\n"}], "owner": {"reputation": 313, "user_id": 8921559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb80c4dd148cdf23e439fb3982bca855?s=128&d=identicon&r=PG&f=1", "display_name": "kdubss", "link": "https://stackoverflow.com/users/8921559/kdubss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 50914956, "answer_count": 1, "score": 0, "last_activity_date": 1533843054, "creation_date": 1529342917, "last_edit_date": 1529343860, "question_id": 50914676, "link": "https://stackoverflow.com/questions/50914676/removing-an-activerecordassociationrelation-instance-from-an-array-based-on-an", "title": "Removing an ActiveRecord::AssociationRelation instance from an array based on an attribute name", "body": "<p>My rails app is pulling <code>@locations</code> data into an <code>ActiveRecord::AssociationRelation</code> array.</p>\n\n<pre><code>@locations \n=&gt; #&lt;ActiveRecord::AssociationRelation [#&lt;Location id: 10, organization_id: 2, name: \"Quitzonville\", ...\n</code></pre>\n\n<p>I would like to remove an instance based on the <code>:name</code> attribute, but I also need to apply the <code>.arrange_serializable</code> method after.</p>\n\n<p>So far, I've tried:</p>\n\n<pre><code>@locations.select { |loc| loc[:name] != ... }\n</code></pre>\n\n<p>method, but I can't seem to apply <code>.arrange_serializable</code> after...</p>\n\n<p>Could someone offer some suggestions?</p>\n\n<p>Many thanks!</p>\n"}, {"tags": ["ruby", "metaprogramming"], "comments": [{"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 3, "creation_date": 1529342459, "post_id": 50914395, "comment_id": 88829146, "body": "owner of an instance method cannot be changed, it will still remain with class <code>A</code>. <code>A.new.method(:m) #=&gt; A</code>"}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 3, "creation_date": 1529342856, "post_id": 50914395, "comment_id": 88829319, "body": "I checked around if that could be done by <code>unbind</code>ing the method, but the method sticks to the closure it&#39;s defined in. - <a href=\"https://stackoverflow.com/questions/34844833/what-the-purpose-of-bind-unbind-methods-in-ruby\" title=\"what the purpose of bind unbind methods in ruby\">stackoverflow.com/questions/34844833/&hellip;</a>"}, {"owner": {"reputation": 33, "user_id": 896424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eacaba1ecf2ef775d14af5504298fb49?s=128&d=identicon&r=PG", "display_name": "CroneKorkN", "link": "https://stackoverflow.com/users/896424/cronekorkn"}, "reply_to_user": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1529343143, "post_id": 50914395, "comment_id": 88829457, "body": "@kiddorails Theres absolutely no way to copy a method around? Why should it be called &quot;define_method&quot;, if it only defines a references (in this case)?"}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 3, "creation_date": 1529343296, "post_id": 50914395, "comment_id": 88829523, "body": "In this case, <code>define_method</code> is <b>creating</b> the method, but you are still passing the proc of <code>A#m</code>. B&#39;s new method remains like a proxy method in that case. You can even define it with <code>B.define_method(:my_method, &amp;A.new.method(:m); B.instance_method(:my_method).owner #=&gt; B</code>"}, {"owner": {"reputation": 33, "user_id": 896424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eacaba1ecf2ef775d14af5504298fb49?s=128&d=identicon&r=PG", "display_name": "CroneKorkN", "link": "https://stackoverflow.com/users/896424/cronekorkn"}, "reply_to_user": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1529343770, "post_id": 50914395, "comment_id": 88829724, "body": "So, i&#39;m afraid my approach of evaluating user defined dsl-code by first collecting it within a kind of sandbox und then pass the methods around to their final places is not realizable in ruby."}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 1, "creation_date": 1529343978, "post_id": 50914395, "comment_id": 88829808, "body": "you can have the methods be defined in a <code>module</code> and then include that module in your <code>sandbox</code>, that way you maybe able to sandbox the external dsl-code. Let&#39;s wait for some other answers; if there is a way, I&#39;m sure the community will come up with it :)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1529345910, "post_id": 50914395, "comment_id": 88830613, "body": "<code>define_method</code> is private so your current example would result in a <code>NoMethodError private method `define_method&#39; called for B:Class</code> not sure what you are trying to accomplish with <code>B</code> but <code>B = Class.new(A)</code> would result in <code>B.new.m #=&gt; #&lt;B:0x2a74b38&gt;</code> via inheritance"}, {"owner": {"reputation": 33, "user_id": 896424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eacaba1ecf2ef775d14af5504298fb49?s=128&d=identicon&r=PG", "display_name": "CroneKorkN", "link": "https://stackoverflow.com/users/896424/cronekorkn"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1529347296, "post_id": 50914395, "comment_id": 88831217, "body": "@engineersmnky I am writing a server config management tool. Users can define nodes (node &quot;example.com&quot; do ... end) and capabilities (def apt install: nil ... end) within their project-directory. As i dont know, which user-provided-file will contain a capability-definition, i need to preevaluate all files and pass the node-definitions (technically method calls) to one and the capability-definitions (tachnically method definitions) to another place after that.  <a href=\"https://github.com/CroneKorkN/rbcm/blob/stackoverflow_rebind_method/lib/project_file.rb\" rel=\"nofollow noreferrer\">github.com/CroneKorkN/rbcm/blob/stackoverflow_rebind_method/&zwnj;&#8203;lib/&hellip;</a>"}, {"owner": {"reputation": 1231, "user_id": 2230115, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sGX51.png?s=128&g=1", "display_name": "iCodeSometime", "link": "https://stackoverflow.com/users/2230115/icodesometime"}, "edited": false, "score": 1, "creation_date": 1529353498, "post_id": 50914395, "comment_id": 88833883, "body": "You can unbind and rebind to <code>B</code> if <code>class B &lt; A</code>"}, {"owner": {"reputation": 33, "user_id": 896424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eacaba1ecf2ef775d14af5504298fb49?s=128&d=identicon&r=PG", "display_name": "CroneKorkN", "link": "https://stackoverflow.com/users/896424/cronekorkn"}, "edited": false, "score": 0, "creation_date": 1529399373, "post_id": 50914395, "comment_id": 88848348, "body": "I am now parsing each user provied file two times. Once for catching method calls, ones for catching method definitions. I am using a module for the latter one, so i get unbound methods that can be bound to any class: <a href=\"https://github.com/CroneKorkN/rbcm/blob/59d874262ca6a6f8f49d9767021dcc7d20eed262/app/project/file.rb#L10-L18\" rel=\"nofollow noreferrer\">github.com/CroneKorkN/rbcm/blob/&hellip;</a>"}, {"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "reply_to_user": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1529403910, "post_id": 50914395, "comment_id": 88851220, "body": "@kiddorails and others: guys, could you please compose comments as answer - it looks like big and helpful article!"}], "owner": {"reputation": 33, "user_id": 896424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eacaba1ecf2ef775d14af5504298fb49?s=128&d=identicon&r=PG", "display_name": "CroneKorkN", "link": "https://stackoverflow.com/users/896424/cronekorkn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529347730, "creation_date": 1529341582, "question_id": 50914395, "link": "https://stackoverflow.com/questions/50914395/self-refers-to-old-class-after-passing-method-to-another-class", "title": "&#39;self&#39; refers to old class after passing method to another class", "body": "<p>I'm passing a method from one class to another.</p>\n\n<pre><code>#!/usr/bin/env ruby\n\nclass A\n  def m\n    p self\n  end\nend\n\nclass B\nend\n\nB.define_method :m, &amp;A.new.method(:m)\nB.new.m # =&gt; #&lt;A:0x00007fb28903e3f8&gt;\n</code></pre>\n\n<p>Why is the method still related to A, not to B? How can i achieve this?</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "hash", "nested"], "answers": [{"comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1529342516, "post_id": 50914356, "comment_id": 88829174, "body": "You can use <code>each_value</code> if you&#39;re not going to use the hash key."}, {"owner": {"reputation": 11, "user_id": 9900018, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jasonsogan", "link": "https://stackoverflow.com/users/9900018/jasonsogan"}, "edited": false, "score": 0, "creation_date": 1529343934, "post_id": 50914356, "comment_id": 88829784, "body": "This assumes that you know what details (pos, email, etc.) each director has attributed to them, which in my case I do. This is a super elegant solution to my problem and I really appreciate the fast response!"}], "tags": [], "owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "is_accepted": true, "score": 1, "last_activity_date": 1529341438, "creation_date": 1529341438, "answer_id": 50914356, "question_id": 50914247, "link": "https://stackoverflow.com/questions/50914247/printing-string-inside-nested-hash-ruby/50914356#50914356", "title": "Printing string inside nested hash - Ruby", "body": "<p>If you just want to display the nested hash, you can do so like this:</p>\n\n<pre><code>&lt;% directors.each do |_internal_name, details| %&gt;\n  Position: &lt;%= details[:pos] %&gt;\n  Email:  &lt;%= details[:email] %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9900018, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jasonsogan", "link": "https://stackoverflow.com/users/9900018/jasonsogan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 50914356, "answer_count": 1, "score": 1, "last_activity_date": 1531435433, "creation_date": 1529340956, "last_edit_date": 1531435433, "question_id": 50914247, "link": "https://stackoverflow.com/questions/50914247/printing-string-inside-nested-hash-ruby", "title": "Printing string inside nested hash - Ruby", "body": "<p>I have been trying to learn the ropes of ruby for a Rails project that I picked up. I have C++ experience but am still learning my way around Ruby, so I will apologize now for not understanding Ruby and its nuances.</p>\n\n<p>I have a hash that has elements containing another hash of strings...</p>\n\n<pre><code>def directors = {\n   gm: { pos: \"General Manager\", email: \"123@abc.com\" },\n   prod: { pos: \"Production Director\", email: \"456@def.com\" },\n   support: { pos: \"Support Director\", email: \"789@xyz.com\" }\n}\nend\n</code></pre>\n\n<p>Within html I am able to run ruby code to access and output each respective string individually...</p>\n\n<pre><code>&lt;%= directors[:gm][:pos] %&gt;\n&lt;%= directors[:gm][:email] %&gt;\n&lt;%= directors[:prod][:pos] %&gt;\n&lt;%= directors[:prod][:email] %&gt;\n&lt;%= directors[:support][:pos] %&gt;\n&lt;%= directors[:support][:email] %&gt;\n</code></pre>\n\n<p>This is a tedious and manual way to obtain and output every single element. I am attempting to write this in a more concise manner and in a way so that it will always display every element regardless of knowing how many elements are in each. I can write <code>directors.each</code> to call each element inside directors, but I need to again access each element inside of each director element. This is the best code I could come up with, but is not syntactically correct.</p>\n\n<pre><code>&lt;% directors.each do |director| %&gt;\n   &lt;% \"#{director}\" do |info| %&gt;\n      &lt;%= dirs[:\"#{director}\"][:\"#{info}\"] %&gt;\n   &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "web", "devise"], "comments": [{"owner": {"reputation": 4769, "user_id": 9541423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f816e0659e0cf40bbe0ef7224a3a56a0?s=128&d=identicon&r=PG", "display_name": "Sovalina", "link": "https://stackoverflow.com/users/9541423/sovalina"}, "edited": false, "score": 0, "creation_date": 1529340123, "post_id": 50913991, "comment_id": 88828105, "body": "the attribute <code>name</code> is obviously missing for your User model, try to rerun the migrations: <code>heroku run rails db:migrate</code>"}, {"owner": {"reputation": 3, "user_id": 7563983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/119c9025417e82d839705482e12e69cc?s=128&d=identicon&r=PG", "display_name": "Stevan", "link": "https://stackoverflow.com/users/7563983/stevan"}, "reply_to_user": {"reputation": 4769, "user_id": 9541423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f816e0659e0cf40bbe0ef7224a3a56a0?s=128&d=identicon&r=PG", "display_name": "Sovalina", "link": "https://stackoverflow.com/users/9541423/sovalina"}, "edited": false, "score": 0, "creation_date": 1529340731, "post_id": 50913991, "comment_id": 88828378, "body": "locally everything works like a charm but as I deploy the app in heroku. In heroku as well, except for the new_user_registration, everything works.  There is t.string :name in schema.rb as well."}, {"owner": {"reputation": 3, "user_id": 7563983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/119c9025417e82d839705482e12e69cc?s=128&d=identicon&r=PG", "display_name": "Stevan", "link": "https://stackoverflow.com/users/7563983/stevan"}, "reply_to_user": {"reputation": 4769, "user_id": 9541423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f816e0659e0cf40bbe0ef7224a3a56a0?s=128&d=identicon&r=PG", "display_name": "Sovalina", "link": "https://stackoverflow.com/users/9541423/sovalina"}, "edited": false, "score": 0, "creation_date": 1529341075, "post_id": 50913991, "comment_id": 88828539, "body": "attribute <b>name</b> is not missing. I ran heroku <b>run rake db:migrate</b> as well. and restarted heroku. I have used devise &gt; 2.0. But still can&#39;t figure it out."}, {"owner": {"reputation": 1165, "user_id": 143238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/faa7d5a8a0a4333e1e741aa41e802fc1?s=128&d=identicon&r=PG", "display_name": "BM5k", "link": "https://stackoverflow.com/users/143238/bm5k"}, "edited": false, "score": 0, "creation_date": 1529361239, "post_id": 50913991, "comment_id": 88836719, "body": "can you provide the error from the log?"}, {"owner": {"reputation": 3, "user_id": 7563983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/119c9025417e82d839705482e12e69cc?s=128&d=identicon&r=PG", "display_name": "Stevan", "link": "https://stackoverflow.com/users/7563983/stevan"}, "reply_to_user": {"reputation": 1165, "user_id": 143238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/faa7d5a8a0a4333e1e741aa41e802fc1?s=128&d=identicon&r=PG", "display_name": "BM5k", "link": "https://stackoverflow.com/users/143238/bm5k"}, "edited": false, "score": 0, "creation_date": 1529385417, "post_id": 50913991, "comment_id": 88841549, "body": "okay @BM5k.. Its above//"}, {"owner": {"reputation": 7359, "user_id": 599989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d752d2574aeb36bc66471f4d0f8811aa?s=128&d=identicon&r=PG", "display_name": "Bijendra", "link": "https://stackoverflow.com/users/599989/bijendra"}, "edited": false, "score": 0, "creation_date": 1529403866, "post_id": 50913991, "comment_id": 88851184, "body": "can you confirm all files from your local setup are pushed to heroku"}, {"owner": {"reputation": 1165, "user_id": 143238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/faa7d5a8a0a4333e1e741aa41e802fc1?s=128&d=identicon&r=PG", "display_name": "BM5k", "link": "https://stackoverflow.com/users/143238/bm5k"}, "edited": false, "score": 0, "creation_date": 1529441470, "post_id": 50913991, "comment_id": 88871983, "body": "@ibya404 I don&#39;t really see any errors in that log... it definitely sounds like the <code>name</code> is missing. Can you run <code>heroku run rails console</code> and then <code>User.column_names</code> to see if its listed?  One thing to be aware of is that if you ran your database migrations on heroku THEN changed one of them to add the <code>name</code> column, that change wouldn&#39;t be reflected on heroku EVEN IF you run <code>heroku rake db:migrate</code> afterwards."}, {"owner": {"reputation": 3, "user_id": 7563983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/119c9025417e82d839705482e12e69cc?s=128&d=identicon&r=PG", "display_name": "Stevan", "link": "https://stackoverflow.com/users/7563983/stevan"}, "reply_to_user": {"reputation": 1165, "user_id": 143238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/faa7d5a8a0a4333e1e741aa41e802fc1?s=128&d=identicon&r=PG", "display_name": "BM5k", "link": "https://stackoverflow.com/users/143238/bm5k"}, "edited": false, "score": 0, "creation_date": 1529469980, "post_id": 50913991, "comment_id": 88878568, "body": "I figured it out. Yes, @BM5k, name was missing, <code>heroku run rake db:migrate</code> did no change. So, went to heroku dashboard and deleted all database files. After deploying and running <code>heroku run rake db:migrate</code> reinstated the missing migration files which were missing somehow. Now, It works like a charm.  Appreciate your help ya&#39; all. Thank You."}], "owner": {"reputation": 3, "user_id": 7563983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/119c9025417e82d839705482e12e69cc?s=128&d=identicon&r=PG", "display_name": "Stevan", "link": "https://stackoverflow.com/users/7563983/stevan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529385514, "creation_date": 1529339941, "last_edit_date": 1529385514, "question_id": 50913991, "link": "https://stackoverflow.com/questions/50913991/works-in-local-host-but-not-as-heroku-app-nomethoderror-in-deviseregistratio", "title": "(Works in local host but not as heroku app) NoMethodError in Devise::Registrations#new", "body": "<p>I am unable to understand. As the code works in local host. When I deployed it in heroku. Its not working. I have been working on it for more than 3 hrs to fix it. Unable to do it. I am here in stack overflow. I hope someone here can help me fix it.</p>\n\n<p><a href=\"https://i.stack.imgur.com/amZXF.jpg\" rel=\"nofollow noreferrer\">https://reviewappimdbapi.herokuapp.com/users/sign_up</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/lFJRy.jpg\" rel=\"nofollow noreferrer\">Here's the new_users_registration_path.</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/YK7Jx.jpg\" rel=\"nofollow noreferrer\">Here's the user model.- user.rb</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/vnuVE.jpg\" rel=\"nofollow noreferrer\">Here's route file</a>\n<a href=\"https://i.stack.imgur.com/gxNgY.jpg\" rel=\"nofollow noreferrer\">Heroku logs</a></p>\n"}, {"tags": ["html", "ruby", "replace", "nokogiri"], "answers": [{"comments": [{"owner": {"reputation": 3132, "user_id": 3960815, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/QKWIX.jpg?s=128&g=1", "display_name": "basic", "link": "https://stackoverflow.com/users/3960815/basic"}, "edited": false, "score": 0, "creation_date": 1529339328, "post_id": 50913606, "comment_id": 88827732, "body": "Your solution was actually much better than the work around I used. Thank you :D"}], "tags": [], "owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "is_accepted": true, "score": 1, "last_activity_date": 1529338429, "creation_date": 1529338429, "answer_id": 50913606, "question_id": 50913308, "link": "https://stackoverflow.com/questions/50913308/replacing-a-with-nokogiri/50913606#50913606", "title": "Replacing &lt;a&gt; with Nokogiri", "body": "<p>Use combination of <a href=\"https://www.rubydoc.info/gems/nokogiri/Nokogiri%2FXML%2FDocument:create_element\" rel=\"nofollow noreferrer\"><code>create_element</code></a> and <a href=\"https://www.rubydoc.info/gems/nokogiri/Nokogiri/XML/Node:replace\" rel=\"nofollow noreferrer\"><code>replace</code></a> to achieve that. Find the comments inline below.</p>\n\n<pre><code>html = '&lt;a href=\"...\"&gt;File Download&lt;/a&gt;'\ndom = Nokogiri::HTML(html) # parse with nokogiri\ndom.to_s # original content\n#=&gt; \"&lt;!DOCTYPE html PUBLIC \\\"-//W3C//DTD HTML 4.0 Transitional//EN\\\" \\\"http://www.w3.org/TR/REC-html40/loose.dtd\\\"&gt;\\n&lt;html&gt;&lt;body&gt;&lt;a href=\\\"...\\\"&gt;File Download&lt;/a&gt;&lt;/body&gt;&lt;/html&gt;\\n\"\n\n# scan the dom for hyperlinks\ndom.css('a').each do |a|\n  node = dom.create_element 'p' # create paragraph element\n  node.inner_html = \"REMOVED\" # add content you want\n  a.replace node # replace found link with paragraph\nend\ndom.to_s # modified html\n#=&gt; \"&lt;!DOCTYPE html PUBLIC \\\"-//W3C//DTD HTML 4.0 Transitional//EN\\\" \\\"http://www.w3.org/TR/REC-html40/loose.dtd\\\"&gt;\\n&lt;html&gt;&lt;body&gt;&lt;p&gt;REMOVED&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;\\n\"\n</code></pre>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 3132, "user_id": 3960815, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/QKWIX.jpg?s=128&g=1", "display_name": "basic", "link": "https://stackoverflow.com/users/3960815/basic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "accepted_answer_id": 50913606, "answer_count": 1, "score": 0, "last_activity_date": 1529338734, "creation_date": 1529337378, "question_id": 50913308, "link": "https://stackoverflow.com/questions/50913308/replacing-a-with-nokogiri", "title": "Replacing &lt;a&gt; with Nokogiri", "body": "<p>I am using Nokogiri to scan a document and remove specific files that are stored as attachments. I want to note however that the value was removed in-line. </p>\n\n<p>Eg. </p>\n\n<pre><code>&lt;a href=\"...\"&gt;File Download&lt;/a&gt;\n</code></pre>\n\n<p>Converted to:</p>\n\n<pre><code>File Removed\n</code></pre>\n\n<p>Here is what I tried: </p>\n\n<pre><code>@doc = Nokogiri::HTML(html).to_html\n@doc.search('a').each do |attachment|\n    attachment.remove\n    attachment.content = \"REMOVED\"\n\n    # ALSO TRIED:\n    attachment.content = \"REMOVED\"\nend\n</code></pre>\n\n<p>The second one does replace the anchor text but keeps the href and the user can still download the value. </p>\n\n<p>How can I replace the anchor value and change it to a &lt; p> with a new string? </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 0, "creation_date": 1529338020, "post_id": 50913425, "comment_id": 88827112, "body": "Hey, thanks, but this one actually just lists every single subcategory and category in a list. My objective is that when on the URL: <code>&#47;blog_categories&#47;6</code> for example, it will show the subcategory followed by the category it belongs to."}, {"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 0, "creation_date": 1529338570, "post_id": 50913425, "comment_id": 88827387, "body": "I think it&#39;s close but this one actually lists every value for every column. (its even more information) I don&#39;t know why though, it&#39;s pulling stuff that&#39;s not even called for in the <code>.erb</code>."}, {"owner": {"reputation": 917, "user_id": 7411621, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a37fcd6d889200d8721cf58a491e4ee5?s=128&d=identicon&r=PG&f=1", "display_name": "taras", "link": "https://stackoverflow.com/users/7411621/taras"}, "reply_to_user": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 1, "creation_date": 1529339424, "post_id": 50913425, "comment_id": 88827781, "body": "@Jake sorry, you don&#39;t need to use an equal sign, my mistake. Please, check my code again. It should work fine, I&#39;ve just checked the similar example in my app. And please make some screenshot of what you need, it is hard to imagine your expected result."}, {"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 0, "creation_date": 1529339658, "post_id": 50913425, "comment_id": 88827888, "body": "I&#39;ve tried the code you just updated and it doesn&#39;t load anything at all. Would this be a problem I may be having in my controller? This code is in the <code>show</code> view"}, {"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 0, "creation_date": 1529346273, "post_id": 50913425, "comment_id": 88830770, "body": "Hey, I realized that this code does work when loading the main category with <code>parent_id</code> of <code>NULL</code> but it just doesn&#39;t show the code when it&#39;s a <code>sub_category</code> that&#39;s being rendered. Any thoughts on this?"}, {"owner": {"reputation": 917, "user_id": 7411621, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a37fcd6d889200d8721cf58a491e4ee5?s=128&d=identicon&r=PG&f=1", "display_name": "taras", "link": "https://stackoverflow.com/users/7411621/taras"}, "reply_to_user": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 1, "creation_date": 1529356843, "post_id": 50913425, "comment_id": 88835298, "body": "@Jake again - I&#39;m not sure if I correctly understand what you need. So try updated code and if something wrong please, update your question with more details and example of the expected result."}, {"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 0, "creation_date": 1529357690, "post_id": 50913425, "comment_id": 88835608, "body": "Zanadto, I&#39;m sorry for so much confusion, I thank you for sticking with me on this and I have updated the code with what I&#39;m trying to achieve."}, {"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 0, "creation_date": 1529501190, "post_id": 50913425, "comment_id": 88896254, "body": "Thanks, the only thing it broke (I then fixed) was the posts weren&#39;t loading. I found the solution to this to be <code>@cat = BlogCategory.friendly.find(params[:id])</code> <code>@posts = @cat.posts</code> Place this into your answer to help others if they come across this."}, {"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 0, "creation_date": 1529505974, "post_id": 50913425, "comment_id": 88899635, "body": "I also came across another issue where It would not work for top_level. I used an <code>if &#47; else</code> statement in my view (along with the code in my previous comment). <code>&lt;% if BlogCategory.top_level %&gt; &lt;h2 class=&quot;center p-space blog-h2&quot;&gt;&lt;%= &quot;All #{@cat.name}&quot; %&gt;&lt;&#47;h2&gt; &lt;% else %&gt; &lt;h2 class=&quot;center p-space blog-h2&quot;&gt;&lt;%= &quot;#{@sub_category.name} #{@category.name}&quot; %&gt;&lt;&#47;h2&gt; &lt;% end %&gt;</code> But this just uses <code>&lt;%= &quot;All #{@cat.name}&quot; %&gt;</code> on everything, even if it&#39;s a <code>sub_category</code>. Any thoughts on getting around this?"}], "tags": [], "owner": {"reputation": 917, "user_id": 7411621, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a37fcd6d889200d8721cf58a491e4ee5?s=128&d=identicon&r=PG&f=1", "display_name": "taras", "link": "https://stackoverflow.com/users/7411621/taras"}, "is_accepted": true, "score": 1, "last_activity_date": 1529359227, "last_edit_date": 1529359227, "creation_date": 1529337751, "answer_id": 50913425, "question_id": 50913143, "link": "https://stackoverflow.com/questions/50913143/displaying-top-level-category-name-in-view-ruby-on-rails/50913425#50913425", "title": "Displaying top level category name in view | ruby on rails", "body": "<p>If I'm not mistaken, you need to display current category name + current category subcategories names. Try to adapt this example to your needs:</p>\n\n<pre><code># controller\ndef show\n  @category = BlogCategory.find(params[:id])\n  if @category.present?\n    @sub_cat_names = @category.sub_categories.map(&amp;:name)\n    @posts         = @category.posts\n  end\nend\n\n# view\n&lt;% if @category.present? %&gt;\n  &lt;h2&gt;Current category:&lt;/h2&gt; &lt;%= @category.name %&gt;\n  &lt;h3&gt;Sub categories:&lt;/h3&gt; &lt;%= @sub_cat_names.join(', ') %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<hr>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I don't understand why do you need <code>@category</code> and <code>@sub_category</code> variables in <code>show</code> action if you don't use them in the view. In accordance with your latest additions, the solution can look like this:</p>\n\n<pre><code># model\nclass BlogCategory &lt; ApplicationRecord\n  has_many :posts\n  has_many :sub_categories, class_name: 'BlogCategory', foreign_key: :parent_id\n\n  belongs_to :parent, class_name: 'BlogCategory'\n\n  scope :top_level, -&gt; { where(parent_id: nil).includes :posts, sub_categories: :posts }\nend\n\n# controller\ndef show\n  @sub_category = BlogCategory.find(params[:id])\n  @category     = @sub_category.parent\nend\n\n# view\n&lt;h2 class=\"center p-space blog-h2\"&gt;\n  &lt;%= \"#{@sub_category.name} #{@category.name}\" %&gt;\n&lt;/h2&gt;\n</code></pre>\n"}], "owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 50913425, "answer_count": 1, "score": 0, "last_activity_date": 1529359227, "creation_date": 1529336750, "last_edit_date": 1529357635, "question_id": 50913143, "link": "https://stackoverflow.com/questions/50913143/displaying-top-level-category-name-in-view-ruby-on-rails", "title": "Displaying top level category name in view | ruby on rails", "body": "<p>I have one <code>blog_categories</code> table with <code>sub_categories</code> based on a <code>parent_id</code> value that points to the main category's <code>.id</code> that is above the subcategory. Main categories have a <code>parent_id</code> of <code>NULL</code>. This is all done through self-referential relations.</p>\n\n<p>How do I display the name of the current <code>sub_category</code> and parent <code>blog_category</code> in the blog_categories.show view based on the <code>/blog_categories/#</code>?</p>\n\n<blockquote>\n  <p>For example; </p>\n  \n  <ul>\n  <li><strong>\"News\"</strong> has <code>.id</code> 1 and <code>parent_id</code> <code>NULL</code> since it's the main category.</li>\n  <li><strong>\"Good\"</strong> has <code>.id</code> 2 and <code>parent_id</code> <code>1</code> since it belongs to the category with an <code>.id</code> of 1.</li>\n  <li><strong>\"Bad\"</strong> has <code>.id</code> 3 and <code>parent_id</code> <code>1</code> since it belongs to the category with an <code>.id</code> of 1.</li>\n  </ul>\n  \n  <p>When <code>/blog_categories/2</code> is rendered I am trying to have it show the\n  name of the subcategory (<strong>\"Good\"</strong> in this case) followed by its\n  parent category (<strong>\"News\"</strong> in this case).</p>\n  \n  <p>The desired result is to be a header stating <strong>\"Good News\"</strong></p>\n</blockquote>\n\n<p><code>BlogCategory</code> <strong>Model:</strong></p>\n\n<pre><code>class BlogCategory &lt; ApplicationRecord\n  has_many :posts\n\n  # This is called a self referential relation. This is where records in a table may point to other records in the same table.\n  has_many :sub_categories, class_name: \"BlogCategory\", foreign_key: :parent_id\n\n  # This is a scope to load the top level categories and eager-load their posts, subcategories, and the subcategories' posts too.\n  scope :top_level, -&gt; { where(parent_id: nil).includes :posts, sub_categories: :posts }\nend\n</code></pre>\n\n<p><code>Blog_categories</code> <strong>controller:</strong></p>\n\n<pre><code>class BlogCategoriesController &lt; ApplicationController\n\ndef index\n  @categories = BlogCategory.top_level.includes(sub_categories: :posts)\n  @category = BlogCategory.find_by_id(params[:id])\n  unless @category.nil? # Allows for categories to have nothing in them, eliminating the NoMethodError\n    @sub_category = @category.sub_categories.first\n    @posts = @subcategory.posts\n  end\n  @all_posts = Post.all\nend\n\ndef show\n  @category = BlogCategory.find_by_id(params[:id])\n  @sub_category = @category.sub_categories\n  @posts = @category.posts\nend\n\nprivate\n\n  def cat_params\n    params.require(:blog_category).permit(:name, :parent_id, :sub_category)\n  end\n\nend\n</code></pre>\n\n<p>My <strong>Show View</strong>:</p>\n\n<pre><code>&lt;% BlogCategory.top_level do |category| %&gt;\n  &lt;% category.sub_categories do |sub_category| %&gt;\n    &lt;h2 class=\"center p-space blog-h2\"&gt;&lt;%= sub_category.name %&gt; &lt;%= category.name %&gt;&lt;/h2&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I've tried a few combinations of <code>do</code> statements but I really cant crack this problem. I would love some help in figuring this one out, thanks!</p>\n\n<p>If this helps, I've had some success with <code>&lt;%= @category.name %&gt;</code> but it only shows the sub_category's name.</p>\n"}, {"tags": ["ruby", "appium", "appium-ios"], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 9398617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24aa14562e61871b8a5beb9ee809e5e?s=128&d=identicon&r=PG&f=1", "display_name": "Sara ", "link": "https://stackoverflow.com/users/9398617/sara"}, "is_accepted": false, "score": 0, "last_activity_date": 1529338656, "creation_date": 1529338656, "answer_id": 50913663, "question_id": 50913134, "link": "https://stackoverflow.com/questions/50913134/the-start-driver-method-is-coming-back-as-undefined-method-start-driver-for/50913663#50913663", "title": "The &#39;start_driver&#39; method is coming back as undefined method `start_driver&#39; for nil:NilClass (NoMethodError)", "body": "<p>I did not have appium running, I thought I did but I didn't. </p>\n"}], "owner": {"reputation": 93, "user_id": 9398617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24aa14562e61871b8a5beb9ee809e5e?s=128&d=identicon&r=PG&f=1", "display_name": "Sara ", "link": "https://stackoverflow.com/users/9398617/sara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529338656, "creation_date": 1529336710, "question_id": 50913134, "link": "https://stackoverflow.com/questions/50913134/the-start-driver-method-is-coming-back-as-undefined-method-start-driver-for", "title": "The &#39;start_driver&#39; method is coming back as undefined method `start_driver&#39; for nil:NilClass (NoMethodError)", "body": "<p>This is the ruby file in my step_definitions: </p>\n\n<pre><code>require 'rubygems'\nrequire 'appium_lib'\nrequire 'yaml'\n\ndesired_caps = {\n    caps: {\n        platformName:  'iOS',\n        platformVersion: '11.4',\n        deviceName:    'iPhone 7',\n        app:           'PATH',\n    },\n    appium_lib: {\n        sauce_username:   nil,\n        sauce_access_key: nil,\n        #wait: 100\n    }\n}\n\ndriver = Appium::Driver.new(desired_caps,)\n$driver.start_driver\n\n#login layout test\n\n#finding the merrill logo\n    def logo (driver)\n        if driver.find_element(:name, \"logo\")\n            return driver.find_element(:name,\"logo\")\n        end\n    end\n\n    #finding the email textfield\n    def email(driver)\n        if driver.find_element(:xpath, '//XCUIElementTypeApplication[@name=\"DataSiteOne\"]/XCUIElementTypeWindow[1]/XCUIElementTypeOther[2]/XCUIElementTypeOther/XCUIElementTypeOther/XCUIElementTypeTextField')\n            return driver.find_element(:xpath, '//XCUIElementTypeApplication[@name=\"DataSiteOne\"]/XCUIElementTypeWindow[1]/XCUIElementTypeOther[2]/XCUIElementTypeOther/XCUIElementTypeOther/XCUIElementTypeTextField')\n        end\n    end\n\n    #finding the password textfield\n    def password(driver)\n        if driver.find_element(:xpath, '//XCUIElementTypeApplication[@name=\"DataSiteOne\"]/XCUIElementTypeWindow[1]/XCUIElementTypeOther[2]/XCUIElementTypeOther/XCUIElementTypeOther/XCUIElementTypeSecureTextField')\n            return driver.find_element(:xpath, '//XCUIElementTypeApplication[@name=\"DataSiteOne\"]/XCUIElementTypeWindow[1]/XCUIElementTypeOther[2]/XCUIElementTypeOther/XCUIElementTypeOther/XCUIElementTypeSecureTextField')\n        end\n    end\n\n    #finding the email toggle\n    def toggle(driver)\n        if driver.find_element(:xpath, '//XCUIElementTypeApplication[@name=\"DataSiteOne\"]/XCUIElementTypeWindow[1]/XCUIElementTypeOther[2]/XCUIElementTypeOther/XCUIElementTypeOther/XCUIElementTypeOther[1]/XCUIElementTypeSwitch')\n            return driver.find_element(:xpath, '//XCUIElementTypeApplication[@name=\"DataSiteOne\"]/XCUIElementTypeWindow[1]/XCUIElementTypeOther[2]/XCUIElementTypeOther/XCUIElementTypeOther/XCUIElementTypeOther[1]/XCUIElementTypeSwitch')\n        end\n    end\n\n    #finding the remember me button\n    def rememberMeButton(driver)\n        if driver.find_element(:name, \"Remember me\")\n            return driver.find_element(:name, \"Remember me\")\n        end\n    end\n\n    #finding the login button\n    def loginButton(driver)\n        if driver.find_element(:name, \"Login\")\n            return driver.find_element(:name, \"Login\")\n        end\n    end\n\n    #finding Forgot Password button\n    def forgotPasswordButton(driver)\n        if driver.find_element(:name, \"Forgot your password?\")\n            return driver.find_element(:name, \"Forgot your password?\")\n        end\n    end\n\nThen(/^I verify the login screen layout$/) do\n    $driver.start_driver\n\n    logo(driver)\n    email(driver)\n    password(driver)\n    toggle(driver)\n    rememberMeButton(driver)\n    loginButton(driver)\n    forgotPasswordButton(driver)\n\nend\n\n$driver.driver_quit\n</code></pre>\n\n<p>This is the the Cucumber file </p>\n\n<pre><code>@LoginLayout\nFeature: Test\n    As an investment banker or analyst\n    I want to be able to make a decision about a current acquisition or merger\n\n@ValidLayout\nScenario: All elements exist on the page for the user\nThen I verify the login screen layout\n</code></pre>\n\n<p>The purpose of this test is find that all the UI elements exists on the view controller, the ruby file runs but when I run it along with the cucumber it fails and its failing to recognize the star_driver method. I can't seem to figure out why it isn't recognizing that file. </p>\n"}, {"tags": ["ruby", "makefile", "rubygems", "bootstrap-4"], "comments": [{"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 1, "creation_date": 1529338380, "post_id": 50912503, "comment_id": 88827295, "body": "Did you install Ruby with the DevKit bundle? If not then reinstall and try again."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1529340641, "post_id": 50912503, "comment_id": 88828334, "body": "To add on to @Casper&#39;s comment here is a link with instructions for installing the DevKit: <a href=\"https://rubyinstaller.org/add-ons/devkit.html\" rel=\"nofollow noreferrer\">rubyinstaller.org/add-ons/devkit.html</a>"}, {"owner": {"reputation": 3709, "user_id": 1259842, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/nTscP.jpg?s=128&g=1", "display_name": "darkomen", "link": "https://stackoverflow.com/users/1259842/darkomen"}, "reply_to_user": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 1, "creation_date": 1529408880, "post_id": 50912503, "comment_id": 88854207, "body": "Installed latest version of Ruby devKit 2.5 solved my issue. Warning Ruby devKit 2.4 don&#39;t run. @Casper post reply solution and I check that."}], "answers": [{"comments": [{"owner": {"reputation": 3709, "user_id": 1259842, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/nTscP.jpg?s=128&g=1", "display_name": "darkomen", "link": "https://stackoverflow.com/users/1259842/darkomen"}, "edited": false, "score": 0, "creation_date": 1529444996, "post_id": 50929914, "comment_id": 88873257, "body": "WARNING : very careful about version of your Ruby DevKit. Thank you for response @Casper"}], "tags": [], "owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "is_accepted": true, "score": 1, "last_activity_date": 1529415583, "creation_date": 1529415583, "answer_id": 50929914, "question_id": 50912503, "link": "https://stackoverflow.com/questions/50912503/install-gem-http-parser-on-windows/50929914#50929914", "title": "install gem http_parser on windows", "body": "<p>The error indicates that Ruby needs to compile native (non-Ruby) code in order to install and use the http_parser gem.</p>\n\n<p>To compile native code on Windows you need to install Ruby with the DevKit package. If you use RubyInstaller you just choose the <strong>Ruby+DevKit</strong> package instead of the plain Ruby package. This should allow the http_parser installation to complete.</p>\n"}], "owner": {"reputation": 3709, "user_id": 1259842, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/nTscP.jpg?s=128&g=1", "display_name": "darkomen", "link": "https://stackoverflow.com/users/1259842/darkomen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 591, "favorite_count": 1, "accepted_answer_id": 50929914, "answer_count": 1, "score": 0, "last_activity_date": 1529415583, "creation_date": 1529334406, "question_id": 50912503, "link": "https://stackoverflow.com/questions/50912503/install-gem-http-parser-on-windows", "title": "install gem http_parser on windows", "body": "<p>I dealing with project Symfony and Bootstrap 4 I would like to work with source bootstrap. For that I need ruby and all bundle.</p>\n\n<p><strong>I launch this command</strong> : <code>bundler install</code> and I have error install on http_parser.rb (0.6.0)</p>\n\n<p><strong>I launch this command</strong> : <code>gem install http_parser.rb --source 'http://rubygems.org/' --install-dir '/dev/tmp/http'</code></p>\n\n<p>but I have this error : <code>C:/dev/Ruby24-x64/lib/ruby/gems/2.4.0/gems/make-0.3.1/bin/make:4:in</code>': undefined local variable or method <code>make' for main:Object (NameError)\n        from C:/dev/Ruby24-x64/bin/make:22:in</code>load'\n        from C:/dev/Ruby24-x64/bin/make:22:in <code>&lt;main&gt;'</code></p>\n\n<p><strong>So I installed make tools with</strong> : <code>gem install make\nSuccessfully installed make-0.3.1\nParsing documentation for make-0.3.1\nDone installing documentation for make after 0 seconds\n1 gem installed</code></p>\n\n<p><strong>And I retry to install http_parser with</strong> : <code>gem install http_parser.rb --source 'http://rubygems.org/' --install-dir '/dev/tmp/http'</code></p>\n\n<p>But nothing change. I again this error : <code>C:/dev/Ruby24-x64/lib/ruby/gems/2.4.0/gems/make-0.3.1/bin/make:4:in `&lt;top (required)&gt;': undefined local variable or method `make' for main:Object (NameError)\n        from C:/dev/Ruby24-x64/bin/make:22:in `load'\n        from C:/dev/Ruby24-x64/bin/make:22:in `&lt;main&gt;'</code></p>\n\n<p>How install http_parser gem on windows OS ? </p>\n\n<p>Why make don't run correctly but install correct ?</p>\n"}]