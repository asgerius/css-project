[{"tags": ["ruby", "ssl", "open-uri"], "comments": [{"owner": {"reputation": 10091, "user_id": 4625365, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/l6v41.jpg?s=128&g=1", "display_name": "Matt Brictson", "link": "https://stackoverflow.com/users/4625365/matt-brictson"}, "edited": false, "score": 0, "creation_date": 1426729115, "post_id": 29134854, "comment_id": 46496642, "body": "Try adding <code>require &quot;openssl&quot;; OpenSSL.debug=true</code> at the top of your code and see if that causes any additional errors/warnings to be printed."}], "owner": {"reputation": 2635, "user_id": 1435711, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9fac7fe4c7290024faee8bfe6367f130?s=128&d=identicon&r=PG", "display_name": "Username", "link": "https://stackoverflow.com/users/1435711/username"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 257, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1426776685, "creation_date": 1426722917, "last_edit_date": 1426776685, "question_id": 29134854, "link": "https://stackoverflow.com/questions/29134854/openssl-error-when-opening-https-web-page", "title": "OpenSSL error when opening HTTPS web page", "body": "<p>My code:</p>\n\n<pre><code>require 'open-uri'\nopen('https://www.google.com')\n</code></pre>\n\n<p>When I run it, I get this error:</p>\n\n<pre><code>C:/Ruby193/lib/ruby/1.9.1/net/http.rb:800:in `connect': SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed (OpenSSL::SSL::SSLError)\nfrom C:/Ruby193/lib/ruby/1.9.1/net/http.rb:800:in `block in connect'\nfrom C:/Ruby193/lib/ruby/1.9.1/timeout.rb:55:in `timeout'\nfrom C:/Ruby193/lib/ruby/1.9.1/timeout.rb:100:in `timeout'\nfrom C:/Ruby193/lib/ruby/1.9.1/net/http.rb:800:in `connect'\nfrom C:/Ruby193/lib/ruby/1.9.1/net/http.rb:756:in `do_start'\nfrom C:/Ruby193/lib/ruby/1.9.1/net/http.rb:745:in `start'\nfrom C:/Ruby193/lib/ruby/1.9.1/open-uri.rb:306:in `open_http'\nfrom C:/Ruby193/lib/ruby/1.9.1/open-uri.rb:776:in `buffer_open'\nfrom C:/Ruby193/lib/ruby/1.9.1/open-uri.rb:203:in `block in open_loop'\nfrom C:/Ruby193/lib/ruby/1.9.1/open-uri.rb:201:in `catch'\nfrom C:/Ruby193/lib/ruby/1.9.1/open-uri.rb:201:in `open_loop'\nfrom C:/Ruby193/lib/ruby/1.9.1/open-uri.rb:146:in `open_uri'\nfrom C:/Ruby193/lib/ruby/1.9.1/open-uri.rb:678:in `open'\nfrom C:/Ruby193/lib/ruby/1.9.1/open-uri.rb:33:in `open'\nfrom C:/Users/Lap/Desktop/geocodin.rb:8:in `&lt;main&gt;'\n</code></pre>\n\n<p>What am I missing? </p>\n\n<p>I'm running Windows 7 and I'm on public wifi if that matters. I set the Wifi connection as Public.</p>\n\n<h1>EDIT</h1>\n\n<p>When I add <code>require \"openssl\"; OpenSSL.debug=true</code> after the first line, I get this error:</p>\n\n<pre><code>OSSL_DEBUG: IS NOW ON!\nC:/Ruby193/lib/ruby/1.9.1/net/http.rb:800: warning: error on stack: error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify failed\nC:/Ruby193/lib/ruby/1.9.1/net/http.rb:800:in `connect': SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify failed (OpenSSL::SSL::SSLError)\n    from C:/Ruby193/lib/ruby/1.9.1/net/http.rb:800:in `block in connect'\n    from C:/Ruby193/lib/ruby/1.9.1/timeout.rb:55:in `timeout'\n    from C:/Ruby193/lib/ruby/1.9.1/timeout.rb:100:in `timeout'\n    from C:/Ruby193/lib/ruby/1.9.1/net/http.rb:800:in `connect'\n    from C:/Ruby193/lib/ruby/1.9.1/net/http.rb:756:in `do_start'\n    from C:/Ruby193/lib/ruby/1.9.1/net/http.rb:745:in `start'\n    from C:/Ruby193/lib/ruby/1.9.1/open-uri.rb:306:in `open_http'\n    from C:/Ruby193/lib/ruby/1.9.1/open-uri.rb:776:in `buffer_open'\n    from C:/Ruby193/lib/ruby/1.9.1/open-uri.rb:203:in `block in open_loop'\n    from C:/Ruby193/lib/ruby/1.9.1/open-uri.rb:201:in `catch'\n    from C:/Ruby193/lib/ruby/1.9.1/open-uri.rb:201:in `open_loop'\n    from C:/Ruby193/lib/ruby/1.9.1/open-uri.rb:146:in `open_uri'\n    from C:/Ruby193/lib/ruby/1.9.1/open-uri.rb:678:in `open'\n    from C:/Ruby193/lib/ruby/1.9.1/open-uri.rb:33:in `open'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "model-view-controller", "model", "integer"], "answers": [{"tags": [], "owner": {"reputation": 856, "user_id": 1945272, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/mAp13.jpg?s=128&g=1", "display_name": "plunntic iam", "link": "https://stackoverflow.com/users/1945272/plunntic-iam"}, "is_accepted": false, "score": 0, "last_activity_date": 1426962675, "creation_date": 1426962675, "answer_id": 29186455, "question_id": 29134606, "link": "https://stackoverflow.com/questions/29134606/how-to-restart-level-if-user-checkoffs-3-missed-days/29186455#29186455", "title": "How to restart level if user checkoffs 3 missed days?", "body": "<p>Sorry to say that, but i don's see the point of doing it that way. You will end up with state related logic inside your models (in fact it's what you have right now, and what's causes all problems).</p>\n\n<p>Anyway, to answer your question, the first thing is that you're doing it wrong (in my opinion anyway). To make it work you have to start again few things.</p>\n\n<p>I would go with <a href=\"https://github.com/pluginaweek/state_machine\" rel=\"nofollow\">state_machine</a> gem in your case. That way you can free your self from state transitions logic. You'll have to map those in your classes, but it will be way more readable and maintainable this way.</p>\n\n<p>Using state machine you're probably could map different states for your habits, like <code>level0</code>, [...], <code>level5</code> and <code>master</code> and then just define transition conditions.</p>\n\n<p>For example let's say you have a <code>committed_count</code> and <code>missed_count</code> fields in you model. </p>\n\n<hr>\n\n<p>Condition to go from <code>level0</code> to <code>level1</code> would be:</p>\n\n<p><code>committed_count &gt; level1_go_up_const</code></p>\n\n<p>Condition to go from <code>level1</code> to <code>level0</code> would be:</p>\n\n<p><code>missed_count</code> > level1_go_down_const`</p>\n\n<hr>\n\n<p>And so on for other levels. And yes, you should extract those numbers as constants, or even better as variables (so user could customize it in settings.</p>\n\n<p>On every change your habit should try to degrade it's state. If that's not possible (not enough missed days) then it tries to advance it's state. If that's not possible (not enough committed days) than nothing state-related happens. If that's possible on the other hand, then it advances in state. And every state change should change committed and missed values to zero so the next / previous state can track it's own limits and behave adequate to that.</p>\n\n<p>This way you can - when the basics will work - add some sugar on top of that without doing some <code>magic</code> unreadable (for anybody else) operations, switch/cases and mystic if statements, and so to make other things you will or need right now - like checking past days as missed if they are not checked as committed neither as missed, or adding some sort of week-schedule for certain activity type (probably it should be editable by user). And so on.</p>\n\n<p>To make this happen you should also consider to introduce more small and meaningful private methods because in near future you wont remember what's going on.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4496612"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1426962675, "creation_date": 1426721356, "last_edit_date": 1426945931, "question_id": 29134606, "link": "https://stackoverflow.com/questions/29134606/how-to-restart-level-if-user-checkoffs-3-missed-days", "title": "How to restart level if user checkoffs 3 missed days?", "body": "<p>I'm creating an app where Users track their positive habits. </p>\n\n<p>To make tracking positive habits more fun I broke it down into levels, specifically 5 levels. </p>\n\n<p>Each level has a certain amount of <code>:committed</code> days associated with it (<code>case n_days</code>).</p>\n\n<p>If a User checks off the box 3x in the _form <code>&lt;%= f.check_box :missedone %&gt;</code> than level one should restart. How can we make this work for <code>:missedone</code>, <code>:missedtwo</code>, <code>:missedthree</code>, <code>:missedfour</code>, <code>:missedfive</code>?</p>\n\n<p><code>:committed</code> days are those days a User said he would do the positive habit. </p>\n\n<p>For example, I am <code>:committed</code> to running Mon - Fri. Missed would therefore only be checked off if I missed a day Mon - Fri.</p>\n\n<pre><code>class Habit &lt; ActiveRecord::Base\n    belongs_to :user\n    before_save :set_level\n    acts_as_taggable\n    serialize :committed, Array\n\n  def self.comitted_for_today\n    today_name = Date::DAYNAMES[Date.today.wday].downcase\n    ids = all.select { |h| h.committed.include? today_name }.map(&amp;:id)\n    where(id: ids)\n  end\n\n    def levels\n            committed_wdays = committed.map { |day| Date::DAYNAMES.index(day.titleize) }\n            n_days = ((date_started.to_date)..Date.today).count { |date| committed_wdays.include? date.wday }\n\n  case n_days     \n      when 0..9\n        1\n      when 10..24\n        2\n      when 25..44\n        3\n      when 45..69\n        4\n      when 70..99\n        5\n      else\n        \"Mastery\"\n        end\n    end\n\nprivate\n    def set_level\n     self.level = levels\n    end \nend\n</code></pre>\n\n<p><strong>habits/_form.html.erb</strong></p>\n\n<pre><code>  &lt;label&gt; Missed: &lt;/label&gt;\n  &lt;div&gt;\n  &lt;label&gt; Level 1: &lt;/label&gt;\n  &lt;%= f.check_box :missedone %&gt;\n  &lt;%= f.check_box :missedone %&gt;\n  &lt;%= f.check_box :missedone %&gt;\n  &lt;/div&gt;\n  &lt;div&gt;\n  &lt;label&gt; Level 2: &lt;/label&gt;\n  &lt;%= f.check_box :missedtwo %&gt;\n  &lt;%= f.check_box :missedtwo %&gt;\n  &lt;%= f.check_box :missedtwo %&gt;\n  &lt;/div&gt;\n  &lt;div&gt;\n  &lt;label&gt; Level 3: &lt;/label&gt;\n  &lt;%= f.check_box :missedthree %&gt;\n  &lt;%= f.check_box :missedthree %&gt;\n  &lt;%= f.check_box :missedthree %&gt;\n  &lt;/div&gt;\n  &lt;div&gt;\n  &lt;label&gt; Level 4: &lt;/label&gt;\n  &lt;%= f.check_box :missedfour %&gt;\n  &lt;%= f.check_box :missedfour %&gt;\n  &lt;%= f.check_box :missedfour %&gt;\n  &lt;/div&gt;\n  &lt;div&gt;\n  &lt;label&gt; Level 5: &lt;/label&gt;\n  &lt;%= f.check_box :missedfive %&gt;\n  &lt;%= f.check_box :missedfive %&gt;\n  &lt;%= f.check_box :missedfive %&gt;\n  &lt;/div&gt;\n</code></pre>\n\n<p><strong>habits_controller.rb</strong></p>\n\n<pre><code>    class HabitsController &lt; ApplicationController\n      before_action :set_habit, only: [:show, :edit, :update, :destroy]\n      before_action :logged_in_user, only: [:create, :destroy]\n\n      def index\n        if params[:tag]\n          @habits = Habit.tagged_with(params[:tag])\n        else\n          @habits = Habit.all.order(\"date_started DESC\")\n          @habits = current_user.habits\n        end\n      end\n\n    private\n\n        def habit_params\n          params.require(:habit).permit(:missedone, :missedtwo, :missedthree, :missedfour, :missedfive, :left, :level, :date_started, :trigger, :target, :positive, :negative, :tag_list, :committed =&gt; [])\n        end\n    end\n</code></pre>\n\n<p><strong>_create_habits.rb</strong></p>\n\n<pre><code>class CreateHabits &lt; ActiveRecord::Migration\n  def change\n    create_table :habits do |t|\n      t.integer :missedone\n      t.integer :missedtwo\n      t.integer :missedthree\n      t.integer :missedfour\n      t.integer :missedfive\n      t.integer :level #broken down via n_days\n      t.text :committed\n      t.datetime :date_started\n      t.string :trigger\n      t.string :target\n      t.string :positive\n      t.string :negative\n      t.references :user, index: true\n\n      t.timestamps null: false\n    end\n    add_foreign_key :habits, :users\n    add_index :habits, [:user_id, :created_at]\n  end\nend\n</code></pre>\n\n<p>I've been killing myself trying to figure out this answer so any help would be GREATLY GREATLY appreciated.</p>\n"}, {"tags": ["mysql", "sql", "ruby-on-rails", "ruby", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 2084, "user_id": 3141240, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bc520eb2dcd6c23a18369425666faae8?s=128&d=identicon&r=PG&f=1", "display_name": "Ravenstine", "link": "https://stackoverflow.com/users/3141240/ravenstine"}, "edited": false, "score": 0, "creation_date": 1426719898, "post_id": 29134198, "comment_id": 46494129, "body": "Wow, I forgot that method even existed.  I like this answer, though the only problem I can see is that using aggregate functions or nested queries to create extra attributes doesn&#39;t seem to work.  Using the method I came up with, I can add an attr_accessor to my user model so that something like post_count can be returned as an attribute.  But most of the time I won&#39;t be needing to do that if I am doing inserts, so it shouldn&#39;t matter much."}, {"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "reply_to_user": {"reputation": 2084, "user_id": 3141240, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bc520eb2dcd6c23a18369425666faae8?s=128&d=identicon&r=PG&f=1", "display_name": "Ravenstine", "link": "https://stackoverflow.com/users/3141240/ravenstine"}, "edited": false, "score": 0, "creation_date": 1426719980, "post_id": 29134198, "comment_id": 46494149, "body": "For some other cases, <a href=\"http://stackoverflow.com/users/120518/shadwell\">Shadwell&#39;s</a> suggestion to run a query to find the IDs and then a separate <code>Model.find</code> can be useful too."}], "tags": [], "owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "is_accepted": false, "score": 8, "last_activity_date": 1426719491, "last_edit_date": 1426719491, "creation_date": 1426719189, "answer_id": 29134198, "question_id": 29134085, "link": "https://stackoverflow.com/questions/29134085/how-can-i-get-activerecord-model-instances-from-a-raw-sql-query/29134198#29134198", "title": "How can I get ActiveRecord model instances from a raw sql query?", "body": "<p>Use <a href=\"http://guides.rubyonrails.org/active_record_querying.html#finding-by-sql\" rel=\"noreferrer\">find_by_sql</a> e.g.</p>\n\n<pre><code>User.find_by_sql(\"SELECT * FROM user...\")\n</code></pre>\n\n<p>the trouble with doing <code>result.map{|u| User.new(u)}</code> is that this creates new <code>User</code> objects with the attributes taken from the hashes returned by <code>exec_query</code> but these are treated as new, unsaved Active Record models so clash with the existing records if you then try to persist them.</p>\n\n<p>That said, the Active Record query interface is pretty flexible so it could be worth posting some examples of the queries you need to see if these can be modelled without resorting to raw SQL.</p>\n"}, {"tags": [], "owner": {"reputation": 32682, "user_id": 120518, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/edf1077f9152b361937f12707e3af891?s=128&d=identicon&r=PG", "display_name": "Shadwell", "link": "https://stackoverflow.com/users/120518/shadwell"}, "is_accepted": false, "score": 1, "last_activity_date": 1426719382, "creation_date": 1426719382, "answer_id": 29134240, "question_id": 29134085, "link": "https://stackoverflow.com/questions/29134085/how-can-i-get-activerecord-model-instances-from-a-raw-sql-query/29134240#29134240", "title": "How can I get ActiveRecord model instances from a raw sql query?", "body": "<p>You could either find the objects by calling the <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Querying.html#method-i-find_by_sql\" rel=\"nofollow\"><code>find_by_sql</code></a> from the class:</p>\n\n<pre><code>User.find_by_sql('select users.* from users ... ')\n</code></pre>\n\n<p>Or, alternatively you'd have to <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/FinderMethods.html#method-i-find\" rel=\"nofollow\">find</a> the users from the the ids you identify from the query:</p>\n\n<pre><code>query = \"SELECT id FROM users WHERE...\"\n\nuser_ids = ActiveRecord::Base.connection.exec_query.to_a\n\nUser.find(user_ids)\n</code></pre>\n"}], "owner": {"reputation": 2084, "user_id": 3141240, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bc520eb2dcd6c23a18369425666faae8?s=128&d=identicon&r=PG&f=1", "display_name": "Ravenstine", "link": "https://stackoverflow.com/users/3141240/ravenstine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1382, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1426719491, "creation_date": 1426718574, "question_id": 29134085, "link": "https://stackoverflow.com/questions/29134085/how-can-i-get-activerecord-model-instances-from-a-raw-sql-query", "title": "How can I get ActiveRecord model instances from a raw sql query?", "body": "<p>In Rails, I sometimes want to do a query with MySQL that is too complicated for ActiveRecord methods alone.  So I will usually do the following to get back an array of hashes:</p>\n\n<pre><code>query = \"SELECT * FROM ...\"\n\nresult = ActiveRecord::Base.connection.exec_query.to_a\n</code></pre>\n\n<p>Often times I can get away with just this, but sometimes I still want an array of instances for my model so I can use them for CRUD.</p>\n\n<p>In that case, I've tried this:</p>\n\n<pre><code>result.map{|u| User.new(u)}\n</code></pre>\n\n<p>This works fine until I try to do a create, save, or update.  When that happens, I get an error telling me that a record with the same ID already exists.</p>\n\n<p>Somehow, ActiveRecord already knows how to do this with the queries it is able to construct.  How can I do the same thing and make it so that I can transform a complex raw query into a collection of model instances that will alter the table instead of trying to insert and failing?</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 3732, "user_id": 1283020, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/dd2b1d4e7e61071b0c144d2d952e2213?s=128&d=identicon&r=PG", "display_name": "Krut", "link": "https://stackoverflow.com/users/1283020/krut"}, "edited": false, "score": 0, "creation_date": 1426741997, "post_id": 29133794, "comment_id": 46499633, "body": "sorry, I meant the values of the arguments inside the method, similar to javascript&#39;s arguments <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/arguments\" rel=\"nofollow noreferrer\">developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/&hellip;</a>"}], "tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 1, "last_activity_date": 1426717186, "creation_date": 1426717186, "answer_id": 29133794, "question_id": 29133662, "link": "https://stackoverflow.com/questions/29133662/how-to-inspect-keyword-arguments-for-method/29133794#29133794", "title": "How to inspect keyword arguments for method", "body": "<pre><code>def for_account(token_id: nil, email: nil, password: nil)\n  puts \"arguments are: ??\"\nend\n\np method(:for_account).parameter\n# =&gt; [[:key, :token_id], [:key, :email], [:key, :password]]\n</code></pre>\n"}], "owner": {"reputation": 3732, "user_id": 1283020, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/dd2b1d4e7e61071b0c144d2d952e2213?s=128&d=identicon&r=PG", "display_name": "Krut", "link": "https://stackoverflow.com/users/1283020/krut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1426717186, "creation_date": 1426716617, "question_id": 29133662, "link": "https://stackoverflow.com/questions/29133662/how-to-inspect-keyword-arguments-for-method", "title": "How to inspect keyword arguments for method", "body": "<p>Given the following Ruby 2.x method, how can I inspect the keyword arguments?</p>\n\n<pre><code>def for_account(token_id: nil, email: nil, password: nil)\n  puts \"arguments are: ??\"\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "answers": [{"tags": [], "owner": {"reputation": 2781, "user_id": 4200307, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/59KSj.jpg?s=128&g=1", "display_name": "Elvn", "link": "https://stackoverflow.com/users/4200307/elvn"}, "is_accepted": true, "score": 5, "last_activity_date": 1444664472, "last_edit_date": 1444664472, "creation_date": 1426715127, "answer_id": 29133320, "question_id": 29133238, "link": "https://stackoverflow.com/questions/29133238/hartl-rspec-tests-failing/29133320#29133320", "title": "Hartl Rspec Tests Failing", "body": "<p>That is a good tutorial. I see you're missing validations in your user.rb</p>\n\n\n\n<pre><code>  validates :name,  presence: true, length: { maximum: 50 }\n</code></pre>\n\n<p>Add this line to the <code>user.rb</code> model specification and both errors should be resolved.</p>\n"}], "owner": {"reputation": 95, "user_id": 3984491, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7e84f3255fb4e060f75698a309fedc90?s=128&d=identicon&r=PG&f=1", "display_name": "David Johnson", "link": "https://stackoverflow.com/users/3984491/david-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "accepted_answer_id": 29133320, "answer_count": 1, "score": 0, "last_activity_date": 1444664472, "creation_date": 1426714857, "question_id": 29133238, "link": "https://stackoverflow.com/questions/29133238/hartl-rspec-tests-failing", "title": "Hartl Rspec Tests Failing", "body": "<p>I keep getting these these two errors during chapter 10 of Hartl's RoR guide and cannot seem to find the solution to them. I've been troubleshooting for awhile, but the answer continues to evade me. Is there something wrong with the USER.rb?</p>\n\n<pre><code> FAIL[\"test_name_should_not_be_too_long\", UserTest, 0.436818]\n test_name_should_not_be_too_long#UserTest (0.44s)\n        Expected true to be nil or false\n        test/models/user_test.rb:25:in `block in &lt;class:UserTest&gt;'\n\n FAIL[\"test_name_should_be_present\", UserTest, 0.441668]\n test_name_should_be_present#UserTest (0.44s)\n        Expected true to be nil or false\n        test/models/user_test.rb:15:in `block in &lt;class:UserTest&gt;'\n</code></pre>\n\n<p>Here is my User_test</p>\n\n<pre><code>require 'test_helper'\n\nclass UserTest &lt; ActiveSupport::TestCase\n\n  def setup\n    @user = User.new(name: \"Example User\", email: \"user@example.com\", password: \"foobar\", password_confirmation: \"foobar\")\n  end\n\n  test \"should be valid\" do\n    assert @user.valid?\n  end\n\n  test \"name should be present\" do\n    @user.name = \"\"\n    assert_not @user.valid?\n  end\n\ntest \"email should be present\" do\n    @user.email = \"     \"\n    assert_not @user.valid?\n  end\n\ntest \"name should not be too long\" do\n    @user.name = \"a\" * 51\n    assert_not @user.valid?\n  end\n\ntest \"email should not be too long\" do\n    @user.email = \"a\" * 244 + \"@example.com\"\n    assert_not @user.valid?\n  end\n\ntest \"email validation should accept valid addresses\" do\n    valid_addresses = %w[user@example.com USER@foo.COM A_US-ER@foo.bar.org\n                         first.last@foo.jp alice+bob@baz.cn]\n    valid_addresses.each do |valid_address|\n      @user.email = valid_address\n      assert @user.valid?, \"#{valid_address.inspect} should be valid\"\n    end\n  end\n\ntest \"email validation should reject invalid addresses\" do\n    invalid_addresses = %w[user@example,com user_at_foo.org user.name@example.\n                           foo@bar_baz.com foo@bar+baz.com]\n    invalid_addresses.each do |invalid_address|\n      @user.email = invalid_address\n      assert_not @user.valid?, \"#{invalid_address.inspect} should be invalid\"\n    end\n  end\n\n  test \"email addresses should be unique\" do\n    duplicate_user = @user.dup\n    duplicate_user.email = @user.email.upcase\n    @user.save\n    assert_not duplicate_user.valid?\n  end\n\n  test \"email addresses should be saved as lower-case\" do\n    mixed_case_email = \"Foo@ExAMPle.CoM\"\n    @user.email = mixed_case_email\n    @user.save\n    assert_equal mixed_case_email.downcase, @user.reload.email\n  end\n\n\n  test \"password should have a minimum length\" do\n    @user.password = @user.password_confirmation = \"a\" * 5\n    assert_not @user.valid?\n  end\n\n  test \"authenticated? should return false for a user with nil digest\" do\n    assert_not @user.authenticated?(:remember, '')\n  end\n\nend\n</code></pre>\n\n<p>User.rb</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  attr_accessor :remember_token, :activation_token\n  before_save   :downcase_email\n  before_create :create_activation_digest\n  VALID_EMAIL_REGEX = /\\A[\\w+\\-.]+@[a-z\\d\\-]+(\\.[a-z\\d\\-]+)*\\.[a-z]+\\z/i\n  validates :email, presence: true, length: { maximum: 255 },\n                    format: { with: VALID_EMAIL_REGEX }, uniqueness: { case_sensitive: false }\n  has_secure_password\n  validates :password, length: { minimum: 6 }, allow_blank: true\n\n    # Returns the hash digest of the given string.\n  def User.digest(string)\n    cost = ActiveModel::SecurePassword.min_cost ? BCrypt::Engine::MIN_COST :\n                                                  BCrypt::Engine.cost\n    BCrypt::Password.create(string, cost: cost)\n  end\n\n  # Returns a random token.\n  def User.new_token\n    SecureRandom.urlsafe_base64\n  end\n\n  # Remembers a user in the database for use in persistent sessions.\n  def remember\n    self.remember_token = User.new_token\n    update_attribute(:remember_digest, User.digest(remember_token))\n  end\n\n  # Returns true if the given token matches the digest.\n  def authenticated?(attribute, token)\n    digest = send(\"#{attribute}_digest\")\n    return false if digest.nil?\n    BCrypt::Password.new(digest).is_password?(token)\n  end\n\n  # Forgets a user.\n  def forget\n    update_attribute(:remember_digest, nil)\n  end\n\n    # Returns the hash digest of the given string.\n  def self.digest(string)\n    cost = ActiveModel::SecurePassword.min_cost ? BCrypt::Engine::MIN_COST :\n                                                  BCrypt::Engine.cost\n    BCrypt::Password.create(string, cost: cost)\n  end\n\n  # Returns a random token.\n  def self.new_token\n    SecureRandom.urlsafe_base64\n  end\n\n  class &lt;&lt; self\n    # Returns the hash digest of the given string.\n    def digest(string)\n      cost = ActiveModel::SecurePassword.min_cost ? BCrypt::Engine::MIN_COST :\n                                                    BCrypt::Engine.cost\n      BCrypt::Password.create(string, cost: cost)\n    end\n\n    # Returns a random token.\n    def new_token\n      SecureRandom.urlsafe_base64\n    end\n  end\n\n  private\n\n    # Converts email to all lower-case.\n    def downcase_email\n      self.email = email.downcase\n    end\n\n    # Creates and assigns the activation token and digest.\n    def create_activation_digest\n      self.activation_token  = User.new_token\n      self.activation_digest = User.digest(activation_token)\n    end\n\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 22303, "user_id": 2456433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiN8K.jpg?s=128&g=1", "display_name": "infused", "link": "https://stackoverflow.com/users/2456433/infused"}, "edited": false, "score": 1, "creation_date": 1426715522, "post_id": 29133099, "comment_id": 46492506, "body": "What is expected input and output?"}, {"owner": {"reputation": 153, "user_id": 1508437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e3baa79395cebd7b016e13602c80884?s=128&d=identicon&r=PG", "display_name": "skad0", "link": "https://stackoverflow.com/users/1508437/skad0"}, "reply_to_user": {"reputation": 22303, "user_id": 2456433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiN8K.jpg?s=128&g=1", "display_name": "infused", "link": "https://stackoverflow.com/users/2456433/infused"}, "edited": false, "score": 0, "creation_date": 1426715877, "post_id": 29133099, "comment_id": 46492650, "body": "For example input like: lorem ipsum lorem dolor sit amet. a tut toje est lorem! i tuta toje lorem?"}, {"owner": {"reputation": 153, "user_id": 1508437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e3baa79395cebd7b016e13602c80884?s=128&d=identicon&r=PG", "display_name": "skad0", "link": "https://stackoverflow.com/users/1508437/skad0"}, "reply_to_user": {"reputation": 22303, "user_id": 2456433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiN8K.jpg?s=128&g=1", "display_name": "infused", "link": "https://stackoverflow.com/users/2456433/infused"}, "edited": false, "score": 0, "creation_date": 1426715923, "post_id": 29133099, "comment_id": 46492674, "body": "And output will be this word is &quot;lorem&quot;"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1426718056, "post_id": 29133099, "comment_id": 46493506, "body": "Please add your expected input and output to your question, not to comments. That helps people answering you."}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 1508437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e3baa79395cebd7b016e13602c80884?s=128&d=identicon&r=PG", "display_name": "skad0", "link": "https://stackoverflow.com/users/1508437/skad0"}, "edited": false, "score": 0, "creation_date": 1426717343, "post_id": 29133677, "comment_id": 46493253, "body": "This great, thank you. But can you explain what means &amp;:split ?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 153, "user_id": 1508437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e3baa79395cebd7b016e13602c80884?s=128&d=identicon&r=PG", "display_name": "skad0", "link": "https://stackoverflow.com/users/1508437/skad0"}, "edited": false, "score": 1, "creation_date": 1426717455, "post_id": 29133677, "comment_id": 46493299, "body": "<code>d.map(&amp;:split)</code> gives the same result as <code>d.map { |a| s.split }</code>; it converts each string <code>s</code> in <code>d</code> to an array of words contained in <code>s</code>. If those arrays (in <code>e</code>) are <code>a1</code>, <code>a2</code> and <code>a3</code>, <code>e.reduce { |a,b| b &amp; a }</code> is equivalent to <code>a1 &amp; a2 &amp; a3</code>."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1426718978, "post_id": 29133677, "comment_id": 46493844, "body": "While in this example <code>[.!?]</code> works, I&#39;d recommend using the POSIX <code>[[:punct:]]</code> class instead because it contains all punctuation."}, {"owner": {"reputation": 17720, "user_id": 498594, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/EYtd3.png?s=128&g=1", "display_name": "Kelvin", "link": "https://stackoverflow.com/users/498594/kelvin"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1426719162, "post_id": 29133677, "comment_id": 46493909, "body": "@theTinMan <code>[[:punct:]]</code> will match commas, so it wouldn&#39;t fit the requirement of splitting on sentences."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1426719364, "post_id": 29133677, "comment_id": 46493973, "body": "That&#39;s true, the OP was stripping commas."}, {"owner": {"reputation": 17720, "user_id": 498594, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/EYtd3.png?s=128&g=1", "display_name": "Kelvin", "link": "https://stackoverflow.com/users/498594/kelvin"}, "reply_to_user": {"reputation": 153, "user_id": 1508437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e3baa79395cebd7b016e13602c80884?s=128&d=identicon&r=PG", "display_name": "skad0", "link": "https://stackoverflow.com/users/1508437/skad0"}, "edited": false, "score": 1, "creation_date": 1426719520, "post_id": 29133677, "comment_id": 46494024, "body": "@skad0 I suggest taking some time to understand how to use both<code>reduce</code> and the binary <code>&amp;</code> operator when used on arrays (if you don&#39;t understand already). They are a large part of what makes this solution so short &amp; elegant."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 5, "last_activity_date": 1426718437, "last_edit_date": 1426718437, "creation_date": 1426716709, "answer_id": 29133677, "question_id": 29133099, "link": "https://stackoverflow.com/questions/29133099/find-common-words-in-sentences-with-ruby/29133677#29133677", "title": "Find common words in sentences with Ruby", "body": "<p>You could do this (I modified your example slightly):</p>\n\n<pre><code>str = \"a lorem ipsum lorem dolor sit amet. a tut toje est lorem! a i tuta toje lorem?\"  \n\n str.split(/[.!?]/).map(&amp;:split).reduce(:&amp;)\n  #=&gt; [\"a\", \"lorem\"] \n</code></pre>\n\n<p>We have:</p>\n\n<pre><code>d = str.split(/[.!?]/)\n  #=&gt; [\"a lorem ipsum lorem dolor sit amet\",\n  #    \" a tut toje est lorem\",\n  #    \" a i tuta toje lorem\"] \ne = d.map(&amp;:split)\n  #=&gt; [[\"a\", \"lorem\", \"ipsum\", \"lorem\", \"dolor\", \"sit\", \"amet\"],\n  #    [\"a\", \"tut\", \"toje\", \"est\", \"lorem\"],\n  #    [\"a\", \"i\", \"tuta\", \"toje\", \"lorem\"]] \ne.reduce(:&amp;)\n  #=&gt; [\"a\", \"lorem\"] \n</code></pre>\n\n<p>To make it case-insensitive, change <code>str.split...</code> to <code>str.downcase.split...</code>.</p>\n"}], "owner": {"reputation": 153, "user_id": 1508437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e3baa79395cebd7b016e13602c80884?s=128&d=identicon&r=PG", "display_name": "skad0", "link": "https://stackoverflow.com/users/1508437/skad0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 0, "accepted_answer_id": 29133677, "answer_count": 1, "score": 2, "last_activity_date": 1426719496, "creation_date": 1426714264, "last_edit_date": 1426719496, "question_id": 29133099, "link": "https://stackoverflow.com/questions/29133099/find-common-words-in-sentences-with-ruby", "title": "Find common words in sentences with Ruby", "body": "<p>I have a task to find words that are in each sentence. </p>\n\n<p>Given a string and we want to divide the string into sentences and then determine which words, if any, are in all the sentences.</p>\n\n<p>Here is my solution:</p>\n\n<pre><code># encoding: utf-8\ntext = ''\nFile.foreach(\"lab2.in\") do |line|\n    text += line\nend\nhash = Hash.new\ntext = text.gsub(/[\\n,]/,'').split(/[!.?]/)\nnumber = 0\ntext.each do |sen|\n        number += 1\n        words = sen.split(/ /)\n        words.each do |word|\n                if hash[word]\n                        hash[word] += \"#{number}\"\n                else\n                        hash[word] = \"#{number}\"\n                end\n        end\nend\nflag = false\nneedle = ''\ncount = text.length\nfor i in 1..count\n        needle += \"#{i}\"\nend\nhash.each do |word|\n        if word[1].squeeze == needle\n                puts \"this word is \\\"#{word[0]}\\\"\"\n                flag = true\n        end\nend\nif !flag\n        puts \"There no such word\"\nend\n</code></pre>\n\n<p>How this task can be solved maybe more prettily? I'm interested in Ruby library methods. A simple solution, like character-by-character cycle I already know.</p>\n\n<p>For example, with input like:</p>\n\n<pre><code>lorem ipsum dolor and another lorem! sit amet lorem? and another lorem.\n</code></pre>\n\n<p>The output will be:</p>\n\n<pre><code>this word is \"lorem\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "answers": [{"tags": [], "owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "is_accepted": true, "score": 4, "last_activity_date": 1426722793, "last_edit_date": 1426722793, "creation_date": 1426717288, "answer_id": 29133820, "question_id": 29133057, "link": "https://stackoverflow.com/questions/29133057/how-does-this-lambda-function-passed-to-devises-authenticated-method-work/29133820#29133820", "title": "How does this lambda function passed to Devise&#39;s authenticated method work?", "body": "<p>Rails allows routes to be constrained based on a set of rules using <code>constraints</code> within the routing definition. See the <a href=\"http://apidock.com/rails/v4.1.8/ActionDispatch/Routing/Mapper/Scoping/constraints\" rel=\"nofollow\">Dynamic request matching</a> example in the API docs.</p>\n\n<p>Devise is using this within its <code>authenticated</code> method. The source for this is <a href=\"https://github.com/plataformatec/devise/blob/885597025af45913aa92e6964fa0e1bfd05950a4/lib/devise/rails/routes.rb\" rel=\"nofollow\">here</a>.</p>\n\n<p>The <code>authenticated</code> method looks like this:</p>\n\n<pre><code>def authenticated(scope=nil, block=nil)\n  constraints_for(:authenticate?, scope, block) do\n    yield\n  end\nend\n</code></pre>\n\n<p>and is calling <code>constraints_for</code>:</p>\n\n<pre><code>def constraints_for(method_to_apply, scope=nil, block=nil)\n  constraint = lambda do |request|\n    request.env['warden'].send(method_to_apply, scope: scope) &amp;&amp;\n      (block.nil? || block.call(request.env[\"warden\"].user(scope)))\n  end\n\n  constraints(constraint) do\n    yield\n  end\nend \n</code></pre>\n\n<p>So <code>scope</code> is <code>:user</code> and <code>method_to_apply</code> is <code>:authenticate?</code> and <code>request.env[\"warden\"]</code> is an object <a href=\"https://github.com/hassox/warden/wiki/overview\" rel=\"nofollow\">injected into the environment by Warden</a> that allows you to check for authentication.</p>\n\n<p>This means the <code>constraint = ...</code> is creating a lambda that calls <code>authenticate?</code> and then calls your block e.g. <code>|u| u.is_test</code> with <code>u</code>set to the result of <code>request.env[\"warden\"].user</code> (i.e. the current user after <code>authenticate?</code> has been called)</p>\n\n<p>That lambda is then passed as the dynamic request matching to <code>constraints</code> which in turn yields the block where <code>// route stuff here</code> would go!</p>\n"}], "owner": {"reputation": 48313, "user_id": 123415, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/dVXEK.jpg?s=128&g=1", "display_name": "jcuenod", "link": "https://stackoverflow.com/users/123415/jcuenod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 554, "favorite_count": 0, "accepted_answer_id": 29133820, "answer_count": 1, "score": 4, "last_activity_date": 1426722793, "creation_date": 1426714127, "last_edit_date": 1495540616, "question_id": 29133057, "link": "https://stackoverflow.com/questions/29133057/how-does-this-lambda-function-passed-to-devises-authenticated-method-work", "title": "How does this lambda function passed to Devise&#39;s authenticated method work?", "body": "<p>In <a href=\"https://stackoverflow.com/questions/12589061/rails-devise-current-user-is-undefined-in-a-matches-advanced-route-constraint\">this</a> question, @user2205763 suggested using the lambda function:</p>\n\n<pre><code>authenticated :user, lambda {|u| u.is_test } do\n    // route stuff here\nend\n</code></pre>\n\n<p>I assume that it is somehow turning <code>:user</code> into an actual <code>Devise</code> <code>User</code> object (<code>u</code>) but how is it doing that - what is it actually doing?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "rubymine", "rubymine-7"], "answers": [{"tags": [], "owner": {"reputation": 6602, "user_id": 3425360, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-D0hYGNyMGPo/AAAAAAAAAAI/AAAAAAAAA1c/wVJzgXu5zZI/photo.jpg?sz=128", "display_name": "Sharvy Ahmed", "link": "https://stackoverflow.com/users/3425360/sharvy-ahmed"}, "is_accepted": false, "score": 9, "last_activity_date": 1614193399, "last_edit_date": 1614193399, "creation_date": 1426714268, "answer_id": 29133100, "question_id": 29133040, "link": "https://stackoverflow.com/questions/29133040/uninitialized-constant-error-in-ruby-class/29133100#29133100", "title": "Uninitialized constant error in Ruby class", "body": "<p>You have defined the initialize method but forgot to assign the values into instance variables and a typo in your code triggered the error, fixed it as:</p>\n<p>book.rb</p>\n<pre><code>class Book\n  def initialize(name,author)\n    @name = name\n    @author = author\n  end\nend\n</code></pre>\n<p>test.rb</p>\n<pre><code>require './book'\nclass Test\n  harry_potter = Book.new(&quot;Harry Potter&quot;, &quot;JK&quot;)\nend\n</code></pre>\n<p>So, which book or resource are you following? I think you should at least complete a book to get proper knowledge of Ruby and Object Oriented Programming. I would suggest you 'The Book of Ruby' to start with.</p>\n"}, {"comments": [{"owner": {"reputation": 22836, "user_id": 152786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/581hP.jpg?s=128&g=1", "display_name": "smathy", "link": "https://stackoverflow.com/users/152786/smathy"}, "reply_to_user": {"reputation": 161, "user_id": 3368723, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100003720676657/picture?type=large", "display_name": "TheKilz", "link": "https://stackoverflow.com/users/3368723/thekilz"}, "edited": false, "score": 3, "creation_date": 1426718534, "post_id": 29133393, "comment_id": 46493689, "body": "You should also <a href=\"http://stackoverflow.com/help/accepted-answer\">accept my answer</a> if it&#39;s the best one and helped you fix your problem. See <a href=\"http://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question?</a> for full details on all this stuff."}], "tags": [], "owner": {"reputation": 22836, "user_id": 152786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/581hP.jpg?s=128&g=1", "display_name": "smathy", "link": "https://stackoverflow.com/users/152786/smathy"}, "is_accepted": false, "score": 22, "last_activity_date": 1426715511, "creation_date": 1426715511, "answer_id": 29133393, "question_id": 29133040, "link": "https://stackoverflow.com/questions/29133040/uninitialized-constant-error-in-ruby-class/29133393#29133393", "title": "Uninitialized constant error in Ruby class", "body": "<p>You're getting the error because your <code>require 'book'</code> line is requiring some other <code>book.rb</code> from somewhere else, which doesn't define a <code>Book</code> class.</p>\n\n<p>Ruby does not automatically include the current directory in the list of directories it will search for a <code>require</code> so you should explicitly prepend a <code>./</code> if you want to require a file in the current directory, ie.</p>\n\n<pre><code>require './book'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 187, "user_id": 228271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c465ec8414f2ff014861292a0c6990b7?s=128&d=identicon&r=PG", "display_name": "JP.", "link": "https://stackoverflow.com/users/228271/jp"}, "is_accepted": true, "score": 0, "last_activity_date": 1521148779, "creation_date": 1521148779, "answer_id": 49309418, "question_id": 29133040, "link": "https://stackoverflow.com/questions/29133040/uninitialized-constant-error-in-ruby-class/49309418#49309418", "title": "Uninitialized constant error in Ruby class", "body": "<p>In a Rails app this error can also be caused by renaming the class without renaming the file to match, which was my issue when I found this error:</p>\n\n<p>book.rb</p>\n\n<pre><code>class Book\n  def initialize(name, author)\n  end\nend\n</code></pre>\n\n<p>book_test.rb</p>\n\n<pre><code>class BookTest\n  harry_potter = Book.new(\"Harry Potter\", \"JK\")\nend\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 3368723, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100003720676657/picture?type=large", "display_name": "TheKilz", "link": "https://stackoverflow.com/users/3368723/thekilz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54375, "favorite_count": 1, "accepted_answer_id": 49309418, "answer_count": 3, "score": 12, "last_activity_date": 1614193563, "creation_date": 1426714064, "last_edit_date": 1614193563, "question_id": 29133040, "link": "https://stackoverflow.com/questions/29133040/uninitialized-constant-error-in-ruby-class", "title": "Uninitialized constant error in Ruby class", "body": "<p>I have these two classes in RubyMine:</p>\n<p><code>book.rb</code>:</p>\n<pre><code> class Book\n   def initialize(name,author)\n   end\n end\n</code></pre>\n<p><code>test.rb</code>:</p>\n<pre><code>require 'book'\nclass teste\n   harry_potter = Book.new(&quot;Harry Potter&quot;, &quot;JK&quot;)\nend\n</code></pre>\n<p>When I run <code>test.rb</code>, I get this error:</p>\n<pre class=\"lang-none prettyprint-override\"><code>C:/Users/DESKTOP/RubymineProjects/learning/test.rb:3:in `&lt;class:Test&gt;': uninitialized constant Test::Book (NameError)\nfrom C:/Users/DESKTOP/RubymineProjects/learning/test.rb:1:in `&lt;top (required)&gt;'\nfrom -e:1:in `load'\nfrom -e:1:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "variable-assignment"], "comments": [{"owner": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "edited": false, "score": 0, "creation_date": 1426714062, "post_id": 29132975, "comment_id": 46491822, "body": "Temp and string are the same object."}, {"owner": {"reputation": 1678, "user_id": 637283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ad72c3b6f2ce379c6effd3a0d7c6f43?s=128&d=identicon&r=PG", "display_name": "Mike Lyons", "link": "https://stackoverflow.com/users/637283/mike-lyons"}, "reply_to_user": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "edited": false, "score": 0, "creation_date": 1426714257, "post_id": 29132975, "comment_id": 46491917, "body": "@FrederickCheung, is that a reference instead of a copy?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1426714357, "post_id": 29132975, "comment_id": 46491959, "body": "If I add <code>puts &quot;string.object_id == #{string.object_id}, temp.object_id == #{temp.object_id}&quot;</code> after <code>temp = string</code>, when I execute <code>reverse(&quot;abc&quot;)</code>, the following is printed:  <code>string.object_id == 70267640537340, temp.object_id == 70267640537340</code>. Does that tell you something? You need <code>temp = string.dup</code> (though I haven&#39;t looked at the rest of your code)."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4687205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3656ac58d916ff35b427d813e9ba5fb8?s=128&d=identicon&r=PG&f=1", "display_name": "n00b", "link": "https://stackoverflow.com/users/4687205/n00b"}, "edited": false, "score": 0, "creation_date": 1426717025, "post_id": 29133082, "comment_id": 46493137, "body": "worked perfectly thanks. Do you guys know if there is any literature that educate me on &quot;=&quot; assignment operator on Ruby. It seems to be very different from what I used to with variables. Thank you again!"}, {"owner": {"reputation": 3, "user_id": 4687205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3656ac58d916ff35b427d813e9ba5fb8?s=128&d=identicon&r=PG&f=1", "display_name": "n00b", "link": "https://stackoverflow.com/users/4687205/n00b"}, "reply_to_user": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1426743735, "post_id": 29133082, "comment_id": 46500134, "body": "@MarkThomas and what is that may I ask?"}], "tags": [], "owner": {"reputation": 22303, "user_id": 2456433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiN8K.jpg?s=128&g=1", "display_name": "infused", "link": "https://stackoverflow.com/users/2456433/infused"}, "is_accepted": true, "score": 0, "last_activity_date": 1426714198, "creation_date": 1426714198, "answer_id": 29133082, "question_id": 29132975, "link": "https://stackoverflow.com/questions/29132975/string-array-assignment-in-ruby-function/29133082#29133082", "title": "String array assignment in Ruby function", "body": "<p><code>temp</code> and <code>string</code> are the same object because of:</p>\n\n<pre><code>temp = string\n</code></pre>\n\n<p>So, any changes to <code>string</code> will be reflected in <code>temp</code>. You can duplicate the string variable instead to avoid this problem:</p>\n\n<pre><code>temp = string.dup\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4687205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3656ac58d916ff35b427d813e9ba5fb8?s=128&d=identicon&r=PG&f=1", "display_name": "n00b", "link": "https://stackoverflow.com/users/4687205/n00b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 29133082, "answer_count": 1, "score": 0, "last_activity_date": 1426714198, "creation_date": 1426713844, "question_id": 29132975, "link": "https://stackoverflow.com/questions/29132975/string-array-assignment-in-ruby-function", "title": "String array assignment in Ruby function", "body": "<p>I am new to Ruby and pretty new to programming in general. Have no idea why string[n]=temp[string.length-(n+1)] would change temp as a string array. Isn't the assignment ONLY changes string array? I have been on this problem for 4 hours, any help would be very appreciated =) thank you!</p>\n\n<pre><code> def reverse(string)\n  temp = string\n  n=0\n  while (string.length - n) &gt; 0 \n    string[n]=temp[string.length-(n+1)]\n    n+=1\n  end\n  return string\nend\n\nputs reverse(\"abc\")\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ubuntu", "vagrant", "virtualbox"], "comments": [{"owner": {"reputation": 1452, "user_id": 3182171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f212461e884c83b6a0542289a8562dbf?s=128&d=identicon&r=PG&f=1", "display_name": "Diego D", "link": "https://stackoverflow.com/users/3182171/diego-d"}, "edited": false, "score": 0, "creation_date": 1458564295, "post_id": 29132891, "comment_id": 59901344, "body": "Please consider to flag my answer as the valid one. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "is_accepted": false, "score": 4, "last_activity_date": 1426715356, "creation_date": 1426715356, "answer_id": 29133362, "question_id": 29132891, "link": "https://stackoverflow.com/questions/29132891/vagrant-virtualbox-vm-provisioning-rbenv-installs-successfully-but-subsequent-u/29133362#29133362", "title": "Vagrant/VirtualBox VM provisioning: rbenv installs successfully but subsequent uses in script fail", "body": "<p>I'm surprised the provisioning script exits, as running <code>su vagrant</code> should in theory hang the script at that point (you're running the command <code>su</code> which does not normally exit by itself).</p>\n\n<p>The problem is you cannot change the user that is running a shell script \"on the fly\" by running <code>su</code>.<br>\nYour only option is to use <code>sudo</code>.</p>\n\n<p>Since you just updated <code>.bashrc</code> with a new path and other settings, you will want to run <code>\"sudo bash\"</code> with the <code>-i</code> option. This will force bash to simulate an interactive login shell, and therefore read <code>.bashrc</code> and load the correct path for <code>rbenv</code>.</p>\n\n<p>So, something like this should hopefully work:</p>\n\n<pre><code>echo \"building ruby\"\nsudo -H -u vagrant bash -i -c 'rbenv install 2.2.1 ...'\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 561, "user_id": 3447934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f772263b9b40093644f33332b1f2bed1?s=128&d=identicon&r=PG", "display_name": "soutoner", "link": "https://stackoverflow.com/users/3447934/soutoner"}, "edited": false, "score": 1, "creation_date": 1448221026, "post_id": 30106828, "comment_id": 55482903, "body": "Awesome! You&#39;ve made my day with this tip, thank you. This should be the accepted answer."}], "tags": [], "owner": {"reputation": 1452, "user_id": 3182171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f212461e884c83b6a0542289a8562dbf?s=128&d=identicon&r=PG&f=1", "display_name": "Diego D", "link": "https://stackoverflow.com/users/3182171/diego-d"}, "is_accepted": true, "score": 24, "last_activity_date": 1583920780, "last_edit_date": 1583920780, "creation_date": 1431016289, "answer_id": 30106828, "question_id": 29132891, "link": "https://stackoverflow.com/questions/29132891/vagrant-virtualbox-vm-provisioning-rbenv-installs-successfully-but-subsequent-u/30106828#30106828", "title": "Vagrant/VirtualBox VM provisioning: rbenv installs successfully but subsequent uses in script fail", "body": "<p>I had a similar problem because I was trying to <strong>install rbenv</strong> and the vagrant provisioning was giving me the error:</p>\n\n<pre><code>==&gt; default: /tmp/vagrant-shell: line 10: rbenv: command not found\n</code></pre>\n\n<p><strong>First of all, it is very important to understand that vagrant provisioning script is running in sudo mode</strong>.\nSo, when in the script we refer to ~/ path, we are referring to /root/ path and not to /home/vagrant/ path.\nThe problem is that I was installing rbenv for the root user and after trying to call rbenv command from a vagrant user and, of course, it didn't work!</p>\n\n<p>So, what I did is specify the vagrant to run the provisioner NOT in sudo user, adding <strong>privileged: false</strong>:</p>\n\n<pre><code>config.vm.provision :shell, privileged: false, inline: $script\n</code></pre>\n\n<p>Then in my script I considered everything as being called from the vagrant user.\n<strong>Here @Casper answer helped me a lot, because it works only specifying:\nsudo -H -u vagrant bash -i -c '......'</strong></p>\n\n<blockquote>\n  <p>Since you just updated .bashrc with a new path and other settings, you\n  will want to run \"sudo bash\" with the -i option. This will force bash\n  to simulate an interactive login shell, and therefore read .bashrc and\n  load the correct path for rbenv.</p>\n</blockquote>\n\n<p><strong>Below is my final Vagrantfile.</strong></p>\n\n<pre><code># -*- mode: ruby -*-\n# vi: set ft=ruby :\n\n$script = &lt;&lt;SCRIPT\n  sudo apt-get -y update\n  sudo apt-get -y install curl git-core python-software-properties ruby-dev libpq-dev build-essential nginx libsqlite3-0 libsqlite3-dev libxml2 libxml2-dev libxslt1-dev nodejs postgresql postgresql-contrib imagemagick\n\n  git clone https://github.com/sstephenson/rbenv.git ~/.rbenv\n  echo 'export PATH=\"$HOME/.rbenv/bin:$PATH\"' &gt;&gt; ~/.bashrc\n  echo 'eval \"$(rbenv init -)\"'               &gt;&gt; ~/.bashrc\n  source ~/.bashrc\n\n  git clone https://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build\n  sudo -H -u vagrant bash -i -c 'rbenv install 2.1.3'\n  sudo -H -u vagrant bash -i -c 'rbenv rehash'\n  sudo -H -u vagrant bash -i -c 'rbenv global 2.1.3'\n  sudo -H -u vagrant bash -i -c 'gem install bundler --no-ri --no-rdoc'\n  sudo -H -u vagrant bash -i -c 'rbenv rehash'\n  sudo -u postgres createdb --locale en_US.utf8 --encoding UTF8 --template template0 development\n  echo \"ALTER USER postgres WITH PASSWORD \\'develop\\';\" | sudo -u postgres psql\nSCRIPT\n\nVAGRANTFILE_API_VERSION = \"2\"\n\nVagrant.configure(VAGRANTFILE_API_VERSION) do |config|\n  config.vm.box = \"hashicorp/precise64\"\n  config.vm.network \"forwarded_port\", guest: 3000, host: 3000\n\n  # config.vm.provider :virtualbox do |vb|\n  #   vb.customize [\"modifyvm\", :id, \"--memory\", \"1024\"]\n  # end\n\n  config.vm.provision :shell, privileged: false, inline: $script\nend\n</code></pre>\n\n<p>Hope it will be helpful to someone else.</p>\n"}, {"tags": [], "owner": {"reputation": 4546, "user_id": 1908296, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/g39kn.jpg?s=128&g=1", "display_name": "ahmed hamdy", "link": "https://stackoverflow.com/users/1908296/ahmed-hamdy"}, "is_accepted": false, "score": 1, "last_activity_date": 1564287076, "last_edit_date": 1564287076, "creation_date": 1564286582, "answer_id": 57237844, "question_id": 29132891, "link": "https://stackoverflow.com/questions/29132891/vagrant-virtualbox-vm-provisioning-rbenv-installs-successfully-but-subsequent-u/57237844#57237844", "title": "Vagrant/VirtualBox VM provisioning: rbenv installs successfully but subsequent uses in script fail", "body": "<p>There another Solution to install <code>rbenv</code> within Vagrant Provisioning process different than both <a href=\"https://stackoverflow.com/a/29133362/1908296\">@Casper</a> and <a href=\"https://stackoverflow.com/a/30106828/1908296\">@Diego D</a> solutions.</p>\n\n<p>Using Next Commands before using <code>rbenv</code> commands</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>export PATH=\"$HOME/.rbenv/bin:$PATH\"\nexport PATH=\"$HOME/.rbenv/plugins/ruby-build/bin:$PATH\"\neval \"$(rbenv init -)\"\n</code></pre>\n\n<p>Then run <code>rbenv</code> install commands without <code>sudo -H -u vagrant bash -i -c</code></p>\n\n<p><strong>Bootstrap.sh File</strong></p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>#!/usr/bin/env bash\n\nsudo apt-get update\necho \"========================= install dependencies for install rbenv ===========================\"\nsudo apt-get install -y autoconf bison build-essential libssl-dev libyaml-dev libreadline6-dev zlib1g-dev libncurses5-dev libffi-dev libgdbm3 libgdbm-dev\necho \"========================= install rbenv ==========================================\"\ngit clone https://github.com/rbenv/rbenv.git ~/.rbenv\necho 'export PATH=\"$HOME/.rbenv/bin:$PATH\"' &gt;&gt;  ~/.bashrc\necho 'eval \"$(rbenv init -)\"' &gt;&gt;  ~/.bashrc\necho \"========================= install ruby build plugin for rbenv =======================\"\ngit clone https://github.com/rbenv/ruby-build.git  ~/.rbenv/plugins/ruby-build\necho 'export PATH=\"$HOME/.rbenv/plugins/ruby-build/bin:$PATH\"' &gt;&gt; ~/.bashrc\necho \"========================= install ruby v2.5.0 ==========================================\"\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\nexport PATH=\"$HOME/.rbenv/plugins/ruby-build/bin:$PATH\"\neval \"$(rbenv init -)\"\nrbenv install 2.5.0\nrbenv global 2.5.0\nruby -v\ngem -v\necho \"========================= install bundler dependencies manager for ruby =====================\"\ngem install bundler\nrbenv rehash\n\n</code></pre>\n\n<p><strong>Then <code>VagrantFile</code> file will include vagrant provisioning line</strong> </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>deploy_config.vm.provision :shell, privileged: false, path: \"bootstrap.sh\"\n</code></pre>\n\n<p>Source for my Answer from <a href=\"https://gist.github.com/creisor/e20f254a89070f46b91cc3e0c5cd18db\" rel=\"nofollow noreferrer\">Gits by @creisor</a></p>\n"}], "owner": {"reputation": 6202, "user_id": 1066615, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/iv68W.png?s=128&g=1", "display_name": "sixty4bit", "link": "https://stackoverflow.com/users/1066615/sixty4bit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3095, "favorite_count": 9, "accepted_answer_id": 30106828, "answer_count": 3, "score": 13, "last_activity_date": 1583920780, "creation_date": 1426713529, "question_id": 29132891, "link": "https://stackoverflow.com/questions/29132891/vagrant-virtualbox-vm-provisioning-rbenv-installs-successfully-but-subsequent-u", "title": "Vagrant/VirtualBox VM provisioning: rbenv installs successfully but subsequent uses in script fail", "body": "<p>I am using Vagrant + VirtualBox to set up a virtual machine for my Rails app. I am working on cleaning up a <code>.sh</code> provisioning script that is referenced in <code>Vagrantfile</code> like so:</p>\n\n<pre><code>config.vm.provision \"shell\", path: \"script/provision-script.sh\" \n</code></pre>\n\n<p>The provision script does a number of things, but towards the end it is supposed to install rbenv Ruby versioning and then use rbenv to install Ruby 2.2.1. That part of the provision script looks like this:</p>\n\n<pre><code>echo \"setting up rbenv\"\n# execute the remaining commands as vagrant user, instead of root\nsudo -H -u vagrant bash -c \"git clone https://github.com/sstephenson/rbenv.git ~vagrant/.rbenv\"\nsudo -H -u vagrant bash -c \"git clone https://github.com/sstephenson/ruby-build.git ~vagrant/.rbenv/plugins/ruby-build\"\nsudo -H -u vagrant bash -c \"git clone https://github.com/sstephenson/rbenv-gem-rehash.git ~vagrant/.rbenv/plugins/rbenv-gem-rehash\"\necho \"setting up rbenv environment in bash\"\necho 'export PATH=\"$HOME/.rbenv/bin:$PATH\"' &gt;&gt; ~vagrant/.bashrc\necho 'eval \"$(rbenv init -)\"' &gt;&gt; ~vagrant/.bashrc\n\n# start new vagrant shell so rbenv will work\necho \"building ruby\"\nsu vagrant\nrbenv install 2.2.1 &amp;&amp; rbenv global 2.2.1 &amp;&amp; rbenv rehash &amp;&amp; cd /path/to/my/app &amp;&amp; gem install bundler rake &amp;&amp; rbenv rehash &amp;&amp; bundle &amp;&amp; rbenv rehash\n</code></pre>\n\n<p>Everything up to the <code>rbenv install...</code> part works correctly. Installing ruby fails with the following error:</p>\n\n<pre><code>==&gt; default: setting up rbenv\n==&gt; default: Cloning into '/home/vagrant/.rbenv'...\n==&gt; default: Cloning into '/home/vagrant/.rbenv/plugins/ruby-build'...\n==&gt; default: Cloning into '/home/vagrant/.rbenv/plugins/rbenv-gem-rehash'...\n==&gt; default: setting up rbenv environment in bash\n==&gt; default: building ruby\n==&gt; default: /tmp/vagrant-shell: line 73: rbenv: command not found\n</code></pre>\n\n<p>The script then finishes. I can open the vm with <code>vagrant ssh</code> and then successfully run <code>rbenv install 2.2.1</code>, so I'm guessing that during provisioning a new vagrant shell is not actually being started. I was under the impression that this should happen with <code>su vagrant</code> right before <code>rbenv install 2.2.1</code>. </p>\n\n<p>What can I do to make sure that a new shell is initialized during this provisioning and that the <code>rbenv</code> command will work?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "apache", "passenger", "digital-ocean"], "comments": [{"owner": {"reputation": 3314, "user_id": 157816, "user_type": "registered", "profile_image": "https://graph.facebook.com/694328230/picture?type=large", "display_name": "baxang", "link": "https://stackoverflow.com/users/157816/baxang"}, "edited": false, "score": 0, "creation_date": 1426725781, "post_id": 29132681, "comment_id": 46495818, "body": "Maybe misconfigured  <code>passenger_root</code>? or bundler not installed?"}, {"owner": {"reputation": 456, "user_id": 4664987, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/n0Q7w.jpg?s=128&g=1", "display_name": "Alfredo Bejarano", "link": "https://stackoverflow.com/users/4664987/alfredo-bejarano"}, "reply_to_user": {"reputation": 3314, "user_id": 157816, "user_type": "registered", "profile_image": "https://graph.facebook.com/694328230/picture?type=large", "display_name": "baxang", "link": "https://stackoverflow.com/users/157816/baxang"}, "edited": false, "score": 0, "creation_date": 1426727404, "post_id": 29132681, "comment_id": 46496239, "body": "in wich file is suppossed to be the passenger_root line? Because if I run the command  bundler -v , It returns bundler 1.8.5 so I don&#180;t think is bundler, or maybe I installed it wrong"}, {"owner": {"reputation": 3314, "user_id": 157816, "user_type": "registered", "profile_image": "https://graph.facebook.com/694328230/picture?type=large", "display_name": "baxang", "link": "https://stackoverflow.com/users/157816/baxang"}, "edited": false, "score": 0, "creation_date": 1426727523, "post_id": 29132681, "comment_id": 46496265, "body": "It should be in on of your apache conf files. The one you can run on command line is different from the one the web server(Apache) uses. What was your method to install Ruby and Passenger?"}, {"owner": {"reputation": 456, "user_id": 4664987, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/n0Q7w.jpg?s=128&g=1", "display_name": "Alfredo Bejarano", "link": "https://stackoverflow.com/users/4664987/alfredo-bejarano"}, "reply_to_user": {"reputation": 3314, "user_id": 157816, "user_type": "registered", "profile_image": "https://graph.facebook.com/694328230/picture?type=large", "display_name": "baxang", "link": "https://stackoverflow.com/users/157816/baxang"}, "edited": false, "score": 0, "creation_date": 1426745605, "post_id": 29132681, "comment_id": 46500734, "body": "using wget , I followed the instructions in this tutorial  <a href=\"https://www.digitalocean.com/community/tutorials/how-to-deploy-a-rails-app-with-passenger-and-apache-on-ubuntu-14-04\" rel=\"nofollow noreferrer\">digitalocean.com/community/tutorials/&hellip;</a>"}], "owner": {"reputation": 456, "user_id": 4664987, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/n0Q7w.jpg?s=128&g=1", "display_name": "Alfredo Bejarano", "link": "https://stackoverflow.com/users/4664987/alfredo-bejarano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1426712788, "creation_date": 1426712788, "question_id": 29132681, "link": "https://stackoverflow.com/questions/29132681/error-with-bundler-deploying-ruby-on-rails-app-in-digitalocean", "title": "Error with bundler deploying Ruby on Rails app in DigitalOcean", "body": "<p>Im trying to deploy an app in a DigitalOcean Ubuntu 14.04 x32 Droplet with apache2 and Passenger, everything works fine until I open the IP adress of my droplet, It shows a passenger page with this error message:</p>\n\n<pre><code>Web application could not be started\n\ncannot load such file -- bundler/setup (LoadError)\n  /usr/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n  /usr/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n  /usr/lib/ruby/vendor_ruby/phusion_passenger/loader_shared_helpers.rb:278:in `block in run_load_path_setup_code'\n  /usr/lib/ruby/vendor_ruby/phusion_passenger/loader_shared_helpers.rb:381:in `running_bundler'\n  /usr/lib/ruby/vendor_ruby/phusion_passenger/loader_shared_helpers.rb:276:in `run_load_path_setup_code'\n  /usr/share/passenger/helper-scripts/rack-preloader.rb:99:in `preload_app'\n  /usr/share/passenger/helper-scripts/rack-preloader.rb:157:in `&lt;module:App&gt;'\n  /usr/share/passenger/helper-scripts/rack-preloader.rb:29:in `&lt;module:PhusionPassenger&gt;'\n  /usr/share/passenger/helper-scripts/rack-preloader.rb:28:in `&lt;main&gt;'\n</code></pre>\n\n<p>I don't know why the problem originates but Im desesperate, I been searched a lot about this problem but none of the solutions I found works for me :(</p>\n"}, {"tags": ["ruby", "service", "centos"], "comments": [{"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 1, "creation_date": 1426732616, "post_id": 29132535, "comment_id": 46497511, "body": "What account is the script running under when it runs via the daemon? Maybe output <code>whoami</code> at the beginning of your script to check?"}, {"owner": {"reputation": 690, "user_id": 2992299, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y9CzE.jpg?s=128&g=1", "display_name": "CatsLoveJazz", "link": "https://stackoverflow.com/users/2992299/catslovejazz"}, "reply_to_user": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1426752774, "post_id": 29132535, "comment_id": 46503228, "body": "whoami returns root in the init.d script. Why does this behave diffrerently and what can I do to remedy this?"}], "answers": [{"comments": [{"owner": {"reputation": 690, "user_id": 2992299, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y9CzE.jpg?s=128&g=1", "display_name": "CatsLoveJazz", "link": "https://stackoverflow.com/users/2992299/catslovejazz"}, "edited": false, "score": 0, "creation_date": 1426759153, "post_id": 29140920, "comment_id": 46506530, "body": "You are correct, env shows that I do not have ruby or gem in paths. What are my options here? How to I add these to the root path or conversely run the script as the current user? My aim is to have a transparent service that will work whoever is logged in."}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1426780955, "post_id": 29140920, "comment_id": 46520972, "body": "You could log in as root and install the needed gems. Normally people have problems because they do the opposite, they install their ruby stuff as root or <code>sudo</code> and then can&#39;t find it under their profile. You want to give the root profile the gems it needs to run. Are you using anything like rbenv or rvm?"}, {"owner": {"reputation": 9234, "user_id": 4629810, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh4.googleusercontent.com/-gcabh64Le4c/AAAAAAAAAAI/AAAAAAAAAQ8/GquVsg_lVoA/photo.jpg?sz=128", "display_name": "Mircea", "link": "https://stackoverflow.com/users/4629810/mircea"}, "edited": false, "score": 0, "creation_date": 1426782307, "post_id": 29140920, "comment_id": 46521874, "body": "one option is to just setup the path before running the commands. Copy the paths you have in the normal env and setup exports. Installing the gems as root will not help if you don&#39;t have the path correctly setup. Another option is to source rvm or rbenv (or whatever you are using) before the execution."}], "tags": [], "owner": {"reputation": 9234, "user_id": 4629810, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh4.googleusercontent.com/-gcabh64Le4c/AAAAAAAAAAI/AAAAAAAAAQ8/GquVsg_lVoA/photo.jpg?sz=128", "display_name": "Mircea", "link": "https://stackoverflow.com/users/4629810/mircea"}, "is_accepted": true, "score": 1, "last_activity_date": 1426757280, "creation_date": 1426757280, "answer_id": 29140920, "question_id": 29132535, "link": "https://stackoverflow.com/questions/29132535/require-cannot-load-such-file-running-ruby-from-bash-script/29140920#29140920", "title": "`require&#39;: cannot load such file - Running ruby from bash script", "body": "<p>the problem is in your environment (the env vars).\nrun</p>\n\n<pre><code>env\n</code></pre>\n\n<p>in the normal environment and after that run it from the init script and pipe the output to a file.</p>\n\n<p>look at the differences.</p>\n\n<p>GOing to guess you are missing all the ruby specific stuff(GEM_PATH and all)</p>\n"}], "owner": {"reputation": 690, "user_id": 2992299, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y9CzE.jpg?s=128&g=1", "display_name": "CatsLoveJazz", "link": "https://stackoverflow.com/users/2992299/catslovejazz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 981, "favorite_count": 0, "accepted_answer_id": 29140920, "answer_count": 1, "score": 1, "last_activity_date": 1426757280, "creation_date": 1426712359, "last_edit_date": 1426718037, "question_id": 29132535, "link": "https://stackoverflow.com/questions/29132535/require-cannot-load-such-file-running-ruby-from-bash-script", "title": "`require&#39;: cannot load such file - Running ruby from bash script", "body": "<p>I am trying to run a ruby script as a service on my centos machine. I can run the ruby script direct from the command line and from a bash file without issue. </p>\n\n<p>However, when I try to run it as a service via /etc/init.d I get the error <code>'require': cannot load such file</code> -- somegem.</p>\n\n<pre><code>#! /home/user/.rvm/rubies/ruby-2.1.5/bin/ruby\n# encoding: utf-8\n\nrequire \"somegem\"\n</code></pre>\n\n<p>I have created an init.d script and placed that in /etc/init.d/</p>\n\n<pre><code>#!/bin/sh\n# monitor_endpoint\n# chkconfig: 2345 20 80\n\n# Source function library.\n. /etc/rc.d/init.d/functions\n\n#Define variables\nprog=\"monitor_endpoint\"\nexec=/home/user/Workspaces/test/bin/test.rb\necho $exec\n\nstart() {\n    echo -n $\"Starting $prog: \"\n    # use daemon to start the service\n    daemon $exec &amp;\n    retval=$?\n    echo\n    return $retval\n}\n\netc...\n</code></pre>\n\n<p>Would this be a problem with my gems installation path?</p>\n\n<p>Any help would be much appreciated as this is my first attempt at running a ruby script in this way. Thank you.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rvm"], "comments": [{"owner": {"reputation": 6602, "user_id": 3425360, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-D0hYGNyMGPo/AAAAAAAAAAI/AAAAAAAAA1c/wVJzgXu5zZI/photo.jpg?sz=128", "display_name": "Sharvy Ahmed", "link": "https://stackoverflow.com/users/3425360/sharvy-ahmed"}, "edited": false, "score": 0, "creation_date": 1426714706, "post_id": 29132452, "comment_id": 46492113, "body": "Did my solution worked?"}, {"owner": {"reputation": 33, "user_id": 2891343, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q9cG0.jpg?s=128&g=1", "display_name": "user2891343", "link": "https://stackoverflow.com/users/2891343/user2891343"}, "reply_to_user": {"reputation": 6602, "user_id": 3425360, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-D0hYGNyMGPo/AAAAAAAAAAI/AAAAAAAAA1c/wVJzgXu5zZI/photo.jpg?sz=128", "display_name": "Sharvy Ahmed", "link": "https://stackoverflow.com/users/3425360/sharvy-ahmed"}, "edited": false, "score": 1, "creation_date": 1426801336, "post_id": 29132452, "comment_id": 46531809, "body": "yes that worked, but I was looking to understand at a system level why it was happening so I could correct the root cause"}, {"owner": {"reputation": 6602, "user_id": 3425360, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-D0hYGNyMGPo/AAAAAAAAAAI/AAAAAAAAA1c/wVJzgXu5zZI/photo.jpg?sz=128", "display_name": "Sharvy Ahmed", "link": "https://stackoverflow.com/users/3425360/sharvy-ahmed"}, "edited": false, "score": 0, "creation_date": 1426802218, "post_id": 29132452, "comment_id": 46532177, "body": "I thought the problem was not fixed and you didn&#39;t ask for any explanation! People are helping us for nothing, and we can at least let them know what&#39;s wrong with their solution and acknowledge the help if any. :)"}, {"owner": {"reputation": 321, "user_id": 4833784, "user_type": "registered", "accept_rate": 48, "profile_image": "https://graph.facebook.com/10152831522811616/picture?type=large", "display_name": "Mike W", "link": "https://stackoverflow.com/users/4833784/mike-w"}, "edited": false, "score": 0, "creation_date": 1440483520, "post_id": 29132452, "comment_id": 52278359, "body": "actually this was answered for me here    [<a href=\"http://stackoverflow.com/questions/21334389/how-to-make-fish-shell-use-an-rvm-ruby-by-default][1]\" title=\"how to make fish shell use an rvm ruby by default%5d%5b1%5d\">stackoverflow.com/questions/21334389/&hellip;</a>        [1]: <a href=\"http://stackoverflow.com/questions/21334389/how-to-make-fish-shell-use-an-rvm-ruby-by-default\" title=\"how to make fish shell use an rvm ruby by default\">stackoverflow.com/questions/21334389/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6602, "user_id": 3425360, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-D0hYGNyMGPo/AAAAAAAAAAI/AAAAAAAAA1c/wVJzgXu5zZI/photo.jpg?sz=128", "display_name": "Sharvy Ahmed", "link": "https://stackoverflow.com/users/3425360/sharvy-ahmed"}, "is_accepted": true, "score": 0, "last_activity_date": 1426802890, "last_edit_date": 1426802890, "creation_date": 1426712969, "answer_id": 29132725, "question_id": 29132452, "link": "https://stackoverflow.com/questions/29132452/rvm-using-wrong-ruby-version/29132725#29132725", "title": "RVM using wrong ruby version", "body": "<p>I faced the same problem after a fresh install of my OS, selecting <code>Run command as a login shell</code> in my terminal solved the problem.</p>\n\n<pre><code>Terminal &gt; \nEdit &gt; \nProfile Preference &gt; \nTitle and Command &gt; \n(Check) **Run command as a login shell**\nRestart Terminal\n</code></pre>\n\n<blockquote>\n  <p>Login shells (typically when a terminal window is opened) will use <code>.bash_profile</code> but interactive, non-login shells reference <code>.bashrc</code> (likely where the rvm shell code are loaded).</p>\n</blockquote>\n"}], "owner": {"reputation": 33, "user_id": 2891343, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q9cG0.jpg?s=128&g=1", "display_name": "user2891343", "link": "https://stackoverflow.com/users/2891343/user2891343"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 602, "favorite_count": 0, "accepted_answer_id": 29132725, "answer_count": 1, "score": 3, "last_activity_date": 1426802890, "creation_date": 1426712082, "last_edit_date": 1426714559, "question_id": 29132452, "link": "https://stackoverflow.com/questions/29132452/rvm-using-wrong-ruby-version", "title": "RVM using wrong ruby version", "body": "<p>I had problems with ruby and in the process of fixing it I installed a newer version. However, when I open up a terminal window and type <code>ruby -v</code>, I get - <code>ruby 2.0.0p247 (2013-06-27 revision 41674) [x86_64-darwin13.2.0]</code></p>\n\n<p>This version is corrupt (e.g. I can't run rails s)</p>\n\n<p>If I run this command: <code>rvm --default use ruby-2.1.4</code>, then everything is right in the world and I'm good... until I open a new terminal window. </p>\n\n<p>Can someone help me understand where I set my default version to 2.1.4?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "associations"], "answers": [{"comments": [{"owner": {"reputation": 9993, "user_id": 393243, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4eb947f56eb4bc26b638112412e4cf85?s=128&d=identicon&r=PG", "display_name": "Adam Grant", "link": "https://stackoverflow.com/users/393243/adam-grant"}, "edited": false, "score": 0, "creation_date": 1426712850, "post_id": 29132591, "comment_id": 46491173, "body": "Does the try account for the fact that message may not have a question parent?"}, {"owner": {"reputation": 22836, "user_id": 152786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/581hP.jpg?s=128&g=1", "display_name": "smathy", "link": "https://stackoverflow.com/users/152786/smathy"}, "reply_to_user": {"reputation": 9993, "user_id": 393243, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4eb947f56eb4bc26b638112412e4cf85?s=128&d=identicon&r=PG", "display_name": "Adam Grant", "link": "https://stackoverflow.com/users/393243/adam-grant"}, "edited": false, "score": 0, "creation_date": 1426713333, "post_id": 29132591, "comment_id": 46491453, "body": "Yes, <a href=\"http://api.rubyonrails.org/classes/Object.html#method-i-try\" rel=\"nofollow noreferrer\">see the docs for it here</a>."}, {"owner": {"reputation": 9993, "user_id": 393243, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4eb947f56eb4bc26b638112412e4cf85?s=128&d=identicon&r=PG", "display_name": "Adam Grant", "link": "https://stackoverflow.com/users/393243/adam-grant"}, "edited": false, "score": 0, "creation_date": 1426713620, "post_id": 29132591, "comment_id": 46491607, "body": "Thanks, so would a simple <code>has_many :messages</code> work as an association for the <code>Question</code> object?"}, {"owner": {"reputation": 22836, "user_id": 152786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/581hP.jpg?s=128&g=1", "display_name": "smathy", "link": "https://stackoverflow.com/users/152786/smathy"}, "reply_to_user": {"reputation": 9993, "user_id": 393243, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4eb947f56eb4bc26b638112412e4cf85?s=128&d=identicon&r=PG", "display_name": "Adam Grant", "link": "https://stackoverflow.com/users/393243/adam-grant"}, "edited": false, "score": 0, "creation_date": 1426713812, "post_id": 29132591, "comment_id": 46491695, "body": "Yes, as long as you have <code>question_id</code> field in your <code>messages</code> table then that will work fine."}], "tags": [], "owner": {"reputation": 22836, "user_id": 152786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/581hP.jpg?s=128&g=1", "display_name": "smathy", "link": "https://stackoverflow.com/users/152786/smathy"}, "is_accepted": true, "score": 1, "last_activity_date": 1426712544, "creation_date": 1426712544, "answer_id": 29132591, "question_id": 29132383, "link": "https://stackoverflow.com/questions/29132383/has-many-through-but-only-sometimes/29132591#29132591", "title": "has_many :through but only sometimes?", "body": "<p>Essentially what you want to do is create some methods in <code>Message</code> to handle the whole <code>if question.present?</code> check, eg.</p>\n\n<pre><code>class Message &lt; ActiveRecord::Base\n  belongs_to :question\n\n  def category\n    question.try(:category) || \"-\"\n  end\n\n  # ...\nend\n</code></pre>\n\n<p>So then you could do something like this in your view:</p>\n\n<pre><code>@messages.each do |m|\n  = \"[#{m.category}] #{m.text}\"\n</code></pre>\n"}], "owner": {"reputation": 9993, "user_id": 393243, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4eb947f56eb4bc26b638112412e4cf85?s=128&d=identicon&r=PG", "display_name": "Adam Grant", "link": "https://stackoverflow.com/users/393243/adam-grant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 29132591, "answer_count": 1, "score": 1, "last_activity_date": 1426712702, "creation_date": 1426711798, "last_edit_date": 1426712702, "question_id": 29132383, "link": "https://stackoverflow.com/questions/29132383/has-many-through-but-only-sometimes", "title": "has_many :through but only sometimes?", "body": "<p>I have an app that contains many <code>Users</code> where each  <code>User</code> has many <code>Questions</code></p>\n\n<p><strong>Why I need to do this</strong></p>\n\n<p>Now, we want the ability to scoop up some <code>Messages</code> into <code>Questions</code>. This is complicated because not all <code>Messages</code> will belong to a <code>Question</code>. Here is an example:</p>\n\n<pre><code>- = Not (really) a question\nx = Belongs to question x\ny = Belongs to question y\n\n[-] Hey\n[-] Hey, what's up?\n[x] Not much. Hey, what's a good movie to see tonight?\n[x] How about Star Wars?\n[x] Great idea! Thanks.\n[-] You bet.\n[-] Star wars is awesome.\n[-] Yeah it is.\n[-] Hey I have another question\n[-] Shoot\n[y] Where should I go on vacation this summer?\n[y] Go to France, it's beautiful.\n[y] Yeah, I'll go to France.\n[-] Any other questions?\n[-] No, but thanks for your help.\n</code></pre>\n\n<p><strong>What needs to happen</strong></p>\n\n<p>As an end result, I would want to see a stream of messages and mark the ones that are part of a question, as above. So it would be nice to do something like</p>\n\n<pre><code>@messages.each do |message|\n  if not message.question.blank?\n    ...\n</code></pre>\n\n<p>And I would like to mark the category (attribute of <code>Question</code>) of the question.</p>\n\n<pre><code>@message.question.update(category: 3)\n</code></pre>\n\n<p>I'd also like to view a single question and apply categories to it so I can pull up something like this:</p>\n\n<pre><code>p = @question.category\nul\n  @question.messages.each do |message|\n    li = message.content\n</code></pre>\n\n<p>My concern is that messages won't always be related to a question at all. So <strong>how should I structure my data?</strong></p>\n\n<p><strong>Update</strong></p>\n\n<p>One more thing I forgot to mention is that the data should be output ultimately as JSON.</p>\n"}, {"tags": ["ruby", "tomdoc"], "comments": [{"owner": {"reputation": 1835, "user_id": 764601, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/386571a6fd12fc72ff39593da1af15c3?s=128&d=identicon&r=PG", "display_name": "maasha", "link": "https://stackoverflow.com/users/764601/maasha"}, "edited": false, "score": 0, "creation_date": 1426711317, "post_id": 29132225, "comment_id": 46490370, "body": "Can someone add a #TomDoc tag?"}], "answers": [{"tags": [], "owner": {"reputation": 25150, "user_id": 383888, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Kd57u.jpg?s=128&g=1", "display_name": "Mori", "link": "https://stackoverflow.com/users/383888/mori"}, "is_accepted": true, "score": 3, "last_activity_date": 1426711864, "creation_date": 1426711864, "answer_id": 29132396, "question_id": 29132225, "link": "https://stackoverflow.com/questions/29132225/using-tomdoc-in-ruby-what-is-the-correct-way-to-denote-a-splat-argument/29132396#29132396", "title": "Using TomDoc in Ruby, what is the correct way to denote a splat argument?", "body": "<p>Lacking a rule from TomDoc, what you have is reasonable. All that's needed is to well document the argument so that users of the method know how to call it.</p>\n\n<p>In this case though I don't think the splat should be part of the name, since it doesn't go along with the call. Better to add a usage example instead, e.g.</p>\n\n<pre><code># allowed - One or more options\n#\n# Examples\n#\n#   option_check({foo: :bar}, :baz, :qux, :quux)\n</code></pre>\n"}], "owner": {"reputation": 1835, "user_id": 764601, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/386571a6fd12fc72ff39593da1af15c3?s=128&d=identicon&r=PG", "display_name": "maasha", "link": "https://stackoverflow.com/users/764601/maasha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 29132396, "answer_count": 1, "score": 1, "last_activity_date": 1438193633, "creation_date": 1426711281, "last_edit_date": 1438193633, "question_id": 29132225, "link": "https://stackoverflow.com/questions/29132225/using-tomdoc-in-ruby-what-is-the-correct-way-to-denote-a-splat-argument", "title": "Using TomDoc in Ruby, what is the correct way to denote a splat argument?", "body": "<p>The <a href=\"http://tomdoc.org/\" rel=\"nofollow\">TomDoc</a> format fails to give an example of a splat argument - how should it be done?:</p>\n\n<pre><code># Public: method to check allowed options.\n#\n# options  - Hash with options to check.\n# *allowed - Splat Array with allowed options.\n#\n# Returns nothing.\ndef options_check(options, *allowed)\n  # code here\nend\n</code></pre>\n"}, {"tags": ["ruby", "many-to-many", "one-to-many", "sequel"], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 1676117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44579a2e83f158107c26a2e81311a31f?s=128&d=identicon&r=PG", "display_name": "user1676117", "link": "https://stackoverflow.com/users/1676117/user1676117"}, "is_accepted": false, "score": 0, "last_activity_date": 1426714128, "creation_date": 1426714128, "answer_id": 29133058, "question_id": 29132186, "link": "https://stackoverflow.com/questions/29132186/one-to-many-association-through-a-join-table/29133058#29133058", "title": "one_to_many association through a join table", "body": "<p>After getting on IRC with Jeremy Evans, he said I should use the following options on a <code>many_to_many</code>. </p>\n\n<pre><code>:left_primary_key=&gt;:cart_id, :left_key=&gt;:id, :right_key=&gt;:id, :right_primary_key=&gt;:cart_id\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 1676117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44579a2e83f158107c26a2e81311a31f?s=128&d=identicon&r=PG", "display_name": "user1676117", "link": "https://stackoverflow.com/users/1676117/user1676117"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1581279861, "creation_date": 1426711131, "last_edit_date": 1581279861, "question_id": 29132186, "link": "https://stackoverflow.com/questions/29132186/one-to-many-association-through-a-join-table", "title": "one_to_many association through a join table", "body": "<p>I'm trying to do a one_to_many association through a join table.</p>\n\n<p>I have <code>Orders</code> with a <code>cart_id</code> field pointing to a <code>Cart</code>, which has no relevant keys. In the <code>CartItem</code> table there's a <code>cart_id</code> pointing to the cart. Poring through the documentation, I see how to implement the case where the <code>Cart</code> has a <code>order_id</code> column, the <code>many_to_many</code> association but not for the other way around. <code>many_to_many</code> seems to expect the left key to be in the join table. And <code>one_to_many</code> seems to not allow the use of a join table at all. Or maybe I'm just missing something?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 22836, "user_id": 152786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/581hP.jpg?s=128&g=1", "display_name": "smathy", "link": "https://stackoverflow.com/users/152786/smathy"}, "edited": false, "score": 2, "creation_date": 1426709404, "post_id": 29131649, "comment_id": 46489178, "body": "Add three bits of code to your question please: (1) the code for the controller where you&#39;re setting the flash, (2) the layout code and (3) the view code."}, {"owner": {"reputation": 95, "user_id": 3984491, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7e84f3255fb4e060f75698a309fedc90?s=128&d=identicon&r=PG&f=1", "display_name": "David Johnson", "link": "https://stackoverflow.com/users/3984491/david-johnson"}, "reply_to_user": {"reputation": 22836, "user_id": 152786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/581hP.jpg?s=128&g=1", "display_name": "smathy", "link": "https://stackoverflow.com/users/152786/smathy"}, "edited": false, "score": 0, "creation_date": 1426710869, "post_id": 29131649, "comment_id": 46490067, "body": "@smathy I&#39;ve added the code, any suggestions?"}], "answers": [{"tags": [], "owner": {"reputation": 666, "user_id": 2337188, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/aCiAF.gif?s=128&g=1", "display_name": "digijim", "link": "https://stackoverflow.com/users/2337188/digijim"}, "is_accepted": true, "score": 2, "last_activity_date": 1426711502, "creation_date": 1426711502, "answer_id": 29132287, "question_id": 29131649, "link": "https://stackoverflow.com/questions/29131649/michael-hartl-double-flash-error/29132287#29132287", "title": "Michael Hartl Double Flash Error", "body": "<p>Change...</p>\n\n<pre><code>&lt;% flash.each do |message_type, message| %&gt;\n  &lt;%= content_tag(:div, message, class: \"alert alert-#{message_type}\") %&gt;\n  &lt;div class=\"alert alert-&lt;%= message_type %&gt;\"&gt;&lt;%= message %&gt;&lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>to...</p>\n\n<pre><code>  &lt;% flash.each do |message_type, message| %&gt;\n    &lt;%= content_tag(:div, message, class: \"alert alert-#{message_type}\") %&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>The flash behavior isn't the issue.  You're rendering error messages twice because you're duplicating the error message div in your <code>flash.each do ...</code> block.</p>\n"}, {"tags": [], "owner": {"reputation": 22836, "user_id": 152786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/581hP.jpg?s=128&g=1", "display_name": "smathy", "link": "https://stackoverflow.com/users/152786/smathy"}, "is_accepted": false, "score": 0, "last_activity_date": 1426711561, "creation_date": 1426711561, "answer_id": 29132304, "question_id": 29131649, "link": "https://stackoverflow.com/questions/29131649/michael-hartl-double-flash-error/29132304#29132304", "title": "Michael Hartl Double Flash Error", "body": "<p>Yes, it's very clear, look at your loop:</p>\n\n<pre><code>&lt;% flash.each do |message_type, message| %&gt;\n  &lt;%= content_tag(:div, message, class: \"alert alert-#{message_type}\") %&gt;\n  &lt;div class=\"alert alert-&lt;%= message_type %&gt;\"&gt;&lt;%= message %&gt;&lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>You're outputting two <code>div</code>s per loop (ie. per flash message), one using the <code>content_tag</code> helper, and one using the <code>&lt;div</code> literal text.  Remove one of them.</p>\n"}], "owner": {"reputation": 95, "user_id": 3984491, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7e84f3255fb4e060f75698a309fedc90?s=128&d=identicon&r=PG&f=1", "display_name": "David Johnson", "link": "https://stackoverflow.com/users/3984491/david-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 29132287, "answer_count": 2, "score": 0, "last_activity_date": 1426711561, "creation_date": 1426709053, "last_edit_date": 1426710935, "question_id": 29131649, "link": "https://stackoverflow.com/questions/29131649/michael-hartl-double-flash-error", "title": "Michael Hartl Double Flash Error", "body": "<p>I've been following the Michael Hartl guide and the only error that I see (but the system doesn't catch), is that every time there is a flash like in the image below, the alert shows up twice as opposed to once. I've spent way too long troubleshooting this. Where would I edit the flash behavior.</p>\n\n<p><a href=\"http://imgur.com/Lws5z4o\" rel=\"nofollow\">http://imgur.com/Lws5z4o</a></p>\n\n<p>Here is my User Controller</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n\n before_action :logged_in_user, only: [:index, :edit, :update, :destroy]\n before_action :correct_user,   only: [:edit, :update]\n before_action :admin_user,     only: :destroy\n\n\n  def index\n    @users = User.paginate(page: params[:page])\n  end\n\n  def show\n    @user = User.find(params[:id])\n  end\n\n  def new\n    @user = User.new\n  end\n\n  def create\n    @user = User.new(user_params)    # Not the final implementation!\n    if @user.save\n      UserMailer.account_activation(@user).deliver_now\n      flash[:info] = \"Please check your email to activate your account.\"\n      redirect_to root_url\n    else\n      render 'new'\n    end\n  end\n\n  def destroy\n    User.find(params[:id]).destroy\n    flash[:success] = \"User deleted\"\n    redirect_to users_url\n  end\n\n\n  def edit\n    @user = User.find(params[:id])\n  end\n\n  def update\n    @user = User.find(params[:id])\n    if @user.update_attributes(user_params)\n       flash[:success] = \"Profile Updated\"\n       redirect_to @user\n    else\n      render 'edit'\n    end\n  end\n\n    private\n\n   def user_params\n          params.require(:user).permit(:name, :email, :password,\n                                       :password_confirmation)\n   end\n\n  #Before filters\n\n  def logged_in_user\n    unless logged_in?\n      store_location\n      flash[:danger] = \"Please log in.\"\n      redirect_to login_url\n\n    end\n  end\n\n # Confirms an admin user.\n    def admin_user\n      redirect_to(root_url) unless current_user.admin?\n    end\n\n # Confirms the correct user.\n    def correct_user\n      @user = User.find(params[:id])\n     redirect_to(root_url) unless current_user?(@user)\n    end\n\nend\n</code></pre>\n\n<p>My Application Layout</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;title&gt;&lt;%= full_title(yield(:title)) %&gt;&lt;/title&gt;\n    &lt;%= stylesheet_link_tag 'application', media: 'all',\n    'data-turbolinks-track' =&gt; true %&gt;\n    &lt;%= javascript_include_tag 'application', 'data-turbolinks-track' =&gt; true %&gt;\n    &lt;%= csrf_meta_tags %&gt;\n    &lt;%= render 'layouts/shim' %&gt;\n    &lt;!--[if lt IE 9]&gt;\n      &lt;script src=\"//cdnjs.cloudflare.com/ajax/libs/html5shiv/r29/html5.min.js\"&gt;\n      &lt;/script&gt;\n    &lt;![endif]--&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;%= render 'layouts/header' %&gt;\n    &lt;div class=\"container\"&gt;\n     &lt;% flash.each do |message_type, message| %&gt;\n     &lt;%= content_tag(:div, message, class: \"alert alert-#{message_type}\") %&gt;\n        &lt;div class=\"alert alert-&lt;%= message_type %&gt;\"&gt;&lt;%= message %&gt;&lt;/div&gt;\n      &lt;% end %&gt;\n      &lt;%= yield %&gt;\n    &lt;%= render 'layouts/footer' %&gt;\n    &lt;%= debug(params) if Rails.env.development? %&gt;\n    &lt;/div&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "multithreading", "passenger"], "comments": [{"owner": {"reputation": 20735, "user_id": 307106, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6a13e655e637138f8d571cec3f9cea76?s=128&d=identicon&r=PG", "display_name": "jrochkind", "link": "https://stackoverflow.com/users/307106/jrochkind"}, "edited": false, "score": 0, "creation_date": 1426715890, "post_id": 29131631, "comment_id": 46492658, "body": "No. Even in free passenger, you should not count on the thread being the same accross requests. Free passenger doesn&#39;t really have &#39;concurrent&#39; requests at all. BUT. In general, you should never expect the the current thread to ever be the same from request to request -- but it MAY be for consecutive requests, threads may be re-used."}, {"owner": {"reputation": 11463, "user_id": 1009332, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/134ceddfdac5709794fc23957211ebdb?s=128&d=identicon&r=PG", "display_name": "justingordon", "link": "https://stackoverflow.com/users/1009332/justingordon"}, "reply_to_user": {"reputation": 20735, "user_id": 307106, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6a13e655e637138f8d571cec3f9cea76?s=128&d=identicon&r=PG", "display_name": "jrochkind", "link": "https://stackoverflow.com/users/307106/jrochkind"}, "edited": false, "score": 0, "creation_date": 1426739389, "post_id": 29131631, "comment_id": 46499026, "body": "I&#39;m not trying to keep a value across requests. I&#39;m trying to keep a value for the entire duration of a request."}], "answers": [{"comments": [{"owner": {"reputation": 11463, "user_id": 1009332, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/134ceddfdac5709794fc23957211ebdb?s=128&d=identicon&r=PG", "display_name": "justingordon", "link": "https://stackoverflow.com/users/1009332/justingordon"}, "edited": false, "score": 0, "creation_date": 1426712696, "post_id": 29132041, "comment_id": 46491090, "body": "Thanks Chris. Please take a look at the update I posted above."}, {"owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "reply_to_user": {"reputation": 11463, "user_id": 1009332, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/134ceddfdac5709794fc23957211ebdb?s=128&d=identicon&r=PG", "display_name": "justingordon", "link": "https://stackoverflow.com/users/1009332/justingordon"}, "edited": false, "score": 0, "creation_date": 1426712886, "post_id": 29132041, "comment_id": 46491191, "body": "RequestStore seems like it&#39;s just using threadlocals which get cleared after each request. I&#39;m not convinced that&#39;s going to fix the issue for you. Are you using EventMachine/something else that is going to invoke fibers for concurrency, and what version of Ruby are you running this under?"}, {"owner": {"reputation": 11463, "user_id": 1009332, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/134ceddfdac5709794fc23957211ebdb?s=128&d=identicon&r=PG", "display_name": "justingordon", "link": "https://stackoverflow.com/users/1009332/justingordon"}, "edited": false, "score": 0, "creation_date": 1426747386, "post_id": 29132041, "comment_id": 46501312, "body": "Because a controller request will be handled by a given thread from start to end, the issue I actually had was that the value stuck around after the end of the request. RequestStore solved that perfectly."}], "tags": [], "owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "is_accepted": false, "score": 1, "last_activity_date": 1426710586, "last_edit_date": 1495540616, "creation_date": 1426710586, "answer_id": 29132041, "question_id": 29131631, "link": "https://stackoverflow.com/questions/29131631/phusion-passenger-server-free-vs-enterprise-version-and-thread-local-variables/29132041#29132041", "title": "Phusion Passenger Server Free vs. Enterprise Version and Thread Local Variables", "body": "<p>If you want a request-local variable, consider putting it into the Rack request env object. See <a href=\"https://stackoverflow.com/questions/848591/how-do-i-access-the-rack-environment-from-within-rails\">the answers on this question</a> for a more complete rundown.</p>\n\n<p>Regarding thread locals, that certainly seems like unexpected behavior, but it's entirely possible that Passenger is doing something that doesn't guarantee that a single thread will be owned by a request for its whole lifetime. The <code>Rack::Lock</code> middleware usually solves this by taking a mutex around the whole request, but if you've removed it, you aren't guaranteed to have that synchronization. In general, thread-local variables are a code smell and probably an indicator that you're doing something you shouldn't.</p>\n"}, {"tags": [], "owner": {"reputation": 11463, "user_id": 1009332, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/134ceddfdac5709794fc23957211ebdb?s=128&d=identicon&r=PG", "display_name": "justingordon", "link": "https://stackoverflow.com/users/1009332/justingordon"}, "is_accepted": false, "score": 0, "last_activity_date": 1426716656, "creation_date": 1426716656, "answer_id": 29133670, "question_id": 29131631, "link": "https://stackoverflow.com/questions/29131631/phusion-passenger-server-free-vs-enterprise-version-and-thread-local-variables/29133670#29133670", "title": "Phusion Passenger Server Free vs. Enterprise Version and Thread Local Variables", "body": "<p>Solved:</p>\n\n<ul>\n<li><a href=\"https://github.com/airblade/paper_trail/issues/499#issuecomment-83175865\" rel=\"nofollow\">https://github.com/airblade/paper_trail/issues/499#issuecomment-83175865</a></li>\n<li><a href=\"https://github.com/steveklabnik/request_store\" rel=\"nofollow\">https://github.com/steveklabnik/request_store</a></li>\n</ul>\n\n<p>Thread.current[:something] is not as you'd expect with Thin and Passenger!!</p>\n\n<p>Not sure about Unicorn and Puma.</p>\n\n<p>Add the request_store gem, and follow the instructions to solve this issue.</p>\n"}], "owner": {"reputation": 11463, "user_id": 1009332, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/134ceddfdac5709794fc23957211ebdb?s=128&d=identicon&r=PG", "display_name": "justingordon", "link": "https://stackoverflow.com/users/1009332/justingordon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1426716656, "creation_date": 1426708990, "last_edit_date": 1426712558, "question_id": 29131631, "link": "https://stackoverflow.com/questions/29131631/phusion-passenger-server-free-vs-enterprise-version-and-thread-local-variables", "title": "Phusion Passenger Server Free vs. Enterprise Version and Thread Local Variables", "body": "<p>Is it expected that the current thread will be the same across concurrent requests to \"free\" passenger?</p>\n\n<p>I've got a bug in that thread local ruby variables are not independent to concurrent requests. I.e., the same thread id shows for both of two concurrent requests (simulated with a sleep to slow things down).</p>\n\n<p>Is this different for Passenger enterprise edition?</p>\n\n<p>Is there a proper way to get a thread local variable that is isolated for the life of a single request in Rails?</p>\n\n<p>UPDATED:</p>\n\n<ol>\n<li>Problem is not specific to Passenger. Problem is there for Thin as well.</li>\n<li>Other libraries, such as paper_trail may have this issue: <a href=\"https://github.com/airblade/paper_trail/issues/499\" rel=\"nofollow\">https://github.com/airblade/paper_trail/issues/499</a></li>\n<li>Here's a potential fix: <a href=\"https://github.com/steveklabnik/request_store\" rel=\"nofollow\">https://github.com/steveklabnik/request_store</a>, along with a detailed description of the issue I'm seeing.</li>\n</ol>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 516, "user_id": 1010748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0177b2583d30009f1d7e7761a376e6f1?s=128&d=identicon&r=PG", "display_name": "Marcus Brunsten", "link": "https://stackoverflow.com/users/1010748/marcus-brunsten"}, "edited": false, "score": 0, "creation_date": 1426709131, "post_id": 29131580, "comment_id": 46489009, "body": "Hmm, didnt get it to work. perhaps i missplaces them?"}, {"owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "reply_to_user": {"reputation": 516, "user_id": 1010748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0177b2583d30009f1d7e7761a376e6f1?s=128&d=identicon&r=PG", "display_name": "Marcus Brunsten", "link": "https://stackoverflow.com/users/1010748/marcus-brunsten"}, "edited": false, "score": 0, "creation_date": 1426709169, "post_id": 29131580, "comment_id": 46489028, "body": "Try ensuring that the module exists and has the methods you are interested in before you patch it. What behavior are you seeing?"}, {"owner": {"reputation": 516, "user_id": 1010748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0177b2583d30009f1d7e7761a376e6f1?s=128&d=identicon&r=PG", "display_name": "Marcus Brunsten", "link": "https://stackoverflow.com/users/1010748/marcus-brunsten"}, "edited": false, "score": 0, "creation_date": 1426709416, "post_id": 29131580, "comment_id": 46489188, "body": "InstanceMethods, such as translated_attributes gives &quot;undefined method `translated_attributes&#39;&quot;. But my foo method is there."}], "tags": [], "owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "is_accepted": false, "score": 1, "last_activity_date": 1426708813, "creation_date": 1426708813, "answer_id": 29131580, "question_id": 29131393, "link": "https://stackoverflow.com/questions/29131393/extend-a-gem-module-with-an-instance-method/29131580#29131580", "title": "Extend a gem module with an instance method", "body": "<p>You probably just need to be sure you require the module before monkeypatching it; if it is relying on the autoloader to load those files, then defining them will prevent the autoloader from attempting to require them. Globalize is indeed relying on the autoloader, as <a href=\"https://github.com/globalize/globalize/blob/master/lib/globalize/active_record.rb\" rel=\"nofollow\">seen here</a>.</p>\n\n<p>To fix it, explicitly require those modules before patching them:</p>\n\n<pre><code> require 'globalize'\n require 'globalize/active_record'\n require 'globalize/active_record/instance_methods'\n\n # Patch your stuff here.\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 516, "user_id": 1010748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0177b2583d30009f1d7e7761a376e6f1?s=128&d=identicon&r=PG", "display_name": "Marcus Brunsten", "link": "https://stackoverflow.com/users/1010748/marcus-brunsten"}, "edited": false, "score": 0, "creation_date": 1426709446, "post_id": 29131732, "comment_id": 46489203, "body": "where would i put this? In an initilizer?"}, {"owner": {"reputation": 2513, "user_id": 1414596, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/68952cca8d9631003516ac20e2b39f25?s=128&d=identicon&r=PG", "display_name": "roxxypoxxy", "link": "https://stackoverflow.com/users/1414596/roxxypoxxy"}, "reply_to_user": {"reputation": 516, "user_id": 1010748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0177b2583d30009f1d7e7761a376e6f1?s=128&d=identicon&r=PG", "display_name": "Marcus Brunsten", "link": "https://stackoverflow.com/users/1010748/marcus-brunsten"}, "edited": false, "score": 0, "creation_date": 1426776233, "post_id": 29131732, "comment_id": 46517520, "body": "Yeah. You can make a .rb file at config/initializers/   or you should be able to put it in lib folder also"}], "tags": [], "owner": {"reputation": 2513, "user_id": 1414596, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/68952cca8d9631003516ac20e2b39f25?s=128&d=identicon&r=PG", "display_name": "roxxypoxxy", "link": "https://stackoverflow.com/users/1414596/roxxypoxxy"}, "is_accepted": true, "score": 2, "last_activity_date": 1426709398, "creation_date": 1426709398, "answer_id": 29131732, "question_id": 29131393, "link": "https://stackoverflow.com/questions/29131393/extend-a-gem-module-with-an-instance-method/29131732#29131732", "title": "Extend a gem module with an instance method", "body": "<p>You can do </p>\n\n<pre><code>Globalize::ActiveRecord::InstanceMethods.class_eval do\n    # patch methods\nend\n</code></pre>\n"}], "owner": {"reputation": 516, "user_id": 1010748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0177b2583d30009f1d7e7761a376e6f1?s=128&d=identicon&r=PG", "display_name": "Marcus Brunsten", "link": "https://stackoverflow.com/users/1010748/marcus-brunsten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 843, "favorite_count": 0, "accepted_answer_id": 29131732, "answer_count": 2, "score": 0, "last_activity_date": 1426710165, "creation_date": 1426708089, "last_edit_date": 1426710165, "question_id": 29131393, "link": "https://stackoverflow.com/questions/29131393/extend-a-gem-module-with-an-instance-method", "title": "Extend a gem module with an instance method", "body": "<p>Im trying to extend a InstanceMethods of a gem (Globalize) </p>\n\n<pre><code>module Globalize\n  module ActiveRecord\n    module InstanceMethods \n      def foo\n        puts \"Bar!\"\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>However, this overwrites the existing instance methods of Globalize. </p>\n\n<p>What is the correct way of giving a previously declared module additional instance methods?</p>\n\n<p>Update:\nTrying to require them doesnt seem to work either:</p>\n\n<pre><code>module Globalize\n  require 'globalize'\n  module ActiveRecord\n    require 'globalize/active_record'\n    module InstanceMethods\n      require 'globalize/active_record/instance_methods'\n      def foo\n        puts \"Bar!\"\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Update: By using answer provided by roxxypoxxy I can extend the instance methods by adding his answer to a initializer</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1426708426, "post_id": 29130861, "comment_id": 46488581, "body": "What is <code>open_session</code> with this information answer the question will be much easier. Otherwise you get people that are guessing at structure and pulling things out of thin air."}, {"owner": {"reputation": 4253, "user_id": 812660, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dNqSt.png?s=128&g=1", "display_name": "Mark Locklear", "link": "https://stackoverflow.com/users/812660/mark-locklear"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1426709191, "post_id": 29130861, "comment_id": 46489042, "body": "See edit above. Thanks for the suggestion!"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1426711817, "post_id": 29130861, "comment_id": 46490647, "body": "in that case look at @LeonidShevtsov&#39;s answer the first one should work for you."}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1426711856, "post_id": 29130961, "comment_id": 46490664, "body": "Nice guess on what <code>open_session</code> was I think your first answer should work perfectly in this case."}], "tags": [], "owner": {"reputation": 13270, "user_id": 6678, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/777894ea5153122bfa6b83f5bbf23622?s=128&d=identicon&r=PG", "display_name": "Leonid Shevtsov", "link": "https://stackoverflow.com/users/6678/leonid-shevtsov"}, "is_accepted": true, "score": 1, "last_activity_date": 1426713688, "last_edit_date": 1426713688, "creation_date": 1426706634, "answer_id": 29130961, "question_id": 29130861, "link": "https://stackoverflow.com/questions/29130861/covert-an-array-to-an-active-record-relation-in-ruby/29130961#29130961", "title": "Covert an array to an active record relation in ruby", "body": "<p>You can't do that, because an 'ActiveRecord relation' is in fact an abstraction over an SQL query. However, if can replicate the same logic as an ActiveRecord query, then you'll get the relation you want:</p>\n\n<p><code>Session.where(status_state: Session::STATUS_SUBMITTED).joins(:user).where(users: {location_id: params[:user_place_id]})</code></p>\n\n<p>and you can clean it up further with scopes.</p>\n"}, {"tags": [], "owner": {"reputation": 2597, "user_id": 1329321, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/c3c2bc221f92e4a674ac01510cf900f0?s=128&d=identicon&r=PG", "display_name": "Mike Manfrin", "link": "https://stackoverflow.com/users/1329321/mike-manfrin"}, "is_accepted": false, "score": 0, "last_activity_date": 1426707033, "creation_date": 1426707033, "answer_id": 29131083, "question_id": 29130861, "link": "https://stackoverflow.com/questions/29130861/covert-an-array-to-an-active-record-relation-in-ruby/29131083#29131083", "title": "Covert an array to an active record relation in ruby", "body": "<p>Assuming <code>:open_session</code> is meant to subselect your collection, you should make <code>:open_session</code> a scope and call it directly on the <code>where</code>:</p>\n\n<pre><code>User.where(location_id: params[:user_place_id]).open_session\n</code></pre>\n\n<p>This will return you an <code>AR::Relation</code> that you can then paginate/order.</p>\n\n<p>If you post the code for <code>open_session</code> we can help clean this up. </p>\n"}], "owner": {"reputation": 4253, "user_id": 812660, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dNqSt.png?s=128&g=1", "display_name": "Mark Locklear", "link": "https://stackoverflow.com/users/812660/mark-locklear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 29130961, "answer_count": 2, "score": 0, "last_activity_date": 1426713688, "creation_date": 1426706312, "last_edit_date": 1592644375, "question_id": 29130861, "link": "https://stackoverflow.com/questions/29130861/covert-an-array-to-an-active-record-relation-in-ruby", "title": "Covert an array to an active record relation in ruby", "body": "<p>I have the following where clause...</p>\n<pre><code>User.where(location_id: params[:user_place_id]).map(&amp;:open_session)\n</code></pre>\n<p>I would like to convert this to an Active Record relation so I can call order and pagination on it.</p>\n<p>Looks like I want to .arr, but I'm not sure how to call that in this case.</p>\n<h1>Edit</h1>\n<p>Here is the relation in the User model:</p>\n<pre><code>  has_many :open_sessions, :class_name =&gt; &quot;Session&quot;, :foreign_key =&gt; &quot;assignee_id&quot;, :conditions =&gt; &quot;status_state = #{Session::STATUS_SUBMITTED}&quot;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "comments": [{"owner": {"reputation": 8371, "user_id": 1094339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Cibe3.png?s=128&g=1", "display_name": "Deekor", "link": "https://stackoverflow.com/users/1094339/deekor"}, "edited": false, "score": 2, "creation_date": 1426705958, "post_id": 29130699, "comment_id": 46487153, "body": "Do you have any emotions in the database?"}, {"owner": {"reputation": 3840, "user_id": 1054638, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/39071d37bc0d2ca9954bf865e7ce0167?s=128&d=identicon&r=PG", "display_name": "Harsh Gupta", "link": "https://stackoverflow.com/users/1054638/harsh-gupta"}, "edited": false, "score": 1, "creation_date": 1426706331, "post_id": 29130699, "comment_id": 46487343, "body": "The parameters log, 2 lines above the highlighted line in the log, there is no parameter named <code>emotion_ids</code> inside <code>pin</code> parameter. Hence the error. As to why it works in development, you need to show us logs from development."}, {"owner": {"reputation": 427, "user_id": 3787971, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/21308605/picture?type=large", "display_name": "user3787971", "link": "https://stackoverflow.com/users/3787971/user3787971"}, "edited": false, "score": 1, "creation_date": 1426706505, "post_id": 29130699, "comment_id": 46487449, "body": "aha! no i don&#39;t have emotions in the DB yet. That&#39;s got to be the problem."}, {"owner": {"reputation": 427, "user_id": 3787971, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/21308605/picture?type=large", "display_name": "user3787971", "link": "https://stackoverflow.com/users/3787971/user3787971"}, "reply_to_user": {"reputation": 8371, "user_id": 1094339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Cibe3.png?s=128&g=1", "display_name": "Deekor", "link": "https://stackoverflow.com/users/1094339/deekor"}, "edited": false, "score": 0, "creation_date": 1426706634, "post_id": 29130699, "comment_id": 46487530, "body": "@Deekor simple solution! That was it. Thank you! if you add your answer, I&#39;ll mark it correct."}], "answers": [{"comments": [{"owner": {"reputation": 427, "user_id": 3787971, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/21308605/picture?type=large", "display_name": "user3787971", "link": "https://stackoverflow.com/users/3787971/user3787971"}, "edited": false, "score": 0, "creation_date": 1427076534, "post_id": 29131508, "comment_id": 46616440, "body": "Had to give the answer to Deekor because he was actually the first to give me the answer."}], "tags": [], "owner": {"reputation": 2409, "user_id": 4008366, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/5a9f80535627f21ba4191fea0c6a0771?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Kim", "link": "https://stackoverflow.com/users/4008366/andrew-kim"}, "is_accepted": false, "score": 1, "last_activity_date": 1426708589, "creation_date": 1426708589, "answer_id": 29131508, "question_id": 29130699, "link": "https://stackoverflow.com/questions/29130699/why-am-i-getting-this-error-on-heroku-but-not-in-development-in-my-rails-app/29131508#29131508", "title": "Why am I getting this error on heroku but not in development in my rails app?", "body": "<p>It could be you haven't seeded your database yet since you only ran a migration. If there were emotion objects in your database in your development environment they won't be in your heroku production environment. Maybe create a seed file, add some emotions to it, and see if the error still exists. It doesn't seem like a problem on heroku just seems like a lack of an object existing when you call each on it.</p>\n"}, {"tags": [], "owner": {"reputation": 8371, "user_id": 1094339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Cibe3.png?s=128&g=1", "display_name": "Deekor", "link": "https://stackoverflow.com/users/1094339/deekor"}, "is_accepted": true, "score": 1, "last_activity_date": 1426787041, "creation_date": 1426787041, "answer_id": 29151522, "question_id": 29130699, "link": "https://stackoverflow.com/questions/29130699/why-am-i-getting-this-error-on-heroku-but-not-in-development-in-my-rails-app/29151522#29151522", "title": "Why am I getting this error on heroku but not in development in my rails app?", "body": "<p>Make sure your database has some emotions in it.</p>\n"}], "owner": {"reputation": 427, "user_id": 3787971, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/21308605/picture?type=large", "display_name": "user3787971", "link": "https://stackoverflow.com/users/3787971/user3787971"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 29151522, "answer_count": 2, "score": 0, "last_activity_date": 1426787041, "creation_date": 1426705770, "question_id": 29130699, "link": "https://stackoverflow.com/questions/29130699/why-am-i-getting-this-error-on-heroku-but-not-in-development-in-my-rails-app", "title": "Why am I getting this error on heroku but not in development in my rails app?", "body": "<p>I'm getting this error in my heroku logs:</p>\n\n<p><img src=\"https://i.stack.imgur.com/wHH9y.png\" alt=\"Heroku Error\"></p>\n\n<p>Here's the create method in my pins_controller</p>\n\n<pre><code>def create\ncode = params[:pin][:code]\n@classroom = Classroom.where('code LIKE ?', code).first\nunless @classroom\n  flash[:error] = \"Classroom code incorrect\"\n  render :new\nelse\n  params[:pin][:classroom_id] = @classroom.id\nend\n\n\n  @pin = Pin.new(pin_params)\n  @pin.save\n  params[:pin][:emotion_ids].each do |emotion_id| \n    @emotion = Emotion.find(emotion_id)\n    @pin.emotions &lt;&lt; @emotion\n  end\n\n  respond_with(@pin)\n  authorize @pin\n\n end\n</code></pre>\n\n<p>I recently created a new instance of my app on a staging url and a product url (pointing to my domain) I ran rake db:migrate so that should be working and most of the other features on the site are fine. </p>\n\n<p>Why would this work locally but not in heroku?</p>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["ruby", "testing", "automated-tests", "watir-webdriver", "rautomation"], "answers": [{"tags": [], "owner": {"reputation": 1755, "user_id": 352648, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ff97ca87af59ee68ceff5877a8365788?s=128&d=identicon&r=PG", "display_name": "Jarmo Pertman", "link": "https://stackoverflow.com/users/352648/jarmo-pertman"}, "is_accepted": false, "score": 1, "last_activity_date": 1426753733, "creation_date": 1426753733, "answer_id": 29139932, "question_id": 29130383, "link": "https://stackoverflow.com/questions/29130383/ruby-automation-testing-for-web-control-on-net-form/29139932#29139932", "title": "Ruby Automation Testing for Web Control on .NET Form", "body": "<p>I don't think so that it's doable. At least not with the tools you've mentioned. However, i'd test that web application as a regular web application - e.g. through a browser - and create a separate tests to test the integration part of .NET and web application.</p>\n"}], "owner": {"reputation": 11, "user_id": 4686659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcf36f4c674c9c7fde9489f131cd7ddf?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4686659/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1426753733, "creation_date": 1426704710, "question_id": 29130383, "link": "https://stackoverflow.com/questions/29130383/ruby-automation-testing-for-web-control-on-net-form", "title": "Ruby Automation Testing for Web Control on .NET Form", "body": "<p>I'm trying use Ruby Automation to test a web application that is being displayed through a web control on a .NET form instead of your typical browser (like Internet Explorer, Firefox, etc...) and I'm not having much luck. </p>\n\n<p>I am able to use the Watir gem to access all the elements when the web page is being displayed through Internet Explore. But how do you access elements on a web page if the application is made using a .NET vb form with some kind of web control to display the website? Are there ways to use RAutomation or Watir gems to access the web elements? Or does anyone have any other suggestions that might work for me?</p>\n"}, {"tags": ["html", "ruby-on-rails", "ruby", "forms", "function"], "comments": [{"owner": {"reputation": 964, "user_id": 922592, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/677f7fdb87ded28ed533d8fd14b28a82?s=128&d=identicon&r=PG", "display_name": "Gregg Horton", "link": "https://stackoverflow.com/users/922592/gregg-horton"}, "edited": false, "score": 0, "creation_date": 1426704645, "post_id": 29130162, "comment_id": 46486365, "body": "why aren&#39;t you using the default update action?"}], "answers": [{"comments": [{"owner": {"reputation": 154, "user_id": 2627633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72363d5a4ab3619f16a12afbd0cc760f?s=128&d=identicon&r=PG", "display_name": "Shubham", "link": "https://stackoverflow.com/users/2627633/shubham"}, "edited": false, "score": 1, "creation_date": 1426704663, "post_id": 29130278, "comment_id": 46486380, "body": "instead of f.submit (which is used for form_for), we will have submit_tag (used in form_tag presented in the question)."}], "tags": [], "owner": {"reputation": 9572, "user_id": 2305826, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xRwWw.png?s=128&g=1", "display_name": "MarsAtomic", "link": "https://stackoverflow.com/users/2305826/marsatomic"}, "is_accepted": false, "score": 3, "last_activity_date": 1426705899, "last_edit_date": 1426705899, "creation_date": 1426704425, "answer_id": 29130278, "question_id": 29130162, "link": "https://stackoverflow.com/questions/29130162/how-to-make-the-submit-button-call-a-function/29130278#29130278", "title": "How to make the submit button call a function?", "body": "<p>Calling one or more methods via submit button:</p>\n\n<p>The form_tag helper determines the controller method to be called:</p>\n\n<pre><code>&lt;%= form_tag('controller/controller_method', method: 'put') do %&gt;\n</code></pre>\n\n<p>The submit_tag passes a value to the controller where it's evaluated.</p>\n\n<pre><code>&lt;%= submit_tag \"Add Person\" %&gt;\n</code></pre>\n\n<p>In the controller, you branch based on the value passed by your submit button:</p>\n\n<pre><code>def controller_method\n  if params[:commit] == \"Add Person\"\n    add_person\n  elsif params[:commit] == \"Method 2\"\n    method_2\n  elsif params[:commit] == \"Method 3\"\n    method_3\n  end\nend\n</code></pre>\n\n<p>Calling method via arbitrary button</p>\n\n<p>You probably have something like this at the bottom of your form:</p>\n\n<pre><code>  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n</code></pre>\n\n<p>which can be replaced with the <code>button_to</code> helper, like so:</p>\n\n<pre><code>  &lt;%= button_to \"Submit\", :method=&gt; 'add_person' %&gt;\n</code></pre>\n\n<p>Your <code>add_person</code> method would have to be defined in the controller for the object to which your form refers.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4686776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426705899, "creation_date": 1426704020, "question_id": 29130162, "link": "https://stackoverflow.com/questions/29130162/how-to-make-the-submit-button-call-a-function", "title": "How to make the submit button call a function?", "body": "<pre><code>&lt;%= form_tag('add_person', method: 'get') do %&gt;\n                &lt;%= label_tag(:name, 'Name') %&gt;\n                &lt;%= text_field_tag(:name) %&gt;\n                &lt;%= submit_tag 'Add new person' %&gt;\n        &lt;% end %&gt;\n\n&lt;%= def add_person\n                if params[:name] == \"John\")\n                enter code here\n                else\n                enter code here               \n                end\nend %&gt;\n</code></pre>\n\n<p>How do I make the submit button call the function add_person? I'm using Ruby/Rails</p>\n"}, {"tags": ["ruby", "web-services", "savon", "net-http", "mutual-authentication"], "comments": [{"owner": {"reputation": 3271, "user_id": 387177, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce58186c9663c82e5fef7fcca045fa57?s=128&d=identicon&r=PG", "display_name": "Steffen Roller", "link": "https://stackoverflow.com/users/387177/steffen-roller"}, "edited": false, "score": 0, "creation_date": 1426709963, "post_id": 29130061, "comment_id": 46489511, "body": "Savon uses HTTPI for the http communication. HTTPI picks one of the installed clients on your system. You should switch on logging to see which client it uses OR you can force it to use net/http. If I remember correctly then net/http is not the preferred client. I personally use HTTPClient for all my http stuff."}, {"owner": {"reputation": 5795, "user_id": 1169705, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ZWEMS.png?s=128&g=1", "display_name": "digitalextremist", "link": "https://stackoverflow.com/users/1169705/digitalextremist"}, "edited": false, "score": 0, "creation_date": 1429708809, "post_id": 29130061, "comment_id": 47725842, "body": "Have you tried http.rb?"}, {"owner": {"reputation": 1239, "user_id": 20875, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcced4ae869ba4632fecfef5c4189075?s=128&d=identicon&r=PG", "display_name": "lsdr", "link": "https://stackoverflow.com/users/20875/lsdr"}, "edited": false, "score": 1, "creation_date": 1429801392, "post_id": 29130061, "comment_id": 47780978, "body": "Certificates are tied to FQDN. You are trying to connect to <code>homologacao.sefaz.mt.gov.br</code>; does your <code>cert.pem</code> generated to certify requests to this particular domain?"}, {"owner": {"reputation": 558, "user_id": 84346, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/4528e8655de73692cf88a9a65a0f8625?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/84346/jonathan"}, "edited": false, "score": 0, "creation_date": 1560187662, "post_id": 29130061, "comment_id": 99645158, "body": "did you find a solution with Savon calling HTTPS SOAP webservices?"}], "owner": {"reputation": 533, "user_id": 4641520, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/yoVpZ.jpg?s=128&g=1", "display_name": "Henrique Navarro Mar&#231;ulo", "link": "https://stackoverflow.com/users/4641520/henrique-navarro-mar%c3%a7ulo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 724, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1454332672, "creation_date": 1426703702, "last_edit_date": 1454332672, "question_id": 29130061, "link": "https://stackoverflow.com/questions/29130061/how-to-connect-to-an-xml-soap-web-service-via-ssl-with-mutual-auth", "title": "How to connect to an xml/soap web service via SSL with mutual auth?", "body": "<p>I'm trying to consume a web service with a certificate, sending a XML/SOAP, via SSL with mutual authentication. I've tried <code>savon</code> and <code>net/http</code>, but I'm stopped with the same error:</p>\n\n<blockquote>\n  <p>SSL_CTX_use_PrivateKey: key values mismatch (HTTPI::SSLError)</p>\n</blockquote>\n\n<p><strong>net/http</strong>:</p>\n\n<pre><code>uri = URI.parse('https://homologacao.sefaz.mt.gov.br/nfews/v2/services/NfeStatusServico2?wsdl')\npem = File.read(\"cert/cert.pem\")\nhttp = Net::HTTP.new(uri.host, uri.port)\nhttp.use_ssl = true\nhttp.cert = OpenSSL::X509::Certificate.new(pem)\nhttp.key = OpenSSL::PKey::RSA.new(pem)\nhttp.verify_mode = OpenSSL::SSL::VERIFY_PEER\n\nhttp.start\n</code></pre>\n\n<p><strong>savon</strong>:</p>\n\n<pre><code>WSDL_URL = 'https://homologacao.sefaz.mt.gov.br/nfews/v2/services/NfeStatusServico2?wsdl'\n\nclient = Savon.client(\n   wsdl: WSDL_URL,\n   ssl_version: :SSLv3,\n   ssl_verify_mode: :peer,\n   ssl_cert_file: 'cert/cert.pem',\n   ssl_cert_key_file: 'cert/private_key.pem',\n # ssl_cert_key_password: '123456789',\n   env_namespace: :soap, \n   namespace_identifier: nil\n)\n\nresponse = client.call(:nfeStatusServicoNF2, message: \"test\")\n</code></pre>\n\n<p>Is there a solution?  Thanks!</p>\n"}, {"tags": ["ruby", "git", "bundler", "gemfile.lock"], "comments": [{"owner": {"reputation": 8378, "user_id": 2076787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bfe965ab5ef94a0568bc61c36b46d4c?s=128&d=identicon&r=PG", "display_name": "D-side", "link": "https://stackoverflow.com/users/2076787/d-side"}, "edited": false, "score": 0, "creation_date": 1426713525, "post_id": 29130044, "comment_id": 46491562, "body": "What are the changes? Anything significant?"}, {"owner": {"reputation": 5921, "user_id": 29470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/926224cbb63e5b617300e99c89051ce7?s=128&d=identicon&r=PG", "display_name": "Tim Moore", "link": "https://stackoverflow.com/users/29470/tim-moore"}, "edited": false, "score": 0, "creation_date": 1426985150, "post_id": 29130044, "comment_id": 46593986, "body": "Please upgrade Bundler by running <code>gem install bundler</code> again.  Bundler 1.7.9 has some bugs that can cause unexpected changes to <code>Gemfile.lock</code> in certain circumstances. These have been fixed in more recent versions.  As for what&#39;s causing this when running only <code>git</code> commands, I think Matt Brictson&#39;s answer is the best."}], "answers": [{"tags": [], "owner": {"reputation": 20735, "user_id": 307106, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6a13e655e637138f8d571cec3f9cea76?s=128&d=identicon&r=PG", "display_name": "jrochkind", "link": "https://stackoverflow.com/users/307106/jrochkind"}, "is_accepted": false, "score": 0, "last_activity_date": 1426716209, "creation_date": 1426716209, "answer_id": 29133573, "question_id": 29130044, "link": "https://stackoverflow.com/questions/29130044/gemfile-lock-always-has-changes-not-staged-for-commit/29133573#29133573", "title": "Gemfile.lock always has changes not staged for commit", "body": "<p>There are times that running a rails command or other bundle exec command will silently update your Gemfile.lock. I am guessing you are doing that sometime in between your git commands. Or you have something weird installed that does that invisibly. </p>\n\n<p>(Could rvm do this invisibly? I don't know. I think rvm does all kinds of odd stuff and don't use it.). </p>\n\n<p>At any rate, the fact that this is happening is probably evidence of something else going on that isn't what you want -- are you sure the Gemfile and Gemfile.lock you are trying to commit together are actually compatible? Normally any time a Gemfile changes at all, it is wise to run bundle install to get a new Gemfile.lock.  If you are trying to commit a Gemfile.lock which actually isn't compatible with the Gemfile... I am not sure why you would want to do that anyway, normally I want the Gemfile and Gemfile.lock in any given commit to be compatible. </p>\n\n<p>To get a clue as to why something (mysterious) may be changing your Gemfile.lock, do a git diff on the Gemfile.lock to see how it's changed?  </p>\n"}, {"comments": [{"owner": {"reputation": 6600, "user_id": 387135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/297fd8604079ac987d6bc38788f06381?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/387135/brian"}, "edited": false, "score": 10, "creation_date": 1432758382, "post_id": 29134747, "comment_id": 49062830, "body": "Thanks, for me the issue was with spring. After a <code>spring stop</code> I was able to successfully <code>git checkout -- Gemfile.lock</code>"}, {"owner": {"reputation": 4939, "user_id": 201911, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dfca2a252bb0313ec21a60c39abde0f0?s=128&d=identicon&r=PG", "display_name": "jwadsack", "link": "https://stackoverflow.com/users/201911/jwadsack"}, "edited": false, "score": 2, "creation_date": 1434670812, "post_id": 29134747, "comment_id": 49891651, "body": "Yeah. We had the same issue on a new Rails 4.2 project and it was Spring. So helpful!"}, {"owner": {"reputation": 2255, "user_id": 2087198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83e4e7855259a14e196dfa670565ca0d?s=128&d=identicon&r=PG", "display_name": "Bruno Peres", "link": "https://stackoverflow.com/users/2087198/bruno-peres"}, "edited": false, "score": 0, "creation_date": 1440785304, "post_id": 29134747, "comment_id": 52433242, "body": "After running <code>spring stop</code> should I run <code>spring start</code> afterwards ?"}, {"owner": {"reputation": 10091, "user_id": 4625365, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/l6v41.jpg?s=128&g=1", "display_name": "Matt Brictson", "link": "https://stackoverflow.com/users/4625365/matt-brictson"}, "reply_to_user": {"reputation": 2255, "user_id": 2087198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83e4e7855259a14e196dfa670565ca0d?s=128&d=identicon&r=PG", "display_name": "Bruno Peres", "link": "https://stackoverflow.com/users/2087198/bruno-peres"}, "edited": false, "score": 1, "creation_date": 1440802422, "post_id": 29134747, "comment_id": 52440359, "body": "@BrunoPeres No, spring will automatically start again the next time you run a spring-enabled command, like <code>rails</code> or <code>rake</code>."}], "tags": [], "owner": {"reputation": 10091, "user_id": 4625365, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/l6v41.jpg?s=128&g=1", "display_name": "Matt Brictson", "link": "https://stackoverflow.com/users/4625365/matt-brictson"}, "is_accepted": false, "score": 28, "last_activity_date": 1426722195, "creation_date": 1426722195, "answer_id": 29134747, "question_id": 29130044, "link": "https://stackoverflow.com/questions/29130044/gemfile-lock-always-has-changes-not-staged-for-commit/29134747#29134747", "title": "Gemfile.lock always has changes not staged for commit", "body": "<p>There must be some process running in the background or some side-effect of executing the git commands in your shell that is modifying the Gemfile.lock.</p>\n\n<p>I am not familiar with rvm's magic (although that sounds plausible); here are some other things to check:</p>\n\n<ul>\n<li>In recent versions of Rails there is a \"spring\" background process that runs. Try running <code>spring stop</code> (or <code>bin/spring stop</code> or <code>bundle exec spring stop</code>) to gracefully terminate that process.</li>\n<li>Likewise if you have any other Rails-related processes like rails server, guard, zeus, sidekiq, etc. running, try shutting those down.</li>\n<li>You might be running a git pre-commit hook. Check the <code>.git/hooks</code> directory.</li>\n<li><code>git</code> might be an alias in your shell for another command. Run <code>alias</code> to see a list of shell aliases.</li>\n<li>Your shell prompt might be executing code to do things like show the current git status and branch name in the prompt. This code would be executed after every shell command to redraw the prompt, and might have side-effects. Check your <code>.bashrc</code> or <code>.bash_profile</code>.</li>\n</ul>\n"}], "owner": {"reputation": 2322, "user_id": 560831, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f26e5fe9655c4fffafd6eb928fb90f40?s=128&d=identicon&r=PG", "display_name": "tomciopp", "link": "https://stackoverflow.com/users/560831/tomciopp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3104, "favorite_count": 3, "answer_count": 2, "score": 10, "last_activity_date": 1492183708, "creation_date": 1426703663, "last_edit_date": 1492183708, "question_id": 29130044, "link": "https://stackoverflow.com/questions/29130044/gemfile-lock-always-has-changes-not-staged-for-commit", "title": "Gemfile.lock always has changes not staged for commit", "body": "<p>I am running into this problem on a rails app I am working on. I was working on a feature branch and wanted to rebase from the most recent master. I ran the following commands:</p>\n\n<pre><code>$ git checkout master\n$ git pull --rebase\n</code></pre>\n\n<p>If I try to checkout back to my feature branch I get the following error:</p>\n\n<pre><code>Changes not staged for commit:\n  (use \"git add &lt;file&gt;...\" to update what will be committed)\n  (use \"git checkout -- &lt;file&gt;...\" to discard changes in working directory)\n\n  modified:   Gemfile.lock\n</code></pre>\n\n<p>I have tried the following commands to resolve the Gemfile.lock back to aster with none of them being successful:</p>\n\n<pre><code>$ git checkout -- Gemfile.lock\n$ git stash\n$ git reset HEAD --hard\n</code></pre>\n\n<p>Every time I run a new git command I go back to the Gemfile.lock having changes not staged for commit. </p>\n\n<p>Here are the following versions of libraries I am working with:</p>\n\n<pre><code>$ git --version =&gt; 2.3.3\n$ bundler --version =&gt; 1.7.9\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "json", "instagram-api"], "comments": [{"owner": {"reputation": 1019, "user_id": 4663917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6624bc240dea43cc2312b733ad03238e?s=128&d=identicon&r=PG", "display_name": "Papaya Labs", "link": "https://stackoverflow.com/users/4663917/papaya-labs"}, "edited": false, "score": 2, "creation_date": 1426704933, "post_id": 29129696, "comment_id": 46486558, "body": "What about the homeController?"}, {"owner": {"reputation": 847, "user_id": 4107076, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh5.googleusercontent.com/-S9vSO9TMZqo/AAAAAAAAAAI/AAAAAAAAAFo/OZyx4KJJNIk/photo.jpg?sz=128", "display_name": "Mr. Rene", "link": "https://stackoverflow.com/users/4107076/mr-rene"}, "reply_to_user": {"reputation": 1019, "user_id": 4663917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6624bc240dea43cc2312b733ad03238e?s=128&d=identicon&r=PG", "display_name": "Papaya Labs", "link": "https://stackoverflow.com/users/4663917/papaya-labs"}, "edited": false, "score": 0, "creation_date": 1426706614, "post_id": 29129696, "comment_id": 46487512, "body": "@manfergo25 sorry about that, the home controller was/is the session controller"}, {"owner": {"reputation": 1019, "user_id": 4663917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6624bc240dea43cc2312b733ad03238e?s=128&d=identicon&r=PG", "display_name": "Papaya Labs", "link": "https://stackoverflow.com/users/4663917/papaya-labs"}, "edited": false, "score": 0, "creation_date": 1426707029, "post_id": 29129696, "comment_id": 46487761, "body": "Ok. I think you need to put ENV[&#39;CLIENT_ID&#39;] and ENV[&#39;ACCESS_TOKEN&#39;] with real values to connect to instagram api. I dont know if you did that."}, {"owner": {"reputation": 847, "user_id": 4107076, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh5.googleusercontent.com/-S9vSO9TMZqo/AAAAAAAAAAI/AAAAAAAAAFo/OZyx4KJJNIk/photo.jpg?sz=128", "display_name": "Mr. Rene", "link": "https://stackoverflow.com/users/4107076/mr-rene"}, "reply_to_user": {"reputation": 1019, "user_id": 4663917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6624bc240dea43cc2312b733ad03238e?s=128&d=identicon&r=PG", "display_name": "Papaya Labs", "link": "https://stackoverflow.com/users/4663917/papaya-labs"}, "edited": false, "score": 0, "creation_date": 1426707075, "post_id": 29129696, "comment_id": 46487790, "body": "yes, its in my .env file"}, {"owner": {"reputation": 1019, "user_id": 4663917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6624bc240dea43cc2312b733ad03238e?s=128&d=identicon&r=PG", "display_name": "Papaya Labs", "link": "https://stackoverflow.com/users/4663917/papaya-labs"}, "edited": false, "score": 0, "creation_date": 1426707386, "post_id": 29129696, "comment_id": 46487978, "body": "Try Instagram.user_recent_media([USER_ID]) and in the web check  if you get access =&gt; <a href=\"https://api.instagram.com/v1/users/[USER_ID_HERE]/follows?access_token=[ACCESS_TOKEN_HERE]\" rel=\"nofollow noreferrer\">api.instagram.com/v1/users/[USER_ID_HERE]/&hellip;</a>"}, {"owner": {"reputation": 847, "user_id": 4107076, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh5.googleusercontent.com/-S9vSO9TMZqo/AAAAAAAAAAI/AAAAAAAAAFo/OZyx4KJJNIk/photo.jpg?sz=128", "display_name": "Mr. Rene", "link": "https://stackoverflow.com/users/4107076/mr-rene"}, "reply_to_user": {"reputation": 1019, "user_id": 4663917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6624bc240dea43cc2312b733ad03238e?s=128&d=identicon&r=PG", "display_name": "Papaya Labs", "link": "https://stackoverflow.com/users/4663917/papaya-labs"}, "edited": false, "score": 0, "creation_date": 1426708982, "post_id": 29129696, "comment_id": 46488918, "body": "@manfergo25 do you mean like this &quot; instagram = Instagram.user_recent_media([USER_ID], {:count =&gt; 2}) &quot;"}, {"owner": {"reputation": 1019, "user_id": 4663917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6624bc240dea43cc2312b733ad03238e?s=128&d=identicon&r=PG", "display_name": "Papaya Labs", "link": "https://stackoverflow.com/users/4663917/papaya-labs"}, "edited": false, "score": 0, "creation_date": 1426709492, "post_id": 29129696, "comment_id": 46489226, "body": "Will serve too. Remember USER_ID is an Integer."}, {"owner": {"reputation": 847, "user_id": 4107076, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh5.googleusercontent.com/-S9vSO9TMZqo/AAAAAAAAAAI/AAAAAAAAAFo/OZyx4KJJNIk/photo.jpg?sz=128", "display_name": "Mr. Rene", "link": "https://stackoverflow.com/users/4107076/mr-rene"}, "reply_to_user": {"reputation": 1019, "user_id": 4663917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6624bc240dea43cc2312b733ad03238e?s=128&d=identicon&r=PG", "display_name": "Papaya Labs", "link": "https://stackoverflow.com/users/4663917/papaya-labs"}, "edited": false, "score": 0, "creation_date": 1426711414, "post_id": 29129696, "comment_id": 46490429, "body": "Got it working! thank! I had to find the user id. got it from <a href=\"http://www.otzberg.net/iguserid/\" rel=\"nofollow noreferrer\">otzberg.net/iguserid</a>"}], "answers": [{"tags": [], "owner": {"reputation": 847, "user_id": 4107076, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh5.googleusercontent.com/-S9vSO9TMZqo/AAAAAAAAAAI/AAAAAAAAAFo/OZyx4KJJNIk/photo.jpg?sz=128", "display_name": "Mr. Rene", "link": "https://stackoverflow.com/users/4107076/mr-rene"}, "is_accepted": false, "score": 0, "last_activity_date": 1426711665, "creation_date": 1426711665, "answer_id": 29132338, "question_id": 29129696, "link": "https://stackoverflow.com/questions/29129696/instagram-gem-jsonparsererror-in-sessioncontrollerindex/29132338#29132338", "title": "instagram gem JSON::ParserError in SessionController#index", "body": "<p>change </p>\n\n<pre><code>@instagram = ::Instagram.user_recent_media('grateful4salvation', {:count =&gt; 2})\n</code></pre>\n\n<p>to </p>\n\n<pre><code> @instagram = ::Instagram.user_recent_media( 'user_id', {:count =&gt; 2})\n</code></pre>\n\n<p>example:</p>\n\n<pre><code>@instagram = ::Instagram.user_recent_media(1368150019, {:count =&gt; 2})\n</code></pre>\n"}], "owner": {"reputation": 847, "user_id": 4107076, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh5.googleusercontent.com/-S9vSO9TMZqo/AAAAAAAAAAI/AAAAAAAAAFo/OZyx4KJJNIk/photo.jpg?sz=128", "display_name": "Mr. Rene", "link": "https://stackoverflow.com/users/4107076/mr-rene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 503, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426711665, "creation_date": 1426702591, "last_edit_date": 1426709063, "question_id": 29129696, "link": "https://stackoverflow.com/questions/29129696/instagram-gem-jsonparsererror-in-sessioncontrollerindex", "title": "instagram gem JSON::ParserError in SessionController#index", "body": "<p>I am trying to use the instagram gem to create a gallery of photo from my instagram. I was following this <a href=\"http://blog.ajmalafif.com/instagram-gem-with-rails/\" rel=\"nofollow\">example</a> to try to integrate the gem in my app but keep running to this error </p>\n\n<blockquote>\n  <p>JSON::ParserError in SessionController#index</p>\n</blockquote>\n\n<p>Any help is well appreciated!</p>\n\n<p>This is my CONTROLLER </p>\n\n<pre><code>class SessionController &lt; ApplicationController\n\ndef index\n @item = Item.all\n @instagram = ::Instagram.user_recent_media('grateful4salvation', {:count =&gt; 2})\n end\nend\n</code></pre>\n\n<p>Initializers/instagram.rb</p>\n\n<pre><code>require 'instagram'\n\n Instagram.configure do |config|\n config.client_id = ENV[\"CLIENT_ID\"]\n config.access_token = ENV[\"access_token\"]\n end\n</code></pre>\n\n<p>View/session/index.html</p>\n\n<pre><code>&lt;% @instagram.each do |instagram| %&gt;\n  &lt;%= image_tag instagram.images.standard_resolution.url %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "actionmailer"], "comments": [{"owner": {"reputation": 8946, "user_id": 2398521, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/84bb49c56756a8c7cd54d4876d7a4467?s=128&d=identicon&r=PG", "display_name": "Maxim", "link": "https://stackoverflow.com/users/2398521/maxim"}, "edited": false, "score": 0, "creation_date": 1426702548, "post_id": 29129542, "comment_id": 46485087, "body": "Are you sure that you don&#39;t have access to <code>params</code>? How do you check it?"}, {"owner": {"reputation": 99, "user_id": 720268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa7c791302b2c53670bd911844e44ad9?s=128&d=identicon&r=PG", "display_name": "kueda", "link": "https://stackoverflow.com/users/720268/kueda"}, "reply_to_user": {"reputation": 8946, "user_id": 2398521, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/84bb49c56756a8c7cd54d4876d7a4467?s=128&d=identicon&r=PG", "display_name": "Maxim", "link": "https://stackoverflow.com/users/2398521/maxim"}, "edited": false, "score": 0, "creation_date": 1426712745, "post_id": 29129542, "comment_id": 46491121, "body": "I checked it with a logging statement that said it wasn&#39;t defined. Are you seeing something different?"}, {"owner": {"reputation": 3091, "user_id": 1290457, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/121ff7202cde3e23e2c73ff3078b5a15?s=128&d=identicon&r=PG", "display_name": "sandre89", "link": "https://stackoverflow.com/users/1290457/sandre89"}, "edited": false, "score": 0, "creation_date": 1517971888, "post_id": 29129542, "comment_id": 84308456, "body": "op is right, just use <code>binding.pry</code> and you&#39;ll see that <code>request</code> and <code>params</code> raise no method errors"}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 720268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa7c791302b2c53670bd911844e44ad9?s=128&d=identicon&r=PG", "display_name": "kueda", "link": "https://stackoverflow.com/users/720268/kueda"}, "edited": false, "score": 0, "creation_date": 1426712876, "post_id": 29130002, "comment_id": 46491186, "body": "That would work if I was defining a mailer, but I&#39;m defining a preview as described at <a href=\"http://api.rubyonrails.org/v4.1.0/classes/ActionMailer/Base.html#class-ActionMailer::Base-label-Previewing+emails\" rel=\"nofollow noreferrer\">api.rubyonrails.org/v4.1.0/classes/ActionMailer/&hellip;</a>. So in effect I am defining a controller, it&#39;s just I can&#39;t tell how / if ActionMailer::Preview exposes the request environment to the Preview subclass."}, {"owner": {"reputation": 22303, "user_id": 2456433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiN8K.jpg?s=128&g=1", "display_name": "infused", "link": "https://stackoverflow.com/users/2456433/infused"}, "reply_to_user": {"reputation": 99, "user_id": 720268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa7c791302b2c53670bd911844e44ad9?s=128&d=identicon&r=PG", "display_name": "kueda", "link": "https://stackoverflow.com/users/720268/kueda"}, "edited": false, "score": 0, "creation_date": 1426713403, "post_id": 29130002, "comment_id": 46491482, "body": "ActionMailer::Preview does not have access to any of the controller parameters (or much of anything else for that matter).  You&#39;ll have to pass the id as an argument.  Treat ActionMailer::Preview as if it was a a mailer."}, {"owner": {"reputation": 99, "user_id": 720268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa7c791302b2c53670bd911844e44ad9?s=128&d=identicon&r=PG", "display_name": "kueda", "link": "https://stackoverflow.com/users/720268/kueda"}, "edited": false, "score": 0, "creation_date": 1426713662, "post_id": 29130002, "comment_id": 46491626, "body": "Oh I see, so basically make my own mail preview controller. Well, that&#39;ll be a good solution if no one else has has a way to access those parameters. Thanks."}, {"owner": {"reputation": 22303, "user_id": 2456433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiN8K.jpg?s=128&g=1", "display_name": "infused", "link": "https://stackoverflow.com/users/2456433/infused"}, "reply_to_user": {"reputation": 99, "user_id": 720268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa7c791302b2c53670bd911844e44ad9?s=128&d=identicon&r=PG", "display_name": "kueda", "link": "https://stackoverflow.com/users/720268/kueda"}, "edited": false, "score": 0, "creation_date": 1426714012, "post_id": 29130002, "comment_id": 46491795, "body": "That&#39;s correct.  ActionMailer::Preview is designed to use for previewing your mailer <b>templates</b> not for displaying previews to your users.  The documentation you linked to spells out that you will need to add fake data under the &quot;Previewing Emails&quot; section."}, {"owner": {"reputation": 12200, "user_id": 473040, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c2713a4959692f16d27d2553fb06cc4b?s=128&d=identicon&r=PG", "display_name": "equivalent8", "link": "https://stackoverflow.com/users/473040/equivalent8"}, "edited": false, "score": 0, "creation_date": 1436875664, "post_id": 29130002, "comment_id": 50785834, "body": "if this PR <a href=\"https://github.com/rails/rails/pull/20646\" rel=\"nofollow noreferrer\">github.com/rails/rails/pull/20646</a> gets accepted by Rails passing params to mailer preview will be possible"}], "tags": [], "owner": {"reputation": 22303, "user_id": 2456433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiN8K.jpg?s=128&g=1", "display_name": "infused", "link": "https://stackoverflow.com/users/2456433/infused"}, "is_accepted": false, "score": -1, "last_activity_date": 1426703533, "creation_date": 1426703533, "answer_id": 29130002, "question_id": 29129542, "link": "https://stackoverflow.com/questions/29129542/access-request-parameters-in-rails-4-1-mailer-preview/29130002#29130002", "title": "access request parameters in Rails 4.1 mailer preview", "body": "<p>ActionMailer does not have access to the controller params, so pass the params you need as arguments instead:</p>\n\n<pre><code>class MyMailerPreview &lt; ActionMailer::Preview\n  def mymail(user_id)\n    MyMailer.mymail(User.find(user_id))\n  end\nend\n</code></pre>\n\n<p>Then in your controller:</p>\n\n<pre><code>MyMailerPreview.mymail(params[:user_id]).deliver\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1384, "user_id": 1252245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EF8gC.jpg?s=128&g=1", "display_name": "sequielo", "link": "https://stackoverflow.com/users/1252245/sequielo"}, "edited": false, "score": 0, "creation_date": 1579905740, "post_id": 43632082, "comment_id": 105936037, "body": "This will get access to full <code>request</code> object. If you want only <code>params</code>, add this line <code>ActionMailer::Preview.inject({ params: request.params })</code> inside <code>inject_request</code> above."}], "tags": [], "owner": {"reputation": 604, "user_id": 1500762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb047b44e7b9492cb9053c697891bfed?s=128&d=identicon&r=PG", "display_name": "Clay McIlrath", "link": "https://stackoverflow.com/users/1500762/clay-mcilrath"}, "is_accepted": false, "score": 2, "last_activity_date": 1493203862, "creation_date": 1493203862, "answer_id": 43632082, "question_id": 29129542, "link": "https://stackoverflow.com/questions/29129542/access-request-parameters-in-rails-4-1-mailer-preview/43632082#43632082", "title": "access request parameters in Rails 4.1 mailer preview", "body": "<p>I came up with a simple solution to this and detailed it with a <a href=\"https://ruby.unicorn.tv/articles/access-url-request-parameters-from-actionmailer-preview\" rel=\"nofollow noreferrer\">blog post on extending ActionMailer</a>. It's the easiest solution that I've found, my only concern would be how it may impact performance for other controllers.</p>\n\n<pre><code># config/initializers/mailer_injection.rb\n\n# This allows `request` to be accessed from ActionMailer Previews\n# And @request to be accessed from rendered view templates\n# Easy to inject any other variables like current_user here as well\n\nmodule MailerInjection\n  def inject(hash)\n    hash.keys.each do |key|\n      define_method key.to_sym do\n        eval \" @#{key} = hash[key] \"\n      end\n    end\n  end\nend\n\nclass ActionMailer::Preview\n  extend MailerInjection\nend\n\nclass ActionMailer::Base\n  extend MailerInjection\nend\n\nclass ActionController::Base\n  before_filter :inject_request\n\n  def inject_request\n    ActionMailer::Preview.inject({ request: request })\n    ActionMailer::Base.inject({ request: request })\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1920, "user_id": 2993768, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/rF0mH.png?s=128&g=1", "display_name": "stujo", "link": "https://stackoverflow.com/users/2993768/stujo"}, "is_accepted": false, "score": 0, "last_activity_date": 1515802065, "last_edit_date": 1515802065, "creation_date": 1515801624, "answer_id": 48235636, "question_id": 29129542, "link": "https://stackoverflow.com/questions/29129542/access-request-parameters-in-rails-4-1-mailer-preview/48235636#48235636", "title": "access request parameters in Rails 4.1 mailer preview", "body": "<p>Here's a solution I use for a specific parameter (in my case to load a specific order), you could modify this to make it more generic and work for any or all parameters</p>\n\n<p>It uses a class variable in the the XXXMailerPreview class, which shouldn't be a problem if you are running in dev. This is required because at least in Rails 5 the previews are shown in an IFrame and the url params added to the preview url are not passed to the IFrame urls.</p>\n\n<p>Specifically this example code was for Abandoned Cart emails in Spree but it is also used for any order specific email preview</p>\n\n<p>Preview all emails at <a href=\"http://localhost:3000/rails/mailers/abandonded_checkout_mailer\" rel=\"nofollow noreferrer\">http://localhost:3000/rails/mailers/abandonded_checkout_mailer</a></p>\n\n<p>In <code>mailer_controller_decorator.rb</code> which you can load anyway you want after Rails is loaded</p>\n\n<pre><code>module MailerPreviewOrderNumber\n  def set_order_number(order_number)\n    @order_number = order_number\n  end\n\n  def get_order_number\n    @order_number\n  end\n\n  def order_for_preview\n    order_number = get_order_number\n    order = Spree::Order.find_by(:number =&gt; order_number) if order_number.present?\n    order = yield if order.blank?\n    order\n  end\n\nend\n\nRails::MailersController.class_eval do\n  before_action :save_order_number, only: [:preview]\n\n  def save_order_number\n    if @preview.present? &amp;&amp; @preview.respond_to?(:set_order_number)\n      @preview.set_order_number(params[:order]) if params[:order].present?\n    end\n  end\nend\n</code></pre>\n\n<p>And in your XXXMailerPreview file</p>\n\n<pre><code>class AbandondedCheckoutMailerPreview &lt; ActionMailer::Preview\n  extend MailerPreviewOrderNumber\n\n  def abandoned_checkout_email\n    if Rails.env.development?\n      order = self.class.order_for_preview do\n        Spree::Order.order(updated_at: :desc).last\n      end\n      AbandonedCheckoutMailer.abandoned_checkout_email(order)\n    end\n  end\nend\n</code></pre>\n\n<p>The block passed to <code>order_for_preview</code> is used in the case that no order param is provided to the preview URL the first time</p>\n"}], "owner": {"reputation": 99, "user_id": 720268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa7c791302b2c53670bd911844e44ad9?s=128&d=identicon&r=PG", "display_name": "kueda", "link": "https://stackoverflow.com/users/720268/kueda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2382, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1515802065, "creation_date": 1426702111, "question_id": 29129542, "link": "https://stackoverflow.com/questions/29129542/access-request-parameters-in-rails-4-1-mailer-preview", "title": "access request parameters in Rails 4.1 mailer preview", "body": "<p>When I used to use the <code>MailView</code> gem to preview <code>ActionMailer</code> emails, I would access <code>@rack_env</code> to preview my emails under different conditions, e.g. delivery to a specific user or in a specific locale, or with specific inputs. With the new(ish) <code>ActionMailer::Preview</code> that instance variable isn't being set, and <code>params</code> doesn't exist. Does anyone know how to access the GET params to <code>/rails/mailers/:mailer/:action</code> with <code>ActionMailer::Preview</code>? </p>\n\n<p>Ideally I'd like to be able to request <code>/rails/mailers/my_mailer/mymail?user_id=123</code> and use it like</p>\n\n<pre><code>class MyMailerPreview &lt; ActionMailer::Preview\n  def mymail\n    MyMailer.mymail(User.find(params[:user_id]))\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "json"], "answers": [{"tags": [], "owner": {"reputation": 8946, "user_id": 2398521, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/84bb49c56756a8c7cd54d4876d7a4467?s=128&d=identicon&r=PG", "display_name": "Maxim", "link": "https://stackoverflow.com/users/2398521/maxim"}, "is_accepted": true, "score": 1, "last_activity_date": 1426702232, "creation_date": 1426702232, "answer_id": 29129579, "question_id": 29129466, "link": "https://stackoverflow.com/questions/29129466/rails-4-convert-id-to-model-in-params/29129579#29129579", "title": "Rails 4 - Convert id to model in params", "body": "<p><code>UserRequest</code> table doesn't have <code>sub_model_id</code> column in DB, so it raise your error. Specify it in migration and swap associations:</p>\n\n<pre><code>UserRequest\n  has_and_belongs_to_many :products\n  belongs_to :sub_model\n\nSubModel\n  has_one :user_request\n</code></pre>\n"}], "owner": {"reputation": 3765, "user_id": 843443, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/07748ad3a158dfc6aee92c9bbac06b90?s=128&d=identicon&r=PG", "display_name": "Jeff", "link": "https://stackoverflow.com/users/843443/jeff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 29129579, "answer_count": 1, "score": 0, "last_activity_date": 1426702232, "creation_date": 1426701866, "question_id": 29129466, "link": "https://stackoverflow.com/questions/29129466/rails-4-convert-id-to-model-in-params", "title": "Rails 4 - Convert id to model in params", "body": "<p>My code is errorring out when I try to insert a new record in the DB:</p>\n\n<pre><code>@user_request = UserRequest.new(user_request_params)\n</code></pre>\n\n<p>I have a model that belongs to another. The user selects the sub model in a dropdown, and the id is sent in json:</p>\n\n<pre><code>{\"user_request\"=&gt;{\"product_ids\"=&gt;[\"86\", \"79\"], \"sub_model_id\"=&gt;\"5\"}\n</code></pre>\n\n<p><strong>Schema</strong></p>\n\n<pre><code>UserRequest\n  has_and_belongs_to_many :products\n  has_one :sub_model\n\nSubModel\n  belongs_to :user_request\n\nProduct\n  has_and_belongs_to_many :user_requests\n</code></pre>\n\n<p>The product is inserted into the db no problem (if I ignore the submodel), but the SubModel is not. I get this error:</p>\n\n<pre><code>ActiveRecord::UnknownAttributeError (unknown attribute: sub_model_id):\n  app/controllers/user_requests_controller.rb:44:in `create'\n</code></pre>\n\n<p>I tried to edit the params before hand by doing this:</p>\n\n<pre><code>def user_request_params\n    params.require(:user_request).permit(:sub_model_id, :product_ids =&gt; [])\n    #the above line was there, added these lines:\n    sub_id = params[:user_request][:sub_model_id]\n    sub = SubModel.find(sub_id)\n    params[:user_request].delete(:sub_model_id)\n    params[:user_request][:sub_model] = sub\n    params\nend\n</code></pre>\n\n<p>which generates the following JSON:</p>\n\n<pre><code>{\"user_request\"=&gt;{\"product_ids\"=&gt;[\"86\", \"79\"], \"sub_model\"=&gt;#&lt;SubModel id: 5, ...} \n</code></pre>\n\n<p>but now I get this error:</p>\n\n<pre><code>ActiveModel::ForbiddenAttributesError (ActiveModel::ForbiddenAttributesError):\n</code></pre>\n\n<p>app/controllers/user_requests_controller.rb:42:in `create'</p>\n\n<p>The submodel's were generated before hand by the admin of the site (they do exist).</p>\n\n<p><strong>How do I get the UserRequest to save?</strong></p>\n"}, {"tags": ["mysql", "ruby", "amazon-ec2", "cron", "chef-infra"], "comments": [{"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1426724442, "post_id": 29129320, "comment_id": 46495481, "body": "<i>&quot;the database stops taking entries&quot;</i> needs to be clarified.  What does this mean?  Errors?  Database not responsive?  Expected data isn&#39;t found there?  I am a MySQL DBA, but largely unfamiliar with Ruby -- doesn&#39;t <code>con.query()</code> have a return value that you should be checking?"}, {"owner": {"reputation": 1, "user_id": 3566147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2745fa9b4dfd603f6bf0da941881fea?s=128&d=identicon&r=PG&f=1", "display_name": "flipdrop", "link": "https://stackoverflow.com/users/3566147/flipdrop"}, "reply_to_user": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1426758644, "post_id": 29129320, "comment_id": 46506178, "body": "Thanks for the reply Michael. It&#39;s not an issue with the database, i can still input into the db manually. I&#39;ve figured out that my server&#39;s ip is being blocked by the website I&#39;m extracting data from after a number of requests, so I am going to try get around this today. I&#39;ll update my question later once I&#39;ve worked out the ruffles so others can use it"}, {"owner": {"reputation": 742, "user_id": 1843864, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5adbd699985cbc48f675057051824d8d?s=128&d=identicon&r=PG", "display_name": "Tom Wilson", "link": "https://stackoverflow.com/users/1843864/tom-wilson"}, "edited": false, "score": 0, "creation_date": 1426880292, "post_id": 29129320, "comment_id": 46566914, "body": "This could be a firewall issue.  A common way to prevent brute-force attacks is to limit the number of connections to an endpoint in a certain length of time.  With UFW, for example, a <code>ufw limit ...</code> rule would do that.   You could test this easily by writing some code to repeatedly open a new connection and run a no-op query, counting the number of successful runs.  If it always runs the same number of times (after a long rest to clear any counters) this could be the issue."}, {"owner": {"reputation": 742, "user_id": 1843864, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5adbd699985cbc48f675057051824d8d?s=128&d=identicon&r=PG", "display_name": "Tom Wilson", "link": "https://stackoverflow.com/users/1843864/tom-wilson"}, "edited": false, "score": 0, "creation_date": 1426880630, "post_id": 29129320, "comment_id": 46567073, "body": "Also, if this job fails, there&#39;s probably some useful exception info.  I&#39;d consider wrapping the guts of this operation in a begin/rescue/end and put any exception messages so cron can email them to you."}, {"owner": {"reputation": 1, "user_id": 3566147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2745fa9b4dfd603f6bf0da941881fea?s=128&d=identicon&r=PG&f=1", "display_name": "flipdrop", "link": "https://stackoverflow.com/users/3566147/flipdrop"}, "reply_to_user": {"reputation": 742, "user_id": 1843864, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5adbd699985cbc48f675057051824d8d?s=128&d=identicon&r=PG", "display_name": "Tom Wilson", "link": "https://stackoverflow.com/users/1843864/tom-wilson"}, "edited": false, "score": 0, "creation_date": 1427111406, "post_id": 29129320, "comment_id": 46628777, "body": "@TomWilson thanks for reply, i realized this on Friday. I was querying the same site too many times."}], "owner": {"reputation": 1, "user_id": 3566147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2745fa9b4dfd603f6bf0da941881fea?s=128&d=identicon&r=PG&f=1", "display_name": "flipdrop", "link": "https://stackoverflow.com/users/3566147/flipdrop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1427111290, "creation_date": 1426701389, "last_edit_date": 1427111290, "question_id": 29129320, "link": "https://stackoverflow.com/questions/29129320/mysql-on-ec2-linux-instance-stops-taking-data-from-import-scripts", "title": "MySql on ec2 linux instance stops taking data from import scripts", "body": "<p>I have a master server which imports data into a MySQL database on a slave server, and I'm trying to keep this running until the slave server reaches near capacity. I've done this by setting up cron jobs in a chef recipe, which runs 20 different ruby files every 15 mins. Everything works fine for about an hour, then the database stops taking entries. Can anybody shed some light on this please?</p>\n\n<p>Things I've done:\n1)logged into database and added entries. This is fine.\n2)checked cron log to see that jobs have run. This is fine.</p>\n\n<p>Here is one of my import files, but I don't think there is any problem with it</p>\n\n<pre><code>require 'rubygems'\nrequire 'mysql2'\nrequire 'open-uri'\n\n#my = Mysql2::Client.new(hostname,username,password,database)\n\ncon = Mysql2::Client.new(:hostname =&gt; 'ipaddress',\n                    :username =&gt; 'username',\n                    :password =&gt; 'password',\n                    :database =&gt; 'database')        \n\ncon.query(\"CREATE TABLE IF NOT EXISTS words(id INT PRIMARY KEY AUTO_INCREMENT,value VARCHAR(50));\")\n\nopen('http://samplewebsite.txt').each_line do |word|\n    word.split(\" \").each do |str|\n        outstring = str.gsub(/[^a-zA-Z0-9\\-]/,\"\")\n        con.query(\"INSERT INTO words(value)\n                VALUES('\"+outstring+\"');\")\n    end\nend\n\n\nputs \"Done!\"\n\ncon.close\n</code></pre>\n\n<p>Thanks in advance</p>\n\n<p>Edit: After thinking about this for a little while I realized my mistake (and from people's answers below), I was hitting the same website too many times from my server, so I was getting blocked out. I've modified my recipes to go to different sites so they're more spread out and things are working fine now. Thanks to anyone wjo answered!</p>\n"}, {"tags": ["ruby", "xml", "nokogiri", "sax"], "comments": [{"owner": {"reputation": 854, "user_id": 881928, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f7263925ee0d1993df5546e56801b45e?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya1510", "link": "https://stackoverflow.com/users/881928/aditya1510"}, "edited": false, "score": 0, "creation_date": 1448456537, "post_id": 29129212, "comment_id": 55595449, "body": "I am also stuck with same problem.. Have you got any other answer expect below"}], "answers": [{"tags": [], "owner": {"reputation": 22303, "user_id": 2456433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiN8K.jpg?s=128&g=1", "display_name": "infused", "link": "https://stackoverflow.com/users/2456433/infused"}, "is_accepted": true, "score": 2, "last_activity_date": 1426789868, "last_edit_date": 1426789868, "creation_date": 1426708777, "answer_id": 29131571, "question_id": 29129212, "link": "https://stackoverflow.com/questions/29129212/how-to-retrieve-value-of-xml-element-using-a-nokogiri-sax-parser/29131571#29131571", "title": "How to retrieve value of XML element using a Nokogiri SAX Parser?", "body": "<p>You can't read ahead, so you must keep track of the current context within the file yourself.  Something along these lines should do the trick:</p>\n\n<pre><code>def start_element(name, attrs = [])\n  @element = name\n\n  if name == 'sitemap'\n    @sitemap = true\n  end\nend\n\ndef end_element(name)\n  @element = nil\n\n  if name == 'sitemap'\n    @sitemap = false\n  end\nend\n\ndef characters(string)\n  if @element == 'loc' &amp;&amp; @sitemap\n    # The local variable 'string' holds the text contents of the &lt;loc&gt; tag\n    # so do something with it here\n    puts string\n  end\nend\n</code></pre>\n\n<p>How this works: When a new element is started it checks to see if it is a  and if so sets a @sitemap variable.  On the next iteration when the element is  it checks @sitemap to see if it is within a sitemap and does something with its contents.</p>\n"}], "owner": {"reputation": 2228, "user_id": 3108699, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/q8idk.png?s=128&g=1", "display_name": "myconode", "link": "https://stackoverflow.com/users/3108699/myconode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 574, "favorite_count": 1, "closed_date": 1426722052, "accepted_answer_id": 29131571, "answer_count": 1, "score": 3, "last_activity_date": 1426789868, "creation_date": 1426701008, "question_id": 29129212, "link": "https://stackoverflow.com/questions/29129212/how-to-retrieve-value-of-xml-element-using-a-nokogiri-sax-parser", "closed_reason": "Not suitable for this site", "title": "How to retrieve value of XML element using a Nokogiri SAX Parser?", "body": "<p>How does one access the text value of a nested element using a Nokogiri SAX parser?</p>\n\n<pre><code>require 'nokogiri'\n\n  xml = &lt;&lt;-eos\n   &lt;sitemapindex xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\"&gt;\n      &lt;sitemap&gt;\n        &lt;loc&gt;http://www.example.com/example-sitemap.xml&lt;/loc&gt;\n     &lt;/sitemap&gt;\n    &lt;/sitemapindex&gt;\n  eos\n\n  class MySAXDoc &lt; Nokogiri::XML::SAX::Document\n     def start_element name, attrs=[]\n        if name == \"sitemap\"\n          # from here, how can one retrieve the value of the child element, `loc`?\n        end\n     end\n  end\n\n  sax_parser = Nokogiri::XML::SAX::Parser.new(MySAXDoc.new)\n  sax_parser.parse(xml)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "macos", "better-errors-gem"], "comments": [{"owner": {"reputation": 1356, "user_id": 1175943, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7a3218043040195cb524c5988d8c06d5?s=128&d=identicon&r=PG", "display_name": "sebkkom", "link": "https://stackoverflow.com/users/1175943/sebkkom"}, "edited": false, "score": 0, "creation_date": 1426702404, "post_id": 29128981, "comment_id": 46484989, "body": "Did you try to run the server without <code>better_errors</code>? *Also, I guess this has nothing to do but is <code>useraccount</code> your system username?`"}, {"owner": {"reputation": 213, "user_id": 3642951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f36267bce9280220fe99437b78a8739?s=128&d=identicon&r=PG", "display_name": "hworth", "link": "https://stackoverflow.com/users/3642951/hworth"}, "reply_to_user": {"reputation": 1356, "user_id": 1175943, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7a3218043040195cb524c5988d8c06d5?s=128&d=identicon&r=PG", "display_name": "sebkkom", "link": "https://stackoverflow.com/users/1175943/sebkkom"}, "edited": false, "score": 0, "creation_date": 1426703589, "post_id": 29128981, "comment_id": 46485765, "body": "Yes, the server runs without any errors when I remove <code>better_errors</code> from the Gemfile. And yeah my OSX username is <code>useraccount</code>, the system&#39;s name itself is <code>notebookcomputer</code> (I noticed everyone&#39;s Macbook name gets shared on my school&#39;s WiFi with the other systems so I chose something generic)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1426705470, "post_id": 29128981, "comment_id": 46486902, "body": "you have <code>binding_of_caller</code> installed as well correct?"}, {"owner": {"reputation": 213, "user_id": 3642951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f36267bce9280220fe99437b78a8739?s=128&d=identicon&r=PG", "display_name": "hworth", "link": "https://stackoverflow.com/users/3642951/hworth"}, "edited": false, "score": 0, "creation_date": 1426713634, "post_id": 29128981, "comment_id": 46491613, "body": "Yes, i had both binding_of_caller and better_errors installed. When i removed them from the Gemfile the server ran just fine, so I assume one or both of them is causing the issue"}, {"owner": {"reputation": 1356, "user_id": 1175943, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7a3218043040195cb524c5988d8c06d5?s=128&d=identicon&r=PG", "display_name": "sebkkom", "link": "https://stackoverflow.com/users/1175943/sebkkom"}, "edited": false, "score": 0, "creation_date": 1426771512, "post_id": 29128981, "comment_id": 46514132, "body": "@hworth Try <code>better_errors</code> alone, then also try <code>binding_of_caller</code> alone and then try a couple of previous versions for whichever doesn&#39;t work. That way you&#39;ll be able to open an issue at the gem&#39;s github page with all the details (rails, ruby and gem&#39;s versions as well as the rest of your gemfile)."}, {"owner": {"reputation": 213, "user_id": 3642951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f36267bce9280220fe99437b78a8739?s=128&d=identicon&r=PG", "display_name": "hworth", "link": "https://stackoverflow.com/users/3642951/hworth"}, "reply_to_user": {"reputation": 1356, "user_id": 1175943, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7a3218043040195cb524c5988d8c06d5?s=128&d=identicon&r=PG", "display_name": "sebkkom", "link": "https://stackoverflow.com/users/1175943/sebkkom"}, "edited": false, "score": 0, "creation_date": 1426783525, "post_id": 29128981, "comment_id": 46522561, "body": "@sebkomianos how can I downgrade the <code>better_errors</code> gem in order to try different versions? So far even just putting <code>better_errors</code> back in the gemfile under group :development without <code>binding_of_caller</code> makes the Rails server fail to start (with <code>better_errors</code> by itself, I don&#39;t see an error message, but the Terminal just takes my <code>rails s</code> command and then hangs with a blank, blinking cursor)"}, {"owner": {"reputation": 1356, "user_id": 1175943, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7a3218043040195cb524c5988d8c06d5?s=128&d=identicon&r=PG", "display_name": "sebkkom", "link": "https://stackoverflow.com/users/1175943/sebkkom"}, "edited": false, "score": 0, "creation_date": 1426789117, "post_id": 29128981, "comment_id": 46525644, "body": "@hworth The syntax is <code>gem &quot;the_gem&quot;, &quot;X.Y.Z&quot;</code>, where &quot;X.Y.Z&quot; is the version you want. The latest version is 2.1.1 (<a href=\"https://github.com/charliesome/better_errors/releases\" rel=\"nofollow noreferrer\">github.com/charliesome/better_errors/releases</a>) so I&#39;d try 2.1.0, 2.0.0 and 1.9"}, {"owner": {"reputation": 213, "user_id": 3642951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f36267bce9280220fe99437b78a8739?s=128&d=identicon&r=PG", "display_name": "hworth", "link": "https://stackoverflow.com/users/3642951/hworth"}, "reply_to_user": {"reputation": 1356, "user_id": 1175943, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7a3218043040195cb524c5988d8c06d5?s=128&d=identicon&r=PG", "display_name": "sebkkom", "link": "https://stackoverflow.com/users/1175943/sebkkom"}, "edited": false, "score": 0, "creation_date": 1426798358, "post_id": 29128981, "comment_id": 46530400, "body": "@sebkomianos I ended up having to go back to version <code>1.1.0</code> in order for the Rails server to actually start up with <code>better_errors</code> installed. However, now the webpages still won&#39;t load in the browser, and I just see processes in the Terminal hang after a couple of &quot;GET&quot; requests; these requests always seem to be related to <code>assets&#47;jquery.image-select</code> or <code>assets&#47;chosen.jquery</code>"}, {"owner": {"reputation": 1356, "user_id": 1175943, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7a3218043040195cb524c5988d8c06d5?s=128&d=identicon&r=PG", "display_name": "sebkkom", "link": "https://stackoverflow.com/users/1175943/sebkkom"}, "edited": false, "score": 0, "creation_date": 1426807151, "post_id": 29128981, "comment_id": 46534046, "body": "@hworth Unfortunately I can&#39;t help anymore - my experience is limited. I think your best shot is to open an issue on the gihtub page (<a href=\"https://github.com/charliesome/better_errors/issues/new\" rel=\"nofollow noreferrer\">github.com/charliesome/better_errors/issues/new</a>) explaining your problem, listing your gems and mentioning that <code>1.1.0</code> kinda works. <b>Don&#39;t forget to let them know about your <code>rails</code> and <code>ruby</code> versions too!</b>"}], "owner": {"reputation": 213, "user_id": 3642951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f36267bce9280220fe99437b78a8739?s=128&d=identicon&r=PG", "display_name": "hworth", "link": "https://stackoverflow.com/users/3642951/hworth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1426700284, "creation_date": 1426700284, "question_id": 29128981, "link": "https://stackoverflow.com/questions/29128981/better-errors-gem-exception-extensionrb6-stack-level-too-deep-systemstacke", "title": "Better_Errors Gem: &quot;exception_extension:rb:6: stack level too deep (SystemStackError)&quot;", "body": "<p>I imported my Ruby on Rails project from Cloud9 to my local desktop environment (OS X Yosemite) in order to work on the site without a constant internet connection. rbenv installed the Ruby version, bundler installed the gems + dependencies just fine, and I got the server running with no hassle.</p>\n\n<p>However, upon trying to install the \"better_errors\" gem just now alongside \"binding_of_caller\" in order to be able to better recognize and diagnose issues in my project, when I run 'rails s' I get the following error message:</p>\n\n<pre><code>     /Users/useraccount/.rbenv/versions/2.1.4/lib/ruby/gems/2.1.0/gems/better_errors-2.1.1/lib/better_errors/exception_extension.rb:6: stack level too deep (SystemStackError)\n</code></pre>\n\n<p>Prior to the attempted installation of \"better_errors\", the server would start and operate without hassle. What could be causing this issue? </p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1426700429, "post_id": 29128229, "comment_id": 46483754, "body": "Suppose the dictionary contained <code>&quot;aardvark&quot; -&gt; &quot;ardvark&quot;</code>. Would <code>&quot;Aardvark&quot;</code> be converted to <code>&quot;Ardvark&quot;</code> or <code>&quot;ardvark&quot;</code>? For <code>&quot;iphone -&gt; phone&quot;</code>, would <code>&quot;iPhone&quot;</code> be converted to <code>&quot;Phone&quot;</code> or <code>&quot;phone&quot;</code>? In other words, I think you need to be more precise about the rules."}], "answers": [{"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1426699317, "post_id": 29128415, "comment_id": 46483064, "body": "Don&#39;t use <code>&#47;#{subs.keys.join(&#39;|&#39;)}&#47;</code> unless you intend to clean up sub-string substitutions also. Instead, search for whole words using something like <code>&#47;\\b(?:#{subs.keys.join(&#39;|&#39;)})\\b&#47;</code>"}], "tags": [], "owner": {"reputation": 7251, "user_id": 2493089, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c34c815a19c6a2f6ed200cbd95503682?s=128&d=identicon&r=PG", "display_name": "SHS", "link": "https://stackoverflow.com/users/2493089/shs"}, "is_accepted": false, "score": 1, "last_activity_date": 1426700442, "last_edit_date": 1426700442, "creation_date": 1426698640, "answer_id": 29128415, "question_id": 29128229, "link": "https://stackoverflow.com/questions/29128229/case-sensitive-substitutions-with-gsub/29128415#29128415", "title": "Case-sensitive substitutions with gsub", "body": "<p>I don't think this is possible since in this scenario you need to specify the exact string that must take place of the replaced string.</p>\n\n<p>With that in mind, this is the best I can suggest:</p>\n\n<pre><code>subs = {'didja' =&gt; 'did you'}\nsubs.clone.each{ |k, v| subs[k.capitalize] = v.capitalize }\n\n# if you want to replace all occurrences i.e. even substrings:\nregex = /#{subs.keys.join('|')}/\n\n# if you want to remove complete words only: (as the Tin man points out)\nregex = /\\b(?:#{subs.keys.join('|')})\\b/ # \\b checks for word-boundaries\n\n\"didja Didja\".gsub(regex, subs)\n</code></pre>\n\n<p><strong>Update:</strong></p>\n\n<p>Because in your example, the case-sensitive character isn't to be replaced by another value, you could use this:</p>\n\n<pre><code>regex = /(?&lt;=(d))idja/i # again, keep in mind the substrings\n\"didja Didja\".gsub(regex, \"id you\")   \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 2, "last_activity_date": 1426701536, "creation_date": 1426701536, "answer_id": 29129369, "question_id": 29128229, "link": "https://stackoverflow.com/questions/29128229/case-sensitive-substitutions-with-gsub/29129369#29129369", "title": "Case-sensitive substitutions with gsub", "body": "<p>It is not clear what capitalization patterns you have in mind. I assume that you only need to deal with words that are all low case or all low case except the first letter.</p>\n\n<pre><code>str.gsub!(/#{x}/i){|x| x.downcase! ? dictionary[x].capitalize : dictionary[x]}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 2, "last_activity_date": 1426705559, "last_edit_date": 1426705559, "creation_date": 1426703383, "answer_id": 29129954, "question_id": 29128229, "link": "https://stackoverflow.com/questions/29128229/case-sensitive-substitutions-with-gsub/29129954#29129954", "title": "Case-sensitive substitutions with gsub", "body": "<p>Suppose we have:</p>\n\n<ul>\n<li>a method <code>to_key</code> that converts a string <code>str</code> to a key in a hash <code>DICTIONARY</code>; and</li>\n<li>a method <code>transform</code> that converts the pair <code>[str, DICTIONARY[to_key(str)]]</code> to the replacement for <code>str</code>.</li>\n</ul>\n\n<p>Then <code>str</code> is to be replaced with:</p>\n\n<pre><code>transform(str, DICTIONARY[to_key(str)]])\n</code></pre>\n\n<p>Without lose of generality, I think we can assume that <code>DICTIONARY</code>'s keys and values are all of the same case (say, lower case) and that <code>to_key</code> is simply:</p>\n\n<pre><code>def to_key(str)\n  str.downcase\nend\n</code></pre>\n\n<p>So all that is necessary is to define the method <code>transform</code>. However, the specification provided does not imply a unique mapping. We therefore must decide what <code>transform</code> should do.</p>\n\n<p>For example, suppose the rule is simply that, if the first character of <code>str</code> and the first character of the dictionary value are both letters, the latter is to be converted to upper case if the former is upper case. Then:</p>\n\n<pre><code>def transform(str, dict_value)\n  (str[0] =~ /[A-Z]/) ? dict_value.capitalize : dict_value \nend\n</code></pre>\n\n<p>(I originally had <code>dict_value[0] = dict_value[0].upcase if...</code>, but came to my senses after reading @sawa's answer.)</p>\n\n<p>Note that if <code>DICTIONARY['cat'] =&gt; 'dog'</code>, <code>'Cat'</code> will be converted to <code>'Dog'</code>.</p>\n\n<p>One might think that another possibility is that all characters of <code>str</code> that are letters should maintain their case. This is problematic, however, as the dictionary mapping may (without further specification) remove letters, and it may not be clear from <code>DICTIONARY[str]</code> which letters of <code>str</code> were removed, some of which may be lower case and others upper case.</p>\n"}], "owner": {"reputation": 1518, "user_id": 3984943, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/DdHWC.jpg?s=128&g=1", "display_name": "jayqui", "link": "https://stackoverflow.com/users/3984943/jayqui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1062, "favorite_count": 0, "accepted_answer_id": 29129954, "answer_count": 3, "score": 2, "last_activity_date": 1426705559, "creation_date": 1426698074, "last_edit_date": 1426699219, "question_id": 29128229, "link": "https://stackoverflow.com/questions/29128229/case-sensitive-substitutions-with-gsub", "title": "Case-sensitive substitutions with gsub", "body": "<p>As an exercise, I'm working on an accent translation dictionary. My dictionary is contained in a hash, and I'm thinking of using <code>#gsub!</code> to run inputted strings through the translator.</p>\n\n<p>I'm wondering if there's any way to make the substitutions case-sensitive.  For example, I want <code>\"didja\"</code> to translate to <code>\"did you\"</code> and <code>\"Didja\"</code> to translate to <code>\"Did you\"</code>, but I don't want to have to create multiple dictionary entries to deal with case.</p>\n\n<p>I know I can use regex syntax to <em>find</em> strings to replace case-insensitively, with <code>str.gsub!(/#{x}/i,dictionary[x])</code> where <code>x</code> is a variable. The problem is that this replaces <code>\"Didja\"</code> with <code>\"did you\"</code>, rather than matching the original case.</p>\n\n<p>Is there any way to make it match the original case?</p>\n"}, {"tags": ["ruby", "arrays", "function", "store"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1426697938, "post_id": 29128075, "comment_id": 46482167, "body": "What does <code>results = client.get(...)</code> return into <code>results</code>? Is it already an array? It&#39;s at least enumerable, since you&#39;re doing <code>results.each...</code>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1426698023, "post_id": 29128075, "comment_id": 46482231, "body": "try <code>results.map(&amp;:title)</code> as the last line in place of <code>...each</code> and <code>array &lt;&lt;...</code> this will return an <code>Array</code> of all <code>titles</code> from <code>results</code> so really it could be 1 line <code>client.get(&#39;&#47;subjects&#39;, :genre =&gt; subject1).map(&amp;:title)</code> will have the same result. The you just store it in a variable <code>a = function(subject1)</code>"}, {"owner": {"reputation": 573, "user_id": 4566078, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/pWJYn.jpg?s=128&g=1", "display_name": "marriedjane875", "link": "https://stackoverflow.com/users/4566078/marriedjane875"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1426698252, "post_id": 29128075, "comment_id": 46482384, "body": "yes, client.get(&#39;...&#39;) turn into real results that I limit by choosing a subject in the genre. @lurker"}, {"owner": {"reputation": 573, "user_id": 4566078, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/pWJYn.jpg?s=128&g=1", "display_name": "marriedjane875", "link": "https://stackoverflow.com/users/4566078/marriedjane875"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1426698395, "post_id": 29128075, "comment_id": 46482457, "body": "ok, i&#39;m going to try it now @engineersmnky"}, {"owner": {"reputation": 514, "user_id": 2097165, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/46207a6e923cbbdb74c6966ef067eada?s=128&d=identicon&r=PG", "display_name": "Duck1337", "link": "https://stackoverflow.com/users/2097165/duck1337"}, "edited": false, "score": 0, "creation_date": 1426698557, "post_id": 29128075, "comment_id": 46482536, "body": "results.each { |r| array &lt;&lt; r.title } is what you&#39;re looking for"}], "answers": [{"comments": [{"owner": {"reputation": 573, "user_id": 4566078, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/pWJYn.jpg?s=128&g=1", "display_name": "marriedjane875", "link": "https://stackoverflow.com/users/4566078/marriedjane875"}, "edited": false, "score": 0, "creation_date": 1426699941, "post_id": 29128403, "comment_id": 46483465, "body": "so to call on the array later i would just put results.map ?"}, {"owner": {"reputation": 3299, "user_id": 1749638, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cERvr.jpg?s=128&g=1", "display_name": "coderhs", "link": "https://stackoverflow.com/users/1749638/coderhs"}, "reply_to_user": {"reputation": 573, "user_id": 4566078, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/pWJYn.jpg?s=128&g=1", "display_name": "marriedjane875", "link": "https://stackoverflow.com/users/4566078/marriedjane875"}, "edited": false, "score": 0, "creation_date": 1426700041, "post_id": 29128403, "comment_id": 46483531, "body": "you can save the result to a variable like so <code>response = function(subject1)</code>"}], "tags": [], "owner": {"reputation": 3299, "user_id": 1749638, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cERvr.jpg?s=128&g=1", "display_name": "coderhs", "link": "https://stackoverflow.com/users/1749638/coderhs"}, "is_accepted": true, "score": 2, "last_activity_date": 1426698605, "creation_date": 1426698605, "answer_id": 29128403, "question_id": 29128075, "link": "https://stackoverflow.com/questions/29128075/in-ruby-how-can-i-convert-a-functions-response-results-into-an-array/29128403#29128403", "title": "In ruby, how can I convert a function&#39;s response/results into an array?", "body": "<p>Each method will iterate through every element whereas map would return an array in itself.</p>\n\n<pre><code>def function(subject1)\n    results = client.get('/subjects', :genre =&gt; subject1)\n    results.map { |r| r.title }\nend\n\nfunction(subject1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 1, "last_activity_date": 1426698851, "creation_date": 1426698851, "answer_id": 29128486, "question_id": 29128075, "link": "https://stackoverflow.com/questions/29128075/in-ruby-how-can-i-convert-a-functions-response-results-into-an-array/29128486#29128486", "title": "In ruby, how can I convert a function&#39;s response/results into an array?", "body": "<p>\"My results however are never stored\" - store the result then:</p>\n\n<pre><code>result = function(subject1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 514, "user_id": 2097165, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/46207a6e923cbbdb74c6966ef067eada?s=128&d=identicon&r=PG", "display_name": "Duck1337", "link": "https://stackoverflow.com/users/2097165/duck1337"}, "is_accepted": false, "score": -2, "last_activity_date": 1426699455, "last_edit_date": 1426699455, "creation_date": 1426699048, "answer_id": 29128562, "question_id": 29128075, "link": "https://stackoverflow.com/questions/29128075/in-ruby-how-can-i-convert-a-functions-response-results-into-an-array/29128562#29128562", "title": "In ruby, how can I convert a function&#39;s response/results into an array?", "body": "<p>Or you can make array a global var</p>\n\n<pre><code>$array = []\ndef function (subject1)\n  results = client.get('/subjects', :genre =&gt; subject1)\n  results.each { |r| $array &lt;&lt; r.title }\nend\n\nfunction(subject1)\n</code></pre>\n\n<p>Or you can do this </p>\n\n<pre><code>array = []\ndef function (subject1)\n  results = client.get('/subjects', :genre =&gt; subject1)\n  results.each { |r| puts r.title }\nend\n\narray = function(subject1)\n</code></pre>\n"}], "owner": {"reputation": 573, "user_id": 4566078, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/pWJYn.jpg?s=128&g=1", "display_name": "marriedjane875", "link": "https://stackoverflow.com/users/4566078/marriedjane875"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "accepted_answer_id": 29128403, "answer_count": 3, "score": 0, "last_activity_date": 1426699455, "creation_date": 1426697689, "question_id": 29128075, "link": "https://stackoverflow.com/questions/29128075/in-ruby-how-can-i-convert-a-functions-response-results-into-an-array", "title": "In ruby, how can I convert a function&#39;s response/results into an array?", "body": "<p>In ruby, how can I convert a function response into array for later usage?</p>\n\n<pre><code>array = []\ndef function (subject1)\n    results = client.get('/subjects', :genre =&gt; subject1)\n    results.each { |r| puts r.title }\n    array &lt;&lt; r.title\nend\n\nfunction(subject1)\n</code></pre>\n\n<p>My code looks like something similar above. My results however are never stored. Please and thanks for your help :)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "answers": [{"tags": [], "owner": {"reputation": 625, "user_id": 1354994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cc0cb28311ab4cff350b933f0c5f0a39?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/1354994/thomas"}, "is_accepted": true, "score": 1, "last_activity_date": 1426697796, "creation_date": 1426697796, "answer_id": 29128109, "question_id": 29128031, "link": "https://stackoverflow.com/questions/29128031/rspec-tests-output/29128109#29128109", "title": "Rspec tests output", "body": "<p>Edit your <code>.rspec</code> file from (in you main folder)</p>\n\n<pre><code>--format documentation\n</code></pre>\n\n<p>to</p>\n\n<pre><code>--format progress\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8946, "user_id": 2398521, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/84bb49c56756a8c7cd54d4876d7a4467?s=128&d=identicon&r=PG", "display_name": "Maxim", "link": "https://stackoverflow.com/users/2398521/maxim"}, "is_accepted": false, "score": 0, "last_activity_date": 1426697864, "creation_date": 1426697864, "answer_id": 29128137, "question_id": 29128031, "link": "https://stackoverflow.com/questions/29128031/rspec-tests-output/29128137#29128137", "title": "Rspec tests output", "body": "<p>Use <code>-f</code> option to enable documentation format:</p>\n\n<pre><code>rspec -f d spec/\n</code></pre>\n\n<p>and <code>-b</code> option to enable full backtrace:</p>\n\n<pre><code>rspec -b spec/\n</code></pre>\n"}], "owner": {"reputation": 24422, "user_id": 190623, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ded2adc034647d0e934806583137ecdd?s=128&d=identicon&r=PG", "display_name": "Gandalf StormCrow", "link": "https://stackoverflow.com/users/190623/gandalf-stormcrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "accepted_answer_id": 29128109, "answer_count": 2, "score": 0, "last_activity_date": 1426697864, "creation_date": 1426697569, "question_id": 29128031, "link": "https://stackoverflow.com/questions/29128031/rspec-tests-output", "title": "Rspec tests output", "body": "<p>How can I run rspect test (I'm using rspec 2 btw). </p>\n\n<p>So that the console only outputs the dots instead of full test log, I've seen it before where green dots are passed tests and the red ones are the failed ones, along with the test outputs the red ones only at the end of test</p>\n"}, {"tags": ["ruby", "gem", "bundler"], "comments": [{"owner": {"reputation": 37807, "user_id": 293686, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1426a9fd5267e73d9e30ebaac1bde144?s=128&d=identicon&r=PG", "display_name": "Maur&#237;cio Linhares", "link": "https://stackoverflow.com/users/293686/maur%c3%adcio-linhares"}, "edited": false, "score": 0, "creation_date": 1426697097, "post_id": 29127777, "comment_id": 46481608, "body": "Are you using the <code>bundle</code> command to load your code? You can&#39;t use <code>--path</code> and just ignore bundler."}, {"owner": {"reputation": 333, "user_id": 1339736, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/a3uG7.jpg?s=128&g=1", "display_name": "PackedUp", "link": "https://stackoverflow.com/users/1339736/packedup"}, "reply_to_user": {"reputation": 37807, "user_id": 293686, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1426a9fd5267e73d9e30ebaac1bde144?s=128&d=identicon&r=PG", "display_name": "Maur&#237;cio Linhares", "link": "https://stackoverflow.com/users/293686/maur%c3%adcio-linhares"}, "edited": false, "score": 0, "creation_date": 1426697231, "post_id": 29127777, "comment_id": 46481692, "body": "I am using <code>ruby</code> command to run the code. I am not sure what you are referencing <code>--path</code> with bundler."}, {"owner": {"reputation": 37807, "user_id": 293686, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1426a9fd5267e73d9e30ebaac1bde144?s=128&d=identicon&r=PG", "display_name": "Maur&#237;cio Linhares", "link": "https://stackoverflow.com/users/293686/maur%c3%adcio-linhares"}, "edited": false, "score": 1, "creation_date": 1426697348, "post_id": 29127777, "comment_id": 46481775, "body": "You can&#39;t use <code>ruby</code>, you have to use <code>bundle exec ruby path-to-your.rb</code>."}], "answers": [{"tags": [], "owner": {"reputation": 333, "user_id": 1339736, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/a3uG7.jpg?s=128&g=1", "display_name": "PackedUp", "link": "https://stackoverflow.com/users/1339736/packedup"}, "is_accepted": false, "score": 1, "last_activity_date": 1426697754, "creation_date": 1426697754, "answer_id": 29128092, "question_id": 29127777, "link": "https://stackoverflow.com/questions/29127777/bundler-install-custom-path-issue/29128092#29128092", "title": "Bundler install custom path issue", "body": "<p>Maur\u00edcio Linhares comments in the question has resolved the issue.</p>\n\n<p>When using bundler to install gems use bundle exec ruby. When the <code>bundle install --deployment</code> happens the path information goes into .bundle/config </p>\n\n<pre><code>bundle exec ruby path-to-ruby-script.rb\n</code></pre>\n\n<p>The above execution Will find the gems installed by the <code>bundle</code> command.</p>\n"}, {"tags": [], "owner": {"reputation": 5921, "user_id": 29470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/926224cbb63e5b617300e99c89051ce7?s=128&d=identicon&r=PG", "display_name": "Tim Moore", "link": "https://stackoverflow.com/users/29470/tim-moore"}, "is_accepted": false, "score": 0, "last_activity_date": 1426985264, "creation_date": 1426985264, "answer_id": 29189774, "question_id": 29127777, "link": "https://stackoverflow.com/questions/29127777/bundler-install-custom-path-issue/29189774#29189774", "title": "Bundler install custom path issue", "body": "<p>Alternatively, if you want to force installation to the system gem location, I believe <code>bundle install --deployment --system</code> will do what you want.</p>\n"}], "owner": {"reputation": 333, "user_id": 1339736, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/a3uG7.jpg?s=128&g=1", "display_name": "PackedUp", "link": "https://stackoverflow.com/users/1339736/packedup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 585, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1426985264, "creation_date": 1426696922, "question_id": 29127777, "link": "https://stackoverflow.com/questions/29127777/bundler-install-custom-path-issue", "title": "Bundler install custom path issue", "body": "<p><code>gem env</code> shows</p>\n\n<pre><code>GEM PATHS:\n\n  /usr/local/share/gems\n</code></pre>\n\n<p>I would like to use <code>bundle install --deployment --path=/usr/local/share/gems</code> to install my bundled gems.</p>\n\n<p>The problem is that the bundle install creates a folder <strong>ruby</strong> and puts the <strong>gems</strong> folder inside the <strong>ruby</strong> folder.</p>\n\n<p>When this happens my ruby code is unable to find the gems in its default path.</p>\n\n<p>Looks like I am missing some configuration parameter. Help please.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "undefined", "polymorphic-associations", "railscasts"], "comments": [{"owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "reply_to_user": {"reputation": 1243, "user_id": 1891599, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a1beeb83f38d8dc7c1499b686161613?s=128&d=identicon&r=PG", "display_name": "AshwinKumarS", "link": "https://stackoverflow.com/users/1891599/ashwinkumars"}, "edited": false, "score": 0, "creation_date": 1426700393, "post_id": 29127606, "comment_id": 46483737, "body": "@0v3rc10ck3d updated question with trace. Thanks!"}, {"owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "reply_to_user": {"reputation": 4602, "user_id": 1141264, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4af75d466ec6c84e3a0a9f1de61233ae?s=128&d=identicon&r=PG", "display_name": "DickieBoy", "link": "https://stackoverflow.com/users/1141264/dickieboy"}, "edited": false, "score": 0, "creation_date": 1426700411, "post_id": 29127606, "comment_id": 46483743, "body": "@DickieBoy thanks but that didn&#39;t work."}, {"owner": {"reputation": 4602, "user_id": 1141264, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4af75d466ec6c84e3a0a9f1de61233ae?s=128&d=identicon&r=PG", "display_name": "DickieBoy", "link": "https://stackoverflow.com/users/1141264/dickieboy"}, "edited": false, "score": 0, "creation_date": 1426701063, "post_id": 29127606, "comment_id": 46484134, "body": "What version of rails are you using? Have you restarted your server? Can you post your models?"}, {"owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "reply_to_user": {"reputation": 4602, "user_id": 1141264, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4af75d466ec6c84e3a0a9f1de61233ae?s=128&d=identicon&r=PG", "display_name": "DickieBoy", "link": "https://stackoverflow.com/users/1141264/dickieboy"}, "edited": false, "score": 0, "creation_date": 1426701522, "post_id": 29127606, "comment_id": 46484424, "body": "@DickieBoy I am using rails <code>4.2.0.rc3</code>. I have restarted the server. And I added the models above. Thks for your interest :)"}, {"owner": {"reputation": 4602, "user_id": 1141264, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4af75d466ec6c84e3a0a9f1de61233ae?s=128&d=identicon&r=PG", "display_name": "DickieBoy", "link": "https://stackoverflow.com/users/1141264/dickieboy"}, "edited": false, "score": 0, "creation_date": 1426702088, "post_id": 29127606, "comment_id": 46484777, "body": "I highly doubt its the rc version but i can&#39;t see anything that wouldn&#39;t work."}, {"owner": {"reputation": 4999, "user_id": 4151953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d405a824f3f34d13b9e57532532f99?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Babio", "link": "https://stackoverflow.com/users/4151953/alejandro-babio"}, "edited": false, "score": 0, "creation_date": 1426712181, "post_id": 29127606, "comment_id": 46490842, "body": "Please, can you open a rails console and run this: <code>Comment.new.respond_to? :content</code>.  It must respond with &#39;true&#39;."}, {"owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "reply_to_user": {"reputation": 4999, "user_id": 4151953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d405a824f3f34d13b9e57532532f99?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Babio", "link": "https://stackoverflow.com/users/4151953/alejandro-babio"}, "edited": false, "score": 0, "creation_date": 1426715504, "post_id": 29127606, "comment_id": 46492499, "body": "@AlejandroBabio good call it comes up false!"}, {"owner": {"reputation": 4999, "user_id": 4151953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d405a824f3f34d13b9e57532532f99?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Babio", "link": "https://stackoverflow.com/users/4151953/alejandro-babio"}, "edited": false, "score": 0, "creation_date": 1426716237, "post_id": 29127606, "comment_id": 46492810, "body": "Then, check your migrations (all of them on table comments) and your schema. If all is ok. Drop the db and generate from migration or schema."}, {"owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "reply_to_user": {"reputation": 4999, "user_id": 4151953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d405a824f3f34d13b9e57532532f99?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Babio", "link": "https://stackoverflow.com/users/4151953/alejandro-babio"}, "edited": false, "score": 0, "creation_date": 1426717067, "post_id": 29127606, "comment_id": 46493154, "body": "@AlejandroBabio this prob a stupid question but is there a command to load the migrate file 20150317171422_create_comments.rb into schema? My habit has been to do everything by hand and then run <code>rake db:reset</code>."}, {"owner": {"reputation": 4999, "user_id": 4151953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d405a824f3f34d13b9e57532532f99?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Babio", "link": "https://stackoverflow.com/users/4151953/alejandro-babio"}, "edited": false, "score": 0, "creation_date": 1426718697, "post_id": 29127606, "comment_id": 46493744, "body": "<code>rake -T db</code> shows all the commands for db. The schema is updated by the migrations. You can rollback n steps until a &#39;safe&#39; point, and then run the migrations again. If I understood your question."}, {"owner": {"reputation": 4999, "user_id": 4151953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d405a824f3f34d13b9e57532532f99?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Babio", "link": "https://stackoverflow.com/users/4151953/alejandro-babio"}, "edited": false, "score": 0, "creation_date": 1426718902, "post_id": 29127606, "comment_id": 46493820, "body": "Also I don&#39;t know other way to do it. I think that the most standards and used methods are the best, because any problem is detected early and fixed."}], "answers": [{"comments": [{"owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "edited": false, "score": 0, "creation_date": 1426723394, "post_id": 29134279, "comment_id": 46495207, "body": "My man that worked! I don&#39;t know how, but it did. All the best."}], "tags": [], "owner": {"reputation": 4999, "user_id": 4151953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d405a824f3f34d13b9e57532532f99?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Babio", "link": "https://stackoverflow.com/users/4151953/alejandro-babio"}, "is_accepted": true, "score": 2, "last_activity_date": 1426721431, "last_edit_date": 1426721431, "creation_date": 1426719593, "answer_id": 29134279, "question_id": 29127606, "link": "https://stackoverflow.com/questions/29127606/polymorphic-associations-undefined-method-content/29134279#29134279", "title": "Polymorphic Associations undefined method &#39;content&#39;", "body": "<p>As I guess on the comments, the field <code>:content</code> is not defined for your table <code>comments</code>.</p>\n\n<p>You can see it at the rails console with: <code>Comment.new.respond_to?(:content)</code>, if it respond with <code>false</code>.</p>\n\n<p>If you have problems on the migrations, fix them and re-generate the db from scratch: drop the db, remove the file schema.rb and rake db:migrate.</p>\n\n<p>This also works if your migrations are ok and you have a problem with your schema.rb.</p>\n\n<p><strong>Edit</strong>: when I inspect your code I saw in your <code>CommentsController</code> at actions: <code>create</code> and <code>update</code> you are using <code>params[:comment]</code> for update. I think you want to use the method <code>comment_params</code> instead.</p>\n"}], "owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "accepted_answer_id": 29134279, "answer_count": 1, "score": 1, "last_activity_date": 1426721431, "creation_date": 1426696435, "last_edit_date": 1426701465, "question_id": 29127606, "link": "https://stackoverflow.com/questions/29127606/polymorphic-associations-undefined-method-content", "title": "Polymorphic Associations undefined method &#39;content&#39;", "body": "<p>I followed this railscasts episode: <a href=\"http://railscasts.com/episodes/154-polymorphic-association-revised?view=comments\" rel=\"nofollow noreferrer\">http://railscasts.com/episodes/154-polymorphic-association-revised?view=comments</a>.</p>\n\n<p>And now get this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/5pU0t.png\" alt=\"enter image description here\"></p>\n\n<pre><code>&lt;%= form_for [@commentable, @comment] do |f| %&gt;\n  &lt;% if @comment.errors.any? %&gt;\n    &lt;div class=\"error_messages\"&gt;\n      &lt;h2&gt;Please correct the following errors.&lt;/h2&gt;\n      &lt;ul&gt;\n      &lt;% @comment.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.text_area :content, rows: 8 %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Am I doing something wrong in the valuations controller, like with valuations_params?</p>\n\n<pre><code>class ValuationsController &lt; ApplicationController\n  before_action :set_valuation, only: [:show, :edit, :update, :destroy]\n  before_action :logged_in_user, only: [:create, :destroy]\n\n  def index\n    if params[:tag]\n      @valuations = Valuation.tagged_with(params[:tag])\n    else\n      @valuations = Valuation.order('RANDOM()')\n    end\n  end\n\n  def show\n    @valuation = Valuation.find(params[:id])\n    @commentable = @valuation\n    @comments = @commentable.comments\n    @comment = Comment.new\n  end\n\n  def new\n    @valuation = current_user.valuations.build\n  end\n\n  def edit\n  end\n\n  def create\n    @valuation = current_user.valuations.build(valuation_params)\n    if @valuation.save\n      redirect_to @valuation, notice: 'Value was successfully created'\n    else\n      @feed_items = []\n      render 'pages/home'\n  end\nend\n\n  def update\n    if @valuation.update(valuation_params)\n      redirect_to @valuation, notice: 'Value was successfully updated'\n    else\n      render action: 'edit'\n  end\nend\n\n  def destroy\n    @valuation.destroy\n    redirect_to valuations_url\n  end\n\n  private\n    def set_valuation\n      @valuation = Valuation.find(params[:id])\n    end\n\n    def correct_user\n      @valuation = current_user.valuations.find_by(id: params[:id])\n      redirect_to valuations_path, notice: \"Not authorized to edit this valuation\" if @valuation.nil?\n    end\n\n    def valuation_params\n      params.require(:valuation).permit(:name, :private_submit, :tag_list, :content, :commentable, :comment)\n    end\nend\n\n\nclass CommentsController &lt; ApplicationController\n    before_filter :load_commentable\n\n    def index\n        @comments = @commentable.comments\n    end\n\n    def new\n        @comment = @commentable.comments.new\n    end\n\n    def create\n        @comment = @commentable.comments.new(params[:comment])\n        @comment.user = current_user\n        if @comment.save\n            @comment.create_activity :create, owner: current_user\n            redirect_to @commentable, notice: \"comment created.\"\n        else\n            render :new\n        end\n    end\n\n    def edit\n        @comment = current_user.comments.find(params[:id])\n    end\n\n    def update\n        @comment = current_user.comments.find(params[:id])\n        if @comment.update_attributes(params[:comment])\n            redirect_to @commentable, notice: \"Comment was updated.\"\n        else\n            render :edit\n        end\n    end\n\n    def destroy\n        @comment = current_user.comments.find(params[:id])\n        @comment.destroy\n        @comment.create_activity :destroy, owner: current_user\n        redirect_to @commentable, notice: \"comment destroyed.\"\n    end\n\nprivate\n\n    def load_commentable\n        resource, id = request.path.split('/')[1, 2]\n        @commentable = resource.singularize.classify.constantize.find(id)\n    end\n\n    def comment_params\n        params.require(:comment).permit(:content, :commentable)\n    end\nend\n\n\nclass CreateComments &lt; ActiveRecord::Migration\n  def change\n    create_table :comments do |t|\n        t.text :content\n        t.belongs_to :commentable, polymorphic: true\n\n      t.timestamps null: false\n    end\n    add_index :comments, [:commentable_id, :commentable_type]\n  end\nend\n\nclass CreateValuations &lt; ActiveRecord::Migration\n  def change\n    create_table :valuations do |t|\n      t.string :name\n      t.boolean :private_submit\n      t.references :user, index: true\n\n      t.timestamps null: false\n    end\n    add_foreign_key :valuations, :users\n    add_index :valuations, [:user_id, :created_at]\n  end\nend\n</code></pre>\n\n\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"false\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>class Valuation &lt; ActiveRecord::Base\r\n\tbelongs_to :user\r\n\thas_many :comments, as: :commentable\r\n  acts_as_taggable\r\n  validates :name, presence: true\r\n\tscope :private_submit, -&gt; { where(private_submit: true) }\r\n\tscope :public_submit, -&gt; { where(private_submit: false) }\r\n  include PublicActivity::Model\r\n  tracked owner: -&gt;(controller, model) { controller &amp;&amp; controller.current_user }\r\n\r\n  scope :randomize, -&gt; do\r\n\t  order('RANDOM()').\r\n\t  take(1)\r\n\tend\r\nend</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"false\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>class Comment &lt; ActiveRecord::Base\r\n\tinclude PublicActivity::Common\r\n\t# tracked except: :update,  owner: -&gt;(controller, model) { controller &amp;&amp; controller.current_user }\r\n\tbelongs_to :commentable, polymorphic: true\r\nend</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><strong>Full trace</strong></p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"false\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>activemodel (4.2.0.rc3) lib/active_model/attribute_methods.rb:433:in `method_missing'\r\nactionview (4.2.0.rc3) lib/action_view/helpers/tags/base.rb:28:in `public_send'\r\nactionview (4.2.0.rc3) lib/action_view/helpers/tags/base.rb:28:in `value'\r\nactionview (4.2.0.rc3) lib/action_view/helpers/tags/base.rb:37:in `value_before_type_cast'\r\nactionview (4.2.0.rc3) lib/action_view/helpers/tags/text_area.rb:17:in `block in render'\r\nactionview (4.2.0.rc3) lib/action_view/helpers/tags/text_area.rb:17:in `delete'\r\nactionview (4.2.0.rc3) lib/action_view/helpers/tags/text_area.rb:17:in `render'\r\nactionview (4.2.0.rc3) lib/action_view/helpers/form_helper.rb:886:in `text_area'\r\nactionview (4.2.0.rc3) lib/action_view/helpers/form_helper.rb:1322:in `text_area'\r\napp/views/comments/_form.html.erb:14:in `block in _app_views_comments__form_html_erb__170709608867418685_70276962559280'\r\nactionview (4.2.0.rc3) lib/action_view/helpers/capture_helper.rb:38:in `block in capture'\r\nactionview (4.2.0.rc3) lib/action_view/helpers/capture_helper.rb:200:in `with_output_buffer'\r\nhaml (4.0.6) lib/haml/helpers/action_view_xss_mods.rb:5:in `with_output_buffer_with_haml_xss'\r\nactionview (4.2.0.rc3) lib/action_view/helpers/capture_helper.rb:38:in `capture'\r\nhaml (4.0.6) lib/haml/helpers/action_view_mods.rb:52:in `capture_with_haml'\r\nactionview (4.2.0.rc3) lib/action_view/helpers/form_helper.rb:444:in `form_for'\r\nhaml (4.0.6) lib/haml/helpers/action_view_mods.rb:139:in `form_for_with_haml'\r\nhaml (4.0.6) lib/haml/helpers/action_view_xss_mods.rb:28:in `form_for_with_haml_xss'\r\napp/views/comments/_form.html.erb:1:in `_app_views_comments__form_html_erb__170709608867418685_70276962559280'\r\nactionview (4.2.0.rc3) lib/action_view/template.rb:145:in `block in render'\r\nactivesupport (4.2.0.rc3) lib/active_support/notifications.rb:166:in `instrument'\r\nactionview (4.2.0.rc3) lib/action_view/template.rb:333:in `instrument'\r\nactionview (4.2.0.rc3) lib/action_view/template.rb:143:in `render'\r\nactionview (4.2.0.rc3) lib/action_view/renderer/partial_renderer.rb:339:in `render_partial'\r\nactionview (4.2.0.rc3) lib/action_view/renderer/partial_renderer.rb:310:in `block in render'\r\nactionview (4.2.0.rc3) lib/action_view/renderer/abstract_renderer.rb:39:in `block in instrument'\r\nactivesupport (4.2.0.rc3) lib/active_support/notifications.rb:164:in `block in instrument'\r\nactivesupport (4.2.0.rc3) lib/active_support/notifications/instrumenter.rb:20:in `instrument'\r\nactivesupport (4.2.0.rc3) lib/active_support/notifications.rb:164:in `instrument'\r\nactionview (4.2.0.rc3) lib/action_view/renderer/abstract_renderer.rb:39:in `instrument'\r\nactionview (4.2.0.rc3) lib/action_view/renderer/partial_renderer.rb:309:in `render'\r\nactionview (4.2.0.rc3) lib/action_view/renderer/renderer.rb:47:in `render_partial'\r\nactionview (4.2.0.rc3) lib/action_view/helpers/rendering_helper.rb:35:in `render'\r\nhaml (4.0.6) lib/haml/helpers/action_view_mods.rb:12:in `render_with_haml'\r\napp/views/valuations/show.html.erb:13:in `_app_views_valuations_show_html_erb___1405174294651949311_70276963239480'\r\nactionview (4.2.0.rc3) lib/action_view/template.rb:145:in `block in render'\r\nactivesupport (4.2.0.rc3) lib/active_support/notifications.rb:166:in `instrument'\r\nactionview (4.2.0.rc3) lib/action_view/template.rb:333:in `instrument'\r\nactionview (4.2.0.rc3) lib/action_view/template.rb:143:in `render'\r\nactionview (4.2.0.rc3) lib/action_view/renderer/template_renderer.rb:54:in `block (2 levels) in render_template'\r\nactionview (4.2.0.rc3) lib/action_view/renderer/abstract_renderer.rb:39:in `block in instrument'\r\nactivesupport (4.2.0.rc3) lib/active_support/notifications.rb:164:in `block in instrument'\r\nactivesupport (4.2.0.rc3) lib/active_support/notifications/instrumenter.rb:20:in `instrument'\r\nactivesupport (4.2.0.rc3) lib/active_support/notifications.rb:164:in `instrument'\r\nactionview (4.2.0.rc3) lib/action_view/renderer/abstract_renderer.rb:39:in `instrument'\r\nactionview (4.2.0.rc3) lib/action_view/renderer/template_renderer.rb:53:in `block in render_template'\r\nactionview (4.2.0.rc3) lib/action_view/renderer/template_renderer.rb:61:in `render_with_layout'\r\nactionview (4.2.0.rc3) lib/action_view/renderer/template_renderer.rb:52:in `render_template'\r\nactionview (4.2.0.rc3) lib/action_view/renderer/template_renderer.rb:14:in `render'\r\nactionview (4.2.0.rc3) lib/action_view/renderer/renderer.rb:42:in `render_template'\r\nactionview (4.2.0.rc3) lib/action_view/renderer/renderer.rb:23:in `render'\r\nactionview (4.2.0.rc3) lib/action_view/rendering.rb:100:in `_render_template'\r\nactionpack (4.2.0.rc3) lib/action_controller/metal/streaming.rb:217:in `_render_template'\r\nactionview (4.2.0.rc3) lib/action_view/rendering.rb:83:in `render_to_body'\r\nactionpack (4.2.0.rc3) lib/action_controller/metal/rendering.rb:32:in `render_to_body'\r\nactionpack (4.2.0.rc3) lib/action_controller/metal/renderers.rb:37:in `render_to_body'\r\nactionpack (4.2.0.rc3) lib/abstract_controller/rendering.rb:25:in `render'\r\nactionpack (4.2.0.rc3) lib/action_controller/metal/rendering.rb:16:in `render'\r\nactionpack (4.2.0.rc3) lib/action_controller/metal/instrumentation.rb:41:in `block (2 levels) in render'\r\nactivesupport (4.2.0.rc3) lib/active_support/core_ext/benchmark.rb:12:in `block in ms'\r\n/Users/galli01anthony/.rvm/rubies/ruby-2.1.3/lib/ruby/2.1.0/benchmark.rb:294:in `realtime'\r\nactivesupport (4.2.0.rc3) lib/active_support/core_ext/benchmark.rb:12:in `ms'\r\nactionpack (4.2.0.rc3) lib/action_controller/metal/instrumentation.rb:41:in `block in render'\r\nactionpack (4.2.0.rc3) lib/action_controller/metal/instrumentation.rb:84:in `cleanup_view_runtime'\r\nactiverecord (4.2.0.rc3) lib/active_record/railties/controller_runtime.rb:25:in `cleanup_view_runtime'\r\nactionpack (4.2.0.rc3) lib/action_controller/metal/instrumentation.rb:40:in `render'\r\nactionpack (4.2.0.rc3) lib/action_controller/metal/implicit_render.rb:10:in `default_render'\r\nactionpack (4.2.0.rc3) lib/action_controller/metal/implicit_render.rb:5:in `send_action'\r\nactionpack (4.2.0.rc3) lib/abstract_controller/base.rb:198:in `process_action'\r\nactionpack (4.2.0.rc3) lib/action_controller/metal/rendering.rb:10:in `process_action'\r\nactionpack (4.2.0.rc3) lib/abstract_controller/callbacks.rb:20:in `block in process_action'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:117:in `call'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:117:in `call'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:151:in `block in halting_and_conditional'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:151:in `call'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:151:in `block in halting_and_conditional'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:234:in `call'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:234:in `block in halting'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:169:in `call'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:169:in `block in halting'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:169:in `call'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:169:in `block in halting'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:169:in `call'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:169:in `block in halting'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:169:in `call'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:169:in `block in halting'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:169:in `call'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:169:in `block in halting'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:234:in `call'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:234:in `block in halting'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:169:in `call'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:169:in `block in halting'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:169:in `call'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:169:in `block in halting'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:169:in `call'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:169:in `block in halting'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:92:in `call'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:92:in `_run_callbacks'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:734:in `_run_process_action_callbacks'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:81:in `run_callbacks'\r\nactionpack (4.2.0.rc3) lib/abstract_controller/callbacks.rb:19:in `process_action'\r\nactionpack (4.2.0.rc3) lib/action_controller/metal/rescue.rb:29:in `process_action'\r\nactionpack (4.2.0.rc3) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'\r\nactivesupport (4.2.0.rc3) lib/active_support/notifications.rb:164:in `block in instrument'\r\nactivesupport (4.2.0.rc3) lib/active_support/notifications/instrumenter.rb:20:in `instrument'\r\nactivesupport (4.2.0.rc3) lib/active_support/notifications.rb:164:in `instrument'\r\nactionpack (4.2.0.rc3) lib/action_controller/metal/instrumentation.rb:30:in `process_action'\r\nactionpack (4.2.0.rc3) lib/action_controller/metal/params_wrapper.rb:250:in `process_action'\r\nactiverecord (4.2.0.rc3) lib/active_record/railties/controller_runtime.rb:18:in `process_action'\r\nactionpack (4.2.0.rc3) lib/abstract_controller/base.rb:137:in `process'\r\nactionview (4.2.0.rc3) lib/action_view/rendering.rb:30:in `process'\r\nactionpack (4.2.0.rc3) lib/action_controller/metal.rb:195:in `dispatch'\r\nactionpack (4.2.0.rc3) lib/action_controller/metal/rack_delegation.rb:13:in `dispatch'\r\nactionpack (4.2.0.rc3) lib/action_controller/metal.rb:236:in `block in action'\r\nactionpack (4.2.0.rc3) lib/action_dispatch/routing/route_set.rb:73:in `call'\r\nactionpack (4.2.0.rc3) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'\r\nactionpack (4.2.0.rc3) lib/action_dispatch/routing/route_set.rb:42:in `serve'\r\nactionpack (4.2.0.rc3) lib/action_dispatch/journey/router.rb:43:in `block in serve'\r\nactionpack (4.2.0.rc3) lib/action_dispatch/journey/router.rb:30:in `each'\r\nactionpack (4.2.0.rc3) lib/action_dispatch/journey/router.rb:30:in `serve'\r\nactionpack (4.2.0.rc3) lib/action_dispatch/routing/route_set.rb:802:in `call'\r\nomniauth (1.2.2) lib/omniauth/strategy.rb:186:in `call!'\r\nomniauth (1.2.2) lib/omniauth/strategy.rb:164:in `call'\r\nomniauth (1.2.2) lib/omniauth/builder.rb:59:in `call'\r\nrack (1.6.0) lib/rack/etag.rb:24:in `call'\r\nrack (1.6.0) lib/rack/conditionalget.rb:25:in `call'\r\nrack (1.6.0) lib/rack/head.rb:13:in `call'\r\nactionpack (4.2.0.rc3) lib/action_dispatch/middleware/params_parser.rb:27:in `call'\r\nactionpack (4.2.0.rc3) lib/action_dispatch/middleware/flash.rb:260:in `call'\r\nrack (1.6.0) lib/rack/session/abstract/id.rb:225:in `context'\r\nrack (1.6.0) lib/rack/session/abstract/id.rb:220:in `call'\r\nactionpack (4.2.0.rc3) lib/action_dispatch/middleware/cookies.rb:560:in `call'\r\nactiverecord (4.2.0.rc3) lib/active_record/query_cache.rb:36:in `call'\r\nactiverecord (4.2.0.rc3) lib/active_record/connection_adapters/abstract/connection_pool.rb:647:in `call'\r\nactiverecord (4.2.0.rc3) lib/active_record/migration.rb:378:in `call'\r\nactionpack (4.2.0.rc3) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:88:in `call'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:88:in `_run_callbacks'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:734:in `_run_call_callbacks'\r\nactivesupport (4.2.0.rc3) lib/active_support/callbacks.rb:81:in `run_callbacks'\r\nactionpack (4.2.0.rc3) lib/action_dispatch/middleware/callbacks.rb:27:in `call'\r\nactionpack (4.2.0.rc3) lib/action_dispatch/middleware/reloader.rb:73:in `call'\r\nactionpack (4.2.0.rc3) lib/action_dispatch/middleware/remote_ip.rb:78:in `call'\r\nactionpack (4.2.0.rc3) lib/action_dispatch/middleware/debug_exceptions.rb:17:in `call'\r\nactionpack (4.2.0.rc3) lib/action_dispatch/middleware/show_exceptions.rb:30:in `call'\r\nrailties (4.2.0.rc3) lib/rails/rack/logger.rb:38:in `call_app'\r\nrailties (4.2.0.rc3) lib/rails/rack/logger.rb:20:in `block in call'\r\nactivesupport (4.2.0.rc3) lib/active_support/tagged_logging.rb:68:in `block in tagged'\r\nactivesupport (4.2.0.rc3) lib/active_support/tagged_logging.rb:26:in `tagged'\r\nactivesupport (4.2.0.rc3) lib/active_support/tagged_logging.rb:68:in `tagged'\r\nrailties (4.2.0.rc3) lib/rails/rack/logger.rb:20:in `call'\r\nactionpack (4.2.0.rc3) lib/action_dispatch/middleware/request_id.rb:21:in `call'\r\nrack (1.6.0) lib/rack/methodoverride.rb:22:in `call'\r\nrack (1.6.0) lib/rack/runtime.rb:18:in `call'\r\nactivesupport (4.2.0.rc3) lib/active_support/cache/strategy/local_cache_middleware.rb:28:in `call'\r\nrack (1.6.0) lib/rack/lock.rb:17:in `call'\r\nactionpack (4.2.0.rc3) lib/action_dispatch/middleware/static.rb:113:in `call'\r\nrack (1.6.0) lib/rack/sendfile.rb:113:in `call'\r\nrailties (4.2.0.rc3) lib/rails/engine.rb:518:in `call'\r\nrailties (4.2.0.rc3) lib/rails/application.rb:164:in `call'\r\nrack (1.6.0) lib/rack/lock.rb:17:in `call'\r\nrack (1.6.0) lib/rack/content_length.rb:15:in `call'\r\nrack (1.6.0) lib/rack/handler/webrick.rb:89:in `service'\r\n/Users/galli01anthony/.rvm/rubies/ruby-2.1.3/lib/ruby/2.1.0/webrick/httpserver.rb:138:in `service'\r\n/Users/galli01anthony/.rvm/rubies/ruby-2.1.3/lib/ruby/2.1.0/webrick/httpserver.rb:94:in `run'\r\n/Users/galli01anthony/.rvm/rubies/ruby-2.1.3/lib/ruby/2.1.0/webrick/server.rb:295:in `block in start_thread'</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><strong>Thank you for your time.</strong></p>\n"}, {"tags": ["ruby", "require", "rakefile"], "answers": [{"comments": [{"owner": {"reputation": 2672, "user_id": 223936, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/j58Xn.jpg?s=128&g=1", "display_name": "Plastikfan", "link": "https://stackoverflow.com/users/223936/plastikfan"}, "edited": false, "score": 0, "creation_date": 1426699057, "post_id": 29127812, "comment_id": 46482888, "body": "So what is the correct require for cart.gemspec? With the code you show included in my rakefile, require &#39;cart/version&#39; works, but require &#39;cart.gemspec&#39; still fails, which surprises me because the rakefile is in the same directory as cart.gemspec."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 2672, "user_id": 223936, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/j58Xn.jpg?s=128&g=1", "display_name": "Plastikfan", "link": "https://stackoverflow.com/users/223936/plastikfan"}, "edited": false, "score": 0, "creation_date": 1426702244, "post_id": 29127812, "comment_id": 46484895, "body": "@Shantaram you cannot <code>require</code> a gemspec. Not sure why you would need to either. <code>require</code> is reserved for <code>rb</code> and shared library extensions like <code>.so</code>,<code>.dll</code>, or <code>.o</code>. You can <code>load</code> the file using <code>load &#39;.&#47;cart.gemspec&#39;</code>"}, {"owner": {"reputation": 2672, "user_id": 223936, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/j58Xn.jpg?s=128&g=1", "display_name": "Plastikfan", "link": "https://stackoverflow.com/users/223936/plastikfan"}, "edited": false, "score": 0, "creation_date": 1426702653, "post_id": 29127812, "comment_id": 46485161, "body": "The reason why I want to &#39;require&#39; the gemspec, is I want to be able to use the gemspec defined in the gem spec file, to define a rake task. That would mean I could build my gem via rake, but also build the gem via the &#39;gem build&#39; command. I don&#39;t want to have to repeat my gem spec in more than 1 place, which is why I want to include the spec that I already have defined into my Rakefile. And thanks for your contribution to this question, it definitely helps. So, is it good practice to use this pattern of lib=File.expand_path... and $LOAD_PATH.unshift(... in every .rb file you write?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 2672, "user_id": 223936, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/j58Xn.jpg?s=128&g=1", "display_name": "Plastikfan", "link": "https://stackoverflow.com/users/223936/plastikfan"}, "edited": false, "score": 0, "creation_date": 1426702966, "post_id": 29127812, "comment_id": 46485368, "body": "@Shantaram no this is not good practice generally this pattern would be defined in the <code>gemspec</code>. So if this is already true then just <code>load &#39;.&#47;cart.gemspec&#39;</code> as the first line and all is good."}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 5, "last_activity_date": 1526087871, "last_edit_date": 1526087871, "creation_date": 1426697034, "answer_id": 29127812, "question_id": 29126928, "link": "https://stackoverflow.com/questions/29126928/how-to-correctly-include-other-project-files-from-ruby-rakefile/29127812#29127812", "title": "How to correctly include other project files from Ruby rakefile", "body": "<blockquote>\n  <p>When specifying a require, where should the path specified be relative to? Is it relative from the file you are requiring from or relative to lib folder or whatever else?</p>\n</blockquote>\n\n<p><code>require_relative</code> will be relative to the calling file.</p>\n\n<p><code>require</code> looks through <code>$LOAD_PATH</code> directories unless the file path is absolute. Since your project does not seem to be asserting itself in <code>$LOAD_PATH</code> and your paths are not absolute it can't find the file. </p>\n\n<p>Since this seems like a gem have you tried adding the standard </p>\n\n<pre><code>#this will be the absolute path to lib based on the calling __FILE__\nlib = File.expand_path('../lib', __FILE__)\n#this will include the path in $LOAD_PATH unless it is already included\n$LOAD_PATH.unshift(lib) unless $LOAD_PATH.include?(lib)\n</code></pre>\n\n<p>This will assert the <code>lib</code> directory in <code>$LOAD_PATH</code> then you can require based on the path from lib e.g. <code>require 'cart/version'</code></p>\n"}], "owner": {"reputation": 2672, "user_id": 223936, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/j58Xn.jpg?s=128&g=1", "display_name": "Plastikfan", "link": "https://stackoverflow.com/users/223936/plastikfan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4494, "favorite_count": 1, "accepted_answer_id": 29127812, "answer_count": 1, "score": 1, "last_activity_date": 1526087871, "creation_date": 1426694594, "question_id": 29126928, "link": "https://stackoverflow.com/questions/29126928/how-to-correctly-include-other-project-files-from-ruby-rakefile", "title": "How to correctly include other project files from Ruby rakefile", "body": "<p>I am having trouble including other files to use within a Rake file. For example, I have a version.rb file that contains the version number that I want to refer to inside the rake file, also, I have a gem spec, specified in a .gemspec file, which I also want to use in the rake file. I cannot determine the correct path to reference both of these files. In fact, this is the ruby issue I'm having the most problem with (require statements/LOAD_PATH) and its quite frustrating; the issue is made worse by the fact that I'm not really sure how to troubleshoot these issues). I am currently avoiding package handles such as bundler, because I need to understand the basics first.</p>\n\n<p>See the attached pic of my code editor which shows project structure (standards gems structure, for a gem called Cart,which is just a dummy app to experiment with).</p>\n\n<p><img src=\"https://i.stack.imgur.com/rYKRM.png\" alt=\"Cart project structure\"></p>\n\n<p>So, my rakefile.rb is in the root folder of the project. When specifying a require, where should the path specified be relative to? Is it relative from the file you are requiring from or relative to lib folder or whatever else? I am running rake -T, to list the tasks and these are error messages I see:</p>\n\n<p>Trying to require version.rb file from within Rakefile.rb:</p>\n\n<pre><code>require 'cart/version'\n\n$ rake -T\nrake aborted!\ncannot load such file -- lib/cart/version\n/Users/Sancho/dev/ruby/student/cart/Rakefile.rb:5:in `&lt;top (required)&gt;'\n</code></pre>\n\n<hr>\n\n<pre><code>require 'lib/cart/version'\n\n$ rake -T\nrake aborted!\ncannot load such file -- lib/cart/version\n/Users/Sancho/dev/ruby/student/cart/Rakefile.rb:5:in `&lt;top (required)&gt;'\n(See full trace by running task with --trace)\n</code></pre>\n\n<p>Trying to require cart.gemspec from within Rakefile.rb:</p>\n\n<pre><code>require 'cart.gemspec'\n\n$ rake -T\nrake aborted!\ncannot load such file -- cart.gemspec\n/Users/Sancho/dev/ruby/student/cart/Rakefile.rb:6:in `&lt;top (required)&gt;'\n(See full trace by running task with --trace)\n</code></pre>\n\n<p>I am using Ruby version 2.0.0, rake version 0.9.6 (default versions that come with OSX Mavericks).</p>\n\n<p>(PS, my intention is to buy a Ruby IDE like RubyGems, but again, I'm holding off from doing that because I want to learn the basics first, I don't want to become reliant on an IDE fixing issues for my if I don't understand how to fix them from first principles).</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "rails-activerecord"], "comments": [{"owner": {"reputation": 6602, "user_id": 3425360, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-D0hYGNyMGPo/AAAAAAAAAAI/AAAAAAAAA1c/wVJzgXu5zZI/photo.jpg?sz=128", "display_name": "Sharvy Ahmed", "link": "https://stackoverflow.com/users/3425360/sharvy-ahmed"}, "edited": false, "score": 0, "creation_date": 1426696050, "post_id": 29126855, "comment_id": 46480861, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/29071052/how-to-use-join-query-for-4-tables-in-rails\">How to use join query for 4 tables in rails</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3049, "user_id": 774437, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/6fL8U.jpg?s=128&g=1", "display_name": "moorara", "link": "https://stackoverflow.com/users/774437/moorara"}, "edited": false, "score": 0, "creation_date": 1426696879, "post_id": 29127164, "comment_id": 46481448, "body": "Good to know. Thanks for the help."}, {"owner": {"reputation": 4357, "user_id": 1986871, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/fJ2VQ.jpg?s=128&g=1", "display_name": "Chris Cirefice", "link": "https://stackoverflow.com/users/1986871/chris-cirefice"}, "edited": false, "score": 0, "creation_date": 1535091020, "post_id": 29127164, "comment_id": 90945931, "body": "That extra bit you added at the end there was a real time saver. How confusing... though I&#39;m sure there was a valid reason to design it this way."}], "tags": [], "owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "is_accepted": true, "score": 6, "last_activity_date": 1426696146, "last_edit_date": 1426696146, "creation_date": 1426695292, "answer_id": 29127164, "question_id": 29126855, "link": "https://stackoverflow.com/questions/29126855/how-to-join-an-indirect-association-in-activerecord-query-in-ruby-on-rails/29127164#29127164", "title": "How to join an indirect association in ActiveRecord query in Ruby on Rails?", "body": "<p>You can try the following:</p>\n\n<pre><code>scope :this_week, proc do\n  includes(zone: :country)\n    .where(zones: {created_at: whatever})\n    .order('countries.name ASC')\nend\n</code></pre>\n\n<p>(I used the <code>do/end</code> format on purpose to show on multi-lines each instruction)</p>\n\n<hr>\n\n<p>Also, something you should know:</p>\n\n<pre><code># if\nZone belongs_to :country\n# then\nZone.includes(:country).where(countries: { id: 12 })\n#                    ^               ^^\n# but if\nZone has_many :countries\n# then\nZone.includes(:countries).where(countries: { id: 12 })\n#                     ^^               ^^\n</code></pre>\n\n<p>The <code>where</code> always uses the table's name but <code>includes</code>/<code>joins</code> uses the relation's name as it was declared in the model.</p>\n"}], "owner": {"reputation": 3049, "user_id": 774437, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/6fL8U.jpg?s=128&g=1", "display_name": "moorara", "link": "https://stackoverflow.com/users/774437/moorara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 765, "favorite_count": 0, "accepted_answer_id": 29127164, "answer_count": 1, "score": 3, "last_activity_date": 1426696146, "creation_date": 1426694402, "last_edit_date": 1426695547, "question_id": 29126855, "link": "https://stackoverflow.com/questions/29126855/how-to-join-an-indirect-association-in-activerecord-query-in-ruby-on-rails", "title": "How to join an indirect association in ActiveRecord query in Ruby on Rails?", "body": "<p>In my Ruby on Rails application, I have a model <code>Instance</code> which belongs to another model <code>Zone</code>. The <code>Zone</code> model itself belongs to <code>Country</code> model. I am fetching a set of <code>Instance</code> objects as follows:</p>\n\n<pre><code>scope :thisweek, -&gt; { joins(:zone).where(zones: {created_at: ...}).includes(:zone)\n</code></pre>\n\n<p>I would like to join <code>Country</code> to <code>Zone</code> and <code>Instance</code> as well, and then sort the result <code>Instance</code> set based on the <code>zone.country.name</code> field. Anyone can help me please?</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1426694752, "post_id": 29126719, "comment_id": 46479941, "body": "Would it be possible for you to split the records into 2 distinct tables and then treat each type of record as a single Model? If you have another application using this database, I guess it won&#39;t be possible though..."}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1426694873, "post_id": 29126719, "comment_id": 46480044, "body": "tip for Stackoverflow: to format text of your answer into a block of code, select your text and then press Ctrl+k (or prepend each line of code with 4 blank spaces). If you want an inline piece of code, use the backticks `"}, {"owner": {"reputation": 67, "user_id": 4686023, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2a0pvMKc9zA/AAAAAAAAAAI/AAAAAAAAAi8/5vDA7l5IzVk/photo.jpg?sz=128", "display_name": "Jonathan Lamothe", "link": "https://stackoverflow.com/users/4686023/jonathan-lamothe"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1426695462, "post_id": 29126719, "comment_id": 46480468, "body": "I&#39;m afraid I can&#39;t change the DB schema.  That was my first impulse as well.  There are other services talking to it that would break."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1426697509, "post_id": 29126719, "comment_id": 46481897, "body": "What you are doing is STI (Single Table Inheritance) there are some great articles on handling this <a href=\"http://samurails.com/tutorial/single-table-inheritance-with-rails-4-part-1/\" rel=\"nofollow noreferrer\">Rails 4</a>, <a href=\"https://projectramon.wordpress.com/2014/06/04/exploring-rails-single-table-inheritance/\" rel=\"nofollow noreferrer\">Rails 3</a> but there are many more just google Single table inheritance Rails and tada but to do this correctly you may have to change DB design and then handle the issues by monkey patching for the services"}, {"owner": {"reputation": 67, "user_id": 4686023, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2a0pvMKc9zA/AAAAAAAAAAI/AAAAAAAAAi8/5vDA7l5IzVk/photo.jpg?sz=128", "display_name": "Jonathan Lamothe", "link": "https://stackoverflow.com/users/4686023/jonathan-lamothe"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1426698663, "post_id": 29126719, "comment_id": 46482603, "body": "@engineersmnky, that does look like what I&#39;m doing, but first, I can&#39;t change the database schema, and second, unless I missed something, it looks like it still wouldn&#39;t resolve the issue of creating an association between the two models."}, {"owner": {"reputation": 4602, "user_id": 1141264, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4af75d466ec6c84e3a0a9f1de61233ae?s=128&d=identicon&r=PG", "display_name": "DickieBoy", "link": "https://stackoverflow.com/users/1141264/dickieboy"}, "edited": false, "score": 0, "creation_date": 1426700963, "post_id": 29126719, "comment_id": 46484065, "body": "One thing you might want to try is: <code>self.inheritance_column = :is_type_a</code> on <code>Foo</code>. Then on your child models(assuming <code>:is_type_a</code> is a column with values like A|B). <code>def self.sti_name; &quot;A&quot;; end</code> and <code>def self.sti_name; &quot;B&quot;; end</code>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1426702478, "post_id": 29126719, "comment_id": 46485037, "body": "@JonathanLamothe there is no association between these 2 models at all other than sharing a table and Why should there be when these 2 negate each other? I know you can&#39;t change the schema but honestly in this case I feel it would be more maintainable if you did. In that case since you only have A and B. I would simple modularize the shared methods and create 2 tables. I generally only promote STI if there are at least 3 shared objects or the expectation of expanding."}], "answers": [{"tags": [], "owner": {"reputation": 3035, "user_id": 61130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89008a72cacb75012d70c97040fcc039?s=128&d=identicon&r=PG", "display_name": "John Paul Ashenfelter", "link": "https://stackoverflow.com/users/61130/john-paul-ashenfelter"}, "is_accepted": false, "score": 0, "last_activity_date": 1429109159, "creation_date": 1429109159, "answer_id": 29653387, "question_id": 29126719, "link": "https://stackoverflow.com/questions/29126719/changing-from-in-all-queries-for-an-activerecord-model/29653387#29653387", "title": "Changing FROM in all queries for an ActiveRecord model", "body": "<p>Wouldn't the ActiveRecord .from method solve your problem?</p>\n\n<p>You could also create two views (depending on mysql version) and use those for table sources but unless you <em>only</em> read from the tables, you can get into writable view issues which I would try and avoid.</p>\n"}], "owner": {"reputation": 67, "user_id": 4686023, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2a0pvMKc9zA/AAAAAAAAAAI/AAAAAAAAAi8/5vDA7l5IzVk/photo.jpg?sz=128", "display_name": "Jonathan Lamothe", "link": "https://stackoverflow.com/users/4686023/jonathan-lamothe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1429109159, "creation_date": 1426694130, "last_edit_date": 1426699348, "question_id": 29126719, "link": "https://stackoverflow.com/questions/29126719/changing-from-in-all-queries-for-an-activerecord-model", "title": "Changing FROM in all queries for an ActiveRecord model", "body": "<p>I'm working on a rails project that is connected to a third-party MySQL database <strong>that I cannot change the schema for</strong>.  So far, I've been able to shoe-horn everything into rails and make it play nice, but I've come across an interesting problem.</p>\n\n<p>I have a table, we'll call it <code>foos</code>.  I have an ActiveRecord model called <code>Foo</code> that uses this table.  The problem is that this table represents two similar but distinct types of record.  We'll call them Foo type A and Foo type B.  To get around this, I've created two classes, <code>FooTypeA</code> and <code>FooTypeB</code> that inherit from <code>Foo</code> and have default scopes so that they only contain records of their respective types.</p>\n\n<p>My code looks something like this:</p>\n\n<pre><code>class Foo &lt; ActiveRecord::Base\n  # methods common to both types\nend\n\nclass FooTypeA &lt; Foo\n  default_scope -&gt; { where is_type_a: true }\n  # methods for type A\nend\n\nclass FooTypeB &lt; Foo\n  default_scope -&gt; { where is_type_a: false }\n  # methods for type B\nend\n</code></pre>\n\n<p>For the most part, this works pretty well, except for the fact that sometimes an association chain joins over both of these models.  Since they come from the same table, this causes ambiguity problems, and generates exploding SQL queries.  I've been writing custom join queries to get around this, but it's quickly becoming cumbersome.</p>\n\n<p>I know I can change the default table name for a model with the <code>self.table_name</code> value, but is there a way that I can tell rails to change the FROM portion of the SQL query for a model so that I can make all queries from FooTypeA read as: <code>SELECT foo_as.* FROM foos AS foo_as ...</code></p>\n\n<p>I'm open to other suggestions, but this seems like the easiest solution if it's possible.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "dynamic"], "comments": [{"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1426694154, "post_id": 29126567, "comment_id": 46479491, "body": "Replace <code>interval communities.sms_defaulting_days + &#39; days&#39;</code> as <code>&#39;#{communities.sms_defaulting_days} days&#39;::INTERVAL</code> .. and let me know."}, {"owner": {"reputation": 1356, "user_id": 1175943, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7a3218043040195cb524c5988d8c06d5?s=128&d=identicon&r=PG", "display_name": "sebkkom", "link": "https://stackoverflow.com/users/1175943/sebkkom"}, "edited": false, "score": 0, "creation_date": 1426694332, "post_id": 29126567, "comment_id": 46479627, "body": "Is <code>.where(&quot;payments.expiration_date = DATE_ADD(#{current_date}, INTERVAL #{interval})&quot;)</code> any closer to what you are trying to achieve?"}, {"owner": {"reputation": 1438, "user_id": 2417756, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/hnmhE.png?s=128&g=1", "display_name": "Waclock", "link": "https://stackoverflow.com/users/2417756/waclock"}, "reply_to_user": {"reputation": 1356, "user_id": 1175943, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7a3218043040195cb524c5988d8c06d5?s=128&d=identicon&r=PG", "display_name": "sebkkom", "link": "https://stackoverflow.com/users/1175943/sebkkom"}, "edited": false, "score": 0, "creation_date": 1426694474, "post_id": 29126567, "comment_id": 46479744, "body": "@sebkomianos what would interval be in this case? I need to extract the date depending on the property&#39;s community"}, {"owner": {"reputation": 1356, "user_id": 1175943, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7a3218043040195cb524c5988d8c06d5?s=128&d=identicon&r=PG", "display_name": "sebkkom", "link": "https://stackoverflow.com/users/1175943/sebkkom"}, "edited": false, "score": 0, "creation_date": 1426694765, "post_id": 29126567, "comment_id": 46479948, "body": "@Waclock In order to fix the syntax error your initial query should be <code>&quot;payments.expiration_date = current_date + communities.sms_defaulting_days + &#39; days&#39;&quot;</code> (take the <code>interval</code> part off)"}, {"owner": {"reputation": 1438, "user_id": 2417756, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/hnmhE.png?s=128&g=1", "display_name": "Waclock", "link": "https://stackoverflow.com/users/2417756/waclock"}, "reply_to_user": {"reputation": 1356, "user_id": 1175943, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7a3218043040195cb524c5988d8c06d5?s=128&d=identicon&r=PG", "display_name": "sebkkom", "link": "https://stackoverflow.com/users/1175943/sebkkom"}, "edited": false, "score": 0, "creation_date": 1426694882, "post_id": 29126567, "comment_id": 46480049, "body": "@sebkomianos I get the following error if I remove interval:     ActiveRecord::StatementInvalid: PG::AmbiguousFunction: ERROR:  operator is not unique: date + unknown"}], "answers": [{"comments": [{"owner": {"reputation": 1438, "user_id": 2417756, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/hnmhE.png?s=128&g=1", "display_name": "Waclock", "link": "https://stackoverflow.com/users/2417756/waclock"}, "edited": false, "score": 0, "creation_date": 1426694481, "post_id": 29126837, "comment_id": 46479750, "body": "I get &quot;undefined local variable or method &#39;communities&#39;&quot; which is probably because communities is not a ruby variable."}, {"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "reply_to_user": {"reputation": 1438, "user_id": 2417756, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/hnmhE.png?s=128&g=1", "display_name": "Waclock", "link": "https://stackoverflow.com/users/2417756/waclock"}, "edited": false, "score": 0, "creation_date": 1426694617, "post_id": 29126837, "comment_id": 46479851, "body": "@Waclock I am sure you have a db table <code>communities</code> right ?"}, {"owner": {"reputation": 1438, "user_id": 2417756, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/hnmhE.png?s=128&g=1", "display_name": "Waclock", "link": "https://stackoverflow.com/users/2417756/waclock"}, "edited": false, "score": 0, "creation_date": 1426694644, "post_id": 29126837, "comment_id": 46479876, "body": "Yes, each property has a community_id (belongs_to :community)"}, {"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "reply_to_user": {"reputation": 1438, "user_id": 2417756, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/hnmhE.png?s=128&g=1", "display_name": "Waclock", "link": "https://stackoverflow.com/users/2417756/waclock"}, "edited": false, "score": 0, "creation_date": 1426695221, "post_id": 29126837, "comment_id": 46480282, "body": "@Waclock Please try now"}, {"owner": {"reputation": 1438, "user_id": 2417756, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/hnmhE.png?s=128&g=1", "display_name": "Waclock", "link": "https://stackoverflow.com/users/2417756/waclock"}, "edited": false, "score": 0, "creation_date": 1426695355, "post_id": 29126837, "comment_id": 46480388, "body": "I tried again and got the error:   <code>PG::InvalidDatetimeFormat: ERROR:  invalid input syntax for type interval: &quot; days&quot;</code>"}], "tags": [], "owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "is_accepted": true, "score": 0, "last_activity_date": 1426695204, "last_edit_date": 1426695204, "creation_date": 1426694368, "answer_id": 29126837, "question_id": 29126567, "link": "https://stackoverflow.com/questions/29126567/dynamic-number-of-days-to-date/29126837#29126837", "title": "Dynamic number of days to date", "body": "<p>Try to write the code as :</p>\n\n<pre><code>Property.joins(:community)\n        .joins(:payments)\n        .where(\"payments.expiration_date = current_date + (communities.sms_defaulting_days || ' days')::interval\")\n</code></pre>\n"}], "owner": {"reputation": 1438, "user_id": 2417756, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/hnmhE.png?s=128&g=1", "display_name": "Waclock", "link": "https://stackoverflow.com/users/2417756/waclock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 1, "accepted_answer_id": 29126837, "answer_count": 1, "score": 0, "last_activity_date": 1426695204, "creation_date": 1426693746, "question_id": 29126567, "link": "https://stackoverflow.com/questions/29126567/dynamic-number-of-days-to-date", "title": "Dynamic number of days to date", "body": "<p>I'm trying to get to work a query where I need all the properties, whose payments expired in X number of days. X is defined by the property's community, what I have right now is the following:</p>\n\n<pre><code>Property.joins(:community).joins(:payments).where(\"payments.expiration_date = current_date + interval communities.sms_defaulting_days + ' days'\")\n</code></pre>\n\n<p>Which is not working, as it does not recognize communities (I believe it's a parsing issue), the error I get is: </p>\n\n<pre><code>PG::SyntaxError: ERROR:  syntax error at or near \"communities\"\n</code></pre>\n\n<p>which makes sense to me.</p>\n\n<p>What I'm trying to achieve is that the last part of the query should look like this:</p>\n\n<pre><code>payments.expiration_date = current_date + interval '2 days'\n</code></pre>\n\n<p>And I'd get the 2 from \"community.sms_defaulting_days\"</p>\n\n<p>Another way to think about it is \"expiration_date = 2.days.from_now\", but I still have the same problem, as I do not know how to make it work dynamically.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1426693261, "post_id": 29126074, "comment_id": 46478823, "body": "<code>before_action  :set_user_study,...</code> inside a controller right...?"}, {"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1426693606, "post_id": 29126074, "comment_id": 46479087, "body": "show the <code>edit</code> action inside the controller.."}, {"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1426693897, "post_id": 29126074, "comment_id": 46479288, "body": "Ok.. Then from where you are setting this <code>@user</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 4397, "user_id": 1945948, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5ecf1cdd8eed500e1e1df86d036b69a7?s=128&d=identicon&r=PG&f=1", "display_name": "atw", "link": "https://stackoverflow.com/users/1945948/atw"}, "edited": false, "score": 0, "creation_date": 1426694653, "post_id": 29126628, "comment_id": 46479883, "body": "Do you have a link to querying out the values documentation?"}, {"owner": {"reputation": 1243, "user_id": 1891599, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a1beeb83f38d8dc7c1499b686161613?s=128&d=identicon&r=PG", "display_name": "AshwinKumarS", "link": "https://stackoverflow.com/users/1891599/ashwinkumars"}, "reply_to_user": {"reputation": 4397, "user_id": 1945948, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5ecf1cdd8eed500e1e1df86d036b69a7?s=128&d=identicon&r=PG&f=1", "display_name": "atw", "link": "https://stackoverflow.com/users/1945948/atw"}, "edited": false, "score": 0, "creation_date": 1426699256, "post_id": 29126628, "comment_id": 46483026, "body": "No i mean just do UserStudy.where(user_id: @user.id) in the private method. This would give you all the user_studies."}, {"owner": {"reputation": 4397, "user_id": 1945948, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5ecf1cdd8eed500e1e1df86d036b69a7?s=128&d=identicon&r=PG&f=1", "display_name": "atw", "link": "https://stackoverflow.com/users/1945948/atw"}, "edited": false, "score": 0, "creation_date": 1426754535, "post_id": 29126628, "comment_id": 46504013, "body": "I think that is working good so far, Thanks, I will get back to you."}, {"owner": {"reputation": 1243, "user_id": 1891599, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a1beeb83f38d8dc7c1499b686161613?s=128&d=identicon&r=PG", "display_name": "AshwinKumarS", "link": "https://stackoverflow.com/users/1891599/ashwinkumars"}, "reply_to_user": {"reputation": 4397, "user_id": 1945948, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5ecf1cdd8eed500e1e1df86d036b69a7?s=128&d=identicon&r=PG&f=1", "display_name": "atw", "link": "https://stackoverflow.com/users/1945948/atw"}, "edited": false, "score": 0, "creation_date": 1426754864, "post_id": 29126628, "comment_id": 46504185, "body": "you mean the conditional one you had or the one i suggested above ?"}, {"owner": {"reputation": 4397, "user_id": 1945948, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5ecf1cdd8eed500e1e1df86d036b69a7?s=128&d=identicon&r=PG&f=1", "display_name": "atw", "link": "https://stackoverflow.com/users/1945948/atw"}, "edited": false, "score": 0, "creation_date": 1426755160, "post_id": 29126628, "comment_id": 46504334, "body": "The one you suggested above &#39;UserStudy.where(user_id: @user.id)&#39;, but I am still playing around with it."}, {"owner": {"reputation": 4397, "user_id": 1945948, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5ecf1cdd8eed500e1e1df86d036b69a7?s=128&d=identicon&r=PG&f=1", "display_name": "atw", "link": "https://stackoverflow.com/users/1945948/atw"}, "edited": false, "score": 0, "creation_date": 1426759551, "post_id": 29126628, "comment_id": 46506806, "body": "The answer you gave in the comments is good but I don&#39;t know if it is the best solution or not. If you edit your answer to reflect the comment you made, I will give you points but I won&#39;t be accepting any answers just yet, I want to keep it open for another while."}, {"owner": {"reputation": 1243, "user_id": 1891599, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a1beeb83f38d8dc7c1499b686161613?s=128&d=identicon&r=PG", "display_name": "AshwinKumarS", "link": "https://stackoverflow.com/users/1891599/ashwinkumars"}, "reply_to_user": {"reputation": 4397, "user_id": 1945948, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5ecf1cdd8eed500e1e1df86d036b69a7?s=128&d=identicon&r=PG&f=1", "display_name": "atw", "link": "https://stackoverflow.com/users/1945948/atw"}, "edited": false, "score": 0, "creation_date": 1426832596, "post_id": 29126628, "comment_id": 46540831, "body": "@adrianmann Yes. This will just get the job done. Will try to think more about this. Edited the answer anyways."}], "tags": [], "owner": {"reputation": 1243, "user_id": 1891599, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a1beeb83f38d8dc7c1499b686161613?s=128&d=identicon&r=PG", "display_name": "AshwinKumarS", "link": "https://stackoverflow.com/users/1891599/ashwinkumars"}, "is_accepted": true, "score": 1, "last_activity_date": 1426832561, "last_edit_date": 1426832561, "creation_date": 1426693923, "answer_id": 29126628, "question_id": 29126074, "link": "https://stackoverflow.com/questions/29126074/override-model-association-conditional-for-particular-functionality/29126628#29126628", "title": "Override model association conditional for particular functionality", "body": "<p>If your aim is to just override the association, don't use <code>@user.user_studies</code> . Instead, query out the values and use <code>UserStudy.where(user_id: @user.id)</code> in the private method. However, if the usage of <code>user_studies</code> is less in existing code, then just remove the condition in association and chain scopes to add this condition.</p>\n"}], "owner": {"reputation": 4397, "user_id": 1945948, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5ecf1cdd8eed500e1e1df86d036b69a7?s=128&d=identicon&r=PG&f=1", "display_name": "atw", "link": "https://stackoverflow.com/users/1945948/atw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 29126628, "answer_count": 1, "score": 0, "last_activity_date": 1426832561, "creation_date": 1426692493, "last_edit_date": 1426693985, "question_id": 29126074, "link": "https://stackoverflow.com/questions/29126074/override-model-association-conditional-for-particular-functionality", "title": "Override model association conditional for particular functionality", "body": "<p>I have a User model that will return user studies that have a status of true:</p>\n\n<pre><code>has_many :user_studies, -&gt; { where(status: true) }, dependent: :destroy\n</code></pre>\n\n<p>I am using this for over 80% of my functionality but there are some instances where I want to override this line of code.</p>\n\n<p>I have a private method in the User controller that does the work of getting a user study:</p>\n\n<pre><code>def set_user_study\n  @user_study = @user.user_studies.find(params[:id])\nend\n</code></pre>\n\n<p>@user is set in another private method:</p>\n\n<pre><code>def set_user\n  @user = users_api.find_by_guid(params[:user_id])\nrescue Longboat::Api::Users::NotFound =&gt; e\n  logger.error e.message\n  raise ActionController::RoutingError.new('Not Found')\nend\n</code></pre>\n\n<p>The private method is called when I try to edit a user_study(among others):</p>\n\n<pre><code>before_action :set_user_study, only: [:edit, :update, :destroy]\n</code></pre>\n\n<p>I am getting the following error(obviously) when trying to edit a study that does not have a status of true: </p>\n\n<pre><code>Couldn't find UserStudy with 'id'=1 [WHERE \"user_studies\".\"user_id\" = ? AND \"user_studies\".\"status\" = 't']\n</code></pre>\n\n<p>How can I continue to call the private method but allow a user to be able to edit  a user study whether the status is true or not?</p>\n"}, {"tags": ["ruby", "csv"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1426693265, "post_id": 29126068, "comment_id": 46478828, "body": "<code>CSV#&lt;&lt;</code> expects a single row."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 2969449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5458566635d6ee0856d66fc1f8d04192?s=128&d=identicon&r=PG", "display_name": "dsp", "link": "https://stackoverflow.com/users/2969449/dsp"}, "edited": false, "score": 0, "creation_date": 1426696443, "post_id": 29127236, "comment_id": 46481152, "body": "Perfect! Thanks, Stefan."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 1, "last_activity_date": 1426695478, "creation_date": 1426695478, "answer_id": 29127236, "question_id": 29126068, "link": "https://stackoverflow.com/questions/29126068/add-new-column-to-each-row-of-a-csv-in-ruby/29127236#29127236", "title": "Add new column to each row of a .csv in ruby", "body": "<p><a href=\"http://ruby-doc.org/stdlib-2.2.1/libdoc/csv/rdoc/CSV.html#method-i-3C-3C\" rel=\"nofollow\"><code>CSV#&lt;&lt;</code></a> expects a single row:</p>\n\n<pre><code>CSV.generate { |csv| csv &lt;&lt; [1, 2, 3] }\n#=&gt; \"1,2,3\\n\"\n\nCSV.generate { |csv| csv &lt;&lt; [1, 2, 3] &lt;&lt; [4, 5, 6] }\n#=&gt; \"1,2,3\\n4,5,6\\n\"\n</code></pre>\n\n<p>but you're passing a two-dimenional array (which doesn't work as expected):</p>\n\n<pre><code>CSV.generate { |csv| csv &lt;&lt; [[1, 2, 3], [4, 5, 6]] }\n#=&gt; \"\\\"[1, 2, 3]\\\",\\\"[4, 5, 6]\\\"\\n\"\n</code></pre>\n\n<p>So instead of:</p>\n\n<pre><code>old_csv &lt;&lt; csv_info\n</code></pre>\n\n<p>you need something like:</p>\n\n<pre><code>csv_info.each do |info|\n  old_csv &lt;&lt; info\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1426699561, "post_id": 29127469, "comment_id": 46483220, "body": "Processing using <a href=\"http://stackoverflow.com/q/25189262/128421\">line-by-line is as fast as slurping the entire file, and is not prone to scalability issues</a>. But, opening the file using <code>CSV.open</code> and assigning it to a temporary variable isn&#39;t the Ruby way. Use a block so Ruby will automatically close the output file when the block exits. So, +1 for the use of line-by-line IO and -1 for not using a block. Using a temp file is nice, but not necessary, just write to a new file and then <code>mv</code> it."}, {"owner": {"reputation": 10091, "user_id": 4625365, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/l6v41.jpg?s=128&g=1", "display_name": "Matt Brictson", "link": "https://stackoverflow.com/users/4625365/matt-brictson"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1426702360, "post_id": 29127469, "comment_id": 46484962, "body": "@theTinMan great feedback, thanks. I switched to block style for <code>CSV.open</code>. Not sure how I overlooked that!"}], "tags": [], "owner": {"reputation": 10091, "user_id": 4625365, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/l6v41.jpg?s=128&g=1", "display_name": "Matt Brictson", "link": "https://stackoverflow.com/users/4625365/matt-brictson"}, "is_accepted": false, "score": 4, "last_activity_date": 1426702322, "last_edit_date": 1426702322, "creation_date": 1426696109, "answer_id": 29127469, "question_id": 29126068, "link": "https://stackoverflow.com/questions/29126068/add-new-column-to-each-row-of-a-csv-in-ruby/29127469#29127469", "title": "Add new column to each row of a .csv in ruby", "body": "<p>In your example you are reading the entire CSV and manipulating it in memory. Instead, I would suggest reading and modifying one row at a time, especially if the CSV file is large.</p>\n\n<p>Here is how you could do the modification row-by-row to a temp file, then replace the original file with the temp file that was generated.</p>\n\n<pre><code>require \"csv\"\nrequire \"fileutils\"\nrequire \"tempfile\"\n\ntemp = Tempfile.new(\"csv\")\n\nCSV.open(temp, \"w\") do |temp_csv|\n  CSV.foreach(\"foo.csv\") do |orig|\n    temp_csv &lt;&lt; orig + [\"new_object\"]\n  end\nend\n\nFileUtils.mv(temp, \"foo.csv\", :force =&gt; true)\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 2969449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5458566635d6ee0856d66fc1f8d04192?s=128&d=identicon&r=PG", "display_name": "dsp", "link": "https://stackoverflow.com/users/2969449/dsp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3176, "favorite_count": 0, "accepted_answer_id": 29127236, "answer_count": 2, "score": 1, "last_activity_date": 1426702322, "creation_date": 1426692484, "last_edit_date": 1426693033, "question_id": 29126068, "link": "https://stackoverflow.com/questions/29126068/add-new-column-to-each-row-of-a-csv-in-ruby", "title": "Add new column to each row of a .csv in ruby", "body": "<p>I'm attempting to append a new column to each row of an existing csv file. The following code executes what I want:</p>\n\n<pre><code>csv_info = CSV.read(\"foo.csv\")\ncsv_info.each do |info|\n  info &lt;&lt; new_object\nend\n</code></pre>\n\n<p>giving me the following in memory when I use <code>pry</code>:</p>\n\n<pre><code>[[uuid0, account0, url0, new_object],\n [uuid1, account1, url1, new_object]]\n</code></pre>\n\n<p>This doesn't write to file since it's a <code>CSV.read</code> instead of a <code>CSV.open(\"foo.csv\",\"w\")</code>. When I attempt to write over the file with the <code>csv_info</code> object:</p>\n\n<pre><code>csv_info = CSV.read(\"foo.csv\")\ncsv_info.each do |info|\n  info &lt;&lt; new_object\nend\nCSV.open(\"foo.csv\", \"w\") do |old_csv|\n  old_csv &lt;&lt; csv_info\nend\n</code></pre>\n\n<p>The file ends up as such:</p>\n\n<pre><code>[[\"[\\\"&lt;uuid0&gt;\\\", \\\"&lt;account0&gt;\\\", \\\"&lt;url0&gt;\\\", \\\"&lt;new_object&gt;\\\"]\",\n   \"[\\\"&lt;uuid1&gt;\\\", \\\"&lt;account1&gt;\\\", \\\"&lt;url1&gt;\\\", \\\"&lt;new_object&gt;\\\"]\"]]\n</code></pre>\n\n<p>How can I append without impacting the csv formatting?</p>\n"}, {"tags": ["jquery", "ruby-on-rails", "ruby", "ajax"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 4627835, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/450a89e36f6303995523035da727856b?s=128&d=identicon&r=PG&f=1", "display_name": "Mais", "link": "https://stackoverflow.com/users/4627835/mais"}, "edited": false, "score": 0, "creation_date": 1426694877, "post_id": 29126327, "comment_id": 46480047, "body": "Hi, I already have pagination with ajax in place and this seems to be interfering with it, by &quot;select.your-select&quot; do you mean I have to put there what the user selected? I assume something must be added to the collection_select ?"}, {"owner": {"reputation": 590, "user_id": 2297917, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/hH5oA.jpg?s=128&g=1", "display_name": "nick", "link": "https://stackoverflow.com/users/2297917/nick"}, "reply_to_user": {"reputation": 29, "user_id": 4627835, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/450a89e36f6303995523035da727856b?s=128&d=identicon&r=PG&f=1", "display_name": "Mais", "link": "https://stackoverflow.com/users/4627835/mais"}, "edited": false, "score": 0, "creation_date": 1426695983, "post_id": 29126327, "comment_id": 46480811, "body": "That&#39;s a jQuery selector to get the select. You need someway of targeting that select element. In your erb, add an html class or id to it by that. So, $(&#39;#id-of-element&#39;) or $(&#39;.class-of-element&#39;)"}, {"owner": {"reputation": 29, "user_id": 4627835, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/450a89e36f6303995523035da727856b?s=128&d=identicon&r=PG&f=1", "display_name": "Mais", "link": "https://stackoverflow.com/users/4627835/mais"}, "edited": false, "score": 0, "creation_date": 1426696491, "post_id": 29126327, "comment_id": 46481187, "body": "Ah I see I already have that as &lt;div class=&quot;filter&quot;&gt;, my problem remains is that how would the ajax call know what manager_id it was the user selected and send it to the index page to filter it accordingly."}, {"owner": {"reputation": 590, "user_id": 2297917, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/hH5oA.jpg?s=128&g=1", "display_name": "nick", "link": "https://stackoverflow.com/users/2297917/nick"}, "reply_to_user": {"reputation": 29, "user_id": 4627835, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/450a89e36f6303995523035da727856b?s=128&d=identicon&r=PG&f=1", "display_name": "Mais", "link": "https://stackoverflow.com/users/4627835/mais"}, "edited": false, "score": 0, "creation_date": 1426698013, "post_id": 29126327, "comment_id": 46482220, "body": "Ah yes, take a look at jQuery&#39;s docs on sending data: <a href=\"http://api.jquery.com/jquery.ajax/\" rel=\"nofollow noreferrer\">api.jquery.com/jquery.ajax</a>. Basically, you&#39;ll simply add the value of that select to the request. It&#39;s just as if you&#39;re submitting a form."}], "tags": [], "owner": {"reputation": 590, "user_id": 2297917, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/hH5oA.jpg?s=128&g=1", "display_name": "nick", "link": "https://stackoverflow.com/users/2297917/nick"}, "is_accepted": true, "score": 0, "last_activity_date": 1426693114, "creation_date": 1426693114, "answer_id": 29126327, "question_id": 29125982, "link": "https://stackoverflow.com/questions/29125982/ruby-on-rails-collection-select-with-ajax-filtering-the-index-page/29126327#29126327", "title": "Ruby On Rails: collection_select with ajax filtering the index page", "body": "<p>You need to trigger an event for that to happen. The document ready is only firing once. Attach an event handler to your select element, and make an Ajax call to get the new data once the change is fired.</p>\n\n<pre><code>$('select.your-select').change(function() {\n  $.ajax({\n     url: '...',\n     success: function(response) {\n       // Take this new data and update the page\n       $('.sort_paginate_ajax').html(response);\n     }\n  });\n});\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 4627835, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/450a89e36f6303995523035da727856b?s=128&d=identicon&r=PG&f=1", "display_name": "Mais", "link": "https://stackoverflow.com/users/4627835/mais"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 685, "favorite_count": 0, "accepted_answer_id": 29126327, "answer_count": 1, "score": 0, "last_activity_date": 1426693114, "creation_date": 1426692234, "last_edit_date": 1426693013, "question_id": 29125982, "link": "https://stackoverflow.com/questions/29125982/ruby-on-rails-collection-select-with-ajax-filtering-the-index-page", "title": "Ruby On Rails: collection_select with ajax filtering the index page", "body": "<p>I'm trying to introduce a <code>collection_select</code> into my Projects index page that would filter out the projects to only display the projects managed by a certain user.</p>\n\n<pre><code>#projects model\nclass Project &lt; ActiveRecord::Base\nbelongs_to :manager_user, class_name: 'User', foreign_key: 'manager_id'\nend\n\n#users model\nclass User &lt; ActiveRecord::Base \nhas_many :managed_projects, class_name: 'Projects', foreign_key: 'manager_id'\nend\n\n#index method in projects_controller\ndef index \n   if params[:user]\n      @projects = Project.order(created_at: :desc).where(manager_id: params[:user]).paginate(page: params[:page], per_page: 5)   \n   else\n      @projects = Project.order(created_at: :desc).paginate(page: params[:page], per_page: 5)\n   end\n\n   respond_to do |format|\n   format.html \n   format.js \n   end\n  end\n\n#projects index view\nh1&gt;Projects&lt;/h1&gt;\n&lt;div class=\"filter\"&gt;\n    &lt;%= label :manager_id, \"Manager\" %&gt;&lt;br&gt;\n    &lt;%= collection_select :project, :manager_id, User.all, :id, :username %&gt;\n&lt;/div&gt; \n&lt;div class=\"sort_paginate_ajax\"&gt;\n&lt;%= render 'projects' %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>The partial projects contains the table listing the projects.</p>\n\n<pre><code>#index.js\n$(document).ready(function(){\n\n$('.sort_paginate_ajax').html(\"&lt;%= escape_javascript(render (\"projects\")) %&gt;\")\n$(\"#notice\").fadeOut(1000);\n\n});\n</code></pre>\n\n<p>How can I accept what the user selects from the collection and re render the projects partial based on that selection to display projects for that manager?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 8946, "user_id": 2398521, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/84bb49c56756a8c7cd54d4876d7a4467?s=128&d=identicon&r=PG", "display_name": "Maxim", "link": "https://stackoverflow.com/users/2398521/maxim"}, "is_accepted": true, "score": 0, "last_activity_date": 1426693029, "creation_date": 1426693029, "answer_id": 29126291, "question_id": 29124663, "link": "https://stackoverflow.com/questions/29124663/accessing-two-different-rails-environments-from-a-single-ruby-script/29126291#29126291", "title": "Accessing two different Rails environments from a single Ruby script", "body": "<ol>\n<li><p>You can specify Ruby version in <code>.ruby-version</code> <a href=\"https://rvm.io/workflow/projects\" rel=\"nofollow\">file</a> inside of root directory of your projects if you are using RVM or rbenv.</p></li>\n<li><p>You can specify Rails environment use <code>RAILS_ENV</code> environment variable i.e. <code>RAILS_ENV=production bin/rails runner ...</code></p></li>\n</ol>\n\n<p>I hope it can help to solve your problems.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4442960"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 29126291, "answer_count": 1, "score": 1, "last_activity_date": 1426693029, "creation_date": 1426688671, "question_id": 29124663, "link": "https://stackoverflow.com/questions/29124663/accessing-two-different-rails-environments-from-a-single-ruby-script", "title": "Accessing two different Rails environments from a single Ruby script", "body": "<p>I'm trying to write a Rake task that will retrieve data stored in the databases of two different Rails apps, with different Ruby and gem versions. What I have so far is</p>\n\n<pre><code>task :get_data do                                                                                                                                                            \n  puts `/&lt;path&gt;/&lt;to&gt;/&lt;first&gt;/&lt;app&gt;/bin/rails runner 'FirstDataRetriever.new.as_set'`\n  puts `/&lt;path&gt;/&lt;to&gt;/&lt;second&gt;/&lt;app&gt;/bin/rails runner 'SecondDataRetriever.new.as_set'`                                                              \nend\n</code></pre>\n\n<p>The problem is that Rails runner is trying to execute the <code>DataRetriever</code> classes using the Ruby version of the Rakefile, which is in a separate repo using different infrastructure.</p>\n\n<p>Both the <code>DataRetriever</code> classes make use of <code>ActiveRecord</code> models in each app, so they must be run in the Rails environment of each app, but I'm not sure how to go about this.</p>\n"}, {"tags": ["ruby", "cucumber", "bdd"], "comments": [{"owner": {"reputation": 3129, "user_id": 227397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVdnG.jpg?s=128&g=1", "display_name": "Jeff Price", "link": "https://stackoverflow.com/users/227397/jeff-price"}, "edited": false, "score": 0, "creation_date": 1426688999, "post_id": 29124466, "comment_id": 46475616, "body": "What output are you getting, and what were you expecting?"}, {"owner": {"reputation": 91, "user_id": 4507996, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d6137e77979117d3625fd962fab671c8?s=128&d=identicon&r=PG&f=1", "display_name": "Nabsta", "link": "https://stackoverflow.com/users/4507996/nabsta"}, "reply_to_user": {"reputation": 3129, "user_id": 227397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVdnG.jpg?s=128&g=1", "display_name": "Jeff Price", "link": "https://stackoverflow.com/users/227397/jeff-price"}, "edited": false, "score": 0, "creation_date": 1426689703, "post_id": 29124466, "comment_id": 46476133, "body": "I get 1 failed scenario, 1 failed test, 1 skipped test, &amp; the first test passes...The second test should pass according to the book....I think the third should as well, but the third will fail if the second fails.  I think the output is supposed to be testing the empty calc.rb file which is also in the same directory as the calculator_steps.rb file.  I know the book never mentions anything about that error."}, {"owner": {"reputation": 91, "user_id": 4507996, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d6137e77979117d3625fd962fab671c8?s=128&d=identicon&r=PG&f=1", "display_name": "Nabsta", "link": "https://stackoverflow.com/users/4507996/nabsta"}, "reply_to_user": {"reputation": 3129, "user_id": 227397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVdnG.jpg?s=128&g=1", "display_name": "Jeff Price", "link": "https://stackoverflow.com/users/227397/jeff-price"}, "edited": false, "score": 0, "creation_date": 1426689768, "post_id": 29124466, "comment_id": 46476192, "body": "Something is going wrong with one or both of the lines:  @output = <code>ruby calc.rb #{@input}</code>   raise(&#39;Command failed!&#39;) unless $?.success?"}, {"owner": {"reputation": 3129, "user_id": 227397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVdnG.jpg?s=128&g=1", "display_name": "Jeff Price", "link": "https://stackoverflow.com/users/227397/jeff-price"}, "edited": false, "score": 0, "creation_date": 1426691290, "post_id": 29124466, "comment_id": 46477302, "body": "could you show us the actual output? &quot;something is going wrong&quot; is not helpful."}, {"owner": {"reputation": 91, "user_id": 4507996, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d6137e77979117d3625fd962fab671c8?s=128&d=identicon&r=PG&f=1", "display_name": "Nabsta", "link": "https://stackoverflow.com/users/4507996/nabsta"}, "reply_to_user": {"reputation": 3129, "user_id": 227397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVdnG.jpg?s=128&g=1", "display_name": "Jeff Price", "link": "https://stackoverflow.com/users/227397/jeff-price"}, "edited": false, "score": 0, "creation_date": 1426691599, "post_id": 29124466, "comment_id": 46477551, "body": "Command failed! &lt;RuntimeError&gt; ./features/step_definitions/calculator_steps.rb:15 in &#39;/^the calculator is run$/ features\\adding.features:5:in &#39;When the calculator is run&#39; Failing Scenarios: cucumber features\\adding.feature: 3 #Scenario: Add two numbers  is the output 1 failed scenario, 1 failed, 1 skipped, &amp; 1passed"}], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 4507996, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d6137e77979117d3625fd962fab671c8?s=128&d=identicon&r=PG&f=1", "display_name": "Nabsta", "link": "https://stackoverflow.com/users/4507996/nabsta"}, "is_accepted": false, "score": 0, "last_activity_date": 1426697393, "creation_date": 1426697393, "answer_id": 29127954, "question_id": 29124466, "link": "https://stackoverflow.com/questions/29124466/cucumber-features-step-definitions-calculator-steps-rb15-in-the-calculator/29127954#29127954", "title": "Cucumber ./features/step_definitions/calculator_steps.rb:15 in &#39;/^the calculator is run$/", "body": "<p>Thanks for the help.  I figured the problem out.  calc.rb needed to be in the root directory which was above features and I was putting it in the step_definitions :P.</p>\n"}], "owner": {"reputation": 91, "user_id": 4507996, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d6137e77979117d3625fd962fab671c8?s=128&d=identicon&r=PG&f=1", "display_name": "Nabsta", "link": "https://stackoverflow.com/users/4507996/nabsta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 425, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426697393, "creation_date": 1426688195, "question_id": 29124466, "link": "https://stackoverflow.com/questions/29124466/cucumber-features-step-definitions-calculator-steps-rb15-in-the-calculator", "title": "Cucumber ./features/step_definitions/calculator_steps.rb:15 in &#39;/^the calculator is run$/", "body": "<p>I want to make it clear this problem is not about backticks.  I am new to Cucumber and am trying to run the code from second chapter of The Cucumber Book: Behavior-Driven Development for Testers and Developers.  I am using Cucumber 1.3.19 with ruby 1.9.3p551 in Windows 7 with Ansicon x64 1.60.  Cucumber works fine with other code I have received from others, so the configuration is good.  I have read several posts about problems with this tutorial in regards to the backticks already; however, I have copied the code directly from the Cucumber Book website with the correct backticks (not single quotes) and am still getting the error.  </p>\n\n<pre><code>Command failed! &lt;RuntimeError&gt;\n./features/step_definitions/calculator_steps.rb:15 in '/^the calculator is run$/\nfeatures\\adding.features:5:in 'When the calculator is run'\nFailing Scenarios:\ncucumber features\\adding.feature: 3\n</code></pre>\n\n<p>My code for adding.feature looks like </p>\n\n<p>Feature: Adding</p>\n\n<pre><code>  Scenario: Add two numbers\n    Given the input \"2+2\"\n    When the calculator is run\n    Then the output should be \"4\"\n</code></pre>\n\n<p>My code for the features/step_definitions/calculator_steps.rb looks like:</p>\n\n<pre><code>Given /^the input \"([^\"]*)\"$/ do |input|\n  @input = input\nend\n\nWhen /^the calculator is run$/ do\n  @output = `ruby calc.rb #{@input}`\n  raise('Command failed!') unless $?.success?\nend\n\nThen /^the output should be \"([^\"]*)\"$/ do |expected_output|\n  @output.should == expected_output\nend\n</code></pre>\n\n<p>Is there something with the newer version of Cucumber that could render this code bad?</p>\n"}, {"tags": ["ruby", "string", "literals"], "comments": [{"owner": {"reputation": 10654, "user_id": 849843, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/WJU9S.png?s=128&g=1", "display_name": "ediblecode", "link": "https://stackoverflow.com/users/849843/ediblecode"}, "edited": false, "score": 1, "creation_date": 1426687271, "post_id": 29124058, "comment_id": 46474347, "body": "You will need use `\\` to prepend, there is no equivalent in Rails"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1426687874, "post_id": 29124058, "comment_id": 46474802, "body": "Not clear what you want. A single-quoted string literal in Ruby still requires backslashes to be escaped."}], "answers": [{"comments": [{"owner": {"reputation": 5869, "user_id": 2543666, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/4e7c6887ce958029525412ab297b5895?s=128&d=identicon&r=PG", "display_name": "Thayne", "link": "https://stackoverflow.com/users/2543666/thayne"}, "edited": false, "score": 0, "creation_date": 1606259678, "post_id": 29124286, "comment_id": 114909423, "body": "Is there any way to avoid having to escape the backslash?"}], "tags": [], "owner": {"reputation": 3840, "user_id": 1054638, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/39071d37bc0d2ca9954bf865e7ce0167?s=128&d=identicon&r=PG", "display_name": "Harsh Gupta", "link": "https://stackoverflow.com/users/1054638/harsh-gupta"}, "is_accepted": true, "score": 8, "last_activity_date": 1426687721, "creation_date": 1426687721, "answer_id": 29124286, "question_id": 29124058, "link": "https://stackoverflow.com/questions/29124058/string-literal-without-need-to-escape-backslash/29124286#29124286", "title": "String literal without need to escape backslash", "body": "<p>There is somewhat similar thing available in Ruby. E.g.</p>\n\n<pre><code>foo = %Q(The integer division operator in VisualBASIC is written \"a \\\\ b\" and #{'interpolation' + ' works'})\n</code></pre>\n\n<p>You can also interpolate strings in it. The only caveat is, you would still need to escape <code>\\</code> character.</p>\n\n<p>HTH</p>\n"}, {"comments": [{"owner": {"reputation": 3840, "user_id": 1054638, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/39071d37bc0d2ca9954bf865e7ce0167?s=128&d=identicon&r=PG", "display_name": "Harsh Gupta", "link": "https://stackoverflow.com/users/1054638/harsh-gupta"}, "edited": false, "score": 0, "creation_date": 1426688325, "post_id": 29124475, "comment_id": 46475103, "body": "You would still have to escape `\\` (backslash) AFAIK."}, {"owner": {"reputation": 3840, "user_id": 1054638, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/39071d37bc0d2ca9954bf865e7ce0167?s=128&d=identicon&r=PG", "display_name": "Harsh Gupta", "link": "https://stackoverflow.com/users/1054638/harsh-gupta"}, "edited": false, "score": 0, "creation_date": 1426688508, "post_id": 29124475, "comment_id": 46475233, "body": "<code>foo = &lt;&lt;_ The integer division operator in VisualBASIC is written &quot;a \\\\ b&quot;; text #{value} _</code>. Check double backslashes."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1426689574, "post_id": 29124475, "comment_id": 46476044, "body": "You can call <code>chomp</code> right after the heredoc&#39;s opening identifier, i.e.  <code>foo = &lt;&lt;&#39;_&#39;.chomp ...</code>"}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 2, "last_activity_date": 1426688585, "last_edit_date": 1426688585, "creation_date": 1426688221, "answer_id": 29124475, "question_id": 29124058, "link": "https://stackoverflow.com/questions/29124058/string-literal-without-need-to-escape-backslash/29124475#29124475", "title": "String literal without need to escape backslash", "body": "<p>You can use heredoc with single quotes.</p>\n\n<pre><code>foo = &lt;&lt;'_'\nThe integer division operator in VisualBASIC is written \"a \\ b\";\n_\n</code></pre>\n\n<p>If you want to get rid of the newline character at the end, then <code>chomp</code> it.</p>\n\n<p>Note that this does not work with string interpolation. If you want to insert evaluated expressions within the string, you can use <code>%</code> operation after you create the string.</p>\n\n<pre><code>foo = &lt;&lt;'_'\ntext %{value}\n_\n\nfoo.chomp % {value: \"foo\"}\n</code></pre>\n"}], "owner": {"reputation": 1578, "user_id": 205052, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/fafa5260437d802318612848f1afa721?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/205052/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3445, "favorite_count": 0, "accepted_answer_id": 29124286, "answer_count": 2, "score": 6, "last_activity_date": 1426688585, "creation_date": 1426687075, "last_edit_date": 1426687999, "question_id": 29124058, "link": "https://stackoverflow.com/questions/29124058/string-literal-without-need-to-escape-backslash", "title": "String literal without need to escape backslash", "body": "<p>In C#, I can write backslashes and other special characters without escaping by using <code>@</code> before a string, but I have to escape double-quotes.</p>\n\n<p><strong>C#</strong></p>\n\n<pre><code>string foo = \"The integer division operator in VisualBASIC is written \\\"a \\\\ b\\\"\";\nstring bar = @\"The integer division operator in VisualBASIC is written \\\"a \\ b\\\"\"\n</code></pre>\n\n<p>In Ruby, I could use the single-quote string literal, but I'd like to use this in conjuction with string interpolation like <code>\"text #{value}\"</code>. Is there an equivalent in Ruby to <code>@</code> in C#?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 14869, "user_id": 1794744, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bed721a1153f97bdd0b31703673abee2?s=128&d=identicon&r=PG", "display_name": "cqcn1991", "link": "https://stackoverflow.com/users/1794744/cqcn1991"}, "edited": false, "score": 0, "creation_date": 1426687404, "post_id": 29124029, "comment_id": 46474436, "body": "Because in most cases, I want to fetch <code>@user.friends</code>, no matter who create the relationship, (whether user_id == @user, or whether friends== @user)."}], "tags": [], "owner": {"reputation": 3, "user_id": 3568381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3da624d9b5e27c148a76d6343175b74?s=128&d=identicon&r=PG&f=1", "display_name": "ROR", "link": "https://stackoverflow.com/users/3568381/ror"}, "is_accepted": false, "score": 0, "last_activity_date": 1426686989, "creation_date": 1426686989, "answer_id": 29124029, "question_id": 29123620, "link": "https://stackoverflow.com/questions/29123620/rails-validate-unique-friendship-relationships/29124029#29124029", "title": "Rails: validate unique friendship relationships", "body": "<p>Why you need this unique combination. Consider if you want to fetch friends of single user then in current scenario you can find it using simple association.</p>\n\n<pre><code>@user.friends\n</code></pre>\n\n<p>And if you don't want to add two keys then you need to fire two queries to find same details. One for your friends and other for who requested you as a friend.</p>\n"}, {"comments": [{"owner": {"reputation": 14869, "user_id": 1794744, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bed721a1153f97bdd0b31703673abee2?s=128&d=identicon&r=PG", "display_name": "cqcn1991", "link": "https://stackoverflow.com/users/1794744/cqcn1991"}, "edited": false, "score": 0, "creation_date": 1426688234, "post_id": 29124307, "comment_id": 46475045, "body": "I think this prevents creating two <code>user_id = 1, friend_id = 2</code>, rather than a <code>user_id = 1, friend_id = 2</code> and a <code>user_id = 2, friend_id = 1</code>."}, {"owner": {"reputation": 14869, "user_id": 1794744, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bed721a1153f97bdd0b31703673abee2?s=128&d=identicon&r=PG", "display_name": "cqcn1991", "link": "https://stackoverflow.com/users/1794744/cqcn1991"}, "edited": false, "score": 0, "creation_date": 1426688466, "post_id": 29124307, "comment_id": 46475203, "body": "What about  <code>if self.class.where(user_id: friend_id, friend_id:user_id).exist?</code> ?"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "reply_to_user": {"reputation": 14869, "user_id": 1794744, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bed721a1153f97bdd0b31703673abee2?s=128&d=identicon&r=PG", "display_name": "cqcn1991", "link": "https://stackoverflow.com/users/1794744/cqcn1991"}, "edited": false, "score": 0, "creation_date": 1426689398, "post_id": 29124307, "comment_id": 46475911, "body": "You could do this but you would have to check the opposite too (with a <code>validates</code>). It could work but 2 SQL queries would be triggered instead of one. It&#39;s up to you"}, {"owner": {"reputation": 85, "user_id": 3070597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64bcd5e412d46e59c2d0299775c22277?s=128&d=identicon&r=PG", "display_name": "pjpires", "link": "https://stackoverflow.com/users/3070597/pjpires"}, "edited": false, "score": 0, "creation_date": 1587637491, "post_id": 29124307, "comment_id": 108591807, "body": "Stumbled on this today, great solution! BTW, nowadays you can improve it further by making the validation into a single query (in Rails 5+) with <code>.or</code>, like: <code>User.where(user_id: friend_id, friend_id: user_id).or(User.where(user_id: user_id, friend_id: friend_id)).exists?</code>. Also, for a 2-way index on the DB <a href=\"https://stackoverflow.com/a/30037484/3070597\">this</a> looks the best option. Combining both is the ideal approach IMO."}], "tags": [], "owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "is_accepted": true, "score": 3, "last_activity_date": 1560446505, "last_edit_date": 1560446505, "creation_date": 1426687788, "answer_id": 29124307, "question_id": 29123620, "link": "https://stackoverflow.com/questions/29123620/rails-validate-unique-friendship-relationships/29124307#29124307", "title": "Rails: validate unique friendship relationships", "body": "<p>You can use the following:</p>\n\n<pre><code>validate :users_are_not_already_friends\n\ndef users_are_not_already_friends\n  combinations = [\"user_id = #{user_id} AND friend_id = #{friend_id}\",\n  \"user_id = #{friend_id} AND friend_id = #{user_id}\"]\n  if User.where(combinations.join(' OR ')).exists?\n    self.errors.add(:user_id, 'Already friends!')\n  end\nend\n</code></pre>\n\n<hr>\n\n<p>Update 2019:</p>\n\n<p>Revised suggestion:</p>\n\n<pre><code>def users_are_not_already_friends\n  if User.where(user_id: friend_id, friend_id: user_id).exist?\n    || User.where(user_id: user_id, friend_id: friend_id).exist?\n    self.errors.add(:user_id, 'Already friends!')\n  end\nend\n</code></pre>\n\n<p>And I would strongly advise to add a DB constraint (unique index) based on the composite <code>user_id</code> and <code>friend_id</code>:</p>\n\n<pre><code>CREATE UNIQUE INDEX users_user_id_friend_id_key ON users (user_id, friend_id);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 805, "user_id": 4544219, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CLo94.jpg?s=128&g=1", "display_name": "Mosaaleb", "link": "https://stackoverflow.com/users/4544219/mosaaleb"}, "edited": false, "score": 0, "creation_date": 1560432610, "post_id": 29127324, "comment_id": 99741089, "body": "This will validate just one side, but not the inverse relationship"}], "tags": [], "owner": {"reputation": 2781, "user_id": 4200307, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/59KSj.jpg?s=128&g=1", "display_name": "Elvn", "link": "https://stackoverflow.com/users/4200307/elvn"}, "is_accepted": false, "score": 0, "last_activity_date": 1426695708, "creation_date": 1426695708, "answer_id": 29127324, "question_id": 29123620, "link": "https://stackoverflow.com/questions/29123620/rails-validate-unique-friendship-relationships/29127324#29127324", "title": "Rails: validate unique friendship relationships", "body": "<p>Yes. You are thinking along the right path. Perhaps the simplest solution is to use the database table to create the validation by making the combination of IDs a unique index.</p>\n\n\n\n<pre><code>class CreateFriendshipsUnq &lt; ActiveRecord::Migration\n  def change\n    add_index :friendships, [:user_id, :friend_id], unique: true\n  end\nend\n</code></pre>\n\n<p>I think this will do what you want.</p>\n"}], "owner": {"reputation": 14869, "user_id": 1794744, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bed721a1153f97bdd0b31703673abee2?s=128&d=identicon&r=PG", "display_name": "cqcn1991", "link": "https://stackoverflow.com/users/1794744/cqcn1991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 401, "favorite_count": 0, "accepted_answer_id": 29124307, "answer_count": 3, "score": 2, "last_activity_date": 1560446505, "creation_date": 1426685918, "question_id": 29123620, "link": "https://stackoverflow.com/questions/29123620/rails-validate-unique-friendship-relationships", "title": "Rails: validate unique friendship relationships", "body": "<p>I'm following <a href=\"http://railscasts.com/episodes/163-self-referential-association\" rel=\"nofollow\">http://railscasts.com/episodes/163-self-referential-association</a>\nto make a friendship system.</p>\n\n<pre><code>#Friendship model\nid | user_id | friend_id\n</code></pre>\n\n<p>The problem is </p>\n\n<ol>\n<li><p>How can I make the combination of <code>user_id</code> and <code>friend_id</code> unique?\nprevent creating <code>user_id = 1, friend_id = 2</code> from <code>user_id = 2. friend_id = 1</code></p></li>\n<li><p>I find this model design is really bad. Can I model it to actually store the combine of 2 ids? Like <code>friendship_id_combination = [1, 2]</code>, and then validate it.</p></li>\n</ol>\n"}, {"tags": ["ruby", "gem"], "comments": [{"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1426685956, "post_id": 29123339, "comment_id": 46473451, "body": "wdm isn&#39;t compatible with 2.2 (<a href=\"https://github.com/ruby/ruby/blob/v2_2_1/NEWS#L263-L294\" rel=\"nofollow noreferrer\"><code>rb_thread_blocking_region()</code> was removed</a>)"}, {"owner": {"reputation": 17690, "user_id": 3204250, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b9bff153828ae0d1323d2aa5d6ab70ae?s=128&d=identicon&r=PG&f=1", "display_name": "cdeterman", "link": "https://stackoverflow.com/users/3204250/cdeterman"}, "reply_to_user": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1426692615, "post_id": 29123339, "comment_id": 46478333, "body": "@cremno, that would explain it.  Thanks, if you want to post as an answer I will accept it."}], "answers": [{"comments": [{"owner": {"reputation": 2265, "user_id": 1276639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/723fb5ffbf465dfc367dcd8a6387efcb?s=128&d=identicon&r=PG", "display_name": "PhistucK", "link": "https://stackoverflow.com/users/1276639/phistuck"}, "edited": false, "score": 0, "creation_date": 1434998698, "post_id": 29126396, "comment_id": 50004962, "body": "Just make sure the Ruby and DevKit releases match. For example, Ruby 1.9.3 and DevKit 4.5.2-20111229."}, {"owner": {"reputation": 2582, "user_id": 91444, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/29a47e133966f04c224be074f847e45c?s=128&d=identicon&r=PG", "display_name": "Chad Gorshing", "link": "https://stackoverflow.com/users/91444/chad-gorshing"}, "edited": false, "score": 0, "creation_date": 1440711452, "post_id": 29126396, "comment_id": 52399602, "body": "The gem is now being maintained again and this issue might be solved by <a href=\"https://github.com/Maher4Ever/wdm/issues/18\" rel=\"nofollow noreferrer\">github.com/Maher4Ever/wdm/issues/18</a>"}], "tags": [], "owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "is_accepted": true, "score": 8, "last_activity_date": 1440711872, "last_edit_date": 1440711872, "creation_date": 1426693291, "answer_id": 29126396, "question_id": 29123339, "link": "https://stackoverflow.com/questions/29123339/error-installed-wdm-gem-on-windows-system/29126396#29126396", "title": "Error installed &#39;wdm&#39; gem on Windows system", "body": "<p>The <code>wdm</code> gem isn't compatible with 2.2. It calls the function <code>rb_thread_blocking_region()</code> which was deprecated in 2.0 and finally <a href=\"https://github.com/ruby/ruby/blob/v2_2_0/NEWS#L263-L294\" rel=\"nofollow\">removed in 2.2</a>. Also the gem isn't maintained anymore (see its <a href=\"https://github.com/Maher4Ever/wdm\" rel=\"nofollow\">repository and issue tracker</a>).</p>\n\n<p><s>You could fork the repo, merge <a href=\"https://github.com/Maher4Ever/wdm/pull/16\" rel=\"nofollow\">the  existing PR that apparently fixes the issue</a>, and build the gem by yourself. Using an older Ruby version could be a solution too.</s></p>\n\n<p><strong>Update:</strong>\nThe <code>wdm</code> gem was updated to <a href=\"https://rubygems.org/gems/wdm/versions/0.1.1\" rel=\"nofollow\">0.1.1</a> a while ago. The error is fixed by this version.</p>\n"}], "owner": {"reputation": 17690, "user_id": 3204250, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b9bff153828ae0d1323d2aa5d6ab70ae?s=128&d=identicon&r=PG&f=1", "display_name": "cdeterman", "link": "https://stackoverflow.com/users/3204250/cdeterman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1438, "favorite_count": 3, "accepted_answer_id": 29126396, "answer_count": 1, "score": 4, "last_activity_date": 1440711872, "creation_date": 1426685189, "question_id": 29123339, "link": "https://stackoverflow.com/questions/29123339/error-installed-wdm-gem-on-windows-system", "title": "Error installed &#39;wdm&#39; gem on Windows system", "body": "<p>I have a fresh install of Ruby 2.2.1 (32-bit) on my Windows 7 system.  I also installed the devkit without any reported errors.  Naturally I thought I could just install the 'wdm' gem with:</p>\n\n<pre><code>gem install wdm\n</code></pre>\n\n<p>However, it errors out.  The entire output is a bit much to post the entire thing so truncated the following points come up.</p>\n\n<pre><code>C:/Ruby22/bin/ruby.exe -r ./siteconf20150318-1712-oq5nlb.rb extconf.rb\nchecking for main() in -lkernel32... yes\nchecking for windows.h... yes\nchecking for ruby.h... yes\nchecking for HAVE_RUBY_ENCODING_H... yes\ncreating Makefile\n\nmake \"DESTDIR=\" clean\n\nmake \"DESTDIR=\"\ngenerating wdm_ext-i386-mingw32.def\ncompiling entry.c\nIn file included from entry.c:1:0:\nwdm.h:3:0: warning: \"WINVER\" redefined [enabled by default]\n...\nwdm.h:4:0: warning: \"_WIN32_WINNT\" redefined [enabled by default]\n...\nwarning: #warning Please include winsock2.h before windows.h [-Wcpp]\ncompiling monitor.c  (this is repeated for multiple *.c files)\n...\nrb_monitor.o: In function `rb_monitor_run_bang':\nC:\\Ruby22\\lib\\ruby\\gems\\2.2.0\\gems\\wdm-0.1.0\\ext\\wdm/rb_monitor.c:508: undefined reference to `rb_thread_blocking_region'\ncollect2.exe: error: ld returned 1 exit status\nmake: *** [wdm_ext.so] Error 1\n\nmake failed, exit code 2\n</code></pre>\n\n<p>Did I miss something?</p>\n"}, {"tags": ["ruby", "opalrb"], "answers": [{"comments": [{"owner": {"reputation": 1631, "user_id": 414329, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/15d21696a56b183503cf2c82114be9d6?s=128&d=identicon&r=PG", "display_name": "krainboltgreene", "link": "https://stackoverflow.com/users/414329/krainboltgreene"}, "edited": false, "score": 0, "creation_date": 1426707212, "post_id": 29129274, "comment_id": 46487871, "body": "Wow, that absolutely worked, where is this documented?"}, {"owner": {"reputation": 554, "user_id": 809588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AHhwN.jpg?s=128&g=1", "display_name": "gabrielrios", "link": "https://stackoverflow.com/users/809588/gabrielrios"}, "reply_to_user": {"reputation": 1631, "user_id": 414329, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/15d21696a56b183503cf2c82114be9d6?s=128&d=identicon&r=PG", "display_name": "krainboltgreene", "link": "https://stackoverflow.com/users/414329/krainboltgreene"}, "edited": false, "score": 0, "creation_date": 1426712417, "post_id": 29129274, "comment_id": 46490956, "body": "Docs for opal are lacking, I&#39;m used to read the source code of its library: <a href=\"https://github.com/opal/opal-jquery/blob/master/lib/opal/jquery/element.rb#L115-L132\" rel=\"nofollow noreferrer\">github.com/opal/opal-jquery/blob/master/lib/opal/jquery/&hellip;</a>"}], "tags": [], "owner": {"reputation": 554, "user_id": 809588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AHhwN.jpg?s=128&g=1", "display_name": "gabrielrios", "link": "https://stackoverflow.com/users/809588/gabrielrios"}, "is_accepted": true, "score": 2, "last_activity_date": 1426701229, "creation_date": 1426701229, "answer_id": 29129274, "question_id": 29123303, "link": "https://stackoverflow.com/questions/29123303/how-to-use-jquery-libraries-with-opal-jquery/29129274#29129274", "title": "How to use jquery libraries with opal-jquery?", "body": "<p>Just call</p>\n\n<pre><code>Element.expose(:terminal)\n</code></pre>\n\n<p>Before trying to use the method and that should work.</p>\n"}], "owner": {"reputation": 1631, "user_id": 414329, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/15d21696a56b183503cf2c82114be9d6?s=128&d=identicon&r=PG", "display_name": "krainboltgreene", "link": "https://stackoverflow.com/users/414329/krainboltgreene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 29129274, "answer_count": 1, "score": 0, "last_activity_date": 1426701229, "creation_date": 1426685085, "question_id": 29123303, "link": "https://stackoverflow.com/questions/29123303/how-to-use-jquery-libraries-with-opal-jquery", "title": "How to use jquery libraries with opal-jquery?", "body": "<p>So I'm using <code>opal</code>, <code>opal-jquery</code>, and <code>jquery.terminal</code>. The latter adds a function to jquery called <code>terminal()</code>.</p>\n\n<p>However <code>Element</code> doesn't seem to have that method?</p>\n"}, {"tags": ["c++", "ruby-on-rails", "ruby", "mongodb"], "comments": [{"owner": {"reputation": 10724, "user_id": 3749550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MQMvF.jpg?s=128&g=1", "display_name": "wdberkeley", "link": "https://stackoverflow.com/users/3749550/wdberkeley"}, "edited": false, "score": 0, "creation_date": 1427122560, "post_id": 29122976, "comment_id": 46636232, "body": "It would take some more fine-tuned digging to confirm but, yes, it sounds like the difference is in the language/driver performance between C++ and the shell (based on a C++ driver) and Ruby. I&#39;m not sure what you mean by unzipping the received BSON object."}, {"owner": {"reputation": 1, "user_id": 4453340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LHyEN.jpg?s=128&g=1", "display_name": "Kirill Bushminkin", "link": "https://stackoverflow.com/users/4453340/kirill-bushminkin"}, "reply_to_user": {"reputation": 10724, "user_id": 3749550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MQMvF.jpg?s=128&g=1", "display_name": "wdberkeley", "link": "https://stackoverflow.com/users/3749550/wdberkeley"}, "edited": false, "score": 0, "creation_date": 1427210786, "post_id": 29122976, "comment_id": 46679208, "body": "@wdberkeley Creating Ruby object (actual object or hash) from received binary data (BSON.deserialized) ."}], "owner": {"reputation": 1, "user_id": 4453340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LHyEN.jpg?s=128&g=1", "display_name": "Kirill Bushminkin", "link": "https://stackoverflow.com/users/4453340/kirill-bushminkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 222, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1426684132, "creation_date": 1426684132, "question_id": 29122976, "link": "https://stackoverflow.com/questions/29122976/reading-large-result-set-from-mongo-performance-issue", "title": "Reading large result set from Mongo - performance issue", "body": "<p>Faced performance issue where reading several thousands. We have RoR application where we read data stored in Mongo. We use Monogid. Each stored documents contain 17 fields (15 float, and 2 as integer). We execute query which supported by index. Cursor return very fast (&lt;50ms) but reading all documents take more then 500ms. \nTo find bottleneck we run the same query in Mongo Shell and query took &lt;50ms to complete and iterate overall rows in result set. We have tested Mongo Ruby Driver and query take 250ms to complete. The same result we have if using Moped. Finally we have wrote c++ app which use mongo c++ driver and time to iterate over all result set - &lt;20ms. But if we unzip received BSON object (to output it to console) time rise up to 120ms.\nDoes extraction from BSON take that much time?</p>\n"}, {"tags": ["ruby", "rspec", "rake"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 1, "creation_date": 1426683744, "post_id": 29122700, "comment_id": 46471846, "body": "how are you running your tests?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1426683962, "post_id": 29122700, "comment_id": 46472011, "body": "seems like you&#39;re running <code>rspec spec ~&#47;Projects&#47;sudo_boris_bikes&#47;spec</code>"}, {"owner": {"reputation": 91, "user_id": 4605625, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/f2679a70078dcfd9845165838f5ea24c?s=128&d=identicon&r=PG&f=1", "display_name": "PaulWallis42", "link": "https://stackoverflow.com/users/4605625/paulwallis42"}, "edited": false, "score": 0, "creation_date": 1427204575, "post_id": 29122700, "comment_id": 46674405, "body": "Anthony - Run by Rake.  Interestingly I don&#39;t get the duplicated error when I run RSpec only when I run Rake?"}], "owner": {"reputation": 91, "user_id": 4605625, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/f2679a70078dcfd9845165838f5ea24c?s=128&d=identicon&r=PG&f=1", "display_name": "PaulWallis42", "link": "https://stackoverflow.com/users/4605625/paulwallis42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1426685165, "creation_date": 1426683406, "last_edit_date": 1426685165, "question_id": 29122700, "link": "https://stackoverflow.com/questions/29122700/why-am-i-getting-duplicate-rspec-test-fails", "title": "Why am I getting duplicate RSpec test fails?", "body": "<p>When I get a test fail, I get duplicate errors from slightly different directory paths. Example of this is:</p>\n\n<pre><code>  1) Bike when created should not be broken\n     Failure/Error: it { is_expected.not_to be_broken }\n       expected #&lt;Bike:0x007fb5c7061448&gt; to respond to `broken?`\n     # /Users/paulwallis/Projects/sudo_boris_bikes/spec/bike_spec.rb:4:in `block (3 levels) in &lt;top (required)&gt;'\n\n  4) Bike when created should not be broken\n     Failure/Error: it { is_expected.not_to be_broken }\n       expected #&lt;Bike:0x007fb5c70f26a0&gt; to respond to `broken?`\n     # ./spec/bike_spec.rb:4:in `block (3 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>They are the same error, but are using only a part of the directory path. Are they duplicated?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "markdown", "redcarpet"], "comments": [{"owner": {"reputation": 356, "user_id": 3785320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rxg8c.jpg?s=128&g=1", "display_name": "Bottled Smoke", "link": "https://stackoverflow.com/users/3785320/bottled-smoke"}, "edited": false, "score": 0, "creation_date": 1426684050, "post_id": 29122231, "comment_id": 46472065, "body": "Can you iterate over the array of markdown syntax and check for a regex that matches a newline and any markdown characters? If true, (has opening and closing), print the slice, and if false, (has opening but no closing and no open tags until next closing or newline), add on closing tag and print the slice?"}, {"owner": {"reputation": 8744, "user_id": 1866998, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7d3a6dd6300501be9bf3b64edba141ea?s=128&d=identicon&r=PG", "display_name": "zavg", "link": "https://stackoverflow.com/users/1866998/zavg"}, "reply_to_user": {"reputation": 356, "user_id": 3785320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rxg8c.jpg?s=128&g=1", "display_name": "Bottled Smoke", "link": "https://stackoverflow.com/users/3785320/bottled-smoke"}, "edited": false, "score": 0, "creation_date": 1426684977, "post_id": 29122231, "comment_id": 46472795, "body": "@BottledSmoke Isn&#39;t it overcomplicated? And how to deal with lists which have no closing tags? I came up with idea of just slice on new line (but not less then certain amount of characters). But it also does not deal with lists..."}, {"owner": {"reputation": 356, "user_id": 3785320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rxg8c.jpg?s=128&g=1", "display_name": "Bottled Smoke", "link": "https://stackoverflow.com/users/3785320/bottled-smoke"}, "edited": false, "score": 0, "creation_date": 1426685696, "post_id": 29122231, "comment_id": 46473264, "body": "Yeah, I just realized that you can use markdown and showdown. You&#39;ll have to forgive me. I just woke up :)"}], "answers": [{"comments": [{"owner": {"reputation": 8744, "user_id": 1866998, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7d3a6dd6300501be9bf3b64edba141ea?s=128&d=identicon&r=PG", "display_name": "zavg", "link": "https://stackoverflow.com/users/1866998/zavg"}, "edited": false, "score": 0, "creation_date": 1426686140, "post_id": 29123515, "comment_id": 46473573, "body": "Thank you for great idea! But if I render a chunk of the data it will contain HTML tags so I will not be able to just slice the string in the middle..."}, {"owner": {"reputation": 356, "user_id": 3785320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rxg8c.jpg?s=128&g=1", "display_name": "Bottled Smoke", "link": "https://stackoverflow.com/users/3785320/bottled-smoke"}, "reply_to_user": {"reputation": 8744, "user_id": 1866998, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7d3a6dd6300501be9bf3b64edba141ea?s=128&d=identicon&r=PG", "display_name": "zavg", "link": "https://stackoverflow.com/users/1866998/zavg"}, "edited": false, "score": 0, "creation_date": 1426687189, "post_id": 29123515, "comment_id": 46474289, "body": "Yeah I realized that, so I edited my answer. Will something like that work?"}, {"owner": {"reputation": 8744, "user_id": 1866998, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7d3a6dd6300501be9bf3b64edba141ea?s=128&d=identicon&r=PG", "display_name": "zavg", "link": "https://stackoverflow.com/users/1866998/zavg"}, "edited": false, "score": 0, "creation_date": 1426687724, "post_id": 29123515, "comment_id": 46474690, "body": "IMO the hardest part is to find out exact regexp to use for your algorithm."}, {"owner": {"reputation": 356, "user_id": 3785320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rxg8c.jpg?s=128&g=1", "display_name": "Bottled Smoke", "link": "https://stackoverflow.com/users/3785320/bottled-smoke"}, "reply_to_user": {"reputation": 8744, "user_id": 1866998, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7d3a6dd6300501be9bf3b64edba141ea?s=128&d=identicon&r=PG", "display_name": "zavg", "link": "https://stackoverflow.com/users/1866998/zavg"}, "edited": false, "score": 0, "creation_date": 1426697287, "post_id": 29123515, "comment_id": 46481728, "body": "Sorry, you don&#39;t need a regex. It was St. Pattys yesterday. My head wasn&#39;t right when the morning hit like a freight train. I&#39;ve revised my answer yet again with a fiddle that should solve your problems or at least point you in the right direction (no regex involved)."}, {"owner": {"reputation": 8744, "user_id": 1866998, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7d3a6dd6300501be9bf3b64edba141ea?s=128&d=identicon&r=PG", "display_name": "zavg", "link": "https://stackoverflow.com/users/1866998/zavg"}, "edited": false, "score": 0, "creation_date": 1426700603, "post_id": 29123515, "comment_id": 46483860, "body": "Just wow! Thank you so much for your efforts and time you spend on that issue! I would really upvote at least 10 times if it was possible :)"}, {"owner": {"reputation": 356, "user_id": 3785320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rxg8c.jpg?s=128&g=1", "display_name": "Bottled Smoke", "link": "https://stackoverflow.com/users/3785320/bottled-smoke"}, "reply_to_user": {"reputation": 8744, "user_id": 1866998, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7d3a6dd6300501be9bf3b64edba141ea?s=128&d=identicon&r=PG", "display_name": "zavg", "link": "https://stackoverflow.com/users/1866998/zavg"}, "edited": false, "score": 0, "creation_date": 1426700723, "post_id": 29123515, "comment_id": 46483926, "body": "Anytime. We&#39;re all in this together :)"}, {"owner": {"reputation": 8744, "user_id": 1866998, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7d3a6dd6300501be9bf3b64edba141ea?s=128&d=identicon&r=PG", "display_name": "zavg", "link": "https://stackoverflow.com/users/1866998/zavg"}, "edited": false, "score": 0, "creation_date": 1426700876, "post_id": 29123515, "comment_id": 46484019, "body": "Yes, for sure! But you delivered really amazing piece of code!!"}], "tags": [], "owner": {"reputation": 356, "user_id": 3785320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rxg8c.jpg?s=128&g=1", "display_name": "Bottled Smoke", "link": "https://stackoverflow.com/users/3785320/bottled-smoke"}, "is_accepted": true, "score": 3, "last_activity_date": 1426701182, "last_edit_date": 1495540015, "creation_date": 1426685664, "answer_id": 29123515, "question_id": 29122231, "link": "https://stackoverflow.com/questions/29122231/implementing-preview-for-markdown-text/29123515#29123515", "title": "Implementing preview for markdown text", "body": "<p>Using <a href=\"https://github.com/evilstreak/markdown-js\" rel=\"nofollow noreferrer\">markdown.js</a> and / or <a href=\"https://github.com/coreyti/showdown\" rel=\"nofollow noreferrer\">showdown</a> should work. <a href=\"https://stackoverflow.com/questions/10440037/rails-markdown-editor-with-live-preview\">Here's a StackO with the same question and answer</a>. I personally have used showdown in an Ember app before to render a live preview of the text as it's being typed (via 2-way data binding), and it worked flawlessly. </p>\n\n<p>In the fiddle below, I wrote a little Showdown parser that takes in a string of markdown, splits it on a newline (returns an array of tags), and iterates through the array. On each iteration, it removes the tags, checks the length of the resulting string, and then compares it to the max character count for the preview. Once the next iteration surpasses the max character count, it returns the preview. The do loop ensures that you will always get at least one blob of html as a preview. </p>\n\n<p><a href=\"https://jsfiddle.net/bottledsmoke/rdyLm39s/9/\" rel=\"nofollow noreferrer\">Fiddle</a></p>\n\n<pre><code>$(function() {\n  var converter = new Showdown.converter();\n  var previewMax = 200;\n\n  $('button').click(function() {        \n    var content = $('#markdown').val(),\n        charCount = 0,\n        i = 0,\n        output = '';\n\n    if (!content) {\n      return $('div.preview').html(\"Please enter some text.\");\n    }\n\n    var mark = converter.makeHtml(content);\n    var mark_arr = mark.split('\\n');\n\n    while (charCount &lt; previewMax) {\n      var html = mark_arr[i];\n      var text = htmlStrip(html);            \n\n      if ((charCount + text.length) &gt; previewMax) {\n        var overflow = (charCount + text.length) - previewMax;\n        var clipAmount = text.length - overflow;\n        html = jQuery.truncate(mark_arr[i], { length: clipAmount });\n        }\n\n      output += html;\n      charCount += text.length;\n      i++;\n    };\n\n    $('div.preview').html(output);\n    $('div.full').html(mark);\n  });\n\n  function htmlStrip (html) {\n    var div = document.createElement('div');\n    div.innerHTML = html;\n    var text = div.textContent || div.innerText || \"\";\n    return text;\n  }\n});\n</code></pre>\n\n<hr>\n\n<h2>REVISION</h2>\n\n<p>I updated the function using <a href=\"https://github.com/pathable/truncate\" rel=\"nofollow noreferrer\">jQuery Truncate</a> to cut the final string into an elipses so that all your previews are the same length as the others. Also, I realized that the original function returned a long string of undefined' over and over when no text was entered, so there is a check to eliminate that. Since this loop will always return at least one html item now, I changed the do loop to a while loop for easier reading. Finally, if you want your truncation to always end at a word boundary, pass the <code>words: true</code> option when you call it. Obviously, this will not give you the same level of truncation for every preview, but it will improve legibility. That's it!</p>\n"}, {"tags": [], "owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "is_accepted": false, "score": 3, "last_activity_date": 1461713778, "last_edit_date": 1461713778, "creation_date": 1461710981, "answer_id": 36877191, "question_id": 29122231, "link": "https://stackoverflow.com/questions/29122231/implementing-preview-for-markdown-text/36877191#36877191", "title": "Implementing preview for markdown text", "body": "<p>I want to share my preview version it was quite simple with <a href=\"https://github.com/showdownjs/showdown\" rel=\"nofollow\">showdown.js</a> and <a href=\"http://prismjs.com/\" rel=\"nofollow\">prism.js</a> syntax highlighting.</p>\n\n<p><code>Prism.js</code> is syntaxing easily with JavaScript and CSS. All you need to pick specific languages and download it to assets folder. Or you can specify it to specific pages.</p>\n\n<p>This is going to happen in realtime preview, in a form.</p>\n\n<p><strong>In Rails form:</strong></p>\n\n<pre><code>&lt;div class=\"col-md-12\"&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= f.label :body %&gt;\n    &lt;%= f.text_area :body, class: \"form-control\", rows: 10 %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n\n\n&lt;div class=\"col-md-12\"&gt;\n  &lt;h1&gt; Preview Markdown &lt;/h1&gt;\n  &lt;div class=\"form-group markdownOutput\"&gt;&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p><strong>And add this script right below a form page.</strong></p>\n\n<pre><code>&lt;script&gt;\nfunction mkdown(){\n  var converter  = new showdown.Converter(),\n      $post_body = $(\"#post_body\");\n\n  // This line will keep adding new rows for textarea. \n  function postBodyLengthDetector(post_body){\n    var lines = post_body.val().split(\"\\n\");\n    post_body.prop('rows', lines.length+5);\n  }\n\n\n  // Textarea rows in default '10', when focusing on this. It will expand. \n  $post_body.focus(function(){\n    postBodyLengthDetector($(this));\n    $('.markdownOutput').html(converter.makeHtml($post_body.val()));\n  });\n\n  // All simple magic goes here, each time when texting anything into textarea\n  //it will be generated to markdown. You are able to see preview right below of textarea.\n  $post_body.keyup(function() {\n    postBodyLengthDetector($(this));\n      var value = $( this ).val(),\n          html  = converter.makeHtml(value);\n          $('.markdownOutput').html(html);\n  });\n}\n$(mkdown);\n$(document).on(\"turbolinks:load\", mkdown);\n&lt;/script&gt;\n</code></pre>\n"}], "owner": {"reputation": 8744, "user_id": 1866998, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7d3a6dd6300501be9bf3b64edba141ea?s=128&d=identicon&r=PG", "display_name": "zavg", "link": "https://stackoverflow.com/users/1866998/zavg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 927, "favorite_count": 1, "accepted_answer_id": 29123515, "answer_count": 2, "score": 0, "last_activity_date": 1461713778, "creation_date": 1426682103, "last_edit_date": 1426686591, "question_id": 29122231, "link": "https://stackoverflow.com/questions/29122231/implementing-preview-for-markdown-text", "title": "Implementing preview for markdown text", "body": "<p>I am working on Ruby on Rails project and I have implemented markdown syntax for some text descriptions in my project using <a href=\"https://github.com/vmg/redcarpet\" rel=\"nofollow\">redcarpet</a> gem. </p>\n\n<p>It works like charm allowing to convert markdown text to HTML as simply as</p>\n\n<p><code>&lt;%= markdown some_text_variable %&gt;</code></p>\n\n<p>But now I want to implement preview feature rendering just small part of the full text. </p>\n\n<p>The following naive construction </p>\n\n<p><code>&lt;%= markdown some_text_variable[0..preview_length] %&gt;</code></p>\n\n<p>will not work because it can easily break down MD syntax resulting in confusing constructions (imagine, for example, spliting original string on the half of image link).</p>\n\n<p>I came up with </p>\n\n<p><code>&lt;%= markdown some_text_variable[0..preview_length].split(/\\r?\\n/)[0..-2].join(\"\\r\\n\")) %&gt;</code></p>\n\n<p>but it does not deal, for example, with code blocks.</p>\n\n<p>Is there any way to implement such kind of preview for MD text?</p>\n"}, {"tags": ["ios", "ruby", "cocoapods"], "comments": [{"owner": {"reputation": 2062, "user_id": 1073786, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e501101fbe33c14a31362383a79ea3be?s=128&d=identicon&r=PG", "display_name": "Sanandrea", "link": "https://stackoverflow.com/users/1073786/sanandrea"}, "edited": false, "score": 1, "creation_date": 1426682577, "post_id": 29122190, "comment_id": 46471073, "body": "could you post your Podfile"}, {"owner": {"reputation": 1302, "user_id": 2126233, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b1e8a36dcc7419c324aa876ae7c8128c?s=128&d=identicon&r=PG", "display_name": "pls", "link": "https://stackoverflow.com/users/2126233/pls"}, "reply_to_user": {"reputation": 2062, "user_id": 1073786, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e501101fbe33c14a31362383a79ea3be?s=128&d=identicon&r=PG", "display_name": "Sanandrea", "link": "https://stackoverflow.com/users/1073786/sanandrea"}, "edited": false, "score": 0, "creation_date": 1426687711, "post_id": 29122190, "comment_id": 46474680, "body": "I have posted my Podfile."}], "owner": {"reputation": 1302, "user_id": 2126233, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b1e8a36dcc7419c324aa876ae7c8128c?s=128&d=identicon&r=PG", "display_name": "pls", "link": "https://stackoverflow.com/users/2126233/pls"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 671, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1426687696, "creation_date": 1426682006, "last_edit_date": 1426687696, "question_id": 29122190, "link": "https://stackoverflow.com/questions/29122190/ios-podfile-error-undefined-method-source", "title": "iOS Podfile error: undefined method &#39;source&#39;", "body": "<p>I am currently getting the following error when running pod install:</p>\n\n<pre><code>[!] Invalid `Podfile` file: undefined method `source' for #&lt;Pod::Podfile:0x007fcf91b8c7a8&gt;. Updating CocoaPods might fix the issue.\n\n #  from /Users/preston/Work/Test/Podfile:1\n #  -------------------------------------------\n &gt;  source 'https://github.com/CocoaPods/Specs.git'\n #  platform :ios, '8.0'\n #  -------------------------------------------\n</code></pre>\n\n<p>I have tried the following:</p>\n\n<ul>\n<li><p>pod repo remove master; pod setup</p></li>\n<li><p>rm -rf ~/.cocoapods; pod setup</p></li>\n<li><p>sudo gem uninstall cocoapods; sudo gem install cocoapods</p></li>\n</ul>\n\n<p>After running the last bullet point I ran pod setup and got the following:</p>\n\n<pre><code>Setting up CocoaPods master repo\nAlready up-to-date.\n\nCocoaPods 0.36.0 is available.\nTo update use: [sudo] gem install cocoapods\n\nSetup completed (read-only access)\n</code></pre>\n\n<p>Which is confusing because I just updated.</p>\n\n<p>Evening after running all of these commands I am still getting the above error. Does anyone know what might be going wrong?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>Here is my Podfile. However everything worked on another computer but not on mine:</p>\n\n<pre><code>source 'https://github.com/CocoaPods/Specs.git'\nplatform :ios, '8.0'\nuse_frameworks!\n</code></pre>\n"}, {"tags": ["ruby", "json", "api", "rest", "webview"], "comments": [{"owner": {"reputation": 2204, "user_id": 4003349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jyMqf.jpg?s=128&g=1", "display_name": "Legendary", "link": "https://stackoverflow.com/users/4003349/legendary"}, "edited": false, "score": 0, "creation_date": 1426685380, "post_id": 29121988, "comment_id": 46473070, "body": "looks like u call method from V2? not V3 - cos it tell u about partial webviews/v2/product"}, {"owner": {"reputation": 11, "user_id": 3302431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9aca4a076b3b9f25a79aeaa77986e02?s=128&d=identicon&r=PG&f=1", "display_name": "RedaEl", "link": "https://stackoverflow.com/users/3302431/redael"}, "reply_to_user": {"reputation": 2204, "user_id": 4003349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jyMqf.jpg?s=128&g=1", "display_name": "Legendary", "link": "https://stackoverflow.com/users/4003349/legendary"}, "edited": false, "score": 0, "creation_date": 1426693621, "post_id": 29121988, "comment_id": 46479101, "body": "the version is not a problem cause v2 is the version of webview and v3 is the version of the api the solution is to create a webview with webviews/v2/product.json.erb because the type of api call is json but i need to send an html to mobile (with css of course) not a json data"}], "owner": {"reputation": 11, "user_id": 3302431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9aca4a076b3b9f25a79aeaa77986e02?s=128&d=identicon&r=PG&f=1", "display_name": "RedaEl", "link": "https://stackoverflow.com/users/3302431/redael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 219, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1426693647, "creation_date": 1426681468, "last_edit_date": 1426693647, "question_id": 29121988, "link": "https://stackoverflow.com/questions/29121988/ruby-rest-api-how-to-render-an-html-webview-inside-json", "title": "Ruby (REST API): how to render an html webview inside json", "body": "<p>Hi everyone i work on an api rest in ruby and i have a webview written with haml (views/webviews/v2/_product.html.haml), i want to send this partial html to mobile inside a json return.\nhere is the api method :</p>\n\n<pre><code>class Api::V3::ProductsController &lt; Api::V3::ApplicationController\n\n  respond_to :json\n  def show\n    product = Product.find(param[:id].to_i)\n    render status: 200,\n    json: {\n        product: ProductSerializer.new(product)\n       },\n    root: false\n  end\nend\n</code></pre>\n\n<p>and in my product_serializer.rb i have</p>\n\n<pre><code>class ProductSerializer &lt; ActiveModel::Serializer\n  attributes :id, :description\n  def description\n    h.render(\n     :partial =&gt; 'webviews/v2/product',\n     :locals =&gt; { :product =&gt; object }\n    )\n  end\n</code></pre>\n\n<p>but it's not working because i got this error :</p>\n\n<pre><code> ActionView::MissingTemplate:\n Missing partial webviews/v2/product with {:locale=&gt;[:fr], :formats=&gt;[:json], :handlers=&gt;[:erb, :builder, :coffee, :haml, :csvbuilder]}. Searched in:\n     * \"/.rvm/gems/ruby-2.1.5/gems/kaminari-0.14.1/app/views\"\n     * \"/.rvm/gems/ruby-2.1.5/gems/customs-1.0.2/app/views\"\n     * \"/.rvm/gems/ruby-2.1.5/gems/devise-2.2.8/app/views\"\n</code></pre>\n\n<p>So what's the best way to render a html webview in a REST API json ?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["ruby", "windows", "ruby-on-rails-4", "webrick", "web-development-server"], "comments": [{"owner": {"reputation": 4005, "user_id": 4200092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/saOd8.png?s=128&g=1", "display_name": "GoBusto", "link": "https://stackoverflow.com/users/4200092/gobusto"}, "edited": false, "score": 1, "creation_date": 1426677769, "post_id": 29120662, "comment_id": 46468074, "body": "The first line tells you what to do: (Re)-install Nokogiri, optionally using the system libraries instead of the bundled ones: <code>gem install nokogiri -- --use-system-libraries</code>"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4661858, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Wc6eU5LW3-Q/AAAAAAAAAAI/AAAAAAAAACo/AtIbMqY2uXU/photo.jpg?sz=128", "display_name": "Vishad Goyal", "link": "https://stackoverflow.com/users/4661858/vishad-goyal"}, "edited": false, "score": 0, "creation_date": 1426710537, "post_id": 29123490, "comment_id": 46489863, "body": "firt of all i am on windows and there&#39;s no rvm for windows and i reinstalled nokogiri. still this error message:"}, {"owner": {"reputation": 25, "user_id": 4661858, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Wc6eU5LW3-Q/AAAAAAAAAAI/AAAAAAAAACo/AtIbMqY2uXU/photo.jpg?sz=128", "display_name": "Vishad Goyal", "link": "https://stackoverflow.com/users/4661858/vishad-goyal"}, "edited": false, "score": 0, "creation_date": 1426746758, "post_id": 29123490, "comment_id": 46501097, "body": "How to update the system path to libraries? Could you answer in some detail?"}, {"owner": {"reputation": 2204, "user_id": 4003349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jyMqf.jpg?s=128&g=1", "display_name": "Legendary", "link": "https://stackoverflow.com/users/4003349/legendary"}, "reply_to_user": {"reputation": 25, "user_id": 4661858, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Wc6eU5LW3-Q/AAAAAAAAAAI/AAAAAAAAACo/AtIbMqY2uXU/photo.jpg?sz=128", "display_name": "Vishad Goyal", "link": "https://stackoverflow.com/users/4661858/vishad-goyal"}, "edited": false, "score": 1, "creation_date": 1426754401, "post_id": 29123490, "comment_id": 46503953, "body": "Omg, i find it!! look this <a href=\"http://stackoverflow.com/questions/28999906/require-cannot-load-such-file-nokogiri-nokogiri-loaderror-when-running\" title=\"require cannot load such file nokogiri nokogiri loaderror when running\">stackoverflow.com/questions/28999906/&hellip;</a> . U have ruby version 2.2 and nokogiri does not support 2.2"}], "tags": [], "owner": {"reputation": 2204, "user_id": 4003349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jyMqf.jpg?s=128&g=1", "display_name": "Legendary", "link": "https://stackoverflow.com/users/4003349/legendary"}, "is_accepted": false, "score": 0, "last_activity_date": 1426685584, "creation_date": 1426685584, "answer_id": 29123490, "question_id": 29120662, "link": "https://stackoverflow.com/questions/29120662/when-i-start-the-server-in-ruby-on-rails-it-exits-as-soon-as-it-starts-and-somet/29123490#29123490", "title": "When I start the server in Ruby On Rails it exits as soon as it starts and sometimes doesn&#39;t even start, just gives an error", "body": "<p>try to </p>\n\n<pre><code>rvm ruby-2.2.0 gem update --system\n</code></pre>\n\n<p>Looks like ur nokogiri path broken</p>\n\n<p>ps edited on ur rvm version</p>\n"}, {"tags": [], "owner": {"reputation": 4288, "user_id": 527152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c784b2e1c3fb28d8bad8f50ca0282b4?s=128&d=identicon&r=PG", "display_name": "Azolo", "link": "https://stackoverflow.com/users/527152/azolo"}, "is_accepted": true, "score": 0, "last_activity_date": 1427142373, "creation_date": 1427142373, "answer_id": 29219698, "question_id": 29120662, "link": "https://stackoverflow.com/questions/29120662/when-i-start-the-server-in-ruby-on-rails-it-exits-as-soon-as-it-starts-and-somet/29219698#29219698", "title": "When I start the server in Ruby On Rails it exits as soon as it starts and sometimes doesn&#39;t even start, just gives an error", "body": "<p><strong>Nokogiri</strong> doesn't have <a href=\"https://github.com/sparklemotion/nokogiri/issues/1259\" rel=\"nofollow\">binaries for <code>Ruby 2.2.1</code> available for the <code>mingw32</code> platform</a> due to some problems with <a href=\"https://github.com/tjschuck/rake-compiler-dev-box/pull/20\" rel=\"nofollow\">cross compiling <code>Ruby 2.2.1</code> for the <code>rake-compiler-dev-box</code></a>.</p>\n\n<p>Since <strong>Nokogiri</strong> doesn't natively compile on <em>Windows</em>, the only fix is to <a href=\"https://bintray.com/oneclick/rubyinstaller/rubyinstaller/2.1.5\" rel=\"nofollow\">downgrade to <code>Ruby 2.1.5</code></a>. Once the next patch level of <code>Ruby 2.2</code> is released hopefully the problem will be solved.</p>\n"}], "owner": {"reputation": 25, "user_id": 4661858, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Wc6eU5LW3-Q/AAAAAAAAAAI/AAAAAAAAACo/AtIbMqY2uXU/photo.jpg?sz=128", "display_name": "Vishad Goyal", "link": "https://stackoverflow.com/users/4661858/vishad-goyal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1397, "favorite_count": 0, "accepted_answer_id": 29219698, "answer_count": 2, "score": -1, "last_activity_date": 1427142373, "creation_date": 1426677608, "last_edit_date": 1426814441, "question_id": 29120662, "link": "https://stackoverflow.com/questions/29120662/when-i-start-the-server-in-ruby-on-rails-it-exits-as-soon-as-it-starts-and-somet", "title": "When I start the server in Ruby On Rails it exits as soon as it starts and sometimes doesn&#39;t even start, just gives an error", "body": "<p>This is the error message in Windows:</p>\n\n<pre><code>   C:\\Users\\USER\\Sites\\new_cms&gt;rails s\nC:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/nokogiri-1.6.6.2-x64-mingw32/lib/nokogir\n.rb:29:in `require': cannot load such file -- nokogiri/nokogiri (LoadError)\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/nokogiri-1.6.6.2-x64-mingw3\n/lib/nokogiri.rb:29:in `rescue in &lt;top (required)&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/nokogiri-1.6.6.2-x64-mingw3\n/lib/nokogiri.rb:25:in `&lt;top (required)&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/loofah-2.0.1/lib/loofah.rb:\n:in `require'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/loofah-2.0.1/lib/loofah.rb:\n:in `&lt;top (required)&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/rails-html-sanitizer-1.0.2/\nib/rails-html-sanitizer.rb:2:in `require'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/rails-html-sanitizer-1.0.2/\nib/rails-html-sanitizer.rb:2:in `&lt;top (required)&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.0/lib/action\nview/helpers/sanitize_helper.rb:3:in `require'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.0/lib/action\nview/helpers/sanitize_helper.rb:3:in `&lt;top (required)&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.0/lib/action\nview/helpers/text_helper.rb:32:in `&lt;module:TextHelper&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.0/lib/action\nview/helpers/text_helper.rb:29:in `&lt;module:Helpers&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.0/lib/action\nview/helpers/text_helper.rb:6:in `&lt;module:ActionView&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.0/lib/action\nview/helpers/text_helper.rb:4:in `&lt;top (required)&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.0/lib/action\nview/helpers/form_tag_helper.rb:18:in `&lt;module:FormTagHelper&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.0/lib/action\nview/helpers/form_tag_helper.rb:14:in `&lt;module:Helpers&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.0/lib/action\nview/helpers/form_tag_helper.rb:8:in `&lt;module:ActionView&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.0/lib/action\nview/helpers/form_tag_helper.rb:6:in `&lt;top (required)&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.0/lib/action\nview/helpers/form_helper.rb:4:in `require'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.0/lib/action\nview/helpers/form_helper.rb:4:in `&lt;top (required)&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.0/lib/action\nview/helpers.rb:50:in `&lt;module:Helpers&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.0/lib/action\nview/helpers.rb:4:in `&lt;module:ActionView&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/actionview-4.2.0/lib/action\nview/helpers.rb:3:in `&lt;top (required)&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/sprockets-rails-2.2.4/lib/s\nrockets/rails/legacy_asset_tag_helper.rb:7:in `&lt;module:LegacyAssetTagHelper&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/sprockets-rails-2.2.4/lib/s\nrockets/rails/legacy_asset_tag_helper.rb:6:in `&lt;module:Rails&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/sprockets-rails-2.2.4/lib/s\nrockets/rails/legacy_asset_tag_helper.rb:4:in `&lt;module:Sprockets&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/sprockets-rails-2.2.4/lib/s\nrockets/rails/legacy_asset_tag_helper.rb:3:in `&lt;top (required)&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/sprockets-rails-2.2.4/lib/s\nrockets/rails/helper.rb:45:in `require'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/sprockets-rails-2.2.4/lib/s\nrockets/rails/helper.rb:45:in `&lt;module:Helper&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/sprockets-rails-2.2.4/lib/s\nrockets/rails/helper.rb:7:in `&lt;module:Rails&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/sprockets-rails-2.2.4/lib/s\nrockets/rails/helper.rb:6:in `&lt;module:Sprockets&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/sprockets-rails-2.2.4/lib/s\nrockets/rails/helper.rb:5:in `&lt;top (required)&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/sprockets-rails-2.2.4/lib/s\nrockets/railtie.rb:6:in `require'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/sprockets-rails-2.2.4/lib/s\nrockets/railtie.rb:6:in `&lt;top (required)&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/sass-rails-5.0.1/lib/sass/r\nils/railtie.rb:2:in `require'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/sass-rails-5.0.1/lib/sass/r\nils/railtie.rb:2:in `&lt;top (required)&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/sass-rails-5.0.1/lib/sass/r\nils.rb:11:in `require'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/sass-rails-5.0.1/lib/sass/r\nils.rb:11:in `&lt;top (required)&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/sass-rails-5.0.1/lib/sass-r\nils.rb:1:in `require'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/sass-rails-5.0.1/lib/sass-r\nils.rb:1:in `&lt;top (required)&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/bundler-1.8.5/lib/bundler/r\nntime.rb:76:in `require'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/bundler-1.8.5/lib/bundler/r\nntime.rb:76:in `block (2 levels) in require'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/bundler-1.8.5/lib/bundler/r\nntime.rb:72:in `each'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/bundler-1.8.5/lib/bundler/r\nntime.rb:72:in `block in require'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/bundler-1.8.5/lib/bundler/r\nntime.rb:61:in `each'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/bundler-1.8.5/lib/bundler/r\nntime.rb:61:in `require'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/bundler-1.8.5/lib/bundler.r\n:134:in `require'\n        from C:/Users/USER/Sites/new_cms/config/application.rb:7:in `&lt;top (requ\nred)&gt;'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/railties-4.2.0/lib/rails/co\nmands/commands_tasks.rb:78:in `require'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/railties-4.2.0/lib/rails/co\nmands/commands_tasks.rb:78:in `block in server'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/railties-4.2.0/lib/rails/co\nmands/commands_tasks.rb:75:in `tap'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/railties-4.2.0/lib/rails/co\nmands/commands_tasks.rb:75:in `server'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/railties-4.2.0/lib/rails/co\nmands/commands_tasks.rb:39:in `run_command!'\n        from C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/railties-4.2.0/lib/rails/co\nmands.rb:17:in `&lt;top (required)&gt;'\n        from bin/rails:4:in `require'\n        from bin/rails:4:in `&lt;main&gt;'\n\nC:\\Users\\USER\\Sites\\new_cms&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "associations"], "comments": [{"owner": {"reputation": 2395, "user_id": 1626261, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/v6cN0.jpg?s=128&g=1", "display_name": "Sonalkumar sute", "link": "https://stackoverflow.com/users/1626261/sonalkumar-sute"}, "edited": false, "score": 0, "creation_date": 1426678764, "post_id": 29120586, "comment_id": 46468668, "body": "You can use <code>STI(Single Table Inheritance)</code>, like <code>class User &lt; ActiveRecord::Base</code>, then user can be a <code>class PersonalUser &lt; User</code> or <code>class CompanyUser &lt; User</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1847, "user_id": 1049170, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e6058ebb749df75fcd91c920e49e4cc7?s=128&d=identicon&r=PG", "display_name": "psantos", "link": "https://stackoverflow.com/users/1049170/psantos"}, "edited": false, "score": 0, "creation_date": 1426680315, "post_id": 29121193, "comment_id": 46469641, "body": "Hi @manfergo25,  Whit this I have another question. &quot;Company&quot; and &quot;Personal&quot; are both &quot;Clients Account&quot;, in that way, both must be able to buy services.  If I need to associent the client with the service, can I do this?  class Personal &lt; Account    has_many :services end  and  class Service &lt; ...    belongs_to :account end  ??"}, {"owner": {"reputation": 1019, "user_id": 4663917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6624bc240dea43cc2312b733ad03238e?s=128&d=identicon&r=PG", "display_name": "Papaya Labs", "link": "https://stackoverflow.com/users/4663917/papaya-labs"}, "reply_to_user": {"reputation": 1847, "user_id": 1049170, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e6058ebb749df75fcd91c920e49e4cc7?s=128&d=identicon&r=PG", "display_name": "psantos", "link": "https://stackoverflow.com/users/1049170/psantos"}, "edited": false, "score": 1, "creation_date": 1426682842, "post_id": 29121193, "comment_id": 46471250, "body": "Yes, sure. You can do that!"}, {"owner": {"reputation": 1847, "user_id": 1049170, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e6058ebb749df75fcd91c920e49e4cc7?s=128&d=identicon&r=PG", "display_name": "psantos", "link": "https://stackoverflow.com/users/1049170/psantos"}, "edited": false, "score": 0, "creation_date": 1426684504, "post_id": 29121193, "comment_id": 46472430, "body": "only to be clear... at this case, both will share the same table &quot;clients&quot;, right?"}, {"owner": {"reputation": 1019, "user_id": 4663917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6624bc240dea43cc2312b733ad03238e?s=128&d=identicon&r=PG", "display_name": "Papaya Labs", "link": "https://stackoverflow.com/users/4663917/papaya-labs"}, "reply_to_user": {"reputation": 1847, "user_id": 1049170, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e6058ebb749df75fcd91c920e49e4cc7?s=128&d=identicon&r=PG", "display_name": "psantos", "link": "https://stackoverflow.com/users/1049170/psantos"}, "edited": false, "score": 0, "creation_date": 1426685271, "post_id": 29121193, "comment_id": 46472979, "body": "Yes, the same table &#39;accounts&#39; in db. But you can call &#180;clients&#180;in the business logic and it will return only the accounts object filtering by &#180;Client&#180;. I write an example."}], "tags": [], "owner": {"reputation": 1019, "user_id": 4663917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6624bc240dea43cc2312b733ad03238e?s=128&d=identicon&r=PG", "display_name": "Papaya Labs", "link": "https://stackoverflow.com/users/4663917/papaya-labs"}, "is_accepted": true, "score": 1, "last_activity_date": 1426685329, "last_edit_date": 1426685329, "creation_date": 1426679180, "answer_id": 29121193, "question_id": 29120586, "link": "https://stackoverflow.com/questions/29120586/how-to-deal-with-different-type-of-users-with-rails/29121193#29121193", "title": "How to deal with different type of users with rails?", "body": "<p>The right way is Single Table Inheritance (STI) as Sontya say. </p>\n\n<pre><code>  class Account &lt; ActiveRecord::Base\n  end\n</code></pre>\n\n<p>Then,</p>\n\n<pre><code>  class Client &lt; Account\n  end\n\n  class Provider &lt; Account\n  end\n</code></pre>\n\n<p>You only have to add a type column in 'Account' to contain a string representing the type of the stored object.</p>\n\n<p>For example in a controller you could do this:</p>\n\n<pre><code>account = Client.find(params[:autocomplete_client])     \nparams[:service][:account_id] = account.id\n@service = Service.new(params[:service])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20735, "user_id": 307106, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6a13e655e637138f8d571cec3f9cea76?s=128&d=identicon&r=PG", "display_name": "jrochkind", "link": "https://stackoverflow.com/users/307106/jrochkind"}, "is_accepted": false, "score": 0, "last_activity_date": 1426680921, "creation_date": 1426680921, "answer_id": 29121798, "question_id": 29120586, "link": "https://stackoverflow.com/questions/29120586/how-to-deal-with-different-type-of-users-with-rails/29121798#29121798", "title": "How to deal with different type of users with rails?", "body": "<p>Personally, I think the way you have suggested in your question is the way I'd do it. </p>\n\n<p>While Single Table Inheritance is intellectually better modelling -- I've found STI to be a bit hard to work with and sometimes unreliable in Rails.  And probably won't improve the cleanliness or conciseness of your code all that much in the end anyway. STI is good to keep in mind as an option, if you find the OP approach is not working well as far as allowing you to write clear concise code and it seems STI could work out better. </p>\n\n<p>But I'd start without STI, with just the one Client class, as you've outlined in your question.  If you later add STI, you'd still have the Client class, you'd just have sub-classes for, say, PersonalClient and CompanyClient. It won't be that hard to switch to STI later if you want to, although it might require some minor db schema alterations. </p>\n\n<p>But I don't think it'll get you enough benefit to justify the added complexity, in an area of Rails that has sometimes had some rough edges. </p>\n\n<p>Here's some more info about STI and it's plusses and minuses: <a href=\"http://eewang.github.io/blog/2013/03/12/how-and-when-to-use-single-table-inheritance-in-rails/\" rel=\"nofollow\">http://eewang.github.io/blog/2013/03/12/how-and-when-to-use-single-table-inheritance-in-rails/</a></p>\n"}, {"comments": [{"owner": {"reputation": 1847, "user_id": 1049170, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e6058ebb749df75fcd91c920e49e4cc7?s=128&d=identicon&r=PG", "display_name": "psantos", "link": "https://stackoverflow.com/users/1049170/psantos"}, "edited": false, "score": 0, "creation_date": 1426684558, "post_id": 29122034, "comment_id": 46472476, "body": "in this case I will have only on table &quot;Accounts&quot; right?"}], "tags": [], "owner": {"reputation": 2395, "user_id": 1626261, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/v6cN0.jpg?s=128&g=1", "display_name": "Sonalkumar sute", "link": "https://stackoverflow.com/users/1626261/sonalkumar-sute"}, "is_accepted": false, "score": 1, "last_activity_date": 1426682048, "last_edit_date": 1426682048, "creation_date": 1426681615, "answer_id": 29122034, "question_id": 29120586, "link": "https://stackoverflow.com/questions/29120586/how-to-deal-with-different-type-of-users-with-rails/29122034#29122034", "title": "How to deal with different type of users with rails?", "body": "<p>You can use STI(Single Table Inheritance)</p>\n\n<pre><code>class Account &lt; ActiveRecord::Base\nend\n\nclass Company &lt; Account\n    has_many :services, :dependent =&gt; :destroy\nend\n\nclass Personal &lt; Account\n    has_many :services, :dependent =&gt; :destroy\n\nend\n\nclass Service &lt; ActiveRecord::Base\n    belongs_to: personal\n    belongs_to: company\nend\n</code></pre>\n\n<p>With the above definition, a <code>personal</code> and <code>company</code> should be able to buy services.\nand you should be able to call\n<code>@company.services</code> # it will return you the number of services of company \n<code>@personal.services</code> # it will return you the number of services of personal</p>\n"}], "owner": {"reputation": 1847, "user_id": 1049170, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e6058ebb749df75fcd91c920e49e4cc7?s=128&d=identicon&r=PG", "display_name": "psantos", "link": "https://stackoverflow.com/users/1049170/psantos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 29121193, "answer_count": 3, "score": 1, "last_activity_date": 1426685329, "creation_date": 1426677314, "last_edit_date": 1426680535, "question_id": 29120586, "link": "https://stackoverflow.com/questions/29120586/how-to-deal-with-different-type-of-users-with-rails", "title": "How to deal with different type of users with rails?", "body": "<p>I need to know, if there is a way to deal with different type of users/clients in Rails using a single model.</p>\n\n<p>What I really need to do?\n - I need to save a different type of clients in my database. So, I have this migration:</p>\n\n<pre><code>class CreateClients &lt; ActiveRecord::Migration\n  def change\n    create_table :clients do |t|\n      t.string :name                       # Person name if \"Personal\", Company name if  type \"Company\"\n      t.string :nif                        # fillable only if type is Company\n      t.string :identity_card_number       # fillable only if type is Personal\n      t.integer :client_type               # Type can be Personal or Company\n      t.references :company, index: true   # if type is personal, it can belong to a company\n      t.timestamps null: false\n    end\n  end\nend\n</code></pre>\n\n<p>Then I create this model</p>\n\n<pre><code>class Client &lt; ActiveRecord::Base\n    has_many :employees, class_name: 'Client', foreign_key: 'company_id'\n    belongs_to :company, class_name: 'Client'\nend\n</code></pre>\n\n<p>Note: A personal account can belong to a company or not.</p>\n\n<p>Based on your experience, am I doing this in the right way? There are another way to do that?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Hi @manfergo25,</p>\n\n<p>Whit this I have another question. \"Company\" and \"Personal\" are both \"Clients Account\", in that way, both must be able to buy services.</p>\n\n<p>If I need to associent the client with the service, can I do this?</p>\n\n<pre><code>class Personal &lt; Account\n   has_many :services\nend\n</code></pre>\n\n<p>and</p>\n\n<pre><code>class Service &lt; ...\n   belongs_to :account\nend\n</code></pre>\n\n<p>??</p>\n"}, {"tags": ["ruby", "database", "activerecord", "serialization", "sqlite"], "answers": [{"comments": [{"owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "edited": false, "score": 0, "creation_date": 1426787974, "post_id": 29126935, "comment_id": 46525054, "body": "that works for regular sqlite, thanks, but i would like to dump the activerecord database from my example"}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "reply_to_user": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "edited": false, "score": 0, "creation_date": 1426795054, "post_id": 29126935, "comment_id": 46528704, "body": "Doesn&#39;t <code>::ActiveRecord::Base.connection</code> retrieve the underlying sqlite3 database connection?"}, {"owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "edited": false, "score": 0, "creation_date": 1426869616, "post_id": 29126935, "comment_id": 46561368, "body": "then i get the error i have in my question, I can&#39;t accept your answer because it&#39;s not using Marshal, for the moment i use a solution i&#39;ll publish here as an answer but that i can&#39;t accpet either because of the same reasen"}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "reply_to_user": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "edited": false, "score": 0, "creation_date": 1426871415, "post_id": 29126935, "comment_id": 46562441, "body": "What I meant was: can&#39;t you use the <code>c</code> from the code in your question as the <code>sdb</code> in my answer? Or is <code>c</code> not a sqlite3 database connection? I realize that your question asks to use Marshal, but that seems like a bad idea to me. SQLite and Marshal are both tools designed to save/load data on disk. Mixing them should be unnecessary and is just asking for trouble."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "reply_to_user": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "edited": false, "score": 0, "creation_date": 1426875754, "post_id": 29126935, "comment_id": 46564582, "body": "@peter I found the problem. You need to use <code>raw_connection</code> to get the sqlite3 connection. Then my answer works. I have edited it to reflect this."}], "tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": true, "score": 1, "last_activity_date": 1426875726, "last_edit_date": 1426875726, "creation_date": 1426694615, "answer_id": 29126935, "question_id": 29120380, "link": "https://stackoverflow.com/questions/29120380/dump-a-sqlite-memory-database-to-disk-with-marshal/29126935#29126935", "title": "Dump a Sqlite memory database to disk with Marshal", "body": "<p>You can use sqlite3's <a href=\"http://www.rubydoc.info/gems/sqlite3/SQLite3/Backup\" rel=\"nofollow\">Backup</a> class.</p>\n\n<pre><code># populate ActiveRecord here...\n\nsdb = ::ActiveRecord::Base.connection.raw_connection\n\nddb = SQLite3::Database.new('backup.sqlite3')\n\nb = SQLite3::Backup.new(ddb, 'main', sdb, 'main')\nb.step(-1)\nb.finish\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15789, "user_id": 722804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3qBY9.png?s=128&g=1", "display_name": "Terry Jan Reedy", "link": "https://stackoverflow.com/users/722804/terry-jan-reedy"}, "edited": false, "score": 0, "creation_date": 1426967454, "post_id": 29171701, "comment_id": 46589532, "body": "Please use the edit link on your question to add additional information. The Post Answer button should be used only for complete answers to the question."}, {"owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "reply_to_user": {"reputation": 15789, "user_id": 722804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3qBY9.png?s=128&g=1", "display_name": "Terry Jan Reedy", "link": "https://stackoverflow.com/users/722804/terry-jan-reedy"}, "edited": false, "score": 0, "creation_date": 1427036569, "post_id": 29171701, "comment_id": 46604620, "body": "that would be disordered wouldn&#39;t it, besides it is was a possible answer if nothing better showed up, so i disagree"}], "tags": [], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "is_accepted": false, "score": 0, "last_activity_date": 1426869895, "creation_date": 1426869895, "answer_id": 29171701, "question_id": 29120380, "link": "https://stackoverflow.com/questions/29120380/dump-a-sqlite-memory-database-to-disk-with-marshal/29171701#29171701", "title": "Dump a Sqlite memory database to disk with Marshal", "body": "<p>For the moment i use the following method, it is't a correct answer on my question so I'll leave it open, perhaps someone does find a solution using Marshal\nHere I open a second connection to a disk database and load and write to that connection before and after.</p>\n\n<pre><code>require 'sqlite3'\nrequire 'active_record'\n\nclass Test &lt; ActiveRecord::Base\n  establish_connection(\n    :adapter  =&gt; \"sqlite3\",\n    :database =&gt; \":memory:\"\n  )\nend\n\nclass Test2 &lt; ActiveRecord::Base\n  establish_connection(\n    :adapter  =&gt; \"sqlite3\",\n    :database =&gt; \"testing.db\"\n  )\n  self.table_name    = :tests\nend\n\ndef db_load\n  ActiveRecord::Schema.define do\n    @connection = Test.connection\n    create_table :tests do |table|\n      table.column :word, :string\n    end\n  end\n  Test2.all.each do |m|\n    Test.create m.attributes\n  end\nend\n\ndef db_write\n  Test2.delete_all\n  Test.all.each do |m|\n    Test2.create m.attributes\n  end\nend\n\ndef db_test klasse\n  klasse.all.each do |record|\n    p record\n  end\nend\n\ndb_load\ndb_test Test\nTest.create(word: 'test3')\ndb_write\ndb_test Test2\n</code></pre>\n\n<p>gives</p>\n\n<pre><code>-- create_table(:tests)\n   -&gt; 0.0060s\n#&lt;Test id: 1, word: \"test\"&gt;\n#&lt;Test id: 2, word: \"test2\"&gt;\n#&lt;Test2 id: 1, word: \"test\"&gt;\n#&lt;Test2 id: 2, word: \"test2\"&gt;\n#&lt;Test2 id: 3, word: \"test3\"&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "is_accepted": false, "score": 0, "last_activity_date": 1426870199, "creation_date": 1426870199, "answer_id": 29171798, "question_id": 29120380, "link": "https://stackoverflow.com/questions/29120380/dump-a-sqlite-memory-database-to-disk-with-marshal/29171798#29171798", "title": "Dump a Sqlite memory database to disk with Marshal", "body": "<p>Here an example of the technique Max proposed.\nIt's not using Marshal and not for Activerecord but ussefull, so here for reference</p>\n\n<pre><code>require 'sqlite3'\nrequire 'active_record'\n\nActiveRecord::Base.establish_connection(:adapter =&gt; \"sqlite3\",:database  =&gt; \":memory:\")\n\nsdb = SQLite3::Database.new(':memory:')\n\nsdb.execute \"CREATE TABLE IF NOT EXISTS Cars(Id INTEGER PRIMARY KEY, Name TEXT, Price INT)\"\nsdb.execute \"INSERT INTO Cars VALUES(1,'Audi',52642)\"\nsdb.execute \"INSERT INTO Cars VALUES(2,'Mercedes',57127)\"\nsdb.execute \"INSERT INTO Cars VALUES(3,'Skoda',9000)\"\nsdb.execute \"INSERT INTO Cars VALUES(4,'Volvo',29000)\"\nsdb.execute \"INSERT INTO Cars VALUES(5,'Bentley',350000)\"\nsdb.execute \"INSERT INTO Cars VALUES(6,'Citroen',21000)\"\nsdb.execute \"INSERT INTO Cars VALUES(7,'Hummer',41400)\"\nsdb.execute \"INSERT INTO Cars VALUES(8,'Volkswagen',21600)\"\n\n\nddb = SQLite3::Database.new('backup.sqlite3')\n\nb = SQLite3::Backup.new(ddb, 'main', sdb, 'main')\nb.step(-1)\nb.finish\n\nstm = ddb.prepare \"SELECT * FROM Cars LIMIT 5\" \nrs = stm.execute \n\nrs.each do |row|\n  puts row.join \"\\s\"\nend\n</code></pre>\n\n<p>gives</p>\n\n<pre><code>1 Audi 52642\n2 Mercedes 57127\n3 Skoda 9000\n4 Volvo 29000\n5 Bentley 350000\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "is_accepted": false, "score": 0, "last_activity_date": 1426951277, "creation_date": 1426951277, "answer_id": 29184396, "question_id": 29120380, "link": "https://stackoverflow.com/questions/29120380/dump-a-sqlite-memory-database-to-disk-with-marshal/29184396#29184396", "title": "Dump a Sqlite memory database to disk with Marshal", "body": "<p>Here for reference and completeness the final solution based on Max edited answer</p>\n\n<pre><code>require 'sqlite3'\nrequire 'active_record'\n\nActiveRecord::Base.establish_connection(\n  :adapter =&gt; \"sqlite3\",\n  :database  =&gt; \":memory:\"\n)\n\nActiveRecord::Schema.define do\n  create_table :tests do |table|\n    table.column :word, :string\n    table.column :index, :string\n  end\nend\n\nclass Test &lt; ActiveRecord::Base;end\nTest.create(word: 'test', index: 0)\nTest.create(word: 'test2', index: 1)\n\nsdb = ::ActiveRecord::Base.connection.raw_connection\nddb = SQLite3::Database.new('backup_sqlite3.db')\n\nbackup = SQLite3::Backup.new(ddb, 'main', sdb, 'main')\nbackup.step(-1)\nbackup.finish\n\nddb.execute(\"select * from tests\").each do |record|\n  p record\nend\n</code></pre>\n"}], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1051, "favorite_count": 1, "accepted_answer_id": 29126935, "answer_count": 4, "score": 1, "last_activity_date": 1426951277, "creation_date": 1426676711, "last_edit_date": 1426869948, "question_id": 29120380, "link": "https://stackoverflow.com/questions/29120380/dump-a-sqlite-memory-database-to-disk-with-marshal", "title": "Dump a Sqlite memory database to disk with Marshal", "body": "<p>I would like to dump a Sqlite memory database to disk with Marshal but get the error below, here the complete test. The Sqlite API for saving in memory databases seems to be only usable in C.</p>\n\n<pre><code>require 'sqlite3'\nrequire 'active_record'\n\nActiveRecord::Base.establish_connection(\n:adapter =&gt; \"sqlite3\",\n:database  =&gt; \":memory:\"\n)\n\nActiveRecord::Schema.define do\n  create_table :tests do |table|\n    table.column :word, :string\n  end\nend\n\nclass Test &lt; ActiveRecord::Base;end\nTest.create(word: 'test')\n\nputs Test.all.length\nc = ::ActiveRecord::Base.connection\nFile.open('sqlite_db.marshal','wb') { |f| f.write(Marshal.dump(c)) }\n# =&gt; error `dump': can't dump hash with default proc (TypeError)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 8871, "user_id": 4381282, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-rIutmC2tG4M/AAAAAAAAAAI/AAAAAAAAAE4/wicIrC8KhUs/photo.jpg?sz=128", "display_name": "Pawe\u0142 Dawczak", "link": "https://stackoverflow.com/users/4381282/pawe%c5%82-dawczak"}, "edited": false, "score": 1, "creation_date": 1426675654, "post_id": 29119720, "comment_id": 46466731, "body": "<i>demo2/app/views</i>? The template should be placed under <i>demo2/app/views/application</i>. Can you give it a try?"}, {"owner": {"reputation": 24729, "user_id": 2564200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a92dfcc9fcac72dabd4b1eefa0b5106e?s=128&d=identicon&r=PG&f=1", "display_name": "Santhosh", "link": "https://stackoverflow.com/users/2564200/santhosh"}, "edited": false, "score": 0, "creation_date": 1426680022, "post_id": 29119720, "comment_id": 46469439, "body": "When do you get this error? when you go to <code>localhost:3000</code> or when you click on the link?"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 4657589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dc8327c4284c080e3714dfa2bec1f85?s=128&d=identicon&r=PG&f=1", "display_name": "Adri&#225;n Fern&#225;ndez", "link": "https://stackoverflow.com/users/4657589/adri%c3%a1n-fern%c3%a1ndez"}, "is_accepted": false, "score": 1, "last_activity_date": 1426699720, "creation_date": 1426699720, "answer_id": 29128791, "question_id": 29119720, "link": "https://stackoverflow.com/questions/29119720/rails-missing-template-from-link-to-and-send-file/29128791#29128791", "title": "rails missing template from link_to and send_file", "body": "<p>Add <code>and return</code> after send_file in order to avoid rendering view.</p>\n\n<pre><code>send_file(\"/home/Documents/workspace/demo.txt\", :type =&gt; \"text/html\", :disposition =&gt; 'inline') and return\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 4272975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9f069cd3c7fe6d77966cb46b65c555d?s=128&d=identicon&r=PG&f=1", "display_name": "amateur-coder", "link": "https://stackoverflow.com/users/4272975/amateur-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1139, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426699720, "creation_date": 1426674935, "question_id": 29119720, "link": "https://stackoverflow.com/questions/29119720/rails-missing-template-from-link-to-and-send-file", "title": "rails missing template from link_to and send_file", "body": "<p>I am trying to display the contents of a Log file, a txt file in html.\nI get 'Template missing error'.</p>\n\n<pre><code>Missing template application/index with {:locale=&gt;[:en], :formats=&gt;[:html], :handlers=&gt;[:erb, :builder, :raw, :ruby, :jbuilder, :coffee]}. Searched in: * \"/home/Documents/workspace/demo2/app/views\"\n</code></pre>\n\n<p>In my controller I have</p>\n\n<pre><code> class ApplicationController &lt; ActionController::Base\n  def index\n  end\n  def displaycontents\n  send_file \"/home/Documents/workspace/demo.txt\", \n          :type =&gt; \"text/html\", \n          :disposition =&gt; 'inline'\n  end\n end\n</code></pre>\n\n<p>In my routes.rb I have</p>\n\n<pre><code>root 'application#index'\n</code></pre>\n\n<p>In my index.html.erb I have</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n &lt;title&gt;new view&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n  &lt;%= link_to \"Log File\", :controller=&gt; :application,\n    :action=&gt;:displaycontents %&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>I have kept the index action in the controller file empty so the index.html.erb is rendered by default.</p>\n\n<p>I have restarted the rails server as suggested by another solution.\nAnd the index.html.erb file is present in demo2/app/views .</p>\n\n<p>The different verions I have used are\n- RUBYGEMS VERSION: 1.8.23\n  - RUBY VERSION: 1.9.3 \n-Rails : 4.0.2</p>\n"}, {"tags": ["ruby", "regex", "string", "string-split"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1426699370, "post_id": 29119719, "comment_id": 46483102, "body": "Good question and well-written: succinct, complete, unambiguous."}], "answers": [{"comments": [{"owner": {"reputation": 388, "user_id": 4101627, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/148965f5266366de678d4295eed74ec9?s=128&d=identicon&r=PG&f=1", "display_name": "NickEckhart", "link": "https://stackoverflow.com/users/4101627/nickeckhart"}, "edited": false, "score": 1, "creation_date": 1426675155, "post_id": 29119759, "comment_id": 46466392, "body": "Wow, that was prompt! Tried it in irb and works like a charm! Thanks so much, I&#39;ll accept the answer in 12 minutes :)"}, {"owner": {"reputation": 7251, "user_id": 2493089, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c34c815a19c6a2f6ed200cbd95503682?s=128&d=identicon&r=PG", "display_name": "SHS", "link": "https://stackoverflow.com/users/2493089/shs"}, "edited": false, "score": 0, "creation_date": 1426676379, "post_id": 29119759, "comment_id": 46467223, "body": "avinash, if the string will have only digits and alphabets, it would be best to stick with <code>\\d</code> and <code>\\D</code> to keep the expression simple. like in my response. :)"}, {"owner": {"reputation": 159902, "user_id": 3297613, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/KHhzd.jpg?s=128&g=1", "display_name": "Avinash Raj", "link": "https://stackoverflow.com/users/3297613/avinash-raj"}, "edited": false, "score": 0, "creation_date": 1426676571, "post_id": 29119759, "comment_id": 46467363, "body": "op clearly mention that his string must satisfy <code>[0-9]+[a-zA-z]*</code> pattern. Changing <code>[A-Za-z]+</code> to <code>\\D+</code> won&#39;t much more difference."}, {"owner": {"reputation": 7251, "user_id": 2493089, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c34c815a19c6a2f6ed200cbd95503682?s=128&d=identicon&r=PG", "display_name": "SHS", "link": "https://stackoverflow.com/users/2493089/shs"}, "edited": false, "score": 0, "creation_date": 1426676873, "post_id": 29119759, "comment_id": 46467561, "body": "since we know the string will have only digits and alphabets, using <code>\\d</code> and <code>\\D</code> keeps things simple and readable. as an argument: 3 and 4 can be added using <code>3 + 4</code> or <code>1 + 1 + 1 + 4</code>. results are the same. but simplicity is preferred."}], "tags": [], "owner": {"reputation": 159902, "user_id": 3297613, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/KHhzd.jpg?s=128&g=1", "display_name": "Avinash Raj", "link": "https://stackoverflow.com/users/3297613/avinash-raj"}, "is_accepted": true, "score": 9, "last_activity_date": 1426676009, "last_edit_date": 1426676009, "creation_date": 1426675049, "answer_id": 29119759, "question_id": 29119719, "link": "https://stackoverflow.com/questions/29119719/split-a-string-into-a-string-and-an-integer/29119759#29119759", "title": "Split a string into a string and an integer", "body": "<p>Use a positive lookbehind assertion based regex in <code>string.split</code>.</p>\n\n<pre><code>&gt; \"10480ABCD\".split(/(?&lt;=\\d)(?=[A-Za-z])/)\n=&gt; [\"10480\", \"ABCD\"]\n</code></pre>\n\n<ul>\n<li><p><code>(?&lt;=\\d)</code> Positive lookbehind which asserts that the match must be preceded by a digit character.</p></li>\n<li><p><code>(?=[A-Za-z])</code> which asserts that the match must be followed by an alphabet. So the above regex would match the boundary which exists between a digit and an alphabet. Splitting your input according to the matched boundary will give you the desired output.</p></li>\n</ul>\n\n<p><strong>OR</strong></p>\n\n<p>Use <code>string.scan</code></p>\n\n<pre><code>&gt; \"10480ABCD\".scan(/\\d+|[A-Za-z]+/)\n=&gt; [\"10480\", \"ABCD\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 0, "last_activity_date": 1426676569, "creation_date": 1426676569, "answer_id": 29120313, "question_id": 29119719, "link": "https://stackoverflow.com/questions/29119719/split-a-string-into-a-string-and-an-integer/29120313#29120313", "title": "Split a string into a string and an integer", "body": "<p>You can always use <a href=\"http://ruby-doc.org/core-2.1.1/Regexp.html#method-i-match\" rel=\"nofollow\"><code>match</code></a>:</p>\n\n<pre><code>re = /(\\d+)([a-z]*)/i\nstr = \"10480ABCD\"\n\nm = re.match(str)\nm    #=&gt; #&lt;MatchData \"10480ABCD\" 1:\"10480\" 2:\"ABCD\"&gt;\nm[0] #=&gt; \"10480\"\nm[1] #=&gt; \"ABCD\"\n</code></pre>\n\n<p>Use <a href=\"http://ruby-doc.org/core-2.2.1/MatchData.html#method-i-5B-5D\" rel=\"nofollow\"><code>MatchData#[]</code></a> to extract capture groups:</p>\n\n<pre><code>re.match(str)[1, 2]\n[\"10480\", \"ABCD\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1426698198, "post_id": 29120528, "comment_id": 46482348, "body": "Clever. Puzzled readers (if any): one line of the docs for <a href=\"http://ruby-doc.org/core-2.2.0/String.html#method-i-split\" rel=\"nofollow noreferrer\">String#split</a> reads, &quot;If pattern contains [capture] groups, the respective matches will be returned in the array as well.&quot;"}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 7, "last_activity_date": 1426677173, "creation_date": 1426677173, "answer_id": 29120528, "question_id": 29119719, "link": "https://stackoverflow.com/questions/29119719/split-a-string-into-a-string-and-an-integer/29120528#29120528", "title": "Split a string into a string and an integer", "body": "<p>The splitter is the non-numerical characters themselves:</p>\n\n<pre><code>\"10480ABCD\".split(/(\\D+)/)\n# =&gt; [\"10480\", \"ABCD\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1426699917, "last_edit_date": 1426699917, "creation_date": 1426697762, "answer_id": 29128100, "question_id": 29119719, "link": "https://stackoverflow.com/questions/29119719/split-a-string-into-a-string-and-an-integer/29128100#29128100", "title": "Split a string into a string and an integer", "body": "<p>[Edit: for some reason @Humza deleted his answer, so I've undeleted mine. I had previously posted this, but then deleted it when I noticed that Humza had already posted a similar answer.]</p>\n\n<p>I feel like I must be missing something, as it seems to have a straightforward solution:</p>\n\n<pre><code>def extract(str)\n  str.scan(/\\d+|[A-Z]+/i)\nend\n\nextract \"15791\"     #=&gt; [\"15791\"] \nextract \"14810A\"    #=&gt; [\"14810\", \"A\"] \nextract \"10480ABCD\" #=&gt; [\"10480\", \"ABCD\"]\nextract \"5ABCDEFGH\" #=&gt; [\"5\", \"ABCDEFGH\"] \n</code></pre>\n"}], "owner": {"reputation": 388, "user_id": 4101627, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/148965f5266366de678d4295eed74ec9?s=128&d=identicon&r=PG&f=1", "display_name": "NickEckhart", "link": "https://stackoverflow.com/users/4101627/nickeckhart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3152, "favorite_count": 1, "accepted_answer_id": 29119759, "answer_count": 4, "score": 2, "last_activity_date": 1426699917, "creation_date": 1426674934, "last_edit_date": 1426677426, "question_id": 29119719, "link": "https://stackoverflow.com/questions/29119719/split-a-string-into-a-string-and-an-integer", "title": "Split a string into a string and an integer", "body": "<p>I have several strings that contain one or more digits and may also contain one or more letters following the digits (caps on letters don't matter). The strings follow the following regex pattern:</p>\n\n<pre><code>[0-9]+[a-zA-z]*\n</code></pre>\n\n<p>and may look like:</p>\n\n<pre><code>\"15791\"\n\"14810A\"\n\"10480ABCD\"\n\"5ABCDEFGH\"\n</code></pre>\n\n<p>If one of the strings above contains non-numerical characters, how do I split the numbers (first part) into an integer and the letters (second part) into a string?</p>\n\n<p>I know I can split a string like this:</p>\n\n<pre><code>array = \"1,2,3,4\".split(',')\n</code></pre>\n\n<p>But this doesn't help since I don't have a separator.</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 24966, "user_id": 2001031, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bd4f0d39f82be9c22f6f01c80d7ad800?s=128&d=identicon&r=PG", "display_name": "Neil Slater", "link": "https://stackoverflow.com/users/2001031/neil-slater"}, "edited": false, "score": 0, "creation_date": 1426675013, "post_id": 29119337, "comment_id": 46466312, "body": "What &quot;laziness operator&quot; are you using? <code>&#47;(http:\\&#47;\\&#47;example.com.*?)\\)&#47;</code> works just fine for me."}], "answers": [{"tags": [], "owner": {"reputation": 159902, "user_id": 3297613, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/KHhzd.jpg?s=128&g=1", "display_name": "Avinash Raj", "link": "https://stackoverflow.com/users/3297613/avinash-raj"}, "is_accepted": false, "score": 0, "last_activity_date": 1426679715, "last_edit_date": 1426679715, "creation_date": 1426673930, "answer_id": 29119372, "question_id": 29119337, "link": "https://stackoverflow.com/questions/29119337/why-does-my-regex-appear-to-be-greedy-even-when-i-ask-it-to-be-lazy/29119372#29119372", "title": "Why does my regex appear to be greedy even when I ask it to be lazy?", "body": "<p>Use a negated character class like <code>[^\\s)]*</code> which matches any character but not of a space or <code>)</code>, zero or more times.</p>\n\n<pre><code>&gt; \"Here's my user profile (http://example.com/user/420), it's good. :)\".match(/\\bhttp:\\/\\/example\\.com\\b[^\\s)]*/)[0]\n=&gt; \"http://example.com/user/420\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2162, "user_id": 3204212, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/fd870d2b3afe56cd9c59c28c0fc715bd?s=128&d=identicon&r=PG&f=1", "display_name": "GreenTriangle", "link": "https://stackoverflow.com/users/3204212/greentriangle"}, "edited": false, "score": 0, "creation_date": 1426674594, "post_id": 29119456, "comment_id": 46466065, "body": "thanks for this reply. It does work in your example, unfortunately I didn&#39;t provide enough context in my post. The URL isn&#39;t always in parentheses. It could be <code>my user profile at http:&#47;&#47;example.com&#47;user&#47;600</code> too, so I can&#39;t <i>rely on</i> the parentheses being there."}, {"owner": {"reputation": 19585, "user_id": 3115685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/206073fe8f46ef1f9261d75c80c19c6f?s=128&d=identicon&r=PG&f=1", "display_name": "arco444", "link": "https://stackoverflow.com/users/3115685/arco444"}, "reply_to_user": {"reputation": 2162, "user_id": 3204212, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/fd870d2b3afe56cd9c59c28c0fc715bd?s=128&d=identicon&r=PG&f=1", "display_name": "GreenTriangle", "link": "https://stackoverflow.com/users/3204212/greentriangle"}, "edited": false, "score": 2, "creation_date": 1426674774, "post_id": 29119456, "comment_id": 46466166, "body": "You should update the question to highlight this. So how will you determine the end of the URL then? Even the other answer requires an end point to the capture pattern. Can the URL contain spaces?"}, {"owner": {"reputation": 2162, "user_id": 3204212, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/fd870d2b3afe56cd9c59c28c0fc715bd?s=128&d=identicon&r=PG&f=1", "display_name": "GreenTriangle", "link": "https://stackoverflow.com/users/3204212/greentriangle"}, "edited": false, "score": 0, "creation_date": 1426678023, "post_id": 29119456, "comment_id": 46468219, "body": "Yeah, I&#39;ll update the post. I suppose the URL would be terminated by any non-URL-legal character, like a space."}], "tags": [], "owner": {"reputation": 19585, "user_id": 3115685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/206073fe8f46ef1f9261d75c80c19c6f?s=128&d=identicon&r=PG&f=1", "display_name": "arco444", "link": "https://stackoverflow.com/users/3115685/arco444"}, "is_accepted": false, "score": 2, "last_activity_date": 1426674203, "creation_date": 1426674203, "answer_id": 29119456, "question_id": 29119337, "link": "https://stackoverflow.com/questions/29119337/why-does-my-regex-appear-to-be-greedy-even-when-i-ask-it-to-be-lazy/29119456#29119456", "title": "Why does my regex appear to be greedy even when I ask it to be lazy?", "body": "<p>The lazy operator works fine:</p>\n\n<pre><code>irb&gt; m = \"Here's my user profile (http://example.com/user/5316), it's good. :)\".match(/(http:\\/\\/example.com.*?)\\)/)\n=&gt; #&lt;MatchData \"http://example.com/user/5316)\" 1:\"http://example.com/user/5316\"&gt;\nirb&gt; m[1]\n=&gt; \"http://example.com/user/5316\"\n</code></pre>\n\n<p>The regex should be <code>/(http:\\/\\/example.com.*?)\\)/</code> - the lazy operator is the inclusion of the <code>?</code></p>\n"}, {"comments": [{"owner": {"reputation": 2162, "user_id": 3204212, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/fd870d2b3afe56cd9c59c28c0fc715bd?s=128&d=identicon&r=PG&f=1", "display_name": "GreenTriangle", "link": "https://stackoverflow.com/users/3204212/greentriangle"}, "edited": false, "score": 0, "creation_date": 1426718904, "post_id": 29120286, "comment_id": 46493821, "body": "This picks up the parenthesis <i>and</i> the comma."}], "tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 1, "last_activity_date": 1426676524, "creation_date": 1426676524, "answer_id": 29120286, "question_id": 29119337, "link": "https://stackoverflow.com/questions/29119337/why-does-my-regex-appear-to-be-greedy-even-when-i-ask-it-to-be-lazy/29120286#29120286", "title": "Why does my regex appear to be greedy even when I ask it to be lazy?", "body": "<pre><code>require \"uri\"\n\nstr = \"Here's my user profile (http://example.com/user/5316), it's good. :)\"\np URI.extract(str)\n</code></pre>\n"}], "owner": {"reputation": 2162, "user_id": 3204212, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/fd870d2b3afe56cd9c59c28c0fc715bd?s=128&d=identicon&r=PG&f=1", "display_name": "GreenTriangle", "link": "https://stackoverflow.com/users/3204212/greentriangle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1426679715, "creation_date": 1426673811, "last_edit_date": 1426675710, "question_id": 29119337, "link": "https://stackoverflow.com/questions/29119337/why-does-my-regex-appear-to-be-greedy-even-when-i-ask-it-to-be-lazy", "title": "Why does my regex appear to be greedy even when I ask it to be lazy?", "body": "<p>I am using Ruby 2.1.</p>\n\n<p>My string is <code>\"Here's my user profile (http://example.com/user/5316), it's good. :)\"</code></p>\n\n<p>I want to capture just the URL in parentheses. </p>\n\n<p>My first effort is <code>/(http:\\/\\/example.com.*)\\)/</code>. example.com, and then any character, ending when a closing parentheses is encountered. But nope, that doesn't work. Maybe it's being greedy, I think, and being lazy would help. But appending the laziness operator doesn't help. I try using <code>[)]</code> instead of <code>\\)</code>, but that doesn't help either. I'm kind of stumped.</p>\n\n<p>What have I done wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "model", "ruby-on-rails-4.2"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 4, "creation_date": 1426672854, "post_id": 29118973, "comment_id": 46464961, "body": "You can always override <code>destroy</code> method in this model."}, {"owner": {"reputation": 45252, "user_id": 326389, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d2c037ce48d12bd88ec6529f9bb39f0a?s=128&d=identicon&r=PG", "display_name": "at.", "link": "https://stackoverflow.com/users/326389/at"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1426672891, "post_id": 29118973, "comment_id": 46464986, "body": "@MarekLipka - is that the proper way to deal with this? There&#39;s no other way to destroy a model record?"}, {"owner": {"reputation": 32682, "user_id": 120518, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/edf1077f9152b361937f12707e3af891?s=128&d=identicon&r=PG", "display_name": "Shadwell", "link": "https://stackoverflow.com/users/120518/shadwell"}, "edited": false, "score": 2, "creation_date": 1426673157, "post_id": 29118973, "comment_id": 46465158, "body": "You might need to watch out for <code>delete</code> too : <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Persistence.html#method-i-delete\" rel=\"nofollow noreferrer\">api.rubyonrails.org/classes/ActiveRecord/&hellip;</a>"}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1426673234, "post_id": 29118973, "comment_id": 46465203, "body": "There&#39;s always other way to destroy a model record from DB. You can also override public <code>delete</code> method, but you still can destroy your record, with <code>delete_all</code> for example, or you can call private <code>destroy_row</code> method etc."}, {"owner": {"reputation": 1506, "user_id": 3414150, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/tASIO.jpg?s=128&g=1", "display_name": "lx00st", "link": "https://stackoverflow.com/users/3414150/lx00st"}, "edited": false, "score": 0, "creation_date": 1426673244, "post_id": 29118973, "comment_id": 46465214, "body": "Also you can use before_desrtoy callback"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1426675828, "post_id": 29118973, "comment_id": 46466859, "body": "It might be easier to handle this at the database level, e.g. setting up a user without <code>DELETE</code> privilege or using a <code>BEFORE DELETE</code> trigger in MySQL."}], "answers": [{"comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1426674749, "post_id": 29119529, "comment_id": 46466146, "body": "You don&#39;t have to override <code>destroy_all</code> if you already overrode <code>destroy</code>. If you return falsy value from <code>before_destroy</code>, it would also prevent model from destroying."}, {"owner": {"reputation": 45252, "user_id": 326389, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d2c037ce48d12bd88ec6529f9bb39f0a?s=128&d=identicon&r=PG", "display_name": "at.", "link": "https://stackoverflow.com/users/326389/at"}, "edited": false, "score": 0, "creation_date": 1426733710, "post_id": 29119529, "comment_id": 46497759, "body": "Seems like <code>before_destroy</code> throwing an exception is the way to go. The <code>User.first.destroy</code> was just an example. I don&#39;t want <b><i>any</i></b> <code>User</code>s being destroyed, doesn&#39;t matter if they&#39;re the first or the last."}], "tags": [], "owner": {"reputation": 7251, "user_id": 2493089, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c34c815a19c6a2f6ed200cbd95503682?s=128&d=identicon&r=PG", "display_name": "SHS", "link": "https://stackoverflow.com/users/2493089/shs"}, "is_accepted": false, "score": 4, "last_activity_date": 1426675860, "last_edit_date": 1426675860, "creation_date": 1426674412, "answer_id": 29119529, "question_id": 29118973, "link": "https://stackoverflow.com/questions/29118973/making-a-model-undeletable-in-rails/29119529#29119529", "title": "Making a model undeletable in Rails", "body": "<p>IMO you should assign a <code>before_destroy</code> callback that raises an error.</p>\n\n<pre><code>class Model &lt; ActiveRecord::Base\n  before_destroy :nope\n\n  private\n\n  def nope\n    raise \"nope!\" if (id == 1)\n  end\nend\n</code></pre>\n\n<p>If raising an error is unacceptable (in case it halts other operations), you'd have to define your own <code>destroy</code>:</p>\n\n<pre><code>class Model &lt; ActiveRecord::Base\n  def destroy\n    super if should_destroy?\n  end\n\n  def should_destroy?\n    id != 1\n  end\nend\n</code></pre>\n\n<p>The <code>before_destroy</code> will intercept <code>destroy_all</code> too.</p>\n\n<p>But the following will help in intercepting <code>destroy_all</code> more explicitly:</p>\n\n<pre><code>class Model &lt; ActiveRecord::Base\n  class ActiveRecord_Relation\n    def destroy_all\n      where(id: 1).exists? ? raise(\"nope!\") : super\n    end\n  end\nend\n\nModel.where(id: 1).destroy_all #=&gt; nope! (nothing gets destroyed)\nModel.where(id: [1, 2]).destroy_all #=&gt; nope! (nothing gets destroyed)\nModel.where(id: 2).destroy_all #=&gt; destruction!!! carnage! HAVOC!\n</code></pre>\n\n<p>And an error-free implementation:</p>\n\n<pre><code>class Model &lt; ActiveRecord::Base\n  class ActiveRecord_Relation\n    def destroy_all\n      err_id = 1\n      return super unless where(id: err_id).exists?\n\n      ids = pluck(:id) - [err_id]\n      where(id: ids).destroy_all\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 45252, "user_id": 326389, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d2c037ce48d12bd88ec6529f9bb39f0a?s=128&d=identicon&r=PG", "display_name": "at.", "link": "https://stackoverflow.com/users/326389/at"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 624, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1426675860, "creation_date": 1426672768, "question_id": 29118973, "link": "https://stackoverflow.com/questions/29118973/making-a-model-undeletable-in-rails", "title": "Making a model undeletable in Rails", "body": "<p>What is the proper way to ensure nobody can delete a model record in Rails through either a console or through some controller that tries to call <code>model.destroy</code>? Or even through trying to destroy an object that has <code>dependent: :destroy</code> set on the relationship to this undeletable model.</p>\n\n<p>This should never work:</p>\n\n<pre><code>User.first.destroy\n</code></pre>\n\n<p>I never want certain models to go missing under any circumstances (aside from, of course, going directly to the database or altering the Ruby code).</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 339, "user_id": 4626222, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0189dabcf1e6fc8e2db02dc156bea687?s=128&d=identicon&r=PG&f=1", "display_name": "Flynt Hamlock", "link": "https://stackoverflow.com/users/4626222/flynt-hamlock"}, "edited": false, "score": 0, "creation_date": 1426673602, "post_id": 29119035, "comment_id": 46465450, "body": "Your method looks a lot better, but unfortunately the index file remains the same. Am I missing something?"}, {"owner": {"reputation": 8871, "user_id": 4381282, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-rIutmC2tG4M/AAAAAAAAAAI/AAAAAAAAAE4/wicIrC8KhUs/photo.jpg?sz=128", "display_name": "Pawe\u0142 Dawczak", "link": "https://stackoverflow.com/users/4381282/pawe%c5%82-dawczak"}, "reply_to_user": {"reputation": 339, "user_id": 4626222, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0189dabcf1e6fc8e2db02dc156bea687?s=128&d=identicon&r=PG&f=1", "display_name": "Flynt Hamlock", "link": "https://stackoverflow.com/users/4626222/flynt-hamlock"}, "edited": false, "score": 0, "creation_date": 1426674234, "post_id": 29119035, "comment_id": 46465841, "body": "@FlyntHamlock - You are absolutely right! I&#39;ve just updated my answer! (plus some shorter syntax is used). Apologies for confusion!"}, {"owner": {"reputation": 339, "user_id": 4626222, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0189dabcf1e6fc8e2db02dc156bea687?s=128&d=identicon&r=PG&f=1", "display_name": "Flynt Hamlock", "link": "https://stackoverflow.com/users/4626222/flynt-hamlock"}, "edited": false, "score": 0, "creation_date": 1426674344, "post_id": 29119035, "comment_id": 46465918, "body": "Awesome - thanks! Is there a way to not remove the <code>&lt;!--start--&gt;</code> and <code>&lt;!--end--&gt;</code> though?"}, {"owner": {"reputation": 8871, "user_id": 4381282, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-rIutmC2tG4M/AAAAAAAAAAI/AAAAAAAAAE4/wicIrC8KhUs/photo.jpg?sz=128", "display_name": "Pawe\u0142 Dawczak", "link": "https://stackoverflow.com/users/4381282/pawe%c5%82-dawczak"}, "reply_to_user": {"reputation": 339, "user_id": 4626222, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0189dabcf1e6fc8e2db02dc156bea687?s=128&d=identicon&r=PG&f=1", "display_name": "Flynt Hamlock", "link": "https://stackoverflow.com/users/4626222/flynt-hamlock"}, "edited": false, "score": 0, "creation_date": 1426675525, "post_id": 29119035, "comment_id": 46466653, "body": "@FlyntHamlock - Sure you can! Check my answer updated! (also, take a look at this <a href=\"http://stackoverflow.com/questions/118839/gsub-partial-replace\">answer</a>). Good luck!"}, {"owner": {"reputation": 339, "user_id": 4626222, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0189dabcf1e6fc8e2db02dc156bea687?s=128&d=identicon&r=PG&f=1", "display_name": "Flynt Hamlock", "link": "https://stackoverflow.com/users/4626222/flynt-hamlock"}, "edited": false, "score": 0, "creation_date": 1426675686, "post_id": 29119035, "comment_id": 46466752, "body": "Absolutely gorgeous! Thanks again!"}], "tags": [], "owner": {"reputation": 8871, "user_id": 4381282, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-rIutmC2tG4M/AAAAAAAAAAI/AAAAAAAAAE4/wicIrC8KhUs/photo.jpg?sz=128", "display_name": "Pawe\u0142 Dawczak", "link": "https://stackoverflow.com/users/4381282/pawe%c5%82-dawczak"}, "is_accepted": true, "score": 2, "last_activity_date": 1426675472, "last_edit_date": 1426675472, "creation_date": 1426672942, "answer_id": 29119035, "question_id": 29118892, "link": "https://stackoverflow.com/questions/29118892/ruby-to-replace-contents-of-file-between-two-markers/29119035#29119035", "title": "Ruby to replace contents of file between two markers", "body": "<p>Try changing you script as follows:</p>\n\n<pre><code>def replace(file_path, contents)\n  content = File.read(file_path)\n  new_content = content.gsub(/(&lt;!--start--&gt;)(.*)(&lt;!--end--&gt;)/im, \"\\\\1#{contents}\\\\3\")\n\n  File.open(file_path, \"w+\") { |file| file.puts new_content }\n  new_content\nend\n\nthing = [\"Foo\", \"Bar\", \"Baz\"].sample\n\nreplace(\"./my_file\", thing)\n</code></pre>\n\n<p>For working with files - check this <a href=\"http://ruby.bastardsbook.com/chapters/io/\" rel=\"nofollow\">great tutorial</a>!</p>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 339, "user_id": 4626222, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0189dabcf1e6fc8e2db02dc156bea687?s=128&d=identicon&r=PG&f=1", "display_name": "Flynt Hamlock", "link": "https://stackoverflow.com/users/4626222/flynt-hamlock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 29119035, "answer_count": 1, "score": 0, "last_activity_date": 1426675472, "creation_date": 1426672546, "question_id": 29118892, "link": "https://stackoverflow.com/questions/29118892/ruby-to-replace-contents-of-file-between-two-markers", "title": "Ruby to replace contents of file between two markers", "body": "<p>Trying to do like <a href=\"https://stackoverflow.com/questions/4841089/replace-content-in-a-file-between-two-markers\">Replace content in a file between two markers</a> but the accepted answer doesn't seem to be working:</p>\n\n<p><strong>index.html</strong></p>\n\n<pre><code>&lt;!--start--&gt;Hello world&lt;!--end--&gt;\n</code></pre>\n\n<p><strong>myscript.rb</strong></p>\n\n<pre><code>def replace(file_path, contents)\n    file = File.open(file_path, \"r+\")\n    html = \"\"\n\n    while(!file.eof?)\n        html += file.readline\n    end\n\n    file.close()\n\n    return html.gsub(/&lt;!--start--&gt;(.*)&lt;!--end--&gt;/im, contents)\nend\n\nthing = [\"Foo\", \"Bar\", \"Baz\"].sample\n\nreplace(\"/path/to/index.html\", thing)\n</code></pre>\n\n<p>After running <code>ruby myscript.rb</code>, <code>index.html</code> remains the same. I'm on Ruby 2.2.0.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "search"], "comments": [{"owner": {"reputation": 14213, "user_id": 398863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4CNtJ.png?s=128&g=1", "display_name": "Amit Patel", "link": "https://stackoverflow.com/users/398863/amit-patel"}, "edited": false, "score": 0, "creation_date": 1426674779, "post_id": 29118112, "comment_id": 46466171, "body": "If you don&#39;t want to use any gem then check Rails Way of doing multiple search <a href=\"http://railscasts.com/episodes/111-advanced-search-form\" rel=\"nofollow noreferrer\">railscasts.com/episodes/111-advanced-search-form</a>"}], "answers": [{"tags": [], "owner": {"reputation": 580, "user_id": 1107922, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/a5b1e878f2432108826af696bea4d2cd?s=128&d=identicon&r=PG", "display_name": "user1107922", "link": "https://stackoverflow.com/users/1107922/user1107922"}, "is_accepted": true, "score": 0, "last_activity_date": 1426671395, "last_edit_date": 1426671395, "creation_date": 1426670866, "answer_id": 29118252, "question_id": 29118112, "link": "https://stackoverflow.com/questions/29118112/search-after-multiple-parameters-ruby-on-rails/29118252#29118252", "title": "Search after multiple parameters, Ruby on Rails", "body": "<p>Model:</p>\n\n<pre><code>class Journey &lt; ActiveRecord::Base\n  def self.search(search_from, search_to)\n    self.where(\"from_place LIKE ? and to_place LIKE ?\", \"%#{search_from}%\", \"%#{search_to}%\")\n  end\nend\n</code></pre>\n\n<p>Controller:</p>\n\n<pre><code>class JourneysController &lt; ApplicationController\n\n  def index\n      if params[:search_from] and params[:search_to]\n        @journeys = search\n      else\n        @journeys = Journey.all.order('created_at DESC')\n    end\n  end\n\n  def search\n    @journeys = Journey.search(params[:search_from], params[:search_to])\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 4657572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ccea36a942722ad8f5c88bfebfdefd8?s=128&d=identicon&r=PG&f=1", "display_name": "habbala", "link": "https://stackoverflow.com/users/4657572/habbala"}, "edited": false, "score": 0, "creation_date": 1426675632, "post_id": 29119032, "comment_id": 46466721, "body": "Great answer! I tried the short solutions posted by the two guys above, but will absolutely see if I can make my code look better with your ideas, thank you!"}, {"owner": {"reputation": 1444, "user_id": 1495113, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/85c7b0e2e64b7513b337ec1572bf9dda?s=128&d=identicon&r=PG", "display_name": "Dr.Strangelove", "link": "https://stackoverflow.com/users/1495113/dr-strangelove"}, "reply_to_user": {"reputation": 5, "user_id": 4657572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ccea36a942722ad8f5c88bfebfdefd8?s=128&d=identicon&r=PG&f=1", "display_name": "habbala", "link": "https://stackoverflow.com/users/4657572/habbala"}, "edited": false, "score": 0, "creation_date": 1426689257, "post_id": 29119032, "comment_id": 46475801, "body": "What is left out of the scope of my answer is pagination. It&#39;s pretty important  to always limit your queries with paging in production - if user don&#39;t fill in form fields you&#39;ll end with Journey.all. Now imagine there are 100000 records in the table, server will eat some 1gb of memory serving just this one request. I recomend <a href=\"https://github.com/amatsuda/kaminari\" rel=\"nofollow noreferrer\">kaminari</a> for paging, as it&#39;s pretty straightforward and flexible about html-markup it generates."}], "tags": [], "owner": {"reputation": 1444, "user_id": 1495113, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/85c7b0e2e64b7513b337ec1572bf9dda?s=128&d=identicon&r=PG", "display_name": "Dr.Strangelove", "link": "https://stackoverflow.com/users/1495113/dr-strangelove"}, "is_accepted": false, "score": 0, "last_activity_date": 1426673287, "last_edit_date": 1426673287, "creation_date": 1426672938, "answer_id": 29119032, "question_id": 29118112, "link": "https://stackoverflow.com/questions/29118112/search-after-multiple-parameters-ruby-on-rails/29119032#29119032", "title": "Search after multiple parameters, Ruby on Rails", "body": "<p>The best approach here is to incapsulate your search form as a separate Ruby class. Using <a href=\"https://github.com/solnic/virtus\" rel=\"nofollow\">Virtus</a> here helps to get type coercion for free.</p>\n\n<pre><code>class SearchForm\n  include Virtus.model # Our virtus module\n  include ActiveModel::Model # To get ActiveRecord-like behaviour for free.\n\n  attribute :from, String\n  attribute :to, String\n\n  # Just to check if any search param present, \n  # you could substitute this with validations and just call valid?\n  def present?\n    attributes.values.any?{|value| value.present?}\n  end\n</code></pre>\n\n<p>```</p>\n\n<p>In Rails 3 IIRC you also have to include ActiveModel::Validations to be able to validate your form input if needed.\nNow, let's see how to refactor controller. We instantiate form object from params and pass that to the model query method to fetch records needed. I also moved ordering out of if clause and used symbol ordering param - cleaner IMO.</p>\n\n<pre><code>def index\n  @search_form = SearchForm.new(search_params)\n  if @search_form.valid? &amp;&amp; @search_form.present?\n    @journeys = Journey.search(@search_form)\n  else\n    @journeys = Journey.all\n  end\n  @journeys = @journeys.order(created_at: :desc)\nend\n\ndef search\n  @journeys = Journey.search(SearchForm.new(search_params)\nend\n\nprivate\ndef search_params\n  params.require(:search_form).permit(:from, :to)\nend\n</code></pre>\n\n<p>Now to the view: form_for will work perfectly with our form object, as will simple_form_for</p>\n\n<pre><code>&lt;%= form_for @search_form, url: journeys_path, method: :get do |f| %&gt;\n  &lt;%= f.text_field :from, placeholder: \"Search from\", class: 'input' %&gt;\n  &lt;%= f.text_field :to, placeholder: \"Search to\", class: 'input' %&gt;\n  &lt;%= f.submit \"Search\", class: 'submit' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>View looks now much shorter and cleaner. Incapsulating params in object makes working with search params muuuuch easier.</p>\n\n<p>Model:</p>\n\n<pre><code>class Journey &lt; ActiveRecord::Base\n  def self.search(search_form)\n    if search_form.kind_of?(SearchForm)\n      journeys = all # I'm calling Journey.all here to build ActiveRecord::Relation object\n      if search_form.from.present?\n        journeys = journeys.where(\"from_place LIKE ?\", \"%#{search_form.from}%\")\n      end\n      if search_form.to.present?\n        journeys = journeys.where(\"to_place LIKE ?\", \"%#{search_form.to}%\")\n      end\n    else\n      raise ArgumentError, 'You should pass SearchForm instance to Journey.search method'\n    end\n  end\nend\n</code></pre>\n\n<p>Notice how I build ActiveRecord::Relation object by calling <code>Journeys.all</code> and applying each search param if present. Chaining <code>where</code> like that would put <code>AND</code> in between automatically, if you need <code>OR</code> Rails 4 has it: <code>Journey.or(condition)</code>.\nPros of this approach:</p>\n\n<ol>\n<li>You are using Plain Old Ruby Classes, almost no magic here, and it works like usual Rails model in many ways. Putting search params in the object makes it a lot easier to refactor code. Virtus is the only dependency, sans Rails itself of course, and it's more for convenience and to avoid writing boring boiler-plate code.</li>\n<li>You can easily validate input if needed (If you really want to be strict about input and show user validation error instead of silently executing stupid query with contradicting conditions and returning no results).</li>\n</ol>\n"}], "owner": {"reputation": 5, "user_id": 4657572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ccea36a942722ad8f5c88bfebfdefd8?s=128&d=identicon&r=PG&f=1", "display_name": "habbala", "link": "https://stackoverflow.com/users/4657572/habbala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1304, "favorite_count": 0, "accepted_answer_id": 29118252, "answer_count": 2, "score": 0, "last_activity_date": 1426673287, "creation_date": 1426670507, "question_id": 29118112, "link": "https://stackoverflow.com/questions/29118112/search-after-multiple-parameters-ruby-on-rails", "title": "Search after multiple parameters, Ruby on Rails", "body": "<p>I'm very new to Ruby on Rails and trying to create a search function that allows the user to serach multiple parameters at the same time; from, and to. Something to keep in mind is that there will probably be even more parameters later on in the development. I've got it to work when searching for one of the fields, but not more than that.</p>\n\n<p>Search view:</p>\n\n<pre><code>&lt;%= form_tag(journeys_path, :method =&gt; \"get\", from: \"search-form\") do %&gt;\n    &lt;%= text_field_tag :search_from, params[:search_from], placeholder: \"Search from\", :class =&gt; 'input' %&gt;\n    &lt;%= text_field_tag :search_to, params[:search_to], placeholder: \"Search to\", :class =&gt; 'input' %&gt;\n    &lt;%= submit_tag \"Search\", :class =&gt; 'submit' %&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>Method:</p>\n\n<pre><code>class Journey &lt; ActiveRecord::Base\n  def self.search(search_from)\n    self.where(\"from_place LIKE ?\", \"%#{search_from}%\")\n  end\nend\n</code></pre>\n\n<p>Controller:</p>\n\n<pre><code>class JourneysController &lt; ApplicationController\n\n  def index\n    @journeys = Journey.all\n      if params[:search_from]\n        @journeys = Journey.search(params[:search_from])\n      else\n        @journeys = Journey.all.order('created_at DESC')\n    end\n  end\n\n  def search\n    @journeys = Journey.search(params[:search_from])\n  end\nend\n</code></pre>\n\n<p>I've tried some gems and all kind of solutions that I've found in other questions, but I'm just not good enough at RoR yet to succesfully apply them correctly without help. I would appreciate any help I can get.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["ruby", "redis", "rabbitmq", "throttling", "rate-limiting"], "comments": [{"owner": {"reputation": 6060, "user_id": 2707363, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb9a9de4955f62355160392b1eaca345?s=128&d=identicon&r=PG", "display_name": "zenbeni", "link": "https://stackoverflow.com/users/2707363/zenbeni"}, "edited": false, "score": 0, "creation_date": 1426754256, "post_id": 29117729, "comment_id": 46503887, "body": "You can implement it in lua in redis and calling the script from ruby. Complex reads and writes should be done in lua, less network roundtrips, good language, atomic behaviour."}], "answers": [{"tags": [], "owner": {"reputation": 6890, "user_id": 2140872, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/d6527.jpg?s=128&g=1", "display_name": "robertjlooby", "link": "https://stackoverflow.com/users/2140872/robertjlooby"}, "is_accepted": false, "score": 0, "last_activity_date": 1426963961, "creation_date": 1426963961, "answer_id": 29186697, "question_id": 29117729, "link": "https://stackoverflow.com/questions/29117729/implementing-a-leaky-bucket-like-algorithm-for-message-queues/29186697#29186697", "title": "Implementing a &quot;leaky bucket&quot;-like algorithm for message queues", "body": "<p>You could use <a href=\"https://github.com/resque/resque\" rel=\"nofollow\">Resque</a> (which also uses Redis for persistence). You could use a different queue for each type of 'candy' and start up a worker for each queue with different values for the <code>--interval</code> option.</p>\n\n<pre><code>$ bin/resque work --queues=blue  --interval=10\n$ bin/resque work --queues=green --interval=2\n$ bin/resque work --queues=red   --interval=5\n</code></pre>\n"}], "owner": {"reputation": 8232, "user_id": 1002814, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/935d2564cfa8572c12763684e072063d?s=128&d=identicon&r=PG", "display_name": "Niels Kristian", "link": "https://stackoverflow.com/users/1002814/niels-kristian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 893, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1426963961, "creation_date": 1426669225, "last_edit_date": 1426669649, "question_id": 29117729, "link": "https://stackoverflow.com/questions/29117729/implementing-a-leaky-bucket-like-algorithm-for-message-queues", "title": "Implementing a &quot;leaky bucket&quot;-like algorithm for message queues", "body": "<p>I have a ruby based application that has many different message queues (+200 different queues) that all needs to be throttled/rate limited individually. I have tried to illustrate the problem using this candy vending machine analogy</p>\n\n<p><img src=\"https://i.stack.imgur.com/5G2CE.png\" alt=\"Leaky Candy Vending Machine\"></p>\n\n<p>Now how would I go about implementing a system/algorithm like this? I have been thinking about putting the messages/\"candy\" into different redis lists/sets or RabbitMQ queues but getting them popped out from each queue at individual rates seems to be a hard task. Are there some technologies out there that would be better suited for the job than redis?</p>\n"}, {"tags": ["ruby", "redmine"], "answers": [{"comments": [{"owner": {"reputation": 1746, "user_id": 1012586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdb64d89a4b59bd145b3c10392ece1b7?s=128&d=identicon&r=PG", "display_name": "Morty", "link": "https://stackoverflow.com/users/1012586/morty"}, "edited": false, "score": 0, "creation_date": 1472114228, "post_id": 29117558, "comment_id": 65625266, "body": "It seems like the original plugin is not maintained any more. But there currently are thee maintained forks: <a href=\"https://github.com/gc-olivierho/redmine_importer\" rel=\"nofollow noreferrer\">github.com/gc-olivierho/redmine_importer</a>, <a href=\"https://github.com/agileware-jp/redmine_importer\" rel=\"nofollow noreferrer\">github.com/agileware-jp/redmine_importer</a> and <a href=\"https://github.com/zh/redmine_importer\" rel=\"nofollow noreferrer\">github.com/zh/redmine_importer</a>"}], "tags": [], "owner": {"reputation": 32543, "user_id": 528726, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6307569a99dd77fff0463032051d7e39?s=128&d=identicon&r=PG", "display_name": "joelparkerhenderson", "link": "https://stackoverflow.com/users/528726/joelparkerhenderson"}, "is_accepted": true, "score": 2, "last_activity_date": 1426668752, "creation_date": 1426668752, "answer_id": 29117558, "question_id": 29117439, "link": "https://stackoverflow.com/questions/29117439/how-to-import-excel-to-redmine/29117558#29117558", "title": "How to import excel to Redmine", "body": "<p>Start here: <a href=\"https://github.com/leovitch/redmine_importer/wiki\" rel=\"nofollow\">https://github.com/leovitch/redmine_importer/wiki</a></p>\n\n<p>You can use Excel to export a CSV file, then use the Redmine importer to import the items.</p>\n\n<p>This presumes that your Excel items are reasonably typical, and do not have embedded calculations, images, special fonts, etc.</p>\n"}, {"tags": [], "owner": {"reputation": 1746, "user_id": 1012586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdb64d89a4b59bd145b3c10392ece1b7?s=128&d=identicon&r=PG", "display_name": "Morty", "link": "https://stackoverflow.com/users/1012586/morty"}, "is_accepted": false, "score": 3, "last_activity_date": 1472118371, "creation_date": 1472118371, "answer_id": 39141878, "question_id": 29117439, "link": "https://stackoverflow.com/questions/29117439/how-to-import-excel-to-redmine/39141878#39141878", "title": "How to import excel to Redmine", "body": "<p>Since 3.2.0 Redmine has support for importing issues. I just started a minimal howto: <a href=\"http://www.redmine.org/projects/redmine/wiki/HowTo_import_issues\" rel=\"nofollow\">http://www.redmine.org/projects/redmine/wiki/HowTo_import_issues</a></p>\n"}], "owner": {"reputation": 23, "user_id": 4684334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3154fd5f6e6c2e729ebc07c91387163a?s=128&d=identicon&r=PG&f=1", "display_name": "jack53", "link": "https://stackoverflow.com/users/4684334/jack53"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5690, "favorite_count": 0, "accepted_answer_id": 29117558, "answer_count": 2, "score": 2, "last_activity_date": 1472118371, "creation_date": 1426668353, "question_id": 29117439, "link": "https://stackoverflow.com/questions/29117439/how-to-import-excel-to-redmine", "title": "How to import excel to Redmine", "body": "<p>Today I have a task from my boss that I have to study redmine and tell him if we can import issues excel file to redmine.\nI don't know anything about redmine. Can we import issues excel file to redmine? And if we can, what I should start from.</p>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby", "ajax"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 4056058, "user_type": "registered", "profile_image": "https://graph.facebook.com/3629199/picture?type=large", "display_name": "Dylan Wright", "link": "https://stackoverflow.com/users/4056058/dylan-wright"}, "edited": false, "score": 0, "creation_date": 1426691690, "post_id": 29117757, "comment_id": 46477618, "body": "Thanks for the response. While it seems like both of those should work, neither do. The form is still loaded with the wrong controller action &quot;/predictions&quot; even though I specify that the url should be url: predictionends_url"}], "tags": [], "owner": {"reputation": 423, "user_id": 1938491, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f9f0daaf18d089a2a47a23b44cc43390?s=128&d=identicon&r=PG", "display_name": "ROR", "link": "https://stackoverflow.com/users/1938491/ror"}, "is_accepted": false, "score": 0, "last_activity_date": 1426669301, "creation_date": 1426669301, "answer_id": 29117757, "question_id": 29117416, "link": "https://stackoverflow.com/questions/29117416/form-has-the-wrong-action-when-created-by-an-ajax-partial-ruby/29117757#29117757", "title": "Form has the wrong action when created by an ajax partial - Ruby", "body": "<p>We have two options here , please find below.</p>\n\n<p>= form_for @model, :url => predictions_url, :remote => true do |f|</p>\n\n<p>OR </p>\n\n<p>= form_tag(predictions_url, :method => \"post\", :id => \"model_form\", :remote => true) do |f|</p>\n"}], "owner": {"reputation": 9, "user_id": 4056058, "user_type": "registered", "profile_image": "https://graph.facebook.com/3629199/picture?type=large", "display_name": "Dylan Wright", "link": "https://stackoverflow.com/users/4056058/dylan-wright"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426669301, "creation_date": 1426668269, "question_id": 29117416, "link": "https://stackoverflow.com/questions/29117416/form-has-the-wrong-action-when-created-by-an-ajax-partial-ruby", "title": "Form has the wrong action when created by an ajax partial - Ruby", "body": "<p>I have a form that gets loaded by an ajax partial. When it gets swapped in, the form that loads on that ajax partial is targeting the wrong controller/url. I attempted to target the correct controller in a variety of ways, but it was always over-written to the same, incorrect controller/url.</p>\n\n<p>Additionally, the form loads correctly if it is loaded on page refresh - only when it is loaded by ajax does it target the incorrect controller.</p>\n\n<p>Here is what the form html looks like when it loads incorrectly:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;form class=\"new_prediction\" id=\"new_prediction\" action=\"/predictions\" accept-charset=\"UTF-8\" data-remote=\"true\" method=\"post\"&gt;&lt;input name=\"utf8\" type=\"hidden\" value=\"\u2713\"&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Here is what the form html should look like, and what it does look like after page refresh: \n<div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;form class=\"new_predictionend\" id=\"new_predictionend\" action=\"/predictionends\" accept-charset=\"UTF-8\" data-remote=\"true\" method=\"post\"&gt;&lt;input name=\"utf8\" type=\"hidden\" value=\"\u2713\"&gt;</code></pre>\r\n</div>\r\n</div>\r\n\nMy question is, why does the form target an incorrect controller \"/predictions\" when the form is loaded by ajax? The partial clearly shows that a new \"Predictionend\" model is the object for the form, and so should be targeting \"/predictionends\" like it does correctly when the page is refreshed.</p>\n\n<p>Here is the form partial that loads for both the page refresh and the ajax load:\n</p>\n\n<pre><code>&lt;%= form_for(Predictionend.new, remote:true) do |f| %&gt;\n  &lt;div class=\"sidebar-open-close-comment-div\"&gt;\n   &lt;%= f.text_area :comment, placeholder: \"Make a closing comment\", class: \"close-comment-textarea\" %&gt;\n  &lt;/div&gt; \n\n  &lt;div class=\"sidebar-close-button\"&gt;\n    &lt;%= f.submit \"SUBMIT\", class: \"btn\" %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n\n\n<p>This is the ajax file that loads the form:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>$('.stockpage-sidebar-prediction').first().html(\"&lt;%= j render partial: 'predictions/prediction_end', locals: {prediction: @prediction} %&gt;\");</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Controller that loads the ajax:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>class PredictionsController &lt; ApplicationController\r\n\r\n  def create\r\n\r\n    @prediction = @user.predictions.build(prediction)\r\n    @prediction.save\r\n                                                   \r\n    respond_to do |f|\r\n      f.js { \r\n        if invalid_start\r\n         render 'shared/_error_messages.js.erb'\r\n        else \r\n          render \"predictions/create.js.erb\"\r\n        end\r\n      }\r\n    end\r\n  end\r\nend                                               \r\n                                                   </code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Routes:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>  post    'predictions'                  =&gt;   'predictions#create'\r\n  get     'predictions/:id'              =&gt;   'predictions#show'\r\n  get     'predictions/hover/:id'        =&gt;   'predictions#hover'\r\n\r\n\r\n  post    'predictionends'               =&gt;   'predictionends#create'\r\n\r\n </code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Any help would be very much appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "undefined", "partials"], "comments": [{"owner": {"reputation": 1243, "user_id": 1891599, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a1beeb83f38d8dc7c1499b686161613?s=128&d=identicon&r=PG", "display_name": "AshwinKumarS", "link": "https://stackoverflow.com/users/1891599/ashwinkumars"}, "edited": false, "score": 0, "creation_date": 1426667438, "post_id": 29116932, "comment_id": 46462069, "body": "Paste a couple more levels of stacktrace"}], "answers": [{"comments": [{"owner": {"reputation": 968, "user_id": 2616474, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/6f3ec2c6580807b5fa2e09035f53262e?s=128&d=identicon&r=PG", "display_name": "brcebn", "link": "https://stackoverflow.com/users/2616474/brcebn"}, "edited": false, "score": 0, "creation_date": 1426669772, "post_id": 29117089, "comment_id": 46463231, "body": "It&#39;s the first thing I checked. This partial is never called without passing the <code>shops</code>. What&#39;s happening is <code>@shops</code> or <code>@shop</code> is nil from the beginning? Could it be possible to have this error in this case?"}, {"owner": {"reputation": 7251, "user_id": 2493089, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c34c815a19c6a2f6ed200cbd95503682?s=128&d=identicon&r=PG", "display_name": "SHS", "link": "https://stackoverflow.com/users/2493089/shs"}, "reply_to_user": {"reputation": 968, "user_id": 2616474, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/6f3ec2c6580807b5fa2e09035f53262e?s=128&d=identicon&r=PG", "display_name": "brcebn", "link": "https://stackoverflow.com/users/2616474/brcebn"}, "edited": false, "score": 0, "creation_date": 1426669903, "post_id": 29117089, "comment_id": 46463307, "body": "No. If they&#39;re nil, then <code>shops</code> should at least be defined as <code>nil</code>."}, {"owner": {"reputation": 968, "user_id": 2616474, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/6f3ec2c6580807b5fa2e09035f53262e?s=128&d=identicon&r=PG", "display_name": "brcebn", "link": "https://stackoverflow.com/users/2616474/brcebn"}, "edited": false, "score": 0, "creation_date": 1426670015, "post_id": 29117089, "comment_id": 46463372, "body": "That&#39;s what I thought and why I check it with <code>- if shops.nil?</code>"}, {"owner": {"reputation": 968, "user_id": 2616474, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/6f3ec2c6580807b5fa2e09035f53262e?s=128&d=identicon&r=PG", "display_name": "brcebn", "link": "https://stackoverflow.com/users/2616474/brcebn"}, "edited": false, "score": 1, "creation_date": 1426670259, "post_id": 29117089, "comment_id": 46463495, "body": "My mistake.. There was on line where I weren&#39;t passing the shops.. Shame on me. Problem solved. Thanks for helping."}], "tags": [], "owner": {"reputation": 7251, "user_id": 2493089, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c34c815a19c6a2f6ed200cbd95503682?s=128&d=identicon&r=PG", "display_name": "SHS", "link": "https://stackoverflow.com/users/2493089/shs"}, "is_accepted": true, "score": 1, "last_activity_date": 1426670071, "last_edit_date": 1426670071, "creation_date": 1426666958, "answer_id": 29117089, "question_id": 29116932, "link": "https://stackoverflow.com/questions/29116932/render-partial-with-locals/29117089#29117089", "title": "Render partial with locals", "body": "<p>If it's the same partial where the error is originating from, then it looks like you're rendering the <code>more_specific</code> partial from somewhere else (i.e. not from the <code>special_content</code> file) and not passing the required variables through <code>locals</code>. Because otherwise, I don't think this error is possible.</p>\n\n<p>You could also try the simple <code>render</code> syntax, like so:</p>\n\n<pre><code>render path_to_parent_partial, shops: @shops, shop: @shop # in index\nrender path_to_child_partial, shops: shops, shop: shop # in parent\n</code></pre>\n\n<p>But first, search for <code>'more_specific'</code> in your project and see where you aren't passing the <code>shops</code> variable. You can also check the Rails Server logs output to see which view files are being rendered.</p>\n"}, {"comments": [{"owner": {"reputation": 968, "user_id": 2616474, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/6f3ec2c6580807b5fa2e09035f53262e?s=128&d=identicon&r=PG", "display_name": "brcebn", "link": "https://stackoverflow.com/users/2616474/brcebn"}, "edited": false, "score": 0, "creation_date": 1426669638, "post_id": 29117611, "comment_id": 46463141, "body": "I don&#39;t want to do that because this partial is called from a lot of other views and I don&#39;t want to create an instance variable every time on my controller. That&#39;s why I&#39;m using <code>locals</code>"}], "tags": [], "owner": {"reputation": 423, "user_id": 1938491, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f9f0daaf18d089a2a47a23b44cc43390?s=128&d=identicon&r=PG", "display_name": "ROR", "link": "https://stackoverflow.com/users/1938491/ror"}, "is_accepted": false, "score": 0, "last_activity_date": 1426668885, "creation_date": 1426668885, "answer_id": 29117611, "question_id": 29116932, "link": "https://stackoverflow.com/questions/29116932/render-partial-with-locals/29117611#29117611", "title": "Render partial with locals", "body": "<p>You can direct call @shops in #medias/_more_specific.html.slim because it is instance variable so it would also available here.</p>\n\n<ul>\n<li>if @shops.blank?   </li>\n</ul>\n"}], "owner": {"reputation": 968, "user_id": 2616474, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/6f3ec2c6580807b5fa2e09035f53262e?s=128&d=identicon&r=PG", "display_name": "brcebn", "link": "https://stackoverflow.com/users/2616474/brcebn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1590, "favorite_count": 0, "accepted_answer_id": 29117089, "answer_count": 2, "score": 0, "last_activity_date": 1426670071, "creation_date": 1426666286, "last_edit_date": 1426669828, "question_id": 29116932, "link": "https://stackoverflow.com/questions/29116932/render-partial-with-locals", "title": "Render partial with locals", "body": "<p>I'm using render with partials hundred times on my app but I've a problem with one and I don't understand why.</p>\n\n<p>I'm calling partial recursively. </p>\n\n<pre><code>#index.html.slim\n= render partial: 'medias/special_content', locals: {shops: @shops, shop: @shop}\n\n#medias/_special_content.html.slim\n= render partial: 'medias/more_specific', locals: {shops: shops, shop: shop}\n\n#medias/_more_specific.html.slim\n- if shops.nil?\n  #Some code\n</code></pre>\n\n<p>Here is my error:</p>\n\n<pre><code>undefined local variable or method `shops' for #&lt;#\n\n&lt;Class:0x0000000775c360&gt;:0x007f027cff5c28&gt;\n    app/views/medias/_more_specific.html.slim:130:in\n    `_app_views_medias__more_specific_html_slim___1518734296928926472_69824330512820' \nactionpack (3.2.17) lib/action_view/template.rb:145:in `block in render' \nactivesupport (3.2.17) lib/active_support/notifications.rb:125:in `instrument' \nactionpack (3.2.17) lib/action_view/template.rb:143:in `render' \nactionpack (3.2.17) lib/action_view/renderer/partial_renderer.rb:265:in `render_partial' \nactionpack (3.2.17) lib/action_view/renderer/partial_renderer.rb:238:in `block in render' \nactionpack (3.2.17) lib/action_view/renderer/abstract_renderer.rb:38:in `block in instrument' \nactivesupport (3.2.17) lib/active_support/notifications.rb:123:in `block in instrument' \nactivesupport (3.2.17) lib/active_support/notifications/instrumenter.rb:20:in `instrument' \nactivesupport (3.2.17) lib/active_support/notifications.rb:123:in `instrument' \nactionpack (3.2.17) lib/action_view/renderer/abstract_renderer.rb:38:in `instrument' \nactionpack (3.2.17) lib/action_view/renderer/partial_renderer.rb:237:in `render' \nactionpack (3.2.17) lib/action_view/renderer/renderer.rb:41:in `render_partial' \nactionpack (3.2.17) lib/action_view/renderer/renderer.rb:15:in `render' \nactionpack (3.2.17) lib/action_view/helpers/rendering_helper.rb:24:in `render' \napp/views/medias/_special_content.html.slim:20:in \n...\n</code></pre>\n"}, {"tags": ["ruby", "jruby", "em-synchrony"], "answers": [{"tags": [], "owner": {"reputation": 508, "user_id": 3399164, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a5606100901d5fa513b62321030898a2?s=128&d=identicon&r=PG&f=1", "display_name": "Maxo", "link": "https://stackoverflow.com/users/3399164/maxo"}, "is_accepted": false, "score": 1, "last_activity_date": 1426677556, "creation_date": 1426677556, "answer_id": 29120651, "question_id": 29116894, "link": "https://stackoverflow.com/questions/29116894/ruby-running-in-parallel/29120651#29120651", "title": "Ruby Running in Parallel", "body": "<p>I have managed to resolve the issue using Parallel gem for ruby. I have managed to decrease the total time for connect/checkup for all servers by 80%. Just in case someone reads this thread and finds it useful. Haven't managed to try JRuby though, which might be even more efficient.</p>\n"}], "owner": {"reputation": 508, "user_id": 3399164, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a5606100901d5fa513b62321030898a2?s=128&d=identicon&r=PG&f=1", "display_name": "Maxo", "link": "https://stackoverflow.com/users/3399164/maxo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426677556, "creation_date": 1426666102, "question_id": 29116894, "link": "https://stackoverflow.com/questions/29116894/ruby-running-in-parallel", "title": "Ruby Running in Parallel", "body": "<p>I currently have a small ruby script, which is connecting to the remote SSH servers and checking the size of the files and providing results whether it has been changed or not.</p>\n\n<p>The issue is that there are around 10 servers like this. I would like to connect and check size in parallel and not one by one. Could anyone guide me how to accomplish that? I have also checked EM-Synchrony, but I assume that most efficient way would be to use JRuby.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "routes"], "comments": [{"owner": {"reputation": 5014, "user_id": 3640770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HJBjs.jpg?s=128&g=1", "display_name": "IngoAlbers", "link": "https://stackoverflow.com/users/3640770/ingoalbers"}, "edited": false, "score": 0, "creation_date": 1426671786, "post_id": 29116022, "comment_id": 46464352, "body": "I don&#39;t know if it will help you, but you could probably use something like: eval(&quot;engine_name.app_integration_&quot; + integration_key + &quot;_url&quot;)"}, {"owner": {"reputation": 2190, "user_id": 1970061, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/LiBnO.jpg?s=128&g=1", "display_name": "Anil Maurya", "link": "https://stackoverflow.com/users/1970061/anil-maurya"}, "edited": false, "score": 0, "creation_date": 1426672043, "post_id": 29116022, "comment_id": 46464481, "body": "or something like this :  redirect_to engine_name.send(route_name,query_params)"}], "answers": [{"tags": [], "owner": {"reputation": 51109, "user_id": 53653, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7f25eecbc1d0eed895a2809ce83ddf59?s=128&d=identicon&r=PG", "display_name": "typeoneerror", "link": "https://stackoverflow.com/users/53653/typeoneerror"}, "is_accepted": true, "score": 0, "last_activity_date": 1426709270, "creation_date": 1426709270, "answer_id": 29131698, "question_id": 29116022, "link": "https://stackoverflow.com/questions/29116022/dynamic-url-from-rails-route/29131698#29131698", "title": "Dynamic _url from rails route", "body": "<p><code>method</code> didn't seem to be the right, um, method, to call. Swapping for <code>send</code> lead me to the correct output without error:</p>\n\n<pre><code>route_name = \"app_integration_#{integration_key}_url\".to_sym\nredirect_to doki_core.send(route_name, query_params)\n</code></pre>\n"}], "owner": {"reputation": 51109, "user_id": 53653, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7f25eecbc1d0eed895a2809ce83ddf59?s=128&d=identicon&r=PG", "display_name": "typeoneerror", "link": "https://stackoverflow.com/users/53653/typeoneerror"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 29131698, "answer_count": 1, "score": 0, "last_activity_date": 1426709270, "creation_date": 1426662462, "question_id": 29116022, "link": "https://stackoverflow.com/questions/29116022/dynamic-url-from-rails-route", "title": "Dynamic _url from rails route", "body": "<p>In my app engine I can reference:</p>\n\n<pre><code>engine_name.app_integration_stripe_url\n</code></pre>\n\n<p>And the correct url is returned. I'd like at some point to generate this URL dynamically based on the integration being configured. This is what I thought would work, but this throws an error:</p>\n\n<pre><code>  integration_key = 'stripe'\n  route_name = \"app_integration_#{integration_key}_url\".to_sym\n  redirect_to engine_name.method(route_name).call(query_params)\n</code></pre>\n\n<blockquote>\n  <p>undefined method app_integration_stripe_url for class\n  ActionDispatch::Routing::RoutesProxy</p>\n</blockquote>\n\n<p>How can I generate one of these URLs dynamically?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nokogiri", "libxml2"], "comments": [{"owner": {"reputation": 22836, "user_id": 152786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/581hP.jpg?s=128&g=1", "display_name": "smathy", "link": "https://stackoverflow.com/users/152786/smathy"}, "edited": false, "score": 0, "creation_date": 1426660475, "post_id": 29115403, "comment_id": 46459209, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/26878263/libxml2-missing-mac-os-x-10-10\">Libxml2 missing mac os x 10.10</a>"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1426803891, "post_id": 29115403, "comment_id": 46532881, "body": "Please don&#39;t link to information that is relevant to the problem. Asking people to chase down information in the installation log on another site only discourages potential help. Plus <i>when</i> the link breaks your question will be missing useful information. Instead, summarize that information in your question."}, {"owner": {"reputation": 15523, "user_id": 274502, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c6768f8be92fe851f2a5502fb9845778?s=128&d=identicon&r=PG", "display_name": "cregox", "link": "https://stackoverflow.com/users/274502/cregox"}, "edited": false, "score": 0, "creation_date": 1595025398, "post_id": 29115403, "comment_id": 111342590, "body": "ping back might help someone (including my future self) <a href=\"https://github.com/termux/termux-packages/issues/2340#issuecomment-660365808\" rel=\"nofollow noreferrer\">github.com/termux/termux-packages/issues/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 460, "user_id": 1509375, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0d336ad885ca31a394e73a1f8db3774a?s=128&d=identicon&r=PG", "display_name": "Dave Munger", "link": "https://stackoverflow.com/users/1509375/dave-munger"}, "edited": false, "score": 1, "creation_date": 1448595094, "post_id": 29119741, "comment_id": 55658481, "body": "You understand this requires the OP to use/install homebrew, right? I don&#39;t know about them, but I don&#39;t like to run that type of third party package manager on my mac. Especially not to get one single library. And I&#39;ve never had to in order to get rails working."}, {"owner": {"reputation": 2204, "user_id": 4003349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jyMqf.jpg?s=128&g=1", "display_name": "Legendary", "link": "https://stackoverflow.com/users/4003349/legendary"}, "reply_to_user": {"reputation": 460, "user_id": 1509375, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0d336ad885ca31a394e73a1f8db3774a?s=128&d=identicon&r=PG", "display_name": "Dave Munger", "link": "https://stackoverflow.com/users/1509375/dave-munger"}, "edited": false, "score": 0, "creation_date": 1448876949, "post_id": 29119741, "comment_id": 55746952, "body": "@DaveMunger nokogiri required libxml2 - so you do not wanna install libxml2? You can&#39;t use nokogiri. OP said, that he on OS X 10.10.2. Home brew - most popular service for search-n-install libs like that."}, {"owner": {"reputation": 460, "user_id": 1509375, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0d336ad885ca31a394e73a1f8db3774a?s=128&d=identicon&r=PG", "display_name": "Dave Munger", "link": "https://stackoverflow.com/users/1509375/dave-munger"}, "edited": false, "score": 0, "creation_date": 1448922918, "post_id": 29119741, "comment_id": 55774585, "body": "I said I didn&#39;t want to install homebrew. You can install libxml2 without using homebrew. I can&#39;t tell if you are being sarcastic or not in this reply, but your tone in your original answer is just a little bit judgmental. Different people approach things different ways and we can all get along. :)   Edit: I forgot to say, I&#39;ve installed libxml2 on a mac a few times already without resorting to using homebrew."}, {"owner": {"reputation": 2204, "user_id": 4003349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jyMqf.jpg?s=128&g=1", "display_name": "Legendary", "link": "https://stackoverflow.com/users/4003349/legendary"}, "reply_to_user": {"reputation": 460, "user_id": 1509375, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0d336ad885ca31a394e73a1f8db3774a?s=128&d=identicon&r=PG", "display_name": "Dave Munger", "link": "https://stackoverflow.com/users/1509375/dave-munger"}, "edited": false, "score": 0, "creation_date": 1448969476, "post_id": 29119741, "comment_id": 55793714, "body": "@DaveMunger oh, sorry, now i get what you mean. But i thunk that sometimes - most popular solution - best solution (for juniors) because junior have trouble with select from a lot of  opinions, if  he know nothing about every opinion. So usually my plan is 1) You have to use A and then answer to questions like &quot;what is A?&quot;  &quot;how i install A?&quot; &quot;Is there other solutions except A?&quot;. Maybe i am wrong. It only my theory. I teach  students only 1 year <code>course &quot;information systems&quot;</code> at college as a teacher"}, {"owner": {"reputation": 460, "user_id": 1509375, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0d336ad885ca31a394e73a1f8db3774a?s=128&d=identicon&r=PG", "display_name": "Dave Munger", "link": "https://stackoverflow.com/users/1509375/dave-munger"}, "edited": false, "score": 0, "creation_date": 1448999271, "post_id": 29119741, "comment_id": 55812983, "body": "I do agree homebrew is the easiest path if you&#39;re okay with installing it."}], "tags": [], "owner": {"reputation": 2204, "user_id": 4003349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jyMqf.jpg?s=128&g=1", "display_name": "Legendary", "link": "https://stackoverflow.com/users/4003349/legendary"}, "is_accepted": false, "score": 6, "last_activity_date": 1461676719, "last_edit_date": 1461676719, "creation_date": 1426675012, "answer_id": 29119741, "question_id": 29115403, "link": "https://stackoverflow.com/questions/29115403/error-gem-install-rails-libxml2-is-missing/29119741#29119741", "title": "Error - &quot;gem install rails&quot; - libxml2 is missing", "body": "<p>You don't have the required library, and it is so easy to google solution:</p>\n\n<pre><code> brew install libxml2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 417, "user_id": 1793713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f65acf7c341ed7c83639e2fa74cd4e6?s=128&d=identicon&r=PG", "display_name": "NotYanka", "link": "https://stackoverflow.com/users/1793713/notyanka"}, "is_accepted": false, "score": 7, "last_activity_date": 1426849407, "creation_date": 1426849407, "answer_id": 29165015, "question_id": 29115403, "link": "https://stackoverflow.com/questions/29115403/error-gem-install-rails-libxml2-is-missing/29165015#29165015", "title": "Error - &quot;gem install rails&quot; - libxml2 is missing", "body": "<p>I just had the same problem and was able to solve it as follows:</p>\n\n<p>Installing Nokogiri separately worked only when using the system libraries:</p>\n\n<pre><code>gem install nokogiri -- --use-system-libraries\n</code></pre>\n\n<p>...but was still failing when executing <code>bundle install</code>. So just configure bundler to also build Nokogiri using the system libraries:</p>\n\n<pre><code>bundle config build.nokogiri --use-system-libraries\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5185, "user_id": 359532, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Ngxi2.jpg?s=128&g=1", "display_name": "Michael Ozeryansky", "link": "https://stackoverflow.com/users/359532/michael-ozeryansky"}, "edited": false, "score": 1, "creation_date": 1451452539, "post_id": 29201148, "comment_id": 56788192, "body": "I get an error: <code>Operation not permitted - &#47;usr&#47;bin&#47;sprockets</code>"}], "tags": [], "owner": {"reputation": 2047, "user_id": 3152113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d2340c4d1c6287e9ebc3ea83ff9bd9c?s=128&d=identicon&r=PG&f=1", "display_name": "Simar", "link": "https://stackoverflow.com/users/3152113/simar"}, "is_accepted": false, "score": 4, "last_activity_date": 1427067063, "creation_date": 1427067063, "answer_id": 29201148, "question_id": 29115403, "link": "https://stackoverflow.com/questions/29115403/error-gem-install-rails-libxml2-is-missing/29201148#29201148", "title": "Error - &quot;gem install rails&quot; - libxml2 is missing", "body": "<p>Try using this:</p>\n\n<pre><code>sudo gem install rails -- --use-system-libraries --with-xml=/usr/local/Cellar/libxml2/\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3683, "user_id": 330242, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c9f3ffc3e30d25eb64e2e464f0a86bd7?s=128&d=identicon&r=PG", "display_name": "przemo_li", "link": "https://stackoverflow.com/users/330242/przemo-li"}, "is_accepted": false, "score": 0, "last_activity_date": 1447237989, "creation_date": 1447237989, "answer_id": 33648701, "question_id": 29115403, "link": "https://stackoverflow.com/questions/29115403/error-gem-install-rails-libxml2-is-missing/33648701#33648701", "title": "Error - &quot;gem install rails&quot; - libxml2 is missing", "body": "<p>For some reason nokogiri build process for libxml2 will misplace build version.</p>\n\n<p>Instead of <code>lib/</code> it will to go <code>lib64/</code>. Nokogiri will then look for it in the wrong directory.</p>\n\n<p>More info here:\n<a href=\"https://github.com/sparklemotion/nokogiri/issues/1334\" rel=\"nofollow\">https://github.com/sparklemotion/nokogiri/issues/1334</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6183294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0338daea063f97e7caa6a875fb4f911?s=128&d=identicon&r=PG&f=1", "display_name": "Shunzhe", "link": "https://stackoverflow.com/users/6183294/shunzhe"}, "is_accepted": false, "score": 0, "last_activity_date": 1460273723, "last_edit_date": 1460273723, "creation_date": 1460270766, "answer_id": 36526774, "question_id": 29115403, "link": "https://stackoverflow.com/questions/29115403/error-gem-install-rails-libxml2-is-missing/36526774#36526774", "title": "Error - &quot;gem install rails&quot; - libxml2 is missing", "body": "<p>It worked for me as Simar has mentioned. </p>\n\n<pre><code>sudo gem install rails -- --use-system-libraries --with-xml=/usr/local/Cellar/libxml2/\n</code></pre>\n\n<p>And if you were having troubles install it on Mac please check out here.\n<a href=\"https://gorails.com/setup/osx/10.11-el-capitan\" rel=\"nofollow\">https://gorails.com/setup/osx/10.11-el-capitan</a></p>\n\n<p>Also if you could not find /usr/local/Cellar/libxml2/ existing, you may need to homebrew it. </p>\n\n<pre><code>brew install libxml2\n</code></pre>\n\n<p>If you are installing it on a newly installed OS X EL CAPITAN as I do, you probably find homebrew telling you that libxml2 is installed already and brew will not replace the existing libxml2 with it's newly installed one which is at /usr/local/Cellar/libxml2/, which is the one we really should link the libraries to. Since the system default libxml2 would not link successfully.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6292957, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/6740f59fe1e55deacc57fc158b5673af?s=128&d=identicon&r=PG", "display_name": "ninja79", "link": "https://stackoverflow.com/users/6292957/ninja79"}, "is_accepted": false, "score": 1, "last_activity_date": 1462400121, "last_edit_date": 1462400121, "creation_date": 1462398313, "answer_id": 37038608, "question_id": 29115403, "link": "https://stackoverflow.com/questions/29115403/error-gem-install-rails-libxml2-is-missing/37038608#37038608", "title": "Error - &quot;gem install rails&quot; - libxml2 is missing", "body": "<p>I had the same issue, on Debian it seemed only a problem of missing 'dev' libraries, probably needed to compile sources during installation (I'm guessing). I solved it by installing (via apt-get or aptitude) the following packages:</p>\n\n<ul>\n<li>Libxml2-dev</li>\n<li>Libxslt1-dev</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1363, "user_id": 793341, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/e237c21ed78f1449e704bae240329be8?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/793341/sean"}, "is_accepted": false, "score": 1, "last_activity_date": 1464539781, "creation_date": 1464539781, "answer_id": 37512353, "question_id": 29115403, "link": "https://stackoverflow.com/questions/29115403/error-gem-install-rails-libxml2-is-missing/37512353#37512353", "title": "Error - &quot;gem install rails&quot; - libxml2 is missing", "body": "<p>This worked for me (<a href=\"https://github.com/sparklemotion/nokogiri/issues/1166\" rel=\"nofollow\">based on this Github thread</a>): </p>\n\n<pre><code>gem install nokogiri -- --use-system-libraries --with-xml2-include=/usr/include/libxml2 --with-xml2-lib=/usr/lib/\n</code></pre>\n\n<p>As a note, my issue was:</p>\n\n<pre><code>...\nchecking for main() in -llzma... yes\nchecking for xmlParseDoc() in libxml/parser.h... no\nchecking for xmlParseDoc() in -lxml2... no\nchecking for xmlParseDoc() in -llibxml2... no\n-----\nlibxml2 is missing.  Please locate mkmf.log to investigate how it is failing.\n-----\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/Users/seanshadmand/.rvm/rubies/ruby-2.1.1/bin/ruby\n    --help\n    --clean\n    --use-system-libraries\n    --enable-static\n    --disable-static\n    --with-zlib-dir\n    --without-zlib-dir\n    --with-zlib-include\n    --without-zlib-include=${zlib-dir}/include\n    --with-zlib-lib\n    --without-zlib-lib=${zlib-dir}/lib\n    --enable-cross-build\n    --disable-cross-build\n    --with-xml2lib\n    --without-xml2lib\n    --with-libxml2lib\n    --without-libxml2lib\n\nTo see why this extension failed to ...\n\nextconf failed, exit code 1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8760749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baba05a8be118d2aaecacf8b0b8cb637?s=128&d=identicon&r=PG&f=1", "display_name": "C.L", "link": "https://stackoverflow.com/users/8760749/c-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1507749284, "last_edit_date": 1507749284, "creation_date": 1507744890, "answer_id": 46694751, "question_id": 29115403, "link": "https://stackoverflow.com/questions/29115403/error-gem-install-rails-libxml2-is-missing/46694751#46694751", "title": "Error - &quot;gem install rails&quot; - libxml2 is missing", "body": "<p>I had the same problem when I try: </p>\n\n<pre><code>gem install libxml-ruby -v '3.0.0\n</code></pre>\n\n<p>Run the following solved the issue on Mac for me:</p>\n\n<pre><code>gem update --system\n\nxcode-select --install\n\ngem install nokogiri\n</code></pre>\n\n<p>See <a href=\"http://www.nokogiri.org/tutorials/installing_nokogiri.html\" rel=\"nofollow noreferrer\">installing nokogiri</a> for more details</p>\n"}], "owner": {"reputation": 251, "user_id": 1431702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/159c2eda243da73329419ba58557299f?s=128&d=identicon&r=PG", "display_name": "Alvin Jones", "link": "https://stackoverflow.com/users/1431702/alvin-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8341, "favorite_count": 2, "answer_count": 8, "score": 8, "last_activity_date": 1507749284, "creation_date": 1426659714, "last_edit_date": 1426803821, "question_id": 29115403, "link": "https://stackoverflow.com/questions/29115403/error-gem-install-rails-libxml2-is-missing", "title": "Error - &quot;gem install rails&quot; - libxml2 is missing", "body": "<p>I've been working through the Rails install instructions (<a href=\"http://railsapps.github.io/installrubyonrails-mac.html\" rel=\"noreferrer\">http://railsapps.github.io/installrubyonrails-mac.html</a>) and everything was okay up until I got to <code>gem install rails</code> part under <em>New Rails Application</em>. When I ran that I got libxml2 is missing. Here's the log: <a href=\"http://codecascade.com/sIjhQ/raw\" rel=\"noreferrer\">http://codecascade.com/sIjhQ/raw</a></p>\n\n<p>I had similar issues install nokogiri, and the only way I was able to get it resolved was with</p>\n\n<pre><code>gem install nokogiri -- --use-system-libraries\n</code></pre>\n\n<p>I'm on OS X 10.10.2. I also have RubyMine installed if that's potentially relevant. </p>\n"}, {"tags": ["ruby", "string", "split"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1426665363, "post_id": 29115226, "comment_id": 46461199, "body": "What if there was an additional space before <code>98</code>? What it was <code>98bottles_of_beer</code>? What if <code>this</code> were <code>this7</code>? Please edit to explain in words what you want. That is, what are the rules? Perhaps give more examples. You need to fix this even though you&#39;ve selected an answer, as many others will read this question in future. Also, you&#39;ll accumulate more downvotes and votes to close until you clarify."}, {"owner": {"reputation": 749, "user_id": 3767348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/evVot.jpg?s=128&g=1", "display_name": "veeresh yh", "link": "https://stackoverflow.com/users/3767348/veeresh-yh"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1426667679, "post_id": 29115226, "comment_id": 46462176, "body": "according to my case <code>string</code>  with one space is neglected and <code>numeric</code> with single space is taken."}], "answers": [{"tags": [], "owner": {"reputation": 159902, "user_id": 3297613, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/KHhzd.jpg?s=128&g=1", "display_name": "Avinash Raj", "link": "https://stackoverflow.com/users/3297613/avinash-raj"}, "is_accepted": true, "score": 2, "last_activity_date": 1426661264, "last_edit_date": 1426661264, "creation_date": 1426659094, "answer_id": 29115262, "question_id": 29115226, "link": "https://stackoverflow.com/questions/29115226/split-string-by-two-or-more-consecutive-whitespaces-but-not-by-single/29115262#29115262", "title": "Split string by two or more consecutive whitespaces but not by single", "body": "<p>Use <code>gsub</code> function to remove a single space which exists between two alphabets and then do splitting in-order to get your desired output.</p>\n\n<pre><code>&gt; str = \"this     is    simpl e    string 98\"\n&gt; str.gsub(/(?&lt;=[[:alpha:]])\\s(?=[[:alpha:]])/,\"\").split()\n=&gt; [\"this\", \"is\", \"simple\", \"string\", \"98\"]\n</code></pre>\n"}], "owner": {"reputation": 749, "user_id": 3767348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/evVot.jpg?s=128&g=1", "display_name": "veeresh yh", "link": "https://stackoverflow.com/users/3767348/veeresh-yh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 1, "accepted_answer_id": 29115262, "answer_count": 1, "score": -2, "last_activity_date": 1426661264, "creation_date": 1426658957, "last_edit_date": 1426660152, "question_id": 29115226, "link": "https://stackoverflow.com/questions/29115226/split-string-by-two-or-more-consecutive-whitespaces-but-not-by-single", "title": "Split string by two or more consecutive whitespaces but not by single", "body": "<p>I have</p>\n\n<pre><code>str = \"this     is    simpl e    string 98\"\n</code></pre>\n\n<p>I need something like this </p>\n\n<pre><code>[\"this\",\"is\",\"simple\",\"string\",\"98\"]\n</code></pre>\n\n<p>I did this:</p>\n\n<pre><code>str.split(\" \")\n# =&gt; [\"this\",\"is\",\"simpl\",\"e\",\"string\",\"98\"]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "gem", "vote"], "comments": [{"owner": {"reputation": 736, "user_id": 2194846, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7033K.jpg?s=128&g=1", "display_name": "Allan W Smith", "link": "https://stackoverflow.com/users/2194846/allan-w-smith"}, "edited": false, "score": 0, "creation_date": 1426657751, "post_id": 29114846, "comment_id": 46458273, "body": "Roll it yourself.  Make a vote model, that belongs to an user and a post, restrict the vote field to an enum with the desired options.  Build a vote controller around this."}], "answers": [{"comments": [{"owner": {"reputation": 7032, "user_id": 1743174, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9f871161f754442df697dce1cede77a5?s=128&d=identicon&r=PG&f=1", "display_name": "Dipak Gupta", "link": "https://stackoverflow.com/users/1743174/dipak-gupta"}, "edited": false, "score": 1, "creation_date": 1426657997, "post_id": 29114985, "comment_id": 46458354, "body": "There is a problem in your Vote model please make <code>belongs_to :vote</code> to <code>belongs_to :post</code>"}, {"owner": {"reputation": 22836, "user_id": 152786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/581hP.jpg?s=128&g=1", "display_name": "smathy", "link": "https://stackoverflow.com/users/152786/smathy"}, "reply_to_user": {"reputation": 7032, "user_id": 1743174, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9f871161f754442df697dce1cede77a5?s=128&d=identicon&r=PG&f=1", "display_name": "Dipak Gupta", "link": "https://stackoverflow.com/users/1743174/dipak-gupta"}, "edited": false, "score": 0, "creation_date": 1426658140, "post_id": 29114985, "comment_id": 46458410, "body": "Heh, actually you made the same error but with the other <code>belongs_to</code> - I&#39;ve fixed it now to be <code>:post</code> and <b><code>:user</code></b> :)  Thanks."}, {"owner": {"reputation": 51, "user_id": 4625512, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cZdWIEzhvJw/AAAAAAAAAAI/AAAAAAAAABA/kVZtT3X0ISg/photo.jpg?sz=128", "display_name": "Michael Law", "link": "https://stackoverflow.com/users/4625512/michael-law"}, "edited": false, "score": 0, "creation_date": 1426658556, "post_id": 29114985, "comment_id": 46458524, "body": "Thanks for your timely answer smathy! I&#39;m gonna try to implement this now. As I do that, can you link me to where you found this out? For me to study"}, {"owner": {"reputation": 22836, "user_id": 152786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/581hP.jpg?s=128&g=1", "display_name": "smathy", "link": "https://stackoverflow.com/users/152786/smathy"}, "edited": false, "score": 0, "creation_date": 1426658964, "post_id": 29114985, "comment_id": 46458659, "body": "Hmm, well aside from <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Enum.html\" rel=\"nofollow noreferrer\">the docs that I already linked you to in my answer</a>, I follow <a href=\"https://groups.google.com/forum/#!forum/rubyonrails-core\" rel=\"nofollow noreferrer\">the rails-core mailing list</a> which announces and discusses upcoming features, I follow <a href=\"https://twitter.com/rails\" rel=\"nofollow noreferrer\">@rails on twitter</a> where they announce all sorts of things, I read <a href=\"http://weblog.rubyonrails.org/releases/\" rel=\"nofollow noreferrer\">the release notes for new versions</a> and I go through <a href=\"http://guides.rubyonrails.org/4_2_release_notes.html\" rel=\"nofollow noreferrer\">the release notes in the guides</a> after major releases."}, {"owner": {"reputation": 51, "user_id": 4625512, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cZdWIEzhvJw/AAAAAAAAAAI/AAAAAAAAABA/kVZtT3X0ISg/photo.jpg?sz=128", "display_name": "Michael Law", "link": "https://stackoverflow.com/users/4625512/michael-law"}, "edited": false, "score": 0, "creation_date": 1426661027, "post_id": 29114985, "comment_id": 46459428, "body": "I got the array to of choices to display, but I need a way for users to select them and POST them to the current blog post. Also, is there a way to make images the way to select the emotions? As in an array of images instead of an array of strings?"}, {"owner": {"reputation": 22836, "user_id": 152786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/581hP.jpg?s=128&g=1", "display_name": "smathy", "link": "https://stackoverflow.com/users/152786/smathy"}, "edited": false, "score": 0, "creation_date": 1426661327, "post_id": 29114985, "comment_id": 46459546, "body": "You should probably do a bit more work on it, and then if you&#39;re still having trouble you should ask another question with your new issues."}], "tags": [], "owner": {"reputation": 22836, "user_id": 152786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/581hP.jpg?s=128&g=1", "display_name": "smathy", "link": "https://stackoverflow.com/users/152786/smathy"}, "is_accepted": false, "score": 1, "last_activity_date": 1426659064, "last_edit_date": 1426659064, "creation_date": 1426657855, "answer_id": 29114985, "question_id": 29114846, "link": "https://stackoverflow.com/questions/29114846/how-do-i-create-a-voting-system-in-rails-4-for-my-blog-posts-that-requires-more/29114985#29114985", "title": "How do I create a voting system in Rails 4 for my blog posts that requires more than two options for voting?", "body": "<p>(I'm assuming a user just picks one vote per post, and that you're using the latest Rails 4.2)</p>\n\n<p>Just create a new table that references both <code>User</code> and <code>Post</code> which has an integer field that we're going to use <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Enum.html\" rel=\"nofollow\">the new enum</a> with, eg. <code>Vote</code> with integer field <code>choice</code>, so the model will be:</p>\n\n<pre><code>class Vote &lt; ActiveRecord::Base\n  belongs_to :user\n  belongs_to :post\n\n  enum choice: %i[happy sad angry inspired boring anxious]\nend\n</code></pre>\n\n<p>And your <code>User</code> and <code>Post</code> models will both <code>has_many :votes</code></p>\n\n<p>Then (as per the docs) you use <code>Vote.choices</code> to get a hash of name to integer (you'll use this to populate your view).</p>\n\n<p>...and lastly, you'll get a hash of the count of emotions for a blog post with:</p>\n\n<pre><code>post.votes.group('votes.choice').count\n</code></pre>\n\n<p>I'm sure you can pick the most votes in there.</p>\n\n<h3>Update</h3>\n\n<p>The OP asked in a comment where I found this out, I thought my response to him might help others:</p>\n\n<blockquote>\n  <p>Hmm, well aside from <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Enum.html\" rel=\"nofollow\">the docs that I already linked you to in my answer</a>, I follow <a href=\"https://groups.google.com/forum/#!forum/rubyonrails-core\" rel=\"nofollow\">the rails-core mailing list</a> which announces and discusses upcoming features, I follow <a href=\"https://twitter.com/rails\" rel=\"nofollow\">@rails on twitter</a> where they announce all sorts of things, I read <a href=\"http://weblog.rubyonrails.org/releases/\" rel=\"nofollow\">the release notes for new versions</a> and I go through <a href=\"http://guides.rubyonrails.org/4_2_release_notes.html\" rel=\"nofollow\">the release notes in the guides</a> after major releases.</p>\n</blockquote>\n"}], "owner": {"reputation": 51, "user_id": 4625512, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cZdWIEzhvJw/AAAAAAAAAAI/AAAAAAAAABA/kVZtT3X0ISg/photo.jpg?sz=128", "display_name": "Michael Law", "link": "https://stackoverflow.com/users/4625512/michael-law"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1392, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1426659064, "creation_date": 1426657159, "question_id": 29114846, "link": "https://stackoverflow.com/questions/29114846/how-do-i-create-a-voting-system-in-rails-4-for-my-blog-posts-that-requires-more", "title": "How do I create a voting system in Rails 4 for my blog posts that requires more than two options for voting?", "body": "<p>I have built a very simple rails blog that is based on therapy-like sessions in real life. At the end of every blog post, a user can vote on the post where it says \"How does that make you feel?\"</p>\n\n<p>I am nearly finished developing the application but I can't figure out how to make an expanded voting system.</p>\n\n<p>There are 6 different emotion options that the user needs to be able to vote with (Happy, Sad, Angry, Inspired, Boring, Anxious). This means that one vote is not in any way better than the other. There are no positive and negative votes. They're just different.</p>\n\n<p>So far, all the gems and tutorials I have come across feature a voting system that consists of two options. I need a way to implement 6.</p>\n\n<p>Lastly, I would like to be able to count all of the total emotions belonging to a particular blog post and display the emotion with the most votes next to the title. </p>\n\n<p>Has anyone ever tried something like this? After I figure out how to do this, I would like to make it into a gem if there isn't already one.</p>\n"}, {"tags": ["c++", "ruby-on-rails", "ruby", "swig"], "comments": [{"owner": {"reputation": 22836, "user_id": 152786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/581hP.jpg?s=128&g=1", "display_name": "smathy", "link": "https://stackoverflow.com/users/152786/smathy"}, "edited": false, "score": 0, "creation_date": 1426657082, "post_id": 29114715, "comment_id": 46458065, "body": "The line of the stack trace you show is just the cleanup/reraise in Reloader, can you add the whole stack trace to your question please."}, {"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1426657181, "post_id": 29114715, "comment_id": 46458100, "body": "ha - when you have a stack-overflow... increasing the size of the stack won&#39;t help... you have something that is calling itself infinite numbers of times... unless you can create a literally infinite stack, you will continue to get StackOverflow (and even if you could accomplish such a feat, it wouldn&#39;t make the code work) ;)"}, {"owner": {"reputation": 35, "user_id": 3969541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6a004b51b10b33840766d8d3ac857b?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Wright", "link": "https://stackoverflow.com/users/3969541/tony-wright"}, "reply_to_user": {"reputation": 22836, "user_id": 152786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/581hP.jpg?s=128&g=1", "display_name": "smathy", "link": "https://stackoverflow.com/users/152786/smathy"}, "edited": false, "score": 0, "creation_date": 1426661978, "post_id": 29114715, "comment_id": 46459811, "body": "Sorry @smathy, that is the entire stack trace. Would love to add more. It crashes badly. Or is there a way to request more?"}, {"owner": {"reputation": 35, "user_id": 3969541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6a004b51b10b33840766d8d3ac857b?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Wright", "link": "https://stackoverflow.com/users/3969541/tony-wright"}, "edited": false, "score": 0, "creation_date": 1426662140, "post_id": 29114715, "comment_id": 46459881, "body": "Hah - thanks Taryn. Stacks are finite size, it is possible to overflow it without an infinite loop. As the error occurs in console but not server, this was not a silly thing to try. Perhaps that c-library was almost filling my ruby stack, and the added overhead / recursion of the server was overflowing it. It&#39;s not this, though, you are right that it&#39;s almost certainly an infinite loop."}, {"owner": {"reputation": 22836, "user_id": 152786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/581hP.jpg?s=128&g=1", "display_name": "smathy", "link": "https://stackoverflow.com/users/152786/smathy"}, "edited": false, "score": 0, "creation_date": 1426662283, "post_id": 29114715, "comment_id": 46459948, "body": "@TonyWright not sure if you can request more if it doesn&#39;t show any more than that. Sorry, no clue on your issue, too many moving parts for me."}], "owner": {"reputation": 35, "user_id": 3969541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a6a004b51b10b33840766d8d3ac857b?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Wright", "link": "https://stackoverflow.com/users/3969541/tony-wright"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1426656439, "creation_date": 1426656439, "question_id": 29114715, "link": "https://stackoverflow.com/questions/29114715/rails-server-vs-console-whats-the-difference", "title": "Rails Server vs. Console: What&#39;s the difference?", "body": "<p>Hello people who know more than me.</p>\n\n<p>I am calling a c++-library through a swig wrapper. When I run it in the rails console, and when I call it through my specs, it works fine. However, when I call it when in server mode, it gives </p>\n\n<blockquote>\n  <p>SystemStackError - stack level too deep:<br>\n  actionpack (4.2.0) lib/action_dispatch/middleware/reloader.rb:79:in `'</p>\n</blockquote>\n\n<p>And that's it!</p>\n\n<p>Does the fact that the problem occurs in server mode only point to anything in particular? No idea how to debug this.</p>\n\n<p>I've been using this in server mode for some time. But I restructured things slightly (called different methods within the c++ API) and it all broke suddenly, and only in server mode.</p>\n\n<p>An example (not sure it's terribly illuminating):</p>\n\n<pre><code>require 'awcbc' # Not gemified - is this significant? The awcbc.bundle et al is just plonked in an app/cbc directory\n\nclass SolverOfThings &lt; ActiveRecord::Base\n\n    def solve_something\n        model = Awcbc::Model_Builder.new\n        model.solve # Calls C++ library.\n    end\n\nend\n</code></pre>\n\n<p>Calling SolverOfThings::solve_something from, say, a controller, via html, breaks. Going into rails c and calling it, doesn't.</p>\n\n<p>I tried increasing the ruby stack size to something ridiculous, but no dice.</p>\n\n<p>Sorry, that's all I've got. Any clues?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "multithreading"], "answers": [{"tags": [], "owner": {"reputation": 32543, "user_id": 528726, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6307569a99dd77fff0463032051d7e39?s=128&d=identicon&r=PG", "display_name": "joelparkerhenderson", "link": "https://stackoverflow.com/users/528726/joelparkerhenderson"}, "is_accepted": true, "score": 2, "last_activity_date": 1426718900, "last_edit_date": 1426718900, "creation_date": 1426656327, "answer_id": 29114697, "question_id": 29114290, "link": "https://stackoverflow.com/questions/29114290/do-threads-in-ruby-improve-concurrency/29114697#29114697", "title": "Do threads in Ruby improve concurrency?", "body": "<p>Ruby MRI (a.k.a. YARV) threads can improve some kinds of operations, especially I/O.</p>\n\n<p>The VM runs one thread at a time, even on multi-core processors, because of a global lock. </p>\n\n<p>The VM has special optimizations for some operations including I/O. When a thread is waiting for an I/O operation, then Ruby transfers control to the next thread. It is also possible for threads to call non-Ruby code such as native C extensions, and these may be able to run in parallel.</p>\n\n<p>When I built an I/O uploader app on AWS, our benchmarks showed that in practice we could get total throughput benefits up to about 100 threads. We had a very fast network connection, and we found that the major benefit of the threading was coming because of the comparatively long time to open a new connection. </p>\n\n<p>Your mileage may vary, so benchmark.</p>\n"}, {"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1426667953, "post_id": 29114747, "comment_id": 46462305, "body": "I think this answer is misleading. You say &quot;Ruby still cannot do multiple things at the same time (parallelism)&quot;, but there is nothing in the Ruby Language Specification which prevents that. What <i>is</i> true, is that the Ruby Language Specification doesn&#39;t <i>guarantee</i> that threads can run in parallel, but that&#39;s no different from many other platforms. For example, neither the Java Language Specification nor the Java Virtual Machine Specification guarantee that, and there are in fact implementations of Java and the JVM which can&#39;t. (Heck, this is trivially the case for single-core systems.)"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1426668025, "post_id": 29114747, "comment_id": 46462340, "body": "The overwhelming majority of Ruby Implementations <i>can</i> run threads in parallel. Even YARV can do it, it just doesn&#39;t allow two parallel threads to run Ruby code."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 3, "last_activity_date": 1426656643, "creation_date": 1426656643, "answer_id": 29114747, "question_id": 29114290, "link": "https://stackoverflow.com/questions/29114290/do-threads-in-ruby-improve-concurrency/29114747#29114747", "title": "Do threads in Ruby improve concurrency?", "body": "<p>Threads in Ruby improve concurrency, but do not increase parallelism. What that means is that threads allow Ruby to deal with multiple things at the same time (concurrency), but Ruby still cannot do multiple things at the same time (parallelism).</p>\n\n<p>Why is this difference important? If your code needs a lot of CPU time, it will not improve from threads, because all threads have to use the same CPU. But if your code does a lot of IO (what usually means that the CPU is idling a lot), than your overall performance might improve a lot.</p>\n\n<p>In your example (uploading files to S3) I would expect an increase in performance depending on your network bandwidth.</p>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 3, "last_activity_date": 1426668290, "creation_date": 1426668290, "answer_id": 29117424, "question_id": 29114290, "link": "https://stackoverflow.com/questions/29114290/do-threads-in-ruby-improve-concurrency/29117424#29117424", "title": "Do threads in Ruby improve concurrency?", "body": "<p>YARV has a Giant VM Lock (GVL) that prevents two threads from entering the interpreter loop at the same time. That is true.</p>\n\n<p>However, this only means that you cannot have two parallel threads running Ruby code (or more precisely, YARV bytecode) at the same time. You <em>can</em> have parallel threads running C code at the same time (and the entire core library, as well as big parts of the standard library, and some Gems are actually written in C, not Ruby), you can have parallel threads doing or waiting for I/O, you can have C extensions do what they like in parallel threads (except running Ruby code).</p>\n\n<p>So, yes, threads <em>can</em> improve performance even on YARV.</p>\n"}], "owner": {"reputation": 9846, "user_id": 294089, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/379ae669ce4096c239984ed10f0799c7?s=128&d=identicon&r=PG", "display_name": "Roman", "link": "https://stackoverflow.com/users/294089/roman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 29114697, "answer_count": 3, "score": 1, "last_activity_date": 1426718900, "creation_date": 1426653790, "question_id": 29114290, "link": "https://stackoverflow.com/questions/29114290/do-threads-in-ruby-improve-concurrency", "title": "Do threads in Ruby improve concurrency?", "body": "<p>My question is specific to MRI. It looks like since Ruby 1.9 all threads are native but MRI continues to run them one at a time. This sounds like parallel execution of threads is not possible in MRI but does using Threads improve concurrency in your program for something that looks like this?</p>\n\n<p>In other words do you get any benefit from using threads to upload a lot of files onto S3?</p>\n\n<pre><code># https://gist.github.com/milesmatthias/25c15fd8384d4a7e76f2\n\n...    \n\nfile_number = 0\nmutex       = Mutex.new\nthreads     = []\n\nthread_count.times do |i|\n  threads[i] = Thread.new {\n    until files.empty?\n      mutex.synchronize do\n        file_number += 1\n        Thread.current[\"file_number\"] = file_number\n      end\n      file = files.pop rescue nil\n      next unless file\n\n      data = File.open(file)\n\n      if File.directory?(data)\n        data.close\n        next\n      else\n        obj = s3_bucket.objects[path]\n        obj.write(data, { acl: :public_read })\n        data.close\n      end\n\n    end\n  }\nend\nthreads.each { |t| t.join }\n\n...\n</code></pre>\n"}, {"tags": ["ruby", "mongodb", "geolocation", "mongoid"], "answers": [{"tags": [], "owner": {"reputation": 4271, "user_id": 2416049, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae3e41bd94866b970a7f2c5e8a16594c?s=128&d=identicon&r=PG", "display_name": "jtmarmon", "link": "https://stackoverflow.com/users/2416049/jtmarmon"}, "is_accepted": true, "score": 0, "last_activity_date": 1426662325, "last_edit_date": 1495535055, "creation_date": 1426662325, "answer_id": 29115988, "question_id": 29113981, "link": "https://stackoverflow.com/questions/29113981/how-to-select-units-for-within-query-in-mongoid-mongodb/29115988#29115988", "title": "How to select units for $within query in Mongoid / MongoDB", "body": "<p>You're using neither meters or kilometers. a 2d index means that you're saying your data is within a 2d coordinates system. <code>.00015</code> in your case means .00015 degrees. In a flat 2d plane (or on a 2dsphere index with close enough coordinates for the error margin to not matter) you can follow <a href=\"https://stackoverflow.com/a/7841830/2416049\">this</a> to convert to km.</p>\n\n<p>I also recommend you index using the 2dsphere index rather than the 2d index if you're using actual coordinates that may be any reasonable distance from each other, since the curvature of the earth will screw up mongodb's calculations if it thinks the world is flat.</p>\n"}, {"tags": [], "owner": {"reputation": 8871, "user_id": 4381282, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-rIutmC2tG4M/AAAAAAAAAAI/AAAAAAAAAE4/wicIrC8KhUs/photo.jpg?sz=128", "display_name": "Pawe\u0142 Dawczak", "link": "https://stackoverflow.com/users/4381282/pawe%c5%82-dawczak"}, "is_accepted": false, "score": 0, "last_activity_date": 1426662353, "creation_date": 1426662353, "answer_id": 29115992, "question_id": 29113981, "link": "https://stackoverflow.com/questions/29113981/how-to-select-units-for-within-query-in-mongoid-mongodb/29115992#29115992", "title": "How to select units for $within query in Mongoid / MongoDB", "body": "<p>This is very interesting question! I've been struggling with this too! Lot's of <em>googling</em>, but the answer was just in MongoDB <a href=\"http://docs.mongodb.org/v2.6/tutorial/calculate-distances-using-spherical-geometry-with-2d-geospatial-indexes/\" rel=\"nofollow\">documentation</a>.</p>\n\n<p>From here you can learn that:</p>\n\n<blockquote>\n  <p>For spherical query operators to function properly, you must convert distances to radians, and convert from radians to the distances units used by your application.</p>\n  \n  <p>To convert:</p>\n  \n  <ul>\n  <li>distance to radians: divide the distance by the radius of the sphere (e.g. the Earth) in the same units as the distance measurement.</li>\n  <li>radians to distance: multiply the radian measure by the radius of the sphere (e.g. the Earth) in the units system that you want to convert the distance to.</li>\n  </ul>\n  \n  <p>The radius of the Earth is approximately <strong>3,959</strong> miles or <strong>6,371</strong> kilometers.</p>\n</blockquote>\n\n<p>How can we use it? Try this:</p>\n\n<pre><code>db.places.find( { location: { $geoWithin: { $centerSphere: [ [ 12.948430, 77.573868 ] ,\n                                                           100 / 6371 ] } } } )\n</code></pre>\n\n<p><em>Please be advised, I used this technique and it worked for <strong>MongoDB 2.6</strong>.</em></p>\n\n<p>Hope that helps!</p>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 3, "user_id": 4683553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5942a2237c5c56a50d64fe21b3fb896?s=128&d=identicon&r=PG&f=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/4683553/siva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 29115988, "answer_count": 2, "score": 0, "last_activity_date": 1426662353, "creation_date": 1426651799, "question_id": 29113981, "link": "https://stackoverflow.com/questions/29113981/how-to-select-units-for-within-query-in-mongoid-mongodb", "title": "How to select units for $within query in Mongoid / MongoDB", "body": "<p>Following are my query, </p>\n\n<pre><code>db.places.save({\"location\":[ 12.948430, 77.573868 ]})\ndb.places.save({\"location\":[ 12.947813, 77.573653 ]})\ndb.places.ensureIndex( { \"location\" : \"2d\" } )\ndb.places.find({ \"location\" : { $within : { $center : [[12.948430, 77.573868],0.00015] } } })\n</code></pre>\n\n<p>In the query above how to select the units, is that meters or km?\nIf i want to do meters currently i'm doing 0.00015 for radius of 15 meters, is this correct? </p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 341, "user_id": 1053071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b509a31fbeaf1b890d38d1d47e88be9?s=128&d=identicon&r=PG", "display_name": "Jkarayusuf", "link": "https://stackoverflow.com/users/1053071/jkarayusuf"}, "edited": false, "score": 1, "creation_date": 1426653871, "post_id": 29113900, "comment_id": 46457155, "body": "Minor, we could use the Hash[] method instead of <code>to_h</code>.  <code>Hash[names.zip(weights.shuffle)]</code>"}, {"owner": {"reputation": 1475, "user_id": 1743874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/vQYev.png?s=128&g=1", "display_name": "Piccolo", "link": "https://stackoverflow.com/users/1743874/piccolo"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1426654913, "post_id": 29113900, "comment_id": 46457443, "body": "Thanks @CarySwoveland, I copied the other answer and just added the <code>.shuffle</code> to it and it worked, so I didn&#39;t realize that it was redundant."}], "tags": [], "owner": {"reputation": 1475, "user_id": 1743874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/vQYev.png?s=128&g=1", "display_name": "Piccolo", "link": "https://stackoverflow.com/users/1743874/piccolo"}, "is_accepted": false, "score": 5, "last_activity_date": 1426654935, "last_edit_date": 1426654935, "creation_date": 1426651171, "answer_id": 29113900, "question_id": 29113805, "link": "https://stackoverflow.com/questions/29113805/how-do-you-turn-an-array-into-a-hash-by-assigning-random-values-from-another-arr/29113900#29113900", "title": "How do you turn an array into a hash by assigning random values from another array?", "body": "<p>The other answer almost got it, but it didn't shuffle the <code>weights</code> array first, so it would always return the same hash.</p>\n\n<p>However, this will work as expected:</p>\n\n<pre><code>names.zip(weights.shuffle).to_h\n</code></pre>\n"}], "owner": {"reputation": 2162, "user_id": 3204212, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/fd870d2b3afe56cd9c59c28c0fc715bd?s=128&d=identicon&r=PG&f=1", "display_name": "GreenTriangle", "link": "https://stackoverflow.com/users/3204212/greentriangle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1426654935, "creation_date": 1426650422, "last_edit_date": 1426652981, "question_id": 29113805, "link": "https://stackoverflow.com/questions/29113805/how-do-you-turn-an-array-into-a-hash-by-assigning-random-values-from-another-arr", "title": "How do you turn an array into a hash by assigning random values from another array?", "body": "<p>I have an array, <code>names</code>, containing 12 names.</p>\n\n<p>I have another array, <code>weights</code>, containing 12 numbers.</p>\n\n<p>I want to create a hash where the keys are names, and the values weights. </p>\n\n<p>The weight figures are predetermined (they should always be, for example, 200, 150, and 180), but they should be assigned to random names each time the program is run.</p>\n\n<p>For example, if I use the arrays <code>names = ['homer', 'marge', 'maggie']</code> and <code>weights = [265, 140, 10]</code>, I could run the program and get <code>{homer: 140, marge: 265, maggie: 10}</code>, then rerun it and get <code>{homer: 10, marge: 140, maggie: 265}</code>.</p>\n\n<p>What is the sensible way to do this?</p>\n"}, {"tags": ["ruby", "regex", "string", "search"], "answers": [{"comments": [{"owner": {"reputation": 7898, "user_id": 3437900, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/blKgR.jpg?s=128&g=1", "display_name": "illusionist", "link": "https://stackoverflow.com/users/3437900/illusionist"}, "edited": false, "score": 0, "creation_date": 1426652254, "post_id": 29113387, "comment_id": 46456726, "body": "does this answer satisfy the question {string after &quot;a&quot; and before first &quot;.&quot;}? @spickermann"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 7898, "user_id": 3437900, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/blKgR.jpg?s=128&g=1", "display_name": "illusionist", "link": "https://stackoverflow.com/users/3437900/illusionist"}, "edited": false, "score": 0, "creation_date": 1426653911, "post_id": 29113387, "comment_id": 46457166, "body": "@CbaBhusal The string after the &#39;a&#39; but before the first &#39;.&#39; is just the empty string between that two characters. But I think it is obvious what sub string he really wanted. So, yes I think it satisfies the question."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 0, "last_activity_date": 1426647423, "creation_date": 1426647423, "answer_id": 29113387, "question_id": 29113306, "link": "https://stackoverflow.com/questions/29113306/ruby-find-scan-search-a-string-in-a-sentence-in/29113387#29113387", "title": "Ruby : find/scan/search a string in a sentence in", "body": "<p>You can do that with a simple regexp:</p>\n\n<pre><code> string = '/a.117228558440230.24692.116944575135295/65456'\n\n regexp = /\\D\\.(\\d*)\\./\n regexp.match(string)[1]\n #=&gt; \"117228558440230\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32543, "user_id": 528726, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6307569a99dd77fff0463032051d7e39?s=128&d=identicon&r=PG", "display_name": "joelparkerhenderson", "link": "https://stackoverflow.com/users/528726/joelparkerhenderson"}, "is_accepted": false, "score": 1, "last_activity_date": 1426650322, "creation_date": 1426650322, "answer_id": 29113794, "question_id": 29113306, "link": "https://stackoverflow.com/questions/29113306/ruby-find-scan-search-a-string-in-a-sentence-in/29113794#29113794", "title": "Ruby : find/scan/search a string in a sentence in", "body": "<p>One way is to find the \"a.\" then capture everything until the next \".\" like this:</p>\n\n<pre><code>result = sentence =~ /a\\.(.*?)\\./ &amp;&amp; $1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7898, "user_id": 3437900, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/blKgR.jpg?s=128&g=1", "display_name": "illusionist", "link": "https://stackoverflow.com/users/3437900/illusionist"}, "is_accepted": false, "score": 0, "last_activity_date": 1462339918, "creation_date": 1462339918, "answer_id": 37019221, "question_id": 29113306, "link": "https://stackoverflow.com/questions/29113306/ruby-find-scan-search-a-string-in-a-sentence-in/37019221#37019221", "title": "Ruby : find/scan/search a string in a sentence in", "body": "<p>You can also give a try to this</p>\n\n<pre><code>str = \"/a.**117228558440230**.24692.116944575135295/65456\"\n\nstr[/\\D\\.(\\d*)\\./]\n=&gt;  \"*.24692.\" \n</code></pre>\n\n<p>This methods gives you the string if available in the sentence otherwise <code>nil</code></p>\n"}], "owner": {"reputation": 73, "user_id": 2272260, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2ffaff6d95e218fe2706373c0c5ddb22?s=128&d=identicon&r=PG", "display_name": "user2272260", "link": "https://stackoverflow.com/users/2272260/user2272260"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 29113387, "answer_count": 3, "score": 0, "last_activity_date": 1462340093, "creation_date": 1426646857, "last_edit_date": 1462340093, "question_id": 29113306, "link": "https://stackoverflow.com/questions/29113306/ruby-find-scan-search-a-string-in-a-sentence-in", "title": "Ruby : find/scan/search a string in a sentence in", "body": "<p>I am trying to find a string in a sentence </p>\n\n<p><code>/a.**117228558440230**.24692.116944575135295/65456</code></p>\n\n<p>want the string after <code>a</code> and before first <code>.</code> in ruby on rails</p>\n\n<p>thanks in advance</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "button", "submit", "radio"], "comments": [{"owner": {"reputation": 6404, "user_id": 3363019, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/129352fb15374b8febd37cc99150c7c5?s=128&d=identicon&r=PG", "display_name": "patrick", "link": "https://stackoverflow.com/users/3363019/patrick"}, "edited": false, "score": 0, "creation_date": 1426654113, "post_id": 29113099, "comment_id": 46457223, "body": "Do you want to display the GPA in the same view?"}, {"owner": {"reputation": 1, "user_id": 4678402, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152656892126791/picture?type=large", "display_name": "Lalo ", "link": "https://stackoverflow.com/users/4678402/lalo"}, "reply_to_user": {"reputation": 6404, "user_id": 3363019, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/129352fb15374b8febd37cc99150c7c5?s=128&d=identicon&r=PG", "display_name": "patrick", "link": "https://stackoverflow.com/users/3363019/patrick"}, "edited": false, "score": 0, "creation_date": 1426704479, "post_id": 29113099, "comment_id": 46486277, "body": "Yes in the same view is my classes so underneath it is where the radio buttons go"}], "answers": [{"tags": [], "owner": {"reputation": 957, "user_id": 3383766, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/0VRyM.jpg?s=128&g=1", "display_name": "Chirag", "link": "https://stackoverflow.com/users/3383766/chirag"}, "is_accepted": false, "score": 0, "last_activity_date": 1427970987, "creation_date": 1427970987, "answer_id": 29410829, "question_id": 29113099, "link": "https://stackoverflow.com/questions/29113099/ruby-on-rails-how-to-use-submit-button-with-radio-buttons/29410829#29410829", "title": "Ruby on Rails how to use submit button with radio buttons", "body": "<h2>SHORT ANSWER</h2>\n\n<ul>\n<li>Make an instance variable @gpa in TransController's transcript action</li>\n<li>In the transcript action, check for params[:gpa]\n<ul>\n<li>set @gpa &amp; @transcript to nil if params[:gpa].nil?</li>\n<li>set @gpa to params[:gpa] and @transcript accordingly if params[:gpa] is not nil</li>\n</ul></li>\n<li>In the view/trans/transcript.html.erb\n<ul>\n<li>If @gpa is nil, display nothing</li>\n<li>If @gpa == \"Major\" show @transcript.GPA_for_major</li>\n<li>If @gpa == \"All\" show @transcript.GPA_for_non_major</li>\n</ul></li>\n</ul>\n\n<h2>LONG ANSWER</h2>\n\n<p>Assuming that the controller is trans and the action is transcript, here is what you should do in TransController</p>\n\n<pre><code>class TransController &lt; ApplicationController\n\n  def transcript\n    if params[:gpa].nil?\n      @transcript = @gpa = nil\n    else\n      @gpa = params[:gpa]\n      @transcript = ... # Find your transcript here\n    end\n  end\n  # ... other actions\n  # ... other actions\n  # ... other actions\nend\n</code></pre>\n\n<p>and here is how the trans/transcript.html.erb view should look like - </p>\n\n<pre><code>&lt;h2&gt;Please select which GPA you would like to view:&lt;/h2&gt;\n&lt;%= form_tag('trans/transcript', :method =&gt; \"get\") do %&gt;\n  &lt;table&gt;\n    &lt;tr&gt;\n      &lt;th&gt;Major Credits&lt;/th&gt;\n      &lt;th&gt;All Credits&lt;/th&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n      &lt;td&gt;Major&lt;%= radio_button_tag(:gpa, \"Major\") %&gt;&lt;/td&gt;\n      &lt;td&gt;All&lt;%= radio_button_tag(:gpa, \"All\") %&gt; &lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;/table&gt;\n  &lt;%= submit_tag(\"View GPA\") %&gt;\n&lt;% end %&gt;\n\n&lt;% if @gpa == \"Major\" %&gt;\n  &lt;%= @transcript.GPA_for_major %&gt;\n&lt;% elsif @gpa == \"All\" %&gt;\n  &lt;%= @transcript.GPA_for_major %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4678402, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152656892126791/picture?type=large", "display_name": "Lalo ", "link": "https://stackoverflow.com/users/4678402/lalo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 482, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427970987, "creation_date": 1426645240, "question_id": 29113099, "link": "https://stackoverflow.com/questions/29113099/ruby-on-rails-how-to-use-submit-button-with-radio-buttons", "title": "Ruby on Rails how to use submit button with radio buttons", "body": "<p>For my final project I need to create two radio buttons with a submit button that will display my GPA for all my classes and those in my major. I can have them displayed easily but am stuck when I need to use radio buttons to display only one</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;h2&gt;Please select which GPA you would like to view:&lt;/h2&gt;\r\n\r\n&lt;%= form_tag(\"/trans/transcript\", :method =&gt; \"get\") do %&gt;\r\n&lt;table&gt;\r\n  &lt;tr&gt;\r\n    \r\n\t&lt;th&gt;Major Credits&lt;/th&gt;\r\n\t&lt;th&gt;All Credits&lt;/th&gt;\r\n  &lt;/tr&gt;\r\n  &lt;tr&gt;\r\n    \r\n\t&lt;td&gt;&lt;%= radio_button_tag(:gpa, \"Major\") %&gt;&lt;/td&gt;\r\n\t&lt;td&gt;&lt;%= radio_button_tag(:gpa, \"All\") %&gt; &lt;/td&gt;\r\n  &lt;/tr&gt;\r\n  \r\n  \r\n&lt;/table&gt;\r\n  &lt;%= submit_tag(\"View GPA\") %&gt;\r\n&lt;% end %&gt;\r\n\r\n\r\n\r\n&lt;p&gt; Major credits GPA  &lt;%= @transcript.GPA_for_major %&gt;\r\n&lt;p&gt; All credits GPA  &lt;%= @transcript.GPA_for_non_major %&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Everything appears fine but I'm not sure how to set up the controller to say if he clicks the major gpa radio button and clicks \"View GPA\" this &lt;%= @transcript.GPA_for_major %>  should display</p>\n"}, {"tags": ["ruby", "rubygems", "bundler"], "answers": [{"tags": [], "owner": {"reputation": 32543, "user_id": 528726, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6307569a99dd77fff0463032051d7e39?s=128&d=identicon&r=PG", "display_name": "joelparkerhenderson", "link": "https://stackoverflow.com/users/528726/joelparkerhenderson"}, "is_accepted": true, "score": 1, "last_activity_date": 1426647147, "creation_date": 1426647147, "answer_id": 29113350, "question_id": 29113097, "link": "https://stackoverflow.com/questions/29113097/bundle-doesnt-know-what-ruby-is/29113350#29113350", "title": "bundle doesn&#39;t know what ruby is?", "body": "<p>You have Ruby installed, because bundler is using it.</p>\n\n<p>Somehow your bundle path doesn't have Ruby, or has lost track of it.</p>\n\n<p>To solve this, use <code>bundle --path</code>, such as:</p>\n\n<pre><code>bundle --path \"C:\\foo\\goo\\hoo\\ruby\\bin\" \n</code></pre>\n\n<p>The path is wherever you put Ruby on your system, plus any other path items that you want be available to bundler, such as <code>bin</code> directories of other software.</p>\n\n<p>Bundler will remember the path for future installs on this machine.</p>\n"}], "owner": {"reputation": 2753, "user_id": 2009612, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/VGBK2.jpg?s=128&g=1", "display_name": "FilBot3", "link": "https://stackoverflow.com/users/2009612/filbot3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 1, "accepted_answer_id": 29113350, "answer_count": 1, "score": 0, "last_activity_date": 1426647147, "creation_date": 1426645228, "question_id": 29113097, "link": "https://stackoverflow.com/questions/29113097/bundle-doesnt-know-what-ruby-is", "title": "bundle doesn&#39;t know what ruby is?", "body": "<p>So, not too long ago, this command worked on my computer, however, I don't remember if I changed something, but now after removing all my Ruby installs, and just having ChefDK 0.4.0 installed and in my path with the .chefdk/gem, and C:\\opscode\\chefdk\\bin;C:\\opscode\\chefdk\\embedded\\bin in my path, I get the following result. </p>\n\n<pre><code>C:\\Users\\Phillip\\Desktop\\password_vault\n\u03bb bundle exec ruby bin\\password_vault\nbundler: command not found: ruby\nInstall missing gem executables with `bundle install`\n\nC:\\Users\\Phillip\\Desktop\\password_vault\n\u03bb bundle install\nResolving dependencies...\nUsing rake 10.4.2\nUsing bundler 1.8.5\nUsing rack 1.6.0\nUsing rack-protection 1.5.3\nUsing tilt 1.4.1\nUsing sinatra 1.4.5\nUsing password_vault 0.0.1 from source at .\nBundle complete! 3 Gemfile dependencies, 7 gems now installed.\nUse `bundle show [gemname]` to see where a bundled gem is installed.\n\nC:\\Users\\Phillip\\Desktop\\password_vault\n\u03bb bundle exec ruby bin\\password_vault\nbundler: command not found: ruby\nInstall missing gem executables with `bundle install`\n\nC:\\Users\\Phillip\\Desktop\\password_vault\n</code></pre>\n\n<p>I'm not sure what all else I could be doing wrong. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "migration"], "comments": [{"owner": {"reputation": 648, "user_id": 10313894, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hVS6l.jpg?s=128&g=1", "display_name": "ARK", "link": "https://stackoverflow.com/users/10313894/ark"}, "edited": false, "score": 0, "creation_date": 1576666980, "post_id": 29113046, "comment_id": 104971262, "body": "<code>has_many :behaviours</code> and <code>has_many :stabilizers</code>   <code>has_many</code> requires plural in rails."}], "answers": [{"tags": [], "owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "is_accepted": true, "score": 1, "last_activity_date": 1426648827, "creation_date": 1426648827, "answer_id": 29113589, "question_id": 29113046, "link": "https://stackoverflow.com/questions/29113046/rails-has-many-through-migration/29113589#29113589", "title": "Rails has_many_through migration", "body": "<pre><code>$ rails g model behaviours_rel competence_id:integer behaviour_id:integer\n\n$ rails g model stabilizers_rel competence_id:integer stabilizer_id:integer\n\n$ bundle exec rake db:migrate\n</code></pre>\n\n<p>See: <a href=\"http://www.codequizzes.com/learn-rails/many-to-many-relationships\" rel=\"nofollow\">http://www.codequizzes.com/learn-rails/many-to-many-relationships</a></p>\n"}], "owner": {"reputation": 640, "user_id": 3565899, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/216192e36dd32ea09bed81f758a55909?s=128&d=identicon&r=PG", "display_name": "Abdul Hamid", "link": "https://stackoverflow.com/users/3565899/abdul-hamid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4092, "favorite_count": 0, "accepted_answer_id": 29113589, "answer_count": 1, "score": 0, "last_activity_date": 1576675763, "creation_date": 1426644866, "last_edit_date": 1576675763, "question_id": 29113046, "link": "https://stackoverflow.com/questions/29113046/rails-has-many-through-migration", "title": "Rails has_many_through migration", "body": "<p>I'm creating a many_to_many association for the following models:</p>\n\n<pre><code>class Competence &lt; ActiveRecord::Base\n    has_many :behaviour, through: :behaviours_rel\n    has_many :stabilizer, through: :stabilizers_rel\nend\n\nclass Behaviour &lt; ActiveRecord::Base\n    belongs_to :competence\nend\n\nclass Stabilizer &lt; ActiveRecord::Base\n    belongs_to :competence\nend\n</code></pre>\n\n<p>I believe I have to do something like:</p>\n\n<pre><code>rails generate migration behaviour:belongs_to \n</code></pre>\n\n<p>but it doesn't work. I simply can't get the logic of doing this migration with rails generate.</p>\n\n<p>I'm trying to save in a competence several behaviours so a one_to_many relationship is not enough.</p>\n\n<p>By the way, I don't want to do it explicitly with sql table.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "transactions"], "comments": [{"owner": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "edited": false, "score": 0, "creation_date": 1531754509, "post_id": 29112989, "comment_id": 89702659, "body": "<a href=\"https://github.com/grosser/ar_after_transaction\" rel=\"nofollow noreferrer\">ar_after_transaction</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4891, "user_id": 654071, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b1cc288c2eec79f814983455c27f26ac?s=128&d=identicon&r=PG", "display_name": "ted", "link": "https://stackoverflow.com/users/654071/ted"}, "edited": false, "score": 0, "creation_date": 1426648930, "post_id": 29113393, "comment_id": 46456014, "body": "I don&#39;t know where the transaction starts and ends. Imagine there&#39;s 15 callbacks chain some of which can start the transaction and there a shared piece of code you want to be executed after transaction is completed"}], "tags": [], "owner": {"reputation": 4999, "user_id": 4151953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d405a824f3f34d13b9e57532532f99?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Babio", "link": "https://stackoverflow.com/users/4151953/alejandro-babio"}, "is_accepted": false, "score": -2, "last_activity_date": 1426671819, "last_edit_date": 1426671819, "creation_date": 1426647465, "answer_id": 29113393, "question_id": 29112989, "link": "https://stackoverflow.com/questions/29112989/triggering-a-method-after-transaction-commits/29113393#29113393", "title": "Triggering a method after transaction commits", "body": "<p>You must use this pattern, with the <code>save!</code> (that raises exception on error):</p>\n\n<pre><code>begin\n  do_this_before_update_the_db\n  ActiveRecord::Base.transaction do\n    update_1_db_if_no_fails\n    update_2_db_if_no_fails\n    ...\n    update_n_db_if_no_fails\n  end\n  DO-THIS-AFTER-COMMIT-ONLY-IF-NO-EXCEPTIONS\nrescue Exception =&gt; exception\n  do_this_if_some_update_fails # depending on the exception you must raise again from here.\nensure\n  do_this_always_fail_or_no # this runs after commit\nend\n</code></pre>\n\n<p>You can't put <code>after_commit</code> inside the transaction, because this run inside the transaction, before the commit is done. </p>\n\n<p>All that is inside the transaction block runs with one commit at the end of the block. All callbacks runs inside this transaction. And all indented transactions runs inside this transaction (with only one commit). You can found detailed information <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/DatabaseStatements.html#method-i-transaction\" rel=\"nofollow\">here</a>.</p>\n\n<p>You must see that at the log, with only one commit at the end.</p>\n\n<p>Also you can have this pattern on <code>update_2_db_if_no_fails</code>, with an ensure block that runs always fail or no the update_2. This run inside the first transaction, but is something different of your model after_commit callback.</p>\n"}, {"tags": [], "owner": {"reputation": 2634, "user_id": 1210949, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/vAL35.jpg?s=128&g=1", "display_name": "Albin", "link": "https://stackoverflow.com/users/1210949/albin"}, "is_accepted": false, "score": -2, "last_activity_date": 1426662723, "creation_date": 1426662723, "answer_id": 29116068, "question_id": 29112989, "link": "https://stackoverflow.com/questions/29112989/triggering-a-method-after-transaction-commits/29116068#29116068", "title": "Triggering a method after transaction commits", "body": "<p>As I understand your question you want to define code that should be run after the transaction inside a transation? But you do not want to run it straight away?</p>\n\n<p>If this is the case it can be achieved with a <code>proc</code>. Info about <a href=\"http://ruby-doc.org/core-2.1.1/Proc.html\" rel=\"nofollow\">procs</a>.</p>\n\n<p>So the code would be something like:</p>\n\n<pre><code> no_exceptions = true\n ActiveRecord::Base.transaction do\n   do_this\n   after_code = Proc.new do |no_e|\n     # Code defining how to act no_e gives you info if exceptions where fired.\n   end\n   do_that\n rescue Exception =&gt; e\n   no_exceptions = false\n end\n after_code.call(no_exceptions)\n</code></pre>\n\n<p>I hope this was what you where looking for.</p>\n"}], "owner": {"reputation": 4891, "user_id": 654071, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b1cc288c2eec79f814983455c27f26ac?s=128&d=identicon&r=PG", "display_name": "ted", "link": "https://stackoverflow.com/users/654071/ted"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1531, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1426685671, "creation_date": 1426644441, "last_edit_date": 1426685671, "question_id": 29112989, "link": "https://stackoverflow.com/questions/29112989/triggering-a-method-after-transaction-commits", "title": "Triggering a method after transaction commits", "body": "<pre><code>ActiveRecord::Base.transaction do\n  do_this\n  Something.after_commit.action\n  do_that\nend\n# Something.action is fired/run in case no exceptions in transaction\n</code></pre>\n\n<p>How can one achieve this?</p>\n\n<p>NOTE: one doesn't see where the transaction starts and ends (I mean <code>transaction do</code> and <code>end</code>)</p>\n"}, {"tags": ["ruby", "ruby-2.2"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 1, "creation_date": 1426644327, "post_id": 29112861, "comment_id": 46454957, "body": "<code>@var2</code> is an instance variable, and <code>@@var3</code> is a class variable. If you want to access them from outside the scope of the class definition, you need getters/setters. <i>E.g.</i>, inside <code>class Hello</code>, <code>def var2 @var2 end</code>, etc."}, {"owner": {"reputation": 1558, "user_id": 2126725, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/651be73a06a63f54dbddf75624b56ef9?s=128&d=identicon&r=PG&f=1", "display_name": "SeasonalShot", "link": "https://stackoverflow.com/users/2126725/seasonalshot"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1426644402, "post_id": 29112861, "comment_id": 46454976, "body": "So to access those variables we need to access them through a function only right?"}, {"owner": {"reputation": 1558, "user_id": 2126725, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/651be73a06a63f54dbddf75624b56ef9?s=128&d=identicon&r=PG&f=1", "display_name": "SeasonalShot", "link": "https://stackoverflow.com/users/2126725/seasonalshot"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1426644462, "post_id": 29112861, "comment_id": 46454994, "body": "Makes the PERFECT sense. Thanks."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1426644527, "post_id": 29112861, "comment_id": 46455016, "body": "You can also use, <code>obj.instance_variable_get(:@var2)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1558, "user_id": 2126725, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/651be73a06a63f54dbddf75624b56ef9?s=128&d=identicon&r=PG&f=1", "display_name": "SeasonalShot", "link": "https://stackoverflow.com/users/2126725/seasonalshot"}, "edited": false, "score": 0, "creation_date": 1426644721, "post_id": 29112992, "comment_id": 46455068, "body": "Thanks. In a related Topic, it makes no sense to declare a variable with a single <code>@</code> inside the class methods right? (Because a class method can only access a class variable and so we define by a double @@)"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 1558, "user_id": 2126725, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/651be73a06a63f54dbddf75624b56ef9?s=128&d=identicon&r=PG&f=1", "display_name": "SeasonalShot", "link": "https://stackoverflow.com/users/2126725/seasonalshot"}, "edited": false, "score": 0, "creation_date": 1426645050, "post_id": 29112992, "comment_id": 46455160, "body": "Nope. Depending on the use case it might make perfectly sense to use a class level instance variable (for example for a global state). Whereas I can hardly think about a good example for a class hierarchy variable. I would argue that a class level instance variable is always preferred over a class hierarchy variable. And the later is almost everytime a bad decision."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1426644448, "creation_date": 1426644448, "answer_id": 29112992, "question_id": 29112861, "link": "https://stackoverflow.com/questions/29112861/what-is-the-use-of-a-variable-in-the-class-body/29112992#29112992", "title": "What is the use of a variable in the class body?", "body": "<p><code>@var2</code> is a class level instance variable, whereas <code>@@var3</code> is a class hierarchy variable.</p>\n\n<p>An article about <a href=\"http://www.railstips.org/blog/archives/2006/11/18/class-and-instance-variables-in-ruby/\" rel=\"nofollow\">usage and differences</a> between both of them. The important thing to remember: When you declare a class hierachy variable, it is shared between the class and all descending (inheriting) classes. This is rarely what you want.</p>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 0, "last_activity_date": 1426668478, "creation_date": 1426668478, "answer_id": 29117476, "question_id": 29112861, "link": "https://stackoverflow.com/questions/29112861/what-is-the-use-of-a-variable-in-the-class-body/29117476#29117476", "title": "What is the use of a variable in the class body?", "body": "<p>Classes are objects just like any other object. Objects can have instance variables. Ergo, classes can have instance variables.</p>\n\n<p>There's really nothing special about that. That's very important to understand in Ruby.</p>\n"}], "owner": {"reputation": 1558, "user_id": 2126725, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/651be73a06a63f54dbddf75624b56ef9?s=128&d=identicon&r=PG&f=1", "display_name": "SeasonalShot", "link": "https://stackoverflow.com/users/2126725/seasonalshot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1426668478, "creation_date": 1426643475, "last_edit_date": 1426644374, "question_id": 29112861, "link": "https://stackoverflow.com/questions/29112861/what-is-the-use-of-a-variable-in-the-class-body", "title": "What is the use of a variable in the class body?", "body": "<p>I understand that when we define a class variable in ruby it's preceded with \n<code>@@variableName</code> but in this code</p>\n\n<pre><code>class Hello\n    @var2\n    @@var3=0\n    def foo1\n        return @var1\n    end\n    def set_foo1(par1)\n        @var1=par1\n    end\nend\n</code></pre>\n\n<p><br> I understand that var3 is a class variable and has to be initialized with some value. But what about var2? Is var2 still corresponds to an object?</p>\n\n<p>When i called the program with  <code>obj1.var2=100</code> i get a <strong>noMethodError</strong></p>\n\n<p>Also, when i call puts <code>Hello.var3</code> i get the same <strong>noMethodError</strong></p>\n\n<p>Can anyone please explain where i am getting it wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "view", "each"], "comments": [{"owner": {"reputation": 1834, "user_id": 3263969, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/26777f2a7b799fb0d9d4fa002b6c7ead?s=128&d=identicon&r=PG", "display_name": "maxhungry", "link": "https://stackoverflow.com/users/3263969/maxhungry"}, "edited": false, "score": 0, "creation_date": 1426642922, "post_id": 29112715, "comment_id": 46454624, "body": "have you try <code>@others.find_by(:ID =&gt; thing.ID)</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 25560, "user_id": 14253, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/235c58ad566abb4c7979bc7033e9882c?s=128&d=identicon&r=PG", "display_name": "DGM", "link": "https://stackoverflow.com/users/14253/dgm"}, "is_accepted": true, "score": 1, "last_activity_date": 1426643491, "creation_date": 1426643491, "answer_id": 29112865, "question_id": 29112715, "link": "https://stackoverflow.com/questions/29112715/ruby-on-rails-code-in-each-loop-in-view/29112865#29112865", "title": "Ruby On Rails, code in each loop in view", "body": "<p>You have <code>==</code> when you need <code>=&gt;</code></p>\n\n<p><code>:ID == thing.ID</code> is evaluated to false, which leads to:</p>\n\n<p><code>@others.find_by(false)</code>  which happens to return the first record every time.</p>\n\n<p>Also, your naming of attributes is not standard - by rails convention they should be small letters:  <code>other.name</code></p>\n"}, {"tags": [], "owner": {"reputation": 85, "user_id": 3395363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a817c6f2e4ddb1a9854721a0fe4d3e?s=128&d=identicon&r=PG&f=1", "display_name": "user3395363", "link": "https://stackoverflow.com/users/3395363/user3395363"}, "is_accepted": false, "score": 0, "last_activity_date": 1426678896, "creation_date": 1426678896, "answer_id": 29121104, "question_id": 29112715, "link": "https://stackoverflow.com/questions/29112715/ruby-on-rails-code-in-each-loop-in-view/29121104#29121104", "title": "Ruby On Rails, code in each loop in view", "body": "<p>you can used following query to find 'other'</p>\n\n<pre><code>other = @others.find_by_ID(thing.ID)\n</code></pre>\n\n<p>if record not found it will return 'nil' and not 'record not found' error.\nYou can used</p>\n\n<pre><code>other.try(:NAME)\n</code></pre>\n\n<p>other.name will give error if 'other = nil'.</p>\n"}], "owner": {"reputation": 13, "user_id": 4683242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe2bc56a80a0c75fa453deace4122d64?s=128&d=identicon&r=PG&f=1", "display_name": "szte99", "link": "https://stackoverflow.com/users/4683242/szte99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 704, "favorite_count": 0, "accepted_answer_id": 29112865, "answer_count": 2, "score": 1, "last_activity_date": 1426678896, "creation_date": 1426642273, "question_id": 29112715, "link": "https://stackoverflow.com/questions/29112715/ruby-on-rails-code-in-each-loop-in-view", "title": "Ruby On Rails, code in each loop in view", "body": "<p>I have a little problem...\nMy View:</p>\n\n<pre><code>  --html---\n    &lt;% @things each do |thing| %&gt;\n    &lt;% other = @others.find_by(:ID == thing.ID)%&gt;----&gt;it runs just once. Why? \n      &lt;div&gt;    \n        &lt;p&gt;thing.ID&lt;/p&gt; ---------------&gt;  This is correct.\n        &lt;p&gt;other.NAME&lt;/p&gt; -------------&gt; But it isn't. It is always same (fisrt value..).\n      &lt;/div&gt;\n    &lt;%end%&gt;\n  --html--\n</code></pre>\n\n<p>I like this, that the other.NAME changes too. Thanks for the help!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1755, "user_id": 3247496, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/nDtef.png?s=128&g=1", "display_name": "Ahmad Al-kheat", "link": "https://stackoverflow.com/users/3247496/ahmad-al-kheat"}, "edited": false, "score": 0, "creation_date": 1426642023, "post_id": 29112661, "comment_id": 46454362, "body": "which line is the error?"}, {"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 1, "creation_date": 1426642044, "post_id": 29112661, "comment_id": 46454367, "body": "remove  the <code>true</code> in <code>presence: true { message:</code>, same for <code>uniqueness: true { messa</code>"}, {"owner": {"reputation": 49, "user_id": 4683258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v9WF5.jpg?s=128&g=1", "display_name": "LadyStensberg", "link": "https://stackoverflow.com/users/4683258/ladystensberg"}, "edited": false, "score": 0, "creation_date": 1426642276, "post_id": 29112661, "comment_id": 46454429, "body": "getting the error on all lines"}, {"owner": {"reputation": 7894, "user_id": 981616, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/92513702d30405c7e2ca056bdc72aa9f?s=128&d=identicon&r=PG", "display_name": "uday", "link": "https://stackoverflow.com/users/981616/uday"}, "edited": false, "score": 0, "creation_date": 1426642303, "post_id": 29112661, "comment_id": 46454438, "body": "show the error msg please."}], "answers": [{"tags": [], "owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "is_accepted": true, "score": 1, "last_activity_date": 1426642504, "creation_date": 1426642504, "answer_id": 29112749, "question_id": 29112661, "link": "https://stackoverflow.com/questions/29112661/syntax-error-unexpected-expecting-keyword-end/29112749#29112749", "title": "syntax error, unexpected &#39;{&#39;, expecting keyword_end", "body": "<p>Every place you've used <code>something: true { ... }</code> is a syntax error. You cannot put a <code>true</code> there.</p>\n\n<pre><code>validates :name, ..., presence: true { message: \"All fields are required. Please try again.\" }\n</code></pre>\n\n<p>needs to be</p>\n\n<pre><code>validates :name, ..., presence: { message: \"All fields are required. Please try again.\" }\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 4683258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v9WF5.jpg?s=128&g=1", "display_name": "LadyStensberg", "link": "https://stackoverflow.com/users/4683258/ladystensberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 0, "accepted_answer_id": 29112749, "answer_count": 1, "score": -2, "last_activity_date": 1426642504, "creation_date": 1426641826, "last_edit_date": 1426642225, "question_id": 29112661, "link": "https://stackoverflow.com/questions/29112661/syntax-error-unexpected-expecting-keyword-end", "title": "syntax error, unexpected &#39;{&#39;, expecting keyword_end", "body": "<p>Getting this above error on the following code:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n    validates :name, :email, :username, :password, presence: true { message: \"All fields are required. Please try again.\" }\n    validates :age, numericality: { greater_than: 18, message: \"Your might be 18 or older to use this app.\" }\n    validates :email, uniqueness: true { message: \"This email address is already taken. Please login instead.\" }\n    validates :username, uniqueness: true { message: \"This username is already taken. Please try again.\" }\n    validates :password, length: { minimum: 6, too_short: \"%{count} characters is the maximum allowed\" }        \nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 25272, "user_id": 1695163, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/85ffb58dc3ed0067128804ef843245a6?s=128&d=identicon&r=PG", "display_name": "ddavison", "link": "https://stackoverflow.com/users/1695163/ddavison"}, "edited": false, "score": 1, "creation_date": 1426642734, "post_id": 29112592, "comment_id": 46454576, "body": "another way to write it, would be to use <code>%( .................................. )</code>"}, {"owner": {"reputation": 705, "user_id": 1260715, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4c57872b82006176ffcaf211f19421b3?s=128&d=identicon&r=PG", "display_name": "Adam Keenan", "link": "https://stackoverflow.com/users/1260715/adam-keenan"}, "edited": false, "score": 1, "creation_date": 1426643075, "post_id": 29112592, "comment_id": 46454664, "body": "By the way if you were curious it looks as though the function this is used in is just building and returning a string of LESS or some other similar CSS thing with variables."}], "answers": [{"comments": [{"owner": {"reputation": 25272, "user_id": 1695163, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/85ffb58dc3ed0067128804ef843245a6?s=128&d=identicon&r=PG", "display_name": "ddavison", "link": "https://stackoverflow.com/users/1695163/ddavison"}, "edited": false, "score": 0, "creation_date": 1426642668, "post_id": 29112741, "comment_id": 46454551, "body": "very clean, concise and accurate answer. nice job"}, {"owner": {"reputation": 705, "user_id": 1260715, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4c57872b82006176ffcaf211f19421b3?s=128&d=identicon&r=PG", "display_name": "Adam Keenan", "link": "https://stackoverflow.com/users/1260715/adam-keenan"}, "edited": false, "score": 1, "creation_date": 1426642980, "post_id": 29112741, "comment_id": 46454637, "body": "This syntax basically just creates string literals. Starting with a percent and then you wrap whatever you want in a string with matching non alpha-numeric characters."}, {"owner": {"reputation": 81552, "user_id": 562459, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V3UR9.png?s=128&g=1", "display_name": "Mike Sherrill &#39;Cat Recall&#39;", "link": "https://stackoverflow.com/users/562459/mike-sherrill-cat-recall"}, "edited": false, "score": 0, "creation_date": 1426686357, "post_id": 29112741, "comment_id": 46473712, "body": "&quot;Percent strings&quot; are also documented at <a href=\"http://ruby-doc.org/core-2.2.0/doc/syntax/literals_rdoc.html\" rel=\"nofollow noreferrer\">ruby-doc.org</a> in the very last paragraph. It almost looks like an afterthought. <i>&quot;If you are using \u201c(\u201d, \u201c[\u201d, \u201c{\u201d, \u201c&lt;\u201d you must close it with \u201c)\u201d, \u201c]\u201d, \u201c}\u201d, \u201c&gt;\u201d respectively. You may use most other non-alphanumeric characters for percent string delimiters such as \u201c%\u201d, \u201c|\u201d, \u201c^\u201d, etc.&quot;</i>"}, {"owner": {"reputation": 81552, "user_id": 562459, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V3UR9.png?s=128&g=1", "display_name": "Mike Sherrill &#39;Cat Recall&#39;", "link": "https://stackoverflow.com/users/562459/mike-sherrill-cat-recall"}, "reply_to_user": {"reputation": 4602, "user_id": 1141264, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4af75d466ec6c84e3a0a9f1de61233ae?s=128&d=identicon&r=PG", "display_name": "DickieBoy", "link": "https://stackoverflow.com/users/1141264/dickieboy"}, "edited": false, "score": 1, "creation_date": 1428005481, "post_id": 29112741, "comment_id": 47014876, "body": "@DickieBoy: My gut says &quot;No&quot;, but not for great reasons. If I were working on the Ruby language, and I&#39;d implemented a subset of percent strings as an alternative syntax for heredocs, I&#39;d have documented that. But the documentation for heredocs is quite different from the documentation for the similar subset of percent strings."}], "tags": [], "owner": {"reputation": 2886, "user_id": 2660531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75352c499497b518d2d5f67d6b6066c0?s=128&d=identicon&r=PG", "display_name": "rdubya", "link": "https://stackoverflow.com/users/2660531/rdubya"}, "is_accepted": true, "score": 5, "last_activity_date": 1426642423, "creation_date": 1426642423, "answer_id": 29112741, "question_id": 29112592, "link": "https://stackoverflow.com/questions/29112592/whats-meaning-of-in-ruby/29112741#29112741", "title": "what&#39;s meaning of %@ ... @ in ruby?", "body": "<p>That syntax will create a string using interpolation with all of the text between the two '@' characters. You can use any delimiter after the '%' that you would like, as long as it doesn't conflict with characters in your text. Here is a reference for it: <a href=\"http://www.zenspider.com/Languages/Ruby/QuickRef.html#strings\">http://www.zenspider.com/Languages/Ruby/QuickRef.html#strings</a></p>\n"}], "owner": {"reputation": 1622, "user_id": 1054800, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/881102db0abfb0d08ff131c472ce4991?s=128&d=identicon&r=PG", "display_name": "abelard2008", "link": "https://stackoverflow.com/users/1054800/abelard2008"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 29112741, "answer_count": 1, "score": 2, "last_activity_date": 1426642423, "creation_date": 1426641308, "question_id": 29112592, "link": "https://stackoverflow.com/questions/29112592/whats-meaning-of-in-ruby", "title": "what&#39;s meaning of %@ ... @ in ruby?", "body": "<p>In <a href=\"https://github.com/ricodigo/shapado/blob/master/lib/jobs/themes.rb#L52\" rel=\"nofollow\">themes.rb</a>, there is the following code included in the <code>%@ @</code>:</p>\n\n<pre><code> %@\n $has_bg_image: #{theme.has_bg_image?};\n $bg_color: ##{theme.bg_color};\n $fg_color: ##{theme.fg_color};\n $bg_image_url: '/_files/themes/bg_image/#{theme.group_id}/#     {theme.id}/#{theme.version}.png';\n $topbar_color: ##{theme.topbar_color};\n $logo_url: '/_files/groups/logo/#{theme.group_id}/#  {theme.version}.png';\n $view_bg_color: ##{theme.view_bg_color};\n $brand_color: ##{theme.brand_color};\n $fluid: #{theme.fluid};\n $bg_shadow:      #999;\n @\n</code></pre>\n\n<p>what reference about the syntax can I find? It is awkward that I don't know how to search the special characters like <code>%@</code> in <code>google</code> and <code>SO</code>!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "rake", "rails-migrations"], "answers": [{"comments": [{"owner": {"reputation": 5487, "user_id": 2909692, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05ad9fe4a2d294b296a7bc3eba97850a?s=128&d=identicon&r=PG&f=1", "display_name": "Sauron", "link": "https://stackoverflow.com/users/2909692/sauron"}, "edited": false, "score": 0, "creation_date": 1426716211, "post_id": 29114207, "comment_id": 46492797, "body": "This noted that it removed the migration, but then running rake db:migrate still migrated the, as it should be, removed file..."}], "tags": [], "owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "is_accepted": false, "score": 0, "last_activity_date": 1426653649, "last_edit_date": 1426653649, "creation_date": 1426653200, "answer_id": 29114207, "question_id": 29112588, "link": "https://stackoverflow.com/questions/29112588/how-to-erase-rails-migrations/29114207#29114207", "title": "How to erase rails migrations", "body": "<pre><code>rake db:migrate:down VERSION=20131211034603\nrake db:migrate:down VERSION=20131211034850\n\nrails destroy migration CreateActiveCampaignMetros\nrails destroy migration CreateActiveCampaignDows\n</code></pre>\n\n<p>or</p>\n\n<pre><code>rails destroy migration create_active_campaign_metros\nrails destroy migration create_active_campaign_dows\n</code></pre>\n"}], "owner": {"reputation": 5487, "user_id": 2909692, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05ad9fe4a2d294b296a7bc3eba97850a?s=128&d=identicon&r=PG&f=1", "display_name": "Sauron", "link": "https://stackoverflow.com/users/2909692/sauron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426653649, "creation_date": 1426641288, "question_id": 29112588, "link": "https://stackoverflow.com/questions/29112588/how-to-erase-rails-migrations", "title": "How to erase rails migrations", "body": "<p>I ran heroku run rake db:migrate and noticed several errors. One very obvious error is that there are migration entries that I never created, for instance:</p>\n\n<pre><code>Migrating to CreateActiveCampaignMetros (20131211034603)\n==  CreateActiveCampaignMetros: migrating =====================================\n-- create_table(:active_campaign_metros)\n   -&gt; 0.0019s\n==  CreateActiveCampaignMetros: migrated (0.0020s) ============================\n\nMigrating to CreateActiveCampaignDows (20131211034850)\n==  CreateActiveCampaignDows: migrating =======================================\n-- create_table(:active_campaign_dows)\n   -&gt; 0.0018s\n==  CreateActiveCampaignDows: migrated (0.0019s) ==============================\n</code></pre>\n\n<p>These are two migrations that appear in the command window that I never created as there are no migration files for them, and thusly are preventing my app from working in production. </p>\n\n<p>How can I remove these migrations entirely from my app? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "encoding", "character-encoding"], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 3188005, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/TxHxG.jpg?s=128&g=1", "display_name": "m52go", "link": "https://stackoverflow.com/users/3188005/m52go"}, "edited": false, "score": 0, "creation_date": 1426643407, "post_id": 29112791, "comment_id": 46454752, "body": "Thanks a lot. That must be it. I didn&#39;t know there was a difference in space types."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 193, "user_id": 3188005, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/TxHxG.jpg?s=128&g=1", "display_name": "m52go", "link": "https://stackoverflow.com/users/3188005/m52go"}, "edited": false, "score": 0, "creation_date": 1426644326, "post_id": 29112791, "comment_id": 46454956, "body": "Neither does Ruby half the time. Check the results of <code>&quot;\\xC2\\xA0&quot;.gsub(&#47;\\s&#47;, &#39;&#39;)</code>, <code>&quot;\\xC2\\xA0&quot;.gsub(&#47;\\p{Space}&#47;, &#39;&#39;)</code>, and <code>&quot;\\xC2\\xA0&quot;.strip</code> in <code>irb</code> for examples."}], "tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": true, "score": 1, "last_activity_date": 1426642843, "creation_date": 1426642843, "answer_id": 29112791, "question_id": 29112475, "link": "https://stackoverflow.com/questions/29112475/text-stored-in-rails-db-showing-funny-in-emails-both-text-and-html/29112791#29112791", "title": "Text stored in Rails DB showing funny in emails (both text and HTML)", "body": "<p>You have an unexpected <a href=\"http://www.fileformat.info/info/unicode/char/00a0/index.htm\" rel=\"nofollow\">Unicode non-breaking space</a> somewhere. A non-breaking space in UTF-8 consists of the bytes \\xC2 and \\xA0 in that order. That character (which is two bytes long) will appear as <code>=C2=A0</code> in the <a href=\"http://tools.ietf.org/html/rfc2045#section-6.7\" rel=\"nofollow\">MIME quoted-printable</a> representation.</p>\n\n<p>Fix up your spaces in the view (if that's where the stray space is) or properly strip your incoming properties (if that's where the stray space is coming from).</p>\n"}], "owner": {"reputation": 193, "user_id": 3188005, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/TxHxG.jpg?s=128&g=1", "display_name": "m52go", "link": "https://stackoverflow.com/users/3188005/m52go"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 29112791, "answer_count": 1, "score": 1, "last_activity_date": 1426642872, "creation_date": 1426640549, "last_edit_date": 1426642872, "question_id": 29112475, "link": "https://stackoverflow.com/questions/29112475/text-stored-in-rails-db-showing-funny-in-emails-both-text-and-html", "title": "Text stored in Rails DB showing funny in emails (both text and HTML)", "body": "<p>I'm stumped. Let's say the text stored in the database is this:</p>\n\n<blockquote>\n  <p>none of those had handles... @Bobby\u00a0isn't that wild...\u00a0</p>\n</blockquote>\n\n<p>That is exactly how it's displayed in the console when I run Model.first.property_name. And that is what I want to display in the email.</p>\n\n<p>Now, when I insert it into an email template by doing &lt;%= @instance.property_name %>, my HTML and TEXT emails display this:</p>\n\n<blockquote>\n  <p>none of those had handles... @Bobby=C2=A0isn&#39;t that wild...=\n  =C2=A0</p>\n</blockquote>\n\n<p>Any idea what's going on here, and what I can do to just display the text the way it should look?</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "debugging", "intellij-idea"], "owner": {"reputation": 167, "user_id": 4648421, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152577909756076/picture?type=large", "display_name": "Nick Hamilton", "link": "https://stackoverflow.com/users/4648421/nick-hamilton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 374, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1426788883, "creation_date": 1426640364, "question_id": 29112451, "link": "https://stackoverflow.com/questions/29112451/debugging-coffeescript-inside-a-ruby-on-rails-app-with-intellij-idea-14-not-rub", "title": "Debugging Coffeescript inside a Ruby on Rails app with Intellij IDEA 14 (not RubyMine)", "body": "<p>Could someone please point me in the right direction for working out how I could get debugging a RoR Coffescript with Intellij?</p>\n\n<p>I tried this guide:\n<a href=\"https://confluence.jetbrains.com/display/RUBYDEV/Debugging+CoffeeScript+Code\" rel=\"nofollow\">https://confluence.jetbrains.com/display/RUBYDEV/Debugging+CoffeeScript+Code</a>\n.. but when I run the server (debug mode) and the JavaScript debug configuration (also debug mode), no breakpoints are hit.</p>\n\n<p>As I am running IntelliJ and not RubyMine, do I need to set up a File Watcher to transpiling CoffeeScript to JavaScript? I setup the file mapper and that created some coffee.js and .map files, but then I received errors indicating that my .map.js file was not found.</p>\n\n<p>I'm a little confused.. :S .. any help would be much appreciated, as I'm a complete n00b to RoR/Coffeescript.</p>\n\n<p>Thanks a lot!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "gem"], "comments": [{"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1426640199, "post_id": 29112345, "comment_id": 46453824, "body": "You&#39;ll have to tell us what you tried in order for us not to suggest those same things back at you."}, {"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1426640238, "post_id": 29112345, "comment_id": 46453839, "body": "Also - what operating system are you on - given this is about installing software - that will change the advice we would give."}, {"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1426640289, "post_id": 29112345, "comment_id": 46453860, "body": "However - it all boils down to this message: &quot;You have to install development tools first.&quot; - figure out how to do that on your OS and you&#39;ll have solved your problem"}], "owner": {"reputation": 137, "user_id": 3477016, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d1dd3a3cec40783e0b81be97f463b6b7?s=128&d=identicon&r=PG&f=1", "display_name": "user3477016", "link": "https://stackoverflow.com/users/3477016/user3477016"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1426639766, "creation_date": 1426639766, "question_id": 29112345, "link": "https://stackoverflow.com/questions/29112345/failed-to-build-gem-native-extension-during-rails-installation", "title": "Failed to build gem native extension - During Rails Installation", "body": "<p>I'm trying to install Ruby on Rails, but I keep getting this error message:</p>\n\n<pre><code>ERROR:  Error installing rails:\n    ERROR: Failed to build gem native extension.\n</code></pre>\n\n<p>I don't know what to do, I've tried searching online for answers, such as installing command line tools, gcc, and others I can't remember, but to no effect. I often get errors doing things that others have said are suppose to resolve the problem too.</p>\n\n<p>Here is the entire error message:</p>\n\n<pre><code>ERROR:  Error installing rails:\n    ERROR: Failed to build gem native extension.\n\n    /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/bin/ruby extconf.rb\nchecking if the C compiler accepts ... *** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/bin/ruby\n    --help\n    --clean\n/System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/mkmf.rb:434:in `try_do': The compiler failed to generate an executable file. (RuntimeError)\nYou have to install development tools first.\n    from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/mkmf.rb:549:in `block in try_compile'\n    from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/mkmf.rb:500:in `with_werror'\n    from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/mkmf.rb:549:in `try_compile'\n    from extconf.rb:80:in `nokogiri_try_compile'\n    from extconf.rb:87:in `block in add_cflags'\n    from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/mkmf.rb:599:in `with_cflags'\n    from extconf.rb:86:in `add_cflags'\n    from extconf.rb:337:in `&lt;main&gt;'\n\n\nGem files will remain installed in /Library/Ruby/Gems/2.0.0/gems/nokogiri-1.6.6.2 for inspection.\nResults logged to /Library/Ruby/Gems/2.0.0/gems/nokogiri-1.6.6.2/ext/nokogiri/gem_make.out\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 481, "user_id": 1419464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FlZVa.jpg?s=128&g=1", "display_name": "LukeS", "link": "https://stackoverflow.com/users/1419464/lukes"}, "edited": false, "score": 0, "creation_date": 1426637601, "post_id": 29111792, "comment_id": 46453130, "body": "Well the controller&#39;s job is to handle the post and put requests not to generate them. You can easily try it out with views in your app. If you just try to make an API without any views, you can just curl the url."}, {"owner": {"reputation": 7898, "user_id": 3437900, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/blKgR.jpg?s=128&g=1", "display_name": "illusionist", "link": "https://stackoverflow.com/users/3437900/illusionist"}, "edited": false, "score": 0, "creation_date": 1426639580, "post_id": 29111792, "comment_id": 46453662, "body": "You can use postman or CURL to check/execute your put/post request in RESTFUL manner.. my friend :)"}, {"owner": {"reputation": 119, "user_id": 1117381, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cf108e29969d68824acf5883a28920f1?s=128&d=identicon&r=PG", "display_name": "Rimon", "link": "https://stackoverflow.com/users/1117381/rimon"}, "reply_to_user": {"reputation": 481, "user_id": 1419464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FlZVa.jpg?s=128&g=1", "display_name": "LukeS", "link": "https://stackoverflow.com/users/1419464/lukes"}, "edited": false, "score": 0, "creation_date": 1426644065, "post_id": 29111792, "comment_id": 46454903, "body": "@LukeS can you please give me the example code so that I can execute this request put and post. I used this line code for scaffold generated method #1 but it does not works why?  RestClient.post &#39;<a href=\"http://localhost:3000/high_scores\" rel=\"nofollow noreferrer\">localhost:3000/high_scores</a>&#39;,  { &#39;game&#39; =&gt; &#39;sss&#39;, &#39;score&#39;=&gt;100}.to_json, :content_type =&gt; :json, :accept =&gt; :json"}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 3754665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1653802345aae45ebd32c54f2de84ef?s=128&d=identicon&r=PG&f=1", "display_name": "matthewdu", "link": "https://stackoverflow.com/users/3754665/matthewdu"}, "is_accepted": false, "score": 2, "last_activity_date": 1426653394, "last_edit_date": 1426653394, "creation_date": 1426651634, "answer_id": 29113954, "question_id": 29111792, "link": "https://stackoverflow.com/questions/29111792/rails-applicatons-rest-client-post-and-put-method/29113954#29113954", "title": "Rails applicaton&#39;s rest client post and put method", "body": "<p>You need to change <code>application_controller.rb</code> to allow post and put request through an api call.</p>\n\n<p>Change:</p>\n\n<pre><code>protect_from_forgery with: :exception\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>protect_from_forgery with: :null_session\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 1117381, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cf108e29969d68824acf5883a28920f1?s=128&d=identicon&r=PG", "display_name": "Rimon", "link": "https://stackoverflow.com/users/1117381/rimon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 452, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1426666585, "creation_date": 1426636107, "last_edit_date": 1426666585, "question_id": 29111792, "link": "https://stackoverflow.com/questions/29111792/rails-applicatons-rest-client-post-and-put-method", "title": "Rails applicaton&#39;s rest client post and put method", "body": "<p>Using Ruby <a href=\"https://github.com/rest-client/rest-client\" rel=\"nofollow\">rest-client</a>, some example given for put and post request. But it's confusing to me for my rails application's client for sending put and post request. Let say, I have developed my Rail application by commands  : <code>rails generate scaffold HighScore game:string score:integer</code> , so here is HighScore controller 2 function</p>\n\n<pre><code>class HighScoresController &lt; ApplicationController\n  # 1\n  # POST /high_scores\n  # POST /high_scores.json\n  def create\n\n  # 2\n  # PATCH/PUT /high_scores/1\n  # PATCH/PUT /high_scores/1.json\n  def update\n\nend\n</code></pre>\n\n<p>How can I properly execute post and put request from my client side code, for these 2 scaffold related method #1 #2, if I follow this <a href=\"https://github.com/rest-client/rest-client\" rel=\"nofollow\">rest-client</a> example</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "edited": false, "score": 0, "creation_date": 1426668774, "post_id": 29111980, "comment_id": 46462701, "body": "@ChrisHeald: and proper formatting. I am always amazed how hard people make their lives, by just being too lazy to type Alt+Shift+F."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 4, "last_activity_date": 1426637309, "creation_date": 1426637309, "answer_id": 29111980, "question_id": 29111763, "link": "https://stackoverflow.com/questions/29111763/block-3-levels-in-top-required/29111980#29111980", "title": "block (3 levels) in &lt;top (required)&gt;", "body": "<p>It is hard to see, because that method is very long and the indentation is not clear, but you need to move the <code>total</code> that you want to return into the last line of the <code>total</code> method. Change </p>\n\n<pre><code>    end\n    total\n  end\n\n  end\nend\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>      end\n    end\n    total\n  end\n\nend\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 3385972, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/HS0su.jpg?s=128&g=1", "display_name": "DillonCarter", "link": "https://stackoverflow.com/users/3385972/dilloncarter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10216, "favorite_count": 0, "accepted_answer_id": 29111980, "answer_count": 1, "score": 1, "last_activity_date": 1536459845, "creation_date": 1426635955, "last_edit_date": 1536459845, "question_id": 29111763, "link": "https://stackoverflow.com/questions/29111763/block-3-levels-in-top-required", "title": "block (3 levels) in &lt;top (required)&gt;", "body": "<p>Running a few tests and getting the same error on each item:</p>\n\n<pre><code>Failures:\n\n  1) Register Frozen Pizza should be $5.00 each\n     Failure/Error: expect(subject.total).to eq 5.00\n\n       expected: 5.0\n            got: {\"Frozen Pizza\"=&gt;1}\n\n       (compared using ==)\n     # ./register_spec.rb:11:in `block (3 levels) in &lt;top (required)&gt;'\n\n  2) Register Corn should be $0.50 each\n     Failure/Error: expect(subject.total).to eq 0.50\n\n       expected: 0.5\n            got: {\"Corn\"=&gt;1}\n\n       (compared using ==)\n     # ./register_spec.rb:20:in `block (3 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>No clue what is causing these 16 errors.\nHere is part of the Spec file:</p>\n\n<pre><code>require 'register'\n\nrequire 'timecop'\n\ndescribe Register do\n  subject { described_class.new }\n\n  describe 'Frozen Pizza' do\n    it 'should be $5.00 each' do\n      subject.ring_up('Frozen Pizza', quantity: 1)\n      expect(subject.total).to eq 5.00\n      subject.ring_up('Frozen Pizza', quantity: 1)\n      expect(subject.total).to eq 10.00\n    end\n  end\n\n  describe 'Corn' do\n    it 'should be $0.50 each' do\n      subject.ring_up('Corn', quantity: 1)\n      expect(subject.total).to eq 0.50\n    end\n    it 'should be 5 for $2.00' do\n      subject.ring_up('Corn', quantity: 5)\n      expect(subject.total).to eq 2.00\n      subject.ring_up('Corn', quantity: 1)\n      expect(subject.total).to eq 2.50\n    end\n  end\n</code></pre>\n\n<p>I only included parts of the spec, but if I need to I will edit with the full code. </p>\n\n<p>Register.rb File:</p>\n\n<pre><code>class Register\n  attr :items\n\n  def initialize\n    @items = Hash.new(0)\n  end\n\n  def ring_up(item, args)\n    @items[item] += args[:quantity]\n  end\n\n  def total\n    total = 0\n    items.each do |item, quantity|\n      case item\n      when 'Frozen Pizza'\n        total += quantity * 5.00\n      when 'Corn'\n        if (quantity % 5 == 0) \n          total += quantity / 5 * 2.00\n        else\n          bundles = quantity / 5\n          singles = quantity % 5\n          total += bundles * 2.00 + singles * 0.50\n        end\n      when 'Ground Beef'\n        total += (quantity * 4.99).round(2)\n      when /Mayfield Ice Cream/\n        if (quantity % 2 == 0) \n          if item =~ /^Chocolate/\n            if Time.now.strftime(\"%A\") == 'Wednesday'\n              total += quantity / 2 * 5.99\n            else\n              total += quantity * 5.99\n            end\n          else\n            total += quantity * 5.99\n          end\n        else\n          if item =~ /^Chocolate/\n            if Time.now.strftime(\"%A\") == 'Wednesday'\n              total += (quantity / 2) * 5.99 + (quantity % 2) * 5.99\n            else\n              total += quantity * 5.99\n            end\n          else\n            total += quantity * 5.99\n          end\n        end\n      when 'Mango'\n        if Time.now.strftime(\"%A\") == 'Monday'\n          total += quantity * 0.50\n        else\n          total += quantity * 1.00\n        end\n\n\n#Additions\n\n      when 'Mahi Fillet'\n        total += quantity * 7.99\n      when 'Mac &amp; Cheese'\n        if (quantity % 10 == 0) \n          total += quantity / 10 * 1.00\n        else\n           total += quantity / 1 * 1.29\n        end\n\n\n\n    end\n    total\n  end\n\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"tags": [], "owner": {"reputation": 4544, "user_id": 699147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d8bef049b80123c91835b4fe4c7f9c9?s=128&d=identicon&r=PG", "display_name": "niiru", "link": "https://stackoverflow.com/users/699147/niiru"}, "is_accepted": true, "score": 1, "last_activity_date": 1426647967, "creation_date": 1426647967, "answer_id": 29113464, "question_id": 29111716, "link": "https://stackoverflow.com/questions/29111716/simple-form-button-collection-does-not-save-the-field-ruby-on-rails/29113464#29113464", "title": "Simple Form button collection does not save the field - Ruby on Rails", "body": "<p>I'm pretty sure that in the first example (radio buttons), you're submitting your parameters as:</p>\n\n<pre><code>params = {\n  post: {\n    category_id: 1\n  }\n}\n</code></pre>\n\n<p>Whereas in the second example (select), you're submitting your parameters as:</p>\n\n<pre><code>params = {\n  category_id: 1\n}\n</code></pre>\n\n<p>This is because your first example creates the radio tag off of the form object (i.e. <code>form.collection_radio_buttons</code>) and the second example creates the select tag on its own ( i.e. <code>select_tag</code> as opposed to <code>form.select_tag</code> )</p>\n\n<p>I would recommend updating your create action as follows and leaving your form.collection_radio_buttons as is:</p>\n\n<pre><code>def create\n  @post = Post.new(params.require(:post).permit(:title, :description, :category_id))\n  # @post.category_id = params[:category_id] # remove this line\n  ...\nend\n</code></pre>\n\n<p>This basically results in a simpler, more conventional form / controller setup that you'll see in examples all over the internet.</p>\n"}], "owner": {"reputation": 173, "user_id": 4582739, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/4ec8a2d3a161a7fa5c3f229e27cc59e4?s=128&d=identicon&r=PG&f=1", "display_name": "Javel LP", "link": "https://stackoverflow.com/users/4582739/javel-lp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 29113464, "answer_count": 1, "score": 0, "last_activity_date": 1426647967, "creation_date": 1426635675, "question_id": 29111716, "link": "https://stackoverflow.com/questions/29111716/simple-form-button-collection-does-not-save-the-field-ruby-on-rails", "title": "Simple Form button collection does not save the field - Ruby on Rails", "body": "<p>I have an input form in a RoR app built with simple_form.</p>\n\n<p>One of the input fields is the category of the post, implemented as a collection of radio buttons. When saving the input, this field is empty and not saved. I cannot find why.</p>\n\n<p>My form:</p>\n\n<pre><code>&lt;%= simple_form_for @post do |form| %&gt;\n&lt;%= form.collection_radio_buttons(:category_id, Category.all, :id, :name %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>My model:</p>\n\n<pre><code> def new\n    @post= Post.new\n    @categories = Category.all.map{|c| [ c.name, c.id ] }\n  end\n\ndef create\n    @post = Post.new(params.require(:post).permit(:title, :description))\n    @post.category_id = params[:category_id]\n    @categories = Category.all.map{|c| [ c.name, c.id ] }\n...\n...\nend\n</code></pre>\n\n<p>It is strange that everything works OK if I do it with a selectable drop-list instead:</p>\n\n<pre><code>&lt;%= simple_form_for @post do |form| %&gt;\n&lt;%= select_tag(:category_id, options_for_select(@categories, selected: @post.category_id)) %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1426643015, "post_id": 29111573, "comment_id": 46454646, "body": "Can you think about a better name for <code>query</code>, perhaps <code>user_count</code> or something like that. Would be much easier to test if <code>@query</code> and the <code>query</code> method had different names and clear resposibilities."}, {"owner": {"reputation": 8871, "user_id": 4381282, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-rIutmC2tG4M/AAAAAAAAAAI/AAAAAAAAAE4/wicIrC8KhUs/photo.jpg?sz=128", "display_name": "Pawe\u0142 Dawczak", "link": "https://stackoverflow.com/users/4381282/pawe%c5%82-dawczak"}, "edited": false, "score": 0, "creation_date": 1426664729, "post_id": 29111573, "comment_id": 46460946, "body": "Could you provide an excerpt from your <code>DBQuery::Query</code>? Just to be sure with what we&#39;re working here!"}, {"owner": {"reputation": 6264, "user_id": 177665, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bbfd14c7c9b256708ba495e37f8fa3c8?s=128&d=identicon&r=PG", "display_name": "cbliard", "link": "https://stackoverflow.com/users/177665/cbliard"}, "edited": false, "score": 0, "creation_date": 1426665645, "post_id": 29111573, "comment_id": 46461314, "body": "Your code does not work. <code>query</code> in <code>allow(query)</code> is not defined, in the <code>#query</code> method you are adding an array to an integer (you intended to get size?), and you <code>allow(query).to receive(:new)</code> but it should be <code>allow(DBQuery::Query).to receive(:new)</code>."}, {"owner": {"reputation": 5151, "user_id": 2535242, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/a10b5101fc63f6d6d62de5784b75142e?s=128&d=identicon&r=PG", "display_name": "La-comadreja", "link": "https://stackoverflow.com/users/2535242/la-comadreja"}, "reply_to_user": {"reputation": 6264, "user_id": 177665, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bbfd14c7c9b256708ba495e37f8fa3c8?s=128&d=identicon&r=PG", "display_name": "cbliard", "link": "https://stackoverflow.com/users/177665/cbliard"}, "edited": false, "score": 0, "creation_date": 1426696464, "post_id": 29111573, "comment_id": 46481165, "body": "@cbliard this is not the actual code, but it&#39;s based on what I&#39;m doing (the actual code is a bit long).  I meant db_query for query"}], "answers": [{"comments": [{"owner": {"reputation": 5151, "user_id": 2535242, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/a10b5101fc63f6d6d62de5784b75142e?s=128&d=identicon&r=PG", "display_name": "La-comadreja", "link": "https://stackoverflow.com/users/2535242/la-comadreja"}, "edited": false, "score": 0, "creation_date": 1426697685, "post_id": 29117703, "comment_id": 46482000, "body": "Thanks. I figured there would be a simple Ruby solution hiding in there."}], "tags": [], "owner": {"reputation": 6264, "user_id": 177665, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bbfd14c7c9b256708ba495e37f8fa3c8?s=128&d=identicon&r=PG", "display_name": "cbliard", "link": "https://stackoverflow.com/users/177665/cbliard"}, "is_accepted": true, "score": 10, "last_activity_date": 1426669173, "creation_date": 1426669173, "answer_id": 29117703, "question_id": 29111573, "link": "https://stackoverflow.com/questions/29111573/rspec-3-how-to-stub-methods-and-constants-from-code-we-have-yet-to-build-add/29117703#29117703", "title": "RSpec 3: How to stub methods and constants from code we have yet to build/add?", "body": "<p>As I understand, you want to make expectations on <code>DBQuery::Query</code> without defining it in your code. rspec-mocks can <a href=\"https://relishapp.com/rspec/rspec-mocks/v/3-2/docs/mutating-constants/stub-undefined-constant\" rel=\"noreferrer\">stub an undefined constant</a>, like you did for <code>DBQuery::Query::MAX</code>. To stub <code>DBQuery::Query</code> completely, create a <a href=\"https://relishapp.com/rspec/rspec-mocks/v/3-2/docs/verifying-doubles/using-a-class-double\" rel=\"noreferrer\">class double</a> first and stub a const for it in your test:</p>\n\n<pre><code>db_query__query_class = class_double('DBQuery::Query')\nstub_const('DBQuery::Query', db_query__query_class)\n</code></pre>\n\n<p>This way, <code>DBQuery::Query</code> in your code will return the <code>query_class</code> double. Then you can define some behavior with it:</p>\n\n<pre><code>query_instance = instance_double('DBQuery::Query')\nallow(db_query__query_class).to receive(:new).and_return(query_instance)\nallow(db_query).to receive(:retrieve_users).and_return([1000, 1001, 1002])\n</code></pre>\n\n<p>You still have to stub nested constants like <code>DBQuery::Query::MAX</code></p>\n\n<pre><code>stub_const('DBQuery::Query::MAX', 1000)\n</code></pre>\n\n<p>About style, I prefer putting stubs and allows in <code>let</code>/<code>let!</code> statements like this:</p>\n\n<pre><code>describe Integration::StackOverflowIntegration do\n  let!(:db_query__query_class) do\n    class_double('DBQuery::Query').tap do |double|\n      stub_const('DBQuery::Query', double)\n      stub_const('DBQuery::Query::MAX', 1000)\n      allow(double).to receive(:new).and_return(query_instance)\n    end\n  end\n  let(:query_instance) do\n    instance_double('DBQuery::Query').tap do |double|\n      allow(double).to receive(:retrieve_users).and_return([1000, 10001, 1002])\n    end\n  end\nend\n</code></pre>\n\n<p>Also I like to put returned values in their own <code>let</code> so I can change them easily. Here is a full working (and dummy) example:</p>\n\n<pre><code>RSpec.configure do |c|\n  c.around(:context, :protect_with_timeout) do |example|\n    Timeout::timeout(2) {\n      example.run\n    }\n  end\nend\n\ndescribe Integration::StackOverflowIntegration do\n  let!(:db_query__query_class) do\n    class_double('DBQuery::Query').tap do |double|\n      stub_const('DBQuery::Query', double)\n      stub_const('DBQuery::Query::MAX', max_queries)\n      allow(double).to receive(:new).and_return(query_instance)\n    end\n  end\n  let(:query_instance) do\n    instance_double('DBQuery::Query').tap do |double|\n      allow(double).to receive(:retrieve_users).and_return(retrieved_users)\n    end\n  end\n  let(:max_queries) { 1000 }\n  let(:retrieved_users) { [1000, 1001, 1002] }\n\n  describe '#query' do\n    subject(:stack_overflow_query) { Integration::StackOverflowIntegration.new.query }\n\n    it 'queries without error in nominal case' do\n      expect { stack_overflow_query }.to_not raise_error\n    end\n\n    context 'with 0 users returned' do\n      let(:retrieved_users) { [] }\n\n      it 'does not loop forever', :protect_with_timeout do\n        pending('not implemented yet...')\n        stack_overflow_query # will timeout\n      end\n    end\n\n    context 'with 10 users returned' do\n      let(:retrieved_users) { [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] }\n\n      it 'calls #retrieve_users 100 times' do\n        stack_overflow_query\n        expect(query_instance).to have_received(:retrieve_users).exactly(100).times\n      end\n    end\n\n    context 'with DBQuery::Query::MAX set to 0' do\n      let(:max_queries) { 0 }\n\n      it 'does not call #retrieve_users at all' do\n        stack_overflow_query\n        expect(query_instance).not_to have_received(:retrieve_users)\n      end\n    end\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5151, "user_id": 2535242, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/a10b5101fc63f6d6d62de5784b75142e?s=128&d=identicon&r=PG", "display_name": "La-comadreja", "link": "https://stackoverflow.com/users/2535242/la-comadreja"}, "is_accepted": false, "score": 0, "last_activity_date": 1426700269, "creation_date": 1426700269, "answer_id": 29128974, "question_id": 29111573, "link": "https://stackoverflow.com/questions/29111573/rspec-3-how-to-stub-methods-and-constants-from-code-we-have-yet-to-build-add/29128974#29128974", "title": "RSpec 3: How to stub methods and constants from code we have yet to build/add?", "body": "<p>The short answer was, at the beginning of the RSpec:</p>\n\n<pre><code>let(:db_query_class) { class_double('DBQuery::Query') }\nlet(:db_query) { instance_double('DBQuery::Query') }\n\nbefore do\n  stub_const('DBQuery::Query', db_query_class)\n  allow(db_query_class).to receive(:new).and_return(db_query)\n  allow(db_query).to receive(:retrieve_users).and_return([1000, 1001, 1002])\n  stub_const('DBQuery::Query::MAX', 1000)\nend\n</code></pre>\n"}], "owner": {"reputation": 5151, "user_id": 2535242, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/a10b5101fc63f6d6d62de5784b75142e?s=128&d=identicon&r=PG", "display_name": "La-comadreja", "link": "https://stackoverflow.com/users/2535242/la-comadreja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7474, "favorite_count": 1, "accepted_answer_id": 29117703, "answer_count": 2, "score": 7, "last_activity_date": 1426700269, "creation_date": 1426634805, "last_edit_date": 1426696407, "question_id": 29111573, "link": "https://stackoverflow.com/questions/29111573/rspec-3-how-to-stub-methods-and-constants-from-code-we-have-yet-to-build-add", "title": "RSpec 3: How to stub methods and constants from code we have yet to build/add?", "body": "<p>We are refactoring a Ruby application called DataSourceIntegrations from a gem we've built called DBQuery.  I am migrating some of the DBQuery code into DataSourceIntegrations.  The section I'm building depends on DBQuery, which will be added in a separate step.</p>\n\n<p>Meanwhile, I need to write RSpec tests to verify that the DBQuery code is being called correctly, all without DBQuery.</p>\n\n<p>What I have is:</p>\n\n<p>Code&mdash;</p>\n\n<p>Gem code&mdash;</p>\n\n<pre><code>module DBQuery\n  class Query\n    MAX = 1000\n\n    def retrieve_users\n      # Returns an array of user IDs\n    end\n  end\nend\n</code></pre>\n\n<p>Application code&mdash;</p>\n\n<pre><code>  module Integration\n    def initialize\n      @query = DBQuery::Query.new\n    end   \n  end\n\n  module Integration\n    class StackOverflowIntegration\n      include Integration\n\n      def query\n        users = []\n        while (users &lt; DBQuery::Query::MAX) do\n          # Creates a users buffer\n          users.push @query.retrieve_users(users_buffer)\n        end\n      end\n    end   \n  end\n</code></pre>\n\n<p>Tests&mdash;</p>\n\n<pre><code>describe Integration::StackOverflowIntegration do\n  let(:db_query) { double('DBQuery::Query') }\n\n  before do\n    stub_const('DBQuery::Query::MAX', 1000)\n    allow(db_query).to receive(:new).and_return(db_query)\n    allow(db_query).to receive(:retrieve_users).and_return([1000, 1001, 1002])\n  end\n\n  it 'queries without error' do\n    expect { StackOverflowIntegration.new.query }.to_not raise_error\n  end\nend\n</code></pre>\n\n<p>I can't figure out how to stub in a way that doesn't require DBQuery.  My error is:</p>\n\n<pre><code>NoMethodError:\n       undefined method `new' for #&lt;Module:0x007fa7ce561968&gt;\n</code></pre>\n\n<p>I don't know why DBQuery::Query is being represented as a module, or how to get it to recognize \"new.\"</p>\n"}, {"tags": ["ruby", "json", "gem", "bundler"], "comments": [{"owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "edited": false, "score": 0, "creation_date": 1426641024, "post_id": 29111570, "comment_id": 46454063, "body": "Is <code>json</code> anywhere in your Gemfile.lock?"}], "answers": [{"comments": [{"owner": {"reputation": 3173, "user_id": 116751, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c6f153da0c942369289863942e65433b?s=128&d=identicon&r=PG", "display_name": "Chris McKenzie", "link": "https://stackoverflow.com/users/116751/chris-mckenzie"}, "edited": false, "score": 0, "creation_date": 1426697701, "post_id": 29111976, "comment_id": 46482011, "body": "With ruby 2.1.0 I was able to do all of those things successfully. I switched over to ruby 2.2.0 and bundle install worked. However, I&#39;m sure I tried 2.2.0 before and it did not work. I suspect that my trial and error attempts have distorted my environment and I won&#39;t know what I did to fix the problem. I&#39;ll try this on another machine soon and see if I can recreate the problem or if the answer is just migrate to 2.2.0. FWIW, it&#39;s still baffling that this is a problem in 2.1.0."}, {"owner": {"reputation": 32543, "user_id": 528726, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6307569a99dd77fff0463032051d7e39?s=128&d=identicon&r=PG", "display_name": "joelparkerhenderson", "link": "https://stackoverflow.com/users/528726/joelparkerhenderson"}, "reply_to_user": {"reputation": 3173, "user_id": 116751, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c6f153da0c942369289863942e65433b?s=128&d=identicon&r=PG", "display_name": "Chris McKenzie", "link": "https://stackoverflow.com/users/116751/chris-mckenzie"}, "edited": false, "score": 0, "creation_date": 1426702683, "post_id": 29111976, "comment_id": 46485181, "body": "Yes, I agree that your environment seems to be distored. Although it may be due to something beyond what you&#39;ve done. For example, other system software may have upgraded, such as the compiler, or OSX, or brew, etc. The <code>gem_make.out</code> file may illuminate this."}, {"owner": {"reputation": 3173, "user_id": 116751, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c6f153da0c942369289863942e65433b?s=128&d=identicon&r=PG", "display_name": "Chris McKenzie", "link": "https://stackoverflow.com/users/116751/chris-mckenzie"}, "edited": false, "score": 0, "creation_date": 1426705034, "post_id": 29111976, "comment_id": 46486624, "body": "I removed Gemfile.lock and re-executed bundle install and it&#39;s now failing on ruby 2.2.0.  I don&#39;t seem to be able to format comments as well, so I&#39;ll respond to your questions in separate comments so that it shows up well."}, {"owner": {"reputation": 3173, "user_id": 116751, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c6f153da0c942369289863942e65433b?s=128&d=identicon&r=PG", "display_name": "Chris McKenzie", "link": "https://stackoverflow.com/users/116751/chris-mckenzie"}, "edited": false, "score": 0, "creation_date": 1426705171, "post_id": 29111976, "comment_id": 46486715, "body": "I installed the latest ruby successfully using rvm. Ruby version is listed as ruby 2.2.0p0 (2014-12-25 revision 49005) [x86_64-darwin14]"}, {"owner": {"reputation": 3173, "user_id": 116751, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c6f153da0c942369289863942e65433b?s=128&d=identicon&r=PG", "display_name": "Chris McKenzie", "link": "https://stackoverflow.com/users/116751/chris-mckenzie"}, "edited": false, "score": 0, "creation_date": 1426705193, "post_id": 29111976, "comment_id": 46486725, "body": "gcc is located in /usr/bin/gcc"}, {"owner": {"reputation": 3173, "user_id": 116751, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c6f153da0c942369289863942e65433b?s=128&d=identicon&r=PG", "display_name": "Chris McKenzie", "link": "https://stackoverflow.com/users/116751/chris-mckenzie"}, "edited": false, "score": 0, "creation_date": 1426705213, "post_id": 29111976, "comment_id": 46486736, "body": "Configured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/usr/include/c++/4.2.1 Apple LLVM version 6.0 (clang-600.0.57) (based on LLVM 3.5svn) Target: x86_64-apple-darwin14.1.0 Thread model: posix"}, {"owner": {"reputation": 3173, "user_id": 116751, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c6f153da0c942369289863942e65433b?s=128&d=identicon&r=PG", "display_name": "Chris McKenzie", "link": "https://stackoverflow.com/users/116751/chris-mckenzie"}, "edited": false, "score": 0, "creation_date": 1426705265, "post_id": 29111976, "comment_id": 46486775, "body": "For ruby 2.2.0p0 the error building json-1.4.6 is different:"}, {"owner": {"reputation": 3173, "user_id": 116751, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c6f153da0c942369289863942e65433b?s=128&d=identicon&r=PG", "display_name": "Chris McKenzie", "link": "https://stackoverflow.com/users/116751/chris-mckenzie"}, "edited": false, "score": 0, "creation_date": 1426705269, "post_id": 29111976, "comment_id": 46486777, "body": "Errno::EPERM: Operation not permitted @ chmod_internal - /Users/chrismc/.rvm/gems/ruby-2.2.0/gems/json-1.4.6/CHANGES An error occurred while installing json (1.4.6), and Bundler cannot continue. Make sure that <code>gem install json -v &#39;1.4.6&#39;</code> succeeds before bundling."}, {"owner": {"reputation": 3173, "user_id": 116751, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c6f153da0c942369289863942e65433b?s=128&d=identicon&r=PG", "display_name": "Chris McKenzie", "link": "https://stackoverflow.com/users/116751/chris-mckenzie"}, "edited": false, "score": 0, "creation_date": 1426705483, "post_id": 29111976, "comment_id": 46486909, "body": "okay no--now I get compilation failures. I&#39;ll send you the files."}, {"owner": {"reputation": 3173, "user_id": 116751, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c6f153da0c942369289863942e65433b?s=128&d=identicon&r=PG", "display_name": "Chris McKenzie", "link": "https://stackoverflow.com/users/116751/chris-mckenzie"}, "edited": false, "score": 0, "creation_date": 1426707570, "post_id": 29111976, "comment_id": 46488083, "body": "I went with the nuclear option: I commented out everything in the Gemfile and started adding gems one-by-one, running bundle install between them.  I didn&#39;t write the original code and I&#39;ve come to believe that the gem dependencies were copy-pasted from elsewhere. Anyway, I&#39;ve discovered that the culprit is the &quot;chefspec&quot; gem. To make things a little more interesting, bundle install does not fail if there&#39;s already a Gemfile.lock."}, {"owner": {"reputation": 32543, "user_id": 528726, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6307569a99dd77fff0463032051d7e39?s=128&d=identicon&r=PG", "display_name": "joelparkerhenderson", "link": "https://stackoverflow.com/users/528726/joelparkerhenderson"}, "reply_to_user": {"reputation": 3173, "user_id": 116751, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c6f153da0c942369289863942e65433b?s=128&d=identicon&r=PG", "display_name": "Chris McKenzie", "link": "https://stackoverflow.com/users/116751/chris-mckenzie"}, "edited": false, "score": 0, "creation_date": 1426708465, "post_id": 29111976, "comment_id": 46488604, "body": "Interesting, good discovery. In my personal experience, Chef has been a mess due to regressive code and outdated version dependencies. I changed from Chef to Ansible."}], "tags": [], "owner": {"reputation": 32543, "user_id": 528726, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6307569a99dd77fff0463032051d7e39?s=128&d=identicon&r=PG", "display_name": "joelparkerhenderson", "link": "https://stackoverflow.com/users/528726/joelparkerhenderson"}, "is_accepted": false, "score": 1, "last_activity_date": 1426708306, "last_edit_date": 1426708306, "creation_date": 1426637295, "answer_id": 29111976, "question_id": 29111570, "link": "https://stackoverflow.com/questions/29111570/bundle-install-fails-trying-to-build-json-1-4-6-which-im-not-referencing/29111976#29111976", "title": "bundle install fails trying to build json 1.4.6 - which I&#39;m not referencing", "body": "<p>Something looks wrong with your compiler setup, and also you're using an outdated Ruby version.</p>\n\n<p>The parser file should not have that error, and it is unlikely (IMHO) to be specifically because of your Ruby version, or to JSON. It is more likely you're trying to compile with incorrect compiler.</p>\n\n<p>Are you able to install the pure JSON gem?</p>\n\n<pre><code>gem install json-pure\n</code></pre>\n\n<p>Are you able to install the current JSON native gem?</p>\n\n<pre><code>gem install json -v \"1.8.2\"\n</code></pre>\n\n<p>If you are able to install both:</p>\n\n<ul>\n<li><p>Then the next place to look is what's forcing the older json gem. </p></li>\n<li><p>Read your Gemfile.lock, and look for the older json gem.</p></li>\n<li><p>Also, ideally update everything in your Gemfile to be current e.g. change anything that is pinned to a version such as <code>gem 'foo', '~&gt;x.y.z'</code> to <code>gem 'foo', '&gt;= x.y.z'</code> then run <code>bundle update</code> to discover what happens. You may need to revert the Gemfile later on, if gem versions are incompatible with your own codebase.</p></li>\n</ul>\n\n<p>If you are able to install the pure gem, but not the current native gem:</p>\n\n<ul>\n<li>Then the next place to check is your compiler.</li>\n</ul>\n\n<p>Are you able to install current Ruby?</p>\n\n<pre><code>rvm install ruby --latest\n</code></pre>\n\n<p>If so, does that solve the JSON issue?</p>\n\n<p>Where is your GCC?</p>\n\n<pre><code>command -v gcc\n</code></pre>\n\n<p>What version is it?</p>\n\n<pre><code>gcc --version\nConfigured with:\n--prefix=/Applications/Xcode.app/Contents/Developer/usr\n--with-gxx-include-dir=/usr/include/c++/4.2.1\nApple LLVM version 6.0 (clang-600.0.57) (based on LLVM 3.5svn)\nTarget: x86_64-apple-darwin14.1.0\nThread model: posix\n</code></pre>\n\n<p>Your error message says that results are logged to this file:</p>\n\n<pre><code>/Users/chrismc/.rvm/gems/ruby-2.1.0/extensions/x86_64-darwin-14/2.1.0/json-1.4.6/gem_make.out` \n</code></pre>\n\n<p>Can you post that entire file? </p>\n\n<p>(If you're concerned about the file having semi-private info, feel free to post it somewhere private or email it; I am \"joelparkerhenderson\" on GitHub, Google, etc.)</p>\n"}, {"tags": [], "owner": {"reputation": 3173, "user_id": 116751, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c6f153da0c942369289863942e65433b?s=128&d=identicon&r=PG", "display_name": "Chris McKenzie", "link": "https://stackoverflow.com/users/116751/chris-mckenzie"}, "is_accepted": true, "score": 0, "last_activity_date": 1426884358, "creation_date": 1426884358, "answer_id": 29175523, "question_id": 29111570, "link": "https://stackoverflow.com/questions/29111570/bundle-install-fails-trying-to-build-json-1-4-6-which-im-not-referencing/29175523#29175523", "title": "bundle install fails trying to build json 1.4.6 - which I&#39;m not referencing", "body": "<p>The answer to this question, such as it is, is that the chefspec gem is indirectly requiring json 1.4.6. It happens that I don't need chefspec in this code so I was simply able to remove the reference and go on about my business.</p>\n\n<p>I do not have an answer for how to actually use chefspec if I needed to.</p>\n"}], "owner": {"reputation": 3173, "user_id": 116751, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c6f153da0c942369289863942e65433b?s=128&d=identicon&r=PG", "display_name": "Chris McKenzie", "link": "https://stackoverflow.com/users/116751/chris-mckenzie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 637, "favorite_count": 0, "accepted_answer_id": 29175523, "answer_count": 2, "score": 1, "last_activity_date": 1426884358, "creation_date": 1426634789, "question_id": 29111570, "link": "https://stackoverflow.com/questions/29111570/bundle-install-fails-trying-to-build-json-1-4-6-which-im-not-referencing", "title": "bundle install fails trying to build json 1.4.6 - which I&#39;m not referencing", "body": "<p>I'm trying to run bundle install on a ruby project and it fails with the following error:</p>\n\n<pre><code>Gem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\n    /Users/chrismc/.rvm/rubies/ruby-2.1.0/bin/ruby -r ./siteconf20150317-85350-hx8dcj.rb extconf.rb\nchecking for re.h... no\ncreating Makefile\n\nmake \"DESTDIR=\" clean\n\nmake \"DESTDIR=\"\ncompiling parser.c\nparser.rl:165:20: error: expected '(' after 'if'\n                if RTEST(rb_funcall(klass, i_json_creatable_p, 0)) {\n                   ^\n/Users/chrismc/.rvm/rubies/ruby-2.1.0/include/ruby-2.1.0/ruby/ruby.h:437:18: note: expanded from macro 'RTEST'\n#define RTEST(v) !(((VALUE)(v) &amp; ~Qnil) == 0)\n                 ^\n1 error generated.\nmake: *** [parser.o] Error 1\n\nmake failed, exit code 2\n\nGem files will remain installed in /Users/chrismc/.rvm/gems/ruby-2.1.0/gems/json-1.4.6 for inspection.\nResults logged to /Users/chrismc/.rvm/gems/ruby-2.1.0/extensions/x86_64-darwin-14/2.1.0/json-1.4.6/gem_make.out\nAn error occurred while installing json (1.4.6), and Bundler cannot continue.\nMake sure that `gem install json -v '1.4.6'` succeeds before bundling.\n</code></pre>\n\n<p>I'm using rvm and I've tried this on several different versions of Ruby with similar results.</p>\n\n<p><strong>I am not referencing json 1.4.6 anywhere in my project.</strong></p>\n\n<p>It is unclear to me why bundler is even trying to install this gem, much less how to resolve the issue. I am likewise unable to install the gem using \"gem install.\"</p>\n\n<p>My OS is Mac OSX.</p>\n\n<p>The output of gem env is as follows:</p>\n\n<pre><code>RubyGems Environment:\n  - RUBYGEMS VERSION: 2.4.6\n  - RUBY VERSION: 2.1.0 (2013-12-25 patchlevel 0) [x86_64-darwin14.0]\n  - INSTALLATION DIRECTORY: /Users/chrismc/.rvm/gems/ruby-2.1.0\n  - RUBY EXECUTABLE: /Users/chrismc/.rvm/rubies/ruby-2.1.0/bin/ruby\n  - EXECUTABLE DIRECTORY: /Users/chrismc/.rvm/gems/ruby-2.1.0/bin\n  - SPEC CACHE DIRECTORY: /Users/chrismc/.gem/specs\n  - SYSTEM CONFIGURATION DIRECTORY: /Users/chrismc/.rvm/rubies/ruby-2.1.0/etc\n  - RUBYGEMS PLATFORMS:\n    - ruby\n    - x86_64-darwin-14\n  - GEM PATHS:\n     - /Users/chrismc/.rvm/gems/ruby-2.1.0\n     - /Users/chrismc/.rvm/gems/ruby-2.1.0@global\n  - GEM CONFIGURATION:\n     - :update_sources =&gt; true\n     - :verbose =&gt; true\n     - :backtrace =&gt; false\n     - :bulk_threshold =&gt; 1000\n  - REMOTE SOURCES:\n     - https://rubygems.org/\n  - SHELL PATH:\n     - /Users/chrismc/.rvm/gems/ruby-2.1.0/bin\n     - /Users/chrismc/.rvm/gems/ruby-2.1.0@global/bin\n     - /Users/chrismc/.rvm/rubies/ruby-2.1.0/bin\n     - /Users/chrismc/.rvm/bin\n     - /usr/local/bin\n     - /usr/local/bin\n     - /usr/bin\n     - /bin\n     - /usr/sbin\n     - /sbin\n</code></pre>\n\n<p>I'm at a loss for how to proceed.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 6836, "user_id": 458044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c8c35f1a799c3905fc0cab4e030803d?s=128&d=identicon&r=PG", "display_name": "Naren Sisodiya", "link": "https://stackoverflow.com/users/458044/naren-sisodiya"}, "edited": false, "score": 1, "creation_date": 1426632772, "post_id": 29111129, "comment_id": 46451630, "body": "try reversing your associations i.e User should belongs_to role and Role has_many users. Also remove the accepts_nested_attributes_for roles and make sure the roles are created before hand"}, {"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1426632919, "post_id": 29111129, "comment_id": 46451684, "body": "You&#39;ve created a form that allows a user to have only one role (which you are selecting via a dropdown). If you really want a user to have many roles, then you are looking for a very different solution that this one. I&#39;d google &quot;had_many associations in forms&quot; or similar..."}, {"owner": {"reputation": 1521, "user_id": 1274846, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/048371ccb94bbd3aae9ac0ca20c0a31c?s=128&d=identicon&r=PG", "display_name": "Trinculo", "link": "https://stackoverflow.com/users/1274846/trinculo"}, "edited": false, "score": 0, "creation_date": 1426633175, "post_id": 29111129, "comment_id": 46451766, "body": "After reversing the roles and removing the accepts_nested_attributes_for, I still get a form validation error."}, {"owner": {"reputation": 1521, "user_id": 1274846, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/048371ccb94bbd3aae9ac0ca20c0a31c?s=128&d=identicon&r=PG", "display_name": "Trinculo", "link": "https://stackoverflow.com/users/1274846/trinculo"}, "edited": false, "score": 0, "creation_date": 1426633222, "post_id": 29111129, "comment_id": 46451783, "body": "I really want to do multiple rows and I initially set up a has_many through relationship, but I thought it might be easier to wrap my brain around a more simple case first."}, {"owner": {"reputation": 6404, "user_id": 3363019, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/129352fb15374b8febd37cc99150c7c5?s=128&d=identicon&r=PG", "display_name": "patrick", "link": "https://stackoverflow.com/users/3363019/patrick"}, "edited": false, "score": 0, "creation_date": 1426636115, "post_id": 29111129, "comment_id": 46452645, "body": "Would you be open to using a gem? Something like <a href=\"https://github.com/platform45/easy_roles\" rel=\"nofollow noreferrer\">easy_roles</a> might do the trick."}], "answers": [{"tags": [], "owner": {"reputation": 4999, "user_id": 4151953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d405a824f3f34d13b9e57532532f99?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Babio", "link": "https://stackoverflow.com/users/4151953/alejandro-babio"}, "is_accepted": true, "score": 1, "last_activity_date": 1426778649, "last_edit_date": 1426778649, "creation_date": 1426639330, "answer_id": 29112255, "question_id": 29111129, "link": "https://stackoverflow.com/questions/29111129/rails-4-drop-down-select-list-different-model/29112255#29112255", "title": "Rails 4 drop down select list different model", "body": "<p>If User has many roles, your User model must not have a field: <code>user_id</code>, I think, and I hope, that Users Have and Belongs to many Roles. Then you need a third model:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_many :user_roles\n  has_many :roles, through: :user_roles\nend\n\nclass Role &lt; ActiveRecord::Base\n  has_many :user_roles\n  has_many :users, through: :user_roles\nend\n\nclass UserRole &lt; ActiveRecord::Base\n  belongs_to :user\n  belongs_to :role\n  validates_presence_of :role_id, :user_id\nend\n</code></pre>\n\n<p>In your User form you can use this to update relations (look: <code>:role_ids</code> in plural)</p>\n\n<pre><code>&lt;%= f.collection_select :role_ids, Role.all, :id, :name, {}, {multiple: true} %&gt;\n</code></pre>\n\n<p>And the validation is now in UserRole model.</p>\n\n<p><strong>Edit</strong>: If you are using Rails 4.x you need to permit params for a collection of role_ids.</p>\n\n<pre><code>params.require(:user).permit(:user_field1, :user_field2, ... , role_ids: []) \n</code></pre>\n"}], "owner": {"reputation": 1521, "user_id": 1274846, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/048371ccb94bbd3aae9ac0ca20c0a31c?s=128&d=identicon&r=PG", "display_name": "Trinculo", "link": "https://stackoverflow.com/users/1274846/trinculo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 830, "favorite_count": 0, "accepted_answer_id": 29112255, "answer_count": 1, "score": 0, "last_activity_date": 1426778649, "creation_date": 1426632294, "question_id": 29111129, "link": "https://stackoverflow.com/questions/29111129/rails-4-drop-down-select-list-different-model", "title": "Rails 4 drop down select list different model", "body": "<p>New to Rails so go easy on me :-)</p>\n\n<p>I have 2 models: User and Role:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_many :roles\n  accepts_nested_attributes_for :roles\n  validates_presence_of :role_id\nend\n\nclass Role &lt; ActiveRecord::Base\n  belongs_to :user\nend\n</code></pre>\n\n<p>User has a role_id for the foreign key.</p>\n\n<p>All I'm trying to do is be able to select a role for the user in the users/new form.  I know it's easy, but I cannot seem to figure it out...I've literally read for hours today trying to figure it out.  The drop down select list appears in the view, but it always fails validation (like it shows up, but never actually associates what the user selects with the User.role_id)</p>\n\n<p>Here is what I have in my form partial to show the drop down:</p>\n\n<pre><code>&lt;%= f.collection_select :role_id, Role.all, :id, :name %&gt;\n</code></pre>\n\n<p>Can anyone point me in the right direction?  Maybe I have to use some sort of nested forms, but nothing I have tried seems to work and this is what I currently have.  Do I have to do something in my controller?</p>\n"}, {"tags": ["ruby", "variable-assignment"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1426634212, "post_id": 29110746, "comment_id": 46452070, "body": "You can also use <a href=\"http://ruby-doc.org/core-2.2.0/String.html#method-i-sub\" rel=\"nofollow noreferrer\">String#sub</a> with a regular expression: <code>&#39;hat&#39;.sub(&#47;.$&#47;,&#39;d&#39;) #=&gt; &#39;had&#39;</code>. This does not alter <code>&quot;hat&quot;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 7454, "user_id": 1377943, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/4i1Qa.jpg?s=128&g=1", "display_name": "Paritosh Piplewar", "link": "https://stackoverflow.com/users/1377943/paritosh-piplewar"}, "is_accepted": true, "score": 2, "last_activity_date": 1426630670, "last_edit_date": 1495541574, "creation_date": 1426630670, "answer_id": 29110793, "question_id": 29110746, "link": "https://stackoverflow.com/questions/29110746/ruby-temporary-variable-assignment-and-modification/29110793#29110793", "title": "Ruby temporary variable assignment and modification", "body": "<blockquote>\n  <p>Why is this happening</p>\n</blockquote>\n\n<p>You should definitely read this <a href=\"https://stackoverflow.com/questions/1872110/is-ruby-pass-by-reference-or-by-value\">Is Ruby pass by reference or by value?</a> </p>\n\n<blockquote>\n  <p>how can I keep both values?</p>\n</blockquote>\n\n<p>use <code>dup</code>. it copies the <code>object</code></p>\n\n<pre><code>word = \"hat\"\ntemp = word.dup\ntemp[temp.length-1] = \"d\"\n\nputs \"temp is #{temp}\"\nputs \"word is #{word}\"\n\n# Output:\n# temp is had\n# word is hat\n</code></pre>\n"}], "owner": {"reputation": 205, "user_id": 1708082, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ekh1h.png?s=128&g=1", "display_name": "jessicaraygun", "link": "https://stackoverflow.com/users/1708082/jessicaraygun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 773, "favorite_count": 0, "accepted_answer_id": 29110793, "answer_count": 1, "score": 1, "last_activity_date": 1426630670, "creation_date": 1426630440, "question_id": 29110746, "link": "https://stackoverflow.com/questions/29110746/ruby-temporary-variable-assignment-and-modification", "title": "Ruby temporary variable assignment and modification", "body": "<p>I have a word like \"hat\", and I want to make a new word that is exactly the same, but with a different last letter.</p>\n\n<pre><code>word = \"hat\"\ntemp = word\ntemp[temp.length-1] = \"d\"\n\nputs \"temp is #{temp}\"\nputs \"word is #{word}\"\n\n# Output:\n# temp is had\n# word is had\n</code></pre>\n\n<p>I would now expect  <code>temp = \"had\"</code> and <code>word = \"hat\"</code> but both of the words get changed to had!</p>\n\n<p>I have a hunch that this might have to do with both variables pointing to the same location in memory? </p>\n\n<p>Why is this happening, and how can I keep both values?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "debugging", "pry"], "comments": [{"owner": {"reputation": 7898, "user_id": 3437900, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/blKgR.jpg?s=128&g=1", "display_name": "illusionist", "link": "https://stackoverflow.com/users/3437900/illusionist"}, "edited": false, "score": 0, "creation_date": 1426641216, "post_id": 29110544, "comment_id": 46454121, "body": "we normally pry in` development` and` test ` env only.  I think restarting the console/server have to fix this issue. Make sure that you had writing access to that file. :)"}, {"owner": {"reputation": 1470, "user_id": 1987461, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/664b3ec09a4053da7ecd919255539b54?s=128&d=identicon&r=PG", "display_name": "borjagvo", "link": "https://stackoverflow.com/users/1987461/borjagvo"}, "reply_to_user": {"reputation": 7898, "user_id": 3437900, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/blKgR.jpg?s=128&g=1", "display_name": "illusionist", "link": "https://stackoverflow.com/users/3437900/illusionist"}, "edited": false, "score": 0, "creation_date": 1426673325, "post_id": 29110544, "comment_id": 46465268, "body": "@cba_bhusal thanks, but if I didn&#39;t had write access it wouldn&#39;t let me stick binding.pry in the first place, right? However, I have write access. Also, restarting the console doesn&#39;t fix this. I had that situation before, where I own a file, I insert binding.pry, and it doesn&#39;t go away until I restart. However, this seems to be different. It looks like pry doesn&#39;t get cleared when you restart."}], "answers": [{"comments": [{"owner": {"reputation": 1470, "user_id": 1987461, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/664b3ec09a4053da7ecd919255539b54?s=128&d=identicon&r=PG", "display_name": "borjagvo", "link": "https://stackoverflow.com/users/1987461/borjagvo"}, "edited": false, "score": 0, "creation_date": 1426631498, "post_id": 29110687, "comment_id": 46451162, "body": "I already restarted by exiting and running <code>bundle exec rails c production</code> again."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1426630164, "creation_date": 1426630164, "answer_id": 29110687, "question_id": 29110544, "link": "https://stackoverflow.com/questions/29110544/pry-keeps-breaking-although-i-removed-binding-pry/29110687#29110687", "title": "Pry keeps breaking although I removed binding.pry", "body": "<p>You need to restart your server, otherwise Ruby would not reload the file and would not see your changes.</p>\n"}], "owner": {"reputation": 1470, "user_id": 1987461, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/664b3ec09a4053da7ecd919255539b54?s=128&d=identicon&r=PG", "display_name": "borjagvo", "link": "https://stackoverflow.com/users/1987461/borjagvo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1426630164, "creation_date": 1426629608, "question_id": 29110544, "link": "https://stackoverflow.com/questions/29110544/pry-keeps-breaking-although-i-removed-binding-pry", "title": "Pry keeps breaking although I removed binding.pry", "body": "<p>Using gem 'pry-rails'. I run <code>bundle exec rails c production</code> and executed <code>gem-cd mongoid</code>. Then opened storage_options.rb by running <code>edit lib/mongoid/sessions/storage_options.rb</code>. I put a breakpoint (binding.pry) in some line and close the file. I made some test and debugged ok. When I came back and got rid of the breakpoint, Pry will keep stopping at the same point although <code>binding.pry</code> is not there anymore (at least what I see on the console) and when I edit the file:</p>\n\n<p>Before:</p>\n\n<pre><code>From: /Users/borjagvo/.rbenv/versions/2.1.2/lib/ruby/gems/2.1.0/bundler/ruby/2.1.0/gems/mongoid-4.0.2/lib/mongoid/sessions/storage_options.rb @ line 134 Mongoid::Sessions::StorageOptions::ClassMethods#__evaluate__:\n\n    129:         # @return [ Symbol ] The value as a symbol.\n    130:         #\n    131:         # @since 3.1.0\n    132:         def __evaluate__(name)\n    133:           binding.pry\n =&gt; 134:           return nil unless name\n    135:           name.respond_to?(:call) ? name.call.to_sym : name.to_sym\n    136:         end\n    137:       end\n    138:     end\n    139:   end\n    140: end\n\n[1] pry(User)&gt;\n</code></pre>\n\n<p>After:</p>\n\n<pre><code>From: /Users/borjagvo/.rbenv/versions/2.1.2/lib/ruby/gems/2.1.0/bundler/ruby/2.1.0/gems/mongoid-4.0.2/lib/mongoid/sessions/storage_options.rb @ line 134 Mongoid::Sessions::StorageOptions::ClassMethods#__evaluate__:\n    129:         # @return [ Symbol ] The value as a symbol.\n    130:         #\n    131:         # @since 3.1.0\n    132:         def __evaluate__(name)\n    133:           return nil unless name\n =&gt; 134:           name.respond_to?(:call) ? name.call.to_sym : name.to_sym\n    135:         end\n    136:       end\n    137:     end\n    138:   end\n    139: end\n\n[1] pry(User)&gt;\n</code></pre>\n\n<p>Why does this happen? How can I \"delete\" the breakpoint?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "syntax"], "comments": [{"owner": {"reputation": 1356, "user_id": 1175943, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7a3218043040195cb524c5988d8c06d5?s=128&d=identicon&r=PG", "display_name": "sebkkom", "link": "https://stackoverflow.com/users/1175943/sebkkom"}, "edited": false, "score": 1, "creation_date": 1426629871, "post_id": 29110475, "comment_id": 46450540, "body": "There is a <code>Now</code> next to the second-to-last <code>end</code>, you should remove it for starters."}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 3385972, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/HS0su.jpg?s=128&g=1", "display_name": "DillonCarter", "link": "https://stackoverflow.com/users/3385972/dilloncarter"}, "edited": false, "score": 0, "creation_date": 1426631036, "post_id": 29110621, "comment_id": 46451021, "body": "This fixed the error, thank you! :)  Now I need to fix all of these failed tests lol."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 2, "last_activity_date": 1426629935, "creation_date": 1426629935, "answer_id": 29110621, "question_id": 29110475, "link": "https://stackoverflow.com/questions/29110475/syntax-error-unexpected-keyword-when-expecting-keyword-end-syntaxerror/29110621#29110621", "title": "syntax error, unexpected keyword_when, expecting keyword_end (SyntaxError)", "body": "<p>This <code>end</code>:</p>\n\n<pre><code>  end  &lt;&lt;&lt;&lt;=====\n\n#Additions\n\n  when 'Mahi Fillet'\n</code></pre>\n\n<p>closes the whole <code>case</code> block and therefore the <code>when</code> in the next line doesn't make sense for the parser. Just delete that <code>end</code> to solve your problem.</p>\n"}], "owner": {"reputation": 87, "user_id": 3385972, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/HS0su.jpg?s=128&g=1", "display_name": "DillonCarter", "link": "https://stackoverflow.com/users/3385972/dilloncarter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1009, "favorite_count": 0, "accepted_answer_id": 29110621, "answer_count": 1, "score": 0, "last_activity_date": 1426629935, "creation_date": 1426629382, "question_id": 29110475, "link": "https://stackoverflow.com/questions/29110475/syntax-error-unexpected-keyword-when-expecting-keyword-end-syntaxerror", "title": "syntax error, unexpected keyword_when, expecting keyword_end (SyntaxError)", "body": "<p>Working through a code challenge where I have to add support to a \"register\". I've added the newly supported items as the following:</p>\n\n<pre><code>    require 'register'\n\nrequire 'timecop'\n\ndescribe Register do\n  subject { described_class.new }\n\n  describe 'Frozen Pizza' do\n    it 'should be $5.00 each' do\n      subject.ring_up('Frozen Pizza', quantity: 1)\n      expect(subject.total).to eq 5.00\n      subject.ring_up('Frozen Pizza', quantity: 1)\n      expect(subject.total).to eq 10.00\n    end\n  end\n\n  describe 'Corn' do\n    it 'should be $0.50 each' do\n      subject.ring_up('Corn', quantity: 1)\n      expect(subject.total).to eq 0.50\n    end\n    it 'should be 5 for $2.00' do\n      subject.ring_up('Corn', quantity: 5)\n      expect(subject.total).to eq 2.00\n      subject.ring_up('Corn', quantity: 1)\n      expect(subject.total).to eq 2.50\n    end\n  end\n\n  describe 'Ground Beef' do\n    it 'should be $4.99/lb' do\n      subject.ring_up('Ground Beef', quantity: 1)\n      expect(subject.total).to eq 4.99\n    end\n    it 'should allow partial pounds' do\n      subject.ring_up('Ground Beef', quantity: 0.5)\n      expect(subject.total).to eq 2.50\n    end\n  end\n\n  describe 'Chocolate Mayfield Ice Cream' do\n    it 'should be $5.99' do\n      subject.ring_up('Chocolate Mayfield Ice Cream', quantity: 1)\n      expect(subject.total).to eq 5.99\n    end\n    context 'on Wednesdays' do\n      before { Timecop.freeze(Time.parse('2014-06-18 13:00:00')) }\n      after  { Timecop.return }\n\n      it 'should be BOGO' do\n        subject.ring_up('Chocolate Mayfield Ice Cream', quantity: 2)\n        expect(subject.total).to eq 5.99\n        subject.ring_up('Chocolate Mayfield Ice Cream', quantity: 1)\n        expect(subject.total).to eq 11.98\n      end\n    end\n    context 'on Non-Wednesdays' do\n      before { Timecop.freeze(Time.parse('2014-06-19 13:00:00')) }\n      after  { Timecop.return }\n\n      it 'should be NOT be BOGO' do\n        subject.ring_up('Chocolate Mayfield Ice Cream', quantity: 2)\n        expect(subject.total).to eq 11.98\n      end\n    end\n  end\n\n  describe 'Vanilla Mayfield Ice Cream' do\n    it 'should be $5.99' do\n      subject.ring_up('Vanilla Mayfield Ice Cream', quantity: 1)\n      expect(subject.total).to eq 5.99\n      subject.ring_up('Vanilla Mayfield Ice Cream', quantity: 1)\n      expect(subject.total).to eq 11.98\n    end\n  end\n\n  describe 'Mango' do\n    context 'on Mondays' do\n      before { Timecop.freeze(Time.parse('2014-06-16 13:00:00')) }\n      after  { Timecop.return }\n      it 'should be $0.50 each' do\n        subject.ring_up('Mango', quantity: 1)\n        expect(subject.total).to eq 0.50\n        subject.ring_up('Mango', quantity: 1)\n        expect(subject.total).to eq 1.00\n      end\n    end\n  end\n\n    context 'on Non-Mondays' do\n      before { Timecop.freeze(Time.parse('2014-06-17 13:00:00')) }\n      after  { Timecop.return }\n      it 'should be $1.00 each' do\n        subject.ring_up('Mango', quantity: 1)\n        expect(subject.total).to eq 1.00\n        subject.ring_up('Mango', quantity: 1)\n        expect(subject.total).to eq 2.00\n      end\n    end\n\n\n# Adding Additional Support To the Following Items\n\n    describe 'Mahi Fillet' do\n      it 'should be $7.99' do\n        subject.ring_up('Mahi Fillet', quantity: 1)\n        expect(subject.total).to eq 7.99\n        subject.ring_up('Mahi Fillet', quantity: 1)\n        expect(subject.total).to eq 15.98\n      end\n    end\n\n    describe 'Mac &amp; Cheese' do\n      it 'should be $1.29 each' do\n        subject.ring_up('Mac &amp; Cheese', quantity: 1)\n        expect(subject.total).to eq 1.29\n      end\n        it 'should be 5 for $10.00' do\n          subject.ring_up('Corn', quantity: 10)\n          expect(subject.total).to eq 10.00\n          subject.ring_up('Corn', quantity: 1)\n          expect(subject.total).to eq 1.00\n        end\n    end\n\n    describe 'Super Ripe Avacados' do\n      it 'should be $1,10' do\n        subject.ring_up('Super Ripe Avacados', quantity: 1)\n        expect(subject.total).to eq 1.10\n      end\n\n      it 'should be BOGO' do\n        subject.ring_up('Super Ripe Avacados', quantity: 3)\n        expect(subject.total).to eq 1.10\n        subject.ring_up('Super Ripe Avacados', quantity: 1)\n        expect(subject.total).to eq 0.36666666666667\n      end\n    end\n\n\nend\n</code></pre>\n\n<p>Now I am creating some tests to run via Rake and commented as #Additions and after adding just one I get the Syntax Error and I'm completely stumped here. </p>\n\n<pre><code>    class Register\n  attr :items\n\n  def initialize\n    @items = Hash.new(0)\n  end\n\n  def ring_up(item, args)\n    @items[item] += args[:quantity]\n  end\n\n  def total\n    total = 0\n    items.each do |item, quantity|\n      case item\n      when 'Frozen Pizza'\n        total += quantity * 5\n      when 'Corn'\n        if (quantity % 5 == 0) \n          total += quantity / 5 * 2.00\n        else\n          bundles = quantity / 5\n          singles = quantity % 5\n          total += bundles * 2.00 + singles * 0.50\n        end\n      when 'Ground Beef'\n        total += (quantity * 4.99).round(2)\n      when /Mayfield Ice Cream/\n        if (quantity % 2 == 0) \n          if item =~ /^Chocolate/\n            if Time.now.strftime(\"%A\") == 'Wednesday'\n              total += quantity / 2 * 5.99\n            else\n              total += quantity * 5.99\n            end\n          else\n            total += quantity * 5.99\n          end\n        else\n          if item =~ /^Chocolate/\n            if Time.now.strftime(\"%A\") == 'Wednesday'\n              total += (quantity / 2) * 5.99 + (quantity % 2) * 5.99\n            else\n              total += quantity * 5.99\n            end\n          else\n            total += quantity * 5.99\n          end\n        end\n      when 'Mango'\n        if Time.now.strftime(\"%A\") == 'Monday'\n          total += quantity * 0.50\n        else\n          total += quantity * 1.00\n        end\n      end\n\n#Additions\n\n      when 'Mahi Fillet'\n        total += quantity * 7.99\n      end \n\n\n\n    end\n    total\n  endNow \n\nend\n</code></pre>\n\n<p>The complete error return is the following:</p>\n\n<pre><code>syntax error, unexpected keyword_when, expecting keyword_end (SyntaxError)\n      when 'Mahi Fillet'\n          ^\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "replace"], "comments": [{"owner": {"reputation": 151, "user_id": 1322381, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bcdfdf2c47188c4235d4d35e55865d13?s=128&d=identicon&r=PG", "display_name": "Axiombadger", "link": "https://stackoverflow.com/users/1322381/axiombadger"}, "edited": false, "score": 0, "creation_date": 1426628990, "post_id": 29110329, "comment_id": 46450116, "body": "Edit: ArgoXML should read ArgoUML"}, {"owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "edited": false, "score": 1, "creation_date": 1426629016, "post_id": 29110329, "comment_id": 46450124, "body": "Can you provide a minimal example if what you&#39;re looking to do? This is probably doable, but I want to be sure I understand the question correctly."}, {"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 1, "creation_date": 1426629378, "post_id": 29110329, "comment_id": 46450307, "body": "Can you tweak the generator?"}, {"owner": {"reputation": 32543, "user_id": 528726, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6307569a99dd77fff0463032051d7e39?s=128&d=identicon&r=PG", "display_name": "joelparkerhenderson", "link": "https://stackoverflow.com/users/528726/joelparkerhenderson"}, "edited": false, "score": 0, "creation_date": 1426629416, "post_id": 29110329, "comment_id": 46450331, "body": "Brilliant idea. If you decide to create this, and open source it, I&#39;ll donate to your project. My advice is to look at <a href=\"http://rubini.us/\" rel=\"nofollow noreferrer\">rubinius</a> because it contains a ruby parser, and runtime."}, {"owner": {"reputation": 151, "user_id": 1322381, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bcdfdf2c47188c4235d4d35e55865d13?s=128&d=identicon&r=PG", "display_name": "Axiombadger", "link": "https://stackoverflow.com/users/1322381/axiombadger"}, "edited": false, "score": 0, "creation_date": 1426629995, "post_id": 29110329, "comment_id": 46450595, "body": "If I clean it up then yeah I will stick it up somewhere.  It is quite rough around the edges at the moment though and I need a short write up on how it works (as I have restricted the UML Class Diagram to reflect how Rails works).  I have added an example inline."}, {"owner": {"reputation": 151, "user_id": 1322381, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bcdfdf2c47188c4235d4d35e55865d13?s=128&d=identicon&r=PG", "display_name": "Axiombadger", "link": "https://stackoverflow.com/users/1322381/axiombadger"}, "reply_to_user": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1426630043, "post_id": 29110329, "comment_id": 46450618, "body": "@BradWerth, do you mean adjust the generator so that it automatically overwrites rather than replaces?  I could if there is a way to do that.  I am just trying to think if that will work for all cases.  My controller example is straightforward, it is some of the models which may get trickier.  If there is suitable merge functionality on the generator though"}, {"owner": {"reputation": 151, "user_id": 1322381, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bcdfdf2c47188c4235d4d35e55865d13?s=128&d=identicon&r=PG", "display_name": "Axiombadger", "link": "https://stackoverflow.com/users/1322381/axiombadger"}, "edited": false, "score": 0, "creation_date": 1426630291, "post_id": 29110329, "comment_id": 46450716, "body": "The state the XMI to Rails script is in at the moment is one where it creates a model or scaffold for each class.  Adds the attributes to generator (and therefore migration).  Looks through the relations and supports has_one, has_many and has_many :through, puts the generator commands in order (this was the bit that took a while) so that Rails does not throw a hissy fit when you reference something that has yet to be created."}, {"owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "edited": false, "score": 1, "creation_date": 1426630455, "post_id": 29110329, "comment_id": 46450793, "body": "I&#39;m pretty sure it can be done. Working on a solution at the moment. But yeah, providing your own generator is probably a lot easier. :)"}, {"owner": {"reputation": 151, "user_id": 1322381, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bcdfdf2c47188c4235d4d35e55865d13?s=128&d=identicon&r=PG", "display_name": "Axiombadger", "link": "https://stackoverflow.com/users/1322381/axiombadger"}, "reply_to_user": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "edited": false, "score": 0, "creation_date": 1426634941, "post_id": 29110329, "comment_id": 46452323, "body": "I updated the question showing what I have done with the template hacking code from @ChrisHeald, it works well with what I have in place."}, {"owner": {"reputation": 151, "user_id": 1322381, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bcdfdf2c47188c4235d4d35e55865d13?s=128&d=identicon&r=PG", "display_name": "Axiombadger", "link": "https://stackoverflow.com/users/1322381/axiombadger"}, "reply_to_user": {"reputation": 2993, "user_id": 27408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62002cee15efcf4628cd7efc19425a07?s=128&d=identicon&r=PG", "display_name": "a2800276", "link": "https://stackoverflow.com/users/27408/a2800276"}, "edited": false, "score": 0, "creation_date": 1440953976, "post_id": 29110329, "comment_id": 52474316, "body": "@a2800276 whilst I appreciate edits on questions some of your suggested changes are either nit picking or miss the point.  For example I purposefully wrote &quot;open classes&quot; rather than &quot;opening classes&quot; because it is the given name for such a thing in the Ruby language (<a href=\"http://rubylearning.com/satishtalim/ruby_open_classes.html\" rel=\"nofollow noreferrer\">rubylearning.com/satishtalim/ruby_open_classes.html</a>).  I also wrote &quot;to see if I could&quot; rather than &quot;to see if I can&quot; because it was a past tense task which I did actually complete.  The rest of the edit it just some bold headers and the use of &quot;First Off&quot; rather than &quot;Firstly&quot; which is nothing but personal preference."}, {"owner": {"reputation": 151, "user_id": 1322381, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bcdfdf2c47188c4235d4d35e55865d13?s=128&d=identicon&r=PG", "display_name": "Axiombadger", "link": "https://stackoverflow.com/users/1322381/axiombadger"}, "reply_to_user": {"reputation": 2993, "user_id": 27408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62002cee15efcf4628cd7efc19425a07?s=128&d=identicon&r=PG", "display_name": "a2800276", "link": "https://stackoverflow.com/users/27408/a2800276"}, "edited": false, "score": 0, "creation_date": 1440954592, "post_id": 29110329, "comment_id": 52474508, "body": "Tarod, I may have accidentally tried to revert your change.  It does not seem to have gone through, not sure if you need to approve it.  If so then reject it.  You were right, the tag source can be removed.   I was just trying to revert back the changes @a2800276 made."}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 1322381, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bcdfdf2c47188c4235d4d35e55865d13?s=128&d=identicon&r=PG", "display_name": "Axiombadger", "link": "https://stackoverflow.com/users/1322381/axiombadger"}, "edited": false, "score": 0, "creation_date": 1426633014, "post_id": 29110984, "comment_id": 46451724, "body": "Thanks for that, I will take a look at both methods and see what suits.  Actually hacking up the templates may be of benefit anyway instead of the Awk I am currently using."}], "tags": [], "owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "is_accepted": true, "score": 2, "last_activity_date": 1426634251, "last_edit_date": 1426634251, "creation_date": 1426631622, "answer_id": 29110984, "question_id": 29110329, "link": "https://stackoverflow.com/questions/29110329/replacing-a-function-in-a-ruby-source-file-with-ruby/29110984#29110984", "title": "Replacing a function in a Ruby source file with Ruby", "body": "<h1>Generators</h1>\n\n<p>The easiest way to do this is going to be to just use a custom generator template.</p>\n\n<blockquote>\n  <p>In Rails 3.0 and above, generators don't just look in the source root for templates, they also search for templates in other paths. And one of them is lib/templates. Since we want to customize Rails::Generators::HelperGenerator, we can do that by simply making a template copy inside lib/templates/rails/helper with the name helper.rb.</p>\n</blockquote>\n\n<p><a href=\"http://guides.rubyonrails.org/generators.html#customizing-your-workflow-by-changing-generators-templates\" rel=\"nofollow\">http://guides.rubyonrails.org/generators.html#customizing-your-workflow-by-changing-generators-templates</a></p>\n\n<p>The template for a controller is here:</p>\n\n<p><a href=\"https://github.com/rails/rails/blob/master/railties/lib/rails/generators/rails/controller/templates/controller.rb\" rel=\"nofollow\">https://github.com/rails/rails/blob/master/railties/lib/rails/generators/rails/controller/templates/controller.rb</a></p>\n\n<p>So you could just create a copy of that in <code>lib/templates/rails/controller/controller.rb</code>, and customize it to be something like:</p>\n\n<pre><code>&lt;% if namespaced? -%&gt;\nrequire_dependency \"&lt;%= namespaced_path %&gt;/application_controller\"\n&lt;% end -%&gt;\n&lt;% module_namespacing do -%&gt;\nclass &lt;%= class_name %&gt;Controller &lt; ApplicationController\n\n  def show\n    puts params[:rule_set_edition_id]\n    @description = @rule.description\n    @input_lines = @description.split(\"\\\\n\")\n    @output_lines = []\n    for input_line in @input_lines do\n      if input_line != \"\" then\n        @output_lines &lt;&lt; input_line\n      end\n    end\n\n    @rule_set_edition\n  end\n\n  def some_other_method\n    puts \"FooBar\"\n  end\n\n&lt;% (actions - [:show, :some_other_method]).each do |action| -%&gt;\n  def &lt;%= action %&gt;\n  end\n&lt;%= \"\\n\" unless action == actions.last -%&gt;\n&lt;% end -%&gt;\nend\n&lt;% end -%&gt;\n</code></pre>\n\n<p>Then, when you generate a controller, Rails will use your template (with your implementations).</p>\n\n<p>That said, if these methods are common between all your generated controllers, you should consider simply inheriting your controllers from a common superclass, and then having the default implementation of <code>show</code> be something like:</p>\n\n<pre><code>def show\n  super\nend\n</code></pre>\n\n<p>There are also options for post-processing generated templates using <code>source_location</code> to detect method boundaries, but it's fiddly. I'm working on a proof-of-concept for that at the moment.</p>\n\n<h1>Actually hacking up the templates</h1>\n\n<p>We're going to use the <code>method_source</code> gem, which uses <code>Method#source_location</code> to find where a method starts, and then evaluates lines until it finds a complete expression. Once we have that, then we can just replace the given method with our implementation.</p>\n\n<p>This is fairly awful and I recommend against it if feasible.</p>\n\n<h3>implementation.rb</h3>\n\n<pre><code>  def show\n    puts params[:rule_set_edition_id]\n    @description = @rule.description\n    @input_lines = @description.split(\"\\\\n\")\n    @output_lines = []\n    for input_line in @input_lines do\n      if input_line != \"\" then\n        @output_lines &lt;&lt; input_line\n      end\n    end\n\n    @rule_set_edition\n  end\n\n  def some_other_method\n    puts \"FooBar\"\n  end\n</code></pre>\n\n<h3>template.rb</h3>\n\n<pre><code>class RulesController &lt; ApplicationController\n  before_action :set_rule, only: [:show, :edit, :update, :destroy]\n\n  # GET /rules\n  # GET /rules.json\n  def index\n    @rules = Rule.all\n  end\n\n  # GET /rules/1\n  # GET /rules/1.json\n  def show\n  end\n\n  # GET /rules/new\n  def new\n    @rule = Rule.new\n  end\n\n  # GET /rules/1/edit\n  def edit\n  end\n\n  # . . . etc\nend\n</code></pre>\n\n<h3>converter.rb</h3>\n\n<pre><code>require 'method_source'\ninclude MethodSource::CodeHelpers\n\n$implementation = open(\"implementation.rb\")\n$template = open(\"template.rb\")\n\nmodule Implementation\n  class &lt;&lt; self\n    eval $implementation.read\n  end\nend\n\n@template_by_line = $template.each_line.to_a\n\n(Implementation.methods - Module.new.methods).each do |method|\n  $implementation.rewind\n  # Get the source code of our implementation method\n  impl_source = expression_at $implementation, Implementation.method(method).source_location[1]\n\n  # Get the line that this method starts on in the template\n  template_line = @template_by_line.index {|line| line.match(/^\\s*def #{method}/) }\n\n  if template_line\n    # If we found a match, replace it\n    # Get the source code for the template method\n    tmpl_source = expression_at @template_by_line, template_line + 1\n\n    # Replace it with the implemetation method\n    @template_by_line[template_line] = impl_source\n\n    # Remove any extra lines from the template method\n    tmpl_source.split(/\\n/).length.times do |len|\n      @template_by_line.delete_at template_line + len + 1\n    end\n  else\n    # find the last `end` in the template array and insert the implementation source before it\n    last_end = @template_by_line.rindex {|line| line.match(/^\\s*end/)}\n    @template_by_line.insert(last_end, \"\\n\" + impl_source + \"\\n\")\n  end\n\nend\nputs @template_by_line.join\n</code></pre>\n\n<p>And some output:</p>\n\n<pre><code>$ ruby converter.rb\nclass RulesController &lt; ApplicationController\n  before_action :set_rule, only: [:show, :edit, :update, :destroy]\n\n  # GET /rules\n  # GET /rules.json\n  def index\n    @rules = Rule.all\n  end\n\n  # GET /rules/1\n  # GET /rules/1.json\n  def show\n    puts params[:rule_set_edition_id]\n    @description = @rule.description\n    @input_lines = @description.split(\"\\\\n\")\n    @output_lines = []\n    for input_line in @input_lines do\n      if input_line != \"\" then\n        @output_lines &lt;&lt; input_line\n      end\n    end\n\n    @rule_set_edition\n  end\n\n  def new\n    @rule = Rule.new\n  end\n\n  # GET /rules/1/edit\n  def edit\n\n  def some_other_method\n    puts \"FooBar\"\n  end  end\n\n  # . . . etc\nend\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 1322381, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bcdfdf2c47188c4235d4d35e55865d13?s=128&d=identicon&r=PG", "display_name": "Axiombadger", "link": "https://stackoverflow.com/users/1322381/axiombadger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 29110984, "answer_count": 1, "score": 1, "last_activity_date": 1440954448, "creation_date": 1426628786, "last_edit_date": 1440954448, "question_id": 29110329, "link": "https://stackoverflow.com/questions/29110329/replacing-a-function-in-a-ruby-source-file-with-ruby", "title": "Replacing a function in a Ruby source file with Ruby", "body": "<p>Firstly, I am using Ruby 2.2.0 with Rails 4.2.0 (so I have ActiveSupport installed if anything in there is helpful for this task).</p>\n\n<p><strong>The What</strong></p>\n\n<p>What I want to be able to do is read a Ruby file and take any methods which are declared in it, then write / overwrite them into another Ruby file which might already have those methods declared.</p>\n\n<p>I want to do this in the source file, it is to be done as a kind of pre-processor thing, not at runtime.  I am not talking about <a href=\"http://rubylearning.com/satishtalim/ruby_open_classes.html\" rel=\"nofollow\">Open Classes</a>, I want to permanently edit a source file.</p>\n\n<p>If there is nothing then I will do something with reading files, going line by line looking for <code>def</code> and <code>end</code> statements but I am wondering if something like this already exists?</p>\n\n<p><strong>The Why</strong></p>\n\n<p>Partly to work with and partly to see if I could, I wrote a script in Ruby which parses an XMI file generated by ArgoXML, using some further constraints in my drawing so that my script knows when I am using <code>has_many</code> or <code>has_many :through</code>, the latter I used for all my habtm.</p>\n\n<p>It then creates Rails generator commands in a shell script for all of my models etc, and uses awk to inject any relations which need setup manually (as in not in the line with the generator).</p>\n\n<p>This quickly created models and database entries for some 100 tables.  Obviously though running my script again removes any existing files (or asks me 100 times what I want to do, which given that most of the time is destroy, I would rather not).</p>\n\n<p><strong>Example:</strong></p>\n\n<p>I am happy to just have a class with function declarations in it, or I can put it in a named class or module, it does not matter.  There will only ever be one class in a file.</p>\n\n<p>What I want to happen is read the contents of File A, get each method from the file.  I then want to overwrite these methods into the source of File B such that I get File C.</p>\n\n<p><strong>File A (the file whose methods need inserted into File B)</strong></p>\n\n<pre><code>def show\n  puts params[:rule_set_edition_id]\n  @description = @rule.description\n  @input_lines = @description.split(\"\\\\n\")\n  @output_lines = []\n  for input_line in @input_lines do\n    if input_line != \"\" then\n      @output_lines &lt;&lt; input_line\n    end\n  end\n\n  @rule_set_edition \nend\n\ndef some_other_method\n  puts \"FooBar\"\nend\n</code></pre>\n\n<p><strong>File B (Part - Standard Rails Scaffold, before overwrite)</strong></p>\n\n<pre><code>class RulesController &lt; ApplicationController\n  before_action :set_rule, only: [:show, :edit, :update, :destroy]\n\n  # GET /rules\n  # GET /rules.json\n  def index\n    @rules = Rule.all\n  end\n\n  # GET /rules/1\n  # GET /rules/1.json\n  def show\n  end\n\n  # GET /rules/new\n  def new\n    @rule = Rule.new\n  end\n\n  # GET /rules/1/edit\n  def edit\n  end\n\n  . . . etc\n\nend\n</code></pre>\n\n<p><strong>File C (Part - The output file I want)</strong></p>\n\n<pre><code>class RulesController &lt; ApplicationController\n  before_action :set_rule, only: [:show, :edit, :update, :destroy]\n\n  # GET /rules\n  # GET /rules.json\n  def index\n    @rules = Rule.all\n  end\n\n  # GET /rules/1\n  # GET /rules/1.json\n  def show\n    puts params[:rule_set_edition_id]\n    @description = @rule.description\n    @input_lines = @description.split(\"\\\\n\")\n    @output_lines = []\n    for input_line in @input_lines do\n      if input_line != \"\" then\n        @output_lines &lt;&lt; input_line\n      end\n    end\n\n    @rule_set_edition \n  end\n\n  def some_other_method\n    puts \"FooBar\"\n  end\n\n  # GET /rules/new\n  def new\n    @rule = Rule.new\n  end\n\n  # GET /rules/1/edit\n  def edit\n  end\nend\n</code></pre>\n\n<p><strong>Update</strong>\nNB: I realise this is wrong atm and am fixing it.</p>\n\n<p>As I already have in my XMI Parser class a variable @models which has all the information on my XMI in a neat format I can add a function to my parser to hack the templates.</p>\n\n<p>I used the code provided by @ChrisHeald, putting it in a file named hack_templates.rb and making it accept command line ARGV for the implementation and template file locations.</p>\n\n<p>My new function then adds the lines for extra shell commands in my output.</p>\n\n<pre><code>    def hack_templates\n      hacks = []\n      for idref, model in @models do\n        # Controllers\n        controller_name = \"#{model['name'].tableize}_controller.rb\"\n        controller_implementation = \"./db/init/controllers/#{controller_name}\"\n        countroller_template = \"./app/controllers/#{controller_name}\"\n        if File.exist?(countroller_template) and File.exist?(controller_implementation) then\n          puts \"ruby hack_template.rb #{controller_implementation} #{countroller_template}\"\n        end\n        # Models\n\n        # Views\n      end\n      hacks.join(\"\\n\")\n    end\n</code></pre>\n\n<p>And the hack_templates.rb from the @ChrisHeald code:</p>\n\n<pre><code>require 'method_source'\ninclude MethodSource::CodeHelpers\n\n$implementation = open(ARGV[0])\n$template = open(ARGV[1])\n\nmodule Implementation\n  class &lt;&lt; self\n    eval $implementation.read\n  end\nend\n\n@template_by_line = $template.each_line.to_a\n\n(Implementation.methods - Module.new.methods).each do |method|\n  $implementation.rewind\n  # Get the source code of our implementation method\n  impl_source = expression_at $implementation, Implementation.method(method).source_location[1]\n\n  # Get the line that this method starts on in the template\n  template_line = @template_by_line.index {|line| line.match(/^\\s*def #{method}/) }\n\n  if template_line\n    # If we found a match, replace it\n    # Get the source code for the template method\n    tmpl_source = expression_at @template_by_line, template_line + 1\n\n    # Replace it with the implemetation method\n    @template_by_line[template_line] = impl_source\n\n    # Remove any extra lines from the template method\n    tmpl_source.split(/\\n/).length.times do |len|\n      @template_by_line.delete_at template_line + len + 1\n    end\n  else\n    # find the last `end` in the template array and insert the implementation source before it\n    last_end = @template_by_line.rindex {|line| line.match(/^\\s*end/)}\n    @template_by_line.insert(last_end, \"\\n\" + impl_source + \"\\n\")\n  end\n\nend\n\nFile.open($template, \"w+\") do |f|\n   f.syswrite(@template_by_line.join)\nend\n</code></pre>\n\n<p>This will only work from the second run onwards as the controller would not exist at the point where I call this code unless an old one is there.  For me it is probably as easy just to run it twice but I could also send the hack_template.rb commands to a different file from the main output.sh</p>\n\n<p><strong>Further Update</strong>\nIn the end I ended up using Rails Concerns.  I create a new concern for each class, following a naming convention of ClassNameConcern.  I then put all of my class methods in a concern leaving my models with just auto-generated stuff.</p>\n\n<p>Since I have like 100 models, of which 4 I have edited so far, this works well.  The answer by @ChrisHeald is still the correct answer for my question though.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "spree", "state-machine"], "comments": [{"owner": {"reputation": 6404, "user_id": 3363019, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/129352fb15374b8febd37cc99150c7c5?s=128&d=identicon&r=PG", "display_name": "patrick", "link": "https://stackoverflow.com/users/3363019/patrick"}, "edited": false, "score": 1, "creation_date": 1426629807, "post_id": 29110202, "comment_id": 46450504, "body": "Are you sure you don&#39;t mean <code>state_machine</code>? <a href=\"https://github.com/pluginaweek/state_machine\" rel=\"nofollow noreferrer\">github.com/pluginaweek/state_machine</a>"}, {"owner": {"reputation": 1, "user_id": 4682659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9891894dbf6ac0a67f089c36c4bbbe20?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej S", "link": "https://stackoverflow.com/users/4682659/maciej-s"}, "reply_to_user": {"reputation": 6404, "user_id": 3363019, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/129352fb15374b8febd37cc99150c7c5?s=128&d=identicon&r=PG", "display_name": "patrick", "link": "https://stackoverflow.com/users/3363019/patrick"}, "edited": false, "score": 0, "creation_date": 1426854425, "post_id": 29110202, "comment_id": 46551488, "body": "I think spree changed to state_machines somewhere in January. state_machine was not updated for some time."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 4713747, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102070040254549/picture?type=large", "display_name": "Jeff Hamm", "link": "https://stackoverflow.com/users/4713747/jeff-hamm"}, "is_accepted": false, "score": 5, "last_activity_date": 1427313081, "last_edit_date": 1427313081, "creation_date": 1427311907, "answer_id": 29264858, "question_id": 29110202, "link": "https://stackoverflow.com/questions/29110202/cannot-install-state-machines-gem-in-windows-environment/29264858#29264858", "title": "Cannot install state_machines gem in Windows environment", "body": "<p>I ran into this too.</p>\n\n<p>Looks like state_machines has some test case files that have a newline in the name. \nI'd bet that is the cause of the issue.\nI've submitted a pull request over here: <a href=\"https://github.com/state-machines/state_machines/pull/11\" rel=\"nofollow\">https://github.com/state-machines/state_machines/pull/11</a>\nIn the meantime, my branch doesn't have the issue: <a href=\"https://github.com/jeff-hamm/state_machines\" rel=\"nofollow\">https://github.com/jeff-hamm/state_machines</a> </p>\n\n<p>The specific fix (for the moment, until the pullrequest is accepted) is: </p>\n\n<pre><code>git clone https://github.com/jeff-hamm/state_machines\ncd state_machines\nbundle gem state_machines\nrake install\n</code></pre>\n\n<p>After doing that, 'gem install spree_core' worked just fine on windows. </p>\n\n<p>Keep in mind I am not planning on keeping my branch up to date (I will delete it if the request is accepted), so, that clone url won't be ideal for long</p>\n"}], "owner": {"reputation": 1, "user_id": 4682659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9891894dbf6ac0a67f089c36c4bbbe20?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej S", "link": "https://stackoverflow.com/users/4682659/maciej-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1073, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428772324, "creation_date": 1426628294, "last_edit_date": 1426854503, "question_id": 29110202, "link": "https://stackoverflow.com/questions/29110202/cannot-install-state-machines-gem-in-windows-environment", "title": "Cannot install state_machines gem in Windows environment", "body": "<p>I am new to Rails and would like to check how Spree ecommerce solution looks like before the customization. That's why I installed Ruby from RubyInstaller, DevKit, Rails, Spree etc. </p>\n\n<p>During installation of <code>state_machines</code> gem, below error appears and the gem is eventually not installed. </p>\n\n<pre><code>C:\\&gt;gem install state_machines \n\nERROR:  While executing gem ... (Errno::EINVAL)\nInvalid argument @ rb_sysopen - C:/Dev/Ruby/lib/ruby/gems/2.1.0/gems/state_m\nachines-  0.2.2/test/unit/node_collection/node_collection_after_being_copied_test.rb\n</code></pre>\n\n<p>This has impact on the <code>bundle install</code> of spree project later on:</p>\n\n<pre><code>Errno::EINVAL: Invalid argument @ rb_sysopen - C:/Dev/Ruby/lib/ruby/gems/2.1.0/g\nems/state_machines-0.2.2/test/unit/node_collection/node_collection_after_being_c\nopied_test.rb\nAn error occurred while installing state_machines (0.2.2), and Bundler cannot\ncontinue.Make sure that `gem install state_machines -v '0.2.2'` \nsucceeds before bundling.\n</code></pre>\n\n<p>Current ruby version installed is:\nruby 2.1.5p273 (2014-11-13 revision 48405) [i386-mingw32] + devkit </p>\n\n<p>rails version is 4.2.0</p>\n\n<p>I am running on Windows environment, without any possibility to move to Linux.</p>\n"}]