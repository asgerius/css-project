[{"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 428, "user_id": 1352507, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bpekt.png?s=128&g=1", "display_name": "Jen", "link": "https://stackoverflow.com/users/1352507/jen"}, "edited": false, "score": 2, "creation_date": 1479339700, "post_id": 40644211, "comment_id": 68520633, "body": "please post relevant portions of your spec and your controller code."}, {"owner": {"reputation": 23, "user_id": 7132650, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5M9s5Z9zCRs/AAAAAAAAAAI/AAAAAAAABGo/rIRA5TDj59E/photo.jpg?sz=128", "display_name": "Kainan Zhang", "link": "https://stackoverflow.com/users/7132650/kainan-zhang"}, "reply_to_user": {"reputation": 428, "user_id": 1352507, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bpekt.png?s=128&g=1", "display_name": "Jen", "link": "https://stackoverflow.com/users/1352507/jen"}, "edited": false, "score": 0, "creation_date": 1479393147, "post_id": 40644211, "comment_id": 68546215, "body": "Yes, I have added them to the question."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7132650, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5M9s5Z9zCRs/AAAAAAAAAAI/AAAAAAAABGo/rIRA5TDj59E/photo.jpg?sz=128", "display_name": "Kainan Zhang", "link": "https://stackoverflow.com/users/7132650/kainan-zhang"}, "edited": false, "score": 0, "creation_date": 1479391765, "post_id": 40646868, "comment_id": 68545174, "body": "Thanks Joey, I agree with you. I have completed that kind test by using anonymous controller."}], "tags": [], "owner": {"reputation": 742, "user_id": 391006, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2b58f66a540fba245e3a9484c4035e0?s=128&d=identicon&r=PG", "display_name": "Joey", "link": "https://stackoverflow.com/users/391006/joey"}, "is_accepted": false, "score": 1, "last_activity_date": 1479357715, "creation_date": 1479357715, "answer_id": 40646868, "question_id": 40644211, "link": "https://stackoverflow.com/questions/40644211/fail-to-rspec-before-filters/40646868#40646868", "title": "fail to rspec before_filters", "body": "<p>A better test would be to assert that a user cannot access the UploadsController (requests returns 404) and that an admin can (request returns 200). </p>\n\n<p>Asserting that the filter is called ties your test to the implementation of the <code>admin_only</code> method and not the end result of limiting what a user can access.</p>\n"}], "owner": {"reputation": 23, "user_id": 7132650, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5M9s5Z9zCRs/AAAAAAAAAAI/AAAAAAAABGo/rIRA5TDj59E/photo.jpg?sz=128", "display_name": "Kainan Zhang", "link": "https://stackoverflow.com/users/7132650/kainan-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479393114, "creation_date": 1479339133, "last_edit_date": 1495540793, "question_id": 40644211, "link": "https://stackoverflow.com/questions/40644211/fail-to-rspec-before-filters", "title": "fail to rspec before_filters", "body": "<p>I am new to Rails and I am using <a href=\"https://stackoverflow.com/questions/20775737/how-can-i-spec-before-filters\">Boti's evolved way to test my project</a>, however I got the following error:</p>\n\n<pre><code>&gt; Failures:\n\n  1) ApplicationController UploadsController admin_only should filter :before and {:with=&gt;:admin_only, :except=&gt;:show}\n     Failure/Error: extra = -&gt; (x) { x.options[:unless].include?( \"action_name == '#{filter[:except]}'\") }\n\n     NoMethodError:\n       undefined method `options' for #&lt;ActiveSupport::Callbacks::Callback:0x000006060f6598&gt;\n     # ./spec/support/matchers/filter.rb:5:in `block (3 levels) in &lt;top (required)&gt;'\n     # ./spec/support/matchers/filter.rb:9:in `call'\n     # ./spec/support/matchers/filter.rb:9:in `block (3 levels) in &lt;top (required)&gt;'\n     # ./spec/support/matchers/filter.rb:9:in `find'\n     # ./spec/support/matchers/filter.rb:9:in `block (2 levels) in &lt;top (required)&gt;'\n     # ./spec/controllers/application_controller_spec.rb:37:in `block (4 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>Could anyone help me out of this, thanks.</p>\n\n<p><strong><em>This is my spec:</em></strong></p>\n\n<pre><code>RSpec.describe ApplicationController, type: :controller do\n  include Devise::Test::ControllerHelpers\n       describe UploadsController do\n        context 'authentication' do\n         specify{ expect(UploadsController).to filter(:before, with: :authenticate_user!)}\n        end\n        context 'admin_only' do\n         specify{ expect(UploadsController).to filter(:before, with: :admin_only, except: :index)}\n        end\n      end\n   end\n</code></pre>\n\n<p><strong><em>This is controller</em></strong> </p>\n\n<pre><code>class UploadsController &lt; ApplicationController\n   before_action :authenticate_user!\n   before_action :admin_only, :except =&gt; :index\n   def index\n    begin\n      @uploads = Upload.all\n    rescue\n      redirect_to uploads_alert_uploads_path(:error_path =&gt; request.url, :error_time =&gt; DateTime.now)\n    end\n  end\nend\n</code></pre>\n\n<p><strong><em>This is matcher in spec/support/matchers/filter.rb</em></strong> </p>\n\n<pre><code>RSpec::Matchers.define :filter do |kind, filter|\n  match do |controller|\n    extra = -&gt; (x) {true}\n    if filter[:except].present?\n      extra = -&gt; (x) { x.options[:unless].include?( \"action_name == '#{filter[:except]}'\") }\n    elsif filter[:only].present?\n      extra = -&gt; (x) { x.options[:if].include?( \"action_name == '#{filter[:only]}'\") }\n    end\n    controller._process_action_callbacks.find{|x|x.kind == kind &amp;&amp; x.filter == filter[:with] &amp;&amp; extra.call(x)}\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "passenger", "shared-hosting"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6777762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yVFom.gif?s=128&g=1", "display_name": "Maks", "link": "https://stackoverflow.com/users/6777762/maks"}, "is_accepted": false, "score": 0, "last_activity_date": 1479466641, "creation_date": 1479466641, "answer_id": 40675334, "question_id": 40644057, "link": "https://stackoverflow.com/questions/40644057/passenger-error-could-not-find-rake-11-3-0-in-any-of-the-sources-bundlergemno/40675334#40675334", "title": "Passenger error Could not find rake-11.3.0 in any of the sources (Bundler::GemNotFound) on Bluehost shared hosting", "body": "<p>I did not work with bluehost before, but here are few suggestions, hope they can help:</p>\n\n<ol>\n<li>You can try to check where ruby version is set for Passenger. It depends how it is running on bluehost, if it is nginx - you can try to specify ruby version explicitly in webapp.conf file. If it is apache (did not work with it directly) - there should be it's own configuration file, where you can try to set the version explicitly</li>\n</ol>\n\n<p><a href=\"https://www.phusionpassenger.com/library/config/apache/reference/\" rel=\"nofollow noreferrer\">https://www.phusionpassenger.com/library/config/apache/reference/</a></p>\n\n<ol start=\"2\">\n<li><p>If the previous point did not help I would try to edit .bashrc file, not sure if it can be a problem (as I am using rvm), but it sounds strange for me:</p>\n\n<p>In setup article you provided is stated to edit .bashrc file: </p>\n\n<p><code>export GEM_PATH=$GEM_HOME:/lib64/ruby/gems/1.9.3</code> - could you check\nwhat you have there? If you upgraded to new ruby - probably path to  ruby 2.1.1 gems folder should be specified.</p></li>\n</ol>\n"}], "owner": {"reputation": 379, "user_id": 5777903, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ecfc987f0582d9ce60a4c7ead9323169?s=128&d=identicon&r=PG", "display_name": "Hussain Niazi", "link": "https://stackoverflow.com/users/5777903/hussain-niazi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1436, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1502358027, "creation_date": 1479338305, "last_edit_date": 1502358027, "question_id": 40644057, "link": "https://stackoverflow.com/questions/40644057/passenger-error-could-not-find-rake-11-3-0-in-any-of-the-sources-bundlergemno", "title": "Passenger error Could not find rake-11.3.0 in any of the sources (Bundler::GemNotFound) on Bluehost shared hosting", "body": "<p>I have to use bluehost shared hosting for some reason. I upgraded ruby to version 2.1.1 and Rails to version 4.2.2 (Following this article <a href=\"http://www.haydonryan.com/installing-ruby-2-1-1p76-and-rails-4-0-4-on-bluehost/\" rel=\"nofollow noreferrer\">http://www.haydonryan.com/installing-ruby-2-1-1p76-and-rails-4-0-4-on-bluehost/</a>).</p>\n\n<p>Then I uploaded my application and followed instructions provided by Bluehost at <a href=\"https://my.bluehost.com/cgi/help/rails\" rel=\"nofollow noreferrer\">https://my.bluehost.com/cgi/help/rails</a></p>\n\n<p>Now when I go to the domain obortunity.org I get this error message:-</p>\n\n<p>Ruby (Rack) application could not be started</p>\n\n<p>Error message:\nCould not find rake-11.3.0 in any of the sources (Bundler::GemNotFound)</p>\n\n<p>Exception class:\nPhusionPassenger::UnknownError</p>\n\n<p>Application root:\n/home4/obortuni/rails_apps/obortunity</p>\n\n<h1>Backtrace:</h1>\n\n<p>0   /usr/lib64/ruby/gems/1.9.3/gems/bundler-1.3.5/lib/bundler/spec_set.rb   92  in <code>block in materialize'\n1   /usr/lib64/ruby/gems/1.9.3/gems/bundler-1.3.5/lib/bundler/spec_set.rb   85  in</code>map!'\n2   /usr/lib64/ruby/gems/1.9.3/gems/bundler-1.3.5/lib/bundler/spec_set.rb   85  in <code>materialize'\n3   /usr/lib64/ruby/gems/1.9.3/gems/bundler-1.3.5/lib/bundler/definition.rb 114 in</code>specs'\n4   /usr/lib64/ruby/gems/1.9.3/gems/bundler-1.3.5/lib/bundler/definition.rb 159 in <code>specs_for'\n5   /usr/lib64/ruby/gems/1.9.3/gems/bundler-1.3.5/lib/bundler/definition.rb 148 in</code>requested_specs'\n6   /usr/lib64/ruby/gems/1.9.3/gems/bundler-1.3.5/lib/bundler/environment.rb    18  in <code>requested_specs'\n7   /usr/lib64/ruby/gems/1.9.3/gems/bundler-1.3.5/lib/bundler/runtime.rb    13  in</code>setup'\n8   /usr/lib64/ruby/gems/1.9.3/gems/bundler-1.3.5/lib/bundler.rb    120 in <code>setup'\n9   /etc/httpd/modules/passenger/lib/phusion_passenger/utils.rb 326 in</code>prepare_app_process'\n10  /etc/httpd/modules/passenger/lib/phusion_passenger/rack/application_spawner.rb  156 in <code>block in initialize_server'\n11  /etc/httpd/modules/passenger/lib/phusion_passenger/utils.rb 563 in</code>report_app_init_status'\n12  /etc/httpd/modules/passenger/lib/phusion_passenger/rack/application_spawner.rb  154 in <code>initialize_server'\n13  /etc/httpd/modules/passenger/lib/phusion_passenger/abstract_server.rb   204 in</code>start_synchronously'\n14  /etc/httpd/modules/passenger/lib/phusion_passenger/abstract_server.rb   180 in <code>start'\n15  /etc/httpd/modules/passenger/lib/phusion_passenger/rack/application_spawner.rb  129 in</code>start'\n16  /etc/httpd/modules/passenger/lib/phusion_passenger/spawn_manager.rb 253 in <code>block (2 levels) in spawn_rack_application'\n17  /etc/httpd/modules/passenger/lib/phusion_passenger/abstract_server_collection.rb    132 in</code>lookup_or_add'\n18  /etc/httpd/modules/passenger/lib/phusion_passenger/spawn_manager.rb 246 in <code>block in spawn_rack_application'\n19  /etc/httpd/modules/passenger/lib/phusion_passenger/abstract_server_collection.rb    82  in</code>block in synchronize'\n20      prelude>    10:in <code>synchronize'\n21  /etc/httpd/modules/passenger/lib/phusion_passenger/abstract_server_collection.rb    79  in</code>synchronize'\n22  /etc/httpd/modules/passenger/lib/phusion_passenger/spawn_manager.rb 244 in <code>spawn_rack_application'\n23  /etc/httpd/modules/passenger/lib/phusion_passenger/spawn_manager.rb 137 in</code>spawn_application'\n24  /etc/httpd/modules/passenger/lib/phusion_passenger/spawn_manager.rb 275 in <code>handle_spawn_application'\n25  /etc/httpd/modules/passenger/lib/phusion_passenger/abstract_server.rb   357 in</code>server_main_loop'\n26  /etc/httpd/modules/passenger/lib/phusion_passenger/abstract_server.rb   206 in <code>start_synchronously'\n27  /etc/httpd/modules/passenger/helper-scripts/passenger-spawn-server  99  in</code>\n'</p>\n\n<p>For some reason Passenger is stuck on previous version of ruby which comes default in bluehost shared hosting. I tried 3-4 hours searching for a possible solution but couldn't find any.</p>\n\n<p>Really looking forward for someones help. Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "rails-activerecord"], "answers": [{"comments": [{"owner": {"reputation": 261, "user_id": 2317084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8ccca93bbd44aa56adb8f0d1f4b236f8?s=128&d=identicon&r=PG", "display_name": "user2317084", "link": "https://stackoverflow.com/users/2317084/user2317084"}, "edited": false, "score": 0, "creation_date": 1479408050, "post_id": 40644226, "comment_id": 68556243, "body": "This works! The best way I&#39;ve seen to do this so far. Thank you :)"}], "tags": [], "owner": {"reputation": 428, "user_id": 1352507, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bpekt.png?s=128&g=1", "display_name": "Jen", "link": "https://stackoverflow.com/users/1352507/jen"}, "is_accepted": true, "score": 1, "last_activity_date": 1479341641, "last_edit_date": 1479341641, "creation_date": 1479339194, "answer_id": 40644226, "question_id": 40643928, "link": "https://stackoverflow.com/questions/40643928/force-full-object-load-with-eager-loading-and-nested-objects/40644226#40644226", "title": "Force full object load with eager loading and nested objects", "body": "<p>This is going to be difficult to do in only one query. The most straightforward I could get using just ActiveRecord methods was this:</p>\n\n<pre><code>Order.includes(:transactions, line_items: [:product])\n     .where(id: LineItem.where(product: product).pluck(:order_id))\n</code></pre>\n\n<p>I don't know much about Arel, but I think it might be able to accomplish this in one query rather than two.</p>\n"}], "owner": {"reputation": 261, "user_id": 2317084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8ccca93bbd44aa56adb8f0d1f4b236f8?s=128&d=identicon&r=PG", "display_name": "user2317084", "link": "https://stackoverflow.com/users/2317084/user2317084"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 0, "accepted_answer_id": 40644226, "answer_count": 1, "score": 1, "last_activity_date": 1479341641, "creation_date": 1479337561, "question_id": 40643928, "link": "https://stackoverflow.com/questions/40643928/force-full-object-load-with-eager-loading-and-nested-objects", "title": "Force full object load with eager loading and nested objects", "body": "<p>My object model goes a little something like this:</p>\n\n<pre><code>Order\n    has_many line items\n    has_many transactions\n    has_many products through line items\nLine Items\n    has_one product\n</code></pre>\n\n<p>So, to get all of the orders for a product I've been going: </p>\n\n<pre><code>product = Product.find(1)\nOrder.includes(:transactions, line_items: [:product]).where(line_items: {product: product})\n</code></pre>\n\n<p>The issue here is that if an order has 5 line items, I want all 5 line items loaded when I'm looking at the order object. However, using the code above I'm only getting the line item with the specified product. Is there a way to fully load the order object, without going .reload individually on each item? Just want to eager load the whole object.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "database", "forms"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1479337420, "post_id": 40643857, "comment_id": 68519905, "body": "Why are you allowing blank? Normally that&#39;s disabled to avoid this very problem."}, {"owner": {"reputation": 326, "user_id": 4954795, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9d5a6a4729a786805054a118296d8bc5?s=128&d=identicon&r=PG&f=1", "display_name": "teresa", "link": "https://stackoverflow.com/users/4954795/teresa"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1479338334, "post_id": 40643857, "comment_id": 68520194, "body": "@tadman, sorry I guess that was one way I thought to add the optional form fields but still have validation if something was entered in the form fields. I didn&#39;t know if I could use something else to allow the field to be optional.. is it better to pass in a if statement to the <code>validates :meetup_urlname</code> ?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1479338731, "post_id": 40643857, "comment_id": 68520334, "body": "You can always push that <code>if</code> logic inside the validator itself if you want. The <code>if</code> clause is usually a better fit for those that don&#39;t have an associated method like <code>validates ..., presence: true, if: ...</code>"}], "answers": [{"comments": [{"owner": {"reputation": 326, "user_id": 4954795, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9d5a6a4729a786805054a118296d8bc5?s=128&d=identicon&r=PG&f=1", "display_name": "teresa", "link": "https://stackoverflow.com/users/4954795/teresa"}, "edited": false, "score": 0, "creation_date": 1479490591, "post_id": 40643999, "comment_id": 68596257, "body": "This gem seem to work for me, but it also does other things which I can&#39;t be sure if it&#39;ll break my app in other places. Is there another way to write in the optional form field which only validates when a condition is met? Thanks."}], "tags": [], "owner": {"reputation": 48635, "user_id": 6742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xPawo.png?s=128&g=1", "display_name": "David Aldridge", "link": "https://stackoverflow.com/users/6742/david-aldridge"}, "is_accepted": false, "score": 0, "last_activity_date": 1479338002, "creation_date": 1479338002, "answer_id": 40643999, "question_id": 40643857, "link": "https://stackoverflow.com/questions/40643857/rails-form-fields-saving-to-database-defaults-to-empty-instead-of-nil/40643999#40643999", "title": "Rails: form fields saving to database defaults to empty instead of nil", "body": "<p>The strip_attributes gem can take care of this for you.</p>\n\n<p><a href=\"https://github.com/rmm5t/strip_attributes\" rel=\"nofollow noreferrer\">https://github.com/rmm5t/strip_attributes</a></p>\n"}, {"comments": [{"owner": {"reputation": 326, "user_id": 4954795, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9d5a6a4729a786805054a118296d8bc5?s=128&d=identicon&r=PG&f=1", "display_name": "teresa", "link": "https://stackoverflow.com/users/4954795/teresa"}, "edited": false, "score": 0, "creation_date": 1479343329, "post_id": 40644116, "comment_id": 68521653, "body": "That&#39;s interesting.. I think this could be the reason why it saves as empty. I have posted my <code>_form.html.erb</code> from view but I don&#39;t see a problem with it. Have not called <code>to_s</code> on <code>meetup_urlname</code> or <code>meetup_apikey</code> anywhere."}], "tags": [], "owner": {"reputation": 881, "user_id": 3010879, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/100000951369051/picture?type=large", "display_name": "medik", "link": "https://stackoverflow.com/users/3010879/medik"}, "is_accepted": false, "score": 0, "last_activity_date": 1479338624, "creation_date": 1479338624, "answer_id": 40644116, "question_id": 40643857, "link": "https://stackoverflow.com/questions/40643857/rails-form-fields-saving-to-database-defaults-to-empty-instead-of-nil/40644116#40644116", "title": "Rails: form fields saving to database defaults to empty instead of nil", "body": "<p>Could you post more context, please?</p>\n\n<p>With what we've got here, my ideas are:</p>\n\n<ol>\n<li><code>\"\"</code> comes from somewhere in the view (please paste it)</li>\n<li>Perhaps you're calling somewhere <code>to_s</code> on the <code>:meetup_urlname</code>? <code>nil.to_s</code> will return <code>\"\"</code> in ruby.</li>\n</ol>\n"}], "owner": {"reputation": 326, "user_id": 4954795, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9d5a6a4729a786805054a118296d8bc5?s=128&d=identicon&r=PG&f=1", "display_name": "teresa", "link": "https://stackoverflow.com/users/4954795/teresa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 227, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1479342891, "creation_date": 1479337161, "last_edit_date": 1495540417, "question_id": 40643857, "link": "https://stackoverflow.com/questions/40643857/rails-form-fields-saving-to-database-defaults-to-empty-instead-of-nil", "title": "Rails: form fields saving to database defaults to empty instead of nil", "body": "<p>From my understanding, empty form fields saving to database usually defaults to nil (which is what I wanted). But two of my optional form fields are saving as empty (\"\") instead of nil. </p>\n\n<p>I'm not sure why this is, I've looked at: <a href=\"https://stackoverflow.com/questions/14488465/understanding-rails-validation-what-does-allow-blank-do\">Understanding Rails validation: what does allow_blank do?</a> and <a href=\"https://stackoverflow.com/questions/4296548/save-blank-value-as-nil-in-database\">Save blank value as nil in database</a> thinking it may be because I am using <code>allow_blank: true</code>. </p>\n\n<p>My group.rb </p>\n\n<pre><code># meetup_urlname must be unique\nvalidates :meetup_urlname, uniqueness: { case_sensitive: false, message: \"this is already being used by a different group\" }, allow_blank: true\n\n\n# only validate if meetup_apikey or if meetup_urlname is non-empty\nvalidate :url_name_valid?, :if =&gt; :meetup_urlname?\nvalidate :api_key_valid?, :if =&gt; :meetup_apikey?\n</code></pre>\n\n<p>_Form.html.erb: </p>\n\n<pre><code>&lt;%= bootstrap_form_for(@group, :html =&gt; { :multipart =&gt; true }, layout: :horizontal, label_col: \"col-sm-3\", control_col: \"col-sm-9\") do |f| %&gt;\n... \n  &lt;h5&gt;Import Events from Meetup&lt;/h5&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.text_field :meetup_urlname, label: \"Meetup Group's URL\", type: \"text\", placeholder: \"Enter your Meetup group's url to retrieve your events\", prepend: 'http://www.meetup.com/'  %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.text_field :meetup_apikey, label: 'Meetup API Key', placeholder: 'Enter your Meetup API key  (Required for advanced meetup functionality)' %&gt;\n  &lt;/div&gt;\n\n&lt;%= f.hidden_field :status %&gt;\n&lt;%= f.hidden_field :audit_status %&gt;\n&lt;%= f.hidden_field :sref %&gt;\n\n&lt;div class=\"col-sm-10\" style=\"padding-right: 26px;\"&gt;\n  &lt;div class=\"actions pull-right\"&gt;\n    &lt;%= f.submit 'Update Group', class: \"action-btn btn-rounded btn-large\" %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n\n\n<p>Is there a way to have the optional form fields save as nil instead of empty by default? Currently have a hack in where if the form field returned empty..it would overwrite as nil. </p>\n\n<p>Any feedback or insight would help. Thanks! </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "search", "rubygems", "ransack"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5860183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbee30c8302739ca1048eaf247d29790?s=128&d=identicon&r=PG&f=1", "display_name": "bri", "link": "https://stackoverflow.com/users/5860183/bri"}, "is_accepted": false, "score": 0, "last_activity_date": 1479339445, "creation_date": 1479339445, "answer_id": 40644268, "question_id": 40643694, "link": "https://stackoverflow.com/questions/40643694/ransack-ruby-on-rails-result-wont-render/40644268#40644268", "title": "Ransack Ruby On Rails Result Wont Render", "body": "<p>Is the problem when you try to access @profile or just is it with knowing how to display results? If the latter, right now they are being stored in @profile so you need to loop through them and choose what you want to show from each profile instance.</p>\n\n<p>From when I've used this gem it seems it defaults to the index page of the given class (so in your case, the profile index page). So you can either:</p>\n\n<ol>\n<li>Just let the results list below the search form you shared above.</li>\n<li>Move the search bar to something like a homepages controller so when a search is made it'll go to the profile index page and only show the results.</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 157, "user_id": 7170034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d5b8aaf7d8c26e1623e9e74892bbf89?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Gruber", "link": "https://stackoverflow.com/users/7170034/jack-gruber"}, "edited": false, "score": 0, "creation_date": 1479420942, "post_id": 40649981, "comment_id": 68563274, "body": "Thanks Gurmukh, this did the trick. I made some slight modifications to what you gave me. But it was pretty much spot on. Much appreciated."}], "tags": [], "owner": {"reputation": 1225, "user_id": 5724342, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d0fc4bbc261a7a2a233a196a0b655fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Gurmukh Singh", "link": "https://stackoverflow.com/users/5724342/gurmukh-singh"}, "is_accepted": true, "score": 1, "last_activity_date": 1479371487, "creation_date": 1479371487, "answer_id": 40649981, "question_id": 40643694, "link": "https://stackoverflow.com/questions/40643694/ransack-ruby-on-rails-result-wont-render/40649981#40649981", "title": "Ransack Ruby On Rails Result Wont Render", "body": "<p>Try a set up like this in your controller and view:</p>\n\n<pre><code> #profile controller\n  def index\n    @search = Profile.search(params[:q])\n    @profiles = @search.result(distinct: true)\n  end\n\n  #profile index\n  &lt;%= search_form_for @search do |f| %&gt;\n    &lt;%= f.label :first_name_cont, \"name in profile\" %&gt;&lt;br&gt;\n    &lt;%= f.submit \"Search\", class:\"btn btn-info btn-block\" %&gt;\n  &lt;% end %&gt;\n\n  &lt;% @profiles.each do |profile| %&gt;\n    &lt;%= profile.name %&gt;\n  &lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 7170034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d5b8aaf7d8c26e1623e9e74892bbf89?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Gruber", "link": "https://stackoverflow.com/users/7170034/jack-gruber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 40649981, "answer_count": 2, "score": 0, "last_activity_date": 1479371487, "creation_date": 1479336291, "question_id": 40643694, "link": "https://stackoverflow.com/questions/40643694/ransack-ruby-on-rails-result-wont-render", "title": "Ransack Ruby On Rails Result Wont Render", "body": "<p>I have been trying to implement the Ransack search gem into a project I am currently working on. I am pretty sure that I have it set up correctly. I want to be able to search profiles and have placed my code in the profiles controller like so:</p>\n\n<pre><code>def index\n @q = Profile.search(params[:q])\n @profile = @q.result(distinct: true)\n @profiles = Profile.all\nend\n</code></pre>\n\n<p>And the profile index.html.erb file like so:</p>\n\n<pre><code>&lt;%= search_form_for @q do |f| %&gt;\n &lt;div class=\"field\"&gt;\n &lt;%= f.label :first_name_cont, \"Name Contains\" %&gt;\n &lt;%= f.search_field :first_name_cont %&gt;\n&lt;/div&gt;\n&lt;div class=\"actions\"&gt;&lt;%= f.submit \"Search\" %&gt;&lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>It does at the least appear to be attempting to search database correctly but just wont render any results on screen. It might be something obvious I am just not seeing. Any help is greatly appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1479339433, "post_id": 40643521, "comment_id": 68520561, "body": "Hi and welcome to stack overflow. Thanks for putting up all the relevant code, it really helps. I&#39;m still a bit unsure of what&#39;s actually going wrong though - can you give an example of what you mean by &quot;the wrong one&quot;? can you show us some example data, and what you&#39;d expect to see, but what you&#39;re seeing instead?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6528504"}, "reply_to_user": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1479340480, "post_id": 40643521, "comment_id": 68520833, "body": "thank you for interest @TarynEast, i edited my question. i mean the size.id that show on the order page did not match the size.id that i choose on the product page"}, {"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1479340574, "post_id": 40643521, "comment_id": 68520866, "body": "Hi great - but that&#39;s not enough for us to go on. Can you give us some sample data - ie what&#39;s inside of product with the id of 2 and what&#39;s there for product with id 4? How do you choose them what code do you use to choose them? what is the size that you&#39;re getting (show us) and what size do you expect (show us, don&#39;t tell). Also: you mention &quot;the order page&quot; - but haven&#39;t shown us that :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6528504"}, "reply_to_user": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1479341260, "post_id": 40643521, "comment_id": 68521092, "body": "right i&#39;ll post a screen!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6528504"}, "reply_to_user": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1479341614, "post_id": 40643521, "comment_id": 68521209, "body": "right, on the screen if i choose M on the order show GG"}, {"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1479347789, "post_id": 40643521, "comment_id": 68522863, "body": "Rather than a screen-grab... can you please show us the actual code you use to generate that drop-down? It&#39;s hard to debug a screen-grab :) Also - we really do need to see an example of the actual data. It would also be most useful would be to see what params are coming through-  you can look in your console-window or logfile (<code>log&#47;development.log</code>) to find the line that shows the Params that are passed when you click &quot;submit&quot; - this is the kind of thing that will actually help us figure out where the bug is."}, {"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1479347816, "post_id": 40643521, "comment_id": 68522869, "body": "Once we know what data is passed to your controller - then we can look at what the controller is doing with that data to make the incorrect choice... and then we can suggest what you need to change in your form to be passing the right data."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6528504"}, "reply_to_user": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1479349010, "post_id": 40643521, "comment_id": 68523189, "body": "right! thank you @TarynEast! i edited the question"}, {"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1479353721, "post_id": 40643521, "comment_id": 68524241, "body": "ok so my first idea is: <code>yy</code> is not really an id... certainly not a standard Rails id (which is usually an integer) or a <code>guid</code> - so what is <code>yy</code> supposed to be? Perhaps you have non-standard ids for finding the correct product - and it&#39;s not actually finding the correct product (which would then find this other product&#39;s sizes). Can you give mt the example of data I suggested? eg in your controller, add the line <code>puts &quot;product: #{product.inspect}</code> after you first instantiate the product. also add <code>puts &quot;size: #{product.sizes.inspect}</code> - then hit submit show us what appears in the terminal"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6528504"}, "reply_to_user": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1479355067, "post_id": 40643521, "comment_id": 68524518, "body": "hello @TarynEast. the yy id issue is because of the friendly_id gem. to show the name of the product on the browser. ok i&#39;ll check!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6528504"}, "reply_to_user": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1479355816, "post_id": 40643521, "comment_id": 68524700, "body": "there is:   product: #&lt;Product id: 2, slug: &quot;yy&quot;, name: &quot;yy&quot;, detail: &quot;dedede&quot;, size_id: nil,  quantity: 33, created_at: &quot;2016-11-16 06:16:56&quot;, updated_at: &quot;2016-11-17 04:05:09&quot;&gt; size: [#&lt;Size id: 3, size: &quot;GG&quot;, created_at: &quot;2016-08-16 02:38:12&quot;, updated_at: &quot;2016-08-16 02:38:12&quot;&gt;, #&lt;Size id: 2, size: &quot;M&quot;, created_at: &quot;2016-08-16 02:38:12&quot;, updated_at: &quot;2016-08-16 02:38:12&quot;&gt;, #&lt;Size id: 1, size: &quot;P&quot;, created_at: &quot;2016-08-16 02:38:12&quot;, updated_at: &quot;2016-08-16 02:38:12&quot;&gt;]"}, {"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1479442935, "post_id": 40643521, "comment_id": 68569163, "body": "ok, so according to the params that come through (with a size_id of &#39;1&#39;) you should end up with the <code>&lt;Size id: 1, size: &quot;P&quot;, created_at: &quot;2016-08-16 02:38:12&quot;, updated_at: &quot;2016-08-16 02:38:12&quot;&gt;</code> being picked out by the line <code>size =  product.sizes.find_by_id(params[:size_id])</code>. <i>however</i> I notice you aren&#39;t <i>using</i> <code>size</code> anywhere, you just throw it away. Then use this: <code>product.sizes.find { |l| l.id }</code> and when setting up a new order you have: <code>order.size = product.sizes.find { |k| k.id }</code> so... which is the correct way to select a size? Maybe just use <code>size</code> instead?"}], "owner": {"user_type": "does_not_exist", "display_name": "user6528504"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1479349065, "creation_date": 1479335392, "last_edit_date": 1479349065, "question_id": 40643521, "link": "https://stackoverflow.com/questions/40643521/rails-select-has-many-though-get-the-right-id", "title": "Rails select has_many though get the right Id", "body": "<p><a href=\"https://i.stack.imgur.com/ex6OZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ex6OZ.png\" alt=\"enter image description here\"></a><a href=\"https://i.stack.imgur.com/qXJZf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qXJZf.png\" alt=\"enter image description here\"></a>I'm trying to pass the size of a product to a order with select. the product has many sizes with has_many though.\nthe size.id on the orger page did not match with the size.id that i choose on the product page.\nsomeone know why?</p>\n\n<blockquote>\n  <p>for exemple if choose product size.id(2) on the order page show size.id(4)</p>\n</blockquote>\n\n<p><strong>Size Model</strong></p>\n\n<pre><code> attr_accessible :size\n  has_many :orders \n  has_many :sizeship\n  has_many :products, :through =&gt; :sizeship\n</code></pre>\n\n<p><strong>Product Model</strong></p>\n\n<pre><code> has_many :orders\n  has_many :sizeships\n  has_many :sizes, through: :sizeships\n</code></pre>\n\n<p><strong>Order Model</strong></p>\n\n<pre><code>  belongs_to :cart\n  belongs_to :product, touch: true\n  belongs_to :size\n</code></pre>\n\n<p><strong>Cart Model</strong></p>\n\n<pre><code>  belongs_to :user\n  has_many :orders\n</code></pre>\n\n<p><strong>Product Controller</strong></p>\n\n<pre><code>def show\n   @product = Product.cached_find(params[:id])\n\n  @sizes_for_dropdown = @product.sizes.collect { |s| [s.size, s.id] }\n\nend\n</code></pre>\n\n<p><strong>Cart Controller</strong></p>\n\n<pre><code> def add\n    product = Product.find(params[:id])\n\n    if product\n     if product.buyable?(current_user)\n        current_user.cart = Cart.new #if current_user.cart.nil?\n        size =  product.sizes.find_by_id(params[:size_id])\n        quantity = params[:quantity].to_i &gt; 0 ? params[:quantity].to_i : 1\n       order = current_user.cart.orders.find_by_product_id_and_status_and_size_id(product.id, nil, product.sizes.nil? ? nil : product.sizes.find { |l| l.id } )\n\n        if order.nil? # create new order\n          order = Order.new\n          order.product = product\n          order.size = product.sizes.find { |k| k.id } \n\n          current_user.cart.orders &lt;&lt; order\n        else # increase quantity\n          order.quantity += quantity\n          order.save\n        end\n\n        redirect_to product_path(product)\n        flash[:success] = \"Success\"\n      else\n        redirect_to product_path(product)\n        flash[:error] = \" Error\"\n\n      end\n    else\n      redirect_to :shop, flash[:error] = 'Error'\n    end\n  end\n</code></pre>\n\n<p><strong>Log</strong></p>\n\n<pre><code>Started POST \"/carts/add/yy\" for 127.0.0.1 at 2016-11-17 00:11:16 -0200\nProcessing by CartsController#add as HTML\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"Hf7eLJPojw+u/HCGuQtAVzADC7v0jpkw5mJ0sCmx0u4=\", \"score\"=&gt;\"\", \"quantity\"=&gt;\"1\",  \"size_id\"=&gt;\"1\", \"commit\"=&gt;\"add to basket\", \"id\"=&gt;\"yy\"}\nRedirected to http://localhost:3000/products/yy\nCompleted 302 Found in 3471.4ms \n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 1202, "user_id": 6734301, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/68f0e11c94e94983ca8404f1e6a2171c?s=128&d=identicon&r=PG&f=1", "display_name": "Wazza", "link": "https://stackoverflow.com/users/6734301/wazza"}, "is_accepted": false, "score": 0, "last_activity_date": 1479347310, "creation_date": 1479347310, "answer_id": 40645421, "question_id": 40643348, "link": "https://stackoverflow.com/questions/40643348/rmagick-isnt-montaging-images-using-write-or-montage-functions/40645421#40645421", "title": "Rmagick isn&#39;t montaging images using &#39;write&#39; or &#39;montage&#39; functions", "body": "<p>I was a fool as always: this works well</p>\n\n<pre><code>  def create_image_list\n    @image_list = Magick::ImageList.new( @urls[0], @urls[1])\n    create_image_montage\n  end\n\n  def create_image_montage\n    @image_list.append(false).write(\"assets/images/montage#{@counter}.jpeg\")\n    @counter += 1\n    # add_watermark\n  end\n</code></pre>\n"}], "owner": {"reputation": 1202, "user_id": 6734301, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/68f0e11c94e94983ca8404f1e6a2171c?s=128&d=identicon&r=PG&f=1", "display_name": "Wazza", "link": "https://stackoverflow.com/users/6734301/wazza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479347310, "creation_date": 1479334566, "last_edit_date": 1479335131, "question_id": 40643348, "link": "https://stackoverflow.com/questions/40643348/rmagick-isnt-montaging-images-using-write-or-montage-functions", "title": "Rmagick isn&#39;t montaging images using &#39;write&#39; or &#39;montage&#39; functions", "body": "<p>I am trying to combine two images side by side into one using rmagicks montage and/ or write but it always just produces 4 images and i cant figure out why after quite a lot of googling.</p>\n\n<pre><code>require 'rmagick'\n\nclass CSV_Reader\n\n  attr_reader :file\n\n  def initialize(rows)\n    @rows = rows\n    @row_number = 0\n    extract_images\n  end\n\n  def extract_images\n    @rows.each do |row|\n      imageURLs = []\n      row.each do |image|\n         imageURLs.push(image[1])\n       end\n       create_image_list imageURLs\n    end\n  end\n\n  def create_image_list urls\n    image_list = Magick::ImageList.new( urls[0], urls[1])\n    create_image_montage image_list\n  end\n\n  def create_image_montage image_list\n    columns = 2\n    rows = 1\n    marginsBetween = 20\n    background = '#000000'\n    image_list.montage {\n      self.geometry = '+' + (marginsBetween/2).to_s + '+' + (marginsBetween/2).to_s\n      self.tile = columns.to_s + 'x' + rows.to_s\n      self.background_color = background\n    }\n    # image_list.write(\"bin/images/montage #{@row_number}.jpg\")\n    @row_number += 1\n  end\nend\n</code></pre>\n\n<p>Also once it goes through this process and writes the images separately it doesn't stop loading when viewing on local how or terminal. Any help would be great. Thanks</p>\n"}, {"tags": ["ruby", "rspec", "jvm", "jruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1479337292, "post_id": 40642617, "comment_id": 68519860, "body": "Does an empty Rails or Ruby project take that long to spin up?"}, {"owner": {"reputation": 51, "user_id": 2242469, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/lWv0c.png?s=128&g=1", "display_name": "bananabr", "link": "https://stackoverflow.com/users/2242469/bananabr"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1479382325, "post_id": 40642617, "comment_id": 68538689, "body": "@tadman thank for your interest. Actually I was using a virtual machine with 1GB of ram for development. After giving it an extra 1GB rspec is running just fine."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1479427641, "post_id": 40653819, "comment_id": 68565621, "body": "Java itself often uses ~300MB depending on the version and platform. 1GB is pretty tight for JRuby."}], "tags": [], "owner": {"reputation": 51, "user_id": 2242469, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/lWv0c.png?s=128&g=1", "display_name": "bananabr", "link": "https://stackoverflow.com/users/2242469/bananabr"}, "is_accepted": false, "score": 1, "last_activity_date": 1479382348, "creation_date": 1479382348, "answer_id": 40653819, "question_id": 40642617, "link": "https://stackoverflow.com/questions/40642617/why-jruby-jvm-takes-forever-to-load-when-using-jruby-9-1-1-0-and-rspec/40653819#40653819", "title": "Why jruby JVM takes forever to load when using jruby-9.1.1.0 and rspec?", "body": "<p>I was using a virtual machine with 1GB of ram for development. After giving it an extra 1GB rspec is running just fine.</p>\n"}], "owner": {"reputation": 51, "user_id": 2242469, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/lWv0c.png?s=128&g=1", "display_name": "bananabr", "link": "https://stackoverflow.com/users/2242469/bananabr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479382348, "creation_date": 1479331506, "question_id": 40642617, "link": "https://stackoverflow.com/questions/40642617/why-jruby-jvm-takes-forever-to-load-when-using-jruby-9-1-1-0-and-rspec", "title": "Why jruby JVM takes forever to load when using jruby-9.1.1.0 and rspec?", "body": "<p>I am doing some modifications in the logstash-translate plugin and writing some tests in the process. I am not used to use java virtual machine to program in ruby, but I think it is not reasonable that it takes minutes to load the necessary files to run less than 20 tests.\nI am already using the --dev flag in JRUBY_OPTS, what else can I do?</p>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 1291, "user_id": 4165455, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rCYgo.jpg?s=128&g=1", "display_name": "Muyiwa Olu", "link": "https://stackoverflow.com/users/4165455/muyiwa-olu"}, "edited": false, "score": 0, "creation_date": 1479330590, "post_id": 40642312, "comment_id": 68516790, "body": "Excellent explanation, thank you. I see now, it makes more sense to initialise different data for each context closer to the scope. Just to make sure I understand, does this mean that <code>configs_sensible_defaults</code> should still be shared, since that isn&#39;t reassigned in both contexts?"}, {"owner": {"reputation": 15486, "user_id": 719547, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/51e61f099c7b1ac0588ecda69193f75c?s=128&d=identicon&r=PG", "display_name": "Jim Stewart", "link": "https://stackoverflow.com/users/719547/jim-stewart"}, "reply_to_user": {"reputation": 1291, "user_id": 4165455, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rCYgo.jpg?s=128&g=1", "display_name": "Muyiwa Olu", "link": "https://stackoverflow.com/users/4165455/muyiwa-olu"}, "edited": false, "score": 0, "creation_date": 1479330686, "post_id": 40642312, "comment_id": 68516851, "body": "Yes, I added to my answer; you can move your <code>before</code> blocks closer to the scope they apply to."}, {"owner": {"reputation": 15486, "user_id": 719547, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/51e61f099c7b1ac0588ecda69193f75c?s=128&d=identicon&r=PG", "display_name": "Jim Stewart", "link": "https://stackoverflow.com/users/719547/jim-stewart"}, "reply_to_user": {"reputation": 1291, "user_id": 4165455, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rCYgo.jpg?s=128&g=1", "display_name": "Muyiwa Olu", "link": "https://stackoverflow.com/users/4165455/muyiwa-olu"}, "edited": false, "score": 0, "creation_date": 1479331601, "post_id": 40642312, "comment_id": 68517296, "body": "You should also check out RSpec&#39;s <a href=\"https://www.relishapp.com/rspec/rspec-core/v/3-5/docs/helper-methods/let-and-let\" rel=\"nofollow noreferrer\">let</a> helper; it can be useful in situations like this where you want to initialize data before each test runs, in lieu of using a <code>before</code> block. I prefer <code>let</code> for simple initializations and <code>before</code> for more complex setup."}], "tags": [], "owner": {"reputation": 15486, "user_id": 719547, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/51e61f099c7b1ac0588ecda69193f75c?s=128&d=identicon&r=PG", "display_name": "Jim Stewart", "link": "https://stackoverflow.com/users/719547/jim-stewart"}, "is_accepted": true, "score": 2, "last_activity_date": 1479331460, "last_edit_date": 1479331460, "creation_date": 1479330372, "answer_id": 40642312, "question_id": 40642082, "link": "https://stackoverflow.com/questions/40642082/rspec-failing-under-unknown-seemingly-specific-circumstances/40642312#40642312", "title": "RSpec failing under unknown (seemingly specific) circumstances", "body": "<p>The reason it was working sometimes and not other times is because one of your tests (in the second context) reassigned <code>file_generator</code>. The test in the first context was using the <code>file_generator</code> from the shared outer scope. So long as that test ran first, it worked as expected. Then the second test in the second scope ran, reassigned <code>file_generator</code>, and also passed.</p>\n\n<p>Since the tests ran in random order, whenever they ran in the order they are in the file, everything was passing. When the second test ran first, it overwrote <code>file_generator</code>, the second test still passed, but the first test ran with the overwritten value.</p>\n\n<p>You can use a <code>before</code> block to configure things for each test, as you did, but you should only configure <strong>common, shared values</strong> in a before block. Anything that's going to be different for each context or each test should be initialized closer to the scope in which it is used.</p>\n\n<p>In your examples above, I wouldn't use any <code>before</code> block, at least not in the outer scope. Both <code>@config_sensible_defaults</code> and <code>@file_generator</code> are different in each context, and should not be shared at all. If you want to group a bunch of tests together in a context with the same defaults and generator, you can put a <code>before</code> block <em>inside</em> the <code>context</code> block, to initialize things correctly for each context.</p>\n"}], "owner": {"reputation": 1291, "user_id": 4165455, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rCYgo.jpg?s=128&g=1", "display_name": "Muyiwa Olu", "link": "https://stackoverflow.com/users/4165455/muyiwa-olu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 40642312, "answer_count": 1, "score": 0, "last_activity_date": 1479331460, "creation_date": 1479329548, "last_edit_date": 1479329867, "question_id": 40642082, "link": "https://stackoverflow.com/questions/40642082/rspec-failing-under-unknown-seemingly-specific-circumstances", "title": "RSpec failing under unknown (seemingly specific) circumstances", "body": "<p>I'm relatively new to ruby, moving into it from languages like Python, and C# so please forgive me if this is an obvious bug I'm missing.</p>\n\n<h2>The Issue</h2>\n\n<p>I was writing code for a tool to help myself and other developers generate .editorconfig files as a way to learn Ruby. I use rspec as my testing framework and wrote the following tests:</p>\n\n<pre><code>module EditorConfigGenerator\n\n  RSpec.describe EditorConfigGenerator::FileGenerator do\n    configs_sensible_defaults = [EditorConfigGenerator::EditorConfig.new({root: true, indent_style: 'space', indent_size: 2,\n      end_of_line: 'lf', charset: 'utf-8',\n    trim_trailing_whitespace: true, insert_final_newline: true})]\n    file_generator = EditorConfigGenerator::FileGenerator.new(configs_sensible_defaults)\n\n    context \"A collection of one EditorConfig object is provided\" do\n      it \"displays a preview of the file output\" do\n        # Newlines are automatically inserted into ruby multi-line strings\n        output = \"root = true\n                [*]\n                indent_style = space\n                indent_size = 2\n                end_of_line = lf\n                charset = utf-8\n                trim_trailing_whitespace = true\n                insert_final_newline = true\n      \"\n        # String.delete(' ')  to remove any potential formatting discrepancies\n        # which don't affect the test of the content.\n        expect(file_generator.preview_output.delete(' ')).to eq output.delete(' ')\n      end\n\n      it \"creates a .editorconfig file in the correct location\" do\n        dot_editorconfig = file_generator.generate_config_file('test_output/.editorconfig')\n        expect(dot_editorconfig.class).to eq File\n        expect(File.exist? \"test_output/.editorconfig\").to eq true\n      end\n    end\n    context \"A collection of multiple EditorConfig objects is provided\" do\n      it \"displays a preview of the file output\" do\n        configs = configs_sensible_defaults.push(EditorConfigGenerator::EditorConfig.new({file_type: '*.{js,py}', indent_size: 4}))\n        file_generator = EditorConfigGenerator::FileGenerator.new(configs)\n        output = \"root = true\n                [*]\n                indent_style = space\n                indent_size = 2\n                end_of_line = lf\n                charset = utf-8\n                trim_trailing_whitespace = true\n                insert_final_newline = true\n                [*.{js,py}]\n                indent_size = 4\"\n\n        expect(file_generator.preview_output.delete(' ')).to eq output.delete(' ')\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>When I ran these tests the first few times, they worked seemingly fine. I then enabled the following recommended lines in my <code>spec_helper.rb</code> file</p>\n\n<pre><code>  config.profile_examples = 10\n  config.order = :random\n  kernel.srand config.seed\n</code></pre>\n\n<p>I ran the tests a few more times, all of them passing until - seemingly randomly - I obtained the following failure output with seed <code>31166</code>:</p>\n\n<pre><code>  1) EditorConfigGenerator::FileGenerator A collection of one EditorConfig object is provided displays a preview of the file output\n     Failure/Error: expect(file_generator.preview_output.delete(' ')).to eq output.delete(' ')\n\n       expected: \"root=true\\n[*]\\nindent_style=space\\nindent_size=2\\nend_of_line=lf\\ncharset=utf-8\\ntrim_trailing_whitespace=true\\ninsert_final_newline=true\\n\"\n            got: \"root=true\\n[*]\\nindent_style=space\\nindent_size=2\\nend_of_line=lf\\ncharset=utf-8\\ntrim_trailing_whitespace=true\\ninsert_final_newline=true\\n[*.{js,py}]\\nindent_size=4\"\n\n       (compared using ==)\n\n       Diff:\n       @@ -6,4 +6,6 @@\n        charset=utf-8\n        trim_trailing_whitespace=true\n        insert_final_newline=true\n       +[*.{js,py}]\n       +indent_size=4\n\n     # ./spec/file_generator_spec.rb:23:in `block (3 levels) in &lt;module:EditorConfigGenerator&gt;'\n</code></pre>\n\n<p>With other seeds I tried, it worked, but with seed <code>31166</code> it failed. </p>\n\n<h2>The Fix</h2>\n\n<p>The output made me feel like it was contextual, so therefore I tried to look for a bug in my implementation. I didn't find one, so I thought it may have been an issue with the way I defined the shared variable <code>configs_sensible_defaults</code> in the spec. </p>\n\n<p>I decided to change the code to use <code>before(:each)</code> to assign an instance variable before each test (i.e. resetting the data properly) and it seemed to fix it.</p>\n\n<p>Here's the fixed <code>spec/file_generator_spec.rb</code></p>\n\n<pre><code>module EditorConfigGenerator\n  RSpec.describe EditorConfigGenerator::FileGenerator do\n    before(:each) do\n      @configs_sensible_defaults =  [EditorConfigGenerator::EditorConfig.new({root: true, indent_style: 'space', indent_size: 2, end_of_line: 'lf', charset: 'utf-8', trim_trailing_whitespace: true, insert_final_newline: true})]\n      @file_generator = EditorConfigGenerator::FileGenerator.new(@configs_sensible_defaults)\n    end\n\n    context \"A collection of one EditorConfig object is provided\" do\n      it \"displays a preview of the file output\" do\n        # Newlines are automatically inserted into ruby multi-line strings\n        output = \"root = true\n                [*]\n                indent_style = space\n                indent_size = 2\n                end_of_line = lf\n                charset = utf-8\n                trim_trailing_whitespace = true\n                insert_final_newline = true\n      \"\n        # String.delete(' ')  to remove any potential formatting discrepancies\n        # which don't affect the test of the content.\n        expect(@file_generator.preview_output.delete(' ')).to eq output.delete(' ')\n      end\n\n      it \"creates a .editorconfig file in the correct location\" do\n        dot_editorconfig = @file_generator.generate_config_file('test_output/.editorconfig')\n        expect(dot_editorconfig.class).to eq File\n        expect(File.exist? \"test_output/.editorconfig\").to eq true\n      end\n    end\n    context \"A collection of multiple EditorConfig objects is provided\" do\n      it \"displays a preview of the file output\" do\n        configs = @configs_sensible_defaults.clone.push(EditorConfigGenerator::EditorConfig.new({file_type: '*.{js,py}', indent_size: 4}))\n        @file_generator = EditorConfigGenerator::FileGenerator.new(configs)\n        output = \"root = true\n                [*]\n                indent_style = space\n                indent_size = 2\n                end_of_line = lf\n                charset = utf-8\n                trim_trailing_whitespace = true\n                insert_final_newline = true\n                [*.{js,py}]\n                indent_size = 4\"\n\n        expect(@file_generator.preview_output.delete(' ')).to eq output.delete(' ')\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Here is a diff output of both files (<a href=\"https://github.com/muyiwaolu/editorconfig-generator/commit/8ab4c73a637769e79d400cfac7f33b0d473afeb4\" rel=\"nofollow noreferrer\">view on Github</a>):</p>\n\n<pre><code> RSpec.describe EditorConfigGenerator::FileGenerator do\n    configs_sensible_defaults = [EditorConfigGenerator::EditorConfig.new({root: true, indent_style: 'space', indent_size: 2,\n      end_of_line: 'lf', charset: 'utf-8',\n    trim_trailing_whitespace: true, insert_final_newline: true})]\n    file_generator = EditorConfigGenerator::FileGenerator.new(configs_sensible_defaults)\n    before(:each) do\n      @configs_sensible_defaults =  [EditorConfigGenerator::EditorConfig.new({root: true, indent_style: 'space', indent_size: 2, end_of_line: 'lf', charset: 'utf-8', trim_trailing_whitespace: true, insert_final_newline: true})]\n      @file_generator = EditorConfigGenerator::FileGenerator.new(@configs_sensible_defaults)\n    end\n\n    context \"A collection of one EditorConfig object is provided\" do\n      it \"displays a preview of the file output\" do\n@ file_generator_spec.rb:22 @ module EditorConfigGenerator\n      \"\n        # String.delete(' ')  to remove any potential formatting discrepancies\n        # which don't affect the test of the content.\n        expect(file_generator.preview_output.delete(' ')).to eq output.delete(' ')\n        expect(@file_generator.preview_output.delete(' ')).to eq output.delete(' ')\n      end\n\n      it \"creates a .editorconfig file in the correct location\" do\n        dot_editorconfig = file_generator.generate_config_file('test_output/.editorconfig')\n        dot_editorconfig = @file_generator.generate_config_file('test_output/.editorconfig')\n        expect(dot_editorconfig.class).to eq File\n        expect(File.exist? \"test_output/.editorconfig\").to eq true\n      end\n    end\n    context \"A collection of multiple EditorConfig objects is provided\" do\n</code></pre>\n\n<p>Finally, for context, here are the relevant <code>file_generator.rb</code> and <code>editor_config.rb</code> files</p>\n\n<pre><code>module EditorConfigGenerator\n  class FileGenerator\n    def initialize(configs)\n      @configs = configs\n    end\n\n    def preview_output\n      output = \"\"\n      @configs.each do |config|\n        if output.include? \"root=\"\n          output &lt;&lt; config.to_s_without_root\n          next\n        end\n        output &lt;&lt; config.to_s\n      end\n      return output.rstrip if @configs.size &gt; 1\n      output\n    end\n\n    def generate_config_file(location='.editorconfig')\n      File.delete(location) if File.exist? location\n      file = File.new(location, \"w\")\n      file.print(preview_output)\n      file.close\n      file\n    end\n  end\nend\n\nmodule EditorConfigGenerator\n  class EditorConfig\n    attr_reader :root, :indent_style, :indent_size,\n    :end_of_line, :charset, :trim_trailing_whitespace,\n    :insert_final_newline, :file_type\n\n    def initialize(options)\n      @root = nil\n      @file_type = :*\n\n      transform_options(options)\n      set_options(options)\n    end\n\n    def set_options(options)\n      @root = options[:root] unless options[:root].nil?\n      @indent_style = options[:indent_style] unless options[:indent_style].nil?\n      @indent_size = options[:indent_size] unless options[:indent_size].nil?\n      @end_of_line = options[:end_of_line] unless options[:end_of_line].nil?\n      @charset = options[:charset] unless options[:charset].nil?\n      @trim_trailing_whitespace = options[:trim_trailing_whitespace] unless options[:trim_trailing_whitespace].nil?\n      @insert_final_newline = options[:insert_final_newline] unless options[:insert_final_newline].nil?\n      @file_type = options[:file_type] unless options[:file_type].nil?\n    end\n\n    def transform_options(options)\n      options[:root] = true if options[:root] == 'y'\n      options[:root] = false if options[:root] == 'n'\n      options[:trim_trailing_whitespace] = true if options[:trim_trailing_whitespace] == 'y'\n      options[:trim_trailing_whitespace] = false if options[:trim_trailing_whitespace] == 'n'\n      options[:insert_final_newline] = true if options[:insert_final_newline] == 'y'\n      options[:insert_final_newline] = false if options[:insert_final_newline] == 'n'\n    end\n\n    def to_s\n      config_string = \"\"\n      config_string &lt;&lt; \"root = #{@root.to_s}\\n\" unless @root.nil?\n      config_string &lt;&lt; \"[#{@file_type}]\\n\"\n      config_string &lt;&lt; \"indent_style = #{@indent_style}\\n\" unless @indent_style.nil?\n      config_string &lt;&lt; \"indent_size = #{@indent_size}\\n\" unless @indent_size.nil?\n      config_string &lt;&lt; \"end_of_line = #{@end_of_line}\\n\" unless @end_of_line.nil?\n      config_string &lt;&lt; \"charset = #{@charset}\\n\" unless @charset.nil?\n      config_string &lt;&lt; \"trim_trailing_whitespace = #{@trim_trailing_whitespace.to_s}\\n\" unless @trim_trailing_whitespace.nil?\n      config_string &lt;&lt; \"insert_final_newline = #{@insert_final_newline.to_s}\\n\" unless @insert_final_newline.nil?\n      config_string\n    end\n\n    def to_s_without_root\n      lines = to_s.lines\n      lines.delete_at 0\n      lines.join\n    end\n\n    def to_s_without_line(line_identifier)\n      lines = to_s.lines\n      index = lines.index(line_identifier)\n      lines.delete_at index\n      lines.join\n    end\n  end\nend\n</code></pre>\n\n<h2>The Question</h2>\n\n<p>Could someone explain exactly why the change fixed the issue? <em>Did</em> the change fix the issue? </p>\n\n<p>I believe it's to do with the collection in <code>configs_sensible_defaults</code> being mutated and not being reset correctly after each run, which would explain why a certain seed would trigger a failure (as maybe under that seed test 2 would run before 1).</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "devise"], "comments": [{"owner": {"reputation": 696, "user_id": 3101782, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/a7f2da739317a5199362dd7b998ad967?s=128&d=identicon&r=PG", "display_name": "Disha", "link": "https://stackoverflow.com/users/3101782/disha"}, "edited": false, "score": 0, "creation_date": 1479329837, "post_id": 40642077, "comment_id": 68516403, "body": "Could you please share your sessions_controller and sessions/new.html.erb content? When you get this error, along with this error, you will see which line its coming from. Go to that line and see which object is not proper."}, {"owner": {"reputation": 65, "user_id": 5828685, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f78e30f5fa440ca92807a509c3d79d4c?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan", "link": "https://stackoverflow.com/users/5828685/bryan"}, "reply_to_user": {"reputation": 696, "user_id": 3101782, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/a7f2da739317a5199362dd7b998ad967?s=128&d=identicon&r=PG", "display_name": "Disha", "link": "https://stackoverflow.com/users/3101782/disha"}, "edited": false, "score": 0, "creation_date": 1479330058, "post_id": 40642077, "comment_id": 68516517, "body": "I don&#39;t have a sessions controller. I am not sure if devise gives me access to it. I can get the Sessions#new html partial.? and the error is on the line where I have @contents.each"}], "owner": {"reputation": 65, "user_id": 5828685, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f78e30f5fa440ca92807a509c3d79d4c?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan", "link": "https://stackoverflow.com/users/5828685/bryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479329534, "creation_date": 1479329534, "question_id": 40642077, "link": "https://stackoverflow.com/questions/40642077/nomethoderror-in-devise-when-calling-data", "title": "NoMethodError in Devise when calling Data", "body": "<p>I am using devise gem for users. I have a contents_controller.rb and I want to display content.name in my application.html.erb but there seems to be a conflict with Devise when I do this. When I load the page the data is rendered but when I click login, to access editing abilities, I get a <code>NoMethodError in Devise::Sessions#new undefined method `name' for nil:NilClass</code>. My code is listed below.</p>\n\n<p>Application.html.erb :</p>\n\n<pre><code>&lt;% @contents.each do |content| %&gt;\n &lt;a class=\"navbar-brand\" &gt;&lt;%= content.name %&gt;&lt;/a&gt;\n&lt;%end%&gt;\n</code></pre>\n\n<p>Contents_controller.rb :</p>\n\n<pre><code>class ContentsController &lt; ApplicationController\n  before_action :find_content, only: [:show, :edit, :update, :destroy]\n  before_action :authenticate_user!, except: [:index, :show]\n\n  def index\n    @contents = Content.all\n    @services = Service.all.order(\"created_at asc\")\n    @portfolios = Portfolio.all.order(\"created_at asc\")\n  end\n\n  def new\n    @content = Content.new\n  end\n\n  def create\n    @content = Content.new content_params\n\n    if @content.save\n      redirect_to root_path, notice: \"content Created!\"\n    else\n      render 'new', notice: \"Sorry content failed to create!!!\"\n    end\n  end\n\n  def edit\n  end\n\n  def update\n    if @content.update content_params\n      redirect_to root_path, notice: \"You Updated: #{@content.name}.\"\n    else\n      render 'edit'\n    end\n  end\n\n  def destroy\n    @content.destroy\n    redirect_to content_path\n  end\n\n  private\n\n  def content_params\n    params.require(:content).permit(:name, :header_title, :services_title, :slogan_title, :about_title, :about_description, :contact_title, :contact_subtitle, :fb_username, :ig_username, :twitter_username, :in_username, :pin_username)\n  end\n\n  def find_content\n    @content = Content.find(params[:id])\n  end\nend\n</code></pre>\n\n<p>Can someone please help me explain why this is happening and how to fix this issue?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "spree"], "comments": [{"owner": {"reputation": 15583, "user_id": 177489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/sv6zK.jpg?s=128&g=1", "display_name": "Mark Swardstrom", "link": "https://stackoverflow.com/users/177489/mark-swardstrom"}, "edited": false, "score": 0, "creation_date": 1479334152, "post_id": 40641993, "comment_id": 68518554, "body": "It appears like it&#39;s looking for a partial (with an undercore) and not in the layouts directory.  Look at that error more closely, you can see what directories it&#39;s looking for the file.  btw - I recommend all lower case file names - no camel case, use underscores between words - <code>_about_us.html.erb</code>"}, {"owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "reply_to_user": {"reputation": 15583, "user_id": 177489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/sv6zK.jpg?s=128&g=1", "display_name": "Mark Swardstrom", "link": "https://stackoverflow.com/users/177489/mark-swardstrom"}, "edited": false, "score": 0, "creation_date": 1479421096, "post_id": 40641993, "comment_id": 68563338, "body": "@Swards so to what folder should I add the _about_us.html.erb file?"}, {"owner": {"reputation": 15583, "user_id": 177489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/sv6zK.jpg?s=128&g=1", "display_name": "Mark Swardstrom", "link": "https://stackoverflow.com/users/177489/mark-swardstrom"}, "edited": false, "score": 0, "creation_date": 1479429784, "post_id": 40641993, "comment_id": 68566187, "body": "I think <code>&#47;views&#47;spree&#47;static_content</code> is the one you want."}], "answers": [{"tags": [], "owner": {"reputation": 356, "user_id": 4695576, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5FvEk1zdjyI/AAAAAAAAAAI/AAAAAAAAACU/dp-zGOAT2r8/photo.jpg?sz=128", "display_name": "Carlos J Garc&#237;a", "link": "https://stackoverflow.com/users/4695576/carlos-j-garc%c3%ada"}, "is_accepted": false, "score": 0, "last_activity_date": 1540220519, "creation_date": 1540220519, "answer_id": 52932388, "question_id": 40641993, "link": "https://stackoverflow.com/questions/40641993/spree-static-page-routing-issue-adding-about-page/52932388#52932388", "title": "Spree static page routing issue adding about page", "body": "<p>I know is late and you might have solved your problem a long time ago but for those who get here looking for an answer.</p>\n\n<p>The issue was using the <code>/layout</code> and not <code>/static_content</code>.</p>\n\n<p>If you are using a controller and inside the method aren't rendering with an specific route then you should use the predefined route to get to place the render file.</p>\n\n<p>Quick answer:\n place the <code>aboutUs.html.erb</code> file at <code>/static_content</code> not at <code>/layout</code> having the following file location:</p>\n\n<blockquote>\n  <p>{app_route}/static_content/aboutUs.html.erb</p>\n</blockquote>\n"}], "owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 307, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1540220519, "creation_date": 1479329203, "question_id": 40641993, "link": "https://stackoverflow.com/questions/40641993/spree-static-page-routing-issue-adding-about-page", "title": "Spree static page routing issue adding about page", "body": "<p>I am trying to add a aboutUs page into a spree app using Spree Static Content. I have the following error when I click on the link of the About Us page<a href=\"https://i.stack.imgur.com/AXuU3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AXuU3.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have the following layout </p>\n\n<blockquote>\n  <p>layouts/aboutUs.html.erb</p>\n</blockquote>\n\n<p>In the routes.rb file I have the following code.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Rails.application.routes.draw do\r\n\r\n  # This line mounts Spree's routes at the root of your application.\r\n  # This means, any requests to URLs such as /products, will go to Spree::ProductsController.\r\n  # If you would like to change where this engine is mounted, simply change the :at option to something different.\r\n  #\r\n  # We ask that you don't use the :as option here, as Spree relies on it being the default of \"spree\"\r\n  mount Spree::Core::Engine, at: '/'\r\n          # For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html\r\n\r\n          get 'Yellow',   to: 'static_pages#aboutUs'\r\nend</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "database"], "comments": [{"owner": {"reputation": 1441, "user_id": 3489447, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/100001632707791/picture?type=large", "display_name": "tomsihap", "link": "https://stackoverflow.com/users/3489447/tomsihap"}, "edited": false, "score": 0, "creation_date": 1479329233, "post_id": 40641799, "comment_id": 68516050, "body": "Please describe your database models, precise where your are struggling,  what you&#39;ve done so far."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6706485, "user_type": "registered", "profile_image": "https://graph.facebook.com/1208547979197472/picture?type=large", "display_name": "Piotr Do\u0142\u0119ga", "link": "https://stackoverflow.com/users/6706485/piotr-do%c5%82%c4%99ga"}, "edited": false, "score": 0, "creation_date": 1479328931, "post_id": 40641897, "comment_id": 68515883, "body": "Sad to say but i meant databases :( it is task for my university. Create app wich will search for something in two seperate databases..."}, {"owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "reply_to_user": {"reputation": 21, "user_id": 6706485, "user_type": "registered", "profile_image": "https://graph.facebook.com/1208547979197472/picture?type=large", "display_name": "Piotr Do\u0142\u0119ga", "link": "https://stackoverflow.com/users/6706485/piotr-do%c5%82%c4%99ga"}, "edited": false, "score": 0, "creation_date": 1479329012, "post_id": 40641897, "comment_id": 68515923, "body": "two different database scheme&#39;s ? which datatabase engine are we talking about, you&#39;d better publish yout models and what you tried."}], "tags": [], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "is_accepted": false, "score": 0, "last_activity_date": 1479329350, "last_edit_date": 1479329350, "creation_date": 1479328853, "answer_id": 40641897, "question_id": 40641799, "link": "https://stackoverflow.com/questions/40641799/searching-two-databases-in-ruby-on-rails/40641897#40641897", "title": "Searching two databases in Ruby on Rails", "body": "<p>I suppose you mean tables, if they are related then you can do searches both in one request.</p>\n\n<p>See <a href=\"http://guides.rubyonrails.org/association_basics.html\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/association_basics.html</a> for examples.</p>\n\n<p>The examples are about activerecord, the database ORM behind Rails.\nThey use models about books, so you shouldn't have problems to follow the logic.</p>\n\n<p>EDIT: since you say it's about different databases, here an example how to connect to two at the same time. You still need to add the realtions between the two, see the previous part for that.\nIn the example I even use two different database files, one in memory and the other in a file, using the database engine Sqlite</p>\n\n<pre><code>class Test &lt; ActiveRecord::Base\n  establish_connection(\n    :adapter  =&gt; \"sqlite3\",\n    :database =&gt; \":memory:\"\n  )\nend\n\nclass Test2 &lt; ActiveRecord::Base\n  establish_connection(\n    :adapter  =&gt; \"sqlite3\",\n    :database =&gt; \"testing.db\"\n  )\n  self.table_name    = :tests\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 6706485, "user_type": "registered", "profile_image": "https://graph.facebook.com/1208547979197472/picture?type=large", "display_name": "Piotr Do\u0142\u0119ga", "link": "https://stackoverflow.com/users/6706485/piotr-do%c5%82%c4%99ga"}, "edited": false, "score": 0, "creation_date": 1479330873, "post_id": 40642052, "comment_id": 68516933, "body": "Hmm, so what kind of technology would You propose for this task? I need to make app wich will just &#39;search two databases for records&#39;. Just some simple API i think, and integration... I started doing it in rails because i had some experience with it and i already had configured enviroment on my PC - oh and last thing, it will be used just few times for my exam, it doesn&#39;t have to be realy effective. It just has to work."}], "tags": [], "owner": {"reputation": 1592, "user_id": 4271743, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Nivk1.jpg?s=128&g=1", "display_name": "ConnorCMcKee", "link": "https://stackoverflow.com/users/4271743/connorcmckee"}, "is_accepted": false, "score": 0, "last_activity_date": 1479329453, "last_edit_date": 1495541236, "creation_date": 1479329453, "answer_id": 40642052, "question_id": 40641799, "link": "https://stackoverflow.com/questions/40641799/searching-two-databases-in-ruby-on-rails/40642052#40642052", "title": "Searching two databases in Ruby on Rails", "body": "<p>I have personally attempted to create rails applications which connect to multiple databases simultaneously, and am disappointed to say that I do not believe this is a reasonable solution to any problem. While it can technically be accomplished, it involves forcing Rails into doing a lot of things it's simply not meant to do. Before approaching the logic you would require to search multiple models (which is something you would absolutely need), you should first put some time into overcoming the hurdle of connecting to multiple databases -- specifically if Ruby on Rails is the right tool for the job.</p>\n\n<p>If you feel you truly must go forward with this approach, I recommend looking at some of the answers referenced here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/1825844/multiple-databases-in-rails\">Stack Overflow: Multiple Databases in Rails</a></p>\n"}], "owner": {"reputation": 21, "user_id": 6706485, "user_type": "registered", "profile_image": "https://graph.facebook.com/1208547979197472/picture?type=large", "display_name": "Piotr Do\u0142\u0119ga", "link": "https://stackoverflow.com/users/6706485/piotr-do%c5%82%c4%99ga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1479329453, "creation_date": 1479328525, "last_edit_date": 1479328871, "question_id": 40641799, "link": "https://stackoverflow.com/questions/40641799/searching-two-databases-in-ruby-on-rails", "title": "Searching two databases in Ruby on Rails", "body": "<p>I need to search two databases in Ruby on Rails. Both are about books: name, ISBN, and price.</p>\n\n<p>I need to search both at the same request. Is it possible? I have already made app which is searching one database. <a href=\"https://youtu.be/eUtUquKc2qQ\" rel=\"nofollow noreferrer\">Here</a> is tutorial that I followed.</p>\n"}, {"tags": ["ruby", "design-patterns", "dsl", "design-principles"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1479327422, "post_id": 40641273, "comment_id": 68514974, "body": "Normally you do <code>instance_eval</code> on some kind of proxy object for each level here. Calling <code>def</code> inside a method is generally bad form as the results are not always as expected."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1479329221, "post_id": 40641273, "comment_id": 68516040, "body": "Welcome to SO. &quot;What are the other ways...&quot; is extremely broad."}, {"owner": {"reputation": 121, "user_id": 6688130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/pWgN4.jpg?s=128&g=1", "display_name": "I&#39;m Mo", "link": "https://stackoverflow.com/users/6688130/im-mo"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1479331860, "post_id": 40641273, "comment_id": 68517437, "body": "@tadman could you please elaborate with an example?"}, {"owner": {"reputation": 121, "user_id": 6688130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/pWgN4.jpg?s=128&g=1", "display_name": "I&#39;m Mo", "link": "https://stackoverflow.com/users/6688130/im-mo"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1479331908, "post_id": 40641273, "comment_id": 68517462, "body": "@theTinMan &quot;the best way&quot; is too subjective. And it is interesting to see the varieties that ruby metaprogramming has to offer."}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 6688130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/pWgN4.jpg?s=128&g=1", "display_name": "I&#39;m Mo", "link": "https://stackoverflow.com/users/6688130/im-mo"}, "edited": false, "score": 1, "creation_date": 1479332253, "post_id": 40641743, "comment_id": 68517638, "body": "I love the <code>next_klass</code> alternative"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 121, "user_id": 6688130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/pWgN4.jpg?s=128&g=1", "display_name": "I&#39;m Mo", "link": "https://stackoverflow.com/users/6688130/im-mo"}, "edited": false, "score": 0, "creation_date": 1479334504, "post_id": 40641743, "comment_id": 68518702, "body": "There&#39;s a newer version."}, {"owner": {"reputation": 121, "user_id": 6688130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/pWgN4.jpg?s=128&g=1", "display_name": "I&#39;m Mo", "link": "https://stackoverflow.com/users/6688130/im-mo"}, "edited": false, "score": 0, "creation_date": 1479358078, "post_id": 40641743, "comment_id": 68525351, "body": "is it a known pattern?"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 121, "user_id": 6688130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/pWgN4.jpg?s=128&g=1", "display_name": "I&#39;m Mo", "link": "https://stackoverflow.com/users/6688130/im-mo"}, "edited": false, "score": 0, "creation_date": 1479370359, "post_id": 40641743, "comment_id": 68530732, "body": "I don&#39;t know. I just began with your example and started coding. I&#39;d be interested to know what other solutions look like. By the way, the last solutions work with arrays, I&#39;ll modify them to work with tree. For example if you want to have <code>c</code> and <code>d</code> methods in <code>b</code>."}, {"owner": {"reputation": 121, "user_id": 6688130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/pWgN4.jpg?s=128&g=1", "display_name": "I&#39;m Mo", "link": "https://stackoverflow.com/users/6688130/im-mo"}, "edited": false, "score": 0, "creation_date": 1479377360, "post_id": 40641743, "comment_id": 68535315, "body": "Sweet!! I am also experimenting with your Example F. To avoid polluting the Object class, trying to make a variant via <code>inject(MyKlass.singleton_class)</code>  btw a few explanatory hint comments for Example F would be much appreciated.  Thanks again :)"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 121, "user_id": 6688130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/pWgN4.jpg?s=128&g=1", "display_name": "I&#39;m Mo", "link": "https://stackoverflow.com/users/6688130/im-mo"}, "edited": false, "score": 0, "creation_date": 1479379341, "post_id": 40641743, "comment_id": 68536726, "body": "Will do. Note that in Object, only A class and a() method will be defined. B class and b() method will be defined in A, and C class and c() method will be defined in A::B."}, {"owner": {"reputation": 121, "user_id": 6688130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/pWgN4.jpg?s=128&g=1", "display_name": "I&#39;m Mo", "link": "https://stackoverflow.com/users/6688130/im-mo"}, "edited": false, "score": 0, "creation_date": 1479401072, "post_id": 40641743, "comment_id": 68552091, "body": "Thanks for the update Eric, you pretty much nailed it!! Amazing!!"}, {"owner": {"reputation": 2866, "user_id": 58800, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/aIDHE.jpg?s=128&g=1", "display_name": "zotherstupidguy", "link": "https://stackoverflow.com/users/58800/zotherstupidguy"}, "edited": false, "score": 0, "creation_date": 1480961481, "post_id": 40641743, "comment_id": 69170580, "body": "very nice!! love it!"}, {"owner": {"reputation": 2866, "user_id": 58800, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/aIDHE.jpg?s=128&g=1", "display_name": "zotherstupidguy", "link": "https://stackoverflow.com/users/58800/zotherstupidguy"}, "edited": false, "score": 0, "creation_date": 1481026742, "post_id": 40641743, "comment_id": 69198810, "body": "@EricDuminil already did! have you considered doing a version where modern ruby features come into play maybe refinements!"}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": true, "score": 3, "last_activity_date": 1479389578, "last_edit_date": 1479389578, "creation_date": 1479328281, "answer_id": 40641743, "question_id": 40641273, "link": "https://stackoverflow.com/questions/40641273/ruby-dsl-nested-constructs/40641743#40641743", "title": "Ruby DSL nested constructs", "body": "<p>You asked about other ways, not the best way. So here's some examples :</p>\n\n<h1>Example A</h1>\n\n<pre><code>class A\n  def initialize\n    p \"a\"\n  end\n\n  def b &amp;block\n    B.new.instance_eval &amp;block\n  end\nend\n\nclass B\n  def initialize\n    p \"b\"\n  end\n\n  def c &amp;block\n    C.new.instance_eval &amp;block\n  end\nend\n\nclass C\n  def initialize\n    p \"c\"\n  end\nend\n\ndef a &amp;block\n  A.new.instance_eval &amp;block\nend\n</code></pre>\n\n<h1>Example B</h1>\n\n<p>A bit shorter :</p>\n\n<pre><code>def a &amp;block\n  p \"a\"\n  A.new.instance_eval &amp;block\nend\n\nclass A\n  def b &amp;block\n    p \"b\"\n    B.new.instance_eval &amp;block\n  end\n\n  class B\n    def c &amp;block\n      p \"c\"\n      C.new.instance_eval &amp;block\n    end\n\n    class C\n    end\n  end\nend\n</code></pre>\n\n<h1>Example C</h1>\n\n<p>If you don't plan to have a d method for an A::B::C object :</p>\n\n<pre><code>def a &amp;block\n  p \"a\"\n  A.new.instance_eval &amp;block\nend\n\nclass A\n  def b &amp;block\n    p \"b\"\n    B.new.instance_eval &amp;block\n  end\n\n  class B\n    def c &amp;block\n      p \"c\"\n      instance_eval &amp;block\n    end\n  end\nend\n</code></pre>\n\n<h1>Example D</h1>\n\n<p>This was a fun one :</p>\n\n<pre><code>def new_class_and_method(klass_name, next_klass=Object)\n  dynamic_klass = Class.new do\n    define_method(next_klass.name.downcase){|&amp;block| p next_klass.name.downcase; next_klass.new.instance_eval &amp;block}\n  end\n  Object.const_set(klass_name, dynamic_klass)\nend\n\nnew_class_and_method(\"A\", new_class_and_method(\"B\", new_class_and_method(\"C\")))\n\ndef a &amp;block\n  p \"a\"\n  A.new.instance_eval &amp;block\nend\n</code></pre>\n\n<h1>Example E</h1>\n\n<p>I dare say this doesn't look half bad:</p>\n\n<pre><code>def new_method_and_class(x)\n  define_method(x) do |&amp;block|\n    p x\n    self.class.const_get(x.capitalize).new.instance_eval &amp;block\n  end\n\n  self.const_set(x.capitalize, Class.new)\nend\n\n[\"a\", \"b\", \"c\"].inject(Object){|klass,x| klass.instance_eval{new_method_and_class(x)} }\n</code></pre>\n\n<h1>Example F</h1>\n\n<p>A bit more robust :</p>\n\n<pre><code>def new_method_and_class(x, parent_klass = Object)\n  parent_klass.class_eval do\n    define_method(x) do |&amp;block|\n      p x\n      parent_klass.const_get(x.capitalize).new.instance_eval &amp;block if block\n    end\n  end\n\n  parent_klass.const_set(x.capitalize, Class.new)\nend\n\n[\"a\", \"b\", \"c\"].inject(Object){|klass,x| new_method_and_class(x,klass) }\n</code></pre>\n\n<h1>Explanation</h1>\n\n<h3>Example B</h3>\n\n<p>In example B, we first define :</p>\n\n<ul>\n<li>an a() method</li>\n<li>an A class</li>\n</ul>\n\n<p>both are defined in main, because we want a() to be available directly.\na() method doesn't do much expect printing <code>\"a\"</code> and passing a block to an instance of A.</p>\n\n<p>Then comes b() method. We don't want it to be available from main, so we define it inside A class. We want to continue with the nested methods, so we define a B class, which is also defined inside A. The B class is actually a A::B class. The A::B#b() method also prints <code>\"b\"</code>, and passes a block to an instance of B.</p>\n\n<p>We continue with A::B::C inside of A::B, just like we did with A::B and A.</p>\n\n<h3>Example F</h3>\n\n<p>Example F is basically like Example B, but written dynamically.</p>\n\n<p>In example B, we defined an x method and an X class in every step, with the exact same structure. It should be possible to avoid code repetition with a method called <code>new_method_and_class(x)</code> which uses <code>define_method</code>, <code>const_set</code> and <code>Class.new</code> :</p>\n\n<pre><code>new_method_and_class(\"a\") # &lt;- Object#a() and A are now defined\n\na do\n  puts self.inspect\nend\n#=&gt; \"a\"\n#   &lt;A:0x00000000e58bc0&gt;\n</code></pre>\n\n<p>Now, we want to define a b() method and a B class, but they shouldn't be in main. <code>new_method_and_class(\"b\")</code> wouldn't do. So we pass an extra parameter, called parent_klass, which defaults to Object :</p>\n\n<pre><code>parent_klass = new_method_and_class(\"a\")\nnew_method_and_class(\"b\", parent_klass)\n\na do \n  b do\n    puts self.inspect\n  end\nend\n\n# =&gt; \"a\"\n#    \"b\"\n#    &lt;A::B:0x00000000daf368&gt;\n\nb do\n  puts \"Not defined\"\nend\n\n# =&gt; in `&lt;main&gt;': undefined method `b' for main:Object (NoMethodError)\n</code></pre>\n\n<p>To define the c method, we just add another line :</p>\n\n<pre><code>parent_klass = new_method_and_class(\"a\")\nparent_klass = new_method_and_class(\"b\", parent_klass)\nparent_klass = new_method_and_class(\"c\", parent_klass)\n</code></pre>\n\n<p>And so on and so on.</p>\n\n<p>To avoid code repetition, we can use inject with the parent_klass as accumulator value :</p>\n\n<pre><code>[\"a\", \"b\", \"c\"].inject(Object){|klass,x| new_method_and_class(x,klass) }\n</code></pre>\n\n<h1>Bonus - Example G</h1>\n\n<p>Here's a modified code from Example F which works with a basic tree structure.</p>\n\n<pre><code># http://stackoverflow.com/questions/40641273/ruby-dsl-nested-constructs/40641743#40641743\ndef new_method_and_class(x, parent_klass = Object)\n  parent_klass.class_eval do\n    define_method(x) do |&amp;block|\n      p x.to_s\n      parent_klass.const_get(x.capitalize).new.instance_eval &amp;block if block\n    end\n  end\n\n  parent_klass.const_set(x.capitalize, Class.new)\nend\n\ndef create_dsl(branch,parent_klass = Object)\n  case branch\n  when Symbol, String\n    new_method_and_class(branch,parent_klass)\n  when Array\n    branch.each do |child|\n      create_dsl(child, parent_klass)\n    end\n  when Hash\n    branch.each do |key, value|\n      create_dsl(value, new_method_and_class(key,parent_klass))\n    end\n  end\nend\n\nmethods_tree = {\n  :a =&gt; {\n    :b =&gt; [\n      :c,\n      :d\n    ],\n    :e =&gt; :f,\n    :g =&gt; nil\n  }\n}\n\ncreate_dsl(methods_tree)\n\na do \n  b do\n    c do\n      puts self.inspect\n    end\n\n    d do\n    end\n  end\n\n  e do\n    f do\n    end\n  end\n\n  g do\n    puts self.inspect\n  end\nend\n\n# =&gt; \n#   \"a\"\n#   \"b\"\n#   \"c\"\n#   #&lt;A::B::C:0x0000000243dfa8&gt;\n#   \"d\"\n#   \"e\"\n#   \"f\"\n#   \"g\"\n#   #&lt;A::G:0x0000000243d918&gt;\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 6688130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/pWgN4.jpg?s=128&g=1", "display_name": "I&#39;m Mo", "link": "https://stackoverflow.com/users/6688130/im-mo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 4, "accepted_answer_id": 40641743, "answer_count": 1, "score": 3, "last_activity_date": 1479389578, "creation_date": 1479326591, "question_id": 40641273, "link": "https://stackoverflow.com/questions/40641273/ruby-dsl-nested-constructs", "title": "Ruby DSL nested constructs", "body": "<p>I am using the following code to enforce context of DSL nested constructs. What are the other ways of achieving the same functionality?</p>\n\n<pre><code>def a &amp;block\n  p \"a\"\n  def b &amp;block\n    p \"b\"\n    def c &amp;block\n      p \"c\"\n      instance_eval &amp;block\n    end \n    instance_eval &amp;block\n    undef :c\n  end \n  instance_eval &amp;block \n  undef :b\nend \n# Works\na do\n  b do\n    c do\n    end\n  end\nend\n\n# Doesn't Work \nb do\nend\nc do\nend\n</code></pre>\n\n<p><a href=\"https://gist.github.com/zotherstupidguy/71e45dc0cb1de7e3eb38a89931c808cf\" rel=\"nofollow noreferrer\">Source</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "charts", "chartkick"], "answers": [{"tags": [], "owner": {"reputation": 2961, "user_id": 2156684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4FEfx.jpg?s=128&g=1", "display_name": "yenshirak", "link": "https://stackoverflow.com/users/2156684/yenshirak"}, "is_accepted": false, "score": 1, "last_activity_date": 1479336684, "creation_date": 1479336684, "answer_id": 40643780, "question_id": 40640981, "link": "https://stackoverflow.com/questions/40640981/how-to-show-only-integers-in-yaxis-in-chartkick/40643780#40643780", "title": "How to show only integers in YAxis in chartkick", "body": "<p>If you use Google Charts then you can do it like this:</p>\n\n<pre><code>data = PaymentTransaction.group_by_day(:created_at, format: \"%b %d, %Y\").count\ny = data.map(&amp;:last)\ny_discrete = ((y.min.floor)..(y.max.ceil)).to_a\noptions = { vAxis: { ticks: y_discrete } }\nline_chart(data, { library: options })\n</code></pre>\n"}], "owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1479336684, "creation_date": 1479325563, "question_id": 40640981, "link": "https://stackoverflow.com/questions/40640981/how-to-show-only-integers-in-yaxis-in-chartkick", "title": "How to show only integers in YAxis in chartkick", "body": "<p>I want to show only integers in YAxis</p>\n\n<pre><code>PaymentTransaction.group_by_day(:created_at, format: \"%b %d, %Y\").count,discrete: true, allowDecimals: false,yAxis: {allowDecimals: false}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/R8VeP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/R8VeP.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby", "regex", "gsub"], "answers": [{"tags": [], "owner": {"reputation": 37822, "user_id": 1231450, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b9c98b4ce12bf9fd925d8c35c8861bb2?s=128&d=identicon&r=PG", "display_name": "Jan", "link": "https://stackoverflow.com/users/1231450/jan"}, "is_accepted": true, "score": 5, "last_activity_date": 1479325022, "creation_date": 1479325022, "answer_id": 40640820, "question_id": 40640692, "link": "https://stackoverflow.com/questions/40640692/simplified-regex-for-modifying-a-string-in-ruby/40640820#40640820", "title": "simplified regex for modifying a string in ruby", "body": "<p>Replace the following construct</p>\n\n<pre><code>[\\n\\r]\\t(?:\\w+: )?\n</code></pre>\n\n<p>with <code>;</code>, see <a href=\"https://regex101.com/r/rohcFA/1\" rel=\"nofollow noreferrer\"><strong>a demo on regex101.com</strong></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 4, "last_activity_date": 1479325072, "creation_date": 1479325072, "answer_id": 40640832, "question_id": 40640692, "link": "https://stackoverflow.com/questions/40640692/simplified-regex-for-modifying-a-string-in-ruby/40640832#40640832", "title": "simplified regex for modifying a string in ruby", "body": "<p>I'd tackle it as a few smaller steps:</p>\n\n<pre><code>input = \"Chassis ID TLV\\n\\tMAC: 00:xx:xx:xx:xx:xx\\nPort ID TLV\\n\\tIfname: Ethernet1/3\\nTime to Live TLV\\n\\t120\"\ninput.split(/\\n\\t?/).map { |s| s.sub(/\\A[^:]+\\:\\s*/, '') }.join(';')\n# =&gt; \"Chassis ID TLV;00:xx:xx:xx:xx:xx;Port ID TLV;Ethernet1/3;Time to Live TLV;120\"\n</code></pre>\n\n<p>That way you have control over each element instead of being entirely dependent on the regular expression to do it as one shot.</p>\n"}], "owner": {"reputation": 811, "user_id": 2532972, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/a0cd5af6f706e88c63406938f8c67052?s=128&d=identicon&r=PG", "display_name": "cool77", "link": "https://stackoverflow.com/users/2532972/cool77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 40640820, "answer_count": 2, "score": 1, "last_activity_date": 1479325072, "creation_date": 1479324593, "last_edit_date": 1479324931, "question_id": 40640692, "link": "https://stackoverflow.com/questions/40640692/simplified-regex-for-modifying-a-string-in-ruby", "title": "simplified regex for modifying a string in ruby", "body": "<p>Here is my original string:</p>\n\n<pre><code>\"Chassis ID TLV\\n\\tMAC: 00:xx:xx:xx:xx:xx\\nPort ID TLV\\n\\tIfname: Ethernet1/3\\nTime to Live TLV\\n\\t120\"\n</code></pre>\n\n<p>and i want the string to be formatted as :</p>\n\n<pre><code>\"Chassis ID TLV;00:xx:xx:xx:xx:xx\\nPort ID TLV;Ethernet1/3\\nTime to Live TLV;120\"\n</code></pre>\n\n<p>so i used following ruby string functions to do it:</p>\n\n<pre><code>y = x.gsub(/\\t[a-zA-Z\\d]+:/,\"\\t\")\ny = y.gsub(/\\t /,\"\\t\")\ny = y.gsub(\"\\n\\t\",\";\")\n</code></pre>\n\n<p>so i am looking for a one liner to do the above. since i am not used to regex, i tried doing it sequentially. i am messing it up when i try to do all of them together.</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "haml", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 2, "creation_date": 1479325210, "post_id": 40640472, "comment_id": 68513719, "body": "Wouldn&#39;t it make a lot more sense to (a) move the JavaScript to a separate file and (b) serialize <code>@leads</code> to JSON (possibly filtering out entries with missing coordinates first) and handing that JavaScript data to your JavaScript function? Trying to mix languages like you are almost always leads to tears and frustration and it tends to be a big ugly mess even when you can make it work."}, {"owner": {"reputation": 5836, "user_id": 1153022, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/JgpPs.jpg?s=128&g=1", "display_name": "okay56k", "link": "https://stackoverflow.com/users/1153022/okay56k"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1479325315, "post_id": 40640472, "comment_id": 68513779, "body": "Yeah, I figured I&#39;d make it into a partial for the time being. Probably smarter design."}], "answers": [{"tags": [], "owner": {"reputation": 194, "user_id": 7144184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2fsHw.jpg?s=128&g=1", "display_name": "Sam Ch", "link": "https://stackoverflow.com/users/7144184/sam-ch"}, "is_accepted": false, "score": 0, "last_activity_date": 1479370810, "creation_date": 1479370810, "answer_id": 40649797, "question_id": 40640472, "link": "https://stackoverflow.com/questions/40640472/ruby-in-js-in-haml-whats-the-syntax/40649797#40649797", "title": "Ruby in JS in HAML: what&#39;s the syntax?", "body": "<p>try</p>\n\n<pre><code>...\n%script\n  - @leads.each do |lead|\n    - next unless lead.latitude &amp;&amp; lead.longitude\n    var lead_latitude = \"#{lead.latitude}\";\n    var lead_longitude = \"#{lead.longitude}\";\n    var marker = new google.maps.Marker({\n      position: {lat: lead_latitude, lng: lead_longitude},\n      map: map\n    });\n...\n</code></pre>\n\n<p>I forget if google maps api allows lat and lng in string, but you can convert <code>lead_latitude</code> and <code>lead_longitude</code> to their need (<code>parseInt</code>, <code>parseDouble</code>, etc).</p>\n\n<p>if you still insist putting ruby variable inside js in haml</p>\n"}, {"tags": [], "owner": {"reputation": 632, "user_id": 7143763, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0QlJUg0F-uo/AAAAAAAAAAI/AAAAAAAAAJE/4OqZ-1jLIYc/photo.jpg?sz=128", "display_name": "Connor Shea", "link": "https://stackoverflow.com/users/7143763/connor-shea"}, "is_accepted": false, "score": 0, "last_activity_date": 1479690046, "creation_date": 1479690046, "answer_id": 40711360, "question_id": 40640472, "link": "https://stackoverflow.com/questions/40640472/ruby-in-js-in-haml-whats-the-syntax/40711360#40711360", "title": "Ruby in JS in HAML: what&#39;s the syntax?", "body": "<p>I'd recommend using <a href=\"https://github.com/gazay/gon\" rel=\"nofollow noreferrer\">gon</a> 59 accomplish this if you really want to have your Ruby variables in JS.</p>\n\n<p>That said, I'd strongly recommend against using script tags since ideally for security reasons you would want to block all script tags, thus preventing most forms of XSS.</p>\n"}], "owner": {"reputation": 5836, "user_id": 1153022, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/JgpPs.jpg?s=128&g=1", "display_name": "okay56k", "link": "https://stackoverflow.com/users/1153022/okay56k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1061, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1479690046, "creation_date": 1479323794, "question_id": 40640472, "link": "https://stackoverflow.com/questions/40640472/ruby-in-js-in-haml-whats-the-syntax", "title": "Ruby in JS in HAML: what&#39;s the syntax?", "body": "<p>I've got this JS at the end of my HAML view:</p>\n\n<pre><code>:javascript\n  function initMap() {\n    var map = new google.maps.Map(document.getElementById('leadsMap')),\n      markers = [],\n      bounds = new google.maps.LatLngBounds();\n\n    - @leads.each do |lead|\n      - next unless lead.latitude &amp;&amp; lead.longitude\n      var marker = new google.maps.Marker({\n        position: {lat: #{lead.latitude}, lng: #{lead.longitude}},\n        map: map\n      });\n      markers.push(marker);\n\n    for (var i = 0; i &lt; markers.length; i++) {\n      bounds.extend(markers[i].getPosition());\n    }\n    map.fitBounds(bounds);\n  }\n</code></pre>\n\n<p>How can I parse the <code>@leads</code> so that the loop works correctly? As it stands I get a <code>undefined local variable or method 'lead'</code> error.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "bundler"], "answers": [{"comments": [{"owner": {"reputation": 1169, "user_id": 3346954, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e9998db95c439ee16a56bacfc750798b?s=128&d=identicon&r=PG&f=1", "display_name": "jbk", "link": "https://stackoverflow.com/users/3346954/jbk"}, "edited": false, "score": 0, "creation_date": 1479574273, "post_id": 40645631, "comment_id": 68620156, "body": "<code>ruby -v</code> returns <code>ruby 2.2.2p95 (2015-04-13 revision 50295) [x86_64-darwin16]</code> so already it&#39;s already using 2.2.2, and <code>rvm use 2.2.2</code> returns <code>Using &#47;Users&#47;jbkimac&#47;.rvm&#47;gems&#47;ruby-2.2.2</code> So that&#39;s not the solution Hossam I&#39;m afraid!"}], "tags": [], "owner": {"reputation": 1, "user_id": 3851550, "user_type": "registered", "profile_image": "https://graph.facebook.com/501573962/picture?type=large", "display_name": "Hossam Hossny", "link": "https://stackoverflow.com/users/3851550/hossam-hossny"}, "is_accepted": false, "score": 0, "last_activity_date": 1479348931, "creation_date": 1479348931, "answer_id": 40645631, "question_id": 40640460, "link": "https://stackoverflow.com/questions/40640460/bundle-is-installed-yet-bash-bundle-command-not-found-when-using-any-bundl/40645631#40645631", "title": "Bundle is installed, yet `-bash: bundle: command not found` when using any bundle command in app directory", "body": "<p>You need to issue the following command:</p>\n\n<pre><code>rmv use 2.2.2\n</code></pre>\n"}], "owner": {"reputation": 1169, "user_id": 3346954, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e9998db95c439ee16a56bacfc750798b?s=128&d=identicon&r=PG&f=1", "display_name": "jbk", "link": "https://stackoverflow.com/users/3346954/jbk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 315, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1479574438, "creation_date": 1479323761, "last_edit_date": 1479574438, "question_id": 40640460, "link": "https://stackoverflow.com/questions/40640460/bundle-is-installed-yet-bash-bundle-command-not-found-when-using-any-bundl", "title": "Bundle is installed, yet `-bash: bundle: command not found` when using any bundle command in app directory", "body": "<p>I'm setting up a new Mac and trying to get dev environemnt set up. Using Homebrew &amp; RVM as package managers. I have bundler installed when i run <code>bundler -v</code> from root it get <code>Bundler version 1.13.6</code> no problem.</p>\n\n<p>However I've just cloned one of my app projects locally and when in that app's directory <code>bundler</code> returns <code>command not found</code>. Surley I shouldn't need to install Bundler when in each directory?!? Is this some user permisisons issue? Can you help me understand this situation and why bundler doesn't work in the newly pulled app directory? Ultimately I'm just trying to bundle install the gemfile for this newly cloned application.</p>\n\n<p>gem environment</p>\n\n<pre><code>RubyGems Environment:\n  - RUBYGEMS VERSION: 2.4.8\n  - RUBY VERSION: 2.2.2 (2015-04-13 patchlevel 95) [x86_64-darwin16]\n  - INSTALLATION DIRECTORY: /Users/usr/.rvm/gems/ruby-2.2.2\n  - RUBY EXECUTABLE: /Users/usr/.rvm/rubies/ruby-2.2.2/bin/ruby\n  - EXECUTABLE DIRECTORY: /Users/usr/rvm/gems/ruby-2.2.2/bin\n  - SPEC CACHE DIRECTORY: /Users/usr/.gem/specs\n  - SYSTEM CONFIGURATION DIRECTORY: /Users/usr/.rvm/rubies/ruby-2.2.2/etc\n  - RUBYGEMS PLATFORMS:\n    - ruby\n    - x86_64-darwin-16\n  - GEM PATHS:\n     - /Users/usr/.rvm/gems/ruby-2.2.2\n     - /Users/usr/.rvm/gems/ruby-2.2.2@global\n  - GEM CONFIGURATION:\n     - :update_sources =&gt; true\n     - :verbose =&gt; true\n     - :backtrace =&gt; false\n     - :bulk_threshold =&gt; 1000\n     - \"gem\" =&gt; \"--no-document\"\n  - REMOTE SOURCES:\n     - https://rubygems.org/\n  - SHELL PATH:\n     - /Users/usr/.rvm/gems/ruby-2.2.2/bin\n     - /Users/usr/.rvm/gems/ruby-2.2.2@global/bin\n     - /Users/jusr/.rvm/rubies/ruby-2.2.2/bin\n     - /Users/usr/.rvm/bin\n     - /usr/local/bin\n     - /usr/bin\n     - /bin\n     - /usr/sbin\n     - /sbin\n</code></pre>\n\n<p>echo $PATH</p>\n\n<pre><code>/Users/usr/.rvm/gems/ruby-2.2.2/bin:/Users/usr/.rvm/gems/ruby-2.2.2@global/bin:/Users/usr/.rvm/rubies/ruby-2.2.2/bin:/Users/usr/.rvm/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin\n</code></pre>\n\n<p>which gem</p>\n\n<pre><code>/Users/usr/.rvm/rubies/ruby-2.2.2/bin/gem\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "google-app-engine", "google-cloud-platform"], "comments": [{"owner": {"reputation": 99, "user_id": 4235601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e99ac7c04f239eff3c413a972f9ae8?s=128&d=identicon&r=PG", "display_name": "Vasco Andrade Silva", "link": "https://stackoverflow.com/users/4235601/vasco-andrade-silva"}, "edited": false, "score": 0, "creation_date": 1479481005, "post_id": 40640195, "comment_id": 68589992, "body": "I don&#39;t know if StackOverflow is the best place to post this question, as such I also posted the question in &quot;Server Fault&quot;: <a href=\"http://serverfault.com/questions/815750/app-engine-ruby-flex-environment-app-yaml-is-ignoring-env-variables-rails-env\" title=\"app engine ruby flex environment app yaml is ignoring env variables rails env\">serverfault.com/questions/815750/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 4235601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e99ac7c04f239eff3c413a972f9ae8?s=128&d=identicon&r=PG", "display_name": "Vasco Andrade Silva", "link": "https://stackoverflow.com/users/4235601/vasco-andrade-silva"}, "edited": false, "score": 0, "creation_date": 1487033083, "post_id": 42127361, "comment_id": 71593355, "body": "The issue is exactly not being able to set RAILS_ENV to other environment value.. See <a href=\"http://serverfault.com/questions/815750/app-engine-ruby-flex-environment-app-yaml-is-ignoring-env-variables-rails-env\" title=\"app engine ruby flex environment app yaml is ignoring env variables rails env\">serverfault.com/questions/815750/&hellip;</a>"}], "tags": [], "owner": {"reputation": 17522, "user_id": 143739, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c8a063d46a8d587413caa9e2df441247?s=128&d=identicon&r=PG", "display_name": "kzh", "link": "https://stackoverflow.com/users/143739/kzh"}, "is_accepted": false, "score": 1, "last_activity_date": 1486608401, "creation_date": 1486608401, "answer_id": 42127361, "question_id": 40640195, "link": "https://stackoverflow.com/questions/40640195/app-engine-ruby-flex-environment-app-yaml-is-ignoring-env-variables-rails-env/42127361#42127361", "title": "App Engine Ruby flex environment app.yaml is ignoring env_variables RAILS_ENV", "body": "<p>The flexible environment sets RAILS_ENV by default to 'production'.</p>\n\n<p><a href=\"https://cloud.google.com/appengine/docs/flexible/ruby/runtime#environment_variables\" rel=\"nofollow noreferrer\">https://cloud.google.com/appengine/docs/flexible/ruby/runtime#environment_variables</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 3732000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqoX2.jpg?s=128&g=1", "display_name": "remi Taylor", "link": "https://stackoverflow.com/users/3732000/remi-taylor"}, "is_accepted": false, "score": 0, "last_activity_date": 1490320346, "creation_date": 1490320346, "answer_id": 42990064, "question_id": 40640195, "link": "https://stackoverflow.com/questions/40640195/app-engine-ruby-flex-environment-app-yaml-is-ignoring-env-variables-rails-env/42990064#42990064", "title": "App Engine Ruby flex environment app.yaml is ignoring env_variables RAILS_ENV", "body": "<p>Environment variables set in app.yaml under <code>env_variables</code> should now override the defaults (which come from the generated Dockerfile).</p>\n\n<p>I just deployed a <a href=\"https://gist.github.com/remi/3ae9562de6aed8680ad1366acaca0690\" rel=\"nofollow noreferrer\">sample application</a> to App Engine with <code>RAILS_ENV</code> customized in my env_variables.</p>\n\n<pre><code>env_variables:\n  APP_YAML_VAR: this was set in the app.yaml\n  RAILS_ENV: overridden\n</code></pre>\n\n<p>When deployed, <code>ENV[\"RAILS_ENV\"]</code> shows my customized, overridden value.</p>\n\n<p><a href=\"https://i.stack.imgur.com/l3eub.png\" rel=\"nofollow noreferrer\">Screenshot of customized environment variable</a></p>\n"}], "owner": {"reputation": 99, "user_id": 4235601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e99ac7c04f239eff3c413a972f9ae8?s=128&d=identicon&r=PG", "display_name": "Vasco Andrade Silva", "link": "https://stackoverflow.com/users/4235601/vasco-andrade-silva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1490320346, "creation_date": 1479322832, "last_edit_date": 1479408494, "question_id": 40640195, "link": "https://stackoverflow.com/questions/40640195/app-engine-ruby-flex-environment-app-yaml-is-ignoring-env-variables-rails-env", "title": "App Engine Ruby flex environment app.yaml is ignoring env_variables RAILS_ENV", "body": "<p>We are using GAE with Ruby flexible environment, and we're trying to deploy a rails app with staging configurations (i.e. RAILS_ENV=staging).</p>\n\n<p>According to <a href=\"https://cloud.google.com/appengine/docs/flexible/ruby/configuring-your-app-with-app-yaml\" rel=\"nofollow noreferrer\">https://cloud.google.com/appengine/docs/flexible/ruby/configuring-your-app-with-app-yaml</a> we should be able to set the value of RAILS_ENV configuring an app.yaml with:</p>\n\n<pre><code>env_variables:\n  RAILS_ENV: 'staging'\n</code></pre>\n\n<p>However, when we run:</p>\n\n<pre><code>gcloud app deploy\n</code></pre>\n\n<p>A (temporary) Dockerfile is generated with</p>\n\n<pre><code># Temporary. Will be moved to base image later.\nENV RACK_ENV=production \\\n    RAILS_ENV=production \\\n    RAILS_SERVE_STATIC_FILES=true\n</code></pre>\n\n<p>Which results in a deployment in the PRODUCTION environment (default value for RAILS_ENV).</p>\n\n<p>Is this a bug or am I missing something?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "answers": [{"tags": [], "owner": {"reputation": 18224, "user_id": 406987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8865b16d4f3493cfae865af2b3247fd3?s=128&d=identicon&r=PG", "display_name": "Doon", "link": "https://stackoverflow.com/users/406987/doon"}, "is_accepted": true, "score": 1, "last_activity_date": 1479323608, "last_edit_date": 1479323608, "creation_date": 1479321858, "answer_id": 40639882, "question_id": 40639829, "link": "https://stackoverflow.com/questions/40639829/ruby-on-rails-get-paramenter-from-url-on-view/40639882#40639882", "title": "Ruby on Rails get paramenter from URL on View", "body": "<p>well <code>:id</code> is just a symbol, you need to tell the route helper what to bind to it.   For example</p>\n\n<pre><code>&lt;%= link_to 'Novo', new_menu_path(id: params[:id]) %&gt;\n</code></pre>\n\n<p>which should give you something like <code>/menus/new?id=6</code> </p>\n"}, {"tags": [], "owner": {"reputation": 166, "user_id": 7040027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37407cfccbfc6c2c6370a74c41fec074?s=128&d=identicon&r=PG", "display_name": "veldtmana", "link": "https://stackoverflow.com/users/7040027/veldtmana"}, "is_accepted": false, "score": 2, "last_activity_date": 1479324275, "creation_date": 1479324275, "answer_id": 40640617, "question_id": 40639829, "link": "https://stackoverflow.com/questions/40639829/ruby-on-rails-get-paramenter-from-url-on-view/40640617#40640617", "title": "Ruby on Rails get paramenter from URL on View", "body": "<p>To pass an extra param to an url when you define a <code>link_to</code></p>\n\n<pre><code>&lt;%= link_to 'Novo', new_menu_path(id: @menu.id, other_param: \"hello\") %&gt;\n</code></pre>\n\n<p>will generate <code>http://localhost:3000/menus/new?id=6&amp;other_param=hello</code></p>\n\n<p>this will add the following to the <code>params</code> hash</p>\n\n<pre><code>Parameters: {\"id\"=&gt;\"6\", \"other_param\"=&gt;\"hello\"}\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 7132958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a500d076cc180abea235be655d429118?s=128&d=identicon&r=PG&f=1", "display_name": "Evelyn St", "link": "https://stackoverflow.com/users/7132958/evelyn-st"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 40639882, "answer_count": 2, "score": 0, "last_activity_date": 1479324275, "creation_date": 1479321662, "question_id": 40639829, "link": "https://stackoverflow.com/questions/40639829/ruby-on-rails-get-paramenter-from-url-on-view", "title": "Ruby on Rails get paramenter from URL on View", "body": "<p>I'd like to get the paramenter from the URL on my view/html.</p>\n\n<p>For example, I'm showing an specific item from my data base, and the URL is like this: \"<a href=\"http://localhost:3000/menus/index.%23%3CMenu::ActiveRecord_Relation:0x007f50ed153250%3E?id=6\" rel=\"nofollow noreferrer\">http://localhost:3000/menus/index.%23%3CMenu::ActiveRecord_Relation:0x007f50ed153250%3E?id=6</a>\"</p>\n\n<p>What I want is: when I click on the New Button of that specific item, the form opens with the URL \"<a href=\"http://localhost:3000/menus/new\" rel=\"nofollow noreferrer\">http://localhost:3000/menus/new</a>\", but I want somehow pass that id=6 to this NEW view.</p>\n\n<p>I am using this code on the html to open the form: <code>&lt;%= link_to 'Novo', new_menu_path %&gt;</code></p>\n\n<p>I also tried: <code>&lt;%= link_to 'Novo', new_menu_path(@menus, :id) %&gt;</code>, but the id param is always null/empty.</p>\n\n<p>How do I do that?\nThank you</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "ruby-on-rails-4", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4805539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad60c0cef2e110bef0c2e51e139f37f6?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Huynh", "link": "https://stackoverflow.com/users/4805539/arthur-huynh"}, "edited": false, "score": 0, "creation_date": 1479322064, "post_id": 40639913, "comment_id": 68511960, "body": "It literally dawned on me how simple the answer was and I went back to post it the second you answered! I&#39;ll mark yours as correct as soon as the timer expires. Thanks!"}], "tags": [], "owner": {"reputation": 3363, "user_id": 2876504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f861d39e1561dc8147fc6442d1235e8?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro C.", "link": "https://stackoverflow.com/users/2876504/alejandro-c"}, "is_accepted": true, "score": 2, "last_activity_date": 1479321965, "creation_date": 1479321965, "answer_id": 40639913, "question_id": 40639823, "link": "https://stackoverflow.com/questions/40639823/how-to-delete-only-the-objects-from-activerecord-collection-from-mysql-in-rails/40639913#40639913", "title": "How to delete only the objects from ActiveRecord collection from mysql in Rails?", "body": "<p>Instead of adding a flag, you could simply <code>pluck</code> the id's of the old rows, and then run a new query deleting those. The <code>delete_all</code> method by definition runs a new query, so there isn't a way to freeze the old results and delete those directly.</p>\n\n<p>You might also try updating the rows directly if many of the fields (say <code>player_id</code> and <code>game_id</code> or something) are the same from week to week...</p>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 4805539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad60c0cef2e110bef0c2e51e139f37f6?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Huynh", "link": "https://stackoverflow.com/users/4805539/arthur-huynh"}, "is_accepted": false, "score": 0, "last_activity_date": 1479321980, "creation_date": 1479321980, "answer_id": 40639921, "question_id": 40639823, "link": "https://stackoverflow.com/questions/40639823/how-to-delete-only-the-objects-from-activerecord-collection-from-mysql-in-rails/40639921#40639921", "title": "How to delete only the objects from ActiveRecord collection from mysql in Rails?", "body": "<p>I can just pluck the ids from the ActiveRecord query of the old data. Then use <code>delete_all</code> off of those ids</p>\n"}], "owner": {"reputation": 35, "user_id": 4805539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad60c0cef2e110bef0c2e51e139f37f6?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Huynh", "link": "https://stackoverflow.com/users/4805539/arthur-huynh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 40639913, "answer_count": 2, "score": 0, "last_activity_date": 1479321980, "creation_date": 1479321651, "question_id": 40639823, "link": "https://stackoverflow.com/questions/40639823/how-to-delete-only-the-objects-from-activerecord-collection-from-mysql-in-rails", "title": "How to delete only the objects from ActiveRecord collection from mysql in Rails?", "body": "<p>I am calculating weekly leaderboard stats for players of a game, using a service object I created. I am in a situation where if I want to redo the calculations for any particular week, I want to delete the old stats if and only if the new stats were saved successfully.</p>\n\n<p>Roughly my steps:</p>\n\n<ol>\n<li>AR query existing stats for the given week into a variable</li>\n<li>Run that week's new stats</li>\n<li>Save the new data, returning if save was successful</li>\n<li>On success of saving new data, delete the objects from mysql of query in step 1.</li>\n</ol>\n\n<p>I've tried using the <code>@old_data.delete_all</code> method but that will just run the query from the ActiveRecord_Relation object off of mysql at that moment, destroying the newly created data as well. I just want to destroy the ones I saved from the query I made before creating the new data.</p>\n\n<p>Possible solution I haven't tried: Sorta hacky but flag the old data by updating an arbitrary column of all objects in the old data query with an arbitrary value and use <code>delete_all</code> off of a query for that arbitrary value... This doesn't sound like the railsy way to do things and plus, it adds an extra query.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activemodel"], "comments": [{"owner": {"reputation": 1224, "user_id": 1170266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2db3460298af8f4a585f95cf556874?s=128&d=identicon&r=PG", "display_name": "archana", "link": "https://stackoverflow.com/users/1170266/archana"}, "edited": false, "score": 0, "creation_date": 1479324738, "post_id": 40639424, "comment_id": 68513471, "body": "<code>type</code> is just an instance variable here. When you instantiate a new user and provide <code>type</code> it just sets that variable. <code>Admin.new</code> will give you an object of class <code>Admin</code>."}], "answers": [{"comments": [{"owner": {"reputation": 5098, "user_id": 173542, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/91d00b2e1d76029cb9175053a846051b?s=128&d=identicon&r=PG", "display_name": "Michael Johnston", "link": "https://stackoverflow.com/users/173542/michael-johnston"}, "edited": false, "score": 0, "creation_date": 1488234800, "post_id": 40642094, "comment_id": 72133266, "body": "I think more is needed for subclasses to work with form_for"}], "tags": [], "owner": {"reputation": 45754, "user_id": 17410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1022b779bdc1ddef7cd9d29abd70ed15?s=128&d=identicon&r=PG", "display_name": "zetetic", "link": "https://stackoverflow.com/users/17410/zetetic"}, "is_accepted": false, "score": 1, "last_activity_date": 1479329626, "creation_date": 1479329626, "answer_id": 40642094, "question_id": 40639424, "link": "https://stackoverflow.com/questions/40639424/activemodelmodel-inheritance-not-working-as-expected/40642094#40642094", "title": "ActiveModel::Model inheritance not working as expected", "body": "<pre><code>class User\n  include ActiveModel::Model\n\n  def self.build(type: 'User')\n    klass = Kernel.const_get(type)\n    if klass.ancestors.include?(User)\n      klass.new\n    else\n      raise \"you are just not my type\"\n    end\n  end\n\n  def persisted?\n    false\n  end\nend\n\nclass Admin &lt; User\nend\n\n&gt; u = User.build(type: 'Admin) # =&gt; instance of Admin\n&gt; u = User.build # =&gt; instance of User\n&gt; u = User.build(type: 'Object') # =&gt; RuntimeError\n</code></pre>\n"}], "owner": {"reputation": 656, "user_id": 1262904, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/faff411a9ca427b444717ca9044a8e4f?s=128&d=identicon&r=PG", "display_name": "victorhazbun", "link": "https://stackoverflow.com/users/1262904/victorhazbun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1479329626, "creation_date": 1479320344, "last_edit_date": 1479323712, "question_id": 40639424, "link": "https://stackoverflow.com/questions/40639424/activemodelmodel-inheritance-not-working-as-expected", "title": "ActiveModel::Model inheritance not working as expected", "body": "<p>I'm trying to use inheritance with the classical \"type\" attribute. On initialize User with type: \"Admin\" I expect an <strong>Admin</strong> object but it returns a <strong>User</strong> object. How can I make a class to act like a model and also make it act like it has STI?</p>\n\n<pre><code>class User\n  include ActiveModel::Model\n  attr_accessor :type\n\n  def persisted?\n    false\n  end\nend\n\nclass Admin &lt; User\nend\n</code></pre>\n\n<p><code>user = User.new(type: \"Admin\")\n #=&gt; #&lt;User:0x007ff68a1ade60 @type=\"Admin\"&gt;</code></p>\n"}, {"tags": ["html", "ruby", "nokogiri"], "answers": [{"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1479331691, "post_id": 40640516, "comment_id": 68517351, "body": "<code>canon</code> won&#39;t be a String, it&#39;ll be an Attr object, which won&#39;t act like a String. It&#39;ll be stringified when you use <code>puts</code> but that&#39;s obscuring the real object which will cause problems down the line if you try to treat it as anything but what it is."}, {"owner": {"reputation": 832, "user_id": 5594180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iv01N.png?s=128&g=1", "display_name": "Sa\u0161a Zejnilovi\u0107", "link": "https://stackoverflow.com/users/5594180/sa%c5%a1a-zejnilovi%c4%87"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1479463210, "post_id": 40640516, "comment_id": 68578343, "body": "The main point is that it will grep what it has to. <code>puts canon</code> is just to prove it."}], "tags": [], "owner": {"reputation": 832, "user_id": 5594180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iv01N.png?s=128&g=1", "display_name": "Sa\u0161a Zejnilovi\u0107", "link": "https://stackoverflow.com/users/5594180/sa%c5%a1a-zejnilovi%c4%87"}, "is_accepted": false, "score": 4, "last_activity_date": 1479329548, "last_edit_date": 1479329548, "creation_date": 1479323911, "answer_id": 40640516, "question_id": 40639378, "link": "https://stackoverflow.com/questions/40639378/how-to-get-a-canonical-link-from-html-head-using-nokogiri/40640516#40640516", "title": "How to get a canonical link from HTML head using Nokogiri", "body": "<p>You are trying to get the attribute but that is not how you do it.</p>\n\n<p>You can use this:</p>\n\n<pre><code>page.xpath('//link[@rel=\"canonical\"]/@href')\n</code></pre>\n\n<p>What it says is: get me a link element anywhere in the document that has a  <code>rel</code> attribute that equals <code>\"canonical\"</code> and when you find that node, get me its <code>href</code>  attribute.</p>\n\n<p>The full answers is:</p>\n\n<pre><code>page = Nokogiri::HTML.parse(browser.html)\n\ncanon = page.xpath('//link[@rel=\"canonical\"]/@href')\nputs canon \n</code></pre>\n\n<p>What you tried to do is get a node that is called \"canonical\", not the attribute.</p>\n"}, {"comments": [{"owner": {"reputation": 832, "user_id": 5594180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iv01N.png?s=128&g=1", "display_name": "Sa\u0161a Zejnilovi\u0107", "link": "https://stackoverflow.com/users/5594180/sa%c5%a1a-zejnilovi%c4%87"}, "edited": false, "score": 0, "creation_date": 1507733046, "post_id": 40642133, "comment_id": 80330072, "body": "CSS selectors are nice but are a bit slower and can be a lot harder to migrate to other languages or for someone new to start learning."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "reply_to_user": {"reputation": 832, "user_id": 5594180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iv01N.png?s=128&g=1", "display_name": "Sa\u0161a Zejnilovi\u0107", "link": "https://stackoverflow.com/users/5594180/sa%c5%a1a-zejnilovi%c4%87"}, "edited": false, "score": 0, "creation_date": 1508287821, "post_id": 40642133, "comment_id": 80549239, "body": "Most web developers understand CSS, either from using jQuery or style-sheets so it&#39;s very easy for them to jump in that way. Migrating to other languages isn&#39;t necessarily hard; I&#39;ve used other parsers that understood CSS."}], "tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 2, "last_activity_date": 1479331482, "last_edit_date": 1479331482, "creation_date": 1479329764, "answer_id": 40642133, "question_id": 40639378, "link": "https://stackoverflow.com/questions/40639378/how-to-get-a-canonical-link-from-html-head-using-nokogiri/40642133#40642133", "title": "How to get a canonical link from HTML head using Nokogiri", "body": "<p>I'm a fan of using CSS selectors over XPath as they're more readable:</p>\n\n<pre><code>require 'nokogiri'\n\ndoc = Nokogiri::HTML('&lt;link rel=\"canonical\" href=\"https://test.com/somepage\"&gt;')\ndoc.at('link[rel=\"canonical\"]')['href'] # =&gt; \"https://test.com/somepage\"\n</code></pre>\n\n<hr>\n\n<p>There's come confusion about what Nokogiri, and XPath, are returning when accessing a node parameter. Consider this:</p>\n\n<pre><code>require 'nokogiri'\n\ndoc = Nokogiri::HTML('&lt;link rel=\"canonical\" href=\"https://test.com/somepage\"&gt;')\n</code></pre>\n\n<p>Here's how I'd do it using CSS:</p>\n\n<pre><code>doc.at('link[rel=\"canonical\"]').class # =&gt; Nokogiri::XML::Element\ndoc.at('link[rel=\"canonical\"]')['href'].class # =&gt; String\n\ndoc.at('link[rel=\"canonical\"]')['href'] # =&gt; \"https://test.com/somepage\"\n</code></pre>\n\n<p>XPath, while more powerful, is also capable of making you, or Nokogiri, Ruby or the CPU, do more work. </p>\n\n<p>First, <a href=\"http://www.rubydoc.info/github/sparklemotion/nokogiri/Nokogiri/XML/Searchable#xpath-instance_method\" rel=\"nofollow noreferrer\"><code>xpath</code></a>, which is the XPath-specific version of <a href=\"http://www.rubydoc.info/github/sparklemotion/nokogiri/Nokogiri/XML/Searchable#search-instance_method\" rel=\"nofollow noreferrer\"><code>search</code></a> returns a NodeSet, not a node or an element. A NodeSet is akin to an array of nodes, which can bite you if you're not aware of what you've got. From the <a href=\"http://www.rubydoc.info/github/sparklemotion/nokogiri/Nokogiri/XML/NodeSet\" rel=\"nofollow noreferrer\">NodeSet</a> documentation:</p>\n\n<blockquote>\n  <p>A NodeSet contains a list of Nokogiri::XML::Node objects. Typically a NodeSet is return as a result of searching a Document via Nokogiri::XML::Searchable#css or Nokogiri::XML::Searchable#xpath</p>\n</blockquote>\n\n<p>If you are looking for a specific node, or only a single instance of a particular type of node, then use <a href=\"http://www.rubydoc.info/github/sparklemotion/nokogiri/Nokogiri/XML/Searchable#at-instance_method\" rel=\"nofollow noreferrer\"><code>at</code></a>, or if you want to be picky, use <a href=\"http://www.rubydoc.info/github/sparklemotion/nokogiri/Nokogiri/XML/Searchable#at_css-instance_method\" rel=\"nofollow noreferrer\"><code>at_css</code></a> or <a href=\"http://www.rubydoc.info/github/sparklemotion/nokogiri/Nokogiri/XML/Searchable#at_xpath-instance_method\" rel=\"nofollow noreferrer\"><code>at_xpath</code></a>. (Nokogiri can usually figure out what you mean when using <code>at</code> or <code>search</code> but sometimes you have to use the specific method to give Nokogiri a nudge in the right direction.) Using <code>at</code> in the above example shows it returns the node itself, and once you've got the node it's trivial to get the value of any parameter by treating it as a hash.</p>\n\n<p><code>xpath</code>, <code>search</code> and <code>css</code> all return NodeSets, so, like an array, you need to point to the actual element you want then access the parameter:</p>\n\n<pre><code>doc.xpath('//link[@rel=\"canonical\"]/@href').class # =&gt; Nokogiri::XML::NodeSet\ndoc.xpath('//link[@rel=\"canonical\"]/@href').first.class # =&gt; Nokogiri::XML::Attr\n\ndoc.xpath('//link[@rel=\"canonical\"]/@href').text # =&gt; \"https://test.com/somepage\"\n</code></pre>\n\n<p>Notice that <code>'//link[@rel=\"canonical\"]/@href'</code> results in Nokogiri returning an Attr object, not text. You can print that object, and Ruby will stringify it, but it won't behave like a String resulting in errors if you try to treat it like one. For instance:</p>\n\n<pre><code>doc.xpath('//link[@rel=\"canonical\"]/@href').first.downcase # =&gt; NoMethodError: undefined method `downcase' for #&lt;Nokogiri::XML::Attr:0x007faace115d20&gt;\n</code></pre>\n\n<p>Instead, use <a href=\"http://text\" rel=\"nofollow noreferrer\"><code>text</code></a> or <code>content</code> to get the text value:</p>\n\n<pre><code>doc.at('//link[@rel=\"canonical\"]/@href').class # =&gt; Nokogiri::XML::Attr\n\ndoc.at('//link[@rel=\"canonical\"]/@href').text # =&gt; \"https://test.com/somepage\"\n</code></pre>\n\n<p>or get the element itself and then access the parameter like you would a hash:</p>\n\n<pre><code>doc.at('//link[@rel=\"canonical\"]').class # =&gt; Nokogiri::XML::Element\n\ndoc.at('//link[@rel=\"canonical\"]')['href'] # =&gt; \"https://test.com/somepage\"\n</code></pre>\n\n<p>either of which will return a String. </p>\n\n<p>Also notice I'm not using <code>@href</code> to return the Attr in this example, I'm only getting the Node itself then using <code>['href']</code> to return the text of the parameter. It's a shorter selector and makes more sense, at least to me, since Nokogiri isn't having to return the Attr object which you then have to convert using <code>text</code> or possibly run into problems when you accidentally treat it as a String.</p>\n"}], "owner": {"reputation": 21, "user_id": 7169070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be4345a4e1fd43cf68f1336eeac940cb?s=128&d=identicon&r=PG&f=1", "display_name": "Dawson", "link": "https://stackoverflow.com/users/7169070/dawson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1578, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1479331482, "creation_date": 1479320197, "last_edit_date": 1479329617, "question_id": 40639378, "link": "https://stackoverflow.com/questions/40639378/how-to-get-a-canonical-link-from-html-head-using-nokogiri", "title": "How to get a canonical link from HTML head using Nokogiri", "body": "<p>I'm trying to get the defined canonical link from a webpage using Nokogiri:</p>\n\n<pre><code>&lt;link rel=\"canonical\" href=\"https://test.com/somepage\"&gt;\n</code></pre>\n\n<p>It's the <code>href</code> I'm after. </p>\n\n<p>Whatever I try it doesn't seem to work. This is what I have:</p>\n\n<pre><code>page = Nokogiri::HTML.parse(browser.html)\n\ncanon = page.xpath('//canonical/@href')\nputs canon \n</code></pre>\n\n<p>This doesn't return anything, not even an error. </p>\n"}, {"tags": ["ruby", "bundler", "thor"], "answers": [{"tags": [], "owner": {"reputation": 4871, "user_id": 2040729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Vsxsu.jpg?s=128&g=1", "display_name": "Eduardo Santana", "link": "https://stackoverflow.com/users/2040729/eduardo-santana"}, "is_accepted": false, "score": 0, "last_activity_date": 1479317925, "creation_date": 1479317925, "answer_id": 40638709, "question_id": 40638708, "link": "https://stackoverflow.com/questions/40638708/how-to-use-thor-actions-from-bundle-console/40638709#40638709", "title": "How to use thor actions from bundle console?", "body": "<p>If you have a gemspec file with <code>thor</code> dependency in it, you can use bundler's console.</p>\n\n<pre><code>cat limarka.gemspec\n\n(...)\n\nGem::Specification.new do |spec|\n  (...)\n  spec.add_development_dependency \"bundler\", \"~&gt; 1.12\"\n  (...)\n  spec.add_dependency \"thor\"\n  (...)\nend\n</code></pre>\n\n<p>When you type <code>bundle console</code> it will load all gem dependencies into a console for you:</p>\n\n<pre><code>$ bundle console\nResolving dependencies...\n</code></pre>\n\n<p>Now to run a thor's action, you will need to create an instance of the class that contains the action. The <code>ask</code> action is from <code>Thor::Shell::Basic</code>, so here's the code to call it:</p>\n\n<pre><code>irb(main):001:0&gt; city = Thor::Shell::Basic.new.ask \"Type name of your city:\"\nType name of your city: Jo\u00e3o Pessoa\n=&gt; \"Jo\u00e3o Pessoa\"\nirb(main):002:0&gt; city\n=&gt; \"Jo\u00e3o Pessoa\"\nirb(main):003:0&gt; \n</code></pre>\n"}], "owner": {"reputation": 4871, "user_id": 2040729, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Vsxsu.jpg?s=128&g=1", "display_name": "Eduardo Santana", "link": "https://stackoverflow.com/users/2040729/eduardo-santana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479317925, "creation_date": 1479317925, "question_id": 40638708, "link": "https://stackoverflow.com/questions/40638708/how-to-use-thor-actions-from-bundle-console", "title": "How to use thor actions from bundle console?", "body": "<p>Some times I use <code>bundle console</code> to load a console with the project's dependencies and test API usage.</p>\n\n<p>So my question is: how can I test <a href=\"http://www.rubydoc.info/github/wycats/thor/master/Thor/Shell/Basic\" rel=\"nofollow noreferrer\">thor's actions</a> like <a href=\"http://www.rubydoc.info/github/wycats/thor/Thor/Shell/Basic#ask-instance_method\" rel=\"nofollow noreferrer\">ask</a> from a bundler console?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3180, "user_id": 3863146, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/34Tzj.png?s=128&g=1", "display_name": "sahil", "link": "https://stackoverflow.com/users/3863146/sahil"}, "edited": false, "score": 0, "creation_date": 1479317020, "post_id": 40638357, "comment_id": 68509052, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/1013152/one-controller-rendering-using-another-controllers-views\">One controller rendering using another controller&#39;s views</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3367, "user_id": 822256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ITN7.png?s=128&g=1", "display_name": "sa77", "link": "https://stackoverflow.com/users/822256/sa77"}, "is_accepted": false, "score": 0, "last_activity_date": 1479318247, "creation_date": 1479318247, "answer_id": 40638813, "question_id": 40638357, "link": "https://stackoverflow.com/questions/40638357/how-to-render-view-index-in-another-view-index/40638813#40638813", "title": "how to render view/index in another view/index?", "body": "<p>create a partial <code>app/views/shared/_index_table.html.erb</code> with the content</p>\n\n<pre><code>&lt;table class=\"table table-hover\"&gt;\n  &lt;thead&gt;\n    &lt;tr&gt;\n      &lt;th&gt;\u0412\u0440\u0435\u043c\u044f&lt;br&gt;\u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f&lt;/th&gt;\n      &lt;th&gt;\u0413\u043e\u0440\u043e\u0434&lt;/th&gt;\n      &lt;th&gt;\u041c\u0435\u0441\u0442\u043e&lt;br&gt; \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f&lt;/th&gt;\n      &lt;th&gt;\u0412\u0440\u0435\u043c\u044f &lt;br&gt;\u043f\u0440\u0438\u0431\u044b\u0442\u0438\u044f&lt;/th&gt;\n    &lt;/tr&gt;\n  &lt;/thead&gt;\n  &lt;tbody&gt;\n  &lt;% schedules.each do |s| %&gt;\n    &lt;tr&gt;\n      &lt;td&gt;&lt;%= s.deptime %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= s.city %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= s.street %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= s.aparttime %&gt;&lt;/td&gt;\n    &lt;/tr&gt; \n  &lt;% end %&gt;             \n  &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>Then, <code>app/views/schedules/index.html.erb</code></p>\n\n<pre><code>&lt;h1&gt;Schedules&lt;/h1&gt;\n&lt;%= render partial: \"shared/index_table\", :locals =&gt; { schedules: @welcomes } %&gt;\n</code></pre>\n\n<p>and  <code>app/views/welcomes/index.html.erb</code></p>\n\n<pre><code>&lt;h1&gt;Welcome&lt;/h1&gt;\n&lt;%= render partial: \"shared/index_table\", :locals =&gt; { schedules: @schedules } %&gt;\n</code></pre>\n\n<p>This works only if you have the same set of attributes (deptime, city, street, aparttime) on both <code>Welcome</code> and <code>Schedule</code> models</p>\n"}, {"tags": [], "owner": {"reputation": 166, "user_id": 7040027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37407cfccbfc6c2c6370a74c41fec074?s=128&d=identicon&r=PG", "display_name": "veldtmana", "link": "https://stackoverflow.com/users/7040027/veldtmana"}, "is_accepted": false, "score": 0, "last_activity_date": 1479320879, "creation_date": 1479320879, "answer_id": 40639595, "question_id": 40638357, "link": "https://stackoverflow.com/questions/40638357/how-to-render-view-index-in-another-view-index/40639595#40639595", "title": "how to render view/index in another view/index?", "body": "<p>To render the schedules index template from the welcomes_controller.rb</p>\n\n<pre><code>def index\n  @welcomes = Welcome.all\n  render \"/schedules/index\"\nend\n</code></pre>\n\n<p>However, this will present a problem because the table in the view depends on an <code>@schedules</code> instance variable to be set and it will return <code>nil</code> because it is not assigned a value in the controller.</p>\n\n<p>you might want to do this:</p>\n\n<pre><code>def index\n  @schedules = Welcome.all\n  render \"/schedules/index\"\nend\n</code></pre>\n\n<p>Which does not really make sense to me from a semantic point of view. You might want to rename the instance variable to something more model agnostic.</p>\n\n<p>In the other answer it was suggested to use a partial. That could actually be a better solution depending on the use case.</p>\n"}], "owner": {"reputation": 13, "user_id": 7162172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d27f7b8c22497b352da84b6d324d5a4f?s=128&d=identicon&r=PG&f=1", "display_name": "i pass", "link": "https://stackoverflow.com/users/7162172/i-pass"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 549, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1479326137, "creation_date": 1479316776, "last_edit_date": 1479326137, "question_id": 40638357, "link": "https://stackoverflow.com/questions/40638357/how-to-render-view-index-in-another-view-index", "title": "how to render view/index in another view/index?", "body": "<p>I dont understand how to insert code into my <strong>welcome/index.html.erb</strong> file.  Here is my code:</p>\n\n<h1>Welcomes_controller.rb</h1>\n\n<pre><code>def index\n  @welcomes = Welcome.all\nend\n</code></pre>\n\n<h1>Schedules_controller.rb</h1>\n\n<pre><code>def index\n  @schedules = Schedule.all\nend\n</code></pre>\n\n<h1>schedules/index.html.erb</h1>\n\n<pre><code>          &lt;table class=\"table table-hover\"&gt;\n            &lt;thead&gt;\n              &lt;tr&gt;\n                &lt;th&gt;\u0412\u0440\u0435\u043c\u044f&lt;br&gt;\u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f&lt;/th&gt;\n                &lt;th&gt;\u0413\u043e\u0440\u043e\u0434&lt;/th&gt;\n                &lt;th&gt;\u041c\u0435\u0441\u0442\u043e&lt;br&gt; \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f&lt;/th&gt;\n                &lt;th&gt;\u0412\u0440\u0435\u043c\u044f &lt;br&gt;\u043f\u0440\u0438\u0431\u044b\u0442\u0438\u044f&lt;/th&gt;\n              &lt;/tr&gt;\n            &lt;/thead&gt;\n            &lt;tbody&gt;\n            &lt;% @schedules.each do |s| %&gt;\n              &lt;tr&gt;\n                &lt;td&gt;&lt;%= s.deptime %&gt;&lt;/td&gt;\n                &lt;td&gt;&lt;%= s.city %&gt;&lt;/td&gt;\n                &lt;td&gt;&lt;%= s.street %&gt;&lt;/td&gt;\n                &lt;td&gt;&lt;%= s.aparttime %&gt;&lt;/td&gt;\n              &lt;/tr&gt; \n            &lt;% end %&gt;             \n            &lt;/tbody&gt;\n          &lt;/table&gt;\n</code></pre>\n\n<p>How do I insert that code into welcome/index.html.erb?</p>\n"}, {"tags": ["ruby", "rubygems"], "comments": [{"owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "edited": false, "score": 0, "creation_date": 1479315781, "post_id": 40637825, "comment_id": 68508209, "body": "<code>initialize</code> is just a normal method which happens to be called by <code>Class#new</code> when creating objects. It&#39;s perfectly valid using splat in <code>initialize</code>."}, {"owner": {"reputation": 2386, "user_id": 2933305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/223ba397b1fef4a7bec7bfc59ca74f11?s=128&d=identicon&r=PG", "display_name": "maicher", "link": "https://stackoverflow.com/users/2933305/maicher"}, "reply_to_user": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "edited": false, "score": 0, "creation_date": 1479315947, "post_id": 40637825, "comment_id": 68508319, "body": "Yes, but my question is, how to achieve that using attr_extras gem. <code>attr_private_initialize :*bar</code> doesn&#39;t work."}], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 1, "last_activity_date": 1479316620, "last_edit_date": 1479316620, "creation_date": 1479316300, "answer_id": 40638209, "question_id": 40637825, "link": "https://stackoverflow.com/questions/40637825/splat-operator-and-attr-extras-gem/40638209#40638209", "title": "Splat (*) operator and attr_extras gem", "body": "<p>No, it does not support that. Here's <a href=\"https://github.com/barsoom/attr_extras/blob/c4954f592134cdbd712aa58ca8646f0007b3af35/lib/attr_extras/attr_initialize.rb#L17-L37\" rel=\"nofollow noreferrer\">the code</a>.</p>\n\n<p>In short, given the dynamic nature of initializer, it <em>already</em> defines all arguments as splatted array and then takes it apart into individual values (to be used in readers and whatnot). You can't have nested splats, so it's impossible to do with this gem (the current implementation, anyway).</p>\n\n<pre><code>klass.send(:define_method, :initialize) do |*values|\n  validate_arity.call(values.length, self.class)\n\n  names.zip(values).each do |name_or_names, value|\n    if name_or_names.is_a?(Array)\n      hash = value || {}\n\n      known_keys = name_or_names.map { |name| name.to_s.sub(/!\\z/, \"\").to_sym }\n      unknown_keys = hash.keys - known_keys\n      if unknown_keys.any?\n        raise ArgumentError, \"Got unknown keys: #{unknown_keys.inspect}; allowed keys: #{known_keys.inspect}\"\n      end\n\n      name_or_names.each do |name|\n        set_ivar_from_hash.call(self, name, hash)\n      end\n    else\n      name = name_or_names\n      instance_variable_set(\"@#{name}\", value)\n    end\n  end\n\n  if block\n    instance_eval(&amp;block)\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 2386, "user_id": 2933305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/223ba397b1fef4a7bec7bfc59ca74f11?s=128&d=identicon&r=PG", "display_name": "maicher", "link": "https://stackoverflow.com/users/2933305/maicher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 40638209, "answer_count": 1, "score": 0, "last_activity_date": 1479316620, "creation_date": 1479315241, "last_edit_date": 1479315986, "question_id": 40637825, "link": "https://stackoverflow.com/questions/40637825/splat-operator-and-attr-extras-gem", "title": "Splat (*) operator and attr_extras gem", "body": "<p>Some time ago I found that <a href=\"https://github.com/barsoom/attr_extras\" rel=\"nofollow noreferrer\">attr_extras</a> gem can be used for creating class attributes.</p>\n\n<p>Writing:</p>\n\n<pre><code>class Foo\n  attr_private_initialize :bar\nend\n</code></pre>\n\n<p>replaces:</p>\n\n<pre><code>class Foo\n  def initialize(bar)\n    @bar = bar\n  end\n\n  private\n\n  attr_reader :bar\nend\n</code></pre>\n\n<p>My question is, does <code>attr_extras</code> gem support handling splat (<code>*</code>) operators in constructors?</p>\n\n<p>I would like to get following result:</p>\n\n<pre><code>def initialize(*bar)\n  @bar = bar\nend\n</code></pre>\n\n<p>I don't see this functionality documented, so I think this is impossible, however maybe someone knows how to do it using this gem?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1479314332, "post_id": 40637441, "comment_id": 68507168, "body": "I&#39;m confused. Do you or do you not expect it to print two lines? Because it does print two lines."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1479314542, "post_id": 40637441, "comment_id": 68507337, "body": "The question has nothing to do with proc"}, {"owner": {"reputation": 175, "user_id": 4840474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88b9685b5ecedfa95ef26343edb0f2f6?s=128&d=identicon&r=PG&f=1", "display_name": "Vivak kumar", "link": "https://stackoverflow.com/users/4840474/vivak-kumar"}, "edited": false, "score": 0, "creation_date": 1479314566, "post_id": 40637441, "comment_id": 68507358, "body": "But why does it print two lines?. please help me"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1479314615, "post_id": 40637441, "comment_id": 68507390, "body": "@Vivakkumar: because that&#39;s what you have in the code. Two prints."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1479314757, "post_id": 40637441, "comment_id": 68507508, "body": "BTW, in Ruby there&#39;s also a global function called <a href=\"http://ruby-doc.org/core-2.3.1/Kernel.html#method-i-print\" rel=\"nofollow noreferrer\"><code>print</code></a>. You should pick another name for your method to avoid further confusion."}, {"owner": {"reputation": 175, "user_id": 4840474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88b9685b5ecedfa95ef26343edb0f2f6?s=128&d=identicon&r=PG&f=1", "display_name": "Vivak kumar", "link": "https://stackoverflow.com/users/4840474/vivak-kumar"}, "edited": false, "score": 0, "creation_date": 1479315112, "post_id": 40637441, "comment_id": 68507738, "body": "Thanks serigo for the help"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1479314458, "post_id": 40637521, "comment_id": 68507267, "body": "The method is called <code>print</code>. It&#39;d be weird if it didn&#39;t actually print, one would argue :)"}, {"owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1479314631, "post_id": 40637521, "comment_id": 68507402, "body": "@SergioTulentsev Sure, my mistake) Thank you!)"}], "tags": [], "owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1479314533, "last_edit_date": 1479314533, "creation_date": 1479314424, "answer_id": 40637521, "question_id": 40637441, "link": "https://stackoverflow.com/questions/40637441/why-do-i-get-two-lines-of-output-from-this-code/40637521#40637521", "title": "Why do I get two lines of output from this code?", "body": "<pre><code>a = Proc.new do\n  class A\n    def initialize d\n      @c = d\n    end\n\n    def print\n     p @c\n    end\n  end\n\n  b = A.new(2)\n  b.print #you need just to call method print\nend\n\na.call\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 2, "last_activity_date": 1479314431, "creation_date": 1479314431, "answer_id": 40637523, "question_id": 40637441, "link": "https://stackoverflow.com/questions/40637441/why-do-i-get-two-lines-of-output-from-this-code/40637523#40637523", "title": "Why do I get two lines of output from this code?", "body": "<blockquote>\n  <p>why does the following ruby program prints the output for two times?</p>\n</blockquote>\n\n<p>This is the first print</p>\n\n<pre><code>p @c\n</code></pre>\n\n<p>Result of this will become return value of method <code>print</code>, which will then be printed in turn</p>\n\n<pre><code>p b.print\n</code></pre>\n\n<p>Method <code>p</code> returns the value printed. That's how you get two lines with the same output.</p>\n"}, {"tags": [], "owner": {"reputation": 3363, "user_id": 2876504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f861d39e1561dc8147fc6442d1235e8?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro C.", "link": "https://stackoverflow.com/users/2876504/alejandro-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1479314484, "creation_date": 1479314484, "answer_id": 40637549, "question_id": 40637441, "link": "https://stackoverflow.com/questions/40637441/why-do-i-get-two-lines-of-output-from-this-code/40637549#40637549", "title": "Why do I get two lines of output from this code?", "body": "<p>In ruby, <code>p</code> both prints its argument and returns it, so <code>b.print</code> both prints and returns 2; then <code>p b.print</code> prints 2 again.</p>\n"}, {"tags": [], "owner": {"reputation": 124, "user_id": 6883622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PuSGA.jpg?s=128&g=1", "display_name": "Dante Lacerda", "link": "https://stackoverflow.com/users/6883622/dante-lacerda"}, "is_accepted": false, "score": 0, "last_activity_date": 1479314589, "creation_date": 1479314589, "answer_id": 40637590, "question_id": 40637441, "link": "https://stackoverflow.com/questions/40637441/why-do-i-get-two-lines-of-output-from-this-code/40637590#40637590", "title": "Why do I get two lines of output from this code?", "body": "<p>The command \"p\" on Ruby means you wants to \"print\" something...Your code does the \"p\" command twice. Just remove the unwanted and it will work.</p>\n\n<pre><code>a = Proc.new do\n  class A\n    def initialize d\n      @c = d\n    end\n\n    def print\n     p @c #FIRST PRINT\n    end\n  end\n\n  b = A.new(2)\n  p b.print #SECOND PRINT\nend\n\na.call\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 4840474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88b9685b5ecedfa95ef26343edb0f2f6?s=128&d=identicon&r=PG&f=1", "display_name": "Vivak kumar", "link": "https://stackoverflow.com/users/4840474/vivak-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 40637523, "answer_count": 4, "score": -1, "last_activity_date": 1479314589, "creation_date": 1479314181, "last_edit_date": 1479314561, "question_id": 40637441, "link": "https://stackoverflow.com/questions/40637441/why-do-i-get-two-lines-of-output-from-this-code", "title": "Why do I get two lines of output from this code?", "body": "<p>why does the following ruby program prints the output for two times? </p>\n\n<pre><code>a = Proc.new do\n  class A\n    def initialize d\n      @c = d\n    end\n\n    def print\n      p @c\n    end\n  end\n\n  b = A.new(2)\n  p b.print\nend\n\na.call\n</code></pre>\n\n<p>Real output</p>\n\n<pre><code>2\n2\n</code></pre>\n\n<p>Expected output</p>\n\n<pre><code>2\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7167378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/362139c82e29391e0d29285cf7969545?s=128&d=identicon&r=PG&f=1", "display_name": "neonamo", "link": "https://stackoverflow.com/users/7167378/neonamo"}, "edited": false, "score": 0, "creation_date": 1479374472, "post_id": 40638068, "comment_id": 68533185, "body": "Thank you so much! It&#39;s an excellent explanation. But it returns undefined method `split&#39; for #&lt;Text:0x007fd21d6655c0&gt; I know if I am not wrong I need to define words which I did. But no success."}, {"owner": {"reputation": 3367, "user_id": 822256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ITN7.png?s=128&g=1", "display_name": "sa77", "link": "https://stackoverflow.com/users/822256/sa77"}, "reply_to_user": {"reputation": 15, "user_id": 7167378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/362139c82e29391e0d29285cf7969545?s=128&d=identicon&r=PG&f=1", "display_name": "neonamo", "link": "https://stackoverflow.com/users/7167378/neonamo"}, "edited": false, "score": 0, "creation_date": 1479374770, "post_id": 40638068, "comment_id": 68533399, "body": "updated the answer.. it should be <code>self.description.split</code> (self is the Text object, i believe you&#39;re splitting the description attribute of the Text object) @neonamo"}, {"owner": {"reputation": 15, "user_id": 7167378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/362139c82e29391e0d29285cf7969545?s=128&d=identicon&r=PG&f=1", "display_name": "neonamo", "link": "https://stackoverflow.com/users/7167378/neonamo"}, "edited": false, "score": 0, "creation_date": 1479375380, "post_id": 40638068, "comment_id": 68533805, "body": "yes, you are very right! You are great! @sa77 And now I am facing this error unknown attribute &#39;text_id&#39; for Word."}, {"owner": {"reputation": 3367, "user_id": 822256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ITN7.png?s=128&g=1", "display_name": "sa77", "link": "https://stackoverflow.com/users/822256/sa77"}, "reply_to_user": {"reputation": 15, "user_id": 7167378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/362139c82e29391e0d29285cf7969545?s=128&d=identicon&r=PG&f=1", "display_name": "neonamo", "link": "https://stackoverflow.com/users/7167378/neonamo"}, "edited": false, "score": 0, "creation_date": 1479375689, "post_id": 40638068, "comment_id": 68534044, "body": "i think that should have been covered .. you should have a foreign key of texts table (i.e <code>text_id</code>) in your <code>words</code> table with <code>belongs_to :text</code> association on your <code>app&#47;models&#47;word.rb</code> file and <code>has_many :words, foreign_key: :text_id</code> on your <code>app&#47;models&#47;text.rb</code> file for this to work."}, {"owner": {"reputation": 15, "user_id": 7167378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/362139c82e29391e0d29285cf7969545?s=128&d=identicon&r=PG&f=1", "display_name": "neonamo", "link": "https://stackoverflow.com/users/7167378/neonamo"}, "edited": false, "score": 0, "creation_date": 1479376175, "post_id": 40638068, "comment_id": 68534436, "body": "Yes, exactly rails g migration AddTextToWords text:references I just added. And finally it works!!! You are awesome! Thank you so much!!!"}], "tags": [], "owner": {"reputation": 3367, "user_id": 822256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ITN7.png?s=128&g=1", "display_name": "sa77", "link": "https://stackoverflow.com/users/822256/sa77"}, "is_accepted": true, "score": 0, "last_activity_date": 1479374731, "last_edit_date": 1479374731, "creation_date": 1479315912, "answer_id": 40638068, "question_id": 40637085, "link": "https://stackoverflow.com/questions/40637085/how-to-create-an-object-from-array-by-calling-back-create-action-ruby-on-rails/40638068#40638068", "title": "How to create an object from array by calling back create action? Ruby on rails", "body": "<p><code>redirect_to</code> is a routes helper that are available in controllers. So, you should just work on model object on your model class. update your <code>create_words</code> method with the following content. </p>\n\n<pre><code>class Text &lt; ApplicationRecord\n  has_many :words\n  after_create :create_words\n\n\n  private\n    def create_words\n      # self is the Text object in context \n      # i.e the Text object on which after_create is called\n      words = self.description.split(/\\W+/)\n      words.each do |splitted|\n        self.words.create(name: splitted, translation: '')\n      end\n    end\n\nend\n</code></pre>\n\n<p>So every time you save save a <code>Text</code> object, <code>after_create :create_words</code> is triggered, which splits the <code>Text</code> object in context (<code>self</code>) and each word is iterated to create a new associated <code>Word</code> object on your <code>words</code> table.</p>\n"}], "owner": {"reputation": 15, "user_id": 7167378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/362139c82e29391e0d29285cf7969545?s=128&d=identicon&r=PG&f=1", "display_name": "neonamo", "link": "https://stackoverflow.com/users/7167378/neonamo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 40638068, "answer_count": 1, "score": 0, "last_activity_date": 1479374731, "creation_date": 1479313102, "last_edit_date": 1479323994, "question_id": 40637085, "link": "https://stackoverflow.com/questions/40637085/how-to-create-an-object-from-array-by-calling-back-create-action-ruby-on-rails", "title": "How to create an object from array by calling back create action? Ruby on rails", "body": "<p>I am stuck at: I need to create a text and the same way I need to create a list of words out of the created text. So what I did:</p>\n\n<p>I created create action in my text controller:</p>\n\n<pre><code>def create\n  @text = Text.new(text_params)\n\n  if @text.save\n    redirect_to text_path(@text), notice: \"Text successfully created\"\n  else\n    render :new\n  end\nend  \n</code></pre>\n\n<p>Here is the form for creating a text:</p>\n\n<pre><code>&lt;%= form_for @text do |f| %&gt;\n    &lt;div class=\"form-group\"&gt;\n      &lt;label&gt;Text name&lt;/label&gt;\n      &lt;%= f.text_field :name %&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"form-group\"&gt;\n      &lt;label&gt;Description&lt;/label&gt;\n      &lt;%= f.text_area :description%&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"actions\"&gt;\n      &lt;%= f.submit \"Save\", class: \"btn btn-primary\" %&gt;\n    &lt;/div&gt;\n\n&lt;%end%&gt;\n</code></pre>\n\n<p>In the Text Model I created after_create callback:</p>\n\n<pre><code>class Text &lt; ApplicationRecord\n  has_many :words\n  after_create :create_words\n\n  def create_words\n\n    @word = Word.new( word_params )\n\n      @text.split(/\\W+/)\n      @text.each do |splitted|\n          if splitted != @words.name\n            splitted = @word\n            @word.save\n            redirect_to root_path\n          else\n            render :new\n          end\n      end\n  end\n\n\ndef word_params\n    params.require(:word).permit(:name, :translation)\n end\n\nend \n</code></pre>\n\n<p>I am new to RoR and Please help me out to fix my issue. Basicly what I need is when I am creating text for instance a text is: </p>\n\n<blockquote>\n  <p>I have a dog</p>\n</blockquote>\n\n<p>should be placed on my <code>texts</code> table and each word:</p>\n\n<blockquote>\n  <p>I, have, a, dog</p>\n</blockquote>\n\n<p>should be placed in my <code>words</code> table in the database. </p>\n\n<p>Thank you very much in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 7168458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f23f20233e56f4aa9382fa04ce4b7340?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin77", "link": "https://stackoverflow.com/users/7168458/kevin77"}, "edited": false, "score": 0, "creation_date": 1479314421, "post_id": 40637314, "comment_id": 68507243, "body": "No... I want to create a NEW relationship between Mr X and Mr Y. For example to see (on the Mr X &quot;dashboard&quot;, the other posts made by Mr Y)"}, {"owner": {"reputation": 1456, "user_id": 2295410, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/PYmkM.png?s=128&g=1", "display_name": "Alex.U", "link": "https://stackoverflow.com/users/2295410/alex-u"}, "reply_to_user": {"reputation": 5, "user_id": 7168458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f23f20233e56f4aa9382fa04ce4b7340?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin77", "link": "https://stackoverflow.com/users/7168458/kevin77"}, "edited": false, "score": 0, "creation_date": 1479314654, "post_id": 40637314, "comment_id": 68507424, "body": "You could have a <code>friends</code> relationship one_to_many, this way in X&#39;s dashboard you can access to Y posts if they&#39;re friends as: <code>x.friends.find(user: y).posts</code>"}, {"owner": {"reputation": 1456, "user_id": 2295410, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/PYmkM.png?s=128&g=1", "display_name": "Alex.U", "link": "https://stackoverflow.com/users/2295410/alex-u"}, "reply_to_user": {"reputation": 5, "user_id": 7168458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f23f20233e56f4aa9382fa04ce4b7340?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin77", "link": "https://stackoverflow.com/users/7168458/kevin77"}, "edited": false, "score": 0, "creation_date": 1479314714, "post_id": 40637314, "comment_id": 68507476, "body": "since <code>user has_many posts</code> the later snippet should work once you set the relationship."}, {"owner": {"reputation": 5, "user_id": 7168458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f23f20233e56f4aa9382fa04ce4b7340?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin77", "link": "https://stackoverflow.com/users/7168458/kevin77"}, "edited": false, "score": 0, "creation_date": 1479315193, "post_id": 40637314, "comment_id": 68507799, "body": "has_many :posts, -&gt; { where liked_posts.user }, :through =&gt; :likes ??"}, {"owner": {"reputation": 1456, "user_id": 2295410, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/PYmkM.png?s=128&g=1", "display_name": "Alex.U", "link": "https://stackoverflow.com/users/2295410/alex-u"}, "reply_to_user": {"reputation": 5, "user_id": 7168458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f23f20233e56f4aa9382fa04ce4b7340?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin77", "link": "https://stackoverflow.com/users/7168458/kevin77"}, "edited": false, "score": 0, "creation_date": 1479316257, "post_id": 40637314, "comment_id": 68508545, "body": "Yes, conditional associations should work as well <code>has_many :posts, -&gt; (other_user){ where(user: other_user) }, through: :likes</code> so you can do <code>x = User.first; x.posts(y)</code>"}, {"owner": {"reputation": 1456, "user_id": 2295410, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/PYmkM.png?s=128&g=1", "display_name": "Alex.U", "link": "https://stackoverflow.com/users/2295410/alex-u"}, "reply_to_user": {"reputation": 5, "user_id": 7168458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f23f20233e56f4aa9382fa04ce4b7340?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin77", "link": "https://stackoverflow.com/users/7168458/kevin77"}, "edited": false, "score": 0, "creation_date": 1479316517, "post_id": 40637314, "comment_id": 68508712, "body": "So you can call that new relationship <code>related_posts</code> instead of <code>posts</code>, and still add the <code>has_many :posts</code>. Both should co-exist"}, {"owner": {"reputation": 1456, "user_id": 2295410, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/PYmkM.png?s=128&g=1", "display_name": "Alex.U", "link": "https://stackoverflow.com/users/2295410/alex-u"}, "reply_to_user": {"reputation": 5, "user_id": 7168458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f23f20233e56f4aa9382fa04ce4b7340?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin77", "link": "https://stackoverflow.com/users/7168458/kevin77"}, "edited": false, "score": 0, "creation_date": 1479317619, "post_id": 40637314, "comment_id": 68509454, "body": "It&#39;s a parameter of the scope (lambda)"}], "tags": [], "owner": {"reputation": 1456, "user_id": 2295410, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/PYmkM.png?s=128&g=1", "display_name": "Alex.U", "link": "https://stackoverflow.com/users/2295410/alex-u"}, "is_accepted": true, "score": 0, "last_activity_date": 1479313811, "creation_date": 1479313811, "answer_id": 40637314, "question_id": 40637063, "link": "https://stackoverflow.com/questions/40637063/ruby-on-rails-relationship-with-has-many/40637314#40637314", "title": "Ruby on Rails : relationship with &quot;has_many&quot;", "body": "<p>I'm not 100% certain if you mean this, but in case you want to relate <code>User</code> with <code>Post</code> through <code>Like</code> then proceed as:</p>\n\n<p>user.rb</p>\n\n<pre><code>has_many :posts\nhas_many :likes\nhas_many :liked_posts, through: :likes\n</code></pre>\n\n<p>post.rb</p>\n\n<pre><code>has_many :likes\n\ndef liked_by?(user)\n  self.likes.where(user: user).any?\nend\n</code></pre>\n\n<p>likes.rb</p>\n\n<pre><code>belongs_to :user\nbelongs_to :post\n</code></pre>\n\n<p>You'd have to add the respective database migrations to add the attributes to <code>likes</code></p>\n"}], "owner": {"reputation": 5, "user_id": 7168458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f23f20233e56f4aa9382fa04ce4b7340?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin77", "link": "https://stackoverflow.com/users/7168458/kevin77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 40637314, "answer_count": 1, "score": 0, "last_activity_date": 1479313811, "creation_date": 1479313032, "question_id": 40637063, "link": "https://stackoverflow.com/questions/40637063/ruby-on-rails-relationship-with-has-many", "title": "Ruby on Rails : relationship with &quot;has_many&quot;", "body": "<p>Mr X likes only one post made by Mr Y</p>\n\n<p>How can I create a relationship between Mr X and Mr Y to see the Mr Y's posts? (to see the suggested posts)</p>\n\n<p>user.rb</p>\n\n<pre><code>  has_many :posts\n  has_many :liked_posts, through: :liked, source: :post\n</code></pre>\n\n<p>post.rb</p>\n\n<pre><code>  def liked_by?(user)\n    likes.where(user: user).any?\n  end\n</code></pre>\n\n<p>likes.rb</p>\n\n<pre><code>#  id         :integer          not null, primary key\n#  user_id    :integer          not null\n#  like_id    :integer          not null\n</code></pre>\n\n<p>Should I use uniq ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "model-view-controller"], "answers": [{"comments": [{"owner": {"reputation": 306, "user_id": 5007156, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lA3OI.jpg?s=128&g=1", "display_name": "Mike Wiesenhart", "link": "https://stackoverflow.com/users/5007156/mike-wiesenhart"}, "edited": false, "score": 1, "creation_date": 1479312816, "post_id": 40636794, "comment_id": 68506121, "body": "I wasn&#39;t sure if I could do that in the controller. Thanks for the help, works great!"}], "tags": [], "owner": {"reputation": 1456, "user_id": 2295410, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/PYmkM.png?s=128&g=1", "display_name": "Alex.U", "link": "https://stackoverflow.com/users/2295410/alex-u"}, "is_accepted": true, "score": 3, "last_activity_date": 1479312369, "creation_date": 1479312369, "answer_id": 40636794, "question_id": 40636522, "link": "https://stackoverflow.com/questions/40636522/bad-redirect-on-create-method-rails-4/40636794#40636794", "title": "Bad Redirect On Create Method - Rails 4", "body": "<p>Since it is a nested resource you have to add the id of the parent element. Try:</p>\n\n<p><code>manage_photo_listing(@listing)</code></p>\n\n<p>so it can actually use the id of <code>@listing</code> and build the route</p>\n"}], "owner": {"reputation": 306, "user_id": 5007156, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lA3OI.jpg?s=128&g=1", "display_name": "Mike Wiesenhart", "link": "https://stackoverflow.com/users/5007156/mike-wiesenhart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 40636794, "answer_count": 1, "score": 0, "last_activity_date": 1479312369, "creation_date": 1479311718, "question_id": 40636522, "link": "https://stackoverflow.com/questions/40636522/bad-redirect-on-create-method-rails-4", "title": "Bad Redirect On Create Method - Rails 4", "body": "<p>I am trying to change the redirect when I create a listing, but I keep getting a <code>No route matches {:action=&gt;\"manage_photos\", :controller=&gt;\"listings\"} missing required keys: [:id]</code>. What am I missing? My route is nested and there is a <code>manage_photos</code> method in my controller. Not sure where to go from here.</p>\n\n<p>routes.rb</p>\n\n<pre><code>resources :listings do\n  member do\n    get 'like'\n    get 'unlike'\n    get 'duplicate'\n    get 'gallery'\n    delete 'gallery' =&gt; 'listings#clear_gallery'\n    get 'manage_photos'\n    get 'craigslist'\n    get \"add_to_collection\"\n    get 'request_photos'\n    get 'rsvp'\n  end\nend\n</code></pre>\n\n<p>rake routes:</p>\n\n<pre><code>manage_photos_listing GET  /listings/:id/manage_photos(.:format)  listings#manage_photos\n</code></pre>\n\n<p>listings_controller:</p>\n\n<p>create method:</p>\n\n<pre><code>def create\n  @listing = Listing.new(listing_params)\n\n  respond_to do |format|\n    if @listing.save\n      format.html { redirect_to manage_photos_listing_path, notice: 'Listing was successfully created.' }\n      format.json { render json: @listing, status: :created, location: @listing }\n    else\n      format.html { render action: \"new\", notice: \"Correct the mistakes below to create the new listing\" }\n      format.json { render json: @listing.errors, status: :unprocessable_entity }\n    end\n  end\nend\n</code></pre>\n\n<p>manage_photos method:</p>\n\n<pre><code>def manage_photos\n  @listing = Listing.find(params[:id])\nend\n</code></pre>\n\n<p>error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/JUF1F.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JUF1F.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nokogiri"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1479316640, "post_id": 40636494, "comment_id": 68508804, "body": "Please read &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 1238, "user_id": 5501716, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NUNlx.jpg?s=128&g=1", "display_name": "Alex Zakruzhetskyi", "link": "https://stackoverflow.com/users/5501716/alex-zakruzhetskyi"}, "edited": false, "score": 0, "creation_date": 1479312974, "post_id": 40636663, "comment_id": 68506237, "body": "<code>page.css(&#39;.rt-article p&#39;).slice(0...-2).text</code> works perfectly, thanks!"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1479331909, "post_id": 40636663, "comment_id": 68517463, "body": "<code>..</code> is preferable over <code>...</code>. It&#39;s a readability and maintenance thing. <code>0..-3</code> vs. <code>0...-2</code>: Which requires more mental gymnastics to figure out what&#39;s happening?"}], "tags": [], "owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "is_accepted": true, "score": 2, "last_activity_date": 1479469991, "last_edit_date": 1479469991, "creation_date": 1479312072, "answer_id": 40636663, "question_id": 40636494, "link": "https://stackoverflow.com/questions/40636494/is-it-possible-not-to-get-two-last-elements-via-nokogiri/40636663#40636663", "title": "Is it possible not to get two last elements via nokogiri?", "body": "<p>Yes,</p>\n\n<pre><code>page.css('.rt-article p').slice(0...-2).text\n</code></pre>\n\n<p>Notice, there are three dots.</p>\n"}], "owner": {"reputation": 1238, "user_id": 5501716, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NUNlx.jpg?s=128&g=1", "display_name": "Alex Zakruzhetskyi", "link": "https://stackoverflow.com/users/5501716/alex-zakruzhetskyi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 40636663, "answer_count": 1, "score": 1, "last_activity_date": 1479469991, "creation_date": 1479311663, "last_edit_date": 1479316450, "question_id": 40636494, "link": "https://stackoverflow.com/questions/40636494/is-it-possible-not-to-get-two-last-elements-via-nokogiri", "title": "Is it possible not to get two last elements via nokogiri?", "body": "<p>I want to take all <code>&lt;p&gt;</code> elements, using this code:</p>\n\n<pre><code>novelty.body = page.css('.rt-article p').text\n</code></pre>\n\n<p>but I don't want to get last two <code>&lt;p&gt;</code> elements. Is it possible to do?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "open-uri"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1479313671, "post_id": 40636423, "comment_id": 68506713, "body": "The first thing to know is that OpenURI is one of the most used pieces of code in Ruby&#39;s HTTP toolkit, and it has a lot of scrutiny and testing. As a result, the odds are <i>REALLY</i> good it&#39;s doing what it&#39;s supposed to. So let&#39;s turn this around and do it the Stack Overflow way: show us what you&#39;re doing and explain why you think it&#39;s not doing what you want. See &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot; and &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; including the linked pages."}], "answers": [{"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 3, "last_activity_date": 1479314139, "last_edit_date": 1479314139, "creation_date": 1479313671, "answer_id": 40637259, "question_id": 40636423, "link": "https://stackoverflow.com/questions/40636423/how-to-send-custom-headers-in-openuri-ruby-and-check-them/40637259#40637259", "title": "How to send custom headers in OpenURI (Ruby) and check them", "body": "<blockquote>\n  <p>Can someone tell how to check whether they [the additional header fields] are properly working.</p>\n</blockquote>\n\n<p>You could use <a href=\"https://en.wikipedia.org/wiki/Netcat\" rel=\"nofollow noreferrer\">netcat</a> to listen on a specific port, say 2000:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ nc -l 2000\n</code></pre>\n\n<p>And change the host accordingly to <code>localhost:2000</code>:</p>\n\n<pre><code># open.rb\nrequire 'open-uri'\n\nopen(\"http://localhost:2000/\",\n  \"User-Agent\" =&gt; \"Ruby/#{RUBY_VERSION}\",\n  \"From\" =&gt; \"foo@bar.invalid\",\n  \"Referer\" =&gt; \"http://www.ruby-lang.org/\") {|f|\n   # ...\n}\n</code></pre>\n\n<p>Running the program via</p>\n\n<pre><code>$ ruby open.rb\n</code></pre>\n\n<p>Will make netcat show this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ nc -l 2000\nGET / HTTP/1.1\nUser-Agent: Ruby/2.3.1\nFrom: foo@bar.invalid\nReferer: http://www.ruby-lang.org/\nAccept-Encoding: gzip;q=1.0,deflate;q=0.6,identity;q=0.3\nAccept: */*\nHost: localhost:2000\n</code></pre>\n\n<p>Apparently, the headers are working properly. (of course they do)</p>\n"}], "owner": {"reputation": 21, "user_id": 1732010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e40542871a2fb885623d0f2f3e248b08?s=128&d=identicon&r=PG", "display_name": "user1732010", "link": "https://stackoverflow.com/users/1732010/user1732010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 822, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1479319131, "creation_date": 1479311447, "last_edit_date": 1592644375, "question_id": 40636423, "link": "https://stackoverflow.com/questions/40636423/how-to-send-custom-headers-in-openuri-ruby-and-check-them", "title": "How to send custom headers in OpenURI (Ruby) and check them", "body": "<p>Found this in the following doc: <a href=\"https://ruby-doc.org/stdlib-2.1.0/libdoc/open-uri/rdoc/OpenURI.html\" rel=\"nofollow noreferrer\">https://ruby-doc.org/stdlib-2.1.0/libdoc/open-uri/rdoc/OpenURI.html</a></p>\n<blockquote>\n<p>Additional header fields can be specified by an optional hash argument.</p>\n<pre><code> open(&quot;http://www.ruby-lang.org/en/&quot;,\n   &quot;User-Agent&quot; =&gt; &quot;Ruby/#{RUBY_VERSION}&quot;,\n   &quot;From&quot; =&gt; &quot;foo@bar.invalid&quot;,\n   &quot;Referer&quot; =&gt; &quot;http://www.ruby-lang.org/&quot;) {|f|\n   # ...\n }\n</code></pre>\n</blockquote>\n<p>Can someone tell me how to check whether this is working properly?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 2296261, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ebaf5e45b69df91d7a80c267cd9bc55e?s=128&d=identicon&r=PG", "display_name": "BigRedEd", "link": "https://stackoverflow.com/users/2296261/bigreded"}, "edited": false, "score": 0, "creation_date": 1479410950, "post_id": 40637766, "comment_id": 68557934, "body": "Thanks man.  This did the trick.  In the future i&#39;ll take better care of my route creations, but for now, this gets me through what I need."}, {"owner": {"reputation": 1704, "user_id": 3723506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wHveY.jpg?s=128&g=1", "display_name": "Rashmirathi", "link": "https://stackoverflow.com/users/3723506/rashmirathi"}, "reply_to_user": {"reputation": 97, "user_id": 2296261, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ebaf5e45b69df91d7a80c267cd9bc55e?s=128&d=identicon&r=PG", "display_name": "BigRedEd", "link": "https://stackoverflow.com/users/2296261/bigreded"}, "edited": false, "score": 0, "creation_date": 1479413143, "post_id": 40637766, "comment_id": 68559244, "body": "No problem, I am glad I could help :)"}], "tags": [], "owner": {"reputation": 1704, "user_id": 3723506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wHveY.jpg?s=128&g=1", "display_name": "Rashmirathi", "link": "https://stackoverflow.com/users/3723506/rashmirathi"}, "is_accepted": true, "score": 1, "last_activity_date": 1479315093, "creation_date": 1479315093, "answer_id": 40637766, "question_id": 40636248, "link": "https://stackoverflow.com/questions/40636248/rails-routing-with-hyphenated-name-in-path/40637766#40637766", "title": "Rails routing with hyphenated name in path", "body": "<p>One way I can think of accomplishing this is by doing something like this:</p>\n\n<pre><code># routes.rb\nget '/team/:full_name', to: 'home#employee', as: :employee\n</code></pre>\n\n<p>And then you can use regex to split the <code>full_name</code></p>\n\n<pre><code># home_controller.rb\nclass HomeController\n  private\n\n  def name\n    # The regex below assumes that first name can't have hyphens.\n    match_data = params[:full_name].match(/([^-]*)-(.*-?.*)/) \n    {\n      first_name: match_data[1],\n      second_name: match_data[2]\n    }\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 2296261, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ebaf5e45b69df91d7a80c267cd9bc55e?s=128&d=identicon&r=PG", "display_name": "BigRedEd", "link": "https://stackoverflow.com/users/2296261/bigreded"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "accepted_answer_id": 40637766, "answer_count": 1, "score": 0, "last_activity_date": 1479315093, "creation_date": 1479311016, "question_id": 40636248, "link": "https://stackoverflow.com/questions/40636248/rails-routing-with-hyphenated-name-in-path", "title": "Rails routing with hyphenated name in path", "body": "<p>Im having trouble with some routing due to a user with a hyphenated last name.</p>\n\n<p>My route reads</p>\n\n<pre><code>    get '/team/:first_name-:last_name', to: 'home#employee', as: :employee\n</code></pre>\n\n<p>For something like \"/john-smith\" this would obviously work fine, but for an employee with a hyphenated last name such as \"Sarah Jane-Smith\" that results in \"/sarah-jane-smith.\" </p>\n\n<p>Rails is splitting on the second hyphen, which throws an error as that name doesnt exist.</p>\n\n<pre><code>    SELECT  \"employees\".* FROM \"employees\" WHERE (first_name = 'sarah-jane' AND last_name = 'smith')\n</code></pre>\n\n<p>Is there a simple way to change the route interpretation without having to overhaul my routing for employees?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ruby", "string", "escaping", "user-data"], "comments": [{"owner": {"reputation": 424, "user_id": 406835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cbae80f1ea00408841fcd67312ba365?s=128&d=identicon&r=PG", "display_name": "Dmitry Z.", "link": "https://stackoverflow.com/users/406835/dmitry-z"}, "edited": false, "score": 0, "creation_date": 1479310437, "post_id": 40635911, "comment_id": 68504412, "body": "It&#39;s correct ruby behaviour. When you puts your string with double \\, you will see only one."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1479310696, "post_id": 40635911, "comment_id": 68504593, "body": "what&#39;s &quot;scaping characters&quot;?"}, {"owner": {"reputation": 424, "user_id": 406835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cbae80f1ea00408841fcd67312ba365?s=128&d=identicon&r=PG", "display_name": "Dmitry Z.", "link": "https://stackoverflow.com/users/406835/dmitry-z"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1479310974, "post_id": 40635911, "comment_id": 68504782, "body": "@SergioTulentsev I think you should read this as escaping"}, {"owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "edited": false, "score": 0, "creation_date": 1479311264, "post_id": 40635911, "comment_id": 68504980, "body": "If I use two \\\\ it keeps them both. :("}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1479311402, "post_id": 40635911, "comment_id": 68505082, "body": "@LeticiaEsperon no, it doesn&#39;t. It <i>shows</i> two backslashes when you are inspecting the string, but the string contains only one backslash: <code>&quot;\\\\&quot;.size #=&gt; 1</code>"}, {"owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "edited": false, "score": 0, "creation_date": 1479312129, "post_id": 40635911, "comment_id": 68505595, "body": "Oh!! That&#39;s right. Thank you very much, that was the information I was lacking."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1479312585, "post_id": 40635911, "comment_id": 68505950, "body": "I&#39;d recommend reading <a href=\"http://stackoverflow.com/q/8554479/128421\">stackoverflow.com/q/8554479/128421</a> and <a href=\"https://en.wikipedia.org/wiki/Escape_character\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Escape_character</a>. This is well documented behavior."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1479312736, "post_id": 40635911, "comment_id": 68506063, "body": "I am not able to reproduce your problem: <code>&quot;\\\\&quot;.length #=&gt; 1</code>. Which version of Ruby are you using? Which implementation? How <i>exactly</i> are you constructing your <code>String</code>? Is it a literal? Does it come from somewhere else? Do you parse it? Generate it? Could there be a double parsing or double escaping bug somewhere in your code?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1479312884, "post_id": 40635911, "comment_id": 68506164, "body": "This question is different. The OP wants to enter / keep a multi-line string containing <code>&#39;</code> and <code>\\</code> (literally) as-is, without having to specifically quote anything."}], "answers": [{"comments": [{"owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "edited": false, "score": 0, "creation_date": 1479311188, "post_id": 40636204, "comment_id": 68504928, "body": "If I do that in Rails console it puts &lt;\\\\/Name&gt;"}, {"owner": {"reputation": 7638, "user_id": 1014251, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1c4500c91af486c885af8bb84eefd063?s=128&d=identicon&r=PG", "display_name": "ReggieB", "link": "https://stackoverflow.com/users/1014251/reggieb"}, "edited": false, "score": 0, "creation_date": 1479311233, "post_id": 40636204, "comment_id": 68504959, "body": "<code>&quot;</code> is used to define the string. The string starts <code>&quot;#!&#47;bin&#47;bash ...</code> and ends on the next line with <code>....Server.xml&quot;</code>"}, {"owner": {"reputation": 7638, "user_id": 1014251, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1c4500c91af486c885af8bb84eefd063?s=128&d=identicon&r=PG", "display_name": "ReggieB", "link": "https://stackoverflow.com/users/1014251/reggieb"}, "reply_to_user": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "edited": false, "score": 0, "creation_date": 1479311347, "post_id": 40636204, "comment_id": 68505040, "body": "It show that as the property of the string, but if you output it for (example <code>puts %q[&lt;\\&#47;Name&gt;]</code>) it will be formatted correctly"}, {"owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "edited": false, "score": 0, "creation_date": 1479311405, "post_id": 40636204, "comment_id": 68505084, "body": "Sorry, I didn&#39;t understand. The output of that code is .......&lt;\\\\/Name&gt;........"}, {"owner": {"reputation": 7638, "user_id": 1014251, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1c4500c91af486c885af8bb84eefd063?s=128&d=identicon&r=PG", "display_name": "ReggieB", "link": "https://stackoverflow.com/users/1014251/reggieb"}, "reply_to_user": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "edited": false, "score": 0, "creation_date": 1479311664, "post_id": 40636204, "comment_id": 68505270, "body": "Really? <code>puts %q[&lt;\\&#47;Name&gt;]</code> outputs <code>&lt;\\&#47;Name&gt;</code>"}, {"owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "edited": false, "score": 0, "creation_date": 1479312182, "post_id": 40636204, "comment_id": 68505640, "body": "I meant in the rails console without using puts. But you are right. The thing was I dind&#39;t know that it was showing two backslashes but they were actually just one!!"}], "tags": [], "owner": {"reputation": 7638, "user_id": 1014251, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1c4500c91af486c885af8bb84eefd063?s=128&d=identicon&r=PG", "display_name": "ReggieB", "link": "https://stackoverflow.com/users/1014251/reggieb"}, "is_accepted": true, "score": 1, "last_activity_date": 1479310883, "creation_date": 1479310883, "answer_id": 40636204, "question_id": 40635911, "link": "https://stackoverflow.com/questions/40635911/is-is-possible-to-create-a-string-in-ruby-that-keeps-escaping-characters/40636204#40636204", "title": "Is is possible to create a string in ruby that keeps escaping characters?", "body": "<p>You can use the <a href=\"http://blog.brzezinka.eu/webmaster-tips/ruby/alternative-stringss-delimiter-for-ruby-on-rails\" rel=\"nofollow noreferrer\"><code>%q</code> delimiter</a> rather than <code>\"</code>:</p>\n\n<pre><code>def user_data\n     %q[#!/bin/bash\n     sed -i -e '/&lt;Name&gt;loadbalanceServerIP&lt;\\/Name&gt;/,/&lt;Value&gt;/s/&lt;Value&gt;[^&lt;]*/&lt;Value&gt;1.1.1.1/' /home/wowza/conf/Server.xml]\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 0, "last_activity_date": 1479312331, "creation_date": 1479312331, "answer_id": 40636777, "question_id": 40635911, "link": "https://stackoverflow.com/questions/40635911/is-is-possible-to-create-a-string-in-ruby-that-keeps-escaping-characters/40636777#40636777", "title": "Is is possible to create a string in ruby that keeps escaping characters?", "body": "<p>I'd use a <a href=\"http://ruby-doc.org/core-2.3.1/doc/syntax/literals_rdoc.html#label-Here+Documents\" rel=\"nofollow noreferrer\">heredoc</a>:</p>\n\n<pre><code>def user_data\n  &lt;&lt;~'SH'\n    #!/bin/bash\n    sed -i -e '/&lt;Name&gt;loadbalanceServerIP&lt;\\/Name&gt;/,/&lt;Value&gt;/s/&lt;Value&gt;[^&lt;]*/&lt;Value&gt;1.1.1.1/' /home/wowza/conf/Server.xml\n  SH\nend\n\nputs user_data\n</code></pre>\n\n<p><code>~</code> removes the indentation, and the single quotes around <code>SH</code> disable interpolation and escaping.</p>\n\n<p>Output:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>#!/bin/bash\nsed -i -e '/&lt;Name&gt;loadbalanceServerIP&lt;\\/Name&gt;/,/&lt;Value&gt;/s/&lt;Value&gt;[^&lt;]*/&lt;Value&gt;1.1.1.1/' /home/wowza/conf/Server.xml\n</code></pre>\n"}], "owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "closed_date": 1479312653, "accepted_answer_id": 40636204, "answer_count": 2, "score": -1, "last_activity_date": 1479312331, "creation_date": 1479310029, "last_edit_date": 1479311276, "question_id": 40635911, "link": "https://stackoverflow.com/questions/40635911/is-is-possible-to-create-a-string-in-ruby-that-keeps-escaping-characters", "closed_reason": "Duplicate", "title": "Is is possible to create a string in ruby that keeps escaping characters?", "body": "<p>I need to form a user-data script from Ruby so I need all escaping characters to remain. When I do this:</p>\n\n<pre><code>  def user_data\n     \"#!/bin/bash\n     sed -i -e '/&lt;Name&gt;loadbalanceServerIP&lt;\\/Name&gt;/,/&lt;Value&gt;/s/&lt;Value&gt;[^&lt;]*/&lt;Value&gt;1.1.1.1/' /home/wowza/conf/Server.xml\"\n  end\n</code></pre>\n\n<p>The string removes the \\ in the Name tag. If I put two \\, it keeps them both. Any suggestion as how to keep the string the same way I wrote it?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 726, "user_id": 5444429, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ilkli8KLysI/AAAAAAAAAAI/AAAAAAAAAs0/O_XiRHBDJhI/photo.jpg?sz=128", "display_name": "johnnymnmonic", "link": "https://stackoverflow.com/users/5444429/johnnymnmonic"}, "edited": false, "score": 0, "creation_date": 1479309444, "post_id": 40635451, "comment_id": 68503667, "body": "Do it in a edit way (edit.html page) spite of a index form.  in the edit method of your controller call @settings = Setting.all. List in the same way into de edit.html including all the row into the form. edit and apply summit normaly. Implement yout update method in your controller, receive de params and persist all rows."}], "answers": [{"comments": [{"owner": {"reputation": 24638, "user_id": 302533, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6rsH5.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/302533/cameron"}, "edited": false, "score": 0, "creation_date": 1479310961, "post_id": 40635973, "comment_id": 68504773, "body": "That looks cool. Although I&#39;m getting the error: <code>no implicit conversion of Symbol into Integer</code> on this line: <code>setting_row = Setting.where(name: setting[:name]).first_or_initialize</code>"}, {"owner": {"reputation": 424, "user_id": 406835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cbae80f1ea00408841fcd67312ba365?s=128&d=identicon&r=PG", "display_name": "Dmitry Z.", "link": "https://stackoverflow.com/users/406835/dmitry-z"}, "reply_to_user": {"reputation": 24638, "user_id": 302533, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6rsH5.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/302533/cameron"}, "edited": false, "score": 0, "creation_date": 1479311047, "post_id": 40635973, "comment_id": 68504827, "body": "Please show me your params[:setting] in update action and I will help you."}, {"owner": {"reputation": 24638, "user_id": 302533, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6rsH5.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/302533/cameron"}, "edited": false, "score": 0, "creation_date": 1479311118, "post_id": 40635973, "comment_id": 68504878, "body": "<code>setting: [&quot;site_name&quot;, &quot;Cameron&quot;]</code>"}, {"owner": {"reputation": 424, "user_id": 406835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cbae80f1ea00408841fcd67312ba365?s=128&d=identicon&r=PG", "display_name": "Dmitry Z.", "link": "https://stackoverflow.com/users/406835/dmitry-z"}, "reply_to_user": {"reputation": 24638, "user_id": 302533, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6rsH5.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/302533/cameron"}, "edited": false, "score": 0, "creation_date": 1479311361, "post_id": 40635973, "comment_id": 68505047, "body": "params[:setting].each do |setting|     setting_row = Setting.where(name: setting.first).first_or_initialize     setting_row.update(seting.last)   end"}, {"owner": {"reputation": 24638, "user_id": 302533, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6rsH5.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/302533/cameron"}, "edited": false, "score": 0, "creation_date": 1479311474, "post_id": 40635973, "comment_id": 68505125, "body": "Doing that causes the error: <code>When assigning attributes, you must pass a hash as an argument.</code> on the update line."}], "tags": [], "owner": {"reputation": 424, "user_id": 406835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cbae80f1ea00408841fcd67312ba365?s=128&d=identicon&r=PG", "display_name": "Dmitry Z.", "link": "https://stackoverflow.com/users/406835/dmitry-z"}, "is_accepted": true, "score": 1, "last_activity_date": 1479311609, "last_edit_date": 1479311609, "creation_date": 1479310178, "answer_id": 40635973, "question_id": 40635451, "link": "https://stackoverflow.com/questions/40635451/form-field-per-table-row-in-rails/40635973#40635973", "title": "Form field per table row in Rails", "body": "<p>Your update action should look like</p>\n\n<pre><code>def update_settings\n  params[:setting].each do |setting|\n    setting_row = Setting.where(name: setting.first).first_or_initialize\n    setting_row.update(value: seting.last)\n  end\nend\n</code></pre>\n\n<p>I'm using .first_or_initialize method for possible use case when Setting with that name does not exist.</p>\n"}], "owner": {"reputation": 24638, "user_id": 302533, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6rsH5.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/302533/cameron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 730, "favorite_count": 0, "accepted_answer_id": 40635973, "answer_count": 1, "score": 1, "last_activity_date": 1479311609, "creation_date": 1479308713, "question_id": 40635451, "link": "https://stackoverflow.com/questions/40635451/form-field-per-table-row-in-rails", "title": "Form field per table row in Rails", "body": "<p>I have a settings table in my Rails app that has the following columns:</p>\n\n<p><code>id, name, value</code></p>\n\n<p>An example of some sample data might be:</p>\n\n<pre><code>id: 1,\nname: 'site_name'\nvalue: 'Cameron'\n\nid: 2\nname: 'email'\nvalue: 'cameron@example.com'\n</code></pre>\n\n<p>What I want to do is have a page where I list these settings as simple text fields that I can then edit and save back into the database.</p>\n\n<p>I have the following controller method that lists them:</p>\n\n<pre><code>def index\n    @settings = Setting.all\nend\n</code></pre>\n\n<p>And then display them in the view like so:</p>\n\n<pre><code>&lt;% @settings.each do |setting| %&gt;\n&lt;div class=\"form__group\"&gt;\n  &lt;label class=\"form__group__label\"&gt;&lt;%= setting.name %&gt;&lt;/label&gt;\n  &lt;div class=\"form__group__input\"&gt;\n    &lt;input type=\"text\" name=\"setting[&lt;%= setting.name %&gt;]\" value=\"&lt;%= setting.value %&gt;\"&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Which displays them fine. But how do I save them?</p>\n\n<p>I was thinking about looping through them in the controller like:</p>\n\n<pre><code>def update_settings\n  params[:setting].each do |setting|\n      # somehow update each param sent back...\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3050, "user_id": 1810434, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/498Wj.png?s=128&g=1", "display_name": "Joe Essey", "link": "https://stackoverflow.com/users/1810434/joe-essey"}, "edited": false, "score": 2, "creation_date": 1479306891, "post_id": 40634706, "comment_id": 68501842, "body": "You should create an <code>after_create</code> callback in the Text class.  Then you <code>.split</code> the text and check the presence of each word in the DB with <code>find_by_word</code> (Or whatever Word&#39;s attribute is for the word).  This functionality does not belong in the controller."}, {"owner": {"reputation": 15, "user_id": 7167378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/362139c82e29391e0d29285cf7969545?s=128&d=identicon&r=PG&f=1", "display_name": "neonamo", "link": "https://stackoverflow.com/users/7167378/neonamo"}, "reply_to_user": {"reputation": 3050, "user_id": 1810434, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/498Wj.png?s=128&g=1", "display_name": "Joe Essey", "link": "https://stackoverflow.com/users/1810434/joe-essey"}, "edited": false, "score": 0, "creation_date": 1479309195, "post_id": 40634706, "comment_id": 68503498, "body": "Thanks a lot for help! What I am doing wrong with .split can you suggest me please. I placed my code above"}, {"owner": {"reputation": 3050, "user_id": 1810434, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/498Wj.png?s=128&g=1", "display_name": "Joe Essey", "link": "https://stackoverflow.com/users/1810434/joe-essey"}, "edited": false, "score": 0, "creation_date": 1479322781, "post_id": 40634706, "comment_id": 68512389, "body": "You are splitting, but then trying to iterate over the whole <code>@text</code> value.  Try <code>@text.split(&#47;\\W+&#47;).each do |splitted|...</code>  Also you have to look up <code>splitted</code> in Word with something like (psuedocode) <code>if Word.where(value: splitted).empty? then save it</code>.  Based on what I see, I&#39;m not certain if the Word model exists, which I would recommend you create if not.  If you don&#39;t understand that I&#39;m afraid you have more fundamental problems to address, specifically creating Model Associations in Rails."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7167378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/362139c82e29391e0d29285cf7969545?s=128&d=identicon&r=PG&f=1", "display_name": "neonamo", "link": "https://stackoverflow.com/users/7167378/neonamo"}, "edited": false, "score": 0, "creation_date": 1479308101, "post_id": 40634790, "comment_id": 68502663, "body": "that is great but I am now having an issue with how I can split and add each word to my database"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 15, "user_id": 7167378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/362139c82e29391e0d29285cf7969545?s=128&d=identicon&r=PG&f=1", "display_name": "neonamo", "link": "https://stackoverflow.com/users/7167378/neonamo"}, "edited": false, "score": 0, "creation_date": 1479308421, "post_id": 40634790, "comment_id": 68502912, "body": "Well, that&#39;s a different question."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 1, "last_activity_date": 1479306885, "creation_date": 1479306885, "answer_id": 40634790, "question_id": 40634706, "link": "https://stackoverflow.com/questions/40634706/how-to-do-two-actions-in-one-action-of-the-controller/40634790#40634790", "title": "How to do two actions in one action of the controller", "body": "<p>The simplest way would be to do your words thing in an <code>after_create</code> callback.</p>\n\n<pre><code>class Text &lt; ApplicationRecord\n  after_create :create_words\n\n\n  private\n\n  def create_words\n    # do your thing here\n  end\nend\n</code></pre>\n\n<p><code>create_words</code> will be called when a Text is successfully created.</p>\n"}], "owner": {"reputation": 15, "user_id": 7167378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/362139c82e29391e0d29285cf7969545?s=128&d=identicon&r=PG&f=1", "display_name": "neonamo", "link": "https://stackoverflow.com/users/7167378/neonamo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 40634790, "answer_count": 1, "score": 1, "last_activity_date": 1479312818, "creation_date": 1479306661, "last_edit_date": 1479312818, "question_id": 40634706, "link": "https://stackoverflow.com/questions/40634706/how-to-do-two-actions-in-one-action-of-the-controller", "title": "How to do two actions in one action of the controller", "body": "<p>I need to create some text. I have a create action:</p>\n\n<pre><code>def create\n  @text = Text.new(text_params)\n\n  if @text.save\n    redirect_to text_path(@text), notice: \"Text successfully created\"\n  else\n    render :new\n  end\nend\n</code></pre>\n\n<p>and the form: </p>\n\n<pre><code>&lt;%= form_for @text do |f| %&gt;\n    &lt;div class=\"form-group\"&gt;\n      &lt;label&gt;Text name&lt;/label&gt;\n      &lt;%= f.text_field :name %&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"form-group\"&gt;\n      &lt;label&gt;Description&lt;/label&gt;\n      &lt;%= f.text_area :description%&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"actions\"&gt;\n      &lt;%= f.submit \"Save\", class: \"btn btn-primary\" %&gt;\n    &lt;/div&gt;\n\n&lt;%end%&gt;\n</code></pre>\n\n<p>I need to have two action when I am submitting my text. The first action is going to create a text. The second is to create words out of the text words and should make a list of words.</p>\n\n<p>When creating a word I need to have an <code>if</code> statement create a word if not present. </p>\n\n<hr>\n\n<p>I am now having an issue with how I can split and create each word:</p>\n\n<pre><code>def create_words\n  @text.split(/\\W+/)\n  @text.each do |splitted|\n    if splitted !== @words.name\n      splitted = @word\n      @word.save\n      redirect_to root_path\n    end\n  end\n</code></pre>\n"}, {"tags": ["ruby", "rubygems", "jira-rest-api", "dashing"], "comments": [{"owner": {"reputation": 1440, "user_id": 1876622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfd72641efb03f1dab0382005ca3434f?s=128&d=identicon&r=PG", "display_name": "HeyZiko", "link": "https://stackoverflow.com/users/1876622/heyziko"}, "edited": false, "score": 0, "creation_date": 1479334911, "post_id": 40634304, "comment_id": 68518893, "body": "Although not likely the culprit, you have a typo. You&#39;re missing an end quote here: &#39;password&#39; =&gt; &#39;passwd,"}, {"owner": {"reputation": 1440, "user_id": 1876622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfd72641efb03f1dab0382005ca3434f?s=128&d=identicon&r=PG", "display_name": "HeyZiko", "link": "https://stackoverflow.com/users/1876622/heyziko"}, "edited": false, "score": 0, "creation_date": 1479334977, "post_id": 40634304, "comment_id": 68518933, "body": "Also, can you identify the line numbers in your ruby? The error is on line 35, which looks like the line after &quot;puts client.Issue&quot;... but it&#39;s hard to confirm."}, {"owner": {"reputation": 3985, "user_id": 2538180, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/89db92c1c25344eed84805dd40a57bea?s=128&d=identicon&r=PG&f=1", "display_name": "emoleumassi", "link": "https://stackoverflow.com/users/2538180/emoleumassi"}, "reply_to_user": {"reputation": 1440, "user_id": 1876622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfd72641efb03f1dab0382005ca3434f?s=128&d=identicon&r=PG", "display_name": "HeyZiko", "link": "https://stackoverflow.com/users/1876622/heyziko"}, "edited": false, "score": 0, "creation_date": 1479367815, "post_id": 40634304, "comment_id": 68529360, "body": "@HeyZiko, the error is on the line 35, you has right. How can i fix them? There is no problem with the password quote, just an error by question&#39;s editing"}, {"owner": {"reputation": 1440, "user_id": 1876622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfd72641efb03f1dab0382005ca3434f?s=128&d=identicon&r=PG", "display_name": "HeyZiko", "link": "https://stackoverflow.com/users/1876622/heyziko"}, "edited": false, "score": 0, "creation_date": 1479391290, "post_id": 40634304, "comment_id": 68544829, "body": "Ok so please edit the question to show which line is number 35, and what is the output of &quot;puts client.Issue&quot;"}, {"owner": {"reputation": 1440, "user_id": 1876622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfd72641efb03f1dab0382005ca3434f?s=128&d=identicon&r=PG", "display_name": "HeyZiko", "link": "https://stackoverflow.com/users/1876622/heyziko"}, "edited": false, "score": 0, "creation_date": 1479391841, "post_id": 40634304, "comment_id": 68545226, "body": "What happens if you change this (\\&quot;#{filter[:filter]}\\&quot;) to this (&#39;#{filter[:filter]}&#39;), just to simplify the string?  Also please show the output of &quot;puts filter&quot; and &quot;puts filter[:filter]&quot;"}, {"owner": {"reputation": 3985, "user_id": 2538180, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/89db92c1c25344eed84805dd40a57bea?s=128&d=identicon&r=PG&f=1", "display_name": "emoleumassi", "link": "https://stackoverflow.com/users/2538180/emoleumassi"}, "reply_to_user": {"reputation": 1440, "user_id": 1876622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfd72641efb03f1dab0382005ca3434f?s=128&d=identicon&r=PG", "display_name": "HeyZiko", "link": "https://stackoverflow.com/users/1876622/heyziko"}, "edited": false, "score": 0, "creation_date": 1479392772, "post_id": 40634304, "comment_id": 68545924, "body": "i changed the query and got the same error. Output puts filter {:filter=&gt;&quot;aaaa&quot;}, puts filter[:filter] = aaaa"}, {"owner": {"reputation": 1440, "user_id": 1876622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfd72641efb03f1dab0382005ca3434f?s=128&d=identicon&r=PG", "display_name": "HeyZiko", "link": "https://stackoverflow.com/users/1876622/heyziko"}, "edited": false, "score": 0, "creation_date": 1479399933, "post_id": 40634304, "comment_id": 68551308, "body": "Can you try the following? (1) Verify that the JQL works as expected in the UI. (2) Verify that the JQL works when directly doing a rest-api call to JIRA - either using (postman)[<a href=\"https://www.getpostman.com/]\" rel=\"nofollow noreferrer\">getpostman.com/]</a> or building off (this example)[<a href=\"https://github.com/sumoheavy/jira-ruby/issues/177]\" rel=\"nofollow noreferrer\">github.com/sumoheavy/jira-ruby/issues/177]</a>"}], "answers": [{"tags": [], "owner": {"reputation": 932, "user_id": 158606, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ab820bd8fec41f49af770daadb279c8d?s=128&d=identicon&r=PG", "display_name": "jbrass", "link": "https://stackoverflow.com/users/158606/jbrass"}, "is_accepted": false, "score": 0, "last_activity_date": 1556569512, "creation_date": 1556569512, "answer_id": 55910371, "question_id": 40634304, "link": "https://stackoverflow.com/questions/40634304/jira-ruby-scheduler-caught-exception-jirahttperror/55910371#55910371", "title": "JIRA-Ruby_ scheduler caught exception: JIRA::HTTPError", "body": "<p>I would try moving your URL directly to the site definition in the jira_options value.</p>\n\n<pre><code>:site =&gt; 'http://jira.company.com:8080', \n</code></pre>\n\n<p>Also try testing the JIRA-ruby library outside of dashing to determine your connection settings. </p>\n\n<p>In my experience using the direct / non-proxied URL works better. YMMV. </p>\n"}], "owner": {"reputation": 3985, "user_id": 2538180, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/89db92c1c25344eed84805dd40a57bea?s=128&d=identicon&r=PG&f=1", "display_name": "emoleumassi", "link": "https://stackoverflow.com/users/2538180/emoleumassi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 334, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556569512, "creation_date": 1479305492, "last_edit_date": 1479391984, "question_id": 40634304, "link": "https://stackoverflow.com/questions/40634304/jira-ruby-scheduler-caught-exception-jirahttperror", "title": "JIRA-Ruby_ scheduler caught exception: JIRA::HTTPError", "body": "<p>i'm working on monitoring my jira bugs with dashing and jira-ruby. I found this <a href=\"https://gist.github.com/christiangalsterer/1b24f2b42aa39ba63a92\" rel=\"nofollow noreferrer\">widget</a> but i have an error, when i started dashing. </p>\n\n<p>Here the error:</p>\n\n<pre><code>scheduler caught exception:   \nJIRA::HTTPError\n    /Users/users/.rvm/gems/ruby-2.2.4/gems/jira-ruby-1.1.3/lib/jira/request_client.rb:16:in `request'\n    /Users/users/.rvm/gems/ruby-2.2.4/gems/jira-ruby-1.1.3/lib/jira/client.rb:213:in `request'\n    /Users/users/.rvm/gems/ruby-2.2.4/gems/jira-ruby-1.1.3/lib/jira/client.rb:191:in `get'\n    /Users/users/.rvm/gems/ruby-2.2.4/gems/jira-ruby-1.1.3/lib/jira/resource/issue.rb:64:in `jql'\n    /Users/users/.rvm/gems/ruby-2.2.4/gems/jira-ruby-1.1.3/lib/jira/base_factory.rb:33:in `block (2 levels) in delegate_to_target_class'\n    /Users/users/../../jobs/jira_number_of_issues_in_filter.rb:35:in `block (2 levels) in &lt;top (required)&gt;'\n    /Users/users/.rvm/gems/ruby-2.2.4/gems/rufus-scheduler-2.0.24/lib/rufus/sc/jobs.rb:230:in `call'\n    /Users/users/.rvm/gems/ruby-2.2.4/gems/rufus-scheduler-2.0.24/lib/rufus/sc/jobs.rb:230:in `trigger_block'\n    /Users/users/.rvm/gems/ruby-2.2.4/gems/rufus-scheduler-2.0.24/lib/rufus/sc/jobs.rb:204:in `block in trigger'\n    /Users/users/.rvm/gems/ruby-2.2.4/gems/rufus-scheduler-2.0.24/lib/rufus/sc/scheduler.rb:430:in `call'\n    /Users/users/.rvm/gems/ruby-2.2.4/gems/rufus-scheduler-2.0.24/lib/rufus/sc/scheduler.rb:430:in `block in trigger_job'\n</code></pre>\n\n<p>Here a copy on my ruby-script: </p>\n\n<pre><code>require 'jira-ruby'\n\nJIRA_PROPS = {\n  'url' =&gt; URI.parse(\"https://SSSSS/test\"),\n  'username' =&gt; 'user',\n  'password' =&gt; 'passwd',\n  'proxy_address' =&gt; nil,\n  'proxy_port' =&gt; nil\n}\n\n# the key of this mapping must be a unique identifier for your jql filter, the according value must be the jql filter id or filter name that is used in Jira\nfilter_mapping = {\n  'filter1' =&gt; { :filter =&gt; 'aaaa' }\n}\n\njira_options = {\n  :username =&gt; JIRA_PROPS['username'],\n  :password =&gt; JIRA_PROPS['password'],\n  :context_path =&gt; JIRA_PROPS['url'].path,\n  :site =&gt; JIRA_PROPS['url'].scheme + \"://\" + JIRA_PROPS['url'].host,\n  :auth_type =&gt; :basic,\n  :ssl_verify_mode =&gt; OpenSSL::SSL::VERIFY_NONE,\n  :use_ssl =&gt; JIRA_PROPS['url'].scheme == 'https' ? true : false,\n  :proxy_address =&gt; JIRA_PROPS['proxy_address'],\n  :proxy_port =&gt; JIRA_PROPS['proxy_port']\n}\n\nlast_issues = Hash.new(0)\n\nfilter_mapping.each do |filter_data_id, filter|\n  SCHEDULER.every '10s', :first_in =&gt; 0 do |job|\n    last_number_issues = last_issues['filter_data_id']\n    client = JIRA::Client.new(jira_options)\n    puts client.Issue\n    //next line is the 35, where the error comes\n    current_number_issues = client.Issue.jql(\"filter in (\\\"#{filter[:filter]}\\\")\").size &lt;-- line 35\n    last_issues['filter_data_id'] = current_number_issues\n    send_event(filter_data_id, { current: current_number_issues, last: last_number_issues})\n  end\nend\n</code></pre>\n\n<p>I just added gem 'jira-ruby' in my Gemfile. </p>\n\n<p>any ideas about this issue. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nokogiri"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1479316527, "post_id": 40634235, "comment_id": 68508719, "body": "Please read &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;. When asking about a problem you&#39;re having with code we need the minimum code necessary to demonstrate the problem, along with the minimum input data used to demonstrate the problem, and the expected output."}], "answers": [{"comments": [{"owner": {"reputation": 1238, "user_id": 5501716, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NUNlx.jpg?s=128&g=1", "display_name": "Alex Zakruzhetskyi", "link": "https://stackoverflow.com/users/5501716/alex-zakruzhetskyi"}, "edited": false, "score": 0, "creation_date": 1479305746, "post_id": 40634337, "comment_id": 68500982, "body": "Thanks, that helped."}], "tags": [], "owner": {"reputation": 272, "user_id": 1922399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9c3dcfd8ca44f4cc1062567f9115c27?s=128&d=identicon&r=PG", "display_name": "Charan Kumar Borra", "link": "https://stackoverflow.com/users/1922399/charan-kumar-borra"}, "is_accepted": true, "score": 2, "last_activity_date": 1479305605, "creation_date": 1479305605, "answer_id": 40634337, "question_id": 40634235, "link": "https://stackoverflow.com/questions/40634235/get-a-content-via-nokogiri/40634337#40634337", "title": "Get &lt;a&gt; content via Nokogiri", "body": "<p>You can write as below to get the text.</p>\n\n<pre><code>ovelty.title = page.at_css('h1 a').text\n</code></pre>\n"}], "owner": {"reputation": 1238, "user_id": 5501716, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NUNlx.jpg?s=128&g=1", "display_name": "Alex Zakruzhetskyi", "link": "https://stackoverflow.com/users/5501716/alex-zakruzhetskyi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 40634337, "answer_count": 1, "score": -1, "last_activity_date": 1479316558, "creation_date": 1479305341, "last_edit_date": 1479316558, "question_id": 40634235, "link": "https://stackoverflow.com/questions/40634235/get-a-content-via-nokogiri", "title": "Get &lt;a&gt; content via Nokogiri", "body": "<p>I'm trying to get a content of <code>&lt;a&gt;</code> element via <code>Nokogiri</code> by doing the following:</p>\n\n<pre><code>novelty.title = page.at_css('h1 a')\n</code></pre>\n\n<p>It saving to database like this: <code>&lt;a href=\"a_link_to_a_novelty_title\"&gt;A title&lt;/a&gt;</code>. So, how can I get only <code>A title</code> from the <code>&lt;a&gt;</code> tag? Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "paypal", "sharetribe"], "comments": [{"owner": {"reputation": 9139, "user_id": 773228, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/baaecdda322cf4462a0dd018d7959b1e?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Wood", "link": "https://stackoverflow.com/users/773228/justin-wood"}, "edited": false, "score": 1, "creation_date": 1479306384, "post_id": 40634190, "comment_id": 68501456, "body": "Welcome to Stack Overflow! Checkout <a href=\"https://stackoverflow.com/help/how-to-ask\">this guide</a> on how to properly as a question."}, {"owner": {"reputation": 1439, "user_id": 1995840, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/rAvyi.jpg?s=128&g=1", "display_name": "MeiSign", "link": "https://stackoverflow.com/users/1995840/meisign"}, "edited": false, "score": 1, "creation_date": 1479306398, "post_id": 40634190, "comment_id": 68501460, "body": "Can you be more specific in your question? What have you tried to use paypal so far. Is paypal not supported by sharetribe or are you only looking for the correct settings to use it?"}, {"owner": {"reputation": 27, "user_id": 4985751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50dda5ed8a39edea4902ac3c19c600aa?s=128&d=identicon&r=PG&f=1", "display_name": "Federico", "link": "https://stackoverflow.com/users/4985751/federico"}, "edited": false, "score": 0, "creation_date": 1479306746, "post_id": 40634190, "comment_id": 68501738, "body": "I&#39;m looking for the correct settings to use Paypal on my app"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1479313207, "post_id": 40634190, "comment_id": 68506407, "body": "Your question is premature. Please read &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; including the linked pages, and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;. We&#39;d like to know what you tried: <a href=\"http://mattgemmell.com/what-have-you-tried/\" rel=\"nofollow noreferrer\">mattgemmell.com/what-have-you-tried</a> helps as does <a href=\"http://meta.stackoverflow.com/questions/261592/how-much-research-effort-is-expected-of-stack-overflow-users\" title=\"how much research effort is expected of stack overflow users\">meta.stackoverflow.com/questions/261592/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 174, "user_id": 5355691, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zrrEfM6LUWc/AAAAAAAAAAI/AAAAAAAAABI/fDweXzZWooM/photo.jpg?sz=128", "display_name": "Jarvis Johnson", "link": "https://stackoverflow.com/users/5355691/jarvis-johnson"}, "is_accepted": true, "score": 1, "last_activity_date": 1481302273, "creation_date": 1481302273, "answer_id": 41065212, "question_id": 40634190, "link": "https://stackoverflow.com/questions/40634190/how-can-i-implement-payment-through-paypal-on-sharetribe-opensource/41065212#41065212", "title": "How can i implement payment through Paypal on Sharetribe opensource?", "body": "<p>Sharetribe doesn't have Paypal enabled on open source version because using Paypal as a peer-to-peer payment solution requires certain extra steps for a business to set up with Paypal.  Sharetribe has done this for their hosted websites, but can't be liable for open sourced versions.</p>\n\n<p>The code is all there for Paypal, however most people are implementing <a href=\"https://stripe.com/connect\" rel=\"nofollow noreferrer\">Stripe Connect</a> instead, as, even with the Paypal code, Stripe Connect is a simpler solution to get your marketplace up and running.</p>\n\n<p>In short, there is no 'setting' to turn on Paypal. A lot of code is required to enable payments.</p>\n\n<p>If you want a marketplace ready-to-go with payments enabled, use Sharetribe's hosted version.  Otherwise, you'll need someone with solid knowledge of Ruby on Rails in order to implement Stripe Connect.</p>\n"}], "owner": {"reputation": 27, "user_id": 4985751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50dda5ed8a39edea4902ac3c19c600aa?s=128&d=identicon&r=PG&f=1", "display_name": "Federico", "link": "https://stackoverflow.com/users/4985751/federico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 41065212, "answer_count": 1, "score": -2, "last_activity_date": 1481302273, "creation_date": 1479305213, "question_id": 40634190, "link": "https://stackoverflow.com/questions/40634190/how-can-i-implement-payment-through-paypal-on-sharetribe-opensource", "title": "How can i implement payment through Paypal on Sharetribe opensource?", "body": "<p>i'm trying to implement payment through Paypal on the opensource version of Sharetribe (<a href=\"https://github.com/sharetribe/sharetribe\" rel=\"nofollow noreferrer\">https://github.com/sharetribe/sharetribe</a>). By default Sharetribe doesn't allow people to use Paypal with the opensource code. How can i create the transaction using the Paypal API? Thank you!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1479305113, "post_id": 40634000, "comment_id": 68500587, "body": "Which kind of test is this? controller test?"}, {"owner": {"reputation": 11970, "user_id": 940158, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a0e9a52555bc8c0ac3e5c9248506c01a?s=128&d=identicon&r=PG", "display_name": "alexandernst", "link": "https://stackoverflow.com/users/940158/alexandernst"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1479305143, "post_id": 40634000, "comment_id": 68500610, "body": "Yes, a contoroller test."}], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 1, "last_activity_date": 1479305289, "creation_date": 1479305289, "answer_id": 40634218, "question_id": 40634000, "link": "https://stackoverflow.com/questions/40634000/rspec-not-matching-my-route/40634218#40634218", "title": "Rspec not matching my route", "body": "<p>In a controller test, you should use actual action name, <code>bar</code>. Routing details is none of controller's business. This is a focused test, so test only the controller logic.</p>\n\n<p>Integration tests, on the other hand, is a different beast. They by definition test the whole stack (because of this, they are also called \"end to end tests\"). You should be able to post to <code>/foo/bar</code> in a feature spec, because request will go through router.</p>\n"}, {"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 2, "last_activity_date": 1479305312, "creation_date": 1479305312, "answer_id": 40634222, "question_id": 40634000, "link": "https://stackoverflow.com/questions/40634000/rspec-not-matching-my-route/40634222#40634222", "title": "Rspec not matching my route", "body": "<p>Routing is not a thing when you run controller specs.</p>\n\n<p>Use:</p>\n\n<pre><code>post 'bar'\n</code></pre>\n\n<p>Very likely there is <code>describe API::V1:Things do</code> around this test, this  tells RSpec which controller to use. </p>\n"}], "owner": {"reputation": 11970, "user_id": 940158, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a0e9a52555bc8c0ac3e5c9248506c01a?s=128&d=identicon&r=PG", "display_name": "alexandernst", "link": "https://stackoverflow.com/users/940158/alexandernst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 40634222, "answer_count": 2, "score": 0, "last_activity_date": 1479305312, "creation_date": 1479304635, "question_id": 40634000, "link": "https://stackoverflow.com/questions/40634000/rspec-not-matching-my-route", "title": "Rspec not matching my route", "body": "<p>I have <code>post '/foo/bar', to: 'api/v1/things#bar'</code> in my <code>routes.rb</code>.</p>\n\n<p>Running <code>rails routes</code> returns </p>\n\n<pre><code>foo_bar POST /foo/bar(.:format) api/v1/things#bar\n</code></pre>\n\n<p>I'm trying to test it with <code>post '/foo/bar'</code>, but I get </p>\n\n<pre><code>No route matches {:action=&gt;\"/foo/bar\", :controller=&gt;\"api/v1/things\"}\n</code></pre>\n\n<p>I know the problem is something silly, but I'm unable to see it. Any ideas?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1479728212, "post_id": 40633135, "comment_id": 68665209, "body": "make sure to select an answer, that fits best to your question and checkmark it. This way you let other users know, your issue is solved."}], "answers": [{"comments": [{"owner": {"reputation": 1914, "user_id": 5740849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/63c498a66baa5ed9f1eaebff98e43c40?s=128&d=identicon&r=PG&f=1", "display_name": "Twinfriends", "link": "https://stackoverflow.com/users/5740849/twinfriends"}, "edited": false, "score": 0, "creation_date": 1479302641, "post_id": 40633171, "comment_id": 68498868, "body": "Thank you very much. Now i understand a bit more. :P Still to complex to understand what the whole programm is doing, but thats the reason why i want to learn it! And thx for the advise with de to_i, but i think its not bad to do it? This Code is part of a API, is there not a danger for SQL injections when i don&#39;t put this to_i ?"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 1914, "user_id": 5740849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/63c498a66baa5ed9f1eaebff98e43c40?s=128&d=identicon&r=PG&f=1", "display_name": "Twinfriends", "link": "https://stackoverflow.com/users/5740849/twinfriends"}, "edited": false, "score": 1, "creation_date": 1479302872, "post_id": 40633171, "comment_id": 68499035, "body": "@Twinfriends you&#39;re welcome! It&#39;s not bad to convert <code>params[:project_id]</code> it to integer. As to SQL injection - since <code>find</code> method takes either string or integer and constructs a query like <code>SELECT  projects.* FROM projects WHERE projects.id = $1</code> I think it is not vulnerable to injection, but in general you are right to want to sanitize incoming params :)"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": false, "score": 2, "last_activity_date": 1479302388, "last_edit_date": 1479302388, "creation_date": 1479302276, "answer_id": 40633171, "question_id": 40633135, "link": "https://stackoverflow.com/questions/40633135/ruby-on-rails-activerecord-what-does-anything-do-after-a-find/40633171#40633171", "title": "Ruby on Rails ActiveRecord what does .anything do after a find?", "body": "<p>You <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/FinderMethods.html#method-i-find\" rel=\"nofollow noreferrer\"><code>find</code></a> a single project object with</p>\n\n<pre><code>Project.find(params[:project_id].to_i) # returns a Project instance\n</code></pre>\n\n<p>and then get its associated <code>contacts</code>.</p>\n\n<p>It is equivalent to</p>\n\n<pre><code>project = Project.find(params[:project_id].to_i) # btw `find` accepts strings as well, so no need for `to_i`\nproject.contacts\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3367, "user_id": 822256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ITN7.png?s=128&g=1", "display_name": "sa77", "link": "https://stackoverflow.com/users/822256/sa77"}, "is_accepted": false, "score": 4, "last_activity_date": 1479304807, "creation_date": 1479304807, "answer_id": 40634051, "question_id": 40633135, "link": "https://stackoverflow.com/questions/40633135/ruby-on-rails-activerecord-what-does-anything-do-after-a-find/40634051#40634051", "title": "Ruby on Rails ActiveRecord what does .anything do after a find?", "body": "<p><code>.contacts</code> method returns a collection of <code>Contact</code> objects associated with your <code>Project</code> model. </p>\n\n<p>You must have a <code>has_many :contacts</code> relationship defined there on your <code>Project</code> model ( <code>app/models/project.rb</code> ) and <code>belongs_to :project</code> on your <code>Contact</code> model ( <code>app/models/contact.rb</code> ). </p>\n\n<p>This association is an activerecord abstraction for the relationship between the <code>projects</code> and <code>contacts</code> table on your database which means that a row on <code>projects</code> table (i.e a <code>Project</code> object) can have many contacts (i.e many rows on <code>contacts</code> table) based on a foreign key <code>project_id</code> on the <code>contacts</code> table.</p>\n\n<p>In the code, <code>@contacts = Project.find(params[:project_id].to_i).contacts</code> , the <code>find</code> method returns a single object (<code>Project</code> model) from your <code>projects</code> table with the value of column <code>id</code> passed as <code>params[:project_id]</code>. Then <code>.contacts</code> returns all the associated rows from the <code>contacts</code> table (rows with value of <code>project_id</code> equal to <code>params[:project_id].to_i</code>).</p>\n\n<p>In a single table rails activerecord operation, The following line gives the same list of rows from <code>contacts</code> table with column <code>project_id</code> having value <code>params[:project_id].to_i</code> as the line in your question.</p>\n\n<pre><code>@contacts = Contact.where(project_id: params[:project_id].to_i)\n</code></pre>\n\n<p>This returns all rows in <code>contacts</code> table having the value of <code>project_id</code> column equal to <code>params[:project_id].to_i</code>.</p>\n\n<p>rails has excellent documentations on <a href=\"http://guides.rubyonrails.org/association_basics.html\" rel=\"nofollow noreferrer\">activerecord associations</a> and <a href=\"http://guides.rubyonrails.org/active_record_querying.html\" rel=\"nofollow noreferrer\">active record</a></p>\n"}, {"tags": [], "owner": {"reputation": 166, "user_id": 7040027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37407cfccbfc6c2c6370a74c41fec074?s=128&d=identicon&r=PG", "display_name": "veldtmana", "link": "https://stackoverflow.com/users/7040027/veldtmana"}, "is_accepted": false, "score": 0, "last_activity_date": 1479327772, "creation_date": 1479327772, "answer_id": 40641604, "question_id": 40633135, "link": "https://stackoverflow.com/questions/40633135/ruby-on-rails-activerecord-what-does-anything-do-after-a-find/40641604#40641604", "title": "Ruby on Rails ActiveRecord what does .anything do after a find?", "body": "<p>in your question <code>contacts</code> is a method that is being called on the result of a method that was called on another object</p>\n\n<p>In this case it is sending a message <code>contacts</code> to the ActiveRecord object that is returned from the <code>find</code> method called on the <code>Project</code> class</p>\n\n<p>Whether or not that result is able to respond to that message is not as straightforward as you think. You often get errors like this in ruby:</p>\n\n<pre><code>undefined method `contacts' for nil:NilClass\n</code></pre>\n\n<p>However, that is not likely not happen in this case because the <code>find</code> method raises an exception if it cannot find the record (whereas <code>find_by</code> returns nil)</p>\n\n<p>Remember that in ruby everything is an object and method calls can be chained</p>\n"}], "owner": {"reputation": 1914, "user_id": 5740849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/63c498a66baa5ed9f1eaebff98e43c40?s=128&d=identicon&r=PG&f=1", "display_name": "Twinfriends", "link": "https://stackoverflow.com/users/5740849/twinfriends"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1479327772, "creation_date": 1479302172, "last_edit_date": 1479303104, "question_id": 40633135, "link": "https://stackoverflow.com/questions/40633135/ruby-on-rails-activerecord-what-does-anything-do-after-a-find", "title": "Ruby on Rails ActiveRecord what does .anything do after a find?", "body": "<p>I have the following Code:</p>\n\n<pre><code>@contacts = Project.find(params[:project_id].to_i).contacts\n</code></pre>\n\n<p>Can someone explain me what does <code>.contacts</code> part do at the end of this line? I try to figure out, but i can't find a answer. I think it must be something like a include or something, but I really don't understand. Would be really happy for any advise (maybe only a link to a explanation would be enough. I tried to find something but i don't know what i've to search because i've no idea what this is..)</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 1224, "user_id": 1170266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2db3460298af8f4a585f95cf556874?s=128&d=identicon&r=PG", "display_name": "archana", "link": "https://stackoverflow.com/users/1170266/archana"}, "edited": false, "score": 0, "creation_date": 1479325327, "post_id": 40633067, "comment_id": 68513788, "body": "Maybe the way you are passing date doesn&#39;t match with the record in db? Can you provide close-to-real query?"}, {"owner": {"reputation": 2814, "user_id": 1547664, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/rwbh6.jpg?s=128&g=1", "display_name": "Dinesh Saini", "link": "https://stackoverflow.com/users/1547664/dinesh-saini"}, "reply_to_user": {"reputation": 1224, "user_id": 1170266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2db3460298af8f4a585f95cf556874?s=128&d=identicon&r=PG", "display_name": "archana", "link": "https://stackoverflow.com/users/1170266/archana"}, "edited": false, "score": 0, "creation_date": 1479364643, "post_id": 40633067, "comment_id": 68527756, "body": "@archana these two record actually executing {&quot;program_identifier&quot;=&gt;&quot;test_program_1&quot;, &quot;start_date&quot;=&gt;&quot;2016-11-16&quot;, &quot;end_date&quot;=&gt;&quot;2016-11-21&quot;, &quot;capacity&quot;=&gt;&quot;123.45&quot;}          X2: {&quot;program_identifier&quot;=&gt;&quot;test_program_1&quot;, &quot;start_date&quot;=&gt;&quot;2016-11-16&quot;, &quot;end_date&quot;=&gt;&quot;2016-11-21&quot;, &quot;capacity&quot;=&gt;&quot;234.56&quot;}"}, {"owner": {"reputation": 7898, "user_id": 3437900, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/blKgR.jpg?s=128&g=1", "display_name": "illusionist", "link": "https://stackoverflow.com/users/3437900/illusionist"}, "edited": false, "score": 0, "creation_date": 1479368666, "post_id": 40633067, "comment_id": 68529792, "body": "have you encountered any errors?"}, {"owner": {"reputation": 2814, "user_id": 1547664, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/rwbh6.jpg?s=128&g=1", "display_name": "Dinesh Saini", "link": "https://stackoverflow.com/users/1547664/dinesh-saini"}, "reply_to_user": {"reputation": 7898, "user_id": 3437900, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/blKgR.jpg?s=128&g=1", "display_name": "illusionist", "link": "https://stackoverflow.com/users/3437900/illusionist"}, "edited": false, "score": 0, "creation_date": 1479369811, "post_id": 40633067, "comment_id": 68530420, "body": "@illusionist its not about error, its about create a new record while we expect the update the existing one."}], "answers": [{"comments": [{"owner": {"reputation": 2814, "user_id": 1547664, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/rwbh6.jpg?s=128&g=1", "display_name": "Dinesh Saini", "link": "https://stackoverflow.com/users/1547664/dinesh-saini"}, "edited": false, "score": 0, "creation_date": 1479457440, "post_id": 40655331, "comment_id": 68574851, "body": "Rails 4 support find_or_initialize_by?"}, {"owner": {"reputation": 189, "user_id": 3368222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DN3yr.jpg?s=128&g=1", "display_name": "Pratap", "link": "https://stackoverflow.com/users/3368222/pratap"}, "reply_to_user": {"reputation": 2814, "user_id": 1547664, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/rwbh6.jpg?s=128&g=1", "display_name": "Dinesh Saini", "link": "https://stackoverflow.com/users/1547664/dinesh-saini"}, "edited": false, "score": 0, "creation_date": 1479457564, "post_id": 40655331, "comment_id": 68574916, "body": "check <a href=\"http://apidock.com/rails/v4.0.2/ActiveRecord/Relation/find_or_initialize_by\" rel=\"nofollow noreferrer\">apidock.com/rails/v4.0.2/ActiveRecord/Relation/&hellip;</a>"}, {"owner": {"reputation": 2814, "user_id": 1547664, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/rwbh6.jpg?s=128&g=1", "display_name": "Dinesh Saini", "link": "https://stackoverflow.com/users/1547664/dinesh-saini"}, "edited": false, "score": 0, "creation_date": 1479457626, "post_id": 40655331, "comment_id": 68574950, "body": "what if we have multiple record and using find?"}, {"owner": {"reputation": 189, "user_id": 3368222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DN3yr.jpg?s=128&g=1", "display_name": "Pratap", "link": "https://stackoverflow.com/users/3368222/pratap"}, "reply_to_user": {"reputation": 2814, "user_id": 1547664, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/rwbh6.jpg?s=128&g=1", "display_name": "Dinesh Saini", "link": "https://stackoverflow.com/users/1547664/dinesh-saini"}, "edited": false, "score": 0, "creation_date": 1479457896, "post_id": 40655331, "comment_id": 68575084, "body": "we need to iterate first and then apply find_or_initialize_by"}, {"owner": {"reputation": 1224, "user_id": 1170266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2db3460298af8f4a585f95cf556874?s=128&d=identicon&r=PG", "display_name": "archana", "link": "https://stackoverflow.com/users/1170266/archana"}, "edited": false, "score": 0, "creation_date": 1479495813, "post_id": 40655331, "comment_id": 68599034, "body": "@Pratap That&#39;s really non-optimal solution, <code>first_or_initialize</code> should work."}], "tags": [], "owner": {"reputation": 189, "user_id": 3368222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DN3yr.jpg?s=128&g=1", "display_name": "Pratap", "link": "https://stackoverflow.com/users/3368222/pratap"}, "is_accepted": false, "score": 1, "last_activity_date": 1479386873, "creation_date": 1479386873, "answer_id": 40655331, "question_id": 40633067, "link": "https://stackoverflow.com/questions/40633067/first-or-initialize-is-not-working-for-relative-model-and-creating-new-record-ea/40655331#40655331", "title": "first_or_initialize is not working for relative model and creating new record each time", "body": "<p>Try to use find_or_initialize_by method</p>\n\n<pre><code>relative_model =  main_model.relative_model.find_or_initialize_by(start_date: XYZ, end_date: XYZ)\n</code></pre>\n"}], "owner": {"reputation": 2814, "user_id": 1547664, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/rwbh6.jpg?s=128&g=1", "display_name": "Dinesh Saini", "link": "https://stackoverflow.com/users/1547664/dinesh-saini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479386873, "creation_date": 1479301985, "last_edit_date": 1479367103, "question_id": 40633067, "link": "https://stackoverflow.com/questions/40633067/first-or-initialize-is-not-working-for-relative-model-and-creating-new-record-ea", "title": "first_or_initialize is not working for relative model and creating new record each time", "body": "<pre><code>ccs.each do |cd|\n  relative_model = main_model.relative_model.where(start_date: XYZ, end_date: XYZ).first_or_initialize\n  relative_model.capacity = cd['capacity'].to_f\n  relative_model.save!\nend\n</code></pre>\n\n<p>As per above code, first_or_initialize is not working for relative model and creating new record each time. </p>\n\n<p>Here is the query run at background for both inr:</p>\n\n<pre><code>SELECT `capacity_commitments`.* FROM `capacity_commitments`  WHERE `capacity_commitments`.`participants_subscription_id` = 1 AND `capacity_commitments`.`start_date` = '2016-11-16' AND `capacity_commitments`.`end_date` = '2016-11-21'\n\nSELECT `capacity_commitments`.* FROM `capacity_commitments`  WHERE `capacity_commitments`.`participants_subscription_id` = 1 AND `capacity_commitments`.`start_date` = '2016-11-16' AND `capacity_commitments`.`end_date` = '2016-11-21'\n</code></pre>\n\n<p>NEED INITIAL HELP OR POINT OUT WHAT IS WRONG IN ABOVE CODE?</p>\n"}, {"tags": ["ruby", "selenium"], "answers": [{"tags": [], "owner": {"reputation": 4008, "user_id": 6377281, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHohs.png?s=128&g=1", "display_name": "lauda", "link": "https://stackoverflow.com/users/6377281/lauda"}, "is_accepted": false, "score": 0, "last_activity_date": 1479302988, "creation_date": 1479302988, "answer_id": 40633422, "question_id": 40632602, "link": "https://stackoverflow.com/questions/40632602/unable-to-perform-scrubber-slider-movement-using-ruby-selenium/40633422#40633422", "title": "Unable to perform scrubber slider movement using ruby selenium", "body": "<p>Executing a jQuery script should work just fine.  </p>\n\n<pre><code>jQuery( \"#slider\" ).slider( \"option\", \"value\", 60 );\n</code></pre>\n\n<p>Tested on the same slider in the iframe page <a href=\"http://jqueryui.com/resources/demos/slider/default.html\" rel=\"nofollow noreferrer\">http://jqueryui.com/resources/demos/slider/default.html</a></p>\n"}], "owner": {"reputation": 1, "user_id": 7167411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91f619685de5420d509a88e9e04ac8c5?s=128&d=identicon&r=PG&f=1", "display_name": "sayan paul", "link": "https://stackoverflow.com/users/7167411/sayan-paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552644913, "creation_date": 1479300615, "last_edit_date": 1552644913, "question_id": 40632602, "link": "https://stackoverflow.com/questions/40632602/unable-to-perform-scrubber-slider-movement-using-ruby-selenium", "title": "Unable to perform scrubber slider movement using ruby selenium", "body": "<p>I need to slide through the scrubber bar:</p>\n\n<pre><code>&lt;div id=\"scrubber\" class=\"no-highlight expanded\" style=\"outline: none;\"&gt;\n &lt;div id=\"progress\" style=\"width: 50%; outline: none;\"&gt;\n  &lt;div id=\"handle\" class=\"grabbed\" style=\"outline: none;\"&gt;\n   &lt;div class=\"overhandle no-highlight\" style=\"outline: none;\"&gt;\n   &lt;/div&gt;\n  &lt;/div&gt;\n &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>But my code seems to have no effect on the bar</p>\n\n<pre><code>hnd = br.find_element(:id,'handle')\nbr.action.drag_and_drop_by(hnd,100,0).click.perform\n</code></pre>\n\n<p>the same code seems to work in <a href=\"http://jqueryui.com/demos/slider/\" rel=\"nofollow noreferrer\">http://jqueryui.com/demos/slider/</a></p>\n\n<p>I also tried to change the style of the element(id : progress) using javascript but only shows the updated width when i query the same in irb.</p>\n\n<p>javascript_execution: </p>\n\n<pre><code>br.execute_script('document.getElementById(\"progress\").style.width = \"20%\"')\n</code></pre>\n\n<p>I am using chrome as my browser.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "testing", "rspec"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1479300651, "post_id": 40632594, "comment_id": 68497671, "body": "what is you use <code>require &#39;spec_helper&#39;</code> instead of <code>require &#39;rails_helper&#39;</code>?"}], "owner": {"reputation": 397, "user_id": 2610292, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/77449070823d66b0d75969004552316b?s=128&d=identicon&r=PG", "display_name": "Dashing Boy", "link": "https://stackoverflow.com/users/2610292/dashing-boy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 228, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1479302214, "creation_date": 1479300592, "question_id": 40632594, "link": "https://stackoverflow.com/questions/40632594/getting-stuck-with-rspec-3-on-windows", "title": "Getting stuck with rspec 3 on windows", "body": "<p>I'm following a <a href=\"https://www.coursera.org/learn/rails-with-active-record/\" rel=\"nofollow noreferrer\">course</a> on Coursera and I have to submit an assignment and validate it with rspec. So far I avoided all problems with rspec by simple copying the .rspec and spec folder provided with the sample code in my projects and it seems to work but now I have a spec file with following code:</p>\n\n<pre><code>require 'rails_helper'\n\nfeature \"Module #3\" do\n\n  before :all do\n    $continue = true\n  end\n\n  around :each do |example|\n    if $continue\n      $continue = false \n      example.run \n      $continue = true unless example.exception\n    else\n      example.skip\n    end\n  end\n\n  #helper method to determine if Ruby class exists as a class\n  def class_exists?(class_name)\n    eval(\"defined?(#{class_name}) &amp;&amp; #{class_name}.is_a?(Class)\") == true\n  end\n\n  #helper method to determine if two files are the same\n  def files_same?(file1, file2) \n    if (File.size(file1) != File.size(file2)) then\n      return false\n    end\n    f1 = IO.readlines(file1)\n    f2 = IO.readlines(file2)\n    if ((f1 - f2).size == 0) then\n      return true\n    else\n      return false\n    end\n  end\n\n  context \"rq01\" do\n    context \"Generate Rails application\" do\n      it \"must have top level structure of a rails application\" do\n        expect(File.exists?(\"Gemfile\")).to be(true)\n        expect(Dir.entries(\".\")).to include(\"app\", \"bin\", \"config\", \"db\", \"lib\", \"public\", \"log\", \"test\", \"vendor\")\n        expect(Dir.entries(\"./app\")).to include(\"assets\", \"controllers\", \"helpers\", \"mailers\", \"models\", \"views\")        \n      end\n    end\n  end\n\n  # check that TodoItem exists with fields and migration/db exists\n  context \"rq02\" do\n    before :each do    \n      TodoItem.destroy_all\n      load \"#{Rails.root}/db/seeds.rb\"  \n    end\n\n    context \"Scaffolding generated\" do\n      it \"must have at least one controller and views\" do \n        expect(Dir.entries(\"./app/controllers\")).to include(\"todo_items_controller.rb\")\n        expect(Dir.entries(\"./app/views/\")).to include(\"todo_items\")\n        expect(Dir.entries(\"./app/views/todo_items\")).to include(\"index.html.erb\")\n      end\n    end\n    context \"TodoItem Model\" do\n      it \"TodoItem class\" do\n        expect(class_exists?(\"TodoItem\"))\n        expect(TodoItem &lt; ActiveRecord::Base).to eq(true)\n      end\n    end\n    context \"TodoItem class properties added\" do\n      subject(:todoItem) { TodoItem.new }\n      it { is_expected.to respond_to(:due_date) } \n      it { is_expected.to respond_to(:title) } \n      it { is_expected.to respond_to(:completed) }\n      it { is_expected.to respond_to(:description) } \n      it { is_expected.to respond_to(:created_at) } \n      it { is_expected.to respond_to(:updated_at) } \n    end\n    it \"TodoItem database structure in place\" do\n      # rails g model todo_item due_date:date title description:text         \n      # rake db:migrate\n      expect(TodoItem.column_names).to include \"due_date\", \"title\", \"description\", \"completed\"\n      expect(TodoItem.column_types[\"due_date\"].type).to eq :date\n      expect(TodoItem.column_types[\"title\"].type).to eq :string\n      expect(TodoItem.column_types[\"description\"].type).to eq :text            \n      expect(TodoItem.column_types[\"created_at\"].type).to eq :datetime\n      expect(TodoItem.column_types[\"updated_at\"].type).to eq :datetime\n      expect(TodoItem.column_types[\"completed\"].type).to eq :boolean\n    end    \n  end\n\n  context \"rq03\" do \n    before :each do    \n      TodoItem.destroy_all\n      load \"#{Rails.root}/db/seeds.rb\"  \n    end\n\n    # Check that database has been initialized with seed file prior to test\n    it \"has the file that seeded the database\" do\n      expect(File).to exist(\"#{Rails.root}/db/seeds.rb\")\n    end\n    it \"must have TodoItems as provided by assignment seed file\" do\n      expect(TodoItem.all.length).to eq(3)\n      expect(TodoItem.all.map{ |x| x.title }).to include(\"Task 1\", \"Task 2\", \"Task 3\")\n    end\n  end\n\n  context \"rq04\" do \n    before :each do    \n      TodoItem.destroy_all\n      load \"#{Rails.root}/db/seeds.rb\"  \n    end\n\n    scenario \"todo_items URI should return a valid page\" do \n      visit todo_items_path  \n      expect(page.status_code).to eq(200)\n    end\n  end\n\n  context \"rq05\" do\n    before :each do    \n      TodoItem.destroy_all\n      load \"#{Rails.root}/db/seeds.rb\"  \n      # start at main page...\n      visit todo_items_path\n    end\n\n    scenario \"Main page displays all items\" do\n      expect(page).to have_content \"Task 1\"\n      expect(page).to have_content \"Task 2\"\n      expect(page).to have_content \"Task 3\"\n    end\n\n    scenario \"New action from index and create action to generate a new item\" do \n      expect(page).to have_link(\"New Todo item\")\n      click_link(\"New Todo item\")\n      expect(page).to have_content \"Title\"\n      item = TodoItem.new(title:'Random', description:'', completed:true, due_date:Date.today)\n      fill_in \"Title\", with: item.title\n      select item.due_date.year, from: 'todo_item[due_date(1i)]'\n      select item.due_date.strftime(\"%B\"), from: 'todo_item[due_date(2i)]'\n      select item.due_date.day, from: 'todo_item[due_date(3i)]'\n      fill_in 'todo_item[title]', with: item.title\n      fill_in 'todo_item[description]', with: item.description\n      click_button 'Create Todo item'\n      new_task = TodoItem.find_by! title: \"Random\"\n      expect(TodoItem.count).to eq 4\n      expect(page).to have_content \"Todo item was successfully created.\"\n    end\n\n=begin\n    scenario \"Show link takes user to detail page about an item\" do\n      task2 = TodoItem.find_by title: \"Task 2\"\n      expect(page).to have_link(\"Show\", href: \"#{todo_item_path(task2)}\")\n      click_link(\"Show\", href: \"#{todo_item_path(task2)}\")\n      expect(page).to have_content task2.due_date.strftime(\"%F\")\n      expect(page).to have_content task2.title\n      expect(page).to have_content task2.description\n      expect(page.current_path).to eq(todo_item_path(task2.id))\n    end\n\n    scenario \"Edit and update action\" do  \n      new_task = TodoItem.create!(:title =&gt; \"Random\", :description =&gt; \"\", :completed =&gt; true, :due_date =&gt; Date.today)\n      visit edit_todo_item_path(new_task)\n      expect(page).to have_content \"Description\"\n      expect(page).to have_field(\"Title\", with: \"Random\")\n      fill_in \"Description\", with: \"fascinating\"    \n      click_button \"Update Todo item\"\n      new_task = TodoItem.find_by! title: \"Random\"\n      expect(new_task.description).to_not be_blank\n      expect(page).to have_content \"Todo item was successfully updated.\"\n    end\n\n    scenario \"Delete action\" do\n      new_task = TodoItem.create!(:title =&gt; \"Random\", :description =&gt; \"\", :completed =&gt; true, :due_date =&gt; Date.today)\n      visit todo_items_path\n      expect(page).to have_link(\"Destroy\", href: \"#{todo_item_path(new_task)}\")\n      click_link(\"Destroy\", href: \"#{todo_item_path(new_task)}\")\n      expect(TodoItem.count).to eq 3\n      expect(TodoItem.find_by title: \"Random\").to be_nil\n    end\n=end\n  end\n\n  context \"rq06\" do \n    before :each do    \n      TodoItem.destroy_all\n      load \"#{Rails.root}/db/seeds.rb\"  \n    end\n    scenario \"after creating an item should go to listing page\" do\n      visit new_todo_item_path\n      fill_in \"Title\", with: \"some title\"\n      click_button \"Create Todo item\"\n      expect(page).to have_content \"Listing Todo Items\"\n      expect(page.current_path).to eq(todo_items_path)\n    end \n  end\n\n  context \"rq07\" do \n    before :each do    \n      TodoItem.destroy_all\n      load \"#{Rails.root}/db/seeds.rb\"  \n    end\n    scenario \"remove edit link from listing page\" do\n      visit todo_items_path\n      expect(page).to_not have_content('Edit')\n    end\n  end\n\n  context \"rq08\" do \n    before :each do    \n      TodoItem.destroy_all\n      load \"#{Rails.root}/db/seeds.rb\"  \n    end\n    scenario \"only display completed checkbox in the form when editing\" do\n      visit new_todo_item_path \n      expect(page).to_not have_content('Completed')\n      item = TodoItem.all.to_a[0]\n      expect(item.id).to_not be_nil\n      visit edit_todo_item_path(item.id)\n      expect(page).to have_content('Completed')\n    end\n  end\n\n  context \"rq09\" do \n    before :each do    \n      TodoItem.destroy_all\n      load \"#{Rails.root}/db/seeds.rb\"  \n    end\n    scenario \"display somewhere on the listing page number of completed todos\" do \n      # seed the page with random items so test is specific to each run\n      TodoItem.destroy_all\n      numCompleted = 0;\n      (0..15).each do |i|\n        random_boolean = [true, false].sample  \n        if (random_boolean) then\n          numCompleted = numCompleted + 1\n        end\n        TodoItem.create!(title: \"Task #{i}\", due_date: Date.today, description: \"description #{i}\", completed: random_boolean)\n      end\n      visit todo_items_path\n      expect(page).to have_content \"Number of Completed Todos: #{numCompleted}\"  \n\n      TodoItem.create! [\n        { title: \"Task xyz\", due_date: Date.today, completed: false },\n        { title: \"Task zyx\", due_date: Date.tomorrow, completed: true},\n      ]\n      numCompleted = numCompleted + 1\n      visit todo_items_path\n      expect(page).to have_content \"Number of Completed Todos: #{numCompleted}\"  \n    end\n  end\nend\n</code></pre>\n\n<p>When I run it as is with requre 'rails_helper' I get:</p>\n\n<pre><code>D:/RailsInstaller/Ruby2.2.0/lib/ruby/site_ruby/2.2.0/rubygems/core_ext/kernel_require.rb:55:in `require': cannot load such file -- rails_helper (LoadError)\n</code></pre>\n\n<p>When I remove it I get: </p>\n\n<pre><code>todolists/spec/features/module3_action_pack_spec.rb:1:in `&lt;top (required)&gt;': undefined method `feature' for main:Object (NoMethodError)\n</code></pre>\n\n<p>This is my spec_helper.rb:</p>\n\n<pre><code>require 'rspec'\nrequire 'capybara'\nrequire 'capybara/dsl'\nrequire 'capybara/poltergeist'\n\nRSpec.configure do |config|\n  config.include Capybara::DSL\nend\n</code></pre>\n\n<p>I tried everything I can come across on the net like downgrading to rspec 3.0.0 from 3.1.0 and changing the DirectoryMaker.rb under RailsInstaller\\Ruby2.2.0\\lib\\ruby\\gems\\2.2.0\\gems\\rspec-support-3.5.0\\lib\\rspec\\support as mentioned in <a href=\"https://github.com/rspec/rspec-support/pull/109\" rel=\"nofollow noreferrer\">https://github.com/rspec/rspec-support/pull/109</a> but I still get the error when I try to run rails generate rspec:install like this:</p>\n\n<pre><code>   create  spec/C:/Users/Zeeshan Haider/AppData/Local/Temp/d20161116-10536-1962r60/spec/spec_helper.rb\nD:/RailsInstaller/Ruby2.2.0/lib/ruby/2.2.0/fileutils.rb:252:in `mkdir': Invalid argument @ dir_s_mkdir - F:/Zeeshan Haider/Coursera/Rails with Active Record and Action Pack/todolists/spec/C: (Errno::EINVAL)\n        from D:/RailsInstaller/Ruby2.2.0/lib/ruby/2.2.0/fileutils.rb:252:in `fu_mkdir'\n        from D:/RailsInstaller/Ruby2.2.0/lib/ruby/2.2.0/fileutils.rb:226:in `block (2 levels) in mkdir_p'\n        from D:/RailsInstaller/Ruby2.2.0/lib/ruby/2.2.0/fileutils.rb:224:in `reverse_each'\n        from D:/RailsInstaller/Ruby2.2.0/lib/ruby/2.2.0/fileutils.rb:224:in `block in mkdir_p'\n        from D:/RailsInstaller/Ruby2.2.0/lib/ruby/2.2.0/fileutils.rb:210:in `each'\n        from D:/RailsInstaller/Ruby2.2.0/lib/ruby/2.2.0/fileutils.rb:210:in `mkdir_p'\n        from D:/RailsInstaller/Ruby2.2.0/lib/ruby/gems/2.2.0/gems/thor-0.19.1/lib/thor/actions/create_file.rb:61:in `block in invoke!'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "xml"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1479317088, "post_id": 40632348, "comment_id": 68509101, "body": "I&#39;d recommend searching for &quot;ruby xml parser&quot; and &quot;parsing xml with ruby&quot; plus variations on those. Please read &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; along with the linked pages."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1479300568, "post_id": 40632520, "comment_id": 68497603, "body": "Oh, never seen this one. Fortunately, I might add :)"}, {"owner": {"reputation": 9325, "user_id": 2277817, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ce18a9ed86d758752f941a75aaa982bf?s=128&d=identicon&r=PG", "display_name": "Gowtham Gopalakrishnan", "link": "https://stackoverflow.com/users/2277817/gowtham-gopalakrishnan"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1479317775, "post_id": 40632520, "comment_id": 68509545, "body": "@SergioTulentsev Sure, I get it. I&#39;m just saying that this is not always the right solution."}], "tags": [], "owner": {"reputation": 1122, "user_id": 3283795, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/satrn.jpg?s=128&g=1", "display_name": "kajal ojha", "link": "https://stackoverflow.com/users/3283795/kajal-ojha"}, "is_accepted": false, "score": 2, "last_activity_date": 1479300355, "creation_date": 1479300355, "answer_id": 40632520, "question_id": 40632348, "link": "https://stackoverflow.com/questions/40632348/xml-to-array-in-ruby/40632520#40632520", "title": "xml to array in ruby", "body": "<p>you can use </p>\n\n<pre><code>hash = Hash.from_xml(xml)\n</code></pre>\n\n<p>Refrence doc:</p>\n\n<p><a href=\"http://apidock.com/rails/v4.0.2/Hash/from_xml/class\" rel=\"nofollow noreferrer\">http://apidock.com/rails/v4.0.2/Hash/from_xml/class</a></p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 7162330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38bad6a18d906f71c10b75be96a33025?s=128&d=identicon&r=PG&f=1", "display_name": "John Avlakiotis", "link": "https://stackoverflow.com/users/7162330/john-avlakiotis"}, "edited": false, "score": 0, "creation_date": 1479302516, "post_id": 40632731, "comment_id": 68498782, "body": "I have rails, so I was using your second suggestion but I get the following error &quot;NoMethodError Exception: undefined method `[]&#39; for nil:NilClass&quot; . Sorry if I am sounding stupid but I am really new to this"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 21, "user_id": 7162330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38bad6a18d906f71c10b75be96a33025?s=128&d=identicon&r=PG&f=1", "display_name": "John Avlakiotis", "link": "https://stackoverflow.com/users/7162330/john-avlakiotis"}, "edited": false, "score": 0, "creation_date": 1479302775, "post_id": 40632731, "comment_id": 68498966, "body": "The code works fine with the example you posted, maybe your bigger xml isn&#39;t formatted the same or has missing nodes. I&#39;ll update the code with a more robust solution."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 21, "user_id": 7162330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38bad6a18d906f71c10b75be96a33025?s=128&d=identicon&r=PG&f=1", "display_name": "John Avlakiotis", "link": "https://stackoverflow.com/users/7162330/john-avlakiotis"}, "edited": false, "score": 0, "creation_date": 1479303343, "post_id": 40632731, "comment_id": 68499356, "body": "The updated version should work with empty Station nodes."}, {"owner": {"reputation": 21, "user_id": 7162330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38bad6a18d906f71c10b75be96a33025?s=128&d=identicon&r=PG&f=1", "display_name": "John Avlakiotis", "link": "https://stackoverflow.com/users/7162330/john-avlakiotis"}, "edited": false, "score": 0, "creation_date": 1479307388, "post_id": 40632731, "comment_id": 68502186, "body": "Thanks! THis works. And something simpler, how about if I wanted instead of a hash just to make an array with the Long names?"}, {"owner": {"reputation": 21, "user_id": 7162330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38bad6a18d906f71c10b75be96a33025?s=128&d=identicon&r=PG&f=1", "display_name": "John Avlakiotis", "link": "https://stackoverflow.com/users/7162330/john-avlakiotis"}, "edited": false, "score": 0, "creation_date": 1479308677, "post_id": 40632731, "comment_id": 68503117, "body": "thanks that works as well, and a final question if you can help me, how would i print the just_langs in my index.html.erb, since I am using rails and it is part of what I want to do."}, {"owner": {"reputation": 21, "user_id": 7162330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38bad6a18d906f71c10b75be96a33025?s=128&d=identicon&r=PG&f=1", "display_name": "John Avlakiotis", "link": "https://stackoverflow.com/users/7162330/john-avlakiotis"}, "edited": false, "score": 0, "creation_date": 1479309063, "post_id": 40632731, "comment_id": 68503398, "body": "&lt;% @just_langs.each do |t| %&gt; &lt;%= t %&gt;&lt;br/&gt; &lt;% end %&gt;"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 21, "user_id": 7162330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38bad6a18d906f71c10b75be96a33025?s=128&d=identicon&r=PG&f=1", "display_name": "John Avlakiotis", "link": "https://stackoverflow.com/users/7162330/john-avlakiotis"}, "edited": false, "score": 0, "creation_date": 1479309366, "post_id": 40632731, "comment_id": 68503615, "body": "This should be another question. It has been answered on stackoverflow already, and if you initialize @just_langs in the corresponding action inside your controller, the above code should work."}, {"owner": {"reputation": 21, "user_id": 7162330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38bad6a18d906f71c10b75be96a33025?s=128&d=identicon&r=PG&f=1", "display_name": "John Avlakiotis", "link": "https://stackoverflow.com/users/7162330/john-avlakiotis"}, "edited": false, "score": 0, "creation_date": 1479315012, "post_id": 40632731, "comment_id": 68507686, "body": "Eric it was working ok in my console but in rails it doesnt work, everything after the hash variable is empty. I place a debugger and it breaks, and the error message I get is &quot;no implicit conversion of String into Integer&quot; for &quot;root_node = hash[&quot;Stations&quot;]     || {}&quot; Any idea why this is happening ? I believe that I need to put this in my configuration, &quot;require &#39;active_support/core_ext/hash&#39; &quot;. Any idea? Thanks again for all your trouble and time"}, {"owner": {"reputation": 21, "user_id": 7162330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38bad6a18d906f71c10b75be96a33025?s=128&d=identicon&r=PG&f=1", "display_name": "John Avlakiotis", "link": "https://stackoverflow.com/users/7162330/john-avlakiotis"}, "edited": false, "score": 0, "creation_date": 1479316193, "post_id": 40632731, "comment_id": 68508504, "body": "actually when I use @hash.kind_of?(Hash) or (Array) it returns false"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 21, "user_id": 7162330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38bad6a18d906f71c10b75be96a33025?s=128&d=identicon&r=PG&f=1", "display_name": "John Avlakiotis", "link": "https://stackoverflow.com/users/7162330/john-avlakiotis"}, "edited": false, "score": 0, "creation_date": 1479327155, "post_id": 40632731, "comment_id": 68514823, "body": "You don&#39;t need any require if you use Rails.  What does hash.class return? What does hash.inspect look like? At least the beginning if it&#39;s too long?"}, {"owner": {"reputation": 21, "user_id": 7162330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38bad6a18d906f71c10b75be96a33025?s=128&d=identicon&r=PG&f=1", "display_name": "John Avlakiotis", "link": "https://stackoverflow.com/users/7162330/john-avlakiotis"}, "edited": false, "score": 0, "creation_date": 1479371368, "post_id": 40632731, "comment_id": 68531294, "body": "@hash.inspect returns the following (the beginning) : &quot;&quot;{\\&quot;stations\\&quot;=&gt;{\\&quot;station\\&quot;=&gt;[{\\&quot;name\\&quot;=&gt;\\&quot;&#39;s-Gravenhage\\&quot;&zwnj;&#8203;, \\&quot;code\\&quot;=&gt;\\&quot;GVC\\&quot;, \\&quot;country\\&quot;=&gt;\\&quot;NL\\&quot;, \\&quot;lat\\&quot;=&gt;\\&quot;52.0802764892578\\&quot;, \\&quot;long\\&quot;=&gt;\\&quot;4.32499980926514\\&quot;, \\&quot;alias\\&quot;=&gt;\\&quot;true\\&quot;}, {\\&quot;name\\&quot;=&gt;\\&quot;&#39;s-Hertogenbosch\\&quot;, \\&quot;code\\&quot;=&gt;\\&quot;HT\\&quot;, \\&quot;country\\&quot;=&gt;\\&quot;NL\\&quot;, \\&quot;lat\\&quot;=&gt;\\&quot;51.69048\\&quot;, \\&quot;long\\&quot;=&gt;\\&quot;5.29362\\&quot;, \\&quot;alias\\&quot;=&gt;\\&quot;false\\&quot;}, {\\&quot;name\\&quot;=&gt;\\&quot;&#39;s-Hertogenbosch Oost\\&quot;, \\&quot;code\\&quot;=&gt;\\&quot;HTO\\&quot;, \\&quot;country\\&quot;=&gt;\\&quot;NL\\&quot;, \\&quot;lat\\&quot;=&gt;\\&quot;51.700553894043\\&quot;, \\&quot;long\\&quot;=&gt;\\      &quot; . It looks that the hash is alright now, but &quot;@root_node&quot;,&quot;@stations&quot; are empty hashes"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 21, "user_id": 7162330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38bad6a18d906f71c10b75be96a33025?s=128&d=identicon&r=PG&f=1", "display_name": "John Avlakiotis", "link": "https://stackoverflow.com/users/7162330/john-avlakiotis"}, "edited": false, "score": 0, "creation_date": 1479371498, "post_id": 40632731, "comment_id": 68531372, "body": "All your keys are lower case. You need to adapt the code : <code>Stations-&gt;stations</code> and so on"}, {"owner": {"reputation": 21, "user_id": 7162330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38bad6a18d906f71c10b75be96a33025?s=128&d=identicon&r=PG&f=1", "display_name": "John Avlakiotis", "link": "https://stackoverflow.com/users/7162330/john-avlakiotis"}, "edited": false, "score": 0, "creation_date": 1479371604, "post_id": 40632731, "comment_id": 68531430, "body": "controller : class ClientController &lt; ApplicationController require &#39;active_support/core_ext/hash&#39;   def index     ns_client = Ns::Client.new(&#39;username&#39;, password&#39;)     available_stations = ns_client.get_stations       hash = Hash.from_xml(available_stations)       root_node       = hash[&quot;Stations&quot;]     || {}       stations        = root_node[&quot;Station&quot;] || []       debugger       codes_and_langs = stations.compact.map do |station|         { :code       =&gt; station[&quot;Code&quot;],           :lang       =&gt; station.fetch(&#39;Namen&#39;,{})[&#39;Lang&#39;]         }       end         end end"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 21, "user_id": 7162330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38bad6a18d906f71c10b75be96a33025?s=128&d=identicon&r=PG&f=1", "display_name": "John Avlakiotis", "link": "https://stackoverflow.com/users/7162330/john-avlakiotis"}, "edited": false, "score": 0, "creation_date": 1479385323, "post_id": 40632731, "comment_id": 68540632, "body": "You&#39;re welcome. Please accept the answer if you&#39;re happy with it."}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": true, "score": 1, "last_activity_date": 1479307835, "last_edit_date": 1479307835, "creation_date": 1479300988, "answer_id": 40632731, "question_id": 40632348, "link": "https://stackoverflow.com/questions/40632348/xml-to-array-in-ruby/40632731#40632731", "title": "xml to array in ruby", "body": "<p>Here's a solution which doesn't require Rails but a small gem (xml-simple) :</p>\n\n<pre><code>#  gem install xml-simple\nrequire 'xmlsimple'\n\nstations = XmlSimple.xml_in(xml, :ForceArray =&gt; ['Station', 'Synoniem'])\n\ncodes_and_langs = stations['Station'].map{|station| {:code =&gt; station[\"Code\"], :lang =&gt; station.fetch(\"Namen\",{})[\"Lang\"]}}\nputs codes_and_langs.inspect\n#=&gt; [{:code=&gt;\"HT\", :lang=&gt;\"'s-Hertogenbosch\"}, {:code=&gt;\"HTO\", :lang=&gt;\"'s-Hertogenbosch Oost\"}]\n</code></pre>\n\n<p>If you are using Rails or have Rails installed :</p>\n\n<pre><code>require 'active_support/core_ext/hash' # &lt;- Use this line for non-Rails Ruby scripts.\n\nhash            = Hash.from_xml(xml)\nroot_node       = hash[\"Stations\"]     || {}\nstations        = root_node[\"Station\"] || []\ncodes_and_langs = stations.compact.map do |station|\n  {\n    :code       =&gt; station[\"Code\"],\n    :lang       =&gt; station.fetch('Namen',{})['Lang']\n  }\nend\nputs codes_and_langs.inspect\n#[{:code=&gt;\"HT\", :lang=&gt;\"'s-Hertogenbosch\"}, {:code=&gt;\"HTO\", :lang=&gt;\"'s-Hertogenbosch Oost\"}]\n\njust_langs = stations.compact.map do |station|\n  station.fetch('Namen',{})['Lang']\nend\n\nputs just_langs.inspect\n# [\"'s-Hertogenbosch\", \"'s-Hertogenbosch Oost\"]\n</code></pre>\n\n<p><a href=\"https://ruby-doc.org/core-2.2.0/Hash.html#method-i-fetch\" rel=\"nofollow noreferrer\">Hash#fetch</a> is used to avoid an exception if \"Namen\" isn't defined.</p>\n\n<p>Here's xml variable for both scripts :</p>\n\n<pre><code>xml=\"&lt;Stations&gt;\n    &lt;Station&gt;\n    &lt;Code&gt;HT&lt;/Code&gt;\n    &lt;Type&gt;knooppuntIntercitystation&lt;/Type&gt;\n    &lt;Namen&gt;\n    &lt;Kort&gt;Den Bosch&lt;/Kort&gt;\n    &lt;Middel&gt;'s-Hertogenbosch&lt;/Middel&gt;\n    &lt;Lang&gt;'s-Hertogenbosch&lt;/Lang&gt;\n    &lt;/Namen&gt;\n    &lt;Land&gt;NL&lt;/Land&gt;\n    &lt;UICCode&gt;8400319&lt;/UICCode&gt;\n    &lt;Lat&gt;51.69048&lt;/Lat&gt;\n    &lt;Lon&gt;5.29362&lt;/Lon&gt;\n    &lt;Synoniemen&gt;\n    &lt;Synoniem&gt;Hertogenbosch ('s)&lt;/Synoniem&gt;\n    &lt;Synoniem&gt;Den Bosch&lt;/Synoniem&gt;\n    &lt;/Synoniemen&gt;\n    &lt;/Station&gt;\n    &lt;Station&gt;\n    &lt;Code&gt;HTO&lt;/Code&gt;\n    &lt;Type&gt;stoptreinstation&lt;/Type&gt;\n    &lt;Namen&gt;\n    &lt;Kort&gt;Dn Bosch O&lt;/Kort&gt;\n    &lt;Middel&gt;Hertogenbosch O.&lt;/Middel&gt;\n    &lt;Lang&gt;'s-Hertogenbosch Oost&lt;/Lang&gt;\n    &lt;/Namen&gt;\n    &lt;Land&gt;NL&lt;/Land&gt;\n    &lt;UICCode&gt;8400320&lt;/UICCode&gt;\n    &lt;Lat&gt;51.700553894043&lt;/Lat&gt;\n    &lt;Lon&gt;5.3183331489563&lt;/Lon&gt;\n    &lt;Synoniemen&gt;\n    &lt;Synoniem&gt;Hertogenbosch Oost ('s)&lt;/Synoniem&gt;\n    &lt;Synoniem&gt;Den Bosch Oost&lt;/Synoniem&gt;\n    &lt;/Synoniemen&gt;\n    &lt;/Station&gt;\n    &lt;/Stations&gt;\n    \"\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7162330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38bad6a18d906f71c10b75be96a33025?s=128&d=identicon&r=PG&f=1", "display_name": "John Avlakiotis", "link": "https://stackoverflow.com/users/7162330/john-avlakiotis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 845, "favorite_count": 0, "accepted_answer_id": 40632731, "answer_count": 2, "score": 1, "last_activity_date": 1479307835, "creation_date": 1479299768, "last_edit_date": 1479301183, "question_id": 40632348, "link": "https://stackoverflow.com/questions/40632348/xml-to-array-in-ruby", "title": "xml to array in ruby", "body": "<p>I am new to ruby and rails programming and I need to parse an xml file that I get as a response and store the station names in an array. A sample of the xml is as follows : </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;Stations&gt;\r\n&lt;Station&gt;\r\n&lt;Code&gt;HT&lt;/Code&gt;\r\n&lt;Type&gt;knooppuntIntercitystation&lt;/Type&gt;\r\n&lt;Namen&gt;\r\n&lt;Kort&gt;Den Bosch&lt;/Kort&gt;\r\n&lt;Middel&gt;'s-Hertogenbosch&lt;/Middel&gt;\r\n&lt;Lang&gt;'s-Hertogenbosch&lt;/Lang&gt;\r\n&lt;/Namen&gt;\r\n&lt;Land&gt;NL&lt;/Land&gt;\r\n&lt;UICCode&gt;8400319&lt;/UICCode&gt;\r\n&lt;Lat&gt;51.69048&lt;/Lat&gt;\r\n&lt;Lon&gt;5.29362&lt;/Lon&gt;\r\n&lt;Synoniemen&gt;\r\n&lt;Synoniem&gt;Hertogenbosch ('s)&lt;/Synoniem&gt;\r\n&lt;Synoniem&gt;Den Bosch&lt;/Synoniem&gt;\r\n&lt;/Synoniemen&gt;\r\n&lt;/Station&gt;\r\n&lt;Station&gt;\r\n&lt;Code&gt;HTO&lt;/Code&gt;\r\n&lt;Type&gt;stoptreinstation&lt;/Type&gt;\r\n&lt;Namen&gt;\r\n&lt;Kort&gt;Dn Bosch O&lt;/Kort&gt;\r\n&lt;Middel&gt;Hertogenbosch O.&lt;/Middel&gt;\r\n&lt;Lang&gt;'s-Hertogenbosch Oost&lt;/Lang&gt;\r\n&lt;/Namen&gt;\r\n&lt;Land&gt;NL&lt;/Land&gt;\r\n&lt;UICCode&gt;8400320&lt;/UICCode&gt;\r\n&lt;Lat&gt;51.700553894043&lt;/Lat&gt;\r\n&lt;Lon&gt;5.3183331489563&lt;/Lon&gt;\r\n&lt;Synoniemen&gt;\r\n&lt;Synoniem&gt;Hertogenbosch Oost ('s)&lt;/Synoniem&gt;\r\n&lt;Synoniem&gt;Den Bosch Oost&lt;/Synoniem&gt;\r\n&lt;/Synoniemen&gt;\r\n&lt;/Station&gt;\r\n&lt;/Stations&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I need to get the Code and the Lang name in an array of hashes or just the lang name in an array. </p>\n\n<p>How can I do that in ruby ? \nthanks in advance</p>\n"}, {"tags": ["ruby", "hash"], "comments": [{"owner": {"reputation": 7638, "user_id": 1014251, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1c4500c91af486c885af8bb84eefd063?s=128&d=identicon&r=PG", "display_name": "ReggieB", "link": "https://stackoverflow.com/users/1014251/reggieb"}, "edited": false, "score": 0, "creation_date": 1479304063, "post_id": 40632080, "comment_id": 68499850, "body": "I&#39;d suggest your best option is create a parser - Have a look at <a href=\"http://www.blackbytes.info/2015/04/parsing-with-ruby/\" rel=\"nofollow noreferrer\">blackbytes.info/2015/04/parsing-with-ruby</a>"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1479312884, "post_id": 40632080, "comment_id": 68506166, "body": "The line you show after &quot;so i want the final result to be of this format with {key:value} pairs.&quot; is not valid Ruby, nor is it valid JSON or YAML. It is, in fact, not valid code or data in any language I know."}, {"owner": {"reputation": 811, "user_id": 2532972, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/a0cd5af6f706e88c63406938f8c67052?s=128&d=identicon&r=PG", "display_name": "cool77", "link": "https://stackoverflow.com/users/2532972/cool77"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1479321583, "post_id": 40632080, "comment_id": 68511688, "body": "@J&#246;rgWMittag sorry. my bad. i updated it."}, {"owner": {"reputation": 15486, "user_id": 719547, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/51e61f099c7b1ac0588ecda69193f75c?s=128&d=identicon&r=PG", "display_name": "Jim Stewart", "link": "https://stackoverflow.com/users/719547/jim-stewart"}, "edited": false, "score": 0, "creation_date": 1479329561, "post_id": 40632080, "comment_id": 68516242, "body": "Before you try to write your own parser for this, there are a number of LLDP libraries out there for Ruby. One of them probably does what you need. I can&#39;t recommend any of them particularly."}], "owner": {"reputation": 811, "user_id": 2532972, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/a0cd5af6f706e88c63406938f8c67052?s=128&d=identicon&r=PG", "display_name": "cool77", "link": "https://stackoverflow.com/users/2532972/cool77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479321467, "creation_date": 1479298913, "last_edit_date": 1479321467, "question_id": 40632080, "link": "https://stackoverflow.com/questions/40632080/convert-and-print-a-command-output-string-to-hash-object", "title": "convert and print a command output string to hash object", "body": "<p>i have a output of command stored in a string variable.\ni am trying to convert this into a hash object in ruby script.</p>\n\n<p>Here is the command output:</p>\n\n<pre><code>#lldptool get-tlv -n -i p2p1\nChassis ID TLV\n            MAC: 00:xx:xx:xx:xx:xx\n    Port ID TLV\n            Ifname: Ethernet1/3\n\n    System Capabilities TLV\n            System capabilities:  Bridge, Router\n            Enabled capabilities: Bridge\n</code></pre>\n\n<p>so i want the final result to be of this format with {key:value} pairs.</p>\n\n<pre><code>{\"Chassis ID TLV\u201d=&gt;\"00:xx:xx:xx:xx:xx\", \"Port ID TLV\u201d=&gt;\u201cEthernet1/3\u201d, \"System Capabilities TLV\"=&gt;{\"System capabilities\"=&gt;\"Bridge, Router\", \"Enabled capabilities\"=&gt;\"Bridge\"} }\n</code></pre>\n\n<p>Here is what i tried </p>\n\n<pre><code>lldp_hash = {\n    # LLDP Name    Numeric value\n    'chassisID'    =&gt; '1',\n    'portID'       =&gt; '2',\n    'System Capabilities TLV' =&gt; '3'\n  }\n\nx = `lldptool get-tlv -n -i p2p1  2&gt;/dev/null`\nx = x.split(\"\\n\")\nputs x\n</code></pre>\n\n<p>I am not figuring a way to assign the keys to the values present in the string with which i can print the above desired format of hash.\ncan someone provide some help over here.</p>\n"}, {"tags": ["ruby", "yaml"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1479298518, "post_id": 40631913, "comment_id": 68496245, "body": "Nope, that&#39;s not going to work. There&#39;s no concatenation in yaml (AFAIK)"}, {"owner": {"reputation": 18749, "user_id": 407213, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/c5T4C.jpg?s=128&g=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/407213/dorian"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1479298572, "post_id": 40631913, "comment_id": 68496286, "body": "So is there still a way to achieve the same result?"}, {"owner": {"reputation": 18749, "user_id": 407213, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/c5T4C.jpg?s=128&g=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/407213/dorian"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1479298650, "post_id": 40631913, "comment_id": 68496331, "body": "You mean a <code>.yml.erb</code> I guess"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1479298679, "post_id": 40631913, "comment_id": 68496352, "body": "Depends on how you&#39;re seeing content of that <code>.yml.erb</code> :)"}], "answers": [{"tags": [], "owner": {"reputation": 23530, "user_id": 347964, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bE90m.png?s=128&g=1", "display_name": "flyx", "link": "https://stackoverflow.com/users/347964/flyx"}, "is_accepted": true, "score": 18, "last_activity_date": 1479299098, "creation_date": 1479299098, "answer_id": 40632158, "question_id": 40631913, "link": "https://stackoverflow.com/questions/40631913/concatenation-of-yaml-anchors-with-another-string-in-keys/40632158#40632158", "title": "Concatenation of YAML &quot;anchors&quot; with another string in keys", "body": "<p>YAML is not a programming language and in general does not provide the tool for doing what you want.</p>\n\n<p>However, if you really want to do something like this, nothing hinders you from defining some tag <code>!concat</code> and implement it in a way that lets you do</p>\n\n<pre><code>a:\n  b: &amp;b \"hello\"\n  c: !concat [*b, \"world\"]\n</code></pre>\n\n<p>The important thing is: You need to implement this yourself on the loading  side. And that idea is not too exotic; there is a (non-standard) definition for a <code>!!merge</code> tag which does similar things to mappings <a href=\"http://yaml.org/type/merge.html\" rel=\"noreferrer\">here</a>, and some YAML implementations support that. But it did not find its way into the standard for good reasons. Rule of thumb: If you want to do something like this, YAML is probably not the right tool for you.</p>\n"}], "owner": {"reputation": 18749, "user_id": 407213, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/c5T4C.jpg?s=128&g=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/407213/dorian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9803, "favorite_count": 2, "accepted_answer_id": 40632158, "answer_count": 1, "score": 7, "last_activity_date": 1604675230, "creation_date": 1479298403, "question_id": 40631913, "link": "https://stackoverflow.com/questions/40631913/concatenation-of-yaml-anchors-with-another-string-in-keys", "title": "Concatenation of YAML &quot;anchors&quot; with another string in keys", "body": "<p>So I want to turn this:</p>\n\n<pre><code>a:\n  b: &amp;b \"hello\"\n  c: *b \"world\"\n</code></pre>\n\n<p>Into this: <code>{\"a\"=&gt;{\"b\"=&gt;\"hello\", \"c\"=&gt;\"hello world\"}}</code></p>\n\n<p>But right now I get <code>did not find expected key while parsing a block mapping at line 2 column 3</code>.</p>\n\n<p>I know that this works fine:</p>\n\n<pre><code>a:\n  b: &amp;b \"hello\"\n  c: *b\n</code></pre>\n\n<p>(I learned from <a href=\"https://learnxinyminutes.com/docs/yaml/\" rel=\"noreferrer\">learnxinyminutes</a> and also tries some <code>%() %{} #{} ..</code> syntaxes but none of them worked)</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 726, "user_id": 5444429, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ilkli8KLysI/AAAAAAAAAAI/AAAAAAAAAs0/O_XiRHBDJhI/photo.jpg?sz=128", "display_name": "johnnymnmonic", "link": "https://stackoverflow.com/users/5444429/johnnymnmonic"}, "edited": false, "score": 0, "creation_date": 1479300415, "post_id": 40631160, "comment_id": 68497502, "body": "be sure that your partial is named as the convention  &quot;_&lt;partial-name&gt;&quot;"}, {"owner": {"reputation": 197, "user_id": 3062123, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f22e8387fbbb53de06f097103c55c0d4?s=128&d=identicon&r=PG&f=1", "display_name": "user3062123", "link": "https://stackoverflow.com/users/3062123/user3062123"}, "reply_to_user": {"reputation": 726, "user_id": 5444429, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ilkli8KLysI/AAAAAAAAAAI/AAAAAAAAAs0/O_XiRHBDJhI/photo.jpg?sz=128", "display_name": "johnnymnmonic", "link": "https://stackoverflow.com/users/5444429/johnnymnmonic"}, "edited": false, "score": 0, "creation_date": 1479300532, "post_id": 40631160, "comment_id": 68497576, "body": "Yeah the partials are all named correctly, for the example above, the partial is &quot;_profile-card.html.slim&quot;"}], "owner": {"reputation": 197, "user_id": 3062123, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f22e8387fbbb53de06f097103c55c0d4?s=128&d=identicon&r=PG&f=1", "display_name": "user3062123", "link": "https://stackoverflow.com/users/3062123/user3062123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479296229, "creation_date": 1479296229, "question_id": 40631160, "link": "https://stackoverflow.com/questions/40631160/rails-rendering-partial-from-inside-a-submodule", "title": "Rails rendering partial from inside a submodule", "body": "<p>I have a submodule that sits in the root directory within my rails application. It's effectively another rails app, with modules that i wish to keep external so they can be used in other applications I build. I'm currently trying to render a partial within the submodules's views folder, the class that is actually trying to do the rendering is also within the submodule, however the call to said class is in a view within the main rails application. </p>\n\n<p>It seems to throw an undefined method error, that it does not understand the \"render\" method, even though the suggestion is a \"_renderers\" method which i'm under the impression is also a rails method. So by that logic I'm assuming that it does understand rails methods, it just doesn't like render.</p>\n\n<p>Is it not possible to call the render method from within a submodule, or is there some sort of require issue that i need to solve in order use render?</p>\n\n<p>Module calling render (root/submodule_name/app/controllers/submodule_name/application_controller.rb): </p>\n\n<pre><code>require 'ostruct'\n\nmodule Pugin\n  class ApplicationController &lt; ActionController::Base\n    protect_from_forgery with: :exception\n\n    def self.get_component(component_name, model = nil)\n        if model.is_a?(Hash)\n            model = OpenStruct.new(model)\n            render :partial =&gt; \"layouts/pugin/#{component_name}\", locals: {object: model}\n        else\n            render :partial =&gt; \"layouts/pugin/#{component_name}\", locals: {object: model}\n        end\n    end\n\n  end\nend\n</code></pre>\n\n<p>View calling module (root/app/views/people/show.html.slim):</p>\n\n<pre><code>= PUGIN.get_component('modules/profile-card', @person)\n</code></pre>\n\n<p>N.B PUGIN is a constant that resolves to Module::Class </p>\n"}, {"tags": ["arrays", "ruby", "duplicates"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1479296886, "post_id": 40631085, "comment_id": 68495227, "body": "This question has nothing to do with <a href=\"https://stackoverflow.com/questions/tagged/ruby-on-rails\">ruby-on-rails</a>, tag removed."}], "answers": [{"comments": [{"owner": {"reputation": 667, "user_id": 6589814, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/FzUlF.png?s=128&g=1", "display_name": "Rubioli", "link": "https://stackoverflow.com/users/6589814/rubioli"}, "edited": false, "score": 0, "creation_date": 1479297147, "post_id": 40631149, "comment_id": 68495383, "body": "Thanks @mudasobwa :)"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 7, "last_activity_date": 1479296541, "last_edit_date": 1479296541, "creation_date": 1479296202, "answer_id": 40631149, "question_id": 40631085, "link": "https://stackoverflow.com/questions/40631085/find-most-duplicated-numbers-inside-a-array/40631149#40631149", "title": "Find most duplicated numbers inside a array", "body": "<pre><code>\u25b6 arr.group_by { |e| e } # arr.group_by(&amp;:itself) for Ruby &gt;= 2.2\n     .map { |k, v| [k, v.count] } #\u21d2\u00a0[[1, 3], [2, 5], [3, 4], [4, 2], [5, 2]]\n     .sort_by { |(_, cnt)| -cnt } #\u21d2\u00a0[[2, 5], [3, 4], [1, 3], [4, 2], [5, 2]]\n     .take(3)                     #\u21d2 [[2, 5], [3, 4], [1, 3]]\n     .map(&amp;:first)\n#\u21d2 [2, 3, 1]\n</code></pre>\n\n<p>Remove three last clauses to get the whole unsorted result.</p>\n"}, {"tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 3, "last_activity_date": 1479296798, "last_edit_date": 1479296798, "creation_date": 1479296494, "answer_id": 40631256, "question_id": 40631085, "link": "https://stackoverflow.com/questions/40631085/find-most-duplicated-numbers-inside-a-array/40631256#40631256", "title": "Find most duplicated numbers inside a array", "body": "<p>To get a count of duplicated entries per duplicate you can go with:</p>\n\n<pre><code>arr.group_by(&amp;:itself)\n   .each_with_object({}) {|(k, v), hash| hash[k] = v.size }\n#=&gt; {1=&gt;3, 2=&gt;5, 3=&gt;4, 4=&gt;2, 5=&gt;2}\n</code></pre>\n\n<p>To get 3 most duplicated entries:</p>\n\n<pre><code>arr.group_by(&amp;:itself)\n   .sort_by { |_k, v| -v.size }\n   .take(3)\n   .map(&amp;:first)\n#=&gt; [2, 3, 1]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2889, "user_id": 3079520, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/LfkPU.jpg?s=128&g=1", "display_name": "dnsh", "link": "https://stackoverflow.com/users/3079520/dnsh"}, "is_accepted": false, "score": 0, "last_activity_date": 1479297629, "creation_date": 1479297629, "answer_id": 40631665, "question_id": 40631085, "link": "https://stackoverflow.com/questions/40631085/find-most-duplicated-numbers-inside-a-array/40631665#40631665", "title": "Find most duplicated numbers inside a array", "body": "<p>1) How many duplicates of each number is it?</p>\n\n<pre><code>counts = Hash[arr.uniq.map{|_x| [_x, arr.count(_x)]}]\n=&gt; {1=&gt;3, 2=&gt;5, 3=&gt;4, 4=&gt;2, 5=&gt;2}\n</code></pre>\n\n<p>2) Find 3 most duplicated numbers in the array</p>\n\n<pre><code>counts.sort_by { |a, b| -b }.take(3).map(&amp;:first)\n=&gt; [2, 3, 1]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1479322820, "creation_date": 1479322820, "answer_id": 40640194, "question_id": 40631085, "link": "https://stackoverflow.com/questions/40631085/find-most-duplicated-numbers-inside-a-array/40640194#40640194", "title": "Find most duplicated numbers inside a array", "body": "<pre><code>arr = [1, 2, 3, 4, 5, 1, 2, 5, 3, 4, 2, 3, 1, 3, 2, 2]\n</code></pre>\n\n<p>I suggest using a counting hash (see the reference to \"default value\" at <a href=\"http://ruby-doc.org/core-2.3.0/Hash.html#method-c-new\" rel=\"nofollow noreferrer\">Hash::new</a>):</p>\n\n<pre><code>h = arr.each_with_object(Hash.new(0)) { |n,h| h[n] += 1 }\n  # =&gt; {1=&gt;3, 2=&gt;5, 3=&gt;4, 4=&gt;2, 5=&gt;2}\n</code></pre>\n\n<p>and use the method <a href=\"http://ruby-doc.org/core-2.3.0/Enumerable.html#method-i-max_by\" rel=\"nofollow noreferrer\">Enumerable#max_by</a> with an argument of <code>3</code> to obtain the three keys of <code>h</code> having the largest values:</p>\n\n<pre><code>h.max_by(3, &amp;:last).map(&amp;:first)\n  #=&gt; [2, 3, 1]\n</code></pre>\n\n<p>Note that if <code>h</code> is largish, using <code>max_by</code> with an argument is more efficient that using <a href=\"http://ruby-doc.org/core-2.3.0/Enumerable.html#method-i-sort_by\" rel=\"nofollow noreferrer\">Enumerable#sort_by</a> or <a href=\"http://ruby-doc.org/core-2.3.0/Array.html#method-i-sort\" rel=\"nofollow noreferrer\">Array#sort</a> and then discarding all but the three largest values. The <code>Enumerable</code> methods <code>max_by</code>, <code>min_by</code> <code>max</code> and <code>min</code> were changed to permit an argument (which defaults to <code>1</code>) in Ruby v2.2.</p>\n"}], "owner": {"reputation": 667, "user_id": 6589814, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/FzUlF.png?s=128&g=1", "display_name": "Rubioli", "link": "https://stackoverflow.com/users/6589814/rubioli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 40631256, "answer_count": 4, "score": 0, "last_activity_date": 1479322820, "creation_date": 1479296026, "last_edit_date": 1479297543, "question_id": 40631085, "link": "https://stackoverflow.com/questions/40631085/find-most-duplicated-numbers-inside-a-array", "title": "Find most duplicated numbers inside a array", "body": "<p>I have the following array</p>\n\n<pre><code>[1, 2, 3, 4, 5, 1, 2, 5, 3, 4, 2, 3, 1, 3, 2, 2]`\n</code></pre>\n\n<p>I want to find out 2 things:</p>\n\n<p>1) How many duplicates of each number is it?</p>\n\n<p>For instance: <strong>1, 3 times</strong>, <strong>4, 2 times</strong> etc.</p>\n\n<p>2) Find 3 most duplicated numbers in the <code>array</code>. </p>\n\n<p>For instance: <code>[2, 3, 1]</code> since <strong>2</strong> is duplicated <strong>5 times</strong>, <strong>3</strong> is duplicated <strong>4 times</strong> &amp; <strong>1</strong> is duplicated <strong>3 times</strong>.</p>\n\n<p>I have tried </p>\n\n<pre><code>arr = [1, 2, 3, 4, 5, 1, 2, 5, 3, 4, 2, 3, 1, 3, 2, 2]\n= arr.group_by { |e| e }.map { |e| e[0] if e[1][1] }.compact\n</code></pre>\n\n<p>But results are not what I am looking for: <code>[1, 2, 3, 4, 5]</code></p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 3154, "user_id": 5409748, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/DQWhS.jpg?s=128&g=1", "display_name": "Jai Kumar Rajput", "link": "https://stackoverflow.com/users/5409748/jai-kumar-rajput"}, "edited": false, "score": 0, "creation_date": 1479296013, "post_id": 40630902, "comment_id": 68494672, "body": "UserTransactions will throws an error of &quot;NameError: uninitialized constant UserTransactions&quot; so you should use UserTransaction instead of UserTransactions."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 3154, "user_id": 5409748, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/DQWhS.jpg?s=128&g=1", "display_name": "Jai Kumar Rajput", "link": "https://stackoverflow.com/users/5409748/jai-kumar-rajput"}, "edited": false, "score": 0, "creation_date": 1479296038, "post_id": 40630902, "comment_id": 68494684, "body": "@JaiKumarRajput it&#39;s a typo"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 1, "last_activity_date": 1479296230, "last_edit_date": 1479296230, "creation_date": 1479295418, "answer_id": 40630902, "question_id": 40630797, "link": "https://stackoverflow.com/questions/40630797/sorting-by-another-related-model-attributes-ruby-on-rails/40630902#40630902", "title": "Sorting by another related model attributes - Ruby on Rails", "body": "<pre><code>UserTransaction.joins(:weed).order('weeds.county DESC')\nUserTransaction.joins(:weed).where(weeds: { county: 'something' }).order('weeds.county DESC')\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3154, "user_id": 5409748, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/DQWhS.jpg?s=128&g=1", "display_name": "Jai Kumar Rajput", "link": "https://stackoverflow.com/users/5409748/jai-kumar-rajput"}, "is_accepted": false, "score": 1, "last_activity_date": 1479296092, "last_edit_date": 1479296092, "creation_date": 1479295886, "answer_id": 40631039, "question_id": 40630797, "link": "https://stackoverflow.com/questions/40630797/sorting-by-another-related-model-attributes-ruby-on-rails/40631039#40631039", "title": "Sorting by another related model attributes - Ruby on Rails", "body": "<p>If you want to sort by <strong>county</strong> you can do like this:</p>\n\n<pre><code>UserTransaction.joins(:weed).order(\"weeds.county DESC\")\n</code></pre>\n\n<p>or if you want to find by <strong>county</strong> then use :</p>\n\n<pre><code>UserTransaction.joins(:weed).where(\"weeds.county\"=&gt; \"xyz\")\n</code></pre>\n"}], "owner": {"reputation": 315, "user_id": 6056677, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-B72_N5GQ-zo/AAAAAAAAAAI/AAAAAAAAAFw/pKrxdPKBz_U/photo.jpg?sz=128", "display_name": "Priyadarshani mini", "link": "https://stackoverflow.com/users/6056677/priyadarshani-mini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 40630902, "answer_count": 2, "score": 0, "last_activity_date": 1479300822, "creation_date": 1479295052, "last_edit_date": 1479300822, "question_id": 40630797, "link": "https://stackoverflow.com/questions/40630797/sorting-by-another-related-model-attributes-ruby-on-rails", "title": "Sorting by another related model attributes - Ruby on Rails", "body": "<p>I have two models related with each other as below </p>\n\n<pre><code>class Weed &lt; ApplicationRecord\n  has_many :user_transactions, :dependent =&gt; :destroy\nend\n</code></pre>\n\n<p>This <strong>weed</strong> model has an attribute name <strong>county</strong></p>\n\n<p>and related model:</p>\n\n<pre><code>class UserTransaction &lt; ApplicationRecord\n  belongs_to :weed\nend\n</code></pre>\n\n<p>Now I want to fetch records from <strong>UserTransaction</strong> model on the basis of sort by <strong>county</strong> in weed model and find by county too.</p>\n\n<p>Please suggest me, How can I get correct result with in minimum complexity.</p>\n\n<p>Thanks. </p>\n"}, {"tags": ["ruby", "date", "time"], "answers": [{"comments": [{"owner": {"reputation": 502, "user_id": 5784552, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DyhW1dw4T0U/AAAAAAAAAAI/AAAAAAAAAgQ/baMfIvwdbCk/photo.jpg?sz=128", "display_name": "Murad Yusufov", "link": "https://stackoverflow.com/users/5784552/murad-yusufov"}, "reply_to_user": {"reputation": 359, "user_id": 3351074, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c13f448bcfcb5888535be4ce1db1df2f?s=128&d=identicon&r=PG&f=1", "display_name": "priyanka", "link": "https://stackoverflow.com/users/3351074/priyanka"}, "edited": false, "score": 0, "creation_date": 1479362866, "post_id": 40630998, "comment_id": 68527009, "body": "Uhm, why? <code>to_f</code> does give milliseconds. <code>Time.now.to_f =&gt; 1479362805.960119</code>. There are 6 digits after the point, but you need the first three, hence <code>* 1000</code> and <code>round</code>"}], "tags": [], "owner": {"reputation": 502, "user_id": 5784552, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DyhW1dw4T0U/AAAAAAAAAAI/AAAAAAAAAgQ/baMfIvwdbCk/photo.jpg?sz=128", "display_name": "Murad Yusufov", "link": "https://stackoverflow.com/users/5784552/murad-yusufov"}, "is_accepted": true, "score": 0, "last_activity_date": 1479295754, "creation_date": 1479295754, "answer_id": 40630998, "question_id": 40630723, "link": "https://stackoverflow.com/questions/40630723/how-to-get-epoch-time-in-to-milli-seconds-from-date-object-in-ruby/40630998#40630998", "title": "how to get epoch time in to milli seconds from Date object in ruby?", "body": "<p><code>t = DateTime.now.to_f * 1000; t.round</code></p>\n"}], "owner": {"reputation": 359, "user_id": 3351074, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c13f448bcfcb5888535be4ce1db1df2f?s=128&d=identicon&r=PG&f=1", "display_name": "priyanka", "link": "https://stackoverflow.com/users/3351074/priyanka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 40630998, "answer_count": 1, "score": 2, "last_activity_date": 1479295800, "creation_date": 1479294846, "question_id": 40630723, "link": "https://stackoverflow.com/questions/40630723/how-to-get-epoch-time-in-to-milli-seconds-from-date-object-in-ruby", "title": "how to get epoch time in to milli seconds from Date object in ruby?", "body": "<p>In Ruby, I want to convert a date object into a accurate 13 digit epoch time(Similar to how java gives). </p>\n\n<p>So for that function if I give the below input, it should give me the below output\nInput : November 16,00:00:00.300 IST\nOuput : 1479234600300</p>\n"}, {"tags": ["ruby", "liquid", "jekyll-extensions"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1479291997, "post_id": 40629622, "comment_id": 68492051, "body": "Judging from the code, I&#39;d expect &quot;Output de HELLO&quot;, not &quot;Output de 1234 HELLO&quot;."}, {"owner": {"reputation": 6654, "user_id": 690771, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3d3e8ce8b1c1dfdd10d21460386a2c05?s=128&d=identicon&r=PG", "display_name": "Christian", "link": "https://stackoverflow.com/users/690771/christian"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1479292136, "post_id": 40629622, "comment_id": 68492163, "body": "@SergioTulentsev No, it&#39;s exactly like I wrote above. The argument is taken as a full string. You have to split the arguments on your own with Liquid (people say)."}, {"owner": {"reputation": 2788, "user_id": 4152876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d538506cb7d350250906243645c28d4?s=128&d=identicon&r=PG", "display_name": "Timo Schilling", "link": "https://stackoverflow.com/users/4152876/timo-schilling"}, "edited": false, "score": 0, "creation_date": 1479292494, "post_id": 40629622, "comment_id": 68492424, "body": "Whats happen if you change <code>&quot;Output  #{@text} #{@xyz}&quot;</code> to <code>&quot;Output  #{@text} &#39;#{@xyz}&#39;&quot;</code>?"}, {"owner": {"reputation": 6654, "user_id": 690771, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3d3e8ce8b1c1dfdd10d21460386a2c05?s=128&d=identicon&r=PG", "display_name": "Christian", "link": "https://stackoverflow.com/users/690771/christian"}, "reply_to_user": {"reputation": 2788, "user_id": 4152876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d538506cb7d350250906243645c28d4?s=128&d=identicon&r=PG", "display_name": "Timo Schilling", "link": "https://stackoverflow.com/users/4152876/timo-schilling"}, "edited": false, "score": 0, "creation_date": 1479292649, "post_id": 40629622, "comment_id": 68492532, "body": "@TimoSchilling It outputs <code>Output de 1234 &#39;&#39;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 6654, "user_id": 690771, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3d3e8ce8b1c1dfdd10d21460386a2c05?s=128&d=identicon&r=PG", "display_name": "Christian", "link": "https://stackoverflow.com/users/690771/christian"}, "edited": false, "score": 0, "creation_date": 1479292708, "post_id": 40629835, "comment_id": 68492568, "body": "I can confirm I have the same output running it from the CLI. It&#39;s still broken when using it combined with Jekyll."}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 2, "last_activity_date": 1479292362, "creation_date": 1479292362, "answer_id": 40629835, "question_id": 40629622, "link": "https://stackoverflow.com/questions/40629622/ruby-why-isnt-my-member-set-in-initialize/40629835#40629835", "title": "Ruby: why isn&#39;t my member set in initialize?", "body": "<p>Your code seems to work fine with Ruby 2.1.5 and liquid-3.0.6 :</p>\n\n<pre><code>require 'liquid'\nmodule MyModule\n  class MyTag &lt; Liquid::Tag\n    def initialize(tag_name, text, tokens)\n      super\n      @text = text\n      @xyz = \"HELLO\"\n    end\n\n    def render(context)\n      \"Output  #{@text} #{@xyz}\"\n    end\n  end\nend\n\nLiquid::Template.register_tag('my_tag', MyModule::MyTag)\n\n@template = Liquid::Template.parse(\"{% my_tag de 1234 %}\")\nputs @template.render\n#=&gt; \"Output  de 1234  HELLO\"\n</code></pre>\n"}], "owner": {"reputation": 6654, "user_id": 690771, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3d3e8ce8b1c1dfdd10d21460386a2c05?s=128&d=identicon&r=PG", "display_name": "Christian", "link": "https://stackoverflow.com/users/690771/christian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1479292362, "creation_date": 1479291809, "question_id": 40629622, "link": "https://stackoverflow.com/questions/40629622/ruby-why-isnt-my-member-set-in-initialize", "title": "Ruby: why isn&#39;t my member set in initialize?", "body": "<p>I have trouble understanding why my below code fails partially. I try to create Liquid tag for Jekyll. While the the class member \"text\" is set, the member \"xyz\" is not set at all. But why?</p>\n\n<pre><code>module MyModule\n  class MyTag &lt; Liquid::Tag\n    def initialize(tag_name, text, tokens)\n      super\n      @text = text\n      @xyz = \"HELLO\"\n    end\n\n    def render(context)\n      \"Output  #{@text} #{@xyz}\"\n    end\n  end\nend\n\nLiquid::Template.register_tag('my_tag', MyModule::MyTag)\n</code></pre>\n\n<p>With calling the following</p>\n\n<pre><code>{% my_tag de 1234 %}\n</code></pre>\n\n<p>The output of the above is:</p>\n\n<pre><code>Output de 1234\n</code></pre>\n\n<p>I expected there would be \"HELLO\" as well, like:</p>\n\n<pre><code>Output de 1234 HELLO\n</code></pre>\n\n<p>What do I miss?</p>\n\n<p>The original code from <a href=\"https://github.com/Shopify/liquid/blob/master/lib/liquid/tag.rb\" rel=\"nofollow noreferrer\">the Liquid class is here</a>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "params"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7157111, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ea17b31c0cd398441a3a9e5a72363e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Jutta", "link": "https://stackoverflow.com/users/7157111/jutta"}, "edited": false, "score": 0, "creation_date": 1479292220, "post_id": 40629267, "comment_id": 68492235, "body": "Thank you. That helped for declaring my offset params in the controller. That leaves the question how to change that now in the view? I put this in the view but nothing happened. &lt;% params[:offset] = 10 %&gt;. How to set this params[:offset] to 10 in the view now?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 1, "user_id": 7157111, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ea17b31c0cd398441a3a9e5a72363e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Jutta", "link": "https://stackoverflow.com/users/7157111/jutta"}, "edited": false, "score": 0, "creation_date": 1479294377, "post_id": 40629267, "comment_id": 68493684, "body": "I am not sure I understand the intent \u201cto set this params[:offset] to 10 in the view,\u201d but you probably need to declare another <code>text_field</code> for it, or like."}, {"owner": {"reputation": 1, "user_id": 7157111, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ea17b31c0cd398441a3a9e5a72363e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Jutta", "link": "https://stackoverflow.com/users/7157111/jutta"}, "edited": false, "score": 0, "creation_date": 1479308482, "post_id": 40629267, "comment_id": 68502966, "body": "bing is only giving 50 search results maximum. To call for the next 50 results you have to change the offset to lets say 51. Then the results 51 till 100 are shown. &lt;%= text_field_tag :offset, params[:offset] || 10 %&gt; I put this now. And it worked :) Thank you so much ..."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1479290863, "creation_date": 1479290863, "answer_id": 40629267, "question_id": 40629007, "link": "https://stackoverflow.com/questions/40629007/call-ruby-method-with-2-params-that-are-changed-in-view/40629267#40629267", "title": "Call ruby method with 2 params that are changed in view", "body": "<p>Method <code>Search.bing_results_web</code> accepts <strong>two parameters</strong>, and <code>params</code> is <strong>a hash</strong>:</p>\n\n<pre><code>def search_m4o\n  if params[:search_web]\n    @search_web = Search.bing_results_web(\n      params[:search_web], params[:offset] || 0\n    )\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7157111, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ea17b31c0cd398441a3a9e5a72363e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Jutta", "link": "https://stackoverflow.com/users/7157111/jutta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479299504, "creation_date": 1479290247, "last_edit_date": 1479299504, "question_id": 40629007, "link": "https://stackoverflow.com/questions/40629007/call-ruby-method-with-2-params-that-are-changed-in-view", "title": "Call ruby method with 2 params that are changed in view", "body": "<p>I want to send an API Request using the gem searchbing and defined the following method in my Model. I succeed to get search results but do not know how to change my offset in the view using pagination links.</p>\n\n<p>Model <strong>Search.rb</strong></p>\n\n<pre><code>def self.bing_results_web(search_term_web, offset = 0)\n  bing_results = bing_web.search(search_term_web, offset)\nend\n</code></pre>\n\n<p>Controller <strong>searchs_controller.rb</strong></p>\n\n<pre><code>def search_m4o\n    if params[:search_web, :offset]\n        @search_web = Search.bing_results_web(params[:search_web, :offset])\n    end\nend\n</code></pre>\n\n<p>View</p>\n\n<pre><code>&lt;%= text_field_tag :search_web, \n            params[:search_web], \n            placeholder: \"#Web Search\",\n            autofocus: true,\n            class: 'form-control search-box input-lg' %&gt;\n</code></pre>\n\n<p>The textfield works fine giving search results (as long as I do not add :offset to the params).So I do not know how to put my Params[:offset] properly starting with 0 and then adding 10 or 50 every time I click on a pagination link.</p>\n\n<p>Anyone an idea?</p>\n"}, {"tags": ["ruby", "homebrew", "rbenv", "homebrew-cask"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1479295563, "post_id": 40628794, "comment_id": 68494420, "body": "can you run <code>brew update</code> normally?"}, {"owner": {"reputation": 130, "user_id": 650892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9392c4665851a8ee1e9c3c120767fc86?s=128&d=identicon&r=PG", "display_name": "balduran", "link": "https://stackoverflow.com/users/650892/balduran"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1479308119, "post_id": 40628794, "comment_id": 68502672, "body": "Yes, <code>brew update</code> and <code>brew upgrade</code> can be executed normally."}], "owner": {"reputation": 130, "user_id": 650892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9392c4665851a8ee1e9c3c120767fc86?s=128&d=identicon&r=PG", "display_name": "balduran", "link": "https://stackoverflow.com/users/650892/balduran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479289718, "creation_date": 1479289718, "question_id": 40628794, "link": "https://stackoverflow.com/questions/40628794/permission-denied-when-executing-brew-cask-command", "title": "Permission denied when executing brew cask command", "body": "<pre><code>$ brew cask install alfred\nError: Permission denied - /Library/Ruby/Gems/2.0.0/extensions/universal-darwin-16\n</code></pre>\n\n<p>My mac system had been upgraded to 10.12. I didn't execute <code>brew cask</code> before, but I did use homebrew to install some command line tools. No idea how and why it will report error about permission.</p>\n\n<p>I checked my system, under <code>/Library/Ruby/Gems/2.0.0/extensions/</code>, there're universal-darwin-13 and universal-darwin-14.  Also, I use rbenv for ruby environment management. ruby version is 2.3.1</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "field", "rails-admin"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1479288896, "post_id": 40628284, "comment_id": 68490037, "body": "it is unclear for me what you asking."}, {"owner": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1479292087, "post_id": 40628284, "comment_id": 68492121, "body": "@\u0417\u0435\u043b\u0451\u043d\u044b\u0439 I have now updated the question with more details. I just want to reset that field once the page has loaded and displayed all of those entries"}, {"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1479292260, "post_id": 40628284, "comment_id": 68492266, "body": "you can&#39;t <i>reset</i> ruby variable <i>after</i> the form is rendered. Use javascript to manipulate rendered html."}, {"owner": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1479293646, "post_id": 40628284, "comment_id": 68493203, "body": "And can you provide an example on how to achieve this? Thanks!"}, {"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1479294026, "post_id": 40628284, "comment_id": 68493465, "body": "Use search, internet has a lot of examples."}, {"owner": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1479294533, "post_id": 40628284, "comment_id": 68493798, "body": "That&#39;s why I asked the question here, because I couldn&#39;t find anything that could solve this"}, {"owner": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1479300833, "post_id": 40628284, "comment_id": 68497778, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/128262/discussion-between-vlad-balanescu-and-\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "is_accepted": true, "score": 0, "last_activity_date": 1479310587, "creation_date": 1479310587, "answer_id": 40636113, "question_id": 40628284, "link": "https://stackoverflow.com/questions/40628284/reset-rails-admin-field-value/40636113#40636113", "title": "Reset rails_admin field value", "body": "<p>[SOLVED]</p>\n\n<p>I left the <code>field :id</code> in the initializer and overrid <code>app/views/rails_admin/main/index.html.haml with</code></p>\n\n<pre><code>%th.last.shrink\n  %tbody\n    - currentId = 1\n    - @objects.each do |object|\n      %tr{class: \"#{@abstract_model.param_key}_row\"}\n        %td\n          = check_box_tag \"bulk_ids[]\", object.id, false\n        - if @other_left_link ||= other_left &amp;&amp; index_path(params.except('set').merge(params[:set].to_i != 1 ? {set: (params[:set].to_i - 1)} : {}))\n          %td.other.left= link_to \"...\", @other_left_link, class: 'pjax'\n        - properties.map{ |property| property.bind(:object, object) }.each do |property|\n          - if property.name.to_s == \"id\"\n            - value = currentId\n            - currentId += 1\n          - else\n            - value = property.pretty_value\n</code></pre>\n"}], "owner": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 40636113, "answer_count": 1, "score": 0, "last_activity_date": 1479384424, "creation_date": 1479288322, "last_edit_date": 1479384424, "question_id": 40628284, "link": "https://stackoverflow.com/questions/40628284/reset-rails-admin-field-value", "title": "Reset rails_admin field value", "body": "<p>I want to do a current number, rather than a proper database id field in the list view on my dashboard. For this, I am using <code>formatted_value</code> from <code>rails_admin</code>. The only thing is, I want to reset that value after the form is rendered, because after I reload the page, that id keeps incrementing, and never goes back to 0. How can I reset the <code>formatted_value</code> on a field in rails admin. So far I tried this without much luck:</p>\n\n<p><code>config/initializers/rails_admin.rb</code></p>\n\n<pre><code>  currentId = 0\n  # Fields in Projects list\n  config.model 'Project' do\n    list do\n      field :id do\n        formatted_value do\n          currentId += 1\n        end\n      end\n      field :year\n      field :title\n      field :intro\n      field :description\n      field :confidential\n      field :star\n      field :image\n    end\n    currentId = 0\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 346, "user_id": 4952010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HlF1M.jpg?s=128&g=1", "display_name": "Vladan Markovic", "link": "https://stackoverflow.com/users/4952010/vladan-markovic"}, "reply_to_user": {"reputation": 273, "user_id": 6547385, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10153614401007371/picture?type=large", "display_name": "Lee Eather", "link": "https://stackoverflow.com/users/6547385/lee-eather"}, "edited": false, "score": 0, "creation_date": 1479292916, "post_id": 40628955, "comment_id": 68492703, "body": "Do you have password as required field set in your Database?"}, {"owner": {"reputation": 346, "user_id": 4952010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HlF1M.jpg?s=128&g=1", "display_name": "Vladan Markovic", "link": "https://stackoverflow.com/users/4952010/vladan-markovic"}, "reply_to_user": {"reputation": 273, "user_id": 6547385, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10153614401007371/picture?type=large", "display_name": "Lee Eather", "link": "https://stackoverflow.com/users/6547385/lee-eather"}, "edited": false, "score": 0, "creation_date": 1479294172, "post_id": 40628955, "comment_id": 68493552, "body": "if schema says t.string &quot;password&quot;, :null =&gt; false  then you need to run migration on database and change it to  t.string &quot;password&quot;, :null =&gt; true"}, {"owner": {"reputation": 273, "user_id": 6547385, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10153614401007371/picture?type=large", "display_name": "Lee Eather", "link": "https://stackoverflow.com/users/6547385/lee-eather"}, "edited": false, "score": 0, "creation_date": 1479294603, "post_id": 40628955, "comment_id": 68493846, "body": "ahh no, it says nothing. I am fairly sure it is a bcrypt problem after searching seeing as I was getting the same results. I think the other answer, adding attr_accessor :password solves the problem. Thanks for your help."}], "tags": [], "owner": {"reputation": 346, "user_id": 4952010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HlF1M.jpg?s=128&g=1", "display_name": "Vladan Markovic", "link": "https://stackoverflow.com/users/4952010/vladan-markovic"}, "is_accepted": false, "score": 1, "last_activity_date": 1479290112, "creation_date": 1479290112, "answer_id": 40628955, "question_id": 40628202, "link": "https://stackoverflow.com/questions/40628202/using-attr-accessor-in-rails-trying-to-skip-validations/40628955#40628955", "title": "Using attr_accessor in rails trying to skip validations", "body": "<p>You could pass skip_password parameter to your instance function:</p>\n\n<pre><code> def self.from_omniauth(auth, skip_password)\nwhere(provider: auth.provider, uid: auth.uid).first_or_create do |user|\n  user.provider = auth.provider\n  user.uid = auth.uid\n  user.name = auth.info.name\n  user.email = auth.info.email\n  user.oauth_token = auth.credentials.token\n  user.oauth_expires_at = Time.at(auth.credentials.expires_at)\n\n  user.skip_password_validation = skip_password\n\n  user.save!\nend\n</code></pre>\n\n<p>end</p>\n\n<p>And then call it like this:</p>\n\n<pre><code>user = User.from_omniauth(env[\"omniauth.auth\"], true)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 189, "user_id": 3368222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DN3yr.jpg?s=128&g=1", "display_name": "Pratap", "link": "https://stackoverflow.com/users/3368222/pratap"}, "is_accepted": false, "score": 0, "last_activity_date": 1479292728, "creation_date": 1479292728, "answer_id": 40629967, "question_id": 40628202, "link": "https://stackoverflow.com/questions/40628202/using-attr-accessor-in-rails-trying-to-skip-validations/40629967#40629967", "title": "Using attr_accessor in rails trying to skip validations", "body": "<p>add in user model</p>\n\n<pre><code>attr_accessor :password\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 273, "user_id": 6547385, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10153614401007371/picture?type=large", "display_name": "Lee Eather", "link": "https://stackoverflow.com/users/6547385/lee-eather"}, "is_accepted": true, "score": 0, "last_activity_date": 1512109794, "last_edit_date": 1512109794, "creation_date": 1479451085, "answer_id": 40670816, "question_id": 40628202, "link": "https://stackoverflow.com/questions/40628202/using-attr-accessor-in-rails-trying-to-skip-validations/40670816#40670816", "title": "Using attr_accessor in rails trying to skip validations", "body": "<p>With this, the problem is <code>has_secure_password</code>, which has 3 validation methods by default shown here api.rubyonrails.org/classes/ActiveModel/SecurePassword/ClassMethods.html. You add in <code>has_secure_password validations: false</code>, and can add in validations manually in the <code>validates</code> method. The proper code should be,</p>\n\n<p>Sessions controller</p>\n\n<pre><code>class SessionsController &lt; ApplicationController\n  def create\n   user = User.from_omniauth(env[\"omniauth.auth\"])\n\n    ...   \n</code></pre>\n\n<p>Model</p>\n\n<pre><code>has_secure_password validations: false\nvalidates :password, on: :create, presence: true, length: { minimum: 6 }, allow_nil: true,\nunless: :skip_password_validation\n\nattr_accessor :skip_password_validation\n\n def self.from_omniauth(auth)\n   where(provider: auth.provider, uid: auth.uid).first_or_create do |user|\n   user.provider = auth.provider\n   user.uid = auth.uid\n   user.name = auth.info.name\n   user.email = auth.info.email\n   user.oauth_token = auth.credentials.token\n   user.oauth_expires_at = Time.at(auth.credentials.expires_at)\n\n   user.skip_password_validation = true\n\n   user.save!\n end\n...\n</code></pre>\n\n<p><strong>EDIT</strong> I come back to this question again as you need to have the skip method in the model on the model object before save as rails evaluates the model method first. So you could do as what @Vladan Markovic has written or simply put <code>user.skip_password_validation = true</code> in the <code>from_omniauth</code> method in the model before save is called which I have edited to show.</p>\n"}], "owner": {"reputation": 273, "user_id": 6547385, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10153614401007371/picture?type=large", "display_name": "Lee Eather", "link": "https://stackoverflow.com/users/6547385/lee-eather"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 405, "favorite_count": 0, "accepted_answer_id": 40670816, "answer_count": 3, "score": 0, "last_activity_date": 1512109794, "creation_date": 1479288108, "question_id": 40628202, "link": "https://stackoverflow.com/questions/40628202/using-attr-accessor-in-rails-trying-to-skip-validations", "title": "Using attr_accessor in rails trying to skip validations", "body": "<p>I am trying to skip password validation as facebook does not return a password for login. </p>\n\n<p>I am getting a error;</p>\n\n<p>\"Validation failed: Password can't be blank\" on line <code>user.save!</code></p>\n\n<p>Application trace;</p>\n\n<pre><code>app/models/user.rb:36:in block in 'from_omniauth'  \napp/models/user.rb:29:in 'from_omniauth'  \napp/controllers/sessions_controller.rb:6:in 'create'\n</code></pre>\n\n<p>Is this because <code>from_omniauth</code> is a class method, wrapped inside the user variable and then I am trying to skip password validation, as, a instance variable, when the instance is not created yet. Ie <code>first_or_create do |user|</code> has not created or registered the user before the instance?</p>\n\n<p>If so, I was wondering how I could refactor my code to make this work?</p>\n\n<p>Sessions controller</p>\n\n<pre><code>class SessionsController &lt; ApplicationController\n  def create\n   user = User.from_omniauth(env[\"omniauth.auth\"])\n    user.skip_password_validation = true\n    ...   \n</code></pre>\n\n<p>model.rb</p>\n\n<pre><code>class User &lt; ApplicationRecord\n\n  has_secure_password\n  validates :password, presence: true, length: { minimum: 6 }, allow_nil: true,\n  unless: :skip_password_validation\n\n   attr_accessor :skip_password_validation\n\n  def self.from_omniauth(auth)\n    where(provider: auth.provider, uid: auth.uid).first_or_create do |user|\n      user.provider = auth.provider\n      user.uid = auth.uid\n      user.name = auth.info.name\n      user.email = auth.info.email\n      user.oauth_token = auth.credentials.token\n      user.oauth_expires_at = Time.at(auth.credentials.expires_at)\n      user.save!\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "sudo"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1479287883, "post_id": 40628110, "comment_id": 68489377, "body": "<code>sudo gem list</code>, of course"}, {"owner": {"reputation": 311, "user_id": 1406755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a1c33c0520accd47ac4c8730392e7a?s=128&d=identicon&r=PG", "display_name": "Ramon Suarez", "link": "https://stackoverflow.com/users/1406755/ramon-suarez"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1479289810, "post_id": 40628110, "comment_id": 68490590, "body": "@SergioTulentsev If I compare <code>sudo gem list</code> to <code>gem list</code> I see a lot of gems that appear on both lists. Does your command list both gems installed with and without sudo? How would you revert the mess? Please include it as an answer so I can assign it to you. Thanks!"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1479290259, "post_id": 40628110, "comment_id": 68490904, "body": "do <code>which gem</code> and <code>sudo which gem</code> point to the same binary?"}, {"owner": {"reputation": 311, "user_id": 1406755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a1c33c0520accd47ac4c8730392e7a?s=128&d=identicon&r=PG", "display_name": "Ramon Suarez", "link": "https://stackoverflow.com/users/1406755/ramon-suarez"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1479291116, "post_id": 40628110, "comment_id": 68491466, "body": "Nope. I guess this means there are two installs of some of the gems, one with sudo and another one without, with the same version numbers. Should I just make a giant sudo gem uninstall with all the gems to uninstall and them do a giant gem install with all the gems so they are back in the system? Should I just sudo gem uninstall all and then work only with bundle on a per project basis?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1479291242, "post_id": 40628110, "comment_id": 68491555, "body": "Yep, in this case, it&#39;s safe to nuke all gems from <code>sudo gem list</code> (well, almost all. There are a few system gems, like <code>bigdecimal</code>, which I&#39;m not even sure you can uninstall) and use bundler from then on."}, {"owner": {"reputation": 311, "user_id": 1406755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a1c33c0520accd47ac4c8730392e7a?s=128&d=identicon&r=PG", "display_name": "Ramon Suarez", "link": "https://stackoverflow.com/users/1406755/ramon-suarez"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1479315011, "post_id": 40628110, "comment_id": 68507685, "body": "Thanks a lot @SergioTulentsev. Can you please write it what you just said in the comments as an answer so that I can mark your answer as valid or do you prefer that I edit my answer and give you credit there?"}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1479288617, "post_id": 40628148, "comment_id": 68489857, "body": "This solution is 1) OS-dependent; 2) shell-dependent; 3) requires history to be enabled and not scrambled/edited over time and 4) uses a hammer to turn the screws."}, {"owner": {"reputation": 311, "user_id": 1406755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a1c33c0520accd47ac4c8730392e7a?s=128&d=identicon&r=PG", "display_name": "Ramon Suarez", "link": "https://stackoverflow.com/users/1406755/ramon-suarez"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1479289138, "post_id": 40628148, "comment_id": 68490182, "body": "@mudasobwa How would you solve it taking care of all your caveats?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1479289234, "post_id": 40628148, "comment_id": 68490234, "body": "As @SergioTulentsev specified in the comments: <code>sudo gem list</code>."}], "tags": [], "owner": {"reputation": 311, "user_id": 1406755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a1c33c0520accd47ac4c8730392e7a?s=128&d=identicon&r=PG", "display_name": "Ramon Suarez", "link": "https://stackoverflow.com/users/1406755/ramon-suarez"}, "is_accepted": false, "score": 2, "last_activity_date": 1479287929, "creation_date": 1479287929, "answer_id": 40628148, "question_id": 40628110, "link": "https://stackoverflow.com/questions/40628110/how-can-i-find-all-ruby-gems-installed-with-sudo-gem-install/40628148#40628148", "title": "How can I find all ruby gems installed with sudo gem install?", "body": "<p>You can look at your history on the computer to find the commands you used: </p>\n\n<pre><code>history | grep \"sudo gem\"\n</code></pre>\n\n<p>And then do <code>sudo gem uninstall name-of-gem</code> to remove them.</p>\n\n<p>Credit goes to <a href=\"https://github.com/jadjoubran\" rel=\"nofollow noreferrer\">Jad Joubran</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 2, "last_activity_date": 1479315743, "creation_date": 1479315743, "answer_id": 40638004, "question_id": 40628110, "link": "https://stackoverflow.com/questions/40628110/how-can-i-find-all-ruby-gems-installed-with-sudo-gem-install/40638004#40638004", "title": "How can I find all ruby gems installed with sudo gem install?", "body": "<p>If your system comes with a built-in ruby, it (and the gems) are in protected folder. To install gems, you need <code>sudo</code>.</p>\n\n<p>Normally, though, you leave the system ruby alone and install newer version with one of the ruby version switchers (RVM, chruby/ruby-install, rbenv/ruby-build). But before you discovered version switchers, you may have installed some gems with <code>sudo</code> into the system ruby.</p>\n\n<p>If <code>which gem</code> and <code>sudo which gem</code> return different paths (which likely means that under <code>sudo</code> you use system ruby and not your custom one), you can safely uninstall all of the gems you installed with <code>sudo</code>. </p>\n"}], "owner": {"reputation": 311, "user_id": 1406755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a1c33c0520accd47ac4c8730392e7a?s=128&d=identicon&r=PG", "display_name": "Ramon Suarez", "link": "https://stackoverflow.com/users/1406755/ramon-suarez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1404, "favorite_count": 1, "accepted_answer_id": 40638004, "answer_count": 2, "score": 2, "last_activity_date": 1479315743, "creation_date": 1479287815, "last_edit_date": 1479287970, "question_id": 40628110, "link": "https://stackoverflow.com/questions/40628110/how-can-i-find-all-ruby-gems-installed-with-sudo-gem-install", "title": "How can I find all ruby gems installed with sudo gem install?", "body": "<p>I'm learning to code on ruby and before knowing any better I installed some  gems with <code>sudo gem install name-of-gem</code>, which is now wreaking havoc with some projects. I've read the gem documentation and have not found a way to show which gems have been installed with <code>sudo</code>. How can I do find them?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "devise-invitable"], "comments": [{"owner": {"reputation": 3865, "user_id": 4540175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a789c8057fed1368f96c15cfbdba6421?s=128&d=identicon&r=PG&f=1", "display_name": "gates", "link": "https://stackoverflow.com/users/4540175/gates"}, "edited": false, "score": 0, "creation_date": 1479287684, "post_id": 40627849, "comment_id": 68489261, "body": "You can run a rake task periodically to delete the users who did not accept the invitations"}], "answers": [{"tags": [], "owner": {"reputation": 166, "user_id": 7040027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37407cfccbfc6c2c6370a74c41fec074?s=128&d=identicon&r=PG", "display_name": "veldtmana", "link": "https://stackoverflow.com/users/7040027/veldtmana"}, "is_accepted": true, "score": 1, "last_activity_date": 1479289476, "creation_date": 1479289476, "answer_id": 40628686, "question_id": 40627849, "link": "https://stackoverflow.com/questions/40627849/using-devise-invitable-how-to-create-the-user-only-after-the-user-has-set-his-p/40628686#40628686", "title": "Using devise invitable. How to create the user only after the user has set his password", "body": "<p>I would not mess with the devise invitable implementation like that.</p>\n\n<p>Rather perhaps add a status column to the user using enums, so that you can isolate the users that have not accepted their invites and as one of the commenters said remove stale users later. </p>\n\n<p><code>enum status: {invited: 0, accepted: 1}</code>  </p>\n\n<p>then you can do the following:</p>\n\n<p><code>User.invite!(status: \"invited\")</code></p>\n\n<p>you will have to set the \"accepted\" status when the user accepts by hooking into the callbacks the gem provides (see <a href=\"https://github.com/scambra/devise_invitable\" rel=\"nofollow noreferrer\">https://github.com/scambra/devise_invitable</a>). </p>\n"}], "owner": {"reputation": 11, "user_id": 5772876, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fuyzUhJd2v4/AAAAAAAAAAI/AAAAAAAAAAA/V1BFuMRTG2Q/photo.jpg?sz=128", "display_name": "Jeremy Ramos", "link": "https://stackoverflow.com/users/5772876/jeremy-ramos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 545, "favorite_count": 0, "accepted_answer_id": 40628686, "answer_count": 1, "score": 0, "last_activity_date": 1479289476, "creation_date": 1479287032, "last_edit_date": 1479287719, "question_id": 40627849, "link": "https://stackoverflow.com/questions/40627849/using-devise-invitable-how-to-create-the-user-only-after-the-user-has-set-his-p", "title": "Using devise invitable. How to create the user only after the user has set his password", "body": "<pre><code>def create\n    if User.invite!(user_params)\n        flash[:success] = t('flashes.users.create_success')\n    else\n        flash[:error] = t('flashes.users.create_error')\n    end\n    redirect_to company_path(id: company.slug)\nend\n</code></pre>\n\n<p><code>User.invite!</code> will create the user, then send an invitation to set a password. I only want it to send an invitation to set the password and then only persist the user if the user has set a password.</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1479287077, "post_id": 40627844, "comment_id": 68488868, "body": "What is the rule, pattern?"}, {"owner": {"reputation": 1594, "user_id": 1812321, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27aa7afb2a89ee319028048b41db126a?s=128&d=identicon&r=PG", "display_name": "Nickolay Kondratenko", "link": "https://stackoverflow.com/users/1812321/nickolay-kondratenko"}, "edited": false, "score": 0, "creation_date": 1479287090, "post_id": 40627844, "comment_id": 68488880, "body": "what exactly do you want to match?"}, {"owner": {"reputation": 2908, "user_id": 662503, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/881a236ca533281bb9c9ac92f380b5a0?s=128&d=identicon&r=PG", "display_name": "rubyist", "link": "https://stackoverflow.com/users/662503/rubyist"}, "reply_to_user": {"reputation": 1594, "user_id": 1812321, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27aa7afb2a89ee319028048b41db126a?s=128&d=identicon&r=PG", "display_name": "Nickolay Kondratenko", "link": "https://stackoverflow.com/users/1812321/nickolay-kondratenko"}, "edited": false, "score": 0, "creation_date": 1479287112, "post_id": 40627844, "comment_id": 68488896, "body": "@NickolayKondratenko I want to match both the strings. i.e strings with hyphens and also string with underscores and digits at the end"}, {"owner": {"reputation": 1594, "user_id": 1812321, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27aa7afb2a89ee319028048b41db126a?s=128&d=identicon&r=PG", "display_name": "Nickolay Kondratenko", "link": "https://stackoverflow.com/users/1812321/nickolay-kondratenko"}, "edited": false, "score": 0, "creation_date": 1479287133, "post_id": 40627844, "comment_id": 68488908, "body": "I think you forgot abobut the underscore"}], "answers": [{"comments": [{"owner": {"reputation": 2908, "user_id": 662503, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/881a236ca533281bb9c9ac92f380b5a0?s=128&d=identicon&r=PG", "display_name": "rubyist", "link": "https://stackoverflow.com/users/662503/rubyist"}, "edited": false, "score": 0, "creation_date": 1479287375, "post_id": 40627910, "comment_id": 68489077, "body": "Stribizew but it is not passing &quot;/50-Washington-St&quot; with your regex"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 2908, "user_id": 662503, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/881a236ca533281bb9c9ac92f380b5a0?s=128&d=identicon&r=PG", "display_name": "rubyist", "link": "https://stackoverflow.com/users/662503/rubyist"}, "edited": false, "score": 0, "creation_date": 1479287414, "post_id": 40627910, "comment_id": 68489103, "body": "Why should it? It does not resemble the strings in your question. But you may add <code>\\W*</code> (if you want to allow any number of non-word chars at the start) or <code>\\&#47;?</code> (to only allow an optional <code>&#47;</code>) right after <code>^</code> or <code>\\A</code>."}, {"owner": {"reputation": 2908, "user_id": 662503, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/881a236ca533281bb9c9ac92f380b5a0?s=128&d=identicon&r=PG", "display_name": "rubyist", "link": "https://stackoverflow.com/users/662503/rubyist"}, "edited": false, "score": 0, "creation_date": 1479287542, "post_id": 40627910, "comment_id": 68489187, "body": "Stribizew  ((/^([0-9]+)-([^\\W*_-]+)-(\\w+)$/ =~ &quot;/50-Washington-St&quot; ) == 0)"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 2908, "user_id": 662503, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/881a236ca533281bb9c9ac92f380b5a0?s=128&d=identicon&r=PG", "display_name": "rubyist", "link": "https://stackoverflow.com/users/662503/rubyist"}, "edited": false, "score": 0, "creation_date": 1479287694, "post_id": 40627910, "comment_id": 68489267, "body": "See <a href=\"https://ideone.com/Q2MFTw\" rel=\"nofollow noreferrer\">this Ruby demo</a>, there is a match for both the <code>201-Grandview-Dr_Early_TX_76802</code> and <code>&#47;50-Washington-St</code>."}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 2908, "user_id": 662503, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/881a236ca533281bb9c9ac92f380b5a0?s=128&d=identicon&r=PG", "display_name": "rubyist", "link": "https://stackoverflow.com/users/662503/rubyist"}, "edited": false, "score": 0, "creation_date": 1479288090, "post_id": 40627910, "comment_id": 68489517, "body": "Just a note: if you do not care about what chars there are in Group 3, you may replace <code>(\\w+)</code> with <code>(.*)</code> to just match the rest of the line (or add <code>&#47;m</code> modifier to match the rest of the <i>string</i>)."}], "tags": [], "owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": false, "score": 5, "last_activity_date": 1479377444, "last_edit_date": 1479377444, "creation_date": 1479287184, "answer_id": 40627910, "question_id": 40627844, "link": "https://stackoverflow.com/questions/40627844/match-regular-expression-in-ruby/40627910#40627910", "title": "match regular expression in ruby", "body": "<p>You may fix the regex like</p>\n\n<pre><code>/^\\/?([0-9]+)-(.+?)-(\\w+)$/\n</code></pre>\n\n<p>or to match the whole <em>string</em> (mind the <code>^</code> matches the <em>line</em> start and <code>$</code> line end in Ruby regex):</p>\n\n<pre><code>/\\A\\/?([0-9]+)-(.+?)-(\\w+)\\z/\n</code></pre>\n\n<p>See the <a href=\"http://rubular.com/r/YG9e1BTjRs\" rel=\"nofollow noreferrer\">Rubular demo</a></p>\n\n<p><strong>Pattern details</strong>:</p>\n\n<ul>\n<li><code>\\A</code> - string start</li>\n<li><code>\\/?</code> - an optional <code>/</code></li>\n<li><code>([0-9]+)</code> - Group 1: one or more digits</li>\n<li><code>-</code> - a hyphen </li>\n<li><code>(.+?)</code> - Group 2: one or more chars other than linebreak chars</li>\n<li><code>-</code> - a hyphen</li>\n<li><code>(\\w+)</code> - Group 3: one or more word (<code>[A-Za-z0-9_]</code>) characters</li>\n<li><code>\\z</code> -  end of string.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1479426793, "last_edit_date": 1479426793, "creation_date": 1479367084, "answer_id": 40648856, "question_id": 40627844, "link": "https://stackoverflow.com/questions/40627844/match-regular-expression-in-ruby/40648856#40648856", "title": "match regular expression in ruby", "body": "<p>I would like to suggest a way of approaching problems like this one. The main take-away is that complex regular expressions can be constructed in the same way as other Ruby code: create small code modules that can be easily tested and then combine those modules.</p>\n\n<p>Consider the first string that must match the regex.</p>\n\n<pre><code>s = \"201-Grandview-Dr_Early_TX_76802\"\n</code></pre>\n\n<p>As this string contains no characters that need to be escaped, we can create a regex that will exactly match this string by merely replacing the double-quotes with forward slashes and adding start-of-string (<code>\\A</code>) and end-of-string (<code>\\z</code>) anchors:</p>\n\n<pre><code>r = /\\A201-Grandview-Dr_Early_TX_76802\\z/\n  #=&gt; /\\A201-Grandview-Dr_Early_TX_76802\\z/ \ns =~ r\n  #=&gt; 0 \n</code></pre>\n\n<p>This is what we have:</p>\n\n<pre><code>/\\A201-Grandview\\-Dr_Early_TX_76802\\z/\n   \u2b06\ufe0estreet number\n          \u2b06\ufe0estreet name\n                  \u2b06\ufe0estreet name suffix\n                      \u2b06\ufe0ecity\n                           \u2b06\ufe0estate\n                                \u2b06\ufe0ezip\n</code></pre>\n\n<p>Presumably the regex should match a string if and only if the string contains allowable values for each of these six fields and has the formatting shown between adjacent fields. </p>\n\n<p>Let's begin by stipulating a separate regex for each of the six fields. Naturally, all of these regexes may need to be modified to suit requirements.</p>\n\n<p><em>Street number</em></p>\n\n<p>Typical street numbers might be \"221\", \"221B\", \"221b\". Let's say we might also have \"A19\" or \"221BZ\" but not \"221-B\". We might then write:</p>\n\n<pre><code>number = /[[:alnum:]]+/\n</code></pre>\n\n<p>(Search for \"POSIX\" in <a href=\"http://ruby-doc.org/core-2.3.0/Regexp.html\" rel=\"nofollow noreferrer\">Regexp</a>.) </p>\n\n<p><em>Street name</em></p>\n\n<p>I have assumed street names consist of a single word or multiple words separated by a single space, where each word is all lowercase except for the first letter, which is capitalized.</p>\n\n<pre><code>street = /[[:upper:]][[:lower:]]+(?:\\s[[:upper:]][[:lower:]]+)*/\n</code></pre>\n\n<p><code>/[[:upper:]][[:lower:]]+</code> matches the first word, <code>(?:\\s[[:upper:]][[:lower:]])*</code> matches a space followed by a capitalized word, repeated zero or more times (<code>(?:...)</code> is a non-capture group. The trailing <code>*</code> means repeat zero or more times.)</p>\n\n<p><em>Street name suffix</em></p>\n\n<p>I have assumed the street name suffix (e.g., 'Street', 'St.') is a single word, all lower case except the first character, which is upper case, optionally ending with a period:</p>\n\n<pre><code>suffix = /[[:upper:]][[:lower:]]+\\.?/\n</code></pre>\n\n<p><em>City</em></p>\n\n<p>I have assumed that names of cities has the same requirements as do names of streets:</p>\n\n<pre><code>city = street\n  #=&gt; /[[:upper:]][[:lower:]]+(?:\\s[[:upper:]][[:lower:]]+)*/\n</code></pre>\n\n<p><em>State</em></p>\n\n<p>States are given by two capital letters:</p>\n\n<pre><code>state = /[[:upper:]]{2}/\n</code></pre>\n\n<p>We could be more precise by writing:</p>\n\n<pre><code>state = Regexp.union %w| AL AK AZ ... |\n</code></pre>\n\n<p>but then we'd have to update it every time a territory became a new state or (possibly due to recent events) a state secedes from the union.</p>\n\n<p><em>Zip code</em></p>\n\n<p>Zip codes are five digits or nine digits with a dash or hyphen after the first four digits.</p>\n\n<pre><code>zip = /\\d{5}(?:-\\d{4})?/\n</code></pre>\n\n<p>Using</p>\n\n<pre><code>/\\A201-Grandview-Dr_Early_TX_76802\\z/\n</code></pre>\n\n<p>as our pattern, our overall regex is therefore the following:</p>\n\n<pre><code>r1 = /\n     \\A # match start of string \n     #{number}\n     -\n     #{street}\n     -\n     #{suffix}\n     _\n     #{city}\n     _\n     #{state}\n     _\n     #{zip}\n     \\z # match end of string\n     /x # free-spacing regex definition mode\n  #=&gt; /\n  #   \\A # match start of string \n  #   /(?-mix:[[:alnum:]]+)\n  #   -\n  #   (?-mix:[[:upper:]][[:lower:]]+(?:\\s[[:upper:]][[:lower:]]+)*)\n  #   -\n  #   (?-mix:[[:upper:]][[:lower:]]+\\.?)\n  #   _\n  #   (?-mix:[[:upper:]][[:lower:]]+(?:\\s[[:upper:]][[:lower:]]+)*)\n  #   _\n  #   (?-mix:[[:upper:]]{2})\n  #   _\n  #   (?-mix:\\d{5}(?:-\\d{4})?)\n  #   \\z # match start of string \n  /x \n</code></pre>\n\n<p>Let's try it for the first string and variations thereof:</p>\n\n<pre><code>\"201-Grandview-Dr_Early_TX_76802\" =~ r1\n   #=&gt; 0\n\"221B-Grand View-Dr._El Paso_TX_76802-0000\" =~ r1\n   #=&gt; 0\n\"2A0B1-Grandview-Dr_Early_ZZ_76802\" =~ r1\n   #=&gt; 0\n\"201-GrandView-Dr_Early_TX_76802\" =~ r1\n   #=&gt; nil\n\"201-Grandview-Dr_Early_TX_7680\" =~ r1\n   #=&gt; nil\n\"201-Pi11ar-St_Early_TX_76802\" =~ r1\n   #=&gt; nil\n\"I live at 201-Grandview-Dr_Early_TX_76802\" =~ r1\n   #=&gt; nil\n\"201-\ud83d\ude0emg Circle-Lane_Early_TX_76802\" =~ r1\n   #=&gt; nil\n</code></pre>\n\n<p>Now consider the second example string for which there should be a match:</p>\n\n<pre><code>\"/50-Washington-St\"\n</code></pre>\n\n<p>We see the regex for this is simply</p>\n\n<pre><code>r2 = /\n     \\A\n     \\/\n     #{number}\n     -\n     #{street}\n     -\n     #{suffix}\n     \\z\n     /x\n #=&gt; /\n #   \\A\n #   \\/\n #   (?-mix:[[:alnum:]]+)\n #   -\n #   (?-mix:[[:upper:]][[:lower:]]+(?:\\s[[:upper:]][[:lower:]]+)*)\n #   -\n #   (?-mix:[[:upper:]][[:lower:]]+\\.?)\n #   \\z\n #   /x \n</code></pre>\n\n<p>Let's try it.</p>\n\n<pre><code> \"/50-Washington-St\" =~ r2\n   #=&gt; 0\n \"50-Washington-St\" =~ r2\n   #=&gt; nil\n \"/50-Washington-St_Early\" =~ r2\n   #=&gt; nil\n</code></pre>\n\n<p>So now our overall regex is simply</p>\n\n<pre><code>r = Regexp.union(r1,r2)\n  #=&gt; /(?x-mi:\n  #   \\A # match start of string \n  #   (?-mix:[[:alnum:]]+)\n  #   -\n  #   (?-mix:[[:upper:]][[:lower:]]+(?:\\s[[:upper:]][[:lower:]]+)*)\n  #   -\n  #   (?-mix:[[:upper:]][[:lower:]]+\\.?)\n  #   _\n  #   (?-mix:[[:upper:]][[:lower:]]+(?:\\s[[:upper:]][[:lower:]]+)*)\n  #   _\n  #   (?-mix:[[:upper:]]{2})\n  #   _\n  #   (?-mix:\\d{5}(?:-\\d{4})?)\n  #   \\z # match end of string\n  #   )|(?x-mi:\n  #   \\A\n  #   \\/\n  #   (?-mix:[[:alnum:]]+)\n  #   -\n  #   (?-mix:[[:upper:]][[:lower:]]+(?:\\s[[:upper:]][[:lower:]]+)*)\n  #   -\n  #   (?-mix:[[:upper:]][[:lower:]]+\\.?)\n  #   \\z\n  #   )/ \n\n\"201-Grandview-Dr_Early_TX_76802\" =~ r\n  #=&gt; 0\n\"/50-Washington-St\" =~ r\n  #=&gt; 0\n</code></pre>\n"}], "owner": {"reputation": 2908, "user_id": 662503, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/881a236ca533281bb9c9ac92f380b5a0?s=128&d=identicon&r=PG", "display_name": "rubyist", "link": "https://stackoverflow.com/users/662503/rubyist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1479426793, "creation_date": 1479287014, "last_edit_date": 1479378266, "question_id": 40627844, "link": "https://stackoverflow.com/questions/40627844/match-regular-expression-in-ruby", "title": "match regular expression in ruby", "body": "<p>I have  strings as below</p>\n\n<p><code>201-Grandview-Dr_Early_TX_76802</code> and <code>/50-Washington-St</code></p>\n\n<p>I am writing a regex to match both the strings.</p>\n\n<pre><code>((/^([0-9]+)-([^_]+)-([A-Za-z]{1,})$/ =~ data ) == 0)\n</code></pre>\n\n<p>But the above regex matches only <code>50-Washington-St</code> and not the second one. </p>\n\n<p>So what could be wrong in this regex.? </p>\n\n<p>The updated list of the strings that should match:</p>\n\n<pre><code>201-Grandview-Dr_Early_TX_76802\n/50-Washington-St\n49220-Sunrose-Ln_Palm-Desert_CA_92260\n201-Grandview-Dr_Early_TX_76802\n50-Washington-St\n</code></pre>\n"}, {"tags": ["ruby", "pong"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1479288771, "post_id": 40627788, "comment_id": 68489952, "body": "Homeworks are given to be performed, not stolen / copy-pasted."}, {"owner": {"reputation": 346, "user_id": 4952010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HlF1M.jpg?s=128&g=1", "display_name": "Vladan Markovic", "link": "https://stackoverflow.com/users/4952010/vladan-markovic"}, "edited": false, "score": 0, "creation_date": 1479290552, "post_id": 40627788, "comment_id": 68491089, "body": "Ruby is not really viable for game development, except maybe like script in some Game engine written in C/C++. I dont think you can make Pong in plain Ruby, without other GFX support libraries you need to install on the machine. Only option with plain ruby is to write Ruby in combination with Javascript. And the game can run in Web-browser, write logic code in ruby that can run in Sinatra or Rails web application and write Graphics code in Javascript. But that just for demonstration purposes.  If you really in to making a real game, i strongly recommend some other programming languages"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1479292583, "post_id": 40627788, "comment_id": 68492487, "body": "How is the virtual machine going to test a graphical game without graphics?"}, {"owner": {"reputation": 581, "user_id": 3552082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/dbdf003b0668ef367a938584e5dbe2a6?s=128&d=identicon&r=PG", "display_name": "Romain-p", "link": "https://stackoverflow.com/users/3552082/romain-p"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1479297742, "post_id": 40627788, "comment_id": 68495767, "body": "@Mudasobwa what u said has just no sens, im just looking for import locally a framework. rip"}], "answers": [{"tags": [], "owner": {"reputation": 2788, "user_id": 4152876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d538506cb7d350250906243645c28d4?s=128&d=identicon&r=PG", "display_name": "Timo Schilling", "link": "https://stackoverflow.com/users/4152876/timo-schilling"}, "is_accepted": false, "score": 1, "last_activity_date": 1479292602, "creation_date": 1479292602, "answer_id": 40629923, "question_id": 40627788, "link": "https://stackoverflow.com/questions/40627788/create-a-pong-in-ruby/40629923#40629923", "title": "Create a pong in Ruby", "body": "<p>Take a look at <a href=\"http://shoesrb.com\" rel=\"nofollow noreferrer\">http://shoesrb.com</a>, it's Ruby GUI Framework</p>\n"}, {"tags": [], "owner": {"reputation": 900, "user_id": 1401556, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/qEJJO.jpg?s=128&g=1", "display_name": "Cuong Nguyen", "link": "https://stackoverflow.com/users/1401556/cuong-nguyen"}, "is_accepted": false, "score": 1, "last_activity_date": 1479293609, "creation_date": 1479293609, "answer_id": 40630293, "question_id": 40627788, "link": "https://stackoverflow.com/questions/40627788/create-a-pong-in-ruby/40630293#40630293", "title": "Create a pong in Ruby", "body": "<p>I think this project is good pong for beginner \n<a href=\"https://github.com/subdigital/pong\" rel=\"nofollow noreferrer\">https://github.com/subdigital/pong</a></p>\n"}], "owner": {"reputation": 581, "user_id": 3552082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/dbdf003b0668ef367a938584e5dbe2a6?s=128&d=identicon&r=PG", "display_name": "Romain-p", "link": "https://stackoverflow.com/users/3552082/romain-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 407, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1479293609, "creation_date": 1479286859, "question_id": 40627788, "link": "https://stackoverflow.com/questions/40627788/create-a-pong-in-ruby", "title": "Create a pong in Ruby", "body": "<p>I have to create a Pong game using ruby, I also looked at some examples and saw that I need a runtime library to create the game easly (gosu).</p>\n\n<p>My problem is that my project's source code will be pulled and tested by a virtual-machine which has only ruby installed, w/o any libraries/frameworks.</p>\n\n<p>1) Is it possible to download the runtime library w/o install and use it as a local library ?<br>\n2) Any suggested library to code a good pong easly for beginners ?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1479286568, "post_id": 40627667, "comment_id": 68488572, "body": "Elaborate on &quot;didn&#39;t work for me&quot;"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1479286638, "post_id": 40627667, "comment_id": 68488612, "body": "<a href=\"http://stackoverflow.com/questions/17885502/how-to-generate-unsubscription-link-for-emails-of-actionmailer/17886089#17886089\">This one</a> is how I would do it."}, {"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1479289613, "post_id": 40627667, "comment_id": 68490463, "body": "@SergioTulentsev if you check where I said it leads me through, you&#39;ll see your suggestion is all i have implemented but all to no avail"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1479290559, "post_id": 40627667, "comment_id": 68491093, "body": "You botched the implementation, unfortunately. This is not a flaw of that answer. If implemented correctly, it will work. Therefore, this question is not really valid. &quot;What is the best way&quot; - that way is good enough (as for me)."}, {"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1479296265, "post_id": 40627667, "comment_id": 68494827, "body": "@SergioTulentsev Okayyyy. But can you see through <a href=\"http://stackoverflow.com/questions/40614820/nomethoderror-in-usersunsubscribe/40615832?noredirect=1#comment68489231_40615832\" title=\"nomethoderror in usersunsubscribe\">stackoverflow.com/questions/40614820/&hellip;</a> probably you could see what I botched in the implementation ?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1479296379, "post_id": 40627667, "comment_id": 68494913, "body": "Sure. unsubscribe link generation and fetching user by that token - these two are critical and both are wrong. There may be other flaws too."}, {"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1479299395, "post_id": 40627667, "comment_id": 68496843, "body": "but if you say it is wrong, using <code>&lt;%= link_to &#39;Unsubscribe Me!&#39;, unsubscribe_url(@user.unsubscribe_hash) %&gt;</code> in my mailer preview, it gives me <code>NoMethodError in Rails::Mailers#preview</code> which is what brought what those guys are trying to fix in the link I supplied."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1479299632, "post_id": 40627667, "comment_id": 68497005, "body": "This one is better. Now you just have to figure out why <code>@user</code> is nil"}], "owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479296433, "creation_date": 1479286481, "last_edit_date": 1495540887, "question_id": 40627667, "link": "https://stackoverflow.com/questions/40627667/botched-implemention-of-unsubscribe-link-to-rails-mailer", "title": "Botched implemention of Unsubscribe link to Rails Mailer", "body": "<p>Am trying to implement unsubscribe link to my rails mailer. I think the whole approach I have taken is wrong. What I take into consideration to implement Unsubscribe link to my rails mailer is from the following answers:</p>\n\n<ol>\n<li><a href=\"https://stackoverflow.com/a/17886089/5614748\">https://stackoverflow.com/a/17886089/5614748</a></li>\n<li><a href=\"https://stackoverflow.com/a/34779543/5614748\">https://stackoverflow.com/a/34779543/5614748</a></li>\n</ol>\n\n<p>but didn't work for me and lead me to my question <a href=\"https://stackoverflow.com/questions/40614820/nomethoderror-in-usersunsubscribe\">here</a> </p>\n\n<blockquote>\n  <p>How can I successfully implement Unsubscribe key with my mailer?</p>\n</blockquote>\n"}, {"tags": ["c++", "c", "ruby", "ruby-native-extensions"], "comments": [{"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1479284810, "post_id": 40627086, "comment_id": 68487562, "body": "Please <a href=\"https://stackoverflow.com/posts/40627086/edit\">edit</a> your question to include at least some of the code directly.  I&#39;m not going to follow random external links."}, {"owner": {"reputation": 6168, "user_id": 435460, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e2d224ddec1592dc623f013100685da0?s=128&d=identicon&r=PG", "display_name": "JesseBuesking", "link": "https://stackoverflow.com/users/435460/jessebuesking"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1479285563, "post_id": 40627086, "comment_id": 68488013, "body": "@MartinBonner I debated adding any code when writing the question, but left it out since I was unsure if it would be of any benefit without more context. I&#39;ve since included the line that the core dump says is causing the segfault."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1479290395, "post_id": 40627086, "comment_id": 68490977, "body": "Right, so with high probability <code>yyParser</code> is null.  Options:  try inserting <code>assert(yyParser!=NULL);</code> on the line before, or run ruby under gdb and step through your code."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1479290415, "post_id": 40627086, "comment_id": 68490995, "body": "... or add lots of debugging printf statements."}, {"owner": {"reputation": 6168, "user_id": 435460, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e2d224ddec1592dc623f013100685da0?s=128&d=identicon&r=PG", "display_name": "JesseBuesking", "link": "https://stackoverflow.com/users/435460/jessebuesking"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1479313172, "post_id": 40627086, "comment_id": 68506375, "body": "@MartinBonner I added <code>assert(yyParser!=NULL);</code> on the line before, but it&#39;s still segfaulting on <code>assert( yypParser-&gt;yytos!=0 );</code>. It seems as though accessing the property is causing the segfault. I&#39;m confused by the fact that it&#39;s suddenly doing this now that it&#39;s being called as a ruby extension but continues to work fine as a standalone library."}, {"owner": {"reputation": 2599, "user_id": 39223, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/39e19e0acb0d2809f60f57cec9b50512?s=128&d=identicon&r=PG", "display_name": "RJHunter", "link": "https://stackoverflow.com/users/39223/rjhunter"}, "edited": false, "score": 0, "creation_date": 1479435446, "post_id": 40627086, "comment_id": 68567486, "body": "I compiled your standalone library for x86_64 (once with clang, once with gcc). The compiler showed some warnings, and the code segfaulted reading <code>yypParser</code> just as you describe. The segfault did not occur in a 32-bit build. The warnings hint towards the cause of the problem -- calling undeclared functions across file boundaries guesses the types wrong."}, {"owner": {"reputation": 6168, "user_id": 435460, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e2d224ddec1592dc623f013100685da0?s=128&d=identicon&r=PG", "display_name": "JesseBuesking", "link": "https://stackoverflow.com/users/435460/jessebuesking"}, "reply_to_user": {"reputation": 2599, "user_id": 39223, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/39e19e0acb0d2809f60f57cec9b50512?s=128&d=identicon&r=PG", "display_name": "RJHunter", "link": "https://stackoverflow.com/users/39223/rjhunter"}, "edited": false, "score": 0, "creation_date": 1479485127, "post_id": 40627086, "comment_id": 68592939, "body": "@RJHunter how were you able to control 32/64 bit build? Or were you building just the c library, not the ruby wrapper library? Also, thank you for taking a look!"}, {"owner": {"reputation": 2599, "user_id": 39223, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/39e19e0acb0d2809f60f57cec9b50512?s=128&d=identicon&r=PG", "display_name": "RJHunter", "link": "https://stackoverflow.com/users/39223/rjhunter"}, "edited": false, "score": 0, "creation_date": 1479504449, "post_id": 40627086, "comment_id": 68603020, "body": "Just building the C library, no Ruby involved. In my environment, the default build was 64-bit, so a plain old <code>make</code> showed the warnings and the segfault. I expect you&#39;re seeing a difference in Ruby vs non-Ruby because the two builds use a different compiler command-line (CFLAGS etc)."}, {"owner": {"reputation": 6168, "user_id": 435460, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e2d224ddec1592dc623f013100685da0?s=128&d=identicon&r=PG", "display_name": "JesseBuesking", "link": "https://stackoverflow.com/users/435460/jessebuesking"}, "reply_to_user": {"reputation": 2599, "user_id": 39223, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/39e19e0acb0d2809f60f57cec9b50512?s=128&d=identicon&r=PG", "display_name": "RJHunter", "link": "https://stackoverflow.com/users/39223/rjhunter"}, "edited": false, "score": 1, "creation_date": 1479538866, "post_id": 40627086, "comment_id": 68610234, "body": "@RJHunter your comment lead me to the solution! The compiler guessed the wrong type, but wouldn&#39;t have if the header file for the parser specified the functions defined. <code>parser.c</code> is generated by <a href=\"http://www.hwaci.com/sw/lemon/\" rel=\"nofollow noreferrer\">lemon</a> which has an option to make the file compatible with <a href=\"http://www.hwaci.com/sw/mkhdr/\" rel=\"nofollow noreferrer\">makeheaders</a>, a program that generates <code>parser.h</code> <i>with</i> function definitions. Some minor tweaking was necessary to fix up <code>parser.h</code>, but once done and linked correctly it no longer has to guess and <i>presto</i>, it works!"}, {"owner": {"reputation": 1959, "user_id": 1207554, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/02bed14d16954900634cb83771445dc0?s=128&d=identicon&r=PG", "display_name": "Douglas G. Allen", "link": "https://stackoverflow.com/users/1207554/douglas-g-allen"}, "edited": false, "score": 0, "creation_date": 1484098392, "post_id": 40627086, "comment_id": 70367413, "body": "Taking your code as it is from the github repo I find that it fails to compile from to start with checking for fast_numerizer/fast_numerizer.h... no  I look and it&#39;s an empty folder. I must have missed something. Getting late and my eyes are tired of reading bright web pages. Do you use darker themes? Most developers do. Can I change this here?"}], "owner": {"reputation": 6168, "user_id": 435460, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e2d224ddec1592dc623f013100685da0?s=128&d=identicon&r=PG", "display_name": "JesseBuesking", "link": "https://stackoverflow.com/users/435460/jessebuesking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479285792, "creation_date": 1479284394, "last_edit_date": 1479285792, "question_id": 40627086, "link": "https://stackoverflow.com/questions/40627086/ruby-native-wrap-c-library-segfault", "title": "ruby native wrap c library segfault", "body": "<p>I'm attempting to wrap a small <a href=\"https://github.com/JesseBuesking/fast_numerizer\" rel=\"nofollow noreferrer\">library I've written in c</a>, and I think I'm on the home stretch to getting it working. The library has some pretty solid tests around it, and I've ran it through valgrind to remove any memory leaks and glaring issues. It works pretty solid on it's own.</p>\n\n<p>However, when I attempt to wrap it using ruby it segfaults. <a href=\"https://github.com/JesseBuesking/example_project\" rel=\"nofollow noreferrer\">Here's an example project</a> that wraps the library. When the tests in that project are ran, the call to the library segfaults. Running it results in a core abort which I've loaded in gdb to debug, but I'm not sure what's wrong. The core dump says the issue is <a href=\"https://github.com/JesseBuesking/fast_numerizer/blob/0bc243d79224adf8cdbd1477bf2806d2a2df6bc8/parser.c#L1919\" rel=\"nofollow noreferrer\">on this line</a>, but I have no idea what's causing it since the information given is pretty sparse and the code runs well if I run the tests in c land.</p>\n\n<p><em>The line that the core dump says is segfaulting</em>:</p>\n\n<pre><code>assert( yypParser-&gt;yytos!=0 );\n</code></pre>\n\n<p>You can reproduce it by running <code>rake</code> from the root directory which kicks of a process that ultimately generates a shared object that is loaded by the tests. I'm hoping someone with more experience in c can take a look and potentially point me in the right direction.</p>\n\n<p>Please let me know if any more information is needed.</p>\n\n<p><em>Snippet from the core dump</em>:</p>\n\n<pre><code>#0  0x00007f150caa2c37 in __GI_raise (sig=sig@entry=6) at ../nptl/sysdeps/unix/sysv/linux/raise.c:56\n#1  0x00007f150caa6028 in __GI_abort () at abort.c:89\n#2  0x00007f150dba8d8d in die () at error.c:407\n#3  rb_bug_context (ctx=ctx@entry=0x7f150f3b1b80, fmt=fmt@entry=0x7f150dbe2f6a \"Segmentation fault at %p\") at error.c:437\n#4  0x00007f150daa45ce in sigsegv (sig=&lt;optimized out&gt;, info=0x7f150f3b1cb0, ctx=0x7f150f3b1b80) at signal.c:890\n#5  &lt;signal handler called&gt;\n#6  0x00007f150b96b02b in Parse (yyp=0xf9925e0, yymajor=20, yyminor=..., state=0x7ffe17b6a3a0) at parser.c:1919\n#7  0x00007f150b96b8e8 in numerize (data=data@entry=0x7f150b96c1aa \"one\", state=state@entry=0x7ffe17b6a3a0) at ../../../../ext/example_project/fast_numerizer/fast_numerizer.c:102\n#8  0x00007f150b960e0b in example_project_c_code_function () at ../../../../ext/example_project/./example_project.c:11\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "linux"], "answers": [{"comments": [{"owner": {"reputation": 6484, "user_id": 2628868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/IcdU7.jpg?s=128&g=1", "display_name": "Dolphin", "link": "https://stackoverflow.com/users/2628868/dolphin"}, "edited": false, "score": 0, "creation_date": 1479284500, "post_id": 40627077, "comment_id": 68487409, "body": "Thank you ,I will try later"}], "tags": [], "owner": {"reputation": 1364, "user_id": 5737512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nfjfF.jpg?s=128&g=1", "display_name": "Kaushlendra Tomar", "link": "https://stackoverflow.com/users/5737512/kaushlendra-tomar"}, "is_accepted": false, "score": 0, "last_activity_date": 1479284363, "creation_date": 1479284363, "answer_id": 40627077, "question_id": 40627051, "link": "https://stackoverflow.com/questions/40627051/install-rails-errorfailed-to-build-gem-native-extension/40627077#40627077", "title": "Install rails error:Failed to build gem native extension", "body": "<p>Just update your system by using following command</p>\n\n<pre><code>gem update --system 2.0.3\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6484, "user_id": 2628868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/IcdU7.jpg?s=128&g=1", "display_name": "Dolphin", "link": "https://stackoverflow.com/users/2628868/dolphin"}, "is_accepted": true, "score": 0, "last_activity_date": 1479370221, "creation_date": 1479370221, "answer_id": 40649670, "question_id": 40627051, "link": "https://stackoverflow.com/questions/40627051/install-rails-errorfailed-to-build-gem-native-extension/40649670#40649670", "title": "Install rails error:Failed to build gem native extension", "body": "<p>Install dependency:</p>\n\n<pre><code>yum -y install libyaml-devel zlib-devel curl-devel openssl-devel httpd-devel apr-devel apr-util-devel gcc ruby-devel gcc-c++ make postgresql-devel ImageMagick-devel sqlite-devel perl-LDAP mod_perl perl-Digest-SHA\n</code></pre>\n"}], "owner": {"reputation": 6484, "user_id": 2628868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/IcdU7.jpg?s=128&g=1", "display_name": "Dolphin", "link": "https://stackoverflow.com/users/2628868/dolphin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "accepted_answer_id": 40649670, "answer_count": 2, "score": 0, "last_activity_date": 1479370221, "creation_date": 1479284253, "question_id": 40627051, "link": "https://stackoverflow.com/questions/40627051/install-rails-errorfailed-to-build-gem-native-extension", "title": "Install rails error:Failed to build gem native extension", "body": "<p>I am install rail on CentOS 7.2,this is my install command:</p>\n\n<pre><code>gem install rails -v=4.2\n</code></pre>\n\n<p>This is the error log output:</p>\n\n<pre><code>[root@localhost ~]# gem install rails -v=4.2\ngem install rails -v=4.2Building native extensions.  This could take a while...\nERROR:  Error installing rails:\n        ERROR: Failed to build gem native extension.\n\n    /usr/bin/ruby extconf.rb\nmkmf.rb can't find header files for ruby at /usr/share/include/ruby.h\n\n\nGem files will remain installed in /usr/local/share/gems/gems/nokogiri-1.6.8.1 for inspection.\nResults logged to /usr/local/share/gems/gems/nokogiri-1.6.8.1/ext/nokogiri/gem_make.out\n</code></pre>\n\n<p>CentOS: 7.2</p>\n\n<p>Ruby: ruby 2.0.0p598 (2014-11-13) [x86_64-linux]</p>\n\n<p>gem: 2.0.14</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 136, "user_id": 7066618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9d59bc5a69bc5181a0647c86a7f5c64?s=128&d=identicon&r=PG&f=1", "display_name": "LiXie", "link": "https://stackoverflow.com/users/7066618/lixie"}, "edited": false, "score": 0, "creation_date": 1479283845, "post_id": 40626917, "comment_id": 68487103, "body": "Hi, it is better that you copy and paste your code directly into your post here. We can&#39;t really use it otherwise!"}, {"owner": {"reputation": 33, "user_id": 7166200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e645fb70e2ddfd499b1e9d2dc2b83d97?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Hill", "link": "https://stackoverflow.com/users/7166200/sam-hill"}, "reply_to_user": {"reputation": 136, "user_id": 7066618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9d59bc5a69bc5181a0647c86a7f5c64?s=128&d=identicon&r=PG&f=1", "display_name": "LiXie", "link": "https://stackoverflow.com/users/7066618/lixie"}, "edited": false, "score": 0, "creation_date": 1479284212, "post_id": 40626917, "comment_id": 68487247, "body": "Okay, fixed it. Thanks!"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1479285148, "post_id": 40626917, "comment_id": 68487757, "body": "I don&#39;t see any sorting here."}, {"owner": {"reputation": 33, "user_id": 7166200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e645fb70e2ddfd499b1e9d2dc2b83d97?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Hill", "link": "https://stackoverflow.com/users/7166200/sam-hill"}, "edited": false, "score": 0, "creation_date": 1479287707, "post_id": 40626917, "comment_id": 68489273, "body": "Sorry, &quot;sorting&quot; was the wrong word. And thanks everyone for your help!"}], "answers": [{"tags": [], "owner": {"reputation": 653, "user_id": 7148414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KMhlJ.jpg?s=128&g=1", "display_name": "baseballlover723", "link": "https://stackoverflow.com/users/7148414/baseballlover723"}, "is_accepted": false, "score": 1, "last_activity_date": 1479285114, "last_edit_date": 1479285114, "creation_date": 1479284800, "answer_id": 40627194, "question_id": 40626917, "link": "https://stackoverflow.com/questions/40626917/ruby-cannot-sum-up-hash-values/40627194#40627194", "title": "Ruby - Cannot sum up hash values", "body": "<p>looks like you have your loops reversed. Also, using do and end is usually preferred over curly braces for multiline code blocks, while curly braces are generally used for single line blocks (as noted by @mudasobwa). Check out the <a href=\"https://github.com/bbatsov/ruby-style-guide\" rel=\"nofollow noreferrer\">ruby style guide</a> for some more style pointers.</p>\n\n<pre><code>myhash.each do |key,value| \n    newtotal+=value.to_f if value.to_f &gt; 1500\nend\nputs newtotal\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7638, "user_id": 1014251, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1c4500c91af486c885af8bb84eefd063?s=128&d=identicon&r=PG", "display_name": "ReggieB", "link": "https://stackoverflow.com/users/1014251/reggieb"}, "edited": false, "score": 2, "creation_date": 1479286627, "post_id": 40627418, "comment_id": 68488606, "body": "Sam also wants the number of pricy elements. I suggest removing <code>inject</code> from <code>pricy</code> and then having <code>pricy_sum = pricy.inject(&amp;:+)</code> and <code>privy_count = pricy.length</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 7638, "user_id": 1014251, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1c4500c91af486c885af8bb84eefd063?s=128&d=identicon&r=PG", "display_name": "ReggieB", "link": "https://stackoverflow.com/users/1014251/reggieb"}, "edited": false, "score": 0, "creation_date": 1479287608, "post_id": 40627418, "comment_id": 68489219, "body": "@ReggieB indeed, thanks, updated. Also, please note, you don\u2019t need to <code>&amp;</code> symbols in calls to <code>inject</code>, the latter accepts <code>Symbol</code> instances."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1479287595, "last_edit_date": 1479287595, "creation_date": 1479285618, "answer_id": 40627418, "question_id": 40626917, "link": "https://stackoverflow.com/questions/40626917/ruby-cannot-sum-up-hash-values/40627418#40627418", "title": "Ruby - Cannot sum up hash values", "body": "<p>I will rewrite the code in ruby idiomatic way in hope you\u2019ll examine it and find out some hints.</p>\n\n<pre><code>prices = File.readlines(\"Purchase Orders.csv\").map do |line|\n  line.chomp.split(\",\").last.to_f\nend # array of prices\n\ntotal = prices.inject(:+) # sum values\npricy = prices.select { |v| v &gt; 1500 }\n\npricy_sum = pricy.inject(:+) # sum expensives\npricy_count = pricy.length   # expensives\u2019 size\n\nputs \"Total sum is: #{total}\"\nputs \"Total expensives is: #{pricy}\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1479328645, "creation_date": 1479328645, "answer_id": 40641840, "question_id": 40626917, "link": "https://stackoverflow.com/questions/40626917/ruby-cannot-sum-up-hash-values/40641840#40641840", "title": "Ruby - Cannot sum up hash values", "body": "<p><strong>Code</strong></p>\n\n<pre><code>def nbr_and_tot(fname)\n  File.foreach(fname).with_object({ nbr_over: 0, tot_over: 0 }) do |line, h|\n    n = line[/\\d+/].to_i     \n    if n &gt; 1500\n      h[:nbr_over] += 1\n      h[:tot_over] += n\n    end\n  end\nend\n</code></pre>\n\n<p><strong>Example</strong></p>\n\n<p>First let's create a file \"temp\":</p>\n\n<pre><code>str =&lt;&lt;-END\n:cat, 1501\n:dog, 1500\n:pig, 2000\nEND\n\nFile.write(\"temp\", str)\n  #=&gt; 33\n</code></pre>\n\n<p>Confirm the file is correct:</p>\n\n<pre><code>puts File.read(\"temp\")\n</code></pre>\n\n<p>prints</p>\n\n<pre><code>:cat, 1501\n:dog, 1500\n:pig, 2000\n</code></pre>\n\n<p>Now execute the method.</p>\n\n<pre><code>nbr_and_tot \"temp\"\n  #=&gt; {:nbr_over=&gt;2, :tot_over=&gt;3501}\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>First review, as necessary, <a href=\"http://ruby-doc.org/core-2.3.0/IO.html#method-c-foreach\" rel=\"nofollow noreferrer\">IO::foreach</a>, which reads the file line-by-line<sup>1</sup> and returns an enumerator that is chained to <code>with_object</code>,  <a href=\"http://ruby-doc.org/core-2.3.0/Enumerator.html#method-i-with_object\" rel=\"nofollow noreferrer\">Enumerator#with_object</a> and <a href=\"http://ruby-doc.org/core-2.3.0/String.html#method-i-5B-5D\" rel=\"nofollow noreferrer\">String#[]</a>.</p>\n\n<p>For the example,</p>\n\n<pre><code>fname = \"temp\"\ne0 = File.foreach(fname)\n  #=&gt; #&lt;Enumerator: File:foreach(\"temp\")&gt; \n</code></pre>\n\n<p>We can see the values that will be generated by this enumerator (and passed to <code>each_object</code>) by converting it to an array:</p>\n\n<pre><code>e0.to_a\n  #=&gt; [\":cat, 1501\\n\", \":dog, 1500\\n\", \":pig, 2000\\n\"] \n</code></pre>\n\n<p>Continuing,</p>\n\n<pre><code>e1 = e0.with_object({ nbr_over: 0, tot_over: 0 })\n  #=&gt; #&lt;Enumerator: #&lt;Enumerator: 2.3.0 :171 &gt;\ne1.to_a\n  #=&gt; [[\":cat, 1501\\n\", {:nbr_over=&gt;0, :tot_over=&gt;0}],\n  #    [\":dog, 1500\\n\", {:nbr_over=&gt;0, :tot_over=&gt;0}],\n  #    [\":pig, 2000\\n\", {:nbr_over=&gt;0, :tot_over=&gt;0}]] \n</code></pre>\n\n<p>The first element generated by <code>e1</code> is passed to the block and the block variables are assigned values, using <em>parallel assignment</em>:</p>\n\n<pre><code>line, h = e1.next\n  #=&gt; [\":cat, 1501\\n\", {:nbr_over=&gt;0, :tot_over=&gt;0}] \nline\n  #=&gt; \":cat, 1501\\n\" \nh #=&gt; {:nbr_over=&gt;0, :tot_over=&gt;0} \n</code></pre>\n\n<p>and <code>n</code> is computed:</p>\n\n<pre><code>s = line[/\\d+/]\n  #=&gt; \"1501\"\nn = s.to_i\n  #=&gt; 1501\n</code></pre>\n\n<p>As <code>n &gt; 1500 #=&gt; true</code>, we perform the following operations:      </p>\n\n<pre><code>h[:nbr_over] += 1\n  #=&gt; 1 \nh[:tot_over] += n\n  #=&gt; 1501 \n</code></pre>\n\n<p>so now</p>\n\n<pre><code>h #=&gt; {:nbr_over=&gt;1, :tot_over=&gt;1501}\n</code></pre>\n\n<p>Now the second element of <code>e1</code> is passed to the block and the following steps are performed:</p>\n\n<pre><code>line, h = e1.next\n  #=&gt; [\":dog, 1500\\n\", {:nbr_over=&gt;1, :tot_over=&gt;1501}] \nline\n  #=&gt; \":dog, 1500\\n\" \nh #=&gt; {:nbr_over=&gt;1, :tot_over=&gt;1501} \nn = line[/\\d+/].to_i\n  #=&gt; 1500\n</code></pre>\n\n<p>As <code>n &gt; 1500 #=&gt; fasle</code>, this line is skipped. The processing of the last element generated by <code>e1</code> is similar to that for the first element. </p>\n\n<p><sup>1 <code>File</code> is a subclass of <code>IO</code> (<code>File &lt; IO #=&gt; true</code>), so <code>IO</code> class methods such as <code>foreach</code> are often invoked on the File class (<code>File.foreach...</code>)</sup>.</p>\n"}], "owner": {"reputation": 33, "user_id": 7166200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e645fb70e2ddfd499b1e9d2dc2b83d97?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Hill", "link": "https://stackoverflow.com/users/7166200/sam-hill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 40627418, "answer_count": 3, "score": 3, "last_activity_date": 1479328645, "creation_date": 1479283738, "last_edit_date": 1479287895, "question_id": 40626917, "link": "https://stackoverflow.com/questions/40626917/ruby-cannot-sum-up-hash-values", "title": "Ruby - Cannot sum up hash values", "body": "<p>I'm new to Ruby (and programming in general). I have a hash that is using data from an external file, and I'm trying to get the total number of values that are greater than 1500.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8y7Ew.png\" rel=\"nofollow noreferrer\">Here's my code</a> Actually, I need both the number of entries and the total value of purchase orders over 1500. The external file is just a column of order numbers and a column of prices. I'm sure there is a very simple solution, but like I said I'm a beginner and can't figure it out. Any help would be appreciated. Thanks.</p>\n\n<p>Edit: Here is my code. It's just that last while loop that's causing all the problems. I know that's not the right way to go about it, but I just can't figure out what to do.</p>\n\n<pre><code>myhash={}\n\nfile=File.open(\"Purchase Orders.csv\", \"r\")\nwhile !file.eof\n  line=file.readline\n\n  key,value=line.chomp.split(\",\")\n  myhash[key]=value\nend\n\ntotal=0\nentries=myhash.length\nnewtotal=0\n\nmyhash.each { |key,value|\n  total+=value.to_f\n}\nputs total\nputs entries\n\nwhile value.to_f&gt;1500\n  myhash.each {|key,value| newtotal+=value.to_f}\nend\n\nputs newtotal\n</code></pre>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 4616, "user_id": 284257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f4e37ffbbf81653b797ec4cf995a23b1?s=128&d=identicon&r=PG", "display_name": "Sig", "link": "https://stackoverflow.com/users/284257/sig"}, "edited": false, "score": 0, "creation_date": 1479380933, "post_id": 40628051, "comment_id": 68537789, "body": "@macsig haven&#39;t tried it, but you probably have to <code>allow(Publisher).to receive(:call).and_call_original</code>"}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 4, "last_activity_date": 1479287609, "creation_date": 1479287609, "answer_id": 40628051, "question_id": 40626836, "link": "https://stackoverflow.com/questions/40626836/can-i-spy-a-class/40628051#40628051", "title": "Can I spy a class?", "body": "<p>You can use <a href=\"https://relishapp.com/rspec/rspec-mocks/docs/basics/spies#spy-on-a-method-on-a-partial-double\" rel=\"nofollow noreferrer\">spies on partial doubles</a> via <code>allow</code> plus <code>expect</code>:</p>\n\n<pre><code>it 'delegates the publishing to Publisher' do\n  let(:blog) { ... }\n  let(:post) { ... }\n\n  allow(Publisher).to receive(:call)\n  blog.publish(post)\n  expect(Publisher).to have_received(:call).with(post)\nend\n</code></pre>\n"}], "owner": {"reputation": 4616, "user_id": 284257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f4e37ffbbf81653b797ec4cf995a23b1?s=128&d=identicon&r=PG", "display_name": "Sig", "link": "https://stackoverflow.com/users/284257/sig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1479377033, "creation_date": 1479283396, "last_edit_date": 1479377033, "question_id": 40626836, "link": "https://stackoverflow.com/questions/40626836/can-i-spy-a-class", "title": "Can I spy a class?", "body": "<p>In the effort to make more readable my test suite, I'm introducing spies in my specs but I'm not sure how to deal with class methods. Is it possible to \"spy a class\"?</p>\n\n<p>Let's say I have the following sample code</p>\n\n<pre><code>  def publish(post)\n    Publisher.call(post)\n    post.save\n  end\n</code></pre>\n\n<p>And the correspondent spec</p>\n\n<pre><code>it 'delegates the publishing to Publisher' do\n  let(:blog) { ... }\n  let(:post) { ... }\n\n  expect(Publisher).to receive(:call).with(post).and_call_original\n  blog.publish(post)\nend\n</code></pre>\n\n<p>Is it possible to rewrite the spec using a spy?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 1364, "user_id": 5737512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nfjfF.jpg?s=128&g=1", "display_name": "Kaushlendra Tomar", "link": "https://stackoverflow.com/users/5737512/kaushlendra-tomar"}, "edited": false, "score": 0, "creation_date": 1479284798, "post_id": 40626738, "comment_id": 68487552, "body": "I think you want after registration why you are use in sites_controller.rb"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 5854975, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/990344fcf8b14a9487b01c1f87f01747?s=128&d=identicon&r=PG&f=1", "display_name": "Raidspec", "link": "https://stackoverflow.com/users/5854975/raidspec"}, "edited": false, "score": 0, "creation_date": 1479321064, "post_id": 40627771, "comment_id": 68511441, "body": "The site ISN&#39;T created as part of registration. Right now, the user must be logged in to create a site.   So I would put current_user.site_id = @site.id in the Create part in my sessions controller or the sites controller?"}, {"owner": {"reputation": 2405, "user_id": 135845, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/agZcF.jpg?s=128&g=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/135845/eric"}, "reply_to_user": {"reputation": 71, "user_id": 5854975, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/990344fcf8b14a9487b01c1f87f01747?s=128&d=identicon&r=PG&f=1", "display_name": "Raidspec", "link": "https://stackoverflow.com/users/5854975/raidspec"}, "edited": false, "score": 0, "creation_date": 1479321882, "post_id": 40627771, "comment_id": 68511858, "body": "Do it in the sites controller like my first example, then."}], "tags": [], "owner": {"reputation": 2405, "user_id": 135845, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/agZcF.jpg?s=128&g=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/135845/eric"}, "is_accepted": false, "score": 1, "last_activity_date": 1479286795, "creation_date": 1479286795, "answer_id": 40627771, "question_id": 40626738, "link": "https://stackoverflow.com/questions/40626738/assigning-user-a-site-id-on-creating-a-new-site-in-controller/40627771#40627771", "title": "Assigning user a site_id on creating a new site in controller.", "body": "<p>Create it through the <a href=\"http://guides.rubyonrails.org/association_basics.html#belongs-to-association-reference\" rel=\"nofollow noreferrer\">user association</a>.  </p>\n\n<pre><code>def create\n  respond_to do |format|\n    if current_user.create_site(site_params)\n      format.html { ... }\n      # ...\n    else\n      # ...\n    end\n  end\nend\n</code></pre>\n\n<p>If the site is created as part of the registration, in that you can't create a user without creating their site association, then throw the above line somewhere after the point in your user create method where they're signed in. </p>\n\n<p>If you don't sign in a user after creating them and they have to log in from scratch, put the line in your login method (<code>UserSession#create</code> or whatever) after the session is up and <code>current_user</code> is available, checking that they don't already have one assigned so you don't clobber their existing site.</p>\n"}, {"tags": [], "owner": {"reputation": 189, "user_id": 3368222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DN3yr.jpg?s=128&g=1", "display_name": "Pratap", "link": "https://stackoverflow.com/users/3368222/pratap"}, "is_accepted": false, "score": 0, "last_activity_date": 1479293536, "creation_date": 1479293536, "answer_id": 40630265, "question_id": 40626738, "link": "https://stackoverflow.com/questions/40626738/assigning-user-a-site-id-on-creating-a-new-site-in-controller/40630265#40630265", "title": "Assigning user a site_id on creating a new site in controller.", "body": "<p>When you use has_many and belongs_to rails provide build method for you.</p>\n\n<pre><code> current_user.sites.build(site_params)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 5854975, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/990344fcf8b14a9487b01c1f87f01747?s=128&d=identicon&r=PG&f=1", "display_name": "Raidspec", "link": "https://stackoverflow.com/users/5854975/raidspec"}, "is_accepted": true, "score": -1, "last_activity_date": 1479322854, "creation_date": 1479322854, "answer_id": 40640202, "question_id": 40626738, "link": "https://stackoverflow.com/questions/40626738/assigning-user-a-site-id-on-creating-a-new-site-in-controller/40640202#40640202", "title": "Assigning user a site_id on creating a new site in controller.", "body": "<p>Doing this to sites_controller.rb will give the current_user.site_id the @site.id that was just made. </p>\n\n<pre><code>  def create\n    @site = Site.new(site_params)\n    @site.user_id = current_user.id\n    respond_to do |format|\n      if @site.save\n        format.html { redirect_to @site, notice: 'Site was successfully created.' }\n        format.json { render :show, status: :created, location: @site }\n      else\n        format.html { render :new }\n        format.json { render json: @site.errors, status: :unprocessable_entity }\n      end\n    end\n    if current_user.site_id.blank?\n      current_user.site_id = @site.id\n      current_user.save\n    end \n  end\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 5854975, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/990344fcf8b14a9487b01c1f87f01747?s=128&d=identicon&r=PG&f=1", "display_name": "Raidspec", "link": "https://stackoverflow.com/users/5854975/raidspec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 40640202, "answer_count": 3, "score": 0, "last_activity_date": 1479322854, "creation_date": 1479282965, "question_id": 40626738, "link": "https://stackoverflow.com/questions/40626738/assigning-user-a-site-id-on-creating-a-new-site-in-controller", "title": "Assigning user a site_id on creating a new site in controller.", "body": "<p>So far I have <code>user belongs_to :sites</code> and <code>site has_many :users</code>. And i have <code>user_id</code> in the sites schema and <code>site_id</code> in the users schema. </p>\n\n<p>I'm trying to set it up where once a user creates a new site, than that site_id is assigned to that user. And only one site can be created per user. </p>\n\n<p>I've tried <code>@user.site_id = Site.find(params[:id])</code> in the sites_controller.rb, but no luck. </p>\n\n<p>sites_controller.rb</p>\n\n<pre><code>  def create\n    @site = Site.new(site_params)\n    @site.user_id = current_user.id\n    respond_to do |format|\n      if @site.save\n        format.html { redirect_to @site, notice: 'Site was successfully created.' }\n        format.json { render :show, status: :created, location: @site }\n      else\n        format.html { render :new }\n        format.json { render json: @site.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n\n<p>registrations_controller.rb</p>\n\n<pre><code>class Users::RegistrationsController &lt; Devise::RegistrationsController\n  respond_to :json\n\n  def create\n    build_resource(sign_up_params)\n    resource.save\n    yield resource if block_given?\n\n    if resource.persisted?\n      if resource.active_for_authentication?\n        message = find_message(:signed_up)\n        flash[:notice] = message\n        sign_up(resource_name, resource)\n        if request.xhr?\n          return render :json =&gt; {:success =&gt; true, :data =&gt;  {:message =&gt; message}}\n        else\n          respond_with resource, location: after_sign_up_path_for(resource)\n        end\n      else\n        message = find_message(:\"signed_up_but_#{resource.inactive_message}\" )\n        expire_data_after_sign_in!\n        if request.xhr?\n         return render :json =&gt; {:success =&gt; true, :data =&gt;  {:message =&gt; message}}\n        else\n          respond_with resource, location: after_inactive_sign_up_path_for(resource)\n        end\n      end\n    else\n      clean_up_passwords resource\n      messages = resource.errors.messages\n      if request.xhr?\n       return render :json =&gt; {:success =&gt; false, :data =&gt;  {:message =&gt; messages}}\n      else\n        respond_with resource\n      end\n    end\n  end\n\n  def sign_up_params\n    params.require(:user).permit(:email, :password, :password_confirmation)\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "foreign-keys"], "comments": [{"owner": {"reputation": 4630, "user_id": 3058254, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Z10oX.jpg?s=128&g=1", "display_name": "Aravin", "link": "https://stackoverflow.com/users/3058254/aravin"}, "edited": false, "score": 0, "creation_date": 1495280166, "post_id": 40625890, "comment_id": 75193269, "body": "Is your issue solved?"}, {"owner": {"reputation": 1066, "user_id": 6204421, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/0yeJN.jpg?s=128&g=1", "display_name": "Santosh Aryal", "link": "https://stackoverflow.com/users/6204421/santosh-aryal"}, "reply_to_user": {"reputation": 4630, "user_id": 3058254, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Z10oX.jpg?s=128&g=1", "display_name": "Aravin", "link": "https://stackoverflow.com/users/3058254/aravin"}, "edited": false, "score": 1, "creation_date": 1498013396, "post_id": 40625890, "comment_id": 76317310, "body": "Not yet. I did the fix by change all nested models to single model."}, {"owner": {"reputation": 2466, "user_id": 951579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6c323b13b43d4f85aeb474a657f5ab94?s=128&d=identicon&r=PG", "display_name": "Drazen Mokic", "link": "https://stackoverflow.com/users/951579/drazen-mokic"}, "edited": false, "score": 0, "creation_date": 1529164242, "post_id": 40625890, "comment_id": 88780009, "body": "Running into the same issue. Did you find a fix?"}, {"owner": {"reputation": 1066, "user_id": 6204421, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/0yeJN.jpg?s=128&g=1", "display_name": "Santosh Aryal", "link": "https://stackoverflow.com/users/6204421/santosh-aryal"}, "edited": false, "score": 0, "creation_date": 1529200763, "post_id": 40625890, "comment_id": 88786610, "body": "I haven&#39;t tried it again."}], "answers": [{"tags": [], "owner": {"reputation": 2466, "user_id": 951579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6c323b13b43d4f85aeb474a657f5ab94?s=128&d=identicon&r=PG", "display_name": "Drazen Mokic", "link": "https://stackoverflow.com/users/951579/drazen-mokic"}, "is_accepted": true, "score": 1, "last_activity_date": 1529312389, "creation_date": 1529312389, "answer_id": 50905902, "question_id": 40625890, "link": "https://stackoverflow.com/questions/40625890/unknownattributeerror-unknown-attribute-news-id-for-controlcomment/50905902#50905902", "title": "UnknownAttributeError: unknown attribute &#39;news_id&#39; for Control::Comment", "body": "<p>Because you are manually setting the class_name, Active Record can't automatically recognise the bi-directional relation. You need to tell Control::News how to find itself by adding inverse_of.</p>\n\n<pre><code>    has_many :control_comments, class_name: \"Control::Comment\",inverse_of: 'control_news', :foreign_key =&gt; 'control_news_id'\n</code></pre>\n\n<p>You can read more about bi-directional associations here <a href=\"http://guides.rubyonrails.org/association_basics.html#bi-directional-associations\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/association_basics.html#bi-directional-associations</a></p>\n"}], "owner": {"reputation": 1066, "user_id": 6204421, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/0yeJN.jpg?s=128&g=1", "display_name": "Santosh Aryal", "link": "https://stackoverflow.com/users/6204421/santosh-aryal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 630, "favorite_count": 0, "accepted_answer_id": 50905902, "answer_count": 1, "score": 2, "last_activity_date": 1529312389, "creation_date": 1479279674, "last_edit_date": 1479281068, "question_id": 40625890, "link": "https://stackoverflow.com/questions/40625890/unknownattributeerror-unknown-attribute-news-id-for-controlcomment", "title": "UnknownAttributeError: unknown attribute &#39;news_id&#39; for Control::Comment", "body": "<p>While trying to post comments in the news I am getting the unknown attribute error for the namespace models.</p>\n\n<p>control/news.rb</p>\n\n<pre><code>class Control::News &lt; ApplicationRecord\n    belongs_to :user\n    belongs_to :control_category, class_name: \"Control::Category\"\n    has_many :control_comments, class_name: \"Control::Comment\", :foreign_key =&gt; 'control_news_id'\nend\n</code></pre>\n\n<p>control/comments.rb</p>\n\n<pre><code>class Control::Comment &lt; ApplicationRecord\n    belongs_to :control_news, class_name: \"Control::News\", :foreign_key =&gt; \"control_news_id\"\nend\n</code></pre>\n\n<p>Comment Migration File</p>\n\n<pre><code>class CreateControlComments &lt; ActiveRecord::Migration[5.0]\n  def up\n    create_table :control_comments do |t|\n      t.string \"name\"\n      t.string \"email\"\n      t.text \"comment\"\n      t.references :control_news, foreign_key: true\n      t.boolean \"status\", :default =&gt; false\n      t.timestamps\n    end\n    def down\n        drop_table :comments\n    end\n  end\nend\n</code></pre>\n\n<p>Its not working. Whenever I try to post a comment I am getting the unknown attributes \"news_id\" but the foreign key is \"control_news_id\". Please help me to fix it.</p>\n\n<p>Rails console</p>\n\n<pre><code>a = Control::News.find(112)\nb = b.control_comments.create(name: \"test\")\n\nActiveModel::UnknownAttributeError: unknown attribute 'news_id' for Control::Comment.\n    from /Users/santosharyal/.rvm/gems/ruby-2.2.2/gems/activemodel-5.0.0.1/lib/active_model/attribute_assignment.rb:48:in `_assign_attribute'\n    from /Users/santosharyal/.rvm/gems/ruby-2.2.2/gems/activemodel-5.0.0.1/lib/active_model/attribute_assignment.rb:40:in `block in _assign_attributes'\n    from /Users/santosharyal/.rvm/gems/ruby-2.2.2/gems/activemodel-5.0.0.1/lib/active_model/attribute_assignment.rb:39:in `each'\n    from /Users/santosharyal/.rvm/gems/ruby-2.2.2/gems/activemodel-5.0.0.1/lib/active_model/attribute_assignment.rb:39:in `_assign_attributes'\n    from /Users/santosharyal/.rvm/gems/ruby-2.2.2/gems/activerecord-5.0.0.1/lib/active_record/attribute_assignment.rb:26:in `_assign_attributes'\n    from /Users/santosharyal/.rvm/gems/ruby-2.2.2/gems/activemodel-5.0.0.1/lib/active_model/attribute_assignment.rb:33:in `assign_attributes'\n    from /Users/santosharyal/.rvm/gems/ruby-2.2.2/gems/activerecord-5.0.0.1/lib/active_record/associations/association.rb:172:in `initialize_attributes'\n    from /Users/santosharyal/.rvm/gems/ruby-2.2.2/gems/activerecord-5.0.0.1/lib/active_record/associations/association.rb:254:in `block in build_record'\n    from /Users/santosharyal/.rvm/gems/ruby-2.2.2/gems/activerecord-5.0.0.1/lib/active_record/core.rb:321:in `initialize'\n    from /Users/santosharyal/.rvm/gems/ruby-2.2.2/gems/activerecord-5.0.0.1/lib/active_record/inheritance.rb:65:in `new'\n    from /Users/santosharyal/.rvm/gems/ruby-2.2.2/gems/activerecord-5.0.0.1/lib/active_record/inheritance.rb:65:in `new'\n    from /Users/santosharyal/.rvm/gems/ruby-2.2.2/gems/activerecord-5.0.0.1/lib/active_record/reflection.rb:152:in `build_association'\n    from /Users/santosharyal/.rvm/gems/ruby-2.2.2/gems/activerecord-5.0.0.1/lib/active_record/associations/association.rb:253:in `build_record'\n    from /Users/santosharyal/.rvm/gems/ruby-2.2.2/gems/activerecord-5.0.0.1/lib/active_record/associations/collection_association.rb:165:in `build'\n    from /Users/santosharyal/.rvm/gems/ruby-2.2.2/gems/activerecord-5.0.0.1/lib/active_record/associations/collection_proxy.rb:294:in `build'\n    from (irb):7\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "capybara", "page-object-gem"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1479293364, "post_id": 40625755, "comment_id": 68493004, "body": "Capybara supports many more drivers such as Poltergeist. Both are pretty active but Capybara has about 4x as many contributors."}, {"owner": {"reputation": 1126, "user_id": 4927393, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-7rRm-826oe4/AAAAAAAAAAI/AAAAAAAAIQ8/jBtS640nEeU/photo.jpg?sz=128", "display_name": "Dragan Nikolic", "link": "https://stackoverflow.com/users/4927393/dragan-nikolic"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1479497079, "post_id": 40625755, "comment_id": 68599637, "body": "Thanks to Justin Ko&#39;s answer I now understand that question Capybara vs Page Object is not valid because they are different things. Better question would be Capybara vs Selenium or Watir, but for that I already found plenty of opinions. I just wander if I should delete this question or leave it here for the people that may have wrong understanding as I had?"}], "answers": [{"tags": [], "owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "is_accepted": true, "score": 3, "last_activity_date": 1479304276, "creation_date": 1479304276, "answer_id": 40633876, "question_id": 40625755, "link": "https://stackoverflow.com/questions/40625755/capybara-vs-page-object/40633876#40633876", "title": "Capybara vs Page Object", "body": "<p>You cannot use Cheezy's page-object gem with Capybara.</p>\n\n<p>The page-object gem only supports Watir-Webdriver and Selenium-WebDriver. It does not support Capybara.</p>\n\n<p>Capybara, Watir and Selenium are for driving browsers while page-object is for modelling your pages. If you switch to Capybara, you would need to pick a different page-object library such as <a href=\"https://github.com/natritmeyer/site_prism\" rel=\"nofollow noreferrer\">SitePrism</a>. Switching would mean you either need to support two completely separate stacks or re-write your existing tests.</p>\n"}], "owner": {"reputation": 1126, "user_id": 4927393, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-7rRm-826oe4/AAAAAAAAAAI/AAAAAAAAIQ8/jBtS640nEeU/photo.jpg?sz=128", "display_name": "Dragan Nikolic", "link": "https://stackoverflow.com/users/4927393/dragan-nikolic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1013, "favorite_count": 0, "accepted_answer_id": 40633876, "answer_count": 1, "score": -3, "last_activity_date": 1479304276, "creation_date": 1479279124, "question_id": 40625755, "link": "https://stackoverflow.com/questions/40625755/capybara-vs-page-object", "title": "Capybara vs Page Object", "body": "<p>I'm currently using Cucumber and <a href=\"https://github.com/cheezy/page-object\" rel=\"nofollow noreferrer\">Ruby Page Object</a> for testing my Ruby on Rails website.</p>\n\n<p>I'm trying to understand <a href=\"https://github.com/teamcapybara/capybara\" rel=\"nofollow noreferrer\">Capybara</a> and decide if I should add it to the mix, or maybe replace Page Object with it.</p>\n\n<p>I'd appreciate if somebody provides more insights into benefits of using Capybara when compared to Page Object, and does it make sense to use them together?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nginx"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1479280287, "post_id": 40625652, "comment_id": 68485433, "body": "Are you sure the <code>config.ru</code> file is present and Passenger is properly engaged? Are you sure this is the <code>server</code> directive being used and some other one isn&#39;t overriding it somehow?"}, {"owner": {"reputation": 1, "user_id": 6197299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7d71e6a700dd1934a56da730bc058d1?s=128&d=identicon&r=PG&f=1", "display_name": "Lousy coder", "link": "https://stackoverflow.com/users/6197299/lousy-coder"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1479281538, "post_id": 40625652, "comment_id": 68486068, "body": "Yes, config.ru is present and below are it&#39;s content.    # This file is used by Rack-based servers to start the application.  <code>require ::File.expand_path(&#39;..&#47;config&#47;environment&#39;, __FILE__) run Rails.application</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1479282246, "post_id": 40625652, "comment_id": 68486439, "body": "You&#39;re going to have to do more diagnostics. Broken <code>routes.rb</code>? Any errors anywhere?"}, {"owner": {"reputation": 1, "user_id": 6197299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7d71e6a700dd1934a56da730bc058d1?s=128&d=identicon&r=PG&f=1", "display_name": "Lousy coder", "link": "https://stackoverflow.com/users/6197299/lousy-coder"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1479282571, "post_id": 40625652, "comment_id": 68486574, "body": "I did that, no error in development environment. If <code>routes.rb</code> was broken, error would appear in dev also. Everything was working 3 days ago in production, don&#39;t know what changed."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1479323787, "post_id": 40625652, "comment_id": 68512960, "body": "That&#39;s what revision control systems are for. Keep digging and I&#39;m sure you&#39;ll get it."}, {"owner": {"reputation": 1, "user_id": 6197299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7d71e6a700dd1934a56da730bc058d1?s=128&d=identicon&r=PG&f=1", "display_name": "Lousy coder", "link": "https://stackoverflow.com/users/6197299/lousy-coder"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1479380209, "post_id": 40625652, "comment_id": 68537272, "body": "I checked it all and found no discrepancy. Will that be any kind of configuration issue?"}, {"owner": {"reputation": 1, "user_id": 6197299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7d71e6a700dd1934a56da730bc058d1?s=128&d=identicon&r=PG&f=1", "display_name": "Lousy coder", "link": "https://stackoverflow.com/users/6197299/lousy-coder"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1479465056, "post_id": 40625652, "comment_id": 68579549, "body": "Did all kind of code level diagnostics, no change found that might cause this  problem. Server still running on development and I am running out of time. Can anybody please suggest how to tackle ?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1479509229, "post_id": 40625652, "comment_id": 68604730, "body": "If you&#39;re really pinned you might need to hire an on-demand consultant to fix it like <a href=\"https://hackhands.com\" rel=\"nofollow noreferrer\">Hackhands</a> or <a href=\"http://codementor.io\" rel=\"nofollow noreferrer\">Codementor</a>."}], "owner": {"reputation": 1, "user_id": 6197299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7d71e6a700dd1934a56da730bc058d1?s=128&d=identicon&r=PG&f=1", "display_name": "Lousy coder", "link": "https://stackoverflow.com/users/6197299/lousy-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479278655, "creation_date": 1479278655, "question_id": 40625652, "link": "https://stackoverflow.com/questions/40625652/rails-looking-into-public-folder-for-all-urls-in-production-mode", "title": "rails looking into public folder for all URLs in production mode", "body": "<p>My rails app isn't working all of a sudden in production mode as every URL is looking into public folder rather than invoking controller actions, resulting  errors like</p>\n\n<pre><code>2016/11/16 11:48:23 [error] 25138#0: *9 open() \"/var/www/html/looted/public/admin/products\" failed (2: No such file or directory), client: 125.99.106.246, server: www.looted.com, request: \"GET /admin/products HTTP/1.1\", host: \"www.looted.com\"\n</code></pre>\n\n<p>When I run it in development, everything works fine. Am running passenger on nginx server with below configuration</p>\n\n<pre><code>server {\n    listen       80;\n    server_name  looted.com www.looted.com;\n    root /var/www/html/looted/public;\n    passenger_enabled on;\n    client_max_body_size 250M;\n    passenger_app_env production;\n}\n</code></pre>\n\n<p>I am using Rails 4.2.4, ruby 2.2.1p85, passenger-5.0.29\nCan anybody point me the direction to check what's wrong?\nThanks in advance</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activeadmin", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 2579, "user_id": 2198535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7n8mt.jpg?s=128&g=1", "display_name": "Tarique", "link": "https://stackoverflow.com/users/2198535/tarique"}, "edited": false, "score": 0, "creation_date": 1482311342, "post_id": 40625453, "comment_id": 69718045, "body": "Run &quot;bundle pack&quot; and &quot;bundle install --path vendor/cache&quot; command if you are having &quot;git://github.com/gregbell/active_admin.git (at master) is not yet checked out. Run &#39;bundle install&#39; first.&quot; message."}], "tags": [], "owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "is_accepted": true, "score": 3, "last_activity_date": 1479277786, "creation_date": 1479277786, "answer_id": 40625453, "question_id": 40625306, "link": "https://stackoverflow.com/questions/40625306/how-to-generate-active-admininstall-on-active-admin-rails-5-primary-support/40625453#40625453", "title": "How to generate active_admin:install on active admin rails 5 primary support?", "body": "<blockquote>\n  <p>Active Admin master has preliminary support for Rails 5. To give it a\n  try, these Gemfile changes <strong>may be needed</strong>.</p>\n</blockquote>\n\n<p>Whats mean you should add this gem with <code>gem 'activeadmin', github: 'activeadmin'</code>, so Gemfile should looks like:</p>\n\n<pre><code>gem 'activeadmin', github: 'activeadmin'\ngem 'inherited_resources', github: 'activeadmin/inherited_resources\n</code></pre>\n\n<p>Read the readme carefully. </p>\n"}], "owner": {"reputation": 6584, "user_id": 1831520, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/QFRGt.jpg?s=128&g=1", "display_name": "sadaf2605", "link": "https://stackoverflow.com/users/1831520/sadaf2605"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1269, "favorite_count": 0, "accepted_answer_id": 40625453, "answer_count": 1, "score": 0, "last_activity_date": 1479277786, "creation_date": 1479277118, "question_id": 40625306, "link": "https://stackoverflow.com/questions/40625306/how-to-generate-active-admininstall-on-active-admin-rails-5-primary-support", "title": "How to generate active_admin:install on active admin rails 5 primary support?", "body": "<p>Activeadmin <a href=\"https://github.com/activeadmin/activeadmin\" rel=\"nofollow noreferrer\">readme</a> suggests to use following to use for primary support on rails 5.</p>\n\n<pre><code>gem 'inherited_resources', github: 'activeadmin/inherited_resources\n</code></pre>\n\n<p>Even after <code>$ bundle install</code> it says there is no <code>active_admin:install</code> generator available.</p>\n\n<pre><code>$ rails generate active_admin:install\nRunning via Spring preloader in process 6209\nCould not find generator 'active_admin:install'. Maybe you meant 'responders:install', 'active_record:model' or 'active_record:migration'\nRun `rails generate --help` for more options.\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "answers": [{"tags": [], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "is_accepted": true, "score": 1, "last_activity_date": 1479284039, "creation_date": 1479284039, "answer_id": 40626993, "question_id": 40625161, "link": "https://stackoverflow.com/questions/40625161/rails-4-in-action-unable-to-push-code-to-heroku-sh-2-syntax-error-untermina/40626993#40626993", "title": "Rails 4 in Action: unable to push code to heroku, sh: 2: Syntax error: Unterminated quoted string", "body": "<p>I figured it out and hope this helps anyone else having the same issue.  </p>\n\n<p>What eventually did it for me was that I had to update the <code>fog</code> gem.  The book has you use version <code>1.29.0</code>.  For whatever reason: that version was not working for me.</p>\n\n<p>In my <code>Gemfile</code> I simply put <code>gem \"fog\"</code>, deleted my <code>Gemfile.lock</code> and ran <code>bundle</code> so that it would go out and grab the latest version.</p>\n\n<p>Afterwards I looked inside the <code>Gemfile.lock</code> and noticed it grabbed the <code>fog</code> version of <code>1.38.0</code>.  Now when I ran <code>git push heroku master</code> it worked.</p>\n\n<p>What led me to try out updating <code>fog</code> was <a href=\"https://github.com/fog/fog/issues/3765\" rel=\"nofollow noreferrer\">this issue on the fog github page</a>.</p>\n\n<p>In case anyone was curious: I was using <code>rails 4.2.1</code>, as well as <code>ruby 2.2.1</code> as the book tells you to. </p>\n"}], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 483, "favorite_count": 0, "accepted_answer_id": 40626993, "answer_count": 1, "score": 1, "last_activity_date": 1479284107, "creation_date": 1479276463, "last_edit_date": 1479284107, "question_id": 40625161, "link": "https://stackoverflow.com/questions/40625161/rails-4-in-action-unable-to-push-code-to-heroku-sh-2-syntax-error-untermina", "title": "Rails 4 in Action: unable to push code to heroku, sh: 2: Syntax error: Unterminated quoted string", "body": "<p>I am working through the <a href=\"https://www.manning.com/books/rails-4-in-action\" rel=\"nofollow noreferrer\">Rails 4 In Action</a> Book.  I am on <strong>chapter 13: Deployment</strong>,  page 457 where you push your code up to heroku:</p>\n\n<pre><code>git push heroku master\n</code></pre>\n\n<p>It appears to successfully grab all the needed gems as it gets to this part:</p>\n\n<pre><code>remote:        Bundle complete! 27 Gemfile dependencies, 90 gems now installed.\nremote:        Gems in the groups development and test were not installed.\nremote:        Bundled gems are installed into ./vendor/bundle.\nremote:        Bundle completed (29.18s)\nremote:        Cleaning up the bundler cache\n</code></pre>\n\n<p>But then right after that it blows up and says this:</p>\n\n<pre><code>remote: -----&gt; Detecting rake tasks\nremote: sh: 2: Syntax error: Unterminated quoted string\nremote: sh: 2: Syntax error: Unterminated quoted string\nremote:  !\nremote:  !     Could not detect rake tasks\nremote:  !     ensure you can run `$ bundle exec rake -P` against your app\nremote:  !     and using the production group of your Gemfile.\nremote:  !     rake aborted!\nremote:  !     LoadError: cannot load such file -- net/ssh\n</code></pre>\n\n<p>I did what it suggested and ran <code>bundle exec rake -P</code>.  Here was the output from that:</p>\n\n<pre><code>rake aborted!\n\nLoadError: cannot load such file -- net/ssh\n</code></pre>\n\n<p>This is the tough part when working through a tutorial book.  I do not think I missed any steps.  I'm not sure what to do here.  Any tips would be greatly appreciated.  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "symbols"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 3768251, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2c95e7dfe2df2f6ac23ec34a3a2272ff?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay", "link": "https://stackoverflow.com/users/3768251/akshay"}, "edited": false, "score": 0, "creation_date": 1479276983, "post_id": 40624951, "comment_id": 68484017, "body": "So even if we pass :test as parameter it will assign &quot;test&quot; as a value rather than value :test symbol is pointing to, right?"}, {"owner": {"reputation": 938, "user_id": 364977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e057779b93db035a68ef7d5c2094438?s=128&d=identicon&r=PG", "display_name": "atsui", "link": "https://stackoverflow.com/users/364977/atsui"}, "reply_to_user": {"reputation": 29, "user_id": 3768251, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2c95e7dfe2df2f6ac23ec34a3a2272ff?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay", "link": "https://stackoverflow.com/users/3768251/akshay"}, "edited": false, "score": 0, "creation_date": 1479277399, "post_id": 40624951, "comment_id": 68484181, "body": "I believe it should still by a symbol inside the function. Give this updated code a try."}, {"owner": {"reputation": 29, "user_id": 3768251, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2c95e7dfe2df2f6ac23ec34a3a2272ff?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay", "link": "https://stackoverflow.com/users/3768251/akshay"}, "edited": false, "score": 0, "creation_date": 1479292469, "post_id": 40624951, "comment_id": 68492412, "body": "When it is written outside class it prints Symbol, but when inside a class it gives error"}], "tags": [], "owner": {"reputation": 938, "user_id": 364977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e057779b93db035a68ef7d5c2094438?s=128&d=identicon&r=PG", "display_name": "atsui", "link": "https://stackoverflow.com/users/364977/atsui"}, "is_accepted": false, "score": 0, "last_activity_date": 1479277373, "last_edit_date": 1479277373, "creation_date": 1479275476, "answer_id": 40624951, "question_id": 40624892, "link": "https://stackoverflow.com/questions/40624892/symbol-can-be-passed-as-a-formal-argument-in-ruby/40624951#40624951", "title": "symbol can be passed as a formal argument in ruby", "body": "<p>The parameter should not be a symbol when you define your function, only when you call it. Try again with <code>callMe</code> defined like</p>\n\n<pre><code>def callMe(value)\n    p value.class\nend\n\ncallMe(:test)\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 3768251, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2c95e7dfe2df2f6ac23ec34a3a2272ff?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay", "link": "https://stackoverflow.com/users/3768251/akshay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1479279859, "creation_date": 1479275228, "last_edit_date": 1592644375, "question_id": 40624892, "link": "https://stackoverflow.com/questions/40624892/symbol-can-be-passed-as-a-formal-argument-in-ruby", "title": "symbol can be passed as a formal argument in ruby", "body": "<p>i have tried to used symbols and even instance variable as formal argument, but ruby gives error</p>\n<blockquote>\n<p>syntax error, unexpected tSYMBEG, expecting ')'</p>\n<p>def callMe(:value)</p>\n</blockquote>\n<p>so how does form_for in rails manages to use symbols and instance variables as first parameter</p>\n<pre><code>&lt;% form_for(@user) do |f| %&gt; ... &lt;% end %&gt;\n</code></pre>\n<p>OR</p>\n<pre><code>&lt;% form_for(:user) do |f| %&gt; ... &lt;% end %&gt;\n</code></pre>\n<p>Below is the code which i am trying to execute.</p>\n<pre><code>class Demo\n\nattr_accessor :name, :surname\n\ndef initialize(name,surname)\n    @name = name\n    @surname = surname\n    \nend\n\ndef printThis\n    puts name\n    puts surname\n     \n    callMe(name)\n    \nend\n    \n    def callMe(:value)\n        puts :value\n    end\n    \nend\n\nd = Demo.new('abc','pqr')\n\nd.printThis\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1479275513, "post_id": 40623752, "comment_id": 68483450, "body": "Where does the <code>data</code> hash come from and why is the <code>checks</code> key missing sometimes?"}, {"owner": {"reputation": 12011, "user_id": 600953, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee3d3a87e3451113e4d56067a22d4c41?s=128&d=identicon&r=PG", "display_name": "Dty", "link": "https://stackoverflow.com/users/600953/dty"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1479276195, "post_id": 40623752, "comment_id": 68483711, "body": "I have metadata on a model and sometimes it doesn&#39;t have certain keys. For example, some models have a check for dupes...but not all."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1479276873, "post_id": 40623752, "comment_id": 68483972, "body": "Maybe it would be cleaner to initialize the metadata with an empty <code>checks</code> array, so you don&#39;t need a &quot;type check&quot; in the first place."}, {"owner": {"reputation": 12011, "user_id": 600953, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee3d3a87e3451113e4d56067a22d4c41?s=128&d=identicon&r=PG", "display_name": "Dty", "link": "https://stackoverflow.com/users/600953/dty"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1479277416, "post_id": 40623752, "comment_id": 68484189, "body": "@Stefan that would work for this particular case but as time goes on we keep adding new data to the metadata field."}], "answers": [{"tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": false, "score": 0, "last_activity_date": 1479268891, "creation_date": 1479268891, "answer_id": 40623856, "question_id": 40623752, "link": "https://stackoverflow.com/questions/40623752/add-or-insert-to-array-inside-a-hash/40623856#40623856", "title": "add or insert to array inside a hash", "body": "<pre><code>if data.key?('checks')\n  data['checks'] &lt;&lt; DateTime.now\nelse \n  data['checks'] = [DateTime.now]\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4538, "user_id": 809830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdd9801d2717096282258b192edc7793?s=128&d=identicon&r=PG", "display_name": "Alex Kojin", "link": "https://stackoverflow.com/users/809830/alex-kojin"}, "is_accepted": false, "score": 0, "last_activity_date": 1479269388, "last_edit_date": 1479269388, "creation_date": 1479269016, "answer_id": 40623877, "question_id": 40623752, "link": "https://stackoverflow.com/questions/40623752/add-or-insert-to-array-inside-a-hash/40623877#40623877", "title": "add or insert to array inside a hash", "body": "<pre><code>data['checks']= Array.wrap(data['checks']) &lt;&lt; DateTime.now\n</code></pre>\n\n<p>But think more elegant way is this:</p>\n\n<pre><code>data['checks']= Array.wrap(data['checks']) + [DateTime.now]\n</code></pre>\n\n<p><code>Array.wrap</code> return a blank array or existing array. Plus operator will merge two arrays and assign new array to <code>data['checks']</code></p>\n"}, {"comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1479270097, "post_id": 40623887, "comment_id": 68481756, "body": "Wow this is neat."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1479277445, "post_id": 40623887, "comment_id": 68484204, "body": "If for some reason one wants to abuse splat operator, it still might be done in more readable way: <code>data[&#39;checks&#39;] = [*data[&#39;checks&#39;], DateTime.now]</code>"}], "tags": [], "owner": {"reputation": 516, "user_id": 3295407, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/WqEep.png?s=128&g=1", "display_name": "etdev", "link": "https://stackoverflow.com/users/3295407/etdev"}, "is_accepted": false, "score": 1, "last_activity_date": 1479283345, "last_edit_date": 1479283345, "creation_date": 1479269102, "answer_id": 40623887, "question_id": 40623752, "link": "https://stackoverflow.com/questions/40623752/add-or-insert-to-array-inside-a-hash/40623887#40623887", "title": "add or insert to array inside a hash", "body": "<p>I'm not sure if it's elegant or not, but you could do:</p>\n\n<pre><code>data['checks'] = [*data['checks']] &lt;&lt; DateTime.now\n</code></pre>\n\n<p>Basically if data['checks'] is <code>nil</code> the splat reduces it to <code>[]</code> but if it has entries it reduces to an array with those same entries.</p>\n\n<p><strong>EDIT</strong> Here's another option no one else has mentioned:</p>\n\n<pre><code>data['checks'] = (data['checks'] || []) &lt;&lt; DateTime.now\n</code></pre>\n\n<p><strong>EDIT2</strong> Without using the (potentially confusing) splat operator:</p>\n\n<pre><code>data['checks'] = Array(data['checks']) &lt;&lt; DateTime.now\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3367, "user_id": 822256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ITN7.png?s=128&g=1", "display_name": "sa77", "link": "https://stackoverflow.com/users/822256/sa77"}, "is_accepted": false, "score": 0, "last_activity_date": 1479269881, "creation_date": 1479269881, "answer_id": 40624006, "question_id": 40623752, "link": "https://stackoverflow.com/questions/40623752/add-or-insert-to-array-inside-a-hash/40624006#40624006", "title": "add or insert to array inside a hash", "body": "<pre><code>if data[:checks]\n  data[:checks] &lt;&lt; DateTime.now\nelse\n  data[:checks] = [DateTime.now]\nend\n</code></pre>\n\n<p>one liner</p>\n\n<pre><code>data[:checks] ? data[:checks] &lt;&lt; DateTime.now : data[:checks] = [DateTime.now]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1738, "user_id": 3353322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13ac896746c0573667cd0190c621b53d?s=128&d=identicon&r=PG", "display_name": "Jack Noble", "link": "https://stackoverflow.com/users/3353322/jack-noble"}, "is_accepted": false, "score": 2, "last_activity_date": 1479271043, "creation_date": 1479271043, "answer_id": 40624172, "question_id": 40623752, "link": "https://stackoverflow.com/questions/40623752/add-or-insert-to-array-inside-a-hash/40624172#40624172", "title": "add or insert to array inside a hash", "body": "<pre><code>data['checks'] = data.fetch('checks', []) &lt;&lt; DateTime.now\n</code></pre>\n\n<p>Hash#fetch takes a key and a value to return if the key is missing. Perhaps a little more elegant than splatting into an array literal.</p>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1479275604, "post_id": 40624284, "comment_id": 68483482, "body": "You could also combine the first two lines: <code>(data[&#39;checks&#39;] ||= []) &lt;&lt; DateTime.now</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1479277278, "post_id": 40624284, "comment_id": 68484123, "body": "It worth to mention that <a href=\"https://ruby-doc.org/core-2.3.2/Hash.html#method-i-default_proc-3D\" rel=\"nofollow noreferrer\"><code>Hash#default_proc=</code></a> might be set at any time, even if one has a hash that came from outside."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1479279287, "post_id": 40624284, "comment_id": 68484956, "body": "@Stefan I was trying to keep it as uncomplicated as possible, but that&#39;s the convention I actually use."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 4, "last_activity_date": 1479271806, "creation_date": 1479271806, "answer_id": 40624284, "question_id": 40623752, "link": "https://stackoverflow.com/questions/40623752/add-or-insert-to-array-inside-a-hash/40624284#40624284", "title": "add or insert to array inside a hash", "body": "<p>Normally I'd attack it like this:</p>\n\n<pre><code>checks = data['checks'] ||= [ ]\nchecks &lt;&lt; DateTime.now\n</code></pre>\n\n<p>If your <code>data</code> hash will only ever have array-like values, do this:</p>\n\n<pre><code>data = Hash.new { |h,k| h[k] = [ ] }\n</code></pre>\n\n<p>Then you don't need to bother with the <code>||=</code> thing since assignment will happen automatically.</p>\n"}], "owner": {"reputation": 12011, "user_id": 600953, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee3d3a87e3451113e4d56067a22d4c41?s=128&d=identicon&r=PG", "display_name": "Dty", "link": "https://stackoverflow.com/users/600953/dty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1947, "favorite_count": 0, "accepted_answer_id": 40624284, "answer_count": 6, "score": 0, "last_activity_date": 1479283345, "creation_date": 1479268234, "question_id": 40623752, "link": "https://stackoverflow.com/questions/40623752/add-or-insert-to-array-inside-a-hash", "title": "add or insert to array inside a hash", "body": "<p>I have hash named <code>data</code> with a key named <code>checks</code> which is an array of dates. If the key exists I want to append to the existing array. If the key does not exist I need to add an array with the current date. <strong>Is there an elegant way to do this in ruby?</strong></p>\n\n<p>This is how I'm doing it right now which seems harder than it should be:</p>\n\n<pre><code>if data.has_key?('checks')\n  data['checks'] &lt;&lt; DateTime.now\nelse\n  data['checks'] = Array.wrap(DateTime.now)\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "answers": [{"tags": [], "owner": {"reputation": 1121, "user_id": 4451733, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/9c64bf16791f14a6f7f2b880b938978d?s=128&d=identicon&r=PG&f=1", "display_name": "Crashtor", "link": "https://stackoverflow.com/users/4451733/crashtor"}, "is_accepted": false, "score": 0, "last_activity_date": 1479258592, "creation_date": 1479258592, "answer_id": 40622463, "question_id": 40622335, "link": "https://stackoverflow.com/questions/40622335/ruby-on-rails-devise-is-not-permitting-all-fields/40622463#40622463", "title": "Ruby on rails devise is not permitting all fields", "body": "<p>There are a few things you could try:</p>\n\n<p>First do a bang class permitting all variables to be entered in the form and see if last_name gets saved. by declaring .permit! and removing <code>(:email, :password, :password_confirmation, etc...)</code></p>\n\n<p>If last_name gets saved when banging that class - You should see if entering the correct classes in the form_for tag helps you. </p>\n\n<pre><code>&lt;%= form_for(user, as: user, url: registration_path(user)) do |f| %&gt;\n</code></pre>\n\n<p>If not, look in your db/schema file and see if you accidently migrated last_name as something other than a string.</p>\n"}, {"tags": [], "owner": {"reputation": 901, "user_id": 3872380, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/wy14q.jpg?s=128&g=1", "display_name": "Mukesh", "link": "https://stackoverflow.com/users/3872380/mukesh"}, "is_accepted": false, "score": 1, "last_activity_date": 1479258651, "creation_date": 1479258651, "answer_id": 40622470, "question_id": 40622335, "link": "https://stackoverflow.com/questions/40622335/ruby-on-rails-devise-is-not-permitting-all-fields/40622470#40622470", "title": "Ruby on rails devise is not permitting all fields", "body": "<p>Check Following Code, it will help you</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  before_action :configure_permitted_parameters, if: :devise_controller?\n\n  protected\n\n  def configure_permitted_parameters\n      devise_parameter_sanitizer.permit(:sign_up) do |user_params|\n            user_params.permit({ roles: [] }, :email, :password, :password_confirmation)\n      end\n  end\nend  \n</code></pre>\n\n<p>And for extra help read <a href=\"https://github.com/plataformatec/devise\" rel=\"nofollow noreferrer\">Devise</a> Strong Parameters topic.</p>\n"}], "owner": {"reputation": 27, "user_id": 7102850, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7cb689a8acfcc3b9ba3f7f1fcffb7f39?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/7102850/john-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1479258651, "creation_date": 1479257774, "question_id": 40622335, "link": "https://stackoverflow.com/questions/40622335/ruby-on-rails-devise-is-not-permitting-all-fields", "title": "Ruby on rails devise is not permitting all fields", "body": "<p>In ruby on rails i use devise for authentication and add the first and last name fields to the database. The new view looks like </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;%= form_for(resource, as: resource_name, url: registration_path(resource_name)) do |f| %&gt;\r\n  &lt;%= devise_error_messages! %&gt;\r\n\r\n    &lt;div class=\"field\"&gt;\r\n      &lt;%= f.label :first_name %&gt;&lt;br /&gt;\r\n      &lt;%= f.text_field :first_name, autofocus: true %&gt;\r\n    &lt;/div&gt;\r\n\r\n    &lt;div class=\"field\"&gt;\r\n      &lt;%= f.label :last_name %&gt;&lt;br /&gt;\r\n      &lt;%= f.text_field :last_name, autofocus: true %&gt;\r\n    &lt;/div&gt;\r\n\r\n  &lt;div class=\"field\"&gt;\r\n    &lt;%= f.label :email %&gt;&lt;br /&gt;\r\n    &lt;%= f.email_field :email, autofocus: true %&gt;\r\n  &lt;/div&gt;\r\n\r\n  &lt;div class=\"field\"&gt;\r\n    &lt;%= f.label :password %&gt;\r\n    &lt;% if @minimum_password_length %&gt;\r\n    &lt;em&gt;(&lt;%= @minimum_password_length %&gt; characters minimum)&lt;/em&gt;\r\n    &lt;% end %&gt;&lt;br /&gt;\r\n    &lt;%= f.password_field :password, autocomplete: \"off\" %&gt;\r\n  &lt;/div&gt;\r\n\r\n  &lt;div class=\"field\"&gt;\r\n    &lt;%= f.label :password_confirmation %&gt;&lt;br /&gt;\r\n    &lt;%= f.password_field :password_confirmation, autocomplete: \"off\" %&gt;\r\n  &lt;/div&gt;\r\n\r\n  &lt;div class=\"actions\"&gt;\r\n    &lt;%= f.submit \"Sign up\" %&gt;\r\n  &lt;/div&gt;\r\n&lt;% end %&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>The controller looks like this</p>\n\n<pre><code>  private\n\n  def sign_up_params\n     params.require(:user).permit(:email, :password, :password_confirmation,:first_name, :last_name)\n  end\n\n  def account_update_params\n    params.require(:user).permit(:first_name, :last_name, :email, :password, :password_confirmation, :current_password)\n  end\n</code></pre>\n\n<p>When creating the account I get a successful request but I am when I look at the database only the first name attribute show up and not the last name attribute. Form the sql queries generated only the first name attribute gets inserted into the sql statement.</p>\n"}, {"tags": ["ruby", "algorithm"], "comments": [{"owner": {"reputation": 858, "user_id": 1875195, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/3ed18248b30a2d90cf49ea9393097425?s=128&d=identicon&r=PG", "display_name": "user1875195", "link": "https://stackoverflow.com/users/1875195/user1875195"}, "edited": false, "score": 7, "creation_date": 1479252828, "post_id": 40621542, "comment_id": 68477240, "body": "You&#39;re issue is <code>pos++</code> ruby doesn&#39;t have that operator like the C type languages do. Try changing that to <code>pos += 1</code>"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1479254216, "post_id": 40621542, "comment_id": 68477705, "body": "&quot; it ain&#39;t pretty&quot;. Aside from the error, your code looks good to me."}, {"owner": {"reputation": 440, "user_id": 7163931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d0105e5b1bea003fb7caddde54ad61a?s=128&d=identicon&r=PG&f=1", "display_name": "wnamen", "link": "https://stackoverflow.com/users/7163931/wnamen"}, "edited": false, "score": 0, "creation_date": 1479312516, "post_id": 40621542, "comment_id": 68505892, "body": "Thank you both! The operator was the issue. it works great now!"}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1479256273, "post_id": 40621974, "comment_id": 68478327, "body": "Clever to recognize that you can partition on <code>positive?</code> but not on <code>negative?</code>."}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1479256420, "post_id": 40621974, "comment_id": 68478362, "body": "@CarySwoveland I&#39;m missing the significance?  wouldn&#39;t it work with <code>negatives, positives = list.partition(&amp;:negative?)</code>"}, {"owner": {"reputation": 1548, "user_id": 1246279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2533d5a4299cad329268e552c47fa8d?s=128&d=identicon&r=PG", "display_name": "philomory", "link": "https://stackoverflow.com/users/1246279/philomory"}, "reply_to_user": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 3, "creation_date": 1479256902, "post_id": 40621974, "comment_id": 68478483, "body": "@SteveTurczyn If you partition on <code>negative?</code>, then 0 gets grouped with the positives (effectively non-negatives), whereas if you partition on <code>positive?</code> then 0 is grouped with the negatives (effectively, non-positives). Technically, 0 should not be included in <i>either</i> grouping, but with the negatives you&#39;re calculating a sum, and 0 will have no impact. For the positives, you&#39;re calculating a count, and if you include 0s in your count you&#39;ll have the wrong answer."}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1479257066, "post_id": 40621974, "comment_id": 68478524, "body": "Ah, yes, so 0 doesn&#39;t respond to <code>positive?</code> or <code>negative?</code> ... wait ... wait...  just tried it and confused myself... where is <code>#positive?</code> defined?  It&#39;s not a fixnum method... nor is <code>#negative?</code> ??"}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1479257143, "post_id": 40621974, "comment_id": 68478541, "body": "@CarySwoveland ^ ?"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1479257330, "post_id": 40621974, "comment_id": 68478583, "body": "<code>Numeric#positive?</code>"}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1479257653, "post_id": 40621974, "comment_id": 68478675, "body": "Well it doesn&#39;t work with the test data.  @sagarpandya82"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 2, "creation_date": 1479258096, "post_id": 40621974, "comment_id": 68478807, "body": "0 does respond to <code>positive?</code> and <code>negative?</code>, it returns <code>false</code> in both cases which means when used with <code>partition</code> 0 always gets lumped in the not-satisfied-array."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 2, "creation_date": 1479258161, "post_id": 40621974, "comment_id": 68478827, "body": "@SteveTurczyn, remember you can use <code>1.method(:negative?).owner  =&gt; Numeric</code>. Actually, <code>4168.method(:negative?) #=&gt; #&lt;Method: Fixnum(Numeric)#negative?&gt;</code> is enough, as the owner is shown in parentheses (as here) when it&#39;s not defined in the receiver&#39;s class."}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1479258724, "post_id": 40621974, "comment_id": 68478957, "body": "@CarySwoveland clever!"}, {"owner": {"reputation": 440, "user_id": 7163931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d0105e5b1bea003fb7caddde54ad61a?s=128&d=identicon&r=PG&f=1", "display_name": "wnamen", "link": "https://stackoverflow.com/users/7163931/wnamen"}, "edited": false, "score": 0, "creation_date": 1479312604, "post_id": 40621974, "comment_id": 68505965, "body": "@tadman, thanks for your help. I fixed the operator and it works great now! Also, thanks for sharing partition. That is something I will try and use moving forward"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 440, "user_id": 7163931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d0105e5b1bea003fb7caddde54ad61a?s=128&d=identicon&r=PG&f=1", "display_name": "wnamen", "link": "https://stackoverflow.com/users/7163931/wnamen"}, "edited": false, "score": 0, "creation_date": 1479323903, "post_id": 40621974, "comment_id": 68513024, "body": "@wnamen The Enumerable library is full of neat tools like that, so do take a little time now and then to at least browse what options you have. There&#39;s a method for nearly every occasion and it saves you a lot of trouble in the long-run if you know how they work."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 7, "last_activity_date": 1479255174, "creation_date": 1479255174, "answer_id": 40621974, "question_id": 40621542, "link": "https://stackoverflow.com/questions/40621542/count-of-positives-sum-of-negatives-syntax-error/40621974#40621974", "title": "Count of positives / sum of negatives Syntax Error", "body": "<p>As people have pointed out the error here is <code>x++</code> is not valid Ruby, that you need <code>x +=1</code> instead. The postfix and prefix increment operator is a point of wild confusion in most languages so Ruby has never implemented one. As in, what is the result of <code>x++ + x++ + ++x</code>?</p>\n\n<p>Here's a strategy that's different using <a href=\"https://ruby-doc.org/core-2.3.1/Enumerable.html#method-i-partition\" rel=\"nofollow noreferrer\"><code>partition</code></a> to first split the array, then collapse that together using <code>inject</code>:</p>\n\n<pre><code>positives, negatives = list.partition(&amp;:positive?)\n\n[ positives.length, negatives.inject(0, &amp;:+) ]\n# =&gt; [10,-65]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": false, "score": 2, "last_activity_date": 1479255643, "creation_date": 1479255643, "answer_id": 40622051, "question_id": 40621542, "link": "https://stackoverflow.com/questions/40621542/count-of-positives-sum-of-negatives-syntax-error/40622051#40622051", "title": "Count of positives / sum of negatives Syntax Error", "body": "<p>THe problem is <code>pos++</code> which is not a valid operation in Ruby.  It's being interpreted as an addition followed by a unary <code>+</code> but there's no number after the unary so it's expecting the next line to contain a value.</p>\n\n<p>But the next line is <code>end</code> which is unexpected (hence the first error <code>unexpected keyword_end</code>) and because the <code>end</code> is now consumed you are missing an end for the method (hence the second error <code>expecting keyword_end</code></p>\n\n<p>So just change the line to...</p>\n\n<pre><code>pos += 1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1479256534, "post_id": 40622107, "comment_id": 68478392, "body": "Nice, but to nitpick, this answer (and tadman&#39;s) is overlooking <code>If the input array is empty or null, return an empty array</code>.  Of course, the OP&#39;s solution has the same problem."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1479256810, "post_id": 40622107, "comment_id": 68478457, "body": "Taking a page from @Tadman, the antepenultimate line and the one before could be replaced by <code>n&gt;0 ? h[:count_pos] += 1 : h[:sum_neg] += n</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1479257564, "post_id": 40622107, "comment_id": 68478647, "body": "@SteveTurczyn, thanks for pointing that out. I edited. Is &quot;null&quot; different than &quot;empty&quot;."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 4, "last_activity_date": 1479257525, "last_edit_date": 1479257525, "creation_date": 1479255989, "answer_id": 40622107, "question_id": 40621542, "link": "https://stackoverflow.com/questions/40621542/count-of-positives-sum-of-negatives-syntax-error/40622107#40622107", "title": "Count of positives / sum of negatives Syntax Error", "body": "<p>Here is another way you could do that.</p>\n\n<pre><code>def count_pos_sum_neg(arr)\n  return [] if arr.empty?\n  arr.each_with_object([0,0]) do |n,a|\n    a[0] += 1 if n &gt; 0\n    a[1] += n if n &lt; 0\n  end\nend\n\ncount_pos_sum_neg [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, -11, -12, -13, -14, -15]\n  #=&gt; [10, -65]\n</code></pre>\n\n<p>In actual application, returning a hash may be more convenient.</p>\n\n<pre><code>def count_pos_sum_neg(arr)\n  return [] if arr.empty?\n  arr.each_with_object({count_pos: 0, sum_neg: 0}) do |n,h|\n    h[:count_pos] += 1 if n &gt; 0\n    h[:sum_neg]   += n if n &lt; 0\n  end\nend\n\ncount_pos_sum_neg [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, -11, -12, -13, -14, -15]\n  #=&gt; {:count_pos=&gt;10, :sum_neg=&gt;-65} \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 1, "last_activity_date": 1479283079, "creation_date": 1479283079, "answer_id": 40626759, "question_id": 40621542, "link": "https://stackoverflow.com/questions/40621542/count-of-positives-sum-of-negatives-syntax-error/40626759#40626759", "title": "Count of positives / sum of negatives Syntax Error", "body": "<p>Yet another variant using <a href=\"http://ruby-doc.org/core-2.3.1/Enumerable.html#method-i-inject\" rel=\"nofollow noreferrer\"><code>inject</code></a>:</p>\n\n<pre><code>def count_pos_sum_neg(arr)\n  arr.inject([0, 0]) do |(count, sum), n|\n    if n &gt; 0\n      [count + 1, sum]\n    else\n      [count, sum + n]\n    end\n  end\nend\n</code></pre>\n\n<p>Or compressed:</p>\n\n<pre><code>def count_pos_sum_neg(arr)\n  arr.inject([0, 0]) { |(c, s), n| n &gt; 0 ? [c + 1, s] : [c, s + n] }\nend\n</code></pre>\n\n<p>The code doesn't check \"If the input array is empty or null\".</p>\n"}, {"comments": [{"owner": {"reputation": 440, "user_id": 7163931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d0105e5b1bea003fb7caddde54ad61a?s=128&d=identicon&r=PG&f=1", "display_name": "wnamen", "link": "https://stackoverflow.com/users/7163931/wnamen"}, "edited": false, "score": 0, "creation_date": 1480127168, "post_id": 40638602, "comment_id": 68848883, "body": "Wow! I didn&#39;t realize that! Thanks for sharing this information."}], "tags": [], "owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "is_accepted": false, "score": 0, "last_activity_date": 1479317595, "creation_date": 1479317595, "answer_id": 40638602, "question_id": 40621542, "link": "https://stackoverflow.com/questions/40621542/count-of-positives-sum-of-negatives-syntax-error/40638602#40638602", "title": "Count of positives / sum of negatives Syntax Error", "body": "<p>As I suspected your initial approach which is easy to read and simple, is actually fast too. Some results from a <a href=\"https://github.com/marcandre/fruity\" rel=\"nofollow noreferrer\">fruity</a> comparison (code compacted):</p>\n\n<pre><code>require 'fruity'\n\narr = ((-1000..-1).to_a + (1..1000).to_a).shuffle\n\n#various methods etc as defined in other answers.\n\ncompare do\n  wnamen  { ar = arr; wnamen_method ar  }\n  tadman  { ar = arr; tadman_method ar  }\n  cary    { ar = arr; cary_method ar    }\n  cary2   { ar = arr; cary2_method ar   }\n  stefan  { ar = arr; stefan_method ar  }\n  stefan2 { ar = arr; stefan2_method ar }\nend\n</code></pre>\n\n<p>results:</p>\n\n<pre><code>Running each test 8 times. Test will take about 1 second.\nwnamen is faster than tadman by 2.0x \u00b1 0.1\ntadman is similar to stefan2\nstefan2 is similar to stefan\nstefan is similar to cary\ncary is faster than cary2 by 19.999999999999996% \u00b1 10.0% (results differ: [1000, -500500] vs {:count_pos=&gt;1000, :sum_neg=&gt;-500500})\n</code></pre>\n\n<p>All the other approaches are of course interesting and worth knowing nonetheless.</p>\n"}], "owner": {"reputation": 440, "user_id": 7163931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d0105e5b1bea003fb7caddde54ad61a?s=128&d=identicon&r=PG&f=1", "display_name": "wnamen", "link": "https://stackoverflow.com/users/7163931/wnamen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 937, "favorite_count": 0, "answer_count": 5, "score": 0, "last_activity_date": 1479317595, "creation_date": 1479252492, "question_id": 40621542, "link": "https://stackoverflow.com/questions/40621542/count-of-positives-sum-of-negatives-syntax-error", "title": "Count of positives / sum of negatives Syntax Error", "body": "<p>So I am currently working on the following problem in code wars:</p>\n\n<p>Return an array, where the first element is the count of positive numbers and the second element is sum of negative numbers. If the input array is empty or null, return an empty array.</p>\n\n<p>I came up with the following code, it ain't pretty, but I know it should work:</p>\n\n<pre><code>def count_positives_sum_negatives(lst)\n  pos, neg = 0, 0\n\n  lst.each do |num|\n    if num &lt; 0\n      neg += num\n    else\n      pos++\n    end\n  end\n\n  [pos, neg]\nend\n</code></pre>\n\n<p>I then call the following test:</p>\n\n<pre><code>count_positives_sum_negatives([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, -11, -12, -13, -14, -15])\n</code></pre>\n\n<p>and it should return => [10,-65]</p>\n\n<p>However its returning the following error:</p>\n\n<pre><code>(repl):11: syntax error, unexpected keyword_end\n(repl):17: syntax error, unexpected end-of-input, expecting keyword_end\n..., 10, -11, -12, -13, -14, -15])\n...       \n</code></pre>\n\n<p>Can anyone give me an explanation of why this is occurring?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "macos"], "answers": [{"tags": [], "owner": {"reputation": 2736, "user_id": 592229, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d23e0616c0b2862d2226ea0792c920cc?s=128&d=identicon&r=PG", "display_name": "ezuk", "link": "https://stackoverflow.com/users/592229/ezuk"}, "is_accepted": true, "score": 1, "last_activity_date": 1479257528, "creation_date": 1479257528, "answer_id": 40622307, "question_id": 40621467, "link": "https://stackoverflow.com/questions/40621467/why-does-my-rake-abort/40622307#40622307", "title": "Why does my rake abort?", "body": "<p>Well, the surface answer is because Ruby can't find <code>google/api_client</code>. ;) But obviously that's not super helpful.</p>\n\n<p>First, try putting in place a couple of best practices: </p>\n\n<ul>\n<li>Install <a href=\"https://rvm.io\" rel=\"nofollow noreferrer\">RVM</a>, </li>\n<li>Create and use a gemset for your project (<code>rvm use 2.0.0@my-awesome-project --create</code>). </li>\n<li>Run <code>bundle install</code>. </li>\n<li>Then try the rake task again. What happens now?</li>\n</ul>\n\n<p>(those best practices are RVM + gemsets)</p>\n"}], "owner": {"reputation": 2747, "user_id": 3521420, "user_type": "registered", "profile_image": "https://graph.facebook.com/1054781629/picture?type=large", "display_name": "Jonathan Allen Grant", "link": "https://stackoverflow.com/users/3521420/jonathan-allen-grant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 40622307, "answer_count": 1, "score": 0, "last_activity_date": 1479257528, "creation_date": 1479252016, "question_id": 40621467, "link": "https://stackoverflow.com/questions/40621467/why-does-my-rake-abort", "title": "Why does my rake abort?", "body": "<p>I get the following stack when I run <code>rake rails:update:bin</code></p>\n\n<pre><code>rake aborted!\nLoadError: cannot load such file -- google/api_client\n/Users/jonathangrant/.rvm/gems/ruby-2.0.0-p648/gems/bundler-1.13.6/lib/bundler/runtime.rb:91:in `require'\n/Users/jonathangrant/.rvm/gems/ruby-2.0.0-p648/gems/bundler-1.13.6/lib/bundler/runtime.rb:91:in `block (2 levels) in require'\n/Users/jonathangrant/.rvm/gems/ruby-2.0.0-p648/gems/bundler-1.13.6/lib/bundler/runtime.rb:86:in `each'\n/Users/jonathangrant/.rvm/gems/ruby-2.0.0-p648/gems/bundler-1.13.6/lib/bundler/runtime.rb:86:in `block in require'\n/Users/jonathangrant/.rvm/gems/ruby-2.0.0-p648/gems/bundler-1.13.6/lib/bundler/runtime.rb:75:in `each'\n/Users/jonathangrant/.rvm/gems/ruby-2.0.0-p648/gems/bundler-1.13.6/lib/bundler/runtime.rb:75:in `require'\n/Users/jonathangrant/.rvm/gems/ruby-2.0.0-p648/gems/bundler-1.13.6/lib/bundler.rb:106:in `require'\n/Users/jonathangrant/omnivirt/adsoptimal-upload/config/application.rb:7:in `&lt;top (required)&gt;'\n/Users/jonathangrant/omnivirt/adsoptimal-upload/Rakefile:4:in `require'\n/Users/jonathangrant/omnivirt/adsoptimal-upload/Rakefile:4:in `&lt;top (required)&gt;'\n/Users/jonathangrant/.rvm/gems/ruby-2.0.0-p648/gems/rake-11.3.0/lib/rake/rake_module.rb:28:in `load'\n/Users/jonathangrant/.rvm/gems/ruby-2.0.0-p648/gems/rake-11.3.0/lib/rake/rake_module.rb:28:in `load_rakefile'\n/Users/jonathangrant/.rvm/gems/ruby-2.0.0-p648/gems/rake-11.3.0/lib/rake/application.rb:686:in `raw_load_rakefile'\n/Users/jonathangrant/.rvm/gems/ruby-2.0.0-p648/gems/rake-11.3.0/lib/rake/application.rb:96:in `block in load_rakefile'\n/Users/jonathangrant/.rvm/gems/ruby-2.0.0-p648/gems/rake-11.3.0/lib/rake/application.rb:178:in `standard_exception_handling'\n/Users/jonathangrant/.rvm/gems/ruby-2.0.0-p648/gems/rake-11.3.0/lib/rake/application.rb:95:in `load_rakefile'\n/Users/jonathangrant/.rvm/gems/ruby-2.0.0-p648/gems/rake-11.3.0/lib/rake/application.rb:79:in `block in run'\n/Users/jonathangrant/.rvm/gems/ruby-2.0.0-p648/gems/rake-11.3.0/lib/rake/application.rb:178:in `standard_exception_handling'\n/Users/jonathangrant/.rvm/gems/ruby-2.0.0-p648/gems/rake-11.3.0/lib/rake/application.rb:77:in `run'\n/Users/jonathangrant/.rvm/gems/ruby-2.0.0-p648/gems/rake-11.3.0/exe/rake:27:in `&lt;top (required)&gt;'\n/Users/jonathangrant/.rvm/gems/ruby-2.0.0-p648/bin/rake:23:in `load'\n/Users/jonathangrant/.rvm/gems/ruby-2.0.0-p648/bin/rake:23:in `&lt;main&gt;'\n/Users/jonathangrant/.rvm/gems/ruby-2.0.0-p648/bin/ruby_executable_hooks:15:in `eval'\n/Users/jonathangrant/.rvm/gems/ruby-2.0.0-p648/bin/ruby_executable_hooks:15:in `&lt;main&gt;'\n</code></pre>\n\n<p>Why am I getting this issue?</p>\n\n<p>I am using Ruby 2.0.0 and Rails 4.1.5 on my OSX 10.11.16 Mac.</p>\n"}, {"tags": ["ruby", "cucumber", "watir-webdriver"], "answers": [{"tags": [], "owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "is_accepted": true, "score": 1, "last_activity_date": 1479258048, "last_edit_date": 1479258048, "creation_date": 1479255325, "answer_id": 40622003, "question_id": 40621343, "link": "https://stackoverflow.com/questions/40621343/how-to-add-date-as-a-variable-field-in-my-code-to-print-in-a-text-field-ruby/40622003#40622003", "title": "How to add Date as a variable field in my code to print in a text field (Ruby)", "body": "<p>You need to <a href=\"https://en.wikipedia.org/wiki/String_interpolation#Ruby\" rel=\"nofollow noreferrer\">interpolate</a> the <code>Time.now.strftime</code> method so that the code is executed within the string. </p>\n\n<p>In ruby, this is commonly done by placing the code to-be-executed in curly braces that are preceeded by an octothorpe in a double-quoted string.   For example:</p>\n\n<pre><code>require 'watir-webdriver'\n\nb = Watir::Browser.new :chrome\nb.goto \"google.com\"\nb.text_field(:name =&gt; 'q').set(\"example of string interpolation: #{Time.now.strftime('%d/%m/%Y %H:%M')}\")\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7164646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10ffa0b6e9f291f5077e9330e05ee068?s=128&d=identicon&r=PG&f=1", "display_name": "SChen", "link": "https://stackoverflow.com/users/7164646/schen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 40622003, "answer_count": 1, "score": 0, "last_activity_date": 1479258048, "creation_date": 1479251343, "question_id": 40621343, "link": "https://stackoverflow.com/questions/40621343/how-to-add-date-as-a-variable-field-in-my-code-to-print-in-a-text-field-ruby", "title": "How to add Date as a variable field in my code to print in a text field (Ruby)", "body": "<p>I am writing a quick automation script using Ruby, Cucumber, Watir-webdriver etc. I am creating an ad campaign and want the title of the campaign (a text field I can enter anything into) to contain whatever today's datetime is. Currently my code looks like:</p>\n\n<pre>\nWhen(/^I enter \"([^\"]*)\" into the campaign name field$/) do |arg1|\n  @browser.textarea(:id => 'campaign_name').set('SBTC - Regression - Campaign Create-' Time.now.strftime(\"%d/%m/%Y %H:%M\")) \nend\n</pre>\n\n<p>Obviously that's not correct and I haven't seen anything on the forum on how to do it. End result is that when the automation finishes I have a new ad campaign title \"SBTC - Regression - Campaign Create - [TodayDateTime]\"</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 1738, "user_id": 3353322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13ac896746c0573667cd0190c621b53d?s=128&d=identicon&r=PG", "display_name": "Jack Noble", "link": "https://stackoverflow.com/users/3353322/jack-noble"}, "edited": false, "score": 0, "creation_date": 1479271617, "post_id": 40621302, "comment_id": 68482218, "body": "This sounds like a problem with a single worker not picking up code changes (perhaps not restarting when it should) -- not a problem with anything in the code. Are you running multiple workers and can you see how long they&#39;ve been running? Have you tried restarting them?"}, {"owner": {"reputation": 1710, "user_id": 1007211, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4505653dfffc02d45bc27a639bbd592a?s=128&d=identicon&r=PG", "display_name": "George Shaw", "link": "https://stackoverflow.com/users/1007211/george-shaw"}, "reply_to_user": {"reputation": 1738, "user_id": 3353322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13ac896746c0573667cd0190c621b53d?s=128&d=identicon&r=PG", "display_name": "Jack Noble", "link": "https://stackoverflow.com/users/3353322/jack-noble"}, "edited": false, "score": 0, "creation_date": 1479272681, "post_id": 40621302, "comment_id": 68482530, "body": "Heroku restarts once a day and on every deploy."}], "owner": {"reputation": 1710, "user_id": 1007211, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4505653dfffc02d45bc27a639bbd592a?s=128&d=identicon&r=PG", "display_name": "George Shaw", "link": "https://stackoverflow.com/users/1007211/george-shaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479251134, "creation_date": 1479251134, "question_id": 40621302, "link": "https://stackoverflow.com/questions/40621302/ruby-worker-fails-randomly-with-nomethoderror", "title": "Ruby worker fails randomly with NoMethodError", "body": "<p>We use Amazon PubSub for messaging between Rails services and this runs as a worker on Heroku alongside the associated service. Right now the code is polling for PubSub messages and the causes the processing of a message to occur. I'm seeing a 1-3% error rate where the code throws a NoMethodError when accessing an instance method a model in three different instances. I'll show one here.</p>\n\n<p>First the model:</p>\n\n<pre><code>class Store &lt; ActiveRecord::Base\n  belongs_to :deal, touch: true\n  belongs_to :retailer\n  ...\nend\n</code></pre>\n\n<p>Then the failing code:</p>\n\n<pre><code>def location_update(stores, new_locations)\n  stores.each do |store|\n    deal_id = store.deal ? store.deal.id.to_s : \"(no deal exists)\"\n    ...\n  end\nend\n</code></pre>\n\n<p>The error is:</p>\n\n<p>Nov 7 18:25:56 d.db858851-921e-4233-ae7c-8d3f8e03bca1 app[worker.1] undefined method 'deal' for #&lt; Store:0x007ffb78435000></p>\n\n<p>It is failing on <code>store.deal</code>. Clearly, this is a Store object and deal exists on Store, as can be seen in the model and by the fractional failure rate (97-99% succeed and all execute this code).</p>\n\n<p>It is behaving as if the Store class is not loaded. Does the code need to do something to ensure the class is loaded? If so, why does it only fail 1-3% of the time?</p>\n\n<p>(Ruby 2.3.1, Rails 4.2.7)</p>\n"}, {"tags": ["ruby", "capybara"], "answers": [{"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": false, "score": 0, "last_activity_date": 1479252144, "creation_date": 1479252144, "answer_id": 40621494, "question_id": 40621208, "link": "https://stackoverflow.com/questions/40621208/block-takes-2-arguments-but-the-regexp-matched-1-argument/40621494#40621494", "title": "block takes 2 arguments, but the Regexp matched 1 argument", "body": "<p>You're not calling steps that take data tables correctly inside your other steps - see the cucumber wiki - <a href=\"https://github.com/cucumber/cucumber/wiki/Calling-Steps-from-Step-Definitions#calling-steps-with-multiline-step-arguments\" rel=\"nofollow noreferrer\">https://github.com/cucumber/cucumber/wiki/Calling-Steps-from-Step-Definitions#calling-steps-with-multiline-step-arguments</a></p>\n\n<p>Following that your first step becomes something like</p>\n\n<pre><code>When(/^I make my person a user with role of \"([^\"]*)\" in Peak$/) do |role|\n  step \"I make my person a user in Peak\", table([\n    [ \"user_role\", role]\n  ])\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7004614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a9fc65e8d74191678091ae45ab7a78d?s=128&d=identicon&r=PG", "display_name": "Doug M", "link": "https://stackoverflow.com/users/7004614/doug-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1433, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479252144, "creation_date": 1479250578, "question_id": 40621208, "link": "https://stackoverflow.com/questions/40621208/block-takes-2-arguments-but-the-regexp-matched-1-argument", "title": "block takes 2 arguments, but the Regexp matched 1 argument", "body": "<p>What is the issue here? Trying to merge a previous author's code  (use of my) with the step definition down below.  I get the following error when the first step % is called in the first step definition.  Is this error saying the receiving step definition is expecting two arguments, the table and @name which is set elsewhere and I am only calling it with the table user_role value?\n  # FAILS WITH: Your block takes 2 arguments, but the Regexp matched 1 argument.</p>\n\n<pre><code>Then I make my person a user with role of \"Peak Admin\" in Peak\n\nWhen(/^I make my person a user with role of \"([^\"]*)\" in Peak$/) do |role|\n  step %{I make my person a user in Peak\n   | user_role | role | }\nend\n\nThen(/^I make my person a user in Peak$/) do |table|\n  step %{I make the person \"#{@name}\" a user in Peak\n    | user_role | table.rows_hash[:user_role] |}\nend\n\nWhen(/I make the person \"([^\"]*)\" a user in Peak$/) do |person,table|\n  ....\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 3400045, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fdbbce5c6df20572033432172ad02f1e?s=128&d=identicon&r=PG", "display_name": "MiaZ", "link": "https://stackoverflow.com/users/3400045/miaz"}, "edited": false, "score": 0, "creation_date": 1479250531, "post_id": 40621185, "comment_id": 68476549, "body": "Ahhh, that&#39;s really interesting, thank you for the explanation!"}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 2, "last_activity_date": 1479250459, "creation_date": 1479250459, "answer_id": 40621185, "question_id": 40621058, "link": "https://stackoverflow.com/questions/40621058/while-trying-to-create-a-yaml-file-from-a-hash-my-key-ends-up-with-quotations-i/40621185#40621185", "title": "While trying to create a YAML file from a hash, my key ends up with quotations in it", "body": "<p>A lot of YAML serializers err on the side of caution, especially when rendering keys with irregular characters in them. Dot, dash, spaces, these are things that need special handling.</p>\n\n<p>There's nothing wrong with that output, in fact it's probably the best version of that, the most reliably escaped, so that other YAML readers will process it properly.</p>\n\n<p>I'd avoid trying to remove those quotes. If anything, maybe you could switch how your keys are stored to avoid the dot.</p>\n"}], "owner": {"reputation": 61, "user_id": 3400045, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fdbbce5c6df20572033432172ad02f1e?s=128&d=identicon&r=PG", "display_name": "MiaZ", "link": "https://stackoverflow.com/users/3400045/miaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479250459, "creation_date": 1479249904, "question_id": 40621058, "link": "https://stackoverflow.com/questions/40621058/while-trying-to-create-a-yaml-file-from-a-hash-my-key-ends-up-with-quotations-i", "title": "While trying to create a YAML file from a hash, my key ends up with quotations in it", "body": "<p>I'm trying to take a YAML that looks like this and make a new YAML with the TLD the top-level:</p>\n\n<pre><code>---\n-\nTLD: .abogado\nRegistry: \nTLD Type: nTLD\n-\nTLD: .ac\nRegistry: \nTLD Type: ccTLD\n</code></pre>\n\n<p>I loop through it, taking the TLD as the hash key and the rest as the value for that key. </p>\n\n<pre><code>cleaned_chart = {}\nrc.each do |item|\n  tld_key = item['TLD']\n  cleaned_chart[tld_key] = item\nend\n</code></pre>\n\n<p>Then I dump the hash to a file:</p>\n\n<pre><code>File.open(\"db/data/open_srs/tld_reference_chart.yml\",\"w\") do |file|\n  file.write cleaned_chart.to_yaml\nend\n</code></pre>\n\n<p>But I'm confused as to why there are quotations around the key now?!</p>\n\n<pre><code>\".abogado\":\n  tld: \".abogado\"\n  tld_type: nTLD\n\".ac\":\n  tld: \".ac\"\n  tld_type: ccTLD\n</code></pre>\n\n<p>I can't seem to remove the quotations! If it's a string, it gets put automatically, same as if I convert to a symbol then I get the : before the key :(</p>\n\n<p>Does anyone know why this is the case? I've googled but can't find anything about this.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1479248289, "post_id": 40620649, "comment_id": 68475672, "body": "How about <code>@blog.update(active: !@blog.active?)</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 1094, "user_id": 1241115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fc5d1fccf0ed8206e473e64937183e4?s=128&d=identicon&r=PG", "display_name": "Patrice Gagnon", "link": "https://stackoverflow.com/users/1241115/patrice-gagnon"}, "is_accepted": false, "score": 3, "last_activity_date": 1479248445, "creation_date": 1479248445, "answer_id": 40620769, "question_id": 40620649, "link": "https://stackoverflow.com/questions/40620649/how-to-toggle-a-boolean-attribute-in-a-controller-action/40620769#40620769", "title": "How to toggle a Boolean attribute in a controller action", "body": "<p>You could try this:</p>\n\n<pre><code>@blog.update(active: !@blog.active?)\n</code></pre>\n\n<p>That's pretty compact.</p>\n"}, {"tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 8, "last_activity_date": 1479248452, "creation_date": 1479248452, "answer_id": 40620772, "question_id": 40620649, "link": "https://stackoverflow.com/questions/40620649/how-to-toggle-a-boolean-attribute-in-a-controller-action/40620772#40620772", "title": "How to toggle a Boolean attribute in a controller action", "body": "<p>This should work:</p>\n\n<pre><code>@blog.update(active: !@blog.active?)\n</code></pre>\n\n<p><code>!</code> is your friend:</p>\n\n<pre><code>!false # =&gt; true\n!true # =&gt; false\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 648, "user_id": 10313894, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hVS6l.jpg?s=128&g=1", "display_name": "ARK", "link": "https://stackoverflow.com/users/10313894/ark"}, "edited": false, "score": 0, "creation_date": 1598346681, "post_id": 40620818, "comment_id": 112421824, "body": "Keep in mind, though, that toggle accepts 1 value at a time. FWIW"}], "tags": [], "owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "is_accepted": false, "score": 10, "last_activity_date": 1549471144, "last_edit_date": 1549471144, "creation_date": 1479248674, "answer_id": 40620818, "question_id": 40620649, "link": "https://stackoverflow.com/questions/40620649/how-to-toggle-a-boolean-attribute-in-a-controller-action/40620818#40620818", "title": "How to toggle a Boolean attribute in a controller action", "body": "<p>Rails provides <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Persistence.html#method-i-toggle\" rel=\"noreferrer\"><code>toggle</code></a> for this, but <strong>it's not atomic</strong>, and you still have to call <code>save</code> and consider validations. The bang-method alternative, will handle persistence for you, but validations are skipped. </p>\n\n<p>It's probably better to be explicit about what you're wanting to do here. If this action is the result of a form POST or an XHR request, accept the actual value you want to set (RESTful) instead of expecting the client to be aware of the current state of the database.</p>\n\n<p>So while this works: </p>\n\n<pre><code>@blog.toggle(:active)\n</code></pre>\n\n<p>\u2026it's non-deterministic and can result in the opposite of the desired action occurring. I would recommend this instead:</p>\n\n<pre><code>class BlogStatusController &lt; ApplicationController \n  # ... boilerplate to load @blog\n  def update\n    @blog.update(status_params)\n  end\n\nprotected\n\n  def status_params\n    params.require(:blog).permit(status: [:active])\n  end\nend\n</code></pre>\n\n<p>If you need an atomic toggle, you can easily achieve it with a SQL statement wrapped in a convenient method name: <a href=\"https://stackoverflow.com/a/24218418/203130\">https://stackoverflow.com/a/24218418/203130</a></p>\n"}, {"comments": [{"owner": {"reputation": 1186, "user_id": 1296980, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/RPwOZ.jpg?s=128&g=1", "display_name": "Sebastialonso", "link": "https://stackoverflow.com/users/1296980/sebastialonso"}, "edited": false, "score": 0, "creation_date": 1498081385, "post_id": 40620951, "comment_id": 76357513, "body": "This should be accepted answer. Using nothing else than Rails already provides."}, {"owner": {"reputation": 648, "user_id": 10313894, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hVS6l.jpg?s=128&g=1", "display_name": "ARK", "link": "https://stackoverflow.com/users/10313894/ark"}, "edited": false, "score": 0, "creation_date": 1598346673, "post_id": 40620951, "comment_id": 112421819, "body": "Keep in mind, though, that toggle accepts 1 value at a time. FWIW"}], "tags": [], "owner": {"reputation": 943, "user_id": 546950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60de781d84a6767b10c5040c54180433?s=128&d=identicon&r=PG", "display_name": "robertoplancarte", "link": "https://stackoverflow.com/users/546950/robertoplancarte"}, "is_accepted": true, "score": 19, "last_activity_date": 1582746860, "last_edit_date": 1582746860, "creation_date": 1479249382, "answer_id": 40620951, "question_id": 40620649, "link": "https://stackoverflow.com/questions/40620649/how-to-toggle-a-boolean-attribute-in-a-controller-action/40620951#40620951", "title": "How to toggle a Boolean attribute in a controller action", "body": "<p>ActiveRecord has the <code>toggle</code> and <code>toggle!</code> methods which do this. Just keep in mind that the <code>toggle!</code> method skips validation checks.</p>\n\n<pre><code>class BlogsController &lt; ApplicationController\n\n  ...    \n\n  def toggle_active\n    @blog.toggle!(:active)\n  end\n\nend\n</code></pre>\n\n<p>If you want to run validations you can do </p>\n\n<pre><code>@blog.toggle(:active).save\n</code></pre>\n\n<p>You can read the source code for the methods <a href=\"https://github.com/rails/rails/blob/22d9b3e83e03836c5b5d5b05be87ef9467805107/activerecord/lib/active_record/persistence.rb#L729-L752\" rel=\"noreferrer\">here</a></p>\n"}, {"comments": [{"owner": {"reputation": 943, "user_id": 546950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60de781d84a6767b10c5040c54180433?s=128&d=identicon&r=PG", "display_name": "robertoplancarte", "link": "https://stackoverflow.com/users/546950/robertoplancarte"}, "edited": false, "score": 0, "creation_date": 1479249774, "post_id": 40620952, "comment_id": 68476287, "body": "Do i get a point for the same exact answer 2 full seconds before yours? It&#39;s funny how we came up the almost the same answer at the exact same time :)"}, {"owner": {"reputation": 4288, "user_id": 638821, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4c66af07480b17f1024588ca5f608478?s=128&d=identicon&r=PG", "display_name": "Nick Coelius", "link": "https://stackoverflow.com/users/638821/nick-coelius"}, "reply_to_user": {"reputation": 943, "user_id": 546950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60de781d84a6767b10c5040c54180433?s=128&d=identicon&r=PG", "display_name": "robertoplancarte", "link": "https://stackoverflow.com/users/546950/robertoplancarte"}, "edited": false, "score": 0, "creation_date": 1514936908, "post_id": 40620952, "comment_id": 83112494, "body": "@robertoplancarte upvotes for both of you, thanks for helping me with an simple answer :-)"}, {"owner": {"reputation": 648, "user_id": 10313894, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hVS6l.jpg?s=128&g=1", "display_name": "ARK", "link": "https://stackoverflow.com/users/10313894/ark"}, "edited": false, "score": 0, "creation_date": 1598346694, "post_id": 40620952, "comment_id": 112421832, "body": "Keep in mind, though, that toggle accepts 1 value at a time. FWIW"}], "tags": [], "owner": {"reputation": 23287, "user_id": 5981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ab183bb240ffd3a3966d5a615b4bdeb?s=128&d=identicon&r=PG", "display_name": "Phil Ross", "link": "https://stackoverflow.com/users/5981/phil-ross"}, "is_accepted": false, "score": 20, "last_activity_date": 1479249385, "creation_date": 1479249385, "answer_id": 40620952, "question_id": 40620649, "link": "https://stackoverflow.com/questions/40620649/how-to-toggle-a-boolean-attribute-in-a-controller-action/40620952#40620952", "title": "How to toggle a Boolean attribute in a controller action", "body": "<p>Active Record's <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Persistence.html#method-i-toggle\" rel=\"noreferrer\"><code>toggle</code></a> and <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Persistence.html#method-i-toggle-21\" rel=\"noreferrer\"><code>toggle!</code></a> methods handle toggling a Boolean attribute:</p>\n\n<pre><code>def toggle_active\n  @blog.toggle(:active).save\nend\n</code></pre>\n\n\n\n<pre><code>def toggle_active\n  @blog.toggle!(:active)\nend\n</code></pre>\n\n<p><code>toggle</code> changes the attribute, but doesn't save the change to the database (so a separate call to <code>save</code> or <code>save!</code> is needed).</p>\n\n<p><code>toggle!</code> changes the attribute and saves the record, but bypasses the model's validations.</p>\n"}], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9386, "favorite_count": 4, "accepted_answer_id": 40620951, "answer_count": 5, "score": 16, "last_activity_date": 1582746860, "creation_date": 1479247866, "last_edit_date": 1479248171, "question_id": 40620649, "link": "https://stackoverflow.com/questions/40620649/how-to-toggle-a-boolean-attribute-in-a-controller-action", "title": "How to toggle a Boolean attribute in a controller action", "body": "<p>I have an action that simply toggles the <code>#active</code> attribute to the opposite boolean state: </p>\n\n<ul>\n<li>If <code>@blog.active == true</code> then <code>update</code> it to inactive</li>\n<li>If <code>@blog.active == false</code> then <code>update</code> it to active</li>\n</ul>\n\n<p>I got the following custom action in a controller to work, but there has to be some Rails way to more elegantly do this:</p>\n\n<pre><code>class BlogsController &lt; ApplicationController\n\n  ...    \n\n  def toggle_active\n    if @blog.active?\n      @blog.update(active: false)\n    else\n      @blog.update(active: true)\n    end\n  end\n\nend\n</code></pre>\n\n<p>Is there a Rails way of updating a boolean attribute to the opposite boolean state?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "google-maps", "geocode", "geokit"], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 5262119, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RutMk.jpg?s=128&g=1", "display_name": "NGinEar45", "link": "https://stackoverflow.com/users/5262119/nginear45"}, "is_accepted": true, "score": 2, "last_activity_date": 1482431696, "creation_date": 1482431696, "answer_id": 41289686, "question_id": 40620642, "link": "https://stackoverflow.com/questions/40620642/error-caught-an-error-during-google-geocoding-call-ssl-connect-syscall-ret/41289686#41289686", "title": "ERROR -- : Caught an error during Google geocoding call: SSL_connect SYSCALL returned=5 errno=0 state=SSLv2/v3 read server hello A", "body": "<p>I wasn't going to comment but no one has posted anything. Since your particular error message included an SSL warning, I would check if you need to explicitly require openssl and/or that your openssl setup is correct. I've had a similar problem with geocoding timing out in my application though the stack trace was a bit different. It took a long time for the Geocoding to complete (because the address was really weird for example) but the rest of my code kept going. I think the stack trace is a bug in Geokit. Since you don't have control over how fast this runs you should consider first of all doing something to reduce the number of times you're making this call, so at a bare minimum:</p>\n\n<pre><code>def full_address\n  @full_address ||= Geocoder.address(\"#{self.latlon.x}, #{self.latlon.y}\")\nend\n</code></pre>\n\n<p>You should also consider storing full_address as a calculated field since the above code will still run every time that instance of the model is accessed the first time. So getting rid of the code above and instead adding a full_address field and a before save hook:</p>\n\n<p>in a migration file:</p>\n\n<pre><code>add_column :models, :full_address, :string\n</code></pre>\n\n<p>and in your model.rb:</p>\n\n<pre><code>before_save :geocode_address\n\ndef geocode_address\n  self.full_address = Geocoder.address(\"#{self.latlon.x}, #{self.latlon.y}\") if self.changed.include?(\"latlon\")\nend\n</code></pre>\n\n<p>This way the call only runs when the latlon.x and latlon.y variables are updated, not every time the address is accessed.</p>\n"}], "owner": {"reputation": 139, "user_id": 6500179, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/20bc7d28d1d8f95e9b8e09dde2be4500?s=128&d=identicon&r=PG&f=1", "display_name": "user6500179", "link": "https://stackoverflow.com/users/6500179/user6500179"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "accepted_answer_id": 41289686, "answer_count": 1, "score": 1, "last_activity_date": 1482431696, "creation_date": 1479247842, "question_id": 40620642, "link": "https://stackoverflow.com/questions/40620642/error-caught-an-error-during-google-geocoding-call-ssl-connect-syscall-ret", "title": "ERROR -- : Caught an error during Google geocoding call: SSL_connect SYSCALL returned=5 errno=0 state=SSLv2/v3 read server hello A", "body": "<p>I am trying to get the address when inputting coordinates like so in my model. </p>\n\n<pre><code> def full_address\n    Geocoder.address(\"#{self.latlon.x}, #{self.latlon.y}\")\n  end\n</code></pre>\n\n<p>However, sometimes it works perfectly fine and then sometimes i get this error. I've looked all over for a solution but none is applicable to me.</p>\n\n<pre><code>warning: constant Geokit::Geocoders::Geocoder::TimeoutError is deprecated\nE, [2016-11-15T17:06:32.828481 #7406] ERROR -- : Caught an error during Google geocoding call: SSL_connect SYSCALL returned=5 errno=0 state=SSLv2/v3 read server hello A\nE, [2016-11-15T17:06:32.828665 #7406] ERROR -- : /Users/Brandon/.rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/net/http.rb:933:in `connect_nonblock'\n</code></pre>\n"}, {"tags": ["ruby", "linux", "rubygems", "vagrant", "vagrant-plugin"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1479246928, "post_id": 40620067, "comment_id": 68475026, "body": "How did you install Ruby? If from yum or rpm, did you include the devel package? In general we recommend using rbenv or RVM as they allow you to manage your Ruby installation without worrying about using <code>sudo</code> or having admin privileges."}, {"owner": {"reputation": 6471, "user_id": 933065, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/72bbc7edbac37156a74f26605589d01e?s=128&d=identicon&r=PG", "display_name": "janw", "link": "https://stackoverflow.com/users/933065/janw"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1479335254, "post_id": 40620067, "comment_id": 68519056, "body": "@theTinMan With sudo apt-get istall vagrant Can you link to a example?"}], "owner": {"reputation": 6471, "user_id": 933065, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/72bbc7edbac37156a74f26605589d01e?s=128&d=identicon&r=PG", "display_name": "janw", "link": "https://stackoverflow.com/users/933065/janw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 523, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479325078, "creation_date": 1479245643, "last_edit_date": 1479325078, "question_id": 40620067, "link": "https://stackoverflow.com/questions/40620067/vagrant-plugin-gives-gem-install-error", "title": "vagrant plugin gives gem install error", "body": "<p><strong>Background</strong></p>\n\n<p>The command <code>vagrant plugin install vagrant-hostsupdater</code> gives the following error</p>\n\n<blockquote>\n  <p>Bundler, the underlying system Vagrant uses to install plugins,\n  reported an error. The error is shown below. These errors are usually\n  caused by misconfigured plugin installations or transient network\n  issues. The error from Bundler is:</p>\n  \n  <p>An error occurred while installing ffi (1.9.14), and Bundler cannot\n  continue. Make sure that <code>gem install ffi -v '1.9.14'</code> succeeds before\n  bundling.</p>\n  \n  <p>Warning: this Gemfile contains multiple primary sources. Using\n  <code>source</code> more than once without a block is a security risk, and may\n  result in installing unexpected gems. To resolve this warning, use a\n  block to indicate which gems should come from the secondary source. To\n  upgrade this warning to an error, run <code>bundle config\n  disable_multisource true</code>.Gem::Ext::BuildError: ERROR: Failed to build\n  gem native extension.</p>\n\n<pre><code>current directory: /home/me/.vagrant.d/gems/gems/ffi-1.9.14/ext/ffi_c /usr/bin/ruby2.3 -r\n</code></pre>\n  \n  <p>./siteconf20161115-3798-7g7yrs.rb extconf.rb mkmf.rb can't find header\n  files for ruby at /usr/lib/ruby/include/ruby.h</p>\n  \n  <p>extconf failed, exit code 1</p>\n  \n  <p>Gem files will remain installed in\n  /home/me/.vagrant.d/gems/gems/ffi-1.9.14 for inspection. Results\n  logged to\n  /home/me/.vagrant.d/gems/extensions/x86_64-linux/2.3.0/ffi-1.9.14/gem_make.out</p>\n</blockquote>\n\n<p><strong>The error/problem</strong></p>\n\n<p>So I ran <code>sudo gem install ffi -v '1.9.14'</code> (without sudo I get a permission error)</p>\n\n<blockquote>\n  <p>Building native extensions.  This could take a while... ERROR:  Error\n  installing ffi:   ERROR: Failed to build gem native extension.</p>\n  \n  <p>current directory: /var/lib/gems/2.3.0/gems/ffi-1.9.14/ext/ffi_c /usr/bin/ruby2.3 -r ./siteconf20161115-4273-wovmbb.rb extconf.rb\n  mkmf.rb can't find header files for ruby at\n  /usr/lib/ruby/include/ruby.h</p>\n  \n  <p>extconf failed, exit code 1</p>\n  \n  <p>Gem files will remain installed in /var/lib/gems/2.3.0/gems/ffi-1.9.14\n  for inspection. Results logged to\n  /var/lib/gems/2.3.0/extensions/x86_64-linux/2.3.0/ffi-1.9.14/gem_make.out</p>\n</blockquote>\n\n<p>I tried un-installing vagrant and ruby it doesn't help.<br>\nDoes anybody know what is going wrong here?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "internationalization", "globalize"], "answers": [{"comments": [{"owner": {"reputation": 777, "user_id": 929062, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0e7dc0f38eed24aa38e714f55880d8f0?s=128&d=identicon&r=PG", "display_name": "user929062", "link": "https://stackoverflow.com/users/929062/user929062"}, "edited": false, "score": 0, "creation_date": 1479551184, "post_id": 40685403, "comment_id": 68613048, "body": "Exactly what I needed! Thanks."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 5, "last_activity_date": 1522767461, "last_edit_date": 1522767461, "creation_date": 1479500743, "answer_id": 40685403, "question_id": 40619960, "link": "https://stackoverflow.com/questions/40619960/how-to-check-if-globalize-has-used-a-fallback/40685403#40685403", "title": "How to check if Globalize has used a fallback", "body": "<p>Globalize adds a <a href=\"https://github.com/globalize/globalize/blob/38443bcd07da78b7b8a9433e4c6c32dd51f964a3/lib/globalize/active_record/instance_methods.rb#L4\" rel=\"nofollow noreferrer\"><code>translated_locales</code></a> method to instances of the translated model. </p>\n\n<p><code>translated_locales</code> returns an array of all available locales for a specific instance. When this array doesn't include the current <code>I18n.locale</code> then the fallback will be used.</p>\n\n<p>You can used that like this:</p>\n\n<pre><code>&lt;%= image.name %&gt;\n&lt;%= image.description %&gt;\n\n&lt;% unless image.translated_locales.include?(I18n.locale) %&gt;\n  Message: This text has not been translated yet and is shown in English\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 777, "user_id": 929062, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0e7dc0f38eed24aa38e714f55880d8f0?s=128&d=identicon&r=PG", "display_name": "user929062", "link": "https://stackoverflow.com/users/929062/user929062"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 533, "favorite_count": 0, "accepted_answer_id": 40685403, "answer_count": 1, "score": 2, "last_activity_date": 1522767461, "creation_date": 1479245230, "question_id": 40619960, "link": "https://stackoverflow.com/questions/40619960/how-to-check-if-globalize-has-used-a-fallback", "title": "How to check if Globalize has used a fallback", "body": "<p>I am using:</p>\n\n<pre><code>gem 'rails', '4.0.0'\ngem 'globalize', '~&gt; 4.0.2'\n</code></pre>\n\n<p>In my Image.rb model I have two columns I want translate (English and German):</p>\n\n<pre><code>translates :name, :description\n</code></pre>\n\n<p>In application.rb I set:</p>\n\n<pre><code>config.i18n.fallbacks = true\n</code></pre>\n\n<p>Everthing works fine. I have an English description and if I change language to German it shows the German description in case there is one, otherwise the English text. Proplem is that still most image description do not have a German translation, so I would like to add a text message to the German sites saying that currently there is no German translation but we show the English text until there is a German translation available.</p>\n\n<p>I planned to add into my view somthing like</p>\n\n<pre><code>if fallback.true?\n  Message: This text has not been translated yet and is shown in English\n</code></pre>\n\n<p>Is there a way to check if Globalize has used the fallback option and display a message in this case?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "is_accepted": true, "score": 1, "last_activity_date": 1479245277, "creation_date": 1479245277, "answer_id": 40619972, "question_id": 40619907, "link": "https://stackoverflow.com/questions/40619907/for-debugging-in-rails-console-type-in-routing-path-variable-and-return-path/40619972#40619972", "title": "For debugging in rails console: type in routing path variable and return path", "body": "<p>Got it.  You have to call the routing path variable on <code>app</code></p>\n\n<pre><code>app.blogs_path\n=&gt; \"/blogs\"\n</code></pre>\n"}], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 40619972, "answer_count": 1, "score": 1, "last_activity_date": 1479245277, "creation_date": 1479244985, "question_id": 40619907, "link": "https://stackoverflow.com/questions/40619907/for-debugging-in-rails-console-type-in-routing-path-variable-and-return-path", "title": "For debugging in rails console: type in routing path variable and return path", "body": "<p>Let us say I have this in my routes file:</p>\n\n<pre><code>resources :blogs\n</code></pre>\n\n<p>I want to see the path that is returned when I use one of the routing variables.</p>\n\n<p><strong>Example:</strong> </p>\n\n<p>within <code>rails console</code> I would expect typing in <code>blogs_path</code> to return <code>\"/blogs\"</code> but it does not work that way.  Instead it errors out:</p>\n\n<blockquote>\n  <p>undefined local variable or method `blogs_path' for main:Object</p>\n</blockquote>\n\n<p>I am aware that I can do <code>rake routes</code> and see the routes that way, but what I am trying to do here is see what is returned when I call upon a routing path variable. </p>\n\n<p>Hopefully that makes sense. </p>\n"}, {"tags": ["ruby", "ssl", "rake", "bundle"], "comments": [{"owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 0, "creation_date": 1479244729, "post_id": 40619457, "comment_id": 68473932, "body": "<a href=\"http://stackoverflow.com/questions/10246023/bundle-install-fails-with-ssl-certificate-verification-error\" title=\"bundle install fails with ssl certificate verification error\">stackoverflow.com/questions/10246023/&hellip;</a>"}], "owner": {"reputation": 287, "user_id": 372429, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/416c63cb7f6e15b4a11680121dff3e84?s=128&d=identicon&r=PG", "display_name": "archcutbank", "link": "https://stackoverflow.com/users/372429/archcutbank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 321, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1479243197, "creation_date": 1479243069, "last_edit_date": 1479243197, "question_id": 40619457, "link": "https://stackoverflow.com/questions/40619457/bundle-exec-rake-fails-with-ssl-certificate-verification-message", "title": "bundle exec rake fails with ssl certificate verification message", "body": "<p>I am having an issue with running </p>\n\n<pre><code>/local/mis/ruby/bin/bundle exec /local/mis/ruby/bin/rake package OFFLINE=true PINNED=true\n</code></pre>\n\n<p>It throws:</p>\n\n<pre><code>[DownloadCache]                  WARN  Unable to download https://java-buildpack.cloudfoundry.org/groovy/index.yml into cache build/staging/resources/cache: SSL_connect returned=1 errno=0 state=error: certificate verify failed\nrake aborted!\nUnable to find cached file for https://java-buildpack.cloudfoundry.org/groovy/index.yml\n/local/mis/bamboo/home/xml-data/build-dir/93683714-93782019/java-buildpack/lib/java_buildpack/util/cache/download_cache.rb:75:in `get'\n/local/mis/bamboo/home/xml-data/build-dir/93683714-93782019/java-buildpack/rakelib/dependency_cache_task.rb:167:in `get_from_cache'\n/local/mis/bamboo/home/xml-data/build-dir/93683714-93782019/java-buildpack/rakelib/dependency_cache_task.rb:159:in `block (2 levels) in uris'\n/local/mis/bamboo/home/xml-data/build-dir/93683714-93782019/java-buildpack/rakelib/dependency_cache_task.rb:157:in `each'\n/local/mis/bamboo/home/xml-data/build-dir/93683714-93782019/java-buildpack/rakelib/dependency_cache_task.rb:157:in `block in uris'\n/local/mis/bamboo/home/xml-data/build-dir/93683714-93782019/java-buildpack/rakelib/dependency_cache_task.rb:156:in `each'\n/local/mis/bamboo/home/xml-data/build-dir/93683714-93782019/java-buildpack/rakelib/dependency_cache_task.rb:156:in `uris'\n/local/mis/bamboo/home/xml-data/build-dir/93683714-93782019/java-buildpack/rakelib/dependency_cache_task.rb:45:in `initialize'\n/local/mis/bamboo/home/xml-data/build-dir/93683714-93782019/java-buildpack/Rakefile:40:in `new'\n/local/mis/bamboo/home/xml-data/build-dir/93683714-93782019/java-buildpack/Rakefile:40:in `&lt;top (required)&gt;'\n/local/mis/ruby/bin/bundle:22:in `load'\n/local/mis/ruby/bin/bundle:22:in `&lt;main&gt;'\n(See full trace by running task with --trace)\n$\n</code></pre>\n\n<p>I am not sure how to get around this.  I am not sure what to fix:  bundle?  rake?  ruby?  </p>\n\n<p>I tried to make a .gemrc with </p>\n\n<pre><code>:ssl_verify_mode: 0\n</code></pre>\n\n<p>Note to sure format of .gemrc file. Do I need to add the following?</p>\n\n<pre><code>- https://cloudfoundry.org\n:ssl_verify_mode: 0\n</code></pre>\n\n<p>(guess it is not gem throwing the error since that did not work)</p>\n\n<p>I tried:</p>\n\n<pre><code>echo | openssl s_client -connect cloudfoundry.org:443 2&gt;&amp;1 | sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p' &gt; cert.pem\n</code></pre>\n\n<p>I then <code>cat &gt;&gt; /etc/ssl/certs/ca-bundle.crt</code></p>\n\n<p>Is this correct?  Does ruby, bundle, rake or whatever needs it using this <code>ca-bundle.crt</code> file?  </p>\n\n<p>I am at a loss on how to get to to be fine with the https location for the java-bundle from cloudfoundry.</p>\n"}, {"tags": ["ruby", "string", "rspec", "split", "atom-editor"], "answers": [{"comments": [{"owner": {"reputation": 1264, "user_id": 4300706, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ayUXk.png?s=128&g=1", "display_name": "Tam Borine", "link": "https://stackoverflow.com/users/4300706/tam-borine"}, "edited": false, "score": 0, "creation_date": 1479238743, "post_id": 40618207, "comment_id": 68470613, "body": "Oh and extra thanks for all the extra ideas! It&#39;s more than enough for me! :)"}, {"owner": {"reputation": 1264, "user_id": 4300706, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ayUXk.png?s=128&g=1", "display_name": "Tam Borine", "link": "https://stackoverflow.com/users/4300706/tam-borine"}, "edited": false, "score": 0, "creation_date": 1479238863, "post_id": 40618207, "comment_id": 68470692, "body": "I think <code>&#47;\\bis\\b&#47;</code> is most suitable"}], "tags": [], "owner": {"reputation": 1548, "user_id": 1246279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2533d5a4299cad329268e552c47fa8d?s=128&d=identicon&r=PG", "display_name": "philomory", "link": "https://stackoverflow.com/users/1246279/philomory"}, "is_accepted": true, "score": 3, "last_activity_date": 1479238698, "last_edit_date": 1479238698, "creation_date": 1479238365, "answer_id": 40618207, "question_id": 40618025, "link": "https://stackoverflow.com/questions/40618025/strange-behaviour-corrupting-some-part-of-a-string-but-only-particular-chars-at/40618207#40618207", "title": "Strange behaviour corrupting some part of a string but only particular chars, Atom, RSpec", "body": "<p>You've missed something fairly straightforward: the middle two characters of <code>\"pish\"</code> are <code>\"is\"</code>. So of course, if you split on <code>\"is\"</code>, that gets split into <code>\"p\"</code> and <code>\"h\"</code>.</p>\n\n<p>There are a couple of ways around this. The simplest, in your case, is probably to split on <code>\" is \"</code> (that is, \"is\" with a space on each side). Depending on exact needs, you might instead split on regular expressions such as <code>/\\sis\\s/</code> (\"is\" with some sort of <a href=\"http://www.regular-expressions.info/shorthand.html\" rel=\"nofollow noreferrer\">whitespace</a> on either side, could be space, tab, etc) or <code>/\\bis\\b/</code> (\"is\" with a <a href=\"http://www.regular-expressions.info/wordboundaries.html\" rel=\"nofollow noreferrer\">word boundary</a> on either side - in this case, the \"is\" can't be in the middle of the word, but the surrounding whitespace isn't actually part of the match, so it's not removed from the string).</p>\n\n<pre><code> \"his is hers\".split(/\\sis\\s/) # =&gt; [\"his\", \"hers\"]\n \"his is hers\".split(/\\bis\\b/) # =&gt; [\"his \", \" hers\"]\n</code></pre>\n\n<p>Note that in the first case, the spaces are part of the delimiter and are removed along with it, but in the second case, they are not part of the delimiter, and are not removed.</p>\n"}], "owner": {"reputation": 1264, "user_id": 4300706, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ayUXk.png?s=128&g=1", "display_name": "Tam Borine", "link": "https://stackoverflow.com/users/4300706/tam-borine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 40618207, "answer_count": 1, "score": 1, "last_activity_date": 1479238698, "creation_date": 1479237681, "question_id": 40618025, "link": "https://stackoverflow.com/questions/40618025/strange-behaviour-corrupting-some-part-of-a-string-but-only-particular-chars-at", "title": "Strange behaviour corrupting some part of a string but only particular chars, Atom, RSpec", "body": "<p>I am struggling with an odd situation. I have a function which iterates over an array of strings and splits each string on \"is\" which am testing in RSpec like so:</p>\n\n<h1>test body</h1>\n\n<pre><code>info_combo = [\"pish pish Iron is 3910 Credits\",\"glob prok Gold is 57800 Credits\"]\nexpect(interpreter.solveForUnknownInfo(info_combo)).to eq some_final_expectable_object\n</code></pre>\n\n<h1>function</h1>\n\n<pre><code>def getSubjectsAndObjects(info_combo)\n   subjects = []\n   objects = []\n  info_combo.each do |info_str|\n    print info_str\n    subjectsAndObjects = info_str.split(\"is\")\n    print subjectsAndObjects\n    subjects &lt;&lt; subjectsAndObjects[0]\n    objects &lt;&lt; subjectsAndObjects[1]\n  end\nreturn subjects, objects\nend\n</code></pre>\n\n<h1>printed output while debugging</h1>\n\n<pre><code>\"pish pish Iron is 3910 Credits\" =&gt; first iteration input\n[\"p\", \"h p\", \"h Iron \", \" 3910 Credits\"] =&gt; crazy unexpected\n\"glob prok Gold is 57800 Credits\"   =&gt; second iteration input\n[\"glob prok Gold \", \" 57800 Credits\"] =&gt; expectable output\n</code></pre>\n\n<p>## after replacing the first substr of 2nd input string, 'pish' with 'another_random_word' ...</p>\n\n<pre><code>\"another_random_word pish Iron is 3910 Credits\" =&gt; first iteration input\n[\"another_random_word p\", \"h Iron \", \" 3910 Credits\"] =&gt;some hopeful change\n\"glob prok Gold is 57800 Credits\" =&gt; second iteration input\n[\"glob prok Gold \", \" 57800 Credits\"] =&gt; expectable output\n</code></pre>\n\n<p>## after replacing the final 'pish' with 'another_random_word'</p>\n\n<pre><code>\"another_random_word another_random_word Iron is 3910 Credits\" =&gt; first iteration input\n\"another_random_word another_random_word Iron \", \" 3910 Credits\"] =&gt; now totally expectable/desired output from function\n\"glob prok Gold is 57800 Credits\" =&gt; second iteration input\n[\"glob prok Gold \", \" 57800 Credits\"] =&gt; expectable output\n</code></pre>\n\n<p>This is really confusing for me. I have no idea how to debug this or ideas of what might be going wrong. I thought it was a text editor glitch (Atom), have restarted the program and no changes. </p>\n\n<p>Something I've missed? Any ideas? Also ideas on improving the question/title are very welcome.</p>\n"}, {"tags": ["ruby", "rubygems", "feedzirra", "feedjira"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1479242103, "post_id": 40617219, "comment_id": 68472571, "body": "Please read &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; including the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;. We need to see the minimum code that demonstrates what you tried, and an explanation of why it doesn&#39;t work. Currently your question broad."}], "answers": [{"tags": [], "owner": {"reputation": 264, "user_id": 1698908, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/2259453/picture?type=large", "display_name": "Evan Appleby", "link": "https://stackoverflow.com/users/1698908/evan-appleby"}, "is_accepted": true, "score": 0, "last_activity_date": 1482357814, "last_edit_date": 1482357814, "creation_date": 1479833886, "answer_id": 40747524, "question_id": 40617219, "link": "https://stackoverflow.com/questions/40617219/ruby-how-to-set-feedjira-configuration-options/40747524#40747524", "title": "Ruby: How to set feedjira configuration options?", "body": "<p>It looks like a patch was added to allow a timeout option to be passed to the fetch_and_parse function:\n   <a href=\"https://github.com/feedjira/feedjira/pull/318/commits/fbdb85b622f72067683508b1d7cab66af6303297#diff-a29beef397e3d8624e10af065da09a14\" rel=\"nofollow noreferrer\">https://github.com/feedjira/feedjira/pull/318/commits/fbdb85b622f72067683508b1d7cab66af6303297#diff-a29beef397e3d8624e10af065da09a14</a></p>\n\n<p>However, until that is pushed live, a timeout and an open_timeout option can be passed by bypassing Feedjira for the fetching and instead using Faraday (or any library that can fetch HTTP requests, like Net::HTTP). You can also set ssl verify to false, and set the user agent, such as this:</p>\n\n<pre><code>require 'feedjira'\nrequire 'pp'\n\nurl = \"http://www.espn.com/espnw/rss/?sectionKey=athletes-life\"\n\nconn = Faraday.new :ssl =&gt; {:verify =&gt; false}\nresponse = conn.get do |request|\n    request.url url\n    request.options.timeout = 5\n    request.options.open_timeout = 5\n    request.headers = {'User-Agent' =&gt; \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/37.0.2062.94 Safari/537.36\"}\nend\nfeed_parsed = Feedjira::Feed.parse response.body\npp feed_parsed.entries.first\n</code></pre>\n\n<p>I haven't seen a way to check for \"if_modified_since\", but I will update answer if I do.</p>\n"}], "owner": {"reputation": 264, "user_id": 1698908, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/2259453/picture?type=large", "display_name": "Evan Appleby", "link": "https://stackoverflow.com/users/1698908/evan-appleby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 40747524, "answer_count": 1, "score": -1, "last_activity_date": 1482357814, "creation_date": 1479234794, "last_edit_date": 1479257651, "question_id": 40617219, "link": "https://stackoverflow.com/questions/40617219/ruby-how-to-set-feedjira-configuration-options", "title": "Ruby: How to set feedjira configuration options?", "body": "<p>In the Feedjira 2.0 announcement blog post, it says that if you want to set the user agent, that should be a configuration option, but it is not clear how to do this. Ideally, I would like to mimic the options previously provided in Feedjira 1.0, including user_agent, if_modified_since, timeout, and ssl_verify_peer.</p>\n\n<p><a href=\"http://feedjira.com/blog/2014/04/14/thoughts-on-version-two-point-oh.html\" rel=\"nofollow noreferrer\">http://feedjira.com/blog/2014/04/14/thoughts-on-version-two-point-oh.html</a></p>\n\n<p>With Feedjira 1.0, you could set those options by making the following call (as described <a href=\"http://www.rubydoc.info/github/feedjira/feedjira/Feedjira%2FFeed.fetch_and_parse\" rel=\"nofollow noreferrer\">here</a>):</p>\n\n<pre><code>feed_parsed = Feedjira::Feed.fetch_and_parse(\"http://sports.espn.go.com/espn/rss/news\", {:if_modified_since =&gt; Time.now, :ssl_verify_peer =&gt; false, :timeout =&gt; 5, :user_agent =&gt; \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/37.0.2062.94 Safari/537.36\"})\n</code></pre>\n\n<p>The only example I have seen where configuration options are set was from a <a href=\"https://github.com/feedjira/feedjira/pull/296#issuecomment-133862893\" rel=\"nofollow noreferrer\">comment</a> in a github pull request, which is as follows:</p>\n\n<pre><code>Feedjira::Feed.configure do |faraday|\n    faraday.request :user_agent, app: \"MySite\", version: APP_VERSION\nend\n</code></pre>\n\n<p>But when I tried something similar, I received the following error:</p>\n\n<pre><code>undefined method `configure' for Feedjira::Feed:Class\n</code></pre>\n"}, {"tags": ["ruby", "selenium-chromedriver", "capybara", "profiling", "site-prism"], "comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1479234790, "post_id": 40616952, "comment_id": 68468366, "body": "Are the assets internal to your app or external, if external it can be due to external sites throttling your requests and can be worked around with a caching/programmable proxy like puffing-billy.  If internal its likely to be the asset pipeline and may need you to increase timeouts."}, {"owner": {"reputation": 770, "user_id": 3968358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28a5b795c55cd84ce9ba0574a7761727?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew A.", "link": "https://stackoverflow.com/users/3968358/andrew-a"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1479238568, "post_id": 40616952, "comment_id": 68470503, "body": "The assets that are taking the longest are external to the app. Thank you"}, {"owner": {"reputation": 2080, "user_id": 1033737, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/iJ3qS.jpg?s=128&g=1", "display_name": "thefabbulus", "link": "https://stackoverflow.com/users/1033737/thefabbulus"}, "edited": false, "score": 0, "creation_date": 1479241493, "post_id": 40616952, "comment_id": 68472240, "body": "are they essential for your tests to pass?"}, {"owner": {"reputation": 770, "user_id": 3968358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28a5b795c55cd84ce9ba0574a7761727?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew A.", "link": "https://stackoverflow.com/users/3968358/andrew-a"}, "edited": false, "score": 0, "creation_date": 1479251540, "post_id": 40616952, "comment_id": 68476865, "body": "No they are not essential"}], "owner": {"reputation": 770, "user_id": 3968358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28a5b795c55cd84ce9ba0574a7761727?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew A.", "link": "https://stackoverflow.com/users/3968358/andrew-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550846802, "creation_date": 1479233872, "last_edit_date": 1550846802, "question_id": 40616952, "link": "https://stackoverflow.com/questions/40616952/chromedriver-taking-long-time-to-load-assets", "title": "Chromedriver taking long time to load assets", "body": "<p>I'm having sporadic failures in my automated test suite because certain assets on the page are taking a long time to load. Each time it's a different one, so my question is : does this seem like an issue with the app's configuration or with chromedriver?</p>\n"}, {"tags": ["ruby", "object-oriented-analysis"], "comments": [{"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1479235515, "post_id": 40616942, "comment_id": 68468783, "body": "Welcome to Stack Overflow. This is a pretty great first-timer question. In the future, please try to describe a bit more the details of your problem. &quot;It feels  odd&quot; is a pretty vague description. That said while Stack Overflow tends towards hard code questions lately, questions of design and code structure are still on topic here. Just be sure to describe your actual problem. Often, <a href=\"http://softwareengineering.stackexchange.com/\">softwareengineering.stackexchange.com</a> or <a href=\"http://codereview.stackexchange.com/\">codereview.stackexchange.com</a> are great places for these kinds of questions too."}, {"owner": {"reputation": 6198, "user_id": 839601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6db99aa846a8217f7e2aba6fa198e7c?s=128&d=identicon&r=PG", "display_name": "gnat", "link": "https://stackoverflow.com/users/839601/gnat"}, "reply_to_user": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1479236545, "post_id": 40616942, "comment_id": 68469379, "body": "@HolgerJust when referring other sites, it is often helpful to point that <a href=\"http://meta.stackexchange.com/tags/cross-posting/info\">cross-posting is frowned upon</a>"}, {"owner": {"reputation": 191, "user_id": 7163009, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-duRS0PJv8ow/AAAAAAAAAAI/AAAAAAAAdIU/PbZoS3CPHQg/photo.jpg?sz=128", "display_name": "Nicholas Erdenberger", "link": "https://stackoverflow.com/users/7163009/nicholas-erdenberger"}, "reply_to_user": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1479263580, "post_id": 40616942, "comment_id": 68480226, "body": "@HolgerJust thanks for your wisdom my friend!  Still a newbie so I will take your advice on the next question :-)"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1479285275, "post_id": 40616942, "comment_id": 68487842, "body": "Your question is unclear. The important bit of your question seems to be this: &quot;Since ruby is pass-by-reference, what is the correct way to handle this?&quot; However, your premise in untrue: Ruby is strictly pass-by-value, <i>never</i> pass-by-reference, so this seems to invalidate your entire question."}, {"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1479292115, "post_id": 40616942, "comment_id": 68492145, "body": "@J&#246;rgWMittag While it is true that Ruby is pass-by-reference-value, the question does not suffer from this slightly incorrect assumption. The main point on how to structure classes which reference and access other object still stands."}, {"owner": {"reputation": 191, "user_id": 7163009, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-duRS0PJv8ow/AAAAAAAAAAI/AAAAAAAAdIU/PbZoS3CPHQg/photo.jpg?sz=128", "display_name": "Nicholas Erdenberger", "link": "https://stackoverflow.com/users/7163009/nicholas-erdenberger"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1479593704, "post_id": 40616942, "comment_id": 68626163, "body": "@J&#246;rgWMittag Thanks for pointing out the error, I&#39;ll update the question."}], "answers": [{"tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": true, "score": 4, "last_activity_date": 1479235134, "creation_date": 1479235134, "answer_id": 40617313, "question_id": 40616942, "link": "https://stackoverflow.com/questions/40616942/parent-child-classes-in-ruby-not-inheritance/40617313#40617313", "title": "&quot;Parent&quot;, &quot;Child&quot; Classes In Ruby (Not Inheritance)", "body": "<p>This is basically how it's supposed to be done :) There are a couple of possible improvements though, depending on what you actually want to achieve.</p>\n\n<p>Right now, your <code>Child</code> instances expose access to the parent on their external interface (via the public <code>parent</code> accessor). This is often a violation of the <a href=\"https://en.wikipedia.org/wiki/Law_of_Demeter\" rel=\"nofollow noreferrer\">Law of Demeter</a> which states that objects should only talk to their direct neighbors. In this sense, the <code>parent</code> is a stranger when accessed though the child object.</p>\n\n<p>You could improve your design by hiding the parent object:</p>\n\n<pre><code>class Child\n  extend Forwardable\n\n  def_delegator :@parent, :var, :parent_var\n  def_delegator :@parent, :increase\n\n  attr_accessor :var\n\n  def initialize(parent, num)\n    @parent = parent\n    @var = num\n  end\n\n  def sum\n    @parent.increase\n    @parent.var + var\n  end\nend\n</code></pre>\n\n<p>Here, we use Ruby's <a href=\"http://ruby-doc.org/stdlib/libdoc/forwardable/rdoc/Forwardable.html\" rel=\"nofollow noreferrer\">Forwardable</a> module to provide access to some methods of the parent from the client. This makes these methods part of the single public interface of your Child class.</p>\n\n<pre><code>parent = Parent.new(1)\n\nchild = Child.new(parent, 2)\n\nchild.var\n# =&gt; 2\nchild.parent_var\n# =&gt; 1\nchild.increase\n# =&gt; 2\nparent.var\n# =&gt; 2\n# ^^^^ the increase method was called on the parent object\n</code></pre>\n\n<p>From the outside, it doesn't matter that the methods are forwarded and you can later change this without affecting your external interface at all.</p>\n\n<hr>\n\n<p>A second improvement could be to extend your <code>Parent</code> class to generate children directly:</p>\n\n<pre><code>class Parent\n  # ...\n\n  def child(num)\n    Child.new(self, num)\n  end\nend\n</code></pre>\n\n<p>This is usually called a <a href=\"https://en.wikipedia.org/wiki/Factory_method_pattern\" rel=\"nofollow noreferrer\">Factory Method</a>, i.e. a method which builds other objects. With this, you can hide the complexity of building your Child objects and attaching them to your parent.</p>\n\n<p>You can call it like</p>\n\n<pre><code>parent = Parent.new(1)\nchild = parent.child(2)\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 7163009, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-duRS0PJv8ow/AAAAAAAAAAI/AAAAAAAAdIU/PbZoS3CPHQg/photo.jpg?sz=128", "display_name": "Nicholas Erdenberger", "link": "https://stackoverflow.com/users/7163009/nicholas-erdenberger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1044, "favorite_count": 1, "accepted_answer_id": 40617313, "answer_count": 1, "score": 4, "last_activity_date": 1479593875, "creation_date": 1479233826, "last_edit_date": 1479593875, "question_id": 40616942, "link": "https://stackoverflow.com/questions/40616942/parent-child-classes-in-ruby-not-inheritance", "title": "&quot;Parent&quot;, &quot;Child&quot; Classes In Ruby (Not Inheritance)", "body": "<p>Let's say I have two classes.  One class, \"parent\", has many of another class \"child\".  This is not inheritance, I don't want parent methods to act on child objects.  What I want is the child object to be able to reference the parent object, get variables from it (child.parent.var) and call parent methods that modify the parent (<code>child.parent.update</code>).</p>\n\n<p>I'd like one object (which could be thought of as a child-but-not-child-because-this-isn't-inheritance) to be passed a reference to another object when it is initialized.  I'd compare this to a parent child relationship in a database where we store info on the parent so we don't have to duplicate it onto every child.</p>\n\n<p>Example:</p>\n\n<pre><code>class Parent\n    attr_accessor :var\n\n  def initialize(num)\n    @var = num\n  end\n\n  def increase\n    @var += 1\n  end\nend\n\nclass Child\n    attr_accessor :var, :parent\n\n    def initialize(parent, num)\n        @parent = parent\n        @var = num\n    end\n\n    def sum\n        @parent.increase\n        @parent.var + var\n    end\nend\n\nparent1 = Parent.new(1)\n\nchild1 = Child.new(parent1, 2)\nchild2 = Child.new(parent1, 3)\n\nchild1.parent.increase # update the parent variable\nchild2.parent.var      # get the parent variable\n</code></pre>\n\n<p>The above code does work, but is there a better (more concise, or more ruby-esq) way to achieve this?</p>\n\n<p>Thanks so much for your help/thoughts.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "rufus-scheduler"], "comments": [{"owner": {"reputation": 3437, "user_id": 10762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d96626e52beb1ff90f57a8e189e1e6f?s=128&d=identicon&r=PG", "display_name": "jmettraux", "link": "https://stackoverflow.com/users/10762/jmettraux"}, "edited": false, "score": 0, "creation_date": 1482179200, "post_id": 40616092, "comment_id": 69660162, "body": "OK, you&#39;re using Puma, so you have a single Ruby process. Quick request for test. Does the problem persist if you stop using the lockfile? In other words, does the problem persist if you simply do <code>SCHEDULER = Rufus::Scheduler.new</code> ?"}, {"owner": {"reputation": 139, "user_id": 2807555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Fn1So.png?s=128&g=1", "display_name": "wintheday", "link": "https://stackoverflow.com/users/2807555/wintheday"}, "reply_to_user": {"reputation": 3437, "user_id": 10762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d96626e52beb1ff90f57a8e189e1e6f?s=128&d=identicon&r=PG", "display_name": "jmettraux", "link": "https://stackoverflow.com/users/10762/jmettraux"}, "edited": false, "score": 0, "creation_date": 1482263440, "post_id": 40616092, "comment_id": 69700584, "body": "@jmettraux I tried removing the lockfile and unfortunately the problem remains."}, {"owner": {"reputation": 3437, "user_id": 10762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d96626e52beb1ff90f57a8e189e1e6f?s=128&d=identicon&r=PG", "display_name": "jmettraux", "link": "https://stackoverflow.com/users/10762/jmettraux"}, "edited": false, "score": 0, "creation_date": 1482267988, "post_id": 40616092, "comment_id": 69703001, "body": "Added phase 2 to answer below"}, {"owner": {"reputation": 139, "user_id": 2807555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Fn1So.png?s=128&g=1", "display_name": "wintheday", "link": "https://stackoverflow.com/users/2807555/wintheday"}, "reply_to_user": {"reputation": 3437, "user_id": 10762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d96626e52beb1ff90f57a8e189e1e6f?s=128&d=identicon&r=PG", "display_name": "jmettraux", "link": "https://stackoverflow.com/users/10762/jmettraux"}, "edited": false, "score": 0, "creation_date": 1482273633, "post_id": 40616092, "comment_id": 69705417, "body": "@jmettraux Added logs from phase 2 code. Thanks for your help."}, {"owner": {"reputation": 3437, "user_id": 10762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d96626e52beb1ff90f57a8e189e1e6f?s=128&d=identicon&r=PG", "display_name": "jmettraux", "link": "https://stackoverflow.com/users/10762/jmettraux"}, "edited": false, "score": 0, "creation_date": 1482279096, "post_id": 40616092, "comment_id": 69707023, "body": "Added phase 3 to answer below. Thanks in advance!"}, {"owner": {"reputation": 139, "user_id": 2807555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Fn1So.png?s=128&g=1", "display_name": "wintheday", "link": "https://stackoverflow.com/users/2807555/wintheday"}, "reply_to_user": {"reputation": 3437, "user_id": 10762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d96626e52beb1ff90f57a8e189e1e6f?s=128&d=identicon&r=PG", "display_name": "jmettraux", "link": "https://stackoverflow.com/users/10762/jmettraux"}, "edited": false, "score": 0, "creation_date": 1482336476, "post_id": 40616092, "comment_id": 69735079, "body": "Added phase 3 logs to question. It looks like some how there is a new scheduler process that is subsequently created and then destroyed inside the model code. Thanks again for your diligence on this!"}, {"owner": {"reputation": 3437, "user_id": 10762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d96626e52beb1ff90f57a8e189e1e6f?s=128&d=identicon&r=PG", "display_name": "jmettraux", "link": "https://stackoverflow.com/users/10762/jmettraux"}, "edited": false, "score": 0, "creation_date": 1482389655, "post_id": 40616092, "comment_id": 69756121, "body": "Added phase 4 to my answer below."}, {"owner": {"reputation": 3437, "user_id": 10762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d96626e52beb1ff90f57a8e189e1e6f?s=128&d=identicon&r=PG", "display_name": "jmettraux", "link": "https://stackoverflow.com/users/10762/jmettraux"}, "edited": false, "score": 0, "creation_date": 1482441536, "post_id": 40616092, "comment_id": 69786204, "body": "Thanks for accepting my answer."}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 2807555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Fn1So.png?s=128&g=1", "display_name": "wintheday", "link": "https://stackoverflow.com/users/2807555/wintheday"}, "edited": false, "score": 0, "creation_date": 1482163924, "post_id": 40620839, "comment_id": 69652247, "body": "I have rephrased the question to reflect the steps my application takes and where the problem I am encountering is actually happening. Thanks in advance for your help."}, {"owner": {"reputation": 139, "user_id": 2807555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Fn1So.png?s=128&g=1", "display_name": "wintheday", "link": "https://stackoverflow.com/users/2807555/wintheday"}, "edited": false, "score": 0, "creation_date": 1482442542, "post_id": 40620839, "comment_id": 69786671, "body": "I am going to accept this but real quick can you update your answer to also include what I finally ended up doing as an option. Your diagnosis as to the problem was correct rails 5 by default uses cluster mode and both of your solutions would work, but I wanted to leave puma in cluster mode but I didn&#39;t want a clean up job running all the time so instead I am using Redis pub/sub (which comes with rails 5 by default) to message the main process to stop jobs on metric update. Thanks for your help on this!!"}, {"owner": {"reputation": 3437, "user_id": 10762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d96626e52beb1ff90f57a8e189e1e6f?s=128&d=identicon&r=PG", "display_name": "jmettraux", "link": "https://stackoverflow.com/users/10762/jmettraux"}, "reply_to_user": {"reputation": 139, "user_id": 2807555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Fn1So.png?s=128&g=1", "display_name": "wintheday", "link": "https://stackoverflow.com/users/2807555/wintheday"}, "edited": false, "score": 0, "creation_date": 1482442929, "post_id": 40620839, "comment_id": 69786819, "body": "Sorry, I do not want to update my answer with the option you chose. It is your option, not mine, adding it to my answer breaks the dialogue. I think it sits well in the comment above."}], "tags": [], "owner": {"reputation": 3437, "user_id": 10762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d96626e52beb1ff90f57a8e189e1e6f?s=128&d=identicon&r=PG", "display_name": "jmettraux", "link": "https://stackoverflow.com/users/10762/jmettraux"}, "is_accepted": true, "score": 1, "last_activity_date": 1482358425, "last_edit_date": 1482358425, "creation_date": 1479248784, "answer_id": 40620839, "question_id": 40616092, "link": "https://stackoverflow.com/questions/40616092/rufus-scheduler-help-starting-stopping-jobs-in-model/40620839#40620839", "title": "Rufus Scheduler - Help Starting / Stopping Jobs in Model", "body": "<blockquote>\n  <p>When the above code runs for an active metric going inactive I successfully get the Logger messages and load the right job. As well, when I use better errors to inspect the code at that area the job itself sets the @unscheduled_at attribute correctly however the Job keeps getting rescheduled to run again.</p>\n  \n  <p>On the other side of it when the update_job method runs and is trying to reschedule the job it never starts.</p>\n</blockquote>\n\n<p>So are you trying to say that the Job gets rescheduled but that new, rescheduled, Job is never triggering?</p>\n\n<p>If I naively look at your code (rehashed it for a better understanding):</p>\n\n<pre><code>def update_job\n\n  if self.changed.present?\n    job = SCHEDULER.jobs(tag: self.id).first\n    if job.present?\n      logger.info \"Job #{job.id}, for Metric #{self.id} unscheduled.\"\n      job.unschedule\n    end\n\n    if self.active\n      metric = self\n      new_job_id =\n        SCHEDULER.every(\n          self.frequency,\n          :tags =&gt; self.id,\n          :overlap =&gt; false,\n          :timeout =&gt; self.try(:timeout) || '3m'\n        ) { |job| metric.add_value }\n      logger.info \"Job #{new_job_id} for Metric #{self.id} scheduled.\"\n    end\n  end\nend\n</code></pre>\n\n<p>Could the symptom you describe be resumed to \"application never enters the reschedule block of the update_job method\"?</p>\n\n<blockquote>\n  <p>The Metric with ID 2 has a frequency of 20s. It runs twice then gets unscheduled correctly so I know its working properly outside of the model code.</p>\n</blockquote>\n\n<p>So it's something in your code model. There is a small chance that it's related with rufus-scheduler.</p>\n\n<p>Please rephrase carefully your \"actual question\". In its current version, it is confusing me.</p>\n\n<p><strong>phase 2 - 2016-12-21</strong></p>\n\n<p>Could you please try with the code below?</p>\n\n<p>Warning: it is not tested, it may contain errors you'll certainly spot and fix to make it usable.</p>\n\n<p>Then try your two scenarii and report, with a log grep of the \"xxx \" this code is emitting. It might tell us what is going wrong.</p>\n\n<p>Thanks in advance.</p>\n\n<pre><code># initializers/scheduler.rb\n\nrequire 'rufus-scheduler'\n\nclass Rufus::Scheduler\n  def to_report_s\n    a = []\n    a &lt;&lt; self.class\n    a &lt;&lt; Rufus::Scheduler::VERSION\n    a &lt;&lt; self.object_id\n    a &lt;&lt; \"down? #{self.down?}\"\n    %w[ at in every internal cron ].each do |flav|\n      m = \"#{flav}_jobs\".to_sym\n      a &lt;&lt; \"#{m}: #{self.send(m).size}\"\n    end\n    a.collect(&amp;:to_s).join(' ')\n  end\nend\nclass Rufus::Scheduler::Job\n  def to_report_s\n    \"Job: #{self.class} #{@id} (#{self.object_id}) \" +\n    \"Tags: #{@tags.inspect} Frequency: #{@frequency}\"\n  end\nend\n\n#SCHEDULER = Rufus::Scheduler.new(:lockfile =&gt; \".rufus-scheduler.lock\")\nSCHEDULER = Rufus::Scheduler.new\n\n# Add \"global\" error handler to the rufus-scheduler instance\n#\ndef SCHEDULER.on_error(job, error)\n\n  Rails.logger.error(\n    \"xxx err#{error.object_id} rufus-scheduler intercepted #{error.inspect}\" +\n    \" in job #{job.to_report_s}\")\n  error.backtrace.each_with_index do |line, i|\n    Rails.logger.error(\n      \"xxx err#{error.object_id} #{i}: #{line}\")\n  end\nend\n\nlogger.info(\"xxx SCHEDULER started: #{SCHEDULER.object_id}\")\n\nunless (\n  defined?(Rails::Console) || File.split($0).last == 'rake' ||\n  SCHEDULER.down?\n)\n  # launch All Matrics Jobs that are active\n\n  Metric.active.each do |metric|\n\n    SCHEDULER.every(\n      metric.frequency,\n      :tags =&gt; metric.id,\n      :overlap =&gt; false,\n      :timeout =&gt; metric.try(:timeout) || '3m'\n    ) do |job|\n      logger.info \"xxx trigger (scheduled in initializer) #{job.to_report_s}\"\n      metric.add_value\n    end\n  end\nend\n</code></pre>\n\n<p>and</p>\n\n<pre><code># models/metric.rb\n\nclass Metric &lt; ApplicationRecord\n\n  after_save :update_job\n\n  private\n\n  def update_job\n\n    lip = \"Metric #{id}\" # logger info prefix\n    logger.info(\"xxx #{lip} #update_job active: #{self.active.inspect}\")\n\n    if self.changed.present?\n\n      logger.info(\"xxx #{lip} #update_job 0 SCHEDULER #{SCHEDULER.to_report_s}\")\n\n      #job = SCHEDULER.jobs(tag: self.id).first\n      #if job.present?\n      if job = SCHEDULER.jobs(tag: self.id).first\n        logger.info \"xxx #{lip} found Job #{job.to_report_s}\"\n        #SCHEDULER.unschedule(job.id)\n        job.unschedule\n        logger.info \"xxx #{lip} Job #{job.id} unscheduled\"\n      end\n\n      logger.info(\"xxx #{lip} #update_job 1 SCHEDULER #{SCHEDULER.to_report_s}\")\n\n      if self.active\n        metric = self\n        job_id = SCHEDULER.every(\n          self.frequency,\n          :tags =&gt; self.id,\n          :overlap =&gt; false,\n          :timeout =&gt; self.try(:timeout) || '3m'\n        ) do |job|\n          logger.info \"xxx trigger (scheduled in #updateJob) #{job.to_report_s}\"\n          metric.add_value\n        end\n        logger.info \"xxx #{lip} Job #{job_id} scheduled\"\n      end\n\n      logger.info(\"xxx #{lip} #update_job 2 SCHEDULER #{SCHEDULER.to_report_s}\")\n    end\n  end\nend\n</code></pre>\n\n<p><strong>phase 3 - 2016-12-21</strong></p>\n\n<p>Could you please retry with the code below:</p>\n\n<pre><code># initializers/scheduler.rb\n\nrequire 'rufus-scheduler'\n\nclass Rufus::Scheduler\n  def to_report_a\n    a = []\n    a &lt;&lt; \"#{self.class} #{Rufus::Scheduler::VERSION} #{object_id}\"\n    a &lt;&lt; \"down? #{self.down?}\"\n    a &lt;&lt; \"Process.pid #{Process.pid}\"\n    a &lt;&lt; \"jobs:\"\n    jobs.each_with_index { |job, i| a &lt;&lt; \"  #{i}: #{job.to_report_s}\" }\n    a.collect(&amp;:to_s)\n  end\nend\nclass Rufus::Scheduler::Job\n  def to_report_s\n    {\n      j: self.class, i: @id, oi: object_id, ts: @tags,\n      frq: @frequency, ua: @unscheduled_at, c: count, nt: next_time\n    }\n      .collect { |k, v| \"#{k}: #{v.inspect}\" }\n      .join(' ')\n  end\nend\n\n#SCHEDULER = Rufus::Scheduler.new(:lockfile =&gt; \".rufus-scheduler.lock\")\nSCHEDULER = Rufus::Scheduler.new\n\n# Add \"global\" error handler to the rufus-scheduler instance\n#\ndef SCHEDULER.on_error(job, error)\n  lep = \"xxx err#{error.object_id}\"\n  Rails.logger.error(\n    \"xxx #{lep} rufus-scheduler intercepted #{error.inspect}\" +\n    \" in job #{job.to_report_s}\")\n  error.backtrace.each_with_index do |line, i|\n    Rails.logger.error(\n      \"xxx #{lep} #{i}: #{line}\")\n  end\n  Rails.logger.error(\"xxx #{lep} scheduler:\")\n  SCHEDULER.to_report_a.each { |l| Rails.logger.error(\"xxx #{lep} #{l}\") }\nend\n\nlogger.info(\"xxx SCHEDULER started: #{SCHEDULER.object_id}\")\n\nunless (\n  defined?(Rails::Console) || File.split($0).last == 'rake' ||\n  SCHEDULER.down?\n)\n  # launch All Matrics Jobs that are active\n\n  Metric.active.each do |metric|\n\n    lip = \"Metric #{metric.id}\" # logger info prefix\n\n    job_id =\n      SCHEDULER.every(\n        metric.frequency,\n        :tags =&gt; metric.id,\n        :overlap =&gt; false,\n        :timeout =&gt; metric.try(:timeout) || '3m'\n      ) do |job|\n        logger.info(\n          \"xxx #{lip} trigger (scheduled in initializer) \" +\n          \"#{job.to_report_s}\")\n        metric.add_value\n      end\n    logger.info(\n      \"xxx #{lip} Job #{job_id} scheduled in initializer \" +\n      \"for Metric #{metric.id}\")\n  end\n\n  SCHEDULER.to_report_a.each { |l| logger.info(\"xxx sc #{l}\") }\n  logger.info(\"xxx initializer over.\")\nend\n</code></pre>\n\n<p>and</p>\n\n<pre><code># models/metric.rb\n\nclass Metric &lt; ApplicationRecord\n\n  after_save :update_job\n\n  private\n\n  def update_job\n\n    lip = \"Metric #{id}\" # logger info prefix\n    logger.info(\n      \"xxx #{lip} #update_job \" +\n      \"changed: #{self.changed.inspect} active: #{self.active.inspect}\")\n\n    return unless self.changed.present?\n\n    SCHEDULER.to_report_a\n      .each { |l| logger.info(\"xxx #{lip} sc #update_job 0 #{l}\") }\n\n    jobs = SCHEDULER.jobs(tag: self.id)\n\n    jobs.each_with_index do |job, i|\n      logger.info(\n        \"xxx #{lip} found Job #{job.to_report_s} #{i == 0 ? 'first' : ''}\")\n    end\n\n    if job = jobs.first\n      #SCHEDULER.unschedule(job.id)\n      job.unschedule\n      logger.info \"xxx #{lip} Job #{job.id} unscheduled\"\n      logger.info \"xxx #{lip} Job #{job.id} scheduled? #{SCHEDULER.scheduled?(job.id)}\"\n    end\n\n    SCHEDULER.to_report_a\n      .each { |l| logger.info(\"xxx #{lip} sc #update_job 1 #{l}\") }\n\n    return unless self.active\n\n    metric = self\n    job_id = SCHEDULER.every(\n      self.frequency,\n      :tags =&gt; self.id,\n      :overlap =&gt; false,\n      :timeout =&gt; self.try(:timeout) || '3m'\n    ) do |job|\n      logger.info \"xxx trigger (scheduled in #update_job) #{job.to_report_s}\"\n      metric.add_value\n    end\n    logger.info \"xxx #{lip} Job #{job_id} scheduled in #update_job\"\n\n    SCHEDULER.to_report_a\n      .each { |l| logger.info(\"xxx #{lip} sc #update_job 2 #{l}\") }\n  end\nend\n</code></pre>\n\n<p><strong>phase 4 - 2016-12-22</strong></p>\n\n<blockquote>\n  <p>Added phase 3 logs to question. It looks like some how there is a new scheduler process that is subsequently created and then destroyed inside the model code. Thanks again for your diligence on this!</p>\n</blockquote>\n\n<p>Is that really happening in the model code? Your logs tell us that it happens in another process. Your initial Ruby process instantiates rufus-scheduler then your HTTP requests are served in worker processes which are forks of your initial process (without the threads, in other words with inactive schedulers).</p>\n\n<p>You're using Puma in clustered mode. I should have immediately asked you about your configuration.</p>\n\n<p>Read carefully its documentation at <a href=\"https://github.com/puma/puma#configuration\" rel=\"nofollow noreferrer\">https://github.com/puma/puma#configuration</a></p>\n\n<p>An easy fix would be not to use the clustered mode so that there is only one Ruby process involved, serving all the HTTP requests.</p>\n\n<p>On the other hand, if you need the clustered mode, you have to change your way of thinking. You probably don't want to have 1 rufus-scheduler instance per worker thread. You could focus on having the core (live) rufus-scheduler in the main process. It could have a \"management\" job that checks recently updated metrics and unschedules/schedules jobs.</p>\n\n<pre><code>SCHEDULER.every '10s', overlap: false do\n  Metric.recently_updated.each do |metric|\n    SCHEDULER.jobs(tags: metric.id).each(&amp;:unschedule)\n    SCHEDULER.every(metric.frequency, tags: self.id) { metric.add_value }\n  end\nend\n  # or something like that...\n</code></pre>\n\n<p>Have fun!</p>\n"}], "owner": {"reputation": 139, "user_id": 2807555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Fn1So.png?s=128&g=1", "display_name": "wintheday", "link": "https://stackoverflow.com/users/2807555/wintheday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 758, "favorite_count": 0, "accepted_answer_id": 40620839, "answer_count": 1, "score": 1, "last_activity_date": 1482358425, "creation_date": 1479230882, "last_edit_date": 1482336338, "question_id": 40616092, "link": "https://stackoverflow.com/questions/40616092/rufus-scheduler-help-starting-stopping-jobs-in-model", "title": "Rufus Scheduler - Help Starting / Stopping Jobs in Model", "body": "<p>After Reading the Rufus Scheduler Docs about 100 times, every StackOverflow question I can find, looking at the source code, and finally reading <a href=\"http://www.chiark.greenend.org.uk/~sgtatham/bugs.html\" rel=\"nofollow noreferrer\">how to report bugs effectively</a> twice. I have come to the point where @jmettraux I need your help:</p>\n\n<h3>The Application</h3>\n\n<p>I am writing an internal application that allows my team to create metrics that periodically run code that saves values to a database. I have the following setup. </p>\n\n<p><strong>schema.rb</strong></p>\n\n<pre><code>create_table \"metrics\", force: :cascade do |t|\n    t.string   \"frequency\"\n    t.string   \"name\"\n    t.text     \"data\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.enter code hereboolean  \"active\"\n  end\n</code></pre>\n\n<p><strong>initializers/scheduler.rb</strong></p>\n\n<pre><code>require 'rufus-scheduler'\n\nclass Rufus::Scheduler::Job\n  def report\n    logger = Logger.new(STDOUT)\n    logger.info \"Job: #{@id} Tags: #{@tags} Frequency: #{@frequency}\"\n  end\nend\n\nSCHEDULER = Rufus::Scheduler.new(:lockfile =&gt; \".rufus-scheduler.lock\")\n\nunless defined?(Rails::Console) || File.split($0).last == 'rake'\n  #Launch All Matrics Jobs that are active\n  @metrics = Metric.active\n\n  unless SCHEDULER.down?\n    @metrics.each_with_index do | metric, index |\n      SCHEDULER.every metric.frequency, :tags =&gt; metric.id, :overlap =&gt; false, :timeout =&gt; metric.try(:timeout) || '3m' do | job |\n        metric.add_value\n        job.report\n      end\n    end\n  end\nend\n</code></pre>\n\n<h3>What Works</h3>\n\n<p>The code above works flawlessly and Rufus initializes properly and all the jobs start as they should. </p>\n\n<h3>The Problem</h3>\n\n<p>Where I am running into a problem is that once the app is running I need to be able to unschedule jobs and reschedule them when a Metric is saved. I use the Rufus tags to assign a tag with the ID of the Metric when they are created and I'm using that to load them for unscheduling. \nHere is my current metric model with the relevant code. </p>\n\n<p><strong>models/metric.rb</strong></p>\n\n<pre><code>class Metric &lt; ApplicationRecord\n\n  ...\n\n  after_save :update_job\n\n  private\n  def update_job\n    if self.changed.present?\n      job = SCHEDULER.jobs(tag: self.id).first\n      if job.present?\n        logger.info \"Job #{job.id}, for Metric #{self.id} unscheduled.\"\n        SCHEDULER.unschedule(job.id)\n      end\n\n      if self.active\n        metric = self\n        new_job = SCHEDULER.every self.frequency, :tags =&gt; self.id, :overlap =&gt; false, :timeout =&gt; self.try(:timeout) || '3m' do | job |\n          metric.add_value\n        end\n        logger.info \"Job #{new_job} for Metric #{self.id} scheduled.\"\n      end\n    end\n  end\n\nend\n</code></pre>\n\n<h3>The Actual Question!</h3>\n\n<blockquote>\n  <p>Scenario 1:</p>\n  \n  <ul>\n  <li>Application Starts</li>\n  <li>scheduler initilizer loads all active metrics</li>\n  <li>scheduler initilizer starts all active metrics as 'every' job</li>\n  <li>User edits an active metric setting it to inactive</li>\n  <li>The update_job method is ran after the metric is saved</li>\n  <li>inside the update_job method the job for the current metric is found successfully</li>\n  <li>the unscheudle method is called on the job</li>\n  <li>PROBLEM HERE: The job runs again even after being unscheduled</li>\n  </ul>\n  \n  <p>Scenario 2:</p>\n  \n  <ul>\n  <li>Application Starts</li>\n  <li>scheduler initilizer loads all active metrics</li>\n  <li>scheduler initilizer starts all active metrics as 'every' job</li>\n  <li>User edits an inactive metric setting it to active</li>\n  <li>The update_job method is ran after the metric is saved</li>\n  <li>inside the update_job method a new 'every' job is scheduled for the metric</li>\n  <li>PROBLEM HERE: The job never gets started</li>\n  </ul>\n</blockquote>\n\n<h3>What I have tried</h3>\n\n<ul>\n<li><p>I have tried adding the following code to the bottom of the initializer to ensure that the unschedule method works properly in my app. </p>\n\n<pre><code>sleep 50\njob = SCHEDULER.jobs(tag: 2).first\nSCHEDULER.unschedule(job)\n</code></pre>\n\n<p>The Metric with ID 2 has a frequency of 20s. It runs twice then gets unscheduled correctly so I know its working properly outside of the model code. </p></li>\n</ul>\n\n<h3>System/Application Info</h3>\n\n<ul>\n<li>Ruby 2.3.0</li>\n<li>Rails 5.0.0.1</li>\n<li>Puma 3.6.0</li>\n<li>OSX 10.12.1 Sierra</li>\n<li>rufus-scheduler 3.2.2</li>\n</ul>\n\n<h3>Phase 2 Logs - 12/20/2016</h3>\n\n<p>Scenario 1:</p>\n\n<pre><code>  xxx SCHEDULER started: 70168058449780\n  xxx trigger (scheduled in initializer) Job: Rufus::Scheduler::EveryJob every_1482273018.01852_1684784125738549751 (70168045492220) Tags: [\"2\"] Frequency: 20.0\n  xxx Metric 2 #update_job active: false\n  xxx Metric 2 #update_job 0 SCHEDULER Rufus::Scheduler 3.2.2 70168058449780 down? false at_jobs: 0 in_jobs: 0 every_jobs: 2 interval_jobs: 0 cron_jobs: 0\n  xxx Metric 2 found Job Job: Rufus::Scheduler::EveryJob every_1482273018.01852_1684784125738549751 (70168045492220) Tags: [\"2\"] Frequency: 20.0\n  xxx Metric 2 Job every_1482273018.01852_1684784125738549751 unscheduled\n  xxx Metric 2 #update_job 1 SCHEDULER Rufus::Scheduler 3.2.2 70168058449780 down? false at_jobs: 0 in_jobs: 0 every_jobs: 1 interval_jobs: 0 cron_jobs: 0\n  xxx Metric 2 #update_job 2 SCHEDULER Rufus::Scheduler 3.2.2 70168058449780 down? false at_jobs: 0 in_jobs: 0 every_jobs: 1 interval_jobs: 0 cron_jobs: 0\n  xxx trigger (scheduled in initializer) Job: Rufus::Scheduler::EveryJob every_1482273018.01852_1684784125738549751 (70168045492220) Tags: [\"2\"] Frequency: 20.0\n  xxx trigger (scheduled in initializer) Job: Rufus::Scheduler::EveryJob every_1482273018.01852_1684784125738549751 (70168045492220) Tags: [\"2\"] Frequency: 20.0\n</code></pre>\n\n<p>Scenario 2:</p>\n\n<pre><code>  xxx SCHEDULER started: 70272158805840\n  xxx Metric 2 #update_job active: true\n  xxx Metric 2 #update_job 0 SCHEDULER Rufus::Scheduler 3.2.2 70272158805840 down? false at_jobs: 0 in_jobs: 0 every_jobs: 1 interval_jobs: 0 cron_jobs: 0\n  xxx Metric 2 #update_job 1 SCHEDULER Rufus::Scheduler 3.2.2 70272158805840 down? false at_jobs: 0 in_jobs: 0 every_jobs: 1 interval_jobs: 0 cron_jobs: 0\n  xxx Metric 2 Job every_1482273159.799382_1489585858424637616 scheduled\n  xxx Metric 2 #update_job 2 SCHEDULER Rufus::Scheduler 3.2.2 70272158805840 down? false at_jobs: 0 in_jobs: 0 every_jobs: 2 interval_jobs: 0 cron_jobs: 0\n</code></pre>\n\n<h3>Phase 3 Logs - 12/20/2016</h3>\n\n<p>Scenario 1:</p>\n\n<pre><code>xxx SCHEDULER started: 70321240613760\nxxx sc Rufus::Scheduler 3.2.2 70321240613760\nxxx sc down? false\nxxx sc Process.pid 39975\nxxx sc jobs:\nxxx sc   0: j: Rufus::Scheduler::EveryJob i: \"every_1482335616.453129_4198855636205920237\" oi: 70321198587560 ts: [\"2\"] frq: 20.0 ua: nil c: 0 nt: 2016-12-21 09:53:56 -0600\nxxx initializer over.\nxxx Metric 2 Job every_1482335616.453129_4198855636205920237 scheduled in initializer for Metric 2\nxxx Metric 2 Job every_1482335616.453129_4198855636205920237 scheduled in initializer for Metric 2\nxxx Metric 2 Job every_1482335616.453129_4198855636205920237 scheduled in initializer for Metric 2\nxxx Metric 2 #update_job changed: [\"active\", \"updated_at\"] active: false\nxxx Metric 2 sc #update_job 0 Rufus::Scheduler 3.2.2 70321240613760\nxxx Metric 2 sc #update_job 0 down? false\nxxx Metric 2 sc #update_job 0 Process.pid 40037\nxxx Metric 2 sc #update_job 0 jobs:\nxxx Metric 2 sc #update_job 0   0: j: Rufus::Scheduler::EveryJob i: \"every_1482335616.453129_4198855636205920237\" oi: 70321198587560 ts: [\"2\"] frq: 20.0 ua: nil c: 0 nt: 2016-12-21 09:53:56 -0600\nxxx Metric 2 found Job j: Rufus::Scheduler::EveryJob i: \"every_1482335616.453129_4198855636205920237\" oi: 70321198587560 ts: [\"2\"] frq: 20.0 ua: nil c: 0 nt: 2016-12-21 09:53:56 -0600 first\nxxx Metric 2 Job every_1482335616.453129_4198855636205920237 unscheduled\nxxx Metric 2 Job every_1482335616.453129_4198855636205920237 scheduled? false\nxxx Metric 2 sc #update_job 1 Rufus::Scheduler 3.2.2 70321240613760\nxxx Metric 2 sc #update_job 1 down? false\nxxx Metric 2 sc #update_job 1 Process.pid 40037\nxxx Metric 2 sc #update_job 1 jobs:\nxxx Metric 2 Job every_1482335616.453129_4198855636205920237 scheduled in initializer for Metric 2\n</code></pre>\n\n<p>Scenario 2:</p>\n\n<pre><code>xxx SCHEDULER started: 70152969118240\nxxx sc Rufus::Scheduler 3.2.2 70152969118240\nxxx sc down? false\nxxx sc Process.pid 40811\nxxx sc jobs:\nxxx initializer over.\nxxx Metric 2 #update_job changed: [\"active\", \"updated_at\"] active: true\nxxx Metric 2 sc #update_job 0 Rufus::Scheduler 3.2.2 70152969118240\nxxx Metric 2 sc #update_job 0 down? false\nxxx Metric 2 sc #update_job 0 Process.pid 40872\nxxx Metric 2 sc #update_job 0 jobs:\nxxx Metric 2 sc #update_job 1 Rufus::Scheduler 3.2.2 70152969118240\nxxx Metric 2 sc #update_job 1 down? false\nxxx Metric 2 sc #update_job 1 Process.pid 40872\nxxx Metric 2 sc #update_job 1 jobs:\nxxx Metric 2 Job every_1482336051.9823449_3069051954259909338 scheduled in #update_job\nxxx Metric 2 sc #update_job 2 Rufus::Scheduler 3.2.2 70152969118240\nxxx Metric 2 sc #update_job 2 down? false\nxxx Metric 2 sc #update_job 2 Process.pid 40872\nxxx Metric 2 sc #update_job 2 jobs:\nxxx Metric 2 sc #update_job 2   0: j: Rufus::Scheduler::EveryJob i: \"every_1482336051.9823449_3069051954259909338\" oi: 70152971745840 ts: [\"2\"] frq: 20.0 ua: nil c: 0 nt: 2016-12-21 10:01:11 -0600\n</code></pre>\n"}, {"tags": ["ruby", "oop", "instance-variables", "attr"], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 7157578, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-r6LJMZA5HDU/AAAAAAAAAAI/AAAAAAAAAqs/RWnhOl6284c/photo.jpg?sz=128", "display_name": "Ryan Flach", "link": "https://stackoverflow.com/users/7157578/ryan-flach"}, "is_accepted": true, "score": 1, "last_activity_date": 1479231704, "last_edit_date": 1495542284, "creation_date": 1479231704, "answer_id": 40616341, "question_id": 40615999, "link": "https://stackoverflow.com/questions/40615999/is-it-better-practice-to-use-an-attr-accessor-here-or-not/40616341#40616341", "title": "Is it better practice to use an attr_accessor here or not?", "body": "<p>I think your use of <code>attr_accessor</code> here is fine, though depending on how much functionality you continue to add, it will likely be clearer to restrict functionality of that class to the class itself.</p>\n\n<p>Regarding your question on using a method within <code>QuestionList</code>, this would come down to readability. Something to note first, however: you used <code>QuestionsList.add_question(question)</code> as an example. This would create a class method. What you really want here is an instance method, which would read as <code>list.add_question(question)</code>, since you already have an instance of the list created. <a href=\"http://culttt.com/2015/06/10/understanding-class-methods-verses-instance-methods-in-ruby/\" rel=\"nofollow noreferrer\">This blog post</a> has some good information on the difference between class and instance methods. </p>\n\n<p>I personally find instance methods would most clearly communicate your intent. I would write out <code>QuestionList</code> as follows:</p>\n\n<pre><code>class QuestionList\n\n  def initialize\n    @questions = []\n  end\n\n  def add_question(question)\n    @questions &lt;&lt; question\n  end\n\n  def print_all_questions_in_list\n    @questions.each do |question|\n      puts \"#{question.ask}\"\n    end\n  end\n\nend\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/5046831/why-use-rubys-attr-accessor-attr-reader-and-attr-writer\">This SO post</a> has some excellent information on Ruby's <code>attr</code> methods, if you'd like additional info there.</p>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 1, "last_activity_date": 1479232932, "creation_date": 1479232932, "answer_id": 40616668, "question_id": 40615999, "link": "https://stackoverflow.com/questions/40615999/is-it-better-practice-to-use-an-attr-accessor-here-or-not/40616668#40616668", "title": "Is it better practice to use an attr_accessor here or not?", "body": "<p>The <code>@questions</code> array is a private internal implementation detail of your class. It should <em>never ever</em> get exposed to clients. There are many reasons for this, two examples are:</p>\n\n<ul>\n<li>You overpromise an interface: now, all your clients depend on it being an array. What if you later want to change it to something else? A textfile? A database? A webservice?</li>\n<li>You expose operations that break your object invariants: a client can, for example, add an integer to that array. Or <code>nil</code>. Or anything else that is not a <code>Question</code>.</li>\n</ul>\n\n<p><em>How</em> you store your questions should be an implementation detail. The <code>QuestionList</code> should have methods to manage the list of questions. It should probably have an <code>each</code> method (and <code>include Enumerable</code>), and an <code>add</code> method (possibly aliased to <code>&lt;&lt;</code>). Maybe also an <code>[]</code>, if that makes sense. These methods could simply be delegated to the array, if convenient, but the point is: if you later decide to not use an array, you can do that without anyone even noticing. You can decide to only support those methods you actually <em>want</em> to support, as opposed to all ~100 methods of <code>Array</code>.</p>\n"}], "owner": {"reputation": 2986, "user_id": 4564080, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/83009ae032b72f3c1aa2bba01ab123e1?s=128&d=identicon&r=PG&f=1", "display_name": "KOB", "link": "https://stackoverflow.com/users/4564080/kob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 40616341, "answer_count": 2, "score": 2, "last_activity_date": 1479232932, "creation_date": 1479230555, "question_id": 40615999, "link": "https://stackoverflow.com/questions/40615999/is-it-better-practice-to-use-an-attr-accessor-here-or-not", "title": "Is it better practice to use an attr_accessor here or not?", "body": "<p>I have a class <code>QuestionList</code> that stores a list of 'Question' objects.</p>\n\n<pre><code>class QuestionList\n\n    attr_accessor :questions\n\n    def initialize\n        @questions = []\n    end\n\nend\n</code></pre>\n\n<p>I then add questions to the list and then \"ask\" these questions from my main class as so:</p>\n\n<pre><code>list = QuestionList.new\nlist.questions &lt;&lt; Question.new(5, 3)\nlist.questions &lt;&lt; Question.new(1, 5)\nlist.questions &lt;&lt; Question.new(2, 4)\n\nlist.questions.each do |question|\n    puts \"#{question.ask}\"\nend\n</code></pre>\n\n<p>where <code>Question.ask</code> simply outputs the question as a string.</p>\n\n<p>I'm not sure how acceptable it is to be writing to an instance variable from my main class using the <code>&lt;&lt;</code> operator, and <code>list.questions.push(Question.new(5, 3))</code> is even more unclear from the main class. </p>\n\n<p>Would it be better to have a <code>QuestionsList.add_question(question)</code> method?</p>\n\n<p>The same goes for <code>list.questions.each</code> - is this acceptable to be used in the main class?</p>\n"}, {"tags": ["ruby", "regex", "unicode"], "comments": [{"owner": {"reputation": 428, "user_id": 2034926, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cbb54874265d38c043401735f9a9ee1d?s=128&d=identicon&r=PG", "display_name": "Hank-Roughknuckles", "link": "https://stackoverflow.com/users/2034926/hank-roughknuckles"}, "edited": false, "score": 0, "creation_date": 1479232005, "post_id": 40615989, "comment_id": 68466877, "body": "If there&#39;s something wrong with my question (as indicated by the downvotes), what can I do to make the question better?"}, {"owner": {"reputation": 1962, "user_id": 2945616, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TL0yY.jpg?s=128&g=1", "display_name": "Atul Khanduri", "link": "https://stackoverflow.com/users/2945616/atul-khanduri"}, "edited": false, "score": 0, "creation_date": 1479232853, "post_id": 40615989, "comment_id": 68467321, "body": "So you want to convert every single blackslash to double backslash? And if there&#39;s more than 3 or more backslashes?"}, {"owner": {"reputation": 428, "user_id": 2034926, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cbb54874265d38c043401735f9a9ee1d?s=128&d=identicon&r=PG", "display_name": "Hank-Roughknuckles", "link": "https://stackoverflow.com/users/2034926/hank-roughknuckles"}, "reply_to_user": {"reputation": 1962, "user_id": 2945616, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TL0yY.jpg?s=128&g=1", "display_name": "Atul Khanduri", "link": "https://stackoverflow.com/users/2945616/atul-khanduri"}, "edited": false, "score": 0, "creation_date": 1479233218, "post_id": 40615989, "comment_id": 68467521, "body": "I&#39;d like to only convert the unicode characters.  So any instance of <code>\\uxxxx</code> should be converted to <code>\\\\uxxxx</code>.  Things like <code>\\&quot;</code> should be left alone."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1479245388, "post_id": 40615989, "comment_id": 68474276, "body": "Welcome to Stack Overflow. Please read &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages, and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;. Your question is premature. Instead of asking us all the ways you can do something, you need to try, then, when you have a problem, show us the minimum code demonstrating the problem you ran into. Currently your question is too broad."}, {"owner": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "edited": false, "score": 0, "creation_date": 1480382465, "post_id": 40615989, "comment_id": 68929064, "body": "If you use single quotes you needn&#39;t worry about escapes."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6889878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356286637b20e07e9c72e968a02e3809?s=128&d=identicon&r=PG&f=1", "display_name": "P.Fewtrell", "link": "https://stackoverflow.com/users/6889878/p-fewtrell"}, "is_accepted": false, "score": 0, "last_activity_date": 1479234097, "creation_date": 1479234097, "answer_id": 40617027, "question_id": 40615989, "link": "https://stackoverflow.com/questions/40615989/ruby-convert-single-backslash-unicode-to-double-backslash/40617027#40617027", "title": "Ruby - convert single backslash unicode to double backslash", "body": "<p>If the goal is to find instances of '\\u' not preceded by a '\\' character, then a negative lookbehind should suit the need to match:</p>\n\n<pre><code>(?&lt;!\\\\)\\\\u\n</code></pre>\n\n<p>If you want to match the whole character, then you can also use a positive lookahead to verify the following characters:</p>\n\n<pre><code>(?&lt;!\\\\)\\\\u(?=[0-9A-Z]{4})\n</code></pre>\n\n<p>Both of these will return the instances of '\\u', which you can replace with '\\\\u'</p>\n"}], "owner": {"reputation": 428, "user_id": 2034926, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cbb54874265d38c043401735f9a9ee1d?s=128&d=identicon&r=PG", "display_name": "Hank-Roughknuckles", "link": "https://stackoverflow.com/users/2034926/hank-roughknuckles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1479234097, "creation_date": 1479230523, "question_id": 40615989, "link": "https://stackoverflow.com/questions/40615989/ruby-convert-single-backslash-unicode-to-double-backslash", "title": "Ruby - convert single backslash unicode to double backslash", "body": "<p>I have a string that looks something like <code>'\\\\u001E\\\\u001Csome_text\\u001F'</code> - where the first two characters are escaped with two backslashes and the last one only has one backslash.</p>\n\n<p>I want to convert that string so that all the unicode literals have two backslashes in them, so the output would look like <code>'\\\\u001E\\\\u001Csome_text\\\\u001F'</code>.  What ways could I go about doing this?</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 4047, "user_id": 3775217, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/G0bqn.jpg?s=128&g=1", "display_name": "user3775217", "link": "https://stackoverflow.com/users/3775217/user3775217"}, "edited": false, "score": 0, "creation_date": 1479233601, "post_id": 40616763, "comment_id": 68467729, "body": "yes @Macelo Risoli - it worked, thanks. So this means i have  to translate the result if i am doing this query in controller to return response back to client(browser), building another hash by iterating through a loop"}, {"owner": {"reputation": 4047, "user_id": 3775217, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/G0bqn.jpg?s=128&g=1", "display_name": "user3775217", "link": "https://stackoverflow.com/users/3775217/user3775217"}, "edited": false, "score": 0, "creation_date": 1479239797, "post_id": 40616763, "comment_id": 68471239, "body": "first answer - last para <a href=\"http://stackoverflow.com/questions/19175084/activerecord-query-through-multiple-joins\" title=\"activerecord query through multiple joins\">stackoverflow.com/questions/19175084/&hellip;</a>"}], "tags": [], "owner": {"reputation": 717, "user_id": 1064380, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/32580804f6456560f81f199391cf6c40?s=128&d=identicon&r=PG", "display_name": "Marcelo Risoli", "link": "https://stackoverflow.com/users/1064380/marcelo-risoli"}, "is_accepted": true, "score": 1, "last_activity_date": 1479233183, "creation_date": 1479233183, "answer_id": 40616763, "question_id": 40615861, "link": "https://stackoverflow.com/questions/40615861/rails-5-activerecord-association-query/40616763#40616763", "title": "Rails 5 - Activerecord association query", "body": "<p>It depends on what you want to do, if you want to display the username next to the comment, Mert B.'s answer is fine, all you have to do is <code>include(:user)</code> and the users from the comment list will be fetched along when you do something like this:</p>\n\n<pre><code>comments_list = Comment.where(:post_id =&gt; post_id, :is_delete =&gt; false).joins(:user).select('comments.*,users.*')\ncomments_list.each do |comment|\n  puts \"#{comment.text} by #{comment.user.name}\"\nend\n</code></pre>\n\n<p>Or maybe if you want only users who have at least one comment, you can always select users from the user_ids on the comments table:</p>\n\n<pre><code>User.where(id: Comment.select(:user_id))\n</code></pre>\n"}], "owner": {"reputation": 4047, "user_id": 3775217, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/G0bqn.jpg?s=128&g=1", "display_name": "user3775217", "link": "https://stackoverflow.com/users/3775217/user3775217"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "accepted_answer_id": 40616763, "answer_count": 1, "score": 0, "last_activity_date": 1479233183, "creation_date": 1479230159, "question_id": 40615861, "link": "https://stackoverflow.com/questions/40615861/rails-5-activerecord-association-query", "title": "Rails 5 - Activerecord association query", "body": "<p>I have two models associated with each other as follows.</p>\n\n<pre><code>class Comment &lt; ApplicationRecord \n    belongs_to :user\nend\n\nclass User &lt; ActiveRecord::Base\n    has_many :comments\nend\n</code></pre>\n\n<p>Following record query </p>\n\n<pre><code>comments_list = Comment.where(:post_id =&gt; post_id, :is_delete =&gt; false).joins(:user).select('comments.*,users.*')\n</code></pre>\n\n<p>Generates the following mysql query in logger</p>\n\n<pre><code>SELECT comments.*,users.* FROM `comments` INNER JOIN `users` ON `users`.`id` = `comments`.`user_id` WHERE `comments`.`post_id` = '81' AND `comments`.`is_delete` = 0.\n</code></pre>\n\n<p>This seems generating very ligitimate query, but comments_list object contain columns only from comments table.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "jekyll"], "comments": [{"owner": {"reputation": 3041, "user_id": 2634781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G2fQO.jpg?s=128&g=1", "display_name": "RobertKenny", "link": "https://stackoverflow.com/users/2634781/robertkenny"}, "edited": false, "score": 0, "creation_date": 1479378247, "post_id": 40615622, "comment_id": 68535962, "body": "Can you post all of your config file? The first error should be fixed by changing <code>use_coderay: enable_coderay</code> to <code>enable_coderay: true</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2877, "user_id": 854084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72b329e9d54944ab1970b95ce54d59a2?s=128&d=identicon&r=PG", "display_name": "Simon K. Gerges", "link": "https://stackoverflow.com/users/854084/simon-k-gerges"}, "edited": false, "score": 1, "creation_date": 1488265563, "post_id": 42502170, "comment_id": 72142622, "body": "Add more desc text please"}], "tags": [], "owner": {"reputation": 1, "user_id": 6255668, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kv5USQ4XpPw/AAAAAAAAAAI/AAAAAAAAAB0/ltjQy2dhR5k/photo.jpg?sz=128", "display_name": "ethan liao", "link": "https://stackoverflow.com/users/6255668/ethan-liao"}, "is_accepted": false, "score": -1, "last_activity_date": 1488269149, "last_edit_date": 1488269149, "creation_date": 1488265221, "answer_id": 42502170, "question_id": 40615622, "link": "https://stackoverflow.com/questions/40615622/kramdown-coderay-syntax-highlighter-on-jekyll-ruby/42502170#42502170", "title": "kramdown coderay syntax_highlighter on jekyll ruby", "body": "<pre><code>enable_coderay         : true  \nsyntax_highlighter     : coderay  \nsyntax_highlighter_opts: {}  \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6792, "user_id": 102675, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/efd2bd4aad1e1e7e5c04d677e35c31c8?s=128&d=identicon&r=PG", "display_name": "Simon Woodside", "link": "https://stackoverflow.com/users/102675/simon-woodside"}, "edited": false, "score": 0, "creation_date": 1490935900, "post_id": 42503176, "comment_id": 73343208, "body": "You have not provided any specific solution."}], "tags": [], "owner": {"reputation": 1647, "user_id": 5288679, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e3bbfac63b9eb282c2533f3881eb179b?s=128&d=identicon&r=PG&f=1", "display_name": "SACn", "link": "https://stackoverflow.com/users/5288679/sacn"}, "is_accepted": false, "score": -1, "last_activity_date": 1488268786, "creation_date": 1488268786, "answer_id": 42503176, "question_id": 40615622, "link": "https://stackoverflow.com/questions/40615622/kramdown-coderay-syntax-highlighter-on-jekyll-ruby/42503176#42503176", "title": "kramdown coderay syntax_highlighter on jekyll ruby", "body": "<p>Use <code>syntax_highlighter: rouge</code> as error clearly says <em>kramdown.coderay</em> is deprecated:</p>\n\n<p><code>Deprecation: You are using 'kramdown.coderay' in your configuration, please use 'syntax_highlighter_opts' instead.</code></p>\n"}], "owner": {"reputation": 21, "user_id": 6330020, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154195473724187/picture?type=large", "display_name": "Zash Garcia", "link": "https://stackoverflow.com/users/6330020/zash-garcia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 479, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1488269149, "creation_date": 1479229383, "question_id": 40615622, "link": "https://stackoverflow.com/questions/40615622/kramdown-coderay-syntax-highlighter-on-jekyll-ruby", "title": "kramdown coderay syntax_highlighter on jekyll ruby", "body": "<p>I am doing <strong>jekyll serve</strong> and there are red marks.\nHow will I make these disappear:</p>\n\n<pre><code>Deprecation: Please change 'use_coderay' to 'enable_coderay' in your configuration file.\n\nDeprecation: You are using 'kramdown.coderay' in your configuration, please use 'syntax_highlighter_opts' instead.\n</code></pre>\n\n<p>In my config file, I already have these lines:</p>\n\n<pre><code>kramdown:\n  auto_ids: true\n  footnote_nr: 1\n  entity_output: as_char\n  toc_levels: 1..6\n  use_coderay: enable_coderay\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "pdf", "prawn"], "comments": [{"owner": {"reputation": 1718, "user_id": 2144445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14196c924af54a8bcaf08e5ca40048b3?s=128&d=identicon&r=PG", "display_name": "inye", "link": "https://stackoverflow.com/users/2144445/inye"}, "edited": false, "score": 0, "creation_date": 1479246350, "post_id": 40615621, "comment_id": 68474710, "body": "and which method  <code>calculators_path</code> use?"}, {"owner": {"reputation": 368, "user_id": 5551783, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/a0563cadf3b442404916d100d95a7f90?s=128&d=identicon&r=PG&f=1", "display_name": "dgreen22", "link": "https://stackoverflow.com/users/5551783/dgreen22"}, "reply_to_user": {"reputation": 1718, "user_id": 2144445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14196c924af54a8bcaf08e5ca40048b3?s=128&d=identicon&r=PG", "display_name": "inye", "link": "https://stackoverflow.com/users/2144445/inye"}, "edited": false, "score": 0, "creation_date": 1479258371, "post_id": 40615621, "comment_id": 68478881, "body": "@inye It connects to <code>index.pdf.prawn</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1718, "user_id": 2144445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14196c924af54a8bcaf08e5ca40048b3?s=128&d=identicon&r=PG", "display_name": "inye", "link": "https://stackoverflow.com/users/2144445/inye"}, "edited": false, "score": 0, "creation_date": 1479479773, "post_id": 40624261, "comment_id": 68589088, "body": "this is the solution?"}], "tags": [], "owner": {"reputation": 368, "user_id": 5551783, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/a0563cadf3b442404916d100d95a7f90?s=128&d=identicon&r=PG&f=1", "display_name": "dgreen22", "link": "https://stackoverflow.com/users/5551783/dgreen22"}, "is_accepted": true, "score": 0, "last_activity_date": 1479271677, "creation_date": 1479271677, "answer_id": 40624261, "question_id": 40615621, "link": "https://stackoverflow.com/questions/40615621/ruby-on-rails-calculation-results-prawn-pdf-generator/40624261#40624261", "title": "Ruby on Rails calculation results + Prawn PDF Generator", "body": "<p>My controller was the problem.  Needed to add a line to <code>render :index</code></p>\n\n<p>So new controller is: </p>\n\n<pre><code>class CalculatorsController &lt; ApplicationController\n\n    def new\n        @result = Calculator.to_celsius(params[:fahrenheit])\n        @square = Calculator.square_foot(params[:length], params[:width])\n        render :index\n    end\n\n    def index\n    end    \n\n\nend\n</code></pre>\n"}], "owner": {"reputation": 368, "user_id": 5551783, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/a0563cadf3b442404916d100d95a7f90?s=128&d=identicon&r=PG&f=1", "display_name": "dgreen22", "link": "https://stackoverflow.com/users/5551783/dgreen22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 40624261, "answer_count": 1, "score": 0, "last_activity_date": 1479271677, "creation_date": 1479229383, "last_edit_date": 1479258277, "question_id": 40615621, "link": "https://stackoverflow.com/questions/40615621/ruby-on-rails-calculation-results-prawn-pdf-generator", "title": "Ruby on Rails calculation results + Prawn PDF Generator", "body": "<p>I'm using <code>Prawn</code> to generator PDFs.  I've created a basic <code>index</code> view that does some simple calculations and displays the answers when submit button is pressed. </p>\n\n<p>Problem is, I can't figure out how to take these answers and have them exported to Prawn.  When I send it to Prawn, it resets the values inputted into the calculator to zero, so it shows the same value no matter what and not the calculated answer displayed.  MVC below.  Really appreciate any help.  </p>\n\n<p>Model</p>\n\n<pre><code>class Calculator &lt; ApplicationRecord\n\n    def self.to_celsius(fahrenheit)\n        (fahrenheit.to_i - 30) / 2\n    end\n\n    def self.square_foot(a,b)\n        a.to_i * b.to_i\n    end\nend\n</code></pre>\n\n<p>Controller</p>\n\n<pre><code>class CalculatorsController &lt; ApplicationController\n\n    def new\n        @result = Calculator.to_celsius(params[:fahrenheit])\n        @square = Calculator.square_foot(params[:length], params[:width])\n    end\n\n    def index\n        @result = Calculator.to_celsius(params[:fahrenheit])\n        @square = Calculator.square_foot(params[:length], params[:width])\n    end\n\n\nend\n</code></pre>\n\n<p>Views/index.html.erb</p>\n\n<pre><code>&lt;div class=\"row\"&gt;\n    &lt;div class=\"col-md-8 col-md-offset-2 calculations\"&gt;\n        &lt;%= form_for :calculators, url: { action: :new },method: :get do |f|   %&gt;\n\n          &lt;p&gt; Convert Celsius to Fahrenheit: &lt;/p&gt;\n          &lt;%= label_tag :fahrenheit, \"Enter Fahrenheit\", class: \"input-a\" %&gt;\n          &lt;%= text_field_tag :fahrenheit, params[:fahrenheit] %&gt;\n\n          &lt;p&gt; Square Footage Calculator: &lt;/p&gt;         \n          &lt;%= label_tag :length, \"Enter length ft\", class: \"input-a\" %&gt;\n          &lt;%= text_field_tag :length, params[:length] %&gt;\n\n          &lt;%= label_tag :width, \"Enter width ft\", class: \"input-a\" %&gt;\n          &lt;%= text_field_tag :width, params[:width] %&gt;\n\n          &lt;%= f.submit 'Calculate!' %&gt;\n        &lt;% end %&gt;\n\n        &lt;% unless @result.nil? %&gt;\n          This is &lt;p&gt; = &lt;%= @result %&gt; degrees celsius! &lt;/p&gt;\n        &lt;% end %&gt;\n        &lt;p&gt;&lt;%= link_to \"Create PDF\", calculators_path(:format =&gt; 'pdf') %&gt;&lt;/p&gt;\n    &lt;/div&gt;\n&lt;/div&gt;  \n</code></pre>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "if-statement", "erb"], "comments": [{"owner": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "edited": false, "score": 7, "creation_date": 1479228724, "post_id": 40615372, "comment_id": 68464789, "body": "You need to understand the difference between server-side code and client-side code.  You can&#39;t do that."}, {"owner": {"reputation": 139, "user_id": 6500179, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/20bc7d28d1d8f95e9b8e09dde2be4500?s=128&d=identicon&r=PG&f=1", "display_name": "user6500179", "link": "https://stackoverflow.com/users/6500179/user6500179"}, "reply_to_user": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "edited": false, "score": 0, "creation_date": 1479228976, "post_id": 40615372, "comment_id": 68464973, "body": "@SLaks I&#39;m sorry, but could you please elaborate of what you mean? I want to output a difference flash message depending on my response."}], "answers": [{"tags": [], "owner": {"reputation": 1962, "user_id": 2945616, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TL0yY.jpg?s=128&g=1", "display_name": "Atul Khanduri", "link": "https://stackoverflow.com/users/2945616/atul-khanduri"}, "is_accepted": false, "score": 1, "last_activity_date": 1479231784, "creation_date": 1479231784, "answer_id": 40616356, "question_id": 40615372, "link": "https://stackoverflow.com/questions/40615372/if-else-statement-appears-to-run-both/40616356#40616356", "title": "if else statement appears to run both", "body": "<p>Any <code>ruby</code> code (obviously inside ruby tag) inside <code>javascript</code> will always be executed, irrespective of the <code>if</code> condition.</p>\n\n<p>Rather you can set the <code>flash</code> message in controller or if you want to show the error/success message in current page, then use JS code instead like\n<code>$(your-element).text(\"your-text\")</code></p>\n"}, {"comments": [{"owner": {"reputation": 139, "user_id": 6500179, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/20bc7d28d1d8f95e9b8e09dde2be4500?s=128&d=identicon&r=PG&f=1", "display_name": "user6500179", "link": "https://stackoverflow.com/users/6500179/user6500179"}, "edited": false, "score": 0, "creation_date": 1479239169, "post_id": 40616566, "comment_id": 68470873, "body": "very well said. thank you so much! that makes it so much more clear"}], "tags": [], "owner": {"reputation": 3894, "user_id": 1121568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13eedc2642303b1a2251a4da7f157e?s=128&d=identicon&r=PG", "display_name": "Steven Schobert", "link": "https://stackoverflow.com/users/1121568/steven-schobert"}, "is_accepted": true, "score": 1, "last_activity_date": 1479232522, "creation_date": 1479232522, "answer_id": 40616566, "question_id": 40615372, "link": "https://stackoverflow.com/questions/40615372/if-else-statement-appears-to-run-both/40616566#40616566", "title": "if else statement appears to run both", "body": "<p>Since ERB is always going to get interpolated <em>before</em> it's sent to the browser, your browser is basically going to see this:</p>\n\n<pre><code>if(response.duplicate === \"true\") {\n} else {\n}\n</code></pre>\n\n<p>And your server is going to see this:</p>\n\n<pre><code>flash.now[:alert]= 'This Addressi Is Already In Your Cart Or In Your Report Section.'\nflash.now[:notice]= 'Searchs result is added to your cart'\n</code></pre>\n\n<p>This basically means your server will always run <strong>both</strong> of those <code>flash</code> lines.</p>\n\n<p>What you'll need to do, is move everything into the JS file without ERB's help, and manually set the flash text there.</p>\n\n<p>For example, lets say you have the following markup on your page somewhere, that will be the \"placeholder\" for the flash text:</p>\n\n<pre><code>&lt;div id=\"flash\"&gt;&lt;/div&gt;\n</code></pre>\n\n<p>Then in JavaScript, you'll just set the text manually:</p>\n\n<pre><code>$(\"&lt;%= j render(:partial =&gt; 'layouts/messages') %&gt;\").insertBefore('form')[0];\n\n$.ajax({\n  url: '/purchases/options',\n  method: 'post',\n  dataType: 'json',\n  data: data\n}).done(function(response){\n  if (response.duplicate === \"true\") {\n    $(\"#flash\").text(\"This Addressi Is Already In Your Cart Or In Your Report Section.\");\n    $(\"#flash\").addClass(\"alert\");\n  } else{\n    $(\"#flash\").text(\"Searchs result is added to your cart\");\n    $(\"#flash\").addClass(\"notice\");\n  }\n});\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 6500179, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/20bc7d28d1d8f95e9b8e09dde2be4500?s=128&d=identicon&r=PG&f=1", "display_name": "user6500179", "link": "https://stackoverflow.com/users/6500179/user6500179"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 40616566, "answer_count": 2, "score": 0, "last_activity_date": 1479232522, "creation_date": 1479228616, "question_id": 40615372, "link": "https://stackoverflow.com/questions/40615372/if-else-statement-appears-to-run-both", "title": "if else statement appears to run both", "body": "<p>In my js erb file, both of my flash message is showing when only one should be. The ajax runs fine and my response is what it is supposed to be. However, for some reason, my flash message takes on the message in both the if and else statement. I put a debugger right before the if statement to test my response and it should've evaluated to true.</p>\n\n<pre><code>$.ajax({\n            url: '/purchases/options',\n            method: 'post',\n            dataType: 'json',\n            data: data\n            }).done(function(response){\n                if(response.duplicate === \"true\"){\n                    &lt;% flash.now[:alert]= 'This Addressi Is Already In Your Cart Or In Your Report Section.' %&gt;\n                }\n                else{\n\n                    &lt;% flash.now[:notice]= 'Searchs result is added to your cart' %&gt;\n                }\n           });\n    $(\"&lt;%= j render(:partial =&gt; 'layouts/messages') %&gt;\").insertBefore('form')[0];\n</code></pre>\n"}, {"tags": ["c++", "c", "ruby", "bitcoin", "ffi"], "answers": [{"comments": [{"owner": {"reputation": 772, "user_id": 1458227, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/yxUI0.png?s=128&g=1", "display_name": "NamNamNam", "link": "https://stackoverflow.com/users/1458227/namnamnam"}, "edited": false, "score": 0, "creation_date": 1547268823, "post_id": 40615591, "comment_id": 95144252, "body": "<code>.&#47;configure --enable-module-recovery</code> work for me, Thanks!"}], "tags": [], "owner": {"reputation": 2362, "user_id": 1459901, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Uc6uH.jpg?s=128&g=1", "display_name": "Cisplatin", "link": "https://stackoverflow.com/users/1459901/cisplatin"}, "is_accepted": true, "score": 4, "last_activity_date": 1479229283, "creation_date": 1479229283, "answer_id": 40615591, "question_id": 40615330, "link": "https://stackoverflow.com/questions/40615330/ruby-ffi-not-finding-certain-functions/40615591#40615591", "title": "Ruby FFI not finding certain functions?", "body": "<p>It ends up the <code>secp256k1_recovery.h</code> file is only included if you specify that when building the libsecp256k1 library. Specifically, I needed to run <code>./configure --enable-module-recovery</code> instead of <code>./configure</code>.</p>\n"}], "owner": {"reputation": 2362, "user_id": 1459901, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Uc6uH.jpg?s=128&g=1", "display_name": "Cisplatin", "link": "https://stackoverflow.com/users/1459901/cisplatin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 1, "accepted_answer_id": 40615591, "answer_count": 1, "score": 4, "last_activity_date": 1479229283, "creation_date": 1479228481, "question_id": 40615330, "link": "https://stackoverflow.com/questions/40615330/ruby-ffi-not-finding-certain-functions", "title": "Ruby FFI not finding certain functions?", "body": "<p>I'm trying to use Ruby's FFI library to link functions from the <a href=\"https://github.com/bitcoin-core/secp256k1/blob/master\" rel=\"nofollow noreferrer\">bitcoin-core secp256k1 library</a>.</p>\n\n<p>To make the <a href=\"https://github.com/bitcoin-core/secp256k1/blob/master/include/secp256k1.h#L453\" rel=\"nofollow noreferrer\">secp256k1_ecdsa_sign</a> function accessible, I built libsecp256k1 using autotools (as directed in <a href=\"https://github.com/bitcoin-core/secp256k1#build-steps\" rel=\"nofollow noreferrer\">README.md</a>). Then I created a shared object to use in FFI by running <code>g++ -shared secp256k1/src/.libs/libsecp256k1_la-secp256k1.o</code>. Importing this into my Ruby file using FFI let me use the function and everything worked perfectly.</p>\n\n<p>I'm trying to do the exact same with the <a href=\"https://github.com/bitcoin-core/secp256k1/blob/master/include/secp256k1_recovery.h#L81\" rel=\"nofollow noreferrer\">secp256k1_ecdsa_sign_recoverable</a> function, which is in the same C project, just a different header file. However, I get the error <code>Function 'secp256k1_ecdsa_sign_recoverable' not found in [bin/secp256k1.so] (FFI::NotFoundError)</code>.</p>\n\n<p>I think this is either because I'm not creating the shared object properly (created with the aforementioned <code>g++</code> command), or because this function is for some reason not a public-facing one in the C project (though I don't know enough about C to know how to figure out if this is the case).</p>\n\n<p>If someone could help me figure out how to use this function it would be greatly appreciated.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "rubygems"], "comments": [{"owner": {"reputation": 1599, "user_id": 617090, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/66NEM.jpg?s=128&g=1", "display_name": "kcdragon", "link": "https://stackoverflow.com/users/617090/kcdragon"}, "edited": false, "score": 0, "creation_date": 1479228001, "post_id": 40614820, "comment_id": 68464308, "body": "Does your <code>User</code> model have a method called <code>unsubscribe_hash</code>? It might help to post your <code>User</code> model as well since that is where the method is not being found."}, {"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "reply_to_user": {"reputation": 1599, "user_id": 617090, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/66NEM.jpg?s=128&g=1", "display_name": "kcdragon", "link": "https://stackoverflow.com/users/617090/kcdragon"}, "edited": false, "score": 0, "creation_date": 1479229063, "post_id": 40614820, "comment_id": 68465044, "body": "@kcdragon I have added my <code>User</code> model too"}], "answers": [{"comments": [{"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1479229576, "post_id": 40615642, "comment_id": 68465413, "body": "even with this <code>@user = User.find_by_unsubscribe_hash(params[:unsubscribe_hash])</code> I get the same error. And whenever I try to do a workaround on it and use it as you suggested, I get <code>no implicit conversion of Symbol into Integer</code> error"}, {"owner": {"reputation": 1756, "user_id": 295671, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0fc94068a4be0dd57d34a223722f2690?s=128&d=identicon&r=PG", "display_name": "james246", "link": "https://stackoverflow.com/users/295671/james246"}, "reply_to_user": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1479230315, "post_id": 40615642, "comment_id": 68465880, "body": "Have a look and check your <code>params[:unsubscribe_hash]</code> is the value you are submitting from the form, and that there is indeed a <code>User</code> in your database with that <code>unsubscribe_hash</code> value"}, {"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1479230890, "post_id": 40615642, "comment_id": 68466253, "body": "YES it is the value. From all you said and explained which I have implemented, I now get <code>I get no implicit conversion of Symbol into Integer</code> error"}], "tags": [], "owner": {"reputation": 1756, "user_id": 295671, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0fc94068a4be0dd57d34a223722f2690?s=128&d=identicon&r=PG", "display_name": "james246", "link": "https://stackoverflow.com/users/295671/james246"}, "is_accepted": false, "score": 1, "last_activity_date": 1479229433, "creation_date": 1479229433, "answer_id": 40615642, "question_id": 40614820, "link": "https://stackoverflow.com/questions/40614820/nomethoderror-in-usersunsubscribe/40615642#40615642", "title": "NoMethodError in Users#unsubscribe", "body": "<p>You get that error because <code>@user</code> (set in <code>UsersController#unsubscribe</code>) is <code>nil</code>. That is what the \"for nil:NilClass\" in <code>undefined method</code>unsubscribe_hash' for nil:NilClass` is referring to.</p>\n\n<p>This method doesn't seem correct:</p>\n\n<pre><code>def unsubscribe\n  user = User.find_by_unsubscribe_hash(params[:unsubscribe_hash])\n  @user = User.find_by_unsubscribe_hash(user)\nend\n</code></pre>\n\n<p>You are looking up a user by <code>unsubscribe_hash</code> and assigning it to <code>user</code>, and then looking up user by <code>unsubscribe_hash</code> again but passing in <code>user</code> as the value to <code>find_by_unsubscribe_hash</code>.</p>\n\n<p>I believe something like this is more as intended:</p>\n\n<pre><code>def unsubscribe\n  @user = User.find_by_unsubscribe_hash(params[:unsubscribe_hash])\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1479231135, "post_id": 40615832, "comment_id": 68466404, "body": "Thanks, well, I have refactored my unsubscribe action such that I have <code>@user = User.find_by_unsubscribe_hash(params[:unsubscribe_hash])</code>, however it leaves me with a new error saying <code>no implicit conversion of Symbol into Integer</code>"}, {"owner": {"reputation": 3180, "user_id": 4659816, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/5TNaW.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/4659816/david"}, "reply_to_user": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1479231225, "post_id": 40615832, "comment_id": 68466471, "body": "read my solution again, i have made updates ... you need to investigate what is calling your action ... you didn&#39;t include that in your question. You might find using a debugger useful in situation like this too."}, {"owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1479234959, "post_id": 40615832, "comment_id": 68468452, "body": "i have updated what calls the unsubscribe action which is in the mailer"}, {"owner": {"reputation": 3180, "user_id": 4659816, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/5TNaW.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/4659816/david"}, "reply_to_user": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "edited": false, "score": 0, "creation_date": 1479287625, "post_id": 40615832, "comment_id": 68489231, "body": "i think that link should be: <code>&lt;%= link_to &quot;Unsubscribe&quot;, unsubscribe_url(unsubscribe_hash: @unsubscribe) %&gt;</code>, but I have to admit I&#39;m a little confused by your screenshot - looking at that it does look like you are receiving the correct params. Worth checking your database just as a sanity check too, to ensure that unsubscribe_hash column exists."}], "tags": [], "owner": {"reputation": 3180, "user_id": 4659816, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/5TNaW.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/4659816/david"}, "is_accepted": false, "score": 1, "last_activity_date": 1479230847, "last_edit_date": 1479230847, "creation_date": 1479230078, "answer_id": 40615832, "question_id": 40614820, "link": "https://stackoverflow.com/questions/40614820/nomethoderror-in-usersunsubscribe/40615832#40615832", "title": "NoMethodError in Users#unsubscribe", "body": "<p>Whenever you see any error messages in ruby of the format:</p>\n\n<pre><code>undefined method 'method_name' for nil:NilClass\n</code></pre>\n\n<p>you are being told you are trying to call something on a nil object and so the focus of your attention should be on why is that object nil. You are also told in your log where the error occurs - in your case it refers to the line, which refers to <code>@user</code> in <code>@user.unsubscribe_hash</code> in your form declaration.</p>\n\n<p>So <code>@user</code> is nil and in this case it's nil because your controller responsible for rendering the form isn't setting <code>@user</code>:</p>\n\n<pre><code>user = User.find_by_unsubscribe_hash(params[:unsubscribe_hash])\n@user = User.find_by_unsubscribe_hash(user)\n</code></pre>\n\n<p>Now quite why you are attempting to find the user and then pass that user into the second line to find <code>@user</code> is beyond me, but anyway the real issue is that you have no user that matches <code>params[:unsubscribe_hash]</code></p>\n\n<p>So the issue is related to whatever is invoking your unsubscribe action ... you have neglected to add that to your question so I cannot help with that but that is where your focus start.</p>\n"}], "owner": {"reputation": 1560, "user_id": 5614748, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10153324566173505/picture?type=large", "display_name": "Afolabi Olaoluwa Akinwumi", "link": "https://stackoverflow.com/users/5614748/afolabi-olaoluwa-akinwumi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1479247483, "creation_date": 1479226942, "last_edit_date": 1479247483, "question_id": 40614820, "link": "https://stackoverflow.com/questions/40614820/nomethoderror-in-usersunsubscribe", "title": "NoMethodError in Users#unsubscribe", "body": "<p>I am working on implementing unsubscribe link to my rails mailer. Unfortunately, my code breaks with this:</p>\n\n<blockquote>\n  <p>NoMethodError in Users#unsubscribe - undefined method `unsubscribe_hash' for nil:NilClass</p>\n</blockquote>\n\n<p>which points to <em>/app/views/users/unsubscribe.html.erb</em> line #3</p>\n\n<pre><code>&lt;h4&gt;Unsubscribe from Mysite Emails&lt;/h4&gt;\n&lt;p&gt;By unsubscribing, you will no longer receive email...&lt;/p&gt;\n&lt;%= simple_form_for(@user, unsubscribe_path(id: @user.unsubscribe_hash)) do |f| %&gt;\n    &lt;%= f.hidden_field(:subscription, value: false) %&gt;\n    &lt;%= f.submit 'Unsubscribe' %&gt;\n    &lt;%= link_to 'Cancel', root_url %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>my user_controller is as shown below</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n  protect_from_forgery\n\n  def new\n    @user = User.new\n  end\n\n  def create\n    @user = User.new(secure_params)\n    if @user.save\n      flash[:notice] = \"Thanks! You have subscribed #{@user.email} for Jobs Alert.\"\n    else\n      flash[:notice] = 'Error Subscribing! Kindly check your email and try again.'\n    end\n    redirect_to root_path\n  end\n\n  def unsubscribe\n    user = User.find_by_unsubscribe_hash(params[:unsubscribe_hash])\n    @user = User.find_by_unsubscribe_hash(user)\n  end\n\n  def update\n    @user = User.find(params[:id])\n    if @user.update(secure_params)\n      flash[:notice] = 'Subscription Cancelled'\n      redirect_to root_url\n    else\n      flash[:alert] = 'There was a problem'\n      render :unsubscribe\n    end\n  end\n\n  private\n\n  def secure_params\n    params.require(:user).permit(:email, :subscription)\n  end\n\nend\n</code></pre>\n\n<p>Route.rb</p>\n\n<pre><code>  resources :users, only: [:new, :create]\n  get 'users/:unsubscribe_hash/unsubscribe' =&gt; 'users#unsubscribe', as: :unsubscribe\n  patch 'users/update'\n</code></pre>\n\n<p>user.rb</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n\n  before_create :add_unsubscribe_hash, :add_true_to_users_table\n\n  validates :email, :uniqueness =&gt; true\n  validates_presence_of :email\n  validates_format_of :email, :with =&gt; /\\A[-a-z0-9_+\\.]+\\@([-a-z0-9]+\\.)+[a-z0-9]{2,4}\\z/i\n\n  private\n\n  def add_unsubscribe_hash\n    self.unsubscribe_hash = SecureRandom.hex\n  end\n\n  def add_true_to_users_table\n    self.subscription = true\n  end\n\nend\n</code></pre>\n\n<p>unsubscribe link in the email which calls unsubscribe action</p>\n\n<pre><code># app/views/job_notifier/send_post_email.html.erb\n...\n&lt;%= link_to \"Unsubscribe\", unsubscribe_url(id: @unsubscribe) %&gt;.\n</code></pre>\n\n<p>diagrammatic view of the error</p>\n\n<p><a href=\"https://i.stack.imgur.com/OoXPw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OoXPw.png\" alt=\"enter image description here\"></a></p>\n\n<p>Its seems that I am missing something, do I need to define something in my users_controller? I have never in my life being able to solve NoMethodError or I don't understand what it's all about.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "ruby-on-rails-4", "scope"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1479226661, "post_id": 40614678, "comment_id": 68463408, "body": "<code>scope :mybooking, -&gt;(current_user_id) { where user_id: current_user_id }</code>"}, {"owner": {"reputation": 1443, "user_id": 4064922, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-2_1oNmjkoec/AAAAAAAAAAI/AAAAAAAAAXE/OTUcRfaAZeM/photo.jpg?sz=128", "display_name": "Aboozar Rajabi", "link": "https://stackoverflow.com/users/4064922/aboozar-rajabi"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1479309724, "post_id": 40614678, "comment_id": 68503887, "body": "@mudasobwa It&#39;s not true! Check the question again!"}], "answers": [{"comments": [{"owner": {"reputation": 1443, "user_id": 4064922, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-2_1oNmjkoec/AAAAAAAAAAI/AAAAAAAAAXE/OTUcRfaAZeM/photo.jpg?sz=128", "display_name": "Aboozar Rajabi", "link": "https://stackoverflow.com/users/4064922/aboozar-rajabi"}, "edited": false, "score": 0, "creation_date": 1479286248, "post_id": 40614761, "comment_id": 68488389, "body": "I don&#39;t think that it works! The array is something like this: reservations = [[&quot;2&quot;,&quot;3&quot;], [&quot;3&quot;,&quot;1&quot;], [&quot;6&quot;, &quot;1&quot;]], how can it find the user ids in the first sub-element of the array? (2, 3, and 6 are user ids)"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 1443, "user_id": 4064922, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-2_1oNmjkoec/AAAAAAAAAAI/AAAAAAAAAXE/OTUcRfaAZeM/photo.jpg?sz=128", "display_name": "Aboozar Rajabi", "link": "https://stackoverflow.com/users/4064922/aboozar-rajabi"}, "edited": false, "score": 0, "creation_date": 1479286372, "post_id": 40614761, "comment_id": 68488465, "body": "@AboozarRajabi see the edit. Just map the array by first element (id) and pass the resulting array into the scope. Let me know whether it works for you"}, {"owner": {"reputation": 1443, "user_id": 4064922, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-2_1oNmjkoec/AAAAAAAAAAI/AAAAAAAAAXE/OTUcRfaAZeM/photo.jpg?sz=128", "display_name": "Aboozar Rajabi", "link": "https://stackoverflow.com/users/4064922/aboozar-rajabi"}, "edited": false, "score": 0, "creation_date": 1479286721, "post_id": 40614761, "comment_id": 68488656, "body": "Thanks but I don&#39;t understand how you pass the user_id to the scope?! Another problem is that I think you&#39;ll get error because you&#39;re using the reservations in the other controller! I think you don&#39;t have access to it."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 1443, "user_id": 4064922, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-2_1oNmjkoec/AAAAAAAAAAI/AAAAAAAAAXE/OTUcRfaAZeM/photo.jpg?sz=128", "display_name": "Aboozar Rajabi", "link": "https://stackoverflow.com/users/4064922/aboozar-rajabi"}, "edited": false, "score": 0, "creation_date": 1479286845, "post_id": 40614761, "comment_id": 68488729, "body": "@AboozarRajabi 1. You pass user_ids array, because <code>reservations.map(&amp;:first)</code> results in <code>[&quot;2&quot;, &quot;3&quot;, &quot;6&quot;]</code>. 2. I am not using <code>reservations</code> in any controller, it is you who use it and whose task to pass the <code>reservations</code> array correctly to the place, where you&#39;ll extract the user ids and pass to the scope :)"}, {"owner": {"reputation": 1443, "user_id": 4064922, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-2_1oNmjkoec/AAAAAAAAAAI/AAAAAAAAAXE/OTUcRfaAZeM/photo.jpg?sz=128", "display_name": "Aboozar Rajabi", "link": "https://stackoverflow.com/users/4064922/aboozar-rajabi"}, "edited": false, "score": 0, "creation_date": 1479287110, "post_id": 40614761, "comment_id": 68488893, "body": "Using reservations.map(...) results in this error: NameError (undefined local variable or method `passengers&#39; for #&lt;UsersController . It&#39;s because reservations that is for the Event controller is used in the User controller. Do you know how should I solve this?"}, {"owner": {"reputation": 1443, "user_id": 4064922, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-2_1oNmjkoec/AAAAAAAAAAI/AAAAAAAAAXE/OTUcRfaAZeM/photo.jpg?sz=128", "display_name": "Aboozar Rajabi", "link": "https://stackoverflow.com/users/4064922/aboozar-rajabi"}, "edited": false, "score": 0, "creation_date": 1479288101, "post_id": 40614761, "comment_id": 68489527, "body": "Do you have any idea?"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 1443, "user_id": 4064922, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-2_1oNmjkoec/AAAAAAAAAAI/AAAAAAAAAXE/OTUcRfaAZeM/photo.jpg?sz=128", "display_name": "Aboozar Rajabi", "link": "https://stackoverflow.com/users/4064922/aboozar-rajabi"}, "edited": false, "score": 0, "creation_date": 1479297631, "post_id": 40614761, "comment_id": 68495706, "body": "@AboozarRajabi I do not, because I don&#39;t know how you established your controllers, where <code>reservations</code> comes from etc.. Basically, you have just make sure to correctly pass the array to scope. That&#39;s it"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": false, "score": 2, "last_activity_date": 1479286349, "last_edit_date": 1479286349, "creation_date": 1479226728, "answer_id": 40614761, "question_id": 40614678, "link": "https://stackoverflow.com/questions/40614678/rails-how-to-use-scope-to-find-an-element-in-array-of-arrays/40614761#40614761", "title": "Rails: How to use scope to find an element in array of arrays", "body": "<pre><code>class Event\n  scope :mybooking, -&gt;(user_ids) { where(user_id: user_ids) }\nend\n</code></pre>\n\n<p>Now it is possible to do in controller:</p>\n\n<pre><code>reservations = [[\"2\",\"3\"], [\"3\",\"1\"], [\"6\", \"1\"]]\nEvent.mybooking(reservations.map(&amp;:first))\n</code></pre>\n"}], "owner": {"reputation": 1443, "user_id": 4064922, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-2_1oNmjkoec/AAAAAAAAAAI/AAAAAAAAAXE/OTUcRfaAZeM/photo.jpg?sz=128", "display_name": "Aboozar Rajabi", "link": "https://stackoverflow.com/users/4064922/aboozar-rajabi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1382, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1479309614, "creation_date": 1479226528, "last_edit_date": 1479309614, "question_id": 40614678, "link": "https://stackoverflow.com/questions/40614678/rails-how-to-use-scope-to-find-an-element-in-array-of-arrays", "title": "Rails: How to use scope to find an element in array of arrays", "body": "<p>I have an array of arrays like <code>[[\"2\",\"3\"], [\"3\",\"1\"], [\"6\", \"1\"]]</code>. The first element of each sub-array is the user ID and the second one is the number of seats the user reserved for an event. \nI want to allow each user to view his reservations by finding his ID in the array. Suppose that I have two models: User and Event. In the User controller, I want to use a scope like <code>@mybooking = Event.mybooking(current_user.id)</code> and the problem is how to write the proper scope in the Event model? \nAnd, if the user is found, I want to use its second element, too. </p>\n\n<p>I tried different solutions but didn't work! Let me know if you think it's not possible using the scope and if you have another kind of solution.</p>\n\n<p>Edit:\nAs I'm still waiting for a solution that works, I should mention that I'm looking for something like this:</p>\n\n<pre><code>scope :mybookings, -&gt;(id){where(\"reservations.to_enum.map{|n,m| n} ?\", id)}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>scope :mybookings, -&gt;(id) { where(\"reservations.map(&amp;:first) ?\", id) }\n</code></pre>\n\n<p>These two don't work because of the error I get related to \"....\" part. \nAnd, below solution isn't true because I'm calling the Event's scope from User controller and it's not possible to use <code>reservations</code> in that controller because this variable is for the Event controller.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "oauth-2.0", "google-api", "google-api-client"], "answers": [{"tags": [], "owner": {"reputation": 87, "user_id": 6771806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a313da5c7a8a9d167ce259cabf9a6a4a?s=128&d=identicon&r=PG", "display_name": "rudkovskyi", "link": "https://stackoverflow.com/users/6771806/rudkovskyi"}, "is_accepted": false, "score": 0, "last_activity_date": 1479235583, "last_edit_date": 1479235583, "creation_date": 1479234711, "answer_id": 40617205, "question_id": 40614386, "link": "https://stackoverflow.com/questions/40614386/get-googles-authentication-token-in-the-ruby-on-rails-application/40617205#40617205", "title": "Get Google&#39;s authentication_token in the Ruby on Rails application", "body": "<p>You just need to require a file </p>\n\n<pre><code>require 'google/api_client/auth/key_utils'\n</code></pre>\n\n<p>Only then you would be allowed calling a <code>Google::APIClient::KeyUtils</code>.</p>\n\n<p>You can notice in <a href=\"https://github.com/google/google-api-ruby-client\" rel=\"nofollow noreferrer\">the documentation</a> they require each class/module separately. </p>\n\n<p>It seems like gem does not load all of its dependencies itself, because of their ideology and just not to overload the application with redundant libraries that won't be used.</p>\n\n<p>Take a note, it is quite possible you will need to require some other libraries.</p>\n"}], "owner": {"reputation": 77, "user_id": 1635186, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/f9e61aa65074e4c81419c94af794af56?s=128&d=identicon&r=PG", "display_name": "Akash Shah", "link": "https://stackoverflow.com/users/1635186/akash-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479246136, "creation_date": 1479225730, "last_edit_date": 1479246136, "question_id": 40614386, "link": "https://stackoverflow.com/questions/40614386/get-googles-authentication-token-in-the-ruby-on-rails-application", "title": "Get Google&#39;s authentication_token in the Ruby on Rails application", "body": "<p>I want to use the Google API in my Rails application. For this, I need to authenticate to a Google Dev account to get the <code>authentication_token</code>.</p>\n\n<p>The best way to do it, in my opinion, is to use oauth2 library and examples provided in the documentation.</p>\n\n<p>As you see, I have tried to use <code>Google::APIClient</code> in there, although I am stuck with the following issue below</p>\n\n<p>In the console I get:</p>\n\n<pre><code>Google::APIClient::KeyUtils.load_from_pkcs12('file.p12', 'notasecret')\nNameError: uninitialized constant Google\n</code></pre>\n\n<p>I'm using following gems:</p>\n\n<pre><code>gem 'oauth2'\ngem 'omniauth'\ngem 'omniauth-google-oauth2'\ngem 'google-api-client'\n</code></pre>\n\n<p>Any suggestions? </p>\n"}]