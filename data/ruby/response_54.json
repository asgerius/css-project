[{"tags": ["ruby", "macos", "rubygems"], "comments": [{"owner": {"reputation": 116828, "user_id": 55075, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/8bbc94977312d285045b2412257b6cb8?s=128&d=identicon&r=PG", "display_name": "kenorb", "link": "https://stackoverflow.com/users/55075/kenorb"}, "edited": false, "score": 0, "creation_date": 1480103864, "post_id": 34912946, "comment_id": 68843515, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/17703510/dyld-library-not-loaded-reason-image-not-loaded\">dyld: Library not loaded ... Reason: Image not loaded</a>"}], "answers": [{"tags": [], "owner": {"reputation": 116828, "user_id": 55075, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/8bbc94977312d285045b2412257b6cb8?s=128&d=identicon&r=PG", "display_name": "kenorb", "link": "https://stackoverflow.com/users/55075/kenorb"}, "is_accepted": false, "score": 3, "last_activity_date": 1480104266, "last_edit_date": 1490005107, "creation_date": 1480103610, "answer_id": 40811569, "question_id": 34912946, "link": "https://stackoverflow.com/questions/34912946/how-to-fix-dyld-library-not-loaded-usr-local-opt-gmp-lib-libgmp-10-dylib-pe/40811569#40811569", "title": "How to fix &quot;dyld: Library not loaded: /usr/local/opt/gmp/lib/libgmp.10.dylib&quot; permanently for Ruby?", "body": "<p>You probably need to reinstall <code>ruby</code>, <code>gmp</code> and <code>rvm</code> packages to fix the broken dependencies, e.g.</p>\n\n<pre><code>brew reinstall gmp rvm ruby\n</code></pre>\n\n<p><sup>Consider running <code>brew update &amp;&amp; brew upgrade</code> before.</sup></p>\n\n<p>Then reinstall <code>ruby</code> as:</p>\n\n<pre><code>rvm reinstall 2.1.4 --with-opt-dir=$(brew --prefix gmp) --disable-binary\n</code></pre>\n\n<p>Then check by:</p>\n\n<pre><code>ruby -v\n</code></pre>\n\n<p>Make sure you're using the right <code>ruby</code> (check by: <code>which -a ruby</code>), if not, setup the right order for <code>PATH</code> variable in your startup shell scripts (e.g. <code>~/.bash_profile</code>).</p>\n\n<p>Also make sure you're not overriding any <code>DYLD_LIBRARY_PATH</code>, <code>DYLD_FALLBACK_LIBRARY_PATH</code> or <code>DYLD_FRAMEWORK_PATH</code> variables from the startup shell scripts (e.g. <code>~/.bash_profile</code>).</p>\n\n<p>Related: <a href=\"https://superuser.com/q/820364/87805\">Ruby installation issues with RVM</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 369, "user_id": 1194666, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/EybPW.jpg?s=128&g=1", "display_name": "Andreas K.", "link": "https://stackoverflow.com/users/1194666/andreas-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1597912520, "creation_date": 1597912520, "answer_id": 63501300, "question_id": 34912946, "link": "https://stackoverflow.com/questions/34912946/how-to-fix-dyld-library-not-loaded-usr-local-opt-gmp-lib-libgmp-10-dylib-pe/63501300#63501300", "title": "How to fix &quot;dyld: Library not loaded: /usr/local/opt/gmp/lib/libgmp.10.dylib&quot; permanently for Ruby?", "body": "<p>A reinstall did it for me as well:</p>\n<pre><code>brew reinstall gmp ruby\n</code></pre>\n"}], "owner": {"reputation": 866, "user_id": 5590856, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4b20918a34bb291a0bc12fe612b137aa?s=128&d=identicon&r=PG&f=1", "display_name": "user70848", "link": "https://stackoverflow.com/users/5590856/user70848"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4414, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1597912520, "creation_date": 1453334028, "last_edit_date": 1495541837, "question_id": 34912946, "link": "https://stackoverflow.com/questions/34912946/how-to-fix-dyld-library-not-loaded-usr-local-opt-gmp-lib-libgmp-10-dylib-pe", "title": "How to fix &quot;dyld: Library not loaded: /usr/local/opt/gmp/lib/libgmp.10.dylib&quot; permanently for Ruby?", "body": "<p>I updated my OS about 2 weeks ago, and since then I've been running into this issue:</p>\n\n<pre><code>&gt; ruby -v            \ndyld: Library not loaded: /usr/local/opt/gmp/lib/libgmp.10.dylib\n  Referenced from: /Users/me/.rvm/rubies/ruby-2.2.1/bin/ruby\n  Reason: image not found\n[1]    65487 trace trap  ruby -v\n</code></pre>\n\n<p>A solution found here (<a href=\"https://stackoverflow.com/questions/26555902/ruby-v-dyld-library-not-loaded-usr-local-lib-libgmp-10-dylib\">Ruby -v dyld: Library not loaded: /usr/local/lib/libgmp.10.dylib</a>) works for each terminal session, but not permanently. I am running OS 10.9.5.</p>\n\n<p>This is what works temporarily:</p>\n\n<pre><code>rvm reinstall 2.1.4\n</code></pre>\n\n<p>This has no effect, other than update homebrew:</p>\n\n<pre><code>brew update &amp;&amp; brew install gmp \n</code></pre>\n\n<p>How can I fix this permanently?</p>\n"}, {"tags": ["ruby", "middleman"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 2775442, "user_type": "registered", "profile_image": "https://graph.facebook.com/1279833612/picture?type=large", "display_name": "Anna Agafonova", "link": "https://stackoverflow.com/users/2775442/anna-agafonova"}, "is_accepted": false, "score": 1, "last_activity_date": 1454599457, "creation_date": 1454599457, "answer_id": 35204905, "question_id": 34912886, "link": "https://stackoverflow.com/questions/34912886/middleman-middleman-init-my-new-project-not-working-screenshot-attached/35204905#35204905", "title": "MIDDLEMAN: &quot;$ middleman init my_new_project&quot; not working (screenshot attached)", "body": "<p>What happens if you just run 'middleman init'? </p>\n\n<p>You can also try to create the Gemfile manually, if it's not getting created on the first step, then run init again. The default one would look like this:</p>\n\n<pre><code># If you do not have OpenSSL installed, update\n# the following line to use \"http://\" instead\nsource 'https://rubygems.org'\n\ngem \"middleman\", \"~&gt;3.4.1\"\n\n# Live-reloading plugin\ngem \"middleman-livereload\", \"~&gt; 3.3.0\"\n\n# For faster file watcher updates on Windows:\ngem \"wdm\", \"~&gt; 0.1.0\", :platforms =&gt; [:mswin, :mingw]\n\n# Windows does not come with time zone data\ngem \"tzinfo-data\", platforms: [:mswin, :mingw, :jruby]\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5399512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xHim9.png?s=128&g=1", "display_name": "Nika", "link": "https://stackoverflow.com/users/5399512/nika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1454599457, "creation_date": 1453333736, "question_id": 34912886, "link": "https://stackoverflow.com/questions/34912886/middleman-middleman-init-my-new-project-not-working-screenshot-attached", "title": "MIDDLEMAN: &quot;$ middleman init my_new_project&quot; not working (screenshot attached)", "body": "<p>I just installed Ruby and Middleman for the first time and I cannot get past the very first \"$ middleman init my_new_project\" step. I have tried Googling for solution to my problem but unfortunately I couldn't find anything that looks like the error I'm encountering.</p>\n\n<p>I hope someone can help me out.  </p>\n\n<p>OS: Windows 10 |\nRuby: 2.2.3 (x64) (tried Ruby 2.1.7 first) |\nMiddleman: 4.0.0</p>\n\n<p>This is the error message I'm getting when I try to create a new project in a folder I created to try out Middleman:</p>\n\n<pre><code>    run git clone --depth 1 git://github.com/middleman/middleman-templates-default.git C:/Users/Lenovo/AppData/Local/Temp/d20160120-1612-c2sqbk from \".\"\n    exist new_project_test\n      run bundle install from \".new_project_test\"\nCould not locate Gemfile or .bundle/ directory\n</code></pre>\n\n<p>This just creates an empty \"new_project_test\" folder.</p>\n\n<p>Screenshot of the command prompt: <a href=\"http://i.stack.imgur.com/tt9uS.png\" rel=\"nofollow\">middleman init not working</a> (<a href=\"http://imageshack.com/a/img903/6940/JQBsMv.png\" rel=\"nofollow\">alt. image link</a>)</p>\n"}, {"tags": ["html", "ruby-on-rails", "ruby", "server", "local"], "comments": [{"owner": {"reputation": 1868, "user_id": 1362453, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f8ac2cc7e4e38841fb52ea58b4bf06ef?s=128&d=identicon&r=PG", "display_name": "Leo Brito", "link": "https://stackoverflow.com/users/1362453/leo-brito"}, "edited": false, "score": 0, "creation_date": 1453332417, "post_id": 34912608, "comment_id": 57560771, "body": "<code>rails s</code> starts a local server"}, {"owner": {"reputation": 67, "user_id": 5431944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239fad4bb4dbe807611e3b0109c21b4a?s=128&d=identicon&r=PG", "display_name": "serhatcileri", "link": "https://stackoverflow.com/users/5431944/serhatcileri"}, "reply_to_user": {"reputation": 1868, "user_id": 1362453, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f8ac2cc7e4e38841fb52ea58b4bf06ef?s=128&d=identicon&r=PG", "display_name": "Leo Brito", "link": "https://stackoverflow.com/users/1362453/leo-brito"}, "edited": false, "score": 0, "creation_date": 1453332572, "post_id": 34912608, "comment_id": 57560831, "body": "Can you give more information please?"}, {"owner": {"reputation": 1868, "user_id": 1362453, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f8ac2cc7e4e38841fb52ea58b4bf06ef?s=128&d=identicon&r=PG", "display_name": "Leo Brito", "link": "https://stackoverflow.com/users/1362453/leo-brito"}, "edited": false, "score": 0, "creation_date": 1453332642, "post_id": 34912608, "comment_id": 57560866, "body": "In a terminal, navigate to the Rails project root folder, type <code>rails s</code> and press enter."}, {"owner": {"reputation": 67, "user_id": 5431944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239fad4bb4dbe807611e3b0109c21b4a?s=128&d=identicon&r=PG", "display_name": "serhatcileri", "link": "https://stackoverflow.com/users/5431944/serhatcileri"}, "reply_to_user": {"reputation": 1868, "user_id": 1362453, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f8ac2cc7e4e38841fb52ea58b4bf06ef?s=128&d=identicon&r=PG", "display_name": "Leo Brito", "link": "https://stackoverflow.com/users/1362453/leo-brito"}, "edited": false, "score": 0, "creation_date": 1453332997, "post_id": 34912608, "comment_id": 57560989, "body": "Thanks, i wasnt interested rails yet, i&#39;ll look up."}], "answers": [{"comments": [{"owner": {"reputation": 494, "user_id": 5510300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71826b78fc283ecc96174f4c6c65da9c?s=128&d=identicon&r=PG&f=1", "display_name": "Antiokus", "link": "https://stackoverflow.com/users/5510300/antiokus"}, "edited": false, "score": 1, "creation_date": 1453337881, "post_id": 34912856, "comment_id": 57562495, "body": "This definitely should be the accepted answer. It looks like OP is just introducing themselves to web stuff using ruby. Rails is a whole different beast, it&#39;s a little unnerving that the other answers/comments equate ruby with rails."}], "tags": [], "owner": {"reputation": 226, "user_id": 3150639, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9e0851cb042146f91c4a387a5b39c774?s=128&d=identicon&r=PG", "display_name": "Hailong Cao", "link": "https://stackoverflow.com/users/3150639/hailong-cao"}, "is_accepted": false, "score": 5, "last_activity_date": 1453333599, "creation_date": 1453333599, "answer_id": 34912856, "question_id": 34912608, "link": "https://stackoverflow.com/questions/34912608/how-can-generate-a-local-server-in-ruby/34912856#34912856", "title": "How can generate a Local Server in Ruby", "body": "<p>Other people think you just want to <strong>start</strong> a web server, maybe your question is <strong>how to write a web server in ruby</strong>.\nThis is a <a href=\"https://github.com/planetruby/awesome-webservers\" rel=\"noreferrer\">good introduction</a> on ruby web servers and it contains an example shows how to build a sample http server,  cite here for you:</p>\n\n<pre><code>require 'socket'\nserver = TCPServer.new 80\n\nloop do\n  # step 1) accept incoming connection\n  socket = server.accept\n\n  # step 2) print the request headers (separated by a blank line e.g. \\r\\n)\n  puts line = socket.readline  until line == \"\\r\\n\"\n\n  # step 3) send response\n\n  html = \"&lt;html&gt;\\r\\n\"+\n         \"&lt;h1&gt;Hello, World!&lt;/h1&gt;\\r\\n\"+\n         \"&lt;/html&gt;\"\n\n  socket.write \"HTTP/1.1 200 OK\\r\\n\" +\n               \"Content-Type: text/html; charset=utf-8\\r\\n\" +\n               \"Content-Length: #{html.bytesize}\\r\\n\"\n\n  socket.write \"\\r\\n\"  # write a blank line to separate headers from the html doc\n  socket.write html    # write out the html doc\n\n  # step 4) close the socket, terminating the connection\n  socket.close\nend\n</code></pre>\n\n<p>Start it by running ruby this_file.rb, and test with a get method.</p>\n"}, {"tags": [], "owner": {"reputation": 116, "user_id": 3384989, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/100002093712338/picture?type=large", "display_name": "Giovani Barcelos", "link": "https://stackoverflow.com/users/3384989/giovani-barcelos"}, "is_accepted": false, "score": -2, "last_activity_date": 1453333659, "creation_date": 1453333659, "answer_id": 34912870, "question_id": 34912608, "link": "https://stackoverflow.com/questions/34912608/how-can-generate-a-local-server-in-ruby/34912870#34912870", "title": "How can generate a Local Server in Ruby", "body": "<p>All you have to do is bring up your console and type <code> rails server </code></p>\n\n<p>If you want to specify the port you can do <code> rails server -p xxxx</code></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4460635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6228ab17bffec1357a6429da7ca4e29a?s=128&d=identicon&r=PG&f=1", "display_name": "aaronliu", "link": "https://stackoverflow.com/users/4460635/aaronliu"}, "is_accepted": false, "score": -1, "last_activity_date": 1453351661, "creation_date": 1453351661, "answer_id": 34915594, "question_id": 34912608, "link": "https://stackoverflow.com/questions/34912608/how-can-generate-a-local-server-in-ruby/34915594#34915594", "title": "How can generate a Local Server in Ruby", "body": "<p>You can use rack to do this,<a href=\"http://rack.github.io/\" rel=\"nofollow\">http://rack.github.io/</a>, and the rails is also base on the rack.</p>\n"}, {"tags": [], "owner": {"reputation": 1170, "user_id": 3587075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/2N7Vf.png?s=128&g=1", "display_name": "Cristiano Mendon&#231;a", "link": "https://stackoverflow.com/users/3587075/cristiano-mendon%c3%a7a"}, "is_accepted": true, "score": 5, "last_activity_date": 1453402382, "creation_date": 1453402382, "answer_id": 34932008, "question_id": 34912608, "link": "https://stackoverflow.com/questions/34912608/how-can-generate-a-local-server-in-ruby/34932008#34932008", "title": "How can generate a Local Server in Ruby", "body": "<p>You could do</p>\n\n<pre><code>ruby -run -e httpd -- . -p 8000\n</code></pre>\n\n<p>which will start server at port 8000 serving current directory (where server was started). Thus you could place all your HTML pages inside a folder and start server from there.</p>\n"}], "owner": {"reputation": 67, "user_id": 5431944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239fad4bb4dbe807611e3b0109c21b4a?s=128&d=identicon&r=PG", "display_name": "serhatcileri", "link": "https://stackoverflow.com/users/5431944/serhatcileri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1752, "favorite_count": 0, "accepted_answer_id": 34932008, "answer_count": 4, "score": 1, "last_activity_date": 1453402382, "creation_date": 1453332328, "question_id": 34912608, "link": "https://stackoverflow.com/questions/34912608/how-can-generate-a-local-server-in-ruby", "title": "How can generate a Local Server in Ruby", "body": "<p>I want to generate <em>( i dont like create word)</em> a local server (like localhost/8000) on my LAN by Ruby, i researched \u0130nternet but i cant make it.\nMy aim is showing html pages in local servers , using by Ruby.\nHow can i make it?</p>\n\n<pre><code>require 'socket'\n</code></pre>\n\n<p>I'm using <strong>socket</strong> in Standart Library but it gives error when I refresh page.</p>\n\n<pre><code>require 'socket' \nserver = TCPServer.new('localhost', 2345)\nloop do\n  socket = server.accept\n  request = socket.gets\n  STDERR.puts request\n  response = \"Hello World!\\n\"\n  socket.print \"HTTP/1.1 200 OK\\r\\n\" +\n           \"Content-Type: text/plain\\r\\n\" +\n           \"Content-Length: #{response.bytesize}\\r\\n\" +\n           \"Connection: close\\r\\n\"\n\n  socket.print \"\\r\\n\"\n  socket.print response\n  socket.close\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4875, "user_id": 3098330, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/7GLfA.jpg?s=128&g=1", "display_name": "Gupta", "link": "https://stackoverflow.com/users/3098330/gupta"}, "edited": false, "score": 0, "creation_date": 1453384122, "post_id": 34912255, "comment_id": 57584426, "body": "It seems that there is other record exists in you <code>Course</code> model, do <code>Course.all</code> and then update your question with the output"}], "answers": [{"comments": [{"owner": {"reputation": 179, "user_id": 5726485, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/10207019311632480/picture?type=large", "display_name": "Hussein.", "link": "https://stackoverflow.com/users/5726485/hussein"}, "edited": false, "score": 0, "creation_date": 1453545218, "post_id": 34912716, "comment_id": 57655335, "body": "Thank you i understand what you mean. yes."}], "tags": [], "owner": {"reputation": 216, "user_id": 5799163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab113470543163bec5ebae1a679a4b2f?s=128&d=identicon&r=PG", "display_name": "Johnny Klironomos", "link": "https://stackoverflow.com/users/5799163/johnny-klironomos"}, "is_accepted": true, "score": 1, "last_activity_date": 1453332841, "creation_date": 1453332841, "answer_id": 34912716, "question_id": 34912255, "link": "https://stackoverflow.com/questions/34912255/seed-how-reinitialize-my-seed-rails/34912716#34912716", "title": "Seed - How reinitialize my seed - rails", "body": "<p>Did you run <code>rake db:seed</code> multiple times? If that's the case, drop, create, migrate, seed your database again.</p>\n\n<p>If in the future you need to update your seeds and re-run them, make sure you do not create multiple records. You can do that by changing your code, from that:</p>\n\n<pre><code>rails = Course.create(title: \"Ruby On Rails\")\nmodels = rails.chapters.create(title: \"Models\")\n\nmodels.items &lt;&lt; Lesson.create(title: \"What is Active Record?\", content: \"Lesson content here\")\n</code></pre>\n\n<p>to that:</p>\n\n<pre><code>rails = Course.where(title: \"Ruby On Rails\").first_or_create\nmodels = rails.chapters.where(title: \"Models\").first_or_create\n\nmodels.items &lt;&lt; Lesson.where(title: \"What is Active Record?\").first_or_create(title: \"What is Active Record?\", content: \"Lesson content here\")\n</code></pre>\n\n<p>Find the First Instance in the Table. If None Exists, Create One.</p>\n"}], "owner": {"reputation": 179, "user_id": 5726485, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/10207019311632480/picture?type=large", "display_name": "Hussein.", "link": "https://stackoverflow.com/users/5726485/hussein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 34912716, "answer_count": 1, "score": 0, "last_activity_date": 1453332841, "creation_date": 1453330649, "last_edit_date": 1453331420, "question_id": 34912255, "link": "https://stackoverflow.com/questions/34912255/seed-how-reinitialize-my-seed-rails", "title": "Seed - How reinitialize my seed - rails", "body": "<p>Hi I create this seed </p>\n\n<pre><code>rails = Course.create(title: \"Ruby On Rails\")\nmodels = rails.chapters.create(title: \"Models\")\n\nmodels.items &lt;&lt; Lesson.create(title: \"What is Active Record?\", content: \"Lesson content here\")\n\nmodels.items &lt;&lt; Exercice.create(title: \"The Active Record pattern\", content: \"Exo about active record pattern\")\nmodels.items &lt;&lt; Exercice.create(title: \"Object Relational Mapping\", content: \"Exo about ORM\")\nmodels.items &lt;&lt; Exercice.create(title: \"Active Record as an ORM Framework\", content: \"Exo about ORM\")\n\nmodels.items &lt;&lt; Lesson.create(title: \"Convention over Configuration in Active Record\", content: \"Lesson content here\")\n\nmodels.items &lt;&lt; Exercice.create(title: \"Naming Conventions\", content: \"Exo about naming convention\")\nmodels.items &lt;&lt; Exercice.create(title: \"Schema Conventions\", content: \"Exo about schema convention\")\n\nmodels.items &lt;&lt; Lesson.create(title: \"Model summary\", content: \"Lesson content here\")\n\nmodels.items &lt;&lt; Exam.create(title: \"Rails Models exam\", content: \"Exam content here\")\n\nputs \"done\"\n</code></pre>\n\n<p>I have done <code>rake db:seed</code>. </p>\n\n<p>My controller Course is:</p>\n\n<p>class CoursesController &lt; ApplicationController</p>\n\n<pre><code>  def index\n    @courses = Course.all\n  end\n\n  def show\n    @course = Course.find(params[:id])\n  end\n\nend\n</code></pre>\n\n<p>My controller Chapter is :</p>\n\n<p>class ChaptersController &lt; ApplicationController</p>\n\n<pre><code>  def show\n    @course = Course.find(params[:course_id])\n    @chapter = @course.chapters.find(params[:id])\n  end\n\nend\n</code></pre>\n\n<p>My controller Chapter is :</p>\n\n<pre><code>class ItemsController &lt; ApplicationController\n\n  def show\n    @course = Course.find(params[:course_id])\n    @chapter = @course.chapters.find(params[:chapter_id])\n    @item = @chapter.items.find(params[:id])\n  end\nend\n</code></pre>\n\n<p>And in the app/views/courses/index.html.erb</p>\n\n<pre><code>&lt;div class=\"container-page\"&gt;\n  &lt;div class=\"padding-page\"&gt;\n    &lt;div class=\"container-fluid\"&gt;\n      &lt;div class=\"row\"&gt;\n        &lt;div class=\"col-xs-12 col-sm-12 col-md-12\"&gt;\n          &lt;div class=\"page-progress\"&gt;\n            &lt;h1&gt;\n              Page en cours de r\u00e9alisation\n            &lt;/h1&gt;\n\n            &lt;% @courses.each do |course| %&gt;\n            &lt;h2&gt;\n            &lt;%= link_to course.title, course %&gt;\n\n            &lt;/h2&gt;\n            &lt;% end %&gt;\n\n          &lt;/div&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>But it appears title courses numerous times and I want to have just see one time. How do I reset or destroy or hide the others courses wjich name the same Name and have the same structure? </p>\n\n<p><a href=\"http://i.stack.imgur.com/SCdbu.png\" rel=\"nofollow\">Here is the index iteration</a></p>\n\n<p>If you want more informations I give you but tell me what can I do. Thank you.</p>\n"}, {"tags": ["ruby", "braintree"], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 5667863, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/FFJki.jpg?s=128&g=1", "display_name": "RubyCat", "link": "https://stackoverflow.com/users/5667863/rubycat"}, "edited": false, "score": 1, "creation_date": 1453519792, "post_id": 34949088, "comment_id": 57649785, "body": "I sort of know the calculation. I need to get it from the API per transaction so that I don&#39;t have to calculate it. This is possible with PayPal and WePay but not Braintree. Besides, Braintree gives certain discount for the members, so, there&#39;re other calculations involved. Thanks for the answer."}, {"owner": {"reputation": 163, "user_id": 10292457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/709038b71ccab1445f0778cf082e2c5e?s=128&d=identicon&r=PG&f=1", "display_name": "ryan28561", "link": "https://stackoverflow.com/users/10292457/ryan28561"}, "edited": false, "score": 0, "creation_date": 1583430905, "post_id": 34949088, "comment_id": 107123535, "body": "Along with not being accurate for every customer, this calculation also likely will lead to rounding errors down the road. Braintree rounds down to the nearest cent on each transaction."}], "tags": [], "owner": {"reputation": 1, "user_id": 5615829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c46366cbcb942236806be096f9bc3926?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Shimchik", "link": "https://stackoverflow.com/users/5615829/oleg-shimchik"}, "is_accepted": false, "score": 0, "last_activity_date": 1453473045, "creation_date": 1453473045, "answer_id": 34949088, "question_id": 34912243, "link": "https://stackoverflow.com/questions/34912243/braintrees-processing-fee/34949088#34949088", "title": "Braintree&#39;s processing fee", "body": "<p>Braintree processing fee is fixed at 2.9% + $.30 per transaction:\n<a href=\"https://www.braintreepayments.com/pricing\" rel=\"nofollow\">https://www.braintreepayments.com/pricing</a></p>\n\n<p>Given that you can implement a small helper method, like the following:</p>\n\n<pre><code>def calc_braintree_fee(amount)\n    return amount*0.029 + 0.3\nend\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 5667863, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/FFJki.jpg?s=128&g=1", "display_name": "RubyCat", "link": "https://stackoverflow.com/users/5667863/rubycat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1453473045, "creation_date": 1453330590, "question_id": 34912243, "link": "https://stackoverflow.com/questions/34912243/braintrees-processing-fee", "title": "Braintree&#39;s processing fee", "body": "<p>I'd like to get the amount of Braintree's processing fee for any transaction that has been made using the API. Looking at the response object of <a href=\"https://developers.braintreepayments.com/reference/request/transaction/sale/ruby\" rel=\"nofollow\">Braintree::Transaction.sale</a> which can be found at <a href=\"https://developers.braintreepayments.com/reference/response/transaction/ruby\" rel=\"nofollow\">Braintree::Transaction</a>, I can't seem to find it. So, where can I get it?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "capistrano", "capistrano3"], "comments": [{"owner": {"reputation": 575, "user_id": 2855747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ef29652da2fde5184c329af0e72ccea?s=128&d=identicon&r=PG", "display_name": "Colto", "link": "https://stackoverflow.com/users/2855747/colto"}, "edited": false, "score": 0, "creation_date": 1453331477, "post_id": 34912197, "comment_id": 57560427, "body": "Is that your full <code>production.rb</code>? And what version of Capistrano are you using?"}, {"owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "reply_to_user": {"reputation": 575, "user_id": 2855747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ef29652da2fde5184c329af0e72ccea?s=128&d=identicon&r=PG", "display_name": "Colto", "link": "https://stackoverflow.com/users/2855747/colto"}, "edited": false, "score": 0, "creation_date": 1453331555, "post_id": 34912197, "comment_id": 57560456, "body": "yes, I got it from <a href=\"http://www.travisluong.com/ruby-on-rails-nginx-unicorn-postgresql-capistrano/\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 575, "user_id": 2855747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ef29652da2fde5184c329af0e72ccea?s=128&d=identicon&r=PG", "display_name": "Colto", "link": "https://stackoverflow.com/users/2855747/colto"}, "edited": false, "score": 2, "creation_date": 1453331890, "post_id": 34912197, "comment_id": 57560589, "body": "Try changing <code>:repository</code> to <code>:repo_url</code> in your <code>deploy.rb</code>"}, {"owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "reply_to_user": {"reputation": 575, "user_id": 2855747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ef29652da2fde5184c329af0e72ccea?s=128&d=identicon&r=PG", "display_name": "Colto", "link": "https://stackoverflow.com/users/2855747/colto"}, "edited": false, "score": 0, "creation_date": 1453340132, "post_id": 34912197, "comment_id": 57563129, "body": "Still the same error @ColtonFent"}, {"owner": {"reputation": 575, "user_id": 2855747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ef29652da2fde5184c329af0e72ccea?s=128&d=identicon&r=PG", "display_name": "Colto", "link": "https://stackoverflow.com/users/2855747/colto"}, "edited": false, "score": 0, "creation_date": 1453411385, "post_id": 34912197, "comment_id": 57601898, "body": "What happens when you run <code>git ls-remote</code> from the command line?"}], "answers": [{"tags": [], "owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "is_accepted": false, "score": 0, "last_activity_date": 1453411489, "creation_date": 1453411489, "answer_id": 34934641, "question_id": 34912197, "link": "https://stackoverflow.com/questions/34912197/capistrano-aborting-with-cryptic-message/34934641#34934641", "title": "Capistrano aborting with cryptic message", "body": "<p>The problem was that the server had no deploy key on server. So I had to generate a key and add it on github.</p>\n"}], "owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453411489, "creation_date": 1453330379, "last_edit_date": 1453331021, "question_id": 34912197, "link": "https://stackoverflow.com/questions/34912197/capistrano-aborting-with-cryptic-message", "title": "Capistrano aborting with cryptic message", "body": "<p>I'm trying to deploy my app using capistrano but it failing with the message below.</p>\n\n<h3>error</h3>\n\n<pre><code>\u279c  ..... git:(capistrano) \u2717 cap production deploy:check\nINFO [98af6015] Running /usr/bin/env mkdir -p /tmp/...-api/ as deploy@0.0.0.0\nINFO [98af6015] Finished in 0.239 seconds with exit status 0 (successful).\nINFO Uploading /tmp/...-api/git-ssh.sh 100.0%\nINFO [36b8dec0] Running /usr/bin/env chmod +x /tmp/...-api/git-ssh.sh as deploy@0.0.0.0\nINFO [36b8dec0] Finished in 0.216 seconds with exit status 0 (successful).\nPlease enter branch (capistrano): \nINFO [fe410248] Running /usr/bin/env git ls-remote --heads  as deploy@0.0.0.0\n(Backtrace restricted to imported tasks)\ncap aborted!\nSSHKit::Runner::ExecuteError: Exception while executing as deploy@0.0.0.0: git exit status: 129\ngit stdout: Nothing written\ngit stderr: usage: git ls-remote [--heads] [--tags]  [-u &lt;exec&gt; | --upload-pack &lt;exec&gt;] &lt;repository&gt; &lt;refs&gt;...\n\nSSHKit::Command::Failed: git exit status: 129\ngit stdout: Nothing written\ngit stderr: usage: git ls-remote [--heads] [--tags]  [-u &lt;exec&gt; | --upload-pack &lt;exec&gt;] &lt;repository&gt; &lt;refs&gt;...\n\nTasks: TOP =&gt; git:check\n(See full trace by running task with --trace)\n</code></pre>\n\n<h3>deploy.rb</h3>\n\n<pre><code>lock '3.4.0'\n\nset :application, '....-api'\nset :repository, 'git@github.com:chaione/...-api.git'\nset :user, 'deploy'\nset :linked_files, fetch(:linked_files, []).push('config/database.yml', 'config/secrets.yml')\nset :linked_dirs, fetch(:linked_dirs, []).push('log', 'tmp/pids', 'tmp/cache', 'tmp/sockets', 'vendor/bundle', 'public/system')\nset :format, :pretty\nset :log_level, :info\nset :deploy_via, :remote_cache\n\n# set :scm, 'git'\nask :branch, `git rev-parse --abbrev-ref HEAD`.chomp\n</code></pre>\n\n<h3>production.rb</h3>\n\n<pre><code>server '0.0.0.0', user: 'deploy', roles: %w(web app db), primary: true\n\nset :unicorn_rack_env, -&gt; { \"production\" }\nset :rails_env, :production\nset :enable_ssl, true\n\nset :ssh_options,\n    keys: %w(~/.ssh/id_rsa),\n    forward_agent: false,\n    auth_methods: %w(password publickey),\n    password: '....'\n</code></pre>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1453329970, "post_id": 34912009, "comment_id": 57559793, "body": "You can&#39;t call Ruby from JavaScript being run inside the browser. Are you trying to run Ruby inside ERB or a template processor inside Rails?"}], "answers": [{"comments": [{"owner": {"reputation": 1125, "user_id": 5398558, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-y55QNRIiBcA/AAAAAAAAAAI/AAAAAAAAABI/HLtIr-k2f7w/photo.jpg?sz=128", "display_name": "Nadiya", "link": "https://stackoverflow.com/users/5398558/nadiya"}, "edited": false, "score": 0, "creation_date": 1453330317, "post_id": 34912135, "comment_id": 57559945, "body": "Any ideas how do I get a city name while user is filling a form? I need a city name for showing a building on google maps. Where do I do that Ajax call?"}, {"owner": {"reputation": 1868, "user_id": 1362453, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f8ac2cc7e4e38841fb52ea58b4bf06ef?s=128&d=identicon&r=PG", "display_name": "Leo Brito", "link": "https://stackoverflow.com/users/1362453/leo-brito"}, "reply_to_user": {"reputation": 1125, "user_id": 5398558, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-y55QNRIiBcA/AAAAAAAAAAI/AAAAAAAAABI/HLtIr-k2f7w/photo.jpg?sz=128", "display_name": "Nadiya", "link": "https://stackoverflow.com/users/5398558/nadiya"}, "edited": false, "score": 0, "creation_date": 1453330817, "post_id": 34912135, "comment_id": 57560179, "body": "@Nadiya With ajax. I&#39;ve edited my answer with an example."}], "tags": [], "owner": {"reputation": 1868, "user_id": 1362453, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f8ac2cc7e4e38841fb52ea58b4bf06ef?s=128&d=identicon&r=PG", "display_name": "Leo Brito", "link": "https://stackoverflow.com/users/1362453/leo-brito"}, "is_accepted": true, "score": 1, "last_activity_date": 1453330617, "last_edit_date": 1453330617, "creation_date": 1453330102, "answer_id": 34912135, "question_id": 34912009, "link": "https://stackoverflow.com/questions/34912009/ruby-code-inside-javascript/34912135#34912135", "title": "Ruby code inside Javascript", "body": "<p>It doesn't work because the Rails server parses the <code>html.erb</code> view before <code>city_id</code> is defined.</p>\n\n<p><code>city_id</code> is a Javascript variable defined by the client browser <em>after</em> receiving the view which contains <code>var city_name = #{City.find(city_id).name};</code>.</p>\n\n<p>You could do an Ajax call that would execute <code>City.find(city_id).name</code> on the server and fill <code>var city_name</code> with the response. Once you know the user has filled an <code>input</code> with some text you can use (i.e. city_id), you can make a call like so (put this either in the view or in a separate js file):</p>\n\n<pre><code>$.ajax({\n  type: \"GET\",\n  url: \"/your_ajax_endpoint\",\n  dataType: 'json',\n  data: {'city_id': city_id},\n  success: function(data) {\n    var city_name = data;\n  },\n  error: function(data) {\n    // Error handling\n  }\n});\n</code></pre>\n\n<p>The endpoint in your controller would look like this:</p>\n\n<pre><code>def my_ajax_endpoint\n    city_name = City.find(city_id).name\n    respond_to do |format|\n      format.json { render json: city_name.to_json }\n    end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 358, "user_id": 1894421, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f8d115dd20a51bf2e13c3e1598ff8352?s=128&d=identicon&r=PG", "display_name": "apebeast", "link": "https://stackoverflow.com/users/1894421/apebeast"}, "is_accepted": false, "score": 0, "last_activity_date": 1453330459, "creation_date": 1453330459, "answer_id": 34912214, "question_id": 34912009, "link": "https://stackoverflow.com/questions/34912009/ruby-code-inside-javascript/34912214#34912214", "title": "Ruby code inside Javascript", "body": "<p>You need to pass data using javascript. Here is an example taken from <a href=\"http://railscasts.com/episodes/324-passing-data-to-javascript?autoplay=true\" rel=\"nofollow\">this RailsCast</a>.</p>\n\n<p><em>products/index.html.erb</em> </p>\n\n<pre><code>&lt;%= content_tag \"div\", id: \"products\", data: {products: Product.limit(10)} do %&gt;\n  Loading products...\n&lt;% end %&gt;\n</code></pre>\n\n<p><em>app/assets/javascripts/products.js.coffee</em> </p>\n\n<pre><code>jQuery -&gt;\n  alert $('#products').data('products')\n</code></pre>\n\n<p>Or you can use the <a href=\"https://github.com/gazay/gon\" rel=\"nofollow\">gon gem</a>.</p>\n"}], "owner": {"reputation": 1125, "user_id": 5398558, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-y55QNRIiBcA/AAAAAAAAAAI/AAAAAAAAABI/HLtIr-k2f7w/photo.jpg?sz=128", "display_name": "Nadiya", "link": "https://stackoverflow.com/users/5398558/nadiya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1184, "favorite_count": 0, "accepted_answer_id": 34912135, "answer_count": 2, "score": -1, "last_activity_date": 1453330617, "creation_date": 1453329537, "question_id": 34912009, "link": "https://stackoverflow.com/questions/34912009/ruby-code-inside-javascript", "title": "Ruby code inside Javascript", "body": "<p>I have a Ruby form that saves a city id value:</p>\n\n<pre><code>= select_tag 'building[city_id]',\noptions_for_select(cities.map{|c| [c.name, c.id]})\n</code></pre>\n\n<p>I'm saving that id using Javascript:</p>\n\n<pre><code>var city_id = $('#building_city_id').val();\n</code></pre>\n\n<p>My issue is that I also need a Javascript variable for a city name, which I can get using Ruby like this: <code>City.find(@building.city.id).name</code>.\nI tried this code, but it doesn't wotk:</p>\n\n<pre><code>var city_name = #{City.find(city_id).name};\n</code></pre>\n\n<p>Where is my mistake? (I'm very new to Ruby)</p>\n"}, {"tags": ["ruby", "chef-infra", "rhel"], "answers": [{"comments": [{"owner": {"reputation": 679, "user_id": 1354744, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/fzNAT.jpg?s=128&g=1", "display_name": "PolarisUser", "link": "https://stackoverflow.com/users/1354744/polarisuser"}, "edited": false, "score": 0, "creation_date": 1453332912, "post_id": 34912375, "comment_id": 57560951, "body": "Ah okay. That makes sense. You also explained it VERY well. Thanks!"}], "tags": [], "owner": {"reputation": 3808, "user_id": 3284723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41594814b22fe2615debbb8359bc08c0?s=128&d=identicon&r=PG", "display_name": "zuazo", "link": "https://stackoverflow.com/users/3284723/zuazo"}, "is_accepted": true, "score": 2, "last_activity_date": 1453331211, "creation_date": 1453331211, "answer_id": 34912375, "question_id": 34911544, "link": "https://stackoverflow.com/questions/34911544/chef-client-not-starting-with-chef-client-cookbook-rhel-6-7/34912375#34912375", "title": "chef-client not starting with chef-client cookbook RHEL 6.7", "body": "<p>When using the <code>chef-client</code> cookbook you should put this in your run list: <code>chef-client::config, chef-client:init_service</code>.</p>\n\n<p>Avoid putting <code>chef-client</code> in your run list before including the <code>config</code>, because <a href=\"https://github.com/chef-cookbooks/chef-client/blob/v4.3.2/recipes/default.rb#L20\" rel=\"nofollow\">this will create the service before creating the configuration</a>.</p>\n\n<p>So, remove <code>chef-client::default</code> (aka <code>chef-client</code>) from your run list. That's all. You can use <code>chef-client::config, chef-client::default, chef-client::delete_validation</code> if you prefer. But remember, the config goes first.</p>\n"}], "owner": {"reputation": 679, "user_id": 1354744, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/fzNAT.jpg?s=128&g=1", "display_name": "PolarisUser", "link": "https://stackoverflow.com/users/1354744/polarisuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 437, "favorite_count": 0, "accepted_answer_id": 34912375, "answer_count": 1, "score": 0, "last_activity_date": 1453331211, "creation_date": 1453327525, "last_edit_date": 1453327834, "question_id": 34911544, "link": "https://stackoverflow.com/questions/34911544/chef-client-not-starting-with-chef-client-cookbook-rhel-6-7", "title": "chef-client not starting with chef-client cookbook RHEL 6.7", "body": "<p>I am using the 4.3.2 chef-client cookbook, chef-client 12.6, and my run list is - role chef-client, and my chef-client role is as follows: \nchef-client\nchef-client::config\nchef-client::delete_validation</p>\n\n<p>Link to the cookbook - <a href=\"https://github.com/chef-cookbooks/chef-client\" rel=\"nofollow\">https://github.com/chef-cookbooks/chef-client</a></p>\n\n<p>My os is rhel 6.7</p>\n\n<p>Also, if it matters, I am using Packer to create the image when this issue occurs. </p>\n\n<p>I log-on to the VM, and I am unable to start the service either. \nDuring the chef-client run, it will error with the following \n<code>\n'mazon-ebs: ================================================================================\n    amazon-ebs: Error executing action `start` on resource 'service[chef-client]'\n    amazon-ebs: ================================================================================\n    amazon-ebs:\n    amazon-ebs: Mixlib::ShellOut::ShellCommandFailed\n    amazon-ebs: ------------------------------------\n    amazon-ebs: Expected process to exit with [0], but received '6'\n    amazon-ebs: ---- Begin output of /sbin/service chef-client start ----\n    amazon-ebs: STDOUT:\n    amazon-ebs: STDERR:\n    amazon-ebs: ---- End output of /sbin/service chef-client start ----\n    amazon-ebs: Ran /sbin/service chef-client start returned 6\n    amazon-ebs:\n    amazon-ebs: Resource Declaration:\n    amazon-ebs: ---------------------\n    amazon-ebs: # In /var/chef/cache/cookbooks/chef-client/recipes/init_service.rb\n    amazon-ebs:\n    amazon-ebs: 32: service 'chef-client' do\n    amazon-ebs: 33:   supports :status =&gt; true, :restart =&gt; true\n    amazon-ebs: 34:   action [:enable, :start]\n    amazon-ebs: 35: end\n    amazon-ebs:\n    amazon-ebs: Compiled Resource:\n    amazon-ebs: ------------------\n    amazon-ebs: # Declared in /var/chef/cache/cookbooks/chef-client/recipes/init_service.rb:32:in `from_file'\n    amazon-ebs:\n    amazon-ebs: service(\"chef-client\") do\n    amazon-ebs: action [:enable, :start]\n    amazon-ebs: updated true\n    amazon-ebs: supports {:status=&gt;true, :restart=&gt;true}\n    amazon-ebs: retries 0\n    amazon-ebs: retry_delay 2\n    amazon-ebs: default_guard_interpreter :default\n    amazon-ebs: service_name \"chef-client\"\n    amazon-ebs: enabled true\n    amazon-ebs: pattern \"chef-client\"\n    amazon-ebs: declared_type :service\n    amazon-ebs: cookbook_name \"chef-client\"\n    amazon-ebs: recipe_name \"init_service\"\n    amazon-ebs: end\n    amazon-ebs:\n    amazon-ebs: [2016-01-20T16:49:04-05:00] INFO: Running queued delayed notifications before re-raising exception\n    amazon-ebs: [2016-01-20T16:49:04-05:00] INFO: template[/etc/init.d/chef-client] sending restart action to service[chef-client] (delayed)\n    amazon-ebs: * service[chef-client] action restart[2016-01-20T16:49:04-05:00] INFO: Processing service[chef-client] action restart (chef-client::init_service line 32)\n    amazon-ebs:\n    amazon-ebs:\n    amazon-ebs: ================================================================================\n    amazon-ebs: Error executing action `restart` on resource 'service[chef-client]'\n    amazon-ebs: ================================================================================\n    amazon-ebs:\n    amazon-ebs: Mixlib::ShellOut::ShellCommandFailed\n    amazon-ebs: ------------------------------------\n    amazon-ebs: Expected process to exit with [0], but received '6'\n    amazon-ebs: ---- Begin output of /sbin/service chef-client restart ----\n    amazon-ebs: STDOUT: Stopping chef-client: [FAILED]\n    amazon-ebs: STDERR:\n    amazon-ebs: ---- End output of /sbin/service chef-client restart ----\n    amazon-ebs: Ran /sbin/service chef-client restart returned 6\n    amazon-ebs:\n    amazon-ebs: Resource Declaration:\n    amazon-ebs: ---------------------\n    amazon-ebs: # In /var/chef/cache/cookbooks/chef-client/recipes/init_service.rb\n    amazon-ebs:\n    amazon-ebs: 32: service 'chef-client' do\n    amazon-ebs: 33:   supports :status =&gt; true, :restart =&gt; true\n    amazon-ebs: 34:   action [:enable, :start]\n    amazon-ebs: 35: end\n    amazon-ebs:\n    amazon-ebs: Compiled Resource:\n    amazon-ebs: ------------------\n    amazon-ebs: # Declared in /var/chef/cache/cookbooks/chef-client/recipes/init_service.rb:32:in from_file\n     amazon-ebs:\n    amazon-ebs: service(\"chef-client\") do\n    amazon-ebs: action [:enable, :start]\n    amazon-ebs: updated true\n    amazon-ebs: supports {:status=&gt;true, :restart=&gt;true}\n    amazon-ebs: retries 0\n    amazon-ebs: retry_delay 2\n    amazon-ebs: default_guard_interpreter :default\n    amazon-ebs: service_name \"chef-client\"\n    amazon-ebs: enabled true\n    amazon-ebs: pattern \"chef-client\"\n    amazon-ebs: declared_type :service\n    amazon-ebs: cookbook_name \"chef-client\"\n    amazon-ebs: recipe_name \"init_service\"\n    amazon-ebs: end\n    amazon-ebs:\n    amazon-ebs:\n</code></p>\n"}, {"tags": ["ruby", "macos", "rubygems", "rake", "environment"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1453326080, "post_id": 34910821, "comment_id": 57557852, "body": "Welcome to Stack Overflow. Please read the formatting help for the text edit box. When asking questions it&#39;s important to format your question so it&#39;s readable and follows the standard SO look, which helps us understand you then provide an answer. It&#39;s also important to avoid fluff and be concise; Stick to the facts, tell us clearly and concisely what is happening, and we&#39;ll try to help."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1453326238, "post_id": 34910821, "comment_id": 57557930, "body": "How did you install Net::SCP?"}, {"owner": {"reputation": 86, "user_id": 696361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d82a8aab082ce3f97bc7264ad0a32224?s=128&d=identicon&r=PG", "display_name": "Pierre-Loup", "link": "https://stackoverflow.com/users/696361/pierre-loup"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1453326433, "post_id": 34910821, "comment_id": 57558046, "body": "I chose to install my gem home in my home directory to avoid permissions issue with OXS El Capitan. <code>gem list</code> shows <code>net-scp (1.2.1)</code>"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1453329892, "post_id": 34910821, "comment_id": 57559768, "body": "You should look into using rbenv or RVM. Installing the gems in your home is OK, but you&#39;ll still want to update gems bundled with the system Ruby at some point, along with upgrade to more recent Rubies. rbenv and RVM handle that very nicely."}, {"owner": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "edited": false, "score": 0, "creation_date": 1453363633, "post_id": 34910821, "comment_id": 57570864, "body": "Are you using bundler?"}, {"owner": {"reputation": 86, "user_id": 696361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d82a8aab082ce3f97bc7264ad0a32224?s=128&d=identicon&r=PG", "display_name": "Pierre-Loup", "link": "https://stackoverflow.com/users/696361/pierre-loup"}, "reply_to_user": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "edited": false, "score": 0, "creation_date": 1453364393, "post_id": 34910821, "comment_id": 57571267, "body": "@FrederickCheung: Yes I installed the gem with bundler."}, {"owner": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "edited": false, "score": 0, "creation_date": 1453364812, "post_id": 34910821, "comment_id": 57571477, "body": "Is the gem in your Gemfile then - does your project require bundler/setup?"}, {"owner": {"reputation": 86, "user_id": 696361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d82a8aab082ce3f97bc7264ad0a32224?s=128&d=identicon&r=PG", "display_name": "Pierre-Loup", "link": "https://stackoverflow.com/users/696361/pierre-loup"}, "edited": false, "score": 0, "creation_date": 1453386405, "post_id": 34910821, "comment_id": 57586143, "body": "Yes the gem was listed in the project&#39;s Gemfile. I runned <code>bundle install</code> which install all the needed gems"}], "owner": {"reputation": 86, "user_id": 696361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d82a8aab082ce3f97bc7264ad0a32224?s=128&d=identicon&r=PG", "display_name": "Pierre-Loup", "link": "https://stackoverflow.com/users/696361/pierre-loup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 300, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1453326013, "creation_date": 1453324985, "last_edit_date": 1453326013, "question_id": 34910821, "link": "https://stackoverflow.com/questions/34910821/why-cant-ruby-find-my-netscp", "title": "Why can&#39;t Ruby find my Net::SCP?", "body": "<p>My Rake task fails with the following error:</p>\n\n<pre><code>plt$ rake build\nrake aborted!\nLoadError: cannot load such file -- net/scp\n/Users/plt/Developer/Ruby/tools/Rake/helpers/ota_generator.rb:7:in `&lt;top (required)&gt;'\n/Users/plt/Developer/Ruby/tools/Rake/configuration/ios/delivery.rb:9:in `&lt;top (required)&gt;'\n/Users/plt/Developer/Ruby/tools/Rake/configuration/ios/global_config.rb:16:in `&lt;top (required)&gt;'\n/Users/plt/Developer/Ruby/tools/Rake/ios.rb:8:in `&lt;top (required)&gt;'\n/Users/plt/Developer/iOS/project/Rakefile:10:in `&lt;top (required)&gt;'\n(See full trace by running task with --trace)\n</code></pre>\n\n<p>The Net::SCP gem is already installed and <code>ruby -e \"require 'net/scp'\"</code> works fine.</p>\n\n<p>The \"LoadError\" disappears if I add <code>require 'net/scp'</code> at the beginning of the Rakefile.</p>\n\n<p>I moved <code>require 'net/scp'</code> from files to files to see were it starts to fail. Here is the result:</p>\n\n<pre><code>/Users/plt/Developer/iOS/project/Rakefile -&gt; `require 'net/scp'` **OK**\n/Users/plt/Developer/Ruby/tools/Rake/ios.rb -&gt; `require 'net/scp'` **OK**\n/Users/plt/Developer/Ruby/tools/Rake/configuration/ios/global_config.rb -&gt; `require 'net/scp'` **OK**\n/Users/plt/Developer/Ruby/tools/Rake/configuration/ios/delivery.rb -&gt; `require 'net/scp'` **KO** `LoadError: cannot load such file -- net/scp`\n/Users/plt/Developer/Ruby/tools/Rake/helpers/ota_generator.rb -&gt; `require 'net/scp'` **KO** `LoadError: cannot load such file -- net/scp`\n</code></pre>\n\n<p>My Rake task launches a build tool which has many Ruby files and uses many gems, but so far only two gems are giving me a hard time: CFPropertyList and Net::SCP.</p>\n\n<p>At first I thought it came from my Ruby environment, BUT I already checked and it seems fine.</p>\n\n<pre><code>plt$ which ruby\n/System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/bin/ruby\n\nplt$ gem env\nRubyGems Environment:\n  - RUBYGEMS VERSION: 2.5.0\n  - RUBY VERSION: 2.0.0 (2015-04-13 patchlevel 645) [universal.x86_64-darwin15]\n  - INSTALLATION DIRECTORY: /Users/plt/.gem/ruby/2.0.0\n  - USER INSTALLATION DIRECTORY: /Users/plt/.gem/ruby/2.0.0\n  - RUBY EXECUTABLE: /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/bin/ruby\n  - EXECUTABLE DIRECTORY: /Users/plt/.gem/ruby/2.0.0/bin\n  - SPEC CACHE DIRECTORY: /Users/plt/.gem/specs\n  - SYSTEM CONFIGURATION DIRECTORY: /Library/Ruby/Site\n  - RUBYGEMS PLATFORMS:\n    - ruby\n    - universal-darwin-15\n  - GEM PATHS:\n     - /Users/plt/.gem/ruby/2.0.0\n  - GEM CONFIGURATION:\n     - :update_sources =&gt; true\n     - :verbose =&gt; true\n     - :backtrace =&gt; false\n     - :bulk_threshold =&gt; 1000\n  - REMOTE SOURCES:\n     - https://rubygems.org/\n  - SHELL PATH:\n     - /Users/plt/.gem/ruby/2.0.0/bin\n     - /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/bin\n     - /usr/local/bin\n     - /usr/bin\n     - /bin\n     - /usr/sbin\n     - /sbin\n     - /opt/X11/bin\n</code></pre>\n"}, {"tags": ["ruby", "hash", "ternary"], "comments": [{"owner": {"reputation": 8160, "user_id": 163640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63f02794544d271573750a83842cf59?s=128&d=identicon&r=PG", "display_name": "eugen", "link": "https://stackoverflow.com/users/163640/eugen"}, "edited": false, "score": 0, "creation_date": 1453325036, "post_id": 34910803, "comment_id": 57557276, "body": "Did you mean <code>h[:alpha] = (a &gt; 3 ? true : false)</code> ?"}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "reply_to_user": {"reputation": 8160, "user_id": 163640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63f02794544d271573750a83842cf59?s=128&d=identicon&r=PG", "display_name": "eugen", "link": "https://stackoverflow.com/users/163640/eugen"}, "edited": false, "score": 0, "creation_date": 1453325098, "post_id": 34910803, "comment_id": 57557317, "body": "Yes I did, sorry.  I started this question before I fixed that."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1453331744, "post_id": 34910803, "comment_id": 57560529, "body": "What do you mean by &quot;doesn&#39;t work&quot;? Both code snippets assign <code>true</code> to <code>h[:alpha]</code>. What is the behavior you are getting? What is the behavior you are expecting? What is the exact error message you are getting?"}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1453331829, "post_id": 34910803, "comment_id": 57560567, "body": "It&#39;s been edited from the original post.  I was told to edit original posts even though it would be confusing.  It was h[:alpha] =&gt; a &gt; 3..."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1453336634, "post_id": 34910803, "comment_id": 57562114, "body": "What is your question then? You say you are looking for a way to use a ternary, then you show a way to use a ternary, so, what is it you&#39;re looking for?"}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1453336674, "post_id": 34910803, "comment_id": 57562126, "body": "It has been solved.  I was having string interpolation issues, not ternary."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1453336730, "post_id": 34910803, "comment_id": 57562145, "body": "Editing your question in a way that invalidates existing answers is <i>extremely</i> rude. It invalidates the hard work people have been putting into their answers, and will lead to their answers being downvoted for being wrong."}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1453336824, "post_id": 34910803, "comment_id": 57562179, "body": "Yes, I agree.  But then I get the &quot;holier than thou&quot; developers in here giving me guff because I don&#39;t edit my original post.  So if you have a problem with that, then chase them, not me.  So in essence, everybody that posts a question, is wrong. You know what?  Just because of you, I&#39;ll set it back.  Expect someone to come in and say I should edit it."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1453337277, "post_id": 34910803, "comment_id": 57562315, "body": "The reason why you should edit your question is because it is massively unclear what it even is that you are asking. The title says that you are asking about the ternary operator but you just now told me that you are actually having a problem with string interpolation, yet there is no mention of string interpolation anywhere in the question. In the question, you say you are looking for a way of shortening up the code you posted, but in a comment to sawa&#39;s answer, which shows exactly that, you say that it <i>doesn&#39;t</i> answer your question. That is a confusion you need to clear up by editing your \u2026"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1453337302, "post_id": 34910803, "comment_id": 57562325, "body": "\u2026 question, but <i>not</i> by turning it into a completely different question that invalidates existing answers."}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1453337407, "post_id": 34910803, "comment_id": 57562353, "body": "Read what I put.  Also later on in the comments I published the actual application where it still wasn&#39;t working.  So read the page before you start lecturing.  Now you&#39;re telling me to edit the question after telling me not to edit the question?  Yes I thought it was ternary and not string interpolation.  Hence the post.  I also stated that it was string interpolation that was the issue, and not the ternary.  Next time you should read before getting on your high horse."}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1453337453, "post_id": 34910803, "comment_id": 57562363, "body": "And it doesn&#39;t invalidate anything.  The problem turned out to be something else, as is a lot of cases in coding.  Try to keep up."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1453338160, "post_id": 34910803, "comment_id": 57562588, "body": "I didn&#39;t tell you anything. I politely reminded you that if you want other people to do <i>your</i> work for free, it would be nice if you could put in the effort of editing the question into a shape where it can be answered without having to play a game of 20 questions, in order to <i>clarify</i> your question but not <i>change</i> it, because if you <i>change</i> the question midway through, then all the effort that people have spent in order to do <i>your</i> work <i>for free</i> would be wasted."}], "answers": [{"comments": [{"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1453325225, "post_id": 34910840, "comment_id": 57557404, "body": "Here is my current issue, on different syntax:  \t\t {:type =&gt; user[1],  :name =&gt; user[1].to_s == &quot;solo&quot; ? &quot;#{ user[2] user[3] (s)} &quot; : &quot;#{ user[4] (g)}&quot;,"}, {"owner": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "reply_to_user": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1453325442, "post_id": 34910840, "comment_id": 57557508, "body": "you need to use <code>&quot;#{user[2]} #{user[3]} (s)&quot;</code> if this is what you are expecting"}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1453325490, "post_id": 34910840, "comment_id": 57557528, "body": "Changed it to that, and it&#39;s hanging up on #{user[2]}.  user[1] == &quot;solo&quot; ? puts &quot;#{user[2]} #{user[3]} (s)&quot; : puts &quot;#{user[4]} (g)&quot;"}, {"owner": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "reply_to_user": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1453325636, "post_id": 34910840, "comment_id": 57557614, "body": "remove <code>puts</code> from the ternary"}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1453325872, "post_id": 34910840, "comment_id": 57557735, "body": "Done.  I think it was my string interpolation slip.  Thanks."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1453337890, "post_id": 34910840, "comment_id": 57562498, "body": "Downvoted. The first line of code isn&#39;t even syntactically valid. And the last part is completely unrelated to the question."}, {"owner": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1453339591, "post_id": 34910840, "comment_id": 57562987, "body": "@J&#246;rgWMittag Thanks for pointing out the typo. The last part is based on OP&#39;s comments. OP needs to update question with the required details."}], "tags": [], "owner": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "is_accepted": true, "score": 3, "last_activity_date": 1453339490, "last_edit_date": 1453339490, "creation_date": 1453325037, "answer_id": 34910840, "question_id": 34910803, "link": "https://stackoverflow.com/questions/34910803/ruby-ternary-inside-hash-build/34910840#34910840", "title": "Ruby Ternary Inside Hash Build", "body": "<p>You need to assign the values by using <code>=</code> (assignment operator) and not <code>=&gt;</code>.</p>\n\n<p>Try:</p>\n\n<pre><code>h[:alpha] = a &gt; 3 ? true : false\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>2.1.2-perf :001 &gt; a = 5\n =&gt; 5\n2.1.2-perf :002 &gt; h = {}\n =&gt; {}\n2.1.2-perf :005 &gt; h[:alpha] = (a &gt; 3 ? true : false)\n =&gt; true\n2.1.2-perf :006 &gt; h[:alpha]\n =&gt; true\n</code></pre>\n\n<p>Edit (As per your comments):</p>\n\n<pre><code>2.1.2-perf :014 &gt; user = [1,2,3,4,5]\n =&gt; [1, 2, 3, 4, 5]\n2.1.2-perf :016 &gt; user[1] == \"solo\" ? \"#{user[2]} #{user[3]} (s)\" : \"#{user[4]} (g)\"\n =&gt; \"5 (g)\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1453325797, "post_id": 34911016, "comment_id": 57557695, "body": "That was to test a compound ternary.  The actual case is different, which is in the comments above."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 4, "creation_date": 1453325872, "post_id": 34911016, "comment_id": 57557734, "body": "@Rich_F Don&#39;t put important information in a comment. Add it to your question to make it clear."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1453326442, "post_id": 34911016, "comment_id": 57558055, "body": "@Rich_F also compound ternary makes for code smell. It is difficult to read and interpret if the logic needs more than an if else then ternary is not the best solution and you are better off writing a method to handle this."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 2, "creation_date": 1453337427, "post_id": 34911016, "comment_id": 57562356, "body": "This is the correct answer. This should be the accepted one, not the other one which contains a <code>SyntaxError</code> and doesn&#39;t even parse properly."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 4, "last_activity_date": 1453325625, "creation_date": 1453325625, "answer_id": 34911016, "question_id": 34910803, "link": "https://stackoverflow.com/questions/34910803/ruby-ternary-inside-hash-build/34911016#34911016", "title": "Ruby Ternary Inside Hash Build", "body": "<p>Almost always when a beginner is using a literal <code>true</code> or <code>false</code>, that is unnecessary. In this case, you don't need a ternary at all.</p>\n\n<pre><code>a = 5\nh = {}\nh[:alpha] = a &gt; 3\nh[:alpha] # =&gt; true\n</code></pre>\n"}], "owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 454, "favorite_count": 0, "accepted_answer_id": 34910840, "answer_count": 2, "score": -4, "last_activity_date": 1453339490, "creation_date": 1453324916, "last_edit_date": 1453336880, "question_id": 34910803, "link": "https://stackoverflow.com/questions/34910803/ruby-ternary-inside-hash-build", "title": "Ruby Ternary Inside Hash Build", "body": "<p>Looking for a way to include a ternary conditional inside a hash assignment.</p>\n\n<pre><code>a = 5\nh = {}\nh[:alpha] =&gt; a &gt; 3 ? true : false  # edited twice\nh[:alpha] =&gt; (a &gt; 3 ? true : false)    # edited twice\n</code></pre>\n\n<p>There has to be a way of shortening this up.  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "security"], "comments": [{"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 0, "creation_date": 1453325054, "post_id": 34910715, "comment_id": 57557287, "body": "First eval returns the string with the code to be evaluated."}, {"owner": {"reputation": 85078, "user_id": 31610, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/20571f32acd27d2cf5f1b1f42ea1a75b?s=128&d=identicon&r=PG", "display_name": "Geo", "link": "https://stackoverflow.com/users/31610/geo"}, "reply_to_user": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 0, "creation_date": 1453325346, "post_id": 34910715, "comment_id": 57557462, "body": "@BroiSatse, running the code in irb, already executes it, and the 2nd eval tries to evaluate nil ( the return of puts )"}, {"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 0, "creation_date": 1453326471, "post_id": 34910715, "comment_id": 57558077, "body": "That&#39;s the point - you want to execute the code so you expect <code>nil</code> as result. Otherwise you just got command string. Not that it will also print the string."}], "answers": [{"tags": [], "owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "is_accepted": true, "score": 1, "last_activity_date": 1453330156, "last_edit_date": 1453330156, "creation_date": 1453326412, "answer_id": 34911240, "question_id": 34910715, "link": "https://stackoverflow.com/questions/34910715/why-is-the-author-calling-eval-twice-in-this-blog-post/34911240#34911240", "title": "Why is the author calling eval twice in this blog post?", "body": "<p>The application is using <code>send</code> to evaluate the function with its arguments. Since <code>eval</code> only expects a single argument, there cannot be any spaces in the second argument. In short, the expression with double evals is executed as:</p>\n\n<pre><code>c.send(\"eval\", \"eval('puts^\"Hello^world!\\\"'.gsub('^',('^'.ord-62).chr)\"\n</code></pre>\n\n<p>That is equivalent to:</p>\n\n<pre><code>c.eval \"eval('puts^\"Hello^world!\\\"'.gsub('^',('^'.ord-62).chr)\"\n</code></pre>\n\n<p>Which in turn will do the same thing as:</p>\n\n<pre><code>eval('puts^\"Hello^world!\\\"'.gsub('^',('^'.ord-62).chr)\n</code></pre>\n\n<p>which is:</p>\n\n<pre><code>eval('puts \"Hello world!\"')   #=&gt; Code is actually evaluating\n</code></pre>\n\n<p>With a single <code>eval</code> you would get:</p>\n\n<pre><code>#input\neval 'puts^\"Hello^world!\"'.gsub('^',('^'.ord-62).chr)\n\nc.send(\"eval\" \"'puts^\\\"Hello^world!\\\"'.gsub('^',('^'.ord-62).chr)\"\nc.eval \"'puts^\\\"Hello^world!\\\"'.gsub('^',('^'.ord-62).chr)\"\n\n#=&gt; \"puts \\\"Hello world!\\\"\"\n#=&gt; results in a string containing the code. Code is not executed.  \n</code></pre>\n"}], "owner": {"reputation": 85078, "user_id": 31610, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/20571f32acd27d2cf5f1b1f42ea1a75b?s=128&d=identicon&r=PG", "display_name": "Geo", "link": "https://stackoverflow.com/users/31610/geo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 34911240, "answer_count": 1, "score": -3, "last_activity_date": 1453330156, "creation_date": 1453324629, "last_edit_date": 1453325261, "question_id": 34910715, "link": "https://stackoverflow.com/questions/34910715/why-is-the-author-calling-eval-twice-in-this-blog-post", "title": "Why is the author calling eval twice in this blog post?", "body": "<p>I've been reading the <a href=\"https://briandamaged.org/blog/rails-application-hijacking-part-2/\" rel=\"nofollow\">following blog post</a> , and it's unclear to me why is the author calling <code>eval</code> twice. Wouldn't calling <code>eval</code> just once suffice?</p>\n\n<p>His controller code is this:</p>\n\n<pre><code>class GameController &lt; ApplicationController\n   def index\n   end\n\n   def handle_command\n     command = params[:command].split\n\n     c = CommandHandler.new\n\n     begin\n       @result = c.send(*command)\n     rescue Exception =&gt;; e\n      @result = \"Stop being an idiot, and do something useful!\"\n    end\n\n  end\nend\n</code></pre>\n\n<p>And example code execution exploits were like this:</p>\n\n<pre><code>eval eval('puts^\"Hello^world!\"'.gsub('^',('^'.ord-62).chr))\n</code></pre>\n\n<p>The thing I don't understand is why there is a need for 2 evals, running this in irb, already prints the string by the first eval, and the second eval tries to evaluate nil.</p>\n"}, {"tags": ["ios", "ruby", "google-maps", "appium"], "comments": [{"owner": {"reputation": 3050, "user_id": 2399772, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nS7s0.jpg?s=128&g=1", "display_name": "Demitrian", "link": "https://stackoverflow.com/users/2399772/demitrian"}, "edited": false, "score": 0, "creation_date": 1453325285, "post_id": 34910713, "comment_id": 57557439, "body": "What have you tried so far? Do you have some code to provide where we can see what the issue is?"}, {"owner": {"reputation": 11, "user_id": 5817993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/796007c311c0668a422f99819855d0dd?s=128&d=identicon&r=PG&f=1", "display_name": "Hal D", "link": "https://stackoverflow.com/users/5817993/hal-d"}, "reply_to_user": {"reputation": 3050, "user_id": 2399772, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nS7s0.jpg?s=128&g=1", "display_name": "Demitrian", "link": "https://stackoverflow.com/users/2399772/demitrian"}, "edited": false, "score": 0, "creation_date": 1453328169, "post_id": 34910713, "comment_id": 57558989, "body": "Thanks for your questions, David.  I updated the &quot;Solutions I have tried&quot; section with some examples of code I have tried to tap at coordinates and switch contexts."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5817993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/796007c311c0668a422f99819855d0dd?s=128&d=identicon&r=PG&f=1", "display_name": "Hal D", "link": "https://stackoverflow.com/users/5817993/hal-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1453408224, "last_edit_date": 1592644375, "creation_date": 1453408224, "answer_id": 34933718, "question_id": 34910713, "link": "https://stackoverflow.com/questions/34910713/how-can-i-tap-a-pin-on-google-maps-using-appium-in-an-ios-app/34933718#34933718", "title": "How can I tap a pin on Google Maps using Appium in an iOS app?", "body": "<p>So I figured it out!  After looking through other ideas of executing javascript, looking at porting the tests over to Xcode, etc., I started examining &quot;Appium::TouchAction&quot; again, mostly through the site <a href=\"http://www.rubydoc.info/github/appium/ruby_lib/Appium/TouchAction\" rel=\"nofollow noreferrer\">http://www.rubydoc.info/github/appium/ruby_lib/Appium/TouchAction</a></p>\n<p>I was using this (as noted above):</p>\n<pre><code>Appium::TouchAction.new.tap(x: 100, y: 200, fingers:1).release.perform\n</code></pre>\n<p>Looking at the different methods on that webpage for TouchAction, I noticed there is also a &quot;press&quot; action.  So, I tried that:</p>\n<pre><code>Appium::TouchAction.new.press(x: 100, y: 200).wait(5).release.perform\n</code></pre>\n<p>This worked like a charm!  I wondered - was it the &quot;press&quot; that worked or the &quot;wait(5)&quot;?  I tried the &quot;press&quot; code again without the &quot;wait&quot; and it failed.  I then tried it with the &quot;wait&quot; and with a &quot;tap&quot;:</p>\n<pre><code>Appium::TouchAction.new.tap(x: 100, y: 200).wait(5).release.perform\n</code></pre>\n<p>This worked, too.</p>\n<h2>Conclusion:</h2>\n<p>I fixed the issue by adding &quot;.wait(5)&quot; after the tap</p>\n"}], "owner": {"reputation": 11, "user_id": 5817993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/796007c311c0668a422f99819855d0dd?s=128&d=identicon&r=PG&f=1", "display_name": "Hal D", "link": "https://stackoverflow.com/users/5817993/hal-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1373, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453408224, "creation_date": 1453324623, "last_edit_date": 1453358536, "question_id": 34910713, "link": "https://stackoverflow.com/questions/34910713/how-can-i-tap-a-pin-on-google-maps-using-appium-in-an-ios-app", "title": "How can I tap a pin on Google Maps using Appium in an iOS app?", "body": "<blockquote>\n  <p>Problem:</p>\n</blockquote>\n\n<p>I'm having an issue using Appium to test Google Maps implemented in a native, internal iOS app.  Specifically, I cannot get Appium to interact with the pins generated by the app that appear in the map.  The pins cannot be found or identified in any way through Appium inspector.  </p>\n\n<p>The expectation is that when I click a pin an information box will appear above it with pertinent data.</p>\n\n<blockquote>\n  <p>Questions:</p>\n</blockquote>\n\n<p>How can I get Appium to start interacting with those Google Map pins in my native iOS app?  Is Appium capable of this?  If not, what should I be using for this testing?</p>\n\n<blockquote>\n  <p>Solutions I have tried (unsuccessfully):</p>\n</blockquote>\n\n<ul>\n<li><p><strong>Clicking at the coordinates of the pin</strong>.  Since I set the location on the map every time it opens, and since I know what pins will be there and where, I figured that I could just have Appium tap at an X/Y coordinate.  Unfortunately, this does not work - nothing happens.  Here's what I used to try to tap at the specific X/Y coordinate: </p>\n\n<p><code>Appium::TouchAction.new.tap(x: 100, y: 200, fingers:1).release.perform</code></p></li>\n<li><p><strong>Switching to WEBVIEW_3</strong>.  I tried switching the context of the driver to Webview_3, thinking that might work.  Unfortunately, when I do this, the driver doesn't recognize ANY elements in the app, rendering it useless.  Here's the code I used to try this:</p>\n\n<p><code>set_context \u201cWEBVIEW_3\"\nget_page_class</code></p>\n\n<p>'get_page_class' returns nil, meaning there are no elements found in this context.  When I run it in \"NATIVE_APP\", many elements are found.</p></li>\n</ul>\n\n<blockquote>\n  <p>Information on what I'm using:</p>\n</blockquote>\n\n<ul>\n<li>Appium 1.4.13</li>\n<li>Ruby 2.2.1p85 (2015-02-26 revision 49769) [x86_64-darwin14] </li>\n<li>appium_lib (8.0.1, 8.0.0, 7.0.0, 6.0.0)</li>\n<li>Simulator: iPad Air 2, iOS 9.0, Portrait orientation (have tried other device and iOS implementations - none work)</li>\n<li>Xcode 7.1.1 (7B1005)</li>\n</ul>\n"}, {"tags": ["ruby", "shell", "string-interpolation"], "comments": [{"owner": {"reputation": 2260, "user_id": 5687152, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/J754G.jpg?s=128&g=1", "display_name": "mabe02", "link": "https://stackoverflow.com/users/5687152/mabe02"}, "edited": false, "score": 1, "creation_date": 1453324214, "post_id": 34910436, "comment_id": 57556817, "body": "What is the output for <code>puts &quot;curl -I #{x} | perl -n -e &#39;&#47;^Location: (.*)$&#47; &amp;&amp; print \\&quot;$1\\n\\&quot;&#39; &gt;&gt; finalURLs.txt&quot; </code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 1575454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda854af9e2217e63cf139850dc6246c?s=128&d=identicon&r=PG", "display_name": "user1575454", "link": "https://stackoverflow.com/users/1575454/user1575454"}, "edited": false, "score": 0, "creation_date": 1453476432, "post_id": 34910908, "comment_id": 57631849, "body": "Thanks mabe02. That&#39;s exactly what I was getting wrong. It&#39;s working now. To follow up, while printing &quot;$1&quot;, I get an extra linebreak. I&#39;m trying to add both URLs in one line separated by a comma. Currently print\\&quot;#{x},$1\\n\\&quot; adds an extra line break between the two URLs. Do you know what I could be doing wrong there?"}], "tags": [], "owner": {"reputation": 2260, "user_id": 5687152, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/J754G.jpg?s=128&g=1", "display_name": "mabe02", "link": "https://stackoverflow.com/users/5687152/mabe02"}, "is_accepted": true, "score": 0, "last_activity_date": 1453325271, "creation_date": 1453325271, "answer_id": 34910908, "question_id": 34910436, "link": "https://stackoverflow.com/questions/34910436/string-interpolation-while-running-shell-command-through-ruby/34910908#34910908", "title": "String interpolation while running shell command through ruby?", "body": "<p>In order to pass two commands to a shell, you should run the system command twice (check <a href=\"https://devver.wordpress.com/2009/10/12/ruby-subprocesses-part_3/\" rel=\"nofollow\">method 8 in this post</a>)</p>\n\n<pre><code>require 'shell'\nsh = Shell.new\nIO.foreach(\"shortURLs.txt\") { |x| sh.system(\"curl -I #{x}\")  | sh.system(\"perl -n -e '/^Location: (.*)$/ &amp;&amp; print \\\"$1\\n\\\" ' \") &gt;&gt;  \"finalURLs.txt\" }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "is_accepted": false, "score": 0, "last_activity_date": 1453365016, "creation_date": 1453365016, "answer_id": 34918751, "question_id": 34910436, "link": "https://stackoverflow.com/questions/34910436/string-interpolation-while-running-shell-command-through-ruby/34918751#34918751", "title": "String interpolation while running shell command through ruby?", "body": "<p><code>IO.foreach</code> yields the lines including the new line at the end so you're actually executing</p>\n\n<pre><code>curl -I https://bit.ly/1mJk8X7\n| perl -n -e  ...\n</code></pre>\n\n<p>Which is why you get the syntax error. You could use <code>strip</code> to remove the new line from. I think the \\n in the call to print will also get substituted before the string is passed to system. You may be interested in <a href=\"http://ruby-doc.org/stdlib-2.3.0/libdoc/shellwords/rdoc/Shellwords.html\" rel=\"nofollow\">shellwords</a> which has functions for escaping strings before passing them to a shell.</p>\n\n<p>You could of course dodge the issue entirely and use ruby to get the redirect locations </p>\n\n<pre><code>require 'net/http'\nrequire 'uri'\n\nIO.foreach(\"shortURLs.txt\") do  |url|\n  puts Net::HTTP.get_response(URI.parse(url))[\"Location\"]\nend\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 1575454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda854af9e2217e63cf139850dc6246c?s=128&d=identicon&r=PG", "display_name": "user1575454", "link": "https://stackoverflow.com/users/1575454/user1575454"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 710, "favorite_count": 1, "accepted_answer_id": 34910908, "answer_count": 2, "score": 0, "last_activity_date": 1453365016, "creation_date": 1453323705, "question_id": 34910436, "link": "https://stackoverflow.com/questions/34910436/string-interpolation-while-running-shell-command-through-ruby", "title": "String interpolation while running shell command through ruby?", "body": "<p>Struggling with string interpolation while executing a shell command in ruby. Can you someone please help me identify what I'm missing here?</p>\n\n<ol>\n<li>My one-liner ruby code follows redirects of any shortURL and returns the final URL. For example, this ruby code works perfectly fine.</li>\n</ol>\n\n<p><code>curl -I https://bit.ly/1mJk8X7 | perl -n -e '/^Location: (.*)$/ &amp;&amp; print \"$1\\n\"'</code>\nIt prints out the final URL.</p>\n\n<ol start=\"2\">\n<li>I have a .txt file with a series of short URLs from which I'd like to derive a list of the final URLs. Say, it's called shortURLs.txt. I'm using IO.foreach to loop through each line in the file, but I don't know what I'm doing wrong to bring the variable 'x' into the ruby command. This is my first time working with string interpolation, and I've tried various combinations of it, but no luck yet.</li>\n</ol>\n\n<p><code>IO.foreach(\"shortURLs.txt\") { |x| system \"curl -I #{x} | perl -n -e '/^Location: (.*)$/ &amp;&amp; print \\\"$1\\n\\\"' &gt;&gt; finalURLs.txt\" }</code></p>\n\n<p>I get an error message around the pipe '|' symbol:</p>\n\n<p><code>sh: -c: line 1: syntax error near unexpected token</code>|'\nsh: -c: line 1: <code>| perl -n -e '/^Location: (.*)$/ &amp;&amp; print \"https://bit.ly/1mJk8X7'</code></p>\n\n<p>Other threads have been useful about <a href=\"https://stackoverflow.com/questions/10091156/why-does-string-interpolation-work-in-ruby-when-there-are-no-curly-braces\">string interpolation</a> and running <a href=\"https://stackoverflow.com/questions/2232/calling-shell-commands-from-ruby\">shell commands through ruby</a>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "spree", "rbenv"], "comments": [{"owner": {"reputation": 2549, "user_id": 3284936, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/TDrZU.jpg?s=128&g=1", "display_name": "dimitry_n", "link": "https://stackoverflow.com/users/3284936/dimitry-n"}, "edited": false, "score": 0, "creation_date": 1453322311, "post_id": 34909995, "comment_id": 57555780, "body": "try setting your Ruby version explicitly in your Gemfile like so: <code>ruby &#39;2.1.0&#39;</code>"}, {"owner": {"reputation": 3796, "user_id": 3686898, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IvIuI.jpg?s=128&g=1", "display_name": "Philipp Meissner", "link": "https://stackoverflow.com/users/3686898/philipp-meissner"}, "edited": false, "score": 0, "creation_date": 1453323694, "post_id": 34909995, "comment_id": 57556526, "body": "Try running it with <code>bundle exec bundle install</code> to make sure it uses the ruby version in the context of your current apps directory."}, {"owner": {"reputation": 36, "user_id": 2633846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0120ebd0917f4d968efad99e7984683?s=128&d=identicon&r=PG", "display_name": "Devang Bacharwar", "link": "https://stackoverflow.com/users/2633846/devang-bacharwar"}, "edited": false, "score": 0, "creation_date": 1453324747, "post_id": 34909995, "comment_id": 57557114, "body": "I tried setting <code>rails &#39;2.2.3&#39;</code> it gives that the ruby being used is <code>ruby &#39;2.0.0&#39;</code> so I think it must be some problem with <code>rbenv</code> usage. Any suggestions on how to fix that?"}, {"owner": {"reputation": 36, "user_id": 2633846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0120ebd0917f4d968efad99e7984683?s=128&d=identicon&r=PG", "display_name": "Devang Bacharwar", "link": "https://stackoverflow.com/users/2633846/devang-bacharwar"}, "edited": false, "score": 0, "creation_date": 1453325943, "post_id": 34909995, "comment_id": 57557767, "body": "Thanks, The problem was with my rails installation. I installed rails with <code>sudo</code> permissions which sent it to system directory and was using system version of ruby. Did a rails install without sudo and <code>rbenv rehash</code> and it worked."}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 5799819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f29a162766d958061471d76d0b233ca?s=128&d=identicon&r=PG&f=1", "display_name": "yhirano55", "link": "https://stackoverflow.com/users/5799819/yhirano55"}, "is_accepted": false, "score": 0, "last_activity_date": 1453325491, "creation_date": 1453325491, "answer_id": 34910979, "question_id": 34909995, "link": "https://stackoverflow.com/questions/34909995/solidus-gem-showing-error-regarding-ruby-version-during-bundle-install/34910979#34910979", "title": "Solidus gem showing error regarding ruby version during bundle install", "body": "<p>Try to set <code>ruby '2.2.3'</code> in Gemfile, and execute <code>bundle install</code>. </p>\n\n<p>If it's not resolved, please check your bundle path to execute this:</p>\n\n<pre><code>$ which bundle\n/usr/bin/bundle # global\n$ gem install bundler\n$ bundle install --path vendor/bundle\n</code></pre>\n"}], "owner": {"reputation": 36, "user_id": 2633846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0120ebd0917f4d968efad99e7984683?s=128&d=identicon&r=PG", "display_name": "Devang Bacharwar", "link": "https://stackoverflow.com/users/2633846/devang-bacharwar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453325491, "creation_date": 1453322159, "question_id": 34909995, "link": "https://stackoverflow.com/questions/34909995/solidus-gem-showing-error-regarding-ruby-version-during-bundle-install", "title": "Solidus gem showing error regarding ruby version during bundle install", "body": "<p>I am trying to install Solidus gem which is a fork of spree and while running <code>bundle install</code> this shows up</p>\n\n<pre><code>Installing solidus_core 1.1.0\n\nGem::InstallError: solidus_core requires Ruby version &gt;= 2.1.0.\nAn error occurred while installing solidus_core (1.1.0), and Bundler cannot\ncontinue.\n</code></pre>\n\n<p>even when I am running ruby version 2.2.3</p>\n\n<pre><code>ruby -v\nruby 2.2.3p173 (2015-08-18 revision 51636) [x86_64-darwin15]\n</code></pre>\n\n<p>I am using rbenv on OS X El Capitan to control the ruby versions. Is there a problem with ruby version control or any other issue?</p>\n"}, {"tags": ["ios", "ruby", "rubymotion"], "comments": [{"owner": {"reputation": 2556, "user_id": 2111584, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/e3uBy.png?s=128&g=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/2111584/nathan"}, "edited": false, "score": 0, "creation_date": 1453321736, "post_id": 34909478, "comment_id": 57555415, "body": "Do you have any more precise direction than &quot;Displace?&quot;"}, {"owner": {"reputation": 63, "user_id": 4874508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42f1562a816db17e81f9b3b3ba71ea00?s=128&d=identicon&r=PG&f=1", "display_name": "Marseca", "link": "https://stackoverflow.com/users/4874508/marseca"}, "reply_to_user": {"reputation": 2556, "user_id": 2111584, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/e3uBy.png?s=128&g=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/2111584/nathan"}, "edited": false, "score": 0, "creation_date": 1453367725, "post_id": 34909478, "comment_id": 57573134, "body": "The center of label is set in the left corner of the object by default. I want to set this center in the middle: width/2 and height/2"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 6784318, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qMLN0.jpg?s=128&g=1", "display_name": "Mike K", "link": "https://stackoverflow.com/users/6784318/mike-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1472786051, "creation_date": 1472786051, "answer_id": 39283772, "question_id": 34909478, "link": "https://stackoverflow.com/questions/34909478/how-can-i-change-the-center-of-my-label-with-rubymotionquery/39283772#39283772", "title": "How can I change the center of my label with RubymotionQuery?", "body": "<p>Here is a basic label, positioned in the center of the frame. You can easily displace it by adjusting the <em>center</em> attribute for the label.</p>\n\n<pre><code>def self.controller\n  @controller ||= MyController.alloc.initWithNibName(nil, bundle:nil)\nend\n\ndef viewDidLoad\n  super\n\n  @height = view.frame.size.height\n  @width  = view.frame.size.width\n\n  build_label\nend\n\ndef build_label\n  @label = UILabel.alloc.init\n  @label.text = 'Label'\n  @label.textAlignment = UITextAlignmentCenter\n  # the size of the label\n  @label.frame  = [[0, @height / 12], [@width / 2, @height / 6]]\n  # center of label\n  @label.center = [@width / 2, @height / 2]\n  self.view.addSubview(@label)\nend\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 4874508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42f1562a816db17e81f9b3b3ba71ea00?s=128&d=identicon&r=PG&f=1", "display_name": "Marseca", "link": "https://stackoverflow.com/users/4874508/marseca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472786051, "creation_date": 1453320364, "question_id": 34909478, "link": "https://stackoverflow.com/questions/34909478/how-can-i-change-the-center-of-my-label-with-rubymotionquery", "title": "How can I change the center of my label with RubymotionQuery?", "body": "<p>I want to displace the center of my label in my stylesheet. I try to use this:</p>\n\n<pre><code>st.frame = {l:0,t:-30,w:50,h:50}\nst.text = FontAwesome.icon(\"search\")\nst.font = FontAwesome.fontWithSize(st.frame.size.height/2)\nst.background_color = color.green\nst.size_to_fit\nst.text_alignment = :center\nst.center.x = st.frame.size.width/2\nst.center.y = st.frame.size.height/2\n</code></pre>\n\n<p>Buuuut...It does\u00b4t work. </p>\n\n<p>Anyone can help me?</p>\n\n<p>Greetings!</p>\n"}, {"tags": ["ruby", "json"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1453320308, "post_id": 34909451, "comment_id": 57554596, "body": "What is your question?"}, {"owner": {"reputation": 19, "user_id": 5817837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166fb8f5b3ae124613daf29cd76d37e?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Li", "link": "https://stackoverflow.com/users/5817837/jack-li"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1453320654, "post_id": 34909451, "comment_id": 57554792, "body": "How to fix it to make the parse work?"}, {"owner": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "edited": false, "score": 0, "creation_date": 1453320892, "post_id": 34909451, "comment_id": 57554917, "body": "Can you show what <code>response.body</code> looks like?"}, {"owner": {"reputation": 19, "user_id": 5817837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166fb8f5b3ae124613daf29cd76d37e?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Li", "link": "https://stackoverflow.com/users/5817837/jack-li"}, "reply_to_user": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "edited": false, "score": 0, "creation_date": 1453321047, "post_id": 34909451, "comment_id": 57555011, "body": "@Atri it&#39;s too long to fit here. {   &quot;age_result&quot;: [     {       &quot;column_id&quot;: [         &quot;B01001003&quot;,          &quot;B01001027&quot;       ],        &quot;name&quot;: &quot;Under 5 years&quot;,        &quot;number&quot;: [         6774.0,          6416.0       ]     },      {       &quot;column_id&quot;: [         &quot;B01001004&quot;,          &quot;B01001028&quot;       ],        &quot;name&quot;: &quot;5 to 9 years&quot;,        &quot;number&quot;: [         5981.0,          6470.0       ]     },      {       &quot;column_id&quot;: [         &quot;B01001005&quot;,          &quot;B01001029&quot;       ] } This is part of it."}, {"owner": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "edited": false, "score": 0, "creation_date": 1453322763, "post_id": 34909451, "comment_id": 57556032, "body": "@JackLi check my answer if that helps."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1453323519, "post_id": 34909451, "comment_id": 57556428, "body": "Welcome to Stack Overflow. You&#39;re getting down votes because you didn&#39;t ask a good question. Please read &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot;, &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1453323599, "post_id": 34909451, "comment_id": 57556471, "body": "&quot;<code>unexpected token at &#39;#{response.body}&#39;</code>&quot; JSON is telling you exactly what the problem was, that the input made no sense. But <i>WHY</i> are you trying to embed a string into another string forcing it to be interpolated? Don&#39;t do that, simply put the string variable in as the parameter. <code>JSON.parse(response.body)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 5817837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166fb8f5b3ae124613daf29cd76d37e?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Li", "link": "https://stackoverflow.com/users/5817837/jack-li"}, "edited": false, "score": 0, "creation_date": 1453320551, "post_id": 34909484, "comment_id": 57554727, "body": "JSON.parse(response.body) does not work. It&#39;s telling me:ERROR TypeError: no implicit conversion of Array into String. I used is_a? to check if response.body is a string and the output is true."}, {"owner": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "reply_to_user": {"reputation": 19, "user_id": 5817837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166fb8f5b3ae124613daf29cd76d37e?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Li", "link": "https://stackoverflow.com/users/5817837/jack-li"}, "edited": false, "score": 0, "creation_date": 1453320746, "post_id": 34909484, "comment_id": 57554835, "body": "@JackLi use <code>response.body.to_s</code> if <code>response.body</code> is an Array."}, {"owner": {"reputation": 19, "user_id": 5817837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166fb8f5b3ae124613daf29cd76d37e?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Li", "link": "https://stackoverflow.com/users/5817837/jack-li"}, "reply_to_user": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "edited": false, "score": 0, "creation_date": 1453320899, "post_id": 34909484, "comment_id": 57554923, "body": "@Atri response.body is a string. I checked with is_a?"}, {"owner": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "reply_to_user": {"reputation": 19, "user_id": 5817837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166fb8f5b3ae124613daf29cd76d37e?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Li", "link": "https://stackoverflow.com/users/5817837/jack-li"}, "edited": false, "score": 0, "creation_date": 1453321030, "post_id": 34909484, "comment_id": 57555001, "body": "@JackLi can you show the content of <code>response.body</code> by printing it?"}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 4, "last_activity_date": 1453320379, "creation_date": 1453320379, "answer_id": 34909484, "question_id": 34909451, "link": "https://stackoverflow.com/questions/34909451/json-parse-not-working/34909484#34909484", "title": "JSON.parse not working", "body": "<p>Single quotes do not expand interpolation. <code>JSON.parse(response.body)</code> or <code>JSON.parse(\"#{response.body}\")</code> shall work.</p>\n"}, {"tags": [], "owner": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "is_accepted": false, "score": 1, "last_activity_date": 1453324677, "last_edit_date": 1453324677, "creation_date": 1453321285, "answer_id": 34909734, "question_id": 34909451, "link": "https://stackoverflow.com/questions/34909451/json-parse-not-working/34909734#34909734", "title": "JSON.parse not working", "body": "<p>Since you mentioned that <code>response.body</code> is a String, you can do <code>JSON.parse(response.body)</code>. You don't need to interpolate it.</p>\n\n<p>According to the example you gave in the comment, it works fine:</p>\n\n<pre><code>2.1.2-perf :007 &gt; s =  '{ \"age_result\": [ { \"column_id\": [ \"B01001003\", \"B01001027\" ], \"name\": \"Under 5 years\", \"number\": [ 6774.0, 6416.0 ] }, { \"column_id\": [ \"B01001004\", \"B01001028\" ], \"name\": \"5 to 9 years\", \"number\": [ 5981.0, 6470.0 ] }] }'\n =&gt; \"{ \\\"age_result\\\": [ { \\\"column_id\\\": [ \\\"B01001003\\\", \\\"B01001027\\\" ], \\\"name\\\": \\\"Under 5 years\\\", \\\"number\\\": [ 6774.0, 6416.0 ] }, { \\\"column_id\\\": [ \\\"B01001004\\\", \\\"B01001028\\\" ], \\\"name\\\": \\\"5 to 9 years\\\", \\\"number\\\": [ 5981.0, 6470.0 ] }] }\"\n2.1.2-perf :008 &gt; JSON.parse(s)\n =&gt; {\"age_result\"=&gt;[{\"column_id\"=&gt;[\"B01001003\", \"B01001027\"], \"name\"=&gt;\"Under 5 years\", \"number\"=&gt;[6774.0, 6416.0]}, {\"column_id\"=&gt;[\"B01001004\", \"B01001028\"], \"name\"=&gt;\"5 to 9 years\", \"number\"=&gt;[5981.0, 6470.0]}]}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 5817837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166fb8f5b3ae124613daf29cd76d37e?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Li", "link": "https://stackoverflow.com/users/5817837/jack-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 652, "favorite_count": 0, "closed_date": 1453372503, "answer_count": 2, "score": -6, "last_activity_date": 1453324677, "creation_date": 1453320271, "last_edit_date": 1453323306, "question_id": 34909451, "link": "https://stackoverflow.com/questions/34909451/json-parse-not-working", "closed_reason": "Not suitable for this site", "title": "JSON.parse not working", "body": "<p>I'm trying to parse a JSON returned by a post request. I have the following code:</p>\n\n<pre><code>response = RestClient.post \"http://localhost:4567\", request.body.read,:content_type =&gt; :json, :accept =&gt; :json\nresult = JSON.parse('#{response.body}')\n</code></pre>\n\n<p>It's giving me the following error:</p>\n\n<pre><code>JSON::ParserError - 757: unexpected token at '#{response.body}':\n</code></pre>\n\n<p>I have checked that <code>response.body</code> returns correct JSON. If I copy the content of the JSON and paste it into <code>JSON.parse</code> it works perfectly. However when I use the variable it does not work.  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rake"], "answers": [{"comments": [{"owner": {"reputation": 560, "user_id": 5232293, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/gSyD1.jpg?s=128&g=1", "display_name": "Jakub Kopy\u015b", "link": "https://stackoverflow.com/users/5232293/jakub-kopy%c5%9b"}, "edited": false, "score": 0, "creation_date": 1453321441, "post_id": 34909739, "comment_id": 57555239, "body": "Yeah, I noticed the lack of keys :D"}, {"owner": {"reputation": 560, "user_id": 5232293, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/gSyD1.jpg?s=128&g=1", "display_name": "Jakub Kopy\u015b", "link": "https://stackoverflow.com/users/5232293/jakub-kopy%c5%9b"}, "edited": false, "score": 0, "creation_date": 1453321887, "post_id": 34909739, "comment_id": 57555507, "body": "but the same error still occurs... I guess I am making too much requests to this API? Is there a way to solve this? It does not show this error only if I make this loop small like <code>currencies[0..2].each</code>"}, {"owner": {"reputation": 3467, "user_id": 1656986, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dee00413df2670bfeb89bb585f91cb13?s=128&d=identicon&r=PG&f=1", "display_name": "Raghvendra Parashar", "link": "https://stackoverflow.com/users/1656986/raghvendra-parashar"}, "reply_to_user": {"reputation": 560, "user_id": 5232293, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/gSyD1.jpg?s=128&g=1", "display_name": "Jakub Kopy\u015b", "link": "https://stackoverflow.com/users/5232293/jakub-kopy%c5%9b"}, "edited": false, "score": 0, "creation_date": 1453321987, "post_id": 34909739, "comment_id": 57555575, "body": "try to put the sleep in inner look also"}, {"owner": {"reputation": 560, "user_id": 5232293, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/gSyD1.jpg?s=128&g=1", "display_name": "Jakub Kopy\u015b", "link": "https://stackoverflow.com/users/5232293/jakub-kopy%c5%9b"}, "edited": false, "score": 0, "creation_date": 1453326363, "post_id": 34909739, "comment_id": 57558003, "body": "I changed sleep 2 to sleep 4 and It worked like a charm! Populating 930 conversions took above 1 hour tho :D Thanks for help!"}], "tags": [], "owner": {"reputation": 3467, "user_id": 1656986, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/dee00413df2670bfeb89bb585f91cb13?s=128&d=identicon&r=PG&f=1", "display_name": "Raghvendra Parashar", "link": "https://stackoverflow.com/users/1656986/raghvendra-parashar"}, "is_accepted": true, "score": 1, "last_activity_date": 1453321308, "creation_date": 1453321308, "answer_id": 34909739, "question_id": 34909232, "link": "https://stackoverflow.com/questions/34909232/rails-populate-db-rake-task-openurihttperror-500-internal-server-error/34909739#34909739", "title": "Rails populate db rake task OpenURI::HTTPError: 500 Internal Server Error", "body": "<p>the main problem is here, you are not taking keys of <code>\"rates\"</code></p>\n\n<pre><code>currencies = JSON.load(open('http://api.fixer.io/latest')).keys\n\ncurrencies = JSON.load(open('http://api.fixer.io/latest'))[\"rates\"].keys\n</code></pre>\n\n<hr>\n\n<pre><code>require 'open-uri'\n\nnamespace :db do\n  desc \"Erase and fill database\"\n  task :populate =&gt; :environment do\n    require 'populator'\n\n    [ConversionRate].each(&amp;:delete_all)\n\n    latest_data = JSON.load(open('http://api.fixer.io/latest'))\n\n    currencies = latest_data[\"rates\"].keys\n    n = currencies.count\n\n    currencies.each do |curr1|\n      currencies.each do |curr2|\n        ConversionRate.populate 1 do |cr|\n          #take care of any error, as we are going to call third party api here\n          begin\n            cr.currency1 = curr1\n            cr.currency2 = curr2\n            cr.conversion_rate = JSON.load(open('http://api.fixer.io/latest?base=' + curr1))[\"rates\"][curr2]\n          rescue =&gt; e\n            puts \"error #{e}\"\n          end\n        end\n      end\n      #give a bit rest\n      sleep 2\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 560, "user_id": 5232293, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/gSyD1.jpg?s=128&g=1", "display_name": "Jakub Kopy\u015b", "link": "https://stackoverflow.com/users/5232293/jakub-kopy%c5%9b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 34909739, "answer_count": 1, "score": 1, "last_activity_date": 1453321308, "creation_date": 1453319464, "last_edit_date": 1453320267, "question_id": 34909232, "link": "https://stackoverflow.com/questions/34909232/rails-populate-db-rake-task-openurihttperror-500-internal-server-error", "title": "Rails populate db rake task OpenURI::HTTPError: 500 Internal Server Error", "body": "<p>I am trying to make rake task to populate db from JSON API <a href=\"http://fixer.io\" rel=\"nofollow\">fixer.io</a>,\nbut when i type my rake :<br>\nrake db:populate<br>\nthis error occurs:</p>\n\n<pre><code>OpenURI::HTTPError: 500 Internal Server Error\n/home/jakub/Documents/workspace/exch/lib/tasks/populate.rake:16:in `block (5 levels) in &lt;top (required)&gt;'\n/home/jakub/Documents/workspace/exch/lib/tasks/populate.rake:13:in `block (4 levels) in &lt;top (required)&gt;'\n/home/jakub/Documents/workspace/exch/lib/tasks/populate.rake:12:in `each'\n/home/jakub/Documents/workspace/exch/lib/tasks/populate.rake:12:in `block (3 levels) in &lt;top (required)&gt;'\n/home/jakub/Documents/workspace/exch/lib/tasks/populate.rake:11:in `each'\n/home/jakub/Documents/workspace/exch/lib/tasks/populate.rake:11:in `block (2 levels) in &lt;top (required)&gt;'\nTasks: TOP =&gt; db:populate\n(See full trace by running task with --trace)\n</code></pre>\n\n<p>This is my rake task (populate.rake) in lib/tasks:</p>\n\n<pre><code>require 'open-uri'\n\nnamespace :db do\n  desc \"Erase and fill database\"\n  task :populate =&gt; :environment do\n    require 'populator'\n\n    [ConversionRate].each(&amp;:delete_all)\n    n = JSON.load(open('http://api.fixer.io/latest'))[\"rates\"].keys.count\n    currencies = JSON.load(open('http://api.fixer.io/latest'))[\"rates\"].keys\n    currencies.each do |curr1|\n      currencies.each do |curr2|\n        ConversionRate.populate 1 do |cr|\n          cr.currency1 = curr1\n          cr.currency2 = curr2\n          cr.conversion_rate = JSON.load(open('http://api.fixer.io/latest?base=' + curr1))[\"rates\"][curr2]\n      end\n    end\n  end\n  end\nend\n</code></pre>\n\n<p>Please help me, I have no idea what causes this problem.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "mechanize", "mechanize-ruby"], "answers": [{"comments": [{"owner": {"reputation": 684, "user_id": 4229830, "user_type": "registered", "profile_image": "https://graph.facebook.com/100004832858708/picture?type=large", "display_name": "Mohammad Al Alwa", "link": "https://stackoverflow.com/users/4229830/mohammad-al-alwa"}, "reply_to_user": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1453332872, "post_id": 34912329, "comment_id": 57560941, "body": "Yes. Totally true. I&#39;m gonna fix it."}, {"owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "edited": false, "score": 0, "creation_date": 1453337897, "post_id": 34912329, "comment_id": 57562500, "body": "Works, great, thank you.  Any advice on cleaning up the code?"}], "tags": [], "owner": {"reputation": 684, "user_id": 4229830, "user_type": "registered", "profile_image": "https://graph.facebook.com/100004832858708/picture?type=large", "display_name": "Mohammad Al Alwa", "link": "https://stackoverflow.com/users/4229830/mohammad-al-alwa"}, "is_accepted": true, "score": 2, "last_activity_date": 1453332924, "last_edit_date": 1453332924, "creation_date": 1453330971, "answer_id": 34912329, "question_id": 34909019, "link": "https://stackoverflow.com/questions/34909019/mechanize-in-module-nameerror-agent/34912329#34912329", "title": "Mechanize in Module, Nameerror &#39; agent&#39;", "body": "<p>Ruby has a naming convention. <code>agent</code> is a <em>local variable</em> in the class scope. To make it visible to other methods you should make it a <em>class variable</em> by naming it <code>@@agent</code>, and it'll be shared among all the objects of <code>WebBot</code>. The preferred way though is to make it an <em>instance variable</em> by naming it <code>@agent</code>. Every object of <code>WebBot</code> will have its own <code>@agent</code>. But you should put it in <code>initialize</code>, <code>initialize</code> will be invoked when you create a new object with <code>new</code></p>\n\n<pre><code>class WebBot\n  def initialize\n    @agent = Mechanize.new do |a|\n      a.user_agent_alias = 'Windows Chrome'\n    end\n  end\n.....\n</code></pre>\n\n<p>And the same error will occur to <code>page</code>. You defined it in <code>form</code> as a <em>local variable</em>. When <code>form</code> finishes execution, it'll be deleted. You should make it an <em>instance variable</em>. Fortunately, you don't have to put it in <code>initialize</code>. You can define it here in <code>form</code>. And the object will have its own <code>@page</code> after invoking <code>form</code>. Do this in <code>form</code>:</p>\n\n<pre><code>def form(response)\n  require \"addressable/uri\"\n  require \"addressable/template\"\n  template = Addressable::Template.new(\"http://www.domain.com/{?query*}\")\n  url = template.expand({\"query\" =&gt; response}).to_s\n  @page = agent.get(url)  \nend \n</code></pre>\n\n<p>And remember to change every occurrence of <code>page</code> and <code>agent</code> to <code>@page</code> and <code>@agent</code>. In your <code>get_products</code> for example:</p>\n\n<pre><code>def get_products\n  products = []\n  @page.search(\"datatable\").search('tr').each do |row|\n  .....\n</code></pre>\n\n<p>These changes will resolve the name errors. Refactoring is another story btw.</p>\n"}], "owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 34912329, "answer_count": 1, "score": 1, "last_activity_date": 1453332924, "creation_date": 1453318773, "question_id": 34909019, "link": "https://stackoverflow.com/questions/34909019/mechanize-in-module-nameerror-agent", "title": "Mechanize in Module, Nameerror &#39; agent&#39;", "body": "<p>Looking for advice on how to fix this error and refactor this code to improve it.</p>\n\n<pre><code>require 'mechanize'\nrequire 'pry'\nrequire 'pp'\n\n\n\n\nmodule Mymodule\n  class WebBot \n\n    agent = Mechanize.new { |agent| \n        agent.user_agent_alias = 'Windows Chrome'\n    }\n\n    def form(response)\n      require \"addressable/uri\"\n      require \"addressable/template\"\n      template = Addressable::Template.new(\"http://www.domain.com/{?query*}\")\n      url = template.expand({\"query\" =&gt; response}).to_s\n      page = agent.get(url)  \n    end \n\n    def get_products\n      products = []\n      page.search(\"datatable\").search('tr').each do |row|\n        begin\n          product =  row.search('td')[1].text\n        rescue =&gt; e\n            p e.message\n        end\n        products &lt;&lt; product\n      end  \n      products\n    end  \n  end \nend\n</code></pre>\n\n<h1>Calling the module:</h1>\n\n<pre><code>response = {size: \"SM\", color: \"BLUE\"}\n\nt = Mymodule::WebBot.new\nt.form(response)\nt.get_products\n</code></pre>\n\n<h1>Error:</h1>\n\n<pre><code>NameError: undefined local variable or method `agent'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 5441194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3a91754494ee19704c743333f8f6b341?s=128&d=identicon&r=PG&f=1", "display_name": "myf", "link": "https://stackoverflow.com/users/5441194/myf"}, "edited": false, "score": 0, "creation_date": 1453323576, "post_id": 34909604, "comment_id": 57556457, "body": "WOW! It&#39;s working! You are genius! Thanks a lot! Your answer is for me very important. I learned a lot! Thanks! :)"}, {"owner": {"reputation": 175, "user_id": 5441194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3a91754494ee19704c743333f8f6b341?s=128&d=identicon&r=PG&f=1", "display_name": "myf", "link": "https://stackoverflow.com/users/5441194/myf"}, "edited": false, "score": 0, "creation_date": 1453323933, "post_id": 34909604, "comment_id": 57556644, "body": "@comment.author_id is a variable to save actual user. How can I save in other way user who is author of comment? and where can I find magic for code refactor?"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 175, "user_id": 5441194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3a91754494ee19704c743333f8f6b341?s=128&d=identicon&r=PG&f=1", "display_name": "myf", "link": "https://stackoverflow.com/users/5441194/myf"}, "edited": false, "score": 0, "creation_date": 1453328096, "post_id": 34909604, "comment_id": 57558960, "body": "Added explaination on how the relation could be improved. There is no magic in refactoring - if that was the case than you could just bang out crap code and rely on the computer to fix it for you. Unfortunately thats not the case. There are code quality tools like Rubucop which do help a bit though."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 2, "last_activity_date": 1453321412, "last_edit_date": 1453321412, "creation_date": 1453320830, "answer_id": 34909604, "question_id": 34908427, "link": "https://stackoverflow.com/questions/34908427/rspec-controller-redirect-to-other-controller/34909604#34909604", "title": "RSpec controller: redirect_to other controller", "body": "<p>Basically the error is caused by the fact that the <code>@comment.user</code> is nil.</p>\n\n<p>Lets start fixing it by cleaning up the spec:</p>\n\n<pre><code>context \"User logged in\" do \n\n  # declare lets first.\n  let(:user) { create(:user) }\n  let(:comment) { create(:comment, user: user, author: user) }\n  # use do instead of braces when it does not fit on one line.\n  let(:comment_child) do \n    # use `user: user` instead of `user_id: user.id`.\n    # the latter defeats the whole purpose of the abstraction.\n    create(:comment_child, user: user, author: user, parent: comment)\n  end\n\n  before { sign_in(user) }\n\n  describe \"POST #create\" do \n    context \"with valid attributes\" do \n      it \"saves the new comment object\" do\n        expect do \n          post :create, comment: attributes_for(:comment) \n        end.to change(Comment, :count).by(1)\n      end\n\n      it \"redirects to the user\" do \n        post :create, comment: attributes_for(:comment)\n        expect(response).to redirect_to user\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>You should generally avoid using instance vars and instead use <code>lets</code> in most cases. Using a mix just adds to the confusion since its hard to see what is lazy loaded or even instantiated where.</p>\n\n<p>Then we can take care of the implementation:</p>\n\n<pre><code>def create\n  @comment = current_user.comments.new(comment_params)\n\n  if @comment.save\n    redirect_to @comment.user, notice: 'Your comment was successfully added!'\n  else\n    # ...\n  end\nend\n\nprivate \n  def comment_params\n    # note that we don't permit the user_id to be mass assigned\n    params.require(:comment).permit(:foo, :bar, :parent_id)\n  end\n</code></pre>\n\n<p>Basically you can cut a lot of the overcomplication:</p>\n\n<ul>\n<li>Raise an error if there is no authenticated user. With Devise you would do <code>before_action :authenticate_user!</code>.</li>\n<li>Get the user from the session - not the params. Your not going to want or need users to comment on the behalf of others.</li>\n<li>Wrap params in the <code>comments</code> key.</li>\n<li>Use <code>redirect_to @some_model_instance</code> and let rails do its polymorpic routing magic.</li>\n<li>Let ActiveRecord throw an error if the user tries to pass a bad <code>parent_id</code>. </li>\n</ul>\n\n<p>Also does your Comment model really need both a <code>user</code> and <code>author</code> relationship? Surely one of them will suffice.</p>\n"}], "owner": {"reputation": 175, "user_id": 5441194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3a91754494ee19704c743333f8f6b341?s=128&d=identicon&r=PG&f=1", "display_name": "myf", "link": "https://stackoverflow.com/users/5441194/myf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 325, "favorite_count": 0, "accepted_answer_id": 34909604, "answer_count": 1, "score": 0, "last_activity_date": 1453321412, "creation_date": 1453316969, "last_edit_date": 1453317914, "question_id": 34908427, "link": "https://stackoverflow.com/questions/34908427/rspec-controller-redirect-to-other-controller", "title": "RSpec controller: redirect_to other controller", "body": "<p>I have this issue with test my <strong>CommentsController</strong>: </p>\n\n<blockquote>\n  <p>Failure/Error: redirect_to user_path(@comment.user), notice: 'Your\n  comment was successfully added!' ActionController::UrlGenerationError:\n  No route matches {:action=>\"show\", :controller=>\"users\", :id=>nil}\n  missing required keys: [:id]</p>\n</blockquote>\n\n<p>This is my method in my <strong>controller</strong>:</p>\n\n<pre><code>  def create \n    if params[:parent_id].to_i &gt; 0\n      parent = Comment.find_by_id(params[:comment].delete(:parent_id))\n      @comment = parent.children.build(comment_params)\n    else\n      @comment = Comment.new(comment_params)\n    end\n    @comment.author_id = current_user.id\n    if @comment.save\n      redirect_to user_path(@comment.user), notice: 'Your comment was successfully added!'\n    else\n      redirect_to user_path(@comment.user), notice: @comment.errors.full_messages.join\n    end\n  end\n</code></pre>\n\n<p>This is my <strong>RSpec</strong>: </p>\n\n<pre><code>  context \"User logged in\" do \n    before :each do \n      @user = create(:user)\n      sign_in @user\n    end \n\n    let(:comment) { create(:comment, user: @user, author_id: @user.id) }\n    let(:comment_child) { create(:comment_child, user: @user, author_id: @user.id, parent_id: comment.id) }\n\n    describe \"POST #create\" do \n      context \"with valid attributes\" do \n        it \"saves the new comment object\" do\n          expect{ post :create, comment: attributes_for(:comment), id: @user.id}.to change(Comment, :count).by(1)\n        end\n\n        it \"redirect to :show view \" do \n          post :create, comment: attributes_for(:comment), user: @user\n          expect(response).to redirect_to user_path(comment.user)\n        end\n      end\n\n      ...\n    end\n  end\n</code></pre>\n\n<p>My Comment <strong>model</strong>:</p>\n\n<pre><code>class Comment &lt; ActiveRecord::Base\n    belongs_to :user\n    acts_as_tree order: 'created_at DESC'\n\n    VALID_REGEX = /\\A^[\\w \\.\\-@:),.!?\"']*$\\Z/\n    validates :body, presence: true, length: { in: 2..240}, format: { with: VALID_REGEX }\nend\n</code></pre>\n\n<p>How Can I add <code>user_id</code> to that request? When I change code in my controller <code>redirect_to user_path(@comment.user)</code> to <code>redirect_to user_path(current_user)</code> - test pass. May I <code>redirect_to</code> user in comments controller? Is any posibility to do it right? Thanks for your time.  </p>\n"}, {"tags": ["css", "ruby", "macos", "permissions", "sass"], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 2219392, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2BHao.jpg?s=128&g=1", "display_name": "CardiffSteve", "link": "https://stackoverflow.com/users/2219392/cardiffsteve"}, "edited": false, "score": 0, "creation_date": 1453324223, "post_id": 34909053, "comment_id": 57556823, "body": "i found the problem thanks to your response above which got me looking in the right direction. Basically, I had not specified the Images folder location in Scout in the Images configuration field ( I had left it blank). Once I did this it worked perfectly - many thanks for helping."}], "tags": [], "owner": {"reputation": 141, "user_id": 3411171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5949238b3aa509c2230892f431be7b0f?s=128&d=identicon&r=PG&f=1", "display_name": "jswitchback", "link": "https://stackoverflow.com/users/3411171/jswitchback"}, "is_accepted": true, "score": 0, "last_activity_date": 1453318883, "creation_date": 1453318883, "answer_id": 34909053, "question_id": 34908300, "link": "https://stackoverflow.com/questions/34908300/how-do-i-get-sass-to-work-on-mac-using-scout/34909053#34909053", "title": "How do I get Sass to work on mac using Scout?", "body": "<p>An image declared in your css (styles-rtl.scss) is not found in the images directory. This is the key part of the error <code>File not found or cannot be read: /Applications/MAMP/htdocs/wib/menu-collapsed-rtl.png</code></p>\n\n<p>Compass will look for all images declared in the directory listed in the <code>config.rb</code> file. You may have to do some detective work to ensure you have the correct path to your images and the images are in that folder. In this case you will have to copy them from the Zen base theme images directory.</p>\n"}], "owner": {"reputation": 133, "user_id": 2219392, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2BHao.jpg?s=128&g=1", "display_name": "CardiffSteve", "link": "https://stackoverflow.com/users/2219392/cardiffsteve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 34909053, "answer_count": 1, "score": -1, "last_activity_date": 1453318883, "creation_date": 1453316520, "last_edit_date": 1495535275, "question_id": 34908300, "link": "https://stackoverflow.com/questions/34908300/how-do-i-get-sass-to-work-on-mac-using-scout", "title": "How do I get Sass to work on mac using Scout?", "body": "<p>I have just installed <a href=\"http://mhs.github.io/scout-app/\" rel=\"nofollow noreferrer\">Scout</a> on my iMac for processing Sass (for my new Drupal Zen sub theme) into css, I keep getting errors, basically,  after it detects a change to a SASS file it won't convert to CSS - the CSS file remains unchanged. I have also installed Homebrew in order to install Ruby as well as I thought it could be a permission problem as indicated by this <a href=\"https://stackoverflow.com/questions/14607193/installing-gem-or-updating-rubygems-fails-with-permissions-error\">post</a> , but this didn't help and I still get the problem. I have checked on my terminal session that inline_image.rb (listed below) exists but has file permission -rwxr-xr-x@. Can anyone help? </p>\n\n<p>This is the error log:</p>\n\n<pre><code>Change detected at 18:32:00 to: styles-rtl.scss\nCompass::Error on line 61 of /Applications/Scout.app/Contents/Resources/vendor/gems/gems/compass-0.12.2/lib/compass/sass_extensions/functions/inline_image.rb: File not found or cannot be read: /Applications/MAMP/htdocs/wib/menu-collapsed-rtl.png\n/Applications/Scout.app/Contents/Resources/vendor/gems/gems/compass-0.12.2/lib/compass/sass_extensions/functions/inline_image.rb:6:in `inline_image'\norg/jruby/RubyKernel.java:2096:in `send' /Applications/Scout.app/Contents/Resources/vendor/gems/gems/sass-3.2.1/lib/sass/script/funcall.rb:106:in `_perform' /Applications/Scout.app/Contents/Resources/vendor/gems/gems/sass-3.2.1/lib/sass/script/node.rb:40:in `perform' \n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 5958, "user_id": 1789479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/WlgWK.jpg?s=128&g=1", "display_name": "Hieu Pham", "link": "https://stackoverflow.com/users/1789479/hieu-pham"}, "edited": false, "score": 0, "creation_date": 1453316826, "post_id": 34908248, "comment_id": 57552702, "body": "Normally, it would be successful, you may double check whether those gems were installed for <code>ruby-2.0.0-p598</code>"}, {"owner": {"reputation": 10456, "user_id": 235123, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/N9D2y.jpg?s=128&g=1", "display_name": "Mina Samy", "link": "https://stackoverflow.com/users/235123/mina-samy"}, "reply_to_user": {"reputation": 5958, "user_id": 1789479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/WlgWK.jpg?s=128&g=1", "display_name": "Hieu Pham", "link": "https://stackoverflow.com/users/1789479/hieu-pham"}, "edited": false, "score": 0, "creation_date": 1453316976, "post_id": 34908248, "comment_id": 57552787, "body": "Sorry, I&#39;m not so familiar with Ruby commands, how to check if the gems are installed for ruby 2.0.0-p598?"}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1453317079, "post_id": 34908248, "comment_id": 57552849, "body": "This is a terminal command, not a ruby command. So just run it on your command line. Gem is a separate program that manages your ruby gems."}, {"owner": {"reputation": 10456, "user_id": 235123, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/N9D2y.jpg?s=128&g=1", "display_name": "Mina Samy", "link": "https://stackoverflow.com/users/235123/mina-samy"}, "edited": false, "score": 0, "creation_date": 1453317146, "post_id": 34908248, "comment_id": 57552881, "body": "I checked with gem list --local and found that the two gems are installed, what can be missing here?"}], "answers": [{"comments": [{"owner": {"reputation": 10456, "user_id": 235123, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/N9D2y.jpg?s=128&g=1", "display_name": "Mina Samy", "link": "https://stackoverflow.com/users/235123/mina-samy"}, "edited": false, "score": 0, "creation_date": 1453320682, "post_id": 34909521, "comment_id": 57554807, "body": "Exactly, what a naive mistake, changing require &#39;HTTParty&#39; to require &#39;httparty&#39; solved it, thanks a lot"}], "tags": [], "owner": {"reputation": 3087, "user_id": 688480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db08b7613d6bf1b94e662b1f96f9ef02?s=128&d=identicon&r=PG", "display_name": "Ray Baxter", "link": "https://stackoverflow.com/users/688480/ray-baxter"}, "is_accepted": true, "score": 1, "last_activity_date": 1453320509, "creation_date": 1453320509, "answer_id": 34909521, "question_id": 34908248, "link": "https://stackoverflow.com/questions/34908248/ruby-cannot-load-such-file-from-loaderror/34909521#34909521", "title": "Ruby: Cannot load such file from - LoadError", "body": "<p>Case matters.</p>\n\n<p><code>require 'httparty'</code></p>\n"}], "owner": {"reputation": 10456, "user_id": 235123, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/N9D2y.jpg?s=128&g=1", "display_name": "Mina Samy", "link": "https://stackoverflow.com/users/235123/mina-samy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2195, "favorite_count": 0, "accepted_answer_id": 34909521, "answer_count": 1, "score": 0, "last_activity_date": 1453320509, "creation_date": 1453316307, "last_edit_date": 1453317253, "question_id": 34908248, "link": "https://stackoverflow.com/questions/34908248/ruby-cannot-load-such-file-from-loaderror", "title": "Ruby: Cannot load such file from - LoadError", "body": "<p>I have a ruby script file with the name test.rb.</p>\n\n<p>the file has the following two require statements:</p>\n\n<pre><code>require 'oauth'\nrequire 'HTTParty'\n</code></pre>\n\n<p>I have the two gems already installed before.</p>\n\n<p>when running <strong>ruby test.rb</strong> in the terminal I get the following error:</p>\n\n<blockquote>\n  <p>/opt/rubies/ruby-2.0.0-p598/lib/ruby/2.0.0/rubygems/core_ext/kernel_require.rb:55:in\n  <code>require': cannot load such file -- HTTParty (LoadError)\n          from /opt/rubies/ruby-2.0.0-p598/lib/ruby/2.0.0/rubygems/core_ext/kernel_require.rb:55:in\n  </code>require'\n          from test.rb:2:in `'</p>\n</blockquote>\n\n<p>what can be wrong here?</p>\n"}, {"tags": ["ruby", "string", "escaping", "literals"], "answers": [{"comments": [{"owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 1, "creation_date": 1453316264, "post_id": 34908187, "comment_id": 57552399, "body": "<a href=\"https://rads.stackoverflow.com/amzn/click/com/B000EXZ0VC\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">HHK</a> at work again!!!"}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 2, "last_activity_date": 1453316362, "last_edit_date": 1453316362, "creation_date": 1453316132, "answer_id": 34908187, "question_id": 34908165, "link": "https://stackoverflow.com/questions/34908165/how-do-i-create-a-string-whose-puts-output-is-cote-divoire/34908187#34908187", "title": "How do I create a string whose `puts` output is `cote \\d&#39;ivoire`?", "body": "<p>Escape the backslash with a backslash:</p>\n\n<pre><code>var = \"cote \\\\d'ivoire\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 5817634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cd70bf1a0c790f861528099e58db1aa?s=128&d=identicon&r=PG&f=1", "display_name": "stefan cervo", "link": "https://stackoverflow.com/users/5817634/stefan-cervo"}, "edited": false, "score": 0, "creation_date": 1453316418, "post_id": 34908226, "comment_id": 57552483, "body": "thx a lot. I was confused by the output during the var affectation. I did not have a try with puts"}, {"owner": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "reply_to_user": {"reputation": 29, "user_id": 5817634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cd70bf1a0c790f861528099e58db1aa?s=128&d=identicon&r=PG&f=1", "display_name": "stefan cervo", "link": "https://stackoverflow.com/users/5817634/stefan-cervo"}, "edited": false, "score": 0, "creation_date": 1453318490, "post_id": 34908226, "comment_id": 57553612, "body": "@stefancervo you can accept the answer that helped you by clicking the big check mark beside the answer."}], "tags": [], "owner": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "is_accepted": false, "score": 2, "last_activity_date": 1453316239, "creation_date": 1453316239, "answer_id": 34908226, "question_id": 34908165, "link": "https://stackoverflow.com/questions/34908165/how-do-i-create-a-string-whose-puts-output-is-cote-divoire/34908226#34908226", "title": "How do I create a string whose `puts` output is `cote \\d&#39;ivoire`?", "body": "<p>You need to escape the <code>\\</code></p>\n\n<pre><code>2.1.2-perf :004 &gt; var=\"cote \\\\d'ivoire\"\n =&gt; \"cote \\\\d'ivoire\"\n2.1.2-perf :005 &gt; puts var\ncote \\d'ivoire\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 5817634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cd70bf1a0c790f861528099e58db1aa?s=128&d=identicon&r=PG&f=1", "display_name": "stefan cervo", "link": "https://stackoverflow.com/users/5817634/stefan-cervo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1453316362, "creation_date": 1453316066, "last_edit_date": 1453316326, "question_id": 34908165, "link": "https://stackoverflow.com/questions/34908165/how-do-i-create-a-string-whose-puts-output-is-cote-divoire", "title": "How do I create a string whose `puts` output is `cote \\d&#39;ivoire`?", "body": "<p>I don't know how to create a string <code>var</code> whose <code>puts</code> output would be:</p>\n\n<pre><code>cote \\d'ivoire\n</code></pre>\n\n<p>I tried:</p>\n\n<pre><code>var = \"cote \\d'ivoire\"\n</code></pre>\n\n<p>whose output is:</p>\n\n<pre><code>puts var \n#=&gt; cote d'ivoire\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rake", "rake-task"], "answers": [{"comments": [{"owner": {"reputation": 245, "user_id": 4867444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faa0e6c29ebb965a8c6a87b02aacb155?s=128&d=identicon&r=PG&f=1", "display_name": "user4867444", "link": "https://stackoverflow.com/users/4867444/user4867444"}, "edited": false, "score": 0, "creation_date": 1453344540, "post_id": 34912182, "comment_id": 57564240, "body": "Thanks for your answer @yhirano55. However, I&#39;m afraid I still don&#39;t understand why the first exception&#39;s message would be in the backtrace at all? As far as I know, that&#39;s not standard Ruby behaviour?"}], "tags": [], "owner": {"reputation": 61, "user_id": 5799819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f29a162766d958061471d76d0b233ca?s=128&d=identicon&r=PG&f=1", "display_name": "yhirano55", "link": "https://stackoverflow.com/users/5799819/yhirano55"}, "is_accepted": false, "score": 0, "last_activity_date": 1453330311, "creation_date": 1453330311, "answer_id": 34912182, "question_id": 34908100, "link": "https://stackoverflow.com/questions/34908100/rake-exception-management/34912182#34912182", "title": "Rake exception management", "body": "<p>There's not both the original exception (<code>foo</code>).</p>\n\n<p>Rakefile:</p>\n\n<pre><code>namespace :foo do\n  task :bar do\n    begin\n      raise \"message from foo\"\n    rescue RuntimeError =&gt; ex\n      puts \"#{ex.message}. foo is rescued\"             # &lt;= 1st\n      raise ex.class, 'message from bar', ex.backtrace # &lt;= 2nd\n    end\n  end\nend\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>message from foo. foo is rescued # &lt;= 1st\nrake aborted!\nmessage from bar # &lt;= 2nd\n/home/vagrant/Rakefile:4:in `block (2 levels) in &lt;top (required)&gt;'\nmessage from foo # &lt;= from backtrace\n/home/vagrant/Rakefile:4:in `block (2 levels) in &lt;top (required)&gt;'\nTasks: TOP =&gt; foo:bar\n(See full trace by running task with --trace)\n</code></pre>\n"}], "owner": {"reputation": 245, "user_id": 4867444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faa0e6c29ebb965a8c6a87b02aacb155?s=128&d=identicon&r=PG&f=1", "display_name": "user4867444", "link": "https://stackoverflow.com/users/4867444/user4867444"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 275, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453330311, "creation_date": 1453315838, "question_id": 34908100, "link": "https://stackoverflow.com/questions/34908100/rake-exception-management", "title": "Rake exception management", "body": "<p>Consider this Rake task:</p>\n\n<pre><code>namespace :foo do\n  task :bar do\n    begin\n      raise 'foo'\n    rescue RuntimeError =&gt; ex\n      raise ex.class, 'bar', ex.backtrace\n    end\n  end\nend\n</code></pre>\n\n<p>It results in the following output:</p>\n\n<pre><code>rake aborted!\nbar\n/home/vagrant/proj/lib/tasks/foo.rake:52:in `block (2 levels) in &lt;top (required)&gt;'\n/home/vagrant/.gem/ruby/2.3.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:268:in `load'\n/home/vagrant/.gem/ruby/2.3.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:268:in `block in load'\n/home/vagrant/.gem/ruby/2.3.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:240:in `load_dependency'\n/home/vagrant/.gem/ruby/2.3.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:268:in `load'\n-e:1:in `&lt;main&gt;'\nfoo\n/home/vagrant/proj/lib/tasks/foo.rake:52:in `block (2 levels) in &lt;top (required)&gt;'\n/home/vagrant/.gem/ruby/2.3.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:268:in `load'\n/home/vagrant/.gem/ruby/2.3.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:268:in `block in load'\n/home/vagrant/.gem/ruby/2.3.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:240:in `load_dependency'\n/home/vagrant/.gem/ruby/2.3.0/gems/activesupport-4.2.5/lib/active_support/dependencies.rb:268:in `load'\n-e:1:in `&lt;main&gt;'\nTasks: TOP =&gt; foo:bar\n(See full trace by running task with --trace)\n</code></pre>\n\n<p>As you can see, there's both the <em>original</em> exception (<code>foo</code>) as well as the new one (<code>bar</code>).\nWhy is that? I'd have expected the <code>foo</code> exception, that has been properly rescued, to not show up here.</p>\n"}, {"tags": ["ruby", "rspec", "constants"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1453315664, "post_id": 34907874, "comment_id": 57552093, "body": "To be clear, values <code>let</code> values <i>can</i> be used in <code>before(:each)</code> and <code>after(:each)</code> blocks. They can&#39;t be used in <code>before(:all)</code> blocks. In general I think <code>before(:all)</code> blocks are a code smell, so refactoring your tests to use only <code>before(:each)</code> blocks may solve this issue."}, {"owner": {"reputation": 170, "user_id": 5467537, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-3I0n4GXq-ks/AAAAAAAAAAI/AAAAAAAAIoI/mM7nWD-MiE8/photo.jpg?sz=128", "display_name": "Egon Braun", "link": "https://stackoverflow.com/users/5467537/egon-braun"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1453316516, "post_id": 34907874, "comment_id": 57552535, "body": "Ok, yeah ... I am still grasping the best approach for my tests so I will take your advice in consideration! Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 170, "user_id": 5467537, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-3I0n4GXq-ks/AAAAAAAAAAI/AAAAAAAAIoI/mM7nWD-MiE8/photo.jpg?sz=128", "display_name": "Egon Braun", "link": "https://stackoverflow.com/users/5467537/egon-braun"}, "edited": false, "score": 0, "creation_date": 1453468744, "post_id": 34924298, "comment_id": 57626558, "body": "Cool, I thought of instance variables but not the way you put it here. This looks good indeed, I&#39;ll give it a shot definitely. Thanks! Just one question though, this before block there is for :each or :all?"}], "tags": [], "owner": {"reputation": 1066, "user_id": 3215470, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rclPe.jpg?s=128&g=1", "display_name": "Andy Jones", "link": "https://stackoverflow.com/users/3215470/andy-jones"}, "is_accepted": false, "score": 0, "last_activity_date": 1453380510, "creation_date": 1453380510, "answer_id": 34924298, "question_id": 34907874, "link": "https://stackoverflow.com/questions/34907874/defining-and-using-constants-inside-rspecs-hooks/34924298#34924298", "title": "Defining and using constants inside Rspec&#39;s hooks", "body": "<p>You have one other option for defining data -- instance variables.</p>\n\n<pre><code>before do\n  @data = [ {one: 1, two: 2},\n            {one: 2, two: 3} ]\nend\n</code></pre>\n\n<p>You can use @data in all the tests within the scope of the <code>before</code>.  This is pretty much the same as <code>let</code> for the purposes of just setting up static data, but it might be a better fit for you -- without seeing your code it's hard to say.</p>\n"}], "owner": {"reputation": 170, "user_id": 5467537, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-3I0n4GXq-ks/AAAAAAAAAAI/AAAAAAAAIoI/mM7nWD-MiE8/photo.jpg?sz=128", "display_name": "Egon Braun", "link": "https://stackoverflow.com/users/5467537/egon-braun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 454, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1453380510, "creation_date": 1453315048, "question_id": 34907874, "link": "https://stackoverflow.com/questions/34907874/defining-and-using-constants-inside-rspecs-hooks", "title": "Defining and using constants inside Rspec&#39;s hooks", "body": "<p>I am kinda of new to Rspec and I am writing some test examples when a question came up.</p>\n\n<p>First, I was using global variables to define three constant values I was going to use in a lot of tests. For example:</p>\n\n<pre><code>$message = 'this is a test'\n</code></pre>\n\n<p>However, I notice that this global was being carried over to other test files and causing issues. Ok... decided then to avoid the globals as this can cause a lot of pain in the future in case my test file number grows.</p>\n\n<p>I then went for the let() block. Example:</p>\n\n<pre><code>let(:message) { 'this is a test' }\n</code></pre>\n\n<p>Now the problem was that this variable could not be used inside before and after hooks. Ok...</p>\n\n<p>My last try was using constants inside the contexts/describes, like this:</p>\n\n<pre><code>self::MESSAGE =  'this is a test'\n</code></pre>\n\n<p>However, just like let's this cannot be used inside the hooks as they are not either classes or modules.</p>\n\n<p>So, I am stuck ...</p>\n\n<p>How do you guys deal with that? Will I need to create instance variables for that? Is that any other alternative I can use?</p>\n\n<p>Thank you very much.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "paypal", "paypal-ipn", "paypal-sandbox"], "answers": [{"comments": [{"owner": {"reputation": 116, "user_id": 3384989, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/100002093712338/picture?type=large", "display_name": "Giovani Barcelos", "link": "https://stackoverflow.com/users/3384989/giovani-barcelos"}, "edited": false, "score": 0, "creation_date": 1453316403, "post_id": 34908164, "comment_id": 57552475, "body": "I don&#39;t think it would work. As said in <a href=\"https://developer.paypal.com/docs/classic/ipn/integration-guide/IPNImplementation/\" rel=\"nofollow noreferrer\">developer.paypal.com/docs/classic/ipn/integration-guide/&hellip;</a>, I must send the request to the URL i&#39;m currently sending. My raw is the same fields, in the same order, that I&#39;ve received from PayPal"}, {"owner": {"reputation": 5958, "user_id": 1789479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/WlgWK.jpg?s=128&g=1", "display_name": "Hieu Pham", "link": "https://stackoverflow.com/users/1789479/hieu-pham"}, "reply_to_user": {"reputation": 116, "user_id": 3384989, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/100002093712338/picture?type=large", "display_name": "Giovani Barcelos", "link": "https://stackoverflow.com/users/3384989/giovani-barcelos"}, "edited": false, "score": 0, "creation_date": 1453316601, "post_id": 34908164, "comment_id": 57552583, "body": "Could you check the log, what did you receive and send?"}], "tags": [], "owner": {"reputation": 5958, "user_id": 1789479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/WlgWK.jpg?s=128&g=1", "display_name": "Hieu Pham", "link": "https://stackoverflow.com/users/1789479/hieu-pham"}, "is_accepted": false, "score": 0, "last_activity_date": 1453316530, "last_edit_date": 1453316530, "creation_date": 1453316066, "answer_id": 34908164, "question_id": 34907705, "link": "https://stackoverflow.com/questions/34907705/rails-listener-paypal-ipn-always-return-invalid/34908164#34908164", "title": "Rails listener Paypal IPN always return INVALID", "body": "<p>I think your problem is <code>not follow exactly what papal requires</code></p>\n\n<p>From <a href=\"https://developer.paypal.com/docs/classic/ipn/integration-guide/IPNIntro/\" rel=\"nofollow\">Paypal document</a></p>\n\n<blockquote>\n  <p>Your listener HTTP POSTs the complete, unaltered message back to PayPal.</p>\n  \n  <p>Note This message must contain the same fields, in the same order, as the original IPN from PayPal, all preceded by cmd=_notify-validate. Further, this message must use the same encoding as the original.</p>\n</blockquote>\n\n<p>So you <code>validate function</code> would be:</p>\n\n<pre><code>def validate_IPN_notification(ipn_url)\n  validate_url = \"#{ipn_url}?cmd=_notify-validate\"\n  # Post validate_url\n  ...\nend\n</code></pre>\n\n<p>Note that the <code>ipn_url</code> is the same url of IPN</p>\n"}, {"tags": [], "owner": {"reputation": 116, "user_id": 3384989, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/100002093712338/picture?type=large", "display_name": "Giovani Barcelos", "link": "https://stackoverflow.com/users/3384989/giovani-barcelos"}, "is_accepted": true, "score": 0, "last_activity_date": 1453473932, "creation_date": 1453473932, "answer_id": 34949385, "question_id": 34907705, "link": "https://stackoverflow.com/questions/34907705/rails-listener-paypal-ipn-always-return-invalid/34949385#34949385", "title": "Rails listener Paypal IPN always return INVALID", "body": "<p>It turned out to be a Windows problem which I don't know how to fix.</p>\n\n<p>I tried the same thing on my Ubuntu 15 and it worked perfectly.</p>\n"}], "owner": {"reputation": 116, "user_id": 3384989, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/100002093712338/picture?type=large", "display_name": "Giovani Barcelos", "link": "https://stackoverflow.com/users/3384989/giovani-barcelos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 34949385, "answer_count": 2, "score": 0, "last_activity_date": 1453473932, "creation_date": 1453314432, "last_edit_date": 1592644375, "question_id": 34907705, "link": "https://stackoverflow.com/questions/34907705/rails-listener-paypal-ipn-always-return-invalid", "title": "Rails listener Paypal IPN always return INVALID", "body": "<p>I've build a listener for my IPN. I can receive the request via IPN Simulator and all the parameters are correct, but when I send it back to <a href=\"https://www.sandbox.paypal.com/cgi-bin/webscr?cmd=_notify-validate\" rel=\"nofollow noreferrer\">link for sending my request to make validations</a> it will ALWAYS return INVALID.</p>\n<p>I've tried changing the encoding on my PayPal account to UTF-8 but it didn't work.</p>\n<p>I'm not using any gem for this and I'm not looking forward to this.</p>\n<pre>\n class PaymentNotificationController  [:create] #Otherwise the request from PayPal wouldn't make it to the controller\n\n\n  def create\n    response = validate_IPN_notification(request.raw_post)\n    case response\n    when \"VERIFIED\"\n      P 'worked'\n\n    when \"INVALID\"\n        p 'did not work'\n    else\n    end\n    render :nothing => true, :status => 200, :content_type => 'text/html'\n  end\n\n\n  protected \n\n  \n\n  def validate_IPN_notification(raw)\n\n    uri = URI.parse('https://www.sandbox.paypal.com/cgi-bin/webscr?cmd=_notify-validate')\n    #uri = URI.parse('https://www.paypal.com/cgi-bin/webscr?cmd=_notify-validate')\n    http = Net::HTTP.new(uri.host, uri.port)\n    http.open_timeout = 60\n    http.read_timeout = 60\n    http.verify_mode = OpenSSL::SSL::VERIFY_NONE\n    http.use_ssl = true\n    response = http.post(uri.request_uri, raw,\n                         'Content-Length' => \"#{raw.size}\",\n                         'User-Agent' => \"My custom user agent\"\n                       ).body\n  end\nend\n</pre>\n<p>Please help me, I've been stuck with it all afternoon and can't get it figured out.</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 424, "user_id": 3645337, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/oqgRS.jpg?s=128&g=1", "display_name": "Vlad Faust", "link": "https://stackoverflow.com/users/3645337/vlad-faust"}, "edited": false, "score": 0, "creation_date": 1453315104, "post_id": 34907671, "comment_id": 57551758, "body": "Thanks, it works! Could you please provide a similar scope for selecting by landings (<code>Visit.from_landing(Landing.second)</code>)?"}, {"owner": {"reputation": 5958, "user_id": 1789479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/WlgWK.jpg?s=128&g=1", "display_name": "Hieu Pham", "link": "https://stackoverflow.com/users/1789479/hieu-pham"}, "reply_to_user": {"reputation": 424, "user_id": 3645337, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/oqgRS.jpg?s=128&g=1", "display_name": "Vlad Faust", "link": "https://stackoverflow.com/users/3645337/vlad-faust"}, "edited": false, "score": 0, "creation_date": 1453316310, "post_id": 34907671, "comment_id": 57552427, "body": "Yeah, it is similar, man, check my update! Check following reference for more detail <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Scoping/Named/ClassMethods.html\" rel=\"nofollow noreferrer\">api.rubyonrails.org/classes/ActiveRecord/Scoping/Named/&hellip;</a>"}], "tags": [], "owner": {"reputation": 5958, "user_id": 1789479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/WlgWK.jpg?s=128&g=1", "display_name": "Hieu Pham", "link": "https://stackoverflow.com/users/1789479/hieu-pham"}, "is_accepted": true, "score": 1, "last_activity_date": 1453316248, "last_edit_date": 1453316248, "creation_date": 1453314307, "answer_id": 34907671, "question_id": 34907361, "link": "https://stackoverflow.com/questions/34907361/deep-model-associations-with-rails/34907671#34907671", "title": "Deep model associations with Rails", "body": "<p>You code was organized nicely, don't need to refactor I think. You can achieve that by defining a scope in <code>Visit</code> like this:</p>\n\n<pre><code>class Visit &lt; ActiveRecord::Base\n  scope :from_offer, -&gt; (offer) {\n     joins(link: :landing).where(ladings: {offer_id: offer.id})\n  }\n\n  scope :from_landing, -&gt; (landing) {\n     joins(:link).where(links: {landing_id: landing.id})\n  }\nend\n</code></pre>\n\n<p>So the query will be:</p>\n\n<pre><code>Visit.from_offer(Offer.first)\n</code></pre>\n"}], "owner": {"reputation": 424, "user_id": 3645337, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/oqgRS.jpg?s=128&g=1", "display_name": "Vlad Faust", "link": "https://stackoverflow.com/users/3645337/vlad-faust"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 34907671, "answer_count": 1, "score": 0, "last_activity_date": 1453316248, "creation_date": 1453313272, "last_edit_date": 1453313851, "question_id": 34907361, "link": "https://stackoverflow.com/questions/34907361/deep-model-associations-with-rails", "title": "Deep model associations with Rails", "body": "<p>Let's imagine that I have a CPA tracking system.</p>\n\n<p>I would have following models: an Offer, it has some Landings, each of them has multiple Links, each of the links has a bunch of Visits.</p>\n\n<p>So, I what I want is DRY code, therefore <code>offer_id</code> column within visits table is unacceptable. The workaround here is delegated methods like this:</p>\n\n<pre><code>class Offer &lt; ActiveRecord::Base\n  has_many :landings\n  has_many :links,  through: :landings\n  has_many :visits, through: :landings\nend\n\nclass Landing &lt; ActiveRecord::Base\n  belongs_to :offer\n  has_many   :links\n  has_many   :visits, through: :links\nend\n\nclass Link &lt; ActiveRecord::Base\n  belongs_to :landing\n  has_many   :visits\n  delegate   :offer, to: :landing\nend\n\nclass Visit &lt; ActiveRecord::Base\n  belongs_to :link\n  delegate   :landing, to: :link\n  delegate   :offer,   to: :link\nend\n</code></pre>\n\n<p>It works nice with a single visit, e.g. <code>visit.offer.id</code>. But what if I need different visits associated with one offer?</p>\n\n<p>The issue is that I'm unable to construct a valid query using ActiveRecord API. It might look like <code>Visits.where(offer: Offer.first)</code>, but it doesn't work this way, saying <code>ActiveRecord::StatementInvalid: SQLite3::SQLException: no such column: visits.offer: SELECT \"visits\".* FROM \"visits\" WHERE \"visits\".\"offer\" = 1</code>, which is predictable.</p>\n\n<p><strong>Question:</strong> How should I organize my code to make statements like <code>Visits.where(offer: Offer.first)</code> work efficiently without duplicating <code>offer_id</code> column within visits table?</p>\n"}, {"tags": ["ruby", "accessor"], "comments": [{"owner": {"reputation": 9737, "user_id": 2422778, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aUihh.jpg?s=128&g=1", "display_name": "Mike Szyndel", "link": "https://stackoverflow.com/users/2422778/mike-szyndel"}, "edited": false, "score": 2, "creation_date": 1453311652, "post_id": 34906676, "comment_id": 57549666, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/3669801/dry-way-to-assign-hash-values-to-an-object\">DRY way to assign hash values to an object</a>"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1453312483, "post_id": 34906676, "comment_id": 57550237, "body": "If <code>user</code> is an <code>ActiveRecord</code> then <a href=\"http://apidock.com/rails/ActiveRecord/AttributeAssignment/assign_attributes\" rel=\"nofollow noreferrer\"><code>attributes=</code></a> might be an option."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1453312532, "post_id": 34906676, "comment_id": 57550269, "body": "Why do you like your second example better than the first?"}], "answers": [{"tags": [], "owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "is_accepted": true, "score": 9, "last_activity_date": 1453311416, "creation_date": 1453311416, "answer_id": 34906801, "question_id": 34906676, "link": "https://stackoverflow.com/questions/34906676/ruby-object-mass-assignment/34906801#34906801", "title": "Ruby object mass assignment", "body": "<p><a href=\"http://ruby-doc.org/core-2.3.0/Object.html#method-i-tap\">tap</a> let's you do exactly that:</p>\n\n<pre><code>user.tap do |u|\n  u.name = \"abc\"\n  u.email = \"abc@test.com\"\n  u.mobile = \"12312312\"\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1453313723, "post_id": 34906900, "comment_id": 57551010, "body": "This won&#39;t work as <code>user.send(key)</code> will call the getter - not the setter method. You need to do <code>user.send(&quot;#{key}=&quot;)</code>."}, {"owner": {"reputation": 3630, "user_id": 4799659, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153200714295120/picture?type=large", "display_name": "fylooi", "link": "https://stackoverflow.com/users/4799659/fylooi"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1453314666, "post_id": 34906900, "comment_id": 57551520, "body": "Thanks for the catch!"}], "tags": [], "owner": {"reputation": 3630, "user_id": 4799659, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153200714295120/picture?type=large", "display_name": "fylooi", "link": "https://stackoverflow.com/users/4799659/fylooi"}, "is_accepted": false, "score": 1, "last_activity_date": 1453314641, "last_edit_date": 1453314641, "creation_date": 1453311703, "answer_id": 34906900, "question_id": 34906676, "link": "https://stackoverflow.com/questions/34906676/ruby-object-mass-assignment/34906900#34906900", "title": "Ruby object mass assignment", "body": "<p>Alternative option when your attributes come in the form of a hash:</p>\n\n<pre><code>attrs = {\n  name: \"abc\",\n  email: \"abc@test.com\",\n  mobile: \"12312312\"\n}\n\nattrs.each { |key, value| user.send(\"#{key}=\", value) }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 0, "last_activity_date": 1453316010, "last_edit_date": 1453316010, "creation_date": 1453313518, "answer_id": 34907435, "question_id": 34906676, "link": "https://stackoverflow.com/questions/34906676/ruby-object-mass-assignment/34907435#34907435", "title": "Ruby object mass assignment", "body": "<p>With ActiveRecord objects you can use <a href=\"http://apidock.com/rails/ActiveRecord/AttributeAssignment/assign_attributes\" rel=\"nofollow\"><code>.assign_attributes</code></a>  or the update \nmethods:</p>\n\n<pre><code>user.assign_attributes( name: \"abc\", email: \"abc@test.com\", mobile: \"12312312\")\n# attributes= is a shorter alias for assign_attributes\nuser.attributes = { name: \"abc\", email: \"abc@test.com\", mobile: \"12312312\" }\n\n# this will update the record in the database\nuser.update( name: \"abc\", email: \"abc@test.com\", mobile: \"12312312\" )\n\n# or with a block\nuser.update( name: \"abc\", mobile: \"12312312\" ) do |u|\n  u.email = \"#{u.name}@test.com\" \nend\n</code></pre>\n\n<p><code>.update</code> accepts a block, while assign_attributes does not. If you are simply assigning a hash of literal values - such as those passed by a user in the params then there is no need to use a block.</p>\n\n<p>If you have a plain old ruby object which you want to spice up with mass assignment you can do:</p>\n\n<pre><code>class User\n\n  attr_accessor :name, :email, :mobile\n\n  def initialize(params = {}, &amp;block)\n    self.mass_assign(params) if params\n    yield self if block_given?\n  end\n\n  def assign_attributes(params = {}, &amp;block)\n    self.mass_assign(params) if params\n    yield self if block_given?\n  end\n\n  def attributes=(params)\n    assign_attributes(params)\n  end\n\n  private\n    def mass_assign(attrs)\n      attrs.each do |key, value|\n        self.public_send(\"#{key}=\", value)\n      end\n    end\nend\n</code></pre>\n\n<p>This will let you do:</p>\n\n<pre><code>u = User.new(name: \"abc\", email: \"abc@test.com\", mobile: \"12312312\")\nu.attributes = { email: \"abc@example.com\", name: \"joe\" }\nu.assign_attributes(name: 'bob') do |u|\n  u.email = \"#{u.name}@example.com\"\nend\n\n# etc.\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1453315460, "post_id": 34907681, "comment_id": 57551970, "body": "I would not recommend this though as <code>instance_eval</code> breaks the rules of encapsulation. Better to use <code>.tap</code> or <code>.send</code> as already recommended."}, {"owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1453315724, "post_id": 34907681, "comment_id": 57552123, "body": "@max <code>send</code> too breaks the encapsulation ;-)  Ruby&#39;s encapsulation is only for well-behaved programmers."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1453316747, "post_id": 34907681, "comment_id": 57552660, "body": "You&#39;re right there. <code>public_send</code> does though. And one could wish that <code>.send</code> did."}], "tags": [], "owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "is_accepted": false, "score": 0, "last_activity_date": 1453314344, "creation_date": 1453314344, "answer_id": 34907681, "question_id": 34906676, "link": "https://stackoverflow.com/questions/34906676/ruby-object-mass-assignment/34907681#34907681", "title": "Ruby object mass assignment", "body": "<p>You could do the following as well:</p>\n\n<pre><code>user.instance_eval do \n    @name = \"abc\"\n    @email = \"abc@test.com\"\n    @mobile = \"12312312\"\nend\n</code></pre>\n\n<p>You can access the instance variables of <code>user</code> inside the block given to <code>instance_eval</code></p>\n\n<hr>\n\n<p>You could use the below code if you wish to invoke the accessor methods instead of directly manipulating the instance variables.</p>\n\n<pre><code>user.instance_eval do\n    self.name = \"xyz\"\n    self.email = \"abc@test.com\"\n    self.mobile = \"12312312\"\nend\n</code></pre>\n\n<p>or </p>\n\n<pre><code>user.instance_eval do |o|\n    o.name = \"xyz\"\n    o.email = \"abc@test.com\"\n    o.mobile = \"12312312\"\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1066, "user_id": 3215470, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rclPe.jpg?s=128&g=1", "display_name": "Andy Jones", "link": "https://stackoverflow.com/users/3215470/andy-jones"}, "is_accepted": false, "score": 0, "last_activity_date": 1453379585, "creation_date": 1453379585, "answer_id": 34923952, "question_id": 34906676, "link": "https://stackoverflow.com/questions/34906676/ruby-object-mass-assignment/34923952#34923952", "title": "Ruby object mass assignment", "body": "<p>Assuming that 'user' is a class that you control, then you can just define a method to do what you want.  For example:</p>\n\n<pre><code>def set_all(hash)\n  @name, @email, @mobile = hash[:name], hash[:email], hash[:mobile]\nend\n</code></pre>\n\n<p>And then in the rest of your code:</p>\n\n<pre><code>user.set_all(name: \"abc\", email: \"abc@test.com\", mobile: \"12312312\")\n</code></pre>\n\n<p>If 'user' is an instance of, say, an ActiveRecord model, then I'm a little shaky on the details of how you would get this to work.  But the principal still applies: DRY up code by moving the responsibility for the complexity to the receiver.</p>\n"}], "owner": {"reputation": 6838, "user_id": 680001, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/7a1ec53845532ff7ab726ea809cffa74?s=128&d=identicon&r=PG", "display_name": "Sayuj", "link": "https://stackoverflow.com/users/680001/sayuj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1230, "favorite_count": 0, "accepted_answer_id": 34906801, "answer_count": 5, "score": 2, "last_activity_date": 1488807215, "creation_date": 1453311046, "last_edit_date": 1488807215, "question_id": 34906676, "link": "https://stackoverflow.com/questions/34906676/ruby-object-mass-assignment", "title": "Ruby object mass assignment", "body": "<p>Is there any better way to do the below code?</p>\n\n<pre><code>user.name = \"abc\"\nuser.email = \"abc@test.com\"\nuser.mobile = \"12312312\"\n</code></pre>\n\n<p>Something like this will do:</p>\n\n<pre><code>user.prepare do |u|\n  u.name = \"abc\"\n  u.email = \"abc@test.com\"\n  u.mobile = \"12312312\"\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 2607, "user_id": 4470392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvLjT.jpg?s=128&g=1", "display_name": "Maxim Pontyushenko", "link": "https://stackoverflow.com/users/4470392/maxim-pontyushenko"}, "edited": false, "score": 1, "creation_date": 1453310975, "post_id": 34906327, "comment_id": 57549238, "body": "<code>if params[:post_id] != 0</code> You should replace it with <code>if params[:post_id]</code>"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 3702969, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5abef17bc0d7588cdd1c4b61bb5c66c6?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/3702969/coder"}, "edited": false, "score": 0, "creation_date": 1453311045, "post_id": 34906430, "comment_id": 57549296, "body": "Awesome, Thanks a lot."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 0, "last_activity_date": 1453310352, "creation_date": 1453310352, "answer_id": 34906430, "question_id": 34906327, "link": "https://stackoverflow.com/questions/34906327/how-can-i-put-a-check-on-controller-method-create-to-avoid-the-error-couldnt/34906430#34906430", "title": "How can I put a check on controller method &#39;Create&#39; to avoid the error &quot;Couldn&#39;t find Article with &#39;id&#39;=&quot; in Ruby on Rails", "body": "<p>Just check if the parameter is <code>present?</code>:</p>\n\n<pre><code>def create\n  if params[:article_id].present?\n    @article = Article.find(params[:article_id])\n    @comment = @article.comments.create(comment_params)\n    redirect_to article_path(@article)\n\n  elsif params[:post_id].present?\n    @post = Post.find(params[:post_id])\n    @comment = @post.comments.create(comment_params)\n    redirect_to post_path(@post)\n\n  else\n    # no parameter at all, redirect or render error page?\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 352, "user_id": 3494845, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/53d64319bf0aa61380a3eaee0e733e20?s=128&d=identicon&r=PG", "display_name": "avinoth", "link": "https://stackoverflow.com/users/3494845/avinoth"}, "is_accepted": false, "score": 1, "last_activity_date": 1453312034, "creation_date": 1453312034, "answer_id": 34907015, "question_id": 34906327, "link": "https://stackoverflow.com/questions/34906327/how-can-i-put-a-check-on-controller-method-create-to-avoid-the-error-couldnt/34907015#34907015", "title": "How can I put a check on controller method &#39;Create&#39; to avoid the error &quot;Couldn&#39;t find Article with &#39;id&#39;=&quot; in Ruby on Rails", "body": "<p>To answer your question that is to handle the error <code>Couldn't find Article with 'id'=</code> You have to use <code>find_by</code> instead of <code>find</code> since the latter throws an exception if not found and the former returns nil.</p>\n\n<p>So, the updated code would be</p>\n\n<pre><code>class CommentsController &lt; ApplicationController\n  before_filter :authorize\n  def index\n  end\n\n  def create\n    @article = Article.find_by(id: params[:article_id])\n    if @article.present?\n      @comment = @article.comments.create(comment_params)\n      redirect_to article_path(@article)\n    else\n      # Handle Record not found\n    end\n\n    @post = Post.find_by(id: params[:post_id])\n    if @post.present?\n      @comment = @post.comments.create(comment_params)\n      redirect_to post_path(@post)\n    else\n      # Handle Record not found\n    end\n  end\n\n  private\n\n  def comment_params\n    params.require(:comment).permit(:username, :comment_body)\n  end\nend\n</code></pre>\n\n<p>Hope this is helpful.</p>\n"}], "owner": {"reputation": 27, "user_id": 3702969, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5abef17bc0d7588cdd1c4b61bb5c66c6?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/3702969/coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 34906430, "answer_count": 2, "score": 0, "last_activity_date": 1453312034, "creation_date": 1453310050, "question_id": 34906327, "link": "https://stackoverflow.com/questions/34906327/how-can-i-put-a-check-on-controller-method-create-to-avoid-the-error-couldnt", "title": "How can I put a check on controller method &#39;Create&#39; to avoid the error &quot;Couldn&#39;t find Article with &#39;id&#39;=&quot; in Ruby on Rails", "body": "<p>How can I put a check on controller method 'Create' to avoid the error \"Couldn't find Article with 'id'=\" as I want to use create function for both Articles and Posts but here i am commenting from Posts and getting the error, I did try to use if &amp; else like \"if params[:post_id] != 0\" on both but not working.</p>\n\n<pre><code>class CommentsController &lt; ApplicationController\n  before_filter :authorize\n  def index\n  end\n  def create\n      @article = Article.find(params[:article_id])\n      @comment = @article.comments.create(comment_params)\n      redirect_to article_path(@article)\n\n      @post = Post.find(params[:post_id])\n      @comment = @post.comments.create(comment_params)\n      redirect_to post_path(@post)\n  end\n  private\n  def comment_params\n    params.require(:comment).permit(:username, :comment_body)\n  end\nend\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "for-loop", "null", "fixnum"], "comments": [{"owner": {"reputation": 2607, "user_id": 4470392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvLjT.jpg?s=128&g=1", "display_name": "Maxim Pontyushenko", "link": "https://stackoverflow.com/users/4470392/maxim-pontyushenko"}, "edited": false, "score": 1, "creation_date": 1453309829, "post_id": 34906125, "comment_id": 57548465, "body": "Your code has a lot of mistakes. To get rid of this error you can add <code>.to_i</code> to the end of this line like this: <code>$averageArr.last.to_i</code>. Bet this won&#39;t help you much."}, {"owner": {"reputation": 426, "user_id": 5775845, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/TXE3P.png?s=128&g=1", "display_name": "kairocks2002", "link": "https://stackoverflow.com/users/5775845/kairocks2002"}, "reply_to_user": {"reputation": 2607, "user_id": 4470392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvLjT.jpg?s=128&g=1", "display_name": "Maxim Pontyushenko", "link": "https://stackoverflow.com/users/4470392/maxim-pontyushenko"}, "edited": false, "score": 0, "creation_date": 1453309938, "post_id": 34906125, "comment_id": 57548526, "body": "Thankyou! I will try this!"}, {"owner": {"reputation": 2607, "user_id": 4470392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvLjT.jpg?s=128&g=1", "display_name": "Maxim Pontyushenko", "link": "https://stackoverflow.com/users/4470392/maxim-pontyushenko"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1453310211, "post_id": 34906125, "comment_id": 57548720, "body": "@lurker Take a look at the previous line. <code>puts</code> will never be called."}, {"owner": {"reputation": 3630, "user_id": 4799659, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153200714295120/picture?type=large", "display_name": "fylooi", "link": "https://stackoverflow.com/users/4799659/fylooi"}, "edited": false, "score": 0, "creation_date": 1453310229, "post_id": 34906125, "comment_id": 57548726, "body": "A shorter way to get the average: <code>$averageArr.map(&amp;:to_i).sum  &#47; $averageArr.length</code>"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "reply_to_user": {"reputation": 2607, "user_id": 4470392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvLjT.jpg?s=128&g=1", "display_name": "Maxim Pontyushenko", "link": "https://stackoverflow.com/users/4470392/maxim-pontyushenko"}, "edited": false, "score": 0, "creation_date": 1453310257, "post_id": 34906125, "comment_id": 57548746, "body": "@MaximPontyushenko oops sorry, yes you&#39;re right, my eye was just focusing on that last statement."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1453310288, "post_id": 34906125, "comment_id": 57548766, "body": "Are you sure <code>orderbook[&quot;last&quot;]</code> is never <code>nil</code>? You might want to do some debugging to find out. Your <code>getAverage</code> actually returns a string when <code>$counter</code> is less than or equal to 5, which also looks wrong. And you have a <code>return ...</code> before <code>$currAve = sum&#47;5</code> so that statement will never be reached. Just to name a few issues..."}, {"owner": {"reputation": 640, "user_id": 2326613, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5f0821b3c32c0537c027a657ec7e977b?s=128&d=identicon&r=PG", "display_name": "JosephK", "link": "https://stackoverflow.com/users/2326613/josephk"}, "edited": false, "score": 0, "creation_date": 1491443501, "post_id": 34906125, "comment_id": 73558693, "body": "It throws the error because Ruby was never designed as a web-scripting language.  Obviously, you don&#39;t want to get a page-crash on nil - it should evaluate to zero in this context, automatically.  The &quot;to_i&quot; and &quot;to_f&quot; methods, appended on each variable where those are expected, can trick Ruby into not crashing idiotically on those, but won&#39;t help when you need a decimal (&quot;to_d&quot; on a nil &quot;crashes&quot; swell!) - so must check every variable in every calculation/equation to &quot;check if its nil&quot; on currency variables = countless wasted time +confusing code to your project."}], "answers": [{"tags": [], "owner": {"reputation": 3630, "user_id": 4799659, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153200714295120/picture?type=large", "display_name": "fylooi", "link": "https://stackoverflow.com/users/4799659/fylooi"}, "is_accepted": true, "score": 0, "last_activity_date": 1453310949, "creation_date": 1453310949, "answer_id": 34906644, "question_id": 34906125, "link": "https://stackoverflow.com/questions/34906125/nil-cant-be-coerced-into-fixnum-typeerror-wont-go-away/34906644#34906644", "title": "`+&#39; nil can&#39;t be coerced into FixNum (TypeError) won&#39;t go away", "body": "<p>Your syntax is fine. The problem is that your methods are not validating data. </p>\n\n<p><code>a += b</code> expands to <code>a = a + b</code>, which will throw the error you're facing when <code>b</code> is <code>nil</code>.</p>\n\n<p>You need to make sure that <code>getQuote</code> always returns a number, or cast whatever you want to average into a number before performing mathematical operations. </p>\n\n<p>For the former, you can change <code>return orderbook[\"last\"]</code> to <code>return orderbook[\"last\"].to_f</code> </p>\n\n<p>For the latter,  <code>sum += $averageArr[$averageArr.count - i].to_f</code></p>\n"}], "owner": {"reputation": 426, "user_id": 5775845, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/TXE3P.png?s=128&g=1", "display_name": "kairocks2002", "link": "https://stackoverflow.com/users/5775845/kairocks2002"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 0, "closed_date": 1453350105, "accepted_answer_id": 34906644, "answer_count": 1, "score": -4, "last_activity_date": 1453312240, "creation_date": 1453309469, "last_edit_date": 1453312240, "question_id": 34906125, "link": "https://stackoverflow.com/questions/34906125/nil-cant-be-coerced-into-fixnum-typeerror-wont-go-away", "closed_reason": "Not suitable for this site", "title": "`+&#39; nil can&#39;t be coerced into FixNum (TypeError) won&#39;t go away", "body": "<p>I'm using HTTParty to connect to stockfighter.io 's API and getting a quote of a stock, which I then extract a price per share from and append it to the end of the <code>$averageArr</code> array.</p>\n\n<p>I'm trying to average the last five values of a constantly updating array, <code>$averageArr</code>, and so I thought I would make a variable <code>sum</code> set it to zero, add those last five values to it and then divide it by 5 to get a dynamic and changing average.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>require 'rubygems'\nrequire 'httparty'\nrequire 'json'\n\napikey = 'API_KEY_FOR_LOGIN_HERE'\nvenue = \"VENUEX\"\nstock = \"FOOBAR\"\n\nbase_url = \"https://api.stockfighter.io/ob/api\"\n\naccount = \"MY_ACCOUNT_HERE\"\n\n$averageArr = []\n\n$counter = 0\n\n$currAve = 0\n\n\ndef getQuote(stock, venue, account)\n\n    response = HTTParty.get(\"https://api.stockfighter.io/ob/api/venues/#{venue}/stocks/#{stock}/quote\")\n\n    orderbook = response.parsed_response\n\n    puts orderbook[\"ok\"]\n\n    return orderbook[\"last\"]\n    puts orderbook[\"lastTrade\"]\n\nend\n\n\ndef getAverage(stock, venue, account)\n\n    $averageArr.push(getQuote(stock, venue, account))\n    $counter += 1\n\n    if $counter &gt; 5\n\n        sum = 0\n\n        #line 43\n        for i in 1..5 do\n            # this one is line 45\n            sum += $averageArr[$averageArr.count - i]\n\n        end\n\n\n        return sum/5\n        $currAve = sum/5\n\n    else\n\n        return 'WAITING FOR QUOTE. CURRENT:'\n\n    end\nend\n\n\n# line 62\nfor i in 1..10 do\n\n    # line 64\n    getAverage(stock, venue, account)\n\n    if $counter &gt; 5\n\n        if getQuote(stock, venue, account) &lt; $currAve - 25 and numShares &lt; 999\n\n            order = {\n\n                    \"account\" =&gt; account,\n                    \"venue\" =&gt; venue,\n                    \"symbol\" =&gt; stock,\n                    \"price\" =&gt; 1,  #$250.00 -- probably ludicrously high\n                    \"qty\" =&gt; 1,\n                    \"direction\" =&gt; \"buy\",\n                    \"orderType\" =&gt; \"market\"  # See the order docs for what a limit order is\n\n                  }\n\n            response = HTTParty.post(\"#{base_url}/venues/#{venue}/stocks/#{stock}/orders\",\n                                   :body =&gt; JSON.dump(order),\n                                   :headers =&gt; {\"X-Starfighter-Authorization\" =&gt; apikey}\n                                   )\n\n        elsif getQuote(stock, venue, account) &gt; $currAve + 25 and numShares &gt; 0\n\n            order = {\n\n                    \"account\" =&gt; account,\n                    \"venue\" =&gt; venue,\n                    \"symbol\" =&gt; stock,\n                    \"price\" =&gt; 1,  #$250.00 -- probably ludicrously high\n                    \"qty\" =&gt; 1,\n                    \"direction\" =&gt; \"sell\",\n                    \"orderType\" =&gt; \"market\"  # See the order docs for what a limit order is\n\n                  }\n\n            response = HTTParty.post(\"#{base_url}/venues/#{venue}/stocks/#{stock}/orders\",\n                                   :body =&gt; JSON.dump(order),\n                                   :headers =&gt; {\"X-Starfighter-Authorization\" =&gt; apikey}\n                                   )\n\n        end\n    end\nend\n</code></pre>\n\n<p>I've been having difficulty with line 45 (commented), in which I get errors about <code>FixNum</code> and <code>nil</code>:</p>\n\n<pre><code>/Users/kaichristensen/Dropbox/Kai/Stockfighter/level_three_selling.rb:45:in `+': nil can't be coerced into Fixnum (TypeError)\nfrom /Users/kaichristensen/Dropbox/Kai/Stockfighter/level_three_selling.rb:45:in `block in getAverage'\nfrom /Users/kaichristensen/Dropbox/Kai/Stockfighter/level_three_selling.rb:43:in `each'\nfrom /Users/kaichristensen/Dropbox/Kai/Stockfighter/level_three_selling.rb:43:in `getAverage'\nfrom /Users/kaichristensen/Dropbox/Kai/Stockfighter/level_three_selling.rb:64:in `block in &lt;main&gt;'\nfrom /Users/kaichristensen/Dropbox/Kai/Stockfighter/level_three_selling.rb:62:in `each'\nfrom /Users/kaichristensen/Dropbox/Kai/Stockfighter/level_three_selling.rb:62:in `&lt;main&gt;'\n</code></pre>\n\n<p>I might be trying to access and index out of scope on the array, but that doesn't seem to be the problem. Any help would be appreciated.</p>\n"}, {"tags": ["python", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 538888, "user_id": 104349, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0f4cefeedec5163556751d61625eedd0?s=128&d=identicon&r=PG", "display_name": "Daniel Roseman", "link": "https://stackoverflow.com/users/104349/daniel-roseman"}, "edited": false, "score": 0, "creation_date": 1453309152, "post_id": 34905880, "comment_id": 57548019, "body": "Can you explain why you need to actually start it from within Rails, rather than starting it from whatever deploys/starts the Rails app itself (eg Capistrano)?"}, {"owner": {"reputation": 21, "user_id": 5817067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uhc9j.jpg?s=128&g=1", "display_name": "Agon Qurdina", "link": "https://stackoverflow.com/users/5817067/agon-qurdina"}, "reply_to_user": {"reputation": 538888, "user_id": 104349, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0f4cefeedec5163556751d61625eedd0?s=128&d=identicon&r=PG", "display_name": "Daniel Roseman", "link": "https://stackoverflow.com/users/104349/daniel-roseman"}, "edited": false, "score": 0, "creation_date": 1453309359, "post_id": 34905880, "comment_id": 57548152, "body": "I am using Rails with Nginx/Passenger. After some time of working correctly, multiple requests, the python application throws an error and will not work anymore until I restart it. And I need to catch this error in my app, and restart the server automatically in such a case."}, {"owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "edited": false, "score": 1, "creation_date": 1453311272, "post_id": 34905880, "comment_id": 57549440, "body": "You could use a process monitor such as <a href=\"https://mmonit.com/monit/\" rel=\"nofollow noreferrer\">monit</a>"}, {"owner": {"reputation": 9737, "user_id": 2422778, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aUihh.jpg?s=128&g=1", "display_name": "Mike Szyndel", "link": "https://stackoverflow.com/users/2422778/mike-szyndel"}, "edited": false, "score": 0, "creation_date": 1453312155, "post_id": 34905880, "comment_id": 57550042, "body": "The problem is that your Rails app starts with different env variables than your shell I think. Make sure that you have  <code>ENV[&#39;SERVER_NAME&#39;]</code> before calling system."}, {"owner": {"reputation": 9737, "user_id": 2422778, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aUihh.jpg?s=128&g=1", "display_name": "Mike Szyndel", "link": "https://stackoverflow.com/users/2422778/mike-szyndel"}, "edited": false, "score": 1, "creation_date": 1453312208, "post_id": 34905880, "comment_id": 57550073, "body": "Also I think that restarting the python app from Rails, instead of investigating what is the actual reason python app stops, is a very stupid way to go."}, {"owner": {"reputation": 21, "user_id": 5817067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uhc9j.jpg?s=128&g=1", "display_name": "Agon Qurdina", "link": "https://stackoverflow.com/users/5817067/agon-qurdina"}, "edited": false, "score": 0, "creation_date": 1453313678, "post_id": 34905880, "comment_id": 57550990, "body": "Yes, I also think the problem is the lack of Environment Variables while executing the command from Rails(the reason that it works in gnome terminal, but doesn&#39;t in my app). Do you know any way to import them before making the command call? And I also know that this is not a good solution, but it&#39;s just a temporary one until I find someone who knows Python programming to debug the script."}], "owner": {"reputation": 21, "user_id": 5817067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uhc9j.jpg?s=128&g=1", "display_name": "Agon Qurdina", "link": "https://stackoverflow.com/users/5817067/agon-qurdina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1453308765, "creation_date": 1453308765, "last_edit_date": 1495542210, "question_id": 34905880, "link": "https://stackoverflow.com/questions/34905880/problems-executing-python-script-in-rails-application", "title": "Problems executing python script in Rails application", "body": "<p>I have got a python script(program) that I have to execute from my Ruby on Rails application. I can execute it from my gnome terminal(UNIX) using this command:</p>\n\n<p><code>setsid python /path-to-app-directory/api.py 8080 &gt;&gt;python_api.log 2&gt;&amp;1</code></p>\n\n<p>And it works fine. Such an execution makes an API service be started on localhost, port 8080, where I can then send different requests and it responses really quickly.</p>\n\n<p>Now, my task is to integrate it in my own app - start such a service inside my Rails application. But when executing command </p>\n\n<p><code>system('setsid python /path-to-app-directory/api.py 8080 &gt;&gt;python_api.log 2&gt;&amp;1')</code>  </p>\n\n<p>I get this error:</p>\n\n<p><code>WSGIServer: missing FastCGI param REQUEST_METHOD required by WSGI!\nWSGIServer: missing FastCGI param SERVER_NAME required by WSGI!\nWSGIServer: missing FastCGI param SERVER_PORT required by WSGI!\nWSGIServer: missing FastCGI param SERVER_PROTOCOL required by WSGI!\nStatus: 404 Not Found\nContent-Type: text/html</code></p>\n\n<p>and the service is not started.</p>\n\n<p>I have tried also with the other possible methods that Ruby offers for executing this kind of commands, like: using backsticks, exec() method or spawn() method. But the same error occurs in both cases.</p>\n\n<p>After some research, it seems like python script is missing some modules when called from another process(shell), as these parameters would usually be received from the OS Environment Variables. More on this topic: \n<a href=\"https://stackoverflow.com/questions/800584/wsgiserver-errors-when-trying-to-run-django-app\">WSGIServer errors when trying to run Django app</a></p>\n\n<p>Having got no prior experience with Python programming, I would appreciate any help in solving this.</p>\n\n<p>Thank you beforehand.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "partials"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1453313272, "post_id": 34905847, "comment_id": 57550752, "body": "The reason it&#39;s rendering &quot;something like a database dump&quot; is that <code>&lt;%= @users.each do |f| %&gt;</code> outputs the return value of <code>@users.each</code>, and <code>each</code> returns its callee, which is <code>@users</code>. That is, in addition to everything inside the loop, you&#39;re also printing the <code>@users</code> object itself because that&#39;s what <code>each</code> returns. To fix that, change <code>&lt;%=</code> on that line to just <code>&lt;%</code>."}, {"owner": {"reputation": 81, "user_id": 5811730, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e63a018006bf9925ef32e34cae79547?s=128&d=identicon&r=PG&f=1", "display_name": "Helban", "link": "https://stackoverflow.com/users/5811730/helban"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1453313864, "post_id": 34905847, "comment_id": 57551071, "body": "@Jordan Thank you jordan! What you said makes sense! Thats a good tip to remember! Alright, so I&#39;ve got the &#39;dump&#39; fixed, just left to properly render the forms for each corresponding user so the &#39;endorse&#39; button works and sends the correct data :("}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 5811730, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e63a018006bf9925ef32e34cae79547?s=128&d=identicon&r=PG&f=1", "display_name": "Helban", "link": "https://stackoverflow.com/users/5811730/helban"}, "edited": false, "score": 0, "creation_date": 1453316070, "post_id": 34907946, "comment_id": 57552301, "body": "Actually makes sense what you said Jordan. but now i&#39;m getting undefined local variable or method `endorsed_user&#39; for #&lt;#&lt;Class:0x0  same line"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "reply_to_user": {"reputation": 81, "user_id": 5811730, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e63a018006bf9925ef32e34cae79547?s=128&d=identicon&r=PG&f=1", "display_name": "Helban", "link": "https://stackoverflow.com/users/5811730/helban"}, "edited": false, "score": 0, "creation_date": 1453317202, "post_id": 34907946, "comment_id": 57552909, "body": "Sorry, I forgot that when you have options you have to use <code>render partial: &#39;foo&#39;, ...</code> and not just <code>render &#39;foo&#39;, ...</code>. I&#39;ve updated my answer."}, {"owner": {"reputation": 81, "user_id": 5811730, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e63a018006bf9925ef32e34cae79547?s=128&d=identicon&r=PG&f=1", "display_name": "Helban", "link": "https://stackoverflow.com/users/5811730/helban"}, "edited": false, "score": 0, "creation_date": 1453317480, "post_id": 34907946, "comment_id": 57553057, "body": "Thank you! Alright this part might be confusing but, i am actually using a partial that renders another partial. endorse_form looks like this  <code>&lt;% unless current_user?(@user) %&gt;   &lt;div id=&quot;endorse_form&quot;&gt;   &lt;% if current_user.endorsing?(@user) %&gt;     &lt;%= render &#39;shared&#47;unendorse&#39; %&gt;   &lt;% else %&gt;     &lt;%= render &#39;shared&#47;endorse&#39; %&gt;   &lt;% end %&gt;   &lt;&#47;div&gt; &lt;% end %&gt;</code>"}, {"owner": {"reputation": 81, "user_id": 5811730, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e63a018006bf9925ef32e34cae79547?s=128&d=identicon&r=PG&f=1", "display_name": "Helban", "link": "https://stackoverflow.com/users/5811730/helban"}, "edited": false, "score": 0, "creation_date": 1453317642, "post_id": 34907946, "comment_id": 57553127, "body": "So in fact, the form is in the shared/endorse, can i further pass that local from that partial to the next partials? Because i want all of them also work on the user profile. And them to change from endorse to unendorse so you can give and take it back sort of. If i change the code to use <code>shared&#47;endorse</code> instead of <code>shared&#47;endorse_form</code> it works correctly like it should, but then i loose the option to take that endors back, and i cant use it on the @user profile page then too. On the profile page it was using the @user to work correctly... bah im getting all lost with this now.."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "reply_to_user": {"reputation": 81, "user_id": 5811730, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e63a018006bf9925ef32e34cae79547?s=128&d=identicon&r=PG&f=1", "display_name": "Helban", "link": "https://stackoverflow.com/users/5811730/helban"}, "edited": false, "score": 0, "creation_date": 1453319675, "post_id": 34907946, "comment_id": 57554267, "body": "Yes, <code>endorsed_user</code> is just a regular Ruby variable and <code>render</code> is just a regular Ruby method, so you can pass it on as above, e.g. <code>render partial: &#39;shared&#47;endorse&#39;, locals: { endorsed_user: endorsed_user }</code>."}, {"owner": {"reputation": 81, "user_id": 5811730, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e63a018006bf9925ef32e34cae79547?s=128&d=identicon&r=PG&f=1", "display_name": "Helban", "link": "https://stackoverflow.com/users/5811730/helban"}, "edited": false, "score": 0, "creation_date": 1453321376, "post_id": 34907946, "comment_id": 57555200, "body": "Thanks a lot bro! That solved my problem, but also raised yet another ones (god damn it :( ) Now when i endorse someone from his profile, it works, and changes to remove button, but when clicked, it does not change back to endorse, giving the same error <code>undefined local variable or method </code>endorsed_user&#39; for`... Also when trying to endorse from search results, lets say the 3rd result, the button changes for the first result instead of the 3rd... i give up...   I think i will just srcap all this and just stay with the possibility to endorse only from the profile page, not search results."}, {"owner": {"reputation": 81, "user_id": 5811730, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e63a018006bf9925ef32e34cae79547?s=128&d=identicon&r=PG&f=1", "display_name": "Helban", "link": "https://stackoverflow.com/users/5811730/helban"}, "edited": false, "score": 0, "creation_date": 1453321784, "post_id": 34907946, "comment_id": 57555434, "body": "i must add that the error is visible in the server logs, the database record actually gets removed."}, {"owner": {"reputation": 81, "user_id": 5811730, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e63a018006bf9925ef32e34cae79547?s=128&d=identicon&r=PG&f=1", "display_name": "Helban", "link": "https://stackoverflow.com/users/5811730/helban"}, "edited": false, "score": 0, "creation_date": 1453734634, "post_id": 34907946, "comment_id": 57719739, "body": "Any luck with my case mate? :("}, {"owner": {"reputation": 81, "user_id": 5811730, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e63a018006bf9925ef32e34cae79547?s=128&d=identicon&r=PG&f=1", "display_name": "Helban", "link": "https://stackoverflow.com/users/5811730/helban"}, "edited": false, "score": 0, "creation_date": 1453739883, "post_id": 34907946, "comment_id": 57723272, "body": "Alright, i&#39;ve managed to fix the rendering of the correct button on search results by adding dynamically generated ID&#39;s to the div, but the main problem still persists. I don&#39;t know why i get the error <code>NameError (undefined local variable or method endorsed_user</code> when trying to UNendorse. The record gets deleted but rendering back the endorse raises an such an error. Im all out of ideas :( :( :("}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "reply_to_user": {"reputation": 81, "user_id": 5811730, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e63a018006bf9925ef32e34cae79547?s=128&d=identicon&r=PG&f=1", "display_name": "Helban", "link": "https://stackoverflow.com/users/5811730/helban"}, "edited": false, "score": 0, "creation_date": 1453743582, "post_id": 34907946, "comment_id": 57725539, "body": "I suggest posting a new question with a description of the issue you&#39;re having, including all of your updated code and the stack trace of the error."}], "tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": true, "score": 0, "last_activity_date": 1453317144, "last_edit_date": 1453317144, "creation_date": 1453315295, "answer_id": 34907946, "question_id": 34905847, "link": "https://stackoverflow.com/questions/34905847/ruby-on-rails-render-partial-form-for-each-user-found-from-search-results/34907946#34907946", "title": "Ruby on Rails: render partial form for each user found from search results", "body": "<p>The problem is that instance variables (like <code>@user</code>) aren't passed to partials automatically, so in your <code>endorse_form</code> partial <code>@user</code> is <code>nil</code>. (Also, <code>@user</code> isn't actually the object you want\u2014you want to use the object that's yielded in each iteration of <code>@users.each</code>.) The solution is to use the <code>locals</code> option, which lets you tell <code>render</code>, what variables you want to be available in the partial and what their names should be:</p>\n\n<pre><code>&lt;%= @users.each do |user| %&gt;\n  &lt;%= render user %&gt;\n  &lt;%= render partial: 'shared/endorse_form', locals: { endorsed_user: user } if logged_in? %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I've done two things here. First, I renamed <code>f</code> to <code>user</code>, since <code>f</code> doesn't really make sense as a name for a User object. (In Rails views <code>f</code> usually refers to a FormBuilder object as yielded to the block you pass to <code>form_for</code>.)</p>\n\n<p>Second, I added the option <code>locals: { endorsed_user: user }</code>. This tells <code>render</code>, \"I want there to be a local variable named <code>endorsed_user</code> that I can use in the partial, and I want its value to be the value of <code>user</code>,\" which is the User object yielded by this iteration of <code>each</code>.</p>\n\n<p>Then, in your <code>endorse_form</code> partial, you'll use the local variable <code>endorsed_user</code> instead of the instance variable <code>@user</code>:</p>\n\n<pre><code>&lt;%= form_for(current_user.active_endorsements.build, remote: true) do |f| %&gt;\n  &lt;div&gt;&lt;%= hidden_field_tag :endorsed_id, endorsed_user.id %&gt;&lt;/div&gt;\n  &lt;%= f.submit \"Endorse\", class: \"btn btn-primary\" %&gt;\n  &lt;%= f.text_field :comment, class: 'form-control' %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 5811730, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e63a018006bf9925ef32e34cae79547?s=128&d=identicon&r=PG&f=1", "display_name": "Helban", "link": "https://stackoverflow.com/users/5811730/helban"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 879, "favorite_count": 0, "accepted_answer_id": 34907946, "answer_count": 1, "score": 0, "last_activity_date": 1453317144, "creation_date": 1453308687, "last_edit_date": 1453313136, "question_id": 34905847, "link": "https://stackoverflow.com/questions/34905847/ruby-on-rails-render-partial-form-for-each-user-found-from-search-results", "title": "Ruby on Rails: render partial form for each user found from search results", "body": "<p>Is it possible to render a form from a shared partial for each user I get as a search result?</p>\n\n<p>So when I search for <code>adam</code>, I get something like:</p>\n\n<p>Adam1 [follow form]</p>\n\n<p>Adam2 [follow form]</p>\n\n<p>Adam3 [follow form]</p>\n\n<p>Where the follow form is a follow button that saves a relationship to the database, so each of the buttons must send a corresponding user id correctly.\nAll the following mechanic etc works correctly, you can follow a user when visiting his profile, but I now implemented a search for users, and when getting the results, I also want the form to be next to each result.</p>\n\n<p>I believe in the view I need to do something like:</p>\n\n<pre><code>&lt;% for result in @results do\n  render result\n  render follow_form\n%&gt;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>&lt;% @results.each do |f|\n  render f\n  render follow_form for f\n%&gt;\n</code></pre>\n\n<p>But I am not exactly sure how to do that.\nEven if I manage to render the users, i cannot render the form next to them. For some reason the @user container is nil.</p>\n\n<p>these are the files for search controller, and the shared forms:</p>\n\n<pre><code>class SearchController &lt; ApplicationController\n\n  def search\n    query = \"%#{params[:query]}%\"\n    @users = User.where(\"name LIKE ? \", query)\n  end\n\nend\n</code></pre>\n\n<p>search view</p>\n\n<pre><code>&lt;%= render 'shared/search_bar' %&gt;\n&lt;ul class=\"users follow\"&gt;\n  &lt;%= @users.each do |f| %&gt;\n    &lt;%= render f %&gt;\n    &lt;%= render 'shared/endorse_form' if logged_in? %&gt;\n    &lt;% end %&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>In the view here /\\ , the render f renders correctly the users BUT also renders something that looks like a database dump below the results containing the users data. When i add the <code>render shared/endorse_form</code> I get the error about an empty class <code>undefined method</code>id' for nil:NilClass`\nin line 2 of the follow(endorse) form which looks like this:</p>\n\n<pre><code>&lt;%= form_for(current_user.active_endorsements.build, remote: true) do |f| %&gt;\n  &lt;div&gt;&lt;%= hidden_field_tag :endorsed_id, @user.id %&gt;&lt;/div&gt;\n  &lt;%= f.submit \"Endorse\", class: \"btn btn-primary\" %&gt;\n  &lt;%= f.text_field :comment, class: 'form-control' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>How to deal with this? ANY help will be greatly appreciated.</p>\n\n<p>all the code is available at <a href=\"https://bitbucket.org/kramarz/pracainzynierska\" rel=\"nofollow\">https://bitbucket.org/kramarz/pracainzynierska</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 3, "creation_date": 1453308569, "post_id": 34905739, "comment_id": 57547614, "body": "Refactoring requests are kinda offtopic here. There&#39;s a site for that: <a href=\"http://codereview.stackexchange.com\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 1316, "user_id": 4169411, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/724127205/picture?type=large", "display_name": "Kaz", "link": "https://stackoverflow.com/users/4169411/kaz"}, "edited": false, "score": 2, "creation_date": 1453308687, "post_id": 34905739, "comment_id": 57547707, "body": "Just a point, Code Review only takes <b>real</b> code. &quot;Foo&quot;, &quot;Bar&quot; etc. will get closed in seconds. If you have that condition in an actual project somewhere, post the actual code."}, {"owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 0, "creation_date": 1453315574, "post_id": 34905739, "comment_id": 57552046, "body": "Why is <code>p3</code> not being checked in <code>if</code> condition?  Are you not interested in values of all keys but only select few?.  Also, why you are using string <code>&quot;p1&quot;</code> in <code>params[&quot;p1&quot;]</code>, when the key is actually a symbol <code>:p1</code> - both are not same."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 1, "creation_date": 1453316854, "post_id": 34905739, "comment_id": 57552717, "body": "@Wand, suppose you were looking for candidates for a rugby team and  <code>params = { :strong-&gt;true, :fast=&gt;true, :downton_abbey_fan=&gt;true,  :rugby_experience=&gt;false  }</code>."}, {"owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1453317027, "post_id": 34905739, "comment_id": 57552817, "body": "@CarySwoveland Point taken, I was just thinking if OP used key <code>:pN</code> instead of <code>:p4</code>, may be (s)he missed to use <code>:p3</code> in <code>if</code> even though (s)he meant to check keys <code>p1</code> through <code>pN</code>.  So, thought of clarifying."}, {"owner": {"reputation": 18438, "user_id": 277740, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/yamcx.jpg?s=128&g=1", "display_name": "tokhi", "link": "https://stackoverflow.com/users/277740/tokhi"}, "reply_to_user": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 0, "creation_date": 1453327538, "post_id": 34905739, "comment_id": 57558672, "body": "@WandMaker There are many keys in the hash and I am only interested in some."}], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 3, "last_activity_date": 1453308679, "creation_date": 1453308679, "answer_id": 34905846, "question_id": 34905739, "link": "https://stackoverflow.com/questions/34905739/checking-multip-hash-keys-if-present/34905846#34905846", "title": "Checking multip hash keys if present", "body": "<p>Something like this:</p>\n\n<pre><code>params.values_at(:p1, :p2, :pN).all?(&amp;:present?)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16076, "user_id": 802618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6111449042dd940f360673d25d61ea6b?s=128&d=identicon&r=PG", "display_name": "Kristj&#225;n", "link": "https://stackoverflow.com/users/802618/kristj%c3%a1n"}, "is_accepted": false, "score": 1, "last_activity_date": 1453308731, "creation_date": 1453308731, "answer_id": 34905865, "question_id": 34905739, "link": "https://stackoverflow.com/questions/34905739/checking-multip-hash-keys-if-present/34905865#34905865", "title": "Checking multip hash keys if present", "body": "<pre><code>if params.values_at(*%i[p1 p2 p3]).all?(&amp;:present?)\n</code></pre>\n\n<p><code>values_at</code> returns an <code>Array</code> of the values for each key you provide.\n<code>all?</code> is <code>true</code> iff the predicate (<code>present?</code>) is <code>true</code> for every member of the enumerable. <code>values_at</code> will include <code>nil</code> for a missing key (rather than omit it), so you don't need to worry about the array collapsing down to only present values.</p>\n"}, {"comments": [{"owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 0, "creation_date": 1453315340, "post_id": 34907827, "comment_id": 57551891, "body": "Instead of <code>keys</code>, one can use <code>params.keys</code> given that <code>params</code> is a hash.  If I am not mistaken, OP seems to be checking whether all keys have value <code>present?</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 0, "creation_date": 1453315435, "post_id": 34907827, "comment_id": 57551950, "body": "@Wand, the OP doesn&#39;t seem to care about <code>:p3</code>."}, {"owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 0, "creation_date": 1453315484, "post_id": 34907827, "comment_id": 57551992, "body": "I see.  Strange though!"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1453314823, "creation_date": 1453314823, "answer_id": 34907827, "question_id": 34905739, "link": "https://stackoverflow.com/questions/34905739/checking-multip-hash-keys-if-present/34907827#34907827", "title": "Checking multip hash keys if present", "body": "<pre><code>keys = [:p1, :p2, :pN]\n\nputs \"hi\" if keys.all? { |k| params[k].present? }\n</code></pre>\n\n<p>This has the advantage of terminating the hash lookup as soon as <code>params[k].present?</code> is <code>false</code>.</p>\n"}], "owner": {"reputation": 18438, "user_id": 277740, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/yamcx.jpg?s=128&g=1", "display_name": "tokhi", "link": "https://stackoverflow.com/users/277740/tokhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "closed_date": 1453987433, "accepted_answer_id": 34905846, "answer_count": 3, "score": -3, "last_activity_date": 1453327421, "creation_date": 1453308387, "last_edit_date": 1453327421, "question_id": 34905739, "link": "https://stackoverflow.com/questions/34905739/checking-multip-hash-keys-if-present", "closed_reason": "Needs details or clarity", "title": "Checking multip hash keys if present", "body": "<p>Any tips to refactor this condition?</p>\n\n<pre><code> params = {:p1=&gt;\"foo\", :p2=&gt;true, :p3=&gt;nil, :pN=&gt;\"\"}\n\n if params[:p1].present? &amp;&amp; params[:p2].present? &amp;&amp; params[:pN].present?\n  # do something...\n</code></pre>\n"}, {"tags": ["ruby", "selenium-webdriver", "cucumber", "capybara", "site-prism"], "answers": [{"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 0, "last_activity_date": 1453311944, "creation_date": 1453311944, "answer_id": 34906979, "question_id": 34905673, "link": "https://stackoverflow.com/questions/34905673/background-step-sometimes-never-executes-before-few-scenarios-on-a-cucumber-feat/34906979#34906979", "title": "Background step sometimes never executes before few scenarios on a cucumber feature file", "body": "<p>If this is actually the case, then it would be a bug in cucumber and should be reported over at the cucumber project.  It's more likely that it is actually executing the background but you have requests still running at the end of previous tests that are modifying your database and making it look like the background isn't running.  You can test that by adding a step into the background that outputs something to the screen and then count how many times is is output.</p>\n"}], "owner": {"reputation": 207, "user_id": 5631763, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/245046d37ae87654c4d5e83266568584?s=128&d=identicon&r=PG&f=1", "display_name": "SaeeK", "link": "https://stackoverflow.com/users/5631763/saeek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 34906979, "answer_count": 1, "score": 0, "last_activity_date": 1453311944, "creation_date": 1453308165, "question_id": 34905673, "link": "https://stackoverflow.com/questions/34905673/background-step-sometimes-never-executes-before-few-scenarios-on-a-cucumber-feat", "title": "Background step sometimes never executes before few scenarios on a cucumber feature file", "body": "<p>I saw a wired issue recently that Background step sometimes don't executes before few scenarios in a feature file. I have no idea why this is happened. Any body saw this issue in cucumber ruby framework? Is there any limitations of scenario count on each feature file? In below examples, i saw Background step executes only for 1st 5 scenarios but not others. </p>\n\n<p>Feature: Something</p>\n\n<p>Background:\n    Given step 1\n    And step 2</p>\n\n<p>Scenario: a scenario\n    When I do step 3\n    Then it works</p>\n\n<p>Scenario: another scenario\n    When I do a different step 3\n    Then it works</p>\n\n<p>Scenario: another scenario 4\n    When I do a different step 4\n    Then it works</p>\n\n<p>Scenario: another scenario 5\n    When I do a different step 5\n    Then it works</p>\n"}, {"tags": ["ruby", "configuration", "duplicates", "rvm", "dotfiles"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1453309868, "post_id": 34905560, "comment_id": 57548488, "body": "I my opinion it is a good practice to define the Ruby version against which the project is build and tested. Because when developers try to run the same project with different Ruby versions they will run into problems sooner or later. Since the <code>.ruby-version</code> (and the <code>Gemfile</code> if you run your app in Heroku) is the de facto standard, I see no benefit in maintaining older, incompatible file types."}, {"owner": {"reputation": 20735, "user_id": 307106, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6a13e655e637138f8d571cec3f9cea76?s=128&d=identicon&r=PG", "display_name": "jrochkind", "link": "https://stackoverflow.com/users/307106/jrochkind"}, "edited": false, "score": 0, "creation_date": 1453317921, "post_id": 34905560, "comment_id": 57553277, "body": "I&#39;d do what the rvm warning says, and delete the .rvmrc and just use .ruby-version. That&#39;s what the warning is telling you, right?"}, {"owner": {"reputation": 2175, "user_id": 2859525, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/tid9B.jpg?s=128&g=1", "display_name": "Todd", "link": "https://stackoverflow.com/users/2859525/todd"}, "reply_to_user": {"reputation": 20735, "user_id": 307106, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6a13e655e637138f8d571cec3f9cea76?s=128&d=identicon&r=PG", "display_name": "jrochkind", "link": "https://stackoverflow.com/users/307106/jrochkind"}, "edited": false, "score": 0, "creation_date": 1453323167, "post_id": 34905560, "comment_id": 57556247, "body": "@jrochkind sort-of. The caveat there is it actually generates a new file, named something like <code>.ruby-version-DD-MM-YY-SOMEOTHERMETADATA</code> (I forget the exact pattern), and in addition to that, it sets the wrong patch number in the new <code>.ruby-version...</code> file. I could edit this manually and leave it, but then Im circumventing the auto-magic behavior of the <i>rvm</i> command, and that feels hacky. Plus Im making changes to files not requested by my client, and Im not sure what effect it will have on the other contractors envs."}, {"owner": {"reputation": 20735, "user_id": 307106, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6a13e655e637138f8d571cec3f9cea76?s=128&d=identicon&r=PG", "display_name": "jrochkind", "link": "https://stackoverflow.com/users/307106/jrochkind"}, "edited": false, "score": 0, "creation_date": 1453323438, "post_id": 34905560, "comment_id": 57556387, "body": "Okay, you already have a .ruby-version, you don&#39;t need it to generate it for you, that&#39;s just a convenience which is not turning out convenient for you. Why would you need rvm to generate a .ruby-version file for you if you already have one?  I&#39;d manually make sure it&#39;s set to the correct ruby version, probably the same one that was in the .rvmrc."}, {"owner": {"reputation": 2175, "user_id": 2859525, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/tid9B.jpg?s=128&g=1", "display_name": "Todd", "link": "https://stackoverflow.com/users/2859525/todd"}, "edited": false, "score": 0, "creation_date": 1453324051, "post_id": 34905560, "comment_id": 57556707, "body": "Ah sorry I diddnt read your comment thoroughly, I thought you were suggesting running the <code>rvm rvmrc to ruby-version</code> command, which produces what I described above. I also am in agreement with you, and this is what I plan to do, Im really just making sure this isnt due to some kind of established convention Im unaware of, as Ive only been developing in Ruby 2 to 3 years."}, {"owner": {"reputation": 1143, "user_id": 1563837, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0784ce3665c294c4547f81a212014d4b?s=128&d=identicon&r=PG", "display_name": "Josh Bodah", "link": "https://stackoverflow.com/users/1563837/josh-bodah"}, "edited": false, "score": 0, "creation_date": 1453331422, "post_id": 34905560, "comment_id": 57560403, "body": "I wouldn&#39;t version either. Use bundler for this: <a href=\"http://bundler.io/v1.3/gemfile_ruby.html\" rel=\"nofollow noreferrer\">bundler.io/v1.3/gemfile_ruby.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2175, "user_id": 2859525, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/tid9B.jpg?s=128&g=1", "display_name": "Todd", "link": "https://stackoverflow.com/users/2859525/todd"}, "is_accepted": true, "score": 3, "last_activity_date": 1455630037, "creation_date": 1455630037, "answer_id": 35434169, "question_id": 34905560, "link": "https://stackoverflow.com/questions/34905560/is-it-a-bad-practice-to-have-both-a-rvmrc-and-a-ruby-version-in-a-ruby-project/35434169#35434169", "title": "Is it a Bad Practice to Have Both a .rvmrc and a .ruby-version in a Ruby Project?", "body": "<p>It is a \"bad practice\" in that it maintains two conventions at once, which can lead to version management issues in some environments. It also makes it possible for one of the conventions to fall out of sync with the other in regards to the version of ruby used in the project. The <code>.ruby-version</code> file is more conventional at this time, so it would be best to remove the <code>.rvmrc</code> file and only maintain <code>.ruby-version</code>.</p>\n"}], "owner": {"reputation": 2175, "user_id": 2859525, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/tid9B.jpg?s=128&g=1", "display_name": "Todd", "link": "https://stackoverflow.com/users/2859525/todd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "accepted_answer_id": 35434169, "answer_count": 1, "score": 1, "last_activity_date": 1455630037, "creation_date": 1453307892, "last_edit_date": 1495540835, "question_id": 34905560, "link": "https://stackoverflow.com/questions/34905560/is-it-a-bad-practice-to-have-both-a-rvmrc-and-a-ruby-version-in-a-ruby-project", "title": "Is it a Bad Practice to Have Both a .rvmrc and a .ruby-version in a Ruby Project?", "body": "<p>There are two Ruby projects I am currently working on which have both a <code>.rvmrc</code> and a <code>.ruby-version</code> file in their root dir. I use <em>rvm</em> to manage my Ruby versions in my local development environment, and have my own local <code>.rvmrc</code> files in my home directory's copy of various Ruby versions, so naturally I get the <em>rvm</em> warning when I change directory into these projects:</p>\n\n<blockquote>\n  <p>You are using '.rvmrc', it requires trusting, it is slower and it is not compatible with other ruby managers,\n  you can switch to '.ruby-version' using 'rvm rvmrc to ruby-version'\n  or ignore this warning with 'rvm rvmrc warning ignore /home/ME/craft/ruby/rails/CLIENT/APPLICATION/.rvmrc',\n  '.rvmrc' will continue to be the default project file in RVM 1 and RVM 2,\n  to ignore the warning for all files run 'rvm rvmrc warning ignore all.rvmrcs'.</p>\n</blockquote>\n\n<p>I felt it was odd to have both configuration dotfiles in the same project at first, and figured that it might be a historical quirk to the Ruby culture that I was unaware of (Im a less-opinionated language generalist, really). Personally I never use <code>.rvmrc</code> in a project, and I work on 10-15 Ruby projects in a year, and rarely see this file in anything I work with.</p>\n\n<p>The problem really arises on the 2nd of these two projects, where the <code>.rvmrc</code> file has an older patch of the Ruby version than the <code>.ruby-version</code>. This resulted in some complications for my local environment that I resolved, though I feel its a bit awkward. To make it worse, I fixed my environment for the (<em>git</em>) 'master' branch of the project, and when I switched to the latest feature branch, the <code>.ruby-version</code> file was updated to yet another different patch number. So I repeated things like reinstalling <em>bundler</em>, reinstalling all the gems, and I choose to manually switch to this patch version. I am unsure of the 'correct' way to do the above, and this way seems to work for my environment (at the cost of duplicating gems and taking up a bit of space on my hard disk).</p>\n\n<p>I am concerned as to why a project would have both these files defined, and especially concerned for a project that has differing versions/patch numbers in each file.</p>\n\n<p>Is this normal? Should this be rectified by removing the <code>.rvmrc</code> file from the project? Should the <code>.rvmrc</code> file, at the very least, be updated to the same version and patch number as the <code>.ruby-version</code> file? I instinctively feel this isnt right, but want to be aware of any sort of history regarding <em>rvm</em> and other methods for maintaining Ruby versions which might actually make this decision sensible. Can anyone relay the history of how such a situation might sensibly evolve, or is it just a symptom of too many cooks in the kitchen over time?</p>\n\n<p>(<a href=\"https://stackoverflow.com/questions/32934651/is-it-a-bad-practice-to-list-ruby-version-in-both-gemfile-and-ruby-version-dotf\">possibly related question</a> concerning <code>.ruby-version</code> and Gemfile)</p>\n"}, {"tags": ["ruby", "sass", "bundler", "compass"], "comments": [{"owner": {"reputation": 62282, "user_id": 1652962, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2cf5a0741f183379686fe0995ffc27ae?s=128&d=identicon&r=PG", "display_name": "cimmanon", "link": "https://stackoverflow.com/users/1652962/cimmanon"}, "edited": false, "score": 1, "creation_date": 1453308335, "post_id": 34905367, "comment_id": 57547458, "body": "This should be something you can ignore.  You could try upgrading to an alpha version and see if that resolves the problem for you (eg. <code>gem install compass --pre</code>).  The deprecation warning is only in Sass 3.4.20; downgrading to 3.4.19 would also eliminate the warning."}, {"owner": {"reputation": 93, "user_id": 4419564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85a95bb8437f21584500acf0d0c71b37?s=128&d=identicon&r=PG", "display_name": "Hedy", "link": "https://stackoverflow.com/users/4419564/hedy"}, "reply_to_user": {"reputation": 62282, "user_id": 1652962, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2cf5a0741f183379686fe0995ffc27ae?s=128&d=identicon&r=PG", "display_name": "cimmanon", "link": "https://stackoverflow.com/users/1652962/cimmanon"}, "edited": false, "score": 0, "creation_date": 1453309112, "post_id": 34905367, "comment_id": 57547998, "body": "Hummm I already have sass 3.4.19 and I&#39;m using bundler"}, {"owner": {"reputation": 93, "user_id": 4419564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85a95bb8437f21584500acf0d0c71b37?s=128&d=identicon&r=PG", "display_name": "Hedy", "link": "https://stackoverflow.com/users/4419564/hedy"}, "reply_to_user": {"reputation": 62282, "user_id": 1652962, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2cf5a0741f183379686fe0995ffc27ae?s=128&d=identicon&r=PG", "display_name": "cimmanon", "link": "https://stackoverflow.com/users/1652962/cimmanon"}, "edited": false, "score": 0, "creation_date": 1453309209, "post_id": 34905367, "comment_id": 57548054, "body": "If I do a &quot;bundle exec compass compile&quot;, the is no warning ! The problem occurs only during watching..."}], "answers": [{"comments": [{"owner": {"reputation": 62282, "user_id": 1652962, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2cf5a0741f183379686fe0995ffc27ae?s=128&d=identicon&r=PG", "display_name": "cimmanon", "link": "https://stackoverflow.com/users/1652962/cimmanon"}, "edited": false, "score": 0, "creation_date": 1457179585, "post_id": 35810803, "comment_id": 59295702, "body": "This won&#39;t help because the problem is within the modules provided by Compass, not the OP&#39;s code."}], "tags": [], "owner": {"reputation": 759, "user_id": 4159337, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/v0rA8.jpg?s=128&g=1", "display_name": "momciloo", "link": "https://stackoverflow.com/users/4159337/momciloo"}, "is_accepted": false, "score": -2, "last_activity_date": 1457158454, "creation_date": 1457158454, "answer_id": 35810803, "question_id": 34905367, "link": "https://stackoverflow.com/questions/34905367/deprecation-warning-on-ruby-with-compass/35810803#35810803", "title": "Deprecation warning on ruby with compass", "body": "<p>In this case, you just need to stop compass watch command (or restart the cmd) and start the <code>sass-convert</code> function that will fix this problem for you. Next time just regularly use <code>compass watch</code>. Hope this will help.</p>\n"}, {"tags": [], "owner": {"reputation": 181, "user_id": 5763926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f682f83ba4f9ffd4a42eba5a4042569b?s=128&d=identicon&r=PG&f=1", "display_name": "cschaefer", "link": "https://stackoverflow.com/users/5763926/cschaefer"}, "is_accepted": false, "score": 4, "last_activity_date": 1469045210, "creation_date": 1469045210, "answer_id": 38489894, "question_id": 34905367, "link": "https://stackoverflow.com/questions/34905367/deprecation-warning-on-ruby-with-compass/38489894#38489894", "title": "Deprecation warning on ruby with compass", "body": "<p>This just happened to me too. I closed out of the terminal and reopened it, then tried <code>compass watch</code>, at which point it logged the modified sass file but did not write to the css file. So then I ran <code>compass clean</code> followed by <code>compass watch</code> again and then it was working properly. </p>\n"}], "owner": {"reputation": 93, "user_id": 4419564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85a95bb8437f21584500acf0d0c71b37?s=128&d=identicon&r=PG", "display_name": "Hedy", "link": "https://stackoverflow.com/users/4419564/hedy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5026, "favorite_count": 0, "answer_count": 2, "score": 8, "last_activity_date": 1469045210, "creation_date": 1453307326, "last_edit_date": 1453308984, "question_id": 34905367, "link": "https://stackoverflow.com/questions/34905367/deprecation-warning-on-ruby-with-compass", "title": "Deprecation warning on ruby with compass", "body": "<p>When I try to run \"bundle exec compass watch\" as usual on a project, I now have this warning :</p>\n\n<pre><code>DEPRECATION WARNING on line 87 of /home/hedy/Sites/mywebsite.fr/src/vendor/bundle/ruby/2.3.0/gems/compass-core-1.0.3/stylesheets/compass/css3/_deprecated-support.scss: #{} interpolation near operators will be simplified\nin a future version of Sass. To preserve the current behavior, use quotes:\n\n  unquote('\"$moz-\"#{$experimental-support-for-mozilla} \"$webkit-\"#{$experimental-support-for-webkit} \"$opera-\"#{$experimental-support-for-opera} \"$microsoft-\"#{$experimental-support-for-microsoft} \"$khtml-\"#{$experimental-support-for-khtml}')\n\nYou can use the sass-convert command to automatically fix most cases.\n\nDEPRECATION WARNING on line 92 of /home/hedy/Sites/mywebsite.fr/src/vendor/bundle/ruby/2.3.0/gems/compass-core-1.0.3/stylesheets/compass/css3/_deprecated-support.scss: #{} interpolation near operators will be simplified\nin a future version of Sass. To preserve the current behavior, use quotes:\n\n  unquote('\"$ie6-\"#{$legacy-support-for-ie6} \"$ie7-\"#{$legacy-support-for-ie7} \"$ie8-\"#{$legacy-support-for-ie8}')\n\nYou can use the sass-convert command to automatically fix most cases.\n</code></pre>\n\n<p>Every gems are up to date and I don't know how to remove this warning...</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "warden"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1453306323, "post_id": 34904738, "comment_id": 57546012, "body": "Basically what you are doing won&#39;t work since it depends on the order of the filter chain. I would look into creating a <a href=\"http://stackoverflow.com/questions/4223083/custom-authentication-strategy-for-devise\">custom authentication strategy for Warden</a> instead. However I have personally had tons of problems with using auth solutions based on IP when using a mobile connection - especially in 3 world countries. Checking the user agent is an arcane practice with little merit since it is so easily spoofed."}, {"owner": {"reputation": 83, "user_id": 5816769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1340926c5c32eb41a0bd4a1daa31afc?s=128&d=identicon&r=PG&f=1", "display_name": "ntfx", "link": "https://stackoverflow.com/users/5816769/ntfx"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1453368139, "post_id": 34904738, "comment_id": 57573388, "body": "Thanks for the tip. I&#39;ve tried writing a Warden strategy, however I&#39;ve ran into two problems: 1) Warden seems to only authenticate on login and the goal here is to authenticate (authorise?) every request after user has logged in. 2) For some reason in the strategy even with <code>false</code> coming out of <code>valid?</code> Warden still executes the authenticate method, therefore breaking everything on login page. First issue makes second kind of irrelevant."}], "answers": [{"tags": [], "owner": {"reputation": 83, "user_id": 5816769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1340926c5c32eb41a0bd4a1daa31afc?s=128&d=identicon&r=PG&f=1", "display_name": "ntfx", "link": "https://stackoverflow.com/users/5816769/ntfx"}, "is_accepted": true, "score": 4, "last_activity_date": 1453377738, "creation_date": 1453377738, "answer_id": 34923307, "question_id": 34904738, "link": "https://stackoverflow.com/questions/34904738/reseting-session-based-on-user-agent-and-or-ip-change-rails-with-devise/34923307#34923307", "title": "Reseting session based on user agent and/or ip change. Rails with Devise", "body": "<p>I've solved the issue by adding this to initializers/devise.rb </p>\n\n<pre><code>  Warden::Manager.after_authentication do |_user, auth, _opts|\n    auth.raw_session['warden.user.ip'] = auth.request.ip\n    auth.raw_session['warden.user.user_agent'] = auth.request.user_agent\n  end\n</code></pre>\n\n<p>and this to application controller:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n\n  before_action :authorize_ip_user_agent\n\n  protected\n\n  def authorize_ip_user_agent\n    return true unless session['warden.user.ip']\n    warden.logout if session['warden.user.ip'] != request.ip &amp;&amp;\n      session['warden.user.user_agent'] != request.user_agent\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 5816769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1340926c5c32eb41a0bd4a1daa31afc?s=128&d=identicon&r=PG&f=1", "display_name": "ntfx", "link": "https://stackoverflow.com/users/5816769/ntfx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 971, "favorite_count": 0, "accepted_answer_id": 34923307, "answer_count": 1, "score": 1, "last_activity_date": 1453377738, "creation_date": 1453305632, "question_id": 34904738, "link": "https://stackoverflow.com/questions/34904738/reseting-session-based-on-user-agent-and-or-ip-change-rails-with-devise", "title": "Reseting session based on user agent and/or ip change. Rails with Devise", "body": "<p>I would like to reset session whenever user agent and/or user ip changes. Project uses Rails with Devise for authentication, CanCanCan for authorisation. </p>\n\n<p>My approach is:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n\n  before_action :authorize_ip\n\n  def authorize_ip\n    if warden.authenticated?\n      warden.session['ip'] ||= request.ip\n      warden.session['user_agent'] ||= request.user_agent\n      warden.logout if warden.session['ip'] != 'request.ip' &amp;&amp;\n        warden.session['user_agent'] != request.user_agent\n    end\n  end\nend\n</code></pre>\n\n<p>From my understanding, it should set <code>warden.session['ip']</code> and user_agent once and then for following requests whenever <code>request['ip']</code> or user_agent changes, session should be dropped and User should be logged out. However, when tested with different browsers, <code>warden.session['user_agent']</code>  changes according to what browser I use. I suppose I'm misunderstanding something. Also, if there is a better approach to this problem, please share.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "json", "validation", "schema"], "answers": [{"tags": [], "owner": {"reputation": 684, "user_id": 4229830, "user_type": "registered", "profile_image": "https://graph.facebook.com/100004832858708/picture?type=large", "display_name": "Mohammad Al Alwa", "link": "https://stackoverflow.com/users/4229830/mohammad-al-alwa"}, "is_accepted": true, "score": 2, "last_activity_date": 1453314103, "last_edit_date": 1453314103, "creation_date": 1453313744, "answer_id": 34907509, "question_id": 34904667, "link": "https://stackoverflow.com/questions/34904667/rubys-json-schema-validator-dealing-with-required-optional-and-undefined-fie/34907509#34907509", "title": "ruby&#39;s json schema validator - dealing with required, optional and undefined fields", "body": "<blockquote>\n  <p>I would like the validation to fail as there is a \"new_field\" which is not defined in the schema.</p>\n</blockquote>\n\n<p>So you want the validation to fail when <strong>additional properties</strong> outside the schema are present.</p>\n\n<p>Add <code>\"additionalProperties\" =&gt; false</code> to your schema to achieve this. And don't use the <code>strict</code> option.</p>\n\n<p>In details. let the schema be:</p>\n\n<pre><code>schema = {\n    \"type\" =&gt; \"object\",\n    \"properties\" =&gt; {\n        \"id\" =&gt; {\"type\": \"string\"},\n        \"experience\" =&gt; {\"type\": \"array\"},\n        \"education\" =&gt; {\"type\": \"string\"}\n    },\n    \"required\" =&gt; [\"id\", \"education\"],\n    \"additionalProperties\" =&gt; false\n}\n</code></pre>\n\n<p>And this validation is gonna fail:</p>\n\n<pre><code>JSON::Validator.validate!(schema, {\"id\" =&gt; '1', \"education\" =&gt; \"MIT\", \"new_field\":\"dummy\"})\n</code></pre>\n\n<p>But this won't:</p>\n\n<pre><code>JSON::Validator.validate!(schema, {\"id\" =&gt; '1', \"education\" =&gt; \"MIT\"})\n</code></pre>\n\n<p>Note that i adjusted <code>id</code> to be <code>String</code> not <code>FixNum</code>.</p>\n"}], "owner": {"reputation": 43, "user_id": 5224347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/269379a110e4a6d57205ea5a9cfa84b2?s=128&d=identicon&r=PG&f=1", "display_name": "Satish_london", "link": "https://stackoverflow.com/users/5224347/satish-london"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1060, "favorite_count": 0, "accepted_answer_id": 34907509, "answer_count": 1, "score": 1, "last_activity_date": 1453314103, "creation_date": 1453305422, "last_edit_date": 1453308859, "question_id": 34904667, "link": "https://stackoverflow.com/questions/34904667/rubys-json-schema-validator-dealing-with-required-optional-and-undefined-fie", "title": "ruby&#39;s json schema validator - dealing with required, optional and undefined fields", "body": "<p>I'm using json-schema in ruby to do this check.</p>\n\n<pre><code>schema = {\n      \"type\" =&gt; \"object\",\n      \"properties\" =&gt; {\n          \"id\" =&gt; {\"type\": \"string\"},\n          \"experience\" =&gt; {\"type\": \"array\"},\n          \"education\" =&gt; {\"type\": \"string\"}\n      },\n      \"required\" =&gt; [\"id\", \"education\"]\n  }\n\nJSON::Validator.validate!(schema, {\"id\" =&gt; 1, \"education\" =&gt; \"MIT\", \"new_field\":\"dummy\"})\n</code></pre>\n\n<p>I would like the validation to fail as there is a \"new_field\" which is not defined in the schema. However it doesn't fail as the validation seems to be happy that the required field is present. </p>\n\n<pre><code> JSON::Validator.validate!(schema, {\"id\" =&gt; 1, \"education\" =&gt; \"MIT\", \"new_field\":\"dummy\"},:strict =&gt; true)\n</code></pre>\n\n<p>If I use strict option it complains about \"experience\" along with \"new_field\", which I don't like. I would like to complain only when it finds any undefined keys not mentioned in the original schema.</p>\n"}, {"tags": ["html", "ruby", "watir", "watir-webdriver"], "comments": [{"owner": {"reputation": 409, "user_id": 3513665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RvMjj.jpg?s=128&g=1", "display_name": "Carldmitch", "link": "https://stackoverflow.com/users/3513665/carldmitch"}, "edited": false, "score": 0, "creation_date": 1453311892, "post_id": 34904021, "comment_id": 57549834, "body": "the span is &#39;covering&#39; the dropdown <a href=\"http://stackoverflow.com/a/31587325/3513665\">stackoverflow.com/a/31587325/3513665</a>"}, {"owner": {"reputation": 5, "user_id": 5780497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a87a8588d6e26b4a236ea0e5ddc5441?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Q", "link": "https://stackoverflow.com/users/5780497/aaron-q"}, "reply_to_user": {"reputation": 409, "user_id": 3513665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RvMjj.jpg?s=128&g=1", "display_name": "Carldmitch", "link": "https://stackoverflow.com/users/3513665/carldmitch"}, "edited": false, "score": 0, "creation_date": 1453313061, "post_id": 34904021, "comment_id": 57550627, "body": "@Carldmitch Thanks so much this is exactly what I needed to fix my issue."}], "answers": [{"tags": [], "owner": {"reputation": 5371, "user_id": 1637033, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/660d1eda425be1315c219ef2afb99c41?s=128&d=identicon&r=PG", "display_name": "mango", "link": "https://stackoverflow.com/users/1637033/mango"}, "is_accepted": false, "score": 0, "last_activity_date": 1453304016, "creation_date": 1453304016, "answer_id": 34904173, "question_id": 34904021, "link": "https://stackoverflow.com/questions/34904021/access-a-specific-dropdown/34904173#34904173", "title": "Access a specific dropdown", "body": "<p>Something like below should help:</p>\n\n<pre><code>select_list = $browser.select_list(class: 'help')\n</code></pre>\n\n<p>Then if you wanted something like, say the text, you could do:</p>\n\n<pre><code>select_list.options(&amp;:text)\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5780497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a87a8588d6e26b4a236ea0e5ddc5441?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Q", "link": "https://stackoverflow.com/users/5780497/aaron-q"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453337653, "creation_date": 1453303669, "last_edit_date": 1453337653, "question_id": 34904021, "link": "https://stackoverflow.com/questions/34904021/access-a-specific-dropdown", "title": "Access a specific dropdown", "body": "<p>I am writing Ruby/watir scripts. I've come across a dropdown that appears as italic text that covers up important options. How do I get my scripts to recognize and click this dropdown.  I've tried looking for the specific text and that hasn't worked otherwise I don't see any specific identifying values that I can grab onto.</p>\n\n<p>The HTML of the dropdown inside the div is listed below. </p>\n\n<p><code>&lt;span class=\"help\"&gt;&lt;a aria-controls=\"options\" aria-expanded=\"false\"  href=\"#options\" data-toggle=\"collapse\" class=\"collapsed\"&gt; Click to view available options. &lt;/a&gt;&lt;/span&gt;</code></p>\n"}, {"tags": ["javascript", "ruby", "selenium", "webdriver"], "answers": [{"tags": [], "owner": {"reputation": 3627, "user_id": 4856814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e9c9bf7a42b967f439b4a0b58716e34?s=128&d=identicon&r=PG&f=1", "display_name": "murali selenium", "link": "https://stackoverflow.com/users/4856814/murali-selenium"}, "is_accepted": false, "score": 0, "last_activity_date": 1453308646, "creation_date": 1453308646, "answer_id": 34905833, "question_id": 34904020, "link": "https://stackoverflow.com/questions/34904020/ruby-webdriver-get-all-data-values-from-elements-in-page/34905833#34905833", "title": "Ruby Webdriver. Get all &#39;data&#39; values from elements in page", "body": "<p>to get data of all web elements having same class, below is the script in Java, i hope it will helps you to build in Ruby</p>\n\n<pre><code>//collect all the web elements having the class logo\n    List&lt;WebElement&gt; data=driver.findElements(By.className(\"logo\"));\n\n    //to get data-channel of each element\n    for(int i=0; i&lt;data.size(); i++){\n\n        //printing the data-channel value\n        System.out.println(data.get(i).getAttribute(\"data-channel\"));\n    }\n</code></pre>\n\n<p>Thank You,\nMurali</p>\n"}, {"comments": [{"owner": {"reputation": 189, "user_id": 4929164, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh4.googleusercontent.com/-at8wSkzK6tk/AAAAAAAAAAI/AAAAAAAAMX0/QQEIXzI3mNc/photo.jpg?sz=128", "display_name": "Lea Chescotta", "link": "https://stackoverflow.com/users/4929164/lea-chescotta"}, "edited": false, "score": 0, "creation_date": 1453389139, "post_id": 34910140, "comment_id": 57588113, "body": "Sadly we don&#39;t use Watir, so im getting the error &quot;undefined method `attribute_value&#39; for #&lt;Selenium::WebDriver::Element:0x00000001c5ec10&gt;&quot;"}], "tags": [], "owner": {"reputation": 32896, "user_id": 1276506, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7149d2bc15314277ac69357ef7251650?s=128&d=identicon&r=PG", "display_name": "boulder_ruby", "link": "https://stackoverflow.com/users/1276506/boulder-ruby"}, "is_accepted": false, "score": 0, "last_activity_date": 1453322676, "creation_date": 1453322676, "answer_id": 34910140, "question_id": 34904020, "link": "https://stackoverflow.com/questions/34904020/ruby-webdriver-get-all-data-values-from-elements-in-page/34910140#34910140", "title": "Ruby Webdriver. Get all &#39;data&#39; values from elements in page", "body": "<p>It would be helpful to have some html to test this on, but I'll take a crack at it. First of all, I'm assuming you're only looking for the values of the values of the \"data-channel\" attribute and not some other \"data-*\" element. That would require a bit more footwork I think.</p>\n\n<pre><code>require 'watir-webdriver'\nb = Watir::Browser.new\n#...\nb.divs(:class =&gt; \"logo\").each do |div|\n  puts div.attribute_value(\"data-channel\")\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 189, "user_id": 4929164, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh4.googleusercontent.com/-at8wSkzK6tk/AAAAAAAAAAI/AAAAAAAAMX0/QQEIXzI3mNc/photo.jpg?sz=128", "display_name": "Lea Chescotta", "link": "https://stackoverflow.com/users/4929164/lea-chescotta"}, "is_accepted": true, "score": 0, "last_activity_date": 1489151745, "creation_date": 1489151745, "answer_id": 42719320, "question_id": 34904020, "link": "https://stackoverflow.com/questions/34904020/ruby-webdriver-get-all-data-values-from-elements-in-page/42719320#42719320", "title": "Ruby Webdriver. Get all &#39;data&#39; values from elements in page", "body": "<p>After a lot of research, and book reading, i found the solution:</p>\n\n<p>Here's a list of examples:</p>\n\n<pre><code>driver.find_element(:link_text, \"element\")[\"href\"])\ndriver.find_element(:link_text, \"element\")[\"id\"])\ndriver.find_element(:id, \"element\").text\ndriver.find_element(:id, \"element\").tag_name\ndriver.find_element(:id, \"element\").attribute(\"data-id\")\ndriver.find_element(:id, \"element\")[\"style\"]\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 4929164, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh4.googleusercontent.com/-at8wSkzK6tk/AAAAAAAAAAI/AAAAAAAAMX0/QQEIXzI3mNc/photo.jpg?sz=128", "display_name": "Lea Chescotta", "link": "https://stackoverflow.com/users/4929164/lea-chescotta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 717, "favorite_count": 0, "accepted_answer_id": 42719320, "answer_count": 3, "score": 0, "last_activity_date": 1489151745, "creation_date": 1453303669, "question_id": 34904020, "link": "https://stackoverflow.com/questions/34904020/ruby-webdriver-get-all-data-values-from-elements-in-page", "title": "Ruby Webdriver. Get all &#39;data&#39; values from elements in page", "body": "<p>For one html site. I need to get all \"data\" attribute values for elements with the same class. Those elements have all the same class with different \"data\" values.</p>\n\n<pre><code>div class=\"logo\" data-channel=\"1\"\n</code></pre>\n\n<p>where data-channel=\"N\" is the value I need so i can build a different URL to navigate to it.</p>\n\n<p>I tried a couple of ways to do it without success:\n-First I tried to get the \"data\" values as I always do with href and title attributes:</p>\n\n<pre><code>filtros = @driver.find_elements(:class, \"logo\")\nchannels_data = []\nfiltros.each {|f|\n    channels_data += [ f[:data] ]\n}\nchannels_data.each {|f|\n    puts \"data: \" + f\n}\n</code></pre>\n\n<p>But I get the following error:</p>\n\n<pre><code>Failures:\n\n  1) itv_personalvideo Should test the channels\n     Failure/Error: puts \"data: \" + f\n     TypeError:\n       no implicit conversion of nil into String\n     # ./spec/2.2/_web_itv_pc_personalvideo.rb:149:in `+'\n     # ./spec/2.2/_web_itv_pc_personalvideo.rb:149:in `block (3 levels) in &lt;top (required)&gt;'\n     # ./spec/2.2/_web_itv_pc_personalvideo.rb:148:in `each'\n     # ./spec/2.2/_web_itv_pc_personalvideo.rb:148:in `block (2 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>-Second I tried running javascript code directly as I already have in other test cases:</p>\n\n<pre><code>js_element = @driver.execute_script(\"document.querySelectorAll('.logo')[13].dataset.channel;\")\nputs js_element\n</code></pre>\n\n<p>But I had another error:</p>\n\n<pre><code>Failures:\n\n  1) itv_personalvideo Should test the channels\n     Failure/Error: js_element = @driver.execute_script(\"document.querySelectorAll('.logo')[13].dataset.channel;\")\n     Selenium::WebDriver::Error::UnknownError:\n       unknown error: Cannot read property 'dataset' of undefined\n         (Session info: chrome=47.0.2526.111)\n         (Driver info: chromedriver=2.20.353124 (035346203162d32c80f1dce587c8154a1efa0c3b),platform=Linux 3.16.0-4-amd64 x86_64)\n     # /home/usuario/.rvm/gems/ruby-2.2.1/gems/selenium-webdriver-2.47.1/lib/selenium/webdriver/remote/response.rb:71:in `assert_ok'\n     # /home/usuario/.rvm/gems/ruby-2.2.1/gems/selenium-webdriver-2.47.1/lib/selenium/webdriver/remote/response.rb:34:in `initialize'\n     # /home/usuario/.rvm/gems/ruby-2.2.1/gems/selenium-webdriver-2.47.1/lib/selenium/webdriver/remote/http/common.rb:78:in `new'\n     # /home/usuario/.rvm/gems/ruby-2.2.1/gems/selenium-webdriver-2.47.1/lib/selenium/webdriver/remote/http/common.rb:78:in `create_response'\n     # /home/usuario/.rvm/gems/ruby-2.2.1/gems/selenium-webdriver-2.47.1/lib/selenium/webdriver/remote/http/default.rb:90:in `request'\n     # /home/usuario/.rvm/gems/ruby-2.2.1/gems/selenium-webdriver-2.47.1/lib/selenium/webdriver/remote/http/common.rb:59:in `call'\n     # /home/usuario/.rvm/gems/ruby-2.2.1/gems/selenium-webdriver-2.47.1/lib/selenium/webdriver/remote/bridge.rb:657:in `raw_execute'\n     # /home/usuario/.rvm/gems/ruby-2.2.1/gems/selenium-webdriver-2.47.1/lib/selenium/webdriver/remote/bridge.rb:635:in `execute'\n     # /home/usuario/.rvm/gems/ruby-2.2.1/gems/selenium-webdriver-2.47.1/lib/selenium/webdriver/remote/bridge.rb:360:in `executeScript'\n     # /home/usuario/.rvm/gems/ruby-2.2.1/gems/selenium-webdriver-2.47.1/lib/selenium/webdriver/common/driver.rb:212:in `execute_script'\n     # ./spec/2.2/_web_itv_pc_personalvideo.rb:123:in `block (2 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>That surprised me because in the browser, that Javascript code gave me the number I need:</p>\n\n<pre><code>&gt; document.querySelectorAll('.logo')[13].dataset.channel;\n\"16\"\n</code></pre>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby", "ajax"], "comments": [{"owner": {"reputation": 2958, "user_id": 3597730, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d76b8f632aeb1d920d79d7dd5ab63097?s=128&d=identicon&r=PG", "display_name": "ruby_newbie", "link": "https://stackoverflow.com/users/3597730/ruby-newbie"}, "edited": false, "score": 0, "creation_date": 1453306841, "post_id": 34903841, "comment_id": 57546381, "body": "&quot;There are 2 links that need to update the information on the page without updating it.&quot;    what do you mean by this?"}, {"owner": {"reputation": 15, "user_id": 5453460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8fed8d1a5a56a92aecd271afcb5ea54?s=128&d=identicon&r=PG&f=1", "display_name": "M. Belousov", "link": "https://stackoverflow.com/users/5453460/m-belousov"}, "reply_to_user": {"reputation": 2958, "user_id": 3597730, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d76b8f632aeb1d920d79d7dd5ab63097?s=128&d=identicon&r=PG", "display_name": "ruby_newbie", "link": "https://stackoverflow.com/users/3597730/ruby-newbie"}, "edited": false, "score": 1, "creation_date": 1453368915, "post_id": 34903841, "comment_id": 57573890, "body": "I mean, I need to update the information on the page without refreshing the page. Sorry for my english."}], "owner": {"reputation": 15, "user_id": 5453460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8fed8d1a5a56a92aecd271afcb5ea54?s=128&d=identicon&r=PG&f=1", "display_name": "M. Belousov", "link": "https://stackoverflow.com/users/5453460/m-belousov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1453303161, "creation_date": 1453303161, "question_id": 34903841, "link": "https://stackoverflow.com/questions/34903841/how-to-make-remote-links-to-update-info-without-reloading-page", "title": "How to make remote links to update info without reloading page", "body": "<p>I have a problem .. There are 2 links that need to update the information on the page without updating it. I'm not good at JavaScript and tried many solutions, but it does not work ..\nIn general, I have a button \"Add item to cart\" and toolbar displayed on top that shows number of items in the cart and the total value.\nParametes from cart are stored in session[:cart], like \ncart={product_id => quantity, product_id => quantity}.</p>\n\n<p>When i click \"Add item to cart\" i need to update information on upper toolbar without updating page.\nI have something like:</p>\n\n<pre><code>&lt;%= link_to 'Add to cart', \"/cart/#{product.id}\", type: \"submit\",\n                      class: \"single_add_to_cart_button button alt\", remote: true %&gt;\n\n$('.single_add_to_cart_button').bind('ajax:complete', function() {\n                    $('#frontend-toolbar').text(\"&lt;%= cart_info_quantity %&gt;\");\n                });\n</code></pre>\n\n<p>But it doesn't work..</p>\n\n<p>At the same time i have modal window that show products from cart and 'Remove' button, that removes one item. </p>\n\n<pre><code>&lt;%= link_to 'Remove', \"/cart/remove/#{product.id}\", class: 'link-delete', remote: true %&gt;\n</code></pre>\n\n<p>I have tried this function:</p>\n\n<pre><code> $('.link-delete').bind('ajax:complete', function() {\n                    document.getElementById(\"productt\").style.display = 'none';\n                });\n</code></pre>\n\n<p>But it doesn't update info in my cart, so i should reload page..</p>\n\n<p>cart_info_quantity method: </p>\n\n<pre><code>def cart_info_quantity\nif session[:cart]\n  @quantity = 0\n  @cart = session[:cart]\n  @cart.each do |id, quantity|\n    @quantity += quantity\n  end\n  return @quantity\nelse\n  return 0\nend\n</code></pre>\n\n<p>The same method for total price:</p>\n\n<pre><code>def cart_info_total\nif session[:cart]\n  @total = 0\n  @cart = session[:cart]\n  @cart.each do |id, quantity|\n    @total += quantity * Product.find_by_id(id).price\n  end\n  return @total\nelse\n  return 0\nend\n</code></pre>\n\n<p>And method for all products from cart to display them in modal window:</p>\n\n<pre><code>def cart_products\nif session[:cart]\n  products = Hash.new\n  @cart = session[:cart]\n  @cart.each do |id, quantity|\n    products[Product.find_by_id(id)] = quantity\n  end\n  return products\nelse\n  return nil\nend\n</code></pre>\n\n<p>Help me please, because I cant make it for a long time.. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 680, "user_id": 4307225, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/071751491d3587fff6acc61e7e92668a?s=128&d=identicon&r=PG&f=1", "display_name": "baron816", "link": "https://stackoverflow.com/users/4307225/baron816"}, "edited": false, "score": 0, "creation_date": 1453303122, "post_id": 34903617, "comment_id": 57543608, "body": "Have you tried griddler: <a href=\"https://github.com/thoughtbot/griddler\" rel=\"nofollow noreferrer\">github.com/thoughtbot/griddler</a> ?"}], "answers": [{"comments": [{"owner": {"reputation": 637, "user_id": 874862, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/28be3be213eeed3f66e0a20f1e20c7ac?s=128&d=identicon&r=PG", "display_name": "Remco", "link": "https://stackoverflow.com/users/874862/remco"}, "edited": false, "score": 0, "creation_date": 1453304674, "post_id": 34903881, "comment_id": 57544771, "body": "thanks..don&#39;t really understand you&#39;re answer. We send a email from our crm with sender: support@support.com. The the customer replyes on this email. How can we recognize the replyed email so we can related it to the initial email ? So we can build a email dialog"}, {"owner": {"reputation": 9737, "user_id": 2422778, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aUihh.jpg?s=128&g=1", "display_name": "Mike Szyndel", "link": "https://stackoverflow.com/users/2422778/mike-szyndel"}, "reply_to_user": {"reputation": 637, "user_id": 874862, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/28be3be213eeed3f66e0a20f1e20c7ac?s=128&d=identicon&r=PG", "display_name": "Remco", "link": "https://stackoverflow.com/users/874862/remco"}, "edited": false, "score": 0, "creation_date": 1453307414, "post_id": 34903881, "comment_id": 57546824, "body": "When you send the initial email from CRM you should get and save the message-id I mentioned. This way when I customer replies you can find the original message-id in their response in the header field <code>In-Reply-To</code>. Sorry if the ID&#39;s don&#39;t make sense, I had to scramble them a little!"}, {"owner": {"reputation": 9737, "user_id": 2422778, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aUihh.jpg?s=128&g=1", "display_name": "Mike Szyndel", "link": "https://stackoverflow.com/users/2422778/mike-szyndel"}, "reply_to_user": {"reputation": 637, "user_id": 874862, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/28be3be213eeed3f66e0a20f1e20c7ac?s=128&d=identicon&r=PG", "display_name": "Remco", "link": "https://stackoverflow.com/users/874862/remco"}, "edited": false, "score": 0, "creation_date": 1453366325, "post_id": 34903881, "comment_id": 57572283, "body": "@Remco Please let me know if you end up using this solution! :)"}, {"owner": {"reputation": 637, "user_id": 874862, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/28be3be213eeed3f66e0a20f1e20c7ac?s=128&d=identicon&r=PG", "display_name": "Remco", "link": "https://stackoverflow.com/users/874862/remco"}, "edited": false, "score": 0, "creation_date": 1453497453, "post_id": 34903881, "comment_id": 57643739, "body": "discussing with our main developer. I let you know!"}], "tags": [], "owner": {"reputation": 9737, "user_id": 2422778, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aUihh.jpg?s=128&g=1", "display_name": "Mike Szyndel", "link": "https://stackoverflow.com/users/2422778/mike-szyndel"}, "is_accepted": false, "score": 2, "last_activity_date": 1453304049, "last_edit_date": 1453304049, "creation_date": 1453303268, "answer_id": 34903881, "question_id": 34903617, "link": "https://stackoverflow.com/questions/34903617/send-and-receive-email-by-rails-app/34903881#34903881", "title": "Send and receive email by Rails App", "body": "<p>In your email client open a reply from someone and show full headers or raw source (how to get it depends on the client but you will find it!)</p>\n\n<p>When you look at the email headers you will find <code>References</code> field</p>\n\n<pre><code>References: &lt;CAAC3oDjZSFywS5mpAANO+svm-3xXwLciUhw_QEkBkNqT9A@mail.com&gt;\n            &lt;06AFEF94-53D2-4469-59B0A494830C@mail.de&gt;\n            &lt;E67E3945-D61E-8E45-63C52D111698@mail.net&gt;\n</code></pre>\n\n<p>And more importantly</p>\n\n<pre><code>In-Reply-To: &lt;6397034C-90CA-41B4-F47AE3F39E76@mail.de&gt;\n</code></pre>\n\n<p>While every outgoing email has a <code>Message-ID</code> field</p>\n\n<pre><code>Message-ID: &lt;569F22.8060202@mail.de&gt;\n</code></pre>\n\n<p>To get an if of you outgoing message</p>\n\n<pre><code>result = SomeMailer.message(params).deliver\nresult.header['Message-ID'].value\n</code></pre>\n"}], "owner": {"reputation": 637, "user_id": 874862, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/28be3be213eeed3f66e0a20f1e20c7ac?s=128&d=identicon&r=PG", "display_name": "Remco", "link": "https://stackoverflow.com/users/874862/remco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1453304049, "creation_date": 1453302542, "question_id": 34903617, "link": "https://stackoverflow.com/questions/34903617/send-and-receive-email-by-rails-app", "title": "Send and receive email by Rails App", "body": "<p>We have build custom crm app(rails 4.0).  One of the features that we have build is that we send emails to our customers based on booking status or we send a custom email by our travel agents. </p>\n\n<p>The next thing we want is that customers can replt on this email.  So we can recognize the email thats replyed and related to the initial email is send, so we have a nice email dialog (send/receive) in the crm. </p>\n\n<p>Someone ideas how we can \"recognize\" the replyed email so we can related it to the right email? </p>\n\n<p>Thanks..remco</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "perl", "httprequest", "user-agent"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1453304065, "post_id": 34903585, "comment_id": 57544308, "body": "Please edit your question to include the Ruby code you&#39;ve written so far."}, {"owner": {"reputation": 3795, "user_id": 4926817, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/0lH0y.png?s=128&g=1", "display_name": "Noam Hacker", "link": "https://stackoverflow.com/users/4926817/noam-hacker"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1453304603, "post_id": 34903585, "comment_id": 57544716, "body": "@Jordan I have added ruby code and bolded the part I&#39;m unsure about"}], "answers": [{"tags": [], "owner": {"reputation": 121105, "user_id": 2766176, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/edd8638efe875601bfe394a8aea5b16d?s=128&d=identicon&r=PG", "display_name": "brian d foy", "link": "https://stackoverflow.com/users/2766176/brian-d-foy"}, "is_accepted": true, "score": 5, "last_activity_date": 1453337113, "last_edit_date": 1453337113, "creation_date": 1453305690, "answer_id": 34904759, "question_id": 34903585, "link": "https://stackoverflow.com/questions/34903585/converting-an-lwpuseragent-from-perl-to-ruby/34904759#34904759", "title": "Converting an LWP::UserAgent from Perl to Ruby", "body": "<p>Your Perl example does not show you setting the User-Agent header (using the <code>agent</code> method). That's the header that identifies the software performing the transaction. You are adding Basic Auth credentials in the Perl example, which is how the user demonstrates they are allowed to access the resource. They are completely different things.</p>\n\n<p>When you <code>print $ua</code>, you are seeing the memory address of the object, like <code>LWP::UserAgent=HASH(0x7fa9db00b1b0)</code>.</p>\n\n<p>If you want to set the User-Agent string in the Ruby example, fill in the string you want.</p>\n\n<p>If you want to supply the username and password for Basic Authorization, see the example in the <a href=\"http://ruby-doc.org/stdlib-2.3.0/libdoc/net/http/rdoc/Net/HTTP.html\" rel=\"nofollow\">Net::HTTP docs</a>:</p>\n\n<pre><code>uri = URI('http://example.com/index.html?key=value')\n\nreq = Net::HTTP::Get.new(uri)\nreq.basic_auth 'user', 'pass'\n\nres = Net::HTTP.start(uri.hostname, uri.port) {|http|\n  http.request(req)\n}\nputs res.body\n</code></pre>\n"}], "owner": {"reputation": 3795, "user_id": 4926817, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/0lH0y.png?s=128&g=1", "display_name": "Noam Hacker", "link": "https://stackoverflow.com/users/4926817/noam-hacker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 2, "accepted_answer_id": 34904759, "answer_count": 1, "score": 0, "last_activity_date": 1453337113, "creation_date": 1453302433, "last_edit_date": 1453304556, "question_id": 34903585, "link": "https://stackoverflow.com/questions/34903585/converting-an-lwpuseragent-from-perl-to-ruby", "title": "Converting an LWP::UserAgent from Perl to Ruby", "body": "<p>I am trying to add a <code>User-Agent</code> to the header in my HTTP request (in Ruby), but am unsure of the format of the user-agent string. here is how it is defined in Perl:</p>\n\n<pre><code>use LWP::UserAgent;\nmy $ua = new LWP::UserAgent(keep_alive=&gt;1);\n$ua-&gt;credentials($netloc, '', \"$user\", \"$pwd\");\n</code></pre>\n\n<p>If I try to <code>print $ua;</code>, I get a hash which changes every time. I believe that in Ruby I should have the credentials embedded into a single string. How can I know how to format this string? Or, How can I successfully print the contents of <code>$ua</code> in Perl?</p>\n\n<p>Ruby code:</p>\n\n<p><code>http = Net::HTTP.new(\"your.site.com\", 80)\nreq = Net::HTTP::Get.new(\"/path/to/the/page.html\", {'User-Agent' =&gt; '</code><strong>your_agent_here</strong><code>'})\nresponse = http.request(req)</code></p>\n"}, {"tags": ["ruby", "active-directory"], "answers": [{"tags": [], "owner": {"reputation": 871, "user_id": 18217, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rqiiz.jpg?s=128&g=1", "display_name": "Kenny Mann", "link": "https://stackoverflow.com/users/18217/kenny-mann"}, "is_accepted": false, "score": 0, "last_activity_date": 1453331322, "last_edit_date": 1495540757, "creation_date": 1453331322, "answer_id": 34912399, "question_id": 34903552, "link": "https://stackoverflow.com/questions/34903552/active-directory-gem-for-ruby-with-objectguid-support/34912399#34912399", "title": "Active Directory gem for Ruby with ObjectGUID Support", "body": "<p>It appears there isn't an up to date library that Contains Everything(TM) but since ObjectGuid uses UUIDv4 there <em>are</em> tools to handle that specifically.</p>\n\n<pre><code>UUIDTools::UUID.parse_raw(value)\n</code></pre>\n\n<p>returns the correct information I seek in an easily storable and readable format. The gem is called 'uuidtools'.</p>\n\n<p>As it turns out I can just store them as blobs: <a href=\"https://stackoverflow.com/questions/17277735/using-uuids-in-sqlite\">Using UUIDs in SQLite</a></p>\n\n<p>and search using the same blobs given to me from my AD box. I can use the UUIDTools to make it human readable (for whatever reason, if I so desired -- but I'm starting to question what the point of that is now other than perhaps using it as a Primary Key).</p>\n\n<p>I can do a search by using \"objectGUID\" (that was given to me earlier in raw format) itself without worrying about <em>how it looks</em>.</p>\n"}], "owner": {"reputation": 871, "user_id": 18217, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rqiiz.jpg?s=128&g=1", "display_name": "Kenny Mann", "link": "https://stackoverflow.com/users/18217/kenny-mann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 313, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1453331322, "creation_date": 1453302321, "question_id": 34903552, "link": "https://stackoverflow.com/questions/34903552/active-directory-gem-for-ruby-with-objectguid-support", "title": "Active Directory gem for Ruby with ObjectGUID Support", "body": "<p>I've searched high and low (rubygems.org, for instance) and can not find any up to date AD gems. I'm wanted ObjectGUID because it's a unique identifier in a system I'm using.\nHere is the code I'm running at the moment:</p>\n\n<pre><code>require 'rubygems'\nrequire 'net/ldap'\n\ndef get_sid_string(data)\n  sid = []\n  sid &lt;&lt; data[0].to_s\n\n  rid = \"\"\n  (6).downto(1) do |i|\n    rid += byte2hex(data[i,1][0])\n  end\n  sid &lt;&lt; rid.to_i.to_s\n\n  sid += data.unpack(\"bbbbbbbbV*\")[8..-1]\n  \"S-\" + sid.join('-')\nend\n\ndef byte2hex(b)\n  ret = '%x' % (b.to_i &amp; 0xff)\n  ret = '0' + ret if ret.length &lt; 2\n  ret\nend\n\nldap = Net::LDAP.new :host =&gt; \"192.168.55.55\",\n    :port =&gt; 389,\n    :auth =&gt; {\n        :method =&gt; :simple,\n        :username =&gt; \"adam@foo.local\",\n        :password =&gt; \"secret\"\n    }\n\nfilter = Net::LDAP::Filter.eq( \"cn\", \"Adam*\" )\ntreebase = \"dc=foo,dc=local\"\n\nldap.search( :base =&gt; treebase, :filter =&gt; filter ) do |entry|\n  puts \"DN: #{entry.dn}\"\n  entry.each do |attribute, values|\n  next if attribute.to_s != \"objectguid\"\n    puts \"   #{attribute}:\"\n    values.each do |value|\n      puts \"      ---&gt;#{value.bytes}\"\n      puts \"      ---&gt;#{value}\"\n    end\n        puts \"      ---&gt;#{get_sid_string(attribute.to_s)}\"\n  end\nend\n</code></pre>\n\n<p>And here are the results:</p>\n\n<pre><code>DN: CN=Adam West,CN=Users,DC=foo,DC=local\n   objectguid:\n      ---&gt;[123, 94, 255, 162, 248, 97, 61, 65, 148, 210, 111, 76, 49, 58, 241, 208]\n      ---&gt;{^\ufffd\ufffd\ufffda=A\ufffd\ufffdoL1:\ufffd\ufffd\n      ---&gt;S-o-0\n</code></pre>\n\n<p>The first line, of course, is the bytes. The second is just the array dumped out. The third is a bit of code I found that doesn't seem completed.\nBefore I begin work on writing my own AD gem (or branching another one), I was wondering if anyone knows of anything that's being currently maintained?\nI've gone through several of them but none of them seem to either not handle the ObjectGUID at all cleanly or don't work reliably (I'm looking at you active_directory).\nSo why is ObjectGUID so important? Because if a merging where to happen it won't change. I could use the sAMAccountName but I'm not 100% certain it will never change in a large merging.</p>\n\n<p>My Goals (in case it matters or context will help):\n- Unique Identifier knowing it will never change.\n- The ability to search using said unique identifier.\n- Unique Identifier stored in a database for future pairings of related data not stored in AD (e.g. training reports).</p>\n\n<p>Has anyone accomplished this with Ruby? Or perhaps know of a gem? Ideally I'd like a gem that handles this all for me but I know not where to ask.</p>\n\n<p>Perhaps I'm making this more complicated than I should and just store the converted bytes to ints as in array in my database?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 352974, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cd70e093c1713f38f356c57452b30a54?s=128&d=identicon&r=PG", "display_name": "user352974", "link": "https://stackoverflow.com/users/352974/user352974"}, "edited": false, "score": 0, "creation_date": 1453305721, "post_id": 34903463, "comment_id": 57545556, "body": "yes i have put index.html.erb file in views/ home ..i even tried renaming file  and then making changes in methods and routes.. but its still not able to connect to views..not able to understand what the problem is"}], "tags": [], "owner": {"reputation": 216, "user_id": 5799163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab113470543163bec5ebae1a679a4b2f?s=128&d=identicon&r=PG", "display_name": "Johnny Klironomos", "link": "https://stackoverflow.com/users/5799163/johnny-klironomos"}, "is_accepted": false, "score": 0, "last_activity_date": 1453302096, "creation_date": 1453302096, "answer_id": 34903463, "question_id": 34903220, "link": "https://stackoverflow.com/questions/34903220/index-html-erb-file-template-is-missing-error/34903463#34903463", "title": "index.html.erb file template is missing error", "body": "<p>I'm guessing, since you don't have any other errors that you do have a <code>home_controller</code>. </p>\n\n<p>So, the only thing missing is to put the <code>index.html.erb</code> into a <code>home</code> folder. (<code>app/views/home/index/html.erb</code>)</p>\n"}, {"tags": [], "owner": {"reputation": 197, "user_id": 352974, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cd70e093c1713f38f356c57452b30a54?s=128&d=identicon&r=PG", "display_name": "user352974", "link": "https://stackoverflow.com/users/352974/user352974"}, "is_accepted": false, "score": 0, "last_activity_date": 1453320364, "creation_date": 1453320364, "answer_id": 34909479, "question_id": 34903220, "link": "https://stackoverflow.com/questions/34903220/index-html-erb-file-template-is-missing-error/34909479#34909479", "title": "index.html.erb file template is missing error", "body": "<p>Changing 'application' to 'default' in line 5 and line 6 of layouts/application.html.erb solved my problem.</p>\n\n<p>this happens in windows</p>\n\n<p>thanks</p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 5285531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I3Lu2.jpg?s=128&g=1", "display_name": "MattwalOlaide", "link": "https://stackoverflow.com/users/5285531/mattwalolaide"}, "is_accepted": false, "score": 0, "last_activity_date": 1453376118, "creation_date": 1453376118, "answer_id": 34922734, "question_id": 34903220, "link": "https://stackoverflow.com/questions/34903220/index-html-erb-file-template-is-missing-error/34922734#34922734", "title": "index.html.erb file template is missing error", "body": "<p>I think you have an inconsistency in the controller class name and the corresponding folder name in your views directory. Maybe you have something like</p>\n\n<pre><code>HomesController or HomeController\n</code></pre>\n\n<p>and in the views directory, you have:</p>\n\n<pre><code>home or homes\n</code></pre>\n\n<p>as the case may be. It is also possible that you have a typo in the spelling of the index file.</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 6420875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbbcb56edd46b1c50c9d826c6cc07841?s=128&d=identicon&r=PG&f=1", "display_name": "Ernie Plez", "link": "https://stackoverflow.com/users/6420875/ernie-plez"}, "edited": false, "score": 0, "creation_date": 1464982406, "post_id": 37621443, "comment_id": 62726860, "body": "To user Laurel:  You can also score by editing a simple word in an answer? Like  the word &quot;Cheers!&quot;? Cool! I&#39;m new to S.O so I haven&#39;t gone through all the rules yet, would you please be so kind to explain why my word &quot;Cheers&quot; was inappropriate in my post? Thanks!"}], "tags": [], "owner": {"reputation": 21, "user_id": 6420875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbbcb56edd46b1c50c9d826c6cc07841?s=128&d=identicon&r=PG&f=1", "display_name": "Ernie Plez", "link": "https://stackoverflow.com/users/6420875/ernie-plez"}, "is_accepted": false, "score": 0, "last_activity_date": 1464980848, "last_edit_date": 1464980848, "creation_date": 1464979509, "answer_id": 37621443, "question_id": 34903220, "link": "https://stackoverflow.com/questions/34903220/index-html-erb-file-template-is-missing-error/37621443#37621443", "title": "index.html.erb file template is missing error", "body": "<p>If your are using Rails on Windows try the answer from user352974:\n (Changing 'application' to 'default' in line 5 and line 6 of layouts/application.html.erb )</p>\n\n<p>It totally works, besides that, on your browser address bar, try this url: <a href=\"http://localhost:3000/pages/home\" rel=\"nofollow\">http://localhost:3000/pages/home</a></p>\n\n<p>Where /pages/ is the folder that contains the page you want to show (that is, your index) and 'home' in my example is my index, which is located here: C:\\Sites\\YourProjectFolderName\\app\\views\\pages\\home.html.erb</p>\n"}], "owner": {"reputation": 197, "user_id": 352974, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cd70e093c1713f38f356c57452b30a54?s=128&d=identicon&r=PG", "display_name": "user352974", "link": "https://stackoverflow.com/users/352974/user352974"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 662, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1464980848, "creation_date": 1453301441, "last_edit_date": 1453302207, "question_id": 34903220, "link": "https://stackoverflow.com/questions/34903220/index-html-erb-file-template-is-missing-error", "title": "index.html.erb file template is missing error", "body": "<p>I have created an <code>index.html.erb</code> in <code>views</code> and also I have uncommented <code>root 'home#index'</code> in my routes and also there is no index file in public folder.</p>\n\n<p>I am still getting this error:</p>\n\n<pre><code>Missing template home/index with {:locale=&gt;[:en], :formats=&gt;[:html], :variants=&gt;[], :handlers=&gt;[:erb, :builder, :raw, :ruby, :coffee, :jbuilder]}.\nSearched in:\n  * \"C:/ruby/rails/myrubyblog/app/views\"\n  * \"C:/ruby/rails/myrubyblog\"\n  * \"C:/\"\n</code></pre>\n\n<p>Rails.root: C:/ruby/rails/myrubyblog</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 9737, "user_id": 2422778, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aUihh.jpg?s=128&g=1", "display_name": "Mike Szyndel", "link": "https://stackoverflow.com/users/2422778/mike-szyndel"}, "edited": false, "score": 0, "creation_date": 1453301656, "post_id": 34903033, "comment_id": 57542521, "body": "Do you load relationships with the user model? Why do you remove relationships through <code>relationships.each { |relationship| relationship.destroy }</code> instead of <code>@user.relationships.destroy_all</code> (they do exactly the same!)"}, {"owner": {"reputation": 2754, "user_id": 4499505, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2d1e61c81e3933b4ff09de01b9ff81d4?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4499505/nick"}, "reply_to_user": {"reputation": 9737, "user_id": 2422778, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aUihh.jpg?s=128&g=1", "display_name": "Mike Szyndel", "link": "https://stackoverflow.com/users/2422778/mike-szyndel"}, "edited": false, "score": 0, "creation_date": 1453301840, "post_id": 34903033, "comment_id": 57542648, "body": "I&#39;m pretty new to programming; the only reason was I didn&#39;t know of <code>destroy_all</code> its existence. So I&#39;ve now replaced the current code as suggested. The error persisted though (all other tests still passed). Regarding your first question: I assume since the association is there, it automatically loads with the user model...?"}, {"owner": {"reputation": 9737, "user_id": 2422778, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aUihh.jpg?s=128&g=1", "display_name": "Mike Szyndel", "link": "https://stackoverflow.com/users/2422778/mike-szyndel"}, "edited": false, "score": 0, "creation_date": 1453302235, "post_id": 34903033, "comment_id": 57542956, "body": "Try <code>current_user.relationships.destroy_all</code> in controller"}, {"owner": {"reputation": 2754, "user_id": 4499505, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2d1e61c81e3933b4ff09de01b9ff81d4?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4499505/nick"}, "reply_to_user": {"reputation": 9737, "user_id": 2422778, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aUihh.jpg?s=128&g=1", "display_name": "Mike Szyndel", "link": "https://stackoverflow.com/users/2422778/mike-szyndel"}, "edited": false, "score": 0, "creation_date": 1453302534, "post_id": 34903033, "comment_id": 57543176, "body": "I&#39;m now using <code>@user.relationships.destroy_all if @user.relationships.any?</code>. (also tried it without the <code>if</code> part but that made no difference for the error) I&#39;m using <code>@user</code> because in the code I have a before_action that defines <code>@user</code>, which is not necessarily equal to <code>current_user</code>. Just changed the syntax a bit in my OP to make my post shorter."}, {"owner": {"reputation": 9737, "user_id": 2422778, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aUihh.jpg?s=128&g=1", "display_name": "Mike Szyndel", "link": "https://stackoverflow.com/users/2422778/mike-szyndel"}, "edited": false, "score": 0, "creation_date": 1453302927, "post_id": 34903033, "comment_id": 57543464, "body": "1. There is no reason to do <code>if @user.relationships.any?</code> because if there are none, none will be removed. 2. <code>current_user</code> is a helper I guess so it&#39;s available in all other helpers, no need to pass it around! 3. If you assign <code>@user = current_user</code> then it&#39;s nothing else than current_user for sure. If you&#39;re closing other user than current then I don&#39;t understand why you log them out. 4. Please add any scopes and callbacks you have on user model to the question 5. And most important - seems you try to implement login yourself, it&#39;s a very bad idea. Use devise gem!"}], "answers": [{"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1453308769, "post_id": 34905725, "comment_id": 57547759, "body": "As a side comment - its fine to try to do an authentication solution yourself as an experiment when learning but if you intend to actually use the app on the wild webs you should instead use a tried and true authentication solution like Devise or at least Warden. Doing authentication right is one of the hardest things to get right as a programmer and most hacks are due to home rolled auth solutions."}, {"owner": {"reputation": 2754, "user_id": 4499505, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2d1e61c81e3933b4ff09de01b9ff81d4?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4499505/nick"}, "edited": false, "score": 0, "creation_date": 1453310691, "post_id": 34905725, "comment_id": 57549048, "body": "Great, thanks max for the clear explanation. The thing is though that after replacing it with <code>destroy_all</code>, the same error is still there."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 2754, "user_id": 4499505, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2d1e61c81e3933b4ff09de01b9ff81d4?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4499505/nick"}, "edited": false, "score": 0, "creation_date": 1453311445, "post_id": 34905725, "comment_id": 57549543, "body": "Ah, I was a bit ensure if <code>.destroy_all</code> updates the <code>User</code> object - this confirms that it does not. It might be prudent in this case to use <code>.reload</code> to make sure the object in memory is synced with its database representation."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 1, "last_activity_date": 1453311474, "last_edit_date": 1453311474, "creation_date": 1453308344, "answer_id": 34905725, "question_id": 34903033, "link": "https://stackoverflow.com/questions/34903033/strange-behavior-reload-necessary-to-close-an-account/34905725#34905725", "title": "Strange behavior: reload necessary to close an account", "body": "<p>Trying to remove the cookies and/or values stored in session is a flawed approach. Instead you should be using <a href=\"http://guides.rubyonrails.org/security.html#session-fixation-countermeasures\" rel=\"nofollow\"><code>reset_session</code></a> - it invalidates the current session identifier and issues a new one.</p>\n\n<pre><code>def log_out         # In sessions helper\n  reset_session\n  @current_user = nil\nend\n</code></pre>\n\n<p>So that even if the user still has a cookie pointing to their previous session Rails will not load the session.</p>\n\n<h1>In memory vs in database.</h1>\n\n<pre><code>@user = current_user\nrelationships = @user.relationships\nrelationships.each { |relationship| relationship.destroy }\n</code></pre>\n\n<p>Note that in this code you are storing an <code>User</code> object in <code>@user</code> and a <code>ActiveRecord::Relation</code> object in <code>relationships</code> - these are both stored in the servers memory. When you iterate through <code>relationships</code> and destroy each you are not updating the values stored in memory in <code>@user</code>. Thats why <code>.reload</code> is needed - it refreshes the stale <code>@user</code> object with the representation from the database.</p>\n\n<p>Instead you should use <code>destroy_all</code> as pointed out as it produces a more effective database query and uses less memory than iterating through each item.</p>\n\n<pre><code>def closing         # Controller method\n  @user = current_user\n  @user.relationships.destroy_all\n  @user = @user.reload\nend\n</code></pre>\n"}], "owner": {"reputation": 2754, "user_id": 4499505, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2d1e61c81e3933b4ff09de01b9ff81d4?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4499505/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 1, "accepted_answer_id": 34905725, "answer_count": 1, "score": 0, "last_activity_date": 1453311474, "creation_date": 1453300903, "last_edit_date": 1453301602, "question_id": 34903033, "link": "https://stackoverflow.com/questions/34903033/strange-behavior-reload-necessary-to-close-an-account", "title": "Strange behavior: reload necessary to close an account", "body": "<p>For deactivating an account I have a method similar to this:</p>\n\n<pre><code>def closing         # Controller method\n  @user = current_user\n  relationships = @user.relationships\n  relationships.each { |relationship| relationship.destroy }\n  log_out\nend\n\ndef log_out         # In sessions helper\n  forget(current_user)\n  session.delete(:user_id)\n  @current_user = nil\nend\n\ndef forget(user)    # In sessions helper\n  debugger\n  user.forget       # If I change this to user.reload.forget the error below is gone\n  cookies.delete(:user_id)\n  cookies.delete(:api_token)\nend\n\ndef forget          # In User table\n  update_attributes(remember_digest: nil, email_digest: nil)\nend\n</code></pre>\n\n<p>However, closing an account produces an error message for the line <code>user.forget</code>:</p>\n\n<blockquote>\n  <p>ActiveRecord::RecordNotFound: Couldn't find Relationship with\n  'id'=129095216 [WHERE \"relationships\".\"user_id\" = ?]</p>\n</blockquote>\n\n<p>See the location of <code>debugger</code> in the code above. I used the debugger to look at the values for <code>user</code>: the field <code>default_relationship_id</code> still has the value <code>129095216</code>. If I enter <code>user.reload</code> then the value of <code>default_relationship_id</code> is indeed <code>nil</code>. And indeed, rewriting that line in the sessions helper to <code>user.reload.forget</code> and everything works.</p>\n\n<p>However, reloading shouldn't be necessary. In fact in the past it used to work, I have been changing quite some code since but don't understand the behavior. There must be something wrong because reloading shouldn't be necessary. What to do? What is causing this behavior?</p>\n\n<hr>\n\n<p>More on the association (no changes were made to this code from the time the above error wasn't there):</p>\n\n<p>User model:</p>\n\n<pre><code>has_many   :relationships, dependent: :destroy, inverse_of: :user\nhas_many   :organizations, through: :relationships, inverse_of: :users\nbelongs_to :default_relationship, class_name: \"Relationship\", foreign_key: :default_relationship_id, inverse_of: :default_for_user\nhas_one    :default_organization, through: :default_relationship, source: :organization\n</code></pre>\n\n<p>Relationship model:</p>\n\n<pre><code>belongs_to :user,         :inverse_of =&gt; :relationships\nbelongs_to :organization, :inverse_of =&gt; :relationships\nhas_one    :default_for_user, class_name: \"User\", foreign_key: :default_relationship_id, inverse_of: :default_relationship, dependent: :nullify\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ajax", "ruby-on-rails-4", "devise"], "comments": [{"owner": {"reputation": 144, "user_id": 3882086, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NeS0F.jpg?s=128&g=1", "display_name": "Popescu Alexandru Constantin", "link": "https://stackoverflow.com/users/3882086/popescu-alexandru-constantin"}, "edited": false, "score": 0, "creation_date": 1453302048, "post_id": 34902983, "comment_id": 57542829, "body": "your file <code>create.js.html</code> should be called <code>create.js.erb</code>, try and let us know"}, {"owner": {"reputation": 25, "user_id": 5778019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6076c6cfd36a777278890dd68ebb3bde?s=128&d=identicon&r=PG&f=1", "display_name": "Rizwan Ansari", "link": "https://stackoverflow.com/users/5778019/rizwan-ansari"}, "reply_to_user": {"reputation": 144, "user_id": 3882086, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NeS0F.jpg?s=128&g=1", "display_name": "Popescu Alexandru Constantin", "link": "https://stackoverflow.com/users/3882086/popescu-alexandru-constantin"}, "edited": false, "score": 0, "creation_date": 1453302882, "post_id": 34902983, "comment_id": 57543423, "body": "sorry my mistake it is already <b>create.js.erb</b>"}, {"owner": {"reputation": 144, "user_id": 3882086, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NeS0F.jpg?s=128&g=1", "display_name": "Popescu Alexandru Constantin", "link": "https://stackoverflow.com/users/3882086/popescu-alexandru-constantin"}, "edited": false, "score": 0, "creation_date": 1453303881, "post_id": 34902983, "comment_id": 57544166, "body": "i don&#39;t think is a devise problem, perhaps it tries to respond with an html file while you want to run a script. To respond with js you have to write: <code>respond_to do |format| if @message = Message.create!(params[:message]) format.js end</code>"}, {"owner": {"reputation": 25, "user_id": 5778019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6076c6cfd36a777278890dd68ebb3bde?s=128&d=identicon&r=PG&f=1", "display_name": "Rizwan Ansari", "link": "https://stackoverflow.com/users/5778019/rizwan-ansari"}, "reply_to_user": {"reputation": 144, "user_id": 3882086, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NeS0F.jpg?s=128&g=1", "display_name": "Popescu Alexandru Constantin", "link": "https://stackoverflow.com/users/3882086/popescu-alexandru-constantin"}, "edited": false, "score": 0, "creation_date": 1453309994, "post_id": 34902983, "comment_id": 57548571, "body": "PopescuAlexandruConstantin  i chnged it as you suggested. &#39;      respond_to do |format| if @message = Message.create (params[:message]) format.js  end&#39; now i am getting <b>ActionController::UnknownFormat</b> error."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5778019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6076c6cfd36a777278890dd68ebb3bde?s=128&d=identicon&r=PG&f=1", "display_name": "Rizwan Ansari", "link": "https://stackoverflow.com/users/5778019/rizwan-ansari"}, "edited": false, "score": 0, "creation_date": 1453310290, "post_id": 34905826, "comment_id": 57548767, "body": "@Faian now getting error <b>ActionController::UnknownFormat</b>  after this change."}, {"owner": {"reputation": 591, "user_id": 1945702, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ZTLOC.png?s=128&g=1", "display_name": "Fabian de Pabian", "link": "https://stackoverflow.com/users/1945702/fabian-de-pabian"}, "reply_to_user": {"reputation": 25, "user_id": 5778019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6076c6cfd36a777278890dd68ebb3bde?s=128&d=identicon&r=PG&f=1", "display_name": "Rizwan Ansari", "link": "https://stackoverflow.com/users/5778019/rizwan-ansari"}, "edited": false, "score": 0, "creation_date": 1453321322, "post_id": 34905826, "comment_id": 57555175, "body": "Please try my first suggestion, add <code>respond_to :js, :html</code> as the first line inside your controller. This will take care of rendering your js templates when the response headers state javascript."}, {"owner": {"reputation": 25, "user_id": 5778019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6076c6cfd36a777278890dd68ebb3bde?s=128&d=identicon&r=PG&f=1", "display_name": "Rizwan Ansari", "link": "https://stackoverflow.com/users/5778019/rizwan-ansari"}, "edited": false, "score": 0, "creation_date": 1453322736, "post_id": 34905826, "comment_id": 57556015, "body": "thanks to getting back. I already had tried it but its not working. Any other suggestion please."}, {"owner": {"reputation": 591, "user_id": 1945702, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ZTLOC.png?s=128&g=1", "display_name": "Fabian de Pabian", "link": "https://stackoverflow.com/users/1945702/fabian-de-pabian"}, "reply_to_user": {"reputation": 25, "user_id": 5778019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6076c6cfd36a777278890dd68ebb3bde?s=128&d=identicon&r=PG&f=1", "display_name": "Rizwan Ansari", "link": "https://stackoverflow.com/users/5778019/rizwan-ansari"}, "edited": false, "score": 0, "creation_date": 1453329834, "post_id": 34905826, "comment_id": 57559738, "body": "can you please try to set the <code>url:</code> option in the form_for method and also pass the format as an option to the path method."}], "tags": [], "owner": {"reputation": 591, "user_id": 1945702, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ZTLOC.png?s=128&g=1", "display_name": "Fabian de Pabian", "link": "https://stackoverflow.com/users/1945702/fabian-de-pabian"}, "is_accepted": true, "score": 1, "last_activity_date": 1453308623, "creation_date": 1453308623, "answer_id": 34905826, "question_id": 34902983, "link": "https://stackoverflow.com/questions/34902983/rails-4-ajax-template-is-missing/34905826#34905826", "title": "Rails 4, Ajax Template is missing", "body": "<p>Define <code>respond_to :html, :js</code> at the top of your controller or do as @Popescu Alexandru Constantin said:</p>\n\n<pre><code>respond_to do |format|\n  format.js\n  format.html\nend\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5778019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6076c6cfd36a777278890dd68ebb3bde?s=128&d=identicon&r=PG&f=1", "display_name": "Rizwan Ansari", "link": "https://stackoverflow.com/users/5778019/rizwan-ansari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 744, "favorite_count": 0, "accepted_answer_id": 34905826, "answer_count": 1, "score": 0, "last_activity_date": 1453308623, "creation_date": 1453300742, "last_edit_date": 1453302971, "question_id": 34902983, "link": "https://stackoverflow.com/questions/34902983/rails-4-ajax-template-is-missing", "title": "Rails 4, Ajax Template is missing", "body": "<p>I am trying to add a simple message form with Ajax call for practice but getting an error about template is missing. Error shows that its devise (gem) related error. Error is </p>\n\n<p><strong>Missing template messages/create, application/create with {:locale=>[:en], :formats=>[:html], :variants=>[], :handlers=>[:erb, :builder, :raw, :ruby, :slim, :jbuilder]}. Searched in: * \n\"/home/.rvm/gems/ruby-2.2.2/gems/devise-3.5.4/app/views\"</strong> </p>\n\n<p>Code in <strong>messeges/index.html.erb</strong></p>\n\n<pre><code>&lt;h1&gt;Chat&lt;/h1&gt;\n\n&lt;ul id=\"chat\"&gt;\n  &lt;%= render @messages %&gt;\n&lt;/ul&gt;\n\n&lt;%= form_for Message.new, remote: true do |f| %&gt;\n\n    &lt;input name=\"authenticity_token\"\n           type=\"hidden\"\n           value=\"&lt;%= form_authenticity_token %&gt;\"/&gt;\n    &lt;%= f.text_field :subject, placeholder: \"Subject\" %&gt;\n    &lt;%= f.text_field :content %&gt;\n    &lt;%= f.submit \"Send\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>partial view is <strong>_message.html.erb</strong> </p>\n\n<pre><code>&lt;li&gt;\n  &lt;%= message.subject %&gt;: &lt;%= message.content %&gt;\n&lt;/li&gt;\n</code></pre>\n\n<p><strong>create.js.erb</strong>  </p>\n\n<pre><code>$('#chat').append(\"&lt; %=  j render(@message) %&gt;\");\n$(\"#message_content\").val('');\n</code></pre>\n\n<p>and create action in controller <strong>messages_controller.rb</strong> is</p>\n\n<pre><code>def create\n    @message = Message.create!(params[:message])\n     # respond_to do |format|\n     #   format.html\n     #   format.js { render 'create.js.erb' }\n     # end\n end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 73119, "user_id": 1143732, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mFUOI.jpg?s=128&g=1", "display_name": "Richard Peck", "link": "https://stackoverflow.com/users/1143732/richard-peck"}, "edited": false, "score": 0, "creation_date": 1453298214, "post_id": 34901997, "comment_id": 57539976, "body": "Are you sure the <code>CONSTANT</code> is available to the helper? Where is the constant declared?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1453298778, "post_id": 34901997, "comment_id": 57540409, "body": "try <code>produce_growing_methods.map {|x| [x[:id],x[:name]]}</code> because [0] and [1] will return nil. In a Hash the <code>[]</code> method is looking for an element by key and since you have no key <code>0</code> or <code>1</code> you will always get nil for this. the other option would be to make  <code>PRODUCE_GROWING_METHODS</code> a multi-dimensional array like <code>[[1,&#39;Conventional&#39;],[2,&#39;Organic&#39;]]</code> then you could pass it directly in as the collection like <code>collection: produce_growing_methods</code>"}, {"owner": {"reputation": 1333, "user_id": 2681579, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/6c96de0c80e6da121d7c256e33fe0863?s=128&d=identicon&r=PG&f=1", "display_name": "user2681579", "link": "https://stackoverflow.com/users/2681579/user2681579"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1453300537, "post_id": 34901997, "comment_id": 57541734, "body": "@engineersmnky You are correct. Please post this as answer."}], "answers": [{"comments": [{"owner": {"reputation": 1333, "user_id": 2681579, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/6c96de0c80e6da121d7c256e33fe0863?s=128&d=identicon&r=PG&f=1", "display_name": "user2681579", "link": "https://stackoverflow.com/users/2681579/user2681579"}, "edited": false, "score": 0, "creation_date": 1453311295, "post_id": 34902845, "comment_id": 57549452, "body": "Thanks for explanation!"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 3, "last_activity_date": 1453301398, "last_edit_date": 1453301398, "creation_date": 1453300369, "answer_id": 34902845, "question_id": 34901997, "link": "https://stackoverflow.com/questions/34901997/show-values-from-helper-method-in-drop-down/34902845#34902845", "title": "Show values from helper method in drop down", "body": "<p>You should map the hash by keys. In your case the keys are <code>:id</code> and <code>:name</code>:</p>\n\n<pre><code>produce_growing_methods.map { |x| [x[:id], x[:name]] }\n</code></pre>\n\n<p>In reality you are always better of using a generic solution rather then manual mapping.\nHere is a better way of achieving the same, but it will work as well for array of thousand hashes:</p>\n\n<pre><code>ary = [\n  {id: 1, name: 'Conventional'},\n  {id: 2, name: 'Organic'},\n]\nary.map(&amp;:values)\n#=&gt; [[1, \"Conventional\"], [2, \"Organic\"]]\n</code></pre>\n"}], "owner": {"reputation": 1333, "user_id": 2681579, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/6c96de0c80e6da121d7c256e33fe0863?s=128&d=identicon&r=PG&f=1", "display_name": "user2681579", "link": "https://stackoverflow.com/users/2681579/user2681579"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 1, "accepted_answer_id": 34902845, "answer_count": 1, "score": 2, "last_activity_date": 1453301657, "creation_date": 1453298152, "last_edit_date": 1453301657, "question_id": 34901997, "link": "https://stackoverflow.com/questions/34901997/show-values-from-helper-method-in-drop-down", "title": "Show values from helper method in drop down", "body": "<p>I am using a hash constant in my ROR application. I want to show the <code>names</code> from the hash constant to drop down.</p>\n\n<p>helper.rb</p>\n\n<pre><code>PRODUCE_GROWING_METHODS  = [\n    {id: 1, name: 'Conventional'},\n    {id: 2, name: 'Organic'},\n  ]\n\ndef produce_growing_methods\n    PRODUCE_GROWING_METHODS  \n  end\n</code></pre>\n\n<p>_produce.haml</p>\n\n<pre><code>= f.simple_fields_for :produce_details do |pd|\n  = pd.input :produce_growing_method, :collection =&gt; produce_growing_methods.collect { |x| [x[0], x[1]] }, :prompt =&gt; \"Select Growing Method\"\n</code></pre>\n\n<p>I tried as shown above in <code>_produce.haml</code> but i am getting the empty drop down. <code>Names</code> from the constant are not populated in drop down.</p>\n\n<p>Can any one help me how to show the <code>names</code> from the  <code>PRODUCE_GROWING_METHODS</code> hash constant to a drop down.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5045814"}, "edited": false, "score": 0, "creation_date": 1453298260, "post_id": 34901962, "comment_id": 57540021, "body": "Rails version: 4.2.5 Ruby version: 2.2.3-p173 (i386-mingw32) System: Windows 10"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5045814"}, "edited": false, "score": 0, "creation_date": 1453404957, "post_id": 34901962, "comment_id": 57598284, "body": "Up. actually can i do this?"}], "answers": [{"comments": [{"owner": {"reputation": 168, "user_id": 1976932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RSWmZ.jpg?s=128&g=1", "display_name": "nmeylan", "link": "https://stackoverflow.com/users/1976932/nmeylan"}, "edited": false, "score": 0, "creation_date": 1453299257, "post_id": 34902226, "comment_id": 57540747, "body": "What the output when you do <code>gem install mysql2 --platform=ruby\u200a --with-mysql-dir=&quot;C:\\mysql-connector-path&quot;</code> ? With the right mysql-connector-path"}, {"owner": {"reputation": 168, "user_id": 1976932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RSWmZ.jpg?s=128&g=1", "display_name": "nmeylan", "link": "https://stackoverflow.com/users/1976932/nmeylan"}, "edited": false, "score": 0, "creation_date": 1453300173, "post_id": 34902226, "comment_id": 57541445, "body": "OK, Have you downloaded zip archive of mysql-connector from here : <a href=\"http://dev.mysql.com/downloads/connector/c/\" rel=\"nofollow noreferrer\">dev.mysql.com/downloads/connector/c</a>  Let&#39;s suppose you have unzipped <i>mysql-connector-c-6.1.6-win32</i> at the root of <i>e:</i> The command to run will be:  <code>gem install mysql2 --platform=ruby --with-mysql-dir=&quot;e:\\mysql-connector-c-6.1.6-win32&quot;</code>"}, {"owner": {"reputation": 168, "user_id": 1976932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RSWmZ.jpg?s=128&g=1", "display_name": "nmeylan", "link": "https://stackoverflow.com/users/1976932/nmeylan"}, "edited": false, "score": 0, "creation_date": 1453301079, "post_id": 34902226, "comment_id": 57542133, "body": "And with : <code>gem install mysql2 --platform=ruby -- &#39;--with-mysql-dir=&quot;e:&#47;mysql-connector-c-6.1.6-win32&quot;&#39;</code> (slash instead of backslash) Otherwise, i really don&#39;t know what happens. It has worked for me"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5045814"}, "edited": false, "score": 0, "creation_date": 1453305380, "post_id": 34902226, "comment_id": 57545296, "body": "hey, just recognized. Where can i find this dll? i took it from mysql-connector-c-6.1.6-win32/lib. But where is this bin folder? Cause mysql-connector-c-6.1.6-win32/bin doesnt contain libmysql.dll. So where is mysql_files/bin?"}, {"owner": {"reputation": 168, "user_id": 1976932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RSWmZ.jpg?s=128&g=1", "display_name": "nmeylan", "link": "https://stackoverflow.com/users/1976932/nmeylan"}, "edited": false, "score": 0, "creation_date": 1453305796, "post_id": 34902226, "comment_id": 57545612, "body": "I think the post&#39;s author just mistyped folder&#39;s name. To me the dll is under <i>/lib</i> folder.  What  do you get now, when you perform a <code>bundle install</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5045814"}, "edited": false, "score": 0, "creation_date": 1453306468, "post_id": 34902226, "comment_id": 57546118, "body": "Same result. R u sure about folder? Cause i just download new archive with mysql and in folder lib there is already libmysql.dll by default. So we dont need to do gem install mysql2 etc? Maybe its another folder?"}, {"owner": {"reputation": 168, "user_id": 1976932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RSWmZ.jpg?s=128&g=1", "display_name": "nmeylan", "link": "https://stackoverflow.com/users/1976932/nmeylan"}, "edited": false, "score": 0, "creation_date": 1453306715, "post_id": 34902226, "comment_id": 57546298, "body": "For me you have to pick <i>libmysql.dll</i> from <code>mysql-connector-c-6.1.6-win32&#47;lib</code> and place it under your <code>ruby&#47;bin</code> folder. And for sure you have to install mysql2 gem. What&#39;s the output of <code>bundle install</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5045814"}, "edited": false, "score": 0, "creation_date": 1453307063, "post_id": 34902226, "comment_id": 57546548, "body": "Too big log, so 3 pics: 1) <a href=\"http://postimg.org/image/s2lpufgh7/\" rel=\"nofollow noreferrer\">postimg.org/image/s2lpufgh7</a> 2) <a href=\"http://postimg.org/image/d3vo4hegt/\" rel=\"nofollow noreferrer\">postimg.org/image/d3vo4hegt</a> 3) <a href=\"http://postimg.org/image/5232if9nt/\" rel=\"nofollow noreferrer\">postimg.org/image/5232if9nt</a>"}, {"owner": {"reputation": 168, "user_id": 1976932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RSWmZ.jpg?s=128&g=1", "display_name": "nmeylan", "link": "https://stackoverflow.com/users/1976932/nmeylan"}, "edited": false, "score": 0, "creation_date": 1453319353, "post_id": 34902226, "comment_id": 57554105, "body": "Seems mysql2 gem wasn&#39;t installed when you performed : <code>gem install mysql2 --platform=ruby -- &#39;--with-mysql-dir=&quot;e:&#47;mysql-connector-c-6.1.6-win32&quot;&#39;</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5045814"}, "edited": false, "score": 0, "creation_date": 1453374711, "post_id": 34902226, "comment_id": 57578013, "body": "So what should i do? I dont understand, maybe reason is not in mysql2? On the internet I saw that this (activemodel) can be a problem that connected with versions of ruby. But couldnt find how to fix it :("}], "tags": [], "owner": {"reputation": 168, "user_id": 1976932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RSWmZ.jpg?s=128&g=1", "display_name": "nmeylan", "link": "https://stackoverflow.com/users/1976932/nmeylan"}, "is_accepted": false, "score": 0, "last_activity_date": 1453298742, "creation_date": 1453298742, "answer_id": 34902226, "question_id": 34901962, "link": "https://stackoverflow.com/questions/34901962/error-could-not-find-activemodel-3-2-13-in-any-of-source/34902226#34902226", "title": "Error: Could not find activemodel-3.2.13 in any of source", "body": "<p>I followed this guideline <a href=\"https://medium.com/@frontlineutils/installing-the-mysql2-rubyonrails-gem-on-windows-7-8-a028f44d87f3#.op5rwsf2e\" rel=\"nofollow\">https://medium.com/@frontlineutils/installing-the-mysql2-rubyonrails-gem-on-windows-7-8-a028f44d87f3#.op5rwsf2e</a></p>\n\n<p>As I'm no more on windows, I can't test it again, but it should still work.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5045814"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 937, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453298742, "creation_date": 1453298081, "question_id": 34901962, "link": "https://stackoverflow.com/questions/34901962/error-could-not-find-activemodel-3-2-13-in-any-of-source", "title": "Error: Could not find activemodel-3.2.13 in any of source", "body": "<p>I have a problem with launching of the ready project.\nWhen i launch the program with:</p>\n\n<blockquote>\n  <p>rails s\n  I get:\n  Could not find activemodel-3.2.13 in any of sources</p>\n  \n  <p>Run 'bundle install' to install missing gems</p>\n</blockquote>\n\n<p>After running:</p>\n\n<blockquote>\n  <p>bundle install</p>\n</blockquote>\n\n<p>I have:</p>\n\n<blockquote>\n  <p>Installing mysql2 0.3.16 with native extensions</p>\n  \n  <p>Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.</p>\n  \n  <p>e:/Different/RoR/Ruby22/bin/ruby.exe extconf.rb</p>\n  \n  <p><strong>* extconf.rb failed *</strong></p>\n  \n  <p>Could not create Makefile due to some reason, probably lack of necessary\n  libraries and/or headers.  Check the mkmf.log file for more details.  You may\n  need configuration options.</p>\n  \n  <p>Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.</p>\n  \n  <p>Gem files will remain installed in e:/Different/RoR/Ruby22/lib/ruby/gems/2.2.0/gems/debugger-1.6.8 for inspection.</p>\n  \n  <p>Results logged to e:/Different/RoR/Ruby22/lib/ruby/gems/2.2.0/gems/debugger-1.6.8/ext/ruby_debug/gem_make.out</p>\n  \n  <p>An error occurred while installing mysql2 (0.3.16), and Bundler cannot continue.</p>\n  \n  <p>Make sure that <code>gem install mysql2 -v '0.3.16'</code> succeeds before bundling.</p>\n</blockquote>\n\n<p>Thats not all log, just with errors.</p>\n\n<p>So next i run:</p>\n\n<blockquote>\n  <p>gem install mysql2 -v '0.3.16'</p>\n</blockquote>\n\n<p>I get:</p>\n\n<blockquote>\n  <p>ERROR: Error installing mysql2:</p>\n  \n  <p>ERROR: Failed to build gem native extension.</p>\n  \n  <p><strong>* extconf.rb failed *</strong></p>\n  \n  <p>Could not create Makefile due to some reason, probably lack of necessary\n  libraries and/or headers.  Check the mkmf.log file for more details.  You may\n  need configuration options.</p>\n  \n  <p>Gem files will remain installed in E:/Different/RoR/Ruby22/lib/ruby/gems/2.2.0/gems/mysql2-0.3.16 for inspection.</p>\n  \n  <p>Results logged to E:/Different/RoR/Ruby22/lib/ruby/gems/2.2.0/gems/mysql2-0.3.16/ext/mysql2/gem_make.out</p>\n</blockquote>\n\n<p>So what should i do?\nEarlier I have one more error connected with  SSL connection error. So I couldnt load from <a href=\"http://rubygems.org/\" rel=\"nofollow\">http://rubygems.org/</a>. But it seems like its gone now.</p>\n\n<p>My GemFile:</p>\n\n<pre><code>source 'https://rubygems.org'\n\ngem 'rails', '3.2.13'\n\n# Bundle edge Rails instead:\n# gem 'rails', :git =&gt; 'git://github.com/rails/rails.git'\ngem 'rake', '10.2.1'\n# gem 'sqlite3'\ngem 'mysql2'\ngem 'haml-rails'\ngem 'annotate', '&gt;=2.6.0'\ngem 'bcrypt-ruby', '3.0.1'\ngem \"date-input-rails\"\ngem \"nested_form\"\ngem 'debugger'\n#gem \"thin\"\n\n# Gems used only for assets and not required\n# in production environments by default.\ngroup :assets do\n  gem 'sass-rails',   '~&gt; 3.2.3'\n  gem 'coffee-rails', '~&gt; 3.2.1'\n  gem 'bootstrap-sass', '3.0'\n  gem 'bootstrap-datepicker-rails'\n  # See https://github.com/sstephenson/execjs#readme for more supported runtimes\n  # gem 'therubyracer', :platforms =&gt; :ruby\n\n  gem 'uglifier', '&gt;= 1.0.3'\nend\n\ngem 'jquery-rails'\n\n# To use ActiveModel has_secure_password\n# gem 'bcrypt-ruby', '~&gt; 3.0.0'\n\n# To use Jbuilder templates for JSON\n# gem 'jbuilder'\n\n# Use unicorn as the app server\n# gem 'unicorn'\n\n# Deploy with Capistrano\n# gem 'capistrano'\n\n# To use debugger\n# gem 'debugger'\n</code></pre>\n\n<p>My GemFile.lock:</p>\n\n<pre><code>GEM\n  remote: https://rubygems.org/\n  specs:\n    actionmailer (3.2.13)\n      actionpack (= 3.2.13)\n      mail (~&gt; 2.5.3)\n    actionpack (3.2.13)\n      activemodel (= 3.2.13)\n      activesupport (= 3.2.13)\n      builder (~&gt; 3.0.0)\n      erubis (~&gt; 2.7.0)\n      journey (~&gt; 1.0.4)\n      rack (~&gt; 1.4.5)\n      rack-cache (~&gt; 1.2)\n      rack-test (~&gt; 0.6.1)\n      sprockets (~&gt; 2.2.1)\n    activemodel (3.2.13)\n      activesupport (= 3.2.13)\n      builder (~&gt; 3.0.0)\n    activerecord (3.2.13)\n      activemodel (= 3.2.13)\n      activesupport (= 3.2.13)\n      arel (~&gt; 3.0.2)\n      tzinfo (~&gt; 0.3.29)\n    activeresource (3.2.13)\n      activemodel (= 3.2.13)\n      activesupport (= 3.2.13)\n    activesupport (3.2.13)\n      i18n (= 0.6.1)\n      multi_json (~&gt; 1.0)\n    annotate (2.6.1)\n      activerecord (&gt;= 2.3.0)\n      rake (&gt;= 0.8.7)\n    arel (3.0.3)\n    bcrypt-ruby (3.0.1)\n    bootstrap-datepicker-rails (1.3.0.1)\n      railties (&gt;= 3.0)\n    bootstrap-sass (3.0.0.0)\n      sass (~&gt; 3.2)\n    builder (3.0.4)\n    coffee-rails (3.2.2)\n      coffee-script (&gt;= 2.2.0)\n      railties (~&gt; 3.2.0)\n    coffee-script (2.2.0)\n      coffee-script-source\n      execjs\n    coffee-script-source (1.7.0)\n    columnize (0.9.0)\n    date-input-rails (0.0.3)\n      jquery-ui-rails\n      rails (~&gt; 3.2.8)\n    debugger (1.6.8)\n      columnize (&gt;= 0.3.1)\n      debugger-linecache (~&gt; 1.2.0)\n      debugger-ruby_core_source (~&gt; 1.3.5)\n    debugger-linecache (1.2.0)\n    debugger-ruby_core_source (1.3.7)\n    erubis (2.7.0)\n    execjs (2.0.2)\n    haml (4.0.5)\n      tilt\n    haml-rails (0.4)\n      actionpack (&gt;= 3.1, &lt; 4.1)\n      activesupport (&gt;= 3.1, &lt; 4.1)\n      haml (&gt;= 3.1, &lt; 4.1)\n      railties (&gt;= 3.1, &lt; 4.1)\n    hike (1.2.3)\n    i18n (0.6.1)\n    journey (1.0.4)\n    jquery-rails (3.1.0)\n      railties (&gt;= 3.0, &lt; 5.0)\n      thor (&gt;= 0.14, &lt; 2.0)\n    jquery-ui-rails (4.1.2)\n      railties (&gt;= 3.1.0)\n    json (1.8.1)\n    mail (2.5.4)\n      mime-types (~&gt; 1.16)\n      treetop (~&gt; 1.4.8)\n    mime-types (1.25.1)\n    multi_json (1.8.4)\n    mysql2 (0.3.16)\n    nested_form (0.3.2)\n    polyglot (0.3.3)\n    rack (1.4.5)\n    rack-cache (1.2)\n      rack (&gt;= 0.4)\n    rack-ssl (1.3.3)\n      rack\n    rack-test (0.6.2)\n      rack (&gt;= 1.0)\n    rails (3.2.13)\n      actionmailer (= 3.2.13)\n      actionpack (= 3.2.13)\n      activerecord (= 3.2.13)\n      activeresource (= 3.2.13)\n      activesupport (= 3.2.13)\n      bundler (~&gt; 1.0)\n      railties (= 3.2.13)\n    railties (3.2.13)\n      actionpack (= 3.2.13)\n      activesupport (= 3.2.13)\n      rack-ssl (~&gt; 1.3.2)\n      rake (&gt;= 0.8.7)\n      rdoc (~&gt; 3.4)\n      thor (&gt;= 0.14.6, &lt; 2.0)\n    rake (10.2.1)\n    rdoc (3.12.2)\n      json (~&gt; 1.4)\n    sass (3.2.14)\n    sass-rails (3.2.6)\n      railties (~&gt; 3.2.0)\n      sass (&gt;= 3.1.10)\n      tilt (~&gt; 1.3)\n    sprockets (2.2.2)\n      hike (~&gt; 1.2)\n      multi_json (~&gt; 1.0)\n      rack (~&gt; 1.0)\n      tilt (~&gt; 1.1, != 1.3.0)\n    thor (0.18.1)\n    tilt (1.4.1)\n    treetop (1.4.15)\n      polyglot\n      polyglot (&gt;= 0.3.1)\n    tzinfo (0.3.38)\n    uglifier (2.4.0)\n      execjs (&gt;= 0.3.0)\n      json (&gt;= 1.8.0)\n\nPLATFORMS\n  ruby\n\nDEPENDENCIES\n  annotate (&gt;= 2.6.0)\n  bcrypt-ruby (= 3.0.1)\n  bootstrap-datepicker-rails\n  bootstrap-sass (= 3.0)\n  coffee-rails (~&gt; 3.2.1)\n  date-input-rails\n  debugger\n  haml-rails\n  jquery-rails\n  mysql2\n  nested_form\n  rails (= 3.2.13)\n  rake (= 10.2.1)\n  sass-rails (~&gt; 3.2.3)\n  uglifier (&gt;= 1.0.3)\n</code></pre>\n"}, {"tags": ["ruby", "rbenv"], "answers": [{"comments": [{"owner": {"reputation": 4402, "user_id": 692622, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/29d3327801aa145c77d873604a2f71c0?s=128&d=identicon&r=PG", "display_name": "iCyborg", "link": "https://stackoverflow.com/users/692622/icyborg"}, "edited": false, "score": 0, "creation_date": 1615747870, "post_id": 34902126, "comment_id": 117781492, "body": "Thanks, this worked."}], "tags": [], "owner": {"reputation": 9368, "user_id": 316408, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2d693c173f4a9e6cfec05c26c1df0d91?s=128&d=identicon&r=PG&f=1", "display_name": "mahatmanich", "link": "https://stackoverflow.com/users/316408/mahatmanich"}, "is_accepted": true, "score": 3, "last_activity_date": 1453929432, "last_edit_date": 1453929432, "creation_date": 1453298484, "answer_id": 34902126, "question_id": 34901912, "link": "https://stackoverflow.com/questions/34901912/cant-find-ruby-2-2-x-stable-in-my-rbenv-install-list/34902126#34902126", "title": "Can&#39;t find ruby 2.2.x stable in my rbenv install list", "body": "<p>I needed to update the ruby-build plugin inside the ~/.rbenv/plugins/ directory using:</p>\n\n<pre><code>cd ~/.rbenv/plugins/ruby-build\ngit pull\n</code></pre>\n\n<p>Could this not be automated?</p>\n"}, {"tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 1, "last_activity_date": 1453929616, "creation_date": 1453929616, "answer_id": 35048244, "question_id": 34901912, "link": "https://stackoverflow.com/questions/34901912/cant-find-ruby-2-2-x-stable-in-my-rbenv-install-list/35048244#35048244", "title": "Can&#39;t find ruby 2.2.x stable in my rbenv install list", "body": "<p>rbenv supports <a href=\"https://github.com/rbenv/rbenv/wiki/Plugins\" rel=\"nofollow\">plugins</a>, of which \"<a href=\"https://github.com/rkh/rbenv-update\" rel=\"nofollow\">update</a>\" will do what you want.</p>\n\n<p>From the docs:</p>\n\n<blockquote>\n  <p>update rbenv and installed plugins</p>\n</blockquote>\n\n<pre><code>mkdir -p \"$(rbenv root)/plugins\"\ngit clone https://github.com/rkh/rbenv-update.git \"$(rbenv root)/plugins/rbenv-update\"\n</code></pre>\n\n<p>Then run <code>rbenv update</code> and it'll refresh rbenv and any other plugins you've added.</p>\n\n<p>It might be useful to add that to a daily or weekly cron task so rbenv is automatically updated regularly.</p>\n"}], "owner": {"reputation": 9368, "user_id": 316408, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2d693c173f4a9e6cfec05c26c1df0d91?s=128&d=identicon&r=PG&f=1", "display_name": "mahatmanich", "link": "https://stackoverflow.com/users/316408/mahatmanich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 1, "accepted_answer_id": 34902126, "answer_count": 2, "score": 0, "last_activity_date": 1453929616, "creation_date": 1453297917, "last_edit_date": 1453929406, "question_id": 34901912, "link": "https://stackoverflow.com/questions/34901912/cant-find-ruby-2-2-x-stable-in-my-rbenv-install-list", "title": "Can&#39;t find ruby 2.2.x stable in my rbenv install list", "body": "<p>I was expecting to see the latest stable ruby version 2.2.2 and also 2.2.3 which has just been released when running:</p>\n\n<pre><code>rbenv install --list\n</code></pre>\n\n<p>I did an update to rbenv using <code>git pull</code> and <code>rbenv rehash</code>.</p>\n\n<p>Do I need to clear a cache for those versions to show up?</p>\n\n<p>My version list is:</p>\n\n<pre><code>Available versions:\n  1.8.6-p383\n  1.8.6-p420\n  1.8.7-p249\n  1.8.7-p302\n  1.8.7-p334\n  1.8.7-p352\n  1.8.7-p357\n  1.8.7-p358\n  1.8.7-p370\n  1.8.7-p371\n  1.8.7-p374\n  1.8.7-p375\n  1.9.1-p378\n  1.9.1-p430\n  1.9.2-p0\n  1.9.2-p180\n  1.9.2-p290\n  1.9.2-p318\n  1.9.2-p320\n  1.9.2-p326\n  1.9.3-dev\n  1.9.3-p0\n  1.9.3-p125\n  1.9.3-p194\n  1.9.3-p286\n  1.9.3-p327\n  1.9.3-p362\n  1.9.3-p374\n  1.9.3-p385\n  1.9.3-p392\n  1.9.3-p429\n  1.9.3-p448\n  1.9.3-p484\n  1.9.3-preview1\n  1.9.3-rc1\n  2.0.0-dev\n  2.0.0-p0\n  2.0.0-p195\n  2.0.0-p247\n  2.0.0-p353\n  2.0.0-preview1\n  2.0.0-preview2\n  2.0.0-rc1\n  2.0.0-rc2\n  2.1.0\n  2.1.0-dev\n  2.1.0-preview1\n  2.1.0-preview2\n  2.1.0-rc1\n  2.2.0-dev\n  jruby-1.5.6\n  jruby-1.6.3\n  jruby-1.6.4\n  jruby-1.6.5\n  jruby-1.6.5.1\n  jruby-1.6.6\n  jruby-1.6.7\n  jruby-1.6.7.2\n  jruby-1.6.8\n  jruby-1.7.0\n  jruby-1.7.0-preview1\n  jruby-1.7.0-preview2\n  jruby-1.7.0-rc1\n  jruby-1.7.0-rc2\n  jruby-1.7.1\n  jruby-1.7.10\n  jruby-1.7.2\n  jruby-1.7.3\n  jruby-1.7.4\n  jruby-1.7.5\n  jruby-1.7.6\n  jruby-1.7.7\n  jruby-1.7.8\n  jruby-1.7.9\n  maglev-1.0.0\n  maglev-1.1.0-dev\n  maglev-2.0.0-dev\n  mruby-dev\n  rbx-1.2.4\n  rbx-2.0.0\n  rbx-2.0.0-dev\n  rbx-2.0.0-rc1\n  rbx-2.1.0\n  rbx-2.1.1\n  rbx-2.2.0\n  rbx-2.2.1\n  rbx-2.2.2\n  rbx-2.2.3\n  ree-1.8.6-2009.06\n  ree-1.8.7-2009.09\n  ree-1.8.7-2009.10\n  ree-1.8.7-2010.01\n  ree-1.8.7-2010.02\n  ree-1.8.7-2011.03\n  ree-1.8.7-2011.12\n  ree-1.8.7-2012.01\n  ree-1.8.7-2012.02\n  topaz-dev\n</code></pre>\n\n<p>How will I get the 2.2.x stable versions to show up? \nOr better, how do I tell <code>ruby-build</code> to fetch new definitions?</p>\n\n<p>I am on Linux BTW.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "caching", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 1743, "user_id": 1821450, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/553ce41bacded4ae27ee3586a0f3c770?s=128&d=identicon&r=PG", "display_name": "mutant_city", "link": "https://stackoverflow.com/users/1821450/mutant-city"}, "edited": false, "score": 0, "creation_date": 1453302341, "post_id": 34901651, "comment_id": 57543030, "body": "Thanks. This is great.  Is it ok to use self.find_cached instead of class &lt;&lt; self? I&#39;m just not terribly familiar with meta programming."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 1743, "user_id": 1821450, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/553ce41bacded4ae27ee3586a0f3c770?s=128&d=identicon&r=PG", "display_name": "mutant_city", "link": "https://stackoverflow.com/users/1821450/mutant-city"}, "edited": false, "score": 0, "creation_date": 1453305455, "post_id": 34901651, "comment_id": 57545360, "body": "Sure, both <code>self.find_cached</code> and <code>Vehicle.find_cached</code> are fine here."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1453297235, "creation_date": 1453297235, "answer_id": 34901651, "question_id": 34901246, "link": "https://stackoverflow.com/questions/34901246/how-to-cache-the-entire-active-record-model-from-inside-the-model/34901651#34901651", "title": "How to cache the entire active record model from inside the model?", "body": "<pre><code>class Vehicle\n  class &lt;&lt; self\n    def find_cached event_mac_address\n      @vehicle_cache.get(event_mac_address) || \\\n        where('ID = ?', event_mac_address).first.tap do |vehicle|\n          @vehicle_cache.add(event_mac_address, vehicle) if vehicle\n        end\n    end\n  end\nend\n</code></pre>\n\n<p>The above will define <code>find_cached</code> on <code>Vehicle</code> class. One should not interfere rails internals, like <code>find</code>, unless this in unavoidable.</p>\n\n<p>Here we first try to get a cached value, then use <code>where</code> (note, that there is no need for <code>rescue</code> since <code>where</code> returns empty array, unlike <code>find</code>) and finally we add the newly found item to the cache.</p>\n"}, {"comments": [{"owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "edited": false, "score": 0, "creation_date": 1453303534, "post_id": 34901656, "comment_id": 57543905, "body": "NOTE: if you use this and the model changes that you cached, you will need to bust the cache using Rails.cache.delete on the update of the model"}], "tags": [], "owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "is_accepted": false, "score": 1, "last_activity_date": 1453297242, "creation_date": 1453297242, "answer_id": 34901656, "question_id": 34901246, "link": "https://stackoverflow.com/questions/34901246/how-to-cache-the-entire-active-record-model-from-inside-the-model/34901656#34901656", "title": "How to cache the entire active record model from inside the model?", "body": "<p>Use the rails cache in your model</p>\n\n<pre><code>def cached_mac_address_fetch(mac_address)\n  Rails.cache.fetch([self, 'mac_address'], expires_in: 12.hours) do\n    Vehicle.where('ID = ?', mac_address).first_or_create\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1743, "user_id": 1821450, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/553ce41bacded4ae27ee3586a0f3c770?s=128&d=identicon&r=PG", "display_name": "mutant_city", "link": "https://stackoverflow.com/users/1821450/mutant-city"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 34901651, "answer_count": 2, "score": 0, "last_activity_date": 1453297242, "creation_date": 1453296108, "question_id": 34901246, "link": "https://stackoverflow.com/questions/34901246/how-to-cache-the-entire-active-record-model-from-inside-the-model", "title": "How to cache the entire active record model from inside the model?", "body": "<p>I essentially am wanting to move this inside of the vehicle model.</p>\n\n<pre><code>vehicle = @vehicle_cache.get(event[:mac_address])\n\nunless vehicle\n        begin\n            vehicle = Vehicle.where('ID = ?',event[:mac_address]).first\n        rescue\n            vehicle = nil\n        end\n        @vehicle_cache.add(event[:mac_address],vehicle)\nend\n</code></pre>\n\n<p>I'm thinking theres a way to override the internal find method?  But I'm not sure how to access the model from within itself.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 1201, "user_id": 5097493, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/95b290a191545edb4077adfaab317f1a?s=128&d=identicon&r=PG&f=1", "display_name": "RuNpiXelruN", "link": "https://stackoverflow.com/users/5097493/runpixelrun"}, "is_accepted": false, "score": 1, "last_activity_date": 1453296658, "last_edit_date": 1453296658, "creation_date": 1453296112, "answer_id": 34901247, "question_id": 34901199, "link": "https://stackoverflow.com/questions/34901199/list-of-articles-also-displays-database-info-for-all-articles-in-view/34901247#34901247", "title": "List of articles also displays database info for all articles in View", "body": "<p>Take out the <code>=</code> sign of your loop \nSo:\n <code>&lt;% @articles.each do |article| %&gt;</code></p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 5546581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2397d2628c7d725365825a56f5cb69e?s=128&d=identicon&r=PG&f=1", "display_name": "David.Escudero", "link": "https://stackoverflow.com/users/5546581/david-escudero"}, "edited": false, "score": 0, "creation_date": 1453309514, "post_id": 34901405, "comment_id": 57548251, "body": "Thanks! I hadn&#39;t seen it but I actually wasn&#39;t even sure how it affected my code even if I had!"}], "tags": [], "owner": {"reputation": 1592, "user_id": 4271743, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Nivk1.jpg?s=128&g=1", "display_name": "ConnorCMcKee", "link": "https://stackoverflow.com/users/4271743/connorcmckee"}, "is_accepted": true, "score": 0, "last_activity_date": 1453296938, "last_edit_date": 1495539893, "creation_date": 1453296581, "answer_id": 34901405, "question_id": 34901199, "link": "https://stackoverflow.com/questions/34901199/list-of-articles-also-displays-database-info-for-all-articles-in-view/34901405#34901405", "title": "List of articles also displays database info for all articles in View", "body": "<p>In Embedded Ruby (ERB), the difference between <code>&lt;% %&gt;</code> and <code>&lt;%= %&gt;</code> is not simply cosmetic; the latter actually prints the results of the line of code into the html. As such, in your line:</p>\n\n<pre><code>&lt;%= @articles.each do |article| %&gt;\n</code></pre>\n\n<p>...You are actually printing the results of running that line of code and displaying it. Or, more specifically, you're displaying loop itself, not just the results of looping through the @articles collection. You'll get a lot of gibberish from haphazardly using the <code>&lt;%= %&gt;</code> notation. Just look at when you play around in the console/debugger; running these lines of code makes a lot of noise!</p>\n\n<p>To fix your problem, your loop through @articles should simply look like this:</p>\n\n<pre><code># No \"=\" here!\n&lt;% @articles.each do |article| %&gt;\n    &lt;li&gt;\n        &lt;%= link_to article.title, article_path(article), class: 'article_title' %&gt;\n    &lt;/li&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>For more information on ERB syntax, look <a href=\"http://ruby-doc.org/stdlib-1.9.3/libdoc/erb/rdoc/ERB.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>For another stack overflow question encompassing this and a few additional notation, look <a href=\"https://stackoverflow.com/questions/7996695/what-is-the-difference-between-and-in-erb-in-rails\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 73119, "user_id": 1143732, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mFUOI.jpg?s=128&g=1", "display_name": "Richard Peck", "link": "https://stackoverflow.com/users/1143732/richard-peck"}, "is_accepted": false, "score": 0, "last_activity_date": 1453299865, "creation_date": 1453299865, "answer_id": 34902644, "question_id": 34901199, "link": "https://stackoverflow.com/questions/34901199/list-of-articles-also-displays-database-info-for-all-articles-in-view/34902644#34902644", "title": "List of articles also displays database info for all articles in View", "body": "<pre><code>&lt;% @articles.each do |article| %&gt;\n   &lt;%= content_tag :li, link_to(article.title, article, class: 'article_title') %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Struggled with the same issue for 2 days when starting.</p>\n"}], "owner": {"reputation": 3, "user_id": 5546581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2397d2628c7d725365825a56f5cb69e?s=128&d=identicon&r=PG&f=1", "display_name": "David.Escudero", "link": "https://stackoverflow.com/users/5546581/david-escudero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 34901405, "answer_count": 3, "score": 0, "last_activity_date": 1453299865, "creation_date": 1453295994, "question_id": 34901199, "link": "https://stackoverflow.com/questions/34901199/list-of-articles-also-displays-database-info-for-all-articles-in-view", "title": "List of articles also displays database info for all articles in View", "body": "<p>I am doing the Jumpstart tutorial where you have to create a blog in ruby on rails. It is going fine but I have not managed to figure out one thing. \nThe root page is supposed to show a list of articles. And it does. Only it also shows this extra bit: \n<a href=\"http://i.stack.imgur.com/FNGbk.png\" rel=\"nofollow\">Article list and unwanted part at the bottom</a></p>\n\n<p>The code I have in the view:</p>\n\n<pre><code>&lt;h1&gt; All Articles &lt;/h1&gt;\n\n\n&lt;ul id=\"articles\"&gt;\n    &lt;%= @articles.each do |article| %&gt;\n        &lt;li&gt;\n            &lt;%= link_to article.title, article_path(article), class: 'article_title' %&gt;\n        &lt;/li&gt;\n    &lt;% end %&gt;\n&lt;/ul&gt;\n\n&lt;%= link_to \"Create New Article\", new_article_path, class: 'new_article' %&gt;\n</code></pre>\n\n<p>And here is the relevant code in the controller</p>\n\n<pre><code>def index\n    @articles = Article.all\nend\n</code></pre>\n\n<p>I would appreciate any help on why this is happening. </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "edited": false, "score": 2, "creation_date": 1453297643, "post_id": 34901114, "comment_id": 57539554, "body": "You want to divide 6 pictures on 20 slides? Say first slid is 1/3 only? next slide is another 1/3 of the first picture, etc? It will help if you could elaborate on the specific problem you have, and what you specifically want to achieve."}, {"owner": {"reputation": 732, "user_id": 958503, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/AqaXx.png?s=128&g=1", "display_name": "Raza Hussain", "link": "https://stackoverflow.com/users/958503/raza-hussain"}, "reply_to_user": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "edited": false, "score": 0, "creation_date": 1453304327, "post_id": 34901114, "comment_id": 57544512, "body": "I have to achieve that I can capture 6 pictures during reading slides one by one."}], "answers": [{"tags": [], "owner": {"reputation": 74, "user_id": 1500866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KnNoz.jpg?s=128&g=1", "display_name": "Muneeb Ahmad", "link": "https://stackoverflow.com/users/1500866/muneeb-ahmad"}, "is_accepted": true, "score": 2, "last_activity_date": 1453362402, "creation_date": 1453362402, "answer_id": 34918037, "question_id": 34901114, "link": "https://stackoverflow.com/questions/34901114/capture-users-picture-during-course-slides/34918037#34918037", "title": "Capture user&#39;s picture during course slides", "body": "<p>You can use following formula to select index of n slides from total number of sides for taking screenshots</p>\n\n<p>Let </p>\n\n<pre><code>n  = number of screenshots you need \n\nts = total number of slides\n</code></pre>\n\n<p>then</p>\n\n<pre><code>(1..n).map{|e| (e*(ts.to_f/n)).round}.include?(params[:slide].to_i)\n</code></pre>\n"}], "owner": {"reputation": 732, "user_id": 958503, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/AqaXx.png?s=128&g=1", "display_name": "Raza Hussain", "link": "https://stackoverflow.com/users/958503/raza-hussain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 1, "accepted_answer_id": 34918037, "answer_count": 1, "score": 0, "last_activity_date": 1453362402, "creation_date": 1453295780, "question_id": 34901114, "link": "https://stackoverflow.com/questions/34901114/capture-users-picture-during-course-slides", "title": "Capture user&#39;s picture during course slides", "body": "<p>I have courses where users can enroll. Each course have number of slides.\nIn each course there is a configuration to set how many user picture should capture during the course.\nLet suppose we have a course need to capture 6 picture during course and course have 20 slides.</p>\n\n<p>I have to show a camera dialog when user is navigation through slides.\nProblem is how i can divide these 6 pictures on 20 slides.\ne.i</p>\n\n<pre><code>if algo(params[:slide]) \n  # show dialog of camera\n</code></pre>\n\n<p>I need an 'algo' to check on each slide. Slides and Number of picures will vary course to course.</p>\n\n<p>Thanks!  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongodb", "mongoid", "carrierwave"], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 5658363, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7bfe7e621c2df3b31ecaaa12d87b42f6?s=128&d=identicon&r=PG&f=1", "display_name": "JosephGage", "link": "https://stackoverflow.com/users/5658363/josephgage"}, "is_accepted": true, "score": 0, "last_activity_date": 1453372585, "creation_date": 1453372585, "answer_id": 34921344, "question_id": 34900645, "link": "https://stackoverflow.com/questions/34900645/memory-allocation-error-when-uploading-large-file-to-rails-app-with-carrierwave/34921344#34921344", "title": "Memory Allocation Error when uploading large file to Rails app with Carrierwave", "body": "<p>So it seems that the problem was with webrick. I'm not sure what exactly the problem was but I got it working using Thin instead of webrick. </p>\n"}], "owner": {"reputation": 49, "user_id": 5658363, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7bfe7e621c2df3b31ecaaa12d87b42f6?s=128&d=identicon&r=PG&f=1", "display_name": "JosephGage", "link": "https://stackoverflow.com/users/5658363/josephgage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 611, "favorite_count": 0, "accepted_answer_id": 34921344, "answer_count": 1, "score": 0, "last_activity_date": 1453372585, "creation_date": 1453294507, "last_edit_date": 1495541248, "question_id": 34900645, "link": "https://stackoverflow.com/questions/34900645/memory-allocation-error-when-uploading-large-file-to-rails-app-with-carrierwave", "title": "Memory Allocation Error when uploading large file to Rails app with Carrierwave", "body": "<p>I have looked at the following question but it doesn't give a satisfactory solution to my problem: </p>\n\n<p><a href=\"https://stackoverflow.com/questions/32774962/getting-my-rails-app-to-accept-large-files\">getting my rails app to accept large files</a></p>\n\n<p>I am using Rails 4.2, Ruby 2.1 and Mongodb 3.2, Carrierwave 0.10.0 and Mongoid 5.0.2. I am able to upload relatively small files (&lt;20mb) successfully to the database. But when I attempt to upload a large file (approximately 500mb) I get the following error in the console:  </p>\n\n<blockquote>\n  <p>Started GET \"/invoice_collections/new\" for ::1 at 2016-01-20 14:24:12 +0200\n  Processing by InvoiceCollectionsController#new as HTML\n   Rendered invoice_collections/new.html.erb within layouts/application (28.0ms)\n  Completed 200 OK in 129ms (Views: 128.0ms | ActiveRecord: 0.0ms)\n  [2016-01-20 14:25:30] <strong>ERROR NoMemoryError: failed to allocate memory</strong>\n  C:/RailsInstaller/Ruby2.1.0/lib/ruby/2.1.0/webrick/httprequest.rb:254:in 'block >in body'\n  C:/RailsInstaller/Ruby2.1.0/lib/ruby/2.1.0/webrick/httprequest.rb:479:in 'call'\n  C:/RailsInstaller/Ruby2.1.0/lib/ruby/2.1.0/webrick/httprequest.rb:479:in >`read_body'\n  C:/RailsInstaller/Ruby2.1.0/lib/ruby/2.1.0/webrick/httprequest.rb:255:in 'body'\n  C:/RailsInstaller/Ruby2.1.0/lib/ruby/gems/2.1.0/gems/rack-1.6.4/lib/rack/handler/webrick.rb:62:in 'service'\n  C:/RailsInstaller/Ruby2.1.0/lib/ruby/2.1.0/webrick/httpserver.rb:138:in >'service'\n  C:/RailsInstaller/Ruby2.1.0/lib/ruby/2.1.0/webrick/httpserver.rb:94:in 'run'\n  C:/RailsInstaller/Ruby2.1.0/lib/ruby/2.1.0/webrick/server.rb:295:in 'block in >start_thread'</p>\n</blockquote>\n\n<p>While I see this in the console I see a plain white page rather than the view I should be seeing.</p>\n\n<p>Where RailsInstaller is where my Ruby and Rails installation is contained. It was downloaded here: </p>\n\n<p><a href=\"http://railsinstaller.org/en\" rel=\"nofollow noreferrer\">http://railsinstaller.org/en</a></p>\n\n<p>I have tried minimizing memory use on my pc while trying to do this but that has not helped. I have tried reinstalling rails and ruby without success. I have tried running the app on the cloud 9 ide rather than from my machine and it has worked and my machine has more memory than the cloud 9 ide. The reason I need to use my machine for testing, however, is that there are some rather hefty operation I must perform on the uploaded files.</p>\n\n<p>What is causing this error on my machine? What can I do to fix it?</p>\n\n<p><strong>Update:</strong>\nI have tried to run the app on a pc with 32 GB of RAM. Still gives the exact same error, so I don't think it is to do with my PC's memory.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "ruby-on-rails-4.2", "paper-trail-gem"], "comments": [{"owner": {"reputation": 13756, "user_id": 567762, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/908c9abc72ab86111a153b11cb584f26?s=128&d=identicon&r=PG", "display_name": "Jared Beck", "link": "https://stackoverflow.com/users/567762/jared-beck"}, "edited": false, "score": 0, "creation_date": 1454360109, "post_id": 34900412, "comment_id": 58000574, "body": "You say &quot;this isnt [sic] working&quot;. What happens? Do you get an error?"}], "owner": {"reputation": 349, "user_id": 774282, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/928238c89437d1bc4b6bf8c4f6a5c70b?s=128&d=identicon&r=PG", "display_name": "shiva", "link": "https://stackoverflow.com/users/774282/shiva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 375, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1453293795, "creation_date": 1453293795, "question_id": 34900412, "link": "https://stackoverflow.com/questions/34900412/papertrail-versioning-with-separate-database", "title": "papertrail versioning with separate database", "body": "<p>I'm trying to log the change events of a model in a separate database using papertrail. </p>\n\n<p>I'm using \nRails 4.1.2</p>\n\n<p>Ruby 2.1</p>\n\n<p>Papertrail 4.0.0</p>\n\n<p>Below is the code i have added in concerns</p>\n\n<pre><code>module Foo\n  class Base &lt; ActiveRecord::Base\n  end\n\n class Version &lt; Base\n  include PaperTrail::VersionConcern\n end\n\n class Topic &lt; Base\n   has_paper_trail class_name: 'Foo::Version'\n end\nend\nFoo::Base.establish_connection(:trail_development)\n</code></pre>\n\n<p>I have included this Foo in topic.rb </p>\n\n<pre><code>class Topic &lt; ActiveRecord::Base\n  include Foo\nend\n</code></pre>\n\n<p>When im trying to create, edit or delete a topic, this isnt working.</p>\n\n<p>Reference <a href=\"https://github.com/airblade/paper_trail/pull/289\" rel=\"nofollow\">https://github.com/airblade/paper_trail/pull/289</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "xml", "grape", "grape-entity"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 852109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be58d20fe9ae33517a5c521a4aac0c66?s=128&d=identicon&r=PG", "display_name": "davidpgero", "link": "https://stackoverflow.com/users/852109/davidpgero"}, "is_accepted": false, "score": 0, "last_activity_date": 1453308161, "creation_date": 1453308161, "answer_id": 34905672, "question_id": 34900323, "link": "https://stackoverflow.com/questions/34900323/grape-how-to-remove-the-extra-root-element-hash-from-xml-response-when-exposi/34905672#34905672", "title": "Grape: How to remove the extra root element &lt;hash&gt; from XML response when exposing a collection with grape-entity?", "body": "<p>Did you find this thread? <a href=\"https://github.com/ruby-grape/grape-entity/issues/23\" rel=\"nofollow\">XML format is incorrect?</a></p>\n\n<p>It contains with an idea which way you can override it. <a href=\"https://github.com/ruby-grape/grape-on-rack/commit/87c4b97db955cd3cdb4a5d2903e28373b59bc3f2\" rel=\"nofollow\">Use custom formetter to redefine XML root</a></p>\n\n<pre><code> class API &lt; Grape::API\n   content_type :xml, 'application/xml'\n   formatter :xml, Proc.new { |object|\n     object[object.keys.first].to_xml :root =&gt; object.keys.first\n }\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 299999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb10014899c5bc1e75d0460d6cce5b49?s=128&d=identicon&r=PG", "display_name": "Denny", "link": "https://stackoverflow.com/users/299999/denny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 707, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453723110, "creation_date": 1453293520, "last_edit_date": 1453723110, "question_id": 34900323, "link": "https://stackoverflow.com/questions/34900323/grape-how-to-remove-the-extra-root-element-hash-from-xml-response-when-exposi", "title": "Grape: How to remove the extra root element &lt;hash&gt; from XML response when exposing a collection with grape-entity?", "body": "<p>I'm using grape (0.14.0) with grape-entity (0.5.0) to create a XML API within my Rails (4.2.5) app. Whenever I specify an explicit root element within a Grape::Entity class the XML response gets wrapped in an unwanted root element <code>&lt;hash&gt;</code>. How can I get rid of it?</p>\n\n<h2>Example code</h2>\n\n<pre><code># app/models/partner.rb\nclass Partner &lt; ActiveRecord::Base\n  #  company    :string\n  #  name       :string\n  #  secret     :string\nend\n\n# app/api/partners.rb\nclass Partners &lt; Grape::API\n  version 'v1', using: :path\n  prefix :api\n  format :xml\n\n  resource :partners do\n    get do\n      present Partner.all, with: PartnerEntity\n    end\n  end\nend\n\n# app/api/partner_entity.rb\nclass PartnerEntity &lt; Grape::Entity\n  root 'partners', 'partner'\n  expose :company\n  expose :name\n  expose :id\nend\n\n# Create a partner \nPartner.create!(name: 'A Name', company: 'A Company', secret: 'A secret')\n</code></pre>\n\n<h2>Result</h2>\n\n<pre><code># GET /api/v1/partners.xml\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\n&lt;hash&gt;\n  &lt;partners type=\"array\"&gt;\n    &lt;partner&gt;\n      &lt;company&gt;A Company&lt;/company&gt;\n      &lt;name&gt;A Name&lt;/name&gt;\n      &lt;id type=\"integer\"&gt;1&lt;/id&gt;\n    &lt;/partner&gt;\n  &lt;/partners&gt;\n&lt;/hash&gt;\n</code></pre>\n\n<h2>Result without root in PartnerEntity</h2>\n\n<pre><code># GET /api/v1/partners.xml\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\n&lt;partner-entities type=\"array\"&gt;\n  &lt;partner-entity&gt;\n    &lt;company&gt;A Company&lt;/company&gt;\n    &lt;name&gt;A Name&lt;/name&gt;\n    &lt;id type=\"integer\"&gt;2&lt;/id&gt;\n  &lt;/partner-entity&gt;\n&lt;/partner-entities&gt;\n</code></pre>\n\n<p>Since I need to explicitly name my root elements I can't do without root.</p>\n"}, {"tags": ["ruby", "file", "tar", "zlib"], "comments": [{"owner": {"reputation": 1485, "user_id": 5388516, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96fff619864c3ebb7654eb98bd945b43?s=128&d=identicon&r=PG&f=1", "display_name": "13aal", "link": "https://stackoverflow.com/users/5388516/13aal"}, "edited": false, "score": 1, "creation_date": 1453293290, "post_id": 34900198, "comment_id": 57536669, "body": "Have you tried putting the entire path along with the name of the file on where you call <code>zlib</code>?"}, {"owner": {"reputation": 153, "user_id": 5712254, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5179d3995a0d58f4d4dd166ba4f9faf2?s=128&d=identicon&r=PG&f=1", "display_name": "Bam", "link": "https://stackoverflow.com/users/5712254/bam"}, "reply_to_user": {"reputation": 1485, "user_id": 5388516, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96fff619864c3ebb7654eb98bd945b43?s=128&d=identicon&r=PG&f=1", "display_name": "13aal", "link": "https://stackoverflow.com/users/5388516/13aal"}, "edited": false, "score": 0, "creation_date": 1453293434, "post_id": 34900198, "comment_id": 57536761, "body": "@Ekult3k Yes I just tried, and it comes up as this: <code>&#47;home&#47;&lt;dir&gt;&#47;&lt;user&gt;&#47;archive&#47;UW_archive_20120625.tgz&#47;home&#47;comm&zwnj;&#8203;on&#47;4000_ss&#47;2715015.o&zwnj;&#8203;ds (Errno::ENOTDIR)</code>"}, {"owner": {"reputation": 1485, "user_id": 5388516, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96fff619864c3ebb7654eb98bd945b43?s=128&d=identicon&r=PG&f=1", "display_name": "13aal", "link": "https://stackoverflow.com/users/5388516/13aal"}, "edited": false, "score": 0, "creation_date": 1453308461, "post_id": 34900198, "comment_id": 57547541, "body": "The reason it&#39;s outputting that is because that&#39;s what you&#39;re telling it to do, I&#39;m not sure if Ruby can actually untar a file and put it into a directory, you may have to use a bash command here.. I could be wrong, I k ow that Ruby can read from tarballs, and write to them, but pulling a file out of the tarball I&#39;m not sure about.."}], "owner": {"reputation": 153, "user_id": 5712254, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5179d3995a0d58f4d4dd166ba4f9faf2?s=128&d=identicon&r=PG&f=1", "display_name": "Bam", "link": "https://stackoverflow.com/users/5712254/bam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1453293178, "creation_date": 1453293178, "question_id": 34900198, "link": "https://stackoverflow.com/questions/34900198/untarring-single-file-from-large-tarball", "title": "Untarring single file from large tarball", "body": "<p>I have a very large tarball that has around 500 files inside of it.</p>\n\n<p>I'm writing a program to extract a single file from this tarball using <code>package</code> and <code>zlib</code>.. My question being, how do I extract a single file from inside this tarball, the tar has a directory inside of it also called <code>home/common/4000_ss</code> can I extract this single file without taking the directory with the file?</p>\n\n<p>Source:</p>\n\n<pre><code>#!/usr/local/bin/ruby\n\nrequire 'rubygems/package'\nrequire 'fileutils'\nrequire 'zlib'\n\nclass ArchiveManager\n\n  attr_accessor :folio_num\n\n  def initialize(folio_num)\n    @folio_num = folio_num\n  end\n\n  def num_check\n    if folio_num =~ /^\\d{4,7}$/ #&lt;= Thank you Tin Man.\n      search_for_spreadsheet\n    else\n      puts &lt;&lt;-EOF\n\n        USAGE: unarchive_ss &lt;folio number&gt;\n\n      EOF\n    end\n  end\n\n  def search_for_spreadsheet\n    location = FileUtils.chdir(\"/home/&lt;dir&gt;/&lt;user&gt;/archive\")\n    digits = `grep -lr #{folio_num}.ods *.txt`\n    file_name = digits.match(/\\d+/).to_s\n    puts \"Spreadsheet found in UW_archive_#{file_name}.tgz\"\n    extract(file_name, location)\n  end\n\n  def extract(file_name, location)\n    extract_tar = Gem::Package::TarReader.new(Zlib::GzipReader.open(\"/home/&lt;dir&gt;/&lt;user&gt;/archive/UW_archive_#{file_name}.tgz\"))\n    extract_tar.rewind\n    extract_tar.each do |tar|\n      puts tar.full_name\n      puts tar.directory?\n      puts tar.file?\n    end\n  end\nend\n\n\n#/2715015\ntest = ArchiveManager.new(ARGV[0])\ntest.num_check\n</code></pre>\n\n<p>Example of usage right now:</p>\n\n<blockquote>\n<pre><code>[]$ ruby unarchive_ss 2715015 #I know I'm asking it to do all of this.\nhome/common/4000_UW_spreadsheets/2719102.ods\nfalse\ntrue\nhome/common/4000_UW_spreadsheets/2718427.ods\nfalse\ntrue\nhome/common/4000_UW_spreadsheets/2721372.ods\nfalse\ntrue\nhome/common/4000_UW_spreadsheets/2718986.ods\nfalse\ntrue\nhome/common/4000_UW_spreadsheets/2718893.ods\nfalse\ntrue\nhome/common/4000_UW_spreadsheets/2719048.ods\nfalse\ntrue\nhome/common/4000_UW_spreadsheets/2719572.ods\nfalse\ntrue\nhome/common/4000_UW_spreadsheets/10853.ods\nfalse\ntrue\nhome/common/4000_UW_spreadsheets/2719161.ods\nfalse\ntrue\nhome/common/4000_UW_spreadsheets/2719764.ods\nfalse\ntrue\nhome/common/4000_UW_spreadsheets/2718473.ods\nfalse\ntrue\nhome/common/4000_UW_spreadsheets/2718712.ods\nfalse\ntrue\n</code></pre>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongodb", "mongoid", "replicaset"], "owner": {"reputation": 4959, "user_id": 532252, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf266ed2800cda3dc5745fb474932603?s=128&d=identicon&r=PG", "display_name": "Sergey Kishenin", "link": "https://stackoverflow.com/users/532252/sergey-kishenin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1453293409, "creation_date": 1453292718, "last_edit_date": 1453293409, "question_id": 34900026, "link": "https://stackoverflow.com/questions/34900026/read-preference-for-mongodb-queries-within-a-secondary-node", "title": "Read preference for Mongodb queries within a secondary node", "body": "<p>I know that it is possible run execure a single command within a secondary node like:</p>\n\n<pre><code>Mongoid.default_session.cluster.with_secondary do |node|\n  node.command(database, cmd)[\"result\"]\nend\n</code></pre>\n\n<p>But is there a way to perform a piece of code containing multiple database queries with Mongoid 3 like it is implemented in <a href=\"https://github.com/mongodb/mongo-ruby-driver/wiki/Read-Preference\" rel=\"nofollow\">mongo-ruby-driver</a></p>\n\n<pre><code>with_secondary do\n  user = User.find(id)\n  user.posts.each do |post|\n    post.comments.count\n  end\nend\n</code></pre>\n\n<p>so every query to be performed within secondary node?</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "crud"], "comments": [{"owner": {"reputation": 1874, "user_id": 347698, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/97a603e8b378256cd3f706912dbfd031?s=128&d=identicon&r=PG", "display_name": "chaitanya", "link": "https://stackoverflow.com/users/347698/chaitanya"}, "edited": false, "score": 0, "creation_date": 1453293746, "post_id": 34899762, "comment_id": 57536979, "body": "can you share your form code?"}, {"owner": {"reputation": 229, "user_id": 2151296, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/319652b3a817e01576f38ade68946668?s=128&d=identicon&r=PG", "display_name": "coreypizzle", "link": "https://stackoverflow.com/users/2151296/coreypizzle"}, "reply_to_user": {"reputation": 1874, "user_id": 347698, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/97a603e8b378256cd3f706912dbfd031?s=128&d=identicon&r=PG", "display_name": "chaitanya", "link": "https://stackoverflow.com/users/347698/chaitanya"}, "edited": false, "score": 0, "creation_date": 1453295086, "post_id": 34899762, "comment_id": 57537831, "body": "updated the code with the form"}, {"owner": {"reputation": 1874, "user_id": 347698, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/97a603e8b378256cd3f706912dbfd031?s=128&d=identicon&r=PG", "display_name": "chaitanya", "link": "https://stackoverflow.com/users/347698/chaitanya"}, "edited": false, "score": 0, "creation_date": 1453295926, "post_id": 34899762, "comment_id": 57538372, "body": "change this line from &lt;%= fields_for &quot;user[]&quot;, user do |f| %&gt;   to   &lt;%= fields_for &quot;user[user_ids][]&quot;, user do |f| %&gt; and user_ids to permit or paste log result"}, {"owner": {"reputation": 229, "user_id": 2151296, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/319652b3a817e01576f38ade68946668?s=128&d=identicon&r=PG", "display_name": "coreypizzle", "link": "https://stackoverflow.com/users/2151296/coreypizzle"}, "reply_to_user": {"reputation": 1874, "user_id": 347698, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/97a603e8b378256cd3f706912dbfd031?s=128&d=identicon&r=PG", "display_name": "chaitanya", "link": "https://stackoverflow.com/users/347698/chaitanya"}, "edited": false, "score": 0, "creation_date": 1453296967, "post_id": 34899762, "comment_id": 57539076, "body": "Even after permitting user_ids I still get the log error <code>Unpermitted parameter: user_ids Unpermitted parameter: user_ids Unpermitted parameter: user_ids Unpermitted parameter: user_ids</code>"}, {"owner": {"reputation": 168, "user_id": 1976932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RSWmZ.jpg?s=128&g=1", "display_name": "nmeylan", "link": "https://stackoverflow.com/users/1976932/nmeylan"}, "edited": false, "score": 0, "creation_date": 1453299590, "post_id": 34899762, "comment_id": 57540992, "body": "How have you permitted user_ids?  Like this :      <code>def user_params       params.require(:user).permit(user_ids: [:role_id, :username, :password, :password_confirmation, :monday, :tuesday, :wednesday, :thursday, :friday, :saturday, :sunday])     end</code>"}, {"owner": {"reputation": 229, "user_id": 2151296, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/319652b3a817e01576f38ade68946668?s=128&d=identicon&r=PG", "display_name": "coreypizzle", "link": "https://stackoverflow.com/users/2151296/coreypizzle"}, "edited": false, "score": 0, "creation_date": 1453302785, "post_id": 34899762, "comment_id": 57543353, "body": "Yes, however as collection_params contains all users&#39; attributes, I need these indivdual attributes to update for a user depending on their user_ids, not to actually update the collection, how would I do this? As at the moment I am receiving the error <code>unknown attribute &#39;user_ids&#39; for User.</code>"}], "owner": {"reputation": 229, "user_id": 2151296, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/319652b3a817e01576f38ade68946668?s=128&d=identicon&r=PG", "display_name": "coreypizzle", "link": "https://stackoverflow.com/users/2151296/coreypizzle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1453295056, "creation_date": 1453291941, "last_edit_date": 1453295056, "question_id": 34899762, "link": "https://stackoverflow.com/questions/34899762/updating-a-collection-of-users", "title": "Updating a collection of users", "body": "<p>In my app I require a group of users to be updated simultaneously via one submit button. However in my console whenever I press submit, I get the error, </p>\n\n<p><code>Unpermitted parameters: 1, 3, 4, 2\n Unpermitted parameters: 1, 3, 4, 2\n Unpermitted parameters: 1, 3, 4, 2\n Unpermitted parameters: 1, 3, 4, 2\n Unpermitted parameters: 1, 3, 4, 2</code></p>\n\n<p>The Update_collection looks like so :</p>\n\n<p><code>Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"GWT/QI3w/uqcsTAy58iPRfb4UqVNn5+cExQuKx72uJ9W3t0CrkkkOvDc4ZvVS7Uh88JtQ7awenoERT/qww37eQ==\", \"user\"=&gt;{\"1\"=&gt;{\"username\"=&gt;\"Bob\", \"sunday\"=&gt;\"8\", \"monday\"=&gt;\"7\", \"tuesday\"=&gt;\"09\", \"wednesday\"=&gt;\"986\", \"thursday\"=&gt;\"765\", \"friday\"=&gt;\"321\", \"saturday\"=&gt;\"432\"}, \"3\"=&gt;{\"username\"=&gt;\"Mike\", \"sunday\"=&gt;\"76\", \"monday\"=&gt;\"098\", \"tuesday\"=&gt;\"40\", \"wednesday\"=&gt;\"243\", \"thursday\"=&gt;\"986\", \"friday\"=&gt;\"7536\", \"saturday\"=&gt;\"07\"}, \"4\"=&gt;{\"username\"=&gt;\"George\", \"sunday\"=&gt;\"\", \"monday\"=&gt;\"\", \"tuesday\"=&gt;\"\", \"wednesday\"=&gt;\"\", \"thursday\"=&gt;\"\", \"friday\"=&gt;\"\", \"saturday\"=&gt;\"\"}, \"2\"=&gt;{\"username\"=&gt;\"Admin\", \"sunday\"=&gt;\"\", \"monday\"=&gt;\"\", \"tuesday\"=&gt;\"\", \"wednesday\"=&gt;\"\", \"thursday\"=&gt;\"\", \"friday\"=&gt;\"\", \"saturday\"=&gt;\"\"}}, \"commit\"=&gt;\"Submit\"}</code></p>\n\n<p>I am supposing that where it states, <code>\"user\"=&gt;{\"1\"=&gt;{etc...}}</code> is where my problem is originating from, but considering these are dynamic hashes I have no clue as to how to permit them, and even after permitting them, I do not want them to be updated as they do not belong to the individual user model just the array itself.</p>\n\n<p>users_controller.rb</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n#  before_filter :authenticate_user! \n  before_action :set_user, only: [:show, :edit, :update, :destroy]\n\n  # GET /users\n  # GET /users.json\n  def index\n    @users = User.all\n  end\n\n  # GET /users/1\n  # GET /users/1.json\n  def show\n  end\n\n  # GET /users/new\n  def new\n    @user = User.new\n  end\n\n  def update_collection\n    @users = User.all\n    @users.each do |user|\n      if collect_params[:password].blank?\n        collect_params.delete(:password)\n        collect_params.delete(:password_confirmation)\n      end\n\n      successfully_updated = if needs_password?(user, collect_params)\n                             user.update(collect_params)\n                           else\n                             user.update_without_password(collect_params)\n                           end\n\n      #respond_to do |format|\n        #if user.update(collect_params)\n          #format.html { redirect_to user, notice: 'User was successfully updated.' }\n          #format.json { render :show, status: :ok, location: user }\n       # else\n          #format.html { render :edit }\n         # format.json { render json: user.errors, status: :unprocessable_entity }\n        #end\n      #end\n    end\n  end\n\n  # GET /users/1/edit\n  def edit\n  end\n\n  # POST /users\n  # POST /users.json\n  def create\n    @user = User.new(user_params)\n\n    respond_to do |format|\n      if @user.save\n        format.html { redirect_to @user, notice: 'User was successfully created.' }\n        format.json { render :show, status: :created, location: @user }\n      else\n        format.html { render :new }\n        format.json { render json: @user.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PATCH/PUT /users/1\n  # PATCH/PUT /users/1.json\n  def update\n    if user_params[:password].blank?\n      user_params.delete(:password)\n      user_params.delete(:password_confirmation)\n    end\n\n    successfully_updated = if needs_password?(@user, user_params)\n                           @user.update(user_params)\n                         else\n                           @user.update_without_password(user_params)\n                         end\n    respond_to do |format|\n      if @user.update(user_params)\n        format.html { redirect_to @user, notice: 'User was successfully updated.' }\n        format.json { render :show, status: :ok, location: @user }\n      else\n        format.html { render :edit }\n        format.json { render json: @user.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  protected\n\n    def needs_password?(user, params)\n      params[:password].present?\n    end\n\n  # DELETE /users/1\n  # DELETE /users/1.json\n  def destroy\n    @user.destroy\n    respond_to do |format|\n      format.html { redirect_to users_url, notice: 'User was successfully destroyed.' }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_user\n      @user = User.find(params[:id])\n    end\n\n    def collect_params\n      params.require(:user).permit(:role_id, :username, :password, :password_confirmation, :monday, :tuesday, :wednesday, :thursday, :friday, :saturday, :sunday)\n    end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    def user_params\n      params.require(:user).permit(:role_id, :username, :password, :password_confirmation, :monday, :tuesday, :wednesday, :thursday, :friday, :saturday, :sunday)\n    end\n\n\n\nend\n</code></pre>\n\n<p>My form code:</p>\n\n<pre><code>&lt;%= form_tag update_collection_users_path, method: :put do |form| %&gt;\n  &lt;% @users.each do |user| %&gt;\n    &lt;%= fields_for \"user[]\", user do |f| %&gt;\n      &lt;% if @user.errors.any? %&gt;\n        &lt;div id=\"error_explanation\"&gt;\n          &lt;h2&gt;&lt;%= pluralize(@user.errors.count, \"error\") %&gt; prohibited this user from being saved:&lt;/h2&gt;\n          &lt;ul&gt;\n          &lt;% @user.errors.full_messages.each do |message| %&gt;\n            &lt;li&gt;&lt;%= message %&gt;&lt;/li&gt;\n          &lt;% end %&gt;\n          &lt;/ul&gt;\n        &lt;/div&gt;\n      &lt;% end %&gt;\n      &lt;div class=\"field\"&gt;\n        &lt;%= f.label :username %&gt;&lt;br&gt;\n        &lt;%= f.text_field :username %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"field\"&gt;\n        &lt;%= f.label :sunday %&gt;&lt;br&gt;\n        &lt;%= f.text_field :sunday %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"field\"&gt;\n        &lt;%= f.label :monday %&gt;&lt;br&gt;\n        &lt;%= f.text_field :monday %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"field\"&gt;\n        &lt;%= f.label :tuesday %&gt;&lt;br&gt;\n        &lt;%= f.text_field :tuesday %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"field\"&gt;\n        &lt;%= f.label :wednesday %&gt;&lt;br&gt;\n        &lt;%= f.text_field :wednesday %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"field\"&gt;\n        &lt;%= f.label :thursday %&gt;&lt;br&gt;\n        &lt;%= f.text_field :thursday %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"field\"&gt;\n        &lt;%= f.label :friday %&gt;&lt;br&gt;\n        &lt;%= f.text_field :friday %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"field\"&gt;\n        &lt;%= f.label :saturday %&gt;&lt;br&gt;\n        &lt;%= f.text_field :saturday %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"actions\"&gt;\n        &lt;%= f.submit %&gt;\n      &lt;/div&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n  &lt;%= submit_tag \"Submit\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 1, "creation_date": 1453292843, "post_id": 34899491, "comment_id": 57536353, "body": "Have a look at this article <a href=\"http://www.rubyinside.com/what-rubys-double-pipe-or-equals-really-does-5488.html\" rel=\"nofollow noreferrer\">What Ruby\u2019s ||= (Double Pipe / Or Equals) Really Does</a>"}], "answers": [{"comments": [{"owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 0, "creation_date": 1453291722, "post_id": 34899608, "comment_id": 57535566, "body": "Instead of <code>if !@current_user</code>, you may want to use <code>if @current_user.nil?</code>"}, {"owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 2, "creation_date": 1453291885, "post_id": 34899608, "comment_id": 57535671, "body": "No worries,  I was thinking if OP has confusion with respect to boolean return values when non-boolean variables are used, then, it would help to avoid such expression..  I like the way you simplified the whole expression - except for <code>!</code> usage."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 1, "creation_date": 1453292061, "post_id": 34899608, "comment_id": 57535805, "body": "@WandMaker: btw, your proposed code is not what <code>||=</code> operator actually does. :)"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1453294189, "post_id": 34899608, "comment_id": 57537229, "body": "You could replace <code>if !</code> with <code>unless</code>"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 3, "last_activity_date": 1453291521, "creation_date": 1453291521, "answer_id": 34899608, "question_id": 34899491, "link": "https://stackoverflow.com/questions/34899491/ruby-rails-method-evaluation-query/34899608#34899608", "title": "Ruby Rails method evaluation query", "body": "<pre><code>@current_user ||= User.find(session[:user_id]) if session[:user_id] \n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>if session[:user_id]\n  if !@current_user\n    @current_user = User.find(session[:user_id])\n  end\n  @current_user\nend\n</code></pre>\n\n<p>This expression results in</p>\n\n<ol>\n<li>user object - when there's <code>session[:user_id]</code></li>\n<li>nil - when there's no <code>session[:user_id]</code></li>\n<li>exception - when there's <code>session[:user_id]</code>, but it does not correspond to any existing user in the DB.</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1453294382, "post_id": 34900373, "comment_id": 57537351, "body": "The modifier <code>if</code> is evaluated before the conditional assignment, i.e. the expression <code>a ||= b if c</code> is equivalent to <code>(a ||= b) if c</code>, not <code>a ||= (b if c)</code>."}, {"owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 1, "creation_date": 1453299210, "post_id": 34900373, "comment_id": 57540719, "body": "Your answer is difficult to comprehend - you may want to read it again and see if you want to re-phrase it for clarity."}], "tags": [], "owner": {"reputation": 1201, "user_id": 5097493, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/95b290a191545edb4077adfaab317f1a?s=128&d=identicon&r=PG&f=1", "display_name": "RuNpiXelruN", "link": "https://stackoverflow.com/users/5097493/runpixelrun"}, "is_accepted": false, "score": 1, "last_activity_date": 1453293676, "creation_date": 1453293676, "answer_id": 34900373, "question_id": 34899491, "link": "https://stackoverflow.com/questions/34899491/ruby-rails-method-evaluation-query/34900373#34900373", "title": "Ruby Rails method evaluation query", "body": "<p>It's basically saying to set @current_user, but if it doesn't exist yet than do the following to set current user( the <code>||=</code> part). The next part is saying that if the current session has a user_id attached to it, ie <code>if session[:user_id]</code>, then find the user of this session based on that user_id and store them in the @current_user instance variable. </p>\n\n<p>Hope that helps</p>\n\n<p>Justin</p>\n"}], "owner": {"reputation": 121, "user_id": 5309869, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8fa800ba04f6ddd4070bfacaad10dfa4?s=128&d=identicon&r=PG&f=1", "display_name": "Stoob", "link": "https://stackoverflow.com/users/5309869/stoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 34899608, "answer_count": 2, "score": 2, "last_activity_date": 1453293676, "creation_date": 1453291269, "question_id": 34899491, "link": "https://stackoverflow.com/questions/34899491/ruby-rails-method-evaluation-query", "title": "Ruby Rails method evaluation query", "body": "<p>I am trying to understand how exactly the following method works and what it is saying, I know what it does, but I want to grasp the exact workings of it. I think I understand the =|| operator but I'm not 100% clear on how the 'if' on the second half of the equation works:</p>\n\n<pre><code>def current_user \n  @current_user ||= User.find(session[:user_id]) if session[:user_id] \nend\n</code></pre>\n\n<p>The method checks to see if the current user is logged in.</p>\n\n<p>To my understanding it evaluates to either true or false but I'm not sure exactly how!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "ruby-on-rails-4.2", "ruby-on-rails-4.1"], "comments": [{"owner": {"reputation": 995, "user_id": 2576714, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RcYff.jpg?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/2576714/tim"}, "edited": false, "score": 0, "creation_date": 1453291310, "post_id": 34899096, "comment_id": 57535263, "body": "So what have you considered already?"}], "answers": [{"tags": [], "owner": {"reputation": 4744, "user_id": 2301092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1pBf.jpg?s=128&g=1", "display_name": "Bruno Paulino", "link": "https://stackoverflow.com/users/2301092/bruno-paulino"}, "is_accepted": false, "score": 0, "last_activity_date": 1453291503, "creation_date": 1453291503, "answer_id": 34899598, "question_id": 34899096, "link": "https://stackoverflow.com/questions/34899096/how-to-upload-and-mail-the-same-attachment-file-in-rails-4/34899598#34899598", "title": "How to upload and mail the same attachment file in rails 4?", "body": "<p>For uploading, you can use the <a href=\"https://github.com/carrierwaveuploader/carrierwave\" rel=\"nofollow\">CarrierWave</a> library. Is pretty easy to use. And for sending an Email, you can follow <a href=\"https://www.railstutorial.org/book/account_activation_password_reset#cha-account_activation_and_password_reset\" rel=\"nofollow\">this part</a> of the <a href=\"https://www.railstutorial.org/book\" rel=\"nofollow\">Rails Tutorial Book</a> which shows you how to setup and send emails.</p>\n"}], "owner": {"reputation": 966, "user_id": 4022276, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2190f46aee316f2599e8eb67be88ad83?s=128&d=identicon&r=PG&f=1", "display_name": "Priyank Dey", "link": "https://stackoverflow.com/users/4022276/priyank-dey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1453291503, "creation_date": 1453290191, "question_id": 34899096, "link": "https://stackoverflow.com/questions/34899096/how-to-upload-and-mail-the-same-attachment-file-in-rails-4", "title": "How to upload and mail the same attachment file in rails 4?", "body": "<p>I am using rails 4. </p>\n\n<p>Can any one please suggest , what is the best way to upload a pdf file and the same time mail this file?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-engines"], "comments": [{"owner": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "edited": false, "score": 0, "creation_date": 1453291169, "post_id": 34898999, "comment_id": 57535173, "body": "Pretty sure you&#39;ll need to use <code>EngineName::Dog.new(&quot;Labrador&quot;, &quot;Benzy&quot;)</code>"}, {"owner": {"reputation": 1007, "user_id": 5351714, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/ed8a93ea89809e3812bdfb926389ff96?s=128&d=identicon&r=PG&f=1", "display_name": "lolix", "link": "https://stackoverflow.com/users/5351714/lolix"}, "reply_to_user": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "edited": false, "score": 0, "creation_date": 1453292507, "post_id": 34898999, "comment_id": 57536135, "body": "Doest work same error @j-dexx"}, {"owner": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "edited": false, "score": 0, "creation_date": 1453295753, "post_id": 34898999, "comment_id": 57538254, "body": "Sounds like the environment isn&#39;t setup by the time the initializer runs so rails hasn&#39;t loaded in all the files yet."}, {"owner": {"reputation": 1007, "user_id": 5351714, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/ed8a93ea89809e3812bdfb926389ff96?s=128&d=identicon&r=PG&f=1", "display_name": "lolix", "link": "https://stackoverflow.com/users/5351714/lolix"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1453307527, "post_id": 34898999, "comment_id": 57546900, "body": "@engineersmnky I can&#39;t use application.rb. The file doesnt load"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1453323924, "post_id": 34898999, "comment_id": 57556637, "body": "Sorry I forgot this was an engine. Your issue is that you are just requiring the file wrong. Try adding <code>require &#39;dog&#39;</code> because <code>lib</code> will be considered the root for this."}], "answers": [{"comments": [{"owner": {"reputation": 1007, "user_id": 5351714, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/ed8a93ea89809e3812bdfb926389ff96?s=128&d=identicon&r=PG&f=1", "display_name": "lolix", "link": "https://stackoverflow.com/users/5351714/lolix"}, "edited": false, "score": 1, "creation_date": 1453292679, "post_id": 34899228, "comment_id": 57536258, "body": "my default engine.rb is: <code>module Alarm   class Engine &lt; ::Rails::Engine     isolate_namespace Alarm   end end</code> how can I add ?"}, {"owner": {"reputation": 1136, "user_id": 3352624, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fdf9f4bf095d710f263e5fb9f6298245?s=128&d=identicon&r=PG&f=1", "display_name": "davew", "link": "https://stackoverflow.com/users/3352624/davew"}, "edited": false, "score": 0, "creation_date": 1582923145, "post_id": 34899228, "comment_id": 106956754, "body": "I skimmed the guide you linked, but I think you&#39;re mistaken.  The code you are quoting is part of the Rails-specific <code>engine.rb</code> -- not the files the OP or myself are creating.  The problem the OP is referencing has to do with the fact that lib inside of engines aren&#39;t autoloaded by default (unlike in the main Rails app)."}], "tags": [], "owner": {"reputation": 609, "user_id": 5686527, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b17e0460ba70528719b2e99836bda939?s=128&d=identicon&r=PG&f=1", "display_name": "ftshtw", "link": "https://stackoverflow.com/users/5686527/ftshtw"}, "is_accepted": false, "score": 0, "last_activity_date": 1453290488, "creation_date": 1453290488, "answer_id": 34899228, "question_id": 34898999, "link": "https://stackoverflow.com/questions/34898999/mountable-engines-uninitialized-constant-customer-nameerror/34899228#34899228", "title": "Mountable Engines - uninitialized constant Customer (NameError)", "body": "<p>Have you followed the guide here ? <a href=\"http://guides.rubyonrails.org/engines.html\" rel=\"nofollow\">http://guides.rubyonrails.org/engines.html</a></p>\n\n<p>It says to include your class as:</p>\n\n<pre><code>module Dog\n  class Engine &lt; ::Rails::Engine\n  end\nend\n</code></pre>\n\n<p>but I don't believe this is only your case. You need to run through several steps, it isn't implemented as an ordinary Ruby library which is simply included. </p>\n"}, {"tags": [], "owner": {"reputation": 694, "user_id": 4247633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b489ee8b00fb53a9c49bef05f7b71120?s=128&d=identicon&r=PG", "display_name": "Deepak Kabbur", "link": "https://stackoverflow.com/users/4247633/deepak-kabbur"}, "is_accepted": false, "score": 1, "last_activity_date": 1454224929, "creation_date": 1454224929, "answer_id": 35111365, "question_id": 34898999, "link": "https://stackoverflow.com/questions/34898999/mountable-engines-uninitialized-constant-customer-nameerror/35111365#35111365", "title": "Mountable Engines - uninitialized constant Customer (NameError)", "body": "<p>I faced same issue , modules where not loading. Solved the issue by specifying autoload_path in engine.rb</p>\n\n<p>In engine <strong>lib/engien_name/engine.rb</strong></p>\n\n<pre><code>class Engine &lt; ::Rails::Engine\n    config.autoload_paths += %W(#{config.root}/lib/modules)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1136, "user_id": 3352624, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fdf9f4bf095d710f263e5fb9f6298245?s=128&d=identicon&r=PG&f=1", "display_name": "davew", "link": "https://stackoverflow.com/users/3352624/davew"}, "is_accepted": false, "score": 0, "last_activity_date": 1582926544, "creation_date": 1582926544, "answer_id": 60459695, "question_id": 34898999, "link": "https://stackoverflow.com/questions/34898999/mountable-engines-uninitialized-constant-customer-nameerror/60459695#60459695", "title": "Mountable Engines - uninitialized constant Customer (NameError)", "body": "<p>I ran into this same issue.  I found <a href=\"https://stackoverflow.com/a/43681766/3352624\">this</a> answer helpful.</p>\n\n<p>Basically, the issue you are experiencing is caused by the fact that lib isn't autoloaded in engines in the way that lib is for the main Rails app.</p>\n\n<p>From the referenced link, I found 2 solutions for this.</p>\n\n<p><strong>Option 1: Autoloading</strong></p>\n\n<p>You can enable autoloading for your engine's lib folder by editing your engine's <code>engine.rb</code> file in the engine's lib.  See <a href=\"https://api.rubyonrails.org/classes/Rails/Engine.html\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/classes/Rails/Engine.html</a> (section on Configuration).</p>\n\n<p>Basically add <code>config.autoload_paths &lt;&lt; File.expand_path(\"lib/some/path\", __dir__)</code> to your engine.rb file.  In my case, since my files were in the same folder as my engine.rb file, I used <code>config.autoload_paths &lt;&lt; File.expand_path('.', __dir__)</code></p>\n\n<p><strong>Option 2: Require</strong></p>\n\n<p>If you want to avoid altering autoloading, you can require the file where it is needed.  Just add <code>require 'my_engine/class_or_module_needed'</code> to the top of the file it is needed in.</p>\n"}], "owner": {"reputation": 1007, "user_id": 5351714, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/ed8a93ea89809e3812bdfb926389ff96?s=128&d=identicon&r=PG&f=1", "display_name": "lolix", "link": "https://stackoverflow.com/users/5351714/lolix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2723, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1582926544, "creation_date": 1453289902, "question_id": 34898999, "link": "https://stackoverflow.com/questions/34898999/mountable-engines-uninitialized-constant-customer-nameerror", "title": "Mountable Engines - uninitialized constant Customer (NameError)", "body": "<p>I created a Mountable Engine after this I created a file class in lib.</p>\n\n<p>Like this: </p>\n\n<p>path:   <code>/lib/dog.rb</code></p>\n\n<p>class:</p>\n\n<pre><code>    class Dog\n      def initialize(breed, name)\n      @breed = breed\n      @name = name\n    end\n\n    def bark\n      puts 'Ruff! Ruff!'\n    end\n\n    def display\n      puts \"I am of #{@breed} breed and my name is #{@name}\"\n    end\n    end  \n</code></pre>\n\n<p>I have a initializer in \n    <code>/config/initializers/scheduler.rb</code> with the content:</p>\n\n<pre><code>d = Dog.new('Labrador', 'Benzy')\n</code></pre>\n\n<p>When I initiate my rails app I receive this error:</p>\n\n<pre><code>uninitialized constant Dog (NameError)\n</code></pre>\n\n<p>I tried create a application.rb file in /config/ with the content <code>require '/lib/customer.rb'</code> or <code>require 'rails/all'</code> but doesn't work.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "testing", "rspec"], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 0, "last_activity_date": 1453290095, "creation_date": 1453290095, "answer_id": 34899066, "question_id": 34898727, "link": "https://stackoverflow.com/questions/34898727/what-is-subject-invoke-in-rspec/34899066#34899066", "title": "What is subject.invoke in rspec?", "body": "<p><code>subject</code> is the return value of the <code>subject</code> block in the current context. If you there is a block like this</p>\n\n<pre><code>subject { Foo.new }\n</code></pre>\n\n<p>then a <code>subject</code> call in the example would return the new <code>Foo</code> instance. </p>\n\n<p>The following <code>invoke</code> is just calling <code>invoke</code> on the <code>subject</code>. Therefore it depends on the implementation of the subject.</p>\n"}, {"tags": [], "owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "is_accepted": false, "score": 2, "last_activity_date": 1453290285, "creation_date": 1453290285, "answer_id": 34899131, "question_id": 34898727, "link": "https://stackoverflow.com/questions/34898727/what-is-subject-invoke-in-rspec/34899131#34899131", "title": "What is subject.invoke in rspec?", "body": "<p>This will be really hard to answer this question for one specific reason - <code>subject</code> can be anything and it is defined in your test.</p>\n\n<p>There are two ways <code>subject</code> can be defined - implicitly or explicitly. Implicitly, it uses a class used in a top-most <code>describe</code>, so if you have:</p>\n\n<pre><code>describe MyClass do\n  it 'works' do\n    subject\n  end\nend\n</code></pre>\n\n<p><code>subject</code> will execute <code>MyClass.new</code> and will cache the result so every subsequent call to subject will return the same object.</p>\n\n<p>You can override the default subject using explicit <code>subject</code> definition:</p>\n\n<pre><code>describe MyClass do\n  subject { described_class.new some: \"extra-params\" }\n  it 'works' do\n    subject\n  end\nend\n</code></pre>\n\n<p>So, <code>subject.invoke</code> is jest executing <code>invoke</code> method on whatever object your subject is. You will need to find out what your <code>subject</code> is and find its class to get to the definition of <code>invoke</code></p>\n"}], "owner": {"reputation": 1, "user_id": 5379622, "user_type": "registered", "profile_image": "https://graph.facebook.com/1718251129/picture?type=large", "display_name": "Dmitry Chopey", "link": "https://stackoverflow.com/users/5379622/dmitry-chopey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 875, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1453290285, "creation_date": 1453289142, "last_edit_date": 1453289711, "question_id": 34898727, "link": "https://stackoverflow.com/questions/34898727/what-is-subject-invoke-in-rspec", "title": "What is subject.invoke in rspec?", "body": "<p>Accordingly to <code>rails 4.2.4</code> and <code>rspec 3.4</code> upgrading, I am fixing specs in large application. Previous developers used <code>subject.invoke</code>, but now seems like it doesn't work. What is <code>subject.invoke</code> and how I can substitute it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "bit-manipulation", "bitmask"], "comments": [{"owner": {"reputation": 11138, "user_id": 1015327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=128&d=identicon&r=PG", "display_name": "JimmyB", "link": "https://stackoverflow.com/users/1015327/jimmyb"}, "edited": false, "score": 2, "creation_date": 1453291951, "post_id": 34898688, "comment_id": 57535725, "body": "&quot;how else can this use case be approached other than an intermediate normalized table? &quot; - In a generic RDBMS, it can&#39;t. Use the n:m relation and head on."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1453295140, "post_id": 34898688, "comment_id": 57537887, "body": "<i>&quot;bigger id values&quot;</i>? <code>2 ** 140</code> already exceeds <a href=\"https://dev.mysql.com/doc/refman/en/integer-types.html\" rel=\"nofollow noreferrer\">MySQL&#39;s BIGINT</a>."}, {"owner": {"reputation": 315, "user_id": 1180403, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f1d1e23f34f4690bd9fc8f704173f1a0?s=128&d=identicon&r=PG", "display_name": "vijay", "link": "https://stackoverflow.com/users/1180403/vijay"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1453658067, "post_id": 34898688, "comment_id": 57687710, "body": "@Stefan I meant if &quot;ID&quot; column is a bigint, bitmasking is a big no-no. (2**140 can be stored in a text column though.)  Calculating the powers will not even be possible is my point. Using an intermediate normalized table (as I have no other choice) with n:m."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1453708643, "post_id": 34898688, "comment_id": 57703532, "body": "@vijay that is correct, but unrelated to the column type. The bit-mask exceeds BIGINT once you have more than 64 users (or more precisely a user ID &gt; 64)."}], "owner": {"reputation": 315, "user_id": 1180403, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f1d1e23f34f4690bd9fc8f704173f1a0?s=128&d=identicon&r=PG", "display_name": "vijay", "link": "https://stackoverflow.com/users/1180403/vijay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 232, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1453289029, "creation_date": 1453289029, "last_edit_date": 1495541716, "question_id": 34898688, "link": "https://stackoverflow.com/questions/34898688/bitmasking-alternatives-in-ruby", "title": "Bitmasking alternatives in Ruby", "body": "<p>I'm trying to achieve a simple use case, where I need to restrict a comment only to those users who are mentioned in it. I'm trying to use bitmasking in ruby to control the access. I'm using the stored 'id' value of users in the database to calculate the binary values. </p>\n\n<p>[For eg, say example1@example.com's id is 140, I do a 2 ** 140 and store the hash. I allow access by doing a bitwise AND (&amp;) with the hash and if the value is not zero. Please check this link:  <a href=\"https://stackoverflow.com/questions/3867714/bit-banging-in-ruby\">Bit banging in ruby</a> </p>\n\n<p>Now, the problem is when I have bigger id values (clearly if id column is a bigint, bitmasking is a big no-no). Is there any solution to this problem? If not bitmapping, how else can this use case be approached other than an intermediate normalized table? </p>\n"}, {"tags": ["ruby", "capybara", "minitest"], "answers": [{"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 0, "last_activity_date": 1453312873, "creation_date": 1453312873, "answer_id": 34907265, "question_id": 34898540, "link": "https://stackoverflow.com/questions/34898540/minitest-capybara-how-to-do-save-and-open-page-when-there-is-an-error/34907265#34907265", "title": "minitest + capybara how to do save_and_open_page when there is an error", "body": "<p>You can do this in a teardown or after_teardown block by checking !passed?</p>\n\n<p>The capybara-screenshot gem provides this behavior and is compatible with both RSpec and minitest, you can see how it implements the behavior here - <a href=\"https://github.com/mattheworiordan/capybara-screenshot/blob/master/lib/capybara-screenshot/minitest.rb\" rel=\"nofollow\">https://github.com/mattheworiordan/capybara-screenshot/blob/master/lib/capybara-screenshot/minitest.rb</a></p>\n"}], "owner": {"reputation": 2842, "user_id": 599686, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6e2b017e2266ab3c15e0439a1ca10946?s=128&d=identicon&r=PG", "display_name": "bliof", "link": "https://stackoverflow.com/users/599686/bliof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "accepted_answer_id": 34907265, "answer_count": 1, "score": 1, "last_activity_date": 1453312873, "creation_date": 1453288590, "question_id": 34898540, "link": "https://stackoverflow.com/questions/34898540/minitest-capybara-how-to-do-save-and-open-page-when-there-is-an-error", "title": "minitest + capybara how to do save_and_open_page when there is an error", "body": "<p>When using <code>rspec</code> I usually do something like:</p>\n\n<pre><code>if ENV['OPEN_ERRORS']\n  shown_error_pages = 0\n\n  config.after :each do\n    if RSpec.current_example.exception != nil and shown_error_pages == 0\n      shown_error_pages += 1\n      save_and_open_page\n    end\n  end\nend\n</code></pre>\n\n<p>e.g. <code>OPEN_ERRORS=1 bundle exec rspec</code></p>\n\n<p>How can I do something like this with minitest?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "validation"], "comments": [{"owner": {"reputation": 1874, "user_id": 347698, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/97a603e8b378256cd3f706912dbfd031?s=128&d=identicon&r=PG", "display_name": "chaitanya", "link": "https://stackoverflow.com/users/347698/chaitanya"}, "edited": false, "score": 0, "creation_date": 1453289278, "post_id": 34898302, "comment_id": 57534006, "body": "any reason why are you using custom validator? otherwise in one line your work will be done. eg. validates_uniqueness_of :email, :on =&gt; :create"}, {"owner": {"reputation": 883, "user_id": 4965201, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/305f81f75cbae6b8177ecaa1e681f7dd?s=128&d=identicon&r=PG&f=1", "display_name": "user4965201", "link": "https://stackoverflow.com/users/4965201/user4965201"}, "reply_to_user": {"reputation": 1874, "user_id": 347698, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/97a603e8b378256cd3f706912dbfd031?s=128&d=identicon&r=PG", "display_name": "chaitanya", "link": "https://stackoverflow.com/users/347698/chaitanya"}, "edited": false, "score": 0, "creation_date": 1453290126, "post_id": 34898302, "comment_id": 57534514, "body": "this is because rails is not accepting the :on =&gt; :create in the ActiveModel::Validations , i dont know why"}, {"owner": {"reputation": 1874, "user_id": 347698, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/97a603e8b378256cd3f706912dbfd031?s=128&d=identicon&r=PG", "display_name": "chaitanya", "link": "https://stackoverflow.com/users/347698/chaitanya"}, "edited": false, "score": 0, "creation_date": 1453290318, "post_id": 34898302, "comment_id": 57534619, "body": "which rails version are you using?"}, {"owner": {"reputation": 1201, "user_id": 5097493, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/95b290a191545edb4077adfaab317f1a?s=128&d=identicon&r=PG&f=1", "display_name": "RuNpiXelruN", "link": "https://stackoverflow.com/users/5097493/runpixelrun"}, "edited": false, "score": 0, "creation_date": 1453290424, "post_id": 34898302, "comment_id": 57534683, "body": "Yeah just out of curiosity, how come you are not simply doing <code>validates :email, uniqueness: true, on: :create</code> ?"}, {"owner": {"reputation": 883, "user_id": 4965201, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/305f81f75cbae6b8177ecaa1e681f7dd?s=128&d=identicon&r=PG&f=1", "display_name": "user4965201", "link": "https://stackoverflow.com/users/4965201/user4965201"}, "edited": false, "score": 0, "creation_date": 1453290460, "post_id": 34898302, "comment_id": 57534707, "body": "i am using rails 4.2.1"}, {"owner": {"reputation": 1201, "user_id": 5097493, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/95b290a191545edb4077adfaab317f1a?s=128&d=identicon&r=PG&f=1", "display_name": "RuNpiXelruN", "link": "https://stackoverflow.com/users/5097493/runpixelrun"}, "edited": false, "score": 0, "creation_date": 1453290682, "post_id": 34898302, "comment_id": 57534839, "body": "You should really whitelist your accepted attributes also, instead of using attr_accessor."}, {"owner": {"reputation": 1874, "user_id": 347698, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/97a603e8b378256cd3f706912dbfd031?s=128&d=identicon&r=PG", "display_name": "chaitanya", "link": "https://stackoverflow.com/users/347698/chaitanya"}, "edited": false, "score": 0, "creation_date": 1453291221, "post_id": 34898302, "comment_id": 57535205, "body": "this issue belongs to devise please refer this link <a href=\"http://stackoverflow.com/questions/7097921/devise-how-to-change-setting-so-that-email-addresses-dont-need-to-be-unique\" title=\"devise how to change setting so that email addresses dont need to be unique\">stackoverflow.com/questions/7097921/&hellip;</a>"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1453299243, "post_id": 34898302, "comment_id": 57540741, "body": "@user4965201: Your example is a plain Ruby class and does not inherit from <code>ActiveRecord</code>. How do you define <code>on: :create</code> or <code>on: :update</code> in this context if there is no persistence layer?"}], "answers": [{"comments": [{"owner": {"reputation": 883, "user_id": 4965201, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/305f81f75cbae6b8177ecaa1e681f7dd?s=128&d=identicon&r=PG&f=1", "display_name": "user4965201", "link": "https://stackoverflow.com/users/4965201/user4965201"}, "edited": false, "score": 0, "creation_date": 1453288425, "post_id": 34898410, "comment_id": 57533363, "body": "i am getting NoMethodError (undefined method `new_record?&#39; for UserValidator:Class):"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1453291870, "post_id": 34898410, "comment_id": 57535662, "body": "You cannot provide a block like that: You would have to provide a <code>Proc</code> that takes an argument (<code>if: Proc.new { |user| user.new_record? }</code>) or use a simple symbol (<code>id: :new_record?</code>)"}], "tags": [], "owner": {"reputation": 168, "user_id": 1976932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RSWmZ.jpg?s=128&g=1", "display_name": "nmeylan", "link": "https://stackoverflow.com/users/1976932/nmeylan"}, "is_accepted": false, "score": 0, "last_activity_date": 1453291954, "last_edit_date": 1453291954, "creation_date": 1453288188, "answer_id": 34898410, "question_id": 34898302, "link": "https://stackoverflow.com/questions/34898302/rails-active-model-validator-not-accepting-on-create/34898410#34898410", "title": "Rails Active model validator not accepting :on =&gt; :create", "body": "<p>You can do something like :</p>\n\n<pre><code>validates :email, :presence =&gt; {\n                  :message =&gt;  I18n.t(\"users.errors.email_blank\")\n              }, format: {\n                  with: /\\A([^@\\s]+)@((?:[-a-z0-9]+\\.)+[a-z]{2,})\\z/i,\n                  message: I18n.t(\"users.errors.email_format\")\n              }, :if =&gt; :new_record?\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1453291269, "creation_date": 1453291269, "answer_id": 34899490, "question_id": 34898302, "link": "https://stackoverflow.com/questions/34898302/rails-active-model-validator-not-accepting-on-create/34899490#34899490", "title": "Rails Active model validator not accepting :on =&gt; :create", "body": "<p>If you pass hashes to the validator options then the <code>:on</code> condition has to be part of the hashes:</p>\n\n<pre><code>validates :email, \n  presence: {\n    message:  I18n.t(\"users.errors.email_blank\"),\n    on: :create\n  }, \n  format: {\n    with: /\\A([^@\\s]+)@((?:[-a-z0-9]+\\.)+[a-z]{2,})\\z/i,\n    message: I18n.t(\"users.errors.email_format\"),\n    on: :create\n  },\n  uniqueness: { \n    on: :create \n  }\n</code></pre>\n\n<p>See the <a href=\"http://api.rubyonrails.org/classes/ActiveModel/Validations/ClassMethods.html#method-i-validates\" rel=\"nofollow\"><code>:email</code> example</a> in the documentation.</p>\n"}, {"tags": [], "owner": {"reputation": 1874, "user_id": 347698, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/97a603e8b378256cd3f706912dbfd031?s=128&d=identicon&r=PG", "display_name": "chaitanya", "link": "https://stackoverflow.com/users/347698/chaitanya"}, "is_accepted": false, "score": 0, "last_activity_date": 1453292204, "creation_date": 1453292204, "answer_id": 34899860, "question_id": 34898302, "link": "https://stackoverflow.com/questions/34898302/rails-active-model-validator-not-accepting-on-create/34899860#34899860", "title": "Rails Active model validator not accepting :on =&gt; :create", "body": "<p>If authentication is done with email using devise then you can't override it.</p>\n\n<pre><code>     # ==&gt; Configuration for any authentication mechanism\n  # Configure which keys are used when authenticating a user. The default is\n  # just :email.\n</code></pre>\n\n<p>You need to change it to :username or something else.\nYou can't accept same email again on update, devise will not allow you.</p>\n"}, {"comments": [{"owner": {"reputation": 883, "user_id": 4965201, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/305f81f75cbae6b8177ecaa1e681f7dd?s=128&d=identicon&r=PG&f=1", "display_name": "user4965201", "link": "https://stackoverflow.com/users/4965201/user4965201"}, "edited": false, "score": 0, "creation_date": 1453294981, "post_id": 34900637, "comment_id": 57537761, "body": "maybe you are trying in your model , i am doing this by making a new class and not inheriting ActiveRecord::Base"}], "tags": [], "owner": {"reputation": 177, "user_id": 1919592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EYMmY.jpg?s=128&g=1", "display_name": "Chitresh goyal", "link": "https://stackoverflow.com/users/1919592/chitresh-goyal"}, "is_accepted": false, "score": 0, "last_activity_date": 1453295611, "last_edit_date": 1453295611, "creation_date": 1453294482, "answer_id": 34900637, "question_id": 34898302, "link": "https://stackoverflow.com/questions/34898302/rails-active-model-validator-not-accepting-on-create/34900637#34900637", "title": "Rails Active model validator not accepting :on =&gt; :create", "body": "<p>I have tried to implement your validation in my code, and it's working absolute fine.</p>\n\n<pre><code>validates :email, :presence =&gt; {\n                      :message =&gt;  I18n.t(\"users.errors.email_blank\")\n                  }, format: {\n                      with: /\\A([^@\\s]+)@((?:[-a-z0-9]+\\.)+[a-z]{2,})\\z/i,\n                      message: I18n.t(\"users.errors.email_format\")\n                  }, :on =&gt; :create\n</code></pre>\n\n<p>I got this error on create:</p>\n\n<pre><code>2 errors prohibited this admin_about_me from being saved:\nStory title translation missing: en.users.errors.email_blank\nStory title translation missing: en.users.errors.email_format\n</code></pre>\n\n<p>and it successfully saved on update.</p>\n\n<p>I think you want to check email uniqueness on update as well.</p>\n\n<p>you should use this:</p>\n\n<pre><code>validates :email, \n  presence: {\n    message:  I18n.t(\"users.errors.email_blank\"),\n    on: :create\n  }, \n  format: {\n    with: /\\A([^@\\s]+)@((?:[-a-z0-9]+\\.)+[a-z]{2,})\\z/i,\n    message: I18n.t(\"users.errors.email_format\"),\n    on: :create\n  }\n  validates :email, uniqueness: true\n</code></pre>\n\n<p>Use below line for create or update  </p>\n\n<pre><code>validates :email, uniqueness: true, on: :update\nvalidates :email, uniqueness: true, on: :create\n</code></pre>\n"}], "owner": {"reputation": 883, "user_id": 4965201, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/305f81f75cbae6b8177ecaa1e681f7dd?s=128&d=identicon&r=PG&f=1", "display_name": "user4965201", "link": "https://stackoverflow.com/users/4965201/user4965201"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1453295611, "creation_date": 1453287898, "question_id": 34898302, "link": "https://stackoverflow.com/questions/34898302/rails-active-model-validator-not-accepting-on-create", "title": "Rails Active model validator not accepting :on =&gt; :create", "body": "<p>I have a User model and for that i have used a custom validator class and the code for custom validator class is given as </p>\n\n<p><strong>user_validator.rb</strong></p>\n\n<pre><code>class UserValidator\n  include ActiveModel::Validations\n\n  attr_accessor :first_name, :last_name, :email, :id\n  validates :first_name, :presence =&gt; {\n                           :message =&gt; I18n.t(\"users.errors.first_name_blank\")\n                       }\n  validates_length_of :first_name, :maximum =&gt; 64 , :message =&gt; I18n.t(\"users.errors.first_name_length\")\n\n  validates :last_name, :presence =&gt; {\n                          :message =&gt; I18n.t(\"users.errors.last_name_blank\")\n                      }\n  validates_length_of :last_name, :maximum =&gt; 64, message: I18n.t(\"users.errors.last_name_length\")\n  validates :email, :presence =&gt; {\n                      :message =&gt;  I18n.t(\"users.errors.email_blank\")\n                  }, format: {\n                      with: /\\A([^@\\s]+)@((?:[-a-z0-9]+\\.)+[a-z]{2,})\\z/i,\n                      message: I18n.t(\"users.errors.email_format\")\n                  }, :on =&gt; :create\n  validate :email_uniqueness\n\n  def initialize(attributes = {})\n    attributes.each do |name, value|\n      send(\"#{name}=\", value)\n    end\n  end\n\n  def persisted?\n    false\n  end\n\n  private\n\n  def email_uniqueness\n    if self.id.blank?\n      unless User.where(email: email).count == 0\n      errors.add(:email, I18n.t(\"users.errors.email_taken\"))\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>this custom validator class i have used in update and create action but in update action i am not using the email validation how can i use the email validation only on create , unfortunately rails is not accepting :on => :create in this  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "input", "radio-button", "field"], "comments": [{"owner": {"reputation": 1874, "user_id": 347698, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/97a603e8b378256cd3f706912dbfd031?s=128&d=identicon&r=PG", "display_name": "chaitanya", "link": "https://stackoverflow.com/users/347698/chaitanya"}, "edited": false, "score": 1, "creation_date": 1453286579, "post_id": 34897745, "comment_id": 57531983, "body": "in migration have you set default value for attendee?, if yes then it will never save nil value otherwise it will"}, {"owner": {"reputation": 59, "user_id": 4266137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eed8e347f19ceb46bfbdea27025cfc78?s=128&d=identicon&r=PG&f=1", "display_name": "schadock", "link": "https://stackoverflow.com/users/4266137/schadock"}, "reply_to_user": {"reputation": 1874, "user_id": 347698, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/97a603e8b378256cd3f706912dbfd031?s=128&d=identicon&r=PG", "display_name": "chaitanya", "link": "https://stackoverflow.com/users/347698/chaitanya"}, "edited": false, "score": 0, "creation_date": 1453286811, "post_id": 34897745, "comment_id": 57532166, "body": "I set nil as default value for attendee"}, {"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1453286966, "post_id": 34897745, "comment_id": 57532288, "body": "Can you add (in an edit to your question) the value of Params from submitting the form with &quot;Maybe&quot; ticked?  It will be in your log."}, {"owner": {"reputation": 1874, "user_id": 347698, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/97a603e8b378256cd3f706912dbfd031?s=128&d=identicon&r=PG", "display_name": "chaitanya", "link": "https://stackoverflow.com/users/347698/chaitanya"}, "edited": false, "score": 0, "creation_date": 1453287024, "post_id": 34897745, "comment_id": 57532332, "body": "i think try with &quot;Maybe&quot; =&gt; &quot;&quot;"}, {"owner": {"reputation": 59, "user_id": 4266137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eed8e347f19ceb46bfbdea27025cfc78?s=128&d=identicon&r=PG&f=1", "display_name": "schadock", "link": "https://stackoverflow.com/users/4266137/schadock"}, "reply_to_user": {"reputation": 1874, "user_id": 347698, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/97a603e8b378256cd3f706912dbfd031?s=128&d=identicon&r=PG", "display_name": "chaitanya", "link": "https://stackoverflow.com/users/347698/chaitanya"}, "edited": false, "score": 0, "creation_date": 1453287332, "post_id": 34897745, "comment_id": 57532554, "body": "@chaitanyasaraf thank you, your answer works :) make answer because I can&#39;t upvote"}, {"owner": {"reputation": 1874, "user_id": 347698, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/97a603e8b378256cd3f706912dbfd031?s=128&d=identicon&r=PG", "display_name": "chaitanya", "link": "https://stackoverflow.com/users/347698/chaitanya"}, "edited": false, "score": 0, "creation_date": 1453287608, "post_id": 34897745, "comment_id": 57532737, "body": "cool, please accept it"}, {"owner": {"reputation": 59, "user_id": 4266137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eed8e347f19ceb46bfbdea27025cfc78?s=128&d=identicon&r=PG&f=1", "display_name": "schadock", "link": "https://stackoverflow.com/users/4266137/schadock"}, "reply_to_user": {"reputation": 1874, "user_id": 347698, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/97a603e8b378256cd3f706912dbfd031?s=128&d=identicon&r=PG", "display_name": "chaitanya", "link": "https://stackoverflow.com/users/347698/chaitanya"}, "edited": false, "score": 0, "creation_date": 1453288169, "post_id": 34897745, "comment_id": 57533167, "body": "@chaitanyasaraf can you upvote question?"}], "answers": [{"comments": [{"owner": {"reputation": 598, "user_id": 1364071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfa4d54050b6bb4361df26452d251d0c?s=128&d=identicon&r=PG", "display_name": "pkurek", "link": "https://stackoverflow.com/users/1364071/pkurek"}, "edited": false, "score": 1, "creation_date": 1453292679, "post_id": 34898175, "comment_id": 57536259, "body": "Values can be potentially changed on client so you don&#39;t want to base your domain logic on client values. Since op mentioned that he already set the default value to nil - just accept params and filter out any values that are not true or false.   ``` def attendee_params   params.permit(attendence: [&quot;1&quot;, &quot;2&quot;])    #don&#39;t remember strong param api by heart so you would have to check it end ```"}], "tags": [], "owner": {"reputation": 1874, "user_id": 347698, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/97a603e8b378256cd3f706912dbfd031?s=128&d=identicon&r=PG", "display_name": "chaitanya", "link": "https://stackoverflow.com/users/347698/chaitanya"}, "is_accepted": false, "score": 2, "last_activity_date": 1453287589, "creation_date": 1453287589, "answer_id": 34898175, "question_id": 34897745, "link": "https://stackoverflow.com/questions/34897745/how-save-nil-in-database-using-radio-button/34898175#34898175", "title": "How save nil in database using radio button", "body": "<p>If boolean value is set default to true or false then it wont accepts null value, otherwise you can pass blank value to boolean field as suggested below. </p>\n\n<pre><code>= f.input :attendee, :as =&gt; :radio, :collection =&gt; { \"Yes\" =&gt; true, \"No\" =&gt; false, \"Maybe\" =&gt; \"\" }, :label =&gt; \"Attendence:\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 70080, "user_id": 38765, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/01bbb59a1c3ef9960f25a97afe7e920f?s=128&d=identicon&r=PG", "display_name": "Andrew Grimm", "link": "https://stackoverflow.com/users/38765/andrew-grimm"}, "edited": false, "score": 0, "creation_date": 1474503990, "post_id": 34898441, "comment_id": 66562243, "body": "For better or for worse, if you add a column of type boolean, by default null values are often accepted."}, {"owner": {"reputation": 73119, "user_id": 1143732, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mFUOI.jpg?s=128&g=1", "display_name": "Richard Peck", "link": "https://stackoverflow.com/users/1143732/richard-peck"}, "edited": false, "score": 0, "creation_date": 1474523571, "post_id": 34898441, "comment_id": 66567191, "body": "I had to set the default explicitly because Rails was acting weird with null values. I&#39;ve forgotten the specifics"}], "tags": [], "owner": {"reputation": 73119, "user_id": 1143732, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mFUOI.jpg?s=128&g=1", "display_name": "Richard Peck", "link": "https://stackoverflow.com/users/1143732/richard-peck"}, "is_accepted": true, "score": 1, "last_activity_date": 1453288261, "creation_date": 1453288261, "answer_id": 34898441, "question_id": 34897745, "link": "https://stackoverflow.com/questions/34897745/how-save-nil-in-database-using-radio-button/34898441#34898441", "title": "How save nil in database using radio button", "body": "<p><a href=\"https://en.wikipedia.org/wiki/Boolean_data_type\" rel=\"nofollow\">Boolean is <code>true/false</code></a>, you can't have <code>nil</code> (<code>nil</code> is treated as false):</p>\n\n<blockquote>\n  <p>In computer science, the Boolean data type is a data type, having two values (usually denoted true and false). <em>[[If not true, false]]</em></p>\n</blockquote>\n\n<p>You'd be better with an <a href=\"http://edgeapi.rubyonrails.org/classes/ActiveRecord/Enum.html\" rel=\"nofollow\"><code>enum</code></a>:</p>\n\n<pre><code>#app/models/model.rb\nclass Model &lt; ActiveRecord::Base\n   enum attendee: [:yes, :no, :maybe]\nend\n</code></pre>\n\n<p>This is slightly more bloated than using a <code>boolean</code>, but retains <a href=\"https://en.wikipedia.org/wiki/Data_integrity\" rel=\"nofollow\">data integrity</a> (you'll have to hack the Rails boolean to get it to recognize <code>nil</code> as <code>maybe</code>). <code>Enum</code> columns are <code>integers</code>, each <code>enum</code> being represented by a number...</p>\n\n<blockquote>\n  <p><code>yes = 0</code></p>\n  \n  <p><code>no  = 1</code></p>\n  \n  <p><code>maybe = 2</code></p>\n</blockquote>\n\n<p>This way, you'd be able to do the following:</p>\n\n<pre><code>= f.input :attendee, as: :radio, collection: Model.attendees, :label =&gt; \"Attendence:\"\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 4266137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eed8e347f19ceb46bfbdea27025cfc78?s=128&d=identicon&r=PG&f=1", "display_name": "schadock", "link": "https://stackoverflow.com/users/4266137/schadock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1126, "favorite_count": 0, "accepted_answer_id": 34898441, "answer_count": 2, "score": 2, "last_activity_date": 1453288261, "creation_date": 1453286471, "question_id": 34897745, "link": "https://stackoverflow.com/questions/34897745/how-save-nil-in-database-using-radio-button", "title": "How save nil in database using radio button", "body": "<p>I have radio button and I want use it for saving attendance information:\nyes, no, maybe</p>\n\n<p>Code in HAML: </p>\n\n<pre><code>= f.input :attendee, :as =&gt; :radio, :collection =&gt; { \"Yes\" =&gt; true, \"No\" =&gt; false, \"Maybe\" =&gt; nil }, :label =&gt; \"Attendence:\"\n</code></pre>\n\n<p>Field attendee in database is boolean type.\nWhen I change my value from Yes/No to Maybe rails didnt save 'nil' in database. What I should do to save 'nil'</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "cucumber", "capybara", "capybara-webkit"], "answers": [{"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 2, "last_activity_date": 1453308606, "creation_date": 1453308606, "answer_id": 34905813, "question_id": 34896915, "link": "https://stackoverflow.com/questions/34896915/capybara-cucumber-feature-with-expected-controller-exceptions-fails/34905813#34905813", "title": "Capybara &amp; Cucumber - feature with expected controller exceptions fails", "body": "<p>I would guess this behavior change isn't because of the capybara update, but rather because you moved the web_console gem out of the test group.  That meant exceptions were never actually being raised in the server because web_console caught them all.  Now that exceptions aren't being caught Capybara is displaying them.  Capybara has the Capybara.raise_server_errors setting to enable/disable that behavior.</p>\n\n<p>Capybara.raise_server_errors = false</p>\n"}], "owner": {"reputation": 5415, "user_id": 2292448, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/02a28db6886d578f75a820b50f2dd334?s=128&d=identicon&r=PG", "display_name": "Lazarus Lazaridis", "link": "https://stackoverflow.com/users/2292448/lazarus-lazaridis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 34905813, "answer_count": 1, "score": 2, "last_activity_date": 1453308606, "creation_date": 1453284147, "question_id": 34896915, "link": "https://stackoverflow.com/questions/34896915/capybara-cucumber-feature-with-expected-controller-exceptions-fails", "title": "Capybara &amp; Cucumber - feature with expected controller exceptions fails", "body": "<p>I recently switched to capybara 2.5.0 &amp; webkit 1.7.1. </p>\n\n<p>I have a cucumber feature in which I want to <strong>check my javascript handling of a failed ajax request</strong>.</p>\n\n<p><strong>With previous capybara version:</strong></p>\n\n<ul>\n<li>I stubbed an API request to respond with 400 thus the controller action raised this exception (<code>RestClient::BadRequest</code>) without rescuing it.</li>\n<li>My javascript was showing a custom message in case the ajax request failed.</li>\n<li>The feature didn't fail when the exception was raised by the controller, the flow was continuing normally. The ajax request failed and my js was handling it as expected.</li>\n</ul>\n\n<p><strong>With the new capybara version:</strong> The feature fails when the exception takes place at the controller level. </p>\n\n<p>I don't want the feature to stop at that level but to continue with the error response to the browser so I can handle the error with my js.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "enums", "relationships"], "answers": [{"comments": [{"owner": {"reputation": 411, "user_id": 1002950, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0798a6fb096996c7c6f8acfcca01985d?s=128&d=identicon&r=PG", "display_name": "leon", "link": "https://stackoverflow.com/users/1002950/leon"}, "edited": false, "score": 0, "creation_date": 1453294175, "post_id": 34897676, "comment_id": 57537219, "body": "<code>ActiveRecord::HasManyThroughSourceAssociationNotFoundError at &#47;events&#47;new Could not find the source association(s) &quot;organisator&quot; or :organisators in model Participation. Try &#39;has_many :organisators, :through =&gt; :participations, :source =&gt; &lt;name&gt;&#39;. Is it one of user or event?</code> if I try to add <code>source: &#39;Participation&#39; </code>then it return the same error. I would like to assign existing users to Participation model."}, {"owner": {"reputation": 73119, "user_id": 1143732, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mFUOI.jpg?s=128&g=1", "display_name": "Richard Peck", "link": "https://stackoverflow.com/users/1143732/richard-peck"}, "reply_to_user": {"reputation": 411, "user_id": 1002950, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0798a6fb096996c7c6f8acfcca01985d?s=128&d=identicon&r=PG", "display_name": "leon", "link": "https://stackoverflow.com/users/1002950/leon"}, "edited": false, "score": 0, "creation_date": 1453294598, "post_id": 34897676, "comment_id": 57537498, "body": "So you basically just want to add new users to an event?"}, {"owner": {"reputation": 411, "user_id": 1002950, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0798a6fb096996c7c6f8acfcca01985d?s=128&d=identicon&r=PG", "display_name": "leon", "link": "https://stackoverflow.com/users/1002950/leon"}, "edited": false, "score": 0, "creation_date": 1453294710, "post_id": 34897676, "comment_id": 57537559, "body": "Yes, I want to select them from list and assign as organisers or helpers."}, {"owner": {"reputation": 73119, "user_id": 1143732, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mFUOI.jpg?s=128&g=1", "display_name": "Richard Peck", "link": "https://stackoverflow.com/users/1143732/richard-peck"}, "reply_to_user": {"reputation": 411, "user_id": 1002950, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0798a6fb096996c7c6f8acfcca01985d?s=128&d=identicon&r=PG", "display_name": "leon", "link": "https://stackoverflow.com/users/1002950/leon"}, "edited": false, "score": 0, "creation_date": 1453294749, "post_id": 34897676, "comment_id": 57537591, "body": "Okay let me write an update, your original question was very confusing"}], "tags": [], "owner": {"reputation": 73119, "user_id": 1143732, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mFUOI.jpg?s=128&g=1", "display_name": "Richard Peck", "link": "https://stackoverflow.com/users/1143732/richard-peck"}, "is_accepted": false, "score": 2, "last_activity_date": 1453298422, "last_edit_date": 1453298422, "creation_date": 1453286271, "answer_id": 34897676, "question_id": 34896811, "link": "https://stackoverflow.com/questions/34896811/how-to-create-through-relations-based-on-enum-in-join-table/34897676#34897676", "title": "How to create through relations based on enum in join table?", "body": "<blockquote>\n  <p>source of them will be User ids stored in Participation join table </p>\n</blockquote>\n\n<p>You need to pull from the <code>Participation</code> model, <em>not</em> the <code>User</code> model:</p>\n\n<pre><code>class Participation &lt; ActiveRecord::Base\n  belongs_to :user\n  belongs_to :event\n\n  enum kind: [:helper, :organisator]\nend\n\nclass Event &lt; ActiveRecord::Base\n  belongs_to :user\n\n  has_many :participations\n  has_many :organisators, -&gt; { where kind: :organisator}, class_name: 'User', through: :participations, source: :user\n  has_many :helpers,      -&gt; { where kind: :helper}, class_name: \"User\", through: :participations, source: :user\nend\n\nclass User &lt; ActiveRecord::Base\n  has_many :events\n\n  has_many :participations\n  has_many :participated_events, through: :participations\nend\n</code></pre>\n\n<p>You've basically got a <a href=\"http://guides.rubyonrails.org/association_basics.html#the-has-many-through-association\" rel=\"nofollow\"><code>has_many :through</code></a> relationship.</p>\n\n<p>--</p>\n\n<p>Thus, you <em>should</em> be able to use:</p>\n\n<pre><code>#app/views/events/update.html.erb\n&lt;%= simple_form_for @event do |f| %&gt;\n   &lt;%= f.association :organisators, collection: @event.organisators %&gt;\n   &lt;%= f.association :helpers, collection: @event.helpers %&gt;\n   &lt;%= f,submit %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>It would help if you gave some context on what you're trying to achieve. The above code should help, we may have to tweak it a little.</p>\n"}, {"comments": [{"owner": {"reputation": 411, "user_id": 1002950, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0798a6fb096996c7c6f8acfcca01985d?s=128&d=identicon&r=PG", "display_name": "leon", "link": "https://stackoverflow.com/users/1002950/leon"}, "edited": false, "score": 0, "creation_date": 1453294558, "post_id": 34897728, "comment_id": 57537470, "body": "In this approach it returns the error <code>Couldn&#39;t find ParticipationOrganizer with &#39;id&#39;=5 [WHERE &quot;participations&quot;.&quot;type&quot; IN (&#39;ParticipationOrganizer&#39;)]</code>, when I&#39;m trying to select existing users from multiple selectbox. How to assign existing users to event.participation_organizers?"}], "tags": [], "owner": {"reputation": 449, "user_id": 2572921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nepMs.jpg?s=128&g=1", "display_name": "Ben Toogood", "link": "https://stackoverflow.com/users/2572921/ben-toogood"}, "is_accepted": false, "score": 1, "last_activity_date": 1453286413, "creation_date": 1453286413, "answer_id": 34897728, "question_id": 34896811, "link": "https://stackoverflow.com/questions/34896811/how-to-create-through-relations-based-on-enum-in-join-table/34897728#34897728", "title": "How to create through relations based on enum in join table?", "body": "<p>I would recommend using Single Table Inheritance over an enum. Keep the existing Participation model, and create two other models (helper and organiser) which will inherit from it.</p>\n\n<p>Once you have implemented this, you can have two different object types which can be referenced through relationships while sharing one database model.</p>\n\n<p>Take a look at this documentation:\n<a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Inheritance.html\" rel=\"nofollow\">http://api.rubyonrails.org/classes/ActiveRecord/Inheritance.html</a></p>\n"}], "owner": {"reputation": 411, "user_id": 1002950, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0798a6fb096996c7c6f8acfcca01985d?s=128&d=identicon&r=PG", "display_name": "leon", "link": "https://stackoverflow.com/users/1002950/leon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 811, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1453298422, "creation_date": 1453283839, "last_edit_date": 1453285982, "question_id": 34896811, "link": "https://stackoverflow.com/questions/34896811/how-to-create-through-relations-based-on-enum-in-join-table", "title": "How to create through relations based on enum in join table?", "body": "<p>I would like to select in simple_form <code>&lt;%= f.association :organisators, collection: User.all %&gt;</code> and <code>&lt;%= f.association :helpers, collection: User.all %&gt;</code> that source of them will be User ids stored in Participation join table with appropriate enum kind, is it a way to do it automatically with ActiveRecord relations?</p>\n\n<pre><code>class Participation &lt; ActiveRecord::Base\n  belongs_to :user\n  belongs_to :event\n\n  enum kind: [:helper, :organisator]\nend\n\nclass Event &lt; ActiveRecord::Base\n  belongs_to :user\n\n  has_many :participations\n  has_many :organisators, class_name: 'Participation'\n  has_many :helpers, class_name: 'Participation'\nend\n\nclass User &lt; ActiveRecord::Base\n  has_many :events\n  has_many :participations\nend\n</code></pre>\n\n<p>When I try to save current version then it raise: <code>Couldn't find Participation with 'id'=1</code></p>\n\n<p><code>event_params: {\"helper_ids\"=&gt;[\"2\"], \"organisator_ids\"=&gt;[\"1\"]}</code></p>\n"}, {"tags": ["ruby", "methods", "save"], "comments": [{"owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "edited": false, "score": 0, "creation_date": 1453284802, "post_id": 34896687, "comment_id": 57530818, "body": "Why don&#39;t you use an array, instead of 10 different digit-based variables?"}, {"owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "reply_to_user": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "edited": false, "score": 0, "creation_date": 1453287560, "post_id": 34896687, "comment_id": 57532710, "body": "@SimoneCarletti or hash"}, {"owner": {"reputation": 39, "user_id": 5814975, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-hqKapbUEE2o/AAAAAAAAAAI/AAAAAAAAANM/c9x8DtC-3Qg/photo.jpg?sz=128", "display_name": "OmerR", "link": "https://stackoverflow.com/users/5814975/omerr"}, "edited": false, "score": 0, "creation_date": 1453623272, "post_id": 34896687, "comment_id": 57676712, "body": "I tried using hash, but it didn&#39;t look that well in the code (which is around 400 lines now)."}], "answers": [{"tags": [], "owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "is_accepted": true, "score": 2, "last_activity_date": 1453284495, "creation_date": 1453284495, "answer_id": 34897036, "question_id": 34896687, "link": "https://stackoverflow.com/questions/34896687/save-variables-to-a-file/34897036#34897036", "title": "Save variables to a file", "body": "<p>You can print <code>instance variables</code> dynamicly.</p>\n\n<pre><code>  1.upto 10 do |i|\n    puts \"#{self.instance_variable_get(\"@inf_cmd_q#{i}\")}\"\n  end\n</code></pre>\n\n<p>If you need to save data to File, use <code>File</code> methods.\nBTW: for saving data you can use <code>JSON</code> data structure.</p>\n"}], "owner": {"reputation": 39, "user_id": 5814975, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-hqKapbUEE2o/AAAAAAAAAAI/AAAAAAAAANM/c9x8DtC-3Qg/photo.jpg?sz=128", "display_name": "OmerR", "link": "https://stackoverflow.com/users/5814975/omerr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 34897036, "answer_count": 1, "score": 0, "last_activity_date": 1453284827, "creation_date": 1453283496, "last_edit_date": 1453284827, "question_id": 34896687, "link": "https://stackoverflow.com/questions/34896687/save-variables-to-a-file", "title": "Save variables to a file", "body": "<p>I'm working on a Ruby project on RHEL6 at work which includes a quiz. The answers are bool variables that change if your answer is correct or not.</p>\n\n<p>Atm I'm trying to add a save option for the bools, but I'm encountering a problem. How can I access the variables written in the code from a method?</p>\n\n<p>code sample:</p>\n\n<pre><code>@inf_cmd_q1 = true\n@inf_cmd_q2 = false\n@inf_cmd_q3 = true\n@inf_cmd_q4 = false\n@inf_cmd_q5 = true\n@inf_cmd_q6 = true\n@inf_cmd_q7 = false\n@inf_cmd_q8 = true\n@inf_cmd_q9 = true\n@inf_cmd_q10 = false\n\ndef save(fname)\n    for i 1..10\n        system(\"echo #{@inf_cmd_q#{i}} &gt;&gt; /quiz/#{fname}\")\n    end\nend\n</code></pre>\n\n<ul>\n<li>inf_cmd_q(num)- answer's bool var</li>\n<li>fname- name of the file to save to</li>\n</ul>\n\n<p>I know it won't work, but I'm having hard time figuring how to make it work, plus I never worked with instance variables, because I just started using Ruby.</p>\n\n<p>any advices?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 1, "creation_date": 1453283634, "post_id": 34896576, "comment_id": 57530041, "body": "When implementing the method you described, what happened? Did you get any errors or wrong results? Please describe your approach and any errors you got. Please also see <a href=\"http://stackoverflow.com/help/on-topic\">What topics can I ask about here?</a> for details about how to ask questions on Stack Overflow."}, {"owner": {"reputation": 694, "user_id": 5493147, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/10207662115541894/picture?type=large", "display_name": "nobilik", "link": "https://stackoverflow.com/users/5493147/nobilik"}, "edited": false, "score": 0, "creation_date": 1453284132, "post_id": 34896576, "comment_id": 57530369, "body": "I can&#39;t understand what you want. What is &quot;closest number&quot;? By index, by value? Be more specific and you always can use <a href=\"http://ruby-doc.org/core-2.2.0/Array.html\" rel=\"nofollow noreferrer\">documentation</a>"}, {"owner": {"reputation": 1080, "user_id": 1546803, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/8vhGT.jpg?s=128&g=1", "display_name": "miss.serena", "link": "https://stackoverflow.com/users/1546803/miss-serena"}, "edited": false, "score": 0, "creation_date": 1453284457, "post_id": 34896576, "comment_id": 57530600, "body": "A few more details would help. Is the array sorted? Are you permitted to have duplicates? Is your array of ints actually defined as an array of Strings? What if the array is empty? What are the constraints on the passed in integer? Examples with input and output covering these cases will help us help you."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 1080, "user_id": 1546803, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/8vhGT.jpg?s=128&g=1", "display_name": "miss.serena", "link": "https://stackoverflow.com/users/1546803/miss-serena"}, "edited": false, "score": 0, "creation_date": 1453284621, "post_id": 34896576, "comment_id": 57530699, "body": "@miss.serena None of your questions (except &quot;What if the array is empty?&quot;) makes a point. If not sorted, then just sort it. I don&#39;t get why duplicates matter. As the OP gave, they are clearly strings. Why do you need a constraint on the integers?"}], "answers": [{"comments": [{"owner": {"reputation": 4054, "user_id": 978728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nJkFo.png?s=128&g=1", "display_name": "Erowlin", "link": "https://stackoverflow.com/users/978728/erowlin"}, "edited": false, "score": 1, "creation_date": 1509635383, "post_id": 34896800, "comment_id": 81105847, "body": "For people like me that were looking at &quot;I want the closest lowest number to  3 in an array, with exact match if possible&quot;, here is your solution:  <code>tmp = [1, 2, 3, 5, 6].sort.group_by {|e| e &lt;=&gt; number_to_find}; closest_or_exact_number = tmp.try(:[], 0).first || tmp.try(:[], -1).last || tmp[1].first</code>"}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 15, "last_activity_date": 1453283797, "creation_date": 1453283797, "answer_id": 34896800, "question_id": 34896576, "link": "https://stackoverflow.com/questions/34896576/get-closest-value-of-a-number-from-array/34896800#34896800", "title": "Get closest value of a number from array", "body": "<pre><code>h = [\"7\", \"8\", \"11\", \"13\", \"14\"].map(&amp;:to_i).sort.group_by{|e| e &lt;=&gt; 11}\nh[-1].last || h[1].first # =&gt; 8\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 5, "last_activity_date": 1453332521, "last_edit_date": 1453332521, "creation_date": 1453287322, "answer_id": 34898065, "question_id": 34896576, "link": "https://stackoverflow.com/questions/34896576/get-closest-value-of-a-number-from-array/34898065#34898065", "title": "Get closest value of a number from array", "body": "<pre><code>def closest(arr, target)\n  return nil if arr.empty?\n  a = (arr + [target]).sort_by(&amp;:to_i)\n  idx = a.rindex(target)\n  idx &gt; 0 ? a[idx-1] : a[idx+1]\nend\n\narr = [\"11\", \"7\", \"13\", \"8\", \"11\", \"14\"]\n\nclosest(arr, \"12\")   #=&gt; 11\nclosest(arr, \"12.5\") #=&gt; 11\nclosest(arr, \"11\")   #=&gt; 11\nclosest(arr, \"4\")    #=&gt;  7\nclosest(arr, \"7\")    #=&gt;  7\n</code></pre>\n\n<p>Edit: Here's another way that uses the methods <a href=\"http://ruby-doc.org/core-2.3.0/Object.html#method-i-to_enum\" rel=\"nofollow\">Object#to_enum</a>, <a href=\"http://ruby-doc.org/core-2.2.0/Enumerator.html#method-i-next\" rel=\"nofollow\">Enumerator#next</a> and <a href=\"http://ruby-doc.org/core-2.2.0/Enumerator.html#method-i-peek\" rel=\"nofollow\">Enumerator#peek</a>:</p>\n\n<pre><code>def closest(arr, target)\n  return nil if arr.empty?\n  e = arr.map(&amp;:to_i).sort.to_enum\n  x = nil # initialize to anything \n  loop do\n    x = e.next\n    break if x &gt; target || e.peek &gt; target\n  end\n  x.to_s\nend\n</code></pre>\n\n<p>For <code>arr</code> above:    </p>\n\n<pre><code>closest(arr, 12)   #=&gt; 11\nclosest(arr, 12.5) #=&gt; 11\nclosest(arr, 11)   #=&gt; 11\nclosest(arr, 4)    #=&gt;  7\nclosest(arr, 7)    #=&gt;  7\n</code></pre>\n\n<p>When the enumerator is at its last value, <code>peek</code> will generate a <code>StopIteration</code> exception. <a href=\"http://ruby-doc.org/core-2.2.0/Kernel.html#method-i-loop\" rel=\"nofollow\">Kernel#loop</a> handles that exception by breaking out of the loop.</p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1453329618, "post_id": 34906057, "comment_id": 57559656, "body": "...or <code>a.reverse_each.find ..</code> to avoid the creation of the temporary array <code>a.reverse</code>."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 5, "last_activity_date": 1453309241, "creation_date": 1453309241, "answer_id": 34906057, "question_id": 34896576, "link": "https://stackoverflow.com/questions/34896576/get-closest-value-of-a-number-from-array/34906057#34906057", "title": "Get closest value of a number from array", "body": "<p>Yet another way to solve this:</p>\n\n<pre><code>a = arr.map(&amp;:to_i).sort      #=&gt; [7, 8, 11, 13, 14]\na.reverse.find { |e| e &lt; 11 } #=&gt; 8\na.find { |e| e &gt; 11 }         #=&gt; 13\n</code></pre>\n\n<p>Since <a href=\"http://ruby-doc.org/core-2.3.0/Enumerable.html#method-i-find\" rel=\"noreferrer\"><code>find</code></a> returns <code>nil</code> if no object matches, the last two lines can be combined via:</p>\n\n<pre><code>a.reverse.find { |e| e &lt; 11 } || a.find { |e| e &gt; 11 }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 379, "user_id": 5389148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lKUq8.jpg?s=128&g=1", "display_name": "Ganesh Sagare", "link": "https://stackoverflow.com/users/5389148/ganesh-sagare"}, "edited": false, "score": 1, "creation_date": 1523009280, "post_id": 48562580, "comment_id": 86392248, "body": "why we need sort here? without sort its working fine."}], "tags": [], "owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "is_accepted": false, "score": 19, "last_activity_date": 1523009584, "last_edit_date": 1523009584, "creation_date": 1517487355, "answer_id": 48562580, "question_id": 34896576, "link": "https://stackoverflow.com/questions/34896576/get-closest-value-of-a-number-from-array/48562580#48562580", "title": "Get closest value of a number from array", "body": "<p>Try Below shortest method for getting closest value</p>\n\n<pre><code>n = 40\na = [20, 30, 45, 50, 56, 60, 64, 80]\na.min_by{|x| (n-x).abs}\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 5518892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fcebc04d82dc49ff1bf60865c7100ca?s=128&d=identicon&r=PG&f=1", "display_name": "Chetan Barawkar", "link": "https://stackoverflow.com/users/5518892/chetan-barawkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5909, "favorite_count": 2, "answer_count": 4, "score": 3, "last_activity_date": 1523009584, "creation_date": 1453283226, "last_edit_date": 1453284196, "question_id": 34896576, "link": "https://stackoverflow.com/questions/34896576/get-closest-value-of-a-number-from-array", "title": "Get closest value of a number from array", "body": "<p>I have an array:</p>\n\n<pre><code>[\"7\", \"8\", \"11\", \"13\", \"14\"]\n</code></pre>\n\n<p>I want the closest inferior number to <code>11</code> if any (i.e. <code>8</code>), or if such number does not exist, then the closest superior number to <code>11</code> (i.e. <code>13</code>).</p>\n"}, {"tags": ["ruby", "postgresql"], "comments": [{"owner": {"reputation": 97819, "user_id": 131874, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b3600796ab1d9e78c7545c91468c2e51?s=128&d=identicon&r=PG", "display_name": "Clodoaldo Neto", "link": "https://stackoverflow.com/users/131874/clodoaldo-neto"}, "edited": false, "score": 1, "creation_date": 1453287970, "post_id": 34896562, "comment_id": 57533025, "body": "Use the Ruby&#39;s Postgresql driver to pass the parameters."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 5719410, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-XWSjEahPaHo/AAAAAAAAAAI/AAAAAAAAABI/wo3f_Y4wWvQ/photo.jpg?sz=128", "display_name": "Mah3ndra", "link": "https://stackoverflow.com/users/5719410/mah3ndra"}, "edited": false, "score": 0, "creation_date": 1453341628, "post_id": 34903449, "comment_id": 57563500, "body": "Thanks for the tutorial, it&#39;s good. But, I have to re-write my code to incorporate the prepared statements in my sql."}, {"owner": {"reputation": 41082, "user_id": 82592, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e1b105626dd9cfd15e543af82e470fd7?s=128&d=identicon&r=PG", "display_name": "Mladen Jablanovi\u0107", "link": "https://stackoverflow.com/users/82592/mladen-jablanovi%c4%87"}, "reply_to_user": {"reputation": 53, "user_id": 5719410, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-XWSjEahPaHo/AAAAAAAAAAI/AAAAAAAAABI/wo3f_Y4wWvQ/photo.jpg?sz=128", "display_name": "Mah3ndra", "link": "https://stackoverflow.com/users/5719410/mah3ndra"}, "edited": false, "score": 0, "creation_date": 1453365451, "post_id": 34903449, "comment_id": 57571773, "body": "See my edit. Try to read docs of the libraries you are using more thoroughly."}, {"owner": {"reputation": 53, "user_id": 5719410, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-XWSjEahPaHo/AAAAAAAAAAI/AAAAAAAAABI/wo3f_Y4wWvQ/photo.jpg?sz=128", "display_name": "Mah3ndra", "link": "https://stackoverflow.com/users/5719410/mah3ndra"}, "edited": false, "score": 0, "creation_date": 1453368287, "post_id": 34903449, "comment_id": 57573477, "body": "<code>def run_sql(sql) \tdb = PG.connect(dbname: &#39;omdb&#39;) \tresults = db.exec(sql) \tdb.close  \treturn results end</code> I have this method I use to execute all my sql statements, right now it doesn&#39;t take any parameters. I have insert statements that take almost ten parameters. I understood your solution but I am not able to implement in my current design without changing lots of code."}, {"owner": {"reputation": 41082, "user_id": 82592, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e1b105626dd9cfd15e543af82e470fd7?s=128&d=identicon&r=PG", "display_name": "Mladen Jablanovi\u0107", "link": "https://stackoverflow.com/users/82592/mladen-jablanovi%c4%87"}, "reply_to_user": {"reputation": 53, "user_id": 5719410, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-XWSjEahPaHo/AAAAAAAAAAI/AAAAAAAAABI/wo3f_Y4wWvQ/photo.jpg?sz=128", "display_name": "Mah3ndra", "link": "https://stackoverflow.com/users/5719410/mah3ndra"}, "edited": false, "score": 0, "creation_date": 1453382913, "post_id": 34903449, "comment_id": 57583555, "body": "Well, that&#39;s plainly bad design then. If you and your colleagues are OK with that, then leave it as is. :/"}, {"owner": {"reputation": 41082, "user_id": 82592, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e1b105626dd9cfd15e543af82e470fd7?s=128&d=identicon&r=PG", "display_name": "Mladen Jablanovi\u0107", "link": "https://stackoverflow.com/users/82592/mladen-jablanovi%c4%87"}, "reply_to_user": {"reputation": 53, "user_id": 5719410, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-XWSjEahPaHo/AAAAAAAAAAI/AAAAAAAAABI/wo3f_Y4wWvQ/photo.jpg?sz=128", "display_name": "Mah3ndra", "link": "https://stackoverflow.com/users/5719410/mah3ndra"}, "edited": false, "score": 0, "creation_date": 1453382998, "post_id": 34903449, "comment_id": 57583631, "body": "BTW, methods can receive more than one parameter, I hope you are aware."}, {"owner": {"reputation": 53, "user_id": 5719410, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-XWSjEahPaHo/AAAAAAAAAAI/AAAAAAAAABI/wo3f_Y4wWvQ/photo.jpg?sz=128", "display_name": "Mah3ndra", "link": "https://stackoverflow.com/users/5719410/mah3ndra"}, "edited": false, "score": 0, "creation_date": 1453512496, "post_id": 34903449, "comment_id": 57648709, "body": "Yeah I agree the design is not that great, I am going to refactor everything with ORM. It seems to handle all these problems. Thanks for your input anyway."}], "tags": [], "owner": {"reputation": 41082, "user_id": 82592, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e1b105626dd9cfd15e543af82e470fd7?s=128&d=identicon&r=PG", "display_name": "Mladen Jablanovi\u0107", "link": "https://stackoverflow.com/users/82592/mladen-jablanovi%c4%87"}, "is_accepted": false, "score": 2, "last_activity_date": 1453365404, "last_edit_date": 1453365404, "creation_date": 1453302063, "answer_id": 34903449, "question_id": 34896562, "link": "https://stackoverflow.com/questions/34896562/postgres-avoiding-extra-quotes-inside-a-string/34903449#34903449", "title": "postgres avoiding extra quotes inside a string", "body": "<p>Bad idea. Don't do that, as you are making your code vulnerable to SQL injection attacks, and also making your life harder. Read more about prepared SQL statements, SQL injection etc.</p>\n\n<p>In short, unless you are using some ORM, you should do something like:</p>\n\n<pre><code>#!/usr/bin/ruby\n\nrequire 'pg'\n\nif ARGV.length != 1 then\n    puts \"Usage: prepared_statement.rb rowId\"\n    exit\nend\n\nrowId = ARGV[0]\n\nbegin\n\n    con = PG.connect :dbname =&gt; 'testdb', :user =&gt; 'janbodnar'\n\n    con.prepare 'stm1', \"SELECT * FROM Cars WHERE Id=$1\"\n    rs = con.exec_prepared 'stm1', [rowId]\n\n    puts rs.values \n\nrescue PG::Error =&gt; e\n\n    puts e.message \n\nensure\n\n    rs.clear if rs\n    con.close if con\n\nend\n</code></pre>\n\n<p>(an example taken from <a href=\"http://zetcode.com/db/postgresqlruby/\" rel=\"nofollow\">http://zetcode.com/db/postgresqlruby/</a>)</p>\n\n<p>Edit: You don't need to use prepared statements, you can also use your DB lib's methods which provide proper parameter binding:</p>\n\n<pre><code>require 'pg'\nconn = PG::Connection.open(:dbname =&gt; 'test')\nres = conn.exec_params('SELECT $1 AS a, $2 AS b, $3 AS c', [1, 2, nil])\n</code></pre>\n\n<p>Take a look at docs for <a href=\"http://www.rubydoc.info/gems/pg/PG/Connection:exec_params\" rel=\"nofollow\"><code>PG#exec_params</code></a></p>\n"}], "owner": {"reputation": 53, "user_id": 5719410, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-XWSjEahPaHo/AAAAAAAAAAI/AAAAAAAAABI/wo3f_Y4wWvQ/photo.jpg?sz=128", "display_name": "Mah3ndra", "link": "https://stackoverflow.com/users/5719410/mah3ndra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453365404, "creation_date": 1453283184, "last_edit_date": 1453287983, "question_id": 34896562, "link": "https://stackoverflow.com/questions/34896562/postgres-avoiding-extra-quotes-inside-a-string", "title": "postgres avoiding extra quotes inside a string", "body": "<p>I have following select query which I will be passing to the database to get results back,</p>\n\n<pre><code>sql = \"select * from movies where title = #{movie_title};\"\n</code></pre>\n\n<p><code>movie_title</code> contains a value that can sometimes contain single quotes and other chars that need escaping. I have come across dollar quoted string which is working well when used inside a <code>INSERT</code> statement but <code>SELECT</code> is not behaving the same, if I use <code>$$#{movie_title}$$</code> like this it just doesn't get converted to a value inside <code>movie_title</code>. Is there any solution for this?</p>\n\n<p>I am using postgres 9.5.0 and I am programming using ruby.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "refactoring"], "comments": [{"owner": {"reputation": 609, "user_id": 5686527, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b17e0460ba70528719b2e99836bda939?s=128&d=identicon&r=PG&f=1", "display_name": "ftshtw", "link": "https://stackoverflow.com/users/5686527/ftshtw"}, "edited": false, "score": 1, "creation_date": 1453282925, "post_id": 34896332, "comment_id": 57529549, "body": "Can you post the complete articles part that you refactored ?"}, {"owner": {"reputation": 609, "user_id": 5686527, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b17e0460ba70528719b2e99836bda939?s=128&d=identicon&r=PG&f=1", "display_name": "ftshtw", "link": "https://stackoverflow.com/users/5686527/ftshtw"}, "edited": false, "score": 0, "creation_date": 1453283847, "post_id": 34896332, "comment_id": 57530167, "body": "No, because I don&#39;t know where does &quot;article&quot; come from and it is actually the same thing you application asks in the error message. In the first block, it seems you don&#39;t need to call it like <code>find_author(attribute)</code> but as <code>find_author</code>. Then in the second one there&#39;s something different."}, {"owner": {"reputation": 609, "user_id": 5686527, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b17e0460ba70528719b2e99836bda939?s=128&d=identicon&r=PG&f=1", "display_name": "ftshtw", "link": "https://stackoverflow.com/users/5686527/ftshtw"}, "edited": false, "score": 0, "creation_date": 1453284072, "post_id": 34896332, "comment_id": 57530329, "body": "Also I am not sure you can call a parameter like <code>params[controller]</code> and not <code>params[&#39;controller&#39;]</code> or <code>params[:controller]</code>."}, {"owner": {"reputation": 1718, "user_id": 5086345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/15e2e469991bde6f4187ae3c22c3b6a5?s=128&d=identicon&r=PG&f=1", "display_name": "Marty", "link": "https://stackoverflow.com/users/5086345/marty"}, "reply_to_user": {"reputation": 609, "user_id": 5686527, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b17e0460ba70528719b2e99836bda939?s=128&d=identicon&r=PG&f=1", "display_name": "ftshtw", "link": "https://stackoverflow.com/users/5686527/ftshtw"}, "edited": false, "score": 0, "creation_date": 1453284214, "post_id": 34896332, "comment_id": 57530426, "body": "So in <code>find_author(article)</code> the <code>article</code> is not a variable. it&#39;s just the word &quot;article&quot; so that in the before_action it would replace <code>[controller]</code> with the literal letters <code>[:article]</code>. So, I&#39;m not calling <code>params[controller]</code> as &quot;controller&quot; is replaced with &quot;:article&quot;. Replacing <code>find_author(article)</code> with <code>find_author(&quot;article&quot;)</code> made no difference."}, {"owner": {"reputation": 609, "user_id": 5686527, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b17e0460ba70528719b2e99836bda939?s=128&d=identicon&r=PG&f=1", "display_name": "ftshtw", "link": "https://stackoverflow.com/users/5686527/ftshtw"}, "edited": false, "score": 0, "creation_date": 1453284430, "post_id": 34896332, "comment_id": 57530580, "body": "first of all I believe you should replace &quot;controller&quot; as it might be a reserved word. Do something like <code>ctrl = params[&quot;#{attribute}&quot;]</code> and use it like <code>@author = Author.find(ctrl[:author_id]) unless (ctrl == nil || ctrl[:author_id] == nil)</code>. Just an idea you might try and see what happens."}, {"owner": {"reputation": 1718, "user_id": 5086345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/15e2e469991bde6f4187ae3c22c3b6a5?s=128&d=identicon&r=PG&f=1", "display_name": "Marty", "link": "https://stackoverflow.com/users/5086345/marty"}, "reply_to_user": {"reputation": 609, "user_id": 5686527, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b17e0460ba70528719b2e99836bda939?s=128&d=identicon&r=PG&f=1", "display_name": "ftshtw", "link": "https://stackoverflow.com/users/5686527/ftshtw"}, "edited": false, "score": 0, "creation_date": 1453285781, "post_id": 34896332, "comment_id": 57531466, "body": "Thanks I finally got it to work using in the articles controller: <code>find_author(params[:article])</code>. In the before_action: <code>@author = Author.find(attribute[:author_id]) unless (attribute == nil || attribute[:author_id] == nil)</code>."}, {"owner": {"reputation": 609, "user_id": 5686527, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b17e0460ba70528719b2e99836bda939?s=128&d=identicon&r=PG&f=1", "display_name": "ftshtw", "link": "https://stackoverflow.com/users/5686527/ftshtw"}, "edited": false, "score": 0, "creation_date": 1453286028, "post_id": 34896332, "comment_id": 57531615, "body": "You can DRY your code more, I don&#39;t believe send() is necessary here and you can strip your params calls like my example above."}, {"owner": {"reputation": 1718, "user_id": 5086345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/15e2e469991bde6f4187ae3c22c3b6a5?s=128&d=identicon&r=PG&f=1", "display_name": "Marty", "link": "https://stackoverflow.com/users/5086345/marty"}, "reply_to_user": {"reputation": 609, "user_id": 5686527, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b17e0460ba70528719b2e99836bda939?s=128&d=identicon&r=PG&f=1", "display_name": "ftshtw", "link": "https://stackoverflow.com/users/5686527/ftshtw"}, "edited": false, "score": 0, "creation_date": 1453286217, "post_id": 34896332, "comment_id": 57531738, "body": "Thanks, correct, so in the solution I&#39;m just passing the params directly to the before method, so I&#39;m not using the <code>send</code> method anymore (you&#39;re right that the improper use by myself of the send method was indeed the cause of the problem)."}, {"owner": {"reputation": 609, "user_id": 5686527, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b17e0460ba70528719b2e99836bda939?s=128&d=identicon&r=PG&f=1", "display_name": "ftshtw", "link": "https://stackoverflow.com/users/5686527/ftshtw"}, "edited": false, "score": 0, "creation_date": 1453287383, "post_id": 34896332, "comment_id": 57532589, "body": "No problem, I posted a reply - Acceptance is appreciated !"}], "answers": [{"tags": [], "owner": {"reputation": 609, "user_id": 5686527, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b17e0460ba70528719b2e99836bda939?s=128&d=identicon&r=PG&f=1", "display_name": "ftshtw", "link": "https://stackoverflow.com/users/5686527/ftshtw"}, "is_accepted": true, "score": 2, "last_activity_date": 1453287357, "creation_date": 1453287357, "answer_id": 34898079, "question_id": 34896332, "link": "https://stackoverflow.com/questions/34896332/refactored-method-not-accepting-attribute/34898079#34898079", "title": "Refactored method not accepting attribute", "body": "<p>You should remove send() and try to DRY your code. One possible solution could be :</p>\n\n<pre><code>@author = Author.find(ctrl[:author_id]) unless \n    (ctrl == nil || ctrl[:author_id] == nil)\n</code></pre>\n\n<p>if you get rid of <code>send()</code> and use something like</p>\n\n<pre><code>ctrl = params[\"#{attribute}\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73119, "user_id": 1143732, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mFUOI.jpg?s=128&g=1", "display_name": "Richard Peck", "link": "https://stackoverflow.com/users/1143732/richard-peck"}, "is_accepted": false, "score": 1, "last_activity_date": 1453294532, "creation_date": 1453294532, "answer_id": 34900656, "question_id": 34896332, "link": "https://stackoverflow.com/questions/34896332/refactored-method-not-accepting-attribute/34900656#34900656", "title": "Refactored method not accepting attribute", "body": "<pre><code>#app/controllers/application_controller.rb\nclass ApplicationController &lt; ActionController::Base\n   before_action :find_author, only: Proc.new {|c| %i(article posts).include? c.controller_name }\n\n   protected\n\n   def find_author\n       author  = params[controller_name][:author_id]\n       @author = Author.find author if author\n       redirect_to root_url if @author.nil?\n   end\nend\n</code></pre>\n\n<p>The only issue I can see here is the calling of <code>controller_name</code> will <em>probably</em> only load <code>application</code>. If it doesn't work, we can see about refactoring.</p>\n"}], "owner": {"reputation": 1718, "user_id": 5086345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/15e2e469991bde6f4187ae3c22c3b6a5?s=128&d=identicon&r=PG&f=1", "display_name": "Marty", "link": "https://stackoverflow.com/users/5086345/marty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 34898079, "answer_count": 2, "score": 1, "last_activity_date": 1453294532, "creation_date": 1453282582, "last_edit_date": 1453284242, "question_id": 34896332, "link": "https://stackoverflow.com/questions/34896332/refactored-method-not-accepting-attribute", "title": "Refactored method not accepting attribute", "body": "<p>A before_action used to work but was repeated in several controllers. For example, in my articles controller I had:</p>\n\n<pre><code>before_action :find_author\n\n# Show, edit, etc. methods\n\ndef find_author\n  @author = Author.find(params[:article][:author_id]) unless (params[:article] == nil || params[:article][:author_id] == nil)\n  if @author == nil\n    redirect_to root_url\n  end\nend\n</code></pre>\n\n<p>Because multiple controllers used this before_action I placed it in the application controller and refactored to:</p>\n\n<pre><code>def find_author(attribute)\n  controller = send(\":#{attribute}\")\n  @author = Author.find(params[controller][:author_id]) unless (params[controller] == nil || params[controller][:author_id] == nil)\n  if @author == nil\n    redirect_to root_url\n  end\nend\n</code></pre>\n\n<p>In my articles controller I added the before_action with a parameter:</p>\n\n<pre><code>before_action do\n  find_author(article)\nend\n</code></pre>\n\n<p>After refactoring tests fail with the error below (referring to the line in the articles controller). What am I doing wrong?</p>\n\n<blockquote>\n  <p>NameError: undefined local variable or method `article' for</p>\n</blockquote>\n\n<p>Update: I replaced <code>find_author(article)</code> with <code>find_author(\"article\")</code>. Now I get a new error message referring to the @author line in the application controller:</p>\n\n<blockquote>\n  <p>NoMethodError: undefined method `:article'</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1835, "user_id": 4985645, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NMblv.png?s=128&g=1", "display_name": "Vishal JAIN", "link": "https://stackoverflow.com/users/4985645/vishal-jain"}, "edited": false, "score": 2, "creation_date": 1453276213, "post_id": 34894304, "comment_id": 57525702, "body": "you can simply used <code>&lt;%=f.text_field :name, :class =&gt; &quot;form-control&quot;, :placeholder =&gt; &quot;#{current_user.name}&quot; %&gt;</code>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 1835, "user_id": 4985645, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NMblv.png?s=128&g=1", "display_name": "Vishal JAIN", "link": "https://stackoverflow.com/users/4985645/vishal-jain"}, "edited": false, "score": 2, "creation_date": 1453276432, "post_id": 34894304, "comment_id": 57525810, "body": "@VishalJAIN: don&#39;t even need interpolation here."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5245636"}, "is_accepted": false, "score": 0, "last_activity_date": 1453276711, "last_edit_date": 1453276711, "creation_date": 1453276275, "answer_id": 34894350, "question_id": 34894304, "link": "https://stackoverflow.com/questions/34894304/is-there-any-way-to-include-a-within-another-without-causing-error/34894350#34894350", "title": "Is there any way to include a &lt;%= %&gt; within another &lt;%= %&gt; without causing error?", "body": "<p>You can do like this:</p>\n\n<pre><code>&lt;%= f.text_field :name, class: \"form-control\", placeholder: \"#{current_user.name}\" %&gt;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>&lt;%= f.text_field :name, class: \"form-control\", placeholder: current_user.name %&gt;\n</code></pre>\n\n<p>You don't need to add <code>&lt;%= %&gt;</code> inside of <code>&lt;%= %&gt;</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 609, "user_id": 5686527, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b17e0460ba70528719b2e99836bda939?s=128&d=identicon&r=PG&f=1", "display_name": "ftshtw", "link": "https://stackoverflow.com/users/5686527/ftshtw"}, "is_accepted": false, "score": 4, "last_activity_date": 1453277019, "last_edit_date": 1453277019, "creation_date": 1453276289, "answer_id": 34894356, "question_id": 34894304, "link": "https://stackoverflow.com/questions/34894304/is-there-any-way-to-include-a-within-another-without-causing-error/34894356#34894356", "title": "Is there any way to include a &lt;%= %&gt; within another &lt;%= %&gt; without causing error?", "body": "<p>You don't need to do that. You just simply use something like this :</p>\n\n<pre><code>&lt;%= f.text_field :name, placeholder: current_user.name %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73119, "user_id": 1143732, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mFUOI.jpg?s=128&g=1", "display_name": "Richard Peck", "link": "https://stackoverflow.com/users/1143732/richard-peck"}, "is_accepted": false, "score": 0, "last_activity_date": 1453286590, "creation_date": 1453286590, "answer_id": 34897787, "question_id": 34894304, "link": "https://stackoverflow.com/questions/34894304/is-there-any-way-to-include-a-within-another-without-causing-error/34897787#34897787", "title": "Is there any way to include a &lt;%= %&gt; within another &lt;%= %&gt; without causing error?", "body": "<p>To give you some context (<code>@Chris V</code> is correct), <code>&lt;%= %&gt;</code> is known as ERB (<a href=\"https://en.wikipedia.org/wiki/ERuby\" rel=\"nofollow\"><code>Embedded Ruby</code></a> code):</p>\n\n<blockquote>\n  <p><code>eRuby (Embedded Ruby)</code> is a templating system that embeds Ruby into a text document. It is often used to embed Ruby code in an HTML document, similar to ASP, JSP and PHP.</p>\n</blockquote>\n\n<p>--</p>\n\n<p>Much like <code>&lt;? echo \"Something\" %&gt;</code> in PHP, <code>ERB</code> code parses everything inside the brackets as <em>ruby</em> code -- meaning if you're at a point where you could put <code>&lt;%= %&gt;</code> inside another set of brackets, the short answer is you don't need them.</p>\n\n<p>You can simply keep it all in the same set of brackets: <code>&lt;%= f.text_field :name, class: \"class\", placeholder: current_user.name %&gt;</code></p>\n"}, {"tags": [], "owner": {"reputation": 40, "user_id": 5299899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f2464d187fd7e7caeb42971fc55a7a?s=128&d=identicon&r=PG&f=1", "display_name": "Manu", "link": "https://stackoverflow.com/users/5299899/manu"}, "is_accepted": false, "score": 0, "last_activity_date": 1453351274, "creation_date": 1453351274, "answer_id": 34915541, "question_id": 34894304, "link": "https://stackoverflow.com/questions/34894304/is-there-any-way-to-include-a-within-another-without-causing-error/34915541#34915541", "title": "Is there any way to include a &lt;%= %&gt; within another &lt;%= %&gt; without causing error?", "body": "<p>There is no need to use embedded ruby within embedded ruby.</p>\n\n<p>You are probably trying to use this, which is causing the error:</p>\n\n<pre><code>&lt;%=f.text_field :name, :class =&gt; \"form-control\", :placeholder =&gt; &lt;%= current_user.name %&gt; %&gt;\n</code></pre>\n\n<p>It can be solved like this</p>\n\n<pre><code>&lt;%=f.text_field :name, :class =&gt; \"form-control\", :placeholder =&gt; current_user.name %&gt;\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 5814534, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eh4nq_1YTcs/AAAAAAAAAAI/AAAAAAAAADY/VcCImxDpfSQ/photo.jpg?sz=128", "display_name": "Jenny Chen", "link": "https://stackoverflow.com/users/5814534/jenny-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1453351274, "creation_date": 1453276108, "question_id": 34894304, "link": "https://stackoverflow.com/questions/34894304/is-there-any-way-to-include-a-within-another-without-causing-error", "title": "Is there any way to include a &lt;%= %&gt; within another &lt;%= %&gt; without causing error?", "body": "<p>I'm writing a ruby application and in my .html.erb file I'm trying to create a form <code>&lt;%=f.text_field :name, class: \"form-control\" %&gt;</code> with a placeholder that displays current user's name (retrieved from <code>&lt;%= current_user.name %&gt;</code>)\nHowever,I always encounter syntax error when I put &lt;%= %> within another &lt;%= %>. Is there anyway to allow putting &lt;%= %> inside &lt;%= %>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "boolean-logic"], "comments": [{"owner": {"reputation": 609, "user_id": 5686527, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b17e0460ba70528719b2e99836bda939?s=128&d=identicon&r=PG&f=1", "display_name": "ftshtw", "link": "https://stackoverflow.com/users/5686527/ftshtw"}, "edited": false, "score": 0, "creation_date": 1453275962, "post_id": 34894162, "comment_id": 57525588, "body": "There is some context missing. You could do this in your controller or model."}, {"owner": {"reputation": 1874, "user_id": 347698, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/97a603e8b378256cd3f706912dbfd031?s=128&d=identicon&r=PG", "display_name": "chaitanya", "link": "https://stackoverflow.com/users/347698/chaitanya"}, "edited": false, "score": 0, "creation_date": 1453276178, "post_id": 34894162, "comment_id": 57525694, "body": "Or you can set &quot;cronjob&quot; for this, ie. update values in database field after certain period of time. look into this link <a href=\"https://github.com/javan/whenever\" rel=\"nofollow noreferrer\">github.com/javan/whenever</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1874, "user_id": 347698, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/97a603e8b378256cd3f706912dbfd031?s=128&d=identicon&r=PG", "display_name": "chaitanya", "link": "https://stackoverflow.com/users/347698/chaitanya"}, "is_accepted": false, "score": 2, "last_activity_date": 1453277048, "creation_date": 1453277048, "answer_id": 34894577, "question_id": 34894162, "link": "https://stackoverflow.com/questions/34894162/how-to-set-certain-time-period-in-rails/34894577#34894577", "title": "How to set &quot;certain time period&quot; in rails?", "body": "<p>Can set \"Cronjob\" in application and run after specific period of time.\nPlease go through following link where you can find solution about how to set it with \"whenever\" gem.</p>\n\n<p><a href=\"https://github.com/javan/whenever\" rel=\"nofollow\">https://github.com/javan/whenever</a></p>\n"}, {"tags": [], "owner": {"reputation": 2785, "user_id": 2733119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4HDSo.jpg?s=128&g=1", "display_name": "art-solopov", "link": "https://stackoverflow.com/users/2733119/art-solopov"}, "is_accepted": false, "score": 0, "last_activity_date": 1453282518, "creation_date": 1453282518, "answer_id": 34896308, "question_id": 34894162, "link": "https://stackoverflow.com/questions/34894162/how-to-set-certain-time-period-in-rails/34896308#34896308", "title": "How to set &quot;certain time period&quot; in rails?", "body": "<p>Maybe replace the boolean <code>featured_ground</code> field with a timestamp <code>featured_at</code> field? That way you can see if the ground was featured within a period of time.</p>\n"}], "owner": {"reputation": 1, "user_id": 5814487, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x_RHtDX08k8/AAAAAAAAAAI/AAAAAAAAA_o/uiIBi15QASo/photo.jpg?sz=128", "display_name": "Nirvik Khanal", "link": "https://stackoverflow.com/users/5814487/nirvik-khanal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1453282518, "creation_date": 1453275651, "last_edit_date": 1453275877, "question_id": 34894162, "link": "https://stackoverflow.com/questions/34894162/how-to-set-certain-time-period-in-rails", "title": "How to set &quot;certain time period&quot; in rails?", "body": "<pre><code>class CreateGrounddetails &lt; ActiveRecord::Migration\n  def change\n    create_table :grounddetails do |t|\n      t.string :name\n      t.datetime :working_hours\n      t.string :address\n      t.string :contact_no\n      t.string :email\n      t.integer :no_of_ground\n      t.text :description\n      t.boolean :featured_ground #featured\n      t.timestamps null: false\n    end\n  end\nend\n</code></pre>\n\n<p>I am able to fetch <code>true</code> value from <code>featured_ground</code> but I am having problem setting some time period for that featured ground. For e.g scheduling <code>featured_ground</code> to true must feature that specific ground for certain time period and should be automatically set to false after that time period.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4", "enums"], "comments": [{"owner": {"reputation": 1874, "user_id": 347698, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/97a603e8b378256cd3f706912dbfd031?s=128&d=identicon&r=PG", "display_name": "chaitanya", "link": "https://stackoverflow.com/users/347698/chaitanya"}, "edited": false, "score": 0, "creation_date": 1453275861, "post_id": 34893956, "comment_id": 57525536, "body": "You can send extra param with link_to eg. link_to &quot;List Cats&quot;, some_path(:cat =&gt; true) and then you can check this parameter on page or controller like if params[:cat] == true render(cat) elsif params[:dog] == true render(dog).."}, {"owner": {"reputation": 2250, "user_id": 5180707, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/21cd167a116deb23358c244a0e471a3d?s=128&d=identicon&r=PG&f=1", "display_name": "Billy Logan", "link": "https://stackoverflow.com/users/5180707/billy-logan"}, "reply_to_user": {"reputation": 1874, "user_id": 347698, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/97a603e8b378256cd3f706912dbfd031?s=128&d=identicon&r=PG", "display_name": "chaitanya", "link": "https://stackoverflow.com/users/347698/chaitanya"}, "edited": false, "score": 0, "creation_date": 1453276245, "post_id": 34893956, "comment_id": 57525720, "body": "@chaitanyasaraf It would be highly appreciated if you could provide an example in the answer,"}], "answers": [{"comments": [{"owner": {"reputation": 2250, "user_id": 5180707, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/21cd167a116deb23358c244a0e471a3d?s=128&d=identicon&r=PG&f=1", "display_name": "Billy Logan", "link": "https://stackoverflow.com/users/5180707/billy-logan"}, "edited": false, "score": 0, "creation_date": 1453280598, "post_id": 34894493, "comment_id": 57528004, "body": "Thank you for the answer. And I&#39;m curious how would I pass in parameter by default in my view? For example, what would I do in my controller If I wanted cats displayed initially?"}, {"owner": {"reputation": 1874, "user_id": 347698, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/97a603e8b378256cd3f706912dbfd031?s=128&d=identicon&r=PG", "display_name": "chaitanya", "link": "https://stackoverflow.com/users/347698/chaitanya"}, "reply_to_user": {"reputation": 2250, "user_id": 5180707, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/21cd167a116deb23358c244a0e471a3d?s=128&d=identicon&r=PG&f=1", "display_name": "Billy Logan", "link": "https://stackoverflow.com/users/5180707/billy-logan"}, "edited": false, "score": 0, "creation_date": 1453280789, "post_id": 34894493, "comment_id": 57528111, "body": "On view just add &quot;else&quot; and render partial of cats, so by default it will load cats"}], "tags": [], "owner": {"reputation": 1874, "user_id": 347698, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/97a603e8b378256cd3f706912dbfd031?s=128&d=identicon&r=PG", "display_name": "chaitanya", "link": "https://stackoverflow.com/users/347698/chaitanya"}, "is_accepted": true, "score": 1, "last_activity_date": 1453276730, "creation_date": 1453276730, "answer_id": 34894493, "question_id": 34893956, "link": "https://stackoverflow.com/questions/34893956/how-to-render-different-collections-at-the-same-place/34894493#34894493", "title": "How to render different collections at the same place?", "body": "<p>You can write following code to switch between different  lists</p>\n\n<pre><code>&lt;%= link_to \"List Cats\", animals_path(:cat =&gt; true) if params[:dog] %&gt;\n&lt;%= link_to \"List Dogs\", animals_path(:dog =&gt; true) if params[:cat] %&gt;\n\n&lt;div id=\"list\"&gt;\n &lt;% if params[:cat] == true %&gt;\n  &lt;%= render partial: 'animals/cat', collection: @cats, as: :cat  %&gt;\n &lt;% elsif params[:dog] == true  %&gt;\n  &lt;%= render partial: 'animals/dog', collection: @dogs, as: :dog  %&gt;\n &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n"}], "owner": {"reputation": 2250, "user_id": 5180707, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/21cd167a116deb23358c244a0e471a3d?s=128&d=identicon&r=PG&f=1", "display_name": "Billy Logan", "link": "https://stackoverflow.com/users/5180707/billy-logan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 34894493, "answer_count": 1, "score": 0, "last_activity_date": 1453276730, "creation_date": 1453275003, "question_id": 34893956, "link": "https://stackoverflow.com/questions/34893956/how-to-render-different-collections-at-the-same-place", "title": "How to render different collections at the same place?", "body": "<p>Suppose, I have a model called Animal. This model contains enum attribute <strong>kind</strong> with two possible states.</p>\n\n<pre><code>class Animal &lt; ActiveRecord::Base\n  enum kind: [ :cat, :dog ]\nend\n</code></pre>\n\n<p>Then in my controller I create corresponding instance variables collections.</p>\n\n<pre><code>class AnimalsController &lt; ApplicationController\n  def index\n    @cats = Animal.cat\n    @dogs = Animal.dog\n  end\nend\n</code></pre>\n\n<p>In my view I got two links and two collections.</p>\n\n<pre><code>&lt;h1&gt;Animals&lt;/h1&gt;\n\n&lt;b&gt;&lt;%= link_to 'List Cats' %&gt;&lt;/b&gt;\n&lt;b&gt;&lt;%= link_to 'List Dogs' %&gt;&lt;/b&gt;\n\n&lt;%= render partial: 'animals/cat', collection: @cats, as: :cat %&gt;\n&lt;%= render partial: 'animals/dog', collection: @dogs, as: :dog %&gt;\n</code></pre>\n\n<p>What is the prefered  way of displaying first collection instead of second or second one instead of the first in the same place depending on clicked link? How to do that?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "json", "rethinkdb", "grape"], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 4684616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11e86e33b43baf21ec2328efe159f44c?s=128&d=identicon&r=PG&f=1", "display_name": "anmol-idf", "link": "https://stackoverflow.com/users/4684616/anmol-idf"}, "edited": false, "score": 1, "creation_date": 1453292352, "post_id": 34899721, "comment_id": 57536023, "body": "Thanks. Looks like a great resource. Going through it now. :)"}], "tags": [], "owner": {"reputation": 4744, "user_id": 2301092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1pBf.jpg?s=128&g=1", "display_name": "Bruno Paulino", "link": "https://stackoverflow.com/users/2301092/bruno-paulino"}, "is_accepted": false, "score": 0, "last_activity_date": 1453475131, "last_edit_date": 1453475131, "creation_date": 1453291823, "answer_id": 34899721, "question_id": 34893719, "link": "https://stackoverflow.com/questions/34893719/how-to-create-json-api-with-rethinkdb-as-backend-and-grape-gem/34899721#34899721", "title": "How to create JSON API with RethinkDB as backend and Grape gem?", "body": "<p>This book is what you need: <a href=\"http://apionrails.icalialabs.com/book\" rel=\"nofollow\">API On Rails</a> written by Abraham Kuri Vargas. This is the best resource so far. You can learn how to build an API pretty fast with token authentication as well. </p>\n"}], "owner": {"reputation": 69, "user_id": 4684616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11e86e33b43baf21ec2328efe159f44c?s=128&d=identicon&r=PG&f=1", "display_name": "anmol-idf", "link": "https://stackoverflow.com/users/4684616/anmol-idf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 175, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1453475131, "creation_date": 1453274149, "question_id": 34893719, "link": "https://stackoverflow.com/questions/34893719/how-to-create-json-api-with-rethinkdb-as-backend-and-grape-gem", "title": "How to create JSON API with RethinkDB as backend and Grape gem?", "body": "<p>I want to create an API application with RethinkDB as backend and Grape gem to create the APIs. I have read the docs of Nobrainer Ruby ORM. Just like <a href=\"http://www.sitepoint.com/build-great-apis-grape/\" rel=\"nofollow\">this article</a>, could somebody give me a starting points or guidelines on how to go about creating this API application?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "postgresql", "rails-migrations"], "answers": [{"tags": [], "owner": {"reputation": 23312, "user_id": 560215, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bb365e8477053edcc55b40c3d27781d8?s=128&d=identicon&r=PG", "display_name": "sevenseacat", "link": "https://stackoverflow.com/users/560215/sevenseacat"}, "is_accepted": true, "score": 3, "last_activity_date": 1453274270, "creation_date": 1453274270, "answer_id": 34893749, "question_id": 34893627, "link": "https://stackoverflow.com/questions/34893627/ruby-on-rails-with-external-database-issues-with-web-requests/34893749#34893749", "title": "Ruby on Rails with external database, issues with web requests", "body": "<p>If you don't need to run the migrations (and you don't, if your external database is already set up with the schema you need), then simply delete them from your <code>db/migrate</code> folder.</p>\n"}, {"tags": [], "owner": {"reputation": 995, "user_id": 2576714, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RcYff.jpg?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/2576714/tim"}, "is_accepted": false, "score": 2, "last_activity_date": 1453279879, "creation_date": 1453279879, "answer_id": 34895366, "question_id": 34893627, "link": "https://stackoverflow.com/questions/34893627/ruby-on-rails-with-external-database-issues-with-web-requests/34895366#34895366", "title": "Ruby on Rails with external database, issues with web requests", "body": "<p>Here is also a link to how to a couple of approaches:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/20244244/rails-4-how-to-ignore-pending-migrations\">Rails 4 how to ignore pending migrations</a></p>\n\n<p>This will mean you can keep your migrations, in case you ever need to use them somewhere else.</p>\n\n<p>Basic approaches described:</p>\n\n<ul>\n<li>setting a version number</li>\n<li><p>turning off the error with:</p>\n\n<p>config.active_record.migration_error = false</p></li>\n</ul>\n"}], "owner": {"reputation": 89, "user_id": 1394889, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6dbf8d6ed88b5245519b5dfd51c3a5dc?s=128&d=identicon&r=PG", "display_name": "cjspook", "link": "https://stackoverflow.com/users/1394889/cjspook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 34893749, "answer_count": 2, "score": 1, "last_activity_date": 1453279879, "creation_date": 1453273821, "question_id": 34893627, "link": "https://stackoverflow.com/questions/34893627/ruby-on-rails-with-external-database-issues-with-web-requests", "title": "Ruby on Rails with external database, issues with web requests", "body": "<p>I need to use Ruby on Rails with an external Postgres database. I have hooked up models to the database, and can run searches to the database using calls like Model.all. However, when I try and do a web request of the same data, I get the following error:</p>\n\n<pre><code>Started GET \"/v1/products\" for 127.0.0.1 at 2016-01-19 22:53:34 -0800\n\nActiveRecord::PendingMigrationError (\n\nMigrations are pending. To resolve this issue, run:\n\n    bin/rake db:migrate RAILS_ENV=development\n\n):\n</code></pre>\n\n<p>I am an amateur Rails and database user, so I'm not sure what exactly a migrate does, but I do not have write permissions, so I cannot run one.</p>\n\n<p>So, what can I do to the Rails project such that I can complete these web requests without needing to perform a migration? Any help is greatly appreciated!</p>\n"}, {"tags": ["ruby", "segmentation-fault", "exit-code"], "answers": [{"comments": [{"owner": {"reputation": 1683, "user_id": 1895325, "user_type": "registered", "accept_rate": 34, "profile_image": "https://i.stack.imgur.com/DJO4D.jpg?s=128&g=1", "display_name": "Holmes.Sherlock", "link": "https://stackoverflow.com/users/1895325/holmes-sherlock"}, "edited": false, "score": 0, "creation_date": 1453280897, "post_id": 34895261, "comment_id": 57528187, "body": "Even I have seen <code>$?.to_i == 11</code> in other cases. I am not being able to reproduce the same her though. It just appears in another larger program, seemingly randomly. Therefore, I can&#39;t quite rely on <code>$?</code>. Which combination of Bash/Ruby are you using?"}, {"owner": {"reputation": 1683, "user_id": 1895325, "user_type": "registered", "accept_rate": 34, "profile_image": "https://i.stack.imgur.com/DJO4D.jpg?s=128&g=1", "display_name": "Holmes.Sherlock", "link": "https://stackoverflow.com/users/1895325/holmes-sherlock"}, "edited": false, "score": 0, "creation_date": 1453281022, "post_id": 34895261, "comment_id": 57528278, "body": "If I use <code>system(&quot;.&#47;segfault&quot;, err: : out)</code>, the following doesn&#39;t appear: <code>sh: line 1:  8181 Segmentation fault      (core dumped) .&#47;segfault 2&gt;&amp;1</code>"}, {"owner": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "reply_to_user": {"reputation": 1683, "user_id": 1895325, "user_type": "registered", "accept_rate": 34, "profile_image": "https://i.stack.imgur.com/DJO4D.jpg?s=128&g=1", "display_name": "Holmes.Sherlock", "link": "https://stackoverflow.com/users/1895325/holmes-sherlock"}, "edited": false, "score": 0, "creation_date": 1453281038, "post_id": 34895261, "comment_id": 57528302, "body": "Ruby 2.3.0, bash 3.2.57. Personally I would always avoid the use of the shell invoking form of system"}, {"owner": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "reply_to_user": {"reputation": 1683, "user_id": 1895325, "user_type": "registered", "accept_rate": 34, "profile_image": "https://i.stack.imgur.com/DJO4D.jpg?s=128&g=1", "display_name": "Holmes.Sherlock", "link": "https://stackoverflow.com/users/1895325/holmes-sherlock"}, "edited": false, "score": 0, "creation_date": 1453281076, "post_id": 34895261, "comment_id": 57528329, "body": "That&#39;s because that form also avoids spawning a shell"}, {"owner": {"reputation": 1683, "user_id": 1895325, "user_type": "registered", "accept_rate": 34, "profile_image": "https://i.stack.imgur.com/DJO4D.jpg?s=128&g=1", "display_name": "Holmes.Sherlock", "link": "https://stackoverflow.com/users/1895325/holmes-sherlock"}, "edited": false, "score": 0, "creation_date": 1453281102, "post_id": 34895261, "comment_id": 57528349, "body": "Security is not a concern in my case. It&#39;s a tool prototype I am building. Sanitizing doesn&#39;t apply as strictly as in commercial ones."}, {"owner": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "reply_to_user": {"reputation": 1683, "user_id": 1895325, "user_type": "registered", "accept_rate": 34, "profile_image": "https://i.stack.imgur.com/DJO4D.jpg?s=128&g=1", "display_name": "Holmes.Sherlock", "link": "https://stackoverflow.com/users/1895325/holmes-sherlock"}, "edited": false, "score": 0, "creation_date": 1453281232, "post_id": 34895261, "comment_id": 57528417, "body": "It&#39;s not just about security - involving a shell often complicates things (eg argument parsing, shell globbing etc) and apparently exit codes."}], "tags": [], "owner": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "is_accepted": false, "score": 0, "last_activity_date": 1453280599, "last_edit_date": 1453280599, "creation_date": 1453279530, "answer_id": 34895261, "question_id": 34893511, "link": "https://stackoverflow.com/questions/34893511/why-does-exit-status-of-system-call-in-ruby-change-with-redirection/34895261#34895261", "title": "Why does exit status of system() call in Ruby change with redirection?", "body": "<p>The command you give to system can take multiple forms. If it is just the path to the command or if it is a path and an array of arguments then ruby forks and execs that command directly. </p>\n\n<p>If it is anything more complicated then it executes what it considers the standard shell and passes the command to the shell.</p>\n\n<p>The reason this is relevant is in the docs for <code>exitstatus</code> which say:</p>\n\n<blockquote>\n  <p>Returns the least significant eight bits of the return code of stat. Only available if <code>exited?</code> is true.</p>\n</blockquote>\n\n<p>And the docs for <code>exited?</code> say </p>\n\n<blockquote>\n  <p>Returns true if stat exited normally (for example using an exit() call or finishing the program).</p>\n</blockquote>\n\n<p>Your c binary does not exit normally, so in your first case <code>exited?</code> is false and exitstatus retuns nil In the second case while your binary is still failing in the same way, the actual process executed by ruby was a instance of your shell, which did exit normally. </p>\n\n<p>I get different results as far as $?.to_i is concerned. The low 8 bits contain information such as whether a signal was raised and the high 8 bits contain the exit status. </p>\n\n<p>I get 11 and 35584 (139&lt;&lt;8) in your 2 cases, but your version of ruby seems to be behaving like bash and adding 128 to the signal value (segfault is signal 11). </p>\n\n<p>Either way the cause of the difference is whether the command is executed via a shell: the shell sees the failed process and turns its signal value into a exit status (stored in the high 8 bits) whereas when executed directly there is no exit status and error information is in the low 8 bits.</p>\n\n<p>As an aside, you can redirect output using options passed to system eg</p>\n\n<pre><code>system(\"mycommand\", err: :out)\n</code></pre>\n\n<p>Redirects stderr to stdout as you were doing</p>\n"}], "owner": {"reputation": 1683, "user_id": 1895325, "user_type": "registered", "accept_rate": 34, "profile_image": "https://i.stack.imgur.com/DJO4D.jpg?s=128&g=1", "display_name": "Holmes.Sherlock", "link": "https://stackoverflow.com/users/1895325/holmes-sherlock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 352, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1453280599, "creation_date": 1453273401, "question_id": 34893511, "link": "https://stackoverflow.com/questions/34893511/why-does-exit-status-of-system-call-in-ruby-change-with-redirection", "title": "Why does exit status of system() call in Ruby change with redirection?", "body": "<p>I have slimmed down an issue I am facing to an MWE. Can anybody confirm if it is a bug or I am missing something rudimentary?</p>\n\n<p><strong>Platform</strong>:</p>\n\n<ul>\n<li>Ruby 1.9.3p484 (2013-11-22 revision 43786) [x86_64-linux]</li>\n<li>GNU bash, version 4.3.11(1)-release (x86_64-pc-linux-gnu)</li>\n<li>Ubuntu 14.04.2 x86_64</li>\n</ul>\n\n<p><strong>Step 1</strong>: Create a Ruby script as follows named <code>demo.rb</code></p>\n\n<pre><code>ret = system(\"./segfault\")\nprint \"Return value: \", ret, \"\\n\"\nprint \"Exit status: \", ($?.exitstatus) ? $?.exitstatus : \"nil\", \"\\n\"\nprint \"Status code: \", $?.to_i, \"\\n\"\nputs \"-----------------------------------\"\nret = system(\"./segfault 2&gt;&amp;1\")\nprint \"Return value: \", ret, \"\\n\"\nprint \"Exit status: \", ($?.exitstatus) ? $?.exitstatus : \"nil\", \"\\n\"\nprint \"Status code: \", $?.to_i, \"\\n\"\n</code></pre>\n\n<p><strong>Step 2</strong>: Create a C program as follows named <code>segfault.c</code></p>\n\n<pre><code>#include &lt;string.h&gt;\n\nint main()\n{\n    memset((char *)0x0, 1, 100);\n    return 1;\n}\n</code></pre>\n\n<p><strong>Step 3</strong>: Compile the C program.</p>\n\n<pre><code>gcc segfault.c -o segfault\n</code></pre>\n\n<p><strong>Step 4</strong>: Run the Ruby script.</p>\n\n<pre><code>$ ruby segfault.rb \nReturn value: false\nExit status: nil\nStatus code: 139\n-----------------------------------\nsh: line 1:  8181 Segmentation fault      (core dumped) ./segfault 2&gt;&amp;1\nReturn value: false\nExit status: 139\nStatus code: 35584\n</code></pre>\n\n<p>I can't understand why the exit status and status code changes with <code>stderr</code> being redirect to <code>stdout</code>. Does anyone have a reasonable explanation of this behavior?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "associations"], "answers": [{"comments": [{"owner": {"reputation": 387, "user_id": 4619317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh5.googleusercontent.com/-rNm3MNBTQgg/AAAAAAAAAAI/AAAAAAAAABI/lSsNpyvO5zI/photo.jpg?sz=128", "display_name": "Shree Ram Neupane", "link": "https://stackoverflow.com/users/4619317/shree-ram-neupane"}, "edited": false, "score": 0, "creation_date": 1453275108, "post_id": 34893598, "comment_id": 57525177, "body": "Sorry for type mistake, It should be <code>UsersController</code>, @user. I have corrected the question. However after doing <code>@document =  @documents.build</code> also, <code>@documents</code> is showing the same behavior."}, {"owner": {"reputation": 36449, "user_id": 2453699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0b0a49d160baf7d95b81d798ea0cb65?s=128&d=identicon&r=PG", "display_name": "vee", "link": "https://stackoverflow.com/users/2453699/vee"}, "reply_to_user": {"reputation": 387, "user_id": 4619317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh5.googleusercontent.com/-rNm3MNBTQgg/AAAAAAAAAAI/AAAAAAAAABI/lSsNpyvO5zI/photo.jpg?sz=128", "display_name": "Shree Ram Neupane", "link": "https://stackoverflow.com/users/4619317/shree-ram-neupane"}, "edited": false, "score": 0, "creation_date": 1453296747, "post_id": 34893598, "comment_id": 57538929, "body": "@ShreeRamNeupane, I apologize I had missed the last line in your second code block where you have the newly built <code>Document</code> object. Am I correct to assume your original problem was related to using <code>.count</code> which makes a call to the database vs using <code>.size</code> which would have shown you three documents instead of two?"}], "tags": [], "owner": {"reputation": 36449, "user_id": 2453699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0b0a49d160baf7d95b81d798ea0cb65?s=128&d=identicon&r=PG", "display_name": "vee", "link": "https://stackoverflow.com/users/2453699/vee"}, "is_accepted": false, "score": 0, "last_activity_date": 1453273706, "creation_date": 1453273706, "answer_id": 34893598, "question_id": 34893378, "link": "https://stackoverflow.com/questions/34893378/appending-build-object-to-collection-when-fetching-collection-with-build-object/34893598#34893598", "title": "Appending build object to collection when fetching collection with build object", "body": "<p><code>@documents</code> points to <code>@user</code>'s document. You should be building the new <code>document</code> on <code>@user</code> instead of <code>@member</code> to see the newly built document in your <code>@documents</code> collection.  </p>\n\n<p>Updating your <code>edit</code> action as follows should show you three documents for <code>@user</code> along with newly built document on <code>@document</code>:</p>\n\n<pre><code>class MembersController &lt; ApplicationController\n   def edit\n    @user = User.find(params[:id])\n    @documents = @user.documents   # List document\n    @document =  @documents.build   # Build document on `@user`.\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 387, "user_id": 4619317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh5.googleusercontent.com/-rNm3MNBTQgg/AAAAAAAAAAI/AAAAAAAAABI/lSsNpyvO5zI/photo.jpg?sz=128", "display_name": "Shree Ram Neupane", "link": "https://stackoverflow.com/users/4619317/shree-ram-neupane"}, "edited": false, "score": 0, "creation_date": 1453286685, "post_id": 34895044, "comment_id": 57532074, "body": "First method:  <code>@documents = @user.documents</code> <code>@document = Document.new(user: @user)</code> is working as intended. But, Next method: <code>@documents = @user.documents.dup</code> <code>@document = @user.documents.build</code> is showing the similar behavior. However, thanks for yours answers."}, {"owner": {"reputation": 3630, "user_id": 4799659, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153200714295120/picture?type=large", "display_name": "fylooi", "link": "https://stackoverflow.com/users/4799659/fylooi"}, "reply_to_user": {"reputation": 387, "user_id": 4619317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh5.googleusercontent.com/-rNm3MNBTQgg/AAAAAAAAAAI/AAAAAAAAABI/lSsNpyvO5zI/photo.jpg?sz=128", "display_name": "Shree Ram Neupane", "link": "https://stackoverflow.com/users/4619317/shree-ram-neupane"}, "edited": false, "score": 0, "creation_date": 1453286880, "post_id": 34895044, "comment_id": 57532218, "body": "@ShreeRamNeupane: For the second case, make sure you&#39;re accessing <code>build</code> through <code>@user.documents.build</code> instead of <code>@documents.build</code>. Works for me that way."}], "tags": [], "owner": {"reputation": 3630, "user_id": 4799659, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153200714295120/picture?type=large", "display_name": "fylooi", "link": "https://stackoverflow.com/users/4799659/fylooi"}, "is_accepted": true, "score": 1, "last_activity_date": 1453278857, "creation_date": 1453278857, "answer_id": 34895044, "question_id": 34893378, "link": "https://stackoverflow.com/questions/34893378/appending-build-object-to-collection-when-fetching-collection-with-build-object/34895044#34895044", "title": "Appending build object to collection when fetching collection with build object", "body": "<p><code>@documents = @user.documents</code> adds a reference to the <code>@user.documents</code> array. <code>@user.documents.build</code> mutates that array in place, so <code>@documents</code> will always show the new record. </p>\n\n<p>You have two options to resolve this: </p>\n\n<p>Initialize <code>@document</code> as a <code>Document</code> and set the foreign key manually instead of going through  <code>@documents</code>. This will not add the new record to <code>@user.documents</code></p>\n\n<pre><code>@documents = @user.documents\n@document = Document.new(user: @user)\n</code></pre>\n\n<p>Make a copy of the <code>documents</code> array using <code>#dup</code> instead of referencing it. </p>\n\n<pre><code>@documents = @user.documents.dup\n@document = @user.documents.build\n</code></pre>\n"}], "owner": {"reputation": 387, "user_id": 4619317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh5.googleusercontent.com/-rNm3MNBTQgg/AAAAAAAAAAI/AAAAAAAAABI/lSsNpyvO5zI/photo.jpg?sz=128", "display_name": "Shree Ram Neupane", "link": "https://stackoverflow.com/users/4619317/shree-ram-neupane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 34895044, "answer_count": 2, "score": 0, "last_activity_date": 1453278857, "creation_date": 1453272934, "last_edit_date": 1453274767, "question_id": 34893378, "link": "https://stackoverflow.com/questions/34893378/appending-build-object-to-collection-when-fetching-collection-with-build-object", "title": "Appending build object to collection when fetching collection with build object", "body": "<p>Rails 4.2.4 and Ruby 2.2.3</p>\n\n<p>Two model are associated as follow:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_many :documents\n\n  accepts_nested_attributes_for :documents\nend\n\nclass Document &lt; ActiveRecord::Base\n  belongs_to :user\nend\n</code></pre>\n\n<p>User controller has an action as:</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n   def edit\n    @user = User.find(params[:id])\n    @documents = @user.documents   # List document\n    @document =  @user.documents.build   # Build document\n  end\nend\n</code></pre>\n\n<p>Here, I want <code>@documents</code> variable to just contains the collection of the User's Document. But it is also appending a new instance of the <code>Document</code> <code>#&lt;Document:0x007f2d28431550 id: nil, name: nil, created_at: nil, updated_at: nil, user_id: 2&gt;</code> also, which I don't want.</p>\n\n<p>Say a <code>@user</code> has two Document associated to it.\nJust after <code>List Document</code> Step <code>@documents</code> variable has value like:</p>\n\n<pre><code>[#&lt;Document:0x007f2d290b67d0\n  id: 95,\n  document: \"doc1.pdf\",\n  created_at: Wed, 20 Jan 2016 04:32:16 UTC +00:00,\n  updated_at: Wed, 20 Jan 2016 04:32:16 UTC +00:00,\n  user_id: 2&gt;,\n#&lt;Document:0x008f8d290e87da\n  id: 96,\n  document: \"doc2.pdf\",\n  created_at: Wed, 20 Jan 2016 04:32:22 UTC +00:00,\n  updated_at: Wed, 20 Jan 2016 04:32:22 UTC +00:00,\n  user_id: 2&gt;]\n</code></pre>\n\n<p>and <code>@documents.count = 2</code></p>\n\n<p>But, after <code>Build document</code> step <code>@documents</code> variable has value like:</p>\n\n<pre><code>[#&lt;Document:0x007f2d290b67d0\n  id: 95,\n  document: \"doc1.pdf\",\n  created_at: Wed, 20 Jan 2016 04:32:16 UTC +00:00,\n  updated_at: Wed, 20 Jan 2016 04:32:16 UTC +00:00,\n  user_id: 2&gt;,\n#&lt;Document:0x008f8d290e87da\n  id: 96,\n  document: \"doc2.pdf\",\n  created_at: Wed, 20 Jan 2016 04:32:22 UTC +00:00,\n  updated_at: Wed, 20 Jan 2016 04:32:22 UTC +00:00,\n  user_id: 2&gt;,\n#&lt;Document:0x007f2d28431550 id: nil, name: nil, created_at: nil, updated_at: nil, user_id: 2&gt; ]\n</code></pre>\n\n<p>but we still have <code>@documents.count = 2</code>.</p>\n\n<p>Here, <code>count</code> is same. But the collection contain the one more object. \nHow I can understand this behavior of rails. Also how I can freeze <code>@documents</code> to get only the collection of documents. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "datadog"], "answers": [{"comments": [{"owner": {"reputation": 207, "user_id": 2039486, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/0433b8361c39089e68aea3753d90a8ae?s=128&d=identicon&r=PG", "display_name": "joe", "link": "https://stackoverflow.com/users/2039486/joe"}, "edited": false, "score": 1, "creation_date": 1453366435, "post_id": 34909299, "comment_id": 57572360, "body": "Thanks so much @Andrew. In that emit_point method, what is the value of &quot;device&quot;?"}, {"owner": {"reputation": 261, "user_id": 4172512, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CmTsKm9neyc/AAAAAAAAAAI/AAAAAAAAAUc/FnlN7MNc1xo/photo.jpg?sz=128", "display_name": "Andrew Vaughan", "link": "https://stackoverflow.com/users/4172512/andrew-vaughan"}, "reply_to_user": {"reputation": 207, "user_id": 2039486, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/0433b8361c39089e68aea3753d90a8ae?s=128&d=identicon&r=PG", "display_name": "joe", "link": "https://stackoverflow.com/users/2039486/joe"}, "edited": false, "score": 0, "creation_date": 1454001324, "post_id": 34909299, "comment_id": 57858696, "body": "The value of <code>:device</code> in this case was an additional tag.  This allows them to break down the metric by host or device.  Hope this helps.  Sorry for the late response.  Here is a good link to get you started:  <a href=\"http://help.datadoghq.com/hc/en-us/articles/204312749-Getting-started-with-tags\" rel=\"nofollow noreferrer\">help.datadoghq.com/hc/en-us/articles/&hellip;</a>"}], "tags": [], "owner": {"reputation": 261, "user_id": 4172512, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CmTsKm9neyc/AAAAAAAAAAI/AAAAAAAAAUc/FnlN7MNc1xo/photo.jpg?sz=128", "display_name": "Andrew Vaughan", "link": "https://stackoverflow.com/users/4172512/andrew-vaughan"}, "is_accepted": false, "score": 4, "last_activity_date": 1453319695, "creation_date": 1453319695, "answer_id": 34909299, "question_id": 34893203, "link": "https://stackoverflow.com/questions/34893203/datadog-custom-metrics-not-showing-up-graph-using-ror/34909299#34909299", "title": "DataDog custom metrics not showing up graph using ROR", "body": "<p>Just a few items to note to get this working:</p>\n\n<p><code>\ndogstatsd = Statsd.new('MY_API_KEY')\n</code></p>\n\n<p>This line of code is trying to use your API key to establish a statsD connection, but this should actually be trying to establish the statsD connection via the statsD port currently configured on your Agent as seen here:</p>\n\n<p><code>\nCreate a stats instance.\nstatsd = Statsd.new('localhost', 8125)\n</code></p>\n\n<blockquote>\n  <p>The easiest way to get your custom metrics into Datadog is to send them to DogStatsD, a metrics aggregation server bundled with the Datadog Agent (in versions 3.0 and above). DogStatsD implements the StatsD protocol, along with a few extensions for special Datadog features.</p>\n</blockquote>\n\n<p><a href=\"http://docs.datadoghq.com/guides/dogstatsd/\" rel=\"nofollow\">http://docs.datadoghq.com/guides/dogstatsd/</a></p>\n\n<p>If you would not like to deploy an Agent on the host running the RoR application, you can utilize DogAPI gem:</p>\n\n<p><a href=\"https://github.com/DataDog/dogapi-rb\" rel=\"nofollow\">https://github.com/DataDog/dogapi-rb</a></p>\n\n<p>Which has additional documentation to get this custom metrics submitted:</p>\n\n<pre><code>require 'rubygems'\nrequire 'dogapi'\n\napi_key = \"abcdef123456\"\n\ndog = Dogapi::Client.new(api_key)\n\ndog.emit_point('some.metric.name', 50.0, :host =&gt; \"my_host\", :device =&gt; \"my_device\")\n</code></pre>\n\n<p>If you have additional questions, please reach out to support@datadoghq.com</p>\n"}], "owner": {"reputation": 207, "user_id": 2039486, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/0433b8361c39089e68aea3753d90a8ae?s=128&d=identicon&r=PG", "display_name": "joe", "link": "https://stackoverflow.com/users/2039486/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3244, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1453319695, "creation_date": 1453272291, "question_id": 34893203, "link": "https://stackoverflow.com/questions/34893203/datadog-custom-metrics-not-showing-up-graph-using-ror", "title": "DataDog custom metrics not showing up graph using ROR", "body": "<p>We are trying to integrate DataDog with our Ruby On Rails app. Our ROR app will continuously add users, update users and delete users every second.</p>\n\n<p>I have integrated Datadog to monitor the no. of users added, updated and deleted through the graph provided by Datadog.</p>\n\n<p>I installed the datadog agent using the command for Ubuntu Aws instance.</p>\n\n<p>I got a free trial for 14 days.</p>\n\n<p>I followed this document for <strong>dogstatd-ruby gem</strong> : <a href=\"https://github.com/DataDog/dogstatsd-ruby\" rel=\"nofollow\">https://github.com/DataDog/dogstatsd-ruby</a></p>\n\n<p>After that i wrote the code in my ruby project like below :</p>\n\n<pre><code>require 'statsd'\n\ndogstatsd = Statsd.new('MY_API_KEY')\n\nuser_data = ExportUser.find_by_userID(user[\"userId\"].to_s)\n\nif user_data.nil?\n   dogstatsd.increment('custom.users.added')  #increment dogstat if a user is added and below query is run\n\n   #new record, go ahead with insertion\n   user_new = ExportUser.new(user)\n   @status = user_new.save\n\nelse\n   dogstatsd.increment('custom.users.updated') #increment dogstat if a user is updated and below query is run\n\n   #existing record, go ahead with updation\n   @status = user_data.update_attributes(user)\nend\n</code></pre>\n\n<p>Here i dont see \"custom.users.updated\" and \"custom.users.added\" graph in the metrics explorer. </p>\n\n<p>I would really appreciate if any1 help me out to set the graph for these 2 metrics in Datadog account. please let me know if i missed anything here.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "redis"], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 5627348, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/665c8b5133710587c6ca0ce0f079b692?s=128&d=identicon&r=PG&f=1", "display_name": "sean an", "link": "https://stackoverflow.com/users/5627348/sean-an"}, "edited": false, "score": 0, "creation_date": 1453314887, "post_id": 34895855, "comment_id": 57551627, "body": "BRPOPLPUSH peekqueue peekqueue 0; maybe just put back to the same queue again?"}, {"owner": {"reputation": 39563, "user_id": 3160475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd8989da0a2c491338617b07df53e60c?s=128&d=identicon&r=PG", "display_name": "Itamar Haber", "link": "https://stackoverflow.com/users/3160475/itamar-haber"}, "reply_to_user": {"reputation": 107, "user_id": 5627348, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/665c8b5133710587c6ca0ce0f079b692?s=128&d=identicon&r=PG&f=1", "display_name": "sean an", "link": "https://stackoverflow.com/users/5627348/sean-an"}, "edited": false, "score": 0, "creation_date": 1453315654, "post_id": 34895855, "comment_id": 57552088, "body": "&#39;fraid not. Even with one peeker and one item in the queue, that would result in an infinite loop. With more than one item and attaching workers to the queue - the peeker will loose items between peeks."}], "tags": [], "owner": {"reputation": 39563, "user_id": 3160475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd8989da0a2c491338617b07df53e60c?s=128&d=identicon&r=PG", "display_name": "Itamar Haber", "link": "https://stackoverflow.com/users/3160475/itamar-haber"}, "is_accepted": false, "score": 0, "last_activity_date": 1453281337, "creation_date": 1453281337, "answer_id": 34895855, "question_id": 34893137, "link": "https://stackoverflow.com/questions/34893137/redis-blocking-peek-in-ruby-in-other-words-block-pop-without-removing/34895855#34895855", "title": "redis blocking peek in ruby, in other words, block pop without removing", "body": "<p>No, there isn't such a method but if you have just one \"peeking\" process and no worries about scalability, perhaps something like <a href=\"http://redis.io/commands/brpoplpush\" rel=\"nofollow\"><code>BRPOPLPUSH peekqueue realqueue 0</code></a> would work for you.</p>\n"}], "owner": {"reputation": 107, "user_id": 5627348, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/665c8b5133710587c6ca0ce0f079b692?s=128&d=identicon&r=PG&f=1", "display_name": "sean an", "link": "https://stackoverflow.com/users/5627348/sean-an"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453281337, "creation_date": 1453272059, "question_id": 34893137, "link": "https://stackoverflow.com/questions/34893137/redis-blocking-peek-in-ruby-in-other-words-block-pop-without-removing", "title": "redis blocking peek in ruby, in other words, block pop without removing", "body": "<p>I use rpush and blpop all the time for message queue since both of them are very efficient blocking method. Is there any block peek method available in redis instead of pop?</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1453273795, "post_id": 34891771, "comment_id": 57524525, "body": "Why do you want to use code from which you know that it doesn&#39;t work and why don&#39;t you want to use the working code?"}], "answers": [{"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": false, "score": 0, "last_activity_date": 1453265996, "creation_date": 1453265996, "answer_id": 34891901, "question_id": 34891771, "link": "https://stackoverflow.com/questions/34891771/ambiguous-clause-in-rails-4/34891901#34891901", "title": "Ambiguous clause in Rails 4", "body": "<p>sql needs to know which tables email column you want to compare to -- if you want it compare to multiple email columns then you'll need to OR them together like</p>\n\n<pre><code>where([\"listings_buyer.email LIKE ? OR other_table.email LIKE ?\",'%%','%%'])\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 4799237, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/beeff7737c90568ecd99e85ffc560c2f?s=128&d=identicon&r=PG&f=1", "display_name": "b&#225;ch tr\u1ea7n nguy&#234;n", "link": "https://stackoverflow.com/users/4799237/b%c3%a1ch-tr%e1%ba%a7n-nguy%c3%aan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 311, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453272358, "creation_date": 1453265113, "last_edit_date": 1453272358, "question_id": 34891771, "link": "https://stackoverflow.com/questions/34891771/ambiguous-clause-in-rails-4", "title": "Ambiguous clause in Rails 4", "body": "<p>I have a join 4 tables</p>\n\n<pre><code>ListingBuyer.joins('left join buyers on listing_buyers.email = buyers.email left join buyer_infos on buyers.id = buyer_infos.buyer_id').joins(:listing).select('listing_buyers.*').where([\"email LIKE ?\",'%%'])\n</code></pre>\n\n<p>when I run above sql. \nerrors => </p>\n\n<blockquote>\n  <p>ActiveRecord::StatementInvalid: Mysql2::Error: Column 'email' in where clause is ambiguous: SELECT <code>listing_buyers</code>.* FROM <code>listing_buyers</code> INNER JOIN <code>listings</code> ON <code>listings</code>.<code>id</code> = <code>listing_buyers</code>.<code>listing_id</code> left join buyers on listing_buyers.email = buyers.email left join buyer_infos on buyers.id = buyer_infos.buyer_id WHERE (email LIKE '%%')</p>\n</blockquote>\n\n<p>after, an edit sql command to </p>\n\n<pre><code>ListingBuyer.joins('left join buyers on listing_buyers.email = buyers.email left join buyer_infos on buyers.id = buyer_infos.buyer_id').joins(:listing).select('listing_buyers.*').where([\"listing_buyers.email LIKE ?\",'%%'])\n</code></pre>\n\n<p>The code above works ok.</p>\n\n<p>I want to use sql\n    .where([\"email LIKE ?\",'%%'])\ndon't want use </p>\n\n<pre><code>where([\"listing_buyers.email LIKE ?\",'%%'])\n</code></pre>\n\n<p>How to edit this sql code </p>\n\n<pre><code>  ListingBuyer.joins('left join buyers on listing_buyers.email = buyers.email left join buyer_infos on buyers.id = buyer_infos.buyer_id').joins(:listing).select('listing_buyers.*')\n</code></pre>\n\n<p>Can use</p>\n\n<pre><code>where([\"email LIKE ?\",'%%'])\n</code></pre>\n\n<p>Pls help me.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "favorites"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 4310077, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/11900571/picture?type=large", "display_name": "Greg S&#233;guin", "link": "https://stackoverflow.com/users/4310077/greg-s%c3%a9guin"}, "edited": false, "score": 0, "creation_date": 1453312130, "post_id": 34892485, "comment_id": 57550025, "body": "Aha!  This is exactly it. Thanks for your help mackshkatz!"}], "tags": [], "owner": {"reputation": 671, "user_id": 1022988, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3bd37d358d61584d5d08b42148ab090c?s=128&d=identicon&r=PG", "display_name": "mackshkatz", "link": "https://stackoverflow.com/users/1022988/mackshkatz"}, "is_accepted": true, "score": 0, "last_activity_date": 1453269179, "creation_date": 1453269179, "answer_id": 34892485, "question_id": 34891749, "link": "https://stackoverflow.com/questions/34891749/how-to-mark-and-unmark-an-object-as-a-favorite-in-rails-with-a-single-button/34892485#34892485", "title": "How to mark and unmark an object as a &#39;favorite&#39; in Rails with a single button?", "body": "<p>One option would be to check in the action that renders that view (which appears to be jokes_controller#show) if the current_user has a row in the favorite_jokes table for that particular joke.</p>\n\n<p>In the jokes_controller#show action:</p>\n\n<pre><code>@favorited = FavoriteJoke.find_by(user: current_user, joke: @joke).present?\n</code></pre>\n\n<p>Then in the view, something like:</p>\n\n<pre><code>&lt;% if @favorited %&gt;\n  &lt;%= link_to \"unfavorite\", unfavorite_joke_path(@joke), method: :put %&gt;\n&lt;% else %&gt;\n  &lt;%= link_to \"favorite\", favorite_joke_path(@joke), method: :put %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Then in your <code>routes.rb</code> file, create a route for both favoriting and unfavoriting, rather than doing that logic in one action. </p>\n"}], "owner": {"reputation": 47, "user_id": 4310077, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/11900571/picture?type=large", "display_name": "Greg S&#233;guin", "link": "https://stackoverflow.com/users/4310077/greg-s%c3%a9guin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 782, "favorite_count": 0, "accepted_answer_id": 34892485, "answer_count": 1, "score": 0, "last_activity_date": 1453269179, "creation_date": 1453264918, "question_id": 34891749, "link": "https://stackoverflow.com/questions/34891749/how-to-mark-and-unmark-an-object-as-a-favorite-in-rails-with-a-single-button", "title": "How to mark and unmark an object as a &#39;favorite&#39; in Rails with a single button?", "body": "<p>I implemented a feature where a user marks jokes as favorites. Because I'm already using acts_as_votable for upvoting/downvoting and want favoriting to be distinct from a users upvotes, I've built it on my own.</p>\n\n<p>Right now, A user creates a favorite by clicking a 'favorite' link or 'unfavorite' link. This isn't ideal because a user can create duplicate favorites this way. </p>\n\n<p>I'd prefer to change it to a toggle where I first check to see if a user has marked the joke as a favorite, and then display the appropriate action based on that state. I'm not sure how to go about it though. Can anyone point me in the right direction?</p>\n\n<p>My jokes controller:</p>\n\n<pre><code>  # Add and remove favorite jokes\n  # for current_user\n  def favorite\n    @joke = Joke.find(params[:id])\n    type = params[:type]\n    if type == \"favorite\"\n      current_user.favorites &lt;&lt; @joke\n      redirect_to :back, notice: 'Added to favorites'\n\n    elsif type == \"unfavorite\"\n      current_user.favorites.delete(@joke)\n      redirect_to :back, notice: 'Removed from favorites'\n\n    else\n      # Type missing, nothing happens\n      redirect_to :back, notice: 'Nothing happened.'\n    end\n  end\n</code></pre>\n\n<p>My models:\n(Joke)</p>\n\n<pre><code>has_many :favorite_jokes\nhas_many :favorited_by, through: :favorite_jokes, source: :user\n</code></pre>\n\n<p>(Favorite_Joke)</p>\n\n<pre><code>belongs_to :joke\nbelongs_to :user\n</code></pre>\n\n<p>(User)</p>\n\n<pre><code>  has_many :favorite_jokes\n  has_many :favorites, through: :favorite_jokes, source: :joke\n</code></pre>\n\n<p>My View:</p>\n\n<pre><code>&lt;div class=\"col-sm-4 col-xs-12 text-center\"&gt;\n        &lt;button type=\"button\" class=\"btn btn-danger btn-block\"&gt;\n            &lt;i class=\"fa fa-heart\"&gt;&lt;/i&gt;\n            &lt;span class=\"badge\"&gt;favorite&lt;/span&gt;\n        &lt;/button&gt;\n&lt;/div&gt;\n\n&lt;% if current_user %&gt;\n  &lt;%= link_to \"favorite\", favorite_joke_path(@joke, type: \"favorite\"), method: :put %&gt;\n  &lt;%= link_to \"unfavorite\", favorite_joke_path(@joke, type: \"unfavorite\"), method: :put %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>And finally, my routes:</p>\n\n<pre><code>resources :jokes do\n    member do\n      put \"like\" =&gt; \"jokes#upvote\"\n      put \"unlike\" =&gt; \"jokes#downvote\"\n    end\n      put :favorite, on: :member\n  end\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1453277006, "post_id": 34891694, "comment_id": 57526078, "body": "What is your question?"}, {"owner": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "edited": false, "score": 0, "creation_date": 1453305808, "post_id": 34891694, "comment_id": 57545623, "body": "You should accept the answer that helped you by clicking the big check mark beside the answer."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1453322954, "post_id": 34891694, "comment_id": 57556139, "body": "Hint: what does the <code>s</code> in <code>gets</code> mean?"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4771925, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f7ce080a5a2c8e439ded54d423cfb737?s=128&d=identicon&r=PG&f=1", "display_name": "MadelineStates", "link": "https://stackoverflow.com/users/4771925/madelinestates"}, "edited": false, "score": 0, "creation_date": 1453265058, "post_id": 34891719, "comment_id": 57521508, "body": "Yep, that worked! Thanks so much, I knew that it&#39;d be a simple fix."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1453273180, "post_id": 34891719, "comment_id": 57524273, "body": "If you use <code>.to_i</code>, you don&#39;t need <code>.chomp</code>"}], "tags": [], "owner": {"reputation": 1232, "user_id": 5277935, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/--NcqcZABxrM/AAAAAAAAAAI/AAAAAAAAAe8/7U38ZDcw2kQ/photo.jpg?sz=128", "display_name": "AMACB", "link": "https://stackoverflow.com/users/5277935/amacb"}, "is_accepted": false, "score": 1, "last_activity_date": 1453264684, "creation_date": 1453264684, "answer_id": 34891719, "question_id": 34891694, "link": "https://stackoverflow.com/questions/34891694/if-statement-not-working-with-gets-in-ruby/34891719#34891719", "title": "If statement not working with gets() in Ruby", "body": "<p><code>gets()</code> by itself included the <code>newline</code> character. Use <code>gets.chomp</code> to remove that extra character. Then, call <code>.to_i</code> to convert to an integer. So: <code>gets.chomp.to_i</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "is_accepted": false, "score": 2, "last_activity_date": 1453272904, "creation_date": 1453272904, "answer_id": 34893367, "question_id": 34891694, "link": "https://stackoverflow.com/questions/34891694/if-statement-not-working-with-gets-in-ruby/34893367#34893367", "title": "If statement not working with gets() in Ruby", "body": "<p>You can simply do:</p>\n\n<pre><code>gets.to_i\n</code></pre>\n\n<p>which will essentially <code>chomp</code> the newline character and convert to integer.</p>\n\n<p>Example:</p>\n\n<pre><code>2.1.2-perf :020 &gt; num = gets.to_i\n44\n =&gt; 44\n2.1.2-perf :021 &gt; if num == 44\n2.1.2-perf :022?&gt;       puts \"Yeah\"\n2.1.2-perf :023?&gt;   end\nYeah\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40, "user_id": 5299899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f2464d187fd7e7caeb42971fc55a7a?s=128&d=identicon&r=PG&f=1", "display_name": "Manu", "link": "https://stackoverflow.com/users/5299899/manu"}, "is_accepted": true, "score": 2, "last_activity_date": 1453273555, "creation_date": 1453273555, "answer_id": 34893551, "question_id": 34891694, "link": "https://stackoverflow.com/questions/34891694/if-statement-not-working-with-gets-in-ruby/34893551#34893551", "title": "If statement not working with gets() in Ruby", "body": "<p>The ouput is \"No\" because when you use gets actually the input is taken as string, so a mismatch occurs. So for your logic to work you should convert it into integer</p>\n\n<p>So this is the solution</p>\n\n<pre><code>puts \"Enter num: \"\nnum = gets().to_i\nif num == 44\n    puts \"Yeah\" \nend\nunless num == 44\n    puts \"No\"\nend\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4771925, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f7ce080a5a2c8e439ded54d423cfb737?s=128&d=identicon&r=PG&f=1", "display_name": "MadelineStates", "link": "https://stackoverflow.com/users/4771925/madelinestates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 34893551, "answer_count": 3, "score": 1, "last_activity_date": 1453276994, "creation_date": 1453264528, "last_edit_date": 1453276994, "question_id": 34891694, "link": "https://stackoverflow.com/questions/34891694/if-statement-not-working-with-gets-in-ruby", "title": "If statement not working with gets() in Ruby", "body": "<p>When I ask the user for input like this:</p>\n\n<pre><code>puts \"Enter num: \"\nnum = gets()\nif num == 44\n  puts \"Yeah\" \nend\nunless num == 44\n  puts \"No\"\nend\n</code></pre>\n\n<p>the output is <code>\"No\"</code> when I enter <code>44</code> when prompted. I can't figure out what's going on, so please help.</p>\n"}, {"tags": ["ruby", "mechanize"], "answers": [{"comments": [{"owner": {"reputation": 3739, "user_id": 405763, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/6b82901f73413a8061f2d0784d7726b8?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/405763/joseph"}, "edited": false, "score": 0, "creation_date": 1453265220, "post_id": 34891679, "comment_id": 57521544, "body": "Thank you. I&#39;ve run <code>gem install http-cookie</code> but of course Mechanize doesn&#39;t detect this. I wonder what else I can do to remove the warnings."}, {"owner": {"reputation": 1143, "user_id": 1563837, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0784ce3665c294c4547f81a212014d4b?s=128&d=identicon&r=PG", "display_name": "Josh Bodah", "link": "https://stackoverflow.com/users/1563837/josh-bodah"}, "reply_to_user": {"reputation": 3739, "user_id": 405763, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/6b82901f73413a8061f2d0784d7726b8?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/405763/joseph"}, "edited": false, "score": 0, "creation_date": 1453266089, "post_id": 34891679, "comment_id": 57521792, "body": "Working backwards, I found one of the warnings here: <a href=\"https://github.com/sparklemotion/mechanize/blob/master/lib/mechanize/cookie_jar.rb\" rel=\"nofollow noreferrer\">github.com/sparklemotion/mechanize/blob/master/lib/mechanize&zwnj;&#8203;/&hellip;</a> You could try to find where that file is <code>require</code>d or try and figure out if you can flip off that <code>$VERBOSE</code> flag"}], "tags": [], "owner": {"reputation": 1143, "user_id": 1563837, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0784ce3665c294c4547f81a212014d4b?s=128&d=identicon&r=PG", "display_name": "Josh Bodah", "link": "https://stackoverflow.com/users/1563837/josh-bodah"}, "is_accepted": true, "score": 1, "last_activity_date": 1453264389, "creation_date": 1453264389, "answer_id": 34891679, "question_id": 34891637, "link": "https://stackoverflow.com/questions/34891637/getting-deprecated-warnings-whilst-using-mechanize/34891679#34891679", "title": "Getting &#39;deprecated&#39; warnings whilst using Mechanize", "body": "<p>Whenever I get errors like these I do something like the following:</p>\n\n<pre><code>bundle list my_gem\ncd &lt;DIR&gt;\nag 'Please migrate to'\n</code></pre>\n\n<p>That usually points me to the source of the problem</p>\n\n<p>EDIT: note going to the http-cookies github shows that it was extracted from Mechanize: <a href=\"https://github.com/sparklemotion/http-cookie\" rel=\"nofollow\">https://github.com/sparklemotion/http-cookie</a></p>\n"}], "owner": {"reputation": 3739, "user_id": 405763, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/6b82901f73413a8061f2d0784d7726b8?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/405763/joseph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 34891679, "answer_count": 1, "score": 0, "last_activity_date": 1453267181, "creation_date": 1453264098, "last_edit_date": 1453267181, "question_id": 34891637, "link": "https://stackoverflow.com/questions/34891637/getting-deprecated-warnings-whilst-using-mechanize", "title": "Getting &#39;deprecated&#39; warnings whilst using Mechanize", "body": "<p>I'm getting these warnings everything I run Mechanize with Ruby.</p>\n\n<pre><code>mechanize/cookie will be deprecated.  Please migrate to the http-cookie APIs.\nmechanize/cookie_jar will be deprecated.  Please migrate to the http-cookie APIs.\n</code></pre>\n\n<p>I can't seem to find any documentation on how to change my code so that these errors clear away.</p>\n\n<pre><code>#!/usr/bin/ruby -w\n\nrequire 'rubygems'\nrequire 'mechanize'\n\na = Mechanize.new { |agent|\n    agent.user_agent_alias = 'Mac Safari'\n}\n\ntitle = a.get('http://google.com').title\nputs title\n</code></pre>\n\n<p>I suppose I need to install something that satisfies these requirements?</p>\n\n<p><em>Please migrate to the http-cookie APIs.</em></p>\n\n<p><strong>Edit 1</strong></p>\n\n<p>Installing <code>gem install http-cookie</code> doesn't make a difference with regards to these warnings. I can't tell if Mechanize knows to use <code>http-cookie</code> or if it just uses the incorrect <code>cookie_jar</code> anyway.</p>\n"}, {"tags": ["ruby", "homebrew"], "comments": [{"owner": {"reputation": 24570, "user_id": 2272172, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/40d9cf17504d06006a0154ef0b332457?s=128&d=identicon&r=PG&f=1", "display_name": "cel", "link": "https://stackoverflow.com/users/2272172/cel"}, "edited": false, "score": 1, "creation_date": 1453267368, "post_id": 34891438, "comment_id": 57522202, "body": "Stop the video at 4:22 and look at the first comand. Double check if you used the same one. It starts with <code>mkdir homebrew &amp;&amp; ...</code>"}, {"owner": {"reputation": 57, "user_id": 2205697, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9c7b4a6c33bd933c67fa860eca34f168?s=128&d=identicon&r=PG", "display_name": "Alistair Norris", "link": "https://stackoverflow.com/users/2205697/alistair-norris"}, "reply_to_user": {"reputation": 24570, "user_id": 2272172, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/40d9cf17504d06006a0154ef0b332457?s=128&d=identicon&r=PG&f=1", "display_name": "cel", "link": "https://stackoverflow.com/users/2272172/cel"}, "edited": false, "score": 0, "creation_date": 1453267674, "post_id": 34891438, "comment_id": 57522307, "body": "Dude, I love you. Thanks! I&#39;m not sure at what point I screwed that up but it&#39;s now in users:) Thanks a bunch!"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 2205697, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9c7b4a6c33bd933c67fa860eca34f168?s=128&d=identicon&r=PG", "display_name": "Alistair Norris", "link": "https://stackoverflow.com/users/2205697/alistair-norris"}, "edited": false, "score": 0, "creation_date": 1453267260, "post_id": 34892084, "comment_id": 57522157, "body": "This is what I&#39;m getting when I do this   -bash: $: command not found"}], "tags": [], "owner": {"reputation": 309, "user_id": 5330531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q7YJY.gif?s=128&g=1", "display_name": "Screed", "link": "https://stackoverflow.com/users/5330531/screed"}, "is_accepted": false, "score": -1, "last_activity_date": 1453267116, "creation_date": 1453267116, "answer_id": 34892084, "question_id": 34891438, "link": "https://stackoverflow.com/questions/34891438/homebrew-installing-in-wrong-location/34892084#34892084", "title": "Homebrew installing in wrong location?", "body": "<p>The lecturer thinks what you in the directory where homebrew is installing, but you not.</p>\n\n<p>To find where is your homebrew use:</p>\n\n<pre><code>$ brew --prefix\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 2205697, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9c7b4a6c33bd933c67fa860eca34f168?s=128&d=identicon&r=PG", "display_name": "Alistair Norris", "link": "https://stackoverflow.com/users/2205697/alistair-norris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453267116, "creation_date": 1453262992, "question_id": 34891438, "link": "https://stackoverflow.com/questions/34891438/homebrew-installing-in-wrong-location", "title": "Homebrew installing in wrong location?", "body": "<p>I'm currently beginning to learn ruby and have been running through a tutorial at <a href=\"https://www.coursera.org/learn/ruby-on-rails-intro/lecture/mXAJX/software-installation-for-mac-users\" rel=\"nofollow\">Coursera</a>. In the tutorial I get stuck really early on during install homebrew... </p>\n\n<p>The lecturer does an <strong>ls -al</strong> call in terminal that shows '<strong>homebrew</strong>' in the list but when I do it, it doesn't come up. </p>\n\n<p>I'm finding my homebrew in usr/local/library/homebrew but I cant seem to cd into there to keep on following the tutorial.</p>\n\n<p>When I try to cd homebrew/ I get this message - <strong>-bash: cd: homebrew: No such file or directory</strong></p>\n\n<p>I feel like I've screwed up at some point early on but I can't find it. I've tried to uninstall script and repeating but I'm getting the same results...</p>\n\n<p>Maybe I'm just being stupid but it's stopping me continuing as I can't write directly into the folder.</p>\n\n<p>Can someone tell me how I'm screwing up?</p>\n"}, {"tags": ["ruby", "terminal"], "comments": [{"owner": {"reputation": 1143, "user_id": 1563837, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0784ce3665c294c4547f81a212014d4b?s=128&d=identicon&r=PG", "display_name": "Josh Bodah", "link": "https://stackoverflow.com/users/1563837/josh-bodah"}, "edited": false, "score": 0, "creation_date": 1453264052, "post_id": 34891355, "comment_id": 57521219, "body": "Perhaps Process.spawn and passing in IO redirection? I&#39;ve seen Foreman do this for prepending the server name for each pid to all of the output logs during log aggregation <a href=\"https://github.com/ddollar/foreman/blob/master/lib/foreman/process.rb#L54\" rel=\"nofollow noreferrer\">github.com/ddollar/foreman/blob/master/lib/foreman/&hellip;</a>"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 1, "creation_date": 1453264576, "post_id": 34891355, "comment_id": 57521368, "body": "As for colored output, Ruby doesn&#39;t filter the output at all. If the output includes ANSI color codes and you capture the output, you&#39;ll get them."}, {"owner": {"reputation": 1232, "user_id": 5277935, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/--NcqcZABxrM/AAAAAAAAAAI/AAAAAAAAAe8/7U38ZDcw2kQ/photo.jpg?sz=128", "display_name": "AMACB", "link": "https://stackoverflow.com/users/5277935/amacb"}, "edited": false, "score": 0, "creation_date": 1453264826, "post_id": 34891355, "comment_id": 57521454, "body": "You should be able to cancel a script with <code>Ctrl+C</code>."}], "answers": [{"tags": [], "owner": {"reputation": 311, "user_id": 1353505, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/arxrZ.jpg?s=128&g=1", "display_name": "ldanielw1", "link": "https://stackoverflow.com/users/1353505/ldanielw1"}, "is_accepted": true, "score": 1, "last_activity_date": 1453265869, "creation_date": 1453265869, "answer_id": 34891869, "question_id": 34891355, "link": "https://stackoverflow.com/questions/34891355/how-to-execute-a-system-command-that-prints-in-color-while-capturing-output-but/34891869#34891869", "title": "How to execute a system command that prints in color while capturing output, but can also be cancelled in Ruby?", "body": "<p>After messing around with it for a while, I found that IO.popen returns an object that contains the pid, and can also be used to print all captured output. It also doesn't interfere with the ANSI output of system commands called from within Ruby. My code looks something like this now:</p>\n\n<pre><code>#!/usr/bin/ruby\n\ndef shutdown()\n    `kill #{$pid}`\nend\n\n[\"INT\", \"KILL\", \"TERM\"].each { |_sig| Signal.trap(_sig) { shutdown() }     }\n\nprocess = IO.popen(\"ls --color ~; ping -c 10 www.google.com\")\n$pid = process.pid\nprocess.each { |_line| puts _line }\n</code></pre>\n\n<p>I can thus cancel the ls and ping commands without cancelling my Ruby code with a control-C from terminal, and also manipulate the lines before printing them if I want to.</p>\n"}, {"comments": [{"owner": {"reputation": 31446, "user_id": 18804, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/058ed9c852869d7557262a8d2ce8783b?s=128&d=identicon&r=PG", "display_name": "philant", "link": "https://stackoverflow.com/users/18804/philant"}, "edited": false, "score": 0, "creation_date": 1493390286, "post_id": 39312586, "comment_id": 74411640, "body": "This does not work (colorization is lost) in my environment : Mac OSX el capitan, bash, iTerm2 and Ruby 2.0.0."}], "tags": [], "owner": {"reputation": 28645, "user_id": 256854, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/XUdwS.jpg?s=128&g=1", "display_name": "dkinzer", "link": "https://stackoverflow.com/users/256854/dkinzer"}, "is_accepted": false, "score": -1, "last_activity_date": 1472949853, "creation_date": 1472949853, "answer_id": 39312586, "question_id": 34891355, "link": "https://stackoverflow.com/questions/34891355/how-to-execute-a-system-command-that-prints-in-color-while-capturing-output-but/39312586#39312586", "title": "How to execute a system command that prints in color while capturing output, but can also be cancelled in Ruby?", "body": "<p>Another similar solution is to use <code>$stdout</code> global as in:</p>\n\n<p><code>\n$stdout.puts `ls --color ~; ping -c 10 www.google.com`\n</code></p>\n"}], "owner": {"reputation": 311, "user_id": 1353505, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/arxrZ.jpg?s=128&g=1", "display_name": "ldanielw1", "link": "https://stackoverflow.com/users/1353505/ldanielw1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 404, "favorite_count": 0, "accepted_answer_id": 34891869, "answer_count": 2, "score": 2, "last_activity_date": 1472949853, "creation_date": 1453262439, "question_id": 34891355, "link": "https://stackoverflow.com/questions/34891355/how-to-execute-a-system-command-that-prints-in-color-while-capturing-output-but", "title": "How to execute a system command that prints in color while capturing output, but can also be cancelled in Ruby?", "body": "<p>Ruby has a lot of ways to run system commands, be it with system(), or exec(), or backticks, etc.</p>\n\n<p>However, I've been finding that only system and exec (as far as I know) are able to print the colored output of some of my commands while also providing a PID which allows me to cancel the command.</p>\n\n<p>Is there any other way to run system commands from a Ruby command-line script such that I am able to meet the following requirements?</p>\n\n<ol>\n<li>See the colored output (helps with organization)</li>\n<li>Capture output to a variable</li>\n<li>Get a PID so I can cancel execution if I need to (I already have the code for this, I just need the PID)</li>\n</ol>\n"}, {"tags": ["arrays", "ruby", "algorithm"], "comments": [{"owner": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "edited": false, "score": 2, "creation_date": 1453261601, "post_id": 34891170, "comment_id": 57520532, "body": "Could you please format your question better?"}, {"owner": {"reputation": 71, "user_id": 5813634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c324731ee7a5abfd2afd183064b53be?s=128&d=identicon&r=PG&f=1", "display_name": "Jazz", "link": "https://stackoverflow.com/users/5813634/jazz"}, "reply_to_user": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "edited": false, "score": 0, "creation_date": 1453261771, "post_id": 34891170, "comment_id": 57520586, "body": "Sorry. I just updated my question."}, {"owner": {"reputation": 48375, "user_id": 188331, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/UhYfd.jpg?s=128&g=1", "display_name": "Raptor", "link": "https://stackoverflow.com/users/188331/raptor"}, "edited": false, "score": 1, "creation_date": 1453262234, "post_id": 34891170, "comment_id": 57520713, "body": "Can <a href=\"http://codereview.stackexchange.com\">codereview.stackexchange.com</a> help?"}, {"owner": {"reputation": 71, "user_id": 5813634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c324731ee7a5abfd2afd183064b53be?s=128&d=identicon&r=PG&f=1", "display_name": "Jazz", "link": "https://stackoverflow.com/users/5813634/jazz"}, "edited": false, "score": 0, "creation_date": 1453262423, "post_id": 34891170, "comment_id": 57520772, "body": "I will try my question there. thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1453322889, "post_id": 34891968, "comment_id": 57556108, "body": "Also, as Cary noted in his answer, finding one factor actually often gives you a second factor &quot;almost&quot; for free."}, {"owner": {"reputation": 71, "user_id": 5813634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c324731ee7a5abfd2afd183064b53be?s=128&d=identicon&r=PG&f=1", "display_name": "Jazz", "link": "https://stackoverflow.com/users/5813634/jazz"}, "edited": false, "score": 0, "creation_date": 1453331864, "post_id": 34891968, "comment_id": 57560582, "body": "Thanks task! I completely forgot about using the square root function to simplify a way to obtain divisors."}], "tags": [], "owner": {"reputation": 43502, "user_id": 377953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hm9UN.jpg?s=128&g=1", "display_name": "taskinoor", "link": "https://stackoverflow.com/users/377953/taskinoor"}, "is_accepted": false, "score": 1, "last_activity_date": 1453266355, "creation_date": 1453266355, "answer_id": 34891968, "question_id": 34891170, "link": "https://stackoverflow.com/questions/34891170/find-all-integers-between-m-and-n-whose-sum-of-squared-divisors-is-itself-a-squa/34891968#34891968", "title": "Find all integers between m and n whose sum of squared divisors is itself a square", "body": "<p>I don't know Ruby but the problem lies with the algorithm used in finding the divisors of a number (which is not specific to the language used, i.e. Ruby in this case).</p>\n\n<pre><code>r = (m..n).to_a.map { |z| (1..z).select { |x| z % x == 0} }\n</code></pre>\n\n<p>To find the divisors of an integer <code>n</code> you are dividing <code>n</code> by all positive integers unto <code>n - 1</code> which means the loop runs <code>n - 1</code> times. However, it is enough to divide upto <code>sort(n)</code> to calculate the divisors. In pseudocode this looks like below:</p>\n\n<pre><code>for i = 1 to i &lt;= sqrt(n)\n    r = n % i\n    if r == 0 then\n        i is a divisor\n        if n / i != i then\n            n / i is another divisor\n</code></pre>\n\n<p>For example:</p>\n\n<pre><code>sqrt_42 = 6.48074069840786\ni = 1 =&gt; 1 and 42 are two divisors\ni = 2 =&gt; 2 and 21\ni = 3 =&gt; 3 and 14\ni = 4 =&gt; no divisor\ni = 5 =&gt; no divisor\ni = 6 =&gt; 6 and 7\n</code></pre>\n\n<p>And thats all.</p>\n\n<p>This will improve the performance a lot since now the loop runs only <code>sort(n)</code> times instead of <code>n - 1</code> times which is a big difference for large <code>n</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 9567, "user_id": 7916438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8541ff62182bcfd172e116a4e0d2fa58?s=128&d=identicon&r=PG", "display_name": "tevemadar", "link": "https://stackoverflow.com/users/7916438/tevemadar"}, "edited": false, "score": 0, "creation_date": 1557062070, "post_id": 34894615, "comment_id": 98632394, "body": "The approach may be nice, but the result is just plain wrong. The numbers should be <code>[1, 42, 246, 287, 728]</code>, just as they appear in the question. The issue comes from doubling the &quot;middle&quot; term when checked number is a square number itself (so <code>n == q&#47;n</code>)."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1557079340, "post_id": 34894615, "comment_id": 98637102, "body": "@tevemader, &quot;just plain wrong&quot;? Not, &quot;you forgot...&quot;? :-) In any event, thanks for pointing out the error. I&#39;ve fixed it."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 3, "last_activity_date": 1557176903, "last_edit_date": 1557176903, "creation_date": 1453277220, "answer_id": 34894615, "question_id": 34891170, "link": "https://stackoverflow.com/questions/34891170/find-all-integers-between-m-and-n-whose-sum-of-squared-divisors-is-itself-a-squa/34894615#34894615", "title": "Find all integers between m and n whose sum of squared divisors is itself a square", "body": "<p><strong>Brute-force calculatioins of factors</strong></p>\n\n<p>You begin by calculating:</p>\n\n<pre><code>m, n = 40, 42\nr = (m..n).to_a.map { |z| (1..z).select { |x| z % x == 0} }\n  #=&gt; [[1, 2, 4, 5, 8, 10, 20, 40], [1, 41], [1, 2, 3, 6, 7, 14, 21, 42]]\n</code></pre>\n\n<p>That's OK, but you don't need <code>.to_a</code>:</p>\n\n<pre><code>r = (m..n).map { |z| (1..z).select { |x| z % x == 0} }\n  #=&gt; [[1, 2, 4, 5, 8, 10, 20, 40], [1, 41], [1, 2, 3, 6, 7, 14, 21, 42]]\n</code></pre>\n\n<p>This avoids an extra step, which is the creation of the temporary array<sup>1,2</sup>:</p>\n\n<pre><code>(m..n).to_a #=&gt; [40, 41, 42]\n</code></pre>\n\n<p><strong>Structure of a solution</strong></p>\n\n<p>Let's work backwards to come up with our code. First, concentrate on determining, for any given number <code>q</code>, if the sum of squares of the factors of <code>q</code> is itself a perfect square. Suppose we construct a method <code>magic_number?</code> which takes <code>q</code> as its only argument and returns <code>true</code> if <code>q</code> satisfies the required property and <code>false</code> otherwise. Then we will compute:</p>\n\n<pre><code>(m..n).select { |q| magic_number?(q) }\n</code></pre>\n\n<p>to return an array of all numbers between <code>m</code> and <code>n</code> that satisfy the property. <code>magic_number?</code> can be written like this:</p>\n\n<pre><code>def magic_number?(q)\n  return true if q == 1\n  s = sum_of_squared_factors(q)\n  s == Math.sqrt(s).round**2\nend\n</code></pre>\n\n<p><strong>Calculating sum of squared factors</strong></p>\n\n<p>So now we are left with writing the method <code>sum_of_squared_factors</code>. We can use your code to obtain the factors:</p>\n\n<pre><code>def factors(q)\n  (1..q).select { |x| q % x == 0 }\nend\n\nfactors(40) #=&gt; [1, 2, 4, 5, 8, 10, 20, 40] \nfactors(41) #=&gt; [1, 41] \nfactors(42) #=&gt; [1, 2, 3, 6, 7, 14, 21, 42]\n</code></pre>\n\n<p>and then write:</p>\n\n<pre><code>def sum_of_squared_factors(q)\n  factors(q).reduce(0) { |t,i| t + i*i }\nend\n\nsum_of_squared_factors(40) #=&gt; 2210 \nsum_of_squared_factors(41) #=&gt; 1682 \nsum_of_squared_factors(42) #=&gt; 2500 \n</code></pre>\n\n<p><strong>Speeding the calculation of factors</strong></p>\n\n<p>There's something more we can do to speed up the calculation of factors. If <code>f</code> is a factor of <code>n</code>, <code>f</code> and <code>n/f</code>, are both factors of <code>n</code>. (For example, since <code>3</code> is a factor of <code>42</code>, so is <code>42/3 #=&gt; 14</code>). We therefore need only obtain the smaller of each pair.</p>\n\n<p>There is one exception to this rule. If <code>n</code> is a perfect square and <code>f == n**0.5</code>, then <code>f = n/f</code>, so we only include <code>f</code> among the factors of <code>n</code> (not <code>n/f</code> as well). </p>\n\n<p>If turns out that if <code>f</code> is the smaller of the pair, <code>f &lt;=(n**0.5).round</code><sup>3</sup>. We therefore need only check to see which of the numbers <code>(1..(n**0.5).round)</code> are factors and include their complements (unless <code>n</code> is a perfect square, in which case we do not double-count <code>(n**0.5).round</code>):</p>\n\n<pre><code>q = 42\narr = (1..Math.sqrt(q).round).select { |x| q % x == 0 }\n  #=&gt; [1, 2, 3, 6] \narr = arr.flat_map { |n| [n, q/n] }\n  #=&gt; [1, 42, 2, 21, 3, 14, 6, 7] \narr.pop if a[-2] == a[-1]\narr\n  #=&gt; [1, 42, 2, 21, 3, 14, 6, 7]\n\nq = 36\narr = (1..Math.sqrt(q).round).select { |x| q % x == 0 }\n  #=&gt; [1, 2, 3, 4, 6] \narr = arr.flat_map { |n| [n, q/n] }\n  #=&gt; [1, 36, 2, 18, 3, 12, 4, 9, 6, 6] \narr.pop if a[-2] == a[-1]\n  #=&gt; 6 \narr\n  #=&gt; [1, 36, 2, 18, 3, 12, 4, 9, 6] \n</code></pre>\n\n<p>so we can write:</p>\n\n<pre><code>def factors(q)\n  arr = (1..Math.sqrt(q)).select { |x| q % x == 0 }\n  arr = arr.flat_map { |n| [n, q/n] }\n  arr.pop if arr[-2] == arr[-1]\n  arr\nend\n</code></pre>\n\n<p>Substituting out <code>arr</code> (\"chaining\" expressions), we obtain a typical Ruby expression:</p>\n\n<pre><code>def factors(q)\n  (1..Math.sqrt(q)).select { |x| q % x == 0 }.\n    flat_map { |n| [n, q/n] }.\n    tap { |a| a.pop if a[-2] == a[-1] }\nend\n\nfactors(42)\n  #=&gt; [1, 42, 2, 21, 3, 14, 6, 7] \nfactors(36)\n  #=&gt; [1, 36, 2, 18, 3, 12, 4, 9, 6] \n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-flat_map\" rel=\"nofollow noreferrer\">Enumerable#flat_map</a> and <a href=\"https://ruby-doc.org/core-2.6.3/Object.html#method-i-tap\" rel=\"nofollow noreferrer\">Object#tap</a>. (There's no need for this array to be sorted. In applications where it needs to be sorted, just tack <code>.sort</code> onto the end of <code>flat_map</code>s block.)</p>\n\n<p><strong>Wrapping up</strong></p>\n\n<p>In sum, we are left with the following:</p>\n\n<pre><code>def magic_number?(q)\n  return true if q == 1\n  s = sum_of_squared_factors(q)\n  s == Math.sqrt(s).round**2\nend\n\ndef sum_of_squared_factors(q)\n  factors(q).reduce(0) { |t,i| t + i*i }\nend\n\ndef factors(q)\n  (1..Math.sqrt(q)).select { |x| q % x == 0 }.\n    flat_map { |n| [n, q/n] }.\n    tap { |a| a.pop if a[-2] == a[-1] }\nend\n\nm, n = 1, 1000\n(m..n).select { |q| magic_number?(q) }\n  #=&gt; `[1, 42, 246, 287, 728]\n</code></pre>\n\n<p>This calculation was completed in a blink of an eye.</p>\n\n<p><strong>Compute primes to further speed calculation of factors</strong></p>\n\n<p>Lastly, let me describe an even faster way to compute the factors of a number, using the method <a href=\"https://ruby-doc.org/stdlib-2.5.1/libdoc/prime/rdoc/Prime.html#method-i-prime_division\" rel=\"nofollow noreferrer\">Prime::prime_division</a>. That method decomposes any number into its prime components. Consider, for example, <code>n = 360</code>.</p>\n\n<pre><code>require 'prime'\n\nPrime.prime_division(360)\n  #=&gt; [[2, 3], [3, 2], [5, 1]]\n</code></pre>\n\n<p>This tells us that:</p>\n\n<pre><code>360 == 2**3 * 3**2 * 5**1\n  #=&gt; true\n</code></pre>\n\n<p>It also tells us that every factor of <code>360</code> is the product of between <code>0</code> and <code>3</code> <code>2</code>'s, multiplied by between <code>0</code> and <code>2</code> <code>3</code>'s, multiplied by <code>0</code> or <code>1</code> <code>5</code>'s. Therefore:</p>\n\n<pre><code> def factors(n)\n   Prime.prime_division(n).reduce([1]) do |a,(prime,pow)|\n     a.product((0..pow).map { |po| prime**po }).map { |x,y| x*y }\n   end\n end\n\n a = factors(360).sort\n   #=&gt; [ 1,  2,  3,  4,  5,  6,  8,  9, 10,  12,  15,  18,\n   #    20, 24, 30, 36, 40, 45, 60, 72, 90, 120, 180, 360]\n</code></pre>\n\n<p>We can check that:</p>\n\n<pre><code> a == (1..360).select { |n| (360 % n).zero? }\n   #=&gt; true\n</code></pre>\n\n<p>One other check:</p>\n\n<pre><code> factors(40).sort\n   #=&gt; [1, 2, 4, 5, 8, 10, 20, 40]            \n</code></pre>\n\n<p><sup>1. You could instead write that <code>[*m..n] #=&gt; [40, 41, 42]</code>.</sup>\n<sup>2. Why is it not necessary to convert the range to an array? <a href=\"http://ruby-doc.org/core-2.2.0/Enumerable.html#method-i-map\" rel=\"nofollow noreferrer\">Enumerable#map</a>, being an instance method of the module <code>Enumerable</code>, is available for use by every class that <code>include</code>s <code>Enumerable</code>. <code>Array</code> is one, but <code>(m..n).class #=&gt; Range</code> is another. (See the second paragraph at <a href=\"http://ruby-doc.org/core-2.2.0/Range.html\" rel=\"nofollow noreferrer\">Range</a>).</sup>\n<sup>3. Suppose <code>f</code> is smaller than <code>n/f</code> and <code>f &gt; n**0.5</code>, then <code>n/f &lt; n/(n**0.5) = n**0.5 &lt; f</code>, a contradiction.</sup> </p>\n"}], "owner": {"reputation": 71, "user_id": 5813634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c324731ee7a5abfd2afd183064b53be?s=128&d=identicon&r=PG&f=1", "display_name": "Jazz", "link": "https://stackoverflow.com/users/5813634/jazz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1399, "favorite_count": 3, "accepted_answer_id": 34894615, "answer_count": 2, "score": 6, "last_activity_date": 1557176903, "creation_date": 1453261262, "last_edit_date": 1592644375, "question_id": 34891170, "link": "https://stackoverflow.com/questions/34891170/find-all-integers-between-m-and-n-whose-sum-of-squared-divisors-is-itself-a-squa", "title": "Find all integers between m and n whose sum of squared divisors is itself a square", "body": "<h2>Problem Question</h2>\n<p>Divisors of 42 are : 1, 2, 3, 6, 7, 14, 21, 42. These divisors squared are: 1, 4, 9, 36, 49, 196, 441, 1764. The sum of the squared divisors is 2500 which is 50 * 50, a square!</p>\n<p>Given two integers m, n (1 &lt;= m &lt;= n) we want to find all integers between m and n whose sum of squared divisors is itself a square. 42 is such a number.</p>\n<p>The result will be an array of arrays, each subarray having two elements, first the number whose squared divisors is a square and then the sum of the squared divisors.</p>\n<h1>Code below</h1>\n<p>How can I make this specific program run faster? My current code times out after n &gt; 9999.</p>\n<pre><code>#returns the divisors of each number in an array of arrays\n\nr = (m..n).to_a.map { |z| (1..z).select { |x| z % x == 0} }\n\n#this finds all integers between m and n whose sum of squared divisors is itself a square\n\nsquarenumbers = r.map { |x| x.map { |c| c**2 }.inject(:+) }.select { |x| Math.sqrt(x) % 1 == 0 }\n\n#returns an array of booleans. \n\nbooleans = r.map { |x| x.map { |c| c**2 }.inject(:+) }.map { |x| Math.sqrt(x) % 1 == 0 }\n\n#returns the index of each of the true values in booleans as an array\n\nindexer = booleans.map.with_index{|x, i| i if x == true }.compact\n\n#returns the numbers whose squared divisors is a square in an array\n\nunsqr = indexer.map { |x| (m..n).to_a[x] }\n\n#merges the two arrays together, element for element and creates an array of arrays\n\nunsqr.zip(squarenumbers) \n\n# for m = 1 and n = 1000 the result would be\n\n# [[1, 1], [42, 2500], [246, 84100], [287, 84100], [728, 722500]]\n</code></pre>\n"}, {"tags": ["javascript", "ruby"], "comments": [{"owner": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "edited": false, "score": 1, "creation_date": 1453261302, "post_id": 34891153, "comment_id": 57520458, "body": "What do you mean by <i># Fails because list has an undefined method on the second iteration of the loop</i>?"}, {"owner": {"reputation": 2103, "user_id": 3162553, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5a4b9cec47f016074898f79d29293d9b?s=128&d=identicon&r=PG&f=1", "display_name": "user3162553", "link": "https://stackoverflow.com/users/3162553/user3162553"}, "reply_to_user": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "edited": false, "score": 0, "creation_date": 1453261487, "post_id": 34891153, "comment_id": 57520501, "body": "Sorry, I had left my code incomplete.  I am in fact calling another function within the loop. So I believe once it calls that function it resets list to nil.  I used a begin and rescue block and that is to me what appears to be happening."}, {"owner": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "edited": false, "score": 0, "creation_date": 1453261549, "post_id": 34891153, "comment_id": 57520516, "body": "Show the actual code then."}, {"owner": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "edited": false, "score": 0, "creation_date": 1453261686, "post_id": 34891153, "comment_id": 57520555, "body": "I don&#39;t see any issue with the code <code>list = [ 1, 2, 3 ];  list.each { |item| print item }</code>"}, {"owner": {"reputation": 2103, "user_id": 3162553, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5a4b9cec47f016074898f79d29293d9b?s=128&d=identicon&r=PG&f=1", "display_name": "user3162553", "link": "https://stackoverflow.com/users/3162553/user3162553"}, "reply_to_user": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "edited": false, "score": 0, "creation_date": 1453261897, "post_id": 34891153, "comment_id": 57520620, "body": "Weird.  Totally lost on this one"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1453321399, "post_id": 34891153, "comment_id": 57555215, "body": "The two halves of your question are completely unrelated to each other. There are no closures and no lexical scoping in your second half. The Ruby code you posted is also in no way related to the ECMAScript you posted. And lastly, the first snippet of Ruby code you posted works as-is, the second just needs the <code>return</code> keyword either replaced with <code>next</code> or just removed entirely."}], "answers": [{"tags": [], "owner": {"reputation": 1143, "user_id": 1563837, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0784ce3665c294c4547f81a212014d4b?s=128&d=identicon&r=PG", "display_name": "Josh Bodah", "link": "https://stackoverflow.com/users/1563837/josh-bodah"}, "is_accepted": true, "score": 3, "last_activity_date": 1453265048, "last_edit_date": 1453265048, "creation_date": 1453263255, "answer_id": 34891490, "question_id": 34891153, "link": "https://stackoverflow.com/questions/34891153/implementing-javascript-like-closure-in-ruby/34891490#34891490", "title": "Implementing JavaScript-like Closure in Ruby", "body": "<p>While Javascript has one type of lambda construct (an anonymous function), Ruby has several. The most common are blocks (passed to methods as in <code>each</code> in your example), Procs (which are like blocks that are bound to a execution context which they retain even when passed around), and Lambdas which are probably closest to anonymous functions. I won't go into the details of Procs vs Lambdas here.</p>\n\n<p>Here are examples of these constructs in Ruby:</p>\n\n<pre><code># Using a block + yield\ndef my_method(arg)\n  puts arg + yield(3)\nend\n\nmy_method(5) { |arg| arg * 2 }\n# =&gt; 11\n\n# Binding the block to a Proc then using #call\ndef print(&amp;block)\n  puts block.call\nend\n\n# Creating a Proc that can be passed around and then #called\ndef other_method(arg, other_args*)\n  arg.call(other_args*)\nend\n\nvar = 3\nprc = Proc.new { puts var }\nother_method(prc)\n\n# Creating a Lambda using stabby syntax\nnum = 3\nl = -&gt; (arg) { arg + 2 + num }\nother_method(l, 1)\n</code></pre>\n\n<p>In Ruby you could write your JS example as:</p>\n\n<pre><code>def outer(input)\n  closure_var = \"I'm here with \"\n\n  inner = -&gt; { closure_var + input }\n\n  inner.call\nend\n\nouter('outer input')\n</code></pre>\n\n<p>In IRB:</p>\n\n<pre><code>jbodah@Joshs-MacBook-Pro-2 2.1.3p242 ~ (none) $ irb\nirb(main):001:0&gt;     def outer(input)\nirb(main):002:1&gt;       closure_var = \"I'm here with \"\nirb(main):003:1&gt;\nirb(main):004:1*       inner = -&gt; { closure_var + input }\nirb(main):005:1&gt;\nirb(main):006:1*       inner.call\nirb(main):007:1&gt;     end\n=&gt; :outer\nirb(main):008:0&gt;\nirb(main):009:0*     outer('outer input')\n=&gt; \"I'm here with outer input\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5470, "user_id": 2052097, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/KOzAT.jpg?s=128&g=1", "display_name": "z atef", "link": "https://stackoverflow.com/users/2052097/z-atef"}, "is_accepted": false, "score": 0, "last_activity_date": 1453263706, "creation_date": 1453263706, "answer_id": 34891576, "question_id": 34891153, "link": "https://stackoverflow.com/questions/34891153/implementing-javascript-like-closure-in-ruby/34891576#34891576", "title": "Implementing JavaScript-like Closure in Ruby", "body": "<p>The below will do it for you , just be mindful inner_function is not really a method.Hence it is a lambda which behaves like a method. read more here <a href=\"http://ruby-doc.org/core-2.2.0/Proc.html\" rel=\"nofollow\">LINK</a> . </p>\n\n<pre><code>def outer_function(item)\n    outer_variable = \"input\"\n    inner_function = lambda { puts item   puts outer_variable }\n    inner_function[]\nend\n\nouter_function \"I'm here with \" # prints \"I'm here with input\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 3, "last_activity_date": 1494764597, "last_edit_date": 1494764597, "creation_date": 1453321122, "answer_id": 34909689, "question_id": 34891153, "link": "https://stackoverflow.com/questions/34891153/implementing-javascript-like-closure-in-ruby/34909689#34909689", "title": "Implementing JavaScript-like Closure in Ruby", "body": "<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>function outerFunction(input) {\r\n  var closureVar = \"I'm here with \";\r\n\r\n  function innerFunction() {\r\n    return closureVar + input;\r\n  }\r\n\r\n  return innerFunction();\r\n}\r\n\r\nconsole.log(outerFunction('outer input')); // I'm here with outer input</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Let's first re-write your ECMAScript to use function expressions:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>const outerFunction = function (input) {\r\n  const closureVar = \"I'm here with \";\r\n\r\n  const innerFunction = function () {\r\n    return closureVar + input;\r\n  }\r\n\r\n  return innerFunction();\r\n}\r\n\r\nconsole.log(outerFunction('outer input')); // I'm here with outer input</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Now let's re-write that into more modern style:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>const outerFunction = input =&gt; {\r\n  const closureVar = \"I'm here with \";\r\n\r\n  const innerFunction = () =&gt; closureVar + input;\r\n\r\n  return innerFunction();\r\n};\r\n\r\nconsole.log(outerFunction('outer input')); // I'm here with outer input</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Now, it's actually fairly simple to translate this to Ruby:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>outer_function = -&gt; input {\n  closure_var = \"I'm here with \"\n\n  inner_function = -&gt; { closure_var + input }\n\n  inner_function.()\n}\n\nputs outer_function.('outer input') # I'm here with outer input\n</code></pre>\n\n<p>As you can see, the translation is actually pretty straightforward and the semantics are similar. It is, however, not very idiomatic Ruby. In general, objects and methods are preferred over closures for encapsulating state, but sometimes, closures are useful and used.</p>\n\n<p>A more idiomatic style might be something like this:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>def outer_method(input)\n  closure_var = \"I'm here with \"\n\n  inner_function = -&gt; { closure_var + input }\n\n  inner_function.()\nend\n\nputs outer_method('outer input') # I'm here with outer input\n</code></pre>\n\n<p>But for such a small toy example it's hard to say and hard to demonstrate what idiomatic Ruby would look like.</p>\n\n<p>If you are interested in stuff like this, you might want to look through a <a href=\"http://joergwmittag.github.io/lambdaconscarcdr/\" rel=\"nofollow noreferrer\">toy project of mine</a>, where I show how to implement linked lists using nothing but closures in a variety of languages including Clojure and various other Lisps, Smalltalk and some of its descendants, ECMAScript and CoffeeScript, Ruby, Python, PHP, Perl, etc. Note that the code looks very similar in most languages, but note also that the code is very un-idiomatic in almost all of the languages, except Scheme and maybe Clojure. It isn't even idiomatic CommonLisp as far as I can tell.</p>\n\n<hr>\n\n<p>The Ruby code you posted in the second half of your question is completely unrelated to either the code or the concepts in the first half of your question: there are no closures, no issues of lexical scoping, and there is no need to use them.</p>\n\n<p>In fact, the first snippet you posted just works as-is:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>def outer_function\n  list = [ 1, 2, 3 ]\n\n  list.each { |item| print item }\nend\n\nouter_function\n# 123\n</code></pre>\n\n<p>The second just has a tiny problem:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>def outer_function\n  list = Proc.new { return [ 1, 2, 3 ] }\n\n  # The call to `each` is dead code since the call to `list.call` will already return\n  list.call.each { |item| another_function item }\nend\n\n# This method never gets called\ndef another_function item\n  puts item\nend\n\nouter_function\n# =&gt; [1, 2, 3]\n</code></pre>\n\n<p><code>return</code> is used to return a value from a <em>method</em>. So, what method does the <code>return</code> return from? Well, it returns from <code>outer_function</code>, since that's the only method there! <code>list</code> is a <code>Proc</code>, not a method. To return from a <code>Proc</code>, you use the <code>next</code> keyword instead:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>def outer_function\n  list = Proc.new { next [ 1, 2, 3 ] }\n\n  list.call.each { |item| another_function item }\nend\n\ndef another_function item\n  puts item\nend\n\nouter_function\n# 1\n# 2\n# 3\n</code></pre>\n\n<p>Alternatively, you could leave out the <code>next</code> altogether, since the last expression evaluated inside a compound expression (a block, a method, a class, whatever) is its return value anyway:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>def outer_function\n  list = Proc.new { [ 1, 2, 3 ] }\n\n  list.call.each { |item| another_function item }\nend\n\ndef another_function item\n  puts item\nend\n\nouter_function\n# 1\n# 2\n# 3\n</code></pre>\n\n<p>Or, you could replace the <code>Proc</code> with a lambda (which is actually also a <code>Proc</code> but with slightly different semantics):</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>def outer_function\n  list = -&gt; { return [ 1, 2, 3 ] }\n\n  list.call.each { |item| another_function item }\nend\n\ndef another_function item\n  puts item\nend\n\nouter_function\n# 1\n# 2\n# 3\n</code></pre>\n\n<p>There are two semantic differences between <code>Proc</code>s (created by <code>Proc.new</code> or <code>Kernel#proc</code>) and lambdas (created by <code>Kernel#lambda</code> or the stabby lambda literal <code>-&gt; (params) { code }</code>): <code>return</code> in a <code>Proc</code> returns from the lexically enclosing method (just like in a block) whereas <code>return</code> in a lambda returns from the lambda itself (just like in a method), and the argument binding semantics of <code>Proc</code>s are the same as those of blocks, whereas the argument binding semantics of lambdas are the same as those of methods.</p>\n\n<p>To recap: there are two differences, <code>return</code> and argument binding. And in both cases, <code>Proc</code> behaves like a block and lambda behaves like a method. Mnemonic: <code>Proc</code> rhymes with \"block\", and \"lambda\" and \"method\" are both Greek.</p>\n"}], "owner": {"reputation": 2103, "user_id": 3162553, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5a4b9cec47f016074898f79d29293d9b?s=128&d=identicon&r=PG&f=1", "display_name": "user3162553", "link": "https://stackoverflow.com/users/3162553/user3162553"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 1, "accepted_answer_id": 34891490, "answer_count": 3, "score": 1, "last_activity_date": 1494764597, "creation_date": 1453261139, "last_edit_date": 1453261429, "question_id": 34891153, "link": "https://stackoverflow.com/questions/34891153/implementing-javascript-like-closure-in-ruby", "title": "Implementing JavaScript-like Closure in Ruby", "body": "<p>I find it difficult to program without using closures in the following pattern: </p>\n\n<pre><code>function outerFunction(input) {\n  var closureVar = \"I'm here with \";\n\n  function innerFunction() {\n    return closureVar + input;\n  }\n\n  return innerFunction();\n}\n\nouterFunction('outer input'); // I'm here with outer input\n</code></pre>\n\n<p>This makes sense to me.  The outerFunction defines an environment that innerFunction has reference to upon invocation.</p>\n\n<p>I would like to see how Ruby accomplishes the same thing.  I understand Ruby uses blocks, procs and lambas, but I cannot seem to achieve the same lexical scoping as I can with JavaScript.</p>\n\n<p>Ruby naive attempt:</p>\n\n<pre><code>def outer_function\n  list = [ 1, 2, 3 ]\n\n  list.each { |item| print item }\nend\n\n# Fails because list has an undefined method on the second iteration of the loop\n</code></pre>\n\n<p>another attempt</p>\n\n<pre><code>def outer_function\n  list = Proc.new { return [ 1, 2, 3 ] }\n\n  list.call.each { |item| another_function item }\nend\n\ndef another_function item\n  puts item\nend\n\n# Same problem\n</code></pre>\n\n<p>So, how can I achieve this pattern in Ruby?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "latex", "bibtex"], "answers": [{"tags": [], "owner": {"reputation": 1143, "user_id": 1563837, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0784ce3665c294c4547f81a212014d4b?s=128&d=identicon&r=PG", "display_name": "Josh Bodah", "link": "https://stackoverflow.com/users/1563837/josh-bodah"}, "is_accepted": false, "score": 0, "last_activity_date": 1453264196, "creation_date": 1453264196, "answer_id": 34891648, "question_id": 34890584, "link": "https://stackoverflow.com/questions/34890584/bibtex-parser-in-rails-can-get-gem-to-work-in-console-but-not-app-itself/34891648#34891648", "title": "Bibtex parser in Rails; Can get gem to work in console but not app itself", "body": "<p><code>require 'citeproc'</code> should do it. Generally just adding citeproc to your Gemfile should require it (assuming you're using a default Rails setup)</p>\n"}], "owner": {"reputation": 590, "user_id": 1429542, "user_type": "registered", "accept_rate": 5, "profile_image": "https://www.gravatar.com/avatar/b3b0aab49d4aab66a20ef5995af79426?s=128&d=identicon&r=PG&f=1", "display_name": "Count Zero", "link": "https://stackoverflow.com/users/1429542/count-zero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453264196, "creation_date": 1453257456, "question_id": 34890584, "link": "https://stackoverflow.com/questions/34890584/bibtex-parser-in-rails-can-get-gem-to-work-in-console-but-not-app-itself", "title": "Bibtex parser in Rails; Can get gem to work in console but not app itself", "body": "<p>I'm building an app wherein I want to parse bibtex into citations in html.  I used the <a href=\"https://github.com/inukshuk/citeproc-ruby\" rel=\"nofollow\">CiteProc-Ruby</a> and <a href=\"https://github.com/inukshuk/bibtex-ruby\" rel=\"nofollow\">bibtex-ruby</a> gems to implement this.</p>\n\n<p>I used this gem.  I tried the following code in the Rails console.</p>\n\n<pre><code>cp = CiteProc::Processor.new style: 'apa', format: 'text'\ncp.import BibTeX.open('sources.bib').to_citeproc\n</code></pre>\n\n<p>This works fine.  The cp object is a hash of references parsed from the sources.bib file, and with this has I can render html citations in APA or some other format.</p>\n\n<p>So now I want to use this in my app.  So I added this to application_controller.rb</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  protect_from_forgery with: :exception\n  @cp = CiteProc::Processor.new style: 'apa', format: 'text'\n  @cp.import BibTeX.open('sources.bib').to_citeproc\nend \n</code></pre>\n\n<p>My expectation was to use the @cp object in the views.  But instead I get this error message: </p>\n\n<blockquote>\n  <p>uninitialized constant ApplicationController::CiteProc</p>\n</blockquote>\n\n<p>What is the correct way to do this?  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "nginx", "namespaces"], "answers": [{"comments": [{"owner": {"reputation": 465, "user_id": 524863, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a3ebf58c9ae8646e1ff55f2f2f7a39c4?s=128&d=identicon&r=PG", "display_name": "Nicolas Connault", "link": "https://stackoverflow.com/users/524863/nicolas-connault"}, "edited": false, "score": 0, "creation_date": 1453261147, "post_id": 34890667, "comment_id": 57520414, "body": "Thanks, do I also need to set up domain-based constraints in my config/routes.rb file?"}, {"owner": {"reputation": 226, "user_id": 3150639, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9e0851cb042146f91c4a387a5b39c774?s=128&d=identicon&r=PG", "display_name": "Hailong Cao", "link": "https://stackoverflow.com/users/3150639/hailong-cao"}, "reply_to_user": {"reputation": 465, "user_id": 524863, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a3ebf58c9ae8646e1ff55f2f2f7a39c4?s=128&d=identicon&r=PG", "display_name": "Nicolas Connault", "link": "https://stackoverflow.com/users/524863/nicolas-connault"}, "edited": false, "score": 0, "creation_date": 1453272624, "post_id": 34890667, "comment_id": 57524037, "body": "No, you don&#39;t . The &quot;passenger_base_uri&quot; is where to change. For example:  &quot; admin.domain.com/profile &quot;, with setting &quot;passenger_base_uri /admin.domain.com;&quot;  then this equals to &quot;localhost:3000/profile&quot;."}, {"owner": {"reputation": 465, "user_id": 524863, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a3ebf58c9ae8646e1ff55f2f2f7a39c4?s=128&d=identicon&r=PG", "display_name": "Nicolas Connault", "link": "https://stackoverflow.com/users/524863/nicolas-connault"}, "edited": false, "score": 0, "creation_date": 1453275102, "post_id": 34890667, "comment_id": 57525173, "body": "Thanks, I will give that a go and accept your answer if it works. +1 for being so helpful :)"}, {"owner": {"reputation": 465, "user_id": 524863, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a3ebf58c9ae8646e1ff55f2f2f7a39c4?s=128&d=identicon&r=PG", "display_name": "Nicolas Connault", "link": "https://stackoverflow.com/users/524863/nicolas-connault"}, "edited": false, "score": 1, "creation_date": 1453540410, "post_id": 34890667, "comment_id": 57654002, "body": "I&#39;m not having any luck with this setting (passenger_base_uri). The documentation states:  &quot;Used to specify that the given URI is an distinct application that should be served by Passenger.&quot;  I don&#39;t want to serve different apps. I have a single rails app, with multiple domains pointing to it, and for each domain I want to use a different namespace in my routes."}], "tags": [], "owner": {"reputation": 226, "user_id": 3150639, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9e0851cb042146f91c4a387a5b39c774?s=128&d=identicon&r=PG", "display_name": "Hailong Cao", "link": "https://stackoverflow.com/users/3150639/hailong-cao"}, "is_accepted": false, "score": 2, "last_activity_date": 1453257889, "creation_date": 1453257889, "answer_id": 34890667, "question_id": 34890453, "link": "https://stackoverflow.com/questions/34890453/ruby-on-rails-routes-multiple-namespaces-and-multiple-domains-best-practice/34890667#34890667", "title": "Ruby on Rails routes: Multiple namespaces and multiple domains: best practice?", "body": "<p>All your work should be done in nginx config file. </p>\n\n<p>For example, for admin.domain.com</p>\n\n<pre><code>server {\nlisten       80; #or 443 if you use ssl\nserver_name  admin.domain.com;\nroot /usr/local/app/;\n\n#ssl_certificate      app.cert; \n#ssl_certificate_key  app.key;\n\nlocation  ~ ^/admin.domain.com(/.*|$) {\npassenger_base_uri /;   #change this if you want a base uri\npassenger_app_root  /usr/local/app/;\npassenger_document_root  /usr/local/app/public;\npassenger_enabled on;\n}\n}\n</code></pre>\n"}], "owner": {"reputation": 465, "user_id": 524863, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a3ebf58c9ae8646e1ff55f2f2f7a39c4?s=128&d=identicon&r=PG", "display_name": "Nicolas Connault", "link": "https://stackoverflow.com/users/524863/nicolas-connault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 708, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1453257889, "creation_date": 1453256608, "question_id": 34890453, "link": "https://stackoverflow.com/questions/34890453/ruby-on-rails-routes-multiple-namespaces-and-multiple-domains-best-practice", "title": "Ruby on Rails routes: Multiple namespaces and multiple domains: best practice?", "body": "<p>I have a Ruby on Rails instance that powers at least 4 different websites, more to be added in the future. The websites fall under 3 categories:</p>\n\n<ul>\n<li>Admin Portal (intranet)</li>\n<li>Public pages (landing pages etc.)</li>\n<li>Browser version of app</li>\n</ul>\n\n<p>I've set up namespaces for these (admin/, public/ and my/) and this works great in my development environment (e.g., localhost:3000/admin). However in production each of these sites will run on a different domain/subdomain.</p>\n\n<p>For example:</p>\n\n<ul>\n<li>Admin portal on admin.domain.com (admin namespace)</li>\n<li>Landing page on otherdomain.com (public namespace)</li>\n<li>Questionnaire on survey.otherdomain.com (public namespace)</li>\n<li>App on my.domain.com (my namespace)</li>\n</ul>\n\n<p>I <strong>do not</strong> want the namespace to appear as a URI segment in the URL, and it should also not be required in the subdomain. I want to route each domain to its appropriate namespace.</p>\n\n<p>The main reason I want to split the namespaces this way is that the Admin and App both use a very specific set of resources that will not be required for all other (public) websites, and I want to keep the development workflow separate and the code decoupled between these areas.</p>\n\n<p>What is the best way to set up this kind of routing?</p>\n\n<p>PS: I am running this with Webrick in development, and with nginx/passsenger in production. I hope I don't need to do anything drastic with nginx to get this working.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "multithreading"], "comments": [{"owner": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "edited": false, "score": 0, "creation_date": 1453256314, "post_id": 34890380, "comment_id": 57519079, "body": "Probably you want to <code>puts CouponCodeService.assign_coupon(review)</code> and <code>puts !review.coupon.nil?</code> and see if it is actually false."}, {"owner": {"reputation": 25, "user_id": 3719065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c529e6a8de54df886caef300ef56bfa?s=128&d=identicon&r=PG&f=1", "display_name": "jxdx", "link": "https://stackoverflow.com/users/3719065/jxdx"}, "reply_to_user": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "edited": false, "score": 0, "creation_date": 1453256751, "post_id": 34890380, "comment_id": 57519206, "body": "Well the end result is review.coupon.nil? is true and yet review.aasm_state = &#39;approved  This shouldn&#39;t be possible."}, {"owner": {"reputation": 25, "user_id": 3719065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c529e6a8de54df886caef300ef56bfa?s=128&d=identicon&r=PG&f=1", "display_name": "jxdx", "link": "https://stackoverflow.com/users/3719065/jxdx"}, "reply_to_user": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "edited": false, "score": 0, "creation_date": 1453256789, "post_id": 34890380, "comment_id": 57519212, "body": "There is also a rails validation: validates :user_id, uniqueness: {scope: :product_id, message: &quot;You can only review a product once&quot;}  And a unique index on the database."}, {"owner": {"reputation": 2174, "user_id": 3448554, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/j7RcG.jpg?s=128&g=1", "display_name": "Kelsey Hannan", "link": "https://stackoverflow.com/users/3448554/kelsey-hannan"}, "edited": false, "score": 0, "creation_date": 1453261622, "post_id": 34890380, "comment_id": 57520535, "body": "I have doubts this code is getting executed.  Try <code>raise CouponCodeService.assign_coupon(review).inspect</code> and <code>raise review.coupon.inspect</code> in these places along your execution path to make sure that: a. this code is even where <code>review.approve!</code> is running, and b, to check what you&#39;re getting back for <code>review.coupon</code> if it&#39;s not nil.  If you&#39;re having trouble replicating then make sure you&#39;re not running your servers multithreaded (don&#39;t run multithreaded unless you know what you&#39;re doing -- the variable assignment hints this is not).  Finally remember that a <code>False</code> object <i>is not nil.</i>"}, {"owner": {"reputation": 1143, "user_id": 1563837, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0784ce3665c294c4547f81a212014d4b?s=128&d=identicon&r=PG", "display_name": "Josh Bodah", "link": "https://stackoverflow.com/users/1563837/josh-bodah"}, "edited": false, "score": 1, "creation_date": 1453264862, "post_id": 34890380, "comment_id": 57521468, "body": "This is the type of thing automated tests are really good at catching. I&#39;d highly recommend building out a few tests for your different branches of business logic. I don&#39;t see how this could be a threading issue (note Rails is thread safe and this code doesn&#39;t seem to share any state; maybe that where statement)"}], "owner": {"reputation": 25, "user_id": 3719065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c529e6a8de54df886caef300ef56bfa?s=128&d=identicon&r=PG&f=1", "display_name": "jxdx", "link": "https://stackoverflow.com/users/3719065/jxdx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1453258044, "creation_date": 1453255999, "last_edit_date": 1453258044, "question_id": 34890380, "link": "https://stackoverflow.com/questions/34890380/possible-bad-code-or-rails-multi-thread-issue", "title": "Possible bad code or Rails multi-thread issue", "body": "<p>I'm having an issue with the below code frequently in a Rails 4.4, Ruby 2.2 with puma web server application.  This code has excessive if statements just to try and figure out the problem.</p>\n\n<p>We can assume that <code>assign_coupon()</code> returns true or false.  When it returns true it creates an association between the review and the coupon, so you can type review.coupon. Before you run <code>assign_coupon()</code> or if <code>assign_coupon()</code> returns false review.coupon will be nil.</p>\n\n<p>The issue is that <code>assign_coupon()</code> is not working and review.coupon is nil, yet the code gets past '<code>if CouponCodeService.assign_coupon(review)</code>' and then also passes '<code>if !review.coupon.nil?</code>' and is running '<code>review.approve!</code>'.</p>\n\n<p>I cannot figure out for the life of me how the code gets passed 2 failing if statements to run '<code>review.approve!</code>'.  This should not be possible.</p>\n\n<pre><code>if review.product.has_coupon_codes?\n    if CouponCodeService.assign_coupon(review) # this is false\n        if !review.coupon.nil? # this is false\n            review.approve! # this is some how executed.\n            success_message(review)\n            review.send_reviewer_approved_email\n        else\n            review.update(aasm_state: 'requested')\n            error_message(review)\n        end\n    else\n        review.update(aasm_state: 'requested')\n        error_message(review)\n    end\nend\n\n\n\n\ndef self.assign_coupon(review)\n    begin\n      product = review.product\n      if product.has_coupon_codes?\n        coupon = product.coupons.where(claimed: false).first\n        coupon.review_id = review.id\n        coupon.claimed = true\n        if coupon.save\n          return true\n        else\n          return false\n        end\n      else\n        return false\n      end\n    rescue Exception =&gt; e\n      return false\n    end\n  end\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "exception-handling"], "answers": [{"tags": [], "owner": {"reputation": 995, "user_id": 2576714, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RcYff.jpg?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/2576714/tim"}, "is_accepted": true, "score": 2, "last_activity_date": 1453253128, "creation_date": 1453253128, "answer_id": 34889960, "question_id": 34889890, "link": "https://stackoverflow.com/questions/34889890/rails-4-ignore-error-exception-and-continue/34889960#34889960", "title": "Rails 4 Ignore Error/Exception and Continue", "body": "<p>Sure, just wrap the risky code in a begin/rescue/end block that captures the issue and continues execution.</p>\n\n<p><a href=\"http://rubylearning.com/satishtalim/ruby_exceptions.html\" rel=\"nofollow\">http://rubylearning.com/satishtalim/ruby_exceptions.html</a>. - see handling exceptions.</p>\n\n<p>You might want to research what exceptions to look for, say if redis has gone away, rather than the base Exception catch</p>\n"}], "owner": {"reputation": 1262, "user_id": 2858365, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/fcc478d5c62f7ba75f0ceed90d9901b9?s=128&d=identicon&r=PG&f=1", "display_name": "stefano_cdn", "link": "https://stackoverflow.com/users/2858365/stefano-cdn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1972, "favorite_count": 0, "accepted_answer_id": 34889960, "answer_count": 1, "score": 1, "last_activity_date": 1453253128, "creation_date": 1453252689, "question_id": 34889890, "link": "https://stackoverflow.com/questions/34889890/rails-4-ignore-error-exception-and-continue", "title": "Rails 4 Ignore Error/Exception and Continue", "body": "<p>Sorry if it's an easy question, I am pretty new to Ruby.</p>\n\n<p>When users sign up, or login I would like to keep statistics with Redis</p>\n\n<pre><code>def create\n  @user = User.new(user_params)\n  if @user.save\n    $redis.hincrby(\"2016MMDD\", \"new_users\", 1)\n    render json: @user\n  end\nend\n</code></pre>\n\n<p>If for any reason $redis.hincrby fails, is there a way to continue the execution of the code and render the user anyway?</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "loops", "nested-loops"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1453258306, "post_id": 34889655, "comment_id": 57519598, "body": "I don&#39;t understand your question. Readers should not have to try to deduce questions from code, particularly from code that does not work. Think about how you could clearly state the question without presenting any code. Often an example helps. When you give an example, assign a variable each input object (e.g., <code>arr = [1,2,3]</code>) and show your desired output for that input. The reason for including the variables is so that readers can cut and paste and refer to them in comments and solutions without having to define them."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1453258505, "post_id": 34889655, "comment_id": 57519658, "body": "Also, avoid asking how a particular approach can be taken (e.g., &quot;how do i iterate through both of them using <code>each</code>?&quot;), so that you don&#39;t close off other, possibly better approaches. Just explain what you want to achieve. I suggest you edit your question to at least add an example. If you do that, leave what you have and add it at the end, indicating it&#39;s an edit (e.g. &quot;Edit: ....&quot;)."}, {"owner": {"reputation": 3564, "user_id": 3216970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ec661ea7a240654ec958f063478c964?s=128&d=identicon&r=PG&f=1", "display_name": "mc01", "link": "https://stackoverflow.com/users/3216970/mc01"}, "edited": false, "score": 0, "creation_date": 1453263553, "post_id": 34889655, "comment_id": 57521082, "body": "An XY Problem ... <a href=\"http://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\" title=\"what is the xy problem\">meta.stackexchange.com/questions/66377/what-is-the-xy-proble&zwnj;&#8203;m</a>    You currently have 3 nested loops (buys, sells, AND users). It&#39;ll take n^3 operations to deal with <code>n</code> users/buys/sells. Once any of the 3 inputs grows beyond a trivial number this will get painfully slow. You say you want &quot;the ratio of daily buys &amp; sells,&quot; but keeping only dates w/buy AND sell throws away lots of data, and otherwise ratio is 0 or undefined for whichever dates didn&#39;t have both buy/sell. Do you rather want trends for dates they bought OR sold? That&#39;s a different problem."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5813267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86c0746cfdd70cbc4757ff4533684882?s=128&d=identicon&r=PG&f=1", "display_name": "Chester", "link": "https://stackoverflow.com/users/5813267/chester"}, "edited": false, "score": 0, "creation_date": 1453252289, "post_id": 34889735, "comment_id": 57518061, "body": "hey Roy, thanks for the tip. Though i&#39;ve expended my question to include my actual problem, do take a look and tell me what you think."}], "tags": [], "owner": {"reputation": 59, "user_id": 1301469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7bae5325f3529ddefea0981870a9c66?s=128&d=identicon&r=PG", "display_name": "Roy Rivera Zamora", "link": "https://stackoverflow.com/users/1301469/roy-rivera-zamora"}, "is_accepted": false, "score": 0, "last_activity_date": 1453251656, "creation_date": 1453251656, "answer_id": 34889735, "question_id": 34889655, "link": "https://stackoverflow.com/questions/34889655/how-to-loop-through-arrays-of-different-length-in-ruby/34889735#34889735", "title": "How to loop through arrays of different length in Ruby?", "body": "<p>You could concat both arrays and get rid of duplicated elements by doing:</p>\n\n<pre><code>(a_array + b_array).uniq.each do |num|\n  # code goes here\nend\n</code></pre>\n\n<p><a href=\"http://ruby-doc.org/core-2.2.0/Array.html#method-i-uniq\" rel=\"nofollow\">Uniq method API</a></p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5813267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86c0746cfdd70cbc4757ff4533684882?s=128&d=identicon&r=PG&f=1", "display_name": "Chester", "link": "https://stackoverflow.com/users/5813267/chester"}, "edited": false, "score": 0, "creation_date": 1453252243, "post_id": 34889785, "comment_id": 57518048, "body": "Thanks for the tip, i&#39;ve expended my question to include my actual problem. not sure if this one will help but will think about this."}], "tags": [], "owner": {"reputation": 161, "user_id": 3085470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9H44t.jpg?s=128&g=1", "display_name": "Batbayar", "link": "https://stackoverflow.com/users/3085470/batbayar"}, "is_accepted": false, "score": -1, "last_activity_date": 1453252759, "last_edit_date": 1453252759, "creation_date": 1453251959, "answer_id": 34889785, "question_id": 34889655, "link": "https://stackoverflow.com/questions/34889655/how-to-loop-through-arrays-of-different-length-in-ruby/34889785#34889785", "title": "How to loop through arrays of different length in Ruby?", "body": "<p>In this case you can't loop them with each use for loop\nthis code will give you a hint</p>\n\n<pre><code>ar = [1,2,3,4,5]\nbr = [1,2,3]\n\narray_l = (ar.length &gt; br.length) ? ar.length : br.length\n\nfor i in 0..array_l\n    if ar[i] and br[i]\n        puts ar[i].to_s + \" \" + br[i].to_s\n    elsif ar[i]\n      puts ar[i].to_s\n    elsif br[i]\n      puts br[i].to_s\n    end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 103, "user_id": 2113153, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lUs26.jpg?s=128&g=1", "display_name": "Steve Lewis", "link": "https://stackoverflow.com/users/2113153/steve-lewis"}, "is_accepted": false, "score": 0, "last_activity_date": 1453253395, "creation_date": 1453253395, "answer_id": 34889989, "question_id": 34889655, "link": "https://stackoverflow.com/questions/34889655/how-to-loop-through-arrays-of-different-length-in-ruby/34889989#34889989", "title": "How to loop through arrays of different length in Ruby?", "body": "<pre><code>daily_buy = user.buys.group_by(&amp;:created_at)\n daily_sell = user.sells.group_by(&amp;:created_at\n\n  buys_and_sells = daily_buy + daily_sell\n\n  totals = buys_and_sells.inject({}) do |hsh, transaction|\n    hsh['buys'] ||= 0;\n    hsh['sells']  ||= 0;\n    hsh['buys'] += 1 if transaction.is_a?(Buy)\n    hsh['sells'] += 1 if transaction.is_a?(Sell)\n    hsh\n  end\n\n  hsh['buys']/hsh['sells']\n</code></pre>\n\n<p>I think the above might do it...rather than collecting each thing in to separate arrays, concat them together, then run through each item in the combined array, increasing the count in the appropriate key of the hash returned by the inject.</p>\n"}], "owner": {"reputation": 1, "user_id": 5813267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86c0746cfdd70cbc4757ff4533684882?s=128&d=identicon&r=PG&f=1", "display_name": "Chester", "link": "https://stackoverflow.com/users/5813267/chester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 708, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1453253395, "creation_date": 1453251171, "last_edit_date": 1453252336, "question_id": 34889655, "link": "https://stackoverflow.com/questions/34889655/how-to-loop-through-arrays-of-different-length-in-ruby", "title": "How to loop through arrays of different length in Ruby?", "body": "<p>Let's say i have two relation arrays of a user's daily buy and sell.</p>\n\n<p>how do i iterate through both of them using <code>.each</code> and still let the the longer array run independently once the shorter one is exhaused. Below i want to find the ratio of someone's daily buys and sells. But can't get the ratio because it's always 1 as i'm iterating through the longer array once for each item of the shorter array.</p>\n\n<pre><code>users = User.all\nratios = Hash.new\n\nusers.each do |user|\n\n  if user.buys.count &gt; 0 &amp;&amp; user.sells.count &gt; 0\n\n    ratios[user.name] = Hash.new\n    buy_array = []\n    sell_array = []\n    date = \"\"\n\n    daily_buy = user.buys.group_by(&amp;:created_at)\n    daily_sell = user.sells.group_by(&amp;:created_at)\n\n    daily_buy.each do |buy|\n      daily_sell.each do |sell|\n        if buy[0].to_date == sell[0].to_date\n          date = buy[0].to_date\n          buy_array &lt;&lt; buy[1]\n          sell_array &lt;&lt; sell[1]\n        end\n      end\n    end\n    ratio_hash[user.name][date] = (buy_array.length.round(2)/sell_array.length)\n  end\nend\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "authentication"], "comments": [{"owner": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "edited": false, "score": 0, "creation_date": 1453250045, "post_id": 34889352, "comment_id": 57517358, "body": "Did you try it? Was there an error?"}, {"owner": {"reputation": 123, "user_id": 4334387, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-A2AMGN4PB1Y/AAAAAAAAAAI/AAAAAAAAAWE/go3cLlgYPhQ/photo.jpg?sz=128", "display_name": "Stas Ilnytskyi", "link": "https://stackoverflow.com/users/4334387/stas-ilnytskyi"}, "reply_to_user": {"reputation": 4561, "user_id": 1043569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0f0397c0ae99625fde35aaa75a20494e?s=128&d=identicon&r=PG", "display_name": "Atri", "link": "https://stackoverflow.com/users/1043569/atri"}, "edited": false, "score": 0, "creation_date": 1453295234, "post_id": 34889352, "comment_id": 57537947, "body": "Yes I did. But there are problem with acess to methods, even I describe one row before_action :require_user, only: [:show] I still have acess to other methods."}], "answers": [{"tags": [], "owner": {"reputation": 647, "user_id": 4649530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de2da5fe7e50cd453d448bbc28422677?s=128&d=identicon&r=PG", "display_name": "Gearnode", "link": "https://stackoverflow.com/users/4649530/gearnode"}, "is_accepted": false, "score": 1, "last_activity_date": 1453250682, "creation_date": 1453250682, "answer_id": 34889591, "question_id": 34889352, "link": "https://stackoverflow.com/questions/34889352/how-to-use-before-action-in-rails/34889591#34889591", "title": "How to use before_action in Rails?", "body": "<p>You can try this:</p>\n\n<pre><code>#controller\nbefore_action :require_rights\n\ndef require_rights\n  unless current_user.allowed_actions\n    raise 'not authorized'\n  end\nend\n</code></pre>\n\n<p>Make your condition in your method can fix your problem.</p>\n"}, {"tags": [], "owner": {"reputation": 1352, "user_id": 2460416, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VjqNv.jpg?s=128&g=1", "display_name": "mpospelov", "link": "https://stackoverflow.com/users/2460416/mpospelov"}, "is_accepted": false, "score": 0, "last_activity_date": 1453251521, "creation_date": 1453251521, "answer_id": 34889713, "question_id": 34889352, "link": "https://stackoverflow.com/questions/34889352/how-to-use-before-action-in-rails/34889713#34889713", "title": "How to use before_action in Rails?", "body": "<p>You can do it in such a way.</p>\n\n<pre><code>before_action :require_user\nbefore_action :require_rights\n\n\ndef require_rights\n  fail 'Not allowed' unless current_user.allowed_actions.include?(action_name) # Guard to check if user allowed to do certain action\nend\n</code></pre>\n\n<p>Also I would recommend you to create a special class which will handle this logic for you. Example:</p>\n\n<pre><code>class RightsPolicyService\n  attr_reader :user\n\n  def initialize(user)\n    @user = user\n  end\n\n  def allowed?(controller_name, action_name)\n    # Define here your custom logic for checking if user is allowed\n    user.allowed_controllers.include?(controller_name) &amp;&amp;\n      user.allowed_actions.include?(action_name)\n  end\nend\n\n# And in the controller\ndef require_rights\n  fail 'Not allowed' unless RightsPolicyService.new(current_user).allowed?(controller_name, action_name)\nend\n</code></pre>\n\n<p><strong>Note:</strong> failing is just made an example, you should generate a response in this case or redirect somewhere.</p>\n"}], "owner": {"reputation": 123, "user_id": 4334387, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-A2AMGN4PB1Y/AAAAAAAAAAI/AAAAAAAAAWE/go3cLlgYPhQ/photo.jpg?sz=128", "display_name": "Stas Ilnytskyi", "link": "https://stackoverflow.com/users/4334387/stas-ilnytskyi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1366, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1453251521, "creation_date": 1453249075, "question_id": 34889352, "link": "https://stackoverflow.com/questions/34889352/how-to-use-before-action-in-rails", "title": "How to use before_action in Rails?", "body": "<p>I have some methods in my controller.\nFirst of all I write </p>\n\n<pre><code>before_action :require_user\nbefore_action :require_rights, only: [:show, :my_method]\n</code></pre>\n\n<p>Can I put methods dynamically ? e.g. </p>\n\n<pre><code>before_action :require_rights, only: current_user.allowed_actions\n</code></pre>\n\n<p>I think to save method names somewhere and configure each user to groups with access rights. Or there are better solutions in existing gems ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "bundler"], "answers": [{"tags": [], "owner": {"reputation": 3087, "user_id": 688480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db08b7613d6bf1b94e662b1f96f9ef02?s=128&d=identicon&r=PG", "display_name": "Ray Baxter", "link": "https://stackoverflow.com/users/688480/ray-baxter"}, "is_accepted": true, "score": 1, "last_activity_date": 1453249957, "creation_date": 1453249957, "answer_id": 34889492, "question_id": 34889338, "link": "https://stackoverflow.com/questions/34889338/bundler-version-and-gemfile-lock/34889492#34889492", "title": "Bundler version and Gemfile.lock", "body": "<p>Bundler does not add that line during <code>install</code> with no changes. See <code>CHANGELOG.md</code>, added in 1.10.5 (2015-06-24).</p>\n"}], "owner": {"reputation": 2238, "user_id": 370927, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ded91d26e72879bcd3c2929a71ec1d9b?s=128&d=identicon&r=PG", "display_name": "JohnDel", "link": "https://stackoverflow.com/users/370927/johndel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 34889492, "answer_count": 1, "score": 0, "last_activity_date": 1453249957, "creation_date": 1453248996, "question_id": 34889338, "link": "https://stackoverflow.com/questions/34889338/bundler-version-and-gemfile-lock", "title": "Bundler version and Gemfile.lock", "body": "<p>When I am running <code>bundle</code> on my local, I am also getting <code>BUNDLED WITH 1.11.2</code> inside Gemfile.lock. </p>\n\n<p>Why some teammates who have the same bundler version, when they are doing <code>bundle</code>, the <code>BUNDLED WITH ...</code> line automatically disappears from the Gemfile.lock ? Is there some option to force it? I also couldn't find when this one change happened and the benefits of it.</p>\n"}, {"tags": ["ruby", "amazon-web-services", "amazon-s3", "aws-sdk"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5813155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc11b0204ccdc22266582160827b6622?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/5813155/paul"}, "edited": false, "score": 0, "creation_date": 1453327249, "post_id": 34907968, "comment_id": 57558524, "body": "I would love to know a more elegant way to handle this."}], "tags": [], "owner": {"reputation": 1, "user_id": 5813155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc11b0204ccdc22266582160827b6622?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/5813155/paul"}, "is_accepted": false, "score": 0, "last_activity_date": 1453315374, "creation_date": 1453315374, "answer_id": 34907968, "question_id": 34889258, "link": "https://stackoverflow.com/questions/34889258/using-ruby-aws-sdk-v2-to-indicate-if-static-website-is-configured/34907968#34907968", "title": "Using ruby aws-sdk V2 to indicate if static website is configured", "body": "<p>I decided to take a short cut and just catch the error.</p>\n\n<pre><code>require 'aws-sdk'\n\ns3 = Aws::S3::Resource.new\n\nmy_buckets = s3.buckets.map\n\nmy_buckets.each do |bucket|\n  begin\n    puts bucket.name\n    puts bucket.website.error_document\n\n  # if a website is not configured it's going to throw an error when you try to access bucket.website.error_document\\\n  # rescue the error, even though this seems like there should be a more elegant way to handle this.\n  rescue Aws::S3::Errors::NoSuchWebsiteConfiguration =&gt; e\n    puts e.message\n  # Buckets that are just there to provide a redirect for www versions of the domain will also throw an error\n  rescue Aws::S3::Errors::PermanentRedirect =&gt; e\n    puts e.message\n  rescue Exception =&gt; e\n    puts e.message\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5813155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc11b0204ccdc22266582160827b6622?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/5813155/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491281770, "creation_date": 1453248435, "last_edit_date": 1491281770, "question_id": 34889258, "link": "https://stackoverflow.com/questions/34889258/using-ruby-aws-sdk-v2-to-indicate-if-static-website-is-configured", "title": "Using ruby aws-sdk V2 to indicate if static website is configured", "body": "<p>I have a large number of S3 Buckets configured for static web hosting and I'm trying to use the Ruby aws-sdk to iterate through the list in order to print out various attributes like the index document, error document, redirection rules, etc.</p>\n\n<p>Unfortunately, some of the buckets are not configured for static hosting. I need to skip those buckets to avoid getting an error.</p>\n\n<p>I can't figure out how to detect if a bucket is configured for static hosting so the following code throws an error. See below.</p>\n\n<pre><code>require 'aws-sdk'\n\ns3 = Aws::S3::Resource.new\ns3.buckets.take(3).each do |bucket|\n  puts \"Name = #{bucket.name}\"\n  puts \"Index Document = #{bucket.website.index_document}\"\nend\n</code></pre>\n\n<p>The error that is returned, because I'm not catching it is...</p>\n\n<pre><code>The specified bucket does not have a website configuration (Aws::S3::Errors::NoSuchWebsiteConfiguration)\n</code></pre>\n"}, {"tags": ["ruby", "xpath", "selenium-webdriver"], "comments": [{"owner": {"reputation": 83665, "user_id": 2998271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B7vUA.png?s=128&g=1", "display_name": "har07", "link": "https://stackoverflow.com/users/2998271/har07"}, "edited": false, "score": 0, "creation_date": 1453249972, "post_id": 34889248, "comment_id": 57517343, "body": "See the 1st code snippet in the following <a href=\"http://stackoverflow.com/a/14701534/2998271\">answer</a>"}, {"owner": {"reputation": 63, "user_id": 5750734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e4b46b80dcb056e8ee530bc317477c4?s=128&d=identicon&r=PG&f=1", "display_name": "Artur V", "link": "https://stackoverflow.com/users/5750734/artur-v"}, "reply_to_user": {"reputation": 83665, "user_id": 2998271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B7vUA.png?s=128&g=1", "display_name": "har07", "link": "https://stackoverflow.com/users/2998271/har07"}, "edited": false, "score": 0, "creation_date": 1453251141, "post_id": 34889248, "comment_id": 57517716, "body": "@har07 , thanks. I saw that where did some research, but I&#39;m trying to understand how to interact with element using click command"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 5750734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e4b46b80dcb056e8ee530bc317477c4?s=128&d=identicon&r=PG&f=1", "display_name": "Artur V", "link": "https://stackoverflow.com/users/5750734/artur-v"}, "edited": false, "score": 0, "creation_date": 1453252677, "post_id": 34889756, "comment_id": 57518169, "body": "thank you for your comment, it gives me some idea so I will keep looking!"}], "tags": [], "owner": {"reputation": 829, "user_id": 2056182, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/17c6cfe640373ddcb2aaa6633cf919f8?s=128&d=identicon&r=PG", "display_name": "Karl", "link": "https://stackoverflow.com/users/2056182/karl"}, "is_accepted": false, "score": 4, "last_activity_date": 1453251810, "creation_date": 1453251810, "answer_id": 34889756, "question_id": 34889248, "link": "https://stackoverflow.com/questions/34889248/explicit-wait-for-selenium-webdriver/34889756#34889756", "title": "Explicit wait for Selenium Webdriver", "body": "<p>The issue is that the element isn't in the DOM yet, hence your needing to put a time delay in there.</p>\n\n<p>That said, the API <a href=\"http://www.seleniumhq.org/docs/04_webdriver_advanced.jsp#explicit-and-implicit-waits-reference\" rel=\"nofollow\">doco for ruby</a> says you should do it this way</p>\n\n<pre><code>require 'rubygems' # not required for ruby 1.9 or if you installed without gem\nrequire 'selenium-webdriver'\n\ndriver = Selenium::WebDriver.for :firefox\ndriver.get \"http://somedomain/url_that_delays_loading\"\n\nwait = Selenium::WebDriver::Wait.new(:timeout =&gt; 10) # seconds\nbegin\n  element = wait.until { driver.find_element(:id =&gt; \"some-dynamic-element\") }\nensure\n  driver.quit\nend\n</code></pre>\n\n<p>note that the element that you can then <code>.click()</code> is assigned from the wait.until method not the find_element() method as in your code.</p>\n\n<p>However that arbitrary delays don't always work, if the site is busy then the delay may not be long enough.\nA better option is to wait for the element to become clickable or visible.</p>\n\n<p>The Java API's have <a href=\"https://selenium.googlecode.com/git/docs/api/java/org/openqa/selenium/support/ui/ExpectedConditions.html\" rel=\"nofollow\">ExpectedConditions convenience methods</a> that cn be used like this...</p>\n\n<pre><code>WebDriverWait wait = new WebDriverWait(driver, 10);\nWebElement element = wait.until(ExpectedConditions.elementToBeClickable(By.id(\"someid\")));\nelement.click();\n</code></pre>\n\n<p>Unfortunatly I don't think Ruby has this yet. You may need to code up your own <code>ExpectedCondition</code> class or package.</p>\n\n<p>I'm not a Ruby dev but here is the idea of a function in Java that could be used to implement your ExpectedCondition</p>\n\n<pre><code>public WebElement findElementInTime(WebDriver driver, By by, int timeoutInSeconds)\n    {\n        log.debug(\"==================+&gt;&gt;&gt;&gt;&gt;&gt; looking for element for \"+ timeoutInSeconds + \" seconds\");\n        WebElement ret = null;\n\n        for (int second = 0; second &lt; timeoutInSeconds; second++) {\n            try { if (isElementPresent(driver,by)) {\n                log.debug(\"found element :-)\");\n                ret = driver.findElement(by);\n                break;\n            }} catch (Exception e) {\n\n                log.debug(\"oops... sleeping 1 sec wait for button\");\n            }\n            log.debug(\"sleeping 1 sec wait for button\");\n        }\n        return ret;\n    }\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 5750734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e4b46b80dcb056e8ee530bc317477c4?s=128&d=identicon&r=PG&f=1", "display_name": "Artur V", "link": "https://stackoverflow.com/users/5750734/artur-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4058, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1453251810, "creation_date": 1453248325, "question_id": 34889248, "link": "https://stackoverflow.com/questions/34889248/explicit-wait-for-selenium-webdriver", "title": "Explicit wait for Selenium Webdriver", "body": "<p>Working on the method trying to understand the explicit wait. </p>\n\n<pre><code>    require 'rubygems'\nrequire 'selenium-webdriver'\nrequire 'cucumber'\n\n$driver = Selenium::WebDriver.for :firefox\n$driver.manage.timeouts.implicit_wait = 3\n\n    Then /^do search$/ do\n  driver = $driver\n  one_way = driver.find_element(:id, \"search.ar.type.code.oneWay\").click\n    sleep 5\n   from = driver.find_element :xpath =&gt; \"//div[@class = 'origin column1']//input[@type = 'text']\"\n   from.click\n</code></pre>\n\n<p>So after <code>one_way</code> radio button is clicked and input form changed , so I put <code>sleep 5</code> to give it a time element to appear, otherwise would be error \"element not visible ...\". So I thought it would be good time to understand explicit wait, because I need to wait till element will appear.</p>\n\n<pre><code>    wait = Selenium::WebDriver::Wait.new(:timeout =&gt; 40)\n  wait.until {from = driver.find_element(:xpath, \"//div[@class = 'origin column1']//input[@type = 'text']\")\n  from.click\n  }\n</code></pre>\n\n<p>But getting error \"Selenium::WebDriver::Error::ElementNotVisibleError: Element is not currently visible and so may not be interacted with\" . Why this code doesn't wait till element appears and click it? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms"], "answers": [{"tags": [], "owner": {"reputation": 46, "user_id": 5728351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GkbOE.png?s=128&g=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/5728351/josh"}, "is_accepted": true, "score": 2, "last_activity_date": 1453249560, "last_edit_date": 1495541247, "creation_date": 1453249560, "answer_id": 34889429, "question_id": 34889122, "link": "https://stackoverflow.com/questions/34889122/form-for-with-f-select-and-options-for-select-works-for-one-attribute-but-not-th/34889429#34889429", "title": "form_for with f.select and options_for_select works for one attribute but not the second", "body": "<p>So I checked my rails console and saw that it was actually working! This meant that the issue was with what was selected. I found the solution in the comments on this: <a href=\"https://stackoverflow.com/questions/8374889/select-doesnt-show-selected-value\">select doesn&#39;t show selected value</a></p>\n\n<p>and was able to get it to show the correct selected value with the code below:</p>\n\n<pre><code>&lt;%= f.select :year, options_for_select([['1st Year', 1.to_i], ['2nd Year', 2.to_i], ['3rd Year', 3], ['4th Year', 4]], selected: @customer.year) %&gt;\n</code></pre>\n"}], "owner": {"reputation": 46, "user_id": 5728351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GkbOE.png?s=128&g=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/5728351/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2547, "favorite_count": 1, "accepted_answer_id": 34889429, "answer_count": 1, "score": 1, "last_activity_date": 1453249560, "creation_date": 1453247449, "question_id": 34889122, "link": "https://stackoverflow.com/questions/34889122/form-for-with-f-select-and-options-for-select-works-for-one-attribute-but-not-th", "title": "form_for with f.select and options_for_select works for one attribute but not the second", "body": "<p>This seems like a really basic questions, but I can't figure out what I'm doing wrong. I have my rails form_for with select and options_for_select. </p>\n\n<p>The :plan attribute gets created correctly based on what's selected, but for the plan attribute it's always \"1st year\" no matter what you select for create and when trying to edit. They're basically identical, so I don't understand why one works and not the other. Thanks in advance for your help!</p>\n\n<p>Create Form:</p>\n\n<pre><code>&lt;%= form_for @customer do |f| %&gt;\n&lt;%= f.label :name %&gt;\n&lt;%= f.text_field :name %&gt;\n&lt;%= f.label :phone %&gt;\n&lt;%= f.text_field :phone %&gt;\n&lt;%= f.label :year %&gt;\n&lt;%= f.select :year, options_for_select([['1st Year', 1], ['2nd Year', 2], ['3rd Year', 3], ['4th Year', 4]]) %&gt;\n&lt;%= f.label :plan %&gt;\n&lt;%= f.select :plan, options_for_select([['15', 15], ['45', 45], ['75', 75], ['105', 105]]) %&gt;\n&lt;%= f.submit%&gt;\n&lt;%end%&gt;\n</code></pre>\n\n<p>Edit Form:</p>\n\n<pre><code>&lt;%= form_for @customer do |f| %&gt;\n&lt;%= f.label :name %&gt;\n&lt;%= f.text_field :name %&gt;\n&lt;%= f.label :phone %&gt;\n&lt;%= f.text_field :phone %&gt;\n&lt;%= f.label :year %&gt;\n&lt;%= f.select :year, options_for_select([['1st Year', 1], ['2nd Year', 2], ['3rd Year', 3], ['4th Year', 4]]) %&gt;\n&lt;% if current_user.role == \"admin\"%&gt;\n&lt;%= f.label :plan %&gt;\n&lt;%= f.text_field :plan %&gt;\n&lt;%else%&gt;\n&lt;p&gt;Plan selected: &lt;%=@customer.plan%&gt;&lt;/p&gt;\n&lt;%end%&gt;\n\n&lt;%= f.submit%&gt;\n&lt;%end%&gt;\n</code></pre>\n\n<p>customer_controller:</p>\n\n<pre><code>def create\n    @customer = current_user.customers.create(customer_params)\n    if current_user.role == \"admin\"\n      redirect_to customers_path\n    elsif current_user.role == \"customer\"\n      redirect_to user_customer_path(current_user, @customer)\n    else\n      redirect_to '/'\n    end\n  end\n\n  def update\n    @customer.update(customer_params)\n    if current_user.role === \"customer\"\n      redirect_to customer_path(@customer)\n    else\n      redirect_to customers_path\n    end\n  end\n\nprivate\n  def customer_params\n    params.require(:customer).permit(:name,:year,:email,:plan,:verification)\n  end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "redirect", "http-status-code-404"], "answers": [{"comments": [{"owner": {"reputation": 427, "user_id": 5596671, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95bf9f2cc4e37bd18a2928060935c6ba?s=128&d=identicon&r=PG&f=1", "display_name": "Boris BRESCIANI", "link": "https://stackoverflow.com/users/5596671/boris-bresciani"}, "edited": false, "score": 0, "creation_date": 1453421510, "post_id": 34889763, "comment_id": 57606059, "body": "Yes but i would like to redirect to root_url"}, {"owner": {"reputation": 647, "user_id": 4649530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de2da5fe7e50cd453d448bbc28422677?s=128&d=identicon&r=PG", "display_name": "Gearnode", "link": "https://stackoverflow.com/users/4649530/gearnode"}, "reply_to_user": {"reputation": 427, "user_id": 5596671, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95bf9f2cc4e37bd18a2928060935c6ba?s=128&d=identicon&r=PG&f=1", "display_name": "Boris BRESCIANI", "link": "https://stackoverflow.com/users/5596671/boris-bresciani"}, "edited": false, "score": 0, "creation_date": 1453493203, "post_id": 34889763, "comment_id": 57641619, "body": "just change <code>render file</code> by <code>redirect_to </code>"}], "tags": [], "owner": {"reputation": 647, "user_id": 4649530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de2da5fe7e50cd453d448bbc28422677?s=128&d=identicon&r=PG", "display_name": "Gearnode", "link": "https://stackoverflow.com/users/4649530/gearnode"}, "is_accepted": true, "score": 3, "last_activity_date": 1453251833, "creation_date": 1453251833, "answer_id": 34889763, "question_id": 34889043, "link": "https://stackoverflow.com/questions/34889043/redirect-404-422-500-ruby-on-rails/34889763#34889763", "title": "Redirect 404, 422, 500 Ruby On rails", "body": "<p>In your route file:</p>\n\n<pre><code>#routes.rb\nget '*unmatched_route', to: 'application#raise_not_found'\n</code></pre>\n\n<p>In your application controller</p>\n\n<pre><code>#application_controller.rb\nrescue_from ActiveRecord::RecordNotFound, with: :not_found \nrescue_from Exception, with: :not_found\nrescue_from ActionController::RoutingError, with: :not_found\n\ndef raise_not_found\n  raise ActionController::RoutingError.new(\"No route matches #{params[:unmatched_route]}\")\nend\n\ndef not_found\n  respond_to do |format|\n    format.html { render file: \"#{Rails.root}/public/404\", layout: false, status: :not_found }\n    format.xml { head :not_found }\n    format.any { head :not_found }\n  end\nend\n\ndef error\n  respond_to do |format|\n    format.html { render file: \"#{Rails.root}/public/500\", layout: false, status: :error }\n    format.xml { head :not_found }\n    format.any { head :not_found }\n  end\nend\n</code></pre>\n\n<p>You can find this a complete resource <a href=\"https://gorails.com/forum/error-handling-in-ruby-4\" rel=\"nofollow\">here</a></p>\n"}, {"tags": [], "owner": {"reputation": 427, "user_id": 5596671, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95bf9f2cc4e37bd18a2928060935c6ba?s=128&d=identicon&r=PG&f=1", "display_name": "Boris BRESCIANI", "link": "https://stackoverflow.com/users/5596671/boris-bresciani"}, "is_accepted": false, "score": 1, "last_activity_date": 1580765598, "creation_date": 1580765598, "answer_id": 60047472, "question_id": 34889043, "link": "https://stackoverflow.com/questions/34889043/redirect-404-422-500-ruby-on-rails/60047472#60047472", "title": "Redirect 404, 422, 500 Ruby On rails", "body": "<p>For production env: </p>\n\n<p>In production.rb file, add: </p>\n\n<p><code>config.exceptions_app = routes</code></p>\n\n<p>In routes.rb file, add:\nAdd</p>\n\n<p><code>%w[404 422 500 503].each do |code|\n      get code,\n          to: 'exceptions#show',\n          code: code\n    end</code></p>\n\n<p>Create <code>exceptions_controller.rb</code> file, add:</p>\n\n<pre><code>class ExceptionsController &lt; ApplicationController\n  # GET /exceptions/:code\n  def show\n    status_code = params[:code] || 500\n    render status_code.to_s, status: status_code\n  end\nend\n</code></pre>\n\n<p>Create, 404.html.erb, 422.html.erb, 500.html.erb, 503.html.erb in directory: <code>views/exceptions</code></p>\n\n<p>Enjoy !</p>\n"}], "owner": {"reputation": 427, "user_id": 5596671, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95bf9f2cc4e37bd18a2928060935c6ba?s=128&d=identicon&r=PG&f=1", "display_name": "Boris BRESCIANI", "link": "https://stackoverflow.com/users/5596671/boris-bresciani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3627, "favorite_count": 0, "accepted_answer_id": 34889763, "answer_count": 2, "score": 2, "last_activity_date": 1580765598, "creation_date": 1453247066, "question_id": 34889043, "link": "https://stackoverflow.com/questions/34889043/redirect-404-422-500-ruby-on-rails", "title": "Redirect 404, 422, 500 Ruby On rails", "body": "<p>I would be redirected to the homepage of only 500, 404, 422 error appears, do-it is possible to \"catch\" all errors and redirect to homepage?</p>\n\n<p>I tried that but it works for the 404 error.</p>\n\n<pre><code>  match \"*path\" =&gt; redirect(\"/\"), via: :get\n</code></pre>\n\n<p>Thanks you !</p>\n"}]