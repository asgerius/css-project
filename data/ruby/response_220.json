[{"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 1097, "user_id": 9703830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d48ed2a2cf0e75c7355e044c71385202?s=128&d=identicon&r=PG&f=1", "display_name": "dedObed", "link": "https://stackoverflow.com/users/9703830/dedobed"}, "edited": false, "score": 1, "creation_date": 1553729135, "post_id": 55387704, "comment_id": 97497765, "body": "&quot;Any tips?&quot; is hardly a proper question. Please have a look at to ask <a href=\"https://stackoverflow.com/help/how-to-ask\">a good question</a> and take your time to format the code properly. You can see a preview of your post in the bottom of the editing page."}, {"owner": {"reputation": 7, "user_id": 11227932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9d06051ead74f508d9e4a1b7c7ed9e7?s=128&d=identicon&r=PG&f=1", "display_name": "C_B", "link": "https://stackoverflow.com/users/11227932/c-b"}, "reply_to_user": {"reputation": 1097, "user_id": 9703830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d48ed2a2cf0e75c7355e044c71385202?s=128&d=identicon&r=PG&f=1", "display_name": "dedObed", "link": "https://stackoverflow.com/users/9703830/dedobed"}, "edited": false, "score": 0, "creation_date": 1553729443, "post_id": 55387704, "comment_id": 97497841, "body": "@dedObed, Thank you for your input. Both are edited."}], "answers": [{"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1553766204, "post_id": 55388117, "comment_id": 97509174, "body": "@ray Your edit changes the code&#39;s intention. That is too much."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1553766520, "post_id": 55388117, "comment_id": 97509366, "body": "You can address block as <code>sort_by(&amp;:last)</code> with to format short in length."}, {"owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "reply_to_user": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1553767477, "post_id": 55388117, "comment_id": 97509992, "body": "@ray, I&#39;ve updated my answer and added the link to explain it."}], "tags": [], "owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "is_accepted": false, "score": 4, "last_activity_date": 1553767316, "last_edit_date": 1553767316, "creation_date": 1553730114, "answer_id": 55388117, "question_id": 55387704, "link": "https://stackoverflow.com/questions/55387704/how-to-sort-an-array-of-arrays-in-ascending-order/55388117#55388117", "title": "How to sort an array of arrays in ascending order", "body": "<p>Just use <a href=\"https://ruby-doc.org/core-2.6.1/Array.html#method-i-sort\" rel=\"nofollow noreferrer\"><code>Array#sort</code></a> with block</p>\n\n<pre><code>golf.sort { |a, b| a.last &lt;=&gt; b.last }\n</code></pre>\n\n<p>or <a href=\"https://ruby-doc.org/core-2.6.1/Enumerable.html#method-i-sort_by\" rel=\"nofollow noreferrer\"><code>Enumerable#sort_by</code></a></p>\n\n<pre><code>golf.sort_by { |a| a.last }\n</code></pre>\n\n<p>The second variant <a href=\"https://ruby-doc.org/core-2.6.1/Symbol.html#method-i-to_proc\" rel=\"nofollow noreferrer\">can be shortened</a> using <code>Proc</code></p>\n\n<pre><code>golf.sort_by(&amp;:last)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 75, "user_id": 4909131, "user_type": "registered", "profile_image": "https://graph.facebook.com/813417048752638/picture?type=large", "display_name": "Srinidhi Gs", "link": "https://stackoverflow.com/users/4909131/srinidhi-gs"}, "is_accepted": false, "score": 0, "last_activity_date": 1553757501, "last_edit_date": 1553757501, "creation_date": 1553748619, "answer_id": 55390370, "question_id": 55387704, "link": "https://stackoverflow.com/questions/55387704/how-to-sort-an-array-of-arrays-in-ascending-order/55390370#55390370", "title": "How to sort an array of arrays in ascending order", "body": "<p>Just use <a href=\"https://apidock.com/ruby/Array/sort\" rel=\"nofollow noreferrer\"><code>Array#sort</code></a> with block</p>\n\n<pre><code>golf.sort { |x, y| x[1] &lt;=&gt; y[1] }\n=&gt; [[\"ScoreH\", 1], [\"ScoreB\", 3], [\"ScoreD\", 4], [\"ScoreF\", 9], [\"ScoreA\", 10], [\"ScoreJ\", 23], [\"ScoreG\", 45], [\"ScoreC\", 67], [\"ScoreI\", 87], [\"ScoreE\", 88]]\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 11227932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9d06051ead74f508d9e4a1b7c7ed9e7?s=128&d=identicon&r=PG&f=1", "display_name": "C_B", "link": "https://stackoverflow.com/users/11227932/c-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1553767316, "creation_date": 1553727289, "last_edit_date": 1553766375, "question_id": 55387704, "link": "https://stackoverflow.com/questions/55387704/how-to-sort-an-array-of-arrays-in-ascending-order", "title": "How to sort an array of arrays in ascending order", "body": "<p>Information in an array:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>scores = %w[ScoreA ScoreB ScoreC ScoreD ScoreE ScoreF ScoreG ScoreH ScoreI ScoreJ]\n</code></pre>\n\n<p>needs to be presented in ascending order of the golf scores.</p>\n\n<p>Can anyone help sorting the output in ascending order?</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>golf = scores.map do |score_number|\n  print \"Enter the score for #{score_number}:\"\n  [score_number, gets.to_i]\nend\n\nputs golf.sort\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "documentation", "yard"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1553752188, "post_id": 55387583, "comment_id": 97502859, "body": "are you talking about the &quot;class list&quot; on the left side of the yard doc&#39;s webpage? That hierarchy is determined by namespacing ... so maybe you could create a namespace for your models and controllers, e.g. <code>Models::ModelClass1</code>"}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 9963794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a21e70a17122a9bfe693830289d13d8c?s=128&d=identicon&r=PG", "display_name": "aseroff", "link": "https://stackoverflow.com/users/9963794/aseroff"}, "is_accepted": false, "score": 0, "last_activity_date": 1581094614, "creation_date": 1581094614, "answer_id": 60117884, "question_id": 55387583, "link": "https://stackoverflow.com/questions/55387583/grouping-classes-in-rails-app-documentation-with-yard/60117884#60117884", "title": "Grouping classes in Rails app documentation with Yard", "body": "<p>I had the same goal and raised an issue in the YARD GitHub. They pointed me to the aws-sdk gem that used a custom class list menu structure. I managed to use that to create a generic Rails layout that roughly mimics the folder structure of <code>app/</code>.</p>\n\n<p>You can check out my code under step 3 in <a href=\"https://gist.github.com/aseroff/1535c132e01300680592a48d4c636106\" rel=\"nofollow noreferrer\">this gist</a> (you may need to back up to step 2 to create the template directory structure if you haven't yet).</p>\n"}], "owner": {"reputation": 165, "user_id": 2145834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55e8f55b0e98b6f78d16131d8bfab7d1?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/2145834/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1581094614, "creation_date": 1553726567, "question_id": 55387583, "link": "https://stackoverflow.com/questions/55387583/grouping-classes-in-rails-app-documentation-with-yard", "title": "Grouping classes in Rails app documentation with Yard", "body": "<p>Is there a plugin to format documentation in a way that makes sense for a Rails Application?</p>\n\n<p>I've been trying to use Yard but it puts all of the Model and Controller classes under the top level namespace. Is there any way to get it to treat them as Modules so they all get grouped together?</p>\n\n<p>The structure I'm going for is the same way a rails app is normally structured ie</p>\n\n<pre><code>-Models\n----ModelClass1\n----ModelClass2\n----ModelClass3\n-Controllers\n----ControllerClass1\n----ControllerClass2\n----ControllerClass3\n</code></pre>\n\n<p>But the what the yard documentation generator spits out is</p>\n\n<pre><code>-ModelClass1\n-ModelClass2\n-ModelClass3\n-ControllerClass1\n-ControllerClass2\n-ControllerClass3\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 11235085, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_lP6kUwq-5Q/AAAAAAAAAAI/AAAAAAAAB-M/wGzoEmmAo2M/photo.jpg?sz=128", "display_name": "Adegbite kelvin", "link": "https://stackoverflow.com/users/11235085/adegbite-kelvin"}, "is_accepted": true, "score": 0, "last_activity_date": 1553962180, "creation_date": 1553962180, "answer_id": 55433322, "question_id": 55387395, "link": "https://stackoverflow.com/questions/55387395/how-to-create-view-partial-for-this-notification/55433322#55433322", "title": "How to create view partial for this notification", "body": "<p>After lots of studying I got to know that a notify_type partial must be must be created which must also correspond to the book's notify_type.</p>\n\n<p>i.e I created a </p>\n\n<pre><code>notify_type: \"new_book\"\n</code></pre>\n\n<p>Name of partial= '_new_book.html.erb'</p>\n"}], "owner": {"reputation": 33, "user_id": 11235085, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_lP6kUwq-5Q/AAAAAAAAAAI/AAAAAAAAB-M/wGzoEmmAo2M/photo.jpg?sz=128", "display_name": "Adegbite kelvin", "link": "https://stackoverflow.com/users/11235085/adegbite-kelvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 55433322, "answer_count": 1, "score": 0, "last_activity_date": 1553962180, "creation_date": 1553725476, "question_id": 55387395, "link": "https://stackoverflow.com/questions/55387395/how-to-create-view-partial-for-this-notification", "title": "How to create view partial for this notification", "body": "<p>I've already setup a notification for whenever a user posts a review on a book, the book.user gets notified in this partial: views/notifications/_book.html.erb. At the same time, I trying to create  notification to a user's followers for whenever the user they're following posts a new book. IMO, supposed to create a book partial to render the notification view but I already have a duplicate of the book partial to show reviews notifications. Now I don't know if I can still tweak in in the same file or create something else. I'm using <a href=\"https://github.com/rails-engine/notifications\" rel=\"nofollow noreferrer\">https://github.com/rails-engine/notifications</a>.</p>\n\n<p>I've implemented following relationships which is working well on my app from this tutorial <a href=\"https://www.devwalks.com/lets-build-instagram-with-ruby-on-rails-part-6-follow-all-the-people/\" rel=\"nofollow noreferrer\">https://www.devwalks.com/lets-build-instagram-with-ruby-on-rails-part-6-follow-all-the-people/</a></p>\n\n<p>This is what I've done so far with the codes</p>\n\n<p>user.rb</p>\n\n<pre><code>  has_many :books, dependent: :destroy\n  has_many :chapters, dependent: :destroy\n  has_many :reviews, dependent: :destroy\n  has_many :genres\n  has_many :ratings\n</code></pre>\n\n<p>review.rb</p>\n\n<pre><code>belongs_to :book\nbelongs_to :user\n\nafter_commit :create_notifications, on: :create\n\nprivate\n\ndef create_notifications\n    Notification.create do |notification|\n       notification.notify_type = 'book'\n       notification.actor = self.user\n       notification.user = self.book.user\n       notification.target = self\n       notification.second_target = self.book\n    end\nend\n</code></pre>\n\n<p>views/notifications/_book.html.erb</p>\n\n<pre><code>&lt;div class=''&gt;\n  &lt;%= link_to notification.actor.username, main_app.profile_path(notification.actor.username) %&gt; reviewed\n  &lt;%= link_to notification.second_target.title, main_app.book_path(notification.second_target) %&gt;\n&lt;/div&gt;\n\n&lt;div class=''&gt;\n  &lt;% unless notification.target.blank? %&gt;\n    &lt;div class=\"review-rating\" data-score=\"&lt;%= notification.target.rating %&gt;\"&gt;&lt;/div&gt;\n    &lt;%= notification.target.comment %&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>book.rb</p>\n\n<pre><code>belongs_to :user\nhas_many :chapters, dependent: :destroy\n\nafter_commit :create_notifications, on: :create\n\n    def create_notifications\n        self.user.followers.each do |follower|\n          Notification.create(notify_type: 'book', \n                              actor: self.user,\n                              user: follower, \n                              target: self, \n                              second_target: self.book)\n\n        end\n    end\n</code></pre>\n\n<p>So, if I've to render in the same partial, how should I? or maybe I've to do it another way?</p>\n"}, {"tags": ["html", "ruby", "erb"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1553761731, "post_id": 55386619, "comment_id": 97506639, "body": "Which value might be missing and what&#39;s your expected result for present or missing value?"}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 3956692, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/720397335/picture?type=large", "display_name": "Joshua Hedges", "link": "https://stackoverflow.com/users/3956692/joshua-hedges"}, "edited": false, "score": 0, "creation_date": 1553722241, "post_id": 55386665, "comment_id": 97495476, "body": "would this be reliable without the if? Like &lt;tr&gt;&lt;td&gt;&lt;span class=&quot;label&quot;&gt;Total:&lt;/span&gt;&lt;%= @some_hash&amp;.dig(&#39;root&#39;, &#39;data&#39;, &#39;subdata&#39;) %&gt;&lt;/td&gt;&lt;/tr&gt;."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 2, "last_activity_date": 1553721822, "creation_date": 1553721822, "answer_id": 55386665, "question_id": 55386619, "link": "https://stackoverflow.com/questions/55386619/how-do-i-cleanly-check-if-a-ruby-hash-has-a-value-before-executing-code-in-erb/55386665#55386665", "title": "How do I cleanly check if a ruby hash has a value before executing code in ERB?", "body": "<p><a href=\"https://ruby-doc.org/core-2.3.0_preview1/Hash.html#method-i-dig\" rel=\"nofollow noreferrer\">Hash#dig</a> and the <a href=\"https://docs.ruby-lang.org/en/2.4.0/NEWS-2_3_0.html\" rel=\"nofollow noreferrer\">safe navigation operator</a> will do this:</p>\n\n<pre><code>&lt;% if subdata = @some_hash&amp;.dig('root', 'data', 'subdata') %&gt;\n  &lt;tr&gt;&lt;td&gt;&lt;span class=\"label\"&gt;Total:&lt;/span&gt;&lt;%= subdata %&gt;&lt;/td&gt;&lt;/tr&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><code>dig</code> will attempt to extract the nested value, returning nil if any part of it is unavailable. The safe navigation operator <code>&amp;.</code> prevents the NoMethodError when calling <code>.dig</code> if <code>@some_hash</code> is nil.</p>\n"}, {"comments": [{"owner": {"reputation": 153, "user_id": 3956692, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/720397335/picture?type=large", "display_name": "Joshua Hedges", "link": "https://stackoverflow.com/users/3956692/joshua-hedges"}, "edited": false, "score": 0, "creation_date": 1553782526, "post_id": 55387099, "comment_id": 97519968, "body": "I really like this idea. I keep getting &quot;wrong number of arguments&quot; with the code above. I think it&#39;s in the h.content_tag :span?"}], "tags": [], "owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "is_accepted": false, "score": 2, "last_activity_date": 1553723831, "creation_date": 1553723831, "answer_id": 55387099, "question_id": 55386619, "link": "https://stackoverflow.com/questions/55386619/how-do-i-cleanly-check-if-a-ruby-hash-has-a-value-before-executing-code-in-erb/55387099#55387099", "title": "How do I cleanly check if a ruby hash has a value before executing code in ERB?", "body": "<p>Use a helper</p>\n\n<pre><code>def data_table(source)\n  if subdata = source&amp;.dig('root', 'data', 'subdata')\n    h.content_tag :table do\n      h.content_tag :tr do\n         h.content_tag :td do\n           h.content_tag :span, 'Total:'\n           subdata\n         end\n      end\n    end\n  end\nend\n</code></pre>\n\n<h3>erb</h3>\n\n<pre><code>&lt;p&gt;Name:&lt;/p&gt;&lt;%= @some_hash['root']['data']['name'] %&gt;\n&lt;%= data_table(@some_hash) %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 75, "user_id": 4909131, "user_type": "registered", "profile_image": "https://graph.facebook.com/813417048752638/picture?type=large", "display_name": "Srinidhi Gs", "link": "https://stackoverflow.com/users/4909131/srinidhi-gs"}, "is_accepted": false, "score": 0, "last_activity_date": 1553752126, "last_edit_date": 1553752126, "creation_date": 1553748960, "answer_id": 55390425, "question_id": 55386619, "link": "https://stackoverflow.com/questions/55386619/how-do-i-cleanly-check-if-a-ruby-hash-has-a-value-before-executing-code-in-erb/55390425#55390425", "title": "How do I cleanly check if a ruby hash has a value before executing code in ERB?", "body": "<pre><code>&lt;% if subdata = (@some_has || {}).dig('root', 'data', 'subdata') %&gt;\n  &lt;tr&gt;&lt;td&gt;&lt;span class=\"label\"&gt;Total:&lt;/span&gt;&lt;%= subdata %&gt;&lt;/td&gt;&lt;/tr&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 3956692, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/720397335/picture?type=large", "display_name": "Joshua Hedges", "link": "https://stackoverflow.com/users/3956692/joshua-hedges"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 55386665, "answer_count": 3, "score": 0, "last_activity_date": 1553752126, "creation_date": 1553721557, "last_edit_date": 1553729909, "question_id": 55386619, "link": "https://stackoverflow.com/questions/55386619/how-do-i-cleanly-check-if-a-ruby-hash-has-a-value-before-executing-code-in-erb", "title": "How do I cleanly check if a ruby hash has a value before executing code in ERB?", "body": "<p>I have an XML object that's loaded into a Ruby hash. The goal is to display some complex XML from a web service in a webpage.</p>\n\n<p>The tricky thing is the XML can look different depending on what XML data is returned from the web service.</p>\n\n<p>I have ERB code that looks like this...</p>\n\n<pre><code>...\n&lt;p&gt;Name:&lt;/p&gt;&lt;%= @some_hash['root']['data']['name'] %&gt;\n&lt;table&gt;\n&lt;tr&gt;&lt;td&gt;&lt;span class=\"label\"&gt;Total:&lt;/span&gt;&lt;%= @some_hash['root']['data']['subdata'] %&gt;&lt;/td&gt;&lt;/tr&gt;\n&lt;tr&gt;&lt;td&gt;&lt;span class=\"label\"&gt;Rate:&lt;/span&gt;&lt;%= @some_hash['root']['data']['subdata1'] %&gt;&lt;/td&gt;&lt;/tr&gt;\n&lt;/table&gt;\n&lt;table&gt;\n    &lt;tr&gt;\n      &lt;th&gt;Column A&lt;/th&gt;\n      &lt;th&gt;Column B&lt;/th&gt;\n    &lt;/tr&gt;\n\n  &lt;% @some_hash['root']['data']['subdata2'].each do |value| %&gt;\n    &lt;tr&gt;\n      &lt;td&gt;&lt;%= @value['A'] %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= @value['B']  %&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n  &lt;% end %&gt;\n &lt;/table&gt;\n...\n</code></pre>\n\n<p>I put the \"@\" in front of the variables to check for nil. That didn't do much. I'm not sure if this is the best approach. How do I cleanly iterate through the ERB and only execute if the value exists?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "development-environment"], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 11310288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17709d0499fdc58dcae0b29b3142027e?s=128&d=identicon&r=PG&f=1", "display_name": "AngelOfDawn", "link": "https://stackoverflow.com/users/11310288/angelofdawn"}, "is_accepted": false, "score": 4, "last_activity_date": 1554393498, "last_edit_date": 1554393498, "creation_date": 1554382659, "answer_id": 55516598, "question_id": 55386266, "link": "https://stackoverflow.com/questions/55386266/getting-error-exit-code-2-for-bootsnap-not-allowing-to-set-up-rails-server/55516598#55516598", "title": "Getting error (exit code 2) for bootsnap, not allowing to set up Rails Server", "body": "<p>I had the same problem and I'm also using railsinstaller on a windows computer.</p>\n\n<p>To solve it, I updated my Gemfile like this :</p>\n\n<pre><code>#gem 'bootsnap', '&gt;= 1.1.0', require: false\ngem 'bootsnap', '= 1.4.1', require: false\n</code></pre>\n\n<p>Then run the command : <code>bundle install</code> in your project directory.</p>\n"}, {"tags": [], "owner": {"reputation": 2115, "user_id": 534600, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1cd9c8984f2fdeb996130d54d62a98d9?s=128&d=identicon&r=PG", "display_name": "Arman Ortega", "link": "https://stackoverflow.com/users/534600/arman-ortega"}, "is_accepted": false, "score": 0, "last_activity_date": 1558616215, "creation_date": 1558616215, "answer_id": 56275766, "question_id": 55386266, "link": "https://stackoverflow.com/questions/55386266/getting-error-exit-code-2-for-bootsnap-not-allowing-to-set-up-rails-server/56275766#56275766", "title": "Getting error (exit code 2) for bootsnap, not allowing to set up Rails Server", "body": "<p>I also encountered the same problem. I'm using ruby 2.3.0, rails 5.2.3.\nTo solve it, I updated my Gemfile.</p>\n\n<pre><code># it don't work....\n# gem 'bootsnap', '&gt;= 1.1.0', require: false\n# gem 'bootsnap', '&gt;= 1.4.2', require: false\n\ngem 'bootsnap', require: false\n</code></pre>\n\n<p>Then bundle install and it works!</p>\n"}], "owner": {"reputation": 11, "user_id": 8101492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M1UCj.jpg?s=128&g=1", "display_name": "Fahad Hossain", "link": "https://stackoverflow.com/users/8101492/fahad-hossain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2819, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1604586920, "creation_date": 1553719995, "question_id": 55386266, "link": "https://stackoverflow.com/questions/55386266/getting-error-exit-code-2-for-bootsnap-not-allowing-to-set-up-rails-server", "title": "Getting error (exit code 2) for bootsnap, not allowing to set up Rails Server", "body": "<p>Trying to test a website built on Rails and keep getting an error that refuses to allow me to set up my server.</p>\n\n<p>After getting an error, I used 'gem install bootsnap -v '1.4.2' --source '<a href=\"https://rubygems.org/\" rel=\"nofollow noreferrer\">https://rubygems.org/</a>' with the source as Rubygems. Same error:</p>\n\n<pre><code>Temporarily enhancing PATH to include DevKit...\nBuilding native extensions. This could take a while...\nERROR:  Error installing bootsnap:\n        ERROR: Failed to build gem native extension.\n\n    current directory: C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/bootsnap-1.4.2/ext/bootsnap\nC:/RailsInstaller/Ruby2.3.3/bin/ruby.exe -I C:/RailsInstaller/Ruby2.3.3/lib/ruby/site_ruby/2.3.0 -r ./siteconf20190327-13232-1084dsi.rb extconf.rb\ncreating Makefile\n\ncurrent directory: C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/bootsnap-1.4.2/ext/bootsnap\nmake \"DESTDIR=\" clean\n\ncurrent directory: C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/bootsnap-1.4.2/ext/bootsnap\nmake \"DESTDIR=\"\ngenerating bootsnap-i386-mingw32.def\ncompiling bootsnap.c\nbootsnap.c: In function 'bs_cache_path':\nbootsnap.c:240:3: warning: unknown conversion type character 'l' in format [-Wformat]\nbootsnap.c:240:3: warning: too many arguments for format [-Wformat-extra-args]\nbootsnap.c: In function 'bs_rb_fetch':\nbootsnap.c:281:3: warning: ISO C90 forbids mixed declarations and code [-Wdeclaration-after-statement]\nbootsnap.c: In function 'fetch_cached_data':\nbootsnap.c:407:3: warning: comparison is always false due to limited range of data type [-Wtype-limits]\nbootsnap.c: In function 'atomic_write_cache_file':\nbootsnap.c:479:3: warning: implicit declaration of function 'mkstemp' [-Wimplicit-function-declaration]\nbootsnap.c: In function 'bs_rb_fetch':\nbootsnap.c:623:13: warning: 'output_data' may be used uninitialized in this function [-Wmaybe-uninitialized]\nbootsnap.c:594:9: note: 'output_data' was declared here\nlinking shared-object bootsnap/bootsnap.so\nbootsnap.o: In function `atomic_write_cache_file':\nC:\\RailsInstaller\\Ruby2.3.3\\lib\\ruby\\gems\\2.3.0\\gems\\bootsnap-1.4.2\\ext\\bootsnap/bootsnap.c:479: undefined reference to `mkstemp'\ncollect2.exe: error: ld returned 1 exit status\nmake: *** [bootsnap.so] Error 1\n\nmake failed, exit code 2\n\nGem files will remain installed in C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/bootsnap-1.4.2 for inspection.\nResults logged to C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/extensions/x86-mingw32/2.3.0/bootsnap-1.4.2/gem_make.out\n</code></pre>\n\n<p>My gemfile includes this:</p>\n\n<pre><code># Reduces boot times through caching; required in config/boot.rb\ngem 'bootsnap', '&gt;= 1.4.2', require: true\n</code></pre>\n\n<p>I do see bootsnap located: C:\\RailsInstaller\\Ruby2.3.3\\lib\\ruby\\gems\\2.3.0\\gems</p>\n\n<p>Would anyone know how to get rid of this? It is not located on my <i>gem list</i> either.</p>\n\n<pre><code>Temporarily enhancing PATH to include DevKit...\nBuilding native extensions. This could take a while...\nERROR:  Error installing bootsnap:\n        ERROR: Failed to build gem native extension.\n\n    current directory: C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/bootsnap-1.4.2/ext/bootsnap\nC:/RailsInstaller/Ruby2.3.3/bin/ruby.exe -I C:/RailsInstaller/Ruby2.3.3/lib/ruby/site_ruby/2.3.0 -r ./siteconf20190327-21940-1y9qpk9.rb extconf.rb\ncreating Makefile\n\ncurrent directory: C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/bootsnap-1.4.2/ext/bootsnap\nmake \"DESTDIR=\" clean\n\ncurrent directory: C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/bootsnap-1.4.2/ext/bootsnap\nmake \"DESTDIR=\"\ngenerating bootsnap-i386-mingw32.def\ncompiling bootsnap.c\nbootsnap.c: In function 'bs_cache_path':\nbootsnap.c:240:3: warning: unknown conversion type character 'l' in format [-Wformat]\nbootsnap.c:240:3: warning: too many arguments for format [-Wformat-extra-args]\nbootsnap.c: In function 'bs_rb_fetch':\nbootsnap.c:281:3: warning: ISO C90 forbids mixed declarations and code [-Wdeclaration-after-statement]\nbootsnap.c: In function 'fetch_cached_data':\nbootsnap.c:407:3: warning: comparison is always false due to limited range of data type [-Wtype-limits]\nbootsnap.c: In function 'atomic_write_cache_file':\nbootsnap.c:479:3: warning: implicit declaration of function 'mkstemp' [-Wimplicit-function-declaration]\nbootsnap.c: In function 'bs_rb_fetch':\nbootsnap.c:623:13: warning: 'output_data' may be used uninitialized in this function [-Wmaybe-uninitialized]\nbootsnap.c:594:9: note: 'output_data' was declared here\nlinking shared-object bootsnap/bootsnap.so\nbootsnap.o: In function `atomic_write_cache_file':\nC:\\RailsInstaller\\Ruby2.3.3\\lib\\ruby\\gems\\2.3.0\\gems\\bootsnap-1.4.2\\ext\\bootsnap/bootsnap.c:479: undefined reference to `mkstemp'\ncollect2.exe: error: ld returned 1 exit status\nmake: *** [bootsnap.so] Error 1\n\nmake failed, exit code 2\n\nGem files will remain installed in C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/bootsnap-1.4.2 for inspection.\nResults logged to C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/extensions/x86-mingw32/2.3.0/bootsnap-1.4.2/gem_make.out\n</code></pre>\n"}, {"tags": ["html", "css", "ruby-on-rails", "ruby", "hyperstack"], "comments": [{"owner": {"reputation": 876, "user_id": 4079426, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-KUlAQtA-Fh0/AAAAAAAAAAI/AAAAAAAABxw/gCaWSRISiXI/photo.jpg?sz=128", "display_name": "probitaille", "link": "https://stackoverflow.com/users/4079426/probitaille"}, "edited": false, "score": 0, "creation_date": 1553719755, "post_id": 55386110, "comment_id": 97494264, "body": "Welcome to Stack Overflow. You need to add some precision to your question. What is your problem, what have you tried and what is your question. Please see: <a href=\"https://stackoverflow.com/help/how-to-ask\">How to ask</a>"}, {"owner": {"reputation": 2584, "user_id": 859491, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6951e58d024aa7812271f8d52ff31646?s=128&d=identicon&r=PG", "display_name": "Mitch VanDuyn", "link": "https://stackoverflow.com/users/859491/mitch-vanduyn"}, "edited": false, "score": 0, "creation_date": 1553784982, "post_id": 55386110, "comment_id": 97521918, "body": "FYI matt the old haml style (i.e. <code>div.upload_header</code>) is deprecated so you want to get rid of that stuff anyway."}], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 11256360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00a7ecf4e880a5fa5f709f4a3d733c5d?s=128&d=identicon&r=PG", "display_name": "adamcreekroad", "link": "https://stackoverflow.com/users/11256360/adamcreekroad"}, "is_accepted": true, "score": 4, "last_activity_date": 1553732681, "creation_date": 1553732681, "answer_id": 55388427, "question_id": 55386110, "link": "https://stackoverflow.com/questions/55386110/hyperstack-add-dynamic-class-to-manual-class-names/55388427#55388427", "title": "Hyperstack add dynamic class to manual class names", "body": "<p>String interpolation can be done conditionally:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>DIV(class: \"upload-header text-left #{'uploaded' if FileUploads.complete?}\")\n</code></pre>\n\n<p>The class parameter can also accept an array:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def upload_header_classes\n  ['upload-header', 'text-left'].tap do |classes|\n    classes &lt;&lt; 'uploaded' if FileUploads.complete?\n  end\nend\n\nDIV(class: upload_header_classes)\n</code></pre>\n\n<p>I'm sure there are plenty of other ways to do it too, this is ruby!</p>\n"}], "owner": {"reputation": 63, "user_id": 11268700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c43b83a94e641b3b33c34151b7bdd28?s=128&d=identicon&r=PG", "display_name": "Matt Saginario", "link": "https://stackoverflow.com/users/11268700/matt-saginario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 55388427, "answer_count": 1, "score": 3, "last_activity_date": 1553732681, "creation_date": 1553719367, "question_id": 55386110, "link": "https://stackoverflow.com/questions/55386110/hyperstack-add-dynamic-class-to-manual-class-names", "title": "Hyperstack add dynamic class to manual class names", "body": "<p>I need to add a dynamic class to some regular classes while updating syntax for Hyperstack:</p>\n\n<pre><code>div.upload_header.text_left(class: ('uploaded' if \nFileUploads.complete?)) do\n</code></pre>\n\n<p>Should become something like this:</p>\n\n<pre><code>DIV(class: 'upload-header text-left (dynamic 'uploaded' should go \nhere)') do\n</code></pre>\n\n<p>I just can't seem to figure out how/if regular and dynamic classes can be declared together.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1553715700, "post_id": 55385221, "comment_id": 97492396, "body": "Do you have a controller named <code>StaticPageController</code> that is defined in <code>app&#47;controllers&#47;static_page_controller.rb</code>. Or it might be a typo in the <code>routes.rb</code> and you actually wanted to define <code>resources :static_pages</code> (plural)?"}, {"owner": {"reputation": 51, "user_id": 8659002, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nLcaePq9sog/AAAAAAAAAAI/AAAAAAAACtA/wiJ0D7eDcm4/photo.jpg?sz=128", "display_name": "Hedgar Bezerra", "link": "https://stackoverflow.com/users/8659002/hedgar-bezerra"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1553715890, "post_id": 55385221, "comment_id": 97492481, "body": "Figures, I must&#39;ve deleted the controller that&#39;s why this error is surging. I really apreciate it though."}], "answers": [{"tags": [], "owner": {"reputation": 75, "user_id": 4909131, "user_type": "registered", "profile_image": "https://graph.facebook.com/813417048752638/picture?type=large", "display_name": "Srinidhi Gs", "link": "https://stackoverflow.com/users/4909131/srinidhi-gs"}, "is_accepted": true, "score": 1, "last_activity_date": 1553715939, "creation_date": 1553715939, "answer_id": 55385346, "question_id": 55385221, "link": "https://stackoverflow.com/questions/55385221/rails-sudden-action-controller-exception/55385346#55385346", "title": "Rails sudden Action controller Exception", "body": "<p>Which means there is no class defined such as StaticPageController in your code. </p>\n\n<p>// add this into your controllers folder</p>\n\n<h3>class StaticPageController &lt; ApplicationController</h3>\n\n<h3>end</h3>\n"}], "owner": {"reputation": 51, "user_id": 8659002, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nLcaePq9sog/AAAAAAAAAAI/AAAAAAAACtA/wiJ0D7eDcm4/photo.jpg?sz=128", "display_name": "Hedgar Bezerra", "link": "https://stackoverflow.com/users/8659002/hedgar-bezerra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 55385346, "answer_count": 1, "score": -2, "last_activity_date": 1553715939, "creation_date": 1553715480, "question_id": 55385221, "link": "https://stackoverflow.com/questions/55385221/rails-sudden-action-controller-exception", "title": "Rails sudden Action controller Exception", "body": "<p><a href=\"https://i.stack.imgur.com/JE8DB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JE8DB.png\" alt=\"enter image description here\"></a></p>\n\n<p>I'm working on a Rails project and this error showed up and I don't know what exactly is the reason.</p>\n\n<pre><code>Rails.application.routes.draw do\n\nroot to: 'static_page#login'\nresources :static_page\nresources :users\nresources :locations\nresources :timetracks\nget 'account', to: 'static_page#account'\nget 'map', to: 'static_page#map'    \nget 'login', to: 'static_page#login'\nget 'signup', to: 'static_page#signup'\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "paperclip"], "comments": [{"owner": {"reputation": 1261, "user_id": 8844929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0b2684f65b25d110b6b2408fc7ebb0?s=128&d=identicon&r=PG", "display_name": "Veridian Dynamics", "link": "https://stackoverflow.com/users/8844929/veridian-dynamics"}, "edited": false, "score": 0, "creation_date": 1553714481, "post_id": 55384879, "comment_id": 97491817, "body": "Image storage? OverDrive seems to solely provide formats for audio books, videos, and ebooks. So, no. This quote literally comes from their FAQs &quot;Pictures ... take up a lot of space on your device. You may want to consider deleting some, or transferring them to a computer, storage device, or cloud storage service.&quot; They clearly don&#39;t even recommend their own service for image uploads. I recommend you find a different API. Plus PaperClip recommends ActiveStorage!"}, {"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "reply_to_user": {"reputation": 1261, "user_id": 8844929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0b2684f65b25d110b6b2408fc7ebb0?s=128&d=identicon&r=PG", "display_name": "Veridian Dynamics", "link": "https://stackoverflow.com/users/8844929/veridian-dynamics"}, "edited": false, "score": 0, "creation_date": 1553714965, "post_id": 55384879, "comment_id": 97492036, "body": "@VeridianDynamics can we store audios there trough paperclip?"}, {"owner": {"reputation": 1261, "user_id": 8844929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0b2684f65b25d110b6b2408fc7ebb0?s=128&d=identicon&r=PG", "display_name": "Veridian Dynamics", "link": "https://stackoverflow.com/users/8844929/veridian-dynamics"}, "edited": false, "score": 0, "creation_date": 1553715060, "post_id": 55384879, "comment_id": 97492072, "body": "Yes I believe so, but the API docs were sparse on POST requests. I&#39;m sure it can be done."}], "owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553713937, "creation_date": 1553713937, "question_id": 55384879, "link": "https://stackoverflow.com/questions/55384879/is-it-possible-to-upload-images-on-overdrive-using-paperclip-in-rails", "title": "Is it possible to upload images on overdrive using paperclip in rails", "body": "<p>For image storage I want to use overdrive. But can't find any way to upload in ruby on rails using paperclip</p>\n\n<p>Is it possible ? If yes then how can we do that</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1553710644, "post_id": 55383922, "comment_id": 97489959, "body": "Try deleting non-present entries in the first, then merge to the second. Use <code>delete_if</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1553713261, "post_id": 55383922, "comment_id": 97491270, "body": "A hash cannot be <code>nil</code> or <code>blank</code>. It seems that you are referring to the values of the first hash&#39;s keys. You need to clarify that point."}], "answers": [{"comments": [{"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1553802711, "post_id": 55384320, "comment_id": 97532238, "body": "Hi, @CarySwoveland you mean explain how the block works more explicitly?  Edited answer. Cheers"}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1553805266, "post_id": 55384320, "comment_id": 97533437, "body": "@CarySwoveland okey dokey"}], "tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 2, "last_activity_date": 1553805235, "last_edit_date": 1553805235, "creation_date": 1553711704, "answer_id": 55384320, "question_id": 55383922, "link": "https://stackoverflow.com/questions/55383922/is-there-any-shorter-way-to-write-this-merger-of-hash/55384320#55384320", "title": "Is there any shorter way to write this merger of hash?", "body": "<p>Use your code, which is fine, but use curly braces for the block and shorter block variables. And you don't need the second <code>presence</code></p>\n\n<pre><code>main_hash.merge!(option_hash){|_k, h1, h2| h1.presence || h2}\n</code></pre>\n\n<p><code>#merge!</code> (and <code>#merge</code>) with a block only invokes the block to handle cases where a key is present in both hashes. Where <code>option_hash</code> keys are not present in <code>main_hash</code>, the key/value pair is simply inserted.</p>\n\n<p>You can use <code>#merge!</code> with a block to do some neat tricks, like setting up a combined total of hash values.</p>\n\n<pre><code>hash_1 = {a: 1, b: 1, c: 1}\nhash_2 = {b: 1, c: 1, d: 1}\n\nhash_1.merge!(hash_2{|_k, v1, v2| v1 + v2}\n=&gt; {:a =&gt; 1, :b =&gt; 2, :c =&gt; 2, :d =&gt; 1}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 943, "user_id": 546950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60de781d84a6767b10c5040c54180433?s=128&d=identicon&r=PG", "display_name": "robertoplancarte", "link": "https://stackoverflow.com/users/546950/robertoplancarte"}, "is_accepted": false, "score": 1, "last_activity_date": 1553713669, "last_edit_date": 1553713669, "creation_date": 1553711974, "answer_id": 55384391, "question_id": 55383922, "link": "https://stackoverflow.com/questions/55383922/is-there-any-shorter-way-to-write-this-merger-of-hash/55384391#55384391", "title": "Is there any shorter way to write this merger of hash?", "body": "<p>This is shorter, but I think your way is more readable. </p>\n\n<pre><code>main_hash   = {a:1, b:nil, c:3}\noption_hash = {a:5, b:2, c:8}\n\nmain_hash   = option_hash.merge(main_hash.reject{|_,v| v.blank?})\n\n#=&gt; {a:1, b:2, c:3}\n</code></pre>\n\n<p>You could do it this way and give the result a variable name that makes what is happening a bit clearer like <code>merged_main_option_hash</code> instead of just <code>main_hash</code></p>\n"}, {"comments": [{"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1553712781, "post_id": 55384470, "comment_id": 97491027, "body": "It&#39;s a good attempt but if the <code>main_hash_value</code> is nil or an empty string it doesn&#39;t get replaced, so it doesn&#39;t meet OPs requirement."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1553713589, "post_id": 55384470, "comment_id": 97491433, "body": "Your answer would be easier to read if you removed pry&#39;s prompts. Also, it is customary to show return values beginning <code>#=&gt;</code> or <code># =&gt;</code>, so that others can run copied and pasted code without the return values causing exceptions."}], "tags": [], "owner": {"reputation": 1, "user_id": 4226723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZFrfQ.jpg?s=128&g=1", "display_name": "LionHeart", "link": "https://stackoverflow.com/users/4226723/lionheart"}, "is_accepted": false, "score": 0, "last_activity_date": 1553713454, "last_edit_date": 1553713454, "creation_date": 1553712339, "answer_id": 55384470, "question_id": 55383922, "link": "https://stackoverflow.com/questions/55383922/is-there-any-shorter-way-to-write-this-merger-of-hash/55384470#55384470", "title": "Is there any shorter way to write this merger of hash?", "body": "<pre><code>[1] pry(main)&gt; main_hash = { key1: 1, key2: 2, key3: '', key4: nil }\n=&gt; {:key1=&gt;1, :key2=&gt;2, :key3=&gt;\"\", :key4=&gt;nil}\n[2] pry(main)&gt; option_hash = { key2: 2.2, key3: 3, key4: 4 }\n=&gt; {:key2=&gt;2.2, :key3=&gt;3, :key4=&gt;4}\n[3] pry(main)&gt; main_hash.reject!{ |key, value| value.blank? }.merge!(option_hash) { |key, main_hash_value, option_hash_value| main_hash_value }\n=&gt; {:key1=&gt;1, :key2=&gt;2, :key3=&gt;3, :key4=&gt;4}\n[4] pry(main)&gt; \n</code></pre>\n\n<p>Refer <a href=\"https://apidock.com/ruby/Hash/merge%21\" rel=\"nofollow noreferrer\">apidock:merge!</a>, <a href=\"https://apidock.com/ruby/Hash/reject%21\" rel=\"nofollow noreferrer\">apidock:reject!</a>  for more details.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11268050"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 55384320, "answer_count": 3, "score": 0, "last_activity_date": 1553805235, "creation_date": 1553710178, "last_edit_date": 1553766588, "question_id": 55383922, "link": "https://stackoverflow.com/questions/55383922/is-there-any-shorter-way-to-write-this-merger-of-hash", "title": "Is there any shorter way to write this merger of hash?", "body": "<p>I have two hashes. The first hash should be prioritized. It should be overwritten by the second hash only when it is <code>nil</code> or blank.</p>\n\n<pre><code>main_hash.merge!(option_hash) do |key, main_hash, option_hash|\n  main_hash.presence || option_hash.presence\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1553710320, "post_id": 55383638, "comment_id": 97489769, "body": "This looks like a parallel assignment of the hash keys."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1553718141, "post_id": 55383638, "comment_id": 97493544, "body": "See the doc for <a href=\"https://docs.ruby-lang.org/en/2.6.0/syntax/assignment_rdoc.html#label-Multiple+Assignment\" rel=\"nofollow noreferrer\">multiple assignment</a>. It&#39;s well-written and covers a number of situations. In fact, that entire file deserves carefully study."}], "answers": [{"tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 5, "last_activity_date": 1553710640, "creation_date": 1553710640, "answer_id": 55384048, "question_id": 55383638, "link": "https://stackoverflow.com/questions/55383638/what-is-the-comma-character-meaning-in-right-side-of-expression-in-ruby/55384048#55384048", "title": "What is the comma character meaning in right side of expression in Ruby", "body": "<p>It's two symbols separated by a comma, and is an implicit array.</p>\n\n<p>Equivalent to </p>\n\n<pre><code>self.primary_keys = [:role_id, :action_name]\n</code></pre>\n\n<p>It's more common to see the technique used on the left side of an assignment.</p>\n\n<pre><code>name, age = [\"George\", 21]\n\nputs name\n=&gt; \"George\"\n\nputs age\n=&gt; 21\n</code></pre>\n\n<p>The feature lets you swap the contents of variables without an intermediate variable.</p>\n\n<p>For example, in some languages to swap <code>a</code> and <code>b</code> you need a temporary variable</p>\n\n<pre><code>temporary = a\na = b\nb = temporary\n</code></pre>\n\n<p>In Ruby you can do</p>\n\n<pre><code>a, b = b, a\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1553718541, "post_id": 55385288, "comment_id": 97493706, "body": "A quibble: <code>puts y</code> displays the string <code>y.to_s</code>, which is why you should just write, <code>x #=&gt; &quot;Srini&quot;; y #=&gt; 25</code>."}], "tags": [], "owner": {"reputation": 75, "user_id": 4909131, "user_type": "registered", "profile_image": "https://graph.facebook.com/813417048752638/picture?type=large", "display_name": "Srinidhi Gs", "link": "https://stackoverflow.com/users/4909131/srinidhi-gs"}, "is_accepted": false, "score": 0, "last_activity_date": 1553715737, "creation_date": 1553715737, "answer_id": 55385288, "question_id": 55383638, "link": "https://stackoverflow.com/questions/55383638/what-is-the-comma-character-meaning-in-right-side-of-expression-in-ruby/55385288#55385288", "title": "What is the comma character meaning in right side of expression in Ruby", "body": "<p>It's assignment</p>\n\n<p>x, y = [\"Srini\", 25]</p>\n\n<p>puts x\n=> \"Srini\"</p>\n\n<p>puts y\n=> 25</p>\n"}], "owner": {"reputation": 2181, "user_id": 5598574, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/aUJPQ.jpg?s=128&g=1", "display_name": "Hairi", "link": "https://stackoverflow.com/users/5598574/hairi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 55384048, "answer_count": 2, "score": 2, "last_activity_date": 1553715737, "creation_date": 1553709079, "question_id": 55383638, "link": "https://stackoverflow.com/questions/55383638/what-is-the-comma-character-meaning-in-right-side-of-expression-in-ruby", "title": "What is the comma character meaning in right side of expression in Ruby", "body": "<p>Excuse me for this basic question but, I couldn't find the answer on Google.\nI am new to Ruby and came across to this line of code:</p>\n\n<pre><code>self.primary_keys = :role_id, :action_name\n</code></pre>\n\n<p>What I understand from it is that <code>self.primary_keys</code> is a Class variable and is assigned an array or hash of symbols?\nWhat means the right side of the expression (<code>:role_id, :action_name</code>)?\nWhat is the type of it?</p>\n"}, {"tags": ["ruby", "jekyll"], "answers": [{"comments": [{"owner": {"reputation": 215, "user_id": 2041781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bb2528f353f3a89e73f9c82f27e4b5f2?s=128&d=identicon&r=PG", "display_name": "cryptic0", "link": "https://stackoverflow.com/users/2041781/cryptic0"}, "edited": false, "score": 0, "creation_date": 1553719768, "post_id": 55386034, "comment_id": 97494269, "body": "I was worried because when I tried this on machine #2, there was a prompt to execute <code>bundle install</code>.  I thought this would create conflicts.  So I made a copy and tried and it works well."}, {"owner": {"reputation": 1050, "user_id": 6292679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bd1f35218f22188dd4c7ba94c57d774?s=128&d=identicon&r=PG", "display_name": "DC.Azndj", "link": "https://stackoverflow.com/users/6292679/dc-azndj"}, "reply_to_user": {"reputation": 215, "user_id": 2041781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bb2528f353f3a89e73f9c82f27e4b5f2?s=128&d=identicon&r=PG", "display_name": "cryptic0", "link": "https://stackoverflow.com/users/2041781/cryptic0"}, "edited": false, "score": 1, "creation_date": 1553732941, "post_id": 55386034, "comment_id": 97498681, "body": "<code>bundle install</code> installs ruby gems to the local computer in a different directory (<code>~&#47;.gem&#47;ruby&#47;</code> I think). It shouldn&#39;t affect anything in Dropbox"}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1553798795, "post_id": 55386034, "comment_id": 97530154, "body": "Not at the moment (need a new Mac), but I have used my Jekyll installations, one on an iMac and one on my Win10 laptop to maintain the same sites. No problem at all."}], "tags": [], "owner": {"reputation": 1050, "user_id": 6292679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bd1f35218f22188dd4c7ba94c57d774?s=128&d=identicon&r=PG", "display_name": "DC.Azndj", "link": "https://stackoverflow.com/users/6292679/dc-azndj"}, "is_accepted": false, "score": 2, "last_activity_date": 1553719023, "creation_date": 1553719023, "answer_id": 55386034, "question_id": 55383491, "link": "https://stackoverflow.com/questions/55383491/launching-a-jekyll-site-from-two-computers-not-simultaneously/55386034#55386034", "title": "Launching a Jekyll site from two computers (not simultaneously)", "body": "<p>I do this on my own Jekyll projects and it works perfectly. I can work on files on one machine, save everything, then switch to a second machine and pick up where I left off. I can run <code>jekyll serve</code> on both machines with no problem. I've never run <code>jekyll serve</code> on both machines at the same time, so I can't help there. But, running <code>jekyll serve</code> on either individual machine one-at-a-time works.</p>\n\n<p>One issue I've run into in the past is when editing the same file on two different machines at the same time. Dropbox tried to save both versions and ended up with conflicting files (kinda like git merge conflicts). I haven't run into that when doing Jekyll stuff, just regular Word docs and such. But, lesson learned: don't try editing the same file from two different machines at the same time.</p>\n"}], "owner": {"reputation": 215, "user_id": 2041781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bb2528f353f3a89e73f9c82f27e4b5f2?s=128&d=identicon&r=PG", "display_name": "cryptic0", "link": "https://stackoverflow.com/users/2041781/cryptic0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553719023, "creation_date": 1553708509, "last_edit_date": 1553708840, "question_id": 55383491, "link": "https://stackoverflow.com/questions/55383491/launching-a-jekyll-site-from-two-computers-not-simultaneously", "title": "Launching a Jekyll site from two computers (not simultaneously)", "body": "<p>My local jekyll site lives under <code>~/Dropbox/Sites/mysite/</code>.  I often make changes to the files from two different computers. Could I launch (one at a time) the <code>jekyll serve</code> function from each of these machines?  </p>\n\n<p>Is this possible and if yes, is it a bad idea? I just hate being restricted to one machine for maintaining my site.  Both machines have up to date versions of ruby and jekyll.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1553706081, "post_id": 55382431, "comment_id": 97487488, "body": "Your block variable name is semantically incorrect. Rename it and then you&#39;ll easily see the correct calculation."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1553707226, "post_id": 55382431, "comment_id": 97488100, "body": "&quot;Did not work&quot; is not a useful diagnostic. Error messages, especially the <i>exact text</i> of those, is a lot better."}], "answers": [{"comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1553706495, "post_id": 55382625, "comment_id": 97487716, "body": "Since the OP appears to be new to Ruby, you may wish to mention string interpolation."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1553707305, "post_id": 55382625, "comment_id": 97488134, "body": "Ruby will actually warn about &quot;variable shadowing&quot; which is using the same name twice in different, overlapping scopes, if the <code>-w</code> flag is enabled. It&#39;s a good idea to avoid it not only because it&#39;s confusing, but because it can lead to unexpected results."}], "tags": [], "owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "is_accepted": false, "score": 3, "last_activity_date": 1553710980, "last_edit_date": 1553710980, "creation_date": 1553705642, "answer_id": 55382625, "question_id": 55382431, "link": "https://stackoverflow.com/questions/55382431/show-age-of-user/55382625#55382625", "title": "Show age of user", "body": "<p>You can use a different form of block like this:</p>\n\n<pre><code>puts \"when are you born (year) ?\"\nbirth_year = gets.to_i    \nbirth_year.upto(2017) do |iterating_year|\n  puts \"Year: #{iterating_year}\"\n  puts \"Age: #{iterating_year - birth_year }\"\nend\n</code></pre>\n\n<p>Or if you want it all in the same line try this - but it's less readable:</p>\n\n<pre><code>birth_year.upto(2017) { |iterating_year|  puts \"Year: #{iterating_year}\"; puts \"Age: #{iterating_year - birth_year }\" }\n</code></pre>\n\n<h3>Naming block variables</h3>\n\n<ul>\n<li>Recommendation: Do not use the same variable name in your block as you have outside the block - that's just confusing. In this particular case, with the code as you have written it, the <code>birth_year</code> you have defined outside the block will have fallen out of scope, and the block parameter will take on the iterating years value: 2001, 2002, 2003 etc.</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/0QjBa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0QjBa.png\" alt=\"Same and confusing - avoid\"></a></p>\n\n<h3>String Interpolation</h3>\n\n<p>This is when join strings together. One method you could use is to write some ruby code inside a string - you need a hash tag and opening and closing curly brackets to make it work. See <a href=\"http://ruby-for-beginners.rubymonstas.org/bonus/string_interpolation.html\" rel=\"nofollow noreferrer\">this link for more</a> info or google \"ruby string interpoloation\".</p>\n"}], "owner": {"reputation": 15, "user_id": 11267636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1e27a2252c7644d006787823497d5cf?s=128&d=identicon&r=PG&f=1", "display_name": "antoine", "link": "https://stackoverflow.com/users/11267636/antoine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553710980, "creation_date": 1553704978, "last_edit_date": 1553705960, "question_id": 55382431, "link": "https://stackoverflow.com/questions/55382431/show-age-of-user", "title": "Show age of user", "body": "<p>I need to ask the user for their birth year, and then display every year from the birth year to 2017 with the age for each year.</p>\n\n<p>I started with this: </p>\n\n<pre><code>puts \"when are you born (year) ?\"\nbirth_year = gets.to_i\nbirth_year.upto(2017){ |birth_year| puts birth_year }\n</code></pre>\n\n<p>I miss the part to display the age. I tried some stuff like:</p>\n\n<pre><code>puts birth_year.upto(2017) - birth_year\n</code></pre>\n\n<p>but it did not work.</p>\n"}, {"tags": ["ruby", "inheritance", "factory", "class-method"], "answers": [{"comments": [{"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1553774315, "post_id": 55383061, "comment_id": 97514240, "body": "OP should read up on the Liskov substitution principle. If it doesn&#39;t make sense to use a <code>B</code> wherever you use an <code>A</code>, you shouldn&#39;t be writing <code>class B &lt; A</code>"}, {"owner": {"reputation": 53, "user_id": 6753556, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cXY6_OYOjZ0/AAAAAAAAAAI/AAAAAAAAARk/ica6U2uV0cI/photo.jpg?sz=128", "display_name": "Anton Rybakov", "link": "https://stackoverflow.com/users/6753556/anton-rybakov"}, "reply_to_user": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1553789838, "post_id": 55383061, "comment_id": 97525294, "body": "@Max I didn&#39;t get it. I don&#39;t want to break Liskov substitution principle for instances of A and B classes, I am only trying to modify behaviour of relation between singleton class of class B and singleton class of class A which is super for the first one. I agree that the best way to do it is to use composition rather than inheritance. I was interested in other possible solutions because I am newbie in the Ruby world."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1553790069, "post_id": 55383061, "comment_id": 97525423, "body": "&quot;I cannot find a good way to encapsulate this functionality from descendants.&quot; If you want to be able to call <code>A.registered</code> but not <code>B.registered</code>, then you <i>cannot</i> have <code>class B &lt; A</code> because of LSP. You must <i>always</i> be able to put <code>B</code> wherever you have an <code>A</code>. Ruby&#39;s object model is specifically designed to support this."}], "tags": [], "owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "is_accepted": false, "score": 2, "last_activity_date": 1553707050, "creation_date": 1553707050, "answer_id": 55383061, "question_id": 55381868, "link": "https://stackoverflow.com/questions/55381868/what-is-the-correct-way-to-encapsulate-factory-methods-from-derived-classes-when/55383061#55383061", "title": "What is the correct way to encapsulate factory methods from derived classes when implementing factory in base class?", "body": "<blockquote>\n  <p>Maybe it is possible to do something via .inherited and .undef_method, isn't it?</p>\n</blockquote>\n\n<p>Yes, it is possible. But the idea smells, as for me - you're going to break substitutability.</p>\n\n<p>If you don't want the \"derived\" classes to inherit the behavior of the parent, why do you use inheritance at all? Try composition instead and mix in only the behavior you need. For example, something like this could work (<em>very</em> dirty example, but I hope you got the idea):</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class A\n  module Registry\n    def register_as(name)\n      A.register_as(name, self)\n    end\n  end\n\n  @registered = {}\n\n  def self.register_as(name, klass)\n    @registered[name] = klass\n  end\n\n  def self.known\n    @registered\n  end\nend\n\nclass B\n  extend A::Registry\n  register_as :b  \nend\n\nclass C\n  extend A::Registry\n  register_as :c\nend\n\nA.known # =&gt; {:b =&gt; B, :c =&gt; C}\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 6753556, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cXY6_OYOjZ0/AAAAAAAAAAI/AAAAAAAAARk/ica6U2uV0cI/photo.jpg?sz=128", "display_name": "Anton Rybakov", "link": "https://stackoverflow.com/users/6753556/anton-rybakov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553707050, "creation_date": 1553703240, "question_id": 55381868, "link": "https://stackoverflow.com/questions/55381868/what-is-the-correct-way-to-encapsulate-factory-methods-from-derived-classes-when", "title": "What is the correct way to encapsulate factory methods from derived classes when implementing factory in base class?", "body": "<p>I am trying to create simple class with ability to register derived classes for creation from base class. However I cannot find a good way to encapsulate this functionality from descendants.</p>\n\n<p>Class variables looks for me a bad idea because they available everywhere in inheritance chain. So I try do something with class instance variables. Perfectly it will be that all class methods will be inaccessible except register_as</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class A\n  @registered = {}\n  class &lt;&lt; self\n    def register_as(name)\n      A.registered[name] = self\n    end\n\n    def known\n      A.registered\n    end\n\n    protected\n    attr_accessor :registered\n  end\n\n  def helpful_method\n  end\n\nend\n\nclass B &lt; A\n  class &lt;&lt; self\n    def reg_trash\n      A.registered[:trash] = :trash\n    end\n  end\n  B.register_as :b\nend\n\nB.reg_trash\np A.known\n</code></pre>\n\n<p>However registered is still accessible from B class.\nCurrently looks like the only one possible option is to split A class to dedicated Factory class and A class will hold only helpful instance methods.\nMaybe it is possible to do something via .inherited and .undef_method, isn't it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11235085, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_lP6kUwq-5Q/AAAAAAAAAAI/AAAAAAAAB-M/wGzoEmmAo2M/photo.jpg?sz=128", "display_name": "Adegbite kelvin", "link": "https://stackoverflow.com/users/11235085/adegbite-kelvin"}, "edited": false, "score": 0, "creation_date": 1553704654, "post_id": 55381719, "comment_id": 97486699, "body": "Worked like charm. I have one more question concerning this notification, do you think I should create a new question for it? @SteveTurczyn or is there a way to ask you personally?"}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 33, "user_id": 11235085, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_lP6kUwq-5Q/AAAAAAAAAAI/AAAAAAAAB-M/wGzoEmmAo2M/photo.jpg?sz=128", "display_name": "Adegbite kelvin", "link": "https://stackoverflow.com/users/11235085/adegbite-kelvin"}, "edited": false, "score": 0, "creation_date": 1553705822, "post_id": 55381719, "comment_id": 97487368, "body": "Better to ask a question as that way others can benefit."}], "tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1553702758, "creation_date": 1553702758, "answer_id": 55381719, "question_id": 55381056, "link": "https://stackoverflow.com/questions/55381056/how-to-create-notification-for-followers-with-notifications-gem/55381719#55381719", "title": "How to create notification for followers with &quot;Notifications gem&quot;", "body": "<p>I'm not sure you can do bulk insert in this case as I undertand the Notification gem needs each notification to be for a single user?  Maybe do this...</p>\n\n<pre><code>def create_notifications\n   self.user.followers.each do |follower|\n     Notification.create(notify_type: 'chapter', actor: self.book.user,\n                         user: follower, target: self, second_target: self.book)\n\n   end\nend\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11235085, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_lP6kUwq-5Q/AAAAAAAAAAI/AAAAAAAAB-M/wGzoEmmAo2M/photo.jpg?sz=128", "display_name": "Adegbite kelvin", "link": "https://stackoverflow.com/users/11235085/adegbite-kelvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "accepted_answer_id": 55381719, "answer_count": 1, "score": 0, "last_activity_date": 1553703189, "creation_date": 1553700889, "last_edit_date": 1553703189, "question_id": 55381056, "link": "https://stackoverflow.com/questions/55381056/how-to-create-notification-for-followers-with-notifications-gem", "title": "How to create notification for followers with &quot;Notifications gem&quot;", "body": "<p>I'm trying to setup notifications for the followers of a particular user so that whenever the user they're following posts a chapter, all the user's followers will get notified. I'm using <a href=\"https://github.com/rails-engine/notifications\" rel=\"nofollow noreferrer\">https://github.com/rails-engine/notifications</a>.</p>\n\n<p>I've implemented following relationships which is working well on my app from this tutorial <a href=\"https://www.devwalks.com/lets-build-instagram-with-ruby-on-rails-part-6-follow-all-the-people/\" rel=\"nofollow noreferrer\">https://www.devwalks.com/lets-build-instagram-with-ruby-on-rails-part-6-follow-all-the-people/</a></p>\n\n<p>This is what I've done so far with the codes</p>\n\n<p>user.rb</p>\n\n<pre><code>  has_many :books, dependent: :destroy\n  has_many :chapters, dependent: :destroy\n  has_many :reviews, dependent: :destroy\n  has_many :genres\n  has_many :ratings\n</code></pre>\n\n<p>chapter.rb</p>\n\n<pre><code>belongs_to :book\nbelongs_to :user\n\nafter_commit :create_notifications, on: :create\n\nprivate\n\ndef create_notifications\n   Notification.create do |notification|\n      notification.notify_type = 'chapter'\n      notification.actor = self.book.user\n      notification.user = self.user.followers\n      notification.target = self\n      notification.second_target = self.book\n    end\nend\n</code></pre>\n\n<p>views/notifications/_chapter.html.erb</p>\n\n<pre><code>&lt;div class=''&gt;\n  &lt;%= link_to notification.actor.username, main_app.profile_path(notification.actor.username) %&gt; published a new chapter to \n  &lt;%= link_to notification.second_target.title, main_app.book_path(notification.second_target) %&gt;\n&lt;/div&gt;\n\n&lt;div class=''&gt;\n  &lt;% unless notification.target.blank? %&gt;\n    &lt;%= link_to notification.target.title, main_app.book_chapter_path(notification.second_target, notification.target.id) %&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>book.rb</p>\n\n<pre><code>belongs_to :user\nhas_many :chapters, dependent: :destroy\n</code></pre>\n\n<p>When i targeted the notifications to myself, I was notified correctly but when I did those above i got the error:</p>\n\n<pre><code>User(#58266780) expected, got #&lt;ActiveRecord::Associations::CollectionProxy [#&lt;User id: 3, name: \"Otunba Olusaga of Saganation\", username: \"saga\", email: \"officialklashe@gmail.com\", created_at: \"2019-03-26 11:59:16\", updated_at: \"2019-03-27 09:13:58\", admin: false, bio: \"\"&gt;]&gt; which is an instance of User::ActiveRecord_Associations_CollectionProxy(#58325780)\n</code></pre>\n\n<p>More research shows that I have to \"map the followers (Or use a batch insert tool) to insert multiple notifications\" which I don't know how to do.</p>\n\n<p>Explanation with example codes related to this will be so helpful, thanks!</p>\n"}, {"tags": ["ruby", "activerecord", "command-line-interface"], "comments": [{"owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 1, "creation_date": 1553700433, "post_id": 55380762, "comment_id": 97483983, "body": "Can you include the code where these methods are called?"}, {"owner": {"reputation": 9, "user_id": 11267189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dm8DuXLkNzY/AAAAAAAAAAI/AAAAAAAAAAU/8lZSqRSRVnI/photo.jpg?sz=128", "display_name": "Jerry Vel&#225;zquez", "link": "https://stackoverflow.com/users/11267189/jerry-vel%c3%a1zquez"}, "reply_to_user": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 0, "creation_date": 1553706859, "post_id": 55380762, "comment_id": 97487919, "body": "yes, the methods are being called in a run.rb file (calling: greet, then user, etc.)that requires the environment, and the environment requires all files in a lib dir"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1553708080, "post_id": 55380762, "comment_id": 97488555, "body": "can you show the run.rb please?"}, {"owner": {"reputation": 9, "user_id": 11267189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dm8DuXLkNzY/AAAAAAAAAAI/AAAAAAAAAAU/8lZSqRSRVnI/photo.jpg?sz=128", "display_name": "Jerry Vel&#225;zquez", "link": "https://stackoverflow.com/users/11267189/jerry-vel%c3%a1zquez"}, "edited": false, "score": 0, "creation_date": 1553718819, "post_id": 55380762, "comment_id": 97493817, "body": "<code>endP = true greet user while endP venue_selection endP = book end     </code>"}, {"owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 0, "creation_date": 1553721819, "post_id": 55380762, "comment_id": 97495268, "body": "Place your run.rb code in the question itself, please.  Your question should be self-contained, and include everything needed for others to reproduce your problem."}], "answers": [{"tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": false, "score": 1, "last_activity_date": 1553757646, "creation_date": 1553757646, "answer_id": 55392097, "question_id": 55380762, "link": "https://stackoverflow.com/questions/55380762/how-do-i-get-a-my-cli-app-to-move-on-to-the-next-method/55392097#55392097", "title": "how do I get a my cli app to move on to the next method?", "body": "<p>Because in your <code>user</code> method you call the <code>user</code> method again.</p>\n\n<pre><code>def user   # &lt;--- user\n  name = $prompt.ask('What is your name?', default: \"artist_name\")\n  system \"clear\"\n  puts \"Welcome #{user}!\"  # &lt;--- calls user\nend\n</code></pre>\n\n<p>This causes an infinite loop.</p>\n\n<p>You probably meant to use:</p>\n\n<pre><code>  puts \"Welcome #{name}!\"\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11267189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dm8DuXLkNzY/AAAAAAAAAAI/AAAAAAAAAAU/8lZSqRSRVnI/photo.jpg?sz=128", "display_name": "Jerry Vel&#225;zquez", "link": "https://stackoverflow.com/users/11267189/jerry-vel%c3%a1zquez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1553757646, "creation_date": 1553700019, "question_id": 55380762, "link": "https://stackoverflow.com/questions/55380762/how-do-i-get-a-my-cli-app-to-move-on-to-the-next-method", "title": "how do I get a my cli app to move on to the next method?", "body": "<p>(using tty-prompt) I've tried making individual methods so that my app can run smoothly however I only managed to break my code or set it into a infinite prompt..I've been stuck trying to set up activerecord CRUD </p>\n\n<p>I made new method for each prompt</p>\n\n<pre><code>def greet\n  $prompt = TTY::Prompt.new\n  system \"clear\"\n\n  puts 'Welcome to gig_finder, the best resource for finding your next gig!'\nend\n\ndef user\n  name = $prompt.ask('What is your name?', default: \"artist_name\")\n  system \"clear\"\n  puts \"Welcome #{user}!\"\nend\n</code></pre>\n\n<p>the output would continue to ask for a name, until you force quit</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "user-accounts", "clearance"], "answers": [{"comments": [{"owner": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "edited": false, "score": 0, "creation_date": 1553792963, "post_id": 55381977, "comment_id": 97527109, "body": "Thanks. This seems like the right approach and is definitely pointing me in the right direction. Still having trouble getting the form to work. I noticed &#39;user_from_params` in the Clearance User controller, but where should <code>account_from_params</code> be coming from? Is this some rails magic? Do I need to add an account_id hidden field to the form?"}, {"owner": {"reputation": 1261, "user_id": 8844929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0b2684f65b25d110b6b2408fc7ebb0?s=128&d=identicon&r=PG", "display_name": "Veridian Dynamics", "link": "https://stackoverflow.com/users/8844929/veridian-dynamics"}, "reply_to_user": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "edited": false, "score": 0, "creation_date": 1553793174, "post_id": 55381977, "comment_id": 97527225, "body": "Eh, I&#39;m not super familiar with Clearance, but you don&#39;t need to use their syntax. You should just pass any necessary params to the controller and grab it Rails-style. Either <code>@account = Account.find(params[:account_id])</code> from a hidden_field like you said or (if it&#39;s also created) <code>@account = Account.new(account_params)</code> where you need to define a private <code>account_params</code> method that gets the account details from the params."}, {"owner": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "edited": false, "score": 0, "creation_date": 1553804258, "post_id": 55381977, "comment_id": 97532998, "body": "So one way to do this would be to add the &quot;Name&quot; field to the user sign up form as a nested attributes, but because my Account model <code>has_many :users</code> and my User model <code>has_many :users</code> and <code>accepts_nested_attributes_for :users</code>, but that form is not working either. Is this totally the wrong approach? Is there a way to do the opposite of this in a rails form? I need Users to belong to the account so that it leaves the option for multiple users to be a part of the same account as a part of a team that can access the account."}, {"owner": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "edited": false, "score": 0, "creation_date": 1553804359, "post_id": 55381977, "comment_id": 97533054, "body": "Here&#39;s what I&#39;m trying to do with my accounts/new form <a href=\"https://gist.github.com/leemcalilly/83a9ff2248c35b3e7c498466bb2829e7\" rel=\"nofollow noreferrer\">gist.github.com/leemcalilly/83a9ff2248c35b3e7c498466bb2829e7</a>"}], "tags": [], "owner": {"reputation": 1261, "user_id": 8844929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0b2684f65b25d110b6b2408fc7ebb0?s=128&d=identicon&r=PG", "display_name": "Veridian Dynamics", "link": "https://stackoverflow.com/users/8844929/veridian-dynamics"}, "is_accepted": true, "score": 1, "last_activity_date": 1553703563, "creation_date": 1553703563, "answer_id": 55381977, "question_id": 55380556, "link": "https://stackoverflow.com/questions/55380556/how-to-create-an-account-when-and-assign-it-to-a-user-when-signing-up-via-cleara/55381977#55381977", "title": "How to create an account when and assign it to a User when signing up via Clearance in rails", "body": "<p>I would hook into their controllers to keep things \"in the gem\" so to speak. <a href=\"https://github.com/thoughtbot/clearance#controllers\" rel=\"nofollow noreferrer\">This is how it works</a>. Looks like you would hook into the controllers by overriding them like this:</p>\n\n<pre><code>class UsersController &lt; Clearance::UsersController\n\n  def create\n    @user = user_from_params\n    @account = account_from_params\n    @user.account = @account\n\n    if @user.save\n      sign_in @user\n      redirect_back_or url_after_create\n    else\n      render template: \"users/new\"\n    end\n  end\n\nend\n</code></pre>\n\n<p>Don't forget to update the routes and point them to this controller action. Now, you're sort of unhooking your controller <code>create</code> action from Clearance, but you're doing it in a \"Clearance way\" which seems most appropriate. </p>\n"}], "owner": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 55381977, "answer_count": 1, "score": 0, "last_activity_date": 1553792716, "creation_date": 1553699418, "last_edit_date": 1553792716, "question_id": 55380556, "link": "https://stackoverflow.com/questions/55380556/how-to-create-an-account-when-and-assign-it-to-a-user-when-signing-up-via-cleara", "title": "How to create an account when and assign it to a User when signing up via Clearance in rails", "body": "<p>What is the best way with Clearance to automatically create a an \"Account\" with a unique account_id (doesn't have to be UUID) and assign it to the new user on sign up?</p>\n\n<p>I need to extend the clearance User sign up form and User controller to handle this but I'm having trouble getting this to work.</p>\n\n<p>Should this be a before_filter on signup or part of the User create action?</p>\n\n<hr>\n\n<p>Update: Adding some code for reference...</p>\n\n<pre><code># app/controllers/users_controller.rb\nclass UsersController &lt; Clearance::UsersController\n\n  def create\n    @user = user_from_params\n    @account = account_from_params\n    @user.account = @account\n\n    if @user.save\n      sign_in @user\n      redirect_back_or url_after_create\n    else\n      render template: \"users/new\"\n    end\n  end\n\nend\n\nclass AccountController &lt; ApplicationController\n\n  def create\n    @account = Account.new(account_params)\n  end\n\n  private\n\n  def account_params\n    params[:account].permit(:id)\n  end\n\nend\n\n&lt;fieldset&gt;\n  &lt;%= form.label :email %&gt;\n  &lt;%= form.text_field :email, type: 'email' %&gt;\n&lt;/fieldset&gt;\n\n&lt;fieldset&gt;\n  &lt;%= form.label :password %&gt;\n  &lt;%= form.password_field :password %&gt;\n&lt;/fieldset&gt;\n\n\n# Users &amp; Clearance routes\n  resources :passwords, controller: 'clearance/passwords', only: [:create, :new]\n  resource :session, controller: 'clearance/sessions', only: [:create]\n\n  resources :users, controller: 'clearance/users', only: [:create] do\n    resource :password,\n      controller: 'clearance/passwords',\n      only: [:create, :edit, :update]\n  end\n  get '/login' =&gt; 'clearance/sessions#new', as: 'sign_in'\n  delete '/logout' =&gt; 'clearance/sessions#destroy', as: 'sign_out'\n  get '/signup' =&gt; 'clearance/users#new', as: 'sign_up'\n  get '/users' =&gt; 'users#index'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1553707068, "post_id": 55380428, "comment_id": 97488030, "body": "That does not look like a valid literal expression of any object, at least. What kind of object is it?"}], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 0, "last_activity_date": 1553699276, "creation_date": 1553699276, "answer_id": 55380495, "question_id": 55380428, "link": "https://stackoverflow.com/questions/55380428/deleting-an-element-from-an-array-in-an-active-record/55380495#55380495", "title": "Deleting an element from an array in an active record", "body": "<p>Have you tried anything like</p>\n\n<pre><code>new_channles = tv_info.channels.select { |c| c != :b }\ntv_info.update(channels: new_channels)\n</code></pre>\n\n<p>?</p>\n"}, {"tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": false, "score": 0, "last_activity_date": 1553699290, "creation_date": 1553699290, "answer_id": 55380499, "question_id": 55380428, "link": "https://stackoverflow.com/questions/55380428/deleting-an-element-from-an-array-in-an-active-record/55380499#55380499", "title": "Deleting an element from an array in an active record", "body": "<p>Just access the array stored under channels directly:</p>\n\n<pre><code>tv_info.tap { |hash| hash[:channels].delete(:b) }\n</code></pre>\n\n<p>This uses :</p>\n\n<ul>\n<li><a href=\"https://apidock.com/ruby/Object/tap\" rel=\"nofollow noreferrer\"><code>tap</code></a> to ensure the entire modified hash is returned</li>\n<li><a href=\"https://ruby-doc.org/core-2.5.0/Array.html#method-i-delete\" rel=\"nofollow noreferrer\"><code>delete</code></a> to remove the matching elements from the array.</li>\n</ul>\n\n<p>Hope that helps, let me know if you have any questions or issues.</p>\n"}, {"comments": [{"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1553700169, "post_id": 55380667, "comment_id": 97483806, "body": "Isn&#39;t that exactly the same as in my answer?"}], "tags": [], "owner": {"reputation": 104, "user_id": 4381022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e930fc1b15c96917acf14b6df8d9c981?s=128&d=identicon&r=PG&f=1", "display_name": "Tuan Tran", "link": "https://stackoverflow.com/users/4381022/tuan-tran"}, "is_accepted": true, "score": 0, "last_activity_date": 1553699719, "creation_date": 1553699719, "answer_id": 55380667, "question_id": 55380428, "link": "https://stackoverflow.com/questions/55380428/deleting-an-element-from-an-array-in-an-active-record/55380667#55380667", "title": "Deleting an element from an array in an active record", "body": "<p>You can remove <code>:b</code> by using:</p>\n\n<pre><code>tv_info[:channels].delete(:b)\n</code></pre>\n\n<p>Hope it helps :D </p>\n"}], "owner": {"reputation": 95, "user_id": 7685722, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/791cbf6af02ecfe051dd1a9b0c39fa7c?s=128&d=identicon&r=PG&f=1", "display_name": "C. Yee", "link": "https://stackoverflow.com/users/7685722/c-yee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 55380667, "answer_count": 3, "score": 0, "last_activity_date": 1553699719, "creation_date": 1553699058, "last_edit_date": 1553699427, "question_id": 55380428, "link": "https://stackoverflow.com/questions/55380428/deleting-an-element-from-an-array-in-an-active-record", "title": "Deleting an element from an array in an active record", "body": "<p>I have an object that looks like this</p>\n\n<pre><code>tv_info _id: 237827483784783, channels: [:a, :b, :c]\n</code></pre>\n\n<p>How would I delete just <code>:b</code> from channels so it would look like</p>\n\n<pre><code>tv_info _id: 237827483784783, channels: [:a, :c]\n</code></pre>\n\n<p>I've only found an update method but no delete method. For \nexample</p>\n\n<pre><code>tv_info.update(channels: :a)\n</code></pre>\n\n<p>Would change it to </p>\n\n<pre><code>tv_info _id: 237827483784783, channels: [:a]\n</code></pre>\n\n<p>but i need to keep the <code>:c</code></p>\n\n<p>I'm looking for something like</p>\n\n<pre><code>tv_info.delete(channels: :b)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "comments": [{"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1553696084, "post_id": 55379122, "comment_id": 97480879, "body": "<code>If: :devise_controller?</code> should be <code>if: :devise_controller?</code>, with small i in if"}, {"owner": {"reputation": 27, "user_id": 9232115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/213557746e39a9f9240bd7d9bc624e42?s=128&d=identicon&r=PG&f=1", "display_name": "bottles", "link": "https://stackoverflow.com/users/9232115/bottles"}, "reply_to_user": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1553696657, "post_id": 55379122, "comment_id": 97481255, "body": "@Vasilisa  hahaaahaa!  worked. thanks very much"}], "answers": [{"comments": [{"owner": {"reputation": 8957, "user_id": 3345375, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TbVFk.png?s=128&g=1", "display_name": "jkdev", "link": "https://stackoverflow.com/users/3345375/jkdev"}, "edited": false, "score": 0, "creation_date": 1553748385, "post_id": 55385396, "comment_id": 97501801, "body": "This answer was auto-flagged because it&#39;s short. But it&#39;s still an answer, not a link or a comment."}], "tags": [], "owner": {"reputation": 75, "user_id": 4909131, "user_type": "registered", "profile_image": "https://graph.facebook.com/813417048752638/picture?type=large", "display_name": "Srinidhi Gs", "link": "https://stackoverflow.com/users/4909131/srinidhi-gs"}, "is_accepted": true, "score": 0, "last_activity_date": 1553716213, "creation_date": 1553716213, "answer_id": 55385396, "question_id": 55379122, "link": "https://stackoverflow.com/questions/55379122/undefined-local-variable-or-method-resource-class-for-postscontroller0xd034/55385396#55385396", "title": "undefined local variable or method `resource_class&#39; for #&lt;PostsController:0xd034f28&gt;", "body": "<p>Try </p>\n\n<p><code>before_action :configure_permitted_parameters, if: :devise_controller?</code></p>\n"}], "owner": {"reputation": 27, "user_id": 9232115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/213557746e39a9f9240bd7d9bc624e42?s=128&d=identicon&r=PG&f=1", "display_name": "bottles", "link": "https://stackoverflow.com/users/9232115/bottles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 1, "accepted_answer_id": 55385396, "answer_count": 1, "score": -2, "last_activity_date": 1553716213, "creation_date": 1553695322, "last_edit_date": 1553696050, "question_id": 55379122, "link": "https://stackoverflow.com/questions/55379122/undefined-local-variable-or-method-resource-class-for-postscontroller0xd034", "title": "undefined local variable or method `resource_class&#39; for #&lt;PostsController:0xd034f28&gt;", "body": "<p>ruby 2.3.3 &amp; rails 5.2</p>\n\n<p>I am getting this error </p>\n\n<blockquote>\n  <p>undefined local variable or method `resource_class' for # PostsController:0xd034f28></p>\n</blockquote>\n\n<p>Please here is my application controller</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  protect_from_forgery with: :exception\n\n  before_action :configure_permitted_parameters, If: :devise_controller?\n\n  protected\n\n  def configure_permitted_parameters\n    devise_parameter_sanitizer.permit(:sign_up, keys: [:name])\n    devise_parameter_sanitizer.permit(:account_update, keys: [:name])\n  end     \nend\n\n</code></pre>\n\n<p>my post controller</p>\n\n<pre><code>class PostsController &lt; ApplicationController\n    before_action :find_post, only: [:show, :edit, :update, :destroy]\n    before_action :authenticate_user!, except: [:index, :show]\n\n    def index\n        @posts = Post.all.order(\"created_at DESC\")\n    end\n\n    def show\n    end\n\n    def new\n        @post = current_user.posts.build\n    end\n\n    def create\n        @post = current_user.posts.build(post_params)\n        if @post.save\n            redirect_to @post\n        else\n            render 'new'\n        end\n    end\n\n    def edit        \n    end\n\n    def update\n        if @post.update(post_params)\n            redirect_to @post\n        else\n            render 'edit'\n        end\n    end\n\n    def destroy\n        @post.destroy\n        redirect_to root_path\n    end\n\n    private\n\n    def find_post\n        @post = Post.find(params[:id])\n    end\n\n    def post_params\n        params.require(:post).permit(:title, :link, :description)\n    end\nend\n</code></pre>\n"}, {"tags": ["html", "css", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2240, "user_id": 1283672, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1d117285730208a0e6618176cf940131?s=128&d=identicon&r=PG&f=1", "display_name": "fedesc", "link": "https://stackoverflow.com/users/1283672/fedesc"}, "edited": false, "score": 0, "creation_date": 1553697951, "post_id": 55379018, "comment_id": 97482171, "body": "are you requiring it inside manifest? like this? <code>&#47;&#47;= require &lt;path to file&gt;</code> ? and why is it in <code>project&#47;public</code> and not in assets/vendor folder as intended?"}, {"owner": {"reputation": 9, "user_id": 11261021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2253ad6092f68fcf23dff55184c4bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "Rima", "link": "https://stackoverflow.com/users/11261021/rima"}, "reply_to_user": {"reputation": 2240, "user_id": 1283672, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1d117285730208a0e6618176cf940131?s=128&d=identicon&r=PG&f=1", "display_name": "fedesc", "link": "https://stackoverflow.com/users/1283672/fedesc"}, "edited": false, "score": 0, "creation_date": 1553698065, "post_id": 55379018, "comment_id": 97482257, "body": "no I&#39;m not adding it, there&#39;s no vendor folder in assets"}], "answers": [{"tags": [], "owner": {"reputation": 761, "user_id": 4299353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31f90473299f58264f0744371b4fe444?s=128&d=identicon&r=PG&f=1", "display_name": "mmsilviu", "link": "https://stackoverflow.com/users/4299353/mmsilviu"}, "is_accepted": false, "score": 0, "last_activity_date": 1553722192, "last_edit_date": 1553722192, "creation_date": 1553698103, "answer_id": 55380116, "question_id": 55379018, "link": "https://stackoverflow.com/questions/55379018/css-stylesheet-not-working-using-ruby-on-rails-sprocketsrailshelperassetn/55380116#55380116", "title": "CSS Stylesheet not working using Ruby on Rails: Sprockets::Rails::Helper::AssetNotFound Error", "body": "<p>You can check more about assets in the <a href=\"https://guides.rubyonrails.org/asset_pipeline.html#asset-organization\" rel=\"nofollow noreferrer\">guidelines</a></p>\n\n<p>Basically, Rails is searching for the assets, inside an application in one of three locations: <strong><em>app/assets</em></strong>, <strong><em>lib/assets</em></strong> or <strong><em>vendor/assets</em></strong>. You have to put the .css file in one of these locations.</p>\n\n<pre><code>app/assets is for assets that are owned by the application, such as custom images, JavaScript files or stylesheets.\n\nlib/assets is for your own libraries' code that doesn't really fit into the scope of the application or those libraries which are shared across applications.\n\nvendor/assets is for assets that are owned by outside entities, such as code for JavaScript plugins and CSS frameworks. Keep in mind that third party code with references to other files also processed by the asset Pipeline (images, stylesheets, etc.), will need to be rewritten to use helpers like asset_path.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2240, "user_id": 1283672, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/1d117285730208a0e6618176cf940131?s=128&d=identicon&r=PG&f=1", "display_name": "fedesc", "link": "https://stackoverflow.com/users/1283672/fedesc"}, "is_accepted": false, "score": 0, "last_activity_date": 1553701581, "last_edit_date": 1592644375, "creation_date": 1553698223, "answer_id": 55380166, "question_id": 55379018, "link": "https://stackoverflow.com/questions/55379018/css-stylesheet-not-working-using-ruby-on-rails-sprocketsrailshelperassetn/55380166#55380166", "title": "CSS Stylesheet not working using Ruby on Rails: Sprockets::Rails::Helper::AssetNotFound Error", "body": "<blockquote>\n<p>The asset <strong>&quot;style.css&quot;</strong> is not present in the asset pipeline.</p>\n</blockquote>\n<p>This message means you haven't included your file in corresponding folder to interact with assets pipeline (/project/public).</p>\n<p>In order to work with assets pipeline you have to follow a few rules:</p>\n<h3>first:</h3>\n<p>Put it in inteded folder (vendor or assets or lib) this are three different folders in your project folder that assets pipeline is designed to search for files declared in manifest or called individualy with <code>stylesheet_link_tag</code>.</p>\n<h3>then:</h3>\n<p>Call it with <code>stylesheet_link_tag</code>.</p>\n<p>Read more about assets pipeline search-path <a href=\"https://guides.rubyonrails.org/asset_pipeline.html#search-paths\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/asset_pipeline.html#search-paths</a></p>\n<h3>side note:</h3>\n<p>you could also use the application manifest which rails provides <code>assets/application.css</code> and <code>assets/application.js</code> and call it in your html instead of calling each file seperatly .. which is kind of the intention of assets pipeline.</p>\n<p>as written:</p>\n<blockquote>\n<p>The asset pipeline provides a framework to concatenate and minify or compress JavaScript and CSS assets. It also adds the ability to write these assets in other languages and pre-processors such as CoffeeScript, Sass and ERB. It allows assets in your application to be automatically combined with assets from other gems.</p>\n</blockquote>\n<p>you are missing all this builtin goods when not declaring you files in manifest.</p>\n<p>more read <a href=\"https://guides.rubyonrails.org/asset_pipeline.html#manifest-files-and-directives\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/asset_pipeline.html#manifest-files-and-directives</a></p>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 11261021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2253ad6092f68fcf23dff55184c4bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "Rima", "link": "https://stackoverflow.com/users/11261021/rima"}, "is_accepted": true, "score": -1, "last_activity_date": 1553772449, "creation_date": 1553772449, "answer_id": 55396454, "question_id": 55379018, "link": "https://stackoverflow.com/questions/55379018/css-stylesheet-not-working-using-ruby-on-rails-sprocketsrailshelperassetn/55396454#55396454", "title": "CSS Stylesheet not working using Ruby on Rails: Sprockets::Rails::Helper::AssetNotFound Error", "body": "<p>What worked:</p>\n\n<ol>\n<li><p>I copied the contents of style.css and saved them as style.css.scss</p></li>\n<li><p>I saved the new file in /project/app/assets/stylesheets</p></li>\n</ol>\n"}], "owner": {"reputation": 9, "user_id": 11261021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2253ad6092f68fcf23dff55184c4bd3e?s=128&d=identicon&r=PG&f=1", "display_name": "Rima", "link": "https://stackoverflow.com/users/11261021/rima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "accepted_answer_id": 55396454, "answer_count": 3, "score": 1, "last_activity_date": 1553772449, "creation_date": 1553695050, "last_edit_date": 1553697713, "question_id": 55379018, "link": "https://stackoverflow.com/questions/55379018/css-stylesheet-not-working-using-ruby-on-rails-sprocketsrailshelperassetn", "title": "CSS Stylesheet not working using Ruby on Rails: Sprockets::Rails::Helper::AssetNotFound Error", "body": "<p>I'm trying to add a CSS file to my rails project. I created a file called style.css and placed it in /project/public.\nIn my view file (index.html.erb) I added the following line of code:</p>\n\n<pre><code>&lt;%= stylesheet_link_tag \"style\" %&gt;\n</code></pre>\n\n<p>When I run rails server I get the following error:</p>\n\n<pre><code>    Sprockets::Rails::Helper::AssetNotFound in Articles#index\n    Showing /mnt/c/code/blog/app/views/articles/index.html where line #34 \n\nraised:\n\nThe asset **\"style.css\"** is not present in the asset pipeline.\n</code></pre>\n\n<p>How can I fix this issue?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "docker", "bundler", "nokogiri"], "comments": [{"owner": {"reputation": 508, "user_id": 1456632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/02fc6122a874f789acf51d970ffee608?s=128&d=identicon&r=PG", "display_name": "user1456632", "link": "https://stackoverflow.com/users/1456632/user1456632"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1553691379, "post_id": 55377476, "comment_id": 97477534, "body": "I have, yes. It didn&#39;t change anything. It generated the same lockfile, with the same versions."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1553692123, "post_id": 55377476, "comment_id": 97478079, "body": "It is very strange that this fails since <code>1.10.2</code> meets the specification of <code>&quot;~&gt; 1.8&quot;</code>"}, {"owner": {"reputation": 508, "user_id": 1456632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/02fc6122a874f789acf51d970ffee608?s=128&d=identicon&r=PG", "display_name": "user1456632", "link": "https://stackoverflow.com/users/1456632/user1456632"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1553692566, "post_id": 55377476, "comment_id": 97478406, "body": "I removed the lockfile completely, to let it regenerate from inside the docker container. and am now getting a new error, see the update to my post"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1553692880, "post_id": 55377476, "comment_id": 97478647, "body": "That is something completely different and I have no knowledge of <code>bootsnap</code>. If this question is resolved I would recommend posting a new one with that issue. Also probably deleting this one as I am not sure how much it serves at this point."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1554008950, "post_id": 55377476, "comment_id": 97593128, "body": "BTW ran into this exact issue same version and everything. Ensure your deployment script is also running bundle install. I had the bundler tasks commented our in my Capfile"}], "owner": {"reputation": 508, "user_id": 1456632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/02fc6122a874f789acf51d970ffee608?s=128&d=identicon&r=PG", "display_name": "user1456632", "link": "https://stackoverflow.com/users/1456632/user1456632"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 418, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1581291262, "creation_date": 1553690522, "last_edit_date": 1581291262, "question_id": 55377476, "link": "https://stackoverflow.com/questions/55377476/bundler-runs-from-windows-fails-in-docker-image-bundler-could-not-find-compati", "title": "Bundler runs from windows, fails in docker image: Bundler could not find compatible versions for gem &quot;nokogiri&quot;", "body": "<p>Update: Removed the lockfile so it could regenerate from inside the docker container, and now I get this error when starting instead:</p>\n\n<pre><code>/usr/local/bundle/gems/bootsnap-1.4.2/lib/bootsnap/compile_cache/iseq.rb:37:in `fetch': Resource temporarily unavailable - bs_fetch:atomic_write_cache_file:rename (Errno::EAGAIN)\n</code></pre>\n\n<p>I am trying to get a rails app running as a docker image, and I am getting an error concerning the nokogiri version. bundle update doesn't change anything, and uninstalling the nokogiri gem doesn't either.</p>\n\n<p>Here is the error message I am getting from the docker image:</p>\n\n<pre><code>service_1  | Bundler::VersionConflict: Bundler could not find compatible versions for gem \"nokogiri\":\nservice_1  |   In snapshot (Gemfile.lock):\nservice_1  |     nokogiri (= 1.10.2)\nservice_1  |\nservice_1  |   In Gemfile:\nservice_1  |     capybara (&gt;= 2.15) was resolved to 3.15.0, which depends on\nservice_1  |       nokogiri (~&gt; 1.8)\n</code></pre>\n\n<p>Remove <code>nokogiri (1.10.2-x64-mingw32)</code> from the lockfile results in different errors.</p>\n\n<p>Here is my Gemfile:</p>\n\n<pre><code>source 'https://rubygems.org'\ngit_source(:github) { |repo| \"https://github.com/#{repo}.git\" }\n\nruby '2.5.3'\n\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\ngem 'rails', '~&gt; 5.2.2', '&gt;= 5.2.2.1'\n# Use mysql as the database for Active Record\ngem 'mysql2', '&gt;= 0.4.4', '&lt; 0.6.0'\n# Use Puma as the app server\ngem 'puma', '~&gt; 3.11'\n# Use SCSS for stylesheets\ngem 'sass-rails', '~&gt; 5.0'\n# Use Uglifier as compressor for JavaScript assets\ngem 'uglifier', '&gt;= 1.3.0'\n# See https://github.com/rails/execjs#readme for more supported runtimes\ngem 'duktape'\n# Use CoffeeScript for .coffee assets and views\ngem 'coffee-rails', '~&gt; 4.2'\n# Turbolinks makes navigating your web application faster. Read more: https://github.com/turbolinks/turbolinks\ngem 'turbolinks', '~&gt; 5'\n# Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder\ngem 'jbuilder', '~&gt; 2.5'\n# Use Redis adapter to run Action Cable in production\n# gem 'redis', '~&gt; 4.0'\n# Use ActiveModel has_secure_password\n# gem 'bcrypt', '~&gt; 3.1.7'\n\n# Use ActiveStorage variant\n# gem 'mini_magick', '~&gt; 4.8'\n\n# Use Capistrano for deployment\n# gem 'capistrano-rails', group: :development\n\n# Reduces boot times through caching; required in config/boot.rb\ngem 'bootsnap', '&gt;= 1.1.0', require: false\n\ngroup :development, :test do\n  # Call 'byebug' anywhere in the code to stop execution and get a debugger console\n  gem 'byebug', platforms: [:mri, :mingw, :x64_mingw]\nend\n\ngroup :development do\n  # Access an interactive console on exception pages or by calling 'console' anywhere in the code.\n  gem 'web-console', '&gt;= 3.3.0'\nend\n\ngroup :test do\n  # Adds support for Capybara system testing and selenium driver\n  gem 'capybara', '&gt;= 2.15'\n  gem 'selenium-webdriver'\n  # Easy installation and use of chromedriver to run system tests with Chrome\n  gem 'chromedriver-helper'\nend\n\n# Windows does not include zoneinfo files, so bundle the tzinfo-data gem\ngem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]\n</code></pre>\n\n<p>And the lockfile:</p>\n\n<pre><code>GEM\n  remote: https://rubygems.org/\n  specs:\n    actioncable (5.2.2.1)\n      actionpack (= 5.2.2.1)\n      nio4r (~&gt; 2.0)\n      websocket-driver (&gt;= 0.6.1)\n    actionmailer (5.2.2.1)\n      actionpack (= 5.2.2.1)\n      actionview (= 5.2.2.1)\n      activejob (= 5.2.2.1)\n      mail (~&gt; 2.5, &gt;= 2.5.4)\n      rails-dom-testing (~&gt; 2.0)\n    actionpack (5.2.2.1)\n      actionview (= 5.2.2.1)\n      activesupport (= 5.2.2.1)\n      rack (~&gt; 2.0)\n      rack-test (&gt;= 0.6.3)\n      rails-dom-testing (~&gt; 2.0)\n      rails-html-sanitizer (~&gt; 1.0, &gt;= 1.0.2)\n    actionview (5.2.2.1)\n      activesupport (= 5.2.2.1)\n      builder (~&gt; 3.1)\n      erubi (~&gt; 1.4)\n      rails-dom-testing (~&gt; 2.0)\n      rails-html-sanitizer (~&gt; 1.0, &gt;= 1.0.3)\n    activejob (5.2.2.1)\n      activesupport (= 5.2.2.1)\n      globalid (&gt;= 0.3.6)\n    activemodel (5.2.2.1)\n      activesupport (= 5.2.2.1)\n    activerecord (5.2.2.1)\n      activemodel (= 5.2.2.1)\n      activesupport (= 5.2.2.1)\n      arel (&gt;= 9.0)\n    activestorage (5.2.2.1)\n      actionpack (= 5.2.2.1)\n      activerecord (= 5.2.2.1)\n      marcel (~&gt; 0.3.1)\n    activesupport (5.2.2.1)\n      concurrent-ruby (~&gt; 1.0, &gt;= 1.0.2)\n      i18n (&gt;= 0.7, &lt; 2)\n      minitest (~&gt; 5.1)\n      tzinfo (~&gt; 1.1)\n    addressable (2.6.0)\n      public_suffix (&gt;= 2.0.2, &lt; 4.0)\n    archive-zip (0.12.0)\n      io-like (~&gt; 0.3.0)\n    arel (9.0.0)\n    bindex (0.5.0)\n    bootsnap (1.4.2)\n      msgpack (~&gt; 1.0)\n    builder (3.2.3)\n    byebug (11.0.1)\n    capybara (3.15.0)\n      addressable\n      mini_mime (&gt;= 0.1.3)\n      nokogiri (~&gt; 1.8)\n      rack (&gt;= 1.6.0)\n      rack-test (&gt;= 0.6.3)\n      regexp_parser (~&gt; 1.2)\n      xpath (~&gt; 3.2)\n    childprocess (0.9.0)\n      ffi (~&gt; 1.0, &gt;= 1.0.11)\n    chromedriver-helper (2.1.1)\n      archive-zip (~&gt; 0.10)\n      nokogiri (~&gt; 1.8)\n    coffee-rails (4.2.2)\n      coffee-script (&gt;= 2.2.0)\n      railties (&gt;= 4.0.0)\n    coffee-script (2.4.1)\n      coffee-script-source\n      execjs\n    coffee-script-source (1.12.2)\n    concurrent-ruby (1.1.5)\n    crass (1.0.4)\n    duktape (2.0.1.0)\n    erubi (1.8.0)\n    execjs (2.7.0)\n    ffi (1.10.0-x64-mingw32)\n    globalid (0.4.2)\n      activesupport (&gt;= 4.2.0)\n    i18n (1.6.0)\n      concurrent-ruby (~&gt; 1.0)\n    io-like (0.3.0)\n    jbuilder (2.8.0)\n      activesupport (&gt;= 4.2.0)\n      multi_json (&gt;= 1.2)\n    loofah (2.2.3)\n      crass (~&gt; 1.0.2)\n      nokogiri (&gt;= 1.5.9)\n    mail (2.7.1)\n      mini_mime (&gt;= 0.1.1)\n    marcel (0.3.3)\n      mimemagic (~&gt; 0.3.2)\n    method_source (0.9.2)\n    mimemagic (0.3.3)\n    mini_mime (1.0.1)\n    mini_portile2 (2.4.0)\n    minitest (5.11.3)\n    msgpack (1.2.9-x64-mingw32)\n    multi_json (1.13.1)\n    mysql2 (0.5.2-x64-mingw32)\n    nio4r (2.3.1)\n    nokogiri (1.10.2-x64-mingw32)\n      mini_portile2 (~&gt; 2.4.0)\n    public_suffix (3.0.3)\n    puma (3.12.1)\n    rack (2.0.6)\n    rack-test (1.1.0)\n      rack (&gt;= 1.0, &lt; 3)\n    rails (5.2.2.1)\n      actioncable (= 5.2.2.1)\n      actionmailer (= 5.2.2.1)\n      actionpack (= 5.2.2.1)\n      actionview (= 5.2.2.1)\n      activejob (= 5.2.2.1)\n      activemodel (= 5.2.2.1)\n      activerecord (= 5.2.2.1)\n      activestorage (= 5.2.2.1)\n      activesupport (= 5.2.2.1)\n      bundler (&gt;= 1.3.0)\n      railties (= 5.2.2.1)\n      sprockets-rails (&gt;= 2.0.0)\n    rails-dom-testing (2.0.3)\n      activesupport (&gt;= 4.2.0)\n      nokogiri (&gt;= 1.6)\n    rails-html-sanitizer (1.0.4)\n      loofah (~&gt; 2.2, &gt;= 2.2.2)\n    railties (5.2.2.1)\n      actionpack (= 5.2.2.1)\n      activesupport (= 5.2.2.1)\n      method_source\n      rake (&gt;= 0.8.7)\n      thor (&gt;= 0.19.0, &lt; 2.0)\n    rake (12.3.2)\n    rb-fsevent (0.10.3)\n    rb-inotify (0.10.0)\n      ffi (~&gt; 1.0)\n    regexp_parser (1.3.0)\n    rubyzip (1.2.2)\n    sass (3.7.3)\n      sass-listen (~&gt; 4.0.0)\n    sass-listen (4.0.0)\n      rb-fsevent (~&gt; 0.9, &gt;= 0.9.4)\n      rb-inotify (~&gt; 0.9, &gt;= 0.9.7)\n    sass-rails (5.0.7)\n      railties (&gt;= 4.0.0, &lt; 6)\n      sass (~&gt; 3.1)\n      sprockets (&gt;= 2.8, &lt; 4.0)\n      sprockets-rails (&gt;= 2.0, &lt; 4.0)\n      tilt (&gt;= 1.1, &lt; 3)\n    selenium-webdriver (3.141.0)\n      childprocess (~&gt; 0.5)\n      rubyzip (~&gt; 1.2, &gt;= 1.2.2)\n    sprockets (3.7.2)\n      concurrent-ruby (~&gt; 1.0)\n      rack (&gt; 1, &lt; 3)\n    sprockets-rails (3.2.1)\n      actionpack (&gt;= 4.0)\n      activesupport (&gt;= 4.0)\n      sprockets (&gt;= 3.0.0)\n    thor (0.20.3)\n    thread_safe (0.3.6)\n    tilt (2.0.9)\n    turbolinks (5.2.0)\n      turbolinks-source (~&gt; 5.2)\n    turbolinks-source (5.2.0)\n    tzinfo (1.2.5)\n      thread_safe (~&gt; 0.1)\n    tzinfo-data (1.2019.1)\n      tzinfo (&gt;= 1.0.0)\n    uglifier (4.1.20)\n      execjs (&gt;= 0.3.0, &lt; 3)\n    web-console (3.7.0)\n      actionview (&gt;= 5.0)\n      activemodel (&gt;= 5.0)\n      bindex (&gt;= 0.4.0)\n      railties (&gt;= 5.0)\n    websocket-driver (0.7.0)\n      websocket-extensions (&gt;= 0.1.0)\n    websocket-extensions (0.1.3)\n    xpath (3.2.0)\n      nokogiri (~&gt; 1.8)\n\nPLATFORMS\n  x64-mingw32\n\nDEPENDENCIES\n  bootsnap (&gt;= 1.1.0)\n  byebug\n  capybara (&gt;= 2.15)\n  chromedriver-helper\n  coffee-rails (~&gt; 4.2)\n  duktape\n  jbuilder (~&gt; 2.5)\n  mysql2 (&gt;= 0.4.4, &lt; 0.6.0)\n  puma (~&gt; 3.11)\n  rails (~&gt; 5.2.2, &gt;= 5.2.2.1)\n  sass-rails (~&gt; 5.0)\n  selenium-webdriver\n  turbolinks (~&gt; 5)\n  tzinfo-data\n  uglifier (&gt;= 1.3.0)\n  web-console (&gt;= 3.3.0)\n\nRUBY VERSION\n   ruby 2.5.3p105\n\nBUNDLED WITH\n   1.17.3\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "wicked-pdf", "ruby-on-rails-5.2", "wicked-gem"], "comments": [{"owner": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 1, "creation_date": 1553690714, "post_id": 55377466, "comment_id": 97477079, "body": "This has nothing to do with the pdf generated by your gem, it&#39;s just the PDF viewer that displays these options."}, {"owner": {"reputation": 966, "user_id": 4022276, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2190f46aee316f2599e8eb67be88ad83?s=128&d=identicon&r=PG&f=1", "display_name": "Priyank Dey", "link": "https://stackoverflow.com/users/4022276/priyank-dey"}, "reply_to_user": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 0, "creation_date": 1553691233, "post_id": 55377466, "comment_id": 97477430, "body": "But,  title: &quot;Fund Factsheet&quot;, is working which is included in my code. If I change the title in my code, the title will be changed."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1553702211, "post_id": 55377466, "comment_id": 97485163, "body": "If you don&#39;t want your PDF viewer to display a title bar, then you need to turn off the title bar in your PDF viewer."}], "answers": [{"tags": [], "owner": {"reputation": 104, "user_id": 4381022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e930fc1b15c96917acf14b6df8d9c981?s=128&d=identicon&r=PG&f=1", "display_name": "Tuan Tran", "link": "https://stackoverflow.com/users/4381022/tuan-tran"}, "is_accepted": false, "score": 1, "last_activity_date": 1553698677, "creation_date": 1553698677, "answer_id": 55380320, "question_id": 55377466, "link": "https://stackoverflow.com/questions/55377466/how-to-remove-bookmarks-when-using-wicked-pdf-gem-in-ruby-on-rails/55380320#55380320", "title": "How to remove bookmarks when using wicked_pdf gem in Ruby on Rails?", "body": "<p>When you create pdf file, this file has title, content, ... You open this file with PDF viewer, title is showed and page no, download, print, bookmark button are PDF viewer options.\nSo you can't remove bookmark button from this. :D</p>\n"}], "owner": {"reputation": 966, "user_id": 4022276, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2190f46aee316f2599e8eb67be88ad83?s=128&d=identicon&r=PG&f=1", "display_name": "Priyank Dey", "link": "https://stackoverflow.com/users/4022276/priyank-dey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1553698677, "creation_date": 1553690499, "question_id": 55377466, "link": "https://stackoverflow.com/questions/55377466/how-to-remove-bookmarks-when-using-wicked-pdf-gem-in-ruby-on-rails", "title": "How to remove bookmarks when using wicked_pdf gem in Ruby on Rails?", "body": "<p>I am using Ruby 2.5.3p105 and Rails 5.2.0 . And gem 'wicked_pdf' 1.1.0  for pdf download.\nFrom below picture, on hover I am getting bar in the top which include several things like title, page no, rotate, download, print, and last one is bookmarks. I want to remove bookmarks from this sheet. How can I achieve this? </p>\n\n<p><a href=\"https://i.stack.imgur.com/cdtWI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cdtWI.png\" alt=\"enter image description here\"></a></p>\n\n<p>My Codes are:</p>\n\n<p>home_controller.rb:</p>\n\n<pre><code>pdf = render_to_string pdf: \"#{@selected_scheme_code}.pdf\", \n                            template: \"/home/overview_download.html.erb\", \n                            encoding: \"UTF-8\", \n                            layout: 'pdf.html.erb',\n                            disposition: \"attachment\",\n                            title: \"Fund Factsheet\",                               \n                            :page_size =&gt; \"A4\",\n                            margin: {top: 0,\n                                  bottom: 0,\n                                  left: 0,\n                                  right: 0},                             \n                            :javascript_delay =&gt; 5000,\n                            save_to_file: save_path, \n                            :extra =&gt; '--no-stop-slow-scripts',                                \n                            save_only: true\n    File.open(save_path, \"wb\") do |file|\n        file &lt;&lt; pdf\n      end\n</code></pre>\n"}, {"tags": ["python", "ruby", "python-3.x", "pipe"], "comments": [{"owner": {"reputation": 27602, "user_id": 42223, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d73fc2c7bd494149d303a2b87aa5a6d5?s=128&d=identicon&r=PG", "display_name": "dreftymac", "link": "https://stackoverflow.com/users/42223/dreftymac"}, "edited": false, "score": 0, "creation_date": 1554236722, "post_id": 55377323, "comment_id": 97675709, "body": "Have you considered simply using a predictable file path to store data, and have python and ruby both read from and write to the same data file?"}], "owner": {"reputation": 11, "user_id": 11226222, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-thMQexVLe9s/AAAAAAAAAAI/AAAAAAAAAO4/iz7SyMbkHHw/photo.jpg?sz=128", "display_name": "putin putout", "link": "https://stackoverflow.com/users/11226222/putin-putout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1553690042, "creation_date": 1553690042, "question_id": 55377323, "link": "https://stackoverflow.com/questions/55377323/piping-between-python-and-ruby", "title": "Piping between Python and Ruby", "body": "<p>I am writing a code which can send data between a Python and a Ruby script using a \"pipeline\" but can not get it to work. Any recommendations or alternative ways?</p>\n\n<p>I have written simple scripts to get it working and build upon them. The objective is to integrate the \"pipeline\" functionality in a project. In the project, the Python script is to send a .txt file to the Ruby script, which will extract parameter values and store them in respective arrays. I then want to send the arrays back to the Python script.</p>\n\n<p>The simple scripts i have made so far are inspired by <a href=\"https://www.decalage.info/python/ruby_bridge\" rel=\"nofollow noreferrer\">https://www.decalage.info/python/ruby_bridge</a>. When running, it continues without stopping and does not produce any results. The goal is to send the integer 6 to the Ruby script where 5 is added, and send the sum back to the Python script. When aborting with ctrl + c, the following is written:</p>\n\n<pre><code>File \"./com_ruby.py\", line 33, in &lt;module&gt;\n    sss = slave.stdout.readline().rstrip()\n</code></pre>\n\n<p>My Python script:</p>\n\n<pre><code>from subprocess import Popen, PIPE, STDOUT\n\nprint('launching slave process...')\nslave = Popen(['ruby', 'provar.rb'], stdin=PIPE, stdout=PIPE, stderr=STDOUT)\n\nwhile True:\n\n    num = bytes([6])\n    slave.stdin.write(num)\n    # result will be a list of lines:\n    result = []\n    # read slave output line by line, until we reach \"[end]\"\n    while True:\n        # check if slave has terminated:\n        if slave.poll() is not None:\n            print('slave has terminated.')\n            exit()\n        # read one line, remove newline chars and trailing spaces:\n        sss = slave.stdout.readline().rstrip()\n        print('line: ', sss)\n        if sss == '[end]':\n            break\n        result.append(sss)\n    print('result:')\n    print('\\n'.join(result))\n</code></pre>\n\n<p>My Ruby script:</p>\n\n<pre><code>while cmd = STDIN.gets\n\n    cmd.chop!\n\n    cmd = cmd + 5\n\n    cmd.to_s\n    print eval(cmd),\"\\n\"\n    # append [end] so that master knows it's the last line:\n    print \"[end]\\n\"\n    # flush stdout to avoid buffering issues:\n    STDOUT.flush\n\nend\n</code></pre>\n\n<p>Is there any better yet simple way to do the \"piping\" of data between the two scripts?</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "api", "httparty"], "comments": [{"owner": {"reputation": 1320, "user_id": 4531923, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/749da210afda1b309680b354f019849e?s=128&d=identicon&r=PG", "display_name": "Vincent Rolea", "link": "https://stackoverflow.com/users/4531923/vincent-rolea"}, "edited": false, "score": 0, "creation_date": 1553693150, "post_id": 55377117, "comment_id": 97478845, "body": "Could you log what <code>@result</code> is? Also do you have any way to see the logs of the API your are posting to in order to see if the call is received on that end?"}, {"owner": {"reputation": 1320, "user_id": 4531923, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/749da210afda1b309680b354f019849e?s=128&d=identicon&r=PG", "display_name": "Vincent Rolea", "link": "https://stackoverflow.com/users/4531923/vincent-rolea"}, "edited": false, "score": 0, "creation_date": 1553694807, "post_id": 55377117, "comment_id": 97479979, "body": "If you inspect the reponse status and body of your <code>@result</code> variable you might have more insight about what&#39;s happening."}, {"owner": {"reputation": 710, "user_id": 6769558, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6c3dc2b239e077038e9d23b590da5854?s=128&d=identicon&r=PG&f=1", "display_name": "oneWorkingHeadphone", "link": "https://stackoverflow.com/users/6769558/oneworkingheadphone"}, "edited": false, "score": 0, "creation_date": 1553694938, "post_id": 55377117, "comment_id": 97480078, "body": "I don&#39;t understand how <code>@result</code> can be showing you that. Those variables need to be in double quotes, not single to interpolate correctly and even then &quot;#{name}&quot; should be undefined. &quot;#{@book.name}&quot; should have a value though. Also, you never pass the authenticity token and the key is wrong &quot;book&quot; vs &quot;books&quot;."}, {"owner": {"reputation": 7944, "user_id": 10907864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGpcY.jpg?s=128&g=1", "display_name": "Promise Preston", "link": "https://stackoverflow.com/users/10907864/promise-preston"}, "edited": false, "score": 0, "creation_date": 1553694944, "post_id": 55377117, "comment_id": 97480082, "body": "I have updated the question to explicitly show the log for <b>@result</b>  I don&#39;t have access at the moment to see the logs of the API that I am posting to. However, I get a successful response whenever I test the API using Postman.  I need your assistance please, I am stuck here.  Thank you."}, {"owner": {"reputation": 7944, "user_id": 10907864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGpcY.jpg?s=128&g=1", "display_name": "Promise Preston", "link": "https://stackoverflow.com/users/10907864/promise-preston"}, "reply_to_user": {"reputation": 710, "user_id": 6769558, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6c3dc2b239e077038e9d23b590da5854?s=128&d=identicon&r=PG&f=1", "display_name": "oneWorkingHeadphone", "link": "https://stackoverflow.com/users/6769558/oneworkingheadphone"}, "edited": false, "score": 0, "creation_date": 1553696751, "post_id": 55377117, "comment_id": 97481324, "body": "@oneWorkingHeadphone, thank you for pointing out that, I just realized that the whole log code is just for <b>book create action</b>.  I am so sorry for that misconception, I am fairly new to Ruby on Rails.  I have updated the question. Do you know any better way to go about this, because i cant find any log for <b>result</b>.  Thank you."}, {"owner": {"reputation": 710, "user_id": 6769558, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6c3dc2b239e077038e9d23b590da5854?s=128&d=identicon&r=PG&f=1", "display_name": "oneWorkingHeadphone", "link": "https://stackoverflow.com/users/6769558/oneworkingheadphone"}, "edited": false, "score": 0, "creation_date": 1553699529, "post_id": 55377117, "comment_id": 97483334, "body": "@PromisePreston Whew, I was worried that the world didn&#39;t make sense anymore :) I posted a possible solution, let me know if it works"}], "answers": [{"comments": [{"owner": {"reputation": 7944, "user_id": 10907864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGpcY.jpg?s=128&g=1", "display_name": "Promise Preston", "link": "https://stackoverflow.com/users/10907864/promise-preston"}, "edited": false, "score": 0, "creation_date": 1553786544, "post_id": 55380581, "comment_id": 97523019, "body": "Thank you so much <b>@oneWorkingHeadphone.</b>  Unfortunately, this didn&#39;t work for me. I guess it&#39;s because there is no place in my form for creating books that the <b>post_to_api</b> action is called.  Maybe you could specify a way of calling this action on the <b>create books form</b>  However, your answer helped me to modify my code to make it work.  I will post my answer, so that you will see the solution that worked for me"}], "tags": [], "owner": {"reputation": 710, "user_id": 6769558, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6c3dc2b239e077038e9d23b590da5854?s=128&d=identicon&r=PG&f=1", "display_name": "oneWorkingHeadphone", "link": "https://stackoverflow.com/users/6769558/oneworkingheadphone"}, "is_accepted": false, "score": 0, "last_activity_date": 1553699488, "creation_date": 1553699488, "answer_id": 55380581, "question_id": 55377117, "link": "https://stackoverflow.com/questions/55377117/rails-post-json-to-api-using-rails-and-httparty-not-working/55380581#55380581", "title": "Rails: Post JSON to API Using Rails and HTTParty Not Working", "body": "<p><code>@result</code> is never called in your controller because the redirect happens before the execution gets there.</p>\n\n<p>I would wrap the HTTP call in a method rather than assign it to an instance variable since it is transacting things, not assigning them then bring it inside you <code>format.html {}</code> block. Something like this:</p>\n\n<pre><code>def create\n  @book = Book.new(book_params)\n\n  respond_to do |format|\n    if @book.save\n      format.html {\n        post_to_api \n        redirect_to @book, notice: 'Book was successfully created.' \n      }\n      format.json { render :show, status: :created, location: @book }\n    else\n      format.html { render :new }\n      format.json { render json: @book.errors, status: :unprocessable_entity }\n    end\n  end\nend\n\nprivate\n\ndef post_to_api\n  HTTParty.post(' https://www.pingme.com/wp-json/wplms/v1/user/register',\n    :body =&gt; {\n              :books =&gt; {  \n                :name =&gt; \"#{@book.name}\",\n                :author =&gt; \"#{@book.author}\",\n                :description =&gt; \"#{@book.description}\",\n                :category_id =&gt; \"#{@book.category_id}\",\n                :sub_category_id =&gt; \"#{@book.sub_category_id}\"}.to_json, \n    :headers =&gt; { \n              'Content-Type' =&gt; 'application/json',\n              'Authorization' =&gt; '77d22458349303990334xxxxxxxxxx'\n    }\n  )\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 710, "user_id": 6769558, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6c3dc2b239e077038e9d23b590da5854?s=128&d=identicon&r=PG&f=1", "display_name": "oneWorkingHeadphone", "link": "https://stackoverflow.com/users/6769558/oneworkingheadphone"}, "edited": false, "score": 0, "creation_date": 1553791810, "post_id": 55401705, "comment_id": 97526430, "body": "What is different about this code from what you posted in the question?"}, {"owner": {"reputation": 7944, "user_id": 10907864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGpcY.jpg?s=128&g=1", "display_name": "Promise Preston", "link": "https://stackoverflow.com/users/10907864/promise-preston"}, "reply_to_user": {"reputation": 710, "user_id": 6769558, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6c3dc2b239e077038e9d23b590da5854?s=128&d=identicon&r=PG&f=1", "display_name": "oneWorkingHeadphone", "link": "https://stackoverflow.com/users/6769558/oneworkingheadphone"}, "edited": false, "score": 0, "creation_date": 1553840384, "post_id": 55401705, "comment_id": 97542655, "body": "@oneWorkingHeadphone, the difference is the way I called the HTTParty post request body key values:  <b>:name =&gt; &quot;#{@book.name}&quot;</b>  and not <b>:name =&gt; &#39;#{name}&#39;</b>  Which is what I got to implement from your contibution.  However, I assigned my HTTParty Post Request to an instance variable in the create action of the books controller, while you defined a new action for the HTTParty Post Request, which didn&#39;t work for me when I tried it.  Thank you so much for your assistance, I wouldn&#39;t have been able to pull this through without your help. I am very grateful."}, {"owner": {"reputation": 710, "user_id": 6769558, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6c3dc2b239e077038e9d23b590da5854?s=128&d=identicon&r=PG&f=1", "display_name": "oneWorkingHeadphone", "link": "https://stackoverflow.com/users/6769558/oneworkingheadphone"}, "edited": false, "score": 0, "creation_date": 1553843966, "post_id": 55401705, "comment_id": 97543981, "body": "Your instance variable assignment has the side effect of calling the post request. Since the instance variable isn&#39;t used after this it isn&#39;t necessary. I would still suggest that you wrap it in a method as your intention is more clear when someone comes back to this code."}], "tags": [], "owner": {"reputation": 7944, "user_id": 10907864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGpcY.jpg?s=128&g=1", "display_name": "Promise Preston", "link": "https://stackoverflow.com/users/10907864/promise-preston"}, "is_accepted": false, "score": 1, "last_activity_date": 1563690365, "last_edit_date": 1563690365, "creation_date": 1553787791, "answer_id": 55401705, "question_id": 55377117, "link": "https://stackoverflow.com/questions/55377117/rails-post-json-to-api-using-rails-and-httparty-not-working/55401705#55401705", "title": "Rails: Post JSON to API Using Rails and HTTParty Not Working", "body": "<p>Following contributions from @vincent-rolea and @oneWorkingHeadphone, I found a working solution to the issue.</p>\n\n<p><strong>Here is the corrected HTTParty Post Request that worked for me.</strong></p>\n\n<pre><code>@results = HTTParty.post(' https://www.pingme.com/wp-json/wplms/v1/user/register',\n      :body =&gt; {    \n                :name =&gt; \"#{@book.name}\",\n                :author =&gt; \"#{@book.author}\",\n                :description =&gt; \"#{@book.description}\",\n                :category_id =&gt; \"#{@book.category_id}\",\n                :sub_category_id =&gt; \"#{@book.sub_category_id}\"}.to_json, \n      :headers =&gt; { \n                   'Content-Type' =&gt; 'application/json',\n                   'Authorization' =&gt; '77d22458349303990334xxxxxxxxxx'\n      }\n)\n</code></pre>\n\n<p><strong>Ensure to do the following to make to work</strong></p>\n\n<ol>\n<li>Install and confgure the <a href=\"https://github.com/jnunemaker/httparty\" rel=\"nofollow noreferrer\">HTTParty gem</a> in your application</li>\n<li>Include and require the <a href=\"https://github.com/jnunemaker/httparty\" rel=\"nofollow noreferrer\">HTTParty gem</a> in the controller where you want the request to be performed</li>\n<li>Pass the <a href=\"https://github.com/jnunemaker/httparty\" rel=\"nofollow noreferrer\">HTTParty gem</a> post request to an instance variable of in that controller</li>\n</ol>\n\n<p><strong>Here is the inplementation of the HTTParty Post Request in my controller</strong></p>\n\n<pre><code>require 'httparty'\n\nclass BooksController &lt; ApplicationController\n  include HTTParty\n\n  before_action :set_book, only: [:show, :edit, :update, :destroy]\n  before_action :authenticate_admin!, except: %i[show index]\n  skip_before_action :verify_authenticity_token\n\n  # GET /books\n  # GET /books.json\n  def index\n    @books = Book.search(params[:keywords]).paginate(:page =&gt; params[:page], :per_page =&gt; 9).order('created_at DESC')\n  end\n\n  # GET /books/1\n  # GET /books/1.json\n  def show\n  end\n\n  # GET /books/new\n  def new\n    @book = Book.new\n  end\n\n  # GET /books/1/edit\n  def edit\n  end\n\n  # POST /books\n  # POST /books.json\n  def create\n    @book = Book.new(book_params)\n\n    respond_to do |format|\n      if @book.save\n        format.html { redirect_to @book, notice: 'Book was successfully created.' }\n        format.json { render :show, status: :created, location: @book }\n      else\n        format.html { render :new }\n        format.json { render json: @book.errors, status: :unprocessable_entity }\n      end\n    end\n\n    @results = HTTParty.post(' https://www.pingme.com/wp-json/wplms/v1/user/register',\n          :body =&gt; {    \n                    :name =&gt; \"#{@book.name}\",\n                    :author =&gt; \"#{@book.author}\",\n                    :description =&gt; \"#{@book.description}\",\n                    :category_id =&gt; \"#{@book.category_id}\",\n                    :sub_category_id =&gt; \"#{@book.sub_category_id}\"}.to_json, \n          :headers =&gt; { \n                       'Content-Type' =&gt; 'application/json',\n                       'Authorization' =&gt; '77d22458349303990334xxxxxxxxxx'\n          }\n    )\n  end\n\n  # PATCH/PUT /books/1\n  # PATCH/PUT /books/1.json\n  def update\n    respond_to do |format|\n      if @book.update(book_params)\n        format.html { redirect_to @book, notice: 'Book was successfully updated.' }\n        format.json { render :show, status: :ok, location: @book }\n      else\n        format.html { render :edit }\n        format.json { render json: @book.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /books/1\n  # DELETE /books/1.json\n  def destroy\n    @book.destroy\n    respond_to do |format|\n      format.html { redirect_to books_url, notice: 'Book was successfully destroyed.' }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_book\n      @book = Book.find(params[:id])\n    end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    def book_params\n      params.require(:book).permit(:name, :author, :description, :category_id, :sub_category_id)\n    end\nend\n</code></pre>\n\n<p>That's all</p>\n\n<p><strong>I hope this helps.</strong></p>\n"}], "owner": {"reputation": 7944, "user_id": 10907864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGpcY.jpg?s=128&g=1", "display_name": "Promise Preston", "link": "https://stackoverflow.com/users/10907864/promise-preston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 956, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1563690365, "creation_date": 1553689357, "last_edit_date": 1553696863, "question_id": 55377117, "link": "https://stackoverflow.com/questions/55377117/rails-post-json-to-api-using-rails-and-httparty-not-working", "title": "Rails: Post JSON to API Using Rails and HTTParty Not Working", "body": "<p>I am pretty new to API in Rails, although I have gotten some assistance already about how to structure my HTTParty Post Request, but the payload (data) that I am sending does not impact on the database of my API</p>\n\n<p><strong>All I want is to create a record on the database of the API through a POST request from my application.</strong></p>\n\n<p>That is to create a record on both databases (my database and the on the database of the API through a POST request from my application) whenever I create a book.</p>\n\n<p>For the app that will consume the API I am using the HTTParty gem, but the request only runs on the without impacting the database of the API</p>\n\n<p><strong>Here is my HTTParty Post Request Code</strong></p>\n\n<pre><code>@result = HTTParty.post(' https://www.pingme.com/wp-json/wplms/v1/user/register',\n    :body =&gt; {\n                :books =&gt; {  \n                  :name =&gt; '#{name}',\n                  :author =&gt; '#{author}',\n                  :description =&gt; '#{description}',\n                  :category_id =&gt; '#{category_id}',\n                  :sub_category_id =&gt; '#{sub_category_id}'}.to_json, \n    :headers =&gt; { 'Content-Type' =&gt; 'application/json', 'Authorization' =&gt; '77d22458349303990334xxxxxxxxxx' })\n</code></pre>\n\n<p>But this does not impact on the database of the API, rather it only impacts on the database of my Rails Application</p>\n\n<p><strong>Here is the log code for the execution</strong></p>\n\n<pre><code>Started POST \"/books\" for 127.0.0.1 at 2019-03-27 11:51:18 +0100\nProcessing by BooksController#create as HTML\n\nParameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"xxxxxxxx\", \"book\"=&gt;{\"name\"=&gt;\"veb\", \"author\"=&gt;\"vebturejjd\", \"description\"=&gt;\"aisiosoijjdkdp\", \"category_id\"=&gt;\"text books\", \"sub_category_id\"=&gt;\"children\"}, \"commit\"=&gt;\"Create Book\"}\n   (0.1ms)    begin transaction\n\n\u21b3 app/controllers/books_controller.rb:32\n      Book Create (0.5ms)  INSERT INTO \"books\" (\"name\", \"author\", \"description\", \"category_id\", \"sub_category_id\", \"created_at\", \"updated_at\", \"client_id\") VALUES (?, ?, ?, ?, ?, ?, ?)  [[\"name\", \"vebturejjd\"], [\"author\", \"vebturejjd\"], [\"description\", \"aisiosoijjdkdp\"], [\"category_id\", \"text books\"], [\"sub_category_id\", \"children\"], [\"created_at\", \"2019-03-27 10:51:18.239045\"], [\"updated_at\", \"2019-03-27 10:51:18.239045\"]]\n      \u21b3 app/controllers/books_controller.rb:32\n       (77.8ms)  commit transaction\n</code></pre>\n\n<p>I cannot find any log for @result in my terminal, still wondering if it was skipped or didn't run at run, or there is a better way to do it.</p>\n\n<p>Please I need some help on how to parse in ruby to be posted to the database of the API.</p>\n\n<p><strong>Here is my Books Controller for creating books</strong></p>\n\n<pre><code>require 'httparty'\n\nclass BooksController &lt; ApplicationController\n  include HTTParty\n\n  before_action :set_book, only: [:show, :edit, :update, :destroy]\n  before_action :authenticate_admin!, except: %i[show index]\n  skip_before_action :verify_authenticity_token\n\n  # GET /books\n  # GET /books.json\n  def index\n    @books = Book.search(params[:keywords]).paginate(:page =&gt; params[:page], :per_page =&gt; 9).order('created_at DESC')\n  end\n\n  # GET /books/1\n  # GET /books/1.json\n  def show\n  end\n\n  # GET /books/new\n  def new\n    @book = Book.new\n  end\n\n  # GET /books/1/edit\n  def edit\n  end\n\n  # POST /books\n  # POST /books.json\n  def create\n    @book = Book.new(book_params)\n\n    respond_to do |format|\n      if @book.save\n        format.html { redirect_to @book, notice: 'Book was successfully created.' }\n        format.json { render :show, status: :created, location: @book }\n      else\n        format.html { render :new }\n        format.json { render json: @book.errors, status: :unprocessable_entity }\n      end\n    end\n\n    @result = HTTParty.post(' https://www.pingme.com/wp-json/wplms/v1/user/register',\n    :body =&gt; {\n                :books =&gt; {  \n                  :name =&gt; '#{name}',\n                  :author =&gt; '#{author}',\n                  :description =&gt; '#{description}',\n                  :category_id =&gt; '#{category_id}',\n                  :sub_category_id =&gt; '#{sub_category_id}'}.to_json, \n    :headers =&gt; { 'Content-Type' =&gt; 'application/json', 'Authorization' =&gt; '77d22458349303990334xxxxxxxxxx' })\n\n  end\n\n  # PATCH/PUT /books/1\n  # PATCH/PUT /books/1.json\n  def update\n    respond_to do |format|\n      if @book.update(book_params)\n        format.html { redirect_to @book, notice: 'Book was successfully updated.' }\n        format.json { render :show, status: :ok, location: @book }\n      else\n        format.html { render :edit }\n        format.json { render json: @book.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /books/1\n  # DELETE /books/1.json\n  def destroy\n    @book.destroy\n    respond_to do |format|\n      format.html { redirect_to books_url, notice: 'Book was successfully destroyed.' }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_book\n      @book = Book.find(params[:id])\n    end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    def book_params\n      params.require(:book).permit(:name, :author, :description, :category_id, :sub_category_id)\n    end\nend\n</code></pre>\n\n<p><strong>Please any form of assistance will be highly appreciated. Thank you.</strong></p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1553686249, "post_id": 55375554, "comment_id": 97474279, "body": "Define 4-week period. What day of week does a week start on? How are the first and the last week of a (billing) year defined?"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 1, "creation_date": 1553689605, "post_id": 55375554, "comment_id": 97476362, "body": "This would be a good example to provide some assertions/specs for, along with the additional rules (What about leap years? And the extra day at the end of the year?)"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 2649582, "user_type": "registered", "profile_image": "https://graph.facebook.com/500144932/picture?type=large", "display_name": "Peter Fealey", "link": "https://stackoverflow.com/users/2649582/peter-fealey"}, "edited": false, "score": 0, "creation_date": 1553700308, "post_id": 55376188, "comment_id": 97483891, "body": "This is great, thanks.   What the client threw in was that at some point in the last 11 years they changed the way they calculated periods and added an extra week somewhere.   With a change to the start date (2008, 8, 23) to one after the extra week was thrown in, and the code above, we&#39;re good!"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 0, "last_activity_date": 1553686375, "creation_date": 1553686375, "answer_id": 55376188, "question_id": 55375554, "link": "https://stackoverflow.com/questions/55375554/how-to-calculate-a-4-week-period-of-the-billing-year/55376188#55376188", "title": "How to calculate a 4-week period of the billing year", "body": "<p>I would just use <code>Date</code> instead of <code>Time</code> and the calculation would be much easier.</p>\n\n<pre><code>DAYS_PER_PERIOD = 28\n\ndef period\n  days = Date.today - Date.new(2008, 8, 23)\n  periods = days / DAYS_PER_PERIOD\n  periods.to_i # would return a `Rational` instead of an `Integer` otherwise\nend\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 2649582, "user_type": "registered", "profile_image": "https://graph.facebook.com/500144932/picture?type=large", "display_name": "Peter Fealey", "link": "https://stackoverflow.com/users/2649582/peter-fealey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "closed_date": 1553704934, "accepted_answer_id": 55376188, "answer_count": 1, "score": -1, "last_activity_date": 1553686568, "creation_date": 1553684313, "last_edit_date": 1553686568, "question_id": 55375554, "link": "https://stackoverflow.com/questions/55375554/how-to-calculate-a-4-week-period-of-the-billing-year", "closed_reason": "Needs details or clarity", "title": "How to calculate a 4-week period of the billing year", "body": "<p>I'm refactoring a method that should return 4-week periods. A period is calculated as the number of 4-weekly blocks in the current billing year. There are thirteen periods per billing year. First billing year began on 24/08/2008.</p>\n\n<p>I have created a formula:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def period\n  period = (((self.utc.to_time - Time.new(2008,8,23,0,0,0,0)) / 60 / 60 / 24 / 7 / 52).modulo(1) * 13).ceil\n  period == 0 ? 13 : period\nend\n</code></pre>\n\n<p>Over the years, it has become inaccurate, and we're now seeing a shift of a whole period: bookings in Period 1 are showing as Period 2. I tried re-calculating the formula with no success. I feel the formula is too complex anyway, and can probably be achieved more simply.</p>\n"}, {"tags": ["ruby", "multithreading"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1553686893, "post_id": 55375040, "comment_id": 97474688, "body": "Ruby&#39;s (YARV) <a href=\"https://en.wikipedia.org/wiki/Global_interpreter_lock\" rel=\"nofollow noreferrer\">global interpreter lock</a> synchronizes threads to some extend. You might want to try JRuby which offers true <a href=\"https://github.com/jruby/jruby/wiki/Concurrency-in-jruby\" rel=\"nofollow noreferrer\">thread-level concurrency</a>."}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1553687102, "post_id": 55375151, "comment_id": 97474824, "body": "I don&#39;t think <code>puts</code> guarantees that object and separator (newline character) are written in one &quot;atomic&quot; operation."}], "tags": [], "owner": {"reputation": 29107, "user_id": 122080, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6fa1cdda524d49996a8bc6917328de3d?s=128&d=identicon&r=PG", "display_name": "Damien MATHIEU", "link": "https://stackoverflow.com/users/122080/damien-mathieu"}, "is_accepted": true, "score": 5, "last_activity_date": 1553685510, "last_edit_date": 1553685510, "creation_date": 1553683002, "answer_id": 55375151, "question_id": 55375040, "link": "https://stackoverflow.com/questions/55375040/does-race-condition-exist-in-puts/55375151#55375151", "title": "Does race condition exist in `puts`?", "body": "<p>That's because <code>puts</code> doesn't write to <code>STDOUT</code> right away, but buffers the string and writes in bigger chunks.</p>\n\n<p>You can get ruby to write immediately with the following:</p>\n\n<pre><code>STDOUT.sync = true\n</code></pre>\n\n<p>which should resolve your ordering issue.</p>\n"}], "owner": {"reputation": 5951, "user_id": 2361308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/99484dc9d142352778e01ac0c4948c1d?s=128&d=identicon&r=PG", "display_name": "Hearen", "link": "https://stackoverflow.com/users/2361308/hearen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 55375151, "answer_count": 1, "score": 0, "last_activity_date": 1553747475, "creation_date": 1553682693, "last_edit_date": 1553747475, "question_id": 55375040, "link": "https://stackoverflow.com/questions/55375040/does-race-condition-exist-in-puts", "title": "Does race condition exist in `puts`?", "body": "<p>I am reading a <a href=\"https://medium.com/@dathanbennett/why-is-ruby-multithreading-slow-96afb475f669\" rel=\"nofollow noreferrer\">post</a> about threading for ruby. And there is a snippet:</p>\n\n<pre><code>q = Queue.new\nproducer = Thread.new {\n  c = 0\n  while true do\n    q &lt;&lt; c\n    c += 1\n    puts \"#{q.size} in stock\"\n  end\n}\nconsumer1 = Thread.new {\n  while true\n    val = q.shift\n    puts \"Consumer - 1: #{val}\"\n  end\n}\nconsumer2 = Thread.new {\n  while true\n    val = q.shift\n    puts \"Consumer - 2: #{val}\"\n  end\n}\n\n[producer, consumer1, consumer2].each(&amp;:join)\n</code></pre>\n\n<p>The post says the output will be as:</p>\n\n<pre><code>Thread 2: 25\nThread 1: 22\nThread 2: 26Thread 1: 27\nThread 2: 29\nThread 1: 28\n</code></pre>\n\n<p>and the cause is:</p>\n\n<blockquote>\n  <p>\u200a... a pretty common <strong>race condition</strong> ...</p>\n</blockquote>\n\n<p>But I couldn't reproduce that output. And as a java programmer, I don't think the output related to race condition here. I believe it's something related to <code>puts</code>, but I have no clue to that.</p>\n\n<p>What's going on here?</p>\n\n<hr>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Thanks for the help from @Damien MATHIEU which explains a lot to a ruby newbie. I found another <a href=\"https://stackoverflow.com/a/29998780/2361308\">answer in OS for <code>STDOUT.sync = true</code></a> that explains well why we need it and what problems it might cause. </p>\n\n<p>Purpose:</p>\n\n<blockquote>\n  <p>This is done because IO operations are slow and usually it makes more sense to avoid writing every single character immediately to the console.</p>\n</blockquote>\n\n<p>Possible issues as expected (and what happened in my question):</p>\n\n<blockquote>\n  <p>This behavior leads to problems in certain situations. Imagine you want to build a progress bar (run a loop that outputs single dots between extensive calculations). With buffering the result might be that there isn't any output for a while and then suddenly multiple dots are printed out at once.</p>\n</blockquote>\n"}, {"tags": ["ruby", "linux", "rubygems", "manjaro"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11087133, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j8N2A.jpg?s=128&g=1", "display_name": "j-james", "link": "https://stackoverflow.com/users/11087133/j-james"}, "edited": false, "score": 0, "creation_date": 1553700473, "post_id": 55373306, "comment_id": 97484017, "body": "Is there an equivalent of <code>apt-get purge</code> for <code>pacman</code>? I&#39;m running an Arch-based system."}, {"owner": {"reputation": 141, "user_id": 4140718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7ba69bc5807252c67bd5de5f34f0f9?s=128&d=identicon&r=PG&f=1", "display_name": "Sindhuja Selvaraj", "link": "https://stackoverflow.com/users/4140718/sindhuja-selvaraj"}, "reply_to_user": {"reputation": 1, "user_id": 11087133, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j8N2A.jpg?s=128&g=1", "display_name": "j-james", "link": "https://stackoverflow.com/users/11087133/j-james"}, "edited": false, "score": 0, "creation_date": 1553752810, "post_id": 55373306, "comment_id": 97503052, "body": "I don&#39;t think that there is any equivalent for this, But you can try <code># pacman -Rc perl-libwww</code> in order to remove packages. Note: <code>c</code> is a cascade delete."}], "tags": [], "owner": {"reputation": 141, "user_id": 4140718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7ba69bc5807252c67bd5de5f34f0f9?s=128&d=identicon&r=PG&f=1", "display_name": "Sindhuja Selvaraj", "link": "https://stackoverflow.com/users/4140718/sindhuja-selvaraj"}, "is_accepted": false, "score": 2, "last_activity_date": 1553677462, "creation_date": 1553677462, "answer_id": 55373306, "question_id": 55372476, "link": "https://stackoverflow.com/questions/55372476/how-can-i-completely-reset-my-ruby-installation/55373306#55373306", "title": "How can I completely reset my Ruby installation?", "body": "<p><code>sudo apt-get purge &lt;packages&gt;</code> this is what I follow when I completely want to start fresh.\nSo, it would be something like <code>sudo apt-get purge ruby rubygems</code></p>\n\n<p>Note: <code>purge</code> will delete its configuration files too.</p>\n\n<p>I always suggest people to install ruby using <code>rvm</code></p>\n"}, {"tags": [], "owner": {"reputation": 6929, "user_id": 1262519, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/zvPMu.jpg?s=128&g=1", "display_name": "Sachin Singh", "link": "https://stackoverflow.com/users/1262519/sachin-singh"}, "is_accepted": false, "score": 1, "last_activity_date": 1553680152, "creation_date": 1553680152, "answer_id": 55374184, "question_id": 55372476, "link": "https://stackoverflow.com/questions/55372476/how-can-i-completely-reset-my-ruby-installation/55374184#55374184", "title": "How can I completely reset my Ruby installation?", "body": "<p>To fix this error try installing these gems</p>\n\n<pre><code>gem install rdoc\ngem update rake\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11087133, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j8N2A.jpg?s=128&g=1", "display_name": "j-james", "link": "https://stackoverflow.com/users/11087133/j-james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1553680152, "creation_date": 1553674332, "last_edit_date": 1553676130, "question_id": 55372476, "link": "https://stackoverflow.com/questions/55372476/how-can-i-completely-reset-my-ruby-installation", "title": "How can I completely reset my Ruby installation?", "body": "<p>I'm running Manjaro Linux 18.0.4. I seem to have accidentally uninstalled some Ruby gems, or interrupted installation by doing <kbd>ctrl</kbd>+<kbd>c</kbd>.</p>\n\n<p>I tried uninstalling all gems with:</p>\n\n<pre><code>gem uninstall -aIx\n</code></pre>\n\n<p>and an error code pops up:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>ERROR:  While executing gem ... (NameError)\n    uninitialized constant Gem::RDoc\n</code></pre>\n\n<p>I also tried uninstalling Ruby itself through pamac. </p>\n\n<p>I'd just like to start over. What's the best way to accomplish that?</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "stripe-payments", "connect"], "comments": [{"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1553672052, "post_id": 55371857, "comment_id": 97466127, "body": "Aside from the .env dotenv issue.... apparently credentials has an issue with Atom, which is what i use??? <a href=\"https://stackoverflow.com/questions/48539408/rails-5-2-encrypted-credentials-not-saving\" title=\"rails 5 2 encrypted credentials not saving\">stackoverflow.com/questions/48539408/&hellip;</a>"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1553672894, "post_id": 55371857, "comment_id": 97466514, "body": "How exactly do you know it&#39;s not working in production? Have you checked the rendered JS? Also, this is pretty much of a duplicate of your other question <a href=\"https://stackoverflow.com/questions/55370201/using-dotenv-env-for-stripe-error-invalid-api-key-provided\" title=\"using dotenv env for stripe error invalid api key provided\">stackoverflow.com/questions/55370201/&hellip;</a> ... it&#39;s best not to make multiple questions for the same issue"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1553672900, "post_id": 55371857, "comment_id": 97466520, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/55370201/using-dotenv-env-for-stripe-error-invalid-api-key-provided\">Using Dotenv env for stripe &quot;Error: Invalid API Key provided: &lt;%=***&#91;&#39;******_***********_***&#39;&#93;%&gt;&quot;</a>"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1553673436, "post_id": 55371857, "comment_id": 97466771, "body": "@maxpleaner Because the ENV doesn&#39;t pass through in production.  The stripe credit card entry doesn&#39;t appear with it... in local it does.  but in production is i use the key directly in the code it works.  It&#39;s not that the JS isn&#39;t being rendered, its that the ENV isn&#39;t being passed into the production -- this is my assumption."}, {"owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "edited": false, "score": 1, "creation_date": 1553679988, "post_id": 55371857, "comment_id": 97470420, "body": "Did you commit and push your <code>.env</code> file?"}], "answers": [{"comments": [{"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1553673951, "post_id": 55372331, "comment_id": 97467014, "body": "Already have <code>Rails.application.config.assets.precompile &lt;&lt; &#39;*.js&#39; Rails.application.config.assets.precompile &lt;&lt; &#39;*.js.erb&#39;</code> in my assets."}, {"owner": {"reputation": 710, "user_id": 6769558, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6c3dc2b239e077038e9d23b590da5854?s=128&d=identicon&r=PG&f=1", "display_name": "oneWorkingHeadphone", "link": "https://stackoverflow.com/users/6769558/oneworkingheadphone"}, "reply_to_user": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1553674032, "post_id": 55372331, "comment_id": 97467047, "body": "When you look at the JS file being delivered, is it interpolated correctly?"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1553674046, "post_id": 55372331, "comment_id": 97467056, "body": "I&#39;m confused.  So I am using Stripe Elements and in the stripe.js: <a href=\"https://stripe.com/docs/stripe-js/elements/quickstart\" rel=\"nofollow noreferrer\">stripe.com/docs/stripe-js/elements/quickstart</a> i need to pass the publishable key in the js file.  Is there another way to do this?"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1553674533, "post_id": 55372331, "comment_id": 97467290, "body": "I literally have no idea what that means.  But when i check in Sources, the JS file is rendering and passing through.  My assumption is that if the ENV or crednetials passed the key through, it would work..... idk"}, {"owner": {"reputation": 710, "user_id": 6769558, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6c3dc2b239e077038e9d23b590da5854?s=128&d=identicon&r=PG&f=1", "display_name": "oneWorkingHeadphone", "link": "https://stackoverflow.com/users/6769558/oneworkingheadphone"}, "reply_to_user": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1553674788, "post_id": 55372331, "comment_id": 97467421, "body": "When you look in sources you see a variable that looks exactly like this (with a different key ofc): <code>var stripe = Stripe(&#39;pk_test_x5T4dHozsoJKgbvSZewKa07&#39;);</code>?"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1553674895, "post_id": 55372331, "comment_id": 97467483, "body": "That happens only if i pass the key directly into the .js or js.erb file.  When i use the ENV[: or credentials, I get nothing."}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1553674956, "post_id": 55372331, "comment_id": 97467514, "body": "Thats actually why i started doing this because i saw the test key was in the sources, which i assume wouldn&#39;t be safe so i wanted to somehow hide that but still have everything work out"}, {"owner": {"reputation": 710, "user_id": 6769558, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6c3dc2b239e077038e9d23b590da5854?s=128&d=identicon&r=PG&f=1", "display_name": "oneWorkingHeadphone", "link": "https://stackoverflow.com/users/6769558/oneworkingheadphone"}, "reply_to_user": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1553675799, "post_id": 55372331, "comment_id": 97467900, "body": "Updated based on comments. At least it sounds like your erb is getting processed so it&#39;s likely just that the ENV is not set"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 1, "creation_date": 1553676260, "post_id": 55372331, "comment_id": 97468120, "body": "Okay, ended up being because i had &quot;PUBLISHABLE KEY&quot; in heroku set, but had &quot;STRIPE_PUBLISHABLE_KEY&quot; set in .env and credentials.... wow,4 hours later.  But now my concern is that even with that, I can still see the test publishable key in the sources. If i can see it, can&#39;t everyone else? If i go to live, will it go away, I don&#39;t understand now"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1553676290, "post_id": 55372331, "comment_id": 97468140, "body": "and btw thanks for helping.  very much so appreciated a lot"}, {"owner": {"reputation": 710, "user_id": 6769558, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6c3dc2b239e077038e9d23b590da5854?s=128&d=identicon&r=PG&f=1", "display_name": "oneWorkingHeadphone", "link": "https://stackoverflow.com/users/6769558/oneworkingheadphone"}, "reply_to_user": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1553676538, "post_id": 55372331, "comment_id": 97468291, "body": "Glad you got it figured out. If I were you I would go ahead and swap everything over to credentials now that it is working. It&#39;s more secure and it won&#39;t require you to upload your .env file to source control (which defeats the whole point of env variables anyway). Also see edit: there is nothing wrong with sending the user a publishable key, it is required to identify the app"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1553676754, "post_id": 55372331, "comment_id": 97468429, "body": "Well, the publishable key is on heroku, are you saying to remove that from heroku and just use credentials instead?"}, {"owner": {"reputation": 710, "user_id": 6769558, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6c3dc2b239e077038e9d23b590da5854?s=128&d=identicon&r=PG&f=1", "display_name": "oneWorkingHeadphone", "link": "https://stackoverflow.com/users/6769558/oneworkingheadphone"}, "reply_to_user": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1553676783, "post_id": 55372331, "comment_id": 97468455, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/190755/discussion-between-oneworkingheadphone-and-uno\">continue this discussion in chat</a>."}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1553676788, "post_id": 55372331, "comment_id": 97468458, "body": "My concern is people getting a hold of the live publishable key, isn&#39;t that a security concern?.."}], "tags": [], "owner": {"reputation": 710, "user_id": 6769558, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6c3dc2b239e077038e9d23b590da5854?s=128&d=identicon&r=PG&f=1", "display_name": "oneWorkingHeadphone", "link": "https://stackoverflow.com/users/6769558/oneworkingheadphone"}, "is_accepted": false, "score": 0, "last_activity_date": 1553675456, "last_edit_date": 1553675456, "creation_date": 1553673780, "answer_id": 55372331, "question_id": 55371857, "link": "https://stackoverflow.com/questions/55371857/using-dotenv-in-production-or-passing-env-variables-to-js-js-erb-and-attempt-w/55372331#55372331", "title": "Using dotenv in production, or passing env variables to js/js.erb? and attempt with credentials", "body": "<p>If you have remembered to precompile your assets (which I often forget when dealing with heroku), you will need to add the js.erb file to the precompile list explicitly (<a href=\"https://stackoverflow.com/questions/20275846/rails-wont-precompile-js-erb\">SO post</a>, <a href=\"https://launchschool.com/blog/rails-asset-pipeline-best-practices\" rel=\"nofollow noreferrer\">more detailed blog post</a>)</p>\n\n<p>In this case though, you actually do not need to wrap this up in a variable anyway. The publishable key can be (should be) included to identify your Stripe account and the interpolation is going to send it in plain text anyway (what you normally want to avoid by using ENV variables) so you can skip the interp step entirely.</p>\n\n<p><strong>Edit from comments:</strong>\nYou need to verify that the env key is actually set on Heroku. There are two ways to check:</p>\n\n<ul>\n<li>login to the CLI and check</li>\n<li>check also through the settings in the dashboard (<a href=\"https://devcenter.heroku.com/articles/config-vars\" rel=\"nofollow noreferrer\">this</a> has examples on how to do both) </li>\n</ul>\n\n<p>If you're getting an empty string in the compiled JS then that would at least indicate that the ERB is getting processed so the error is likely that there is nothing to interpolate when it is.</p>\n\n<p>Just to reiterate there's no reason to hide a the publishable key (that's why it's called that and why the docs pass it in the clear). Furthermore putting it in an ENV that gets interpolated into text isn't hiding anything anyway.</p>\n"}, {"tags": [], "owner": {"reputation": 6929, "user_id": 1262519, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/zvPMu.jpg?s=128&g=1", "display_name": "Sachin Singh", "link": "https://stackoverflow.com/users/1262519/sachin-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1553680642, "creation_date": 1553680642, "answer_id": 55374359, "question_id": 55371857, "link": "https://stackoverflow.com/questions/55371857/using-dotenv-in-production-or-passing-env-variables-to-js-js-erb-and-attempt-w/55374359#55374359", "title": "Using dotenv in production, or passing env variables to js/js.erb? and attempt with credentials", "body": "<p>I think you have forgotten to set <code>RAILS_MASTER_KEY</code> environment variable in your Heroku app while using credentials approach. From your codebase assign content of <code>master.key</code> to it. </p>\n"}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 587, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1553680642, "creation_date": 1553671685, "last_edit_date": 1553673189, "question_id": 55371857, "link": "https://stackoverflow.com/questions/55371857/using-dotenv-in-production-or-passing-env-variables-to-js-js-erb-and-attempt-w", "title": "Using dotenv in production, or passing env variables to js/js.erb? and attempt with credentials", "body": "<p>I am attempting to pass my ENV variable of my stripe publishable key to the stripe.js file for Connect.</p>\n\n<p><strong>Dotenv gem:</strong></p>\n\n<pre><code>gem 'dotenv-rails', groups: [:development, :test, :production]\n</code></pre>\n\n<p>I added it to my dotenv gem .env file:</p>\n\n<pre><code>STRIPE_PUBLISHABLE_KEY=pk_test_xxxxxxxxxx\nSTRIPE_SECRET_KEY=sk_test_xxxxxxxxxx\n</code></pre>\n\n<p>Then added to my stripe.js.erb file:</p>\n\n<pre><code>var stripe = Stripe(\"&lt;%= ENV['STRIPE_PUBLISHABLE_KEY']%&gt;\");\n</code></pre>\n\n<p>changing the stripe.js to stripe.js.erb worked locally, but the ENV doesn't seem to work in production.  Within Heroku variables, I have it set.  And if I pass the key directly in the stripe.js/.js/erb it will work, so one way or another, the ENV isn't working during production.</p>\n\n<p>Even if i take the code into the views with  tags, it won't work unless i pass the key directly in.</p>\n\n<p>I receive no errors on herokus side.</p>\n\n<p><strong>I also tried using credentials:</strong></p>\n\n<pre><code>stripe:\n  stripe_publishable_key: pk_test_x\n  stripe_secret_key: sk_test_x\n</code></pre>\n\n<p>With this in my stripe.js/.js.erb file:</p>\n\n<pre><code>  var stripe = Stripe('&lt;%= Rails.application.credentials.dig(:stripe, :stripe_publishable_key) %&gt;');\n</code></pre>\n\n<p>(i use this exact format for active storage and works\nand tried:</p>\n\n<pre><code> var stripe = Stripe('&lt;%= Rails.application.credentials.stripe[:stripe_publishable_key] %&gt;');\n</code></pre>\n\n<p>With these i get the following error pushing to heroku   :</p>\n\n<blockquote>\n  <p>NoMethodError: undefined method `[]' for nil:NilClass</p>\n</blockquote>\n\n<p><strong>Questions:</strong> How can I pass the ENV variables through to production?</p>\n\n<p>That question was solved by using .erb, but now the problem is the ENV file not reaching production.</p>\n"}, {"tags": ["ruby", "hash"], "comments": [{"owner": {"reputation": 2470, "user_id": 1013142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd97eb9f014330c6063dfadb77bbd5de?s=128&d=identicon&r=PG", "display_name": "Sudipta Mondal", "link": "https://stackoverflow.com/users/1013142/sudipta-mondal"}, "edited": false, "score": 1, "creation_date": 1553668323, "post_id": 55370852, "comment_id": 97464609, "body": "What code have you tried writing yet ? Please show your attempt"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1553672876, "post_id": 55370852, "comment_id": 97466500, "body": "It has nothing to do with Rails."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1553705000, "post_id": 55371190, "comment_id": 97486923, "body": "The inards of <code>map</code>&#39;s block could alternatively be written <code>g.first.merge(source: g.reduce([]) { |a, e| a &lt;&lt; e[:source] })</code>."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 4, "last_activity_date": 1553668954, "last_edit_date": 1553668954, "creation_date": 1553668631, "answer_id": 55371190, "question_id": 55370852, "link": "https://stackoverflow.com/questions/55370852/how-to-merge-two-hashes-with-same-id-by-combining-keys-with-different-values/55371190#55371190", "title": "How to merge two hashes with same ID by combining keys with different values", "body": "<pre><code>hashes.\n    group_by { |e| [e[:id], e[:value]] }.\n    map { |_, g|\n      g.first.clone.\n          tap { |t|\n            t[:source] = g.reduce([]) { |a, e| a &lt;&lt; e[:source] }\n          }\n    }\n</code></pre>\n\n<p>First group the hashes by the part that should be the same. We don't care about the key any more; but each group itself will map to something very similar to the first element of the group. Clone it so the original <code>hashes</code> elements are not mutated; then replace its <code>:source</code> with the accumulation of all the group's elements' <code>:source</code> values.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1553718774, "last_edit_date": 1553718774, "creation_date": 1553670279, "answer_id": 55371524, "question_id": 55370852, "link": "https://stackoverflow.com/questions/55370852/how-to-merge-two-hashes-with-same-id-by-combining-keys-with-different-values/55371524#55371524", "title": "How to merge two hashes with same ID by combining keys with different values", "body": "<p>@Amadan used <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-group_by\" rel=\"nofollow noreferrer\">Enumerable#group_by</a> in his answer. <code>group_by</code> and <code>Enumerable#update</code> (aka <code>merge!</code>) are interchangeable in the sense that when one is used the other can <strike>usually</strike> be used instead. I will show how <code>update</code> can be used here.</p>\n\n<pre><code>hashes.each_with_object({}) do |g,h|\n  h.update(g[:id] =&gt; g.merge(source: [g[:source]])) do |_,oh,nh|\n    oh.merge(source: oh[:source] + nh[:source])\n  end\nend.values\n  #=&gt; [{:id=&gt;1, :value=&gt;\"something\", :source=&gt;[\"a\", \"b\"]},\n  #    {:id=&gt;2, :value=&gt;\"something\", :source=&gt;[\"a\"]},\n  #    {:id=&gt;3, :value=&gt;\"something\", :source=&gt;[\"c\"]}] \n</code></pre>\n\n<p>First, note that <code>h.update(k=&gt;v)</code> is shorthand for <code>h.update({ k=&gt;v })</code>. This uses the form of <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-update\" rel=\"nofollow noreferrer\">Hash#update</a> (aka <code>merge!</code>) that employs a block to determine the values of keys that are present in both hashes being merged. That block has three block variables, the common key (<code>_</code>), the value of the hash being updated (<code>oh</code>, \"o\" for \"old\", \"h\" because the value is a hash) and the value of the hash being merged (<code>nh</code>, \"n\" for \"new\"). </p>\n\n<p>The steps are as follows.</p>\n\n<pre><code>e = hashes.each_with_object({})\n  #=&gt; #&lt;Enumerator: [\n  #     {:id=&gt;1, :value=&gt;\"something\", :source=&gt;\"a\"},\n  #     {:id=&gt;1, :value=&gt;\"something\", :source=&gt;\"b\"},\n  #     {:id=&gt;2, :value=&gt;\"something\", :source=&gt;\"a\"}, \n  #     {:id=&gt;3, :value=&gt;\"something\", :source=&gt;\"c\"}\n  #   ]:each_with_object({})&gt; \n</code></pre>\n\n<p>The first element of this enumerator is generated, passed to the block and assigned to the block variables.</p>\n\n<pre><code>g,h = e.next\n  #=&gt; [{:id=&gt;1, :value=&gt;\"something\", :source=&gt;\"a\"}, {}] \ng #=&gt; {:id=&gt;1, :value=&gt;\"something\", :source=&gt;\"a\"} \nh #=&gt; {} \n</code></pre>\n\n<p>The block calculation is then performed.</p>\n\n<pre><code>h.update(g[:id]  =&gt; g.merge(source: [g[:source]]))\n  #=&gt; h.update(1 =&gt; g.merge(source: [\"a\"]))\n  #=&gt; h.update(1 =&gt;{:id=&gt;1, :value=&gt;\"something\", :source=&gt;[\"b\"]})\n  #=&gt; {1=&gt;{:id=&gt;1, :value=&gt;\"something\", :source=&gt;[\"b\"]}}\n</code></pre>\n\n<p>Prior to executing this merge <code>h</code> was empty, meaning that the two hashes being merged had no common keys. <code>update</code>'s value-resolution block was therefore not called.</p>\n\n<p>Now <code>e</code> is directed by <code>update</code> to generate its next value and pass it to the block. The block variables are assigned to that value and the block calculation is performed.</p>\n\n<pre><code>g,h = e.next\n  #=&gt; [{:id=&gt;1, :value=&gt;\"something\", :source=&gt;\"b\"},\n  #    {1=&gt;{:id=&gt;1, :value=&gt;\"something\", :source=&gt;[\"a\"]}}] \ng #=&gt;  {:id=&gt;1, :value=&gt;\"something\", :source=&gt;\"b\"} \nh #=&gt;  {1=&gt;{:id=&gt;1, :value=&gt;\"something\", :source=&gt;[\"a\"]}} \n</code></pre>\n\n<p>Notice that <code>h</code> has been updated. Now compute:</p>\n\n<pre><code>h.update(g[:id] =&gt; g.merge(source: [g[:source]])) do |_,oh,nh|\n  oh.merge(source: oh[:source] + nh[:source])\nend\n  #=&gt; {1=&gt;{:id=&gt;1, :value=&gt;\"something\", :source=&gt;[\"a\", \"b\"]}} \n</code></pre>\n\n<p>As</p>\n\n<pre><code>g[:id]\n  #=&gt; 1\n</code></pre>\n\n<p>and</p>\n\n<pre><code>g.merge(source: [g[:source]])\n  #=&gt; g.merge(source: [\"b\"])\n  #=&gt; {:id=&gt;1, :value=&gt;\"something\", :source=&gt;[\"b\"]} \n</code></pre>\n\n<p>the above expression reduces to</p>\n\n<pre><code>h.update(1 =&gt; {:id=&gt;1, :value=&gt;\"something\", :source=&gt;[\"b\"]}) do |_,oh,nh|\n  oh.merge(source: oh[:source] + nh[:source])\nend\n</code></pre>\n\n<p>As both hashes being merged have a common key of <code>1</code>, the block is called to determine the value of <code>1</code> in the merged hash:</p>\n\n<pre><code>_ = 1\noh = h[1]\n  #=&gt; {:id=&gt;1, :value=&gt;\"something\", :source=&gt;[\"a\"]}\nnh = g.merge(source: [g[:source]]) \n  #=&gt; g.merge(source: [\"b\"])\n  #=&gt; {:id=&gt;1, :value=&gt;\"something\", :source=&gt;[\"b\"]}\n</code></pre>\n\n<p>I've used an underscore (a valid local variable name) to represent the common key to signal to the reader that it is not used in the block calculation. The block calculation follows.</p>\n\n<pre><code>oh.merge(source: oh[:source] + nh[:source])\n  #=&gt; oh.merge(source: [\"a\", \"b\"])  \n  #=&gt; {:id=&gt;1, :value=&gt;\"something\", :source=&gt;[\"a\", \"b\"]}\n</code></pre>\n\n<p>The calculations are similar for the remaining elements generated by <code>e</code>. We thereby obtain:</p>\n\n<pre><code>f = hashes.each_with_object({}) do |g,h|\n  h.update(g[:id] =&gt; g.merge(source: [g[:source]])) do |_,oh,nh|\n    oh.merge(source: oh[:source] + nh[:source])\n  end\nend\n  #=&gt; {1=&gt;{:id=&gt;1, :value=&gt;\"something\", :source=&gt;[\"a\", \"b\"]},\n  #    2=&gt;{:id=&gt;2, :value=&gt;\"something\", :source=&gt;[\"a\"]},\n  #    3=&gt;{:id=&gt;3, :value=&gt;\"something\", :source=&gt;[\"c\"]}} \n</code></pre>\n\n<p>The final step is to return <code>f.values</code>. </p>\n"}], "owner": {"reputation": 1157, "user_id": 2139625, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bae8754c8dc0c8cda10c73cfae780b50?s=128&d=identicon&r=PG", "display_name": "Yedhu Krishnan", "link": "https://stackoverflow.com/users/2139625/yedhu-krishnan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 0, "closed_date": 1553704954, "accepted_answer_id": 55371190, "answer_count": 2, "score": -2, "last_activity_date": 1553748321, "creation_date": 1553667140, "last_edit_date": 1553748321, "question_id": 55370852, "link": "https://stackoverflow.com/questions/55370852/how-to-merge-two-hashes-with-same-id-by-combining-keys-with-different-values", "closed_reason": "Needs more focus", "title": "How to merge two hashes with same ID by combining keys with different values", "body": "<p>I have an array of hashes as follows:</p>\n\n<pre><code>hashes = [\n  {id: 1, value: 'something', source: 'a'},\n  {id: 1, value: 'something', source: 'b'},\n  {id: 2, value: 'something', source: 'a'},\n  {id: 3, value: 'something', source: 'c'}\n]\n</code></pre>\n\n<p>I need this:</p>\n\n<pre><code>new_hashes = [\n  {id: 1, value: 'something', source: ['a', 'b']},\n  {id: 2, value: 'something', source: ['a']},\n  {id: 3, value: 'something', source: ['c']}\n]\n</code></pre>\n\n<p>How do I do this? I've tried the following:</p>\n\n<pre><code>merge_array = -&gt; x,y { x.merge(y){|key, old, new| Array(old).push(new)} }\nhashes.reduce &amp;merge_array\n</code></pre>\n\n<p>But this merges everything together. I don't want to merge hashes with different ID.</p>\n"}, {"tags": ["c++", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11263978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76249694ba5f22ded2e613804ff0ebbf?s=128&d=identicon&r=PG&f=1", "display_name": "Modern Barbarian", "link": "https://stackoverflow.com/users/11263978/modern-barbarian"}, "edited": false, "score": 0, "creation_date": 1553699004, "post_id": 55371073, "comment_id": 97482958, "body": "I should have added that the C++ operator[] does not allow for more than one parameter, so I cannot pass both rows and columns to the overloaded function. I will update my original question to reflect this, thanks"}, {"owner": {"reputation": 220, "user_id": 10971086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c411eff4f0e872cad27b4e66ffa12ab?s=128&d=identicon&r=PG&f=1", "display_name": "DeviatioN", "link": "https://stackoverflow.com/users/10971086/deviation"}, "reply_to_user": {"reputation": 1, "user_id": 11263978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76249694ba5f22ded2e613804ff0ebbf?s=128&d=identicon&r=PG&f=1", "display_name": "Modern Barbarian", "link": "https://stackoverflow.com/users/11263978/modern-barbarian"}, "edited": false, "score": 0, "creation_date": 1553701836, "post_id": 55371073, "comment_id": 97484912, "body": "Do you need to use operator[]? Otherwise you could just make it regular function and call it <code>at</code> or <code>get</code> or whatever. If you do need it then I guess you have to return a proxy object."}], "tags": [], "owner": {"reputation": 220, "user_id": 10971086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c411eff4f0e872cad27b4e66ffa12ab?s=128&d=identicon&r=PG&f=1", "display_name": "DeviatioN", "link": "https://stackoverflow.com/users/10971086/deviation"}, "is_accepted": false, "score": 0, "last_activity_date": 1553668084, "creation_date": 1553668084, "answer_id": 55371073, "question_id": 55370139, "link": "https://stackoverflow.com/questions/55370139/trying-to-convert-ruby-custom-array-accessor-to-c-subscript-operator-override/55371073#55371073", "title": "Trying to convert Ruby custom array accessor to C++ subscript operator override", "body": "<blockquote>\n  <p>I'm totally lost on how to implement this to check against both rows and columns.</p>\n</blockquote>\n\n<p>Use <code>and</code> or <code>&amp;&amp;</code> like this:</p>\n\n<pre><code>if (row &lt; rows &amp;&amp; column &lt; columns)\n{\n    // success\n}\nelse\n{\n    // fail\n}\n</code></pre>\n\n<p>For indicating failure you could change the function signature to return a <code>Cell*</code> which would allow you to return a <code>nullptr</code> (don't use <code>NULL</code>) or you could throw an exception.</p>\n"}], "owner": {"reputation": 1, "user_id": 11263978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76249694ba5f22ded2e613804ff0ebbf?s=128&d=identicon&r=PG&f=1", "display_name": "Modern Barbarian", "link": "https://stackoverflow.com/users/11263978/modern-barbarian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1553699835, "creation_date": 1553663100, "last_edit_date": 1553699835, "question_id": 55370139, "link": "https://stackoverflow.com/questions/55370139/trying-to-convert-ruby-custom-array-accessor-to-c-subscript-operator-override", "title": "Trying to convert Ruby custom array accessor to C++ subscript operator override", "body": "<p>I'm learning how to generate mazes with the book \"Mazes for Programmers: Code Your Own Twisty Little Passages\". The examples are all in Ruby. I am currently learning advanced C++ and I want to convert this code.</p>\n\n<pre><code>def [](row, column)\n  return nil unless row.between?(0, @rows - 1)\n  return nil unless column.between?(0, @grid[row].count - 1)\n@grid[row][column] end\n\n#Buck, Jamis. Mazes for Programmers: Code Your Own Twisty Little Passages\n#(p. 21). Pragmatic Bookshelf. Kindle Edition.\n</code></pre>\n\n<p>The code above returns a Cell object from the grid at the given row and column, if such Cell exists. I have looked into overriding the [] operator in C++ but the Ruby implementation uses a 2d array. I'm totally lost on how to implement this to check against both rows and columns.</p>\n\n<hr>\n\n<p>Here is the header for the Grid Class:</p>\n\n<pre><code>#include \"Cell.h\"\n\nclass Grid\n{\nprivate:\n    int rows;\n    int columns;\n    vector&lt;vector&lt;Cell&gt;&gt; grid;\npublic:\n    Grid(int, int);\n    ~Grid();\n    void prepareGrid();\n    void configureCells();\n    Cell &amp;operator[] (int,int);\n};\n</code></pre>\n\n<p>I want to be able to do something like this:</p>\n\n<pre><code>Cell &amp; Grid::operator[](int row, int column)\n{\n    if (row &gt;= rows) {\n        return NULL;\n    }\n    else if (column &gt;= columns) {\n        return NULL;\n    }\n    else {\n        return grid[row][column];\n    }\n}\n</code></pre>\n\n<hr>\n\n<ul>\n<li>Edit for clarification</li>\n</ul>\n\n<p>: The C++ operator[] does not allow for more than one parameter, so I cannot check against both rows and columns with a single override of the accessor</p>\n\n<p>I also realize that returning NULL is not valid in this situation and need to figure out how to work around that.</p>\n"}, {"tags": ["ruby", "string"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1553669139, "post_id": 55369547, "comment_id": 97464933, "body": "Tangential, but those same naming conventions would want <code>write_hello</code> instead of <code>writeHello</code>. Hang in there! :D"}, {"owner": {"reputation": 5951, "user_id": 2361308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/99484dc9d142352778e01ac0c4948c1d?s=128&d=identicon&r=PG", "display_name": "Hearen", "link": "https://stackoverflow.com/users/2361308/hearen"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1553670973, "post_id": 55369547, "comment_id": 97465662, "body": "Yeah! Thank you, just focusing on the variable names."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1553671521, "post_id": 55369547, "comment_id": 97465889, "body": "Next time you ask yourself <i>&quot;can I do x instead of y?&quot;</i>, you should just give it a try :-)"}, {"owner": {"reputation": 5951, "user_id": 2361308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/99484dc9d142352778e01ac0c4948c1d?s=128&d=identicon&r=PG", "display_name": "Hearen", "link": "https://stackoverflow.com/users/2361308/hearen"}, "edited": false, "score": 0, "creation_date": 1553671680, "post_id": 55369547, "comment_id": 97465950, "body": "Stefan, sorry for the silly question. I tried in <i>IntelliJ 2018.3</i> but it&#39;s highlighted and worked weirdly. It&#39;s silly to ask this question, it seems now but it&#39;s just confusing at that time to me. Thank you for the ~friendly reminder~. Thank you ;)"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1553671787, "post_id": 55369547, "comment_id": 97466000, "body": "RubyMine is more useful in that regard."}, {"owner": {"reputation": 5951, "user_id": 2361308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/99484dc9d142352778e01ac0c4948c1d?s=128&d=identicon&r=PG", "display_name": "Hearen", "link": "https://stackoverflow.com/users/2361308/hearen"}, "edited": false, "score": 0, "creation_date": 1553671888, "post_id": 55369547, "comment_id": 97466057, "body": "Thank you for the recommendations, I am checking it now. Thank you so much ~ I was using IntelliJ compared to VSCode (even harder to use)."}], "answers": [{"comments": [{"owner": {"reputation": 5951, "user_id": 2361308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/99484dc9d142352778e01ac0c4948c1d?s=128&d=identicon&r=PG", "display_name": "Hearen", "link": "https://stackoverflow.com/users/2361308/hearen"}, "edited": false, "score": 0, "creation_date": 1553659711, "post_id": 55369640, "comment_id": 97462207, "body": "Sorry, just first time in ruby. Still have no clue how everything works. Gabbling with the basics still on..."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1553681765, "post_id": 55369640, "comment_id": 97471515, "body": "<code>write</code> doesn&#39;t append a newline (as opposed to <code>puts</code>)."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 2, "last_activity_date": 1553685122, "last_edit_date": 1553685122, "creation_date": 1553659534, "answer_id": 55369640, "question_id": 55369547, "link": "https://stackoverflow.com/questions/55369547/can-i-make-file-name-simpler/55369640#55369640", "title": "Can I make `&quot;#{file_name}&quot;` simpler?", "body": "<p>Your code works, but is actually bad code. Indeed it should be written as <code>fileName</code>, although a Rubyist would not name a variable like that in camel case.</p>\n\n<p>However, it would be better to write shorter, like</p>\n\n<pre><code>File.write(fileName, \"Hello, world! I'm Ruby :)\")\n</code></pre>\n\n<p>although you would have to explicitly add a new line character at the end if the string if you want one, as Stefan notes.</p>\n"}, {"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 5, "last_activity_date": 1553659737, "creation_date": 1553659737, "answer_id": 55369672, "question_id": 55369547, "link": "https://stackoverflow.com/questions/55369547/can-i-make-file-name-simpler/55369672#55369672", "title": "Can I make `&quot;#{file_name}&quot;` simpler?", "body": "<p>That's needlessly verbose.</p>\n\n<pre><code>x = \"test\"\n\"#{x}\"\n# =&gt; \"test\"\n</code></pre>\n\n<p>It's literally the same thing in your case.</p>\n\n<p>A Ruby idiomatic version of this code looks like:</p>\n\n<pre><code>def write_hello(filename)\n  File.open(filename, \"w\") do |file|\n    file.puts \"Hello, world! I'm Ruby :)\"\n  end\nend\n</code></pre>\n\n<p>This uses the multi-line <code>do ... end</code> form which is often a lot easier to follow and understand but is otherwise equivalent to the <code>{ ... }</code> form. New Ruby people may be a little perplexed at how <code>{ x: 'y' }</code> and <code>{ |x| 'y' }</code> are dramatically different things, so this avoids the ambiguity there.</p>\n\n<p>It's not necessary to enquote something in isolation. That would be necessary if you wanted to append a file extension, like:</p>\n\n<pre><code>File.open(\"#{filename}.txt\", \"w\") do |file|\n  # ...\nend\n</code></pre>\n\n<p>Where you'd call that like:</p>\n\n<pre><code>write_hello(:example)\n</code></pre>\n\n<p>And that would create <code>example.txt</code></p>\n"}], "owner": {"reputation": 5951, "user_id": 2361308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/99484dc9d142352778e01ac0c4948c1d?s=128&d=identicon&r=PG", "display_name": "Hearen", "link": "https://stackoverflow.com/users/2361308/hearen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 55369672, "answer_count": 2, "score": -1, "last_activity_date": 1553685122, "creation_date": 1553658861, "last_edit_date": 1553670984, "question_id": 55369547, "link": "https://stackoverflow.com/questions/55369547/can-i-make-file-name-simpler", "title": "Can I make `&quot;#{file_name}&quot;` simpler?", "body": "<p>It looks quite verbose to write something as this <code>\"#{file_name}\"</code> instead of just <code>file_name</code>.</p>\n\n<pre><code>  def write_hello(file_name)\n    File.open(\"#{file_name}\", \"w\") { |file| file.puts \"Hello, world! I'm Ruby :)\"}\n  end\n</code></pre>\n\n<p>What can I do to make it cleaner?</p>\n\n<p><strong>Updated</strong></p>\n\n<p>I just have ruby <a href=\"https://github.com/rubocop-hq/ruby-style-guide#naming\" rel=\"nofollow noreferrer\">naming conventions</a>, so I updated the <code>fileName</code> to <code>file_name</code> now. </p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "heroku"], "comments": [{"owner": {"reputation": 42804, "user_id": 2181397, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/616931b5c5ba8790a191fa6aea465c65?s=128&d=identicon&r=PG", "display_name": "brk", "link": "https://stackoverflow.com/users/2181397/brk"}, "edited": false, "score": 0, "creation_date": 1553658486, "post_id": 55369474, "comment_id": 97461981, "body": "Not able to reproduce any error and please share the error which you are seeing in production"}, {"owner": {"reputation": 89, "user_id": 11117567, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/2ea5659e83e94119ebbea24036a8846f?s=128&d=identicon&r=PG", "display_name": "\uff83\uff9e\uff8b\uff9e\uff6f\uff84", "link": "https://stackoverflow.com/users/11117567/%ef%be%83%ef%be%9e%ef%be%8b%ef%be%9e%ef%bd%af%ef%be%84"}, "edited": false, "score": 0, "creation_date": 1553659376, "post_id": 55369474, "comment_id": 97462152, "body": "May be source file path problem which is commonly face in production"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1553659792, "post_id": 55369474, "comment_id": 97462221, "body": "Now, I am not sure what is going down.  I tested in both Chrome and Brave and didn&#39;t work.  I just retested it, after no new commits, and it&#39;s working.  Is this possibly an error on Herokus side? I do not get it"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1553663718, "post_id": 55369474, "comment_id": 97463140, "body": "Are you using Turbolinks?"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1553663761, "post_id": 55369474, "comment_id": 97463154, "body": "@muistooshort yes will that cause errors?"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1553668199, "post_id": 55369474, "comment_id": 97464563, "body": "You don&#39;t use <code>$(document).ready</code> with Turbolinks, you use <code>$(document).on(&#39;turbo links:load&#39;, ...)</code>."}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1553668377, "post_id": 55369474, "comment_id": 97464633, "body": "@muistooshort is it normal that is works now, but didn&#39;t earlier or is it supposed to not work at all unless using <code>$(document).on(&#39;turbo links:load&#39;,</code> ?"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1553705634, "post_id": 55369474, "comment_id": 97487275, "body": "<code>$(document).ready</code> will work with Turbolinks only the first time you hit the site, it won&#39;t work when you switch between pages."}], "answers": [{"comments": [{"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1553660083, "post_id": 55369604, "comment_id": 97462277, "body": "The country is based on their selection.. and btw this isn&#39;t the entire form.... but then based on their country will then appear the currencies they are able to select"}], "tags": [], "owner": {"reputation": 119, "user_id": 8774026, "user_type": "registered", "profile_image": "https://graph.facebook.com/839509936222508/picture?type=large", "display_name": "Gyzimo", "link": "https://stackoverflow.com/users/8774026/gyzimo"}, "is_accepted": false, "score": 0, "last_activity_date": 1553659263, "creation_date": 1553659263, "answer_id": 55369604, "question_id": 55369474, "link": "https://stackoverflow.com/questions/55369474/javascript-onchange-not-working-in-production-but-works-localhost/55369604#55369604", "title": "Javascript .on(&quot;change&quot;,... not working in production, but works localhost", "body": "<p>How are you determining what the users location is ?\nIf it is via a value the user sets in a dashboard then i am not sure. </p>\n\n<p>If however the script requests the info depending on the users location\nit could be a permission error depending if Heroku allows it or not.</p>\n\n<p>If the function works locally then the code works, nothing wrong there.\nTO me that sounds like a permission error of some sort. </p>\n\n<p>If you are able to post some more info about the problem.\nIf possible also the console (error) output, that could be useful. </p>\n"}, {"comments": [{"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1553741178, "post_id": 55385747, "comment_id": 97500340, "body": "Yes, that was messing with it in production and removing the turbo links from the layouts solved that.  Any way to keep turbo links and fix the JS code to adapt to it?"}], "tags": [], "owner": {"reputation": 75, "user_id": 4909131, "user_type": "registered", "profile_image": "https://graph.facebook.com/813417048752638/picture?type=large", "display_name": "Srinidhi Gs", "link": "https://stackoverflow.com/users/4909131/srinidhi-gs"}, "is_accepted": false, "score": 0, "last_activity_date": 1553717777, "creation_date": 1553717777, "answer_id": 55385747, "question_id": 55369474, "link": "https://stackoverflow.com/questions/55369474/javascript-onchange-not-working-in-production-but-works-localhost/55385747#55385747", "title": "Javascript .on(&quot;change&quot;,... not working in production, but works localhost", "body": "<p>This may be a turbolinks issue. You can try</p>\n\n<p>1) Remove the gem 'turbolinks' line from your Gemfile.</p>\n\n<p>2) Remove the //= require turbolinks from your app/assets/javascripts/application.js .</p>\n\n<p>3) Remove the two \"data-turbolinks-track\" => true hash key/value pairs from your app/views/layouts/application.html.erb .</p>\n"}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1553717777, "creation_date": 1553658335, "question_id": 55369474, "link": "https://stackoverflow.com/questions/55369474/javascript-onchange-not-working-in-production-but-works-localhost", "title": "Javascript .on(&quot;change&quot;,... not working in production, but works localhost", "body": "<p><strong>Issue:</strong> My javascript doesn't seem to be functioning on heroku, but does locally.  Although, there is other <strong>javascript</strong> I have on the application that does work.</p>\n\n<p>I am using Bootstrap 4 for CSS mostly.  Majority of my JS is done manually not with the help of Bootstrap.</p>\n\n<p>Here is a form that needs to have information dynamically submitted:</p>\n\n<pre><code>    &lt;form action=\"/bank_accounts\" method=\"POST\" id=\"payment-form-1\"&gt;\n                                        &lt;input type=\"hidden\" name=\"token\" /&gt;\n                                        &lt;div class=\"form-row\" \"form-control\"&gt;\n                                          &lt;label for=\"country\"&gt;Country&lt;/label&gt;\n                                          &lt;select id=\"country\" class=\"form-control form-group\"&gt;\n                                            &lt;option value=\"\"&gt;-- select one -- &lt;/option&gt;\n                                            &lt;option value=\"US\"&gt;United States&lt;/option&gt;\n                                            &lt;option value=\"AU\"&gt;Australia&lt;/option&gt;\n                                            &lt;option value=\"AT\"&gt;Austria&lt;/option&gt;\n                                            &lt;option value=\"BE\"&gt;Belgium&lt;/option&gt;\n                                            &lt;option value=\"CH\"&gt;Switzerland&lt;/option&gt;\n                                            &lt;option value=\"DK\"&gt;Denmark&lt;/option&gt;\n                                            &lt;option value=\"FI\"&gt;Finland&lt;/option&gt;\n                                            &lt;option value=\"LU\"&gt;Luxembourg&lt;/option&gt;\n                                            &lt;option value=\"NL\"&gt;Netherland&lt;/option&gt;\n                                            &lt;option value=\"NO\"&gt;Norway&lt;/option&gt;\n                                            &lt;option value=\"SE\"&gt;Sweden&lt;/option&gt;\n                                            &lt;option value=\"CA\"&gt;Canada&lt;/option&gt;\n                                            &lt;option value=\"FR\"&gt;France&lt;/option&gt;\n                                            &lt;option value=\"DE\"&gt;Germany&lt;/option&gt;\n                                            &lt;option value=\"NZ\"&gt;New Zealand&lt;/option&gt;\n                                            &lt;option value=\"GB\"&gt;United Kingdom&lt;/option&gt;\n                                            &lt;option value=\"ES\"&gt;Spain&lt;/option&gt;\n                                          &lt;/select&gt;\n                                        &lt;/div&gt;\n                                        &lt;div class=\"form-row\"&gt;\n                                          &lt;label for=\"currency\"&gt;Currency&lt;/label&gt;\n                                          &lt;select id=\"currency\" class=\"form-control form-group\"&gt;\n                                            &lt;option value=\"\"&gt;-- select one -- &lt;/option&gt;\n                                          &lt;/select&gt;\n                                        &lt;/div&gt;\n\n&lt;script&gt;\n\n$(document).ready(function() {\n\n    $(\"#country\").change(function() {\n        var val = $(this).val();\n        if (val == \"US\") {\n            $(\"#currency\").html(\"&lt;option value='USD'&gt;US Dollar&lt;/option&gt;\");\n        } else if (val == \"AU\") {\n            $(\"#currency\").html(\"&lt;option value='AUD'&gt;AU Dollar&lt;/option&gt;\");\n        } else if (val == \"GB\") {\n            $(\"#currency\").html(\"&lt;option value='EUR'&gt;Euro&lt;/option&gt;&lt;option value='GBP'&gt;Pound&lt;/option&gt;\");\n        } else if (val == \"CA\") {\n            $(\"#currency\").html(\"&lt;option value='CAD'&gt;Canadian Dollar&lt;/option&gt;&lt;option value='USD'&gt;US Dollar&lt;/option&gt;\");\n        } else if (val == \"DK\") {\n            $(\"#currency\").html(\"&lt;option value='EUR'&gt;Euro&lt;/option&gt;&lt;option value='DKK'&gt;Danish Krone&lt;/option&gt;\");\n        } else if (val == \"NO\") {\n            $(\"#currency\").html(\"&lt;option value='EUR'&gt;Euro&lt;/option&gt;&lt;option value='NOK'&gt;Norwegian Krona&lt;/option&gt;\");\n        } else if (val == \"SE\") {\n            $(\"#currency\").html(\"&lt;option value='EUR'&gt;Euro&lt;/option&gt;&lt;option value='SEK'&gt;Swedish Krona&lt;/option&gt;\");\n        } else if (val == \"CH\") {\n            $(\"#currency\").html(\"&lt;option value='EUR'&gt;Euro&lt;/option&gt;&lt;option value='CHF'&gt;Swiss Franc&lt;/option&gt;\");\n        } else if (val == \"NZ\") {\n            $(\"#currency\").html(\"&lt;option value='NZD'&gt;NZ Dollar&lt;/option&gt;\");\n        } else if (val == \"AT\" || \"BE\" || \"FR\" || \"FI\" || \"GE\" || \"IE\" || \"NL\" || \"PT\" || \"ES\" || \"LU\") {\n            $(\"#currency\").html(\"&lt;option value='EUR'&gt;Euro&lt;/option&gt;\");\n        }\n    });\n});\n\n&lt;/script&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "cron", "whenever"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1553657505, "post_id": 55369109, "comment_id": 97461798, "body": "<code>#match?</code> is a new method, so it is almost certain that root is not executing the same Ruby that you are (though it seems bundler is being executed from 2.6&#39;s gem library). Are you using RVM or similar?"}, {"owner": {"reputation": 2666, "user_id": 583608, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7mLIJ.png?s=128&g=1", "display_name": "ToothlessRebel", "link": "https://stackoverflow.com/users/583608/toothlessrebel"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1553657592, "post_id": 55369109, "comment_id": 97461812, "body": "Does cron run as root? I believed it ran as the user to which the crontab belonged. I am not using RVM or rbenv. I can check what happens if I try and run the task as root, I think."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1553657742, "post_id": 55369109, "comment_id": 97461849, "body": "Ah. Not sure, I thought it&#39;s the user who the executable belongs to. Maybe I&#39;m wrong, been a while since I looked at it. Still, it would be good to do <code>x x x x x ruby --version &gt; &#47;tmp&#47;rubyver.txt</code> or something to see what&#39;s happening. Even better, <code>x x x x x &#47;bin&#47;bash -l -c &#39;&#47;usr&#47;local&#47;bin&#47;bundle exec ruby --version  &gt; &#47;tmp&#47;rubyver.txt&#39;</code>, to match your case more."}, {"owner": {"reputation": 2666, "user_id": 583608, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7mLIJ.png?s=128&g=1", "display_name": "ToothlessRebel", "link": "https://stackoverflow.com/users/583608/toothlessrebel"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1553657759, "post_id": 55369109, "comment_id": 97461852, "body": "@Amadan As root <code>ruby -v</code> shows <code>ruby 2.6.1p33 (2019-01-30 revision 66950) [x86_64-linux]</code> which matches my own"}, {"owner": {"reputation": 2666, "user_id": 583608, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7mLIJ.png?s=128&g=1", "display_name": "ToothlessRebel", "link": "https://stackoverflow.com/users/583608/toothlessrebel"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1553658208, "post_id": 55369109, "comment_id": 97461933, "body": "@Amadan via cron it logs ruby 2.3.1.p112 so you were right. Now I just need to determine why."}], "answers": [{"tags": [], "owner": {"reputation": 2666, "user_id": 583608, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7mLIJ.png?s=128&g=1", "display_name": "ToothlessRebel", "link": "https://stackoverflow.com/users/583608/toothlessrebel"}, "is_accepted": true, "score": 1, "last_activity_date": 1553662545, "creation_date": 1553662545, "answer_id": 55370048, "question_id": 55369109, "link": "https://stackoverflow.com/questions/55369109/why-does-rake-task-not-run-via-cron/55370048#55370048", "title": "Why does rake task not run via cron?", "body": "<p>I ended up changing the PATH variable used so that /usr/local/bin/ruby was used rather than /usr/bin/ruby. I did it by modifying the code found <a href=\"https://benscheirman.com/2013/12/using-rbenv-in-cron-jobs/\" rel=\"nofollow noreferrer\">here</a> to this result in <code>schedule.rb</code>:</p>\n\n<pre><code>job_type :rake, %Q{export PATH=/usr/local/sbin:/usr/sbin:/sbin:/usr/local/bin:/usr/bin:/bin; cd :path &amp;&amp; :environment_variable=:environment bundle exec rake :task --silent :output}\n</code></pre>\n\n<p>This brought the versions being used by cron and my users in line.</p>\n"}], "owner": {"reputation": 2666, "user_id": 583608, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7mLIJ.png?s=128&g=1", "display_name": "ToothlessRebel", "link": "https://stackoverflow.com/users/583608/toothlessrebel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 55370048, "answer_count": 1, "score": 1, "last_activity_date": 1553662545, "creation_date": 1553655440, "question_id": 55369109, "link": "https://stackoverflow.com/questions/55369109/why-does-rake-task-not-run-via-cron", "title": "Why does rake task not run via cron?", "body": "<p>I have defined a task such that running <code>rake background:fetch_image</code> as my user works as expected. It also works as expected if I run <code>sudo -u www-data rake background:fetch_image</code>. I do not believe the error I shall describe is caused by code I wrote in the task itself.</p>\n\n<p>I am using the <em>whenever</em> gem to handle scheduling. After setting some variables to correct previous errors <em>whenever</em> is producing a line in the crontab like:</p>\n\n<pre><code>0 2 * * * /bin/bash -l -c 'cd /var/www/site &amp;&amp; RAILS_ENV=production /usr/local/bin/bundle exec rake background:fetch_image --silent &gt;&gt; /var/www/site/log/whenever.log 2&gt;&amp;1'\n</code></pre>\n\n<p>When cron executes this I get this error:</p>\n\n<pre><code>/usr/local/lib/ruby/2.6.0/pathname.rb:43:in `chop_basename': undefined method `match?' for /\\A(?-mix:\\/)?\\z/:Regexp (NoMethodError)\nDid you mean?  match\n        from /usr/local/lib/ruby/2.6.0/pathname.rb:359:in `plus'\n        from /usr/local/lib/ruby/2.6.0/pathname.rb:351:in `+'\n        from /usr/local/lib/ruby/2.6.0/pathname.rb:188:in `parent'\n        from /usr/local/lib/ruby/2.6.0/bundler/shared_helpers.rb:29:in `root'\n        from /usr/local/lib/ruby/2.6.0/bundler.rb:234:in `root'\n        from /usr/local/lib/ruby/2.6.0/bundler.rb:246:in `app_config_path'\n        from /usr/local/lib/ruby/2.6.0/bundler.rb:273:in `settings'\n        from /usr/local/lib/ruby/2.6.0/bundler.rb:84:in `configured_bundle_path'\n        from /usr/local/lib/ruby/2.6.0/bundler.rb:351:in `use_system_gems?'\n        from /usr/local/lib/ruby/2.6.0/bundler.rb:541:in `configure_gem_path'\n        from /usr/local/lib/ruby/2.6.0/bundler.rb:534:in `configure_gem_home_and_path'\n        from /usr/local/lib/ruby/2.6.0/bundler.rb:66:in `configure'\n        from /usr/local/lib/ruby/2.6.0/bundler.rb:134:in `definition'\n        from /usr/local/lib/ruby/2.6.0/bundler.rb:101:in `setup'\n        from /usr/local/lib/ruby/2.6.0/bundler/setup.rb:20:in `&lt;top (required)&gt;'\n        from /usr/local/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n        from /usr/local/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n</code></pre>\n\n<p>This error only occurs when the task is run via cron in this manner.\nI have tried including solutions that extend the <code>PATH</code> variable and perform an <code>rbenv init</code> but none corrected this issue.</p>\n\n<p>Why is it that cron behaves so differently as to cause this error and how might it be fixed?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "model-view-controller", "activerecord"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1553654511, "post_id": 55368901, "comment_id": 97461160, "body": "They are essentially the same thing, but probably it&#39;s better to call the <code>convert</code> method from the job, because it gives you the option of calling it from elsewhere as well, should you come across that need."}, {"owner": {"reputation": 798, "user_id": 652779, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bfdf2256663085a64c468c4b4c0f62f4?s=128&d=identicon&r=PG", "display_name": "Lomefin", "link": "https://stackoverflow.com/users/652779/lomefin"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1553654876, "post_id": 55368901, "comment_id": 97461247, "body": "Yes, but increasing its complexity, what if the raw_data could come from different providers? In that case a converter would be better or it should include a converter in that moment?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1553659941, "post_id": 55368901, "comment_id": 97462247, "body": "i dunno. when you look at it that closely you&#39;re getting into the land of a thousand design patterns. It&#39;s really subjective"}, {"owner": {"reputation": 9735, "user_id": 625184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d61e61fa593df732de1ccaad37ea4f59?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/625184/jon"}, "edited": false, "score": 1, "creation_date": 1553670303, "post_id": 55368901, "comment_id": 97465401, "body": "Another option to consider is using a service object to do the conversion, called by the job, which then updates the model with the result."}], "owner": {"reputation": 798, "user_id": 652779, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bfdf2256663085a64c468c4b4c0f62f4?s=128&d=identicon&r=PG", "display_name": "Lomefin", "link": "https://stackoverflow.com/users/652779/lomefin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553653854, "creation_date": 1553653854, "question_id": 55368901, "link": "https://stackoverflow.com/questions/55368901/activemodel-responsability-for-conversion", "title": "ActiveModel responsability for conversion", "body": "<p>I have a Rails application that captures information from an external datasource. This information gets collected into a <code>raw_data</code> attribute, saved and an ActiveJob in charge of doing the processing is scheduled.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>capture = Capture.create(raw_data: data)\nProcessCaptureJob.perform_later(capture)\n</code></pre>\n\n<p>The data processing is done later in an offline process, the issue is: Who is in charge of doing the conversion?</p>\n\n<p>The Model?</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def convert\n  update(attr1: raw_data['attr1a'] + raw_data['attr1b']\nend\n</code></pre>\n\n<p>Or the Job?</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def perform(capture)\n  capture.attr1 = capture.raw_data['attr1a'] + capture.raw_data['attr1b']\n  capture.save\nend\n</code></pre>\n\n<p>The idea behind ActiveModel is that the Model is responsible of all of its data-related use cases, but is this a data-related issue or it's better to leave that responsability to an external job?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1553654618, "post_id": 55368865, "comment_id": 97461185, "body": "Have you tried to define a separate <code>correct_user</code> filter on the reviews controller?"}, {"owner": {"reputation": 555, "user_id": 10813827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b736f8f0de40f55f19c595a02be8b667?s=128&d=identicon&r=PG&f=1", "display_name": "k10a", "link": "https://stackoverflow.com/users/10813827/k10a"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1553654848, "post_id": 55368865, "comment_id": 97461241, "body": "Ah, I will try thanks."}, {"owner": {"reputation": 555, "user_id": 10813827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b736f8f0de40f55f19c595a02be8b667?s=128&d=identicon&r=PG&f=1", "display_name": "k10a", "link": "https://stackoverflow.com/users/10813827/k10a"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1553659131, "post_id": 55368865, "comment_id": 97462104, "body": "I have defined <code>correct_user</code> on the reviews controller. I could not do that."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1553659734, "post_id": 55368865, "comment_id": 97462214, "body": "What do you mean you could not do that? Can you edit your question to show your attempt?"}, {"owner": {"reputation": 555, "user_id": 10813827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b736f8f0de40f55f19c595a02be8b667?s=128&d=identicon&r=PG&f=1", "display_name": "k10a", "link": "https://stackoverflow.com/users/10813827/k10a"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1553662967, "post_id": 55368865, "comment_id": 97462939, "body": "Sorry I added @maxpleaner"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1553665797, "post_id": 55368865, "comment_id": 97463731, "body": "Why are you using the <code>include</code> method there? Why not just compare with <code>==</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 555, "user_id": 10813827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b736f8f0de40f55f19c595a02be8b667?s=128&d=identicon&r=PG&f=1", "display_name": "k10a", "link": "https://stackoverflow.com/users/10813827/k10a"}, "edited": false, "score": 0, "creation_date": 1554342273, "post_id": 55373873, "comment_id": 97719012, "body": "Thanks I&#39;ll do that :)"}], "tags": [], "owner": {"reputation": 1113, "user_id": 4701098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4QnL4.jpg?s=128&g=1", "display_name": "Samy Kacimi", "link": "https://stackoverflow.com/users/4701098/samy-kacimi"}, "is_accepted": false, "score": 0, "last_activity_date": 1553679273, "creation_date": 1553679273, "answer_id": 55373873, "question_id": 55368865, "link": "https://stackoverflow.com/questions/55368865/error-filter-chain-halted-as-correct-user-rendered-or-redirected/55373873#55373873", "title": "Error: Filter chain halted as :correct_user rendered or redirected", "body": "<p>If you want to verify that the user has written the review, why not compare like this:</p>\n\n<pre><code>@review.user == current_user\n</code></pre>\n\n<p>By the way, this is an authorization verification, so if the user does not have the right to edit the review, you should return a 403 (Forbidden) instead of a redirect.</p>\n\n<p>Gems like pundit or cancancan may help you doing that properly</p>\n"}], "owner": {"reputation": 555, "user_id": 10813827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b736f8f0de40f55f19c595a02be8b667?s=128&d=identicon&r=PG&f=1", "display_name": "k10a", "link": "https://stackoverflow.com/users/10813827/k10a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 443, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553679273, "creation_date": 1553653551, "last_edit_date": 1553662955, "question_id": 55368865, "link": "https://stackoverflow.com/questions/55368865/error-filter-chain-halted-as-correct-user-rendered-or-redirected", "title": "Error: Filter chain halted as :correct_user rendered or redirected", "body": "<p>I'm working on review applications. In this app, users can post their own project and other users review to it. But I faced this error when other users try to edit their own reviews. To edit a project is only allowed to project owners. But to edit reviews should be allowed to users who wrote its review.</p>\n\n<p>How can I divide this authentication?</p>\n\n<p><code>/controllers/projects_controller.rb</code></p>\n\n<pre><code>class ProjectsController &lt; ApplicationController\n  before_action :signed_in_user, only: [:new, :create, :edit, :update, :destroy]\n  before_action :set_project, only: [:show, :edit, :update]\n  before_action :correct_user, only: [:edit, :update]\n\n  def edit\n  end\n\n  def update\n    @project.attributes = create_params\n    if @project.save\n      redirect_to @project\n    else\n      render edit_project_path(id: @project.id)\n    end\n  end\n\n  private\n\n  def signed_in_user\n    unless user_signed_in?\n      redirect_to root_path\n    end\n  end\n\n  def set_project\n    @project = Project.find_by_id(params[:id])\n  end\n\n  def correct_user\n    unless current_user.projects.include?(@user)\n      redirect_to root_path\n    end\n  end\nend\n</code></pre>\n\n<p><code>/controllers/reviews_controller.rb</code></p>\n\n<pre><code>class ReviewsController &lt; ApplicationController\n  before_action :set_projectct, only: [:new, :create, :edit, :update]\n  before_action :set_review, only: [:edit, :update, :destroy]\n  before_action :correct_user, only: [:edit, :update]\n\n  def edit\n  end\n\n  def update\n    @review.attributes = create_params\n    if @reviews.save\n      redirect_to prokect_path(id: @review.project_id)\n    else\n      redirect_to project_path(id: @review.project_id)\n    end\n  end\n\n  def set_project\n    @project = Project.find_by_id(params[:project_id])\n  end\n\n  def set_review\n    @review = Review.find_by_id(params[:id])\n  end\n\n  def correct_user\n    unless current_user.review.include?(@review)\n      redirect_to root_path\n    end\n  end\nend\n</code></pre>\n\n<p><code>routes.rb</code></p>\n\n<pre><code>resources :projects do\n  resources :reviews\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "edited": false, "score": 0, "creation_date": 1553654582, "post_id": 55368770, "comment_id": 97461171, "body": "Do you have a <code>article</code> model?."}, {"owner": {"reputation": 3, "user_id": 11099477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e791369b6900fa232e95ec1bb9b58c6d?s=128&d=identicon&r=PG&f=1", "display_name": "markus902", "link": "https://stackoverflow.com/users/11099477/markus902"}, "reply_to_user": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "edited": false, "score": 0, "creation_date": 1553655405, "post_id": 55368770, "comment_id": 97461361, "body": "Yes, it is empty though."}, {"owner": {"reputation": 3, "user_id": 11099477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e791369b6900fa232e95ec1bb9b58c6d?s=128&d=identicon&r=PG&f=1", "display_name": "markus902", "link": "https://stackoverflow.com/users/11099477/markus902"}, "reply_to_user": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "edited": false, "score": 0, "creation_date": 1553655501, "post_id": 55368770, "comment_id": 97461381, "body": "```class Article &lt; ApplicationRecord end````"}, {"owner": {"reputation": 3, "user_id": 11099477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e791369b6900fa232e95ec1bb9b58c6d?s=128&d=identicon&r=PG&f=1", "display_name": "markus902", "link": "https://stackoverflow.com/users/11099477/markus902"}, "reply_to_user": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "edited": false, "score": 0, "creation_date": 1553655809, "post_id": 55368770, "comment_id": 97461445, "body": "<a href=\"http://tutorials.jumpstartlab.com/projects/blogger.html\" rel=\"nofollow noreferrer\">tutorials.jumpstartlab.com/projects/blogger.html</a>  That is the task I am working on."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1553720018, "post_id": 55368770, "comment_id": 97494407, "body": "&quot;When I run Article.string&quot; - why? What did you expect to happen?"}, {"owner": {"reputation": 3, "user_id": 11099477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e791369b6900fa232e95ec1bb9b58c6d?s=128&d=identicon&r=PG&f=1", "display_name": "markus902", "link": "https://stackoverflow.com/users/11099477/markus902"}, "edited": false, "score": 0, "creation_date": 1553827783, "post_id": 55368770, "comment_id": 97539747, "body": "It should at least ouput nil, but it looks like, the column for title and body are no even defined (see below)"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9299264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23e0acc03a03b430c21e7cf80c9137a?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/9299264/james"}, "is_accepted": false, "score": 0, "last_activity_date": 1553658549, "last_edit_date": 1553658549, "creation_date": 1553657844, "answer_id": 55369418, "question_id": 55368770, "link": "https://stackoverflow.com/questions/55368770/nomethoderror-when-modifying-database/55369418#55369418", "title": "NoMethodError when modifying database", "body": "<p>try this command</p>\n\n<pre><code>rails g model Article title:string body:text\n</code></pre>\n\n<p>But i think the problem is with the method <code>Article.string</code> you mentioned though. Could it be that you mean to do the <code>Article.all</code> instead to query all records from the articles table from the database?</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 11099477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e791369b6900fa232e95ec1bb9b58c6d?s=128&d=identicon&r=PG&f=1", "display_name": "markus902", "link": "https://stackoverflow.com/users/11099477/markus902"}, "edited": false, "score": 0, "creation_date": 1553828325, "post_id": 55385639, "comment_id": 97539871, "body": "irb(main):001:0&gt; Article.new  =&gt; #&lt;Article id: nil, created_at: nil, updated_at: nil&gt; irb(main):002:0&gt; Article.title Traceback (most recent call last):         1: from (irb):2 NoMethodError (undefined method `title&#39; for Article(id: in teger, created_at: datetime, updated_at: datetime):Class) irb(main):003:0&gt; article = Article.new =&gt; #&lt;Article id: nil, created_at: nil, updated_at: nil&gt; irb(main):004:0&gt; article.title =&gt; nil Traceback (most recent call last): SyntaxError ((irb):4: syntax error, unexpected =&gt;, expecti ng end-of-input) article.title =&gt; nil               ^~"}], "tags": [], "owner": {"reputation": 75, "user_id": 4909131, "user_type": "registered", "profile_image": "https://graph.facebook.com/813417048752638/picture?type=large", "display_name": "Srinidhi Gs", "link": "https://stackoverflow.com/users/4909131/srinidhi-gs"}, "is_accepted": false, "score": 0, "last_activity_date": 1553717325, "creation_date": 1553717325, "answer_id": 55385639, "question_id": 55368770, "link": "https://stackoverflow.com/questions/55368770/nomethoderror-when-modifying-database/55385639#55385639", "title": "NoMethodError when modifying database", "body": "<p>Run</p>\n\n<p><code>article = Article.new\n article.title =&gt; nil</code> </p>\n\n<p><code>article = Article.new\n article.title = 'Your name' \n article.body = 'Some text'\n article.save</code></p>\n\n<p>Because title can be accessed by any instance of an Article using ORM.</p>\n\n<p>Here string is an data type for your column title. Not an method</p>\n\n<p>PS: Please run rake db:migrate if it gives migration error. </p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 11099477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e791369b6900fa232e95ec1bb9b58c6d?s=128&d=identicon&r=PG&f=1", "display_name": "markus902", "link": "https://stackoverflow.com/users/11099477/markus902"}, "is_accepted": false, "score": 0, "last_activity_date": 1555215625, "creation_date": 1555215625, "answer_id": 55671940, "question_id": 55368770, "link": "https://stackoverflow.com/questions/55368770/nomethoderror-when-modifying-database/55671940#55671940", "title": "NoMethodError when modifying database", "body": "<p>Thanks to all. For some reason downgrading the ruby version fixed the issue.</p>\n"}], "owner": {"reputation": 3, "user_id": 11099477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e791369b6900fa232e95ec1bb9b58c6d?s=128&d=identicon&r=PG&f=1", "display_name": "markus902", "link": "https://stackoverflow.com/users/11099477/markus902"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1555215625, "creation_date": 1553652754, "last_edit_date": 1553679511, "question_id": 55368770, "link": "https://stackoverflow.com/questions/55368770/nomethoderror-when-modifying-database", "title": "NoMethodError when modifying database", "body": "<p>I am doing a beginners exercise for rails. I am creating an app that creates a new article in the database. I have:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class CreateArticles &lt; ActiveRecord::Migration[5.2]\n  def change\n    create_table :articles do |t|\n      t.string :title\n      t.text :body\n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>When I run <code>Article.string</code>, I get the following message:</p>\n\n<pre><code>NoMethodError (undefined method `title=' for #&lt;Article:0x00007f8d5d4d6100&gt;)\n</code></pre>\n\n<p>The app does not seem to recognise the methods <code>string</code> and <code>text</code>.\nI am using ruby 2.5.3 . The tutorial uses 2.2 . Could this be the issue Any thoughts on that?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 1, "creation_date": 1553652041, "post_id": 55368632, "comment_id": 97460732, "body": "Welcome to SO! I&#39;m afraid this code has a few syntax errors, and the scattered indentation isn&#39;t helpful. At the very least, you&#39;re missing a final <code>end</code> keyword and a closing parenthesis, but then you&#39;re trying to define a method as a parameter to a function, which doesn&#39;t make sense. Can you clarify your intent?"}, {"owner": {"reputation": 27, "user_id": 11257686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c92fe650052f8870c25e9d03d51a805?s=128&d=identicon&r=PG&f=1", "display_name": "powwu", "link": "https://stackoverflow.com/users/11257686/powwu"}, "reply_to_user": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1553652415, "post_id": 55368632, "comment_id": 97460783, "body": "hello @ggorlen ! Looking back at my code, I now see that I&#39;m missing an end keyword and a closing parenthesis. However, I don&#39;t understand what the rest of that sentence means. Could you please explain it in simple person terms so I can learn from it? Thank you so much!!"}, {"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1553652924, "post_id": 55368632, "comment_id": 97460873, "body": "No problem. You can&#39;t do this: <code>call_my_function(def MyClass end)</code> which is essentially what is going on here. The closing parenthesis for <code>dialog.directory() #&lt;-</code> needs to be here."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1553673559, "post_id": 55368632, "comment_id": 97466837, "body": "What is Robocop in this context? I know the movie, but it doesn&#39;t seem like you are mentioning that."}, {"owner": {"reputation": 27, "user_id": 11257686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c92fe650052f8870c25e9d03d51a805?s=128&d=identicon&r=PG&f=1", "display_name": "powwu", "link": "https://stackoverflow.com/users/11257686/powwu"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1553682994, "post_id": 55368632, "comment_id": 97472261, "body": "@sawa did I say robocop? my apologies! I meant to say rubocop."}], "answers": [{"tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": true, "score": 3, "last_activity_date": 1553672179, "last_edit_date": 1553672179, "creation_date": 1553671751, "answer_id": 55371868, "question_id": 55368632, "link": "https://stackoverflow.com/questions/55368632/why-is-my-program-given-an-unexpected-token-end-error/55371868#55371868", "title": "Why is my program given an unexpected token: $end error?", "body": "<p>Actually, Rubocop is not even able to parse the file, because it has syntax errors. </p>\n\n<p>The error message <code>syntax error: unexpected token $end</code> means that the ruby parser was parsing along happily, but then it suddenly encountered an <code>$end</code>, which is the parser's way to say \"the end of the file\". It was expecting more code, but instead it found the end of the file.  </p>\n\n<p>This is what your code looks like with proper indentation:</p>\n\n<pre><code>#When convert button is pressed\nFile.rename(\"*.osz\", \"*.zip$\")\n\ndialog.directory(\n\n  def extract_zip(file, destination) FileUtils.mkdir_p(destination)\n\n    file_path = \"./convert_temp/*.zip\"\n    destination = \"./convert_temp/osz/\"\n\n    extract_zip(file_path, destination)\n\n    until File.exists?( \".osu$\" ) == false do\n      File.rename(\"./convert_temp/osz/*.osu$\", \"*.txt$\")\n      File.foreach(filename) do |file|\n\n        file_string = File.read('./convert_temp/osz/*.txt$')\n\n        if file_string.include?('Mode: 1')\n          puts 'Yes'\n        else\n          puts 'No'\n        end\n      end\n    end\n</code></pre>\n\n<p>Using this kind of indentation makes it easy to see that there are some missing ends/parentheses, because the last line is left hanging in the air instead of closing back to the left edge where it started from.</p>\n\n<p><strong>Additional notes:</strong></p>\n\n<pre><code>dialog.directory(\n\n  def extract_zip(file, destination) FileUtils.mkdir_p(destination)\n</code></pre>\n\n<p>It's very unconventional to define a new method inside a method call. <code>File.open(def hello_world(..))</code> Doesn't make a lot of sense.</p>\n\n<pre><code>until File.exists?( \".osu$\" ) == false do\n</code></pre>\n\n<p>Are you using <code>$</code> as a way to indicate \"filename ends in .osu\"? If yes, it does not work like that. This would look for a file that has <code>.osu$</code> as name. </p>\n\n<pre><code>  File.foreach(filename) do |file|\n</code></pre>\n\n<p>The <code>file</code> parameter is not used in the block that follows, you use <code>file_string</code>. </p>\n\n<pre><code>    file_string = File.read('./convert_temp/osz/*.txt$')\n</code></pre>\n\n<p>You can't read multiple files at once like that. Also, <code>File.foreach</code> above would read the file line by line, so here you are trying to read it again, inside the loop that is reading it already.</p>\n"}], "owner": {"reputation": 27, "user_id": 11257686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c92fe650052f8870c25e9d03d51a805?s=128&d=identicon&r=PG&f=1", "display_name": "powwu", "link": "https://stackoverflow.com/users/11257686/powwu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3231, "favorite_count": 0, "accepted_answer_id": 55371868, "answer_count": 1, "score": -4, "last_activity_date": 1553673542, "creation_date": 1553651531, "last_edit_date": 1553673542, "question_id": 55368632, "link": "https://stackoverflow.com/questions/55368632/why-is-my-program-given-an-unexpected-token-end-error", "title": "Why is my program given an unexpected token: $end error?", "body": "<p>Here is my unfinished code:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>#When convert button is pressed\nFile.rename(\"*.osz\", \"*.zip$\")\n\ndialog.directory(\n\n    def extract_zip(file, destination) FileUtils.mkdir_p(destination)\n\n    file_path = \"./convert_temp/*.zip\"\n    destination = \"./convert_temp/osz/\"\n\n    extract_zip(file_path, destination)\n\nuntil File.exists?( \".osu$\" ) == false do\n  File.rename(\"./convert_temp/osz/*.osu$\", \"*.txt$\")\n  File.foreach(filename) do |file|\n\n  file_string = File.read('./convert_temp/osz/*.txt$')\n\n  if file_string.include?('Mode: 1')\n    puts 'Yes'\n  else\n    puts 'No'\n  end\nend\nend\n</code></pre>\n\n<p>Robocop giving the following syntax error:</p>\n\n<pre><code>unexpected token $end (Using Ruby 2.2 parser; configure using `TargetRubyVersion` parameter, under `AllCops`)\n</code></pre>\n"}, {"tags": ["ruby", "chef-infra"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1553678138, "post_id": 55368018, "comment_id": 97469327, "body": "What is your question?"}, {"owner": {"reputation": 420, "user_id": 5610398, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/1666359996977941/picture?type=large", "display_name": "Bao Thai", "link": "https://stackoverflow.com/users/5610398/bao-thai"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1553704129, "post_id": 55368018, "comment_id": 97486388, "body": "@sawa sorry, my question is how to fix this issue without using Chef 12.6.0?"}], "owner": {"reputation": 420, "user_id": 5610398, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/1666359996977941/picture?type=large", "display_name": "Bao Thai", "link": "https://stackoverflow.com/users/5610398/bao-thai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 577, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553706586, "creation_date": 1553645922, "last_edit_date": 1553706586, "question_id": 55368018, "link": "https://stackoverflow.com/questions/55368018/opensslsslsslerror-ssl-connect-returned-1-errno-0-state-sslv2-v3-read-serve", "title": "OpenSSL::SSL::SSLError: SSL_connect returned=1 errno=0 state=SSLv2/v3 read server hello", "body": "<p>I am trying to pull a binary from our repo in Artifactory that is of HTTPS. </p>\n\n<pre><code>/var/chef/cookbooks/app/providers/setup.rb:48:in `determineRepoURL'\n/var/chef/cookbooks/app/providers/setup.rb:86:in `deploy_compile_time_config_application'\n/var/chef/cookbooks/app/providers/setup.rb:24:in `block (2 levels) in class_from_file'\n/var/chef/cookbooks/app/providers/setup.rb:20:in `block in class_from_file'\n...\n\n[2019-03-26T17:11:39-07:00] ERROR: Running exception handlers\n[2019-03-26T17:11:39-07:00] ERROR: Exception handlers complete\n[2019-03-26T17:11:39-07:00] FATAL: Stacktrace dumped to /var/chef/cache/chef-stacktrace.out\nChef Client failed. 5 resources updated\n[2019-03-26T17:11:39-07:00] ERROR: app_setup[test] (app::default line 40) had an error: OpenSSL::SSL::SSLError: SSL_connect returned=1 errno=0 state=SSLv3 read server hello A: tlsv1 alert protocol version\n</code></pre>\n\n<p>Previously I had</p>\n\n<pre><code>def determineRepoURL(*param)\n        url = \"#{repository_url}/api/search/pattern?pattern=#{param[0]}:#{name}/#{version}/*#{param[1]}\"\n        uri = URI(url)\n        http = Net::HTTP.new(uri.host, uri.port)\n        request = Net::HTTP::Get.new(uri.request_uri)\n        request.basic_auth \"#{user}\", \"#{token}\"\n        response = http.request request # Net::HTTPResponse object\n        result = JSON.parse(response.body)\n        list = result['files'].sort.reverse\n        return list[0]\nend\n</code></pre>\n\n<p>after adding</p>\n\n<pre><code>        http.use_ssl = true\n        http.verify_mode = OpenSSL::SSL::VERIFY_NONE\n</code></pre>\n\n<p>I still have the same error. However, for some reason, this only happens on Chef's 11.8.2, I tried my script with Chef's 12.6.0 and I did not encounter this SSL certificate issue, does anyone have a bypass for 11.8.2 as I do not have access to 12.6.0</p>\n\n<p>Ruby version: 1.8.7</p>\n\n<p>OpenSSL version: OpenSSL 1.0.1e-fips 11 Feb 2013</p>\n"}, {"tags": ["ruby", "import", "require", "standard-library"], "comments": [{"owner": {"reputation": 5513, "user_id": 2718801, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9d4b144cdafa73e1d470362ed8d7c3a9?s=128&d=identicon&r=PG", "display_name": "jhpratt", "link": "https://stackoverflow.com/users/2718801/jhpratt"}, "edited": false, "score": 0, "creation_date": 1553642650, "post_id": 55367547, "comment_id": 97458770, "body": "As far as I&#39;m aware, Ruby doesn&#39;t lazy-load libraries, so there would definitely be some overhead. With regard to a standard library, I presume Ruby ships them as dylibs (though that&#39;s a guess), so there would be very little overhead."}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 2, "last_activity_date": 1553644594, "creation_date": 1553644594, "answer_id": 55367866, "question_id": 55367547, "link": "https://stackoverflow.com/questions/55367547/does-requiring-from-the-standard-library-make-a-program-slower/55367866#55367866", "title": "Does requiring from the standard library make a program slower?", "body": "<p>Importing a library will take a non-zero amount of time, but the amount of time is directly proportional to what library. Some are very small, some much larger, but all of the ones that ship with Ruby are usually quick to load.</p>\n\n<p>Unless you're running your script a thousand times a second the impact of a <code>require</code> is going to be minimal.</p>\n\n<p>It's usually better to get all the <code>require</code> operations out of the way as early as possible to shake out any dependency problems, especially with gems. There's nothing worse than code that crashes because of a broken dependency, but only when you perform a particular action that doesn't happen often.</p>\n\n<p>If you are starting this process thousands of times over, consider a tool like <a href=\"https://github.com/rails/spring\" rel=\"nofollow noreferrer\">Spring</a> or your own forking model to avoid the startup penalty. You can <code>fork</code> a pre-configured process any number of times, each of which will be ready nearly instantaneously.</p>\n"}, {"tags": [], "owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "is_accepted": false, "score": 0, "last_activity_date": 1553646367, "last_edit_date": 1592644375, "creation_date": 1553645032, "answer_id": 55367904, "question_id": 55367547, "link": "https://stackoverflow.com/questions/55367547/does-requiring-from-the-standard-library-make-a-program-slower/55367904#55367904", "title": "Does requiring from the standard library make a program slower?", "body": "<p>When using <code>require</code> you are telling Ruby to load some file (your own file, standard library or external library).</p>\n<p>So yes, it takes time to find and load it.</p>\n<p>But the required file is loading <a href=\"http://ruby-doc.org/core-2.6.1/Kernel.html#method-i-require\" rel=\"nofollow noreferrer\">only once</a> (usually at start because usually <code>require</code> at the top of file).</p>\n<blockquote>\n<p>Loads the given <code>name</code>, returning <code>true</code> if successful and <code>false</code> if the feature is already loaded.</p>\n<p>The absolute path of the loaded file is added to <code>$LOADED_FEATURES</code> (<code>$&quot;</code>). A file will not be loaded again if its path already appears in <code>$&quot;</code></p>\n</blockquote>\n<p>And the time spent depends on the file size and the size of the associated files.</p>\n"}], "owner": {"reputation": 4220, "user_id": 1661012, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/abc04c76810d98405fc0f27f96c6c5e5?s=128&d=identicon&r=PG", "display_name": "user137369", "link": "https://stackoverflow.com/users/1661012/user137369"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 55367866, "answer_count": 2, "score": 1, "last_activity_date": 1553646367, "creation_date": 1553642300, "question_id": 55367547, "link": "https://stackoverflow.com/questions/55367547/does-requiring-from-the-standard-library-make-a-program-slower", "title": "Does requiring from the standard library make a program slower?", "body": "<p>I\u2019m thinking of ruby specifically when I ask this question, but if the answer is language-agnostic, I\u2019d like to know as well.</p>\n\n<p>I often <code>require</code> from the ruby standard library, namely <code>fileutils</code>, <code>open3</code>, and <code>pathname</code>.</p>\n\n<p>But if I only need to use their capabilities in one or two lines, I avoid them and go for (sometimes less readable) alternatives that don\u2019t need a <code>require</code>.</p>\n\n<p>However, using them doesn\u2019t appear to hurt performance of my scripts, and even with quick benchmarks (using <code>time</code>), things seem to run at the same speed they would if I used different methods. But it seems weird to me it would make no difference, because why then have them be <code>require</code>d for use (and not just included outright)? So, specific questions:</p>\n\n<ol>\n<li>Does importing from the standard library make scripts slower?</li>\n<li>If so, is it always negligible, or does it depend on the package?</li>\n<li>What about third-party packages? Are they slower to import than the ones in the standard library?</li>\n</ol>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "edited": false, "score": 0, "creation_date": 1553644823, "post_id": 55367519, "comment_id": 97459307, "body": "ur route file has name conflict"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1553646978, "post_id": 55367519, "comment_id": 97459762, "body": "Please add the stack trace to your question."}, {"owner": {"reputation": 61, "user_id": 9181859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ec0fe441827f1afe3dba7cb02cec181?s=128&d=identicon&r=PG&f=1", "display_name": "NB1962", "link": "https://stackoverflow.com/users/9181859/nb1962"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1553650354, "post_id": 55367519, "comment_id": 97460422, "body": "@jvillian added the stack trace."}, {"owner": {"reputation": 61, "user_id": 9181859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ec0fe441827f1afe3dba7cb02cec181?s=128&d=identicon&r=PG&f=1", "display_name": "NB1962", "link": "https://stackoverflow.com/users/9181859/nb1962"}, "reply_to_user": {"reputation": 6361, "user_id": 2097529, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QnP8n.jpg?s=128&g=1", "display_name": "Kick Buttowski", "link": "https://stackoverflow.com/users/2097529/kick-buttowski"}, "edited": false, "score": 0, "creation_date": 1553650361, "post_id": 55367519, "comment_id": 97460424, "body": "@Kick Buttowski what is the conflict with route file?"}, {"owner": {"reputation": 2501, "user_id": 1859956, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rgRBJ.jpg?s=128&g=1", "display_name": "emi", "link": "https://stackoverflow.com/users/1859956/emi"}, "edited": false, "score": 0, "creation_date": 1553651697, "post_id": 55367519, "comment_id": 97460653, "body": "shouldn&#39;t the contents of your <code>application.html.erb</code> be for <code>index.html.erb</code> and vice versa?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1553654693, "post_id": 55367519, "comment_id": 97461203, "body": "Can you show the line of the stack trace, where it mentions the name error? Usually it gives you more info about what caused it."}, {"owner": {"reputation": 61, "user_id": 9181859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ec0fe441827f1afe3dba7cb02cec181?s=128&d=identicon&r=PG&f=1", "display_name": "NB1962", "link": "https://stackoverflow.com/users/9181859/nb1962"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1553690090, "post_id": 55367519, "comment_id": 97476679, "body": "@maxpleaner Added the image link mentioned line of stack trace"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 9181859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ec0fe441827f1afe3dba7cb02cec181?s=128&d=identicon&r=PG&f=1", "display_name": "NB1962", "link": "https://stackoverflow.com/users/9181859/nb1962"}, "edited": false, "score": 1, "creation_date": 1553696250, "post_id": 55377502, "comment_id": 97480993, "body": "I tried adding that line. It is displaying undefined local variable or method `simple_pages_about_path&#39; for #&lt;#&lt;Class:0x00007f1bb90a2ce8&gt;:0x00007f1bb9085918&gt;"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 61, "user_id": 9181859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ec0fe441827f1afe3dba7cb02cec181?s=128&d=identicon&r=PG&f=1", "display_name": "NB1962", "link": "https://stackoverflow.com/users/9181859/nb1962"}, "edited": false, "score": 1, "creation_date": 1553697663, "post_id": 55377502, "comment_id": 97481963, "body": "@NB1962: yes, you need to add that route too (it&#39;s not among seven standard ones). Read <a href=\"https://guides.rubyonrails.org/v5.2/routing.html\" rel=\"nofollow noreferrer\">this guide</a>, it will clear much of the confusion."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 3, "last_activity_date": 1553690614, "creation_date": 1553690614, "answer_id": 55377502, "question_id": 55367519, "link": "https://stackoverflow.com/questions/55367519/how-to-fix-nameerror-in-simplepagesindex/55377502#55377502", "title": "How to fix &#39;NameError in SimplePages#index&#39;", "body": "<p>You don't have a corresponding route/helper (from what we can see). You need to do this in your routes.rb</p>\n\n<pre><code> resources :simple_pages\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 9181859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ec0fe441827f1afe3dba7cb02cec181?s=128&d=identicon&r=PG&f=1", "display_name": "NB1962", "link": "https://stackoverflow.com/users/9181859/nb1962"}, "edited": false, "score": 0, "creation_date": 1553718616, "post_id": 55385785, "comment_id": 97493744, "body": "It is saying Unable to autoload constant SimplePagesController, expected /mnt/c/saishrails/r2/app/controllers/simple_pages_controller&zwnj;&#8203;.rb to define it"}], "tags": [], "owner": {"reputation": 75, "user_id": 4909131, "user_type": "registered", "profile_image": "https://graph.facebook.com/813417048752638/picture?type=large", "display_name": "Srinidhi Gs", "link": "https://stackoverflow.com/users/4909131/srinidhi-gs"}, "is_accepted": false, "score": 0, "last_activity_date": 1553717961, "creation_date": 1553717961, "answer_id": 55385785, "question_id": 55367519, "link": "https://stackoverflow.com/questions/55367519/how-to-fix-nameerror-in-simplepagesindex/55385785#55385785", "title": "How to fix &#39;NameError in SimplePages#index&#39;", "body": "<p>Follow below steps: </p>\n\n<p><code>rails g controller simple_pages</code></p>\n\n# in your routes file\n\n<p><code>root 'simple_page#index'\nresources :simple_pages</code></p>\n\n# in your controllers\n\n<p><code>class SimplePageController &lt; ApplicationController\n   def index\n   end\nend</code></p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 9181859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ec0fe441827f1afe3dba7cb02cec181?s=128&d=identicon&r=PG&f=1", "display_name": "NB1962", "link": "https://stackoverflow.com/users/9181859/nb1962"}, "is_accepted": true, "score": -1, "last_activity_date": 1553948419, "creation_date": 1553948419, "answer_id": 55431365, "question_id": 55367519, "link": "https://stackoverflow.com/questions/55367519/how-to-fix-nameerror-in-simplepagesindex/55431365#55431365", "title": "How to fix &#39;NameError in SimplePages#index&#39;", "body": "<p>Replace the following in routes.rb <code>get 'simple_pages/index'</code> wrong <code>get 'index', to: 'simple_pages#index'</code> should be like this</p>\n"}], "owner": {"reputation": 61, "user_id": 9181859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ec0fe441827f1afe3dba7cb02cec181?s=128&d=identicon&r=PG&f=1", "display_name": "NB1962", "link": "https://stackoverflow.com/users/9181859/nb1962"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 55431365, "answer_count": 3, "score": -1, "last_activity_date": 1553948419, "creation_date": 1553642032, "last_edit_date": 1553690032, "question_id": 55367519, "link": "https://stackoverflow.com/questions/55367519/how-to-fix-nameerror-in-simplepagesindex", "title": "How to fix &#39;NameError in SimplePages#index&#39;", "body": "<p><a href=\"https://i.stack.imgur.com/jYWpg.png\" rel=\"nofollow noreferrer\">NameError Link </a>I'm try to launch my ruby application using <code>rails server</code> . Prior to that I used <code>$ rails generate controller simple_pages index</code>. The error is generated saying NameError in SimplePages#index on <a href=\"http://localhost:3000/\" rel=\"nofollow noreferrer\">http://localhost:3000/</a></p>\n\n<p>Tried checking the index.html.erb and application.html.erb files along with routes.rb file under config folder</p>\n\n<p>routes.rb</p>\n\n<pre><code>Rails.application.routes.draw do\n  root 'simple_pages#index'\n  get  'index',    to: 'simple_pages#index'\nend \n</code></pre>\n\n<p>index.html.erb</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;title&gt;R2&lt;/title&gt;\n    &lt;%= csrf_meta_tags %&gt;\n    &lt;%= csp_meta_tag %&gt;\n\n    &lt;%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %&gt;\n    &lt;%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %&gt;\n  &lt;/head&gt;\n\n  &lt;body&gt;\n    &lt;nav&gt;\n      &lt;ul&gt;\n       &lt;li&gt;&lt;%= link_to \"Home\",root_path %&gt;&lt;/li&gt;\n       &lt;li&gt;&lt;%= link_to \"About\",simple_pages_about_path %&gt;&lt;/li&gt;\n       &lt;li&gt;&lt;%= link_to \"Contact\",simple_pages_contact_path %&gt;&lt;/li&gt;\n      &lt;/ul&gt;\n    &lt;/nav&gt;\n\n  &lt;%= yield %&gt;\n\n  &lt;/&lt;footer&gt;\n    &amp;copy; 2018 Bike Berlin\n  &lt;/footer&gt;\n\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>application.html.erb</p>\n\n<pre><code>&lt;p id=\"notice\"&gt;&lt;%= notice %&gt;&lt;/p&gt;\n\n&lt;h1&gt;Simple Pages&lt;/h1&gt;\n\n&lt;table&gt;\n  &lt;thead&gt;\n    &lt;tr&gt;\n      &lt;th colspan=\"3\"&gt;&lt;/th&gt;\n    &lt;/tr&gt;\n  &lt;/thead&gt;\n\n  &lt;tbody&gt;\n    &lt;% @simple_pages.each do |simple_page| %&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;%= link_to 'Show', simple_page %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= link_to 'Edit', edit_simple_page_path(simple_page) %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= link_to 'Destroy', simple_page, method: :delete, data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;% end %&gt;\n  &lt;/tbody&gt;\n&lt;/table&gt;\n\n&lt;br&gt;\n\n&lt;%= link_to 'New Simple Page', new_simple_page_path %&gt;\n</code></pre>\n\n<p>The page should display no errors.</p>\n\n<p>Stack trace as follows </p>\n\n<pre><code>app/views/simple_pages/index.html.erb:25:in _app_views_simple_pages_index_html_erb___2005229969295768109_70270503512740'\nactionview (5.2.2) lib/action_view/template.rb:159:in 'block in render'\nactivesupport (5.2.2) lib/active_support/notifications.rb:170:in 'instrument'\nactionview (5.2.2) lib/action_view/template.rb:354:in `instrument_render_template'\nactionview (5.2.2) lib/action_view/template.rb:157:in `render'\nactionview (5.2.2) lib/action_view/renderer/template_renderer.rb:54:in `block (2 levels) in render_template'\nactionview (5.2.2) lib/action_view/renderer/abstract_renderer.rb:44:in `block in instrument'\nactivesupport (5.2.2) lib/active_support/notifications.rb:168:in `block in instrument'\nactivesupport (5.2.2) lib/active_support/notifications/instrumenter.rb:23:in `instrument'\nactivesupport (5.2.2) lib/active_support/notifications.rb:168:in `instrument'\nactionview (5.2.2) lib/action_view/renderer/abstract_renderer.rb:43:in `instrument'\nactionview (5.2.2) lib/action_view/renderer/template_renderer.rb:53:in `block in render_template'\nactionview (5.2.2) lib/action_view/renderer/template_renderer.rb:61:in `render_with_layout'\nactionview (5.2.2) lib/action_view/renderer/template_renderer.rb:52:in `render_template'\nactionview (5.2.2) lib/action_view/renderer/template_renderer.rb:16:in `render'\nactionview (5.2.2) lib/action_view/renderer/renderer.rb:44:in `render_template'\nactionview (5.2.2) lib/action_view/renderer/renderer.rb:25:in `render'\nactionview (5.2.2) lib/action_view/rendering.rb:103:in `_render_template'\nactionpack (5.2.2) lib/action_controller/metal/streaming.rb:219:in `_render_template'\nactionview (5.2.2) lib/action_view/rendering.rb:84:in `render_to_body'\nactionpack (5.2.2) lib/action_controller/metal/rendering.rb:52:in `render_to_body'\nactionpack (5.2.2) lib/action_controller/metal/renderers.rb:142:in `render_to_body'\nactionpack (5.2.2) lib/abstract_controller/rendering.rb:25:in `render'\nactionpack (5.2.2) lib/action_controller/metal/rendering.rb:36:in `render'\nactionpack (5.2.2) lib/action_controller/metal/instrumentation.rb:46:in `block (2 levels) in render'\nactivesupport (5.2.2) lib/active_support/core_ext/benchmark.rb:14:in `block in ms'\n/home/saishbhende24/.rvm/rubies/ruby-2.6.1/lib/ruby/2.6.0/benchmark.rb:308:in `realtime'\nactivesupport (5.2.2) lib/active_support/core_ext/benchmark.rb:14:in `ms'\nactionpack (5.2.2) lib/action_controller/metal/instrumentation.rb:46:in `block in render'\nactionpack (5.2.2) lib/action_controller/metal/instrumentation.rb:87:in `cleanup_view_runtime'\nactiverecord (5.2.2) lib/active_record/railties/controller_runtime.rb:31:in `cleanup_view_runtime'\nactionpack (5.2.2) lib/action_controller/metal/instrumentation.rb:45:in `render'\nactionpack (5.2.2) lib/action_controller/metal/implicit_render.rb:35:in `default_render'\nactionpack (5.2.2) lib/action_controller/metal/basic_implicit_render.rb:6:in `block in send_action'\nactionpack (5.2.2) lib/action_controller/metal/basic_implicit_render.rb:6:in `tap'\nactionpack (5.2.2) lib/action_controller/metal/basic_implicit_render.rb:6:in `send_action'\nactionpack (5.2.2) lib/abstract_controller/base.rb:194:in `process_action'\nactionpack (5.2.2) lib/action_controller/metal/rendering.rb:30:in `process_action'\nactionpack (5.2.2) lib/abstract_controller/callbacks.rb:42:in `block in process_action'\nactivesupport (5.2.2) lib/active_support/callbacks.rb:132:in `run_callbacks'\nactionpack (5.2.2) lib/abstract_controller/callbacks.rb:41:in `process_action'\nactionpack (5.2.2) lib/action_controller/metal/rescue.rb:22:in `process_action'\nactionpack (5.2.2) lib/action_controller/metal/instrumentation.rb:34:in `block in process_action'\nactivesupport (5.2.2) lib/active_support/notifications.rb:168:in `block in instrument'\nactivesupport (5.2.2) lib/active_support/notifications/instrumenter.rb:23:in `instrument'\nactivesupport (5.2.2) lib/active_support/notifications.rb:168:in `instrument'\nactionpack (5.2.2) lib/action_controller/metal/instrumentation.rb:32:in `process_action'\nactionpack (5.2.2) lib/action_controller/metal/params_wrapper.rb:256:in `process_action'\nactiverecord (5.2.2) lib/active_record/railties/controller_runtime.rb:24:in `process_action'\nactionpack (5.2.2) lib/abstract_controller/base.rb:134:in `process'\nactionview (5.2.2) lib/action_view/rendering.rb:32:in `process'\nactionpack (5.2.2) lib/action_controller/metal.rb:191:in `dispatch'\nactionpack (5.2.2) lib/action_controller/metal.rb:252:in `dispatch'\nactionpack (5.2.2) lib/action_dispatch/routing/route_set.rb:52:in `dispatch'\nactionpack (5.2.2) lib/action_dispatch/routing/route_set.rb:34:in `serve'\nactionpack (5.2.2) lib/action_dispatch/journey/router.rb:52:in `block in serve'\nactionpack (5.2.2) lib/action_dispatch/journey/router.rb:35:in `each'\nactionpack (5.2.2) lib/action_dispatch/journey/router.rb:35:in `serve'\nactionpack (5.2.2) lib/action_dispatch/routing/route_set.rb:840:in `call'\nrack (2.0.6) lib/rack/tempfile_reaper.rb:15:in `call'\nrack (2.0.6) lib/rack/etag.rb:25:in `call'\nrack (2.0.6) lib/rack/conditional_get.rb:25:in `call'\nrack (2.0.6) lib/rack/head.rb:12:in `call'\nactionpack (5.2.2) lib/action_dispatch/http/content_security_policy.rb:18:in `call'\nrack (2.0.6) lib/rack/session/abstract/id.rb:232:in `context'\nrack (2.0.6) lib/rack/session/abstract/id.rb:226:in `call'\nactionpack (5.2.2) lib/action_dispatch/middleware/cookies.rb:670:in `call'\nactiverecord (5.2.2) lib/active_record/migration.rb:559:in `call'\nactionpack (5.2.2) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'\nactivesupport (5.2.2) lib/active_support/callbacks.rb:98:in `run_callbacks'\nactionpack (5.2.2) lib/action_dispatch/middleware/callbacks.rb:26:in `call'\nactionpack (5.2.2) lib/action_dispatch/middleware/executor.rb:14:in `call'\nactionpack (5.2.2) lib/action_dispatch/middleware/debug_exceptions.rb:61:in `call'\nweb-console (3.7.0) lib/web_console/middleware.rb:135:in `call_app'\nweb-console (3.7.0) lib/web_console/middleware.rb:30:in `block in call'\nweb-console (3.7.0) lib/web_console/middleware.rb:20:in `catch'\nweb-console (3.7.0) lib/web_console/middleware.rb:20:in `call'\nactionpack (5.2.2) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'\nrailties (5.2.2) lib/rails/rack/logger.rb:38:in `call_app'\nrailties (5.2.2) lib/rails/rack/logger.rb:26:in `block in call'\nactivesupport (5.2.2) lib/active_support/tagged_logging.rb:71:in `block in tagged'\nactivesupport (5.2.2) lib/active_support/tagged_logging.rb:28:in `tagged'\nactivesupport (5.2.2) lib/active_support/tagged_logging.rb:71:in `tagged'\nrailties (5.2.2) lib/rails/rack/logger.rb:26:in `call'\nsprockets-rails (3.2.1) lib/sprockets/rails/quiet_assets.rb:13:in `call'\nactionpack (5.2.2) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'\nactionpack (5.2.2) lib/action_dispatch/middleware/request_id.rb:27:in `call'\nrack (2.0.6) lib/rack/method_override.rb:22:in `call'\nrack (2.0.6) lib/rack/runtime.rb:22:in `call'\nactivesupport (5.2.2) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'\nactionpack (5.2.2) lib/action_dispatch/middleware/executor.rb:14:in `call'\nactionpack (5.2.2) lib/action_dispatch/middleware/static.rb:127:in `call'\nrack (2.0.6) lib/rack/sendfile.rb:111:in `call'\nrailties (5.2.2) lib/rails/engine.rb:524:in `call'\npuma (3.12.0) lib/puma/configuration.rb:225:in `call'\npuma (3.12.0) lib/puma/server.rb:658:in `handle_request'\npuma (3.12.0) lib/puma/server.rb:472:in `process_client'\npuma (3.12.0) lib/puma/server.rb:332:in `block in run'\npuma (3.12.0) lib/puma/thread_pool.rb:133:in `block in spawn_thread'\n</code></pre>\n"}, {"tags": ["ruby", "compare", "match"], "comments": [{"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "reply_to_user": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1553684571, "post_id": 55367349, "comment_id": 97473225, "body": "@iGian  The expected output are the Zones in column ZONE on second snippet. The 3rd column on second snippet is only an explanation of the logic needed to apply in different conditions to match the more similar country code to each value in column NUMBERS. I show the snippets to try to make easier to understand"}, {"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "reply_to_user": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1553695856, "post_id": 55367349, "comment_id": 97480730, "body": "@iGian For some reason I missed to put the first value 237 in array cc. If you see the first snippet you&#39;ll see that cc and zones have the same size. I&#39;ve modified cc array."}, {"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "reply_to_user": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1553735470, "post_id": 55367349, "comment_id": 97499235, "body": "@iGian Hi iGian. The reason why 1 (USA) is never selected is because 1 is not part of the column NUMBERS, so 1 is not one of the numbers to find. I&#39;m not sure if that answers your doubt. Thanks for the help."}], "answers": [{"comments": [{"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1553762752, "post_id": 55391831, "comment_id": 97507141, "body": "<code>But you pick\u00a01876\u00a0from\u00a0cc\u00a0not because it starts with\u00a018763044, but for the opposite reason. So why not USA, since in numbers a lot of elements start with &quot;1&quot;?</code> Here is selected 1876 because the goal is to match the most similar value between NIMBERS and COUNTRY CODE."}, {"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1553792000, "post_id": 55391831, "comment_id": 97526546, "body": "In that case the number selected supposing there is no exact match should be the first with shortest lenght and the zone to select would be the first sorting ascending. For example: for the value 1246, <code>&quot;1246&quot;=&gt;[[&quot;124622&quot;, &quot;BRB1&quot;], [&quot;124624222&quot;, &quot;BRB3&quot;], [&quot;124&quot;, &quot;BRB45&quot;], [&quot;1&quot;, &quot;USA&quot;], [&quot;12465&quot;, &quot;BRB2&quot;]]</code> the value to select should be <code>12465</code> (is the shortest value that contains the prefix 1246).  If no exact match but all values have the same length then select the first value in ascending order and its corresponding zone. For these values <code>124632,124642,124609,124673</code> select <code>124609</code>"}, {"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1553873041, "post_id": 55391831, "comment_id": 97560480, "body": "Hi iGian. When I try the last block of code <code>res = numbers.map.....end.to_h</code>  receive the following error. ` undefined method <code>digits&#39; for 44036049:Fixnum</code> Does it happen for you either?"}, {"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1553879722, "post_id": 55391831, "comment_id": 97564065, "body": "I see this alternative in the link you shared <code>25.to_s.each_char {|c| print c, &#39; &#39; }</code> but where/how within the block <code>res</code> could be replaced this method instead of <code>digits</code>?"}, {"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1553888273, "post_id": 55391831, "comment_id": 97568027, "body": "Excellent iGian. It seems to work pretty fine in my Ruby version changing <code>digits</code> for that alternative code. One more thing. I was wondering if you could help me to modify one part of the logic in your code. For example for NUMBER <code>33</code> there 3 values that begin with 33 in array CC (334/FRA3,33751/FRA1 and 33679/FRA2). Then would be possible for you in this kind of cases, instead to select the shortest value (334/FRA3), select the ZONE that is the first sorted ascending, for this case for 33 the match would be <code>33751&#47;FRA1</code> instead of <code>334&#47;FRA3</code> . Thanks again"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 1, "creation_date": 1553973598, "post_id": 55391831, "comment_id": 97587187, "body": "@GerCas I made an edit to take in account the exact match. Please, consider to clean up comments (maybe moving the most relevant into your answer)."}, {"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1554018765, "post_id": 55391831, "comment_id": 97594615, "body": "Thanks so much for you help iGian. Very appreciated"}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": true, "score": 1, "last_activity_date": 1553973526, "last_edit_date": 1553973526, "creation_date": 1553756462, "answer_id": 55391831, "question_id": 55367349, "link": "https://stackoverflow.com/questions/55367349/match-the-zone-for-each-value-based-on-some-conditions/55391831#55391831", "title": "Match the zone for each value based on some conditions", "body": "<p>Completely changed the answer after some clarifications, this is what I did so far. Passible of optimisation.</p>\n\n<p><hr>\nFirst thing a method to count how many elements matches starting from the beginning. It works only with strings of numbers:</p>\n\n<pre><code>def count_equal_digits_at_beginning(a, b)\n  return a.size if a == b\n  rabdiff = (a.reverse.to_i - b.reverse.to_i).abs\n  rabdiff.digits.count - rabdiff.to_s.reverse.to_i.digits.count\nend\n</code></pre>\n\n<p><hr>\nSecond, map the pairs <code>[cc, zones]</code> to an hash, for rapid and easy access. I reversed, because the requirement is to keep the first appearance of the key:</p>\n\n<pre><code>mapping_hash = cc.reverse.zip(zones.reverse).to_h\n</code></pre>\n\n<p><hr>\nFinally write a code that looks form matches, filters and sorts the result and pick up from the <code>mapping_hash</code>. (Edited to give precedence to exact match and ascending order)</p>\n\n<pre><code>res = numbers.map.with_object([]) do |n, res|\n  exact = cc.find { |c| c == n }\n  if exact\n    found = exact\n  else\n    tmp = cc.map { |c| [c, count_equal_digits_at_beginning(c, n)] }\n    possibles = tmp.find_all { |c, count| count == tmp.max_by(&amp;:last).last &amp;&amp; count &gt; 1 }\n    good = possibles.sort_by(&amp;:first).reverse.first\n    found = good.first if good\n  end\n  res &lt;&lt; [ n, mapping_hash[found] || \"not found\" ]\nend.to_h\n</code></pre>\n\n<p>So, the final result is</p>\n\n<pre><code>res #=&gt; {\"18763044\"=&gt;\"JAM\", \"187635\"=&gt;\"JAM\", \"23092\"=&gt;\"MUS\", \"3162\"=&gt;\"NLD\", \"38050\"=&gt;\"not found\", \"33\"=&gt;\"FRA1\", \"49185\"=&gt;\"not found\", \"51078\"=&gt;\"not found\", \"1246\"=&gt;\"BRB7\", \"1721\"=&gt;\"SXM2\"}\n</code></pre>\n"}], "owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 55391831, "answer_count": 1, "score": 0, "last_activity_date": 1553973526, "creation_date": 1553640872, "last_edit_date": 1553695895, "question_id": 55367349, "link": "https://stackoverflow.com/questions/55367349/match-the-zone-for-each-value-based-on-some-conditions", "title": "Match the zone for each value based on some conditions", "body": "<p>I have this input table that shows the country codes and zones related with each Country Code.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"true\" data-console=\"true\" data-babel=\"true\">\r\n<div class=\"snippet-code snippet-currently-hidden\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;!DOCTYPE html&gt;\r\n&lt;html&gt;\r\n&lt;table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=170 style='width:102.0pt;margin-left:-.05pt;border-collapse:collapse'&gt;\r\n  &lt;tr style='height:.2in'&gt;\r\n    &lt;td width=170 nowrap colspan=2 valign=bottom style='width:102.0pt;border:\r\n  solid windowtext 1.0pt;background:#BF8F00;padding:0in 5.4pt 0in 5.4pt;\r\n  height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;b&gt;&lt;span style='color:black'&gt;ZONES\r\n  TABLE&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n  &lt;/tr&gt;\r\n  &lt;tr style='height:.2in'&gt;\r\n    &lt;td width=122 style='width:73.0pt;border:solid windowtext 1.0pt;border-top:\r\n  none;background:#305496;padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;b&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:white'&gt;COUNTRY CODE&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n    &lt;td width=48 style='width:29.0pt;border-top:none;border-left:none;border-bottom:\r\n  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#305496;\r\n  padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;b&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:white'&gt;ZONE&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n  &lt;/tr&gt;\r\n  &lt;tr style='height:.2in'&gt;\r\n    &lt;td width=122 style='width:73.0pt;border:solid windowtext 1.0pt;border-top:\r\n  none;background:#FAFAFA;padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;237&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n    &lt;td width=48 style='width:29.0pt;border-top:none;border-left:none;border-bottom:\r\n  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#FAFAFA;\r\n  padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;CMR&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n  &lt;/tr&gt;\r\n  &lt;tr style='height:.2in'&gt;\r\n    &lt;td width=122 style='width:73.0pt;border:solid windowtext 1.0pt;border-top:\r\n  none;background:#FAFAFA;padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;1721&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n    &lt;td width=48 style='width:29.0pt;border-top:none;border-left:none;border-bottom:\r\n  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#FAFAFA;\r\n  padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;SXM2&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n  &lt;/tr&gt;\r\n  &lt;tr style='height:.2in'&gt;\r\n    &lt;td width=122 style='width:73.0pt;border:solid windowtext 1.0pt;border-top:\r\n  none;background:#FAFAFA;padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;124622&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n    &lt;td width=48 style='width:29.0pt;border-top:none;border-left:none;border-bottom:\r\n  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#FAFAFA;\r\n  padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;BRB1&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n  &lt;/tr&gt;\r\n  &lt;tr style='height:.2in'&gt;\r\n    &lt;td width=122 style='width:73.0pt;border:solid windowtext 1.0pt;border-top:\r\n  none;background:#FAFAFA;padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;334&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n    &lt;td width=48 style='width:29.0pt;border-top:none;border-left:none;border-bottom:\r\n  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#FAFAFA;\r\n  padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;FRA3&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n  &lt;/tr&gt;\r\n  &lt;tr style='height:.2in'&gt;\r\n    &lt;td width=122 style='width:73.0pt;border:solid windowtext 1.0pt;border-top:\r\n  none;background:#FAFAFA;padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;124624&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n    &lt;td width=48 style='width:29.0pt;border-top:none;border-left:none;border-bottom:\r\n  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#FAFAFA;\r\n  padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;BRB3&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n  &lt;/tr&gt;\r\n  &lt;tr style='height:.2in'&gt;\r\n    &lt;td width=122 style='width:73.0pt;border:solid windowtext 1.0pt;border-top:\r\n  none;background:#FAFAFA;padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;124&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n    &lt;td width=48 style='width:29.0pt;border-top:none;border-left:none;border-bottom:\r\n  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#FAFAFA;\r\n  padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;BRB45&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n  &lt;/tr&gt;\r\n  &lt;tr style='height:.2in'&gt;\r\n    &lt;td width=122 style='width:73.0pt;border:solid windowtext 1.0pt;border-top:\r\n  none;background:#FAFAFA;padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;1246&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n    &lt;td width=48 style='width:29.0pt;border-top:none;border-left:none;border-bottom:\r\n  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#FAFAFA;\r\n  padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;BRB7&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n  &lt;/tr&gt;\r\n  &lt;tr style='height:.2in'&gt;\r\n    &lt;td width=122 style='width:73.0pt;border:solid windowtext 1.0pt;border-top:\r\n  none;background:#FAFAFA;padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;1876&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n    &lt;td width=48 style='width:29.0pt;border-top:none;border-left:none;border-bottom:\r\n  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#FAFAFA;\r\n  padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;JAM&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n  &lt;/tr&gt;\r\n  &lt;tr style='height:.2in'&gt;\r\n    &lt;td width=122 style='width:73.0pt;border:solid windowtext 1.0pt;border-top:\r\n  none;background:#FAFAFA;padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;358&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n    &lt;td width=48 style='width:29.0pt;border-top:none;border-left:none;border-bottom:\r\n  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#FAFAFA;\r\n  padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;FIN&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n  &lt;/tr&gt;\r\n  &lt;tr style='height:.2in'&gt;\r\n    &lt;td width=122 style='width:73.0pt;border:solid windowtext 1.0pt;border-top:\r\n  none;background:#FAFAFA;padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;33751&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n    &lt;td width=48 style='width:29.0pt;border-top:none;border-left:none;border-bottom:\r\n  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#FAFAFA;\r\n  padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;FRA1&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n  &lt;/tr&gt;\r\n  &lt;tr style='height:.2in'&gt;\r\n    &lt;td width=122 style='width:73.0pt;border:solid windowtext 1.0pt;border-top:\r\n  none;background:#FAFAFA;padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;33679&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n    &lt;td width=48 style='width:29.0pt;border-top:none;border-left:none;border-bottom:\r\n  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#FAFAFA;\r\n  padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;FRA2&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n  &lt;/tr&gt;\r\n  &lt;tr style='height:.2in'&gt;\r\n    &lt;td width=122 style='width:73.0pt;border:solid windowtext 1.0pt;border-top:\r\n  none;background:#FAFAFA;padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;599&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n    &lt;td width=48 style='width:29.0pt;border-top:none;border-left:none;border-bottom:\r\n  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#FAFAFA;\r\n  padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;ANT&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n  &lt;/tr&gt;\r\n  &lt;tr style='height:.2in'&gt;\r\n    &lt;td width=122 style='width:73.0pt;border:solid windowtext 1.0pt;border-top:\r\n  none;background:#FAFAFA;padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;61&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n    &lt;td width=48 style='width:29.0pt;border-top:none;border-left:none;border-bottom:\r\n  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#FAFAFA;\r\n  padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;AUS&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n  &lt;/tr&gt;\r\n  &lt;tr style='height:.2in'&gt;\r\n    &lt;td width=122 style='width:73.0pt;border:solid windowtext 1.0pt;border-top:\r\n  none;background:#FAFAFA;padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;230&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n    &lt;td width=48 style='width:29.0pt;border-top:none;border-left:none;border-bottom:\r\n  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#FAFAFA;\r\n  padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;MUS&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n  &lt;/tr&gt;\r\n  &lt;tr style='height:.2in'&gt;\r\n    &lt;td width=122 style='width:73.0pt;border:solid windowtext 1.0pt;border-top:\r\n  none;background:#FAFAFA;padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;31&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n    &lt;td width=48 style='width:29.0pt;border-top:none;border-left:none;border-bottom:\r\n  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#FAFAFA;\r\n  padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;NLD&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n  &lt;/tr&gt;\r\n  &lt;tr style='height:.2in'&gt;\r\n    &lt;td width=122 style='width:73.0pt;border:solid windowtext 1.0pt;border-top:\r\n  none;background:#FAFAFA;padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;65&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n    &lt;td width=48 style='width:29.0pt;border-top:none;border-left:none;border-bottom:\r\n  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#FAFAFA;\r\n  padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;SGP&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n  &lt;/tr&gt;\r\n  &lt;tr style='height:.2in'&gt;\r\n    &lt;td width=122 style='width:73.0pt;border:solid windowtext 1.0pt;border-top:\r\n  none;background:#FAFAFA;padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;1721&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n    &lt;td width=48 style='width:29.0pt;border-top:none;border-left:none;border-bottom:\r\n  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#FAFAFA;\r\n  padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;SXM4&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n  &lt;/tr&gt;\r\n  &lt;tr style='height:.2in'&gt;\r\n    &lt;td width=122 style='width:73.0pt;border:solid windowtext 1.0pt;border-top:\r\n  none;background:#FAFAFA;padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;1&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n    &lt;td width=48 style='width:29.0pt;border-top:none;border-left:none;border-bottom:\r\n  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#FAFAFA;\r\n  padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;USA&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n  &lt;/tr&gt;\r\n  &lt;tr style='height:.2in'&gt;\r\n    &lt;td width=122 style='width:73.0pt;border:solid windowtext 1.0pt;border-top:\r\n  none;background:#FAFAFA;padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;124623&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n    &lt;td width=48 style='width:29.0pt;border-top:none;border-left:none;border-bottom:\r\n  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#FAFAFA;\r\n  padding:0in 5.4pt 0in 5.4pt;height:.2in'&gt;\r\n      &lt;p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\r\n  text-align:center;line-height:normal'&gt;&lt;span style='font-size:8.0pt;\r\n  font-family:\"Verdana\",sans-serif;color:black'&gt;BRB2&lt;/span&gt;&lt;/p&gt;\r\n    &lt;/td&gt;\r\n  &lt;/tr&gt;\r\n&lt;/table&gt;\r\n\r\n&lt;/html&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>And I have the codes in column NUMBERS of the following table for which I want to search the corresponding ZONE from table above. In below Table the Column ZONE would be the Output I trying to get for the values in column NUMBERS.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"true\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code snippet-currently-hidden\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;style type=\"text/css\"&gt;\r\n\ttable.tableizer-table {\r\n\t\tfont-size: 12px;\r\n\t\tborder: 1px solid #CCC; \r\n\t\tfont-family: Arial, Helvetica, sans-serif;\r\n\t} \r\n\t.tableizer-table td {\r\n\t\tpadding: 4px;\r\n\t\tmargin: 3px;\r\n\t\tborder: 1px solid #CCC;\r\n\t}\r\n\t.tableizer-table th {\r\n\t\tbackground-color: #BF8F00; \r\n\t\tcolor: #FFF;\r\n\t\tfont-weight: bold;\r\n\t}\r\n.tableizer-table tr:nth-child(even){background-color: #f2f2f2}     \r\n  .tableizer-table tr:first-child td {\r\n      background-color: #305496; color: #FFF;\r\n    }\r\n    tr td:nth-child(3) {\r\n  background: #DFDFDF;\r\n}\r\ntr:nth-child(1) td:nth-child(3) {\r\n  background: #5D5B56;\r\n}\r\n\r\n&lt;/style&gt;\r\n&lt;table class=\"tableizer-table\"&gt;\r\n&lt;thead&gt;&lt;tr class=\"tableizer-firstrow\"&gt;&lt;th&gt;NUMBERS to SEARCH&lt;/th&gt;&lt;th&gt;ZONE EXPECTED&lt;/th&gt;&lt;th&gt;&amp;nbsp;&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;\r\n &lt;tr&gt;&lt;td&gt;NUMBERS&lt;/td&gt;&lt;td&gt;ZONE&lt;/td&gt;&lt;td&gt;NOTES about logic to match the zone&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;18763044&lt;/td&gt;&lt;td&gt;JAM&lt;/td&gt;&lt;td&gt;CC=1876 belongs to JAM&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;187635&lt;/td&gt;&lt;td&gt;JAM&lt;/td&gt;&lt;td&gt;CC=1876 belongs to JAM&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;23092&lt;/td&gt;&lt;td&gt;MUS&lt;/td&gt;&lt;td&gt;CC=230 belongs to JAM&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;3162&lt;/td&gt;&lt;td&gt;NLD&lt;/td&gt;&lt;td&gt;CC=31 belongs to NLD&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;38050&lt;/td&gt;&lt;td&gt;NOT FOUND&lt;/td&gt;&lt;td&gt;There is no CC that has as prefix 38,380, 3805 etc&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;33&lt;/td&gt;&lt;td&gt;FRA3&lt;/td&gt;&lt;td&gt;There are 3 CC that begins with 33, but 334 selected because is the shortest and belongs to FRA3&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;49185&lt;/td&gt;&lt;td&gt;NOT FOUND&lt;/td&gt;&lt;td&gt;There is no CC that begins with 49,491, etc&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;51078&lt;/td&gt;&lt;td&gt;NOT FOUND&lt;/td&gt;&lt;td&gt;There is no CC that begins with 51,510, etc&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;1246&lt;/td&gt;&lt;td&gt;BRB7&lt;/td&gt;&lt;td&gt;There are 4 CC that begins with 1246, but there is one exact match, CC=1246 that belongs to ZONE BRB7&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;1721&lt;/td&gt;&lt;td&gt;SXM2&lt;/td&gt;&lt;td&gt;There are 2 CC that begins with 1721, but the ZONE to select is that that appears first. In this case SXM2&lt;/td&gt;&lt;/tr&gt;\r\n&lt;/tbody&gt;&lt;/table&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I've putted the tables values in arrays form and so far I have the code below that detects with values of array cc begins with values in numbers, but the output is far\nfrom my expected output, since I not sure how to do it. May be someone could help me. Thanks in advance.</p>\n\n<pre><code>cc=[\"237\",\"1721\",\"124622\",\"334\",\"124624\",\"124\",\"1246\",\"1876\",\"358\",\"33751\",\"33679\",\"599\",\"61\",\"230\",\"31\",\"65\",\"1721\",\"1\",\"124623\"]\nzones=[\"CMR\",\"SXM2\",\"BRB1\",\"FRA3\",\"BRB3\",\"BRB45\",\"BRB7\",\"JAM\",\"FIN\",\"FRA1\",\"FRA2\",\"ANT\",\"AUS\",\"MUS\",\"NLD\",\"SGP\",\"SXM4\",\"USA\",\"BRB2\"]\nnumbers=[\"18763044\",\"187635\",\"23092\",\"3162\",\"38050\",\"33\",\"49185\",\"51078\",\"1246\",\"1721\"]\n\nnumbers.map{|n| \n    cc.find {|i|  i.start_with?(n) }\n}\n\n=&gt; [nil, nil, nil, nil, nil, \"334\", nil, nil, \"124622\", \"1721\"]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1553660341, "post_id": 55366338, "comment_id": 97462336, "body": "What is your question?"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1553683292, "post_id": 55366338, "comment_id": 97472452, "body": "Side note: <code>which_shop_method_to_use?</code> shouldn&#39;t have the question mark suffix. This is saved for methods returning truthy / falsey values. IMO better off as <code>def shop_method; current_shop || current_shop_by_session; end</code>."}], "answers": [{"comments": [{"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1553655312, "post_id": 55366508, "comment_id": 97461336, "body": "it might be worth noting that in doing this, the method (<code>which_shop_mehtod_to_use?</code>) does appear to get called each time you invoke <code>create_amazon_client</code>. Off the cuff I would&#39;ve (erroneously, it appears, after a quick trial program) said that this code would eval the shop param when the file is first loaded and then be stuck with that first return value and that may be the gut feeling a fair number of people have that sends them off trying other means of using method return values as default param values"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1553672450, "post_id": 55366508, "comment_id": 97466298, "body": "@SimpleLime: &quot;does appear to get called each time you invoke create_amazon_client&quot; - yes, just as intended."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 3, "last_activity_date": 1553635927, "creation_date": 1553635927, "answer_id": 55366508, "question_id": 55366338, "link": "https://stackoverflow.com/questions/55366338/assigning-a-method-as-an-argument-to-a-method/55366508#55366508", "title": "Assigning a method as an argument to a method", "body": "<blockquote>\n  <p>what's getting passed in is just this symbol <code>:which_shop_method_to_use?</code></p>\n</blockquote>\n\n<p>Yes, because that's exactly what the code says. If you wanted the result of calling that method, call that method.</p>\n\n<pre><code>def create_amazon_client(marketplace, seller_id, auth_token, shop = which_shop_method_to_use?)\n</code></pre>\n"}], "owner": {"reputation": 2168, "user_id": 4386626, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/f2c9512ee4dac8ccbbf45fc2cf1a8046?s=128&d=identicon&r=PG&f=1", "display_name": "ToddT", "link": "https://stackoverflow.com/users/4386626/toddt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 55366508, "answer_count": 1, "score": 0, "last_activity_date": 1553635927, "creation_date": 1553635110, "question_id": 55366338, "link": "https://stackoverflow.com/questions/55366338/assigning-a-method-as-an-argument-to-a-method", "title": "Assigning a method as an argument to a method", "body": "<p>I'm assigning a method to a variable that is used as an argument in a method. I am expecting that method to return a <code>shop</code> but instead its just returning the method. Here is the method accepting the argument.</p>\n\n<pre><code>def create_amazon_client(marketplace, seller_id, auth_token, shop = :which_shop_method_to_use?)\n    keys = which_amazon_keys_to_use?(marketplace, shop)\n    MWS::FulfillmentOutboundShipment::Client.new()\nend\n</code></pre>\n\n<p>and then here is the method itself:</p>\n\n<pre><code>def which_shop_method_to_use?\n  if current_shop.nil?\n    return current_shop_by_session\n  else\n    return current_shop\n  end\nend\n</code></pre>\n\n<p>what's getting passed in is just this symbol 'which_shop_method_to_use?'</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "datetime"], "answers": [{"tags": [], "owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "is_accepted": true, "score": 2, "last_activity_date": 1553634577, "creation_date": 1553634577, "answer_id": 55366223, "question_id": 55366025, "link": "https://stackoverflow.com/questions/55366025/ruby-week-number-results/55366223#55366223", "title": "Ruby week number results", "body": "<pre><code>Time.now.strftime('%Y%V')\n</code></pre>\n\n<p>Would give you the output your looking for.</p>\n\n<blockquote>\n  <p>%V - Week number of the week-based year (01..53)</p>\n</blockquote>\n\n<p>You have to look for the week-based year.</p>\n"}, {"tags": [], "owner": {"reputation": 14139, "user_id": 1108, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/48OpQ.jpg?s=128&g=1", "display_name": "jerhinesmith", "link": "https://stackoverflow.com/users/1108/jerhinesmith"}, "is_accepted": false, "score": 4, "last_activity_date": 1553636241, "last_edit_date": 1553636241, "creation_date": 1553634604, "answer_id": 55366225, "question_id": 55366025, "link": "https://stackoverflow.com/questions/55366025/ruby-week-number-results/55366225#55366225", "title": "Ruby week number results", "body": "<p>If you look in the documentation, it says this:</p>\n\n<pre><code>Week number: The first week of YYYY that starts with a Sunday or\nMonday (according to %U or %W). The days in the year before the first\nweek are in week 0.\n\n  %U - Week number of the year. The week starts with Sunday. (00..53)\n  %W - Week number of the year. The week starts with Monday. (00..53)\n</code></pre>\n\n<p>January 1st, 2019 was on a Tuesday, so that would have been week 0 - making today week 12.</p>\n"}], "owner": {"reputation": 446, "user_id": 1743972, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SiOLK.jpg?s=128&g=1", "display_name": "Mohamed Sami", "link": "https://stackoverflow.com/users/1743972/mohamed-sami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 55366223, "answer_count": 2, "score": 0, "last_activity_date": 1563821788, "creation_date": 1553633626, "last_edit_date": 1563821788, "question_id": 55366025, "link": "https://stackoverflow.com/questions/55366025/ruby-week-number-results", "title": "Ruby week number results", "body": "<p>Why when I use</p>\n\n<pre><code>Time.now.strftime('%Y%W')\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Date.today.strftime('%Y%W')\n</code></pre>\n\n<p>they return 201912 while it should be 201913 as we are in week 13, not 12.</p>\n\n<p>How to get the current week number?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sass"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11262703, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2rbrjY6Ip3E/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfSrA7qQvMpbdaAC43d12luXxKCEw/mo/photo.jpg?sz=128", "display_name": "deezee", "link": "https://stackoverflow.com/users/11262703/deezee"}, "edited": false, "score": 0, "creation_date": 1553637340, "post_id": 55366268, "comment_id": 97457134, "body": "Maybe users was the wrong word to use here. This is more like admins setting the color for all the users"}, {"owner": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "reply_to_user": {"reputation": 15, "user_id": 11262703, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2rbrjY6Ip3E/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfSrA7qQvMpbdaAC43d12luXxKCEw/mo/photo.jpg?sz=128", "display_name": "deezee", "link": "https://stackoverflow.com/users/11262703/deezee"}, "edited": false, "score": 0, "creation_date": 1553637733, "post_id": 55366268, "comment_id": 97457265, "body": "Even with admin changing the color, I think is a better approach guard this information in database and change it like the answer"}], "tags": [], "owner": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "is_accepted": true, "score": 1, "last_activity_date": 1553637963, "last_edit_date": 1553637963, "creation_date": 1553634780, "answer_id": 55366268, "question_id": 55365894, "link": "https://stackoverflow.com/questions/55365894/is-it-possible-to-recompile-assets-from-the-controller-in-rails/55366268#55366268", "title": "Is it possible to recompile assets from the controller in Rails?", "body": "<p>I do not recommend you to change user UI color with a Ruby global color variable. The main reason: you are not able to recompile your assets for each user will trade the theme color.\nMy suggestion: Implement how many classes who reassigns the <code>$theme-colors</code> value as you need, like the following: </p>\n\n<pre><code># _variables.scss\n$theme-colors: black; # default color\n\n.blue-theme {\n  $theme-colors: blue;\n}\n\n.yellow-theme {\n  $theme-colors: yellow;\n}\n</code></pre>\n\n<p>Finally, in your <code>application.html.erb</code> (or the equivalent) you change the <code>class-name</code> according to the user preference:</p>\n\n<pre><code># apllication.html or equivalent\n&lt;body class=\"&lt;%= @class_name %&gt;\"&gt;\n&lt;/body&gt;\n</code></pre>\n\n<p><strong>Obs</strong>: If you use <code>Rails.configuration</code>, the action of one user trade the UI theme will trade the theme for all users, instead of use <code>Rails.config</code> put this option inside a <code>session</code>, reference the <code>current_user</code> and keep this preference, or guard this information on your database.</p>\n"}], "owner": {"reputation": 15, "user_id": 11262703, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2rbrjY6Ip3E/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfSrA7qQvMpbdaAC43d12luXxKCEw/mo/photo.jpg?sz=128", "display_name": "deezee", "link": "https://stackoverflow.com/users/11262703/deezee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 55366268, "answer_count": 1, "score": 0, "last_activity_date": 1553637963, "creation_date": 1553633012, "last_edit_date": 1553637392, "question_id": 55365894, "link": "https://stackoverflow.com/questions/55365894/is-it-possible-to-recompile-assets-from-the-controller-in-rails", "title": "Is it possible to recompile assets from the controller in Rails?", "body": "<p>I'm adding functionality to my application that allows an admin to change the primary color of the bootstrap theme for all users. The problem is that once the admin changes their color (which I'm storing in Rails.configuration), assets are not being recompiled, meaning that the color is not changing.</p>\n\n<p>Is there a way to recompile the assets from a controller?</p>\n\n<p>In my _variables.scss.erb</p>\n\n<pre><code>$primary: &lt;%= Rails.configuration.color %&gt;;\n$theme-colors:(\"primary\":$primary);\n</code></pre>\n\n<p>In my controller</p>\n\n<pre><code>Rails.configuration.color = params[:color]\nredirect_to root_path\n</code></pre>\n\n<p>I've already tried saving the color value into a database and reading the value into Rails.configuration.color on app start (in an initializer), but again the assets are not recompiling</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "api"], "comments": [{"owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "edited": false, "score": 0, "creation_date": 1553635154, "post_id": 55365868, "comment_id": 97456264, "body": "Can you modify the post. It is hard to read, it would make it easier if you use the tools to insert code snippets."}], "answers": [{"tags": [], "owner": {"reputation": 712, "user_id": 929251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69ef9fdd5a6cd663670253f5a73527a4?s=128&d=identicon&r=PG", "display_name": "Igor Kasyanchuk", "link": "https://stackoverflow.com/users/929251/igor-kasyanchuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1553637251, "creation_date": 1553637251, "answer_id": 55366749, "question_id": 55365868, "link": "https://stackoverflow.com/questions/55365868/trying-to-save-api-data-to-my-database-headline-not-being-populated-for-table/55366749#55366749", "title": "Trying to save api data to my database, @headline not being populated for table", "body": "<p>Instead of </p>\n\n<pre><code>rescue Exception =&gt; e\n        return nil\n    end\n</code></pre>\n\n<p>write </p>\n\n<pre><code>rescue Exception =&gt; e\n        puts e.message\n        puts e.stacktrace.join(\"\\n\")\n        return nil\n    end\n</code></pre>\n\n<p>at least you can see what error you have</p>\n\n<p>plus in controller you need to check later if object is nil</p>\n"}], "owner": {"reputation": 13, "user_id": 9691852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18e5432f7a33e79d366a3c9a920d5c70?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Shff", "link": "https://stackoverflow.com/users/9691852/mark-shff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553637251, "creation_date": 1553632874, "question_id": 55365868, "link": "https://stackoverflow.com/questions/55365868/trying-to-save-api-data-to-my-database-headline-not-being-populated-for-table", "title": "Trying to save api data to my database, @headline not being populated for table", "body": "<p>I'm trying to save news data for stocks from an api to my \"Headline\" database.  But I think my controller params are wrong and so I can't populate an item to save to my table. </p>\n\n<p>I've tried changing the @headline = Headline.new_from_lookup(params[:stock]) params to :ticker :symbol but nothing changes.  Still getting undefined method `save' for nil:NilClass</p>\n\n<p>Routes.rb</p>\n\n<p>Rails.application.routes.draw do\n  # The priority is based upon order of creation: first created -> highest priority.\n  # See how all your routes lay out with \"rake routes\".</p>\n\n<p>root 'headlines#new'</p>\n\n<p>resources :headlines</p>\n\n<p>end</p>\n\n<p>headline.rb</p>\n\n<p>class Headline &lt; ActiveRecord::Base\n    require 'iex-ruby-client'</p>\n\n<pre><code>def self.new_from_lookup(symbol)\n    begin\n    looked_up_stock = IEX::Resources::Quote.get(symbol)\n    looked_up_news = IEX::Resources::News.get(symbol)\n    new(ticker: looked_up_stock.symbol, name: looked_up_stock.companyName, headline: looked_up_news.first.headline, summary: looked_up_news.first.summary, url: looked_up_news.first.url)\n    rescue Exception =&gt; e\n        return nil\n    end\nend\n</code></pre>\n\n<p>end</p>\n\n<p>headline_controller.rb</p>\n\n<p>class HeadlinesController &lt; ApplicationController</p>\n\n<pre><code>def new\n    @headline = Headline.new\nend\n\ndef create\n # takes input from the search page then finds the stock info with the model headline.rb\n    @headline = Headline.new_from_lookup(params[:symbol])\n\n    @headline.save # saves the headline info to the database\n\n    redirect_to headline_path(@headline) # directs the user to the show path\nend\n\ndef show\n    @headline = Headline.find(params[:id]) # shows the news from the database that was just entered\nend\n</code></pre>\n\n<p>end</p>\n\n<p>new.html.erb</p>\n\n<p>\n    </p>\n\n<pre><code>    &lt;h1&gt;Choose Stock News&lt;/h1&gt;\n\n        &lt;%= form_for @headline do |f| %&gt;\n            &lt;p&gt;\n                &lt;%= f.label :ticker %&gt;\n                &lt;%= f.text_field :ticker %&gt;\n            &lt;/p&gt;\n            &lt;p&gt;\n                &lt;%= f.submit %&gt;\n            &lt;/p&gt;\n\n        &lt;% end %&gt;\n\n\n\n&lt;/body&gt;\n</code></pre>\n\n<p></p>\n\n<p>show.html.erb</p>\n\n<h1>Showing Selected Stock News</h1>\n\n<p>Ticker: </p>\n\n<p>Name: </p>\n\n<p>Headline: </p>\n\n<p>Summary: </p>\n\n<p>Url: </p>\n\n<p>Created: </p>\n\n<p>Updated: </p>\n"}, {"tags": ["arrays", "ruby", "hash"], "comments": [{"owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "edited": false, "score": 0, "creation_date": 1553632739, "post_id": 55365811, "comment_id": 97455263, "body": "Check out the documentation on <a href=\"https://ruby-doc.org/core-2.2.3/Enumerable.html#method-i-group_by\" rel=\"nofollow noreferrer\">Enumerable#group_by</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11193719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1827863ddaa907d7218bf929a85c9c6?s=128&d=identicon&r=PG&f=1", "display_name": "Gui Heurich", "link": "https://stackoverflow.com/users/11193719/gui-heurich"}, "edited": false, "score": 0, "creation_date": 1553676249, "post_id": 55366469, "comment_id": 97468114, "body": "Thank you! That works! If I may ask, what is the uniq doing at beginning? It seems that that was crucial into accessing the values in &#39;students&#39;..."}, {"owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "reply_to_user": {"reputation": 1, "user_id": 11193719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1827863ddaa907d7218bf929a85c9c6?s=128&d=identicon&r=PG&f=1", "display_name": "Gui Heurich", "link": "https://stackoverflow.com/users/11193719/gui-heurich"}, "edited": false, "score": 0, "creation_date": 1553679445, "post_id": 55366469, "comment_id": 97470095, "body": "@GuiHeurich: I added explanations to the answer."}, {"owner": {"reputation": 1, "user_id": 11193719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1827863ddaa907d7218bf929a85c9c6?s=128&d=identicon&r=PG&f=1", "display_name": "Gui Heurich", "link": "https://stackoverflow.com/users/11193719/gui-heurich"}, "edited": false, "score": 0, "creation_date": 1553721165, "post_id": 55366469, "comment_id": 97494956, "body": "Perfect, thank you so much for taking the time!"}], "tags": [], "owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "is_accepted": true, "score": 0, "last_activity_date": 1553679404, "last_edit_date": 1553679404, "creation_date": 1553635694, "answer_id": 55366469, "question_id": 55365811, "link": "https://stackoverflow.com/questions/55365811/how-to-extract-all-values-from-a-key-that-are-inside-a-hash/55366469#55366469", "title": "How to extract all values from a key that are inside a hash", "body": "<p>Firstly I suggest to change <code>input_students</code> because the proposal to enter the name and cohort is displayed only once. And user can't understand what ot enter.</p>\n\n<p>Also I suggest to change the return value of this method.</p>\n\n<pre><code>def input_students\n  puts \"Leave field empty to finish\"\n  puts\n\n  students = []\n\n  loop do\n    puts \"Please enter the name of the student\"\n    name = gets.chomp\n    break if name.empty?\n\n    puts \"In which cohort is this student?\"\n    cohort = gets.chomp\n    break if cohort.empty?\n\n    students &lt;&lt; { cohort: cohort, name: name }\n  end\n\n  students\nend\n\ndef print(students)\n  students.\n    map { |s| s[:cohort] }.\n    uniq.\n    each { |c| puts \"#{c} cohort students are #{students.\n                                                  find_all { |s| s[:cohort] == c }.\n                                                  map { |s| s[:name] }.\n                                                  join(', ')}\" }\nend\n\nstudents = input_students\nprint(students)\n</code></pre>\n\n<pre><code># First we get an array of cohorts of all students.\n# The number of elements in the array is equal to the number of students\nstudents.map { |s| s[:cohort] }\n\n# But many students are in the same cohort.\n# To avoid this duplication, get rid of duplicates.\nstudents.map { |s| s[:cohort] }.uniq\n\n# Well done. Now we have an array of unique cohorts.\n# We can use this to print information about each cohort.\nstudents.map { |s| s[:cohort] }.uniq.each { |c| puts \"Cohort information\" }\n\n# How to print information? For each cohort certain actions are carried out.\n\n# First, find all the students in this cohort.\nstudents.find_all { |s| s[:cohort] == c }\n\n# We only need the names of these students.\nstudents.find_all { |s| s[:cohort] == c }.map { |s| s[:name] }\n\n# But this is an array of names. Convert it to a string, separated by commas.\nstudents.find_all { |s| s[:cohort] == c }.map { |s| s[:name] }.join(', ')\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11193719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1827863ddaa907d7218bf929a85c9c6?s=128&d=identicon&r=PG&f=1", "display_name": "Gui Heurich", "link": "https://stackoverflow.com/users/11193719/gui-heurich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "closed_date": 1553686771, "accepted_answer_id": 55366469, "answer_count": 1, "score": -3, "last_activity_date": 1553679404, "creation_date": 1553632563, "last_edit_date": 1553674130, "question_id": 55365811, "link": "https://stackoverflow.com/questions/55365811/how-to-extract-all-values-from-a-key-that-are-inside-a-hash", "closed_reason": "Needs details or clarity", "title": "How to extract all values from a key that are inside a hash", "body": "<p>I ask a user for input, and store it as hashes inside an array. I need to extract the values that share the same key from those hashes. I want to print the names of students that belong to the same cohort like this:</p>\n\n<pre><code>\"May cohort students are: Brian, Penelope\"\n\"June cohort students are: Fred, Pedro\"\n</code></pre>\n\n<p>How could I do this? I need help with this method:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def print(students)\n  #go through all hashes in 'students' and group them by cohort\n  #print each cohort separately\nend\n</code></pre>\n\n<p>so that I can do using <code>map</code> and <code>select</code>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def input_students\n  puts \"Please enter the names of the students\"\n  puts \"To finish, just hit return twice\"\n  students = []\n  name = gets.chomp\n  puts \"In which cohort is this student?\"\n  cohort = gets.chomp \n  while !name.empty? do\n    students &lt;&lt; {cohort.to_sym =&gt; name}\n    name = gets.chomp\n    cohort = gets.chomp\n  end\n  students\nend\n\nstudents = input_students\nprint(students)\n</code></pre>\n\n<p>But I get:</p>\n\n<pre><code>\"no implicit conversion of Symbol to Integer\"\n</code></pre>\n"}, {"tags": ["ruby", "aws-lambda"], "comments": [{"owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "edited": false, "score": 0, "creation_date": 1553635242, "post_id": 55365614, "comment_id": 97456302, "body": "try deleting <code>Gemfile.lock</code> and run <code>bundle install</code> again see if you run to any issues then. Before you upload to Lambda"}, {"owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "edited": false, "score": 0, "creation_date": 1553635283, "post_id": 55365614, "comment_id": 97456317, "body": "I see the versions don&#39;t match <code>public_suffix (&gt;= 2.0.2)</code>  != <code>public_suffix-3.0.2</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "is_accepted": false, "score": 1, "last_activity_date": 1553635436, "creation_date": 1553635436, "answer_id": 55366404, "question_id": 55365614, "link": "https://stackoverflow.com/questions/55365614/could-not-find-public-suffix-3-0-2-in-any-of-the-sources-when-run-ruby-in-lamb/55366404#55366404", "title": "&#39;Could not find public_suffix-3.0.2 in any of the sources&#39; when run ruby in Lambda", "body": "<p>It seems as that your <code>public_suffix</code> versions don't match.</p>\n\n<p>Add to your Gemfile.</p>\n\n<p><code>gem 'public_suffix', '~&gt; 3.0', '&gt;= 3.0.2'</code></p>\n\n<p>Run <code>bundle install</code></p>\n\n<p>Make sure that the version is upgraded in your <code>Gemfile.lock</code> and add folder to Lambda.</p>\n"}], "owner": {"reputation": 329, "user_id": 6679011, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f5c9a7d025e5cf7734e8d6de19a2113?s=128&d=identicon&r=PG&f=1", "display_name": "Yang L", "link": "https://stackoverflow.com/users/6679011/yang-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 495, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553635436, "creation_date": 1553631597, "last_edit_date": 1553631922, "question_id": 55365614, "link": "https://stackoverflow.com/questions/55365614/could-not-find-public-suffix-3-0-2-in-any-of-the-sources-when-run-ruby-in-lamb", "title": "&#39;Could not find public_suffix-3.0.2 in any of the sources&#39; when run ruby in Lambda", "body": "<p>I have a ruby script that needs to run on Lambda,  I created a function, with all the files in a folder\nWhen I test it, got an error:</p>\n\n<pre><code>\"errorMessage\": \"Could not find public_suffix-3.0.2 in any of the sources\"\n</code></pre>\n\n<p>I already add this library in <code>Gemfile.lock</code>, so I am confused why this is happening and how do I fix it?\nThis is how I defined it in <code>Gemfile.lock</code>:</p>\n\n<pre><code>GEM\n  remote: https://rubygems.org/\n  specs:\n    addressable (2.5.2)\n      public_suffix (&gt;= 2.0.2, &lt; 4.0)\n    .......\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1553631507, "post_id": 55365432, "comment_id": 97454737, "body": "What do you mean by &quot;I get a popup to save a file&quot;? Nothing in the code you&#39;ve shown is a &quot;popup&quot;, nor is there any code about a &quot;file&quot;, nor have you shared the corresponding view code."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1553631671, "post_id": 55365432, "comment_id": 97454807, "body": "...From your edit, are you now saying that you want the <code>parent</code> to be optional? In that case, you need <code>belongs_to :parent, class_name: &quot;Comment&quot;, optional: true</code>"}, {"owner": {"reputation": 630, "user_id": 4330767, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-lCuPhO8emVE/AAAAAAAAAAI/AAAAAAAAAGI/uIdd5BFX5eE/photo.jpg?sz=128", "display_name": "marko calvocruz", "link": "https://stackoverflow.com/users/4330767/marko-calvocruz"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1553631777, "post_id": 55365432, "comment_id": 97454848, "body": "Good points. Will attach a screenshot of the pop-up &amp; the view code to the question. &amp; Will add  <code>optional: true</code>, thought shouldn&#39;t it be default for an int in a SQL table?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1553679570, "post_id": 55365432, "comment_id": 97470184, "body": "It&#39;s not &quot;required in SQL&quot;, unless you make it a foreign key constraint. Which you haven&#39;t. It <b>is</b>, however, as of rails 5, a required field as an application validation rule."}], "answers": [{"comments": [{"owner": {"reputation": 630, "user_id": 4330767, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-lCuPhO8emVE/AAAAAAAAAAI/AAAAAAAAAGI/uIdd5BFX5eE/photo.jpg?sz=128", "display_name": "marko calvocruz", "link": "https://stackoverflow.com/users/4330767/marko-calvocruz"}, "edited": false, "score": 0, "creation_date": 1553632198, "post_id": 55365626, "comment_id": 97455029, "body": "Solves the problem though doesn&#39;t explain the weird behavior when there is an error. Thanks to both you &amp; Tom_lord"}], "tags": [], "owner": {"reputation": 14139, "user_id": 1108, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/48OpQ.jpg?s=128&g=1", "display_name": "jerhinesmith", "link": "https://stackoverflow.com/users/1108/jerhinesmith"}, "is_accepted": true, "score": 1, "last_activity_date": 1553631684, "creation_date": 1553631684, "answer_id": 55365626, "question_id": 55365432, "link": "https://stackoverflow.com/questions/55365432/parent-must-exist-and-no-template-found-for-commentscontrollercreate-render/55365626#55365626", "title": "&quot;Parent must exist&quot; and &quot;No template found for CommentsController#create, rendering head :no_content&quot; Rails 5", "body": "<p>Rails 5 makes <code>belongs_to</code> association required by default - there's a great article about it <a href=\"https://blog.bigbinary.com/2016/02/15/rails-5-makes-belong-to-association-required-by-default.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Basically, you just need to mark your <code>belongs_to</code> relationship as optional:</p>\n\n<pre><code>belongs_to :parent, class_name: \"Comment\", optional: true\n</code></pre>\n"}], "owner": {"reputation": 630, "user_id": 4330767, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-lCuPhO8emVE/AAAAAAAAAAI/AAAAAAAAAGI/uIdd5BFX5eE/photo.jpg?sz=128", "display_name": "marko calvocruz", "link": "https://stackoverflow.com/users/4330767/marko-calvocruz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 55365626, "answer_count": 1, "score": 0, "last_activity_date": 1553631915, "creation_date": 1553630735, "last_edit_date": 1553631915, "question_id": 55365432, "link": "https://stackoverflow.com/questions/55365432/parent-must-exist-and-no-template-found-for-commentscontrollercreate-render", "title": "&quot;Parent must exist&quot; and &quot;No template found for CommentsController#create, rendering head :no_content&quot; Rails 5", "body": "<p>I'm getting a weird error with a \"New Comment\" form.</p>\n\n<p>First, when I submit the comment- I get a popup to save a file (there is no file to save).</p>\n\n<p><a href=\"https://i.stack.imgur.com/sku5k.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sku5k.png\" alt=\"chrome popup\"></a>\nHowever, the comment is not creating because my app thinks that one of the comment's attributes must exist, when it doesn't need to.</p>\n\n<p>This is my error when submitting:</p>\n\n<pre><code>errors: [\"Parent must exist\"]\nNo template found for Events::CommentsController#create, rendering head :no_content\n</code></pre>\n\n<p>(However, when you submit a comment with a head, it works as expected)</p>\n\n<p>comments_controller.rb</p>\n\n<pre><code>  def create\n    @comment = @commentable.comments.build(comment_params)\n    if @comment.save\n      flash[:success] = \"Your comment was successfully saved.\"\n      redirect_to @commentable\n    else\n      puts \"errors: #{@comment.errors.full_messages}\"\n      flash[:danger] = \"Uh Oh\"\n    end\n  end\n</code></pre>\n\n<p>schema.rb</p>\n\n<pre><code>  create_table \"comments\", force: :cascade do |t|\n    t.integer \"parent_id\"\n    t.string \"commentable_type\"\n    t.bigint \"commentable_id\"\n  end\n</code></pre>\n\n<p>comment.rb</p>\n\n<pre><code>class Comment &lt; ApplicationRecord\n  belongs_to :commentable, polymorphic: true\n\n  belongs_to :parent, class_name: \"Comment\"\n  has_many :children, class_name: \"Comment\", foreign_key: :parent_id, dependent: :destroy\nend\n</code></pre>\n\n<p>new_comment_form.html.erb</p>\n\n<pre><code>&lt;%= form_for [commentable, Comment.new] do |f| %&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;div class=\"col-6\"&gt;\n      &lt;%= f.text_area :body, class: \"form-control\", placeholder: \"\", style: \"height: 200px;\" %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;div class=\"col-3\"&gt;\n      &lt;%= f.submit \"add comment\", class: \"btn btn-light \", id: \"submit-comment\" %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"tags": [], "owner": {"reputation": 143, "user_id": 2279162, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/6d9cd3ffd188760fa4e7ceca4b990009?s=128&d=identicon&r=PG", "display_name": "anks", "link": "https://stackoverflow.com/users/2279162/anks"}, "is_accepted": false, "score": 0, "last_activity_date": 1553808590, "creation_date": 1553808590, "answer_id": 55407134, "question_id": 55365381, "link": "https://stackoverflow.com/questions/55365381/how-to-hook-after-example-has-execution-result-and-status-with-aggregated-failu/55407134#55407134", "title": "How to hook after example has execution result and status with :aggregated_failures flag", "body": "<p>So basically all I had to was to use a reporter listener and process notifications inside it :)</p>\n\n<pre><code>config.reporter.register_listener RSpec::Testrail::Listener.new, :start, :example_failed, :example_passed, :example_pending, :stop\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 2279162, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/6d9cd3ffd188760fa4e7ceca4b990009?s=128&d=identicon&r=PG", "display_name": "anks", "link": "https://stackoverflow.com/users/2279162/anks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 243, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553808590, "creation_date": 1553630475, "question_id": 55365381, "link": "https://stackoverflow.com/questions/55365381/how-to-hook-after-example-has-execution-result-and-status-with-aggregated-failu", "title": "How to hook after example has execution result and status with :aggregated_failures flag", "body": "<p>I'm maintaining a standalone test automation suite written in Rspec &amp; Capybara and SitePrism (No Rails).</p>\n\n<p>Recently I started integrating it with Testrail for reporting - I used <a href=\"https://github.com/dmitryzuev/rspec-testrail\" rel=\"nofollow noreferrer\">rspec-testrail</a> gem for that but I had to modify it a bit, because I also wanted to send Slack notifications with test progress and report.</p>\n\n<p>Anyway, the integration works smoothly, except the fact that example processing is relying on example having an exception and lack of exception causes setting the test status as Passed on Testrail.\nAs it appears, <code>after :each</code> nor <code>after :example</code> in <code>Rspec.configure</code> doesn't guarantee that the example has finished running.\nI also tried <code>around :example</code> and <code>around :each</code> as described <a href=\"https://relishapp.com/rspec/rspec-core/v/2-0/docs/hooks/around-hooks#before/after(:each)-hooks-are-wrapped-by-the-around-hook\" rel=\"nofollow noreferrer\">here</a>, but to no avail.</p>\n\n<p>I inspected contents of <code>example.metadata</code> and it looks that <code>example.metadata[:execution_result]</code> has only <code>started_at</code> variable, but a finished example would have also <code>finished_at</code> and <code>status</code> variables, according <a href=\"https://www.rubydoc.info/gems/rspec-core/RSpec/Core/Example/ExecutionResult\" rel=\"nofollow noreferrer\">to the docs</a></p>\n\n<p>My suspicion (after reading the relish docs) is that <code>:aggregated_failures</code> is the cause of different metadata structure and multiple expects running in threads that are later merged into one backtrace. </p>\n\n<p>Do you know how can I wait for the example to finish or how to hook into the state where it's finished? \nOr maybe I should create a custom formatter where I would hook after example notifications printed to the console (I would like to keep the stacktrace there).</p>\n\n<p>My code is as follows:</p>\n\n<p>Test (both assertions are failing):</p>\n\n<pre><code>require 'spec_helper'\n\nfeature 'Sign in' do\n  let(:login_page) { LoginPage.new }\n  let(:user) { { email: ENV['ADMIN_EMAIL'], password: ENV['ADMIN_PASSWORD'] } }\n\n  scenario 'is successful and user is redirected to dashboard for user with correct credentials', testrail_id: 5694 do\n    login_page.load\n    login_page.form.email.set(user[:email])\n    login_page.form.password.set(user[:password])\n    login_page.form.submit_btn.click\n    expect(login_page.sidebar).to have_jobs(text: \"some_nonexistenttext\")\n    login_page.logout\n    expect(current_url).to have_content \"google.com\"\n  end\nend\n</code></pre>\n\n<p>Console output from the above test:</p>\n\n<pre><code>Failures:\n\n  1) Sign in is successful and user is redirected to dashboard for user with correct credentials\n     Got 2 failures:\n\n     1.1) Failure/Error: expect(login_page.sidebar).to have_jobs(text: \"blala\")\n            expected #has_jobs?({:text=&gt;\"some_nonexistenttext\"}) to return true, got false\n          # ./spec/auth/login_spec.rb:13:in `block (3 levels) in &lt;top (required)&gt;'\n\n     1.2) Failure/Error: expect(current_url).to have_content \"google.com\"\n            expected to find text \"google.com\" in \"https://example.com/\"\n          # ./spec/auth/login_spec.rb:15:in `block (3 levels) in &lt;top (required)&gt;'\n\nFinished in 53.91 seconds (files took 1.45 seconds to load)\n4 examples, 1 failure\n\nFailed examples:\n\nrspec ./spec/auth/login_spec.rb:8 # Sign in is successful and user is redirected to dashboard for user with correct credentials\n</code></pre>\n\n<p>Spec helper:</p>\n\n<pre><code>require 'rubygems'\nrequire 'capybara/rspec'\nrequire 'selenium-webdriver'\nrequire 'site_prism'\nrequire 'slack-notifier'\n\nrequire_relative '../config'\nrequire_relative '../lib/testrail'\n\n...\n\nRSpec.configure do |config|\n  config.define_derived_metadata do |meta|\n    meta[:aggregate_failures] = true\n  end\n  config.example_status_persistence_file_path = 'examples.txt'\n  config.before :all do\n    testrail_initialize_test_run!\n  end\n\n  config.after :example, testrail_id: proc { |value| !value.nil? } do |example|\n    RSpec::Testrail.process(example)\n  end\nend\n</code></pre>\n\n<p>processing method (<a href=\"https://github.com/dmitryzuev/rspec-testrail/blob/master/lib/rspec/testrail.rb#L25-L36\" rel=\"nofollow noreferrer\">slightly modified from original</a>)</p>\n\n<pre><code>  def process(example)\n    if example.exception\n      status = 5\n      message = example.exception.message\n      slack_notifier.publish(message_text \"Failed\")\n    elsif example.skipped? || example.pending?\n      puts 'Example skipped or pending'\n      status = 10\n      message = 'Pending or not implemented'\n    else\n      status = 1\n      message = ''\n    end\n    client.send_post(\"add_result_for_case/#{testrun['id']}/#{example.metadata[:testrail_id]}\",\n                      status_id: status,\n                      comment: message)\n  end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rest-client"], "comments": [{"owner": {"reputation": 323, "user_id": 3148811, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/4c63ba4cefaf079ab64adee29e30d139?s=128&d=identicon&r=PG&f=1", "display_name": "letsbondiway", "link": "https://stackoverflow.com/users/3148811/letsbondiway"}, "edited": false, "score": 0, "creation_date": 1559076455, "post_id": 55365108, "comment_id": 99304587, "body": "your code in the question asked saved my day for my purpose!! I had been looking for it for quite few hours. Thanks, it helped."}], "owner": {"reputation": 41, "user_id": 2253760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a98743c747e1eac3c5371dea9d897f6f?s=128&d=identicon&r=PG", "display_name": "KevinU", "link": "https://stackoverflow.com/users/2253760/kevinu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1553629318, "creation_date": 1553629318, "question_id": 55365108, "link": "https://stackoverflow.com/questions/55365108/post-transfer-progress-for-large-file-with-restclient-for-rails", "title": "POST transfer progress for large file with RestClient for Rails", "body": "<p>I need to POST a large file (several GB) from disk to an external API from my Rails 5.2 app. The file can take up to an hour to transfer.</p>\n\n<p>I can POST the file using <a href=\"https://github.com/rest-client/rest-client\" rel=\"nofollow noreferrer\">RestClient</a>, but would like to provide a progress bar to indicate transfer progress.  How can I tell how much of the file has been transferred? </p>\n\n<p>Working POST request (without progress):</p>\n\n<pre><code>RestClient::Request.execute(\n  :url =&gt; api_url,\n  :method =&gt; :post,\n  :headers =&gt; {\n    'Authorization' =&gt; token,\n    'Content-Type' =&gt; 'application/octet-stream',\n  },\n  :payload =&gt; File.open(filename, \"rb\")\n)\n</code></pre>\n"}, {"tags": ["ruby", "string", "hash", "square"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1553631086, "post_id": 55365027, "comment_id": 97454576, "body": "Your first sentence is misleading because what follows is not a hash, but, as you go on to explain, is a string. You might be better off showing your return value from the Square Transaction (&quot;nounce&quot;?) or from Ajax. (I know nothing about either.) If you do that, more tags would be called for."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1553631838, "post_id": 55365027, "comment_id": 97454876, "body": "If <code>str</code> is your string (I treated it as the body of a heredoc), <code>h = eval(str)</code> (or <code>instance_eval(str)</code>) produces the hash, after which <code>h[:transaction][:tenders].first[:card_details][:card][:last_&zwnj;&#8203;4] #=&gt; &quot;9999&quot;</code>. <code>Hash.new(str)</code> merely creates an empty hash with <code>str</code> as its default value."}, {"owner": {"reputation": 15, "user_id": 9105863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48a19abced883df00e53ddcece170d3f?s=128&d=identicon&r=PG&f=1", "display_name": "whatbox", "link": "https://stackoverflow.com/users/9105863/whatbox"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1553784536, "post_id": 55365027, "comment_id": 97521554, "body": "RE: You might be better off showing your return value from the Square Transaction (&quot;nounce&quot;?) or from Ajax.   nonce is the term for the response that comes from Square: <a href=\"https://docs.connect.squareup.com/payments/sqpaymentform/setup?q=card-nonce#step-6-set-the-form-action-parameter\" rel=\"nofollow noreferrer\">docs.connect.squareup.com/payments/sqpaymentform/&hellip;</a>  Square returns the nonce as a string that they populate into the value of a hidden input field.  I passed that field value to Ruby through a JSON string in an AJAX call.  I pasted the actual string - exception I added carriage returns to emphasize the structure.  The tags are appropriate for search purposes."}], "answers": [{"tags": [], "owner": {"reputation": 15, "user_id": 9105863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48a19abced883df00e53ddcece170d3f?s=128&d=identicon&r=PG&f=1", "display_name": "whatbox", "link": "https://stackoverflow.com/users/9105863/whatbox"}, "is_accepted": false, "score": 0, "last_activity_date": 1553783284, "last_edit_date": 1553783284, "creation_date": 1553632415, "answer_id": 55365773, "question_id": 55365027, "link": "https://stackoverflow.com/questions/55365027/how-to-parse-square-response-nested-key-values-in-ruby-2-2-10/55365773#55365773", "title": "How to parse Square response nested key values in Ruby 2.2.10", "body": "<p>Cary, that worked!</p>\n\n<pre><code>sqresp = instance_eval(square_resp)\nsqresp[:transaction][:tenders].first[:card_details][:card][:last_4]\n\n</code></pre>\n\n<p>Thanks!\nThere's no option to vote for your comment.</p>\n"}], "owner": {"reputation": 15, "user_id": 9105863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48a19abced883df00e53ddcece170d3f?s=128&d=identicon&r=PG&f=1", "display_name": "whatbox", "link": "https://stackoverflow.com/users/9105863/whatbox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553871664, "creation_date": 1553628958, "last_edit_date": 1553871664, "question_id": 55365027, "link": "https://stackoverflow.com/questions/55365027/how-to-parse-square-response-nested-key-values-in-ruby-2-2-10", "title": "How to parse Square response nested key values in Ruby 2.2.10", "body": "<p>How would you get the value of the last_4 key form this hash?</p>\n\n<p>I have a response nonce from a Square transaction.  I pass the response through Ajax to Ruby where it comes out as a parameter string.  Iv'e tried converting the string to a hash.  I've also tried JSON.parse.  </p>\n\n<p>This is an actual response nonce from a Square sandbox transaction.  I've truncated some of the IDs and replaced others.  Also i put in carriage returns to make it more human readable:</p>\n\n<pre><code>{:transaction=&gt;{\n    :id=&gt;\"smqfzS00qbp1lOy...\", \n    :location_id=&gt;\"CBASE...\", \n    :created_at=&gt;\"2019-02-19T19:45:18Z\", \n    :tenders=&gt;[{\n        :id=&gt;\"34670bfa-9d09-406a-910c-9c3e8ab82321\", \n        :location_id=&gt;\"CBASE...\", \n        :transaction_id=&gt;\"smqfzS00qbp1lOy...\", \n        :created_at=&gt;\"2019-02-19T19:45:18Z\", \n        :note=&gt;\"Online Transaction\", \n        :amount_money=&gt;{\n            :amount=&gt;65000, \n            :currency=&gt;\"USD\"\n            }, \n        :type=&gt;\"CARD\", \n        :card_details=&gt;{\n                :status=&gt;\"CAPTURED\", \n                :card=&gt;{\n                    :card_brand=&gt;\"VISA\", \n                    :last_4=&gt;\"9999\", \n                    :fingerprint=&gt;\"22737c9b012a...\"\n                    }, \n        :entry_method=&gt;\"KEYED\"\n        }\n    }], \n    :product=&gt;\"EXTERNAL_API\"\n    }\n}\n</code></pre>\n\n<p>I have it as a string from an ajax call and convert it to a hash or parse it:</p>\n\n<pre><code>sqresp = Hash.new(square_resp) # this works\nsqresp = JSON.parse(square_resp) # this fails\n</code></pre>\n\n<p>I've tried pulling out just the id, which is the first nested key:</p>\n\n<pre><code>sqresp[:transaction] # this works but I get the whole string\n</code></pre>\n\n<p>But if I go any deeper it fails:</p>\n\n<pre><code>sqresp[:transaction][:id] # this fails\nsqresp[:transaction[:id]] # kinda makes sense but fails\nsqresp[:transaction][:tenders][:amount_money][:card_details][:card][:last_4] # of course this fails too,it's just a deeper scrape.\n</code></pre>\n\n<p>It would be great to have a Ruby method for breaking out all the Square key/values but with an example of how to pull out last_4, I can do the rest. </p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby", "google-ads-api", "adwords-api-v201802"], "comments": [{"owner": {"reputation": 579, "user_id": 11206879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bS2D6.png?s=128&g=1", "display_name": "Pan Ke", "link": "https://stackoverflow.com/users/11206879/pan-ke"}, "edited": false, "score": 3, "creation_date": 1553642854, "post_id": 55364683, "comment_id": 97458830, "body": "seems you declare <code>authorizer</code> but never use."}], "answers": [{"tags": [], "owner": {"reputation": 4399, "user_id": 8605685, "user_type": "registered", "profile_image": "https://graph.facebook.com/1617447244946495/picture?type=large", "display_name": "Matthew Salvatore Viglione", "link": "https://stackoverflow.com/users/8605685/matthew-salvatore-viglione"}, "is_accepted": false, "score": 1, "last_activity_date": 1554404545, "last_edit_date": 1592644375, "creation_date": 1554403474, "answer_id": 55522986, "question_id": 55364683, "link": "https://stackoverflow.com/questions/55364683/google-adwords-api-how-to-authorize-with-service-account-impersonation/55522986#55522986", "title": "Google adwords api how to authorize with service account impersonation", "body": "<p>From Google's docs <a href=\"https://developers.google.com/adwords/api/docs/guides/authentication\" rel=\"nofollow noreferrer\">here</a>:</p>\n<blockquote>\n<p>All AdWords API calls <strong>must</strong> be authorized through OAuth2. OAuth2 enables your AdWords API client app to access a user's Google Ads account without having to handle or store the user's login info.</p>\n</blockquote>\n<p>It appears you have to use <code>OAuth2</code> Authentication.</p>\n<p>Further reading <a href=\"https://developers.google.com/adwords/api/docs/guides/first-api-call#request_a_developer_token\" rel=\"nofollow noreferrer\">here</a> confirms this:</p>\n<blockquote>\n<p>Your app will need to access user data and contact other Google services on your behalf. Authentication via OAuth2 allows your app to operate on behalf of your account.</p>\n<p>To enable your app to access the API, you need an OAuth2 client ID and client secret.</p>\n</blockquote>\n<p>You say you have done this somewhere else where you were able to use a JSON file, so I looked into the source a little.</p>\n<p>The source for the Ruby API is <a href=\"https://github.com/googleads/google-api-ads-ruby/blob/master/adwords_api/lib/adwords_api/credential_handler.rb\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://github.com/googleads/google-api-ads-ruby/blob/master/adwords_api/lib/adwords_api.rb\" rel=\"nofollow noreferrer\">here</a>. It appears there really is no other way to manage credentials, at least in the Ruby API. Looking here:</p>\n<pre><code>    # Retrieve correct soap_header_handler.\n    #\n    # Args:\n    # - auth_handler: instance of an AdsCommon::Auth::BaseHandler subclass to\n    #   handle authentication\n    # - version: intended API version\n    # - header_ns: header namespace\n    # - default_ns: default namespace\n    #\n    # Returns:\n    # - SOAP header handler\n    #\n    def soap_header_handler(auth_handler, version, header_ns, default_ns)\n      auth_method = @config.read('authentication.method', :OAUTH2)\n      handler_class = case auth_method\n        when :OAUTH2, :OAUTH2_SERVICE_ACCOUNT\n          AdsCommon::SavonHeaders::OAuthHeaderHandler\n        else\n          raise AdsCommon::Errors::AuthError,\n              &quot;Unknown auth method: %s&quot; % auth_method\n        end\n      return handler_class.new(@credential_handler, auth_handler, header_ns,\n                                  default_ns, version)\n    end\n</code></pre>\n<p>Notice that unless OAuth is used, it throws an error. There really is no other way to authenticate. Even if you managed to authenticate another way and try passing it to the credential manager, it will reject it.</p>\n<p>Short answer: This is not possible in the Ruby API without hacking it some way.</p>\n"}], "owner": {"reputation": 1176, "user_id": 951321, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9eb886c753c17c33ba7fd8061af43e3f?s=128&d=identicon&r=PG", "display_name": "markhorrocks", "link": "https://stackoverflow.com/users/951321/markhorrocks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 625, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1554412818, "creation_date": 1553627599, "last_edit_date": 1554412818, "question_id": 55364683, "link": "https://stackoverflow.com/questions/55364683/google-adwords-api-how-to-authorize-with-service-account-impersonation", "title": "Google adwords api how to authorize with service account impersonation", "body": "<p>I'm trying to develop a ruby script to query the Google Adwords API using service account credentials. I know that the json credentials file works in another script which isn't ruby but I can't get past authorization in this ruby script. I can't find any examples using this pattern. I don't want to use <code>OAuth2</code>. I know this script is not well developed but I'm just trying to get the basics. What am I doing wrong here?</p>\n\n<p>My company has a G Suite account and I have full administrator permissions.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>    #!/usr/bin/ruby\n\n    require 'googleauth'\n    require 'fileutils'\n    require 'adwords_api'\n\n    API_VERSION = :v201809\n\n    scopes = [\"https://www.googleapis.com/auth/adwords\"]\n    credential_file = File.open('credentials/adwords-production.json')\n    prn = \"adwords@mycompany.com\"\n\n    authorizer = Google::Auth::ServiceAccountCredentials.make_creds(json_key_io: credential_file, scope: scopes, prn: prn)\n\n    def get_report_fields(report_type)\n\n      adwords = AdwordsApi::Api.new\n\n      report_def_srv = adwords.service(:ReportDefinitionService, API_VERSION)\n\n      # Get report fields.\n      fields = report_def_srv.get_report_fields(report_type)\n      if fields\n        puts \"Report type '%s' contains the following fields:\" % report_type\n        fields.each do |field|\n          puts ' - %s (%s)' % [field[:field_name], field[:field_type]]\n          puts '  := [%s]' % field[:enum_values].join(', ') if field[:enum_values]\n        end\n      end\n    end\n\n    begin\n        report_type = 'ACCOUNT_PERFORMANCE_REPORT'\n        get_report_fields(report_type)\n    end\n\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1553627367, "post_id": 55364527, "comment_id": 97452987, "body": "You can however use <code>rubygems</code> and the <code>gem</code> method without a Gemfile to specify a given version e.g. <code>require &#39;rubygems&#39;; gem &#39;google_drive&#39;, &#39;2.1.11&#39;; require &#39;google_drive&#39;</code> in this case the version will be maintained due to the patches made to <code>Kernel</code> by  <code>rubygems</code> <a href=\"https://github.com/rubygems/rubygems/tree/master/lib/rubygems/core_ext\" rel=\"nofollow noreferrer\">Source</a>"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1553632114, "post_id": 55364527, "comment_id": 97454992, "body": "@engineersmnky tried that in irb and got <code>Gem::MissingSpecVersionError: Gem::MissingSpecVersionError</code>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1553633887, "post_id": 55364527, "comment_id": 97455711, "body": "Do you have that gem actually installed? You still need to <code>gem install xxx</code> just like you would need to do for require naturally. My point was that you can specify a version using <code>rubygems</code>"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1553634538, "post_id": 55364527, "comment_id": 97456003, "body": "@engineersmnky yes I installed the gem before running your code in the console."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1553636333, "post_id": 55364527, "comment_id": 97456718, "body": "You installed version 2.1.11 correct? If so I am not sure what the issue is and I am away from my computer right now but I actively use this functionality in production processes on a daily basis so I am certain that it works."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1553681380, "post_id": 55364527, "comment_id": 97471298, "body": "@engineersmnky yeah it works when I specify version with <code>gem install google_drive -v 2.1.11</code> thanks, I updated answer."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 4, "last_activity_date": 1553681262, "last_edit_date": 1553681262, "creation_date": 1553626899, "answer_id": 55364527, "question_id": 55364429, "link": "https://stackoverflow.com/questions/55364429/do-we-need-require-and-gemfile-at-the-same-time/55364527#55364527", "title": "Do we need require and Gemfile at the same time?", "body": "<p>The purpose of the Gemfile can be helpful so that you can insure your code will work by using <a href=\"https://bundler.io/\" rel=\"nofollow noreferrer\">bundler</a> which allows you to run <code>bundle install</code> which will install the gems to work with the current version of ruby you will be using for your code. It will also add a <code>Gemfile.lock</code> file which is a good idea to commit in your version control to insure you have a working stack where the gems and the ruby version are all compatible.</p>\n\n<p>If you only require the files in your script, there is no guaranteed that the gems are actually installed in the scope of that script's runner.  So by having a <code>Gemfile</code> and <code>Gemfile.lock</code> and using bundler, you can have portability for your codebase. </p>\n\n<h3>Update</h3>\n\n<p>As per comment by @engineersmnky , you can specify gem version however with this syntax and it should work so long as those gems are installed.  You would first need to make sure to install the version in your terminal:</p>\n\n<pre><code>gem install google_drive -v 2.1.11\n</code></pre>\n\n<p>Then you can do this in your ruby file</p>\n\n<pre><code>require 'rubygems' \ngem 'google_drive', '2.1.11'; \nrequire 'google_drive' \nrequire 'typhoeus'\nrequire 'json'\nrequire 'pg' \nrequire 'mandrill-api' \n</code></pre>\n"}], "owner": {"reputation": 329, "user_id": 6679011, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f5c9a7d025e5cf7734e8d6de19a2113?s=128&d=identicon&r=PG&f=1", "display_name": "Yang L", "link": "https://stackoverflow.com/users/6679011/yang-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 55364527, "answer_count": 1, "score": 1, "last_activity_date": 1553681262, "creation_date": 1553626499, "question_id": 55364429, "link": "https://stackoverflow.com/questions/55364429/do-we-need-require-and-gemfile-at-the-same-time", "title": "Do we need require and Gemfile at the same time?", "body": "<p>In a ruby program, there is a separate Gem file, which contains the following definitions:</p>\n\n<pre><code>\nsource \"https://rubygems.org\" \ngem \"typhoeus\" \ngem \"json\" \ngem \"pg\" \ngem \"google_drive\" , \"2.1.11\" \ngem \"mandrill-api\"\n</code></pre>\n\n<p>If I do not want this gem file for some reason, then in ruby script, I need to add require for all the libraries, \nsuch as:</p>\n\n<pre><code> \nrequire typhoeus\nrequire json\nrequire pg\nrequire google_drive, 2.1.11\nrequire mandrill-api \n</code></pre>\n\n<p>will this work?</p>\n"}, {"tags": ["ruby", "datetime", "case", "strftime"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1553625940, "post_id": 55363924, "comment_id": 97452309, "body": "What is <code>And</code> ?"}, {"owner": {"reputation": 4121, "user_id": 2098932, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/BBJGp.jpg?s=128&g=1", "display_name": "Logicrat", "link": "https://stackoverflow.com/users/2098932/logicrat"}, "edited": false, "score": 0, "creation_date": 1553629805, "post_id": 55363924, "comment_id": 97454057, "body": "If you are confident that <code>date</code> begins with a digit, you could simply use <code>date.to_i</code> to get its integer value."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1554519024, "post_id": 55363924, "comment_id": 97793519, "body": "If you found either answer helpful please consider selecting one."}], "answers": [{"tags": [], "owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "is_accepted": true, "score": 1, "last_activity_date": 1553627108, "last_edit_date": 1553627108, "creation_date": 1553626741, "answer_id": 55364485, "question_id": 55363924, "link": "https://stackoverflow.com/questions/55363924/how-can-i-pull-a-dates-number-from-a-scenario-example-and-use-it-to-move-my-dat/55364485#55364485", "title": "How can i pull a date&#39;s number from a scenario example and use it to move my date x day(s) in adv and then convert it to STRFTIME?", "body": "<p>As idea for you</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>date = \"3 days from now\"\n\ndate = \"#{(Date.today + date.match(/\\A\\d+(?!days from now\\z)/)[0].to_i).strftime('%a %-e')} Tasks\" if date.match?(/\\A\\d+ days from now\\z/)\n# =&gt; \"Fri 29 Tasks\"\n</code></pre>\n\n<p><code>date.match?(/\\A\\d+ days from now\\z/)</code> returns <code>true</code> or <code>false</code></p>\n\n<p><code>date.match(/\\A\\d+(?!days from now\\z)/)[0]</code> returns substring with days quantity (<code>\"3\"</code>).</p>\n\n<p>Negative lookahead <code>(?!...)</code> used here.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1553627644, "creation_date": 1553627644, "answer_id": 55364697, "question_id": 55363924, "link": "https://stackoverflow.com/questions/55363924/how-can-i-pull-a-dates-number-from-a-scenario-example-and-use-it-to-move-my-dat/55364697#55364697", "title": "How can i pull a date&#39;s number from a scenario example and use it to move my date x day(s) in adv and then convert it to STRFTIME?", "body": "<pre><code>require 'date'\n\ndef doit(str)\n  n = case str\n  when /\\btoday\\b/\n    0\n  when /\\btomorrow\\b/\n    1\n  when /\\bdays from now\\b/\n    str[/\\d+/].to_i\n  else\n    nil\n  end\n  n.nil? ? nil : (Date.today+n).strftime('%a %-e Tasks')\nend\n\ndoit \"today\"                 #=&gt; \"Tue 26 Tasks\" \ndoit \"No rain today?\"        #=&gt; \"Tue 26 Tasks\" \ndoit \"todayornottoday\"       #=&gt; nil \ndoit \"tomorrow\"              #=&gt; \"Wed 27 Tasks\" \ndoit \"2 days from now\"       #=&gt; \"Thu 28 Tasks\" \ndoit \"1 Monday from now\"     #=&gt; nil \n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10408562, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fdcYHiRPBRM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVmX-eo4YpFLxn9hLhhJoinba3PA/mo/photo.jpg?sz=128", "display_name": "AA.", "link": "https://stackoverflow.com/users/10408562/aa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 55364485, "answer_count": 2, "score": 0, "last_activity_date": 1553627644, "creation_date": 1553624610, "question_id": 55363924, "link": "https://stackoverflow.com/questions/55363924/how-can-i-pull-a-dates-number-from-a-scenario-example-and-use-it-to-move-my-dat", "title": "How can i pull a date&#39;s number from a scenario example and use it to move my date x day(s) in adv and then convert it to STRFTIME?", "body": "<p>I am having problems understanding how to strip the number '2' from \"2 days from now\" and then use that to increment my date by two days. so something like date = (Date.today + 2).strftime('%a %-e') aka two days forward. </p>\n\n<p>My 'puts' are just so i can see if the correct date is being outputted. In this situation i am having problems with the third case.</p>\n\n<p>As you can see, I need, verbatim, the date to equal \"Thur 26 Tasks\"</p>\n\n<pre><code>And(/^I can see the correct task lists details for (.*)$/) do |date|\n\n  sleep 1\n  case\n  when date == (\"today\")\n    date = Date.today.strftime('%a %-e') + \" Tasks\"\n    puts date\n  when date == (\"tomorrow\")\n    date = (Date.today + 1).strftime('%a %-e') + \" Tasks\"\n    puts date\n  when date.downcase.include?(\"days from now\")\n    date = ((Date.today + [/\\d*/]) + \" Tasks\")\n    puts date\n  end\n  TasksPage.todays_tasks_title.click unless exists {$driver.text(date)}\n</code></pre>\n\n<p>end</p>\n"}, {"tags": ["ruby", "text"], "comments": [{"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 1, "creation_date": 1553623015, "post_id": 55363487, "comment_id": 97450864, "body": "it should start with <code>if</code>, not <code>elsif</code>"}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 1, "creation_date": 1553623618, "post_id": 55363487, "comment_id": 97451176, "body": "And it should end with <code>end</code>."}, {"owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "edited": false, "score": 1, "creation_date": 1553624639, "post_id": 55363487, "comment_id": 97451689, "body": "And <code>grep</code> is <code>Enumerable</code> method."}, {"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 2, "creation_date": 1553633190, "post_id": 55363487, "comment_id": 97455445, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/633396/whats-the-best-way-to-search-for-a-string-in-a-file\">What&#39;s the best way to search for a string in a file?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 11257686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c92fe650052f8870c25e9d03d51a805?s=128&d=identicon&r=PG&f=1", "display_name": "powwu", "link": "https://stackoverflow.com/users/11257686/powwu"}, "edited": false, "score": 0, "creation_date": 1553649168, "post_id": 55363895, "comment_id": 97460173, "body": "Thank you so much! you&#39;re a true lifesaver. I&#39;m new to ruby, and this helps loads. Thank you!"}, {"owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "reply_to_user": {"reputation": 27, "user_id": 11257686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c92fe650052f8870c25e9d03d51a805?s=128&d=identicon&r=PG&f=1", "display_name": "powwu", "link": "https://stackoverflow.com/users/11257686/powwu"}, "edited": false, "score": 1, "creation_date": 1553649265, "post_id": 55363895, "comment_id": 97460188, "body": "Glad I could help"}], "tags": [], "owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "is_accepted": true, "score": 4, "last_activity_date": 1553624480, "creation_date": 1553624480, "answer_id": 55363895, "question_id": 55363487, "link": "https://stackoverflow.com/questions/55363487/how-to-scan-text-file-for-string-and-run-code-if-string-isnt-there/55363895#55363895", "title": "How to scan text file for string, and run code if string isn&#39;t there?", "body": "<p>You can use <a href=\"https://ruby-doc.org/core-2.6.1/IO.html#method-c-read\" rel=\"nofollow noreferrer\"><code>IO::read</code></a> to assign text file content and then <a href=\"https://ruby-doc.org/core-2.6.1/String.html#method-i-include-3F\" rel=\"nofollow noreferrer\"><code>String#include?</code></a> for checking.</p>\n\n<pre><code>file_string = File.read('path/to/file')\n\nif file_string.include?('substring')\n  puts 'Yes'\nelse\n  puts 'No'\nend\n</code></pre>\n\n<p>Also you can replace it by <a href=\"https://ruby-doc.org/core-2.6.1/String.html#method-i-match-3F\" rel=\"nofollow noreferrer\"><code>String#match?</code></a> (it is faster).</p>\n\n<p><code>file_string.match?(/pattern/)</code> will return <code>true</code> or <code>false</code>.</p>\n"}], "owner": {"reputation": 27, "user_id": 11257686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c92fe650052f8870c25e9d03d51a805?s=128&d=identicon&r=PG&f=1", "display_name": "powwu", "link": "https://stackoverflow.com/users/11257686/powwu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 55363895, "answer_count": 1, "score": 1, "last_activity_date": 1553624480, "creation_date": 1553622910, "question_id": 55363487, "link": "https://stackoverflow.com/questions/55363487/how-to-scan-text-file-for-string-and-run-code-if-string-isnt-there", "title": "How to scan text file for string, and run code if string isn&#39;t there?", "body": "<p>I have tried:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>elsif file.grep(/Mode: 1/)\n   puts \"test\"\nelse\n   puts \"test but else\" \n</code></pre>\n\n<p>Codacy is saying this is wrong. Is there a way to improve this? According to Codacy: </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>unexpected token kELSIF (Using Ruby 2.2 parser; configure using `TargetRubyVersion` parameter, under `AllCops`)\n\nunexpected token kELSE (Using Ruby 2.2 parser; configure using `TargetRubyVersion` parameter, under `AllCops`)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongodb", "aggregation-framework", "mongoid6"], "answers": [{"comments": [{"owner": {"reputation": 1443, "user_id": 4064922, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-2_1oNmjkoec/AAAAAAAAAAI/AAAAAAAAAXE/OTUcRfaAZeM/photo.jpg?sz=128", "display_name": "Aboozar Rajabi", "link": "https://stackoverflow.com/users/4064922/aboozar-rajabi"}, "edited": false, "score": 1, "creation_date": 1553682320, "post_id": 55364905, "comment_id": 97471833, "body": "Thanks Kan. The answer is true. The only side-effect it has is doing an extra <code>$match</code> in case of <code>else</code> which is inevitable."}], "tags": [], "owner": {"reputation": 93, "user_id": 10066301, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iVtZx8eYT88/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r3NgA3fleTc0rFLpDmB--TkpFpgg/mo/photo.jpg?sz=128", "display_name": "Kan A", "link": "https://stackoverflow.com/users/10066301/kan-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1553769979, "last_edit_date": 1553769979, "creation_date": 1553628521, "answer_id": 55364905, "question_id": 55363200, "link": "https://stackoverflow.com/questions/55363200/mongoid-aggregation-with-conditions/55364905#55364905", "title": "Mongoid aggregation with conditions", "body": "<p>I don't know ruby, but maybe I understand your problem.</p>\n\n<p>Pseudo-code</p>\n\n<pre><code># DON'T DO SO! SEE UPDATE BELOW\nif your_condition is true:\n  filter = { field: 'some value' }\nelse:\n  filter = { # always true condition\n    $or: [\n       { field: { $exists: true } },\n       { field: { $exists: false } }\n    ]\n  }\n\nMessage.collection.aggregate([\n  # ...\n  {\n    \"$match\": filter\n  }\n])\n</code></pre>\n\n<p><strong>UPDATE</strong>:\nAs Aboozar Rajabi noted, if condition is true then we can just add <code>$match</code> stage to pipeline:</p>\n\n<pre><code>pipeline = [\n    # stages\n];\n\nif condition is true:\n  pipeline.push({\n      $match: {\n          # filter\n      }\n  });\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1443, "user_id": 4064922, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-2_1oNmjkoec/AAAAAAAAAAI/AAAAAAAAAXE/OTUcRfaAZeM/photo.jpg?sz=128", "display_name": "Aboozar Rajabi", "link": "https://stackoverflow.com/users/4064922/aboozar-rajabi"}, "is_accepted": false, "score": 0, "last_activity_date": 1553693595, "creation_date": 1553693595, "answer_id": 55378498, "question_id": 55363200, "link": "https://stackoverflow.com/questions/55363200/mongoid-aggregation-with-conditions/55378498#55378498", "title": "Mongoid aggregation with conditions", "body": "<p>The above pseudo-code (Kan A's answer) is translated to Ruby and Mongoid aggregation framework as its syntax might be a bit confusing and there're a few Mongoid aggregation examples online:</p>\n\n<pre><code> if not params[:field].blank?\n  filter = { \"db_field_name\": params[:field] }\nelse\n  filter = { \n        '$or' =&gt; [ \n              { \"db_field_name\" =&gt; { '$exists' =&gt; true } }, \n              { \"db_field_name\" =&gt; { '$exists' =&gt; false } }\n                 ] \n           }\nend\n</code></pre>\n\n<p>I hope it would help the others who will see this page later. Also, this solution and the code in the question would be an example of using MongoDB aggregation framework in a Rails or Ruby project.</p>\n"}], "owner": {"reputation": 1443, "user_id": 4064922, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-2_1oNmjkoec/AAAAAAAAAAI/AAAAAAAAAXE/OTUcRfaAZeM/photo.jpg?sz=128", "display_name": "Aboozar Rajabi", "link": "https://stackoverflow.com/users/4064922/aboozar-rajabi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 55364905, "answer_count": 2, "score": 0, "last_activity_date": 1553769979, "creation_date": 1553621823, "last_edit_date": 1553680859, "question_id": 55363200, "link": "https://stackoverflow.com/questions/55363200/mongoid-aggregation-with-conditions", "title": "Mongoid aggregation with conditions", "body": "<p>I'm using the mongoid 6.1.0 aggregation framework in my Rails 5 project. I need to add a <code>$match</code> pipeline if the value of a search field (text or select field) is not empty. Otherwise, it should be ignored and don't filter results. Something like:</p>\n\n<pre><code>@messages = Message.collection.aggregate([\n        { '$match' =&gt; {'month': {'$gte' =&gt; @fr_mnth, '$lte' =&gt; @to_mnth}}},\n        { '$group' =&gt; {'_id': '$mmsi'} },\n        { '$lookup' =&gt; {'from': 'ships', 'localField': \"_id\", 'foreignField': \"mmsi\", as: \"ship\"}},\n        { '$match' =&gt; {\"ship.n2\": params[:n2] if !params[:n2].blank? }}\n      ]).allow_disk_use(true)\n</code></pre>\n\n<p>or to be more clear:</p>\n\n<pre><code>if not params[:n2].blank? { '$match' =&gt; {\"ship.n2\": params[:n2] }}\n</code></pre>\n\n<p>The problem is that <code>if !params[:n2].blank?</code> cannot be included in the aggregation framework. Is there any other alternative solution?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 5, "creation_date": 1553615168, "post_id": 55361017, "comment_id": 97446233, "body": "I would suggest a default of <code>false</code> for the <code>duplicate_domain</code> attribute. You could make this retroactive by adding <code>GolfRetailer.where(duplicate_domain: nil).update_all(duplicate_domain: false)</code>. Once the only options are true or false then the first query should work fine. The problem is right now this is 3 state (true, false, or nil) and not(true) does not equal NULL in SQL."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1553620037, "post_id": 55361017, "comment_id": 97449243, "body": "I would strongly recommend switching to <code>t.boolean &quot;duplicate_domain&quot;, null: false</code> for the column, <code>null</code> in a boolean column is rarely what you want. Also, indexing a boolean column (or any low cardinality column) probably won&#39;t help, check the EXPLAIN output on your queries to see if that index ever gets used."}, {"owner": {"reputation": 520, "user_id": 5839652, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/zfBMT.jpg?s=128&g=1", "display_name": "Rich", "link": "https://stackoverflow.com/users/5839652/rich"}, "edited": false, "score": 0, "creation_date": 1553687374, "post_id": 55361017, "comment_id": 97474991, "body": "These comments were helpful in giving me a better insight in good design. Thank you for taking the time to explain that."}], "answers": [{"tags": [], "owner": {"reputation": 2475, "user_id": 1298944, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/717c09c121dd66d83aa8b729f4b92973?s=128&d=identicon&r=PG", "display_name": "Scott Bartell", "link": "https://stackoverflow.com/users/1298944/scott-bartell"}, "is_accepted": true, "score": 5, "last_activity_date": 1553623849, "last_edit_date": 1553623849, "creation_date": 1553618257, "answer_id": 55362140, "question_id": 55361017, "link": "https://stackoverflow.com/questions/55361017/active-record-where-not-boolean-true/55362140#55362140", "title": "Active Record Where Not boolean: true", "body": "<p>This is happening because in SQL when you do a <code>!= TRUE</code>, any <code>NULL</code> values will not be included in the result. This is because the <code>NULL</code> value represents an <em>unknown value</em>, so the DB does not know how to do any <a href=\"https://www.postgresql.org/docs/9.1/functions-comparison.html\" rel=\"nofollow noreferrer\">comparison operations</a> on an unknown value and therefore they're excluded.</p>\n\n<p>One way to get around this is to use <a href=\"https://wiki.postgresql.org/wiki/Is_distinct_from\" rel=\"nofollow noreferrer\"><code>IS DISTINCT FROM</code></a>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>GolfRetailer\n  .where(id: 1..100)\n  .where.not(website: nil)\n  .where(\"duplicate_domain IS DISTINCT FROM ?\", true)\n</code></pre>\n\n<hr>\n\n<p>As others have mentioned, you should also ask yourself if it's really the case that it's ever unknown to you if a <code>GolfRetailer</code> has a <code>duplicate_domain</code>.</p>\n\n<p>If, all <code>GolfRetailer</code>s with a <code>duplicate_domain</code> of <code>NULL</code> actually mean they don't have one (<code>false</code>) than you should consider preventing a <code>NULL</code> value for that column entirely.</p>\n\n<p>You can do this by adding a NOT NULL constraint on the column with a <a href=\"https://edgeguides.rubyonrails.org/active_record_migrations.html#changing-columns\" rel=\"nofollow noreferrer\"><code>change_column</code> database migration</a>.</p>\n\n<p>In order to add the NOT NULL constraint you will first need to make sure all of the data in the column has non-null values.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def change\n  GolfRetailer.in_batches.update_all(duplicate_domain: false)\n\n  change_column_null :golf_retailers, :duplicate_domain\nend\n\n</code></pre>\n\n<p>If your application is under load, you should also be careful about the potential performance any migration like this might have - notably if you add a NOT NULL constraint with a default value.</p>\n\n<p>Consider using something like the <a href=\"https://github.com/ankane/strong_migrations\" rel=\"nofollow noreferrer\">Strong Migrations</a> gem to help find DB migrations that might cause downtime before production.</p>\n"}], "owner": {"reputation": 520, "user_id": 5839652, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/zfBMT.jpg?s=128&g=1", "display_name": "Rich", "link": "https://stackoverflow.com/users/5839652/rich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "accepted_answer_id": 55362140, "answer_count": 1, "score": 3, "last_activity_date": 1553623849, "creation_date": 1553614624, "last_edit_date": 1553617121, "question_id": 55361017, "link": "https://stackoverflow.com/questions/55361017/active-record-where-not-boolean-true", "title": "Active Record Where Not boolean: true", "body": "<p>I'm struggling to wrap my mind around an ActiveRecord query. </p>\n\n<p>I'm trying to search my database for GolfRetailer objects with ID's 1..100, that have something (not <code>nil</code>) in their <code>:website</code> field, and that don't have <code>true</code> in their <code>duplicate_domain</code> field.</p>\n\n<p>Here's the query I expected to work:</p>\n\n<p><code>GolfRetailer.where.not(website: nil, duplicate_domain: true).where(id: 1..100)</code></p>\n\n<p>I also tried this variant of essentially the same query: <code>GolfRetailer.where.not(website: nil).where(id: 1..100, duplicate_domain: !true)</code></p>\n\n<p>But both return an empty array, despite there definitely being records that meet those requirements. </p>\n\n<p>When I run <code>GolfRetailer.where.not(website: nil).where(id: 1..100)</code> I get an array, and when I run <code>GolfRetailer.where.not(website: nil, duplicate_domain: nil).where(id: 1..100)</code> I also get an array, but with all records that <em>do</em> have the true duplicate_domain flag, which isn't what I'm looking for. </p>\n\n<p>I'd rather not search for records that have <code>duplicate_domain: nil</code> as that's not always correct (I may not have processed their domain yet).</p>\n\n<p>For clarity, here is the Schema for the Model.</p>\n\n<pre><code>create_table \"golf_retailers\", force: :cascade do |t|\n    t.string \"name\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.string \"place_id\"\n    t.string \"website\"\n    t.string \"formatted_address\"\n    t.string \"google_places_name\"\n    t.string \"email\"\n    t.boolean \"duplicate_domain\"\n    t.index [\"duplicate_domain\"], name: \"index_golf_retailers_on_duplicate_domain\"\n  end\n</code></pre>\n\n<p>What am I missing to make this query work?</p>\n"}, {"tags": ["ruby", "nokogiri"], "comments": [{"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 3, "creation_date": 1553614363, "post_id": 55360663, "comment_id": 97445689, "body": "Try <code>doc  = Nokogiri::XML(&quot;&lt;root attr=&#39;1&#39;&gt;&lt;&#47;root&gt;&quot;)</code>.  XML attribute values should be in quotes."}, {"owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "reply_to_user": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1553800360, "post_id": 55360663, "comment_id": 97531052, "body": "I see... That&#39;s somewhat a shame. I noticed just now that HTML seems to include interpretation of numbers without quotes. So I guess it&#39;s a difference between XML and HTML spec that initially confused me. Thanks!"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1554756842, "post_id": 55360663, "comment_id": 97861550, "body": "XML is very strict."}], "answers": [{"tags": [], "owner": {"reputation": 547, "user_id": 3396971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52c75295766cfc6c5950bb398fa6c7e2?s=128&d=identicon&r=PG", "display_name": "NemyaNation", "link": "https://stackoverflow.com/users/3396971/nemyanation"}, "is_accepted": false, "score": 1, "last_activity_date": 1554757016, "last_edit_date": 1554757016, "creation_date": 1553813930, "answer_id": 55408095, "question_id": 55360663, "link": "https://stackoverflow.com/questions/55360663/nokogiri-get-attributes/55408095#55408095", "title": "Nokogiri - Get attributes?", "body": "<p>XML attribute values always need to be in quotes.</p>\n\n<p>Since you've used double-quotes on the outside, you need to use single quotes inside:</p>\n\n<pre><code>require 'nokogiri'\ndoc  = Nokogiri::XML(\"&lt;root attr='1'&gt;&lt;/root&gt;\")\ndoc.root.attributes\n</code></pre>\n\n<p>Or you can do the opposite and have the double quotes on the inside with the singular quotes on the outside.</p>\n\n<pre><code>doc  = Nokogiri::XML('&lt;root attr=\"1\"&gt;&lt;/root&gt;')\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": true, "score": 2, "last_activity_date": 1554757101, "creation_date": 1554757101, "answer_id": 55581652, "question_id": 55360663, "link": "https://stackoverflow.com/questions/55360663/nokogiri-get-attributes/55581652#55581652", "title": "Nokogiri - Get attributes?", "body": "<p>Meditate on this:</p>\n\n<pre><code>require 'nokogiri'\ndoc  = Nokogiri::XML(\"&lt;root attr=1&gt;&lt;/root&gt;\")\ndoc.errors # =&gt; [#&lt;Nokogiri::XML::SyntaxError: 1:12: FATAL: AttValue: \" or ' expected&gt;, #&lt;Nokogiri::XML::SyntaxError: 1:12: FATAL: attributes construct error&gt;, #&lt;Nokogiri::XML::SyntaxError: 1:12: FATAL: Couldn't find end of Start Tag root line 1&gt;, #&lt;Nokogiri::XML::SyntaxError: 1:12: FATAL: Extra content at the end of the document&gt;]\n</code></pre>\n\n<p><code>doc.errors</code> is your friend.</p>\n"}], "owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 55581652, "answer_count": 2, "score": 1, "last_activity_date": 1554757101, "creation_date": 1553613562, "question_id": 55360663, "link": "https://stackoverflow.com/questions/55360663/nokogiri-get-attributes", "title": "Nokogiri - Get attributes?", "body": "<p>Trying to use nokogiri to get values of attributes:</p>\n\n<pre><code>require 'nokogiri'\ndoc  = Nokogiri::XML(\"&lt;root attr=1&gt;&lt;/root&gt;\")\ndoc.root.attributes\n\n#=&gt; {}\n</code></pre>\n\n<p>Why isn't this working...?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-web-services", "rubygems", "amazon-elastic-beanstalk"], "comments": [{"owner": {"reputation": 109, "user_id": 1720976, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a38c2fb3b5c09d5449d6fc37daf79d8d?s=128&d=identicon&r=PG", "display_name": "NBarnes", "link": "https://stackoverflow.com/users/1720976/nbarnes"}, "edited": false, "score": 0, "creation_date": 1553646522, "post_id": 55360450, "comment_id": 97459683, "body": "Tried the <code>10_bundle_install.sh1</code> hack and had EB complain that I shouldn&#39;t try to install Bundler as root."}, {"owner": {"reputation": 967, "user_id": 1852005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sYSxX.jpg?s=128&g=1", "display_name": "stwr667", "link": "https://stackoverflow.com/users/1852005/stwr667"}, "reply_to_user": {"reputation": 109, "user_id": 1720976, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a38c2fb3b5c09d5449d6fc37daf79d8d?s=128&d=identicon&r=PG", "display_name": "NBarnes", "link": "https://stackoverflow.com/users/1720976/nbarnes"}, "edited": false, "score": 0, "creation_date": 1553664299, "post_id": 55360450, "comment_id": 97463298, "body": "@NBarnes, that might be because when you&#39;re running <code>eb deploy</code> you&#39;re probably connecting with the aws_access_key and aws_secret_access_key of your root AWS account. AWS recommends that you use Identity Access Management (IAM) for this purpose. It&#39;s not too hard to set up. Under IAM -&gt; Users, you&#39;ll just need to create a user with these permissions: <code>AWSElasticBeanstalkFullAccess</code> and <code>ElasticLoadBalancingFullAccess</code>. Then create access keys for that user and run <code>eb deploy</code> with that profile instead."}, {"owner": {"reputation": 109, "user_id": 1720976, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a38c2fb3b5c09d5449d6fc37daf79d8d?s=128&d=identicon&r=PG", "display_name": "NBarnes", "link": "https://stackoverflow.com/users/1720976/nbarnes"}, "edited": false, "score": 0, "creation_date": 1553730582, "post_id": 55360450, "comment_id": 97498132, "body": "Based on your suggestion, I created a new User using IAM and gave them those two permissions.  I am still getting the error about running Bundler as root, however.  I did reset the credentials in the AWS CLI; <code>cat ~&#47;.aws&#47;config</code> shows the access keys for the non-root user.  EDIT: Is the problem perhaps that in the extension file snippet below you have <code>owner</code> set to <code>root</code>?"}, {"owner": {"reputation": 967, "user_id": 1852005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sYSxX.jpg?s=128&g=1", "display_name": "stwr667", "link": "https://stackoverflow.com/users/1852005/stwr667"}, "reply_to_user": {"reputation": 109, "user_id": 1720976, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a38c2fb3b5c09d5449d6fc37daf79d8d?s=128&d=identicon&r=PG", "display_name": "NBarnes", "link": "https://stackoverflow.com/users/1720976/nbarnes"}, "edited": false, "score": 0, "creation_date": 1553747067, "post_id": 55360450, "comment_id": 97501486, "body": "I not sure @NBarnes. The <code>owner</code> of <code>root</code> below is the file owner. Whereas it sounds like your error is talking about the user being <code>root</code> while executing that file, not that the file itself is owned by <code>root</code>. If you google search &quot;install Bundler as root&quot; there are a few possible explanations. And perhaps your AWS environment is different to mine? I&#39;m running <code>Passenger with Ruby 2.6 running on 64bit Amazon Linux&#47;2.9.1</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2683, "user_id": 595152, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/c171c7edd235e33799e747bf8b7d3dbb?s=128&d=identicon&r=PG", "display_name": "Betty St", "link": "https://stackoverflow.com/users/595152/betty-st"}, "edited": false, "score": 0, "creation_date": 1561473556, "post_id": 55378320, "comment_id": 100070752, "body": "i added this file, but still got the same error, the strange thing is that i do not get the echo, but inside the archive there is the <code>.ebextensions&#47;gem_install_bundler.config</code> file in the root level -- is there something else that I have to do? I am using Ruby 2.6.3"}, {"owner": {"reputation": 967, "user_id": 1852005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sYSxX.jpg?s=128&g=1", "display_name": "stwr667", "link": "https://stackoverflow.com/users/1852005/stwr667"}, "reply_to_user": {"reputation": 2683, "user_id": 595152, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/c171c7edd235e33799e747bf8b7d3dbb?s=128&d=identicon&r=PG", "display_name": "Betty St", "link": "https://stackoverflow.com/users/595152/betty-st"}, "edited": false, "score": 1, "creation_date": 1561785911, "post_id": 55378320, "comment_id": 100184201, "body": "If you don&#39;t get the <code>echo</code> then it&#39;s not executing at all. Try moving the <code>echo</code> as the first statement to be executed, in case your above commands are failing."}, {"owner": {"reputation": 2683, "user_id": 595152, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/c171c7edd235e33799e747bf8b7d3dbb?s=128&d=identicon&r=PG", "display_name": "Betty St", "link": "https://stackoverflow.com/users/595152/betty-st"}, "edited": false, "score": 0, "creation_date": 1562068358, "post_id": 55378320, "comment_id": 100253732, "body": "I had to add <code>gem update --system</code> at the end of the file and it fixed the problem :)"}, {"owner": {"reputation": 38077, "user_id": 199712, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4fa58c43c72a15d2d560ffd931fbe9bb?s=128&d=identicon&r=PG", "display_name": "Jason Swett", "link": "https://stackoverflow.com/users/199712/jason-swett"}, "edited": false, "score": 0, "creation_date": 1566388405, "post_id": 55378320, "comment_id": 101639316, "body": "This worked for me. In my particular case I had to set the Bundler version to 2.0.2 instead of 2.0.1."}, {"owner": {"reputation": 1025, "user_id": 3207735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afdd7de86b6d49a9936cbf1b55cb8fbd?s=128&d=identicon&r=PG&f=1", "display_name": "peoplespete", "link": "https://stackoverflow.com/users/3207735/peoplespete"}, "edited": false, "score": 0, "creation_date": 1596721219, "post_id": 55378320, "comment_id": 111906487, "body": "&quot;Custom platform hooks are a legacy feature that exists on Amazon Linux AMI platforms. On Amazon Linux 2 platforms, custom platform hooks in the /opt/elasticbeanstalk/hooks/ folder are entirely discontinued.&quot; <a href=\"https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/custom-platform-hooks.html\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/elasticbeanstalk/latest/dg/&hellip;</a>"}], "tags": [], "owner": {"reputation": 967, "user_id": 1852005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sYSxX.jpg?s=128&g=1", "display_name": "stwr667", "link": "https://stackoverflow.com/users/1852005/stwr667"}, "is_accepted": true, "score": 26, "last_activity_date": 1553693115, "creation_date": 1553693115, "answer_id": 55378320, "question_id": 55360450, "link": "https://stackoverflow.com/questions/55360450/elastic-beanstalk-cant-find-gem-bundler-0-a-with-executable-bundle-gem/55378320#55378320", "title": "Elastic Beanstalk: can&#39;t find gem bundler (&gt;= 0.a) with executable bundle (Gem::GemNotFoundException)", "body": "<p>So here's the programmatic solution to the above problem. Create the below file under <code>.ebextensions/gem_install_bundler.config</code>:</p>\n\n<pre><code>files:\n  # Runs before `./10_bundle_install.sh`:\n  \"/opt/elasticbeanstalk/hooks/appdeploy/pre/09_gem_install_bundler.sh\" :\n    mode: \"000775\"\n    owner: root\n    group: users\n    content: |\n      #!/usr/bin/env bash\n\n      EB_APP_STAGING_DIR=$(/opt/elasticbeanstalk/bin/get-config container -k app_staging_dir)\n      EB_SCRIPT_DIR=$(/opt/elasticbeanstalk/bin/get-config container -k script_dir)\n      # Source the application's ruby, i.e. 2.6. Otherwise it will be 2.3, which will give this error: `bundler requires Ruby version &gt;= 2.3.0` \n      . $EB_SCRIPT_DIR/use-app-ruby.sh\n\n      cd $EB_APP_STAGING_DIR\n      echo \"Installing compatible bundler\"\n      gem install bundler -v 2.0.1\n</code></pre>\n\n<p>Then when you next <code>eb deploy</code>, the bundler will have been updated to version 2.0.1, and you won't get the above error again.</p>\n\n<p>More information in the docs here:</p>\n\n<p><a href=\"https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/custom-platform-hooks.html\" rel=\"noreferrer\">https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/custom-platform-hooks.html</a></p>\n\n<p>and here:</p>\n\n<p><a href=\"https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/customize-containers-ec2.html#linux-files\" rel=\"noreferrer\">https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/customize-containers-ec2.html#linux-files</a></p>\n\n<p>Last note: Ensure that you either commit these changes before running <code>eb deploy</code>, or stage them and run <code>eb deploy --staged</code>. See: <a href=\"https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/eb3-cli-git.html\" rel=\"noreferrer\">https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/eb3-cli-git.html</a>. I learned this the hard way!</p>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 9326108, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Z6iIuu8k-vk/AAAAAAAAAAI/AAAAAAAAAL0/ubIUlreMXDE/photo.jpg?sz=128", "display_name": "Drew Johnston", "link": "https://stackoverflow.com/users/9326108/drew-johnston"}, "is_accepted": false, "score": 1, "last_activity_date": 1560057113, "creation_date": 1560057113, "answer_id": 56512150, "question_id": 55360450, "link": "https://stackoverflow.com/questions/55360450/elastic-beanstalk-cant-find-gem-bundler-0-a-with-executable-bundle-gem/56512150#56512150", "title": "Elastic Beanstalk: can&#39;t find gem bundler (&gt;= 0.a) with executable bundle (Gem::GemNotFoundException)", "body": "<p>I only just saw this post after I had found an alternative (perhaps easier) solution: backgrading bundler to 1.17.3 (<code>gem unistall bundler</code> followed up with  <code>gem install bundler -v 1.17.3</code>)</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12008210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1d448163156071250e158800a9d9daf?s=128&d=identicon&r=PG&f=1", "display_name": "slushy-chivalry", "link": "https://stackoverflow.com/users/12008210/slushy-chivalry"}, "is_accepted": false, "score": 0, "last_activity_date": 1567400229, "creation_date": 1567400229, "answer_id": 57751598, "question_id": 55360450, "link": "https://stackoverflow.com/questions/55360450/elastic-beanstalk-cant-find-gem-bundler-0-a-with-executable-bundle-gem/57751598#57751598", "title": "Elastic Beanstalk: can&#39;t find gem bundler (&gt;= 0.a) with executable bundle (Gem::GemNotFoundException)", "body": "<p>You need the correct version of the bundler that the lockfile was generated with. To find out that version, use the following command</p>\n\n<pre><code>$ cat Gemfile.lock | grep -A 1 \"BUNDLED WITH\"\nBUNDLED WITH\n   1.17.3\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4910, "user_id": 12915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/da00ff039fffb3b17f55ebd42b397d37?s=128&d=identicon&r=PG", "display_name": "John Lemp", "link": "https://stackoverflow.com/users/12915/john-lemp"}, "is_accepted": false, "score": 1, "last_activity_date": 1613762626, "creation_date": 1613762626, "answer_id": 66283810, "question_id": 55360450, "link": "https://stackoverflow.com/questions/55360450/elastic-beanstalk-cant-find-gem-bundler-0-a-with-executable-bundle-gem/66283810#66283810", "title": "Elastic Beanstalk: can&#39;t find gem bundler (&gt;= 0.a) with executable bundle (Gem::GemNotFoundException)", "body": "<p>Here is a version that can be used on the new Amazon Linux 2 platform versions as the old <code>/opt/elasticbeanstalk/hooks/</code> folders are entirely discontinued. It parses the bundler version out of the Gemfile.lock</p>\n<p>This script would go into <code>.platform/hooks/prebuild/01_install_app_bundler.sh</code> and it needs to be marked as executable or it will fail with a permissions issue (<code>chmod +x 01_install_app_bundler.sh</code>)</p>\n<pre><code>#!/usr/bin/env bash\n\n# Load environment data\nEB_APP_STAGING_DIR=$(/opt/elasticbeanstalk/bin/get-config platformconfig -k AppStagingDir)\nEB_APP_USER=$(/opt/elasticbeanstalk/bin/get-config platformconfig -k AppUser)\nEB_APP_DEPLOY_DIR=$(/opt/elasticbeanstalk/bin/get-config platformconfig -k AppDeployDir)\n\n# Set up correct environment\nexport $(cat /opt/elasticbeanstalk/deployment/env | xargs)\n\nBUNLDER_VER_TO_INSTALL=$(grep -A 1 &quot;BUNDLED WITH&quot; Gemfile.lock | tail -n1 | tr -d ' ')\n\necho &quot;Installing bundler $BUNLDER_VER_TO_INSTALL&quot;\ngem install bundler -v $BUNLDER_VER_TO_INSTALL\n</code></pre>\n<p>I left some unused EB_ variables in there just to show how they can be determined on the updated platform.</p>\n"}], "owner": {"reputation": 967, "user_id": 1852005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sYSxX.jpg?s=128&g=1", "display_name": "stwr667", "link": "https://stackoverflow.com/users/1852005/stwr667"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3944, "favorite_count": 5, "accepted_answer_id": 55378320, "answer_count": 4, "score": 11, "last_activity_date": 1613762626, "creation_date": 1553612939, "last_edit_date": 1553614350, "question_id": 55360450, "link": "https://stackoverflow.com/questions/55360450/elastic-beanstalk-cant-find-gem-bundler-0-a-with-executable-bundle-gem", "title": "Elastic Beanstalk: can&#39;t find gem bundler (&gt;= 0.a) with executable bundle (Gem::GemNotFoundException)", "body": "<p>This error message is a well known error message. (see <a href=\"https://bundler.io/blog/2019/01/04/an-update-on-the-bundler-2-release.html\" rel=\"noreferrer\">https://bundler.io/blog/2019/01/04/an-update-on-the-bundler-2-release.html</a> for example.) Although I'm getting it with a new Elastic Beanstalk application with Ruby 2.6.1, and bundler 2.0.1. The error is:</p>\n\n<pre><code>  /opt/rubies/ruby-2.6.1/lib/ruby/site_ruby/2.6.0/rubygems.rb:289:in `find_spec_for_exe': can't find gem bundler (&gt;= 0.a) with executable bundle (Gem::GemNotFoundException)\nfrom /opt/rubies/ruby-2.6.1/lib/ruby/site_ruby/2.6.0/rubygems.rb:308:in `activate_bin_path'\nfrom /opt/rubies/ruby-2.6.1/bin/bundle:23:in `&lt;main&gt;' (ElasticBeanstalk::ExternalInvocationError)\n</code></pre>\n\n<p>I've tried putting the following file: <code>01_install_bundler.config</code> in the <code>.ebextensions</code> folder:</p>\n\n<pre><code>container_commands:\n  01_install_bundler:\n    command: \"gem install bundler \u2014-version 2.0.1\"\n</code></pre>\n\n<p>Although this never gets run because if I look at the above error, I can see that it is happening during this point in the deploy process:</p>\n\n<pre><code>.../AppDeployStage0/AppDeployPreHook/10_bundle_install.sh] : Activity failed.\n</code></pre>\n\n<p>(i.e. during the <code>bundle install</code> command of an AppDeployPreHook script). See <a href=\"https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/custom-platform-hooks.html\" rel=\"noreferrer\">https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/custom-platform-hooks.html</a> for reference of PlatformHooks.</p>\n\n<p>I'm pretty sure that if I can ensure that the version of bundler being used is at least version 2.0.0, then there won't be a problem. Although I don't know how I can specify that easily. At the moment I'm ssh'ing to the server to <code>/opt/elasticbeanstalk/hooks/appdeploy/pre/</code> to edit and fiddle with the scripts. Although I obviously need an automated, repeatable way of doing it.</p>\n\n<p>It's frustrating that ruby 2.6.1 isn't choosing bundler version 2.0.0 by default. Any ideas?</p>\n\n<p>==============================</p>\n\n<p>Update:</p>\n\n<p>If I edit the file <code>/opt/elasticbeanstalk/hooks/appdeploy/pre/10_bundle_install.sh</code></p>\n\n<pre><code>if [ -f Gemfile ]; then\n  echo \"running 'bundle install' with Gemfile:\"\n  cat Gemfile\n\n  +++ gem install bundler +++\n  if [ -d $EB_APP_STAGING_DIR/vendor/cache ]; then\n    bundle install --local\n  else\n    bundle install\n  fi\nelse\n  echo \"no Gemfile found! Skipping bundle install stage!\"\nfi\n</code></pre>\n\n<p>and add the <code>gem install bundler</code> (without the pluses), then this fixes the problem because it installs the latest bundler, which is 2.0.1. For those who want to know the hack, the commands were:</p>\n\n<p><code>eb ssh</code></p>\n\n<p><code>sudo -i</code></p>\n\n<p><code>cd /opt/elasticbeanstalk/hooks/appdeploy/pre</code></p>\n\n<p><code>vim 10_bundle_install.sh</code></p>\n\n<p>The problem with this solution is that it feels like a bit of a hack because it doesn't use <code>.ebextensions</code>. Is there a more proper way of fixing this?</p>\n"}, {"tags": ["python", "ruby-on-rails", "ruby", "django", "django-rest-framework"], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1553616121, "post_id": 55360914, "comment_id": 97446853, "body": "What he said. DNS indicates:  CNAME \twww.django-rest-framework.org \ttomchristie.github.io"}], "tags": [], "owner": {"reputation": 15098, "user_id": 4458034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f986d9d2a1920cd4c9c71110a2dc7905?s=128&d=identicon&r=PG", "display_name": "Linovia", "link": "https://stackoverflow.com/users/4458034/linovia"}, "is_accepted": false, "score": 2, "last_activity_date": 1553725342, "last_edit_date": 1553725342, "creation_date": 1553614302, "answer_id": 55360914, "question_id": 55360113, "link": "https://stackoverflow.com/questions/55360113/curiosity-why-would-django-rest-framework-documentation-be-made-with-ror/55360914#55360914", "title": "Curiosity - Why would Django REST Framework documentation be made with RoR?", "body": "<p>It's hosted through GitHub pages and Github is built on top of Ruby on Rails.</p>\n"}], "owner": {"reputation": 436, "user_id": 3936729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fd25be5093b8efc47c89050e674cc5f?s=128&d=identicon&r=PG", "display_name": "vctrd", "link": "https://stackoverflow.com/users/3936729/vctrd"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "closed_date": 1553617380, "answer_count": 1, "score": -2, "last_activity_date": 1553731086, "creation_date": 1553611978, "last_edit_date": 1553731086, "question_id": 55360113, "link": "https://stackoverflow.com/questions/55360113/curiosity-why-would-django-rest-framework-documentation-be-made-with-ror", "closed_reason": "Opinion-based", "title": "Curiosity - Why would Django REST Framework documentation be made with RoR?", "body": "<p>Using the DRF documentation I noticed that wappalizer (<a href=\"https://www.wappalyzer.com/\" rel=\"nofollow noreferrer\">https://www.wappalyzer.com/</a>) is identifing the use of Ruby on Rails on the DRF documentation (<a href=\"https://www.django-rest-framework.org\" rel=\"nofollow noreferrer\">https://www.django-rest-framework.org</a>). This looks quite ironic not to use Django.\nDoes any one know why this would be the case or if it's something related to a wappalyzer missidentification?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby", "rspec", "capybara"], "answers": [{"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 0, "last_activity_date": 1553612896, "creation_date": 1553612896, "answer_id": 55360439, "question_id": 55359951, "link": "https://stackoverflow.com/questions/55359951/ruby-capybara-argumenterror-invalid-keys/55360439#55360439", "title": "Ruby - Capybara - ArgumentError: invalid keys", "body": "<p>The error message is telling you what options are valid to pass to <code>has_field?</code>. You should be passing <code>disabled: true</code> rather than :disable.</p>\n"}], "owner": {"reputation": 3, "user_id": 10546627, "user_type": "registered", "profile_image": "https://graph.facebook.com/1435425959839395/picture?type=large", "display_name": "Cleiton Xavier", "link": "https://stackoverflow.com/users/10546627/cleiton-xavier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "accepted_answer_id": 55360439, "answer_count": 1, "score": 0, "last_activity_date": 1553616260, "creation_date": 1553611532, "last_edit_date": 1553616260, "question_id": 55359951, "link": "https://stackoverflow.com/questions/55359951/ruby-capybara-argumenterror-invalid-keys", "title": "Ruby - Capybara - ArgumentError: invalid keys", "body": "<p>I'm executing a code, where i verify if the input is disabled, but an error occurs.</p>\n\n<h2>CODE</h2>\n\n<pre><code>before(:each) do\n    visit 'https://training-wheels-protocol.herokuapp.com/dynamic_controls'\nend\n\nit 'quando habilita o campo' do\n    res = page.has_field? 'movie', disable: true\n    puts res\nend \n</code></pre>\n\n<h2>ERROR</h2>\n\n<pre><code> ArgumentError:\n   invalid keys :disable, should be one of :count, :minimum, :maximum, :between, :text, :id, :class, :style, :visible, :exact, :exact_text, :normalize_ws, :match, :wait, :filter_set, :checked, :unchecked, :disabled, :multiple, :readonly, :with, :type, :name, :placeholder\n # ./spec/dynamic_control_spec.rb:8:in `block (2 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<hr>\n\n<p><strong>Can someone help me?</strong></p>\n"}, {"tags": ["ruby", "fastlane"], "comments": [{"owner": {"reputation": 9436, "user_id": 252627, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8128cc645c1a135f1fc28ba1294b53c?s=128&d=identicon&r=PG", "display_name": "janpio", "link": "https://stackoverflow.com/users/252627/janpio"}, "edited": false, "score": 0, "creation_date": 1553635592, "post_id": 55358066, "comment_id": 97456415, "body": "Could you add a bit more information <i>why</i> you copy the project to the desktop? And what work you still want to do on that project on the desktop?"}, {"owner": {"reputation": 3386, "user_id": 268627, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4879943354a3ff3ee050a1e156069007?s=128&d=identicon&r=PG", "display_name": "o15a3d4l11s2", "link": "https://stackoverflow.com/users/268627/o15a3d4l11s2"}, "reply_to_user": {"reputation": 9436, "user_id": 252627, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8128cc645c1a135f1fc28ba1294b53c?s=128&d=identicon&r=PG", "display_name": "janpio", "link": "https://stackoverflow.com/users/252627/janpio"}, "edited": false, "score": 0, "creation_date": 1553678272, "post_id": 55358066, "comment_id": 97469403, "body": "@janpio, we execute some custom actions like replacing images, translations, etc., because we create white-label apps. That&#39;s why we copy the original project to the desktop and copy some additional files there."}, {"owner": {"reputation": 9436, "user_id": 252627, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8128cc645c1a135f1fc28ba1294b53c?s=128&d=identicon&r=PG", "display_name": "janpio", "link": "https://stackoverflow.com/users/252627/janpio"}, "edited": false, "score": 1, "creation_date": 1553692841, "post_id": 55358066, "comment_id": 97478618, "body": "Wouldn&#39;t that work as well in a <code>build</code> folder inside the project? (Maybe subfolder for the customer and the version there) Then this could be handled a lot easier in your <code>Fastfile</code> with a simple <code>Dir.chdir</code> (although directory handling in fastlane still is a bit tricky as it switches between the <code>Fastfile</code> and the project path depending on what you execute)."}], "answers": [{"tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1553607701, "creation_date": 1553607701, "answer_id": 55358623, "question_id": 55358066, "link": "https://stackoverflow.com/questions/55358066/change-fastlane-execution-folder-while-inside-a-lane/55358623#55358623", "title": "Change Fastlane execution folder while inside a lane", "body": "<p>I don't think fastlane is designed to change its working directory while running. It sets up a ton of environment variables when running and if any of those point to the old location you might be in trouble.</p>\n\n<p>Make two fastlane lanes, one for the old location, one for the new. Then your script looks like this</p>\n\n<pre><code>cd old-location\nfastlane old_lane\ncp -r old-location new-location\ncd new-location\nfastlane new_lane\n</code></pre>\n\n<p>Fastlane is great... for certain tasks. Personally I've had a lot more success treating it as a convenience wrapper for a few specific functions rather than an all-in-one solution, so don't be afraid to break out of it. For example, we only use fastlane for submitting our app, not for building and testing (<a href=\"https://silverhammermba.github.io/blog/2019/03/12/slowlane\" rel=\"nofollow noreferrer\">read more</a>).</p>\n"}], "owner": {"reputation": 3386, "user_id": 268627, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4879943354a3ff3ee050a1e156069007?s=128&d=identicon&r=PG", "display_name": "o15a3d4l11s2", "link": "https://stackoverflow.com/users/268627/o15a3d4l11s2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 704, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1553607701, "creation_date": 1553605992, "question_id": 55358066, "link": "https://stackoverflow.com/questions/55358066/change-fastlane-execution-folder-while-inside-a-lane", "title": "Change Fastlane execution folder while inside a lane", "body": "<p>We have a flow where we execute a custom script which copies the project on the desktop before it is signed and submitted.</p>\n\n<p>Now we want to use Fastlane and we were thinking to do the following:</p>\n\n<ol>\n<li>We start the <code>fastlane build</code> process</li>\n<li>We execute the custom <code>sh</code> script</li>\n<li>We do all the <code>fastlane</code> magic</li>\n</ol>\n\n<p>And I am thinking the following - since my sh script is copying the project on the desktop, how can I continue the <code>fastlane</code> script execution from the copied folder and not the original (source) folder?</p>\n\n<p>Should we start <code>fastlane</code> from our custom script instead?</p>\n"}, {"tags": ["ruby", "macos", "continuous-integration", "gitlab", "fastlane"], "comments": [{"owner": {"reputation": 130, "user_id": 3711401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c3fa3f84c08e05d6a1574e6d2618f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Gorille", "link": "https://stackoverflow.com/users/3711401/gorille"}, "edited": false, "score": 0, "creation_date": 1553608519, "post_id": 55357317, "comment_id": 97441564, "body": "Maybe you could try modifying the script to add a - echo $PATH  and - which ruby    to make sure that it is using the correct one"}, {"owner": {"reputation": 4351, "user_id": 3826232, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/odxpv.jpg?s=128&g=1", "display_name": "iKK", "link": "https://stackoverflow.com/users/3826232/ikk"}, "reply_to_user": {"reputation": 130, "user_id": 3711401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c3fa3f84c08e05d6a1574e6d2618f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Gorille", "link": "https://stackoverflow.com/users/3711401/gorille"}, "edited": false, "score": 0, "creation_date": 1553609558, "post_id": 55357317, "comment_id": 97442348, "body": "I am not really familiar with such kind of scripts. Could you please be a bit more specific ? And, thank you very much for your support. How would such a <code>PATH</code> look like ? Do you have an example of this <code>echo $PATH</code> script ?"}, {"owner": {"reputation": 4351, "user_id": 3826232, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/odxpv.jpg?s=128&g=1", "display_name": "iKK", "link": "https://stackoverflow.com/users/3826232/ikk"}, "reply_to_user": {"reputation": 130, "user_id": 3711401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c3fa3f84c08e05d6a1574e6d2618f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Gorille", "link": "https://stackoverflow.com/users/3711401/gorille"}, "edited": false, "score": 0, "creation_date": 1553610388, "post_id": 55357317, "comment_id": 97442920, "body": "Could another docker image help ? Does anybody know how to set up GitLab CI on a Mac ??"}, {"owner": {"reputation": 716, "user_id": 3507206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/848870b4043d5ca319aa3111cb55845b?s=128&d=identicon&r=PG", "display_name": "tejasbubane", "link": "https://stackoverflow.com/users/3507206/tejasbubane"}, "edited": false, "score": 0, "creation_date": 1553610826, "post_id": 55357317, "comment_id": 97443195, "body": "Did you try using ruby image for docker? <a href=\"https://hub.docker.com/_/ruby\" rel=\"nofollow noreferrer\">hub.docker.com/_/ruby</a>"}, {"owner": {"reputation": 4351, "user_id": 3826232, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/odxpv.jpg?s=128&g=1", "display_name": "iKK", "link": "https://stackoverflow.com/users/3826232/ikk"}, "edited": false, "score": 0, "creation_date": 1553613024, "post_id": 55357317, "comment_id": 97444773, "body": "no, haven&#39;t tried this. I tried: <code>docker pull ruby</code>. But how do I start this ruby-docker image ?? (sorry but I am new to docker, gitlab, ci)"}, {"owner": {"reputation": 4351, "user_id": 3826232, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/odxpv.jpg?s=128&g=1", "display_name": "iKK", "link": "https://stackoverflow.com/users/3826232/ikk"}, "edited": false, "score": 0, "creation_date": 1553614140, "post_id": 55357317, "comment_id": 97445544, "body": "Now it worked !! I did reset the docker, made sure I re-did the <code>sudo gitlab-runner register</code> steps (but this time with the <code>ruby:2.6</code> docker image). And I am not sure if <code>docker pull ruby</code> was also necessary. Anyway, not really sure what&#39;s going on, I have a working docker image and can start the gitlab ci by writing <code>sudo gitlab-runner run</code>"}], "owner": {"reputation": 4351, "user_id": 3826232, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/odxpv.jpg?s=128&g=1", "display_name": "iKK", "link": "https://stackoverflow.com/users/3826232/ikk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 766, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1553605602, "creation_date": 1553603652, "last_edit_date": 1553605602, "question_id": 55357317, "link": "https://stackoverflow.com/questions/55357317/gitlab-ci-error-gem-install-bundler-on-macos", "title": "GitLab CI error: gem install bundler on MacOS", "body": "<p>Using MacOS-10.14.3, there is a problem with my <strong>GitLab CI</strong> for an iOS project (using <strong>fastlane</strong>):</p>\n\n<p>I try to create a gitlab-runner on my Mac and I get quite far with it, except the following error message occurs during CI-failure:</p>\n\n<p><a href=\"https://i.stack.imgur.com/4oKbA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4oKbA.png\" alt=\"enter image description here\"></a>\n <a href=\"https://i.stack.imgur.com/EhbYJ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EhbYJ.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>It seems that the error happens at the <code>before_script</code> for some reason.</p>\n\n<p>Any idea what could be wrong here ?</p>\n\n<p><a href=\"https://docs.fastlane.tools/best-practices/continuous-integration/gitlab/\" rel=\"nofollow noreferrer\">From the fastlane page, I follow these instructions: Link</a></p>\n\n<p>The Gitlab error seems to be related to a Ruby issue on Mac</p>\n\n<p>I followed <a href=\"https://stackoverflow.com/questions/51126403/you-dont-have-write-permissions-for-the-library-ruby-gems-2-3-0-directory-ma?rq=1\">this suggestion here</a>: I tried to re-install ruby, doing the following in a Terminal:</p>\n\n<pre><code>brew install ruby\necho 'export PATH=\"/usr/local/opt/ruby/bin:$PATH\"' &gt;&gt; ~/.bash_profile\nsource ~/.bash_profile\n</code></pre>\n\n<p>But that did not help anything...</p>\n\n<p>In case, interested, finding out what ruby is on my Mac:</p>\n\n<pre><code>ruby -v\n</code></pre>\n\n<pre><code>ruby 2.6.2p47 (2019-03-13 revision 67232) [x86_64-darwin18]\n</code></pre>\n\n<pre><code>which ruby\n</code></pre>\n\n<pre><code>/usr/local/opt/ruby/bin/ruby\n</code></pre>\n\n<p>I use docker with <code>image alpine:latest</code> and I run my gitlab-runner from a Mac-Terminal with the following command:</p>\n\n<pre><code>sudo gitlab-runner run\n</code></pre>\n\n<p>Here is my Gemfile:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>source 'https://rubygems.org'\n\ngem 'fastlane'\ngem 'cocoapods'\n</code></pre>\n\n<p>...and here is my gitlab-ci.yml file:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>stages:\n  - unit_tests\n  - test_flight\n\nvariables:\n  LC_ALL: \"en_US.UTF-8\"\n  LANG: \"en_US.UTF-8\"\n\nbefore_script:\n  - gem install bundler\n  - bundle install\n\nunit_tests:\n  dependencies: []\n  stage: unit_tests\n  artifacts:\n    paths:\n      - fastlane/screenshots\n      - fastlane/logs\n  script:\n    - fastlane tests\n  tags:\n    - ios\n\ntest_flight_build:\n  dependencies: []\n  stage: test_flight\n  artifacts:\n    paths:\n      - fastlane/screenshots\n      - fastlane/logs\n  script:\n    - fastlane testflight\n  tags:\n    - ios\n  only:\n     - /^release-.*$/\n     - master\n</code></pre>\n\n<p>Any idea on how to change this GitLab CI File (or do anything else) so that this annoying <code>gem install bundler</code> error goes away ?? Any help appreciated.</p>\n"}, {"tags": ["ruby", "selenium", "appium"], "owner": {"reputation": 159, "user_id": 4311225, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-9XIJKHoOWhk/AAAAAAAAAAI/AAAAAAAAAOk/YyJK2rz1A8Q/photo.jpg?sz=128", "display_name": "Rijo Mon", "link": "https://stackoverflow.com/users/4311225/rijo-mon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1553611638, "creation_date": 1553600196, "last_edit_date": 1553611638, "question_id": 55356201, "link": "https://stackoverflow.com/questions/55356201/how-to-click-context-in-recyclerview-by-using-appium-ruby", "title": "How to click context in RecyclerView by using Appium, Ruby", "body": "<p>How to click an element in RecyclerView by using Appium, Ruby. I tried using all ways but not able to click</p>\n\n<p>I have tried all possible ways </p>\n\n<pre><code>require 'selenium-cucumber'\nrequire 'appium_lib'\ndef alert1\n     $driver.find_element(xpath: \"/hierarchy/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.view.ViewGroup/android.widget.ScrollView/android.widget.LinearLayout/android.widget.LinearLayout/android.widget.LinearLayout/android.widget.LinearLayout[2]/android.widget.Button[2]\") \nend\ndef alert2; $driver.find_element(xpath: \"/hierarchy/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.view.ViewGroup/android.widget.ScrollView/android.widget.LinearLayout/android.widget.LinearLayout/android.widget.LinearLayout/android.widget.LinearLayout[2]/android.widget.Button[2]\") end\ndef phoneNumber; $driver.find_element(id: \"com.accushield.familyapp:id/phone_number\") end\ndef sendCode; $driver.find_element(id: \"com.accushield.familyapp:id/send_code\") end\ndef confirmationCode; $driver.find_element(id: \"com.accushield.familyapp:id/confirmation_code\") end\ndef submitCode; $driver.find_element(id: \"com.accushield.familyapp:id/submit_confirmation_code\") end\ndef dashboardScreen1; $driver.find_element(xpath: \"/hierarchy/android.widget.FrameLayout/android.widget.LinearLayout/android.widget.FrameLayout/android.widget.LinearLayout/android.widget.FrameLayout/android.view.ViewGroup/android.support.v7.widget.RecyclerView/android.widget.FrameLayout[1]/android.view.ViewGroup\").click end\n\nThen(/^do user Login with OTP$/) do\n    alert1.click\n    alert2.click\n    phoneNumber.send_keys(\"8131234567\")\n    sendCode.click\n    confirmationCode.send_keys(\"123456\")\n    submitCode.click\n    sleep 40\n\n    #residentClick.click\n    #$driver.find_element(xpath: \"//android.widget.ImageView[@index='1']\").click   \n    dashboardScreen1.click\n    #if dashboardScreen.displayed?\n        #    puts \"User has signed in successfully\"\n       # else\n        #  puts \"User sign in got failed\"\n        #  end\n</code></pre>\n\n<p>I need to click any element in recycler view. Please find the image for elements</p>\n\n<p><a href=\"https://i.stack.imgur.com/cmJ23.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/cmJ23.png</a></p>\n"}, {"tags": ["ruby", "heroku"], "comments": [{"owner": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "edited": false, "score": 0, "creation_date": 1553601753, "post_id": 55356138, "comment_id": 97436879, "body": "Are the <code>Gemfile</code> and the <code>Gemfile.lock</code> both tracked by Git? Are they both in the root of your repository?"}, {"owner": {"reputation": 124, "user_id": 344996, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/61ef03912691c1b6bcaa941c9f317af0?s=128&d=identicon&r=PG", "display_name": "the Ben B", "link": "https://stackoverflow.com/users/344996/the-ben-b"}, "reply_to_user": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "edited": false, "score": 0, "creation_date": 1553604138, "post_id": 55356138, "comment_id": 97438448, "body": "Hi Chris. Yes, both in the root, and both tracked to git. Thanks"}, {"owner": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "edited": false, "score": 0, "creation_date": 1553605176, "post_id": 55356138, "comment_id": 97439206, "body": "Are they both named <i>exactly</i> like I show in my comment? Can you run <code>ls</code> (or <code>dir</code> if you&#39;re on Windows) from the root directory of your repository and add the result to your question as an <a href=\"https://stackoverflow.com/posts/55356138/edit\">edit</a>?"}, {"owner": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "edited": false, "score": 0, "creation_date": 1553606499, "post_id": 55356138, "comment_id": 97440128, "body": "<a href=\"https://meta.stackexchange.com/a/116105/248627\">Please don&#39;t add &quot;solved&quot; to your title or question</a>. Instead, <a href=\"https://meta.stackexchange.com/q/5234/248627\">mark an answer correct by clicking on the checkmark</a>. You can also <a href=\"https://stackoverflow.com/help/self-answer\">add your own answer</a> and accept it if none of the ones you received solved your problem. I&#39;m rolling back your edit."}], "answers": [{"tags": [], "owner": {"reputation": 124, "user_id": 344996, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/61ef03912691c1b6bcaa941c9f317af0?s=128&d=identicon&r=PG", "display_name": "the Ben B", "link": "https://stackoverflow.com/users/344996/the-ben-b"}, "is_accepted": true, "score": 0, "last_activity_date": 1553606657, "creation_date": 1553606657, "answer_id": 55358294, "question_id": 55356138, "link": "https://stackoverflow.com/questions/55356138/cannot-push-ruby-app-to-heroku-app-not-compatible-with-buildpack-yet-gemfile-e/55358294#55358294", "title": "Cannot push Ruby app to Heroku: App not compatible with buildpack, yet Gemfile exists", "body": "<p>I solved this by adding a new line to the end of the gemfile</p>\n"}], "owner": {"reputation": 124, "user_id": 344996, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/61ef03912691c1b6bcaa941c9f317af0?s=128&d=identicon&r=PG", "display_name": "the Ben B", "link": "https://stackoverflow.com/users/344996/the-ben-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "accepted_answer_id": 55358294, "answer_count": 1, "score": 0, "last_activity_date": 1556028730, "creation_date": 1553599996, "last_edit_date": 1553606511, "question_id": 55356138, "link": "https://stackoverflow.com/questions/55356138/cannot-push-ruby-app-to-heroku-app-not-compatible-with-buildpack-yet-gemfile-e", "title": "Cannot push Ruby app to Heroku: App not compatible with buildpack, yet Gemfile exists", "body": "<p>I've built a Ruby app for Twitter. I have a Gemfile and the Gemfile.lock that bundler created. This is the contents of the Gemfile</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>source 'https://rubygems.org'\ngem 'twitter'\n</code></pre>\n\n<p>When I try to push the app to Heroku, it fails with:</p>\n\n<pre><code>App not compatible with buildpack: https://buildpack-registry.s3.amazonaws.com/buildpacks/heroku/ruby.tgz\n</code></pre>\n\n<p>I tried removing the buildpack from the Heroku settings. If I do this, it fails because it cannot detect the buildpack.</p>\n\n<p>I can't see what is wrong here. Help gratefully received.</p>\n"}, {"tags": ["ruby", "parentheses", "control-structure"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1553599848, "post_id": 55356052, "comment_id": 97435723, "body": "&quot;to enclose a rescue construction&quot; - the modifier version? Or the regular one?"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1553599932, "post_id": 55356052, "comment_id": 97435766, "body": "@SergioTulentsev Not sure how they differ in a modifier version of a rescue construction. I meant the regular one."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1553600091, "post_id": 55356052, "comment_id": 97435848, "body": "@SergioTulentsev It looks like the latter one can be used as well: <code>begin;   raise &quot;foo&quot; rescue begin puts &quot;bar&quot; end; end  # &gt;&gt; bar</code>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1553600281, "post_id": 55356052, "comment_id": 97435965, "body": "This is still a simple modifier, no? :shrug:"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1553616780, "post_id": 55356052, "comment_id": 97447268, "body": "Of course, parentheses don&#39;t support <code>ensure</code>: <code>begin true ensure a = &#39;cat&#39; end #=&gt; true; a #=&gt; &quot;cat&quot;</code>. I noticed nesting is not a problem. I&#39;ve never seen <code>begin...end</code> in-line."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1553617244, "post_id": 55356052, "comment_id": 97447558, "body": "sawa, in your previous comment you don&#39;t seem to need either semicolon. <code>begin raise &quot;foo&quot; rescue begin puts &quot;bar&quot; end end</code> seems to work fine."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 3, "creation_date": 1553617827, "post_id": 55356052, "comment_id": 97447924, "body": "The fact that <code>begin..end</code> can be used in-line means that one can write lines that look a lot line in-line rescue clauses but permit the error class to be specified: <code>begin 4&#47;0 rescue ZeroDivisionError; &#39;whoops&#39; end #=&gt; &quot;whoops&quot;</code>."}, {"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1553623231, "post_id": 55356052, "comment_id": 97450980, "body": "Another one is when the while modifier is used: with begin you have Ruby&#39;s weird do while loop meaning the body expression is evaluated at least once. Not the case with parentheses!"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1553632623, "post_id": 55356052, "comment_id": 97455220, "body": "@cremno, Tuesday is my dense-day. Can you give an example."}, {"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1553666815, "post_id": 55356052, "comment_id": 97464089, "body": "@CarySwoveland: <code>begin p 1 end while false</code> prints 1 but <code>(p 1) while false</code> prints nothing."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1553672794, "post_id": 55356052, "comment_id": 97466456, "body": "Some of the comments here seem to have good points. I would love to read them as individual answers."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1553718945, "post_id": 55356052, "comment_id": 97493863, "body": "Alternatively, perhaps someone could gather them up into a single answer, possibly a <a href=\"https://meta.stackexchange.com/questions/11740/what-are-community-wiki-posts\">community wiki</a>. sawa?"}], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1553600268, "creation_date": 1553599741, "last_edit_date": 1553600268, "question_id": 55356052, "link": "https://stackoverflow.com/questions/55356052/difference-between-grouping-parentheses-and-begin-end", "title": "Difference between grouping parentheses and `begin` ... `end`", "body": "<p>What is the difference between parentheses used for grouping:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>(some_method_chain; another_method_chain)\n\n2 * (3 + 4) # =&gt; 14\n</code></pre>\n\n<p>and the <code>begin</code> ... <code>end</code> structure:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>begin some_method_chain; another_method_chain end\n\n2 * begin 3 + 4 end # =&gt; 14\n</code></pre>\n\n<p>I notice that only the latter can be used to enclose a <code>rescue</code> construction. Are there any other differences?</p>\n"}, {"tags": ["ruby", "windows"], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 2, "last_activity_date": 1553596233, "creation_date": 1553596233, "answer_id": 55354925, "question_id": 55354571, "link": "https://stackoverflow.com/questions/55354571/why-rubocop-offenses-c-carriage-return-character-detected-in-windows-10-pro-b/55354925#55354925", "title": "Why rubocop offenses (C: Carriage return character detected) in Windows 10 pro but not in Mac?", "body": "<p>Unix and Windows are using different characters to indicate a <a href=\"https://en.wikipedia.org/wiki/Newline\" rel=\"nofollow noreferrer\">newline</a>. While Unix uses a <code>line feed</code> (<code>\"\\n\"</code>), Windows uses <code>carriage return + line feed</code> (<code>\"\\r\\n\"</code>).</p>\n\n<p>Just configure the IDE on the Windows machine to just use the Unix version.</p>\n"}], "owner": {"reputation": 31, "user_id": 10921013, "user_type": "registered", "profile_image": "https://graph.facebook.com/890848601047768/picture?type=large", "display_name": "Kishor Budhathoki", "link": "https://stackoverflow.com/users/10921013/kishor-budhathoki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 514, "favorite_count": 0, "accepted_answer_id": 55354925, "answer_count": 1, "score": 0, "last_activity_date": 1553596497, "creation_date": 1553595241, "last_edit_date": 1553596497, "question_id": 55354571, "link": "https://stackoverflow.com/questions/55354571/why-rubocop-offenses-c-carriage-return-character-detected-in-windows-10-pro-b", "title": "Why rubocop offenses (C: Carriage return character detected) in Windows 10 pro but not in Mac?", "body": "<p>The code below:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def fix(value)\n  value &lt;&lt; 'xyz'\n  value = value.upcase\n  value.concat('!')\nend\n\ns = 'hello'\nt = fix(s)\n\nputs s\nputs t\n\n</code></pre>\n\n<p>doesn't show any rubocop offense in mac, but shows</p>\n\n<pre><code>C: Carriage return character detected\ndef fix(value) ...\n^^^^^^^^^^^^^^\n</code></pre>\n\n<p>in windows 10 pro.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 49, "user_id": 11231142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6521790d4e29e8127ca7d61600ed1e5?s=128&d=identicon&r=PG&f=1", "display_name": "albert", "link": "https://stackoverflow.com/users/11231142/albert"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1553590620, "post_id": 55352996, "comment_id": 97430093, "body": "i receive <code>undefined method `map&#39; for nil:NilClass</code>, how do i fix the error"}, {"owner": {"reputation": 1099, "user_id": 2799029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eea432dc7b47d95cba6b39b0446feb5e?s=128&d=identicon&r=PG&f=1", "display_name": "floum", "link": "https://stackoverflow.com/users/2799029/floum"}, "edited": false, "score": 0, "creation_date": 1553605145, "post_id": 55352996, "comment_id": 97439184, "body": "I guess the answer below nailed it down. @albert: can you mark the answer as accepted, so that it gets filtered?"}, {"owner": {"reputation": 49, "user_id": 11231142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6521790d4e29e8127ca7d61600ed1e5?s=128&d=identicon&r=PG&f=1", "display_name": "albert", "link": "https://stackoverflow.com/users/11231142/albert"}, "reply_to_user": {"reputation": 1099, "user_id": 2799029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eea432dc7b47d95cba6b39b0446feb5e?s=128&d=identicon&r=PG&f=1", "display_name": "floum", "link": "https://stackoverflow.com/users/2799029/floum"}, "edited": false, "score": 0, "creation_date": 1554028241, "post_id": 55352996, "comment_id": 97596417, "body": "i&#39;m a new user, i dont have enough reputation to mark corrent answers yet"}, {"owner": {"reputation": 1099, "user_id": 2799029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eea432dc7b47d95cba6b39b0446feb5e?s=128&d=identicon&r=PG&f=1", "display_name": "floum", "link": "https://stackoverflow.com/users/2799029/floum"}, "edited": false, "score": 0, "creation_date": 1554187565, "post_id": 55352996, "comment_id": 97648036, "body": "Thanks for the update, did not remember that fact, sorry."}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1553594173, "post_id": 55353121, "comment_id": 97432157, "body": "One of the downsides of using instance variables to pass data around :-)"}], "tags": [], "owner": {"reputation": 141, "user_id": 4140718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7ba69bc5807252c67bd5de5f34f0f9?s=128&d=identicon&r=PG&f=1", "display_name": "Sindhuja Selvaraj", "link": "https://stackoverflow.com/users/4140718/sindhuja-selvaraj"}, "is_accepted": false, "score": 2, "last_activity_date": 1553590573, "creation_date": 1553590573, "answer_id": 55353121, "question_id": 55352996, "link": "https://stackoverflow.com/questions/55352996/undefined-method-map-for-nilnilclass-nomethoderror-in-projectsnew/55353121#55353121", "title": "undefined method `map&#39; for nil:NilClass NoMethodError in Projects#new", "body": "<p>I think you've mistyped <code>progresses</code> in  .erb file</p>\n"}], "owner": {"reputation": 49, "user_id": 11231142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6521790d4e29e8127ca7d61600ed1e5?s=128&d=identicon&r=PG&f=1", "display_name": "albert", "link": "https://stackoverflow.com/users/11231142/albert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1553590573, "creation_date": 1553590104, "question_id": 55352996, "link": "https://stackoverflow.com/questions/55352996/undefined-method-map-for-nilnilclass-nomethoderror-in-projectsnew", "title": "undefined method `map&#39; for nil:NilClass NoMethodError in Projects#new", "body": "<p>I am creating a project management system and each project have its progress status but making the category show in my new page isn't working</p>\n\n<p>but i receive <code>undefined method `map' for nil:NilClass</code></p>\n\n<p>this is my project controller</p>\n\n<pre><code>def new\n    @project = Project.new \n    @progresses = Progress.all.map{|c| [ c.name, c.id ] }\nend\n</code></pre>\n\n<p>and my project/_form.html.erb</p>\n\n<pre><code>&lt;div class=\"field\"&gt;\n    &lt;%= select_tag(:progress_id, options_for_select(@progressess), :prompt =&gt; \"Select one!\") %&gt;\n  &lt;/div&gt;\n</code></pre>\n\n<p>models/progress.rb</p>\n\n<pre><code>has_many :projects\n</code></pre>\n\n<p>models/project.rb</p>\n\n<pre><code>belongs_to :progress\n</code></pre>\n\n<p>i want the progress to show on the project form as a dropdown so i can select in it</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "openssl", "encryption-symmetric"], "comments": [{"owner": {"reputation": 10980, "user_id": 200445, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/322dfbdffdbb24e5595f3585e1b5c140?s=128&d=identicon&r=PG", "display_name": "Vasiliy Faronov", "link": "https://stackoverflow.com/users/200445/vasiliy-faronov"}, "edited": false, "score": 1, "creation_date": 1553606123, "post_id": 55352313, "comment_id": 97439878, "body": "Is <code>pass.txt</code> the same as <code>encryption_key</code>?"}, {"owner": {"reputation": 2469, "user_id": 348851, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/K0tMM.jpg?s=128&g=1", "display_name": "defiant", "link": "https://stackoverflow.com/users/348851/defiant"}, "reply_to_user": {"reputation": 10980, "user_id": 200445, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/322dfbdffdbb24e5595f3585e1b5c140?s=128&d=identicon&r=PG", "display_name": "Vasiliy Faronov", "link": "https://stackoverflow.com/users/200445/vasiliy-faronov"}, "edited": false, "score": 0, "creation_date": 1553654326, "post_id": 55352313, "comment_id": 97461135, "body": "Yes thats because I don&#39;t know what to give as the password."}, {"owner": {"reputation": 2469, "user_id": 348851, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/K0tMM.jpg?s=128&g=1", "display_name": "defiant", "link": "https://stackoverflow.com/users/348851/defiant"}, "reply_to_user": {"reputation": 10980, "user_id": 200445, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/322dfbdffdbb24e5595f3585e1b5c140?s=128&d=identicon&r=PG", "display_name": "Vasiliy Faronov", "link": "https://stackoverflow.com/users/200445/vasiliy-faronov"}, "edited": false, "score": 0, "creation_date": 1553668171, "post_id": 55352313, "comment_id": 97464553, "body": "@VasiliyFaronov I understood that I am giving password instead of key in rails. Key is being generated by rails."}, {"owner": {"reputation": 14087, "user_id": 1544012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbaed9ca8e4320fd64d1989c0e0f488b?s=128&d=identicon&r=PG", "display_name": "BoraMa", "link": "https://stackoverflow.com/users/1544012/borama"}, "edited": false, "score": 0, "creation_date": 1553752180, "post_id": 55352313, "comment_id": 97502855, "body": "What Ruby and Rails versions are you using for the encryption?"}, {"owner": {"reputation": 2469, "user_id": 348851, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/K0tMM.jpg?s=128&g=1", "display_name": "defiant", "link": "https://stackoverflow.com/users/348851/defiant"}, "reply_to_user": {"reputation": 14087, "user_id": 1544012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbaed9ca8e4320fd64d1989c0e0f488b?s=128&d=identicon&r=PG", "display_name": "BoraMa", "link": "https://stackoverflow.com/users/1544012/borama"}, "edited": false, "score": 0, "creation_date": 1553756264, "post_id": 55352313, "comment_id": 97504272, "body": "@BoraMa Rails 5.0.2"}], "answers": [{"comments": [{"owner": {"reputation": 2469, "user_id": 348851, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/K0tMM.jpg?s=128&g=1", "display_name": "defiant", "link": "https://stackoverflow.com/users/348851/defiant"}, "edited": false, "score": 0, "creation_date": 1553834832, "post_id": 55397122, "comment_id": 97541169, "body": "holy cow, thanks a lot for the detailed description. Really appreciate it. I have one question though, how does serializing data changes the data?"}, {"owner": {"reputation": 14087, "user_id": 1544012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbaed9ca8e4320fd64d1989c0e0f488b?s=128&d=identicon&r=PG", "display_name": "BoraMa", "link": "https://stackoverflow.com/users/1544012/borama"}, "reply_to_user": {"reputation": 2469, "user_id": 348851, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/K0tMM.jpg?s=128&g=1", "display_name": "defiant", "link": "https://stackoverflow.com/users/348851/defiant"}, "edited": false, "score": 1, "creation_date": 1553839974, "post_id": 55397122, "comment_id": 97542545, "body": "Just look yourself: open up the Rails console and compare &quot;some text&quot; versus <code>Marshal.dump(&quot;some text&quot;)</code>. You will see that the latter has a few more bytes in the output, that denote the type of the data (probably). See the <a href=\"https://ruby-doc.org/core-2.3.0/Marshal.html\" rel=\"nofollow noreferrer\">docs</a>. I just also found <a href=\"https://github.com/dozen/ruby-marshal\" rel=\"nofollow noreferrer\">this loader</a> of Ruby-marshalled data in Go, so if you needed to encrypt anything more complex than strings, you might actually need this (and serializing)."}, {"owner": {"reputation": 2469, "user_id": 348851, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/K0tMM.jpg?s=128&g=1", "display_name": "defiant", "link": "https://stackoverflow.com/users/348851/defiant"}, "edited": false, "score": 1, "creation_date": 1553845393, "post_id": 55397122, "comment_id": 97544579, "body": "Thanks, now I know the extra information is denoting the type of data. I was just curious how those extra characters ended up there once the data is serialized."}, {"owner": {"reputation": 14087, "user_id": 1544012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbaed9ca8e4320fd64d1989c0e0f488b?s=128&d=identicon&r=PG", "display_name": "BoraMa", "link": "https://stackoverflow.com/users/1544012/borama"}, "reply_to_user": {"reputation": 2469, "user_id": 348851, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/K0tMM.jpg?s=128&g=1", "display_name": "defiant", "link": "https://stackoverflow.com/users/348851/defiant"}, "edited": false, "score": 0, "creation_date": 1553845989, "post_id": 55397122, "comment_id": 97544823, "body": "Yeah, the marshalled data format is internal and not well documented but most probably it denotes the data types. This allows the serializer to support any kind of data, not just strings."}], "tags": [], "owner": {"reputation": 14087, "user_id": 1544012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbaed9ca8e4320fd64d1989c0e0f488b?s=128&d=identicon&r=PG", "display_name": "BoraMa", "link": "https://stackoverflow.com/users/1544012/borama"}, "is_accepted": true, "score": 2, "last_activity_date": 1553774428, "creation_date": 1553774428, "answer_id": 55397122, "question_id": 55352313, "link": "https://stackoverflow.com/questions/55352313/trying-to-decrypt-a-string-using-openssl-golang-which-has-been-encrypted-in-rail/55397122#55397122", "title": "Trying to decrypt a string using openssl/golang which has been encrypted in rails", "body": "<p>Trying to decrypt data encrypted in a different system will not work unless you are aware and deal with the <strong>many intricate details of how both systems do the cryptography</strong>. Although both Rails and the <code>openssl</code> command line tool use the OpenSSL libraries under the hood for their crypto operations, they both use it in their own distinct ways that are not directly interoperable.</p>\n\n<p>If you look close to the two systems, you'll see that for example:</p>\n\n<ul>\n<li>Rails message encryptor not only encrypts the message but also <em>signs</em> it</li>\n<li>Rails encryptor uses <code>Marshal</code> to serialize the input data</li>\n<li>the <code>openssl enc</code> tool expects the encrypted data in a distinct file format with a <code>Salted__&lt;salt&gt;</code> header (this is why you get the <em>bad magic number</em> message from <code>openssl</code>)</li>\n<li>the <code>openssl</code> tool must be properly configured to use the same ciphers as Rails encryptor and key generator, as <code>openssl</code> defaults are different from Rails defaults</li>\n<li>the default ciphers configuration changed significantly since Rails 5.2.</li>\n</ul>\n\n<p>With this general info, we can have a look at a a practical example. It is tested in Rails 4.2 but should work equally up to Rails 5.1.</p>\n\n<h2>Anatomy of a Rails-encrypted message</h2>\n\n<p>Let me start with a slightly amended code that you presented. The only changes there are to preset the <code>password</code> and <code>salt</code> to static values and print a lot of debug info:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def encrypt_text(text_to_encrypt)\n  password = \"password\" # the password to derive the key\n  salt = \"saltsalt\" # salt must be 8 bytes\n\n  key = ActiveSupport::KeyGenerator.new(password).generate_key(salt, 32)\n\n  puts \"salt (hexa) = #{salt.unpack('H*').first}\" # print the saltin HEX\n  puts \"key (hexa) = #{key.unpack('H*').first}\" # print the generated key in HEX\n\n  crypt = ActiveSupport::MessageEncryptor.new(key)\n  output = crypt.encrypt_and_sign(text_to_encrypt)\n  puts \"output (base64) = #{output}\"\n  output\nend\n\nencrypt_text(\"secret text\")\n</code></pre>\n\n<p>When you run this, you'll get something like the following output:</p>\n\n<pre><code>salt (hexa) = 73616c7473616c74\nkey (hexa) = 196827b250431e911310f5dbc82d395782837b7ae56230dce24e497cf07b6518\noutput (base64) = SGRTUXYxRys1N1haVWNpVWxxWTdCMHlyMk15SnQ0dWFBOCt3Z0djWVdBZz0tLTkrd1hBNWJMVm9HcnptZ3loOG1mNHc9PQ==--80d091e8799776113b2c0efd1bf75b344bf39994\n</code></pre>\n\n<p>The last line (output of the <code>encrypt_and_sign</code> method) is a combination of two parts separated by <code>--</code> (see <a href=\"https://github.com/rails/rails/blob/5-0-stable/activesupport/lib/active_support/message_verifier.rb#L117\" rel=\"nofollow noreferrer\">source</a>): </p>\n\n<ol>\n<li>the encrypted message (Base64-encoded) and </li>\n<li>the message signature (Base64-encoded).</li>\n</ol>\n\n<p>The signature is not important for encryption so let's take a look in the first part - let's decode it in Rails console:</p>\n\n<pre><code>&gt; Base64.strict_decode64(\"SGRTUXYxRys1N1haVWNpVWxxWTdCMHlyMk15SnQ0dWFBOCt3Z0djWVdBZz0tLTkrd1hBNWJMVm9HcnptZ3loOG1mNHc9PQ==\")\n=&gt; \"HdSQv1G+57XZUciUlqY7B0yr2MyJt4uaA8+wgGcYWAg=--9+wXA5bLVoGrzmgyh8mf4w==\"\n</code></pre>\n\n<p>You can see that the decoded message again consists of two Base64-encoded parts separated by <code>--</code> (see <a href=\"https://github.com/rails/rails/blob/5-0-stable/activesupport/lib/active_support/message_encryptor.rb#L87\" rel=\"nofollow noreferrer\">source</a>):</p>\n\n<ol>\n<li>the encrypted message itself</li>\n<li>the initialization vector used in the encryption</li>\n</ol>\n\n<p>Rails message encryptor uses the <strong><code>aes-256-cbc</code> cipher by default</strong> (note that this has changed since Rails 5.2). This cipher needs an initialization vector, which is randomly generated by Rails and must be present in the encrypted output so that we can use it together with the key to decipher the message. </p>\n\n<p>Moreover, Rails does not encrypt the input data as a simple plain text, but rather a <strong>serialized version of the data</strong>, using the <code>Marshal</code> serializer by default (<a href=\"https://github.com/rails/rails/blob/5-0-stable/activesupport/lib/active_support/message_encryptor.rb#L84\" rel=\"nofollow noreferrer\">source</a>). If we decrypted such serialized value with openssl, we would  still get a slightly garbled (serialized) version of the initial plain text data. That's why it will be more appropriate to disable serialization while encrypting the data in Rails. This can be done by passing a parameter to the encryption method:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>  # crypt = ActiveSupport::MessageEncryptor.new(key)\n  crypt = ActiveSupport::MessageEncryptor.new(key, serializer: ActiveSupport::MessageEncryptor::NullSerializer)\n\n</code></pre>\n\n<p>A re-run of the code yields output that is slightly shorter than the previous version, because the encrypted data has not been serialized now:</p>\n\n<pre><code>salt (hexa) = 73616c7473616c74\nkey (hexa) = 196827b250431e911310f5dbc82d395782837b7ae56230dce24e497cf07b6518\noutput (base64) = SUlIWFBjSXRUc0JodEMzLzhXckJzUT09LS1oZGtPV1ZRc2I5Wi8zOG01dFNOdVdBPT0=--58bbaf983fd20459062df8b6c59eb470311cbca9\n</code></pre>\n\n<p>Finally, we must find out some info about the <strong>encryption key derivation</strong> procedure. The <a href=\"https://github.com/rails/rails/blob/5-0-stable/activesupport/lib/active_support/key_generator.rb#L21\" rel=\"nofollow noreferrer\">source</a> tells us that the KeyGenerator uses the <strong><code>pbkdf2_hmac_sha1</code></strong> algorithm with <code>2**16 = 65536</code> iterations to derive the key from the password / secret.</p>\n\n<h2>Anatomy of an <code>openssl</code> encrypted message</h2>\n\n<p>Now, a similar investigation is needed on the <code>openssl</code> side to learn the details of its decryption process. First, if you encrypt anything using the <code>openssl enc</code> tool, you will find out that the output has a <strong>distinct format</strong>:</p>\n\n<pre><code>Salted__&lt;salt&gt;&lt;encrypted_message&gt;\n</code></pre>\n\n<p>It begins with the <strong><code>Salted__</code> magic string</strong>, then followed by the <strong>salt</strong> (in hex form) and finally followed by the encrypted data. To be able to decrypt any data using this tool, we must get our encrypted data into the same format.</p>\n\n<p>The <code>openssl</code> tool uses the <a href=\"https://www.openssl.org/docs/man1.0.2/man3/EVP_BytesToKey.html\" rel=\"nofollow noreferrer\"><code>EVP_BytesToKey</code></a> (see <a href=\"https://github.com/openssl/openssl/blob/master/apps/enc.c#L480\" rel=\"nofollow noreferrer\">source</a>) to derive the key by default but can be configured to use the <code>pbkdf2_hmac_sha1</code> algorithm using the <code>-pbkdf2</code> and <code>-md sha1</code> options. The number of iterations can be set using the <code>-iter</code> option. </p>\n\n<h2>How to decrypt Rails-encrypted message in <code>openssl</code></h2>\n\n<p>So, finally we have enough information to actually try to decrypt a Rails-encrypted message in <code>openssl</code>.</p>\n\n<p>First we must decode the first part of the Rails-encrypted output again to get the encrypted data and the initialization vector:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>&gt; Base64.strict_decode64(\"SUlIWFBjSXRUc0JodEMzLzhXckJzUT09LS1oZGtPV1ZRc2I5Wi8zOG01dFNOdVdBPT0=\")\n=&gt; \"IIHXPcItTsBhtC3/8WrBsQ==--hdkOWVQsb9Z/38m5tSNuWA==\"\n</code></pre>\n\n<p>Now let's take the IV (the second part) and convert it to a hexa string form, as that is the form that <code>openssl</code> needs:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>&gt; Base64.strict_decode64(\"hdkOWVQsb9Z/38m5tSNuWA==\").unpack(\"H*\").first\n=&gt; \"85d90e59542c6fd67fdfc9b9b5236e58\"  # the initialization vector in hex form\n</code></pre>\n\n<p>Now we need to take the Rails-encrypted data and convert it to the format that <code>openssl</code> will recognize, i.e. prepend it with the magic string and salt and Base64-encode it again:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>&gt; Base64.strict_encode64(\"Salted__\" + \"saltsalt\" + Base64.strict_decode64(\"IIHXPcItTsBhtC3/8WrBsQ==\"))\n=&gt; \"U2FsdGVkX19zYWx0c2FsdCCB1z3CLU7AYbQt//FqwbE=\" # encrypted data suitable for openssl\n</code></pre>\n\n<p>Finally, we can construct the <code>openssl</code> command to decrypt the data:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ echo  \"U2FsdGVkX19zYWx0c2FsdCCB1z3CLU7AYbQt//FqwbE=\" | \n&gt; openssl enc -aes-256-cbc -d -iv 85d90e59542c6fd67fdfc9b9b5236e58 \\\n&gt;   -pass pass:password -pbkdf2 -iter 65536 -md sha1 -a\nsecret text\n</code></pre>\n\n<p>And voil\u00e1, <strong>we successfully decrypted the initial message!</strong></p>\n\n<p>The <code>openssl</code> parameters are as follows:</p>\n\n<ul>\n<li><code>-aes-256-cbc</code> sets the same cipher as Rails uses for encryption</li>\n<li><code>-d</code> stands for decryption</li>\n<li><code>-iv</code> passes the initialization vector in the hex string form</li>\n<li><code>-pass pass:password</code> sets the password used to derive the encryption key to \"password\"</li>\n<li><code>-pbkdf2</code> and <code>-md sha1</code> set the same key derivation algorithm as is used by Rails (<code>pbkdf2_hmac_sha1</code>)</li>\n<li><code>-iter 65536</code> sets the same number of iterations for key derivation as was done in Rails</li>\n<li><code>-a</code> allows to work with Base64-encoded encrypted data - no need to handle raw bytes in files</li>\n</ul>\n\n<p>By default <code>openssl</code> reads from STDIN, so we simply pass the encrypted data (in proper format)\u00a0to <code>openssl</code> using echo.</p>\n\n<h3>debugging</h3>\n\n<p>In case you hit any problems when decrypting with <code>openssl</code>, it is useful to add the <code>-P</code> parameter to the command line, which outputs debugging info about the cipher / key parameters:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ echo ... | openssl ... -P\nsalt=73616C7473616C74\nkey=196827B250431E911310F5DBC82D395782837B7AE56230DCE24E497CF07B6518\niv =85D90E59542C6FD67FDFC9B9B5236E58\n</code></pre>\n\n<p>The <code>salt</code>, <code>key</code>, and <code>iv</code> values must correspond to the debugging values printed by the original code in the <code>encrypt_text</code> method printed above. If they are different, you know you are doing something wrong...</p>\n\n<p>Now, I guess you can expect similar problems when trying to decrypt the message in go but I think you have some good pointers now to start.</p>\n"}], "owner": {"reputation": 2469, "user_id": 348851, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/K0tMM.jpg?s=128&g=1", "display_name": "defiant", "link": "https://stackoverflow.com/users/348851/defiant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 908, "favorite_count": 0, "accepted_answer_id": 55397122, "answer_count": 1, "score": 3, "last_activity_date": 1553774428, "creation_date": 1553587273, "last_edit_date": 1553678376, "question_id": 55352313, "link": "https://stackoverflow.com/questions/55352313/trying-to-decrypt-a-string-using-openssl-golang-which-has-been-encrypted-in-rail", "title": "Trying to decrypt a string using openssl/golang which has been encrypted in rails", "body": "<p>I am trying to decrypt a string which has been encrypted in my rails project. This is how I am encrypting the data:</p>\n\n<pre><code>def encrypt_text(text_To_encrypt)\n        # 0. generate the key using command openssl rand -hex 16 on linux machines\n        # 1. Read the secret from config\n        # 2. Read the salt from config\n        # 3. Encrypt the data\n        # 4. return the encypted data\n        # Ref: http://www.monkeyandcrow.com/blog/reading_rails_how_does_message_encryptor_work/\n        secret = Rails.configuration.miscconfig['encryption_key']\n        salt = Rails.configuration.miscconfig['encryption_salt']\n        key = ActiveSupport::KeyGenerator.new(secret).generate_key(salt, 32)\n        crypt = ActiveSupport::MessageEncryptor.new(key)\n        encrypted_data = crypt.encrypt_and_sign(text_To_encrypt)\n        encrypted_data\nend\n</code></pre>\n\n<p>Now the issue is I am not able to decrypt it using openssl. It just shows bad magic number. Once I do that in open ssl, my plan is to decrypt it in  golang.</p>\n\n<p>Here is how I tried to descrypt it using openssl:</p>\n\n<pre><code>openssl enc -d -aes-256-cbc -salt -in encrypted.txt -out decrypted.txt -d -pass pass:&lt;the key given in rails&gt; -a\n</code></pre>\n\n<p>This just shows bad magic number</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "for-loop", "hash"], "comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 1, "creation_date": 1553585301, "post_id": 55351651, "comment_id": 97427474, "body": "Post error back-trace here"}, {"owner": {"reputation": 741, "user_id": 7752594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gU6so.png?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/7752594/vishal"}, "edited": false, "score": 0, "creation_date": 1553585585, "post_id": 55351651, "comment_id": 97427618, "body": "what contains in @products? is it collection or array?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1553587431, "post_id": 55351651, "comment_id": 97428508, "body": "What is <code>@products</code>? What does it return?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1553588122, "post_id": 55351651, "comment_id": 97428895, "body": "Please add the code that assigns <code>@products</code> (probably your controller action)."}], "answers": [{"comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 1, "creation_date": 1553588749, "post_id": 55352150, "comment_id": 97429188, "body": "<code>product.name</code>, <code>product[&#39;name&#39;]</code> &amp; <code>product[:name]</code> all these deliver same for your information."}], "tags": [], "owner": {"reputation": 330, "user_id": 7919910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C9jNU.jpg?s=128&g=1", "display_name": "Amir El-Bashary", "link": "https://stackoverflow.com/users/7919910/amir-el-bashary"}, "is_accepted": true, "score": 0, "last_activity_date": 1553587934, "last_edit_date": 1553587934, "creation_date": 1553586655, "answer_id": 55352150, "question_id": 55351651, "link": "https://stackoverflow.com/questions/55351651/no-implicit-conversion-of-symbol-into-integer-when-i-am-trying-to-do-a-for-loop/55352150#55352150", "title": "no implicit conversion of Symbol into Integer when I am trying to do a for loop", "body": "<p>If <code>@products</code> is a query Ex. <code>@products = Product.all</code></p>\n\n<p>You can use <code>product.name</code> instead of [:name] </p>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 0, "last_activity_date": 1553587954, "creation_date": 1553587954, "answer_id": 55352490, "question_id": 55351651, "link": "https://stackoverflow.com/questions/55351651/no-implicit-conversion-of-symbol-into-integer-when-i-am-trying-to-do-a-for-loop/55352490#55352490", "title": "no implicit conversion of Symbol into Integer when I am trying to do a for loop", "body": "<p>This answer is based on your (now deleted) comment:</p>\n\n<blockquote>\n  <p>After I tried your solution<sup>\u2020</sup>, it says <code>undefined method `name' for [:id, \"1\"]:Array</code></p>\n  \n  <hr>\n  \n  <p><sup>\u2020</sup> using <code>product.name</code> instead of <code>product[:name]</code></p>\n</blockquote>\n\n<p>Your <code>@products</code> array contains other 2-element arrays like this:</p>\n\n<pre><code>@products = [[:id, \"1\"], [:id, \"2\"], [:id, \"3\"]]\n</code></pre>\n\n<p>Therefore each <code>product</code> refers to one of these inner arrays and <code>product[:name]</code> results in the error message:</p>\n\n<pre><code>product = @products.first\n#=&gt; [:id, \"1\"]\n\nproduct[:name]\n# TypeError (no implicit conversion of Symbol into Integer)\n</code></pre>\n\n<p>You solve this problem by changing what's inside the <code>@products</code> array. It should be instances of <code>Product</code>, not other arrays. The assignment probably occurs in your controller.</p>\n"}], "owner": {"reputation": 25, "user_id": 6676903, "user_type": "registered", "profile_image": "https://graph.facebook.com/889946557781820/picture?type=large", "display_name": "Hao Wen", "link": "https://stackoverflow.com/users/6676903/hao-wen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 55352150, "answer_count": 2, "score": -2, "last_activity_date": 1553594034, "creation_date": 1553584667, "last_edit_date": 1553594034, "question_id": 55351651, "link": "https://stackoverflow.com/questions/55351651/no-implicit-conversion-of-symbol-into-integer-when-i-am-trying-to-do-a-for-loop", "title": "no implicit conversion of Symbol into Integer when I am trying to do a for loop", "body": "<p>I am trying to use for loop to show more images on one page. </p>\n\n<p>I have tried </p>\n\n<pre><code> &lt;% @products.each do |product| %&gt;\n         &lt;div class=\"col-xs-3\"&gt;\n          &lt;div class=\"thumbnail\"&gt;\n            &lt;img src=\"https://images.pexels.com/photos/96974/pexels-photo-96974.jpeg?h=350&amp;auto=compress&amp;cs=tinysrgb\" alt=\"...\"&gt;\n              &lt;div class=\"caption\"&gt;\n              &lt;h3&gt;&lt;%= product[:name] %&gt;&lt;/h3&gt;\n              &lt;p&gt;&lt;%= product[:description] %&gt;&lt;/p&gt;\n              &lt;p&gt;&lt;a href=\"#\" class=\"btn btn-primary\" role=\"button\"&gt;Button&lt;/a&gt; &lt;a href=\"#\" class=\"btn btn-default\" role=\"button\"&gt;Button&lt;/a&gt;&lt;/p&gt;\n              &lt;/div&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>It is my home controller which I add below:\nclass HomeController &lt; ApplicationController</p>\n\n<pre><code>  def index\n    @ad = {\n        title: \"\u5927\u578b\u5e7f\u544a\",\n        des: \"\u8fd9\u662f\u5e7f\u544a\",\n        action_title: \"\u8fd9\u662f\u5e7f\u544a\",\n    }\n    @products = {\n        id: \"1\",\n        name: \"\u67f3\u6a59\u6c41\",\n        description: \"\u597d\u559d\u7684\u67f3\u6a59\u6c41\",\n        image_url: \"https://images.pexels.com/photos/96974/pexels-photo-96974.jpeg?h=350&amp;auto=compress&amp;cs=tinysrgb\",\n    }\n  end\nend\n</code></pre>\n\n<p>It shows no implicit conversion of Symbol into Integer.</p>\n"}, {"tags": ["ruby", "methods", "extend"], "comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1553584296, "post_id": 55351509, "comment_id": 97426948, "body": "Yes there is. But this feels like an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY Problem</a>. What are you solving with this?"}, {"owner": {"reputation": 153, "user_id": 4254220, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b3f2b88b871bdf3990476ebcf345d22d?s=128&d=identicon&r=PG&f=1", "display_name": "kotyara85", "link": "https://stackoverflow.com/users/4254220/kotyara85"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1553584755, "post_id": 55351509, "comment_id": 97427179, "body": "There&#39;s an existing module and a class in it.  I want to extend it&#39;s initialize class to additionally call my custom method in it."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1553584892, "post_id": 55351509, "comment_id": 97427242, "body": "Ok, but why? There&#39;s usually a better way than altering an existing class."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1553621056, "post_id": 55351509, "comment_id": 97449833, "body": "@Schwern, &quot;why&quot; is a valid question but at the same time I&#39;ve learned a lot by answering far crazier questions, taken at face value."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1553622881, "post_id": 55351509, "comment_id": 97450808, "body": "@CarySwoveland Why not both?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1553625477, "post_id": 55351509, "comment_id": 97452104, "body": "@Schwern, that&#39;s what I said. :-)"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1553584805, "post_id": 55351667, "comment_id": 97427200, "body": "Return value of initializer is ignored, though."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1553584903, "post_id": 55351667, "comment_id": 97427250, "body": "Ah, they want to <code>puts</code> (or other side-effects). That&#39;s easier. Thought they want the return value."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1553600297, "post_id": 55351667, "comment_id": 97435974, "body": "@SergioTulentsev <code>initialize</code> is only called for its side-effects. The return value isn&#39;t used."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1553600536, "post_id": 55351667, "comment_id": 97436106, "body": "@Stefan: yes, I know. Wasn&#39;t sure OP knows too. I&#39;ve seen such questions before (&quot;how to change return value of initialize&quot;, thinking that would affect what <code>new</code> returns)"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1553600611, "post_id": 55351667, "comment_id": 97436153, "body": "@Stefan ...when called by <code>::new</code>. There is no reason (except code stink) that it couldn\u2019t also be called explicitly by someone, who would examine the return value, as if it were a normal instance method (which it actually is). Obviously this is extremely hypothetical, but not as impossible as you suggest."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1553608152, "post_id": 55351667, "comment_id": 97441287, "body": "What is the advantage of this over simply using <code>Module#prepend</code>, which was more or less explicitly created to make this unnecessary?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1553609038, "post_id": 55351667, "comment_id": 97441951, "body": "@J&#246;rgWMittag Not much. In my defense, my answer was earlier than Stefan\u2019s, I didn\u2019t think of it, wish I did, upvoted him anyway; decided to leave this up because it does showcase the pre-<code>prepend</code> way (and Ruby\u2019s flexibility)."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1553620482, "post_id": 55351667, "comment_id": 97449495, "body": "@J&#246;rgWMittag I don&#39;t understand your point. Before your comment Amadan had made no claim that his answer is superior to using <code>prepend</code>. His reply to you makes it clear that after &quot;prepend&quot; came to mind he realised that was the way to go. Does that mean he should now delete his answer? Of course not. Who knows how readers may benefit in future by having read his answer. Moreover, I think this answer helps readers understand why <code>prepend</code> is useful, which has value in itself."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 2, "last_activity_date": 1553585017, "last_edit_date": 1553585017, "creation_date": 1553584741, "answer_id": 55351667, "question_id": 55351509, "link": "https://stackoverflow.com/questions/55351509/is-there-a-way-to-append-some-function-to-initialize-and-execute-it/55351667#55351667", "title": "Is there a way to append some function to initialize and execute it?", "body": "<p>If the code for <code>Test</code> is not under your control, and you want to inject <code>test</code>:</p>\n\n<pre><code>Test.class_eval do\n  def test\n    puts \"TEST\"\n  end\n\n  alias initialize_without_test initialize\n\n  # This, if you want the return value of `test` to replace the original's    \n  def initialize(*args, &amp;block)\n    initialize_without_test(*args, &amp;block)\n    test\n  end\n\n  # Or this, if you want to keep the return value of original `initialize`\n  def initialize(*args, &amp;block)\n    initialize_without_test(*args, &amp;block).tap do\n      test\n    end\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 3, "last_activity_date": 1553586370, "creation_date": 1553586370, "answer_id": 55352067, "question_id": 55351509, "link": "https://stackoverflow.com/questions/55351509/is-there-a-way-to-append-some-function-to-initialize-and-execute-it/55352067#55352067", "title": "Is there a way to append some function to initialize and execute it?", "body": "<p>You can define a module containing your extension:</p>\n\n<pre><code>module TestExtension\n  def initialize\n    super\n    puts 'test'\n  end\nend\n</code></pre>\n\n<p>and then <a href=\"http://ruby-doc.org/core-2.6.2/Module.html#method-i-prepend\" rel=\"nofollow noreferrer\"><code>prepend</code></a> that module to <code>Test</code>:</p>\n\n<pre><code>class Test\n  def initialize\n    puts 'cool'\n  end\nend\n\nTest.prepend(TestExtension)\nTest.new\n# cool\n# test\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 4254220, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b3f2b88b871bdf3990476ebcf345d22d?s=128&d=identicon&r=PG&f=1", "display_name": "kotyara85", "link": "https://stackoverflow.com/users/4254220/kotyara85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1553599424, "creation_date": 1553584049, "last_edit_date": 1553599424, "question_id": 55351509, "link": "https://stackoverflow.com/questions/55351509/is-there-a-way-to-append-some-function-to-initialize-and-execute-it", "title": "Is there a way to append some function to initialize and execute it?", "body": "<p>Let's say I have a class Test</p>\n\n<pre><code>class Test\n  def initialize()\n    puts \"cool\"\n  end\nend\n</code></pre>\n\n<p>Is there a way to extend initialize class somehow and execute some method in it?</p>\n\n<p>For example I want to:</p>\n\n<pre><code>class Test\n  def func()\n    puts \"test\"\n  end\nend\n\ntest = Test.new()\n</code></pre>\n\n<p>Should output</p>\n\n<pre><code>cool\ntest\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1651, "user_id": 4414956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17a7ff9df014e5c92697372747c15d77?s=128&d=identicon&r=PG&f=1", "display_name": "nuaky", "link": "https://stackoverflow.com/users/4414956/nuaky"}, "edited": false, "score": 0, "creation_date": 1553585865, "post_id": 55351500, "comment_id": 97427733, "body": "did you installed ruby via brew? You can run <code>brew doctor</code> to check for issue with ruby. After confirming issue, you can relink ruby with <code>brew link --overwrite ruby</code>"}, {"owner": {"reputation": 85, "user_id": 8654845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a062881eb20b954b7e041a6d4ff7106?s=128&d=identicon&r=PG&f=1", "display_name": "Bablu Patel", "link": "https://stackoverflow.com/users/8654845/bablu-patel"}, "reply_to_user": {"reputation": 1651, "user_id": 4414956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17a7ff9df014e5c92697372747c15d77?s=128&d=identicon&r=PG&f=1", "display_name": "nuaky", "link": "https://stackoverflow.com/users/4414956/nuaky"}, "edited": false, "score": 0, "creation_date": 1553592621, "post_id": 55351500, "comment_id": 97431204, "body": "thanks for reply. No i use RVM to install any ruby and i tried this command but no use"}, {"owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "edited": false, "score": 0, "creation_date": 1553621658, "post_id": 55351500, "comment_id": 97450151, "body": "What operating system is this on?"}, {"owner": {"reputation": 943, "user_id": 546950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60de781d84a6767b10c5040c54180433?s=128&d=identicon&r=PG", "display_name": "robertoplancarte", "link": "https://stackoverflow.com/users/546950/robertoplancarte"}, "edited": false, "score": 0, "creation_date": 1553622891, "post_id": 55351500, "comment_id": 97450811, "body": "Have you tried to comment out the airbrake gem to see if the server starts? Also try removing RVM with &#39;rvm implode&#39; ande see if you have another ruby/gem installed that might be causing a problem. If you do, delete that version and reinstall a clean ruby with rvm."}, {"owner": {"reputation": 85, "user_id": 8654845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a062881eb20b954b7e041a6d4ff7106?s=128&d=identicon&r=PG&f=1", "display_name": "Bablu Patel", "link": "https://stackoverflow.com/users/8654845/bablu-patel"}, "edited": false, "score": 0, "creation_date": 1553665854, "post_id": 55351500, "comment_id": 97463754, "body": "I am using mac os. I had to reinstall rails and rvm too. But after installing and I am able to run my server now but i am unable to bundle in jruby getting zsh: command not found: bundle errors."}], "owner": {"reputation": 85, "user_id": 8654845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a062881eb20b954b7e041a6d4ff7106?s=128&d=identicon&r=PG&f=1", "display_name": "Bablu Patel", "link": "https://stackoverflow.com/users/8654845/bablu-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1553584362, "creation_date": 1553583981, "last_edit_date": 1553584362, "question_id": 55351500, "link": "https://stackoverflow.com/questions/55351500/unable-to-run-rails-server", "title": "Unable to run rails server", "body": "<p>When I am trying to run my rails server using the following command:</p>\n\n<pre><code>   rails s\n</code></pre>\n\n<p>It throws the following error:</p>\n\n<blockquote>\n  <p>/Users/babaloo/.rvm/gems/ruby-2.5.1/gems/airbrake-ruby- \n    4.2.1/lib/airbrake-ruby/tdigest.rb:1:in `require':    dlopen(/Users/babaloo/.rvm/gems/ruby-2.5.1/gems/rbtree3- \n    0.5.0/rbtree.bundle, 9):    Library not loaded: /usr/local/opt/ruby/lib/libruby.2.5.dylib    (LoadError)</p>\n  \n  <p>Referenced from: /Users/babaloo/.rvm/gems/ruby-2.5.1/gems/rbtree3- \n    0.5.0/rbtree.bundle</p>\n</blockquote>\n\n<p>Please help me how to solve this problem, Thanks in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "environment-variables"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1553585630, "post_id": 55351090, "comment_id": 97427636, "body": "ENV is an enumerable. Which means you can use <code>group_by</code>, <code>reduce</code> and all other methods of Enumerable."}, {"owner": {"reputation": 3959, "user_id": 1381266, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7ac54c032c1dd24a5e6c737d06b83a03?s=128&d=identicon&r=PG", "display_name": "Galet", "link": "https://stackoverflow.com/users/1381266/galet"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1553585739, "post_id": 55351090, "comment_id": 97427679, "body": "@SergioTulentsev Is there any example? How can I use for my scenario?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1553585770, "post_id": 55351090, "comment_id": 97427691, "body": "Yes, there are examples (of grouping) in the docs (look up Enumerable#group_by). I assume if you were provided with already grouped data, you&#39;d have no problem displaying it."}, {"owner": {"reputation": 3959, "user_id": 1381266, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7ac54c032c1dd24a5e6c737d06b83a03?s=128&d=identicon&r=PG", "display_name": "Galet", "link": "https://stackoverflow.com/users/1381266/galet"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1553585963, "post_id": 55351090, "comment_id": 97427782, "body": "Then how can I provide grouped data to ENV?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1553586003, "post_id": 55351090, "comment_id": 97427799, "body": "You don&#39;t.  You take data from ENV and convert/transform it into a grouped data structure."}, {"owner": {"reputation": 3959, "user_id": 1381266, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7ac54c032c1dd24a5e6c737d06b83a03?s=128&d=identicon&r=PG", "display_name": "Galet", "link": "https://stackoverflow.com/users/1381266/galet"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1553586937, "post_id": 55351090, "comment_id": 97428258, "body": "@SergioTulentsev I don&#39;t know how to use group_by for my scenario. I can use hash.group_by(&amp;:name) if hash key is same. But in my case, it is different. it would be helpful if you provide solution for this"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1553587139, "post_id": 55351090, "comment_id": 97428356, "body": "Yes, you&#39;ll need to use full form of the block: <code>ENV.group_by {|key, value| get_prefix(key) }</code>"}, {"owner": {"reputation": 3959, "user_id": 1381266, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7ac54c032c1dd24a5e6c737d06b83a03?s=128&d=identicon&r=PG", "display_name": "Galet", "link": "https://stackoverflow.com/users/1381266/galet"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1553590213, "post_id": 55351090, "comment_id": 97429900, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/190682/discussion-between-galet-and-sergio-tulentsev\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1553588864, "post_id": 55352522, "comment_id": 97429255, "body": "Oh nice, since when <code>start_with?</code> is variadic?"}, {"owner": {"reputation": 2989, "user_id": 1009655, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/K3jdk.png?s=128&g=1", "display_name": "Frederik Spang", "link": "https://stackoverflow.com/users/1009655/frederik-spang"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1553589140, "post_id": 55352522, "comment_id": 97429401, "body": "@SergioTulentsev For all I can tell, since at least 1.9.1; That&#39;s as far as I went back."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 2989, "user_id": 1009655, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/K3jdk.png?s=128&g=1", "display_name": "Frederik Spang", "link": "https://stackoverflow.com/users/1009655/frederik-spang"}, "edited": false, "score": 3, "creation_date": 1553589310, "post_id": 55352522, "comment_id": 97429478, "body": "@FrederikSpang: you live, you learn. This could have saved me a few loops in the past :)"}, {"owner": {"reputation": 2989, "user_id": 1009655, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/K3jdk.png?s=128&g=1", "display_name": "Frederik Spang", "link": "https://stackoverflow.com/users/1009655/frederik-spang"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1553589340, "post_id": 55352522, "comment_id": 97429491, "body": "@SergioTulentsev Know the feeling!"}], "tags": [], "owner": {"reputation": 2301, "user_id": 19317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47035e07012da3162b6e83650ee3abe0?s=128&d=identicon&r=PG", "display_name": "aridlehoover", "link": "https://stackoverflow.com/users/19317/aridlehoover"}, "is_accepted": true, "score": 1, "last_activity_date": 1553588110, "creation_date": 1553588110, "answer_id": 55352522, "question_id": 55351090, "link": "https://stackoverflow.com/questions/55351090/how-to-display-environment-variables-as-a-group-in-rails/55352522#55352522", "title": "How to display environment variables as a group in Rails", "body": "<p>I think what you want is a custom serializer. Something similar to this:</p>\n\n<pre><code>class EnvSerializer\n  def as_json\n    {\n      S3: env_select('S3'),\n      DB: env_select('DB'),\n      Other: env_reject('S3', 'DB')\n    }\n  end\n\n  private\n\n  def env_select(prefix)\n    ENV.select { |k, v| k.start_with?(prefix) }\n  end\n\n  def env_reject(*prefixes)\n    ENV.reject { |k, v| k.start_with?(*prefixes) }\n  end\nend\n</code></pre>\n\n<p>Which would look like this in the controller:</p>\n\n<pre><code>class EnvController &lt; ApplicationController\n  def index\n    render json: EnvSerializer.new.as_json\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 3959, "user_id": 1381266, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7ac54c032c1dd24a5e6c737d06b83a03?s=128&d=identicon&r=PG", "display_name": "Galet", "link": "https://stackoverflow.com/users/1381266/galet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 55352522, "answer_count": 1, "score": 0, "last_activity_date": 1553589875, "creation_date": 1553582082, "last_edit_date": 1553589875, "question_id": 55351090, "link": "https://stackoverflow.com/questions/55351090/how-to-display-environment-variables-as-a-group-in-rails", "title": "How to display environment variables as a group in Rails", "body": "<p>I am using Rails 5.2 application. I want to display the Environment variables as a group in the endpoint.</p>\n\n<p>env_controller.rb</p>\n\n<pre><code>class EnvController &lt; ApplicationController\n  def index\n   render json: ENV.to_h\n  end\nend\n</code></pre>\n\n<p>When I load <a href=\"http://localhost:3000/env\" rel=\"nofollow noreferrer\">http://localhost:3000/env</a>, I see the following result</p>\n\n<pre><code>{\n  \"XDG_VTNR\": \"7\",\n  \"MANPATH\": \"/home/ubuntu/.nvm/versions/node/v4.6.0/share/man:/home/ubuntu/.rvm/rubies/ruby-2.6.2/share/man:/home/ubuntu/.rvm/man:/usr/lib/jvm/java-8-oracle/man:/usr/local/man:/usr/local/share/man:/usr/share/man\",\n  \"S3_SOURCE_PATH\": \"dev/source\",\n  \"DB_ENV_USER\": \"postgres\",\n  \"XDG_SESSION_ID\": \"c2\",\n  \"rvm_bin_path\": \"/home/ubuntu/.rvm/bin\",\n  \"S3_DESTINATION_PATH\": \"dev/destination\",\n  \"SESSION\": \"ubuntu\",\n  \"DB_PORT_5432_TCP_ADDR\": \"localhost\",\n  \"S3_REGION\": \"us-east-1\"\n}\n</code></pre>\n\n<p>I want to group the environment variables as follows. My expected result is as follows</p>\n\n<pre><code>{\n  \"S3\": {\n    \"S3_SOURCE_PATH\": \"reports/source\",\n    \"S3_DESTINATION_PATH\": \"reports/destination\",\n    \"S3_REGION\": \"us-east-1\"\n  },\n  \"DB\": {\n    \"DB_ENV_USER\": \"postgres\",\n    \"DB_PORT_5432_TCP_ADDR\": \"localhost\"\n  },\n  \"Others\": {\n    \"XDG_VTNR\": \"7\",\n    \"MANPATH\": \"/home/ubuntu/.nvm/versions/node/v4.6.0/share/man:/home/ubuntu/.rvm/rubies/ruby-2.6.2/share/man:/home/ubuntu/.rvm/man:/usr/lib/jvm/java-8-oracle/man:/usr/local/man:/usr/local/share/man:/usr/share/man\",\n    \"XDG_SESSION_ID\": \"c2\",\n    \"rvm_bin_path\": \"/home/ubuntu/.rvm/bin\",\n    \"SESSION\": \"ubuntu\"\n  }\n}\n</code></pre>\n\n<p>I definitely need \"S3\" and \"DB\" to be grouped. There are more variables in my application should be grouped like this. Above are the samples.</p>\n\n<p>How can I display it as the above?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 21, "user_id": 8786711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oHHQx.png?s=128&g=1", "display_name": "Kotodharma", "link": "https://stackoverflow.com/users/8786711/kotodharma"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1553725164, "post_id": 55348693, "comment_id": 97496527, "body": "People devise solutions based on what they already know. The word &quot;delegation&quot; was not in my s/w dev vocabulary, and no amount of googling how to catch no-method errors was going to find it for me. Thank you for providing a helpful hint and not being snide at all."}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1553606281, "post_id": 55349720, "comment_id": 97439991, "body": "Definitely would be careful with the method missing option given <a href=\"https://github.com/rails/rails/blob/master/activerecord/lib/active_record/dynamic_matchers.rb#L15\" rel=\"nofollow noreferrer\">github.com/rails/rails/blob/master/activerecord/lib/&hellip;</a> and <a href=\"https://github.com/rails/rails/blob/master/activemodel/lib/active_model/attribute_methods.rb#L425\" rel=\"nofollow noreferrer\">github.com/rails/rails/blob/master/activemodel/lib/active_mo&zwnj;&#8203;del/&hellip;</a>"}], "tags": [], "owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "is_accepted": false, "score": 0, "last_activity_date": 1553574097, "last_edit_date": 1553574097, "creation_date": 1553573361, "answer_id": 55349720, "question_id": 55348693, "link": "https://stackoverflow.com/questions/55348693/how-to-define-rescue-from-type-handler-for-activerecord-models/55349720#55349720", "title": "How to define rescue_from-type handler for ActiveRecord models?", "body": "<h1>Overide method_missing :) !?</h1>\n\n<p>You could try overriding the <code>method_missing</code> method. This could potentially cause confusing bugs, but overriding that method is definitely used to great effect in at least one gem that i know of.</p>\n\n<p>I didn't want to call the class <code>new</code> because it is a reserved keyword and can be confusing. So I changed the class name to <code>Upgraded</code>.</p>\n\n<p>This should get you started.</p>\n\n<pre><code>class Upgraded\n  def getter\n    puts \"Congrats, it gets!\"\n  end\nend\n\nclass Original\n  def initialize\n    @new_instance = Upgraded.new\n  end\n\n  def method_missing(message, *args, &amp;block)\n    if message == :attribute_getter\n      @new_instance.send(:getter, *args, &amp;block)\n    else\n      super\n    end\n  end\n\n  def respond_to_missing?(method_name, *args)\n    method_name == :attribute_getter or super\n  end\nend\n\nc = Original.new\nc.attribute_getter\n</code></pre>\n\n<ul>\n<li>You will have to change names of the getter and setter methods. Because you have a <code>belongs_to</code> association you can just use that.</li>\n</ul>\n\n<h2>Or you could try just using delegate_to</h2>\n\n<p>like @mu_is_too_short suggests, you could try something like this?</p>\n\n<pre><code>class Original &lt; ApplicationRecord\n belongs_to :upgraded\n delegate :getter_method, :to =&gt; :upgraded \nend\n\nclass Upgraded &lt; ApplicationRecord\n  def getter_method\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 8786711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oHHQx.png?s=128&g=1", "display_name": "Kotodharma", "link": "https://stackoverflow.com/users/8786711/kotodharma"}, "is_accepted": false, "score": 0, "last_activity_date": 1553725003, "creation_date": 1553725003, "answer_id": 55387315, "question_id": 55348693, "link": "https://stackoverflow.com/questions/55348693/how-to-define-rescue-from-type-handler-for-activerecord-models/55387315#55387315", "title": "How to define rescue_from-type handler for ActiveRecord models?", "body": "<p>Apparently what I needed to know is the word \"<a href=\"https://www.rubyguides.com/2018/10/delegate-methods-in-ruby/\" rel=\"nofollow noreferrer\">delegation</a>\". It seems there are a variety of ways to do this kind of thing in Ruby, and Rails, and I should have expected that Ruby's way of doing it would be cleaner, more elegant, and more evolved than Perl5. In particular, recent versions of Rails provide \"<a href=\"https://github.com/rails/rails/pull/23930\" rel=\"nofollow noreferrer\">delegate_missing_to</a>\", which appears to be precisely what I need for this use case.</p>\n"}], "owner": {"reputation": 21, "user_id": 8786711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oHHQx.png?s=128&g=1", "display_name": "Kotodharma", "link": "https://stackoverflow.com/users/8786711/kotodharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1553725003, "creation_date": 1553564479, "question_id": 55348693, "link": "https://stackoverflow.com/questions/55348693/how-to-define-rescue-from-type-handler-for-activerecord-models", "title": "How to define rescue_from-type handler for ActiveRecord models?", "body": "<p>Developing in Rails 5.2.2.1. I want to define a \"global\" rescue handler for my model, so that I can catch <code>NoMethodError</code> and take appropriate action. I find that controllers can do this with <code>rescue_from</code>, but models cannot. Knowing that the Rails Developers are smart people ;) I figure there must be some Good Reason for this, but I'm still frustrated. Googling around, and I can't even find any examples of people asking how to do this, and other people either telling them how, or why they can't, or why they shouldn't want to. Maybe it's because rescue handlers can't return a value to the original caller?</p>\n\n<p>Here's what I'm trying to do: I need to refactor my app so that what used to be a single model is now split into two (let's call them Orig and New). Briefly, I want to make it so that when an attribute getter method (say) is called against an Orig object, if that attribute has moved to New, then I can catch this error and call <code>new.getter</code> instead (understanding that Orig now <code>belongs_to</code> a New). This solution is inspired by my experience doing just this sort of thing with Perl5's <code>AUTOLOAD</code> feature.</p>\n\n<p>Any ideas of how to get this done are much appreciated. Maybe I just have to define getters/setters for all the moved attributes individually.</p>\n"}, {"tags": ["ruby", "fxruby"], "comments": [{"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 1, "creation_date": 1553564445, "post_id": 55348077, "comment_id": 97422054, "body": "<a href=\"https://www.rubydoc.info/gems/fxruby/Fox/FXImage#gradient-instance_method\" rel=\"nofollow noreferrer\"><code>#gradient</code></a> is an instance method of class <code>FXImage</code>"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 11257686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c92fe650052f8870c25e9d03d51a805?s=128&d=identicon&r=PG&f=1", "display_name": "powwu", "link": "https://stackoverflow.com/users/11257686/powwu"}, "edited": false, "score": 0, "creation_date": 1553622038, "post_id": 55348746, "comment_id": 97450374, "body": "You&#39;re a lifesaver! Thank you so much"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 2, "last_activity_date": 1553626496, "last_edit_date": 1553626496, "creation_date": 1553564943, "answer_id": 55348746, "question_id": 55348077, "link": "https://stackoverflow.com/questions/55348077/making-a-gradient-in-fxruby/55348746#55348746", "title": "Making a gradient in FXRuby", "body": "<p>According to <a href=\"https://www.rubydoc.info/gems/fxruby/Fox/FXImage#gradient-instance_method\" rel=\"nofollow noreferrer\">the docs</a> here's how you would use the method, but first you'll need to install and require the gem</p>\n\n<pre><code>gem install fxruby\n</code></pre>\n\n<p>Then in your code:</p>\n\n<pre><code>require 'fxruby'\n\n# the arguments represent rgb colors:\n# #gradient(topleft, topright, bottomleft, bottomright)\n</code></pre>\n\n<p>You'll need to pass the RGB colors you want to use for the actual gradient but here's an example of the syntax</p>\n\n<pre><code>FXImage.gradient(\n  Fox.FXRGB(253, 245, 230), \n  Fox.FXRGB(253, 245, 230), \n  Fox.FXRGB(253, 245, 230), \n  Fox.FXRGB(253, 245, 230)\n)\n</code></pre>\n\n<p>See here for <a href=\"https://www.rubydoc.info/gems/fxruby/Fox/FXColor\" rel=\"nofollow noreferrer\">examples of colors</a></p>\n"}], "owner": {"reputation": 27, "user_id": 11257686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c92fe650052f8870c25e9d03d51a805?s=128&d=identicon&r=PG&f=1", "display_name": "powwu", "link": "https://stackoverflow.com/users/11257686/powwu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 55348746, "answer_count": 1, "score": 1, "last_activity_date": 1553626496, "creation_date": 1553558608, "last_edit_date": 1553598259, "question_id": 55348077, "link": "https://stackoverflow.com/questions/55348077/making-a-gradient-in-fxruby", "title": "Making a gradient in FXRuby", "body": "<p>Is there a way to create a gradient in FXRuby? If so, how would I implement it?</p>\n\n<p>I have tried looking at <a href=\"https://www.rubydoc.info/gems/fxruby/Fox/FXImage\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/gems/fxruby/Fox/FXImage</a> and it didn't make much sense to me, If I could get elaboration on what <code>#gradient</code> means and how to use it, that would be great.</p>\n"}, {"tags": ["ruby", "puma", "adsf"], "answers": [{"comments": [{"owner": {"reputation": 5610, "user_id": 413924, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a5fae9bf6a8e05a023c96ba434a1dfd5?s=128&d=identicon&r=PG", "display_name": "DannyB", "link": "https://stackoverflow.com/users/413924/dannyb"}, "edited": false, "score": 0, "creation_date": 1553578033, "post_id": 55349466, "comment_id": 97424758, "body": "Thank you. This seems to do the trick. I am leaving the answer unaccepted for another day to see if someone else had any other suggestion, I will accept it if not. In the meantime, I also opened an <a href=\"https://github.com/ddfreyne/adsf/issues/16\" rel=\"nofollow noreferrer\">issue on adsf</a> suggesting to add this as a built in option."}], "tags": [], "owner": {"reputation": 579, "user_id": 11206879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bS2D6.png?s=128&g=1", "display_name": "Pan Ke", "link": "https://stackoverflow.com/users/11206879/pan-ke"}, "is_accepted": true, "score": 0, "last_activity_date": 1553571101, "creation_date": 1553571101, "answer_id": 55349466, "question_id": 55347426, "link": "https://stackoverflow.com/questions/55347426/how-to-make-adsf-puma-serve-html-files-without-the-html-extension/55349466#55349466", "title": "How to make ADSF/Puma serve HTML files without the .html extension", "body": "<p><a href=\"https://github.com/tommysundstrom/middleman-rack-optional-html\" rel=\"nofollow noreferrer\">https://github.com/tommysundstrom/middleman-rack-optional-html</a> might help.</p>\n\n<p>actually the code is simple. add \".html\" extention if the path doesn't end with \"html\".</p>\n\n<p><a href=\"https://github.com/tommysundstrom/middleman-rack-optional-html/blob/df1e50beca7599f3e47c5b83887573434f3253e3/lib/rack/middleman/optional_html.rb#L50\" rel=\"nofollow noreferrer\">https://github.com/tommysundstrom/middleman-rack-optional-html/blob/df1e50beca7599f3e47c5b83887573434f3253e3/lib/rack/middleman/optional_html.rb#L50</a></p>\n"}], "owner": {"reputation": 5610, "user_id": 413924, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a5fae9bf6a8e05a023c96ba434a1dfd5?s=128&d=identicon&r=PG", "display_name": "DannyB", "link": "https://stackoverflow.com/users/413924/dannyb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 55349466, "answer_count": 1, "score": 0, "last_activity_date": 1553575001, "creation_date": 1553553701, "last_edit_date": 1553575001, "question_id": 55347426, "link": "https://stackoverflow.com/questions/55347426/how-to-make-adsf-puma-serve-html-files-without-the-html-extension", "title": "How to make ADSF/Puma serve HTML files without the .html extension", "body": "<p>I am building a static site without the help of Jekyll or any other known static site builder. When deploying such site to a static site host like GitHub Pages or Netlify, these servers know to load <code>software.html</code> when I am accessing <code>mydomain.com/software</code> (without the <code>.html</code> extension).</p>\n\n<p>Is there a way for me to reproduce this behavior when running a local, Ruby-based web server such as Puma? More specifically, I am using Ruby's <a href=\"https://github.com/ddfreyne/adsf\" rel=\"nofollow noreferrer\">adsf</a> wrapper to launch a Puma server to serve my site locally for development.</p>\n\n<p>My guess is that this should be possible by some rack middleware or rack configuration, I am just unable to identify the proper Google search for it.</p>\n\n<p>I should probably mention that I am not interested in the <code>directory/index.html</code> approach, since all web servers I have seen add a trailing slash to the URL in these cases.</p>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 309, "user_id": 950781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/iDxO7.jpg?s=128&g=1", "display_name": "Marrento", "link": "https://stackoverflow.com/users/950781/marrento"}, "edited": false, "score": 0, "creation_date": 1553552350, "post_id": 55347141, "comment_id": 97419205, "body": "Shoot. I forgot I&#39;m writing. Nice. thanks a lot"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 309, "user_id": 950781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/iDxO7.jpg?s=128&g=1", "display_name": "Marrento", "link": "https://stackoverflow.com/users/950781/marrento"}, "edited": false, "score": 0, "creation_date": 1553552987, "post_id": 55347141, "comment_id": 97419386, "body": "My pleasure man"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 2, "last_activity_date": 1553688621, "last_edit_date": 1553688621, "creation_date": 1553551805, "answer_id": 55347141, "question_id": 55347097, "link": "https://stackoverflow.com/questions/55347097/rspec-shows-undefined-method-but-the-object-is-available-in-the-same-block/55347141#55347141", "title": "Rspec shows Undefined method but the object is available in the same block", "body": "<p>The error complains about a method <code>rank=</code> undefined. Note that this is different from <code>rank</code>. Use <code>attr_accessor</code> to define both getter and setter methods</p>\n\n<pre><code>attr_accessor :rank, :suit\n</code></pre>\n\n<p>This is going to define </p>\n\n<pre><code>def rank\n  @rank\nend\n\ndef rank=(r)\n @rank = r\nend\n</code></pre>\n\n<p>and the same for <code>suit</code></p>\n"}], "owner": {"reputation": 309, "user_id": 950781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/iDxO7.jpg?s=128&g=1", "display_name": "Marrento", "link": "https://stackoverflow.com/users/950781/marrento"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "closed_date": 1553615837, "accepted_answer_id": 55347141, "answer_count": 1, "score": -2, "last_activity_date": 1553688621, "creation_date": 1553551559, "last_edit_date": 1553598768, "question_id": 55347097, "link": "https://stackoverflow.com/questions/55347097/rspec-shows-undefined-method-but-the-object-is-available-in-the-same-block", "closed_reason": "Not suitable for this site", "title": "Rspec shows Undefined method but the object is available in the same block", "body": "<p>This works in a tutorial on rspec:</p>\n\n<pre><code>class Card\n  attr_reader :rank, :suit\n\n  def initialize(rank, suit)\n    @rank = rank\n    @suit = suit\n  end\nend\n\nRSpec.describe Card do\n  let(:card) {Card.new('Ace', 'Spades')}\n\n  it 'has rank and rank can change' do\n    expect(card.rank).to eq('Ace')\n    card.rank = 'Queen'\n    expect(card.rank).to eq('Queen')\n  end\n  it 'has suit' do\n    expect(card.suit).to eq('Spades')\n  end\nend\n</code></pre>\n\n<p>But it does not work in the live code. When I run rspec, I get:</p>\n\n<pre><code>NoMethodError:\n   undefined method `rank=' for #&lt;Card:0x007fdddf8d2420 @rank=\"Ace\", @suit=\"Spades\"&gt;\n</code></pre>\n\n<p>Would it be a version/deprecation issue? I am using rspec: 3.8.0.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "rubygems", "vcr"], "comments": [{"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 1, "creation_date": 1553551558, "post_id": 55346878, "comment_id": 97418925, "body": "You can use <a href=\"https://github.com/travisjeffery/timecop\" rel=\"nofollow noreferrer\"><code>timecop gem</code></a> to freeze time at certain point"}, {"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 1, "creation_date": 1553551906, "post_id": 55346878, "comment_id": 97419036, "body": "Or you can write custom matcher to ignore <code>created_at</code> field in response body. Check out <a href=\"https://railsware.com/blog/2013/10/03/custom-vcr-matchers-for-dealing-with-mutable-http-requests/\" rel=\"nofollow noreferrer\"><code>this article</code></a>"}, {"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 1, "creation_date": 1553552212, "post_id": 55346878, "comment_id": 97419155, "body": "Or you can match on other attributes to ignore body matching since its changing every time. Check out <a href=\"https://relishapp.com/vcr/vcr/v/3-0-3/docs/request-matching\" rel=\"nofollow noreferrer\"><code>request-matching docs</code></a>. As you can see you have lots of options to choose from"}, {"owner": {"reputation": 53, "user_id": 7884638, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RYYOSAvWBfc/AAAAAAAAAAI/AAAAAAAAAAo/41XWVHLeMiM/photo.jpg?sz=128", "display_name": "Henrique Fernandez Teixeira", "link": "https://stackoverflow.com/users/7884638/henrique-fernandez-teixeira"}, "reply_to_user": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1553690384, "post_id": 55346878, "comment_id": 97476857, "body": "I solved the problem mocking the &quot;save&quot; method of all my &quot;ElasticRepository&quot; instances in test environment with &quot;before(:all)&quot;. Thanks for the answer."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7521309, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-C7itIIBtTyY/AAAAAAAAAAI/AAAAAAAAAAA/__U7ZY6MkUs/photo.jpg?sz=128", "display_name": "Saurabh Jain", "link": "https://stackoverflow.com/users/7521309/saurabh-jain"}, "is_accepted": false, "score": 1, "last_activity_date": 1592396843, "creation_date": 1592396843, "answer_id": 62429022, "question_id": 55346878, "link": "https://stackoverflow.com/questions/55346878/how-to-ignore-the-request-body-match-for-an-specific-host-in-rspec-vcr/62429022#62429022", "title": "How to ignore the request body match for an specific host in rspec VCR?", "body": "<p>You can try:</p>\n\n<pre><code>VCR.configure do |c|\n  c.ignore_localhost = true\n  c.cassette_library_dir = 'spec/fixtures/vcr_cassettes'\n  c.register_request_matcher :body do |request1, request2|\n    if request1.uri.include?('&lt;your_host&gt;')\n      true\n    else\n      CGI.escape(request1.body) == CGI.escape(request2.body)\n    end\n  end\n\n  c.hook_into :webmock\n  c.configure_rspec_metadata!\nend\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 7884638, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RYYOSAvWBfc/AAAAAAAAAAI/AAAAAAAAAAo/41XWVHLeMiM/photo.jpg?sz=128", "display_name": "Henrique Fernandez Teixeira", "link": "https://stackoverflow.com/users/7884638/henrique-fernandez-teixeira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 535, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1592396843, "creation_date": 1553550262, "question_id": 55346878, "link": "https://stackoverflow.com/questions/55346878/how-to-ignore-the-request-body-match-for-an-specific-host-in-rspec-vcr", "title": "How to ignore the request body match for an specific host in rspec VCR?", "body": "<p>I have ElasticSearch and Kibana integration with my rails application, and i use they for log and measure requests to external API's. I don't want that VCR match the body for ElasticSearch requests records, because there are a \"current time\" (created_at) field in every log, that breaks VCR older records.</p>\n\n<p>This is my current configuration</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>VCR.configure do |c|\n  c.ignore_localhost = true\n  c.cassette_library_dir = 'spec/fixtures/vcr_cassettes'\n\n  vcr_mode = ENV['VCR_MODE'] =~ /rec/i ? :all : :once\n\n  c.hook_into :webmock\n  c.default_cassette_options[:record] = vcr_mode\n  c.configure_rspec_metadata!\nend\n</code></pre>\n\n<p>This is the log method in my custom REST client.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>  def log(method, params, response, comments:)\n    Rails.logger.info(response.inspect)\n\n    Elastic::LogServices\n      .log_request(comments,\n                   method: method,\n                   source: ENV['HOSTNAME'],\n                   url: response.env.url.to_s,\n                   header: response.env.request_headers,\n                   body: params,\n                   type: :out,\n                   response_header: response.headers,\n                   response_body: response.body,\n                   response_status: response.status)\n  end\n</code></pre>\n\n<p>In the log services...</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>    def self.log_request(comments = '',\n                         created_at: nil,\n                         method:,\n                         source:,\n                         url:,\n                         header:,\n                         body:,\n                         type:,\n                         response_header:,\n                         response_body: '?',\n                         response_status:,\n                         format: 'REST')\n      log =\n        Elastic::Request::Log\n        .new(created_at: created_at,\n             method: method,\n             source: source,\n             url: url,\n             header: header,\n             body: JSON.pretty_generate(body),\n             type: type,\n             response:\n              {\n                header: response_header,\n                body: JSON.pretty_generate(response_body),\n                status: response_status\n              },\n             format: format,\n             comments: comments)\n\n      Elastic::Request::LogJob.perform_async(log)\n    end\n</code></pre>\n\n<p>This field is in the log entity class</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>        @created_at = created_at || Time.now.utc.iso8601\n</code></pre>\n\n<p>Also, i dont want to Mock the \"Time.now.utc.iso8601\" method, because there are a lot of tests that i have to change. The application do a lot of requests to others APIs.</p>\n\n<p>Anyway to configure VCR to ignore the body match for all \"elasticsearch:9200\" requests?</p>\n"}, {"tags": ["ruby", "xml", "parsing", "nokogiri"], "answers": [{"comments": [{"owner": {"reputation": 137436, "user_id": 415448, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/P2vVZ.png?s=128&g=1", "display_name": "Michael Kay", "link": "https://stackoverflow.com/users/415448/michael-kay"}, "edited": false, "score": 0, "creation_date": 1553591599, "post_id": 55346661, "comment_id": 97430608, "body": "I&#39;m sure that&#39;s a correct explanation, though in theory a W3C-conformant XML parser is not allowed to attempt recovery from syntax errors in this way, it should report an error and stop."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 137436, "user_id": 415448, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/P2vVZ.png?s=128&g=1", "display_name": "Michael Kay", "link": "https://stackoverflow.com/users/415448/michael-kay"}, "edited": false, "score": 1, "creation_date": 1553622704, "post_id": 55346661, "comment_id": 97450727, "body": "@MichaelKay If you&#39;ve got a case here, write up a bug report."}, {"owner": {"reputation": 137436, "user_id": 415448, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/P2vVZ.png?s=128&g=1", "display_name": "Michael Kay", "link": "https://stackoverflow.com/users/415448/michael-kay"}, "edited": false, "score": 0, "creation_date": 1553630677, "post_id": 55346661, "comment_id": 97454399, "body": "If you think I&#39;m going to install a piece of software that I&#39;ve never used, familiarise myself with it, and run a test just so that I can submit a bug report, then you&#39;ve got an odd idea about my priorities in life. In any case, I&#39;ve no idea if it&#39;s a bug. It might be an intentional and documented non-conformance. There&#39;s no law requiring W3C conformance, after all."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1558650514, "post_id": 55346661, "comment_id": 99181260, "body": "Nokogiri is somewhat like a puppy in that it&#39;ll try to return something useful, which is good when trying to do lots of batch processing. The downside to that is the HTML or XML can be mangled as it tries to recover from bad input. The <code>errors</code> method helps, which when used on the OPs document tells us there&#39;s a problem: <code># =&gt; [#&lt;Nokogiri::XML::SyntaxError: 1:69: FATAL: EntityRef: expecting &#39;;&#39;&gt;]</code>, in other words it thought the <code>&amp;p2</code> was an entity and couldn&#39;t do anything with it. The programmer has to take advantage of this and react accordingly. If <code>errors</code> returns an empty list it&#39;s OK."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 3, "last_activity_date": 1553549290, "creation_date": 1553549290, "answer_id": 55346661, "question_id": 55346583, "link": "https://stackoverflow.com/questions/55346583/url-is-altered-after-parsing-with-nokogiri/55346661#55346661", "title": "URL is altered after parsing with Nokogiri", "body": "<p>This is because in an XML/HTML context <code>&amp;</code> has special meaning. You <em>must</em> escape it:</p>\n\n<pre><code>&lt;?xml version='1.0' encoding='utf-8'?&gt;&lt;url&gt;https://somehost?p1=v1&amp;amp;p2=v2&lt;/url&gt;\n</code></pre>\n\n<p>It's parsing that as an entity <code>&amp;p2</code>, which it isn't a valid entity, so it gets deleted, leaving you with <code>p1=v1=p2</code></p>\n"}], "owner": {"reputation": 196, "user_id": 866173, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6c374f92c0a834c1cb9bcd94b3bc67ba?s=128&d=identicon&r=PG", "display_name": "henrik242", "link": "https://stackoverflow.com/users/866173/henrik242"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 55346661, "answer_count": 1, "score": 0, "last_activity_date": 1553558674, "creation_date": 1553548897, "last_edit_date": 1553558674, "question_id": 55346583, "link": "https://stackoverflow.com/questions/55346583/url-is-altered-after-parsing-with-nokogiri", "title": "URL is altered after parsing with Nokogiri", "body": "<pre><code>str = \"&lt;?xml version='1.0' encoding='utf-8'?&gt;&lt;url&gt;https://somehost?p1=v1&amp;p2=v2&lt;/url&gt;\"\n=&gt; \"&lt;?xml version='1.0' encoding='utf-8'?&gt;&lt;url&gt;https://somehost?p1=v1&amp;p2=v2&lt;/url&gt;\"\n\nx = Nokogiri::XML(str)\n=&gt; #&lt;Nokogiri::XML::Document:0x3fcaa893b900 name=\"document\" children=[#&lt;Nokogiri::XML::Element:0x3fcaa893b644 name=\"url\" children=[#&lt;Nokogiri::XML::Text:0x3fcaa893b48c \"https://somehost?p1=v1=v2\"&gt;]&gt;]&gt;\n</code></pre>\n\n<p>Why is '&amp;p2' removed? after parsing?</p>\n"}, {"tags": ["ruby", "struct"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1553549290, "post_id": 55346477, "comment_id": 97418084, "body": "Executive Summary: <code>os.send(&quot;#{a[0]}=&quot;, &#39;smith&#39;)</code> or <code>os.public_send(&quot;#{a[0]}=&quot;, &#39;smith&#39;)</code>."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 1, "creation_date": 1553549436, "post_id": 55346477, "comment_id": 97418127, "body": "Also <code>os[a[0]] = &#39;smith&#39;</code>"}], "owner": {"reputation": 57, "user_id": 2027714, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IJF2f.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/2027714/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "closed_date": 1553549237, "answer_count": 0, "score": 0, "last_activity_date": 1553548364, "creation_date": 1553548364, "question_id": 55346477, "link": "https://stackoverflow.com/questions/55346477/ostruct-unable-to-assign-new-field", "closed_reason": "Duplicate", "title": "ostruct - unable to assign new field", "body": "<p>I need to automatically populate field names in Open Structure.</p>\n\n<p>Field names are in an Array.</p>\n\n<p>How can I accomplish this?</p>\n\n<pre><code>require 'ostruct'\na = []\na[0] = 'name'\n\nos = OpenStruct.new\n# os.a[0] = 'smith'    # this fails \nos.name = 'smith'      # works fine\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 6826659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/885b8339f3a4bad77354629489cd704f?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard", "link": "https://stackoverflow.com/users/6826659/gerard"}, "edited": false, "score": 0, "creation_date": 1553556359, "post_id": 55346203, "comment_id": 97420287, "body": "I tried your answer and it seems to only show the code thats in the ELSE section regardless of whether of not the user has a book. Any ideas? Thanks for your help."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 29, "user_id": 6826659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/885b8339f3a4bad77354629489cd704f?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard", "link": "https://stackoverflow.com/users/6826659/gerard"}, "edited": false, "score": 0, "creation_date": 1580343088, "post_id": 55346203, "comment_id": 106070358, "body": "I can&#39;t say why unless you&#39;re sure <code>.book?</code> returns true, which defies the logic here. If you use <code>pry</code> or <code>bye-bug</code> or any such debugging tool, try to add one right before this line of code and make sure your expectations are correct."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 0, "last_activity_date": 1553548348, "last_edit_date": 1553548348, "creation_date": 1553546988, "answer_id": 55346203, "question_id": 55345916, "link": "https://stackoverflow.com/questions/55345916/can-i-query-against-the-devise-current-user-helper-in-my-application-menu/55346203#55346203", "title": "Can I query against the DEVISE current_user helper in my application menu?", "body": "<p>Yes, you should be able to access <code>current_user</code> from any controller.  But always make sure you handle if <code>current_user</code> returns <code>nil</code>.\nYou can use a try or <a href=\"https://stackoverflow.com/questions/34583168/safe-navigation-operator-for-nil\">safe navigation</a>.</p>\n\n<pre><code>&lt;% if current_user.try(:book?) %&gt;\n&lt;% else %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>&lt;% if current_user&amp;.book? %&gt;\n&lt;% else %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 6826659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/885b8339f3a4bad77354629489cd704f?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard", "link": "https://stackoverflow.com/users/6826659/gerard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 55346203, "answer_count": 1, "score": 1, "last_activity_date": 1553548348, "creation_date": 1553545710, "last_edit_date": 1553547259, "question_id": 55345916, "link": "https://stackoverflow.com/questions/55345916/can-i-query-against-the-devise-current-user-helper-in-my-application-menu", "title": "Can I query against the DEVISE current_user helper in my application menu?", "body": "<p>The problem is, In the menu of my app I want to check if the current user has a book. If they do I will show a link to the edit book path, if not, I will show a link to the create book path. </p>\n\n<pre><code>&lt;% if current_user.book? %&gt;\n&lt;% else %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 3, "creation_date": 1553536732, "post_id": 55343777, "comment_id": 97412520, "body": "if you check <a href=\"https://apidock.com/ruby/String/to_i\" rel=\"nofollow noreferrer\">apidock.com/ruby/String/to_i</a>, you&#39;ll see that <i>Ruby</i> will convert it until the first non number character is found in your case."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 3, "creation_date": 1553536842, "post_id": 55343777, "comment_id": 97412577, "body": "You would need to remove the commas or substitute them with underscores. e.g. <code>&#39;980,323,344.00&#39;.tr(&#39;,&#39;,&#39;&#39;).to_i #=&gt; 980323344</code> or <code>&#39;980,323,344.00&#39;.tr(&#39;,&#39;,&#39;_&#39;).to_i #=&gt; 980323344</code>"}, {"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1553536880, "post_id": 55343777, "comment_id": 97412591, "body": "are you getting that &quot;number&quot; from a source you don&#39;t control ?, if so, you could try <code>&quot;980,323,344.00&quot;.gsub(&quot;,&quot;, &quot;_&quot;).to_i</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1553538631, "post_id": 55343777, "comment_id": 97413423, "body": "<code>&quot;12monkeys&quot;.to_i</code> is also <code>12</code>, just as <code>&quot;se7en&quot;.to_i</code> is <code>0</code>."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1553545414, "post_id": 55343777, "comment_id": 97416568, "body": "It would help if you could explain what, <i>precisely</i>, is unclear to you about the documentation of <code>String#to_i</code>. That way, the Ruby developers can improve the documentation so that future developers don&#39;t stumble over the same rocks you did."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1553552418, "post_id": 55343777, "comment_id": 97419221, "body": "@engineersmnky, weird but true: <code>&#39;980,323,344.00&#39;.tr(&#39;,&#39;,&#39;_&#39;).to_i</code>."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1553577198, "post_id": 55343777, "comment_id": 97424570, "body": "<code>delete(&#39;,&#39;)</code> will now remove &#39;.&#39; so prefer <code>to_f</code> if you do not want loss. Perhaps if you intend integer then it&#39;s ok."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1553538611, "post_id": 55344193, "comment_id": 97413416, "body": "Safer to just get rid of them."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1553538934, "post_id": 55344193, "comment_id": 97413552, "body": "@tadman but far less readable if you need the <code>String</code> for some reason"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1553541768, "post_id": 55344193, "comment_id": 97414845, "body": "@engineersmnky I mean get rid of them when processing as done here in the second example as opposed to remapping them as in the first."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1553546930, "post_id": 55344193, "comment_id": 97417167, "body": "That&#39;s even better. Nice."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1553560571, "post_id": 55344193, "comment_id": 97421233, "body": "The OP may be given <code>&quot;980,323,344.00&quot;</code> or may express it that way for reasons unrelated to the question, so I don&#39;t think you should suggest that underscores be used instead of commas. The point is that <code>to_i</code> can be used if the string contains any number and placement of underscores, provided there are not two underscores in a row and the string does not begin with one. Similar rules apply to integers and floats. This is done merely to make literals more readable. However,..."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1553560837, "post_id": 55344193, "comment_id": 97421298, "body": "...all this is secondary to the question of how an integer or a  float is to be extracted from a string containing commas that is the representation of a number. You&#39;ve answered that, but only in part 2 of your answer. I suggest your make that front and centre and then explain--almost as an aside-- why underscores might be used in literals."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 3, "last_activity_date": 1553561429, "last_edit_date": 1553561429, "creation_date": 1553537827, "answer_id": 55344193, "question_id": 55343777, "link": "https://stackoverflow.com/questions/55343777/ruby-to-i-does-not-return-the-complete-integer-as-expected/55344193#55344193", "title": "Ruby .to_i does not return the complete integer as expected", "body": "<p>In ruby calling <code>to_i</code> on a string will truncate from the beginning of  a string where possible.</p>\n\n<pre><code>number_string = '980,323,344.00'\nnumber_string.delete(',').to_i\n#=&gt; 980323344\n\n\"123abc\".to_i\n#=&gt; 123\n</code></pre>\n\n<p>If you want to add underscores to make longer number more readable, those can be used where the conventional commas would be in written numbers.</p>\n\n<pre><code>\"980_323_344.00\".to_i\n#=&gt; 980323344\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1564, "user_id": 755421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71312ffca1775d45c43afabf53358838?s=128&d=identicon&r=PG", "display_name": "bitsapien", "link": "https://stackoverflow.com/users/755421/bitsapien"}, "is_accepted": true, "score": 6, "last_activity_date": 1553539331, "last_edit_date": 1553539331, "creation_date": 1553538987, "answer_id": 55344427, "question_id": 55343777, "link": "https://stackoverflow.com/questions/55343777/ruby-to-i-does-not-return-the-complete-integer-as-expected/55344427#55344427", "title": "Ruby .to_i does not return the complete integer as expected", "body": "<p>You can achieve it by doing this :</p>\n\n<pre><code>\"980,323,344.00\".delete(',').to_i\n</code></pre>\n\n<p>The reason your method call to <code>to_i</code> does not return as expected is explained <a href=\"https://apidock.com/ruby/String/to_i\" rel=\"noreferrer\">here</a>, and to quote, the method :</p>\n\n<blockquote>\n  <p>Returns the result of interpreting leading characters in str as an integer base base (between 2 and 36). <strong>Extraneous characters</strong> past the end of a valid number are ignored.</p>\n</blockquote>\n\n<p>Extraneous characters in your case would be the comma character that ends at <code>980</code>, the reason why you see <code>980</code> being returned</p>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 2, "last_activity_date": 1553592894, "last_edit_date": 1553592894, "creation_date": 1553592495, "answer_id": 55353692, "question_id": 55343777, "link": "https://stackoverflow.com/questions/55343777/ruby-to-i-does-not-return-the-complete-integer-as-expected/55353692#55353692", "title": "Ruby .to_i does not return the complete integer as expected", "body": "<p>The documentation for <a href=\"http://ruby-doc.org/core-2.6.2/String.html#method-i-to_i\" rel=\"nofollow noreferrer\"><code>to_i</code></a> might be a bit misleading:</p>\n\n<blockquote>\n  <p>Returns the result of interpreting leading characters in <em>str</em> as an integer base <em>base</em> (between 2 and 36)</p>\n</blockquote>\n\n<p><em>\"interpreting\"</em> doesn't mean that it tries to parse various number formats (like <code>Date.parse</code> does for date formats). It means that it looks for what's a valid <a href=\"http://ruby-doc.org/core-2.6.2/doc/syntax/literals_rdoc.html#label-Numbers\" rel=\"nofollow noreferrer\">integer literal</a> in Ruby (in the given base). For example:</p>\n\n<pre><code> 1234.            #=&gt; 1234\n'1234'.to_i       #=&gt; 1234\n\n 1_234.           #=&gt; 1234\n'1_234'.to_i.     #=&gt; 1234\n\n 0d1234           #=&gt; 1234\n'0d1234'.to_i     #=&gt; 1234\n\n 0x04D2           #=&gt; 1234\n'0x04D2'.to_i(16) #=&gt; 1234\n</code></pre>\n\n<p>Your input as a whole however is not a valid integer literal: (Ruby doesn't like the <code>,</code>)</p>\n\n<pre><code>980,323,344.00\n# SyntaxError (syntax error, unexpected ',', expecting end-of-input)\n# 980,323,344.00\n#    ^\n</code></pre>\n\n<p>But it <em>starts</em> with a valid integer literal. And that's where the the seconds sentence comes into play:</p>\n\n<blockquote>\n  <p>Extraneous characters past the end of a valid number are ignored.</p>\n</blockquote>\n\n<p>So the result is <code>980</code> \u2013 the leading characters which form a valid integer converted to an integer.</p>\n\n<hr>\n\n<p>If your strings always have that format, you can just <a href=\"http://ruby-doc.org/core-2.6.2/String.html#method-i-delete\" rel=\"nofollow noreferrer\"><code>delete</code></a> the offending commas and run the result through <code>to_i</code> which will ignore the trailing <code>.00</code>:</p>\n\n<pre><code>'980,323,344.00'.delete(',')      #=&gt; \"980323344.00\"\n'980,323,344.00'.delete(',').to_i #=&gt; 980323344\n</code></pre>\n\n<p>Otherwise you could use a regular expression to check its format before converting it:</p>\n\n<pre><code>input = '980,323,344.00'\nnumber = case input\n         when /\\A\\d{1,3}(,\\d{3})*\\.00\\z/\n           input.delete(',').to_i\n         when /other format/\n           # other conversion\n         end\n</code></pre>\n\n<p>And if you are dealing with monetary values, you should consider using the <a href=\"https://github.com/RubyMoney/money\" rel=\"nofollow noreferrer\">money</a> gem and its <a href=\"https://github.com/RubyMoney/monetize/\" rel=\"nofollow noreferrer\">monetize</a> addition for parsing formatted values:</p>\n\n<pre><code> amount = Monetize.parse('980,323,344.00')\n #=&gt; #&lt;Money fractional:98032334400 currency:USD&gt;\n\n amount.format\n #=&gt; \"$980.323.344,00\"\n</code></pre>\n\n<p>Note that <code>format</code> requires <a href=\"https://github.com/ruby-i18n/i18n\" rel=\"nofollow noreferrer\">i18n</a> so the above example might require some setup.</p>\n"}], "owner": {"reputation": 417, "user_id": 11239542, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-swcBRphISEA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4oXDqt6_Tq4V1bWzkoXDcctHVpg/mo/photo.jpg?sz=128", "display_name": "Lefty", "link": "https://stackoverflow.com/users/11239542/lefty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "accepted_answer_id": 55344427, "answer_count": 3, "score": 0, "last_activity_date": 1553592894, "creation_date": 1553536143, "last_edit_date": 1553577101, "question_id": 55343777, "link": "https://stackoverflow.com/questions/55343777/ruby-to-i-does-not-return-the-complete-integer-as-expected", "title": "Ruby .to_i does not return the complete integer as expected", "body": "<p>My ruby command is,</p>\n\n<pre><code>\"980,323,344.00\".to_i\n</code></pre>\n\n<p>Why does it return 980 instead of 980323344?</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 0, "last_activity_date": 1553547434, "creation_date": 1553547434, "answer_id": 55346305, "question_id": 55343694, "link": "https://stackoverflow.com/questions/55343694/redirect-to-nested-routes-with-different-controller/55346305#55346305", "title": "Redirect to nested routes with different controller", "body": "<p>You can always use the routing helpers:</p>\n\n<pre><code>redirect_to(other_thing_path(@financier, product, section))\n</code></pre>\n\n<p>Where those represent elements of the other path as necessary.</p>\n"}], "owner": {"reputation": 1, "user_id": 5844162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74fb2f99f47bf13ea7701c42021b070e?s=128&d=identicon&r=PG&f=1", "display_name": "zepeda12", "link": "https://stackoverflow.com/users/5844162/zepeda12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553547434, "creation_date": 1553535855, "last_edit_date": 1553547392, "question_id": 55343694, "link": "https://stackoverflow.com/questions/55343694/redirect-to-nested-routes-with-different-controller", "title": "Redirect to nested routes with different controller", "body": "<p>I have the next nested route <code>redirect_to [:financier, product, section]</code> \nThis works if I have a controller with the name of the last variable but my question is how can I change the name of the last controller and call it in a similar way? for example, the model is called document and I want to change the controller name how catalog</p>\n"}, {"tags": ["ruby", "httparty"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11256190, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vRWhtx0TXVU/AAAAAAAAAAI/AAAAAAAAAAc/CDKdcFJObyU/photo.jpg?sz=128", "display_name": "Nick Chambers", "link": "https://stackoverflow.com/users/11256190/nick-chambers"}, "edited": false, "score": 0, "creation_date": 1553536319, "post_id": 55343629, "comment_id": 97412337, "body": "Thanks! I&#39;ll keep that in mind. I found a workaround using <code>OpenSSL</code> and <code>socket</code>, so I&#39;ll just use that in the meantime."}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 1, "last_activity_date": 1553535628, "creation_date": 1553535628, "answer_id": 55343629, "question_id": 55343305, "link": "https://stackoverflow.com/questions/55343305/unable-to-obtain-peer-certificate-using-httparty/55343629#55343629", "title": "Unable to obtain peer certificate using HTTParty", "body": "<p><code>0.16.4</code> does not have a <code>connection</code> <a href=\"https://github.com/jnunemaker/httparty/blob/v0.16.4/lib/httparty/fragment_with_response.rb\" rel=\"nofollow noreferrer\">Source</a> </p>\n\n<p>the \"example\" you are referring to corresponds with additional changes</p>\n\n<ul>\n<li><a href=\"https://github.com/jnunemaker/httparty/commit/24106eef272953f3190db9115dc5ac5f6aa1600e#diff-580cbdf9b30c3492eaffdfa72a97aa58\" rel=\"nofollow noreferrer\">https://github.com/jnunemaker/httparty/commit/24106eef272953f3190db9115dc5ac5f6aa1600e#diff-580cbdf9b30c3492eaffdfa72a97aa58</a></li>\n<li><a href=\"https://github.com/jnunemaker/httparty/commit/9b5f5012ac7bb401b376c9e62179f10099f709d8\" rel=\"nofollow noreferrer\">https://github.com/jnunemaker/httparty/commit/9b5f5012ac7bb401b376c9e62179f10099f709d8</a></li>\n</ul>\n\n<p>So it appears that you would need to install directly from github to have access to this feature or wait until the next version is released. </p>\n"}], "owner": {"reputation": 23, "user_id": 11256190, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vRWhtx0TXVU/AAAAAAAAAAI/AAAAAAAAAAc/CDKdcFJObyU/photo.jpg?sz=128", "display_name": "Nick Chambers", "link": "https://stackoverflow.com/users/11256190/nick-chambers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 55343629, "answer_count": 1, "score": 1, "last_activity_date": 1553536276, "creation_date": 1553534444, "last_edit_date": 1553536276, "question_id": 55343305, "link": "https://stackoverflow.com/questions/55343305/unable-to-obtain-peer-certificate-using-httparty", "title": "Unable to obtain peer certificate using HTTParty", "body": "<p>I am on a MacBook (macOS 10.14.3) with OpenSSL 1.1.1b (installed via Homebrew), ruby 2.6.0 (installed via rvm), and HTTParty 0.16.4 (installed via gem/bundler). According to <a href=\"https://github.com/jnunemaker/httparty/blob/master/examples/peer_cert.rb\" rel=\"nofollow noreferrer\">this example</a>, it should be possible to download a website's peer certificate. However, when I attempt this on my machine it fails:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require \"httparty\"\n\npeer_cert = nil\n\nHTTParty.get(\"https://www.example.com\") do |fragment|\n  peer_cert ||= fragment.connection.peer_cert\nend\n\np peer_cert\n</code></pre>\n\n<p>With the error</p>\n\n<pre><code>Traceback (most recent call last):\n    28: from tmp/test.rb:5:in `&lt;main&gt;'\n    27: from /Users/nicholas.chambers/.rvm/gems/ruby-2.6.0/gems/httparty-0.16.4/lib/httparty.rb:623:in `get'\n    26: from /Users/nicholas.chambers/.rvm/gems/ruby-2.6.0/gems/httparty-0.16.4/lib/httparty.rb:491:in `get'\n    25: from /Users/nicholas.chambers/.rvm/gems/ruby-2.6.0/gems/httparty-0.16.4/lib/httparty.rb:573:in `perform_request'\n    24: from /Users/nicholas.chambers/.rvm/gems/ruby-2.6.0/gems/httparty-0.16.4/lib/httparty/request.rb:146:in `perform'\n    23: from /Users/nicholas.chambers/.rvm/rubies/ruby-2.6.0/lib/ruby/2.6.0/net/http.rb:1470:in `request'\n    22: from /Users/nicholas.chambers/.rvm/rubies/ruby-2.6.0/lib/ruby/2.6.0/net/http.rb:920:in `start'\n    21: from /Users/nicholas.chambers/.rvm/rubies/ruby-2.6.0/lib/ruby/2.6.0/net/http.rb:1472:in `block in request'\n    20: from /Users/nicholas.chambers/.rvm/rubies/ruby-2.6.0/lib/ruby/2.6.0/net/http.rb:1479:in `request'\n    19: from /Users/nicholas.chambers/.rvm/rubies/ruby-2.6.0/lib/ruby/2.6.0/net/http.rb:1517:in `transport_request'\n    18: from /Users/nicholas.chambers/.rvm/rubies/ruby-2.6.0/lib/ruby/2.6.0/net/http/response.rb:165:in `reading_body'\n    17: from /Users/nicholas.chambers/.rvm/rubies/ruby-2.6.0/lib/ruby/2.6.0/net/http.rb:1518:in `block in transport_request'\n    16: from /Users/nicholas.chambers/.rvm/gems/ruby-2.6.0/gems/httparty-0.16.4/lib/httparty/request.rb:150:in `block in perform'\n    15: from /Users/nicholas.chambers/.rvm/rubies/ruby-2.6.0/lib/ruby/2.6.0/net/http/response.rb:204:in `read_body'\n    14: from /Users/nicholas.chambers/.rvm/rubies/ruby-2.6.0/lib/ruby/2.6.0/net/http/response.rb:283:in `read_body_0'\n    13: from /Users/nicholas.chambers/.rvm/rubies/ruby-2.6.0/lib/ruby/2.6.0/net/http/response.rb:264:in `inflater'\n    12: from /Users/nicholas.chambers/.rvm/rubies/ruby-2.6.0/lib/ruby/2.6.0/net/http/response.rb:293:in `block in read_body_0'\n    11: from /Users/nicholas.chambers/.rvm/rubies/ruby-2.6.0/lib/ruby/2.6.0/net/http/response.rb:405:in `read'\n    10: from /Users/nicholas.chambers/.rvm/rubies/ruby-2.6.0/lib/ruby/2.6.0/net/protocol.rb:163:in `read'\n     9: from /Users/nicholas.chambers/.rvm/rubies/ruby-2.6.0/lib/ruby/2.6.0/net/protocol.rb:488:in `&lt;&lt;'\n     8: from /Users/nicholas.chambers/.rvm/rubies/ruby-2.6.0/lib/ruby/2.6.0/net/protocol.rb:497:in `call_block'\n     7: from /Users/nicholas.chambers/.rvm/rubies/ruby-2.6.0/lib/ruby/2.6.0/net/http/response.rb:382:in `block in inflate_adapter'\n     6: from /Users/nicholas.chambers/.rvm/rubies/ruby-2.6.0/lib/ruby/2.6.0/net/http/response.rb:382:in `inflate'\n     5: from /Users/nicholas.chambers/.rvm/rubies/ruby-2.6.0/lib/ruby/2.6.0/net/http/response.rb:384:in `block (2 levels) in inflate_adapter'\n     4: from /Users/nicholas.chambers/.rvm/rubies/ruby-2.6.0/lib/ruby/2.6.0/net/protocol.rb:488:in `&lt;&lt;'\n     3: from /Users/nicholas.chambers/.rvm/rubies/ruby-2.6.0/lib/ruby/2.6.0/net/protocol.rb:497:in `call_block'\n     2: from /Users/nicholas.chambers/.rvm/gems/ruby-2.6.0/gems/httparty-0.16.4/lib/httparty/request.rb:152:in `block (2 levels) in perform'\n     1: from tmp/test.rb:6:in `block in &lt;main&gt;'\n/Users/nicholas.chambers/.rvm/rubies/ruby-2.6.0/lib/ruby/2.6.0/delegate.rb:87:in `method_missing': undefined method `connection' for #&lt;HTTParty::FragmentWithResponse:0x00007f9382035440&gt; (NoMethodError)\n</code></pre>\n\n<p>I've looked through open issues in the repository, and did some googling, but nothing came up. I'm currently at a loss. Any help would be appreciated, thank you!</p>\n\n<p>Update:\nAlthough I'd like to know why HTTParty doesn't work, <a href=\"https://stackoverflow.com/questions/34601260/using-ruby-openssl-to-download-and-read-certificates\">this workaround</a> does it.</p>\n"}, {"tags": ["ruby", "reactjs", "ruby-on-rails-3", "opalrb", "hyperstack"], "answers": [{"tags": [], "owner": {"reputation": 2584, "user_id": 859491, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6951e58d024aa7812271f8d52ff31646?s=128&d=identicon&r=PG", "display_name": "Mitch VanDuyn", "link": "https://stackoverflow.com/users/859491/mitch-vanduyn"}, "is_accepted": true, "score": 2, "last_activity_date": 1553541860, "creation_date": 1553541860, "answer_id": 55345083, "question_id": 55343219, "link": "https://stackoverflow.com/questions/55343219/hyperstack-and-materialui-drawer-toggling-state-is-causing-the-drawer-to-open-an/55345083#55345083", "title": "Hyperstack and MaterialUI Drawer Toggling State is causing the drawer to open and close repeatedly", "body": "<p>The reason its opening and closing rapidly is that you are passing the <em>value</em> of <code>toggle_drawer</code> from the <code>Header</code> component to the <code>Menu</code> component. Each time you call <code>toggle_drawer</code> it changes the state variable @drawer_open, and rerenders the component, and then lather-rinse-repeat.</p>\n\n<p>What you need to do is pass a <code>proc</code> to Menu, and then let  <code>Menu</code> call the proc in the <code>on_click</code> handler.</p>\n\n<p>So it would look like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Header &lt; HyperComponent\n ...\n render(DIV) do\n   ...\n   Menu(open_drawer: @drawer_open, toggle_drawer: method(:toggle_drawer))\n end\nend\n</code></pre>\n\n<p>and</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Menu &lt; HyperComponent\n  ...\n  param :toggle_drawer\n  ...\n      IconButton(className: 'drawerHeader') { ChevronLeftIcon() }\n      .on(:click) { @ToggleDrawer.call } # note you have to say .call\n  ...\nend\n</code></pre>\n\n<blockquote>\n  <p>By the way nice article <a href=\"https://www.viget.com/articles/convert-ruby-method-to-lambda/\" rel=\"nofollow noreferrer\">here</a> on how <code>method(:toggle_drawer)</code> works\n  and compares it the same behavior in Javascript.</p>\n</blockquote>\n\n<p>But wait! Hyperstack has some nice syntactic sugar to make this more readable.</p>\n\n<p>Instead of declaring <code>toggle_drawer</code> as a normal param, you should declare it with the <code>fires</code> method, indicating you are going to fire an event (or callback) to the calling component.  This not only will make you life a little easier, but will also announce to the reader your intentions.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Menu &lt; HyperComponent\n  ...\n  fires :toggle_drawer # toggle_drawer is a callback/event that we will fire!\n  ...\n      IconButton(className: 'drawerHeader') { ChevronLeftIcon() }\n      .on(:click) { toggle_drawer! } # fire the toggle_drawer event (note the !) \n  ...\nend\n</code></pre>\n\n<p>now <code>Header</code> can use the normal event handler syntax:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Header &lt; HyperComponent\n ...\n render(DIV) do\n   ...\n   Menu(open_drawer: @drawer_open)\n   .on(:toggle_drawer) { toggle_drawer }\n end\nend \n</code></pre>\n\n<p>BTW if I could give a little style advice:  Since the Menu can only close the drawer that is what I would call the event, and in the event handler I would just directly mutate the drawer state (and just lose the toggle_drawer method).</p>\n\n<p>This way reading the code is very clear what state you are transitioning to.</p>\n\n<p>The resulting code would look like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Header &lt; HyperComponent\n  before_mount do\n    @drawer_open = false  # fyi you don't need this, but its also not bad practice\n  end\n\n  render(DIV) do\n    AppBar(position: 'static', class: 'appBar') do\n      Toolbar do\n        IconButton(class: 'menuButton', color: 'inherit', aria_label: 'Menu') do\n          MenuIcon(class: 'icon')\n        end.on(:click) { mutate @drawer_open = true }\n        Typography(variant: 'h6', color: 'inherit', class: 'grow') { 'Admin Main' }\n        Button(color: 'inherit', class: 'float-right') { 'Login' } # unless App.history != '/admin'\n      end\n    end\n    Menu(open_drawer: @drawer_open)\n    .on(:close_drawer) { mutate @drawer_open = false }\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 2603142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70540b4baac9902d2a1e579ad6cb880?s=128&d=identicon&r=PG", "display_name": "mwhobrey", "link": "https://stackoverflow.com/users/2603142/mwhobrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 55345083, "answer_count": 1, "score": 1, "last_activity_date": 1553541860, "creation_date": 1553534148, "question_id": 55343219, "link": "https://stackoverflow.com/questions/55343219/hyperstack-and-materialui-drawer-toggling-state-is-causing-the-drawer-to-open-an", "title": "Hyperstack and MaterialUI Drawer Toggling State is causing the drawer to open and close repeatedly", "body": "<p>I am implementing a title bar and menu drawer using MaterialUI in a Hyperstack project. I have two components, a <code>Header</code> component, and a <code>Menu</code> component. The <code>Menu</code> component is the expandable <code>Drawer</code>. I am storing the state in the <code>Header</code> component and passing it and a handler to the <code>Menu</code> component to toggle the drawer state when the drawers close button is clicked. For some reason, the drawer is just toggling open and closed very rapidly and repeatedly.</p>\n\n<p>The drawer was opening fine before I implemented the close button. I have tried moving the state up to the main app component and passing it all the way down, but it produces the same result. I tried setting a class function on the <code>Header</code> component and calling it from within the <code>Menu</code> component instead of passing in an event handler.</p>\n\n<p>The <code>Header</code> component</p>\n\n<pre><code>class Header &lt; HyperComponent\n  before_mount do\n    @drawer_open = false\n  end\n\n  def toggle_drawer\n    mutate @drawer_open = !@drawer_open\n  end\n\n  render(DIV) do\n    AppBar(position: 'static', class: 'appBar') do\n      Toolbar do\n        IconButton(class: 'menuButton', color: 'inherit', aria_label: 'Menu') do\n          MenuIcon(class: 'icon')\n        end\n        .on(:click) do\n          toggle_drawer\n        end\n        Typography(variant: 'h6', color: 'inherit', class: 'grow') { 'Admin Main' }\n        Button(color: 'inherit', class: 'float-right') { 'Login' } # unless App.history != '/admin'\n      end\n    end\n    Menu(open_drawer: @drawer_open, toggle_drawer: toggle_drawer)\n  end\nend\n</code></pre>\n\n<p>The <code>Menu</code> component</p>\n\n<pre><code>class Menu &lt; HyperComponent\n  param :open_drawer\n  param :toggle_drawer\n\n  def menu_items\n    %w(Main Inventory Customers)\n  end\n\n  def is_open?\n    @OpenDrawer\n  end\n\n  render(DIV) do\n    Drawer(className: 'drawer, drawerPaper', variant: 'persistent', anchor: 'left', open: is_open?) do\n      IconButton(className: 'drawerHeader') { ChevronLeftIcon() }\n      .on(:click) { @ToggleDrawer }\n\n      List do\n        menu_items.each do |mi|\n          ListItem(button: true, key: mi) { ListItemText(primary: mi) }\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>I expected for the drawer to open on the open button click and close when the close button is clicked, but it is just opening and closing very rapidly.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1553531130, "post_id": 55341667, "comment_id": 97409528, "body": "the correct option is <code>only: :create</code> instead of <code>before: :create</code> for the <code>before_action</code> call on 2nd line of Appointments Controller"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 1, "creation_date": 1553531189, "post_id": 55341667, "comment_id": 97409565, "body": "BTW, this looks a lot like a <i>model</i> validation (= uniqueness in scope of user and date), which could be written like this: <code>validates :date, uniqueness: { scope: :user }</code> in the Appointment model."}, {"owner": {"reputation": 97, "user_id": 11167484, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AM-yop2gwj0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdu0X6rBdmTknbmKIgFY5W7nJDKOQ/mo/photo.jpg?sz=128", "display_name": "Jordans", "link": "https://stackoverflow.com/users/11167484/jordans"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1553532214, "post_id": 55341667, "comment_id": 97410200, "body": "Your second answer worked like a charm thanks for that, can you post as an answer so I can accept?"}], "answers": [{"tags": [], "owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "is_accepted": true, "score": 1, "last_activity_date": 1553535003, "creation_date": 1553535003, "answer_id": 55343461, "question_id": 55341667, "link": "https://stackoverflow.com/questions/55341667/custom-validation-not-executing-on-creation-of-record/55343461#55343461", "title": "Custom validation not executing on creation of record?", "body": "<p>This looks a lot like a model validation:</p>\n\n<pre><code>class Appointment\n  validates :date, uniqueness: { scope: :user }\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 11167484, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AM-yop2gwj0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdu0X6rBdmTknbmKIgFY5W7nJDKOQ/mo/photo.jpg?sz=128", "display_name": "Jordans", "link": "https://stackoverflow.com/users/11167484/jordans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 55343461, "answer_count": 1, "score": 1, "last_activity_date": 1553535003, "creation_date": 1553529069, "question_id": 55341667, "link": "https://stackoverflow.com/questions/55341667/custom-validation-not-executing-on-creation-of-record", "title": "Custom validation not executing on creation of record?", "body": "<p>I having an issue with my custom validation not validating a the date field on my form.My aim is to search the database for an existing date for the current user in appointment records.The flash notification appears when I go to the creation of the record however when i change the date to one that is already taken my validation does not pick this up. I must be setting it up wrong, any help would be greatly appreciated!</p>\n\n<pre><code>class AppointmentsController &lt; ApplicationController\n  before_action :set_appointment, only: [:show, :edit, :update, \n:destroy]\n  before_action :validate_schedule, :before =&gt; :create\n\n  private\n     def validate_schedule\n        if Appointment.where(date: params[:date], user: current_user).exists?\n            flash[:notice] = \"You already have a date in this time\"\n        else\n            flash[:notice] = \"No conflicts\"\n     end\n end\nend\n</code></pre>\n\n<p><strong>_form.html.erb</strong></p>\n\n<pre><code>&lt;%= simple_form_for(@appointment) do |f| %&gt;\n  &lt;%= f.error_notification %&gt;\n  &lt;%= f.error_notification message: f.object.errors[:base].to_sentence if f.object.errors[:base].present? %&gt;\n\n  &lt;!-- Show only patients to the current logged in users --&gt;\n  &lt;div class=\"form-inputs\"&gt;\n    &lt;%= f.input :notes %&gt;\n    &lt;%= f.input :date %&gt;\n    &lt;%= f.association :patient, label_method: :Full_Name, :collection =&gt; Patient.where(:user =&gt; current_user.id) %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"form-actions\"&gt;\n      &lt;div style=\"display: flex; float: left;\"&gt;\n          &lt;%= link_to 'Back', appointments_path, class: \"btn btn-warning btn-m\"%&gt;\n      &lt;/div&gt;\n      &lt;div style=\"display: flex; float: right;\"&gt;\n          &lt;%= f.button :submit , class: \"btn btn-success btn-m\"%&gt;\n      &lt;/div&gt;\n  &lt;/div&gt;\n\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1553530443, "post_id": 55339716, "comment_id": 97409111, "body": "If you indent your code properly, issues like this are much easier to understand."}, {"owner": {"reputation": 689, "user_id": 10280525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar3KN.jpg?s=128&g=1", "display_name": "Nifriz", "link": "https://stackoverflow.com/users/10280525/nifriz"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1553531889, "post_id": 55339716, "comment_id": 97410030, "body": "@TomLord I&#39;m agree!"}, {"owner": {"reputation": 1, "user_id": 11255339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44326bfe920feac317e7965f22b17194?s=128&d=identicon&r=PG&f=1", "display_name": "dslisanoob", "link": "https://stackoverflow.com/users/11255339/dslisanoob"}, "edited": false, "score": 0, "creation_date": 1553701483, "post_id": 55339716, "comment_id": 97484661, "body": "I agree too, apologies and thank you very much!"}], "answers": [{"tags": [], "owner": {"reputation": 689, "user_id": 10280525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar3KN.jpg?s=128&g=1", "display_name": "Nifriz", "link": "https://stackoverflow.com/users/10280525/nifriz"}, "is_accepted": true, "score": 3, "last_activity_date": 1553523638, "last_edit_date": 1553523638, "creation_date": 1553523204, "answer_id": 55339810, "question_id": 55339716, "link": "https://stackoverflow.com/questions/55339716/nomethod-undefined-method-method-name-error-even-if-the-method-has-been-defi/55339810#55339810", "title": "NoMethod - Undefined method &lt;method name&gt; error even if the method has been defined", "body": "<p>You have to close your <code>valid_move?</code> method before declare a new method (<code>move</code>)...</p>\n\n<pre><code>def valid_move?(board, pos)\n  if pos.between?(0,8)\n    if board[pos] == \" \"\n      return true\n    else\n      return false\n    end\n  else\n    return false\n  end\nend\n\ndef move(board, pos, type)\n  board[pos] = \"#{type}\"  \nend\n</code></pre>\n\n<p>If you declare <code>move</code> method inside another method, is not visible in the main program.</p>\n"}, {"tags": [], "owner": {"reputation": 579, "user_id": 11206879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bS2D6.png?s=128&g=1", "display_name": "Pan Ke", "link": "https://stackoverflow.com/users/11206879/pan-ke"}, "is_accepted": false, "score": 0, "last_activity_date": 1553523470, "creation_date": 1553523470, "answer_id": 55339897, "question_id": 55339716, "link": "https://stackoverflow.com/questions/55339716/nomethod-undefined-method-method-name-error-even-if-the-method-has-been-defi/55339897#55339897", "title": "NoMethod - Undefined method &lt;method name&gt; error even if the method has been defined", "body": "<p>your <code>move</code> defined in <code>valide_move?</code> maybe try a better code editor prettifying. :)</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def valid_move?(board, pos)\n  if pos.between?(0,8)\n    if board[pos] == \" \"\n      return true\n    else\n      return false\n    end\n  else\n    return false\n  end\n\n  def move()\n        board[pos] = \"#{type}\"\n        puts \"a\" \n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11255339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44326bfe920feac317e7965f22b17194?s=128&d=identicon&r=PG&f=1", "display_name": "dslisanoob", "link": "https://stackoverflow.com/users/11255339/dslisanoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 55339810, "answer_count": 2, "score": -4, "last_activity_date": 1553523638, "creation_date": 1553522918, "question_id": 55339716, "link": "https://stackoverflow.com/questions/55339716/nomethod-undefined-method-method-name-error-even-if-the-method-has-been-defi", "title": "NoMethod - Undefined method &lt;method name&gt; error even if the method has been defined", "body": "<p>I'm getting a no method - method undefined error while I am defining a method AFTER a particular method ends. The method defined before this one has an if..else statement block which might be creating an issue here</p>\n\n<p>I've tried defining the mentioned method before the \"problem making method\" and in that case, my method works properly. But if any method is defined after that particular method, I get the same error message.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def display_board(board)\nputs \" #{board[0]} | #{board[1]} | #{board[2]} \"\nputs \"-----------\"\nputs \" #{board[3]} | #{board[4]} | #{board[5]} \"\nputs \"-----------\"\nputs \" #{board[6]} | #{board[7]} | #{board[8]} \"\nend\ndef input_to_index(pos)\n  pos = pos.to_i - 1\nend\n\ndef valid_move?(board, pos)\n  if pos.between?(0,8)\n    if board[pos] == \" \"\n      return true\n    else\n      return false\n  end\n  else\n    return false\nend\ndef move(board, pos, type)\n  board[pos] = \"#{type}\"  \nend\nend\n</code></pre>\n\n<p>It should ideally pass all the test cases. But I'm getting this particular error:</p>\n\n<pre><code>1) ./lib/turn.rb #move allows \"X\" player in the bottom right and \"O\" in the top left\n     Failure/Error: move(board, 0, \"O\")\n     NoMethodError:\n       undefined method `move' for #&lt;RSpec::ExampleGroups::LibTurnRb::Move:0x0000000001db90d8&gt;\n     # ./spec/turn_spec.rb:70:in `block (3 levels) in &lt;top (required)&gt;'\n</code></pre>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 417, "user_id": 11239542, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-swcBRphISEA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4oXDqt6_Tq4V1bWzkoXDcctHVpg/mo/photo.jpg?sz=128", "display_name": "Lefty", "link": "https://stackoverflow.com/users/11239542/lefty"}, "edited": false, "score": 0, "creation_date": 1553523589, "post_id": 55339604, "comment_id": 97404840, "body": "Please share why a down vote, I am new."}, {"owner": {"reputation": 443227, "user_id": 341994, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fbb4d027695dfdf76bf448b15d7e306a?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/341994/matt"}, "edited": false, "score": 1, "creation_date": 1553523643, "post_id": 55339604, "comment_id": 97404880, "body": "Smart, interesting, better, happy \u2014 all emotive and opinion based terms. Do you have a <i>programming</i> issue? Your code works, it isn\u2019t inefficient, lots of people would write it that way, it is clear, so what\u2019s the trouble?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1553531876, "post_id": 55339604, "comment_id": 97410022, "body": "I can understand why you are not happy with your code: it contains three errors! :-). You need to add <code>do</code> before <code>|k|</code> in <code>response.each_index |k|</code> and in if <code>k=&quot;Y&quot;</code> <code>k</code> should be <code>response[k]</code> and <code>=</code> should be <code>==</code>. Aside from that your approach is fine. More Ruby-like would be to write <code>response.each_index.with_object([]) do |k,result|</code>, which would allow you to remove <code>result = []</code> and <code>result</code> at the end. Lastly, some (me included) would write <code>result &lt;&lt; mapping[k] if result[k] == &#39;Y&#39;</code>, reducing three lines to one."}], "answers": [{"comments": [{"owner": {"reputation": 417, "user_id": 11239542, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-swcBRphISEA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4oXDqt6_Tq4V1bWzkoXDcctHVpg/mo/photo.jpg?sz=128", "display_name": "Lefty", "link": "https://stackoverflow.com/users/11239542/lefty"}, "edited": false, "score": 0, "creation_date": 1553523847, "post_id": 55339950, "comment_id": 97405013, "body": "which do you recommend? and why?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 417, "user_id": 11239542, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-swcBRphISEA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4oXDqt6_Tq4V1bWzkoXDcctHVpg/mo/photo.jpg?sz=128", "display_name": "Lefty", "link": "https://stackoverflow.com/users/11239542/lefty"}, "edited": false, "score": 0, "creation_date": 1553524149, "post_id": 55339950, "comment_id": 97405205, "body": "@Lefty I recommend whichever feels more natural to you even if it isn&#39;t one of the above solutions. In this case the data set is inconsequentially small and thus performance factors will have no impact."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1553529846, "post_id": 55339950, "comment_id": 97408756, "body": "...or (#1) <code>...values_at(*response.each_index.select {|i| response[i] == &quot;Y&quot;})</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1553530091, "post_id": 55339950, "comment_id": 97408897, "body": "Re #2 I believe you need to tack on <code>.map(&amp;:last)</code>. <code>each_with_index</code> may be a better choice to avoid <code>compact</code> (a really ugly method, imo) and <code>.map(&amp;:last)</code>."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1553530291, "post_id": 55339950, "comment_id": 97409030, "body": "@CarySwoveland no need for <code>map(&amp;:last)</code> as I am only mapping the first element. however I think <code>mapping.select.with_index {|_,i| response[i] == &quot;Y&quot;}</code> is a far better solution as it result in the creation of only 1 array"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1553530658, "post_id": 55339950, "comment_id": 97409224, "body": "Ah, yes. I agree that <code>select.with_index</code> is better, so why not give that in your answer?"}, {"owner": {"reputation": 417, "user_id": 11239542, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-swcBRphISEA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4oXDqt6_Tq4V1bWzkoXDcctHVpg/mo/photo.jpg?sz=128", "display_name": "Lefty", "link": "https://stackoverflow.com/users/11239542/lefty"}, "edited": false, "score": 0, "creation_date": 1553535538, "post_id": 55339950, "comment_id": 97411982, "body": "I like mapping.select.with_index {|_,i| response[i] == &quot;Y&quot;}, it seems clean and understandable, this is what I was thinking existed, just did not know how to do."}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 4, "last_activity_date": 1553537554, "last_edit_date": 1553537554, "creation_date": 1553523657, "answer_id": 55339950, "question_id": 55339604, "link": "https://stackoverflow.com/questions/55339604/need-a-values-at-if-method-to-map-values-in-ruby/55339950#55339950", "title": "Need a `values_at_if ` method to map values in ruby", "body": "<p><strong>Update</strong> </p>\n\n<p>The simplest solution I can come up with is: </p>\n\n<pre><code>mapping.select.with_index {|_,i| response[i] == \"Y\"}\n#=&gt;[\"C\", \"D\", \"E\"]\n</code></pre>\n\n<p>This will <code>select</code> all the elements in <code>mapping</code> where the corresponding index in <code>response</code> equals <code>\"Y\"</code> </p>\n\n<p><strong>TL;DR Other options include:</strong></p>\n\n<pre><code>mapping.values_at(*response.each_with_index.select {|v,_| v == \"Y\"}.map(&amp;:last))\n\n\nmapping.zip(response).map {|k,v| k if v == \"Y\"}.compact\n</code></pre>\n\n<p>The first uses each with index which will be </p>\n\n<pre><code>[[\"N\",0],[\"N\",1],[\"Y\",2],[\"Y\",3],[\"Y\",4]]\n</code></pre>\n\n<p>then we select the groups where the first element is \"Y\" and map the indexes to pass to <code>values_at</code></p>\n\n<p>The second version zips the mapping and the response together creating. </p>\n\n<pre><code>[[\"A\", \"N\"], [\"B\", \"N\"], [\"C\", \"Y\"], [\"D\", \"Y\"], [\"E\", \"Y\"]]\n</code></pre>\n\n<p>Then map the first element only when the second element is \"Y\". the compact removes the <code>nil</code> values from the mapping.</p>\n\n<p>There are a lot of other ways to accomplish this task if you have a look through the <code>Enumerable</code> module</p>\n"}, {"tags": [], "owner": {"reputation": 2056, "user_id": 1838300, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/852556ae4382295d360e311debc5038a?s=128&d=identicon&r=PG", "display_name": "Sajad Rastegar", "link": "https://stackoverflow.com/users/1838300/sajad-rastegar"}, "is_accepted": false, "score": 1, "last_activity_date": 1553524696, "last_edit_date": 1553524696, "creation_date": 1553524278, "answer_id": 55340152, "question_id": 55339604, "link": "https://stackoverflow.com/questions/55339604/need-a-values-at-if-method-to-map-values-in-ruby/55340152#55340152", "title": "Need a `values_at_if ` method to map values in ruby", "body": "<pre><code>response.each_with_object([]).with_index do |(v, arr), i|\n  arr &lt;&lt; mapping[i] if v == 'Y' \nend\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>mapping.each_with_object([]).with_index do |(v, arr), i|\n  arr &lt;&lt; v if response[i] == 'Y' \nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 417, "user_id": 11239542, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-swcBRphISEA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4oXDqt6_Tq4V1bWzkoXDcctHVpg/mo/photo.jpg?sz=128", "display_name": "Lefty", "link": "https://stackoverflow.com/users/11239542/lefty"}, "edited": false, "score": 0, "creation_date": 1553535379, "post_id": 55340317, "comment_id": 97411903, "body": "Is it more efficient usage of memory or speed?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 417, "user_id": 11239542, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-swcBRphISEA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4oXDqt6_Tq4V1bWzkoXDcctHVpg/mo/photo.jpg?sz=128", "display_name": "Lefty", "link": "https://stackoverflow.com/users/11239542/lefty"}, "edited": false, "score": 0, "creation_date": 1553550774, "post_id": 55340317, "comment_id": 97418643, "body": "@Lefty Use <a href=\"https://ruby-doc.org/stdlib-2.5.0/libdoc/benchmark/rdoc/Benchmark.html\" rel=\"nofollow noreferrer\">Benchmark</a> to gain some insight. If you&#39;re really concerned about speed, avoid using strings here for the masking and instead have an array of the form <code>[false, false, true, true, true]</code>."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 417, "user_id": 11239542, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-swcBRphISEA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4oXDqt6_Tq4V1bWzkoXDcctHVpg/mo/photo.jpg?sz=128", "display_name": "Lefty", "link": "https://stackoverflow.com/users/11239542/lefty"}, "edited": false, "score": 0, "creation_date": 1553576980, "post_id": 55340317, "comment_id": 97424519, "body": "@Lefty For small arrays with only a couple of hundreds of elements, I would not care too much about speed or memory consumption. In such contexts, readability and being easy to understand is much more important. How big are your <code>mapping</code> and <code>response</code> arrays? Do you have the option to control them or do you get them from an external source?"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 3, "last_activity_date": 1553524800, "creation_date": 1553524800, "answer_id": 55340317, "question_id": 55339604, "link": "https://stackoverflow.com/questions/55339604/need-a-values-at-if-method-to-map-values-in-ruby/55340317#55340317", "title": "Need a `values_at_if ` method to map values in ruby", "body": "<p>I would go with</p>\n\n<pre><code>mapping.zip(response).select { |_, r| r == 'Y' }.map(&amp;:first)\n#=&gt; [\"C\", \"D\", \"E\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1553578225, "post_id": 55340971, "comment_id": 97424801, "body": "you could have used <code>to_enum</code> rather than <code>each</code>, that would be more expressive."}], "tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 3, "last_activity_date": 1553532474, "last_edit_date": 1553532474, "creation_date": 1553526851, "answer_id": 55340971, "question_id": 55339604, "link": "https://stackoverflow.com/questions/55339604/need-a-values-at-if-method-to-map-values-in-ruby/55340971#55340971", "title": "Need a `values_at_if ` method to map values in ruby", "body": "<p>Convert <code>response</code> to an Enumerator; <code>each</code> without a block does that. Then use it in the select block. If the block returns <code>true</code> then the item is selected:</p>\n\n<pre><code>response = [\"N\",\"N\",\"Y\",\"Y\",\"Y\"]\nmapping  = [\"A\",\"B\",\"C\",\"D\",\"E\"]\n\nenum_resp = response.each\nmapping.select{ enum_resp.next == \"Y\" } # =&gt;[\"C\", \"D\", \"E\"]\n</code></pre>\n\n<p>Note it would save memory if <code>response</code> would consist of <code>false</code> and <code>true</code>s, which also would make the comparison in the select block unnecessary.</p>\n"}], "owner": {"reputation": 417, "user_id": 11239542, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-swcBRphISEA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd4oXDqt6_Tq4V1bWzkoXDcctHVpg/mo/photo.jpg?sz=128", "display_name": "Lefty", "link": "https://stackoverflow.com/users/11239542/lefty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1553537554, "creation_date": 1553522589, "last_edit_date": 1553534795, "question_id": 55339604, "link": "https://stackoverflow.com/questions/55339604/need-a-values-at-if-method-to-map-values-in-ruby", "title": "Need a `values_at_if ` method to map values in ruby", "body": "<p>I have two arrays of the same size</p>\n\n<pre><code>response = [\"N\",\"N\",\"Y\",\"Y\",\"Y\"]\nmapping = [\"A\",\"B\",\"C\",\"D\",\"E\"]\n</code></pre>\n\n<p>I need to select the elements in <code>mapping</code> whose corresponding value in <code>response</code>, i.e., the element with the same index, is <code>\"Y\"</code>, as below</p>\n\n<pre><code>[\"C\",\"D\",\"E\"]\n</code></pre>\n\n<p>It reminds me of the <code>values_at</code> method. My solution is as follows</p>\n\n<pre><code>def values_at_if(response, mapping)\n    result=[]\n     response.each_index |k|\n       if k==\"Y\"\n         result &lt;&lt; mapping[k]\n       end\n     end\n   result\nend\n</code></pre>\n\n<p>I am not happy with it. Please let me know of a way to do it efficiently.</p>\n"}, {"tags": ["ruby", "email", "mail-gem"], "answers": [{"tags": [], "owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "is_accepted": false, "score": 0, "last_activity_date": 1553532916, "creation_date": 1553532916, "answer_id": 55342845, "question_id": 55339143, "link": "https://stackoverflow.com/questions/55339143/ruby-mail-gem-relay-access-from-localhost-to-postfix/55342845#55342845", "title": "Ruby Mail Gem Relay Access from Localhost to Postfix", "body": "<p>Adding the following fixed it, a <code>config</code> item for the gem:</p>\n\n<pre><code>mail.header['From'] = 'machine.mydomain.com'\n</code></pre>\n\n<p>Also making sure the <code>relay</code> information in <code>postfix</code> is set properly.  </p>\n"}], "owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553532916, "creation_date": 1553521182, "question_id": 55339143, "link": "https://stackoverflow.com/questions/55339143/ruby-mail-gem-relay-access-from-localhost-to-postfix", "title": "Ruby Mail Gem Relay Access from Localhost to Postfix", "body": "<p>I'm on a workstation that doesn't have a <code>FQDN</code>.  I'm developing in <code>Ruby</code> and using the <code>mail</code> gem.  I host my own mail server on the LAN.  I want to forward outgoing emails to this server, off to a gmail recipient (example).</p>\n\n<p>Due to the fact I'm on my workstation (<code>localhost</code>), it not being recognized as part of one of my LAN domains (I have a <code>static IP</code>), it isn't being recognized by <code>Postfix</code> (from my mail server log):</p>\n\n<pre><code>Mar 25 08:44:30 machine.mydomain1.com postfix/smtpd[9653]: sacl_check: mbr_user_name_to_uuid(mygmail@gmail.com) failed: No such file or directory\nMar 25 08:44:30 machine.mydomain1.com postfix/cleanup[9657]: sacl_check: mbr_user_name_to_uuid(mygmail@gmail.com) failed: No such file or directory\nMar 25 08:44:30 machine.mydomain1.com postfix/smtp[9658]: 92946D63CD4: to=&lt;mygmail@gmail.com&gt;, relay=127.0.0.1[127.0.0.1]:10024, delay=0.14, delays=0.01/0.01/0/0.11, dsn=2.0.0, status=sent (250 2.0.0 from MTA(smtp:[127.0.0.1]:10025): 250 2.0.0 Ok: queued as AE8ECD63CDA)\nMar 25 08:44:31 machine.mydomain1.com postfix/smtp[9661]: AE8ECD63CDA: to=&lt;mygmail@gmail.com&gt;, relay=gmail-smtp-in.l.google.com[173.194.195.26]:25, delay=0.52, delays=0/0.01/0.34/0.16, dsn=5.7.1, status=bounced (host gmail-smtp-in.l.google.com[173.194.195.26] said: 550-5.7.1 [206.248.184.17      11] Our system has detected that this message is 550-5.7.1 not RFC 5322 compliant: 550-5.7.1 'From' header is missing. 550-5.7.1 To reduce the amount of spam sent to Gmail, this message has been 550-5.7.1 blocked. Please visit 550-5.7.1  https://support.google.com/mail/?p=RfcMessageNonCompliant 550 5.7.1 and review RFC 5322 specifications for more information. a2si7453997iog.10 - gsmtp (in reply to end of DATA command))\nMar 25 08:56:42 machine.mydomain1.com postfix/smtpd[9764]: NOQUEUE: reject: RCPT from unknown[192.168.1.4]: 554 5.7.1 &lt;mygmail@gmail.com&gt;: Relay access denied; from=&lt;alpha@mydomain3.ca&gt; to=&lt;mygmail@gmail.com&gt; proto=ESMTP helo=&lt;mydomain3.ca&gt;\n</code></pre>\n\n<p>I can use the <code>mail</code> gem properly on another box that has a <code>FQDN</code> just fine.  I just can't seem to get it to work on my workstation.  As it states in the mail server log:</p>\n\n<pre><code>'From' header is missing. 550-5.7.1 To reduce the amount of spam sent to Gmail, this message has been 550-5.7.1 blocked.\n</code></pre>\n\n<p>I'm assuming this is the machine name <strong>from</strong>, and not the email sender <strong>from</strong>.  How can I tell the mail server that I'm not <code>localhost</code>?  I've messed with the <code>relay</code> and other <code>directives</code> in <code>postfix</code> to no avail.  So I'm trying to modify the <code>Ruby</code> syntax to make the server recognize me. </p>\n\n<p>Any insight appreciated as to how I can get this to work.  It's my development box and it's working on my production server, but I'd like to have it working on my dev box.  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 2475, "user_id": 1298944, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/717c09c121dd66d83aa8b729f4b92973?s=128&d=identicon&r=PG", "display_name": "Scott Bartell", "link": "https://stackoverflow.com/users/1298944/scott-bartell"}, "edited": false, "score": 0, "creation_date": 1553570119, "post_id": 55339129, "comment_id": 97423128, "body": "Do you have RSpec configured to use transactional_fixtures? Or are you using some other clean up strategy/tool like DatabaseCleaner? <a href=\"https://relishapp.com/rspec/rspec-rails/docs/transactions\" rel=\"nofollow noreferrer\">relishapp.com/rspec/rspec-rails/docs/transactions</a>"}, {"owner": {"reputation": 5707, "user_id": 587406, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1p6qq.jpg?s=128&g=1", "display_name": "Luiz E.", "link": "https://stackoverflow.com/users/587406/luiz-e"}, "reply_to_user": {"reputation": 2475, "user_id": 1298944, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/717c09c121dd66d83aa8b729f4b92973?s=128&d=identicon&r=PG", "display_name": "Scott Bartell", "link": "https://stackoverflow.com/users/1298944/scott-bartell"}, "edited": false, "score": 0, "creation_date": 1553595705, "post_id": 55339129, "comment_id": 97433203, "body": "our <code>use_transactional_fixtures</code> is set to false and we are using DatabaseCleaner, yes"}, {"owner": {"reputation": 2475, "user_id": 1298944, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/717c09c121dd66d83aa8b729f4b92973?s=128&d=identicon&r=PG", "display_name": "Scott Bartell", "link": "https://stackoverflow.com/users/1298944/scott-bartell"}, "edited": false, "score": 0, "creation_date": 1553614769, "post_id": 55339129, "comment_id": 97445972, "body": "what strategy are you using with DatabaseCleaner? Have you tried the deletion strategy?"}, {"owner": {"reputation": 5707, "user_id": 587406, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1p6qq.jpg?s=128&g=1", "display_name": "Luiz E.", "link": "https://stackoverflow.com/users/587406/luiz-e"}, "reply_to_user": {"reputation": 2475, "user_id": 1298944, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/717c09c121dd66d83aa8b729f4b92973?s=128&d=identicon&r=PG", "display_name": "Scott Bartell", "link": "https://stackoverflow.com/users/1298944/scott-bartell"}, "edited": false, "score": 0, "creation_date": 1553625248, "post_id": 55339129, "comment_id": 97451977, "body": "not yet, I&#39;ll try and let you know!"}, {"owner": {"reputation": 2475, "user_id": 1298944, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/717c09c121dd66d83aa8b729f4b92973?s=128&d=identicon&r=PG", "display_name": "Scott Bartell", "link": "https://stackoverflow.com/users/1298944/scott-bartell"}, "edited": false, "score": 0, "creation_date": 1553628430, "post_id": 55339129, "comment_id": 97453451, "body": "What version of Ruby and Rails are you running?"}], "answers": [{"comments": [{"owner": {"reputation": 5707, "user_id": 587406, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1p6qq.jpg?s=128&g=1", "display_name": "Luiz E.", "link": "https://stackoverflow.com/users/587406/luiz-e"}, "edited": false, "score": 0, "creation_date": 1553625334, "post_id": 55361037, "comment_id": 97452031, "body": "this is quite nice, I haven&#39;t thought it this way but it solves <i>half</i> my issue. I still need to find a way to call <code>bank_account.with_lock</code> twice using two different threads, which I was unable to do so far"}, {"owner": {"reputation": 716, "user_id": 3507206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/848870b4043d5ca319aa3111cb55845b?s=128&d=identicon&r=PG", "display_name": "tejasbubane", "link": "https://stackoverflow.com/users/3507206/tejasbubane"}, "reply_to_user": {"reputation": 5707, "user_id": 587406, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1p6qq.jpg?s=128&g=1", "display_name": "Luiz E.", "link": "https://stackoverflow.com/users/587406/luiz-e"}, "edited": false, "score": 0, "creation_date": 1553625810, "post_id": 55361037, "comment_id": 97452245, "body": "Exactly my point! That functionality is of Rails, not yours. You should not test library implementations - only test that your code uses the library in its intended way."}], "tags": [], "owner": {"reputation": 716, "user_id": 3507206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/848870b4043d5ca319aa3111cb55845b?s=128&d=identicon&r=PG", "display_name": "tejasbubane", "link": "https://stackoverflow.com/users/3507206/tejasbubane"}, "is_accepted": false, "score": 0, "last_activity_date": 1553614674, "creation_date": 1553614674, "answer_id": 55361037, "question_id": 55339129, "link": "https://stackoverflow.com/questions/55339129/how-to-test-lock-mechanism/55361037#55361037", "title": "how to test lock mechanism", "body": "<p><code>with_lock</code> is Rails's implementation which we don't need to test. You can use a <a href=\"https://relishapp.com/rspec/rspec-mocks/docs\" rel=\"nofollow noreferrer\">mock</a> and check if your code calls <code>with_lock</code>. The only trick here is to ensure the transaction gets imported (ie. the code inside <code>with_lock</code> gets executed). RSpec will provide the block which you can call. Below is a snippet of how you can do it - full working implementation can be found <a href=\"https://gist.github.com/tejasbubane/897712413c38fd57a3c516c6fae8e13f\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>describe \"#import_transactions\" do\n  it \"runs with lock\" do\n    # Test if with_lock is getting called\n    expect(subject).to receive(:with_lock) do |*_args, &amp;block|\n      # block is provided to with_lock method\n      # execute the block and test if it creates transactions\n      expect { block.call }\n        .to change { BankAccountTransaction.count }.from(0).to(2)\n    end\n\n    ImportService.new.import_transactions(subject, transactions)\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5707, "user_id": 587406, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1p6qq.jpg?s=128&g=1", "display_name": "Luiz E.", "link": "https://stackoverflow.com/users/587406/luiz-e"}, "edited": false, "score": 0, "creation_date": 1553678667, "post_id": 55364478, "comment_id": 97469638, "body": "about point 1: I updated my question with my current configuration. about 1.2 I doubt it would be because of the pool, It doesn&#39;t work even when I run only this spec alone. I can try increase as well but I do think you are right on the database cleaning strategy. about your second point, <code>import</code> actually uses a <code>find_or_create_by</code> so it can be run twice, I just need them to run sequentially"}], "tags": [], "owner": {"reputation": 2475, "user_id": 1298944, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/717c09c121dd66d83aa8b729f4b92973?s=128&d=identicon&r=PG", "display_name": "Scott Bartell", "link": "https://stackoverflow.com/users/1298944/scott-bartell"}, "is_accepted": false, "score": 1, "last_activity_date": 1553627784, "last_edit_date": 1553627784, "creation_date": 1553626699, "answer_id": 55364478, "question_id": 55339129, "link": "https://stackoverflow.com/questions/55339129/how-to-test-lock-mechanism/55364478#55364478", "title": "how to test lock mechanism", "body": "<p>It looks like there's a couple things going on here. </p>\n\n<p>First, the heart of the issue likely lies in a couple areas:</p>\n\n<ol>\n<li><strong>Database Cleaning Strategy</strong>: You're using the <a href=\"https://github.com/DatabaseCleaner/database_cleaner#supported-databases-libraries-and-strategies\" rel=\"nofollow noreferrer\">DatabaseCleaner gem</a> which provide three cleaning strategies: Truncation, Transaction, and Deletion. My guess is that if you're using the <code>Transaction</code> strategy, the lock is never released because the first transaction is never committed and the second thread just waits for it to be released.</li>\n<li><strong>Database Pool Config</strong>: Another possible theory is that the connection pool for your test database is too small. This would mean that one (or both) of your threads are waiting to obtain a database connection. Typically there is a timeout configured for this and if one is set you should see an exception that looks something like this: <code>could not obtain a connection from the pool within 5.000 seconds</code>. To fix this, in your <code>database.yml</code> under <code>test</code> adjust your <a href=\"https://edgeguides.rubyonrails.org/configuring.html#database-pooling\" rel=\"nofollow noreferrer\"><code>pool</code> setting</a>. You can inspect the values that are set by looking at:</li>\n</ol>\n\n<pre class=\"lang-rb prettyprint-override\"><code>irb(main):001:0&gt; ActiveRecord::Base.connection.pool.size\n=&gt; 5\nirb(main):001:0&gt; ActiveRecord::Base.connection.pool.checkout_timeout\n=&gt; 5\n</code></pre>\n\n<p>Second, in the code you provided, unless <code>import</code> modifies the transactions or the bank account that it imports, it appears as if the <code>with_lock</code> will not actually prevent multiple uploads.. it will just ensure that they run sequentially.</p>\n\n<p>You might need to do something like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code> bank_account.with_lock do\n   unimported_transactions.each do |transaction|\n     import(bank_account, transaction)\n     transaction.mark_as_imported!\n   end\n end\n</code></pre>\n\n<p>Additionally, if import is making some sort of external request, you should be careful around partial failures and rollbacks. (the <code>with_lock</code> wraps all SQL queries within it in a database transaction, and if an exception is thrown it will all rollback on your database but not on the external service)</p>\n"}], "owner": {"reputation": 5707, "user_id": 587406, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1p6qq.jpg?s=128&g=1", "display_name": "Luiz E.", "link": "https://stackoverflow.com/users/587406/luiz-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1180, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1553678525, "creation_date": 1553521144, "last_edit_date": 1553678525, "question_id": 55339129, "link": "https://stackoverflow.com/questions/55339129/how-to-test-lock-mechanism", "title": "how to test lock mechanism", "body": "<p>I have a piece of code where I import a <code>BankAccountTransaction</code> to a <code>BankAccount</code></p>\n\n<pre><code> bank_account.with_lock do\n   transactions.each do |transaction|\n     import(bank_account, transaction)\n   end\n end\n</code></pre>\n\n<p>it works fine but I need to write an RSpec case to it so I can be 100% sure I'm not importing transactions twice. </p>\n\n<p>I wrote the following helper</p>\n\n<pre><code>module ConcurrencyHelper\n  def make_concurrent_calls(function, concurrent_calls: 2)\n    threads = Array.new(concurrent_calls) do\n      thread = Thread.new { function.call }\n      thread.abort_on_exception = true\n\n      thread\n    end\n\n    threads.each(&amp;:join)\n  end\nend\n</code></pre>\n\n<p>and I'm calling it on RSpec</p>\n\n<pre><code>context 'when importing the same transaction twice' do\n  subject(:concurrent_calls) { make_concurrent_calls(operation) }\n\n  let!(:operation) { -&gt; { described_class.call(params) } }\n  let(:filename) { 'single-transaction-response.xml' }\n\n  it 'creates only one transaction' do\n    expect { concurrent_calls }.to change(BankaccountTransaction, :count).by(1)\n  end\nend\n</code></pre>\n\n<p>but nothing happens, the test suit gets stuck at this point and no errors are thrown or anything like that. </p>\n\n<p>I've put a debug point (<code>byebug</code>) right after I instantiate the threads and tried to call the function and it runs fine but when I join the threads, nothing happens. </p>\n\n<p>Things I tried so far  </p>\n\n<ul>\n<li>breakpoint before <code>threads.each(&amp;:join)</code> and call the function (works fine)  </li>\n<li>breakpoint in the rspec example and debug <code>operation</code> and <code>params</code> (all good)</li>\n</ul>\n\n<p>any more ideas?   </p>\n\n<p><strong>Edit</strong></p>\n\n<p>this is my current DatabaseCleaner configuration</p>\n\n<pre><code>RSpec.configure do |config|\n  config.before(:suite) do\n    DatabaseCleaner.clean_with(:deletion)\n  end\n\n  config.before do\n    DatabaseCleaner.strategy = :transaction\n  end\n\n  config.before(:each, js: true) do\n    DatabaseCleaner.strategy = :deletion\n  end\n\n  config.before do\n    DatabaseCleaner.start\n  end\n\n  config.after do\n    DatabaseCleaner.clean\n  end\nend\n</code></pre>\n\n<p>I still haven't tried to modify the strategy to <code>:deleteion</code>, I will do it as well</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 4476164, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/951ffcedf138b278f898fdfecd0da4c7?s=128&d=identicon&r=PG&f=1", "display_name": "sconicelli", "link": "https://stackoverflow.com/users/4476164/sconicelli"}, "edited": false, "score": 0, "creation_date": 1553522838, "post_id": 55339361, "comment_id": 97404388, "body": "I tried this before but since &quot;obj&quot; is a hash, I think I am running into something similar to <a href=\"https://stackoverflow.com/questions/18358717/ruby-elegantly-convert-variable-to-an-array-if-not-an-array-already\" title=\"ruby elegantly convert variable to an array if not an array already\">stackoverflow.com/questions/18358717/&hellip;</a>"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 89, "user_id": 4476164, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/951ffcedf138b278f898fdfecd0da4c7?s=128&d=identicon&r=PG&f=1", "display_name": "sconicelli", "link": "https://stackoverflow.com/users/4476164/sconicelli"}, "edited": false, "score": 0, "creation_date": 1553523784, "post_id": 55339361, "comment_id": 97404965, "body": "@sconicelli You are right. I wasn&#39;t aware of this edge case. I changed my answer to that suggested version from the other question which I liked best."}, {"owner": {"reputation": 89, "user_id": 4476164, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/951ffcedf138b278f898fdfecd0da4c7?s=128&d=identicon&r=PG&f=1", "display_name": "sconicelli", "link": "https://stackoverflow.com/users/4476164/sconicelli"}, "edited": false, "score": 0, "creation_date": 1553524489, "post_id": 55339361, "comment_id": 97405433, "body": "Thanks!  made sense for me to just extend Array like rails does... not sure why Ruby itself doesn&#39;t add this feature.  Problem solved though..."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1554000739, "post_id": 55339361, "comment_id": 97592102, "body": "You can replace <code>[obj].flatten(1)</code> with <code>Array(obj)</code> or <code>[*obj]</code>."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1554009725, "post_id": 55339361, "comment_id": 97593235, "body": "@CarySwoveland: Unfortunately, <code>Array(obj)</code>  or <code>[*obj]</code> doesn&#39;t work in this example, because here the single element would be a hash and the expected the response would be an array with one hash inside. But instead, an array of arrays is returned. See: <a href=\"https://stackoverflow.com/q/18358717/2483313\">stackoverflow.com/q/18358717/2483313</a>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1554010938, "post_id": 55339361, "comment_id": 97593402, "body": "I didn&#39;t know that! (I guess that&#39;s obvious.) I&#39;ll leave my comment for its educational value, unless you prefer that I remove it."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1554011274, "post_id": 55339361, "comment_id": 97593450, "body": "Is <code>(1)</code> needed?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1554011779, "post_id": 55339361, "comment_id": 97593537, "body": "Yes <code>(1)</code> is needed to cover another edge case: When obj is already a nested array,  <code>flatten</code> (without the parameter) would remove the nesting."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1554011821, "post_id": 55339361, "comment_id": 97593543, "body": "@CarySwoveland Seems like we both learned the same things and asked the same questions today while thinking about an answer.  Please leave your comment!"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1554014703, "post_id": 55339361, "comment_id": 97593988, "body": "Re <code>(1)</code>, I was going by the nesting in the example, but you have a good point--better to cover the general case."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 2, "last_activity_date": 1553523701, "last_edit_date": 1553523701, "creation_date": 1553521870, "answer_id": 55339361, "question_id": 55338868, "link": "https://stackoverflow.com/questions/55338868/how-to-not-repeat-code-when-looping-over-a-data-structure-where-a-keys-value-ca/55339361#55339361", "title": "How to not repeat code when looping over a data structure where a key&#39;s value can be a hash or multi-item array?", "body": "<p>You could just wrap it in an array all the time:</p>\n\n<pre><code>ds1.each do |name, obj|\n  [obj].flatten(1).each do |sub_obj|\n    next unless flavor_check?(sub_obj, s_lit, 'flavor') # calls flavor_check? function\n    obj_func(name, sub_obj) # call a function here\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 4476164, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/951ffcedf138b278f898fdfecd0da4c7?s=128&d=identicon&r=PG&f=1", "display_name": "sconicelli", "link": "https://stackoverflow.com/users/4476164/sconicelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 55339361, "answer_count": 1, "score": 0, "last_activity_date": 1553523701, "creation_date": 1553520338, "last_edit_date": 1553521247, "question_id": 55338868, "link": "https://stackoverflow.com/questions/55338868/how-to-not-repeat-code-when-looping-over-a-data-structure-where-a-keys-value-ca", "title": "How to not repeat code when looping over a data structure where a key&#39;s value can be a hash or multi-item array?", "body": "<p>I have a complex data structure that looks as follows:</p>\n\n<pre><code>ds1 =\n{\n  'item1' =&gt;\n  {\n    'value' =&gt; '1024',\n    'flavor' =&gt; %w(s m l xl),\n    'platform_version' =&gt; %w(7),\n  },\n  'item2' =&gt;\n  [{\n    'value' =&gt; '2000000',\n    'flavor' =&gt; %w(l xl),\n    'platform_version' =&gt; %w(7),\n  },\n  {\n    'value' =&gt; '1000000',\n    'flavor' =&gt; %w(s m),\n    'platform_version' =&gt; %w(6),\n  },],\n}\n</code></pre>\n\n<p>I'm currently looping over this as follows:</p>\n\n<pre><code>ds1.each do |name, obj|\n  if obj.is_a?(Array)\n    # Found that the data structure has multiple scenarios for the same key and need to loop over each element\n    obj.each do |sub_obj|\n      next unless flavor_check?(sub_obj, s_lit, 'flavor') # calls flavor_check? function\n      obj_func(name, sub_obj) # call a function here\n    end\n  else\n    # hash only has one element so treat normally, no need for another loop\n    next unless flavor_check?(sub_obj, s_lit, 'flavor') # calls flavor_check? function\n    obj_func(name, sub_obj) # call a function here\n  end\nend\n</code></pre>\n\n<p>Sometimes I have much more code that I need to execute and having to repeat it twice depending on whether the \"obj\" is an array or not just makes my code look busy/ugly.  Is there a more elegant way to handle this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 6486, "user_id": 1116230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55a894894150db28d6641f0c57e48bac?s=128&d=identicon&r=PG", "display_name": "Nico Haase", "link": "https://stackoverflow.com/users/1116230/nico-haase"}, "edited": false, "score": 0, "creation_date": 1553519966, "post_id": 55338517, "comment_id": 97402572, "body": "What&#39;s the problem with the given code?"}, {"owner": {"reputation": 21, "user_id": 10910274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d77816e70d343d7d7c4288178973c704?s=128&d=identicon&r=PG&f=1", "display_name": "awesomie", "link": "https://stackoverflow.com/users/10910274/awesomie"}, "reply_to_user": {"reputation": 6486, "user_id": 1116230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55a894894150db28d6641f0c57e48bac?s=128&d=identicon&r=PG", "display_name": "Nico Haase", "link": "https://stackoverflow.com/users/1116230/nico-haase"}, "edited": false, "score": 0, "creation_date": 1553520068, "post_id": 55338517, "comment_id": 97402644, "body": "The problem is if the content params includes &#39;&amp;&#39; or apostrophe ...etc it doesn&#39;t send the contents properly so was wondering if there is any gem or some way that converts text to url format automatically"}, {"owner": {"reputation": 6486, "user_id": 1116230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55a894894150db28d6641f0c57e48bac?s=128&d=identicon&r=PG", "display_name": "Nico Haase", "link": "https://stackoverflow.com/users/1116230/nico-haase"}, "edited": false, "score": 0, "creation_date": 1553520178, "post_id": 55338517, "comment_id": 97402725, "body": "And what happens instead? Please share some examples where you&#39;re facing problems, and the expected output"}, {"owner": {"reputation": 1651, "user_id": 4414956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17a7ff9df014e5c92697372747c15d77?s=128&d=identicon&r=PG&f=1", "display_name": "nuaky", "link": "https://stackoverflow.com/users/4414956/nuaky"}, "edited": false, "score": 1, "creation_date": 1553520427, "post_id": 55338517, "comment_id": 97402911, "body": "maybe you&#39;ve got some issues with URI? You can convert text like so: <code>URI.encode(&quot;Hello world &amp;&quot;)</code>. After sending the payload you can decode this with <code>URI.decode(&quot;Hello%20world%20&amp;&quot;)</code>. All special characters will be untouched"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1553534741, "post_id": 55338517, "comment_id": 97411586, "body": "<code>HTTParty</code> will handle this for you when used appropriately. try <code>HTTParty.post(&quot;http:&#47;&#47;abc.go.com&quot;,body: {contents: params[:content]})</code> instead. <a href=\"https://www.rubydoc.info/github/jnunemaker/httparty/HTTParty/ClassMethods#post-instance_method\" rel=\"nofollow noreferrer\">HTTParty::post</a>. If it must be appended to the URL which seesm odd for a POST request then access would be as follows: <code>HTTParty.post(&quot;http:&#47;&#47;abc.go.com&quot;,query: {contents: params[:content]})</code>"}, {"owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1553621765, "post_id": 55338517, "comment_id": 97450224, "body": "@engineersmnky Mind putting that in an answer so I can upvote it?"}], "answers": [{"tags": [], "owner": {"reputation": 943, "user_id": 546950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60de781d84a6767b10c5040c54180433?s=128&d=identicon&r=PG", "display_name": "robertoplancarte", "link": "https://stackoverflow.com/users/546950/robertoplancarte"}, "is_accepted": false, "score": 0, "last_activity_date": 1553630001, "last_edit_date": 1553630001, "creation_date": 1553627562, "answer_id": 55364676, "question_id": 55338517, "link": "https://stackoverflow.com/questions/55338517/passing-data-through-url-to-the-other-application-in-ruby-on-rails/55364676#55364676", "title": "Passing data through URL to the other application in Ruby on Rails", "body": "<p>From what i can tel you're getting the \"contents\" from a POST request on your controller, which i'm guessing came from a form you created in one of your views. If that's the case you could skip the controller altogether and just point your form's action to <a href=\"http://abc.go.com\" rel=\"nofollow noreferrer\">http://abc.go.com</a>. You can read about how to do it <a href=\"https://apidock.com/rails/ActionView/Helpers/FormTagHelper/form_tag\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<pre><code>&lt;%= form_tag(\"http://abc.go.com\", method: \"post\") do %&gt;\n  &lt;%= label_tag(:contents, \"Contents: \") %&gt;\n  &lt;%= text_area_tag(:contents) %&gt;\n  &lt;%= submit_tag(\"Submit\") %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This way the user's browser sends the request and you don't need to have an HTTP client on your controller. It is important to know that you have to take care of the authenticity token by hand and set up abc to redirect back to your original app or wherever you want with <a href=\"https://en.wikipedia.org/wiki/HTTP_302\" rel=\"nofollow noreferrer\">http 302</a>.</p>\n\n<p>If abc is a rails app then the controller could look like this: </p>\n\n<pre><code>class SomeController &lt; ApplicationController\nprotect_from_forgery except: :create\n\ndef create\n  #use strong params not params[:contents]\n  @something = SomeModel.new(contents: params[:contents])\n\n  if @something.save  \n    format.html {redirect_to \"http://original_url/place_to_go_after_content_submit\")\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10910274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d77816e70d343d7d7c4288178973c704?s=128&d=identicon&r=PG&f=1", "display_name": "awesomie", "link": "https://stackoverflow.com/users/10910274/awesomie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553630001, "creation_date": 1553519248, "question_id": 55338517, "link": "https://stackoverflow.com/questions/55338517/passing-data-through-url-to-the-other-application-in-ruby-on-rails", "title": "Passing data through URL to the other application in Ruby on Rails", "body": "<p>I am new to Ruby on Rails, I would like to pass some data to my other application. I am currently using <code>httpparty</code> gem but I am having a hard time when I send big data such as text so I was wondering if there is any recommended gem that converts plain html text to\nthe format that I can send through or easy way to do</p>\n\n<p>What I am trying to do:</p>\n\n<p>e.g:</p>\n\n<pre><code>def abc_action \n    contents = params[:content]\n    response = HTTParty.post(\"http://abc.go.com?contents=#{contents}\")\n\nend\n</code></pre>\n\n<h3>say content params include many paragraphs such as</h3>\n\n<p>\"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum</p>\n\n<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum\"</p>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 13359, "user_id": 1779477, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f62e1d28063f41fd9728d811fea3a84c?s=128&d=identicon&r=PG&f=1", "display_name": "idmean", "link": "https://stackoverflow.com/users/1779477/idmean"}, "edited": false, "score": 0, "creation_date": 1553518331, "post_id": 55338062, "comment_id": 97401564, "body": "1. What is the problem with creating separate classes? Give each class a well-chosen unique name and you\u2019re good to go. A module (not namespace) might be a good idea too. 2. You join one thread after the other and once that loop returns (thus all threads are done) you run the other process."}, {"owner": {"reputation": 19, "user_id": 11254915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cca95fcc38543e72956e36ab460e40f?s=128&d=identicon&r=PG&f=1", "display_name": "Zenwear", "link": "https://stackoverflow.com/users/11254915/zenwear"}, "reply_to_user": {"reputation": 13359, "user_id": 1779477, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f62e1d28063f41fd9728d811fea3a84c?s=128&d=identicon&r=PG&f=1", "display_name": "idmean", "link": "https://stackoverflow.com/users/1779477/idmean"}, "edited": false, "score": 0, "creation_date": 1553519245, "post_id": 55338062, "comment_id": 97402131, "body": "@idmean I&#39;m using Ruby on Rails and don&#39;t understand how to do it. Should I create 10 controllers and call all of them inside &quot;parsercontroller&quot; or how it should be?"}, {"owner": {"reputation": 14213, "user_id": 398863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4CNtJ.png?s=128&g=1", "display_name": "Amit Patel", "link": "https://stackoverflow.com/users/398863/amit-patel"}, "edited": false, "score": 0, "creation_date": 1553538161, "post_id": 55338062, "comment_id": 97413200, "body": "Can you please share source code of any two parsers so I can guide you how to design and place classes?"}, {"owner": {"reputation": 19, "user_id": 11254915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cca95fcc38543e72956e36ab460e40f?s=128&d=identicon&r=PG&f=1", "display_name": "Zenwear", "link": "https://stackoverflow.com/users/11254915/zenwear"}, "reply_to_user": {"reputation": 14213, "user_id": 398863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4CNtJ.png?s=128&g=1", "display_name": "Amit Patel", "link": "https://stackoverflow.com/users/398863/amit-patel"}, "edited": false, "score": 0, "creation_date": 1553593551, "post_id": 55338062, "comment_id": 97431781, "body": "@AmitPatel I&#39;ve done it."}, {"owner": {"reputation": 14213, "user_id": 398863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4CNtJ.png?s=128&g=1", "display_name": "Amit Patel", "link": "https://stackoverflow.com/users/398863/amit-patel"}, "edited": false, "score": 1, "creation_date": 1553606546, "post_id": 55338062, "comment_id": 97440163, "body": "You havn&#39;t share source code of parsers. You just shared placeholder actions of controller."}, {"owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "edited": false, "score": 0, "creation_date": 1553621869, "post_id": 55338062, "comment_id": 97450275, "body": "Do you need to wait for the parsers to complete to render a view? If not, you could turn these into ActionJobs (which would also split them up into separate classes and separate them logically)."}], "owner": {"reputation": 19, "user_id": 11254915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cca95fcc38543e72956e36ab460e40f?s=128&d=identicon&r=PG&f=1", "display_name": "Zenwear", "link": "https://stackoverflow.com/users/11254915/zenwear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1553593514, "creation_date": 1553517709, "last_edit_date": 1592644375, "question_id": 55338062, "link": "https://stackoverflow.com/questions/55338062/how-to-split-parsers-in-rails", "title": "How to split parsers in Rails", "body": "<p>I have question.</p>\n<p>I\u2019m writing an application which parsing 10 webpages. I described each parser as a method of \u201cparsercontroller\u201d. The next step is to run 10 threads with 10 parsers, after the action is done I need to run another process.</p>\n<ol>\n<li>I want to split each parser to separate class? How can I store all 10 parsers? Like separate namespace or smth else? Could you give me an advice how to move forward?</li>\n<li>How can I run another process after the all parsers is done? In what way I need to move?</li>\n</ol>\n<p>Thanks a lot, I appreciate all the help)</p>\n<h2>Update</h2>\n<h3>Source code:</h3>\n<p>parser_controller.rb</p>\n<pre><code>class ParserController &lt; ApplicationController\n  def parser1 \n    #parse a lot of data (big parser)\n  end\n\n  def parser2 \n    #parse a lot of data (big parser)\n  end\n  \n  private \n  \n  def helper_for_checking_data\n     # check data when filling database.\n  end\n\n  def cleanup_database\n     #clean db by cron every day\n  end\nend\n</code></pre>\n<p>How can I split all of this methods, because I don't know good practices.</p>\n"}, {"tags": ["regex", "ruby"], "comments": [{"owner": {"reputation": 1705, "user_id": 6834831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BfjAm.jpg?s=128&g=1", "display_name": "ALFA", "link": "https://stackoverflow.com/users/6834831/alfa"}, "edited": false, "score": 0, "creation_date": 1553515758, "post_id": 55337195, "comment_id": 97400076, "body": "If you only pass the substring to the regex, just use <code>\\n</code>."}, {"owner": {"reputation": 5296, "user_id": 418066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/38yuw.png?s=128&g=1", "display_name": "Biffen", "link": "https://stackoverflow.com/users/418066/biffen"}, "edited": false, "score": 1, "creation_date": 1553516947, "post_id": 55337195, "comment_id": 97400806, "body": "You say JSON, but that\u2019s not valid JSON. And if it\u2019s supposed to be JSON then don\u2019t use regex; use a JSON parser."}, {"owner": {"reputation": 862, "user_id": 5269447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d355fcfdfb38bfec218c4239da62f2?s=128&d=identicon&r=PG&f=1", "display_name": "0x777C", "link": "https://stackoverflow.com/users/5269447/0x777c"}, "edited": false, "score": 0, "creation_date": 1553517296, "post_id": 55337195, "comment_id": 97400977, "body": "I understand what I&#39;ve provided isn&#39;t valid JSON, because my intention is to take my current JSON and transform it into something similar to that. Also I am not only passing the substring to the regex, I&#39;m passing the entirety of the string to the regex."}, {"owner": {"reputation": 5489, "user_id": 3670132, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1c25213978ce9fc6a9b8b60f5d780b4?s=128&d=identicon&r=PG", "display_name": "Seblor", "link": "https://stackoverflow.com/users/3670132/seblor"}, "edited": false, "score": 0, "creation_date": 1553772104, "post_id": 55337195, "comment_id": 97512885, "body": "Why don&#39;t you just replace all <code>\\n</code> characters by <code>\\\\n</code> to escape the new lines ?"}, {"owner": {"reputation": 8018, "user_id": 2064981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/74e3e392c752c4c9acb4ca4fb8f7af65?s=128&d=identicon&r=PG&f=1", "display_name": "SamWhan", "link": "https://stackoverflow.com/users/2064981/samwhan"}, "edited": false, "score": 1, "creation_date": 1553773612, "post_id": 55337195, "comment_id": 97513830, "body": "What&#39;s the flavor/language?"}, {"owner": {"reputation": 862, "user_id": 5269447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d355fcfdfb38bfec218c4239da62f2?s=128&d=identicon&r=PG&f=1", "display_name": "0x777C", "link": "https://stackoverflow.com/users/5269447/0x777c"}, "reply_to_user": {"reputation": 5489, "user_id": 3670132, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1c25213978ce9fc6a9b8b60f5d780b4?s=128&d=identicon&r=PG", "display_name": "Seblor", "link": "https://stackoverflow.com/users/3670132/seblor"}, "edited": false, "score": 0, "creation_date": 1553775544, "post_id": 55337195, "comment_id": 97514979, "body": "@Seblor Replacing all newlines would replace newlines outside of strings which would make the file invalid."}, {"owner": {"reputation": 862, "user_id": 5269447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d355fcfdfb38bfec218c4239da62f2?s=128&d=identicon&r=PG&f=1", "display_name": "0x777C", "link": "https://stackoverflow.com/users/5269447/0x777c"}, "reply_to_user": {"reputation": 8018, "user_id": 2064981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/74e3e392c752c4c9acb4ca4fb8f7af65?s=128&d=identicon&r=PG&f=1", "display_name": "SamWhan", "link": "https://stackoverflow.com/users/2064981/samwhan"}, "edited": false, "score": 1, "creation_date": 1553775559, "post_id": 55337195, "comment_id": 97514994, "body": "@SamWhan The language is Ruby"}, {"owner": {"reputation": 6118, "user_id": 106769, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qsZek.png?s=128&g=1", "display_name": "Conspicuous Compiler", "link": "https://stackoverflow.com/users/106769/conspicuous-compiler"}, "edited": false, "score": 2, "creation_date": 1553789008, "post_id": 55337195, "comment_id": 97524832, "body": "@faissaloo It&#39;s best to add information requested in comments in your question itself, since most answerers are unlikely to read comments.  I&#39;ve edited your information into the question.  Cheers!"}, {"owner": {"reputation": 6118, "user_id": 106769, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qsZek.png?s=128&g=1", "display_name": "Conspicuous Compiler", "link": "https://stackoverflow.com/users/106769/conspicuous-compiler"}, "edited": false, "score": 0, "creation_date": 1553789182, "post_id": 55337195, "comment_id": 97524951, "body": "I&#39;ll note that this is generally a <i>parsing</i> problem, not a regex problem.  If your string has any escaped quotation marks (e.g. &quot;foo \\&quot; \\n\\&quot;bar\\&quot;: \\&quot;baz\\&quot;&quot;) almost any proposed regex solution is going to fail.  I&#39;d suggest you change to an approach that <i>parses</i> the JSON, then write the JSON back out in the format you desire."}, {"owner": {"reputation": 862, "user_id": 5269447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d355fcfdfb38bfec218c4239da62f2?s=128&d=identicon&r=PG&f=1", "display_name": "0x777C", "link": "https://stackoverflow.com/users/5269447/0x777c"}, "edited": false, "score": 0, "creation_date": 1553789474, "post_id": 55337195, "comment_id": 97525111, "body": "I understand, but JSON parsing is often expensive, especially when working with large pieces of JSON in a dynamic language like Ruby, hence why I&#39;m trying to avoid it."}, {"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "edited": false, "score": 0, "creation_date": 1553794987, "post_id": 55337195, "comment_id": 97528230, "body": "Is it really <code>&quot;a normal value&quot;</code> by itself\u2014a key with no value\u2014between curly braces, as you have it written? Or is that a transcription error?"}, {"owner": {"reputation": 862, "user_id": 5269447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d355fcfdfb38bfec218c4239da62f2?s=128&d=identicon&r=PG&f=1", "display_name": "0x777C", "link": "https://stackoverflow.com/users/5269447/0x777c"}, "reply_to_user": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "edited": false, "score": 0, "creation_date": 1553805161, "post_id": 55337195, "comment_id": 97533384, "body": "@mwp Transcription error"}, {"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "edited": false, "score": 0, "creation_date": 1553806178, "post_id": 55337195, "comment_id": 97533793, "body": "@faissaloo Okay, what&#39;s it supposed to be? Would you please update your question?"}, {"owner": {"reputation": 862, "user_id": 5269447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d355fcfdfb38bfec218c4239da62f2?s=128&d=identicon&r=PG&f=1", "display_name": "0x777C", "link": "https://stackoverflow.com/users/5269447/0x777c"}, "reply_to_user": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "edited": false, "score": 0, "creation_date": 1553854251, "post_id": 55337195, "comment_id": 97548991, "body": "@mwp I&#39;ve fixed it"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1554006330, "post_id": 55337195, "comment_id": 97592798, "body": "What about using yaml to load the string, get a hash and then its values? <code>require &#39;yaml&#39;; YAML.load(str).values.select { |value| value =~ &#47;(?=^\\s).*(?=\\s$)&#47; }</code>"}, {"owner": {"reputation": 862, "user_id": 5269447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d355fcfdfb38bfec218c4239da62f2?s=128&d=identicon&r=PG&f=1", "display_name": "0x777C", "link": "https://stackoverflow.com/users/5269447/0x777c"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1554035532, "post_id": 55337195, "comment_id": 97598030, "body": "@SebastianPalma At that point it&#39;s simpler for me to just extract the value with a regex and then replace the newlines (which is what I&#39;m doing in the absence of a pure regex solution)"}], "answers": [{"comments": [{"owner": {"reputation": 862, "user_id": 5269447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d355fcfdfb38bfec218c4239da62f2?s=128&d=identicon&r=PG&f=1", "display_name": "0x777C", "link": "https://stackoverflow.com/users/5269447/0x777c"}, "edited": false, "score": 0, "creation_date": 1553784241, "post_id": 55396360, "comment_id": 97521354, "body": "This just selects the string"}], "tags": [], "owner": {"reputation": 4995, "user_id": 1612432, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/MLvnJ.png?s=128&g=1", "display_name": "ElBaulP", "link": "https://stackoverflow.com/users/1612432/elbaulp"}, "is_accepted": false, "score": 1, "last_activity_date": 1553785728, "last_edit_date": 1553785728, "creation_date": 1553772145, "answer_id": 55396360, "question_id": 55337195, "link": "https://stackoverflow.com/questions/55337195/regex-to-select-newlines-in-between-quotation-marks/55396360#55396360", "title": "Regex to select newlines in between quotation marks", "body": "<p>I think this could help you. You capture the <code>\\n</code> inside the string and then can replace it:</p>\n\n<pre><code>\"[^\"]*(\\n)*\",\n</code></pre>\n\n<p><a href=\"https://regexr.com/4b6n6\" rel=\"nofollow noreferrer\">Test it</a></p>\n"}, {"comments": [{"owner": {"reputation": 862, "user_id": 5269447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d355fcfdfb38bfec218c4239da62f2?s=128&d=identicon&r=PG&f=1", "display_name": "0x777C", "link": "https://stackoverflow.com/users/5269447/0x777c"}, "edited": false, "score": 0, "creation_date": 1553805375, "post_id": 55403564, "comment_id": 97533474, "body": "I&#39;m currently doing something similar as an interim solution"}], "tags": [], "owner": {"reputation": 1, "user_id": 8344980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b53c9c801392a53a3f3b3736854d3301?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur", "link": "https://stackoverflow.com/users/8344980/arthur"}, "is_accepted": false, "score": 0, "last_activity_date": 1553793766, "creation_date": 1553793766, "answer_id": 55403564, "question_id": 55337195, "link": "https://stackoverflow.com/questions/55337195/regex-to-select-newlines-in-between-quotation-marks/55403564#55403564", "title": "Regex to select newlines in between quotation marks", "body": "<p>Another option would be something like this:</p>\n\n<pre><code>string = '{\n  \"a boolean\": true,\n  \"multiline\": \"my\nmultiline\nvalue\",\n  \"a normal value\"\n}'\n\nputs string.match(/\"(\\w+)(\\n+\\w*)+\"/).to_s.gsub!(\"\\n\", '\\n')\n</code></pre>\n\n<p>This matches the regex in your string and then substitutes the newlines with escaped newlines.</p>\n"}, {"comments": [{"owner": {"reputation": 862, "user_id": 5269447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d355fcfdfb38bfec218c4239da62f2?s=128&d=identicon&r=PG&f=1", "display_name": "0x777C", "link": "https://stackoverflow.com/users/5269447/0x777c"}, "edited": false, "score": 0, "creation_date": 1553898323, "post_id": 55422411, "comment_id": 97571478, "body": "This crashes in Ruby with the error: target of repeat operator is not specified"}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "reply_to_user": {"reputation": 862, "user_id": 5269447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d355fcfdfb38bfec218c4239da62f2?s=128&d=identicon&r=PG&f=1", "display_name": "0x777C", "link": "https://stackoverflow.com/users/5269447/0x777c"}, "edited": false, "score": 0, "creation_date": 1553904536, "post_id": 55422411, "comment_id": 97572920, "body": "@faissaloo - Yeah, looks like Ruby doesn&#39;t like the backtracking control verbs. You could always resolve the issue with a gsub call back. Or, you could just use Perl or PCRE engines to do the job. I recommend that you try that and leave Ruby alone, unless you&#39;re a strong programmer."}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "reply_to_user": {"reputation": 862, "user_id": 5269447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d355fcfdfb38bfec218c4239da62f2?s=128&d=identicon&r=PG&f=1", "display_name": "0x777C", "link": "https://stackoverflow.com/users/5269447/0x777c"}, "edited": false, "score": 0, "creation_date": 1554220380, "post_id": 55422411, "comment_id": 97667920, "body": "@faissaloo - Did you try the Ruby regex ?"}, {"owner": {"reputation": 862, "user_id": 5269447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d355fcfdfb38bfec218c4239da62f2?s=128&d=identicon&r=PG&f=1", "display_name": "0x777C", "link": "https://stackoverflow.com/users/5269447/0x777c"}, "edited": false, "score": 0, "creation_date": 1554222027, "post_id": 55422411, "comment_id": 97668846, "body": "Yes, it seemed to fail however on my large JSON but I&#39;m not exactly sure why. I may accept your answer soon nonetheless since it does the one I specified in my question and seems to work in most cases."}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "reply_to_user": {"reputation": 862, "user_id": 5269447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d355fcfdfb38bfec218c4239da62f2?s=128&d=identicon&r=PG&f=1", "display_name": "0x777C", "link": "https://stackoverflow.com/users/5269447/0x777c"}, "edited": false, "score": 0, "creation_date": 1554230493, "post_id": 55422411, "comment_id": 97672910, "body": "@faissaloo - Post the large JSON text somewhere, I&#39;ll look at it with my tools I don&#39;t like my regex not working %100 across the board."}, {"owner": {"reputation": 862, "user_id": 5269447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d355fcfdfb38bfec218c4239da62f2?s=128&d=identicon&r=PG&f=1", "display_name": "0x777C", "link": "https://stackoverflow.com/users/5269447/0x777c"}, "edited": false, "score": 0, "creation_date": 1554239962, "post_id": 55422411, "comment_id": 97677070, "body": "<a href=\"https://raw.githubusercontent.com/homes-england/monitor-api/cf1e536340ab63aaa1b00f8af9254c8032719c1d/lib/ui/gateway/schemas/hif_return.json\" rel=\"nofollow noreferrer\">raw.githubusercontent.com/homes-england/monitor-api/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "reply_to_user": {"reputation": 862, "user_id": 5269447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d355fcfdfb38bfec218c4239da62f2?s=128&d=identicon&r=PG&f=1", "display_name": "0x777C", "link": "https://stackoverflow.com/users/5269447/0x777c"}, "edited": false, "score": 0, "creation_date": 1554253099, "post_id": 55422411, "comment_id": 97680296, "body": "@faissaloo - I updated my answer with some new test cases using your large JSON string. Both regex work as expected..."}, {"owner": {"reputation": 862, "user_id": 5269447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d355fcfdfb38bfec218c4239da62f2?s=128&d=identicon&r=PG&f=1", "display_name": "0x777C", "link": "https://stackoverflow.com/users/5269447/0x777c"}, "edited": false, "score": 0, "creation_date": 1554300689, "post_id": 55422411, "comment_id": 97701457, "body": "I feel like the issue stems from some sort of peculiarity when it comes to the escaping of some parts of the regex, nonetheless I&#39;ve accepted your answer"}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "reply_to_user": {"reputation": 862, "user_id": 5269447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d355fcfdfb38bfec218c4239da62f2?s=128&d=identicon&r=PG&f=1", "display_name": "0x777C", "link": "https://stackoverflow.com/users/5269447/0x777c"}, "edited": false, "score": 0, "creation_date": 1554310181, "post_id": 55422411, "comment_id": 97707337, "body": "@faissaloo - The Ruby regex matches the entire string. Here are some helpful hints:  At this site, <a href=\"https://regex101.com/settings\" rel=\"nofollow noreferrer\">regex101.com/settings</a> turn off (uncheck) <i>Wrap long lines</i>.  Also, you should always check for balanced (evenness of ) quotes before running these regex&#39;s. You can do that with this regex:  <code>^[^&quot;]*(?:&quot;[^&quot;]*&quot;[^&quot;]*)*$</code>  <a href=\"https://regex101.com/r/iusyC6/1\" rel=\"nofollow noreferrer\">regex101.com/r/iusyC6/1</a>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "is_accepted": true, "score": 2, "last_activity_date": 1554846753, "last_edit_date": 1554846753, "creation_date": 1553879461, "answer_id": 55422411, "question_id": 55337195, "link": "https://stackoverflow.com/questions/55337195/regex-to-select-newlines-in-between-quotation-marks/55422411#55422411", "title": "Regex to select newlines in between quotation marks", "body": "<p><em><strong>UPdate</strong></em> - These regex work as expected.<br>\nFrom @faissaloo - <code>it seemed to fail however on my large</code> <a href=\"https://raw.githubusercontent.com/homes-england/monitor-api/cf1e536340ab63aaa1b00f8af9254c8032719c1d/lib/ui/gateway/schemas/hif_return.json\" rel=\"nofollow noreferrer\">JSON</a>.<br>\nI ran this large string using both regex:<br>\n PCRE  <a href=\"https://regex101.com/r/3jtqea/1\" rel=\"nofollow noreferrer\">https://regex101.com/r/3jtqea/1</a><br>\n Ruby   <a href=\"https://regex101.com/r/1HVCCC/1\" rel=\"nofollow noreferrer\">https://regex101.com/r/1HVCCC/1</a><br>\nThey both work identically, and without flaw.<br>\nIf you have any other concerns, please let me know.</p>\n\n<hr>\n\n<p>I think Ruby supports the Perl like constructs.<br>\nIf so, it can be done in a single global find and replace.<br>\nLike this:  </p>\n\n<p><em><strong>Edit</strong></em>  - Ruby doesn't do Backtracking Control Verbs <code>(*SKIP)(*FAIL)</code><br>\nso, to do this in Ruby code, requires the regex to be more explicit.<br>\nSo, with a slight modification of the pcre/perl regex, the Ruby equivalent is:    </p>\n\n<p><strong><em>Ruby</em></strong><br>\nFind  </p>\n\n<pre><code>(?-m)((?!\\A)\\G|(?:(?&gt;[^\"]*\"[^\"\\r\\n]*\"[^\"]*))*\")([^\"\\r\\n]*)\\K\\r?\\n(?=[^\"]*\")((?:[^\"\\r\\n]*\"(?:(?&gt;[^\"]*\"[^\"\\r\\n]*\"))*[^\"]*)?)\n</code></pre>\n\n<p>Replace  </p>\n\n<pre><code>\\\\n\\3\n</code></pre>\n\n<p><a href=\"https://regex101.com/r/BaqjEE/1\" rel=\"nofollow noreferrer\">https://regex101.com/r/BaqjEE/1</a><br>\n<a href=\"https://rextester.com/NVFD38349\" rel=\"nofollow noreferrer\">https://rextester.com/NVFD38349</a></p>\n\n<p>Explained ( but it's complex )</p>\n\n<pre><code> (?-m)                                    # Non-multiline mode safety check\n (                                        # (1 start), Prefix. Capture for debug\n      (?! \\A )                                 # Not BOS\n      \\G                                       # Test where last match left off\n\n   |                                         # or, \n      (?:                                      # Optionally align to next \" ( only used once )\n           (?&gt; [^\"]* \" [^\"\\r\\n]* \" [^\"]* )\n      )*\n\n      \"                                        # A new quote to test\n )                                        # (1 end)\n\n ( [^\"\\r\\n]* )                            # (2), Line break Preamble. Capture for debug\n \\K                                       # Exclude from the match (group 0) up to this point\n\n \\r? \\n                                   # Line break to escape\n\n (?= [^\"]* \" )                            # Validate we have \" closure\n\n (                                        # (3 start), Optional end quote and alignment.\n                                               # To be written back.\n      (?:\n           [^\"\\r\\n]* \"                   \n           (?:                                      # Optionally align to next \"\n                (?&gt; [^\"]* \" [^\"\\r\\n]* \" )\n           )*\n           [^\"]* \n      )?\n )                                        # (3 end)\n\n\n # Ruby Code:\n #----------------------\n # #ruby 2.3.1 \n # \n # re = /(?-m)((?!\\A)\\G|(?:(?&gt;[^\"]*\"[^\"\\r\\n]*\"[^\"]*))*\")([^\"\\r\\n]*)\\K\\r?\\n(?=[^\"]*\")((?:[^\"\\r\\n]*\"(?:(?&gt;[^\"]*\"[^\"\\r\\n]*\"))*[^\"]*)?)/\n # str = '{\n #   \"a boolean\": true,\n #   \"a boolean\": true,\n #   \"a boolean\": true,\n #   \"a boolean\": true,\n #   \"multiline\": \"\n # my\n # multiline\n # value\n # asdf\"\n # ,\n # \n # \"a multiline boo\n # lean\": true,\n # \"a normal key\": \"a multiline\n # \n # value\"\n # }'\n # subst = '\\\\n\\3'\n # \n # result = str.gsub(re, subst)\n # \n # # Print the result of the substitution\n # puts result\n</code></pre>\n\n<hr>\n\n<p><strong><em>For Pcre/Perl</em></strong><br>\nFind  </p>\n\n<pre><code>(?:((?:(?&gt;[^\"]*\"[^\"\\n]*\"[^\"]*))+(*SKIP)(*FAIL)|\"|(?!^)\\G)([^\"\\n]*)\\K\\n(?=[^\"]*\")((?:[^\"\\n]*\")?))\n</code></pre>\n\n<p>Replace  </p>\n\n<pre><code>\\\\n$3\n</code></pre>\n\n<p><a href=\"https://regex101.com/r/06naae/1\" rel=\"nofollow noreferrer\">https://regex101.com/r/06naae/1</a></p>\n\n<p>Explained ( but it's complex )<br>\nNote if you're on a windows box where editors need CRLF breaks,<br>\nadd a <code>\\r</code> in front of the LF, like this <code>\\r\\n</code>.</p>\n\n<pre><code> (?:\n      (                             # (1 start), Prefix capture, for debug\n           (?:\n                (?&gt; [^\"]* \" [^\"\\n]* \" [^\"]* )\n           )+\n           (*SKIP) (*FAIL)               # Consume false positives, but ignore them\n                                         # (need this to align next \")\n        |                              # or,\n           \"                             # A new quote to test\n        |                              # or, \n           (?! ^ )                       # Not BOS\n           \\G                            # Test where last match left off\n      )                             # (1 end)\n\n      ( [^\"\\n]* )                   # (2), Preamble capture, for debug\n      \\K                            # Exclude from the match (group 0) up to this point\n      \\n                            # Line break to escape\n      (?= [^\"]* \" )                 # Validate we have \" closure\n      (                             # (3 start), End quote, to be written back\n           (?: [^\"\\n]* \" )?\n      )                             # (3 end)\n )\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 74488, "user_id": 797495, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/BKD7l.jpg?s=128&g=1", "display_name": "Pedro Lobito", "link": "https://stackoverflow.com/users/797495/pedro-lobito"}, "is_accepted": false, "score": 0, "last_activity_date": 1554235496, "last_edit_date": 1554235496, "creation_date": 1554234873, "answer_id": 55482570, "question_id": 55337195, "link": "https://stackoverflow.com/questions/55337195/regex-to-select-newlines-in-between-quotation-marks/55482570#55482570", "title": "Regex to select newlines in between quotation marks", "body": "<p>Late answer, but you can use a regex like:</p>\n\n<pre><code>'\"(?=\\n).*?\"'\n</code></pre>\n\n<hr>\n\n<p><strong>Matches:</strong></p>\n\n<pre><code>\"\n    my\n        multiline\n    value\n        \",\n</code></pre>\n\n<hr>\n\n<p><strong>Demo:</strong></p>\n\n<ol>\n<li><a href=\"https://regex101.com/r/fhvZw5/w2\" rel=\"nofollow noreferrer\">Regex Demo &amp; Explanation</a></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 486, "user_id": 6144460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6a3cdffe21fd594a0947298f0f4f1f8?s=128&d=identicon&r=PG", "display_name": "periswon", "link": "https://stackoverflow.com/users/6144460/periswon"}, "is_accepted": false, "score": 0, "last_activity_date": 1554246905, "creation_date": 1554246905, "answer_id": 55484797, "question_id": 55337195, "link": "https://stackoverflow.com/questions/55337195/regex-to-select-newlines-in-between-quotation-marks/55484797#55484797", "title": "Regex to select newlines in between quotation marks", "body": "<p>If your multiline strings don't include commas (right before the line breaks) then you could use that in json every line has to end with <code>,</code>, <code>{</code>, or <code>[</code> or the next line has to start with <code>}</code> or <code>]</code>:</p>\n\n<pre><code>json_string.gsub(/(?&lt;!,|\\{|\\[)\\n(?!\\s*[}\\]])/, '\\n')\n</code></pre>\n\n<p>If you have commas in your strings (or curly and square brackets) you can improve this approach by adding more details to the list of valid line endings:</p>\n\n<pre><code>valid_line_ends = %w(true, false, \", }, ], { [)\nline_end_matcher = valid_line_ends.map(&amp;Regexp.method(:escape)).join('|')\njson_string.gsub(/(?&lt;!#{line_end_matcher})\\n(?!\\s*[}\\]])/, '\\n')\n</code></pre>\n"}], "owner": {"reputation": 862, "user_id": 5269447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d355fcfdfb38bfec218c4239da62f2?s=128&d=identicon&r=PG&f=1", "display_name": "0x777C", "link": "https://stackoverflow.com/users/5269447/0x777c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 401, "favorite_count": 0, "accepted_answer_id": 55422411, "answer_count": 5, "score": -1, "last_activity_date": 1554846753, "creation_date": 1553514725, "last_edit_date": 1553854235, "question_id": 55337195, "link": "https://stackoverflow.com/questions/55337195/regex-to-select-newlines-in-between-quotation-marks", "title": "Regex to select newlines in between quotation marks", "body": "<p>I have a string in Ruby that resembles the following:  </p>\n\n<pre><code>{\n  \"a boolean\": true,\n  \"multiline\": \"\nmy\nmultiline\nvalue\n\",\n  \"a normal key\": \"a normal value\"\n}\n</code></pre>\n\n<p>I would like to match only the newline characters in the substring:</p>\n\n<pre><code>\"\nmy\nmultiline\nvalue\n\",\n</code></pre>\n\n<p>This is so that I can replace them with escaped newline characters. The aim here is to make the JSON easier to work with in the long run.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "jbuilder"], "comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1553517683, "post_id": 55337135, "comment_id": 97401193, "body": "You&#39;ve cut the error message into halve, what does the last bit say? <i>&quot;NameError: undefined local variable or method `id&#39; for .........&quot;</i>"}], "answers": [{"comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 1, "creation_date": 1553517429, "post_id": 55337433, "comment_id": 97401039, "body": "Adding the foreign key would still allow empty values. You&#39;d also have to add <code>change_column_null :items, :user_id, false</code> (if not already present)."}, {"owner": {"reputation": 1235, "user_id": 8229332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xavfX.jpg?s=128&g=1", "display_name": "negabaro", "link": "https://stackoverflow.com/users/8229332/negabaro"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1553518912, "post_id": 55337433, "comment_id": 97401953, "body": "@3limin4t0r  I got a hint from your answer and found casuse of the problem."}, {"owner": {"reputation": 1235, "user_id": 8229332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xavfX.jpg?s=128&g=1", "display_name": "negabaro", "link": "https://stackoverflow.com/users/8229332/negabaro"}, "edited": false, "score": 0, "creation_date": 1553519004, "post_id": 55337433, "comment_id": 97402005, "body": "The cause of the error was that nil was in some columns of user_id.  thank you very much!"}], "tags": [], "owner": {"reputation": 2056, "user_id": 1838300, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/852556ae4382295d360e311debc5038a?s=128&d=identicon&r=PG", "display_name": "Sajad Rastegar", "link": "https://stackoverflow.com/users/1838300/sajad-rastegar"}, "is_accepted": true, "score": 0, "last_activity_date": 1553521417, "last_edit_date": 1553521417, "creation_date": 1553515574, "answer_id": 55337433, "question_id": 55337135, "link": "https://stackoverflow.com/questions/55337135/how-to-return-values-in-json-that-contain-models-to-be-associated-using-jbuilder/55337433#55337433", "title": "how to return values in json that contain models to be associated using JBuilder", "body": "<p>It seems that some items in <code>@items</code> list, doesn't have associated user, or their <code>user_id</code> field is <code>nil</code>. Then <code>item.user</code> would be <code>nil</code>. When you do <code>nil.image_url</code> you get <code>NoMethodError: undefined method 'image_url' for nil:NilClass</code> .</p>\n\n<p>You could add a foreign key constraint between <code>Item</code> and <code>User</code> in your migration, to avoid problems like this:</p>\n\n<pre><code>add_foreign_key :items, :users\n</code></pre>\n\n<p>NOTE:<br>\nAdding the foreign key would still allow empty values. You'd also have to add the following in your migration file to avoid empty values in <code>user_id</code> column:</p>\n\n<pre><code>change_column_null :items, :user_id, false\n</code></pre>\n\n<p>Thanks to @3limin4t0r for pointing this out. </p>\n"}, {"comments": [{"owner": {"reputation": 1235, "user_id": 8229332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xavfX.jpg?s=128&g=1", "display_name": "negabaro", "link": "https://stackoverflow.com/users/8229332/negabaro"}, "edited": false, "score": 0, "creation_date": 1553598902, "post_id": 55341514, "comment_id": 97435194, "body": "Thank you for your advice. I&#39;ll make change it"}], "tags": [], "owner": {"reputation": 91, "user_id": 11255747, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OAmc4sMUtyI/AAAAAAAAAAI/AAAAAAAAACE/I-rwjsc3r8o/photo.jpg?sz=128", "display_name": "Richard Legacy", "link": "https://stackoverflow.com/users/11255747/richard-legacy"}, "is_accepted": false, "score": 0, "last_activity_date": 1553529070, "last_edit_date": 1553529070, "creation_date": 1553528585, "answer_id": 55341514, "question_id": 55337135, "link": "https://stackoverflow.com/questions/55337135/how-to-return-values-in-json-that-contain-models-to-be-associated-using-jbuilder/55341514#55341514", "title": "how to return values in json that contain models to be associated using JBuilder", "body": "<p><strong>app/models/user.rb</strong></p>\n\n<pre><code>include UserImageUploader[:image]\nhas_many :item\n</code></pre>\n\n<p>should be <code>has_many :items</code>, not terribly confident on this, but this may be the reason you're finding blank columns in your db. A <code>has_many, belongs_to</code> relationship should default to required. </p>\n"}], "owner": {"reputation": 1235, "user_id": 8229332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xavfX.jpg?s=128&g=1", "display_name": "negabaro", "link": "https://stackoverflow.com/users/8229332/negabaro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 55337433, "answer_count": 2, "score": 0, "last_activity_date": 1553529070, "creation_date": 1553514523, "question_id": 55337135, "link": "https://stackoverflow.com/questions/55337135/how-to-return-values-in-json-that-contain-models-to-be-associated-using-jbuilder", "title": "how to return values in json that contain models to be associated using JBuilder", "body": "<p>I would like to return values in json that contain models to be associated using JBuilder.\nBut I don\u2019t know how to do it. And I encounter the error that \u201cundefined method  xx\u201d\nHere is my setting of rails.</p>\n\n<p>Model </p>\n\n<p><strong>app/models/item.rb</strong></p>\n\n<pre><code>belongs_to :user\n</code></pre>\n\n<p><strong>app/models/user.rb</strong></p>\n\n<pre><code>include UserImageUploader[:image]\nhas_many :item\n</code></pre>\n\n<p><strong>vim app/uploaders/user_image_uploader.rb</strong></p>\n\n<pre><code># MiniMagick\nrequire 'image_processing/mini_magick'\n\nclass UserImageUploader &lt; Shrine\n  include ImageProcessing::MiniMagick\n  # The determine_mime_type plugin allows you to determine and store the actual MIME type of the file analyzed from file content.\n  plugin :determine_mime_type\n  plugin :store_dimensions\n  plugin :pretty_location\n  plugin :processing\n  plugin :recache\n  #The versions plugin enables your uploader to deal with versions,\n  #by allowing you to return a Hash of files when processing.\n  plugin :versions\n\n  process(:store) do |io, context|\n    original = io.download\n\n    thumbnail = ImageProcessing::MiniMagick\n      .source(original)\n      .resize_to_limit!(600, nil)\n\n    original.close!\n\n    { original: io, thumbnail: thumbnail }\n  end\n\n  #plugin :versions\n\n  #plugin :delete_promoted\n  #plugin :delete_raw\nend\n</code></pre>\n\n<p><strong>items_controller.rb</strong></p>\n\n<pre><code>@items = Item.includes(:user).page(params[:page] ||= 1).per(8).order('created_at DESC')\nrender 'index', formats: 'json', handlers: 'jbuilder'\n</code></pre>\n\n<p><strong>Item/index.json.jbuilder</strong></p>\n\n<pre><code>json.array! @items do |t|\n  json.id t.id  //get the value normally\n  json.created_at t.created_at //get the value normally \n  Json.user_id t.user.id  //undefined method `id\u2019 \n  json.user_original_img t.user.image_url(:original) //undefined method `image_url' \nend\n</code></pre>\n\n<p>As above, I could not get the value of the model being associated.</p>\n\n<p>By the way, I could check the value correctly with rails console.</p>\n\n<p><strong>Bundle exec rails c</strong></p>\n\n<pre><code>Item.first.user.image_url(:original)\n\n  Item Load (1.5ms)  SELECT  `items`.* FROM `items` ORDER BY `items`.`id` ASC LIMIT 1\n  User Load (0.7ms)  SELECT  `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1\n=&gt; \"https://xx.s3.ap-northeast-1.amazonaws.com/store/user/1/image/original-xx\u201d\n\nItem.first.user.id\n   (19.0ms)  SET NAMES utf8mb4,  @@SESSION.sql_mode = CONCAT(CONCAT(@@sql_mode, ',STRICT_ALL_TABLES'), ',NO_AUTO_VALUE_ON_ZERO'),  @@SESSION.sql_auto_is_null = 0, @@SESSION.wait_timeout = 2147483\n  Item Load (0.9ms)  SELECT  `items`.* FROM `items` ORDER BY `items`.`id` ASC LIMIT 1\n  User Load (0.8ms)  SELECT  `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1\n=&gt; 1\n</code></pre>\n\n<p>Let me know what points I am wrong with.</p>\n\n<p>Thank you for reading my question.</p>\n"}, {"tags": ["ruby", "apache", "passenger", "padrino"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1553514037, "post_id": 55336597, "comment_id": 97399105, "body": "The error message says: <i>&quot;Error details saved to: /tmp/passenger-error-gY5lcp.html&quot;</i>. Did you check that error document? Please post that too."}, {"owner": {"reputation": 2487, "user_id": 1903696, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/hsCPl.jpg?s=128&g=1", "display_name": "Ashwin Yaprala", "link": "https://stackoverflow.com/users/1903696/ashwin-yaprala"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1553515327, "post_id": 55336597, "comment_id": 97399799, "body": "@spickermann, &quot;An error occurred while starting up the preloader: it did not write a startup response in time. Please read this article for more information about this problem.&quot; is the error message from the HTML file, the other data is the environment variables."}], "owner": {"reputation": 2487, "user_id": 1903696, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/hsCPl.jpg?s=128&g=1", "display_name": "Ashwin Yaprala", "link": "https://stackoverflow.com/users/1903696/ashwin-yaprala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553512643, "creation_date": 1553512643, "question_id": 55336597, "link": "https://stackoverflow.com/questions/55336597/passenger-apache-is-not-spawning-padrino-app", "title": "Passenger + Apache is not spawning padrino app", "body": "<p><strong>Problem</strong>: My application is not starting, I believe it is because <strong>Passenger spawn server</strong> is not working after apache2 has started.</p>\n\n<p>Following is the error after apache2 has started</p>\n\n<p><strong>/etc/init.d/apache2 start</strong></p>\n\n<p><strong>tail -f /var/log/myapp/production.log</strong></p>\n\n<pre><code>[ 2019-03-25 15:56:39.6282 15170/7fb14e35c700 age/Cor/CoreMain.cpp:532 ]: Signal received. Gracefully shutting down... (send signal 2 more time(s) to force shutdown)\n[ 2019-03-25 15:56:39.6282 15178/7f11376e1700 age/Ust/UstRouterMain.cpp:422 ]: Signal received. Gracefully shutting down... (send signal 2 more time(s) to force shutdown)\n[ 2019-03-25 15:56:39.6283 15170/7fb153863780 age/Cor/CoreMain.cpp:901 ]: Received command to shutdown gracefully. Waiting until all clients have disconnected...\n[ 2019-03-25 15:56:39.6284 15178/7f113c972780 age/Ust/UstRouterMain.cpp:492 ]: Received command to shutdown gracefully. Waiting until all clients have disconnected...\n[ 2019-03-25 15:56:39.6285 15170/7fb14dada700 Ser/Server.h:817 ]: [ServerThr.2] Freed 128 spare client objects\n[ 2019-03-25 15:56:39.6286 15170/7fb14dada700 Ser/Server.h:464 ]: [ServerThr.2] Shutdown finished\n[ 2019-03-25 15:56:39.6286 15178/7f11376e1700 Ser/Server.h:464 ]: [UstRouter] Shutdown finished\n[ 2019-03-25 15:56:39.6286 15178/7f1136ee0700 Ser/Server.h:817 ]: [UstRouterApiServer] Freed 0 spare client objects\n[ 2019-03-25 15:56:39.6287 15178/7f1136ee0700 Ser/Server.h:464 ]: [UstRouterApiServer] Shutdown finished\n[ 2019-03-25 15:56:39.6288 15170/7fb11effd700 Ser/Server.h:817 ]: [ApiServer] Freed 0 spare client objects\n[ 2019-03-25 15:56:39.6289 15170/7fb11effd700 Ser/Server.h:464 ]: [ApiServer] Shutdown finished\n[ 2019-03-25 15:56:39.6301 15170/7fb14d258700 Ser/Server.h:817 ]: [ServerThr.3] Freed 128 spare client objects\n[ 2019-03-25 15:56:39.6302 15170/7fb14c9d6700 Ser/Server.h:817 ]: [ServerThr.4] Freed 128 spare client objects\n[ 2019-03-25 15:56:39.6302 15170/7fb14e35c700 Ser/Server.h:817 ]: [ServerThr.1] Freed 128 spare client objects\n[ 2019-03-25 15:56:39.6302 15170/7fb14d258700 Ser/Server.h:464 ]: [ServerThr.3] Shutdown finished\n[ 2019-03-25 15:56:39.6302 15170/7fb11ffff700 Ser/Server.h:817 ]: [ServerThr.5] Freed 128 spare client objects\n[ 2019-03-25 15:56:39.6303 15170/7fb14c9d6700 Ser/Server.h:464 ]: [ServerThr.4] Shutdown finished\n[ 2019-03-25 15:56:39.6303 15170/7fb11ffff700 Ser/Server.h:464 ]: [ServerThr.5] Shutdown finished\n[ 2019-03-25 15:56:39.6303 15170/7fb14e35c700 Ser/Server.h:464 ]: [ServerThr.1] Shutdown finished\n[ 2019-03-25 15:56:39.6305 15178/7f113c972780 age/Ust/UstRouterMain.cpp:523 ]: Passenger UstRouter shutdown finished\n[ 2019-03-25 15:56:39.6305 15170/7fb11f7fe700 Ser/Server.h:817 ]: [ServerThr.6] Freed 128 spare client objects\n[ 2019-03-25 15:56:39.6306 15170/7fb11f7fe700 Ser/Server.h:464 ]: [ServerThr.6] Shutdown finished\n[ 2019-03-25 15:56:39.6645 15205/7f82ee303780 age/Wat/WatchdogMain.cpp:1291 ]: Starting Passenger watchdog...\n[ 2019-03-25 15:56:39.6809 15208/7f7693f84780 age/Cor/CoreMain.cpp:982 ]: Starting Passenger core...\n[ 2019-03-25 15:56:39.6812 15208/7f7693f84780 age/Cor/CoreMain.cpp:235 ]: Passenger core running in multi-application mode.\n[ 2019-03-25 15:56:39.6867 15208/7f7693f84780 age/Cor/CoreMain.cpp:732 ]: Passenger core online, PID 15208\n[ 2019-03-25 15:56:39.7002 15215/7f4b98dd1780 age/Ust/UstRouterMain.cpp:529 ]: Starting Passenger UstRouter...\n[ 2019-03-25 15:56:39.7013 15215/7f4b98dd1780 age/Ust/UstRouterMain.cpp:342 ]: Passenger UstRouter online, PID 15215\n[ 2019-03-25 15:56:39.7154 15170/7fb153863780 age/Cor/CoreMain.cpp:967 ]: Passenger core shutdown finished\n[ 2019-03-25 15:56:41.6136 13822/7fe0ccef7700 age/Cor/App/Implementation.cpp:304 ]: Could not spawn process for application /usr/share/myapp: An error occurred while starting up the preloader: it did not write a startup response in time.\n  Error ID: 1f651915\n  Error details saved to: /tmp/passenger-error-gY5lcp.html\n  Message from application: An error occurred while starting up the preloader: it did not write a startup response in time. Please read &lt;a href=\"https://github.com/phusion/passenger/wiki/Debugging-application-startup-problems\"&gt;this article&lt;/a&gt; for more information about this problem.&lt;br&gt;\n&lt;h2&gt;Raw process output:&lt;/h2&gt;\n(empty)\n\n[ 2019-03-25 15:56:41.6410 13822/7fe0ed2c2700 age/Cor/Con/CheckoutSession.cpp:285 ]: [Client 1-20] Cannot checkout session because a spawning error occurred. The identifier of the error is 1f651915. Please see earlier logs for details about the error.\n[ 2019-03-25 15:56:41.6415 13822/7fe0ed2c2700 age/Cor/Con/CheckoutSession.cpp:285 ]: [Client 1-21] Cannot checkout session because a spawning error occurred. The identifier of the error is 1f651915. Please see earlier logs for details about the error.\n[ 2019-03-25 15:56:41.6416 13822/7fe0eca40700 age/Cor/Con/CheckoutSession.cpp:285 ]: [Client 2-20] Cannot checkout session because a spawning error occurred. The identifier of the error is 1f651915. Please see earlier logs for details about the error.\n[ 2019-03-25 15:56:41.6416 13822/7fe0ce7fc700 age/Cor/Con/CheckoutSession.cpp:285 ]: [Client 6-19] Cannot checkout session because a spawning error occurred. The identifier of the error is 1f651915. Please see earlier logs for details about the error.\n\nPassengerLogLevel 3\n[ 2019-03-25 15:56:41.6419 13822/7fe0ed2c2700 Ser/Server.h:817 ]: [ServerThr.1] Freed 128 spare client objects\n[ 2019-03-25 15:56:41.6420 13822/7fe0ed2c2700 Ser/Server.h:464 ]: [ServerThr.1] Shutdown finished\n[ 2019-03-25 15:56:41.6420 13822/7fe0cf7fe700 age/Cor/Con/CheckoutSession.cpp:285 ]: [Client 4-20] Cannot checkout session because a spawning error occurred. The identifier of the error is 1f651915. Please see earlier logs for details about the error.\n[ 2019-03-25 15:56:41.6422 13822/7fe0cffff700 age/Cor/Con/CheckoutSession.cpp:285 ]: [Client 3-20] Cannot checkout session because a spawning error occurred. The identifier of the error is 1f651915. Please see earlier logs for details about the error.\n[ 2019-03-25 15:56:41.6416 13822/7fe0ceffd700 age/Cor/Con/CheckoutSession.cpp:285 ]: [Client 5-20] Cannot checkout session because a spawning error occurred. The identifier of the error is 1f651915. Please see earlier logs for details about the error.\n[ 2019-03-25 15:56:41.6424 13822/7fe0eca40700 Ser/Server.h:817 ]: [ServerThr.2] Freed 128 spare client objects\n[ 2019-03-25 15:56:41.6424 13822/7fe0eca40700 Ser/Server.h:464 ]: [ServerThr.2] Shutdown finished\n[ 2019-03-25 15:56:41.6426 13822/7fe0ce7fc700 age/Cor/Con/CheckoutSession.cpp:285 ]: [Client 6-20] Cannot checkout session because a spawning error occurred. The identifier of the error is 1f651915. Please see earlier logs for details about the error.\n[ 2019-03-25 15:56:41.6427 13822/7fe0cffff700 Ser/Server.h:817 ]: [ServerThr.3] Freed 128 spare client objects\n[ 2019-03-25 15:56:41.6428 13822/7fe0cffff700 Ser/Server.h:464 ]: [ServerThr.3] Shutdown finished\n[ 2019-03-25 15:56:41.6430 13822/7fe0ce7fc700 Ser/Server.h:817 ]: [ServerThr.6] Freed 128 spare client objects\n[ 2019-03-25 15:56:41.6431 13822/7fe0ce7fc700 Ser/Server.h:464 ]: [ServerThr.6] Shutdown finished\n[ 2019-03-25 15:56:41.6435 13822/7fe0cf7fe700 Ser/Server.h:817 ]: [ServerThr.4] Freed 128 spare client objects\n[ 2019-03-25 15:56:41.6435 13822/7fe0ceffd700 Ser/Server.h:817 ]: [ServerThr.5] Freed 128 spare client objects\n[ 2019-03-25 15:56:41.6436 13822/7fe0cf7fe700 Ser/Server.h:464 ]: [ServerThr.4] Shutdown finished\n[ 2019-03-25 15:56:41.6436 13822/7fe0ceffd700 Ser/Server.h:464 ]: [ServerThr.5] Shutdown finished\n[ 2019-03-25 15:56:41.7198 13822/7fe0f27c9780 age/Cor/CoreMain.cpp:967 ]: Passenger core shutdown finished\n</code></pre>\n\n<p>Apache: 2.4</p>\n\n<p>Phusion Passenger: 5.0.30</p>\n\n<p>Debian: 9 (Stretch)</p>\n\n<p>Ruby framework: Padrino</p>\n\n<p><strong>/etc/apache2/mods-available/passenger.load</strong></p>\n\n<pre><code>LoadModule passenger_module /usr/lib/ruby-flo/lib/ruby/gems/2.1.0/gems/passenger-5.0.30/buildout/apache2/mod_passenger.so\n&lt;IfModule mod_passenger.c&gt;\n  PassengerRoot /usr/lib/ruby-flo/lib/ruby/gems/2.1.0/gems/passenger-5.0.30\n  PassengerDefaultRuby /usr/lib/ruby-flo/bin/ruby\n  PassengerLoadShellEnvvars off\n  PassengerSpawnMethod smart\n&lt;/IfModule&gt;\n</code></pre>\n\n<p><strong>/etc/apache2/sites-available/myapp.conf</strong></p>\n\n<pre><code>PassengerLogLevel 3\nPassengerDebugLogFile /var/log/myapp/production.log\nPassengerDefaultRuby /usr/bin/ruby-flo\n\nListen 28850\n&lt;VirtualHost *:28850&gt;\n   AddDefaultCharset utf-8\n   DocumentRoot /usr/share/myapp/public\n   PassengerAppRoot /usr/share/myapp\n   KeepAlive On\n   KeepAliveTimeout 5\n   MaxKeepAliveRequests 1000\n\n   SetEnv DEPLOY_ENV production\n   SetEnv PADRINO_ENV production\n\n&lt;/VirtualHost&gt;\n\nListen 28852\n&lt;VirtualHost *:28852&gt;\n   AddDefaultCharset utf-8\n   DocumentRoot /usr/share/myapp/public\n   PassengerAppRoot /usr/share/myapp\n\n   SSLEngine On\n   SSLCertificateFile /etc/fk-flo-rubycas-server/ssl/cert.pem\n\n  SetEnv SUPPLY_CHAIN_COMPANY b2b\n  SetEnv FLO_GEM_SERVER http://10.85.147.182/\n  SetEnv DEPLOY_ENV production\n  SetEnv PADRINO_ENV production\n  SetEnv NO_AUTH\n  SetEnv MULTI\n  SetEnv INFER_HEADER\n  SetEnv LDAP_PERM\n  SetEnv MULTI_TENANCY_ENABLED\n  SetEnv DISABLE_COMPANY_CHECK\n  SetEnv BAG_LABEL_MAPPINGS\n\n&lt;/VirtualHost&gt;\n\n&lt;Directory /usr/share/myapp/public&gt;\n   Require all Granted\n   AllowOverride all\n   Options -MultiViews\n&lt;/Directory&gt;\n</code></pre>\n\n<p><strong>$ passenger-memory-stats</strong></p>\n\n<pre><code>Version: 5.0.30\nDate   : 2019-03-25 16:18:12 +0530\nperl: warning: Setting locale failed.\nperl: warning: Please check that your locale settings:\n    LANGUAGE = \"en_IN:en\",\n    LC_ALL = (unset),\n    LC_CTYPE = \"UTF-8\",\n    LANG = \"en_US\"\n    are supported and installed on your system.\nperl: warning: Falling back to a fallback locale (\"en_US\").\nperl: warning: Setting locale failed.\nperl: warning: Please check that your locale settings:\n    LANGUAGE = \"en_IN:en\",\n    LC_ALL = (unset),\n    LC_CTYPE = \"UTF-8\",\n    LANG = \"en_US\"\n    are supported and installed on your system.\nperl: warning: Falling back to a fallback locale (\"en_US\").\n\n---------- Apache processes ----------\nPID    PPID   VMSize    Private  Name\n--------------------------------------\n15955  1      98.7 MB   0.5 MB   /usr/sbin/apache2 -k start\n15990  15955  379.0 MB  0.5 MB   /usr/sbin/apache2 -k start\n15993  15955  379.0 MB  0.5 MB   /usr/sbin/apache2 -k start\n### Processes: 3\n### Total private dirty RSS: 1.43 MB\n\n\n-------- Nginx processes --------\n\n### Processes: 0\n### Total private dirty RSS: 0.00 MB\n\n\n----- Passenger processes ------\nPID    VMSize     Private  Name\n--------------------------------\n15958  414.8 MB   0.9 MB   Passenger watchdog\n15961  1310.1 MB  2.4 MB   Passenger core\n15969  423.0 MB   0.9 MB   Passenger ust-router\n### Processes: 3\n### Total private dirty RSS: 4.18 MB\n</code></pre>\n"}, {"tags": ["regex", "ruby"], "comments": [{"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1553511638, "post_id": 55336290, "comment_id": 97397644, "body": "Try <code>:validation =&gt; &#47;\\Ax\\d{8}@a2z\\.ie\\z&#47;</code>"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1553511963, "post_id": 55336290, "comment_id": 97397845, "body": "If <code>:validation</code> does not work, try replacing it with <code>:pattern</code>"}, {"owner": {"reputation": 43, "user_id": 9946413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f81ec745c86dd1d51f01e1f7c50531ad?s=128&d=identicon&r=PG&f=1", "display_name": "TattooedJoey", "link": "https://stackoverflow.com/users/9946413/tattooedjoey"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1553515600, "post_id": 55336290, "comment_id": 97399984, "body": "@WiktorStribi\u017cew  <code>:validation =&gt; &#47;\\Ax\\d{8}@a2z\\.ie\\z&#47;</code> did not work. <code>:validation =&gt; &#39;&#47;\\Ax\\d{8}@a2z\\.ie\\z&#47;&#39;</code> did not work. <code>:pattern =&gt; &#47;\\Ax\\d{8}@a2z\\.ie\\z&#47;</code> did not work. <code>:pattern =&gt; &#39;&#47;\\Ax\\d{8}@a2z\\.ie\\z&#47;&#39;</code> did not work. :("}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1553515641, "post_id": 55336290, "comment_id": 97400010, "body": "Do not put the regex inside single quotes, it will never work. So, the problem is not just with regex, you need to fix your code."}, {"owner": {"reputation": 43, "user_id": 9946413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f81ec745c86dd1d51f01e1f7c50531ad?s=128&d=identicon&r=PG&f=1", "display_name": "TattooedJoey", "link": "https://stackoverflow.com/users/9946413/tattooedjoey"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1553515687, "post_id": 55336290, "comment_id": 97400034, "body": "@WiktorStribi\u017cew I tried both with and without, none worked."}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 9946413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f81ec745c86dd1d51f01e1f7c50531ad?s=128&d=identicon&r=PG&f=1", "display_name": "TattooedJoey", "link": "https://stackoverflow.com/users/9946413/tattooedjoey"}, "is_accepted": false, "score": 0, "last_activity_date": 1553517570, "creation_date": 1553517570, "answer_id": 55338011, "question_id": 55336290, "link": "https://stackoverflow.com/questions/55336290/embedded-ruby-form-validating-email-with-specific-domain/55338011#55338011", "title": "Embedded Ruby form - validating email with specific domain", "body": "<p>Used an email validator Ruby file instead.</p>\n\n<p>Using Devise as well, if that helps.</p>\n\n<p>In user.rb, add:</p>\n\n<pre><code>validates :email, :presence =&gt; true, :email =&gt; true\n</code></pre>\n\n<p>Create a <code>validators</code> folder in models. Then create email_validator.rb in said folder and add this to it:</p>\n\n<p>(app/models/validators/email_validator.rb) :</p>\n\n<pre><code>require 'mail'\nclass EmailValidator &lt; ActiveModel::EachValidator\n    def validate_each(record,attribute,value)\n        begin\n            m = Mail::Address.new(value)\n            # We must check that value contains a domain, the domain has at least\n            # one '.' and that value is an email address  \n            r = m.domain.present? &amp;&amp; m.domain.match('\\.') &amp;&amp; m.address == value\n            s = m.domain.present? &amp;&amp; m.domain.match('\\@a2z.ie') &amp;&amp; m.address == value\n\n            # Update 2015-Mar-24\n            # the :tree method was private and is no longer available.\n            # t = m.__send__(:tree)\n            # We need to dig into treetop\n            # A valid domain must have dot_atom_text elements size &gt; 1\n            # user@localhost is excluded\n            # treetop must respond to domain\n            # We exclude valid email values like &lt;user@localhost.com&gt;\n            # Hence we use m.__send__(tree).domain\n            # r &amp;&amp;= (t.domain.dot_atom_text.elements.size &gt; 1)\n        rescue\n            r = false\n        end\n        record.errors[attribute] &lt;&lt; (options[:message] || \"is invalid. Please enter xEMPLOYEENUMBER@a2z.ie, e.g. x12345678@a2z.ie\") unless (r &amp;&amp; s)\n    end\nend\n</code></pre>\n\n<p>Wasn't exactly what I wanted, but is somewhat.</p>\n\n<p>Ref: <a href=\"https://github.com/plataformatec/devise/wiki/How-to:-Use-a-custom-email-validator-with-Devise\" rel=\"nofollow noreferrer\">https://github.com/plataformatec/devise/wiki/How-to:-Use-a-custom-email-validator-with-Devise</a></p>\n"}], "owner": {"reputation": 43, "user_id": 9946413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f81ec745c86dd1d51f01e1f7c50531ad?s=128&d=identicon&r=PG&f=1", "display_name": "TattooedJoey", "link": "https://stackoverflow.com/users/9946413/tattooedjoey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553517570, "creation_date": 1553511566, "question_id": 55336290, "link": "https://stackoverflow.com/questions/55336290/embedded-ruby-form-validating-email-with-specific-domain", "title": "Embedded Ruby form - validating email with specific domain", "body": "<p>I am creating an embedded Ruby form and I would like the validation to allow 9 characters before the beginning, but specifcially starting with an 'x', so x12345678@a2z.ie would be a valid email while 12345678@a2z.ie would not be valid. </p>\n\n<p>a2z.ie is the domain and is required.</p>\n\n<p>I have the REGEX code: <code>x+\\d{8}+@a2z.ie</code></p>\n\n<p>The code I have is this:</p>\n\n<pre><code>  &lt;div class=\"form-group\"&gt;\n    &lt;%= f.label :email %&gt;&lt;br /&gt;\n    &lt;%= f.email_field :email, autofocus: true, autocomplete: \"email\", :class =&gt; 'form-control', :validation =&gt; 'x+\\d{8}+@a2z.ie' %&gt;\n  &lt;/div&gt;\n</code></pre>\n\n<p>I know this code is wrong because it still allows any user's email. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "double-quotes", "single-quotes"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 8, "creation_date": 1553509886, "post_id": 55335692, "comment_id": 97396617, "body": "I would use Rubocop. Configure it to use the quotes you prefer and then run <code>rubocop -a</code> to automatically fix all issues."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1553510415, "post_id": 55335692, "comment_id": 97396912, "body": "@spickermann you seem to indeed <i>really trust</i> rubocop. I would go with <code>sed</code> :)"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 5, "creation_date": 1553511047, "post_id": 55335692, "comment_id": 97397269, "body": "@AlekseiMatiushkin Indeed, I trust Rubocop more to cover all these encodings, escaping and edge cases. I prefer spending the time to review Rubocop&#39;s changes instead of building a correct regexp in sed."}, {"owner": {"reputation": 134, "user_id": 2184010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ri1NJ.png?s=128&g=1", "display_name": "webgen", "link": "https://stackoverflow.com/users/2184010/webgen"}, "edited": false, "score": 0, "creation_date": 1553512191, "post_id": 55335692, "comment_id": 97397991, "body": "rubocop it is, I didn&#39;t remember it had auto fix capability"}], "answers": [{"tags": [], "owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "is_accepted": true, "score": 5, "last_activity_date": 1553516719, "creation_date": 1553516719, "answer_id": 55337743, "question_id": 55335692, "link": "https://stackoverflow.com/questions/55335692/ruby-on-rails-convert-projectwide-single-quotes-to-double-quotes/55337743#55337743", "title": "Ruby on Rails, convert projectwide single quotes to double quotes", "body": "<p>I would also use <a href=\"https://github.com/rubocop-hq/rubocop\" rel=\"noreferrer\"><code>rubocop</code></a> for that:</p>\n\n<pre><code>rubocop --safe-auto-correct --only \"Style/StringLiterals\" .\n</code></pre>\n\n<p>As <a href=\"https://stackoverflow.com/questions/55335692/ruby-on-rails-convert-projectwide-single-quotes-to-double-quotes#comment97396617_55335692\"><code>spickermann</code></a> suggested</p>\n"}], "owner": {"reputation": 134, "user_id": 2184010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ri1NJ.png?s=128&g=1", "display_name": "webgen", "link": "https://stackoverflow.com/users/2184010/webgen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "accepted_answer_id": 55337743, "answer_count": 1, "score": 3, "last_activity_date": 1553516719, "creation_date": 1553509566, "question_id": 55335692, "link": "https://stackoverflow.com/questions/55335692/ruby-on-rails-convert-projectwide-single-quotes-to-double-quotes", "title": "Ruby on Rails, convert projectwide single quotes to double quotes", "body": "<p>I wonder if anyone has come up with a shortcut to <code>correctly</code> convert ALL single quotes to double quotes in a new rails project. Thank you in advance. I would do that at the end of generating new project with a template.rb</p>\n"}, {"tags": ["ruby", "escaping"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1553504658, "post_id": 55334161, "comment_id": 97393660, "body": "The character <code>\\ </code> is actually not present in the string. But since <code>&quot;&quot; &quot;&quot;</code> is not grammatical, the quotes inside the string are &quot;escaped&quot; when the string gets surrounded by double quotes in its representation. <code>string.gsub(&#39;&quot;&#39;, &#39;&#39;)</code> or <code>string.gsub(&quot;\\&quot;&quot;, &quot;&quot;)</code> or <code>string.gsub(&#47;&quot;&#47;, &#39;&#39;)</code> is fine."}, {"owner": {"reputation": 1653, "user_id": 1318874, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c89dbf404d7c6ac72954595c974e3d9?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Cherevkov", "link": "https://stackoverflow.com/users/1318874/ilya-cherevkov"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1553505284, "post_id": 55334161, "comment_id": 97393962, "body": "@Amadan, thanks, it works in console, but not with the actual code. i have no idea what&#39;s happening"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1553505363, "post_id": 55334161, "comment_id": 97394014, "body": "To simply remove one or more characters from a string, use <a href=\"http://ruby-doc.org/core-2.6.2/String.html#method-i-delete\" rel=\"nofollow noreferrer\"><code>delete</code></a>."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1553505398, "post_id": 55334161, "comment_id": 97394033, "body": "What do you mean by &quot;whitespace is actually <code>&amp;nbsp;</code>&quot;? Do you mean that <code>string</code> is actually <code>&quot;\\&quot;&amp;nbsp;\\&quot;&quot;</code>?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1553505429, "post_id": 55334161, "comment_id": 97394051, "body": "@icherevkov <i>&quot;it works in console, but not with the actual code&quot;</i> \u2013 what <i>is</i> your actual code?"}, {"owner": {"reputation": 1653, "user_id": 1318874, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c89dbf404d7c6ac72954595c974e3d9?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Cherevkov", "link": "https://stackoverflow.com/users/1318874/ilya-cherevkov"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1553506141, "post_id": 55334161, "comment_id": 97394469, "body": "@sawa, no, it looks like whitespace, but it&#39;s actually ASCII symbol (code 160)."}, {"owner": {"reputation": 1653, "user_id": 1318874, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c89dbf404d7c6ac72954595c974e3d9?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Cherevkov", "link": "https://stackoverflow.com/users/1318874/ilya-cherevkov"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1553506460, "post_id": 55334161, "comment_id": 97394674, "body": "@Stefan, i updated the question"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1553506977, "post_id": 55334161, "comment_id": 97394944, "body": "<code>names.map { |name| name.delete(&#39;&quot;&#39;) }</code> works for me just fine for your example data."}, {"owner": {"reputation": 1653, "user_id": 1318874, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c89dbf404d7c6ac72954595c974e3d9?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Cherevkov", "link": "https://stackoverflow.com/users/1318874/ilya-cherevkov"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1553507779, "post_id": 55334161, "comment_id": 97395387, "body": "@Stefan <code>names.map { |name| name.delete(&#39;&quot;&#39;) }.map(&amp;:inspect)</code> shows characters are still there"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1553507969, "post_id": 55334161, "comment_id": 97395497, "body": "@icherevkov because you added <code>.map(&amp;:inspect)</code>"}, {"owner": {"reputation": 1653, "user_id": 1318874, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c89dbf404d7c6ac72954595c974e3d9?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Cherevkov", "link": "https://stackoverflow.com/users/1318874/ilya-cherevkov"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1553510699, "post_id": 55334161, "comment_id": 97397077, "body": "@Stefan Looks like I was overcomplicating"}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1553512286, "post_id": 55334161, "comment_id": 97398056, "body": "So it means that you want to remove quotes which are <b>inside</b> of the strings too?"}], "answers": [{"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 1, "last_activity_date": 1553505274, "creation_date": 1553505274, "answer_id": 55334498, "question_id": 55334161, "link": "https://stackoverflow.com/questions/55334161/how-to-remove-quotes-from-strings-in-an-array/55334498#55334498", "title": "How to remove quotes from strings in an array?", "body": "<pre><code>string.delete(\"\\\"\")\n# =&gt; \" \"\n</code></pre>\n\n<p>or</p>\n\n<pre><code>string.tr(\"\\\"\", \"\")\n# =&gt; \" \"\n</code></pre>\n"}], "owner": {"reputation": 1653, "user_id": 1318874, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c89dbf404d7c6ac72954595c974e3d9?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Cherevkov", "link": "https://stackoverflow.com/users/1318874/ilya-cherevkov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 55334498, "answer_count": 1, "score": 0, "last_activity_date": 1553510130, "creation_date": 1553504064, "last_edit_date": 1553510130, "question_id": 55334161, "link": "https://stackoverflow.com/questions/55334161/how-to-remove-quotes-from-strings-in-an-array", "title": "How to remove quotes from strings in an array?", "body": "<p>Assuming I have the following input:</p>\n\n<pre><code>names = [\"\\\"\u041f\u0435\u0442\u0440 \u0421\u0435\u0440\u0433\u0435\u0435\u0432\u0438\u0447\\\"\", \"\\\"\u041a\u0443\u0440\u0441\u0430\u0442\u043e\u0432 \u0420\u043e\u043c\u0430\u043d\\\"\", \"\\\" \\\"\", \"\\\"\u041f\u0430\u0432\u0435\u043b2 \u041e\u043b\u0435\u0433\u043e\u0432\u0438\u0447\\\"\", \"\\\"\u0418\u043b\u044c\u044f \u0438\u0432\u0430\u043d\u043e\u0432\u0438\u0447\\\"\", \"\\\" \\\"\"]\n</code></pre>\n\n<p>Each whitespace is actually a non-breaking space (U+00A0).</p>\n\n<p>How do I remove <code>\\\"</code> in pure ruby, so the following is true:</p>\n\n<pre><code>p names\n=&gt; [\"\u041f\u0435\u0442\u0440 \u0421\u0435\u0440\u0433\u0435\u0435\u0432\u0438\u0447\", \"\u041a\u0443\u0440\u0441\u0430\u0442\u043e\u0432 \u0420\u043e\u043c\u0430\u043d\", \" \", \"\u041f\u0430\u0432\u0435\u043b2 \u041e\u043b\u0435\u0433\u043e\u0432\u0438\u0447\", \"\u0418\u043b\u044c\u044f \u0438\u0432\u0430\u043d\u043e\u0432\u0438\u0447\", \" \"]\n</code></pre>\n\n<p>I tried:</p>\n\n<pre><code>names.map { |i| i.gsub(/[\\\"]/, \"\")}.map(&amp;:inspect)\nnames.map { |i| i.delete('\\\\\"')}.map(&amp;:inspect)\nnames.map { |i| i.gsub('\\\\\"', '')}.map(&amp;:inspect)\n</code></pre>\n\n<p>Nothing seems to work.</p>\n"}, {"tags": ["arrays", "ruby", "mutable"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1553495183, "post_id": 55332152, "comment_id": 97389687, "body": "Never do <code>puts foo.inspect</code>, as it is equivalent to <code>p foo</code>, and you should use the latter."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1553496601, "post_id": 55332152, "comment_id": 97390202, "body": "\u201cyou should use the latter\u201d\u2014says who?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1553526063, "post_id": 55332152, "comment_id": 97406422, "body": "@sawa how is that &quot;equivalent&quot;? <code>puts foo.inspect</code> will print the object and return <code>nil</code>. <code>p foo</code> will print the object (via inspect) and return the object."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1553529645, "post_id": 55332152, "comment_id": 97408641, "body": "@engineersmnky I was not accurate. Their outputs are the same, and for the purpose in this context, they do not make difference."}], "answers": [{"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 3, "last_activity_date": 1553495461, "last_edit_date": 1553495461, "creation_date": 1553494747, "answer_id": 55332199, "question_id": 55332152, "link": "https://stackoverflow.com/questions/55332152/why-does-map-function-mutate-array-of-objects-when-operating-on-each-elements-a/55332199#55332199", "title": "Why does map function mutate array of objects when operating on each element&#39;s attribute?", "body": "<p>You cloned the <em>array</em> containing <code>Person</code> references, but you did not change the array; you changed the <code>Person</code> instances themselves. <code>clone</code> is so-called \"shallow clone\", which copies only the receiver object, but none of the objects whose references it may contain.</p>\n\n<p>In real-world logic: you took a piece of paper on which you wrote \"Jenny, Timmy\". Then you copied it to another piece of paper. You then took the first piece of paper, found the people it refered to, and gave them an apple. Then you took the second piece of paper, found the people on it, and wondered where <em>their</em> apples came from. But there's only one Timmy, only one Jenny: you give the first list's Jenny an apple, the second list's Jenny also has one.</p>\n\n<p>If you want to clone something, clone <em>Jenny</em>.</p>\n\n<pre><code>array.map { |person|\n  person.clone.yield_self { |clone|\n    clone.email = clone.email.upcase\n  }\n}\n</code></pre>\n\n<p>(Note that I didn't use <code>clone.email.upcase!</code>. The reason is the same reason all over again: if you clone an object, they will both use the same string for <code>email</code>. <code>upcase!</code> changes that string, which would uppercase both clone's email and the original's email. Thus, we make a new email string for the clone.)</p>\n\n<p>Things like this are best understood by stepping through the visualisation using <a href=\"http://pythontutor.com/ruby.html#mode=edit\" rel=\"nofollow noreferrer\">this tool</a>. However, the tool runs Ruby 2.2, which doesn't know about <code>yield_self</code>; this code is equivalent:</p>\n\n<pre><code>array.map { |person|\n  clone = person.clone\n  clone.email = clone.email.upcase\n  clone\n}\n</code></pre>\n\n<p>You could also write this, though it won't visualise as clearly:</p>\n\n<pre><code>array.map(&amp;:clone).map { |clone|\n  clone.email = clone.email.upcase\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10297271, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uW12Y9JMC1s/AAAAAAAAAAI/AAAAAAAAAI4/Q5QDpadHl3s/photo.jpg?sz=128", "display_name": "Jin", "link": "https://stackoverflow.com/users/10297271/jin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553495514, "creation_date": 1553494469, "last_edit_date": 1553495514, "question_id": 55332152, "link": "https://stackoverflow.com/questions/55332152/why-does-map-function-mutate-array-of-objects-when-operating-on-each-elements-a", "title": "Why does map function mutate array of objects when operating on each element&#39;s attribute?", "body": "<p>I have an array of objects:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Person\n  attr_accessor :email\n\n  def initialize(email)\n    @email = email\n  end\nend\n\narray = [\n  Person.new('hello@gmail.com'),\n  Person.new('world@gmail.com')\n]\n</code></pre>\n\n<p>I created a clone from the original array to perform map function, and then I mapped over each element to make its email attribute become uppercase:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>clone = array.clone\nclone.map { |obj|\n  obj.email.upcase!\n  obj\n}\n\nputs array.inspect # why is the original being mutated\nputs clone.inspect\n</code></pre>\n\n<p>It mutates the original array. I have experimented with both <code>dup</code> and <code>clone</code>. and I get the same result. Why does <code>map</code> mutate the objects when operating on each element's attribute?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "opalrb", "hyperstack"], "answers": [{"tags": [], "owner": {"reputation": 2584, "user_id": 859491, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6951e58d024aa7812271f8d52ff31646?s=128&d=identicon&r=PG", "display_name": "Mitch VanDuyn", "link": "https://stackoverflow.com/users/859491/mitch-vanduyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1553520177, "creation_date": 1553520177, "answer_id": 55338806, "question_id": 55331767, "link": "https://stackoverflow.com/questions/55331767/is-there-a-way-to-disconnect-console-messaging-from-hyperstack-message-queue/55338806#55338806", "title": "Is there a way to disconnect console messaging from Hyperstack message queue?", "body": "<p>If the rails server is not up it will not try to send messages (however see note at end)</p>\n\n<p>But the case of a rake task that you want to run while the server IS up, is interesting.  I don't think there is any published way to turn off the \"remote process -> server\" push, but this patch will accomplish the same:</p>\n\n<pre><code>module Hyperstack \n  def self.send_to_server(*args) \n    # drop the message on the floor\n  end\nend\n</code></pre>\n\n<p>Just stick that in the rake task.</p>\n\n<p>Regarding the server \"not being up\" the one case that does not work is if the server is in fact \"up\" but simply never responds.  See <a href=\"https://github.com/hyperstack-org/hyperstack/issues/144\" rel=\"nofollow noreferrer\">https://github.com/hyperstack-org/hyperstack/issues/144</a> for details.  If you are trying to debug a server problem then the same patch above will help until that issue is fixed. </p>\n"}], "owner": {"reputation": 127, "user_id": 4438296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a0462f1ee59ed387dfcb8f0d9734f9d?s=128&d=identicon&r=PG", "display_name": "Michail", "link": "https://stackoverflow.com/users/4438296/michail"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 1, "accepted_answer_id": 55338806, "answer_count": 1, "score": 1, "last_activity_date": 1576084423, "creation_date": 1553492248, "last_edit_date": 1576084423, "question_id": 55331767, "link": "https://stackoverflow.com/questions/55331767/is-there-a-way-to-disconnect-console-messaging-from-hyperstack-message-queue", "title": "Is there a way to disconnect console messaging from Hyperstack message queue?", "body": "<p>In Hyperstack every state change enters a message queue through a websocket mechanism to inform every application client for model/app state changes. So if you update a model from my browser sessions, everyone else connected at the time can see it in their session (if there are the necessary permissions). </p>\n\n<p>This is even done from console 'sessions'. You change a model from Rails console and changes automatically propagate to all connected web clients. </p>\n\n<p>For this to be done the web application part has to be operational (i.e. rails server, must be up and running).</p>\n\n<p>The problem is that there are two situations where you might not want console updates to propagate to the client:</p>\n\n<ol>\n<li><p>when rails server is not operational, for any reason and you want to interact with the application through it's console (until rails server is up again)</p></li>\n<li><p>You want to perform batch updates through console or rake tasks and you don't want the overhead of keeping clients informed.</p></li>\n</ol>\n\n<p>Is there a way to to quickly turn of messaging from the console or some kind of toggle method for that purpose?</p>\n"}]