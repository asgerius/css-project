[{"tags": ["ruby", "logarithm"], "comments": [{"owner": {"reputation": 3024, "user_id": 2799887, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/SXtmE.jpg?s=128&g=1", "display_name": "Paul van Leeuwen", "link": "https://stackoverflow.com/users/2799887/paul-van-leeuwen"}, "edited": false, "score": 0, "creation_date": 1559167386, "post_id": 56369110, "comment_id": 99340815, "body": "When searching the web on &quot;ruby bigdecimal log&quot; there is not a lot I could find that is relevant, at least not at the moment of this writing. So I hope this question on stackoverflow fills that gap. Even more so when it is accompanied by an actual answer :-)"}, {"owner": {"reputation": 893, "user_id": 3394889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3c58b23ce03f0e71522820d13404d5a?s=128&d=identicon&r=PG&f=1", "display_name": "The Wizard", "link": "https://stackoverflow.com/users/3394889/the-wizard"}, "edited": false, "score": 2, "creation_date": 1559169801, "post_id": 56369110, "comment_id": 99341421, "body": "Hmm, surprisingly Math::log10(1000) returns 3.0"}, {"owner": {"reputation": 893, "user_id": 3394889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3c58b23ce03f0e71522820d13404d5a?s=128&d=identicon&r=PG&f=1", "display_name": "The Wizard", "link": "https://stackoverflow.com/users/3394889/the-wizard"}, "edited": false, "score": 0, "creation_date": 1559169883, "post_id": 56369110, "comment_id": 99341451, "body": "You can have a look at the source &amp; docs here: <a href=\"https://ruby-doc.org/core-2.5.1/Math.html#method-c-log10\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.5.1/Math.html#method-c-log10</a>. I am still trying to understand the implementation"}], "answers": [{"tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": false, "score": 0, "last_activity_date": 1559174922, "creation_date": 1559174922, "answer_id": 56370054, "question_id": 56369110, "link": "https://stackoverflow.com/questions/56369110/ruby-exact-number-log-logarithm-function/56370054#56370054", "title": "ruby exact number log (logarithm) function", "body": "<p>You can use the <a href=\"https://en.m.wikipedia.org/wiki/List_of_logarithmic_identities#Changing_the_base\" rel=\"nofollow noreferrer\">change of base formula</a>: If you can calculate a log with base <code>d</code> but you need log base <code>b</code> then <code>log_b(n) = log_d(n) / log_d(b)</code>. So:</p>\n\n<pre><code>&gt; BigMath.log(1000, 50) / BigMath.log(10, 50)\n=&gt; 0.3e1\n</code></pre>\n\n<p>Now let's try with something that needs more precision:</p>\n\n<pre><code>&gt; BigMath.log(999, 50) / BigMath.log(10, 50)\n=&gt; 0.2999565488225982308693534399304475375583359282738400141107276831709276456467950527020061473296516829369378125e1\n</code></pre>\n\n<p>Compare that with, say, <a href=\"https://www.wolframalpha.com/input/?i=log_10+999\" rel=\"nofollow noreferrer\">https://www.wolframalpha.com/input/?i=log_10+999</a></p>\n"}, {"tags": [], "owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "is_accepted": false, "score": 3, "last_activity_date": 1559177758, "creation_date": 1559177758, "answer_id": 56370318, "question_id": 56369110, "link": "https://stackoverflow.com/questions/56369110/ruby-exact-number-log-logarithm-function/56370318#56370318", "title": "ruby exact number log (logarithm) function", "body": "<p>You have encountered a limitation of floating point numbers here. <a href=\"https://ruby-doc.org/core-2.6.3/Float.html\" rel=\"nofollow noreferrer\"><code>Float</code>s typically have a precision of 15 decimal places in Ruby</a>, but the value <code>2.9999999999999996</code> shows 16 decimal places of (unreliable) precision.</p>\n\n<p>To get back to a reliable precision, round to 15 decimal places:</p>\n\n<pre><code>&gt;&gt; Math::log(1000, 10)\n=&gt; 2.9999999999999996\n&gt;&gt; Math::log(1000, 10).round(15)\n=&gt; 3.0\n</code></pre>\n\n<p>The C language specification <a href=\"http://port70.net/~nsz/c/c11/n1570.html#5.2.4.2.2p11\" rel=\"nofollow noreferrer\">only <em>requires</em> 10 significant decimal places</a> for a <code>double</code>, so it is possible that a Ruby implementation would have <code>Float</code>s with fewer than 15 significant decimal places, but still it is much more common to see 15 significant decimal places here.</p>\n"}], "owner": {"reputation": 3024, "user_id": 2799887, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/SXtmE.jpg?s=128&g=1", "display_name": "Paul van Leeuwen", "link": "https://stackoverflow.com/users/2799887/paul-van-leeuwen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1559177758, "creation_date": 1559167313, "question_id": 56369110, "link": "https://stackoverflow.com/questions/56369110/ruby-exact-number-log-logarithm-function", "title": "ruby exact number log (logarithm) function", "body": "<p>As the base 10 logarithm of 1000 is 3 you might expect <code>Math::log(1000, 10)</code> to return <code>3</code>. Instead it returns <code>2.9999999999999996</code>.</p>\n\n<p>This is due to the fact floats in Ruby are not exact numbers as discussed for example <a href=\"https://stackoverflow.com/a/38702825/2799887\">here</a>:</p>\n\n<blockquote>\n  <p>Float isn't an exact number representation, as stated in the <a href=\"http://ruby-doc.org/core-2.2.0/Float.html\" rel=\"nofollow noreferrer\">ruby\n  docs</a>:</p>\n  \n  <blockquote>\n    <p>Float objects represent inexact real numbers using the native architecture's double-precision floating point representation.</p>\n  </blockquote>\n  \n  <p>This not ruby fault, as floats can only be represented by a fixed\n  number of bytes and therefor cannot store decimal numbers correctly.</p>\n  \n  <p>Alternatively, you can use ruby <a href=\"http://ruby-doc.org/core-2.2.0/Rational.html\" rel=\"nofollow noreferrer\">Rational</a> or <a href=\"http://ruby-doc.org/stdlib-1.9.3/libdoc/bigdecimal/rdoc/BigDecimal.html\" rel=\"nofollow noreferrer\">BigDecimal</a></p>\n</blockquote>\n\n<p>Sadly when calling <code>Math::log(BigDecimal('1000'), BigDecimal('10'))</code> the result is exactly the same. Same goes for <code>Math::log(Rational('1000'), Rational('10'))</code>. There is also a <code>BigMath::log</code> which <a href=\"https://ruby-doc.org/stdlib-2.5.1/libdoc/bigdecimal/rdoc/BigMath.html#method-c-log\" rel=\"nofollow noreferrer\">does something completely different</a>.</p>\n\n<p>Now the big question is: how can we calculate the base 10 logarithm of 1000 such that we get the exact result: <code>3</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1559188016, "post_id": 56368699, "comment_id": 99344936, "body": "Add code of related models, please. Check if you renamed all files. Try to run <code>spring stop &amp;&amp; rake routes | grep notices</code>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1559208006, "post_id": 56368699, "comment_id": 99351816, "body": "^^ This. My guess is it&#39;s some sort of cacheing issue. Are you using <code>spring</code>? Or <code>zeus</code>? Or something odd with docker perhaps?"}, {"owner": {"reputation": 3951, "user_id": 392119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b5f65f27919366ded4e7b1901d75f1ec?s=128&d=identicon&r=PG&f=1", "display_name": "hraesvelgr", "link": "https://stackoverflow.com/users/392119/hraesvelgr"}, "edited": false, "score": 0, "creation_date": 1559227287, "post_id": 56368699, "comment_id": 99361150, "body": "I&#39;ve added the relation part of all of the model classes involved. I did a comp search of the project yesterday looking for references to the old name and I didn&#39;t spot any. I&#39;m using Rubymine, so no spring/zeus or docker. I agree that it seems like some sort of caching issue, though bizarre that only the member routes, but not the collection routes get hit."}, {"owner": {"reputation": 3951, "user_id": 392119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b5f65f27919366ded4e7b1901d75f1ec?s=128&d=identicon&r=PG&f=1", "display_name": "hraesvelgr", "link": "https://stackoverflow.com/users/392119/hraesvelgr"}, "edited": false, "score": 0, "creation_date": 1559233591, "post_id": 56368699, "comment_id": 99364514, "body": "Not that using Rubymine precludes any of the above, just using the stock setup. Also, I killed and restarted the server, so I&#39;m not sure where it would be getting cached."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1559291994, "post_id": 56368699, "comment_id": 99382049, "body": "I don&#39;t think your choice of IDE (rubymine) has any relevance to potential causes of cacheing (spring, zeus, docker, ...). What happens if you run <b><code>bundle exec</code></b> <code>rake routes</code>? When you say &quot;I did a complete search of the project ... and didn&#39;t spot any&quot;, I can see at least <i>one</i> reference: <code>export_serves_csv</code>. Now this itself isn&#39;t the problem of course, but it does make me a little suspicious that you&#39;ve missed something in your search. <i>For example</i>, maybe your project mounts a rails engine, and the reference is in another gem?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1559292101, "post_id": 56368699, "comment_id": 99382084, "body": "Does the database table still exist? What references are there to <code>serve</code> in <code>app&#47;</code> or <code>lib&#47;</code> or <code>config&#47;</code> or <code>db&#47;</code>? Did you run all database migrations? ... I&#39;m really just guessing here, because I don&#39;t know how to reproduce the problem (although I realise that if <i>you</i> knew, you presumably wouldn&#39;t be asking this question ;))"}, {"owner": {"reputation": 3951, "user_id": 392119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b5f65f27919366ded4e7b1901d75f1ec?s=128&d=identicon&r=PG&f=1", "display_name": "hraesvelgr", "link": "https://stackoverflow.com/users/392119/hraesvelgr"}, "edited": false, "score": 0, "creation_date": 1559367511, "post_id": 56368699, "comment_id": 99406305, "body": "The db table does not still exist. There are references to serve in app, but none of them should matter. Most of them are calls to what should be the defunct path helpers. Some of the controller methods are still left. I did the comp search and looked at each individual file to see if it should matter. Theoretically, the routes file should be completely agnostic to the contents of app/, lib/, or db/ provided I&#39;m not calling routes.draw somewhere else, which I am not."}, {"owner": {"reputation": 3951, "user_id": 392119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b5f65f27919366ded4e7b1901d75f1ec?s=128&d=identicon&r=PG&f=1", "display_name": "hraesvelgr", "link": "https://stackoverflow.com/users/392119/hraesvelgr"}, "edited": false, "score": 0, "creation_date": 1559367675, "post_id": 56368699, "comment_id": 99406323, "body": "You&#39;re right and I&#39;m dumb. I used the &quot;smart refactor&quot; in rubymine to do the refactor and it looks like it added an inflection from &#39;serve&#39; to notices which is what was causing the issue. If you want to put that as the answer, I&#39;ll accept."}], "owner": {"reputation": 3951, "user_id": 392119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b5f65f27919366ded4e7b1901d75f1ec?s=128&d=identicon&r=PG&f=1", "display_name": "hraesvelgr", "link": "https://stackoverflow.com/users/392119/hraesvelgr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559233516, "creation_date": 1559164870, "last_edit_date": 1559233516, "question_id": 56368699, "link": "https://stackoverflow.com/questions/56368699/rails-member-path-prefixes-not-updating-after-changing-route", "title": "Rails member path prefixes not updating after changing route", "body": "<p>I was doing some refactoring of a Rails application and splitting a table into two. Doing this involves me renaming the original model and then adding a new one and migrating the data. I changed the route for a resource after renaming the table and model. It only updated the prefixes for some of the routes. What's going on here? This resource used to be called 'serves'. Here's the relevant routes:</p>\n\n<pre><code>resources :notices, only: %i[index edit update destroy] do\nget 'close', on: :member\nget 'cancel_or_close', on: :member\nget 'new_lockout', on: :member\npost 'create_lockout', on: :member\nget 'new_five_days', on: :collection\npost 'create_five_days', on: :collection\npost 'batch_update', on: :collection\n# This bit of nuttiness is to solve an issue regarding submitting the same form to multiple actions\npost 'edit_multiple', on: :collection, constraints: CommitParamRouting.new('create_pdfs'), action: 'create_pdfs'\npost 'edit_multiple', on: :collection, constraints: CommitParamRouting.new('create_envelopes'), action: 'create_envelopes'\npost 'edit_multiple', on: :collection, constraints: CommitParamRouting.new('mark_canceled'), action: 'mark_canceled'\npost 'edit_multiple', on: :collection, constraints: CommitParamRouting.new('mark_processing'), action: 'mark_processing'\npost 'edit_multiple', on: :collection, constraints: CommitParamRouting.new('mark_filed'), action: 'mark_filed'\npost 'edit_multiple', on: :collection, constraints: CommitParamRouting.new('mark_out_for_service'), action: 'mark_out_for_service'\npost 'edit_multiple', on: :collection, constraints: CommitParamRouting.new('mark_service_complete'), action: 'mark_service_complete'\npost 'edit_multiple', on: :collection, constraints: CommitParamRouting.new('mark_reconciled'), action: 'mark_reconciled'\npost 'edit_multiple', on: :collection, constraints: CommitParamRouting.new('mark_closed'), action: 'mark_closed'\npost 'edit_multiple', on: :collection, constraints: CommitParamRouting.new('mark_billed'), action: 'mark_billed'\npost 'edit_multiple', on: :collection, constraints: CommitParamRouting.new('get_unbilled_csv'), action: 'get_unbilled_csv'\npost 'edit_multiple', on: :collection, constraints: CommitParamRouting.new('export_serves_csv'), action: 'export_serves_csv'\npost 'edit_multiple', on: :collection, constraints: CommitParamRouting.new('batch_edit'), action: 'batch_edit'\nend\n</code></pre>\n\n<p>Here's the output of 'rake routes'</p>\n\n<pre><code>close_serve GET    /notices/:id/close(.:format)                                                             notices#close\n    cancel_or_close_serve GET    /notices/:id/cancel_or_close(.:format)                                                   notices#cancel_or_close\n        new_lockout_serve GET    /notices/:id/new_lockout(.:format)                                                       notices#new_lockout\n     create_lockout_serve POST   /notices/:id/create_lockout(.:format)                                                    notices#create_lockout\n    new_five_days_notices GET    /notices/new_five_days(.:format)                                                         notices#new_five_days\n create_five_days_notices POST   /notices/create_five_days(.:format)                                                      notices#create_five_days\n     batch_update_notices POST   /notices/batch_update(.:format)                                                          notices#batch_update\n    edit_multiple_notices POST   /notices/edit_multiple(.:format)                                                         notices#create_pdfs\n                          POST   /notices/edit_multiple(.:format)                                                         notices#create_envelopes\n                          POST   /notices/edit_multiple(.:format)                                                         notices#mark_canceled\n                          POST   /notices/edit_multiple(.:format)                                                         notices#mark_processing\n                          POST   /notices/edit_multiple(.:format)                                                         notices#mark_filed\n                          POST   /notices/edit_multiple(.:format)                                                         notices#mark_out_for_service\n                          POST   /notices/edit_multiple(.:format)                                                         notices#mark_service_complete\n                          POST   /notices/edit_multiple(.:format)                                                         notices#mark_reconciled\n                          POST   /notices/edit_multiple(.:format)                                                         notices#mark_closed\n                          POST   /notices/edit_multiple(.:format)                                                         notices#mark_billed\n                          POST   /notices/edit_multiple(.:format)                                                         notices#get_unbilled_csv\n                          POST   /notices/edit_multiple(.:format)                                                         notices#export_serves_csv\n                          POST   /notices/edit_multiple(.:format)                                                         notices#batch_edit\n                  notices GET    /notices(.:format)                                                                       notices#index\n               edit_serve GET    /notices/:id/edit(.:format)                                                              notices#edit\n                    serve PATCH  /notices/:id(.:format)                                                                   notices#update\n                          PUT    /notices/:id(.:format)                                                                   notices#update\n                          DELETE /notices/:id(.:format)  \n</code></pre>\n\n<p>As you can see, some of the routes have updated their prefixes properly, but others still maintain serves (member routes) in their prefix. Why is this happening?</p>\n\n<p>EDIT:\nHere's some of the model code:</p>\n\n<pre><code>class Notice &lt; ApplicationRecord\n  belongs_to :client\n  belongs_to :affiant, optional: true\n  before_save :set_date_of_service, :set_default_billing_status, :set_default_affiant\n\nclass Affiant &lt; ApplicationRecord\n  has_many :zip_codes\n  has_many :notices\n\nclass Client &lt; ApplicationRecord\n  has_many :users\n  has_many :properties\n  has_many :notices\n  has_many :documents\n</code></pre>\n"}, {"tags": ["ruby", "string", "hex", "converters"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1559165342, "post_id": 56368174, "comment_id": 99340237, "body": "The very first thing you do is to forcefully encode the string in a character set that <i>doesn&#39;t have Chinese characters</i>. Of course, they are destroyed after that."}, {"owner": {"reputation": 71, "user_id": 5504626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6b178827a58a5597e684fe648acb6f1?s=128&d=identicon&r=PG&f=1", "display_name": "FShah", "link": "https://stackoverflow.com/users/5504626/fshah"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1559166071, "post_id": 56368174, "comment_id": 99340423, "body": "@J&#246;rgWMittag - Could you provide solution by sharing working sample ?"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 5504626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6b178827a58a5597e684fe648acb6f1?s=128&d=identicon&r=PG&f=1", "display_name": "FShah", "link": "https://stackoverflow.com/users/5504626/fshah"}, "edited": false, "score": 0, "creation_date": 1559165457, "post_id": 56368256, "comment_id": 99340274, "body": "Thanks Aaron,  I have hexdecimal with combination of chinese characters and regular english characters - Try this  &quot;4d442020020000000000000008000000ffffffff0000000011010000b80&zwnj;&#8203;400004d5148524632202&zwnj;&#8203;00000000001000000414&zwnj;&#8203;d5120514d5347514d433&zwnj;&#8203;031202020e778e65c053&zwnj;&#8203;81b2031302e3133302e3&zwnj;&#8203;4302e313131353538363&zwnj;&#8203;23838323736350000000&zwnj;&#8203;0e5b7b2e5ae8ce68890e&zwnj;&#8203;38082e68891e4bbace5b&zwnj;&#8203;086e59ca8e5aea1e6a0b&zwnj;&#8203;8e5b9b6e7a1aee8aea4e&zwnj;&#8203;8aea2e58d95e5908ee58&zwnj;&#8203;f91e8b4a7efbc8ce5b9b&zwnj;&#8203;6e7ab8be58db3e4bba5e&zwnj;&#8203;79fade4bfa1e5bda2e5b&zwnj;&#8203;c8fe9809ae79fa5e682a&zwnj;&#8203;8e3808220e69fa5e79c8&zwnj;&#8203;be8aea2e58d95e4bfa1e&zwnj;&#8203;681afe68896e7aea1e79&zwnj;&#8203;086e794b5e5ad90e58f9&zwnj;&#8203;1e7a5a8&quot;"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "reply_to_user": {"reputation": 71, "user_id": 5504626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6b178827a58a5597e684fe648acb6f1?s=128&d=identicon&r=PG&f=1", "display_name": "FShah", "link": "https://stackoverflow.com/users/5504626/fshah"}, "edited": false, "score": 0, "creation_date": 1559167007, "post_id": 56368256, "comment_id": 99340693, "body": "@FShah That doesn&#39;t work with Aaron&#39;s code because the bytes aren&#39;t valid UTF-8. Do you know what the original encoding is?"}, {"owner": {"reputation": 1597, "user_id": 717626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/303d9f5c2135f14f277775052bcb131b?s=128&d=identicon&r=PG", "display_name": "Aaron Breckenridge", "link": "https://stackoverflow.com/users/717626/aaron-breckenridge"}, "edited": false, "score": 0, "creation_date": 1559175073, "post_id": 56368256, "comment_id": 99342562, "body": "That&#39;s some sort of binary message format. It contains your original message. You may need to use something like bindata to extract messages if you have more in that format: &quot;MD  \\u0002\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\b\\u0000\\u00&zwnj;&#8203;00\\u0000\\xFF\\xFF\\xFF&zwnj;&#8203;\\xFF\\u0000\\u0000\\u00&zwnj;&#8203;00\\u0000\\u0011\\u0001&zwnj;&#8203;\\u0000\\u0000\\xB8\\u00&zwnj;&#8203;04\\u0000\\u0000MQHRF2  \\u0000\\u0000\\u0000\\u0000\\u0001\\u0000\\u0000\\u0000AMQ QMSGQMC01   \\xE7x\\xE6\\\\\\u00058\\e 10.130.40.11155862882765\\u0000\\u0000\\u0000\\u0000\u5df2\u5b8c\u6210\u3002\u6211\u4eec\u5c06\u5728\u5ba1\u6838\u5e76\u786e&zwnj;&#8203;\u8ba4\u8ba2\u5355\u540e\u53d1\u8d27\uff0c\u5e76\u7acb\u5373\u4ee5\u77ed\u4fe1\u5f62\u5f0f\u901a\u77e5\u60a8\u3002 \u67e5\u770b\u8ba2\u5355\u4fe1\u606f\u6216\u7ba1\u7406\u7535\u5b50\u53d1\u7968&quot;"}, {"owner": {"reputation": 71, "user_id": 5504626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6b178827a58a5597e684fe648acb6f1?s=128&d=identicon&r=PG&f=1", "display_name": "FShah", "link": "https://stackoverflow.com/users/5504626/fshah"}, "edited": false, "score": 0, "creation_date": 1559224520, "post_id": 56368256, "comment_id": 99359695, "body": "@AaronBreckenridge - but MD \\u0002\\.... will not be correct output. How do I get correct output in this case ? Could you help me out by providing working sample of this message on online ruby editor link."}], "tags": [], "owner": {"reputation": 1597, "user_id": 717626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/303d9f5c2135f14f277775052bcb131b?s=128&d=identicon&r=PG", "display_name": "Aaron Breckenridge", "link": "https://stackoverflow.com/users/717626/aaron-breckenridge"}, "is_accepted": false, "score": 3, "last_activity_date": 1559162727, "creation_date": 1559162727, "answer_id": 56368256, "question_id": 56368174, "link": "https://stackoverflow.com/questions/56368174/hexdecimal-to-string-convert-ruby/56368256#56368256", "title": "Hexdecimal to String Convert - Ruby", "body": "<p>It's already hex-dumped UTF-8.</p>\n\n<pre><code>str = \"e5b7b2e5ae8ce68890e38082e68891e4bbace5b086e59ca8e5aea1e6a0b8e5b9b6e7a1aee8aea4e8aea2e58d95e5908ee58f91e8b4a7efbc8ce5b9b6e7ab8be58db3e4bba5e79fade4bfa1e5bda2e5bc8fe9809ae79fa5e682a8e3808220e69fa5e79c8be8aea2e58d95e4bfa1e681afe68896e7aea1e79086e794b5e5ad90e58f91e7a5a8\" =&gt; \"e5b7b2e5ae8ce68890e38082e68891e4bbace5b086e59ca8e5aea1e6a0b8e5b9b6e7a1aee8aea4e8aea2e58d95e5908ee58f91e8b4a7efbc8ce5b9b6e7ab8be58db3e4bba5e79fade4bfa1e5bda2e5bc8fe9809ae79fa5e682a8e3808220e69fa5e79c8be8aea2e58d95e4bfa1e681afe68896e7aea1e79086e794b5e5ad90e58f91e7a5a8\"\n[str].pack('H*').force_encoding('utf-8') =&gt; \"\u5df2\u5b8c\u6210\u3002\u6211\u4eec\u5c06\u5728\u5ba1\u6838\u5e76\u786e\u8ba4\u8ba2\u5355\u540e\u53d1\u8d27\uff0c\u5e76\u7acb\u5373\u4ee5\u77ed\u4fe1\u5f62\u5f0f\u901a\u77e5\u60a8\u3002 \u67e5\u770b\u8ba2\u5355\u4fe1\u606f\u6216\u7ba1\u7406\u7535\u5b50\u53d1\u7968\"\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 5504626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6b178827a58a5597e684fe648acb6f1?s=128&d=identicon&r=PG&f=1", "display_name": "FShah", "link": "https://stackoverflow.com/users/5504626/fshah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559163864, "creation_date": 1559162300, "last_edit_date": 1559163864, "question_id": 56368174, "link": "https://stackoverflow.com/questions/56368174/hexdecimal-to-string-convert-ruby", "title": "Hexdecimal to String Convert - Ruby", "body": "<p>I'm trying to convert hexadecimal to string using Ruby and it does not work with some Chinese characters. I am new to Ruby. </p>\n\n<p>Current code is working fine with non-Chinese characters but now code needs to support Chinese characters. It converts HexDecimal to string using ISO-8859-1 and UTF-8 encoder:</p>\n\n<pre><code>extractpayload = \"e5b7b2e5ae8ce68890e38082e68891e4bbace5b086e59ca8e5aea1e6a0b8e5b9b6e7a1aee8aea4e8aea2e58d95e5908ee58f91e8b4a7efbc8ce5b9b6e7ab8be58db3e4bba5e79fade4bfa1e5bda2e5bc8fe9809ae79fa5e682a8e3808220e69fa5e79c8be8aea2e58d95e4bfa1e681afe68896e7aea1e79086e794b5e5ad90e58f91e7a5a8\";\n\ngettransformedfullpayload1 = [extractpayload].pack(\"H*\").force_encoding(\"ISO-8859-1\").encode(\"UTF-8\");\n</code></pre>\n\n<p>repl.it link: \n<a href=\"https://repl.it/@bonsshah/Ruby-Hexdecimal-to-String-Conversion\" rel=\"nofollow noreferrer\">https://repl.it/@bonsshah/Ruby-Hexdecimal-to-String-Conversion</a> </p>\n\n<p>Expected output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>\u5df2\u5b8c\u6210\u3002\u6211\u4eec\u5c06\u5728\u5ba1\u6838\u5e76\u786e\u8ba4\u8ba2\u5355\u540e\u53d1\u8d27\uff0c\u5e76\u7acb\u5373\u4ee5\u77ed\u4fe1\u5f62\u5f0f\u901a\u77e5\u60a8\u3002 \u67e5\u770b\u8ba2\u5355\u4fe1\u606f\u6216\u7ba1\u7406\u7535\u5b50\u53d1\u7968\n</code></pre>\n\n<p>Currently getting this wrong output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>\u00e5\u00b7\u00b2\u00e5\u00ae\u00e6\u00e3\u00e6\u00e4\u00bb\u00ac\u00e5\u00b0\u00e5\u00a8\u00e5\u00ae\u00a1\u00e6\u00a0\u00b8\u00e5\u00b9\u00b6\u00e7\u00a1\u00ae\u00e8\u00ae\u00a4\u00e8\u00ae\u00a2\u00e5\u00e5\u00e5\u00e8\u00b4\u00a7\u00ef\u00bc\u00e5\u00b9\u00b6\u00e7\u00ab\u00e5\u00b3\u00e4\u00bb\u00a5\u00e7\u00ad\u00e4\u00bf\u00a1\u00e5\u00bd\u00a2\u00e5\u00bc\u00e9\u00e7\u00a5\u00e6\u00a8\u00e3 \u00e6\u00a5\u00e7\u00e8\u00ae\u00a2\u00e5\u00e4\u00bf\u00a1\u00e6\u00af\u00e6\u00e7\u00ae\u00a1\u00e7\u00e7\u00b5\u00e5\u00ad\u00e5\u00e7\u00a5\u00a8\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "active-model-serializers"], "comments": [{"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 1, "creation_date": 1559196364, "post_id": 56367382, "comment_id": 99346848, "body": "How WheelDetail should be merged with CarEvent? What WheelDetail does link to what CarEvent?"}, {"owner": {"reputation": 2694, "user_id": 3956205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42aff84cfa87f92797cb54bdea6d0c20?s=128&d=identicon&r=PG", "display_name": "BTL", "link": "https://stackoverflow.com/users/3956205/btl"}, "edited": false, "score": 0, "creation_date": 1559214641, "post_id": 56367382, "comment_id": 99354839, "body": "Do you want to merge objects who have the same <code>id</code> ? Or objects who have the same index ?"}, {"owner": {"reputation": 843, "user_id": 728226, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7840ff7b45650a9687e8b599461c4269?s=128&d=identicon&r=PG", "display_name": "Jau L", "link": "https://stackoverflow.com/users/728226/jau-l"}, "edited": false, "score": 0, "creation_date": 1559235258, "post_id": 56367382, "comment_id": 99365276, "body": "I want to merge objects to have the same index"}], "owner": {"reputation": 843, "user_id": 728226, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7840ff7b45650a9687e8b599461c4269?s=128&d=identicon&r=PG", "display_name": "Jau L", "link": "https://stackoverflow.com/users/728226/jau-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559158553, "creation_date": 1559158553, "question_id": 56367382, "link": "https://stackoverflow.com/questions/56367382/combine-activemodel-serializer-results", "title": "Combine ActiveModel serializer results", "body": "<p>I have the following ActiveModel serializer which parses the following data:</p>\n\n<pre><code>class CarSerializer &lt; ActiveModel::Serializer\nattributes :brand, :wheels, :events\ndef brand\n  { id: object.id, brand_name: object.brand_name }\nend\n\ndef wheels\n  object.wheel_details\nend\n\ndef events\n  object.car_events\nend\nend\n</code></pre>\n\n<p>and the following is the data shows up:</p>\n\n<pre><code>{\n\"car_info\": [\n{\n\"car\": {\n\"id\": 1,\n\"brand_name\": \"opel\"\n},\n\"wheels\": [\n{\n\"id\": 2,\n\"size\": \"23.4\"\n},\n{\n\"id\": 1,\n\"size\": \"22.3\"\n}\n],\n\"events\": [\n{\n\"id\": 1,\n\"event_place\": \"america\"\n},\n{\n\"id\": 1,\n\"event_place\": \"asia\"\n}\n]\n</code></pre>\n\n<p>However, i want the data to look like the following:</p>\n\n<pre><code>{\n\"car_info\": [\n{\n\"car\": {\n\"id\": 1,\n\"brand_name\": \"opel\"\n},\n\"wheels_and_events\": [\n{\n\"id\": 2,\n\"size\": \"23.4\"\n\"event_place\": \"america\"\n},\n{\n\"id\": 1,\n\"size\": \"22.3\"\n\"event_place\": \"asia\"\n}\n]\n</code></pre>\n\n<p>I'm using has_many through associations for 3 tables and one table for the relation.</p>\n"}, {"tags": ["json", "ruby", "rest", "rest-client"], "comments": [{"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 1, "creation_date": 1559157634, "post_id": 56366678, "comment_id": 99337443, "body": "I believe Ruby&#39;s <code>hash[&#39;columns&#39;] = &quot;Col1;Col2;Col3;Col4&quot;</code> will not provide JSON like Postman&#39;s <code>\\&quot;columns\\&quot;:[\\&quot;Col1\\&quot;,\\&quot;Col2\\&quot;,\\&quot;Col3\\&quot;,\\&quot;Col4\\&quot;]</code>."}, {"owner": {"reputation": 51, "user_id": 7347484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f03c79c4e020be9c03ad05343fd6a671?s=128&d=identicon&r=PG&f=1", "display_name": "Ned Redmond", "link": "https://stackoverflow.com/users/7347484/ned-redmond"}, "reply_to_user": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 0, "creation_date": 1559159974, "post_id": 56366678, "comment_id": 99338373, "body": "@PavelMikhailyuk , thanks for making me take another look at that part. I missed that the payload didn&#39;t have an array for &quot;columns&quot; because the escaped json made me cross-eyed. Fixed it."}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1559159912, "post_id": 56367397, "comment_id": 99338345, "body": "OR just pass them as an <code>Array</code> the same way you sent it via postman e.g. <code>[&quot;Col1&quot;,&quot;Col2&quot;,&quot;Col3&quot;,&quot;Col4&quot;]</code> or better still <code>%w(Col1 Col2 Col3 Col4)</code>"}, {"owner": {"reputation": 51, "user_id": 7347484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f03c79c4e020be9c03ad05343fd6a671?s=128&d=identicon&r=PG&f=1", "display_name": "Ned Redmond", "link": "https://stackoverflow.com/users/7347484/ned-redmond"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1559160190, "post_id": 56367397, "comment_id": 99338450, "body": "It&#39;s like that in the post for brevity. It actually comes in as a semicolon-separated string as a parameter. so it&#39;s columns.split(&quot;;&quot;)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1559160389, "post_id": 56367397, "comment_id": 99338537, "body": "You should clarify that since it appears what you meant was <code>hash[&#39;columns&#39;] = hash[&#39;columns&#39;].split(&#39;;&#39;)</code> but what you wrote is I set the columns to a string of <code>&quot;Col1;Col2;Col3;Col4&quot;</code>"}, {"owner": {"reputation": 51, "user_id": 7347484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f03c79c4e020be9c03ad05343fd6a671?s=128&d=identicon&r=PG&f=1", "display_name": "Ned Redmond", "link": "https://stackoverflow.com/users/7347484/ned-redmond"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1559217012, "post_id": 56367397, "comment_id": 99355867, "body": "No, you misunderstand. What I mean is hash[&#39;columns&#39;] (indicating the columns setting) = columns.split(&#39;;&#39;) (indicating the method parameter that provides a semicolon-separated string)"}], "tags": [], "owner": {"reputation": 51, "user_id": 7347484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f03c79c4e020be9c03ad05343fd6a671?s=128&d=identicon&r=PG&f=1", "display_name": "Ned Redmond", "link": "https://stackoverflow.com/users/7347484/ned-redmond"}, "is_accepted": true, "score": 1, "last_activity_date": 1559158634, "creation_date": 1559158634, "answer_id": 56367397, "question_id": 56366678, "link": "https://stackoverflow.com/questions/56366678/postman-post-works-properly-ruby-post-does-not-how-do-i-debug-the-difference/56367397#56367397", "title": "Postman POST works properly; Ruby POST does not. How do I debug the difference?", "body": "<p>After a week of slamming my head against the desk, I realized that all I needed to do is add </p>\n\n<pre><code>.split(\";\")\n</code></pre>\n\n<p>to the end of my columns. Everything works now.</p>\n"}], "owner": {"reputation": 51, "user_id": 7347484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f03c79c4e020be9c03ad05343fd6a671?s=128&d=identicon&r=PG&f=1", "display_name": "Ned Redmond", "link": "https://stackoverflow.com/users/7347484/ned-redmond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 56367397, "answer_count": 1, "score": 0, "last_activity_date": 1559158634, "creation_date": 1559155094, "last_edit_date": 1559155419, "question_id": 56366678, "link": "https://stackoverflow.com/questions/56366678/postman-post-works-properly-ruby-post-does-not-how-do-i-debug-the-difference", "title": "Postman POST works properly; Ruby POST does not. How do I debug the difference?", "body": "<p>I need to do a POST request for an API that takes a JSON payload that contains a nested stringified JSON object. I do a GET request to get the string, parse it (twice!) to get the hash, modify one parameter, then POST it back. When I post via Postman, it goes through as normal. When I post the same string via the Ruby Rest-Client gem, it seems that the POST goes through but there is an issue with how the payload is stringified, providing an unwanted result.</p>\n\n<p>Unfortunately, I cannot refactor this admittedly poorly-designed back end. I can only work with what I have.</p>\n\n<p>I have tried a dozen permutations of this code. Everything going into the post looks correct and identical to the Postman post.</p>\n\n<p>Here is the Postman HTTP-ified, stripped of identifying information:</p>\n\n<pre><code>POST /example/home/api/savesettings HTTP/1.1\nHost: dev.noneofyourbusiness.com\nCookie: identification-gui=f4k3-gu1-5tr1n9\nContent-Type: application/json\n\n{\"settings\":\"{\\\"rows\\\":50,\\\"columns\\\":[\\\"Col1\\\",\\\"Col2\\\",\\\"Col3\\\",\\\"Col4\\\"],\\\"sort\\\":{\\\"column\\\":\\\"Col1\\\",\\\"direction\\\":1},\\\"filters\\\":{\\\"Status\\\":[\\\"Active\\\"]},\\\"widths\\\":{\\\"Id\\\":\\\"170px\\\",\\\"Description\\\":\\\"192px\\\"}}\"}\n</code></pre>\n\n<p>Here is the Ruby code, meant to do the same thing:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>response = RestClient.get(\n        get_url,\n        :accept =&gt; :json,\n        :cookies =&gt; {cookie[:name] =&gt; cookie[:value]}\n    )\n\nhash = JSON.parse(JSON.parse(response))\nhash['columns'] = \"Col1;Col2;Col3;Col4\"\npayload = {:settings =&gt; hash.to_json}.to_json\n\nRestClient.post(\n        post_url,\n        payload,\n        :content_type =&gt; :json,\n        :cookies =&gt; {cookie[:name] =&gt; cookie[:value]}\n    )\n</code></pre>\n\n<p>The Postman request sets the columns correctly. The Ruby request seems to wipe all of the settings, leading me to believe that the JSON is not formatted correctly, but I'm not sure.</p>\n\n<p>When debugging, the Postman body/Rest-Client payload look identical.</p>\n"}, {"tags": ["ruby", "minitest"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1559159188, "post_id": 56366442, "comment_id": 99338069, "body": "can you show how you are including/extending this module?"}, {"owner": {"reputation": 596, "user_id": 1032752, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/882c3ddbfd286ff010276cb96dab3db5?s=128&d=identicon&r=PG", "display_name": "user1032752", "link": "https://stackoverflow.com/users/1032752/user1032752"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1559161813, "post_id": 56366442, "comment_id": 99339074, "body": "@maxpleaner - updated the question. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 275, "user_id": 10976794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h4oit.png?s=128&g=1", "display_name": "Bohdan Sviripa", "link": "https://stackoverflow.com/users/10976794/bohdan-sviripa"}, "is_accepted": false, "score": 0, "last_activity_date": 1559692432, "creation_date": 1559692432, "answer_id": 56452678, "question_id": 56366442, "link": "https://stackoverflow.com/questions/56366442/shared-minitest-tests-in-modules-which-use-classes-to-describe-context/56452678#56452678", "title": "Shared minitest tests in modules which use classes to describe context", "body": "<p>Possible solution: </p>\n\n<pre><code>module Support\n  module SharedControllerTest\n    def self.included(base)\n      base.const_set \"IndexTest\", Class.new(base) {\n        test 'it works' do\n          assert_nil nil\n        end\n      }\n    end\n  end\nend\n\n\nmodule Api::V1\n  module Foos\n    class FoosControllerTest &lt; ActionController::TestCase\n      include Support::SharedControllerTest\n    end\n  end\nend\n</code></pre>\n\n<p>Let me know if you need any help or have any questions.</p>\n"}], "owner": {"reputation": 596, "user_id": 1032752, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/882c3ddbfd286ff010276cb96dab3db5?s=128&d=identicon&r=PG", "display_name": "user1032752", "link": "https://stackoverflow.com/users/1032752/user1032752"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 226, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1559692432, "creation_date": 1559153941, "last_edit_date": 1559161795, "question_id": 56366442, "link": "https://stackoverflow.com/questions/56366442/shared-minitest-tests-in-modules-which-use-classes-to-describe-context", "title": "Shared minitest tests in modules which use classes to describe context", "body": "<p>I have a minitest controller test set up as so:</p>\n\n<pre><code>module Api::V1\n  module Foos\n    class FoosControllerTest &lt; ActionController::TestCase\n\n      class IndexTest &lt; self\n\n        class NotLoggedInTest &lt; self\n\n          test 'it denies access' do\n            perform_request\n            assert_response :unauthorized\n          end\n        end\n\n        class AdminLoggedInTest &lt; self\n\n          def perform_request\n            sign_in admin_user\n            super\n          end\n\n          test 'it allows admins access' do\n            perform_request\n            assert_response :success\n          end\n        end\n\n        def perform_request\n          get :index, format: :json\n        end\n      end\n\n    end\n  end\nend\n</code></pre>\n\n<p>It uses nested classes (e.g. <code>IndexTest</code>) to separate different contexts of the test while still allowing to share some functionality.</p>\n\n<p>Now I need this exact test for another controller so I'm attempting to create a module that when included will dynamically define the different test classes and allow them to inherit from the including class.</p>\n\n<p>For example (this doesn't work):</p>\n\n<pre><code>module Support\n  module SharedControllerTest\n    extend ActiveSupport::Concern\n\n    included do |base|\n      base.const_set 'IndexTest', Class.new(base) do\n\n            # For example\n            test 'it works' do\n              assert_nil nil\n            end\n\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>This fails with a <code>NoMethodError: undefined method 'setup' for #&lt;Class:0x00000004821fc8&gt;</code>.</p>\n\n<p>How would I go about creating a module which when included can dynamically define my different test classes and set them to inherit from the including class?</p>\n\n<p><strong>Edit 1:</strong></p>\n\n<p>I'm attempting to include this module in the controller as so:</p>\n\n<pre><code>module Api::V1\n  module Foos\n    class FoosControllerTest &lt; ActionController::TestCase\n      include Support::SharedControllerTest\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "postgresql", "security", "sql-injection"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1559158851, "post_id": 56366171, "comment_id": 99337925, "body": "Honestly not sure what your <code>password</code> portion looks like but entering <code>&#39; OR 1=1--</code> as the email address will return every user. So yes this is incredibly injectable please don&#39;t try <code>&#39;; DROP TABLE users --</code> for the sake of <a href=\"https://xkcd.com/327/\" rel=\"nofollow noreferrer\">Bobby Tables</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "is_accepted": true, "score": 2, "last_activity_date": 1559157015, "creation_date": 1559157015, "answer_id": 56367057, "question_id": 56366171, "link": "https://stackoverflow.com/questions/56366171/is-this-ruby-psql-safe-from-injection/56367057#56367057", "title": "Is this Ruby PSQL safe from injection?", "body": "<p>Yes, it is definitely SQL injection.\nTo test it you can pass SQL like <code>'; select count(*) from users;</code> in <code>params[:email]</code>.</p>\n\n<p>To avoid SQL injection you could rewrite your code like:</p>\n\n<pre><code>sql2 = User.where(email: params[:email]).limit(1).to_sql\n@result3 = Otherdb.connection.execute(sql2)\n</code></pre>\n\n<p>Just let ActiveRecord <em>escape</em> and <em>sanitize</em> the query and the params for you.</p>\n"}], "owner": {"reputation": 2359, "user_id": 1146032, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c2cc5ea26e46272ef462fd37ef9cf386?s=128&d=identicon&r=PG", "display_name": "A_Elric", "link": "https://stackoverflow.com/users/1146032/a-elric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 56367057, "answer_count": 1, "score": 0, "last_activity_date": 1559157015, "creation_date": 1559152680, "question_id": 56366171, "link": "https://stackoverflow.com/questions/56366171/is-this-ruby-psql-safe-from-injection", "title": "Is this Ruby PSQL safe from injection?", "body": "<p>If I have the following PSQL statement via ruby: </p>\n\n<pre><code>user = User.find_by_email(params[:email])\nsql2 = \"SELECT \\\"users\\\".* FROM \\\"users\\\" WHERE \\\"users\\\".\\\"email\\\" = \\'#{params[:email]}\\' LIMIT 1\"\n@result3 = Otherdb.connection.execute(sql2);\n</code></pre>\n\n<p>Fed by the following form:</p>\n\n<pre><code>&lt;form action=\"/sessions\" accept-charset=\"UTF-8\" method=\"post\"&gt;&lt;input name=\"utf8\" type=\"hidden\" value=\"&amp;#x2713;\" /&gt;&lt;input type=\"hidden\" name=\"authenticity_token\" value=\"tj5rfiJG+yip8gXhMSq/RR/Znu+L/nhkGnqqK78wggRjI85zl4T/wBEkouY8XWlh2aylfKH0lZWjH282fc6Qdg==\" /&gt;\n    &lt;div class=\"login\"&gt;\n      &lt;h1&gt;Login to Web App&lt;/h1&gt;\n      &lt;p id=\"alert\"&gt;User not present in db&lt;/p&gt;\n      &lt;form method=\"post\" action=\"\"&gt;\n        &lt;p&gt;&lt;label for=\"email\"&gt;Email&lt;/label&gt;\n        &lt;input type=\"text\" name=\"email\" id=\"email\" /&gt;&lt;/p&gt;\n        &lt;p&gt;&lt;label for=\"password\"&gt;Password&lt;/label&gt;\n        &lt;input type=\"password\" name=\"password\" id=\"password\" /&gt;&lt;/p&gt;\n        &lt;p class=\"remember_me\"&gt;\n    &lt;label for=\"remember_me\"&gt;\n     &lt;input type=\"checkbox\" name=\"remember_me\" id=\"remember_me\" value=\"1\" /&gt;\n     Remember me on this computer\n    &lt;/label&gt;\n        &lt;/p&gt;\n        &lt;p class=\"submit\"&gt;&lt;input type=\"submit\" name=\"commit\" value=\"Login\" data-disable-with=\"Login\" /&gt;&lt;/p&gt;\n      &lt;/form&gt;\n    &lt;/div&gt;\n    &lt;/form&gt;\n</code></pre>\n\n<p>I have been able to generally escape the form by using ' followed by characters, but I can't seem to get any payloads to execute.  </p>\n\n<p>Is this secure, or is there a more complicated escape sequence for breaking out of the statement</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "hash", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 416, "user_id": 11529593, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nMOHrxOg4nQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfeI-u5UbYJIejKaTCqDSluZAyBDw/mo/photo.jpg?sz=128", "display_name": "Wombologist", "link": "https://stackoverflow.com/users/11529593/wombologist"}, "edited": false, "score": 0, "creation_date": 1559152297, "post_id": 56365815, "comment_id": 99335252, "body": "Have you tried putting this in an instance method?"}], "answers": [{"comments": [{"owner": {"reputation": 1357, "user_id": 3201684, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/fce047896b7ee0a2f6967156e339521f?s=128&d=identicon&r=PG&f=1", "display_name": "ntonnelier", "link": "https://stackoverflow.com/users/3201684/ntonnelier"}, "edited": false, "score": 0, "creation_date": 1559153166, "post_id": 56366042, "comment_id": 99335638, "body": "thanks @NM Pennypacker, but that method is not receiving [:key], that would never work."}, {"owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "reply_to_user": {"reputation": 1357, "user_id": 3201684, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/fce047896b7ee0a2f6967156e339521f?s=128&d=identicon&r=PG&f=1", "display_name": "ntonnelier", "link": "https://stackoverflow.com/users/3201684/ntonnelier"}, "edited": false, "score": 0, "creation_date": 1559153235, "post_id": 56366042, "comment_id": 99335670, "body": "Then I&#39;m afraid I don&#39;t understand the problem"}], "tags": [], "owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "is_accepted": false, "score": 0, "last_activity_date": 1559153221, "last_edit_date": 1559153221, "creation_date": 1559152088, "answer_id": 56366042, "question_id": 56365815, "link": "https://stackoverflow.com/questions/56365815/create-method-that-returns-associated-objects-attribute-value-if-current-object/56366042#56366042", "title": "Create method that returns associated object&#39;s attribute value if current object&#39;s attribute is nil (jsonb type)", "body": "<p>Well, it's not best practice, but you can override the getter with a custom method. In your case:</p>\n\n<pre><code>def features\n  return features[:feature_key] if features[:feature_key].present?\n  return plan&amp;.features[:feature_key] if plan&amp;.features[:feature_key].present?\nend\n</code></pre>\n\n<p>Not sure that's the logic you need, but that'll work for an override if you put it in the <code>Account</code> model. The preferred way to do it would be to name the method something else and call that method so you can still access the unmodified attribute if need be.</p>\n"}, {"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 0, "last_activity_date": 1559157074, "creation_date": 1559157074, "answer_id": 56367072, "question_id": 56365815, "link": "https://stackoverflow.com/questions/56365815/create-method-that-returns-associated-objects-attribute-value-if-current-object/56367072#56367072", "title": "Create method that returns associated object&#39;s attribute value if current object&#39;s attribute is nil (jsonb type)", "body": "<p>Not sure I completely understand but given your comment under the other answer I am assuming you are looking for something like: </p>\n\n<pre><code>class Account &lt; ActiveRecord::Base \n\n  def feature_info(key)\n    return plan.features[key] unless features.present? &amp;&amp; features[key].present?\n    features[key]\n  end \nend\n</code></pre>\n\n<p>Then called as </p>\n\n<pre><code>   account = Account.first\n   account.feature_info(:feature_key)\n</code></pre>\n\n<p>This might be cleaner though</p>\n\n<pre><code>class Account &lt; ActiveRecord::Base \n  def features \n    read_attribute(:features) || {} \n  end\n  def feature_info(key)\n    return plan.features[key] unless features[key].present?\n    features[key]\n  end \nend\n</code></pre>\n"}], "owner": {"reputation": 1357, "user_id": 3201684, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/fce047896b7ee0a2f6967156e339521f?s=128&d=identicon&r=PG&f=1", "display_name": "ntonnelier", "link": "https://stackoverflow.com/users/3201684/ntonnelier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1559157074, "creation_date": 1559151138, "question_id": 56365815, "link": "https://stackoverflow.com/questions/56365815/create-method-that-returns-associated-objects-attribute-value-if-current-object", "title": "Create method that returns associated object&#39;s attribute value if current object&#39;s attribute is nil (jsonb type)", "body": "<p>I have the following two classes:</p>\n\n<pre><code>class Account &lt; ActiveRecord::Base\n  # columns\n  # ...\n  # features :jsonb\n\n  has_one :plan\nend\n\nclass Plan &lt; ActiveRecord::Base\n  # columns\n  # ...\n  # features :jsonb\nend\n</code></pre>\n\n<p>And will be calling features like this:</p>\n\n<pre><code>account.features    # being account is an instance of Account\n# or\naccount.features[:feature_key]\n</code></pre>\n\n<p>The thing is I want <code>account</code> to look for <code>features</code> or <code>features[:feature_key]</code> within itself, and if that is <code>nil</code> or <code>empty</code> it should pick the value from the associated <code>Plan</code> object.</p>\n\n<p>Something like:</p>\n\n<pre><code>features.present? ? features : plan.features\n# and\nfeatures[:feature_key].present ? features[:feature_key] : plan.features[:feature_key]\n</code></pre>\n\n<p>But in a proper method within <code>Account</code> class</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "nested-forms"], "comments": [{"owner": {"reputation": 627, "user_id": 10895713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GTs8n.jpg?s=128&g=1", "display_name": "Max Vinicius", "link": "https://stackoverflow.com/users/10895713/max-vinicius"}, "edited": false, "score": 0, "creation_date": 1559151645, "post_id": 56365291, "comment_id": 99335014, "body": "Maybe this answer can help you. <a href=\"https://stackoverflow.com/a/55476498/10895713\">stackoverflow.com/a/55476498/10895713</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1559150991, "creation_date": 1559150991, "answer_id": 56365783, "question_id": 56365291, "link": "https://stackoverflow.com/questions/56365291/how-to-pass-an-account-id-through-a-nested-form-in-rails/56365783#56365783", "title": "How to pass an account_id through a nested form in Rails", "body": "<p>The easiest option would be to add a hidden field into both forms:</p>\n\n<p><a href=\"https://apidock.com/rails/ActionView/Helpers/FormHelper/hidden_field\" rel=\"nofollow noreferrer\">https://apidock.com/rails/ActionView/Helpers/FormHelper/hidden_field</a></p>\n\n<p>So in your case, for the options form, something like:</p>\n\n<pre><code>  &lt;%= form.fields_for :options do |builder| %&gt;\n    &lt;fieldset class='form-group'&gt;\n      &lt;%= builder.label :name, 'Add option(s)' %&gt;\n      &lt;%= builder.hidden_field :account_id, value: current_account.id %&gt;\n      &lt;%= builder.text_field :name %&gt;\n      &lt;small id=\"optionHelp\" class=\"form-text text-muted\"&gt;\n        (e.g. \"Sizes\" or \"Color\")\n      &lt;/small&gt;\n    &lt;/fieldset&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>This will give you access to the <code>[:option][:account_id]</code> param, which will match the current user's.</p>\n"}, {"comments": [{"owner": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "edited": false, "score": 0, "creation_date": 1559159082, "post_id": 56365791, "comment_id": 99338030, "body": "It seems like setting the ID at the controller instead of in the view is a better way to do this, but I couldn&#39;t get that to work. Adding <code>&lt;%= form.hidden_field :account_id, value: current_user.account.id%&gt;</code> to the form worked though!"}], "tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": true, "score": 2, "last_activity_date": 1559151390, "last_edit_date": 1559151390, "creation_date": 1559151025, "answer_id": 56365791, "question_id": 56365291, "link": "https://stackoverflow.com/questions/56365291/how-to-pass-an-account-id-through-a-nested-form-in-rails/56365791#56365791", "title": "How to pass an account_id through a nested form in Rails", "body": "<p>Alternatively, you can pass a hidden_field with form and nested_form as given below: -</p>\n\n<pre><code>&lt;%= form_for @product do |form|%&gt;\n  &lt;%= form.fields_for :options do |builder| %&gt;\n      &lt;fieldset class='form-group'&gt;\n        &lt;%= builder.label :name, 'Add option(s)' %&gt;\n        &lt;%= builder.text_field :name %&gt;\n        &lt;small id=\"optionHelp\" class=\"form-text text-muted\"&gt;\n          (e.g. \"Sizes\" or \"Color\")\n        &lt;/small&gt;\n        &lt;%=builder.hidden_field :account_id, value: current_user.account.id%&gt;\n      &lt;/fieldset&gt;\n  &lt;% end %&gt;\n  &lt;%= form.hidden_field :account_id, value: current_user.account.id%&gt;\n&lt;%end%&gt;\n</code></pre>\n\n<p>Other than this you can set account_id at the controller</p>\n\n<pre><code>  def new\n    #@product = Product.new\n    @product = current_user.account.products.new\n    @product.options.build(account_id: current_user.account.id)\n  end\n</code></pre>\n"}], "owner": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 56365791, "answer_count": 2, "score": 0, "last_activity_date": 1559151390, "creation_date": 1559148736, "question_id": 56365291, "link": "https://stackoverflow.com/questions/56365291/how-to-pass-an-account-id-through-a-nested-form-in-rails", "title": "How to pass an account_id through a nested form in Rails", "body": "<p>I'm trying to set up a nested form in rails and both the parent and child objects in the form need to have an \"Account ID\" so that they are both scoped to the current user's account, but I can't figure out how to pass the current user's Account ID for the child object through the nested form. I keep getting a validation error of \"Account id must be present\" for the nested object.</p>\n\n<p>The parent form is \"Product\" and I'm trying to nest \"Options\" into the Product.new form.</p>\n\n<p>I'm trying to do something like this:</p>\n\n<pre><code>@product.options.account_id = current_user.account.id\n</code></pre>\n\n<p>But it's not working.</p>\n\n<p>Here is the Product model:</p>\n\n<pre><code>class Product &lt; ApplicationRecord\n  belongs_to :account\n  has_many :options, dependent: :destroy\n\n  accepts_nested_attributes_for :options, allow_destroy: true\n\n  validates :account_id,  presence: true\n  validates :name,        presence: true, length: { maximum: 120 }\nend\n</code></pre>\n\n<p>And options model:</p>\n\n<pre><code>class Option &lt; ApplicationRecord\n  belongs_to :account\n  belongs_to :product\n\n  has_many :option_values, dependent: :destroy\n\n  validates :account_id,  presence: true\n  validates :name,        presence: true,\n                          length: { maximum: 60 }\nend\n</code></pre>\n\n<p>Here's how I'm nesting \"Options\" into the Product form:</p>\n\n<pre><code>&lt;%= form.fields_for :options do |builder| %&gt;\n    &lt;fieldset class='form-group'&gt;\n      &lt;%= builder.label :name, 'Add option(s)' %&gt;\n      &lt;%= builder.text_field :name %&gt;\n      &lt;small id=\"optionHelp\" class=\"form-text text-muted\"&gt;\n        (e.g. \"Sizes\" or \"Color\")\n      &lt;/small&gt;\n    &lt;/fieldset&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>And here is my ProductsController:</p>\n\n<pre><code>class ProductsController &lt; ApplicationController\n  before_action :set_product, only: [:show, :edit, :update, :destroy]\n  before_action :restrict_access\n\n  def index\n    @products = Product.where(:account_id =&gt; current_user.account.id).all\n  end\n\n  def show\n  end\n\n  def new\n    @product = Product.new\n    @product.options.build\n  end\n\n  def edit\n  end\n\n  def create\n    @account = current_user.account\n    @product = @account.products.build(product_params)\n\n    respond_to do |format|\n      if @product.save\n        format.html { redirect_to @product, notice: 'Product was successfully created.' }\n      else\n        format.html { render :new }\n      end\n    end\n  end\n\n  def update\n    respond_to do |format|\n      if @product.update(product_params)\n        format.html { redirect_to @product, notice: 'Product was successfully updated.' }\n      else\n        format.html { render :edit }\n      end\n    end\n  end\n\n  def destroy\n    @product.destroy\n    respond_to do |format|\n      format.html { redirect_to products_url, notice: 'Product was successfully destroyed.' }\n    end\n  end\n\n  private\n    def set_product\n      if Product.find(params[:id]).account_id == current_user.account.id\n        @product = Product.find(params[:id])\n      else\n        redirect_to dashboard_path\n      end\n    end\n\n    def restrict_access\n      if index\n        authorize @products\n      else\n        authorize @product\n      end\n    end\n\n    def product_params\n      params.require(:product).permit(:account_id, :name,\n                                      options_attributes: [:id, :account_id, :name ])\n    end\nend\n</code></pre>\n\n<p>What is the correct way to do this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "associations", "rails-activerecord"], "answers": [{"tags": [], "owner": {"reputation": 750, "user_id": 1010003, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5277a5bcc6991d78ba62c8e9d14dbfa6?s=128&d=identicon&r=PG", "display_name": "Kardasis", "link": "https://stackoverflow.com/users/1010003/kardasis"}, "is_accepted": false, "score": 0, "last_activity_date": 1559215924, "last_edit_date": 1559215924, "creation_date": 1559148336, "answer_id": 56365195, "question_id": 56364995, "link": "https://stackoverflow.com/questions/56364995/acitverecord-specify-inverse-of-with-through-but-not-the-other-way/56365195#56365195", "title": "Acitverecord specify `inverse_of` with `through` but not the other way", "body": "<p>Solved by my rubber duck.\nAs seen in the <a href=\"https://apidock.com/rails/ActiveRecord/Associations/ClassMethods\" rel=\"nofollow noreferrer\">documentation</a> : </p>\n\n<blockquote>\n  <p>The <code>#belongs_to</code> association is always used in the model that has the\n  foreign key.</p>\n</blockquote>\n\n<p>So I changed my declaration of the <code>showcase_event</code> to this :</p>\n\n<pre><code>class User\n  belongs_to :showcase_event, class_name: 'Event', inverse_of: :user, optional: true\nend\n</code></pre>\n\n<p>And problem solved</p>\n"}], "owner": {"reputation": 750, "user_id": 1010003, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5277a5bcc6991d78ba62c8e9d14dbfa6?s=128&d=identicon&r=PG", "display_name": "Kardasis", "link": "https://stackoverflow.com/users/1010003/kardasis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559215924, "creation_date": 1559147535, "question_id": 56364995, "link": "https://stackoverflow.com/questions/56364995/acitverecord-specify-inverse-of-with-through-but-not-the-other-way", "title": "Acitverecord specify `inverse_of` with `through` but not the other way", "body": "<p>I have 3 models as follows :</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class User\n  has_many :event_series, inverse_of: :user\n  has_many :events, through: :event_series, inverse_of: :user\nend\n\nclass EventSeries\n  belongs_to :user, inverse_of: :event_series\n  has_many :events, inverse_of: :event_series\nend\n\nclass Event\n  belongs_to :event_series, inverse_of: :events\n  has_one :user, through: :event_series, inverse_of: :events\nend\n</code></pre>\n\n<p>This is all fine.\nNow I want to add a special event for each user called the 'showcase_event'.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class User\n  has_one :showcase_event, class_name: 'Event', inverse_of: :user\nend\n</code></pre>\n\n<p>This isn't working because the <code>Event</code> model doesn't have the user directly, it's associated through <code>EventSeries</code>.  </p>\n\n<p>I'm getting an error during serialization:</p>\n\n<pre><code>ActiveRecord::StatementInvalid (PG::UndefinedColumn: ERROR:  column events.user_id does not exist\n</code></pre>\n\n<p>I'm using fast jsonapi:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class PublicUserSerializer\n  include FastJsonapi::ObjectSerializer\n  ...\n  has_one :showcase_event, record_type: :event, serializer: EventSerializer\n  ...\nend\n</code></pre>\n\n<p>It seems to me that the inverse relationship that I have between <code>User</code>, <code>Event</code> and <code>EventSeries</code> needs to work between <code>User</code> and <code>showcase_event</code> but I don't know how to specify that ONLY the inverse is through <code>EventSeries</code>\nApologies in advance for not having the best vocabulary to describe this problem.</p>\n"}, {"tags": ["ruby", "haml"], "comments": [{"owner": {"reputation": 17497, "user_id": 23915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5e935da7b67c03dd56f385b031f485c?s=128&d=identicon&r=PG", "display_name": "Unixmonkey", "link": "https://stackoverflow.com/users/23915/unixmonkey"}, "edited": false, "score": 0, "creation_date": 1559148399, "post_id": 56364822, "comment_id": 99333565, "body": "<a href=\"https://stackoverflow.com/a/5245939/23915\">Rails: Is it possible to write view helpers with HAML syntax?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 0, "last_activity_date": 1563580184, "last_edit_date": 1563580184, "creation_date": 1559148107, "answer_id": 56365151, "question_id": 56364822, "link": "https://stackoverflow.com/questions/56364822/how-to-call-helper-in-haml-file/56365151#56365151", "title": "How to call helper in Haml file", "body": "<p>Your helper method needs to construct the full HTML via methods. Since it's not actually part of the HAML, you cannot rely on syntax like <code>%div{class: some_class}</code>. Something like this:</p>\n\n<pre><code>def show_message(msg)\n  content_tag(:div, class: 'some_class') do\n    content_tag(:div, msg, id: \"id\")\n  end\nend\n</code></pre>\n\n<p>See the <a href=\"https://apidock.com/rails/ActionView/Helpers/TagHelper/content_tag\" rel=\"nofollow noreferrer\"><code>content_tag</code></a>  documentation for more usage examples.</p>\n"}], "owner": {"reputation": 89, "user_id": 7690524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6120005787b1c35c8b86ec9e0874f45?s=128&d=identicon&r=PG&f=1", "display_name": "Makoto Taguchi", "link": "https://stackoverflow.com/users/7690524/makoto-taguchi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563580184, "creation_date": 1559146821, "last_edit_date": 1563580086, "question_id": 56364822, "link": "https://stackoverflow.com/questions/56364822/how-to-call-helper-in-haml-file", "title": "How to call helper in Haml file", "body": "<p>How do I call a method in a helper from a Haml file?</p>\n\n<p>In sample.haml, I need to call the <code>show_message</code> method depending on some condition. Then I moved the method to the helper, but the returned value from the method is treated as just a string, not a Haml element. </p>\n\n<p>This is sample.haml:</p>\n\n<pre><code>- flash.each do |msg|\n  - if msg.is_a?(Array)\n    - msg.each do |m|\n      = show_message(m)\n  - if msg.is_a?(String)\n    = show_message(msg)\n</code></pre>\n\n<p>This is helper.rb:</p>\n\n<pre><code>  def show_message(msg)\n    haml = &lt;&lt;-HAML\n    %div{class: some_class}\n      = content_tag :div, #{msg}, id: \"id\"\n    HAML\n  end\n</code></pre>\n\n<p>If I write the same HTML element in <code>show_message</code> in sample.html directly, it works properly. How can I solve this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "reply_to_user": {"reputation": 3, "user_id": 11395645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb793b37119da4f0f30a1b77e05d54cc?s=128&d=identicon&r=PG&f=1", "display_name": "RandomUser2002", "link": "https://stackoverflow.com/users/11395645/randomuser2002"}, "edited": false, "score": 0, "creation_date": 1559146743, "post_id": 56364516, "comment_id": 99332766, "body": "@RandomUser2002 try checking contents of these arrays, also try adding <code>.uniq</code> if there may be duplicates"}, {"owner": {"reputation": 3, "user_id": 11395645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb793b37119da4f0f30a1b77e05d54cc?s=128&d=identicon&r=PG&f=1", "display_name": "RandomUser2002", "link": "https://stackoverflow.com/users/11395645/randomuser2002"}, "edited": false, "score": 0, "creation_date": 1559147083, "post_id": 56364516, "comment_id": 99332952, "body": "I tried adding .uniq. The method still returns false"}, {"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "reply_to_user": {"reputation": 3, "user_id": 11395645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb793b37119da4f0f30a1b77e05d54cc?s=128&d=identicon&r=PG&f=1", "display_name": "RandomUser2002", "link": "https://stackoverflow.com/users/11395645/randomuser2002"}, "edited": false, "score": 0, "creation_date": 1559147095, "post_id": 56364516, "comment_id": 99332958, "body": "@RandomUser2002 updated, user&#39;s lessons can contain lessons from multiple courses"}], "tags": [], "owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "is_accepted": true, "score": 0, "last_activity_date": 1559146960, "last_edit_date": 1559146960, "creation_date": 1559145587, "answer_id": 56364516, "question_id": 56364328, "link": "https://stackoverflow.com/questions/56364328/how-to-check-if-all-lessons-have-been-viewed/56364516#56364516", "title": "How to check if all lessons have been viewed", "body": "<p>Your <code>viewed?</code> checks only for a single lesson, but you're passing a relation there.</p>\n\n<p>For this case it's sufficient to compare arrays with lessons ids:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def complete(course)\n  lessons.where(course: course).ids.sort == course.lessons.ids.sort\nend\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11395645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb793b37119da4f0f30a1b77e05d54cc?s=128&d=identicon&r=PG&f=1", "display_name": "RandomUser2002", "link": "https://stackoverflow.com/users/11395645/randomuser2002"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 56364516, "answer_count": 1, "score": 0, "last_activity_date": 1559146960, "creation_date": 1559144878, "question_id": 56364328, "link": "https://stackoverflow.com/questions/56364328/how-to-check-if-all-lessons-have-been-viewed", "title": "How to check if all lessons have been viewed", "body": "<p>I want to define a method (complete) that returns true if a user has watched all lessons of a course. Right now the method only returns false even if all the lessons are viewed.</p>\n\n<p>User model:</p>\n\n<pre><code>has_many :enrolments, dependent: :destroy\nhas_many :courses, through: :enrolments\nhas_many :views\nhas_many :lessons, through: :views\n\ndef enrol(course)\n  courses &lt;&lt; course\nend\n\ndef enrolled?(course)\n  courses.include?(course)\nend\n\ndef view(lesson)\n  lessons &lt;&lt; lesson\nend\n\ndef viewed?(lesson)\n  lessons.include?(lesson)\nend\n\ndef complete(course)\n  if self.viewed?(course.lessons.all)\n    return true\n  else\n    return false\n  end\nend\n</code></pre>\n\n<p>Lesson Model:</p>\n\n<pre><code>belongs_to :course\nhas_one_attached :file\ndefault_scope -&gt; { order(created_at: :desc) }\nhas_many :views\nhas_many :users, through: :views\n</code></pre>\n\n<p>Course Model:</p>\n\n<pre><code>belongs_to :company\nhas_many :lessons, dependent: :destroy\ndefault_scope -&gt; { order(created_at: :desc) }\nhas_many :enrolments, dependent: :destroy\nhas_many :users, through: :enrolments\n</code></pre>\n\n<p>View Model:</p>\n\n<pre><code>belongs_to :user\nbelongs_to :lesson\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "actioncable"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 2, "creation_date": 1559150210, "post_id": 56363970, "comment_id": 99334385, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/43461917/actioncable-nomethod-error\">ActionCable NoMethod Error</a>"}, {"owner": {"reputation": 62, "user_id": 10230313, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DBkN5WijgG0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rldRz97etd0y_Xa3rlXjJkOoQaow/mo/photo.jpg?sz=128", "display_name": "mylan atlani", "link": "https://stackoverflow.com/users/10230313/mylan-atlani"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1559151533, "post_id": 56363970, "comment_id": 99334975, "body": "Not at all, i never had this problem , i edit my post to show where the error is from."}, {"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1559186283, "post_id": 56363970, "comment_id": 99344609, "body": "How did you try to require in application.rb? Add code, please. Did you get the same error in this case?"}], "owner": {"reputation": 62, "user_id": 10230313, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DBkN5WijgG0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rldRz97etd0y_Xa3rlXjJkOoQaow/mo/photo.jpg?sz=128", "display_name": "mylan atlani", "link": "https://stackoverflow.com/users/10230313/mylan-atlani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559186219, "creation_date": 1559143616, "last_edit_date": 1559186219, "question_id": 56363970, "link": "https://stackoverflow.com/questions/56363970/undefined-method-server-for-actioncablemodule", "title": "Undefined method `server` for ActionCable:Module", "body": "<p>I am currently experiencing a problem with the implementation of ActionCable in my server.</p>\n\n<p>I would like to know if you know where the problem comes from in the logs below.</p>\n\n<p>I tried to require ActionCable in <code>application.rb</code> but it didn't work.</p>\n\n<blockquote>\n  <p>/home/kalimink/Bureau/happer-api/config/routes.rb:3:in 'block in top (required)>': undefined method <code>server</code> for ActionCable:Module (NoMethodError)</p>\n</blockquote>\n\n<p>Routes.rb</p>\n\n<pre><code>Rails.application.routes.draw do\n  devise_for :admin_users, ActiveAdmin::Devise.config\n  mount ActionCable.server =&gt; \"/cable\"\n  ActiveAdmin.routes(self)\n  # more routes here\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "soft-delete", "devise-confirmable"], "answers": [{"comments": [{"owner": {"reputation": 973, "user_id": 1659370, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/6d120a0452ccef4756d5e1af5ae01383?s=128&d=identicon&r=PG", "display_name": "kashif", "link": "https://stackoverflow.com/users/1659370/kashif"}, "edited": false, "score": 0, "creation_date": 1559147239, "post_id": 56364208, "comment_id": 99333025, "body": "its already in my mind but I do not want to use default_scope due to some code dependencies in the application. is there any other setting in devise which i can use for soft-deletion"}], "tags": [], "owner": {"reputation": 1410, "user_id": 2454036, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/746251016e806bec7aaa34b12930d387?s=128&d=identicon&r=PG", "display_name": "Juan Fuentes", "link": "https://stackoverflow.com/users/2454036/juan-fuentes"}, "is_accepted": false, "score": 0, "last_activity_date": 1559144445, "creation_date": 1559144445, "answer_id": 56364208, "question_id": 56362952, "link": "https://stackoverflow.com/questions/56362952/devise-issues-with-soft-deleted-records-any-idea-how-to-fix-it/56364208#56364208", "title": "Devise issues with soft-deleted Records. Any idea, how to fix it?", "body": "<p>You could use a default scope, ex:</p>\n\n<pre><code>class User\n  ...\n  default_scope -&gt; { kept }\n  ...\nend\n</code></pre>\n\n<p>Other discard scopes like discarded and with_discarded should keep working since they operate on the same column (discard_column), so they would override the default scope. That way, there's no need to override any of devise methods</p>\n"}, {"tags": [], "owner": {"reputation": 973, "user_id": 1659370, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/6d120a0452ccef4756d5e1af5ae01383?s=128&d=identicon&r=PG", "display_name": "kashif", "link": "https://stackoverflow.com/users/1659370/kashif"}, "is_accepted": false, "score": 1, "last_activity_date": 1559205065, "creation_date": 1559205065, "answer_id": 56374499, "question_id": 56362952, "link": "https://stackoverflow.com/questions/56362952/devise-issues-with-soft-deleted-records-any-idea-how-to-fix-it/56374499#56374499", "title": "Devise issues with soft-deleted Records. Any idea, how to fix it?", "body": "<p>Finally I'm able to fix it by overriding following method in user.rb. any one else, if facing the same issue, can fix it in following way:</p>\n\n<pre><code># Override to add condition to ignore soft deleted users\ndef self.find_first_by_auth_conditions(conditions, opts = {})\n  opts.reverse_merge!(discarded_at: nil)\n\n  super\n end\n</code></pre>\n"}], "owner": {"reputation": 973, "user_id": 1659370, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/6d120a0452ccef4756d5e1af5ae01383?s=128&d=identicon&r=PG", "display_name": "kashif", "link": "https://stackoverflow.com/users/1659370/kashif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1559205514, "creation_date": 1559140159, "last_edit_date": 1559205514, "question_id": 56362952, "link": "https://stackoverflow.com/questions/56362952/devise-issues-with-soft-deleted-records-any-idea-how-to-fix-it", "title": "Devise issues with soft-deleted Records. Any idea, how to fix it?", "body": "<p>I'm using <strong>discard</strong> gem for <strong>Soft</strong> deletion. Once user gets Soft-Deleted, user can still receive forget password emails. Because Devise password controller does not care either its soft-deleted or not ? </p>\n\n<p>I'm using following Devise modules, it seems, i may need to fix for all modules:- </p>\n\n<ul>\n<li>:confirmable,</li>\n<li>:recoverable, </li>\n<li>:timeoutable, </li>\n<li>:trackable</li>\n<li>:lockable</li>\n<li>:authenticatable</li>\n</ul>\n\n<p>Though I'm able to fix login issue with authenticatable by overriding <code>find_for_authentication</code> method in user model, but it doesn't seem to be working with other Devise modules.</p>\n\n<p>Any Idea, how i can fix soft-deletion issues with Devise ?</p>\n\n<p>I'm using <strong>devise(4.6.2), discard (1.0.0), Rails 5.1.6.2</strong></p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "rubygems"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1559138546, "post_id": 56362259, "comment_id": 99328161, "body": "can I ask where the csv data will be used? because I think Excel supports a max of 1 million rows, see <a href=\"https://stackoverflow.com/questions/23757991/maximum-number-of-rows-of-csv-data-in-excel-sheet\" title=\"maximum number of rows of csv data in excel sheet\">stackoverflow.com/questions/23757991/&hellip;</a>.  For this much data, you might better off with some kind of database dump format."}, {"owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "edited": false, "score": 1, "creation_date": 1559138843, "post_id": 56362259, "comment_id": 99328355, "body": "One of the first things I would consider in this case is to get rid of unnecessary ORM overhead and use lower level queries to DB - there is not that much point in instantiating of billion of AR entities just to fetch 3 properties from them - using raw dataset will reduce memory usage and increase performance notably..."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1559139145, "post_id": 56362259, "comment_id": 99328549, "body": "<i>Sidenote:</i> <code>1million&#47;20000</code> is 50, not 5 btw. Also, <a href=\"https://dev.mysql.com/doc/refman/8.0/en/select.html\" rel=\"nofollow noreferrer\"><code>SELECT INTO OUTFILE</code></a>."}, {"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1559144238, "post_id": 56362259, "comment_id": 99331441, "body": "@AlekseiMatiushkin Didnt know about that feature, thanks! Similar one but for postgres <a href=\"https://stackoverflow.com/questions/1517635/save-pl-pgsql-output-from-postgresql-to-a-csv-file\" title=\"save pl pgsql output from postgresql to a csv file\">stackoverflow.com/questions/1517635/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1559144336, "post_id": 56363819, "comment_id": 99331488, "body": "The bottleneck is obviously an <code>ActiveRecord</code>, not CSV."}], "tags": [], "owner": {"reputation": 3160, "user_id": 1266795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7855792dbc5f3b4c365344314e2b1ad6?s=128&d=identicon&r=PG", "display_name": "AndyV", "link": "https://stackoverflow.com/users/1266795/andyv"}, "is_accepted": false, "score": 2, "last_activity_date": 1559143107, "creation_date": 1559143107, "answer_id": 56363819, "question_id": 56362259, "link": "https://stackoverflow.com/questions/56362259/generating-csv-excel-file-for-100-million-of-records-in-ruby-on-rails/56363819#56363819", "title": "Generating CSV/Excel file for 100 Million of records in Ruby on rails?", "body": "<p>Taking a look at the source for CSV.generate gives me the impression that the csv data is kept in memory while the contents are being accumulated.  That seems like a good target for optimization, especially if you see that memory is scaling linearly with the data set.  Since your data is pretty simple, could you skip CSV and go directly to File instead?  You'd have a bit more control about when data was flushed out to disk.</p>\n\n<pre><code>File.open(\"my.csv\") do |file|\n  file.puts '\"ID\",\"Name\",\"Soon\"'\n  @obj.find_each do |c|\n    file.puts \"\\\"#{c.id}\\\",\\\"#{c.name}\\\",\\\"#{c.soon}\\\"\"\n    # flush if necessary\n  end\nend\n</code></pre>\n\n<p>You'd need to write to disk and then zip the results later with this approach.</p>\n"}, {"comments": [{"owner": {"reputation": 3160, "user_id": 1266795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7855792dbc5f3b4c365344314e2b1ad6?s=128&d=identicon&r=PG", "display_name": "AndyV", "link": "https://stackoverflow.com/users/1266795/andyv"}, "edited": false, "score": 0, "creation_date": 1559177665, "post_id": 56367642, "comment_id": 99343040, "body": "the OP is using find_each which, I\u2019m sure you know, uses find_in_batches and then iterates over the batches and yields the results. The point of find_each is precisely avoiding memory issues and I\u2019ve used it quite successfully for larger data sets tha. The OP suggests are problematic.  It\u2019s less \u201cobviously ActiveRecord\u201d than you simply assert."}, {"owner": {"reputation": 2104, "user_id": 1216272, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/77512fe46dec389c7bc5d85c6a321638?s=128&d=identicon&r=PG", "display_name": "Kunal Vashist", "link": "https://stackoverflow.com/users/1216272/kunal-vashist"}, "edited": false, "score": 0, "creation_date": 1559584786, "post_id": 56367642, "comment_id": 99459288, "body": "How can this improve the performance as find_each also iterate in batches (:1000)?"}, {"owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "edited": false, "score": 0, "creation_date": 1559595984, "post_id": 56367642, "comment_id": 99463377, "body": "Because the CSV falls out of scope and does not use a large amount of memory. In the OP&#39;s example, the entire CSV is held in memory."}], "tags": [], "owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "is_accepted": false, "score": 1, "last_activity_date": 1559159720, "creation_date": 1559159720, "answer_id": 56367642, "question_id": 56362259, "link": "https://stackoverflow.com/questions/56362259/generating-csv-excel-file-for-100-million-of-records-in-ruby-on-rails/56367642#56367642", "title": "Generating CSV/Excel file for 100 Million of records in Ruby on rails?", "body": "<p>Write to the CSV in chunks and <code>find_in_batches</code> and <code>pluck</code>. Something like:</p>\n\n<pre><code>Model.pluck(:id, :name, ...).find_in_batches(10_000) do |ary|\n  CSV.open(\"tmp.csv\", \"ab\") do |csv|\n    csv &lt;&lt; ary.map{|a| a.join ','}.join(\"\\n\")\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1919, "user_id": 384689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a66498e80512ef50822cceb2a2f5cba3?s=128&d=identicon&r=PG", "display_name": "claasz", "link": "https://stackoverflow.com/users/384689/claasz"}, "is_accepted": false, "score": 1, "last_activity_date": 1559573949, "creation_date": 1559573949, "answer_id": 56429940, "question_id": 56362259, "link": "https://stackoverflow.com/questions/56362259/generating-csv-excel-file-for-100-million-of-records-in-ruby-on-rails/56429940#56429940", "title": "Generating CSV/Excel file for 100 Million of records in Ruby on rails?", "body": "<p>It would depend whether</p>\n\n<pre><code>     arr = [c.id,c.name,soon]\n</code></pre>\n\n<p>needs to be calculated in Ruby, or you would be able to rewrite it in SQL.</p>\n\n<ul>\n<li>If you have to keep it in Ruby, you can try to avoid the ActiveRecord overhead and use a <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/DatabaseStatements.html#method-i-execute\" rel=\"nofollow noreferrer\">raw query</a> instead. You'd probably have to implement the chunk wise processing by yourself</li>\n<li>Otherwise, you could check out some database native tool for CSV export. E.g., for MySQL that would be something like <code>SELECT INTO OUTFILE</code> or <a href=\"https://dev.mysql.com/doc/refman/8.0/en/mysql.html\" rel=\"nofollow noreferrer\">mysql</a></li>\n</ul>\n"}], "owner": {"reputation": 2104, "user_id": 1216272, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/77512fe46dec389c7bc5d85c6a321638?s=128&d=identicon&r=PG", "display_name": "Kunal Vashist", "link": "https://stackoverflow.com/users/1216272/kunal-vashist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1032, "favorite_count": 0, "answer_count": 3, "score": 5, "last_activity_date": 1559573949, "creation_date": 1559138032, "last_edit_date": 1559568893, "question_id": 56362259, "link": "https://stackoverflow.com/questions/56362259/generating-csv-excel-file-for-100-million-of-records-in-ruby-on-rails", "title": "Generating CSV/Excel file for 100 Million of records in Ruby on rails?", "body": "<p>Requirement is like</p>\n\n<p>We get the huge dataset from the database( > 1 billion records) and need to export it to the csv file or excel.</p>\n\n<p>Currently implementation use CSV class CSV.generate</p>\n\n<pre><code> CSV.generate(headers: true) do |csv|\n    csv &lt;&lt; header\n    @obj.find_each do |c|\n     arr = [c.id,c.name,soon]\n     csv &lt;&lt; array\n    end\n end\n</code></pre>\n\n<p>and sending the output to</p>\n\n<pre><code>Zip::File.open(file, Zip::File::CREATE) do |zip|\n        zip.get_output_stream(\"test.#{@format}\") { |f| f.puts(convert_to_csv) }\n      end\n</code></pre>\n\n<p>All this operation is done other delayed jobs\nThis works good when record is &lt; 20,000 \nBut when rows starts growing it gets some memory issues.</p>\n\n<p>What i was thinking is to chunk the record to pieces say 1 million rows into 50 files (1million/20000)(csv1.csv,csv2.csv,csv3.csv,csv4.csv,csv5.csv) and then concat them into single file or zip all files together(faster way)</p>\n\n<p>Can any one give me idea how can I start on it.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "answers": [{"tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 2, "last_activity_date": 1559137795, "creation_date": 1559137795, "answer_id": 56362180, "question_id": 56361851, "link": "https://stackoverflow.com/questions/56361851/how-do-i-redirect-to-home-pageroot-when-user-signed-out/56362180#56362180", "title": "how do i redirect to home page(root )when user signed out?", "body": "<p>From the official devise guide to redirection after sign out:</p>\n\n<p><a href=\"https://github.com/plataformatec/devise/wiki/How-To:-Change-the-redirect-path-after-destroying-a-session-i.e.-signing-out\" rel=\"nofollow noreferrer\">https://github.com/plataformatec/devise/wiki/How-To:-Change-the-redirect-path-after-destroying-a-session-i.e.-signing-out</a></p>\n\n<p>In short, add this to your application controller:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  ...\n  ...\n  private\n\n  # Overwriting the sign_out redirect path method\n  def after_sign_out_path_for(resource_or_scope)\n    root_path\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105, "user_id": 11539591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f70196f5d8b372232969cea4f7ae28?s=128&d=identicon&r=PG&f=1", "display_name": "developing", "link": "https://stackoverflow.com/users/11539591/developing"}, "edited": false, "score": 0, "creation_date": 1559138179, "post_id": 56362258, "comment_id": 99327936, "body": "no problem! thank you very much! in the product.index page i&#39;d like to to show all the products that users have created and in the specific user dashboard(user/show);I&#39;d like to show the products that the specific user has created to be shown on his/her own dashboard."}, {"owner": {"reputation": 93, "user_id": 6538177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3ddd76946e2e55a0c11e8804b304c0?s=128&d=identicon&r=PG&f=1", "display_name": "alexalth", "link": "https://stackoverflow.com/users/6538177/alexalth"}, "reply_to_user": {"reputation": 105, "user_id": 11539591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f70196f5d8b372232969cea4f7ae28?s=128&d=identicon&r=PG&f=1", "display_name": "developing", "link": "https://stackoverflow.com/users/11539591/developing"}, "edited": false, "score": 0, "creation_date": 1559138863, "post_id": 56362258, "comment_id": 99328375, "body": "@developing I edited my answer, let me know if that&#39;s what you are looking for."}, {"owner": {"reputation": 105, "user_id": 11539591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f70196f5d8b372232969cea4f7ae28?s=128&d=identicon&r=PG&f=1", "display_name": "developing", "link": "https://stackoverflow.com/users/11539591/developing"}, "edited": false, "score": 0, "creation_date": 1559140481, "post_id": 56362258, "comment_id": 99329328, "body": "hi @alexalth thank you ! is it something like this on user/show?  ``` &lt;% if @user == current_user %&gt;    &lt;h1&gt;&lt;%= @product.each do |product|  %&gt;&lt;/h1&gt;  &lt;h1&gt;  &lt;%= @product.product_name  %&gt;&lt;/h1&gt;       &lt;p&gt;&lt;%= @product.description %&gt; &lt;%= @product.condition %&gt;&lt;/p&gt;   &lt;% end %&gt;  &lt;% end %&gt; ``` but it&#39;s not appearing on the dashboard, is there any other file i can provided for you? thx!"}, {"owner": {"reputation": 93, "user_id": 6538177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3ddd76946e2e55a0c11e8804b304c0?s=128&d=identicon&r=PG&f=1", "display_name": "alexalth", "link": "https://stackoverflow.com/users/6538177/alexalth"}, "reply_to_user": {"reputation": 105, "user_id": 11539591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f70196f5d8b372232969cea4f7ae28?s=128&d=identicon&r=PG&f=1", "display_name": "developing", "link": "https://stackoverflow.com/users/11539591/developing"}, "edited": false, "score": 0, "creation_date": 1559140556, "post_id": 56362258, "comment_id": 99329373, "body": "@developing Inside the loop remove the @ so refer to each product as <code>product</code> not <code>@product</code>. Only refer to the collection <code>@products</code> with @, e.g. <code>@products.each do |product|</code>"}, {"owner": {"reputation": 105, "user_id": 11539591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f70196f5d8b372232969cea4f7ae28?s=128&d=identicon&r=PG&f=1", "display_name": "developing", "link": "https://stackoverflow.com/users/11539591/developing"}, "edited": false, "score": 0, "creation_date": 1559141338, "post_id": 56362258, "comment_id": 99329830, "body": "yes,I&#39;ve changed and it still not working not showing on the dashboard."}, {"owner": {"reputation": 93, "user_id": 6538177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3ddd76946e2e55a0c11e8804b304c0?s=128&d=identicon&r=PG&f=1", "display_name": "alexalth", "link": "https://stackoverflow.com/users/6538177/alexalth"}, "reply_to_user": {"reputation": 105, "user_id": 11539591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f70196f5d8b372232969cea4f7ae28?s=128&d=identicon&r=PG&f=1", "display_name": "developing", "link": "https://stackoverflow.com/users/11539591/developing"}, "edited": false, "score": 0, "creation_date": 1559142650, "post_id": 56362258, "comment_id": 99330513, "body": "@developing check out the new edit, I put a sample code for the view. Let me know."}, {"owner": {"reputation": 105, "user_id": 11539591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f70196f5d8b372232969cea4f7ae28?s=128&d=identicon&r=PG&f=1", "display_name": "developing", "link": "https://stackoverflow.com/users/11539591/developing"}, "edited": false, "score": 1, "creation_date": 1559216973, "post_id": 56362258, "comment_id": 99355848, "body": "hi @alexalth thank you very much! the view/show helps a lot but after i did this in the user/show method it works now!        @ products = current_user.products"}, {"owner": {"reputation": 93, "user_id": 6538177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3ddd76946e2e55a0c11e8804b304c0?s=128&d=identicon&r=PG&f=1", "display_name": "alexalth", "link": "https://stackoverflow.com/users/6538177/alexalth"}, "reply_to_user": {"reputation": 105, "user_id": 11539591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f70196f5d8b372232969cea4f7ae28?s=128&d=identicon&r=PG&f=1", "display_name": "developing", "link": "https://stackoverflow.com/users/11539591/developing"}, "edited": false, "score": 0, "creation_date": 1559227180, "post_id": 56362258, "comment_id": 99361083, "body": "@developing cool, you&#39;re welcome. I&#39;ll edit with this change."}], "tags": [], "owner": {"reputation": 93, "user_id": 6538177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3ddd76946e2e55a0c11e8804b304c0?s=128&d=identicon&r=PG&f=1", "display_name": "alexalth", "link": "https://stackoverflow.com/users/6538177/alexalth"}, "is_accepted": false, "score": 2, "last_activity_date": 1559227226, "last_edit_date": 1559227226, "creation_date": 1559138029, "answer_id": 56362258, "question_id": 56361851, "link": "https://stackoverflow.com/questions/56361851/how-do-i-redirect-to-home-pageroot-when-user-signed-out/56362258#56362258", "title": "how do i redirect to home page(root )when user signed out?", "body": "<p>Regarding question 1:</p>\n\n<p>Check @Mark answer</p>\n\n<p>Regarding question 2:</p>\n\n<p>Assuming you have the relationship:</p>\n\n<pre><code># app/models/user.rb\n\nclass User &lt; ApplicationRecord\n  has_many :products\nend\n</code></pre>\n\n<pre><code># app/models/product.rb\n\nclass Product &lt; ApplicationRecord\n  belongs_to :user\nend\n</code></pre>\n\n<p>In the <code>user#show</code> implementation add</p>\n\n<pre><code># app/controller/users_controller.rb\n\ndef show\n  ...\n  @products = current_user.products\n  ...\nend\n</code></pre>\n\n<p>Now in the <code>users/show</code> view you can loop <code>@products</code> for the user's products.</p>\n\n<pre><code>&lt;h1&gt;User products&lt;/h1&gt;\n\n&lt;table&gt;\n  &lt;tr&gt;\n    &lt;th&gt;Name&lt;/th&gt;\n    &lt;th&gt;Description&lt;/th&gt;\n    &lt;th&gt;Condition&lt;/th&gt;\n  &lt;/tr&gt;\n\n  &lt;% @products.each do |product| %&gt;\n    &lt;tr&gt;\n      &lt;td&gt;&lt;%= product.name %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= product.description %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= product.condition %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;% end %&gt;\n&lt;/table&gt;\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 11539591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f70196f5d8b372232969cea4f7ae28?s=128&d=identicon&r=PG&f=1", "display_name": "developing", "link": "https://stackoverflow.com/users/11539591/developing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1559227226, "creation_date": 1559136814, "last_edit_date": 1559138628, "question_id": 56361851, "link": "https://stackoverflow.com/questions/56361851/how-do-i-redirect-to-home-pageroot-when-user-signed-out", "title": "how do i redirect to home page(root )when user signed out?", "body": "<p>I am trying to get devise working on my simple rails app where;</p>\n\n<p>1.I'd like when user_signed out it will redirect to home page(root).!</p>\n\n<p>2.when the user create his/her own products, when go to products.index it will show all the products that users have created, and when signed in as a specific user, the person will see their own created products on the user dashboard.(at the moment the added products will automatically added to the products index page)</p>\n\n<p>many thanks!</p>\n\n<pre><code>&lt;header class=\"navbar\"&gt;\n\n\n\n  &lt;nav class=\"menu\"&gt;\n    &lt;ul&gt;\n      &lt;li&gt;\n        &lt;a href=\"#\"&gt; Products &lt;i class=\"fa fa-sort-desc\" aria-hidden=\"true\"&gt;&lt;/i&gt;&lt;/a&gt;\n          &lt;ul&gt;\n            &lt;li&gt;\n              &lt;%= link_to \"Create a product\",new_product_path %&gt;\n             &lt;/li&gt;\n            &lt;/li&gt;\n            &lt;/li&gt;\n            &lt;li&gt;\n              &lt;%= link_to \"View all the products\", products_path%&gt;&lt;/i&gt;\n            &lt;/li&gt;\n          &lt;/ul&gt;\n      &lt;/li&gt;\n      &lt;li&gt;\n        &lt;a href=\"#\"&gt;Profile &lt;i class=\"fa fa-sort-desc\" aria-hidden=\"true\"&gt;&lt;/i&gt;&lt;/a&gt;\n        &lt;ul&gt;\n          &lt;%= link_to \"My dashboard\", profile_path %&gt;\n          &lt;%= link_to \"Log out\", destroy_user_session_path, method: :delete %&gt;\n        &lt;/ul&gt;\n      &lt;/li&gt;\n      &lt;li&gt;&lt;a href=\"#\"&gt;Contact &lt;/a&gt;&lt;/li&gt;\n    &lt;/ul&gt;\n  &lt;/nav&gt;\n\n\n&lt;/header&gt;\n</code></pre>\n\n<pre><code>&lt;h2&gt;Log in&lt;/h2&gt;\n\n\n&lt;%= simple_form_for(resource, as: resource_name, url: session_path(resource_name)) do |f| %&gt;\n  &lt;div class='signup_create_product'&gt;\n    &lt;%= f.input :email,\n                required: false,\n                autofocus: true,\n                input_html: { autocomplete: \"email\" } %&gt;\n    &lt;%= f.input :password,\n                required: false,\n                input_html: { autocomplete: \"current-password\" } %&gt;\n    &lt;%= f.input :remember_me, as: :boolean if devise_mapping.rememberable? %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"form-actions\"&gt;\n    &lt;%= f.button :submit, \"Log in\" %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n\n&lt;%= render \"devise/shared/links\" %&gt;\n\n\n</code></pre>\n\n<pre><code>class ProductsController &lt; ApplicationController\n\n  def index\n    @products = Product.all\n  end\n\n  def show\n    @product = Product.find(params[:id])\n  end\n\n  def new\n    @product = Product.new\n  end\n\n\n  def create\n\n     @product = Product.new(product_params)\n     @product.user = current_user\n\n    if @product.save\n      redirect_to products_path\n    else\n      render :new\n    end\n  end\n\n  def edit\n    @product = Product.find(params[:id])\n  end\n\n\n\n  def destroy\n    @product = Product.find(params[:id])\n    @product.destroy\n    redirect_to products_path\n  end\n\n  private\n\n  def product_params\n    params.require(:product).permit(:product_name, :description)\n  end\nend\n</code></pre>\n\n<p>user show page</p>\n\n<pre><code> &lt;h1&gt;&lt;%= @user.name %&gt;&lt;/h1&gt;\n</code></pre>\n"}, {"tags": ["ruby", "usb", "interrupt", "hid", "libusb"], "owner": {"reputation": 103, "user_id": 6459331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808bc244b2638eae64edb2960c43e916?s=128&d=identicon&r=PG", "display_name": "ciemborowicz", "link": "https://stackoverflow.com/users/6459331/ciemborowicz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 226, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1593894200, "creation_date": 1559133068, "last_edit_date": 1592644375, "question_id": 56360704, "link": "https://stackoverflow.com/questions/56360704/i-cannot-mimic-sniffed-urb-interruption-using-libusb-for-ruby", "title": "I cannot mimic sniffed urb interruption using libusb for Ruby", "body": "<h1>Sniffed URB_INTERRUPTions</h1>\n<p>I sniffed communication between some application (SoundLab) and device (sonometer with usb). I found a packet responsible for returning current state:</p>\n<pre><code>USB URB\n    [Source: host]\n    [Destination: 1.1.2]\n    USBPcap pseudoheader length: 27\n    IRP ID: 0xffff858d126f4a60\n    IRP USBD_STATUS: USBD_STATUS_SUCCESS (0x00000000)\n    URB Function: URB_FUNCTION_BULK_OR_INTERRUPT_TRANSFER (0x0009)\n    IRP information: 0x00, Direction: FDO -&gt; PDO\n        0000 000. = Reserved: 0x00\n        .... ...0 = Direction: FDO -&gt; PDO (0x0)\n    URB bus id: 1\n    Device address: 1\n    Endpoint: 0x02, Direction: OUT\n        0... .... = Direction: OUT (0)\n        .... 0010 = Endpoint number: 2\n    URB transfer type: URB_INTERRUPT (0x01)\n    Packet Data Length: 8\n    [bInterfaceClass: Unknown (0xffff)]\nLeftover Capture Data: b331eb4d00000000\n</code></pre>\n<p>It is sent by application to endpoint number 2 (out), and then device sends urb interruption with data to endpoint number 1 (in):</p>\n<pre><code>USB URB\n    [Source: 1.1.1]\n    [Destination: host]\n    USBPcap pseudoheader length: 27\n    IRP ID: 0xffff858d10207af0\n    IRP USBD_STATUS: USBD_STATUS_SUCCESS (0x00000000)\n    URB Function: URB_FUNCTION_BULK_OR_INTERRUPT_TRANSFER (0x0009)\n    IRP information: 0x01, Direction: PDO -&gt; FDO\n        0000 000. = Reserved: 0x00\n        .... ...1 = Direction: PDO -&gt; FDO (0x1)\n    URB bus id: 1\n    Device address: 1\n    Endpoint: 0x81, Direction: IN\n        1... .... = Direction: IN (1)\n        .... 0001 = Endpoint number: 1\n    URB transfer type: URB_INTERRUPT (0x01)\n    Packet Data Length: 8\n    [bInterfaceClass: Unknown (0xffff)]\nLeftover Capture Data: 01a9009b90ddc0ff\n</code></pre>\n<h1>Attempt to mimic interruptions with libusb</h1>\n<p>Now I want to mimic this in Linux, using <a href=\"https://github.com/larskanis/libusb\" rel=\"nofollow noreferrer\">libusb</a>. I wrote this code where I can test different interruptions.</p>\n<pre class=\"lang-rb prettyprint-override\"><code>require 'libusb'\nrequire 'pry'\n\nvendor_id = 0x64bd\nproduct_id = 0x74e3\n\nmodule Messages\n  GET_STATE = ['b331eb4d00000000'].pack('H*')\nend\n\nusb = LIBUSB::Context.new\ndevice = usb.devices(idVendor: vendor_id, idProduct: product_id).first\n\ndev_handle = device.open\n\nif dev_handle.kernel_driver_active?(0)\n  dev_handle.detach_kernel_driver(0)\nend\n\ndev_handle.claim_interface(0)\n\nbinding.pry\n\ndev_handle.release_interface(0)\ndev_handle.close\n</code></pre>\n<p>Then I run this in <code>pry</code> console:</p>\n<pre class=\"lang-rb prettyprint-override\"><code>dev_handle.interrupt_transfer(endpoint: 2, dataOut: Messages::GET_STATE)\n</code></pre>\n<p>And it returns <code>8</code>. That is not what I expected.</p>\n<h1>URB_INTERRUPTions I see when I run my code</h1>\n<pre><code>USB URB\n    [Source: host]\n    [Destination: 1.6.2]\n    URB id: 0xffff8802142fecc0\n    URB type: URB_SUBMIT ('S')\n    URB transfer type: URB_INTERRUPT (0x01)\n    Endpoint: 0x02, Direction: OUT\n    Device: 6\n    URB bus id: 1\n    Device setup request: not relevant ('-')\n    Data: present (0)\n    URB sec: 1559130571\n    URB usec: 534195\n    URB status: Operation now in progress (-EINPROGRESS) (-115)\n    URB length [bytes]: 8\n    Data length [bytes]: 8\n    [Response in: 126]\n    [bInterfaceClass: HID (0x03)]\n    Unused Setup Header\n    Interval: 8\n    Start frame: 0\n    Copy of Transfer Flags: 0x00000000\n    Number of ISO descriptors: 0\nLeftover Capture Data: b331eb4d00000000\n</code></pre>\n<pre><code>USB URB\n    [Source: 1.6.2]\n    [Destination: host]\n    URB id: 0xffff8802142fecc0\n    URB type: URB_COMPLETE ('C')\n    URB transfer type: URB_INTERRUPT (0x01)\n    Endpoint: 0x02, Direction: OUT\n    Device: 6\n    URB bus id: 1\n    Device setup request: not relevant ('-')\n    Data: not present ('&gt;')\n    URB sec: 1559130571\n    URB usec: 534846\n    URB status: Success (0)\n    URB length [bytes]: 8\n    Data length [bytes]: 0\n    [Request in: 125]\n    [Time from request: 0.000651000 seconds]\n    [bInterfaceClass: HID (0x03)]\n    Unused Setup Header\n    Interval: 8\n    Start frame: 0\n    Copy of Transfer Flags: 0x00000000\n    Number of ISO descriptors: 0\n</code></pre>\n<h1>Summary</h1>\n<p>In result I get URB_INTERRUPTions that are much different from what I saw on Windows. On Windows I had urb_interrupt to 2 (out) endpoint with data requesting state of device. Then device was sending urb_interrupt to 1 (in) endpoint with current state encoded in capture data. How can I mimic this with <code>LIBUSB::DevHandle#interrupt_transfer</code>? Here is documentation of this method: <a href=\"https://www.rubydoc.info/gems/libusb/LIBUSB/DevHandle#interrupt_transfer-instance_method\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/gems/libusb/LIBUSB/DevHandle#interrupt_transfer-instance_method</a>.</p>\n"}, {"tags": ["ruby", "rubygems", "spreadsheet-gem"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1559134763, "post_id": 56360671, "comment_id": 99325705, "body": "<a href=\"https://github.com/zdavatz/spreadsheet/issues/220\" rel=\"nofollow noreferrer\">github.com/zdavatz/spreadsheet/issues/220</a> <a href=\"https://github.com/zdavatz/spreadsheet/issues/193\" rel=\"nofollow noreferrer\">github.com/zdavatz/spreadsheet/issues/193</a> <a href=\"https://github.com/zdavatz/spreadsheet/issues/16\" rel=\"nofollow noreferrer\">github.com/zdavatz/spreadsheet/issues/16</a> --- This gem does not support XLSX."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10341060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fC48h.jpg?s=128&g=1", "display_name": "Mohamed Barakat", "link": "https://stackoverflow.com/users/10341060/mohamed-barakat"}, "edited": false, "score": 0, "creation_date": 1559133569, "post_id": 56360837, "comment_id": 99325003, "body": "what if I want to use the same gem ?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 21, "user_id": 10341060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fC48h.jpg?s=128&g=1", "display_name": "Mohamed Barakat", "link": "https://stackoverflow.com/users/10341060/mohamed-barakat"}, "edited": false, "score": 0, "creation_date": 1559136475, "post_id": 56360837, "comment_id": 99326830, "body": "That gem does not support the XLSX format.  But XLS should be supported by all versions of Excel so you should be able to convert  simply by opening the XLS file in Excel, than saving to XLS format if you need to.  There are other ways to convert the file if you need to. Maybe see <a href=\"https://stackoverflow.com/questions/31606394/convert-csv-to-xlsx-using-command-line\" title=\"convert csv to xlsx using command line\">stackoverflow.com/questions/31606394/&hellip;</a>"}, {"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1559137970, "post_id": 56360837, "comment_id": 99327790, "body": "I was going to recommend the <a href=\"https://github.com/randym/axlsx\" rel=\"nofollow noreferrer\">axlsx</a> gem, but wow the roo gem looks really interesting! Great tip!"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 2, "last_activity_date": 1559136786, "last_edit_date": 1559136786, "creation_date": 1559133444, "answer_id": 56360837, "question_id": 56360671, "link": "https://stackoverflow.com/questions/56360671/spreadsheetworkbook-new-creates-xls-instead-of-xlsx/56360837#56360837", "title": "Spreadsheet::Workbook.new creates .xls instead of xlsx", "body": "<p>You may want to use the <a href=\"https://github.com/roo-rb/roo\" rel=\"nofollow noreferrer\">roo gem</a> instead as it supports XLSX format. It's also more well supported as the <a href=\"https://github.com/zdavatz/spreadsheet\" rel=\"nofollow noreferrer\">spreadsheet</a> gem has not been updated in 5 years, and spreadsheet gem does NOT support XLS format.</p>\n"}], "owner": {"reputation": 21, "user_id": 10341060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fC48h.jpg?s=128&g=1", "display_name": "Mohamed Barakat", "link": "https://stackoverflow.com/users/10341060/mohamed-barakat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559203652, "creation_date": 1559132959, "last_edit_date": 1559203652, "question_id": 56360671, "link": "https://stackoverflow.com/questions/56360671/spreadsheetworkbook-new-creates-xls-instead-of-xlsx", "title": "Spreadsheet::Workbook.new creates .xls instead of xlsx", "body": "<p>I want to generate <code> xlsx file </code>\nbut Spreadsheet genrates <code> xls </code>  <br>\nHow to generate the  xlsx file using the same gem ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1534, "user_id": 4453714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fv4Fb.jpg?s=128&g=1", "display_name": "Yurii Verbytskyi", "link": "https://stackoverflow.com/users/4453714/yurii-verbytskyi"}, "edited": false, "score": 0, "creation_date": 1559127800, "post_id": 56358437, "comment_id": 99321653, "body": "You better look at the warning you should receive  ` 2.6.2 :002 &gt; a = &#39;test&#39;  =&gt; &quot;test&quot; 2.6.2 :003 &gt; if a == &#39;one&#39; || &#39;two&#39; 2.6.2 :004?&gt;   puts &#39;Other&#39; 2.6.2 :005?&gt;   else 2.6.2 :006?&gt;   puts &#39;Else&#39; 2.6.2 :007?&gt;   end (irb):7: warning: string literal in condition Other  =&gt; nil 2.6.2 :008 &gt; if a == &#39;one&#39; || false 2.6.2 :009?&gt;   puts &#39;Other&#39; 2.6.2 :010?&gt;   else 2.6.2 :011?&gt;   puts &#39;Else one&#39; 2.6.2 :012?&gt;   end Else one  =&gt; nil `"}, {"owner": {"reputation": 1534, "user_id": 4453714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fv4Fb.jpg?s=128&g=1", "display_name": "Yurii Verbytskyi", "link": "https://stackoverflow.com/users/4453714/yurii-verbytskyi"}, "edited": false, "score": 0, "creation_date": 1559128002, "post_id": 56358437, "comment_id": 99321763, "body": "And than to <a href=\"https://stackoverflow.com/questions/21060234/ruby-operator-precedence-table\" title=\"ruby operator precedence table\">stackoverflow.com/questions/21060234/&hellip;</a> ruby precedence table(<code>==</code> runs first, than you take if false || &#39;founder&#39;)"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 1534, "user_id": 4453714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fv4Fb.jpg?s=128&g=1", "display_name": "Yurii Verbytskyi", "link": "https://stackoverflow.com/users/4453714/yurii-verbytskyi"}, "edited": false, "score": 0, "creation_date": 1559129265, "post_id": 56358437, "comment_id": 99322455, "body": "@YuriyVerbytskyi pasting irb sessions in comments rarely works."}, {"owner": {"reputation": 1534, "user_id": 4453714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fv4Fb.jpg?s=128&g=1", "display_name": "Yurii Verbytskyi", "link": "https://stackoverflow.com/users/4453714/yurii-verbytskyi"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1559140069, "post_id": 56358437, "comment_id": 99329064, "body": "@Stefan oh yeah, but it doesn&#39;t looks like anybody but PO will be interested in that as an answer("}], "answers": [{"tags": [], "owner": {"reputation": 628, "user_id": 5954643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9tq2jIW1zsk/AAAAAAAAAAI/AAAAAAAABcY/id8Ndc5tWuY/photo.jpg?sz=128", "display_name": "Rajkumar Ulaganadhan", "link": "https://stackoverflow.com/users/5954643/rajkumar-ulaganadhan"}, "is_accepted": false, "score": 1, "last_activity_date": 1559127818, "last_edit_date": 1559127818, "creation_date": 1559126146, "answer_id": 56358549, "question_id": 56358437, "link": "https://stackoverflow.com/questions/56358437/ruby-two-strings-in-an-if-condition/56358549#56358549", "title": "Ruby two strings in an IF condition", "body": "<p>Try like this,</p>\n\n<pre><code>if ['CEO','founder'].include?(shop.details['company_role'])\n  'Other'\nelse\n  shop.details['customer_kind']\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 6733630, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IPd-sfvRDh8/AAAAAAAAAAI/AAAAAAAAABI/Qul0I7Pwvw8/photo.jpg?sz=128", "display_name": "zlei1", "link": "https://stackoverflow.com/users/6733630/zlei1"}, "is_accepted": false, "score": 1, "last_activity_date": 1559126669, "creation_date": 1559126669, "answer_id": 56358707, "question_id": 56358437, "link": "https://stackoverflow.com/questions/56358437/ruby-two-strings-in-an-if-condition/56358707#56358707", "title": "Ruby two strings in an IF condition", "body": "<pre><code>%w(CEO founder).include?(shop.details['company_role']) ? 'Other' : shop.details['customer_kind']\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "edited": false, "score": 0, "creation_date": 1559127394, "post_id": 56358868, "comment_id": 99321414, "body": "I&#39;ve just tried this in Ruby 2.2.2 and the method isn&#39;t defined, it may belong to later versions of Ruby, or to a library."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "edited": false, "score": 2, "creation_date": 1559128916, "post_id": 56358868, "comment_id": 99322281, "body": "@AJFaraday <a href=\"https://api.rubyonrails.org/classes/Object.html#method-i-in-3F\" rel=\"nofollow noreferrer\"><code>Object#in?</code></a> \u2013 this is a Rails question"}, {"owner": {"reputation": 2322, "user_id": 3088748, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/544821277/picture?type=large", "display_name": "AJFaraday", "link": "https://stackoverflow.com/users/3088748/ajfaraday"}, "edited": false, "score": 0, "creation_date": 1559135072, "post_id": 56358868, "comment_id": 99325930, "body": "Ahh, I missed that detail. No problem."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1559136262, "post_id": 56358868, "comment_id": 99326698, "body": "Remove your other answer or combine the 2 answers (and fix the errors in your other answer)"}], "tags": [], "owner": {"reputation": 87, "user_id": 2803930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f07b6f4e3ee819b13c58a8c887860328?s=128&d=identicon&r=PG&f=1", "display_name": "Ashish Garg", "link": "https://stackoverflow.com/users/2803930/ashish-garg"}, "is_accepted": false, "score": 1, "last_activity_date": 1559127192, "creation_date": 1559127192, "answer_id": 56358868, "question_id": 56358437, "link": "https://stackoverflow.com/questions/56358437/ruby-two-strings-in-an-if-condition/56358868#56358868", "title": "Ruby two strings in an IF condition", "body": "<pre><code>if shop.details['company_role'].in?('CEO','founder')\n  'Other'\nelse\n  shop.details['customer_kind']\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 11510146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23cc4e72d52e4090891705571ae6b9f6?s=128&d=identicon&r=PG&f=1", "display_name": "sm83", "link": "https://stackoverflow.com/users/11510146/sm83"}, "is_accepted": false, "score": 0, "last_activity_date": 1559129836, "creation_date": 1559129836, "answer_id": 56359719, "question_id": 56358437, "link": "https://stackoverflow.com/questions/56358437/ruby-two-strings-in-an-if-condition/56359719#56359719", "title": "Ruby two strings in an IF condition", "body": "<p>Keep it simple-</p>\n\n<pre><code>if shop.details['company_role'] == 'CEO' || shop.details['company_role'] == 'founder'\n        'Other'\nelse\n        shop.details['customer_kind']\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3160, "user_id": 1266795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7855792dbc5f3b4c365344314e2b1ad6?s=128&d=identicon&r=PG", "display_name": "AndyV", "link": "https://stackoverflow.com/users/1266795/andyv"}, "is_accepted": false, "score": 2, "last_activity_date": 1559144203, "creation_date": 1559144203, "answer_id": 56364148, "question_id": 56358437, "link": "https://stackoverflow.com/questions/56358437/ruby-two-strings-in-an-if-condition/56364148#56364148", "title": "Ruby two strings in an IF condition", "body": "<p>The premise is a little off.  The <code>if</code> statement <em>works</em>, but it's not producing the results that you expect.  It's basically doing the equivalent of this:</p>\n\n<p>shop.details['company_role'] == 'CEO' # is this true? then stop\n  | \"founder\"                           # is this true?  yes, it's <em>always</em> truthy</p>\n\n<p>The solutions provided will all work.  Your choice mostly depends on your code style.  I'd go with the second option because I personally like the test with an emphasis on the tested data.</p>\n\n<p>Two further suggestions.  First, the test itself could be extracted to a method.  This would improve readability of your code.</p>\n\n<pre><code>def shop_type\n  if executive?\n    'Other'\n  else\n    shop.details['customer_kind']\n  end\n  # alternate: executive? ? 'Other' : shop.details['customer_kind']\nend\n\ndef executive?\n  shop.details['company_role'].in?('CEO','founder')\nend\n</code></pre>\n\n<p>Lastly, it strikes me that the decision about whether or not a <code>Shop</code> includes an \"executive?\" seems to be useful information in a number of contexts.  As such, it looks like the <code>executive?</code> method would be better placed inside the <code>Shop</code> model so that knowledge of the internal organization of the <code>Shop</code> does not leak all over your system.</p>\n\n<pre><code>shop.executive? ? 'Other' : shop.details['customer_kind']\n\nclass Shop\n  ...\n  def executive?\n    shop.details['company_role'].in?('CEO','founder')\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "answer_count": 5, "score": -2, "last_activity_date": 1559146390, "creation_date": 1559125779, "question_id": 56358437, "link": "https://stackoverflow.com/questions/56358437/ruby-two-strings-in-an-if-condition", "title": "Ruby two strings in an IF condition", "body": "<p>In my rails project I've <code>if</code> statement with string conditions which doesn't work.</p>\n\n<pre><code>  if shop.details['company_role'] == 'CEO' || 'founder'\n        'Other'\n      else\n        shop.details['customer_kind']\n      end\n  end\n</code></pre>\n\n<p>When I've case with <code>company_role = founder</code> it didn't return me 'Other' but <code>customer_kind</code></p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "rubygems", "rake"], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 11539591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f70196f5d8b372232969cea4f7ae28?s=128&d=identicon&r=PG&f=1", "display_name": "developing", "link": "https://stackoverflow.com/users/11539591/developing"}, "edited": false, "score": 0, "creation_date": 1559128347, "post_id": 56358955, "comment_id": 99321970, "body": "I&#39;ve deleted bundler (&gt;= 1.3.0) in my Gemfile.lock and it works now, could you maybe explain a little bit about the above reason? many thanks!:)"}, {"owner": {"reputation": 1702, "user_id": 703161, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/21f3889b711ae6dd796913170199899e?s=128&d=identicon&r=PG", "display_name": "DogEatDog", "link": "https://stackoverflow.com/users/703161/dogeatdog"}, "edited": false, "score": 0, "creation_date": 1559580417, "post_id": 56358955, "comment_id": 99457467, "body": "That should not work. The issue isn&#39;t with bundler. It is with that version of the <code>ffi</code> gem not being available."}], "tags": [], "owner": {"reputation": 87, "user_id": 2803930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f07b6f4e3ee819b13c58a8c887860328?s=128&d=identicon&r=PG&f=1", "display_name": "Ashish Garg", "link": "https://stackoverflow.com/users/2803930/ashish-garg"}, "is_accepted": true, "score": -6, "last_activity_date": 1559127436, "creation_date": 1559127436, "answer_id": 56358955, "question_id": 56358405, "link": "https://stackoverflow.com/questions/56358405/your-bundle-is-locked-to-ffi-1-11-0-but-that-version-could-not-be-found-in-an/56358955#56358955", "title": "Your bundle is locked to ffi (1.11.0), but that version could not be found in any of the sources listed in your Gemfile", "body": "<p>Delete the bundler version mentioned in your Gemfile.lock</p>\n"}, {"tags": [], "owner": {"reputation": 1702, "user_id": 703161, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/21f3889b711ae6dd796913170199899e?s=128&d=identicon&r=PG", "display_name": "DogEatDog", "link": "https://stackoverflow.com/users/703161/dogeatdog"}, "is_accepted": false, "score": 12, "last_activity_date": 1559580368, "creation_date": 1559580368, "answer_id": 56431490, "question_id": 56358405, "link": "https://stackoverflow.com/questions/56358405/your-bundle-is-locked-to-ffi-1-11-0-but-that-version-could-not-be-found-in-an/56431490#56431490", "title": "Your bundle is locked to ffi (1.11.0), but that version could not be found in any of the sources listed in your Gemfile", "body": "<p>The issue you're hitting is that bundler could not find that version of <code>ffi</code>. You most likely installed it originally when creating the project or adding a gem. The <code>ffi</code> version <code>1.11.0</code> <a href=\"https://github.com/ffi/ffi/issues/701\" rel=\"noreferrer\">was pulled from RubyGems</a>. </p>\n\n<p>Run <code>bundle update</code> on your project to get the latest version, which is <code>1.11.1</code> as of today. That should fix your issue as when you deploy next when heroku runs bundler, it will pick up that version from RubyGems.</p>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 9847711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zr9K.jpg?s=128&g=1", "display_name": "Ayogu Chibueze", "link": "https://stackoverflow.com/users/9847711/ayogu-chibueze"}, "is_accepted": false, "score": 5, "last_activity_date": 1583324279, "creation_date": 1583324279, "answer_id": 60525905, "question_id": 56358405, "link": "https://stackoverflow.com/questions/56358405/your-bundle-is-locked-to-ffi-1-11-0-but-that-version-could-not-be-found-in-an/60525905#60525905", "title": "Your bundle is locked to ffi (1.11.0), but that version could not be found in any of the sources listed in your Gemfile", "body": "<p>I had the same issue and <code>bundle update ffi</code> fixed it for me.</p>\n"}, {"tags": [], "owner": {"reputation": 23627, "user_id": 5175709, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/LGmTA.png?s=128&g=1", "display_name": "Honey", "link": "https://stackoverflow.com/users/5175709/honey"}, "is_accepted": false, "score": 1, "last_activity_date": 1609713902, "last_edit_date": 1609713902, "creation_date": 1607299350, "answer_id": 65174452, "question_id": 56358405, "link": "https://stackoverflow.com/questions/56358405/your-bundle-is-locked-to-ffi-1-11-0-but-that-version-could-not-be-found-in-an/65174452#65174452", "title": "Your bundle is locked to ffi (1.11.0), but that version could not be found in any of the sources listed in your Gemfile", "body": "<h1>EDIT</h1>\n<p>In my case it was that the repo was unsupported. I was dealing with <strong>multiple dependency hells</strong>. I say multiple because there was was RakeFile for the Rainforest project which kicked off multiple other gems/projects/repos with incompatible versions across. At least that's what I've understood. For more see <a href=\"https://github.com/CocoaPods/Rainforest/issues/89#issuecomment-752263648\" rel=\"nofollow noreferrer\">here</a> where a contributor says the repo needs updating</p>\n<hr />\n<p>I was following the steps from <a href=\"https://guides.cocoapods.org/contributing/dev-environment.html\" rel=\"nofollow noreferrer\">CocoaPods dev environment setup</a> and when I was doing <code>rake bootstrap</code> I was getting the following error:</p>\n<pre><code>Your bundle is locked to codecov (0.1.14), but that version could not be found in any of the sources listed in your Gemfile. If you haven't changed sources, that\nmeans the author of codecov (0.1.14) has removed it. You'll need to update your bundle to a version other than codecov (0.1.14) that hasn't been removed in order\nto install.\nrake aborted!\nCommand failed with status (7): [bundle install...]\n/Users/honey/Rainforest/Cork/Rakefile:9:in `block in &lt;top (required)&gt;'\n</code></pre>\n<p>From within my <code>Rainforest</code> directory I tried doing <code>bundle update codecov</code> but I was getting:</p>\n<blockquote>\n<p>Could not locate Gemfile</p>\n</blockquote>\n<p>If you notice you see the error is failing from within a <em>subdirectory</em> of my Rainforest directory ie <code>/Rainforest/Cork</code>.</p>\n<p>So I just changed the directory to <code>/Users/honey/Rainforest/Cork</code> where I had a <strong>Gemfile</strong> and then just ran <code>bundle update codecov</code>. Then I was able to run <code>rake bootstrap</code> from my <code>Rainforest</code> directory</p>\n<hr />\n<p>After that fix, still my dev environment wasn't fully setup. The docs say:</p>\n<blockquote>\n<p>To verify that everything is set up, run: <code>CocoaPods/bin/pod --help</code></p>\n</blockquote>\n<p>When I did that I was getting this error:</p>\n<blockquote>\n<p>Could not find rake-10.5.0 in any of the sources</p>\n<p>Run <code>bundle install</code> to install missing gems.</p>\n</blockquote>\n<p>I did an <code>ls</code> and found the following items:</p>\n<pre><code>CLAide\nCocoaPods\nCore\nCork\nMolinillo\nNanaimo\nREADME.md\nRELEASING.md\nRakefile\nXcodeproj\nclaide-completion\ncocoapods-acknowledgements\ncocoapods-deintegrate\ncocoapods-docs\ncocoapods-downloader\ncocoapods-plugins\ncocoapods-search\ncocoapods-stats\ncocoapods-trunk\ncocoapods-try\nfourflusher\npod-template\nshared\n</code></pre>\n<p>Meaning there was no <code>Gemfile</code> in my current directory.</p>\n<p>I changed directory into <code>CocoaPods</code> and saw a <code>Gemfile</code> in there. From there I just ran <code>bundle install</code> and then from my original <code>Rainforest</code> directory I was able to run <code>CocoaPods/bin/pod --help</code> successfully.</p>\n<p>FWIW when I ran <code>bundle install</code> I got the following warning:</p>\n<blockquote>\n<p>Warning: the running version of Bundler (1.17.2) is older than the\nversion that created the lockfile (1.17.3). We suggest you upgrade to\nthe latest version of Bundler by running <code>gem install bundler</code>.</p>\n</blockquote>\n<p>But that's a problem for another day.</p>\n<p>What I understood was that for a library as big as CocoaPods there are multiple gems/projects and each error/warning message that you get is usually in regards to one gem/project and not others and if you change your directory and look into the files in regard to that gem/project then you'll get a better overview of what's going on wrong and where your command need to be ran from.</p>\n"}, {"tags": [], "owner": {"reputation": 1386, "user_id": 1661186, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/A1yBT.png?s=128&g=1", "display_name": "Darlan D.", "link": "https://stackoverflow.com/users/1661186/darlan-d"}, "is_accepted": false, "score": 1, "last_activity_date": 1617670830, "creation_date": 1617670830, "answer_id": 66961483, "question_id": 56358405, "link": "https://stackoverflow.com/questions/56358405/your-bundle-is-locked-to-ffi-1-11-0-but-that-version-could-not-be-found-in-an/66961483#66961483", "title": "Your bundle is locked to ffi (1.11.0), but that version could not be found in any of the sources listed in your Gemfile", "body": "<p>Try update in mode conversative your dependencies:</p>\n<pre><code>bundle update --conservative ffi\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 11539591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f70196f5d8b372232969cea4f7ae28?s=128&d=identicon&r=PG&f=1", "display_name": "developing", "link": "https://stackoverflow.com/users/11539591/developing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5998, "favorite_count": 2, "accepted_answer_id": 56358955, "answer_count": 5, "score": 6, "last_activity_date": 1617670830, "creation_date": 1559125672, "last_edit_date": 1559126330, "question_id": 56358405, "link": "https://stackoverflow.com/questions/56358405/your-bundle-is-locked-to-ffi-1-11-0-but-that-version-could-not-be-found-in-an", "title": "Your bundle is locked to ffi (1.11.0), but that version could not be found in any of the sources listed in your Gemfile", "body": "<p>I get this error when starting the rails server:\nI've tried gem install, gem update, bundle update, bundle install.</p>\n\n<pre><code>Your bundle is locked to ffi (1.11.0), but that version could not be found in any of the sources listed in your Gemfile. If you haven't changed sources, that means the author of ffi\n(1.11.0) has removed it. You'll need to update your bundle to a version other than ffi (1.11.0) that hasn't been removed in order to install.\n</code></pre>\n\n<p>can you help? thank you!</p>\n\n<pre><code>source 'https://rubygems.org'\nruby '2.5.3'\n\ngem 'bootsnap', require: false\ngem 'jbuilder', '~&gt; 2.0'\ngem 'pg', '~&gt; 0.21'\ngem 'puma'\ngem 'shopify_app'\ngem 'rails', '5.2.3'\ngem 'redis'\ngem 'devise'\n\ngem 'autoprefixer-rails'\ngem 'font-awesome-sass', '~&gt; 5.6.1'\ngem 'sassc-rails'\ngem 'simple_form'\ngem 'uglifier'\ngem 'webpacker'\n\ngroup :development do\n  gem 'web-console', '&gt;= 3.3.0'\nend\n\ngroup :development, :test do\n  gem 'pry-byebug'\n  gem 'pry-rails'\n  gem 'listen', '~&gt; 3.0.5'\n  gem 'spring'\n  gem 'spring-watcher-listen', '~&gt; 2.0.0'\n  gem 'dotenv-rails'\n\nend\n\n</code></pre>\n\n<p>this is my rake file:</p>\n\n<pre><code>require_relative 'config/application'\n\nRails.application.load_tasks\n\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1559122955, "post_id": 56357521, "comment_id": 99318960, "body": "are you checking with<code>heroku run yarn -v</code>?"}, {"owner": {"reputation": 1, "user_id": 11571979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93c3a3b65b1a0264ea3b6c3da6b7990a?s=128&d=identicon&r=PG&f=1", "display_name": "kametyou777", "link": "https://stackoverflow.com/users/11571979/kametyou777"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1559124726, "post_id": 56357521, "comment_id": 99319996, "body": "@maxpleaner Thanks for your comment. It shows Running yarn -v on \u2b22 myapp... up, run.1301 (Free) bash: yarn: command not found. So it means there is no yarn on heroku? how do I download yarn in heroku?"}], "answers": [{"tags": [], "owner": {"reputation": 628, "user_id": 5954643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9tq2jIW1zsk/AAAAAAAAAAI/AAAAAAAABcY/id8Ndc5tWuY/photo.jpg?sz=128", "display_name": "Rajkumar Ulaganadhan", "link": "https://stackoverflow.com/users/5954643/rajkumar-ulaganadhan"}, "is_accepted": false, "score": 1, "last_activity_date": 1559125552, "creation_date": 1559125552, "answer_id": 56358373, "question_id": 56357521, "link": "https://stackoverflow.com/questions/56357521/ruby-on-rails-heroku-git-push-heroku-master-error/56358373#56358373", "title": "Ruby on Rails [heroku] git push heroku master error", "body": "<p>Try to add this gem in your gem file.</p>\n\n<pre><code>gem 'therubyracer'\n</code></pre>\n\n<p>Try this link:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/41883113/syntax-error-when-deploying-rails-app-to-heroku-execjsruntimeerror-syntaxerr\">Syntax error when deploying Rails app to Heroku: ExecJS::RuntimeError: SyntaxError: Unexpected character</a></p>\n"}, {"tags": [], "owner": {"reputation": 76, "user_id": 3295701, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eHGcR.jpg?s=128&g=1", "display_name": "SunTechnique", "link": "https://stackoverflow.com/users/3295701/suntechnique"}, "is_accepted": false, "score": 0, "last_activity_date": 1559129066, "creation_date": 1559129066, "answer_id": 56359473, "question_id": 56357521, "link": "https://stackoverflow.com/questions/56357521/ruby-on-rails-heroku-git-push-heroku-master-error/56359473#56359473", "title": "Ruby on Rails [heroku] git push heroku master error", "body": "<p><code>config.assets.js_compressor =: uglifier</code></p>\n\n<p><code>=: uglifier</code>\nspace between <code>:</code> and <code>uglifier</code>?</p>\n\n<p>should be <code>= :uglifier</code></p>\n\n<p>and try to use precompile command without string <code>RAILS_ENV = production</code>\nbecause Heroku installs production mode by default. if I'm not mistaken</p>\n"}, {"tags": [], "owner": {"reputation": 113, "user_id": 11570861, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Eg7Pcr4qH0c/AAAAAAAAAAI/AAAAAAAAB7M/k-kT3Sl7k6o/photo.jpg?sz=128", "display_name": "Nader-a", "link": "https://stackoverflow.com/users/11570861/nader-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1559157964, "last_edit_date": 1559157964, "creation_date": 1559157305, "answer_id": 56367134, "question_id": 56357521, "link": "https://stackoverflow.com/questions/56357521/ruby-on-rails-heroku-git-push-heroku-master-error/56367134#56367134", "title": "Ruby on Rails [heroku] git push heroku master error", "body": "<p>Try this, Go to heroku dashboard on their website, select your app, click on the gear icon (the settings), scroll down until you see \u201cbuild packs\u201d add ruby and nodejs buildpacks, and <strong>make sure</strong> the order is that that nodejs comes first in the list, and then ruby (from top to bottom). </p>\n\n<p>If that doesn\u2019t work, can you clarify how you are triggering the compilation of your JS?</p>\n\n<p>Explanation: I\u2019ve seen this error before(with npm, not yarn), essentially you want herokus nodejs buildpack to take care of JS compiling, the one rails has built in seems to not be compatible with their system.</p>\n"}], "owner": {"reputation": 1, "user_id": 11571979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93c3a3b65b1a0264ea3b6c3da6b7990a?s=128&d=identicon&r=PG&f=1", "display_name": "kametyou777", "link": "https://stackoverflow.com/users/11571979/kametyou777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1559157964, "creation_date": 1559122812, "question_id": 56357521, "link": "https://stackoverflow.com/questions/56357521/ruby-on-rails-heroku-git-push-heroku-master-error", "title": "Ruby on Rails [heroku] git push heroku master error", "body": "<p>I am trying to upload my web app on heroku, but the following error occurs. </p>\n\n<p>(I'm coding with cloud 9 IDE)</p>\n\n<pre><code>$ git push heroku master\n.....\nremote: -----&gt; Installing node-v10.14.1-linux-x64\nremote: -----&gt; Detecting rake tasks\nremote: -----&gt; Preparing app for Rails asset pipeline\nremote:        Running: rake assets:precompile\nremote:        Yarn executable was not detected in the system.\nremote:        Download Yarn at https://yarnpkg.com/en/docs/install\nremote:        I, [2019-05-22T02:13:47.373334 #1766]  INFO -- : Writing \n/tmp/build_fcc84922ee6a02bfc05a163c871d0548/public/assets/noimage- \n3aa3997354b4e9c37f379deb61626f55ade493078d1b42dcefe4a3ccbed34106.jpg\nremote:        rake aborted!\nremote:        ExecJS::RuntimeError: SyntaxError: Unexpected character '`'\nremote:        JS_Parse_Error.get ((execjs):3538:621)\nremote:        (execjs):4060:48\nremote:        (execjs):1:102\n.....\nremote:  !\nremote:  !     Precompiling assets failed.\nremote:  !\nremote:  !     Push rejected, failed to compile Ruby app.\n</code></pre>\n\n<p>First of all, It says that \"there Yarn executable was not detected in the system\", but it is properly downloaded if I check it with yarn -v.</p>\n\n<p>Also, ExecJS :: RuntimeError: SyntaxError: Unexpected character '`' error seems to be that es6 is not recognized, as a solution</p>\n\n<p>config.assets.js_compressor =: uglifier</p>\n\n<p>config.assets.js_compressor = Uglifier.new (harmony: true)</p>\n\n<p>Changed to This seems to be able to read es6. But the above error still persists.</p>\n\n<p>Also, if I run 'rake assets: precompile RAILS_ENV = production' on the console, it runs normally without error.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6606382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ywTyh.jpg?s=128&g=1", "display_name": "naman verma", "link": "https://stackoverflow.com/users/6606382/naman-verma"}, "edited": false, "score": 0, "creation_date": 1559121412, "post_id": 56356984, "comment_id": 99318094, "body": "I have done like this &lt;%=f.file_field :pdf_file, class: &#39;form-control input-md&#39; ,required: true%&gt;&lt;%= f.object&amp;.pdf_file&amp;.file&amp;.filename %&gt;......Now &#39;no file chosen&#39; and file name both are coming.When I click on submit button it ask to select file."}, {"owner": {"reputation": 87, "user_id": 2803930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f07b6f4e3ee819b13c58a8c887860328?s=128&d=identicon&r=PG&f=1", "display_name": "Ashish Garg", "link": "https://stackoverflow.com/users/2803930/ashish-garg"}, "reply_to_user": {"reputation": 15, "user_id": 6606382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ywTyh.jpg?s=128&g=1", "display_name": "naman verma", "link": "https://stackoverflow.com/users/6606382/naman-verma"}, "edited": false, "score": 0, "creation_date": 1559121543, "post_id": 56356984, "comment_id": 99318163, "body": "Yes it is the expected behaviour here. You should not add your &lt;%= f.object&amp;.pdf_file&amp;.file&amp;.filename %&gt; inside file field. you should add a link here in same level to file field to link you file.  If someone again selects the different file, just delete the previous one and add the new one."}, {"owner": {"reputation": 15, "user_id": 6606382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ywTyh.jpg?s=128&g=1", "display_name": "naman verma", "link": "https://stackoverflow.com/users/6606382/naman-verma"}, "edited": false, "score": 0, "creation_date": 1559121672, "post_id": 56356984, "comment_id": 99318244, "body": "Then how should I manage this case as it is asking to select file."}, {"owner": {"reputation": 87, "user_id": 2803930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f07b6f4e3ee819b13c58a8c887860328?s=128&d=identicon&r=PG&f=1", "display_name": "Ashish Garg", "link": "https://stackoverflow.com/users/2803930/ashish-garg"}, "reply_to_user": {"reputation": 15, "user_id": 6606382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ywTyh.jpg?s=128&g=1", "display_name": "naman verma", "link": "https://stackoverflow.com/users/6606382/naman-verma"}, "edited": false, "score": 0, "creation_date": 1559121793, "post_id": 56356984, "comment_id": 99318298, "body": "Do you want the file field to be not able to select the file in edit mode?  Let the user select the new file in edit mode of the form. If the file is changed then update your file."}, {"owner": {"reputation": 15, "user_id": 6606382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ywTyh.jpg?s=128&g=1", "display_name": "naman verma", "link": "https://stackoverflow.com/users/6606382/naman-verma"}, "edited": false, "score": 0, "creation_date": 1559122230, "post_id": 56356984, "comment_id": 99318549, "body": "I want the normal behaviour if file is available then it should be there and one wants to change they can click on &#39;choose file&#39; to select other one."}, {"owner": {"reputation": 87, "user_id": 2803930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f07b6f4e3ee819b13c58a8c887860328?s=128&d=identicon&r=PG&f=1", "display_name": "Ashish Garg", "link": "https://stackoverflow.com/users/2803930/ashish-garg"}, "reply_to_user": {"reputation": 15, "user_id": 6606382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ywTyh.jpg?s=128&g=1", "display_name": "naman verma", "link": "https://stackoverflow.com/users/6606382/naman-verma"}, "edited": false, "score": 1, "creation_date": 1559127013, "post_id": 56356984, "comment_id": 99321208, "body": "The approach that I follow here is -  When its a new record just show the file field. When its not a new record and image is available then show the image_tag.  Something like -  ``` &lt;% if !f.object.new_record? &amp;&amp; f.object.photo.present? %&gt;     &lt;%= image_tag :photo.url(:small) %&gt;   &lt;% else %&gt;     &lt;%=f.file_field :photo, class: &#39;form-control input-md&#39; ,required: true%&gt;   &lt;% end %&gt; ```"}, {"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 1, "creation_date": 1559199140, "post_id": 56356984, "comment_id": 99347990, "body": "@AshishGarg please, edit your answer and add code from your last comment"}, {"owner": {"reputation": 87, "user_id": 2803930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f07b6f4e3ee819b13c58a8c887860328?s=128&d=identicon&r=PG&f=1", "display_name": "Ashish Garg", "link": "https://stackoverflow.com/users/2803930/ashish-garg"}, "edited": false, "score": 0, "creation_date": 1566271693, "post_id": 56356984, "comment_id": 101593830, "body": "This worked for u? If yes then pls accept the answer."}], "tags": [], "owner": {"reputation": 87, "user_id": 2803930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f07b6f4e3ee819b13c58a8c887860328?s=128&d=identicon&r=PG&f=1", "display_name": "Ashish Garg", "link": "https://stackoverflow.com/users/2803930/ashish-garg"}, "is_accepted": false, "score": 1, "last_activity_date": 1559201188, "last_edit_date": 1559201188, "creation_date": 1559121118, "answer_id": 56356984, "question_id": 56356882, "link": "https://stackoverflow.com/questions/56356882/form-for-file-field-not-showing-file-chosen-in-edit-action/56356984#56356984", "title": "form_for &#39;file_field&#39; not showing file chosen in edit action", "body": "<p>You need to show that file through a link parallel to your file field.\nFile field itself cannot show the stored file in edit mode.</p>\n\n<pre><code>&lt;% if !f.object.new_record? &amp;&amp; f.object.photo.present? %&gt; \n  &lt;%= image_tag :photo.url(:small) %&gt; \n&lt;% else %&gt; \n  &lt;%=f.file_field :photo, class: 'form-control input-md' ,required: true%&gt; \n&lt;% end %&gt; \n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6606382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ywTyh.jpg?s=128&g=1", "display_name": "naman verma", "link": "https://stackoverflow.com/users/6606382/naman-verma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 966, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559201188, "creation_date": 1559120756, "last_edit_date": 1559199339, "question_id": 56356882, "link": "https://stackoverflow.com/questions/56356882/form-for-file-field-not-showing-file-chosen-in-edit-action", "title": "form_for &#39;file_field&#39; not showing file chosen in edit action", "body": "<p>I am using <code>file_field</code> and it is working fine on creation - file is getting saved. But when I'm doing edit of the same record <code>no file chosen</code> is coming.</p>\n\n<p>I have created partial form which I am using in new and edit actions. When I am clicking on edit option of a record all other fields are coming pre-selected but file is not coming.</p>\n\n<pre><code># edit.html.erb\n&lt;h3&gt;Order Detail&lt;/h3&gt;\n&lt;div id=\"field\"&gt;\n  &lt;div id=\"field0\"&gt;\n    &lt;%= render 'form', order_detail: @order_detail %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;   \n\n# _form.html.erb\n&lt;%= form_for @order_detail do |f| %&gt; \n  &lt;div class=\"form-group required\"&gt;\n    &lt;label class=\"col-md-4 control-label\" for=\"action_id\"&gt;Delivery Date&lt;/label&gt;  \n    &lt;div class=\"col-md-5\"&gt;\n      &lt;%=f.text_field :delivery_date, \"data-provide\" =&gt; 'datepicker', class: 'form-control input-md datepicker',id: 'selectDate2',placeholder: \"Delivery date(yyyy-mm-dd)\" ,required: true%&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"form-group required\"&gt;\n    &lt;label class=\"col-md-4 control-label\" for=\"action_id\"&gt;Pdf File&lt;/label&gt;  \n    &lt;div class=\"col-md-5\"&gt;\n      &lt;%=f.file_field :pdf_file, class: 'form-control input-md' ,required: true%&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= submit_tag \"Submit\",class:\"btn btn-success\" ,remote: true%&gt;\n  &lt;/div&gt;\n&lt;%end%&gt;\n</code></pre>\n\n<p>I am expecting file chosen should come but it's not coming as it is stored in database.</p>\n"}, {"tags": ["arrays", "ruby", "methods"], "comments": [{"owner": {"reputation": 159, "user_id": 9722060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd6af43aa5acad3d7111cc6be4d835bb?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Rendevski", "link": "https://stackoverflow.com/users/9722060/stefan-rendevski"}, "edited": false, "score": 0, "creation_date": 1559120027, "post_id": 56356283, "comment_id": 99317271, "body": "Why don&#39;t you make <code>@marker_positions</code> a 3x3 matrix, so that whenever a user inputs a position, you find the corresponding row and column, and update the value stored in that position?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 159, "user_id": 9722060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd6af43aa5acad3d7111cc6be4d835bb?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Rendevski", "link": "https://stackoverflow.com/users/9722060/stefan-rendevski"}, "edited": false, "score": 0, "creation_date": 1559123948, "post_id": 56356283, "comment_id": 99319585, "body": "@StefanRendevski in a 3&#215;3 grid choosing a slot from 1 to 9 seems easier than asking the user for row and column."}, {"owner": {"reputation": 9, "user_id": 11207487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kb4yk.jpg?s=128&g=1", "display_name": "keskiviikko", "link": "https://stackoverflow.com/users/11207487/keskiviikko"}, "edited": false, "score": 0, "creation_date": 1559125508, "post_id": 56356283, "comment_id": 99320396, "body": "I should try that too. Thanks for the reply!"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 11207487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kb4yk.jpg?s=128&g=1", "display_name": "keskiviikko", "link": "https://stackoverflow.com/users/11207487/keskiviikko"}, "edited": false, "score": 0, "creation_date": 1559125388, "post_id": 56357028, "comment_id": 99320342, "body": "Thanks! That&#39;s very helpful (if a little confusing). I uploaded my working game to github <a href=\"https://github.com/keskiviikko/project_tictactoe/blob/master/tictactoe.rb\" rel=\"nofollow noreferrer\">link</a>. I know, it isn&#39;t very DRY. Need to improve it though."}, {"owner": {"reputation": 9, "user_id": 11207487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kb4yk.jpg?s=128&g=1", "display_name": "keskiviikko", "link": "https://stackoverflow.com/users/11207487/keskiviikko"}, "edited": false, "score": 0, "creation_date": 1559125628, "post_id": 56357028, "comment_id": 99320457, "body": "Oh, didn&#39;t notice you edited your answer. That&#39;s even more helpful! Thank you so much."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 9, "user_id": 11207487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kb4yk.jpg?s=128&g=1", "display_name": "keskiviikko", "link": "https://stackoverflow.com/users/11207487/keskiviikko"}, "edited": false, "score": 0, "creation_date": 1559126213, "post_id": 56357028, "comment_id": 99320780, "body": "@keskiviikko you&#39;re welcome. BTW, if having two separate arrays seems like a bad idea in hindsight, you should maybe just ditch them. You&#39;re writing software after all, it&#39;s easy to change :-)"}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 1, "last_activity_date": 1559124232, "last_edit_date": 1559124232, "creation_date": 1559121211, "answer_id": 56357028, "question_id": 56356283, "link": "https://stackoverflow.com/questions/56356283/ruby-how-to-replace-elements-in-an-array/56357028#56357028", "title": "Ruby: How to replace elements in an Array?", "body": "<blockquote>\n  <p>So when a player selects number 1 @marker_positions[0] would be replaced as \"X\"</p>\n</blockquote>\n\n<p>You just have to read the user input: (example shows result for player entering <kbd>1</kbd>)</p>\n\n<pre><code>input = gets.to_i\n#=&gt; 1\n</code></pre>\n\n<p>and replace the corresponding array element: (we have to subtract 1 because array is zero-based)</p>\n\n<pre><code>@marker_positions[input - 1] = 'X'\n</code></pre>\n\n<p>Using the array values within the grid string is another issue. The interpolations via <code>#{...}</code> happens when creating the string, just before it is assigned to <code>@grid</code> in <code>initialize</code>. This means the string is not being updated when the interpolated value changes afterwards \u2013 it just stays the same unless you interpolate it again:</p>\n\n<pre><code>x = 'foo'\n@grid = \"hello #{x}\"\n#=&gt; \"Hello foo\"\n\nx = 'bar'\n@grid\n#=&gt; \"Hello foo\"  &lt;- doesn't change\n\n@grid = \"hello #{x}\"\n#=&gt; \"Hello bar\"\n</code></pre>\n\n<p>To get a \"fresh\" grid every time you call <code>add_markers</code> you could simply move the string interpolation code from <code>initialize</code> into that method: (instead of <code>\"...\"</code>, I'm using <code>&lt;&lt;~EOD ... EOD</code>, a \"squiggly\" <a href=\"http://ruby-doc.org/core-2.6.3/doc/syntax/literals_rdoc.html#label-Here+Documents\" rel=\"nofollow noreferrer\">heredoc</a> which ignores leading whitespace)</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Grid\n  attr_accessor :marker_positions\n\n  def initialize\n    @marker_positions = [1, 2, 3, 4, 5, 6, 7, 8, 9]\n  end\n\n  def add_markers\n    puts &lt;&lt;~EOD\n      |----|----|----|\n      |  #{@marker_positions[0]} |  #{@marker_positions[1]} |  #{@marker_positions[2]} |\n      |----|----|----|\n      |  #{@marker_positions[3]} |  #{@marker_positions[4]} |  #{@marker_positions[5]} |\n      |----|----|----|\n      |  #{@marker_positions[6]} |  #{@marker_positions[7]} |  #{@marker_positions[8]} |\n      |----|----|----|\n    EOD\n  end\nend\n</code></pre>\n\n<p>This would result in: (the <code>#</code> are not part of the actual output)</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>grid = Grid.new\ngrid.add_markers\n#|----|----|----|\n#|  1 |  2 |  3 |\n#|----|----|----|\n#|  4 |  5 |  6 |\n#|----|----|----|\n#|  7 |  8 |  9 |\n#|----|----|----|\n\ngrid.marker_positions[0] = 'X'\ngrid.marker_positions[4] = 'X'\ngrid.marker_positions[8] = 'X'\ngrid.add_markers\n#|----|----|----|\n#|  X |  2 |  3 |\n#|----|----|----|\n#|  4 |  X |  6 |\n#|----|----|----|\n#|  7 |  8 |  X |\n#|----|----|----|\n</code></pre>\n\n<hr>\n\n<p>Another \u2013 maybe cleaner \u2013 option is to define a template with placeholders that are replaced by their actual (or current) values when rendering the template:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Grid\n  TEMPLATE = &lt;&lt;~EOD.freeze\n    \u250c\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2510\n    \u2502 1 \u2502 2 \u2502 3 \u2502\n    \u251c\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2524\n    \u2502 4 \u2502 5 \u2502 6 \u2502\n    \u251c\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2524\n    \u2502 7 \u2502 8 \u2502 9 \u2502\n    \u2514\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2518\n  EOD\n\n  attr_accessor :marker_positions\n\n  def initialize\n    @marker_positions = [1, 2, 3, 4, 5, 6, 7, 8, 9]\n  end\n\n  def render\n    puts TEMPLATE.gsub(/[1-9]/) { |d| @marker_positions[d.to_i - 1] }\n  end\nend\n</code></pre>\n\n<p><a href=\"http://ruby-doc.org/core-2.6.3/String.html#method-i-gsub\" rel=\"nofollow noreferrer\"><code>gsub</code></a> scans the template string for digits <code>1</code> to <code>9</code> and replaces each occurrence <code>d</code> with the block's result, which simply picks the corresponding value from our array.</p>\n\n<p>Usage:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>grid = Grid.new\ngrid.render\n#\u250c\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2510\n#\u2502 1 \u2502 2 \u2502 3 \u2502\n#\u251c\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2524\n#\u2502 4 \u2502 5 \u2502 6 \u2502\n#\u251c\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2524\n#\u2502 7 \u2502 8 \u2502 9 \u2502\n#\u2514\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2518\n\ngrid.marker_positions[0] = 'X'\ngrid.marker_positions[4] = 'X'\ngrid.marker_positions[8] = 'X'\ngrid.render\n#\u250c\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2510\n#\u2502 X \u2502 2 \u2502 3 \u2502\n#\u251c\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2524\n#\u2502 4 \u2502 X \u2502 6 \u2502\n#\u251c\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2524\n#\u2502 7 \u2502 8 \u2502 X \u2502\n#\u2514\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2518\n</code></pre>\n\n<p>The Unicode <a href=\"https://en.wikipedia.org/wiki/Box-drawing_character\" rel=\"nofollow noreferrer\">box-drawing characters</a> are just for demonstration purposes, it will work just fine with ASCII characters.</p>\n\n<p>Based on the above, a very basic game loop could look like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>grid = Grid.new\n\n%w[X O].cycle do |marker|\n  grid.render\n  print \"Player #{marker}: \"\n  input = gets.to_i\n  grid.marker_positions[input - 1] = marker\n  # TODO: break if player wins\nend\n</code></pre>\n\n<p>The code <a href=\"http://ruby-doc.org/core-2.6.3/Array.html#method-i-cycle\" rel=\"nofollow noreferrer\"><code>cycle</code></a>s between <code>\"X\"</code> and <code>\"O\"</code> and for each iteration:</p>\n\n<ul>\n<li>renders the grid</li>\n<li>ask the player with that marker for their input</li>\n<li>updates the <code>marker_positions</code></li>\n</ul>\n\n<p>What's missing is an additional step to <code>break</code> the loop if a player wins. And probably some logic to validate the input (prevent a player from overwriting a spot already taken, check that input is within 1-9 etc).</p>\n\n<p>Hope this helps.</p>\n\n<p>A last note: assuming that users enter their input via a computer keyboard, you might want to flip the grid vertically to match the layout of a <a href=\"https://en.wikipedia.org/wiki/Numeric_keypad\" rel=\"nofollow noreferrer\">numeric keypad</a>.</p>\n"}], "owner": {"reputation": 9, "user_id": 11207487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kb4yk.jpg?s=128&g=1", "display_name": "keskiviikko", "link": "https://stackoverflow.com/users/11207487/keskiviikko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 56357028, "answer_count": 1, "score": 0, "last_activity_date": 1559124232, "creation_date": 1559118836, "last_edit_date": 1559119329, "question_id": 56356283, "link": "https://stackoverflow.com/questions/56356283/ruby-how-to-replace-elements-in-an-array", "title": "Ruby: How to replace elements in an Array?", "body": "<p>I'm building a simple tic-tac-toe game and I've totally hit a wall with my grid.</p>\n\n<p>I'd like to \"puts @grid\" <em>including player input</em> every time players have made their choice. How can I achieve this? I'm almost a total beginner with Ruby and have never build any games before. Any help is greatly appreciated, thanks in advance!</p>\n\n<p>I tried making two different grids (grid and grid_with_markers) but couldn't figure out where to go from there. Looking back, having two grids also just seemed like a bad idea. I also tried having a Hash (marker_positions), but that seemed overly complicated compared to an Array.</p>\n\n<p>Here is the grid</p>\n\n<pre><code>def initialize\n    @possible_choice = [1,2,3,4,5,6,7,8,9]\n    @marker_positions = [1,2,3,4,5,6,7,8,9]\n    @grid = \"\n                |----|----|----|   \n                |  #{@marker_positions[0]} |  #{@marker_positions[1]} |  #{@marker_positions[2]} |\n                |----|----|----|\n                |  #{@marker_positions[3]} |  #{@marker_positions[4]} |  #{@marker_positions[5]} |\n                |----|----|----|\n                |  #{@marker_positions[6]} |  #{@marker_positions[7]} |  #{@marker_positions[8]} |\n                |----|----|----|\n                \"\nend\n</code></pre>\n\n<p>I'd like to use a method add_markers to show the grid with user input. So when a player selects number 1 @marker_positions[0] would be replaced as \"X\" (or \"O\"). Number 4 would replace @marker_positions[3] etc.</p>\n\n<p><strong>Edit</strong>: I realised the title of this post was misleading since I actually want to replace elements of @marker_positions Array with <em>Strings</em> (\"X\" or \"O\"). But the replaced element is selected based on user input, in other words, player_one and player_two Arrays.</p>\n\n<pre><code>def add_markers\n  puts @grid\nend\n</code></pre>\n\n<p>Here's the player_one_turn method</p>\n\n<pre><code>def player_one_turn()\n    puts \"Player One, make your choice:\"\n    p @possible_choice\n    add_markers\n    @@player_one &lt;&lt; @possible_choice.delete(gets.chomp.to_i)\n    p \"Player One has chosen: #{@@player_one}\"\nend\n</code></pre>\n\n<p>And here's my entire tictactoe.rb file.</p>\n\n<pre><code>\nclass Grid\n    WINNING_COMBOS = [\n        [1,2,3],[4,5,6],[7,8,9],\n        [1,4,7],[2,5,8],[3,6,9],\n        [1,5,9],[3,5,7]\n    ]\n    attr_accessor :possible_choice\n    attr_accessor :marker_positions\n    attr_accessor :grid\n\n    def initialize\n        @possible_choice = [1,2,3,4,5,6,7,8,9]\n        @marker_positions = [1,2,3,4,5,6,7,8,9]\n        @grid = \"\n                |----|----|----|   \n                |  #{@marker_positions[0]} |  #{@marker_positions[1]} |  #{@marker_positions[2]} |\n                |----|----|----|\n                |  #{@marker_positions[3]} |  #{@marker_positions[4]} |  #{@marker_positions[5]} |\n                |----|----|----|\n                |  #{@marker_positions[6]} |  #{@marker_positions[7]} |  #{@marker_positions[8]} |\n                |----|----|----|\n                \"\n    end\n\n    def add_markers\n\n        puts @grid\n    end\nend\n\nclass Game &lt; Grid\n    @@player_one = Array.new\n    @@player_two = Array.new\n\n    def game\n        puts\n        puts \"*** This is a tic-tac-toe game for two human players. ***\"\n        puts\n        loop do\n            player_one_turn()\n            puts\n                if has_won?(@@player_one)\n                    puts \"The game has ended. Player One has won!\"\n                    puts\n                    return\n                end\n            break if @@player_one.length == 5 || @@player_one.include?(nil)\n            player_two_turn()\n            puts\n                if has_won?(@@player_two)\n                    puts \"The game has ended. Player Two has won!\"\n                    puts\n                    return\n                end\n        end\n    end\n\n    def player_one_turn()\n        puts \"Player One, make your choice:\"\n        p @possible_choice\n        add_markers\n        @@player_one &lt;&lt; @possible_choice.delete(gets.chomp.to_i)\n        p \"Player One has chosen: #{@@player_one}\"\n    end\n\n    def player_two_turn()\n        puts \"Player Two, make your choice:\"\n        p @possible_choice\n        add_markers\n        @@player_two &lt;&lt; @possible_choice.delete(gets.chomp.to_i)\n        p \"Player Two has chosen: #{@@player_two}\"\n    end\n\n    def has_won?(player)\n        WINNING_COMBOS.any? { |combo| (player &amp; combo).size == combo.size}\n    end\nend\n\nnew_game = Game.new\nnew_game.game\n\n</code></pre>\n\n<p>(I know it isn't very clean. Thank you for taking time to read all the way down here.)</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1559118615, "post_id": 56356143, "comment_id": 99316531, "body": "<code>post_like_path</code> routes by default to <code>posts#show</code> action (and you must provide post id to make it work) while <code>posts_like</code> routes to <code>posts#index</code>."}, {"owner": {"reputation": 5644, "user_id": 9908141, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/seDql.jpg?s=128&g=1", "display_name": "Imran Ahmad", "link": "https://stackoverflow.com/users/9908141/imran-ahmad"}, "edited": false, "score": 0, "creation_date": 1559118820, "post_id": 56356143, "comment_id": 99316629, "body": "Please go through <a href=\"https://guides.rubyonrails.org/routing.html\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/routing.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 443, "user_id": 3678149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YVIsD.jpg?s=128&g=1", "display_name": "kishore cheruku", "link": "https://stackoverflow.com/users/3678149/kishore-cheruku"}, "is_accepted": false, "score": 0, "last_activity_date": 1559118867, "creation_date": 1559118867, "answer_id": 56356290, "question_id": 56356143, "link": "https://stackoverflow.com/questions/56356143/understanding-rails-singular-and-plural-paths/56356290#56356290", "title": "Understanding Rails singular and plural paths", "body": "<p>post model can have multiple likes. But when we do undo like it will be singular right. so <code>post_like_path</code> will handle the single like and it's going to trigger \"delete\" action in controller. </p>\n\n<p><code>post_likes_path</code> will trigger the new action for for creating new like. </p>\n\n<p>Please routes <strong>resources</strong> concept then you come to know more about it.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10202940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FTNgT.png?s=128&g=1", "display_name": "Tiago Soares", "link": "https://stackoverflow.com/users/10202940/tiago-soares"}, "is_accepted": false, "score": 0, "last_activity_date": 1559119184, "creation_date": 1559119184, "answer_id": 56356381, "question_id": 56356143, "link": "https://stackoverflow.com/questions/56356143/understanding-rails-singular-and-plural-paths/56356381#56356381", "title": "Understanding Rails singular and plural paths", "body": "<p>post_like_path is used for show page, update and destroy path. The post_likes_path will give you the path for the index and create actions.</p>\n\n<p>This link is the ROR guide and has quite a simple explanation on it:</p>\n\n<p><a href=\"https://guides.rubyonrails.org/routing.html#specifying-a-controller-to-use\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/routing.html#specifying-a-controller-to-use</a></p>\n"}, {"tags": [], "owner": {"reputation": 87, "user_id": 2803930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f07b6f4e3ee819b13c58a8c887860328?s=128&d=identicon&r=PG&f=1", "display_name": "Ashish Garg", "link": "https://stackoverflow.com/users/2803930/ashish-garg"}, "is_accepted": true, "score": 0, "last_activity_date": 1560155856, "last_edit_date": 1560155856, "creation_date": 1559119364, "answer_id": 56356441, "question_id": 56356143, "link": "https://stackoverflow.com/questions/56356143/understanding-rails-singular-and-plural-paths/56356441#56356441", "title": "Understanding Rails singular and plural paths", "body": "<p>In Rails as per the REST - </p>\n\n<ol>\n<li><p>If trying to refer to the single resource then use <code>post_like_path</code>.</p></li>\n<li><p>If trying to refer to a collection of resources then use <code>post_likes_path</code></p></li>\n</ol>\n\n<p>When you want to <code>show</code> or <code>delete</code> a particular resource then you will have to provide an <code>:id</code> for the resource so that the target resource can be found.</p>\n\n<p>[/posts/1/likes/1] - A single record of \"like\" is being referred here.</p>\n\n<p>While in case of all records plural path is formed to refer to all like records - </p>\n\n<p>[/posts/1/likes] - All records of \"like\" are being referred here.</p>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1559124090, "creation_date": 1559124090, "answer_id": 56357937, "question_id": 56356143, "link": "https://stackoverflow.com/questions/56356143/understanding-rails-singular-and-plural-paths/56357937#56357937", "title": "Understanding Rails singular and plural paths", "body": "<p>I'd suggest to always run this command from terminal:</p>\n\n<pre><code>rake routes\n</code></pre>\n\n<p>Or just for <code>LikesController</code>:</p>\n\n<pre><code>rake routes -c likes\n</code></pre>\n\n<p>This shows <strong>all the routes related to likes controllers</strong>. That's the output, it tells a lot of things. You can see where the plural and singular is used.</p>\n\n<pre><code>#         Prefix Verb   URI Pattern                              Controller#Action\n#     post_likes GET    /posts/:post_id/likes(.:format)          likes#index\n#                POST   /posts/:post_id/likes(.:format)          likes#create\n#  new_post_like GET    /posts/:post_id/likes/new(.:format)      likes#new\n# edit_post_like GET    /posts/:post_id/likes/:id/edit(.:format) likes#edit\n#      post_like GET    /posts/:post_id/likes/:id(.:format)      likes#show\n#                PATCH  /posts/:post_id/likes/:id(.:format)      likes#update\n#                PUT    /posts/:post_id/likes/:id(.:format)      likes#update\n#                DELETE /posts/:post_id/likes/:id(.:format)      likes#destroy\n</code></pre>\n\n<p>First column shows you the path, the second the pattern (with required parameters) and the third the controller with action (related to the view).</p>\n\n<p><strong>So, for example, take</strong></p>\n\n<pre><code>#\u00a0new_post_like GET    /posts/:post_id/likes/new(.:format)      likes#new\n</code></pre>\n\n<p>This says that the form for a new like can be placed to a page linked by this URL:\n<code>new_post_like_path(post_id: @post)</code> note the parameter required. The page is <code>views/likes/new.html.erb</code>.\nthe controller is <code>LikesController</code> and the action is <code>def new; end</code> where you need to instantiate the objects to be used in that page: <code>@like = Like.new</code> and <code>@post = Post.find(params[:post_id])</code>.</p>\n\n<p>The form is then submitted by POST action, so the line to check is the following:</p>\n\n<pre><code># post_likes POST   /posts/:post_id/likes(.:format)          likes#create\n</code></pre>\n\n<p>As before, the page where the form is located is <code>views/likes/new.html.erb</code>, the url to submit the form is <code>post_likes_path(post.id)</code>. The POST action when submitting the form is processed by the controller <code>LikesController</code> and the action is <code>def create; end</code></p>\n\n<p><strong>Other example:</strong></p>\n\n<pre><code># post_like GET    /posts/:post_id/likes/:id(.:format)      likes#show\n</code></pre>\n\n<p>It tells that to show the <code>Like</code> object with a certain <code>id</code>, you need to visit this <code>link_to</code>: <code>post_like_path(post.id, like.id)</code>, the controller is <code>LikesController</code>, the action is <code>def show; end</code> and the view is in <code>views/likes/show.html.erb</code>.</p>\n\n<p>And so on..</p>\n"}], "owner": {"reputation": 351, "user_id": 11196706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f06fbb48577defe7d7b222b6a05a98f?s=128&d=identicon&r=PG&f=1", "display_name": "juemura7", "link": "https://stackoverflow.com/users/11196706/juemura7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 56356441, "answer_count": 4, "score": 0, "last_activity_date": 1560155856, "creation_date": 1559118356, "question_id": 56356143, "link": "https://stackoverflow.com/questions/56356143/understanding-rails-singular-and-plural-paths", "title": "Understanding Rails singular and plural paths", "body": "<p>I'm very new to using Rails and at the moment am building an Instagram clone as a project to help me understand Rails a bit better. I am following this very helpful tutorial on how to implement the likes/unlikes feature: </p>\n\n<p><a href=\"https://medium.com/full-taxx/how-to-add-likes-to-posts-in-rails-e81430101bc2\" rel=\"nofollow noreferrer\">https://medium.com/full-taxx/how-to-add-likes-to-posts-in-rails-e81430101bc2</a> </p>\n\n<p>However, I don't fully understand the Rails paths - please could someone explain the difference between: </p>\n\n<p><code>post_like_path</code> and <code>post_likes_path</code> as mentioned in the tutorial. I cannot see why one is like and one is likes? :( </p>\n\n<p>Really trying to get my head around this so would be so grateful for any insight!</p>\n\n<p>Thanks :) </p>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11510146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23cc4e72d52e4090891705571ae6b9f6?s=128&d=identicon&r=PG&f=1", "display_name": "sm83", "link": "https://stackoverflow.com/users/11510146/sm83"}, "edited": false, "score": 0, "creation_date": 1559127367, "post_id": 56355777, "comment_id": 99321404, "body": "Great, Thanks!!"}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 3, "last_activity_date": 1559118703, "last_edit_date": 1559118703, "creation_date": 1559117066, "answer_id": 56355777, "question_id": 56355370, "link": "https://stackoverflow.com/questions/56355370/how-do-i-add-variable-number-of-months-to-a-date-in-ruby-avoid-using-loop/56355777#56355777", "title": "How do I add variable number of months to a date in Ruby (avoid using loop)", "body": "<p>Your code works perfectly fine:</p>\n\n<pre><code>x = 4\nTime.zone.today + x.month\n#=&gt; Sun, 29 Sep 2019\n</code></pre>\n\n<p><a href=\"https://api.rubyonrails.org/classes/Integer.html#method-i-month\" rel=\"nofollow noreferrer\"><code>month</code></a> is a method defined on <code>Integer</code>. It doesn't matter if the integer is given as a literal or as a variable. The receiver just has to be an <code>Integer</code>.</p>\n\n<hr>\n\n<p>Instead of <code>Time.zone.today</code> you could also call <a href=\"https://api.rubyonrails.org/classes/Date.html#method-c-current\" rel=\"nofollow noreferrer\"><code>Date.current</code></a>:</p>\n\n<pre><code>Date.current + 4.month  #=&gt; Sun, 29 Sep 2019\n</code></pre>\n\n<p>Rails also adds a variety of other methods to <a href=\"https://api.rubyonrails.org/classes/Date.html\" rel=\"nofollow noreferrer\"><code>Date</code></a>: (also via <a href=\"https://api.rubyonrails.org/classes/DateAndTime/Calculations.html\" rel=\"nofollow noreferrer\"><code>DateAndTime::Calculations</code></a>)</p>\n\n<pre><code>Date.current.advance(months: 4) #=&gt; Sun, 29 Sep 2019\nDate.current.months_since(4)    #=&gt; Sun, 29 Sep 2019\n4.months.since(Date.current)    #=&gt; Sun, 29 Sep 2019\n</code></pre>\n\n<p>The above also work for instances of <code>Time</code>:</p>\n\n<pre><code>Time.current.advance(months: 4) #=&gt; Sun, 29 Sep 2019 10:11:52 CEST +02:00\nTime.current.months_since(4)    #=&gt; Sun, 29 Sep 2019 10:11:52 CEST +02:00\n4.months.since                  #=&gt; Sun, 29 Sep 2019 10:11:52 CEST +02:00\n</code></pre>\n\n<p>When only dealing with dates, Ruby's built-in <a href=\"http://ruby-doc.org/stdlib-2.6.3/libdoc/date/rdoc/Date.html#method-i-3E-3E\" rel=\"nofollow noreferrer\"><code>&gt;&gt;</code></a> or <a href=\"http://ruby-doc.org/stdlib-2.6.3/libdoc/date/rdoc/Date.html#method-i-next_month\" rel=\"nofollow noreferrer\"><code>next_month</code></a> might be used as well:</p>\n\n<pre><code>Date.current &gt;&gt; 4\n#=&gt; Sun, 29 Sep 2019\n\nDate.current.next_month(4)\n#=&gt; Sun, 29 Sep 2019\n</code></pre>\n\n<p>Note that you can use <code>4</code> and <code>x</code> interchangeably in all of the above examples.</p>\n"}], "owner": {"reputation": 13, "user_id": 11510146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23cc4e72d52e4090891705571ae6b9f6?s=128&d=identicon&r=PG&f=1", "display_name": "sm83", "link": "https://stackoverflow.com/users/11510146/sm83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 56355777, "answer_count": 1, "score": 1, "last_activity_date": 1559119523, "creation_date": 1559115636, "last_edit_date": 1559119523, "question_id": 56355370, "link": "https://stackoverflow.com/questions/56355370/how-do-i-add-variable-number-of-months-to-a-date-in-ruby-avoid-using-loop", "title": "How do I add variable number of months to a date in Ruby (avoid using loop)", "body": "<p>Is there something similar to the code below in Ruby where <strong>X</strong> stands for the number of months to add to today's date but is coming from a variable</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Time.zone.today + X.month ## X comes from a variable\n</code></pre>\n\n<p><strong>Preferably without using a loop as 'm' can be large number in the example below</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def add_months_to_today(m)\n  number_of_months_to_add = m.to_i\n  return_date = Time.zone.today\n  if m.to_i &gt; 0\n    (1..number_of_months_to_add).each do |i|\n      return_date = return_date + 1.month\n    end     \n  end\n\n  return_date\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby"], "comments": [{"owner": {"reputation": 616, "user_id": 7922428, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vINFX.png?s=128&g=1", "display_name": "Bman70", "link": "https://stackoverflow.com/users/7922428/bman70"}, "edited": false, "score": 0, "creation_date": 1559114506, "post_id": 56354993, "comment_id": 99314296, "body": "I&#39;m not seeing this behavior, <code>ar = [&quot;happy&quot;, &quot;happy&quot;, &quot;happy&quot;, &quot;happy&quot;] ar[1] &lt;&lt;&quot; Dino&quot;</code>, the output is  <code>happy happy Dino happy happy</code>"}, {"owner": {"reputation": 481, "user_id": 9563947, "user_type": "registered", "profile_image": "https://graph.facebook.com/1677134499029007/picture?type=large", "display_name": "Shan", "link": "https://stackoverflow.com/users/9563947/shan"}, "reply_to_user": {"reputation": 616, "user_id": 7922428, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vINFX.png?s=128&g=1", "display_name": "Bman70", "link": "https://stackoverflow.com/users/7922428/bman70"}, "edited": false, "score": 0, "creation_date": 1559115034, "post_id": 56354993, "comment_id": 99314582, "body": "@Bman70 it won&#39;t happen when you do like that. Try using Array.new(size, string). When we declare and initialize an array with new. I am thinking the same string is getting copied to all elements, Which makes their object id same."}, {"owner": {"reputation": 616, "user_id": 7922428, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vINFX.png?s=128&g=1", "display_name": "Bman70", "link": "https://stackoverflow.com/users/7922428/bman70"}, "edited": false, "score": 1, "creation_date": 1559115468, "post_id": 56354993, "comment_id": 99314824, "body": "By gum, you&#39;re right. Strange."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1559116031, "post_id": 56354993, "comment_id": 99315108, "body": "Can you explain what <i>precisely</i> is unclear to you about the documentation of <code>Array::new</code>? That way, the Ruby developers can improve the documentation so that future developers don&#39;t fall into the same trap as you did. Please, help making the world a better place!"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1559124882, "post_id": 56354993, "comment_id": 99320087, "body": "The documentation contains a <a href=\"http://ruby-doc.org/core-2.6.3/Array.html#method-c-new-label-Common+gotchas\" rel=\"nofollow noreferrer\">common gotchas</a> section explaining what&#39;s going on: <i>&quot;the same object will be used as the value for all the array elements [\u2026] changes to one of them will affect them all&quot;</i>"}], "answers": [{"tags": [], "owner": {"reputation": 443, "user_id": 3678149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YVIsD.jpg?s=128&g=1", "display_name": "kishore cheruku", "link": "https://stackoverflow.com/users/3678149/kishore-cheruku"}, "is_accepted": false, "score": 2, "last_activity_date": 1559115328, "creation_date": 1559115328, "answer_id": 56355297, "question_id": 56354993, "link": "https://stackoverflow.com/questions/56354993/value-inside-array-having-same-object-id/56355297#56355297", "title": "Value inside array having same object id", "body": "<p>When we take Array.new(4, \"Happy\") it will create 4 elements with same object id. We can observe in irb <code>arr[1].object_id =&gt; 2880099</code> , <code>arr[2].object_id =&gt; 2880099</code> and remaining 2 elements also will return same object id.</p>\n\n<p>So when we try like <code>arr[1] &lt;&lt; \"Something\"</code> , this string will append to all the same object id's.</p>\n\n<p>Now if we take another element for <strong>arr</strong> like <code>arr.push(\"newString\")</code>. Now if see the last element object id <code>arr.last.object_id =&gt; 4889988</code>,it's different now. </p>\n\n<p>So if we try same command <code>arr[1] &lt;&lt; \"Something\"</code> it won't be effect to newly inserted element because object id is different. </p>\n\n<p>if you don't want this behaviour the use <code>Array.new(4){ 'String' }</code></p>\n"}, {"tags": [], "owner": {"reputation": 645, "user_id": 589384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8957681fbb8dba72e9c710e4ddf57c83?s=128&d=identicon&r=PG", "display_name": "Peter Balaban", "link": "https://stackoverflow.com/users/589384/peter-balaban"}, "is_accepted": true, "score": 3, "last_activity_date": 1559115346, "creation_date": 1559115346, "answer_id": 56355299, "question_id": 56354993, "link": "https://stackoverflow.com/questions/56354993/value-inside-array-having-same-object-id/56355299#56355299", "title": "Value inside array having same object id", "body": "<p>Yes, you a right. See the <a href=\"https://ruby-doc.org/core-2.4.1/Array.html#method-c-new\" rel=\"nofollow noreferrer\">ruby docs</a></p>\n\n<blockquote>\n  <p>When a size and an optional default are sent, an array is created with size copies of default. Take notice that all elements will reference the same object default.</p>\n</blockquote>\n\n<p>You can initialize array in a way like this:</p>\n\n<pre><code>arr = Array.new(4){ 'happy' }\n</code></pre>\n"}], "owner": {"reputation": 481, "user_id": 9563947, "user_type": "registered", "profile_image": "https://graph.facebook.com/1677134499029007/picture?type=large", "display_name": "Shan", "link": "https://stackoverflow.com/users/9563947/shan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "closed_date": 1559117753, "accepted_answer_id": 56355299, "answer_count": 2, "score": 0, "last_activity_date": 1559282566, "creation_date": 1559114130, "last_edit_date": 1559282566, "question_id": 56354993, "link": "https://stackoverflow.com/questions/56354993/value-inside-array-having-same-object-id", "closed_reason": "Duplicate", "title": "Value inside array having same object id", "body": "<p>Recently I was playing with arrays and found out a weird behavior. I created a new array using Array.new.</p>\n\n<p><code>arr = Array.new(4,\"happy\")</code></p>\n\n<p><code>[\"happy\", \"happy\", \"happy\", \"happy\"]</code></p>\n\n<p>I appended a word into the second element in that array like shown below</p>\n\n<p><code>arr[1] &lt;&lt;\" Dino\"</code></p>\n\n<p>When I looked at arr, I was expecting an array with the second element having an appended word. But to my surprise array returned with all elements with the appended word.</p>\n\n<p><code>[\"happy Dino\", \"happy Dino\", \"happy Dino\", \"happy Dino\"]</code></p>\n\n<p>How can this happen? Are we creating copies of the same string when we are creating the array? It doesn't happen if we use <code>arr[1]= \" Dino\"</code>. Somebody can explain why this is happening?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "error-handling", "raise"], "comments": [{"owner": {"reputation": 423, "user_id": 2029932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44c5fbea96c3b8c76a0ae4b266f058c9?s=128&d=identicon&r=PG", "display_name": "Leonardo Prado", "link": "https://stackoverflow.com/users/2029932/leonardo-prado"}, "edited": false, "score": 1, "creation_date": 1559104317, "post_id": 56352831, "comment_id": 99310678, "body": "I&#39;ve just pasted your code on a random app here and it worked as expected!   Maybe something else on your code that is the problem? Some  <code>application.rb</code> or <code>development.rb</code> configuration? When on pry, <code>Rails.env</code> return the correct environment? Which Rails version are you using?"}, {"owner": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "reply_to_user": {"reputation": 423, "user_id": 2029932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44c5fbea96c3b8c76a0ae4b266f058c9?s=128&d=identicon&r=PG", "display_name": "Leonardo Prado", "link": "https://stackoverflow.com/users/2029932/leonardo-prado"}, "edited": false, "score": 0, "creation_date": 1559107425, "post_id": 56352831, "comment_id": 99311396, "body": "@LeonardoPrado Huh, that&#39;s weird, but you&#39;re right! I removed all my custom error handling code and the error page still has no details. I&#39;m using Rails 6.0.0.rc1 and Rails.env does return &quot;development&quot;..."}], "answers": [{"tags": [], "owner": {"reputation": 54, "user_id": 11378443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7309052c7afed1a17f2670858200ed09?s=128&d=identicon&r=PG&f=1", "display_name": "NensiMakawana", "link": "https://stackoverflow.com/users/11378443/nensimakawana"}, "is_accepted": false, "score": 0, "last_activity_date": 1559105422, "creation_date": 1559105422, "answer_id": 56353297, "question_id": 56352831, "link": "https://stackoverflow.com/questions/56352831/rails-default-error-page-doesnt-show-on-development/56353297#56353297", "title": "Rails default error page doesn&#39;t show on development", "body": "<p>create ErrorsController like below</p>\n\n<pre><code>class ErrorsController &lt; ApplicationController\n   skip_before_action :login\n\n   def not_found\n     respond_to do |format|\n       format.html { render status: 404 }\n       format.json { render json: { error: \"Not found\" }, status: 404 }\n     end\n   end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "edited": false, "score": 0, "creation_date": 1559360546, "post_id": 56384237, "comment_id": 99405458, "body": "That&#39;s what I thought too. I just ran a search for <code>consider_all_requests_local</code> on my entire codebase, and the only three instances are development.rb, where it&#39;s set to <code>config.consider_all_requests_local = true</code>, production.rb, where it&#39;s set to false, and test.rb, where it&#39;s set to true. When in a pry console, <code>request.local?</code> returns &quot;0&quot;, which means true, and <code>Rails.env</code> returns &quot;development&quot;."}, {"owner": {"reputation": 423, "user_id": 2029932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44c5fbea96c3b8c76a0ae4b266f058c9?s=128&d=identicon&r=PG", "display_name": "Leonardo Prado", "link": "https://stackoverflow.com/users/2029932/leonardo-prado"}, "reply_to_user": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "edited": false, "score": 0, "creation_date": 1559581797, "post_id": 56384237, "comment_id": 99458057, "body": "Again,it should have worked\u2026 Is spring working? Have you restarted it?"}, {"owner": {"reputation": 423, "user_id": 2029932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44c5fbea96c3b8c76a0ae4b266f058c9?s=128&d=identicon&r=PG", "display_name": "Leonardo Prado", "link": "https://stackoverflow.com/users/2029932/leonardo-prado"}, "reply_to_user": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "edited": false, "score": 0, "creation_date": 1559581983, "post_id": 56384237, "comment_id": 99458137, "body": "Another test you can do: create a method <code>def local_request?; true; end</code> on your controller, it should force it to show the dev errors page, see if it works"}, {"owner": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "edited": false, "score": 0, "creation_date": 1559890652, "post_id": 56384237, "comment_id": 99567741, "body": "I tried that and it didn&#39;t work, but even weirder, I changed <code>config.consider_all_requests_local = true</code> on production, and the full errors did show up there."}], "tags": [], "owner": {"reputation": 423, "user_id": 2029932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44c5fbea96c3b8c76a0ae4b266f058c9?s=128&d=identicon&r=PG", "display_name": "Leonardo Prado", "link": "https://stackoverflow.com/users/2029932/leonardo-prado"}, "is_accepted": false, "score": 1, "last_activity_date": 1559243163, "creation_date": 1559243163, "answer_id": 56384237, "question_id": 56352831, "link": "https://stackoverflow.com/questions/56352831/rails-default-error-page-doesnt-show-on-development/56384237#56384237", "title": "Rails default error page doesn&#39;t show on development", "body": "<p>Search your code for <code>consider_all_requests_local</code>, it's this configuration that show the full error log.</p>\n\n<p>It must be set as <code>true</code> on your <code>development.rb</code> config file. It's either missing from your configs, or other config is overwriting it</p>\n"}, {"comments": [{"owner": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "edited": false, "score": 0, "creation_date": 1560059166, "post_id": 56503878, "comment_id": 99611057, "body": "That&#39;s a weird coincidence that my code isn&#39;t supposed to work anyway, because my app doesn&#39;t give error messages on development even when I delete all the rescue_from stuff. Further, I have another app that has exactly the code given in this question (raising in a rescue_from), and that app shows errors in development like normal."}], "tags": [], "owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "is_accepted": false, "score": 1, "last_activity_date": 1559973238, "creation_date": 1559973238, "answer_id": 56503878, "question_id": 56352831, "link": "https://stackoverflow.com/questions/56352831/rails-default-error-page-doesnt-show-on-development/56503878#56503878", "title": "Rails default error page doesn&#39;t show on development", "body": "<p>This is not \"insane\", this is completely expected behavior. You cannot <code>raise</code> from within a <code>rescue_from</code> handler. That would cause an infinite loop.</p>\n\n<p>You also <strong>cannot <code>rescue_from StandardError</code></strong> as stated specifically in the documentation:</p>\n\n<blockquote>\n  <p>Using rescue_from with Exception or StandardError would cause serious side-effects as it prevents Rails from handling exceptions properly. As such, it is not recommended to do so unless there is a strong reason.</p>\n</blockquote>\n\n<p>Instead of conditionally handling the exception inside your <code>rescue_from</code>handler, you should conditionally bind the handler, and pick a more specific exception class to handle.</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  rescue_from StandardError, with: :handle_error if Rails.env.production?\n\n  #error handler\n  def handle_error(e)\n    #code to send email and redirect to error page\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 955, "user_id": 3739453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ad500b31d2ce042c4f2c5b6e361a129b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Morano", "link": "https://stackoverflow.com/users/3739453/joe-morano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1396, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1560065518, "creation_date": 1559101601, "last_edit_date": 1560065518, "question_id": 56352831, "link": "https://stackoverflow.com/questions/56352831/rails-default-error-page-doesnt-show-on-development", "title": "Rails default error page doesn&#39;t show on development", "body": "<p>I built an error handler that, when there's an error in any controller method in production, reroutes the user to an error page and sends me, the developer, a notification email. This works, but I want the normal error screen to appear when I'm in development. I assumed the code to produce this was just <code>raise e</code>, but instead in development I'm now getting the default <em>production</em> error page (the one that says \"We're sorry, but something went wrong\".), instead of the detailed error message and trace that used to appear.</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  rescue_from StandardError, with: :handle_error\n\n  #error handler\n  def handle_error(e)\n    if Rails.env.production?\n      #code to send email and redirect to error page\n    else\n      raise e\n    end\n  end\nend\n</code></pre>\n\n<p>I also tried the following:</p>\n\n<pre><code>raise\nraise StandardError.new e\nraise e, e.message\nraise e.message\n</code></pre>\n\n<p>and if I run any of those in a <code>binding.pry</code> console, they produce the error message I'm looking for, but the error page still just says \"We're sorry, but something went wrong.\"</p>\n\n<p><strong>Anyone know how I can just show the default development error page?</strong></p>\n\n<hr>\n\n<h2><strong>UPDATE</strong></h2>\n\n<p>This is insane...so the code to display an error normally should definitely work, but something somewhere is preventing that. If I change <code>config.consider_all_requests_local = true</code> on production, the errors show up on production, but then even if I copy and paste my config/environments/production.rb file into my config/environments/development.rb, the errors still don't show on development. If I enter a pry console, <code>request.local?</code> returns \"0\", signifying true, and <code>Rails.env</code> returns \"development\". I have no idea what is going on.</p>\n\n<h2><strong>UPDATE 2</strong></h2>\n\n<p>Apparently I'm not supposed to be rescuing exceptions on development, but even if I delete every bit of custom error handling code so my Application Controller is just empty, my errors still don't show on development. Further, I have a different app with the same exact error handling code, and for that the errors do show.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 10230, "user_id": 2427222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4h1qN.png?s=128&g=1", "display_name": "ymonad", "link": "https://stackoverflow.com/users/2427222/ymonad"}, "edited": false, "score": 1, "creation_date": 1559096000, "post_id": 56352182, "comment_id": 99309132, "body": "Maybe <a href=\"https://en.wikipedia.org/wiki/Euclidean_algorithm\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Euclidean_algorithm</a> ?"}, {"owner": {"reputation": 39, "user_id": 11570390, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YCpYNjpVkYU/AAAAAAAAAAI/AAAAAAAAAGU/IGapoP6neDM/photo.jpg?sz=128", "display_name": "Joe Horn", "link": "https://stackoverflow.com/users/11570390/joe-horn"}, "edited": false, "score": 0, "creation_date": 1559102333, "post_id": 56352182, "comment_id": 99310269, "body": "I can use anything at this point. I&#39;m in a beginning ruby class, but they are no limitations so I will check this out. If we can come up with a better way to do something then more power to us. The instructor even told us stack overflow would be our friend."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1559106046, "post_id": 56352182, "comment_id": 99311034, "body": "I hadn&#39;t noticed @panic&#39;s answer earlier. I therefore deleted my earlier comment and will delete this one as well. You may wish to delete your reply to my earlier comment."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 11570390, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YCpYNjpVkYU/AAAAAAAAAAI/AAAAAAAAAGU/IGapoP6neDM/photo.jpg?sz=128", "display_name": "Joe Horn", "link": "https://stackoverflow.com/users/11570390/joe-horn"}, "edited": false, "score": 1, "creation_date": 1559098038, "post_id": 56352354, "comment_id": 99309494, "body": "Thank you. Haven&#39;t yet touched the prime class yet so this gives me some info I didn&#39;t have."}], "tags": [], "owner": {"reputation": 6165, "user_id": 2697183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65255fe741b95ba0c641d96ea6750ea9?s=128&d=identicon&r=PG&f=1", "display_name": "AbM", "link": "https://stackoverflow.com/users/2697183/abm"}, "is_accepted": false, "score": 0, "last_activity_date": 1559097439, "creation_date": 1559097439, "answer_id": 56352354, "question_id": 56352182, "link": "https://stackoverflow.com/questions/56352182/how-to-optimize-code-it-works-but-i-know-im-missing-much-learning/56352354#56352354", "title": "How to optimize code - it works, but I know I&#39;m missing much learning", "body": "<p>You don't need to compare all the factors, just the prime ones. Ruby does come with a <a href=\"https://docs.ruby-lang.org/en/2.2.0/Prime.html\" rel=\"nofollow noreferrer\">Prime class</a></p>\n\n<pre><code>require 'prime'\n\ndef prime_numbers(num_1, num_2)\n  Prime.each([num_1, num_2].max / 2).map(&amp;:itself)\nend\n\ndef factors(num, prime_numbers)\n  prime_numbers.select {|n| num % n == 0}\nend\n\ndef coprime?(num_1, num_2)\n prime_numbers = prime_numbers(num_1, num_2)\n # &amp; returns the intersection of 2 arrays (https://stackoverflow.com/a/5678143)\n (factors(num_1, prime_numbers) &amp; factors(num_2, prime_numbers)).length == 0\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1854, "user_id": 669745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a4b0416684de65970e4d1b4da1bb290?s=128&d=identicon&r=PG", "display_name": "Panic", "link": "https://stackoverflow.com/users/669745/panic"}, "is_accepted": false, "score": 1, "last_activity_date": 1559098041, "creation_date": 1559098041, "answer_id": 56352416, "question_id": 56352182, "link": "https://stackoverflow.com/questions/56352182/how-to-optimize-code-it-works-but-i-know-im-missing-much-learning/56352416#56352416", "title": "How to optimize code - it works, but I know I&#39;m missing much learning", "body": "<p>You can just use Integer#gcd:</p>\n\n<pre><code>def coprime?(num_1, num_2)\n  num_1.gcd(num_2) == 1\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 655, "user_id": 9629768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YocKJ.jpg?s=128&g=1", "display_name": "GBrandt", "link": "https://stackoverflow.com/users/9629768/gbrandt"}, "is_accepted": false, "score": 1, "last_activity_date": 1559098195, "creation_date": 1559098195, "answer_id": 56352430, "question_id": 56352182, "link": "https://stackoverflow.com/questions/56352182/how-to-optimize-code-it-works-but-i-know-im-missing-much-learning/56352430#56352430", "title": "How to optimize code - it works, but I know I&#39;m missing much learning", "body": "<p>You could use <a href=\"https://en.m.wikipedia.org/wiki/Euclidean_algorithm\" rel=\"nofollow noreferrer\">Euclid's algorithm</a> to find the GCD, then check whether it's 1.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def gcd a, b\n  while a % b != 0\n    a, b = b, a % b\n  end\n  return b\nend\n\ndef coprime? a, b\n  gcd(a, b) == 1\nend\n\np coprime?(25, 12)    # =&gt; true\np coprime?(7, 11)     # =&gt; true\np coprime?(30, 9)     # =&gt; false\np coprime?(6, 24)     # =&gt; false```\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 11570390, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YCpYNjpVkYU/AAAAAAAAAAI/AAAAAAAAAGU/IGapoP6neDM/photo.jpg?sz=128", "display_name": "Joe Horn", "link": "https://stackoverflow.com/users/11570390/joe-horn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1559098195, "creation_date": 1559095812, "question_id": 56352182, "link": "https://stackoverflow.com/questions/56352182/how-to-optimize-code-it-works-but-i-know-im-missing-much-learning", "title": "How to optimize code - it works, but I know I&#39;m missing much learning", "body": "<p>The exercise I'm working on asks \"Write a method, coprime?(num_1, num_2), that accepts two numbers as args. The method should return true if the only common divisor between the two numbers is 1.\"</p>\n\n<p>I've written a method to complete the task, first by finding all the factors then sorting them and looking for duplicates. But I'm looking for suggestions on areas I should consider to optimize it. </p>\n\n<p>The code works, but it is just not clean.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def factors(num)\n return (1..num).select { |n| num % n == 0}\nend\n\ndef coprime?(num_1, num_2)\n  num_1_factors = factors(num_1)\n  num_2_factors = factors(num_2)\n  all_factors = num_1_factors + num_2_factors\n  new = all_factors.sort\n  dups = 0\n  new.each_index do |i|\n    dups += 1 if new[i] == new[i+1]\n  end\n  if dups &gt; 1\n    false\n  else\n    true\n  end    \nend\n\np coprime?(25, 12)    # =&gt; true\np coprime?(7, 11)     # =&gt; true\np coprime?(30, 9)     # =&gt; false\np coprime?(6, 24)     # =&gt; false\n\n</code></pre>\n"}, {"tags": ["regex", "ruby"], "comments": [{"owner": {"reputation": 33687, "user_id": 9624435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h44B4.jpg?s=128&g=1", "display_name": "Code Maniac", "link": "https://stackoverflow.com/users/9624435/code-maniac"}, "edited": false, "score": 0, "creation_date": 1559094930, "post_id": 56352084, "comment_id": 99308938, "body": "can you post some sample input and desired output ?"}, {"owner": {"reputation": 159, "user_id": 1339559, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9bf8734c148b8be82342fb2f3894eff8?s=128&d=identicon&r=PG", "display_name": "Rahul", "link": "https://stackoverflow.com/users/1339559/rahul"}, "reply_to_user": {"reputation": 33687, "user_id": 9624435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h44B4.jpg?s=128&g=1", "display_name": "Code Maniac", "link": "https://stackoverflow.com/users/9624435/code-maniac"}, "edited": false, "score": 0, "creation_date": 1559095029, "post_id": 56352084, "comment_id": 99308948, "body": "Sorry forgot that. Just edited the question to include an example."}, {"owner": {"reputation": 33687, "user_id": 9624435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h44B4.jpg?s=128&g=1", "display_name": "Code Maniac", "link": "https://stackoverflow.com/users/9624435/code-maniac"}, "edited": false, "score": 0, "creation_date": 1559096114, "post_id": 56352084, "comment_id": 99309155, "body": "You can try something like [this ](<a href=\"https://regex101.com/r/BeEvAx/3/\" rel=\"nofollow noreferrer\">regex101.com/r/BeEvAx/3</a>)"}, {"owner": {"reputation": 159, "user_id": 1339559, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9bf8734c148b8be82342fb2f3894eff8?s=128&d=identicon&r=PG", "display_name": "Rahul", "link": "https://stackoverflow.com/users/1339559/rahul"}, "reply_to_user": {"reputation": 33687, "user_id": 9624435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h44B4.jpg?s=128&g=1", "display_name": "Code Maniac", "link": "https://stackoverflow.com/users/9624435/code-maniac"}, "edited": false, "score": 0, "creation_date": 1559099377, "post_id": 56352084, "comment_id": 99309741, "body": "Here, &quot;[abc]123&quot;, abc is a match as it is inside the box brackets."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1559103538, "post_id": 56352084, "comment_id": 99310538, "body": "If the string were &quot;ABCD12&quot; would &quot;BCD12&quot; be a match? If the string were &quot;BCD123&quot; would &quot;BCD12&quot; be a match?"}, {"owner": {"reputation": 159, "user_id": 1339559, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9bf8734c148b8be82342fb2f3894eff8?s=128&d=identicon&r=PG", "display_name": "Rahul", "link": "https://stackoverflow.com/users/1339559/rahul"}, "edited": false, "score": 0, "creation_date": 1559146059, "post_id": 56352084, "comment_id": 99332431, "body": "No that&#39;s not a valid match (sorry for not making it obvious in the question). This regex did the trick for me (\\b[a-zA-Z]{3}([0-9]{1,2})?\\b)"}], "answers": [{"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1559105796, "last_edit_date": 1559105796, "creation_date": 1559104189, "answer_id": 56353127, "question_id": 56352084, "link": "https://stackoverflow.com/questions/56352084/regex-for-patterns-like-abc-abc-and-abcxx-where-xx-is-a-number/56353127#56353127", "title": "Regex for patterns like [ABC], ABC and ABCxx where xx is a number", "body": "<pre><code>R = /\n    \\p{L}{3}\\d{1,2}    # match 3 letters followed by 1 or 2 digits\n    |                  # or\n    (?&lt;=\\A|\\p{Space})  # match start of string or a space in a pos lookbehind\n    (?:                # begin a non-capture group\n      \\p{L}{3}         # match three letters\n      |                # or\n      \\[\\p{L}{3}\\]     # match three letters surrounded by brackets\n    )                  # end of non-capture group\n    (?=\\p{Space}|\\z)   # match space or end of string in a pos lookahead\n    /x                 # free-spacing regex definition mode\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>\"ABC catmat dogdog [rat] LAN45 eat HGF1 jkhgkj abc\".scan R\n   #=&gt; [\"ABC\", \"[rat]\", \"LAN45\", \"eat\", \"HGF1\", \"abc\"] \n</code></pre>\n\n<p>This regex is conventionally written (not free-spacing mode):</p>\n\n<pre><code>R = /\\p{L}{3}\\d{1,2}|(?&lt;=\\A| )(?:\\p{L}{3}\\[\\p{L}{3}\\])(?= |\\z)/\n</code></pre>\n\n<p>Now consider:</p>\n\n<pre><code> \"ABCD123 [efg]456\".scan R\n   #=&gt; [\"BCD12\"]\n</code></pre>\n\n<p>I believe this is consistent with the statement of the problem, but if <code>\"BCD12\"</code> should not be a match if it is preceded by a letter or followed by a digit (here both apply), then the regex should be modified as follows.</p>\n\n<pre><code>R = /\n    (?&lt;=\\A|\\p{Space})  # match start of string or a space in a pos lookbehind\n    (?:                # begin a non-capture group\n      \\p{L}{3}         # match three letters\n      \\d{,2}           # match 0, 1 or 2 digits      \n      |                # or\n      \\[\\p{L}{3}\\]     # match three letters surrounded by brackets\n    )                  # end of non-capture group\n    (?=\\p{Space}|\\z)   # match space or end of string in a pos lookahead\n    /x                 # free-spacing regex definition mode\n\n\"ABC catmat dogdog [rat] XLAN45 eat HGF123 jkhgkj abc\".scan R\n  #=&gt; [\"ABC\", \"[rat]\", \"eat\", \"abc\"]\n</code></pre>\n\n<p>Notice that, in both regexes, I replaced <code>\\p{Space}</code> with a space character. In free-spacing mode spaces are removed before the regex is parsed, so they must be written <code>\\p{Space}</code>, <code>[[:space:]]</code>, <code>[ ]</code> (a character class containing a space), <code>\\</code> an escaped space character or, if appropriate, <code>\\s</code> for a whitespace character (which includes spaces, newlines, tabs and a few other characters). </p>\n"}, {"comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1559146942, "post_id": 56364648, "comment_id": 99332870, "body": "The example in your question suggest that <code>[rat]</code> should be a match, but this regex matches <code>rat</code> instead."}, {"owner": {"reputation": 159, "user_id": 1339559, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9bf8734c148b8be82342fb2f3894eff8?s=128&d=identicon&r=PG", "display_name": "Rahul", "link": "https://stackoverflow.com/users/1339559/rahul"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1559167336, "post_id": 56364648, "comment_id": 99340805, "body": "Edited. My mistake."}], "tags": [], "owner": {"reputation": 159, "user_id": 1339559, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9bf8734c148b8be82342fb2f3894eff8?s=128&d=identicon&r=PG", "display_name": "Rahul", "link": "https://stackoverflow.com/users/1339559/rahul"}, "is_accepted": false, "score": 0, "last_activity_date": 1559146095, "creation_date": 1559146095, "answer_id": 56364648, "question_id": 56352084, "link": "https://stackoverflow.com/questions/56352084/regex-for-patterns-like-abc-abc-and-abcxx-where-xx-is-a-number/56364648#56364648", "title": "Regex for patterns like [ABC], ABC and ABCxx where xx is a number", "body": "<p>Thank you all for your answers. This regex did the trick for me. </p>\n\n<p>(\\b[a-zA-Z]{3}([0-9]{1,2})?\\b)</p>\n"}], "owner": {"reputation": 159, "user_id": 1339559, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9bf8734c148b8be82342fb2f3894eff8?s=128&d=identicon&r=PG", "display_name": "Rahul", "link": "https://stackoverflow.com/users/1339559/rahul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1559167308, "creation_date": 1559094804, "last_edit_date": 1559167308, "question_id": 56352084, "link": "https://stackoverflow.com/questions/56352084/regex-for-patterns-like-abc-abc-and-abcxx-where-xx-is-a-number", "title": "Regex for patterns like [ABC], ABC and ABCxx where xx is a number", "body": "<p>I have a text whose length can vary between 1 and 1000. I am looking to get the following sub strings extracted from the text. </p>\n\n<ol>\n<li><p>Sub string of the form ABCxx/ABCx where ABC are always english alphabets and x/xx is a number which can vary from 0 to 99 (the numeric length is either 1 or 2). The following regex does the job for me to extract this sub string - <code>[a-zA-Z]{3}[0-9]{1,2}</code></p></li>\n<li><p>Sub string of the form <code>&lt;space&gt;ABC&lt;space&gt;</code>, ABC (last sub string/word in the text)and ABC (first sub string in the text). Basically here I am trying to find a 3 letter word delimited by spaces in the text.<br>\nFor getting the above matches, I have the following regex's.</p></li>\n</ol>\n\n<pre class=\"lang-rb prettyprint-override\"><code>[ ][a-zA-Z]{3}[ ], [ ][a-zA-Z]{3} and [a-zA-Z]{3}[ ]\n</code></pre>\n\n<ol start=\"3\">\n<li>Same as 2, but the three character string can also be in a box bracket like [ABC]. </li>\n</ol>\n\n<pre class=\"lang-rb prettyprint-override\"><code>\\[([a-zA-Z]{3})\\]  \n</code></pre>\n\n<p>Since the patterns are more or less similar, is there anyway to combine all 5 of them ?</p>\n\n<p>Eg: <code>ABC catmat dogdog [rat] LAN45 eat HGF1 jkhgkj abc</code></p>\n\n<p>Here valid matches are <code>ABC</code>, <code>rat</code>, <code>LAN45</code>, <code>eat</code>, <code>HGF1</code>, <code>abc</code>.</p>\n"}, {"tags": ["ruby", "rubygems"], "answers": [{"tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": false, "score": 1, "last_activity_date": 1559093958, "creation_date": 1559093958, "answer_id": 56352002, "question_id": 56351515, "link": "https://stackoverflow.com/questions/56351515/fixing-a-failed-ruby-gem-install/56352002#56352002", "title": "fixing a failed ruby gem install", "body": "<p>I can't get the gem source repository to load, but you've got at least two options:</p>\n\n<p>Locally, you might be able to build it. Try running <code>rake build</code> from the root folder of the gem, and look in the <code>pkg</code> folder for the built gem. You should be able to then <code>gem install pkg/&lt;gem name&gt;.gem</code> in that folder</p>\n\n<p>If you need to share it with others, push the code up on github. Make your change, and if you're using bundler in the codebase that's using the gem, update your Gemfile to point to your source.</p>\n"}, {"tags": [], "owner": {"reputation": 1854, "user_id": 669745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a4b0416684de65970e4d1b4da1bb290?s=128&d=identicon&r=PG", "display_name": "Panic", "link": "https://stackoverflow.com/users/669745/panic"}, "is_accepted": false, "score": 0, "last_activity_date": 1559101926, "creation_date": 1559101926, "answer_id": 56352870, "question_id": 56351515, "link": "https://stackoverflow.com/questions/56351515/fixing-a-failed-ruby-gem-install/56352870#56352870", "title": "fixing a failed ruby gem install", "body": "<p>You could try something like this:</p>\n\n<pre><code># install_dbd_mysql.rb\n\nFixnum = Integer\n\nrequire 'rubygems/commands/install_command'\n\ninstall = Gem::Commands::InstallCommand.new\ninstall.handle_options ['dbd-mysql']\ninstall.execute\n</code></pre>\n\n<p>Run:</p>\n\n<pre><code>$ ruby install_dbd_mysql.rb\n</code></pre>\n"}], "owner": {"reputation": 502, "user_id": 2487509, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/Oz6bq.jpg?s=128&g=1", "display_name": "Russell Fulton", "link": "https://stackoverflow.com/users/2487509/russell-fulton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1559101926, "creation_date": 1559088716, "question_id": 56351515, "link": "https://stackoverflow.com/questions/56351515/fixing-a-failed-ruby-gem-install", "title": "fixing a failed ruby gem install", "body": "<p>I am installing the ruby gem mysql-dbd on a new system which is running ruby 2.5.  The problem is that it gets a syntax error because at 2.4 ruby combined Integer and Fixed num types.  </p>\n\n<p>The failed install leaves the unpacked gem package on disk so I was able to examine the entrails and the fix appears to be trivial (as in insert a '#' in a statement to remove the now redundant reference to FixNum).</p>\n\n<p>My question is having fixed the source how do I go about building and installing the gem?   Not being familiar with rake.</p>\n\n<p>BTW the gem has long been \"unsupported\".</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1559090503, "post_id": 56351357, "comment_id": 99308210, "body": "Another option is <a href=\"https://guides.rubyonrails.org/association_basics.html#polymorphic-associations\" rel=\"nofollow noreferrer\">polymorphic associations</a>"}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 1, "creation_date": 1559101942, "post_id": 56351357, "comment_id": 99310202, "body": "Aside from the relationships that looks really similar (It&#39;s a really common pattern), is Flag a special kind of Tag or you just feel you could reuse the Tag model for your Flags? I mean, think about the semantic, the uses of each of them. Does it makes sense that a Flag inherits all the behaviour of the Tag class? It&#39;s really hard to answer this questions (these are even explicitly forbiden by SO guidelines as too opinion based, it may get closed)."}], "owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559087080, "creation_date": 1559087080, "question_id": 56351357, "link": "https://stackoverflow.com/questions/56351357/i-want-to-have-certain-flags-for-items-in-my-rails-app-wondering-if-i-should-ex", "title": "I want to have certain flags for items in my Rails app, wondering if I should extend my Tag class or create a whole new Flag class?", "body": "<p>I'm not the most advanced programmer, and when it comes to inheritance I know what it is but I probably don't use it when I should. So I'm asking for some opinions on the following:</p>\n\n<p>I have a Rails app that tracks items that have various time based routines. i.e. a pair of protective boots might need to be inspected every 12 months, and also professionally cleaned at least once in a 12 month period. They have a lifetime of 10 years. Every day the app runs a cron job that updates a table with critical dates like:</p>\n\n<pre><code>|next_inspection_due|next_cleaning_due|retirement_due|\n|    2019-05-28     |    2019-09-09   |  2025-02-01  |\n</code></pre>\n\n<p>If any of these are <code>&lt; today</code> it will check to make sure a flag has been set in the Flaggings table. The flags would be something like 'Inspection Due'. If someone sends an item in for cleaning, the completion of the cleaning event would cause the <code>next_cleaning_due</code> date to be updated to one year from that date. </p>\n\n<p>I also have the standard Tagging structure common in so many apps with a Tag model and a Tagging model with the associated tables...</p>\n\n<pre><code>class Tag &lt; ApplicationRecord\n  has_many :taggings\n  has_many :items, through: :taggings\nend\n\nclass Tagging &lt; ApplicationRecord\n  belongs_to :tag\n  belongs_to :item\nend\n</code></pre>\n\n<p>My \"flags\" are just another form of tag conceptually. But they are defined in the app and limited to <code>[:inspection_due, :cleaning_due, :retirement_due]</code>. Is there any value in having my Flag and Flagging models inherit from Tag and Tagging respectively? Currently they just mirror them:</p>\n\n<pre><code>class Flag &lt; ApplicationRecord\n  has_many :flaggings\n  has_many :items, through: :flaggings\nend\n\nclass Flagging &lt; ApplicationRecord\n  belongs_to :flag\n  belongs_to :item\nend\n</code></pre>\n\n<p>with the associated tables. Am I duplicating too much? Not sure if it would gain me anything by having </p>\n\n<pre><code>class Flag &lt; Tag\n</code></pre>\n\n<p>Or should I just make those three flags \"predefined tags\" that are only set or unset by the app when it runs its status checks and can't be used by the end user in the normal tagging space?</p>\n\n<p>Hope this isn't too broad or vague. Just writing this out makes me think I'm duplicating code needlessly. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "answers": [{"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1559084159, "creation_date": 1559084159, "answer_id": 56351033, "question_id": 56350067, "link": "https://stackoverflow.com/questions/56350067/installed-rails-but-not-able-to-run-it/56351033#56351033", "title": "Installed Rails but not able to run it?", "body": "<p>You only want to use one ruby version manager.  Make sure you remove anything related to RBEN if you're not using it as your version manager.</p>\n\n<p>Have a <a href=\"https://github.com/rbenv/rbenv/issues/148\" rel=\"nofollow noreferrer\">look here</a> for things you may need to do.</p>\n\n<p>You should also check your shell for any PATH definitions you don't need regarding RBENV.</p>\n"}], "owner": {"reputation": 685, "user_id": 10122964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6f47c068da609a914249c7572d60e6d?s=128&d=identicon&r=PG&f=1", "display_name": "user7496931", "link": "https://stackoverflow.com/users/10122964/user7496931"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559084159, "creation_date": 1559077617, "last_edit_date": 1559077962, "question_id": 56350067, "link": "https://stackoverflow.com/questions/56350067/installed-rails-but-not-able-to-run-it", "title": "Installed Rails but not able to run it?", "body": "<p>I'm using <code>asdf</code> as a ruby package manager, I had a bunch of issues with the PATH environments and was able to install everything correctly. However, I'm running into issues with the rails gem.</p>\n\n<p>I think I might still have ownership errors with it.</p>\n\n<p><a href=\"https://i.stack.imgur.com/wCnkx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wCnkx.png\" alt=\"Rails installation\"></a></p>\n\n<p>This is my path:</p>\n\n<p><code>/Users/carlos.grijalva/.asdf/shims:/Users/carlos.grijalva/.asdf/bin:/Users/carlos.grijalva/.rbenv/bin:/Users/carlos.grijalva/bin:/usr/local/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin</code></p>\n\n<p>This is <code>which ruby</code>:</p>\n\n<p><code>/Users/carlos.grijalva/.asdf/shims/ruby</code></p>\n\n<p>And this is <code>ruby -v</code>:</p>\n\n<p><code>ruby 2.5.3p105 (2018-10-18 revision 65156) [x86_64-darwin18]</code></p>\n\n<p>And this is my <code>GEM environment</code></p>\n\n<pre><code>RubyGems Environment:\n  - RUBYGEMS VERSION: 2.7.6\n  - RUBY VERSION: 2.5.3 (2018-10-18 patchlevel 105) [x86_64-darwin18]\n  - INSTALLATION DIRECTORY: /Users/carlos.grijalva/.asdf/installs/ruby/2.5.3/lib/ruby/gems/2.5.0\n  - USER INSTALLATION DIRECTORY: /Users/carlos.grijalva/.gem/ruby/2.5.0\n  - RUBY EXECUTABLE: /Users/carlos.grijalva/.asdf/installs/ruby/2.5.3/bin/ruby\n  - EXECUTABLE DIRECTORY: /Users/carlos.grijalva/.asdf/installs/ruby/2.5.3/bin\n  - SPEC CACHE DIRECTORY: /Users/carlos.grijalva/.gem/specs\n  - SYSTEM CONFIGURATION DIRECTORY: /Users/carlos.grijalva/.asdf/installs/ruby/2.5.3/etc\n  - RUBYGEMS PLATFORMS:\n    - ruby\n    - x86_64-darwin-18\n  - GEM PATHS:\n     - /Users/carlos.grijalva/.asdf/installs/ruby/2.5.3/lib/ruby/gems/2.5.0\n     - /Users/carlos.grijalva/.gem/ruby/2.5.0\n  - GEM CONFIGURATION:\n     - :update_sources =&gt; true\n     - :verbose =&gt; true\n     - :backtrace =&gt; false\n     - :bulk_threshold =&gt; 1000\n  - REMOTE SOURCES:\n     - https://rubygems.org/\n  - SHELL PATH:\n     - /Users/carlos.grijalva/.asdf/installs/ruby/2.5.3/bin\n     -\n     - /Users/carlos.grijalva/.asdf/shims\n     - /Users/carlos.grijalva/.asdf/bin\n     - /Users/carlos.grijalva/.rbenv/bin\n     - /Users/carlos.grijalva/bin\n     - /usr/local/bin\n     - /usr/local/bin\n     - /usr/bin\n     - /bin\n     - /usr/sbin\n     - /sbin\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "rails-activestorage"], "comments": [{"owner": {"reputation": 442, "user_id": 9666795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf51883733cb3335d251059e5956a3d5?s=128&d=identicon&r=PG&f=1", "display_name": "mrpepo877", "link": "https://stackoverflow.com/users/9666795/mrpepo877"}, "edited": false, "score": 0, "creation_date": 1559080917, "post_id": 56350057, "comment_id": 99306109, "body": "but you know where on your code is tring to use [] and can be a nilClass?"}, {"owner": {"reputation": 1, "user_id": 8697728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d626705c84b074d4a3fb35a07c00a43?s=128&d=identicon&r=PG&f=1", "display_name": "stvtortora", "link": "https://stackoverflow.com/users/8697728/stvtortora"}, "reply_to_user": {"reputation": 442, "user_id": 9666795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf51883733cb3335d251059e5956a3d5?s=128&d=identicon&r=PG&f=1", "display_name": "mrpepo877", "link": "https://stackoverflow.com/users/9666795/mrpepo877"}, "edited": false, "score": 0, "creation_date": 1559083255, "post_id": 56350057, "comment_id": 99306766, "body": "I my guess that code in the active storage gem is using []. The following links give me a hint that it has something to do with storage.yml, but I still can&#39;t find the problem. <a href=\"https://rubyinrails.com/2017/07/21/rails-introduces-active-storage-for-file-uploads/\" rel=\"nofollow noreferrer\">rubyinrails.com/2017/07/21/&hellip;</a> <a href=\"https://groups.google.com/forum/#!topic/rubyonrails-talk/RaFBG6wi2K0\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/rubyonrails-talk/RaFBG6wi2K0</a>"}], "owner": {"reputation": 1, "user_id": 8697728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d626705c84b074d4a3fb35a07c00a43?s=128&d=identicon&r=PG&f=1", "display_name": "stvtortora", "link": "https://stackoverflow.com/users/8697728/stvtortora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 729, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1587933704, "creation_date": 1559077569, "last_edit_date": 1559094124, "question_id": 56350057, "link": "https://stackoverflow.com/questions/56350057/heroku-logs-shows-undefined-method-for-nilnilclass-nomethoderror-after-t", "title": "Heroku logs shows undefined method `[]&#39; for nil:NilClass (NoMethodError) after trying to setup active storage", "body": "<p>I am trying to push a rails app to heroku and am encountering the following error related to active storage: </p>\n\n<p>Error :</p>\n\n<p><code>undefined method `[]' for nil:NilClass (NoMethodError)</code></p>\n\n<p>Everything is working as expected in development on my local machine. I have ran <code>bundle exec rails active_storage:install</code> and the active storage related tables migrate successfully on heroku. However, the error throws when I attempt to seed my database using active storage. It also throws in the heroku console when I attempt to start up to app. </p>\n\n<p>application.rb: </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'rails/all'\n</code></pre>\n\n<p>Gemfile: </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>gem 'aws-sdk-s3'\n</code></pre>\n\n<p>config/enviornments/production.rb:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>config.active_storage.service = :amazon_dev\n</code></pre>\n\n<p>credentials.yml: </p>\n\n<pre><code>aws:\n  access_key_id: XXXXX\n  secret_access_key: XXXXX\n  region: XXXXX\n  bucket: XXXXX\n\n# Used as the base secret for all MessageVerifiers in Rails, including the one protecting cookies.\nsecret_key_base: XXXXX\n</code></pre>\n\n<p>config/storage.yml: </p>\n\n<pre><code>amazon_dev:\n  service: S3\n  access_key_id: &lt;%= Rails.application.credentials.aws[:access_key_id] %&gt;\n  secret_access_key: &lt;%= Rails.application.credentials.aws[:secret_access_key] %&gt;\n  region: &lt;%= Rails.application.credentials.aws[:region] %&gt;\n  bucket: &lt;%= Rails.application.credentials.aws[:bucket] %&gt;\n</code></pre>\n\n<p>Stack trace from heroku consoloe:</p>\n\n<pre><code>Traceback (most recent call last):\n    83: from bin/rails:9:in `&lt;main&gt;'\n    82: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:291:in `require'\n    81: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:257:in `load_dependency'\n    80: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:291:in `block in require'\n    79: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:30:in `require'\n    78: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `require_with_bootsnap_lfi'\n    77: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/loaded_features_index.rb:92:in `register'\n    76: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:22:in `block in require_with_bootsnap_lfi'\n    75: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:22:in `require'\n    74: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/commands.rb:18:in `&lt;top (required)&gt;'\n    73: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/command.rb:46:in `invoke'\n    72: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/command/base.rb:65:in `perform'\n    71: from /app/vendor/bundle/ruby/2.5.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'\n    70: from /app/vendor/bundle/ruby/2.5.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'\n    69: from /app/vendor/bundle/ruby/2.5.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'\n    68: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/commands/console/console_command.rb:95:in `perform'\n    67: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/command/actions.rb:15:in `require_application_and_environment!'\n    66: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/command/actions.rb:28:in `require_environment!'\n    65: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/application.rb:337:in `require_environment!'\n    64: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:291:in `require'\n    63: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:257:in `load_dependency'\n    62: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:291:in `block in require'\n    61: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:30:in `require'\n    60: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `require_with_bootsnap_lfi'\n    59: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/loaded_features_index.rb:92:in `register'\n    58: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:22:in `block in require_with_bootsnap_lfi'\n    57: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:22:in `require'\n    56: from /app/config/environment.rb:5:in `&lt;top (required)&gt;'\n    55: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/application.rb:361:in `initialize!'\n    54: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/initializable.rb:60:in `run_initializers'\n    53: from /app/vendor/ruby-2.5.1/lib/ruby/2.5.0/tsort.rb:205:in `tsort_each'\n    52: from /app/vendor/ruby-2.5.1/lib/ruby/2.5.0/tsort.rb:226:in `tsort_each'\n    51: from /app/vendor/ruby-2.5.1/lib/ruby/2.5.0/tsort.rb:347:in `each_strongly_connected_component'\n    50: from /app/vendor/ruby-2.5.1/lib/ruby/2.5.0/tsort.rb:347:in `call'\n    49: from /app/vendor/ruby-2.5.1/lib/ruby/2.5.0/tsort.rb:347:in `each'\n    48: from /app/vendor/ruby-2.5.1/lib/ruby/2.5.0/tsort.rb:349:in `block in each_strongly_connected_component'\n    47: from /app/vendor/ruby-2.5.1/lib/ruby/2.5.0/tsort.rb:431:in `each_strongly_connected_component_from'\n    46: from /app/vendor/ruby-2.5.1/lib/ruby/2.5.0/tsort.rb:350:in `block (2 levels) in each_strongly_connected_component'\n    45: from /app/vendor/ruby-2.5.1/lib/ruby/2.5.0/tsort.rb:228:in `block in tsort_each'\n    44: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/initializable.rb:61:in `block in run_initializers'\n    43: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/initializable.rb:32:in `run'\n    42: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/initializable.rb:32:in `instance_exec'\n    41: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/application/finisher.rb:69:in `block in &lt;module:Finisher&gt;'\n    40: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/application/finisher.rb:69:in `each'\n    39: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/engine.rb:356:in `eager_load!'\n    38: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/engine.rb:475:in `eager_load!'\n    37: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/engine.rb:475:in `each'\n    36: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/engine.rb:477:in `block in eager_load!'\n    35: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/engine.rb:477:in `each'\n    34: from /app/vendor/bundle/ruby/2.5.0/gems/railties-5.2.3/lib/rails/engine.rb:478:in `block (2 levels) in eager_load!'\n    33: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:246:in `require_dependency'\n    32: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/active_support.rb:85:in `depend_on'\n    31: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:334:in `depend_on'\n    30: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/active_support.rb:47:in `require_or_load'\n    29: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/active_support.rb:16:in `allow_bootsnap_retry'\n    28: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/active_support.rb:48:in `block in require_or_load'\n    27: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:356:in `require_or_load'\n    26: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:37:in `load_interlock'\n    25: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies/interlock.rb:13:in `loading'\n    24: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/concurrency/share_lock.rb:151:in `exclusive'\n    23: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies/interlock.rb:14:in `block in loading'\n    22: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:37:in `block in load_interlock'\n    21: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:378:in `block in require_or_load'\n    20: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:291:in `require'\n    19: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:257:in `load_dependency'\n    18: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:291:in `block in require'\n    17: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:30:in `require'\n    16: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `require_with_bootsnap_lfi'\n    15: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/loaded_features_index.rb:92:in `register'\n    14: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:22:in `block in require_with_bootsnap_lfi'\n    13: from /app/vendor/bundle/ruby/2.5.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:22:in `require'\n    12: from /app/vendor/bundle/ruby/2.5.0/gems/activestorage-5.2.3/app/models/active_storage/blob.rb:16:in `&lt;top (required)&gt;'\n    11: from /app/vendor/bundle/ruby/2.5.0/gems/activestorage-5.2.3/app/models/active_storage/blob.rb:235:in `&lt;class:Blob&gt;'\n    10: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/lazy_load_hooks.rb:51:in `run_load_hooks'\n     9: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/lazy_load_hooks.rb:51:in `each'\n     8: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/lazy_load_hooks.rb:52:in `block in run_load_hooks'\n     7: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/lazy_load_hooks.rb:67:in `execute_hook'\n     6: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/lazy_load_hooks.rb:62:in `with_execution_control'\n     5: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/lazy_load_hooks.rb:71:in `block in execute_hook'\n     4: from /app/vendor/bundle/ruby/2.5.0/gems/activesupport-5.2.3/lib/active_support/lazy_load_hooks.rb:71:in `instance_eval'\n     3: from /app/vendor/bundle/ruby/2.5.0/gems/activestorage-5.2.3/lib/active_storage/engine.rb:95:in `block (2 levels) in &lt;class:Engine&gt;'\n     2: from /app/vendor/ruby-2.5.1/lib/ruby/2.5.0/erb.rb:876:in `result'\n     1: from /app/vendor/ruby-2.5.1/lib/ruby/2.5.0/erb.rb:876:in `eval'\n(erb):6:in `&lt;main&gt;': undefined method `[]' for nil:NilClass (NoMethodError)\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>after doing some digging, here is the source code of the file in the activestorage gem which this error seems to be coming from: </p>\n\n<p><a href=\"https://github.com/rails/rails/blob/v5.2.3/activestorage/lib/active_storage/engine.rb\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/blob/v5.2.3/activestorage/lib/active_storage/engine.rb</a>  </p>\n\n<p>So it appears as though the issue almost certainly has to do with the storage.yml file, but I cannot seem to pinpoint what it is.</p>\n\n<p><strong>Solution</strong></p>\n\n<p>After tinkering with storage.yml a bit, the error went away and everything worked as expected. I suspect that there were extra spaces in my storage.yml file that I didn't notice.</p>\n"}, {"tags": ["ruby", "shell", "io-redirection"], "comments": [{"owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 1, "creation_date": 1559073551, "post_id": 56348315, "comment_id": 99303446, "body": "Is the problem that you don&#39;t know how to reliably detect whether stdin is a pipe? Check out <a href=\"https://stackoverflow.com/questions/43789845/how-to-detect-if-a-ruby-script-is-running-through-a-shell-pipe\">this answer</a>. Don&#39;t use a timeout, it&#39;s a race condition."}, {"owner": {"reputation": 3946, "user_id": 6231376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cea33b55396be93411ade85021f41b01?s=128&d=identicon&r=PG&f=1", "display_name": "TeWu", "link": "https://stackoverflow.com/users/6231376/tewu"}, "edited": false, "score": 0, "creation_date": 1559073657, "post_id": 56348315, "comment_id": 99303495, "body": "Why, don&#39;t you just read <a href=\"https://github.com/busyloop/lolcat\" rel=\"nofollow noreferrer\">lolcat&#39;s source code</a>, and learn from it? It&#39;s like 300 lines of code total."}, {"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "reply_to_user": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1559073800, "post_id": 56348315, "comment_id": 99303550, "body": "@thatotherguy, nope I am aware of the isatty? method. My problem is my solution (the piece of code I wrote above) doesn&#39;t work with programs like cmatrix, and even with the irb shell."}, {"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "reply_to_user": {"reputation": 3946, "user_id": 6231376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cea33b55396be93411ade85021f41b01?s=128&d=identicon&r=PG&f=1", "display_name": "TeWu", "link": "https://stackoverflow.com/users/6231376/tewu"}, "edited": false, "score": 0, "creation_date": 1559074041, "post_id": 56348315, "comment_id": 99303640, "body": "@TeWu, I read the lolcat&#39;s source code after I needed the feature. lolcat doesn&#39;t use a single file. It&#39;s all very messy. Lolcat uses the gem paint and paint  reads a gz file for the colours. I don&#39;t want that. The application I wrote shouldn&#39;t contain any more files, and it should have only Ruby as dependency, it should load as fast as possible."}, {"owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1559074547, "post_id": 56348315, "comment_id": 99303838, "body": "@S.Goswami I don&#39;t understand. You know that your attempt is wrong, and you also say that you&#39;re aware of the correct way of doing it. What exactly are you asking then? Are you asking why <code>irb</code> reliably loses your race condition while <code>echo</code> reliably wins it?"}, {"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "edited": false, "score": 0, "creation_date": 1559075725, "post_id": 56348315, "comment_id": 99304278, "body": "Actually it&#39;s <code>echo</code> outputs the output correctly. But, if you run programs like <code>cmatrix | lolcat</code> it works, <code>irb | lolcat</code> works (and lolcat doesn&#39;t complain about TTY or such stuff). However, I have already implemented <code>STDOUT.tty?</code> method in the first commit which exits if there&#39;s no tty detected - say if you run the program in editors like atom or vscode. Anyways, I am interested in knowing how can I implement my program in such a way that it can work with other programs?"}, {"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "edited": false, "score": 0, "creation_date": 1559076157, "post_id": 56348315, "comment_id": 99304467, "body": "Also, look at <code>irb | head -n5</code>, <code>cmatrix | head -n5</code> they all work. I think my implementation isn&#39;t correct at all! Regardless the Timeout#timeout, is there any gem from the standard library that I can use? Actually I am wondering what could be proper implementation for about a year!!"}], "answers": [{"comments": [{"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "edited": false, "score": 0, "creation_date": 1559098297, "post_id": 56350238, "comment_id": 99309549, "body": "For some strange reason I wrote TimeoutError rather than Timeout::Error!! Also, we can&#39;t use STDIN.getch because it raises <code>Inappropriate ioctl for device (Errno::ENOTTY)</code> error. Apart from using Timeout, your answer is correct, and very helpful. Thank you very much for the answer!"}, {"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "edited": false, "score": 0, "creation_date": 1559099888, "post_id": 56350238, "comment_id": 99309828, "body": "Sorry, this might not a useful comment but I would like to say that cowspeak has to check if IO redirection is happening, if not, it will show a random quote. So, I need to use the Timeout gem from standard library to make sure it first checks for a line with <code>STDIN.gets</code> and if there&#39;s no line, it will not loop in the <code>... until STDIN.eof?</code>."}, {"owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "reply_to_user": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "edited": false, "score": 1, "creation_date": 1559111273, "post_id": 56350238, "comment_id": 99312831, "body": "You do not need a timeout to check if redirection if happening. That is what <code>isatty</code> does robustly and reliably. Using a timeout is really bad."}], "tags": [], "owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "is_accepted": true, "score": 1, "last_activity_date": 1559078634, "creation_date": 1559078634, "answer_id": 56350238, "question_id": 56348315, "link": "https://stackoverflow.com/questions/56348315/io-redirection-with-ruby-in-gnu-linux/56350238#56350238", "title": "IO redirection with Ruby in GNU/Linux", "body": "<p>To correctly read all data from a pipe, read block by block without timeouts, and to make sure you're able to process any kind of data as it comes in:</p>\n\n<pre><code>#!/usr/bin/ruby -w\n\nif STDIN.isatty\n  STDERR.puts \"You are not piping, but I will read from stdin anyways\"\n  STDERR.puts \"because that is the canonical Unix behavior.\"\nend\n\nuntil STDIN.eof?\n  STDOUT.write(STDIN.readpartial(4096))\nend\n</code></pre>\n\n<p>This fixes the two issues with your posted code (ignoring all the other programs and combinations you're asking about):</p>\n\n<ol>\n<li>You are using a timeout, so the program fails if input is slow</li>\n<li>You are reading line by line, so the program fails if input isn't line based</li>\n</ol>\n\n<p><code>echo</code> appears to work because this is a shell builtin and is therefore likely to run before <code>ruby</code> finishes loading, but it's still down to chance and scheduling. Here's a race rigged so that <code>echo</code> loses:</p>\n\n<pre><code>$ ( sleep 1; echo Hello ) | ./yourprogram\n./yourprogram:9: warning: constant ::TimeoutError is deprecated\n</code></pre>\n\n<p>You're also waiting for complete lines, but <code>irb</code> only outputs a prompt without linefeeds and <code>cmatrix</code> doesn't output linefeeds at all. This causes a timeout due to the above bug, and would otherwise just read memory until it dies:</p>\n\n<pre><code>$ while echo -n foo; do true; done | ./yourprogram\n./yourprogram:9: warning: constant ::TimeoutError is deprecated\n</code></pre>\n\n<p>The suggestion above has neither of these issues.</p>\n"}], "owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 56350238, "answer_count": 1, "score": 0, "last_activity_date": 1559099093, "creation_date": 1559068888, "last_edit_date": 1592644375, "question_id": 56348315, "link": "https://stackoverflow.com/questions/56348315/io-redirection-with-ruby-in-gnu-linux", "title": "IO redirection with Ruby in GNU/Linux", "body": "<p>So, I have written a little application called <a href=\"https://github.com/Souravgoswami/cowspeak\" rel=\"nofollow noreferrer\">cowspeak</a></p>\n<p>It does various jobs on a GNU/Linux system. But the problem is while accepting inputs using pipes.</p>\n<p>I have already implemented accepting IO redirection with this code:</p>\n<pre><code>#!/usr/bin/ruby -w\nrequire 'timeout'\n\nSTDIN.sync = STDOUT.sync = true\npipe = false\n\nbegin\n    Timeout.timeout(0.000_000_000_001) do pipe = STDIN.gets end\nrescue Timeout::Error\nend\n\nif pipe\n    print pipe\n    print pipe while pipe = STDIN.gets\nend\n</code></pre>\n<p>It's all fine.</p>\n<p>So for <code>echo -e &quot;hello\\nworld&quot; | ruby cowspeak</code>, I get</p>\n<pre><code>hello\nworld\n</code></pre>\n<p>But the problem is it doesn't work with programs like irb (yes, I don't need to use IRB with this program, but I want to learn how it should work). A working example is the <code>lolcat</code> gem.</p>\n<p>So for <code>irb | ruby cowspeak</code>, I get it running forever in the <code>while</code> loop (implemented in <code>loop</code> loop in cowspeak).</p>\n<p>Lolcat works fine in that case as well!</p>\n<p>Also, apps like <em>cmatrix</em> doesn't work with my program, but they work with lolcat.</p>\n<p>Unix programs like <em>cowsay</em> (which is written in Perl) doesn't also work with pipes well - the same behaviour as cowspeak...</p>\n<p>Anyways, I see the question is asked before here:\n<a href=\"https://stackoverflow.com/questions/40120638/ruby-pipes-io-and-stderr-redirect\">ruby pipes, IO and stderr redirect</a></p>\n<p>But it doesn't answer my question properly.</p>\n<p>How can I implement IO redirection with Ruby and overall how the lolcat gem really work with pipes?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activeresource"], "answers": [{"comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1559066162, "post_id": 56347553, "comment_id": 99300248, "body": "yeah, initializers only get run when application starts. But you have a small typo, you left out the closing <code>]</code> on your ENV VAR."}, {"owner": {"reputation": 1976, "user_id": 1177200, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/99ddd63eb79f04e76156db21c172c7f1?s=128&d=identicon&r=PG", "display_name": "taylorthurlow", "link": "https://stackoverflow.com/users/1177200/taylorthurlow"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1559067899, "post_id": 56347553, "comment_id": 99301068, "body": "@lacostenycoder Fixed, thanks! Must have missed it in making the example code far more simple than the real code haha."}], "tags": [], "owner": {"reputation": 1976, "user_id": 1177200, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/99ddd63eb79f04e76156db21c172c7f1?s=128&d=identicon&r=PG", "display_name": "taylorthurlow", "link": "https://stackoverflow.com/users/1177200/taylorthurlow"}, "is_accepted": true, "score": 2, "last_activity_date": 1559067869, "last_edit_date": 1559067869, "creation_date": 1559065477, "answer_id": 56347553, "question_id": 56347552, "link": "https://stackoverflow.com/questions/56347552/activeresource-nomethoderror-undefined-method-path-for-nilnilclass-inter/56347553#56347553", "title": "ActiveResource &quot;NoMethodError (undefined method `path&#39; for nil:NilClass):&quot; intermittent error", "body": "<p>The source of the issue was due to Rails' autoloading feature. A few realizations led me to this solution.</p>\n\n<p>We had many ActiveResource resources, so in order to easily initialize the resources we placed the setup in an initializer (which is only run during Rails server startup):</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># config/initializers/active_resource_setup.rb\n\nCart.site = ENV[\"ROOT_URL\"]\n</code></pre>\n\n<p>I also realized that this was not an issue in a production environment. This wasn't as clear before because this issue appeared during a significant Rails upgrade, so I assumed I had broken it to begin with.</p>\n\n<p>However, the source of the issue was Rails automatically reloading the resource class definition files whenever a change was made to the source. It would reload the class definition:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># app/models/resources/cart.rb\n\nclass Cart &lt; ActiveResource::Base\n  validates :session_id, presence: true\nend\n</code></pre>\n\n<p>And because the <code>Cart.site</code> definition was not in this file as intended, the resource was effectively reset, and the <code>site</code> configuration clobbered by the auto-reload process.</p>\n\n<p>The solution is to move the <code>Cart.site</code> definition into the resource definition:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># app/models/resources/cart.rb\n\nclass Cart &lt; ActiveResource::Base\n  self.site = ENV[\"ROOT_URL\"]\n\n  validates :session_id, presence: true\nend\n</code></pre>\n"}], "owner": {"reputation": 1976, "user_id": 1177200, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/99ddd63eb79f04e76156db21c172c7f1?s=128&d=identicon&r=PG", "display_name": "taylorthurlow", "link": "https://stackoverflow.com/users/1177200/taylorthurlow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "accepted_answer_id": 56347553, "answer_count": 1, "score": 1, "last_activity_date": 1559067869, "creation_date": 1559065477, "question_id": 56347552, "link": "https://stackoverflow.com/questions/56347552/activeresource-nomethoderror-undefined-method-path-for-nilnilclass-inter", "title": "ActiveResource &quot;NoMethodError (undefined method `path&#39; for nil:NilClass):&quot; intermittent error", "body": "<p>I'm encountering an intermittent error where an ActiveResource resource call like:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Cart.where(session_id: get_guid, status: 1)\n</code></pre>\n\n<p>Raises an error:</p>\n\n<pre><code>NoMethodError (undefined method `path' for nil:NilClass)\n</code></pre>\n\n<p>But only intermittently. Restarting the Rails server temporarily solves the problem, but some indeterminate time later, it breaks again.</p>\n"}, {"tags": ["ruby", "asdf-vm"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1559062281, "post_id": 56346809, "comment_id": 99298636, "body": "Seems like an asdf installation/etc issue. Did you add the asdf lines to your shell startup?"}, {"owner": {"reputation": 83, "user_id": 10102164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb7000ee4eebb46418b01b95b621f3d?s=128&d=identicon&r=PG&f=1", "display_name": "CarlosG90", "link": "https://stackoverflow.com/users/10102164/carlosg90"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1559062498, "post_id": 56346809, "comment_id": 99298753, "body": "Hmm, should that be done in the <code>.zshrc</code> file? Not sure where to add the lines"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1559062576, "post_id": 56346809, "comment_id": 99298780, "body": "Yes, since that&#39;s your startup file. When you install asdf it actually says what to do. I&#39;m not saying it&#39;s the (or only) issue, but... you do actually need to give asdf access to your shims/etc."}, {"owner": {"reputation": 83, "user_id": 10102164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb7000ee4eebb46418b01b95b621f3d?s=128&d=identicon&r=PG&f=1", "display_name": "CarlosG90", "link": "https://stackoverflow.com/users/10102164/carlosg90"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1559064808, "post_id": 56346809, "comment_id": 99299693, "body": "Hmm, trying to figure out what exact lines to add for this..."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 10102164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb7000ee4eebb46418b01b95b621f3d?s=128&d=identicon&r=PG&f=1", "display_name": "CarlosG90", "link": "https://stackoverflow.com/users/10102164/carlosg90"}, "edited": false, "score": 0, "creation_date": 1559065472, "post_id": 56347500, "comment_id": 99299964, "body": "Saw that too and ran those exact commands. For some reason I&#39;m still getting:  <code>You don&#39;t have write permissions for the &#47;Library&#47;Ruby&#47;Gems&#47;2.3.0 directory.</code>  And I can&#39;t seem to change the version of ruby with <code>asdf</code>. Not sure what else could be happening"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 83, "user_id": 10102164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb7000ee4eebb46418b01b95b621f3d?s=128&d=identicon&r=PG&f=1", "display_name": "CarlosG90", "link": "https://stackoverflow.com/users/10102164/carlosg90"}, "edited": false, "score": 0, "creation_date": 1559067035, "post_id": 56347500, "comment_id": 99300671, "body": "@CarlosG90 Did you open a new terminal so they&#39;re actually in effect? All those commands do is modify your startup script."}, {"owner": {"reputation": 83, "user_id": 10102164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb7000ee4eebb46418b01b95b621f3d?s=128&d=identicon&r=PG&f=1", "display_name": "CarlosG90", "link": "https://stackoverflow.com/users/10102164/carlosg90"}, "edited": false, "score": 0, "creation_date": 1559068587, "post_id": 56347500, "comment_id": 99301407, "body": "Yeah, modified and ran <code>source ~&#47;.zshrc</code> also checked the actual file is changed and restarted the terminal multiple times. Ruby version doesn&#39;t seem to change."}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "reply_to_user": {"reputation": 83, "user_id": 10102164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb7000ee4eebb46418b01b95b621f3d?s=128&d=identicon&r=PG&f=1", "display_name": "CarlosG90", "link": "https://stackoverflow.com/users/10102164/carlosg90"}, "edited": false, "score": 0, "creation_date": 1559073441, "post_id": 56347500, "comment_id": 99303390, "body": "@CarlosG90 can you run <code>which ruby</code>, <code>which asdf</code>, <code>which gem</code> and post the results? Also, inspect your $PATH and see where <code>&#47;Users&#47;username&#47;asdf</code> folders are in relation to <code>&#47;usr&#47;bin</code> (<code>&#47;usr&#47;bin</code> is where the system ruby/gem commands are kept)"}, {"owner": {"reputation": 83, "user_id": 10102164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb7000ee4eebb46418b01b95b621f3d?s=128&d=identicon&r=PG&f=1", "display_name": "CarlosG90", "link": "https://stackoverflow.com/users/10102164/carlosg90"}, "edited": false, "score": 0, "creation_date": 1559077291, "post_id": 56347500, "comment_id": 99304946, "body": "it seems that the paths were incorrect, I was able to add them and the shims are there now! Thanks!"}], "tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": false, "score": 1, "last_activity_date": 1559065199, "creation_date": 1559065199, "answer_id": 56347500, "question_id": 56346809, "link": "https://stackoverflow.com/questions/56346809/cant-install-gems-using-asdf/56347500#56347500", "title": "Can&#39;t install gems using asdf", "body": "<p>It sounds like you may need to add the relevant lines to your <code>.zshrc</code> so asdf shims get recognized. You can find the instructions <a href=\"https://asdf-vm.com/#/core-manage-asdf-vm?id=install-asdf-vm\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>For macOS &amp; zsh the correct lines to append to .zshrc are:</p>\n\n<pre><code>echo -e '\\n. $HOME/.asdf/asdf.sh' &gt;&gt; ~/.zshrc\necho -e '\\n. $HOME/.asdf/completions/asdf.bash' &gt;&gt; ~/.zshrc\n</code></pre>\n\n<p>After doing so, either <code>source ~/.zshrc</code> or restart your terminal</p>\n"}], "owner": {"reputation": 83, "user_id": 10102164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb7000ee4eebb46418b01b95b621f3d?s=128&d=identicon&r=PG&f=1", "display_name": "CarlosG90", "link": "https://stackoverflow.com/users/10102164/carlosg90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2049, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1611687587, "creation_date": 1559062043, "last_edit_date": 1611687587, "question_id": 56346809, "link": "https://stackoverflow.com/questions/56346809/cant-install-gems-using-asdf", "title": "Can&#39;t install gems using asdf", "body": "<p>So I'm switching to a project that is using <code>ruby</code>. They use <code>asdf</code> as a package manager</p>\n\n<p>I\u2019m having trouble installing the gems, I\u2019m using <code>zsh</code> and I\u2019m thinking there might be an issue with the paths</p>\n\n<p>Running <code>gem install bundler</code> outputs: <code>You don't have write permissions for the /Library/Ruby/Gems/2.3.0 directory.</code></p>\n\n<p><code>ruby -v</code>\noutputs: <code>ruby 2.3.7p456 (2018-03-28 revision 63024) [universal.x86_64-darwin18]</code></p>\n\n<p><code>which ruby</code>\noutput: <code>/usr/bin/ruby</code></p>\n\n<p>And I tried setting a global version for ruby with <code>asdf global ruby 2.5.3</code> but that doesn\u2019t seem to change the version</p>\n\n<p>This is my <code>gem environment</code>:</p>\n\n<pre><code>RubyGems Environment:\n  - RUBYGEMS VERSION: 2.5.2.3\n  - RUBY VERSION: 2.3.7 (2018-03-28 patchlevel 456) [universal.x86_64-darwin18]\n  - INSTALLATION DIRECTORY: /Library/Ruby/Gems/2.3.0\n  - USER INSTALLATION DIRECTORY: /Users/carlos.grijalva/.gem/ruby/2.3.0\n  - RUBY EXECUTABLE: /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/bin/ruby\n  - EXECUTABLE DIRECTORY: /usr/local/bin\n  - SPEC CACHE DIRECTORY: /Users/carlos.grijalva/.gem/specs\n  - SYSTEM CONFIGURATION DIRECTORY: /Library/Ruby/Site\n  - RUBYGEMS PLATFORMS:\n    - ruby\n    - universal-darwin-18\n  - GEM PATHS:\n     - /Library/Ruby/Gems/2.3.0\n     - /Users/carlos.grijalva/.gem/ruby/2.3.0\n     - /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/gems/2.3.0\n  - GEM CONFIGURATION:\n     - :update_sources =&gt; true\n     - :verbose =&gt; true\n     - :backtrace =&gt; false\n     - :bulk_threshold =&gt; 1000\n  - REMOTE SOURCES:\n     - https://rubygems.org/\n  - SHELL PATH:\n     - /Users/carlos.grijalva/.asdf/shims\n     - /Users/carlos.grijalva/.asdf/bin\n     - /Users/carlos.grijalva/bin\n     - /usr/local/bin\n     - /usr/local/bin\n     - /usr/bin\n     - /bin\n     - /usr/sbin\n     - /sbin\n</code></pre>\n"}, {"tags": ["ruby", "dice"], "comments": [{"owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 1, "creation_date": 1559060543, "post_id": 56346296, "comment_id": 99297813, "body": "Welcome to SO! In order to help you, we need to see your <code>gameWinner</code> function and know what you mean by &quot;the program breaks&quot;. What is the error thrown? What debugging steps have you taken?"}, {"owner": {"reputation": 11, "user_id": 11137654, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vM6Yg.jpg?s=128&g=1", "display_name": "Docedson", "link": "https://stackoverflow.com/users/11137654/docedson"}, "reply_to_user": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1559061252, "post_id": 56346296, "comment_id": 99298191, "body": "Thank you for the welcome! I&#39;ve edited the gameWinner back in. I get: Traceback (most recent call last):         2: from rollEm2.rb:83:in <code>&lt;main&gt;&#39;         1: from rollEm2.rb:79:in </code>play&#39; rollEm2.rb:44:in `gameWinner&#39;: wrong number of arguments (given 0, expected 1) (ArgumentError)"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1559061517, "post_id": 56346296, "comment_id": 99298328, "body": "the error is telling you that <code>gameWinner</code> is being called without required arguments. see line 79"}, {"owner": {"reputation": 1280, "user_id": 8513648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c59086b9318c37cc02acaeb85fef8f6?s=128&d=identicon&r=PG", "display_name": "J-L", "link": "https://stackoverflow.com/users/8513648/j-l"}, "edited": false, "score": 1, "creation_date": 1559062761, "post_id": 56346296, "comment_id": 99298862, "body": "Forgive me for nitpicking, but the word &quot;die&quot; is singular, and &quot;dice&quot; is plural.  For example:  &quot;I have one die; she has two dice.&quot;  (This is a common error among native English speakers.)  If you need help remembering which word is plural, just realize that many English plural nouns end in an &quot;s&quot; sound, and the plural word &quot;dice&quot; is no exception here."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1559063660, "post_id": 56346296, "comment_id": 99299255, "body": "Also in in <code>gameWinner(rounds)</code>: 1. the variables <code>total_1</code>, <code>total_2</code> and <code>total_3</code> are not defined (maybe add <code>@</code> at the beginning of the name to render it &quot;global&quot;). 2. Only one variable takes a value: <code>roundWinner1</code>, <code>roundWinner2</code>, <code>roundWinner3</code> due to the <code>if</code> statement, so initialise them <code>roundWinner1, roundWinner2, roundWinner3 = 0, 0, 0</code>"}, {"owner": {"reputation": 11, "user_id": 11137654, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vM6Yg.jpg?s=128&g=1", "display_name": "Docedson", "link": "https://stackoverflow.com/users/11137654/docedson"}, "edited": false, "score": 0, "creation_date": 1559067407, "post_id": 56346296, "comment_id": 99300849, "body": "Ahhh! the global @ -- new to me, and I can&#39;t seem to remember that - thank you!!!"}], "answers": [{"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 1, "last_activity_date": 1559061653, "creation_date": 1559061653, "answer_id": 56346726, "question_id": 56346296, "link": "https://stackoverflow.com/questions/56346296/problem-with-function-to-determine-the-winner-of-multiple-rounds-in-a-dice-game/56346726#56346726", "title": "Problem with function to determine the winner of multiple rounds in a dice game", "body": "<p>The method <code>gameWinner</code> is being called without arguments but looks like the argument expected is not used in your method. So try to remove it from the definition:</p>\n\n<pre><code>def gameWinner\n  #... your method code\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1559080352, "last_edit_date": 1559080352, "creation_date": 1559073058, "answer_id": 56349189, "question_id": 56346296, "link": "https://stackoverflow.com/questions/56346296/problem-with-function-to-determine-the-winner-of-multiple-rounds-in-a-dice-game/56349189#56349189", "title": "Problem with function to determine the winner of multiple rounds in a dice game", "body": "<p>Here's a more Ruby-like way to think of the problem, using a <code>Player</code> class. Note that the numbers of players and rounds are not fixed. I have omitted prompts to ask players to roll the dice. If the first two lines of the definition of the class are head-scratchers, not to worry--see the explanation at the end of the answer.</p>\n\n<pre><code>class Player\n  @players = []\n  singleton_class.send(:attr_reader, :players)\n\n  attr_reader :name, :cum_score\n\n  def initialize(name)\n     @name = name\n     @cum_score = 0\n     self.class.players &lt;&lt; self\n  end\n\n  def blow_on_dice\n    # Come to papa!\n  end\n\n  def throw\n    score = rand(1..6) + rand(1..6) \n    @cum_score += score\n    score\n  end\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>def show_winners(scores)\n  max_score = scores.values.max\n  winners = scores.select { |_,v| v == max_score }.keys\n  if winners.size == 1\n    puts \"Winner with a score of #{max_score} is #{winners.first}\"\n  else\n    print \"Winners of round with a score of #{max_score} are \"\n    winners.each_with_index do |name,i|\n      print name\n      print case i\n            when winners.size-1 then ''\n            when winners.size-2 then ' and '\n            else                ', '\n            end\n    end\n    puts\n  end\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>Player.new('Cary')\n  #=&gt; #&lt;Player:0x000059a79738b768 @name=\"Cary\", @cum_score=0&gt; \nPlayer.new('Hal')\n  #=&gt; #&lt;Player:0x000059a7973d7690 @name=\"Hal\", @cum_score=0&gt; \nPlayer.new('Deep Thought')\n  #=&gt; #&lt;Player:0x000059a79756f318 @name=\"Deep Thought\", @cum_score\nnbr_rounds = 3\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>players = Player.players\n  #=&gt; [#&lt;Player:0x000059a79738b768 @name=\"Cary\", @cum_score=0&gt;,\n  #    #&lt;Player:0x000059a7973d7690 @name=\"Hal\", @cum_score=0&gt;,\n  #    #&lt;Player:0x000059a79756f318 @name=\"Deep Thought\", @cum_score=0&gt;] \n\n(1..nbr_rounds).each do |round|\n  puts \"\\nResults for round #{round}\"\n  scores = players.each_with_object({}) do |p,h|\n    p.blow_on_dice\n    score = p.throw\n    puts \"#{p.name} throws #{score}\"\n    h[p.name] = score\n  end\n  show_winners(scores)\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>Results for round 1\nCary throws 8\nHal throws 9\nDeep Thought throws 9\nWinners of round with a score of 9 are Hal and Deep Thought\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>Results for round 2\nCary throws 7\nHal throws 9\nDeep Thought throws 9\nWinners of round with a score of 9 are Hal and Deep Thought\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>Results for round 3\nCary throws 7\nHal throws 11\nDeep Thought throws 6\nWinner with a score of 11 is Hal\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>puts \"\\nResults for all rounds\"\nscores = players.each_with_object({}) do |p,h|\n  h[p.name] = p.cum_score\n  puts \"#{p.name} had a total score of #{p.cum_score}\"\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>Results for all rounds\nCary had a total score of 22\nHal had a total score of 29\nDeep Thought had a total score of 24\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>show_winners(scores)\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>Winner with a score of 29 is Hal\n</code></pre>\n\n<p>If the line</p>\n\n<pre><code>puts \"scores = #{scores}\"\n</code></pre>\n\n<p>is inserted before the first line in <code>show_winners</code>, the following is displayed for the three each-round calculations:</p>\n\n<pre><code>scores = {\"Cary\"=&gt;7, \"Hal\"=&gt;5, \"Deep Thought\"=&gt;7}\nscores = {\"Cary\"=&gt;4, \"Hal\"=&gt;7, \"Deep Thought\"=&gt;3}\nscores = {\"Cary\"=&gt;10, \"Hal\"=&gt;11, \"Deep Thought\"=&gt;8}\n</code></pre>\n\n<p>For the totals calculation the following is displayed:</p>\n\n<pre><code>scores = {\"Cary\"=&gt;21, \"Hal\"=&gt;23, \"Deep Thought\"=&gt;18}\n</code></pre>\n\n<p>Note that <code>@players</code> is an instance_variable for the class (as opposed to instances of the class). The line <code>singleton_class.send(:attr_reader, :players)</code> creates a getter for that variable, allowing us to write <code>Player.players</code> to obtain an array of the instances of <code>Players</code> that have been created. One of several alternatives to that line is the following:</p>\n\n<pre><code>class &lt;&lt; self\n  attr_reader :players\nend\n</code></pre>\n\n<p>Alternatively, the collection of instances of <code>Players</code> that have been created would be maintained outside the class, but that is prone to error (if, for example, a player is later added):</p>\n\n<pre><code>players = [Player.new('Cary'), Player.new('Hal'), Player.new('Deep Thought')]\n</code></pre>\n\n<p>Were that done the class definition would be simplified to the following.</p>\n\n<pre><code>class Player\n  attr_reader :name, :cum_score\n\n  def initialize(name)\n     @name = name\n     @cum_score = 0\n  end\n\n  def throw\n    ...\n  end\nend\n</code></pre>\n\n<p>This design, however, prone to error (if, for example, a player were later added) and <code>players</code> were not updated.</p>\n"}], "owner": {"reputation": 11, "user_id": 11137654, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vM6Yg.jpg?s=128&g=1", "display_name": "Docedson", "link": "https://stackoverflow.com/users/11137654/docedson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1559080352, "creation_date": 1559059952, "last_edit_date": 1559065235, "question_id": 56346296, "link": "https://stackoverflow.com/questions/56346296/problem-with-function-to-determine-the-winner-of-multiple-rounds-in-a-dice-game", "title": "Problem with function to determine the winner of multiple rounds in a dice game", "body": "<p>We have an assignment to determine the ultimately winner in a dice game. Here's the complete rules:</p>\n\n<p>You will be pitted against two other computer players in this game. There are three rounds. At the beginning of each round a player rolls two dice. The total of your dice roll for that round is added to your points. Your points always start at zero. Each consecutive round the points are added to the total. At the end of the third round, whoever has the most points wins the game.</p>\n\n<p>REQUIREMENTS\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nEach player has two dice\nThe player rolls each die once per round\nDisplay each players score at the end of each round\nDisplay the leader of the round at the end of each round\nPrompt the user to roll to begin the next around\nAfter three rounds the game is over\nThe players score persists until the end of the game\nOnce the game ends, a winner is declared\nOnce a winner is declared you have the option to restart or quit</p>\n\n<p>I've gotten everything to work, except how to determine the ultimate winner of the game. I've tried making a new method called \"gameWinner\", using if/elsif statements, grabbing the total scores from each round and adding each up respectively. However, the program breaks once it reaches that. I can't think of how else to solve this problems, but nothing I type seems to function right.</p>\n\n<pre><code>def welcome\n    puts \"\"\n    puts \"Let's roll some die! You will be competing against 2 computers in 3 rounds, each player having 2 die.\"\n    puts \"Please enter your name and press 'Enter'\"\n    puts \"\"\n    @userName = gets.chomp\n    puts (\"Welcome, \" + @userName + \". Let's roll those die!\")\n    puts \"\"\nend\n\ndef round(round)\n    result_1 = Random.new.rand(1..6)\n    result_2 = Random.new.rand(1..6)\n    total_1 = result_1 + result_2\n\n    result_3 = Random.new.rand(1..6)\n    result_4 = Random.new.rand(1..6)\n    total_2 = result_3 + result_4\n\n    result_5 = Random.new.rand(1..6)\n    result_6 = Random.new.rand(1..6)\n    total_3 = result_5 + result_6\n\n    winner = [total_1, total_2, total_3].max\n    players = {total_1 =&gt; @userName, total_2 =&gt; \"Computer 1\", total_3 =&gt; \"Computer 2\"}.max\n\n    puts \"Round #{round}\"\n    puts \"#{@userName}, your die are a #{result_1} and a #{result_2}, totaling #{total_1}\"\n    puts \"Computer 1's die are a #{result_3} and a #{result_4}, totaling #{total_2}\"\n    puts \"Computer 2's die are a #{result_5} and a #{result_6}, totaling #{total_3}\"\n    puts \"Round #{round} highest score is: #{winner}\"\n        if total_1&gt; total_2 &amp;&amp; total_3\n            puts \"#{@userName} is the winner!\"\n        elsif total_2 &gt; total_1 &amp;&amp; total_3\n            puts \"Computer 1 is the winner!\"\n        elsif total_3 &gt; total_1 &amp;&amp; total_2\n            puts \"Computer 2 is the winner!\"\n        else\n            puts \"It was a tie, there are no winners.\"\n        end\n    puts \"\"  \nend\n\ndef gameWinner(rounds)\n    if total_1&gt; total_2 &amp;&amp; total_3\n        roundWinner1 = 1\n    elsif total_2 &gt; total_1 &amp;&amp; total_3\n        roundWinner2 = 1\n    else total_3 &gt; total_1 &amp;&amp; total_2\n        roundWinner3 = 1\n    end\n\n    gameSummary1 = roundWinner1 + roundWinner1 + roundWinner1\n    gameSummary2 = roundWinner2 + roundWinner2 + roundWinner2\n    gameSummary3 = roundWinner3 + roundWinner3 + roundWinner3\n    winnerOA = [gameSummary1, gameSummary2, gameSummary3].max\n\n    puts \"The winner of the game is #{winnerOA}\"\nend\n\ndef playAgain\n    puts \"Would you like to start over? (Y/N)\\n\"\n    answer = gets.chomp.upcase\n    if answer == \"Y\"\n        play\n    elsif answer == \"N\"\n        puts \"Thank you for playing.\\n\"\n    else\n        playAgain\n    end    \n  end\n\ndef play\n    welcome\n    round(1)\n    round_1 = round(1)   \n    round(2)\n    round(3)\n    gameWinner    \n    playAgain\nend\n\nplay\n</code></pre>\n\n<p>I've expected the program to report the overall winner, but I'm just blanking on how to grab it.</p>\n\n<p>Here is the error thrown by the <code>gameWinner</code> function:</p>\n\n<blockquote>\n  <p>Traceback (most recent call last): 2: from rollEm2.rb:83:in ' 1: from rollEm2.rb:79:in play' rollEm2.rb:44:in `gameWinner': wrong number of arguments (given 0, expected 1) (ArgumentError)</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 8462, "user_id": 405865, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e29f04f339715955060858e0e65e1311?s=128&d=identicon&r=PG", "display_name": "fphilipe", "link": "https://stackoverflow.com/users/405865/fphilipe"}, "is_accepted": false, "score": 0, "last_activity_date": 1559058635, "last_edit_date": 1559058635, "creation_date": 1559058029, "answer_id": 56345722, "question_id": 56345427, "link": "https://stackoverflow.com/questions/56345427/does-x-work-like-return-x-if-x-present/56345722#56345722", "title": "Does @x ||= work like return @x if @x.present?", "body": "<p>It depends.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>@x ||= value\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>@x = @x || value\n</code></pre>\n\n<p>which assigns <code>value</code> to <code>@x</code> only if <code>@x</code> is falsy. In Ruby, only <code>false</code> and <code>nil</code> are falsy.</p>\n\n<p>Further, <code>#present?</code> is a concept from Rails (see <a href=\"https://api.rubyonrails.org/classes/Object.html#method-i-present-3F\" rel=\"nofollow noreferrer\">doc</a>).</p>\n\n<p>Note though that depending on the value that you expect to store in <code>@x</code>, it <em>might</em> be equivalent. <code>#present?</code> is simply the negation of <code>#blank?</code> (also a Rails concept). <code>#blank?</code> is defined on <code>Object</code> as follows:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def blank?\n  respond_to?(:empty?) ? !!empty? : !self\nend\n</code></pre>\n\n<p>Thus, the behavior of the two snippets you posted is guaranteed to be equivalent when <code>@x</code> contains a value that doesn't define its own <code>#present?</code>, <code>#blank?</code>, or <code>#empty?</code> methods.</p>\n\n<p>Now, <code>FalseClass</code> and <code>NilClass</code> both define <code>#blank?</code>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def blank?\n  true\nend\n</code></pre>\n\n<p><code>TrueClass</code> also defines <code>#blank?</code>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def blank?\n  false\nend\n</code></pre>\n\n<p>But this is just an optimization as the default implementation from <code>Object</code> would result in the same values. </p>\n\n<p>Therefore, <code>false</code> and <code>nil</code> will return <code>false</code> for <code>#present?</code> and <code>true</code> will return <code>true</code> for <code>#present?</code>.</p>\n\n<p>From this we conclude that, in the specific case of storing boolean values in <code>@x</code>, the behavior of the two snippets is equivalent.</p>\n"}, {"comments": [{"owner": {"reputation": 13410, "user_id": 1005039, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/gpI0G.jpg?s=128&g=1", "display_name": "Gustav Bertram", "link": "https://stackoverflow.com/users/1005039/gustav-bertram"}, "edited": false, "score": 0, "creation_date": 1559058923, "post_id": 56345730, "comment_id": 99296919, "body": "I did notice it would recalculate on a false for both cases, but I&#39;m not sure if that&#39;s intended behaviour. Good point about memoizing boolean values though."}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 6, "last_activity_date": 1559058359, "last_edit_date": 1559058359, "creation_date": 1559058051, "answer_id": 56345730, "question_id": 56345427, "link": "https://stackoverflow.com/questions/56345427/does-x-work-like-return-x-if-x-present/56345730#56345730", "title": "Does @x ||= work like return @x if @x.present?", "body": "<p>You should not use either option for memoizing <code>boolean</code> values as both will recalculate if <code>@x</code> is <code>false</code>. </p>\n\n<p><code>present?</code> is a special kind of rails check that equates to <code>!blank?</code> and <code>false.blank? #=&gt; true</code> but even if this was not a boolean check <code>present?</code> and <code>||</code> are not equivalent. For objects that implement <code>empty?</code> blank defers to that so something that is <code>empty?</code> is also <code>blank?</code> and thus is not <code>present?</code>.</p>\n\n<pre><code>\"\".present? #=&gt; false\n\"\" || true #=&gt; \"\" \n[].present? #=&gt; false\n[] || true #=&gt; [] \nfalse.present? #=&gt; false\nfalse || true #=&gt; true\n</code></pre>\n\n<p><code>@x ||= some_logic</code> equates to <code>@x = @x || some_logic</code> where obviously if <code>@x</code> is false <code>some_logic</code> will fire.</p>\n\n<p>If you just want to see if <code>@x</code> has already been determined to be a value (e.g. not <code>nil</code>) then you could replace this with</p>\n\n<pre><code>def x? \n  return @x unless @x.nil? \n  @x = some_logic\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "is_accepted": false, "score": 0, "last_activity_date": 1559058987, "creation_date": 1559058987, "answer_id": 56346040, "question_id": 56345427, "link": "https://stackoverflow.com/questions/56345427/does-x-work-like-return-x-if-x-present/56346040#56346040", "title": "Does @x ||= work like return @x if @x.present?", "body": "<p><strong>TL;DR: No</strong></p>\n\n<p>Just to add more examples to the answers already above:</p>\n\n<pre><code>def x1?(new_value)\n  return @x if @x.present?\n\n  @x = new_value\nend\n\ndef x2?(new_value)\n  @x ||= new_value\nend\n</code></pre>\n\n<p>say <code>@x</code> was a Number:</p>\n\n<pre><code>@x = 123\nx1?('new value')\n@x\n# =&gt; 123\n\n@x = 123\nx2?('new value')\n@x\n# =&gt; 123\n\n# 123 == 123, so this works for `Number`\n</code></pre>\n\n<p>but let's say <code>@x</code> was an empty Array:</p>\n\n<pre><code>@x = []\nx1?('new value')\n@x\n# =&gt; 'new value'\n\n@x = []\nx2?('new value')\n@x\n# =&gt; []\n\n# 'new value' != [], so it doesn't work for empty Array.\n</code></pre>\n\n<p>^ and there are all other \"types\" that this doesn't work as well not just empty Array, some of which have already been answered by others here.</p>\n"}], "owner": {"reputation": 13410, "user_id": 1005039, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/gpI0G.jpg?s=128&g=1", "display_name": "Gustav Bertram", "link": "https://stackoverflow.com/users/1005039/gustav-bertram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 1, "accepted_answer_id": 56345730, "answer_count": 3, "score": 2, "last_activity_date": 1559059148, "creation_date": 1559056911, "question_id": 56345427, "link": "https://stackoverflow.com/questions/56345427/does-x-work-like-return-x-if-x-present", "title": "Does @x ||= work like return @x if @x.present?", "body": "<p>Is this:</p>\n\n<pre><code>def x?\n  return @x if @x.present?\n\n  @x = #boolean calculation\nend\n</code></pre>\n\n<p>Equivalent to this for boolean values of <code>@x</code>?</p>\n\n<pre><code>def x?\n  @x ||= #boolean calculation\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "rails-console"], "comments": [{"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1559055022, "post_id": 56344823, "comment_id": 99294627, "body": "How are users and states related in your database? It&#39;s hard helping you without this info"}, {"owner": {"reputation": 11, "user_id": 9983237, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yQHHb0IPMSA/AAAAAAAAAAI/AAAAAAAAHY8/VXQnQppEeuE/photo.jpg?sz=128", "display_name": "Diego", "link": "https://stackoverflow.com/users/9983237/diego"}, "reply_to_user": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1559055304, "post_id": 56344823, "comment_id": 99294817, "body": "pry(main)&gt;City.last   id: 5763,  state_id: 27,  name: &quot;Campinas&quot;,  created_at: Fri, 24 May 2019 14:12:29 -03 -03:00,  updated_at: Fri, 24 May 2019 14:12:29 -03 -03:00,  deleted_at: nil&gt;"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1559055348, "post_id": 56344823, "comment_id": 99294841, "body": "Still, I don&#39;t see any users"}, {"owner": {"reputation": 11, "user_id": 9983237, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yQHHb0IPMSA/AAAAAAAAAAI/AAAAAAAAHY8/VXQnQppEeuE/photo.jpg?sz=128", "display_name": "Diego", "link": "https://stackoverflow.com/users/9983237/diego"}, "reply_to_user": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1559055502, "post_id": 56344823, "comment_id": 99294939, "body": "@Ursus, thanks for you attention. I changed the question where was User to Cities"}, {"owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "edited": false, "score": 0, "creation_date": 1559055551, "post_id": 56344823, "comment_id": 99294970, "body": "@Diego can you edit your post and add your schema.rb"}], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 6538177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3ddd76946e2e55a0c11e8804b304c0?s=128&d=identicon&r=PG&f=1", "display_name": "alexalth", "link": "https://stackoverflow.com/users/6538177/alexalth"}, "is_accepted": true, "score": 1, "last_activity_date": 1559064358, "creation_date": 1559064358, "answer_id": 56347333, "question_id": 56344823, "link": "https://stackoverflow.com/questions/56344823/how-to-know-if-a-some-item-or-object-is-using-a-model-in-rails/56347333#56347333", "title": "How to know if a some item or object is using a Model in rails", "body": "<p>First, you need to define the relationship between City and State.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># app/models/city.rb\n\nclass City &lt; ApplicationRecord\n  belongs_to :state\nend\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code># app/models/state.rb\n\nclass State &lt; ApplicationRecord\n  has_many :cities\nend\n</code></pre>\n\n<p>Now in the console you can call:</p>\n\n<pre><code>State.last.cities\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9983237, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yQHHb0IPMSA/AAAAAAAAAAI/AAAAAAAAHY8/VXQnQppEeuE/photo.jpg?sz=128", "display_name": "Diego", "link": "https://stackoverflow.com/users/9983237/diego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 56347333, "answer_count": 1, "score": -2, "last_activity_date": 1559064358, "creation_date": 1559054892, "last_edit_date": 1559055849, "question_id": 56344823, "link": "https://stackoverflow.com/questions/56344823/how-to-know-if-a-some-item-or-object-is-using-a-model-in-rails", "title": "How to know if a some item or object is using a Model in rails", "body": "<p>I have the following situation:</p>\n\n<p>A model called State with some info:</p>\n\n<pre><code>pry(main)&gt; State.last\n</code></pre>\n\n<pre><code> id: 35,\n region_id: 6,\n name: \"S\u00e3o Paulo\",\n abbreviation: \"SP\",\n created_at: Mon, 03 Jul 2017 09:38:22 -03 -03:00,\n updated_at: Mon, 03 Jul 2017 09:38:22 -03 -03:00,\n deleted_at: nil&gt;\n</code></pre>\n\n<p>I want to know which Cities or another models and objects, is using this determined id.</p>\n\n<p>This is the schema.rb to Cities</p>\n\n<pre><code>  create_table \"cities\", force: :cascade, options: \"ENGINE=InnoDB DEFAULT CHARSET=utf8\" do |t|\n    t.integer  \"state_id\",   null: false\n    t.string   \"name\",       null: false\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.datetime \"deleted_at\"\n    t.index [\"deleted_at\"], name: \"index_cities_on_deleted_at\", using: :btree\n    t.index [\"state_id\"], name: \"index_cities_on_state_id\", using: :btree\n  end\n</code></pre>\n\n<p>Obs: \"I tried to find some answer related to this topic, but I didn't found\", If exists, please, report me and I will delete this question.</p>\n\n<p>Thanks a lot</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql"], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1559064008, "post_id": 56346097, "comment_id": 99299389, "body": "Unless I misunderstand I think the OP is looking for <code>Availability.where(user_id: GroupUser.select(:user_id).where(group_id: user.groups.select(:id)))</code> because she wants all the <code>Availability</code>s where <code>availabilities.user_id</code> is in the same group(s) as the current user. I could be wrong though"}], "tags": [], "owner": {"reputation": 645, "user_id": 589384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8957681fbb8dba72e9c710e4ddf57c83?s=128&d=identicon&r=PG", "display_name": "Peter Balaban", "link": "https://stackoverflow.com/users/589384/peter-balaban"}, "is_accepted": false, "score": 1, "last_activity_date": 1559059852, "last_edit_date": 1559059852, "creation_date": 1559059168, "answer_id": 56346097, "question_id": 56344677, "link": "https://stackoverflow.com/questions/56344677/find-all-records-associated-with-a-user-in-same-group-as-current-user/56346097#56346097", "title": "Find all records associated with a user in same group as current_user", "body": "<p>There are two options to do so:</p>\n\n<p>1) Through the join</p>\n\n<pre><code>Availability.joins(user: :groups).distinct\n</code></pre>\n\n<p>2) Through the sub queries</p>\n\n<pre><code>Availability.where(user_id: User.joins(:groups).distinct.pluck(:id))\n</code></pre>\n\n<p>If you need to filter Availability with a specific group you can add <code>.where(groups: { name: 'Group name' })</code> condition</p>\n"}, {"tags": [], "owner": {"reputation": 1296, "user_id": 8377250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3705bb7e15384ec8a6b41f60d59b3e10?s=128&d=identicon&r=PG&f=1", "display_name": "mindlis", "link": "https://stackoverflow.com/users/8377250/mindlis"}, "is_accepted": false, "score": 0, "last_activity_date": 1559650206, "creation_date": 1559650206, "answer_id": 56443614, "question_id": 56344677, "link": "https://stackoverflow.com/questions/56344677/find-all-records-associated-with-a-user-in-same-group-as-current-user/56443614#56443614", "title": "Find all records associated with a user in same group as current_user", "body": "<p>Does this get what you're looking for?  </p>\n\n<pre><code>class Availability &lt; ApplicationRecord\n  belongs_to :user\n  has_many :groups, through: :user\n\n  scope :for_user_in_groups, lambda { |user|\n    next all unless user.present?\n\n    joins(user: :groups).where(groups: { id: user.groups.select(:id) }).distinct\n  }\nend\n</code></pre>\n\n<p>This produces:</p>\n\n<pre><code>[32] pry(main)&gt; Availability.for_user_in_groups(User.find(2))\n  User Load (0.2ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 LIMIT $2  [[\"id\", 2], [\"LIMIT\", 1]]\n  Availability Load (0.8ms)  SELECT DISTINCT \"availabilities\".* FROM \"availabilities\" INNER JOIN \"users\" ON \"users\".\"id\" = \"availabilities\".\"user_id\" INNER JOIN \"group_users\" ON \"group_users\".\"user_id\" = \"users\".\"id\" INNER JOIN \"groups\" ON \"groups\".\"id\" = \"group_users\".\"group_id\" WHERE \"groups\".\"id\" IN (SELECT \"groups\".\"id\" FROM \"groups\" INNER JOIN \"group_users\" ON \"groups\".\"id\" = \"group_users\".\"group_id\" WHERE \"group_users\".\"user_id\" = $1)  [[\"user_id\", 2]]\n  =&gt; [#&lt;Availability:0x00007fd3830bae38 id: 6, user_id: 3&gt;,\n    #&lt;Availability:0x00007fd3830bacf8 id: 5, user_id: 2&gt;,\n    #&lt;Availability:0x00007fd3830babb8 id: 3, user_id: 3&gt;,\n    #&lt;Availability:0x00007fd3830baa78 id: 2, user_id: 2&gt;]\n</code></pre>\n"}], "owner": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1559650206, "creation_date": 1559054445, "last_edit_date": 1559060146, "question_id": 56344677, "link": "https://stackoverflow.com/questions/56344677/find-all-records-associated-with-a-user-in-same-group-as-current-user", "title": "Find all records associated with a user in same group as current_user", "body": "<p>My models: User, Group, GroupsUser, and Availability.</p>\n\n<p>I want to find all Availabilities created by users who are associated to a group, or several groups. </p>\n\n<pre><code>class Availability &lt; ApplicationRecord\n  belongs_to :user\nend\n\nclass User &lt; ApplicationRecord\n  has_many :group_users\n  has_many :groups, through: :group_users\n\n  has_many :availabilities\nend\n\nclass Group &lt; ApplicationRecord\n  has_many :group_users\n  has_many :users, through: :group_users\nend\n\nclass GroupUser &lt; ApplicationRecord\n  belongs_to :group\n  belongs_to :user\nend\n</code></pre>\n\n<p>Here is what I've tried to find all Availabilities created by a user in the same group as the first user. How can I make this query?</p>\n\n<pre><code>user = User.first\n\nAvailability.joins(:user).where('user.groups.pluck[:id] IN (?)', user.groups.pluck[:id])\n</code></pre>\n\n<p>Would also be great to put a scope on the Group, but it throws an error each time I do that.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1559057167, "post_id": 56344559, "comment_id": 99295936, "body": "Do you need to handle odd numbers of digits, and if so how? E.g. Would the input <code>12345</code> produce <code>[&quot;12&quot;,&quot;34&quot;]</code>, <code>[&quot;12&quot;,&quot;34&quot;,&quot;5&quot;]</code>, or <code>[&quot;1&quot;,&quot;23&quot;,&quot;45&quot;]</code>?"}, {"owner": {"reputation": 47, "user_id": 8115335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d42ff71d9ca5de7b3adcf9292a8ebc36?s=128&d=identicon&r=PG&f=1", "display_name": "ZeeZee", "link": "https://stackoverflow.com/users/8115335/zeezee"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1559060386, "post_id": 56344559, "comment_id": 99297733, "body": "Hi @JordanRunning, I want double digit numbers only."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1559061385, "post_id": 56344559, "comment_id": 99298261, "body": "Will your input ever have an odd number of digits? Either way, the first solution in <a href=\"https://stackoverflow.com/a/56344789/179125\">my answer</a> solves your problem."}, {"owner": {"reputation": 47, "user_id": 8115335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d42ff71d9ca5de7b3adcf9292a8ebc36?s=128&d=identicon&r=PG&f=1", "display_name": "ZeeZee", "link": "https://stackoverflow.com/users/8115335/zeezee"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1559062158, "post_id": 56344559, "comment_id": 99298578, "body": "@JordanRunning,  I won&#39;t input any odd number, so your first solution is perfect for me. I can continue my project. Thank you."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 1, "creation_date": 1559062282, "post_id": 56344559, "comment_id": 99298637, "body": "Glad to help. If my answer solved your problem feel free to mark it as &quot;Accepted.&quot; You&#39;re welcome, of course, to wait and see if any better solutions come along."}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1559056829, "post_id": 56344730, "comment_id": 99295713, "body": "<code>num.digits.reverse_each.each_slice(2).map(&amp;:join)</code> would work too. Too close to your example for me to post an answer"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 2, "last_activity_date": 1559059619, "last_edit_date": 1559059619, "creation_date": 1559054623, "answer_id": 56344730, "question_id": 56344559, "link": "https://stackoverflow.com/questions/56344559/how-to-split-a-long-number-into-pairs-of-digits/56344730#56344730", "title": "How to split a long number into pairs of digits", "body": "<p>I think there is no need to use a regexp, I would do something like this:</p>\n\n<pre><code>12345678.to_s.chars.each_slice(2).map(&amp;:join)\n#=&gt; [\"12\",\"34\",\"56\",\"78\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1559074801, "post_id": 56344789, "comment_id": 99303922, "body": "The best answer, imo, but I think it would be improved by removing your #1 and #3, which I consider distractions. Note you forgot to convert the elements of <code>arr</code> to integers."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1559075742, "post_id": 56344789, "comment_id": 99304283, "body": "@CarySwoveland #1 is the one that actually solves OP\u2019s problem (see comments on question). I considered removing the others once that was made clear. I may yet. Also, in OP\u2019s example output the result is an array of strings."}], "tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": false, "score": 2, "last_activity_date": 1559056955, "last_edit_date": 1559056955, "creation_date": 1559054796, "answer_id": 56344789, "question_id": 56344559, "link": "https://stackoverflow.com/questions/56344559/how-to-split-a-long-number-into-pairs-of-digits/56344789#56344789", "title": "How to split a long number into pairs of digits", "body": "<p>The simplest way would be to use <a href=\"https://ruby-doc.org/core-2.6.3/String.html\" rel=\"nofollow noreferrer\"><code>String#scan</code></a> with the Regexp <code>/../</code>, which matches any pair of characters:</p>\n\n<pre><code>n = 12345678\n\narr = n.to_s.scan(/../)\n# =&gt; [\"12\", \"34\", \"56\", \"78\"]\n</code></pre>\n\n<p>If you need to handle odd numbers of digits and keep the last digit, use <code>/..?/</code> instead:</p>\n\n<pre><code>n = 123456789\n\narr = n.to_s.scan(/..?/)\n# =&gt; [\"12\", \"34\", \"56\", \"78\", \"9\"]\n</code></pre>\n\n<p>An alternative approach would be to <code>map</code> over the range <code>0...n.to_s.size</code> using the <a href=\"https://ruby-doc.org/core-2.6.2/Range.html#method-i-step\" rel=\"nofollow noreferrer\"><code>Range#step</code></a> method:</p>\n\n<pre><code>n = 123456789\nstr = n.to_s\n\narr = (0...str.size).step(2).map {|i| str[i, 2] }\n# =&gt; [\"12\", \"34\", \"56\", \"78\", \"9\"]\n</code></pre>\n\n<p>You can see all three approaches in action on repl.it: <a href=\"https://repl.it/@jrunning/BlissfulAcclaimedStrategy\" rel=\"nofollow noreferrer\">https://repl.it/@jrunning/BlissfulAcclaimedStrategy</a></p>\n"}, {"tags": [], "owner": {"reputation": 348, "user_id": 3951881, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Xd0GY.jpg?s=128&g=1", "display_name": "Avijit Majhi", "link": "https://stackoverflow.com/users/3951881/avijit-majhi"}, "is_accepted": false, "score": 1, "last_activity_date": 1559062076, "creation_date": 1559062076, "answer_id": 56346817, "question_id": 56344559, "link": "https://stackoverflow.com/questions/56344559/how-to-split-a-long-number-into-pairs-of-digits/56346817#56346817", "title": "How to split a long number into pairs of digits", "body": "<p>You can use</p>\n\n<p><code>p = 123456789.to_s\n(0..p.length).each_cons(2).map {|i, j| \"#{p[i]}#{p[j]}\" if i%2 == 0}.compact</code></p>\n"}], "owner": {"reputation": 47, "user_id": 8115335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d42ff71d9ca5de7b3adcf9292a8ebc36?s=128&d=identicon&r=PG&f=1", "display_name": "ZeeZee", "link": "https://stackoverflow.com/users/8115335/zeezee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1559081133, "creation_date": 1559054057, "last_edit_date": 1559081133, "question_id": 56344559, "link": "https://stackoverflow.com/questions/56344559/how-to-split-a-long-number-into-pairs-of-digits", "title": "How to split a long number into pairs of digits", "body": "<p>I have a string of a long number 12345678 and want to convert it to an array like this :</p>\n\n<pre><code>[\"12\", \"34\", \"56\", \"78\"].\n</code></pre>\n\n<p>I have tried <code>array.split(//).map { |e| e.to_i  }</code>  but it does</p>\n\n<pre><code>[\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\"]\n</code></pre>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "ajax"], "comments": [{"owner": {"reputation": 4820, "user_id": 1309377, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/bYVAD.jpg?s=128&g=1", "display_name": "Andrew Lohr", "link": "https://stackoverflow.com/users/1309377/andrew-lohr"}, "edited": false, "score": 0, "creation_date": 1559054715, "post_id": 56344514, "comment_id": 99294442, "body": "can you also show us the results of your initial debugging? Only saying it doesn&#39;t work doesn&#39;t give us much to go on."}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 2, "creation_date": 1559054770, "post_id": 56344514, "comment_id": 99294472, "body": "You are not calling <code>save</code> on the <code>@view</code> object. You just built a view and assigned a leeson but you never saved it."}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1559054839, "post_id": 56344514, "comment_id": 99294517, "body": "You can do something like <code>@view = current_user.views.create(lesson_id: params[:lesson_id])</code> too"}, {"owner": {"reputation": 33, "user_id": 11568049, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oowjLJkTjkg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfYx2HePes-XevfOVVoUmKlidFBIg/mo/photo.jpg?sz=128", "display_name": "Railsdeveloperbeginner2002", "link": "https://stackoverflow.com/users/11568049/railsdeveloperbeginner2002"}, "reply_to_user": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1559055034, "post_id": 56344514, "comment_id": 99294637, "body": "@arieljuod I tried that. The View model still does not get created"}], "answers": [{"tags": [], "owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "is_accepted": true, "score": 0, "last_activity_date": 1559063040, "creation_date": 1559063040, "answer_id": 56347049, "question_id": 56344514, "link": "https://stackoverflow.com/questions/56344514/model-is-not-being-created-by-ajax/56347049#56347049", "title": "Model is not being created by AJAX", "body": "<p>From your AJAX you do not pass <code>params[:lesson_id]</code> in any way, so in controller it ends up being <code>Lesson.find(nil)</code>, which raises <code>ActiveRecord::RecordNotFound</code> and controller renders error 404 (check browser's console for that).</p>\n\n<pre><code>&lt;video id=\"video\" data-id=\"&lt;%= @lesson.id %&gt;\" controls=\"true\" width=\"auto\" height=\"auto\"&gt;\n</code></pre>\n\n<pre class=\"lang-js prettyprint-override\"><code>$('#video').onended(function() {\n  var id = $(this).data('id');\n  $.ajax({\n    url:  '/views/new'\n    type: 'post',\n    data: {\n      lesson_id: id\n    }\n  });\n});\n</code></pre>\n\n<p>Also you do not save built object, use <code>create!</code> (the bang version raises error if it cannot save):</p>\n\n<pre><code>def create\n  @view = current_user.views.create!(lesson: Lesson.find(params[:lesson_id]))\nend\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11568049, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oowjLJkTjkg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfYx2HePes-XevfOVVoUmKlidFBIg/mo/photo.jpg?sz=128", "display_name": "Railsdeveloperbeginner2002", "link": "https://stackoverflow.com/users/11568049/railsdeveloperbeginner2002"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 56347049, "answer_count": 1, "score": 0, "last_activity_date": 1559063163, "creation_date": 1559053907, "last_edit_date": 1559063163, "question_id": 56344514, "link": "https://stackoverflow.com/questions/56344514/model-is-not-being-created-by-ajax", "title": "Model is not being created by AJAX", "body": "<p>I want to create a <code>View</code> model that is created when a user finishes watching a lesson. The model should have a course id and a user id attribute. But Ajax doesn't create the view model after a lesson has been watched:</p>\n\n<p>application.js:</p>\n\n<pre><code>$('#video').onended(function() {\n  $.ajax({\n    url:  '/views/new'\n    type: 'post'\n  });\n});\n</code></pre>\n\n<p>Views Controller:</p>\n\n<pre><code>def create\n  @view = current_user.views.build\n  @view.lesson = Lesson.find(params[:lesson_id])\nend\n</code></pre>\n\n<p>View Migration:</p>\n\n<pre><code>def change\n  create_table :views do |t|\n    t.integer :lesson_id\n    t.integer :user_id\n\n    t.timestamps\n  end\nend\n</code></pre>\n\n<p>View Model:</p>\n\n<pre><code>belongs_to :user\nbelongs_to :lesson\n</code></pre>\n\n<p>User Model:</p>\n\n<pre><code>has_many :views\n</code></pre>\n\n<p>Lesson Model:</p>\n\n<pre><code>has_many :views\n</code></pre>\n\n<p>Routes:</p>\n\n<pre><code>post 'views/new' =&gt; 'views#create'\n</code></pre>\n\n<p>Lessons/show.html.erb:</p>\n\n<pre><code>&lt;h2&gt;&lt;%= @lesson.name %&gt;&lt;/h2&gt;\n&lt;video id=\"video\" controls=\"true\" width=\"auto\" \nheight=\"auto\"&gt;\n&lt;source src=\"&lt;%= url_for(@lesson.file) %&gt;\" \ntype='video/mp4'&gt;\n&lt;/video&gt;\n</code></pre>\n"}, {"tags": ["javascript", "html", "ruby-on-rails", "ruby", "haml"], "comments": [{"owner": {"reputation": 5510, "user_id": 10445697, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RFNqiVO6PKc/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXfAZXncU5HAWwYCWOT9vsRAHM5hw/mo/photo.jpg?sz=128", "display_name": "Kobe", "link": "https://stackoverflow.com/users/10445697/kobe"}, "edited": false, "score": 0, "creation_date": 1559051487, "post_id": 56343719, "comment_id": 99292557, "body": "Use <code>prop()</code> instead: <code>$(&quot;.save_task_button&quot;).prop(&quot;disabled&quot;, true&quot;)</code>"}, {"owner": {"reputation": 11, "user_id": 11476323, "user_type": "registered", "profile_image": "https://graph.facebook.com/2280911428891182/picture?type=large", "display_name": "Martin Bourdeau", "link": "https://stackoverflow.com/users/11476323/martin-bourdeau"}, "reply_to_user": {"reputation": 5510, "user_id": 10445697, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RFNqiVO6PKc/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXfAZXncU5HAWwYCWOT9vsRAHM5hw/mo/photo.jpg?sz=128", "display_name": "Kobe", "link": "https://stackoverflow.com/users/10445697/kobe"}, "edited": false, "score": 0, "creation_date": 1559055571, "post_id": 56343719, "comment_id": 99294979, "body": "It works ! Thank you for yout fast help mate"}, {"owner": {"reputation": 5510, "user_id": 10445697, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RFNqiVO6PKc/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXfAZXncU5HAWwYCWOT9vsRAHM5hw/mo/photo.jpg?sz=128", "display_name": "Kobe", "link": "https://stackoverflow.com/users/10445697/kobe"}, "edited": false, "score": 0, "creation_date": 1559055710, "post_id": 56343719, "comment_id": 99295064, "body": "No problem. I would recommend pasting your code next time rather than linking it. It can attract downvotes if you do."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11476323, "user_type": "registered", "profile_image": "https://graph.facebook.com/2280911428891182/picture?type=large", "display_name": "Martin Bourdeau", "link": "https://stackoverflow.com/users/11476323/martin-bourdeau"}, "edited": false, "score": 0, "creation_date": 1559055592, "post_id": 56343786, "comment_id": 99294993, "body": "Thank you for your fast response. It didn&#39;t work but &#39;prop&#39; made the tricks :)"}], "tags": [], "owner": {"reputation": 38, "user_id": 9942124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d85c58a90342fc4b38c13cdbc4e634cc?s=128&d=identicon&r=PG&f=1", "display_name": "timos222", "link": "https://stackoverflow.com/users/9942124/timos222"}, "is_accepted": false, "score": 0, "last_activity_date": 1559051545, "creation_date": 1559051545, "answer_id": 56343786, "question_id": 56343719, "link": "https://stackoverflow.com/questions/56343719/button-disabling-is-not-working-on-javascript-section/56343786#56343786", "title": "Button disabling is not working on JavaScript section", "body": "<p>Try to use:</p>\n\n<pre><code>$('.save_task_btn').attr(\"disabled\", true);\n$('.save_task_btn').attr(\"disabled\", false);\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>$('.save_task_btn').disabled = true;\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11476323, "user_type": "registered", "profile_image": "https://graph.facebook.com/2280911428891182/picture?type=large", "display_name": "Martin Bourdeau", "link": "https://stackoverflow.com/users/11476323/martin-bourdeau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1581308645, "creation_date": 1559051323, "last_edit_date": 1581308645, "question_id": 56343719, "link": "https://stackoverflow.com/questions/56343719/button-disabling-is-not-working-on-javascript-section", "title": "Button disabling is not working on JavaScript section", "body": "<p>On a RoR website home page I need to disable a button while a text blank is empty.</p>\n\n<p>Here is the HAML code of the button :</p>\n\n<p><a href=\"https://image.noelshack.com/fichiers/2019/22/2/1559049919-btn.jpg\" rel=\"nofollow noreferrer\">https://image.noelshack.com/fichiers/2019/22/2/1559049919-btn.jpg</a></p>\n\n<p>Here is my JavaScript code supposed to conditions the disabling :</p>\n\n<p><a href=\"https://image.noelshack.com/fichiers/2019/22/2/1559050733-disabled.jpg\" rel=\"nofollow noreferrer\">https://image.noelshack.com/fichiers/2019/22/2/1559050733-disabled.jpg</a></p>\n\n<p>Adding \"disabled = true\" in my HAML works but not in the JS (so the button stays disabled during all process which is -obviously- not what we want)</p>\n\n<p>I already tried to use the disable command line out of if/else and it is still not working.</p>\n\n<p>I'm a newbie in RoR so it is probably a grammatical mistake</p>\n\n<p>Thanks for your help !</p>\n"}, {"tags": ["ruby", "case-statement"], "comments": [{"owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 1, "creation_date": 1559052338, "post_id": 56343696, "comment_id": 99293049, "body": "Do you really need an array containing 4 separate hashes?  It seems rather bass-ackwards to be starting with the <code>:nickname</code> and then matching it with the <code>:name</code>, when most people would consider <code>:name</code> to be the accepted unique identifier for a beatle.  Why not build a single hash <code>beatles</code> using <code>:name</code> as key and <code>:nickname</code> as value rather than doing this in stages?"}, {"owner": {"reputation": 13, "user_id": 11073476, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VeyVo7kdsJM/AAAAAAAAAAI/AAAAAAAAABA/ycr4Qw9MY88/photo.jpg?sz=128", "display_name": "Calvin Mitchell", "link": "https://stackoverflow.com/users/11073476/calvin-mitchell"}, "reply_to_user": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 0, "creation_date": 1559144730, "post_id": 56343696, "comment_id": 99331716, "body": "Not sure this was a homework assignment."}, {"owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 0, "creation_date": 1559153800, "post_id": 56343696, "comment_id": 99335902, "body": "Did the homework assignment give you the array of hashes as a starting point?"}, {"owner": {"reputation": 13, "user_id": 11073476, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VeyVo7kdsJM/AAAAAAAAAAI/AAAAAAAAABA/ycr4Qw9MY88/photo.jpg?sz=128", "display_name": "Calvin Mitchell", "link": "https://stackoverflow.com/users/11073476/calvin-mitchell"}, "reply_to_user": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 0, "creation_date": 1559195491, "post_id": 56343696, "comment_id": 99346568, "body": "Yes that&#39;s the part I started with was the Beatles array of hashes."}], "answers": [{"comments": [{"owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 1, "creation_date": 1559052028, "post_id": 56343788, "comment_id": 99292867, "body": "Similarly, the output is a one-liner: <code>beatles.each { |beatle| puts &quot;Hi, I&#39;m #{beatle[:name]}.  I&#39;m #{beatle[:nickname]}!&quot; }</code>"}, {"owner": {"reputation": 13, "user_id": 11073476, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VeyVo7kdsJM/AAAAAAAAAAI/AAAAAAAAABA/ycr4Qw9MY88/photo.jpg?sz=128", "display_name": "Calvin Mitchell", "link": "https://stackoverflow.com/users/11073476/calvin-mitchell"}, "reply_to_user": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 0, "creation_date": 1559195409, "post_id": 56343788, "comment_id": 99346544, "body": "@pjs I see. Thank you."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1559051546, "creation_date": 1559051546, "answer_id": 56343788, "question_id": 56343696, "link": "https://stackoverflow.com/questions/56343696/how-do-i-use-a-case-statement-to-loop-through-an-array-of-objects-and-add-a-valu/56343788#56343788", "title": "How do I use a case statement to loop through an array of objects and add a value to a key inside the array?", "body": "<p>Nobody uses <code>while</code> loop in Ruby (we use <code>Enumerable#each</code>, <code>Enumerable#map</code> and <code>Enumerable#reduce</code> instead,) but for the sake of the answering the question stated here is the requested version. </p>\n\n<pre><code>while i &lt; beatles.length\n  beatles[i][:name] =\n    case beatles[i][:nickname]\n    when \"The Smart One\" then \"John\"\n    when \"The Funny One\" then \"Ringo\"\n    when \"The Cute One\" then \"Paul\"\n    when \"The Quiet One\" then \"George\"\n    end\n  i += 1\nend\n</code></pre>\n\n<p><code>case</code> compares its argument against variants (using <code>Object#===</code> method.) Also, you don\u2019t want to assign <code>name</code> <em>inside</em> <code>case</code>, it\u2019s better to assign it to the result of <code>case</code> instead.</p>\n\n<hr>\n\n<p>The Ruby idiomatic version:</p>\n\n<pre><code>beatles.each do |beatle|\n  beatle[:name] =\n    case beatle[:nickname]\n    when \"The Smart One\" then \"John\"\n    when \"The Funny One\" then \"Ringo\"\n    when \"The Cute One\" then \"Paul\"\n    when \"The Quiet One\" then \"George\"\n    end\nend\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11073476, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VeyVo7kdsJM/AAAAAAAAAAI/AAAAAAAAABA/ycr4Qw9MY88/photo.jpg?sz=128", "display_name": "Calvin Mitchell", "link": "https://stackoverflow.com/users/11073476/calvin-mitchell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "closed_date": 1559144923, "accepted_answer_id": 56343788, "answer_count": 1, "score": 0, "last_activity_date": 1559051546, "creation_date": 1559051237, "question_id": 56343696, "link": "https://stackoverflow.com/questions/56343696/how-do-i-use-a-case-statement-to-loop-through-an-array-of-objects-and-add-a-valu", "closed_reason": "Not suitable for this site", "title": "How do I use a case statement to loop through an array of objects and add a value to a key inside the array?", "body": "<p>I would like to look through an array of objects using a case statement and add a new value to the key name. I am new to programming please use the most simple examples and explanations. </p>\n\n<p>I've attempted to write a case statement as using the equals operator to add the new value to the key name.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>beatles = [\n    {\n      name: nil,\n      nickname: \"The Smart One\"\n    },\n    {\n      name: nil,\n      nickname: \"The Funny One\"\n    },\n    {\n      name: nil,\n      nickname: \"The Cute One\"\n      },\n    {\n      name: nil,\n      nickname: \"The Quiet One\"\n    }\n  ]\n\n  i = 0\n  while i &lt; beatles.length\n    case beatles\n    when nickname == \"The Smart One\"\n        name = \"John\"\n    when nickname == \"The Funny One\"\n        name = \"Ringo\"\n    when nickname == \"The Cute One\"\n        name = \"Paul\"\n    when nickname == \"The Quiet One\"\n        name = \"George\"\n    end\n    i += 1\n  end\n\n  i = 0\n  while i &lt; beatles.length\n    puts \"Hi, I'm #{beatles[i][:name]}.  I'm #{beatles[i][:nickname]}!\"\n    i += 1\n  end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1559053825, "post_id": 56343204, "comment_id": 99293936, "body": "Can you please elaborate on the algorithm how you created the result \u2013 especially why <code>Dennis</code> is the second last entry although its <code>id</code> is smaller than the one from <code>Gerald</code>?"}, {"owner": {"reputation": 11, "user_id": 11567492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d2d4ca647ab79a2e7931ebafa0f8e3b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe_Coder", "link": "https://stackoverflow.com/users/11567492/joe-coder"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1559112719, "post_id": 56343204, "comment_id": 99313480, "body": "The result is from a similar DB query which is ordered by the <code>name</code> column. So the result will always be ordered by name. I made a mistake when creating the sample result. I have updated the description."}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1559051358, "creation_date": 1559051358, "answer_id": 56343729, "question_id": 56343204, "link": "https://stackoverflow.com/questions/56343204/order-array-of-hashes-by-name-but-keep-names-with-same-id-together/56343729#56343729", "title": "Order array of hashes by name but keep names with same id together", "body": "<p>You should group by <code>id</code> and then sort by the first\u2019s hash <code>name</code> value.</p>\n\n<pre><code>input.group_by { |h| h[:id] }.\n      values.\n      sort_by { |a| a.first[:name] }.\n      flatten\n#\u21d2 [{:name=&gt;\"Albert\", :id=&gt;\"1\"},\n#   {:name=&gt;\"Ellen\", :id=&gt;\"1\"},\n#   {:name=&gt;\"Billy\", :id=&gt;\"3\"},\n#   {:name=&gt;\"Gerald\", :id=&gt;\"3\"},\n#   {:name=&gt;\"Carol\", :id=&gt;\"4\"},\n#   {:name=&gt;\"Dennis\", :id=&gt;\"2\"},\n#   {:name=&gt;\"Frank\", :id=&gt;\"5\"}]\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11567492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d2d4ca647ab79a2e7931ebafa0f8e3b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe_Coder", "link": "https://stackoverflow.com/users/11567492/joe-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 56343729, "answer_count": 1, "score": -1, "last_activity_date": 1559112589, "creation_date": 1559049546, "last_edit_date": 1559112589, "question_id": 56343204, "link": "https://stackoverflow.com/questions/56343204/order-array-of-hashes-by-name-but-keep-names-with-same-id-together", "title": "Order array of hashes by name but keep names with same id together", "body": "<p>I have the following array of hashes:</p>\n\n<pre><code>  [{:name=&gt;\"Albert\", :id=&gt;\"1\"},\n  {:name=&gt;\"Billy\", :id=&gt;\"3\"},\n  {:name=&gt;\"Carol\", :id=&gt;\"4\"},\n  {:name=&gt;\"Dennis\", :id=&gt;\"2\"},  \n  {:name=&gt;\"Ellen\", :id=&gt;\"1\"}, \n  {:name=&gt;\"Frank\", :id=&gt;\"5\"},\n  {:name=&gt;\"Gerald\", :id=&gt;\"3\"}]\n</code></pre>\n\n<p>I need to sort and have the result be:</p>\n\n<pre><code>  [{:name=&gt;\"Albert\", :id=&gt;\"1\"},\n  {:name=&gt;\"Ellen\", :id=&gt;\"1\"},\n  {:name=&gt;\"Billy\", :id=&gt;\"3\"},\n  {:name=&gt;\"Gerald\", :id=&gt;\"3\"} \n  {:name=&gt;\"Carol\", :id=&gt;\"4\"}, \n  {:name=&gt;\"Dennis\", :id=&gt;\"2\"}, \n  {:name=&gt;\"Frank\", :id=&gt;\"5\"}]\n</code></pre>\n\n<p>So sort names but group ids together also sorting by name. </p>\n\n<p>I have tried looking at the <code>sort_by</code> method but I don't think it will work in this situation? Any help in the right direction would be appreciated.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 1673, "user_id": 3775934, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/i2TBD.png?s=128&g=1", "display_name": "Scrobot", "link": "https://stackoverflow.com/users/3775934/scrobot"}, "edited": false, "score": 1, "creation_date": 1559050006, "post_id": 56342674, "comment_id": 99291632, "body": "If you will add some more products to your store, for example, more 3, <code>store.view</code> will print items with identifiers = 2,4,6. It seems that your <code>@database</code> is looping only odd elements when you try to remove with number parameters. If you will try to <code>store.remove(name: &quot;Sprite&quot;)</code> - it&#39;s will works correctly. Why - I don&#39;t know. If I will find an answer - I will post it)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10111321"}, "reply_to_user": {"reputation": 1673, "user_id": 3775934, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/i2TBD.png?s=128&g=1", "display_name": "Scrobot", "link": "https://stackoverflow.com/users/3775934/scrobot"}, "edited": false, "score": 0, "creation_date": 1559050527, "post_id": 56342674, "comment_id": 99291968, "body": "You are correct! Although, just like you, I have no idea why this would occur in the code I have produced. Perhaps, someone could explain to me what is happening?"}], "answers": [{"comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1559049646, "post_id": 56342986, "comment_id": 99291416, "body": "Nope problem do not come from float comparison.Edit answer to explain what he did wrong in it, not to provide alternate."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10111321"}, "edited": false, "score": 0, "creation_date": 1559049725, "post_id": 56342986, "comment_id": 99291461, "body": "I don&#39;t think this is the case, as <code>store.remove(currency: &#39;SEK&#39;)</code> produces the same inconsistency. Therefore, I think my logic is somehow flawed beyond a single parameter."}], "tags": [], "owner": {"reputation": 1454, "user_id": 1477940, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f10a7263b299645bfbdcf747c0179297?s=128&d=identicon&r=PG", "display_name": "DonPaulie", "link": "https://stackoverflow.com/users/1477940/donpaulie"}, "is_accepted": false, "score": 0, "last_activity_date": 1559048818, "creation_date": 1559048818, "answer_id": 56342986, "question_id": 56342674, "link": "https://stackoverflow.com/questions/56342674/why-do-some-elements-remain-even-if-the-condition-matches-for-each-one/56342986#56342986", "title": "Why do some elements remain even if the condition matches for each one?", "body": "<p>I think that this problem comes from float comparison. There are many ways to approach this. One of them: </p>\n\n<pre><code>  def remove(product)\n    @database.delete_if do |object|\n      product.any? do |key, value|\n        matches?(object[key], value) || matches?(object[:parameters][key], value)\n      end\n    end\n  end\n\n  def matches?(obj1, obj2)\n    if obj1.is_a?(Float) || obj2.is_a?(Float)\n      (obj1-obj2).abs &lt; 0.001\n    else\n      obj1 == obj2\n    end\n  end\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10111321"}, "edited": false, "score": 0, "creation_date": 1559055656, "post_id": 56343543, "comment_id": 99295032, "body": "You are correct! It looks like I broke the iterator as I removed elements each time I went through the array. Thank you for the proposed solution :)"}], "tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": true, "score": 1, "last_activity_date": 1559053130, "last_edit_date": 1559053130, "creation_date": 1559050713, "answer_id": 56343543, "question_id": 56342674, "link": "https://stackoverflow.com/questions/56342674/why-do-some-elements-remain-even-if-the-condition-matches-for-each-one/56343543#56343543", "title": "Why do some elements remain even if the condition matches for each one?", "body": "<p>Let's focus on following looping,</p>\n\n<pre><code>@database.each do |object|\n  product.each do |key, value|\n    puts '-----------------'\n    @database.delete(object) if object[key] == value\n    @database.delete(object) if object[:parameters][key] == value\n  end\nend\n</code></pre>\n\n<p>It is assumed to run 3 iteration on each loop for <code>@database</code>,</p>\n\n<p><strong>first iteration</strong> - it delete first with identifier = 1 for each loop counter 0</p>\n\n<p><strong>second iteration</strong> - it get modified <code>@database</code> as first get deleted, second become first and 3rd become 2nd and counter of each loop is at 1. So it delete new 2nd element of <code>@database</code> having identifier = 3.</p>\n\n<p><strong>third iteration</strong> - It will have each loop counter at 2 and new updated <code>@database</code> will have only 1 element having identifier = 2 (rescued in 2nd iteration) and there is no third element to proceed iteration further so nothing is iterated.</p>\n\n<p><strong>Correction needed:</strong></p>\n\n<pre><code>def remove(product)\n  @database.reject! do |object|\n    product.map do |k,v|\n      object[k] == v if object.has_key?(k)\n      object[:parameters][k] == v if object[:parameters].has_key?(k)\n    end.inject(&amp;:|)\n  end\nend\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10111321"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 56343543, "answer_count": 2, "score": 3, "last_activity_date": 1559053130, "creation_date": 1559047727, "question_id": 56342674, "link": "https://stackoverflow.com/questions/56342674/why-do-some-elements-remain-even-if-the-condition-matches-for-each-one", "title": "Why do some elements remain even if the condition matches for each one?", "body": "<p>I have created a small store application in Ruby. The concept is simple: I want to be able to add, remove, and view the 'database' in this example. The code seems to work; however, it does not behave like one would expect. I can add any product just fine, but when I try to remove them by a certain criterion that matches each item, only some are removed.</p>\n\n<pre><code>class Store\n  PRODUCT = Struct.new(:identifier, :parameters)\n\n  def initialize(database = [])\n    @database = database\n  end\n\n  def increment\n    # Increment the unique identifier if the database is not empty\n    # Otherwise, set the initial value for the unique identifier\n    @database.any? ? @database.map { |object| object[:identifier] }.max + 1 : 1\n  end\n\n  def add(product)\n    @database.push(identifier: increment, parameters: product)\n  end\n\n  def remove(product)\n    @database.each do |object|\n      product.each do |key, value|\n        @database.delete(object) if object[key] == value\n        @database.delete(object) if object[:parameters][key] == value\n      end\n    end\n  end\n\n  def view\n    puts @database\n    puts \"\\n\"\n  end\nend\n\nstore = Store.new\n\nstore.add(name: 'Fanta', volume: 33, unit: 'centiliter', count: 48, price: 9.95, currency: 'SEK')\nstore.add(name: 'Sprite', volume: 33, unit: 'centiliter', count: 48, price: 9.95, currency: 'SEK')\nstore.add(name: 'Coca-Cola', volume: 33, unit: 'centiliter', count: 48, price: 9.95, currency: 'SEK')\n\nstore.view\n\nstore.remove(price: 9.95)\n\nstore.view\n</code></pre>\n\n<p>This example will add three arbitrary items to the <code>Store</code> instance and list the contents found in the <code>@database</code> array. This array will of course hold the values:</p>\n\n<pre><code>{:identifier=&gt;1, :parameters=&gt;{:name=&gt;\"Fanta\", :volume=&gt;33, :unit=&gt;\"centiliter\", :count=&gt;48, :price=&gt;9.95, :currency=&gt;\"SEK\"}}\n{:identifier=&gt;2, :parameters=&gt;{:name=&gt;\"Sprite\", :volume=&gt;33, :unit=&gt;\"centiliter\", :count=&gt;48, :price=&gt;9.95, :currency=&gt;\"SEK\"}}\n{:identifier=&gt;3, :parameters=&gt;{:name=&gt;\"Coca-Cola\", :volume=&gt;33, :unit=&gt;\"centiliter\", :count=&gt;48, :price=&gt;9.95, :currency=&gt;\"SEK\"}}\n</code></pre>\n\n<p>The code then proceeds to remove any product with a price of 9.95, which should match all the products in the <code>@database</code> array. However, when I list its contents once more, one product remains:</p>\n\n<pre><code>{:identifier=&gt;2, :parameters=&gt;{:name=&gt;\"Sprite\", :volume=&gt;33, :unit=&gt;\"centiliter\", :count=&gt;48, :price=&gt;9.95, :currency=&gt;\"SEK\"}}\n</code></pre>\n\n<p>I cannot find any logic to this. Why does my <code>remove</code> method not remove all the elements if the condition holds true for each comparison?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 0, "creation_date": 1559046770, "post_id": 56342228, "comment_id": 99289685, "body": "Try <code>&lt;%= link_to &#39;Favorite&#39;, khollections_update_path(cproduct: @cproduct) %&gt;</code>"}, {"owner": {"reputation": 786, "user_id": 5081713, "user_type": "registered", "accept_rate": 21, "profile_image": "https://i.stack.imgur.com/hBirq.png?s=128&g=1", "display_name": "Manny Quintanilla", "link": "https://stackoverflow.com/users/5081713/manny-quintanilla"}, "reply_to_user": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 0, "creation_date": 1559047010, "post_id": 56342228, "comment_id": 99289841, "body": "Ok so without the friendly I get the following error: Couldn&#39;t find Cproduct with &#39;id&#39;=test-55baa721-9e9a-42d7-8053-2b425fb5becb  with it i get the following error: SQLite3::SQLException: no such column: khollections.cproduct: SELECT &quot;khollections&quot;.* FROM &quot;khollections&quot; WHERE &quot;khollections&quot;.&quot;cproduct&quot; = ? AND &quot;khollections&quot;.&quot;user_id&quot; = ?  I made your change as well @PavelMikhailyuk"}], "answers": [{"comments": [{"owner": {"reputation": 786, "user_id": 5081713, "user_type": "registered", "accept_rate": 21, "profile_image": "https://i.stack.imgur.com/hBirq.png?s=128&g=1", "display_name": "Manny Quintanilla", "link": "https://stackoverflow.com/users/5081713/manny-quintanilla"}, "edited": false, "score": 0, "creation_date": 1559048104, "post_id": 56342508, "comment_id": 99290485, "body": "Addded model to post see above  ------- I Got this error now:   ---  ActiveRecord::AssociationTypeMismatch in KhollectionsController#update Cproduct(#70351925897280) expected, got &quot;test-prod-2&quot; which is an instance of String(#70351858327000)"}, {"owner": {"reputation": 786, "user_id": 5081713, "user_type": "registered", "accept_rate": 21, "profile_image": "https://i.stack.imgur.com/hBirq.png?s=128&g=1", "display_name": "Manny Quintanilla", "link": "https://stackoverflow.com/users/5081713/manny-quintanilla"}, "edited": false, "score": 0, "creation_date": 1559048541, "post_id": 56342508, "comment_id": 99290750, "body": "Updated post with Schema,rb check above"}, {"owner": {"reputation": 786, "user_id": 5081713, "user_type": "registered", "accept_rate": 21, "profile_image": "https://i.stack.imgur.com/hBirq.png?s=128&g=1", "display_name": "Manny Quintanilla", "link": "https://stackoverflow.com/users/5081713/manny-quintanilla"}, "edited": false, "score": 0, "creation_date": 1559049802, "post_id": 56342508, "comment_id": 99291505, "body": "Current Error ---  ActiveRecord::RecordNotFound in KhollectionsController#update Couldn&#39;t find Cproduct with &#39;id&#39;=another-product"}, {"owner": {"reputation": 1165, "user_id": 6945452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f194d5802eb275d75a6c1af397534a?s=128&d=identicon&r=PG", "display_name": "Kamal Pandey", "link": "https://stackoverflow.com/users/6945452/kamal-pandey"}, "reply_to_user": {"reputation": 786, "user_id": 5081713, "user_type": "registered", "accept_rate": 21, "profile_image": "https://i.stack.imgur.com/hBirq.png?s=128&g=1", "display_name": "Manny Quintanilla", "link": "https://stackoverflow.com/users/5081713/manny-quintanilla"}, "edited": false, "score": 0, "creation_date": 1559050809, "post_id": 56342508, "comment_id": 99292156, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/194051/discussion-between-bhupati-and-manuel-quintanilla\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 1165, "user_id": 6945452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f194d5802eb275d75a6c1af397534a?s=128&d=identicon&r=PG", "display_name": "Kamal Pandey", "link": "https://stackoverflow.com/users/6945452/kamal-pandey"}, "is_accepted": true, "score": 1, "last_activity_date": 1559050750, "last_edit_date": 1559050750, "creation_date": 1559047169, "answer_id": 56342508, "question_id": 56342228, "link": "https://stackoverflow.com/questions/56342228/couldnt-find-product-with-id-test/56342508#56342508", "title": "Couldn&#39;t find Product with &#39;id&#39;=test", "body": "<p>this is where error is</p>\n\n<pre><code>create_table \"khollections\", force: :cascade do |t|\n    t.integer \"Cproduct_id\"\n    t.integer \"user_id\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"Cproduct_id\"], name: \"index_khollections_on_Cproduct_id\"\n    t.index [\"user_id\"], name: \"index_khollections_on_user_id\"\n  end\n</code></pre>\n\n<p>replace with</p>\n\n<pre><code>create_table \"khollections\", force: :cascade do |t|\n    t.integer \"cproduct_id\"\n    t.integer \"user_id\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"cproduct_id\"], name: \"index_khollections_on_cproduct_id\"\n    t.index [\"user_id\"], name: \"index_khollections_on_user_id\"\n  end\n</code></pre>\n\n<p>and</p>\n\n<pre><code>khollection = Khollection.where(cproduct: Cproduct.find_by(title: params[:cproduct]), user: current_user)\n\n\n\nKhollection.create(cproduct: Cproduct.find_by(title: params[:cproduct]), user: current_user)\n\n\n&lt;%= link_to 'Favorite', khollections_update_path(cproduct: @cproduct.title) %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "is_accepted": false, "score": 0, "last_activity_date": 1559047171, "creation_date": 1559047171, "answer_id": 56342509, "question_id": 56342228, "link": "https://stackoverflow.com/questions/56342228/couldnt-find-product-with-id-test/56342509#56342509", "title": "Couldn&#39;t find Product with &#39;id&#39;=test", "body": "<p>Not sure what's going on behind the scenes with the friendly id, but you should be able to query by the product name:</p>\n\n<pre><code>  product = Cproduct.find_by(title: params[:cproduct]).take\n  if product\n    khollection = Khollection.where(cproduct_id: product.id), user: current_user).take\n    if khollection.blank?\n      # Create the khollection\n      Khollection.create(cproduct: product, user: current_user)\n      @khollection_exists = true\n    else\n      # Delete the khollection\n      khollection.destory_all\n      @khollection_exists = false\n    end\n  else\n    # maybe return an error status \"Product not found\"\n  end\n\n  respond_to do |format|\n    format.html {}\n    format.js {}\n  end\n</code></pre>\n\n<p>The point is that you can always fall back on the column names instead of relying on a gem.</p>\n"}], "owner": {"reputation": 786, "user_id": 5081713, "user_type": "registered", "accept_rate": 21, "profile_image": "https://i.stack.imgur.com/hBirq.png?s=128&g=1", "display_name": "Manny Quintanilla", "link": "https://stackoverflow.com/users/5081713/manny-quintanilla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 56342508, "answer_count": 2, "score": 0, "last_activity_date": 1559050750, "creation_date": 1559046308, "last_edit_date": 1559050416, "question_id": 56342228, "link": "https://stackoverflow.com/questions/56342228/couldnt-find-product-with-id-test", "title": "Couldn&#39;t find Product with &#39;id&#39;=test", "body": "<p>Basically working on setting up a favorite product situation but I'm stuck on actually setting it up</p>\n\n<p>This is what I got so far</p>\n\n<p>I think it's because I'm using Friendly URL - I've added friendly.find.. but I still get another error there as well (see second image)</p>\n\n<p><strong>Controller</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>\n  def update\n    khollection = Khollection.where(cproduct: Cproduct.find(params[:cproduct]), user: current_user)\n    if khollection == []\n        # Create the khollection\n        Khollection.create(cproduct: Cproduct.find(params[:cproduct]), user: current_user)\n        @khollection_exists = true\n    else\n        # Delete the khollection\n        khollection.destory_all\n        @khollection_exists = false\n    end\n    respond_to do |format|\n        format.html {}\n        format.js {}\n    end\n  end\n\n\n</code></pre>\n\n<p><strong>View</strong></p>\n\n<pre><code>&lt;%= link_to 'Favorite', khollections_update_path(cproduct: @cproduct.title) %&gt;\n</code></pre>\n\n<p>Below With Friendly .friendly.find(params...</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>  def update\n    khollection = Khollection.where(cproduct: Cproduct.friendly.find(params[:cproduct]), user: current_user)\n    if khollection == []\n        # Create the khollection\n        Khollection.create(cproduct: Cproduct.friendly.find(params[:cproduct]), user: current_user)\n</code></pre>\n\n<p><strong>MODEL</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Khollection &lt; ApplicationRecord\n  belongs_to :cproduct\n  belongs_to :user\nend\n</code></pre>\n\n<p><strong>Schema.rb</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># This file is auto-generated from the current state of the database. Instead\n# of editing this file, please use the migrations feature of Active Record to\n# incrementally modify your database, and then regenerate this schema definition.\n#\n# Note that this schema.rb definition is the authoritative source for your\n# database schema. If you need to create the application database on another\n# system, you should be using db:schema:load, not running all the migrations\n# from scratch. The latter is a flawed and unsustainable approach (the more migrations\n# you'll amass, the slower it'll run and the greater likelihood for issues).\n#\n# It's strongly recommended that you check this file into your version control system.\n\nActiveRecord::Schema.define(version: 2019_05_28_112623) do\n\n  create_table \"active_storage_attachments\", force: :cascade do |t|\n    t.string \"name\", null: false\n    t.string \"record_type\", null: false\n    t.integer \"record_id\", null: false\n    t.integer \"blob_id\", null: false\n    t.datetime \"created_at\", null: false\n    t.index [\"blob_id\"], name: \"index_active_storage_attachments_on_blob_id\"\n    t.index [\"record_type\", \"record_id\", \"name\", \"blob_id\"], name: \"index_active_storage_attachments_uniqueness\", unique: true\n  end\n\n  create_table \"active_storage_blobs\", force: :cascade do |t|\n    t.string \"key\", null: false\n    t.string \"filename\", null: false\n    t.string \"content_type\"\n    t.text \"metadata\"\n    t.bigint \"byte_size\", null: false\n    t.string \"checksum\", null: false\n    t.datetime \"created_at\", null: false\n    t.index [\"key\"], name: \"index_active_storage_blobs_on_key\", unique: true\n  end\n\n  create_table \"cproducts\", force: :cascade do |t|\n    t.string \"title\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.integer \"user_id\"\n    t.string \"slug\"\n    t.index [\"slug\"], name: \"index_cproducts_on_slug\", unique: true\n  end\n\n  create_table \"friendly_id_slugs\", force: :cascade do |t|\n    t.string \"slug\", null: false\n    t.integer \"sluggable_id\", null: false\n    t.string \"sluggable_type\", limit: 50\n    t.string \"scope\"\n    t.datetime \"created_at\"\n    t.index [\"slug\", \"sluggable_type\", \"scope\"], name: \"index_friendly_id_slugs_on_slug_and_sluggable_type_and_scope\", unique: true\n    t.index [\"slug\", \"sluggable_type\"], name: \"index_friendly_id_slugs_on_slug_and_sluggable_type\"\n    t.index [\"sluggable_type\", \"sluggable_id\"], name: \"index_friendly_id_slugs_on_sluggable_type_and_sluggable_id\"\n  end\n\n  create_table \"khollections\", force: :cascade do |t|\n    t.integer \"Cproduct_id\"\n    t.integer \"user_id\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"Cproduct_id\"], name: \"index_khollections_on_Cproduct_id\"\n    t.index [\"user_id\"], name: \"index_khollections_on_user_id\"\n  end\n\n  create_table \"users\", force: :cascade do |t|\n    t.string \"email\"\n    t.string \"encrypted_password\", default: \"\", null: false\n    t.string \"reset_password_token\"\n    t.datetime \"reset_password_sent_at\"\n    t.datetime \"remember_created_at\"\n    t.text \"full_company_logo\"\n    t.text \"domain\"\n    t.string \"business_name\"\n    t.string \"tags\"\n    t.text \"social_media\"\n    t.text \"our_story\"\n    t.text \"location_address\"\n    t.string \"location_city\"\n    t.string \"location_state\"\n    t.integer \"phone\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.boolean \"admin\"\n    t.boolean \"company\"\n    t.boolean \"judge\"\n    t.boolean \"blogger\"\n    t.string \"username\"\n    t.string \"slug\"\n    t.string \"avatar\"\n    t.string \"company_logo\"\n    t.index [\"email\"], name: \"index_users_on_email\", unique: true\n    t.index [\"reset_password_token\"], name: \"index_users_on_reset_password_token\", unique: true\n    t.index [\"slug\"], name: \"index_users_on_slug\", unique: true\n  end\n\n\nend\n\n</code></pre>\n\n<p><strong>CURRENT ERROR</strong>\n<a href=\"https://i.stack.imgur.com/N105S.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/N105S.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 741, "user_id": 7752594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gU6so.png?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/7752594/vishal"}, "edited": false, "score": 1, "creation_date": 1559048009, "post_id": 56342148, "comment_id": 99290429, "body": "You should suggest this edit in the comment but like everyone you also want points that&#39;s why Lol...."}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 1, "last_activity_date": 1559045981, "creation_date": 1559045981, "answer_id": 56342148, "question_id": 56342130, "link": "https://stackoverflow.com/questions/56342130/how-to-solve-undefined-local-variable-or-method-article-for-articlescontrol/56342148#56342148", "title": "How to solve &quot;undefined local variable or method `article&#39; for #&lt;ArticlesController:0x9d00548&gt;&quot; in ruby on rails", "body": "<p>Move from</p>\n\n<pre><code>@article = article.new(params[:article])\n</code></pre>\n\n<p>to </p>\n\n<pre><code>@article = Article.new(params[:article])\n</code></pre>\n\n<p>You need to use the class to create objects. Also, yes, <code>article</code> does not exist</p>\n"}], "owner": {"reputation": 265, "user_id": 11492069, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qQNnSvemiiI/AAAAAAAAAAI/AAAAAAAAAAc/Brtlt29RbiM/photo.jpg?sz=128", "display_name": "CreativeMinds", "link": "https://stackoverflow.com/users/11492069/creativeminds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1559098410, "creation_date": 1559045930, "last_edit_date": 1559098410, "question_id": 56342130, "link": "https://stackoverflow.com/questions/56342130/how-to-solve-undefined-local-variable-or-method-article-for-articlescontrol", "title": "How to solve &quot;undefined local variable or method `article&#39; for #&lt;ArticlesController:0x9d00548&gt;&quot; in ruby on rails", "body": "<p>I'm new in ruby on rails web development. Now I try to create simple form using ruby on rails.</p>\n\n<p>But after submitting the form it shows following error,</p>\n\n<pre><code>NameError in ArticlesController#create\n\nundefined local variable or method `article` for #&lt;ArticlesController:0x9d00548&gt; Did you mean? article_url\n\nRequest\n\nParameters:\n\n{\"utf8\"=&gt;\"\u2713\",\n\"authenticity_token\"=&gt;\"vUOVlqSQTJMHGT11RhZKv4jfcKgEyxnHXCMiHSeaUI7ghsnoZ4vsjZ/QmM2d/MvLLV0YFJ1UIn61RTgJEcgVvA==\",\n\"article\"=&gt;{\"itle\"=&gt;\"Text heading\", \"text\"=&gt;\"Text subject\"},\n\"commit\"=&gt;\"Save Article\"}\n\nResponse\nHeaders:\n\nNone\n</code></pre>\n\n<p>My code part is,</p>\n\n<p><strong>new.html.erb</strong></p>\n\n<pre><code>&lt;h1&gt;New Article&lt;/h1&gt;\n\n&lt;%= form_with scope: :article, url: articles_path, local: true do |form| %&gt;\n    &lt;p&gt;\n        &lt;%= form.label :itle %&gt;&lt;br&gt;\n        &lt;%= form.text_field :itle %&gt;\n    &lt;/p&gt;\n    &lt;p&gt;\n        &lt;%= form.label :text %&gt;&lt;br&gt;\n        &lt;%= form.text_field :text %&gt;\n    &lt;/p&gt;\n\n    &lt;p&gt;\n        &lt;%= form.submit %&gt;\n    &lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>Article Controller</strong></p>\n\n<pre><code>class ArticlesController &lt; ApplicationController\n    def new\n\n    end\n\n    def create\n        @article = article.new(params[:article].inspect)\n\n        @article.save\n        redirect_to @article\n    end\nend\n</code></pre>\n\n<p><strong>route</strong></p>\n\n<pre><code>Rails.application.routes.draw do\n  get 'welcome/index'\n\n  resources :articles\n  # For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html\n  root 'welcome#index'\nend\n</code></pre>\n\n<p>If I print the input value using this below line,</p>\n\n<pre><code>render plain: params[:article].inspect\n</code></pre>\n\n<p>It shows following message,</p>\n\n<pre><code>&lt;ActionController::Parameters {\"title\"=&gt;\"First Article!\", \"text\"=&gt;\"This is my first article.\"} permitted: false&gt;\n</code></pre>\n\n<p>But I use <strong>article.new(params[:article].inspect)</strong> this line is does not work.</p>\n\n<p>I check my code but I have no idea how to fix this issue. </p>\n\n<p>If anyone help me to find what mistake I done my coding</p>\n\n<p>I implement my code by using this page <a href=\"https://guides.rubyonrails.org/getting_started.html\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/getting_started.html</a></p>\n"}, {"tags": ["ruby", "google-chrome", "webdriver", "selenium-chromedriver", "watir"], "comments": [{"owner": {"reputation": 12118, "user_id": 4714829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1b66c22707be26afda19fe995e17ea?s=128&d=identicon&r=PG&f=1", "display_name": "supputuri", "link": "https://stackoverflow.com/users/4714829/supputuri"}, "edited": false, "score": 0, "creation_date": 1559047680, "post_id": 56341660, "comment_id": 99290227, "body": "Have you tried Converting the browser variable to either class, instance or global variable? Instance Variable:  <code>@browser</code>  Class Variable:  <code>@@browser</code>  Global Variable:  <code>$browser</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "is_accepted": true, "score": 1, "last_activity_date": 1559051931, "creation_date": 1559051931, "answer_id": 56343901, "question_id": 56341660, "link": "https://stackoverflow.com/questions/56341660/how-to-put-ruby-watir-code-into-a-defined-method/56343901#56343901", "title": "How to put ruby-watir code into a defined method?", "body": "<p>When you write your code inside the method, it has it's scope, so pass the browser variable, it would</p>\n\n<pre><code>require 'watir'\n\nbrowser = Watir::Browser.new :chrome\n\ndef google browser\n  browser.goto \"google.com\"\nend\n\ngoogle browser\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11567164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8388f09f02c2a032daef0d9869d1348?s=128&d=identicon&r=PG&f=1", "display_name": "GamingForce4D", "link": "https://stackoverflow.com/users/11567164/gamingforce4d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "closed_date": 1559083322, "accepted_answer_id": 56343901, "answer_count": 1, "score": 0, "last_activity_date": 1559051931, "creation_date": 1559044324, "last_edit_date": 1559044879, "question_id": 56341660, "link": "https://stackoverflow.com/questions/56341660/how-to-put-ruby-watir-code-into-a-defined-method", "closed_reason": "Duplicate", "title": "How to put ruby-watir code into a defined method?", "body": "<p>I wanted to write a program with ruby (watir). To keep the code clear and compact I wanted to put code into a method, which is getting called every time the code needs to be run. But calling the method throws an error and I really don't know how to solve this problem.</p>\n\n<p>I tried to define/create the browser under the method (google) but that did not work either. I am a newbie to ruby and I have no idea how to fix this because the error says that the browser is undefined. If I run the code without the method, but browser.goto \"google.com\" instead everything works fine. </p>\n\n<pre><code>require 'watir'\n\nbrowser = Watir::Browser.new :chrome\n\ndef google\n  browser.goto \"google.com\"\nend\n\ngoogle\n</code></pre>\n\n<p>I expect, that chrome is getting opened and the page \"google.com\" is getting navigated to. But instead I'm getting this error: </p>\n\n<blockquote>\n  <p>undefined local variable or method `browser' for main:Object (NameError)</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1559398526, "post_id": 56341587, "comment_id": 99412192, "body": "I&#39;m not sure I understand the actual question, but couldn&#39;t you just add an <code>if (notification.target.parent.present?) {.....text as reply....} else {...your current code...}</code> on the notification view?"}, {"owner": {"reputation": 33, "user_id": 11235085, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_lP6kUwq-5Q/AAAAAAAAAAI/AAAAAAAAB-M/wGzoEmmAo2M/photo.jpg?sz=128", "display_name": "Adegbite kelvin", "link": "https://stackoverflow.com/users/11235085/adegbite-kelvin"}, "reply_to_user": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1559491086, "post_id": 56341587, "comment_id": 99429098, "body": "Ah, that&#39;s great. Never thought of that but is there a way to notify the the owner of the comment that was replied to instead of the owner of the post/article according to the notifications setup on my comment model... Probably with some ifelse statement? Thanks!"}], "owner": {"reputation": 33, "user_id": 11235085, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_lP6kUwq-5Q/AAAAAAAAAAI/AAAAAAAAB-M/wGzoEmmAo2M/photo.jpg?sz=128", "display_name": "Adegbite kelvin", "link": "https://stackoverflow.com/users/11235085/adegbite-kelvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559780217, "creation_date": 1559044097, "last_edit_date": 1559780217, "question_id": 56341587, "link": "https://stackoverflow.com/questions/56341587/how-do-i-create-notifications-for-comment-replies", "title": "How do I create notifications for comment replies?", "body": "<p>I have a type of threaded comment system on my app. I'm using <a href=\"https://github.com/rails-engine/notifications/\" rel=\"nofollow noreferrer\">https://github.com/rails-engine/notifications/</a> to notify whenever a comment is created. How do I create notifications also for the comment replies?</p>\n\n<p>This is what I did for single comment notification</p>\n\n<p>comment.rb</p>\n\n<pre><code>belongs_to :commentable, polymorphic: true\nbelongs_to :user\nbelongs_to :parent, class_name: 'Comment', optional: true\nhas_many :replies, class_name: 'Comment', foreign_key: :parent_id, dependent: :destroy\n\n  validates :content, presence: true, length: { maximum: 255 }\n\n  after_commit :notify_comment_created, on: [:create]\n  def notify_comment_created\n    return if self.commentable.blank?\n    receiver_id = self.commentable&amp;.user_id\n\n    Notification.create(\n      notify_type: \"comment\",\n      target: self,\n      second_target: self.commentable,\n      actor_id: self.user_id,\n      user_id: receiver_id\n    )\n  end\n</code></pre>\n\n<p>notifications/comment.html.erb</p>\n\n<pre><code>&lt;% if notification.second_target.is_a?(Article) %&gt;\n    &lt;div class=''&gt;\n      &lt;p class=\"notifications-p\"&gt;&lt;i class=\"fa fa-comment text-secondary\"&gt;&lt;/i&gt; &lt;b&gt;&lt;%= link_to notification.actor.username, main_app.profile_path(notification.actor.username) %&gt;&lt;/b&gt; commented on your &lt;b&gt;&lt;%= notification.second_target.class.name %&gt;:&lt;/b&gt; &lt;b&gt;&lt;%= link_to notification.second_target.title, main_app.article_path(notification.second_target) %&gt;&lt;/b&gt;&lt;/p&gt;\n    &lt;/div&gt;\n\n    &lt;div class=''&gt;\n      &lt;p class=\"notifications-p\"&gt;&lt;i&gt;&lt;%= truncate(notification.target.content, length: 100) %&gt;&lt;/i&gt;&lt;/p&gt;\n    &lt;/div&gt;\n  &lt;% elsif notification.second_target.is_a?(Announcement) %&gt;\n    &lt;div class=''&gt;\n      &lt;p class=\"notifications-p\"&gt;&lt;i class=\"fa fa-comment text-secondary\"&gt;&lt;/i&gt; &lt;b&gt;&lt;%= link_to notification.actor.username, main_app.profile_path(notification.actor.username) %&gt;&lt;/b&gt; commented on your &lt;b&gt;&lt;%= notification.second_target.class.name %&gt;:&lt;/b&gt; &lt;b&gt;&lt;%= link_to notification.second_target.title, main_app.announcement_path(notification.second_target) %&gt;&lt;/b&gt;&lt;/p&gt;\n    &lt;/div&gt;\n\n    &lt;div class=''&gt;\n      &lt;p class=\"notifications-p\"&gt;&lt;i&gt;&lt;%= truncate(notification.target.content, length: 100) %&gt;&lt;/i&gt;&lt;/p&gt;\n    &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>comment_table in schema</p>\n\n<pre><code>create_table \"comments\", force: :cascade do |t|\n    t.string \"commentable_type\"\n    t.bigint \"commentable_id\"\n    t.bigint \"user_id\"\n    t.text \"content\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.bigint \"parent_id\"\n    t.index [\"commentable_type\", \"commentable_id\"], name: \"index_comments_on_commentable_type_and_commentable_id\"\n    t.index [\"parent_id\"], name: \"index_comments_on_parent_id\"\n    t.index [\"user_id\"], name: \"index_comments_on_user_id\"\nend\n</code></pre>\n\n<p>_comment.html.erb</p>\n\n<pre><code>...\n&lt;li id=\"comment_&lt;%= comment.id %&gt;\" class=\"comment\"&gt;\n   &lt;%= link_to \"Reply\", polymorphic_path([:reply, comment.commentable, comment]), class: 'reply-comment-link', remote: true  %&gt;\n  &lt;% if comment.replies.any? %&gt;\n    &lt;ul&gt;\n      &lt;%= render comment.replies %&gt;\n    &lt;/ul&gt;\n  &lt;% end %&gt;\n&lt;/li&gt;\n</code></pre>\n\n<p>reply.js.erb</p>\n\n<pre><code>&lt;% if @comment.errors.empty? %&gt;\n  $(\"#comment_&lt;%= @comment.id %&gt; &gt; .comment-info .reply-comment-link\").removeAttr(\"href\");\n  $(\"#comment_&lt;%= @comment.id %&gt; &gt; .comment-info\").after(\"&lt;%=j render('comments/form', comment: @reply) %&gt;\");\n...\n&lt;% end %&gt;\n</code></pre>\n\n<p>Currently if a comment is replied, the self.commentable gets the notification of the reply as a new comment. What I want in summary is that I want the comment.user get the notification as reply.</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>I did as suggested below, I added a if (notification.target.parent.present?) {.....text as reply....} else {...your current code...} on the notification view?</p>\n\n<p>Now the thing I need to do next is to changer the reciever_id depending on if notification.target.parent is present on the notification page. If it is, I would love to leave it as it is in my comment model else, I would change the reciever_id to the comment.parent.user... Any way I can do that???</p>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby", "bootstrap-4"], "comments": [{"owner": {"reputation": 9735, "user_id": 625184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d61e61fa593df732de1ccaad37ea4f59?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/625184/jon"}, "edited": false, "score": 0, "creation_date": 1559043608, "post_id": 56341359, "comment_id": 99287886, "body": "Have you restarted your server after installing the gems?"}, {"owner": {"reputation": 19, "user_id": 11560747, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LG3ct9XsR10/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reb8UYMKTrMhNL-zRn3IFGoEiQIZQ/mo/photo.jpg?sz=128", "display_name": "Melissive", "link": "https://stackoverflow.com/users/11560747/melissive"}, "reply_to_user": {"reputation": 9735, "user_id": 625184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d61e61fa593df732de1ccaad37ea4f59?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/625184/jon"}, "edited": false, "score": 0, "creation_date": 1559043659, "post_id": 56341359, "comment_id": 99287917, "body": "Yes, multiple times to no avail."}, {"owner": {"reputation": 741, "user_id": 7752594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gU6so.png?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/7752594/vishal"}, "edited": false, "score": 0, "creation_date": 1559045472, "post_id": 56341359, "comment_id": 99288913, "body": "rename <code>Application.js</code> to <code>application.js</code> same way rename <code>Application.scss</code> to <code>application.scss</code>"}, {"owner": {"reputation": 19, "user_id": 11560747, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LG3ct9XsR10/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reb8UYMKTrMhNL-zRn3IFGoEiQIZQ/mo/photo.jpg?sz=128", "display_name": "Melissive", "link": "https://stackoverflow.com/users/11560747/melissive"}, "edited": false, "score": 0, "creation_date": 1559045788, "post_id": 56341359, "comment_id": 99289107, "body": "Made no difference renaming the files."}, {"owner": {"reputation": 2060, "user_id": 3944700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4df64cd1de5941fb49263a19d80f1482?s=128&d=identicon&r=PG&f=1", "display_name": "hashrocket", "link": "https://stackoverflow.com/users/3944700/hashrocket"}, "edited": false, "score": 0, "creation_date": 1559048581, "post_id": 56341359, "comment_id": 99290775, "body": "Please show your routes file."}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 11560747, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LG3ct9XsR10/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reb8UYMKTrMhNL-zRn3IFGoEiQIZQ/mo/photo.jpg?sz=128", "display_name": "Melissive", "link": "https://stackoverflow.com/users/11560747/melissive"}, "is_accepted": false, "score": 0, "last_activity_date": 1559068591, "creation_date": 1559068591, "answer_id": 56348242, "question_id": 56341359, "link": "https://stackoverflow.com/questions/56341359/routing-error-after-implementing-bootstrap/56348242#56348242", "title": "Routing error after implementing bootstrap", "body": "<p>Found a solution that worked for me (for now atleast).</p>\n\n<p>Aparantly the application.scss had a subfile named application.css under it (using Jetbrains RubyMine).</p>\n\n<p>Deleted the file application.css containing</p>\n\n<pre class=\"lang-css prettyprint-override\"><code>@import Bootstrap\n</code></pre>\n\n<p>And now its atleast loading the page properly with the bootstrap css, although the error messages are showing in the server terminal.</p>\n\n<p>Will try to iron out the error messages and post it here if i find a solution to them.</p>\n"}], "owner": {"reputation": 19, "user_id": 11560747, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LG3ct9XsR10/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reb8UYMKTrMhNL-zRn3IFGoEiQIZQ/mo/photo.jpg?sz=128", "display_name": "Melissive", "link": "https://stackoverflow.com/users/11560747/melissive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 256, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559068591, "creation_date": 1559043369, "last_edit_date": 1559066624, "question_id": 56341359, "link": "https://stackoverflow.com/questions/56341359/routing-error-after-implementing-bootstrap", "title": "Routing error after implementing bootstrap", "body": "<p>Creating a \"Hack this site\" as a fun project, but stumbled upon a routing error after adding the bootstrap gem, along with jquery.</p>\n\n<p>app/assets/stylesheets/Application.scss</p>\n\n<pre><code>@import \"bootstrap\";\n</code></pre>\n\n<p>app/assets/javascripts/Application.js</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>//= require jquery3\n//= require popper\n//= require bootstrap-sprockets\n</code></pre>\n\n<p>Gem file</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>gem 'rails', '~&gt; 5.2.3'\ngem 'devise'\ngem 'bootstrap', '~&gt; 4.3.1'\ngem 'jquery-rails'\n</code></pre>\n\n<p>routes.rb</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Rails.application.routes.draw do\n\n  resources :pages, path: \"\", only: [] do\n    collection do\n      get :stage1\n      get :stage2\n      end\n      end\n  get 'resources/Videos'\n  get 'resources/Photos'\n  get 'layouts/home'\n  root '_layouts#home'\n  get \"/pages/:page\" =&gt; \"pages#show\"\n  resources :posts\n  devise_for :users\n  # For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html\nend\n\n\n</code></pre>\n\n<p>Followed the Bootstrap-rubygem repository installation instructions, and ended up getting the following errors when trying to load the page.</p>\n\n<pre><code>ActionController::RoutingError (No route matches [GET] \"/vendor/bootstrap/js/bootstrap.bundle.min.js\"):\nActionController::RoutingError (No route matches [GET] \"/vendor/jquery/jquery.min.js\"):\n\n</code></pre>\n\n<p>Got no clue as to what i have done wrong (Probably a lot of things), so i'd appreciate any answers that could lead to resolving this issue!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ajax", "forms"], "comments": [{"owner": {"reputation": 1656, "user_id": 6138119, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YzV7y.jpg?s=128&g=1", "display_name": "Pravesh Khatri", "link": "https://stackoverflow.com/users/6138119/pravesh-khatri"}, "edited": false, "score": 0, "creation_date": 1559044246, "post_id": 56341280, "comment_id": 99288252, "body": "You need to use <code>.js.erb</code> and update your button by that file, If you want to use it purely through rails."}], "answers": [{"comments": [{"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1617865421, "post_id": 56341585, "comment_id": 118428392, "body": "This entirely removes the disable-with attribute - it &quot;works&quot; but is likely not what is intended?!!"}], "tags": [], "owner": {"reputation": 1165, "user_id": 6945452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f194d5802eb275d75a6c1af397534a?s=128&d=identicon&r=PG", "display_name": "Kamal Pandey", "link": "https://stackoverflow.com/users/6945452/kamal-pandey"}, "is_accepted": false, "score": -1, "last_activity_date": 1559044087, "creation_date": 1559044087, "answer_id": 56341585, "question_id": 56341280, "link": "https://stackoverflow.com/questions/56341280/how-to-re-enable-submit-button-after-data-disable-with-in-rails/56341585#56341585", "title": "How to re enable submit button after data-disable-with in rails", "body": "<p>Try this</p>\n\n<pre><code>&lt;%= f.submit \"Verify\",'data-disable-with' =&gt; 'Verifying...', id: 'submit-button' %&gt;\n</code></pre>\n\n<p>and in js</p>\n\n<pre><code>$(document).on('ajax:error', 'form-name', function (xhr, jqxhr) { \n    $(\"#submit-button\").removeAttr('data-disable-with');\n });\n</code></pre>\n\n<p>replace the form-name with your form id or class</p>\n"}], "owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 391, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559044087, "creation_date": 1559043147, "question_id": 56341280, "link": "https://stackoverflow.com/questions/56341280/how-to-re-enable-submit-button-after-data-disable-with-in-rails", "title": "How to re enable submit button after data-disable-with in rails", "body": "<p>Using <code>data-disable-with</code> attribute in <code>remote:true</code> form</p>\n\n<pre><code>&lt;%= f.submit \"Verify\",'data-disable-with' =&gt; 'Verifying...' %&gt;\n</code></pre>\n\n<p>After submitting button disabled and text changes to \"<strong>Verifying...</strong>\" but issue is that let say in case of error, errors show in form and submit button renable but the text not change . It stills remain \"Verifying\"</p>\n\n<p>How can I show previous text in case of error?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1559044097, "post_id": 56340998, "comment_id": 99288147, "body": "How do you call the <code>amount_for</code> method, i.e. what are the arguments that lead to the unexpected result / error?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11447168, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hj7SsKpNaFk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXamJsSuj9xMq4fvLmKvwjS1koDQ/mo/photo.jpg?sz=128", "display_name": "fxtest qwerty", "link": "https://stackoverflow.com/users/11447168/fxtest-qwerty"}, "edited": false, "score": 0, "creation_date": 1559563717, "post_id": 56341345, "comment_id": 99448650, "body": "can you give me some hint how to fix it please?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 11, "user_id": 11447168, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hj7SsKpNaFk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXamJsSuj9xMq4fvLmKvwjS1koDQ/mo/photo.jpg?sz=128", "display_name": "fxtest qwerty", "link": "https://stackoverflow.com/users/11447168/fxtest-qwerty"}, "edited": false, "score": 0, "creation_date": 1559564083, "post_id": 56341345, "comment_id": 99448827, "body": "The last line <i>was</i> a hint. You need to change <code>if payment_type.is_a?(Hash)</code> to <code>if AMOUNT[payment_type].is_a?(Hash)</code>."}, {"owner": {"reputation": 11, "user_id": 11447168, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hj7SsKpNaFk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXamJsSuj9xMq4fvLmKvwjS1koDQ/mo/photo.jpg?sz=128", "display_name": "fxtest qwerty", "link": "https://stackoverflow.com/users/11447168/fxtest-qwerty"}, "edited": false, "score": 0, "creation_date": 1559564551, "post_id": 56341345, "comment_id": 99449034, "body": "Strange, I still get value <code>{&quot;NL&quot;=&amp;gt;100}</code>"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 11, "user_id": 11447168, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hj7SsKpNaFk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXamJsSuj9xMq4fvLmKvwjS1koDQ/mo/photo.jpg?sz=128", "display_name": "fxtest qwerty", "link": "https://stackoverflow.com/users/11447168/fxtest-qwerty"}, "edited": false, "score": 0, "creation_date": 1559564983, "post_id": 56341345, "comment_id": 99449289, "body": "Oops, I overlooked something. I should have said <code>AMOUNT[currency][payment_type]</code>, but that would have been wrong, for various reasons involving exceptional circumstances. I&#39;ll rewrite the answer."}, {"owner": {"reputation": 11, "user_id": 11447168, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hj7SsKpNaFk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXamJsSuj9xMq4fvLmKvwjS1koDQ/mo/photo.jpg?sz=128", "display_name": "fxtest qwerty", "link": "https://stackoverflow.com/users/11447168/fxtest-qwerty"}, "edited": false, "score": 0, "creation_date": 1559567796, "post_id": 56341345, "comment_id": 99450804, "body": "Hm... I get always 1 for amount in every case."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 1, "last_activity_date": 1559565990, "last_edit_date": 1559565990, "creation_date": 1559043338, "answer_id": 56341345, "question_id": 56340998, "link": "https://stackoverflow.com/questions/56340998/get-values-from-nested-hash/56341345#56341345", "title": "Get values from nested hash", "body": "<p><code>payment_type</code> will be e.g. <code>\"AT\"</code> - it's the argument you pass into your function, it will never be a Hash.</p>\n\n<p>This rewrite should do what you want:</p>\n\n<pre><code>def amount_for(payment_type, country = nil, currency = nil)\n  path = [payment_type, country, currency].compact\n  obj = AMOUNT\n  obj = obj[path.shift] while Hash === obj &amp;&amp; !path.empty?\n  return obj || 1\nend\n</code></pre>\n\n<p>Alternately, this is rather similar to the code you wrote:</p>\n\n<pre><code>def amount_for(payment_type, country = nil, currency = nil)\n  tmp = AMOUNT.dig(payment_type, country, currency)\n  return tmp if tmp\n  tmp = AMOUNT.dig(payment_type, country)\n  return tmp if tmp\n  tmp = AMOUNT.dig(payment_type)\n  return tmp if tmp\n  return 1\nend\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11447168, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hj7SsKpNaFk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXamJsSuj9xMq4fvLmKvwjS1koDQ/mo/photo.jpg?sz=128", "display_name": "fxtest qwerty", "link": "https://stackoverflow.com/users/11447168/fxtest-qwerty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559565990, "creation_date": 1559042213, "last_edit_date": 1559081312, "question_id": 56340998, "link": "https://stackoverflow.com/questions/56340998/get-values-from-nested-hash", "title": "Get values from nested hash", "body": "<p>I have this Hash that I use store values and if the values are not found to get default values:</p>\n\n<pre><code>AMOUNT = {\n  EUR: {\n    eps:         { AT: 1_00 },\n    safetypay:   { PE: 15_000_00, CR: 5_000_00, BE: 15_000_00, },\n    przelewy24:  5_00,\n    qiwi:        5_00,\n    bcmc:        { AT: 1_00, BE: 1_00 },\n    giropay:     { DE: 1_00 },\n    ideal:       { NL: 1_00 },\n    mybank:      { IT: 1_00, FR: 1_00 },\n  },\n  CZK: {\n    trustpay:   { CZ: 20_00 }\n  }\n}.with_indifferent_access\n</code></pre>\n\n<p>I would like to get values based on the keys so I tried this:</p>\n\n<pre><code>def amount_for(payment_type, country, currency)\n  payment_amount = AMOUNT.dig(currency, payment_type, country) if payment_type.is_a?(Hash)\n  payment_amount ||= AMOUNT.dig(currency, payment_type)\n  payment_amount ||= 1\nend\n</code></pre>\n\n<p>But I get for result not number but <code>{\"AT\"=&amp;gt;100, \"BE\"=&amp;gt;100}</code>. If I remove the check <code>if payment_type.is_a?(Hash)</code> I get exception <code>Integer does not have #dig method (RuntimeError)</code></p>\n\n<p>Do you know how I can solve this issue?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 955, "user_id": 33651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66aa88df6689fcb6ecf120ed32a3c81e?s=128&d=identicon&r=PG", "display_name": "rud", "link": "https://stackoverflow.com/users/33651/rud"}, "edited": false, "score": 1, "creation_date": 1559043698, "post_id": 56340959, "comment_id": 99287932, "body": "You probably need to pick a geocoding service you want to use - the Geocoder gem has to ask an external service to perform the actual geocoding."}, {"owner": {"reputation": 271, "user_id": 1796645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/796928329d7523c00f478ac7e167012d?s=128&d=identicon&r=PG", "display_name": "kluka", "link": "https://stackoverflow.com/users/1796645/kluka"}, "reply_to_user": {"reputation": 955, "user_id": 33651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66aa88df6689fcb6ecf120ed32a3c81e?s=128&d=identicon&r=PG", "display_name": "rud", "link": "https://stackoverflow.com/users/33651/rud"}, "edited": false, "score": 0, "creation_date": 1559076789, "post_id": 56340959, "comment_id": 99304723, "body": "@rud And by default it uses <code>nominatim</code> which is free for one request per second <a href=\"https://github.com/alexreisner/geocoder/blob/master/README_API_GUIDE.md#nominatim-nominatim\" rel=\"nofollow noreferrer\">github.com/alexreisner/geocoder/blob/master/&hellip;</a>"}, {"owner": {"reputation": 271, "user_id": 1796645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/796928329d7523c00f478ac7e167012d?s=128&d=identicon&r=PG", "display_name": "kluka", "link": "https://stackoverflow.com/users/1796645/kluka"}, "edited": false, "score": 0, "creation_date": 1559077250, "post_id": 56340959, "comment_id": 99304928, "body": "@jonny Your setup seems correct, have you attempted debugging? For example what is the result when you execute <code>Geocoder.search(&quot;The tested address&quot;)</code> in the console; or what happens when you remove the <code>if</code> modifier in the after_validation callback?"}, {"owner": {"reputation": 31, "user_id": 4445294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd40a2b0108e5e0036cd40e32dcf2786?s=128&d=identicon&r=PG&f=1", "display_name": "Jonny", "link": "https://stackoverflow.com/users/4445294/jonny"}, "reply_to_user": {"reputation": 271, "user_id": 1796645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/796928329d7523c00f478ac7e167012d?s=128&d=identicon&r=PG", "display_name": "kluka", "link": "https://stackoverflow.com/users/1796645/kluka"}, "edited": false, "score": 0, "creation_date": 1559099282, "post_id": 56340959, "comment_id": 99309717, "body": "@kluka Thanks for those suggestions.  Here&#39;s what I got initially when I execute that command: &quot;Geocoding API not responding fast enough (use Geocoder.configure(:timeout =&gt; ...) to set limit).&quot;  After this, I set the timeout to 3 in the geodocer initializer.   I then tried again and was able to get some results. However, after trying a couple of different searches, I then got the following: OpenSSL::SSL::SSLError: SSL_connect returned=1 errno=0 state=error: certificate verify failed from /Users/jonny35/.rbenv/versions/2.4.4/lib/ruby/2.4.0/net/prot&zwnj;&#8203;ocol.rb:44:in `connect_nonblock&#39;"}, {"owner": {"reputation": 271, "user_id": 1796645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/796928329d7523c00f478ac7e167012d?s=128&d=identicon&r=PG", "display_name": "kluka", "link": "https://stackoverflow.com/users/1796645/kluka"}, "edited": false, "score": 1, "creation_date": 1559111716, "post_id": 56340959, "comment_id": 99313009, "body": "Well that means you have to fix your network setup, it is not an issue with the gecoder gem specifically. You should be able to search on Google with that error message :)"}, {"owner": {"reputation": 31, "user_id": 4445294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd40a2b0108e5e0036cd40e32dcf2786?s=128&d=identicon&r=PG&f=1", "display_name": "Jonny", "link": "https://stackoverflow.com/users/4445294/jonny"}, "reply_to_user": {"reputation": 271, "user_id": 1796645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/796928329d7523c00f478ac7e167012d?s=128&d=identicon&r=PG", "display_name": "kluka", "link": "https://stackoverflow.com/users/1796645/kluka"}, "edited": false, "score": 1, "creation_date": 1559118023, "post_id": 56340959, "comment_id": 99316192, "body": "@kluka - Thanks, I think my internet was down when I was attempting your solution, so it was appearing not to work, but in fact, your solution was correct in identifying the issue, which was that neither of the addresses I was attempting to use in my seeds was being picked up with the openstreetmap/nominatim API.  When I tried Geocoder.search(&quot;new york&quot;), it was working. After playing around with the address formats I managed to get it to work. Thanks for your help."}], "owner": {"reputation": 31, "user_id": 4445294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd40a2b0108e5e0036cd40e32dcf2786?s=128&d=identicon&r=PG&f=1", "display_name": "Jonny", "link": "https://stackoverflow.com/users/4445294/jonny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 274, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1559042069, "creation_date": 1559042069, "question_id": 56340959, "link": "https://stackoverflow.com/questions/56340959/geocoder-will-not-return-coordinates-for-class-instance", "title": "Geocoder will not return coordinates for class instance", "body": "<p>I'm trying to use the geocoder gem to apply latitude and longitude coordinates to to my CoffeeShops model, but I can't get the geocoder to return the coordinates.</p>\n\n<p>When I attempt to save a new instance of the class with an address, it saves successfully to the database, but the geocoding information for both longitude and latitude is 'nil'.</p>\n\n<p>I've tried bundle installing.\nI've tried adding a timeout in geocoder.rb initializer\nI've tried adding and removing address validation (presence: true) in the model</p>\n\n<h1>My coffee shop model:</h1>\n\n<pre><code>class CoffeeShop &lt; ApplicationRecord\n  belongs_to :user\n  has_many :reviews\n  has_one :feature_set\n  has_one :wifi_speed, through: :feature_sets\n\n  validates :name, :address, presence: true\n  geocoded_by :address\n  after_validation :geocode, if: :will_save_change_to_address?\nend\n</code></pre>\n\n<h1>My address migration file:</h1>\n\n<pre><code>class AddAddressToCoffeeShops &lt; ActiveRecord::Migration[5.2]\n  def change\n    add_column :coffee_shops, :address, :string\n  end\nend\n</code></pre>\n\n<h1>My coordinates migration file:</h1>\n\n<pre><code>class AddCoordiantesToCoffeeShops &lt; ActiveRecord::Migration[5.2]\n  def change\n    add_column :coffee_shops, :latitude, :float\n    add_column :coffee_shops, :longitude, :float\n  end\nend\n</code></pre>\n\n<h1>My coffee shop schema:</h1>\n\n<pre><code>create_table \"coffee_shops\", force: :cascade do |t|\n    t.string \"name\"\n    t.string \"description\"\n    t.integer \"rating\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.bigint \"user_id\"\n    t.float \"latitude\"\n    t.float \"longitude\"\n    t.string \"address\"\n    t.index [\"user_id\"], name: \"index_coffee_shops_on_user_id\"\n  end\n</code></pre>\n\n<h1>My geocoder initializer</h1>\n\n<pre><code>Geocoder.configure(\n  # Geocoding options\n  # timeout: 3,                 # geocoding service timeout (secs)\n  # lookup: :nominatim,         # name of geocoding service (symbol)\n  # ip_lookup: :ipinfo_io,      # name of IP address geocoding service (symbol)\n  # language: :en,              # ISO-639 language code\n  # use_https: false,           # use HTTPS for lookup requests? (if supported)\n  # http_proxy: nil,            # HTTP proxy server (user:pass@host:port)\n  # https_proxy: nil,           # HTTPS proxy server (user:pass@host:port)\n  # api_key: nil,               # API key for geocoding service\n  # cache: nil,                 # cache object (must respond to #[], #[]=, and #del)\n  # cache_prefix: 'geocoder:',  # prefix (string) to use for all cache keys\n\n  # Exceptions that should not be rescued by default\n  # (if you want to implement custom error handling);\n  # supports SocketError and Timeout::Error\n  # always_raise: [],\n\n  # Calculation options\n  units: :km,                 # :km for kilometers or :mi for miles\n  # distances: :linear          # :spherical or :linear\n)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "api", "ruby-on-rails-5", "postman"], "comments": [{"owner": {"reputation": 181, "user_id": 6507275, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3a3d4c07b9fcb38f037c3da4c1e46cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen M", "link": "https://stackoverflow.com/users/6507275/stephen-m"}, "edited": false, "score": 0, "creation_date": 1559041437, "post_id": 56340362, "comment_id": 99286755, "body": "Remove the index from set_product filter."}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 5736112, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4a4992e47e824469a2096ccc288f0b2a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxRah", "link": "https://stackoverflow.com/users/5736112/maxrah"}, "edited": false, "score": 0, "creation_date": 1559042203, "post_id": 56340879, "comment_id": 99287153, "body": "Goddammit, couldn&#39;t see it. Thank you!"}], "tags": [], "owner": {"reputation": 1165, "user_id": 6945452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f194d5802eb275d75a6c1af397534a?s=128&d=identicon&r=PG", "display_name": "Kamal Pandey", "link": "https://stackoverflow.com/users/6945452/kamal-pandey"}, "is_accepted": true, "score": 1, "last_activity_date": 1559042183, "last_edit_date": 1559042183, "creation_date": 1559041755, "answer_id": 56340879, "question_id": 56340362, "link": "https://stackoverflow.com/questions/56340362/rails-5-filter-chain-halted-as-set-product-rendered-or-redirected-error-when-in/56340879#56340879", "title": "Rails 5 Filter chain halted as :set_product rendered or redirected error when indexing all products", "body": "<p>convert</p>\n\n<pre><code>module Api\n  module V1\n    class ProductsController &lt; Api::V1::ApiController\n      # do not authenticate users before viewing product listing or individual products\n      before_action :authenticate_user!, except: %i[index show]\n      before_action :set_product, only: %i[index show]\n\n      # GET /product\n      def index\n        product = Product.all.order('id')\n        render json: { success: true, data: product }, status: :ok\n      end\n\n      # GET /products/:id\n      def show\n        @product = Product.find(params[:id])\n        render json: { success: true, data: @products }, status: :ok\n      end\n\n      private\n\n      def set_product\n        @products = Product.find(params[:id])\n        rescue StandardError =&gt; error\n        render json: { success: false, error: error }, status: 404\n      end\n\n      def product_params\n        params.require(:product).permit(:title, :release_date, :release_time, :description, :price, :brand)\n      end\n\n    end\n  end\nend\n</code></pre>\n\n<p>to</p>\n\n<pre><code>module Api\n  module V1\n    class ProductsController &lt; Api::V1::ApiController\n      # do not authenticate users before viewing product listing or individual products\n      before_action :authenticate_user!, except: %i[index show]\n      before_action :set_product, only: %i[show]\n\n      # GET /product\n      def index\n        @products = Product.all.order('id')\n        render json: { success: true, data: @products }, status: :ok\n      end\n\n      # GET /products/:id\n      def show\n        if @product.present?\n          render json: { success: true, data: @product }, status: :ok\n        else\n           render json: { success: false }, status: :not_found\n        end\n\n      end\n\n      private\n\n      def set_product\n        @product = Product.find(params[:id])\n      end\n\n      def product_params\n        params.require(:product).permit(:title, :release_date, :release_time, :description, :price, :brand)\n      end\n\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 5736112, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4a4992e47e824469a2096ccc288f0b2a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxRah", "link": "https://stackoverflow.com/users/5736112/maxrah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1496, "favorite_count": 0, "accepted_answer_id": 56340879, "answer_count": 1, "score": 0, "last_activity_date": 1559042183, "creation_date": 1559039892, "question_id": 56340362, "link": "https://stackoverflow.com/questions/56340362/rails-5-filter-chain-halted-as-set-product-rendered-or-redirected-error-when-in", "title": "Rails 5 Filter chain halted as :set_product rendered or redirected error when indexing all products", "body": "<p>I'm running a Rails api-only app with a product model. I've created products on the backend with activeadmin. When using postman to view individual products with a corresponding product ID, it returns the json data fine but when I try to view all product at: <em>api/v1/products</em> </p>\n\n<p>I get this error:</p>\n\n<blockquote>\n  <p>Started GET \"/api/v1/products/\" for ::1 at 2019-05-28 11:12:47 +0100\n  Processing by Api::V1::ProductsController#index as JSON\n    Parameters: {\"product\"=>{}}\n  Filter chain halted as :set_product rendered or redirected\n  Completed 404 Not Found in 5ms (Views: 0.2ms | ActiveRecord: 4.9ms)</p>\n</blockquote>\n\n<p>Here's my controller:</p>\n\n<pre><code>module Api\n  module V1\n    class ProductsController &lt; Api::V1::ApiController\n      # do not authenticate users before viewing product listing or individual products\n      before_action :authenticate_user!, except: %i[index show]\n      before_action :set_product, only: %i[index show]\n\n      # GET /product\n      def index\n        product = Product.all.order('id')\n        render json: { success: true, data: product }, status: :ok\n      end\n\n      # GET /products/:id\n      def show\n        @product = Product.find(params[:id])\n        render json: { success: true, data: @products }, status: :ok\n      end\n\n      private\n\n      def set_product\n        @products = Product.find(params[:id])\n        rescue StandardError =&gt; error\n        render json: { success: false, error: error }, status: 404\n      end\n\n      def product_params\n        params.require(:product).permit(:title, :release_date, :release_time, :description, :price, :brand)\n      end\n\n    end\n  end\nend\n</code></pre>\n\n<p>Here are my api views:</p>\n\n<blockquote>\n  <p>_product.json.jbuilder</p>\n</blockquote>\n\n<pre><code>json.id               product.id\njson.title            product.title\njson.description      product.description\njson.release_date     product.release_date\njson.release_time     product.release_time\njson.price            product.price\njson.brand            product.brand\n</code></pre>\n\n<blockquote>\n  <p>index.json.jbuilder</p>\n</blockquote>\n\n<pre><code>json.array! @products, partial: 'products/product', as: :product\n\n</code></pre>\n\n<blockquote>\n  <p>show.json.jbuilder</p>\n</blockquote>\n\n<pre><code>json.product do\n  json.partial! 'product' \nend\n</code></pre>\n\n<blockquote>\n  <p>routes</p>\n</blockquote>\n\n<pre><code>namespace :api do\n    namespace :v1, defaults: { format: :json } do\n      devise_scope :user do\n        get :status, to: 'api#status'\n        resource :user, only: %i[update show] do\n          get :profile\n        end\n      end\n      resources :products, only: [:index, :show]\n    end\n\n  end\n</code></pre>\n"}, {"tags": ["ruby", "metaprogramming"], "comments": [{"owner": {"reputation": 605, "user_id": 4871714, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh6.googleusercontent.com/-6_VFwLrDyhw/AAAAAAAAAAI/AAAAAAAAAKQ/_HEv6gicIMo/photo.jpg?sz=128", "display_name": "RedPointyJackson", "link": "https://stackoverflow.com/users/4871714/redpointyjackson"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1559040202, "post_id": 56340102, "comment_id": 99286072, "body": "@Stefan The <code>@arg</code> of the class in which I&#39;m calling <code>filter</code>. How could I tweak the implementation then so the <code>@arg</code> in the block gets evaluated in the scope of the instantiated class?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1559041650, "post_id": 56340102, "comment_id": 99286854, "body": "@Stefan: <code>filter</code> <i>is</i> an instance method. <code>filters</code>, which sets up <code>filter</code>, is a class method. However, <code>filters</code> captures a block in a class context and passes it on to <code>filter</code>; OP wishes to have the block executed in the instance context. (Not saying it&#39;s possible or impossible just yet, my brain hurts.)"}, {"owner": {"reputation": 605, "user_id": 4871714, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh6.googleusercontent.com/-6_VFwLrDyhw/AAAAAAAAAAI/AAAAAAAAAKQ/_HEv6gicIMo/photo.jpg?sz=128", "display_name": "RedPointyJackson", "link": "https://stackoverflow.com/users/4871714/redpointyjackson"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1559042131, "post_id": 56340102, "comment_id": 99287116, "body": "@Amadan Stefan nailed it in the last comment, that&#39;s my problem exactly. I need a class method for <code>filters</code> so I can create the DSL in the post (which is part of a bigger project), or at least I think I do. The end objective here is to tweak the implementation so the test passes for the example filter <code>Foo</code> that I have created."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1559043861, "post_id": 56340102, "comment_id": 99288018, "body": "@Amadan oh I see, I thought <code>filter</code> and <code>filters</code> were the same. I missed the <code>define_method</code> call."}], "answers": [{"comments": [{"owner": {"reputation": 605, "user_id": 4871714, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh6.googleusercontent.com/-6_VFwLrDyhw/AAAAAAAAAAI/AAAAAAAAAKQ/_HEv6gicIMo/photo.jpg?sz=128", "display_name": "RedPointyJackson", "link": "https://stackoverflow.com/users/4871714/redpointyjackson"}, "edited": false, "score": 0, "creation_date": 1559043968, "post_id": 56340980, "comment_id": 99288070, "body": "You are right about the accessors, I&#39;ll do that. Thanks!"}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 2, "last_activity_date": 1559042769, "last_edit_date": 1559042769, "creation_date": 1559042143, "answer_id": 56340980, "question_id": 56340102, "link": "https://stackoverflow.com/questions/56340102/instance-variable-in-block-when-using-define-method/56340980#56340980", "title": "instance variable in block when using define_method", "body": "<p><code>instance_exec</code> to rescue!</p>\n\n<pre><code>class Filter\n  def initialize\n    @arg = 'foo'\n  end\n\n  def self.filters &amp;block\n    define_method :filter do |els|\n      els.select { |e| self.instance_exec(e, &amp;block) }\n    end\n  end\nend\n\nclass Foo &lt; Filter\n  filters {|el| el == @arg }\nend\n\nFoo.new.filter(%w[notthearg  either  foo  other])\n# =&gt; [\"foo\"]\n</code></pre>\n\n<p>Caution: Make sure this is <em>very</em> well documented, since any shenanigans involving <code>instance_exec</code> or its cousins are breaking programmer expectations left and right - by design, you're destroying the concept of \"scope\". I'm pretty sure OP knows this, but it is worth putting down on the proverbial paper.</p>\n\n<p>Also, consider using accessors rather than plain instance variables - accessors are checked, and variables are not. i.e. <code>{ |el| el == urg }</code> will result in an error, but <code>{ |el| el == @urg }</code> will silently fail (and filter for <code>nil</code>).</p>\n"}], "owner": {"reputation": 605, "user_id": 4871714, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh6.googleusercontent.com/-6_VFwLrDyhw/AAAAAAAAAAI/AAAAAAAAAKQ/_HEv6gicIMo/photo.jpg?sz=128", "display_name": "RedPointyJackson", "link": "https://stackoverflow.com/users/4871714/redpointyjackson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 56340980, "answer_count": 1, "score": 1, "last_activity_date": 1559042769, "creation_date": 1559039049, "question_id": 56340102, "link": "https://stackoverflow.com/questions/56340102/instance-variable-in-block-when-using-define-method", "title": "instance variable in block when using define_method", "body": "<p>I'm trying to do a DSL, in which the user can pass a block and expect an instance variable <code>@arg</code> to be defined. This is a full example with a unit test failing:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># Implementation\nclass Filter\n  def initialize\n    @arg = 'foo'\n  end\n\n  def self.filters &amp;block\n    define_method :filter do |els|\n      els.select &amp;block\n    end\n  end\nend\n\n# Usage\nclass Foo &lt; Filter\n  filters {|el| el == @arg}\nend\n\n# Expected behavior\ndescribe 'filters created with the DSL' do\n  subject { Foo.new }\n  it 'can use @arg in the filters block' do\n    els = %w[notthearg  either  foo  other]\n    expect(subject.filter els).to be_eql(['foo'])\n  end\nend\n</code></pre>\n\n<p>Using <code>pry</code> or putting <code>puts</code> statements inside the block, I can see that <code>@arg</code> is nil. But <code>Foo.new.instance_variable_get :@arg</code> correctly outputs <code>foo</code>, so it must be related to some scoping rules.</p>\n\n<p>What do I need to change in the implementation to make the test pass and the DSL to work?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1560358698, "post_id": 56339548, "comment_id": 99713441, "body": "If you found any of the answers helpful, please consider <a href=\"https://stackoverflow.com/help/someone-answers\">selecting</a> the one you found most helpful."}], "answers": [{"tags": [], "owner": {"reputation": 443, "user_id": 3678149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YVIsD.jpg?s=128&g=1", "display_name": "kishore cheruku", "link": "https://stackoverflow.com/users/3678149/kishore-cheruku"}, "is_accepted": false, "score": 2, "last_activity_date": 1559038073, "last_edit_date": 1559038073, "creation_date": 1559037600, "answer_id": 56339649, "question_id": 56339548, "link": "https://stackoverflow.com/questions/56339548/convert-an-array-of-hash-with-symbols/56339649#56339649", "title": "Convert an array of hash with symbols", "body": "<p>Use below code. Then you will get expected output</p>\n\n<pre><code>array.map! {|my_hash| my_hash.inject({}){|memo,(k,v)| memo[k.to_sym] = v; memo}}\n</code></pre>\n\n<p><strong>Or</strong> simply you can use <code>array.map(&amp;:symbolize_keys)</code>. This code will be work on rails environment</p>\n"}, {"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 4, "last_activity_date": 1559037630, "creation_date": 1559037630, "answer_id": 56339659, "question_id": 56339548, "link": "https://stackoverflow.com/questions/56339548/convert-an-array-of-hash-with-symbols/56339659#56339659", "title": "Convert an array of hash with symbols", "body": "<p>You tagged <code>rails</code> so you can use <a href=\"https://api.rubyonrails.org/classes/Hash.html#method-i-symbolize_keys\" rel=\"nofollow noreferrer\"><code>symbolize_keys</code></a></p>\n\n<pre><code>array.map(&amp;:symbolize_keys)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 4178312, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/1106675516/picture?type=large", "display_name": "Ido Traini", "link": "https://stackoverflow.com/users/4178312/ido-traini"}, "edited": false, "score": 0, "creation_date": 1559039273, "post_id": 56339668, "comment_id": 99285538, "body": "Thanks. And if i want to convert in an array of &#39;openstructed&#39; objects, how to do?  i&#39;ve tried with openstructed_array=array.map { |c| OpenStruct.new(c) }, and there is a conversion, but if i try openstructed_array.first.object it give me error"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 71, "user_id": 4178312, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/1106675516/picture?type=large", "display_name": "Ido Traini", "link": "https://stackoverflow.com/users/4178312/ido-traini"}, "edited": false, "score": 0, "creation_date": 1559039435, "post_id": 56339668, "comment_id": 99285647, "body": "@IdoTraini you should post a new question including example data and the error you&#39;re getting."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 3, "last_activity_date": 1559039547, "last_edit_date": 1559039547, "creation_date": 1559037657, "answer_id": 56339668, "question_id": 56339548, "link": "https://stackoverflow.com/questions/56339548/convert-an-array-of-hash-with-symbols/56339668#56339668", "title": "Convert an array of hash with symbols", "body": "<blockquote>\n  <p>i didn't obtained any conversion [\u2026] why?</p>\n</blockquote>\n\n<p><code>to_options</code> does return a new hash with the keys symbolized, but you didn't use that new hash \u2013 <code>each</code> merely traverses the array and at the end returns the array.</p>\n\n<p>If you want to pick up the blocks results as the new array element, you have to use <a href=\"http://ruby-doc.org/core-2.6.3/Array.html#method-i-map\" rel=\"nofollow noreferrer\"><code>map</code></a>:</p>\n\n<pre><code>array.map { |c| c.to_options }    # or array.map(&amp;:to_options)\n</code></pre>\n\n<p>Alternatively there's <a href=\"https://api.rubyonrails.org/classes/Hash.html#method-i-to_options-21\" rel=\"nofollow noreferrer\"><code>to_options!</code></a> (with a <code>!</code>) which would work along with <code>each</code>:</p>\n\n<pre><code>array.each { |c| c.to_options! }  # or array.each(&amp;:to_options!)\n</code></pre>\n\n<p>That's because <code>to_options!</code> modifies the hashes in-place.</p>\n\n<hr>\n\n<p>Note that <code>to_options</code> is an alias for <code>symbolize_keys</code> which might be a little clearer.</p>\n"}, {"tags": [], "owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "is_accepted": false, "score": 7, "last_activity_date": 1559038245, "creation_date": 1559038245, "answer_id": 56339836, "question_id": 56339548, "link": "https://stackoverflow.com/questions/56339548/convert-an-array-of-hash-with-symbols/56339836#56339836", "title": "Convert an array of hash with symbols", "body": "<p>Since ruby 2.5 there's <code>Hash#transform_keys</code>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>array.map{|hash| hash.transform_keys(&amp;:to_sym) }\n</code></pre>\n\n<p>Before that it was available in activesupport (part of rails) along with shortcut <code>symbolize_keys</code></p>\n"}], "owner": {"reputation": 71, "user_id": 4178312, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/1106675516/picture?type=large", "display_name": "Ido Traini", "link": "https://stackoverflow.com/users/4178312/ido-traini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 998, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1559039547, "creation_date": 1559037271, "last_edit_date": 1559038146, "question_id": 56339548, "link": "https://stackoverflow.com/questions/56339548/convert-an-array-of-hash-with-symbols", "title": "Convert an array of hash with symbols", "body": "<p>I have an array of hashes:</p>\n\n<pre><code>[{'object' =&gt; 'ob1', 'quantity' =&gt; '2'}, {'object' =&gt; 'ob2', 'quantity' =&gt; '3'}, .....]\n</code></pre>\n\n<p>I want to convert it to symbolized form:</p>\n\n<pre><code>[{:object =&gt; 'ob1', :quantity =&gt; '2'}, {:object =&gt; 'ob2', :quantity =&gt; '3'}, .....]\n</code></pre>\n\n<p>tried with:</p>\n\n<pre><code>symbolized_array = array.each =&gt; { |c| c.to_options }\n</code></pre>\n\n<p>but i didn't obtained any conversion, the <code>symbolized_array</code> is same as array</p>\n\n<p>why?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 3863250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b511997946773d0ea81542b6e4b70964?s=128&d=identicon&r=PG&f=1", "display_name": "Praveen Agarwal", "link": "https://stackoverflow.com/users/3863250/praveen-agarwal"}, "edited": false, "score": 0, "creation_date": 1559131534, "post_id": 56340443, "comment_id": 99323736, "body": "Thanks for your feedback, I&#39;m taking it up with active-model-otp team, they should lock the rotp gem version to 3.3.0  <a href=\"https://github.com/heapsource/active_model_otp/issues/48#issuecomment-465454039\" rel=\"nofollow noreferrer\">github.com/heapsource/active_model_otp/issues/&hellip;</a>"}], "tags": [], "owner": {"reputation": 7863, "user_id": 6250385, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zl6cg.jpg?s=128&g=1", "display_name": "GProst", "link": "https://stackoverflow.com/users/6250385/gprost"}, "is_accepted": false, "score": 0, "last_activity_date": 1559040191, "creation_date": 1559040191, "answer_id": 56340443, "question_id": 56339260, "link": "https://stackoverflow.com/questions/56339260/otp-code-wrong-number-of-arguments-in-recent-update-of-active-model-otp-gem/56340443#56340443", "title": "otp_code: wrong number of arguments in recent update of active_model_otp gem", "body": "<p>Looks like if you want to use <code>active_model_otp</code> gem you'll have to downgrade <code>rotp</code> as suggested in the <a href=\"https://github.com/heapsource/active_model_otp/issues/480\" rel=\"nofollow noreferrer\">opened issue</a>. Not sure if it breaks anything, probably it won't since it worked previously for you.</p>\n\n<p>Seems like they don't rush to fix it, perhaps you can create a PR with a fix so that maybe they accept it.\nAnother option is to fork their repo, fix it and publish as your own gem to use it instead.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 3863250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b511997946773d0ea81542b6e4b70964?s=128&d=identicon&r=PG&f=1", "display_name": "Praveen Agarwal", "link": "https://stackoverflow.com/users/3863250/praveen-agarwal"}, "is_accepted": false, "score": 0, "last_activity_date": 1559975787, "creation_date": 1559975787, "answer_id": 56504113, "question_id": 56339260, "link": "https://stackoverflow.com/questions/56339260/otp-code-wrong-number-of-arguments-in-recent-update-of-active-model-otp-gem/56504113#56504113", "title": "otp_code: wrong number of arguments in recent update of active_model_otp gem", "body": "<p>I could resolve the above issue by locking the rotp gem to 3.3.1 version.</p>\n\n<p>Steps to Follow:</p>\n\n<p>1) Update gem file with \ngem 'rotp', '~> 3.3.0'</p>\n\n<p>2) Take a backup of Gemfile.lock to Gemfile-backup-xx-xx-xxx.lock</p>\n\n<p>3) run bundle install.</p>\n"}], "owner": {"reputation": 31, "user_id": 3863250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b511997946773d0ea81542b6e4b70964?s=128&d=identicon&r=PG&f=1", "display_name": "Praveen Agarwal", "link": "https://stackoverflow.com/users/3863250/praveen-agarwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1559975787, "creation_date": 1559036405, "question_id": 56339260, "link": "https://stackoverflow.com/questions/56339260/otp-code-wrong-number-of-arguments-in-recent-update-of-active-model-otp-gem", "title": "otp_code: wrong number of arguments in recent update of active_model_otp gem", "body": "<p>I updated my Gemfile and rotp (4.1.0) and active_model_otp(1.2.0) gems got updated. Since then I've start getting error while calling @user.otp_code method associated with User modal \"wrong number of arguments (given 2, expected 1)\"</p>\n\n<pre><code>    /usr/local/lib/ruby/gems/2.3.0/gems/rotp-4.1.0/lib/rotp/totp.rb:17:in `at' \n    /usr/local/lib/ruby/gems/2.3.0/gems/active_model_otp-1.2.0/lib/active_model/one_time_password.rb:77:in `otp_code' \n    /home/app/controllers/api/v1/users_controller.rb:745:in `resetpassword' \n</code></pre>\n\n<p>as far as I dig into it, I found this.\nthe issue is in arguments, it seems the latest rotp gem have updated below method to accept only 1 argument insted of 2 as compared to older version (3.3.1)</p>\n\n<p>since the optional parameter has been removed, the active_model_otp-1.2.0 gem is giving error at line number 77</p>\n\n<p>as per rotp-4.1.0</p>\n\n<pre><code>    def at(time)\n        generate_otp(timecode(time))\n    end\n</code></pre>\n\n<p>as per rotp-3.3.1</p>\n\n<pre><code>    def at(time, padding=true)\n        unless time.class == Time\n            time = Time.at(time.to_i)\n        end   \n        generate_otp(timecode(time), padding)\n    end\n</code></pre>\n\n<p>I tried making changes in the gem as below </p>\n\n<pre><code>    def otp_code(options = {})\n     if otp_counter_based\n        if options[:auto_increment]\n          self.otp_counter += 1\n          save if !new_record?\n        end\n        ROTP::HOTP.new(otp_column, digits: otp_digits).at(self.otp_counter)\n      else\n        if options.is_a? Hash\n          time = options.fetch(:time, Time.now)\n          padding = options.fetch(:padding, true)\n        else\n          time = options\n          padding = true\n        end\n       # ROTP::TOTP.new(otp_column, digits: otp_digits).at(time, padding)\n       # -- Commented Above Line to remove padding arguments from it.\n        ROTP::TOTP.new(otp_column, digits: otp_digits).at(time)\n      end\n    end\n</code></pre>\n\n<p>it worked but not sure what else will break, active-model gem was last updated in 2015, and rotp updated few months back.\nplease suggest suitable method, if I revert back to previous gem version of rotp then what else would break. I'm kind of stuck.</p>\n\n<p>kindly help.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "selenium-webdriver"], "answers": [{"comments": [{"owner": {"reputation": 1331, "user_id": 4189633, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VG5Vp.jpg?s=128&g=1", "display_name": "Vishal G", "link": "https://stackoverflow.com/users/4189633/vishal-g"}, "edited": false, "score": 0, "creation_date": 1559038959, "post_id": 56339252, "comment_id": 99285356, "body": "I am using only selenium webdriver"}], "tags": [], "owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "is_accepted": false, "score": 1, "last_activity_date": 1559036370, "creation_date": 1559036370, "answer_id": 56339252, "question_id": 56338704, "link": "https://stackoverflow.com/questions/56338704/how-to-save-and-load-cookies-using-ruby-selenium-webdriver/56339252#56339252", "title": "How to save and load cookies using Ruby + Selenium WebDriver", "body": "<p>In tests you can use gem <a href=\"https://github.com/nruth/show_me_the_cookies\" rel=\"nofollow noreferrer\">show_me_the_cookies</a> (a wrapper/adapter)</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>cookies = show_me_the_cookies # =&gt; [{:name, :domain, :value, :expires, :path, :secure}]\n# here you can write them as you like\n# and then load and\ncookies.each{|c|\n  create_cookie(c[:name], c[:value], path: c[:path], domain: c[:domain]) # etc.\n}\n</code></pre>\n\n<p>Without gems you can call directly to selenium driver:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>driver = Capybara.current_session.driver # or get your selenium driver other way if not using capybara\ncookies = driver.browser.manage.all_cookies\n# be sure that you've visited a page in your app, selenium cannot create cookies at `about:blank`\ndriver.browser.manage.add_cookie(name: ..., value:...)\n</code></pre>\n"}], "owner": {"reputation": 1331, "user_id": 4189633, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VG5Vp.jpg?s=128&g=1", "display_name": "Vishal G", "link": "https://stackoverflow.com/users/4189633/vishal-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1049, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559038993, "creation_date": 1559034705, "last_edit_date": 1559038993, "question_id": 56338704, "link": "https://stackoverflow.com/questions/56338704/how-to-save-and-load-cookies-using-ruby-selenium-webdriver", "title": "How to save and load cookies using Ruby + Selenium WebDriver", "body": "<p>How can I save all cookies in Ruby's Selenium WebDriver to a txt-file, then load them later? I don't find any answer which does export and import at the same time</p>\n\n<p>In python looks like a very easy way to do that, how to do it in RUBY?</p>\n\n<p><a href=\"https://stackoverflow.com/questions/15058462/how-to-save-and-load-cookies-using-python-selenium-webdriver\">How to save and load cookies using Python + Selenium WebDriver</a>:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import pickle\nimport selenium.webdriver \n\ndriver = selenium.webdriver.Firefox()\ndriver.get(\"http://www.google.com\")\npickle.dump( driver.get_cookies() , open(\"cookies.pkl\",\"wb\"))\n</code></pre>\n\n<p>Edits:\nI am only using Selenium WebDriver (no capybara etc)</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 42085, "user_id": 3444240, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/OjOru.jpg?s=128&g=1", "display_name": "potashin", "link": "https://stackoverflow.com/users/3444240/potashin"}, "edited": false, "score": 2, "creation_date": 1559034353, "post_id": 56338518, "comment_id": 99282753, "body": "what ve attempted so far?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 3, "creation_date": 1559034735, "post_id": 56338518, "comment_id": 99282966, "body": "Can you please explain the requirement a little more? I don&#39;t understand. When are you supposed to add at the end of the array, and when are you supposed to add at the beginninng?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1559036277, "post_id": 56338518, "comment_id": 99283869, "body": "<i>&quot;I was asked for a method [\u2026] could you please help me&quot;</i> \u2013 since you were asked for a solution, I suppose you already have tried something. Show your attempt(s) please, so we know what&#39;s missing and how to assist you."}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1559036749, "post_id": 56339018, "comment_id": 99284143, "body": "Note that the remaining elements have been shuffled. That&#39;s because <code>sort_by</code> isn&#39;t stable. The expected result is probably <code>[6, 3, 2, 1, 4, 5, 5, 5]</code>."}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1559037474, "post_id": 56339018, "comment_id": 99284553, "body": "@Stefan might be, not sure from the Question what the order of the remaining items should be from the question."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1559039684, "post_id": 56339018, "comment_id": 99285781, "body": "Using a <a href=\"http://ruby-doc.org/core-2.6.3/doc/syntax/control_expressions_rdoc.html#label-Ternary+if\" rel=\"nofollow noreferrer\">ternary <i>if</i></a> statement here would shorten the code a lot. I&#39;d also recommend using <a href=\"http://ruby-doc.org/\" rel=\"nofollow noreferrer\">ruby-doc.org</a> as reference source since it&#39;s maintained by the Ruby creators. <a href=\"https://apidock.com/\" rel=\"nofollow noreferrer\">apidock.com</a> is third party."}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1559045200, "post_id": 56339018, "comment_id": 99288770, "body": "Changed the link. I&#39;ve written the code with multiline block and multiline if/else on purpose as the OP seems to be a beginner and this is not about short but readable code."}], "tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": true, "score": 0, "last_activity_date": 1559045485, "last_edit_date": 1559045485, "creation_date": 1559035644, "answer_id": 56339018, "question_id": 56338518, "link": "https://stackoverflow.com/questions/56338518/swap-elements-in-array-without-creating-new-array/56339018#56339018", "title": "Swap elements in array without creating new array", "body": "<p>You can use the <a href=\"https://ruby-doc.org/core-2.6.3/Array.html#method-i-sort_by-21\" rel=\"nofollow noreferrer\"><code>sort_by!</code></a> method of Array.</p>\n\n<p>In ruby there is a naming convention that methods ending with <code>!</code> are either <em>inplace</em> or <em>destructive</em>, that is they modify the receiver.</p>\n\n<p><code>sort_by</code> will return a new array (sorted), <code>sort_by!</code> will sort the array inplace.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>input = [6, 5, 3, 5, 2, 5, 1, 4]\n\noutput = input.sort_by! do |a, b|\n  if a == 5\n    1\n  else\n    -1\n  end\nend\n\np input     #=&gt; [4, 2, 1, 6, 3, 5, 5, 5]\np output    #=&gt; [4, 2, 1, 6, 3, 5, 5, 5]\np input.object_id   #=&gt; 70191237292740\np output.object_id  #=&gt; 70191237292740\np input.object_id == output.object_id #=&gt; true\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1559038296, "post_id": 56339826, "comment_id": 99285023, "body": "Not sure if <code>select</code> satisfies the <i>&quot;without creating new array&quot;</i> restriction."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1559038372, "post_id": 56339826, "comment_id": 99285059, "body": "@Stefan It only creates a temporary array which holds all the fives. My assumption was that the result shouldn&#39;t be a new array."}], "tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 0, "last_activity_date": 1559038953, "last_edit_date": 1559038953, "creation_date": 1559038211, "answer_id": 56339826, "question_id": 56338518, "link": "https://stackoverflow.com/questions/56338518/swap-elements-in-array-without-creating-new-array/56339826#56339826", "title": "Swap elements in array without creating new array", "body": "<p>You could fish the fives out of the array, and concatenate them to the end.</p>\n\n<pre><code>numbs = [5, 3, 5, 2, 5, 1, 4]\nfives = numbs.select { |numb| numb == 5 }\nnumbs.delete(5)\nnumbs.concat(fives)\n\nnumbs #=&gt; [3, 2, 1, 4, 5, 5, 5]\n</code></pre>\n\n<p>This is not the most efficient solution, since both <code>select</code> and <code>delete</code> iterate over the full array. But this is the most readable. More efficient, but less readable would be:</p>\n\n<pre><code>numbs = [5, 3, 5, 2, 5, 1, 4]\n\n# reverse loop to prevent shifting of elements that are not yet iterated\nnumbs.each_index.reverse_each do |index|\n  next unless numbs[index] == 5\n  numbs &lt;&lt; numbs.delete_at(index)\nend\n\nnumbs #=&gt; [3, 2, 1, 4, 5, 5, 5] \n</code></pre>\n\n<p>The above only loops once over the array, removing the value from the array and appending it to the end.</p>\n"}], "owner": {"reputation": 3, "user_id": 11566393, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-m-EZr8C4HwQ/AAAAAAAAAAI/AAAAAAAACA4/Lq1-c_c4Q3A/photo.jpg?sz=128", "display_name": "Mocha", "link": "https://stackoverflow.com/users/11566393/mocha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "closed_date": 1559044235, "accepted_answer_id": 56339018, "answer_count": 2, "score": -2, "last_activity_date": 1559053183, "creation_date": 1559034019, "last_edit_date": 1559034605, "question_id": 56338518, "link": "https://stackoverflow.com/questions/56338518/swap-elements-in-array-without-creating-new-array", "closed_reason": "Needs details or clarity", "title": "Swap elements in array without creating new array", "body": "<p>I was asked for a method to return the arr if element == 5 to be pushed to the end of the array and if its not 5 to be pushed to the beginning of the arr have to do this without creating new array \ncould you please help me solve this one time with iterating .each \nand another without .each \nUsing ruby </p>\n\n<p>Ruby please </p>\n\n<p>end </p>\n\n<p>puts put_num5_last([5,3,5,2,5,1,4])</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "activerecord", "associations", "active-record-query"], "comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1559041074, "post_id": 56337664, "comment_id": 99286558, "body": "Check I have posted answer for rails-3, Please test it."}, {"owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 0, "creation_date": 1559139211, "post_id": 56337664, "comment_id": 99328592, "body": "<code>Property.joins(:photos)</code> <i>should</i> give you access to properties that have photos. But you could also try <code>Property.joins(:photos).having(&#39;COUNT(photos) &gt; 0&#39;).group(&#39;properties.id&#39;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 29623, "user_id": 91970, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64aa7d1e0eb006175565adb0a47a4452?s=128&d=identicon&r=PG", "display_name": "marcamillion", "link": "https://stackoverflow.com/users/91970/marcamillion"}, "edited": false, "score": 1, "creation_date": 1559062334, "post_id": 56338051, "comment_id": 99298665, "body": "Interesting, so I guess you did the opposite, where this query finds those properties with no photos......that&#39;s a clever approach. That&#39;s what you expect the result to be, right?"}, {"owner": {"reputation": 29623, "user_id": 91970, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64aa7d1e0eb006175565adb0a47a4452?s=128&d=identicon&r=PG", "display_name": "marcamillion", "link": "https://stackoverflow.com/users/91970/marcamillion"}, "edited": false, "score": 0, "creation_date": 1559065856, "post_id": 56338051, "comment_id": 99300126, "body": "Is there a Rails-3 version of doing <code>.not.where.(photos: {id: nil})</code>?"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 29623, "user_id": 91970, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64aa7d1e0eb006175565adb0a47a4452?s=128&d=identicon&r=PG", "display_name": "marcamillion", "link": "https://stackoverflow.com/users/91970/marcamillion"}, "edited": false, "score": 0, "creation_date": 1559133505, "post_id": 56338051, "comment_id": 99324960, "body": "@marcamillion yes, great that you get it. I worked once on rails-3 and I used to do it like <code>where(&quot;photos.id IS NOT NULL&quot;)</code>"}, {"owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 0, "creation_date": 1559139150, "post_id": 56338051, "comment_id": 99328551, "body": "Wouldn&#39;t left joins return properties without photos? I thought they wanted only properties <i>with</i> photos"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 0, "creation_date": 1559139261, "post_id": 56338051, "comment_id": 99328616, "body": "@MikeHeft I focused on <i>returns only the Properties that actually have photos</i> sentence"}, {"owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 0, "creation_date": 1559139558, "post_id": 56338051, "comment_id": 99328759, "body": "Exactly, that&#39;s what I&#39;m saying. Left outer joins will return properties with and without photos, whereas regular joins will will only return properties <i>that actually have photos</i>. I think their issue was trying to put an aggregate function in the where query. I commented on the question where they could try using <code>having</code> with group. But they really shouldn&#39;t need all that as <code>Property.joins(:photos)</code> will return Properties <i>that actually have photos</i>"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 0, "creation_date": 1559140306, "post_id": 56338051, "comment_id": 99329211, "body": "@MikeHeft hehe, I think you missed something here, see if property with id 2 have 4 photos then your query will produce 4 rows properties with id = 2 for 4 photos. So here we do not need repetition I guess. check with that."}, {"owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 0, "creation_date": 1559140812, "post_id": 56338051, "comment_id": 99329515, "body": "Actually it won&#39;t. Property.joins(:photos) will return Properties that have photos associated with it. Propery.joins(&#39;left outer join ....&#39;) will return properties with and without photos. hehe. check with that. While you&#39;re checking where photos.id is null, you&#39;re using the left out join wrong. plain join or inner join will do that for you. hehe, check with that"}, {"owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 0, "creation_date": 1559141617, "post_id": 56338051, "comment_id": 99329970, "body": "I&#39;ll admit I didn&#39;t see the <code>.where(photos: {id: nil})</code> but even still, you&#39;re using left outer join wrong.  regular joins(:photos) will return the desired records. you should only use left join when you want all the properties that bot have and do not have photos"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 0, "creation_date": 1559146223, "post_id": 56338051, "comment_id": 99332510, "body": "@MikeHeft I will check that. Can you post answer and evaluate with test in your local  if possible."}], "tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 0, "last_activity_date": 1559041048, "last_edit_date": 1559041048, "creation_date": 1559032262, "answer_id": 56338051, "question_id": 56337664, "link": "https://stackoverflow.com/questions/56337664/how-do-i-find-out-how-many-records-of-1-model-have-associated-objects-of-an-asso/56338051#56338051", "title": "How do I find out how many records of 1 model have associated objects of an association?", "body": "<p>In <strong>Rails-5</strong>, you can use <em>left_outer_joins</em>,</p>\n\n<pre><code>Property.left_outer_joins(:photos).where(photos: {id: nil})\n</code></pre>\n\n<p>SQL generated will be,</p>\n\n<pre><code>SELECT properties.*\nFROM properties \nLEFT OUTER JOIN photos \nON photos.property_id = property.id\nWHERE photos.id IS NULL\n</code></pre>\n\n<p>In <strong>Rails-3</strong>, You can try following</p>\n\n<pre><code>Property.joins(\"LEFT OUTER JOIN photos ON properties.id = photos.property_id\").where(photos: {id: nil})\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 0, "creation_date": 1560236473, "post_id": 56373243, "comment_id": 99658348, "body": "Not really sure the downvote. It&#39;s literally the same answer that got 2 upvotes"}], "tags": [], "owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "is_accepted": false, "score": -1, "last_activity_date": 1559199509, "creation_date": 1559199509, "answer_id": 56373243, "question_id": 56337664, "link": "https://stackoverflow.com/questions/56337664/how-do-i-find-out-how-many-records-of-1-model-have-associated-objects-of-an-asso/56373243#56373243", "title": "How do I find out how many records of 1 model have associated objects of an association?", "body": "<p>Using <code>Property.joins(:photos)</code> (which performs an inner join) will return the properties that have related photos. Meaning photos that have a <code>property_id</code>. While the answer using <code>left_outer_joins</code>, <code>LEFT JOIN</code> or <code>LEFT OUTER JOIN</code> will work, it's using the left join incorrectly by having the <code>.where(photos: { id: nil })</code>. <code>INNER JOIN</code>, <code>JOIN</code>, or <code>joins</code> between Property and Photo will result in what I have stated at the beginning of this answer. The left joins will return <strong>all</strong> properties with or without related photos.</p>\n\n<p><a href=\"https://i.stack.imgur.com/gwOTZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gwOTZ.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 471, "user_id": 3510489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c92874711894acba72c18012316a23a?s=128&d=identicon&r=PG", "display_name": "Duyet Nguyen", "link": "https://stackoverflow.com/users/3510489/duyet-nguyen"}, "edited": false, "score": 0, "creation_date": 1559528979, "post_id": 56376011, "comment_id": 99436182, "body": "Where condition just: <code>Property.joins(:photos).where(id: [1, 2])</code> is enought"}, {"owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "reply_to_user": {"reputation": 471, "user_id": 3510489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c92874711894acba72c18012316a23a?s=128&d=identicon&r=PG", "display_name": "Duyet Nguyen", "link": "https://stackoverflow.com/users/3510489/duyet-nguyen"}, "edited": false, "score": 0, "creation_date": 1559529191, "post_id": 56376011, "comment_id": 99436222, "body": "correct. However, I prefer writing joins with object to avoid misunderstanding when looking at it"}], "tags": [], "owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "is_accepted": false, "score": 1, "last_activity_date": 1559210681, "creation_date": 1559210681, "answer_id": 56376011, "question_id": 56337664, "link": "https://stackoverflow.com/questions/56337664/how-do-i-find-out-how-many-records-of-1-model-have-associated-objects-of-an-asso/56376011#56376011", "title": "How do I find out how many records of 1 model have associated objects of an association?", "body": "<p>In order to get only the <code>Properties</code> that actually have <code>photos</code> (i.e. <code>photos.count &gt; 0</code>), you need to perform <code>inner join</code> of two tables.</p>\n\n<p>In rails 5, you can do it by below command</p>\n\n<pre><code>Property.joins(:photos)\n</code></pre>\n\n<p>This will be transformed to SQL as</p>\n\n<pre><code>SELECT  \"properties\".* FROM \"properties\" INNER JOIN \"photos\" ON \"photos\".\"property_id\" = \"properties\".\"id\"\n</code></pre>\n\n<p>If you want to add more conditions on your queries, you can add <code>Where</code> clause</p>\n\n<pre><code>Property.joins(:photos).where(properties: {id: [1, 2]})\n</code></pre>\n"}], "owner": {"reputation": 29623, "user_id": 91970, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64aa7d1e0eb006175565adb0a47a4452?s=128&d=identicon&r=PG", "display_name": "marcamillion", "link": "https://stackoverflow.com/users/91970/marcamillion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1559210681, "creation_date": 1559030754, "last_edit_date": 1559031874, "question_id": 56337664, "link": "https://stackoverflow.com/questions/56337664/how-do-i-find-out-how-many-records-of-1-model-have-associated-objects-of-an-asso", "title": "How do I find out how many records of 1 model have associated objects of an association?", "body": "<p>I have two models - <code>Property</code> &amp; <code>Photos</code>.</p>\n\n<pre><code>class Property &lt; ActiveRecord::Base\n  has_many :photos, dependent: :destroy\nend\n\nclass Photo &lt; ActiveRecord::Base\n  belongs_to :property\nend\n</code></pre>\n\n<p>All I want to do is create a scope that returns only the Properties that actually have photos (i.e. <code>photos.count &gt; 0</code>).</p>\n\n<p>I have tried a million iterations of queries, and they don't work for one reason or another.</p>\n\n<p>See some examples of what I have tried and the results:</p>\n\n<pre><code>[32] pry(main)&gt; Property.includes(:photos).where('photos.count &gt; 0').count\n   (4.1ms)  SELECT COUNT(DISTINCT \"properties\".\"id\") FROM \"properties\" LEFT OUTER JOIN \"photos\" ON \"photos\".\"property_id\" = \"properties\".\"id\" WHERE (photos.count &gt; 0)\nActiveRecord::StatementInvalid: PG::GroupingError: ERROR:  aggregate functions are not allowed in WHERE\nLINE 1: ...\"photos\".\"property_id\" = \"properties\".\"id\" WHERE (photos.cou...\n                                                             ^\n[33] pry(main)&gt; Property.joins(:photos).where('photos.count &gt; 0').count\n   (11.1ms)  SELECT COUNT(*) FROM \"properties\" INNER JOIN \"photos\" ON \"photos\".\"property_id\" = \"properties\".\"id\" WHERE (photos.count &gt; 0)\nActiveRecord::StatementInvalid: PG::GroupingError: ERROR:  aggregate functions are not allowed in WHERE\nLINE 1: ...\"photos\".\"property_id\" = \"properties\".\"id\" WHERE (photos.cou...\n                                                             ^\n\n[38] pry(main)&gt; Property.joins(:photos).count(\"properties.id\").count\n   (158.2ms)  SELECT COUNT(properties.id) FROM \"properties\" INNER JOIN \"photos\" ON \"photos\".\"property_id\" = \"properties\".\"id\"\nNoMethodError: undefined method `count' for 72604:Fixnum\nfrom (pry):38:in `__pry__'\n\n[39] pry(main)&gt; Property.joins(:photos).count(\"properties.id\")\n   (50.6ms)  SELECT COUNT(properties.id) FROM \"properties\" INNER JOIN \"photos\" ON \"photos\".\"property_id\" = \"properties\".\"id\"\n=&gt; 72604\n\n[40] pry(main)&gt; Photo.joins(:properties).count(\"photos.id\")\nActiveRecord::ConfigurationError: Association named 'properties' was not found on Photo; perhaps you misspelled it?\nfrom /.rvm/gems/ruby-2.3.7@myapp/gems/activerecord-3.2.22.5/lib/active_record/associations/join_dependency.rb:112:in `build'\n\n[41] pry(main)&gt; Photo.joins(:property).count(\"photos.id\")\n   (65.0ms)  SELECT COUNT(photos.id) FROM \"photos\" INNER JOIN \"properties\" ON \"properties\".\"id\" = \"photos\".\"property_id\"\n=&gt; 72604\n\n[42] pry(main)&gt; Photo.joins(:property).count(\"photos.id\")\n   (60.5ms)  SELECT COUNT(photos.id) FROM \"photos\" INNER JOIN \"properties\" ON \"properties\".\"id\" = \"photos\".\"property_id\"\n=&gt; 72604\n\n[43] pry(main)&gt; Property.joins(:photos).count(\"properties.id\").distinct\n   (46.4ms)  SELECT COUNT(properties.id) FROM \"properties\" INNER JOIN \"photos\" ON \"photos\".\"property_id\" = \"properties\".\"id\"\nNoMethodError: undefined method `distinct' for 72604:Fixnum\nfrom (pry):43:in `__pry__'\n\n[44] pry(main)&gt; Property.joins(:photos).distinct.count(\"properties.id\")\n=&gt; 0\n</code></pre>\n\n<p>This should be simple, but for some reason it's much more difficult than I expected.</p>\n\n<p>Thoughts?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "routes"], "answers": [{"tags": [], "owner": {"reputation": 1165, "user_id": 6945452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f194d5802eb275d75a6c1af397534a?s=128&d=identicon&r=PG", "display_name": "Kamal Pandey", "link": "https://stackoverflow.com/users/6945452/kamal-pandey"}, "is_accepted": true, "score": 3, "last_activity_date": 1559027056, "creation_date": 1559027056, "answer_id": 56336705, "question_id": 56336659, "link": "https://stackoverflow.com/questions/56336659/how-i-remove-controllers-name-from-the-route-url/56336705#56336705", "title": "How I remove controllers name from the route (URL)?", "body": "<p>try</p>\n\n<p><code>get \"contact_us\", to: \"home#contact_us\", as: :contact_us</code></p>\n"}, {"tags": [], "owner": {"reputation": 76, "user_id": 3295701, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eHGcR.jpg?s=128&g=1", "display_name": "SunTechnique", "link": "https://stackoverflow.com/users/3295701/suntechnique"}, "is_accepted": false, "score": 0, "last_activity_date": 1559120608, "last_edit_date": 1559120608, "creation_date": 1559120237, "answer_id": 56356720, "question_id": 56336659, "link": "https://stackoverflow.com/questions/56336659/how-i-remove-controllers-name-from-the-route-url/56356720#56356720", "title": "How I remove controllers name from the route (URL)?", "body": "<p><code>get \"contact_us\", to: \"home#contact_us\"</code></p>\n\n<pre><code>as: :contact_us # not required\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9758190, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-terFU-mrQrs/AAAAAAAAAAI/AAAAAAAAAEQ/Vke05HTmAyA/photo.jpg?sz=128", "display_name": "Ronak Bhatt", "link": "https://stackoverflow.com/users/9758190/ronak-bhatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 56336705, "answer_count": 2, "score": 0, "last_activity_date": 1559120608, "creation_date": 1559026891, "question_id": 56336659, "link": "https://stackoverflow.com/questions/56336659/how-i-remove-controllers-name-from-the-route-url", "title": "How I remove controllers name from the route (URL)?", "body": "<p><strong>How I remove controllers name from the route (URL)?</strong></p>\n\n<pre><code>Example :\n\nExisting Url: https://localhost:3000/home/contact_us\n\nI want this URL https://localhost:3000/contact_us\n</code></pre>\n\n<p>so how can I do that?</p>\n\n<blockquote>\n  <p>Route.rb</p>\n  \n  <p>get \"home/contact_us\", to: \"home#contact_us\", as: :contact_us</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby", "parameters", "devise"], "comments": [{"owner": {"reputation": 741, "user_id": 7752594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gU6so.png?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/7752594/vishal"}, "edited": false, "score": 0, "creation_date": 1559026684, "post_id": 56335767, "comment_id": 99278907, "body": "how you are redirecting to the signup page, is it by callbacks or something?"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 10075876, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j7d3Chl5TZo/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7obE-kTGcNuqf5tWp6sQ3RBQUo5dA/mo/photo.jpg?sz=128", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/10075876/sabrina"}, "edited": false, "score": 0, "creation_date": 1559051138, "post_id": 56336338, "comment_id": 99292359, "body": "I edited my inital post with my controller. I got the controller code from this thread that I found: <a href=\"https://stackoverflow.com/questions/42572124/adding-custom-parameters-to-devise-registration-unpermitted-parameters\" title=\"adding custom parameters to devise registration unpermitted parameters\">stackoverflow.com/questions/42572124/&hellip;</a>"}], "tags": [], "owner": {"reputation": 68, "user_id": 2912082, "user_type": "registered", "profile_image": "https://graph.facebook.com/1434756062/picture?type=large", "display_name": "Surat Pyari", "link": "https://stackoverflow.com/users/2912082/surat-pyari"}, "is_accepted": false, "score": 0, "last_activity_date": 1559025644, "creation_date": 1559025644, "answer_id": 56336338, "question_id": 56335767, "link": "https://stackoverflow.com/questions/56335767/use-params-in-devise-signup-form/56336338#56336338", "title": "use params in devise signup form", "body": "<p>How you handling this in controller. Just sending a parameter won't solve your issue</p>\n"}, {"tags": [], "owner": {"reputation": 113, "user_id": 10075876, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j7d3Chl5TZo/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7obE-kTGcNuqf5tWp6sQ3RBQUo5dA/mo/photo.jpg?sz=128", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/10075876/sabrina"}, "is_accepted": false, "score": 1, "last_activity_date": 1559052359, "creation_date": 1559052359, "answer_id": 56344053, "question_id": 56335767, "link": "https://stackoverflow.com/questions/56335767/use-params-in-devise-signup-form/56344053#56344053", "title": "use params in devise signup form", "body": "<p>Okay so here is how i fixed it by putting this in my controller:</p>\n\n<pre><code>class RegistrationsController &lt; Devise::RegistrationsController\n\n    before_action :configure_permitted_parameters, if: :devise_controller?\n\n  protected\n\n  def configure_permitted_parameters\n    devise_parameter_sanitizer.permit(:sign_up, keys: [:item_id])\n  end\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 10075876, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j7d3Chl5TZo/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7obE-kTGcNuqf5tWp6sQ3RBQUo5dA/mo/photo.jpg?sz=128", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/10075876/sabrina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1559052359, "creation_date": 1559022700, "last_edit_date": 1559051283, "question_id": 56335767, "link": "https://stackoverflow.com/questions/56335767/use-params-in-devise-signup-form", "title": "use params in devise signup form", "body": "<p>My user visits an item show view and then is send to the signup-page (I use devise). On the signup page, I have the params (item_id) of the item he visited on the previous page. I want this item_id to be saved when the user makes his sign_up (like user.item_id). Here is how I tried to do it:</p>\n\n<pre><code>&lt;input value=\"#{params[:item_id]}\" type=\"hidden\" name=\"user[item_id]\" id=\"user_item_id\"&gt;\n</code></pre>\n\n<p>When the user is saved, the item_id remains empty. What am I missing here?\nHere is what I put into my controller:</p>\n\n<pre><code>def configure_sign_up_params\n    devise_parameter_sanitizer.permit(:sign_up, keys: [:item_id])\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "edited": false, "score": 2, "creation_date": 1559022354, "post_id": 56335403, "comment_id": 99277248, "body": "show your config/routes.rb and output of <code>rake routes</code>"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1559023254, "post_id": 56335403, "comment_id": 99277557, "body": "Perhaps try <code>product_path</code> instead of <code>products_path</code>?"}, {"owner": {"reputation": 443, "user_id": 3678149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YVIsD.jpg?s=128&g=1", "display_name": "kishore cheruku", "link": "https://stackoverflow.com/users/3678149/kishore-cheruku"}, "edited": false, "score": 0, "creation_date": 1559036279, "post_id": 56335403, "comment_id": 99283870, "body": "If your routes used &quot;resources :products&quot; , then you can use simply &lt;%= link_to &quot;Product&quot; , @product %&gt;. No need to use any path. Just go with Product object. Note : In controller method should be call &quot;show&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 10396112, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nLQ6Em9VASU/AAAAAAAAAAI/AAAAAAAAAjQ/pbQaLsgvWBc/photo.jpg?sz=128", "display_name": "Surender Singh", "link": "https://stackoverflow.com/users/10396112/surender-singh"}, "edited": false, "score": 0, "creation_date": 1559021281, "post_id": 56335463, "comment_id": 99276936, "body": "i did that but still no change"}], "tags": [], "owner": {"reputation": 1289, "user_id": 6583381, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IoEUj.jpg?s=128&g=1", "display_name": "oj5th", "link": "https://stackoverflow.com/users/6583381/oj5th"}, "is_accepted": false, "score": 0, "last_activity_date": 1559020918, "creation_date": 1559020918, "answer_id": 56335463, "question_id": 56335403, "link": "https://stackoverflow.com/questions/56335403/how-can-i-display-a-particular-product/56335463#56335463", "title": "How can i display a particular product?", "body": "<p><code>products_path(@product)</code> should be <code>products_path(product)</code></p>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 10396112, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nLQ6Em9VASU/AAAAAAAAAAI/AAAAAAAAAjQ/pbQaLsgvWBc/photo.jpg?sz=128", "display_name": "Surender Singh", "link": "https://stackoverflow.com/users/10396112/surender-singh"}, "edited": false, "score": 0, "creation_date": 1559021697, "post_id": 56335539, "comment_id": 99277063, "body": "still the thing is same it shows product.id in url and shows a list of products"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "reply_to_user": {"reputation": 19, "user_id": 10396112, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nLQ6Em9VASU/AAAAAAAAAAI/AAAAAAAAAjQ/pbQaLsgvWBc/photo.jpg?sz=128", "display_name": "Surender Singh", "link": "https://stackoverflow.com/users/10396112/surender-singh"}, "edited": false, "score": 2, "creation_date": 1559023614, "post_id": 56335539, "comment_id": 99277670, "body": "Do <code>rails routes -c products</code>  please add that result in question"}], "tags": [], "owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "is_accepted": false, "score": 2, "last_activity_date": 1559023636, "last_edit_date": 1559023636, "creation_date": 1559021434, "answer_id": 56335539, "question_id": 56335403, "link": "https://stackoverflow.com/questions/56335403/how-can-i-display-a-particular-product/56335539#56335539", "title": "How can i display a particular product?", "body": "<p>Instead of this</p>\n\n<pre><code> &lt;a href=\"&lt;%= products_path(@product) %&gt;\"&gt;&lt;%= product.title %&gt; .   &lt;/a&gt;\n</code></pre>\n\n<p>Use rails standard way</p>\n\n<pre><code>&lt;%= link_to product.title, product_path(product)  %&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1165, "user_id": 6945452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f194d5802eb275d75a6c1af397534a?s=128&d=identicon&r=PG", "display_name": "Kamal Pandey", "link": "https://stackoverflow.com/users/6945452/kamal-pandey"}, "reply_to_user": {"reputation": 19, "user_id": 10396112, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nLQ6Em9VASU/AAAAAAAAAAI/AAAAAAAAAjQ/pbQaLsgvWBc/photo.jpg?sz=128", "display_name": "Surender Singh", "link": "https://stackoverflow.com/users/10396112/surender-singh"}, "edited": false, "score": 0, "creation_date": 1559028629, "post_id": 56336644, "comment_id": 99279851, "body": "@SurenderSingh please accept the answer if it worked. Thanks"}], "tags": [], "owner": {"reputation": 1165, "user_id": 6945452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f194d5802eb275d75a6c1af397534a?s=128&d=identicon&r=PG", "display_name": "Kamal Pandey", "link": "https://stackoverflow.com/users/6945452/kamal-pandey"}, "is_accepted": false, "score": 0, "last_activity_date": 1559040127, "last_edit_date": 1559040127, "creation_date": 1559026833, "answer_id": 56336644, "question_id": 56335403, "link": "https://stackoverflow.com/questions/56335403/how-can-i-display-a-particular-product/56336644#56336644", "title": "How can i display a particular product?", "body": "<p>If you want to do in this way instead of </p>\n\n<pre><code>&lt;ul&gt;\n    &lt;% products.each do |product| %&gt;\n    &lt;tr&gt;\n\n        &lt;a href=\"&lt;%= products_path(@product) %&gt;\"&gt;&lt;%= product.title %&gt; .   &lt;/a&gt;\n        &lt;br/&gt;\n\n    &lt;/tr&gt;\n    &lt;% end %&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>try</p>\n\n<pre><code>&lt;ul&gt;\n    &lt;% products.each do |product| %&gt;\n    &lt;tr&gt;\n\n        &lt;a href=\"/products/#{product.id}\"&gt;&lt;%= product.title %&gt;&lt;/a&gt;\n        &lt;br/&gt;\n\n    &lt;/tr&gt;\n    &lt;% end %&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>but in rails way you can do</p>\n\n<pre><code>&lt;ul&gt;\n    &lt;% products.each do |product| %&gt;\n    &lt;tr&gt;\n\n        &lt;%= link_to product.title, product_path(product) %&gt;\n\n        &lt;br/&gt;\n\n    &lt;/tr&gt;\n    &lt;% end %&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>&lt;ul&gt;\n        &lt;% products.each do |product| %&gt;\n        &lt;tr&gt;\n\n            &lt;%= link_to product.title, product %&gt;\n\n            &lt;br/&gt;\n\n        &lt;/tr&gt;\n        &lt;% end %&gt;\n    &lt;/ul&gt;\n</code></pre>\n\n<p>and in routes you shoud specify</p>\n\n<pre><code>resources :products\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 443, "user_id": 3678149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YVIsD.jpg?s=128&g=1", "display_name": "kishore cheruku", "link": "https://stackoverflow.com/users/3678149/kishore-cheruku"}, "is_accepted": false, "score": 0, "last_activity_date": 1559036471, "creation_date": 1559036471, "answer_id": 56339281, "question_id": 56335403, "link": "https://stackoverflow.com/questions/56335403/how-can-i-display-a-particular-product/56339281#56339281", "title": "How can i display a particular product?", "body": "<p>If your routes used <strong>resources :products</strong> , then you can use simply </p>\n\n<blockquote>\n  \n</blockquote>\n\n<p>No need to use any path. Just go with Product object. </p>\n\n<p><strong>Note :</strong> In controller method should be call \"show\".</p>\n"}], "owner": {"reputation": 19, "user_id": 10396112, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nLQ6Em9VASU/AAAAAAAAAAI/AAAAAAAAAjQ/pbQaLsgvWBc/photo.jpg?sz=128", "display_name": "Surender Singh", "link": "https://stackoverflow.com/users/10396112/surender-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1559040127, "creation_date": 1559020595, "last_edit_date": 1559032757, "question_id": 56335403, "link": "https://stackoverflow.com/questions/56335403/how-can-i-display-a-particular-product", "title": "How can i display a particular product?", "body": "<p>I am trying to display a particular product by clicking on it from the list</p>\n\n<pre><code>&lt;ul&gt;\n    &lt;% products.each do |product| %&gt;\n    &lt;tr&gt;\n\n        &lt;a href=\"&lt;%= products_path(@product) %&gt;\"&gt;&lt;%= product.title %&gt; .   &lt;/a&gt;\n        &lt;br/&gt;\n\n    &lt;/tr&gt;\n    &lt;% end %&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>Expected results should be <code>products/1</code> but the result is <code>products.1</code> and should displays a list of products</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5184, "user_id": 1083764, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/e084347ce721f3828d1bcdf1606337ff?s=128&d=identicon&r=PG", "display_name": "SoWhat", "link": "https://stackoverflow.com/users/1083764/sowhat"}, "edited": false, "score": 0, "creation_date": 1559019758, "post_id": 56334989, "comment_id": 99276547, "body": "what is the result of <code>echo $RAILS_DEV_DB_USSERNAME</code> in the terminal(non rails"}, {"owner": {"reputation": 13, "user_id": 10506605, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zDUsan6S29o/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWjxJhf0rj6XKZo1BWa-JXUlNZ6IA/mo/photo.jpg?sz=128", "display_name": "Karl Batbbb", "link": "https://stackoverflow.com/users/10506605/karl-batbbb"}, "edited": false, "score": 0, "creation_date": 1559020210, "post_id": 56334989, "comment_id": 99276648, "body": "<code>echo $RAILS_DEV_DB_USSERNAME</code> return <code>root</code> ,<code>echo $RAILS_DEV_DB_PASSWORD </code> return my correct password.i checked"}, {"owner": {"reputation": 5184, "user_id": 1083764, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/e084347ce721f3828d1bcdf1606337ff?s=128&d=identicon&r=PG", "display_name": "SoWhat", "link": "https://stackoverflow.com/users/1083764/sowhat"}, "edited": false, "score": 0, "creation_date": 1559021398, "post_id": 56334989, "comment_id": 99276971, "body": "does changing the username to root work. In the database.yml file"}, {"owner": {"reputation": 13, "user_id": 10506605, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zDUsan6S29o/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWjxJhf0rj6XKZo1BWa-JXUlNZ6IA/mo/photo.jpg?sz=128", "display_name": "Karl Batbbb", "link": "https://stackoverflow.com/users/10506605/karl-batbbb"}, "reply_to_user": {"reputation": 5184, "user_id": 1083764, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/e084347ce721f3828d1bcdf1606337ff?s=128&d=identicon&r=PG", "display_name": "SoWhat", "link": "https://stackoverflow.com/users/1083764/sowhat"}, "edited": false, "score": 0, "creation_date": 1559022368, "post_id": 56334989, "comment_id": 99277253, "body": "you mean change <code>&lt;%= ENV[&#39;RAILS_DEV_DB_USSERNAME&#39;] %&gt;</code> to <code>root</code>  in the database.yml?  still not working"}, {"owner": {"reputation": 5184, "user_id": 1083764, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/e084347ce721f3828d1bcdf1606337ff?s=128&d=identicon&r=PG", "display_name": "SoWhat", "link": "https://stackoverflow.com/users/1083764/sowhat"}, "edited": false, "score": 0, "creation_date": 1559032076, "post_id": 56334989, "comment_id": 99281583, "body": "Try doing <code>spring stop</code>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1559063580, "post_id": 56334989, "comment_id": 99299224, "body": "Did you just misspell <code>USERNAME</code> note you have 2 <code>S</code>s"}, {"owner": {"reputation": 13, "user_id": 10506605, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zDUsan6S29o/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWjxJhf0rj6XKZo1BWa-JXUlNZ6IA/mo/photo.jpg?sz=128", "display_name": "Karl Batbbb", "link": "https://stackoverflow.com/users/10506605/karl-batbbb"}, "edited": false, "score": 0, "creation_date": 1559095733, "post_id": 56334989, "comment_id": 99309070, "body": "<code>spring stop</code> return <code>Spring is not running</code>,I can&#39;t find out the reason,I just created a new rails project,and everything is fine."}], "answers": [{"tags": [], "owner": {"reputation": 462, "user_id": 7236200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca3e89931df93c19497126a2a36cb8bf?s=128&d=identicon&r=PG&f=1", "display_name": "amit bhosale", "link": "https://stackoverflow.com/users/7236200/amit-bhosale"}, "is_accepted": true, "score": 0, "last_activity_date": 1559030242, "last_edit_date": 1559030242, "creation_date": 1559025900, "answer_id": 56336413, "question_id": 56334989, "link": "https://stackoverflow.com/questions/56334989/mysql2error-access-denied-for-user-using-env-variable-in-database-yml/56336413#56336413", "title": "Mysql2::Error &quot;Access denied for user&quot; using env variable in database.yml", "body": "<p>As Author arpiagar suggested <a href=\"https://stackoverflow.com/questions/5866015/rails-3-how-use-an-env-config-vars-in-a-settings-yml-file\">rails 3, how use an ENV config vars in a Settings.yml file?</a> check his example (26)</p>\n\n<blockquote>\n  <p>when you introduce a scriptlet tag in .yml file, it is more of erb template. So read it as a erb template first and then load the yml </p>\n</blockquote>\n\n<p>You can use <a href=\"https://github.com/bkeepers/dotenv\" rel=\"nofollow noreferrer\">dotenv</a> or <a href=\"https://github.com/laserlemon/figaro\" rel=\"nofollow noreferrer\">figaro</a> gems (inspired by the Twelve-Factor App methodology) to loads environment variables.</p>\n\n<p>For example if you use dotenv gem</p>\n\n<pre><code>By default, load will look for a file called .env in the current working directory. Pass in multiple files and they will be loaded in order. The first value set for a variable will win.\n\nrequire 'dotenv'\nDotenv.load('file1.env', 'file2.env')\nHOSTNAME = ENV['HOSTNAME']\n</code></pre>\n\n<p>More info please check below mentioned links</p>\n\n<ol>\n<li><p><a href=\"http://railsapps.github.io/rails-environment-variables.html\" rel=\"nofollow noreferrer\">http://railsapps.github.io/rails-environment-variables.html</a>  </p></li>\n<li><p><a href=\"https://www.honeybadger.io/blog/ruby-guide-environment-variables/\" rel=\"nofollow noreferrer\">https://www.honeybadger.io/blog/ruby-guide-environment-variables/</a></p></li>\n</ol>\n"}], "owner": {"reputation": 13, "user_id": 10506605, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zDUsan6S29o/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWjxJhf0rj6XKZo1BWa-JXUlNZ6IA/mo/photo.jpg?sz=128", "display_name": "Karl Batbbb", "link": "https://stackoverflow.com/users/10506605/karl-batbbb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 1, "accepted_answer_id": 56336413, "answer_count": 1, "score": 0, "last_activity_date": 1559099751, "creation_date": 1559017549, "last_edit_date": 1559099751, "question_id": 56334989, "link": "https://stackoverflow.com/questions/56334989/mysql2error-access-denied-for-user-using-env-variable-in-database-yml", "title": "Mysql2::Error &quot;Access denied for user&quot; using env variable in database.yml", "body": "<p>My System is macOX Mojave 10.14 <br>\nMySQL is MySQL:8.0.16<br>\nMy <code>database.yml</code> is:</p>\n\n<pre><code>development:\n  adapter: mysql2\n  encoding: utf8\n  database: dev_database\n  reconnect: false\n  pool: 5\n  username: &lt;%= ENV['RAILS_DEV_DB_USSERNAME'] %&gt;\n  password: &lt;%= ENV['RAILS_DEV_DB_PASSWORD'] %&gt;\n  socket: /tmp/mysql.sock\n</code></pre>\n\n<p>and I have confirmed if the variable is valid. Using</p>\n\n<blockquote>\n  <p>Command-Line: erb config/database.yml</p>\n</blockquote>\n\n<p>I can get:</p>\n\n<pre><code>development:\n  adapter: mysql2\n  encoding: utf8\n  database: dev_database\n  reconnect: false\n  pool: 5\n  username: root\n  password: Wle3S#23sv\n  socket: /tmp/mysql.sock\n</code></pre>\n\n<p>But when I start <code>rails s -e developent</code>, and browse to my page, I can not connect to my database.</p>\n\n<p><a href=\"https://i.stack.imgur.com/NyTgg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NyTgg.png\" alt=\"enter image description here\"></a></p>\n\n<p>What can I do now?</p>\n"}, {"tags": ["ruby", "curl", "multipartform-data", "multipart", "rest-client"], "answers": [{"tags": [], "owner": {"reputation": 323, "user_id": 3148811, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/4c63ba4cefaf079ab64adee29e30d139?s=128&d=identicon&r=PG&f=1", "display_name": "letsbondiway", "link": "https://stackoverflow.com/users/3148811/letsbondiway"}, "is_accepted": false, "score": 1, "last_activity_date": 1559129725, "creation_date": 1559129725, "answer_id": 56359676, "question_id": 56334923, "link": "https://stackoverflow.com/questions/56334923/how-to-convert-a-curl-multipart-form-data-post-request-to-ruby-request-using-res/56359676#56359676", "title": "How to convert a cURL multipart/form-data POST request to ruby request using rest-client?", "body": "<p>I solved it for my specific case (where I needed to upload an IPA file to my enterprise app store) by changing the request to the following :-</p>\n\n<pre><code>require 'rest-client'\nrequire 'json'\n\nresponse = RestClient::Request.execute(\n  :url =&gt; \"https://myserver.com/blobs/upload?fileName=some.ipa&amp;groupId=098\",\n  :method =&gt; :post,\n  :headers =&gt; {\n    'Authorization' =&gt; \"Basic jhdsjhdshjhdshdhh\",\n    'tenant-code' =&gt; \"djdjhhsdsjhjsd=\",\n    'Accept' =&gt; 'application/json',\n    'Content-Type' =&gt; 'application/octet-stream',\n    'Expect' =&gt; '100-continue'\n  },\n  :payload =&gt; File.open(path_to_file, \"rb\")\n)\n</code></pre>\n\n<p>Basically, the content type needed to be octet-stream and Expect header needs to be set too.</p>\n\n<p>Hopefully, it helps someone who comes looking for something like this.</p>\n"}], "owner": {"reputation": 323, "user_id": 3148811, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/4c63ba4cefaf079ab64adee29e30d139?s=128&d=identicon&r=PG&f=1", "display_name": "letsbondiway", "link": "https://stackoverflow.com/users/3148811/letsbondiway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 651, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559129725, "creation_date": 1559016974, "question_id": 56334923, "link": "https://stackoverflow.com/questions/56334923/how-to-convert-a-curl-multipart-form-data-post-request-to-ruby-request-using-res", "title": "How to convert a cURL multipart/form-data POST request to ruby request using rest-client?", "body": "<p>I have to implement the curl POST request listed below in Ruby using Rest-Client so that I can upload a file to my server.</p>\n\n<pre><code>curl -X POST --header 'Content-Type: multipart/form-data' --header 'Accept: application/json' --header 'Authorization: Basic jhdsjhdshjhdshdhh' --header 'tenant-code:djdjhhsdsjhjsd=' {\"type\":\"formData\"} 'https://myserver.com/blobs/upload?fileName=some.ipa&amp;groupId=098'\n</code></pre>\n\n<p>I have tried the following -</p>\n\n<pre><code>require 'rest-client'\nrequire 'json'\n\npayload = {\n    :multipart =&gt; true,\n    :file =&gt; File.new(path_to_file, 'rb')\n}\n\nresponse = RestClient.post(\"https://myserver.com/blobs/upload?fileName=some.ipa&amp;groupId=098\", payload, {accept: :json, 'tenant-code':\"djdjhhsdsjhjsd=\", 'Authorization': \"Basic jhdsjhdshjhdshdhh\"})\n</code></pre>\n\n<p>This works okay as I get 200 response from the server. However, when I check for the uploaded file on my server it is corrupted.</p>\n\n<p>Is this the right way to do multipart/form-data request using ruby? </p>\n\n<p>I see there is the following in cURL request which is not accounted for in ruby request anywhere.</p>\n\n<pre><code>{\"type\":\"formData\"}\n</code></pre>\n\n<p>Do I need to do something extra for that?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "irb"], "answers": [{"tags": [], "owner": {"reputation": 8462, "user_id": 405865, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e29f04f339715955060858e0e65e1311?s=128&d=identicon&r=PG", "display_name": "fphilipe", "link": "https://stackoverflow.com/users/405865/fphilipe"}, "is_accepted": true, "score": 2, "last_activity_date": 1559020888, "creation_date": 1559020888, "answer_id": 56335457, "question_id": 56334197, "link": "https://stackoverflow.com/questions/56334197/how-do-i-prevent-output-activerecordbase-logger-from-within-a-method/56335457#56335457", "title": "How do I prevent output ActiveRecord::Base.logger from within a method?", "body": "<p>You're looking for <a href=\"https://api.rubyonrails.org/classes/LoggerSilence.html#method-i-silence\" rel=\"nofollow noreferrer\"><code>#silence</code></a>, which takes a block during which the logger is silenced:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def generate_dataset\n  ActiveRecord::Base.logger.silence do\n    ProductDatum.create(product_names: Products.all.pluck(:name))\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 314, "user_id": 9440171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d45BA.jpg?s=128&g=1", "display_name": "ashwood", "link": "https://stackoverflow.com/users/9440171/ashwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 56335457, "answer_count": 1, "score": 0, "last_activity_date": 1559064145, "creation_date": 1559009221, "last_edit_date": 1559064145, "question_id": 56334197, "link": "https://stackoverflow.com/questions/56334197/how-do-i-prevent-output-activerecordbase-logger-from-within-a-method", "title": "How do I prevent output ActiveRecord::Base.logger from within a method?", "body": "<p>The method below takes a few minutes to print out the database entry each time I call it in the console. I need to see the printing the rest of the time so shutting it off entirely isn't an option.</p>\n\n<p>This is my unsuccessful attempt to stop the printing in the method directly.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def generate_dataset\n  old_logger = ActiveRecord::Base.logger\n  ActiveRecord::Base.logger = nil\n\n  ProductDatum.create(product_names: Products.all.pluck(:name))\n\n  ActiveRecord::Base.logger = old_logger\nend\n\n</code></pre>\n"}, {"tags": ["mysql", "ruby", "indexing"], "comments": [{"owner": {"reputation": 29517, "user_id": 6436191, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ecxRK.png?s=128&g=1", "display_name": "The Impaler", "link": "https://stackoverflow.com/users/6436191/the-impaler"}, "edited": false, "score": 2, "creation_date": 1559004601, "post_id": 56333810, "comment_id": 99273951, "body": "Why do you care about uniqueness? As long as they are evenly distributed, the index will produce a balanced number of buckets and will be efficient when retrieving data. And I would guess SecureRandom produces rather balanced values."}, {"owner": {"reputation": 29517, "user_id": 6436191, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ecxRK.png?s=128&g=1", "display_name": "The Impaler", "link": "https://stackoverflow.com/users/6436191/the-impaler"}, "edited": false, "score": 4, "creation_date": 1559004785, "post_id": 56333810, "comment_id": 99273978, "body": "Also, a table with 100k rows is quite small for today&#39;s standards. I wouldn&#39;t worry about index performance at this level. If you had 100 millions rows I would definitively focus on tweaking performance. But with just 100k rows... even if you used the full length column (255 bytes) you&#39;ll be perfectly OK."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 1, "creation_date": 1559039554, "post_id": 56333810, "comment_id": 99285709, "body": "Why not use <code>SecureRandom.uuid</code> then they will be unique."}], "answers": [{"tags": [], "owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "is_accepted": false, "score": 0, "last_activity_date": 1559061877, "creation_date": 1559061877, "answer_id": 56346773, "question_id": 56333810, "link": "https://stackoverflow.com/questions/56333810/what-prefix-to-use-when-indexing-securerandom-string-column/56346773#56346773", "title": "What prefix to use when indexing SecureRandom string column", "body": "<p>This is just a random number, correct?  Not encryption.</p>\n\n<p>Do <em>not</em> use a prefix; although it will shrink the index size some, it will invalidate the usage of the index in many cases.  True, 22 bytes is longer than an 8-char string or a 4-byte <code>INT</code>.  But the downside of failure to use the index is worse.</p>\n\n<p>The default of 16 (22) is sufficient to make the random string unique enough to avoid accidental collisions.</p>\n\n<p>Don't say <code>VARCHAR(255)</code> if the max is 22.  Say <code>CHAR(22)</code> if fixed length or <code>VARCHAR(22)</code> if you allow the user to choose a length up to 16.</p>\n\n<p>Do say <code>CHARACTER SET ascii COLLATE ascii_bin</code> for the column.  This will avoid (1) overhead of utf8 and (2) the mistake of case folding.</p>\n\n<p>If you are going to have an index on a billion of these items, then there will be significant performance issues, as discussed <a href=\"http://mysql.rjweb.org/doc.php/uuid\" rel=\"nofollow noreferrer\"><em>here</em></a> (though in a different context).  A million rows is probably not an issue -- it depends on when the index becomes bigger than can be cached in RAM in the buffer_pool.</p>\n\n<p>(If I recall the formula correctly, for 8 chars as you describe, there would be one chance in 300K that an index with 300K entries would include a duplicate.  But that's not the issue.)</p>\n"}, {"tags": [], "owner": {"reputation": 833, "user_id": 46461, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/nTOCE.jpg?s=128&g=1", "display_name": "Paul Holden", "link": "https://stackoverflow.com/users/46461/paul-holden"}, "is_accepted": true, "score": 0, "last_activity_date": 1566327776, "creation_date": 1566327776, "answer_id": 57580060, "question_id": 56333810, "link": "https://stackoverflow.com/questions/56333810/what-prefix-to-use-when-indexing-securerandom-string-column/57580060#57580060", "title": "What prefix to use when indexing SecureRandom string column", "body": "<h2>Results</h2>\n\n<p>I decided to follow the steps I outlined in the question. As a result I got the information I needed to choose an index prefix.</p>\n\n<p>Two changes resulted from this experiment:</p>\n\n<ol>\n<li>I reduced the size of the column from <code>255</code> to <code>22</code> (also suggested by @Rick James). See details in the question for why the data is never more than 22 characters.</li>\n<li>I added an index on the column with a prefix of 8 characters. The charset is utf8mb4, so the key size will not be directly proportional to the number of characters in the prefix.</li>\n</ol>\n\n<h2>Experiment details</h2>\n\n<p>I tested prefixes of length 1, 2, 4, 8 and 16 characters and used <code>EXPLAIN</code> to see what the a lookup on the column would do. I also tested with no index as a baseline. My experiment was based on a set of 100k records. I could have tested with more records, but for my purposes, it wasn't necessary to get more precise.</p>\n\n<p>Here are some highlights of the experiment:</p>\n\n<ul>\n<li>Without an index, the query on the <code>SecureRandom</code> column does a table scan.</li>\n<li>With a 1 character prefix, MySQL has to scan roughly 3200 records of 100k.</li>\n<li>With a 2 character prefix, MySQL has to scan 79 records.</li>\n<li>With a 4 character prefix, MySQL gets the exact record immediately without doing a lookup on the table.</li>\n</ul>\n\n<p>Beyond the 4 character prefix, with a data set of 100k and based on the characteristics of <code>SecureRandom.urlsafe_base64</code> I can't get more precise. Based on the current size of the table in production and a rough idea of its growth rate, we decided that a prefix of 8 characters would serve us well into the future, while economizing on disk and memory usage.</p>\n\n<h2>Alternatives</h2>\n\n<p>Through this exploration I also learned about MySQL's index selectivity feature. This would allow, using the same sample set of 100k records, to test the number of records retrieved for each prefix length, without having to run migrations to add/drop the different indices before each test. For example, to test the selectivity of a 4-character prefix:</p>\n\n<pre><code>SELECT count(*) AS count, LEFT(uuid_column, 4) AS prefix\n  FROM string_prefix_test GROUP BY count DESC LIMIT 10;\n</code></pre>\n\n<p>More details on index selectivity can be found in the 2012 edition of <em>High Performance MySQL</em> at p 160.</p>\n\n<h2>Future work</h2>\n\n<p>Next I'm going to be looking into prefixes for indices of <code>varchar</code> columns with data that doesn't have the uniqueness characteristics of <code>SecureRandom.urlsafe_base64</code>. That's going to be more challenging only because getting a representative data set is harder.</p>\n"}], "owner": {"reputation": 833, "user_id": 46461, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/nTOCE.jpg?s=128&g=1", "display_name": "Paul Holden", "link": "https://stackoverflow.com/users/46461/paul-holden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 57580060, "answer_count": 2, "score": 2, "last_activity_date": 1566327776, "creation_date": 1559004420, "question_id": 56333810, "link": "https://stackoverflow.com/questions/56333810/what-prefix-to-use-when-indexing-securerandom-string-column", "title": "What prefix to use when indexing SecureRandom string column", "body": "<p>I have a DB column (type <code>varchar(255)</code>) that stores a URL-safe base 64 string produced by <code>SecureRandom.urlsafe_base64</code>. The method call uses the default values, so the result should be <a href=\"https://apidock.com/ruby/SecureRandom/urlsafe_base64/class\" rel=\"nofollow noreferrer\">16 bytes or <strong>22 characters</strong> in length</a>.</p>\n\n<p>The base64 value is used to look up records when a user hits the site, to mask DB IDs. I need an index for this column because of this lookup, however I don't want to index the entire column because that <em>could</em> be inefficient storage-wise.</p>\n\n<p>What's the best approach to determining the optimal index prefix to use in this case? What I'm thinking right now is something like this:</p>\n\n<ol>\n<li>Create sample data with about 100k records to simulate production data</li>\n<li>Add an index for the base 64 column with a prefix (say 8 characters)</li>\n<li>Run <code>EXPLAIN</code> on a lookup on the base 64 column to see how many\nrecords need to be inspected</li>\n<li>Adjust the index up or down and re-do step 3.</li>\n<li>Choose a prefix size that balances (a) storage requirements and (b) number of records returned with matching hits.</li>\n</ol>\n\n<p>The issue here is that I know <code>SecureRandom</code> produces unique base 64 strings, but I'm not sure <em>how unique</em> they are. Eg, out of 100k records, if I use a prefix of 8 characters, will that prefix be shared by 10 records or 100?</p>\n\n<p>Some more specific questions about my approach:</p>\n\n<ol>\n<li>Is 100k records enough of a sample to pick a good prefix size?</li>\n<li>If I did apply an index <em>without</em> using a prefix, is my suspicion that this is bad storage-wise correct?</li>\n<li>What's a reasonable number of records to expect to have to query the table directly, and still benefit from an index?</li>\n</ol>\n\n<p><strong>Notes</strong>:</p>\n\n<ul>\n<li>My database is MySQL (actually Percona)</li>\n<li><code>SecureRandom</code> comes from Ruby</li>\n<li>I'm assuming that the URL-safe feature of <code>SecureRandom</code> isn't changing the uniqueness characteristics of the base 64 output.</li>\n</ul>\n"}, {"tags": ["regex", "ruby"], "comments": [{"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1558994191, "post_id": 56332812, "comment_id": 99272184, "body": "<code>s.scan(&#47;{([^{}]*)}&#47;)</code>?"}, {"owner": {"reputation": 43580, "user_id": 1020526, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Scjj8.jpg?s=128&g=1", "display_name": "revo", "link": "https://stackoverflow.com/users/1020526/revo"}, "edited": false, "score": 1, "creation_date": 1558994232, "post_id": 56332812, "comment_id": 99272195, "body": "Maybe <code>{[^{}]*}</code>? If you need to extract what comes between braces enclose them in parentheses."}, {"owner": {"reputation": 2915, "user_id": 907840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fded07a866c52a785b5122d7fc4b160?s=128&d=identicon&r=PG", "display_name": "sauronnikko", "link": "https://stackoverflow.com/users/907840/sauronnikko"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1558994263, "post_id": 56332812, "comment_id": 99272197, "body": "yes, that works @WiktorStribi\u017cew. Thanks. I you put it as an answer, I&#39;ll accept it"}, {"owner": {"reputation": 2915, "user_id": 907840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fded07a866c52a785b5122d7fc4b160?s=128&d=identicon&r=PG", "display_name": "sauronnikko", "link": "https://stackoverflow.com/users/907840/sauronnikko"}, "reply_to_user": {"reputation": 43580, "user_id": 1020526, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Scjj8.jpg?s=128&g=1", "display_name": "revo", "link": "https://stackoverflow.com/users/1020526/revo"}, "edited": false, "score": 0, "creation_date": 1558994359, "post_id": 56332812, "comment_id": 99272229, "body": "@revo that also captures <code>{</code> and <code>}</code>, which I don&#39;t want. But it&#39;s close enough! Thanks"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1559020664, "post_id": 56332812, "comment_id": 99276766, "body": "I added an answer at the linked question for which this is a dup that uses lookarounds rather than a capture group and considers the possibility of nested pairs of braces."}], "owner": {"reputation": 2915, "user_id": 907840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fded07a866c52a785b5122d7fc4b160?s=128&d=identicon&r=PG", "display_name": "sauronnikko", "link": "https://stackoverflow.com/users/907840/sauronnikko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "closed_date": 1558994423, "answer_count": 0, "score": 0, "last_activity_date": 1558994086, "creation_date": 1558994086, "question_id": 56332812, "link": "https://stackoverflow.com/questions/56332812/regexp-capture-multiple-patterns-inside-a-matching-pattern", "closed_reason": "Duplicate", "title": "Regexp: capture multiple patterns inside a matching pattern", "body": "<p>I'm trying to find a regexp that captures both <code>1 member</code> and <code># members</code> from the following text:</p>\n\n<pre><code>\"{count, plural, =1 {1 member} other {# members}}\"\n</code></pre>\n\n<p>I've tried with <code>/{.*{(.*)}.*}/</code> but that only captures <code># members</code>. If it helps, I'm using Ruby as my language.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "rbenv"], "comments": [{"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 1, "creation_date": 1559008283, "post_id": 56332372, "comment_id": 99274528, "body": "Which version of MacOS do you have? Please, check answers here - <a href=\"https://stackoverflow.com/questions/53528115/i386-arch-error-installing-old-scrypt-gem-version-with-os-x-mojave\" title=\"i386 arch error installing old scrypt gem version with os x mojave\">stackoverflow.com/questions/53528115/&hellip;</a>"}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 1, "creation_date": 1559013794, "post_id": 56332372, "comment_id": 99275437, "body": "The problem is that it fails while installing Nokogiri. You should read the error stack trace since it tells you why it fails. Try <code>gem install Nokogiri</code> and see why that gem is failing. Have you tried any of the suggestions in the error?"}, {"owner": {"reputation": 2028, "user_id": 1657377, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4iVGJ.png?s=128&g=1", "display_name": "jethroo", "link": "https://stackoverflow.com/users/1657377/jethroo"}, "edited": false, "score": 0, "creation_date": 1559033539, "post_id": 56332372, "comment_id": 99282293, "body": "seems like you missing built tools for building the native extensions, check this guide pointing out the tools you usually need: <a href=\"http://railsapps.github.io/installrubyonrails-mac.html\" rel=\"nofollow noreferrer\">railsapps.github.io/installrubyonrails-mac.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 10609675, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kCCzjFZGrNo/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBf9rD34DVaoTCS9L0y4vD0gyrRpw/mo/photo.jpg?sz=128", "display_name": "Shiv Bhandari", "link": "https://stackoverflow.com/users/10609675/shiv-bhandari"}, "edited": false, "score": 0, "creation_date": 1559074501, "post_id": 56338365, "comment_id": 99303821, "body": "Thanks for the help! Installing xcode solved a lot of the issue and dependencies that I needed."}], "tags": [], "owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "is_accepted": true, "score": 3, "last_activity_date": 1559033744, "last_edit_date": 1559033744, "creation_date": 1559033438, "answer_id": 56338365, "question_id": 56332372, "link": "https://stackoverflow.com/questions/56332372/how-to-install-rails-on-mac-error-installing-rails-on-mac/56338365#56338365", "title": "How to Install Rails on MAC: Error Installing Rails on MAC", "body": "<p>You have issues with libxml2</p>\n\n<p>Make sure you have xcodebuild installed:</p>\n\n<pre><code>sudo xcodebuild -license accept\n</code></pre>\n\n<p>Or try to install libxml2 directly via brew:</p>\n\n<pre><code>brew install libxml2\n</code></pre>\n\n<p>Also you might try to run</p>\n\n<pre><code>gem install nokogiri -v 1.10.3 -- --use-system-libraries\n</code></pre>\n\n<p>Because nokogiri is shipping with it's own libxml2 that's incompatible with some systems</p>\n\n<p>Ref <a href=\"https://stackoverflow.com/questions/24251494/nokogiri-gem-installation-error\">nokogiri gem installation error</a></p>\n"}], "owner": {"reputation": 77, "user_id": 10609675, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kCCzjFZGrNo/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBf9rD34DVaoTCS9L0y4vD0gyrRpw/mo/photo.jpg?sz=128", "display_name": "Shiv Bhandari", "link": "https://stackoverflow.com/users/10609675/shiv-bhandari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 0, "accepted_answer_id": 56338365, "answer_count": 1, "score": 0, "last_activity_date": 1559033744, "creation_date": 1558990639, "last_edit_date": 1558991120, "question_id": 56332372, "link": "https://stackoverflow.com/questions/56332372/how-to-install-rails-on-mac-error-installing-rails-on-mac", "title": "How to Install Rails on MAC: Error Installing Rails on MAC", "body": "<p>I am trying to set Rails on my MAC, but continue to get an error even with all the previous help provided by people that have also faced the same problem.</p>\n\n<p>I downloaded Ruby 2.4.1 using rbenv and now I need to install rails 4.2.1 but I continue to get the following error. </p>\n\n<p>ERROR:  Error installing rails:\n    ERROR: Failed to build gem native extension.</p>\n\n<pre><code>Fetching actionview-4.2.1.gem\nFetching actionpack-4.2.1.gem\nFetching railties-4.2.1.gem\nFetching activejob-4.2.1.gem\nFetching actionmailer-4.2.1.gem\nFetching activemodel-4.2.1.gem\nFetching activerecord-4.2.1.gem\nFetching rails-4.2.1.gem\nBuilding native extensions. This could take a while...\nERROR:  Error installing rails:\n    ERROR: Failed to build gem native extension.\n\n    current directory: /Library/Ruby/Gems/2.3.0/gems/nokogiri-1.10.3/ext/nokogiri\n/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/bin/ruby -I /Library/Ruby/Site/2.3.0 -r ./siteconf20190527-36261-6oqyvd.rb extconf.rb\nchecking if the C compiler accepts  -I     /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include/libxml2... yes\nchecking if the C compiler accepts -Wno-error=unused-command-line-argument-hard-error-in-future... no\nBuilding nokogiri using packaged libraries.\nUsing mini_portile version 2.4.0\nchecking for iconv.h... yes\nchecking for gzdopen() in -lz... yes\nchecking for iconv... yes\n************************************************************************\nIMPORTANT NOTICE:\n\nBuilding Nokogiri with a packaged version of libxml2-2.9.9\nwith the following patches applied:\n    - 0001-Revert-Do-not-URI-escape-in-server-side-includes.patch\n    - 0002-Remove-script-macro-support.patch\n    - 0003-Update-entities-to-remove-handling-of-ssi.patch\n\nTeam Nokogiri will keep on doing their best to provide security updates in a timely manner, but if this is a concern for you and want to use the system library instead; abort this installation process and reinstall nokogiri as follows:\n\n    gem install nokogiri -- --use-system-libraries\n        [--with-xml2-config=/path/to/xml2-config]\n        [--with-xslt-config=/path/to/xslt-config]\n\nIf you are using Bundler, tell it to use the option:\n\n    bundle config build.nokogiri --use-system-libraries\n    bundle install\n\nNote, however, that nokogiri is not fully compatible with arbitrary versions of libxml2 provided by OS/package vendors.\n************************************************************************\nExtracting libxml2-2.9.9.tar.gz into tmp/x86_64-apple-darwin17/ports/libxml2/2.9.9... OK\nRunning git apply with /Library/Ruby/Gems/2.3.0/gems/nokogiri-1.10.3/patches/libxml2/0001-Revert-Do-not-URI-escape-in-server-side-includes.patch... OK\nRunning git apply with /Library/Ruby/Gems/2.3.0/gems/nokogiri-1.10.3/patches/libxml2/0002-Remove-script-macro-support.patch... OK\nRunning git apply with /Library/Ruby/Gems/2.3.0/gems/nokogiri-1.10.3/patches/libxml2/0003-Update-entities-to-remove-handling-of-ssi.patch... OK\nRunning 'configure' for libxml2 2.9.9... OK\nRunning 'compile' for libxml2 2.9.9... ERROR, review '/Library/Ruby/Gems/2.3.0/gems/nokogiri-1.10.3/ext/nokogiri/tmp/x86_64 apple-darwin17/ports/libxml2/2.9.9/compile.log' to see what happened. Last lines are:\n========================================================================\n  CC       testdso.lo\n  CCLD     testdso.la\n  CC       xmllint.o\n  CCLD     xmllint\nld: warning: The i386 architecture is deprecated for macOS (remove from the Xcode build setting: ARCHS)\nld: warning: ignoring file /usr/local/Cellar/xz/5.2.4/lib/liblzma.dylib, file was built for x86_64 which is not the architecture being linked (i386): /usr/local/Cellar/xz/5.2.4/lib/liblzma.dylib\nUndefined symbols for architecture i386:\n  \"_lzma_auto_decoder\", referenced from:\n      _xz_head in libxml2.a(xzlib.o)\n  \"_lzma_code\", referenced from:\n      _xz_decomp in libxml2.a(xzlib.o)\n  \"_lzma_end\", referenced from:\n      ___libxml2_xzclose in libxml2.a(xzlib.o)\n  \"_lzma_properties_decode\", referenced from:\n      _is_format_lzma in libxml2.a(xzlib.o)\nld: symbol(s) not found for architecture i386\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\nmake[2]: *** [xmllint] Error 1\nmake[1]: *** [all-recursive] Error 1\nmake: *** [all] Error 2\n========================================================================\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/bin/$(RUBY_BASE_NAME)\n    --help\n    --clean\n    --use-system-libraries\n    --enable-static\n    --disable-static\n    --with-zlib-dir\n    --without-zlib-dir\n    --with-zlib-include\n    --without-zlib-include=${zlib-dir}/include\n    --with-zlib-lib\n    --without-zlib-lib=${zlib-dir}/lib\n    --enable-cross-build\n    --disable-cross-build\n/Library/Ruby/Gems/2.3.0/gems/mini_portile2-2.4.0/lib/mini_portile2/mini_portile.rb:402:in `block in execute': Failed to complete compile task (RuntimeError)\nfrom /Library/Ruby/Gems/2.3.0/gems/mini_portile2-2.4.0/lib/mini_portile2/mini_portile.rb:373:in `chdir'\nfrom /Library/Ruby/Gems/2.3.0/gems/mini_portile2-2.4.0/lib/mini_portile2/mini_portile.rb:373:in `execute'\nfrom /Library/Ruby/Gems/2.3.0/gems/mini_portile2-2.4.0/lib/mini_portile2/mini_portile.rb:115:in `compile'\nfrom /Library/Ruby/Gems/2.3.0/gems/mini_portile2-2.4.0/lib/mini_portile2/mini_portile.rb:154:in `cook'\nfrom extconf.rb:365:in `block (2 levels) in process_recipe'\nfrom extconf.rb:257:in `block in chdir_for_build'\nfrom extconf.rb:256:in `chdir'\nfrom extconf.rb:256:in `chdir_for_build'\nfrom extconf.rb:364:in `block in process_recipe'\nfrom extconf.rb:262:in `tap'\nfrom extconf.rb:262:in `process_recipe'\nfrom extconf.rb:557:in `&lt;main&gt;'\n\nTo see why this extension failed to compile, please check the mkmf.log which can be found here:\n\n  /Library/Ruby/Gems/2.3.0/extensions/universal-darwin-17/2.3.0/nokogiri-1.10.3/mkmf.log\n\nextconf failed, exit code 1\n\nGem files will remain installed in /Library/Ruby/Gems/2.3.0/gems/nokogiri-1.10.3 for inspection.\nResults logged to /Library/Ruby/Gems/2.3.0/extensions/universal-darwin-17/2.3.0/nokogiri-1.10.3/gem_make.out\n</code></pre>\n\n<p>I have seen:</p>\n\n<pre><code>gem update --system 3.0.3\n</code></pre>\n\n<p>But don't need this as I already have the latest version of gem.</p>\n\n<p>I have tried:</p>\n\n<pre><code>sudo gem install rails --version 4.2.1\n</code></pre>\n\n<p>But this is what throws the above error.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 0, "creation_date": 1558997347, "post_id": 56331778, "comment_id": 99272772, "body": "what type of class is <code>#&lt;Class:xxxxxx&gt;</code>? It means the <code>validate_email_field</code> doesn&#39;t exist in that class. Either you have mis-specified the name, or you haven&#39;t added the method yet, to that class."}, {"owner": {"reputation": 314, "user_id": 9948990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0153057b15f61830fd2df6e2fad26562?s=128&d=identicon&r=PG&f=1", "display_name": "moe zarrinfam", "link": "https://stackoverflow.com/users/9948990/moe-zarrinfam"}, "reply_to_user": {"reputation": 24560, "user_id": 4880924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d40e83be235d4f70428da0d42e12d427?s=128&d=identicon&r=PG&f=1", "display_name": "BKSpurgeon", "link": "https://stackoverflow.com/users/4880924/bkspurgeon"}, "edited": false, "score": 1, "creation_date": 1559029436, "post_id": 56331778, "comment_id": 99280287, "body": "I only added casein in empty project. it should be casein internal error or version bug."}], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 5536439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hL463.jpg?s=128&g=1", "display_name": "Daniel Ansari", "link": "https://stackoverflow.com/users/5536439/daniel-ansari"}, "is_accepted": true, "score": 1, "last_activity_date": 1559030720, "creation_date": 1559030720, "answer_id": 56337659, "question_id": 56331778, "link": "https://stackoverflow.com/questions/56331778/casein-admin-user-got-error-when-running-project/56337659#56337659", "title": "casein admin user got error when running project", "body": "<p>Use Casein version 5.4.0 because 5.3.0 version is not compatible with this rails version.</p>\n"}], "owner": {"reputation": 314, "user_id": 9948990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0153057b15f61830fd2df6e2fad26562?s=128&d=identicon&r=PG&f=1", "display_name": "moe zarrinfam", "link": "https://stackoverflow.com/users/9948990/moe-zarrinfam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 56337659, "answer_count": 1, "score": 1, "last_activity_date": 1559030720, "creation_date": 1558986840, "question_id": 56331778, "link": "https://stackoverflow.com/questions/56331778/casein-admin-user-got-error-when-running-project", "title": "casein admin user got error when running project", "body": "<p>I'm using casein gem in my project</p>\n\n<p>all around my app I give casein error in casein/admin_user.rb model that says:\n<code>NoMethodError: undefined method 'validate_email_field=' for #&lt;Class:xxxxxx&gt;\nDid you mean?  validates_numericality_of</code></p>\n\n<p>whats the problem?</p>\n\n<p>casein version: 5.3.0</p>\n\n<p>ruby version: jruby 9.2.5.0</p>\n\n<p>rails version: 5.2.1</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1559094993, "post_id": 56331732, "comment_id": 99308944, "body": "When you say &quot;request object&quot;, are you talking about HTTP requests or something else? If the former, <a href=\"https://github.com/vcr/vcr\" rel=\"nofollow noreferrer\">vcr</a> is a good place to start"}], "answers": [{"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 2, "creation_date": 1558988572, "post_id": 56331976, "comment_id": 99270780, "body": "One downside of Marshal is that it can&#39;t serialize everything (<a href=\"https://stackoverflow.com/a/6392704/479863\">hashes with <code>default_proc</code>s</a> for example). Another is that the format is tied to the version of Ruby. Generally fine for short term storage of simple objects though."}], "tags": [], "owner": {"reputation": 3590, "user_id": 1494245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a50a2dcc33b58918f27664b7646d92b7?s=128&d=identicon&r=PG", "display_name": "Sean Huber", "link": "https://stackoverflow.com/users/1494245/sean-huber"}, "is_accepted": false, "score": 2, "last_activity_date": 1558987974, "creation_date": 1558987974, "answer_id": 56331976, "question_id": 56331732, "link": "https://stackoverflow.com/questions/56331732/ruby-how-to-record-an-object-and-reuse-it-for-tests/56331976#56331976", "title": "Ruby : How to record an object and reuse it for tests?", "body": "<p>One option is to use <code>Marshal</code>, which is built into ruby natively (i.e., not specific to Rails). You can use <code>Marshal</code> to serialize objects to strings via <code>serialized_obj = Marshal.dump(my_object)</code>. You can store those strings in files and then deserialize them in your test suite via <code>my_obj = Marshal.load(serialized_obj)</code>. Here's an example from this great writeup by Mehdi Farsi, <a href=\"https://blog.appsignal.com/2019/03/26/object-marshalling-in-ruby.html\" rel=\"nofollow noreferrer\">https://blog.appsignal.com/2019/03/26/object-marshalling-in-ruby.html</a>.</p>\n\n<pre><code>hello_world = 'hello world!'\n\nserialized_string = Marshal.dump(hello_world) # =&gt; \"\\x04\\bI\\\"\\x11hello world!\\x06:\\x06ET\"\nserialized_string.class                       # =&gt; String\n\ndeserialized_hello_world = Marshal.load(serialized_string) # =&gt; \"hello world!\"\n\nhello_world.object_id              # =&gt; 70204420126020\ndeserialized_hello_world.object_id # =&gt; 70204419825700\n</code></pre>\n"}], "owner": {"reputation": 2232, "user_id": 2595513, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/i1Q7t.png?s=128&g=1", "display_name": "bdavidxyz", "link": "https://stackoverflow.com/users/2595513/bdavidxyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1558987974, "creation_date": 1558986582, "question_id": 56331732, "link": "https://stackoverflow.com/questions/56331732/ruby-how-to-record-an-object-and-reuse-it-for-tests", "title": "Ruby : How to record an object and reuse it for tests?", "body": "<p>In Ruby-on-Rails, how to record an object and its state (in development mode) so that I can use it for testing purpose ? For example the request object, but more generally any complicated object, whether I own the class definition or not.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-console"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9983237, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yQHHb0IPMSA/AAAAAAAAAAI/AAAAAAAAHY8/VXQnQppEeuE/photo.jpg?sz=128", "display_name": "Diego", "link": "https://stackoverflow.com/users/9983237/diego"}, "edited": false, "score": 0, "creation_date": 1558982056, "post_id": 56330917, "comment_id": 99268874, "body": "Thanks a lot! Worked, how I didn&#39;t this before? haha thanks"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 11, "user_id": 9983237, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yQHHb0IPMSA/AAAAAAAAAAI/AAAAAAAAHY8/VXQnQppEeuE/photo.jpg?sz=128", "display_name": "Diego", "link": "https://stackoverflow.com/users/9983237/diego"}, "edited": false, "score": 0, "creation_date": 1558982116, "post_id": 56330917, "comment_id": 99268892, "body": "my pleasure. I recommend you this guide about rails query interface <a href=\"https://guides.rubyonrails.org/active_record_querying.html\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/active_record_querying.html</a>"}, {"owner": {"reputation": 11, "user_id": 9983237, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yQHHb0IPMSA/AAAAAAAAAAI/AAAAAAAAHY8/VXQnQppEeuE/photo.jpg?sz=128", "display_name": "Diego", "link": "https://stackoverflow.com/users/9983237/diego"}, "edited": false, "score": 0, "creation_date": 1558982412, "post_id": 56330917, "comment_id": 99268985, "body": "Thanks! I will check"}, {"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "reply_to_user": {"reputation": 11, "user_id": 9983237, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yQHHb0IPMSA/AAAAAAAAAAI/AAAAAAAAHY8/VXQnQppEeuE/photo.jpg?sz=128", "display_name": "Diego", "link": "https://stackoverflow.com/users/9983237/diego"}, "edited": false, "score": 0, "creation_date": 1559011959, "post_id": 56330917, "comment_id": 99275084, "body": "@Diego please, <a href=\"https://stackoverflow.com/help/someone-answers\">accept the answer</a>, if it helped"}, {"owner": {"reputation": 11, "user_id": 9983237, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yQHHb0IPMSA/AAAAAAAAAAI/AAAAAAAAHY8/VXQnQppEeuE/photo.jpg?sz=128", "display_name": "Diego", "link": "https://stackoverflow.com/users/9983237/diego"}, "reply_to_user": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1559053149, "post_id": 56330917, "comment_id": 99293547, "body": "Thanks @Vasilisa, now I can."}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 1, "last_activity_date": 1558981855, "creation_date": 1558981855, "answer_id": 56330917, "question_id": 56330849, "link": "https://stackoverflow.com/questions/56330849/how-to-get-an-correspondent-id-through-a-model-on-rails-console/56330917#56330917", "title": "How to get an correspondent id through a model on rails console", "body": "<p>Try</p>\n\n<pre><code>Company.joins(address: :city).where(cities: {state_id: 27})\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9983237, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yQHHb0IPMSA/AAAAAAAAAAI/AAAAAAAAHY8/VXQnQppEeuE/photo.jpg?sz=128", "display_name": "Diego", "link": "https://stackoverflow.com/users/9983237/diego"}, "edited": false, "score": 0, "creation_date": 1559053233, "post_id": 56334411, "comment_id": 99293590, "body": "Yeah, the == &amp; = make sense to me. Thanks a lot"}], "tags": [], "owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "is_accepted": false, "score": 0, "last_activity_date": 1559011880, "creation_date": 1559011880, "answer_id": 56334411, "question_id": 56330849, "link": "https://stackoverflow.com/questions/56330849/how-to-get-an-correspondent-id-through-a-model-on-rails-console/56334411#56334411", "title": "How to get an correspondent id through a model on rails console", "body": "<p>You can make it work with <code>select</code> method. Also, don't mix up <code>==</code> and <code>=</code> - the former one checks equality and the latter one assigns a value:</p>\n\n<pre><code>needed_companies = Company.all.select do |comp|\n     comp.address.city.state_id == 27\nend\n</code></pre>\n\n<p>But it isn't a correct way, because you're loading all companies in memory and filtering it. Much better is to use SQL query (as in answer by Ursus) and return only needed companies from DB</p>\n"}], "owner": {"reputation": 11, "user_id": 9983237, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yQHHb0IPMSA/AAAAAAAAAAI/AAAAAAAAHY8/VXQnQppEeuE/photo.jpg?sz=128", "display_name": "Diego", "link": "https://stackoverflow.com/users/9983237/diego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 56330917, "answer_count": 2, "score": 0, "last_activity_date": 1559011880, "creation_date": 1558981544, "last_edit_date": 1559011302, "question_id": 56330849, "link": "https://stackoverflow.com/questions/56330849/how-to-get-an-correspondent-id-through-a-model-on-rails-console", "title": "How to get an correspondent id through a model on rails console", "body": "<p>I've trying to get the simple situation:</p>\n\n<p>I have a Model called Company, inside Company I have companies and I have the following object: \"state_id\". I want to find the related companies that contain some id.</p>\n\n<p>This is the only path that I can get the state_id. So, I am doing:</p>\n\n<pre><code>Company.all.each do |comp|\n     comp.address.city.state_id\nend\n</code></pre>\n\n<p>It works! But when I do:</p>\n\n<pre><code>Company.all.each do |comp|\n     comp.address.city.state_id = 27\n     #or comp.address.city.state_id(27)\nend\n</code></pre>\n\n<p>it doesn't return the right data</p>\n\n<p>I know that it simple, but unfortunately, I didn't getting the right output.</p>\n\n<p>Thanks a lot!</p>\n"}, {"tags": ["ruby", "selenium-webdriver", "scripting"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1558978882, "post_id": 56330353, "comment_id": 99267846, "body": "<code>@driver.navigate.to #{url}</code> is an invalid ruby syntax."}, {"owner": {"reputation": 1, "user_id": 11563558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaf9b39db4a35c5497c7dd81c70b2ed4?s=128&d=identicon&r=PG&f=1", "display_name": "LIvinAbsurdism", "link": "https://stackoverflow.com/users/11563558/livinabsurdism"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1558979154, "post_id": 56330353, "comment_id": 99267946, "body": "How would I set a variable to tell Selenium to go to? I thought that by setting url as the variable for the loop I could interpolate the value as the destination for Selenium. Again, still new to Ruby so any help is appreciated."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11563558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaf9b39db4a35c5497c7dd81c70b2ed4?s=128&d=identicon&r=PG&f=1", "display_name": "LIvinAbsurdism", "link": "https://stackoverflow.com/users/11563558/livinabsurdism"}, "edited": false, "score": 0, "creation_date": 1558978944, "post_id": 56330382, "comment_id": 99267872, "body": "With .each, I get a different error.         .rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/selenium-webd&zwnj;&#8203;river-      3.142.3/lib/selenium/webdriver/common/navigation.rb:31:in `to&#39;: wrong number of      arguments (given 0, expected 1) (ArgumentError)"}, {"owner": {"reputation": 11, "user_id": 2860902, "user_type": "registered", "profile_image": "https://graph.facebook.com/1538055050/picture?type=large", "display_name": "Henrique Guarnieri", "link": "https://stackoverflow.com/users/2860902/henrique-guarnieri"}, "reply_to_user": {"reputation": 1, "user_id": 11563558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaf9b39db4a35c5497c7dd81c70b2ed4?s=128&d=identicon&r=PG&f=1", "display_name": "LIvinAbsurdism", "link": "https://stackoverflow.com/users/11563558/livinabsurdism"}, "edited": false, "score": 0, "creation_date": 1558979143, "post_id": 56330382, "comment_id": 99267941, "body": "The problem is with the line <code>@driver.navigate.to</code>, can you use <code>@driver.navigate.to(url)</code>?"}, {"owner": {"reputation": 1, "user_id": 11563558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaf9b39db4a35c5497c7dd81c70b2ed4?s=128&d=identicon&r=PG&f=1", "display_name": "LIvinAbsurdism", "link": "https://stackoverflow.com/users/11563558/livinabsurdism"}, "edited": false, "score": 0, "creation_date": 1558980497, "post_id": 56330382, "comment_id": 99268404, "body": "Script runs without errors now, but it doesn&#39;t seem to be actually running the loop. It runs pretty quickly and the CSV returns as empty."}, {"owner": {"reputation": 11, "user_id": 2860902, "user_type": "registered", "profile_image": "https://graph.facebook.com/1538055050/picture?type=large", "display_name": "Henrique Guarnieri", "link": "https://stackoverflow.com/users/2860902/henrique-guarnieri"}, "reply_to_user": {"reputation": 1, "user_id": 11563558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaf9b39db4a35c5497c7dd81c70b2ed4?s=128&d=identicon&r=PG&f=1", "display_name": "LIvinAbsurdism", "link": "https://stackoverflow.com/users/11563558/livinabsurdism"}, "edited": false, "score": 0, "creation_date": 1558981000, "post_id": 56330382, "comment_id": 99268538, "body": "When you are using Selenium, by default it will not wait until the rendering of the page Try this: <code>@driver.manage.timeouts.implicit_wait = 10</code> after the <code>@driver.navigate.to</code>"}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1559015786, "post_id": 56330382, "comment_id": 99275768, "body": "Each and map doesn&#39;t differ in the way you used."}], "tags": [], "owner": {"reputation": 11, "user_id": 2860902, "user_type": "registered", "profile_image": "https://graph.facebook.com/1538055050/picture?type=large", "display_name": "Henrique Guarnieri", "link": "https://stackoverflow.com/users/2860902/henrique-guarnieri"}, "is_accepted": false, "score": 0, "last_activity_date": 1558978772, "creation_date": 1558978772, "answer_id": 56330382, "question_id": 56330353, "link": "https://stackoverflow.com/questions/56330353/how-to-set-a-variable-equivalent-to-single-array-object-while-iterating-through/56330382#56330382", "title": "How to set a variable equivalent to single array object while iterating through array?", "body": "<p>What about using <code>.each</code>?</p>\n\n<p>Example:</p>\n\n<pre><code>array = [1, 2, 3, 4, 5, 6]\narray.each { |x| puts x }\n</code></pre>\n\n<p>In your code:</p>\n\n<pre><code>urls.each do |url|\n    @driver.navigate.to #{url}\n    name = @driver.find_element(:css, '.sites-embed-footer&gt;a').attribute('href')\n    puts name\n    kb_link = name\n    kb_array.push(kb_link)\n    puts 'urls is #{n}'\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 11563558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaf9b39db4a35c5497c7dd81c70b2ed4?s=128&d=identicon&r=PG&f=1", "display_name": "LIvinAbsurdism", "link": "https://stackoverflow.com/users/11563558/livinabsurdism"}, "edited": false, "score": 0, "creation_date": 1559166427, "post_id": 56336568, "comment_id": 99340533, "body": "Doing this ended up solving my issue. My urls were all stored in a very nested array so each url was printing as [[[[url]]]]. Getting rid of the brackets made my Selenium driver.navigate.to work and I was able to traverse the array with .each (which I had originally wanted to do, but got somewhat frustrated around the time I posted this question).   Problem solved, the script ran and I was finally able to get all the data I needed from the webpages. :)"}], "tags": [], "owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "is_accepted": false, "score": 0, "last_activity_date": 1559026551, "creation_date": 1559026551, "answer_id": 56336568, "question_id": 56330353, "link": "https://stackoverflow.com/questions/56330353/how-to-set-a-variable-equivalent-to-single-array-object-while-iterating-through/56336568#56336568", "title": "How to set a variable equivalent to single array object while iterating through array?", "body": "<p>First of all, it doesn't make much sense to use <code>map</code> if you don't use the result of the block somewhere. <code>map</code>, applied to an Enumerable, returns a new Array, and you don't do anything with the returned array (which in your case would contain just the return values of <code>puts</code>, which is usually nil, so you would get back just an array of nils with the side effect that something is written to stdout. </p>\n\n<p>If you are only interested in the side effects, <code>each</code> or <code>each_with_index</code>should be used to traverse an Enumerable. Given the problems you have with <code>map</code> <strong>and</strong> with <code>each</code>, I wonder what is the actual content of your object <code>urls</code>. Did you ever inspect it? You could do a</p>\n\n<pre><code>p urls\n</code></pre>\n\n<p>before entering the loop. With 3000 URLs, the output will be huge, but maybe you can run it on a simpler example with less URLs.</p>\n"}], "owner": {"reputation": 1, "user_id": 11563558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaf9b39db4a35c5497c7dd81c70b2ed4?s=128&d=identicon&r=PG&f=1", "display_name": "LIvinAbsurdism", "link": "https://stackoverflow.com/users/11563558/livinabsurdism"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1559146206, "creation_date": 1558978615, "last_edit_date": 1559146206, "question_id": 56330353, "link": "https://stackoverflow.com/questions/56330353/how-to-set-a-variable-equivalent-to-single-array-object-while-iterating-through", "title": "How to set a variable equivalent to single array object while iterating through array?", "body": "<p>Noob question. I need to pass 3,000+ URLs from a CSV sheet to Selenium. I need Selenium to navigate to each one of these links, scrape information and then put that information into a CSV. </p>\n\n<p>The issue I am running into is when I push my CSV URLS into an array, I cannot pass one single object (url) into Selenium at a time. </p>\n\n<p>I know I likely need some sort of loop. I have tried setting up loops and selecting from the array using .map, .select. and just a do loop. </p>\n\n<pre><code>urls.map do |url|\n    @driver.navigate.to #{url}\n    name = @driver.find_element(:css, '.sites-embed- \nfooter&gt;a').attribute('href')\n    puts name\n    kb_link = name\n    kb_array.push(kb_link)\n    puts 'urls is #{n}'\nend\n</code></pre>\n\n<p>In the above example, Selenium returns an \"invalid URL\" error message. De-bugging with Pry tells me that my 'url' object is not a single url, but rather still the entire array. </p>\n\n<p>How can I set Selenium to visit each URL from the array one by one?</p>\n\n<p>EDIT: ----------------\nSo, after extensive de-bugging with Pry, I found a couple issues. First being that my CSV was feeding a nested array to my loop which was causing the URL error. I had to flatten my array and un-nest it to get around that issue. </p>\n\n<p>After that, I had to build a rescue into my loop so that my script didn't die when it encountered a page without the CSS element I was looking for. </p>\n\n<p>Here's the finalized loop. </p>\n\n<pre><code>begin\n        @urls1.each do |url|\n          @driver.navigate.to(url)\n          @driver.manage.timeouts.implicit_wait = 10\n\n          name = @driver.find_element(:css, '.sites-embed- \n          footer&gt;a').attribute('href')\n          puts name\n          kb_link = name\n          kb_array.push(kb_link)\n          puts 'done'\n\n         rescue Selenium::WebDriver::Error::NoSuchElementError\n         puts 'no google doc'\n         x = 'no google doc'\n         kb_array.push(x)\n         next\n    end\n</code></pre>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 168, "user_id": 11058389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae8db7ac2b919eb66c430dfaaab7fdcf?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/11058389/steve"}, "edited": false, "score": 0, "creation_date": 1558980324, "post_id": 56330582, "comment_id": 99268349, "body": "I&#39;m in the directory of the file and I&#39;m running <code>rspec file.rb</code> and it returns <code>Failure&#47;Error: return gem_original_require(path) LoadError:cannot load such file -- rspec</code>"}, {"owner": {"reputation": 168, "user_id": 11058389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae8db7ac2b919eb66c430dfaaab7fdcf?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/11058389/steve"}, "edited": false, "score": 1, "creation_date": 1558980395, "post_id": 56330582, "comment_id": 99268370, "body": "Ah, you&#39;re right! When I delete <code>require &#39;rspec&#39;</code> it works. Thanks a lot!"}], "tags": [], "owner": {"reputation": 1148, "user_id": 6591347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/muykQ.png?s=128&g=1", "display_name": "Oleksii Filonenko", "link": "https://stackoverflow.com/users/6591347/oleksii-filonenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1558979959, "creation_date": 1558979959, "answer_id": 56330582, "question_id": 56330352, "link": "https://stackoverflow.com/questions/56330352/is-there-any-way-to-run-rspec-tests-on-a-single-ruby-file/56330582#56330582", "title": "Is there any way to run Rspec tests on a single Ruby file?", "body": "<p>Try running <code>rspec &lt;/path/to/kata.rb&gt;</code>. You shouldn't even <code>require 'rspec'</code> then - just tested your example.</p>\n"}], "owner": {"reputation": 168, "user_id": 11058389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae8db7ac2b919eb66c430dfaaab7fdcf?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/11058389/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 56330582, "answer_count": 1, "score": 1, "last_activity_date": 1558979959, "creation_date": 1558978607, "question_id": 56330352, "link": "https://stackoverflow.com/questions/56330352/is-there-any-way-to-run-rspec-tests-on-a-single-ruby-file", "title": "Is there any way to run Rspec tests on a single Ruby file?", "body": "<p>I would like to run some tests on some code kata exercises that I am working on. Is it possible to run Rspec tests on a single Ruby file? I tried adding <code>require 'rspec'</code> to the top of the file and then the command <code>rsepc</code> from the project dir but the following is returned:</p>\n\n<pre><code>F\n\nFailures:\n\n  1) Sentence reverser reverses the words in a sentence\n     Failure/Error: expect(sentence_reverser(test_sentence)).to eq('I am backwards')\n\n     NoMethodError:\n       undefined method `sentence_reverser' for #&lt;RSpec::ExampleGroups::SentenceReverser:0x0000559764dc5950&gt;\n</code></pre>\n\n<p>The code I have is:</p>\n\n<pre><code>require 'rspec'\n\ndef sentence_reverser str\n  str.split.reverse.join(' ')\nend\n\ndescribe \"Sentence reverser\" do\n  it 'reverses the words in a sentence' do\n    test_sentence = \"backwards am I\"\n    expect(sentence_reverser(test_sentence)).to eq('I am backwards')\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "is_accepted": true, "score": 1, "last_activity_date": 1558974175, "creation_date": 1558974175, "answer_id": 56329548, "question_id": 56329474, "link": "https://stackoverflow.com/questions/56329474/controller-instance-variable-not-renders-at-js-view/56329548#56329548", "title": "Controller instance variable not renders at JS view", "body": "<p>There is a difference between <code>&lt;% %&gt;</code> and <code>&lt;%= %&gt;</code> in ERB, first one doesnt output anything, the second one does.</p>\n\n<pre><code>$(\"#&lt;% @commentary.commentable_type.underscore %&gt;-&lt;% @commentary.id %&gt;\")\n</code></pre>\n\n<p>Shoud be:</p>\n\n<pre><code>$(\"#&lt;%= @commentary.commentable_type.underscore %&gt;-&lt;%= @commentary.id %&gt;\")\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 4832189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-q815NGQIN20/AAAAAAAAAAI/AAAAAAAABU0/YipTLWXIisM/photo.jpg?sz=128", "display_name": "Kavachaj", "link": "https://stackoverflow.com/users/4832189/kavachaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 56329548, "answer_count": 1, "score": 0, "last_activity_date": 1558974314, "creation_date": 1558973835, "last_edit_date": 1558974314, "question_id": 56329474, "link": "https://stackoverflow.com/questions/56329474/controller-instance-variable-not-renders-at-js-view", "title": "Controller instance variable not renders at JS view", "body": "<p>I have controller:</p>\n\n<pre><code>class CommentariesController &lt; ApplicationController\n\n  before_action :authenticate_user!\n  before_action :find_commentary, only: [:update, :destroy]\n  before_action :find_commentable, only: [:create]\n\n  def create\n    @commentary = @commentable.commentaries.new(commentary_params)\n    @commentary.user_id = current_user.id\n    @commentary.save!\n  end\n\n  def update\n    @commentary.update(commentary_params) if current_user.authorized_for?(@commentary)\n  end\n\n  def destroy\n    @commentary.destroy  if current_user.authorized_for?(@commentary)\n  end\n\n  private\n\n  def find_commentary\n    @commentary = Commentary.find(params[:id])\n  end\n\n  def commentary_params\n    params.require(:commentary).permit(:body)\n  end\n\n  def find_commentable\n    if params[:question_id]\n      @commentable = Question.find(params[:question_id])\n    elsif params[:answer_id]\n      @commentable = Answer.find(params[:answer_id])\n    end\n  end\nend\n</code></pre>\n\n<p>And view for it's <code>create</code> action:</p>\n\n<pre><code>(\"#&lt;% @commentary.commentable_type.underscore %&gt;-&lt;% @commentary.id %&gt;\").append(\"&lt;% j render @commentary %&gt;\")\n</code></pre>\n\n<p><code>_commentary.html.slim</code>:</p>\n\n<pre><code>div class='d-flex justify-content-end mb-2'\n  div class='card col-10'\n    div class='card-body small text-muted' = commentary.body\n\n</code></pre>\n\n<p>When <code>create</code> action is being processed, all is right, commentaries are being created, and saved to the DB successfully, but instead of jQuery adds a commentary html code rendered, I get no errors, but such response:</p>\n\n<pre><code>$(\"#-\").append(\"\")\n</code></pre>\n\n<p>I can't realize what happens here, so that I get no errors, commentaries are saved, but I get empty commentary object fields. </p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 1, "creation_date": 1558972049, "post_id": 56329046, "comment_id": 99265548, "body": "What the type  of <code>auth_tokens</code> column? Show schema.rb file"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6847053"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1558972704, "post_id": 56329046, "comment_id": 99265781, "body": "@\u0417\u0435\u043b\u0451\u043d\u044b\u0439 Here: <code>ruby create_table &quot;blacklists&quot;, options: &quot;ENGINE=InnoDB DEFAULT CHARSET=utf8&quot;, force: :cascade do |t|     t.text &quot;auth_tokens&quot;     t.integer &quot;user_id&quot;     t.datetime &quot;created_at&quot;, null: false     t.datetime &quot;updated_at&quot;, null: false   end </code>  It&#39;s then serialized to an array in Blacklist model"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6847053"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1558972888, "post_id": 56329046, "comment_id": 99265853, "body": "@\u0417\u0435\u043b\u0451\u043d\u044b\u0439 see the updated code above"}, {"owner": {"reputation": 443, "user_id": 3678149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YVIsD.jpg?s=128&g=1", "display_name": "kishore cheruku", "link": "https://stackoverflow.com/users/3678149/kishore-cheruku"}, "edited": false, "score": 0, "creation_date": 1559039581, "post_id": 56329046, "comment_id": 99285725, "body": "Try this <b>BlackList.all.select { |m| m.auth_token.include? value }</b> OR  BlackList.all.select { |m| eval(m.auth_token).include? value"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6847053"}, "reply_to_user": {"reputation": 443, "user_id": 3678149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YVIsD.jpg?s=128&g=1", "display_name": "kishore cheruku", "link": "https://stackoverflow.com/users/3678149/kishore-cheruku"}, "edited": false, "score": 0, "creation_date": 1559190775, "post_id": 56329046, "comment_id": 99345457, "body": "@user3678149 will this not slow down the app if I have many rows in Blacklist table?(or a big database)"}, {"owner": {"reputation": 443, "user_id": 3678149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YVIsD.jpg?s=128&g=1", "display_name": "kishore cheruku", "link": "https://stackoverflow.com/users/3678149/kishore-cheruku"}, "edited": false, "score": 0, "creation_date": 1559201614, "post_id": 56329046, "comment_id": 99349093, "body": "I think no. But if you want to test how much time it is taking then you can use &quot;rubyprofiler&quot; , benchmark to know how much tame it is taking"}], "owner": {"user_type": "does_not_exist", "display_name": "user6847053"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "closed_date": 1558972817, "answer_count": 0, "score": 0, "last_activity_date": 1558972854, "creation_date": 1558971709, "last_edit_date": 1558972854, "question_id": 56329046, "link": "https://stackoverflow.com/questions/56329046/rails-activerecord-find-by-with-array", "closed_reason": "Duplicate", "title": "Rails activerecord find_by with array", "body": "<p>I have a <code>Blacklist</code> table in my rails app and below is the sample data in it when I run the command in <code>rails console</code>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># rails console\nBlacklist.all\n\n#&lt;Blacklist id: 1, auth_tokens: [\"abc\", \"abc1\", \"abc2\"], user_id: 2, created_at: \"..\", updated_at: \"..\"&gt;\n#&lt;Blacklist id: 2, auth_tokens: [\"xyz\", \"xyz1\", \"xyz2\"], user_id: 1, created_at: \"..\", updated_at: \"..\"&gt;\n</code></pre>\n\n<p>When I run:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># rails console\nBlacklist.find_by(auth_tokens: \"abc\")\n# returns nil\n</code></pre>\n\n<p>Now, what I want is to find the Blacklist which contains <code>auth_token</code> with value <code>\"abc\"</code> -> i.e. the query should return the <code>Blacklist</code> with ID 1. How can I achieve this?</p>\n\n<p>EDIT: <code>schema.rb</code> file</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>create_table \"blacklists\", options: \"ENGINE=InnoDB DEFAULT CHARSET=utf8\", force: :cascade do |t|\n    t.text \"auth_tokens\"\n    t.integer \"user_id\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n</code></pre>\n\n<p>Then The <code>auth_tokens</code> is serialized in Model:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># Blacklist model\nserialize :auth_tokens\n\nafter_initialize do |blacklist|\n  blacklist.auth_tokens = [] if blacklist.auth_tokens == nil\nend\n</code></pre>\n"}, {"tags": ["ruby", "nginx", "chef-infra", "erb", "chef-recipe"], "comments": [{"owner": {"reputation": 1100, "user_id": 108654, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6ae437fd594fd4c96ba19904c8eb4fc9?s=128&d=identicon&r=PG", "display_name": "gskillz", "link": "https://stackoverflow.com/users/108654/gskillz"}, "edited": false, "score": 0, "creation_date": 1558970822, "post_id": 56327858, "comment_id": 99265023, "body": "basically you need to override nginx log data only and the idea is to replace id with hashed id?"}, {"owner": {"reputation": 3455, "user_id": 3514736, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/9ec8ac55c7c37029e7ee25f73e869295?s=128&d=identicon&r=PG&f=1", "display_name": "Rehman", "link": "https://stackoverflow.com/users/3514736/rehman"}, "reply_to_user": {"reputation": 1100, "user_id": 108654, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6ae437fd594fd4c96ba19904c8eb4fc9?s=128&d=identicon&r=PG", "display_name": "gskillz", "link": "https://stackoverflow.com/users/108654/gskillz"}, "edited": false, "score": 0, "creation_date": 1558971333, "post_id": 56327858, "comment_id": 99265247, "body": "@gskillz Thats correct"}], "answers": [{"tags": [], "owner": {"reputation": 1100, "user_id": 108654, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6ae437fd594fd4c96ba19904c8eb4fc9?s=128&d=identicon&r=PG", "display_name": "gskillz", "link": "https://stackoverflow.com/users/108654/gskillz"}, "is_accepted": false, "score": 0, "last_activity_date": 1558987263, "creation_date": 1558987263, "answer_id": 56331854, "question_id": 56327858, "link": "https://stackoverflow.com/questions/56327858/how-to-modify-the-value-of-request-in-nginx/56331854#56331854", "title": "How to modify the value of $request in Nginx?", "body": "<p>To me you need to check <a href=\"http://openresty.org/en/\" rel=\"nofollow noreferrer\">openresty</a> project or install LUA extension for Nginx. Its ok to replace nginx with openresty to get LUA out of the box.</p>\n\n<p>With LUA script you can parse this certain part of the request - similar to your ruby code and record modified request uri in Nginx access log.</p>\n\n<p>Here are some examples how you can modify request parameters with <a href=\"http://ywebdev.com/?p=1\" rel=\"nofollow noreferrer\">LUA</a></p>\n"}], "owner": {"reputation": 3455, "user_id": 3514736, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/9ec8ac55c7c37029e7ee25f73e869295?s=128&d=identicon&r=PG&f=1", "display_name": "Rehman", "link": "https://stackoverflow.com/users/3514736/rehman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558987263, "creation_date": 1558966800, "last_edit_date": 1558967216, "question_id": 56327858, "link": "https://stackoverflow.com/questions/56327858/how-to-modify-the-value-of-request-in-nginx", "title": "How to modify the value of $request in Nginx?", "body": "<p>In Nginx, currently we are logging $request. But we want to change value for one request param in it.\nWe need to log hashed id instead of actual id.\nCould you please tell me how can I achieve that ?</p>\n\n<p><strong>Current value of $request :</strong> </p>\n\n<pre><code>POST /test/userRegistration?id=1234&amp;name=John&amp;address=UK\n</code></pre>\n\n<p><strong>Expected value:</strong></p>\n\n<pre><code>POST /test/userRegistration?id=8c77ec99436a23d2c05a6bd36c64de856&amp;name=John&amp;address=UK\n</code></pre>\n\n<p><strong>Nginx Log Format :</strong></p>\n\n<pre><code>log_format  main '$request $status $request_time';\n</code></pre>\n\n<p>I have written follwoing ruby code to meet my requirement. But I am not sure  how to integrate it in ERB file. That log_format is declared in \na ERB file.</p>\n\n<p>Code:</p>\n\n<pre><code>str = \"POST /test/userRegistration?name=John&amp;id=1234&amp;address=UK\"\nstr1 = str.scan(/&amp;id=.+&amp;/)[0]\nstr1 = str1.chomp('&amp;')\nstr1 = str1.split(\"=\").last\nstr1 = Digest::SHA256.hexdigest str1\nstr2 = \"&amp;id=\"+str1+\"&amp;\"\nstr3 = str.sub(/&amp;name=.+&amp;/, str2)\nputs str3\n</code></pre>\n\n<p>Please help me writing similar logic in ERB file. Also, please let me know if there is any better way to handle it as I am new to Ruby.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby", "ffi", "vips"], "comments": [{"owner": {"reputation": 7702, "user_id": 894763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d013c9681666f0a68a6c1c00ff4d603?s=128&d=identicon&r=PG", "display_name": "jcupitt", "link": "https://stackoverflow.com/users/894763/jcupitt"}, "edited": false, "score": 0, "creation_date": 1558964833, "post_id": 56327073, "comment_id": 99262229, "body": "Please don&#39;t ask the same question at the same time in many places. It makes unnecessary work for volunteers who are trying to support free software. Duplicate of <a href=\"https://github.com/libvips/ruby-vips/issues/195\" rel=\"nofollow noreferrer\">github.com/libvips/ruby-vips/issues/195</a>"}, {"owner": {"reputation": 14224, "user_id": 433940, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6b9f0021f63ca2fb96c0e50f422e0489?s=128&d=identicon&r=PG", "display_name": "linkyndy", "link": "https://stackoverflow.com/users/433940/linkyndy"}, "reply_to_user": {"reputation": 7702, "user_id": 894763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d013c9681666f0a68a6c1c00ff4d603?s=128&d=identicon&r=PG", "display_name": "jcupitt", "link": "https://stackoverflow.com/users/894763/jcupitt"}, "edited": false, "score": 0, "creation_date": 1558971226, "post_id": 56327073, "comment_id": 99265201, "body": "I had not known where would people offer help regarding this \ud83d\ude0a"}], "owner": {"reputation": 14224, "user_id": 433940, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6b9f0021f63ca2fb96c0e50f422e0489?s=128&d=identicon&r=PG", "display_name": "linkyndy", "link": "https://stackoverflow.com/users/433940/linkyndy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558963761, "creation_date": 1558963761, "question_id": 56327073, "link": "https://stackoverflow.com/questions/56327073/ruby-vips-image-write-to-memory-yields-different-results-in-different-environmen", "title": "Ruby VIPS image.write_to_memory yields different results in different environments", "body": "<p>We need to open an image and write its pixels to memory, so a C library can further process it. We're doing this with the lines below:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>image = Vips::Image.new_from_file(filename)\npixels_pointer = image.write_to_memory\n</code></pre>\n\n<p>However, it seems that what's written in memory differs per environment. We're testing this on a macOS High Sierra and on an Ubuntu Xenial via Docker, with <code>vips-8.8.0</code> and <code>ruby-vips (2.0.13)</code>. We've MD5-ed the result of writing to memory:</p>\n\n<pre><code>p Digest::MD5.hexdigest(pixels_pointer)\n</code></pre>\n\n<p>and here are the outcomes for both:</p>\n\n<ul>\n<li>macOS High Sierra: <code>141e9b6a84f4ca05a7699b33fc0ef808</code></li>\n<li>Ubuntu Xenial via Docker: <code>019a568e40dcc41ac6496da06d29d723</code></li>\n</ul>\n\n<p>I have no clue why this is happening and where shall I look further. Any tip would be highly appreciated!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sidekiq", "ruby-on-rails-5.2", "rspec-sidekiq"], "comments": [{"owner": {"reputation": 3374, "user_id": 461640, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/20199b7748890e8d48375146a4860238?s=128&d=identicon&r=PG", "display_name": "The Lazy Log", "link": "https://stackoverflow.com/users/461640/the-lazy-log"}, "edited": false, "score": 0, "creation_date": 1558967900, "post_id": 56326992, "comment_id": 99263693, "body": "How did you trigger email sending? Did you call <code>SomeMailer.your_email_method.deliver_later</code>?"}, {"owner": {"reputation": 319, "user_id": 1738072, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/91090720a6e4d539526bb446ed76c556?s=128&d=identicon&r=PG", "display_name": "yaswant singh", "link": "https://stackoverflow.com/users/1738072/yaswant-singh"}, "reply_to_user": {"reputation": 3374, "user_id": 461640, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/20199b7748890e8d48375146a4860238?s=128&d=identicon&r=PG", "display_name": "The Lazy Log", "link": "https://stackoverflow.com/users/461640/the-lazy-log"}, "edited": false, "score": 0, "creation_date": 1559017669, "post_id": 56326992, "comment_id": 99276121, "body": "yes i wrote the same in worker with deliver_now"}, {"owner": {"reputation": 5184, "user_id": 1083764, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/e084347ce721f3828d1bcdf1606337ff?s=128&d=identicon&r=PG", "display_name": "SoWhat", "link": "https://stackoverflow.com/users/1083764/sowhat"}, "edited": false, "score": 0, "creation_date": 1559033207, "post_id": 56326992, "comment_id": 99282089, "body": "Where are you checking if its empty. I am assuming its in a spec somewhere. Post the code to that please"}], "owner": {"reputation": 319, "user_id": 1738072, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/91090720a6e4d539526bb446ed76c556?s=128&d=identicon&r=PG", "display_name": "yaswant singh", "link": "https://stackoverflow.com/users/1738072/yaswant-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559017876, "creation_date": 1558963480, "last_edit_date": 1559017876, "question_id": 56326992, "link": "https://stackoverflow.com/questions/56326992/actionmailerbase-deliveries-is-giving-blank-array-when-i-am-using-sidekiq-an", "title": "ActionMailer::Base.deliveries is giving blank array when i am using sidekiq ? any configuration do we need to do for that", "body": "<p>ActionMailer::Base.deliveries are giving blank array  when i am using sidekiq ?\nany configuration do we need to do for that</p>\n\n<p>My test.rb looks like this \nIn development mode it is working fine and even from  test  sidekiq  shows no error.</p>\n\n<pre><code>Rails.application.configure do\n  # Settings specified here will take precedence over those in config/application.rb.\n\n  # The test environment is used exclusively to run your application's\n  # test suite. You never need to work with it otherwise. Remember that\n  # your test database is \"scratch space\" for the test suite and is wiped\n  # and recreated between test runs. Don't rely on the data there!\n  config.cache_classes = true\n\n  # Do not eager load code on boot. This avoids loading your whole application\n  # just for the purpose of running a single test. If you are using a tool that\n  # preloads Rails for running tests, you may have to set it to true.\n  config.eager_load = false\n\n  # Configure public file server for tests with Cache-Control for performance.\n  config.public_file_server.enabled = true\n  config.public_file_server.headers = {\n    'Cache-Control' =&gt; \"public, max-age=#{12.hour.to_i}\"\n  }\n\n  # Show full error reports and disable caching.\n  config.consider_all_requests_local       = true\n  config.action_controller.perform_caching = false\n\n  # Raise exceptions instead of rendering exception templates.\n  config.action_dispatch.show_exceptions = false\n\n  # Disable request forgery protection in test environment.\n  config.action_controller.allow_forgery_protection = false\n\n  # Store uploaded files on the local file system in a temporary directory\n  config.active_storage.service = :test\n\n  config.action_mailer.perform_caching = false\n\n  config.active_job.queue_adapter = :sidekiq\n\n  # Tell Action Mailer not to deliver emails to the real world.\n  # The :test delivery method accumulates sent emails in the\n  # ActionMailer::Base.deliveries array.\n  config.action_mailer.delivery_method = :test\n\n  # Print deprecation notices to the stderr.\n  config.active_support.deprecation = :stderr\n\n  # Raises error for missing translations\n  # config.action_view.raise_on_missing_translations = true\n\n  # Access to rack session\n  config.middleware.use RackSessionAccess::Middleware\n  config.action_mailer.default_url_options = { :host =&gt; \"localhost:3000\" }\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1558963199, "post_id": 56326872, "comment_id": 99261398, "body": "What pairs are you considering? All combinations of 2 elements? Or just adjacent pairs? Also, your subject says &quot;uniq pairs&quot; but your question doesn&#39;t mention unique. Which is it?"}, {"owner": {"reputation": 628, "user_id": 5954643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9tq2jIW1zsk/AAAAAAAAAAI/AAAAAAAABcY/id8Ndc5tWuY/photo.jpg?sz=128", "display_name": "Rajkumar Ulaganadhan", "link": "https://stackoverflow.com/users/5954643/rajkumar-ulaganadhan"}, "edited": false, "score": 0, "creation_date": 1558963272, "post_id": 56326872, "comment_id": 99261432, "body": "All combinations or 2 elements."}, {"owner": {"reputation": 211, "user_id": 8283259, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KtTqL.jpg?s=128&g=1", "display_name": "Junaid Ali", "link": "https://stackoverflow.com/users/8283259/junaid-ali"}, "edited": false, "score": 0, "creation_date": 1558963742, "post_id": 56326872, "comment_id": 99261677, "body": "If you find it helpful. <a href=\"https://stackoverflow.com/questions/35585399/frequency-of-pairs-in-an-array-ruby\" title=\"frequency of pairs in an array ruby\">stackoverflow.com/questions/35585399/&hellip;</a>"}, {"owner": {"reputation": 628, "user_id": 5954643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9tq2jIW1zsk/AAAAAAAAAAI/AAAAAAAABcY/id8Ndc5tWuY/photo.jpg?sz=128", "display_name": "Rajkumar Ulaganadhan", "link": "https://stackoverflow.com/users/5954643/rajkumar-ulaganadhan"}, "edited": false, "score": 0, "creation_date": 1558964484, "post_id": 56326872, "comment_id": 99262067, "body": "added expected output"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1558970596, "post_id": 56326872, "comment_id": 99264929, "body": "The title asks for the <i>number</i> of unique pairs. In the body you ask for a <i>list</i> of such pairs. Which is it? Please show the 9 unique pairs that is the desired result for your example. For example, you say &quot;#no 5(3 pairs)&quot;. What are those 3 pairs?"}, {"owner": {"reputation": 628, "user_id": 5954643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9tq2jIW1zsk/AAAAAAAAAAI/AAAAAAAABcY/id8Ndc5tWuY/photo.jpg?sz=128", "display_name": "Rajkumar Ulaganadhan", "link": "https://stackoverflow.com/users/5954643/rajkumar-ulaganadhan"}, "edited": false, "score": 0, "creation_date": 1559022334, "post_id": 56326872, "comment_id": 99277239, "body": "[1, 1, 3, 3, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6] in this array you can see the pairs list"}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1559028682, "post_id": 56327300, "comment_id": 99279885, "body": "Good answer. OP has edited title so the total number (9) is no longer asked for, so you might write <code>arr.each_with_object(Hash.new(0)) { |e,hash| hash[e] += 1 }.transform_values { |v| v&#47;2 } #=&gt; {4=&gt;2, 5=&gt;3, 6=&gt;2, 1=&gt;1, 3=&gt;1}</code>."}], "tags": [], "owner": {"reputation": 1040, "user_id": 9758920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5397a7b84da492865cb4443b7389b0f6?s=128&d=identicon&r=PG&f=1", "display_name": "claasic", "link": "https://stackoverflow.com/users/9758920/claasic"}, "is_accepted": false, "score": 1, "last_activity_date": 1558968020, "last_edit_date": 1558968020, "creation_date": 1558964755, "answer_id": 56327300, "question_id": 56326872, "link": "https://stackoverflow.com/questions/56326872/how-to-find-the-list-of-pairs-in-an-array-using-ruby/56327300#56327300", "title": "How to find the list of pairs in an array using ruby?", "body": "<pre><code>arr = [4, 5, 5, 5, 6, 6, 4, 1, 4, 4, 3, 6, 6, 3, 6, 1, 4, 5, 5, 5]\nhash = Hash.new(0)\narr.each { |e| hash[e] += 1 }\nhash.values.reduce(0) { |s, n| s += n / 2 } // =&gt; 9\n</code></pre>\n\n<p>Since from what I can gather you are basically removing integers the moment they got paired once so technically it's just an integer division by two. </p>\n\n<p>[1] <a href=\"https://stackoverflow.com/questions/5128200/how-to-count-identical-string-elements-in-a-ruby-array\">How to count identical string elements in a Ruby array</a></p>\n\n<p>[2] <a href=\"https://stackoverflow.com/questions/13882956/reduce-hash-values\">Reduce Hash Values</a></p>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1558967458, "post_id": 56327471, "comment_id": 99263470, "body": "Note that <code>count</code> has to traverse the entire array each time which makes this solution rather inefficient."}], "tags": [], "owner": {"reputation": 628, "user_id": 5954643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9tq2jIW1zsk/AAAAAAAAAAI/AAAAAAAABcY/id8Ndc5tWuY/photo.jpg?sz=128", "display_name": "Rajkumar Ulaganadhan", "link": "https://stackoverflow.com/users/5954643/rajkumar-ulaganadhan"}, "is_accepted": false, "score": 1, "last_activity_date": 1559039476, "last_edit_date": 1559039476, "creation_date": 1558965363, "answer_id": 56327471, "question_id": 56326872, "link": "https://stackoverflow.com/questions/56326872/how-to-find-the-list-of-pairs-in-an-array-using-ruby/56327471#56327471", "title": "How to find the list of pairs in an array using ruby?", "body": "<p>I have done like this, It works</p>\n\n<pre><code>  b = []\n  a.uniq.each { |i| b.push(a.count(i)/2)}\n  b.sum\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": true, "score": 4, "last_activity_date": 1558978995, "creation_date": 1558978995, "answer_id": 56330423, "question_id": 56326872, "link": "https://stackoverflow.com/questions/56326872/how-to-find-the-list-of-pairs-in-an-array-using-ruby/56330423#56330423", "title": "How to find the list of pairs in an array using ruby?", "body": "<p>Here is another option:</p>\n\n<pre><code>a.group_by(&amp;:itself).transform_values{ |v| v.size / 2 }.values.sum\n#=&gt; 9\n</code></pre>\n\n<p><hr>\n<strong>How it works.</strong></p>\n\n<p>First group the elements by value:</p>\n\n<pre><code>a.group_by(&amp;:itself) #=&gt; {4=&gt;[4, 4, 4, 4, 4], 5=&gt;[5, 5, 5, 5, 5, 5], 6=&gt;[6, 6, 6, 6, 6], 1=&gt;[1, 1], 3=&gt;[3, 3]}\n</code></pre>\n\n<p>Then transforming the keys to the pair count:</p>\n\n<pre><code>a.group_by(&amp;:itself).transform_values{ |v| v.size / 2 } #=&gt; {4=&gt;2, 5=&gt;3, 6=&gt;2, 1=&gt;1, 3=&gt;1}\n</code></pre>\n\n<p>So, get the values of the hash:</p>\n\n<pre><code>a.group_by(&amp;:itself).transform_values{ |v| v.size / 2 }.values #=&gt; [2, 3, 2, 1, 1]\n</code></pre>\n\n<p>Finally, sum the values, which is the first line of code posted above.</p>\n"}], "owner": {"reputation": 628, "user_id": 5954643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9tq2jIW1zsk/AAAAAAAAAAI/AAAAAAAABcY/id8Ndc5tWuY/photo.jpg?sz=128", "display_name": "Rajkumar Ulaganadhan", "link": "https://stackoverflow.com/users/5954643/rajkumar-ulaganadhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 875, "favorite_count": 0, "accepted_answer_id": 56330423, "answer_count": 3, "score": -2, "last_activity_date": 1559039476, "creation_date": 1558963019, "last_edit_date": 1559022699, "question_id": 56326872, "link": "https://stackoverflow.com/questions/56326872/how-to-find-the-list-of-pairs-in-an-array-using-ruby", "title": "How to find the list of pairs in an array using ruby?", "body": "<p><strong>Input</strong>: </p>\n\n<pre><code>a = [4, 5, 5, 5, 6, 6, 4, 1, 4, 4, 3, 6, 6, 3, 6, 1, 4, 5, 5, 5]\n</code></pre>\n\n<p>How to list out no of pairs in an array.</p>\n\n<p><strong>Output:</strong></p>\n\n<p><strong>9</strong></p>\n\n<p><strong>Description</strong></p>\n\n<pre><code>#no 1(1 pair)\n#no 3(1 pair)\n#no 4(2 pairs)\n#no 5(3 pairs)\n#no 6(2 pairs)\n#so total 9 pairs\n</code></pre>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 10803, "user_id": 2548147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cfKie.jpg?s=128&g=1", "display_name": "Raymond Nijland", "link": "https://stackoverflow.com/users/2548147/raymond-nijland"}, "edited": false, "score": 0, "creation_date": 1558962173, "post_id": 56326593, "comment_id": 99260874, "body": "Can you post a real <code>SHOW CREATE TABLE drugs</code> output? Some example data and expected results see <a href=\"https://meta.stackoverflow.com/questions/333952/why-should-i-provide-a-minimal-reproducible-example-for-a-very-simple-sql-query\">Why should I provide a Minimal Reproducible Example for a very simple SQL query?</a> for that.. Also debug the ruby on rails so you know the queries as the queries as &quot;obfucated&quot; generated by ActiveRecord? If you know the queries run a <code>EXPLAIN query</code> and also post that here."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9544702, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Seung Joon Park", "link": "https://stackoverflow.com/users/9544702/seung-joon-park"}, "edited": false, "score": 0, "creation_date": 1559010674, "post_id": 56328711, "comment_id": 99274887, "body": "I am guessing it is somewhat related to my searchkick gem, but I am not sure. I cannot find any callbacks in my model."}, {"owner": {"reputation": 33, "user_id": 9544702, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Seung Joon Park", "link": "https://stackoverflow.com/users/9544702/seung-joon-park"}, "edited": false, "score": 0, "creation_date": 1559011806, "post_id": 56328711, "comment_id": 99275054, "body": "Adding a line below solved it! Thanks. Guess it was an callback issue. Searchkick.disable_callbacks"}], "tags": [], "owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "is_accepted": true, "score": 0, "last_activity_date": 1558970249, "creation_date": 1558970249, "answer_id": 56328711, "question_id": 56326593, "link": "https://stackoverflow.com/questions/56326593/updating-json-column-takes-too-long/56328711#56328711", "title": "Updating JSON column takes too long", "body": "<p>Error <code>Faraday::ConnectionFailed</code> suggests that you have an http request somewhere in the update chain (<code>package_insert=</code> setter, model validation or callbacks) that fails with this error. This is also proven by fact that simple update via console gives the same result.</p>\n\n<p>Since error is reproduced by simple <code>obj.update(package_insert: some_json)</code>, it does not relate directly to script you provided. Look into your model, especially <code>before_*</code>/<code>after_*</code>, most probably there's some <code>after_save</code> callback that makes an http request (as a rule of thumb - external requests from model callbacks are generally a bad idea unless you're sure how and why you do them)</p>\n"}], "owner": {"reputation": 33, "user_id": 9544702, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Seung Joon Park", "link": "https://stackoverflow.com/users/9544702/seung-joon-park"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 56328711, "answer_count": 1, "score": 1, "last_activity_date": 1558970249, "creation_date": 1558961886, "last_edit_date": 1558969516, "question_id": 56326593, "link": "https://stackoverflow.com/questions/56326593/updating-json-column-takes-too-long", "title": "Updating JSON column takes too long", "body": "<pre><code>  create_table \"drugs\", options: \"ENGINE=InnoDB DEFAULT CHARSET=utf8\", force: :cascade do |t|\n    t.integer \"item_seq\"\n    t.string \"name\"\n    t.string \"short_description\"\n    t.string \"short_notice\"\n    t.json \"package_insert\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n</code></pre>\n\n<p>I am trying to update my model <code>Drug</code> which is shown above. It has around 50,000 rows of data and I am using ruby code to update the items in the model using the data I am getting from separate api server.\nThe column I am trying to update is <code>package_insert</code> which has the type <code>json</code>.\nI am only trying to update certain keys of the <code>package_insert(BAR_CODE, EDI_CODE)</code>.</p>\n\n<p>The problem I am having is that I cannot update multiple rows because it throws an error after performing commit on the first row.</p>\n\n<p>The ruby code is shown below.</p>\n\n<pre><code>require 'json'\nrequire 'net/http'\nrequire 'active_support/core_ext/hash'\n\nfor i in 1..501\n    response = Net::HTTP.get_response(URI.parse(ENV[\"API_SERVER\"])).body\n    hashed_response = Hash.from_xml(response)\n    hashed_response['response']['body']['items']['item'].each do |item|\n        #select drug to be updated\n        drug_to_change = Drug.find_by(item_seq: item['ITEM_SEQ'])\n        unless drug_to_change.nil?\n            package = JSON.parse(drug_to_change.package_insert)\n            package['DRB_ITEM']['BAR_CODE'] = item['BAR_CODE']\n            if !item['EDI_CODE'].nil?\n                package['DRB_ITEM']['EDI_CODE'] = item['EDI_CODE']\n            end\n\n            drug_to_change.update(package_insert: package.to_json)\n        else\n            new_item = Drug.new\n            new_item.item_seq = item['ITEM_SEQ']\n            new_item.name = item['ITEM_NAME']\n            #update\n            a = Hash.new\n            a[\"DRB_ITEM\"] = item\n            new_item.save\n        end\n    end\nend\n</code></pre>\n\n<p>when I run</p>\n\n<pre><code># terminal\nbin/rails runner lib/file_name.rb\n# result\nRunning via Spring preloader in process 51929\nTraceback (most recent call last):\n        85: from -e:1:in `&lt;main&gt;'\n        84: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n        83: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/site_ruby/2.5.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n        82: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.2.2/lib/active_support/dependencies.rb:285:in `load'\n        81: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.2.2/lib/active_support/dependencies.rb:257:in `load_dependency'\n        80: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.2.2/lib/active_support/dependencies.rb:285:in `block in load'\n        79: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:50:in `load'\n        78: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:50:in `load'\n        77: from /Users/jamie/Desktop/test_branch/bin/rails:9:in `&lt;main&gt;'\n        76: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.2.2/lib/active_support/dependencies.rb:291:in `require'\n        75: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.2.2/lib/active_support/dependencies.rb:257:in `load_dependency'\n        74: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.2.2/lib/active_support/dependencies.rb:291:in `block in require'\n        73: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:29:in `require'\n        72: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:20:in `require_with_bootsnap_lfi'\n        71: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/loaded_features_index.rb:65:in `register'\n        70: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `block in require_with_bootsnap_lfi'\n        69: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `require'\n        68: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.2.2/lib/rails/commands.rb:18:in `&lt;main&gt;'\n        67: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.2.2/lib/rails/command.rb:46:in `invoke'\n        66: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.2.2/lib/rails/command/base.rb:65:in `perform'\n        65: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'\n        64: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'\n        63: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'\n        62: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/railties-5.2.2/lib/rails/commands/runner/runner_command.rb:38:in `perform'\n        61: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:55:in `load'\n        60: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:55:in `load'\n        59: from /Users/jamie/Desktop/test_branch/lib/renew_all.rb:5:in `&lt;main&gt;'\n        58: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.2.2/lib/active_support/core_ext/range/each.rb:9:in `each'\n        57: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.2.2/lib/active_support/core_ext/range/each.rb:9:in `each'\n        56: from /Users/jamie/Desktop/test_branch/lib/renew_all.rb:9:in `block in &lt;main&gt;'\n        55: from /Users/jamie/Desktop/test_branch/lib/renew_all.rb:9:in `each'\n        54: from /Users/jamie/Desktop/test_branch/lib/renew_all.rb:17:in `block (2 levels) in &lt;main&gt;'\n        53: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activerecord-5.2.2/lib/active_record/persistence.rb:424:in `update'\n        52: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activerecord-5.2.2/lib/active_record/transactions.rb:385:in `with_transaction_returning_status'\n        51: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activerecord-5.2.2/lib/active_record/transactions.rb:212:in `transaction'\n        50: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activerecord-5.2.2/lib/active_record/connection_adapters/abstract/database_statements.rb:259:in `transaction'\n        49: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activerecord-5.2.2/lib/active_record/connection_adapters/abstract/transaction.rb:236:in `within_new_transaction'\n        48: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/2.5.0/monitor.rb:226:in `mon_synchronize'\n        47: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activerecord-5.2.2/lib/active_record/connection_adapters/abstract/transaction.rb:252:in `block in within_new_transaction'\n        46: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activerecord-5.2.2/lib/active_record/connection_adapters/abstract/transaction.rb:213:in `commit_transaction'\n        45: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/2.5.0/monitor.rb:226:in `mon_synchronize'\n        44: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activerecord-5.2.2/lib/active_record/connection_adapters/abstract/transaction.rb:223:in `block in commit_transaction'\n        43: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activerecord-5.2.2/lib/active_record/connection_adapters/abstract/transaction.rb:128:in `commit_records'\n        42: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activerecord-5.2.2/lib/active_record/transactions.rb:346:in `committed!'\n        41: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.2.2/lib/active_support/callbacks.rb:816:in `_run_commit_callbacks'\n        40: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.2.2/lib/active_support/callbacks.rb:133:in `run_callbacks'\n        39: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.2.2/lib/active_support/callbacks.rb:517:in `invoke_after'\n        38: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.2.2/lib/active_support/callbacks.rb:517:in `each'\n        37: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.2.2/lib/active_support/callbacks.rb:517:in `block in invoke_after'\n        36: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.2.2/lib/active_support/callbacks.rb:261:in `block in conditional'\n        35: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.2.2/lib/active_support/callbacks.rb:426:in `block in make_lambda'\n        34: from /Users/jamie/searchkick_forked/lib/searchkick/model.rb:78:in `reindex'\n        33: from /Users/jamie/searchkick_forked/lib/searchkick/record_indexer.rb:51:in `reindex'\n        32: from /Users/jamie/searchkick_forked/lib/searchkick/record_indexer.rb:74:in `reindex_record'\n        31: from /Users/jamie/searchkick_forked/lib/searchkick/logging.rb:27:in `store'\n        30: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.2.2/lib/active_support/notifications.rb:168:in `instrument'\n        29: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.2.2/lib/active_support/notifications/instrumenter.rb:23:in `instrument'\n        28: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/activesupport-5.2.2/lib/active_support/notifications.rb:168:in `block in instrument'\n        27: from /Users/jamie/searchkick_forked/lib/searchkick/logging.rb:28:in `block in store'\n        26: from /Users/jamie/searchkick_forked/lib/searchkick/index.rb:125:in `store'\n        25: from /Users/jamie/searchkick_forked/lib/searchkick/bulk_indexer.rb:43:in `bulk_index'\n        24: from /Users/jamie/searchkick_forked/lib/searchkick/indexer.rb:11:in `queue'\n        23: from /Users/jamie/searchkick_forked/lib/searchkick/logging.rb:126:in `perform'\n        22: from /Users/jamie/searchkick_forked/lib/searchkick/indexer.rb:18:in `perform'\n        21: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/elasticsearch-api-6.1.0/lib/elasticsearch/api/actions/bulk.rb:95:in `bulk'\n        20: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/elasticsearch-transport-6.1.0/lib/elasticsearch/transport/client.rb:131:in `perform_request'\n        19: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/elasticsearch-transport-6.1.0/lib/elasticsearch/transport/transport/http/faraday.rb:20:in `perform_request'\n        18: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/elasticsearch-transport-6.1.0/lib/elasticsearch/transport/transport/base.rb:266:in `perform_request'\n        17: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/elasticsearch-transport-6.1.0/lib/elasticsearch/transport/transport/http/faraday.rb:23:in `block in perform_request'\n        16: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/faraday-0.15.4/lib/faraday/connection.rb:387:in `run_request'\n        15: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/faraday-0.15.4/lib/faraday/rack_builder.rb:143:in `build_response'\n        14: from /Users/jamie/searchkick_forked/lib/searchkick/middleware.rb:9:in `call'\n        13: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/faraday_middleware-aws-sigv4-0.2.4/lib/faraday_middleware/request/aws_sigv4.rb:15:in `call'\n        12: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/faraday-0.15.4/lib/faraday/adapter/net_http.rb:38:in `call'\n        11: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/faraday-0.15.4/lib/faraday/adapter/net_http.rb:92:in `with_net_http_connection'\n        10: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/faraday-0.15.4/lib/faraday/adapter/net_http.rb:43:in `block in call'\n         9: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0/gems/faraday-0.15.4/lib/faraday/adapter/net_http.rb:87:in `perform_request'\n         8: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/2.5.0/net/http.rb:1455:in `request'\n         7: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/2.5.0/net/http.rb:909:in `start'\n         6: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/2.5.0/net/http.rb:920:in `do_start'\n         5: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/2.5.0/net/http.rb:935:in `connect'\n         4: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/2.5.0/timeout.rb:103:in `timeout'\n         3: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/2.5.0/timeout.rb:93:in `block in timeout'\n         2: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/2.5.0/net/http.rb:937:in `block in connect'\n         1: from /Users/jamie/.rbenv/versions/2.5.3/lib/ruby/2.5.0/net/http.rb:937:in `open'\n/Users/jamie/.rbenv/versions/2.5.3/lib/ruby/2.5.0/net/http.rb:937:in `initialize': execution expired (Faraday::ConnectionFailed)\n</code></pre>\n\n<p>Same code in rails console results:</p>\n\n<pre><code>irb(main):017:0&gt;drug_to_change.update(package_insert: package.to_json)\n   (17.2ms)  BEGIN\n   (0.3ms)  COMMIT\n  Drug Store (30237.8ms)  {\"id\":1,\"exception\":[\"Faraday::ConnectionFailed\",\"execution expired\"],\"exception_object\":\"execution expired\"}\nTraceback (most recent call last):\n        1: from (irb):17\nFaraday::ConnectionFailed (execution expired)\n</code></pre>\n\n<p>I am guessing the problem is due to mysql commit taking too long. How can I solve this issue? Thanks in advance.</p>\n\n<pre><code>SHOW CREATE TABLE drugs;\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/GFj7L.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GFj7L.png\" alt=\"show create tabel result\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activeadmin"], "answers": [{"comments": [{"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "edited": false, "score": 0, "creation_date": 1558979546, "post_id": 56326915, "comment_id": 99268087, "body": "this not changing label of page"}, {"owner": {"reputation": 627, "user_id": 10895713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GTs8n.jpg?s=128&g=1", "display_name": "Max Vinicius", "link": "https://stackoverflow.com/users/10895713/max-vinicius"}, "reply_to_user": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "edited": false, "score": 0, "creation_date": 1558982491, "post_id": 56326915, "comment_id": 99269013, "body": "I&#39;ve Updated the answer."}], "tags": [], "owner": {"reputation": 627, "user_id": 10895713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GTs8n.jpg?s=128&g=1", "display_name": "Max Vinicius", "link": "https://stackoverflow.com/users/10895713/max-vinicius"}, "is_accepted": true, "score": 1, "last_activity_date": 1558982326, "last_edit_date": 1558982326, "creation_date": 1558963184, "answer_id": 56326915, "question_id": 56326437, "link": "https://stackoverflow.com/questions/56326437/how-to-change-page-heading-in-activeadmin/56326915#56326915", "title": "How to change page heading in activeadmin", "body": "<p>To change the name of the label in the menu:</p>\n\n<pre><code>ActiveAdmin.register User do\n  index title: \"My custom Title\"\nend\n</code></pre>\n\n<p>Source: <a href=\"https://activeadmin.info/2-resource-customization.html#customize-the-namespace\" rel=\"nofollow noreferrer\">https://activeadmin.info/2-resource-customization.html#customize-the-namespace</a></p>\n"}, {"tags": [], "owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "is_accepted": false, "score": 1, "last_activity_date": 1559011107, "creation_date": 1559011107, "answer_id": 56334338, "question_id": 56326437, "link": "https://stackoverflow.com/questions/56326437/how-to-change-page-heading-in-activeadmin/56334338#56334338", "title": "How to change page heading in activeadmin", "body": "<p>Use translations to override labels and page titles for actions. You can read more in <a href=\"https://activeadmin.info/2-resource-customization.html#renaming-action-items\" rel=\"nofollow noreferrer\">docs</a></p>\n\n<pre><code>en:\n  active_admin:\n    resources:\n      experience: # Registered resource\n        new_model: 'Get new experience'\n</code></pre>\n"}], "owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "closed_date": 1559030131, "accepted_answer_id": 56326915, "answer_count": 2, "score": -3, "last_activity_date": 1559011107, "creation_date": 1558961287, "question_id": 56326437, "link": "https://stackoverflow.com/questions/56326437/how-to-change-page-heading-in-activeadmin", "closed_reason": "Not suitable for this site", "title": "How to change page heading in activeadmin", "body": "<p>I want to change the titles of page as shown in diagram below.\n<a href=\"https://i.stack.imgur.com/pryOB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pryOB.png\" alt=\"enter image description here\"></a></p>\n\n<p>How can I change that?</p>\n"}, {"tags": ["ruby", "twitter", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1558963723, "creation_date": 1558963723, "answer_id": 56327060, "question_id": 56326050, "link": "https://stackoverflow.com/questions/56326050/rails5-how-one-can-exclude-retweet-and-replies-from-search-api/56327060#56327060", "title": "rails5: How one can exclude retweet and replies from search api?", "body": "<p>You tweet's have methods to check for both so you should be able to simply do</p>\n\n<pre><code>tweets.reject{|tweet| tweet.retweeted_tweet? || tweet.reply? }\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 9300153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0534f6a813fd8264d1263ec05345544d?s=128&d=identicon&r=PG&f=1", "display_name": "Praful Patel", "link": "https://stackoverflow.com/users/9300153/praful-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1558963723, "creation_date": 1558959941, "last_edit_date": 1558960086, "question_id": 56326050, "link": "https://stackoverflow.com/questions/56326050/rails5-how-one-can-exclude-retweet-and-replies-from-search-api", "title": "rails5: How one can exclude retweet and replies from search api?", "body": "<p>I am trying to fetch tweets using API, but i don't want any retweets and replies. By research i came up with solution that \"-is:retweet\" and \"-is:reply\" operators can be used to exclude retweets and replies.</p>\n\n<p>I am simply using search query </p>\n\n<pre><code>tweets = client.user_timeline('userName', count: 20)\n</code></pre>\n\n<p>As, I am new to rails and twitter api, i don't how to use both the given operators in search query.</p>\n\n<p>Even any alternative answers would be appreciable.</p>\n"}, {"tags": ["javascript", "html", "ruby-on-rails", "ruby", "ajax"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1558958302, "post_id": 56325330, "comment_id": 99258800, "body": "Is this typo or real code <code>&#47;courses&#47;:id&#47;lessons&#47;:id&#47;viewed</code> ?"}, {"owner": {"reputation": 1, "user_id": 11561884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b09587174e8afabe300cde8fa99aeb5d?s=128&d=identicon&r=PG&f=1", "display_name": "newbierailsdeveloper", "link": "https://stackoverflow.com/users/11561884/newbierailsdeveloper"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1558958319, "post_id": 56325330, "comment_id": 99258816, "body": "@\u0417\u0435\u043b\u0451\u043d\u044b\u0439 the real code"}, {"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 2, "creation_date": 1558958422, "post_id": 56325330, "comment_id": 99258866, "body": "so you&#39;re missing ids in the url  <code>&#47;courses&#47;:id&#47;lessons&#47;:id&#47;viewed</code> you should pass ids of actual records in database, for example <code>&#47;courses&#47;1&#47;lessons&#47;2&#47;viewed</code>, also you can&#39;t have two same anchors in the url <code>&#47;courses&#47;:id&#47;lessons&#47;:id&#47;viewed</code>. Read more <a href=\"https://guides.rubyonrails.org/routing.html\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/routing.html</a>"}, {"owner": {"reputation": 361, "user_id": 4650646, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UbaGd.jpg?s=128&g=1", "display_name": "MUHAMMAD SOBAN", "link": "https://stackoverflow.com/users/4650646/muhammad-soban"}, "edited": false, "score": 0, "creation_date": 1558959428, "post_id": 56325330, "comment_id": 99259420, "body": "also this is wrong <code>courses&#47;:id&#47;lessons&#47;:id&#47;viewed</code>,  two parameters can&#39;t have same name.  you can change it to this: <code>courses&#47;:course_id&#47;lessons&#47;:id&#47;viewed</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1165, "user_id": 6945452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f194d5802eb275d75a6c1af397534a?s=128&d=identicon&r=PG", "display_name": "Kamal Pandey", "link": "https://stackoverflow.com/users/6945452/kamal-pandey"}, "is_accepted": false, "score": 0, "last_activity_date": 1558960915, "creation_date": 1558960915, "answer_id": 56326339, "question_id": 56325330, "link": "https://stackoverflow.com/questions/56325330/ajax-doesnt-update-attribute-in-database/56326339#56326339", "title": "Ajax doesn&#39;t update attribute in database", "body": "<p>convert</p>\n\n<pre><code>patch 'courses/:id/lessons/:id/viewed' =&gt; 'lessons#viewed'\n</code></pre>\n\n<p>to</p>\n\n<pre><code>patch 'courses/:course_id/lessons/:id/viewed' =&gt; 'lessons#viewed'\n</code></pre>\n\n<p>and</p>\n\n<pre><code>$('#video').onended(function() {\n  $.ajax({\n    url: '/courses/:id/lessons/:id/viewed',\n    type: 'patch'\n });\n});\n</code></pre>\n\n<p>to</p>\n\n<pre><code>const data = { course_id: \"\", lesson_id: \"\" }\n\n$('#video').onended(function() {\n\n  $.ajax({\n    url: '/courses/:course_id/lessons/:id/viewed',\n    type: 'patch',\n    data: data\n });\n});\n</code></pre>\n\n<p>and</p>\n\n<pre><code>def viewed\n  @lesson = Lesson.find(params[:id])\n  @lesson.update_attribute(:viewed, true)\nend\n</code></pre>\n\n<p>to</p>\n\n<pre><code>def viewed\n  @lesson = Lesson.find(params[:data][:lesson_id])\n  @lesson.update_attribute(:viewed, true)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "is_accepted": false, "score": 0, "last_activity_date": 1558962343, "last_edit_date": 1558962343, "creation_date": 1558961979, "answer_id": 56326619, "question_id": 56325330, "link": "https://stackoverflow.com/questions/56325330/ajax-doesnt-update-attribute-in-database/56326619#56326619", "title": "Ajax doesn&#39;t update attribute in database", "body": "<p>I would do something like this:</p>\n\n<p>routes.rb</p>\n\n<pre><code>resources :lessons do\n  member do\n    patch :viewed\n  end\nend\n</code></pre>\n\n<ul>\n<li>use rails helpers, it will help you have consistency on the order of the segments, the variables, named_routes, etc</li>\n</ul>\n\n<p>show.html</p>\n\n<pre><code>&lt;h2&gt;&lt;%= @lesson.name %&gt;&lt;/h2&gt;\n&lt;div id=\"video\" data-viewed-url=\"&lt;%= viewed_lesson_path(@lesson) %&gt;\"&gt;\n  &lt;video controls=\"true\" width=\"auto\" height=\"auto\"&gt;\n    &lt;source src=\"&lt;%= url_for(@lesson.file) %&gt;\" type='video/mp4'&gt;\n  &lt;/video&gt;\n&lt;/div&gt;\n</code></pre>\n\n<ul>\n<li>I'm passing the URL as a data attribute of the <code>#video</code> element so I don't have to mess with URLs with javascript, let rails handle these things, it's really good at it</li>\n</ul>\n\n<p>js</p>\n\n<pre><code>$('#video').onended(function() {\n  $.ajax({\n    url: this.dataset.viewedUrl,\n    type: 'patch'\n });\n});\n</code></pre>\n\n<ul>\n<li>get the URL from the element's data attribute</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "is_accepted": false, "score": 0, "last_activity_date": 1558961990, "creation_date": 1558961990, "answer_id": 56326621, "question_id": 56325330, "link": "https://stackoverflow.com/questions/56325330/ajax-doesnt-update-attribute-in-database/56326621#56326621", "title": "Ajax doesn&#39;t update attribute in database", "body": "<p>First, let's fix the route:</p>\n\n<pre><code>path \"/lessons/:id/viewed\" =&gt; \"lessons#viewed\", as: :lesson_viewed\n</code></pre>\n\n<p>We don't need course's id if it is a named route unless we're actually doing something useful with that information.</p>\n\n<p>I would recommend you to add a <code>data</code> attribute in your erb to specify the route to call </p>\n\n<pre><code>&lt;h2&gt;&lt;%= @lesson.name %&gt;&lt;/h2&gt;\n\n&lt;div id=\"video\" data-lesson-viewed-url=\"&lt;%= lesson_viewed_url(@lesson.id) %&gt;\"&gt;\n\n  &lt;video controls=\"true\" width=\"auto\" height=\"auto\"&gt;\n    &lt;source src=\"&lt;%= url_for(@lesson.file) %&gt;\" type='video/mp4'&gt;\n  &lt;/video&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Notice the change in <code>&lt;div id=\"video\" data-lesson-viewed-url=\"&lt;%= lesson_viewed_url(@lesson.id) %&gt;\"&gt;</code> line.</p>\n\n<p>Now Ajax can simply call that route:</p>\n\n<pre><code>$('#video').onended(function() {\n  $.ajax({\n    url: $('#video').data(\"lesson-viewed-url\"),\n    type: 'patch' // Can move the HTTP verb to data attribute as well, leaving this upto the implementor for now\n });\n});\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11561884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b09587174e8afabe300cde8fa99aeb5d?s=128&d=identicon&r=PG&f=1", "display_name": "newbierailsdeveloper", "link": "https://stackoverflow.com/users/11561884/newbierailsdeveloper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1558962343, "creation_date": 1558957158, "question_id": 56325330, "link": "https://stackoverflow.com/questions/56325330/ajax-doesnt-update-attribute-in-database", "title": "Ajax doesn&#39;t update attribute in database", "body": "<p>Ajax does not update the viewed attribute after a lesson has been fully watched.</p>\n\n<p>application.js:</p>\n\n<pre><code>$('#video').onended(function() {\n  $.ajax({\n    url: '/courses/:id/lessons/:id/viewed',\n    type: 'patch'\n });\n});\n</code></pre>\n\n<p>lessons controller;</p>\n\n<pre><code>def viewed\n  @lesson = Lesson.find(params[:id])\n  @lesson.update_attribute(:viewed, true)\nend\n</code></pre>\n\n<p>lessons/show.html.erb:</p>\n\n<pre><code>&lt;h2&gt;&lt;%= @lesson.name %&gt;&lt;/h2&gt;\n&lt;div id=\"video\"&gt;\n&lt;video controls=\"true\" width=\"auto\" height=\"auto\"&gt;\n  &lt;source src=\"&lt;%= url_for(@lesson.file) %&gt;\" type='video/mp4'&gt;\n&lt;/video&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>config/routes.rb:</p>\n\n<pre><code>patch 'courses/:id/lessons/:id/viewed' =&gt; 'lessons#viewed'\n</code></pre>\n\n<p>add_view_to_lessons migration:</p>\n\n<pre><code>def change\n  add_column :lessons, :viewed, :boolean\nend\n</code></pre>\n"}, {"tags": ["ruby", "installation", "sha"], "answers": [{"tags": [], "owner": {"reputation": 142, "user_id": 1958020, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0FWpb.jpg?s=128&g=1", "display_name": "Greco", "link": "https://stackoverflow.com/users/1958020/greco"}, "is_accepted": false, "score": 0, "last_activity_date": 1558957582, "last_edit_date": 1558957582, "creation_date": 1558956814, "answer_id": 56325254, "question_id": 56324918, "link": "https://stackoverflow.com/questions/56324918/how-can-i-use-the-shas-on-installing-ruby-whats-the-risk-if-i-dont-verify-t/56325254#56325254", "title": "How can I use the SHA&#39;s on installing Ruby ? What&#39;s the risk if I don&#39;t verify them?", "body": "<p>To prevent <a href=\"https://en.wikipedia.org/wiki/Tamper-evident_technology#Tampering\" rel=\"nofollow noreferrer\">tampering</a> (but if the download is through http<strong>s</strong> you are safe).</p>\n\n<p>Theory is pretty well introduced <a href=\"https://security.stackexchange.com/questions/43332/how-can-i-check-the-integrity-of-the-downloaded-files\">here</a>.</p>\n\n<p>Hands on side, in short, you need to execute $>sha1sum my_file.exe in PowerShell, and check if the hash is the expected one.</p>\n\n<p><a href=\"https://imgur.com/q3yYVXO\" rel=\"nofollow noreferrer\">https://imgur.com/q3yYVXO</a></p>\n"}], "owner": {"reputation": 11, "user_id": 11016522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b6281cb7ea754e033067c7f78265b69?s=128&d=identicon&r=PG&f=1", "display_name": "MaxRoc", "link": "https://stackoverflow.com/users/11016522/maxroc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1558957582, "creation_date": 1558955381, "question_id": 56324918, "link": "https://stackoverflow.com/questions/56324918/how-can-i-use-the-shas-on-installing-ruby-whats-the-risk-if-i-dont-verify-t", "title": "How can I use the SHA&#39;s on installing Ruby ? What&#39;s the risk if I don&#39;t verify them?", "body": "<p>I'm installing Ruby (in order to eventually be able to use Redmine) on my Win 10 laptop. </p>\n\n<p>I realize how critical the whole install process is and I'm wondering if there are real threats not to check the various SHA given there : <a href=\"https://www.ruby-lang.org/en/news/2015/04/13/ruby-2-2-2-released/\" rel=\"nofollow noreferrer\">https://www.ruby-lang.org/en/news/2015/04/13/ruby-2-2-2-released/</a>.</p>\n\n<p>I guess it's needed if you don't trust the source you're downloading from, but I found it through my usual search engine (ie qwant).</p>\n\n<p>If this verification is really a must-do, how can I do it ? </p>\n\n<p>One of the SHA's given is :</p>\n\n<pre><code>SHA1:   7d26835cb7711dfe75f2c10fe38cb85f5ed56df5\n</code></pre>\n\n<p>I'm on Win 10, so I picked one from the .zip list.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 69, "user_id": 11508004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/189065c023573eb7ae8f372717402ad4?s=128&d=identicon&r=PG&f=1", "display_name": "Neil D&#39;souza", "link": "https://stackoverflow.com/users/11508004/neil-dsouza"}, "edited": false, "score": 0, "creation_date": 1558953166, "post_id": 56324118, "comment_id": 99256281, "body": "Without seeing the code for <i>read_integer_in_range(&quot;Select Genre: &quot;, 0,9)</i>, seems like that is where the issue might be"}, {"owner": {"reputation": 9, "user_id": 11561383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae67afdfe746f2ba43e416c589062ee8?s=128&d=identicon&r=PG&f=1", "display_name": "Soran", "link": "https://stackoverflow.com/users/11561383/soran"}, "reply_to_user": {"reputation": 69, "user_id": 11508004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/189065c023573eb7ae8f372717402ad4?s=128&d=identicon&r=PG&f=1", "display_name": "Neil D&#39;souza", "link": "https://stackoverflow.com/users/11508004/neil-dsouza"}, "edited": false, "score": 0, "creation_date": 1558954150, "post_id": 56324118, "comment_id": 99256735, "body": "@NeilD&#39;souza just now I add the read_integer_in_range function."}], "answers": [{"tags": [], "owner": {"reputation": 69, "user_id": 11508004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/189065c023573eb7ae8f372717402ad4?s=128&d=identicon&r=PG&f=1", "display_name": "Neil D&#39;souza", "link": "https://stackoverflow.com/users/11508004/neil-dsouza"}, "is_accepted": true, "score": 0, "last_activity_date": 1559042026, "creation_date": 1559042026, "answer_id": 56340946, "question_id": 56324118, "link": "https://stackoverflow.com/questions/56324118/there-is-data-conversion-error-in-my-text-based-music-player-program/56340946#56340946", "title": "There is data conversion error in my text_based music player program", "body": "<p>So I think your read_integer(prompt) function should be something like this ...</p>\n\n<pre><code>def read_integer(prompt)\n  print(prompt)\n  gets.strip().to_i\nend\n</code></pre>\n\n<p>gets.strip() -> this will return a string like for eg. \"2\"</p>\n\n<p>\"2\".to_i -> this then converts from a String to an Integer</p>\n\n<p>This should return an Integer and then you are off to the races.</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 9, "user_id": 11561383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae67afdfe746f2ba43e416c589062ee8?s=128&d=identicon&r=PG&f=1", "display_name": "Soran", "link": "https://stackoverflow.com/users/11561383/soran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 1, "accepted_answer_id": 56340946, "answer_count": 1, "score": 0, "last_activity_date": 1559042026, "creation_date": 1558952390, "last_edit_date": 1558954100, "question_id": 56324118, "link": "https://stackoverflow.com/questions/56324118/there-is-data-conversion-error-in-my-text-based-music-player-program", "title": "There is data conversion error in my text_based music player program", "body": "<p>In the function read_genre Which display the available genre in a list (that I defined 9 different genres inside $genre_name =[] outside of the function) and prompt the user to select a genre by using a case statement and then read in the genre number that user entered a number. The read_genre function is called from the read_album function and then printout in print_album function.</p>\n\n<p>The problem is that after I run the program in the terminal when I prompt to select a genre and entered the number and I get an error  'no implicit conversion from nil to integer (typeError).</p>\n\n<p>I tried by changing the conversion type to to_i(int) and still get the error. </p>\n\n<pre><code>module Genre\n  POP, CLASSIC, JAZZ, ROCK, KPOP, METAL, PUNK, ROMANCE, LATIN = *1..9\nend\n\n$genre_names = ['Null','Pop', 'Classic', 'Jazz', 'Rock', 'KPop', 'Metal', 'Punk', 'Romance', 'Latin']\n\nclass Album\n    attr_accessor :title, :artist, :genre\n\n    def initialize (title, artist, genre)\n        @title = title\n        @artist = artist\n        @genre = genre\n    end\nend\n\n# Display the genre names in a\n# numbered list and ask the user to select one\ndef read_genre()\n    length = $genre_names.length\n    index = 0\n    print $genre_names\n  while (index &lt; length)\n    select_genre = read_integer_in_range(\"Select Genre: \", 0,9)\n        case select_genre\n        when 1\n        puts \"#{index + 1} \" + $genre_names[1]\n        break\n        when 2\n        puts \"#{index + 2 } \" + $genre_names[2]\n        break\n        when 3\n        puts \"#{index + 3} \" + $genre_names[3]\n        break\n        when 4\n        puts \"#{index + 4} \" + $genre_names[4]\n        break\n        when 5\n        puts \"#{index + 5} \" + $genre_names[5]\n        break\n        when 6\n        puts \"#{index + 6} \" + $genre_names[6]\n        break\n        when 7\n        puts \"#{index + 7} \" + $genre_names[7]\n        break\n        when 8\n        puts \"#{index + 8} \" + $genre_names[8]\n        break\n        when 9\n        puts \"#{index + 9} \" + $genre_names[9]\n        break\n         else\n          puts 'Please Select again'\n          break \n        end\n\n    end\n\nend\n\n\ndef read_album\n  album_title = read_string(\"Enter Title: \")\n  album_artist = read_string(\"Enter Artist name: \")\n  album_genre = read_genre()\n  album = Album.new(album_title, album_artist, album_genre)\n  album\nend\n\ndef print_album album\n    puts ' Album information is: '\n    puts \"Title is #{album.title}\"\n    puts \"Artist is #{album.artist}\"\n    puts 'Genre is ' + album.genre.to_s\n    puts $genre_names[album.genre]\n\nend\n\ndef read_integer_in_range(prompt, min, max)\n    value = read_integer(prompt)\n    while (value &lt; min or value &gt; max)\n        puts \"Please enter a value between \" + min.to_s + \" and \" + max.to_s + \": \"\n        value = read_integer(prompt);\n    end\n    value\nend\n\ndef main\n  puts \"Welcome to the music player\"\n    album = read_album()\n    print_album(album)\nend\n\nmain\n\n</code></pre>\n\n<p>When I entered the number for the specific genre index. for example, if I entered 2 it must display Classic because it is in index 2 in $genre_names variable.</p>\n"}, {"tags": ["ruby", "ubuntu", "cron", "rubygems"], "owner": {"reputation": 97, "user_id": 1929351, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a5844b0443f7f3073e88aa4fe884b635?s=128&d=identicon&r=PG", "display_name": "staskjs", "link": "https://stackoverflow.com/users/1929351/staskjs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 183, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1558952954, "creation_date": 1558949800, "last_edit_date": 1558952954, "question_id": 56323407, "link": "https://stackoverflow.com/questions/56323407/running-bundle-exec-rake-inside-cron-cannot-find-specific-version-of-rake", "title": "Running bundle exec rake inside cron cannot find specific version of rake", "body": "<p>I am setting up cron to run some rake tasks for my ruby on rails server. They are generated by whenever and look like this:\n<code>* * * * * /bin/bash -l -c 'cd /var/www &amp;&amp; RAILS_ENV=production /usr/local/bin/bundle exec /usr/local/bin/rake my:task --silent &gt;&gt; /var/www/log/cron.log 2&gt;&amp;1'</code></p>\n\n<p><code>bundle</code> and <code>rake</code> executables seem to be found, but inside cron.log I find this error:</p>\n\n<pre><code>bundler: failed to load command: /usr/local/bin/rake (/usr/local/bin/rake)\nBundler::GemNotFound: Could not find rake-12.3.2 in any of the sources\n/usr/local/lib/ruby/gems/2.5.0/gems/bundler-1.16.6/lib/bundler/spec_set.rb:91:in `block in materialize'\n...\n...\n</code></pre>\n\n<p>As I can see it tried to load rake-12.3.2, which is a correct version, from <code>/usr/local/lib/ruby/gems/2.5.0/gems</code>, which is not a correct path, because there is no rake-12.3.2. Correct version of rake is under another path <code>/usr/local/bundle/gems</code>, but I have no luck setting this path for cron to use.</p>\n\n<p>I have tried adding <code>GEM_PATH=\"/usr/local/bundle/gems\"</code> to cron file, but it doesn't work.</p>\n\n<p>I am not using rvm or rbenv, ruby is installed directly.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "secure-random"], "answers": [{"tags": [], "owner": {"reputation": 14111, "user_id": 5783745, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/Z5VSF.jpg?s=128&g=1", "display_name": "stevec", "link": "https://stackoverflow.com/users/5783745/stevec"}, "is_accepted": false, "score": 1, "last_activity_date": 1558947776, "creation_date": 1558947776, "answer_id": 56322854, "question_id": 56322575, "link": "https://stackoverflow.com/questions/56322575/appropriate-securerandom-method-for-api-token-for-use-in-url/56322854#56322854", "title": "Appropriate SecureRandom method for API token for use in URL?", "body": "<pre><code>SecureRandom.urlsafe_base64\n</code></pre>\n\n<p>Documentation <a href=\"http://ruby-doc.org/stdlib-1.9.3/libdoc/securerandom/rdoc/SecureRandom.html#method-c-urlsafe_base64\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 14111, "user_id": 5783745, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/Z5VSF.jpg?s=128&g=1", "display_name": "stevec", "link": "https://stackoverflow.com/users/5783745/stevec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558947776, "creation_date": 1558946734, "question_id": 56322575, "link": "https://stackoverflow.com/questions/56322575/appropriate-securerandom-method-for-api-token-for-use-in-url", "title": "Appropriate SecureRandom method for API token for use in URL?", "body": "<p>I am aware that SecureRandom (ruby on rails) offers multiple methods for generating tokens</p>\n\n<p>Is there some method that is designed for urls? </p>\n\n<p>e.g. </p>\n\n<pre><code>SecureRandom.hex(32)\n</code></pre>\n\n<pre><code>SecureRandom.base64(20)\n</code></pre>\n\n<p>etc</p>\n\n<p>The main reason I ask is to ensure I don't accidentally generate tokens with characters that are illegal in urls. Ultimately I need to generate tokens of the same length that are safe in urls</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku-postgres"], "comments": [{"owner": {"reputation": 442, "user_id": 8500089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YIT6I.jpg?s=128&g=1", "display_name": "Rasna Shakya", "link": "https://stackoverflow.com/users/8500089/rasna-shakya"}, "edited": false, "score": 0, "creation_date": 1558946611, "post_id": 56322491, "comment_id": 99253037, "body": "can you add what you have written on database.yml"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 11526842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd80701396164df7921ab9cbec0ec31?s=128&d=identicon&r=PG&f=1", "display_name": "Papy Poule", "link": "https://stackoverflow.com/users/11526842/papy-poule"}, "edited": false, "score": 0, "creation_date": 1558958105, "post_id": 56322790, "comment_id": 99258683, "body": "Can&#39;t use heroku at the moment because of the error"}, {"owner": {"reputation": 172, "user_id": 11237253, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d0Yz0.png?s=128&g=1", "display_name": "Darany Khiev", "link": "https://stackoverflow.com/users/11237253/darany-khiev"}, "reply_to_user": {"reputation": 35, "user_id": 11526842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd80701396164df7921ab9cbec0ec31?s=128&d=identicon&r=PG&f=1", "display_name": "Papy Poule", "link": "https://stackoverflow.com/users/11526842/papy-poule"}, "edited": false, "score": 0, "creation_date": 1558969675, "post_id": 56322790, "comment_id": 99264534, "body": "Can I check your source? If you can please github address or something."}], "tags": [], "owner": {"reputation": 172, "user_id": 11237253, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d0Yz0.png?s=128&g=1", "display_name": "Darany Khiev", "link": "https://stackoverflow.com/users/11237253/darany-khiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1558947541, "creation_date": 1558947541, "answer_id": 56322790, "question_id": 56322491, "link": "https://stackoverflow.com/questions/56322491/how-to-fix-the-role-doesnt-exist-error/56322790#56322790", "title": "How to fix the &quot;Role doesn&#39;t exist&quot; error?", "body": "<p>Did you install new Gem for project?</p>\n\n<p>If you did I think what you didn't database migration.</p>\n\n<p>Please run following commands.</p>\n\n<pre><code>$heroku run rake db:migrate\n\n$heroku ps:scale web=1\n\n$heroku ps\n\n$heroku open\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 11526842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd80701396164df7921ab9cbec0ec31?s=128&d=identicon&r=PG&f=1", "display_name": "Papy Poule", "link": "https://stackoverflow.com/users/11526842/papy-poule"}, "edited": false, "score": 0, "creation_date": 1558958078, "post_id": 56324906, "comment_id": 99258661, "body": "When I do use &quot;psql postgres&quot;, I have an error &quot;role esteban does not exist&quot;"}], "tags": [], "owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1558955309, "creation_date": 1558955309, "answer_id": 56324906, "question_id": 56322491, "link": "https://stackoverflow.com/questions/56322491/how-to-fix-the-role-doesnt-exist-error/56324906#56324906", "title": "How to fix the &quot;Role doesn&#39;t exist&quot; error?", "body": "<p>I guess <code>esteban</code> is the user name on your local machine and because you dont set specific username and password in <code>database.yml</code> for <code>development</code> mode postgres uses username of your user when trying to open connection to database.</p>\n\n<p>Create role <code>esteban</code> in postgres:</p>\n\n<pre><code># go to psql console under default postgres user\npsql postgres \n# create role\ncreate role esteban SUPERUSER LOGIN;\n# exit psql\n\\q\n</code></pre>\n\n<p>Or set correct one in <code>database.yml</code> if you already have it</p>\n"}], "owner": {"reputation": 35, "user_id": 11526842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd80701396164df7921ab9cbec0ec31?s=128&d=identicon&r=PG&f=1", "display_name": "Papy Poule", "link": "https://stackoverflow.com/users/11526842/papy-poule"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 235, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1559563991, "creation_date": 1558946385, "last_edit_date": 1559563991, "question_id": 56322491, "link": "https://stackoverflow.com/questions/56322491/how-to-fix-the-role-doesnt-exist-error", "title": "How to fix the &quot;Role doesn&#39;t exist&quot; error?", "body": "<p>I just created a new Ruby on rails project using this, in order to deploy it with Heroku</p>\n\n<pre><code>rails new -d postgresql LG_1\n</code></pre>\n\n<p>Then I used rails s to run my server and found this error :</p>\n\n<pre><code>role \"esteban\" does not exist.\n</code></pre>\n\n<p>I've been looking for solutions for an hour, but none of them worked. Using createuser just gives me the does-not-exist error, and I'm not very comfortable with Rails.</p>\n\n<p>The versions I'm using :</p>\n\n<pre><code>Ruby 2.4.4\nRails 5.2.3\nPg (gem) 1.1.4\n</code></pre>\n\n<p>Here is my database.yml file (without the 75 lines of comments) :</p>\n\n<pre><code>default: &amp;default\n    adapter: postgresql\n    encoding: unicode\n    host: /var/run/postgresql\n    pool: &lt;%= ENV.fetch(\"RAILS_MAX_THREADS\") { 5 } %&gt;\n\ndevelopment:\n    &lt;&lt;: *default\n    database: LG_1_development\n\ntest:\n     &lt;&lt;: *default\n     database: LG_1_test\n\nproduction:\n    &lt;&lt;: *default\n    database: LG_1_production\n    username: LG_1\n    password: &lt;%= ENV['LG_1_DATABASE_PASSWORD'] %&gt;\n</code></pre>\n\n<p>I did not edit this file.</p>\n\n<p>EDIT : I found the solution. I had to open the pg_hba.conf file and manually add a new user called \"esteban\"</p>\n"}, {"tags": ["ruby", "selenium", "selenium-webdriver"], "answers": [{"tags": [], "owner": {"reputation": 1331, "user_id": 4189633, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VG5Vp.jpg?s=128&g=1", "display_name": "Vishal G", "link": "https://stackoverflow.com/users/4189633/vishal-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1561009306, "last_edit_date": 1561009306, "creation_date": 1560941051, "answer_id": 56665822, "question_id": 56321671, "link": "https://stackoverflow.com/questions/56321671/puppeteer-slowmo-option-in-selenium-web-driver/56665822#56665822", "title": "Puppeteer slowMo option in selenium web driver?", "body": "<p>This is the magic method, it is more effective as we can put random sleep between every command to make simulation like human</p>\n\n<pre><code>module Selenium::WebDriver::Remote\n  class Bridge\n    def execute(command, opts = {}, command_hash = nil)\n      verb, path = commands(command) || raise(ArgumentError, \"unknown command: #{command.inspect}\")\n      path = path.dup\n\n      path[':session_id'] = session_id if path.include?(':session_id')\n\n      begin\n        opts.each { |key, value| path[key.inspect] = escaper.escape(value.to_s) }\n      rescue IndexError\n        raise ArgumentError, \"#{opts.inspect} invalid for #{command.inspect}\"\n      end\n\n      Selenium::WebDriver.logger.info(\"-&gt; #{verb.to_s.upcase} #{path}\")\n      res = http.call(verb, path, command_hash)\n      sleep rand(0.1..0.8).round(2) # &lt;--- Add your sleep here.\n      res\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1331, "user_id": 4189633, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VG5Vp.jpg?s=128&g=1", "display_name": "Vishal G", "link": "https://stackoverflow.com/users/4189633/vishal-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "accepted_answer_id": 56665822, "answer_count": 1, "score": 0, "last_activity_date": 1561009306, "creation_date": 1558942722, "last_edit_date": 1559111674, "question_id": 56321671, "link": "https://stackoverflow.com/questions/56321671/puppeteer-slowmo-option-in-selenium-web-driver", "title": "Puppeteer slowMo option in selenium web driver?", "body": "<p>In <a href=\"https://github.com/GoogleChrome/puppeteer\" rel=\"nofollow noreferrer\">https://github.com/GoogleChrome/puppeteer</a></p>\n\n<p>There is one option to add a delay in every action</p>\n\n<blockquote>\n  <p>Slow it down - the slowMo option slows down Puppeteer operations by\n  the specified amount of milliseconds. It's another way to help see\n  what's going on.</p>\n</blockquote>\n\n<p>I am trying to find a similar way in  Selenium WebDriver (I am using the ruby library). </p>\n\n<p>Issue: Right now when I run Selenium script it finishes very quickly I want it to be run like human behavior. Is there any way to achieve this in Selenium??</p>\n"}, {"tags": ["ruby", "rubygems"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1558942859, "post_id": 56321290, "comment_id": 99251523, "body": "can you post the content of Gemfile and what ruby version are you running?  Did you already run <code>gem install bundler</code> and then <code>bundle install</code>"}, {"owner": {"reputation": 415, "user_id": 2871044, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/qcbkf.jpg?s=128&g=1", "display_name": "Jeppe Donslund", "link": "https://stackoverflow.com/users/2871044/jeppe-donslund"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1558945162, "post_id": 56321290, "comment_id": 99252417, "body": "Gemfile posted down below, couldn&#39;t post it in a comment."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1558945605, "post_id": 56321290, "comment_id": 99252616, "body": "please don&#39;t post info on your question as an answer, but rather EDIT your question to include related info. Also, please try to use the tools / editor correctly, you&#39;re making a mess to look at here."}], "owner": {"reputation": 415, "user_id": 2871044, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/qcbkf.jpg?s=128&g=1", "display_name": "Jeppe Donslund", "link": "https://stackoverflow.com/users/2871044/jeppe-donslund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 203, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558946131, "creation_date": 1558941003, "last_edit_date": 1558946131, "question_id": 56321290, "link": "https://stackoverflow.com/questions/56321290/could-not-find-turbolinks", "title": "Could not find Turbolinks", "body": "<p>I have used the installer from rubyinstaller.org. But I get this error afterwards</p>\n\n<blockquote>\n  <p>Could not find gem <code>'turbolinks (~&gt; 5) x86-mingw32'</code> in any of the gem sources listed in your <code>Gemfile</code>.</p>\n</blockquote>\n\n<p>I have tried some of the advices in the threats with a similar error, but no luck. Can someone guide in the right direction?</p>\n\n<p>My gemfile:</p>\n\n<blockquote>\n  <p>source '<a href=\"https://rubygems.org\" rel=\"nofollow noreferrer\">https://rubygems.org</a>'</p>\n  \n  <p>git_source(:github) do |repo_name|   repo_name =\n  \"#{repo_name}/#{repo_name}\" unless repo_name.include?(\"/\")<br>\n  \"<a href=\"https://github.com/#\" rel=\"nofollow noreferrer\">https://github.com/#</a>{repo_name}.git\" end</p>\n  \n  <p># Bundle edge Rails instead: gem 'rails', github: 'rails/rails' gem 'rails', '~> 5.1.3'\n  # Use sqlite3 as the database for Active Record gem 'sqlite3', git: \"<a href=\"https://github.com/larskanis/sqlite3-ruby\" rel=\"nofollow noreferrer\">https://github.com/larskanis/sqlite3-ruby</a>\", branch: \"add-gemspec\"\n  # Use Puma as the app server gem 'puma', '~> 3.7'\n  # Use SCSS for stylesheets gem 'sass-rails', '~> 5.0'\n  # Use Uglifier as compressor for JavaScript assets gem 'uglifier', '>= 1.3.0'\n  # See <a href=\"https://github.com/rails/execjs#readme\" rel=\"nofollow noreferrer\">https://github.com/rails/execjs#readme</a> for more supported \\runtimes\n  # gem 'therubyracer', platforms: :ruby</p>\n  \n  <p># Use CoffeeScript for .coffee assets and views gem 'coffee-rails', '~> 4.2'\n  # Turbolinks makes navigating your web application faster. Read more: <a href=\"https://github.com/turbolinks/turbolinks\" rel=\"nofollow noreferrer\">https://github.com/turbolinks/turbolinks</a> gem 'turbolinks', '~> 5' gem\n  'turbolinks-source', '~> 5'\n  # Build JSON APIs with ease. Read more: <a href=\"https://github.com/rails/jbuilder\" rel=\"nofollow noreferrer\">https://github.com/rails/jbuilder</a> gem 'jbuilder', '~> 2.5'\n  # Use Redis adapter to run Action Cable in production\n  # gem 'redis', '~> 3.0'\n  # Use ActiveModel has_secure_password\n  # gem 'bcrypt', '~> 3.1.7'</p>\n  \n  <p># Use Capistrano for deployment\n  # gem 'capistrano-rails', group: :development</p>\n  \n  <p>group :development, :test do   # Call 'byebug' anywhere in the code to\n  stop execution and get a debugger console   gem 'byebug', platforms:\n  [:mri, :mingw, :x64_mingw]   # Adds support for Capybara system\n  testing and selenium driver   gem 'capybara', '~> 2.13'   gem\n  'selenium-webdriver' end</p>\n  \n  <p>group :development do   # Access an IRB console on exception pages or\n  by using &lt;%= console %> anywhere in the code.   gem 'web-console', '>=\n  3.3.0' end</p>\n  \n  <p># Windows does not include zoneinfo files, so bundle the tzinfo-data gem gem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]</p>\n</blockquote>\n"}, {"tags": ["ruby", "add", "logstash-grok"], "comments": [{"owner": {"reputation": 23490, "user_id": 6296561, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/zgIdn.png?s=128&g=1", "display_name": "Zoe", "link": "https://stackoverflow.com/users/6296561/zoe"}, "edited": false, "score": 0, "creation_date": 1559471950, "post_id": 56321045, "comment_id": 99424758, "body": "Please don&#39;t add &quot;solved&quot; or similar phrases to your question when you&#39;ve solved the problem. If someone gave you an answer, <a href=\"/help/someone-answers\">accept it</a>. If you found a solution on your own, <a href=\"/help/self-answer\">post an answer</a> (you can also accept your own answer after two days). Accepting answers is also the way to show a question has been solved - editing &quot;solved&quot; into the question is not."}], "answers": [{"tags": [], "owner": {"reputation": 227, "user_id": 7132482, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fc01f2e35b468c36117b733e1e04f44b?s=128&d=identicon&r=PG&f=1", "display_name": "Laurent Cesaro", "link": "https://stackoverflow.com/users/7132482/laurent-cesaro"}, "is_accepted": true, "score": 0, "last_activity_date": 1559549530, "last_edit_date": 1559549530, "creation_date": 1559544628, "answer_id": 56422330, "question_id": 56321045, "link": "https://stackoverflow.com/questions/56321045/logstash-grok-compute-match-values/56422330#56422330", "title": "Logstash Grok Compute match values", "body": "<p>Use ruby code with <code>event.get('var').to_i</code></p>\n\n<pre><code>res =  event.get('nb1').to_i + event.get('nb2').to_i;\nevent.set('test', res); \n</code></pre>\n"}], "owner": {"reputation": 227, "user_id": 7132482, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fc01f2e35b468c36117b733e1e04f44b?s=128&d=identicon&r=PG&f=1", "display_name": "Laurent Cesaro", "link": "https://stackoverflow.com/users/7132482/laurent-cesaro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 56422330, "answer_count": 1, "score": 0, "last_activity_date": 1559549530, "creation_date": 1558940035, "last_edit_date": 1559471941, "question_id": 56321045, "link": "https://stackoverflow.com/questions/56321045/logstash-grok-compute-match-values", "title": "Logstash Grok Compute match values", "body": "<p>I'm trying to compute values from grok patterns. My data is sending from filebeat to logstash.</p>\n\n<p>My simple grok pattern dor testing :</p>\n\n<pre><code>match =&gt; [\"message\", \"^%{INT:nb1} \\| %{INT:nb2}$\"]\n</code></pre>\n\n<p>I want to add this 2 values (nb1 &amp; nb2).</p>\n\n<p>I tried this 2 possibilities :</p>\n\n<pre><code>mutate { add_field =&gt; { \"test_Duration\" =&gt; \"%{nb1}+%{nb2}\" } }\n</code></pre>\n\n<p>In result I had a string.</p>\n\n<pre><code>ruby {\n            code =&gt; \"\n             res = event['nb1'].to_i + event['nb2'].to_i;\n            event.set('test', res);  \"\n          }\n</code></pre>\n\n<p>In ruby code I can't get nb1 &amp; nb2 values..</p>\n\n<p>I don't know how to do this..</p>\n\n<p><strong>============================\nSOLUTION ============================</strong></p>\n\n<p>Use ruby code with <code>event.get('var').to_i</code></p>\n\n<pre><code>res =  event.get('nb1').to_i + event.get('nb2').to_i;\nevent.set('test', res); \n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3222, "user_id": 706939, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/cb564cb91a5a4741506a57b676985e61?s=128&d=identicon&r=PG", "display_name": "Naing Lin Aung", "link": "https://stackoverflow.com/users/706939/naing-lin-aung"}, "edited": false, "score": 2, "creation_date": 1558930280, "post_id": 56319306, "comment_id": 99247559, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/51466887/missing-secret-key-base-for-production-environment\">Missing secret_key_base for &#39;production&#39; environment,</a>"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1559014840, "post_id": 56319306, "comment_id": 99275611, "body": "@oreoluwa is right, you have your environment name &amp; value flip-flopped in your code snippet you shared."}], "answers": [{"tags": [], "owner": {"reputation": 5118, "user_id": 3893710, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/YaxSL.jpg?s=128&g=1", "display_name": "oreoluwa", "link": "https://stackoverflow.com/users/3893710/oreoluwa"}, "is_accepted": false, "score": 2, "last_activity_date": 1558936357, "creation_date": 1558936357, "answer_id": 56320323, "question_id": 56319306, "link": "https://stackoverflow.com/questions/56319306/deploying-rails-app-on-digital-ocean-and-when-running-cap-production-deployinit/56320323#56320323", "title": "Deploying Rails App on Digital Ocean and when running cap production deploy:initial I get back ---&gt; 01 ArgumentError: Missing `secret_key_base`", "body": "<p>Usually your <code>secret_key_base</code> would be stored in an environment variable, however the secret key base isn't supposed to be the name of the env key.\nIn your case, that's what I seem to observe.</p>\n\n<pre><code>development:\n  secret_key_base: &lt;%= ENV[\"132efa1cdc31b591fa97e11450182f7ece21c9409451ea74e65974a9fad9e1d27846895afe0ffc4ee09d0d87912532a8d64e9a465e3cdf4455dee4ff3830\"] %&gt;\n\ntest:\n  secret_key_base: &lt;%= ENV[\"1113232efa1cdc31b591fa97e11450182f7ece21c9409451ea74e65974a9fad9e1d27846895afe0ffc4ee09d0d87912532a8d64e9a465e3cdf4455dee4ff3830\"] %&gt;\n\nproduction:\n  secret_key_base: &lt;%= ENV[\"11173232efa1cdc31b591fa97e11450182f7ece21c9409451ea74e65974a9fad9e1d27846895afe0ffc4ee09d0d87912532a8d64e9a465e3cdf4455dee4ff3830\"] %&gt;\n</code></pre>\n\n<p>So, here's what I'd propose, instead of setting your secret as the key of your env variable, you'd probably just want to do something like:</p>\n\n<pre><code>secret_key_base: &lt;%= ENV[\"SECRET_KEY_BASE\"] %&gt;\n</code></pre>\n\n<p>Then, you'd want to set your environment variable in your digital ocean instance.</p>\n\n<p>I've not used Capistrano before, but take a look at <code>default_env</code> in <a href=\"https://capistranorb.com/documentation/getting-started/configuration/\" rel=\"nofollow noreferrer\">https://capistranorb.com/documentation/getting-started/configuration/</a>\nand <a href=\"https://stackoverflow.com/questions/23672631/capistrano-and-environment-variables\">Capistrano and environment variables</a></p>\n\n<p>In your case, I figured you'd probably want to do something along the lines of</p>\n\n<pre><code>set :default_env, { \n  'SECRET_KEY_BASE' =&gt; '11173232efa1cdc31b591fa97e11450182f7ece21c9409451ea74e65974a9fad9e1d27846895afe0ffc4ee09d0d87912532a8d64e9a465e3cdf4455dee4ff3830'\n}\n</code></pre>\n\n<p>Let me know if that helps</p>\n"}], "owner": {"reputation": 11, "user_id": 9679589, "user_type": "registered", "profile_image": "https://graph.facebook.com/933099966852366/picture?type=large", "display_name": "TenXDeveloper", "link": "https://stackoverflow.com/users/9679589/tenxdeveloper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559014607, "creation_date": 1558927384, "last_edit_date": 1559014607, "question_id": 56319306, "link": "https://stackoverflow.com/questions/56319306/deploying-rails-app-on-digital-ocean-and-when-running-cap-production-deployinit", "title": "Deploying Rails App on Digital Ocean and when running cap production deploy:initial I get back ---&gt; 01 ArgumentError: Missing `secret_key_base`", "body": "<p>Deploying Rails App on Digital Ocean and when running <code>cap production deploy:initial</code> I get back </p>\n\n<blockquote>\n  <p>01 ArgumentError: Missing <code>secret_key_base</code> for 'production' environment, set this string with <code>rails credentials:edit</code> </p>\n</blockquote>\n\n<p>I thought that I've set it already:</p>\n\n<pre><code>development:\n  secret_key_base: &lt;%= ENV[\"132efa1cdc31b591fa97e11450182f7ece21c9409451ea74e65974a9fad9e1d27846895afe0ffc4ee09d0d87912532a8d64e9a465e3cdf4455dee4ff3830\"] %&gt;\ntest:\n  secret_key_base: &lt;%= ENV[\"1113232efa1cdc31b591fa97e11450182f7ece21c9409451ea74e65974a9fad9e1d27846895afe0ffc4ee09d0d87912532a8d64e9a465e3cdf4455dee4ff3830\"] %&gt;\nproduction:\n  secret_key_base: &lt;%= ENV[\"11173232efa1cdc31b591fa97e11450182f7ece21c9409451ea74e65974a9fad9e1d27846895afe0ffc4ee09d0d87912532a8d64e9a465e3cdf4455dee4ff3830\"] %&gt;\n</code></pre>\n\n<p>I am using the digital ocean rails one click with ubuntu sever </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "model-view-controller", "activerecord", "polymorphism"], "comments": [{"owner": {"reputation": 2060, "user_id": 3944700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4df64cd1de5941fb49263a19d80f1482?s=128&d=identicon&r=PG&f=1", "display_name": "hashrocket", "link": "https://stackoverflow.com/users/3944700/hashrocket"}, "edited": false, "score": 0, "creation_date": 1558928656, "post_id": 56318641, "comment_id": 99247264, "body": "What do your routes look like?"}, {"owner": {"reputation": 35, "user_id": 10247020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc07b1e4585217f8d2656e2bb7f936d8?s=128&d=identicon&r=PG&f=1", "display_name": "yzi0148", "link": "https://stackoverflow.com/users/10247020/yzi0148"}, "reply_to_user": {"reputation": 2060, "user_id": 3944700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4df64cd1de5941fb49263a19d80f1482?s=128&d=identicon&r=PG&f=1", "display_name": "hashrocket", "link": "https://stackoverflow.com/users/3944700/hashrocket"}, "edited": false, "score": 0, "creation_date": 1558929699, "post_id": 56318641, "comment_id": 99247437, "body": "I updated the description with my routes.rb file. I haven&#39;t added anything for <code>questions</code>/<code>answers</code> to routes though. Should I be?"}], "owner": {"reputation": 35, "user_id": 10247020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc07b1e4585217f8d2656e2bb7f936d8?s=128&d=identicon&r=PG&f=1", "display_name": "yzi0148", "link": "https://stackoverflow.com/users/10247020/yzi0148"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1558929617, "creation_date": 1558920261, "last_edit_date": 1558929617, "question_id": 56318641, "link": "https://stackoverflow.com/questions/56318641/how-to-pass-in-reference-parent-id-into-polymorphic-child-record-via-a-nested-fo", "title": "How to pass in reference/parent ID into polymorphic child record via a nested form?", "body": "<p>I have a double nested form and I need to save the ID of one of the parents in the child record. However, the parent record might not have an ID yet so I can't save the ID. How can I pass in this referenced ID? Thanks!</p>\n\n<h2>Context</h2>\n\n<p>I'm somewhat new to Rails and am working on a homework app where a teacher can create a <code>Work</code>. A <code>Work</code> can have <code>Questions</code> and a <code>Question</code> has <code>Answers</code>. \nFor a <code>Work</code>, a student can create a <code>Submission</code>. The <code>Submission</code> can have <code>Answers</code> (which are a response to the <code>Work</code>'s questions. </p>\n\n<p><strong>Goal</strong> Ultimately, I'd like to display the information for a student submission including the relevant <code>Work</code> information, <code>Answers</code> the student provided along with the <code>Question</code> they were answering. </p>\n\n<p>I'm currently unable to create an <code>Answer</code> and have it reference the ID of the <code>Question</code> that it's nested in (which makes sense to me since at form submission, the <code>Question</code> might not exist and won't have an ID. </p>\n\n<p>My questions are: </p>\n\n<ol>\n<li>How can I pass in the parent/referenced <code>question_id</code> into <code>answer</code>?</li>\n<li>If that isn't possible, how can I reorganize these models so that I can accomplish the goal above?</li>\n<li>Is polymorphism the best use here or should I be using STI? (Or is this not relevant to my case)</li>\n</ol>\n\n<h2>Code</h2>\n\n<h3>My models:</h3>\n\n<p>models/work.rb</p>\n\n<pre><code>class Work &lt; ApplicationRecord\n  has_many :submissions\n  has_many :questions # Allow for quizzes\n  accepts_nested_attributes_for :questions, reject_if: :all_blank, allow_destroy: true\nend\n# == Schema Information\n#\n# Table name: works\n#\n#  id               :bigint(8)        not null, primary key\n#  description      :text\n#  due_date         :datetime\n#  name             :string\n#  submittable      :boolean          default(TRUE)\n#  url              :string\n#  created_at       :datetime         not null\n#  updated_at       :datetime         not null\n#  course_id        :integer\n#\n</code></pre>\n\n<p>models/submission.rb</p>\n\n<pre><code>class Submission &lt; ApplicationRecord\n  belongs_to :work\n  has_many :answers, as: :answerable\n  accepts_nested_attributes_for :answers, reject_if: :all_blank, allow_destroy: true\nend\n\n# == Schema Information\n#\n# Table name: submissions\n#\n#  id            :bigint(8)        not null, primary key\n#  enrollment_id :integer\n#  work_id       :integer\n#  title         :string\n#  content       :text\n#  created_at    :datetime         not null\n#  updated_at    :datetime         not null\n#\n\n</code></pre>\n\n<p>models/question.rb</p>\n\n<pre><code>class Question &lt; ApplicationRecord\n  belongs_to :work\n  has_many :answers, as: :answerable\n  # has_many :answers, as: :answerable, inverse_of: :question\n  accepts_nested_attributes_for :answers, reject_if: :all_blank, allow_destroy: true\n\n  validates :value, presence: true, allow_nil: false\nend\n\n# == Schema Information\n#\n# Table name: questions\n#\n#  id         :bigint(8)        not null, primary key\n#  value      :string\n#  created_at :datetime         not null\n#  updated_at :datetime         not null\n#  work_id    :bigint(8)\n#\n# Indexes\n#\n#  index_questions_on_work_id  (work_id)\n#\n\n</code></pre>\n\n<p>models/answer.rb</p>\n\n<pre><code>class Answer &lt; ApplicationRecord\n  belongs_to :answerable, polymorphic: true\n\n  validates :value, presence: true, allow_nil: false\nend\n\n# == Schema Information\n#\n# Table name: answers\n#\n#  id              :bigint(8)        not null, primary key\n#  answerable_type :string\n#  is_canon        :boolean          default(FALSE)\n#  is_correct      :boolean          default(FALSE)\n#  value           :string\n#  created_at      :datetime         not null\n#  updated_at      :datetime         not null\n#  answerable_id   :bigint(8)\n#  question_id     :bigint(8)\n#\n# Indexes\n#\n#  index_answers_on_answerable_id  (answerable_id)\n#  index_answers_on_question_id    (question_id)\n#\n# Foreign Keys\n#\n#  fk_rails_...  (question_id =&gt; questions.id)\n#\n\n</code></pre>\n\n<h3>Controller</h3>\n\n<p>controller/works_controller.rb</p>\n\n<pre><code>class WorksController &lt; ApplicationController\n\n  def create\n    @work = Work.new(work_params)\n\n    respond_to do |format|\n      if @work.save\n        format.html { redirect_to @work, notice: 'Work was successfully created.' }\n        format.json { render :show, status: :created, location: @work }\n      else\n        format.html { render :new }\n        format.json { render json: @work.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n  private\n\n    def work_params\n      params.require(:work).permit(:name, :category_id, :course_id, :description, :url, :due_date, :published, :points, :grades_published,\n\n        questions_attributes: [:id, :value, :_destroy,\n\n          answers_attributes: [:id, :value, :question_id, :is_correct, :is_canon, :_destroy]\n\n        ]\n\n      )\n\n    end\n\nend\n\n</code></pre>\n\n<h3>Views:</h3>\n\n<p>_form.html.slim</p>\n\n<pre><code>...\n  / Questions\n  .form-group.u-mt2x\n    = form.fields_for :questions do |question|\n      = render 'shared/question_fields', f: question\n    .links\n      = link_to_add_association 'Add Question', form, :questions, class: \"u-button--New u-button--sm\", partial: 'shared/question_fields'\n</code></pre>\n\n<p>_question_fields.html.slim</p>\n\n<pre><code>.nested-fields\n  .form-group\n    .form-group\n      = f.label :value, \"Question\", :class =&gt; \"required\"\n      = link_to_remove_association \"remove question\", f, data: {confirm: 'Are you sure you want to remove this question?'}\n    = f.text_field :value, class: \"form-control\"\n\n  // Answers / Choices\n  .form-group.u-mt2x\n    = f.fields_for :answers do |answer|\n      = render 'shared/answer_fields', f: answer\n    .links\n      = link_to_add_association 'Add Choice', f, :answers, partial: \"shared/answer_fields\"\n\n</code></pre>\n\n<p>_answer_fields.html.slim</p>\n\n<pre><code>.nested-fields\n  .form-group\n    .form-group\n      = f.label :value, \"Answer Choice\", :class =&gt; \"required\"\n      = link_to_remove_association \"remove choice\", f, data: {confirm: 'Are you sure you want to remove this answer?'}\n    = f.text_field :value, class: \"form-control\"\n  .form-group\n    = f.label :is_correct, \"This is the correct answer\"\n    div\n      = f.label :is_correct, \"Yes\", value: true\n      = f.radio_button :is_correct, true\n      = f.label :is_correct, \"No\", value: false\n      = f.radio_button :is_correct, false\n    /= f.select :is_correct, options_for_select([[\"Yes\", true], [\"No\", false]])\n  // Hidden fields\n  .form-group\n    - if current_user.id == @work.course.owner.id\n      = f.label :is_canon, \"Canonical Choice\"\n    = f.hidden_field :is_canon, value: current_user.id == @work.course.owner.id, :readonly =&gt; true\n  /.form-group\n    - if current_user.id == @work.course.owner.id\n      = f.label :question_id, \"Question ID\"\n    = f.text_field :question_id, @question.id\n\n</code></pre>\n\n<p>routes.rb</p>\n\n<pre><code>Rails.application.routes.draw do\n  resources :submissions\n  ...\n  devise_for :users, :path =&gt; 'auth', :controllers =&gt; {:registrations =&gt; \"registrations\"}\n\n  get \"works/index\"\n  resources :works do \n    member do \n      put 'toggle_publish'\n      put 'toggle_publish_grades'\n    end\n  end\n  ...\n  root 'home#index'\nend\n</code></pre>\n\n<h2>What I have tried/considered</h2>\n\n<ol>\n<li>Adding <code>inverse_of</code> to the <code>Question</code> model gives me an <code>ArgumentError (When assigning attributes, you must pass a hash as an argument.)</code> Additionally, it seems like <code>inverse_of</code> does not work well with <code>polymorphic</code> model relationships.</li>\n</ol>\n\n<pre><code>class Question &lt; ApplicationRecord\n  ...\n  has_many :answers, as: :answerable, inverse_of: :question\n  ...\nend\n</code></pre>\n\n<ol start=\"2\">\n<li><p>I've also considered separating out the form such that the <code>Question</code>/<code>Answer</code> are not created on form submission but rather an AJAX request so that I can get the <code>question_id</code>. </p></li>\n<li><p>On form submission, call <code>questions_controller</code> (which calls <code>answers_controller</code>) and have each create their own records rather than create everything within <code>works_controller</code></p></li>\n</ol>\n\n<h2>TLDR</h2>\n\n<p>I have a double nested form and I need to save the ID of one of the parents in the child record. However, the parent record might not have an ID yet so I can't save the ID. How can I pass in this referenced ID? Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "openssl", "x509"], "comments": [{"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "edited": false, "score": 0, "creation_date": 1558958686, "post_id": 56318272, "comment_id": 99259026, "body": "Is Private key supposed to be included? (directions are resembling PKCS12, with export to binary DER and Base64-encoding) Please provide more details on how that api is going to use the certificate"}, {"owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "reply_to_user": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "edited": false, "score": 0, "creation_date": 1558973675, "post_id": 56318272, "comment_id": 99266118, "body": "Unfortunately this is literally the only documentation I can find in their 100+ page PDF, and on their entire site. I&#39;ll be able to email them tomorrow so I will ask tomorrow specifically about the private key being included. This will be used when sending API requests to a payment processing platform from a non-PCI compliant server to authenticate with their API. They require credentials + IP whitelisting + x509 in header to authenticate properly."}, {"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "edited": false, "score": 0, "creation_date": 1558975255, "post_id": 56318272, "comment_id": 99266678, "body": "Where do you get the certificate and in which format? For authentication process must be something like &quot;create a keypair, keep private key private, upload CSR and get final certificate signed by them&quot; (certificate at this step contains only public key, sometimes later certificate and its private key encrypted with password are written in p12 format). Are they implementing some custom kind of SSL Client certificate mechanism?"}, {"owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "reply_to_user": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "edited": false, "score": 0, "creation_date": 1559082241, "post_id": 56318272, "comment_id": 99306463, "body": "@Vasfed they have sent me a single <code>cert.pfx</code> file which has binary data inside it, as well as a password"}, {"owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "reply_to_user": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "edited": false, "score": 0, "creation_date": 1559158320, "post_id": 56318272, "comment_id": 99337701, "body": "@Vasfed I added PHP and .NET code (these were the only code samples they had)"}], "answers": [{"comments": [{"owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "edited": false, "score": 0, "creation_date": 1559233178, "post_id": 56375525, "comment_id": 99364347, "body": "It doesn&#39;t work (it gives invalid certificate error), but I think it&#39;s something on their end because your answer produces an output that exactly looks like a decoded64 string that I told them to give me from their dev environment. when i decoded64 i get the exact binary output as what you put above... i think they dont have the certificate &#39;enabled&#39; for my account or something. Thank you for your help, ill mark it success for now"}, {"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "reply_to_user": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "edited": false, "score": 1, "creation_date": 1559234295, "post_id": 56375525, "comment_id": 99364849, "body": "@Tallboy also try with <code>strict_encode64</code> and no/with padding (<code>=</code>s at the end for some inputs), they may be using string comparison over base64"}], "tags": [], "owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "is_accepted": true, "score": 1, "last_activity_date": 1559209854, "last_edit_date": 1559209854, "creation_date": 1559208952, "answer_id": 56375525, "question_id": 56318272, "link": "https://stackoverflow.com/questions/56318272/export-x509-certificate-in-ruby/56375525#56375525", "title": "&quot;Export&quot; x509 certificate in Ruby", "body": "<p>Try</p>\n\n<pre><code>pkcs = OpenSSL::PKCS12.new(File.read('cert.pfx'), 'password')\nstr = Base64.urlsafe_encode64(pkcs.certificate.to_der)\n</code></pre>\n\n<p>Probably also <code>str.gsub(/=+$/, '')</code> to cut off padding</p>\n"}], "owner": {"reputation": 11394, "user_id": 794481, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/344337b6819f2f513fa80bb227be3c2d?s=128&d=identicon&r=PG", "display_name": "Tallboy", "link": "https://stackoverflow.com/users/794481/tallboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 536, "favorite_count": 0, "accepted_answer_id": 56375525, "answer_count": 1, "score": 2, "last_activity_date": 1559209854, "creation_date": 1558915340, "last_edit_date": 1559158303, "question_id": 56318272, "link": "https://stackoverflow.com/questions/56318272/export-x509-certificate-in-ruby", "title": "&quot;Export&quot; x509 certificate in Ruby", "body": "<p>I'm communicating with an API that has the following directions:</p>\n\n<ol>\n<li>Install the issued x509 certificate onto the client server.</li>\n<li>Export the x509 certificate using the supplied password and default Machine Key Set into memory.</li>\n<li>Base64 encode the exported bytes of the x509 certificate.</li>\n<li>Add \u2018X509Certificate\u2019 as an HTTP header and set its value to the result of step 3.</li>\n</ol>\n\n<p>Step 1 and 4 are easy, but I have no idea on 2 or or the 'export' portion of 3. I have tried Googling for some time and I'm not sure exactly where to even really start.</p>\n\n<p>Would someone point me in the right direction on how to \"export\" a certificate with \"machine key set\"?</p>\n\n<p>Here is what I have so far</p>\n\n<pre><code>raw_data = File.read('cert.pfx')\npkcs = OpenSSL::PKCS12.new(raw_data, 'password')\ncert = OpenSSL::X509::Certificate.new(pkcs.certificate.to_pem)\n</code></pre>\n\n<p>Here is equivalent .NET code:</p>\n\n<pre><code>public string GetBase64Cert(string certificateThumbprint)\n {\n using (X509Store store = new X509Store(StoreName.My, StoreLocation.LocalMachine))\n {\n store.Open(OpenFlags.ReadOnly);\n var foundCertificates = store.Certificates.Find(X509FindType.FindByThumbprint, certificateThumbprint, false);\n if (foundCertificates.Count != 1)\n {\n return null;\n }\n var certByteArray = foundCertificates[0].Export(X509ContentType.Cert);\n store.Close();\n return Convert.ToBase64String(certByteArray);\n }\n}\n</code></pre>\n\n<p>And equivalent PHP code:</p>\n\n<pre><code>public function setx509($x509file) {\n  $cert = openssl_x509_parse($x509file);\n  $base64cert = base64_encode($cert);\n  return $base64cert;\n}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "redis"], "comments": [{"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 3, "creation_date": 1558914987, "post_id": 56318219, "comment_id": 99245261, "body": "The simpler way is to use a database, this really is not a suitable use for an simple in-memory store. You should be persisting things use ActiveRecord talking to a database of some kind."}, {"owner": {"reputation": 317, "user_id": 5969535, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VfMtY.jpg?s=128&g=1", "display_name": "Nicholas Yang", "link": "https://stackoverflow.com/users/5969535/nicholas-yang"}, "reply_to_user": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 0, "creation_date": 1558922590, "post_id": 56318219, "comment_id": 99246300, "body": "I was doing this in a database, but the query logic is getting quite hairy. Namely, I&#39;m querying for conversations with exactly one membership (conversations has_many memberships) where that membership does not have the same uuid (I&#39;m using uuids in lieu of actual accounts), etc, etc."}, {"owner": {"reputation": 317, "user_id": 5969535, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VfMtY.jpg?s=128&g=1", "display_name": "Nicholas Yang", "link": "https://stackoverflow.com/users/5969535/nicholas-yang"}, "reply_to_user": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 0, "creation_date": 1558922696, "post_id": 56318219, "comment_id": 99246321, "body": "And also, I don&#39;t really think this stuff should be persisted. If a conversation isn&#39;t being paired up in a few minutes, it should be tossed out of the pool, as the user has most likely gone away."}, {"owner": {"reputation": 153, "user_id": 5480591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fed0c44012e52e7077b08b66948586e0?s=128&d=identicon&r=PG&f=1", "display_name": "s sato", "link": "https://stackoverflow.com/users/5480591/s-sato"}, "edited": false, "score": 0, "creation_date": 1558930821, "post_id": 56318219, "comment_id": 99247682, "body": "If you&#39;re using mysql, you can use <a href=\"https://dev.mysql.com/doc/refman/8.0/en/memory-storage-engine.html\" rel=\"nofollow noreferrer\">memory table</a> to create in-memory table. if you&#39;re using postgresql, you can create <a href=\"https://www.postgresql.org/docs/10/manage-ag-tablespaces.html\" rel=\"nofollow noreferrer\">table space</a> on <code>&#47;dev&#47;shm</code>(RAM). In either case, you need database-specific migration."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1558931984, "post_id": 56318219, "comment_id": 99247910, "body": "The hairy db logic could be shaved quite nicely, unless you have something non-obvious going on in that beard. A trivial optimisation would be to either not have singles in a conversation yet, or to have them marked specifically as open. <code>Users.where(open: true).first</code> or <code>Users.where(convo: null).first</code> should be quite... hairless."}], "owner": {"reputation": 317, "user_id": 5969535, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VfMtY.jpg?s=128&g=1", "display_name": "Nicholas Yang", "link": "https://stackoverflow.com/users/5969535/nicholas-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558914428, "creation_date": 1558914428, "question_id": 56318219, "link": "https://stackoverflow.com/questions/56318219/creating-in-memory-set-for-rails", "title": "Creating in-memory set for Rails", "body": "<p>I'm trying to implement a random chat app in Rails. Basically, you get randomly paired up with another person in a conversation. What I'd like to do is have an in-memory set of \"open\" conversations. When a new user connects, I'll see if there's a conversation in the set. If there is, then I'll remove the conversation from the set and add the new user to it. Otherwise, I'll create a new conversation with that user and add the conversation to the pool.</p>\n\n<p>I'm thinking of using Redis for this, as it's in memory and has a set data structure. However, most of the Redis with Rails documentation is rather high level and deals with caching/session data. I just want a set data structure that has some way of getting values out atomically. Should I use Redis for this? Or is there a simpler way?</p>\n"}, {"tags": ["ruby", "rubygems", "rake", "bundler", "executable"], "comments": [{"owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 0, "creation_date": 1558943587, "post_id": 56318122, "comment_id": 99251776, "body": "I dont think that either command does some checks for misconfiguration (if you found some indications for that, please include the reference in your question). However, I believe that the rake task does cover more aspects of the release-cycle, like adding a tag to the git repository etc., while gem push just does the upload to rubygems.org (or any other gem-server)."}, {"owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "reply_to_user": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 0, "creation_date": 1558973583, "post_id": 56318122, "comment_id": 99266086, "body": "so I was wondering if <code>bundle exec rake &lt;command&gt;</code> caught any misconfiguration between specifications like <code>s.bindir</code> and <code>s.executables</code> (in case one uses <code>bin</code> in one and <code>exe</code> in the other, etc.).  <code>gem push</code> nor <code>gem build</code> really catch anything (I could be wrong?)"}, {"owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 0, "creation_date": 1559025865, "post_id": 56318122, "comment_id": 99278565, "body": "That would be really easy to test, wouldnt it?"}], "owner": {"reputation": 155, "user_id": 10611267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3caf805e19826b6593450921fe23ccf?s=128&d=identicon&r=PG&f=1", "display_name": "foo", "link": "https://stackoverflow.com/users/10611267/foo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 476, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1558943735, "creation_date": 1558913087, "last_edit_date": 1558943735, "question_id": 56318122, "link": "https://stackoverflow.com/questions/56318122/what-are-the-differences-between-bundle-exec-rake-release-and-gem-push", "title": "What are the differences between `bundle exec rake release` and `gem push`?", "body": "<p>I'd like to know the difference between using <code>bundle exec rake release</code> to publish a gem.  Is there any benefit over <code>gem push</code> in terms of <code>rake</code> catching a runtime error?  </p>\n\n<p><strong>Specifically</strong> I ask this in context of <code>executable gems</code> that run on one's terminal <strong>independently</strong> of <code>irb</code>.</p>\n\n<p>For example: if my <code>/bin/my_gem</code> is the following:</p>\n\n<pre><code>#!/usr/bin/env ruby\nrequire '../lib/my_gem'\n</code></pre>\n\n<p>And <code>.gemspec</code> contains</p>\n\n<pre><code>s.bindir = \"bin\"#or even \"exe\"\ns.executables = [\"my_gem\"]#or s.files.grep(%r{^bin/}) { |f| File.basename(f) }\ns.require_paths = [\"lib\"]\n</code></pre>\n\n<p>Would <code>bundle exec rake release</code> perhaps catch a misconfiguration that <code>gem push</code> would miss? </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1558913992, "post_id": 56317992, "comment_id": 99245124, "body": "what code are you using to construct the HTTP request?"}, {"owner": {"reputation": 893, "user_id": 3394889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3c58b23ce03f0e71522820d13404d5a?s=128&d=identicon&r=PG&f=1", "display_name": "The Wizard", "link": "https://stackoverflow.com/users/3394889/the-wizard"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1558914107, "post_id": 56317992, "comment_id": 99245136, "body": "That&#39;s all done by the gem internally all I get back is the status code as an integer and data"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1558914548, "post_id": 56317992, "comment_id": 99245190, "body": "can you please tell us which gem?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1558955509, "post_id": 56317992, "comment_id": 99257389, "body": "@ElChapo checking the HTTP status code seems a bit low level given that the gem should handle the connection details for you."}, {"owner": {"reputation": 893, "user_id": 3394889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3c58b23ce03f0e71522820d13404d5a?s=128&d=identicon&r=PG&f=1", "display_name": "The Wizard", "link": "https://stackoverflow.com/users/3394889/the-wizard"}, "edited": false, "score": 1, "creation_date": 1559007354, "post_id": 56317992, "comment_id": 99274416, "body": "Thanks for your help everyone. This is a custom gem so I will follow your advice and move the status handling logic to the gem as lacostenycoder suggested in his answer"}], "answers": [{"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 4, "last_activity_date": 1583235159, "last_edit_date": 1583235159, "creation_date": 1558915180, "answer_id": 56318264, "question_id": 56317992, "link": "https://stackoverflow.com/questions/56317992/how-to-check-for-successful-response-from-api-in-rails-by-just-using-status-code/56318264#56318264", "title": "How to check for successful response from API in rails by just using status code?", "body": "<p>I would expect any widely supported gem to use standard HTTP response codes to determine if the HTTP response was a <code>success</code>.  For example:</p>\n\n<pre><code>require 'open-uri' # Rails loads this by default.\nres = open('http://example.com')\nres.status\n=&gt; [\"200\",\"OK\"]\nstatus.include?'OK'\n=&gt;true\nstatus.include?'200'\n=&gt; true\n</code></pre>\n\n<p>So long as you trust the gem code making your request to handle standard HTTP response codes, you should be ok.  Here's another example using HTTParty gem</p>\n\n<pre><code>require 'HTTParty'\nres = HTTParty.get('https://example.com')\nres.success?\n=&gt; true\n</code></pre>\n"}], "owner": {"reputation": 893, "user_id": 3394889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3c58b23ce03f0e71522820d13404d5a?s=128&d=identicon&r=PG&f=1", "display_name": "The Wizard", "link": "https://stackoverflow.com/users/3394889/the-wizard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1228, "favorite_count": 0, "accepted_answer_id": 56318264, "answer_count": 1, "score": 2, "last_activity_date": 1583235159, "creation_date": 1558911450, "question_id": 56317992, "link": "https://stackoverflow.com/questions/56317992/how-to-check-for-successful-response-from-api-in-rails-by-just-using-status-code", "title": "How to check for successful response from API in rails by just using status code?", "body": "<p>I am <strong>consuming an API</strong> using a gem in Ruby on Rails. The gem makes the API call for me and returns the <strong>status code as an integer</strong> (for example 200, 201 e.t.c.) and the <strong>data response</strong> from the API.</p>\n\n<pre><code>def get_cars\n  status_code, data = MyGem::Cars.get_cars\n  if status_code in SUCCESSFUL_RESPONSE_CODES\n    # Perform data manipulation\n  else\n    raise \"There was an error processing the request. Status code #{status_code}\"\n  end\nend\n</code></pre>\n\n<p>Now I have manually initialised <code>SUCCESSFUL_RESPONSE_CODES</code> as a list containing integers of successful codes I found <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Status\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Is this list defined somewhere in Ruby/RoR to avoid manually defining it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "trix"], "comments": [{"owner": {"reputation": 146, "user_id": 1591162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3b0c3a16f638f81b9343f90880bc974?s=128&d=identicon&r=PG", "display_name": "Sarmad Sabih", "link": "https://stackoverflow.com/users/1591162/sarmad-sabih"}, "edited": false, "score": 2, "creation_date": 1564850203, "post_id": 56316549, "comment_id": 101168842, "body": "Your solution helped me a great deal with the direction. I started from there and then tweak around until I was able to get it working. Just don&#39;t have the time to post the whole solution here. Get in touch if you&#39;re still looking for a solution."}, {"owner": {"reputation": 2050, "user_id": 5695646, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-nEigl1xsDV4/AAAAAAAAAAI/AAAAAAAAANE/WGykpWYiogM/photo.jpg?sz=128", "display_name": "Yshmarov", "link": "https://stackoverflow.com/users/5695646/yshmarov"}, "edited": false, "score": 0, "creation_date": 1606225055, "post_id": 56316549, "comment_id": 114893874, "body": "Embedding Youtube that works for me: <a href=\"https://blog.corsego.com/action-text-embed-youtube\" rel=\"nofollow noreferrer\">blog.corsego.com/action-text-embed-youtube</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7429, "user_id": 197302, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/cb3f8a2021f4528c6e96896f6b217e82?s=128&d=identicon&r=PG", "display_name": "Toby", "link": "https://stackoverflow.com/users/197302/toby"}, "is_accepted": false, "score": 1, "last_activity_date": 1564226966, "creation_date": 1564226966, "answer_id": 57231678, "question_id": 56316549, "link": "https://stackoverflow.com/questions/56316549/how-to-display-embed-video-with-actiontext/57231678#57231678", "title": "How to display embed video with ActionText", "body": "<p>It looks like you need to whitelist the script that generates the iframe.</p>\n\n<p>A quick test you can do is on the show page add the relevant JS for the content providers (I was testing Instagram attachments, so added <code>&lt;script async src=\"//www.instagram.com/embed.js\"&gt;&lt;/script&gt;</code>).</p>\n\n<p>It would be unwise to whitelist all <code>&lt;script&gt;</code> tags in ActionText views, but you can manage the script loading yourself.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 12904781, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-g7Oin7dYTic/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rekiJaKyVfDTgI__ckNSoRSLxu1Hw/photo.jpg?sz=128", "display_name": "Ash", "link": "https://stackoverflow.com/users/12904781/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1594893201, "creation_date": 1594893201, "answer_id": 62932033, "question_id": 56316549, "link": "https://stackoverflow.com/questions/56316549/how-to-display-embed-video-with-actiontext/62932033#62932033", "title": "How to display embed video with ActionText", "body": "<p>I couldn't test your complex example, but if you want to put ActionText's HTML, it would be helpful.</p>\n<p>Please try this:</p>\n<p><code>&lt;%= raw your_action_text_object.to_plain_text %&gt;</code></p>\n"}, {"tags": [], "owner": {"reputation": 2708, "user_id": 2047546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fxixp.jpg?s=128&g=1", "display_name": "Yi Feng Xie", "link": "https://stackoverflow.com/users/2047546/yi-feng-xie"}, "is_accepted": false, "score": 1, "last_activity_date": 1614769569, "creation_date": 1614769569, "answer_id": 66455773, "question_id": 56316549, "link": "https://stackoverflow.com/questions/56316549/how-to-display-embed-video-with-actiontext/66455773#66455773", "title": "How to display embed video with ActionText", "body": "<p>You need to add iframe to allowed_tags, add the following code in <code>application.rb</code>:</p>\n<pre><code>config.to_prepare do\n  ActionText::ContentHelper.allowed_tags &lt;&lt; &quot;iframe&quot;\nend\n</code></pre>\n"}], "owner": {"reputation": 227, "user_id": 8779898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jVK0g.png?s=128&g=1", "display_name": "balthazar", "link": "https://stackoverflow.com/users/8779898/balthazar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2023, "favorite_count": 5, "answer_count": 3, "score": 11, "last_activity_date": 1614769569, "creation_date": 1558897316, "question_id": 56316549, "link": "https://stackoverflow.com/questions/56316549/how-to-display-embed-video-with-actiontext", "title": "How to display embed video with ActionText", "body": "<p>I am trying to display embedded videos with ActionText on Rails 6, both in the WYSIWYG Trix, and in the rendered content. But the ActionText renderer filters all raw html code and forces me to use JS to display the iframes in the rendered content, which doesnt work in Trix.</p>\n\n<p>I followed the instructions given here by one of Basecamp's dev : <a href=\"https://github.com/rails/actiontext/issues/37#issuecomment-451627370\" rel=\"noreferrer\">https://github.com/rails/actiontext/issues/37#issuecomment-451627370</a>. Step 1 through 3 work, but when ActionText renders my partial it filters the iframe.</p>\n\n<p>The form creating the WYSIYWG</p>\n\n<pre><code>= form_for(article, url: url, method: method) do |a|\n  = a.label :content\n  = a.rich_text_area :content, data: { controller: \"articles\", target: \"articles.field\", embeds_path: editorial_publication_embeds_path(@publication, format: :json) }\n  = a.submit submit_text, class:\"btn full\"\n</code></pre>\n\n<p>The Stimulus controller adding the embed functionality (in dire need of a refactor)</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>import { Controller } from \"stimulus\";\nimport Trix from \"trix\";\n\n$.ajaxSetup({\n  headers: {\n    \"X-CSRF-Token\": $('meta[name=\"csrf-token\"]').attr(\"content\"),\n  },\n});\n\nexport default class extends Controller {\n  static targets = [\"field\"];\n\n  connect() {\n    this.editor = this.fieldTarget.editor; \n\n    const buttonHTML =\n      '&lt;button type=\"button\" class=\"trix-button\" data-trix-attribute=\"embed\" data-trix-action=\"embed\" title=\"Embed\" tabindex=\"-1\"&gt;Media&lt;/button&gt;';\n    const buttonGroup = this.fieldTarget.toolbarElement.querySelector(\n      \".trix-button-group--block-tools\"\n    );\n    const dialogHml = `&lt;div class=\"trix-dialog trix-dialog--link\" data-trix-dialog=\"embed\" data-trix-dialog-attribute=\"embed\"&gt;\n    &lt;div class=\"trix-dialog__link-fields\"&gt;\n      &lt;input type=\"text\" name=\"embed\" class=\"trix-input trix-input--dialog\" placeholder=\"Paste your video or sound url\" aria-label=\"embed code\" required=\"\" data-trix-input=\"\" disabled=\"disabled\"&gt;\n      &lt;div class=\"trix-button-group\"&gt;\n        &lt;input type=\"button\" class=\"trix-button trix-button--dialog\" data-trix-custom=\"add-embed\" value=\"Add\"&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;`;\n    const dialogGroup = this.fieldTarget.toolbarElement.querySelector(\n      \".trix-dialogs\"\n    );\n    buttonGroup.insertAdjacentHTML(\"beforeend\", buttonHTML);\n    dialogGroup.insertAdjacentHTML(\"beforeend\", dialogHml);\n    document\n      .querySelector('[data-trix-action=\"embed\"]')\n      .addEventListener(\"click\", event =&gt; {\n        const dialog = document.querySelector('[data-trix-dialog=\"embed\"]');\n        const embedInput = document.querySelector('[name=\"embed\"]');\n        if (event.target.classList.contains(\"trix-active\")) {\n          event.target.classList.remove(\"trix-active\");\n          dialog.classList.remove(\"trix-active\");\n          delete dialog.dataset.trixActive;\n          embedInput.setAttribute(\"disabled\", \"disabled\");\n        } else {\n          event.target.classList.add(\"trix-active\");\n          dialog.classList.add(\"trix-active\");\n          dialog.dataset.trixActive = \"\";\n          embedInput.removeAttribute(\"disabled\");\n          embedInput.focus();\n        }\n      });\n    document\n      .querySelector('[data-trix-custom=\"add-embed\"]')\n      .addEventListener(\"click\", event =&gt; {\n        const content = document.querySelector('[name=\"embed\"]').value;\n        if (content) {\n          $.ajax({\n            method: \"POST\",\n            url: document.querySelector(\"[data-embeds-path]\").dataset\n              .embedsPath,\n            data: {\n              embed: {\n                content,\n              },\n            },\n            success: ({ content, sgid }) =&gt; {\n              const attachment = new Trix.Attachment({\n                content,\n                sgid,\n              });\n              this.editor.insertAttachment(attachment);\n              this.editor.insertLineBreak();\n            },\n          });\n        }\n      });\n  }\n}\n</code></pre>\n\n<p>The Embed model</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Embed &lt; ApplicationRecord\n  include ActionText::Attachable\n\n  validates :content, presence: true\n\n  after_validation :fetch_oembed_data\n\n  def to_partial_path\n    \"editorial/embeds/embed\"\n  end\n\n  def fetch_oembed_data\n    url =\n      case content\n      when /youtube/\n        \"https://www.youtube.com/oembed?url=#{content}&amp;format=json\"\n      when /soundcloud/\n        \"https://soundcloud.com/oembed?url=#{content}&amp;format=json\"\n      when /twitter/\n        \"https://publish.twitter.com/oembed?url=#{content}\"\n      end\n    res = RestClient.get url\n    json = JSON.parse(res.body, object_class: OpenStruct)\n    self.height = json.height\n    self.author_url = json.author_url\n    self.thumbnail_url = json.thumbnail_url\n    self.width = json.width\n    self.author_name = json.author_name\n    self.thumbnail_height = json.thumbnail_height\n    self.title = json.title\n    self.version = json.version\n    self.provider_url = json.provider_url\n    self.thumbnail_width = json.thumbnail_width\n    self.embed_type = json.type\n    self.provider_name = json.provider_name\n    self.html = json.html\n  end\nend\n</code></pre>\n\n<p>The controller creating the Embed</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>  def create\n    @embed = Embed.create!(params.require(:embed).permit(:content))\n    respond_to do |format|\n      format.json\n    end\n  end\n</code></pre>\n\n<p>The jbuilder view responding to the ajax call to create the Embed</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>json.extract! @embed, :content\n\njson.sgid @embed.attachable_sgid\njson.content render(partial: \"editorial/embeds/embed\", locals: { embed: @embed }, formats: [:html])\n</code></pre>\n\n<p>The Embed HTML partial (slim)</p>\n\n<pre><code>.youtube-embed.embed\n  .content\n    = image_tag(embed.thumbnail_url) if embed.thumbnail_url.present?\n    p = \"Embed from #{embed.provider_name} (#{embed.content})\"\n    p.embed-html = embed.html\n</code></pre>\n\n<p>And finally the JS code displaying the iframes when the Article's content with Embeds inside is displayed</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>$(document).ready(() =&gt; {\n  $(\".embed\").each(function(i, embed) {\n    const $embed = $(embed);\n    const p = $embed\n      .find(\".content\")\n      .replaceWith($embed.find(\".embed-html\").text());\n  });\n});\n</code></pre>\n\n<p>If I change the Embed partial to</p>\n\n<pre><code>== embed.html\n</code></pre>\n\n<p>It displays properly in the WYSIWYG but not in the rendered view.</p>\n"}]