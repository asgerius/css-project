[{"tags": ["ruby", "linux", "puppet", "facter"], "comments": [{"owner": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 0, "creation_date": 1532005885, "post_id": 51412234, "comment_id": 89817995, "body": "You can have facter output information as yaml or json which makes all of this significantly easier."}], "answers": [{"tags": [], "owner": {"reputation": 5730, "user_id": 667987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c00249587cb5aa0ceb5765dc811faa7?s=128&d=identicon&r=PG", "display_name": "seph", "link": "https://stackoverflow.com/users/667987/seph"}, "is_accepted": true, "score": 2, "last_activity_date": 1531960077, "creation_date": 1531960077, "answer_id": 51412689, "question_id": 51412234, "link": "https://stackoverflow.com/questions/51412234/greping-or-filtering-linux-output-in-ruby-for-custom-fact/51412689#51412689", "title": "greping or filtering linux output in ruby for custom fact", "body": "<p>String#scan is handy for this situation. Say your sample data is in a string called data:</p>\n\n<pre><code>data.scan(/(firmware-version: |driver: )(.+)/)\n</code></pre>\n\n<p>this outputs an array:</p>\n\n<pre><code>=&gt; [[\"driver: \", \"sfc\"], [\"firmware-version: \", \"4.2.2.1003 rx1 tx1\"]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 2, "last_activity_date": 1531979003, "creation_date": 1531979003, "answer_id": 51415125, "question_id": 51412234, "link": "https://stackoverflow.com/questions/51412234/greping-or-filtering-linux-output-in-ruby-for-custom-fact/51415125#51415125", "title": "greping or filtering linux output in ruby for custom fact", "body": "<pre><code>ifdata = ifline\n  .lines                                       # array of \\n-terminated lines\n  .map { |line| line.chomp.split(': ', 2) }    # array of [key, value] pairs\n  .select { |line| line.length &gt; 1 }           # get rid of anomalous \"enp1s0f1d1\"\n  .to_h                                        # hashify\n\nifdata['driver']\n# =&gt; sfc\nifdata['firmware-version']\n# =&gt; 4.2.2.1003 rx1 tx1\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 6442390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87ac138a985e4ec3c7d768ba1c77571c?s=128&d=identicon&r=PG&f=1", "display_name": "josseossa", "link": "https://stackoverflow.com/users/6442390/josseossa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 51412689, "answer_count": 2, "score": 2, "last_activity_date": 1531979003, "creation_date": 1531955887, "question_id": 51412234, "link": "https://stackoverflow.com/questions/51412234/greping-or-filtering-linux-output-in-ruby-for-custom-fact", "title": "greping or filtering linux output in ruby for custom fact", "body": "<p>I'm a beginner in ruby and I have been blowing out my head with this: \nI need to \"split the ethtool output into different variables,</p>\n\n<p>this is what I have done:</p>\n\n<pre><code>[root@aptpka02 facter]# cat test.rb\ninterface = \"enp8s0,enp9s0,enp1s0f0,enp1s0f1d1\"\ninterface.split(',').each do |int|\n # call ethtool to get the driver for this NIC\n  puts int\n  ifline = %x{/sbin/ethtool -i #{int} 2&gt;/dev/null }\n  puts ifline\n\nend\n</code></pre>\n\n<p>and this is the output (just for one interface):</p>\n\n<pre><code>enp1s0f1d1\ndriver: sfc\nversion: 4.0\nfirmware-version: 4.2.2.1003 rx1 tx1\nbus-info: 0000:01:00.1\nsupports-statistics: yes\nsupports-test: yes\nsupports-eeprom-access: no\nsupports-register-dump: yes\nsupports-priv-flags: no\n</code></pre>\n\n<p>I just need the driver and fimware information, i've try to add the grep with \"or\" to the command execution like this:</p>\n\n<pre><code>interface.split(',').each do |int|\n# call ethtool to get the driver for this NIC\nputs int\nifline = %x{/sbin/ethtool -i #{int} 2&gt;/dev/null | grep \"driver\\| firmware\"}\nputs ifline\n\nend\n</code></pre>\n\n<p>but it doesn't work, it prints an empty line.</p>\n\n<p>at the end, what I want to do is something like:</p>\n\n<pre><code>[root@aptpka02 facter]# vim test.rb\ninterface = \"enp8s0,enp9s0,enp1s0f0,enp1s0f1d1\"\ninterface.split(',').each do |int|\n # call ethtool to get the driver for this NIC\nputs int\nifline = %x{/sbin/ethtool -i #{int} 2&gt;/dev/null | grep \"driver\\| firmware\"}.lines.each do | nicinfo|\n if (nicinfo = driver)\n   driver = %x{/sbin/ethtool -i #{int} 2&gt;/dev/null | grep 'driver: '}.chomp.sub(\"driver: \", \"\")\n else\n  .\n  .\n  .\n endif\n\nend\n</code></pre>\n\n<p>can you give please give me a hint in how to continue?</p>\n\n<p>Thanks in advance for your help!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "capybara", "minitest"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1531952868, "post_id": 51411630, "comment_id": 89795270, "body": "Can you include the stacktrace?"}, {"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1531953331, "post_id": 51411630, "comment_id": 89795382, "body": "And edit your post and add what versions of Rails, Minitest, and Ruby you use"}, {"owner": {"reputation": 196, "user_id": 5204300, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh4.googleusercontent.com/-6SGS9rCE-sw/AAAAAAAAAAI/AAAAAAAAABE/LsnpNPIvZO0/photo.jpg?sz=128", "display_name": "Carlos G&#243;mez", "link": "https://stackoverflow.com/users/5204300/carlos-g%c3%b3mez"}, "reply_to_user": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1531953987, "post_id": 51411630, "comment_id": 89795562, "body": "sure @JoshBrody"}, {"owner": {"reputation": 196, "user_id": 5204300, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh4.googleusercontent.com/-6SGS9rCE-sw/AAAAAAAAAAI/AAAAAAAAABE/LsnpNPIvZO0/photo.jpg?sz=128", "display_name": "Carlos G&#243;mez", "link": "https://stackoverflow.com/users/5204300/carlos-g%c3%b3mez"}, "reply_to_user": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1531954014, "post_id": 51411630, "comment_id": 89795571, "body": "Versions: - rails: 5.0.0.1 - minitest: 5.9.1 - ruby 2.3.3p222, @Phlip"}, {"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1531955788, "post_id": 51411630, "comment_id": 89796051, "body": "Why are the tests running Capybara? A simple &quot;functional&quot; test can cover your code..."}, {"owner": {"reputation": 196, "user_id": 5204300, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh4.googleusercontent.com/-6SGS9rCE-sw/AAAAAAAAAAI/AAAAAAAAABE/LsnpNPIvZO0/photo.jpg?sz=128", "display_name": "Carlos G&#243;mez", "link": "https://stackoverflow.com/users/5204300/carlos-g%c3%b3mez"}, "reply_to_user": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1531955946, "post_id": 51411630, "comment_id": 89796083, "body": "@Phlip Is capybara causing this error for some reason?"}, {"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1531956000, "post_id": 51411630, "comment_id": 89796096, "body": "Edit your post and add a sample of your tests."}, {"owner": {"reputation": 196, "user_id": 5204300, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh4.googleusercontent.com/-6SGS9rCE-sw/AAAAAAAAAAI/AAAAAAAAABE/LsnpNPIvZO0/photo.jpg?sz=128", "display_name": "Carlos G&#243;mez", "link": "https://stackoverflow.com/users/5204300/carlos-g%c3%b3mez"}, "edited": false, "score": 0, "creation_date": 1531956751, "post_id": 51411630, "comment_id": 89796285, "body": "@Philip I have added a sample test, you need some test specially?"}], "answers": [{"comments": [{"owner": {"reputation": 196, "user_id": 5204300, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh4.googleusercontent.com/-6SGS9rCE-sw/AAAAAAAAAAI/AAAAAAAAABE/LsnpNPIvZO0/photo.jpg?sz=128", "display_name": "Carlos G&#243;mez", "link": "https://stackoverflow.com/users/5204300/carlos-g%c3%b3mez"}, "edited": false, "score": 0, "creation_date": 1532017604, "post_id": 51413047, "comment_id": 89826540, "body": "<code>@reason[0]&amp;.reason_for_consultation</code> works great, thanks for the explanation, now test are passing, I will follow your recommendations about the log, and the refactoring in the future. thank you very much."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 1, "last_activity_date": 1531963467, "creation_date": 1531963467, "answer_id": 51413047, "question_id": 51411630, "link": "https://stackoverflow.com/questions/51411630/getting-errors-when-execute-test-in-rails-for-activerecord-object-relationship/51413047#51413047", "title": "Getting errors when execute test in Rails for activerecord object relationship", "body": "<p>The controller test failure shows you what your issue, the page is returning a 500 error status rather than a 2XX status - which tells you there is an error rendering the page.  This would also be why Capybara isn't finding any of the expected elements on the page (because the page isn't actually being rendered).  If you look in your <code>test.log</code> it should tell you exactly where in your templates the error is coming but since commenting out the <code>&lt;%# reason_for_consultation(patient) %</code> fixes the page we can pretty safely assume that's where the error is.</p>\n\n<p>Looking at the code for <code>reason_for_consultation</code> we can see that if a patient hasn't already had a consultation then <code>@reason[0]</code> would be <code>nil</code> and <code>@reason[0].reason_for_consultation</code> would raise an error for trying to call <code>reason_for_consultation</code> on <code>nil</code>.  One possible way to fix that would be to use the safe navigation operator and change the line to</p>\n\n<pre><code>@reason[0]&amp;.reason_for_consultation\n</code></pre>\n\n<p>Note: In the future the whole implementation of that routine/partial should probably be refactored to remove the N + 1 query you have going on there.</p>\n\n<p>As for the <code>DEPRECATION WARNING</code> lines about <code>original_exception</code> - it's impossible to say where that is actually coming from without a deeper stacktrace, but try looking at <code>my_app/test/controllers/dashboard_controller_test.rb</code> line 21 and see what is being called there.  It could just be that you need to update some of your testing gems.</p>\n"}], "owner": {"reputation": 196, "user_id": 5204300, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh4.googleusercontent.com/-6SGS9rCE-sw/AAAAAAAAAAI/AAAAAAAAABE/LsnpNPIvZO0/photo.jpg?sz=128", "display_name": "Carlos G&#243;mez", "link": "https://stackoverflow.com/users/5204300/carlos-g%c3%b3mez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "accepted_answer_id": 51413047, "answer_count": 1, "score": 0, "last_activity_date": 1531963467, "creation_date": 1531951476, "last_edit_date": 1531956641, "question_id": 51411630, "link": "https://stackoverflow.com/questions/51411630/getting-errors-when-execute-test-in-rails-for-activerecord-object-relationship", "title": "Getting errors when execute test in Rails for activerecord object relationship", "body": "<p>I have a view partial _patients.html.erb where I want to show a nested attribute from Consultation model, so I am accessing to ActiveRecord relationship object this way:</p>\n\n<h2>my models</h2>\n\n<pre><code>class Patient &lt; ApplicationRecord\n  belongs_to :medic\n  has_many :consultations, dependent: :destroy\n  accepts_nested_attributes_for :consultations\nend\n\nclass Consultation &lt; ApplicationRecord\n  belongs_to :patient\nend\n</code></pre>\n\n<h2>on my dashboard_controller.rb</h2>\n\n<pre><code>..some code..\n\nprotected\n    def reason_for_consultation(patient)\n        patient = patient\n        @reason = Consultation.where(patient_id: patient.id).order(created_at: :desc).limit(1)\n        #=&gt; @reason: #&lt;ActiveRecord::Relation [#&lt;Consultation id: 371, reason_for_consultation: \"Sunt impedit adipisci molestiae doloremque sed.\"&gt;]&gt;\n        @reason_for_consultation = @reason[0].reason_for_consultation\n    end\n\n    helper_method :reason_for_consultation\n</code></pre>\n\n<h2>the view partial _patients.html.erb</h2>\n\n<pre><code>&lt;% @patients.each do |patient| %&gt;\n    .. code ..\n    &lt;p&gt;Reason for consultation: &lt;%= reason_for_consultation(patient) %&gt;&lt;/p&gt;\n    .. code ..\n&lt;% end %&gt;\n</code></pre>\n\n<p>Note: the code is working fine, is showing data for each patient in the view, the problem is when I run tests (minitest) I'm getting several warnings and errors like this:</p>\n\n<ul>\n<li>DEPRECATION WARNING: #original_exception is deprecated. Use #cause instead. (more descriptions of the error followed by):\n\n<ul>\n<li>Capybara::ElementNotFound: Unable to find visible link, or</li>\n<li>Expected false to be truthy, or</li>\n<li>Expected response to be a &lt;2XX: success>, but was a &lt;500: Internal Server Error></li>\n</ul></li>\n</ul>\n\n<p>But if I comment in my partial: <code>&lt;%# reason_for_consultation(patient) %&gt;</code>, and run tests again all are pass.</p>\n\n<p>All errors are related to dashboard interaction</p>\n\n<p>Any idea what is happening and how to solve it?</p>\n\n<h2>Edit:</h2>\n\n<p>Versions:\n - rails: 5.0.0.1\n - minitest: 5.9.1\n - ruby 2.3.3p222</p>\n\n<p>rails test trace:</p>\n\n<pre><code>DEPRECATION WARNING: #original_exception is deprecated. Use #cause instead. (called from block in &lt;class:DashboardFlowTest&gt; at my_app/test/integration/dashboard_flow_test.rb:19)\nDEPRECATION WARNING: #original_exception is deprecated. Use #cause instead. (called from block in &lt;class:DashboardFlowTest&gt; at my_app/test/integration/dashboard_flow_test.rb:19)\n FAIL[\"test_should_be_in_dashboard\", DashboardFlowTest, 0.46483432999957586]\n test_should_be_in_dashboard#DashboardFlowTest (0.46s)\n        Expected false to be truthy.\n        test/integration/dashboard_flow_test.rb:20:in `block in &lt;class:DashboardFlowTest&gt;'\n\nDEPRECATION WARNING: #original_exception is deprecated. Use #cause instead. (called from block in &lt;class:DashboardFlowTest&gt; at my_app/test/integration/dashboard_flow_test.rb:24)\nDEPRECATION WARNING: #original_exception is deprecated. Use #cause instead. (called from block in &lt;class:DashboardFlowTest&gt; at my_app/test/integration/dashboard_flow_test.rb:24)\nERROR[\"test_should_be_show_new_patient_form\", DashboardFlowTest, 0.5577200539992191]\n test_should_be_show_new_patient_form#DashboardFlowTest (0.56s)\nCapybara::ElementNotFound:         Capybara::ElementNotFound: Unable to find visible link \"Create Patient\"\n            test/integration/dashboard_flow_test.rb:25:in `block in &lt;class:DashboardFlowTest&gt;'\n\nDEPRECATION WARNING: #original_exception is deprecated. Use #cause instead. (called from block in &lt;class:DashboardFlowTest&gt; at my_app/test/integration/dashboard_flow_test.rb:30)\nDEPRECATION WARNING: #original_exception is deprecated. Use #cause instead. (called from block in &lt;class:DashboardFlowTest&gt; at my_app/test/integration/dashboard_flow_test.rb:30)\nERROR[\"test_should_be_show_patient_list_page\", DashboardFlowTest, 0.6530102200049441]\n test_should_be_show_patient_list_page#DashboardFlowTest (0.65s)\nCapybara::ElementNotFound:         Capybara::ElementNotFound: Unable to find visible link \"Patient List\"\n            test/integration/dashboard_flow_test.rb:31:in `block in &lt;class:DashboardFlowTest&gt;'\n\nDEPRECATION WARNING: #original_exception is deprecated. Use #cause instead. (called from block in &lt;class:PaymentMethodsFlowTest&gt; at my_app/test/integration/payment_methods_flow_test.rb:19)\nDEPRECATION WARNING: #original_exception is deprecated. Use #cause instead. (called from block in &lt;class:PaymentMethodsFlowTest&gt; at my_app/test/integration/payment_methods_flow_test.rb:19)\nERROR[\"test_0001_log into dashboard as premium user\", PaymentMethodsFlowTest, 4.802539983000315]\n test_0001_log into dashboard as premium user#PaymentMethodsFlowTest (4.80s)\nCapybara::ElementNotFound:         Capybara::ElementNotFound: Unable to find visible link \"Show Payment Methods\"\n            test/integration/payment_methods_flow_test.rb:21:in `block in &lt;class:PaymentMethodsFlowTest&gt;'\n\nDEPRECATION WARNING: #original_exception is deprecated. Use #cause instead. (called from block (2 levels) in &lt;class:ConsultNewPatientFlowTest&gt; at my_app/test/integration/consult_new_patient_flow_test.rb:37)\nDEPRECATION WARNING: #original_exception is deprecated. Use #cause instead. (called from block (2 levels) in &lt;class:ConsultNewPatientFlowTest&gt; at my_app/test/integration/consult_new_patient_flow_test.rb:37)\nERROR[\"test_0001_end to end consult a patient\", #&lt;Class:0x0055b32a91d1a0&gt;, 4.885057498999231]\n test_0001_end to end consult a patient#Medic can consult a new patient Feature Test (4.89s)\nCapybara::ElementNotFound:         Capybara::ElementNotFound: Unable to find visible link \"Create Patient\"\n            test/integration/consult_new_patient_flow_test.rb:39:in `block (2 levels) in &lt;class:ConsultNewPatientFlowTest&gt;'\n\nDEPRECATION WARNING: #original_exception is deprecated. Use #cause instead. (called from block (2 levels) in &lt;class:PremiumLoginFlowTest&gt; at my_app/test/integration/premium_login_flow_test.rb:20)\nDEPRECATION WARNING: #original_exception is deprecated. Use #cause instead. (called from block (2 levels) in &lt;class:PremiumLoginFlowTest&gt; at my_app/test/integration/premium_login_flow_test.rb:20)\n FAIL[\"test_0001_login premium\", #&lt;Class:0x0055b32a8e22f8&gt;, 5.003259566998167]\n test_0001_login premium#Medic with account and payment method Feature Test (5.00s)\n        Expected false to be truthy.\n        test/integration/premium_login_flow_test.rb:22:in `block (2 levels) in &lt;class:PremiumLoginFlowTest&gt;'\n\nDEPRECATION WARNING: #original_exception is deprecated. Use #cause instead. (called from block in &lt;class:DashboardControllerTest&gt; at my_app/test/controllers/dashboard_controller_test.rb:21)\nDEPRECATION WARNING: #original_exception is deprecated. Use #cause instead. (called from block in &lt;class:DashboardControllerTest&gt; at my_app/test/controllers/dashboard_controller_test.rb:21)\n FAIL[\"test_should_get_dashboard\", DashboardControllerTest, 5.078975292002724]\n test_should_get_dashboard#DashboardControllerTest (5.08s)\n        Expected response to be a &lt;2XX: success&gt;, but was a &lt;500: Internal Server Error&gt;\n        test/controllers/dashboard_controller_test.rb:22:in `block in &lt;class:DashboardControllerTest&gt;'\n\n  63/63: [==================================================================================================================] 100% Time: 00:00:05, Time: 00:00:05\n\nFinished in 5.30410s\n63 tests, 147 assertions, 3 failures, 4 errors, 0 skips\n</code></pre>\n\n<h2>Edit 2:</h2>\n\n<p>Expected response to be a &lt;2XX: success>, but was a &lt;500: Internal Server Error>\nmy_app/test/controllers/dashboard_controller_test.rb:21</p>\n\n<pre><code>require 'test_helper'\n\nclass DashboardControllerTest &lt; ActionDispatch::IntegrationTest\n  # Needed for authenticate user\n  include Warden::Test::Helpers\n\n  setup do\n    # Login medic for before_filter authenticate_user!\n    @medic = medics(:medic_one)\n    @medic.confirmed_at = Time.now\n    @medic.save\n    login_as(@medic, :scope =&gt; :medic)\n    # Set payment for medic\n    @medic.payment_methods.reload\n  end\n\n  test \"should get dashboard\" do\n    get dashboard_index_url\n    assert_response :success\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "raspberry-pi"], "comments": [{"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 2, "creation_date": 1531946890, "post_id": 51410698, "comment_id": 89792943, "body": "This error <code>FAIL formats: can&#39;t open input `-&#39;: WAVE: RIFF header not found</code> indicates that this script is expecting to be piped WAVE data via stdin."}, {"owner": {"reputation": 441, "user_id": 9845540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d30187f923202aece3618ee7da9d245d?s=128&d=identicon&r=PG&f=1", "display_name": "Chris99391", "link": "https://stackoverflow.com/users/9845540/chris99391"}, "reply_to_user": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1532001592, "post_id": 51410698, "comment_id": 89815099, "body": "it&#39;s a code problem or just a path? Thx"}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1532002757, "post_id": 51410698, "comment_id": 89815889, "body": "Doesn&#39;t seem like a code problem. You might be running it wrong or your system doesn&#39;t satisfy some dependency maybe?"}, {"owner": {"reputation": 441, "user_id": 9845540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d30187f923202aece3618ee7da9d245d?s=128&d=identicon&r=PG&f=1", "display_name": "Chris99391", "link": "https://stackoverflow.com/users/9845540/chris99391"}, "reply_to_user": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1532003429, "post_id": 51410698, "comment_id": 89816326, "body": "The error does not indicate what is missing :("}], "owner": {"reputation": 441, "user_id": 9845540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d30187f923202aece3618ee7da9d245d?s=128&d=identicon&r=PG&f=1", "display_name": "Chris99391", "link": "https://stackoverflow.com/users/9845540/chris99391"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531948561, "creation_date": 1531946667, "last_edit_date": 1531948561, "question_id": 51410698, "link": "https://stackoverflow.com/questions/51410698/error-script-record-sound", "title": "Error script record sound", "body": "<p>I get a piece of code on github to record sounds with a raspberry PI but when I run the command:</p>\n\n<blockquote>\n  <p>./noise_detection.rb -t 1</p>\n</blockquote>\n\n<p>An error appears</p>\n\n<blockquote>\n  <p>./noise_detection.rb:162: warning: assigned but unused variable - rec_out\n  ./noise_detection.rb:174: warning: assigned but unused variable - value\n  Testing soundcard...\n  /usr/bin/sox FAIL formats: can't open input  `-': WAVE: RIFF header not found</p>\n</blockquote>\n\n<p>Here is the code:</p>\n\n<pre><code>    #!/usr/bin/ruby -w\n#\n# Copyright (C) 2013 Marco Mornati [http://www.mornati.net]\n# Based on Thomer M. Gil First [http://thomer.com/] version template\n#\n# Oct  05, 2012: Initial version\n#\n# This program is free software. You may distribute it under the terms of\n# the GNU General Public License as published by the Free Software\n# Foundation, version 3.\n#\n# This program is distributed in the hope that it will be useful, but\n# WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General\n# Public License for more details.\n#\n# This program detects the presence of sound and invokes a program.\n#\n\nrequire 'getoptlong'\nrequire 'optparse'\nrequire 'net/smtp'\nrequire 'logger'\nrequire 'date'\n\n\nHW_DETECTION_CMD = \"cat /proc/asound/cards\"\n# You need to replace MICROPHONE with the name of your microphone, as reported\n# by /proc/asound/cards\nSAMPLE_DURATION = 5 # seconds\nFORMAT = 'S16_LE'   # this is the format that my USB microphone generates\nTHRESHOLD = 0.05\nRECORD_FILENAME='/tmp/noise.wav'\nLOG_FILE='/var/log/noise_detector.log'\nPID_FILE='/etc/noised/noised.pid'\n\nlogger = Logger.new(LOG_FILE)\nlogger.level = Logger::DEBUG\n\nlogger.info(\"Noise detector started @ #{DateTime.now.strftime('%d/%m/%Y %H:%M:%S')}\")\n\n\ndef self.check_required()\n  if !File.exist? '/usr/bin/arecord'\n    warn \"/usr/bin/arecord not found; install package alsa-utils\"\n    exit 1\n  end\n\n  if !File.exist? '/usr/bin/sox'\n    warn \"/usr/bin/sox not found; install package sox\"\n    exit 1\n  end\n\n  if !File.exist? '/proc/asound/cards'\n    warn \"/proc/asound/cards not found\"\n    exit 1\n  end\n\nend\n\n# Parsing script parameters\noptions = {}\noptparse = OptionParser.new do |opts|\n  opts.banner = \"Usage: noise_detection.rb -m ID [options]\"\n\n  opts.on(\"-m\", \"--microphone SOUND_CARD_ID\", \"REQUIRED: Set microphone id\") do |m|\n    options[:microphone] = m\n  end\n  opts.on(\"-s\", \"--sample SECONDS\", \"Sample duration\") do |s|\n    options[:sample] = s\n  end\n  opts.on(\"-n\", \"--threshold NOISE_THRESHOLD\", \"Set Activation noise Threshold. EX. 0.1\") do |n|\n    options[:threshold] = n\n  end\n  opts.on(\"-e\", \"--email DEST_EMAIL\", \"Alert destination email\") do |e|\n    options[:email] = e\n  end\n  opts.on(\"-v\", \"--[no-]verbose\", \"Run verbosely\") do |v|\n    options[:verbose] = v\n  end\n  opts.on(\"-d\", \"--detect\", \"Detect your sound cards\") do |d|\n    options[:detection] = d\n  end\n  opts.on(\"-t\", \"--test SOUND_CARD_ID\", \"Test soundcard with the given id\") do |t|\n    options[:test] = t\n  end\n  opts.on(\"-k\", \"--kill\", \"Terminating background script\") do |k|\n    options[:kill] = k\n  end\nend.parse!\n\nif options[:kill]\n  logger.info(\"Terminating script\");\n  logger.debug(\"Looking for pid file in #{PID_FILE}\")\n  begin\n    pidfile = File.open(PID_FILE, \"r\")\n    storedpid = pidfile.read\n    Process.kill(\"TERM\", Integer(storedpid))\n  rescue Exception =&gt; e\n    logger.error(\"Cannot read pid file: \" + e.message)\n    exit 1\n  end\n  exit 0\nend\n\nif options[:detection]\n    puts \"Detecting your soundcard...\"\n    puts `#{HW_DETECTION_CMD}`\n    exit 0\nend\n\n#Check required binaries\ncheck_required()\n\nif options[:sample]\n    SAMPLE_DURATION = options[:sample]\nend\n\nif options[:threshold]\n    THRESHOLD = options[:threshold].to_f\nend\n\nif options[:test]\n    puts \"Testing soundcard...\"\n    puts `/usr/bin/arecord -D plughw:#{options[:test]},0 -d #{SAMPLE_DURATION} -f #{FORMAT} 2&gt;/dev/null | /usr/bin/sox -t .wav - -n stat 2&gt;&amp;1`\n    exit 0\nend\n\noptparse.parse!\n\n#Now raise an exception if we have not found a host option\nraise OptionParser::MissingArgument if options[:microphone].nil?\nraise OptionParser::MissingArgument if options[:email].nil?\n\nif options[:verbose]\n   logger.debug(\"Script parameters configurations:\")\n   logger.debug(\"SoundCard ID: #{options[:microphone]}\")\n   logger.debug(\"Sample Duration: #{SAMPLE_DURATION}\")\n   logger.debug(\"Output Format: #{FORMAT}\")\n   logger.debug(\"Noise Threshold: #{THRESHOLD}\")\n   logger.debug(\"Record filename (overwritten): #{RECORD_FILENAME}\")\n   logger.debug(\"Destination email: #{options[:email]}\")\nend\n\n#Starting script part\npid = fork do\n  stop_process = false\n  Signal.trap(\"USR1\") do\n    logger.debug(\"Running...\")\n  end\n  Signal.trap(\"TERM\") do\n    logger.info(\"Terminating...\")\n    File.delete(PID_FILE)\n    stop_process = true \n  end\n\n  loop do\n    if (stop_process)\n    logger.info(\"Noise detector stopped @ #{DateTime.now.strftime('%d/%m/%Y %H:%M:%S')}\")   \n    break\n    end\n    rec_out = `/usr/bin/arecord -D plughw:#{options[:microphone]},0 -d #{SAMPLE_DURATION} -f #{FORMAT} -t wav #{RECORD_FILENAME} 2&gt;/dev/null`\n    out = `/usr/bin/sox -t .wav #{RECORD_FILENAME} -n stat 2&gt;&amp;1`\n    out.match(/Maximum amplitude:\\s+(.*)/m)\n    amplitude = $1.to_f\n    logger.debug(\"Detected amplitude: #{amplitude}\") if options[:verbose]\n    if amplitude &gt; THRESHOLD\n      logger.info(\"Sound detected!!!\")\n\n    # Read a file\n    filecontent = File.open(RECORD_FILENAME ,\"rb\") {|io| io.read}\n\n        encoded = [filecontent].pack(\"m\")    # base64 econding\nputs  value = %x[/usr/sbin/sendmail #{options[:email]} &lt;&lt; EOF\nsubject: WARNING: Noise Detected\nfrom: email@email.fr\nContent-Description: \"noise.wav\"\nContent-Type: audio/x-wav; name=\"noise.wav\"\nContent-Transfer-Encoding:base64\nContent-Disposition: attachment; filename=\"noise.wav\"\n#{encoded}\nEOF] \n    else\n      logger.debug(\"No sound detected...\")\n    end\nend\nend\n\nProcess.detach(pid)\nlogger.debug(\"Started... (#{pid})\")\nFile.open(PID_FILE, \"w\") { |file| file.write(pid) }\n</code></pre>\n\n<p>Thank you for help.</p>\n"}, {"tags": ["ruby", "intellij-idea"], "comments": [{"owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "edited": false, "score": 0, "creation_date": 1531988746, "post_id": 51410360, "comment_id": 89806520, "body": "Are you using IntelliJ IDEA Community Edition? The Ruby plugin requires IntelliJ IDEA Ultimate."}, {"owner": {"reputation": 832, "user_id": 2682686, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LrNys.png?s=128&g=1", "display_name": "MisterStrickland", "link": "https://stackoverflow.com/users/2682686/misterstrickland"}, "reply_to_user": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "edited": false, "score": 0, "creation_date": 1532014186, "post_id": 51410360, "comment_id": 89824202, "body": "I am using CE, yeah... :-( That explains it. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 832, "user_id": 2682686, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LrNys.png?s=128&g=1", "display_name": "MisterStrickland", "link": "https://stackoverflow.com/users/2682686/misterstrickland"}, "is_accepted": true, "score": 0, "last_activity_date": 1532027844, "creation_date": 1532027844, "answer_id": 51430316, "question_id": 51410360, "link": "https://stackoverflow.com/questions/51410360/unable-to-install-and-use-ruby-plug-in-on-intellij-for-mac/51430316#51430316", "title": "Unable to install and use Ruby plug-in on IntelliJ for Mac", "body": "<p>The Ruby plugin requires IntelliJ IDEA Ultimate (Community Edition is being used)</p>\n"}], "owner": {"reputation": 832, "user_id": 2682686, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LrNys.png?s=128&g=1", "display_name": "MisterStrickland", "link": "https://stackoverflow.com/users/2682686/misterstrickland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 51430316, "answer_count": 1, "score": 0, "last_activity_date": 1532027844, "creation_date": 1531945125, "question_id": 51410360, "link": "https://stackoverflow.com/questions/51410360/unable-to-install-and-use-ruby-plug-in-on-intellij-for-mac", "title": "Unable to install and use Ruby plug-in on IntelliJ for Mac", "body": "<p>I am unable to get IntelliJ to list and recognize Ruby projects. I'm using a Mac (High Sierra). Ruby was installed using RVM.</p>\n\n<p>After I installed the Ruby plug-in, the plug-ins tab under Preferences shows the Ruby plug-in in red (any idea why?). According to the download page, the version of the plugin I downloaded matches the version of IntelliJ I'm running.</p>\n\n<p>Even then, when I try to create a new project, Ruby isn't listed as part of the options.</p>\n"}, {"tags": ["ruby", "github", "rbenv"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1531951636, "post_id": 51410009, "comment_id": 89794900, "body": "i didn&#39;t realize <code>hub</code> was a ruby gem; how i always do it is go to their <a href=\"https://github.com/github/hub/releases\" rel=\"nofollow noreferrer\">releases</a> page, download an executable, and run it directly"}], "answers": [{"tags": [], "owner": {"reputation": 509, "user_id": 2272280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcd08704d8f15a0006253bd594caa8fd?s=128&d=identicon&r=PG", "display_name": "felixbuenemann", "link": "https://stackoverflow.com/users/2272280/felixbuenemann"}, "is_accepted": true, "score": 1, "last_activity_date": 1531978682, "creation_date": 1531978682, "answer_id": 51415055, "question_id": 51410009, "link": "https://stackoverflow.com/questions/51410009/gem-hub-not-found-after-ruby-upgrade/51415055#51415055", "title": "gem hub not found after ruby upgrade", "body": "<p>Each Ruby version has a different gem path, so just reinstall hub under Ruby 2.4.4 using <code>gem install hub</code> or delete the shim at <code>~/.rbenv/shims/hub</code>, so that it uses the copy in <code>/usr/local/bin/hub</code> (likely installed with homebrew). </p>\n"}], "owner": {"reputation": 859, "user_id": 7227222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ec1eb8473ab73ded224fbbdc2414005?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertMunichMar", "link": "https://stackoverflow.com/users/7227222/albertmunichmar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 407, "favorite_count": 0, "accepted_answer_id": 51415055, "answer_count": 1, "score": 0, "last_activity_date": 1531978682, "creation_date": 1531943495, "question_id": 51410009, "link": "https://stackoverflow.com/questions/51410009/gem-hub-not-found-after-ruby-upgrade", "title": "gem hub not found after ruby upgrade", "body": "<p>I updated my ruby version to 2.4.4</p>\n\n<p>I am trying to run hub create, but I got the following error:</p>\n\n<pre><code>rbenv: hub: command not found\n\nThe `hub' command exists in these Ruby versions:\n  2.3.5\n</code></pre>\n\n<p>I have seen that I have like two gems of hub (or paths) in my computer:</p>\n\n<pre><code>which -a hub\n/Users/albertmontolio/.rbenv/shims/hub\n/usr/local/bin/hub\n</code></pre>\n\n<p>I read that I have to uninstall one, so I've done:</p>\n\n<pre><code>gem uninstall -x hub\n</code></pre>\n\n<p>But still I see the two paths and the error: hub command not found is still there.</p>\n\n<p>Why I can not use the gem hub and how can I fix this issue?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "model"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10060638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8385bb85eaefcd0d0f68d7da713bc083?s=128&d=identicon&r=PG&f=1", "display_name": "user10060638", "link": "https://stackoverflow.com/users/10060638/user10060638"}, "edited": false, "score": 0, "creation_date": 1531954577, "post_id": 51409757, "comment_id": 89795718, "body": "That didn&#39;t seem to work. Do you know how I would write a migration for the user_decorator?"}, {"owner": {"reputation": 1682, "user_id": 6392696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09WDQ.jpg?s=128&g=1", "display_name": "nourza", "link": "https://stackoverflow.com/users/6392696/nourza"}, "reply_to_user": {"reputation": 1, "user_id": 10060638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8385bb85eaefcd0d0f68d7da713bc083?s=128&d=identicon&r=PG&f=1", "display_name": "user10060638", "link": "https://stackoverflow.com/users/10060638/user10060638"}, "edited": false, "score": 0, "creation_date": 1531980076, "post_id": 51409757, "comment_id": 89801739, "body": "Check this <a href=\"https://stackoverflow.com/questions/13557550/how-to-include-draper-decorators-in-rails-console\" title=\"how to include draper decorators in rails console\">stackoverflow.com/questions/13557550/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1682, "user_id": 6392696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09WDQ.jpg?s=128&g=1", "display_name": "nourza", "link": "https://stackoverflow.com/users/6392696/nourza"}, "is_accepted": false, "score": 0, "last_activity_date": 1531942419, "creation_date": 1531942419, "answer_id": 51409757, "question_id": 51409648, "link": "https://stackoverflow.com/questions/51409648/how-do-i-create-migrations-for-model-attributes-in-rails/51409757#51409757", "title": "How do I create migrations for model attributes in rails", "body": "<p>You could call:</p>\n\n<pre><code>rails g model group user:references\n</code></pre>\n\n<p>which will generates an user_id column in the groups table and will modify the group.rb model to add a belongs_to :user relatonship. Please note, you must to put manually the has_many :groups or  has_one :group relationship to the user.rb model.</p>\n\n<p>If you already have the model generated, you could create a migration with the following:</p>\n\n<p>rails g migration AddUserToGroup user:belongs_to\nwhich will generate:</p>\n\n<pre><code>class AddUserToGroup &lt; ActiveRecord::Migration\n  def change\n    add_reference :groups, :user, index: true\n  end\nend\n</code></pre>\n\n<p>the only difference with this approach is, the belongs_to :user relationship in the group.rb model won't be created automatically, so you must create it for your own.</p>\n"}], "owner": {"reputation": 1, "user_id": 10060638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8385bb85eaefcd0d0f68d7da713bc083?s=128&d=identicon&r=PG&f=1", "display_name": "user10060638", "link": "https://stackoverflow.com/users/10060638/user10060638"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531942419, "creation_date": 1531942001, "question_id": 51409648, "link": "https://stackoverflow.com/questions/51409648/how-do-i-create-migrations-for-model-attributes-in-rails", "title": "How do I create migrations for model attributes in rails", "body": "<p>I'm having difficulty with bulding attributes within my model. I keep seeing this error</p>\n\n<pre><code>NoMethodError: undefined method `users' for #&lt;ActiveRecord::ConnectionAdapters::SQLite3::TableDefinition:0x00007f9d9ad9df98&gt;\n</code></pre>\n\n<p>I need attributes that look like this:</p>\n\n<pre><code>#group.rb\n\nclass Spree::Group &lt; ActiveRecord::Base\n    has_many :users\nend\n\n#user_decorator.rb\nSpree::User.class_eval do\n  belongs_to :group, class_name: \"Spree::Group\"\nend\n</code></pre>\n\n<p>For group.rb I ran</p>\n\n<pre><code>rails g model Spree::Group\n</code></pre>\n\n<p>and I got:</p>\n\n<pre><code>class Spree::Group &lt; ApplicationRecord\n  has_many :users\nend\n</code></pre>\n\n<p>I'm confused on how to add 'has_many :users' without actually going into the \nmodel and inputting it there.</p>\n\n<p>For the user_decorator I'm not sure what that migration would look like. Any help would be fantastic!</p>\n"}, {"tags": ["ruby", "character-encoding"], "comments": [{"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 2, "creation_date": 1531942438, "post_id": 51409381, "comment_id": 89790837, "body": "The issue is actually with the line above the line you mention, the <code>pack</code> is returning an ASCII-8BIT string and that is turning <code>chap</code> into an ASCII-8BIT string, and then you try pushing a UTF-8 string into it. I&#39;m not that good with encodings, but you could try using <code>String#force_encoding</code> to convert the result of pack to UTF-8, though that changes a lot of characters from (for example) &quot;\\x03&quot; to &quot;\\u0003&quot;, which may or may not be good enough (I admit a pretty thorough ignorance of character encodings and the underlying bytes and such); thought I&#39;d at least point you to the right line though"}, {"owner": {"reputation": 2929, "user_id": 4162864, "user_type": "registered", "accept_rate": 63, "profile_image": "https://lh3.googleusercontent.com/-_1V3BLkCY9s/AAAAAAAAAAI/AAAAAAAAAOQ/MvO2DnNuEzQ/photo.jpg?sz=128", "display_name": "John Pollard", "link": "https://stackoverflow.com/users/4162864/john-pollard"}, "reply_to_user": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1531942905, "post_id": 51409381, "comment_id": 89791091, "body": "If I comment out the pack(&quot;NN&quot;) it still fails but if comment out the &quot;\\xFF&quot; line it passes. So are you sure?"}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1531943120, "post_id": 51409381, "comment_id": 89791183, "body": "huh commenting out the pack line lets the &quot;\\xFF&quot; line works, for me, commenting out the &quot;\\xFF&quot; line would work though because you don&#39;t do anything else with the string (in the sample you&#39;ve shown), so it doesn&#39;t matter what encoding the string ended up with"}, {"owner": {"reputation": 2929, "user_id": 4162864, "user_type": "registered", "accept_rate": 63, "profile_image": "https://lh3.googleusercontent.com/-_1V3BLkCY9s/AAAAAAAAAAI/AAAAAAAAAOQ/MvO2DnNuEzQ/photo.jpg?sz=128", "display_name": "John Pollard", "link": "https://stackoverflow.com/users/4162864/john-pollard"}, "reply_to_user": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1531943272, "post_id": 51409381, "comment_id": 89791271, "body": "I added more of the actual code. I only copied over a snippet to keep the problem short and clear. I appreciate your help. I&#39;m trying to look into the encodings you&#39;re talking about. I do see it changing just have to figure out how to fix it"}, {"owner": {"reputation": 2929, "user_id": 4162864, "user_type": "registered", "accept_rate": 63, "profile_image": "https://lh3.googleusercontent.com/-_1V3BLkCY9s/AAAAAAAAAAI/AAAAAAAAAOQ/MvO2DnNuEzQ/photo.jpg?sz=128", "display_name": "John Pollard", "link": "https://stackoverflow.com/users/4162864/john-pollard"}, "reply_to_user": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 1, "creation_date": 1531943602, "post_id": 51409381, "comment_id": 89791422, "body": "Thanks for your help I figured it out. I force_encoding(&quot;ASCII-8BIT&quot;) on the &quot;\\xFF| line."}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1531943700, "post_id": 51409381, "comment_id": 89791463, "body": "glad you figured it out, my usual reflex is to try to get a string into utf-8 and just keep it there, didn&#39;t even think about just trying to go the other direction"}, {"owner": {"reputation": 2929, "user_id": 4162864, "user_type": "registered", "accept_rate": 63, "profile_image": "https://lh3.googleusercontent.com/-_1V3BLkCY9s/AAAAAAAAAAI/AAAAAAAAAOQ/MvO2DnNuEzQ/photo.jpg?sz=128", "display_name": "John Pollard", "link": "https://stackoverflow.com/users/4162864/john-pollard"}, "reply_to_user": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1531945768, "post_id": 51409381, "comment_id": 89792451, "body": "@SimpleLime Do you know of a way to figure out what the following is &quot;\\x00\\x00\\x00&#39;\\x00\\x00\\x00&quot;?"}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1531949408, "post_id": 51409381, "comment_id": 89794029, "body": "I&#39;m not sure what you mean &quot;what the following is&quot;, you can always ask another question, about that though"}], "owner": {"reputation": 2929, "user_id": 4162864, "user_type": "registered", "accept_rate": 63, "profile_image": "https://lh3.googleusercontent.com/-_1V3BLkCY9s/AAAAAAAAAAI/AAAAAAAAAOQ/MvO2DnNuEzQ/photo.jpg?sz=128", "display_name": "John Pollard", "link": "https://stackoverflow.com/users/4162864/john-pollard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531943206, "creation_date": 1531940892, "last_edit_date": 1531943206, "question_id": 51409381, "link": "https://stackoverflow.com/questions/51409381/how-to-fix-incompatible-character-encodings-utf-8-and-ascii-8bit", "title": "How to fix incompatible character encodings: UTF-8 and ASCII-8BIT", "body": "<p>The issue is with the 'chap &lt;&lt; \"\\xFF\\xFF\\xFF\\xFF\\xFF\\xFF\\xFF\\xFF\"' line. </p>\n\n<pre><code>chaps = []\nctoc = \"toc1\\x00\"\nctoc &lt;&lt; [3, chapters.size].pack(\"CC\")\nchapters.each_with_index do |ch, i|\n  num = i+1\n  title = ch[:title]\n  description = ch[:description]\n  link = ch[:link]\n\n  ctoc &lt;&lt; \"ch#{num}\\x00\"\n\n  chap = \"ch#{num}\\x00\"\n  chap &lt;&lt; [ch[:start]*1000, ch[:end]*1000].pack(\"NN\");\n  chap &lt;&lt; \"\\xFF\\xFF\\xFF\\xFF\\xFF\\xFF\\xFF\\xFF\"\n\n  title_tag = [title.encode(\"utf-16\")].pack(\"a*\");\n  chap &lt;&lt; \"TIT2\"\n  chap &lt;&lt; [title_tag.size+1].pack(\"N\")\n  chap &lt;&lt; \"\\x00\\x00\\x01\"\n  chap &lt;&lt; title_tag\n\n  chaps &lt;&lt; chap\nend\n</code></pre>\n\n<p>I have added the following to the top of the file but that didn't fix the issue. Any other ideas to try?</p>\n\n<pre><code># encoding: utf-8\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1531937033, "post_id": 51408268, "comment_id": 89787974, "body": "If you want to <i>embed</i> js/css, you could use the same approach, open the file, read its contents and insert into the html file via ERB&#39;s <code>&lt;%= %&gt;</code>. But <i>why</i> are you doing this? If you don&#39;t like the size/complexity of rails, there are many smaller frameworks."}, {"owner": {"reputation": 3119, "user_id": 4842949, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0agpj31wtZ8/AAAAAAAAAAI/AAAAAAAAAAA/mSolbNN-zIY/photo.jpg?sz=128", "display_name": "Joseph Cho", "link": "https://stackoverflow.com/users/4842949/joseph-cho"}, "edited": false, "score": 0, "creation_date": 1531937551, "post_id": 51408268, "comment_id": 89788218, "body": "I don&#39;t understand. If you want to link .js and .css files inside html, don&#39;t use just use <code>&lt;link&gt;</code> and <code>&lt;script&gt;</code> tags?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 3119, "user_id": 4842949, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0agpj31wtZ8/AAAAAAAAAAI/AAAAAAAAAAA/mSolbNN-zIY/photo.jpg?sz=128", "display_name": "Joseph Cho", "link": "https://stackoverflow.com/users/4842949/joseph-cho"}, "edited": false, "score": 0, "creation_date": 1531937609, "post_id": 51408268, "comment_id": 89788245, "body": "@JosephCho: this implies having a server, capable of serving static files. For all we know, this here is a static site generator, not a web app."}, {"owner": {"reputation": 89, "user_id": 10084075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cba1ee8e069d094ae73e2dd5e732ab1?s=128&d=identicon&r=PG&f=1", "display_name": "Rookie1999", "link": "https://stackoverflow.com/users/10084075/rookie1999"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1531937657, "post_id": 51408268, "comment_id": 89788273, "body": "@SergioTulentsev : Thank you for your suggestions. I&#39;m very new to Ruby , so still not sure about the supporting frameworks, I come from the system admin side, so these are bit tricky for me. is no other way I can call js and css inside the .html.erb"}, {"owner": {"reputation": 3119, "user_id": 4842949, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0agpj31wtZ8/AAAAAAAAAAI/AAAAAAAAAAA/mSolbNN-zIY/photo.jpg?sz=128", "display_name": "Joseph Cho", "link": "https://stackoverflow.com/users/4842949/joseph-cho"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1531937705, "post_id": 51408268, "comment_id": 89788291, "body": "@SergioTulentsev Not even, can&#39;t you hardcode paths and those files will load when you load html in a browser? Don&#39;t need sinatra for that. (btw it is an honor speaking to you)"}, {"owner": {"reputation": 89, "user_id": 10084075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cba1ee8e069d094ae73e2dd5e732ab1?s=128&d=identicon&r=PG&f=1", "display_name": "Rookie1999", "link": "https://stackoverflow.com/users/10084075/rookie1999"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1531937719, "post_id": 51408268, "comment_id": 89788298, "body": "@SergioTulentsev: SHall I post my .html.erb file ? this is for a small html page generation by reading input file."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1531937867, "post_id": 51408268, "comment_id": 89788383, "body": "@Rookie1999 &quot;shall I post my .html.erb file&quot; - not yet. Can we assume that you know <i>precisely</i> what html content you want to get? Or, given your background, you have only a vague idea how html/js/css interact?"}, {"owner": {"reputation": 89, "user_id": 10084075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cba1ee8e069d094ae73e2dd5e732ab1?s=128&d=identicon&r=PG&f=1", "display_name": "Rookie1999", "link": "https://stackoverflow.com/users/10084075/rookie1999"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1531937997, "post_id": 51408268, "comment_id": 89788460, "body": "@SergioTulentsev : You&#39;re right :) I do really have a very little idea how these 3 interacts. I have the idea what HTML content I should have but how to get there is the problem :("}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 3119, "user_id": 4842949, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0agpj31wtZ8/AAAAAAAAAAI/AAAAAAAAAAA/mSolbNN-zIY/photo.jpg?sz=128", "display_name": "Joseph Cho", "link": "https://stackoverflow.com/users/4842949/joseph-cho"}, "edited": false, "score": 0, "creation_date": 1531938062, "post_id": 51408268, "comment_id": 89788503, "body": "@JosephCho &quot;when you load html in a browser&quot; - when you load from local filesystem, yes. To put it online, you need a web server."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1531938220, "post_id": 51408268, "comment_id": 89788601, "body": "@Rookie1999: &quot;I have the idea what HTML content I should have&quot; - I have a feeling that this question will end up closed as &quot;too broad&quot;, but let&#39;s try it. Post your desired/expected html content, with js/css &quot;called&quot;."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 3119, "user_id": 4842949, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0agpj31wtZ8/AAAAAAAAAAI/AAAAAAAAAAA/mSolbNN-zIY/photo.jpg?sz=128", "display_name": "Joseph Cho", "link": "https://stackoverflow.com/users/4842949/joseph-cho"}, "edited": false, "score": 0, "creation_date": 1531938256, "post_id": 51408268, "comment_id": 89788625, "body": "@JosephCho &quot;btw it is an honor speaking to you&quot; - oh stop it, you. :)"}, {"owner": {"reputation": 89, "user_id": 10084075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cba1ee8e069d094ae73e2dd5e732ab1?s=128&d=identicon&r=PG&f=1", "display_name": "Rookie1999", "link": "https://stackoverflow.com/users/10084075/rookie1999"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1531938547, "post_id": 51408268, "comment_id": 89788791, "body": "@SergioTulentsev : Thank you sir for your time here. <a href=\"https://jsfiddle.net/p9mtqhm7/507/\" rel=\"nofollow noreferrer\">jsfiddle.net/p9mtqhm7/507</a>  I want to expand and collapse table rows when header row is clicked - here say SERVER 1. I only want to expand/collapse rows which are under the specific header (clicked)."}, {"owner": {"reputation": 89, "user_id": 10084075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cba1ee8e069d094ae73e2dd5e732ab1?s=128&d=identicon&r=PG&f=1", "display_name": "Rookie1999", "link": "https://stackoverflow.com/users/10084075/rookie1999"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1531938779, "post_id": 51408268, "comment_id": 89788940, "body": "@SergioTulentsev : <a href=\"https://jsfiddle.net/p9mtqhm7/508/\" rel=\"nofollow noreferrer\">jsfiddle.net/p9mtqhm7/508</a>  I just wanted iterate the final processed data structure and print the respective server and its details as collapsible/expandable format sir. What I have shared is a sample :)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1531940954, "post_id": 51408268, "comment_id": 89790153, "body": "@Rookie1999: ah yes, embedding. Take a look at frame source of &quot;result&quot; pane. You&#39;ll see that your JS is embedded right on the page in a <code>&lt;script type=&#39;text&#47;javascript&#39;&gt;</code> tag. So that&#39;s what you want to do in your template, open JS file, read it, and print its contents with <code>&lt;%= %&gt;</code>. See Johan&#39;s answer."}, {"owner": {"reputation": 89, "user_id": 10084075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cba1ee8e069d094ae73e2dd5e732ab1?s=128&d=identicon&r=PG&f=1", "display_name": "Rookie1999", "link": "https://stackoverflow.com/users/10084075/rookie1999"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1531971552, "post_id": 51408268, "comment_id": 89799322, "body": "@SergioTulentsev: Thanks much :)"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 10084075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cba1ee8e069d094ae73e2dd5e732ab1?s=128&d=identicon&r=PG&f=1", "display_name": "Rookie1999", "link": "https://stackoverflow.com/users/10084075/rookie1999"}, "edited": false, "score": 0, "creation_date": 1531971603, "post_id": 51409388, "comment_id": 89799334, "body": "Thanks a lot for the vivid explanation, that really helped :)"}], "tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": true, "score": 1, "last_activity_date": 1531941643, "last_edit_date": 1531941643, "creation_date": 1531940929, "answer_id": 51409388, "question_id": 51408268, "link": "https://stackoverflow.com/questions/51408268/how-to-call-js-and-css-files-inside-a-html-erb-file/51409388#51409388", "title": "How to call js and css files inside a html.erb file", "body": "<p>You can include the JavaScript in the <code>.html.erb</code> file in the same way you load the text file. The simplest (code wise) solution is doing something along the lines of this:</p>\n\n<p><em>plan.html.erb</em></p>\n\n<pre><code>&lt;script&gt;\n&lt;%= File.read('some/file.js') %&gt;\n&lt;/script&gt;\n</code></pre>\n\n<p>However if you are expecting a <code>&lt;script src=\"some/file.js\"&gt;&lt;/script&gt;</code> as result you'll have to create your own helper or use an existing one from some light weight web framework. A simple example might be:</p>\n\n<p><em>lib/html_helpers.rb</em></p>\n\n<pre><code>require 'builder'\n\nmodule HtmlHelpers\n\n  def javascript_include_tag(path)\n    Builder::XmlMarkup.new.script('', src: path)\n    #=&gt; %{&lt;script src=\"#{html_escaped_path}\"&gt;&lt;/script&gt;}\n  end\n\nend\n</code></pre>\n\n<p><em>plan.html.erb</em></p>\n\n<pre><code>&lt;% require 'html_helpers' %&gt;\n&lt;% include HtmlHelpers %&gt;\n&lt;%= javascript_include_tag('some/file.js') %&gt;\n</code></pre>\n\n<p>Keep in mind that the first solution doesn't escape any HTML characters. Meaning that if your script contains <code>&lt;/script&gt;</code> everything following that tag will be interpreted as HTML.</p>\n"}], "owner": {"reputation": 89, "user_id": 10084075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cba1ee8e069d094ae73e2dd5e732ab1?s=128&d=identicon&r=PG&f=1", "display_name": "Rookie1999", "link": "https://stackoverflow.com/users/10084075/rookie1999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 758, "favorite_count": 0, "accepted_answer_id": 51409388, "answer_count": 1, "score": 0, "last_activity_date": 1531941643, "creation_date": 1531936530, "question_id": 51408268, "link": "https://stackoverflow.com/questions/51408268/how-to-call-js-and-css-files-inside-a-html-erb-file", "title": "How to call js and css files inside a html.erb file", "body": "<p>I'm quite new to Ruby and ERB and for this case I'm using only Ruby and not rails.</p>\n\n<pre><code>E:\\ruby\n   -app.rb\n   -plan.html.erb\n   -check.css\n   -track.js [js + jquery framework]\n</code></pre>\n\n<p>Inside app.rb I've the following lines</p>\n\n<pre><code>text = File.open((\"final.html\"), \"w+\")\ntext.puts ERB.new(File.read(\"plan.html.erb\")).result binding\n</code></pre>\n\n<p>I'm not sure how to call the .js and .css files inside the .html.erb file. Kindly let me know if I've to post the .html.erb file in case that would be helpful to debug further, thanks.</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "syntax-error"], "answers": [{"tags": [], "owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "is_accepted": true, "score": 1, "last_activity_date": 1531935604, "last_edit_date": 1531935604, "creation_date": 1531934788, "answer_id": 51407825, "question_id": 51407541, "link": "https://stackoverflow.com/questions/51407541/json-parsing-error-with-erb-on-ruby-on-rails/51407825#51407825", "title": "JSON parsing error with erb on Ruby on Rails", "body": "<p>Try this in <code>javascript_tag</code>:</p>\n\n<pre><code>var thing = &lt;%= @myJSON.to_json.html_safe %&gt;;\n</code></pre>\n"}], "owner": {"reputation": 84, "user_id": 9347193, "user_type": "registered", "profile_image": "https://graph.facebook.com/1514243305340265/picture?type=large", "display_name": "Rafael Baldasso Audibert", "link": "https://stackoverflow.com/users/9347193/rafael-baldasso-audibert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "accepted_answer_id": 51407825, "answer_count": 1, "score": 0, "last_activity_date": 1531935604, "creation_date": 1531933782, "question_id": 51407541, "link": "https://stackoverflow.com/questions/51407541/json-parsing-error-with-erb-on-ruby-on-rails", "title": "JSON parsing error with erb on Ruby on Rails", "body": "<p>I'm trying to be able to have acess to a <code>JSON</code> file in a script tag in a <code>.erb</code> file which is a view for my Rails project.</p>\n\n<p>I have this in my controller:</p>\n\n<pre><code>@myJSON = JSON(IO.binread(\"./path/to/file.json\"));\n</code></pre>\n\n<p>And I have tried this in the view file:</p>\n\n<pre><code>&lt;%= javascript_tag do %&gt;\n    var thing = &lt;%= @myJSON %&gt;;\n&lt;% end %&gt;\n</code></pre>\n\n<p>But it gives me a SyntaxError in the console <code>SyntaxError: expected property name, got '&amp;'</code>, which is pretty obvious because the output in the code is something like:</p>\n\n<pre><code>var thing = [{&amp;quot;sigla&amp;quot;=&amp;gt;&amp;quot;AC&amp;quot;, &amp;quot;nome&amp;quot;=&amp;gt;&amp;quot;Acre&amp;quot;, &amp;quot;cidades&amp;quot;=&amp;gt;[&amp;quot;Rio Branco&amp;quot;, ...]}]\n</code></pre>\n\n<p>What am I getting wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1531931652, "post_id": 51406976, "comment_id": 89785125, "body": "You mean, feature specs? Which launch an external browser?"}, {"owner": {"reputation": 480, "user_id": 6026157, "user_type": "registered", "profile_image": "https://graph.facebook.com/1204300196264072/picture?type=large", "display_name": "Mahmoud Sultan", "link": "https://stackoverflow.com/users/6026157/mahmoud-sultan"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1531931719, "post_id": 51406976, "comment_id": 89785169, "body": "No, it&#39;s a custom ruby script."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1531931774, "post_id": 51406976, "comment_id": 89785211, "body": "Yeah, yeah, that&#39;s not what I was asking. What kind of specs are you talking about? Most of them do not start a rails server at all."}, {"owner": {"reputation": 480, "user_id": 6026157, "user_type": "registered", "profile_image": "https://graph.facebook.com/1204300196264072/picture?type=large", "display_name": "Mahmoud Sultan", "link": "https://stackoverflow.com/users/6026157/mahmoud-sultan"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1531932060, "post_id": 51406976, "comment_id": 89785372, "body": "In a controller spec, which specs start a server?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 3, "creation_date": 1531932165, "post_id": 51406976, "comment_id": 89785426, "body": "Controller specs do not start a server. Feature specs (with capybara) do."}, {"owner": {"reputation": 480, "user_id": 6026157, "user_type": "registered", "profile_image": "https://graph.facebook.com/1204300196264072/picture?type=large", "display_name": "Mahmoud Sultan", "link": "https://stackoverflow.com/users/6026157/mahmoud-sultan"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1531932554, "post_id": 51406976, "comment_id": 89785626, "body": "Okay, using capybara how can I get the port number?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1531932639, "post_id": 51406976, "comment_id": 89785683, "body": "Get it from the request environment: <a href=\"https://stackoverflow.com/questions/2813290/how-do-i-get-the-host-and-port-in-a-rails-application\" title=\"how do i get the host and port in a rails application\">stackoverflow.com/questions/2813290/&hellip;</a> and pass as script&#39;s argument"}], "owner": {"reputation": 480, "user_id": 6026157, "user_type": "registered", "profile_image": "https://graph.facebook.com/1204300196264072/picture?type=large", "display_name": "Mahmoud Sultan", "link": "https://stackoverflow.com/users/6026157/mahmoud-sultan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 324, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531932879, "creation_date": 1531931563, "question_id": 51406976, "link": "https://stackoverflow.com/questions/51406976/how-to-know-the-port-number-of-the-running-rails-server-in-rspec-test", "title": "How to know the port number of the running rails server in rspec test", "body": "<p>I need to run an external script inside an RSpec test and to do so I need to know port number of the rails server running for the RSpec test.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": true, "score": 2, "last_activity_date": 1531931905, "creation_date": 1531931905, "answer_id": 51407062, "question_id": 51406745, "link": "https://stackoverflow.com/questions/51406745/not-able-to-permitting-params-with-rails-5/51407062#51407062", "title": "Not able to permitting params with rails 5", "body": "<p>The reason is that <code>params[:nodes_list]</code> is actually a hash, and method <code>each</code> works for hashes differently:</p>\n\n<pre><code>{ a: 1, b: 2 }.each do |key, value|\n  p \"#{key} =&gt; #{value}\"\nend\n</code></pre>\n\n<p>prints:</p>\n\n<pre><code>\"a =&gt; 1\"\n\"b =&gt; 2\"\n</code></pre>\n\n<p>That's why you need to modify your code either:</p>\n\n<pre><code>def forming_position\n  nodes = params[:nodes_list].permit!\n  nodes.each do |position, value|\n    recursive_sorting(position, value)\n  end\nend\n\ndef recursive_sorting(position, value, parent = nil)\n  ......\nend\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>def forming_position\n  nodes = params[:nodes_list].permit!\n  nodes.each do |position, value|\n    recursive_sorting([position, value])\n  end\nend\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>def forming_position\n  nodes = params[:nodes_list].permit!\n  nodes.to_a.each do |node|\n    recursive_sorting(node)\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 493, "user_id": 3616806, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5e239b7b5f6e0938a4393e0a639b0aa5?s=128&d=identicon&r=PG&f=1", "display_name": "Remember_me", "link": "https://stackoverflow.com/users/3616806/remember-me"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 51407062, "answer_count": 1, "score": 1, "last_activity_date": 1531931905, "creation_date": 1531930716, "question_id": 51406745, "link": "https://stackoverflow.com/questions/51406745/not-able-to-permitting-params-with-rails-5", "title": "Not able to permitting params with rails 5", "body": "<p>I have a method that takes params from the request, and sorts the existing data, there is no saving involved, here is a method :</p>\n\n<pre><code>def forming_position\n  nodes = params[:nodes_list].permit!\n  nodes.each do |node|\n    recursive_sorting node\n  end\nend\n</code></pre>\n\n<p>Here is relevant bit of method <code>recursive_sorting</code>:</p>\n\n<pre><code>def recursive_sorting(node, parent = nil)\n  position = node[0]\n  value = node[1]\n  ......\nend\n</code></pre>\n\n<p>The problem that I m having is that <code>.permit!</code> is either that I m using it wrong or not using correct method.</p>\n\n<p>Here are my actual <code>params[:nodes_list]</code> :</p>\n\n<pre><code>params[:nodes_list]\n=&gt; &lt;ActionController::Parameters {\"1\"=&gt;&lt;ActionController::Parameters {\"id\"=&gt;\"3\"} permitted: true&gt;, \"2\"=&gt;&lt;ActionController::Parameters {\"id\"=&gt;\"2\"} permitted: true&gt;, \"3\"=&gt;&lt;ActionController::Parameters {\"id\"=&gt;\"1\"} permitted: true&gt;} permitted: true&gt;\n</code></pre>\n\n<p>Here is the assigned <code>nodes</code> value :</p>\n\n<pre><code>nodes\n=&gt; &lt;ActionController::Parameters {\"1\"=&gt;&lt;ActionController::Parameters {\"id\"=&gt;\"3\"} permitted: true&gt;, \"2\"=&gt;&lt;ActionController::Parameters {\"id\"=&gt;\"2\"} permitted: true&gt;, \"3\"=&gt;&lt;ActionController::Parameters {\"id\"=&gt;\"1\"} permitted: true&gt;} permitted: true&gt;\nnodes == params[:nodes_list]\n=&gt; true\n</code></pre>\n\n<p>When I am inside <code>forming_positions</code> method, inside each method that uses <code>node</code> as inner loop variable. And I inspect it's value. It is :</p>\n\n<pre><code>node\n=&gt; \"1\"\n</code></pre>\n\n<p>But when I inspect <code>nodes.first</code> element it gives me correct value: </p>\n\n<pre><code>nodes.first\n=&gt; [\"1\", &lt;ActionController::Parameters {\"id\"=&gt;\"3\"} permitted: true&gt;]\n</code></pre>\n\n<p><strong>What is happening here?</strong> </p>\n\n<p>I need both key and a value in my <code>recursive_sorting</code> method, why is the node only getting passed around as a key only value. And what do I do to get both, was not sure if <code>permit!</code> is correct method to use here.</p>\n\n<p><strong>Which method should I use?</strong></p>\n"}, {"tags": ["ruby", "testing", "rspec"], "comments": [{"owner": {"reputation": 42135, "user_id": 103739, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/2dUhl.jpg?s=128&g=1", "display_name": "JP Silvashy", "link": "https://stackoverflow.com/users/103739/jp-silvashy"}, "edited": false, "score": 0, "creation_date": 1531927294, "post_id": 51405630, "comment_id": 89782304, "body": "Welcome Daniel, I think its worth taking the time to read this before asking a question: <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a> you may save your self from frustrations trying to get your answer :)"}, {"owner": {"reputation": 532, "user_id": 3162721, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/v314b.jpg?s=128&g=1", "display_name": "luispcosta", "link": "https://stackoverflow.com/users/3162721/luispcosta"}, "reply_to_user": {"reputation": 42135, "user_id": 103739, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/2dUhl.jpg?s=128&g=1", "display_name": "JP Silvashy", "link": "https://stackoverflow.com/users/103739/jp-silvashy"}, "edited": false, "score": 1, "creation_date": 1531930418, "post_id": 51405630, "comment_id": 89784417, "body": "Hello Daniel. Go ahead and follow @JPSilvashy suggestion. I don&#39;t understand what your problem is here."}, {"owner": {"reputation": 1, "user_id": 7380262, "user_type": "registered", "profile_image": "https://graph.facebook.com/10202540792677766/picture?type=large", "display_name": "Daniel Bela Toma", "link": "https://stackoverflow.com/users/7380262/daniel-bela-toma"}, "edited": false, "score": 0, "creation_date": 1531938900, "post_id": 51405630, "comment_id": 89789001, "body": "Sorry, thank you guys. Will update the issue."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7380262, "user_type": "registered", "profile_image": "https://graph.facebook.com/10202540792677766/picture?type=large", "display_name": "Daniel Bela Toma", "link": "https://stackoverflow.com/users/7380262/daniel-bela-toma"}, "edited": false, "score": 0, "creation_date": 1531939464, "post_id": 51407172, "comment_id": 89789293, "body": "Thanx for the answer. I have added the code I wrote so far in the question. It did not get saved when I first added the question. In the spec there is already a String::ParseError . Why and where should the String::Error go? Is this part of ruby (because I didn&#39;t find any info on it) or should I define it? Maybe it&#39;s too much to ask but it would really help me a lot if someone could write the code for this spec. I already spent many hours trying to figure it out. Thanx"}, {"owner": {"reputation": 1, "user_id": 7380262, "user_type": "registered", "profile_image": "https://graph.facebook.com/10202540792677766/picture?type=large", "display_name": "Daniel Bela Toma", "link": "https://stackoverflow.com/users/7380262/daniel-bela-toma"}, "edited": false, "score": 0, "creation_date": 1531940234, "post_id": 51407172, "comment_id": 89789757, "body": "And also how can String:Error be descendant of String:ParseError and in the same time String:ParseError be descendant of String:Error?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 1, "user_id": 7380262, "user_type": "registered", "profile_image": "https://graph.facebook.com/10202540792677766/picture?type=large", "display_name": "Daniel Bela Toma", "link": "https://stackoverflow.com/users/7380262/daniel-bela-toma"}, "edited": false, "score": 0, "creation_date": 1531941079, "post_id": 51407172, "comment_id": 89790218, "body": "@DanielBelaToma &quot;And also how can String:Error be descendant of String:ParseError and in the same time String:ParseError be descendant of String:Error?&quot; - no, you read that wrong. Hierarchy should be like this: <code>String::ParseError &lt; String::Error &lt; StandardError</code>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 1, "user_id": 7380262, "user_type": "registered", "profile_image": "https://graph.facebook.com/10202540792677766/picture?type=large", "display_name": "Daniel Bela Toma", "link": "https://stackoverflow.com/users/7380262/daniel-bela-toma"}, "edited": false, "score": 0, "creation_date": 1531941118, "post_id": 51407172, "comment_id": 89790233, "body": "@DanielBelaToma: yes, you&#39;re supposed to define <code>String::Error</code> and <code>String::ParseError</code>. Your code did get posted/saved, but I removed it, since it had nothing to do with the questions."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1531970352, "post_id": 51407172, "comment_id": 89799027, "body": "&quot;Operator &quot;less than&quot; has special behavior when used on classes.&quot; \u2013 Not really. It means &quot;send the message <code>&lt;</code> to the object on the left passing as an argument the object on the right&quot;, which is the same thing it means everywhere else. Even its semantics are the same it has in most other places: inheritance induces a partial order on classes (actually modules), and <code>Module#&lt;</code> is simply the &quot;less-than&quot; operator for that partial order."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1531986583, "post_id": 51407172, "comment_id": 89805322, "body": "@J&#246;rgWMittag: yeah, what I should have said: &quot;less-than operator is <i>defined</i> for classes&quot;. Because classes are not the first thing to come to mind when you think about things you can test for range inequality."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1531986949, "post_id": 51407172, "comment_id": 89805540, "body": "&quot;operator is defined&quot; as in &quot;classes understand message &lt;&quot;"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 1, "last_activity_date": 1531997967, "last_edit_date": 1531997967, "creation_date": 1531932347, "answer_id": 51407172, "question_id": 51405630, "link": "https://stackoverflow.com/questions/51405630/make-rspec-test-pass-in-ruby/51407172#51407172", "title": "Make rspec test pass in Ruby", "body": "<blockquote>\n  <p>In the test I have <code>expect(String::Error).to be &lt; StandardError</code>. I don't understand what this statement means. </p>\n</blockquote>\n\n<p>It means that <code>String::Error</code> should inherit from <code>StandardError</code>. Similarly for <code>String::ParseError</code>.</p>\n\n<blockquote>\n  <p>What is the <code>String::Error</code></p>\n</blockquote>\n\n<p>It's a class/constant.</p>\n\n<blockquote>\n  <p>and what the the \"&lt;\" operator in this case?</p>\n</blockquote>\n\n<p>Operator \"less than\" has special behavior when used on classes. One class is considered \"less than\" another class if it is its descendant.</p>\n\n<hr>\n\n<blockquote>\n  <p>Maybe it's too much to ask but it would really help me a lot if someone could write the code for this spec.</p>\n</blockquote>\n\n<p>I'm not going to write all of the implementation, but here's how people normally define custom exception classes.</p>\n\n<pre><code>class String\n  class Error &lt; StandardError\n  end\n\n  class ParseError &lt; Error # Error is resolved to String::Error here, which is defined above\n  end\nend\n</code></pre>\n\n<p>If your exception classes do not contain any custom methods, this is a better/shorter form of the above.    </p>\n\n<pre><code>class String\n  Error = Class.new(StandardError)\n  ParseError = Class.new(Error)\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7380262, "user_type": "registered", "profile_image": "https://graph.facebook.com/10202540792677766/picture?type=large", "display_name": "Daniel Bela Toma", "link": "https://stackoverflow.com/users/7380262/daniel-bela-toma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531997967, "creation_date": 1531927132, "last_edit_date": 1531977144, "question_id": 51405630, "link": "https://stackoverflow.com/questions/51405630/make-rspec-test-pass-in-ruby", "title": "Make rspec test pass in Ruby", "body": "<p>I have a test for which I need to write the code to make it pass. \nThe test is this:</p>\n\n<pre><code>require 'lib/String.rb'\nRSpec.describe String do\n  context '.to_h' do\n    let(:hash) { { 'hello' =&gt; 'tree' } }\n\n    it 'it should return the string parsed as a hash' do\n      expect(hash.to_s.gsub('=&gt;', ':').to_h).to eq(hash)\n    end\n\n    it 'should raise parse error if there was a parsing error' do\n      expect { hash.to_s.to_h }.to raise_error(String::ParseError)\n      expect(String::Error).to be &lt; StandardError\n      expect(String::ParseError).to be &lt; String::Error\n    end\n  end\nend\n</code></pre>\n\n<p>The code I wrote so far is:</p>\n\n<pre><code>class String\n    class ParseError &lt; StandardError\n        def initialize\n            String.const_set(\"Error\", self)\n        end\n    end\n\n    def to_h\n        if self.split(\":\").count&gt;1\n             eval(self.split(\":\")[0]+\"=&gt;\"+self.split(\":\")[1])\n        else\n            raise ParseError\n        end\n    end\nend\n</code></pre>\n\n<p>In the test I have \"expect(String::Error).to be &lt; StandardError\". I don't understand what this statement means. What is the String::Error and what the the \"&lt;\" operator in this case?</p>\n"}, {"tags": ["arrays", "ruby", "shuffle"], "comments": [{"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 4, "creation_date": 1531925901, "post_id": 51405113, "comment_id": 89781305, "body": "You can&#39;t &quot;set such conditions&quot;, you need to write an algorithm to do this. I would partition the array into N separate arrays containing the like elements, shuffle the individual arrays, and then recombine them by taking one element from a different array until all the arrays are empty. You need to make sure you don&#39;t leave yourself with too many elements in the final array."}, {"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 4, "creation_date": 1531925999, "post_id": 51405113, "comment_id": 89781375, "body": "<code>until (your_custom_condition) do array.shuffle! end</code>"}, {"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 3, "creation_date": 1531926060, "post_id": 51405113, "comment_id": 89781429, "body": "@llya I&#39;m not sure if you&#39;re joking, but that the worst possible way of doing this."}, {"owner": {"reputation": 17, "user_id": 10100322, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ogVzW.png?s=128&g=1", "display_name": "SavageHolycow", "link": "https://stackoverflow.com/users/10100322/savageholycow"}, "edited": false, "score": 0, "creation_date": 1531926253, "post_id": 51405113, "comment_id": 89781567, "body": "I am quite a beginner.. When finally made my dream &quot;CUBE TIMER&quot;, this problem showed up outta nowhere :(  If <code>R&#39;</code> is beside <code>R</code> then there&#39;s no point in having these two at all. And if <code>R2</code> is beside <code>R&#39;</code> then it&#39;s the same as <code>R</code> and vice versa.  Implementing custom logic..."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 0, "creation_date": 1531928911, "post_id": 51405113, "comment_id": 89783364, "body": "@meagar, llya&#39;s suggestion has one important thing going for it: it produces a random sequence (subject the limitations of  <code>shuffle</code> producing a truly random ordering). By contrast, with your suggested approach, suppose one of the groups of &quot;like elements&quot; contained a single element <code>e</code> and at least one of the other groups contained more than one element. The element <code>e</code> would never be selected last, so the approach would not generate a random sequencing...."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1531928932, "post_id": 51405113, "comment_id": 89783381, "body": "...to produce a random sequence, @llya&#39;s approach is the only one that comes to mind."}, {"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 0, "creation_date": 1531928972, "post_id": 51405113, "comment_id": 89783414, "body": "Ah, I should have recognized this as cube notation. So, instead of generating a list of moves and then trying to shuffle it until there are no redundant moves, why not just search for any adjacent redundancies and remove them, and append two new random moves to the end of the array to maintain its length? Note that it&#39;s possible to have longer sequences of redundant moves. <code>[&#39;R&#39;, &#39;R&#39;, &#39;R&#39;, &#39;R&#39;]</code> for example. You will have a very hard time finding and fixing all of them without actually modeling the cube and turning its faces, and looking for repeated states."}, {"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 1, "creation_date": 1531929051, "post_id": 51405113, "comment_id": 89783459, "body": "Alternatively, you could generate the sequence in a slightly smarter way and simply make sure that each step turns a different face than the previous step."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1531930408, "post_id": 51405113, "comment_id": 89784411, "body": "This is in principle a very difficult problem. Suppose, for example, there were <code>n</code> red objects and <code>n</code> blue objects, and no two same-coloured objects were to be adjacent in the resulting sequence. The only valid sequence would have the red and blue objects alternate, of which there are two, one beginning with a red object, the other a blue. If one were to adopt @llya&#39;s suggested approach the probability of drawing one of these two sequences would be <code>2**(-2n+1)</code>. If <code>n</code> were large, this would not be feasible, but neither would be any other algorithm that produces a random sequence."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1531930726, "post_id": 51405113, "comment_id": 89784569, "body": "Savage, I&#39;m curious why you want to do this."}, {"owner": {"reputation": 17, "user_id": 10100322, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ogVzW.png?s=128&g=1", "display_name": "SavageHolycow", "link": "https://stackoverflow.com/users/10100322/savageholycow"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1531932401, "post_id": 51405113, "comment_id": 89785545, "body": "@CarySwoveland I have built a simple &quot;Cube Timer&quot;. For an Example of so you could visit <a href=\"http://cstimer.net\" rel=\"nofollow noreferrer\">link</a>. I have chosen the ARRAY way for the Scramble Notations. I don&#39;t know if there are any.  As I said, If R&#39; is beside R then there&#39;s no point in having these two at all. And if R2 is beside R&#39; then it&#39;s the same as R and vice versa"}, {"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 0, "creation_date": 1531936888, "post_id": 51405113, "comment_id": 89787897, "body": "@SavageHolycow You should simply generate a correct array in the first place, rather than generating a random array and trying to determine if it contains redundant turns. It&#39;s trivially easy to generate an array that doesn&#39;t turn the same side twice in a row."}, {"owner": {"reputation": 2366, "user_id": 1644614, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/2NKuT.jpg?s=128&g=1", "display_name": "vaibhavatul47", "link": "https://stackoverflow.com/users/1644614/vaibhavatul47"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1531951706, "post_id": 51405113, "comment_id": 89794932, "body": "@CarySwoveland I&#39;ve attempted to solve this problem in a general context. I&#39;ve updated my answer with results on your input."}], "answers": [{"comments": [{"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 0, "creation_date": 1531936473, "post_id": 51407602, "comment_id": 89787689, "body": "This seems massively overwrought. Why not just do this: <a href=\"https://gist.github.com/meagar/d484eb4a1868b83513dac2c61bc5710d\" rel=\"nofollow noreferrer\">gist.github.com/meagar/d484eb4a1868b83513dac2c61bc5710d</a>"}, {"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 0, "creation_date": 1531936790, "post_id": 51407602, "comment_id": 89787849, "body": "Or, in two lines: <a href=\"https://gist.github.com/meagar/5d45cffebefa563a8b3ca01e3abd9a4e\" rel=\"nofollow noreferrer\">gist.github.com/meagar/5d45cffebefa563a8b3ca01e3abd9a4e</a>"}, {"owner": {"reputation": 2366, "user_id": 1644614, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/2NKuT.jpg?s=128&g=1", "display_name": "vaibhavatul47", "link": "https://stackoverflow.com/users/1644614/vaibhavatul47"}, "reply_to_user": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 0, "creation_date": 1531946428, "post_id": 51407602, "comment_id": 89792731, "body": "@meagar: Your solution is great, but the OP asked for a way to shuffle a given array so that some set of elements are not consecutive. In your solution there are chances that some elements may be repeated more than once, or some elements may not be present in final output. This anomaly doesn&#39;t make much impact if we are only concerned about shuffling a rubiks cube."}, {"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "reply_to_user": {"reputation": 2366, "user_id": 1644614, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/2NKuT.jpg?s=128&g=1", "display_name": "vaibhavatul47", "link": "https://stackoverflow.com/users/1644614/vaibhavatul47"}, "edited": false, "score": 0, "creation_date": 1531946647, "post_id": 51407602, "comment_id": 89792828, "body": "@AtulVaibhav it\u2019s is desirable that elements repeat, the elements are not unique."}, {"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "reply_to_user": {"reputation": 2366, "user_id": 1644614, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/2NKuT.jpg?s=128&g=1", "display_name": "vaibhavatul47", "link": "https://stackoverflow.com/users/1644614/vaibhavatul47"}, "edited": false, "score": 0, "creation_date": 1531947469, "post_id": 51407602, "comment_id": 89793215, "body": "@AtulVaibhav Why? My comments are not answers, the question does not have to match them and my comments don\u2019t have to match the question."}, {"owner": {"reputation": 17, "user_id": 10100322, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ogVzW.png?s=128&g=1", "display_name": "SavageHolycow", "link": "https://stackoverflow.com/users/10100322/savageholycow"}, "reply_to_user": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 0, "creation_date": 1531992930, "post_id": 51407602, "comment_id": 89809171, "body": "@meagar This two line one&#39;s so efficient and well thought! Great job!"}, {"owner": {"reputation": 17, "user_id": 10100322, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ogVzW.png?s=128&g=1", "display_name": "SavageHolycow", "link": "https://stackoverflow.com/users/10100322/savageholycow"}, "reply_to_user": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 0, "creation_date": 1531992965, "post_id": 51407602, "comment_id": 89809193, "body": "@meagar I I&#39;m taking this IDEA! 8-)"}], "tags": [], "owner": {"reputation": 17, "user_id": 10100322, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ogVzW.png?s=128&g=1", "display_name": "SavageHolycow", "link": "https://stackoverflow.com/users/10100322/savageholycow"}, "is_accepted": true, "score": 0, "last_activity_date": 1531979969, "last_edit_date": 1531979969, "creation_date": 1531933984, "answer_id": 51407602, "question_id": 51405113, "link": "https://stackoverflow.com/questions/51405113/shuffling-an-array-with-a-condition/51407602#51407602", "title": "Shuffling an array with a condition", "body": "<p><strong>Juksefantomet</strong> sent me this solution in discord, since he can't post here due to an account lock.</p>\n\n<p>The below codeblock contains an alternative approach on how to tackle the problem at hand. This contains a fragmented solution to understand the steps on how you would normally approach a complex problem like the one presented above.</p>\n\n<p>going through the various steps you can see how each condition has to be known in advance and specified to the point where your final array is not \"illegal\".</p>\n\n<pre><code>    @illegal_order = ['1','2','3','4','5','6','7','8','9']\n\n    puts @illegal_order.count\n\n    puts \"#{@illegal_order}\"\n\n    @foo = []\n\n    # traverse the original array and append a random value from that into foo array\n    # this can of course and should be done in a loop where you check for duplicates\n    # this is done below in this example, fragmented to see the individual action\n    (0..@illegal_order.count).each do |add_value|\n        @temp = @illegal_order[rand(@illegal_order.count)]\n        unless @foo.count == @illegal_order.count\n            @foo.push(@temp)\n        end\n    end\n\n    # making sure it contains everything in the original array\n    @foo.each do |bar|\n        unless @illegal_order.include?(bar)\n            @approve = false\n            puts \"Errored generation!\"\n        end\n    end\n\n    # defining patterns, this can of course be extracted by the original array and be done alot cleaner\n    # but printing it out to better break it down\n    @pattern1 = [@illegal_order[0],@illegal_order[1],@illegal_order[2]]\n    @pattern2 = [@illegal_order[3],@illegal_order[4],@illegal_order[5]]\n    @pattern3 = [@illegal_order[6],@illegal_order[7],@illegal_order[8]]\n\n    # Let us step through the new array and use case to check for various conditions that would flag the new array as invalid\n    @foo.each do |step|\n        # setting a temp pattern based on current state\n        @temp_pattern = [@foo[step.to_i-1],@illegal_order[step.to_i],@illegal_order[step.to_i+1]]\n        case step\n        when @temp_pattern == @pattern1\n            @illegalpatterns = true\n        when @temp_pattern == @pattern2\n            @illegalpatterns = true\n        when @temp_pattern == @pattern3\n            @illegalpatterns = true\n        end\n        # checking the foo array if it contains duplicates, if yes, set conditional to true\n        @illegal_order.each do |count|\n            if @foo.count(count) &gt; 1\n                @duplicates = true\n            end\n        end\n    end\n\n    # printing out feedback based on duplicates or not, this is where you rescramble the array if duplicate found\n    (@duplicates == true) ? (puts \"dupes found\") : (puts \"looks clear. no duplicates\")\n    # printing out feedback based on illegal patterns or not, this is where you rescramble the array if duplicate found\n    (@illegalpatterns == true) ? (puts \"illegal patterns found\") : (puts \"looks clear, no illegal patterns\")\n\n    puts \"#{@foo}\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1531965399, "post_id": 51410462, "comment_id": 89798052, "body": "My understanding is that the OP wishes to randomly select a sequence among all &quot;valid&quot; sequences. I do not believe your solution satisfies the &quot;random&quot; requirement. Suppose, for example, that your <code>all_groups</code> array were <code>[a,b,c,d]</code> where <code>a=[&quot;a1&quot;, &quot;a2&quot;,...,&quot;a100&quot;]</code>, <code>b=[&quot;b1&quot;,&quot;b2&quot;...&quot;b100&quot;]</code>, <code>c=[&quot;c1&quot;,&quot;c2&quot;...&quot;c100&quot;]</code> and <code>d = [&quot;d1&quot;]</code>.  The location of <code>d1</code> in each randomly drawn &quot;valid&quot; sequence should be more-or-less randomly distributed among the 301 possible positions. You procedure, however, would tend to put <code>d1</code> near the beginning of each sequence."}, {"owner": {"reputation": 2366, "user_id": 1644614, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/2NKuT.jpg?s=128&g=1", "display_name": "vaibhavatul47", "link": "https://stackoverflow.com/users/1644614/vaibhavatul47"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1531974652, "post_id": 51410462, "comment_id": 89800011, "body": "@CarySwoveland correct, problem in my solution is that I&#39;m treating all groups with same probability. I&#39;ll try to add the length of each group as weights when determining from which group next element should belong."}], "tags": [], "owner": {"reputation": 2366, "user_id": 1644614, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/2NKuT.jpg?s=128&g=1", "display_name": "vaibhavatul47", "link": "https://stackoverflow.com/users/1644614/vaibhavatul47"}, "is_accepted": false, "score": 0, "last_activity_date": 1531951949, "last_edit_date": 1531951949, "creation_date": 1531945604, "answer_id": 51410462, "question_id": 51405113, "link": "https://stackoverflow.com/questions/51405113/shuffling-an-array-with-a-condition/51410462#51410462", "title": "Shuffling an array with a condition", "body": "<p>Lets derive a generic solution.</p>\n\n<p>Given a 2D array of groups of elements, return an array of shuffled elements such that no two consecutive elements belong to same group.</p>\n\n<p>For example:</p>\n\n<pre><code>all_groups = [\n  [\"R\", \"R'\", \"R2\" ],\n  [\"L\", \"L'\", \"L2\" ],\n  [\"U\", \"U'\", \"U2\" ],\n  [\"D\", \"D'\", \"D2\" ],\n  [\"F\", \"F'\", \"F2\" ],\n  [\"B\", \"B'\", \"B2\" ]\n]\n</code></pre>\n\n<p>Expected output:</p>\n\n<pre><code>[\"F'\", \"U'\", \"R'\", \"L2\", \"R2\", \"D2\", \"F2\", \"R\", \"L\", \"B\", \"F\", \"L'\", \"D'\", \"B'\", \"U2\", \"B2\", \"U\", \"D\"]\n</code></pre>\n\n<hr>\n\n<p><em>TL;DR</em> Code:</p>\n\n<pre><code>all_groups = [\n  [\"R\", \"R'\", \"R2\" ],\n  [\"L\", \"L'\", \"L2\" ],\n  [\"U\", \"U'\", \"U2\" ],\n  [\"D\", \"D'\", \"D2\" ],\n  [\"F\", \"F'\", \"F2\" ],\n  [\"B\", \"B'\", \"B2\" ]\n]\n\nans = []\n\ntotal = all_groups.map(&amp;:length).reduce(:+)\n\n# Initial shuffling\nall_groups = all_groups.each { |i| i.shuffle! }.shuffle\n\nuntil all_groups.empty?\n  # Select and pop last group\n  last_group = all_groups.pop\n\n  # Insert last element to our ans, and remove from group\n  ans.push(last_group.pop)\n  total -= 1\n\n  # Shuffle remaining groups\n  all_groups.shuffle!\n\n  # Check if any group has reached critical state\n  length_of_longest_group = all_groups.reduce(0) { |len, i| [len, i.length].max }\n  if length_of_longest_group * 2 == total + 1\n    # Move that group to last\n    # This ensures that next element picked is from this group\n    longest_group = all_groups.detect { |i| i.length == length_of_longest_group }\n    all_groups.delete(longest_group)\n    all_groups.push(longest_group)\n  end\n\n  # Insert the last group at first place. This ensures that next element\n  # is not from this group.\n  all_groups.unshift(last_group) unless last_group.empty?\nend\n\nputs ans.inspect\n</code></pre>\n\n<p>Examples:</p>\n\n<pre><code>all_groups = [\n  [\"R\", \"R'\", \"R2\" ],\n  [\"L\", \"L'\", \"L2\" ],\n  [\"U\", \"U'\", \"U2\" ],\n  [\"D\", \"D'\", \"D2\" ],\n  [\"F\", \"F'\", \"F2\" ],\n  [\"B\", \"B'\", \"B2\" ]\n]\n\n# Output 1:\nans = [\"B'\", \"U'\", \"L'\", \"U2\", \"R\", \"B2\", \"F2\", \"R2\", \"D2\", \"L2\", \"D\", \"R'\", \"U\", \"F'\", \"D'\", \"L\", \"F\", \"B\"]\n# Output 2:\nans = [\"U'\", \"R\", \"D\", \"R'\", \"U\", \"D2\", \"B2\", \"D'\", \"L\", \"B\", \"L2\", \"B'\", \"U2\", \"F'\", \"L'\", \"F\", \"R2\", \"F2\"]\n# Output 3:\nans = [\"B\", \"D\", \"R'\", \"D'\", \"B'\", \"R\", \"F2\", \"L\", \"D2\", \"B2\", \"F'\", \"R2\", \"U'\", \"F\", \"L'\", \"U2\", \"L2\", \"U\"]\n# Output 4:\nans = [\"U'\", \"F'\", \"R2\", \"B2\", \"D\", \"L2\", \"B'\", \"U\", \"R\", \"B\", \"R'\", \"L'\", \"D'\", \"U2\", \"F\", \"D2\", \"F2\", \"L\"]\n# Output 5:\nans = [\"U2\", \"F2\", \"L'\", \"F'\", \"R'\", \"F\", \"D'\", \"B2\", \"D2\", \"L\", \"B\", \"D\", \"L2\", \"B'\", \"R\", \"U\", \"R2\", \"U'\"]\n\n\n\nall_groups = [\n  ['a', 'aa', 'aaa', 'A', 'AA', 'AAA'],\n  ['b', 'bb', 'bbb', 'B', 'BB', 'BBB'],\n  ['c', 'cc', 'ccc', 'C', 'CC', 'CCC']\n]\nans = [\"c\", \"AAA\", \"B\", \"ccc\", \"bbb\", \"C\", \"AA\", \"CC\", \"aa\", \"BB\", \"CCC\", \"bb\", \"cc\", \"A\", \"BBB\", \"a\", \"b\", \"aaa\"]\n\n\nall_groups = [\n  ['r1', 'r2', 'r3', 'r4', 'r5', 'r6', 'r7', 'r8'],\n  ['b1', 'b2', 'b3', 'b4', 'b5', 'b6', 'b7', 'b8']\n]\n\n# Output1:\nans = [\"r2\", \"b7\", \"r1\", \"b5\", \"r7\", \"b6\", \"r3\", \"b8\", \"r4\", \"b3\", \"r5\", \"b1\", \"r6\", \"b4\", \"r8\", \"b2\"]\n# Output2:\nans = [\"b6\", \"r8\", \"b2\", \"r1\", \"b4\", \"r2\", \"b8\", \"r7\", \"b3\", \"r4\", \"b5\", \"r5\", \"b7\", \"r3\", \"b1\", \"r6\"]\n</code></pre>\n\n<p><hr>\n<em>Explanation:</em><br><br></p>\n\n<p>To begin with, lets shuffle the input data. First we shuffle each group, then we shuffle the outer array.</p>\n\n<pre><code>all_groups = all_groups.each { |i| i.shuffle! }.shuffle\n</code></pre>\n\n<p>Now our array looks like this:</p>\n\n<pre><code>[[\"B\", \"B2\", \"B'\"],\n [\"F'\", \"F\", \"F2\"],\n [\"L\", \"L2\", \"L'\"],\n [\"R2\", \"R'\", \"R\"],\n [\"D\", \"D'\", \"D2\"],\n [\"U'\", \"U\", \"U2\"]]\n</code></pre>\n\n<p>Now, if we traverse this array in column-major order, we get a prety decent shuffling of elements wherein no two consecutive elements belong to same group.</p>\n\n<pre><code>[\"B\", \"F'\", \"L\", \"R2\", \"D\", \"U'\", \"B2\", \"F\", \"L2\", \"R'\", \"D'\", \"U\", \"B'\", \"F2\", \"L'\", \"R\", \"D2\", \"U2\"]\n</code></pre>\n\n<p>But only flaw in this is that all elements of a particular group are equidistant. Lets improve.<br><br></p>\n\n<p>So we have a set of groups. Lets select any one of group and then select the last element from that group and add this element to our answer array. Now shuffle the 2D array and repeat until all elements are selected.<br></p>\n\n<p>Also, we don't want any two consecutive elements to belong to same group, so we need to ensure that the next selection of element is from some other group. So how about this strategy:<br></p>\n\n<p><em>Always pick the last group from our 2d array, and then once we shuffle we will ensure that this group is not the last group in 2d array.</em></p>\n\n<p>In terms of psuedocode:</p>\n\n<pre><code>1. Select last group from 2d array.\n2. Remove an element from this group.\n3. Shuffle the order of other groups in 2d array\n4. Insert the selected group at begining.\n</code></pre>\n\n<p>For example, lets start with this 2d array:</p>\n\n<pre><code>[[\"D\", \"D'\", \"D2\"],\n [\"U\", \"U'\", \"U2\"],\n [\"B2\", \"B\", \"B'\"],\n [\"F2\", \"F\", \"F'\"],\n [\"L'\", \"L\", \"L2\"],\n [\"R'\", \"R2\", \"R\"]]\n</code></pre>\n\n<p>last group: <code>[\"R'\", \"R2\", \"R\"]</code><br>\nElement removed: (\"R\")</p>\n\n<p>Shuffle order of remaining groups of 2d array:</p>\n\n<pre><code>[[\"L'\", \"L\", \"L2\"],\n [\"B2\", \"B\", \"B'\"],\n [\"D\", \"D'\", \"D2\"],\n [\"U\", \"U'\", \"U2\"],\n [\"F2\", \"F\", \"F'\"]]\n</code></pre>\n\n<p>2D array after inserting the popped group(the group from which we extracted an element)</p>\n\n<pre><code>[[\"R'\", \"R2\"],\n [\"L'\", \"L\", \"L2\"],\n [\"B2\", \"B\", \"B'\"],\n [\"D\", \"D'\", \"D2\"],\n [\"U\", \"U'\", \"U2\"],\n [\"F2\", \"F\", \"F'\"]]\n</code></pre>\n\n<p>Now, since our logic selects the last group and then inserts it in the begining, we are insured that two elements of same group will never be picked in two consecutive turns.</p>\n\n<p>A catch: There can be a possibility that there is a group which never reaches the last position, hence this group will never shrink, and its element will be forced to be picked consecutively once the number of elements is too less.\nFor example observe the output of 4 iterations of above algorithm on below input:</p>\n\n<pre><code>[['a', 'aa', 'aaa', 'A', 'AA', 'AAA'],\n ['b', 'bb', 'bbb', 'B', 'BB', 'BBB'],\n ['c', 'cc', 'ccc', 'C', 'CC', 'CCC']]\n\n  # Output 1: in this 'a' &amp; 'aaa' are together\n [\"CC\", \"bb\", \"C\", \"BB\", \"aa\", \"bbb\", \"AA\", \"CCC\", \"b\", \"c\", \"B\", \"cc\", \"A\", \"BBB\", \"AAA\", \"ccc\", \"a\", \"aaa\"]\n\n  # Output 2: in this 'b' &amp; 'BB' are together\n [\"cc\", \"A\", \"B\", \"c\", \"AAA\", \"C\", \"a\", \"ccc\", \"bbb\", \"CCC\", \"aaa\", \"bb\", \"CC\", \"aa\", \"BBB\", \"AA\", \"b\", \"BB\"]\n\n  # Output 3: this is perfect\n [\"CCC\", \"BB\", \"a\", \"c\", \"BBB\", \"aa\", \"bbb\", \"A\", \"bb\", \"ccc\", \"B\", \"CC\", \"AAA\", \"b\", \"AA\", \"cc\", \"aaa\", \"C\"]\n\n  # Output 4: in this 'c' &amp; 'cc' are together\n [\"CC\", \"bb\", \"AA\", \"b\", \"aa\", \"BBB\", \"aaa\", \"bbb\", \"CCC\", \"B\", \"A\", \"BB\", \"C\", \"a\", \"ccc\", \"AAA\", \"c\", \"cc\"]\n</code></pre>\n\n<p>So, there are chances that when ratio of <code>number of elements in a group</code> to <code>total no of elements</code> increases, two elements of same group can be clubbed together. Hmm, lets improve further:</p>\n\n<p>Since the group with maximum number of elements has most probability of having two elements combined consecutively, lets study such groups. i.e. group with maximum number of elements.</p>\n\n<p>Lets say, there is a group with X number of elements  in it. So what is the minimum number of other type of elements required that none of the X elements are consecutive? Simple right: insert a different element between each pair of element of this group.</p>\n\n<pre><code>x * x * x * x * x * x\n</code></pre>\n\n<p>So we realise, that if group has <code>X</code> elements it requires atleast <code>(X-1)</code> other type of elements so that no two elements of this group get consecutive.\nMathematically the condition can be represented as:</p>\n\n<pre><code>    number_of_elements_in_longest_group     == number_of_other_type_of_elements + 1\n=&gt;  number_of_elements_in_longest_group     == (total_number_of_elements - number_of_elements_in_longest_group) + 1\n=&gt;  number_of_elements_in_longest_group * 2 == total_number_of_elements + 1\n</code></pre>\n\n<p>Going back to our algorithm, lets add a condition, that at any point of time, if number of remaining items is 1 less than the number of elements in largest group then we have to ensure that next element picked is from this largest group</p>\n"}], "owner": {"reputation": 17, "user_id": 10100322, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ogVzW.png?s=128&g=1", "display_name": "SavageHolycow", "link": "https://stackoverflow.com/users/10100322/savageholycow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 0, "accepted_answer_id": 51407602, "answer_count": 2, "score": 1, "last_activity_date": 1531979969, "creation_date": 1531925639, "last_edit_date": 1531962475, "question_id": 51405113, "link": "https://stackoverflow.com/questions/51405113/shuffling-an-array-with-a-condition", "title": "Shuffling an array with a condition", "body": "<p>Here's an array:</p>\n\n<pre><code>scramble = [\n  \"R\", \"U\", \"R' \", \"U' \", \"L\", \"L' \", \"L2\", \"B\", \"B' \", \n  \"B2\", \"F\", \"F' \", \"F2\", \"R2\", \"U2\", \"D\", \"D' \", \"D2\"\n]\n</code></pre>\n\n<p>I want to shuffle it with a condition such that <code>\"R\"</code>, <code>\"R' \"</code>, and <code>\"R2\"</code> are not together while shuffled, and similar for other letters.</p>\n\n<p><code>scramble.shuffle</code> does shuffle it, but how can I set such conditions?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "cancancan"], "comments": [{"owner": {"reputation": 600, "user_id": 2796616, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sPrN.png?s=128&g=1", "display_name": "andrew21", "link": "https://stackoverflow.com/users/2796616/andrew21"}, "edited": false, "score": 0, "creation_date": 1531925338, "post_id": 51404722, "comment_id": 89780937, "body": "Can you share your application_controller and the devise new_user_registration controller (and any other relevant controllers)?  It seems like an authorization call isn&#39;t being made;  a common config is to add <code>check_authorization</code> to your application_controller to enforce an authorization call on all child controllers (see <a href=\"https://github.com/ryanb/cancan/wiki/Ensure-Authorization\" rel=\"nofollow noreferrer\">ensure-authorization</a>), and then a <code>authorize_resource</code> call within each controller (see <a href=\"https://github.com/ryanb/cancan/wiki/authorizing-controller-actions\" rel=\"nofollow noreferrer\">authorizing-resources</a>)"}, {"owner": {"reputation": 31, "user_id": 9962336, "user_type": "registered", "profile_image": "https://graph.facebook.com/1287136114752482/picture?type=large", "display_name": "Benjamin Shaffer", "link": "https://stackoverflow.com/users/9962336/benjamin-shaffer"}, "reply_to_user": {"reputation": 600, "user_id": 2796616, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sPrN.png?s=128&g=1", "display_name": "andrew21", "link": "https://stackoverflow.com/users/2796616/andrew21"}, "edited": false, "score": 0, "creation_date": 1531926222, "post_id": 51404722, "comment_id": 89781546, "body": "@andrew21 I added the application and registration controller. I am not calling authorize_resource in either, I used to have it in the applicaiton controller but have since moved it to each relevant controller. Would best practice be to fix so that it was in application controller?"}, {"owner": {"reputation": 600, "user_id": 2796616, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sPrN.png?s=128&g=1", "display_name": "andrew21", "link": "https://stackoverflow.com/users/2796616/andrew21"}, "edited": false, "score": 0, "creation_date": 1531927659, "post_id": 51404722, "comment_id": 89782539, "body": "I think a check_authorization in the applicationcontroller is best practice as it enforces a check by all inheriting controllers by default. (Less room for security errors) You then either add either a authorize_resource and/or skip_authorization_check to each controller to specify how each is authorized."}, {"owner": {"reputation": 31, "user_id": 9962336, "user_type": "registered", "profile_image": "https://graph.facebook.com/1287136114752482/picture?type=large", "display_name": "Benjamin Shaffer", "link": "https://stackoverflow.com/users/9962336/benjamin-shaffer"}, "reply_to_user": {"reputation": 600, "user_id": 2796616, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sPrN.png?s=128&g=1", "display_name": "andrew21", "link": "https://stackoverflow.com/users/2796616/andrew21"}, "edited": false, "score": 0, "creation_date": 1531933619, "post_id": 51404722, "comment_id": 89786222, "body": "@andrew21 adding check_authorization gives me &#39;uninitialized constant --------&#39; for whatever Devise calls I try using, I tried using skip_authorization_check in teh registrations controller but getting same error :("}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 9962336, "user_type": "registered", "profile_image": "https://graph.facebook.com/1287136114752482/picture?type=large", "display_name": "Benjamin Shaffer", "link": "https://stackoverflow.com/users/9962336/benjamin-shaffer"}, "is_accepted": true, "score": 0, "last_activity_date": 1533753339, "creation_date": 1533753339, "answer_id": 51753528, "question_id": 51404722, "link": "https://stackoverflow.com/questions/51404722/cancan-and-devise-controlling-users-ability-to-update-other-roles/51753528#51753528", "title": "Cancan and Devise controlling user&#39;s ability to update other roles", "body": "<p>The answer to this was really simple:</p>\n\n<pre><code>if user.present?\n        if user.basic?\n            can :read, :all\n            can :active_orders_index, Order\n            can :search_orders, Order\n            can :focused_show, Location\n            cannot :mark_task_completed, Task \n            can :finish_task, Task\n            cannot :manage, User # ADDED LINE\n        elsif user.location?\n            can :read, Location, :name =&gt; user.username\n            can :focused_show, Location, :name =&gt; user.username\n            cannot :manage, User\n        elsif user.admin?\n            can :manage, :all\n            cannot :manage, User, role: 3 # ADDED LINE\n        elsif user.moderator?\n            can :manage, :all\n        end\n end\n</code></pre>\n\n<p>in my ability.rb</p>\n"}], "owner": {"reputation": 31, "user_id": 9962336, "user_type": "registered", "profile_image": "https://graph.facebook.com/1287136114752482/picture?type=large", "display_name": "Benjamin Shaffer", "link": "https://stackoverflow.com/users/9962336/benjamin-shaffer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 647, "favorite_count": 0, "accepted_answer_id": 51753528, "answer_count": 1, "score": 1, "last_activity_date": 1533753339, "creation_date": 1531924378, "last_edit_date": 1531926076, "question_id": 51404722, "link": "https://stackoverflow.com/questions/51404722/cancan-and-devise-controlling-users-ability-to-update-other-roles", "title": "Cancan and Devise controlling user&#39;s ability to update other roles", "body": "<p>I am using cancan(can) and devise to control user permission in my Ruby on Rails application. My User model has four enumerated roles:</p>\n\n<pre><code>class User &lt; ApplicationRecord\n    enum role: {location: 0, basic: 1, admin: 2, moderator: 3}\n</code></pre>\n\n<p>What I am trying to do is define what roles each roles can control in the ability.rb</p>\n\n<p>My ability.rb currently looks like this:</p>\n\n<pre><code>if user.basic?\n    can :read, :all\n    can :active_orders_index, Order\n    can :search_orders, Order\n    can :focused_show, Location\n    can :mark_task_completed, Task \n    can :finish_task, Task\n    cannot :create, User\nelsif user.location?\n    can :read, Location\n    can :focused_show, Location\nelsif user.admin?\n    can :manage, :all    \nelsif user.moderator?\n    can :manage, :all\nend\n</code></pre>\n\n<p>All I am trying to do in this example is prevent basic users from being able to create users. In this current form basic users <em>are</em> able to create users (cancan doesn't redirect due to unauthorized), which is not the desired effect. I believe this is because the :create method is from my User controller which is not being used to make the user. I am using Devise's new_user_registration to make new registrations.</p>\n\n<p>Simplest form of the question:</p>\n\n<ol>\n<li><p>Is there a way to do something like-></p>\n\n<pre><code>cannot :sign_up, User.where(:role =&gt; 'moderator')\n</code></pre>\n\n<p>in a way that I can specify which roles can manage which other roles?</p></li>\n<li><p>What Devise controller/methods should I be using to set these limits?</p></li>\n</ol>\n\n<p>Sorry if this has already been answered I read through the wiki on defining abilities and Devise and couldn't figure it out.</p>\n\n<p>Thanks in advance, and I can provide any other needed code snippets that would help!</p>\n\n<p><strong>Application Controller:</strong> I had commented out load and authorize and moved it to the beginning of other controllers because it was causing unwanted behavior (I don't remember what exactly). </p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n#load_and_authorize_resource\n\nprotect_from_forgery with: :exception\n\nbefore_action :configure_permitted_parameters, if: :devise_controller?\n\nrescue_from CanCan::AccessDenied do |exception|\n    respond_to do |format|\n      format.json { head :forbidden, content_type: 'text/html' }\n      format.html { redirect_to main_app.new_user_session_url, notice: exception.message }\n      format.js   { head :forbidden, content_type: 'text/html' }\n    end\nend\n\ndef after_sign_in_path_for(resource)\n  if resource.role == 'location'\n    location_focused_path(Location.find_by(name: resource.username))\n  elsif resource.role == 'basic'\n    locations_path\n  elsif resource.role == 'admin'\n    active_orders_path\n  elsif resource.role == 'moderator'\n    active_orders_path\n  end\nend\n\nprotected\n\ndef configure_permitted_parameters\n  added_atrs = [:role, :username, :email]\n  devise_parameter_sanitizer.permit(:sign_up, keys: added_atrs)\n  devise_parameter_sanitizer.permit(:account_update, keys: added_atrs)\nend\nend\n</code></pre>\n\n<p><strong>Registrations Controller:</strong> <em>generated by Devise</em></p>\n\n<pre><code>class Users::RegistrationsController &lt; Devise::RegistrationsController\n#load_and_authorize_resource\n\nskip_before_action :require_no_authentication, only: [:new, :create, :cancel]\n\n# POST /resource\ndef create\n    build_resource(sign_up_params)\n\n    # yield resource if block_given?\n    # ^ I removed this line otherwise identical to teh source code\n    resource.save\n    if resource.persisted?\n       if resource.active_for_authentication?\n           set_flash_message! :notice, :signed_up\n           sign_up(resource_name, resource)\n           respond_with resource, location: after_sign_up_path_for(resource)\n       else\n           set_flash_message! :notice, :\"signed_up_but_#{resource.inactive_message}\"\n           expire_data_after_sign_in!\n           respond_with resource, location: after_inactive_sign_up_path_for(resource)\n       end\n    else\n       clean_up_passwords resource\n       set_minimum_password_length\n       respond_with resource\n    end\n end\n\n# Signs in a user on sign up. You can overwrite this method in your own\n# RegistrationsController.\ndef sign_up(resource_name, resource)\n    true\nend\n\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 1, "creation_date": 1531919034, "post_id": 51402680, "comment_id": 89776224, "body": "Can you show the output of <code>rake routes | grep read</code>?"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 1, "creation_date": 1531919072, "post_id": 51402680, "comment_id": 89776242, "body": "Do you have any before filters for action <code>read</code>? Include them in question, if you do."}, {"owner": {"reputation": 435, "user_id": 5136223, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-Wl5tRylDc9g/AAAAAAAAAAI/AAAAAAAABJQ/ayueeKi75iw/photo.jpg?sz=128", "display_name": "Fernando Maymone", "link": "https://stackoverflow.com/users/5136223/fernando-maymone"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1531919954, "post_id": 51402680, "comment_id": 89776902, "body": "Jagdeep. I get your idea and change in the question the description. The error now changes."}], "answers": [{"comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "reply_to_user": {"reputation": 435, "user_id": 5136223, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-Wl5tRylDc9g/AAAAAAAAAAI/AAAAAAAABJQ/ayueeKi75iw/photo.jpg?sz=128", "display_name": "Fernando Maymone", "link": "https://stackoverflow.com/users/5136223/fernando-maymone"}, "edited": false, "score": 1, "creation_date": 1531921277, "post_id": 51403208, "comment_id": 89777978, "body": "Updated the answer with explanation."}], "tags": [], "owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "is_accepted": true, "score": 2, "last_activity_date": 1531921267, "last_edit_date": 1531921267, "creation_date": 1531920322, "answer_id": 51403208, "question_id": 51402680, "link": "https://stackoverflow.com/questions/51402680/processing-button-on-a-show-view-in-ruby-on-rails/51403208#51403208", "title": "Processing button on a Show view in Ruby on Rails", "body": "<p>You are visiting the route with <code>read_path(@source)</code> which is <em>expected</em> to set the param <code>id</code> to the value <code>@source.id</code>, but you <strong>did not</strong> define your routes to support any parameter in the path.</p>\n\n<p>I believe <code>read</code> is an action that belongs to a single instance of <code>Source</code>. So, you should <a href=\"http://guides.rubyonrails.org/routing.html#adding-member-routes\" rel=\"nofollow noreferrer\">define the route on member</a>. This way you will be able to access <code>params[:id]</code> in your controller and your before_action <code>set_source</code> will work fine.</p>\n\n<p>Change your route definition to:</p>\n\n<pre><code>resources :sources, only: [...] do    # Keep the `only` array just as you have now.\n  get '/process', to: 'sources#read', as: 'read', on: :member\nend\n</code></pre>\n"}], "owner": {"reputation": 435, "user_id": 5136223, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-Wl5tRylDc9g/AAAAAAAAAAI/AAAAAAAABJQ/ayueeKi75iw/photo.jpg?sz=128", "display_name": "Fernando Maymone", "link": "https://stackoverflow.com/users/5136223/fernando-maymone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 51403208, "answer_count": 1, "score": 0, "last_activity_date": 1531921267, "creation_date": 1531918801, "last_edit_date": 1531919979, "question_id": 51402680, "link": "https://stackoverflow.com/questions/51402680/processing-button-on-a-show-view-in-ruby-on-rails", "title": "Processing button on a Show view in Ruby on Rails", "body": "<p>I have an application entity called Source on my app. This entity has a property called url. </p>\n\n<p>I want to make a processing on my SHOW view. So I added a button on the show view to make a call to my controller and do this processing.</p>\n\n<p>This is my routes.rb</p>\n\n<pre><code>  get '/process', to: 'sources#read', as: 'read'\n</code></pre>\n\n<p>This is my controller method: </p>\n\n<pre><code>class SourcesController &lt; ApplicationController\n  before_action :set_source, only: [:show, :edit, :update, :destroy, :read]\n  access all: [:index, :show, :new, :edit, :create, :update, :destroy, :read], user: :all\ndef read\n    require 'rss'\n    require 'open-uri'\n    url = @source.url\n    open(url) do |rss|\n      feed = RSS::Parser.parse(rss)\n      puts \"Title: #{feed.channel.title}\"\n      feed.items.each do |item|\n        puts \"Item: #{item.title}\"\n        puts \"Link: #{item.link}\"\n        puts \"Description: #{item.description}\"\n      end\n    end\n    render template: 'rss_reader/home'\n  end\n</code></pre>\n\n<p>And of course. My show.html.erb: </p>\n\n<pre><code>&lt;%= button_to 'Process Source', read_path(@source), method: :get %&gt;\n&lt;%= link_to 'Edit', edit_source_path(@source) %&gt; |\n&lt;%= link_to 'Back', sources_path %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>When I press the \"Process Source\" button, it goes to the right controller method, but the object @source its not being found because of:</p>\n\n<pre><code>Couldn't find Source with 'id'=\n# Use callbacks to share common setup or constraints between actions.\ndef set_source\n  @source = Source.find(params[:id])\nend\n</code></pre>\n\n<p>What Im doing wrong here? </p>\n"}, {"tags": ["html", "ruby-on-rails", "ruby", "slim-lang"], "answers": [{"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1531920370, "post_id": 51403187, "comment_id": 89777230, "body": "Doesn&#39;t turning off sanitize leave you open to a XSS attack?"}, {"owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1531921539, "post_id": 51403187, "comment_id": 89778195, "body": "@max, attribute <code>style</code> inside a tag <code>&lt;span&gt;</code> that changes dynamically, make the author open to a XSS attack if options are coming from users. If someone for that will be use <code>raw</code>/<code>html_safe</code> - not protected to a XSS attack. But when content sanitized and then wrapped in <code>span</code> with some <code>style</code> attributes - all ok."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1531921925, "post_id": 51403187, "comment_id": 89778499, "body": "But disabling sanitize would allow a malicious user to add for example a <code>onclick</code> attribute or <code>onload</code> attribute."}], "tags": [], "owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "is_accepted": true, "score": 0, "last_activity_date": 1531920267, "creation_date": 1531920267, "answer_id": 51403187, "question_id": 51402533, "link": "https://stackoverflow.com/questions/51402533/rails-h-simple-format-fix/51403187#51403187", "title": "Rails -- h.simple_format fix", "body": "<p><code>simple_format</code> from <code>ActionView::Helpers::TextHelper</code> has default option <code>sanitize: true</code></p>\n\n<blockquote>\n  <p>Sanitizes the html by converting  and  tags into regular text, and removing all \"onxxx\" attributes (so that arbitrary Javascript cannot be executed). It also removes href= and src= attributes that start with \"javascript:\". You can modify what gets sanitized by defining VERBOTEN_TAGS and VERBOTEN_ATTRS before this Module is loaded.</p>\n</blockquote>\n\n<p>To prevent deleting style attribute:</p>\n\n<pre><code>simple_format(item.text.text, { class: 'basic' }, sanitize: false)\n</code></pre>\n\n<p><code>&lt;p&gt;</code> inside <code>&lt;p&gt;</code> is invalid in all standards of HTML because the opening <code>&lt;p&gt;</code> tag will automatically close the <code>&lt;p&gt;</code> element:</p>\n\n<pre><code>#item.text.text =&gt; \"&lt;p&gt;&lt;span style=\\\"color: rgb(251, 213, 181);\\\"&gt;asdasdasd&lt;/span&gt;&lt;/p&gt;\"\n\nsimple_format(item.text.text, { class: 'basic' }, sanitize: false, wrapper_tag: \"div\")\n#=&gt; \"&lt;div class=\\\"basic\\\"&gt;&lt;p&gt;&lt;span style=\\\"color: rgb(251, 213, 181);\\\"&gt;asdasdasd&lt;/span&gt;&lt;/p&gt;&lt;div&gt;\"\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 9970746, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EcTeoxuR1Hc/AAAAAAAAAAI/AAAAAAAAAAc/AyTecg_yrnA/photo.jpg?sz=128", "display_name": "Shao Kahn", "link": "https://stackoverflow.com/users/9970746/shao-kahn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 434, "favorite_count": 0, "accepted_answer_id": 51403187, "answer_count": 1, "score": 0, "last_activity_date": 1531947273, "creation_date": 1531918378, "last_edit_date": 1531947273, "question_id": 51402533, "link": "https://stackoverflow.com/questions/51402533/rails-h-simple-format-fix", "title": "Rails -- h.simple_format fix", "body": "<p>This is my code:</p>\n\n<pre><code> = h.simple_format(item.text.text, class: 'basic')\n</code></pre>\n\n<p>And <code>item.text.text</code> is <code>\"&lt;p&gt;&lt;span style=\\\"color: rgb(251, 213, 181);\\\"&gt;asdasdasd&lt;/span&gt;&lt;/p&gt;\"</code>, but when I see the view which was rendered in inspect, the <code>style=\\\"color: rgb(251, 213, 181);\\\"</code> attribute goes away!</p>\n\n<p>How to fix this! (Note: I need <code>class: 'basic'</code>!)</p>\n"}, {"tags": ["ruby", "time", "clock", "cpu-architecture"], "comments": [{"owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 1, "creation_date": 1531917673, "post_id": 51402269, "comment_id": 89775280, "body": "maybe the world went back 14 secs ... :)"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 7, "creation_date": 1531917674, "post_id": 51402269, "comment_id": 89775283, "body": "Your computer&#39;s time was running fast and resynced with NTP? Could this happen again? Sure, do not expect your computer&#39;s time to increment only."}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 0, "creation_date": 1531922639, "post_id": 51402269, "comment_id": 89778995, "body": "I agree the obvious and most likely reason is that time itself shifted 14 seconds. It is really the only the logical conclusion."}], "answers": [{"comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 9, "creation_date": 1531917981, "post_id": 51402390, "comment_id": 89775491, "body": "...And in case it&#39;s not clear enough: This has almost certainly got nothing to do with ruby, and everything to do with the computer it&#39;s running on."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1532045877, "post_id": 51402390, "comment_id": 89837452, "body": "@TomLord: Other languages may provide multiple clock functions,   e.g. <a href=\"https://linux.die.net/man/3/clock_gettime\" rel=\"nofollow noreferrer\">POSIX <code>clock_gettime(3)</code></a> provides <code>CLOCK_REALTIME</code> (current system time) as well as <code>CLOCK_MONOTONIC</code> (time since an unspecified starting point, useful for timing intervals).  I don&#39;t know of a monotonic clock that you could use as time-of-day, though.  The solution to that problem is to use a better NTP setup on your computer that slows down your clock to get back in sync instead of making jumps, although for large offsets you would want to jump anyway."}], "tags": [], "owner": {"reputation": 469137, "user_id": 476, "user_type": "moderator", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a235706e3d81b614acaec3368edfea4b?s=128&d=identicon&r=PG", "display_name": "deceze", "link": "https://stackoverflow.com/users/476/deceze"}, "is_accepted": true, "score": 6, "last_activity_date": 1531917931, "creation_date": 1531917931, "answer_id": 51402390, "question_id": 51402269, "link": "https://stackoverflow.com/questions/51402269/i-just-went-back-in-time/51402390#51402390", "title": "I just went back in time", "body": "<p>Most likely your operating system just synched with an NTP server and actually \"physically\" set back its clock. You were lucky enough to catch it in the act.</p>\n\n<blockquote>\n  <p>Could this happen again [..]?</p>\n</blockquote>\n\n<p>Yes, something like this can happen at any moment. <a href=\"https://infiniteundo.com/post/25509354022/more-falsehoods-programmers-believe-about-time\" rel=\"noreferrer\">Falsehood #33 that programmers believe about time</a>:</p>\n\n<blockquote>\n  <p>Timestamps always advance monotonically.</p>\n</blockquote>\n"}], "owner": {"reputation": 571, "user_id": 4245210, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/mcrWI.jpg?s=128&g=1", "display_name": "Elie Teyssedou", "link": "https://stackoverflow.com/users/4245210/elie-teyssedou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 51402390, "answer_count": 1, "score": 0, "last_activity_date": 1532016726, "creation_date": 1531917575, "last_edit_date": 1532016726, "question_id": 51402269, "link": "https://stackoverflow.com/questions/51402269/i-just-went-back-in-time", "title": "I just went back in time", "body": "<p>I went 14 seconds in the past(using Ruby, in my IRB console). I just wanted to understand what happened exactly.</p>\n\n<p>I was just observing the return value of <code>Time.now.strftime('%F %T')</code> (returns a string formatted as \"YYYY-MM-DD HH:MM:SS\") by evaluating it almost every seconds.\nBut then, this happened :</p>\n\n<p><a href=\"https://i.stack.imgur.com/L0MXu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/L0MXu.png\" alt=\"weird back in time\"></a></p>\n\n<p>Time jumped from \"2018-07-18 14:25:25\" to \"2018-07-18 14:25:11\"... No context, no Timecop (Ruby library that permit to go back in time), just Ruby and Time (a Ruby core library to manage time).</p>\n\n<p>What could happened here ? Could this ever happen again ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "selenium", "testing", "capybara"], "answers": [{"comments": [{"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1531925121, "post_id": 51402214, "comment_id": 89780765, "body": "Very handy to know - am I right that <code>find_elements</code> comes with Selenium? Thanks for the answer. I&#39;ve gone with the <code>css</code> approach, though this is definitely useful too +1"}, {"owner": {"reputation": 5161, "user_id": 8625512, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/14cFh.jpg?s=128&g=1", "display_name": "Andrei Suvorkov", "link": "https://stackoverflow.com/users/8625512/andrei-suvorkov"}, "reply_to_user": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 1, "creation_date": 1531926401, "post_id": 51402214, "comment_id": 89781693, "body": "<code>am I right that find_elements comes with Selenium?</code> So far I know, yes. @ThomasWalpole has provided elegant solution, you are right"}], "tags": [], "owner": {"reputation": 5161, "user_id": 8625512, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/14cFh.jpg?s=128&g=1", "display_name": "Andrei Suvorkov", "link": "https://stackoverflow.com/users/8625512/andrei-suvorkov"}, "is_accepted": false, "score": 1, "last_activity_date": 1531918081, "last_edit_date": 1531918081, "creation_date": 1531917431, "answer_id": 51402214, "question_id": 51402007, "link": "https://stackoverflow.com/questions/51402007/switch-off-capybaraelementnotfound-avoid-nested-rescue/51402214#51402214", "title": "Switch off Capybara::ElementNotFound / avoid nested rescue", "body": "<p>I'm not familiar with <code>Ruby</code>, so I'll leave the link to Ruby <a href=\"https://www.rubydoc.info/gems/selenium-webdriver/0.0.28/Selenium/WebDriver/Find\" rel=\"nofollow noreferrer\">docu</a> and Capybara <a href=\"https://www.rubydoc.info/github/jnicklas/capybara/Capybara/Node/Finders#all-instance_method\" rel=\"nofollow noreferrer\">docu</a>. The idea is to use <code>find_elements</code> instead of <code>find_element</code>. Why? <code>find_elements</code> won't throw any exception if there is no elements found. The pseudo code would be like this:</p>\n\n<pre><code>new_button = find_elements('.button_one').size() &gt; 0 ? find('.button_one') || find('.button_two')\n</code></pre>\n\n<p>And you don't need to handle with exceptions anymore.</p>\n"}, {"comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 1, "creation_date": 1531922189, "post_id": 51402429, "comment_id": 89778692, "body": "Using XPath with Capybara is generally only necessary if one needs to do text content matching (that can&#39;t be done with the :text option), if you need to search up the document, or you need to escape the current scope.  Your example would work but is just more complicated than necessary.  Your example also inadvertently/mistakenly escapes the current scope - <a href=\"https://github.com/teamcapybara/capybara#beware-the-xpath--trap\" rel=\"nofollow noreferrer\">github.com/teamcapybara/capybara#beware-the-xpath--trap</a> - which can lead to hard to debug errors."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1531924982, "post_id": 51402429, "comment_id": 89780668, "body": "Thanks @Murthi - appreciate the suggestion. Have gone with the <code>css</code> approach, but +1 as this will likely come in handy in future."}], "tags": [], "owner": {"reputation": 5041, "user_id": 7305183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/109a1b8acbf5d01c41e8e725b08411ba?s=128&d=identicon&r=PG&f=1", "display_name": "Murthi", "link": "https://stackoverflow.com/users/7305183/murthi"}, "is_accepted": false, "score": 2, "last_activity_date": 1531918061, "creation_date": 1531918061, "answer_id": 51402429, "question_id": 51402007, "link": "https://stackoverflow.com/questions/51402007/switch-off-capybaraelementnotfound-avoid-nested-rescue/51402429#51402429", "title": "Switch off Capybara::ElementNotFound / avoid nested rescue", "body": "<p>Try with the x-path //button[contains(@class,'button_one') or contains(@class, 'button_two'] as given below,</p>\n\n<pre><code>new_button = begin\n        find(:xpath, \"//button[contains(@class,'button_one') or contains(@class, 'button_two']\")\n       rescue Capybara::ElementNotFound\n        raise Capybara::ElementNotFound, \"Missing Button\"\n      end\n\nnew_button.click\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5161, "user_id": 8625512, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/14cFh.jpg?s=128&g=1", "display_name": "Andrei Suvorkov", "link": "https://stackoverflow.com/users/8625512/andrei-suvorkov"}, "edited": false, "score": 0, "creation_date": 1531920681, "post_id": 51403200, "comment_id": 89777501, "body": "Is this(<code>.button1, .button2</code>) only in Ruby applicable?"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 5161, "user_id": 8625512, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/14cFh.jpg?s=128&g=1", "display_name": "Andrei Suvorkov", "link": "https://stackoverflow.com/users/8625512/andrei-suvorkov"}, "edited": false, "score": 0, "creation_date": 1531920767, "post_id": 51403200, "comment_id": 89777581, "body": "@AndreiSuvorkov - No that&#39;s just CSS"}, {"owner": {"reputation": 5161, "user_id": 8625512, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/14cFh.jpg?s=128&g=1", "display_name": "Andrei Suvorkov", "link": "https://stackoverflow.com/users/8625512/andrei-suvorkov"}, "edited": false, "score": 0, "creation_date": 1531920815, "post_id": 51403200, "comment_id": 89777636, "body": "I would be grateful if you will provide a link to tutorial or docu to read more about this. Interesting feature"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 5161, "user_id": 8625512, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/14cFh.jpg?s=128&g=1", "display_name": "Andrei Suvorkov", "link": "https://stackoverflow.com/users/8625512/andrei-suvorkov"}, "edited": false, "score": 0, "creation_date": 1531921006, "post_id": 51403200, "comment_id": 89777768, "body": "@AndreiSuvorkov <a href=\"https://developer.mozilla.org/en-US/docs/Learn/CSS/Introduction_to_CSS/Combinators_and_multiple_selectors#Groups_of_selectors_on_one_rule\" rel=\"nofollow noreferrer\">developer.mozilla.org/en-US/docs/Learn/CSS/Introduction_to_C&zwnj;&#8203;SS/&hellip;</a>"}, {"owner": {"reputation": 5161, "user_id": 8625512, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/14cFh.jpg?s=128&g=1", "display_name": "Andrei Suvorkov", "link": "https://stackoverflow.com/users/8625512/andrei-suvorkov"}, "edited": false, "score": 0, "creation_date": 1531921236, "post_id": 51403200, "comment_id": 89777937, "body": "Wow! You did my day. Thank you very much! Such situations as OP  has can be so elegantly implemented."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1531923764, "post_id": 51403200, "comment_id": 89779769, "body": "Perfect, and so simple :) Definitely slipped my mind to handle this way. Appreciate the help @ThomasWalpole."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 3, "last_activity_date": 1531921617, "last_edit_date": 1531921617, "creation_date": 1531920305, "answer_id": 51403200, "question_id": 51402007, "link": "https://stackoverflow.com/questions/51402007/switch-off-capybaraelementnotfound-avoid-nested-rescue/51403200#51403200", "title": "Switch off Capybara::ElementNotFound / avoid nested rescue", "body": "<p>If only one of the buttons is ever on the page, the simplest solution is to just look for both buttons at once using the CSS comma </p>\n\n<pre><code>find(\".button_one, .button_two\").click\n</code></pre>\n\n<p>If it's possible for both buttons to be on the page at the same time then that will get you an Ambiguous match error, in which case you could do something like</p>\n\n<pre><code>find(\".button_one, .button_two\", match: :first).click\n</code></pre>\n\n<p>or</p>\n\n<pre><code>all(\".button_one, .button_two\")[0].click\n</code></pre>\n\n<p>It's also possible to check whether an element exists without raising an exception using the Capybara provided predicates has_css?/has_xpath?/etc. which would give code like</p>\n\n<pre><code>if page.has_css?(\".button_one\")\n  find(\".button_one\")\nelse\n  find(\".button_two\")\nend.click\n</code></pre>\n\n<p>but in this case using the CSS comma would definitely be the better solution.</p>\n"}], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "accepted_answer_id": 51403200, "answer_count": 3, "score": 1, "last_activity_date": 1531928027, "creation_date": 1531916791, "last_edit_date": 1531928027, "question_id": 51402007, "link": "https://stackoverflow.com/questions/51402007/switch-off-capybaraelementnotfound-avoid-nested-rescue", "title": "Switch off Capybara::ElementNotFound / avoid nested rescue", "body": "<p>I've got an issue with a method shared across a wide number of integration tests.</p>\n\n<p>The problem is, I need to find one of two buttons, and have so far only come up with the following unwieldy syntax for avoiding Capybara's <code>ElementNotFound</code> error:</p>\n\n<pre><code>new_button = begin\n      find(\".button_one\")\n    rescue Capybara::ElementNotFound\n      begin\n        find('.button_two')\n      rescue Capybara::ElementNotFound\n        raise Capybara::ElementNotFound, \"Missing Button\"\n      end\n    end\nnew_button.click\n</code></pre>\n\n<p>This works as expected: if the first button's not found, the second one is, and they're clicked. If neither are present, the error is raised.</p>\n\n<p>Despite this, I really don't like the nested <code>rescues</code> and would like to tidy this up. </p>\n\n<p>The simplest solution which feels like it should exist, though I've not found this <em>anywhere</em>: does anyone know if there's an option to return <code>nil</code> in Capybara's <code>find</code> method, rather than raising the exception?</p>\n\n<p>For example, the following pseudocode...</p>\n\n<pre><code>new_button = find('.button_one', allow_nil: true) || find('.button_two', allow_nil: true)\nnew_button ? new_button.click : raise(Capybara::ElementNotFound, \"Missing Button\")\n</code></pre>\n\n<p>...would be perfect.</p>\n\n<p>Otherwise, any suggestion of how best to rescue the two errors and avoid the horrible nested rescue?</p>\n\n<hr>\n\n<p>Footnote: this code exists within a large existing structure, which previously worked fine where it shouldn't have. Fixing another issue has caused this problem, which is used widely throughout the suite. I'd love to adjust the calls and use the correct elements (and so avoid this altogether), though that's going to be a big project a little later in the day.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "validation", "callback"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1531918515, "post_id": 51401960, "comment_id": 89775845, "body": "<i>&quot;what I get is that the validation block is entered after the cart_item model is saved&quot;</i> -- This is the correct behaviour, so I&#39;m not sure what your question is. What I would expect to see is that, for example: <code>cart_item_1</code> is created; <code>cart_item_2</code> is created; <b><code>cart_item_3</code> fails validation</b>; <code>cart_item_1</code> and <code>cart_item_2</code> are deleted, as the database transaction is rolled back."}, {"owner": {"reputation": 3, "user_id": 7814371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a71b2f3a82c5b8cdbba6a01fda3647ae?s=128&d=identicon&r=PG&f=1", "display_name": "juggii", "link": "https://stackoverflow.com/users/7814371/juggii"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1531923583, "post_id": 51401960, "comment_id": 89779632, "body": "@TomLore Yes, indeed the example that you gave is what I want to happen, but what actually happens is that all models are saved and persisted in the database then the validation fails but no rollback"}], "answers": [{"tags": [], "owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "is_accepted": true, "score": 0, "last_activity_date": 1531926266, "creation_date": 1531926266, "answer_id": 51405344, "question_id": 51401960, "link": "https://stackoverflow.com/questions/51401960/rails-nested-attributes-custom-validation-with-on-create-option-is-called-after/51405344#51405344", "title": "Rails nested attributes custom validation with on create option is called after the record is saved", "body": "<p>Try <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Transactions/ClassMethods.html\" rel=\"nofollow noreferrer\">Active Record Transactions</a></p>\n\n<blockquote>\n  <p>Transactions are protective blocks where SQL statements are only permanent if they can all succeed as one atomic action. The classic example is a transfer between two accounts where you can only have a deposit if the withdrawal succeeded and vice versa. Transactions enforce the integrity of the database and guard the data against program errors or database break-downs. So basically you should use transaction blocks whenever you have a number of statements that must be executed together or not at all.</p>\n</blockquote>\n\n<pre><code>def generate_checkout\n  ActiveRecord::Base.transaction do\n    request = User::Request.new(request_params_with_nested_attribuets)\n    if request.save\n      render json: request, status: :created\n    else\n      render json: request.errors, status: :bad_request\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7814371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a71b2f3a82c5b8cdbba6a01fda3647ae?s=128&d=identicon&r=PG&f=1", "display_name": "juggii", "link": "https://stackoverflow.com/users/7814371/juggii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 51405344, "answer_count": 1, "score": 0, "last_activity_date": 1531926266, "creation_date": 1531916646, "question_id": 51401960, "link": "https://stackoverflow.com/questions/51401960/rails-nested-attributes-custom-validation-with-on-create-option-is-called-after", "title": "Rails nested attributes custom validation with on create option is called after the record is saved", "body": "<p>Suppose I have the following models with nested attributes.\nRequest model:</p>\n\n<pre><code>class User::Request &lt; ApplicationRecord \n  ## Associations\n  has_many :items, dependent: :destroy\n  accepts_nested_attributes_for :items\nend\n</code></pre>\n\n<p>Item model:</p>\n\n<pre><code>class Item &lt; ApplicationRecord\n  belongs_to :request, class_name: 'User::Request'\n  has_one :cart_item, dependent: :destroy\n  has_one :cart, through: :cart_item\n  accepts_nested_attributes_for :cart_item, allow_destroy: true\nend\n</code></pre>\n\n<p>Cart Item Model:</p>\n\n<pre><code>class CartItem &lt; ApplicationRecord\n  belongs_to :cart\n  belongs_to :item\n  validate :validate_no_duplicate_items, on: :create\n\n  private\n\n  def validate_no_duplicate_items\n    return unless cart.items.exists?(item.id)\n    errors.add(:error, 'Item already added to cart')\n  end\nend\n</code></pre>\n\n<p>And a controller that will create a request with the multi-level nested attributes.</p>\n\n<pre><code>def generate_checkout\n  request = User::Request.new(request_params_with_nested_attribuets)\n  if request.save\n    render json: request, status: :created\n  else\n    render json: request.errors, status: :bad_request\n  end\nend\n</code></pre>\n\n<p>so the expected behaviour is that if it failed the validation in the cart_item model it will rollback and not create any of the models. But what I get is that the validation block is entered after the cart_item model is saved. Would appreciate any help I can get</p>\n"}, {"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1531918635, "post_id": 51401247, "comment_id": 89775924, "body": "Where would <code>insert_object</code> even be called? Currently it appears you are calling <code>Google::Storage#upload</code>?"}, {"owner": {"reputation": 377, "user_id": 2050755, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/1ad025f9d6859f8f9cc19966d3868eea?s=128&d=identicon&r=PG", "display_name": "Rajesh Naik", "link": "https://stackoverflow.com/users/2050755/rajesh-naik"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1531919297, "post_id": 51401247, "comment_id": 89776408, "body": "Thanks for highlighting #upload, I have corrected it."}], "answers": [{"comments": [{"owner": {"reputation": 377, "user_id": 2050755, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/1ad025f9d6859f8f9cc19966d3868eea?s=128&d=identicon&r=PG", "display_name": "Rajesh Naik", "link": "https://stackoverflow.com/users/2050755/rajesh-naik"}, "edited": false, "score": 0, "creation_date": 1531915003, "post_id": 51401376, "comment_id": 89773480, "body": "I forgot to mention, UploadWorker is sidekiq worker and I guess we can&#39;t pass any parameters in initialize method"}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "reply_to_user": {"reputation": 377, "user_id": 2050755, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/1ad025f9d6859f8f9cc19966d3868eea?s=128&d=identicon&r=PG", "display_name": "Rajesh Naik", "link": "https://stackoverflow.com/users/2050755/rajesh-naik"}, "edited": false, "score": 0, "creation_date": 1531915170, "post_id": 51401376, "comment_id": 89773592, "body": "It depends if sidekiq also uses the initialize method and passes anything to it, you could call <code>super()</code> in <code>#initialize</code> and see if it still works."}, {"owner": {"reputation": 377, "user_id": 2050755, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/1ad025f9d6859f8f9cc19966d3868eea?s=128&d=identicon&r=PG", "display_name": "Rajesh Naik", "link": "https://stackoverflow.com/users/2050755/rajesh-naik"}, "edited": false, "score": 0, "creation_date": 1531915733, "post_id": 51401376, "comment_id": 89774009, "body": "it doesn&#39;t work, we can&#39;t pass parameters in initialize method of the workers. So is there any other way to stub this or make it work?"}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "reply_to_user": {"reputation": 377, "user_id": 2050755, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/1ad025f9d6859f8f9cc19966d3868eea?s=128&d=identicon&r=PG", "display_name": "Rajesh Naik", "link": "https://stackoverflow.com/users/2050755/rajesh-naik"}, "edited": false, "score": 0, "creation_date": 1532009629, "post_id": 51401376, "comment_id": 89820816, "body": "The other option would be to use getter/setter methods to inject the dependency."}], "tags": [], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "is_accepted": false, "score": 3, "last_activity_date": 1532009813, "last_edit_date": 1532009813, "creation_date": 1531914861, "answer_id": 51401376, "question_id": 51401247, "link": "https://stackoverflow.com/questions/51401247/how-to-stub-class-instantiated-inside-tested-class-in-rspec/51401376#51401376", "title": "How to stub class instantiated inside tested class in rspec", "body": "<p>I would consider reaching for dependency injection, such as:</p>\n\n<pre><code>class UploadWorker\n  def initialize(dependencies = {})\n    @storage = dependencies.fetch(:storage) { Google::Storage }\n  end\n\n  def perform\n    @storage.new.upload 'test.txt'\n  end\nend\n</code></pre>\n\n<p>Then in the spec you can inject a double:</p>\n\n<pre><code>storage = double\nexpect(storage).to receive(...) # expection\nworker = UploadWorker.new(storage: storage)\nworker.perform\n</code></pre>\n\n<p>If using the initializer is not an option then you could use getter/setter method to inject the dependency:</p>\n\n<pre><code>def storage=(new_storage)\n  @storage = new_storage\nend\n\ndef storage\n  @storage ||=  Google::Storage\nend\n</code></pre>\n\n<p>and in the specs:</p>\n\n<pre><code>storage = double\nworker.storage = storage\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1531919603, "post_id": 51402899, "comment_id": 89776626, "body": "Depending on what you need. <code>allow</code> is fine too. But you need <code>expect</code> if you want to verify the arguments passed there."}, {"owner": {"reputation": 1913, "user_id": 547341, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/10a0cbba661dd3521b5a35a3e7bbabcd?s=128&d=identicon&r=PG", "display_name": "Albert Catal&#224;", "link": "https://stackoverflow.com/users/547341/albert-catal%c3%a0"}, "edited": false, "score": 1, "creation_date": 1554822876, "post_id": 51402899, "comment_id": 97888738, "body": "As docs recomends &quot;though in general we discourage its use for a number of reasons&quot;. <code>expect_any_instance_of</code> it should be avoided as much as possible (<a href=\"https://relishapp.com/rspec/rspec-mocks/v/3-8/docs/working-with-legacy-code/any-instance\" rel=\"nofollow noreferrer\">relishapp.com/rspec/rspec-mocks/v/3-8/docs/&hellip;</a>)"}], "tags": [], "owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "is_accepted": true, "score": 9, "last_activity_date": 1531919486, "last_edit_date": 1531919486, "creation_date": 1531919408, "answer_id": 51402899, "question_id": 51401247, "link": "https://stackoverflow.com/questions/51401247/how-to-stub-class-instantiated-inside-tested-class-in-rspec/51402899#51402899", "title": "How to stub class instantiated inside tested class in rspec", "body": "<p>Reaching for DI is always a good idea (<a href=\"https://stackoverflow.com/a/51401376/299774\">https://stackoverflow.com/a/51401376/299774</a>) but there are sometimes reasons you can't so it, so here's another way to stub it without changing the \"production\" code. </p>\n\n<h1>1. <code>expect_any_instance_of</code></h1>\n\n<pre><code>it 'uploads to google cloud' do\n  expect_any_instance_of(Google::Storage).to receive(:insert_object)\n  worker = UploadWorker.new\n  worker.perform\nend\n</code></pre>\n\n<p>In case you just want to test that the method calls the method on any such objects.</p>\n\n<h1>2. bit more elaborated setup</h1>\n\n<p>In case you want to control or set up more expectations, you can do this</p>\n\n<pre><code>  it 'uploads to google cloud' do\n    the_double = instance_double(Google::Storage)\n    expect(Google::Storage).to receive(:new).and_return(the_double)\n       # + optional `.with` in case you wanna assert stuff passed to the constructor\n    expect(the_double).to receive(:insert_object)\n    worker = UploadWorker.new\n    worker.perform\n  end\n</code></pre>\n\n<p>Again - Dependency Injection is clearer, and you should aim for it. This is presented as another possibility.</p>\n"}], "owner": {"reputation": 377, "user_id": 2050755, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/1ad025f9d6859f8f9cc19966d3868eea?s=128&d=identicon&r=PG", "display_name": "Rajesh Naik", "link": "https://stackoverflow.com/users/2050755/rajesh-naik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2921, "favorite_count": 0, "accepted_answer_id": 51402899, "answer_count": 2, "score": 6, "last_activity_date": 1532009813, "creation_date": 1531914460, "last_edit_date": 1531919261, "question_id": 51401247, "link": "https://stackoverflow.com/questions/51401247/how-to-stub-class-instantiated-inside-tested-class-in-rspec", "title": "How to stub class instantiated inside tested class in rspec", "body": "<p>I have problem stubbing external api, following is the example</p>\n\n<pre><code>require 'rspec'\nrequire 'google/apis/storage_v1'\n\nmodule Google\n  class Storage\n    def upload file\n      puts '#' * 90\n      puts \"File #{file} is uploaded to google cloud\"\n    end\n  end\nend\n\nclass UploadWorker\n  include Sidekiq::Worker\n\n  def perform\n    Google::Storage.new.upload 'test.txt'\n  end\nend\n\n\nRSpec.describe UploadWorker do\n\n  it 'uploads to google cloud' do\n    google_cloud_instance = double(Google::Storage, insert_object: nil)\n    expect(google_cloud_instance).to receive(:upload)\n    worker = UploadWorker.new\n    worker.perform\n  end\nend\n</code></pre>\n\n<p>I'm trying to stub Google::Storage class. This class is instantiated inside the object being tested. How can I verify the message expectation on this instance?</p>\n\n<p>When I run above example, I get following output, and it seems logical, my double is not used by tested object</p>\n\n<pre><code>(Double Google::Storage).upload(*(any args))\n           expected: 1 time with any arguments\n           received: 0 times with any arguments\n</code></pre>\n\n<p>I'm new to Rspec and having hard time with this, any help will be appreciated.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby", "elasticsearch", "logstash", "kibana"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1531935591, "post_id": 51401036, "comment_id": 89787218, "body": "I don&#39;t see why the three tags other than &quot;ruby&quot; are there. If they are not relevent--I don&#39;t see why they would be--they should not be included. Tags are to assist in searches. If a member wants to examine questions concerning, say, <code>logstash</code>, would they want to see this question?"}], "answers": [{"comments": [{"owner": {"reputation": 224, "user_id": 4051417, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh5.googleusercontent.com/-dv8ARvMLRtE/AAAAAAAAAAI/AAAAAAAAANM/rVwTUuUwVXw/photo.jpg?sz=128", "display_name": "Saram ali", "link": "https://stackoverflow.com/users/4051417/saram-ali"}, "edited": false, "score": 0, "creation_date": 1531915336, "post_id": 51401265, "comment_id": 89773717, "body": "I tried this and it doesn&#39;t replace. Are you sure you meant gsub!. not gsub."}, {"owner": {"reputation": 1432, "user_id": 1184912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc5f9407e5093fbd916ea4d80c7a499f?s=128&d=identicon&r=PG", "display_name": "eyevan", "link": "https://stackoverflow.com/users/1184912/eyevan"}, "reply_to_user": {"reputation": 224, "user_id": 4051417, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh5.googleusercontent.com/-dv8ARvMLRtE/AAAAAAAAAAI/AAAAAAAAANM/rVwTUuUwVXw/photo.jpg?sz=128", "display_name": "Saram ali", "link": "https://stackoverflow.com/users/4051417/saram-ali"}, "edited": false, "score": 0, "creation_date": 1531915500, "post_id": 51401265, "comment_id": 89773844, "body": "<code>gsub!</code> replaces in-place. <code>@mystring.gsub!(...);</code> is the same as doing <code>@mystring = @mystring.gsub(...);</code>."}, {"owner": {"reputation": 224, "user_id": 4051417, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh5.googleusercontent.com/-dv8ARvMLRtE/AAAAAAAAAAI/AAAAAAAAANM/rVwTUuUwVXw/photo.jpg?sz=128", "display_name": "Saram ali", "link": "https://stackoverflow.com/users/4051417/saram-ali"}, "edited": false, "score": 0, "creation_date": 1531915717, "post_id": 51401265, "comment_id": 89774000, "body": "I tried by both, it doesn&#39;t replace. I get the same \\\\n in the string."}, {"owner": {"reputation": 1432, "user_id": 1184912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc5f9407e5093fbd916ea4d80c7a499f?s=128&d=identicon&r=PG", "display_name": "eyevan", "link": "https://stackoverflow.com/users/1184912/eyevan"}, "reply_to_user": {"reputation": 224, "user_id": 4051417, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh5.googleusercontent.com/-dv8ARvMLRtE/AAAAAAAAAAI/AAAAAAAAANM/rVwTUuUwVXw/photo.jpg?sz=128", "display_name": "Saram ali", "link": "https://stackoverflow.com/users/4051417/saram-ali"}, "edited": false, "score": 0, "creation_date": 1531915997, "post_id": 51401265, "comment_id": 89774185, "body": "<code>ruby -e &quot;foo = &#39;\\\\\\\\\\n&#39;; puts foo; puts foo.gsub(&#39;\\\\\\\\\\n&#39;, &#39;\\n&#39;)&quot;</code> -- works for me."}, {"owner": {"reputation": 224, "user_id": 4051417, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh5.googleusercontent.com/-dv8ARvMLRtE/AAAAAAAAAAI/AAAAAAAAANM/rVwTUuUwVXw/photo.jpg?sz=128", "display_name": "Saram ali", "link": "https://stackoverflow.com/users/4051417/saram-ali"}, "edited": false, "score": 0, "creation_date": 1531916168, "post_id": 51401265, "comment_id": 89774290, "body": "I&#39;m writing in the logstash script as mentioned in the question. It is not working there."}, {"owner": {"reputation": 1432, "user_id": 1184912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc5f9407e5093fbd916ea4d80c7a499f?s=128&d=identicon&r=PG", "display_name": "eyevan", "link": "https://stackoverflow.com/users/1184912/eyevan"}, "reply_to_user": {"reputation": 224, "user_id": 4051417, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh5.googleusercontent.com/-dv8ARvMLRtE/AAAAAAAAAAI/AAAAAAAAANM/rVwTUuUwVXw/photo.jpg?sz=128", "display_name": "Saram ali", "link": "https://stackoverflow.com/users/4051417/saram-ali"}, "edited": false, "score": 0, "creation_date": 1531916420, "post_id": 51401265, "comment_id": 89774452, "body": "Well, the string wasn&#39;t sufficiently escaped. It is likely that string in the <code>code =&gt;</code> also needs to be escaped once more. I told you what the issue is -- make some effort and work out the solution that works for you from here."}], "tags": [], "owner": {"reputation": 1432, "user_id": 1184912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc5f9407e5093fbd916ea4d80c7a499f?s=128&d=identicon&r=PG", "display_name": "eyevan", "link": "https://stackoverflow.com/users/1184912/eyevan"}, "is_accepted": false, "score": -2, "last_activity_date": 1531917629, "last_edit_date": 1531917629, "creation_date": 1531914497, "answer_id": 51401265, "question_id": 51401036, "link": "https://stackoverflow.com/questions/51401036/ruby-filter-gsub-replace-n/51401265#51401265", "title": "Ruby Filter gsub replace \\\\n", "body": "<p>Escaping of the backslash can be a bit weird.</p>\n\n<p>For a regular Ruby script the code would be:</p>\n\n<pre><code>@mystring = event.get('stockLines').gsub('\\\\\\\\\\n', '\\n')\n</code></pre>\n\n<p>It seems like in logstash config the code is also in a string, so it needs to be escaped once more, i.e.:</p>\n\n<pre><code>ruby\n{\ncode =&gt; \"@mystring = event.get('stockLines').gsub('\\\\\\\\\\\\\\\\\\\\n', '\\\\n');\"\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "is_accepted": false, "score": 1, "last_activity_date": 1531916357, "creation_date": 1531916357, "answer_id": 51401865, "question_id": 51401036, "link": "https://stackoverflow.com/questions/51401036/ruby-filter-gsub-replace-n/51401865#51401865", "title": "Ruby Filter gsub replace \\\\n", "body": "<blockquote>\n  <p>You need to use \"\\n\" not '\\n' in your gsub. The different quote marks behave differently.</p>\n</blockquote>\n\n<p><a href=\"https://stackoverflow.com/questions/4190797/how-can-i-remove-the-string-n-from-within-a-ruby-string\">Read more</a></p>\n\n<p>In your case:</p>\n\n<pre><code>@mystring.gsub(\"\\\\n\", \"\\n\")\n</code></pre>\n\n<p>The essential difference between the two literal forms of strings (single or double quotes) is that double quotes allow for escape sequences while single quotes do not!</p>\n"}], "owner": {"reputation": 1049, "user_id": 1842036, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/ePxbR.jpg?s=128&g=1", "display_name": "Omar Bahir", "link": "https://stackoverflow.com/users/1842036/omar-bahir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 839, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1531917629, "creation_date": 1531913755, "last_edit_date": 1531917167, "question_id": 51401036, "link": "https://stackoverflow.com/questions/51401036/ruby-filter-gsub-replace-n", "title": "Ruby Filter gsub replace \\\\n", "body": "<p>I want to replace '\\\\n' with '\\n'</p>\n\n<p>i am using the gsub method but cannot replace</p>\n\n<pre><code>ruby\n{\n\ncode =&gt; \"@mystring=event.get('stockLines');\n@mystring=@mystring.gsub('\\\\\\n', '\\n');\"\n\n}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "build", "continuous-integration", "devops"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1531918054, "post_id": 51401023, "comment_id": 89775545, "body": "Your question is very unclear. What do you mean by &quot;build Ruby codes&quot;? What kind of &quot;codes&quot; are you talking about? What do you mean by &quot;build&quot; in that context? Please, give a precise, exact, unambiguous, objective definition of what you mean by &quot;build&quot; and by &quot;Ruby codes&quot;. Also, what do you mean by &quot;deploy directly to ROR&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 10063503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vmW7N.jpg?s=128&g=1", "display_name": "Ahamed N", "link": "https://stackoverflow.com/users/10063503/ahamed-n"}, "edited": false, "score": 0, "creation_date": 1531914560, "post_id": 51401180, "comment_id": 89773131, "body": "Yeah, we use capistrano to deploy the codes. So we don&#39;t need to build ruby codes before deploying huh... Since its a SaaS product and we use Phusion Passenger and Nginx for Web Application... Is there any relation between ROR Framework and Phusion Passenger ?    And thanks for your response"}, {"owner": {"reputation": 3543, "user_id": 2231236, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ZyG2H.jpg?s=128&g=1", "display_name": "Nithin", "link": "https://stackoverflow.com/users/2231236/nithin"}, "edited": false, "score": 0, "creation_date": 1531914958, "post_id": 51401180, "comment_id": 89773454, "body": "that would be a separate question . I hope you have got the answer you were initially looking for"}, {"owner": {"reputation": 2471, "user_id": 8063597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41fe33a379a7894b9246569a6e0396aa?s=128&d=identicon&r=PG&f=1", "display_name": "Rohan", "link": "https://stackoverflow.com/users/8063597/rohan"}, "edited": false, "score": 0, "creation_date": 1531918235, "post_id": 51401180, "comment_id": 89775662, "body": "Just to give you a bried idea Phusion Passenger is app server linking ruby application with web server(Nginx in your case)."}], "tags": [], "owner": {"reputation": 2471, "user_id": 8063597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41fe33a379a7894b9246569a6e0396aa?s=128&d=identicon&r=PG&f=1", "display_name": "Rohan", "link": "https://stackoverflow.com/users/8063597/rohan"}, "is_accepted": false, "score": 0, "last_activity_date": 1531914205, "creation_date": 1531914205, "answer_id": 51401180, "question_id": 51401023, "link": "https://stackoverflow.com/questions/51401023/what-is-the-build-tool-for-ruby-codes/51401180#51401180", "title": "What is the build tool for Ruby codes?", "body": "<p>You need to built code in Java and .Net as these are compile type languages whereas Ruby is an interpreted language ie it will check the syntax errors or any other message whenever the code/file is being run explicitly.</p>\n\n<p>While you can run the ruby file using </p>\n\n<pre><code>ruby filname.rb\n</code></pre>\n\n<p>Is it possible to deploy the code directly to ROR ??\nTo run your code locally using </p>\n\n<pre><code>rails s\n</code></pre>\n\n<p>And deploy the code using capistrano or other tools to some other server.</p>\n\n<p>Hope it clarifies your question.</p>\n"}, {"comments": [{"owner": {"reputation": 75, "user_id": 10063503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vmW7N.jpg?s=128&g=1", "display_name": "Ahamed N", "link": "https://stackoverflow.com/users/10063503/ahamed-n"}, "edited": false, "score": 0, "creation_date": 1531924953, "post_id": 51404450, "comment_id": 89780650, "body": "I&#39;m sorry about the second quest. I&#39;m totally new to this platform and now I clearly understand that why we use Capistrano. Tysm"}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 0, "last_activity_date": 1531925383, "last_edit_date": 1531925383, "creation_date": 1531923648, "answer_id": 51404450, "question_id": 51401023, "link": "https://stackoverflow.com/questions/51401023/what-is-the-build-tool-for-ruby-codes/51404450#51404450", "title": "What is the build tool for Ruby codes?", "body": "<p>Ruby is a <a href=\"https://en.wikipedia.org/wiki/Interpreted_language\" rel=\"nofollow noreferrer\">interpreted language</a>.</p>\n\n<blockquote>\n  <p>An interpreted language is a type of programming language for which\n  most of its implementations execute instructions directly and freely,\n  without previously compiling a program into machine-language\n  instructions. The interpreter executes the program directly,\n  translating each statement into a sequence of one or more subroutines,\n  and then into another language (often machine code).</p>\n</blockquote>\n\n<p>While there are quite a few IDE's that make it faster or easier to write ruby code there is no compiler step. </p>\n\n<blockquote>\n  <p>Is it possible to deploy the code directly to ROR ??</p>\n</blockquote>\n\n<p>The question is totally nonsensical since both Ruby on Rails and your application code are interpreted on the go. </p>\n\n<p>You can run ruby code with the Ruby command:</p>\n\n<pre><code>ruby somefile.rb\n</code></pre>\n\n<p>Or an interactive prompt with <code>irb</code>. </p>\n\n<p>You run RoR applications with <code>rails server</code> and an interactive console with <code>rails console</code>.</p>\n\n<p>While Capistrano is a build tool it does not actually compile code. Rather it just automates the steps of deploying an application, and is an optional dependency usually used when you are deploying via SSH or FTP. Its better compared to other tools in dynamic languages such as Grunt (javascript) or Apache Ant. Capistrano is seldom used when deploying to SAAS platforms such as Heruko.</p>\n"}], "owner": {"reputation": 75, "user_id": 10063503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vmW7N.jpg?s=128&g=1", "display_name": "Ahamed N", "link": "https://stackoverflow.com/users/10063503/ahamed-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1058, "favorite_count": 0, "accepted_answer_id": 51404450, "answer_count": 2, "score": 1, "last_activity_date": 1531925383, "creation_date": 1531913722, "question_id": 51401023, "link": "https://stackoverflow.com/questions/51401023/what-is-the-build-tool-for-ruby-codes", "title": "What is the build tool for Ruby codes?", "body": "<p>Actually when we write codes in Java, we use Maven for building java code similarly Adv Java uses Gradle and .Net code uses Ms Build. But when we write Ruby codes, how can we built that code. </p>\n\n<p>Is it possible to deploy the code directly to ROR ?? </p>\n"}, {"tags": ["ruby", "string", "parsing", "escaping", "yaml"], "comments": [{"owner": {"reputation": 3543, "user_id": 2231236, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ZyG2H.jpg?s=128&g=1", "display_name": "Nithin", "link": "https://stackoverflow.com/users/2231236/nithin"}, "edited": false, "score": 0, "creation_date": 1531914778, "post_id": 51400887, "comment_id": 89773305, "body": "can you share the yaml file"}, {"owner": {"reputation": 7359, "user_id": 599989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d752d2574aeb36bc66471f4d0f8811aa?s=128&d=identicon&r=PG", "display_name": "Bijendra", "link": "https://stackoverflow.com/users/599989/bijendra"}, "edited": false, "score": 0, "creation_date": 1531925201, "post_id": 51400887, "comment_id": 89780829, "body": "I had commented that line and next execution of the i18n command gave errors in other fille"}, {"owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "edited": false, "score": 0, "creation_date": 1532506328, "post_id": 51400887, "comment_id": 89996173, "body": "How can we help without your yml file? Please provide that file or describe how to reconstruct this error."}, {"owner": {"reputation": 7359, "user_id": 599989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d752d2574aeb36bc66471f4d0f8811aa?s=128&d=identicon&r=PG", "display_name": "Bijendra", "link": "https://stackoverflow.com/users/599989/bijendra"}, "edited": false, "score": 0, "creation_date": 1532539286, "post_id": 51400887, "comment_id": 90017767, "body": "The .yml files should not be an issue, reason being if i comment the lines the error moved to another .yml. Also the same yml files are working on different setup ."}, {"owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "edited": false, "score": 0, "creation_date": 1532562064, "post_id": 51400887, "comment_id": 90026487, "body": "Great, but how to reconstruct this error? Now that looks like &quot;I think <code>I18n</code> not working as a must. Please, say me why?&quot;. You must check what gem, version, config file evoke error. If you want not provide en.yml, just leave few lines, that imitates parsing error."}, {"owner": {"reputation": 7359, "user_id": 599989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d752d2574aeb36bc66471f4d0f8811aa?s=128&d=identicon&r=PG", "display_name": "Bijendra", "link": "https://stackoverflow.com/users/599989/bijendra"}, "reply_to_user": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "edited": false, "score": 0, "creation_date": 1532581324, "post_id": 51400887, "comment_id": 90030304, "body": "@Leo snippet from .yml file attached, see the update for how to recontruct"}, {"owner": {"reputation": 1222, "user_id": 2923253, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b165c2d2b048038a90e7215735a71920?s=128&d=identicon&r=PG&f=1", "display_name": "nayiaw", "link": "https://stackoverflow.com/users/2923253/nayiaw"}, "edited": false, "score": 0, "creation_date": 1532581794, "post_id": 51400887, "comment_id": 90030436, "body": "if the yml file itself has no problem, could it be the tabs that&#39;s causing issue? From the yml file you&#39;ve pasted here seems like the <code>en</code> is being indented in tab while others are spaced. This might sounds stupid but it happened to me once."}, {"owner": {"reputation": 7359, "user_id": 599989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d752d2574aeb36bc66471f4d0f8811aa?s=128&d=identicon&r=PG", "display_name": "Bijendra", "link": "https://stackoverflow.com/users/599989/bijendra"}, "edited": false, "score": 0, "creation_date": 1532582292, "post_id": 51400887, "comment_id": 90030591, "body": "aware of that tab issue but here i have validated the yml."}, {"owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "edited": false, "score": 0, "creation_date": 1532594594, "post_id": 51400887, "comment_id": 90036786, "body": "<code>ruby#2.2.7</code>, <code>rails#3.2.22.4</code>, <code>i18n#0.9.5</code>. There is not an error in this part. So, error related to some other gem(can you provide <code>gemfile</code>?). And try to check no printed characters from locales."}], "answers": [{"tags": [], "owner": {"reputation": 7359, "user_id": 599989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d752d2574aeb36bc66471f4d0f8811aa?s=128&d=identicon&r=PG", "display_name": "Bijendra", "link": "https://stackoverflow.com/users/599989/bijendra"}, "is_accepted": true, "score": 2, "last_activity_date": 1532686623, "creation_date": 1532686623, "answer_id": 51555835, "question_id": 51400887, "link": "https://stackoverflow.com/questions/51400887/i18ninvalidlocaledata-i18n-gem-has-issues-in-js-export/51555835#51555835", "title": "I18n::InvalidLocaleData: I18n gem has issues in js export", "body": "<p>This is an OS specific issue, related to YAML library. The parsing of .yml file breaks at <strong>can_not_be_blank: \"can't be blank or click on \\'Any\\'\"</strong>. The below error appears only in OSX tested in multiple versions of OS x.</p>\n\n<pre><code>require 'yaml\n\n2.4.1 :002 &gt; trans1 = YAML.load(File.read(\"/Users/app.yml\"))\nPsych::SyntaxError: (&lt;unknown&gt;): found unknown escape character while parsing a quoted scalar at line 23 column 27\n    from /Users/biju/.rvm/rubies/ruby-2.4.1/lib/ruby/2.4.0/psych.rb:377:in `parse'\n    from /Users/biju/.rvm/rubies/ruby-2.4.1/lib/ruby/2.4.0/psych.rb:377:in `parse_stream'\n    from /Users/biju/.rvm/rubies/ruby-2.4.1/lib/ruby/2.4.0/psych.rb:325:in `parse'\n    from /Users/biju/.rvm/rubies/ruby-2.4.1/lib/ruby/2.4.0/psych.rb:252:in `load'\n    from (irb):2\n    from /Users/biju/.rvm/rubies/ruby-2.4.1/bin/irb:11:in `&lt;main&gt;'\n2.4.1 :003 &gt; \n</code></pre>\n\n<p>The same code works in windows irb. However in OSX changing <strong>\\'Any\\'</strong> to <strong>'Any'</strong> helps to execute the operation. Not sure what could be the reason except that the library is installed in unix vs windows. </p>\n"}], "owner": {"reputation": 7359, "user_id": 599989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d752d2574aeb36bc66471f4d0f8811aa?s=128&d=identicon&r=PG", "display_name": "Bijendra", "link": "https://stackoverflow.com/users/599989/bijendra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 721, "favorite_count": 0, "accepted_answer_id": 51555835, "answer_count": 1, "score": 8, "last_activity_date": 1539123550, "creation_date": 1531913281, "last_edit_date": 1533104188, "question_id": 51400887, "link": "https://stackoverflow.com/questions/51400887/i18ninvalidlocaledata-i18n-gem-has-issues-in-js-export", "title": "I18n::InvalidLocaleData: I18n gem has issues in js export", "body": "<p>I'm working on a <strong>application with Rails 3.2.22.4, Ruby 2.2.7</strong> on OS X 10.13.4. There are multiple translation files eg. en.yml, sq.yml based on the countries. While executing the command from rubymine below, errors are seen on loading the webpages.</p>\n\n<blockquote>\n  <p>rake --trace i18n:js:export</p>\n</blockquote>\n\n<ul>\n<li>The yaml content from en.yml has been validated and it's correct. The specific line in which error is thrown once removed from file will give error in some other .yml file. The current version of gem <code>i18n (0.9.5)</code> is being used.</li>\n<li>Rails server starts but loading of the first page of web application breaks with same error. </li>\n<li>Error is thrown the code encounters i18n translation code, yml formatting is not an issue as error moves from one file to another. </li>\n<li>This is mostly a gem issue either i18n, Psych etc but changing multiple versions have not helped to solve.</li>\n</ul>\n\n<p><strong>Error displayed in browser if tried loading the page:</strong></p>\n\n<pre><code>can not load translations from /Users/biju/projecty/config/locales/en.yml: \n#&lt;Psych::SyntaxError: (/Users/biju/projecty/config/locales/en.yml): found unknown escape character while parsing a quoted scalar at line 26 column 27&gt;\n</code></pre>\n\n<p><strong>Error stack when tried executing rake tasks</strong></p>\n\n<pre><code>2018-07-18 16:40:51 +0530 Projecty::Application.initialize! took 1.733 sec\n---------------------------------------------------------------------------------------------------------------\n** Execute i18n:js:export\nrake aborted!\nI18n::InvalidLocaleData: can not load translations from /Users/biju/projecty/config/locales/en.yml: #&lt;Psych::SyntaxError: (/Users/biju/projecty/config/locales/en.yml): found unknown escape character while parsing a quoted scalar at line 26 column 27&gt;\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/i18n-0.9.5/lib/i18n/backend/base.rb:232:in `rescue in load_yml'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/i18n-0.9.5/lib/i18n/backend/base.rb:229:in `load_yml'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/i18n-0.9.5/lib/i18n/backend/base.rb:213:in `load_file'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/i18n-0.9.5/lib/i18n/backend/base.rb:15:in `block in load_translations'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/i18n-0.9.5/lib/i18n/backend/base.rb:15:in `each'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/i18n-0.9.5/lib/i18n/backend/base.rb:15:in `load_translations'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/i18n-0.9.5/lib/i18n/backend/simple.rb:63:in `init_translations'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/i18n-js-3.0.5/lib/i18n/js.rb:164:in `block in translations'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/i18n-js-3.0.5/lib/i18n/js.rb:163:in `instance_eval'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/i18n-js-3.0.5/lib/i18n/js.rb:163:in `translations'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/i18n-js-3.0.5/lib/i18n/js.rb:121:in `block in scoped_translations'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/i18n-js-3.0.5/lib/i18n/js.rb:120:in `each'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/i18n-js-3.0.5/lib/i18n/js.rb:120:in `scoped_translations'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/i18n-js-3.0.5/lib/i18n/js.rb:43:in `segment_for_scope'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/i18n-js-3.0.5/lib/i18n/js.rb:54:in `block in configured_segments'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/i18n-js-3.0.5/lib/i18n/js.rb:48:in `each'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/i18n-js-3.0.5/lib/i18n/js.rb:48:in `inject'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/i18n-js-3.0.5/lib/i18n/js.rb:48:in `configured_segments'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/i18n-js-3.0.5/lib/i18n/js.rb:93:in `translation_segments'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/i18n-js-3.0.5/lib/i18n/js.rb:36:in `export'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/i18n-js-3.0.5/lib/tasks/export.rake:5:in `block (3 levels) in &lt;top (required)&gt;'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/rake-10.5.0/lib/rake/task.rb:240:in `call'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/rake-10.5.0/lib/rake/task.rb:240:in `block in execute'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/rake-10.5.0/lib/rake/task.rb:235:in `each'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/rake-10.5.0/lib/rake/task.rb:235:in `execute'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/rake-10.5.0/lib/rake/task.rb:179:in `block in invoke_with_call_chain'\n/Users/biju/.rvm/rubies/ruby-2.2.7/lib/ruby/2.2.0/monitor.rb:211:in `mon_synchronize'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/rake-10.5.0/lib/rake/task.rb:172:in `invoke_with_call_chain'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/rake-10.5.0/lib/rake/task.rb:165:in `invoke'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/rake-10.5.0/lib/rake/application.rb:150:in `invoke_task'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/rake-10.5.0/lib/rake/application.rb:106:in `block (2 levels) in top_level'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/rake-10.5.0/lib/rake/application.rb:106:in `each'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/rake-10.5.0/lib/rake/application.rb:106:in `block in top_level'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/rake-10.5.0/lib/rake/application.rb:115:in `run_with_threads'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/rake-10.5.0/lib/rake/application.rb:100:in `top_level'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/rake-10.5.0/lib/rake/application.rb:78:in `block in run'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/rake-10.5.0/lib/rake/application.rb:176:in `standard_exception_handling'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/rake-10.5.0/lib/rake/application.rb:75:in `run'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/rake-10.5.0/bin/rake:33:in `&lt;top (required)&gt;'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/bin/rake:23:in `load'\n/Users/biju/.rvm/gems/ruby-2.2.7@yb/bin/rake:23:in `&lt;top (required)&gt;'\n-e:1:in `load'\n-e:1:in `&lt;main&gt;'\n</code></pre>\n\n<p>snippet from .yml file, line 26 which is giving error.</p>\n\n<pre><code>    en:\n  formtastic:\n    labels:\n      event_filter:\n        source_server: \"Server:\"\n        source_source: \"Sevent_filter:\"\n        source_server: \"Server:\"\n        source_source: \"Source:\"\n        serverOption: \"Server:\"\n        Category: \"Category:\"\n        EventID: \"Event ID:\"\n        Type: \"Type:\"\n        TEA: \"Target E-mail Address:\"\n        All: \"All\"\n        ShWare: \"ShWare:\"\n        Services: \"Services:\"\n        Other: \"Other\"\n        Any: \"Any\"\n        Error: \"Error\"\n        Warning: \"Warning\"\n        Information: \"Information\"\n        None: \"\"\n        can_not_be_blank: \"can't be blank or click on \\'Any\\'\"\n\n  list:\n    buttons:\n      previous: \"Previous\"\n      next: \"Next\"\n</code></pre>\n\n<p><strong>EDIT</strong>\nReconstructing the Error in rails console:</p>\n\n<pre><code>    trans2 = YAML.load(File.read(\"#{D2_DIR}/config/locales/en.yml\")).with_indifferent_access\nPsych::SyntaxError: (&lt;unknown&gt;): found unknown escape character while parsing a quoted scalar at line 26 column 27\n    from /Users/biju/.rvm/rubies/ruby-2.2.7/lib/ruby/2.2.0/psych.rb:370:in `parse'\n    from /Users/biju/.rvm/rubies/ruby-2.2.7/lib/ruby/2.2.0/psych.rb:370:in `parse_stream'\n    from /Users/biju/.rvm/rubies/ruby-2.2.7/lib/ruby/2.2.0/psych.rb:318:in `parse'\n    from /Users/biju/.rvm/rubies/ruby-2.2.7/lib/ruby/2.2.0/psych.rb:245:in `load'\n    from (irb):18\n    from /Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/railties-3.2.22.4/lib/rails/commands/console.rb:47:in `start'\n    from /Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/railties-3.2.22.4/lib/rails/commands/console.rb:8:in `start'\n    from /Users/biju/.rvm/gems/ruby-2.2.7@yb/gems/railties-3.2.22.4/lib/rails/commands.rb:41:in `&lt;top (required)&gt;'\n    from /Users/biju/projecty/script/rails:11:in `require'\n    from /Users/biju/projecty/script/rails:11:in `&lt;top (required)&gt;'\n    from -e:1:in `load'\n    from -e:1:in `&lt;main&gt;'\n</code></pre>\n\n<p>I'm unable to get the pointers after enough search, could be a gem issue not sure though. Any help is appreciated. </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 3543, "user_id": 2231236, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ZyG2H.jpg?s=128&g=1", "display_name": "Nithin", "link": "https://stackoverflow.com/users/2231236/nithin"}, "is_accepted": true, "score": 0, "last_activity_date": 1531913465, "last_edit_date": 1531913465, "creation_date": 1531913005, "answer_id": 51400807, "question_id": 51400511, "link": "https://stackoverflow.com/questions/51400511/rails-after-creating-user-with-devise-set-users-profile/51400807#51400807", "title": "Rails: after creating user with Devise, set user&#39;s profile", "body": "<p>You should be looking at Rails callbacks.</p>\n\n<p>Go through\n<a href=\"http://guides.rubyonrails.org/active_record_callbacks.html#creating-an-object\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/active_record_callbacks.html#creating-an-object</a></p>\n\n<p>Solution would be, add this in <em>user</em> model</p>\n\n<pre><code>after_commit :create_default_profile, on: :create\n\nprivate\n\ndef create_default_profile\n  self.create_profile!\n  # self.profile.new(pass_default_attrs).save!\nend\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10099093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f7d5c80dbb9addac1cc7f37e38356d3?s=128&d=identicon&r=PG&f=1", "display_name": "oistikbal", "link": "https://stackoverflow.com/users/10099093/oistikbal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 51400807, "answer_count": 1, "score": 0, "last_activity_date": 1531913465, "creation_date": 1531912274, "question_id": 51400511, "link": "https://stackoverflow.com/questions/51400511/rails-after-creating-user-with-devise-set-users-profile", "title": "Rails: after creating user with Devise, set user&#39;s profile", "body": "<p>After creating an user with devise, i want to  create auto User's profile.</p>\n\n<p>After creating user trying to use User.last.profile on Rails console</p>\n\n<pre><code>  User Load (0.4ms)  SELECT  `users`.* FROM `users` ORDER BY `users`.`id` DESC LIMIT 1\n  Profile Load (0.3ms)  SELECT  `profiles`.* FROM `profiles` WHERE `profiles`.`user_id` = 3 LIMIT 1\n=&gt; nil\n\n\nclass User &lt; ApplicationRecord\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable and :omniauthable\n  has_one :profile\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\nend\n\nclass Profile &lt; ApplicationRecord\n  belongs_to :user\nend\n\nclass CreateProfiles &lt; ActiveRecord::Migration[5.2]\n  def change\n    create_table :profiles do |t|\n      t.integer :user_id\n      t.integer :cash, null: false, default: \"0\"\n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 102358, "user_id": 15245, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9a2a53db8e9b4476038c94a64b32833f?s=128&d=identicon&r=PG", "display_name": "Ryan Bigg", "link": "https://stackoverflow.com/users/15245/ryan-bigg"}, "edited": false, "score": 1, "creation_date": 1531911722, "post_id": 51400298, "comment_id": 89771323, "body": "Can you show us the code for <code>due_date_time</code>? Maybe it is possible to turn this into a value in a column instead of a method in your model."}, {"owner": {"reputation": 197, "user_id": 9446541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca77ea568f4a9f3a32d5ad3848d8dc85?s=128&d=identicon&r=PG&f=1", "display_name": "daveanderson88", "link": "https://stackoverflow.com/users/9446541/daveanderson88"}, "reply_to_user": {"reputation": 102358, "user_id": 15245, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9a2a53db8e9b4476038c94a64b32833f?s=128&d=identicon&r=PG", "display_name": "Ryan Bigg", "link": "https://stackoverflow.com/users/15245/ryan-bigg"}, "edited": false, "score": 0, "creation_date": 1531912978, "post_id": 51400298, "comment_id": 89772031, "body": "Thanks.  Question updated to include this."}], "answers": [{"tags": [], "owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "is_accepted": true, "score": 1, "last_activity_date": 1531913795, "last_edit_date": 1531913795, "creation_date": 1531913266, "answer_id": 51400883, "question_id": 51400298, "link": "https://stackoverflow.com/questions/51400298/ordering-a-collection-by-instance-method/51400883#51400883", "title": "Ordering a collection by instance method", "body": "<p><code>order</code> from ActiveRecord similar to <code>sort</code> from ruby. So, <code>Od.all.sort</code> run iteration after the database query <code>Od.all</code>, run a new iteration <code>map</code> and then send a new database query. Also <code>Od.all.sort</code> has no sense because <code>where</code> select record when <code>id</code> included in <code>ids</code> but not searching a record for each <code>id</code>.</p>\n\n<p>Easier do something like this:</p>\n\n<pre><code>Od.all.sort_by { |od| [od.priority, od.due_date_time] }\n</code></pre>\n\n<p>But that is a slow solution(<code>ods</code> table include 10k+ records). Prefer to save column to sort to the database. When that is not possible set logic to calculate <code>due_date_time</code> in a database query.</p>\n"}], "owner": {"reputation": 197, "user_id": 9446541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca77ea568f4a9f3a32d5ad3848d8dc85?s=128&d=identicon&r=PG&f=1", "display_name": "daveanderson88", "link": "https://stackoverflow.com/users/9446541/daveanderson88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 372, "favorite_count": 0, "accepted_answer_id": 51400883, "answer_count": 1, "score": 2, "last_activity_date": 1531913795, "creation_date": 1531911571, "last_edit_date": 1531912955, "question_id": 51400298, "link": "https://stackoverflow.com/questions/51400298/ordering-a-collection-by-instance-method", "title": "Ordering a collection by instance method", "body": "<p>I would like to order a collection first by priority and then due time like this:</p>\n\n<pre><code>@ods = Od.order(:priority, :due_date_time)\n</code></pre>\n\n<p>The problem is <code>due_date_time</code> is an instance method of Od, so I get </p>\n\n<blockquote>\n  <p>PG::UndefinedColumn: ERROR:  column ods.due_date_time does not exist</p>\n</blockquote>\n\n<p>I have tried the following, but it seems that by sorting and mapping ids, then finding them again with .where means the sort order is lost.</p>\n\n<pre><code> @ods = Od.where(id: (Od.all.sort {|a,b| a.due_date_time &lt;=&gt; b.due_date_time}.map(&amp;:id))).order(:priority)\n</code></pre>\n\n<p>due_date_time calls a method from a child association:</p>\n\n<pre><code>  def due_date_time\n    run.cut_off_time\n  end\n</code></pre>\n\n<p>run.cut_off_time is defined here:</p>\n\n<pre><code>  def cut_off_time\n    (leave_date.beginning_of_day + route.cut_off_time_mins_since_midnight * 60)\n  end\n</code></pre>\n\n<p>I'm sure there is an easier way. Any help much appreciated!  Thanks.</p>\n"}, {"tags": ["ruby", "selenium", "selenium-webdriver", "automated-tests"], "comments": [{"owner": {"reputation": 5041, "user_id": 7305183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/109a1b8acbf5d01c41e8e725b08411ba?s=128&d=identicon&r=PG&f=1", "display_name": "Murthi", "link": "https://stackoverflow.com/users/7305183/murthi"}, "edited": false, "score": 0, "creation_date": 1531909721, "post_id": 51399365, "comment_id": 89770094, "body": "is the text_field id is constant? I am not able to find it?"}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1531910733, "post_id": 51399365, "comment_id": 89770706, "body": "I don&#39;t find the matching node with the given id."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 10098788, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iQfiI5kgtZ4/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o-egfDh1U1pbt9g1zkKB-qbkQ5eA/mo/photo.jpg?sz=128", "display_name": "Richa ", "link": "https://stackoverflow.com/users/10098788/richa"}, "is_accepted": false, "score": 0, "last_activity_date": 1533723373, "creation_date": 1533723373, "answer_id": 51744175, "question_id": 51399365, "link": "https://stackoverflow.com/questions/51399365/how-to-show-element-in-browed-page-in-selenium-testing/51744175#51744175", "title": "how to show element in browed page in selenium testing?", "body": "<pre><code> require 'watir'\n b = Watir::Browser.start 'http://www.gmail.com'\n t = b.text_field id: 'entry_1000000'\n t.exists?\n t.set 'your name'\n t.value\n</code></pre>\n\n<p>put exact id of that text field . id or xpath or name etc</p>\n"}, {"tags": [], "owner": {"reputation": 66, "user_id": 2620206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f06e38b7fb27850216d7ca126024c9?s=128&d=identicon&r=PG", "display_name": "Luka Vladika", "link": "https://stackoverflow.com/users/2620206/luka-vladika"}, "is_accepted": false, "score": 0, "last_activity_date": 1533859012, "creation_date": 1533859012, "answer_id": 51777202, "question_id": 51399365, "link": "https://stackoverflow.com/questions/51399365/how-to-show-element-in-browed-page-in-selenium-testing/51777202#51777202", "title": "how to show element in browed page in selenium testing?", "body": "<p>First lets check if you have whats needed for that script to run, and start from there if not.</p>\n\n<ul>\n<li>Ruby installed</li>\n<li>Watir gem installed</li>\n<li>Browser installed (chrome or firefox)</li>\n<li>Geckodriver downloaded and in path (if firefox installed)</li>\n<li>Chromedriver downloaded and in path (if chrome installed)</li>\n</ul>\n\n<p>After that, save the code below in file, lets name it <em>gmail.rb</em>. </p>\n\n<pre><code>require 'watir'\nb = Watir::Browser.new :chrome #or :firefox    \nb.goto \"www.gmail.com\"\nb.text_field(:id =&gt; 'identifierId').set \"your_email@gmail.com\"\nb.span(:text =&gt; \"Next\").click\nb.text_field(:name =&gt; \"password\").set \"your_password\"\nb.span(:text =&gt; \"Next\").click\n</code></pre>\n\n<p>Open command prompt or terminal and run the following command from folder where <em>gmail.rb</em> is located </p>\n\n<pre><code>ruby gmail.rb\n</code></pre>\n\n<p>Browser should open, navigate to gmail, input email, password and submit it, but from there gmail security kicks in so this is not a good use case for automation, at least not this way. </p>\n\n<p>You can try the code above and see how it works, and if not, post errors here. But if you actually need to automate reading gmail, there is a really nice gem that helps you do that <a href=\"https://github.com/gmailgem/gmail\" rel=\"nofollow noreferrer\">https://github.com/gmailgem/gmail</a></p>\n"}], "owner": {"reputation": 21, "user_id": 10098788, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iQfiI5kgtZ4/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o-egfDh1U1pbt9g1zkKB-qbkQ5eA/mo/photo.jpg?sz=128", "display_name": "Richa ", "link": "https://stackoverflow.com/users/10098788/richa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1533859012, "creation_date": 1531908807, "question_id": 51399365, "link": "https://stackoverflow.com/questions/51399365/how-to-show-element-in-browed-page-in-selenium-testing", "title": "how to show element in browed page in selenium testing?", "body": "<p>I tried this to do selenium testing</p>\n\n<pre><code> require 'watir'\n b = Watir::Browser.start 'http://www.gmail.com'\n t = b.text_field id: 'entry_1000000'\n t.exists?\n t.set 'your name'\n t.value\n</code></pre>\n\n<p>but not fetching any text in browed page(www.gmail.com).</p>\n"}, {"tags": ["ruby", "ethereum", "bitcoin", "go-ethereum", "erc20"], "comments": [{"owner": {"reputation": 1747, "user_id": 6800303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d86ffb4271b65f9121097792b5f77af1?s=128&d=identicon&r=PG&f=1", "display_name": "NitinSingh", "link": "https://stackoverflow.com/users/6800303/nitinsingh"}, "edited": false, "score": 0, "creation_date": 1531908977, "post_id": 51399337, "comment_id": 89769599, "body": "Any feedback from debugging step by step to see what&#39;s happening ? Any errors"}, {"owner": {"reputation": 21, "user_id": 7081194, "user_type": "registered", "profile_image": "https://graph.facebook.com/1780389838903276/picture?type=large", "display_name": "Mert Mustafa", "link": "https://stackoverflow.com/users/7081194/mert-mustafa"}, "reply_to_user": {"reputation": 1747, "user_id": 6800303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d86ffb4271b65f9121097792b5f77af1?s=128&d=identicon&r=PG&f=1", "display_name": "NitinSingh", "link": "https://stackoverflow.com/users/6800303/nitinsingh"}, "edited": false, "score": 0, "creation_date": 1531912727, "post_id": 51399337, "comment_id": 89771883, "body": "Hello, there is no error on log files. It is really weird"}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 10490386, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YWFowZ6TAFQ/AAAAAAAAAAI/AAAAAAAAAA0/vllJGKVafP8/photo.jpg?sz=128", "display_name": "Spero Coin", "link": "https://stackoverflow.com/users/10490386/spero-coin"}, "is_accepted": false, "score": 0, "last_activity_date": 1581865088, "creation_date": 1581865088, "answer_id": 60249783, "question_id": 51399337, "link": "https://stackoverflow.com/questions/51399337/erc20-tokens-deposit-withdraw-on-ruby/60249783#60249783", "title": "Erc20 tokens deposit/withdraw on ruby", "body": "<p>My code is parameterized for Binance currencies, I haven't tested the ETH network system, but I verified that the codes are similar.\nIt costs nothing to test ...</p>\n\n<pre><code>require 'net/http'\nrequire 'uri'\nrequire 'json'\n\nclass CoinRPC\n\n  class JSONRPCError &lt; RuntimeError; end\n  class ConnectionRefusedError &lt; StandardError; end\n\n  def initialize(coin)\n    @uri = URI.parse(coin.rpc)\n    @rest = coin.rest\n    @coin = coin\n  end\n\n  def self.[](currency)\n    c = Currency.find_by_code(currency.to_s)\n    if c &amp;&amp; c.rpc\n      if c.proto == 'ETH'\n        name = 'ETH'\n      elsif c.proto == 'BTC'\n        name = 'BTC'\n      elsif c.proto == 'OLD_BTC'\n        name = 'OLD_BTC'\n      elsif c.proto == 'WOA_BTC'\n        name = 'WOA_BTC'\n      elsif c.proto == 'CNT'\n        name = 'CNT'\n      else\n        name = c[:handler]\n      end\n      Rails.logger.info \"Making class \" + name.to_s + \"(\" + currency.to_s + \")\\n\"\n      \"::CoinRPC::#{name.to_s}\".constantize.new(c)\n    end\n  end\n\n  def method_missing(name, *args)\n    handle name, *args\n  end\n\n  def handle\n    raise \"Not implemented\"\n  end\n\n  class BTC &lt; self\n    def handle(name, *args)\n      post_body = { 'method' =&gt; name, 'params' =&gt; args, 'id' =&gt; 'jsonrpc' }.to_json\n      resp = JSON.parse( http_post_request(post_body) )\n      raise JSONRPCError, resp['error'] if resp['error']\n      result = resp['result']\n      result.symbolize_keys! if result.is_a? Hash\n      result\n    end\n    def http_post_request(post_body)\n      http    = Net::HTTP.new(@uri.host, @uri.port)\n      request = Net::HTTP::Post.new(@uri.request_uri)\n      request.basic_auth @uri.user, @uri.password\n      request.content_type = 'application/json'\n      request.body = post_body\n      http.request(request).body\n    rescue Errno::ECONNREFUSED =&gt; e\n      raise ConnectionRefusedError\n    end\n\n    def http_post_request(post_body)\n      http    = Net::HTTP.new(@uri.host, @uri.port)\n      request = Net::HTTP::Post.new(@uri.request_uri)\n      request.basic_auth @uri.user, @uri.password\n      request.content_type = 'application/json'\n      request.body = post_body\n      @reply = http.request(request).body\n      # Rails.logger.info @reply\n      return @reply\n    rescue Errno::ECONNREFUSED =&gt; e\n      raise ConnectionRefusedError\n    end\n\n    def getnewaddress(name, digest)\n      @newaddress = handle(\"getnewaddress\", name)\n    end\n\n    def safe_getblockchaininfo\n      begin\n        getblockchaininfo\n      rescue\n        'N/A'\n      end\n    end\n\n    def safe_getbalance\n      begin\n        getbalance\n      rescue\n        'N/A'\n      end\n    end\n  end\n\n  class OLD_BTC &lt; self\n    def handle(name, *args)\n      post_body = { 'method' =&gt; name, 'params' =&gt; args, 'id' =&gt; 'jsonrpc' }.to_json\n      resp = JSON.parse( http_post_request(post_body) )\n      raise JSONRPCError, resp['error'] if resp['error']\n      result = resp['result']\n      result.symbolize_keys! if result.is_a? Hash\n      result\n    end\n    def http_post_request(post_body)\n      http    = Net::HTTP.new(@uri.host, @uri.port)\n      request = Net::HTTP::Post.new(@uri.request_uri)\n      request.basic_auth @uri.user, @uri.password\n      request.content_type = 'application/json'\n      request.body = post_body\n      http.request(request).body\n    rescue Errno::ECONNREFUSED =&gt; e\n      raise ConnectionRefusedError\n    end\n\n    def getnewaddress(name, digest)\n      @newaddress = handle(\"getnewaddress\", name)\n    end\n\n    def getblockchaininfo\n      @getinfo = getinfo()\n      {\n        blocks: Integer(@getinfo[:blocks]),\n        headers: 0,\n        mediantime: 0\n      }\n    end\n\n    def safe_getbalance\n      begin\n        getbalance\n      rescue\n        'N/A'\n      end\n    end\n  end\n\n class WOA_BTC &lt; self\n    def handle(name, *args)\n      post_body = { 'method' =&gt; name, 'params' =&gt; args, 'id' =&gt; 'jsonrpc' }.to_json\n      Rails.logger.info \"WOA_BTC \" +  post_body\n      resp = JSON.parse( http_post_request(post_body) )\n      Rails.logger.info resp\n      raise JSONRPCError, resp['error'] if resp['error']\n      result = resp['result']\n\n      result.symbolize_keys! if result.is_a? Hash\n      result\n    end\n\n    def http_post_request(post_body)\n      http    = Net::HTTP.new(@uri.host, @uri.port)\n      request = Net::HTTP::Post.new(@uri.request_uri)\n      request.basic_auth @uri.user, @uri.password\n      request.content_type = 'application/json'\n      request.body = post_body\n      #Rails.logger.info post_body\n      @reply = http.request(request).body\n      #Rails.logger.info @reply\n      return @reply\n    rescue Errno::ECONNREFUSED =&gt; e\n      raise ConnectionRefusedError\n    end\n\n    def sendtoaddress(from, address, amount)\n      handle(\"sendtoaddress\", address, amount)\n    end\n\n    def getnewaddress(name, digest)\n      @newaddress = handle(\"getnewaddress\", \"\")\n    end\n\n    def getblockchaininfo\n      @getinfo = getinfo()\n      {\n        blocks: Integer(@getinfo[:blocks]),\n        headers: 0,\n        mediantime: 0\n      }\n    end\n\n    def safe_getbalance\n      begin\n        getbalance\n      rescue\n        'N/A'\n      end\n    end\n  end\n\n  class ETH &lt; self\n    def handle(name, *args)\n      post_body = {\"jsonrpc\" =&gt; \"2.0\", 'method' =&gt; name, 'params' =&gt; args, 'id' =&gt; '1' }.to_json\n      resp = JSON.parse( http_post_request(post_body) )\n      raise JSONRPCError, resp['error'] if resp['error']\n      result = resp['result']\n      result.symbolize_keys! if result.is_a? Hash\n      result\n    end\n    def http_post_request(post_body)\n      http    = Net::HTTP.new(@uri.host, @uri.port)\n      request = Net::HTTP::Post.new(@uri.request_uri)\n      request.basic_auth @uri.user, @uri.password\n      request.content_type = 'application/json'\n      request.body = post_body\n      http.request(request).body\n    rescue Errno::ECONNREFUSED =&gt; e\n      raise ConnectionRefusedError\n    end\n\n    def safe_getbalance\n      begin\n        (open(@uri.host + '/cgi-bin/total.cgi').read.rstrip.to_f)\n      rescue\n        'N/A'\n      end\n    end\n\n    def getblockchaininfo\n      @lastBlock = eth_getBlockByNumber(\"latest\", true)\n      #Rails.logger.info @lastBlock\n      #Rails.logger.info \"number = \" + Integer(@lastBlock[:number]).to_s + \", timestamp = \" + Integer(@lastBlock[:timestamp]).to_s\n\n      {\n        blocks: Integer(@lastBlock[:number]),\n        headers: 0,\n        mediantime: Integer(@lastBlock[:timestamp])\n      }\n    end\n  end\n\n  class LISK &lt; self\n    def handle(name, *args)\n      post_body = {\"jsonrpc\" =&gt; \"2.0\", 'method' =&gt; name, 'params' =&gt; args, 'id' =&gt; '1' }.to_json\n      Rails.logger.info \"LISK -&gt; \" + post_body\n      resp = JSON.parse( http_post_request(post_body) )\n      Rails.logger.info \"LISK &lt;- \" + resp.to_json\n      raise JSONRPCError, resp['error'] if resp['error']\n      result = resp['result']\n      result.symbolize_keys! if result.is_a? Hash\n      result\n    end\n\n    def http_post_request(post_body)\n      http    = Net::HTTP.new(@uri.host, @uri.port)\n      request = Net::HTTP::Post.new(@uri.request_uri)\n      request.basic_auth @uri.user, @uri.password\n      request.content_type = 'application/json'\n      request.body = post_body\n      @reply = http.request(request).body\n      return @reply\n    rescue Errno::ECONNREFUSED =&gt; e\n      raise ConnectionRefusedError\n    end\n\n    def http_post_request_body(post_url, post_body)\n      Rails.logger.info \"LISK -&gt; \" + post_url + \" / \" + post_body\n      uri     = URI.parse(post_url)\n      http    = Net::HTTP.new(uri.host, uri.port)\n      request = Net::HTTP::Post.new(uri.request_uri)\n      request.basic_auth uri.user, uri.password\n      request.content_type = 'application/json'\n      request.body = post_body\n      reply = JSON.parse(http.request(request).body)\n      raise JSONRPCError, reply['error'] if reply['error']\n      Rails.logger.info \"LISK &lt;- \" + reply.to_json\n      return reply\n    rescue Errno::ECONNREFUSED =&gt; e\n      raise ConnectionRefusedError\n    end\n\n    def http_get_request(get_url)\n      Rails.logger.info \"LISK -&gt; \" + get_url\n      uri     = URI.parse(get_url)\n      http    = Net::HTTP.new(uri.host, uri.port)\n      request = Net::HTTP::Get.new(uri.request_uri)\n      request.basic_auth uri.user, uri.password\n      request.content_type = \"\"\n      request.body = \"\"\n      reply = http.request(request).body\n      result = JSON.parse(reply)\n      raise JSONRPCError, result['error'] if result['error']\n      Rails.logger.info \"LISK &lt;- \" + result.to_json\n      return result\n    end\n\n    def http_put_request_body(post_url, post_body)\n      Rails.logger.info \"LISK -&gt; \" + post_url + \" / \" + post_body\n      uri     = URI.parse(post_url)\n      http    = Net::HTTP.new(uri.host, uri.port)\n      request = Net::HTTP::Put.new(uri.request_uri)\n      request.basic_auth uri.user, uri.password\n      request.content_type = 'application/json'\n      request.body = post_body\n      reply = JSON.parse(http.request(request).body)\n      raise JSONRPCError, reply['error'] if reply['error']\n      Rails.logger.info \"LISK &lt;- \" + reply.to_json\n      return reply\n    rescue Errno::ECONNREFUSED =&gt; e\n      raise ConnectionRefusedError\n    end\n\n    def safe_getbalance\n      begin\n        getbalance\n      rescue =&gt; ex\n        Rails.logger.info  \"[error]: \" + ex.message + \"\\n\" + ex.backtrace.join(\"\\n\") + \"\\n\"\n        'N/A'\n      end\n    end\n\n    def getbalance\n      result = http_get_request(\"#{@rest}/api/accounts/getBalance?address=#{@coin.base_account}\")\n      balance = result['balance'].to_f / 100000000.0\n      return balance\n    end\n\n    def gettransaction(txid)\n      transaction = http_get_request(\"#{@rest}/api/transactions/get?id=#{txid}\")\n\n      {\n        confirmations: transaction['transaction']['confirmations'],\n        time: Time.now.to_i,\n        details:\n        [\n          address: transaction['transaction']['recipientId'],\n          amount: transaction['transaction']['amount'].to_f / 100000000.0,\n          category: \"receive\"\n        ]\n      }\n    end\n\n    def settxfee\n    end\n\n    def sendtoaddress(from, address, amount)\n      parameters = \n      {\n        secret: from,\n        amount: Integer(amount * 100000000.0),\n        recipientId: address\n      }.to_json\n      result = http_put_request_body(\"#{@rest}/api/transactions\", parameters)\n      return result['transactionId']\n    end\n\n    # digest - simple form usermail &amp; number\n    def getnewaddress(base_account, digest)\n      parameters =\n      {\n        secret: digest\n      }.to_json\n\n      result = http_post_request_body(\"#{@rest}/api/accounts/open\", parameters)\n      return result['account']['address']\n    end\n\n    def getfee(size)\n      return (12000000.0/100000000.0).to_f\n    end\n\n    def validateaddress(address)\n    end\n\n    def getblockchaininfo\n\n      result = http_get_request(\"#{@rest}/api/blocks/getStatus\")\n\n      {\n        blocks: Integer(result['height']),\n        headers: 0,\n        mediantime: 0\n      }\n    end\n  end\n\n  class CNT &lt; self\n    def handle(name, *args)\n      post_body = {\"jsonrpc\" =&gt; \"2.0\", 'method' =&gt; name, 'params' =&gt; args, 'id' =&gt; '1' }.to_json\n      Rails.logger.info \"CNT -&gt; \" + post_body\n      resp = JSON.parse( http_post_request(post_body) )\n      Rails.logger.info \"CNT &lt;- \" + resp.to_json\n      raise JSONRPCError, resp['error'] if resp['error']\n      result = resp['result']\n      #result.symbolize_keys! if result.is_a? Hash\n      result\n    end\n\n    def handle_one(name, arg)\n      post_body = {\"jsonrpc\" =&gt; \"2.0\", 'method' =&gt; name, 'params' =&gt; arg, 'id' =&gt; '1' }.to_json\n      Rails.logger.info \"CNT -&gt; \" + post_body\n      resp = JSON.parse( http_post_request(post_body) )\n      Rails.logger.info \"CNT &lt;- \" + resp.to_json\n      raise JSONRPCError, resp['error'] if resp['error']\n      result = resp['result']\n      #result.symbolize_keys! if result.is_a? Hash\n      result\n    end\n\n    def http_post_request(post_body)\n      http    = Net::HTTP.new(@uri.host, @uri.port)\n      request = Net::HTTP::Post.new(@uri.request_uri)\n      #request.basic_auth @uri.user, @uri.password\n      request.content_type = 'application/json'\n      request.body = post_body\n      @reply = http.request(request).body\n      return @reply\n    rescue Errno::ECONNREFUSED =&gt; e\n      raise ConnectionRefusedError\n    end\n\n\n    def safe_getbalance\n      begin\n        getbalance\n      rescue =&gt; ex\n        Rails.logger.info  \"[error]: \" + ex.message + \"\\n\" + ex.backtrace.join(\"\\n\") + \"\\n\"\n        'N/A'\n      end\n    end\n\n    def getbalance\n      result = handle(\"getbalance\")\n      balance = result['balance'].to_f / 1000000000.0\n      return balance\n    end\n\n    def gettransaction(txid)\n      parameters =\n      {\n        txid: txid\n      }\n      transaction = handle_one(\"get_transfer_by_txid\", parameters)\n      confirmations = Integer(transaction['transfer']['height'])\n      if confirmations &gt; 0\n        result = handle(\"getheight\", \"\")\n        confirmations = Integer(result['height']) - confirmations\n      end\n      result =  {\n          confirmations: confirmations,\n          time: Time.now.to_i,\n          details:[]\n        }\n      if transaction['transfer']['destinations'] == nil\n        return result\n      end\n      transaction['transfer']['destinations'].each do |destination|\n        tx = {\n            address: destination['address'],\n            amount: destination['amount'].to_f / 1000000000.0,\n            category: \"receive\"\n          }\n        result[:details].push(tx)\n      end\n      return result\n    end\n\n    def settxfee\n    end\n\n    def sendtoaddress(from, address, amount)\n      parameters =\n      {\n        account_index: 0,\n        destinations:\n        [\n          {\n            amount: Integer(amount * 1000000000.0),\n            address: address\n          }\n        ],\n        get_tx_key: true\n      }\n\n      result = handle_one(\"transfer\", parameters)\n      return result['tx_hash']\n    end\n\n    def getnewaddress(name, digest)\n      parameters =\n      {\n        account_index: 0,\n        label: \"\"\n      }.to_json\n\n      result = handle_one(\"create_address\", parameters)\n      return result['address']\n    end\n\n    def getfee(size)\n      return (30000000.0/1000000000.0).to_f\n    end\n\n    def validateaddress(address)\n    end\n\n    def getblockchaininfo\n\n      result = handle(\"getheight\", \"\")\n\n      {\n        blocks: Integer(result['height']),\n        headers: 0,\n        mediantime: 0\n      }\n    end\n  end\n\nend\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7081194, "user_type": "registered", "profile_image": "https://graph.facebook.com/1780389838903276/picture?type=large", "display_name": "Mert Mustafa", "link": "https://stackoverflow.com/users/7081194/mert-mustafa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 234, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1581865088, "creation_date": 1531908722, "question_id": 51399337, "link": "https://stackoverflow.com/questions/51399337/erc20-tokens-deposit-withdraw-on-ruby", "title": "Erc20 tokens deposit/withdraw on ruby", "body": "<p>I use Peatio based exchange. Ethereum deposit/withdraw are working, but Binance coin doesn't work. I can't generate binance coin address. My codes below. Is it wring? I reall need help.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>require 'net/http'\r\nrequire 'uri'\r\nrequire 'json'\r\n\r\nclass CoinRPC\r\n\r\n  class JSONRPCError &lt; RuntimeError; end\r\n  class ConnectionRefusedError &lt; StandardError; end\r\n\r\n  def initialize(uri)\r\n    @uri = URI.parse(uri)\r\n  end\r\n\r\n  def self.[](currency)\r\n    c = Currency.find_by_code(currency.to_s)\r\n    if c &amp;&amp; c.rpc\r\n      name = c[:handler] || 'BTC'\r\n      \"::CoinRPC::#{name}\".constantize.new(c.rpc)\r\n    end\r\n  end\r\n\r\n  def method_missing(name, *args)\r\n    handle name, *args\r\n  end\r\n\r\n  def handle\r\n    raise \"Not implemented\"\r\n  end\r\n\r\n  class BTC &lt; self\r\n    def handle(name, *args)\r\n      post_body = { 'method' =&gt; name, 'params' =&gt; args, 'id' =&gt; 'jsonrpc' }.to_json\r\n      resp = JSON.parse( http_post_request(post_body) )\r\n      raise JSONRPCError, resp['error'] if resp['error']\r\n      result = resp['result']\r\n      result.symbolize_keys! if result.is_a? Hash\r\n      result\r\n    end\r\n\r\n    def http_post_request(post_body)\r\n      http    = Net::HTTP.new(@uri.host, @uri.port)\r\n      request = Net::HTTP::Post.new(@uri.request_uri)\r\n      request.basic_auth @uri.user, @uri.password\r\n      request.content_type = 'application/json'\r\n      request.body = post_body\r\n      http.request(request).body\r\n    rescue Errno::ECONNREFUSED =&gt; e\r\n      raise ConnectionRefusedError\r\n    end\r\n\r\n    def safe_getbalance\r\n      begin\r\n        getbalance\r\n      rescue\r\n        'N/A'\r\n      end\r\n    end\r\n  end\r\n\r\n  class ETH &lt; self\r\ndef handle(name, *args)\r\n  post_body = {\"jsonrpc\" =&gt; \"2.0\", 'method' =&gt; name, 'params' =&gt; args, 'id' =&gt; '1' }.to_json\r\n  resp = JSON.parse( http_post_request(post_body) )\r\n  raise JSONRPCError, resp['error'] if resp['error']\r\n  result = resp['result']\r\n  result.symbolize_keys! if result.is_a? Hash\r\n  result\r\nend\r\ndef http_post_request(post_body)\r\n  http    = Net::HTTP.new(@uri.host, @uri.port)\r\n  request = Net::HTTP::Post.new(@uri.request_uri)\r\n  request.basic_auth @uri.user, @uri.password\r\n  request.content_type = 'application/json'\r\n  request.body = post_body\r\n  http.request(request).body\r\nrescue Errno::ECONNREFUSED =&gt; e\r\n  raise ConnectionRefusedError\r\nend\r\n\r\ndef safe_getbalance\r\n  begin\r\n    (open(@uri.host + '/cgi-bin/total.cgi').read.rstrip.to_f)\r\n  rescue\r\n    'N/A'\r\n  end\r\nend\r\n  end\r\n\r\n  class BNB &lt; self\r\ndef handle(name, *args)\r\n  post_body = {\"jsonrpc\" =&gt; \"2.0\", 'method' =&gt; name, 'params' =&gt; args, 'id' =&gt; '1' }.to_json\r\n  resp = JSON.parse( http_post_request(post_body) )\r\n  raise JSONRPCError, resp['error'] if resp['error']\r\n  result = resp['result']\r\n  result.symbolize_keys! if result.is_a? Hash\r\n  result\r\nend\r\ndef http_post_request(post_body)\r\n  http    = Net::HTTP.new(@uri.host, @uri.port)\r\n  request = Net::HTTP::Post.new(@uri.request_uri)\r\n  request.basic_auth @uri.user, @uri.password\r\n  request.content_type = 'application/json'\r\n  request.body = post_body\r\n  http.request(request).body\r\nrescue Errno::ECONNREFUSED =&gt; e\r\n  raise ConnectionRefusedError\r\nend\r\n\r\ndef safe_getbalance\r\n  begin\r\n    (open(@uri.host + '/cgi-bin/total.cgi').read.rstrip.to_f)\r\n  rescue\r\n    'N/A'\r\n  end\r\nend\r\n  end\r\nend</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["ruby", "webpack", "capybara", "sinatra", "acceptance-testing"], "comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1531908208, "post_id": 51398559, "comment_id": 89769127, "body": "<a href=\"https://stackoverflow.com/questions/8413443/when-running-selenium-with-capybara-rails-how-do-i-configure-the-server\" title=\"when running selenium with capybara rails how do i configure the server\">stackoverflow.com/questions/8413443/&hellip;</a> should help I think"}, {"owner": {"reputation": 2096, "user_id": 314346, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7bf65dcb7e862416161ea9bb591c2d8d?s=128&d=identicon&r=PG", "display_name": "Macario", "link": "https://stackoverflow.com/users/314346/macario"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1531908848, "post_id": 51398559, "comment_id": 89769525, "body": "Hi Mark, not quite, I need to do some work when capybara spawns it&#39;s servers, is not about configuring the driver or the server."}], "answers": [{"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 1, "last_activity_date": 1531929100, "creation_date": 1531929100, "answer_id": 51406253, "question_id": 51398559, "link": "https://stackoverflow.com/questions/51398559/capybara-how-to-run-code-when-server-is-spawned/51406253#51406253", "title": "Capybara: how to run code when server is spawned?", "body": "<p><code>Capybara.server=</code> takes the registered name of the server proc to use when starting the server, and you can register your own using <code>Capybara.register_server</code>.  Therefore you should be able to do something like</p>\n\n<pre><code>Capybara.register_server :my_server do |app, port, host, **options|\n  # start whatever you need started here\n  do_my_stuff\n  Capybara.servers[:puma].call(app, port, host) # assuming you want puma as the actual server\nend\n\nCapybara.server = :my_server\n</code></pre>\n"}], "owner": {"reputation": 2096, "user_id": 314346, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7bf65dcb7e862416161ea9bb591c2d8d?s=128&d=identicon&r=PG", "display_name": "Macario", "link": "https://stackoverflow.com/users/314346/macario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 51406253, "answer_count": 1, "score": 0, "last_activity_date": 1531929100, "creation_date": 1531906496, "last_edit_date": 1531908932, "question_id": 51398559, "link": "https://stackoverflow.com/questions/51398559/capybara-how-to-run-code-when-server-is-spawned", "title": "Capybara: how to run code when server is spawned?", "body": "<p>I have a Sinatra application with WebPack, when I start my app in development I spawn a process running Webpack Dev Server and use RackProxy to serve assets from my Sinatra app.</p>\n\n<p>I also have to run Webpack Dev Server when running my JS Capybara acceptance tests just when Capybara spawns the ruby server.</p>\n\n<p>So far I've came up with placing the WDS start in the driver register block, but I have different drivers.</p>\n\n<pre><code>Capybara.register_driver :headless_chrome do |app|\n  Rack::WebpackProxy.start_server\n\n  Capybara::Selenium::Driver.new(app, browser: :chrome, args: [\"headless\"])\nend\n</code></pre>\n\n<p>What is the hook to run code when Capybara server is spawned?</p>\n"}, {"tags": ["ruby", "google-api", "google-sheets-api", "google-api-ruby-client"], "answers": [{"tags": [], "owner": {"reputation": 70965, "user_id": 1841839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZyKjr.png?s=128&g=1", "display_name": "DaImTo", "link": "https://stackoverflow.com/users/1841839/daimto"}, "is_accepted": false, "score": 1, "last_activity_date": 1531906458, "creation_date": 1531906458, "answer_id": 51398542, "question_id": 51398104, "link": "https://stackoverflow.com/questions/51398104/how-to-find-token-for-google-sheet-api-v4/51398542#51398542", "title": "How to find token for Google sheet API v4", "body": "<p>TOKEN_PATH is just the directory where you want the tokens saved.  So </p>\n\n<pre><code>TOKEN_PATH = 'token.yaml'.freeze\n</code></pre>\n\n<p>is just a directory its not really a file.</p>\n"}], "owner": {"reputation": 15, "user_id": 381871, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001676715887/picture?type=large", "display_name": "Sandeep Patle", "link": "https://stackoverflow.com/users/381871/sandeep-patle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1531906504, "creation_date": 1531905329, "last_edit_date": 1531906504, "question_id": 51398104, "link": "https://stackoverflow.com/questions/51398104/how-to-find-token-for-google-sheet-api-v4", "title": "How to find token for Google sheet API v4", "body": "<p>I am using ruby to read google sheet by using steps given here:\n<a href=\"https://developers.google.com/sheets/api/quickstart/ruby\" rel=\"nofollow noreferrer\">\nRuby Quickstart</a></p>\n\n<p>Anyone, please let me know the structure of <code>token.yml</code> or where to find this file.</p>\n"}, {"tags": ["ruby", "hash"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1531906162, "post_id": 51398099, "comment_id": 89767732, "body": "The issue is entirely not clear. You haven&#39;t explained at all why you only want to keep the last one among <code>{&quot;started_at&quot;=&gt;&quot;2018-07-16&quot;, &quot;stopped_at&quot;=&gt;&quot;2018-07-16&quot;},  {&quot;started_at&quot;=&gt;&quot;2018-07-16&quot;, &quot;stopped_at&quot;=&gt;&quot;still active&quot;}</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1531937121, "post_id": 51398099, "comment_id": 89788026, "body": "Do you mean that for each group of hashes for which the value of <code>started_at&quot; is the same you wish to keep only the last element? If not, do you wish to keep only the last element of the group when the value of &quot;stopped_at&quot;</code> is the particular string <code>&quot;still active&quot;</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "is_accepted": false, "score": 2, "last_activity_date": 1531906570, "creation_date": 1531906570, "answer_id": 51398589, "question_id": 51398099, "link": "https://stackoverflow.com/questions/51398099/merge-duplicated-values-in-array-of-hashes/51398589#51398589", "title": "Merge duplicated values in array of hashes", "body": "<pre><code>arr_of_hashes.reverse.uniq { |hash| hash[\"started_at\"] }.reverse\n</code></pre>\n\n<p>About <a href=\"https://apidock.com/ruby/Array/uniq#1380-Pass-a-block\" rel=\"nofollow noreferrer\">pass block to <code>uniq</code></a> and about <a href=\"https://apidock.com/ruby/Array/reverse\" rel=\"nofollow noreferrer\"><code>reverse</code></a>.</p>\n\n<pre><code>#result\n[\n  {\"started_at\"=&gt;\"2018-07-11\", \"stopped_at\"=&gt;\"2018-07-11\"},\n  {\"started_at\"=&gt;\"2018-07-13\", \"stopped_at\"=&gt;\"2018-07-13\"},\n  {\"started_at\"=&gt;\"2018-07-16\", \"stopped_at\"=&gt;\"still active\"}\n]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1531906936, "last_edit_date": 1531906936, "creation_date": 1531906630, "answer_id": 51398615, "question_id": 51398099, "link": "https://stackoverflow.com/questions/51398099/merge-duplicated-values-in-array-of-hashes/51398615#51398615", "title": "Merge duplicated values in array of hashes", "body": "<p>Something like this?</p>\n\n<pre><code>[2] pry(main)&gt; arr_of_hashes.reject { |h| h['started_at'] == h['stopped_at'] }\n[\n    [0] {\n        \"started_at\" =&gt; \"2018-07-16\",\n        \"stopped_at\" =&gt; \"still active\"\n    }\n]\n</code></pre>\n\n<p>Its not clear form your question what output you want to get</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1531936649, "creation_date": 1531936649, "answer_id": 51408301, "question_id": 51398099, "link": "https://stackoverflow.com/questions/51398099/merge-duplicated-values-in-array-of-hashes/51408301#51408301", "title": "Merge duplicated values in array of hashes", "body": "<pre><code>arr_of_hashes.each_with_object({}) { |g,h| h.update(g[\"started_at\"]=&gt;g) }.values\n  #=&gt; [{\"started_at\"=&gt;\"2018-07-11\", \"stopped_at\"=&gt;\"2018-07-11\"},\n  #    {\"started_at\"=&gt;\"2018-07-13\", \"stopped_at\"=&gt;\"2018-07-13\"},\n  #    {\"started_at\"=&gt;\"2018-07-16\", \"stopped_at\"=&gt;\"still active\"}]\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.4.0/Hash.html#method-i-update\" rel=\"nofollow noreferrer\">Hash#update</a> (a.k.a. <code>merge!</code>) and note that <code>values</code>'s receiver is as follows.</p>\n\n<pre><code>arr_of_hashes.each_with_object({}) { |g,h| h.update(g[\"started_at\"]=&gt;g) }\n  #=&gt; {\"2018-07-11\"=&gt;{\"started_at\"=&gt;\"2018-07-11\", \"stopped_at\"=&gt;\"2018-07-11\"},\n  #    \"2018-07-13\"=&gt;{\"started_at\"=&gt;\"2018-07-13\", \"stopped_at\"=&gt;\"2018-07-13\"},\n  #    \"2018-07-16\"=&gt;{\"started_at\"=&gt;\"2018-07-16\", \"stopped_at\"=&gt;\"still active\"}}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10098529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c30d2e45eaa8a3982a91e1dd6e5eec57?s=128&d=identicon&r=PG&f=1", "display_name": "pubi", "link": "https://stackoverflow.com/users/10098529/pubi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1531936649, "creation_date": 1531905316, "last_edit_date": 1531907070, "question_id": 51398099, "link": "https://stackoverflow.com/questions/51398099/merge-duplicated-values-in-array-of-hashes", "title": "Merge duplicated values in array of hashes", "body": "<p>I have an array of hashes like this</p>\n\n<pre><code>arr_of_hashes = [\n  {\"started_at\"=&gt;\"2018-07-11\", \"stopped_at\"=&gt;\"2018-07-11\"},\n  {\"started_at\"=&gt;\"2018-07-13\", \"stopped_at\"=&gt;\"2018-07-13\"},\n  {\"started_at\"=&gt;\"2018-07-13\", \"stopped_at\"=&gt;\"2018-07-13\"}, \n  {\"started_at\"=&gt;\"2018-07-16\", \"stopped_at\"=&gt;\"2018-07-16\"},\n  {\"started_at\"=&gt;\"2018-07-16\", \"stopped_at\"=&gt;\"2018-07-16\"},\n  {\"started_at\"=&gt;\"2018-07-16\", \"stopped_at\"=&gt;\"still active\"}\n]\n</code></pre>\n\n<p>I want to remove duplicates. Also, among:</p>\n\n<pre><code>{\"started_at\"=&gt;\"2018-07-16\", \"stopped_at\"=&gt;\"2018-07-16\"},\n{\"started_at\"=&gt;\"2018-07-16\", \"stopped_at\"=&gt;\"still active\"}\n</code></pre>\n\n<p>I want to keep only the last line. How can I do that?</p>\n\n<p>I tried to do:</p>\n\n<pre><code>sorted_arr = arr_of_hashes.uniq\n</code></pre>\n"}, {"tags": ["ruby", "rbenv"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1531903666, "post_id": 51397471, "comment_id": 89766005, "body": "<code>gem install rails</code>?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1531903729, "post_id": 51397471, "comment_id": 89766050, "body": "Rails is a gem. Gems are installed within a ruby version. If you&#39;ve downloaded a brand new ruby version, you won&#39;t have any gems. Rails is not yet installed."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1531904414, "post_id": 51397471, "comment_id": 89766512, "body": "<i>&quot; why is rbenv local not working&quot;</i> -- I don&#39;t know ... Can you give us a hint? Maybe an error message, or a description of the behaviour?"}, {"owner": {"reputation": 859, "user_id": 7227222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ec1eb8473ab73ded224fbbdc2414005?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertMunichMar", "link": "https://stackoverflow.com/users/7227222/albertmunichmar"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1531904955, "post_id": 51397471, "comment_id": 89766907, "body": "gem install rails was the answer. 2 question, I run the command rbenv local in the folder, and nothing happens:   ~/Local_Documents/CodingArea/personal_projects/zaina-project&zwnj;&#8203;/zaina_deal_room/zai&zwnj;&#8203;na-dealroom \ue0b0 \ue0a0 setup \ue0b0 ruby -v ruby 2.3.5p376 (2017-09-14 revision 59905) [x86_64-darwin16]  ~/Local_Documents/CodingArea/personal_projects/zaina-project&zwnj;&#8203;/zaina_deal_room/zai&zwnj;&#8203;na-dealroom \ue0b0 \ue0a0 setup \ue0b0 rbenv local 2.4.4  ~/Local_Documents/CodingArea/personal_projects/zaina-project&zwnj;&#8203;/zaina_deal_room/zai&zwnj;&#8203;na-dealroom \ue0b0 \ue0a0 setup \ue0b0 ruby -v ruby 2.3.5p376 (2017-09-14 revision 59905) [x86_64-darwin16]"}], "answers": [{"comments": [{"owner": {"reputation": 859, "user_id": 7227222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ec1eb8473ab73ded224fbbdc2414005?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertMunichMar", "link": "https://stackoverflow.com/users/7227222/albertmunichmar"}, "edited": false, "score": 0, "creation_date": 1531907270, "post_id": 51398304, "comment_id": 89768500, "body": "I read the other question. in my .zshrc i have: export RBENV_VERSION=2.3.5, that&#39;s why rbenv local does not work. is it wrong to have the ruby version in the ENV variables? i also have:export RBENV_VERSION=2.3.5 # use rbenv rehash export ALBERT=8 export PATH=&quot;$HOME/.rbenv/bin:$PATH:./node_modules/.bin&quot;"}, {"owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "reply_to_user": {"reputation": 859, "user_id": 7227222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ec1eb8473ab73ded224fbbdc2414005?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertMunichMar", "link": "https://stackoverflow.com/users/7227222/albertmunichmar"}, "edited": false, "score": 1, "creation_date": 1531907945, "post_id": 51398304, "comment_id": 89768958, "body": "<code>is it wrong to have the ruby version in the ENV variables?</code> No, env variable easy change. So, that is not a problem."}], "tags": [], "owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "is_accepted": true, "score": 1, "last_activity_date": 1531905887, "last_edit_date": 1592644375, "creation_date": 1531905887, "answer_id": 51398304, "question_id": 51397471, "link": "https://stackoverflow.com/questions/51397471/new-version-of-rails-installed-rails-command-not-recognized/51398304#51398304", "title": "new version of rails installed, rails command not recognized", "body": "<blockquote>\n<p>At a high level, rbenv intercepts Ruby commands using shim executables injected into your PATH, determines which Ruby version has been specified by your application, and passes your commands along to the correct Ruby installation.</p>\n<p>When you run a command like ruby or rake, your operating system searches through a list of directories to find an executable file with that name. This list of directories lives in an environment variable called PATH, with each directory in the list separated by a colon: <code>/usr/local/bin:/usr/bin:/bin</code></p>\n<p>Once rbenv has determined which version of Ruby your application has specified, it passes the command along to the corresponding Ruby installation.</p>\n<p>Each Ruby version is installed into its own directory under ~/.rbenv/versions. For example, you might have these versions installed: <code>~/.rbenv/versions/1.8.7-p371/</code></p>\n</blockquote>\n<p>So, for each ruby version you must install two gems:</p>\n<pre><code>gem install bundler\ngem install rails\n</code></pre>\n<p>About how to fix <code>rbenv</code> you can read in <a href=\"https://stackoverflow.com/questions/10940736/rbenv-not-changing-ruby-version\">this question</a>.</p>\n"}], "owner": {"reputation": 859, "user_id": 7227222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ec1eb8473ab73ded224fbbdc2414005?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertMunichMar", "link": "https://stackoverflow.com/users/7227222/albertmunichmar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1783, "favorite_count": 0, "accepted_answer_id": 51398304, "answer_count": 1, "score": 0, "last_activity_date": 1531907487, "creation_date": 1531903580, "last_edit_date": 1531907487, "question_id": 51397471, "link": "https://stackoverflow.com/questions/51397471/new-version-of-rails-installed-rails-command-not-recognized", "title": "new version of rails installed, rails command not recognized", "body": "<p>I want to do a new rails app. I installed ruby 2.4.4 because I cloned a project.</p>\n\n<p>I used to set the new version for the project</p>\n\n<pre><code>rbenv shell 2.4.4\n</code></pre>\n\n<p>because rbenv local was not working</p>\n\n<p>Now that I am using ruby 2.4.4</p>\n\n<pre><code>  system\n  2.3.4\n  2.3.5\n* 2.4.4 (set by RBENV_VERSION environment variable)\n</code></pre>\n\n<p>I get following error message:</p>\n\n<pre><code>rbenv: rails: command not found\n\nThe `rails' command exists in these Ruby versions:\n  2.3.4\n  2.3.5\n</code></pre>\n\n<p>1) how can I fix this?\n2) why is rbenv local not working?</p>\n\n<p>What happens when running rbenv local 2.4.4</p>\n\n<pre><code> ~/Local_Documents/CodingArea/personal_projects/zaina-project/zaina_deal_room/zaina-dealroom \ue0b0 \ue0a0 setup \ue0b0 ruby -v\nruby 2.3.5p376 (2017-09-14 revision 59905) [x86_64-darwin16]\n ~/Local_Documents/CodingArea/personal_projects/zaina-project/zaina_deal_room/zaina-dealroom \ue0b0 \ue0a0 setup \ue0b0 rbenv local 2.4.4\n ~/Local_Documents/CodingArea/personal_projects/zaina-project/zaina_deal_room/zaina-dealroom \ue0b0 \ue0a0 setup \ue0b0 ruby -v\nruby 2.3.5p376 (2017-09-14 revision 59905) [x86_64-darwin16]\n</code></pre>\n\n<p>basically it happens nothing. Ruby version 2.3.5 is still selected. I expect to see version 2.4.4 as selected, after running rbenv local 2.4.4. I guess it's something with my ENV, that the version that I have written in a file, takes preferences, but I don't know how to fix this.</p>\n\n<p>in my .zshrc I have:</p>\n\n<pre><code>export RBENV_VERSION=2.3.5 # use rbenv rehash\nexport ALBERT=8\nexport PATH=\"$HOME/.rbenv/bin:$PATH:./node_modules/.bin\"\n</code></pre>\n\n<p>Is it wrong to have the ruby version there? is my PATH correct?\nSo, rbenv local 2.4.4 will never be applied because of export RBENV_VERSION right?</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1531900040, "post_id": 51396356, "comment_id": 89763783, "body": "Because <code>\\d{1,4}?</code> matches them and <code>\\d{1,4}[A-z]{1}</code> does not even have a chance to step in. Besides, <code>[A-z]</code> is a typo, it should be <code>[A-Za-z]</code>. It seems you want <a href=\"https://regex101.com/r/tdzSc5/1\" rel=\"nofollow noreferrer\"><code>\\d{1,4}[A-Za-z]|\\&#47;?\\d{1,4}</code></a>. Well, if it should be at the start of a line, <a href=\"https://regex101.com/r/tdzSc5/2\" rel=\"nofollow noreferrer\"><code>^(?:\\d{1,4}[A-Za-z]|\\&#47;?\\d{1,4})</code></a>."}], "answers": [{"comments": [{"owner": {"reputation": 386, "user_id": 7141412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ff78855b8cb85ac032aca87155063a5?s=128&d=identicon&r=PG&f=1", "display_name": "MysteriousNothing", "link": "https://stackoverflow.com/users/7141412/mysteriousnothing"}, "edited": false, "score": 0, "creation_date": 1531901307, "post_id": 51396477, "comment_id": 89764492, "body": "I have so much to learn, helpful articles for beginner like me, really thank you taking your time!"}, {"owner": {"reputation": 142455, "user_id": 5133585, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/dfqcw.png?s=128&g=1", "display_name": "Sweeper", "link": "https://stackoverflow.com/users/5133585/sweeper"}, "reply_to_user": {"reputation": 386, "user_id": 7141412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ff78855b8cb85ac032aca87155063a5?s=128&d=identicon&r=PG&f=1", "display_name": "MysteriousNothing", "link": "https://stackoverflow.com/users/7141412/mysteriousnothing"}, "edited": false, "score": 0, "creation_date": 1531901548, "post_id": 51396477, "comment_id": 89764648, "body": "@MysteriousNothing If you think the answers answer your question, please consider selecting the answer that you think is the best and accept it by clicking on that checkmark!"}, {"owner": {"reputation": 386, "user_id": 7141412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ff78855b8cb85ac032aca87155063a5?s=128&d=identicon&r=PG&f=1", "display_name": "MysteriousNothing", "link": "https://stackoverflow.com/users/7141412/mysteriousnothing"}, "edited": false, "score": 0, "creation_date": 1531902284, "post_id": 51396477, "comment_id": 89765076, "body": "both answers was helpful and tips and had useful tips so I select who posted first. I hope no hard feelings. :)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1531938037, "post_id": 51396477, "comment_id": 89788485, "body": "Mysterious, I have no comment on your selection for awarding the greenie, but I see no reason that an answer&#39;s timestamp should have anything to do with it. If you were asked which of two pizzas you preferred would the tie-breaker be the one you ate first?"}], "tags": [], "owner": {"reputation": 142455, "user_id": 5133585, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/dfqcw.png?s=128&g=1", "display_name": "Sweeper", "link": "https://stackoverflow.com/users/5133585/sweeper"}, "is_accepted": false, "score": 1, "last_activity_date": 1531900766, "last_edit_date": 1531900766, "creation_date": 1531900390, "answer_id": 51396477, "question_id": 51396356, "link": "https://stackoverflow.com/questions/51396356/why-does-this-regex-not-match-numbers-and-single-letters/51396477#51396477", "title": "Why does this regex not match numbers and single letters?", "body": "<p>Your regex uses lazy quantifiers like <code>{1,4}?</code>. These will match one character, and stop, because the rest of the pattern (i.e. nothing) matches the rest of the string. See <a href=\"https://stackoverflow.com/questions/2301285/what-do-lazy-and-greedy-mean-in-the-context-of-regular-expressions\">here</a> for how greedy vs lazy quantifiers work.</p>\n\n<p>Another reason is that you put the <code>\\d{1,4}[A-z]{1}</code> case <em>last</em>. This case will only be tried if the first two cases don't match. With <code>3a</code>, the <code>3</code> already matches the second case, so the last case won't be considered.</p>\n\n<p>You seem to just want:</p>\n\n<pre><code>^(\\d{1,4}[A-Za-z]|\\/?\\d{1,4})\n</code></pre>\n\n<p>Note how the <code>\\/\\d{1,4}</code> case and the <code>\\d{1,4}</code> case in your original regex are combined into one case <code>\\/?\\d{1,4}</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 386, "user_id": 7141412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ff78855b8cb85ac032aca87155063a5?s=128&d=identicon&r=PG&f=1", "display_name": "MysteriousNothing", "link": "https://stackoverflow.com/users/7141412/mysteriousnothing"}, "edited": false, "score": 0, "creation_date": 1531901461, "post_id": 51396487, "comment_id": 89764579, "body": "Actually A-z is from one street address regex from stack overflow some user example. I do not have time to search it again but, thank you for your time and useful links!"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 386, "user_id": 7141412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ff78855b8cb85ac032aca87155063a5?s=128&d=identicon&r=PG&f=1", "display_name": "MysteriousNothing", "link": "https://stackoverflow.com/users/7141412/mysteriousnothing"}, "edited": false, "score": 0, "creation_date": 1531901600, "post_id": 51396487, "comment_id": 89764676, "body": "@MysteriousNothing That is a very common typo, it is even present in some regex tutorials online. There is only one environment, where <code>[A-z]</code> will work as expected, but it is certainly not Ruby."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 386, "user_id": 7141412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ff78855b8cb85ac032aca87155063a5?s=128&d=identicon&r=PG&f=1", "display_name": "MysteriousNothing", "link": "https://stackoverflow.com/users/7141412/mysteriousnothing"}, "edited": false, "score": 0, "creation_date": 1531903386, "post_id": 51396487, "comment_id": 89765791, "body": "@MysteriousNothing Lots of code contains mistakes. Just because you found the code somewhere on the internet, that doesn&#39;t make it right ;)"}, {"owner": {"reputation": 386, "user_id": 7141412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ff78855b8cb85ac032aca87155063a5?s=128&d=identicon&r=PG&f=1", "display_name": "MysteriousNothing", "link": "https://stackoverflow.com/users/7141412/mysteriousnothing"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1531904224, "post_id": 51396487, "comment_id": 89766393, "body": "@TomLord But, but, it was on stack overflow and up voted :D [A-z] part was on there, other is my own stupidity."}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 386, "user_id": 7141412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ff78855b8cb85ac032aca87155063a5?s=128&d=identicon&r=PG&f=1", "display_name": "MysteriousNothing", "link": "https://stackoverflow.com/users/7141412/mysteriousnothing"}, "edited": false, "score": 0, "creation_date": 1531904947, "post_id": 51396487, "comment_id": 89766895, "body": "@MysteriousNothing You must be talking about <a href=\"https://stackoverflow.com/a/6067606/3832970\">this post</a>. Read the <b>Update</b>. Although rather than writing something below that subtitle the user who posted the answer should have updated the solution at the top."}], "tags": [], "owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 3, "last_activity_date": 1531900893, "last_edit_date": 1531900893, "creation_date": 1531900419, "answer_id": 51396487, "question_id": 51396356, "link": "https://stackoverflow.com/questions/51396356/why-does-this-regex-not-match-numbers-and-single-letters/51396487#51396487", "title": "Why does this regex not match numbers and single letters?", "body": "<p>The digits+letter combination is not matched due to the order of alternatives in your pattern. The <code>\\d{1,4}?</code> matches the digit before the letter, and <code>\\d{1,4}[A-z]{1}</code> does not even have a chance to step in.  See the <a href=\"https://www.regular-expressions.info/alternation.html#eager\" rel=\"nofollow noreferrer\"><strong>Remember That The Regex Engine Is Eager</strong></a> article.</p>\n\n<p>The <code>\\/\\d{1,4}?</code> will match a <code>/</code> and a single digit after the slash, and <code>\\d{1,4}?</code> will always match a single digit, as <code>{min,max}?</code> is a <em>lazy</em> range/interval/limiting quantifier and as such only matches as few chars as possible. See <a href=\"https://www.regular-expressions.info/repeat.html#lazy\" rel=\"nofollow noreferrer\"><strong>Laziness Instead of Greediness</strong></a>.</p>\n\n<p>Besides, <a href=\"https://stackoverflow.com/questions/29771901/why-is-this-regex-allowing-a-caret/29771926#29771926\"><code>[A-z]</code> is a typo</a>, it should be <code>[A-Za-z]</code>. </p>\n\n<p>It seems you want </p>\n\n<pre><code>\\d{1,4}[A-Za-z]|\\/?\\d{1,4}\n</code></pre>\n\n<p>See the <a href=\"https://regex101.com/r/tdzSc5/1\" rel=\"nofollow noreferrer\">regex demo</a>. If it should be at the start of a line, use</p>\n\n<pre><code> ^(?:\\d{1,4}[A-Za-z]|\\/?\\d{1,4})\n</code></pre>\n\n<p>See this <a href=\"https://regex101.com/r/tdzSc5/2\" rel=\"nofollow noreferrer\">regex demo</a>.</p>\n\n<p><strong>Details</strong></p>\n\n<ul>\n<li><code>^</code> - start of a line</li>\n<li><code>(?:</code> - start of a <a href=\"https://stackoverflow.com/questions/3512471/what-is-a-non-capturing-group-what-does-do\">non-capturing group</a>\n\n<ul>\n<li><code>\\d{1,4}[A-Za-z]</code> - 1 to 4 digits and an ASCII letter</li>\n<li><code>|</code> - or</li>\n<li><code>\\/?</code> - an optional <code>/</code></li>\n<li><code>\\d{1,4}</code> - 1 to 4 digits</li>\n</ul></li>\n<li><code>)</code> - end of the group.</li>\n</ul>\n"}], "owner": {"reputation": 386, "user_id": 7141412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ff78855b8cb85ac032aca87155063a5?s=128&d=identicon&r=PG&f=1", "display_name": "MysteriousNothing", "link": "https://stackoverflow.com/users/7141412/mysteriousnothing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 51396487, "answer_count": 2, "score": 1, "last_activity_date": 1531900893, "creation_date": 1531899926, "last_edit_date": 1531900675, "question_id": 51396356, "link": "https://stackoverflow.com/questions/51396356/why-does-this-regex-not-match-numbers-and-single-letters", "title": "Why does this regex not match numbers and single letters?", "body": "<p>Why does this regex not match <code>3a</code>?</p>\n\n<pre><code>(\\/\\d{1,4}?|\\d{1,4}?|\\d{1,4}[A-z]{1})\n</code></pre>\n\n<p>Using <code>\\d{1,4}\\D{1}</code>, the result is the same.</p>\n\n<p>Streets numbers:</p>\n\n<pre><code>/1\n78\n3a\n89/\n-1 (special case)\n1\n</code></pre>\n\n<p><a href=\"https://regex101.com/r/cYCafR/3\" rel=\"nofollow noreferrer\">https://regex101.com/r/cYCafR/3</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "http-post", "rspec-rails"], "comments": [{"owner": {"reputation": 921, "user_id": 3172183, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dscm0.png?s=128&g=1", "display_name": "amrdruid", "link": "https://stackoverflow.com/users/3172183/amrdruid"}, "edited": false, "score": 1, "creation_date": 1531900560, "post_id": 51396194, "comment_id": 89764079, "body": "Is there&#39;s a difference between postman headers and the headers in the test? especially looking for <code>Content-Type</code>"}, {"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1532619773, "post_id": 51396194, "comment_id": 90053180, "body": "Just a thought, because I&#39;ve just had a similar issue. What happens if you do this <code>params: { &quot;vendor_district_ids&quot; =&gt; [] }</code>"}, {"owner": {"reputation": 547, "user_id": 3396971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52c75295766cfc6c5950bb398fa6c7e2?s=128&d=identicon&r=PG", "display_name": "NemyaNation", "link": "https://stackoverflow.com/users/3396971/nemyanation"}, "edited": false, "score": 0, "creation_date": 1600522779, "post_id": 51396194, "comment_id": 113117872, "body": "Have a look at my answer, I think I have concluded the reason as to why we recieve this inconsistency between Postman and RSPEC, as well as a solution to avoid modifying your controllers to account for empty arrays."}], "answers": [{"tags": [], "owner": {"reputation": 854, "user_id": 1102235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96cb59904850fedeb05820541281e3a3?s=128&d=identicon&r=PG", "display_name": "Maciej Majewski", "link": "https://stackoverflow.com/users/1102235/maciej-majewski"}, "is_accepted": false, "score": 1, "last_activity_date": 1538585654, "creation_date": 1538585654, "answer_id": 52632058, "question_id": 51396194, "link": "https://stackoverflow.com/questions/51396194/rspec-request-spec-post-an-empty-array/52632058#52632058", "title": "RSpec request spec post an empty array", "body": "<p>That is actually caused by <code>rack-test &gt;= 0.7.0</code> [1].</p>\n\n<p>It converts empty arrays to <code>param[]=</code> which is later decoded as <code>['']</code>.</p>\n\n<p>If you try running the same code with e.g. <code>rack-test 0.6.3</code> you will see that <code>vendor_district_ids</code> isn't added to the query at all:</p>\n\n<pre><code># rack-test 0.6.3\nRack::Test::Utils.build_nested_query('a' =&gt; [])\n# =&gt; \"\"\n\n# rack-test &gt;= 0.7.0\nRack::Test::Utils.build_nested_query('a' =&gt; [])\n# =&gt; \"a[]=\"\n\nRack::Utils.parse_nested_query('a[]=')\n# =&gt; {\"a\"=&gt;[\"\"]}\n</code></pre>\n\n<p>[1] <a href=\"https://github.com/rack-test/rack-test/commit/ece681de8ffee9d0caff30e9b93f882cc58f14cb\" rel=\"nofollow noreferrer\">https://github.com/rack-test/rack-test/commit/ece681de8ffee9d0caff30e9b93f882cc58f14cb</a></p>\n"}, {"comments": [{"owner": {"reputation": 142, "user_id": 2581066, "user_type": "registered", "profile_image": "https://graph.facebook.com/539582764/picture?type=large", "display_name": "Ahmed Ghoneim", "link": "https://stackoverflow.com/users/2581066/ahmed-ghoneim"}, "edited": false, "score": 1, "creation_date": 1614181175, "post_id": 63969439, "comment_id": 117308292, "body": "Thanks for saving me hours of hair-pulling."}], "tags": [], "owner": {"reputation": 547, "user_id": 3396971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52c75295766cfc6c5950bb398fa6c7e2?s=128&d=identicon&r=PG", "display_name": "NemyaNation", "link": "https://stackoverflow.com/users/3396971/nemyanation"}, "is_accepted": false, "score": 2, "last_activity_date": 1600522694, "creation_date": 1600522694, "answer_id": 63969439, "question_id": 51396194, "link": "https://stackoverflow.com/questions/51396194/rspec-request-spec-post-an-empty-array/63969439#63969439", "title": "RSpec request spec post an empty array", "body": "<p>Found the answer!</p>\n<h3>Problem</h3>\n<p>The problem is found inside Rack's <code>query_parser</code> not actually inside rack-test as the previous answer indicates.</p>\n<p>The actual translation of <code>&quot;paramName[]=&quot;</code> into <code>{&quot;paramName&quot;:[&quot;&quot;]}</code> happens in Rack's <a href=\"https://github.com/rack/rack/blob/8f71f53c3140cee2070188d839561715d8f3b064/lib/rack/query_parser.rb#L64\" rel=\"nofollow noreferrer\">query_parser</a>.</p>\n<p>An example of the problem:</p>\n<pre class=\"lang-rb prettyprint-override\"><code>post '/posts', { ids: [] }\n{&quot;ids&quot;=&gt;[&quot;&quot;]} # By default, Rack::Test will use HTTP form encoding, as per docs: https://github.com/rack/rack-test/blob/master/README.md#examples\n</code></pre>\n<h3>Solution</h3>\n<p>Convert your params into JSON, by requiring the JSON gem into your application using <code>'require 'json'</code> and appending your param hash with <code>.to_json</code>.</p>\n<p>And specifying in your RSPEC request that the content-type of this request is JSON.</p>\n<p>An example by modifying the example above:</p>\n<pre class=\"lang-rb prettyprint-override\"><code>post '/posts', { ids: [] }.to_json, { &quot;CONTENT_TYPE&quot; =&gt; &quot;application/json&quot; }\n{&quot;ids&quot;=&gt;[]} # explicitly sending JSON will work nicely\n</code></pre>\n"}], "owner": {"reputation": 6256, "user_id": 2331735, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/SC0hO.jpg?s=128&g=1", "display_name": "DenniJensen", "link": "https://stackoverflow.com/users/2331735/dennijensen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2042, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1600522694, "creation_date": 1531899381, "question_id": 51396194, "link": "https://stackoverflow.com/questions/51396194/rspec-request-spec-post-an-empty-array", "title": "RSpec request spec post an empty array", "body": "<p>I am current developing an API endpoint in rails. I want to be sure the endpoint response with the correct error status if the data I need is invalid. I need an array of ids. One of the invalid values is an empty array.</p>\n\n<h3>Valid</h3>\n\n<pre><code>{ vendor_district_ids: [2, 4, 5, 6]}\n</code></pre>\n\n<h3>Invalid</h3>\n\n<pre><code>{ vendor_district_ids: []}\n</code></pre>\n\n<h3>Request Spec with RSpec</h3>\n\n<p>So I want to have a request spec to control my behaviour.</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>require 'rails_helper'\n\nRSpec.describe Api::PossibleAppointmentCountsController, type: :request do\n  let(:api_auth_headers) do\n    { 'Authorization' =&gt; 'Bearer this_is_a_test' }\n  end\n\n  describe 'POST /api/possible_appointments/counts' do\n    subject(:post_request) do\n      post api_my_controller_path,\n        params: { vendor_district_ids: [] },\n        headers: api_auth_headers\n    end\n\n    before { post_request }\n\n    it { expect(response.status).to eq 400 }\n  end\nend\n</code></pre>\n\n<p>As you can see I use an empty array in my param inside the <code>subject</code> block.</p>\n\n<h3>Value inside the controller</h3>\n\n<p>In my controller I am fetching the data with</p>\n\n<pre><code>params.require(:vendor_district_ids)\n</code></pre>\n\n<p>and the value is the following</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>&lt;ActionController::Parameters {\"vendor_district_ids\"=&gt;[\"\"], \"controller\"=&gt;\"api/my_controller\", \"action\"=&gt;\"create\"} permitted: false&gt;\n</code></pre>\n\n<p>The value of <code>vendor_district_ids</code> is an array with an empty string. I do not have the same value when I make a post with <code>postman</code>. </p>\n\n<h3>Value with postman</h3>\n\n<p>If I post</p>\n\n<pre><code>{ \"vendor_district_ids\": [] }\n</code></pre>\n\n<p>the controller will receive</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>&lt;ActionController::Parameters {\"vendor_district_ids\"=&gt;[], \"controller\"=&gt;\"api/my_controller\", \"action\"=&gt;\"create\"} permitted: false&gt;\n</code></pre>\n\n<p>And here is the array empty. </p>\n\n<h3>Question</h3>\n\n<p>Am I doing something wrong inside the request spec or is this a bug from <code>RSpec</code>?</p>\n"}, {"tags": ["ruby", "local-variables"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 2, "creation_date": 1531898399, "post_id": 51395843, "comment_id": 89762817, "body": "Where did you define <code>sum</code> to be used in your method <code>addArray</code>?"}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 1, "creation_date": 1531900010, "post_id": 51395843, "comment_id": 89763766, "body": "On another note, the <code>for x in something do</code> syntax of enumerating in Ruby is not really the convention, and even according to the language developers, only still present in the language for legacy reasons. <code>array.each</code> would be the &quot;standard way&quot; to do it.  Also note that the <code>for</code> syntax handles the scope differently than a normal block."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1531908261, "post_id": 51395843, "comment_id": 89769158, "body": "You ask &quot;What&#39;s wrong with this thought process?&quot; That&#39;s not how <a href=\"https://stackoverflow.com\">Stack Overflow</a> works. <i>You</i> need to tell us what&#39;s wrong, then we can help you fix it. Do you get an error message? If yes, what does it say, and what line does it occur on? Is the result you are getting not the result you are expecting? If yes, what result do you expect and why, what result do you get and why is that result not the correct one? Is the behavior you are observing not the behavior you are expecting? If yes, what behavior do you expect and why, what behavior do you observe instead and why is that behavior not the correct one?"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 8260701, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/09Fbs.png?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/8260701/rob"}, "edited": false, "score": 0, "creation_date": 1531946852, "post_id": 51395946, "comment_id": 89792925, "body": "ah.  thank you.  I thought I was defining it with the &#39;+=&#39;.  Thanks dude"}], "tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": false, "score": 2, "last_activity_date": 1531898631, "creation_date": 1531898631, "answer_id": 51395946, "question_id": 51395843, "link": "https://stackoverflow.com/questions/51395843/for-loop-summation-in-ruby/51395946#51395946", "title": "&#39;for&#39; loop summation in ruby", "body": "<p>Your problem is that you don't have variable <code>sum</code> defined. In order to continue with the approach you've chosen, define the variable and return it after summation:</p>\n\n<pre><code>def add_array(array)\n  sum = 0\n  for i in array do\n    sum += i\n  end\n  sum\nend\n\nputs add_array([1,3,6,8,7,10])\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1532131307, "post_id": 51399052, "comment_id": 89873567, "body": "The <code>sum</code>method  is in Ruby (non Rails) since 2.4 ."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1532335483, "post_id": 51399052, "comment_id": 89917779, "body": "Thanks @steenslag - have updated to reflect this. Did check as I thought it had been introduced, though must have looked at the wrong docs :)"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1532683649, "post_id": 51399052, "comment_id": 90076632, "body": "@rob - what did you go with in the end? Did this help at all?"}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": false, "score": 0, "last_activity_date": 1532335434, "last_edit_date": 1532335434, "creation_date": 1531907890, "answer_id": 51399052, "question_id": 51395843, "link": "https://stackoverflow.com/questions/51395843/for-loop-summation-in-ruby/51399052#51399052", "title": "&#39;for&#39; loop summation in ruby", "body": "<p>As others have mentioned, you haven't defined the <code>sum</code> variable.</p>\n\n<p>However, I feel it worth pointing out there's an existing Ruby method that handles this perfectly:</p>\n\n<pre><code>[1,3,6,8,7,10].reduce(:+) # =&gt; 35\n</code></pre>\n\n<p>For Ruby 2.4 onwards (or Rails), it's even easier:</p>\n\n<pre><code>[1,3,6,8,7,10].sum # =&gt; 35\n</code></pre>\n\n<p><a href=\"https://ruby-doc.org/core-2.1.0/Enumerable.html#method-i-reduce\" rel=\"nofollow noreferrer\"><code>reduce</code></a> is a method used to iterate through values with an accumulator present. The above is shorthand for the following:</p>\n\n<pre><code>#\u00a0`accumulator` is the equivalent of your `sum`, `element` your `i`\n[1,3,6,8,7,10].reduce(0) do |accumulator, element|\n  accumulator + element\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 4309737, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-k_C6osX-7Bg/AAAAAAAAAAI/AAAAAAAAAfc/b_LdzDRIS2E/photo.jpg?sz=128", "display_name": "veloper in big Enmanuel Medina", "link": "https://stackoverflow.com/users/4309737/veloper-in-big-enmanuel-medina"}, "is_accepted": false, "score": 0, "last_activity_date": 1532100091, "creation_date": 1532100091, "answer_id": 51445751, "question_id": 51395843, "link": "https://stackoverflow.com/questions/51395843/for-loop-summation-in-ruby/51445751#51445751", "title": "&#39;for&#39; loop summation in ruby", "body": "<pre><code>def addArray(array)\n  array.sum\nend\n</code></pre>\n\n<p>I think this is the simplest answer.</p>\n"}], "owner": {"reputation": 63, "user_id": 8260701, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/09Fbs.png?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/8260701/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1520, "favorite_count": 0, "answer_count": 3, "score": -3, "last_activity_date": 1532335434, "creation_date": 1531898306, "last_edit_date": 1531899227, "question_id": 51395843, "link": "https://stackoverflow.com/questions/51395843/for-loop-summation-in-ruby", "title": "&#39;for&#39; loop summation in ruby", "body": "<p>I am trying to sum array values. Here's my code:</p>\n\n<pre><code>def addArray(array)\n  for i in array do\n    sum += i\n  end\nend\n\naddArray([1,3,6,8,7,10]);\n</code></pre>\n\n<p>What's wrong with this thought process?\nI know there are other ways to do this such as using <code>reduce</code> or even <code>sum</code>, but am I not just adding the next value to <code>sum</code> every iteration?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 0, "creation_date": 1531898357, "post_id": 51395727, "comment_id": 89762788, "body": "can you try splitting the validation like <code>validates_presence_of :tel_number, :message =&gt; &quot;can&#39;t be blank&quot; validates_numericality_of :tel_number :message =&gt; &#39;must be numeric&#39;</code> and see if it helps"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "reply_to_user": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 0, "creation_date": 1531899100, "post_id": 51395727, "comment_id": 89763240, "body": "@Subash check my answer. I am not sure above change would fix the issue. It will still check for numericality even if the <code>tel_number</code> is <code>nil</code>. :)"}], "answers": [{"tags": [], "owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1531898195, "creation_date": 1531898195, "answer_id": 51395802, "question_id": 51395727, "link": "https://stackoverflow.com/questions/51395727/set-correct-error-message-validate-in-ruby-on-rails/51395802#51395802", "title": "set correct error message validate in ruby on rails", "body": "<p>You can use option <a href=\"http://guides.rubyonrails.org/active_record_validations.html#allow-blank\" rel=\"nofollow noreferrer\"><code>allow_blank: true</code></a> on each validator if don't want them to validate your input when you didn't enter anything.</p>\n\n<pre><code>validates :tel,\n          presence: { message: 'is required' },\n          length: { minimum: 10,  maximum: 11, message: 'wrong length tel number. must between 11-11 character', allow_blank: true },\n          numericality: { message: 'just insert numeric', allow_blank: true }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": false, "score": 0, "last_activity_date": 1531898352, "creation_date": 1531898352, "answer_id": 51395860, "question_id": 51395727, "link": "https://stackoverflow.com/questions/51395727/set-correct-error-message-validate-in-ruby-on-rails/51395860#51395860", "title": "set correct error message validate in ruby on rails", "body": "<p>The problem is that <code>Rails</code> runs all the validation defined.\nIn order to achieve the desired result, you can either display the first message:</p>\n\n<pre><code>&lt;dl class=\"cf\"&gt;\n    &lt;dt class=\"required\"&gt;tel number&lt;/dt&gt;\n    &lt;dd&gt;&lt;%= f.text_field(:tel, {:class =&gt; 'input_text tel'}) %&gt;\n         &lt;% if @user.errors.include?(:tel) %&gt;\n            &lt;div class=\"err\"&gt;&lt;p&gt;&lt;%= @ultratech.errors[:tel].first %&gt;&lt;/p&gt;&lt;/div&gt;\n        &lt;% end %&gt;\n    &lt;/dd&gt;\n&lt;/dl&gt;\n</code></pre>\n\n<p>Or display them all, something like:</p>\n\n<pre><code>&lt;dl class=\"cf\"&gt;\n    &lt;dt class=\"required\"&gt;tel number&lt;/dt&gt;\n    &lt;dd&gt;&lt;%= f.text_field(:tel, {:class =&gt; 'input_text tel'}) %&gt;\n         &lt;% if @user.errors.include?(:tel) %&gt;\n            &lt;% @ultratech.errors[:tel].each do |error| %&gt;\n              &lt;div class=\"err\"&gt;&lt;p&gt;&lt;%= error %&gt;&lt;/p&gt;&lt;/div&gt;\n            &lt;% end %&gt;\n        &lt;% end %&gt;\n    &lt;/dd&gt;\n&lt;/dl&gt;\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 3702199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbf06ca844c89bada71ac9d092026a9?s=128&d=identicon&r=PG&f=1", "display_name": "Ferdinand", "link": "https://stackoverflow.com/users/3702199/ferdinand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1531899644, "creation_date": 1531897997, "last_edit_date": 1531899644, "question_id": 51395727, "link": "https://stackoverflow.com/questions/51395727/set-correct-error-message-validate-in-ruby-on-rails", "title": "set correct error message validate in ruby on rails", "body": "<p>i confuse to set a correct validate error message.. </p>\n\n<p>in model i set validate code like this</p>\n\n<pre><code>validates :tel, presence: { message: 'is required'}, length: { minimum: 10,  maximum: 11, message: 'wrong length tel number. must between 11-11 character' }, numericality: { message: 'just insert numeric'}\n</code></pre>\n\n<p>and in view page i set the code like this</p>\n\n<pre><code>&lt;dl class=\"cf\"&gt;\n    &lt;dt class=\"required\"&gt;tel number&lt;/dt&gt;\n    &lt;dd&gt;&lt;%= f.text_field(:tel, {:class =&gt; 'input_text tel'}) %&gt;\n         &lt;% if @user.errors.include?(:tel) %&gt;\n            &lt;div class=\"err\"&gt;&lt;p&gt;&lt;%= @user.errors[:tel] %&gt;&lt;/p&gt;&lt;/div&gt;\n        &lt;% end %&gt;\n    &lt;/dd&gt;\n&lt;/dl&gt;\n</code></pre>\n\n<p>but the result like this\n<a href=\"https://i.stack.imgur.com/mYe9H.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mYe9H.png\" alt=\"enter image description here\"></a></p>\n\n<p>i dont want to display all the error message. what should i do if i want the error message display like this base on the error</p>\n\n<p><a href=\"https://i.stack.imgur.com/nXVtM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nXVtM.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "associations", "relationship"], "comments": [{"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 1, "creation_date": 1531897703, "post_id": 51395392, "comment_id": 89762365, "body": "add an association <code>has_many :users, through: :teams</code> in <code>Project</code> and then use <code>@project.users</code>"}, {"owner": {"reputation": 470, "user_id": 9606113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1e08f711c246aef8f24cf90bf273546?s=128&d=identicon&r=PG&f=1", "display_name": "ActiveModel_Dirty", "link": "https://stackoverflow.com/users/9606113/activemodel-dirty"}, "reply_to_user": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1531897886, "post_id": 51395392, "comment_id": 89762491, "body": "@kiddorails is correct, as is Subash, but the answer here is better because it does not break the law of demeter: <a href=\"http://rubyblog.pro/2016/09/rails-demeters-law-and-delegate\" rel=\"nofollow noreferrer\">rubyblog.pro/2016/09/rails-demeters-law-and-delegate</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "is_accepted": false, "score": 0, "last_activity_date": 1531897297, "creation_date": 1531897297, "answer_id": 51395525, "question_id": 51395392, "link": "https://stackoverflow.com/questions/51395392/show-and-count-association-of-association/51395525#51395525", "title": "Show and count association of association", "body": "<p>When you do <code>@project.teams</code> it will return you an array as a list of teams because a project has many teams so to find out the number of users for the first team in that project you can do</p>\n\n<pre><code>@project.teams.first.users.count\n</code></pre>\n\n<p>or you need to find the team you want and then do <code>.users.count</code> on that</p>\n"}, {"tags": [], "owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "is_accepted": true, "score": 0, "last_activity_date": 1531897854, "creation_date": 1531897854, "answer_id": 51395690, "question_id": 51395392, "link": "https://stackoverflow.com/questions/51395392/show-and-count-association-of-association/51395690#51395690", "title": "Show and count association of association", "body": "<p>Since, it is <strong>not</strong> clear what you want exactly, this is my <em>best guess</em> at the answer.</p>\n\n<p>You can add a new <a href=\"http://guides.rubyonrails.org/association_basics.html#the-has-many-through-association\" rel=\"nofollow noreferrer\"><code>has_many :through</code></a> association to model <code>Project</code> to get the count of all the users in a project.</p>\n\n<pre><code>class User\n  belongs_to :team\nend\n\nclass Team\n  belongs_to :project\n  has_many :users\nend\n\nclass Project\n  has_many :teams\n  has_many :users, through: :teams   # &lt;--- New association\nend\n\nproject = Project.find(&lt;project_id&gt;)\n\n# Get the count of all users in a project\nproject.users.count\n\n# Get the count of users in a team\nteam = project.teams.find(&lt;team_id&gt;)   # Or `Team.find(&lt;team_id&gt;)`\nteam.users.count\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7868282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de190b3f2ab090ee0f0c4a5750d96ae6?s=128&d=identicon&r=PG&f=1", "display_name": "EvaB11", "link": "https://stackoverflow.com/users/7868282/evab11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 51395690, "answer_count": 2, "score": -1, "last_activity_date": 1531897854, "creation_date": 1531896813, "last_edit_date": 1531897385, "question_id": 51395392, "link": "https://stackoverflow.com/questions/51395392/show-and-count-association-of-association", "title": "Show and count association of association", "body": "<p>I would like to count the number of users that belong to a team which belongs to a project. The associations are as follows:</p>\n\n<pre><code>user belongs_to :team\nteam has_many :users\nproject has_many :teams\nteam belongs_to :project\n</code></pre>\n\n<p>In the projects/show.html.erb, I am using the following code to count the total number of users belonging to all teams which belong to a project</p>\n\n<pre><code>&lt;h2 class=\"number\"&gt;&lt;%= @project.teams.users.count %&gt;&lt;/h2&gt;\n</code></pre>\n\n<p>The error I am receiving is: <code>undefined method 'users'</code>. I am also using Devise\nIs a method in project_controller.rb required for this to work?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "gemfile", "ruby-on-rails-5.1"], "comments": [{"owner": {"reputation": 7359, "user_id": 599989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d752d2574aeb36bc66471f4d0f8811aa?s=128&d=identicon&r=PG", "display_name": "Bijendra", "link": "https://stackoverflow.com/users/599989/bijendra"}, "edited": false, "score": 0, "creation_date": 1531896149, "post_id": 51394754, "comment_id": 89761456, "body": "You need to follow initial blogs for project deployment on heroku. sqlite is not supported and Postgres should be used. Replace the gem and make the appropriate code changes as required."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6639151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb96c5d4c27eceac071db255e8df1c58?s=128&d=identicon&r=PG&f=1", "display_name": "harisp96", "link": "https://stackoverflow.com/users/6639151/harisp96"}, "is_accepted": false, "score": 0, "last_activity_date": 1531895919, "creation_date": 1531895919, "answer_id": 51395115, "question_id": 51394754, "link": "https://stackoverflow.com/questions/51394754/heroku-failed-to-install-gems-via-bundler-trouble-deploying-to-heroku/51395115#51395115", "title": "Heroku: Failed to install gems via Bundler - Trouble deploying to Heroku", "body": "<p>Heroku cant install sqlite3 gem, so you need to replace it with <code>pg gem</code> in production. Change your Gemfile like so: </p>\n\n<pre><code>group :development, :test do\n gem 'sqlite3'\nend\n\ngroup :production do\n gem 'pg'\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10083061, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ExrbO579dHI/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oLfDFCJSLtj6838oT29djPNcrmrQ/mo/photo.jpg?sz=128", "display_name": "Daniela Sannino", "link": "https://stackoverflow.com/users/10083061/daniela-sannino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 353, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531917338, "creation_date": 1531894469, "question_id": 51394754, "link": "https://stackoverflow.com/questions/51394754/heroku-failed-to-install-gems-via-bundler-trouble-deploying-to-heroku", "title": "Heroku: Failed to install gems via Bundler - Trouble deploying to Heroku", "body": "<p>I've been trying to push my Rails app to Heroku for the last few hours using <code>git push heroku master</code> and have been running into problems. This is the output:</p>\n\n<pre><code>remote: Compressing source files... done.\nremote: Building source:\nremote: \nremote:  !     Warning: Multiple default buildpacks reported the ability \nto handle this app. The first buildpack in the list below will be used.\nremote:             Detected buildpacks: Ruby,Node.js\nremote:             See \nhttps://devcenter.heroku.com/articles/buildpacks#buildpack-detect-order\nremote: -----&gt; Ruby app detected\nremote: -----&gt; Compiling Ruby/Rails\nremote: -----&gt; Using Ruby version: ruby-2.4.4\nremote: -----&gt; Installing dependencies using bundler 1.15.2\nremote:        Running: bundle install --without development:test --path \nvendor/bundle --binstubs vendor/bundle/bin -j4 --deployment\nremote:        Warning: the running version of Bundler (1.15.2) is older \nthan the version that created the lockfile (1.16.3). We suggest you \nupgrade to the latest version of Bundler by running `gem install \nbundler`.\nremote:        Fetching gem metadata from https://rubygems.org/.........\nremote:        Fetching version metadata from https://rubygems.org/..\nremote:        Fetching dependency metadata from https://rubygems.org/.\nremote:        Fetching rake 12.3.1\nremote:        Fetching concurrent-ruby 1.0.5\nremote:        Fetching minitest 5.11.3\nremote:        Installing minitest 5.11.3\nremote:        Installing rake 12.3.1\nremote:        Installing concurrent-ruby 1.0.5\nremote:        Fetching thread_safe 0.3.6\nremote:        Installing thread_safe 0.3.6\nremote:        Fetching builder 3.2.3\nremote:        Installing builder 3.2.3\nremote:        Fetching erubi 1.7.1\nremote:        Fetching mini_portile2 2.3.0\nremote:        Installing erubi 1.7.1\nremote:        Installing mini_portile2 2.3.0\nremote:        Fetching crass 1.0.4\nremote:        Fetching rack 2.0.5\nremote:        Installing crass 1.0.4\nremote:        Fetching nio4r 2.3.1\nremote:        Installing nio4r 2.3.1 with native extensions\nremote:        Installing rack 2.0.5\nremote:        Fetching websocket-extensions 0.1.3\nremote:        Installing websocket-extensions 0.1.3\nremote:        Fetching mini_mime 1.0.0\nremote:        Installing mini_mime 1.0.0\nremote:        Fetching arel 8.0.0\nremote:        Installing arel 8.0.0\nremote:        Fetching execjs 2.7.0\nremote:        Fetching bcrypt 3.1.12\nremote:        Installing execjs 2.7.0\nremote:        Installing bcrypt 3.1.12 with native extensions\nremote:        Fetching rb-fsevent 0.10.3\nremote:        Installing rb-fsevent 0.10.3\nremote:        Fetching ffi 1.9.25\nremote:        Installing ffi 1.9.25 with native extensions\nremote:        Using bundler 1.15.2\nremote:        Fetching chronic 0.10.2\nremote:        Installing chronic 0.10.2\nremote:        Fetching coffee-script-source 1.12.2\nremote:        Installing coffee-script-source 1.12.2\nremote:        Fetching method_source 0.9.0\nremote:        Installing method_source 0.9.0\nremote:        Fetching thor 0.20.0\nremote:        Installing thor 0.20.0\nremote:        Fetching orm_adapter 0.5.0\nremote:        Installing orm_adapter 0.5.0\nremote:        Fetching devise-bootstrapped 0.1.1\nremote:        Installing devise-bootstrapped 0.1.1\nremote:        Fetching multi_json 1.13.1\nremote:        Installing multi_json 1.13.1\nremote:        Fetching puma 3.12.0\nremote:        Installing puma 3.12.0 with native extensions\nremote:        Fetching tilt 2.0.8\nremote:        Installing tilt 2.0.8\nremote:        Fetching sqlite3 1.3.13\nremote:        Installing sqlite3 1.3.13 with native extensions\nremote:        Fetching turbolinks-source 5.1.0\nremote:        Installing turbolinks-source 5.1.0\nremote:        Fetching i18n 1.0.1\nremote:        Installing i18n 1.0.1\nremote:        Fetching tzinfo 1.2.5\nremote:        Installing tzinfo 1.2.5\nremote:        Fetching nokogiri 1.8.4\nremote:        Installing nokogiri 1.8.4 with native extensions\nremote:        Fetching websocket-driver 0.6.5\nremote:        Installing websocket-driver 0.6.5 with native extensions\nremote:        Fetching mail 2.7.0\nremote:        Installing mail 2.7.0\nremote:        Fetching rack-test 1.0.0\nremote:        Installing rack-test 1.0.0\nremote:        Fetching warden 1.2.7\nremote:        Installing warden 1.2.7\nremote:        Fetching sprockets 3.7.2\nremote:        Installing sprockets 3.7.2\nremote:        Fetching autoprefixer-rails 9.0.0\nremote:        Installing autoprefixer-rails 9.0.0\nremote:        Fetching uglifier 4.1.15\nremote:        Installing uglifier 4.1.15\nremote:        Fetching whenever 0.10.0\nremote:        Installing whenever 0.10.0\nremote:        Fetching coffee-script 2.4.1\nremote:        Installing coffee-script 2.4.1\nremote:        Fetching rb-inotify 0.9.10\nremote:        Installing rb-inotify 0.9.10\nremote:        Fetching turbolinks 5.1.1\nremote:        Installing turbolinks 5.1.1\nremote:        Fetching faker 1.9.1\nremote:        Installing faker 1.9.1\nremote:        Fetching activesupport 5.1.6\nremote:        Installing activesupport 5.1.6\nremote:        Gem::Ext::BuildError: ERROR: Failed to build gem native \nextension.\nremote:        \nremote:        current directory:\nremote:       \nremote:        /tmp/build_4bda83927de17e82c06097acea1b6b55/vendor/ruby- \n2.4.4/bin/ruby -r\nremote:        ./siteconf20180718-265-17bd8cb.rb extconf.rb\nremote:        checking for sqlite3.h... no\nremote:        sqlite3.h is missing. Try 'brew install sqlite3',\nremote:        'yum install sqlite-devel' or 'apt-get install \nlibsqlite3-dev'\nremote:        and check your shared library search path (the\nremote:        location where your sqlite3 shared library is located).\nremote:        *** extconf.rb failed ***\nremote:        Could not create Makefile due to some reason, probably \nlack of necessary\nremote:        libraries and/or headers.  Check the mkmf.log file for \nmore details.  You may\nremote:        need configuration options.\nremote:        \nremote:        Provided configuration options:\nremote:         --with-opt-dir\nremote:         --without-opt-dir\nremote:         --with-opt-include\nremote:         --without-opt-include=${opt-dir}/include\nremote:         --with-opt-lib\nremote:         --without-opt-lib=${opt-dir}/lib\nremote:         --with-make-prog\nremote:         --without-make-prog\nremote:         --srcdir=.\nremote:         --curdir\nremote:        -- \nruby=/tmp/build_4bda83927de17e82c06097acea1b6b55/vendor/ruby- \n2.4.4/bin/$(RUBY_BASE_NAME)\nremote:         --with-sqlite3-config\nremote:         --without-sqlite3-config\nremote:         --with-pkg-config\nremote:         --without-pkg-config\nremote:         --with-sqlite3-dir\nremote:         --without-sqlite3-dir\nremote:         --with-sqlite3-include\nremote:         --without-sqlite3-include=${sqlite3-dir}/include\nremote:         --with-sqlite3-lib\nremote:         --without-sqlite3-lib=${sqlite3-dir}/lib\nremote:        \nremote:        To see why this extension failed to compile, please check \nthe mkmf.log which can\nremote:        be found here:\nremote:        \nremote:        \nremote:        \nremote:        extconf failed, exit code 1\nremote:        \nremote:        Gem files will remain installed in\nremote:        \nremote:        for inspection.\nremote:        Results logged to\nremote:        \nremote:        \nremote:        An error occurred while installing sqlite3 (1.3.13), and \nBundler cannot\nremote:        continue.\nremote:        Make sure that `gem install sqlite3 -v '1.3.13'` succeeds \nbefore bundling.\nremote:        \nremote:        In Gemfile:\nremote:          sqlite3\nremote:        Bundler Output: Warning: the running version of Bundler \n(1.15.2) is older than the version that created the lockfile (1.16.3). \nWe suggest you upgrade to the latest version of Bundler by running `gem \ninstall bundler`.\nremote:        Fetching gem metadata from https://rubygems.org/.........\nremote:        Fetching version metadata from https://rubygems.org/..\nremote:        Fetching dependency metadata from https://rubygems.org/.\nremote:        Fetching rake 12.3.1\nremote:        Fetching concurrent-ruby 1.0.5\nremote:        Fetching minitest 5.11.3\nremote:        Installing minitest 5.11.3\nremote:        Installing rake 12.3.1\nremote:        Installing concurrent-ruby 1.0.5\nremote:        Fetching thread_safe 0.3.6\nremote:        Installing thread_safe 0.3.6\nremote:        Fetching builder 3.2.3\nremote:        Installing builder 3.2.3\nremote:        Fetching erubi 1.7.1\nremote:        Fetching mini_portile2 2.3.0\nremote:        Installing erubi 1.7.1\nremote:        Installing mini_portile2 2.3.0\nremote:        Fetching crass 1.0.4\nremote:        Fetching rack 2.0.5\nremote:        Installing crass 1.0.4\nremote:        Fetching nio4r 2.3.1\nremote:        Installing nio4r 2.3.1 with native extensions\nremote:        Installing rack 2.0.5\nremote:        Fetching websocket-extensions 0.1.3\nremote:        Installing websocket-extensions 0.1.3\nremote:        Fetching mini_mime 1.0.0\nremote:        Installing mini_mime 1.0.0\nremote:        Fetching arel 8.0.0\nremote:        Installing arel 8.0.0\nremote:        Fetching execjs 2.7.0\nremote:        Fetching bcrypt 3.1.12\nremote:        Installing execjs 2.7.0\nremote:        Installing bcrypt 3.1.12 with native extensions\nremote:        Fetching rb-fsevent 0.10.3\nremote:        Installing rb-fsevent 0.10.3\nremote:        Fetching ffi 1.9.25\nremote:        Installing ffi 1.9.25 with native extensions\nremote:        Using bundler 1.15.2\nremote:        Fetching chronic 0.10.2\nremote:        Installing chronic 0.10.2\nremote:        Fetching coffee-script-source 1.12.2\nremote:        Installing coffee-script-source 1.12.2\nremote:        Fetching method_source 0.9.0\nremote:        Installing method_source 0.9.0\nremote:        Fetching thor 0.20.0\nremote:        Installing thor 0.20.0\nremote:        Fetching orm_adapter 0.5.0\nremote:        Installing orm_adapter 0.5.0\nremote:        Fetching devise-bootstrapped 0.1.1\nremote:        Installing devise-bootstrapped 0.1.1\nremote:        Fetching multi_json 1.13.1\nremote:        Installing multi_json 1.13.1\nremote:        Fetching puma 3.12.0\nremote:        Installing puma 3.12.0 with native extensions\nremote:        Fetching tilt 2.0.8\nremote:        Installing tilt 2.0.8\nremote:        Fetching sqlite3 1.3.13\nremote:        Installing sqlite3 1.3.13 with native extensions\nremote:        Fetching turbolinks-source 5.1.0\nremote:        Installing turbolinks-source 5.1.0\nremote:        Fetching i18n 1.0.1\nremote:        Installing i18n 1.0.1\nremote:        Fetching tzinfo 1.2.5\nremote:        Installing tzinfo 1.2.5\nremote:        Fetching nokogiri 1.8.4\nremote:        Installing nokogiri 1.8.4 with native extensions\nremote:        Fetching websocket-driver 0.6.5\nremote:        Installing websocket-driver 0.6.5 with native extensions\nremote:        Fetching mail 2.7.0\nremote:        Installing mail 2.7.0\nremote:        Fetching rack-test 1.0.0\nremote:        Installing rack-test 1.0.0\nremote:        Fetching warden 1.2.7\nremote:        Installing warden 1.2.7\nremote:        Fetching sprockets 3.7.2\nremote:        Installing sprockets 3.7.2\nremote:        Fetching autoprefixer-rails 9.0.0\nremote:        Installing autoprefixer-rails 9.0.0\nremote:        Fetching uglifier 4.1.15\nremote:        Installing uglifier 4.1.15\nremote:        Fetching whenever 0.10.0\nremote:        Installing whenever 0.10.0\nremote:        Fetching coffee-script 2.4.1\nremote:        Installing coffee-script 2.4.1\nremote:        Fetching rb-inotify 0.9.10\nremote:        Installing rb-inotify 0.9.10\nremote:        Fetching turbolinks 5.1.1\nremote:        Installing turbolinks 5.1.1\nremote:        Fetching faker 1.9.1\nremote:        Installing faker 1.9.1\nremote:        Fetching activesupport 5.1.6\nremote:        Installing activesupport 5.1.6\nremote:        Gem::Ext::BuildError: ERROR: Failed to build gem native \nextension.\nremote:        \nremote:        current directory:\nremote:        \nremote:        /tmp/build_4bda83927de17e82c06097acea1b6b55/vendor/ruby- \n2.4.4/bin/ruby -r\nremote:        ./siteconf20180718-265-17bd8cb.rb extconf.rb\nremote:        checking for sqlite3.h... no\nremote:        sqlite3.h is missing. Try 'brew install sqlite3',\nremote:        'yum install sqlite-devel' or 'apt-get install \nlibsqlite3-dev'\nremote:        and check your shared library search path (the\nremote:        location where your sqlite3 shared library is located).\nremote:        *** extconf.rb failed ***\nremote:        Could not create Makefile due to some reason, probably \nlack of necessary\nremote:        libraries and/or headers.  Check the mkmf.log file for \nmore details.  You may\nremote:        need configuration options.\nremote:        \nremote:        Provided configuration options:\nremote:         --with-opt-dir\nremote:         --without-opt-dir\nremote:         --with-opt-include\nremote:         --without-opt-include=${opt-dir}/include\nremote:         --with-opt-lib\nremote:         --without-opt-lib=${opt-dir}/lib\nremote:         --with-make-prog\nremote:         --without-make-prog\nremote:         --srcdir=.\nremote:         --curdir\nremote:        --\nremote:         --with-sqlite3-config\nremote:         --without-sqlite3-config\nremote:         --with-pkg-config\nremote:         --without-pkg-config\nremote:         --with-sqlite3-dir\nremote:         --without-sqlite3-dir\nremote:         --with-sqlite3-include\nremote:         --without-sqlite3-include=${sqlite3-dir}/include\nremote:         --with-sqlite3-lib\nremote:         --without-sqlite3-lib=${sqlite3-dir}/lib\nremote:        \nremote:        To see why this extension failed to compile, please check \nthe mkmf.log which can\nremote:        be found here:\nremote:        \nremote:        \nremote:        \nremote:        extconf failed, exit code 1\nremote:        \nremote:        Gem files will remain installed in\nremote:        \nremote:        for inspection.\nremote:        Results logged to\nremote:        \nremote:        \nremote:        An error occurred while installing sqlite3 (1.3.13), and \nBundler cannot\nremote:        continue.\nremote:        Make sure that `gem install sqlite3 -v '1.3.13'` succeeds \nbefore bundling.\nremote:        \nremote:        In Gemfile:\nremote:          sqlite3\nremote: \nremote:  !\nremote:  !     Failed to install gems via Bundler.\nremote:  !     Detected sqlite3 gem which is not supported on Heroku:\nremote:  !     https://devcenter.heroku.com/articles/sqlite3\nremote:  !\nremote:  !     Push rejected, failed to compile Ruby app.\nremote: \nremote:  !     Push failed\nremote: Verifying deploy...\nremote: \nremote: !   Push rejected to glacial-reaches-77008.\nremote: \nTo https://git.heroku.com/glacial-reaches-77008.git\n! [remote rejected] master -&gt; master (pre-receive hook declined)\n</code></pre>\n\n<p>I've tried <code>bundle update</code> and <code>bundle install</code> again and ran <code>git push heroku master</code> but it still didn't do anything.</p>\n\n<p>I also tried delete my Gemfile.lock file, ran <code>bundle update</code> and <code>bundle install</code> again, <code>git add</code> and <code>git commit</code> and ran <code>git push heroku master</code> with no results.</p>\n\n<p>This is a copy of my Gemfile:</p>\n\n<pre><code>source 'https://rubygems.org'\n\ngit_source(:github) do |repo_name|\n  repo_name = \"#{repo_name}/#{repo_name}\" unless repo_name.include?(\"/\")\n  \"https://github.com/#{repo_name}.git\"\nend\n\n\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\ngem 'rails', '~&gt; 5.1.4'\n# Use sqlite3 as the database for Active Record\ngem 'sqlite3'\n# Use Puma as the app server\ngem 'puma', '~&gt; 3.7'\n# Use SCSS for stylesheets\ngem 'sass-rails', '~&gt; 5.0'\n# Use Uglifier as compressor for JavaScript assets\ngem 'uglifier', '&gt;= 1.3.0'\n# See https://github.com/rails/execjs#readme for more supported runtimes\n# gem 'therubyracer', platforms: :ruby\n\ngem 'bootstrap-sass', '~&gt; 3.3.7'\ngem 'jquery-rails'\ngem 'growlyflash'\n\ngem 'devise'\ngem 'devise-bootstrapped'\ngem 'whenever', require: false\n\ngem 'faker'\n\n# Use CoffeeScript for .coffee assets and views\ngem 'coffee-rails', '~&gt; 4.2'\n# Turbolinks makes navigating your web application faster. Read more: \nhttps://github.com/turbolinks/turbolinks\ngem 'turbolinks', '~&gt; 5'\n# Build JSON APIs with ease. Read more: \nhttps://github.com/rails/jbuilder\ngem 'jbuilder', '~&gt; 2.5'\n# Use Redis adapter to run Action Cable in production\n# gem 'redis', '~&gt; 3.0'\n# Use ActiveModel has_secure_password\n# gem 'bcrypt', '~&gt; 3.1.7'\n\n# Use Capistrano for deployment\n# gem 'capistrano-rails', group: :development\n\ngroup :development, :test do\n  # Call 'byebug' anywhere in the code to stop execution and get a \n  debugger console\n  gem 'byebug', platforms: [:mri, :mingw, :x64_mingw]\n  # Adds support for Capybara system testing and selenium driver\n  gem 'capybara', '~&gt; 2.13'\n  gem 'selenium-webdriver'\n  gem 'pry-rails'\n  gem 'binding_of_caller'\n  gem 'better_errors'\n\nend\n\ngroup :development do\n  # Access an IRB console on exception pages or by using &lt;%= console %&gt; \n  anywhere in the code.\n  gem 'web-console', '&gt;= 3.3.0'\n  gem 'listen', '&gt;= 3.0.5', '&lt; 3.2'\n  # Spring speeds up development by keeping your application running in \n  the background. Read more: https://github.com/rails/spring\n  gem 'spring'\n  gem 'spring-watcher-listen', '~&gt; 2.0.0'\nend\n\n# Windows does not include zoneinfo files, so bundle the tzinfo-data gem\ngem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]\n</code></pre>\n\n<p>This is my .gitignore</p>\n\n<pre><code># See https://help.github.com/articles/ignoring-files for more about \nignoring files.\n#\n# If you find yourself ignoring temporary files generated by your text \neditor\n# or operating system, you probably want to add a global ignore instead:\n#   git config --global core.excludesfile '~/.gitignore_global'\n\n# Ignore bundler config.\n/.bundle\n\n# Ignore the default SQLite database.\n/db/*.sqlite3\n/db/*.sqlite3-journal\n\n# Ignore all logfiles and tempfiles.\n/log/*\n/tmp/*\n!/log/.keep\n!/tmp/.keep\n\n/node_modules\n/yarn-error.log\n\n.byebug_history\n</code></pre>\n\n<p>I've also deleted my Gemfile.lock <code>rm -rf ~/.bundle/ ~/.gem/ .bundle/ Gemfile.lock</code>, ran <code>bundle install``git add</code> and <code>git commit</code> and tried pushing it up to Heroku again with no luck.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "singleton"], "comments": [{"owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 0, "creation_date": 1531890307, "post_id": 51393917, "comment_id": 89759291, "body": "what have you tried ?"}, {"owner": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "edited": false, "score": 0, "creation_date": 1531892457, "post_id": 51393917, "comment_id": 89759954, "body": "You might want to see this gem, it will help you test your background job. <a href=\"https://github.com/philostler/rspec-sidekiq\" rel=\"nofollow noreferrer\">github.com/philostler/rspec-sidekiq</a>"}], "answers": [{"tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": false, "score": 0, "last_activity_date": 1531892447, "creation_date": 1531892447, "answer_id": 51394308, "question_id": 51393917, "link": "https://stackoverflow.com/questions/51393917/writing-spec-for-singleton-class-rspec/51394308#51394308", "title": "Writing Spec for singleton class RSpec", "body": "<p>You can test that the <code>Logger</code> calls <code>Helper</code> and <code>PublishJob</code> by stubbing the methods of the class:</p>\n\n<pre><code>describe Logger do\n  let(:event) { double(\"Event\") }\n  let(:msg) { double(\"Message\") }\n  let(:data) { double(\"Data\") }\n\n  before do\n    allow(Helper).to receive(:send).and_return(data)\n    allow(PublishJob).to receive(:perform)\n  end\n\n  before { Logger.log(event, msg) }\n\n  it \"sends a message and performs a job\" do\n    expect(Helper).to have_received(:send).with(event, msg)\n    expect(PublishJob).to have_received(:perform).with(data)\n  end\nend\n</code></pre>\n\n<p>And the details of performing the job, can be tested in the spec file for the job itself.</p>\n"}], "owner": {"reputation": 1, "user_id": 9906051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d3e31fe4d0f09f5997ee9891513d185?s=128&d=identicon&r=PG&f=1", "display_name": "Mazh N.", "link": "https://stackoverflow.com/users/9906051/mazh-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 381, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531892447, "creation_date": 1531890254, "question_id": 51393917, "link": "https://stackoverflow.com/questions/51393917/writing-spec-for-singleton-class-rspec", "title": "Writing Spec for singleton class RSpec", "body": "<p>I have some method in singleton class need to write rspec on Ruby on Rails.\nHere is sample class</p>\n\n<pre><code>class Logger\n  class &lt;&lt; self\n    def log(event, msg)\n      data = Helper.send(event, msg)\n      PublishJob.perform(data)\n    end\n  end\nend\n</code></pre>\n\n<p>How to write a test method called Helper.send... and Run a job?</p>\n\n<p>Thank all</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "algorithm", "e-commerce", "promotions"], "owner": {"reputation": 1048, "user_id": 6166821, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LpwuPY2Vfjw/AAAAAAAAAAI/AAAAAAAADS0/aT3BFBVyQEQ/photo.jpg?sz=128", "display_name": "Hasmukh Rathod", "link": "https://stackoverflow.com/users/6166821/hasmukh-rathod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 431, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1551877793, "creation_date": 1531880795, "last_edit_date": 1531949658, "question_id": 51392698, "link": "https://stackoverflow.com/questions/51392698/algorithm-strategy-to-find-minimum-cart-value-after-applying-eligible-deals-prom", "title": "Algorithm strategy to find minimum cart value after applying eligible deals/promotions on cart items", "body": "<p>I was working on an assignment in the domain of E-commerce.</p>\n\n<p>Admin user can create promotions. If promotion applied, the price of an will be item reduced.</p>\n\n<p>A Promotion:</p>\n\n<ul>\n<li>has many items</li>\n<li>has some conditions which must be fulfilled in order to apply it on items.</li>\n<li>will be on a group of items. After applying promotion, the price of the individual item will be decreased.</li>\n</ul>\n\n<blockquote>\n  <p>Goal: Shopping cart total must be minimized so the user gets the\n  maximum discount. We need to choose a promotion which gives more\n  discount to the user.</p>\n</blockquote>\n\n<p>What I tried so far: </p>\n\n<p>1) I find item wise promotions. Then select the best promotion for that item. But in some cases, cart total is not minimum.</p>\n\n<p>2) The second approach, prepare the group of items based on promotions, but somehow not able to fix which promotion is the best in terms of the discount.</p>\n\n<p>Which algorithm strategy fits to solve this problem? I have seen <a href=\"https://en.wikipedia.org/wiki/Knapsack_problem\" rel=\"nofollow noreferrer\">Knapsack problem</a>, <a href=\"https://en.wikipedia.org/wiki/Travelling_salesman_problem\" rel=\"nofollow noreferrer\">Traveling Salesman problem</a>, <a href=\"https://en.wikipedia.org/wiki/Linear_programming\" rel=\"nofollow noreferrer\">Linear Programming</a>, but somehow not able to figure out.</p>\n\n<p>Example is attached here:</p>\n\n<p><a href=\"https://i.stack.imgur.com/g01Cq.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/g01Cq.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Any pointers will be helpful.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "neo4j"], "answers": [{"tags": [], "owner": {"reputation": 6843, "user_id": 2286415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tbRoS.png?s=128&g=1", "display_name": "logisima", "link": "https://stackoverflow.com/users/2286415/logisima"}, "is_accepted": false, "score": 0, "last_activity_date": 1531904785, "creation_date": 1531904785, "answer_id": 51397916, "question_id": 51392557, "link": "https://stackoverflow.com/questions/51392557/how-to-fix-neo-clienterror-statement-syntaxerror-on-rails-project/51397916#51397916", "title": "How to Fix Neo.ClientError.Statement.SyntaxError on Rails Project?", "body": "<p>Your cypher query is not correct.</p>\n\n<p>You have this <code>(n:Interests::ResearcherNode)</code>, and for cypher it's correct. A <code>:</code> means the start of the label, or with <code>::</code> you are defining an empty label (this not allow).</p>\n\n<p>So does your label is called <code>ResearcherNode</code> (1) or <code>:ResearcherNode</code> (2). </p>\n\n<p>If (1) your query becomes :</p>\n\n<pre><code>MATCH (n:Interests:ResearcherNode) RETURN n LIMIT 25\n</code></pre>\n\n<p>If (2), you need to surround your label name with back quotes :</p>\n\n<pre><code>MATCH (n:Interests:`:ResearcherNode`) RETURN n LIMIT 25\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10019429, "user_type": "registered", "profile_image": "https://graph.facebook.com/1739601462743740/picture?type=large", "display_name": "Shrawan Neupane", "link": "https://stackoverflow.com/users/10019429/shrawan-neupane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531904785, "creation_date": 1531879658, "question_id": 51392557, "link": "https://stackoverflow.com/questions/51392557/how-to-fix-neo-clienterror-statement-syntaxerror-on-rails-project", "title": "How to Fix Neo.ClientError.Statement.SyntaxError on Rails Project?", "body": "<p>Rails Project Source code is below</p>\n\n<pre><code>def initialize_by_type(type, profile)\n  @initializers ||= {\n    \"patient\" =&gt; -&gt;(x) { Interests::PatientNode.new(x) },\n    \"family\" =&gt; -&gt;(x) { Interests::FamilyNode.new(x) },\n    \"care_staff\" =&gt; -&gt;(x) { Interests::CareStaffNode.new(x) },\n    \"researcher\" =&gt; -&gt;(x) { Interests::ResearcherNode.new(x) },\n    \"doctor\" =&gt; -&gt;(x) { Interests::DoctorNode.new(x) },\n    \"medical_staff\" =&gt; -&gt;(x) { Interests::MedicalStaffNode.new(x) },\n    \"company\" =&gt; -&gt;(x) { Interests::CompanyNode.new(x) },\n    \"other\" =&gt; -&gt;(x) { Interests::OthersNode.new(x) }\n  }\n  initializer = @initializers[type]\n  raise ArgumentError, \"unexpected type: #{type}\" unless initializer\n  initializer.call(profile)\nend\n</code></pre>\n\n<p>neo4j Errors is below</p>\n\n<pre><code>ERROR Neo.ClientError.Statement.SyntaxError\nInvalid input ':' (line 1, column 20 (offset: 19))\n\"MATCH (n:Interests::ResearcherNode) RETURN n LIMIT 25\"\n^\n</code></pre>\n\n<p>I am working on Medical SNS Project, The Project is develop by ruby on rails and neo4j DB, I have some Problem on neo4j, How Can i fix this Problem?<a href=\"https://i.stack.imgur.com/36OxJ.png\" rel=\"nofollow noreferrer\">Related Image is Here</a></p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1531897074, "post_id": 51392367, "comment_id": 89761968, "body": "Does it work this way: 1. Edit the content in pure-text field 2. Submit the form 3. Open browser console 4. Run <code>$(&#39;#pure-text&#39;).trumbowyg();</code> 5. Now, edit the content again?"}, {"owner": {"reputation": 37, "user_id": 9970746, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EcTeoxuR1Hc/AAAAAAAAAAI/AAAAAAAAAAc/AyTecg_yrnA/photo.jpg?sz=128", "display_name": "Shao Kahn", "link": "https://stackoverflow.com/users/9970746/shao-kahn"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1531907110, "post_id": 51392367, "comment_id": 89768386, "body": "@JagdeepSingh No use."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1531909992, "post_id": 51392367, "comment_id": 89770271, "body": "I&#39;d suggest checking the script is running when expected. Add <code>alert(&#39;Script Loaded&#39;)</code> or similar above the line <code>$(&#39;#pure-text&#39;).trumbowyg();</code> and check it&#39;s firing when it should be."}], "owner": {"reputation": 37, "user_id": 9970746, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EcTeoxuR1Hc/AAAAAAAAAAI/AAAAAAAAAAc/AyTecg_yrnA/photo.jpg?sz=128", "display_name": "Shao Kahn", "link": "https://stackoverflow.com/users/9970746/shao-kahn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531909902, "creation_date": 1531878001, "last_edit_date": 1531909902, "question_id": 51392367, "link": "https://stackoverflow.com/questions/51392367/ruby-on-rails-the-trumbowyg-editor-will-not-apper", "title": "Ruby on Rails -- The trumbowyg editor will not apper", "body": "<p>I put the trumbowyg JS code in my part template in my rails project:</p>\n\n<pre><code>- content_for :bottom_script do\n  javascript:\n    $('#pure-text').trumbowyg();\n//...\n\n.form-group\n      = chd.text_field :cheads, class: \"form-control\", id: \"pure-text\"\n</code></pre>\n\n<p>When I into this complete template, I see the editor.</p>\n\n<p>After the somone edit action run, I use <code>*.js.slim</code> file to run the JS code and render the part template in my JS code. But the editor will not apper again.</p>\n\n<p>There has wrong with <code>$('#pure-text').trumbowyg();</code> code? Or other reasons?</p>\n"}, {"tags": ["ruby", "windows", "continuous-integration", "appveyor", "scoop-installer"], "comments": [{"owner": {"reputation": 2736, "user_id": 6733637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VL8er.jpg?s=128&g=1", "display_name": "Ilya Finkelsheyn", "link": "https://stackoverflow.com/users/6733637/ilya-finkelsheyn"}, "edited": false, "score": 0, "creation_date": 1531955091, "post_id": 51391973, "comment_id": 89795866, "body": "Ruby 2.5.1-2 x64 is already installed:<a href=\"https://www.appveyor.com/docs/build-environment/#ruby\" rel=\"nofollow noreferrer\">appveyor.com/docs/build-environment/#ruby</a>. Do you really need to install it too?"}, {"owner": {"reputation": 116828, "user_id": 55075, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/8bbc94977312d285045b2412257b6cb8?s=128&d=identicon&r=PG", "display_name": "kenorb", "link": "https://stackoverflow.com/users/55075/kenorb"}, "reply_to_user": {"reputation": 2736, "user_id": 6733637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VL8er.jpg?s=128&g=1", "display_name": "Ilya Finkelsheyn", "link": "https://stackoverflow.com/users/6733637/ilya-finkelsheyn"}, "edited": false, "score": 0, "creation_date": 1531955930, "post_id": 51391973, "comment_id": 89796076, "body": "@ilyaf Wasn&#39;t aware. However, got this error with other tools as well (such as <a href=\"https://ci.appveyor.com/project/kenorb/appveyor-test/build/1.0.7\" rel=\"nofollow noreferrer\"><code>shellcheck</code></a>), so I&#39;m more interested in how to solve the error it-self, so it can work with all tools."}], "answers": [{"tags": [], "owner": {"reputation": 2736, "user_id": 6733637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VL8er.jpg?s=128&g=1", "display_name": "Ilya Finkelsheyn", "link": "https://stackoverflow.com/users/6733637/ilya-finkelsheyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1532100781, "last_edit_date": 1532100781, "creation_date": 1532049062, "answer_id": 51433742, "question_id": 51391973, "link": "https://stackoverflow.com/questions/51391973/build-error-when-installing-certain-tools-on-appveyor-ci-via-scoop/51433742#51433742", "title": "Build error when installing certain tools on AppVeyor CI via Scoop", "body": "<p>Error you describes (<code>The build phase is set to \"MSBuild\" mode (default)...</code>) has no relation to Scoop or anything which happens at <code>install</code> stage. By default AppVeyor tries to detect Visual Studio solution or project. To disable that behavior you can set <code>build: off</code> or rename <code>test_script:</code> to <code>build_script:</code>.</p>\n\n<hr>\n\n<p>Here is the working <code>appveyor.yml</code>:</p>\n\n<pre><code>init:\n- ps: iex (new-object net.webclient).downloadstring('https://get.scoop.sh')\ninstall:\n- ps: scoop install ruby shellcheck\nbuild: off\ntest_script:\n- shellcheck -V\n</code></pre>\n"}], "owner": {"reputation": 116828, "user_id": 55075, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/8bbc94977312d285045b2412257b6cb8?s=128&d=identicon&r=PG", "display_name": "kenorb", "link": "https://stackoverflow.com/users/55075/kenorb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 394, "favorite_count": 0, "accepted_answer_id": 51433742, "answer_count": 1, "score": 1, "last_activity_date": 1532100781, "creation_date": 1531874638, "last_edit_date": 1531956108, "question_id": 51391973, "link": "https://stackoverflow.com/questions/51391973/build-error-when-installing-certain-tools-on-appveyor-ci-via-scoop", "title": "Build error when installing certain tools on AppVeyor CI via Scoop", "body": "<p>I've created the following <a href=\"https://github.com/kenorb/appveyor-test/blob/scoop-install-ruby/appveyor.yml\" rel=\"nofollow noreferrer\"><code>appveyor.yml</code> file</a>:</p>\n\n<pre><code>init:\n- ps: iex (new-object net.webclient).downloadstring('https://get.scoop.sh')\ninstall:\n- ps: scoop install ruby\n</code></pre>\n\n<p>which aims at installing Ruby, but the <a href=\"https://ci.appveyor.com/project/kenorb/appveyor-test/build/1.0.6\" rel=\"nofollow noreferrer\">build fails</a> with:</p>\n\n<pre><code>scoop install ruby\nInstalling 'ruby' (2.5.1-2) [64bit]\nDownloading https://github.com/oneclick/rubyinstaller2/releases/download/rubyinstaller-2.5.1-2/rubyinstaller-2.5.1-2-x64.7z (8.8 MB)...\nChecking hash of rubyinstaller-2.5.1-2-x64.7z... ok.\nExtracting... done.\nLinking ~\\scoop\\apps\\ruby\\current =&gt; ~\\scoop\\apps\\ruby\\2.5.1-2\nPersisting gems\nRunning post-install script...\nSuccessfully installed rake-12.3.1\nParsing documentation for rake-12.3.1\nInstalling ri documentation for rake-12.3.1\nDone installing documentation for rake after 0 seconds\n1 gem installed\n'ruby' (2.5.1-2) was installed successfully!\nNotes\n-----\nInstall MSYS2 via 'scoop install msys2' and then run 'ridk install' to install the toolchain!\n'ruby' suggests installing 'msys2'.\nThe build phase is set to \"MSBuild\" mode (default), but no Visual Studio project or solution files were found in the root directory. If you are not building Visual Studio project switch build mode to \"Script\" and provide your custom build command.\n</code></pre>\n\n<hr>\n\n<p>The same issue happens with <a href=\"https://ci.appveyor.com/project/kenorb/appveyor-test/build/1.0.7\" rel=\"nofollow noreferrer\"><code>shellcheck</code></a>, e.g.</p>\n\n<pre><code>init:\n- ps: iex (new-object net.webclient).downloadstring('https://get.scoop.sh')\ninstall:\n- ps: scoop install shellcheck\ntest_script:\n- shellcheck -V\n</code></pre>\n\n<hr>\n\n<p>Please note that I can easily install other tools such as:</p>\n\n<pre><code>scoop install curl grep sed less touch python perl\n</code></pre>\n\n<p>without any issues (see this <a href=\"https://ci.appveyor.com/project/kenorb/appveyor-test/build/1.0.5\" rel=\"nofollow noreferrer\">build</a>), but it fails on Ruby and ShellCheck.</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "is_accepted": true, "score": 2, "last_activity_date": 1531869196, "creation_date": 1531869196, "answer_id": 51391397, "question_id": 51391357, "link": "https://stackoverflow.com/questions/51391357/undefined-method-page-for/51391397#51391397", "title": "undefined method `page&#39; for", "body": "<p><code>belongs_to :pages</code> should be <code>belongs_to :page</code></p>\n\n<p>Also in your view, make sure that you're checking if it's nil before rendering it. <code>f.object.page.name unless f.object.page.nil?</code></p>\n"}], "owner": {"reputation": 21, "user_id": 1212003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8fb27189d136fb98c17b4581b1c9b18?s=128&d=identicon&r=PG", "display_name": "Zekarias Zico", "link": "https://stackoverflow.com/users/1212003/zekarias-zico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 51391397, "answer_count": 1, "score": 0, "last_activity_date": 1531878755, "creation_date": 1531868855, "last_edit_date": 1531878755, "question_id": 51391357, "link": "https://stackoverflow.com/questions/51391357/undefined-method-page-for", "title": "undefined method `page&#39; for", "body": "<p>I'm trying to create a new section in a nested page object. I defined the page object but I got this error undefined method `page' for #. Rails is complaining for the code below. </p>\n\n<pre><code>&lt;td&gt;&lt;%= f.object.page.name %&gt;&lt;/td&gt;\n</code></pre>\n\n<p>sections.rb file code</p>\n\n<pre><code>belongs_to :pages, optional: true\nvalidates :page_id, presence: true\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1531866093, "post_id": 51390705, "comment_id": 89754002, "body": "You can see the update, I made it too with each loop"}, {"owner": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "reply_to_user": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1531868329, "post_id": 51390705, "comment_id": 89754669, "body": "Damian, you are close. I believe I was not clear enough in my explanation. Would you please adjust your answer accordingly?"}, {"owner": {"reputation": 470, "user_id": 9606113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1e08f711c246aef8f24cf90bf273546?s=128&d=identicon&r=PG&f=1", "display_name": "ActiveModel_Dirty", "link": "https://stackoverflow.com/users/9606113/activemodel-dirty"}, "edited": false, "score": 0, "creation_date": 1531868743, "post_id": 51390705, "comment_id": 89754739, "body": "@Ben I&#39;m confused by your use of <code>#drop</code> in your example. Using that drop the first index from the array it returns, thus your example would only ever return <code>[&quot;example.com&quot;]</code>"}, {"owner": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "reply_to_user": {"reputation": 470, "user_id": 9606113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1e08f711c246aef8f24cf90bf273546?s=128&d=identicon&r=PG&f=1", "display_name": "ActiveModel_Dirty", "link": "https://stackoverflow.com/users/9606113/activemodel-dirty"}, "edited": false, "score": 0, "creation_date": 1531868846, "post_id": 51390705, "comment_id": 89754762, "body": "@ActiveModel_Dirty, you are absolutely right. Adjusted my question. Sorry."}, {"owner": {"reputation": 470, "user_id": 9606113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1e08f711c246aef8f24cf90bf273546?s=128&d=identicon&r=PG&f=1", "display_name": "ActiveModel_Dirty", "link": "https://stackoverflow.com/users/9606113/activemodel-dirty"}, "edited": false, "score": 0, "creation_date": 1531869401, "post_id": 51390705, "comment_id": 89754865, "body": "@Ben it&#39;s no problem, but just to be clear I still don&#39;t think it&#39;s going to give you what you want. Based on the post, out of that array of three domains, you want the hash to be populated with &quot;example.com&quot; and &quot;example.com/homepage&quot;. Given an array of [&quot;example.com/homepage&quot;, &quot;example.com/another&quot;, &quot;example.com&quot;], calling <code>#drop(1)</code> will return [&quot;example.com/another&quot;, &quot;example.com&quot;], leaving off &quot;example.com/homepage&quot; (so it won&#39;t ever make it into the loop). I&#39;m working on an answer for you, but can I ask why not just call <code>all_urls.each</code>? are you purposefully wanting to drop the 1st elem?"}, {"owner": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "reply_to_user": {"reputation": 470, "user_id": 9606113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1e08f711c246aef8f24cf90bf273546?s=128&d=identicon&r=PG&f=1", "display_name": "ActiveModel_Dirty", "link": "https://stackoverflow.com/users/9606113/activemodel-dirty"}, "edited": false, "score": 0, "creation_date": 1531869512, "post_id": 51390705, "comment_id": 89754894, "body": "@ActiveModel_Dirty, yes, I&#39;m dropping it off for a reason which is really not important. In fact, let me remove that from my question as it is irrelevant to the main question."}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1531879603, "post_id": 51390705, "comment_id": 89756885, "body": "@Ben Ok, I made an update, I hope now it works for you"}], "answers": [{"comments": [{"owner": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "edited": false, "score": 0, "creation_date": 1531880754, "post_id": 51390876, "comment_id": 89757161, "body": "Damian, I need whatever follows &quot;{: type =&gt; &quot;condition&quot;,: Params =&gt; {: rules =&gt; {: condition =&gt; &quot;AND&quot;,: rules =&gt;&quot;, which for now is an array, to be a list of hashes separated by commas (... rules =&gt; {: value =&gt; [...]},{...},{...}). NOT an array of hashes. If you can help with that, it will be awesome since I spent the entire day trying to get it right and I can&#39;t."}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "edited": false, "score": 0, "creation_date": 1531881931, "post_id": 51390876, "comment_id": 89757440, "body": "@Ben but.. what\u2019s the difference for you of a list of hashes and an array of hashes? In ruby list and array is pretty much the same. Maybe I\u2019m not understanding the output that you are expecting :/"}, {"owner": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "edited": false, "score": 0, "creation_date": 1531882511, "post_id": 51390876, "comment_id": 89757567, "body": "I am sending this as an API call. It expects a complex structure that is too long to write down here. Instead of an array, it is using comma separated hashes. It looks like mission impossible for Ruby to produce several instances that are not inside an array. Can you think of a way I can do this?"}, {"owner": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "edited": false, "score": 0, "creation_date": 1531944681, "post_id": 51390876, "comment_id": 89791918, "body": "Finally found my mistake and used your solution to fix it. See last update to my post. Thanks!"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "edited": false, "score": 0, "creation_date": 1531946287, "post_id": 51390876, "comment_id": 89792665, "body": "@Ben Fantastic! I feel great for you! Don&#39;t forget to accept the answer if it was useful for you, if you want to. Cheers! I have always loved to help, don&#39;t thank me"}], "tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": true, "score": 2, "last_activity_date": 1531879530, "last_edit_date": 1531879530, "creation_date": 1531865472, "answer_id": 51390876, "question_id": 51390705, "link": "https://stackoverflow.com/questions/51390705/rails-loop-inside-hash/51390876#51390876", "title": "Rails loop inside hash", "body": "<p><strong>Edit accord edited question</strong></p>\n\n<p>You can execute a function inside a hash without problems, I think the problem is how are you using the hash and the function. Look (I will use reduce instead a foreach because I like it more, but it's the same):</p>\n\n<pre><code>all_urls = [\"example.com/homepage\", \"example.com/another\", \"example.com\"]\nhash = {\n    \"type\":\"condition\",\n    \"Params\":{\n        \"rules\":{\n            \"condition\":\"AND\",\n            \"rules\":\n            all_urls.map {|element|\n              h = Hash.new\n              h.merge!({\n                      \"condition\":\"AND\",\n                      \"rules\":[\n                          {\n                              \"value\":[\n                                  \"^https{0,1}:\\\\/\\\\/#{element}\\\\/{0,1}$\"\n                              ]\n                          },\n                      ]\n                  })\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Result is:</p>\n\n<pre><code>{: type =&gt; \"condition\",: Params =&gt; {: rules =&gt; {: condition =&gt; \"AND\",: rules =&gt; [{: condition =&gt; \"AND\",\n        : rules =&gt; [{: value =&gt; [\"^https{0,1}:\\\\/\\\\/example.com/homepage\\\\/{0,1}$\"]\n        }]\n      }, {: condition =&gt; \"AND\",\n        : rules =&gt; [{: value =&gt; [\"^https{0,1}:\\\\/\\\\/example.com/another\\\\/{0,1}$\"]\n        }]\n      }, {: condition =&gt; \"AND\",\n        : rules =&gt; [{: value =&gt; [\"^https{0,1}:\\\\/\\\\/example.com\\\\/{0,1}$\"]\n        }]\n      }]\n    }\n  }\n}\n</code></pre>\n\n<p><strong>Same thing with <code>each</code></strong> :</p>\n\n<pre><code>all_urls = [\"example.com/homepage\", \"example.com/another\", \"example.com\"]\nhash = {\n    \"type\":\"condition\",\n    \"Params\":{\n        \"rules\":{\n            \"condition\":\"AND\",\n            \"rules\":\n            begin\n                  res_lis = []\n                  all_urls.each do |element|\n                    h = Hash.new\n                    h.merge!({\n                        \"condition\":\"AND\",\n                        \"rules\":[\n                            {\n                                \"value\":[\n                                    \"^https{0,1}:\\\\/\\\\/#{element}\\\\/{0,1}$\"\n                                ]\n                            },\n                        ]\n                    })\n                    res_lis.push(h)\n                  end\n                  res_lis\n            end\n          }\n      }\n}\n</code></pre>\n\n<p>Same result:</p>\n\n<pre><code>{: type =&gt; \"condition\",: Params =&gt; {: rules =&gt; {: condition =&gt; \"AND\",: rules =&gt; [{: condition =&gt; \"AND\",\n        : rules =&gt; [{: value =&gt; [\"^https{0,1}:\\\\/\\\\/example.com/homepage\\\\/{0,1}$\"]\n        }]\n      }, {: condition =&gt; \"AND\",\n        : rules =&gt; [{: value =&gt; [\"^https{0,1}:\\\\/\\\\/example.com/another\\\\/{0,1}$\"]\n        }]\n      }, {: condition =&gt; \"AND\",\n        : rules =&gt; [{: value =&gt; [\"^https{0,1}:\\\\/\\\\/example.com\\\\/{0,1}$\"]\n        }]\n      }]\n    }\n  }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "edited": false, "score": 0, "creation_date": 1531874788, "post_id": 51391630, "comment_id": 89755910, "body": "This may work, but seems like an overkill. I prefer not creating classes for every loop I may have in a hash. I am very close to a solution, please see my new edit."}, {"owner": {"reputation": 470, "user_id": 9606113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1e08f711c246aef8f24cf90bf273546?s=128&d=identicon&r=PG&f=1", "display_name": "ActiveModel_Dirty", "link": "https://stackoverflow.com/users/9606113/activemodel-dirty"}, "reply_to_user": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "edited": false, "score": 0, "creation_date": 1531878485, "post_id": 51391630, "comment_id": 89756667, "body": "@Ben f you just want to do this as a one-off, use <code>#map</code>, I updated my answer with a simple solution that will work. But I do want to note that I disagree. For a one-off, sure doing it inline as you desire is fine. But once you have multiple JSON structures with varying logic in the loops, having it all consolidated in one place is a huge time-saver and much more easily maintained. Already, this is a difficult thing to parse because you have a lot of the same keys and a deeply nested structure. Also, the class wasn&#39;t representative of a loop but the entire Json structure."}, {"owner": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "edited": false, "score": 0, "creation_date": 1531878546, "post_id": 51391630, "comment_id": 89756677, "body": "I already tried that. #map created an array of hashes. I need it as hashes without the array containing it. See my updated Update :)"}, {"owner": {"reputation": 470, "user_id": 9606113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1e08f711c246aef8f24cf90bf273546?s=128&d=identicon&r=PG&f=1", "display_name": "ActiveModel_Dirty", "link": "https://stackoverflow.com/users/9606113/activemodel-dirty"}, "reply_to_user": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "edited": false, "score": 0, "creation_date": 1531879640, "post_id": 51391630, "comment_id": 89756892, "body": "@Ben The example in your question had the hashes contained in an array, I thought (as does the other answer). It can&#39;t work without that as you cannot have a hash containing multiple of the same key, it defeats the purpose of using a hash. If you must, look into <code>Hash#compare_by_identity</code>, but you won&#39;t be able to reference the hash by key (the values essentially become the keys): <a href=\"https://apidock.com/ruby/Hash/compare_by_identity\" rel=\"nofollow noreferrer\">apidock.com/ruby/Hash/compare_by_identity</a> Otherwise you will just overwrite the key each time."}, {"owner": {"reputation": 470, "user_id": 9606113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1e08f711c246aef8f24cf90bf273546?s=128&d=identicon&r=PG&f=1", "display_name": "ActiveModel_Dirty", "link": "https://stackoverflow.com/users/9606113/activemodel-dirty"}, "reply_to_user": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "edited": false, "score": 0, "creation_date": 1531885186, "post_id": 51391630, "comment_id": 89758123, "body": "@Ben I added some line numbers and your desired output from the question. If you&#39;re still trying to figure this out, can you help me understand what the exact output you&#39;re looking for is? This matches everything except it does not contain the &quot;value&quot; hash in an array (considering you&#39;re trying to rid yourself of arrays, I&#39;m assuming that&#39;s not the issue), but that&#39;s just because I&#39;ve omitted the <code>id</code> field for brevity. You were saying you don&#39;t want the array that starts on line 5 (of my output example)?"}, {"owner": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "edited": false, "score": 0, "creation_date": 1531944730, "post_id": 51391630, "comment_id": 89791947, "body": "Finally found my mistake. Your solution was still awesome and I will probably use it down the line. See last update to my post. Thanks for your help!"}], "tags": [], "owner": {"reputation": 470, "user_id": 9606113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1e08f711c246aef8f24cf90bf273546?s=128&d=identicon&r=PG&f=1", "display_name": "ActiveModel_Dirty", "link": "https://stackoverflow.com/users/9606113/activemodel-dirty"}, "is_accepted": false, "score": 1, "last_activity_date": 1531885075, "last_edit_date": 1531885075, "creation_date": 1531871132, "answer_id": 51391630, "question_id": 51390705, "link": "https://stackoverflow.com/questions/51390705/rails-loop-inside-hash/51391630#51391630", "title": "Rails loop inside hash", "body": "<p>Give <code>#map</code> a shot:</p>\n\n<pre><code>a = [\"example.com/homepage\", \"example.com/another\", \"example.com\"]\nhash = {\n    \"type\":\"condition\",\n    \"Params\":{\n      \"rules\": {\n        \"condition\":\"AND\",\n        \"rules\":\n          a.map do |url|\n            {\n              \"condition\":\"AND\",\n              \"rules\": {\n                \"value\":[\n                  \"^https{0,1}:\\\\/\\\\/#{url}\\\\/{0,1}$\"\n                ]\n              },\n            }\n          end\n        }\n      }\n    }\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code> 1|    {:type=&gt;\"condition\",\n 2|     :Params=&gt;\n 3|      {:rules=&gt;\n 4|        {:condition=&gt;\"AND\",\n 5|         :rules=&gt;[\n 6|            {:condition=&gt;\"AND\",\n 7|             :rules=&gt;{\n 8|               :value=&gt;[\"^https{0,1}:\\\\/\\\\/example.com/homepage\\\\/{0,1}$\"]\n 9|              }\n10|            },\n11|            {:condition=&gt;\"AND\",\n12|             :rules=&gt;{\n13|               :value=&gt;[\"^https{0,1}:\\\\/\\\\/example.com/another\\\\/{0,1}$\"]\n14|             }\n15|           },\n16|           {:condition=&gt;\"AND\",\n17|             :rules=&gt;{\n18|               :value=&gt;[\"^https{0,1}:\\\\/\\\\/example.com\\\\/{0,1}$\"]\n19|             }\n20|           }\n21|         ]\n22|       }\n23|    }\n</code></pre>\n\n<p>Compared to your desired output, it is largely the same, if anything there are less arrays... So I'm not sure where the disconnect is:</p>\n\n<pre><code>    1|        {\"type\":\"URLS\",\n    2|         \"Params\":{\n    3|           \"rules\":{\n    4|           \"condition\":\"AND\",\n    5|           \"rules\":[\n    6|             {\"condition\":\"AND\",\n    7|              \"rules\":[\n    8|                {\n    9|                  \"value\":[\"^https{0,1}:\\\\/\\\\/example.com/homepage\\\\/{0,1}$\"]\n   10|                 }\n   11|               ]\n   12|              },\n   13|              {\"condition\":\"AND\",\n   14|               \"rules\":[\n   15|                 {\n   16|                   \"value\":[\"^https{0,1}:\\\\/\\\\/example.com/another\\\\/{0,1}$\"]\n   17|                 }\n   18|               ]\n   19|              },\n   20|              {\"condition\":\"AND\",\n   21|               \"rules\":[\n   22|                 {\n   23|                   \"value\":[\"^https{0,1}:\\\\/\\\\/example.com\\\\/{0,1}$\"]\n   24|                 }\n   25|               ]\n   26|             }\n   27|           ]\n   28|         }\n   29|       }\n   30|     }\n</code></pre>\n"}], "owner": {"reputation": 1774, "user_id": 2752719, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f4c3fba95fc99a0f7cd9a28bc982daa8?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2752719/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 393, "favorite_count": 0, "accepted_answer_id": 51390876, "answer_count": 2, "score": 1, "last_activity_date": 1531944636, "creation_date": 1531864333, "last_edit_date": 1531944636, "question_id": 51390705, "link": "https://stackoverflow.com/questions/51390705/rails-loop-inside-hash", "title": "Rails loop inside hash", "body": "<p>This should be simple, but it's not\nI'm trying to generate a json with a loop inside it. Something like this:</p>\n\n<pre><code>all_urls = [\"example.com/homepage\", \"example.com/another\", \"example.com\"]\nhash = {\n    \"type\":\"URLS\",\n    \"Params\":{\n        \"rules\":{\n            \"condition\":\"AND\",\n            \"rules\":[\n                begin\n                    all_urls.each do |url|\n                        {\n                            \"condition\":\"AND\",\n                            \"rules\":[\n                                {\n                                    \"value\":[\n                                        \"data\",\n                                        \"^https{0,1}:\\\\/\\\\/#{url}\\\\/{0,1}$\"\n                                    ]\n                                },\n                                {\n                                    \"id\":\"@timestamp.age\",\n                                }\n                            ]\n                        }\n                    end\n                end\n            ]\n        }\n    }\n}\n</code></pre>\n\n<p>I want to get:</p>\n\n<pre><code>    {\n        \"type\":\"URLS\",\n        \"Params\":{\n            \"rules\":{\n                \"condition\":\"AND\",\n                \"rules\":[\n                    {\n                        \"condition\":\"AND\",\n                        \"rules\":[\n                            {\n                                \"value\":[\n                                    \"data\",\n                                    \"^https{0,1}:\\\\/\\\\/example.com/homepage\\\\/{0,1}$\"\n                                ]\n                            },\n                            {\n                                \"id\":\"@timestamp.age\",\n                            }\n                        ]\n                    },\n                    {\n                        \"condition\":\"AND\",\n                        \"rules\":[\n                            {\n                                \"value\":[\n                                    \"data\",\n                                    \"^https{0,1}:\\\\/\\\\/example.com/another\\\\/{0,1}$\"\n                                ]\n                            },\n                            {\n                                \"id\":\"@timestamp.age\",\n                            }\n                        ]\n                    },\n                    {\n                        \"condition\":\"AND\",\n                        \"rules\":[\n                            {\n                                \"value\":[\n                                    \"data\",\n                                    \"^https{0,1}:\\\\/\\\\/example.com\\\\/{0,1}$\"\n                                ]\n                            },\n                            {\n                                \"id\":\"@timestamp.age\",\n                            }\n                        ]\n                    }\n                ]\n            }\n        }\n    }\n</code></pre>\n\n<p>Tried using map, tried many things. Just either getting errors or getting an array thrown back to me.</p>\n\n<p>EDIT: I'm going to provide the exact json structure I need to produce to be clearer. </p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Using Damian's suggestion, I am very close to getting this to work, but I only manage return the last result in the array. The first two get overwritten with the <code>merge!</code> probably? See below:</p>\n\n<pre><code>a = [\"example.com/homepage\", \"example.com/another\", \"example.com\"]\nhash = {\n    \"type\":\"condition\",\n    \"Params\":{\n        \"rules\":{\n            \"condition\":\"AND\",\n            \"rules\":\n                (\n                    a.inject(Hash.new) do |hash_container, element|\n                        hash_container.merge!({\n                            \"condition\":\"AND\",\n                            \"rules\":[\n                                {\n                                    \"value\":[\n                                        \"^https{0,1}:\\\\/\\\\/#{element}\\\\/{0,1}$\"\n                                    ]\n                                },\n                            ]\n                        })\n                    end\n                )\n        }\n    }\n}\n</code></pre>\n\n<p>I'm getting:</p>\n\n<pre><code>  =&gt; {:type=&gt;\"condition\", :Params=&gt;{:rules=&gt;{:condition=&gt;\"AND\", :rules=&gt;{:condition=&gt;\"AND\", :rules=&gt;[{:value=&gt;[\"^https{0,1}:\\\\/\\\\/example.com\\\\/{0,1}$\"]}]}}}}   \n</code></pre>\n\n<p><strong>UPDATE 3</strong></p>\n\n<p>It seems my main mistake was to assume that \"rules\" in my call was always an array, while in fact, it was sometimes an array and sometimes an object. Hence my confusion.</p>\n\n<p>Both of the answers below are good solution and I ended up using Damian's inject of a hash to generate a hash within a loop, which was key to making it work.</p>\n\n<p>What I ended up doing was creating that \"Damian\" array, then using <code>#Unshift</code> to prepend more objects to that array, and finally add that array within my call.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 19714, "user_id": 1006863, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/sYOuq.jpg?s=128&g=1", "display_name": "Paulo Fidalgo", "link": "https://stackoverflow.com/users/1006863/paulo-fidalgo"}, "edited": false, "score": 0, "creation_date": 1531867710, "post_id": 51389619, "comment_id": 89754509, "body": "post your Gemfile here"}, {"owner": {"reputation": 311, "user_id": 7431223, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Px09O2Ggk3Y/AAAAAAAAAAI/AAAAAAAACq4/jw6hJwFSvLg/photo.jpg?sz=128", "display_name": "Jesus Guevara", "link": "https://stackoverflow.com/users/7431223/jesus-guevara"}, "reply_to_user": {"reputation": 19714, "user_id": 1006863, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/sYOuq.jpg?s=128&g=1", "display_name": "Paulo Fidalgo", "link": "https://stackoverflow.com/users/1006863/paulo-fidalgo"}, "edited": false, "score": 0, "creation_date": 1532562664, "post_id": 51389619, "comment_id": 90026617, "body": "source &#39;<a href=\"https://rubygems.org\" rel=\"nofollow noreferrer\">rubygems.org</a>&#39; gem &#39;rails&#39;, &#39;4.2.7.1&#39; gem &#39;mysql2&#39; gem &#39;sass-rails&#39;, &#39;~&gt; 5.0&#39; gem &#39;uglifier&#39;, &#39;&gt;= 1.3.0&#39; gem &#39;coffee-rails&#39;, &#39;~&gt; 4.1.0&#39; gem &#39;jquery-rails&#39; gem &#39;turbolinks&#39;, &#39;~&gt; 2.5.4&#39; gem &#39;jbuilder&#39;, &#39;~&gt; 2.0&#39; gem &#39;sdoc&#39;, &#39;~&gt; 0.4.0&#39;, group: :doc gem &#39;httparty&#39; gem &#39;sendgrid-actionmailer&#39; gem &#39;hubspot-ruby&#39;, &#39;~&gt; 0.4.0&#39; gem &#39;web-console&#39;, &#39;~&gt; 2.0&#39; gem &#39;spring&#39; gem &#39;tzinfo-data&#39; gem &#39;htmlcompressor&#39;, &#39;~&gt; 0.4.0&#39;"}], "answers": [{"tags": [], "owner": {"reputation": 311, "user_id": 7431223, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Px09O2Ggk3Y/AAAAAAAAAAI/AAAAAAAACq4/jw6hJwFSvLg/photo.jpg?sz=128", "display_name": "Jesus Guevara", "link": "https://stackoverflow.com/users/7431223/jesus-guevara"}, "is_accepted": false, "score": 0, "last_activity_date": 1531858928, "creation_date": 1531858928, "answer_id": 51389620, "question_id": 51389619, "link": "https://stackoverflow.com/questions/51389619/not-available-gemsafeyaml-when-to-run-bundle-install/51389620#51389620", "title": "not available Gem::SafeYAML when to run &#39;bundle install&#39;", "body": "<p>After investigating what I could solve with the following steps:</p>\n\n<p>1.-Download the zip file from the following <a href=\"https://rubygems.org/pages/download?locale=es#formats\" rel=\"nofollow noreferrer\">download</a> and add it to the root of the project  </p>\n\n<p>2.- If you don't have any RubyGems installed, there is still the pre-gem approach to getting software, doing it manually:</p>\n\n<p>2.1-Download from above\n2.2-Unpack into a directory and cd there\n2.3-Install with: <code>ruby setup.rb</code> (you may need admin/root privilege)</p>\n\n<p>2.4- like sudo:\n    gem update --system\n3. run:</p>\n\n<pre><code>bundle install\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 7431223, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Px09O2Ggk3Y/AAAAAAAAAAI/AAAAAAAACq4/jw6hJwFSvLg/photo.jpg?sz=128", "display_name": "Jesus Guevara", "link": "https://stackoverflow.com/users/7431223/jesus-guevara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531859229, "creation_date": 1531858928, "last_edit_date": 1531859229, "question_id": 51389619, "link": "https://stackoverflow.com/questions/51389619/not-available-gemsafeyaml-when-to-run-bundle-install", "title": "not available Gem::SafeYAML when to run &#39;bundle install&#39;", "body": "<p>When I try to run <strong>bundle install</strong> from the project, I get the following error:</p>\n\n<pre><code>unavalible Gem :: SafeYAML when to run 'bundle install'\n</code></pre>\n\n<p>my version of rubygem is:\n<strong>2.0.14</strong></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 921, "user_id": 3172183, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dscm0.png?s=128&g=1", "display_name": "amrdruid", "link": "https://stackoverflow.com/users/3172183/amrdruid"}, "edited": false, "score": 0, "creation_date": 1531857513, "post_id": 51389034, "comment_id": 89750599, "body": "Can you check if <code>set_custom_class</code> is creating a new object every time or is it really caching? maybe the issue is there"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7993657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2a7c5ad5c9cd19a4665ec890da80a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Kao", "link": "https://stackoverflow.com/users/7993657/kao"}, "is_accepted": false, "score": 0, "last_activity_date": 1531857556, "creation_date": 1531857556, "answer_id": 51389336, "question_id": 51389034, "link": "https://stackoverflow.com/questions/51389034/set-an-instance-variable-app-wide-in-rails/51389336#51389336", "title": "Set an instance variable app wide in Rails", "body": "<p>Looks like your before_action will re-instantiate the new object on every request.  That means that since you aren't passing anything through to the class in Method2, it will come out as NULL.</p>\n"}, {"comments": [{"owner": {"reputation": 24638, "user_id": 302533, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6rsH5.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/302533/cameron"}, "edited": false, "score": 0, "creation_date": 1531859232, "post_id": 51389338, "comment_id": 89751416, "body": "Thanks for that. I was under the impression that once you created an instance in the application controller it would be retained but now that I think about it... why would it! The reason I asked was I was looking into using this Gem: <a href=\"https://github.com/zokioki/fitbit_api/blob/master/lib/fitbit_api/client.rb#L51\" rel=\"nofollow noreferrer\">github.com/zokioki/fitbit_api/blob/master/lib/fitbit_api/&hellip;</a> and this line is where the same issue happens in that when you create a client and get a token back you lose it the very next request making that method useless unless you keep sending a refresh token to a new instance."}, {"owner": {"reputation": 24638, "user_id": 302533, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6rsH5.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/302533/cameron"}, "edited": false, "score": 0, "creation_date": 1531859317, "post_id": 51389338, "comment_id": 89751450, "body": "I&#39;ve even raised a ticket for it: <a href=\"https://github.com/zokioki/fitbit_api/issues/4\" rel=\"nofollow noreferrer\">github.com/zokioki/fitbit_api/issues/4</a> as it seems that&#39;s a bit weird to have that method outside of using the refresh_token version of initializing the client."}], "tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": false, "score": 2, "last_activity_date": 1531857583, "creation_date": 1531857583, "answer_id": 51389338, "question_id": 51389034, "link": "https://stackoverflow.com/questions/51389034/set-an-instance-variable-app-wide-in-rails/51389338#51389338", "title": "Set an instance variable app wide in Rails", "body": "<p>You witnessing such behaviour, because state of a controller is not preserved between requests. For example, imagine that <code>current_user</code> method sets <code>@current_user</code> for one request and returns the same user for another one.</p>\n\n<p>Please, consider an option of using cookies or database for sharing state between requests.</p>\n\n<p>Otherwise, a workaround would be setting a class variable of <code>CustomClass</code>, but I don't recommend to do it.</p>\n"}, {"tags": [], "owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "is_accepted": false, "score": -1, "last_activity_date": 1531864303, "creation_date": 1531864303, "answer_id": 51390701, "question_id": 51389034, "link": "https://stackoverflow.com/questions/51389034/set-an-instance-variable-app-wide-in-rails/51390701#51390701", "title": "Set an instance variable app wide in Rails", "body": "<p>Since you said app-wide, why not make it app-wide?</p>\n\n<p>In <code>config/application.rb</code>,</p>\n\n<pre><code>module App\n  class Application &lt; Rails::Application\n\n    def custom_class\n      @custom_class ||= CustomClass.new\n    end \n  end \nend \n</code></pre>\n\n<p>in your application code,</p>\n\n<p><code>Rails.application.custom_class</code></p>\n"}], "owner": {"reputation": 24638, "user_id": 302533, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6rsH5.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/302533/cameron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1531864303, "creation_date": 1531856249, "last_edit_date": 1531857529, "question_id": 51389034, "link": "https://stackoverflow.com/questions/51389034/set-an-instance-variable-app-wide-in-rails", "title": "Set an instance variable app wide in Rails", "body": "<p>In my Rails application I have a class that I want to initialize and then access it throughout my controllers. So the idea is that I set it via the application controller if it's not already been defined:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n\n  before_action :set_custom_class\n\n  # create an instance of customclass if doesn't exist\n  def set_custom_class\n    @custom_class ||= CustomClass.new\n  end\n\nend\n</code></pre>\n\n<p>An example of the class:</p>\n\n<pre><code>class CustomClass\n\n  def initialize; end\n\n  def custom_method\n    @custom_method\n  end\n\n  def custom_method=(content)\n    @custom_method = content\n  end\n\nend\n</code></pre>\n\n<p>If I then have a controller like:</p>\n\n<pre><code>class MyController &lt; ApplicationController\n\n  def method_1\n    # set the custom_method value on my instance\n    @custom_class.custom_method('Some content')\n    # return the value I set above\n    @variable = @custom_class.custom_method\n    redirect_to :method_2\n  end\n\n  def method_2\n    # I should be able to retrieve the same value from that same instance\n    @variable = @custom_class.custom_method\n  end\n\nend\n</code></pre>\n\n<p>What I'm finding is that when calling <code>method_1</code> the <code>@variable</code> will return my content fine, but when calling <code>method_2</code> AFTER method_1 (so the custom_method for the app wide @custom_class has been set) it's returning nil.</p>\n\n<p>Why isn't the instance being retained? The <code>@custom_class</code> shouldn't be creating a new instance as it's already been set. So I can't understand why the value I have set gets lost when requesting it.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 921, "user_id": 3172183, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dscm0.png?s=128&g=1", "display_name": "amrdruid", "link": "https://stackoverflow.com/users/3172183/amrdruid"}, "edited": false, "score": 1, "creation_date": 1531854776, "post_id": 51388618, "comment_id": 89749294, "body": "Hey Morris! Can you add the model of your table? I am not sure what <code>Asia</code> and <code>Europe</code> are"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1531855550, "post_id": 51388618, "comment_id": 89749689, "body": "You&#39;ve achieved it if that&#39;s what you want. If your question pertains to transforming data we have never seen into this, then that&#39;s something you&#39;ll need to expand on considerably. A simple example of the source data that produces this output would go a long way."}], "answers": [{"tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": true, "score": 2, "last_activity_date": 1531856936, "creation_date": 1531856936, "answer_id": 51389185, "question_id": 51388618, "link": "https://stackoverflow.com/questions/51388618/how-can-i-create-group-objects-by-a-field/51389185#51389185", "title": "How can I create group objects by a field", "body": "<p>Since you're using <code>Rails</code>, it can be performed as following:</p>\n\n<pre><code>grouped_rooms = Room.all.group_by(&amp;:room)\ngrouped_rooms_json = grouped_rooms.transform_values do |room|\n  room.as_json(only: [:id, :created_at])\nend\n{ \"rooms\" =&gt; grouped_rooms_json }\n</code></pre>\n"}], "owner": {"reputation": 465, "user_id": 3566194, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000448365269/picture?type=large", "display_name": "Morris", "link": "https://stackoverflow.com/users/3566194/morris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 51389185, "answer_count": 1, "score": 0, "last_activity_date": 1531856936, "creation_date": 1531854421, "question_id": 51388618, "link": "https://stackoverflow.com/questions/51388618/how-can-i-create-group-objects-by-a-field", "title": "How can I create group objects by a field", "body": "<p>I have a table in my app that has the following fields: room, start_at, title and panel.</p>\n\n<p>I want to query them divided by rooms, for example, so I can have a json just like this:</p>\n\n<pre><code>{\n  \"rooms\": {\n    \"Asia\": [{\n        \"title\": \"Asia 1\",\n        \"panel\": \"Asia 1\"\n    }, {\n        \"title\": \"Asia 2\",\n        \"panel\": \"Asia 2\"\n    }],\n    \"Europe\": [{\n        \"title\": \"Europe 1\",\n        \"panel\": \"Europe 1\"\n    }, {\n        \"title\": \"Europe 2\",\n        \"panel\": \"Europe 2\"\n    }]\n  }\n}\n</code></pre>\n\n<p>How can I achieve it?</p>\n"}, {"tags": ["ruby", "hashmap", "transformation"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1531858380, "post_id": 51388258, "comment_id": 89751016, "body": "That second part isn&#39;t valid Ruby code. What is your intent here? If each argument was either a string, an array or a hash that could work: <code>{ &#39;add-runtime&#39; =&gt; { &#39;docker-runc&#39; =&gt; &#39;&#47;usr&#47;libexec...&#39; }, ... }</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1531858500, "post_id": 51388258, "comment_id": 89751068, "body": "Hint: The best way to parse command-line arguments is with a command-line parser and <i>not</i> a regular expression. The syntax is often subtly complex. For example, Ruby has a <a href=\"https://docs.ruby-lang.org/en/2.5.0/OptionParser.html\" rel=\"nofollow noreferrer\">robust parser</a> built-in. There will also be a level of shell parsing on top of that to tease out individual arguments that&#39;s complicated by the fact that things can be quoted, escaped, or both."}, {"owner": {"reputation": 342, "user_id": 3139543, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d122063e2a38ade173d8d6ba7bd3db09?s=128&d=identicon&r=PG&f=1", "display_name": "tstuber", "link": "https://stackoverflow.com/users/3139543/tstuber"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1531859004, "post_id": 51388258, "comment_id": 89751311, "body": "Thanks for your feedback. I did not specify the question good enough. I want to compare configurations - either from process args or from config maps. My goal is to bring both in a hashmap-form to compare (or even merge) them."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1531946241, "post_id": 51388258, "comment_id": 89792641, "body": "It looks a lot better now as that&#39;s a Ruby structure we can actually help you generate."}], "answers": [{"comments": [{"owner": {"reputation": 342, "user_id": 3139543, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d122063e2a38ade173d8d6ba7bd3db09?s=128&d=identicon&r=PG&f=1", "display_name": "tstuber", "link": "https://stackoverflow.com/users/3139543/tstuber"}, "edited": false, "score": 0, "creation_date": 1531978401, "post_id": 51389690, "comment_id": 89801118, "body": "So with the optionParser I would have to declaire all flags by myself, right? I was acutally looking for a more generic approach..."}], "tags": [], "owner": {"reputation": 7294, "user_id": 547023, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f067c849b5ca173b3b71f7f36fb72c5?s=128&d=identicon&r=PG", "display_name": "EnabrenTane", "link": "https://stackoverflow.com/users/547023/enabrentane"}, "is_accepted": false, "score": 0, "last_activity_date": 1531859217, "creation_date": 1531859217, "answer_id": 51389690, "question_id": 51388258, "link": "https://stackoverflow.com/questions/51388258/ruby-map-process-arugments-to-hashmap/51389690#51389690", "title": "Ruby: Map process arugments to hashmap", "body": "<p>As suggested in the comments, <a href=\"https://docs.ruby-lang.org/en/2.1.0/OptionParser.html\" rel=\"nofollow noreferrer\">https://docs.ruby-lang.org/en/2.1.0/OptionParser.html</a> is the way to go.</p>\n\n<p>Build up your options hash then diff them with active support if you have it (<a href=\"http://api.rubyonrails.org/v2.3/classes/ActiveSupport/CoreExtensions/Hash/Diff.html\" rel=\"nofollow noreferrer\">http://api.rubyonrails.org/v2.3/classes/ActiveSupport/CoreExtensions/Hash/Diff.html</a>), or the hashdiff gem if you can. If all else fails, you can check the keys of the left compared to the right, then vice versa.</p>\n"}], "owner": {"reputation": 342, "user_id": 3139543, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d122063e2a38ade173d8d6ba7bd3db09?s=128&d=identicon&r=PG&f=1", "display_name": "tstuber", "link": "https://stackoverflow.com/users/3139543/tstuber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531978768, "creation_date": 1531852772, "last_edit_date": 1531978768, "question_id": 51388258, "link": "https://stackoverflow.com/questions/51388258/ruby-map-process-arugments-to-hashmap", "title": "Ruby: Map process arugments to hashmap", "body": "<p>I have a tricky problem. I try to map some process arguments to a hash map in Ruby. I want to compare process configurations from parameters (first example) and config files (such as json - from the second example).</p>\n\n<p>I have something like this:</p>\n\n<pre><code>/usr/bin/dockerd-current \\\n--add-runtime docker-runc=/usr/libexec/docker/docker-runc-current \\\n--seccomp-profile=/etc/docker/seccomp.json \\\n--selinux-enabled \\\n--storage-driver overlay2\n</code></pre>\n\n<p>And I would like to have a hashmap like:</p>\n\n<pre><code>{ \n  'add-runtime' =&gt; {\n     'docker-runc' =&gt; '/usr/libexec/docker/docker-runc-current'\n  },\n  'seccomp-profile' =&gt; '/etc/docker/seccomp.json',\n  'selinux-enabled' =&gt; '',\n  'storage-driver' =&gt; 'overlay2'\n }\n</code></pre>\n\n<p>EDIT: \nI made a script that generically maps the parameters into a hashmap. The problem is, that this script is not able to detect and map nested elements properly. Here is what I have:</p>\n\n<pre><code>params = \"/usr/bin/dockerd-current     --add-runtime    docker-runc=/usr/libexec/docker/docker-runc-current --default-runtime=docker-runc --exec-opt native.cgroupdriver=systemd --userland-proxy-path=/usr/libexec/docker/docker-proxy-current --init-path=/usr/libexec/docker/docker-init-current --seccomp-profile=/etc/docker/seccomp.json --selinux-enabled --log-driver=journald --signature-verification=false --storage-driver overlay2\"\n\nargs = params.split(\"--\")\n\n# Remove process binary from args.\nargs.shift\n\n# Remove multiple whitespaces and replace equals sign with single whitespace.\nargs.map! { |item| item.split.join(\" \") }\nargs.map! { |item| item=item.gsub('=',' ') }\n\n# Single word params implicit boolean flags with value true\n# Adding true here.\nargs.map! do |item| \n  if item.split(\" \").size == 1\n    item+\" true\"\n  else\n    item\n  end\nend\n\n# Map results to hashmap.\n# TODO: substructures are not mapped properly... \nargs.map! do |x|\n  s = x.split(\" \", 2)\n  [s[0], s[1]]\nend\n\nputs args.to_h\n</code></pre>\n\n<p>I'm glad for any kind of help. </p>\n\n<p>Thanks a lot!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "http"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 9090602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c45da1661939260978ef0dc4bf917ad?s=128&d=identicon&r=PG&f=1", "display_name": "Kev", "link": "https://stackoverflow.com/users/9090602/kev"}, "edited": false, "score": 0, "creation_date": 1531853464, "post_id": 51388244, "comment_id": 89748653, "body": "Yes, you&#39;re right, rails 5.2, ruby 2.3.3. And your answer did exactly what I needed, thanks!"}], "tags": [], "owner": {"reputation": 600, "user_id": 2796616, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sPrN.png?s=128&g=1", "display_name": "andrew21", "link": "https://stackoverflow.com/users/2796616/andrew21"}, "is_accepted": true, "score": 1, "last_activity_date": 1531852710, "creation_date": 1531852710, "answer_id": 51388244, "question_id": 51387967, "link": "https://stackoverflow.com/questions/51387967/form-submission-redirects-to-custom-action-in-rails/51388244#51388244", "title": "Form submission redirects to custom action in rails", "body": "<p>It looks like you are using rails 5.x, correct?</p>\n\n<p>By default, rails 5 assumes you'll use Ajax (javascript) to submit requests and does not do local post event.    see:  <a href=\"http://edgeguides.rubyonrails.org/working_with_javascript_in_rails.html#form-with\" rel=\"nofollow noreferrer\">http://edgeguides.rubyonrails.org/working_with_javascript_in_rails.html#form-with</a></p>\n\n<p>To change this behavior, update your form with <code>local: true</code></p>\n\n<pre><code>= form_with url: \"/instructions/quick_run\", local: true do |form| \np = form.file_field :text_file, as: :file, accept: '.txt'\np = form.submit\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 9090602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c45da1661939260978ef0dc4bf917ad?s=128&d=identicon&r=PG&f=1", "display_name": "Kev", "link": "https://stackoverflow.com/users/9090602/kev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 51388244, "answer_count": 1, "score": 0, "last_activity_date": 1531852710, "creation_date": 1531851508, "question_id": 51387967, "link": "https://stackoverflow.com/questions/51387967/form-submission-redirects-to-custom-action-in-rails", "title": "Form submission redirects to custom action in rails", "body": "<p>I have a form in my index, the form posts to a url corresponding to an action which I have created myself. My index is '/instructions' and upon submitting the form, I would like to be redirected to '/instructions/quick_run' with the form as params.</p>\n\n<p>Currently I have:</p>\n\n<p>instructions_controller.rb</p>\n\n<pre><code>class InstructionsController &lt; ApplicationController\n  def index\n    @instruction = Instruction.all\n  end\n\n  def quick_run\n    @analysis_options = params\n  end\nend\n</code></pre>\n\n<p>index.html.slim</p>\n\n<pre><code>= form_with url: \"/instructions/quick_run\" do |form| \n  p = form.file_field :text_file, as: :file, accept: '.txt'\n  p = form.submit\n</code></pre>\n\n<p>routes.rb</p>\n\n<pre><code>  resources :instructions, only: [:index,:new,:edit,:destroy] do\n    collection do\n      post 'quick_run'\n      get 'quick_run'\n    end\n  end\n</code></pre>\n\n<p>Upon hitting submit, I can see a Started POST \"/instructions/quick_run\" along with the file input passed as a param, however I am not being redirected to \"/instructions/quick_run\". I am also notified of instructions/quick_run.html.slim being rendered, however it is not displayed and the url is still \"/instructions\"</p>\n"}, {"tags": ["ruby", "io", "temporary-files"], "comments": [{"owner": {"reputation": 735, "user_id": 5775246, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rWMQ7_UYyiI/AAAAAAAAAAI/AAAAAAAAADc/xFHc8sFhSWk/photo.jpg?sz=128", "display_name": "DjezzzL", "link": "https://stackoverflow.com/users/5775246/djezzzl"}, "edited": false, "score": 0, "creation_date": 1531849839, "post_id": 51387277, "comment_id": 89746917, "body": "Hey, I&#39;d like to help but could you please provide more information such as: 1) one complete whole test suite when the file is getting deleted after it 2) Gemfile"}], "owner": {"reputation": 581, "user_id": 1743995, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/43e6ac349c2f8d8bd9f8b0ab97b24d83?s=128&d=identicon&r=PG", "display_name": "codeadventurer", "link": "https://stackoverflow.com/users/1743995/codeadventurer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1531848834, "creation_date": 1531848834, "question_id": 51387277, "link": "https://stackoverflow.com/questions/51387277/file-fixture-getting-deleted-after-running-rspec-tests", "title": "File fixture getting deleted after running RSpec tests", "body": "<p>I have tests written in RSpec that have been passing up until an upgrade to Ruby 2.5.1. </p>\n\n<p>The test in question has several <code>let</code> statements in a <code>before(:each)</code> block. The file that keeps getting deleted is in there like so:</p>\n\n<pre><code>    let(:fake_s3_file) { File.open(File.join(File.dirname(__FILE__), '../fixtures/Alexa.pdf')) }\n</code></pre>\n\n<p>Later in <code>before(:each)</code> stanza, I have this:</p>\n\n<pre><code>  allow(s3_client).to receive(:get_object).and_return(fake_s3_file)\n  allow(Tempfile).to receive(:new).and_return(fake_s3_file)\n</code></pre>\n\n<p>It appears that in Ruby 2.5.1, my source files are getting deleted, either because of the <code>File.open</code> or the <code>Tempfile</code> reference. Has anyone run into this, and what is a good way around this? I haven't found any docs that say any changes have happened to <code>Tempfile</code> or to <code>File.open</code>. Should I copy my fixture file into a <code>/tmp</code> directory before every spec run? It seems wrong to do that, and slow.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1531852330, "post_id": 51386917, "comment_id": 89748126, "body": "Consider defining the hash <code>winners = { :rock=&gt;:scissors, :scissors=&gt;:paper,   :paper=&gt;:rock }</code>. Suppose players 1 and 2 one choose to play <code>c1</code> and <code>c2</code>, respectively. Then player 1 wins if <code>winners[c1] == c2</code>, player 2 wins if <code>winners[c2] == c1</code>; else it&#39;s a tie."}], "answers": [{"tags": [], "owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "is_accepted": false, "score": 0, "last_activity_date": 1531847619, "creation_date": 1531847619, "answer_id": 51386980, "question_id": 51386917, "link": "https://stackoverflow.com/questions/51386917/how-to-have-ruby-pick-randomly-from-an-array/51386980#51386980", "title": "How to have ruby pick randomly from an array", "body": "<p>You can use <code>sample</code>:</p>\n\n<pre><code>[1, 2, 3].sample #=&gt; 1\n[1, 2, 3].sample(2) #=&gt; [3, 1]\n</code></pre>\n\n<p><a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-sample\" rel=\"nofollow noreferrer\">Documentation</a></p>\n"}], "owner": {"reputation": 1, "user_id": 10095139, "user_type": "registered", "profile_image": "https://graph.facebook.com/1121966897943410/picture?type=large", "display_name": "Jesse Johnson", "link": "https://stackoverflow.com/users/10095139/jesse-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "closed_date": 1531856212, "answer_count": 1, "score": -3, "last_activity_date": 1531850028, "creation_date": 1531847354, "question_id": 51386917, "link": "https://stackoverflow.com/questions/51386917/how-to-have-ruby-pick-randomly-from-an-array", "closed_reason": "Duplicate", "title": "How to have ruby pick randomly from an array", "body": "<p>Im pretty new to programming and I'm trying to make a basic rock paper scissors program.</p>\n\n<p>I've already made this program using 1 = rock, 2 = paper, 3 = scissors. but now I want to try doing it with actual words instead of numbers. How can I make ruby choose randomly from my array, mine?</p>\n\n<p>Thanks!</p>\n\n<pre><code>mine = [\"Rock\", \"Paper\", \"Scissors\"]\nmine.sample(1 + rand(mine.count))\nputs 'Write your choice, Rock, Paper, or Scissors'\nyours = gets.chomp.to_s\nif yours == \"Rock\"\n    puts 'Your choice is Rock'\n\n\nelsif yours == \"Paper\"\n    puts 'Your choice is Paper'\n\nelse yours == \"Scissors\"\n    puts 'Your choice is Scissors'\n\nend\nputs \"--------------------------\"\nif mine == \"Rock\"\n    puts 'Computer: My choice is Rock'\n\n\nelsif mine == \"Paper\"\n    puts 'Computer: My choice is Paper'\n\nelse mine == \"Scissors\"\n    puts 'Computer: My choice is Scissors'\n\nend\n\n\nprint 'Computer: My choice was: '\nprint mine\nputs\n\nif mine == \"Rock\" &amp;&amp; yours == \"Paper\"\n    puts \"===========\"\n    puts \"Paper Wins!\"\n    puts \"===========\"\nelsif mine == \"Paper\" &amp;&amp; yours == \"Rock\"\n    puts \"===========\"\n    puts \"Paper Wins!\"\n    puts \"===========\"\nelsif mine == \"Paper\" &amp;&amp; yours == \"Scissors\"\n    puts \"==============\"\n    puts \"Scissors Wins!\"\n    puts \"==============\"\nelsif mine == \"Scissors\" &amp;&amp; yours == \"Paper\"\n    puts \"==============\"\n    puts \"Scissors Wins!\"\n    puts \"==============\"\nelsif mine == \"Scissors\" &amp;&amp; yours == \"Rock\"\n    puts \"==========\"\n    puts \"Rock Wins!\"\n    puts \"==========\"\nelsif  mine == \"Rock\" &amp;&amp; yours == \"Scissors\"\n    puts \"==============\"\n    puts \"Rock Wins!\"\n    puts \"==============\"\nelse\n    puts \"======================\"\n    puts \"It's a tie! TRY AGAIN!\"\n    puts \"======================\"\nend\n</code></pre>\n"}, {"tags": ["ruby", "atom-editor", "rubocop", "linter"], "owner": {"reputation": 676, "user_id": 5394713, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-EWDgGVCHSi0/AAAAAAAAAAI/AAAAAAAAFzQ/CiRFZRXaPDg/photo.jpg?sz=128", "display_name": "Mateus Luiz", "link": "https://stackoverflow.com/users/5394713/mateus-luiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1531846388, "creation_date": 1531846388, "question_id": 51386666, "link": "https://stackoverflow.com/questions/51386666/rubocop-atom-linter-does-not-work", "title": "Rubocop atom linter does not work", "body": "<p>I already installed rubocop globally and checked the version, and also the linter-rubocop, but when I open a ruby file in the editor this error appears in the console: </p>\n\n<pre><code>Error running RuboCop Error: -s/--stdin requires exactly one path.\n</code></pre>\n\n<p>I've tried to run manually <code>rubocop -s &lt;path to file&gt;</code> and the error continues.</p>\n\n<p>Any suggestion?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8612739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0e3695d1f58cb4b8aebcf94e75f14b8?s=128&d=identicon&r=PG", "display_name": "Gautham Sakthiveeran", "link": "https://stackoverflow.com/users/8612739/gautham-sakthiveeran"}, "edited": false, "score": 0, "creation_date": 1531906308, "post_id": 51390961, "comment_id": 89767825, "body": "its not working ...[6] pry(#&lt;Twitter::REST::Request&gt;)&gt; HTTP =&gt; HTTP [7] pry(#&lt;Twitter::REST::Request&gt;)&gt; HTTP.method(:get).source_location NameError: undefined method <code>get&#39; for class </code>Module&#39; Did you mean?  gets                gem from (pry):9:in `method&#39; [8] pry(#&lt;Twitter::REST::Request&gt;)&gt; HTTP.method(:gets).source_location =&gt; nil [9] pry(#&lt;Twitter::REST::Request&gt;)&gt;"}, {"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "reply_to_user": {"reputation": 33, "user_id": 8612739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0e3695d1f58cb4b8aebcf94e75f14b8?s=128&d=identicon&r=PG", "display_name": "Gautham Sakthiveeran", "link": "https://stackoverflow.com/users/8612739/gautham-sakthiveeran"}, "edited": false, "score": 0, "creation_date": 1531947482, "post_id": 51390961, "comment_id": 89793222, "body": "I updated my answer. Basically, you need to know what method a class or a module implements and then call YourClass.method(:your_method).source_location. My example just illustrates how this works. I hope it makes sense to you now."}], "tags": [], "owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "is_accepted": false, "score": 0, "last_activity_date": 1531947394, "last_edit_date": 1531947394, "creation_date": 1531866131, "answer_id": 51390961, "question_id": 51386619, "link": "https://stackoverflow.com/questions/51386619/at-run-time-how-to-get-the-path-of-the-file-and-from-which-gem-a-particular-ob/51390961#51390961", "title": "At run time , How to get the path of the file and from which gem a particular object/class is loading in ruby?", "body": "<p>Try <code>HTTParty.method(:get).source_location</code></p>\n"}], "owner": {"reputation": 33, "user_id": 8612739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0e3695d1f58cb4b8aebcf94e75f14b8?s=128&d=identicon&r=PG", "display_name": "Gautham Sakthiveeran", "link": "https://stackoverflow.com/users/8612739/gautham-sakthiveeran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1531947394, "creation_date": 1531846182, "question_id": 51386619, "link": "https://stackoverflow.com/questions/51386619/at-run-time-how-to-get-the-path-of-the-file-and-from-which-gem-a-particular-ob", "title": "At run time , How to get the path of the file and from which gem a particular object/class is loading in ruby?", "body": "<p>At run time , How to get the path of the file and from which gem a particular object/class is loading in ruby ?</p>\n\n<p>To be specific, I am using a twitter Gem and getting an module \"HTTP\" while debugging in pry. I want to know from which Gem this module is coming. I tried HTTP.class and HTTP.class.name . It dint help much.</p>\n\n<pre><code>  [3] pry(#&lt;Twitter::REST::Request&gt;)&gt; HTTP.class\n   =&gt; Module\n  [4] pry(#&lt;Twitter::REST::Request&gt;)&gt; HTTP.class.name\n  =&gt; \"Module\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "dry", "abstraction", "ruby-on-rails-5.1"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1531847594, "post_id": 51386515, "comment_id": 89745832, "body": "The reason you&#39;re hitting the wall is that you&#180;re really stepping outside the box of how rails is designed to work. Rails is built to work with a determinate route collection - while you can pry it apart and shoehorn your own design into there you&#180;re really just losing what makes Rails productive.   I would instead focus on making some generic CRUD resource type base controllers and drying shared behaviors into concerns."}, {"owner": {"reputation": 1584, "user_id": 601976, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/de088f705937dd429b9470ab9b9bbd8b?s=128&d=identicon&r=PG", "display_name": "RoUS", "link": "https://stackoverflow.com/users/601976/rous"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1531848359, "post_id": 51386515, "comment_id": 89746189, "body": "Unfortunately, the way &#39;Rails is designed to work&#39; is a pretty vague thing, and I&#39;m <i>trying</i> to DRY shared behaviours into concerns -- but the concerns don&#39;t inherit the same modules as the controllers, and I can&#39;t figure out which ones I need.  And I sure don&#39;t want to have to repeat myself all over the place.  By using data-driven mechanisms, adding a new model and appropriate routes means editing one file and generating a new controller (and any unique view templates)."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1531849019, "post_id": 51386515, "comment_id": 89746513, "body": "Well the first thing is when you are declaring instance methods - don&#39;t do it in <code>included do ... end</code>. That results in the methods being declared in the context of the class. You want them instead just in the body of the module so that the class refers to the module methods. This might seem minor but will drive you mad when looking at the stacktrace."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1531849286, "post_id": 51386515, "comment_id": 89746634, "body": "Just use <code>included do ... end</code> to perform actions in the class context like for example adding callbacks or using <code>attr_accessor</code> for example. <code>class_methods</code> should just be used to declare class methods (duh). I would recommend you read the docs for <a href=\"http://api.rubyonrails.org/v5.2/classes/ActiveSupport/Concern.html\" rel=\"nofollow noreferrer\">ActiveSupport::Concern</a> and maybe read up on how the module mixin pattern in ruby works."}, {"owner": {"reputation": 4853, "user_id": 126636, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/d69d23d8e811e8ab2a8593380d6ede63?s=128&d=identicon&r=PG", "display_name": "jemminger", "link": "https://stackoverflow.com/users/126636/jemminger"}, "edited": false, "score": 0, "creation_date": 1531849345, "post_id": 51386515, "comment_id": 89746657, "body": "You can use controller callbacks in a concern, just put <code>before_action :whatever</code> in the <code>included</code> block"}], "answers": [{"comments": [{"owner": {"reputation": 1584, "user_id": 601976, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/de088f705937dd429b9470ab9b9bbd8b?s=128&d=identicon&r=PG", "display_name": "RoUS", "link": "https://stackoverflow.com/users/601976/rous"}, "edited": false, "score": 1, "creation_date": 1531911488, "post_id": 51388061, "comment_id": 89771160, "body": "Thank you, that makes a lot of sense.  It is also an explanation I haven&#39;t been able to find anywhere else about how concerns work. I wouldn&#39;t say that I&#39;ve misunderstood about mixins in general, but more about the way Rails has, erm, built upon the concept.  <b>Nowhere</b> have I found that the controller callbacks were available within the <code>included</code> block, so extra thanks for that."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": true, "score": 4, "last_activity_date": 1531851900, "creation_date": 1531851900, "answer_id": 51388061, "question_id": 51386515, "link": "https://stackoverflow.com/questions/51386515/rails-5-abstracting-actions-out-of-controllers/51388061#51388061", "title": "Rails 5: Abstracting actions out of controllers", "body": "<p>You have completly misunderstood pretty much everything about <code>ActiveSupport::Concern</code> and how module mixins work.</p>\n\n<p>Lets start by using composition to seperate concerns. For example:</p>\n\n<pre><code>module LocalStorage\n  extend ActiveSupport::Concern\n  class_methods do\n    # use a memoized helper instead of a constant\n    # as its easier to stub for testing\n    def local_storage\n      @local_storage ||= ::PerceptSys::LocalStore\n    end\n  end\nend\n</code></pre>\n\n<p>This makes sense to extract to a separate concern since its a reusable behaviour.</p>\n\n<p>We can then compose an <code>Uploadable</code> concern:</p>\n\n<pre><code>module Uploadable\n  # we compose modules by extending\n  extend ActiveSupport::Concern\n  extend LocalStorage \n\n  # put instance methods in the module body\n\n  # GET /&lt;model&gt;/upload(.:format)\n  def webupload\n      # ...\n  end\n\n        #\n  # POST /&lt;model&gt;/upload(.:format)\n  #\n  def upload\n    # ...\n\n  end\n\n  # don't abuse use a callback for this - just use a straight \n  # method that returns a value and preferably does not have side effects\n  def upload_params\n    # ...\n  end\n\n  # ...\n\n  # use \"included\" to hook in the class definition\n  # self here is the singleton class instance\n  # so this is where you put callbacks, attr_accessor etc\n  # which would normally go in the class defintion\n  included do\n    before_action(:set_title_uploading,\n              :only =&gt; [\n                :upload,\n                :webupload,\n              ])\n    before_action(:set_file_upload,\n              :only =&gt; [\n                :upload,\n              ])\n  end\n\n  # just use class_methods for actual class_methods!\n  class_methods do\n     # for example to derive the name of a model from the controller name\n     def resource_class_name\n       controller_name.singularize\n     end\n\n     def resource_class\n       @resource_class ||= resource_class_name.classify.constantize\n     end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1584, "user_id": 601976, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/de088f705937dd429b9470ab9b9bbd8b?s=128&d=identicon&r=PG", "display_name": "RoUS", "link": "https://stackoverflow.com/users/601976/rous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1047, "favorite_count": 0, "accepted_answer_id": 51388061, "answer_count": 1, "score": 1, "last_activity_date": 1531851900, "creation_date": 1531845808, "last_edit_date": 1531848155, "question_id": 51386515, "link": "https://stackoverflow.com/questions/51386515/rails-5-abstracting-actions-out-of-controllers", "title": "Rails 5: Abstracting actions out of controllers", "body": "<p>RoR 5.1.4.  My application is backed by MongoDB <em>via</em> Mongoid, and many of the models have similar handling.  I'm trying to make it as data-driven as possible, which means querying <code>Mongoid</code> for the models and Rails for the routes, neither of which can be done comfortably in initialisers because of eager loading and routes not yet having been set up.  The schema information (controller/model relationships, model fields, <em>etc.</em>, are stored in a singleton location, and making <em>that</em> happen and be accessible from class and instance environments has been a PITA.  However, that's background.</p>\n\n<p>Most of the controllers support two upload actions, one <em>via</em> form file specification and one <em>via</em> request content body.  I'm using <code>webupload</code> and <code>upload</code> actions for these respectively, and since they're always handled the same (differences are determined by examining the aforementioned schema info), I want to abstract those two action methods, and their related before/after/.. relationship definitions, into a separate module.</p>\n\n<p>A controller concern won't do it OOTB because the callbacks (<em>e.g.</em>, <code>:before_action</code> and friends) aren't declared in the inheritance, and I can't figure out what module I'd need to <code>include</code> in the concern in order to get them.</p>\n\n<p>Helpers are out because they've been deprecated from controller inclusion (you need to take extra steps to get them), and they're primarily for views anyway.</p>\n\n<p>So what is the pattern for writing/placing/including modules specifically for controllers, models, and tests?  That have the proper inheritance of methods for those functions?  (<em>E.g.</em>, <code>:before_action</code> for controllers, <code>:validates</code> for models, and so on.)</p>\n\n<p>RoR is a wealthy hoard of features and hooks, but I'm finding it bloody hard to apply abstraction and DRY patterns to it simply because it <strong>is</strong> so rich.</p>\n\n<p>Thanks for any help or pointers!</p>\n\n<p>[EDIT] Someone suggested that I include some code.  So here in an abbreviated excerpt of my attempt to do this with a controller concern.</p>\n\n<pre><code>module UploadAssistant\n\n  extend ActiveSupport::Concern\n  #\n  # Code to execute when something does a `include ControllerAssistant`.\n  #\n  included do\n    #\n    # Make the application's local storage module more easily\n    # accessible, too.\n    #\n    unless (self.const_defined?('LocalStore'))\n      self.const_set('LocalStore', ::PerceptSys::LocalStore)\n    end\n\n    def set_title_uploading\n      title.base        = 'Uploading records'\n      title.add(model_info.friendly)\n    end                         # def set_base_title\n\n    #+\n    # Supply these routes to the controllers so they needn't define\n    # them.\n    #\n\n    #\n    # GET /&lt;model&gt;/upload(.:format)\n    #\n    def webupload\n    end                         # def webupload\n\n    #\n    # POST /&lt;model&gt;/upload(.:format)\n    #\n    def upload\n      title.add('Results')\n      @uploads          = {\n        :success                =&gt; {},\n        :failure                =&gt; {},\n      }\n      errors            = 0\n      @upload_records.each do |record|\n        #\n        # Stuff happens here.\n        #\n      end\n      successes         = @uploads[:success].count\n      failures          = @uploads[:failure].count\n      respond_to do |format|\n        format.html {\n          render(:upload,\n                 :status   =&gt; :ok,\n                 :template =&gt; 'application/upload.html')\n        }\n        format.json {\n          render(:json     =&gt; @uploads)\n        }\n      end\n    end\n\n    def upload_file_params\n      if (params[:file])\n        params.require(:file).require(:upload)\n        colname         = model_info.collection\n        file_id         = params[:file][:upload]\n        #\n        # Get the file contents.\n        #\n      end\n      @upload_records   = params.delete(model_info.collection.to_sym)\n    end                         # def upload_file_params\n\n    def upload_params\n      @upload_records   = params.require(model_info.collection.to_sym)\n    end                         # def upload_params\n\n    def set_file_upload\n      file_id           = params.require(:file).require(:upload)\n      #\n      # Read/decompress the file.\n      #\n      data              = JSON.parse(data)\n      params[model_info.collection] = data[model_info.collection]\n    end                         # def set_file_upload\n\n  end                           # included do\n\n  #+\n  # Insert here any class methods we want added to our including class\n  # or module.\n  #\n  class_methods do\n\n    #\n    # Stuff relating specifically to bulk uploading.\n    #\n    before_action(:set_title_uploading,\n                  :only =&gt; [\n                    :upload,\n                    :webupload,\n                  ])\n    before_action(:set_file_upload,\n                  :only =&gt; [\n                    :upload,\n                  ])\n    before_action(:upload_params,\n                  :only =&gt; [\n                    :upload,\n                  ])\n\n  end                           # class_methods do\n\nend                             # module ControllerAssistant\n\n# Local Variables:\n# mode: ruby\n# eval: (fci-mode t)\n# End:\n</code></pre>\n"}, {"tags": ["ruby", "protocol-buffers", "suse"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1531889949, "post_id": 51385754, "comment_id": 89759193, "body": "What is your question?"}, {"owner": {"reputation": 359, "user_id": 3446392, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/100000584995368/picture?type=large", "display_name": "rohitsakala", "link": "https://stackoverflow.com/users/3446392/rohitsakala"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1531890843, "post_id": 51385754, "comment_id": 89759434, "body": "Hi @sawa, sorry for not giving clarity on my question. My question is that why does lookup call give nil class whereas it should point out to google.protobuf.Any. Do you know why ?."}], "owner": {"reputation": 359, "user_id": 3446392, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/100000584995368/picture?type=large", "display_name": "rohitsakala", "link": "https://stackoverflow.com/users/3446392/rohitsakala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1534400731, "creation_date": 1531843080, "last_edit_date": 1531922845, "question_id": 51385754, "link": "https://stackoverflow.com/questions/51385754/ruby-script-lookup-method-return-nil-class", "title": "Ruby script lookup method return nil class?", "body": "<p>I have a ruby script as shown below:</p>\n\n<pre><code>require 'google/protobuf'\n\nGoogle::Protobuf::DescriptorPool.generated_pool.build do\n  add_message \"google.protobuf.Any\" do\n    optional :type_url, :string, 1\n    optional :value, :bytes, 2\n  end\nend\n\nmodule Google\n  module Protobuf\n    Any = Google::Protobuf::DescriptorPool.generated_pool.lookup(\"google.protobuf.Any\").msgclass\n  end\nend\n</code></pre>\n\n<p>The lookup call gives me <code>nil</code> class. Why does it give me <code>nil</code> class?  Whereas <code>google.protobuf.Any</code> is defined in the above block.</p>\n\n<p>The error that I get when I run <code>ruby any_pb.rb</code> is:</p>\n\n<pre><code>any_pb.rb:15:in `&lt;module:Protobuf&gt;': undefined method `msgclass' for nil:NilClass (NoMethodError)\n    from any_pb.rb:14:in `&lt;module:Google&gt;'\n    from any_pb.rb:13:in `&lt;main&gt;'\n</code></pre>\n\n<p><strong>Environment</strong>: Suse s390x Big Endian</p>\n\n<p>Link to environment: <a href=\"https://linuxone20.cloud.marist.edu/cloud/\" rel=\"nofollow noreferrer\">https://linuxone20.cloud.marist.edu/cloud/</a> </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "frontend"], "comments": [{"owner": {"reputation": 1114, "user_id": 5934752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7tGT8.jpg?s=128&g=1", "display_name": "Ravi Mariya", "link": "https://stackoverflow.com/users/5934752/ravi-mariya"}, "edited": false, "score": 0, "creation_date": 1531843882, "post_id": 51385709, "comment_id": 89743864, "body": "Because it returns the last statement executed by method, also for code reusability you can create partials"}, {"owner": {"reputation": 1, "user_id": 2548120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36794a16f31f80025b9583f621ef81e2?s=128&d=identicon&r=PG", "display_name": "Naomi", "link": "https://stackoverflow.com/users/2548120/naomi"}, "reply_to_user": {"reputation": 1114, "user_id": 5934752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7tGT8.jpg?s=128&g=1", "display_name": "Ravi Mariya", "link": "https://stackoverflow.com/users/5934752/ravi-mariya"}, "edited": false, "score": 0, "creation_date": 1531844239, "post_id": 51385709, "comment_id": 89744053, "body": "Since form_for/tag are blocks, I thought it would return an object that was interpreted by ruby as an html form. Wouldn&#39;t that vlbe returned by the helper funxtion? If it returns only the last line, why does it show everything in the view?"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1531846160, "post_id": 51385709, "comment_id": 89745061, "body": "<code>form_for&#47;tag</code> are not blocks - they are methods defined by the Rails helpers. You pass blocks to the helper to which they yield between the <code>&lt;form&gt;</code> and <code>&lt;&#47;form&gt;</code>. These blocks will return the result of the last expression just like everything else in ruby."}, {"owner": {"reputation": 1, "user_id": 2548120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36794a16f31f80025b9583f621ef81e2?s=128&d=identicon&r=PG", "display_name": "Naomi", "link": "https://stackoverflow.com/users/2548120/naomi"}, "edited": false, "score": 0, "creation_date": 1531860781, "post_id": 51385709, "comment_id": 89752115, "body": "Ah, I see; I got the concept mixed up. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 0, "last_activity_date": 1531846806, "last_edit_date": 1531846806, "creation_date": 1531844286, "answer_id": 51386086, "question_id": 51385709, "link": "https://stackoverflow.com/questions/51385709/why-cant-form-tag-and-form-for-be-used-in-helper-functions-rails/51386086#51386086", "title": "Why can&#39;t form_tag and form_for be used in helper functions [Rails]", "body": "<p>When calling the form helpers (or any other html helpers) in a helper method you need to call <code>concat</code> (or manually concatenate the strings). </p>\n\n<pre><code>def form_select #### Helper Function\n  form_tag po_path(@pos), method: \"get\" do \n    concat collection_select :po, :category, @pos.categories.order(:id), :id, :name, selected: (@items.empty? ? \"\" : @items.first.category.id)\n    concat submit_tag \"Show items\" \n  end \nend \n</code></pre>\n\n<p>This is because the helper does not return a concatenated html string as you are expecting. Rather the blocks returns the result of the last expression just like any other Ruby block.</p>\n\n<pre><code>def foo(&amp;block) \n  yield\nend\n\n# returns \"baz\"\nfoo do\n  \"bar\"\n  \"baz\"\nend\n</code></pre>\n\n<p>It works in ERB since the <code>&lt;%= %&gt;</code> <a href=\"http://www.stuartellis.name/articles/erb/#writing-templates\" rel=\"nofollow noreferrer\">are <em>expressions</em></a> where the renderer should substitute the code element with the result of the code (as a string) when it renders the template. This is somewhat like <code>puts</code> but it writes to the template buffer.</p>\n\n<pre><code>&lt;%= foo do %&gt;\n  &lt;%= \"bar\" %&gt; &lt;%= \"baz\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This example will output \"bar baz\" to the template.</p>\n\n<p>But you should really consider using a partial here instead. </p>\n"}], "owner": {"reputation": 1, "user_id": 2548120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36794a16f31f80025b9583f621ef81e2?s=128&d=identicon&r=PG", "display_name": "Naomi", "link": "https://stackoverflow.com/users/2548120/naomi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 228, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531846806, "creation_date": 1531842915, "last_edit_date": 1531843328, "question_id": 51385709, "link": "https://stackoverflow.com/questions/51385709/why-cant-form-tag-and-form-for-be-used-in-helper-functions-rails", "title": "Why can&#39;t form_tag and form_for be used in helper functions [Rails]", "body": "<p>I'm doing a rails project and I'm refractoring some code. Because I use the same type of collection_select with a form_tag, I decided to create a helper for it where I just change the path &amp; request. </p>\n\n<p>However, I noticed that when I use form_for in a helper function, it only returns the last line. In the following example, it will only return the submit button and if I remove the submit button, it will only return the select.</p>\n\n<pre><code>def form_select #### Helper Function\n     form_tag po_path(@pos), method: \"get\" do \n         collection_select :po, :category, @pos.categories.order(:id), :id, :name, selected: (@items.empty? ? \"\" : @items.first.category.id)\n         submit_tag \"Show items\" \n     end \n  end \nend \n</code></pre>\n\n<p>My question is; why does this not work, but the following does? </p>\n\n<pre><code>&lt;!-- In the view --&gt;\n&lt;%= form_tag po_path(@pos), method: \"get\" do %&gt; \n        &lt;%= collection_select :po, :category, @pos.categories.order(:id), :id, :name, selected: (@items.empty? ? \"\" : @items.first.category.id)%&gt; \n        &lt;%= submit_tag \"Show items\" %&gt; \n    &lt;% end %&gt;\n</code></pre>\n\n<p>It does the same for form_for. </p>\n\n<p>Does anyone know why this happens? </p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 3930, "user_id": 4613236, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wQZcm.jpg?s=128&g=1", "display_name": "Zoran", "link": "https://stackoverflow.com/users/4613236/zoran"}, "is_accepted": true, "score": 3, "last_activity_date": 1531842863, "last_edit_date": 1531842863, "creation_date": 1531842426, "answer_id": 51385559, "question_id": 51385208, "link": "https://stackoverflow.com/questions/51385208/remove-delete-object-from-array-in-ruby-based-on-attribute-value/51385559#51385559", "title": "Remove/delete object from array in Ruby based on attribute value", "body": "<p>You can use the <a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-reject\" rel=\"nofollow noreferrer\"><code>#reject</code></a> method to return the array without objects whose <code>:units</code> equals <code>0</code>:</p>\n\n<pre><code>result.reject { |hash| hash[:units] == 0 }\n</code></pre>\n\n<p>There's also <code>#reject!</code> and <a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-delete_if\" rel=\"nofollow noreferrer\"><code>#delete_if</code></a>, which can be used in the same way as above <em>but both modify the array in place</em>.</p>\n\n<p>Hope this helps!</p>\n"}, {"comments": [{"owner": {"reputation": 1676, "user_id": 7848529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/439048b68a313b2407a5cd6c405e39a1?s=128&d=identicon&r=PG&f=1", "display_name": "aabiro", "link": "https://stackoverflow.com/users/7848529/aabiro"}, "edited": false, "score": 0, "creation_date": 1531872068, "post_id": 51391027, "comment_id": 89755411, "body": "This seems to be how to create a new array with the objects with units = 0"}, {"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "reply_to_user": {"reputation": 1676, "user_id": 7848529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/439048b68a313b2407a5cd6c405e39a1?s=128&d=identicon&r=PG&f=1", "display_name": "aabiro", "link": "https://stackoverflow.com/users/7848529/aabiro"}, "edited": false, "score": 0, "creation_date": 1531947276, "post_id": 51391027, "comment_id": 89793134, "body": "Ah, I see what you wanted. You wanted to get rid of the objects with units == 0, not an array of those objects.You are right."}], "tags": [], "owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "is_accepted": false, "score": 0, "last_activity_date": 1531866605, "creation_date": 1531866605, "answer_id": 51391027, "question_id": 51385208, "link": "https://stackoverflow.com/questions/51385208/remove-delete-object-from-array-in-ruby-based-on-attribute-value/51391027#51391027", "title": "Remove/delete object from array in Ruby based on attribute value", "body": "<p>You can achieve the same result using <a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-select\" rel=\"nofollow noreferrer\">select</a> method implemented on the <code>Array</code> class:</p>\n\n<p><code>result.select { |el| el[:units] == 0 }</code></p>\n"}], "owner": {"reputation": 1676, "user_id": 7848529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/439048b68a313b2407a5cd6c405e39a1?s=128&d=identicon&r=PG&f=1", "display_name": "aabiro", "link": "https://stackoverflow.com/users/7848529/aabiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5485, "favorite_count": 1, "accepted_answer_id": 51385559, "answer_count": 2, "score": 3, "last_activity_date": 1531872715, "creation_date": 1531841253, "last_edit_date": 1531872715, "question_id": 51385208, "link": "https://stackoverflow.com/questions/51385208/remove-delete-object-from-array-in-ruby-based-on-attribute-value", "title": "Remove/delete object from array in Ruby based on attribute value", "body": "<p>I have an array</p>\n\n<p><code>result = [{:cluster=&gt;[0, 4], :id=&gt;1, :units=&gt;346, :num1=&gt;0.161930681e7, :num2=&gt;0.14223512616e9, \"description\"=&gt;\"Foo\"}, { ...</code></p>\n\n<p>And I want to take out any objects with number of units equal to 0. Looking for something similar to <code>array.splice()</code> but for <strong><em>Ruby</em></strong>\nWhat is the best way to do this ?</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 354, "user_id": 2289501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/647f15f7859430b4537a3350d074434b?s=128&d=identicon&r=PG&f=1", "display_name": "reguilon", "link": "https://stackoverflow.com/users/2289501/reguilon"}, "edited": false, "score": 1, "creation_date": 1531903945, "post_id": 51385470, "comment_id": 89766197, "body": "Thank you for your time. I figured out that <code>nil</code> is actually nothing more than a value to express the &quot;not an object&quot; notion (via the <code>Qnil</code> macro). When it comes to receiver and message sending (the <code>rb_call*</code> methods in vm_eval.c) then the <code>rb_cNilClass</code> is in charge of sending the messages. feel free to have a look to the <code>CLASS_OF()</code> macro to figure it out. So there is no &quot;instantiation&quot; of the <code>nil</code> object."}], "tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": true, "score": 3, "last_activity_date": 1531842156, "creation_date": 1531842156, "answer_id": 51385470, "question_id": 51384887, "link": "https://stackoverflow.com/questions/51384887/where-is-the-nilclass-singleton-instance-instantiated/51385470#51385470", "title": "Where is the &#39;NilClass&#39; singleton instance instantiated?", "body": "<p>If we take a look at the Ruby source code on Github, we can see that most of the kernel functionality is initialized in <a href=\"https://github.com/ruby/ruby/blob/38e05ff3e194268fd2f38ac7c9530298e464f07b/object.c\" rel=\"nofollow noreferrer\"><code>InitVM_Object</code></a>. However, <code>nil</code> is conspicuously absent, and the only clue of its existence is</p>\n\n<pre><code>/*\n * An obsolete alias of +nil+\n */\nrb_define_global_const(\"NIL\", Qnil);\n</code></pre>\n\n<p>which, admittedly, I didn't actually know that <code>NIL</code> even worked in Ruby, but that's beside the point. Now we know that, in Ruby's C code, <code>Qnil</code> is our \"nil\" object. As it turns out, we can trace that back to <em>its</em> origin, in <a href=\"https://github.com/ruby/ruby/blob/bcf8ce8494a6afb79196b37e856a556a649d0794/include/ruby/ruby.h\" rel=\"nofollow noreferrer\"><code>ruby.h</code></a>. <code>Qnil</code> is not a variable; it's a <code>#define</code> pragma.</p>\n\n<pre><code>#define Qnil RUBY_Qnil\n</code></pre>\n\n<p><code>RUBY_Qnil</code>, on the other hand, is defined as an enum constant.</p>\n\n<pre><code>enum ruby_special_consts {\n    RUBY_Qfalse = 0x00,     /* ...0000 0000 */\n    RUBY_Qtrue  = 0x14,     /* ...0001 0100 */\n    RUBY_Qnil = 0x08,       /* ...0000 1000 */\n    ...\n}\n</code></pre>\n\n<p>So it looks like <code>nil</code> is just a happy lie in Ruby. It's not even a real object at all; it's just a special magic number. <code>true</code> and <code>false</code> are also defined in that same enum. In fact, we can check that this is accurate in Ruby itself.</p>\n\n<pre><code>irb(main):009:0&gt; false.object_id\n=&gt; 0\nirb(main):010:0&gt; true.object_id\n=&gt; 20\nirb(main):011:0&gt; nil.object_id\n=&gt; 8\n</code></pre>\n\n<p><code>false</code>, <code>true</code>, and <code>nil</code> all have identifiers equal* to the values we found in the enum, so this looks like it.</p>\n\n<p>It's worth noting that while <em>nil</em> itself is a happy lie in the VM, the methods on <code>nil</code> are, of course, very real. The <code>NilClass</code> is defined in <a href=\"https://github.com/ruby/ruby/blob/38e05ff3e194268fd2f38ac7c9530298e464f07b/object.c\" rel=\"nofollow noreferrer\"><code>InitVM_Object</code></a>, and so are its methods. But <code>nil</code> is never <em>initialized</em>, per se.</p>\n\n<p>* It's technically possible that your values are different. The enum values listed here are protected by a <code>#if USE_FLONUM</code> block, which is set or unset depending on the size of various constants on your system. You can check out the criteria for that flag, as well as several other similar ones, in <a href=\"https://github.com/ruby/ruby/blob/bcf8ce8494a6afb79196b37e856a556a649d0794/include/ruby/ruby.h\" rel=\"nofollow noreferrer\"><code>ruby.h</code></a>.</p>\n"}, {"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1531842451, "post_id": 51385493, "comment_id": 89743031, "body": "It&#39;d be interesting to contrast this to Rubinius where the C layer is a lot leaner."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1531842511, "post_id": 51385493, "comment_id": 89743067, "body": "The implementation in Rubinius is <a href=\"https://github.com/rubinius/rubinius/blob/4628ce3730626df435089e6c705dc07ead7e32ab/core/nil.rb\" rel=\"nofollow noreferrer\">very straightforward</a>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1531843083, "post_id": 51385493, "comment_id": 89743425, "body": "Doesn&#39;t get much simpler than that!"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1531863296, "post_id": 51385493, "comment_id": 89753160, "body": "@TomLord: Actually, that doesn&#39;t show where <code>nil</code> is instantiated. In fact, if you look at the last line, <code>nil</code> is simply assumed to exist. My guess would be that <code>nil</code> is defined as part of the <code>machine</code>, i.e. in C++, not Ruby."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1531863998, "post_id": 51385493, "comment_id": 89753391, "body": "@TomLord: Rubinius calls the minimal base object structure that is needed to run the bootstrap Ruby code the <i>ontology</i>, and <code>nil</code> is defined in the file <a href=\"https://github.com/rubinius/rubinius/blob/master/machine/ontology.cpp#L216\" rel=\"nofollow noreferrer\"><code>machine&#47;ontology.cpp</code></a>."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 1, "last_activity_date": 1531842239, "creation_date": 1531842239, "answer_id": 51385493, "question_id": 51384887, "link": "https://stackoverflow.com/questions/51384887/where-is-the-nilclass-singleton-instance-instantiated/51385493#51385493", "title": "Where is the &#39;NilClass&#39; singleton instance instantiated?", "body": "<p><a href=\"https://github.com/ruby/ruby/blob/5aa52587e86b9e2b03cad8b78307e53b777f1df2/include/ruby/ruby.h#L410-L443\" rel=\"nofollow noreferrer\">It's defined here</a>.</p>\n\n<p>Namely, we have the lines:</p>\n\n<pre><code>RUBY_Qnil   = 0x08\n\n#define RUBY_Qnil   ((VALUE)RUBY_Qnil)\n#define Qnil  RUBY_Qnil\n</code></pre>\n\n<p>This is why <code>nil.object_id == 8</code>.</p>\n\n<p><code>NilClass</code>, and its methods, are then defined <a href=\"https://github.com/ruby/ruby/blob/38e05ff3e194268fd2f38ac7c9530298e464f07b/object.c#L4110-L4124\" rel=\"nofollow noreferrer\">here</a>:</p>\n\n<pre><code>rb_cNilClass = rb_define_class(\"NilClass\", rb_cObject);\nrb_define_method(rb_cNilClass, \"to_i\", nil_to_i, 0);\nrb_define_method(rb_cNilClass, \"to_f\", nil_to_f, 0);\nrb_define_method(rb_cNilClass, \"to_s\", nil_to_s, 0);\nrb_define_method(rb_cNilClass, \"to_a\", nil_to_a, 0);\nrb_define_method(rb_cNilClass, \"to_h\", nil_to_h, 0);\nrb_define_method(rb_cNilClass, \"inspect\", nil_inspect, 0);\nrb_define_method(rb_cNilClass, \"&amp;\", false_and, 1);\nrb_define_method(rb_cNilClass, \"|\", false_or, 1);\nrb_define_method(rb_cNilClass, \"^\", false_xor, 1);\nrb_define_method(rb_cNilClass, \"===\", rb_equal, 1);\n\nrb_define_method(rb_cNilClass, \"nil?\", rb_true, 0);\nrb_undef_alloc_func(rb_cNilClass);\nrb_undef_method(CLASS_OF(rb_cNilClass), \"new\");\n</code></pre>\n\n<p>Throughout the MRI source code, you'll then find countless references to <code>Qnil</code></p>\n"}, {"tags": [], "owner": {"reputation": 1777, "user_id": 3353157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6168a2c2f5e3582addf6d9d70ce13749?s=128&d=identicon&r=PG", "display_name": "Peter Camilleri", "link": "https://stackoverflow.com/users/3353157/peter-camilleri"}, "is_accepted": false, "score": 3, "last_activity_date": 1531842290, "creation_date": 1531842290, "answer_id": 51385509, "question_id": 51384887, "link": "https://stackoverflow.com/questions/51384887/where-is-the-nilclass-singleton-instance-instantiated/51385509#51385509", "title": "Where is the &#39;NilClass&#39; singleton instance instantiated?", "body": "<p>In MRI at least, nil (as well as true and false) are special constants statically created in the \"C\" interpreter code.</p>\n\n<p>As such they are not created in the normal sense. Instead, its object id is a sort of marker for nil that is tested in the code as needed. While a bit chaotic, this would speed things up quite a bit.</p>\n\n<pre><code>/* special constants - i.e. non-zero and non-fixnum constants */\n405 enum ruby_special_consts {\n406 #if USE_FLONUM\n407     RUBY_Qfalse = 0x00,         /* ...0000 0000 */\n408     RUBY_Qtrue  = 0x14,         /* ...0001 0100 */\n409     RUBY_Qnil   = 0x08,         /* ...0000 1000 */\n410     RUBY_Qundef = 0x34,         /* ...0011 0100 */\n411 \n412     RUBY_IMMEDIATE_MASK = 0x07,\n413     RUBY_FIXNUM_FLAG    = 0x01, /* ...xxxx xxx1 */\n414     RUBY_FLONUM_MASK    = 0x03,\n415     RUBY_FLONUM_FLAG    = 0x02, /* ...xxxx xx10 */\n416     RUBY_SYMBOL_FLAG    = 0x0c, /* ...0000 1100 */\n417 #else\n418     RUBY_Qfalse = 0,            /* ...0000 0000 */\n419     RUBY_Qtrue  = 2,            /* ...0000 0010 */\n420     RUBY_Qnil   = 4,            /* ...0000 0100 */\n421     RUBY_Qundef = 6,            /* ...0000 0110 */\n422 \n423     RUBY_IMMEDIATE_MASK = 0x03,\n424     RUBY_FIXNUM_FLAG    = 0x01, /* ...xxxx xxx1 */\n425     RUBY_FLONUM_MASK    = 0x00, /* any values ANDed with FLONUM_MASK cannot be FLONUM_FLAG */\n426     RUBY_FLONUM_FLAG    = 0x02,\n427     RUBY_SYMBOL_FLAG    = 0x0e, /* ...0000 1110 */\n428 #endif\n429     RUBY_SPECIAL_SHIFT  = 8\n430 };\n</code></pre>\n"}], "owner": {"reputation": 354, "user_id": 2289501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/647f15f7859430b4537a3350d074434b?s=128&d=identicon&r=PG&f=1", "display_name": "reguilon", "link": "https://stackoverflow.com/users/2289501/reguilon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 1, "accepted_answer_id": 51385470, "answer_count": 3, "score": 2, "last_activity_date": 1531890017, "creation_date": 1531840356, "last_edit_date": 1531890017, "question_id": 51384887, "link": "https://stackoverflow.com/questions/51384887/where-is-the-nilclass-singleton-instance-instantiated", "title": "Where is the &#39;NilClass&#39; singleton instance instantiated?", "body": "<p>I would like to know where the <code>nil</code> singleton object is instantiated in the Ruby source code.</p>\n\n<p>Any thoughts?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1531838543, "post_id": 51384160, "comment_id": 89740422, "body": "why not persist this attribute as column in your database and then query on it? You can only query on sql columns using ActiveRecord, not on computed values."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1531839896, "post_id": 51384160, "comment_id": 89741359, "body": "This is a totally a side note to your question, but I would suggest using column names like <code>leaves_at</code> instead of <code>leave_date</code>. Column names ending <code>_at</code> are, by convention, <code>datetime</code> fields, whereas columns ending <code>_on</code> are, by conention, <code>date</code> fields. Your <code>leave_date</code> column is actually a <code>datetime</code>, which is therefore a confusing name. If it <i>was</i> a <code>date</code> field, I would call it <code>leaves_on</code>."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1531840053, "post_id": 51384160, "comment_id": 89741456, "body": "Similarly, you could have a new column: <code>delivery_at</code>, which is computed <b>and persisted</b> when the record is saved. You could then perform the above query in SQL, exactly how you normally would."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1531840169, "post_id": 51384160, "comment_id": 89741517, "body": "The only thing you need to be careful of, though, is if e.g. the <code>route.delivery_working_day_offset</code> can ever change -- in which case, you&#39;d need to recalculate the <code>delivery_at</code> on all associated <code>runs</code>."}], "answers": [{"tags": [], "owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "is_accepted": true, "score": 0, "last_activity_date": 1531838903, "last_edit_date": 1531838903, "creation_date": 1531838439, "answer_id": 51384215, "question_id": 51384160, "link": "https://stackoverflow.com/questions/51384160/date-range-search-using-where-on-instance-method/51384215#51384215", "title": "Date range search using .where on instance method", "body": "<p>You can use select method:</p>\n\n<pre><code>Run.all.select { |r| r.delivery_date.in?(date.beginning_of_day..date.end_of_day) }\n</code></pre>\n\n<p>But its not very efficient if you have lots of runs. </p>\n\n<p>I suggest to save delivery date data in table column called <code>delivery_date</code> and filter records on db side:</p>\n\n<pre><code>Run.where(delivery_date: date.beginning_of_day..date.end_of_day)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1531839650, "post_id": 51384422, "comment_id": 89741218, "body": "As mentioned above, note that this does not perform the query in SQL - and therefore does not scale; the performance will be terrible if the <code>runs</code> table grows large."}], "tags": [], "owner": {"reputation": 532, "user_id": 5841310, "user_type": "registered", "accept_rate": 47, "profile_image": "https://graph.facebook.com/10206848519343961/picture?type=large", "display_name": "Hubert Jakubiak", "link": "https://stackoverflow.com/users/5841310/hubert-jakubiak"}, "is_accepted": false, "score": 0, "last_activity_date": 1531839028, "creation_date": 1531839028, "answer_id": 51384422, "question_id": 51384160, "link": "https://stackoverflow.com/questions/51384160/date-range-search-using-where-on-instance-method/51384422#51384422", "title": "Date range search using .where on instance method", "body": "<pre><code>Run.all.select { |r| (date.beginning_of_day..date.end_of_day).include?(r.delivery_date) }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "is_accepted": false, "score": 0, "last_activity_date": 1531843847, "creation_date": 1531843847, "answer_id": 51385964, "question_id": 51384160, "link": "https://stackoverflow.com/questions/51384160/date-range-search-using-where-on-instance-method/51385964#51385964", "title": "Date range search using .where on instance method", "body": "<p>There are no chances to call a ruby method from a database query. Also, that has not any reason, because look same as ruby iteration. But you can write a simple similar function in a database query to your ruby method.\nTry something like this:</p>\n\n<pre><code>Run.joins(:routes)\n   .where(\"runs.leave_date + interval '1 day' * routes.delivery_working_day_offset BETWEEN ? AND ?', \n          date.beginning_of_day, date.end_of_day)\n</code></pre>\n\n<p>That example ignores the difference between weekend and business days. But there are too many examples of how to write business_days function in a database query.</p>\n\n<p>Easiest solution: save the delivery date to one of databases tables.</p>\n"}], "owner": {"reputation": 197, "user_id": 9446541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca77ea568f4a9f3a32d5ad3848d8dc85?s=128&d=identicon&r=PG&f=1", "display_name": "daveanderson88", "link": "https://stackoverflow.com/users/9446541/daveanderson88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 51384215, "answer_count": 3, "score": 0, "last_activity_date": 1531843847, "creation_date": 1531838274, "question_id": 51384160, "link": "https://stackoverflow.com/questions/51384160/date-range-search-using-where-on-instance-method", "title": "Date range search using .where on instance method", "body": "<p>I have a model (called Runs), here a 2 instances of it to show what it looks like:</p>\n\n<pre><code>&lt;Run id: 138, route_id: 1, leave_date: \"2018-07-17 08:00:00\", left: false, returned: false, created_at: \"2018-07-17 14:08:28\", updated_at: \"2018-07-17 14:08:28\", distance: nil, transport_time: nil&gt;\n&lt;Run id: 139, route_id: 1, leave_date: \"2018-07-18 09:00:00\", left: false, returned: false, created_at: \"2018-07-17 14:08:28\", updated_at: \"2018-07-17 14:08:28\", distance: nil, transport_time: nil&gt;\n</code></pre>\n\n<p>There is an instance method on the Run model (in run.rb) </p>\n\n<pre><code>  def delivery_date\n    (route.delivery_working_day_offset.to_i).business_days.after(leave_date)\n  end\n</code></pre>\n\n<p>which provides a datetime e.g:</p>\n\n<pre><code>Run.first.delivery_date\n</code></pre>\n\n<p>returns</p>\n\n<pre><code>Tue, 17 Jul 2018 09:00:00 UTC +00:00\n</code></pre>\n\n<p>I want to select Runs where the date matches a certain date, using a .where if possible.  Usually I would use something like the following, but it only works on attributes of the model (such as leave_date), but not instance methods (such as delivery_date):</p>\n\n<pre><code>Run.where('delivery_date BETWEEN ? AND ?', date.beginning_of_day, date.end_of_day)\n</code></pre>\n\n<p>How can I perform this selection?\nThanks very much in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-web-services", "amazon-kinesis"], "answers": [{"tags": [], "owner": {"reputation": 226, "user_id": 38739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85c7bf58c87e567ff7eba801b91423a4?s=128&d=identicon&r=PG", "display_name": "Dan Hodge", "link": "https://stackoverflow.com/users/38739/dan-hodge"}, "is_accepted": false, "score": 1, "last_activity_date": 1550788332, "creation_date": 1550788332, "answer_id": 54817275, "question_id": 51383774, "link": "https://stackoverflow.com/questions/51383774/aws-kinesis-stub-for-rspec/54817275#54817275", "title": "AWS Kinesis stub for RSpec", "body": "<p>You need to provide the kinesis client with response to for the describe_stream method.</p>\n\n<pre><code>kinesis.stub_responses(:describe_stream, stream_description: {})\n</code></pre>\n\n<p>Note that this will fail because it doesn't provide any of the required attributes in the stream_description, but the exception that it raises will tell you which attributes are required.</p>\n"}], "owner": {"reputation": 1, "user_id": 9906051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d3e31fe4d0f09f5997ee9891513d185?s=128&d=identicon&r=PG&f=1", "display_name": "Mazh N.", "link": "https://stackoverflow.com/users/9906051/mazh-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550788332, "creation_date": 1531837191, "question_id": 51383774, "link": "https://stackoverflow.com/questions/51383774/aws-kinesis-stub-for-rspec", "title": "AWS Kinesis stub for RSpec", "body": "<p>I'm writing spec for Rails app. And need to stub request from aws kinesis services. Here is code for stub in stub_helper</p>\n\n<pre><code>  def stub_kinesis_client\n    kinesis = Aws::Kinesis::Client.new(stub_responses: true)\n    kinesis.describe_stream(stream_name: 'demo_stream')\n  end\n</code></pre>\n\n<p>I got the issue: </p>\n\n<pre><code>NameError:\n       no member 'stream_description.has_more_shards' in struct\n</code></pre>\n\n<p>It's seems has_more_shards is not exist in mock response. Can you help?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-s3", "aws-sdk"], "answers": [{"comments": [{"owner": {"reputation": 6273, "user_id": 2392106, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/iXOIu.jpg?s=128&g=1", "display_name": "medBouzid", "link": "https://stackoverflow.com/users/2392106/medbouzid"}, "edited": false, "score": 1, "creation_date": 1531843414, "post_id": 51383829, "comment_id": 89743599, "body": "Thank you so much you saved me a lot of headache :)"}], "tags": [], "owner": {"reputation": 19714, "user_id": 1006863, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/sYOuq.jpg?s=128&g=1", "display_name": "Paulo Fidalgo", "link": "https://stackoverflow.com/users/1006863/paulo-fidalgo"}, "is_accepted": true, "score": 5, "last_activity_date": 1548325235, "last_edit_date": 1548325235, "creation_date": 1531837362, "answer_id": 51383829, "question_id": 51383634, "link": "https://stackoverflow.com/questions/51383634/how-to-delete-many-objects-at-once-using-ruby-aws-s3/51383829#51383829", "title": "how to delete many objects at once using ruby aws s3", "body": "<p>You can use <a href=\"https://docs.aws.amazon.com/sdk-for-ruby/v3/api/Aws/S3/Bucket.html#delete_objects-instance_method\" rel=\"nofollow noreferrer\" title=\"delete_objects\">delete_objects</a>\nAs the documentation example:</p>\n\n<pre><code>bucket.delete_objects({\n  delete: { # required\n    objects: [ # required\n      {\n        key: \"ObjectKey\", # required\n        version_id: \"ObjectVersionId\",\n      },\n    ],\n    quiet: false,\n  },\n  mfa: \"MFA\",\n  request_payer: \"requester\", # accepts requester\n})\n</code></pre>\n\n<p>so in your example:</p>\n\n<pre><code>bucket.delete_objects({\n delete:{\n  objects: [\n   {key: 'avatars/0b722c42-4003-42cc-887c-b820cad3aed9/avatar1.png'},\n   {key:'avatars/be1275f1-664f-4d47-9890-b5b2a066a18f/avatar2.jpg'}, \n   {key:'avatars/f5051ed2-b2e7-4844-bdc7-ca19c1900ce8/avatar3.gif}'\n  ]\n }\n})\n</code></pre>\n"}], "owner": {"reputation": 6273, "user_id": 2392106, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/iXOIu.jpg?s=128&g=1", "display_name": "medBouzid", "link": "https://stackoverflow.com/users/2392106/medbouzid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 757, "favorite_count": 0, "accepted_answer_id": 51383829, "answer_count": 1, "score": 3, "last_activity_date": 1548325235, "creation_date": 1531836774, "question_id": 51383634, "link": "https://stackoverflow.com/questions/51383634/how-to-delete-many-objects-at-once-using-ruby-aws-s3", "title": "how to delete many objects at once using ruby aws s3", "body": "<p>I can't find how to delete multiple objects at once using the <a href=\"https://github.com/aws/aws-sdk-ruby\" rel=\"nofollow noreferrer\">ruby aws sdk</a>, in the doc they have a code example on how to delete a folder that contains files :</p>\n\n<pre><code># batch operations, delete objects in batches of 1k\nbucket.objects(prefix: '/tmp-files/').delete\n</code></pre>\n\n<p>What am looking for is, providing files keys and delete them at once, something like this :</p>\n\n<pre><code>    bucket.objects(keys: [\n    'avatars/0b722c42-4003-42cc-887c-b820cad3aed9/avatar1.png',\n'avatars/be1275f1-664f-4d47-9890-b5b2a066a18f/avatar2.jpg', \n    'avatars/f5051ed2-b2e7-4844-bdc7-ca19c1900ce8/avatar3.gif'\n    ]).delete \n</code></pre>\n\n<p>Any idea ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "regex"], "answers": [{"tags": [], "owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 2, "last_activity_date": 1531836387, "last_edit_date": 1531836387, "creation_date": 1531836075, "answer_id": 51383378, "question_id": 51383325, "link": "https://stackoverflow.com/questions/51383325/how-to-match-a-regex-and-replace-in-middle-of-matched-result/51383378#51383378", "title": "How to match a regex and replace in middle of matched result", "body": "<p>You may use the following regex:</p>\n\n<pre><code>/(\\d)\\s*[-\\s]\\s*(\\d)/\n</code></pre>\n\n<p>and replace with <code>'\\1-\\2'</code>.</p>\n\n<p>See the <a href=\"https://regex101.com/r/cYCafR/1\" rel=\"nofollow noreferrer\">regex demo</a></p>\n\n<p><strong>Details</strong></p>\n\n<ul>\n<li><code>(\\d)</code> - Group 1 (later referenced to with the help of <code>\\1</code> replacement backreference from the string replacement pattern): any digit</li>\n<li><code>\\s*</code> - 0+ whitespaces</li>\n<li><code>[-\\s]</code> - one hyphen or whitespace</li>\n<li><code>\\s*</code> - 0+ whitespaces</li>\n<li><code>(\\d)</code> - Group 2 (later referenced to with the help of <code>\\2</code> replacement backreference): any digit.</li>\n</ul>\n\n<p>In your code, you may use it as </p>\n\n<pre><code>aadress_white_space_removed &lt;&lt; row.gsub(/\\s+/, ' ').gsub(/(\\d)\\s*[-\\s]\\s*(\\d)/, '\\1-\\2').strip.mb_chars.downcase.to_s\n</code></pre>\n"}], "owner": {"reputation": 386, "user_id": 7141412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ff78855b8cb85ac032aca87155063a5?s=128&d=identicon&r=PG&f=1", "display_name": "MysteriousNothing", "link": "https://stackoverflow.com/users/7141412/mysteriousnothing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 51383378, "answer_count": 1, "score": 0, "last_activity_date": 1531836387, "creation_date": 1531835907, "last_edit_date": 1592644375, "question_id": 51383325, "link": "https://stackoverflow.com/questions/51383325/how-to-match-a-regex-and-replace-in-middle-of-matched-result", "title": "How to match a regex and replace in middle of matched result", "body": "<p>How to match a regex and replace in middle of matched result</p>\n<p><strong>Example of faulty address:</strong></p>\n<blockquote>\n<p>My street address 8 -24</p>\n<p>My street address 8 24 (I need add dash between and result should be <strong>8-24</strong>)</p>\n<p>My - street address  8 -24 (should not remove - from &quot;My - street&quot;)</p>\n</blockquote>\n<p><strong>My current code</strong></p>\n<pre><code>address_as_array.each do |row|\n  aadress_white_space_removed &lt;&lt; row.gsub(/\\s+/, ' ').gsub(/\\s\\-/, '-').strip.mb_chars.downcase.to_s\nend\n</code></pre>\n"}, {"tags": ["html", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 469, "user_id": 4933446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cddb61a578ce2805e2f1ce9ef4cf1fe?s=128&d=identicon&r=PG", "display_name": "quazar", "link": "https://stackoverflow.com/users/4933446/quazar"}, "edited": false, "score": 0, "creation_date": 1531840723, "post_id": 51382983, "comment_id": 89741900, "body": "Put it as answer."}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 9910742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/063ab111f026dfae039a3c4de516c132?s=128&d=identicon&r=PG&f=1", "display_name": "nicks6853", "link": "https://stackoverflow.com/users/9910742/nicks6853"}, "is_accepted": true, "score": 0, "last_activity_date": 1531841710, "creation_date": 1531841710, "answer_id": 51385334, "question_id": 51382983, "link": "https://stackoverflow.com/questions/51382983/rails-renders-404-page-when-linking-to-pdf-file/51385334#51385334", "title": "Rails renders 404 page when linking to PDF file", "body": "<p>I feel like a complete idiot, my query for finding the Meeting's that matched my search term was wrong.</p>\n\n<p><strong>What I had</strong></p>\n\n<p><code>@meeting_results = Admin::Meeting.select(:agenda).where(\"meetings.agenda LIKE ? OR meetings.minutes LIKE ?\", \"%#{query}%\", \"%#{query}%\").distinct</code></p>\n\n<p><strong>What I replaced it with</strong></p>\n\n<p><code>@meeting_results = Admin::Meeting.where(\"meetings.agenda LIKE ? OR meetings.minutes LIKE ?\", \"%#{query}%\", \"%#{query}%\").distinct</code></p>\n\n<p>I had the wrong query due to a change I had made and decided not to go with it. Hope this maybe helps someone some day :(</p>\n"}], "owner": {"reputation": 26, "user_id": 9910742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/063ab111f026dfae039a3c4de516c132?s=128&d=identicon&r=PG&f=1", "display_name": "nicks6853", "link": "https://stackoverflow.com/users/9910742/nicks6853"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 51385334, "answer_count": 1, "score": 0, "last_activity_date": 1531841710, "creation_date": 1531834999, "last_edit_date": 1531841688, "question_id": 51382983, "link": "https://stackoverflow.com/questions/51382983/rails-renders-404-page-when-linking-to-pdf-file", "title": "Rails renders 404 page when linking to PDF file", "body": "<p><strong>The problem</strong></p>\n\n<p>I have this search function on my website, it works but for <code>Meetings</code>, and only <code>Meetings</code>, it doesn't. When I try to link to the pdf file that <code>Meeting</code> contains using <code>asset_path</code> I get the 404 page.</p>\n\n<p><strong>This is my Meeting model</strong></p>\n\n<pre><code>    class Admin::Meeting &lt; ApplicationRecord\n\n        # Image/File Uploader\n        mount_uploader :agenda, FileUploader\n        mount_uploader :minutes, FileUploader\n\n        has_many :meeting_translations, dependent: :destroy\n        accepts_nested_attributes_for :meeting_translations\n\n     end\n</code></pre>\n\n<p><strong>My file uploader looks like this, I use CarrierWave</strong></p>\n\n<pre><code>class FileUploader &lt; CarrierWave::Uploader::Base\n\n  # Include RMagick or MiniMagick support:\n  # require 'RMagick'\n\n  # include CarrierWave::RMagick\n  # include CarrierWave::MiniMagick\n\n  # before :cache, :setup_available_sizes\n  # before :cache\n\n  # Choose what kind of storage to use for this uploader:\n  storage :file\n  permissions 0777  \n  # storage :fog\n\n  # Override the directory where uploaded files will be stored.\n  # This is a sensible default for uploaders that are meant to be mounted:\n  def store_dir\n    \"uploads/#{model.class.name.demodulize.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\n\n  # Provide a default URL as a default if there hasn't been a file uploaded:\n  # def default_url(*args)\n  #   # For Rails 3.1+ asset pipeline compatibility:\n  #   # ActionController::Base.helpers.asset_path(\"fallback/\" + [version_name, \"default.png\"].compact.join('_'))\n  #\n  #   \"/images/fallback/\" + [version_name, \"default.png\"].compact.join('_')\n  # end\n\n  # Process files as they are uploaded:\n  # process scale: [200, 300]\n  #\n  # def scale(width, height)\n  #   # do something\n  # end\n\n  # Create different versions of your uploaded files:\n  # version :thumb do\n  #   process resize_to_fit: [200, 200]\n  # end\n\n  # Add a white list of extensions which are allowed to be uploaded.\n  # For images you might use something like this:\n  def extension_whitelist\n    %w(pdf doc docx xls xlsx)\n  end\n\n  def size_range\n    1..10.megabytes\n  end\n\nend\n</code></pre>\n\n<p><strong>This is my view where I try to link to <code>agenda</code> (<code>agenda</code> is a file)</strong></p>\n\n<pre><code>&lt;% @meeting_results.each do |result| %&gt;\n       &lt;% unless result.agenda.nil? %&gt;\n         &lt;div class=\"col-sm-12\"&gt;\n           &lt;div class=\"col-sm-1\"&gt;&lt;i class=\"far fa-file-pdf fa-2x\" aria-hidden=\"true\"&gt;&lt;/i&gt;&lt;/div&gt;\n             &lt;div class=\"col-sm-10\"&gt;\n               &lt;div class=\"results-link\"&gt;\n                 &lt;a href=\"&lt;%= asset_path result.agenda %&gt;\"&gt;&lt;%= result.agenda.file.original_filename %&gt;&lt;/a&gt;\n               &lt;/div&gt;\n             &lt;/div&gt;\n           &lt;/div&gt;\n        &lt;% end %&gt;\n      &lt;% end %&gt;\n</code></pre>\n\n<p><strong>This is the error I get</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/0qvfz.png\" rel=\"nofollow noreferrer\">404_error</a></p>\n\n<p>I usually don't have this problem when I link to PDFs, I don't know if it's because I also have another file called <code>minutes</code> for <code>Meeting</code>? Anyways, any help is appreciated, thanks.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>I also noticed that the path returned from asset_path does not contain the <code>Meeting</code>s ID. This is the path it gives me<code>uploads/meeting/agenda/Bathurst_Regular_Public_Meeting_Agenda_May_15-2017.pdf</code> when the file is really located in <code>uploads/meeting/agenda/ID/Bathurst_Regular_Public_Meeting_Agenda_May_15-2017.pdf</code></p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 0, "last_activity_date": 1531835438, "last_edit_date": 1531835438, "creation_date": 1531834744, "answer_id": 51382873, "question_id": 51382756, "link": "https://stackoverflow.com/questions/51382756/ruby-inject-condition/51382873#51382873", "title": "Ruby inject condition", "body": "<p>I commend you for attempting to solve this before posting, but you made it unnecessarily complicated. I'd write it like this:</p>\n\n<pre><code>students.select{|student| student['study_results'].values.count(1) &gt;= 2}\n</code></pre>\n\n<p>That's all, no need for <code>inject</code>. You were misusing it here. </p>\n\n<p>Ruby collections have TONS of useful methods. If you find yourself using <code>inject</code> or <code>each</code>, there's a better method for this, 90% of the time.</p>\n\n<h3>Explanation:</h3>\n\n<pre><code>student['study_results'] # =&gt; {\"CAR\"=&gt;1, \"PR1\"=&gt;1, \"MA1\"=&gt;1, \"BEN\"=&gt;2, \"SDP\"=&gt;nil}\nstudent['study_results'].values # =&gt; [1, 1, 1, 2, nil]\nstudent['study_results'].values.count(1) # =&gt; 3\nstudent['study_results'].values.count(2) # =&gt; 1\nstudent['study_results'].values.count(3) # =&gt; 0\nstudent['study_results'].values.count(nil) # =&gt; 1\n</code></pre>\n\n<h3>Documentation</h3>\n\n<ul>\n<li><a href=\"https://ruby-doc.org/core-2.5.1/Hash.html#method-i-values\" rel=\"nofollow noreferrer\">Hash#values</a></li>\n<li><a href=\"https://ruby-doc.org/core-2.5.1/Array.html#method-i-count\" rel=\"nofollow noreferrer\">Array#count</a></li>\n</ul>\n"}], "owner": {"reputation": 169, "user_id": 9681020, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Spasitel", "link": "https://stackoverflow.com/users/9681020/spasitel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 51382873, "answer_count": 1, "score": 0, "last_activity_date": 1531890285, "creation_date": 1531834421, "last_edit_date": 1531890285, "question_id": 51382756, "link": "https://stackoverflow.com/questions/51382756/ruby-inject-condition", "title": "Ruby inject condition", "body": "<p>I have an array filled with hashes. The data structure looks like this:</p>\n\n<pre><code>students = [\n  {\n    \"first_name\" =&gt; \"James\",\n    \"last_name\" =&gt; \"Sullivan\",\n    \"age\" =&gt; 20,\n    \"study_results\" =&gt; {\"CAR\" =&gt; 1, \"PR1\" =&gt; 1, \"MA1\" =&gt; 1, \"BEN\" =&gt; 2, \"SDP\" =&gt; nil}\n  }\n]\n</code></pre>\n\n<p>I want to find students with the mark <code>1</code> from at least two subjects.</p>\n\n<p>I tried to convert the hash with marks into an array and then use the <code>inject</code> method to count the number of <code>1</code> and find out if the number is <code>&gt; 1</code>:</p>\n\n<pre><code>students.select{|student\n  (\n    (student[\"study_results\"].to_a)\n    .inject(0){|sum, x| sum += 1 if x.include?(1)}\n  ) &gt; 1\n}\n</code></pre>\n\n<p>Is there any way to put a condition into the method, or should I find a different way to solve it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "caching", "activerecord"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 2, "creation_date": 1531834360, "post_id": 51382148, "comment_id": 89737267, "body": "<code>cache_classes</code> defined if your applications source code is reloaded on each request. This has nothing to data caching. Can you please explain which cache exactly you want to clear (data, query, code) and will you need to do that?"}, {"owner": {"reputation": 89, "user_id": 9983784, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8q0-Lvs_SMY/AAAAAAAAAAI/AAAAAAAAAm8/AqeCcVqDFxQ/photo.jpg?sz=128", "display_name": "Pedro Furtado", "link": "https://stackoverflow.com/users/9983784/pedro-furtado"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1531843281, "post_id": 51382148, "comment_id": 89743528, "body": "@spickermann I want to clear the cache of code (Ruby code) of classes. In my case, clear the cache of code of a specific ActiveRecord Model (because clear ALL cache make a huge impact on page load and request time of application)."}, {"owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "edited": false, "score": 0, "creation_date": 1531851079, "post_id": 51382148, "comment_id": 89747546, "body": "@PedroFurtado. Wow. Rails.cache.clear not related to code reloading. It does not refresh code. So, you want something like <code>load &quot;#{Rails.root}&#47;app&#47;models&#47;category.rb&quot;</code>. But beware that doing this may cause errors in production environment. If You use several rails instances, that code would reload the class only on one!"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1531835612, "post_id": 51383127, "comment_id": 89738221, "body": "your two lines are the same"}], "tags": [], "owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "is_accepted": false, "score": 0, "last_activity_date": 1531835689, "last_edit_date": 1531835689, "creation_date": 1531835379, "answer_id": 51383127, "question_id": 51382148, "link": "https://stackoverflow.com/questions/51382148/how-to-clear-rails-class-cache-for-a-specific-class-activerecord-model/51383127#51383127", "title": "How to clear Rails class cache for a specific class (ActiveRecord Model)?", "body": "<pre><code>Rails.cache.delete(\"/posts\") # for model Post\nRails.cache.delete(\"/posts/id\") # for single post\n</code></pre>\n\n<p>For clear <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/QueryCache.html#method-i-clear_query_cache\" rel=\"nofollow noreferrer\">all database query</a>:</p>\n\n<pre><code>ActiveRecord::Base.connection.query_cache.clear\n</code></pre>\n\n<blockquote>\n  <p>One reason you may wish to call this method explicitly is between queries that ask the database to randomize results. Otherwise the cache would see the same SQL query and repeatedly return the same result each time, silently undermining the randomness you were expecting.</p>\n</blockquote>\n"}], "owner": {"reputation": 89, "user_id": 9983784, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8q0-Lvs_SMY/AAAAAAAAAAI/AAAAAAAAAm8/AqeCcVqDFxQ/photo.jpg?sz=128", "display_name": "Pedro Furtado", "link": "https://stackoverflow.com/users/9983784/pedro-furtado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1104, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1531835689, "creation_date": 1531832677, "question_id": 51382148, "link": "https://stackoverflow.com/questions/51382148/how-to-clear-rails-class-cache-for-a-specific-class-activerecord-model", "title": "How to clear Rails class cache for a specific class (ActiveRecord Model)?", "body": "<p>When I type <code>Rails.cache.clear</code> ALL the cache made by Rails is cleared. But in my production environment, I set in <code>config/environments/production.rb</code> the configuration <code>config.cache_classes = true</code>.\nBut, sometimes, I need to clear cache of a specific class (in my case, a specific ActiveRecord model), not all.</p>\n\n<p>How do I clear the Rails cache made for a specific ActiveRecord Model?</p>\n"}, {"tags": ["arrays", "ruby", "linux"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1531830332, "post_id": 51381235, "comment_id": 89734358, "body": "What is the current (exact) output?"}, {"owner": {"reputation": 420, "user_id": 3688882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e85ec0df72266e1ce32f773012e823f9?s=128&d=identicon&r=PG&f=1", "display_name": "tonio94", "link": "https://stackoverflow.com/users/3688882/tonio94"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1531830684, "post_id": 51381235, "comment_id": 89734637, "body": "Message edited."}], "answers": [{"comments": [{"owner": {"reputation": 420, "user_id": 3688882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e85ec0df72266e1ce32f773012e823f9?s=128&d=identicon&r=PG&f=1", "display_name": "tonio94", "link": "https://stackoverflow.com/users/3688882/tonio94"}, "edited": false, "score": 0, "creation_date": 1531841756, "post_id": 51381829, "comment_id": 89742582, "body": "Wow thank you very much! it works. At the end I return all the values like this :  return {    components: libs_with_versions,    hdp_version: Facter::Core::Execution.execute(&#39;/usr/bin/hdp-select versions | tail -1&#39;),    sqoop: File.exist?(&#39;/etc/sqoop&#39;), } Could you explain me this : libs.each_line.with_object({}), especially the ({}) ? Thanks"}], "tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": true, "score": 2, "last_activity_date": 1531831759, "creation_date": 1531831759, "answer_id": 51381829, "question_id": 51381235, "link": "https://stackoverflow.com/questions/51381235/ruby-store-in-array-and-return-all-values/51381829#51381829", "title": "Ruby - store in array and return all values", "body": "<p>Considering you have such an output, you just need to iterate every line in the output, split the line by <code>\" - \"</code> and store it in the result hash:</p>\n\n<pre><code>libs = \"sqoop-client - 2.6.4.0-91\\n\" \\\n\"sqoop-server - 2.6.4.0-91\\n\" \\\n\"storm-slider-client - 2.6.4.0-91\\n\" \\\n\"tez-client - 2.6.4.0-91\\n\" \\\n\"zookeeper-client - 2.6.4.0-91\\n\" \\\n\"zookeeper-server - 2.6.4.0-91\\n\"\n\nlibs_with_versions = libs.each_line.with_object({}) do |line, result|\n  lib, version = line.strip.split(\" - \")\n  result[lib] = version\nend\n\nputs libs_with_versions\n</code></pre>\n\n<p>returns:</p>\n\n<pre><code>{\n   \"sqoop-client\" =&gt; \"2.6.4.0-91\",\n   \"sqoop-server\" =&gt; \"2.6.4.0-91\",\n   \"storm-slider-client\" =&gt; \"2.6.4.0-91\",\n   \"tez-client\" =&gt; \"2.6.4.0-91\",\n   \"zookeeper-client\" =&gt; \"2.6.4.0-91\",\n   \"zookeeper-server\"=&gt;\"2.6.4.0-91\"\n}\n</code></pre>\n"}], "owner": {"reputation": 420, "user_id": 3688882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e85ec0df72266e1ce32f773012e823f9?s=128&d=identicon&r=PG&f=1", "display_name": "tonio94", "link": "https://stackoverflow.com/users/3688882/tonio94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 51381829, "answer_count": 1, "score": 0, "last_activity_date": 1531831759, "creation_date": 1531829984, "last_edit_date": 1531830648, "question_id": 51381235, "link": "https://stackoverflow.com/questions/51381235/ruby-store-in-array-and-return-all-values", "title": "Ruby - store in array and return all values", "body": "<p>So I have a shell command with this kind of output :</p>\n\n<pre><code>sqoop-client - 2.6.4.0-91\nsqoop-server - 2.6.4.0-91\nstorm-slider-client - 2.6.4.0-91\ntez-client - 2.6.4.0-91\nzookeeper-client - 2.6.4.0-91\nzookeeper-server - 2.6.4.0-91\n</code></pre>\n\n<p>I want to store this output (service name &amp; service version) in an array then return all the objects.</p>\n\n<p>At this moment in my code I already return some fixed values like that :</p>\n\n<pre><code>#code :\n\n return {\n   hdp_version: Facter::Core::Execution.execute('/usr/bin/hdp-select versions | tail -1'),\n   sqoop: File.exist?('/etc/sqoop'),\n }\n\n#output :\n{\n  hdp_version =&gt; \"2.6.4.0-91\",\n  sqoop =&gt; false\n}\n</code></pre>\n\n<p>How can I store the output from the shell command in a 2D array and parse all the values to return them like the example above? </p>\n\n<p>Like this (but in a loop):</p>\n\n<pre><code>obj[0][0] : obj[0][1], \nobj[1][0] : obj[1][1],\n[...]\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "is_accepted": false, "score": 3, "last_activity_date": 1531827249, "creation_date": 1531827249, "answer_id": 51380367, "question_id": 51380168, "link": "https://stackoverflow.com/questions/51380168/set-custom-message-in-each-different-error-validation-in-ruby-on-rails/51380367#51380367", "title": "set custom message in each different error validation in ruby on rails", "body": "<p>You can pass <code>message</code> in separate hashes for each validator:</p>\n\n<pre><code>validates :tel,\n          presence: { message: 'is needed' },\n          length: { minimum: 10, maximum: 11, too_long: 'is too long' },\n          numericality: { only_integer: true, message: 'must be numeric' }\n</code></pre>\n\n<p>Read more about <a href=\"http://guides.rubyonrails.org/active_record_validations.html#presence\" rel=\"nofollow noreferrer\">presence</a>, <a href=\"http://guides.rubyonrails.org/active_record_validations.html#length\" rel=\"nofollow noreferrer\">length</a>, and <a href=\"http://guides.rubyonrails.org/active_record_validations.html#numericality\" rel=\"nofollow noreferrer\">numericality</a> validators.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7277957"}, "is_accepted": false, "score": 1, "last_activity_date": 1531831978, "last_edit_date": 1531831978, "creation_date": 1531827265, "answer_id": 51380373, "question_id": 51380168, "link": "https://stackoverflow.com/questions/51380168/set-custom-message-in-each-different-error-validation-in-ruby-on-rails/51380373#51380373", "title": "set custom message in each different error validation in ruby on rails", "body": "<p>One way to do this is to define methods for each type of validation (in your model) like this:</p>\n\n<pre><code>validate :chech_length\n\ndef chech_length\n  if tel.length &lt; 10 || tel.length &gt; 11\n\n      errors.add(:base, \"tel is too long!\") \n   end\nend\n\n\n\nvalidate :check_if_present\n\ndef check_if_present\n\n  if tel.blank?\n     errors.add(:base, \"tel must be present!\")\n  end\nend\n</code></pre>\n\n<p>etc...</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 87, "user_id": 3702199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbf06ca844c89bada71ac9d092026a9?s=128&d=identicon&r=PG&f=1", "display_name": "Ferdinand", "link": "https://stackoverflow.com/users/3702199/ferdinand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 675, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1531833055, "creation_date": 1531826653, "last_edit_date": 1531833055, "question_id": 51380168, "link": "https://stackoverflow.com/questions/51380168/set-custom-message-in-each-different-error-validation-in-ruby-on-rails", "title": "set custom message in each different error validation in ruby on rails", "body": "<p>let say that I have set in model for validation like this</p>\n\n<pre><code>validates :tel, presence: true , length: { minimum: 10,  maximum: 11 }, numericality: { only_integer: true }\n</code></pre>\n\n<p>how do I can display a custom message in view for each validate.</p>\n\n<p>when I set this in views page.</p>\n\n<pre><code>&lt;% if @diary.errors.include?(:tel) %&gt;    \n      &lt;div class=\"err\"&gt;&lt;p&gt;&lt;%= @diary.errors.full_messages_for(:tel).join(\"\") %&gt;&lt;/p&gt;&lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>it directly displays all error message. I want to make a display in view like this</p>\n\n<pre><code>if(error_require)\n   echo \"tel is needed\"\nelse if(error_length)\n   echo \"tel is to long\"\nelse \n   echo \"tel must numeric\"\nend\n</code></pre>\n\n<p>can I make like that?</p>\n"}, {"tags": ["ruby", "exception", "try-catch"], "answers": [{"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 7, "last_activity_date": 1531825531, "last_edit_date": 1531825531, "creation_date": 1531824854, "answer_id": 51379625, "question_id": 51379520, "link": "https://stackoverflow.com/questions/51379520/what-type-of-exception-does-rescue-e-captures/51379625#51379625", "title": "What type of exception does rescue =&gt; e captures?", "body": "<p>If you don't specify an exception filter, <a href=\"http://ruby-doc.org/core/Exception.html\" rel=\"nofollow noreferrer\">the implicit default is <code>StandardError</code> (scroll down to the bulleted list of default exceptions, it lists the defaults for both <code>rescue</code> and <code>raise</code>)</a>. This also applies to the trailing \"inline\" <code>rescue</code> modifier, whose syntax doesn't allow to specify an exception filter at all:</p>\n\n<pre><code>foo rescue bar\n# always implicitly rescues StandardError\n</code></pre>\n\n<p>Not all <a href=\"http://ruby-doc.org/core/Exception.html\" rel=\"nofollow noreferrer\"><code>Exception</code></a>s inherit from <a href=\"http://ruby-doc.org/core/StandardError.html\" rel=\"nofollow noreferrer\"><code>StandardError</code></a>, so this will not rescue <em>all</em> exceptions, but it will rescue all that can be sensibly rescued. Exceptions that don't inherit from <code>StandardError</code> are usually ones that are <em>so</em> severe or that point to a problem inside the execution engine, that user code cannot recover from them in a sensible way. For example, an out-of-memory-error or an internal error inside the VM.</p>\n\n<p><a href=\"http://ruby-doc.org/core/SystemStackError.html\" rel=\"nofollow noreferrer\"><code>SystemStackError</code></a> is an example of an exception that doesn't really make sense to handle in user code. If the stack is exhausted, you cannot make any more method calls, but it is pretty much impossible to do anything in Ruby <em>at all</em> without making a method call. Plus, a stack overflow is usually a programming error, you need to fix the error, not the symptom.</p>\n\n<p>Note that such a \"catch-all\" exception handling is usually frowned upon. You should be as narrow as possible in your exception specification and maybe even examine the exception object inside your <code>rescue</code> block to make sure that the exception you got is really the one you want to handle. Very broad catch-all exception specifications have the risk that you will rescue exceptions that you don't know how to handle.</p>\n"}], "owner": {"reputation": 4688, "user_id": 6241184, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1022848011119215/picture?type=large", "display_name": "Vinicius Brasil", "link": "https://stackoverflow.com/users/6241184/vinicius-brasil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 573, "favorite_count": 0, "accepted_answer_id": 51379625, "answer_count": 1, "score": 2, "last_activity_date": 1531826236, "creation_date": 1531824559, "last_edit_date": 1531826236, "question_id": 51379520, "link": "https://stackoverflow.com/questions/51379520/what-type-of-exception-does-rescue-e-captures", "title": "What type of exception does rescue =&gt; e captures?", "body": "<p>In Ruby, you can capture exceptions using <code>rescue =&gt; e</code>, without explicitly passing any type of exception such as <code>rescue CustomException =&gt; e</code>.</p>\n\n<p>I can tell it doesn't capture every exception, because:</p>\n\n<pre><code>def foo\n  foo\nrescue =&gt; e\n  puts \"It never reaches this block\"\nend\n\nfoo\n</code></pre>\n\n<p>This infinite loop never gets captured, and it raises a <code>SystemStackError</code>.</p>\n\n<p>What type of exception does <code>rescue =&gt; e</code> captures?</p>\n"}, {"tags": ["javascript", "html", "ruby-on-rails", "ruby", "editor"], "answers": [{"tags": [], "owner": {"reputation": 469, "user_id": 8131568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/74574f8166af2d3b451365dee39100af?s=128&d=identicon&r=PG&f=1", "display_name": "snack_overflow", "link": "https://stackoverflow.com/users/8131568/snack-overflow"}, "is_accepted": false, "score": 1, "last_activity_date": 1531824629, "creation_date": 1531824629, "answer_id": 51379542, "question_id": 51379485, "link": "https://stackoverflow.com/questions/51379485/html-how-to-add-an-editor-for-an-input-text-field/51379542#51379542", "title": "Html -- How to add an editor for an input text field?", "body": "<p>The most popular is TinyMCE. You can implement it easily and it is pure HTML, for your part at least. </p>\n\n<p><a href=\"https://www.tiny.cloud/\" rel=\"nofollow noreferrer\">https://www.tiny.cloud/</a></p>\n"}, {"tags": [], "owner": {"reputation": 161, "user_id": 8641317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bddbde3d55d7b930e07dda00817fb107?s=128&d=identicon&r=PG&f=1", "display_name": "Fedor", "link": "https://stackoverflow.com/users/8641317/fedor"}, "is_accepted": false, "score": 0, "last_activity_date": 1531825454, "creation_date": 1531825454, "answer_id": 51379816, "question_id": 51379485, "link": "https://stackoverflow.com/questions/51379485/html-how-to-add-an-editor-for-an-input-text-field/51379816#51379816", "title": "Html -- How to add an editor for an input text field?", "body": "<p>Does yout need lightweight WYSIWYG editor? If yes, try to choose any <strong>lightweight</strong> editor <a href=\"https://github.com/cheeaun/mooeditable/wiki/Javascript-WYSIWYG-editors\" rel=\"nofollow noreferrer\">from this list</a>\nAlso I find out related <a href=\"https://stackoverflow.com/questions/12172054/pure-html-5-wysiwyg-editor\">question</a>.</p>\n"}], "owner": {"reputation": 37, "user_id": 9970746, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EcTeoxuR1Hc/AAAAAAAAAAI/AAAAAAAAAAc/AyTecg_yrnA/photo.jpg?sz=128", "display_name": "Shao Kahn", "link": "https://stackoverflow.com/users/9970746/shao-kahn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1754, "favorite_count": 0, "closed_date": 1617779659, "answer_count": 2, "score": 0, "last_activity_date": 1531825454, "creation_date": 1531824464, "last_edit_date": 1531824714, "question_id": 51379485, "link": "https://stackoverflow.com/questions/51379485/html-how-to-add-an-editor-for-an-input-text-field", "closed_reason": "Not suitable for this site", "title": "Html -- How to add an editor for an input text field?", "body": "<p>I know there has too many JS libraries can do this, such as: Trumbowyg, etc.</p>\n\n<p>But before my rails project renders that slim, must escape javascript! </p>\n\n<p>So, I must make an editor which is made up of pure Html or Ruby. But how to make?</p>\n\n<p>(Note: pure Html and Ruby!)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "ancestry"], "comments": [{"owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "edited": false, "score": 0, "creation_date": 1531834234, "post_id": 51379408, "comment_id": 89737183, "body": "What must <code>self.parent_id= self.read_attribute(:parent_id) + &#39;&#47;&#39; + parent.read_attribute(:parent_id)</code> do? Did this method realy change position of any element? <code>ancestry</code> auto rebuild hierarchy and that code equal to <code>self.parent_id= self.read_attribute(:parent_id) </code> because parent_id is int and <code>&#39;id&#47;some_id&#47;other_id&#39;.to_i == id</code>. So, that does nothing."}, {"owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "edited": false, "score": 0, "creation_date": 1531834643, "post_id": 51379408, "comment_id": 89737481, "body": "Why not just <code>self.update(parent_id: parent.parent_id</code>)? Also, there parameter <code>parent</code> overlaps attribute <code>parent</code> from <code>ancestry</code>."}], "owner": {"reputation": 6929, "user_id": 1262519, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/zvPMu.jpg?s=128&g=1", "display_name": "Sachin Singh", "link": "https://stackoverflow.com/users/1262519/sachin-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1531824231, "creation_date": 1531824231, "question_id": 51379408, "link": "https://stackoverflow.com/questions/51379408/change-parent-of-existing-node-that-has-children", "title": "Change parent of existing node that has children", "body": "<p>I am using rails 5 with ancestry gem. I have a Group model, and its records are already arranged in a tree. Now I pick up a group randomly which has children and try to change it's parent_id. The group object gets saved but the tree structure does not change as expected i.e. only one node gets moved not its children. Here is my code:</p>\n\n<pre><code>  def change_hierarchy(parent)\n    if valid_move?(parent)\n      self.parent_id= self.read_attribute(:parent_id) + '/' + parent.read_attribute(:parent_id)\n      self.save\n      true\n    else\n      false\n    end\n  end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "database", "prefix", "zero"], "comments": [{"owner": {"reputation": 7359, "user_id": 599989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d752d2574aeb36bc66471f4d0f8811aa?s=128&d=identicon&r=PG", "display_name": "Bijendra", "link": "https://stackoverflow.com/users/599989/bijendra"}, "edited": false, "score": 1, "creation_date": 1531823118, "post_id": 51378958, "comment_id": 89729502, "body": "saving as string will work if you are fine"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 3, "creation_date": 1531823222, "post_id": 51378958, "comment_id": 89729579, "body": "Account numbers are not essentially numbers. You might want to store them as strings."}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 0, "creation_date": 1531823679, "post_id": 51378958, "comment_id": 89729876, "body": "This reminds me of questions asking why their hex numbers keep reverting to integers. :)"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1531823963, "post_id": 51378958, "comment_id": 89730044, "body": "You <i>can&#39;t</i> store a numeric field with leading zeros. <code>123 == 0123 == 00123 == 000123 == ...</code>. Use a String: <code>&quot;123&quot; != &quot;0123&quot; != &quot;00123&quot; != &quot;000123&quot; != ...</code>"}], "answers": [{"tags": [], "owner": {"reputation": 73, "user_id": 4393476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JxEG0.jpg?s=128&g=1", "display_name": "Alexander Zagaynov", "link": "https://stackoverflow.com/users/4393476/alexander-zagaynov"}, "is_accepted": false, "score": 0, "last_activity_date": 1531823150, "creation_date": 1531823150, "answer_id": 51379060, "question_id": 51378958, "link": "https://stackoverflow.com/questions/51378958/how-to-save-leading-zeroes-zeroes-in-prefix-to-a-number-field-in-ruby-on-rai/51379060#51379060", "title": "How to save leading zeroes (zeroes in prefix), to a number field, in ruby on rails?", "body": "<p>Looks like your <code>account_no</code> field is numeric in database.\nYou can make migration to make it string.</p>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1531834053, "post_id": 51379085, "comment_id": 89737038, "body": "I&#39;ve seen people store phone numbers as integers. :facepalm:"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1531834142, "post_id": 51379085, "comment_id": 89737112, "body": "But yeah, I was going to post this rule of thumb. I&#39;ll upvote yours  instead. :)"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 5, "last_activity_date": 1531823207, "creation_date": 1531823207, "answer_id": 51379085, "question_id": 51378958, "link": "https://stackoverflow.com/questions/51378958/how-to-save-leading-zeroes-zeroes-in-prefix-to-a-number-field-in-ruby-on-rai/51379085#51379085", "title": "How to save leading zeroes (zeroes in prefix), to a number field, in ruby on rails?", "body": "<p>The answer is pretty simple: A bank account number might look like a number but it shouldn't be stored in as an integer. Use a string column instead.</p>\n\n<p>The rule of thumb is: Do not use integer columns for numbers when math doesn't make sense on that number type - like account numbers, postal codes, serial numbers</p>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1531833985, "post_id": 51382519, "comment_id": 89736982, "body": "Ah, careful there. <code>.to_i</code> does the right thing, but, say, <code>Integer(&#39;0000123&#39;)</code> does <b>another</b> right thing."}], "tags": [], "owner": {"reputation": 13, "user_id": 8914978, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ycLLHSOAFXg/AAAAAAAAAAI/AAAAAAAAAC0/5xOmcOXAv8k/photo.jpg?sz=128", "display_name": "Yevhen Radionov", "link": "https://stackoverflow.com/users/8914978/yevhen-radionov"}, "is_accepted": false, "score": 0, "last_activity_date": 1531833748, "creation_date": 1531833748, "answer_id": 51382519, "question_id": 51378958, "link": "https://stackoverflow.com/questions/51378958/how-to-save-leading-zeroes-zeroes-in-prefix-to-a-number-field-in-ruby-on-rai/51382519#51382519", "title": "How to save leading zeroes (zeroes in prefix), to a number field, in ruby on rails?", "body": "<p>It is better to string type for <code>account_no</code> column. Then you can use <code>.to_i</code> to convert <code>'0000123'</code> to <code>123</code> if you need.</p>\n"}], "owner": {"reputation": 1044, "user_id": 4929150, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/1f9a6a13c0a52d12b585ab8a36e68acb?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/4929150/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1531833748, "creation_date": 1531822872, "last_edit_date": 1531823174, "question_id": 51378958, "link": "https://stackoverflow.com/questions/51378958/how-to-save-leading-zeroes-zeroes-in-prefix-to-a-number-field-in-ruby-on-rai", "title": "How to save leading zeroes (zeroes in prefix), to a number field, in ruby on rails?", "body": "<p>I have an integer field(bank account number). while saving it in rails, if it's containing any preceeding zero'es, then the zeroes are getting trimmed (removed) by rails automatically like below.</p>\n\n<pre><code>.gems :086 &gt; bank_detail = BankDetail.new\n =&gt; #&lt;BankDetail id: nil, account_name: nil, account_no: nil, bank_name: nil, branch_name: nil, ifsc_code: nil, user_id: nil, created_at: nil, updated_at: nil&gt; \n.gems :087 &gt; bank_detail.account_no = \"0123456\"\n =&gt; \"0123456\" \n.gems :089 &gt; bank_detail.save(:validate =&gt; false)\n   (0.2ms)  BEGIN\n  SQL (0.5ms)  INSERT INTO \"bank_details\" (\"account_no\", \"created_at\", \"updated_at\") VALUES ($1, $2, $3) RETURNING \"id\"  [[\"account_no\", 123456], [\"created_at\", \"2018-07-17 15:47:35.062139\"], [\"updated_at\", \"2018-07-17 15:47:35.062139\"]]\n   (22.7ms)  COMMIT\n =&gt; true \n.gems :090 &gt; \n.gems :090 &gt; BankDetail.last\n  BankDetail Load (0.6ms)  SELECT  \"bank_details\".* FROM \"bank_details\"  ORDER BY \"bank_details\".\"id\" DESC LIMIT 1\n =&gt; #&lt;BankDetail id: 21, account_name: nil, account_no: 123456, bank_name: nil, branch_name: nil, ifsc_code: nil, user_id: nil, created_at: \"2018-07-17 10:17:35\", updated_at: \"2018-07-17 10:17:35\"&gt; \n.gems :091 &gt; \n</code></pre>\n\n<p><strong>As the bank account number contains leading zeroes,i want to make rails to save the number field, along with the prefixed zeroes. how can i do that?</strong></p>\n"}, {"tags": ["ruby", "rspec", "chef-infra"], "comments": [{"owner": {"reputation": 1365, "user_id": 4894399, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tY1Cz7EDNxc/AAAAAAAAAAI/AAAAAAAABb4/3Qa15VP4_ZY/photo.jpg?sz=128", "display_name": "Szymon Szypulski", "link": "https://stackoverflow.com/users/4894399/szymon-szypulski"}, "edited": false, "score": 0, "creation_date": 1531848300, "post_id": 51376609, "comment_id": 89746159, "body": "Have you tried to put whole control inside <code>if</code> statement?"}], "answers": [{"tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": true, "score": 1, "last_activity_date": 1531855870, "creation_date": 1531855870, "answer_id": 51388946, "question_id": 51376609, "link": "https://stackoverflow.com/questions/51376609/how-to-check-for-node-version-in-control-statements-within-recipes/51388946#51388946", "title": "How to check for node version in control statements within recipes", "body": "<p>1) The in-recipe audit feature is deprecated and you should switch over to the <code>audit</code> cookbook instead.</p>\n\n<p>2) Wrap the whole thing with <code>if node[:platform_family][:platform_version].to_i != '6' ... end</code> or similar.</p>\n"}], "owner": {"reputation": 68, "user_id": 7766345, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OAnQe.jpg?s=128&g=1", "display_name": "Suraj N", "link": "https://stackoverflow.com/users/7766345/suraj-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "accepted_answer_id": 51388946, "answer_count": 1, "score": 0, "last_activity_date": 1531855870, "creation_date": 1531816102, "question_id": 51376609, "link": "https://stackoverflow.com/questions/51376609/how-to-check-for-node-version-in-control-statements-within-recipes", "title": "How to check for node version in control statements within recipes", "body": "<p>In my recipe I would like the control statement to skip auditing phase if the recipe is being run on CentOS 6 version.</p>\n\n<p>I tried using the below for the control statement in RSpec but doesn't seem to work.</p>\n\n<p>How can i use node attributes in control statements to make sure this audit does not run on CentOS 6.x versions and runs on rest of them?</p>\n\n<p>I'm trying to use a recipe and have a control statement at the end like this:</p>\n\n<pre><code>control_group \"gcloud test\" do\n  control \"gcloud\" do\n   describe command(\"/usr/bin/gcloud --version\") do\n    its(:exit_status) { should eq 0 }\n    not_if { node[:platform_family][:platform_version].to_i == '6' }\n  end\n end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "associations", "relationship"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 7868282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de190b3f2ab090ee0f0c4a5750d96ae6?s=128&d=identicon&r=PG&f=1", "display_name": "EvaB11", "link": "https://stackoverflow.com/users/7868282/evab11"}, "edited": false, "score": 0, "creation_date": 1531815628, "post_id": 51376325, "comment_id": 89724447, "body": "That was it! It&#39;s working now -  thank you very much! I can&#39;t upvote yet so just leaving a comment for now."}], "tags": [], "owner": {"reputation": 13441, "user_id": 2199600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sl6u.jpg?s=128&g=1", "display_name": "Igor Drozdov", "link": "https://stackoverflow.com/users/2199600/igor-drozdov"}, "is_accepted": true, "score": 0, "last_activity_date": 1531815078, "creation_date": 1531815078, "answer_id": 51376325, "question_id": 51376211, "link": "https://stackoverflow.com/questions/51376211/rails-show-objects-related-to-user-in-form-dropdown/51376325#51376325", "title": "Rails - Show objects related to user in form dropdown", "body": "<p>The problem is in the following code, which should return the <code>elements</code>:</p>\n\n<pre><code>Element.current_user.team_id.map{|s|[s.title, s.id]}\n</code></pre>\n\n<p>Since you have a <code>user</code>, you can get the team: <code>current_user.team</code>\nAnd then get the <code>elements</code> of the <code>team</code> (as long as <code>has_many :elements</code> is defined in the <code>Team</code> class): <code>current_user.team.elements</code></p>\n\n<p>Thus, the final code should be something like:</p>\n\n<pre><code>&lt;div class=\"field\"&gt;\n  &lt;%= form.label :element_id %&gt;\n  &lt;%= form.select :element_id, options_for_select(current_user.team.elements.map{ |s| [s.title, s.id] }),{ :multiple =&gt; true} %&gt;\n&lt;/div&gt;\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7868282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de190b3f2ab090ee0f0c4a5750d96ae6?s=128&d=identicon&r=PG&f=1", "display_name": "EvaB11", "link": "https://stackoverflow.com/users/7868282/evab11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 1, "accepted_answer_id": 51376325, "answer_count": 1, "score": 1, "last_activity_date": 1531815078, "creation_date": 1531814660, "question_id": 51376211, "link": "https://stackoverflow.com/questions/51376211/rails-show-objects-related-to-user-in-form-dropdown", "title": "Rails - Show objects related to user in form dropdown", "body": "<p>In my rails application the following relationships exist:\n<code>user belongs_to :team</code> ,\n<code>element belongs_to :team</code> , \n<code>task belongs_to :element</code> </p>\n\n<p>A user can then create a task which belongs to an element.\nWhen a user is creating a task, they can select the element they would like the task to belong to. How do I show only the elements that belong to the <code>current_user</code>'s team? I am using Devise to get the <code>current_user</code>.</p>\n\n<p>The samples below do not work.</p>\n\n<pre><code>  &lt;div class=\"field\"&gt;\n    &lt;%= form.label :element_id %&gt;\n    &lt;%= form.select :element_id, options_for_select(Element.current_user.team_id.map{|s|[s.title, s.id]}),{ :multiple =&gt; true} %&gt;\n  &lt;/div&gt;\n</code></pre>\n\n<p>I also tried to call the method below from the <code>tasks_controller.rb</code> file but it didnt work either</p>\n\n<pre><code>  def new\n    @task = Task.new\n    @tasks_element_dropdown = Element.current_user.team_id.map{|s|[s.title, s.id]}\n  end\n</code></pre>\n\n<p>In the <code>tasks/_form.html.erb</code> file, I called the method with the code below</p>\n\n<pre><code>&lt;%= form.select :element_id, options_for_select(@tasks_element_dropdown),{ :multiple =&gt; true} %&gt;\n</code></pre>\n\n<p>When I tried the example below it does work but it displays all elements, and I only want the elements that belong to the user's team to display</p>\n\n<pre><code>  &lt;div class=\"field\"&gt;\n    &lt;%= form.label :element_id %&gt;\n    &lt;%= form.select :element_id, options_for_select(Element.all.map{|s|[s.title, s.id]}),{ :multiple =&gt; true} %&gt;\n  &lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-3.2", "rendering"], "comments": [{"owner": {"reputation": 304, "user_id": 4539041, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-AJsf1Uayt0I/AAAAAAAAAAI/AAAAAAAAABI/6pfKSQdBNaU/photo.jpg?sz=128", "display_name": "ayush lodhi", "link": "https://stackoverflow.com/users/4539041/ayush-lodhi"}, "edited": false, "score": 0, "creation_date": 1531809698, "post_id": 51374738, "comment_id": 89720943, "body": "can you share your controller code please?"}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1531809988, "post_id": 51374738, "comment_id": 89721106, "body": "<i>&#39;I need to know that the form is redirected or rendered after that validation action.&#39;</i> where?"}, {"owner": {"reputation": 41, "user_id": 5051678, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OR2EVTOswBg/AAAAAAAAAAI/AAAAAAAAAFM/5EloN9pEp4I/photo.jpg?sz=128", "display_name": "Piyush Chaudhary", "link": "https://stackoverflow.com/users/5051678/piyush-chaudhary"}, "reply_to_user": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1531814853, "post_id": 51374738, "comment_id": 89724013, "body": "@kiddorails I need to know on the form of the account."}, {"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1531816909, "post_id": 51374738, "comment_id": 89725281, "body": "Questions get better answers if they 1) show code that is tried and 2) where in the code they need help. E.g. in your case: do you need this knowledge in the controller, in a model, in the view? From your comments on the first answer, I seem to understand you are having troubles when rendering the form? Do you use a standard <code>form_for</code> or something like <code>simple_form</code>? It also helps <i>why</i> you need this. E.g. to show validations or an alert, which have possibly completely different answers/approaches."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 5051678, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OR2EVTOswBg/AAAAAAAAAAI/AAAAAAAAAFM/5EloN9pEp4I/photo.jpg?sz=128", "display_name": "Piyush Chaudhary", "link": "https://stackoverflow.com/users/5051678/piyush-chaudhary"}, "edited": false, "score": 0, "creation_date": 1531814740, "post_id": 51374895, "comment_id": 89723939, "body": "Sorry, but I am already using this functionality, I think I did not provide the sufficient information. I need to check on the form that it is rendered or redirected"}, {"owner": {"reputation": 304, "user_id": 4539041, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-AJsf1Uayt0I/AAAAAAAAAAI/AAAAAAAAABI/6pfKSQdBNaU/photo.jpg?sz=128", "display_name": "ayush lodhi", "link": "https://stackoverflow.com/users/4539041/ayush-lodhi"}, "reply_to_user": {"reputation": 41, "user_id": 5051678, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OR2EVTOswBg/AAAAAAAAAAI/AAAAAAAAAFM/5EloN9pEp4I/photo.jpg?sz=128", "display_name": "Piyush Chaudhary", "link": "https://stackoverflow.com/users/5051678/piyush-chaudhary"}, "edited": false, "score": 0, "creation_date": 1531903838, "post_id": 51374895, "comment_id": 89766123, "body": "@PiyushChaudhary you can check this by <code>@article.errors.present?</code> if it returns true that means validation has not been passed otherwise it is passed."}], "tags": [], "owner": {"reputation": 304, "user_id": 4539041, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-AJsf1Uayt0I/AAAAAAAAAAI/AAAAAAAAABI/6pfKSQdBNaU/photo.jpg?sz=128", "display_name": "ayush lodhi", "link": "https://stackoverflow.com/users/4539041/ayush-lodhi"}, "is_accepted": false, "score": 0, "last_activity_date": 1531810059, "creation_date": 1531810059, "answer_id": 51374895, "question_id": 51374738, "link": "https://stackoverflow.com/questions/51374738/how-to-know-the-page-is-rendered-or-redirected-in-rails/51374895#51374895", "title": "How to know the page is rendered or redirected in Rails?", "body": "<p>Generally update method looks like this.</p>\n\n<pre><code>def update\n  @article = Article.find(params[:id])\n\n  if @article.update(article_params)\n    redirect_to @article\n  else\n    render 'edit'\n   end\nend\n</code></pre>\n\n<p>On save, update method is called. Check this method, If @article updated successfully it will redirect to show page otherwise edit page will get rendered. </p>\n"}, {"tags": [], "owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "is_accepted": false, "score": 0, "last_activity_date": 1531816923, "creation_date": 1531816923, "answer_id": 51376843, "question_id": 51374738, "link": "https://stackoverflow.com/questions/51374738/how-to-know-the-page-is-rendered-or-redirected-in-rails/51376843#51376843", "title": "How to know the page is rendered or redirected in Rails?", "body": "<p>A few easy solutions: </p>\n\n<ul>\n<li>when you decide in your controller whether you will re-render or redirect, also set an instance-variable which you can check in the view</li>\n<li>when rendering the form, check if the object you are editing is <code>valid?</code> (will return true if it saved succesfully, false otherwise)</li>\n</ul>\n\n<p>It is a bit unclear why you need this info, I hope you are already showing the validation errors? Simple-form will do this automatically (on the fields). If you do it yourself, you could iterate over <code>@&lt;your-object&gt;.errors.messages</code></p>\n"}, {"tags": [], "owner": {"reputation": 9125, "user_id": 671422, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/85da2a1fa3e4017815ff5d3a3d70fabe?s=128&d=identicon&r=PG", "display_name": "Yule", "link": "https://stackoverflow.com/users/671422/yule"}, "is_accepted": false, "score": 0, "last_activity_date": 1531816965, "creation_date": 1531816965, "answer_id": 51376860, "question_id": 51374738, "link": "https://stackoverflow.com/questions/51374738/how-to-know-the-page-is-rendered-or-redirected-in-rails/51376860#51376860", "title": "How to know the page is rendered or redirected in Rails?", "body": "<p>I think what you're after is whether the update action has been run when you're on the edit page.  The conventional way to do this is to check errors on the @article object:</p>\n\n<pre><code>&lt;%- if @article.errors.blank? %&gt;\n  No errors so hasn't been run through update action\n&lt;% else %&gt;\n  Has been run through update and has some errors\n&lt;% end %&gt;\n</code></pre>\n\n<p>Alternatively, you could add an instance variable in your controller, then check for that on your page:</p>\n\n<pre><code>def update\n  @article = Article.find(params[:id])\n  @run_update = true\n  if @article.update(article_params)\n    redirect_to @article\n  else\n    render 'edit'\n   end\nend\n</code></pre>\n\n<p>View:</p>\n\n<pre><code>&lt;%- if @run_update %&gt;\n  Has been rendered\n&lt;% end %&gt;\n</code></pre>\n\n<p>This is because instance variable don't persist after a redirect</p>\n"}], "owner": {"reputation": 41, "user_id": 5051678, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OR2EVTOswBg/AAAAAAAAAAI/AAAAAAAAAFM/5EloN9pEp4I/photo.jpg?sz=128", "display_name": "Piyush Chaudhary", "link": "https://stackoverflow.com/users/5051678/piyush-chaudhary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 252, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1531816965, "creation_date": 1531809530, "last_edit_date": 1531809908, "question_id": 51374738, "link": "https://stackoverflow.com/questions/51374738/how-to-know-the-page-is-rendered-or-redirected-in-rails", "title": "How to know the page is rendered or redirected in Rails?", "body": "<p>After clicking on the \"<strong>Save</strong>\" button of the <em>account</em> form, the page is rendered to the <em>edit account</em> itself because the validation did not pass successfully. I need to know that the form is redirected or rendered after that validation action.<br>\nPlease help. Thanks in advance</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "spree", "spree-auth-devise", "spree-upgrade"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1531809801, "post_id": 51374566, "comment_id": 89721009, "body": "What is your question?"}, {"owner": {"reputation": 57, "user_id": 8702531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a38172d856c7e6ee5a065a326f9b3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Yii2Developer", "link": "https://stackoverflow.com/users/8702531/yii2developer"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1531810796, "post_id": 51374566, "comment_id": 89721580, "body": "@sawa when i add an image from the spree admin panel then this error is coming     hash[:image_url] = asset_url(optional.delete(:image).attachment) if optional[:image]"}], "answers": [{"tags": [], "owner": {"reputation": 7811, "user_id": 379779, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4c3bd8d869b7e1caa45485b0b3e126a4?s=128&d=identicon&r=PG", "display_name": "zawhtut", "link": "https://stackoverflow.com/users/379779/zawhtut"}, "is_accepted": true, "score": 1, "last_activity_date": 1532530469, "creation_date": 1532530469, "answer_id": 51521975, "question_id": 51374566, "link": "https://stackoverflow.com/questions/51374566/the-asset-is-not-present-in-the-asset-pipeline/51521975#51521975", "title": "The asset &#39; &#39; is not present in the asset pipeline", "body": "<p>Spree is using the ActiveStorage to store the image file. They are in the storage folder of the spree project. One way to upload them in a batch manner is to use the rest API</p>\n\n<p><a href=\"https://guides.spreecommerce.org/api/product_images.html\" rel=\"nofollow noreferrer\">https://guides.spreecommerce.org/api/product_images.html</a></p>\n\n<p>For the rest-api, I have been using unirest. </p>\n\n<pre><code>POST /api/v1/products/a-product/images\n</code></pre>\n\n<p><strong>a-product</strong> = friendly_id (slug name to be exact), they are stored in friendly_id_slug tables. When you upload an image to Spree, Spree will look up the slug name in that table and upload it to the ActiveStorage. The records will be saved in spree_assets, active_storage_blobs and active_storage_attachments table respectively. </p>\n"}], "owner": {"reputation": 57, "user_id": 8702531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a38172d856c7e6ee5a065a326f9b3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Yii2Developer", "link": "https://stackoverflow.com/users/8702531/yii2developer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 438, "favorite_count": 0, "accepted_answer_id": 51521975, "answer_count": 1, "score": 0, "last_activity_date": 1532530469, "creation_date": 1531808876, "question_id": 51374566, "link": "https://stackoverflow.com/questions/51374566/the-asset-is-not-present-in-the-asset-pipeline", "title": "The asset &#39; &#39; is not present in the asset pipeline", "body": "<p><a href=\"https://i.stack.imgur.com/tCjqw.png\" rel=\"nofollow noreferrer\">Screenshot of Error Message</a></p>\n\n<p><strong>If I do not add any image in product then it is working fine with Default Image,but if I add an image using admin panel of spree then on front-end I get this issue .</strong></p>\n\n<p>Inside :- app/helpers/spree/trackers_helper.rb</p>\n\n<pre><code>module Spree\n  module TrackersHelper\n    def product_for_segment(product, optional = {})\n      {\n        product_id: product.id,\n        sku: product.sku,\n        category: product.category.try(:name),\n        name: product.name,\n        brand: product.brand.try(:name),\n        price: product.price,\n        currency: product.currency,\n        url: product_url(product),\n      }.tap do |hash|\n        hash[:image_url] = asset_url(optional.delete(:image).attachment) if optional[:image]\n      end.merge(optional).to_json.html_safe\n    end\n  end\nend\n</code></pre>\n\n<p>Inside :- app/views/spree/shared/_products.html.erb</p>\n\n<pre><code>&lt;% content_for :head do %&gt;\n  &lt;% if products.respond_to?(:total_pages) %&gt;\n    &lt;%= rel_next_prev_link_tags products %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n\n&lt;div data-hook=\"products_search_results_heading\"&gt;\n  &lt;% if products.empty? %&gt;\n    &lt;div data-hook=\"products_search_results_heading_no_results_found\"&gt;\n      &lt;%= Spree.t(:no_products_found) %&gt;\n    &lt;/div&gt;\n  &lt;% elsif params.key?(:keywords) %&gt;\n    &lt;div data-hook=\"products_search_results_heading_results_found\"&gt;\n      &lt;h6 class=\"search-results-title\"&gt;&lt;%= Spree.t(:search_results, keywords: h(params[:keywords])) %&gt;&lt;/h6&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n\n&lt;% if products.any? %&gt;\n  &lt;div id=\"products\" class=\"row\" data-hook&gt;\n    &lt;%= render partial: 'spree/products/product', collection: products, locals: { taxon: @taxon } %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n\n&lt;% if products.respond_to?(:total_pages) %&gt;\n  &lt;%= paginate products, theme: 'twitter-bootstrap-3' %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "simple-form"], "comments": [{"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1531806826, "post_id": 51374102, "comment_id": 89719621, "body": "instead of <code>redirect_to new_user_property_path</code> in <code>else</code> block, you should <code>render &#39;new&#39;</code>"}, {"owner": {"reputation": 69, "user_id": 7283800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/10157837963530655/picture?type=large", "display_name": "Rodolphe Geant", "link": "https://stackoverflow.com/users/7283800/rodolphe-geant"}, "reply_to_user": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1531807059, "post_id": 51374102, "comment_id": 89719702, "body": "Hello kiddorails! yes it works. Do you know why by any chance? thanks"}, {"owner": {"reputation": 69, "user_id": 7283800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/10157837963530655/picture?type=large", "display_name": "Rodolphe Geant", "link": "https://stackoverflow.com/users/7283800/rodolphe-geant"}, "reply_to_user": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1531807085, "post_id": 51374102, "comment_id": 89719715, "body": "Please answer the question so I can credit you with it!"}], "answers": [{"tags": [], "owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "is_accepted": true, "score": 1, "last_activity_date": 1531807957, "last_edit_date": 1531807957, "creation_date": 1531807278, "answer_id": 51374214, "question_id": 51374102, "link": "https://stackoverflow.com/questions/51374102/validation-error-messages-not-showing-in-form-view/51374214#51374214", "title": "Validation error messages not showing in form view", "body": "<p>instead of <code>redirect_to new_user_property_path</code> in <code>else</code> block, you should </p>\n\n<pre><code>render 'new'\n</code></pre>\n\n<p>Reason: <code>redirect</code> instructs the browser to make the new request, because of which you end up loosing the context of <code>@property</code> object with it's errors. It actually makes a fresh request to <code>new</code> action. <code>render</code> will continue with the current action (which is <code>create</code> in this case) and render the response in <code>new</code> view with <code>@property</code>, errors and previous form body.</p>\n"}], "owner": {"reputation": 69, "user_id": 7283800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/10157837963530655/picture?type=large", "display_name": "Rodolphe Geant", "link": "https://stackoverflow.com/users/7283800/rodolphe-geant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 844, "favorite_count": 0, "accepted_answer_id": 51374214, "answer_count": 1, "score": 0, "last_activity_date": 1531807975, "creation_date": 1531806738, "last_edit_date": 1531807975, "question_id": 51374102, "link": "https://stackoverflow.com/questions/51374102/validation-error-messages-not-showing-in-form-view", "title": "Validation error messages not showing in form view", "body": "<p>I have a simple model :</p>\n\n<pre><code>class Property &lt; ApplicationRecord\n belongs_to :user\n has_many :invoices, dependent: :destroy\n has_many :tenants, dependent: :destroy\n\n validates :street, presence: true, length: { maximum: 50}\n validates :city, presence: true, length: { maximum: 50}\n validates :zip, presence: true, length: { maximum: 10}\n validates :rent, presence: true, length: { maximum: 50}\n\n\n def receivable\n  (self.rent.to_i + self.charges.to_i)\n  end\nend\n</code></pre>\n\n<p>When trying in the console, the validation errors come as expected:</p>\n\n<pre><code>[2] pry(main)&gt; prop = Property.new(street:\"zzz\")\n =&gt; #&lt;Property:0x007fb99cde1cc0 id: nil, number: nil, streetype: nil, street: \n \"zzz\", city: nil, zip: nil, rent: nil, charges: nil, user_id: nil, created_at: \n nil, updated_at: nil&gt;\n\n[3] pry(main)&gt; prop.save\n(0.3ms)  BEGIN\n(0.8ms)  ROLLBACK\n=&gt; false\n\n[4] pry(main)&gt; prop.errors.full_messages\n=&gt; [\"User must exist\", \"City can't be blank\", \"Zip can't be blank\", \"Rent can't \nbe blank\"]\n</code></pre>\n\n<p>Here is the controller: </p>\n\n<pre><code>def new\n @user =  current_user\n @property = @user.properties.build\nend\n\ndef create\n @user =  current_user\n @property = @user.properties.create(property_params)\n @property.user_id = current_user.id\n  if @property.save\n   flash[:notice] = \"Nouveau Bien cr\u00e9\u00e9 !\"\n   redirect_to user_properties_path\n  else\n   redirect_to new_user_property_path\n end\nend\n</code></pre>\n\n<p>And here is the form view:</p>\n\n<pre><code>&lt;div class=\"container center\"&gt;\n &lt;div class=\"row white\"&gt;\n  &lt;div\"&gt;\n   &lt;h2&gt;Nouveau bien&lt;/h2&gt;\n   &lt;%= simple_form_for([@user, @property]) do |j| %&gt;\n    &lt;%= j.input :number, label:\"Num\u00e9ro\" %&gt;\n    &lt;%= j.input :streetype, label: \"Laisser vide si n\u00e9cessaire\", collection: [\" \n    \",\"rue\",\"boulevard\",\"all\u00e9e\"] , prompt: \"Choisir\" %&gt;\n    &lt;%= j.input :street, label:\"Nom\" %&gt;\n    &lt;%= j.input :city, label:\"Commune / Ville\" %&gt;\n    &lt;%= j.input :zip, label:\"Code Postal\" %&gt;\n    &lt;%= j.input :rent, label:\"Montant du Loyer\" %&gt;\n    &lt;%= j.input :charges, label:\"Montant des charges\" %&gt;\n    &lt;br&gt;\n    &lt;%= j.submit 'Cr\u00e9er', class: \"form-control btn btn-info\" %&gt;\n   &lt;% end %&gt;\n  &lt;/div&gt;\n &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>When omitting one of the fields on purpose, the controller redirect to the correct form viw but validation error messages are not present. They use to show up but they disapeared for some reason. </p>\n\n<p>Any idea why?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 1377, "user_id": 4485127, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IoOC4.jpg?s=128&g=1", "display_name": "Angel Garcia", "link": "https://stackoverflow.com/users/4485127/angel-garcia"}, "edited": false, "score": 0, "creation_date": 1531851677, "post_id": 51379533, "comment_id": 89747803, "body": "works perfectly, thanks!"}, {"owner": {"reputation": 2902, "user_id": 1202324, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4e62f40c62dda03af2f033c651f36311?s=128&d=identicon&r=PG", "display_name": "Denny Mueller", "link": "https://stackoverflow.com/users/1202324/denny-mueller"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1531900231, "post_id": 51379533, "comment_id": 89763893, "body": "thanks @engineersmnky for reminding me of my typo in the method arguments and alleging me of copying an answer. I renamed the class to something way more suitable since anybody who reads this can&#39;t see that I called is <code>Object</code> because OP called his var <code>@objects</code>."}], "tags": [], "owner": {"reputation": 2902, "user_id": 1202324, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4e62f40c62dda03af2f033c651f36311?s=128&d=identicon&r=PG", "display_name": "Denny Mueller", "link": "https://stackoverflow.com/users/1202324/denny-mueller"}, "is_accepted": true, "score": 1, "last_activity_date": 1531899930, "last_edit_date": 1531899930, "creation_date": 1531824603, "answer_id": 51379533, "question_id": 51372869, "link": "https://stackoverflow.com/questions/51372869/passing-a-method-with-parameters-as-an-argument-in-ruby/51379533#51379533", "title": "passing a method with parameters as an argument in ruby", "body": "<p>echnically its not intended to give arguments to_json only takes getters. But you could do something along those lines:</p>\n\n<pre><code>class ObjectClassOfYourChoice\n  attr_accessor :current_user\n\n  def property_is_owned_by?(user = nil)\n    user ||= current_user\n    # rest of your code\n  end\nend\n\n\n@objects.each do |object|\n  object.current_user = current_user\nend\nrender json: @objects.to_json(methods: [:property_is_owned_by?]\n</code></pre>\n\n<p>Although I wouldn't do it like this since you have to set for all the object and thats just codesmell.</p>\n"}], "owner": {"reputation": 1377, "user_id": 4485127, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IoOC4.jpg?s=128&g=1", "display_name": "Angel Garcia", "link": "https://stackoverflow.com/users/4485127/angel-garcia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 1, "closed_date": 1531851727, "accepted_answer_id": 51379533, "answer_count": 1, "score": 0, "last_activity_date": 1531899930, "creation_date": 1531798571, "question_id": 51372869, "link": "https://stackoverflow.com/questions/51372869/passing-a-method-with-parameters-as-an-argument-in-ruby", "closed_reason": "Duplicate", "title": "passing a method with parameters as an argument in ruby", "body": "<p>I currently need to pass some methods as parameters in order to render json properly: </p>\n\n<pre><code>render json: @objects.to_json(methods: [:num_of_properties])\n</code></pre>\n\n<p>This syntax currently works. However, there is another method I want to pass; this method takes in 1 argument.</p>\n\n<p>I figured this would work:</p>\n\n<pre><code>render json: @objects.to_json(methods: [:num_of_properties, :property_is_owned_by?(current_user)])\n</code></pre>\n\n<p>This does <strong>not</strong> work. Is this even possible to do? I figured that if you can pass methods as arguments in the first place, you must be able to pass methods that take in arguments. But I don't know. I'm not too familiar with Ruby.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 1165, "user_id": 143238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/faa7d5a8a0a4333e1e741aa41e802fc1?s=128&d=identicon&r=PG", "display_name": "BM5k", "link": "https://stackoverflow.com/users/143238/bm5k"}, "edited": false, "score": 0, "creation_date": 1531784666, "post_id": 51371345, "comment_id": 89714886, "body": "What type of field is <code>period_starting_at</code>?"}, {"owner": {"reputation": 43, "user_id": 3170962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab5141f3d8f2013e3c71b427498b7501?s=128&d=identicon&r=PG&f=1", "display_name": "Thierri Cegantin Oliveira", "link": "https://stackoverflow.com/users/3170962/thierri-cegantin-oliveira"}, "reply_to_user": {"reputation": 1165, "user_id": 143238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/faa7d5a8a0a4333e1e741aa41e802fc1?s=128&d=identicon&r=PG", "display_name": "BM5k", "link": "https://stackoverflow.com/users/143238/bm5k"}, "edited": false, "score": 0, "creation_date": 1531784810, "post_id": 51371345, "comment_id": 89714913, "body": "Its type text. I am using javascript to force the user to enter something like HH:MM."}, {"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1531787193, "post_id": 51371345, "comment_id": 89715321, "body": "if you&#39;re desperate, you can just <code>def period_starting_at; (super - 1.hour); end</code>"}, {"owner": {"reputation": 1165, "user_id": 143238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/faa7d5a8a0a4333e1e741aa41e802fc1?s=128&d=identicon&r=PG", "display_name": "BM5k", "link": "https://stackoverflow.com/users/143238/bm5k"}, "edited": false, "score": 0, "creation_date": 1531806083, "post_id": 51371345, "comment_id": 89719319, "body": "How are you setting Time.zone?"}, {"owner": {"reputation": 1165, "user_id": 143238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/faa7d5a8a0a4333e1e741aa41e802fc1?s=128&d=identicon&r=PG", "display_name": "BM5k", "link": "https://stackoverflow.com/users/143238/bm5k"}, "edited": false, "score": 0, "creation_date": 1531806192, "post_id": 51371345, "comment_id": 89719370, "body": "If <code>Model#period_starting_at</code> is a string/text, why are you parsing it into a <code>TimeWithZone</code>?"}, {"owner": {"reputation": 1165, "user_id": 143238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/faa7d5a8a0a4333e1e741aa41e802fc1?s=128&d=identicon&r=PG", "display_name": "BM5k", "link": "https://stackoverflow.com/users/143238/bm5k"}, "edited": false, "score": 1, "creation_date": 1531806579, "post_id": 51371345, "comment_id": 89719532, "body": "Also, I was unable to reproduce in a simple rails app: <a href=\"https://gitlab.com/snippets/1733951#note_88375694\" rel=\"nofollow noreferrer\">gitlab.com/snippets/1733951#note_88375694</a>"}, {"owner": {"reputation": 43, "user_id": 3170962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab5141f3d8f2013e3c71b427498b7501?s=128&d=identicon&r=PG&f=1", "display_name": "Thierri Cegantin Oliveira", "link": "https://stackoverflow.com/users/3170962/thierri-cegantin-oliveira"}, "reply_to_user": {"reputation": 1165, "user_id": 143238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/faa7d5a8a0a4333e1e741aa41e802fc1?s=128&d=identicon&r=PG", "display_name": "BM5k", "link": "https://stackoverflow.com/users/143238/bm5k"}, "edited": false, "score": 0, "creation_date": 1531836597, "post_id": 51371345, "comment_id": 89738961, "body": "@BM5k Thanks for the effort. Actually the type of <code>period_starting_at</code> is TIME. What I meant in the last comment is the type of the input in the HTML. That one is text. I think that way you be able to reproduce."}, {"owner": {"reputation": 2572, "user_id": 41820, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2f6e29bc4ac5cba553b21bc001b0d137?s=128&d=identicon&r=PG", "display_name": "richardkmiller", "link": "https://stackoverflow.com/users/41820/richardkmiller"}, "edited": false, "score": 0, "creation_date": 1534438384, "post_id": 51371345, "comment_id": 90715423, "body": "I&#39;m having the same issue in fixtures. Setting a <code>time</code> column to <code>12:00:00 UTC</code> or <code>12:00:00 EDT</code> are both represented as <code>12:00:00</code> in the PostgreSQL column. The column type is <code>time without time zone</code>. On the other hand, setting the timezone on a datetime column works. This column type is <code>timestamp without time zone</code>."}, {"owner": {"reputation": 43, "user_id": 3170962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab5141f3d8f2013e3c71b427498b7501?s=128&d=identicon&r=PG&f=1", "display_name": "Thierri Cegantin Oliveira", "link": "https://stackoverflow.com/users/3170962/thierri-cegantin-oliveira"}, "edited": false, "score": 0, "creation_date": 1534471724, "post_id": 51371345, "comment_id": 90726267, "body": "Hi Richard! In my case, the problem was about DST - Daylight Saving Time."}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 3170962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab5141f3d8f2013e3c71b427498b7501?s=128&d=identicon&r=PG&f=1", "display_name": "Thierri Cegantin Oliveira", "link": "https://stackoverflow.com/users/3170962/thierri-cegantin-oliveira"}, "is_accepted": false, "score": 0, "last_activity_date": 1534472094, "creation_date": 1534472094, "answer_id": 51887554, "question_id": 51371345, "link": "https://stackoverflow.com/questions/51371345/timezone-on-time-datatype-not-working-as-expected-rails-5/51887554#51887554", "title": "Timezone on Time Datatype not working as expected - Rails 5", "body": "<p>The problem was about DST - Daylight Saving Time. Rails don't actually have a true 'Time' datatype, it's a 'Datetime' datatype with a dummy date part. But depending on the manipulation that you apply, that dummy date part can affect the timezome, because of DST. I hope I was helpfull.</p>\n"}], "owner": {"reputation": 43, "user_id": 3170962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab5141f3d8f2013e3c71b427498b7501?s=128&d=identicon&r=PG&f=1", "display_name": "Thierri Cegantin Oliveira", "link": "https://stackoverflow.com/users/3170962/thierri-cegantin-oliveira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1534472094, "creation_date": 1531784214, "last_edit_date": 1531785927, "question_id": 51371345, "link": "https://stackoverflow.com/questions/51371345/timezone-on-time-datatype-not-working-as-expected-rails-5", "title": "Timezone on Time Datatype not working as expected - Rails 5", "body": "<p>I have model with an attribute (period_starting_at) of TIME datatype, running on Rails 5 with Postgres.</p>\n\n<p>When my controller assigns a parameter value to that model attribute, something is changing the timezone to a wrong one. See the example:</p>\n\n<pre><code>model_one = Model.new\n\n    puts params['Model']['period_starting_at'] #Returns 10:00\n\n    puts Time.zone.parse(params['Model']['period_starting_at']) #Return 2018-07-16 10:00:00 -0300, which is with the correct timezone -3. \n\n    model_one.period_starting_at = Time.zone.parse(params['Model']['period_starting_at'])\n\n    puts model_one.period_starting_at # Return 2000-01-01 10:00:00 -0200, which is with the **wrong** timezone -2.\n</code></pre>\n\n<p>The timezone of the rails app is correct.</p>\n\n<p><code>Time.zone.to_s</code> => \"(GMT-03:00) Brasilia\"</p>\n\n<p>Also, the timezone of the database (postgres) is correct.</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1531780658, "post_id": 51370735, "comment_id": 89714085, "body": "For such a specific and complex problem, your code seems fairly concise. However, I do wonder: Why are you dealing with this messy array of hashes in the first place? You&#39;ve tagged this as <code>ruby-on-rails</code>, which leads me to believe there may be e.g. a <code>Person</code> model with attributes including <code>name</code>, <code>number</code> and <code>cost</code>. Is this a problem that could actually be done with SQL, or even just by manipulating custom objects rather than <code>Hash</code>es? What was the <i>original</i> problem being solved?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1531810552, "post_id": 51370735, "comment_id": 89721447, "body": "No one has offered an answer because readers (like me, anyway) do not understand the question. Adding a small example that includes the desired return value would help explain what you are trying to achieve."}, {"owner": {"reputation": 2132, "user_id": 856753, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1c53a71370f55d0f0a4cc7e4b2c06b91?s=128&d=identicon&r=PG", "display_name": "Micheal", "link": "https://stackoverflow.com/users/856753/micheal"}, "edited": false, "score": 0, "creation_date": 1531815062, "post_id": 51370735, "comment_id": 89724137, "body": "The above example has the desired return value and is working fine. needed help in understanding the complexity of O(n^2)and see if it can improved to O(n)"}, {"owner": {"reputation": 2132, "user_id": 856753, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1c53a71370f55d0f0a4cc7e4b2c06b91?s=128&d=identicon&r=PG", "display_name": "Micheal", "link": "https://stackoverflow.com/users/856753/micheal"}, "edited": false, "score": 0, "creation_date": 1531815090, "post_id": 51370735, "comment_id": 89724151, "body": "Sorry, this is purely Ruby. I have removed the rails tag"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1531851911, "post_id": 51370735, "comment_id": 89747907, "body": "You state, &quot;for every &#39;number&#39; key, return the name with highest cost&quot;, but in your example you return an array of hashes."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1531867386, "post_id": 51383581, "comment_id": 89754398, "body": "Could you fruitify my solution as well?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1531919009, "post_id": 51383581, "comment_id": 89776201, "body": "@CarySwoveland fruity benchmarks posted (RUBY_VERSION 2.5.1)"}, {"owner": {"reputation": 2132, "user_id": 856753, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1c53a71370f55d0f0a4cc7e4b2c06b91?s=128&d=identicon&r=PG", "display_name": "Micheal", "link": "https://stackoverflow.com/users/856753/micheal"}, "edited": false, "score": 0, "creation_date": 1531956636, "post_id": 51383581, "comment_id": 89796251, "body": "@engineersmnky. what does this do: .sort_by(&amp;:first).map(&amp;:last)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 2132, "user_id": 856753, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1c53a71370f55d0f0a4cc7e4b2c06b91?s=128&d=identicon&r=PG", "display_name": "Micheal", "link": "https://stackoverflow.com/users/856753/micheal"}, "edited": false, "score": 0, "creation_date": 1531956980, "post_id": 51383581, "comment_id": 89796339, "body": "@Micheal <code>sort_by</code> will convert the key/value pairs to an <code>Array</code> such that the argument looks like <code>[key, value]</code> so we are sorting by the key (first) which is <code>number</code> in this case then map the <code>values</code> (last)."}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 2, "last_activity_date": 1531922248, "last_edit_date": 1531922248, "creation_date": 1531836637, "answer_id": 51383581, "question_id": 51370735, "link": "https://stackoverflow.com/questions/51370735/improve-array-of-hashes-performance-while-returning-subset/51383581#51383581", "title": "improve array of hashes performance while returning subset", "body": "<p>This appears to be more efficient than your current solution: (by ~20% according to the <code>fruity</code> gem)</p>\n\n<pre><code>a.group_by {|h| h[:name] }.each_with_object({}) do |(_,v),obj|\n  if v.size &lt; 3 \n    v.each do |sv| \n      if obj[sv[:number]].nil? || obj[sv[:number]][:cost] &lt; sv[:cost]\n        obj[sv[:number]] = sv\n      end \n    end\n  end\nend.sort_by(&amp;:first).map(&amp;:last) # or just end.values if the sort is not a requirement\n#=&gt; [{:name=&gt;\"John Doe3\", :number=&gt;1, :cost=&gt;100},\n#    {:name=&gt;\"John Doe2\", :number=&gt;2, :cost=&gt;300}]\n</code></pre>\n\n<p>First we group by name.</p>\n\n<p>Then we build a new <code>Hash</code> and for each group that has less than 3 members we rotate through the list and add the member to the <code>Hash</code> under its number if the number does not exist or the member's cost is greater than the current cost. </p>\n\n<p>Then we sort by the keys (number) and output the values. If you do not need the sorting then you can just use <code>values</code> </p>\n\n<p><strong>Benchmarking:</strong> (provided by the <a href=\"https://github.com/marcandre/fruity\" rel=\"nofollow noreferrer\"><code>fruity</code></a> gem)\nSince the original post included sorting but the accepted answer did not I benchmarked both options. </p>\n\n<p><strong>Code</strong> </p>\n\n<pre><code>def cary_swoveland(a)\n  a.group_by { |el| el[:name] }.\n  each_value.\n  reject { |v| v.size &gt;= 3 }.\n  flatten.\n  group_by { |h| h[:number] }.\n  transform_values { |v| v.max_by { |h| h[:cost] } }\nend\ndef cary_swoveland_no_sort(a)\n  cary_swoveland(a).values  \nend\ndef cary_swoveland_sorted(a)\n  cary_swoveland(a).sort_by(&amp;:first).map(&amp;:last)  \nend\ndef engineers_mnky(a)\n  a.group_by {|h| h[:name] }.each_with_object({}) do |(_,v),obj|\n    if v.size &lt; 3 \n      v.each do |sv| \n        if obj[sv[:number]].nil? || obj[sv[:number]][:cost] &lt; sv[:cost]\n          obj[sv[:number]] = sv\n        end \n      end\n    end\n  end\nend\ndef engineers_mnky_no_sort(a)\n  engineers_mnky.values\nend\ndef engineers_mnky_sorted(a)\n  engineers_mnky.sort_by(&amp;:first).map(&amp;:last)\nend\n\ndef original_post_no_sort(a)\n  a.group_by { |el| el[:name] }.\n  reject { |_, v| v.size &gt;= 3 }.\n  values.\n  flatten.\n  group_by{|el| el[:number]}.\n  values.\n  map{|el| el.max_by{|x| x[:cost]}}\nend\n\ndef original_post(a)\n  a.group_by { |el| el[:name] }.\n  reject { |_, v| v.size &gt;= 3 }.\n  values.\n  flatten.sort_by {|h| h[:number]}.\n  group_by{|el| el[:number]}.\n  values.\n  map{|el| el.max_by{|x| x[:cost]}}\nend\n</code></pre>\n\n<p><strong>Data</strong>: </p>\n\n<pre><code>a= [{:name=&gt;\"John Doe1\", :number=&gt;1, :cost=&gt;100},\n    {:name=&gt;\"John Doe3\", :number=&gt;2, :cost=&gt;400},\n    {:name=&gt;\"John Doe3\", :number=&gt;1, :cost=&gt;100}, \n    {:name=&gt;\"John Doe1\", :number=&gt;1, :cost=&gt;100}, \n    {:name=&gt;\"John Doe1\", :number=&gt;1, :cost=&gt;100}, \n    {:name=&gt;\"John Doe1\", :number=&gt;1, :cost=&gt;300}, \n    {:name=&gt;\"John Doe2\", :number=&gt;2, :cost=&gt;300},\n    {:name=&gt;\"John Doe1\", :number=&gt;3, :cost=&gt;400}]\n</code></pre>\n\n<p><strong>Results</strong>: </p>\n\n<pre><code># UNSORTED\nRunning each test 524288 times. Test will take about 4 minutes.\nengineers_mnky_no_sort is faster than original_post_no_sort by 30.000000000000004% \u00b1 1.0%\noriginal_post_no_sort is faster than cary_swoveland_no_sort by 10.000000000000009% \u00b1 1.0%\n\n# SORTED \nRunning each test 262144 times. Test will take about 3 minutes.\nengineers_mnky_sorted is faster than original_post by 19.999999999999996% \u00b1 1.0%\noriginal_post is faster than cary_swoveland_sorted by 10.000000000000009% \u00b1 1.0%\n</code></pre>\n\n<p><strong>Data</strong>:</p>\n\n<pre><code>a = n.times.map do \n  {:name=&gt;\"John Doe#{rand(n / 2)}\", :number=&gt;(1..200).to_a.sample, :cost=&gt;rand(1000)}\nend\n</code></pre>\n\n<p><strong>Results</strong>:</p>\n\n<pre><code># Run 1 (n == 500)\n# UNSORTED\nRunning each test 8192 times. Test will take about 3 minutes.\nengineers_mnky_no_sort is faster than original_post_no_sort by 19.999999999999996% \u00b1 1.0%\noriginal_post_no_sort is similar to cary_swoveland_no_sort\n\n# SORTED \nRunning each test 8192 times. Test will take about 4 minutes.\nengineers_mnky_sorted is faster than cary_swoveland_sorted by 19.999999999999996% \u00b1 1.0%\ncary_swoveland_sorted is similar to original_post\n\n# Run 2 (n == 1_000)\n# UNSORTED\nRunning each test 4096 times. Test will take about 3 minutes.\nengineers_mnky_no_sort is faster than original_post_no_sort by 10.000000000000009% \u00b1 1.0%\noriginal_post_no_sort is similar to cary_swoveland_no_sort\n\n# SORTED \nRunning each test 4096 times. Test will take about 4 minutes.\nengineers_mnky_sorted is faster than cary_swoveland_sorted by 10.000000000000009% \u00b1 1.0%\ncary_swoveland_sorted is faster than original_post by 10.000000000000009% \u00b1 1.0% \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 1, "creation_date": 1531847091, "post_id": 51386490, "comment_id": 89745576, "body": "@SimpleLime, good suggestion. I made the change. I should have caught that as using enumerators rather than arrays, where possible, is a hobby horse of mine. I can&#39;t count the times that I&#39;ve suggested replacing <code>chars</code> with <code>each_char</code> in SO answers."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1531847249, "post_id": 51386490, "comment_id": 89745642, "body": "<code>{:name=&gt;&quot;John Doe3&quot;, :number=&gt;2, :cost=&gt;400}</code> causes this to fail the desired output which appears to be the largest cost for each number where the name does not occur more than twice in the original array"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1531850360, "post_id": 51386490, "comment_id": 89747195, "body": "@engineersmnky, thank you for the counterexample. I see that I had misunderstood the question. I corrected my answer ."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1531851219, "post_id": 51386490, "comment_id": 89747614, "body": "Yes, I just noticed that and made the correction. See my comment on the question. One more fix in progress related to the desired return value. There seems to be a conflict between the statement of what is desired and the OPs example."}, {"owner": {"reputation": 2132, "user_id": 856753, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1c53a71370f55d0f0a4cc7e4b2c06b91?s=128&d=identicon&r=PG", "display_name": "Micheal", "link": "https://stackoverflow.com/users/856753/micheal"}, "edited": false, "score": 0, "creation_date": 1531858142, "post_id": 51386490, "comment_id": 89750902, "body": "sorry, updated the question, **subset of array of hashes"}, {"owner": {"reputation": 2132, "user_id": 856753, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1c53a71370f55d0f0a4cc7e4b2c06b91?s=128&d=identicon&r=PG", "display_name": "Micheal", "link": "https://stackoverflow.com/users/856753/micheal"}, "edited": false, "score": 0, "creation_date": 1531861375, "post_id": 51386490, "comment_id": 89752389, "body": "Edited. both solutions get the required result.+1 to both. Cary&#39;s solution is more readable for me."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 2132, "user_id": 856753, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1c53a71370f55d0f0a4cc7e4b2c06b91?s=128&d=identicon&r=PG", "display_name": "Micheal", "link": "https://stackoverflow.com/users/856753/micheal"}, "edited": false, "score": 0, "creation_date": 1531861729, "post_id": 51386490, "comment_id": 89752554, "body": "@Micheal I assumed that given your concern over computational complexity that efficiency was the most important characteristic thus my answer but thank you for the kudos and best of luck"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 2, "last_activity_date": 1531851758, "last_edit_date": 1531851758, "creation_date": 1531845736, "answer_id": 51386490, "question_id": 51370735, "link": "https://stackoverflow.com/questions/51370735/improve-array-of-hashes-performance-while-returning-subset/51386490#51386490", "title": "improve array of hashes performance while returning subset", "body": "<pre><code>a.group_by { |el| el[:name] }.\n  each_value.\n  reject { |v| v.size &gt;= 3 }.\n  flatten.\n  group_by { |h| h[:number] }.\n  transform_values { |v| v.max_by { |h| h[:cost] }[:name] }            \n    #=&gt; {1=&gt;\"John Doe3\", 2=&gt;\"John Doe2\"}\n</code></pre>\n\n<p>This return value seems consistent with what is being asked in the question. If the value of each number is to be the hash <code>h</code> for which <code>h[:cost]</code> is largest, simply remove <code>[:name]</code>:</p>\n\n<pre><code>  ...\n  transform_values { |v| v.max_by { |h| h[:cost] } }            \n    #=&gt; {1=&gt;{:name=&gt;\"John Doe3\", :number=&gt;1, :cost=&gt;100},\n    #    2=&gt;{:name=&gt;\"John Doe2\", :number=&gt;2, :cost=&gt;300}}\n</code></pre>\n\n<p>or, if desired:</p>\n\n<pre><code>  ...\n  transform_values { |v| v.max_by { |h| h[:cost] } }.values            \n    #=&gt; [{:name=&gt;\"John Doe3\", :number=&gt;1, :cost=&gt;100},\n    #    {:name=&gt;\"John Doe2\", :number=&gt;2, :cost=&gt;300}]\n</code></pre>\n\n<p>This has a computational complexity of O(n) (<code>n = a.size</code>) because each step requires a single pass through at most <code>a.size</code> elements.</p>\n\n<p>The steps are as follows.</p>\n\n<pre><code>b = a.group_by { |el| el[:name] }\n  #=&gt; {\"John Doe1\"=&gt;[\n  #      {:name=&gt;\"John Doe1\", :number=&gt;1, :cost=&gt;100},\n  #      {:name=&gt;\"John Doe1\", :number=&gt;1, :cost=&gt;100},\n  #      {:name=&gt;\"John Doe1\", :number=&gt;1, :cost=&gt;100},\n  #      {:name=&gt;\"John Doe1\", :number=&gt;1, :cost=&gt;300},\n  #      {:name=&gt;\"John Doe1\", :number=&gt;3, :cost=&gt;400}\n  #    ],\n  #    \"John Doe3\"=&gt;[{:name=&gt;\"John Doe3\", :number=&gt;1, :cost=&gt;100}],\n  #    \"John Doe2\"=&gt;[{:name=&gt;\"John Doe2\", :number=&gt;2, :cost=&gt;300}]\n  #   }\n</code></pre>\n\n<p>We don't need the keys of this hash so we may as well extract the values now.</p>\n\n<pre><code>c = b.each_value\n  #=&gt; #&lt;Enumerator: \n  #     {\"John Doe1\"=&gt;[\n  #        {:name=&gt;\"John Doe1\", :number=&gt;1, :cost=&gt;100},\n  #        {:name=&gt;\"John Doe1\", :number=&gt;1, :cost=&gt;100},\n  #        {:name=&gt;\"John Doe1\", :number=&gt;1, :cost=&gt;100},\n  #        {:name=&gt;\"John Doe1\", :number=&gt;1, :cost=&gt;300},\n  #        {:name=&gt;\"John Doe1\", :number=&gt;3, :cost=&gt;400}\n  #      ],\n  #      \"John Doe3\"=&gt;[{:name=&gt;\"John Doe3\", :number=&gt;1, :cost=&gt;100}],\n  #      \"John Doe2\"=&gt;[{:name=&gt;\"John Doe2\", :number=&gt;2, :cost=&gt;300}]\n  #     }:each_value&gt;\n</code></pre>\n\n<p>Now remove the arrays containing 3 or more elements and flatten the result.</p>\n\n<pre><code>d = c.reject { |v| v.size &gt;= 3 }\n  #=&gt; [\n  #     [{:name=&gt;\"John Doe3\", :number=&gt;1, :cost=&gt;100}],\n  #     [{:name=&gt;\"John Doe2\", :number=&gt;2, :cost=&gt;300}]]\n\ne = d.flatten\n  #=&gt; [{:name=&gt;\"John Doe3\", :number=&gt;1, :cost=&gt;100},\n  #    {:name=&gt;\"John Doe2\", :number=&gt;2, :cost=&gt;300}]\n</code></pre>\n\n<p>We need to group the hashes once again, this time by the key <code>:number</code>.</p>\n\n<pre><code>f = e.group_by { |h| h[:number] }\n  #=&gt; {1=&gt;[{:name=&gt;\"John Doe3\", :number=&gt;1, :cost=&gt;100}],\n  #    2=&gt;[{:name=&gt;\"John Doe2\", :number=&gt;2, :cost=&gt;300}]}\n</code></pre>\n\n<p>Lastly, for each value (array of hashes) of <code>f</code>select the element <code>h</code> for which <code>h[:cost]</code> is largest.</p>\n\n<pre><code>f.transform_values { |v| v.max_by { |h| h[:cost] } }\n  # =&gt; {1=&gt;{:name=&gt;\"John Doe3\", :number=&gt;1, :cost=&gt;100},\n  #     2=&gt;{:name=&gt;\"John Doe2\", :number=&gt;2, :cost=&gt;300}}\n</code></pre>\n"}], "owner": {"reputation": 2132, "user_id": 856753, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1c53a71370f55d0f0a4cc7e4b2c06b91?s=128&d=identicon&r=PG", "display_name": "Micheal", "link": "https://stackoverflow.com/users/856753/micheal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 51386490, "answer_count": 2, "score": 0, "last_activity_date": 1531922248, "creation_date": 1531778959, "last_edit_date": 1531861295, "question_id": 51370735, "link": "https://stackoverflow.com/questions/51370735/improve-array-of-hashes-performance-while-returning-subset", "title": "improve array of hashes performance while returning subset", "body": "<ol>\n<li>1.I am trying to get the subset of array of hashes which will reject duplicate names that are greater than >=3</li>\n<li>for every 'number' key, return the subset of array of hashes with highest cost. If cost collides for that number return the first number (this number\nwas converted off a timestamp to reflect 1..24 hours)</li>\n</ol>\n\n<p>I was able to achieve the results with the following code:</p>\n\n<pre><code>a= [{:name=&gt;\"John Doe1\", :number=&gt;1, :cost=&gt;100},\n    {:name=&gt;\"John Doe3\", :number=&gt;1, :cost=&gt;100},\n    {:name=&gt;\"John Doe1\", :number=&gt;1, :cost=&gt;100},\n    {:name=&gt;\"John Doe1\", :number=&gt;1, :cost=&gt;100},\n    {:name=&gt;\"John Doe1\", :number=&gt;1, :cost=&gt;300},\n    {:name=&gt;\"John Doe2\", :number=&gt;2, :cost=&gt;300},\n    {:name=&gt;\"John Doe1\", :number=&gt;3, :cost=&gt;400}]\n\na.group_by { |el| el[:name] }.\n  reject { |_, v| v.size &gt;= 3 }.\n  values.\n  flatten.\n  sort_by {|h| h[:number]}.group_by{|el| el[:number]}.\n  values.\n  map{|el| el.max_by{|x| x[:cost]}}\n\n  #=&gt; [{:name=&gt;\"John Doe3\", :number=&gt;1, :cost=&gt;100},\n  #    {:name=&gt;\"John Doe2\", :number=&gt;2, :cost=&gt;300}]\n</code></pre>\n\n<p>Would the above result in O(n^2)</p>\n\n<p>What would be a better approach?</p>\n"}, {"tags": ["jquery", "ruby-on-rails", "ruby", "ajax"], "answers": [{"comments": [{"owner": {"reputation": 265, "user_id": 6897476, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/7d1f4b7fe23115a3cf52a7cc6a792f94?s=128&d=identicon&r=PG&f=1", "display_name": "danynl", "link": "https://stackoverflow.com/users/6897476/danynl"}, "edited": false, "score": 0, "creation_date": 1531776754, "post_id": 51370253, "comment_id": 89712964, "body": "No, it&#39;s not. Im looking for a way to dynamically update dropdown menu&#39;s based on user&#39;s selection.The menu should update if the department or name selection has been changed by the user."}], "tags": [], "owner": {"reputation": 1682, "user_id": 6392696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09WDQ.jpg?s=128&g=1", "display_name": "nourza", "link": "https://stackoverflow.com/users/6392696/nourza"}, "is_accepted": false, "score": 0, "last_activity_date": 1531775934, "creation_date": 1531775934, "answer_id": 51370253, "question_id": 51370119, "link": "https://stackoverflow.com/questions/51370119/populate-dynamic-dropdown-menu-in-rails/51370253#51370253", "title": "Populate dynamic dropdown menu in rails", "body": "<pre><code>              &lt;% Project.all.each do |f| %&gt;\n                &lt;%= link_to f.name,f %&gt;\n                &lt;%= link_to f.department,f %&gt;\n                &lt;%= link_to f.professor,f %&gt;\n              &lt;% end %&gt;\n</code></pre>\n\n<p>Is this what are you looking for?</p>\n"}, {"tags": [], "owner": {"reputation": 1165, "user_id": 143238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/faa7d5a8a0a4333e1e741aa41e802fc1?s=128&d=identicon&r=PG", "display_name": "BM5k", "link": "https://stackoverflow.com/users/143238/bm5k"}, "is_accepted": false, "score": 0, "last_activity_date": 1531782873, "creation_date": 1531782873, "answer_id": 51371213, "question_id": 51370119, "link": "https://stackoverflow.com/questions/51370119/populate-dynamic-dropdown-menu-in-rails/51371213#51371213", "title": "Populate dynamic dropdown menu in rails", "body": "<p>This sounds like a client-side problem to me. If your client is a web browser, you'll wind up doing this in javascript. Add an event listener to the <code>change</code> event for each dropdown.</p>\n"}], "owner": {"reputation": 265, "user_id": 6897476, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/7d1f4b7fe23115a3cf52a7cc6a792f94?s=128&d=identicon&r=PG&f=1", "display_name": "danynl", "link": "https://stackoverflow.com/users/6897476/danynl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1531783886, "creation_date": 1531775215, "last_edit_date": 1531783886, "question_id": 51370119, "link": "https://stackoverflow.com/questions/51370119/populate-dynamic-dropdown-menu-in-rails", "title": "Populate dynamic dropdown menu in rails", "body": "<p>I have a 'Course' model in my rails 5 app with a table defined as such:</p>\n\n<pre><code>class CreateCourse &lt; ActiveRecord::Migration[5.1]\n  def change\n    create_table :projects do |t|\n        t.string :name\n        t.string :department\n        t.string :professor\n    end\n  end\nend\n</code></pre>\n\n<p>I want to create a set of 3 dynamic drop down menus, with each dependent on the previous ones. </p>\n\n<p>Example:</p>\n\n<p>When users select the <code>department</code> in the first menu, it'll automatically filter and populate the second menu with the name of the records matching the selected <code>department</code>. After users have selected the <code>department</code> and the <code>name</code>, the 3rd menu should automatically be populated with the <code>professor</code> of the records that match those 2 criteria. </p>\n\n<p>Is there a way to do this in rails?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongodb", "ruby-on-rails-3", "mongoid"], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 8508408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/53ea69f3734d6b9383a35531d4c011bb?s=128&d=identicon&r=PG&f=1", "display_name": "compsy", "link": "https://stackoverflow.com/users/8508408/compsy"}, "edited": false, "score": 0, "creation_date": 1531811161, "post_id": 51374863, "comment_id": 89721807, "body": "Thanks man, you are life saviour.  Can you please explain what your code is actually doing. Its help me a lot"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "reply_to_user": {"reputation": 173, "user_id": 8508408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/53ea69f3734d6b9383a35531d4c011bb?s=128&d=identicon&r=PG&f=1", "display_name": "compsy", "link": "https://stackoverflow.com/users/8508408/compsy"}, "edited": false, "score": 0, "creation_date": 1531811483, "post_id": 51374863, "comment_id": 89721995, "body": "It iterates over <code>cust.children</code> and then recursively calls <code>descendents</code> on them, which returns their children, and call <code>descendents</code> on them, and so on."}, {"owner": {"reputation": 173, "user_id": 8508408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/53ea69f3734d6b9383a35531d4c011bb?s=128&d=identicon&r=PG&f=1", "display_name": "compsy", "link": "https://stackoverflow.com/users/8508408/compsy"}, "edited": false, "score": 0, "creation_date": 1531828394, "post_id": 51374863, "comment_id": 89732993, "body": "can you please help me to modified this above function to find out the Nth level of child. Not all children, fetch Children upto Nth level.    As I am trying to pass parameter to this method. but I got failed to use params in map and calling it recursively"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "reply_to_user": {"reputation": 173, "user_id": 8508408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/53ea69f3734d6b9383a35531d4c011bb?s=128&d=identicon&r=PG&f=1", "display_name": "compsy", "link": "https://stackoverflow.com/users/8508408/compsy"}, "edited": false, "score": 0, "creation_date": 1531830219, "post_id": 51374863, "comment_id": 89734275, "body": "That might take some time. Why don&#39;t you try on your own and if still cannot figure it out, ask a separate question so that others can help?"}, {"owner": {"reputation": 173, "user_id": 8508408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/53ea69f3734d6b9383a35531d4c011bb?s=128&d=identicon&r=PG&f=1", "display_name": "compsy", "link": "https://stackoverflow.com/users/8508408/compsy"}, "edited": false, "score": 0, "creation_date": 1531830328, "post_id": 51374863, "comment_id": 89734354, "body": "yeah sure. Thanks"}, {"owner": {"reputation": 131, "user_id": 2012807, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/455cfdae8ab910b08e83308bdbbdb588?s=128&d=identicon&r=PG", "display_name": "jfredson", "link": "https://stackoverflow.com/users/2012807/jfredson"}, "edited": false, "score": 0, "creation_date": 1589488541, "post_id": 51374863, "comment_id": 109323305, "body": "thank you so much for this. this is exactly what I was looking for."}], "tags": [], "owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "is_accepted": true, "score": 7, "last_activity_date": 1537828411, "last_edit_date": 1537828411, "creation_date": 1531809950, "answer_id": 51374863, "question_id": 51369739, "link": "https://stackoverflow.com/questions/51369739/get-all-children-of-children-and-so-on/51374863#51374863", "title": "Get all children of children and so on", "body": "<p>You can add a custom method to gather all the children of a customer, and children of children, and so on.</p>\n\n<pre><code>class Customer\n  def descendants\n    self.children | self.children.map(&amp;:descendants).flatten\n  end\nend\n\ncust = Customer.find(&lt;id&gt;)\ncust.descendants\n =&gt; # Array of all the descendants of customer\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 8508408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/53ea69f3734d6b9383a35531d4c011bb?s=128&d=identicon&r=PG&f=1", "display_name": "compsy", "link": "https://stackoverflow.com/users/8508408/compsy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1702, "favorite_count": 2, "accepted_answer_id": 51374863, "answer_count": 1, "score": 4, "last_activity_date": 1537828411, "creation_date": 1531773355, "last_edit_date": 1531775130, "question_id": 51369739, "link": "https://stackoverflow.com/questions/51369739/get-all-children-of-children-and-so-on", "title": "Get all children of children and so on", "body": "<p>I am using MongoDb as database.</p>\n\n<p>I want all the children of children and so on. \nLets Suppose </p>\n\n<ul>\n<li>A has B &amp; C children</li>\n<li>B has D &amp; E children</li>\n<li>D has F &amp; G children </li>\n</ul>\n\n<p>So when I query for children node <strong>A</strong>. I get all the children as output such as B C D E F G</p>\n\n<pre><code> C = Customer.find_by(:id =&gt; \"SOME_ID\")\n C.children #list all children upto one level\n</code></pre>\n\n<p>So can anyone suggest me the way, to get recursive children.</p>\n\n<p>Customer model</p>\n\n<pre><code>class Customer\n\n  include Mongoid::Document\n  field :email, type: String\n  field :referral_id, type: String\n  belongs_to :parent, class_name: 'Customer',foreign_key: \"referral_id\", optional: true\n  has_many :children, :class_name =&gt; 'Customer', :foreign_key =&gt; \"referral_id\"\n\nend\n</code></pre>\n\n<p>Can anybody please help me out. Or suggest a way to accomplish this.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-activerecord"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1531773041, "post_id": 51369540, "comment_id": 89711557, "body": "<a href=\"http://guides.rubyonrails.org/association_basics.html\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/association_basics.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "is_accepted": false, "score": 0, "last_activity_date": 1531773357, "creation_date": 1531773357, "answer_id": 51369741, "question_id": 51369540, "link": "https://stackoverflow.com/questions/51369540/ruby-how-to-use-activerecord-join-result/51369741#51369741", "title": "Ruby how to use ActiveRecord join result?", "body": "<p>You want to use <code>includes</code> to preload the records from your associations. Alternatively, you can use join and then <code>preload</code> your associations. You can also use <code>pluck</code> methods which would pull particular fields from the tables, like so:</p>\n\n<p><code>A.joins(...).pluck(\"table_name1.field_name, table_name2.field_name, table_name3.field_name\")</code></p>\n"}], "owner": {"reputation": 111, "user_id": 8355591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2128a79eed3d4392be9104b74164c891?s=128&d=identicon&r=PG&f=1", "display_name": "user8355591", "link": "https://stackoverflow.com/users/8355591/user8355591"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531773357, "creation_date": 1531772327, "question_id": 51369540, "link": "https://stackoverflow.com/questions/51369540/ruby-how-to-use-activerecord-join-result", "title": "Ruby how to use ActiveRecord join result?", "body": "<p>I have joined 3 tables like </p>\n\n<pre><code>result = A.joins(\"INNER JOIN B B1 ON A.id = B1.A_id\")\n          .joins(\"INNER JOIN B B2 on A.id = B2.A_id\")\n          .where(\"B1.key\" =&gt; \"B1\", \"B2.key\" =&gt; \"B2\")\n</code></pre>\n\n<p>how to retrieve objects A, B1, B2 separately? Like this? </p>\n\n<pre><code>result.map {|res|\n  A = res.A\n  B1 = res.B1\n  B2 = res.B2\n}\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-ec2", "deployment", "dns"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 10090278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01c803d670b2a859da737972dcbf81f5?s=128&d=identicon&r=PG&f=1", "display_name": "EsC369", "link": "https://stackoverflow.com/users/10090278/esc369"}, "edited": false, "score": 0, "creation_date": 1532362324, "post_id": 51383122, "comment_id": 89935159, "body": "I&#39;m not really sure what you mean... I followed my steps carfully on creating the instance from AWS. Are you refering to this file?       Under /etc/nginx/sites-available, rails.conf                                                                                                           server {       listen 80;        server_name &lt;public_ip_address&gt;;        passenger_enabled on;        passenger_app_env development;        root /var/www/&lt;your_project_folder&gt;/public;       }"}, {"owner": {"reputation": 3263, "user_id": 1269201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5903ce54bb170bb7d844a516df6154e5?s=128&d=identicon&r=PG", "display_name": "mdeora", "link": "https://stackoverflow.com/users/1269201/mdeora"}, "reply_to_user": {"reputation": 57, "user_id": 10090278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01c803d670b2a859da737972dcbf81f5?s=128&d=identicon&r=PG&f=1", "display_name": "EsC369", "link": "https://stackoverflow.com/users/10090278/esc369"}, "edited": false, "score": 0, "creation_date": 1532363261, "post_id": 51383122, "comment_id": 89935658, "body": "yes in &lt;public_ip_address&gt; also add your domain name."}], "tags": [], "owner": {"reputation": 3263, "user_id": 1269201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5903ce54bb170bb7d844a516df6154e5?s=128&d=identicon&r=PG", "display_name": "mdeora", "link": "https://stackoverflow.com/users/1269201/mdeora"}, "is_accepted": false, "score": -1, "last_activity_date": 1531835360, "creation_date": 1531835360, "answer_id": 51383122, "question_id": 51369433, "link": "https://stackoverflow.com/questions/51369433/deployment-works-when-using-ftp-but-not-the-domain-aws-ec2/51383122#51383122", "title": "Deployment Works when using ftp, but not the domain?. AWS EC2,", "body": "<p>You have a incorrect virtual host settings, Check again your webserver's virtual host entry.</p>\n"}], "owner": {"reputation": 57, "user_id": 10090278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01c803d670b2a859da737972dcbf81f5?s=128&d=identicon&r=PG&f=1", "display_name": "EsC369", "link": "https://stackoverflow.com/users/10090278/esc369"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1531835360, "creation_date": 1531771863, "question_id": 51369433, "link": "https://stackoverflow.com/questions/51369433/deployment-works-when-using-ftp-but-not-the-domain-aws-ec2", "title": "Deployment Works when using ftp, but not the domain?. AWS EC2,", "body": "<p>So Ive had this practice project deployed for a while, but the issue is now when I connected a domain name to the deployment, it suddenly doesn't work?</p>\n\n<p>the website works perfectly when going to the ip address 18.222.146.180\nbut when putting the domain thats attached, <a href=\"http://stockstrack.org/\" rel=\"nofollow noreferrer\">http://stockstrack.org/</a> it suddenly breaks and has no css??\nI even added other things ive found online into the application file to ensure that it read/attached the css, and still nothing? This whole thing was created with ruby on rails using postgres database. Any help is greatly appreciated, thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 2168, "user_id": 4386626, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/f2c9512ee4dac8ccbbf45fc2cf1a8046?s=128&d=identicon&r=PG&f=1", "display_name": "ToddT", "link": "https://stackoverflow.com/users/4386626/toddt"}, "edited": false, "score": 0, "creation_date": 1531768477, "post_id": 51368590, "comment_id": 89709656, "body": "ahh perfect! I was confused on the object part as my methods were not in a class of their own.. I&#39;ll accept this one once I can! thanks much"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 3, "creation_date": 1531772866, "post_id": 51368590, "comment_id": 89711483, "body": "<a href=\"http://ruby-doc.org/core-2.4.0/Object.html#method-i-public_send\" rel=\"nofollow noreferrer\">Object#pubilc_send</a> is recommended when sending public methods (to avoid the inadvertent sending of private methods). I don&#39;t think you need <code>self.</code>."}], "tags": [], "owner": {"reputation": 3359, "user_id": 618467, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/624972b91564b142ec8481dde0b92898?s=128&d=identicon&r=PG", "display_name": "Tiago Farias", "link": "https://stackoverflow.com/users/618467/tiago-farias"}, "is_accepted": true, "score": 2, "last_activity_date": 1531768269, "last_edit_date": 1531768269, "creation_date": 1531767961, "answer_id": 51368590, "question_id": 51368542, "link": "https://stackoverflow.com/questions/51368542/dynamically-call-a-method-based-on-a-variable-name/51368590#51368590", "title": "Dynamically call a method based on a variable name", "body": "<p>You can call Object#send passing the method name and the params. In your case, it would be like:</p>\n\n<p><code>self.send(\"handle_#{speed}_rates\", speed_from_db)</code></p>\n\n<p>Take a look at <a href=\"https://apidock.com/ruby/Object/send\" rel=\"nofollow noreferrer\">https://apidock.com/ruby/Object/send</a></p>\n"}], "owner": {"reputation": 2168, "user_id": 4386626, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/f2c9512ee4dac8ccbbf45fc2cf1a8046?s=128&d=identicon&r=PG&f=1", "display_name": "ToddT", "link": "https://stackoverflow.com/users/4386626/toddt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 51368590, "answer_count": 1, "score": 0, "last_activity_date": 1531768269, "creation_date": 1531767693, "question_id": 51368542, "link": "https://stackoverflow.com/questions/51368542/dynamically-call-a-method-based-on-a-variable-name", "title": "Dynamically call a method based on a variable name", "body": "<p>I have an app that calculates shipping costs based on the \"speed\" a user selects. I'm trying to refactor this if statement based on those speeds. This is the current if statement:</p>\n\n<pre><code>  def walk_thru_each_rate_type(speed_hash, speed_from_db)\n    if speed_hash.has_key?(\"flex\")\n      handle_flex_rates(speed_from_db)\n    end\n    if speed_hash.has_key?(\"fixed\")\n      handle_fixed_rates(speed_from_db)\n    end\n    if speed_hash.has_key?(\"free\")\n      handle_free_shipping(speed_from_db)\n    end\n  end\n</code></pre>\n\n<p>So each method is just based on the \"speed\". <code>flex, fixed or free</code> and the method names have those speeds in them. I was thinking something like this, but it doesn't work:</p>\n\n<pre><code>handle_\"#{speed}\"_rates(speed_from_db)\n</code></pre>\n\n<p>How can I dynamically call my method based on the speed name?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "spree"], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 9731909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a7fa77b0f155cfe3130d550be5e6c30?s=128&d=identicon&r=PG", "display_name": "user9731909", "link": "https://stackoverflow.com/users/9731909/user9731909"}, "is_accepted": true, "score": 1, "last_activity_date": 1531773526, "creation_date": 1531773526, "answer_id": 51369771, "question_id": 51368536, "link": "https://stackoverflow.com/questions/51368536/rails-decorating-controllers-for-spree/51369771#51369771", "title": "Rails decorating controllers for spree", "body": "<pre><code>V1::TaxonsController.class_eval do\n  def navigation\n  end\nend\n</code></pre>\n\n<p>Creates the navigation instance method on the V1::TaxonsController class. When you omit V1 with Ruby's scope resolution operator (::), then the navigation instance method is not created on the V1::TaxonsController class, but on the TaxonsController class. I am guessing that the TaxonsController class is defined like this if it's a Rails controller:</p>\n\n<pre><code>class V1::TaxonsController &lt; ApplicationController\nend\n</code></pre>\n\n<p>This would indicate that the above TaxonsController class is in a V1 directory in the Rails app (app/controllers/V1). So if you define an extra method on the TaxonsController class using class_eval like so:</p>\n\n<pre><code>TaxonsController.class_eval do\n  def navigation\n  end\nend\n</code></pre>\n\n<p>Then the navigation method would not be defined on TaxonsController in app/controllers/V1.</p>\n\n<p>I hope this helps.</p>\n"}], "owner": {"reputation": 374, "user_id": 9290107, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uaazeTb-DBE/AAAAAAAAAAI/AAAAAAAAAC0/bKKxFLCNxYk/photo.jpg?sz=128", "display_name": "Eric Nordelo Galiano", "link": "https://stackoverflow.com/users/9290107/eric-nordelo-galiano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 51369771, "answer_count": 1, "score": 1, "last_activity_date": 1531773526, "creation_date": 1531767651, "question_id": 51368536, "link": "https://stackoverflow.com/questions/51368536/rails-decorating-controllers-for-spree", "title": "Rails decorating controllers for spree", "body": "<p>Simple ruby question I guess.</p>\n\n<p>Why is this working?:</p>\n\n<pre><code>module Spree\n  module Api\n    module V1\n      V1::TaxonsController.class_eval do\n        def navigation\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>And when I do this:</p>\n\n<pre><code>module Spree\n  module Api\n    module V1\n      TaxonsController.class_eval do\n        def navigation\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>I get \"UnknowAction\", The action 'navigation' could not be found for Spree::Api::V1::TaxonsController</p>\n\n<p>What I'm missing with the modules ?</p>\n"}, {"tags": ["ruby", "class", "oop"], "answers": [{"tags": [], "owner": {"reputation": 95, "user_id": 8473377, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fd46a4c744c9b1390db2123cf8575610?s=128&d=identicon&r=PG&f=1", "display_name": "Mate Gvenetadze", "link": "https://stackoverflow.com/users/8473377/mate-gvenetadze"}, "is_accepted": true, "score": 1, "last_activity_date": 1531767167, "creation_date": 1531767167, "answer_id": 51368404, "question_id": 51368325, "link": "https://stackoverflow.com/questions/51368325/how-to-add-created-objects-in-static-array/51368404#51368404", "title": "how to add created objects in static array?", "body": "<p>You can use \"conditional assignment operator\" to check if array is nil.</p>\n\n<pre><code>def initialize(name, last_name, age = \"no_age\")\n    @@persons ||= []\n    @name = name\n    @last_name = last_name\n    @age = age\n    add(@name, @last_name, @age)\n  end\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8555782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b8c6847774c0dc7af57962f99a9cc41?s=128&d=identicon&r=PG&f=1", "display_name": "Luka Mamulaishvili", "link": "https://stackoverflow.com/users/8555782/luka-mamulaishvili"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 51368404, "answer_count": 1, "score": 0, "last_activity_date": 1531767167, "creation_date": 1531766796, "question_id": 51368325, "link": "https://stackoverflow.com/questions/51368325/how-to-add-created-objects-in-static-array", "title": "how to add created objects in static array?", "body": "<p>How can i add all created objects in <code>self.persons</code> ? </p>\n\n<pre><code>class Person\n  attr_accessor :name, :last_name, :age\n  def initialize(name, last_name, age = \"no_age\")\n    @@persons = []\n    @name = name\n    @last_name = last_name\n    @age = age\n    add(@name, @last_name, @age)\n  end\n\n  def self.persons\n    @@persons\n  end\n\n  private\n  def add(name, last_name, age)\n    @@persons &lt;&lt; [name, last_name, age]\n  end\nend\n\nperson1 = Person.new(\"name1\", \"lastname1\", 12)\nperson2 = Person.new(\"name2\", \"lastname2\", 16)\n\np Person.persons # =&gt; [[\"name2\", \"lastname2\", 16]]\n</code></pre>\n"}, {"tags": ["ruby", "selenium", "capybara", "site-prism"], "answers": [{"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": false, "score": 1, "last_activity_date": 1531767328, "creation_date": 1531767328, "answer_id": 51368452, "question_id": 51368096, "link": "https://stackoverflow.com/questions/51368096/how-do-i-access-a-checkbox-with-ruby-capybara-selenium/51368452#51368452", "title": "How do I access a checkbox with ruby capybara/selenium", "body": "<p>I'm guessing the actual checkbox element isn't visible on the page and has been hidden via CSS to replace with an image for styling reasons. Check the styles applied to the actual checkbox element for <code>display: none</code>, <code>opacity: 0</code>, etc.</p>\n\n<p>To work with this you can either click the label element associated with the checkbox or  pass the <code>allow_label_click</code> element to <code>check</code> to have it click the associated label when the actual checkbox is unclickable. Another potential option if there isn't a visible associated label element is to just click the <code>td</code> element - which will trigger a click in the middle of the <code>td</code> which should actually hit the checkbox replacement.  Assuming you have the row element already (<code>tr</code>) one of the following should work</p>\n\n<pre><code>tr.check(class: 'k-checkbox', allow_label_click: true)\ntr.find('label.k-checkbox-label').click\n</code></pre>\n\n<p>Not as understandable but may work/be necessary in some cases</p>\n\n<pre><code>tr.find('td:first-child').click\n</code></pre>\n"}], "owner": {"reputation": 2096, "user_id": 2108990, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/886481640b3ab8f05cdf3be8c0efdad6?s=128&d=identicon&r=PG", "display_name": "Zack", "link": "https://stackoverflow.com/users/2108990/zack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531767328, "creation_date": 1531765887, "last_edit_date": 1531766264, "question_id": 51368096, "link": "https://stackoverflow.com/questions/51368096/how-do-i-access-a-checkbox-with-ruby-capybara-selenium", "title": "How do I access a checkbox with ruby capybara/selenium", "body": "<p>My usual method of obtaining a checkbox doesn't appear to be working here... Basically I have a table with some data in it but the first <code>td</code> is a checkbox. What I am trying to do is click on that checkbox, yet no mater what I do, it seems to not be present on the screen or at least it is not clickable. I've tried using xpath with <code>td[1]</code>, <code>td[1]/input</code>, <code>td[1]/input[@data-role=\"checkbox\"]</code> and a number of other permutations but no luck... I am using SitePrism and within the row already so I should be able to get right to these elements. For example using <code>td[2]</code> with <code>.text</code> gives me <code>Foo</code> no problem... But it is almost as if the checkbox is not there.</p>\n\n<p>Additionally if I try doing <code>all('input').size</code> or <code>all('label').size</code> I am getting 0, which indicates to me that those aren't rendering despite clearly being displayed on the page and inspected via chrome dev tools. </p>\n\n<pre><code>&lt;tr data-uid=\"123\" role=\"row\" class=\"state-selected\" tabindex=\"1008\"&gt;\n    &lt;td aria-describedby=\"75e50a2e-9354-43aa-90af-231170f41b4f\" role=\"gridcell\"&gt;\n        &lt;input class=\"k-checkbox\" data-role=\"checkbox\" id=\"3a3d214a-9e48-4c3e-869d-9821b42ded19\" aria-label=\"Select row\" aria-checked=\"false\" type=\"checkbox\" tabindex=\"-1\"&gt;\n        &lt;label for=\"3a3d214a-9e48-4c3e-869d-9821b42ded19\" class=\"k-checkbox-label k-no-text\"&gt;&amp;#8203;&lt;/label&gt;\n    &lt;/td&gt;\n    &lt;td class=\"gridDataString\" tabindex=\"-1\" aria-describedby=\"6e767f1c-78a3-4988-9633-17bcab112766\" role=\"gridcell\"&gt;\n        &lt;span&gt;Foo&lt;/span&gt;\n    &lt;/td&gt;\n    &lt;td class=\"gridDataString\" tabindex=\"-1\" aria-describedby=\"2f654308-1ddb-4f54-a3bf-2d6c36980378\" role=\"gridcell\"&gt;\n        &lt;span&gt;Bar&lt;/span&gt;\n    &lt;/td&gt;\n    &lt;td class=\"gridDataString\" tabindex=\"-1\" aria-describedby=\"3ae4ac0a-e16d-4892-b8ad-a821adeb55ee\" role=\"gridcell\"&gt;\n        &lt;span&gt;&lt;/span&gt;\n    &lt;/td&gt;\n    &lt;td class=\"gridDataString\" tabindex=\"-1\" aria-describedby=\"f443994b-3e0f-4e8e-a658-f5efe839bb5e\" role=\"gridcell\"&gt;\n        &lt;span&gt;Foo Barrr&lt;/span&gt;&lt;/td&gt;\n    &lt;td class=\"gridDataString\" tabindex=\"-1\" style=\"display:none\" aria-describedby=\"0f49ae1e-765e-4f99-83b1-46aa3067ac5f\" role=\"gridcell\"&gt;\n        &lt;span ng-bind=\"dataItem.modelId\"&gt;0x0000000000004701,0x00000000000811f9,&lt;/span&gt;\n    &lt;/td&gt;\n&lt;/tr&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "polymorphism", "eager-loading", "awesome-nested-set"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1531786545, "post_id": 51368053, "comment_id": 89715216, "body": "One of the major cons of polymorphism is the spotty support for eager loading since ActiveRecord actually has to fetch the data to determine which table to join."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1531787659, "post_id": 51368053, "comment_id": 89715405, "body": "What you would need would be something like <code>SELECT a.*, b.* FROM a LEFT OUTER JOIN a.b_type ON (b.id = a.b_id)</code> - but there is no polyglot way to dynamically insert the name of the joined table. If this is performance critical I would consider using an alternative solution such as STI."}, {"owner": {"reputation": 699, "user_id": 6873497, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7e17e7b7f298bbf51382bd565add516a?s=128&d=identicon&r=PG&f=1", "display_name": "matiss", "link": "https://stackoverflow.com/users/6873497/matiss"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1531805610, "post_id": 51368053, "comment_id": 89719131, "body": "@max Thank you for clearing out. I think I&#39;ve over-complicated, because all I needed was to group my <code>Ratecard::RuleIndex</code>. It looks like I can do it with <a href=\"http://guides.rubyonrails.org/association_basics.html#belongs-to-association-reference\" rel=\"nofollow noreferrer\">self joins</a> rather than using Awesome Nested Set."}], "owner": {"reputation": 699, "user_id": 6873497, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7e17e7b7f298bbf51382bd565add516a?s=128&d=identicon&r=PG&f=1", "display_name": "matiss", "link": "https://stackoverflow.com/users/6873497/matiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 258, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531765698, "creation_date": 1531765698, "question_id": 51368053, "link": "https://stackoverflow.com/questions/51368053/rails-5-1-eager-load-child-records-in-polymorphic-association", "title": "Rails 5.1: eager load child records in polymorphic association", "body": "<p>I have rather complex association where I use <a href=\"https://github.com/collectiveidea/awesome_nested_set/wiki/Awesome-nested-set-cheat-sheet\" rel=\"nofollow noreferrer\">awesone_nested_set gem</a> to manage <code>Ratecard::RuleIndex</code> parents and children:</p>\n\n<pre><code>class Inventory::Inventory &lt; ApplicationRecord\n  has_many :ratecards_rules, class_name: 'Ratecard::RatecardsRule', through: :ratecards\n  has_many :rule_indices, class_name: 'Ratecard::RuleIndex', through: :ratecards do\n    def children\n      Ratecard::RuleIndex.each_with_level(Ratecard::RuleIndex.root.children) do |index, level|\n        puts index.index_value\n      end\n    end\n  end\nend\n\nclass Ratecard::Ratecard &lt; ApplicationRecord\n  has_many :ratecards_rules, class_name: 'Ratecard::RatecardsRule'\n  has_many :rule_indices, class_name: 'Ratecard::RuleIndex', \n            through: :ratecards_rules, source: :rulable, \n            source_type: 'Ratecard::RuleIndex'\nend\n\nclass Ratecard::RatecardsRule &lt; ApplicationRecord\n  belongs_to :rulable, polymorphic: true, optional: true\nend\n\nclass Ratecard::Rule &lt; ApplicationRecord\n  has_many :ratecards_rules, class_name: 'Ratecard::RatecardsRule', as: :rulable\n  has_many :ratecards, class_name: 'Ratecard::Ratecard', through: :ratecards_rules\nend\n\nclass Ratecard::RuleIndex &lt; Ratecard::Rule\n  has_many :ratecards_rules, class_name: 'Ratecard::RatecardsRule', as: :rulable\n  has_many :ratecards, class_name: 'Ratecard::Ratecard', through: :ratecards_rules\nend\n</code></pre>\n\n<p>In my console I can do:</p>\n\n<pre><code>i=Inventory::Inventory.where(id: [200,201,202]).includes(:ratecards)\n                      .where(ratecard_ratecards: {id: 1}).preload(:rule_indices)\n</code></pre>\n\n<p>which preloads <code>Ratecard::RuleIndex</code> parent records (indices). However I need to somehow preload children records. At the moment when I do</p>\n\n<p><code>i.collect{|x| {indices: x.rule_indices.children.collect{|i| {id: i.index_value}} }}</code></p>\n\n<p>I get my desired output, however extra queries are performed and it looks like his:</p>\n\n<pre><code>Ratecard::RuleIndex Load (0.8ms)  SELECT  \"ratecard_rules\".* FROM \"ratecard_rules\" WHERE \"ratecard_rules\".\"type\" IN ('Ratecard::RuleIndex') AND \"ratecard_rules\".\"parent_id\" IS NULL ORDER BY \"ratecard_rules\".\"lft\" ASC LIMIT $1  [[\"LIMIT\", 1]]\nRatecard::Rule Load (0.5ms)  SELECT \"ratecard_rules\".* FROM \"ratecard_rules\" WHERE \"ratecard_rules\".\"parent_id\" = $1 ORDER BY \"ratecard_rules\".\"lft\" ASC  [[\"parent_id\", 60]]\n0.95\n=&gt; [{:indices=&gt;[{:id=&gt;0.95e0}]}]\n</code></pre>\n\n<p><strong>Is there some way to preload (due to Polymorphic association and need especially \"preload\") my child records so I don't get later N+1 queries?</strong>\nI'd be happy for any  hint. Thank you.</p>\n\n<p>So far I've been trying to implement <a href=\"http://www.chrisrolle.com/en/blog/extending-has_many-association-proxy\" rel=\"nofollow noreferrer\">has_many associaion extension</a>, but it doesn't give me desired result as I can't make my children records to be preloaded.\nI understand this is due to my query goes to Ratecard::RatecardsRule, where my \"parent\" indices records are grabbed by <code>rulable_type</code> and <code>rulable_id</code>. It would be great if I can somehow make to preload child records (stored in \"ratecard_rules\" table togeher with parents and managed with Awesome Nested Set gem).</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 2132, "user_id": 856753, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1c53a71370f55d0f0a4cc7e4b2c06b91?s=128&d=identicon&r=PG", "display_name": "Micheal", "link": "https://stackoverflow.com/users/856753/micheal"}, "edited": false, "score": 0, "creation_date": 1531766390, "post_id": 51368087, "comment_id": 89708791, "body": "i want only duplicate name count. the above code considers name and number"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 2132, "user_id": 856753, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1c53a71370f55d0f0a4cc7e4b2c06b91?s=128&d=identicon&r=PG", "display_name": "Micheal", "link": "https://stackoverflow.com/users/856753/micheal"}, "edited": false, "score": 1, "creation_date": 1531779986, "post_id": 51368087, "comment_id": 89713923, "body": "Not a problem at all. Almost the same with just an additional operation."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1531793564, "post_id": 51368087, "comment_id": 89716464, "body": "Using <code>count</code> here is relatively inefficient as it must be repeated for each element  of the array, making its computational complexity O(n^2). I&#39;m sure you know there are ways of making those counts that are O(n)."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": false, "score": 3, "last_activity_date": 1531779881, "last_edit_date": 1531779881, "creation_date": 1531765841, "answer_id": 51368087, "question_id": 51367980, "link": "https://stackoverflow.com/questions/51367980/ruby-reject-only-certain-duplicates-from-an-array-of-hashes/51368087#51368087", "title": "ruby reject only certain duplicates from an array of hashes", "body": "<p><a href=\"https://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-reject\" rel=\"nofollow noreferrer\"><code>Enumerable#reject</code></a> and <a href=\"https://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-count\" rel=\"nofollow noreferrer\"><code>Enumerable#count</code></a> might help:</p>\n\n<pre><code>arr = [\n    {:name=&gt;\"John Doe1\", :number=&gt;\"5551234567\"},\n    {:name=&gt;\"John Doe1\", :number=&gt;\"5551234567\"},\n    {:name=&gt;\"John Doe2\", :number=&gt;\"5557654321\"},\n    {:name=&gt;\"John Doe1\", :number=&gt;\"5551234567\"}\n]\np arr.reject { |hsh| arr.count(hsh) &gt; 2 }\n# =&gt; [{:name=&gt;\"John Doe2\", :number=&gt;\"5557654321\"}]\n</code></pre>\n\n<p>Based on the comment, adding the use <a href=\"https://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-map\" rel=\"nofollow noreferrer\"><code>Enumerable#map</code></a>:</p>\n\n<pre><code>names = arr.map { |hsh| hsh[:name] }\np arr.reject { |hsh| names.count(hsh[:name]) &gt; 2 }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1531846510, "post_id": 51368177, "comment_id": 89745257, "body": "This does not preserve the order of the elements of the given array."}], "tags": [], "owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "is_accepted": true, "score": 1, "last_activity_date": 1531766191, "creation_date": 1531766191, "answer_id": 51368177, "question_id": 51367980, "link": "https://stackoverflow.com/questions/51367980/ruby-reject-only-certain-duplicates-from-an-array-of-hashes/51368177#51368177", "title": "ruby reject only certain duplicates from an array of hashes", "body": "<p>This is O(n) and might do better on a larger list:</p>\n\n<pre><code>a.group_by { |el| el[:name] }.reject { |_, v| v.size &gt; 2 }.values.flatten\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1531793625, "post_id": 51369318, "comment_id": 89716478, "body": "Using <code>count</code> is relatively inefficient. See my commnet on @Sebastain&#39;s answer."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1531843752, "post_id": 51369318, "comment_id": 89743802, "body": "@CarySwoveland thank you for the inspiration. I have updated my answer completely and both options are more efficient than all the other answers posted according to fruity."}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 0, "last_activity_date": 1531844485, "last_edit_date": 1531844485, "creation_date": 1531771297, "answer_id": 51369318, "question_id": 51367980, "link": "https://stackoverflow.com/questions/51367980/ruby-reject-only-certain-duplicates-from-an-array-of-hashes/51369318#51369318", "title": "ruby reject only certain duplicates from an array of hashes", "body": "<p>The whole answer has been re-written as inspired by @CarySwoveland (for previous implementations please feel free to look at the edits).</p>\n\n<p>These 2 options seem to be the most efficient way possible to handle this situation </p>\n\n<pre><code>a.group_by { |el| el[:name] }.each_with_object([]) do |(_, v),obj| \n  obj.concat(v) if v.size &lt; 3 \nend\n#or \na.group_by { |el| el[:name] }.flat_map { |_, v| v if v.size &lt; 3 }.compact\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1531793149, "creation_date": 1531793149, "answer_id": 51372248, "question_id": 51367980, "link": "https://stackoverflow.com/questions/51367980/ruby-reject-only-certain-duplicates-from-an-array-of-hashes/51372248#51372248", "title": "ruby reject only certain duplicates from an array of hashes", "body": "<p>Suppose we are give the following array (which differs from that given in the question).</p>\n\n<pre><code>arr = [{ :name=&gt;\"John Doe1\", :number=&gt;\"5551234567\" },\n       { :name=&gt;\"John Doe3\", :number=&gt;\"5551234567\" },\n       { :name=&gt;\"John Doe1\", :number=&gt;\"5551234567\" },\n       { :name=&gt;\"John Doe2\", :number=&gt;\"5557654321\" },\n       { :name=&gt;\"John Doe3\", :number=&gt;\"5551234567\" },\n       { :name=&gt;\"John Doe1\", :number=&gt;\"5551234567\" }]\n</code></pre>\n\n<p>We can obtain the desired value as follows.</p>\n\n<pre><code>arr.values_at(*arr.each_with_index.with_object({}) { |(g,i),h| (h[g] ||= []) &lt;&lt; i }.\n    values.\n    select { |a| a.size &lt; 3 }.\n    flatten.\n    sort)\n  #=&gt; [{:name=&gt;\"John Doe3\", :number=&gt;\"5551234567\"},\n  #    {:name=&gt;\"John Doe2\", :number=&gt;\"5557654321\"},\n  #    {:name=&gt;\"John Doe3\", :number=&gt;\"5551234567\"}]\n</code></pre>\n\n<p>The steps are as follows.</p>\n\n<pre><code>enum0 = arr.each_with_index\n  #=&gt; #&lt;Enumerator: [{:name=&gt;\"John Doe1\", :number=&gt;\"5551234567\"},\n  #                  {:name=&gt;\"John Doe3\", :number=&gt;\"5551234567\"},\n  #                   ...\n  #                  {:name=&gt;\"John Doe1\", :number=&gt;\"5551234567\"}]:each_with_index&gt;\nenum1 = enum0.with_object({})\n  #=&gt; #&lt;Enumerator:\n  #     #&lt;Enumerator: [{:name=&gt;\"John Doe1\", :number=&gt;\"5551234567\"},\n  #                    {:name=&gt;\"John Doe3\", :number=&gt;\"5551234567\"},\n  #                    ...\n  #                    {:name=&gt;\"John Doe1\", :number=&gt;\"5551234567\"}]:each_with_index&gt;\n  #   :with_object({})&gt;\nb = enum1.each { |(g,i),h| (h[g] ||= []) &lt;&lt; i }\n  #=&gt; {{:name=&gt;\"John Doe1\", :number=&gt;\"5551234567\"}=&gt;[0, 2, 5],\n  #    {:name=&gt;\"John Doe3\", :number=&gt;\"5551234567\"}=&gt;[1, 4],\n  #    {:name=&gt;\"John Doe2\", :number=&gt;\"5557654321\"}=&gt;[3]}\nc = b.values\n  #=&gt; [[0, 2, 5], [1, 4], [3]]\nd = c.select { |a| a.size &lt; 3 }\n  #=&gt; [[1, 4], [3]]\nf = e.sort\n  #=&gt; [1, 3, 4]\narr.values_at(*f)\n  #=&gt; [{:name=&gt;\"John Doe3\", :number=&gt;\"5551234567\"},\n  #    {:name=&gt;\"John Doe2\", :number=&gt;\"5557654321\"},\n  #    {:name=&gt;\"John Doe3\", :number=&gt;\"5551234567\"}]\n</code></pre>\n"}], "owner": {"reputation": 2132, "user_id": 856753, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1c53a71370f55d0f0a4cc7e4b2c06b91?s=128&d=identicon&r=PG", "display_name": "Micheal", "link": "https://stackoverflow.com/users/856753/micheal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 0, "accepted_answer_id": 51368177, "answer_count": 4, "score": 1, "last_activity_date": 1531844485, "creation_date": 1531765460, "question_id": 51367980, "link": "https://stackoverflow.com/questions/51367980/ruby-reject-only-certain-duplicates-from-an-array-of-hashes", "title": "ruby reject only certain duplicates from an array of hashes", "body": "<p>I want to reject duplicates from an array of hashes based on the count of duplicates( >=3).</p>\n\n<p>For eg: The criteria for a duplicate is just the name, regardless of the number.</p>\n\n<pre><code>a = [{:name=&gt;\"John Doe1\", :number=&gt;\"5551234567\"},\n         {:name=&gt;\"John Doe1\", :number=&gt;\"5551234567\"},\n              {:name=&gt;\"John Doe2\", :number=&gt;\"5557654321\"},\n               {:name=&gt;\"John Doe1\", :number=&gt;\"5551234567\"}]\n</code></pre>\n\n<p>I want to reject the \"names\" which are duplicated more than 2 times.\nThe function should return:</p>\n\n<pre><code>[{:name=&gt;\"John Doe2\", :number=&gt;\"5557654321\"}]\n</code></pre>\n\n<p>I tried below which is probably incorrect:</p>\n\n<pre><code>a.group_by{|e| e}.select{ |k, v| k[:name].size &gt;=3}.reject\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 3702199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbf06ca844c89bada71ac9d092026a9?s=128&d=identicon&r=PG&f=1", "display_name": "Ferdinand", "link": "https://stackoverflow.com/users/3702199/ferdinand"}, "edited": false, "score": 0, "creation_date": 1531795876, "post_id": 51368203, "comment_id": 89716926, "body": "thank you for your support. but in this form. there is no model for that."}, {"owner": {"reputation": 74, "user_id": 6392323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b186c66fda6d1a2d20732a8d8fe0503e?s=128&d=identicon&r=PG&f=1", "display_name": "theberbie", "link": "https://stackoverflow.com/users/6392323/theberbie"}, "reply_to_user": {"reputation": 87, "user_id": 3702199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbf06ca844c89bada71ac9d092026a9?s=128&d=identicon&r=PG&f=1", "display_name": "Ferdinand", "link": "https://stackoverflow.com/users/3702199/ferdinand"}, "edited": false, "score": 0, "creation_date": 1531795916, "post_id": 51368203, "comment_id": 89716929, "body": "Do you have a post.rb?"}, {"owner": {"reputation": 74, "user_id": 6392323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b186c66fda6d1a2d20732a8d8fe0503e?s=128&d=identicon&r=PG&f=1", "display_name": "theberbie", "link": "https://stackoverflow.com/users/6392323/theberbie"}, "reply_to_user": {"reputation": 87, "user_id": 3702199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbf06ca844c89bada71ac9d092026a9?s=128&d=identicon&r=PG&f=1", "display_name": "Ferdinand", "link": "https://stackoverflow.com/users/3702199/ferdinand"}, "edited": false, "score": 0, "creation_date": 1531796198, "post_id": 51368203, "comment_id": 89716994, "body": "Yes. Basically, the model is a class that talks to the database and validates the data. You can create the model by running rails g model Post. You will see a migration file where you will be able to add the fields (name, email etc) and then you can run rake db:migrate to perform the migration.  <a href=\"https://www.culttt.com/2015/09/30/creating-your-first-ruby-on-rails-model/\" rel=\"nofollow noreferrer\">culttt.com/2015/09/30/creating-your-first-ruby-on-rails-mode&zwnj;&#8203;l</a>"}], "tags": [], "owner": {"reputation": 74, "user_id": 6392323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b186c66fda6d1a2d20732a8d8fe0503e?s=128&d=identicon&r=PG&f=1", "display_name": "theberbie", "link": "https://stackoverflow.com/users/6392323/theberbie"}, "is_accepted": false, "score": 0, "last_activity_date": 1531766293, "creation_date": 1531766293, "answer_id": 51368203, "question_id": 51367046, "link": "https://stackoverflow.com/questions/51367046/validation-form-in-controllers-ruby-on-rails/51368203#51368203", "title": "validation form in controllers ruby on rails", "body": "<p>You can create validations in the model, and then in the controller, define what the error is, and then render it in the view.</p>\n\n<p>For example, in your model, do something like:</p>\n\n<pre><code>validates :name, presence: true\n</code></pre>\n\n<p>In the controller, send error message to:</p>\n\n<pre><code>@error = @post.errors.full_message \n</code></pre>\n\n<p>In the view, you can do something like: </p>\n\n<pre><code>&lt;% if !@error.nil? %&gt; \n  &lt;span&gt; &lt;%= @error. %&gt; &lt;/span&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "is_accepted": false, "score": 3, "last_activity_date": 1531766783, "creation_date": 1531766783, "answer_id": 51368324, "question_id": 51367046, "link": "https://stackoverflow.com/questions/51367046/validation-form-in-controllers-ruby-on-rails/51368324#51368324", "title": "validation form in controllers ruby on rails", "body": "<p>You do not put validations in controllers, you put validations in your models. I suggest that you read <a href=\"http://guides.rubyonrails.org/active_record_validations.html\" rel=\"nofollow noreferrer\">this guide</a>. Your code needs to look like this:</p>\n\n<p><code>post.rb</code></p>\n\n<pre><code>validates :name, :email, presence: true\n</code></pre>\n\n<p>Additionally, if you use <a href=\"https://github.com/plataformatec/simple_form\" rel=\"nofollow noreferrer\">simple_form</a> gem you will get those <code>*</code> symbols by the required fields by default. All you need to do is to add a validation rule to the attribute of your model.</p>\n\n<p>If you want to send an email automatically after the Post is created, I suggest that you read <a href=\"http://guides.rubyonrails.org/active_job_basics.html\" rel=\"nofollow noreferrer\">this guide</a> and <a href=\"http://guides.rubyonrails.org/action_mailer_basics.html\" rel=\"nofollow noreferrer\">this guide</a>. Basically, what you need to pay attention to is to separate the process of creating a Post from the process of sending an email, therefore, what I advise you to do is to create a job which will send an email in the background. To sum up, frist you want to validate your <code>post</code> model and, when it's valid, you want to run a background job, which would send an email. I hope this makes sense to you.</p>\n"}], "owner": {"reputation": 87, "user_id": 3702199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbf06ca844c89bada71ac9d092026a9?s=128&d=identicon&r=PG&f=1", "display_name": "Ferdinand", "link": "https://stackoverflow.com/users/3702199/ferdinand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1531766783, "creation_date": 1531761520, "question_id": 51367046, "link": "https://stackoverflow.com/questions/51367046/validation-form-in-controllers-ruby-on-rails", "title": "validation form in controllers ruby on rails", "body": "<p>im a new for ruby on rails. i have a question. is it posible to make a validation form into controllers. im learning that every validation is set in model but not in controllers.</p>\n\n<p>i made simple form like this </p>\n\n<pre><code>&lt;%= form_for :post, url: email_path  do |f| %&gt;\n      &lt;dl class=\"cf\"&gt;\n        &lt;dt class=\"required\"&gt;Nama&lt;/dt&gt;\n        &lt;dd&gt;&lt;%= f.text_field(:name,  {:class =&gt; 'input_text full'}) %&gt;&lt;/dd&gt;\n      &lt;/dl&gt;\n      &lt;dl class=\"cf\"&gt;\n        &lt;dt class=\"required\"&gt;nama Perusahaan&lt;/dt&gt;\n        &lt;dd&gt;&lt;%= f.text_field(:company, {:class =&gt; 'input_text full'}) %&gt;&lt;/dd&gt;\n      &lt;/dl&gt;\n      &lt;dl class=\"cf\"&gt;\n        &lt;dt class=\"required\"&gt;nomor telepon&lt;/dt&gt;\n        &lt;dd&gt;&lt;%= f.text_field(:tel, {:class =&gt; 'input_text tel'}) %&gt;&lt;/dd&gt;\n      &lt;/dl&gt;\n      &lt;dl class=\"cf\"&gt;\n        &lt;dt class=\"required\"&gt;alamat email&lt;/dt&gt;\n        &lt;dd&gt;&lt;%= f.text_field(:email, {:class =&gt; 'input_text email'}) %&gt;&lt;/dd&gt;\n      &lt;/dl&gt;\n      &lt;dl class=\"cf\"&gt;\n        &lt;dt class=\"\"&gt;pertanyaan / komentar&lt;/dt&gt;\n        &lt;dd&gt;&lt;%= f.text_area(:commant, {:class =&gt; 'textarea'}) %&gt;&lt;/dd&gt;\n      &lt;/dl&gt;\n      &lt;ul class=\"form_btn cf\"&gt;\n        &lt;li class=\"submit\"&gt;&lt;%= f.submit(t('.ultra_tech_form_title').html_safe) %&gt;&lt;/li&gt;\n      &lt;/ul&gt;\n\n      &lt;% end %&gt;\n</code></pre>\n\n<p>the display is this</p>\n\n<p><a href=\"https://i.stack.imgur.com/LpFxq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LpFxq.png\" alt=\"enter image description here\"></a></p>\n\n<p>but if the required (*) is empty, it will display like this</p>\n\n<p><a href=\"https://i.stack.imgur.com/Y9KQ3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y9KQ3.png\" alt=\"enter image description here\"></a></p>\n\n<p>this form is directly send email. so i need to set validation. how do i to set this. </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 671, "user_id": 5742949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3912a535b54d364d6922df433db50512?s=128&d=identicon&r=PG&f=1", "display_name": "Shabini Rajadas", "link": "https://stackoverflow.com/users/5742949/shabini-rajadas"}, "edited": false, "score": 0, "creation_date": 1531760418, "post_id": 51366644, "comment_id": 89705813, "body": "can you share the values in users_hsh. Just the format of values would be enough."}, {"owner": {"reputation": 17, "user_id": 6860886, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XMmhbX0MoUs/AAAAAAAAAAI/AAAAAAAAACA/XJ0JlQppQgQ/photo.jpg?sz=128", "display_name": "Elvin Jafali", "link": "https://stackoverflow.com/users/6860886/elvin-jafali"}, "reply_to_user": {"reputation": 671, "user_id": 5742949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3912a535b54d364d6922df433db50512?s=128&d=identicon&r=PG&f=1", "display_name": "Shabini Rajadas", "link": "https://stackoverflow.com/users/5742949/shabini-rajadas"}, "edited": false, "score": 0, "creation_date": 1531761241, "post_id": 51366644, "comment_id": 89706220, "body": "Sure, an example users_hsh[&quot;Elvin Jafarli&quot;] = {completed_activities: 10, active_activities: 2, future_activities: 0}."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 6860886, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XMmhbX0MoUs/AAAAAAAAAAI/AAAAAAAAACA/XJ0JlQppQgQ/photo.jpg?sz=128", "display_name": "Elvin Jafali", "link": "https://stackoverflow.com/users/6860886/elvin-jafali"}, "edited": false, "score": 0, "creation_date": 1531762154, "post_id": 51367183, "comment_id": 89706653, "body": "Thank you! This is what I was looking for. Cheers!"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 17, "user_id": 6860886, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XMmhbX0MoUs/AAAAAAAAAAI/AAAAAAAAACA/XJ0JlQppQgQ/photo.jpg?sz=128", "display_name": "Elvin Jafali", "link": "https://stackoverflow.com/users/6860886/elvin-jafali"}, "edited": false, "score": 0, "creation_date": 1531762236, "post_id": 51367183, "comment_id": 89706687, "body": "I would advise using a tool such as <a href=\"https://github.com/pry/pry\" rel=\"nofollow noreferrer\"><code>pry</code></a> to put breakpoints in your code and debug issue like this. Inspect the variables at the point of failure."}, {"owner": {"reputation": 17, "user_id": 6860886, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XMmhbX0MoUs/AAAAAAAAAAI/AAAAAAAAACA/XJ0JlQppQgQ/photo.jpg?sz=128", "display_name": "Elvin Jafali", "link": "https://stackoverflow.com/users/6860886/elvin-jafali"}, "edited": false, "score": 0, "creation_date": 1531762344, "post_id": 51367183, "comment_id": 89706740, "body": "Thank you! I was wondering how to debug in ruby. Thanks again!"}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 0, "last_activity_date": 1531762178, "last_edit_date": 1531762178, "creation_date": 1531762060, "answer_id": 51367183, "question_id": 51366644, "link": "https://stackoverflow.com/questions/51366644/looping-over-ruby-hash-and-accessing-values/51367183#51367183", "title": "Looping over Ruby hash and accessing values", "body": "<p>Let's use your example of:</p>\n\n<pre><code>users_hash = {\n  \"Elvin Jafarli\" =&gt; {\n    completed_activities: 10,\n    active_activities: 2,\n    future_activities: 0\n  }\n}\n</code></pre>\n\n<p>Think carefully about what your data structure actually is: It's a hash that maps the user name to some user attributes. If you loop through these values, you don't just get a <code>usr</code>, you get back precisely this mapping.</p>\n\n<p>It's helpful to name your variables descriptively:</p>\n\n<pre><code>users_hsh.each do |user_name, user_attributes|\n  if user_attributes.values.sum != 0\n    # ...\n  end\nend\n</code></pre>\n\n<p>With your attempt, you would have seen an error like this: <code>NoMethodError: undefined method 'values' for #&lt;Array:0x00007fe14e22f538&gt;</code>. What happened is that each <code>usr</code> was actually an <code>Array</code> such as:</p>\n\n<pre><code>[\"Elvin Jafarli\", {completed_activities: 10, active_activities: 2, future_activities: 0}]\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 6860886, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XMmhbX0MoUs/AAAAAAAAAAI/AAAAAAAAACA/XJ0JlQppQgQ/photo.jpg?sz=128", "display_name": "Elvin Jafali", "link": "https://stackoverflow.com/users/6860886/elvin-jafali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 51367183, "answer_count": 1, "score": 0, "last_activity_date": 1531762178, "creation_date": 1531759863, "question_id": 51366644, "link": "https://stackoverflow.com/questions/51366644/looping-over-ruby-hash-and-accessing-values", "title": "Looping over Ruby hash and accessing values", "body": "<p>I am quite new to Ruby and could not find an appropriate answer to my questions. Let's say I have hash named \n    <code>users_hsh = {}</code>.\nI am looping through all of my users in the DB and creating the following.</p>\n\n<pre><code>users.each do |user|\n     users_hsh[user.full_name] = {\n         completed_activities: some_integer_value,\n         active_activities: some_integer_value,\n         future_activities: some_integer_value\n     } \nend\n</code></pre>\n\n<p>Now, I created a new hash named\n    <code>total_sum_not_zero_user_hsh = {}</code>.\nI want to loop over all of the users in the users_hsh and check for each user if the total sum of completed_activities + active_activities + future_activities does not equal 0 and if this condition holds, I want to add this user to total_sum_not_zero_user_hsh. I have done the following but seems that this does not work. </p>\n\n<pre><code>users_hsh.each do |usr|\n    if usr.values.sum != 0\n        total_sum_not_zero_user_hsh[usr] = {\n            completed_activities: some_integer_value,\n            active_activities: some_integer_value,\n            future_activities: some_integer_value\n        }\n    end\nend\n</code></pre>\n\n<p>What am I doing wrong? Thanks in advance!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "aasm"], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1531759964, "post_id": 51366592, "comment_id": 89705572, "body": "the <code>order</code> appears to be what is being updated so might make more sense for <code>Order</code> to have a <code>complete?</code> method such that <code>items.not_completed.empty?</code> then the call back would just be <code>order.update_attribute(:treated, true) if order.complete?</code>. Also I believe rails handles the type casting for <code>true</code> and <code>&quot;true&quot;</code> without issue."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1531760044, "post_id": 51366592, "comment_id": 89705616, "body": "Yeah, true. I&#39;ll add that suggestion as an extension, thanks."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10089436"}, "edited": false, "score": 0, "creation_date": 1531812802, "post_id": 51366592, "comment_id": 89722738, "body": "Hi @TomLord &amp; engineersmnky, thanks a lot(!) for the solution. It&#39;s pretty elegant. The redondant use of Self was the most tricky problem form me (with the simple &quot;=&quot;). Thanks again guys!"}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 3, "last_activity_date": 1531818139, "last_edit_date": 1531818139, "creation_date": 1531759597, "answer_id": 51366592, "question_id": 51366417, "link": "https://stackoverflow.com/questions/51366417/how-to-check-if-all-records-of-an-instance-have-one-of-many-values-from-a-list-o/51366592#51366592", "title": "How to check if all records of an instance have one of many values from a list of values?", "body": "<p>Your question title does not match the description. You're not checking whether \"all records have <strong>the same value</strong>\", you're checking that all records have <strong>one of many values</strong> (from a list).</p>\n\n<p>There are a few issues with your attempt:</p>\n\n<pre><code>self.order.items.each do |item|\n  if item.state = \"order_accepted\" or item.state = \"order_refused\"\n    # ...\n</code></pre>\n\n<ol>\n<li>Redundant use of <code>self</code></li>\n<li>Use of <code>=</code> is <strong>setting</strong> the value, rather than <em>checking for equality</em>. (This would be done with <code>==</code>.)</li>\n<li>By looping through all <code>items</code> like that, you're updating the <code>order</code> multiple times.</li>\n<li>...And since you're performing the check for <em>each</em> <code>item</code>, rather than <em>all</em> items, you're not checking that they <em>all</em> have the desired value.</li>\n</ol>\n\n<p>A minimal change to your attempt that would <em>work</em> is:</p>\n\n<pre><code>if order.items.all? { |item| item.state == \"order_accepted\" || item.state == \"order_refused\" }\n  order.update_attributes(treated: \"true\")\nend\n</code></pre>\n\n<p>However, that's not a great solution since you're loading all objects into memory and looping through them. This is inefficient, especially if there are lots of <code>items</code>. A better approach is to perform the check <em>directly in <code>SQL</code></em> rather than in <code>ruby</code>:</p>\n\n<pre><code>if order.items.where.not(state: [\"order_accepted\", \"order_refused\"]).empty?\n  order.update_attribute(:treated, \"true\")\nend\n</code></pre>\n\n<p>To tidy this code up a little, I would define that query as a <strong>scope</strong> on the <code>Item</code> model, such as:</p>\n\n<pre><code>class Item &lt; ApplicationRecord\n  scope :not_completed, -&gt; { where.not(state: [\"order_accepted\", \"order_refused\"]) }\nend\n</code></pre>\n\n<p>And then perhaps define a method on the <code>Order</code> model too:</p>\n\n<pre><code>class Order &lt; ApplicationRecord\n  def complete?\n    items.not_completed.empty?\n  end\nend\n</code></pre>\n\n<p>Then in the code above, you can just write:</p>\n\n<pre><code>def treatment\n  # ...\n  order.update_attribute(:treated, \"true\") if order.complete?\n  # ...\nend\n</code></pre>\n\n<p>Also, I suspect that should really be <code>true</code> rather than <code>\"true\"</code>. <code>true</code> is a boolean; <code>\"true\"</code> is a string. Use the correct data type for the job.</p>\n\n<p>Rails may be automatically casting the value to a boolean on your behalf (?), but I would consider it bad practice to use the wrong data type, regardless.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10089436"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 51366592, "answer_count": 1, "score": -1, "last_activity_date": 1531818139, "creation_date": 1531758941, "last_edit_date": 1531813425, "question_id": 51366417, "link": "https://stackoverflow.com/questions/51366417/how-to-check-if-all-records-of-an-instance-have-one-of-many-values-from-a-list-o", "title": "How to check if all records of an instance have one of many values from a list of values?", "body": "<p>I'm looking for a solution for a complex query.</p>\n\n<p>Goal : I want to know if all record of an instance have a value, and do some action when all records of the instance have the same value.</p>\n\n<p><strong>Order Model :</strong></p>\n\n<pre><code>has_many :items\nColumns : treated\n</code></pre>\n\n<p><strong>Item Model :</strong></p>\n\n<pre><code>belongs_to :order\nColumns : order_id / state\n</code></pre>\n\n<p><strong>Seed exemple :</strong></p>\n\n<pre><code>Order.create\n@item1 = Item.create(order_id: 1, state: pending)\n@item2 = Item.create(order_id: 1, state: pending)\n</code></pre>\n\n<p>In a callback action, on the Item Model, I've done :</p>\n\n<pre><code>def treatment\n    self.order.items.each do |item|\n      if item.state = \"order_accepted\" or item.state = \"order_refused\"\n        item.order.update_attributes(treated: \"true\")\n      end\n    end\n  end\n</code></pre>\n\n<p>So i'm trying to have a result like :</p>\n\n<p><strong>\"If all my Items have the states \"order_accepted\" or \"order_refused\", then update the Order to 'treated'.\"</strong></p>\n\n<p>Please help!\nMany thanks</p>\n"}, {"tags": ["ruby", "nested-loops", "key-value"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1531757551, "post_id": 51366050, "comment_id": 89704412, "body": "You&#39;ll need to be more specific about your input format. Is that a text file or some kind of code sketch?"}, {"owner": {"reputation": 1014, "user_id": 2551956, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba34ab655eaf76dc5486c0677aad24f9?s=128&d=identicon&r=PG", "display_name": "user234461", "link": "https://stackoverflow.com/users/2551956/user234461"}, "edited": false, "score": 0, "creation_date": 1531757677, "post_id": 51366050, "comment_id": 89704482, "body": "Could you provide an example of the desired output for the JSON above? (Removing some of the keys for brevity is fine.)"}, {"owner": {"reputation": 689, "user_id": 5851615, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/c1bd6bf45d7b3d1038d7c5d9e2ced60b?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine", "link": "https://stackoverflow.com/users/5851615/catherine"}, "edited": false, "score": 0, "creation_date": 1531758027, "post_id": 51366050, "comment_id": 89704654, "body": "The desired output is that based on the JSON it would establish what the full &quot;key&quot; should be and it&#39;s specific numerical or string value e.g. <code>system_name</code> would correlate to <code>System_1</code> and <code>mem&#47;stats1</code> would correlate to <code>10</code>. Each of these related keys and values would be used as inputs into another function which would send them elsewhere"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1531759414, "post_id": 51366050, "comment_id": 89705327, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/23521230/flattening-nested-hash-to-a-single-hash-with-ruby-rails\">Flattening nested hash to a single hash with Ruby/Rails</a> or <a href=\"https://stackoverflow.com/questions/9647997/converting-a-nested-hash-into-a-flat-hash\" title=\"converting a nested hash into a flat hash\">stackoverflow.com/questions/9647997/&hellip;</a> or <a href=\"https://stackoverflow.com/questions/48836464/how-to-flatten-a-hash-making-each-key-a-unique-value\" title=\"how to flatten a hash making each key a unique value\">stackoverflow.com/questions/48836464/&hellip;</a>"}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1531759907, "post_id": 51366050, "comment_id": 89705534, "body": "Note that in the latest version(s) of ruby you can use the <code>#dig</code> method...  <code>hash.dig(*key.split(&#39;&#47;&#39;))</code>"}], "answers": [{"tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 2, "last_activity_date": 1531759154, "creation_date": 1531759154, "answer_id": 51366471, "question_id": 51366050, "link": "https://stackoverflow.com/questions/51366050/ruby-how-to-create-nested-key-value-relationship/51366471#51366471", "title": "Ruby: How to create nested key/value relationship", "body": "<p>This is a recursive method that will create a \"flattened hash\", a hash without nesting and where the keys are the nested keys separated by slashes.</p>\n\n<pre><code> def flatten_hash(hash, result = {}, prefix = nil)\n   hash.each do |k,v|\n     if v.is_a? Hash\n       flatten_hash(v, result, [prefix, k].compact.join('/'))\n     else\n       result[[prefix, k].compact.join('/')] = v\n     end\n   end\n   result\n end\n\nmy_hash = {'id': 1, 'system_name': 'Sysem_1', 'mem': {'stat1': 10, 'stat2': 1056, 'stat3': 10563}}\n\nflatten_hash(my_hash)\n=&gt; {\"id\"=&gt;1, \"system_name\"=&gt;\"Sysem_1\", \"mem/stat1\"=&gt;10, \"mem/stat2\"=&gt;1056, \"mem/stat3\"=&gt;10563}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 136, "user_id": 5360097, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153702473768701/picture?type=large", "display_name": "Zohaib A. Butt", "link": "https://stackoverflow.com/users/5360097/zohaib-a-butt"}, "is_accepted": false, "score": 0, "last_activity_date": 1531759583, "creation_date": 1531759583, "answer_id": 51366588, "question_id": 51366050, "link": "https://stackoverflow.com/questions/51366050/ruby-how-to-create-nested-key-value-relationship/51366588#51366588", "title": "Ruby: How to create nested key/value relationship", "body": "<pre><code>def key_path_value(key_string, my_json)    \n  value = nil\n  key_array = key_string.split(\"/\")\n\n  return value if key_array.empty?\n  return my_json[key_array.last] if key_array.length == 1\n\n  value = my_json[key_array.first.to_sym]\n  key_array = key_array.drop(1)\n\n  key_array.each do |key|\n    break unless value.is_a? Hash\n    value = value[key.to_sym]\n  end\n\n  return value\nend\n</code></pre>\n"}], "owner": {"reputation": 689, "user_id": 5851615, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/c1bd6bf45d7b3d1038d7c5d9e2ced60b?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine", "link": "https://stackoverflow.com/users/5851615/catherine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 51366471, "answer_count": 2, "score": 1, "last_activity_date": 1531759583, "creation_date": 1531757446, "last_edit_date": 1531758320, "question_id": 51366050, "link": "https://stackoverflow.com/questions/51366050/ruby-how-to-create-nested-key-value-relationship", "title": "Ruby: How to create nested key/value relationship", "body": "<p>I am trying to create a function that outputs the key and value for all entries of that JSON as described below so I can use it to send information similar to this:</p>\n\n<pre><code>key = \"id\", value = 1\nkey = \"mem/stat1\", value = 10\nkey = \"more_stats/extra_stats/stat7\", value = 5\n</code></pre>\n\n<p>Example JSON :</p>\n\n<pre><code>my_json =\n    {\n      \"id\": 1,\n      \"system_name\": \"System_1\",\n      \"mem\" : {\n          \"stat1\" : 10,\n          \"stat2\" : 1056,\n          \"stat3\" : 10563,\n      },\n     \"other_stats\" : {\n        \"stat4\" : 1,\n        \"stat5\" : 2,\n        \"stat6\" : 3,\n      }, \n      \"more_stats\" : {\n        \"name\" : \"jdlfjsdlfjs\",\n        \"os\" : \"fjsalfjsl\",\n        \"error_count\": 3\n        \"extra_stats\" : {\n            \"stat7\" : 5,\n            \"stat8\" : 6,\n        },\n      }\n    }\n</code></pre>\n\n<p>I found an answer from this question (<a href=\"https://stackoverflow.com/questions/22331898/need-help-in-getting-nested-ruby-hash-hierarchy\">need help in getting nested ruby hash hierarchy</a>) that was helpful but even with some alterations it isn't working how I would like it:</p>\n\n<pre><code>def hashkeys(json, keys = [], result = [])\n      if json.is_a?(Hash)\n        json.each do |key, value|\n          hashkeys(value, keys + [key], result)\n        end\n      else\n        result &lt;&lt; keys\n      end\n      result.join(\"/\")\n    end\n</code></pre>\n\n<p>It returns all the keys together as one string and doesn't include any of the respective values correctly as I would like.</p>\n\n<p>Unwanted output of hashkeys currently:</p>\n\n<pre><code>id/system_name/mem/stat1/mem/stat2/...\n</code></pre>\n\n<p>Ideally I want something that takes in <code>my_json</code>:</p>\n\n<pre><code>find_nested_key_value(my_json)\n   some logic loop involving key and value:\n      if more logic needed\n         another_logic_loop_for_more_nested_info\n      else\n         send_info(final_key, final_value)\n      end\n   end\n end\n</code></pre>\n\n<p>So if <code>final_key = \"mem/stat1\"</code> then the <code>final_value = 10</code>, then the next iteration would be <code>final_key = \"mem/stat2\"</code> and <code>final_value = 1056</code> and so on</p>\n\n<p>How do I achieve this? and is using a function like <code>hashkeys</code> the best way to achieve this</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1531756242, "post_id": 51365579, "comment_id": 89703674, "body": "Technically you can use <code>html_safe</code> e.g. <code>&lt;%= @sentence.html_safe %&gt;</code> but I would not recommend this as marking strings as html safe can lead to code injection depending on how you are utilizing this. Sidenote: the proper break tag should be <code>&lt;br &#47;&gt;</code>. As for the other questions these are really 3 <b>very</b> separate questions (rails rendering, javascript, and server side code) and I would recommend doing a little research and then if you still cannot figure it our come back and ask them as separate questions."}, {"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1531758678, "post_id": 51365579, "comment_id": 89704975, "body": "I tested your question 2 on Rails 5.1, and it works as it&#39;s supposed to (browser goes back). Could be a browser issue. You should post it as a separate question. Don&#39;t write more than one question per post."}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1531756617, "post_id": 51365761, "comment_id": 89703887, "body": "Wow. I didn&#39;t know about <code>&lt;%==</code> (although honestly now that I do it terrifies me :)) I would certainly prefer the explict nature of <code>raw</code> or <code>html_safe</code> over this little gem, but thank you for teaching me something."}, {"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1531756787, "post_id": 51365761, "comment_id": 89703983, "body": "True. It&#39;s a good idea to point out that it&#39;s potentially unsafe to use any of the unescaping methods in your templates. Thanks."}], "tags": [], "owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "is_accepted": true, "score": 1, "last_activity_date": 1531756396, "creation_date": 1531756396, "answer_id": 51365761, "question_id": 51365579, "link": "https://stackoverflow.com/questions/51365579/cant-translate-html-code-in-ruby-on-rails/51365761#51365761", "title": "cant translate html code in ruby on rails", "body": "<p>Rails automatically escapes all HTML in ERB templates. To prevent this escaping you can use the Rails ERB extension <code>&lt;%== %&gt;</code>. So in your case it would be:</p>\n\n<pre><code>&lt;%== @sentence %&gt;\n</code></pre>\n\n<p>See this question for some further discussion:<br>\n<a href=\"https://stackoverflow.com/questions/13142326/what-does-do-in-rails-erb\">What does &lt;%== %&gt; do in rails erb?</a></p>\n"}, {"tags": [], "owner": {"reputation": 7359, "user_id": 599989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d752d2574aeb36bc66471f4d0f8811aa?s=128&d=identicon&r=PG", "display_name": "Bijendra", "link": "https://stackoverflow.com/users/599989/bijendra"}, "is_accepted": false, "score": 0, "last_activity_date": 1531756748, "last_edit_date": 1531756748, "creation_date": 1531756404, "answer_id": 51365765, "question_id": 51365579, "link": "https://stackoverflow.com/questions/51365579/cant-translate-html-code-in-ruby-on-rails/51365765#51365765", "title": "cant translate html code in ruby on rails", "body": "<p>Replace <code>&lt;%= @sentence %&gt;</code> with below content for a simple solution.</p>\n\n<pre><code>&lt;% @sentence.split(\"&lt;br/&gt;\").each do |word| %&gt;\n &lt;%= word %&gt;&lt;br/&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>for the second qsn, check the validations in validateform() function and then respond with true or false accordingly.</p>\n\n<pre><code>&lt;%= button_to_function \"Submit\", \"validateform()\" %&gt;\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 3702199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbf06ca844c89bada71ac9d092026a9?s=128&d=identicon&r=PG&f=1", "display_name": "Ferdinand", "link": "https://stackoverflow.com/users/3702199/ferdinand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 51365761, "answer_count": 2, "score": 0, "last_activity_date": 1531756748, "creation_date": 1531755759, "question_id": 51365579, "link": "https://stackoverflow.com/questions/51365579/cant-translate-html-code-in-ruby-on-rails", "title": "cant translate html code in ruby on rails", "body": "<p>im new for ruby on rails. i have 3 question </p>\n\n<ol>\n<li>how to i translate the html code</li>\n</ol>\n\n<p>in controllers i set</p>\n\n<pre><code>def index\n  @sentence = \"Halo&lt;br&gt;worlds\";\nend\n</code></pre>\n\n<p>in index.html.erb display i set</p>\n\n<pre><code>&lt;%= @sentence %&gt;\n</code></pre>\n\n<p>but display</p>\n\n<pre><code>Halo&lt;br&gt;world\n</code></pre>\n\n<p>how do i make it like this </p>\n\n<pre><code>halo\nworld\n</code></pre>\n\n<ol start=\"2\">\n<li>how do i set onclick in submit button? i already tried set the button like this &lt;%= submit_tag \"back\", onclick: \"window.history.back();\" %></li>\n</ol>\n\n<p>but the result is not go to previous page. but excetude the form..</p>\n\n<ol start=\"3\">\n<li>how i can make an validation form if the validation code is in controllers. not in model</li>\n</ol>\n"}, {"tags": ["ruby", "regex", "parentheses"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1531766726, "post_id": 51365262, "comment_id": 89708944, "body": "Is the string <code>&quot;untitled&quot;</code> important or is is a stand-in for any string (e.g., <code>&quot;cat(9)&quot;</code>)? You have not defined &quot;value&quot;. Must it be the string representation of a a non-negative integer (natural number), as in your examples, or a possibly-negative integer (which)? What do you want returned if the string were <code>&quot;untitled&quot;</code>, <code>&quot;the cat in the hat&quot;</code>, <code>&quot;untitled($)&quot;</code>, or <code>&quot;untitled(3) animal(4)&quot;</code>? Please edit your question rather than try to elaborate in comments (which should also stem further downvoting). Precision with words is as important as precision in code."}], "answers": [{"tags": [], "owner": {"reputation": 13091, "user_id": 483266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a88664c5c8cd526ac9c0638e59db2c0f?s=128&d=identicon&r=PG", "display_name": "Arie Xiao", "link": "https://stackoverflow.com/users/483266/arie-xiao"}, "is_accepted": false, "score": 0, "last_activity_date": 1531754972, "creation_date": 1531754972, "answer_id": 51365351, "question_id": 51365262, "link": "https://stackoverflow.com/questions/51365262/ruby-get-value-between-parenthesis-without-those-parenthesis/51365351#51365351", "title": "Ruby : get value between parenthesis (without those parenthesis)", "body": "<p>When you use Regex as the parameter to <a href=\"http://ruby-doc.org/core-2.5.1/String.html#method-i-5B-5D\" rel=\"nofollow noreferrer\"><code>String#[]</code></a>, you can optionally pass in the index of captured group to extract that group.</p>\n\n<blockquote>\n  <p>If a Regexp is supplied, the matching portion of the string is returned. If a capture follows the regular expression, which may be a capture group index or name, follows the regular expression that component of the MatchData is returned instead.</p>\n</blockquote>\n\n<pre><code>string = \"untitled(1)\"\nnumber = string[/\\(([0-9]+)\\)/, 1]\nputs number\n#=&gt; 1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1531765389, "post_id": 51365495, "comment_id": 89708327, "body": "I think it&#39;s reasonable to assume that the parentheses may surround the string representation of a number (in view of the example) or an arbitrary string that does not contain a right paren (e.g., <code>&quot;($)&quot;</code>), but I see no basis for limiting the string to word characters."}, {"owner": {"reputation": 372, "user_id": 2987042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c99da919c94841d8dcf18f046e6d5e6e?s=128&d=identicon&r=PG", "display_name": "Arkeen", "link": "https://stackoverflow.com/users/2987042/arkeen"}, "edited": false, "score": 0, "creation_date": 1531820347, "post_id": 51365495, "comment_id": 89727548, "body": "Thanks ! it is working indeed, I will look at the doc to understand exactly why"}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 2, "last_activity_date": 1531755952, "last_edit_date": 1531755952, "creation_date": 1531755435, "answer_id": 51365495, "question_id": 51365262, "link": "https://stackoverflow.com/questions/51365262/ruby-get-value-between-parenthesis-without-those-parenthesis/51365495#51365495", "title": "Ruby : get value between parenthesis (without those parenthesis)", "body": "<p><code>/(?&lt;=\\()\\w+(?=\\)$)/</code> matches one or more word characters (letter, number, underscore) within parenthesis, right before the end of line:</p>\n\n<pre><code>words = %w[\n    untitled\n    untitled(1)\n    untitled(2)\n    untitled(foo)\n    unti(tle)d\n]\np words.map { |word| word[/(?&lt;=\\()\\w+(?=\\)$)/] }\n# =&gt; [nil, \"1\", \"2\", \"foo\", nil]\n</code></pre>\n"}], "owner": {"reputation": 372, "user_id": 2987042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c99da919c94841d8dcf18f046e6d5e6e?s=128&d=identicon&r=PG", "display_name": "Arkeen", "link": "https://stackoverflow.com/users/2987042/arkeen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 645, "favorite_count": 0, "accepted_answer_id": 51365495, "answer_count": 2, "score": 0, "last_activity_date": 1531817882, "creation_date": 1531754727, "last_edit_date": 1531817882, "question_id": 51365262, "link": "https://stackoverflow.com/questions/51365262/ruby-get-value-between-parenthesis-without-those-parenthesis", "title": "Ruby : get value between parenthesis (without those parenthesis)", "body": "<p>I have strings like <code>\"untitled\"</code>, <code>\"untitled(1)\"</code> or <code>\"untitled(2)\"</code>. </p>\n\n<p>I want to get the last integer value between parenthesis when if there is. So far I tried a lot of regex, the ones making sense to me (I am new to regex) look like this:</p>\n\n<ul>\n<li><code>number= string[/\\([0-9]+\\)/]</code></li>\n<li><code>number= string[/\\(([0-9]+)\\)/]</code></li>\n</ul>\n\n<p>but it still returns me the value with the parenthesis. </p>\n\n<p>If there are no left-then-right parenthesis, getting an empty string (or <code>nil</code>) would be nice. Case such as <code>\"untitled($)\"</code>, getting the <code>'$'</code> char or <code>nil</code> or an empty string would do the trick. For <code>\"untitled(3) animal(4)\"</code>, I want to get <code>4</code>.</p>\n\n<p>I have been looking a lot of topics about how to do that and but it never seems to work ... what am I missing here ?</p>\n"}, {"tags": ["ruby", "web-crawler", "dynamic-content"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1531761799, "post_id": 51364798, "comment_id": 89706467, "body": "Please post some code we can actually assist with because right now it is nearly impossible to help since we have no idea what you are actually doing."}], "answers": [{"tags": [], "owner": {"reputation": 149, "user_id": 5428739, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/de2995f30ef37bd47369fafdf4569638?s=128&d=identicon&r=PG&f=1", "display_name": "Sheppard", "link": "https://stackoverflow.com/users/5428739/sheppard"}, "is_accepted": true, "score": 0, "last_activity_date": 1531842802, "creation_date": 1531842802, "answer_id": 51385677, "question_id": 51364798, "link": "https://stackoverflow.com/questions/51364798/crawling-dynamic-content-using-ruby/51385677#51385677", "title": "crawling dynamic content using ruby", "body": "<p>That modal you're describing, with high probability is rendered with a Js. So what you're looking for is not possible, because mentioned libs do not execute Js.</p>\n\n<p>In order to parse pages whose content is Js dependent, you should use other tools, e.g.  <a href=\"https://github.com/GoogleChrome/puppeteer\" rel=\"nofollow noreferrer\">puppeteer</a>  </p>\n"}], "owner": {"reputation": 61, "user_id": 7262246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/363494413fae5bdb07013ff61d42c85c?s=128&d=identicon&r=PG", "display_name": "Sajed Almorsy", "link": "https://stackoverflow.com/users/7262246/sajed-almorsy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 51385677, "answer_count": 1, "score": 0, "last_activity_date": 1531842802, "creation_date": 1531753301, "last_edit_date": 1531754755, "question_id": 51364798, "link": "https://stackoverflow.com/questions/51364798/crawling-dynamic-content-using-ruby", "title": "crawling dynamic content using ruby", "body": "<p>I am using ruby gems (nokogiri &amp; mechanize) to make a crawler for a website but this website contains bootstrap modals (popup windows) that's generated dynamically on button click.</p>\n\n<p>this content (of modal) shows up on button click that uses a \"get\" method on some URL.</p>\n\n<p>I am getting the response by crawling the URL associated with the button \nbut I am just getting the same page source.</p>\n\n<p>how could I get the content of that dynamic content using \"ruby\" ? </p>\n"}, {"tags": ["ruby", "watir"], "comments": [{"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1531750254, "post_id": 51363571, "comment_id": 89699849, "body": "What is <code>browser</code> in this context?"}, {"owner": {"reputation": 23, "user_id": 10035164, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-t3542wYkO8k/AAAAAAAAAAI/AAAAAAAAAAc/1DIvSqgKZ9A/photo.jpg?sz=128", "display_name": "Syched Flow", "link": "https://stackoverflow.com/users/10035164/syched-flow"}, "reply_to_user": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1531750338, "post_id": 51363571, "comment_id": 89699889, "body": "browser[i]=Watir::Browser.new :firefox,profile: profile"}, {"owner": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "edited": false, "score": 1, "creation_date": 1531754779, "post_id": 51363571, "comment_id": 89702819, "body": "You can only switch to windows opened in the same driver session. Each Watir::Browser instance has a different driver session."}, {"owner": {"reputation": 23, "user_id": 10035164, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-t3542wYkO8k/AAAAAAAAAAI/AAAAAAAAAAc/1DIvSqgKZ9A/photo.jpg?sz=128", "display_name": "Syched Flow", "link": "https://stackoverflow.com/users/10035164/syched-flow"}, "edited": false, "score": 0, "creation_date": 1531755358, "post_id": 51363571, "comment_id": 89703211, "body": "yeah, that&#39;s exactly why I used a different driver. then why browser[i].button(:name=&gt;&#39;submit&#39;).click raise that exception?"}, {"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1531763700, "post_id": 51363571, "comment_id": 89707484, "body": "Are you closing browser windows or tabs somewhere?"}, {"owner": {"reputation": 23, "user_id": 10035164, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-t3542wYkO8k/AAAAAAAAAAI/AAAAAAAAAAc/1DIvSqgKZ9A/photo.jpg?sz=128", "display_name": "Syched Flow", "link": "https://stackoverflow.com/users/10035164/syched-flow"}, "edited": false, "score": 0, "creation_date": 1531766610, "post_id": 51363571, "comment_id": 89708887, "body": "nope i&#39;m only working with these browsers"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10035164, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-t3542wYkO8k/AAAAAAAAAAI/AAAAAAAAAAc/1DIvSqgKZ9A/photo.jpg?sz=128", "display_name": "Syched Flow", "link": "https://stackoverflow.com/users/10035164/syched-flow"}, "edited": false, "score": 0, "creation_date": 1531761808, "post_id": 51365776, "comment_id": 89706473, "body": "doesn&#39;t this switch between only two windows?"}, {"owner": {"reputation": 23, "user_id": 10035164, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-t3542wYkO8k/AAAAAAAAAAI/AAAAAAAAAAc/1DIvSqgKZ9A/photo.jpg?sz=128", "display_name": "Syched Flow", "link": "https://stackoverflow.com/users/10035164/syched-flow"}, "edited": false, "score": 0, "creation_date": 1531761956, "post_id": 51365776, "comment_id": 89706541, "body": "I&#39;m thinking about runing the script multple times with different variables if it was not by anychance possible for me to do this through one script. i will just let a script generate the others and each script will control it&#39;s browser."}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "reply_to_user": {"reputation": 23, "user_id": 10035164, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-t3542wYkO8k/AAAAAAAAAAI/AAAAAAAAAAc/1DIvSqgKZ9A/photo.jpg?sz=128", "display_name": "Syched Flow", "link": "https://stackoverflow.com/users/10035164/syched-flow"}, "edited": false, "score": 0, "creation_date": 1531791772, "post_id": 51365776, "comment_id": 89716108, "body": "@Syched Flow You can obviously run in multiple windows but you can&#39;t switch between windows."}], "tags": [], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "is_accepted": true, "score": 1, "last_activity_date": 1531756443, "creation_date": 1531756443, "answer_id": 51365776, "question_id": 51363571, "link": "https://stackoverflow.com/questions/51363571/watir-switch-between-drivers/51365776#51365776", "title": "watir switch between drivers", "body": "<p>You are trying to connect with two different browser which has been opened by two different  driver,  you can shift between browser which has been opened by one single driver. For an example when you click a link if it opens a new window then you can shift to the new window.</p>\n\n<p>You can shift to the new window by writing the following code</p>\n\n<pre><code> b.windows.last.use do |browser|\n       browser.button.click #for an example\n end \n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10035164, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-t3542wYkO8k/AAAAAAAAAAI/AAAAAAAAAAc/1DIvSqgKZ9A/photo.jpg?sz=128", "display_name": "Syched Flow", "link": "https://stackoverflow.com/users/10035164/syched-flow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 51365776, "answer_count": 1, "score": 0, "last_activity_date": 1531756443, "creation_date": 1531749367, "last_edit_date": 1531750604, "question_id": 51363571, "link": "https://stackoverflow.com/questions/51363571/watir-switch-between-drivers", "title": "watir switch between drivers", "body": "<p>I created multiple browsers and I'm in need to switch between them however when I go the conventional way I get this error message.which is like this</p>\n\n<pre><code>browser[i].button(:name=&gt;'submit').click\n</code></pre>\n\n<p>the error that pops up:-</p>\n\n<pre><code>Browsing context has been discarded (Selenium::WebDriver::Error::NoSuchWindowError)\n</code></pre>\n\n<p>which made me think that I need to switch between browser[0] and browser[1] however switch to is not defined for a browser. any ideas?</p>\n\n<pre><code>browser[i].switch_to.window(browser[(i+1)%z].window_handle)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "associations", "partials"], "comments": [{"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1531747839, "post_id": 51362983, "comment_id": 89698178, "body": "What do you get in <code>@team.assignedFlags</code> ? @team should have valid object"}, {"owner": {"reputation": 25, "user_id": 7868282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de190b3f2ab090ee0f0c4a5750d96ae6?s=128&d=identicon&r=PG&f=1", "display_name": "EvaB11", "link": "https://stackoverflow.com/users/7868282/evab11"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1531748310, "post_id": 51362983, "comment_id": 89698446, "body": "@Vishal A team has flags assigned to it and a team can raise flags, this is relating to the one object - &#39;flag&#39;. So &#39;@team.assignedFlags&#39; should display the flags that are assigned to the team being showed."}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1531748501, "post_id": 51362983, "comment_id": 89698569, "body": "you can get <code>@team.assignedFlags</code> and  <code>@team.raisedFlags</code> you just need to display them, whats issue in that ? what is your question ?"}, {"owner": {"reputation": 25, "user_id": 7868282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de190b3f2ab090ee0f0c4a5750d96ae6?s=128&d=identicon&r=PG&f=1", "display_name": "EvaB11", "link": "https://stackoverflow.com/users/7868282/evab11"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1531748712, "post_id": 51362983, "comment_id": 89698735, "body": "@Vishal - they are not displaying when I run the rails server, and I have both in the teams/show.html.erb above"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1531749114, "post_id": 51362983, "comment_id": 89699029, "body": "Please check my answer"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 7868282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de190b3f2ab090ee0f0c4a5750d96ae6?s=128&d=identicon&r=PG&f=1", "display_name": "EvaB11", "link": "https://stackoverflow.com/users/7868282/evab11"}, "edited": false, "score": 0, "creation_date": 1531749729, "post_id": 51363484, "comment_id": 89699501, "body": "A very silly mistake on my part!! Thank you for all your help"}, {"owner": {"reputation": 25, "user_id": 7868282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de190b3f2ab090ee0f0c4a5750d96ae6?s=128&d=identicon&r=PG&f=1", "display_name": "EvaB11", "link": "https://stackoverflow.com/users/7868282/evab11"}, "edited": false, "score": 0, "creation_date": 1531815677, "post_id": 51363484, "comment_id": 89724477, "body": "I can&#39;t upvote yet so just leaving a comment for now! Once I can, I will certainly upvote. Thanks again."}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "reply_to_user": {"reputation": 25, "user_id": 7868282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de190b3f2ab090ee0f0c4a5750d96ae6?s=128&d=identicon&r=PG&f=1", "display_name": "EvaB11", "link": "https://stackoverflow.com/users/7868282/evab11"}, "edited": false, "score": 0, "creation_date": 1531887125, "post_id": 51363484, "comment_id": 89758507, "body": "@EvaB11 Okay sure, will wait ;)"}], "tags": [], "owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "is_accepted": true, "score": 0, "last_activity_date": 1531749102, "creation_date": 1531749102, "answer_id": 51363484, "question_id": 51362983, "link": "https://stackoverflow.com/questions/51362983/rails-partial-object-loading-in-rails-server-but-not-rendering/51363484#51363484", "title": "Rails: Partial object loading in rails server but not rendering", "body": "<p>its not showing because you need to use <code>flag</code> instead of @flag, also optimized your code please check\n    </p>\n\n<pre><code>&lt;p&gt;\n  &lt;strong&gt;Title:&lt;/strong&gt;\n  &lt;%= flag.title %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;strong&gt;Description:&lt;/strong&gt;\n  &lt;%= flag.description %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;strong&gt;Priority:&lt;/strong&gt;\n  &lt;%= flag.priority %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;strong&gt;Status:&lt;/strong&gt;\n  &lt;%= flag.status %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;strong&gt;Raisedby:&lt;/strong&gt;\n  &lt;%= flag.raisedby.name %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;strong&gt;Assignedto:&lt;/strong&gt;\n  &lt;%= flag.assignedto.name  %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;strong&gt;Created By:&lt;/strong&gt;\n  &lt;%= flag.user&amp;.name   %&gt;\n  &lt;%= flag.user&amp;.surname  %&gt;\n&lt;/p&gt;\n\n\n&lt;%= link_to 'Edit', edit_flag_path(flag) %&gt; |\n&lt;%= link_to 'Back', flags_path %&gt;\n\n&lt;/div&gt;\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7868282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de190b3f2ab090ee0f0c4a5750d96ae6?s=128&d=identicon&r=PG&f=1", "display_name": "EvaB11", "link": "https://stackoverflow.com/users/7868282/evab11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 51363484, "answer_count": 1, "score": 0, "last_activity_date": 1531749165, "creation_date": 1531747643, "last_edit_date": 1531748902, "question_id": 51362983, "link": "https://stackoverflow.com/questions/51362983/rails-partial-object-loading-in-rails-server-but-not-rendering", "title": "Rails: Partial object loading in rails server but not rendering", "body": "<p>I am trying to render a partial for an object called 'flag' in the <code>show.html.erb</code> file for an object called 'team'.\nHowever, the partial for assigned and raised flags for a team does not render.</p>\n\n<p>I am running into issues as this is a complicated association.\nA flag can be raised by one team but assigned to another. This is referenced to by using a <code>assignedto_id</code> and a <code>raisedby_id</code>. These IDs are the <code>team_id</code> on the creation of the flag object. Both are belongs_to associations.\nA team can then have many flags raised to them and many flags assigned to them. I wish to display the flags assigned and raised to the team.</p>\n\n<p>How can I get this to render? Does anything have to be added to the <code>teams_controller.rb</code> file?</p>\n\n<p>Please see the code below.</p>\n\n<p>Flag.rb</p>\n\n<pre><code>class Flag &lt; ApplicationRecord\n  belongs_to :raisedby, :class_name =&gt; 'Team'\n  belongs_to :assignedto, :class_name =&gt; 'Team'\n  belongs_to :user\n\n  enum priority: [:high, :medium, :low]\n  enum status: [:raised, :open, :closed, :cancelled]\n  validate :check_assigned_and_raised\n\ndef check_assigned_and_raised\n  errors.add(:assignedto_id, \" error has occurred. The assigned team can not be the same as team who is raising the flag.\") if assignedto_id == raisedby_id\nend\n\nend\n</code></pre>\n\n<p>Team.rb</p>\n\n<pre><code>class Team &lt; ApplicationRecord\n  has_many :users\n  has_many :assignedFlags, -&gt; {where 'assignedto_id = \"team_id\"'}, :class_name =&gt; 'Flag', :foreign_key =&gt; 'assignedto_id'\n  has_many :raisedFlags, -&gt; {where 'raisedby_id = \"team_id\"'}, :class_name =&gt; 'Flag', :foreign_key =&gt; 'raisedby_id'\n\nend\n</code></pre>\n\n<p>teams/show.html.erb</p>\n\n<pre><code>&lt;p id=\"notice\"&gt;&lt;%= notice %&gt;&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;strong&gt;Name:&lt;/strong&gt;\n  &lt;br&gt;\n  &lt;%= @team.name %&gt;\n&lt;/p&gt;\n&lt;p&gt;\n  &lt;br&gt;\n  &lt;strong&gt;Description:&lt;/strong&gt;\n  &lt;br&gt;\n  &lt;%= @team.description %&gt;\n&lt;/p&gt;\n&lt;br&gt;\n&lt;strong&gt;Users:&lt;/strong&gt;\n &lt;p&gt;\n  &lt;% @team.users.each do |user| %&gt;\n  &lt;%= render partial: 'users/user', locals: { user: user } %&gt;\n  &lt;% end %&gt;\n  &lt;/p&gt;\n  &lt;br&gt;\n  &lt;strong&gt;Assigned Flags:&lt;/strong&gt;\n    &lt;p&gt;\n  &lt;% @team.assignedFlags.each do |flag| %&gt;\n  &lt;%= render partial: 'flags/flag', locals: { flag: flag } %&gt;\n  &lt;% end %&gt;\n  &lt;/p&gt;\n\n    &lt;br&gt;\n  &lt;strong&gt;Raised Flags:&lt;/strong&gt;\n    &lt;p&gt;\n  &lt;% @team.raisedFlags.each do |flag| %&gt;\n  &lt;%= render partial: 'flags/flag', locals: { flag: flag } %&gt;\n  &lt;% end %&gt;\n  &lt;/p&gt;\n &lt;br&gt;\n\n&lt;%= link_to 'Edit', edit_team_path(@team) %&gt; |\n&lt;%= link_to 'Back', teams_path %&gt;\n</code></pre>\n\n<p>_flags.html.erb </p>\n\n<pre><code>&lt;div&gt;\n\n&lt;p&gt;\n  &lt;strong&gt;Title:&lt;/strong&gt;\n  &lt;%= @flag.title %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;strong&gt;Description:&lt;/strong&gt;\n  &lt;%= @flag.description %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;strong&gt;Priority:&lt;/strong&gt;\n  &lt;%= @flag.priority %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;strong&gt;Status:&lt;/strong&gt;\n  &lt;%= @flag.status %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;strong&gt;Raisedby:&lt;/strong&gt;\n  &lt;%= @flag.raisedby.name %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;strong&gt;Assignedto:&lt;/strong&gt;\n  &lt;%= @flag.assignedto.name  %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;strong&gt;Created By:&lt;/strong&gt;\n  &lt;%= @flag.user.name if @flag.user  %&gt;\n  &lt;%= @flag.user.surname if @flag.user  %&gt;\n&lt;/p&gt;\n\n\n&lt;%= link_to 'Edit', edit_flag_path(@flag) %&gt; |\n&lt;%= link_to 'Back', flags_path %&gt;\n\n&lt;/div&gt;\n</code></pre>\n\n<p>Rails server result</p>\n\n<pre><code>Team Load (0.4ms)  SELECT  \"teams\".* FROM \"teams\" WHERE \"teams\".\"id\" = ? LIMIT ?  [[\"id\", 1], [\"LIMIT\", 1]]\n  Rendering teams/show.html.erb within layouts/application\n  User Load (0.3ms)  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"team_id\" = ?  [[\"team_id\", 1]]\n  Rendered users/_user.html.erb (0.7ms)\n  Rendered users/_user.html.erb (0.1ms)\n  Flag Load (0.5ms)  SELECT \"flags\".* FROM \"flags\" WHERE \"flags\".\"assignedto_id\" = ? AND (assignedto_id = \"team_id\")  [[\"assignedto_id\", 1]]\n  Flag Load (0.3ms)  SELECT \"flags\".* FROM \"flags\" WHERE \"flags\".\"raisedby_id\" = ? AND (raisedby_id = \"team_id\")  [[\"raisedby_id\", 1]]\n  Rendered teams/show.html.erb within layouts/application (12.3ms)\n  User Load (0.5ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = ? ORDER BY \"users\".\"id\" ASC LIMIT ?  [[\"id\", 2], [\"LIMIT\", 1]]\nCompleted 200 OK in 138ms (Views: 129.8ms | ActiveRecord: 2.0ms)\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1531745824, "post_id": 51362282, "comment_id": 89696858, "body": "You don&#39;t really <i>need</i> to get a new sentence each time you enter <code>converts_sentence_to_array</code>. You should split the tasks of requesting new user input and retrieving previously entered data. So  that you request one time, but later can refer to that input many times."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1531745851, "post_id": 51362282, "comment_id": 89696874, "body": "For input &quot;This is a very funny book&quot;, and rotate on &quot;a&quot;, what would be the output?"}, {"owner": {"reputation": 41, "user_id": 9221123, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214337241412532/picture?type=large", "display_name": "Christian Dziwornu", "link": "https://stackoverflow.com/users/9221123/christian-dziwornu"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1531746294, "post_id": 51362282, "comment_id": 89697172, "body": "@JagdeepSingh output should be: a very funny book This is"}, {"owner": {"reputation": 41, "user_id": 9221123, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214337241412532/picture?type=large", "display_name": "Christian Dziwornu", "link": "https://stackoverflow.com/users/9221123/christian-dziwornu"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1531746319, "post_id": 51362282, "comment_id": 89697190, "body": "@SergioTulentsev could u pls explain with some code?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1531746494, "post_id": 51362282, "comment_id": 89697296, "body": "@ChristianDziwornu: yeah, I understand those words may not mean anything, but I don&#39;t have the time to go deeper here."}], "answers": [{"tags": [], "owner": {"reputation": 799, "user_id": 139299, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/167372e60b77c07e81a41a36f7d4f1b5?s=128&d=identicon&r=PG", "display_name": "Nossidge", "link": "https://stackoverflow.com/users/139299/nossidge"}, "is_accepted": false, "score": 0, "last_activity_date": 1531746195, "creation_date": 1531746195, "answer_id": 51362498, "question_id": 51362282, "link": "https://stackoverflow.com/questions/51362282/sentence-rotate-program-not-working-ruby/51362498#51362498", "title": "Sentence rotate program not working ruby", "body": "<p>Here's the logic you want, split up into separate lines:</p>\n\n<pre><code># input\nsentence = 'This is a book'\nword = 'book'\n\n# processing\nwords = sentence.split\npos = words.index(word)\nrotated = words.rotate(pos)\nback_together = rotated.join(' ')\n\n# output\np back_together\n</code></pre>\n\n<p>I'd advise you to separate out your processing code as much as possible. Then you can focus on the terminal input and output logic, which is what actually seems to be your issue.</p>\n"}, {"tags": [], "owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1531746665, "creation_date": 1531746665, "answer_id": 51362659, "question_id": 51362282, "link": "https://stackoverflow.com/questions/51362282/sentence-rotate-program-not-working-ruby/51362659#51362659", "title": "Sentence rotate program not working ruby", "body": "<blockquote>\n  <p>I can't seem to exit this loop of entering data (the program keeps asking for input, not doing anything more.)</p>\n</blockquote>\n\n<p>It looks like your foremost problem is to take the input from user properly and enter the rotation logic. You could make use of <a href=\"https://apidock.com/ruby/Module/attr_reader\" rel=\"nofollow noreferrer\"><code>attr_reader</code></a> to access the input across methods. I have made some changes to your class to accept the input in multiple steps:</p>\n\n<pre><code>class SentenceRotator\n  attr_reader :sentence, :rotate_on_word\n\n  def get_sentence\n    puts \"Please enter your sentence: \"\n    @sentence = gets.chomp\n  end\n\n  def get_word_to_rotate_on\n    puts \"Please enter the word you want to rotate around: \"\n    @rotate_on_word = gets.chomp\n    unless sentence.include?(rotate_on_word)\n      puts \"Your word isn't in the sentence. Please enter another word.\"\n      get_word_to_rotate_on\n    end\n  end\n\n  def rotate\n    puts sentence\n    puts rotate_on_word\n    puts 'You have all the info. Add the logic to rotate.'\n  end\nend\n\n&gt; new_app = SentenceRotator.new\n\n&gt; new_app.get_sentence\nPlease enter your sentence: \nThis is a very funny book\n\n&gt; new_app\n =&gt; #&lt;SentenceRotator:0x00007fee44178c40 @sentence=\"This is a very funny book\"&gt;\n\n&gt; new_app.get_word_to_rotate_on\nPlease enter the word you want to rotate around: \na\n\n&gt; new_app\n =&gt; #&lt;SentenceRotator:0x00007fee44178c40 @sentence=\"This is a very funny book\", @rotate_on_word=\"a\"&gt;\n\n&gt; new_app.rotate\nThis is a very funny book\na\nYou have all the info. Add the logic to rotate.\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1531748606, "post_id": 51362858, "comment_id": 89698654, "body": "You can replace <code>word = gets.chomp</code> with <code>word = get_sentence</code>."}], "tags": [], "owner": {"reputation": 1405, "user_id": 7023415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a7f3b4db177eeb60558058e587628f7?s=128&d=identicon&r=PG&f=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/7023415/leo"}, "is_accepted": true, "score": 0, "last_activity_date": 1531747314, "creation_date": 1531747314, "answer_id": 51362858, "question_id": 51362282, "link": "https://stackoverflow.com/questions/51362282/sentence-rotate-program-not-working-ruby/51362858#51362858", "title": "Sentence rotate program not working ruby", "body": "<pre><code>new_app = SentenceRotator.new\nnew_app.rotate_sentence_around_word\n</code></pre>\n\n<p>So, calling methods: <code>rotate_sentence_around_word</code> => <code>converts_sentence_to_array</code> => <code>get_sentence</code> => <code>get_word</code> => <code>converts_sentence_to_array</code> => <code>get_sentence</code> => ...</p>\n\n<p>Try something like this:</p>\n\n<pre><code>class SentenceRotator\n  def gets_user_data\n    puts \"Please enter your sentence: \"\n    @sentence = get_sentence.split(\" \")\n\n    puts \"Please enter the word you want to rotate around: \"\n    @word = get_word_to_rotate_on\n  end\n\n  def get_sentence\n    gets.chomp\n  end\n\n  def get_word_to_rotate_on\n    word = gets.chomp\n    return word if @sentence.include?(word)\n\n    puts \"Your word isn't in the sentence. Please enter another word.\"\n    get_word_to_rotate_on\n  end\n\n  def rotate_sentence_around_word()\n    gets_user_data\n    @sentence.rotate(@sentence.index(@word)).join(' ')\n  end\nend\n\nnew_app = SentenceRotator.new\nnew_app.rotate_sentence_around_word\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 9221123, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214337241412532/picture?type=large", "display_name": "Christian Dziwornu", "link": "https://stackoverflow.com/users/9221123/christian-dziwornu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 51362858, "answer_count": 3, "score": 0, "last_activity_date": 1531747314, "creation_date": 1531745451, "question_id": 51362282, "link": "https://stackoverflow.com/questions/51362282/sentence-rotate-program-not-working-ruby", "title": "Sentence rotate program not working ruby", "body": "<p>I'm trying to write a program that takes a user's input (sentence), a word the user wants to rotate around, and outputs a rotated sentence around the word that has been chosen by user. \neg. Sentence: This is a book\nWord to rotate around: book\nOutput: book This is a</p>\n\n<p>I can't seem to exit this loop of entering data (the program keeps asking for input, not doing anything more.)\nPlease help. Here's my code:</p>\n\n<pre><code>class SentenceRotator\n  def get_sentence\n    puts \"Please enter your sentence: \"\n    sentence = gets.chomp\n    get_word\n  end\n\n  def get_word\n   puts \"Please enter the word you want to rotate around: \"\n   word = gets.chomp\n   if converts_sentence_to_array.include?(word)\n     rotate_sentence_around_word\n   else\n     puts \"Your word isn't in the sentence. Please enter another word.\"\n     word = gets.chomp\n   end\n   rotate_sentence_around_word\n  end\n\n  def converts_sentence_to_array()\n    get_sentence.split(\" \")\n  end\n\n  def rotate_sentence_around_word()\n    new_array = converts_sentence_to_array.each_with_index {|word,index| converts_sentence_to_array.rotate(index)}\n    new_array\n  end\nend\n\nnew_app = SentenceRotator.new\nnew_app.rotate_sentence_around_word\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-hash"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 2, "creation_date": 1531740189, "post_id": 51360636, "comment_id": 89693353, "body": "Why is <code>2018-05-24 20:15:11 UTC - 2018-05-24 20:15:03 UTC</code> =&gt; <code>9</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1531741592, "post_id": 51360902, "comment_id": 89694201, "body": "@DennyMueller: those are times, not strings"}, {"owner": {"reputation": 2902, "user_id": 1202324, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4e62f40c62dda03af2f033c651f36311?s=128&d=identicon&r=PG", "display_name": "Denny Mueller", "link": "https://stackoverflow.com/users/1202324/denny-mueller"}, "edited": false, "score": 0, "creation_date": 1531741749, "post_id": 51360902, "comment_id": 89694297, "body": "yep my bad, was testing it like 10 seconds ago. I was initially assuming that op has json hashes and not time object and your solution looked like you just subtracted the strings and I was like &quot;wow you can just subtract the string&quot;"}], "tags": [], "owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "is_accepted": false, "score": 1, "last_activity_date": 1531740952, "creation_date": 1531740952, "answer_id": 51360902, "question_id": 51360636, "link": "https://stackoverflow.com/questions/51360636/rails-create-hash-from-two-other-hash/51360902#51360902", "title": "Rails Create hash from two other hash", "body": "<h3>Input</h3>\n\n<pre><code>max\n =&gt; {22479=&gt;2018-05-24 20:15:11 UTC,\n     15392=&gt;2018-04-24 09:38:32 UTC,\n     16319=&gt;2018-04-27 02:21:53 UTC,\n     24644=&gt;2018-06-07 20:01:04 UTC,\n     21551=&gt;2018-05-19 20:11:11 UTC,\n     17876=&gt;2018-05-03 15:47:54 UTC,\n     22467=&gt;2018-05-24 17:11:15 UTC}\n\nmin\n =&gt; {22479=&gt;2018-05-24 20:15:03 UTC,\n     15392=&gt;2018-04-24 09:38:15 UTC,\n     16319=&gt;2018-04-27 02:21:53 UTC,\n     24644=&gt;2018-06-07 19:59:23 UTC,\n     21551=&gt;2018-05-19 20:11:04 UTC,\n     17876=&gt;2018-05-03 15:47:54 UTC,\n     22467=&gt;2018-05-24 17:11:15 UTC}\n</code></pre>\n\n<h3>Solution</h3>\n\n<p>Fetch common keys from <code>max</code> and <code>min</code> and calculate the difference in time (in seconds).</p>\n\n<pre><code>(max.keys &amp; min.keys).each_with_object({}) do |k, out|\n  out[k] = (max[k] - min[k]).to_i\nend\n =&gt; {22479=&gt;8,\n     15392=&gt;17,\n     16319=&gt;0,\n     24644=&gt;101,\n     21551=&gt;7,\n     17876=&gt;0,\n     22467=&gt;0} \n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 8508408, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/53ea69f3734d6b9383a35531d4c011bb?s=128&d=identicon&r=PG&f=1", "display_name": "compsy", "link": "https://stackoverflow.com/users/8508408/compsy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1531741201, "creation_date": 1531740134, "last_edit_date": 1531740933, "question_id": 51360636, "link": "https://stackoverflow.com/questions/51360636/rails-create-hash-from-two-other-hash", "title": "Rails Create hash from two other hash", "body": "<p>I have two hash <code>max</code> and <code>min</code> contain same key </p>\n\n<p>max</p>\n\n<pre><code>{22479=&gt;2018-05-24 20:15:11 UTC, 15392=&gt;2018-04-24 09:38:32 UTC, 16319=&gt;2018-04-27 02:21:53 UTC, 24644=&gt;2018-06-07 20:01:04 UTC, 21551=&gt;2018-05-19 20:11:11 UTC, 17876=&gt;2018-05-03 15:47:54 UTC, 22467=&gt;2018-05-24 17:11:15 UTC}\n</code></pre>\n\n<p>min</p>\n\n<pre><code>{22479=&gt;2018-05-24 20:15:03 UTC, 15392=&gt;2018-04-24 09:38:15 UTC, 16319=&gt;2018-04-27 02:21:53 UTC, 24644=&gt;2018-06-07 19:59:23 UTC, 21551=&gt;2018-05-19 20:11:04 UTC, 17876=&gt;2018-05-03 15:47:54 UTC, 22467=&gt;2018-05-24 17:11:15 UTC}\n</code></pre>\n\n<p>I want to create the third hash with difference of those two hashes in terms of time. Like,</p>\n\n<p>diff </p>\n\n<pre><code>{22479=&gt; 9, 15392=&gt; 17,.......}\n</code></pre>\n\n<p>Can anybody help me out for this, what is the efficient way of dong this.\nIs have to iterate the loop two times.</p>\n"}]